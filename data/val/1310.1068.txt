{
  "article_text": [
    "[ sec1 ] natural selection is a fundamental evolutionary process and finding genomic regions experiencing selective pressure has important applications , including identifying the genetic basis of diseases and understanding the molecular basis of adaptation .",
    "there has been a long line of theoretical and experimental research devoted to modeling and detecting selection acting at a given locus .",
    "several earlier works have considered modeling the stationary distribution of allele frequencies in a population undergoing nonneutral evolution [ @xcite ( @xcite ) , @xcite ] .",
    "more recently , there has been growing interest to utilize time series genetic variation data to enhance our ability to infer allele frequency trajectories , thereby enabling better estimates of selection parameters .",
    "for example , the sequencing of samples over several generations in experimental evolution of a population ( e.g. , bacteria [ @xcite ] , yeast [ @xcite ] and _ drosophila _ [ @xcite ] ) under controlled laboratory environments , or direct measurements in fast evolving populations such as hiv [ @xcite ] , has allowed us to better understand the genetic basis of adaptation to changes in the environment .",
    "also , recent technological advances have given us the unprecedented ability to acquire ancient dna samples ( e.g. , for humans [ @xcite ] , ancient hominids [ @xcite ] and horses [ @xcite ] ) , providing useful information about allele frequency trajectories over long evolutionary timescales .",
    "most methods for analyzing times series dna data model the underlying population - wide allele frequency as an unobserved latent variable in a hidden markov model ( hmm ) framework , in which the sample of alleles drawn from the population at a given time is treated as a noisy observation of the hidden population allele frequency . in this framework , computing the probability of observing time series genetic variation data involves integrating over all possible hidden trajectories of the population allele frequency . for short evolutionary timescales , a discrete - time wright  fisher model of random mating",
    "is often used to describe the dynamics of the population allele frequency in the underlying hmm .",
    "this approach has been used to estimate the effective population size from temporal allele frequency variation , assuming a neutral model of evolution [ @xcite ] .",
    "more recently , temporal and spatial variations of advantageous alleles have been investigated through an hmm framework that can incorporate migration between multiple subpopulations [ @xcite ] .",
    "if the evolutionary timescale between consecutive sampling times is large , it can become computationally cumbersome to work with discrete - time models of reproduction .",
    "however , by a suitable rescaling of time , population size and population genetic parameters , one can obtain a continuous - time process ( the wright  fisher diffusion ) which accurately approximates the population allele frequency of the discrete - time wright  fisher model . the key quantity needed when applying",
    "the diffusion process is the transition density function , which describes the probability density of the allele frequency changing from value @xmath0 to value @xmath1 in time @xmath2 .",
    "this transition density function satisfies a certain partial differential equation ( pde ) with coefficients that depend on the mutation and selection parameters . @xcite",
    "have used a finite - difference numerical method to approximate the solution to the pde and incorporated the results into the aforementioned hmm framework to infer the strength of selection from time series data .",
    "recently , an alternative approach [ @xcite ] based on a one - step markov process has been proposed to compute the necessary transition densities . in both of these approaches ,",
    "the allele frequency space has to be discretized finely enough in order to reliably approximate various numerical integrals that are needed for computing the hmm likelihood .",
    "the efficiency and accuracy of these grid - based numerical methods depend critically on the spacing and distribution of the discrete grid points .",
    "furthermore , an appropriate choice of this discretization scheme could be strongly dependent on the underlying population genetic parameters .",
    "another limitation of these previous works is that only a few restricted models of selection have been considered .",
    "@xcite recently developed a likelihood - ratio test for identifying signatures of selection from time series data in which they combined a deterministic model and a gaussian noise process .",
    "this approximation is less accurate than the diffusion approximation , but it facilitates computation and seems sufficiently accurate provided that the allele frequency does not get too close to the boundaries during the period of observation .    in this paper",
    ", we develop a novel algorithm based on the spectral method to circumvent the limitations mentioned above . specifically ,",
    "instead of approximating the solution to the pde numerically , we utilize a method recently developed by @xcite which finds an explicit spectral representation of the transition density as a function of @xmath0 , @xmath1 and @xmath2 .",
    "we show that the probability of observing a given time series data set can be computed analytically by combining the spectral representation with the forward algorithm for hmms to _ efficiently _ and _ analytically _ integrate over all population allele frequency trajectories .",
    "the key idea in our work is to represent the intermediate densities in the forward algorithm in the basis of eigenfunctions of the infinitesimal generator of the wright  fisher diffusion process . exploiting the spectral representation of the transition density",
    ", we can then efficiently compute the coefficients in this basis representation . furthermore , since this spectral representation applies to general diploid models of selection , we are able to leverage this representation to consider more complex models of selection than previously possible .",
    "we first demonstrate the accuracy of our method on simulated data .",
    "we then apply the method to analyze time series ancient dna data from genetic loci ( asip and mc1r ) that are associated with horse coat coloration .",
    "in contrast to the conclusions of previous studies which considered only a few special models of selection [ @xcite ] , our exploration of the full parameter space of general diploid selection reveals that a heterozygote advantage form of balancing selection may have been acting on these loci .",
    "we implemented the algorithms described in this paper in a publicly available software package called _",
    "spectralhmm_.    the remainder of this paper is organized as follows . in section  [ secmodel ]",
    "we formally introduce the hmm framework and describe the details of our spectral algorithm .",
    "the proofs of the theoretical results underlying our algorithm are provided in the supplemental article [ @xcite ] . in section  [ secresults ]",
    "we use simulated data to investigate the statistical properties of our maximum likelihood estimator and also apply our method to analyze the aforementioned ancient dna data for the loci associated with horse coat coloration [ @xcite ] .",
    "we conclude in section  [ secdiscussion ] with a discussion of future extensions of our model .",
    "here we provide a formal description of the time series data considered in this paper and present our inference method for analyzing such data .      the data we analyze consist of genotype samples obtained from individuals at @xmath3 distinct times @xmath4 in the past ( given in years ) . the present time is denoted by @xmath5 . at each time point @xmath6",
    ", a sample of @xmath7 individuals is randomly drawn from the population .",
    "we assume that the locus under consideration is biallelic , and that the identities of the ancestral allele @xmath8 and the derived allele @xmath9 are known .",
    "we also assume that the allele @xmath9 became selected at some time @xmath10 .",
    "we use @xmath11 to denote the number of derived alleles in the sample of @xmath12 alleles drawn at time @xmath6 , where @xmath13 . for notational convenience",
    ", we use @xmath14 to denote the tuple @xmath15 and @xmath16}$ ] to denote the partial sequence of observations @xmath17 .",
    "figure  [ figdata ] shows an example of a time series allele frequency data set with samples drawn at three time points .      consider a locus evolving according to a discrete wright  fisher model of random mating with an effective population size of @xmath18 diploids",
    "let @xmath19 be the per generation probability of mutation from the ancestral allele @xmath8 to the derived allele @xmath9 , and @xmath20 the probability of the reverse mutation .",
    "we use @xmath21 to denote the selection coefficient of an individual with @xmath22 copies of the derived allele @xmath9 , where @xmath23 . without loss of generality , we can assume that @xmath24 . in each generation of reproduction ,",
    "an offspring randomly chooses a parent having @xmath22 copies of the derived allele with probability proportional to @xmath25 .    consider the scaling limit where the population size @xmath26 while the unit of time is rescaled by @xmath18 and the population - scaled parameters ( @xmath27 , @xmath28 , @xmath29 , @xmath30 ) approach some constants . in this limit",
    ", the trajectory of the population frequency of allele @xmath9 follows a wright  fisher diffusion process [ @xcite ] .",
    "the unit of time @xmath31 in this diffusion approximation is related to the physical unit of time @xmath32 as @xmath33 where @xmath34 is the average number of years per generation of reproduction .",
    "similarly , we let @xmath35 denote the population - scaled versions of the physical times @xmath36 , where @xmath37 the population - scaled selection and mutation parameters of the wright  fisher diffusion process are related to the corresponding parameters in physical units as @xmath38 from here on , we use the above population - scaled parameters when describing our analysis of the wright  fisher diffusion .",
    "the initial population frequency of the allele @xmath9 when it became selected at time @xmath39 is distributed according to the density function @xmath40 . in this paper , we are interested in estimating the selection coefficients of the heterozygote and @xmath9-homozygote ( @xmath41 and @xmath42 , resp . ) given the other population genetic parameters and assuming that the allele @xmath9 became selected at time @xmath39 .",
    ", @xmath43 and @xmath44 ( illustrated by the total number of circles ) are taken at times @xmath45 , @xmath46 and @xmath47 , respectively .",
    "the observed number of derived alleles ( filled circles ) is @xmath48 , @xmath49 and @xmath50 .",
    "the initial time is @xmath51 , and the curve indicates a particular trajectory of the underlying population allele frequency @xmath52 $ ] . ]      to analyze the time series data described earlier , we employ a hidden markov model ( hmm ) framework as in @xcite . in this approach ,",
    "the population - wide frequency @xmath53 of the @xmath9 allele at time @xmath31 is modeled as an unobserved hidden variable ( see figure  [ figdata ] ) .",
    "we denote a realization of the frequencies at the sampling times @xmath35 by @xmath54 . the initial frequency at time",
    "@xmath39 is distributed according to the density function @xmath55 , that is , @xmath56 .",
    "for example , the density function @xmath57 models the case where the selected allele @xmath9 arose as a _ de novo _ mutation in one individual of the population at time @xmath39 .",
    "the probability of transitioning from frequency @xmath58 at time @xmath59 to frequency @xmath60 at time @xmath61 is described by the transition density function @xmath62 of the wright  fisher diffusion process , where @xmath63 and @xmath35 are population - scaled parameters as given in equations ( [ eqdifftimepointsidxdef])([eqmutbetadef ] ) .",
    "the observations in the hmm are the number of copies @xmath11 of the allele @xmath9 among the @xmath12 alleles in the sample drawn at time @xmath6 .",
    "the probability of such an observation at time  @xmath6 with population allele frequency @xmath64 is given by the probability mass function @xmath65 of a binomial distribution @xmath66    to compute the probability @xmath67 } \\}$ ] of observing the data @xmath68}$ ] under the model parameters @xmath69 , we introduce the forward density functions @xmath70 , given by @xmath71 } , { \\mathbf{y}}({{\\tau}}_{k } ) \\in d{y } \\bigr\\ } , \\qquad{k}\\in\\{0,1,\\ldots,{{k}}\\}. \\label{eqforwarddensity}\\ ] ] the function @xmath70 is the joint density of the observed data up to time @xmath35 and the hidden population allele frequency at time @xmath35 .",
    "we also find it convenient to consider a second auxiliary density function , @xmath72 , given by @xmath73 } , { \\mathbf{y}}({{\\tau}}_{k } ) \\in d{y } \\bigr\\ } , \\qquad{k } \\in\\{1,\\ldots,{{k}}\\}. \\label{eqauxiliarydensity}\\ ] ] this function @xmath72 is the joint density of the observed data up to time @xmath74 and the hidden frequency at @xmath35 .",
    "the forward density function @xmath75 is given by the density function for the initial allele frequency as @xmath76 since we approximate the time evolution of the hidden population allele frequency by the wright  fisher diffusion , we can get a recurrence relation between the density functions @xmath72 and @xmath77 by integrating over all possible allele frequencies at  @xmath74 : @xmath78 where @xmath79 . using the binomial distribution for sampling",
    "@xmath80 derived alleles out of @xmath12 individuals at time @xmath35 , we get another recurrence relation between the density functions @xmath70 and @xmath72 as follows : @xmath81 finally , the probability @xmath67 } \\}$ ] of observing the data is computed by integrating over all possible hidden frequencies at the last sampling time : @xmath82 } \\ }",
    "= \\int _ 0 ^ 1 f_{{k}}({y } ) \\,d{y}.\\ ] ] note that the equations above describe a forward - in - time procedure for computing the probability of the data @xmath68}$ ] , where the intermediate density functions have a natural interpretation .    while ( [ eqtransitionintegral ] ) , ( [ eqbinomialemission ] ) and ( [ eqfinalintegral ] ) succinctly describe the sampling probability of the data @xmath83}$ ] , no analytic solutions to the integrals in ( [ eqtransitionintegral ] ) and ( [ eqfinalintegral ] ) are known . in the previous approaches mentioned in the",
    ", these integrals were approximated numerically by discretizing the allele frequency state space .",
    "the accuracy of these approximations depends critically on the careful choice of the discretization grid .",
    "we present an analytical solution to this problem which obviates the need for such a discretization .",
    "the biallelicwright  fisher diffusion with general diploid selection has the infinitesimal generator @xmath84 given by @xmath85 \\frac{\\partial}{\\partial { x}},\\end{aligned}\\ ] ] where @xmath86 is the infinitesimal generator of the diffusion process without selection , given by @xmath87 \\frac{\\partial}{\\partial{x}}.\\end{aligned}\\ ] ] we refer the reader to @xcite for more details about the wright  fisher diffusion .",
    "@xcite developed an efficient method to compute the eigenvalues and eigenfunctions of @xmath84 , and we utilize that method here .",
    "a brief summary of their approach is provided below .    to approximate the spectral decomposition of the operator @xmath84 ,",
    "consider the functions @xmath88 where @xmath89 is the mean fitness of the population and @xmath90 are a rescaled version of the classical orthogonal jacobi polynomials and are defined in section  b of the supplemental article [ @xcite ] .",
    "the @xmath91 and @xmath92 parameters in ( [ eqmodjacobi ] ) are thepopulation - scaled mutation rates given in ( [ eqmutalphadef ] ) and ( [ eqmutbetadef ] ) . the set@xmath93 forms a basis for the hilbert space @xmath94,{\\pi } ) $ ] of real - valued functions on @xmath95 $ ] that are square integrable with respect to the stationary density @xmath96 of the diffusion generator @xmath84 .",
    "specifically , @xmath97 the basis elements @xmath98 are orthogonal with respect to the inner product @xmath99 defined by @xmath100 .    in the basis @xmath101 , the operator @xmath84 is given by the matrix @xmath102 where @xmath103 is a diagonal matrix containing the eigenvalues of the neutral diffusion generator @xmath86",
    ", @xmath104 is the matrix of coefficients from the three - term recurrence relation for the jacobi polynomials @xmath90 , and @xmath105 are constant coefficients defined in section  c of the supplemental article [ @xcite ] .",
    "explicit expressions for the entries of @xmath106 and @xmath107 are provided in equations ( b.3 )  and  ( b.5 ) , respectively , in section  b of the supplemental article .",
    "the eigenvalues @xmath108 of the full diffusion generator @xmath84 are given by the eigenvalues of @xmath109 , and the coefficients of the eigenfunctions of @xmath84 in the basis @xmath93 are given by the eigenvectors of @xmath109 .",
    "in particular , the eigenfunction @xmath110 of @xmath84 is given by @xmath111 where @xmath112 is the eigenvector of @xmath109 corresponding to eigenvalue  @xmath108 .",
    "we use @xmath113 to denote the diagonal matrix of eigenvalues of @xmath109 , and @xmath114 to denote the matrix with rows given by the eigenvectors @xmath115 . as can be seen from ( [ eqdefefun ] ) , @xmath114 is the change - of - basis matrix between the basis of eigenfunctions @xmath110 of @xmath84 and the basis @xmath116 .",
    "the leading eigenvalues and the associated eigenvectors of the infinite matrix  @xmath109 can be approximated by the eigenvalues and eigenvectors of sufficiently large submatrices of @xmath109 .",
    "we refer the reader to @xcite for a more detailed empirical discussion on how the approximation accuracy varies for different submatrix sizes and different parameter regimes .",
    "the transition density function @xmath117 for the probability density of the allele changing frequency from @xmath0 to @xmath1 in time @xmath31 is given by the following spectral decomposition : @xmath118      using the spectral decomposition of the transition density function in ( [ eqtdfspectraldecomposition ] ) , we devise a dynamic programming algorithm to compute the likelihood @xmath119}\\}$ ] .",
    "this algorithm recursively computes the density functions @xmath70 and @xmath120 given in ( [ eqforwarddensity ] ) and ( [ eqauxiliarydensity ] ) , respectively . to update these density functions efficiently ,",
    "we represent them in the basis of scaled eigenfunctions @xmath121 of the diffusion generator @xmath84 .",
    "more precisely , we express @xmath70 and @xmath72 as @xmath122 where we employ the vector notation @xmath123    we now describe how the coefficient vectors @xmath124 and the probability @xmath125}\\}$ ] can be computed efficiently . all proofs can be found in section  a of the supplemental article [ @xcite ] .",
    "first , the following proposition determines the vector @xmath126 of coefficients for the initial forward density function @xmath75 :    [ propinitial ] if the allele frequency at @xmath39 is distributed according to the density function @xmath127 , then the initial forward density function @xmath75 in the basis @xmath121 has the vector of coefficients @xmath128 where @xmath129 is given by ( [ eqdefefun ] ) , and @xmath130 are the squared norms of @xmath110 given by @xmath131 where @xmath132 denote the squared norms of the jacobi polynomials given in equation   in section   of the supplemental article [ @xcite ] .    in the case where the selected allele @xmath9 arises from",
    "_ de novo _ mutation at @xmath133 in one of the individuals in the population , we set @xmath134 in proposition  [ propinitial ] .",
    "we note that our framework allows us to easily model other distributions for the frequency of the mutant allele @xmath9 when it became selected .",
    "for example , the initial distribution of mutation - drift balance can be used to model selection arising from standing genetic variation .",
    "some of these initial distributions are described in section  d of the supplemental article [ @xcite ] .",
    "the following theorem establishes how the representations of the densities @xmath70 and @xmath120 , for @xmath135 , can be computed algebraically in a recursive fashion :    [ thmtransitionemission ] let @xmath136 and @xmath137 denote diagonal matrices with entries @xmath138 and @xmath139 defined as in proposition  [ propinitial ] .",
    "then , for each @xmath140 , the coefficients in the representation of the densities @xmath141 and @xmath142 in ( [ eqforwarddensityrepresentation ] ) and ( [ eqauxiliarydensityrepresentation ] ) can be computed recursively as @xmath143 , \\label{eqforwardtoaux } \\\\ { \\mathbf{b}}_{k}&= & { \\mathbf{a}}_{k}{\\mathbf{w}}\\mathbf{g}^{{d}_{k } } ( { \\mathbf{1}}- \\mathbf{g } ) ^{{{n}}_{k}- { d}_{k } } { \\mathbf{w}}^{-1 } , \\label{eqauxtoforward}\\end{aligned}\\ ] ] where @xmath144 is given by @xmath145    combining proposition  [ propinitial ] and theorem  [ thmtransitionemission ] , we obtain a dynamic programming algorithm for calculating the coefficients @xmath146 and @xmath147 in the representations for @xmath70 and @xmath72 given in ( [ eqforwarddensityrepresentation ] ) and ( [ eqauxiliarydensityrepresentation ] ) , respectively .",
    "the vectors and matrices appearing in the above results are infinite dimensional . as in previous works [ @xcite ] on the spectral representation of the transition density , when applying the above results we truncate the infinite vectors and matrices by choosing cutoffs for the dimensions .",
    "we provide more practical details in section  [ secperformance ] .",
    "finally , the probability of observing the full data @xmath68}$ ] can be computed using the following proposition :    [ propfinalstep ] the probability @xmath148 } \\ } $ ] of observing the data @xmath83}$ ] given the population genetic parameters @xmath69 is @xmath149 } \\ } = \\frac { { { c}}_0 } { { b}_0(0 ) } { { b}}_{{{k}},0},\\ ] ] where @xmath150 is given by @xmath151",
    "in this section we perform parametric inference via the maximum likelihood framework using a finite grid in the parameter space .",
    "we first test the accuracy on simulated data and then apply it to analyze an ancient dna data set related to coat coloration in domesticated horses [ @xcite ] .    since ancient dna data are often collected from only those loci which are segregating at the present time , in our empirical study we condition on observing at least one copy of the derived allele at the last sampling time @xmath152 .",
    "in particular , the likelihood of the parameters is given by @xmath153 } { |}{d}_{{k } } > 0 \\}$ ] .",
    "we chose to maximize this function on a grid , since the algorithm described in the previous section can be parallelized , thus allowing to efficiently evaluate the likelihood under given parameters for several data sets at once .",
    "we simulated data under a discrete - time wright  fisher model with several values for the effective population size and selection coefficients .",
    "we chose the mutation probabilities to be @xmath154 and the number of years per generation to be five years .",
    "these parameters are similar to those considered by previous works that analyzed time series allelic samples from the asip and mc1r loci in horses [ @xcite ] . in our simulations , 5% of the population carried the mutant allele when it first became positively selected .",
    "we sampled 40 individuals at each of 10 time points over the course of 32,000 years .",
    "we investigated the performance of our maximum likelihood estimator in various scenarios of selection . here , we present the results for the following four particular selection schemes :    genic selection , in which the selective fitness of the heterozygote is the arithmetic mean of the fitness of the two homozygotes , that is , @xmath155 and @xmath156 .    heterozygote advantage selection , in which @xmath157 and @xmath158 .",
    "recessive selection , in which @xmath159 , @xmath160 .    dominant selection , in which @xmath161 , @xmath160 .    for each scenario",
    ", we considered @xmath162 and simulated 200 data sets for each value of @xmath163 .     and derived allele homozygote fitness @xmath160 , for each of several different values of selection strength @xmath164 .",
    "the dashed lines indicate the true values .",
    "the effective population size @xmath18 is 2500 individuals .",
    "@xmath16510,000 individuals . ]",
    "figure  [ figgenict10 ] shows the performance of the maximum likelihood estimator under a model of genic selection with an effective population size of @xmath166 and @xmath16510,000 .",
    "it illustrates empirical boxplots of the maximum likelihood estimates , where the tips of the whiskers denote the 2.5%-quantile and the quantile , and the boxes represent the upper and lower quartile .",
    "as the figure shows , our maximum likelihood estimates are unbiased .",
    "the uncertainty of the estimate tends to increase with increasing values of @xmath164 , while the uncertainty decreases as the population size increases , illustrating the fact that for larger population sizes , selection acts more efficiently and is easier to detect . in the case of @xmath16510,000 , if the true selection coefficient is @xmath167 or more , all our maximum likelihood estimates are higher than the 97.5%-quantile of the empirical distribution of the maximum likelihood estimates for @xmath168 .",
    "hence , there is high power to reject neutrality in these scenarios .",
    "the dashed lines indicate the true values of @xmath164 .",
    "genic selection ( @xmath155 , @xmath160 ) with only five sampling time points .",
    "heterozygote advantage model of selection ( @xmath161 , @xmath158 ) with ten sampling time points .",
    "recessive selection ( @xmath159 , @xmath160 ) with ten sampling time points .",
    "dominant selection ( @xmath161 , @xmath160 ) with ten sampling time points . ]    [ figadditionalsimulatedscenarios ]    the performance of our maximum likelihood estimator for several additional selection schemes and parameter regimes can be found in figure  [ figadditionalsimulatedscenarios ] , where we also consider a scenario with fewer sampling time points .",
    "the figure shows that our maximum likelihood estimates are unbiased across the different parameter ranges and scenarios .",
    "in general , the low variance of the empirical distribution of the maximum likelihood estimates shows that our method can be used to accurately infer the selection parameters of interest in a wide range of scenarios .",
    "ludwig et  al .",
    "( @xcite ) extracted genotype data at several loci from ancient horse dna obtained from various sites in eurasia .",
    "in particular , they extracted temporal allele frequency data at eight loci that are known to play a role in coat color determination in contemporary horses .",
    "only the locus encoding for the agouti signaling peptide ( asip ) and the locus for the melanocortin 1 receptor ( mc1r ) showed strong fluctuations in the sample allele counts .",
    "table  [ tabhorse ] shows the time series data for the asip and the mc1r loci in the curated form of the original work [ @xcite ] .    using the method of @xcite for the model of genic selection ( @xmath155 , @xmath160 ) ,",
    "@xcite established that selection acted significantly on only the asip and the mc1r loci .",
    "however , another recent analysis [ @xcite ] of the same data set considered the model of recessive selection ( @xmath159 , @xmath169 ) and did not find a significant signal of selection at the asip locus .",
    "@@ld5.0d5.0d4.0d4.0d4.0d4.0@@xmath170 time of sampling [ @xmath6 ] ( bce ) & 20,000 & 13,100 & 3700 & 2800 & 1100 & 500 + # of samples [ @xmath12 ] & 10 & 22 & 20 & 20 & 36 & 38 + asip ( # der .",
    "alleles ) [ @xmath173 & 0 & 1 & 15 & 12 & 15 & 18 + mc1r ( # der .",
    "alleles ) [ @xmath173 & 0 & 0 & 1 & 6 & 13 & 24 +    to investigate the dependence of the previous conclusions on the assumed selection scheme , we applied our method to reanalyze the asip and the mc1r data under a general selection scheme with arbitrary selection coefficients @xmath41 and @xmath42 .",
    "we set the mutation probability to @xmath154 and the average length of a generation to 5 years .",
    "table  [ tabhorse ] shows that the derived allele is absent in both data sets at time 20,000 bce .",
    "thus , we set the initial frequency of the derived allele as @xmath174 , corresponding to the case where the selected allele arises as a _ de novo _ mutation at time @xmath133 .",
    "we tried a range of values for @xmath18 and @xmath133 .",
    "figure  [ figsingleasip](a ) shows the likelihood surface for the temporal allele frequency data from the asip locus , for @xmath175 and @xmath17617,000 bce .",
    "the empirical maximum of the likelihood surface is located at @xmath177 , indicated by the `` '' in figure  [ figsingleasip](a ) .",
    "this maximum suggests that a selective scheme of heterozygote advantage best explains the data , where both the ancestral and derived allele homozygotes are of equal fitness , while the heterozygous genotype confers a selective advantage over the homozygotes . to establish the significance of this finding",
    ", we performed the following bootstrap procedure : we resampled the asip data set 100 times to obtain subsampled data sets @xmath178}^{({j } ) } \\}_{{j}=1}^{100}$ ] . for each bootstrapped data set @xmath179",
    ", we resampled @xmath180 alleles at each time @xmath181 .",
    "the number of derived alleles for data set @xmath182 was obtained by binomial sampling from the empirical frequency of derived alleles in the original asip data set , that is , @xmath183 we then reported the empirical maximum of the likelihood surface for each of these resampled data sets .",
    "figure  [ figbootstrapasip](b ) shows the empirical maximum likelihood estimates and marginal histograms of the maxima for the 100 resampled data sets .",
    "the marginal 2.5% and 97.5% quantiles of the empirical distribution are @xmath184 $ ] for the heterozygote fitness @xmath41 and @xmath185 $ ] for the derived allele homozygote fitness @xmath42 , thus providing further evidence that the data are significantly better explained by a selection model where a heterozygous individual is selectively advantageous over the homozygous individuals . as figure",
    "[ figmultipleasip ] shows , changing @xmath18 from 1000 to 10,000 , or changing @xmath133 from 19,000 bce to 15,000 , bce has only a minimal effect on the shape of the likelihood surface and maximum likelihood estimate , again supporting that a selective scheme of heterozygote advantage best explains the data .     for temporal samples from the asip locus where",
    "the likelihood is computed over a @xmath186 grid .",
    "the maximum is attained at @xmath187 , indicated by the `` . ''  a joint density plot and marginal histograms of the maximum likelihood estimates for 100 bootstrap resampled data sets of the temporal data at the asip locus .",
    "the circles are centered on the grid points at which the likelihood function is evaluated , and the sizes of the circles indicate the proportion of maximum likelihood estimates that occupy the same grid point . the marginal empirical 2.5% and",
    "97.5%-quantiles are @xmath184 $ ] for the heterozygote fitness @xmath41 , and @xmath185 $ ] for the derived allele homozygote fitness @xmath42 , as indicated by the dashed box . ]",
    "[ figsingleasip][figbootstrapasip ]    \\{1000 , 2500 , 10,000 } and @xmath188\\{15,000  bce , 17,000  bce , 19,000  bce}. the respective maxima are indicated by an `` . '' ]    a similar analysis of the mc1r locus can be found in figures  [ figmc1r ] and  [ figmultiplemc1r ] . for this data set ,",
    "the maximum of the likelihood surface is attained at @xmath189 , and the empirical marginal 2.5% and 97.5%-quantiles are @xmath190 $ ] for the heterozygote fitness and @xmath191 $ ] for the derived allele homozygote fitness . together with the results shown in figure  [ figmultiplemc1r ]",
    ", this suggests that the data at the mc1r locus is also best explained by a selection model of heterozygote advantage .",
    "however , although the marginal quantiles for the homozygote fitness cover @xmath192 , they are rather far apart , so the evidence of heterozygote advantage for the mc1r locus is weaker than that for the asip locus .     and",
    "@xmath193 bce .",
    "likelihood surface for the mc1r locus .",
    "the maximum likelihood estimate is at @xmath194 and is indicated by the `` . ''",
    "a joint density plot and marginal histograms of the maximum likelihood estimates for 100 bootstrap resampled data sets obtained from the mc1r data as described in section  [ sechorses ] .",
    "the marginal 2.5% and 97.5%-quantiles are @xmath190 $ ] for the heterozygote fitness @xmath195 and @xmath196 $ ] for the derived allele homozygote fitness @xmath197 , as indicated by the dashed box . ]",
    "\\{1000 , 2500 , 10,000 } and @xmath188\\{5000  bce , 7000  bce , 9000  bce}. the respective maxima are indicated by an `` . '' ]      the running time of our algorithm for computing the likelihood of a given set of population - scaled parameters is dependent on the dimensions of the truncation @xmath198 of the infinite matrix @xmath109 given in ( [ eqoperatormatrix ] ) . in particular , the time complexity of computing a single likelihood is the cost of computing the eigenvalues and eigenvectors of @xmath198 plus the cost of computing the coefficients @xmath146 in theorem  [ thmtransitionemission ] , where @xmath199 . to compute the eigenvalues and eigenvectors of @xmath200 to high precision",
    ", we first used lapack to compute them to double precision , and then refine them by using inverse iteration [ @xcite , chapter  11.8 ] .",
    "each step of the inverse iteration involves solving a linear system with matrix @xmath201 , where @xmath202 is an estimate for an eigenvalue of @xmath198 .",
    "since this matrix has bandwidth at most 9 , this linear system can be solved in @xmath203 time , where @xmath204 is the dimension of @xmath198 . by using the repeated squaring algorithm for taking powers of the matrices @xmath107 and @xmath205 and exploiting the fact that @xmath107 and @xmath205 are tridiagonal matrices ,",
    "each coefficient @xmath146 can be computed in @xmath206 time , where the first @xmath207 term comes from the matrix - vector multiplications in ( [ eqauxtoforward ] ) .    for the analysis of the asip and mc1r data sets reported in figures  [ figrealasip ] and  [ figmc1r ] , we approximated the eigenvalues and eigenvectors of @xmath109 defined in ( [ eqoperatormatrix ] ) using a @xmath208 submatrix",
    ". furthermore , we used the first @xmath209 terms in  ( [ eqdefefun ] ) to approximate the eigenfunctions , and the dimensions of the vectors of coefficients in  ( [ eqvecforward ] ) and ( [ eqvecauxiliary ] ) were set to @xmath210 .",
    "we empirically verified that these cutoffs produced a stable approximation of the likelihood . using these values , the computation time for a single point of the grid in figure  [ figsingleasip](a ) was approximately 95 seconds .",
    "we adjusted the cutoffs appropriately for the other analyses reported in section  [ secresults ] .",
    "in this paper we have developed a novel , efficient spectral algorithm to analyze time series allele frequency data under a general diploid selection model .",
    "we have demonstrated that our method can be used to accurately estimate selection parameters on simulated data .",
    "we have also applied our method to investigate loci involved in horse coat coloration .",
    "our inferred selection coefficients show that the data are best explained by a heterozygote advantage model of balancing selection . as mentioned earlier ,",
    "@xcite provided evidence for slightly positive selection at the asip locus , assuming a model of genic selection ( where @xmath211 ) .",
    "more precisely , they obtained a point estimate of @xmath212 and a 95% confidence interval of @xmath213 $ ] .",
    "however , using a model of selection where the derived allele homozygote is recessive ( i.e. , @xmath214 ) , a subsequent reanalysis [ @xcite ] of the same data found that @xmath42 has a point estimate of @xmath2150.001 with a 95% confidence interval of @xmath216 $ ] , thus not rejecting neutrality at the asip locus . in our work , we have allowed our method to explore the two - dimensional parameter space of general diploid selection models and presented evidence for a selection mode where heterozygous individuals are advantageous over homozygous individuals .",
    "it is possible that previous analyses have only been able to infer very weak selection acting at the asip locus because they have restricted the model of selection to certain one - dimensional models .",
    "indeed , if we restrict our analysis to a model of genic selection , we get results similar to those reported by @xcite",
    ". our analysis does not conclusively prove that individuals that were heterozygous at the asip locus had a constant evolutionary advantage since 17,000 bce , because we have ignored the interaction of selection and demographic history , epistatic interactions between loci , time - varying models of selection and other factors .",
    "however , our results suggest the possibility that some mode of heterozygote advantage balancing selection has maintained polymorphism at the asip locus that is involved in horse coat coloration .",
    "although we have focused on time series samples taken at a biallelic locus , the mathematical framework presented here could be readily extended to handle an arbitrary number of alleles using the spectral representation derived by @xcite .",
    "further , changes in the population size and selection coefficients could be modeled by suitably combining the spectral representations for different population genetic parameters at the change points .",
    "it is also possible to extend the method to multiple populations and to incorporate samples taken from extinct ancestral populations . in light of emerging ancient dna sequence data for ancient hominids [ @xcite ] , such temporal sequence data and inference methods present novel opportunities to gain insight into adaptation in humans . for a more adequate modeling of biologically relevant scenarios",
    ", it is also necessary to incorporate the exchange of migrants into the model [ @xcite ] and extend the framework to incorporate variation at linked loci . by taking advantage of genetic hitchhiking at closely linked sites during the course of selective sweeps",
    ", one might be able to further improve the inference of selection coefficients .",
    "we thank rasmus nielsen , joshua schraiber andmontgomery slatkin for helpful comments and discussions .",
    "we also thank karen kafadar and two anonymous referees for suggestions that improved the exposition of this paper .",
    "moreover , we thank richard j. mathar [ @xcite ] for making his source code available to us ."
  ],
  "abstract_text": [
    "<S> the increased availability of time series genetic variation data from experimental evolution studies and ancient dna samples has created new opportunities to identify genomic regions under selective pressure and to their associated fitness parameters . however , it is a challenging problem to compute the likelihood of nonneutral models for the population allele frequency dynamics , given the observed temporal dna data . here , we develop a novel spectral algorithm to analytically and efficiently integrate over all possible frequency trajectories between consecutive time points . </S>",
    "<S> this advance circumvents the limitations of existing methods which require fine - tuning the discretization of the population allele frequency space when numerically approximating requisite integrals . </S>",
    "<S> furthermore , our method is enough to handle general diploid models of selection where the heterozygote and homozygote fitness parameters can take any values , while previous methods focused on only a few restricted models of selection . </S>",
    "<S> we demonstrate the utility of our method on simulated data and also apply it to analyze ancient dna data from genetic loci associated with coat coloration in horses . </S>",
    "<S> in contrast to previous studies , our exploration of the full fitness parameter space reveals that a heterozygote advantage form of balancing selection may have been acting on these loci .    , </S>"
  ]
}