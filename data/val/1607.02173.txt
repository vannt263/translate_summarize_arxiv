{
  "article_text": [
    "the human auditory system gives us the extraordinary ability to converse in the midst of a noisy throng of party goers .",
    "solving this so - called _ cocktail party _",
    "problem @xcite has proven extremely challenging for computers , and separating and recognizing speech in such conditions has been the holy grail of speech processing for more than 50 years .",
    "previously , no practical method existed that could solve the problem in general conditions , especially in the case of single channel speech mixtures .",
    "this work builds upon recent advances in single - channel separation , using a method known as _ deep clustering _ @xcite . in deep clustering ,",
    "a neural network is trained to assign an embedding vector to each element of a multi - dimensional signal , such that clustering the embeddings yields a desired segmentation of the signal . in the cocktail - party problem ,",
    "the embeddings are assigned to each time - frequency ( tf ) index of the short - time fourier transform ( stft ) of the mixture of speech signals .",
    "clustering these embeddings yields an assignment of each tf bin to one of the inferred sources .",
    "these assignments are used as a masking function to extract the dominant parts of each source .",
    "preliminary work on this method produced remarkable performance , improving snr by 6 db on the task of separating two unknown speakers from a single - channel mixture @xcite .    in this paper",
    "we present improvements and extensions that enable a leap forward in separation quality , reaching levels of improvement that were previously out of reach ( audio examples and scripts to generate the data used here are available at @xcite ) .",
    "in addition to improvements to the training procedure , we investigate the three speaker case , showing generalization between two- and three - speaker networks .    the original deep clustering system was intended to only recover a binary masks for each source , leaving recovery of the missing features to subsequent stages . in this paper",
    ", we incorporate enhancement layers to refine the signal estimate . using soft clustering",
    ", we can then train the entire system _ end - to - end _ , training jointly through the deep clustering embeddings , the clustering and enhancement stages .",
    "this allows us to directly use a signal approximation objective instead of the original mask - based deep clustering objective .",
    "prior work in this area includes auditory grouping approaches to _ computational auditory scene analysis _ ( casa ) @xcite . these methods used hand - designed features to cluster the parts of the spectrum belonging to the same source .",
    "their success was limited by the lack of a machine learning framework .",
    "such a framework was provided in subsequent work on spectral clustering @xcite , at the cost of prohibitive complexity .",
    "generative models have also been proposed , beginning with @xcite . in constrained tasks ,",
    "super - human speech separation was first achieved using factorial hmms @xcite and was extended to speaker - independent separation @xcite .",
    "variants of non - negative matrix factorization @xcite and bayesian non - parametric models @xcite have also been used .",
    "these methods suffer from computational complexity and difficulty of discriminative training .",
    "in contrast to the above , deep learning approaches have recently provided fast and accurate methods on simpler enhancement tasks @xcite .",
    "these methods treat the mask inferance as a classification problem , and hence can be discriminatively trained for accuracy without sacrificing speed",
    ". however they fail to learn in the speaker - independent case , where sources are of the same class @xcite , despite the work - around of choosing the best permutation of the network outputs during training .",
    "we call this the _ permutation problem _ : there are multiple valid output masks that differ only by a permutation of the order of the sources , so a global decision is needed to choose a permutation .",
    "deep clustering solves the permutation problem by framing mask estimation as a clustering problem . to do so",
    ", it produces an embedding for each time - frequency element in the spectrogram , such that clustering the embeddings produces the desired segmentation .",
    "the representation is thus independent of permutation of the source labels .",
    "it can also flexibly represent any number of sources , allowing the number of inferred sources to be decided at test time .",
    "below we present the deep clustering model and further investigate its capabilities . we then present extensions to allow end - to - end training for signal fidelity .",
    "the results are evaluated using an automatic speech recognition model trained on clean speech .",
    "the end - to - end signal approximation produces unprecedented performance , reducing the word error rate ( wer ) from close to 89.1% wer down to 30.8% by using the end - to - end training .",
    "this represents a major advancement towards solving the cocktail party problem .",
    "here we review the deep clustering formalism presented in @xcite .",
    "we define as @xmath0 a raw input signal and as @xmath1 a feature vector indexed by an element @xmath2 . in audio signals , @xmath2 is typically a tf index @xmath3 , where @xmath4 indexes frame of the signal , @xmath5 indexes frequency , and @xmath6 the value of the complex spectrogram at the corresponding tf bin .",
    "we assume that the tf bins can be partitioned into sets of tf bins in which each source dominates .",
    "once estimated , the partition for each source serves as a tf mask to be applied to @xmath7 , yielding the tf components of each source that are uncorrupted by other sources .",
    "the stft can then be inverted to obtain estimates of each isolated source .",
    "the target partition in a given mixture is represented by the indicator @xmath8 , mapping each element @xmath2 to each of @xmath9 components of the mixture , so that @xmath10 if element @xmath2 is in cluster @xmath11 .",
    "then @xmath12 is a binary affinity matrix that represents the cluster assignments in a permutation - independent way :",
    "@xmath13 if @xmath2 and @xmath14 belong to the same cluster and @xmath15 otherwise , and @xmath16 for any permutation matrix @xmath17 .    to estimate the partition , we seek @xmath18-dimensional embeddings @xmath19 , parameterized by @xmath20 , such that clustering the embeddings yields a partition of @xmath21 that is close to the target . in @xcite and this work , @xmath22 is based on a deep neural network that is a global function of the entire input signal @xmath23 .",
    "each embedding @xmath24 has unit norm , i.e. , @xmath25 .",
    "we consider the embeddings @xmath26 to implicitly represent an @xmath27 estimated affinity matrix @xmath28 , and we optimize the embeddings such that , for an input @xmath23 , @xmath29 matches the ideal affinities @xmath30 .",
    "this is done by minimizing , with respect to @xmath31 , the training cost function @xmath32 summed over training examples , where @xmath33 is the squared frobenius norm . due to its low - rank nature , the objective and its gradient can be formulated so as to avoid operations on all pairs of elements , leading to an efficient implementation .    at test time , the embeddings @xmath22 are computed on the test signal @xmath23 , and the rows @xmath24 are clustered using @xmath34-means .",
    "the resulting cluster assignments @xmath35 are used as binary masks on the complex spectrogram of the mixture , to estimate the sources .",
    "we investigated several approaches to improve performance over the baseline deep clustering method , including regularization such as drop - out , model size and shape , and training schedule .",
    "we used the same feature extraction procedure as in @xcite , with log - magnitude stft features as input , and we performed global mean - variance normalization as a pre - processing step . for all experiments we used we used rmsprop optimization @xcite with a fixed learning rate schedule , and early stopping based on cross - validation .",
    "* regularizing recurrent network units : * recurrent neural network ( rnn ) units , in particular lstm structures , have been widely adopted in many tasks such as object detection , natural language processing , machine translation , and speech recognition . here",
    "we experiment with regularizing them using dropout .",
    "lstm nodes consist of a recurrent memory cell surrounded by gates controlling its input , output , and recurrent connections .",
    "the direct recurrent connections are element - wise and linear with weight 1 , so that with the right setting of the gates , the memory is perpetuated , and otherwise more general recurrent processing is obtained .",
    "dropout is a training regularization in which nodes are randomly set to zero . in recurrent network",
    "there is a concern that dropout could interfere with lstm s memorization ability ; for example , @xcite used it only on feed - forward connections , but not on the recurrent ones .",
    "_ recurrent dropout _",
    "samples the set of dropout nodes once for each sequence , and applies dropout to the same nodes at every time step for that sequence .",
    "applying recurrent dropout to the lstm memory cells recently yielded performance improvements on phoneme and speech recognition tasks with blstm acoustic models @xcite .    in this work , we sampled the dropout masks once at each time step for the forward connections , and only once for each sequence for the recurrent connections .",
    "we used the same recurrent dropout mask for each gate .    * architecture : * we investigated using deeper and wider architectures .",
    "the neural network model used in @xcite was a two layer bidirectional long short - term memory ( blstm ) network followed by a feed - forward layer to produce embeddings .",
    "we show that expanding the network size improves performance for our task .",
    "* temporal context : * during training , the utterances are divided into fixed length non - overlapping segments , and gradients are computed using shuffled mini - batches of these segments , as in @xcite .",
    "shorter segments increase the diversity within each batch , and may make an easier starting point for training , since the speech does not change as much over the segment .",
    "however , at test time , the network and clustering are given the entire utterance , so that the permutation problem can be solved globally .",
    "so we may also expect that training on longer segments would improve performance in the end .    in experiments below",
    ", we investigate training segment lengths of 100 versus 400 , and show that although the longer segments work better , pretraining with shorter segments followed by training with longer segments leads to better performance on this task .",
    "this is an example of _ curriculum learning _",
    "@xcite , in which starting with an easier task improves learning and generalization .    * multi - speaker training : * previous experiments @xcite showed preliminary results on generalization from two speaker training to a three - speaker separation task . here",
    "we further investigate generalization from three - speaker training to two - speaker separation , as well as multi - style training on both two and three - speaker mixtures , and show that the multi - style training can achieve the best performance on both tasks .",
    "deep clustering solves the difficult problem of segmenting the spectrogram into regions dominated by each source . it does not however solve the problem of recovering the sources in regions strongly dominated by other sources .",
    "given the segmentation , this is arguably an easier problem .",
    "we propose to use a second - stage enhancement network to obtain better source estimates , in particular for the missing regions .",
    "for each source @xmath11 , the enhancement network first processes the concatenation of the amplitude spectrogram @xmath0 of the mixture and that @xmath36 of the deep clustering estimate through a blstm layer and a feed - forward linear layer , to produce an output @xmath37 .",
    "sequence - level mean and variance normalization is applied to the input , and the network parameters are shared for all sources . a soft - max",
    "is then used to combine the outputs @xmath38 across sources , forming a mask @xmath39 at each tf bin @xmath2 .",
    "this mask is applied to the mixture , yielding the final estimate @xmath40 . during training , we optimize the enhancement cost function @xmath41 where @xmath42 is the set of permutations on @xmath43 . since the enhancement network is trained to directly improve the signal reconstruction , it may improve upon deep clustering , especially in regions where the signal is dominated by other sources .",
    "in order to consider end - to - end training in the sense of jointly training the deep clustering with the enhancement stage , we need to compute gradients of the clustering step . in @xcite ,",
    "hard @xmath34-means clustering was used to cluster the embeddings .",
    "the resulting binary masks can not be directly optimized to improve signal fidelity , because the optimal masks are generally continuous , and because the hard clustering is not differentiable . here",
    "we propose a soft @xmath34-means algorithm that enables us to directly optimize the estimated speech for signal fidelity .    in @xcite ,",
    "clustering was performed with equal weights on the tf embeddings , although weights were used in the training objective in order to train only on tf elements with significant energy . here",
    "we introduce similar weights weights @xmath44 for each embedding @xmath45 to focus the clustering on tf elements with significant energy .",
    "the goal is mainly to avoid clustering silence regions , which may have noisy embeddings , and for which mask estimation errors are inconsequential .",
    "the soft weighted @xmath34-means algorithm can be interpreted as a weighted expectation maximization ( em ) algorithm for a gaussian mixture model with tied circular covariances .",
    "it alternates between computing the assignment of every embedding to each centroid , and updating the centroids : @xmath46 where @xmath47 is the estimated mean of cluster @xmath11 , and @xmath48 is the estimated assignment of embedding @xmath2 to the cluster @xmath11 .",
    "the parameter @xmath49 controls the hardness of the clustering . as the value of @xmath49 increases , the algorithm approaches @xmath34-means .",
    "the weights @xmath44 may be set in a variety of ways .",
    "a reasonable choice could be to set @xmath44 according to the power of the mixture in each tf bin . here",
    "we set the weights to @xmath50 , except in silence tf bins where the weight is set to @xmath51 .",
    "silence is defined using a threshold on the energy relative to the maximum of the mixture .",
    "end - to - end training is performed by _ unfolding _ the steps of , and treating them as layers in a clustering network , according to the general framework known as _ deep unfolding _ @xcite .",
    "the gradients of each step are thus passed to the previous layers using standard back - propagation .",
    "* experimental setup : * we evaluate deep clustering on a single - channel speaker - independent speech separation task , considering mixtures of two and three speakers with all gender combinations . for two - speaker experiments , we use the corpus introduced in @xcite , derived from the wall street journal ( wsj0 ) corpus .",
    "it consists in a 30 h training set and a 10 h validation set with two - speaker mixtures generated by randomly selecting utterances by different speakers from the wsj0 training set ` si_tr_s ` , and mixing them at various signal - to - noise ratios ( snr ) randomly chosen between 0  db and 10  db .",
    "the validation set was here used to optimize some tuning parameters .",
    "the 5 h test set consists in mixtures similarly generated using utterances from 16 speakers from the wsj0 development set ` si_dt_05 ` and evaluation set ` si_et_05 ` .",
    "the speakers are different from those in our training and validation sets , leading to a speaker - independent separation task . for three - speaker experiments",
    ", we created a corpus similar to the two - speaker one , with the same amounts of data generated from the same datasets .",
    "all data were downsampled to 8  khz before processing to reduce computational and memory costs .",
    "the input features @xmath23 were the log spectral magnitudes of the speech mixture , computed using a short - time fourier transform ( stft ) with a 32  ms sine window and 8  ms shift .",
    "the scores are reported in terms of signal - to - distortion ratio ( sdr ) , which we define as scale - invariant snr . as oracle",
    "upper bounds on performance for our datasets , we report in table  [ tab : ideal_results ] the results obtained using two types of `` ideal '' masks : the ideal binary mask ( ibm ) defined as @xmath52 , which leads to highest snr among all binary masks , and a `` wiener - like '' filter ( wf ) defined as @xmath53 , which empirically leads to good snr , with values in @xmath54 $ ] @xcite . here @xmath55 denotes the time - frequency representation of speaker @xmath2 .",
    "casa @xcite and previous deep clustering @xcite results are also shown for the two - speaker set .",
    ".sdr ( db ) improvements using the ideal binary mask ( ibm ) , oracle wiener - like filter ( wf ) , compared to prior methods dpcl @xcite and casa @xcite on the two- and three - speaker test sets . [",
    "cols=\"<,^,^,^,^\",options=\"header \" , ]     the magnitude snr is insensitive to phase estimation errors introduced by using the noisy phases for reconstruction , whereas the sdr might get worse as a result of phase errors , even if the amplitudes are accurate .",
    "speech recognition uses features based on the amplitudes , and hence the improvements in magnitude snr seem to predict the improvements in wer due to the enhancement and end - to - end training .",
    "[ fig : scatter ] shows that the sdr improvements of the end - to - end model are consistently good on nearly all of the two - speaker test mixtures .",
    "* asr performance : * we evaluated asr performance ( wer ) with gmm - based clean - speech wsj models obtained by a standard kaldi recipe @xcite .",
    "the noisy baseline result on the mixtures is 89.1 % , while the result on the clean speech is 19.9 % .",
    "the raw output from dpcl did not work well , despite good perceptual quality , possibly due to the effect of near - zero values in the masked spectrum , which is known to degrade asr performance .",
    "however , the enhancement networks significantly mitigated the degradation , and finally obtained 30.8 % with the end - to - end network .",
    "* visualization : * to gain insight into network functioning , we performed reverse correlation experiments . for each node , we average the 50-frame patches of input centered at the time when the node is active ( e.g. , the node is at 80% of its maximum value ) .",
    "[ fig : revcor ] shows a variety of interesting patterns , which seem to reflect such properties as onsets , pitch , frequency chirps , and vowel - fricative transitions .",
    "* conclusion : * we have improved and extended the deep clustering framework to perform end - to - end training for signal reconstruction quality for the first time . we show significant improvements to performance both on signal quality metrics and speech recognition error rates ."
  ],
  "abstract_text": [
    "<S> deep clustering is a recently introduced deep learning architecture that uses discriminatively trained embeddings as the basis for clustering . </S>",
    "<S> it was recently applied to spectrogram segmentation , resulting in impressive results on speaker - independent multi - speaker separation . in this paper </S>",
    "<S> we extend the baseline system with an end - to - end signal approximation objective that greatly improves performance on a challenging speech separation . </S>",
    "<S> we first significantly improve upon the baseline system performance by incorporating better regularization , larger temporal context , and a deeper architecture , culminating in an overall improvement in signal to distortion ratio ( sdr ) of 10.3 db compared to the baseline of 6.0 db for two - speaker separation , as well as a 7.1 db sdr improvement for three - speaker separation . </S>",
    "<S> we then extend the model to incorporate an enhancement layer to refine the signal estimates , and perform end - to - end training through both the clustering and enhancement stages to maximize signal fidelity . </S>",
    "<S> we evaluate the results using automatic speech recognition . </S>",
    "<S> the new signal approximation objective , combined with end - to - end training , produces unprecedented performance , reducing the word error rate ( wer ) from 89.1% down to 30.8% . </S>",
    "<S> this represents a major advancement towards solving the cocktail party problem .    * index terms * : single - channel speech separation , embedding , deep learning </S>"
  ]
}