{
  "article_text": [
    "this paper describes an advanced component separation technique and its application to the analysis of multi - spectral observations of the cosmic microwave background ( cmb ) .",
    "it is developed more specifically in view of the data processing pipeline for the forthcoming planck mission  @xcite of the european spatial agency ( esa ) .",
    "component separation is a critical part of cmb data processing because no frequency channel exists that would be sensitive only to cmb emission . as an illustration , figure  [ fig : inputs ] shows ( simulated ) maps of the microwave emission of the sky observed in the frequency channels of planck _",
    "i.e. _ in spectral bands centered around frequencies @xmath0 . the red ( in an arbitrary color map ) horizontal strips along the galactic equator , in the middle of the maps , are due to galactic emissions ( that is , emissions from _ our _ galaxy ) .",
    "in contrast , towards the poles where the galactic emissions are weaker , one can see in the center channels ( 100 , 143 and 217  ghz ) , an homogeneous texture which is the signal of interest : the ( spatial ) fluctuations ( or ` anisotropies ' ) of the  cmb . unfortunately , even in the polar areas , the contamination of the cmb by various astrophysical emissions ( or foregrounds , as opposed to the cosmic _ background _ ) is still significant .",
    "there , especially at the smallest angular scales , contamination is dominated by the emission of remote extragalactic objects  galaxies ( or ` point sources ' ) of various types ( which emit radiation through similar physical processes as our own galaxy ) , and galaxy clusters ( which emit via the sunyaev - zeldovich effect , hereafter : the ` sz component ' ) .",
    "there is no significant occlusion between the various physical components so that the signal @xmath1 measured at a frequency @xmath2 in direction @xmath3 is a linear superposition : @xmath4 where @xmath5 is the contribution due to a particular component @xmath6 and @xmath7 accounts for instrumental noise at the map level .",
    "it must be stressed that , even though the lowest ( 30 , 44 , 70  ghz ) and highest ( 353 , 545 , 857  ghz ) frequency channels are more contaminated by galactic emissions , they still are very informative because they can be used to predict and remove the galactic emission in the center channels , leaving only cmb and noise   in an ideal data processing scenario .",
    "successful scientific exploitation of the cmb measurements for cosmological studies critically depends on accurate cleaning of the cmb and on quantifying as well as possible any remaining contamination .",
    "figure  [ fig : reccmb ] illustrates on simulated data what can be achieved with our technique on a very large fraction of the sky .",
    "even though cmb recovery is the main goal , recovering the other components also is of scientific interest .",
    "for instance , planck should also yield a very rich catalog of galaxy clusters , and provide a lot of information about the emission of the interstellar medium in our own galaxy .",
    "hence , we are actually facing a problem of _ component separation _ from multiple observations .",
    "the component separation problem is not new to the astrophysics community . in the past ten years however , component separation for cmb observations specifically has motivated the development of a large variety of methods with various degrees of sophistication ( see @xcite for a review ) .",
    "the most direct methods rely on modelling and subtracting foreground emission .",
    "such methods , typically , involve a thorough understanding of the emission processes , necessary to build the foreground model .",
    "other methods use simple decorrelation , or make use of differences between properly weighted maps @xcite .",
    "the processing of data from the wmap satellite mission makes uses of both kinds of methods @xcite .",
    "the large majority of existing component separation methods in the context of cmb observations rely on a ` mixing model ' as follows : for any available direction @xmath3 in the sky , the @xmath8 channels at frequencies @xmath9 provide @xmath8 data points which can be collected in an @xmath10 vector @xmath11 which is modelled as @xmath12 where each entry of @xmath13 contains the sky - pattern for the emission of a given component .",
    "the emissivity of a given component depends on the frequency @xmath2 ; hence , each column of matrix @xmath14 reflects the emission law of the corresponding component .",
    "this equation , then , forms the basis for many component separation algorithms but it forces a special structure on each component , namely that it ` scales rigidly with frequency ' .",
    "some methods are developed to solve this component separation problem when the mixing matrix @xmath15 is known _",
    "a priori_. this is the case , for instance , of the work described in @xcite .",
    "component separation is a well studied problem in signal processing , but the nature of the available data and the scientific objectives call for specific techniques",
    ". in particular , one may think of resorting to independent component analysis ( ica ) methods since these ` blind ' techniques may be useful to deal with some of the uncertainties in the data structure .",
    "in addition , columns of the mixing matrix @xmath14 corresponding to some of the astrophysical components ( e.g. components modelling the emission of our own galaxy ) are known a priori up to significant uncertainty , and more precise knowledge is an objective of the forementioned astrophysical observations .",
    "implementations of ica ideas in the context of cmb observations can be found in @xcite .    compared with all the above methods ,",
    "our framework allows the inclusion of components with arbitrary structure ( at least in terms of second order correlations ) .",
    "this structure , as will be detailed later on , can be matched to prior knowledge of the nature of the astrophysical emission .",
    "along the same spirit of matching a parametric model of the emissions to the data , although quite different in implementation , are the work described in @xcite .",
    "although there is substantial motivation for letting the data alone indicate the appropriate model of the emissions , a fully blind approach would leave out a lot of valuable prior information in the cmb context .",
    "the approach described in this paper is rooted in ica but allows for the inclusion an arbitrary amount of prior information , in particular by allowing components with an arbitrary structure .",
    "again , the approach to component separation described herein is not specific to this particular problem and may be considered for application to any situation where ` expensive ' data deserve special care and have to be fitted by a complex component model .",
    "the paper is organized as follows : section  [ sec : model ] describes our approach , section  [ sec : discussion ] focuses in specific aspects ; implementation is discussed in section  [ sec : impl ] in terms of a library of components ; section  [ sec : results - simul - planck ] illustrates an application of the method on data from the planck sky model .",
    "this section introduces a key ingredient of our approach : the development of a flexible model of _ additive components _ in which the notion of ` mixing matrix ' , which is central to standard ica , is disposed of . not only the mixing matrix is not needed but it is ` considered harmful ' .",
    "we start the exposition by considering the most general component model for an @xmath10 random vector @xmath16 : we only postulate that @xmath16 is made of the linear superposition of @xmath17 components : @xmath18 where each component @xmath19 is an @xmath10 random vector . for simplicity",
    ", we shall assume that all components have zero mean .",
    "denote @xmath20 ( _ resp . _",
    "@xmath21 ) the covariance matrix of vector @xmath16 ( _ resp .",
    "_ of its @xmath22-th component @xmath19 ) .",
    "a key assumption of our model is mutual decorrelation between all components , which implies that the covariance matrix of @xmath16 decomposes as @xmath23 consider now recovering linearly a particular component @xmath19 from the superposition  ( [ eq : compmodel ] ) .",
    "denote @xmath24 the @xmath25 matrix which best predicts @xmath19 based on @xmath16 in the sense that @xmath26 this problem is easily solved under our assumptions and one readily finds : @xmath27 at this stage , we wish to deliver a simple but important message : eq .",
    "( [ eq : wiener ] ) means that component separation , understood as computing @xmath28 , requires only knowing @xmath21 and @xmath20 .",
    "of course , covariance matrix @xmath20 may ( but need not to ) be simply estimated from the empirical covariance matrix @xmath29 of @xmath16 .",
    "therefore , component separation is solved if we can uniquely solve the _ covariance separation problem _ , in the sense of identifying the component terms @xmath21 in decomposition  ( [ eq : deccov ] ) .    in order to achieve covariance separation ,",
    "some additional information or assumptions are of course needed .",
    "our method jointly exploits two possibilities : considering _ localized matrices _ ( for more information ) and considering _ structured matrices _ ( for more constraints ) .",
    "this section defines the ` localized statistics ' on which our method is based .",
    "consider the component separation problem based on @xmath30 samples on @xmath8 detectors .",
    "we shall not compress this data set into a single sample @xmath25 covariance matrix but rather ` localize ' the statistics and form a _ set _ of _ localized covariance matrices_. by ` localization ' , we typically mean localization in time , space , frequency , wavelet space , depending on the problem at hand .",
    "the simplest example of localization is suggested by the separation of non - stationary time series as considered in @xcite where the data are time - indexed and one would divide the observation interval into @xmath31 sub - intervals and compute an estimate of the covariance of @xmath16 over each of these intervals . more generally , we assume that the data are available as @xmath30 vectors @xmath32 , each of size @xmath10 where the @xmath33-th entry of @xmath34 is either the @xmath35-th sample of the @xmath33-th input signal or its @xmath35-th coefficient in some basis ( _ e.g. _ the fourier basis ) . in our application to cmb analysis , we use the spherical harmonic basis ( see section  [ sec : results - simul - planck ] ) .",
    "basis choice is discussed below ; it does have an impact on separation but it does not change the nature of the problem in the sense that , if the component model  ( [ eq : compmodel ] ) holds in some basis , it also holds in any other basis and that if a component is reconstructed in a given basis , it becomes available in any basis .",
    "localized statistics are formed by dividing the index set @xmath36 $ ] into @xmath31 subsets which are called ` domains ' in the following ( time domains would be time intervals , spectral domains would be frequency bands , etc  ) . denoting @xmath37 the @xmath38-th domain , partitioning of the data set reads @xmath39",
    "= \\cup_{q=1}^q \\mathcal{d}_q$ ] and localized statistics are computed ( defined ) as @xmath40 where @xmath41 is the number of coefficients in domain @xmath37 .    the expected value of the sample covariance matrix for the @xmath38th domain is defined / denoted as @xmath42 and we shall use the same notation for each component so that , these being mutually uncorrelated by assumption , one has the decomposition @xmath43 we can then perform a localized separation in the sense that the localized wiener filter for recovering component @xmath22 in domain @xmath38 is @xmath44 a key point is that , by definition , this filter is specialized to operate on domain @xmath38 , hence it is adapted to the local correlation conditions .      implementing component separation by ( [ eq : locwiener ] ) requires knowning the local covariance matrices @xmath45 .",
    "these are usually unknown and must be estimated , based on @xmath46 , the sample estimate  ( [ eq : empscm ] ) of their sum .",
    "it goes without saying that , without constraining the possible values of @xmath45 , it is not possible in general to uniquely resolve ( an estimate of ) this sum into its components . constraining a given component @xmath22",
    "is achieved by parametrizing the matrix set @xmath47 by a parameter vector @xmath48 _ i.e. _ a parametric model for the @xmath22-th component is a function @xmath49 .",
    "some examples of these parametric models are given in section  [ sec : mylib ] .",
    "a parametric model @xmath50 follows by assuming component decorrelation  ( [ eq : decrq ] ) and taking the global parameter @xmath51 as the concatenation of the parameter vectors of each component : @xmath52    the parametric model is identified by fitting it to data , that is , by minimizing a measure of mismatch between @xmath53 and @xmath54 as : @xmath55 where @xmath56 is measure of mismatch between two positive @xmath25 matrices and @xmath57 are positive weights .",
    "our most common choice is to use @xmath58\\ ] ] because this is the form which stems from the maximum likelihood principle .",
    "specifically , if a coefficient @xmath59 belonging to domain @xmath38 is modeled as @xmath60 and as independent from @xmath61 for @xmath62 , then @xmath63 is the negative log - likelihood of the model  @xcite .      in summary ,",
    "our method is based on the following steps and design choices :    [ it : basis ] choice of a basis to obtain coefficients @xmath59 ( original space , fourier or spherical - harmonic space , wavelet space ,  ) .",
    "[ it : domain ] choice of domains @xmath64 to localize their second - order statistics @xmath53 ,    [ it : models ] choice of a model @xmath65 , for the contribution @xmath45 of each component @xmath22 to the covariance matrix over each domain @xmath38 .",
    "minimization of the matching criterion  ( [ eq : idcrit ] ) to obtain the estimate @xmath66 , hence estimates @xmath67 for the parameters of each component .",
    "estimation of the coefficients of each component by @xmath68 , that is the version of  ( [ eq : locwiener ] ) based on estimated parameters .",
    "reconstruction of the components from their coefficients @xmath69 .    at this stage ,",
    "most of the statistical framework is in place but our method is not completely specified yet because of the flexibility in design choices in items [ it : basis ] , [ it : domain ] and  [ it : models ] above among other issues .",
    "next section discusses some of them .",
    "we wish to contrast the standard form @xmath70 of the noisy linear component model of eq .",
    "( [ eq : multmod ] ) with the unconstrained model @xmath71 of eq .",
    "( [ eq : compmodel ] ) .",
    "obviously , the standard model is included in the unconstrained model since one may always write @xmath72 with @xmath73 for @xmath74 and @xmath75 where @xmath76 denotes the @xmath22-th column of @xmath14 and @xmath77 denotes the @xmath22th entry of @xmath78 .    a component @xmath79 which can be written as @xmath80 is fully coherent in the sense that any two entries of vector @xmath79 are 100% correlated . of course , this is because all the randomness in @xmath81 comes from a single scalar random variable @xmath82 .",
    "a fully coherent component contributes exactly the same pattern on all sensors ( or channels ) up to a fixed proportionality coefficient .",
    "it has a rank - one covariance matrix : @xmath83 ; for this reason , it could also be called a one - dimensional since it leaves in the 1d space spanned by vector @xmath76 or in the 1d range space of @xmath21 .    in our application ,",
    "the cmb is a fully coherent component : from one frequency channel to another , only its overall intensity changes ( ignoring the frequency - dependent resolution ) .",
    "this is in contrast with , for instance , the galactic emission , which can not be represented over the sky as a fully coherent component ( see fig .  [",
    "fig : decinputs ] ) .",
    "assume now that , in the model @xmath70 , two sources , say @xmath33 and @xmath35 , are statistically _ dependent _ while all other pairs of sources in @xmath78 are mutually independent . these two sources contribute @xmath84 to @xmath16 and we decide to lump them into a single component denoted @xmath19 for some index @xmath22 : @xmath85 . then @xmath16 can still be written as in eq .",
    "( [ eq : compmodel ] ) and all the _ components _ @xmath19 are independent , _",
    "again_. in other words , we represent here the contributions of two correlated sources as the contribution of a single 2-dimensional component : we now have one less component but it is 2-dimensional . clearly , this component is not fully coherent : it contributes a pattern on sensor @xmath8 which is not proportional to the pattern contributed to another sensor @xmath86 .",
    "one can obviously define multidimensional components of any dimension , each one possible representing the contribution of several correlated sources . in section [ sec : results - simul - planck ] , we use a 4-dimensional component to model galactic emission .    note that , in eq .",
    "( [ eq : compmodel ] ) , the noise term is included as one of the components .",
    "if the noise is uncorrelated from channel to channel , as is often the case , then the noise component is @xmath8-dimensional ( the largest possible dimension ) .",
    "more generally , our model does not require any component to be low dimensional .",
    "rather , our model is a plain superposition of @xmath17 components as in eq .",
    "( [ eq : compmodel ] ) .",
    "none of these components is required to have any special structure , one - dimensional or otherwise .",
    "we call a collection of parametric models @xmath87 a _ library _ of components . in practice",
    ", each member of the library must not only specify a parametrization @xmath87 but also its gradient and related quantities ( see sec .",
    "[ sec : comp - deriv ] ) .",
    "typical examples of component models are now listed .",
    "the ` classic ' ica component is fully coherent ( one dimensional ) @xmath88 . denoting @xmath89",
    "the average variance of @xmath90 over the @xmath38th domain , the contribution @xmath45 of this component to @xmath91 is the rank - one matrix @xmath92 this component can be described by an @xmath93 vector @xmath48 of parameters containing the @xmath8 entries of @xmath76 and the @xmath31 variance values @xmath89 .",
    "such a parametrization is redundant , but we leave this issue aside for the moment .",
    "a @xmath94-dimensional component can be modeled as @xmath95 where @xmath96 is an @xmath97 matrix and @xmath98 is an @xmath99 positive matrix varying freely over all domains",
    ". this can be parametrized by a vector @xmath48 of @xmath100 scalar parameters ( the entries of @xmath96 and of @xmath98 ) . again , this is redundant , but we ignore this issue for the time being",
    ".    noise component . a simple noise model is given by @xmath101 that is , uncorrelated noise from channel to channel , with the same level in all domains but not in all channels . this component is described by a vector @xmath48 of only @xmath8 parameters .",
    "a more general model is @xmath102 meaning that the noise changes from domain to domain ; then parameter vector @xmath48 has size @xmath103 .    as a final example , for modeling ` point sources ' in spectral domain , one may use @xmath104 .",
    "such a component contributes identically in all domains corresponding to a flat spectrum .",
    "if , for instance , we assume that this contribution @xmath105 is known , then the parameter vector @xmath48 is void .",
    "if @xmath105 is known up to a scale factor , then @xmath48 is just a scalar , etc  in the demonstration test discussed in [ sec : results - simul - planck ] , however , we consider instead the sum of galactic and point source emission as one single 4-dimensional component  a choice which the flexibility of the present model allows us to do .",
    "there are two strong , very different motivations for localizing the statistics .",
    "* localization for accuracy . *",
    "the first motivation is separation accuracy .",
    "if the strength of the various components ( including noise ) varies significantly across the domains @xmath37 , reconstruction is improved by the localized filter .",
    "indeed , the best linear reconstruction of @xmath106 based on @xmath34 would be , as seen above , obtained as @xmath107 .",
    "this requires knowing both @xmath108 and @xmath109 . in practice",
    ", it seems difficult to obtain estimates for these matrices for all samples , _",
    "i.e. _ for each value of @xmath35 .",
    "however , if they do not vary too much for all values of @xmath35 across a domain @xmath37 , then a good approximation to the best reconstruction is  ( [ eq : locwiener ] ) _ i.e. _ the reconstruction filter also is localized , taking advantage of the ` local snr conditions ' on domain @xmath37 .    * localization for diversity / identifiability . *",
    "second , the diversity of the statistics of the components over several domains is precisely what may make this model blindly identifiable .",
    "for instance , in the basic ica model ( all components are one - dimensional , no noise ) , if @xmath59 are fourier coefficients and @xmath37 are spectral bands , it is known that spectral diversity ( no two components have identical spectrum ) is a sufficient condition for blind identifiability .",
    "is this a _ blind _ component separation method ?",
    "it all depends on the component model . if all components are modeled as ` classic ' ica components ( see sec .",
    "[ sec : mylib ] ) , then the method is as blind as regular ica .",
    "our approach , however , leaves open the possibility of tuning the blindness level at will by specifying more or less stringent models @xmath110 for some or all of the components .    of course",
    ", it may be difficult to predict if a given parametrization ensures the identifiability of the model : this is to be discussed on a case - by - case basis .",
    "however , over - parametrization can be tested numerically because the fisher information matrix ( fim ) is available in our framework .",
    "it has a natural block structure where the block related to a pair @xmath111 of components is the matrix of size @xmath112 : @xmath113_{cc ' }    =    \\frac12 \\sum_q p_q\\ \\mathrm{trace }    \\left (      \\frac{\\partial\\r_q^ c   ( \\theta^c   ) } { \\partial\\theta^c    } \\r_q\\inv(\\theta )        \\frac{\\partial\\r_q^{c'}(\\theta^{c'})}{\\partial\\theta^{c ' } } \\r_q\\inv(\\theta )      \\right)\\ ] ] under the assumptions which make the mismatch measure @xmath63 proportional to the log - likelihood ( see sec .  [",
    "sec : constr - comp - model ] ) .",
    "the fim is also used for computing ( approximate ) error bars .",
    "we discuss the practical issue of actually minimizing the mismatch @xmath63 using an arbitrary library of components .    note that for a noise - free model containing only ` classic ica ' components ( no other constraints than being one - dimensional ) , criterion @xmath63 boils down to a joint diagonalization criterion which can be very efficiently minimized by a specialized algorithm  @xcite . for a model",
    "including only unconstrained multi - dimensional components and noise , it is possible to use the em algorithm  @xcite .",
    "em , however , is not convenient for general component models and , in addition , it appears too slow for our purposes .",
    "therefore , we had to consider more efficient and more general optimization procedures .",
    "we found the conjugate gradient ( cg ) algorithm well suited for minimizing @xmath63 .",
    "its implementation requires computing the gradient @xmath114 and ( possibly an approximation of ) the hessian @xmath115 for pre - conditioning .",
    "since @xmath63 actually is a negative log - likelihood in disguise , its hessian can classically be approximated by @xmath116 , the fisher information matrix ( fim ) of eq .",
    "( [ eq : cm : deffimblock ] ) .",
    "these computations offer no particular difficulty in theory but we aim at an implementation it in the framework of a library of components _",
    "i.e. _ computations should be organized in such a way that each component model @xmath117 works as a ` plug - in ' .      * computing the gradient . *",
    "the partial derivative of @xmath118 with respect to @xmath48 takes the form @xmath119 where matrix @xmath120 is defined as @xmath121 hence the computation of @xmath114 at a given point @xmath122 can be organized as follows .",
    "a first loop through all components computes @xmath54 by adding up the contribution @xmath123 of each component .",
    "then , a second loop over all @xmath31 domains computes matrices @xmath124 which are stored in a common work space .",
    "finally , a third loop over all components concatenates all partial gradients @xmath125 , each component implementing the computation of the right hand side of  ( [ eq : cm : parderphi ] ) in the best possible way , using the available matrices @xmath126 .",
    "* computing an ( approximate ) hessian . *",
    "the fisher information matrix can be partitioned component - wise and each block be computed according to eq .",
    "( [ eq : cm : deffimblock ] ) .",
    "therefore its computation can be organized with a double nested loop over @xmath22 and @xmath127 as soon as the code implementing a given component is able to return the matrix set @xmath128 .",
    "a straightforward implementation of this idea may be impractical , though , because this is a set of @xmath129 matrices , possibly very large .",
    "this problem can be alleviated in the frequent case where components have ` local ' variables .",
    "* local variables . *",
    "consider the case when @xmath48 can be partitioned into @xmath130 blocks : @xmath131 where , for @xmath132 , the sub - vector @xmath133 affects only @xmath45 while @xmath134 collects all the remaining parameters _",
    "i.e. _ those which affect the covariance matrix over two or more domains .",
    "we then say that this component model has ` local variables ' .",
    "this is a fairly frequent situation which occurs for instance when the power of a component can be freely adjusted in each domain ( the simplest example is the ` classic ' ica component : @xmath135 , for which @xmath136 and @xmath137 for @xmath138 .",
    "the global parameter vector @xmath51 inherits this structure by being partitioned accordingly into a ` global part ' @xmath139 and @xmath31 local parts @xmath140 .",
    "a first and major benefit of such a local / global partitioning is that it introduces many zero blocks in the fim since then @xmath141_{qq'}=\\mathbf{0}$ ] for @xmath142 , allowing the computation of the pre - conditioned gradient @xmath143 to be organized much more efficiently .",
    "another benefit of the local / global partitioning is that it makes it easy to implement a ` local optimization ' : during global optimization over @xmath51 , it is possible at any time to loop through all @xmath31 domains and to solve in each domain , possibly exactly , the sub - problem @xmath144 which is , of course , of much smaller size than the original problem in most cases .      examples of section [ sec : mylib ] show that ` natural ' component parametrizations often are redundant . from a statistical point of view , this is not important : we seek ultimately to identify @xmath145 as a member of a family described by a mapping @xmath65 but this mapping does not need to be one - to - one .",
    "the simplest example again is for @xmath146 which is invariant if one changes @xmath76 to @xmath147 and @xmath148 to @xmath149 .",
    "therefore , there is a 1d set of pairs @xmath150 achieving the global optimum but they all correspond to a unique value of @xmath45 itself , which is thus perfectly well defined at the optimum and is the unique quantity needed to reconstruct the @xmath22-th component in domain @xmath38 .",
    "the only serious concern about over - parametrization is from the optimization point of view .",
    "redundancy makes the @xmath63 criterion _ flat _ in the redundant directions and it makes the fim a singular matrix .",
    "finding non redundant re - parametrizations is a possibility , but it is often simpler to add a penalty function to @xmath63 for any redundantly parametrized component .",
    "for instance , the scale indetermination of the classic ica component @xmath135 when parametrized @xmath151 and @xmath137 ( @xmath152 ) is fixed by adding @xmath153 to @xmath63 , where @xmath154 is any reasonable function which has a single minimum at , say , @xmath155 .",
    "of course , the addition such a term should be reflected in the gradient and the hessian of the matching criterion .",
    "this section describes an application of our framework to a cmb data set .",
    "although we go into some detail , several issues can not be discussed due to limited page space .",
    "the main objective here is illustrative .      in preparation for data acquisition by the planck mission , the ability to perform component separation",
    "is evaluated by resorting to a realistic set of simulated data which is developed within the planck collaboration as the ` planck sky model ' ( psm ) .",
    "this suite of programs is used to generate random realizations of the sky at the planck frequency range compatible with the present knowledge of all identified component emissions and aims at capturing many of the intricacies ( both from the sky and from the instrument ) expected from real data .",
    "we use sky maps simulated at the 9 frequencies of planck channels .",
    "the instrument point spread function is modelled as a gaussian beam whose width decreases with increasing frequency : the beams fwhm are 33 , 24 , 14 , 10 , 7.1 , 5 , 5 , 5 , 5 in arcminutes .",
    "the beam effect is visible in figure [ fig : decinputs ] where the angular size of the galaxy clusters ( via the sz effect ) , point sources and cmb anisotropies decreases from top to bottom reflecting the increasing resolution .",
    "planck does not take a ` snapshot ' of the sky .",
    "rather , sky maps are ( painfully ) computed from sky scans . due to various technological constraints ,",
    "the scanning strategy does _ not _ guarantee that all pixels are seen ( or ` hit ' ) equally often . as an important consequence ,",
    "the variance of the noise in each pixel depends on its hit - count . in our simulated data",
    "set , the noise is modelled as gaussian , independent from channel to channel , from pixel to pixel and with a variance inversely proportional to the hit - count .",
    "see fig .",
    "[ fig : hitcount+mask ] for a sky map of hit counts corresponding to a one year survey .",
    "the noise variance in one pixel for one hit depend on the frequency channel and are given for the 9 channels by 1027 , 1434 , 2383 , 1245 , 753.6 , 609.1 , 424.5 , 154.9 , 71.8 @xmath156 for the maps used in this simulation .",
    "the full - sky maps used as inputs to our experiments are shown on figure  [ fig : inputs ] .",
    "figure  [ fig : decinputs ] zooms in and shows the various physical components used as ingredients : cmb , galactic emissions , galaxy clusters ( via the sz effect ) , point source emissions ( due to infrared- and radio - galaxies ) . galactic emission is shown as a single component but is actually made up of three physical components due to free - free , synchrotron and dust emissions .",
    "mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ] +   mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ] +   mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ]   mkrj , title=\"fig:\",width=188 ] +    .",
    "[ fig : inputs ]    @xmath157{\\thumbdir / map--2048-allplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-allplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-allplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-allplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{data } }      \\end{array }         } =       {          \\begin{array}{c }        \\includegraphics[width=2cm]{\\thumbdir / map--2048-cmbplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-cmbplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-cmbplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-cmbplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{cmb } }      \\end{array }         } +       {          \\begin{array}{c }        \\includegraphics[width=2cm]{\\thumbdir / map--2048-galplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-galplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-galplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-galplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{galactic } }      \\end{array }         } +       {          \\begin{array}{c }        \\includegraphics[width=2cm]{\\thumbdir / map--2048-thermalszplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-thermalszplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-thermalszplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-thermalszplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{sz } }      \\end{array }         } +       {          \\begin{array}{c }        \\includegraphics[width=2cm]{\\thumbdir / map--2048-poncplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-poncplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-poncplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-poncplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{ps } }      \\end{array }         } +       {          \\begin{array}{c }        \\includegraphics[width=2cm]{\\thumbdir / map--2048-noiseplanck-030 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-noiseplanck-070 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-noiseplanck-217 - -.jpg}\\\\        \\includegraphics[width=2cm]{\\thumbdir / map--2048-noiseplanck-857 - -.jpg}\\\\        \\mbox{\\tiny{noise } }      \\end{array }         } \\ ] ]          the data are processed in fourier space . on the sphere ,",
    "a fourier basis for band limited functions is a doubly - indexed set @xmath158 of orthonormal functions with the property that @xmath159 where @xmath160 is the spherical laplacian .",
    "index @xmath161 is called the angular frequency .",
    "the coordinates @xmath162 of a spherical function on such a basis are called its ` spherical harmonic coefficients ' .",
    "the quantity @xmath163 is the angular spectrum of the function .",
    "if this function is a realization of a stationary process , then @xmath164 is the angular spectrum of the process .",
    "the cmb is thought to be a realization of gaussian stationary process ; accurate estimation of its angular spectrum is one the main scientific products expected from cmb observations .",
    "we compute localized statistics in both space and frequency : first the sphere is decomposed in three zones : a small zone where galactic emission is so strong that no processing is attempted there , a second zone farther away from the galactic center and finally a zone of weak galactic emission which includes both ecliptic poles .",
    "the corresponding masks are shown on fig  [ fig : hitcount+mask ] .",
    "we also localize in fourier space by defining @xmath165 domains which correspond to @xmath166 bins of angular frequency .",
    "the width @xmath167 of these spectral bins increases with the angular frequency @xmath161 , as follows : @xmath168 for @xmath169 , @xmath170 for @xmath171 , @xmath172 for @xmath173 , @xmath174 for @xmath175 , @xmath176 for @xmath177 .",
    "for each of the two spatial domains , we build spectral statistics as follows : the zone of interest is isolated by using ( an apodized version of ) the masks shown on fig  [ fig : hitcount+mask ] ; the spherical harmonic coefficients for each of the 9 frequency channels are computed and collected in a @xmath178 vector @xmath179 for each value of the pair @xmath180 up to @xmath181 ; spectral matrices are then computed for each @xmath182 as @xmath183 . at this stage , since symmetric beams are assumed , their effect can be corrected as @xmath184 where @xmath185 is a diagonal matrix .",
    "we also correct for incomplete sky coverage by dividing each @xmath186 by a factor @xmath187 which is the fraction of the sky left after masking . finally , the spectral matrices are binned into @xmath188 where @xmath189 is the top hat function for the @xmath38th bin .",
    "these matrices collect an effective number @xmath41 of fourier modes given by @xmath190 .",
    "we now fit a parametric model to the localized covariance matrices built at previous section .",
    "we fit independently the two zones of interest and then stitch the resulting maps together . in this illustrative example , we fit a model made of @xmath191 components @xmath192 with the following parametrization / constraints :    the cmb component has a known emission law @xmath193 but unknown angular spectrum @xmath194 so @xmath195 and @xmath196 .    the sz component , as the cmb , is fully coherent and has a known emission law .",
    "hence , we take @xmath197 and @xmath198 .",
    "we try to capture all galactic emission ( which is far from being coherent ) _ together with emission from other galaxies  the ` point source ' component _ , in a 4-dimensional component without other constraints , that is , we set up the ` galactic ' component model as @xmath199 with @xmath200 an unconstrained @xmath201 matrix and @xmath202 a @xmath203 an unconstrained positive matrix so @xmath204 .    for the noise contribution , we rely almost entirely on the instrument characterization : only @xmath8 global parameters are adjustable as described in the third example of component in section [ sec : mylib ] , that is we set up : @xmath205 where @xmath206 is known so @xmath207 .",
    "the fixed spectra @xmath206 are computed from the hit - counts maps and other figures given above .",
    "hence the global parameter vector is @xmath208 $ ] .",
    "note that the angular power spectrum of the cmb is obtained as a by - product of the global fitting procedure .",
    "we show and comment some results from our best - fit model .",
    "* goodness of fit*. the top panel of figure  [ fig : mismatch ] displays the values of @xmath209 versus the spectral domain index @xmath38 ( actually : versus the average angular frequency @xmath161 for this domain ) .",
    "the overall mismatch measure @xmath63 is just the sum of these quantities over all domains : see eq .",
    "( [ eq : idcrit ] ) .",
    "it is possible to predict the average mismatch value ( in the asymptotic regime of many fourier modes per domain ) when the model holds .",
    "this provides at least a reference value in terms of goodness of fit .",
    "this value ( and twice this value ) are displayed as a horizontal line on fig .",
    "[ fig : mismatch ] .",
    "the fit appears good for @xmath210 but not so good for @xmath211 .",
    "this reflects the difficulty of modelling the complex galactic structure ( since this component is important at this range scale ) and also possibly the fact that the assumptions required for predicting the average mismatch are not met in this domain .",
    "the bottom panel of the figure shows how the mismatch increases when the contribution of any one of the components ( except noise ) is removed from the model . in this case , the mismatch explodes , showing that all fitted components are significant here .",
    "* power decomposition at sensor level . * the decomposition ( [ eq : decrq ] ) allows to find the contribution of each component on each detector by domain , _",
    "i.e. _ as a function of angular frequency in the present case",
    ". figure  [ fig : specsmic ] displays for all detectors ( @xmath212 ) the values of @xmath213_{jj}$ ] versus the center frequency of the @xmath38th spectral domain . in other words it shows estimated band - averaged angular spectra for all fitted components .",
    "it also shows the sum of these contributions over all components as well as the values of @xmath214_{jj}$ ] . actually the plot of the former quantity is almost entierly masked by the plot of the latter , evidencing a near perfect fit of the global angular spectrum .    ) .",
    "the line labelled _ stats _ shows the values of @xmath214_{jj}$ ] ; the line labelled _ model _ the values of @xmath215_{jj}$ ] ; the latter is hidden by the former almost everywhere.,title=\"fig:\",width=264 ] ) .",
    "the line labelled _ stats _ shows the values of @xmath214_{jj}$ ] ; the line labelled _ model _ the values of @xmath215_{jj}$ ] ; the latter is hidden by the former almost everywhere.,title=\"fig:\",width=264 ] + ) .",
    "the line labelled _ stats _ shows the values of @xmath214_{jj}$ ] ; the line labelled _ model _ the values of @xmath215_{jj}$ ] ; the latter is hidden by the former almost everywhere.,title=\"fig:\",width=264 ] ) .",
    "the line labelled _ stats _ shows the values of @xmath214_{jj}$ ] ; the line labelled _ model _ the values of @xmath215_{jj}$ ] ; the latter is hidden by the former almost everywhere.,title=\"fig:\",width=264 ]    figure  [ fig : specsmiccross ] shows the cross - spectra between channels , that is the values of @xmath213_{ij}$ ] for @xmath216 selected pairs of channels .    ) .",
    "same conventions as in figure [ fig : specsmic].,title=\"fig:\",width=264 ] ) .",
    "same conventions as in figure [ fig : specsmic].,title=\"fig:\",width=264 ] + ) .",
    "same conventions as in figure [ fig : specsmic].,title=\"fig:\",width=264 ] ) .",
    "same conventions as in figure [ fig : specsmic].,title=\"fig:\",width=264 ]    * cmb angular spectra . * left panel of figure  [ fig : cl_est+res ] shows the estimated angular spectrum @xmath217 with error bars computed from the fisher information matrix . the angular spectrum of the cmb process is known in this simulated data set and displayed as a solid line . an excellent recovery is observed up to angular frequency @xmath218 , together with plausible error bars . *",
    "cmb map*. the cmb map recovered through the localized wiener filter  ( [ eq : locwiener ] ) is shown in figure  [ fig : reccmb ] .",
    "it has no visible contamination but reconstruction is not over the whole sky : the small galactic region ( shown on fig .",
    "[ fig : hitcount+mask ] ) is not reconstructed because the galactic emission is so strong that avoiding any contamination is very difficult .",
    "the bottom map of fig .",
    "[ fig : reccmb ] is the residual _",
    "i.e. _ the error between true and reconstructed cmb maps",
    ". some galactic residuals are now visible indicating that the localization strategy should be improved ( the galactic emission is known to vary a lot across the sky , and especially near the galactic plane ) .",
    "the angular spectrum of the _ residual _ map ( cmb error map ) is shown on the right panel of fig .  [",
    "fig : cl_est+res ] . the linear ( on this log scale )",
    "trend indicates that the error is noise - dominated ( as also seen from the residual map ) .     with @xmath219 error bars given by the fisher information matrix .",
    "we ( conventionally ) plot @xmath220 rather than the plain angular spectrum @xmath221 .",
    "right : angular spectrum of the reconstructed cmb and of the residual in mkcmb@xmath222 .",
    "the red and the black curves are the same reference input cmb spectrum which has been used to generate the cmb component.,title=\"fig:\",height=226 ]   with @xmath219 error bars given by the fisher information matrix . we ( conventionally ) plot @xmath220 rather than the plain angular spectrum @xmath221 .",
    "right : angular spectrum of the reconstructed cmb and of the residual in mkcmb@xmath222 .",
    "the red and the black curves are the same reference input cmb spectrum which has been used to generate the cmb component.,title=\"fig:\",height=226 ]    mk  cmb ) .",
    "bottom : difference map ( color scale : @xmath223  mk  cmb).,title=\"fig : \" ]  mk  cmb ) .",
    "bottom : difference map ( color scale : @xmath223  mk  cmb).,title=\"fig : \" ] +  mk  cmb ) .",
    "bottom : difference map ( color scale : @xmath223  mk  cmb).,title=\"fig : \" ]    * galactic and point source emission reconstruction*. the most complex component is due to the radiation from the interstellar medium in our galaxy ( galactic emission ) as well as other galaxies ( which contribute most of the emission of extragalactic ` point sources ' ) .",
    "the present work focuses on cmb reconstruction , and no attempt has been made to separate the galactic emissions on the basis of the astrophysical radiation emission process ( synchrotron emission , ` free - free ' emission , or grey body emission from dust particles ) , nor on the basis of their origin ( within our own galaxy , or in other galaxies ) . for this reason",
    ", the sum of these emissions _ outside our galactic + point source mask _ has been tentatively represented by a 4-dimensional ` catch all ' model as explained above .",
    "the result of the separation for this component is shown in fig .",
    "[ fig : galrec ] . in spite of small discrepancies in the reconstruction on large angular scales ,",
    "the result is quite satisfactory .",
    "angular power spectra for this model , displayed in fig .",
    "[ fig : specsmic ] clearly correspond to the sum of the steep galactic power spectrum , and a flat plateau at large angular frequency @xmath161 , due to the contribution of emissions from the large number of extragalactic sources not masked by our point source mask .",
    "+   +   +   +",
    "the component separation technique discussed in this paper offers great modeling flexibility from the realization that separation can start with _ covariance matrix separation _ _i.e . _ the identification of individual component terms in the domain - wise decomposition  ( [ eq : decrq]) followed by _ data separation _ according to  ( [ eq : wiener ] ) .",
    "too much flexibility may also introduce difficulties , though . indeed , whether or not minimizing the covariance matching criterion @xmath63 leads to _ uniquely _ identified components depends on the particular choice of component models . in our approach , however , the amount of constraints imposed on any component is fully tunable . by using more or less constrained components ,",
    "the method ranges from totally blind to semi - blind , to non - blind .    some other good points are the following .",
    "* speed * : the method is potentially fast because large data sets are compressed into a much smaller set of covariance matrices . *",
    "accuracy * : the method is potentially accurate because it can model complex components and then recover separated data via local wiener filters which are naturally adapted to the local snr conditions . * noise * : the method can take noise into account without increased complexity since noise is not processed differently from any other component .",
    "* prior * : the implementation also allows for easy inclusion of prior information about a component @xmath22 if it can be cast in the form of a prior probability distribution @xmath224 in which case one only need to subtracting @xmath225 from @xmath63 and the related changes can be delegated to the component code . * varying resolution * : in our application , and possibly others , the input channels are acquired by sensors with channel - dependent resolution . accurate component separation requires to take this effect into account .",
    "this can be achieved with relative simplicity if the data coefficients entering in @xmath46 are fourier ( or spherical harmonic ) coefficients .",
    "* built - in goodness of fit * via the mismatch measure  ( [ eq : idcrit ] ) .",
    "this paper combines several ideas already known in the ica literature : lumping together correlated components into a single multidimensional component is in @xcite ; minimization of a covariance - matching contrast @xmath63 derived from the log - likelihood of a simple gaussian model is found for instance in  @xcite ; the extension to noisy models is already explained in  @xcite .",
    "the current paper goes one step further by showing how arbitrarily structured components can be separated and how the related complexity can be managed at the software level by a library of components .    * about gaussianity*. the specific choice of the matching criterion ( [ eq : idcrit ] ) stems from a gaussian model for the signal coefficients and the linear wiener filter  ( [ eq : wiener ] ) is optimal only for gaussian signals .",
    "hence , there is no doubt that an improved statistical efficiency could be gained by resorting to non gaussian models and to non - linear filtering for strongly non gaussian data .",
    "however , this is more easily said than done , non gaussian modeling / processing being often more difficult and costly to implement . by sticking to simple gaussian assumptions",
    ", we can afford to model a non trivial correlation structure ( through domains and through sensors ) so it is not clear yet what the good trade - off is .",
    "it may depend very much on the scientific objectives ( recovery of cmb versus recovery of other components , ability to predict estimation errors ,  ) and technical constraints ( _ e.g. _ fast codes are important for assessment via monte - carlo runs ) .",
    "intensive work is in progress within the planck collaboration to assess the performance of various approaches for cmb analysis .",
    "we acknowledge the use of healpix  @xcite for all sphere - based computations .",
    "our code is implemented in octave ( ` octave.org ` ) .",
    "synthetic data are made available thanks to the planck collaboration .",
    "maude martin was partially supported by astromap and cosmostat grants , two aci programs of cnrs .        c.  l. bennett , r.  s. hill , g.  hinshaw , m.  r. nolta , n.  odegard , l.  page , d.  n. spergel , j.  l. weiland , e.  l. wright , m.  halpern , n.  jarosik , a.  kogut , m.  limon , s.  s. meyer , g.  s. tucker , and e.  wollack . .",
    ", 148:97117 , september 2003 .",
    "jacques delabrouille and jean - franois cardoso .",
    ", chapter diffuse source separation in cmb observations .",
    "ecture notes in physics .",
    "springer , 2007 .",
    "editors : vicent j. martinez , enn saar , enrique martinez - gonzalez , maria jesus pons - borderia .",
    "jacques delabrouille , jean - franois cardoso , and guillaume patanchon .",
    "detector multi ",
    "component spectral matching and applications for cmb data analysis .",
    ", 346(4):10891102 , december 2003 . also available as http://arxiv.org/abs/astro-ph/0211504",
    ".                      h.  snoussi , g.  patanchon , j.  f. macas - prez , a.  mohammad - djafari , and j.  delabrouille . .",
    "in r.  l. fry , editor , _ bayesian inference and maximum entropy methods in science and engineering _ , volume 617 of _ american institute of physics conference series _",
    ", pages 125140 , may 2002 ."
  ],
  "abstract_text": [
    "<S> this paper offers a new point of view on component separation , based on a model of additive components which enjoys a much greater flexibility than more traditional linear component models . </S>",
    "<S> this flexibility is needed to process the complex full - sky observations expected from the planck space mission , for which it was developed , but it may also be useful in any context where accurate component separation is needed . </S>"
  ]
}