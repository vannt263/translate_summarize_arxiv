{
  "article_text": [
    "photonic crystals ( phcs ) remain to attract a considerable attention of the scientific community due to their unique properties and potential technological applications @xcite . to a large extent ,",
    "phcs applications are based on the photonic bandgap effect and involve sophisticated defect structures , cavities and wave guides in the periodic crystal host .",
    "the full dynamics of the electromagnetic field in such structures may be studied in principle rigorously by direct numerical solution of maxwell s equations using the finite difference time domain ( fdtd ) method @xcite . for the calculation of stationary modes , however , the numerical effort may be substantially reduced by using the galerkin method @xcite , i.e. , by expanding the electromagnetic field in terms of an appropriate orthonormal set of basis functions which renders the stationary electromagnetic wave equation as a discrete matrix eigenvalue problem . in this case",
    "the proper choice of the set of basis functions is crucial in order to obtain an accurate description while keeping the dimension of the eigenvalue problem minimal .    while for extended wave problems an expansion in terms of bloch functions , the eigenmodes of the unperturbed phc , is natural @xcite , for the description of defect structures",
    "the use of wannier functions as a basis set @xcite is in principle superior , because wannier functions may be constructed as being localized in space and are still an exact representation of the point symmetry group of the host phc .",
    "effective solutions developed for the electronic case , namely , maximally localized generalized wannier functions @xcite , have been applied only recently to the electromagnetic case @xcite . since then , the theory of photonic wannier functions has been applied to the analysis of 2d phc cavities , waveguides @xcite , waveguide crossings @xcite and phc heterostructures @xcite .",
    "the generalization of the approach to the case of 2d slab phcs and 3d phcs has been also reported in @xcite .",
    "however , the construction of well - localized wannier functions involves a multidimensional optimization problem @xcite , with the arbitrary phase of each bloch mode ( defined below ) as optimizations parameters .",
    "therefore , the practical importance of this approach has been fairly limited up to now . in the present work",
    "we systematically analyze this optimization problem employing local as well as global optimization procedures .",
    "we propose a novel locality measure for the wannier functions which allows for a highly efficient optimization of the locality of the wannier function .",
    "wannier functions are defined as the fourier transform of the bloch modes @xmath0 with respect to the wave vector @xmath1 , @xmath2 the bloch mode is a solution of the corresponding wave equation in a periodic medium , where @xmath3 is a lattice - periodic envelope function , and we have explicitly denoted the arbitrary phase @xmath4 of the bloch function , the bloch phase .",
    "@xmath5 is the band index . for simplicity ,",
    "in the present work we do not consider mixing of different bands @xcite in the construction of wannier functions from bloch modes .",
    "from the definitions ( [ eq : bloch_def ] ) , ( [ eq : wan_def ] ) it is seen that the wannier functions would be @xmath6-localized in space only if the envelopes @xmath3 were constant . by contrast , for arbitrary bloch phases @xmath4 the wannier functions have actually a rather large spatial extension due to the oscillatory character of the @xmath3 , a feature which becomes more and more pronounced for higher band indices @xmath5 .",
    "however , the gauge freedom in the bloch phases may be employed to adjust , for each @xmath1 , the value of @xmath4 so as to construct maximally localized wannier functions with respect to some locality criterion .",
    "this constitutes a complex , multidimensional optimization problem .",
    "the choice of the locality measure is not unique .",
    "the common choice used in the literature @xcite is to minimize the second moment ( sm ) of the modulus square of the wannier function @xcite .",
    "unfortunately , it turned out that the sm , as a functional of the set of bloch phases @xmath4 , has multiple local minima , so that local optimization procedures , like the conjugate gradient method , tend not to find the global minimum and the locality of the wannier function optimized in this way depends sensitively on the initial set of bloch phases .",
    "global optimization procedures are , on the other hand , slow and computationally exceedingly expensive .",
    "the purpose of this paper is a systematic analysis of different locality measures using both local and global optimization methods . in section [ sec : sm ]",
    "we construct sm optimized maximally localized wannier functions , comparing conjugate gradient ( local ) and genetic - algorithm - based ( global ) methods .",
    "this analysis leads us in section [ sec : im ] to propose a new locality measure , namely the integrated modulus square ( i m ) measure , resulting in an optimization problem with a single extremum only .",
    "this allows one to use fast and efficient local optimization techniques to construct maximally localized wannier functions . in section [ sec : bc ] we show that , if the bloch modes conform certain conditions , it is possible to find an optimal set of bloch phases with respect to the i m locality measure analytically . although the required constrains will not be fulfilled in the general case , the wannier functions calculated using such an analytical set of phases show strong tendency towards localizations and can be used as an efficient starting point for the numerical optimization . in section [ sec : applications ] using several examples of phc defect structures , the quality of the constructed wannier functions is demonstrated .",
    "section [ sec : conclusion ] concludes the paper .",
    "in what follows , we limit ourselves to the two - dimensional ( 2d ) case , which is characterized by the periodic dielectric functions @xmath7 , @xmath8 , with @xmath9 denoting a 2d vector in the @xmath10-@xmath11-plane and @xmath12 being a lattice vector of some 2d lattice @xmath13 . in this case , the wave equation for time harmonic tm ( transverse magnetic ) , @xmath14 , and te ( transverse electric ) , @xmath15 , polarization reads , respectively , @xmath16 the wave operators @xmath17 and @xmath18 are hermitian with respect to the corresponding inner products : @xmath19 @xmath20 @xmath21 is the 2d volume of the crystal .",
    "it is important to mention , that the completeness and orthogonality of the bloch modes @xmath22 and @xmath23 translates into the completeness and orthogonality of wannier functions @xmath24 with respect to the corresponding inner product : @xmath25 moreover , the translation property of the wannier functions , @xmath26 follows from the periodicity of the envelope functions @xmath27 .    in this work four different two - dimensional photonic crystals are analyzed for both fundamental polarizations .",
    "square ( sq ) and triangular ( tr ) lattices of dielectric rods in air ( d ) and air rods in dielectric ( a ) are considered . in what follows",
    "we will refer to these systems as sq - d , tr - d , sq - a and tr - a , respectively .",
    "the radius of rods and the dielectric constant of dielectric material and air are chosen to be @xmath28 , @xmath29 and @xmath30 , respectively .",
    "we adopt the following definition of the second moment of the wannier function @xmath24 : @xmath31 with @xmath32 being the wannier center .",
    "two positions of the wannier center will be analyzed further , ( i ) in the center of the scatterer ( `` on - site '' ) and ( ii ) in the geometrical center between four ( three ) scatterers in the case of square ( triangular ) lattices ( `` between '' ) . for example , in a square lattice with lattice constant @xmath33 , the wannier center can be set to @xmath34 ( on - site ) or @xmath35 ( between ) , where @xmath36 .",
    "( inverse locality ) of the wannier functions in the @xmath5th band , minimized by using the conjugate gradient method .",
    "four different , randomly chosen initial sets of bloch phases , a , b , c , d , were used for the cg optimization .",
    "top : sq - d crystal , tm polarization .",
    "bottom : tr - d crystal , te polarization . ]",
    "the commonly adopted way of finding maximally localized wannier functions is to minimize the corresponding second moment @xmath37 with respect to the set of bloch phases @xmath4 in the @xmath5th band .",
    "note that , by definition of the sm , the regions far away from the wannier center ( where the wannier functions usually have an increasingly complex structure ) contribute to the sm with quadratically increasing weight . for this optimization",
    "we first apply a standard conjugate gradient ( cg ) method .",
    "this method tends to get trapped in the local extrema and , hence , requires a careful choice of the initial set of bloch phases @xcite . in figure",
    "[ fig : cg_results_sm ] representative examples of the locality of the sm - optimized wannier functions are shown for sq - d ( tm polarization ) and tr - d ( te polarization ) structures . here and in the following",
    ", the bloch modes have been calculated using the plane wave expansion method @xcite .",
    "the minimized sm ( i.e. , the inverse locality ) of the wannier functions in the first eight bands are displayed for four different , random distributions of the initial bloch phases .",
    "as expected , the optimal locality obtained using the cg method depends crucially on the choice of the initial phases .",
    "this is an indication that the sm of the wannier functions possesses several local minima .    ) of the sm - optimized wannier functions as a function of ga generation for the sq - d structure , tm polarization , 3rd band ( top ) and for the sq - a structure , te polarization , 5th band ( bottom ) .",
    "the dashed , green line shows the locality of the best - localized wannier function in each generation .",
    "every 100 generations , these wannier functions served as a starting point for the subsequent cg optimization step ( red crosses ) .",
    "on the right hand side , the modulus square of the sm - optimized wannier function is shown for an early ( top : 40000th , bottom : 38300th ) and a later ( top : 60000th , bottom : 100000th ) generation , respectively.,title=\"fig : \" ] + ) of the sm - optimized wannier functions as a function of ga generation for the sq - d structure , tm polarization , 3rd band ( top ) and for the sq - a structure , te polarization , 5th band ( bottom ) .",
    "the dashed , green line shows the locality of the best - localized wannier function in each generation .",
    "every 100 generations , these wannier functions served as a starting point for the subsequent cg optimization step ( red crosses ) . on the right hand side ,",
    "the modulus square of the sm - optimized wannier function is shown for an early ( top : 40000th , bottom : 38300th ) and a later ( top : 60000th , bottom : 100000th ) generation , respectively.,title=\"fig : \" ]      the proper choice of the initial set of bloch phases is in general not trivial @xcite . even if such a choice can be justified , one can never be sure that the resulting sm - optimized wannier functions indeed correspond to the global minimum of the sm . to solve the global optimization problem and to examine the validity of the sm optimization in more detail , we have applied a global , stochastic - based optimization technique , namely a genetic algorithm ( ga ) method @xcite .",
    "taking the biologic evolution in nature as a model , the ga method works with a population of individuals which pass through a selection procedure and can reproduce themselves .",
    "each wannier function represents an individual .",
    "the set of bloch phases , which determines the wannier function , is represented as a large , binary string .",
    "the ga method starts with a population of random wannier functions and passes them through a selection procedure where only that one half of the wannier functions are retained which are most strongly localized with respect to the given locality criterion (  most fit individuals ) . in a second step ,",
    "these survived individuals are allowed to reproduce themselves by randomly mixing their strings of phases , thus passing their attributes to the offsprings . together with their off - springs ,",
    "the survived individuals , which correspond to better localized wannier functions , comprise the new generation . by iterating this procedure over several thousands of generations",
    "the algorithm will converge slowly but definitely towards the global extremum .",
    "once the ga procedure has reached the valley of the global extremum , the cg method should be applied subsequently to the ga algorithm in order to accelerate the convergence and improve the accuracy of the solution @xcite .    in figure  [ fig : ga_sm ]",
    "the evolution of the ga results is depicted for two representative systems and polarizations .",
    "every 100 generations a wannier function with highest locality in the current population was taken as a starting point for the subsequent cg optimization . over the first several thousand generations",
    "the locality of the resulting wannier functions is varying strongly , indicating hopping of the solution among different local minima due to the stochastic nature of the algorithm . at the top panel of figure  [ fig : ga_sm ]",
    "one can observe how the algorithm is stuck in a local minimum over several thousands of generations , before it escapes and reaches the global minimum valley at around the 50000th generation .",
    "an improvement of the locality for later generations is clearly seen from the modulus square of the optimized wannier functions ( figure  [ fig : ga_sm ] , right panels ) .",
    "the discontinuous nature of the ga method ensures with stochastic certainty that the global minimum of the sm is found , providing the best localization of the wannier functions with respect to a given locality measure . at the same time",
    ", however , the numerical load of the ga method exceeds the one of the cg method by far , making it inappropriate for routine application for an efficient construction of maximally localized wannier functions .",
    ") of the wannier functions optimized with respect to the i m locality measure using the cg method .",
    "four different randomly chosen initial sets of bloch phases were used for the cg optimization .",
    "top : sq - d crystal , tm polarization .",
    "bottom : tr - d crystal , te polarization . ]",
    "the complicated structure of the wannier functions at large distances , which is expressed by several local minima of their sms and the associated difficulties in the construction of maximally localized wannier functions , motivates the search for a simpler criterion for the locality of wannier functions . here",
    ", we introduce a new criterion , the integrated modulus square ( i m ) , defined as @xmath38 where the integration region is the first unit cell ( uc ) around the wannier center ( uc ) .",
    "we choose the function @xmath39 in such a way , that the i m is equal to unity for a wannier function which is completely confined within such a unit cell .",
    "i.e. , @xmath40 a well localized wannier function corresponds to a large i m , and one needs to maximize the i m in order to obtain the maximally localized wannier functions .",
    "the i m is a very sharp criterion , since it does not depend on the structure of the wannier functions outside of the integration region at all .",
    "we examined the i m locality measure as a localization criterion for the same four different physical systems and both polarizations as it was done in the sm case .",
    "to that end we construct maximally localized wannier functions using the same four different , randomly chosen initial sets of bloch phases as in section [ sec : sm ] .",
    "representative examples of cg optimization are shown in figure  [ fig : cg_results_im ] .",
    "in contrast to the sm case , the localities of the resulting wannier functions coincide for all four sets of phases .",
    "this is the case for all considered systems and polarizations , strongly indicating that the i m locality measure does not possess any local extrema .    )",
    "of the im - optimized wannier functions as a function of ga generation for the sq - d structure , tm polarization , 3rd band ( top ) and for the sq - a structure , te polarization , 5th band ( bottom ) .",
    "the dashed green line shows the locality of the best - localized wannier function in each generation .",
    "every 100 generations these wannier functions served as a starting point for the subsequent cg optimization step ( red crosses ) . on the right - hand side ,",
    "the modulus square of the sm - optimized wannier functions is shown for an early ( 20000th ) and a later ( 60000 ) generation , respectively.,title=\"fig : \" ] + ) of the im - optimized wannier functions as a function of ga generation for the sq - d structure , tm polarization , 3rd band ( top ) and for the sq - a structure , te polarization , 5th band ( bottom ) .",
    "the dashed green line shows the locality of the best - localized wannier function in each generation .",
    "every 100 generations these wannier functions served as a starting point for the subsequent cg optimization step ( red crosses ) . on the right - hand side ,",
    "the modulus square of the sm - optimized wannier functions is shown for an early ( 20000th ) and a later ( 60000 ) generation , respectively.,title=\"fig : \" ]    to support this hypothesis , we applied the ga method to solve the optimization problem .",
    "for all considered structures no significant variation of the locality has been observed for different ga generations .",
    "representative examples are shown in figure  [ fig : ga_im ] .",
    "one can clearly see , that over many thousands of generations the locality of the wannier functions optimized with respect to i m criterion stays constant .",
    "this proves numerically that the considered optimization problem possesses a single extremum , making the procedure independent on the choice of the initial set of bloch phases . as a consequence ,",
    "the use of the i m as a locality criterion together with the cg as an optimization method represents a fast as well as reliable method for the construction of maximally localized wannier functions",
    ". figures  [ fig : mlwf_dielrods_tm ] and [ fig : mlwf_airrods_te ] show the maximally localized wannier functions for the first several bands of the sq - d ( tm polarization ) and sq - a ( te polarization ) structures , respectively . in both cases",
    "the i m criterion was used along with the cg method .",
    "the optimized wannier functions demonstrate good locality which degrades slowly with increasing band indices , since the envelope functions become more and more oscillatory , reflecting the not - plane - wave like nature of bloch modes .",
    "it is worth noting , that the wannier functions optimized with respect to the i m and sm criteria are in general not equal , even if the global minimum of the sm or the global maximum of the i m has been reached .",
    "for example for the system of dielectric rods in air ( tm polarization ) the sm- and im - optimized wannier functions coincide for the 1st and the 2nd band ( not shown ) , but not for the third band ( top right wannier function in figures  [ fig : ga_sm ] and [ fig : ga_im ] ) .",
    "sometimes , it is beneficial to use the time - reversal symmetry of wave operators @xmath17 and @xmath18 to construct real wannier functions .",
    "this is possible , since the envelope functions of the bloch modes transform as @xmath41 under time reversal ( inversion of the reciprocal space ) , and the bloch phases can be constrained by the condition @xmath42 by restricting the parameter space of the optimization problem in such a way , we found that both sm and i m optimization criteria possess multiple extrema , making the use of local optimization method not efficient without special choice of the initial bloch phases .",
    "however , using real - valued wannier functions is of advantage for the considerations of the next section .",
    "here we propose an analytical expression for a generic set of bloch phases to be used as a starting point for the optimization procedure .",
    "it is based on the following theorem .    _",
    "theorem : _ suppose that ( i ) the wannier functions are real - valued , i.e. , @xmath43 , and the bloch functions @xmath44 conform to the following conditions : @xmath45 has the same sign ( i ) for all points @xmath46 in the unit cell and ( ii ) for all wave vectors @xmath1 in the first brillouin zone ( for each component of the vector bloch function ) . then maximizing the i m of the wannier functions , @xmath47 with respect to the bloch phases @xmath4 is equivalent to maximizing the i m of the real part of the bloch functions in the first unit cell around the wannier center , @xmath48 for each wave vector in the first brillouin zone separately .",
    "this theorem holds in any spatial dimension , even though in this paper we consider two - dimensional systems only .",
    "note that in the above expressions we have set the weight factor @xmath39 appearing in eq .",
    "( [ eq : def_im ] ) equal to unity for simplicity .",
    "the proof is straightforward . due to the translation property of the wannier function , , it is sufficient to prove the equivalence for @xmath49 only . in this case @xmath50    ) optimized wannier functions for a square lattice of dielectric rods in air ( tm polarization ) .",
    "for n=1,2,4 the bloch criterion is equivalent to the im - criterion for real wannier functions .",
    "for n=3,5,6 the wannier functions show at least a tendency to localize around the wannier center . ]",
    "it is easy to recognize that the equality @xmath51 holds , if the conditions ( ii ) and ( iii ) are fulfilled .",
    "since the wannier functions are chosen to be real - valued ( i ) , the functional on the left - hand side is maximized by the same set of @xmath4 as @xmath52 , which proves the theorem .",
    "the maximization problem can be solved analytically leading to the following set of bloch phases @xmath53 where @xmath54^{1/2}$ ] is the ( complex ) amplitude of the vector bloch function .",
    "relation defines the bloch optimization criterion .",
    "note that the phases which are transformed by @xmath55 , or equivalently @xmath56 , also fulfill .",
    "furthermore , the phases which fulfill also obey and , therefore , the wannier functions optimized with respect to the bloch criterion are real - valued , as initially assumed .    due to the strongly oscillatory nature of bloch functions in coordinate space ( especially for the higher order bands ) , condition ( ii ) will hardly be fulfilled exactly in a realistic system .",
    "but the conditions ( i ) and ( iii ) can always be fulfilled simply by correct choice of the phase factor sign . in figure",
    "[ fig : blochoptwf ] an example of the bloch criterion optimization is shown for the sq - d structure ( tm polarization ) . for the 1st , 2nd and 4th bands",
    "bloch functions fulfill bloch criterion conditions at least approximately , and an analytical set of bloch phases leads to well localized wannier functions . even in the case when the bloch functions do not maximize the bloch criterion eq .",
    "( [ eq : blochcrit ] ) exactly , the wannier functions optimized with respect to exhibit a tendency to localize around its wannier center . the same tendency has been obtained for all four test structures in both fundamental polarizations .",
    "this suggests to use the analytical set of bloch phases as an initial set of phases for the numerical optimization , using either second moment or integrated modulus methods .",
    "this should help avoiding the local minima trapping problem and can reduce the computation time considerably .",
    "in a a square lattice of dielectric rods in air ( tm polarization ) .",
    "the dots indicate the results of the wannier function approach by taking the first eight bands into account .",
    "they are in complete agreement with plane wave calculations ( red line ) @xcite . at the bottom the real part of two defect modes with @xmath57 and @xmath58 is shown . ]    in this section the quality of i m optimized wannier functions is demonstrated by using them as a basis set for photonic crystal defect structure analysis . in figure",
    "[ fig : reprbs ] the reconstructed tight - binding band structure of a square lattice of dielectric rods in air ( tm polarization ) is shown .",
    "the number of lattice sites taken into account in the nearest neighbor approximations were increased successively .",
    "the deviation of the reconstructed band structure from the original band structure decreases by increasing the number of next neighbors taken into account . by restricting to lattice sites separated by up to four lattice constants the band structure",
    "is reproduced well except for small deviation at higher bands and symmetry points .",
    "the slight mismatch for higher bands is due to the fact that the higher band wannier functions are not as well localized as the lower ones .",
    "we further calculated the modes and frequencies of a point defect structures which consist of a single rod with deviating permittivity @xmath59 at @xmath60 in the sq - d structure .",
    "the light propagation inside the band gap between the first and the second band is forbidden and the formation of a localized defect mode is possible .",
    "we split up the total permittivity @xmath61 into a periodic term @xmath62 which corresponds to the unperturbed system , and a defect term @xmath63 .",
    "an expansion of the @xmath64-component of the electric field in terms of maximally localized wannier functions leads to a generalized eigenvalue problem with sparse matrices @xcite .",
    "the defect mode frequencies are obtained from the solution of this sparse system ( fig .",
    "[ fig : pointdefect ] ) .",
    "the first eight wannier functions have been taken into account .",
    "there are monopole like defect modes for a defect rod permittivity of @xmath65 and doubly degenerated , dipole like modes for higher permittivities in the defect rod @xmath66 .",
    "the results are in complete agreement with plane wave calculations @xcite . to analyze contribution of the individual wannier functions to the defect mode",
    ", the band index contribution @xmath67 where the normalization factor is given by @xmath68 is shown in figure [ fig : bandcontri ] for the defect modes @xmath57 and @xmath58 .",
    "one can see , that @xmath69 rapidly decrease for higher band indices .",
    "since the defect mode frequencies are in between the 1st and the 2nd band , only the lower band wannier functions contribute to the defect modes .",
    "therefore it is justified to cut of the band index which reduces the numerical load .",
    "the procedure to construct maximally localized wannier functions by bloch phase optimization was analyzed for several two dimensional photonic crystals for both fundamental polarizations , using two different locality measures .",
    "although the stochastic , genetic algorithm is numerically too costly for routine application , it has , as a global optimization method , provided us an important benchmark to judge under which conditions the faster and less memory intensive , but local conjugate gradient method finds the global optimum of a given locality measure .",
    "we found that the commonly used second moment locality measure has generically multiple extrema , which makes it difficult to construct maximally localized wannier functions by local optimization techniques .",
    "one may conjecture that this multiplicity results from the complex oscillatory behavior of the ( not yet optimized ) wannier functions at large distances from the wannier center , which makes the dominant contribution to the second moment .",
    "this led us to propose a new locality measure which is controlled by the behavior close the wannier center , the integrated modulus square measure .",
    "we showed numerically by comparison of conjugate gradient and genetic algorithm optimization that this measure does not feature multiple extrema and is , therefore , suitable for fast and efficient local optimization techniques , like the standard conjugate gradient method .",
    "because this result presumably originates from the local nature of the integrated modulus measure , it should hold generally , not only for two - dimensional systems , but also in three dimensions for photonic as well as electronic lattices .",
    "we also presented and tested an analytical formula for the set of bloch phases to be used as a starting point of the optimization process .",
    "this initial set of bloch phases is suggested because , albeit it does not solve the optimization problem in general , it does generate maximally localized wannier functions in special cases where the optimization problem can be solved analytically .",
    "we expect that these two main results may significantly increase the efficiency of the wannier function approach for the description of defect structures in photonic lattices .",
    "y.  jiao , s.  mingaleev , m.  schillinger , d.  miller , s.  fan , and k.  busch , `` wannier basis design and optimization of a photonic crystal waveguide crossing , '' ieee photonics technol . lett . * 17 * , 18751877 ( 2005 ) ."
  ],
  "abstract_text": [
    "<S> wannier function expansions are well suited for the description of photonic - crystal - based defect structures , but constructing maximally localized wannier functions by optimizing the phase degree of freedom of the bloch modes is crucial for the efficiency of the approach . </S>",
    "<S> we systematically analyze different locality criteria for maximally localized wannier functions in two - dimensional square and triangular lattice photonic crystals , employing ( local ) conjugate - gradient as well as ( global ) genetic - algorithm - based , stochastic methods . </S>",
    "<S> besides the commonly used second moment ( sm ) locality measure , we introduce a new locality measure , namely the integrated modulus ( i m ) of the wannier function . </S>",
    "<S> we show numerically that , in contrast to the sm criterion , the i m criterion leads to an optimization problem with a single extremum , thus allowing for fast and efficient construction of maximally localized wannier functions using local optimization techniques . </S>",
    "<S> we also present an analytical formula for the initial choice of bloch phases , which under certain conditions represents the global maximum of the i m criterion and , thus , further increases the optimization efficiency in the general case . </S>"
  ]
}