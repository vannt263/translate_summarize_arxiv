{
  "article_text": [
    "images are produced to record or display useful information .",
    "due to the visibility of images and the rapid development of science and technology , images play an increasingly important role in our lives .",
    "however , because of imperfections in the imaging and capturing process , the recorded image invariably represents a degraded version of the original scene ( @xcite ) .",
    "the undoing of these imperfections is crucial to many of the subsequent image processing tasks .",
    "there exists a wide range of different degradations .",
    "a very important example is the existence of noise .",
    "noise may be introduced by the medium through which the image is created and transmitted . in this paper , we concentrate on removing impulse noise and its mixture with gaussian noise .",
    "we present a numerical image by a @xmath0 matrix @xmath1 , where @xmath2 is the image domain , and @xmath3 represents the gray value at the pixel @xmath4 for 8-bit gray images .",
    "the additive gaussian noise model is : @xmath5 where @xmath6 is the original image , @xmath7 is the noisy one , and @xmath8 is the gaussian noise : @xmath9 are independent and identically distributed gaussian random variables with mean @xmath10 and standard deviation @xmath11 . in the sequel",
    "we always denote by @xmath12 the original image , and @xmath13 the noisy one .",
    "the random impulse noise model is :    @xmath14 where @xmath15 is the impulse probability ( the proportion of the occurrence of the impulse noise ) , and @xmath9 are independent random variables uniformly distributed on @xmath16 $ ] , generally taken as [ 0,255 ] for 8-bit gray images .",
    "the task of image denoising is to recover the unknown original image @xmath12 as well as possible from the degraded one @xmath13 .",
    "there are a lot of denoising methods in the literature . to remove gaussian noise , there are approaches based on wavelets @xcite , approaches based on variational models @xcite , and weighted means approaches @xcite , etc .",
    "a very important progress is the proposition of the non - local means filter ( nl - means ) @xcite , which estimates original images by weighted means along similar local patches . since then , many researchers combined the ideas of  local patch \" and other methods to remove noise , for instance @xcite .",
    "there are also many methods to remove impulse noise including , for example , median based filters @xcite , fuzzy filters @xcite , variational based methods @xcite .",
    "because gaussian noise and impulse noise have different characters , the above - mentioned methods can only be used for removing only one kind of noise ( gaussian noise or impulse noise ) , and can not be applied to remove a mixture of gaussian noise and impulse noise . to remove mixed noise ,",
    "a successful method is the trilateral filter @xcite : it introduces an interesting statistic called road ( rank of ordered absolute differences ) to detect impulse noisy pixels , and combines it with the bilateral filter @xcite to remove noise .",
    "the trilateral filter @xcite is also effective for removing impulse noise ; a variant of the road statistic , named rold ( rank - ordered logarithmic difference ) , has been proposed in @xcite , where it is combined with the edge - preserving variational method @xcite for removing impulse noise .",
    "other methods have also been developed recently to remove mixed noise .",
    "the papers @xcite use the patch - based idea of nl - means to remove impulse noise and mixed noise . in @xcite , generalizations of nl - means are proposed for removing impulse noise and its mixture with gaussian noise with the help of the road statistics @xcite ; the main idea is to define weights in terms of the road statistics and the similarity of local patches , which are nearly zero for impulse noisy points . in @xcite ,",
    "nl - means is adapted by estimating the similarity of patches with the reference image obtained in an impulse noise detection mechanism .",
    "the papers @xcite also use a patch - based approach : they introduce a robust distance inspired by order statistics to estimate the similarity between patches using the tail of the binomial distribution , and use the maximum likelihood estimator ( mle ) to estimate the original image .",
    "the methods in @xcite and @xcite use the ideas of the state - of - the - art gaussian noise removal methods bm3d @xcite and k - svd @xcite respectively to remove mixed noise ; the algorithm proposed in @xcite is based on a bayesian classification of the input pixels , which is combined with the kernel regression framework .",
    "the success of nl - means @xcite explores in a nice way the similarity phenomenon which is widespread in natural images .",
    "many filters have been developed based on the basic idea of nl - means as stated before .",
    "but the theoretic aspects have not been so much studied .",
    "a probabilistic explanation called similarity principle is given in @xcite .",
    "here we improve this principle by proving a marcinkiewicz law of large numbers and a convergence theorem in distribution , which describe the rate of convergence of nl - means .",
    "we will also introduce the notion of degree of similarity to estimate the influence of similarity on nl - means .",
    "based on the convergence theorems , we propose a new filter , called patch - based weighted means filter ( pwmf ) to improve the mixed noise filter ( mnf ) introduced in @xcite .",
    "compared to mnf , the new filter simplifies the joint impulse factor in mnf , adds a spatial factor , and adjusts the choice of parameters .",
    "experimental results show that our new filter is competitive both for removing impulse noise and mixed noise compared to recently developed filters @xcite . for",
    "the sake of completeness , let us mention that this paper is an extended and improved version of the conference proceeding version @xcite .",
    "this paper is organized as follows . in section 2",
    ", we recall the non - local means filter @xcite , establish two convergence theorems to show the rate of convergence of nl - means , and introduce the notion of degree of similarity . in section 3 , we recall the trilateral filter @xcite and introduce our new filter .",
    "experiments are presented in section 4 .",
    "conclusions are made in section 5 .",
    "in this section , we first establish a marcinkiewicz law of large numbers and a convergence theorem in distribution for nl - means @xcite .",
    "we then introduce the notion of degree of similarity to measure the role of similarity in image restoration .      for @xmath17 and @xmath18 an odd integer ,",
    "let @xmath19 be the window with center @xmath4 and size @xmath20 , where @xmath21 for @xmath22 and @xmath23 . and",
    "set @xmath24 .",
    "we sometimes simply write @xmath25 and @xmath26 for @xmath27 and @xmath28 , respectively .",
    "denote @xmath29 as the vector composed of the gray values of @xmath13 in the window @xmath25 arranged lexicographically .",
    "the denoised image by nl - means is given by @xmath30 with @xmath31 where @xmath32 is a control parameter , @xmath33 @xmath34 being some fixed weights usually chosen to be a decreasing function of the euclidean norm @xmath35 or @xmath36 , and @xmath37 is the translation mapping of @xmath38 onto @xmath39 : @xmath40 originally , @xmath41 in @xmath42 is chosen as the whole image @xmath43 , but in practice , it is better to choose @xmath41 with an appropriate number @xmath44 .",
    "we call @xmath41 search windows , and @xmath45 local patches .",
    "we now present two convergence theorems for nl - means using probability theory . for simplicity",
    ", we use the same notation @xmath46 to denote both the observed image patch centered at @xmath4 and the corresponding random variable ( in fact the observed image is just a realization of the corresponding variable ) .",
    "therefore the distribution of the observed image @xmath46 is just that of the corresponding random variable .",
    "two patches @xmath46 and @xmath47 are called similar if they have the same probability distribution .",
    "[ defi1 ]    definition [ defi1 ] is a probabilistic interpretation of the similarity phenomenon . according to this definition ,",
    "two observed patches @xmath46 and @xmath47 are similar if they are issued from the same probability distribution .",
    "the following theorem is a kind of marcinkiewicz law of large numbers .",
    "it gives an estimation of the almost sure convergence rate of the estimator to the original image for the non - local means filter .",
    "let @xmath48 and let @xmath49 be the set of @xmath50 such that the patches @xmath46 and @xmath47 are similar ( in the sense of definition @xmath51 ) .",
    "set @xmath52 where @xmath53 then for any @xmath54 $ ] , as @xmath55 , @xmath56[th1 ] where @xmath57 denotes the cardinality of @xmath49 .",
    "notice that when @xmath58 , ( @xmath59 ) means that @xmath60 which is the similarity principle in @xcite .",
    "recall that @xmath61 .",
    "theorem @xmath62 shows that @xmath63 is a good estimator of the original image @xmath64 if the number of similar patches @xmath57 is sufficiently large .",
    "here we use the weight @xmath65 instead of @xmath66 , as @xmath65 has the nice property that it is independent of @xmath67 if @xmath68 .",
    "this property is used in the proof , and makes the estimator @xmath69 to be `` almost '' non - biased : in fact , if the family @xmath70 is independent of the family @xmath71 ( e.g. this is the case when the similar patches are disjoint ) , then it is evident that @xmath72 . we can consider that this non - biased property holds approximately as for each @xmath50 there are few @xmath73 such that @xmath74 is dependent of @xmath75 . a closely related explanation about the biased estimation of nl - means can be found in @xcite .    notice that when @xmath47 is not similar to @xmath46 , the weight @xmath76 is small and negligible .",
    "therefore it is also reasonable to take all patches for the calculation . but selecting only similar patches can improve the restoration result , and can also speed up the algorithm .",
    "the difference between @xmath77 and @xmath66 is also small , so that theorem @xmath62 shows that nlm@xmath78 is also a good estimator of @xmath64 .",
    "but very often @xmath63 gives better restoration result .",
    "the next result is a convergence theorem in distribution .",
    "it states that @xmath79 in distribution with a rate as @xmath80 .    under the condition of theorem @xmath62 ,",
    "assume additionally that @xmath81 is a stationary sequence of random vectors .",
    "then as @xmath82 , @xmath83 where @xmath84 means the convergence in distribution , and @xmath85 is a mixture of centered gaussian laws in the sense that it has a density of the form @xmath86 @xmath87 being the law of @xmath88 and @xmath89 . [ th2 ]    by theorems @xmath62 and @xmath90 , the larger the value of @xmath57 , the better the approximation of @xmath63 to @xmath64 , that is to say , the more similar patches , the better restored result .",
    "this will be confirmed in section [ secsim ] where we shall introduce the notion of degree of similarity for images , showing that the larger the degree of similarity , the better the quality of restoration .",
    "the proofs of the theorems will be given in section [ proofthm ] .",
    "to prove the two theorems , we will show a marcinkiewicz law of large numbers ( theorem @xmath91 ) and a convergence theorem in distribution for random weighted means ( theorem @xmath92 ) , which are more general than theorems @xmath62 and @xmath90 , respectively .      before stating the theorems",
    ", we first recall the notion of @xmath93-dependence .    for an integer @xmath94",
    ", a sequence of random variables @xmath95 is called to be @xmath93-dependent if each subsequence @xmath96 is independent whenever @xmath97 for all @xmath98 ( that is , random variables with distances greater than @xmath93 are independent of each other . )",
    "let @xmath99 be a sequence of @xmath93-dependent identically distributed random variables , with @xmath100 and @xmath101 for some @xmath102 and @xmath103 .",
    "then @xmath104 [ genth1 ]    we need the following lemma to prove it .",
    "@xcite if @xmath105 are @xmath93-dependent and identically distributed random variables with @xmath106 and @xmath107 for some @xmath108 , then @xmath109 [ lemm1 ]    this lemma is a direct consequence of marcinkiewicz law of large numbers for independent random variables @xcite(page 118 ) , since for all @xmath110 is a sequence of i.i.d .",
    "random variables , and for each positive integer @xmath111 , we have @xmath112 where @xmath113 are positive integers with @xmath114",
    ".    _ proof of theorem @xmath91 .",
    "_ notice that @xmath115 where @xmath116 since @xmath117 , by lemma @xmath118 with @xmath119 , we have @xmath120 since @xmath121 , and @xmath122 , again by lemma @xmath118 , we get @xmath123 thus the conclusion follows . @xmath124    let @xmath125 be a stationary sequence of @xmath93-dependent and identically distributed random variables with @xmath126 and @xmath127 .",
    "then @xmath128 that is , @xmath129 where @xmath130 and @xmath131 is a constant .",
    "[ genth2 ]    we need the following lemma to prove the theorem .",
    "@xcite let @xmath105 be a stationary sequence of @xmath93-dependent and identically distributed random variables with @xmath132 and @xmath133 .",
    "set @xmath134 , @xmath135 then @xmath136 , and as @xmath137,@xmath138 [ lemm2 ]    _ proof of theorem @xmath92 .",
    "_ as in the proof of theorem @xmath91 , we have @xmath139 where @xmath116 notice that the @xmath93-dependence of @xmath125 and the stationarity imply those of @xmath140 . therefore by lemma @xmath141 , we get @xmath142 where @xmath143 since @xmath144 , by lemma @xmath118 with @xmath119 , we obtain @xmath120 thus the conclusion follows with @xmath145 .",
    "@xmath124      for simplicity , denote by @xmath146 with @xmath147 in the following proof .",
    "we need to prove , for any @xmath54 $ ] , as @xmath148 , @xmath149 with @xmath150 we will apply theorem @xmath91 to prove it .",
    "note that the sequence @xmath151 @xmath152 is not @xmath93-dependent , since the central random variable @xmath153 is contained in all the terms . to make use of theorem @xmath91 , we first take a fixed vector to replace the central random variable .    _",
    "proof of theorem @xmath62 . _ fix @xmath154 .",
    "let @xmath155 then @xmath156 and @xmath157 are independent since @xmath158 .",
    "when @xmath160 and @xmath161 are disjoint , @xmath162 and @xmath163 are independent , so are @xmath164 and @xmath165 , and so are @xmath166 and @xmath167 since @xmath168 is fixed . thus @xmath169 is a sequence of @xmath93-dependent identically distributed random vectors for @xmath93 large enough . since @xmath170 , with the range of @xmath12 being bounded and @xmath8 being gaussian , we have @xmath171 for @xmath108 .",
    "( in fact , it holds for all @xmath172 . )",
    "thus @xmath173 , as @xmath174 .",
    "applying theorem @xmath91 , for fixed @xmath175 , we have , for any positive integer @xmath176 ,    @xmath177    now let @xmath176 be a positive integer such that @xmath88 is independent of @xmath178 for all @xmath179 .",
    "by fubini s theorem , we can replace @xmath180 in @xmath181 by @xmath150 that is ,    @xmath182    to prove the theorem , we need to estimate the difference between the left - hand sides of @xmath183 and @xmath184 .",
    "let @xmath185 @xmath186 then as before , fixing @xmath154 , applying theorem @xmath91 with @xmath119 and fubini s theorem , and replacing @xmath168 by @xmath88 , we obtain @xmath187 using this and the fact that@xmath188 we see that @xmath189 therefore , ( @xmath190 ) implies that @xmath191 as ( @xmath192 ) holds for any @xmath193 , we see that ( @xmath59 ) holds for all @xmath54 $ ] .",
    "@xmath124    _ proof of theorem @xmath90 . _",
    "similarly to the proof of theorem @xmath194 , fix @xmath154 , and set @xmath195",
    ". then @xmath156 and @xmath157 are independent , and @xmath196 .",
    "for @xmath93 large enough , @xmath197 is a sequence of @xmath93-dependent identically distributed random vectors , and @xmath198 . hence applying theorem @xmath92 , for fixed @xmath199",
    ", we get , for any positive integer @xmath176 , @xmath200 where @xmath89 depends on @xmath168 .",
    "this means that for any @xmath201 , @xmath202 let @xmath176 be the positive integer such that @xmath88 is independent of @xmath178 for all @xmath179 . then by fubini s theorem and lebesgue s dominated convergence theorem , we have @xmath203 where @xmath204 with @xmath87 being the law of @xmath88 . in other words , @xmath205 where @xmath85 is the law with density @xmath206 .",
    "this together with ( @xmath207 ) give the conclusion of theorem @xmath208 .",
    "@xmath124      in this section , we introduce the notion of degree of similarity of images to describe the influence of the number of similar patches on the restoration results .    if two patches @xmath46 and @xmath209 have the same distribution and are independent of each other , then @xmath210 are independent variables with the same law @xmath211 ( recall that @xmath212 is the translation mapping of @xmath38 onto @xmath39 ) . therefore @xmath213 where @xmath214 is the sum of squares of independent random variables with normal law @xmath215 , and has the law @xmath216 with @xmath217 degrees of liberty . for @xmath218 ,",
    "let @xmath219 be determined by @xmath220 so that @xmath221 the value of @xmath222 is chosen to be small enough .",
    "it represents the risk probability .",
    "when @xmath223 , we consider that @xmath46 and @xmath47 are similar with confidence level @xmath224 .",
    "this leads us to the following definition of the degree of similarity .    for @xmath225 let @xmath226 be the proportion of patches @xmath209 similar to @xmath46 in the search window @xmath41 , and",
    "let @xmath227 be their mean over the whole image .",
    "define @xmath228 the degree of similarity of the image @xmath13 with confidence level @xmath224 .",
    "we compute the ds values for different images corrupted by gaussian noise with @xmath229 .",
    "note that the ds values depend on @xmath230 . in our experiments ,",
    "we fix @xmath231 .",
    "the ds values of noisy images are shown in table @xmath232 .",
    "it can be seen that , for non - local means based methods , for example , our method in section [ pwmf ] , generally , the larger the ds value , the larger the psnr value ( see section [ exp ] ) .    .",
    "ds values of noisy images ( @xmath233 ) [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ time ]",
    "two convergence theorems , one for the almost sure convergence and the other for the convergence in law , are established to show the rate of convergence of nl - means @xcite .",
    "the notion of degree of similarity is also introduced to describe the influence of the proportion of similar patches in the application of nl - means .",
    "based on the convergence theorems , a new filter called patch - based weighted means filter ( pwmf ) is proposed to remove mixed noise , leading to an extension of nl - means .",
    "the choice of parameters has been carefully discussed .",
    "simulation results show that the new proposed filter is competitive compared to recently developed known algorithms .",
    "as the detection of impulse noise is crucial for removing the noise , which is done by the statistics road @xcite in this paper , we could further improve our results by improving road . in the future",
    ", we will consider a semi - local statistics to make use of redundancies of images , which has the possibility to well recover the textured regions .",
    "delon , j. , desolneux , a. : a patch - based approach for random - valued impulse noise removal . in : 2012 ieee international conference on acoustics , speech and signal processing ( icassp ) , pp .",
    "ieee ( 2012 )                                                xu , h. , xu , j. , wu , f. : on the biased estimation of nonlocal means filter . in : international conference on multimedia computing and systems / international conference on multimedia and expo , pp .",
    "11491152 ( 2008 )    yang , j.x .",
    ", wu , h.r . :",
    "mixed gaussian and uniform impulse noise analysis using robust estimation for digital images .",
    "proceedings of the 16th international conference on digital signal processing pp . 468472 ( 2009 )"
  ],
  "abstract_text": [
    "<S> we first establish a law of large numbers and a convergence theorem in distribution to show the rate of convergence of the non - local means filter for removing gaussian noise . </S>",
    "<S> we then introduce the notion of degree of similarity to measure the role of similarity for the non - local means filter . </S>",
    "<S> based on the convergence theorems , we propose a patch - based weighted means filter for removing impulse noise and its mixture with gaussian noise by combining the essential idea of the trilateral filter and that of the non - local means filter . </S>",
    "<S> our experiments show that our filter is competitive compared to recently proposed methods .    gaussian noise , impulse noise , trilateral filter , non - local means filter , convergence theorem , degree of similarity </S>"
  ]
}