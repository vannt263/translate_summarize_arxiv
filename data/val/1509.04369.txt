{
  "article_text": [
    "smoothed particle hydrodynamics ( sph ) is an entirely lagrangian particle method for simulating fluid flows @xcite .",
    "this lagrangian nature offers major advantages when sph is applied to problems with a large , dynamic range of spatial scales .",
    "furthermore , sph can easily incorporate other physics such as self - gravity , radiative transfer , or chemistry .",
    "thus , sph is widely used in a variety of astrophysical problems such as formation of large - scale structures , galaxies , stars , and planets .",
    "recently , several authors have tried to extend sph to magnetohydrodynamics ( mhd ) because magnetic fields play an important role in a variety of astrophysical environments . in this study , we call sph for mhd `` smoothed particle magnetohydrodynamics '' ( spm ) .",
    "@xcite has developed an spm method with artificial viscosity and resistivity ( also see * ? ? ?",
    "@xcite have applied godunov s method to spm .",
    "we call it `` gspm '' .",
    "recently , @xcite have modified their original gspm formulation , based on their derivation of the equation of motion in gspm from an action principle .",
    "unfortunately , conservative formulations of spm are known to inevitably suffer from numerical instability for low @xmath0 plasma because of negative stress , where @xmath0 is the ratio of the gas pressure to the magnetic pressure .",
    "this instability has already been pointed out by @xcite ( also see * ? ? ?",
    "* ) . among several methods proposed for removing the numerical instability @xcite , an approach by @xcite is widely used in modern spm methods ( e.g. , * ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    ". a broad discussion of stable spm schemes is found in a review by @xcite . in the approach of @xcite , a correction term , @xmath1 ,",
    "is subtracted from the right - hand side of the equation of motion .",
    "the correction term is essentially zero if @xmath2 is satisfied . by a linear analysis of spm ,",
    "@xcite ( hereafter bot04 ) found that half of the correction term , or @xmath3 , is large enough to remove the numerical instability .",
    "this was confirmed by @xcite , who found that half the correction term provided the least error and minimized the violation of energy and momentum conservation in a variety of test calculations . @xcite",
    "have proposed a sophisticated method , wherein the size of the correction term varies among the sph particles .    however , it is still unclear how the correction term affects the capability of spm to accurately model fluid flows .",
    "guiding the optimal selection of the amount of correction in a rigorous manner is important . @xcite",
    "have investigated the linear stability of various sph formulations , kernel functions , and ratios of smoothing length to interparticle distance ( also see * ? ? ?",
    "* ; * ? ? ?",
    "they have suggested an optimal range of parameters from obtained dispersion relations .",
    "although these analyses are valid only for the linear regime and a regular particle configuration , they provide us with a lot of knowledge for achieving further improvements to spm schemes .",
    "pioneering work for spm has been done by bot04 , who investigate the dispersive properties of spm .",
    "they parameterize the size of the correction term with a free parameter @xmath4 @xmath5 , and use @xmath6 as the correction term .",
    "they found that as mentioned above , @xmath7 is large enough to stabilize spm for low @xmath0 plasma , and also suggested that smoother kernels , such as gaussian or the quintic spline kernels , reproduce correct phase velocities , while the cubic spline causes large dispersion errors .",
    "however , their study is restricted to several linear waves in the long - wavelength limit and to the case with @xmath7 although many authors still adopt @xmath8 . in this study , we investigate detailed dispersive properties of spm for low @xmath0 plasma by changing @xmath4 , the kernel functions , and the ratio of smoothing length to interparticle distance . from the results , a suggestion of an optimal choice of the size of the correction term",
    "is provided .",
    "the paper is organized as follows : in section [ sec : review ] , the basic equations of spm are reviewed . in section [ sec : linear ] , a dispersion relation is derived from the basic equations of spm and its asymptotic behavior in the long- and short - wavelength limits is discussed .",
    "the results of the linear analysis are presented in section [ sec : result ] . to confirm the results of the linear analysis ,",
    "several numerical experiments are demonstrated in section [ sec : numerical ] .",
    "our results are discussed in section [ sec : discuss ] .",
    "section [ sec : summary ] offers a summary .",
    "the basic equations of mhd are given by @xmath9 @xmath10 and @xmath11 where @xmath12 is the stress tensor , @xmath13 and @xmath14 is the lagrangian time derivative .",
    "the second term on the right - hand side of equation ( [ eom ] ) is the correction term introduced to remove the numerical instability ( bot04 ) .",
    "the parameter @xmath4 specifies the size of the correction term . in this study",
    ", @xmath4 is assumed to be constant for all particles . for simplicity , instead of the energy equation ,",
    "the isothermal equation of state is assumed : @xmath15 where @xmath16 is the sound speed . in the adiabatic case ,",
    "the dispersive properties of spm are expected to be qualitatively the same as those in the isothermal case .    in sph",
    ", the density of the @xmath17-th particle is evaluated by the following equation : @xmath18 where the subscripts denote the particle label , @xmath19 is the mass of the @xmath20-th particle , @xmath21 is a kernel function , and @xmath22 is the smoothing length . in the linear analysis presented in this study ,",
    "the smoothing length is assumed to be constant . in the numerical experiments shown in section [ sec : numerical ] ,",
    "a variable smoothing length is used .",
    "there are several conservative formulations of spm . here",
    ", we show two schemes : the standard spm formulation , the gspm formulation .",
    "the basic equations of standard spm @xcite are given by @xmath23 and @xmath24_\\mathrm{diss } ,          \\label{pm05 induc}\\ ] ] where @xmath25 , the artificial dissipation terms ( viscosity and resistivity ) are denoted by the subscript of `` diss '' , and @xmath26 denotes the effect of the variation of the smoothing length .",
    "the detailed expression is described in @xcite .",
    "@xcite implemented gspm given by @xmath27 in which the quantities with the asterisks are the results of a riemann solver .",
    "the evolution equation of @xmath28 is the same as that of standard spm , except for the artificial resistivity term . in @xcite ,",
    "the resistivity term is derived from the method of characteristics for alfvn waves @xcite .",
    "note that equations ( [ gspm eom ] ) is a simplified version of a rigorous expression which is found in @xcite .    @xcite and @xcite have shown that the choice of kernel functions significantly influences on dispersive properties of sph , and should be determined by the requirements of accuracy and computational efficiency .",
    "we consider several kernel functions to investigate how they affect the dispersive properties of spm .",
    "the first is the gaussian kernel , which has the best interpolation accuracy .",
    "it is given by @xmath29 where @xmath30 is the number of dimensions .",
    "one disadvantage of the gaussian kernel is its infinite extent ; in actual calculations , the contributions for @xmath31 are ignored .",
    "also , in the linear analysis , we use a truncated gaussian kernel at @xmath32 that is denoted by @xmath33 .",
    "most works use the cubic spline kernel @xcite , which is given by @xmath34 where @xmath35 , and @xmath36 , @xmath37 , and @xmath38 .",
    "this kernel has a great computational advantage , as it has a compact support at @xmath39 .",
    "however , the interpolation is inaccurate and leads to relatively large dispersion errors in sound waves @xcite .",
    "we also consider the quintic spline kernel , @xmath40 where @xmath41 , @xmath42 , and @xmath43 .",
    "this kernel is smoother and more accurate kernel than @xmath44 .",
    "a two - dimensional ( 2d ) rectangular lattice of particles with an interval of @xmath45 is considered as an unperturbed state .",
    "the position of the @xmath17-th particle position is given by @xmath46 , where @xmath47 is the 2d integer vector , @xmath48 ( @xmath49 ) .",
    "the particle mass @xmath50 and smoothing length @xmath22 are assumed to be constant .",
    "the following perturbations are considered : @xmath51 @xmath52 @xmath53 @xmath54 @xmath55 where the subscript `` 0 '' indicates physical variables in the unperturbed state . for simplicity ,",
    "the unperturbed magnetic field is assumed to be parallel to the @xmath56-direction , and fluctuations in the @xmath57-direction that correspond to alfvn wave are not considered , although their propagation can be partly investigated by fast waves propagating along magnetic fields for low @xmath0 plasma .",
    "this means that we consider fast and slow modes that oscillate in the @xmath58-plane .",
    "we assume that the perturbations have the following space and time dependence : @xmath59 where @xmath60 .    substituting equations ( [ xa])-([pa ] ) into the standard spm equations ( [ deni ] ) , ( [ pm05 eom ] ) , ( [ pm05 induc ] ) , and @xmath61 , we obtain a dispersion relation .",
    "the artificial dissipation term is omitted in this analysis .",
    "we do not repeat the detailed derivation of the dispersion relation that was already shown by bot04 .",
    "the dispersion relation is given by @xmath62 where `` det '' indicates determinant , @xmath63 @xmath64 is the unperturbed stress tensor modified by the correction term , @xmath65 @xmath66 , @xmath67 , and @xmath68 are given by @xmath69 @xmath70 and @xmath71 the first term on the right - hand side of equation ( [ aij ] ) comes from the perturbation of @xmath72 , and the second term comes from the perturbation of @xmath12 in equation ( [ pm05 eom ] ) .    note that the dispersion relation derived from the linearized gspm equations is identical to equation ( [ disp ] ) if the physical quantities with an asterisk are evaluated at the arithmetic mean between the @xmath17- and @xmath20-th particles .",
    "thus , this linear analysis is valid both in standard spm and gspm .",
    "since equation ( [ disp ] ) is a quadratic equation in terms of @xmath73 , two modes are obtained . in this study ,",
    "the mode with larger ( smaller ) @xmath73 is referred to as the fast ( slow ) mode .",
    "the numerical phase velocities @xmath74 of the fast and slow modes are denoted by @xmath75 and @xmath76 , respectively .      in this section , we investigate the asymptotic behavior of the dispersion relation in the short- and long - wavelength limits .",
    "spm without the correction term is unstable for low @xmath0 plasma because negative diagonal components appear in the stress tensor @xcite .",
    "the development of numerical instability begins with the growth of fluctuations whose scales are comparable to @xmath45 .",
    "thus , in this section , we investigate the asymptotic behavior in the short - wavelength limit and the size of @xmath4 required to stabilize spm .",
    "note that this already has been done by bot04 , who numerically solve the dispersion relation . here",
    ", we show that their conclusion is reproduced in the following simple analytical manner .    in the discrete system ,",
    "the largest wavenumber is @xmath77 where the unit wavelength is expressed by two particles .",
    "a compressible wave propagating along @xmath78 ( @xmath79 ) is considered .",
    "this corresponds to the slow mode . in this case",
    ", we obtain @xmath80 from equations ( [ psi ] ) and ( [ phi ] ) . from equation ( [ disp ] ) , the dispersion relation becomes @xmath81 where @xmath82 .",
    "the summation in equation ( [ shorteq ] ) is positive in normal situations @xcite . without the correction term ( @xmath83 )",
    ", one can see that spm becomes unstable , since @xmath84 if @xmath85 . to be stable",
    ", the following condition should be satisfied : @xmath86 where @xmath87 is the minimum value of @xmath4 needed to ensure stability for a given @xmath0 .",
    "this linear dependence of @xmath87 on @xmath0 is the same as that found numerically in bot04 ( see their fig .",
    "7 ) . in the strong magnetic field limit @xmath88",
    ", @xmath7 is large enough to stabilize spm .      in the long - wavelength limit ( @xmath89 )",
    ", summations can be replaced by integrals in equation ( [ disp ] ) @xcite .",
    "for instance , @xmath66 is approximated by @xmath90 where integration by parts and @xmath91 for @xmath92 are used , and @xmath93 is the fourier transform of @xmath21 , given by @xmath94 in the similar way , one obtains @xmath95 using equations ( [ psilong ] ) and ( [ philong ] ) , equation ( [ aij ] ) becomes @xmath96 if the gaussian kernel is applied , its fourier transform is also gaussian , @xmath97 .",
    "thus , @xmath98 for @xmath99 .",
    "using this fact , the dispersion relation ( equation ( [ disp ] ) ) becomes @xmath100 this dispersion relation holds for both fast and slow waves . note",
    "that equation ( [ dispideal ] ) does not contain @xmath4 .",
    "thus , waves in the long - wavelength limit are not affected by the correction term .",
    "ideally , the dispersion relation of spm satisfies the correct phase velocity as long as equations ( [ psilong ] ) and ( [ philong ] ) are valid .    comparing equations ( [ aijideal ] ) and ( [ aij ] )",
    ", one can see that the correct phase velocities come from the second terms on the right - hand sides .",
    "the first term on the right - hand side of equation ( [ aijideal ] ) becomes zero because @xmath101 . in reality , the numerical dispersion relation ( [ disp ] ) is expected to deviate from that in equation ( [ dispideal ] ) because finite discretization errors are introduced in equations ( [ psilong ] ) and ( [ philong ] ) .",
    "the first term on the right - hand side of equation ( [ aij ] ) causes larger dispersive errors than the second term .",
    "this is because @xmath68 contains the second derivative of the kernel function that has larger errors ( see equation ( [ psi ] ) ) .",
    "in particular , the cubic spline kernel leads to large errors in @xmath68 because its second derivative is a broken line .",
    "thus , dispersive errors mainly come from the first term on the right - hand side of equation ( [ aij ] ) .",
    "in this section , the dispersion relation ( [ disp ] ) is solved by considering a sufficiently small wavenumber @xmath102 and changing the angle @xmath103 between @xmath104 and @xmath78 in order to investigate whether spm correctly reproduces the phase velocities shown in section [ sec : longlimit ] .",
    "[ fig : fdiag xi1.0 ] shows the numerical phase velocities of the fast mode as a function of the angle @xmath103 for various values of @xmath0 , @xmath22 , and various kernel functions .",
    "the value of @xmath4 is assumed to be 1 .",
    "the exact solutions are plotted by the gray lines . for low @xmath0 plasma",
    ", the fast wave at @xmath105 represents the incompressible pseudo - alfvn wave whose phase velocity is @xmath106 .",
    "the phase velocity increases with @xmath103 and gradually changes into a compressible mode . at @xmath107 ,",
    "the phase velocity reaches a maximum value of @xmath108 . in the upper column of fig .",
    "[ fig : fdiag xi1.0 ] , for @xmath109 , all kernel functions reproduce the exact solutions within an error of 1% although the gaussian kernel provides slightly worse results . for @xmath110 ,",
    "the results for the gaussian kernel are almost identical to the exact solution ( see the lower column of fig . [",
    "fig : fdiag xi1.0 ] ) .",
    "only the results obtained with @xmath44 suffer from relatively large errors .",
    "the results for @xmath7 are not shown , because it is confirmed that the numerical dispersion relations do not much depend on @xmath4 .",
    "it is found that spm can reproduce the phase velocity of the fast mode reasonably well regardless of @xmath4 .",
    "this behavior can be qualitatively understood from the one - dimensional dispersion relation for @xmath111 ( @xmath112 ) given by @xmath113 as mentioned in section [ sec : longlimit ] , the correct phase velocity @xmath114 comes from the second term on the right - hand side of equation ( [ fast1dim ] ) and the dispersion errors arise mainly from the first term . to obtain the correct phase velocity , the first term on the right - hand side of equation ( [ fast1dim ] )",
    "should be negligible compared with the second term .",
    "we can see that the coefficient of @xmath115 in equation ( [ fast1dim ] ) is comparable to that of @xmath116 .",
    "thus , as long as @xmath117 is satisfied , the numerical phase velocities agree with the exact values within sufficiently small errors . for @xmath118 ,",
    "a term proportional to @xmath4 appears in the first term on the right - hand side of equation ( [ fast1dim ] ) .",
    "also in this case , the effect of the first term can be neglected , as the phase velocity of the fast mode is comparable to @xmath119 .",
    "that is why the numerical phase velocities agree with the exact phase velocities reasonably well and do not depend much on @xmath4 for all @xmath103 .     and",
    "@xmath78 for @xmath120 , @xmath121 , @xmath122 , and @xmath123 .",
    "the results with @xmath8 and @xmath7 are almost identical , and so only those with @xmath8 are presented .",
    "the red , green , blue , and orange lines correspond to the results using the gaussian , truncated gaussian , cubic spline , and quintic spline kernels . in each panel ,",
    "the exact solutions are shown by the gray line .",
    ", width=491 ]       and @xmath78 for @xmath120 , @xmath121 , @xmath122 , and @xmath123 .",
    "the red , green , blue , and orange lines correspond to the results using the gaussian , truncated gaussian , cubic spline , and quintic spline kernels . in each panel ,",
    "the exact solutions are shown by the gray line .",
    "all results are taken at @xmath8 .",
    ", width=491 ]    the slow mode exhibits completely different dispersion properties than the fast mode .",
    "[ fig : diag xi1.0 ] shows the numerical phase velocities of the slow mode as a function of the angle @xmath103 for various values of @xmath0 and @xmath22 , and various kernel functions , with @xmath8 . at @xmath124",
    ", the slow mode corresponds to the sound wave propagating in the direction parallel to @xmath78 .",
    "the phase velocity decreases with @xmath103 and gradually becomes the incompressible mode . at @xmath107 ,",
    "the phase velocity becomes zero .",
    "first , we focus on the cases with @xmath109 shown in the upper panels of fig . [",
    "fig : diag xi1.0 ] .",
    "the results with @xmath44 are significantly underestimated for @xmath125 and leads to a numerical instability at @xmath126 . even for the smoother kernels ( @xmath127 , @xmath33 , @xmath128 ) , the dispersion errors are significantly large and becomes worse for smaller @xmath0 .",
    "although only @xmath128 provides a better result for @xmath125 , the stronger magnetic field ( @xmath126 ) makes the results worse . from the lower left panel in fig .",
    "[ fig : diag xi1.0 ] , for @xmath125 , larger @xmath22 ( @xmath110 ) improves the results with the smoother kernels while the result with @xmath44 does not improve .",
    "also , in the case with larger @xmath22 , for the stronger magnetic field ( @xmath126 ) , the dispersion errors become worse except for @xmath127 . in summary ,",
    "the dispersion errors of the slow mode are large and becomes significant as @xmath0 decreases .",
    "a larger smoothing length makes the errors lower with every kernel except for the cubic spline , although large errors still remain for sufficiently low @xmath0 .",
    "thus , larger smoothing length can not be an ultimate solution .     and",
    "@xmath78 for @xmath120 , @xmath121 , @xmath122 , and @xmath123 .",
    "the red , green , blue , and orange lines correspond to the results using the gaussian , truncated gaussian , cubic spline , and quintic spline kernels . in each panel ,",
    "the exact solutions are shown by the gray line .",
    "all results are taken at @xmath7 . ,",
    "width=491 ]    fig .",
    "[ fig : diag xi0.5 ] is the same as fig .",
    "[ fig : diag xi1.0 ] but setting @xmath7 .",
    "all kernels can provide the correct phase velocities for all cases although the results with @xmath44 have relatively large errors .",
    "bot04 have already investigated the dispersion properties for @xmath7 , and their results are consistent with ours .",
    "[ fig : diag xi1.0 ] and [ fig : diag xi0.5 ] reveal that spm with @xmath8 exhibits significantly large dispersive errors that disappear if @xmath7 is used .",
    "this behavior can be qualitatively understood from the simple one - dimensional dispersion relation for @xmath129 ( @xmath130 ) given by @xmath131 to obtain the correct phase velocity , @xmath16 , the first term on the right - hand side of equation ( [ slow1dim ] ) should be negligible when compared with the second term .",
    "however , in contrast to the fast mode case , the coefficient of @xmath132 in equation ( [ slow1dim ] ) is much larger than that of @xmath133 for low @xmath0 ( @xmath134 ) .",
    "thus , the first term can be important even if @xmath135 is sufficiently small .",
    "note that the contribution of the magnetic field disappears only at @xmath7 in the first term of equation ( [ slow1dim ] ) , and the dispersion relation is reduced to that without a magnetic field .",
    "that is why the errors are mostly eliminated for @xmath7 , as shown in fig .",
    "[ fig : diag xi0.5 ] .",
    "these findings in the long - wavelength limit suggest that the best choice for @xmath4 is 1/2 , as spm with @xmath136 suffers from significant errors .      in this section ,",
    "the overall dispersive properties of spm are investigated .        figs .",
    "[ fig : kxyf]a and [ fig : kxyf]b show color maps of the numerical phase velocities of the fast mode in the @xmath137 plane for @xmath8 and @xmath138 , respectively .",
    "the smoothing length is assumed to be @xmath110 , and the plasma @xmath0 value is fixed to be @xmath125 . here , we focus on the results with the gaussian kernel .",
    "it is confirmed that the qualitative properties do not depend on the kernel functions . in fig .",
    "[ fig : kxyf ] , the numerical phase velocities are divided by the corresponding exact solutions depending on @xmath103 . in both panels in fig . [",
    "fig : kxyf ] , @xmath139 has peaks at the origin and monotonically decreases with @xmath140 at all @xmath103 , where @xmath141 is the exact phase velocity of the fast mode .",
    "the difference between the results with @xmath8 and @xmath138 is found only in the region where @xmath142 and @xmath143 . for @xmath7 ,",
    "@xmath144 declines more rapidly than it does for @xmath8 . this behavior will be explained later .",
    "thus , the dispersion relation of the fast mode does not depend much on the value of @xmath4 .",
    "this is consistent with the findings in section [ sec : long fast ] .",
    "next , the dispersion relations of the slow mode are investigated .",
    "[ fig : kxys ] is the same as fig .",
    "[ fig : kxyf ] but for the slow mode .",
    "first , the result with @xmath8 , as shown in fig .",
    "[ fig : kxys]a , is investigated .",
    "[ fig : kxys]a shows that @xmath145 exhibits anomalous features , although @xmath146 can reproduce the correct phase velocities in the long - wavelength limits for the gaussian kernel ( see the lower left panel in fig .",
    "[ fig : diag xi1.0 ] ) . @xmath147",
    "increases from the origin with @xmath140 especially in the direction parallel to @xmath78 ( @xmath148 ) . around @xmath149",
    ", @xmath147 reaches a maximum whose value is @xmath150 times larger than the exact solution . for larger @xmath140 @xmath151 ) , @xmath146 decreases with @xmath140 .",
    "these anomalous features of the dispersion relation for @xmath8 completely disappear at @xmath7 , as shown in fig .",
    "[ fig : kxys]b where @xmath147 monotonically decreases with @xmath140 from the center .    fig .",
    "[ fig : kxys ] reveals that the phase velocities around @xmath105 strongly depend on @xmath4 . to see this more clearly",
    ", the phase velocities at @xmath130 and @xmath152 are plotted in fig .",
    "[ fig : cross ] as a function of @xmath140 . fig .",
    "[ fig : cross]a shows the results with @xmath8 .",
    "first , we focus on the case where @xmath105 , shown by the solid lines . as mentioned above",
    ", the numerical phase velocities agree with the exact values for both the fast and slow modes . from @xmath153",
    ", @xmath154 decreases with @xmath155 while @xmath146 increases . at @xmath156 ,",
    "the two branches have the same phase velocity .",
    "beyond this point , it can be clearly seen that the fast mode branch smoothly connects with the slow mode branch .",
    "this happens simply because larger ( smaller ) @xmath73 is referred to as the fast ( slow ) mode in this study , regardless of its eigenfunction .",
    "the `` real '' fast ( slow ) mode should be an incompressible ( compressible ) mode at @xmath105 . by investigating the corresponding eigenfunctions ,",
    "it is confirmed that the `` real '' fast and slow modes intersect at @xmath156 .",
    "this means that the slow mode changes into an incompressible mode and the fast mode changes into a compressible mode beyond the intersection point . the dashed line in fig .",
    "[ fig : cross ] indicates the results with @xmath157 .",
    "we can see the mode exchange between the fast and slow branches around @xmath156 . from the eigenfunctions , it is confirmed that the fast ( slow ) branch is changed into a compressible ( incompressible ) mode by the mode exchange .",
    "[ fig : cross]a indicates that the phase velocity of the compressible mode ( the `` real '' slow mode ) is supersonic @xmath158 for all wavenumbers .",
    "[ fig : peak ] shows the @xmath0-dependence of the maximum phase velocity of the compressible mode for @xmath8 and @xmath105 . as shown in fig .",
    "[ fig : cross]a , the `` real '' slow mode has an off - center peak . from fig .",
    "[ fig : peak ] , we can see that the maximum phase velocity increases with decreasing @xmath0 .",
    "the maximum phase velocity for low @xmath0 is well fitted by @xmath159 shown by the dashed line fig .",
    "[ fig : peak ] .",
    "this dependence clearly indicates that the enhancement of the phase speed of the compressible wave comes from the magnetic fields .",
    "[ fig : cross]b shows the results for @xmath7 .",
    "the phase velocity of the slow mode monotonically decreases with @xmath155 .",
    "also for @xmath7 , the mode exchange occurs at larger @xmath155 . from figs.[fig : cross]a and [ fig : cross]b , the extended feature around @xmath143 in @xmath154 in fig .",
    "[ fig : kxyf]a corresponds to a compressible mode with a large phase velocity ( @xmath160 ) created by mode exchange .",
    "[ fig : cross ] reveals that the dispersion relation is abnormal if @xmath8 is used . in section [ sec : disp ] , it is found that the compressible waves at short - wavelength propagate with supersonic velocities . in this section , to test this dispersive property , three simple test calculations are demonstrated .",
    "fist , test of the propagation of an isolated wave is performed .",
    "this is a severe test for the propagation of linear waves because an isolated wave is composed of many linear waves with different wavelengths .",
    "thus , if the sound speed numerically has a @xmath155-dependence , the shape of an isolated wave is expected to change during its propagation . in other words ,",
    "the deformation of an isolated wave clearly shows the dispersion errors .    in the unperturbed state ,",
    "the particles are distributed in a rectangular lattice in the domain of @xmath161\\times[-1,1]$ ] .",
    "the density and pressure are assumed to be 1 .",
    "a uniform magnetic field is introduced in the @xmath56-direction , and its strength is set such that @xmath0 is 0.1 . a velocity perturbation given by @xmath162",
    "the two isolated waves propagate outward from the origin . as the sound wave does not have dispersion",
    ", the two isolated waves should keep their shape with the sound speed ( @xmath163 ) as they propagate .",
    "@xcite did the same test calculation without magnetic fields .",
    "[ fig : sol]a shows a snapshot of the velocity perturbation at @xmath164 for @xmath8 . only the isolated wave propagating rightward is plotted .",
    "the gray lines indicate the exact solution .",
    "the colors indicate the difference of the kernel functions . for @xmath8 , with all kernel functions , the isolated waves break into smaller waves that propagates at supersonic velocities .",
    "this dispersive property is consistent with the results of linear analysis .",
    "the results with @xmath128 are almost identical to that with @xmath33 .",
    "the isolated wave with @xmath44 shows a larger speed , as expected in fig .",
    "[ fig : kxys ] . on the other hand , for @xmath7",
    ", there is no destruction of the isolated wave , and the results agree with the exact solution quite well , although the result with @xmath44 shows a slightly larger phase velocity .",
    "this is explained by the linear analysis ( see the lower left panel of fig .",
    "[ fig : diag xi0.5 ] ) .",
    "these findings suggest that the optimal choice for @xmath4 is @xmath138 .",
    "otherwise spm provides completely incorrect results for the wave propagation .",
    "the linear analysis is valid only for the linear waves . in this test ,",
    "we consider a colliding flow test that involves shock waves .",
    "we investigate whether the dispersive errors affect the shock structures or not .",
    "the computational domain is @xmath165 , @xmath166 , and the periodic boundary condition is imposed in the @xmath167-direction .",
    "initially , the density is uniform , and the gas moves toward @xmath168 from both directions with a velocity @xmath169 .",
    "the corresponding mach number is @xmath170 .",
    "the initial magnetic field is @xmath171 .",
    "as the magnetic field is parallel to the @xmath56-direction , it should not affect the gas dynamics .",
    "the truncated gaussian kernel is used .",
    "we consider two cases : @xmath125 and @xmath172 . in the exact solution ,",
    "two shock waves propagates outward from @xmath168 . in this test ,",
    "we investigate how the strong parallel magnetic field numerically affects the gas motion .",
    "the initial particle distribution is set to be a random distribution that is relaxed until the density dispersion is sufficiently small . in this test",
    ", a riemann solver is used to capture shock waves .",
    "the hyperbolic divergence cleaning method @xcite is also used .",
    "[ fig : shock]a shows the results with @xmath8 and @xmath7 for @xmath125 .",
    "the black line indicates the exact solution .",
    "both cases agree with the exact solution quite well .",
    "this is because the shock jump condition is determined only by mass and momentum conservation laws , regardless of their dispersive properties .",
    "for the stronger magnetic field case @xmath173 , the effect of the dispersive errors is shown in fig .",
    "[ fig : shock]b . for @xmath7 ,",
    "the density of the shocked gas can reproduce the exact solution reasonably well within an error of @xmath174 .",
    "this small error occurs due to the perpendicular magnetic field @xmath175 numerically generated at the shock front .",
    "it works as an additional pressure , leading to the smaller density jump . for @xmath8 ,",
    "the density profile is quite different from the exact solution .",
    "the shock fronts broaden and small waves propagate toward the upstream with a supersonic velocity larger than the converging velocity @xmath176 .",
    "this can be understand by fig .",
    "[ fig : peak ] .",
    "for @xmath126 , the maximum phase velocity of the compressible wave is @xmath177 , which is larger than the converging velocity .",
    "thus , waves can propagate toward upstream against the converging flow .    from this converging flow test",
    ", it is found that given @xmath0 , there is a minimum shock speed below which waves with short wavelengths propagate upstream and disturb the preshock gas .",
    "the minimum shock speed corresponds to the maximum phase velocity of the compressible wave , or @xmath159 derived from the linear analysis ( see fig .",
    "[ fig : peak ] ) .",
    "in other words , if the alfvn mach number is smaller than 0.5 , the dispersive errors are serious .",
    "the dispersion errors originate from the fact that a parallel magnetic field numerically works as an additional repulsive force .",
    "this indicates that the errors can be important not only for waves but also for hydrostatic structures .",
    "thus , in this test , we investigate whether spm reproduces a hydrostatic structure under an external gravity , @xmath178 . as the initial condition",
    ", we consider a uniform static gas with a uniform magnetic field in the @xmath56-direction .",
    "the amplitude of the magnetic field is @xmath179 .",
    "the calculation domain is @xmath180 and @xmath181 .",
    "the truncated gaussian kernel is used .",
    "a periodic boundary condition is imposed in the @xmath167-direction , and the wall boundary condition is imposed in the @xmath56-direction .",
    "the initial particle configuration is set to be a settled random distribution .",
    "because of the external gravity , the plasma accumulates toward the midplane ( @xmath168 ) .",
    "finally , the density profile is expected to relax to the hydrostatic equilibrium profile , @xmath182 . to avoid an undesirable oscillation in the relaxation phase ,",
    "we add a small drag force , @xmath183 , to the equation of motion .",
    "if the maximum velocity becomes smaller than @xmath184 , the calculations are terminated .",
    "the upper panel of fig .",
    "[ fig : grav]a shows the obtained density profiles for @xmath125 .",
    "the lower panel of fig .",
    "[ fig : grav]a indicates the fractional residual , @xmath185 .",
    "the result with @xmath7 agrees with the hydrostatic profile within sufficiently small error .",
    "the small deviation around @xmath186 comes from the boundary condition .",
    "also for @xmath8 , spm reproduces the hydrostatic profile reasonably well , although the density in the central region is underestimated and the low density tails are overestimated .",
    "however , this tendency becomes prominent for @xmath126 , as shown in fig .",
    "[ fig : grav]b . the density profile with",
    "@xmath8 exhibits a more extended profile than @xmath187 . on the other hand , even for @xmath126 , spm with @xmath7 can produce the correct profile . from the test",
    ", it is found that the hydrostatic profiles along the magnetic fields are broadened by the artificial repulsive force if @xmath8 is used .",
    "the test calculations demonstrated in section [ sec : numerical ] show that spm with @xmath7 removes dispersion errors . however , in a realistic situation where a blast wave propagates in a strongly magnetized medium , @xcite ( hereafter tp12 ) found that spm with @xmath188 produces numerical fluctuations behind the slow shocks and at the contact discontinuity .",
    "they found that a value of @xmath8 leads to stable results .",
    "this is because the repulsive force is weaker for spm with smaller @xmath4 , leading to the particle disorder .    to investigate the stability against the particle disorder in spm with @xmath7",
    ", we perform the same blast wave test as in tp12 .",
    "the total particle number is @xmath189 .",
    "[ fig : blast]a and [ fig : blast]b show the density maps at @xmath190 for @xmath8 and @xmath7 , respectively . the truncated gaussian kernel is used .",
    "one can see that the result with @xmath7 is quite similar to that with @xmath8 . as shown in section",
    "[ sec : shock ] , spm can treat shock waves even for @xmath8 as long as the alfvn mach number is larger than 0.5 .",
    "thus , it is difficult to identify the dispersion errors in this test .",
    "note that the significant particle disorder found by tp12 does not appear in fig .",
    "[ fig : blast]b .",
    "although this discrepancy may come from the difference of treatment of the numerical dissipations between gspm and their scheme , the exact reason is still uncertain . however , also in the gspm , the result with @xmath8 is smoother than that with @xmath7 .",
    "thus , it is possible that gspm with @xmath7 suffers from the serious particle disorder in more extreme situations .",
    "the best choice of @xmath4 depends on situations from the point of view of accuracy and stability .",
    "as shown in the linear analysis , the dispersive errors are serious in slow waves propagating along magnetic fields .",
    "thus , for example , to simulate a sub - alfvnic turbulence in low @xmath0 plasma , a value of @xmath7 should be adopted . on the other hand , in dynamical situations where strong shock waves are important such as the blast wave test ,",
    "the dispersive errors are not serious if the alfvn mach number is larger than 0.5 ( see section [ sec : shock ] ) . in these cases ,",
    "a value of @xmath8 is acceptable .          besides the approach by @xcite",
    ", @xcite proposed the following formulation ; @xmath191 in his formulation , the conservative form is used in the isotropic part of the stress tensor while the non - conservative form is used in the remaining part . thanks to the non - conservative term , his formulation is free from the numerical instability . in this section",
    ", we compare the dispersion relations between the morris formulation ( spm@xmath192 ) and the conservative form with the correction term ( spm@xmath193 ) .",
    "linearizing equation ( [ morris spm ] ) , one obtains the following dispersion relation ; @xmath194 where @xmath195 \\nonumber \\\\          & + & \\frac { b_0^\\eta { \\psi}^\\eta } { 4\\pi }          \\left (   b_0^\\zeta \\psi^\\zeta \\delta^{\\mu\\nu } - b_0^\\mu \\psi^\\nu \\right ) .",
    "\\label{aij morris}\\end{aligned}\\ ] ] fig .",
    "[ fig : kxym ] shows the color map of the numerical phase velocities of the slow mode using spm@xmath192 in the @xmath137 plane .",
    "the smoothing length is assumed to be @xmath110 , and the plasma @xmath0 value is fixed to be @xmath125 . the gaussian kernel is considered .",
    "one can see that the behavior of @xmath146 is quite similar to that in spm@xmath193 with @xmath8 ( see fig . [",
    "fig : kxys]a ) .",
    "the dispersion relations have an off - center peak of @xmath146 around @xmath148 .",
    "thus , the spm formulation by @xcite also suffers from the dispersive errors .",
    "this behavior can be qualitatively understood from equation ( [ aij morris ] ) .",
    "the first term on the right - hand side of equation ( [ aij morris ] ) that leads to most of the dispersive errors becomes large compared with other terms for low @xmath0 plasma .",
    "note that in spm@xmath193 the corresponding term proportional to @xmath196 is negligible if @xmath7 is used .",
    "in this study , we have investigated the dispersive properties of spm with a correction term introduced to remove numerical instability in a strongly magnetized medium @xcite .",
    "the size of the correction term is parametrized by @xmath4 ( see equation ( [ eom ] ) ) .",
    "the findings in this study are summarized as follows :    * as numerically found by @xcite , the minimum value of @xmath4 for removing the numerical instability is analytically derived as a function of the plasma @xmath0 value in section [ sec : shortlimit ] . * for the fast modes , it is found that spm can reproduce correct phase velocities regardless of @xmath4 .",
    "the dispersion properties are similar to those without magnetic fields . *",
    "the phase velocities of the slow modes is shown to significantly depend on @xmath4 . for @xmath8 , which is used in most schemes , it is found that spm suffers from significant dispersion errors with all kernel functions .",
    "the dispersion errors become worse for a lower value of @xmath0 . in the long - wavelength limit @xmath197 ,",
    "the numerical phase velocities are largely different from the exact values especially for the cubic spline kernel . a larger smoothing length and a smoother kernel functions are not ultimate solution if @xmath0 is sufficiently small ( see fig . [",
    "fig : diag xi1.0 ] ) .",
    "the dispersion relations have an off - center peak of the phase velocities around @xmath198 and @xmath148 , where @xmath103 is the angle between @xmath104 and @xmath78 .",
    "furthermore , the phase velocities are supersonic for all wavenumbers above the nyquist wavenumber @xmath199 ( see fig . [ fig : kxys ] ) .",
    "the reason for this anomalous behavior is that a parallel magnetic field numerically works as an additional repulsive force and the phase velocities of the slow wave become supersonic .",
    "this fact can be understood by examining the dispersion relation with respect to the slow wave propagating along a magnetic field .",
    "+ on the other hand , for @xmath7 , the dispersion errors found for @xmath8 completely disappear .",
    "this can be understood analytically from the dispersion relation . * to confirm the findings of the linear analysis ,",
    "several simple numerical experiments are demonstrated .",
    "for the tests of linear isolated waves and hydrostatic equilibrium , spm with @xmath8 leads to unphysical results while the exact solutions can be reproduced for @xmath7 .",
    "on the other hand , spm with @xmath8 can treat the parallel shock waves if alfvn mach number is larger than 0.5 .",
    "this is because the shock condition is determined only by the conservation properties and slow waves can not propagate toward upstream .",
    "if the shock speeds are smaller , waves propagate upstream against the flow and cause disturbances .",
    "these results are consistent with the linear analysis .",
    "this study clearly shows that corrected spm with @xmath8 over - stabilizes the numerical instability and significantly modifies the dispersion properties of the slow modes . to eliminate such dispersion errors",
    ", we suggests that @xmath7 is the best choice .",
    "these abnormal dispersion properties have not been found in the previous works , ( e.g. , the blast wave tests used to test the capability of schemes for low @xmath0 ) because , as shown in section [ sec : shock ] , spm can treat shock waves even for @xmath8 as long as the shock speed is large .",
    "thus , it is difficult to identify the dispersion errors found in this study from the blast wave test .",
    "the errors can be serious ; for instance , in sub - alfvnic turbulence for low @xmath0 plasma , the phase velocity of the waves propagating along magnetic fields may be significantly overestimated .",
    "the linear analysis and the numerical experiments suggest that the best choice of @xmath4 is 1/2 from the point of view of accuracy .",
    "however , as discussed in section [ sec : stable ] , spm with @xmath7 tends to less stable against particle disorder because of the small repulsive force . in dynamical environments",
    "where strong shock waves are important , a value of @xmath8 is acceptable if the alfvn mach number is larger than 0.5 .",
    "we thank the anomalous referee for valuable comments that improves this paper significantly .",
    "we also thank professor shu - ichiro inutsuka and dr .",
    "yusuke tsukamoto for valuable discussions .",
    "numerical computations were carried out on cray xc30 at the cfca of national astronomical observatory of japan .",
    "ki was supported by the research fellowship from the japan society for the promotion of science for young scientist .",
    "ki is supported by individual research allowances in doshisha university .",
    "i.  j. schoenberg , contributions to the problem of approximation of equidistant data by analytic functions .",
    "a : on the problem of smoothing or graduation - a 1st class of analytic approximation formulae , q. appl . math .",
    "4 ( 1946 ) 45 ."
  ],
  "abstract_text": [
    "<S> in this study , we investigate the dispersive properties of smoothed particle magnetohydrodynamics ( spm ) in a strongly magnetized medium by using linear analysis . in modern spm , a correction term proportional to the divergence of the magnetic fields is subtracted from the equation of motion to avoid a numerical instability arising in a strongly magnetized medium . from the linear analysis , it is found that spm with the correction term suffer from significant dispersive errors , especially for slow waves propagating along magnetic fields . </S>",
    "<S> the phase velocity for all wave numbers is significantly larger than the exact solution and has a peak at a finite wavenumber . </S>",
    "<S> these excessively large dispersive errors occur because magnetic fields contribute an unphysical repulsive force along magnetic fields . </S>",
    "<S> the dispersive errors can not be reduced , even with a larger smoothing length and smoother kernel functions such as the gaussian or quintic spline kernels . </S>",
    "<S> we perform the linear analysis for this problem and find that the dispersive errors can be removed completely while keeping spm stable if the correction term is reduced by half . </S>",
    "<S> these findings are confirmed by several simple numerical experiments .    </S>",
    "<S> particle methods , magnetohydrodynamics , smoothed particle magnetohydrodynamics ( spm ) , linear analysis , astrophysics </S>"
  ]
}