{
  "article_text": [
    "a number of numerical magnetohydrodynamic ( mhd ) codes have been developed for modeling plasma flows in astrophysics .",
    "some of the most well - known codes are _ zeus _ @xcite , _ flash _ @xcite , _ pluto _",
    "@xcite , and _ athena _ @xcite .",
    "a number of different numerical algorithms have also been developed for the numerical integration of the mhd equations including different approaches for the spatial and temporal approximations @xcite , and different algorithms for the approximate solution of the riemann problem @xcite .    in this work",
    ", we describe a code developed by our group for the numerical modeling of astrophysical mhd flows .",
    "the code has been developed for use in several coordinate systems : ( 1 ) 2.5d axisymmetric cylindrical coordinates ( @xmath0 ) ; ( 2 ) 2d polar coordinates ( @xmath1 ) ; ( 3 ) 3d cylindrical coordinates ( @xmath2 ) ; and ( 4 ) a cartesian ( @xmath3 , @xmath4 ) geometry which is used to conduct tests of the ideal and non - ideal mhd modules .",
    "the difference between our code and the above - mentioned codes lies in the specifics of the astrophysical problems that we solve .",
    "firstly , in the astrophysical regimes that we study , strong shocks ( where the energy dissipation can not be neglected ) are not expected to occur .",
    "this permits the use of the entropy conservation equation instead of the full energy equation .",
    "the advantage of this approach is that the entropy conservation equation does not contain terms that differ significantly in magnitude .",
    "for example , in the energy equation , the largest terms are the gravitational energy and the kinetic energy of the azimuthal motion ; these can be much larger than the internal energy and the energy of the poloidal motion near a gravitating body ( for example , a planet or star ) . additionally , in the vicinity of a magnetized star",
    ", the magnetic energy density can significantly exceed the matter pressure ( and the energy - density of thermal energy ) , leading to significant errors when computing the energy conservation equation .",
    "the different geometries have each been developed to solve a specific astrophysical problem and hence , there are slight differences in the algorithms across the various coordinate systems .",
    "the first version of the code to be developed was the axisymmetric 2.5d version ; its aim is to model the interaction of accreting magnetized stars with the surrounding accretion disk .",
    "the 2d version in polar coordinates was developed later on to study the situation where planets orbit in a magnetized disk .",
    "lastly , the 3d cylindrical version of the code was created to study intrinsically three dimensional problems such as bending waves in the disk or planets on inclined orbits .",
    "each version of the code is based on the standard ideal mhd approach : the matter flow can be described with the one - fluid approximation .    in the 2d polar version of the code ,",
    "the components of the velocity and magnetic field perpendicular to the plane of the flow are set to zero .",
    "additionally , surface density is used instead of volume density .",
    "the formal structure of the mhd equations is the same but we make additional suggestions about the disk and the definitions of the ( surface ) magnetic field so that the conservation equations retain the same conservative form .",
    "our codes use a riemann solver based on methods developed by @xcite , modified to include the equation for the entropy balance .",
    "the 2.5d axisymmetric cylindrical version of the code was developed to investigate astrophysical processes like disk accretion , magnetospheric accretion onto a magnetized star and outflows launched from the disk and star .",
    "such mhd flows may be responsible for many the observed properties of young stars . in all of these processes , both the magnetic field of the star as well as magnetic fields induced in the magnetosphere of the star and in the accretion disk play an important role .",
    "it is often suggested that the angular momentum transport in the accretion disk is due to the magnetic turbulence associated with the magnetorotational instability ( mri ) ( e.g. , @xcite ) . however , modelling this instability requires high grid resolution in the disk , which is computationally expensive . in many cases , it is more practical to allow for steady accretion by incorporating viscosity terms into the code that mimic the angular momentum transport , but do not require high grid resolution .",
    "for this reason , the 2.5d version incorporates an @xmath5-type viscosity @xcite which can be switched on or off depending on the phenomena being studied .",
    "it is less clear how the matter in the disk interacts with magnetic field  that is , which physical processes provide efficient magnetic diffusivity in the disk .",
    "reconnection of the magnetic field lines can provide an efficient diffusion mechanism , but the process of reconnection itself also requires some magnetic diffusivity .",
    "since the exact mechanism is poorly understood , the magnetic diffusivity is often parametrized in the non - ideal mhd terms .",
    "this is implemented in the 2.5d version of the code as a diffusivity module , which can also be switched on or off , with the diffusivity coefficient represented in a way analogous to the @xmath6viscosity .    in the 2.5d axisymmetric cylindrical version of the code ,",
    "we split the magnetic field into a fixed component associated with the stellar magnetic field ( for example a dipole field ) and a field induced by currents in the magnetosphere and disk @xcite .",
    "in contrast , the magnetic field in the 2d polar version is not split into a stellar and current - induced component as the code was initially developed to study the interaction of a planet with a disk threaded by a magnetic field . in order to accurately compute the strength of the stellar gravity on the planet",
    ", the grid is allowed to co - rotate with the planet .",
    "this approach was suggested by @xcite , albeit for a different situation .",
    "the 3d cylindrical version of the code combines the two previous versions , enabling investigations of phenomena such as planet migration in a magnetized accretion disk , accretion onto a magnetized star as well as a variety of other problems .",
    "however , there is no diffusivity module implemented in the 3d version because the 3d instabilities which cause the magnetic field to diffuse are fully modelled .    in this work ,",
    "we describe our godunov - type codes which have been implemented on several different geometries and are designed for solving non - relativistic astrophysical mhd problems .",
    "[ sec : godunov ] describes different godunov approaches and the approach used in our codes . in sec .",
    "[ sec : numerical algorithms ] , we describe the different coordinate systems in detail . in sec .",
    "[ sec : tests ] , we describe tests of the code . sec .",
    "[ sec : astrophysical examples ] shows applications of these codes for different astrophysical problems and we conclude with a summary in sec .",
    "[ sec : conclusions ] .",
    "here we present the full set of ideal 3d mhd equations . viscosity and diffusivity",
    "are implemented for specific geometries and are described separately in sec .",
    "[ subsec : viscosity and diffusivity ] .",
    "the continuity equation in conservative form is : @xmath7 here @xmath8 are the 3d cylindrical coordinates , @xmath9 is the density , @xmath10 is the velocity , and @xmath11 is the time . the entropy conservation equation is : @xmath12 where @xmath13 is the entropy per unit mass and @xmath14 is the adiabatic index . the momentum equations in the @xmath15 , @xmath16 and @xmath17 directions are @xmath18 @xmath19 @xmath20 where @xmath21 is the magnetic field vector , @xmath22 is the total pressure , and @xmath23 is the net external force from the central star and planet .",
    "lastly , the induction equations are : @xmath24 this system of equations describes the evolution of a magnetized plasma in cylindrical coordinates .",
    "in order to numerically solve the ideal mhd equations ( eqs . [ eq : cons_eqn]-[eq : full-3d ] ) , we use the godunov method . in godunov - type schemes ,",
    "the central problem is to develop an exact or approximate algorithm to solve the riemann problem .",
    "the construction of an exact solution to the riemann problem is possible , but it can be numerically complex and is often computationally expensive .",
    "the procedure of exact solutions of the riemann problem has been realized by @xcite and these exact solutions are used for the testing of our approximate riemann solver .",
    "consider the one - dimensional hyperbolic system of equations in conservative form : @xmath25 here , @xmath26 is the vector of conservative variables and @xmath27 is the flux function which maps each conservative variable to its corresponding flux .",
    "[ 1 - 1 ] can be rewritten in the integral form of the conservation laws @xmath28 where @xmath29 represents the _ exact solution _ of the riemann problem between the left and right states @xmath30 and @xmath31 ; @xmath32 is a self - similar distance - time variable ; @xmath33 is the interval along the variable @xmath34 at which all of the waves are localized ; and @xmath35 and @xmath36 are the fluxes for the left and right states , respectively .",
    "the riemann problem can be approximated by a number of discontinuities , each of which satisfies the rankine - hugoniot jump conditions : @xmath37 here , @xmath38 is velocity of the discontinuity ; @xmath39 are the conservative variables on either side of the discontinuity ; and @xmath40 are the fluxes of the conservative variables across the discontinuity . in the general case , @xmath41 and @xmath42 , excluding @xmath43 . in this case , the condition for self - consistency of the conservation laws is evidently satisfied , while eq .",
    "[ 1 - 1b ] for the calculation of fluxes gives @xmath44 , where @xmath45 is the flux in the interval which includes the point @xmath46 .",
    "if the point @xmath47 is located at the boundary between intervals ( that is , at the discontinuity where @xmath48 ) , then the flux can be calculated for any two adjacent states .",
    "these fluxes are the same as the ones present in the rankine - hugoniot jump conditions .",
    "-plane.,width=302 ]    the approximate solution of the riemann problem is represented by the vector @xmath49 which approximates the same conservation laws in integral form .",
    "the flux between the left and right states is approximated by @xmath50 one of the simplest approximate riemann solvers was proposed by @xcite and has two discontinuities separating three homogeneous states ( as shown in fig . [ hll ] ) .",
    "one discontinuity propagates to the left with velocity @xmath51 , while the other propagates to the right with velocity @xmath52 .",
    "the approximate solution is assumed to be homogeneous between these discontinuities : @xmath53 .",
    "-plane.,width=294 ]    more advanced approximate riemann solvers include two or more intermediate states @xcite .      here",
    ", we describe the construction of our godunov method for the equations of ideal mhd .",
    "as noted earlier , we use the entropy conservation equation instead of the energy equation . the conservative variables and fluxes in eq .",
    "[ 1 - 1 ] take on the form : @xmath54    @xcite proposed a modification of the hllc approximate riemann solver for the equations of mhd in which the transverse @xmath55-components of the velocity and magnetic field are assumed to be the same in both intermediate states . for this reason , in the limit @xmath56 , the hllc solver does not convert to the hllc algorithm with a purely transverse magnetic field ; this is because arbitrary jumps of the @xmath57-components of velocity and magnetic field are still allowed at the contact discontinuity ( as they are converted to the tangential component ) .",
    "the choice of entropy conservation inhibits the modeling of mhd flows with strong shocks at which entropy production occurs .",
    "our approximate solution has four intermediate states ",
    "the wave propagation in the hlld algorithm is shown in fig .",
    "the initial discontinuity between the states @xmath58 and @xmath59 decays and the discontinuities appear , propagating away with velocities @xmath60 ( the fast magnetosonic waves ) , @xmath61 ( the alfvn waves ) and @xmath62 ( the contact discontinuity ) .",
    "these jumps separate the initial @xmath63 and intermediate @xmath64 states ( see fig .",
    "[ hlld ] ) .",
    "the calculation of the conservative variables and fluxes in the intermediate states is performed using the following scheme .",
    "the normal velocities across the alfvn and contact discontinuities are assumed to be continuous @xmath65 which implies @xmath66 from the rankine - hugoniot jump conditions .",
    "we write the rankine - hugoniot conditions for fast magnetosonic waves for all equations except the conservation equation for the @xmath67component of the momentum . for the densities in states @xmath68 and @xmath69 , we obtain the relations @xmath70 from eq .",
    "[ 1 - 2 ] and the @xmath3-component of the momentum equation we obtain @xmath71 where @xmath72 - \\\\ & \\left [ \\left ( \\rho v_x^2 + p + \\frac{b^2}{8\\pi } - \\frac{b_{x0}^2}{4\\pi } \\right)_r - b_r ( \\rho v_x)_r \\right ] ~.\\end{aligned}\\ ] ]    combining eq .",
    "[ 1 - 2 ] and the rankine - hugoniot jump conditions for the entropy , we find @xmath73    to calculate the transverse components of the velocity and magnetic field in the intermediate states , we use the corresponding components of the momentum and induction equations . in the intermediate states ,",
    "@xmath68 and @xmath69 , these values are determined from the jump conditions across the fast magnetosonic waves : @xmath74 analogously , we have @xmath75 the values of @xmath76 are calculated using the same formulae , substituting the index @xmath77 .",
    "the rankine - hugoniot jump conditions at the alfvn waves ( with @xmath78 ) can be solved , but only if @xmath79 in the first case , we adopt @xmath80 , which corresponds to an alfvn wave propagating to the left along the state @xmath68 . in the second case ,",
    "we take @xmath81 , which corresponds to an alfvn wave propagating to the right along the state @xmath69 .    to compute the transverse components of the velocity and magnetic field in the intermediate states @xmath82 , we use the fact that at the contact discontinuity @xmath83 for @xmath84 .    plugging these into the integral conservation laws , we find that the transverse components of the velocity and magnetic field are @xmath85 where @xmath86 @xcite .",
    "note that the transverse components of the magnetic field @xmath87 are not necessarily equal ( @xmath88 ) due to the jump conditions for the alfvn waves in the complete system of mhd equations . here , we remove the condition @xmath89 ( in this case , for the @xmath67component of the momentum equation ) and hence lose the continuity of the magnetic pressure for the alfvn waves .    the fluxes in the intermediate states are calculated from the jump conditions @xmath90 one does not need to calculate all of the fluxes .",
    "rather , we determine which of the states appears at the point @xmath47 ( in other words , which interval @xmath91 contains the point @xmath47 ) and then calculate the corresponding flux using one of the formulae ( [ 1 - 5a])-([1 - 5d ] ) .    in the limit @xmath56 , the relationships in eq .",
    "[ 1 - 4 ] give the result @xmath92 similar relationships can be derived for the @xmath17-component of velocity and magnetic field and for the fast magnetosonic wave which propagates to the right along @xmath59 . additionally since @xmath93",
    "when @xmath94 , the intermediate states @xmath82 disappear .    in the above derivations it is assumed that the inequalities @xmath95 are satisfied .",
    "the case @xmath96 , corresponding to @xmath94 , has been considered above . the cases where @xmath97 or @xmath98 correspond to the switch - on waves propagating to the left or to the right , assuming @xmath99 or @xmath100 at @xmath84 , and are not considered .",
    "the wave velocities @xmath51 and @xmath52 are estimated as @xmath101 where @xmath102 are the velocities of the fast magnetosonic waves , propagating along the states @xmath63 respectively .      equations [ 1 - 4 ] and [ 1 - 5 ] show the values of the tangential velocities and magnetic fields in the intermediate states @xmath103 .",
    "the numerators on the right - hand sides of these formulae are non - negative , while the denominators have the form @xmath104 the formula for the left state is analogous .",
    "the physical sense of the last value is such that it should be positive because the alfvn wave should always propagate slower than the fast mhd discontinuity .",
    "the case when this denominator is zero corresponds to the switch - on wave , in which a finite tangential field beyond the discontinuity appears from the zero tangential field in front of the discontinuity . in the approximate riemann solver it is reasonable to retain this property ( the positive sign of the denominator ) in order to avoid a non - physical change of the sign of the tangential field and the appearance of a singularity as @xmath105 . for that",
    ", we require that the inequality @xmath106 is satisfied , at some @xmath107 . in that case",
    ", we have @xmath108 this can be rewritten as @xmath109 comparing this relationship with that for @xmath110 , we conclude that if the condition in eq .",
    "[ 1 - 6 ] is satisfied then @xmath111 .",
    "analogously : @xmath112 if the conditions in eq .",
    "[ 1 - 6 ] and/or eq .",
    "[ 1 - 7 ] are not satisfied ( after computing @xmath62 using eq .",
    "[ 1 - 3 ] ) then we perform a correction of @xmath52 and/or @xmath51 , choosing the fast magnetosonic velocity to be the largest and/or the smallest of the roots of eqs .",
    "[ 1 - 6 ] and/or [ 1 - 7 ] . here , @xmath52 can only increase while @xmath51 can only decrease .",
    "we then recalculate the value @xmath62 , check the conditions in eqs .",
    "[ 1 - 6 ] and [ 1 - 7 ] , and if necessary , once again apply corrections to @xmath51 and @xmath52 .",
    "we use the equation for entropy conservation instead of the equation of energy conservation . in this case",
    ", the correction of the velocities of the fast mhd discontinuities and the positivity of the approximate solution of the riemann solver ( in the sense that the density and entropy are positive in all intermediate states ) is established trivially .",
    "to increase the accuracy of the numerical algorithm , we perform a two - stage runge - kutta integration of the equations in time .",
    "in the first stage , we calculate the values for the intermediary timestep , @xmath113 @xmath114 here , the fluxes @xmath115 are calculated using the entropy - based hlld algorithm described above .",
    "formally , we can write the flux calculation procedure in the form @xmath116 where we take the left and right states in the hlld solver to be @xmath117 and @xmath118 .",
    "in a 2d cartesian @xmath131 geometry , the mhd equations take the form @xmath132 unlike the 1d case , the vector of the conservative variables @xmath133 has a total of seven components .",
    "the sixth and seventh components are @xmath134 and @xmath135 , which must satisfy the divergence free condition @xmath136 the numerical algorithm for 2d is analogous to the 1d case .",
    "the integration in time is performed using the two - step runge - kutta method @xmath137 at the same time , @xmath138 .",
    "an analogous algorithm for the calculation of fluxes is also used during the second stage of the time - advancement computation .    to ensure that the magnetic field is divergence - free in 2d , we use the method proposed by @xcite . in application to problems in cartesian coordinates , this approach is the following : if eq .",
    "[ 2 - 1 ] is satisfied , then one can represent the @xmath3 and @xmath139components of the magnetic field in the form @xmath140 at the same time , @xmath141 .",
    "when the equations are discretized , the conservative variables @xmath133 are determined in the cells while the @xmath3 and @xmath4 fluxes , @xmath142 and @xmath143 , are computed on the sides of the cells .",
    "the corresponding components of the flux function vectors @xmath142 and @xmath143 are @xmath144 where @xmath145 is the @xmath17 component of the electric field ( multiplied by the speed of light ) .",
    "thus , the @xmath17 component of the electric field is calculated twice using two different methods : the first as @xmath146 , and the second as @xmath147 .",
    "if @xmath148 is determined on the nodes of the grid @xmath149 , the components of the magnetic field can be calculated on the sides of the cells as @xmath150 at the same time , the divergence - free condition will be satisfied if we require @xmath151 the magnetic field in the cells are then computed from the calculated values on the cell boundaries @xmath152    to calculate @xmath153 at the @xmath154 timestep , we determine the @xmath155component of the electric field at each node . the simple variant proposed by @xcite consists of averaging the values @xmath156 and @xmath157 over the cell sides surrounding the node at @xmath149 . for a homogeneous grid , this is @xmath158    in @xcite it was noted that this approach is inconsistent with the numerical integration algorithm in the case of 1d problems ( where the solution does not depend either on @xmath3 or on @xmath4 ) , and that the proposed procedure does not guarantee consistency . @xcite",
    "propose a modified form ( for homogenous grids ) @xmath159 to calculate @xmath160 , we use either eqs .",
    "[ 2 - 2 ] or [ 2 - 3 ] .",
    "[ 2 - 3 ] has applications in damping out small - scale oscillations of the magnetic field .",
    "thus , at each stage of numerical integration of the mhd equations , the magnetic field in the @xmath161 plane is calculated along the following algorithm :    1 .",
    "use an approximate riemann solver to find the @xmath155components of the electric field at the sides of cells @xmath146 , @xmath147 .",
    "2 .   use eq .",
    "[ 2 - 2 ] or [ 2 - 3 ] to calculate the electric field in the nodes of the grid @xmath162 .",
    "3 .   calculate the @xmath155component of the magnetic field potential in grid nodes , @xmath153 .",
    "4 .   calculate @xmath163 and @xmath164 .",
    "5 .   using eq .",
    "[ 2 - 1a ] , calculate @xmath165 and @xmath166 .",
    "to solve the 2.5d mhd equations ( with magnetic diffusivity and viscosity ) in the disk , we split the different physical processes into several different modules .",
    "these are : ( 1 ) the  ideal mhd \" module in which we calculate the dynamics of the plasma and magnetic field with dissipative processes switched off ; the `` diffusivity '' modules ( 2 ) and ( 3 ) which calculate the diffusion of the poloidal and azimuthal components of the magnetic field for frozen values of the plasma velocity and thermodynamic parameters ( density and pressure ) ; and the `` viscosity '' module ( 4 ) which computes the viscous dissipation in the disk .    *",
    "( 1 ) * in the hydrodynamic module , the ideal mhd equations are integrated numerically using an explicit conservative godunov - type numerical scheme . in our numerical code",
    ", the dynamical variables are determined in the cells , while the vector - potential of the magnetic field , @xmath167 , is determined on the nodes . to calculate the fluxes between the cells , we use the previously described approximate riemann solver .    for better spatial resolution",
    ", we perform the reconstruction of the primitive variables to the boundaries between the calculated cells .",
    "we use two types of limiters : a ) the minmod limiter @xcite , and b ) a limiter which reconstructs the function with 3rd order accuracy ( which is similar to the limiter developed by @xcite ) .",
    "integration of the equations in time is performed with a two - step runge - kutta method .    to guarantee a divergence - free field in the 2.5d version of the code",
    ", the @xmath16-component of the magnetic field vector - potential @xmath167 ( or magnetic flux function @xmath168 ) is calculated at each timestep and then used to obtain the poloidal components of the magnetic field ( @xmath169 , @xmath170 ) in a divergence - free form @xcite .",
    "in other words , the condition @xmath171 is guaranteed to be satisfied to within machine accuracy .",
    "the calculation of @xmath167 is performed using either the algorithm proposed by @xcite or the modified form proposed by @xcite .    * ( 2 ) * in the module where the diffusion of the poloidal magnetic field is calculated , we numerically integrate the equation for the @xmath16-component of magnetic field vector - potential ( or magnetic flux function @xmath172 ) , using an explicit approximation .    * ( 3 ) * in the module where the diffusion of the azimuthal component of the magnetic field and * ( 4 ) * the viscous stresses are calculated , we add diffusive terms which approximate the corresponding spatial derivatives to the fluxes calculated by the ideal mhd module .",
    "the ideal and diffusivity modules are verified separately using a number of standard tests .",
    "the setup and results of these tests are discussed in sec .",
    "[ sec : tests ] .",
    "the ideal mhd equations in the axisymmetric cylindrical geometry are derived from the full set of 3d mhd equations by requring that @xmath173 ( see sec .",
    "[ subsec : geom 3d ] ) .",
    "the equations are written in a form which does not have singularities on the right hand side .",
    "for the @xmath174 and @xmath175components of the equation of motion and @xmath175component of the induction equation , we substitute the operator @xmath176 , representing divergence operator in cylindrical coordinates . as a result , the @xmath175component of the equations of motion takes on the form of angular momentum conservation while the @xmath175component of the induction equation takes on its typical form .    in discretizing the cylindrical mhd equations , we take into account the fact that near the symmetry axis ( where @xmath177 ) , different variables have different asymptotic behavior .",
    "for example , the values @xmath178 as @xmath177 whereas the values @xmath179 scale with @xmath15 .",
    "analogous behavior is shown by the fluxes corresponding to these variables .",
    "in particular , in the approximation of the @xmath175component of the equation of motion ( the angular momentum equation ) , we multiply the fourth equation ( eq . [ eq : momeqn_phi ] ) by @xmath180 and integrate it along @xmath15 and @xmath17 in the limits of the calculated cell @xmath181 .",
    "the equation is then rewritten in the form @xmath182 and @xmath183 , where @xmath184 and @xmath185 weakly depend on @xmath15 .",
    "here we have dropped the indices on @xmath186 and @xmath187 .",
    "we have @xmath188 next @xmath189 where @xmath190 analogously , @xmath191 thus , the angular momentum conservation equation for the cell @xmath192 has the form : @xmath193 it is clear that this approximation of the operator @xmath194 and more precisely of the multiplier @xmath195 , significantly differs from analogous terms ( for example , of @xmath196 ) only in the vicinity of the symmetry axis .",
    "the flux densities @xmath197 and @xmath198 , which are used in eq .",
    "[ eq : momeqn_phi ] , are calculated using the 1d algorithm for the approximate solution of the riemann problem .      here",
    "we discuss the treatment of viscosity and diffusivity .",
    "we use equations of motion in cylindrical coordinates in the form : @xmath199 @xmath200 @xmath201 the stress tensor @xmath202 consists of an ideal part @xmath203 : @xmath204 which is used to derive the momentum equations in eqs .",
    "[ eq : momeqn_r ] , [ eq : momeqn_phi ] and [ eq : momeqn_z ] , and a viscous part @xmath205 which takes into account small - scale turbulent velocity and magnetic field fluctuations .",
    "we assume that the stress due to the turbulent fluctuations can be represented in the same way as the collisional viscosity by substituting in the turbulent viscosity coefficient .",
    "the components of the tensor @xmath205 in axisymmetric cylindrical coordinates are : @xmath206 here @xmath207 is the angular velocity of the plasma and @xmath208 is the dynamical turbulent viscosity . in 3d",
    ", we only consider the @xmath209 and @xmath210 components of the stress tensor as these are expected to be dominant ; similarly , in 2d polar coordinates , we only consider the @xmath209 component",
    ".    separating out the viscous stress in the @xmath16 component of the momentum equation gives @xmath211 where @xmath212 and @xmath213 are components of the inviscid part of the stress tensor .",
    "we assume that the plasma has a finite magnetic diffusivity .",
    "that is , the matter may diffuse across the field lines .",
    "we also assume that the finite diffusivity of the plasma is due to the small - scale turbulent fluctuations of the velocity and the magnetic field .",
    "the induction equation averaged over the small - scale fluctuations has the form @xmath214 here , @xmath215 and @xmath216 are the averaged velocity and magnetic fields , and @xmath217 is electromotive force connected with the fluctuating fields .",
    "since the turbulent electromotive force @xmath218 is connected with small - scale fluctuations , it is reasonable to suppose that it has a simple relation to the ordered magnetic field @xmath219 .",
    "if we neglect the magnetic dynamo @xmath5-effect @xcite , then @xmath220 , where @xmath221 is the coefficient of turbulent magnetic diffusivity . equation ( [ 4 - 1 ] ) now takes the form @xmath222 we should note that the term for @xmath223 formally coincides with ohm s law @xmath224 the coefficient of turbulent electric conductivity @xmath225 .    to calculate the evolution of the poloidal magnetic field it is useful to calculate the @xmath16-component of the vector - potential @xmath226 or magnetic flux function @xmath168 .",
    "due to the assumed axisymmetry , @xmath227 substituting @xmath228 into the induction equation gives the equation for the @xmath16 component of the vector - potential @xmath229    the azimuthal component of the induction equation gives @xmath230    the viscosity and magnetic diffusivity lead to dissipation of the kinetic and magnetic energies , conversion into thermal energy and a corresponding increase of the entropy . in our simulations",
    "we have neglected viscous and ohmic heating .",
    "we have also neglected radiative cooling .",
    "thus , the main effect of the viscous terms is the transport of angular momentum outward which allows matter to accrete inward to the disk - magnetosphere boundary .",
    "the main effect of the diffusion terms is the transport of matter through magnetic field lines .",
    "the dissipative terms @xmath231 and , @xmath232 are incorporated into the numerical algorithm by way of a flux correction in the finite - difference equations .",
    "the modified fluxes @xmath233 are included in the angular momentum conservation equations , and the modified fluxes @xmath234 ( components of the poloidal electric field ) are included into the @xmath175component of the induction equation .",
    "the approximation of the viscous stresses takes the form : @xmath235 the approximation of the poloidal electric field has the form : @xmath236 here , @xmath237 and @xmath238 are the @xmath155 and @xmath174components of electric field , and @xmath239 are the same components calculated in the approximation of the ideal plasma conductivity using the algorithm described above , @xmath240 .    the coefficients of the dynamical viscosity at the boundaries between calculated cells are calculated according to @xmath241 . here ,",
    "@xmath242 and @xmath243 are the coefficients of the dynamical viscosity in the grid cells .",
    "analogously , we calculate @xmath244 and the coefficient of the dynamical viscosity at the boundaries between cells .    the azimuthal component of the electric field , responsible for the evolution of the magnetic flux function @xmath172 , is approximated using a special method .",
    "the azimuthal component of the turbulent electric field @xmath245 is presented in the form @xmath246 and approximated by @xmath247 .",
    "\\end{split}\\ ] ]    a corresponding term is added to eq .",
    "[ 4 - 4 ] , which takes on the form @xmath248 = - r_{i+1/2 } e_{\\phi , i+1/2,j+1/2}^{id}. \\end{split}\\ ] ] the values of @xmath249 on the right hand side are calculated using eqs . [ 2 - 2 ] and [ 2 - 3 ] . at the first step of the time integration",
    ", we use a time - step of @xmath250 and calculate the values of @xmath251 .",
    "we have also developed a fully three dimensional version of the code in cylindrical coordinates . to calculate the fluxes between cells , we use the hlld method as in the 2.5d code @xcite . to correct the fluxes",
    ", we use the minmod flux corrector , which is applied on the primitive variables @xmath252 . to integrate the equations in time",
    ", we use the two - step runge - kutta method .",
    "the main differences between the 2d and 3d codes lie in the algorithm which ensures that the magnetic field is divergence - free .",
    "namely , the divergence - free condition is guaranteed by calculating the components of the magnetic field on the sides of cells from the induction equation : @xmath253 the components of the electric field are calculated at the edges of the cell as in the axisymmetric case .",
    "for example : @xmath254 where the values on the right hand side are the corresponding fluxes calculated by the riemann solver : @xmath255 is determined between cells @xmath256 and @xmath257 and so on .    after calculating the electric field components , the magnetic field components at the sides of cells ( for example , @xmath169 at @xmath258 )",
    "are calculated using the formula @xmath259    the other components @xmath260 and @xmath261 are calculated in a similar fashion .",
    "this ensures that the magnetic field @xmath262 is divergence - free ( so long as the field is initially divergence - free at the beginning of the simulation ) . as a next step , the magnetic field in the cells",
    "is calculated from the values on the cell boundaries : @xmath263      to describe the interaction of the accretion disk with a planet in the presence of a magnetic field , we use a model which describes the processes in terms of surface variables ( density and pressure ) .",
    "the equations for this model are obtained by integrating the three - dimensional mhd equations along the @xmath155direction which is perpendicular to the disk plane . for simplicity , we assume that the @xmath155components of the velocity and the magnetic field are zero and there is no field outside the disk .    the governing equations are derived from the ideal mhd equations ( eq .",
    "[ eq : full-3d ] ) by integrating in the vertical direction : @xmath264 @xmath265 @xmath266 @xmath267 here @xmath268 is the surface density ; @xmath269 is the surface pressure ; @xmath270 is the @xmath17-averaged analog of the mangetic field ; @xmath271 is an analog of the entropy ; @xmath272 , and @xmath273 are the components of the force per unit surface area acting from the planet on the disk matter .",
    "these resemble the standard form of the 2d equations where the @xmath155derivative in the 3d equations is set to 0 .",
    "the induction equations take on the form @xmath274 @xmath275 here , @xmath276 is the `` magnetic thickness '' of the disk , which is the characteristic scale for the magnetic field distribution in @xmath155direction .",
    "this scale is not identical to the disk height @xmath277 which characterizes the @xmath155distribution of the density and pressure in the disk .",
    "we take @xmath276 to be the same across both equations .",
    "since the magnetic field in the disk is unlikely to change sign in the vertical direction , the approximation seems to be reasonable . the next suggestion which helps to close",
    "the system of equations is in the dependence of the magnetic thickness of the disk @xmath278 on the radius .",
    "in particular , if we assume @xmath276 is constant , then the induction equations will also take the standard form ( in the same sense that @xmath279 ) . to calculate the magnetic field and volumetric density and pressure from the @xmath155integrated values ,",
    "we assume a disk thickness at some characteristic radius and back out the volumetric terms .",
    "we have performed multiple tests of the code across different grid geometries . below we show two examples of such tests . in the first , we test the ideal mhd module ( with the viscosity and diffusivity modules switched off ) . in the second , we test the diffusion module separately .",
    "( left panel ) , @xmath280 ( middle panel ) and @xmath281 ( right panel ) . _",
    "bottom panels : _ the density contour lines . ]",
    "the first test is the standard  rotor problem \" in cartesian coordinates .",
    "this test has been used by a number of authors for testing mhd solvers which use the energy equation @xcite .",
    "we use this test to check the ideal mhd module of our code ( with viscosity and diffusivity switched off ) .",
    "the ideal mhd equations are solved on a regular cartesian grid in the region @xmath282 , @xmath283 with grid sizes @xmath284 , where @xmath285 for the three different tests . at the beginning of the simulations , @xmath286 ,",
    "the pressure in the region is constant , @xmath287 , and the magnetic field is homogeneous , @xmath288 , @xmath289 . in the center",
    ", there is a circle of higher - density matter ( @xmath290 ) with radius @xmath291 ( where the radius is @xmath292 ) .",
    "the matter in the inner circle initially rotates as a solid body with angular velocity @xmath293 . for @xmath294 ,",
    "the density is @xmath295 and the matter is at rest . in the ring in between these two regions @xmath296 , the density and velocity are linearly interpolated between the values at @xmath297 and @xmath298 .    ,",
    "pressure @xmath299 , kinetic energy , @xmath300 and magnetic energy @xmath301 along a horizontal line at the center of the rotor at time @xmath302 . [ fig : rotor_cuts],scaledwidth=45.0% ]    the equations of ideal adiabatic mhd are solved with the previously described godunov - type scheme .",
    "the timesteps are calculated from the condition @xmath303 where @xmath304 is the maximum timestep allowed by the courant - friedrichs - levy ( cfl ) condition .",
    "the results of the simulations at @xmath302 are shown in fig .",
    "[ ideal-6 ] . evidently , the density and the field line distribution is very similar in all three of our cases .",
    "the bottom panels of fig .",
    "[ ideal-6 ] show selected streamlines with numbers which clearly show the similarity of the results across the various grid sizes .",
    "[ fig : rotor_cuts ] shows slices along the @xmath3-axis for the density , pressure , kinetic energy , and magnetic energy for each of the three grid sizes in addition to a high resolution grid with @xmath305 . at the highest resolutions ,",
    "the models are nearly indistinguishable and the convergence of the results is evident .      .",
    "from left to right : contours of the pressure , density and magnetic flux functions at the moment of time when the scaling parameter is @xmath306 . in all of the plots ,",
    "the solid line shows the numerical solution while the dashed line shows the analytical low - type solution.,width=268 ]    , but using an inhomogeneous grid with @xmath307.,width=268 ]    .",
    "the dependence of the radial component of velocities and components perpendicular to the radius on the spherical radius for all grid cells.,width=288 ]    . from left to right : pressure , density and magnetic flux function at the moment of time when the scaling parameter is @xmath306 . in all plots ,",
    "the solid line shows the numerical solution , dashed line  analytical solution.,width=226 ]    to test the ideal mhd module , we also compare our numerical calculations with analytic solutions found by @xcite .",
    "one of them has been used in @xcite for testing the corresponding module of the zeus code .",
    "it is convenient to write these solutions in spherical coordinates ( as we will do below ) , and then to convert them to cylindrical coordinates .    these solutions are self - similar and assume that the magnetic flux function @xmath172 has a dependence on the time and radial coordinate of the form @xmath308 .",
    "here @xmath309 is a time - dependent scaling parameter and @xmath34 is the self - similarity radius .",
    "the velocity has only a radial component ( in the spherical coordinate system ) which depends linearly on the radius .",
    "the function @xmath310 satisfies the equation @xmath311 , and the magnetic flux function satisfies the grad - shafranov equation .",
    "the other variables are connected with @xmath310 and @xmath172 and their derivatives by algebraic relationships . the first solution proposed by @xcite and used for",
    "testing does not have an azimuthal component of the magnetic field .",
    "the second solution used in @xcite has a non - zero azimuthal magnetic field @xmath312 , but the motion of the plasma is inertial .    in the first solution , @xcite chose growing solutions of the function @xmath310 @xmath313 the magnetic flux function has the form @xmath314 the poloidal components of the magnetic field are calculated along the known formulae @xmath315 the initial pressure and density are @xmath316 ( \\xi^2 - \\xi_0 ^ 2 ) , \\\\ & \\rho = \\frac{2 c^2 \\xi}{\\pi a^3 ( \\alpha \\xi + gm/\\xi^2 ) } \\bigg[7 ( \\xi^2 - \\xi_0 ^ 2)^2 \\xi^2 \\sin^2 \\theta + \\xi_0 ^ 6 \\bigg].\\end{aligned}\\ ] ] and the radial velocity is given by : @xmath317    we take the following parameters for the problem : @xmath318 , the adiabatic index is @xmath319 .    the solution is numerically computed over the region @xmath320 , @xmath321 with a rectangular region , @xmath322 , @xmath323 excised from the simulation .",
    "we use two grids : a homogeneous grid , with @xmath324 , and an inhomogeneous grid , @xmath325 . in both cases ,",
    "the excised rectangular region is homogeneous , with dimensions @xmath326 , though values are not computed in this region .",
    "thus , the cell sizes of the homogenous grid are @xmath327 and @xmath328 . for the inhomogeneous grid ,",
    "the grid size is increased in a geometrical progression with the power @xmath329 .",
    "the integration time - step has been chosen automatically such that @xmath330 .",
    "the function @xmath310 is determined by numerically integrating eq .",
    "[ 5 - 1 ] with the initial condition @xmath331 at sufficiently fine grid resolution . as an initial condition",
    ", the analytical solution is used with the parameter @xmath332 . for boundary conditions",
    ", we also use the analytical solution for all variables with the parameter @xmath309 corresponding to the moment of time . the simulations were performed up to the moment of time when @xmath306 .",
    "[ lou - un - a6 ] and fig .",
    "[ lou - nun40-a6 ] from left to right show the pressure , density and magnetic flux function at the moment of time when the scaling parameter is @xmath306 .",
    "[ lou - un - a6 ] shows the result of the simulations on a homogeneous grid , while fig .",
    "[ lou - nun40-a6 ] shows the results for the inhomogeneous grid . in all of the plots ,",
    "the solid line shows the numerical solution and the dashed line shows the analytical solution .",
    "[ lou - v - a6 ] shows the radial and transverse components of the velocities as a function of the spherical radius .",
    "one can see that the velocity is directed along the radial direction and is proportional to the radius with the high accuracy .    .",
    "the dependence of the radial component of velocities and components perpendicular to the radius on the spherical radius for all grid cells.,width=192 ]    in the second solution @xcite the scaling factor linearly depends on time , @xmath333 . in this case",
    ", the magnetic flux function has the form @xmath334 \\dst{0 } & \\xi > \\xi_c~. \\end{array } \\right.\\ ] ] the poloidal components of the magnetic field ( in spherical coordinates ) can be calculated using the analytic solution @xmath335 \\dst{0 } & \\xi > \\xi_c~. \\end{array } \\right.\\ ] ] @xmath336 \\dst{0 } & \\xi > \\xi_c~. \\end{array } \\right.\\ ] ] the azimuthal component of the magnetic field is @xmath337 \\dst{0 } & \\xi > \\xi_c~. \\end{array } \\right.\\end{aligned}\\ ] ] the density and pressure are given by @xmath338 @xmath339 \\dst{\\frac{7 d_0}{a^3 } \\left(\\frac{r_0}{\\xi } \\right)^8 } & \\xi > \\xi_c~. \\end{array } \\right.\\ ] ] @xmath340 @xmath341 \\dst{\\dfrac{7 d_0 \\eta r_0 ^ 2   } { 6 a^4 } \\exp \\left ( \\frac{2 gm}{3 \\eta r_0 ^ 3 } \\left(\\frac{r_0}{\\xi}\\right)^9 \\right ) } & \\xi > \\xi_c~. \\end{array } \\right.\\ ] ] @xmath342 the radial velocity is simply @xmath343 .",
    "the parameters of the problem are assigned the following values : @xmath344 , the adiabatic index is @xmath319 .",
    "the equations of ideal mhd are integrated in the region @xmath345 , @xmath346 , where an inner rectangle with size @xmath347 , @xmath348 has been excised from the region .",
    "we use the homogeneous grid @xmath349 , and the grid in the excised region is @xmath350 .",
    "thus , the cell size is @xmath351 and @xmath352 .",
    "the time - step is chosen automatically such that @xmath330 . as an initial condition",
    ", we take the analytical solution described above for @xmath332 .",
    "we use the analytical solution for the boundary conditions , taking the parameter @xmath309 to correspond to the moment of time .",
    "the calculations are done up to the moment when the scaling parameter reaches the value @xmath306 .",
    "as before , fig . [ stone - a6 ] and fig . [ stone - v - a6 ]",
    "show the results of simulations at the moment when the scaling parameter becomes equal to @xmath306 .      as with the 2d code , we test the 3d code with the rotor problem .",
    "the 3d mhd equations are solved numerically in the cylindrical region @xmath353 , @xmath354 and the initial conditions are determined using the same initial conditions as in the 2d test . in the beginning of the simulations , @xmath286 , the pressure in the region is constant , @xmath287 , and the magnetic field is homogeneous , @xmath288 , @xmath289 . in the center",
    "there is a circle with radius @xmath291 where the matter density is @xmath290 and the matter rotates as a solid body with angular velocity @xmath293 . at @xmath294 ,",
    "the density is @xmath295 and the matter is at rest . in the ring @xmath296",
    ", the density and velocity are linearly interpolated between those at @xmath297 and @xmath298 .    in the test",
    "we use a homogeneous grid with @xmath355 .",
    "the integration time - step is chosen automatically in such way that @xmath356 .",
    "the results of the simulations at time @xmath357 are shown in fig .",
    "[ rotor ] .",
    "one can see that the density , pressure and the field line distributions are very similar to 2d case .      to test the ideal mhd module",
    ", we also use the analytical solution described in sec .",
    "[ subsubsec:2dlow ] .",
    "calculations were performed in the cylindrical region @xmath358 for a grid @xmath359 .",
    "results of simulations are shown in fig .",
    "[ lou ] . the color background shows pressure distribution ( left panel ) and density ( right panel ) .",
    "the lines show corresponding analytical solutions .    .",
    "_ left panel : _ density distribution ( color background ) and field lines ( solid lines ) . _ right panel : _ the pressure distribution ( color background ) and field lines ( solid lines).,width=264 ]     at scaling parameter @xmath360 , _ bottom panels : _ scaling parameter @xmath361 . ]    , magnetic flux function @xmath172 and the azimuthal velocity @xmath362 , from left to right .",
    "the solid lines indicate the numerical solutions while the dashed lines show the analytical solutions given by eqs .",
    "[ 5 - 5][5 - 7 ] .",
    "the bottom panels show the absolute errors in the calculation of the corresponding functions.,width=264 ]          here we test the diffusivity module of the code . for this",
    "we switch off the hydrodynamic fluxes and the corresponding right - hand side terms in eqs .",
    "[ 4 - 4 ] and [ 4 - 5 ] and integrate these equations numerically in the region @xmath363 , @xmath364 with the rectangular region @xmath365 , @xmath366 excised from simulations .",
    "@xmath367 the solutions for the magnetic flux function @xmath172 and azimuthal velocity @xmath362 are symmetric about the equatorial plane while solutions for the azimuthal component of the magnetic field @xmath312 are antisymmetric .",
    "all solutions go to zero at the symmetry axis @xmath368 we can find particular solutions of eqs . [ 5 - 2][5 - 4 ] by the method of variable separation in spherical coordinates . for @xmath369 , eq .",
    "[ 5 - 2 ] in spherical coordinates is @xmath370 for testing we choose the following solutions of eq .",
    "[ 5 - 2sph ] : @xmath371 where @xmath372 and @xmath373 are constants , @xmath374 is the spherical radius , and @xmath375 is the polar angle .",
    "the equations for the magnetic flux function and the @xmath16-components of the velocity and magnetic field are integrated numerically using our 2.5d code ( with the switched - off hydrodynamic fluxes and zero right hand side terms ) .",
    "we use the same grid geometry as in the main simulations ; that is , cylindrical coordinates with a non - equidistant grid in both directions .    for the test",
    ", we take a grid of @xmath376 , and also a finer grid with @xmath377 . we also take the inner and outer radii ( in the @xmath174direction ) of the simulation to be @xmath378 and @xmath379 . for these boundaries we set @xmath380 and @xmath362 to be equal to the analytical values determined by eqs .",
    "[ 5 - 5]-[5 - 7 ] .",
    "the initial conditions correspond to the exact solutions of eqs .",
    "[ 5 - 5]-[5 - 7 ] at @xmath286 .",
    "the constants @xmath372 and @xmath373 in these equations are chosen so that the solutions at the inner boundary are of the order of unity .",
    "we use @xmath381 , @xmath382 and integrate the equations up to @xmath383 .",
    ".the maximum absolute error in calculations of the @xmath384 and @xmath362 obtained in the diffusivity tests .",
    "[ cols=\"<,<,<,<,<\",options=\"header \" , ]     the top panels of fig .",
    "[ diff-50 - 100 ] show the result of the diffusivity test for the @xmath16-component of the magnetic field , the vector potential , and the @xmath16-component of the velocity .",
    "the solid lines show the numerical solution of eqs .",
    "[ 5 - 2]-[5 - 4 ] , which are obtained by integrating the equations using our code until @xmath385 .",
    "the dashed lines show the exact solutions given by eqs .",
    "[ 5 - 5]-[5 - 7 ] . evidently , the numerical and analytical solutions are nearly identical .",
    "the bottom panel shows the absolute errors @xmath386 for each function .",
    "one can see that the error is very small everywhere , taking into account the fact that the maximum value of all the functions , @xmath387 .",
    "the error increases towards the star because the value of the functions also strongly increases towards the star .",
    "we perform similar simulations and analysis for finer grid resolutions @xmath388 .",
    "table [ t : dif ] shows the maximum absolute errors , @xmath389 , @xmath390 , and @xmath391 .",
    "one can see that for the finer grid ( dimensions @xmath392 ) , this error is @xmath393 and @xmath394 times smaller compared to the coarsest grid ( dimensions @xmath395 ) .",
    "this confirms the convergence of the numerical solution towards the analytical solution .",
    "similar comparisons for the @xmath312 component give factors @xmath396 and @xmath397 , which also show convergence .",
    "similar comparisons for the @xmath362 component give factors @xmath396 and @xmath397 , which also show convergence .",
    "the codes discussed in this paper have already been used to study a variety of different astrophysical problems .",
    "below , we show a few examples of calculations with the code in both 2d and 3d geometries .      the hydrodynamic version of the code in 2.5d cylindrical coordinates was used to study counter - rotating accretion disks @xcite .",
    "the simulations show that the interaction between two counter - rotating regions of the disk strongly depends on the value of the viscosity coefficient @xmath5 which varies from @xmath398 up to @xmath399 .",
    "the simulations show that in counter - rotating disks , the accretion rate may be increased by a factor of @xmath400 .",
    "the problem is set up such that the inner region of the disk orbits the star in one direction while the outer part orbits in the opposing direction ( see fig .",
    "[ counter - blob ] , top panels ) .",
    "the simulations were performed for a viscosity parameter of @xmath401 .",
    "initially , the boundary between the counter - rotating regions of the disk is sharp . when the simulations start , the oppositely directed regions of the disk start interacting due to viscosity , leading to annihilation of the angular momentum at the interface .",
    "this matter , which has lost some of its centrifugal support , begins to accrete rapidly due to the unbalanced gravitational force .",
    "this leads to a hundred - fold increase of the accretion rate compared with a disk which does not have a counter - rotating component .",
    "the simulations also show that the @xmath209 component of the stress tensor , @xmath402 , dominates the angular momentum transport in the disk .",
    "we also study the case where a clump of counter - rotating matter is allowed to interact with the top of the disk ( see fig .",
    "[ counter - blob ] , bottom panels ) .",
    "we find that a part of the disk matter loses angular momentum through viscous interactions with the counter - rotating clump and is quickly accreted onto the star .",
    "analysis shows that in this case , three components of the viscosity tensor @xmath402 , @xmath403 and @xmath404 contribute to the angular momentum transport .          the code has also been utilized to study accretion onto a magnetized star from a turbulent accretion disk in 2.5d cylindrical coordinates @xcite .",
    "a sample of the results are shown in the right panel of figure [ 2d - mri-2 ] .",
    "the turbulence present in the disk is driven by the magneto - rotational ( mri ) instability ( e.g. , @xcite ) .",
    "simulations were performed for different magnetospheric radii @xmath405 and different initial values of the plasma parameter @xmath406 in the disk , which varied from @xmath407 to @xmath408 .",
    "the dynamical range of initial densities between the disk and corona was @xmath409 . inside the magnetosphere ,",
    "the dipole magnetic field varies as @xmath410 and the magnetic pressure varies as @xmath411 . in the regions of high magnetic pressure , the matter pressure and density become very low , thereby limiting the simulation timestep and slowing the calculation . to overcome this difficulty , we require : @xmath412 , where @xmath413 ; in other words , we require that the matter pressure does not fall below a certain fraction of the magnetic pressure . in the grid cells where the matter pressure becomes smaller than this value , it is adjusted to be @xmath414 .",
    "we then recalculate the density @xmath415 to be thermodynamically consistent . in cases of large magnetospheres , this leads to slightly enhanced matter density and pressure near the star .",
    "however , this does not change the physics of the magnetosphere because the magnetic pressure is still @xmath416 times higher than the matter pressure , and therefore the physics of the disk - magnetosphere interaction is described correctly in the sense that the magnetosphere is strongly magnetically - dominated . in other parts of simulation region , no floor density or pressure is added .",
    "the grid is compressed towards the disk midplane and towards the @xmath155axis with the goal of having higher grid resolution in the disk and near the star .",
    "the left panel of figure [ 2d - mri-2 ] shows a typical grid used in this study with @xmath417 cells in the radial direction and @xmath418 cells in the axial direction .",
    "the number of grid cells covering the disk in the vertical direction ( in the middle of the disk ) is about 200 , and the mri - unstable modes are well - resolved even in cases of a small - scale turbulence .    for this study ,",
    "the viscosity or diffusivity terms are not enabled .",
    "the disk matter is loaded onto the magnetic field lines of the magnetosphere due to reconnection or due to the small numerical diffusivity which is present in the code .",
    "another problem which has been studied using this code is that of disk accretion onto a magnetized star rotating in the propeller regime @xcite . in the propeller regime of accretion",
    ", the magnetosphere of the star rotates more rapidly than the inner disk ; the angular momentum imparted on the disk by the magnetosphere can push the disk away or drive outflows from the disk - magnetosphere boundary ( e.g. , @xcite ) . as in the previous study ( sec .",
    "[ sec : mri accretion ] ) , the angular momentum transport in the disk is mediated by the mri - driven turbulence .",
    "the large centrifugal barrier at the disk - magnetosphere boundary inhibits direct accretion onto the star .",
    "rather , the disk matter accumulates at the disk - magnetosphere boundary until it compresses the magnetosphere inward of the corotation radius and accretion can proceed .",
    "the result is a burst of accretion in which part of the matter accretes onto the star and part is launched as a short - lived magneto - centrifugal wind .",
    "there is also a secondary low - density wind which flows out along field lines anchored to the surface of the star . in the latter component of the winds ,",
    "the matter is launched rapidly , resulting in low density regions near the star .    in order to prevent the density ( and simulation timestep ) from becoming too small",
    ", we implement a floor density condition .",
    "that is , we fix the minimum density in the simulation region to be @xmath419 , effectively adding a small amount of matter whenever the density drops below a certain threshold .",
    "we track the amount of matter that is added , and find that it is much smaller than the matter flux in the disk and in the wind .",
    "we also implement the matter pressure floor condition for matter pressure inside the magnetosphere ( see sec .",
    "[ sec : mri accretion ] ) .    as a word of caution : for relatively large values of @xmath420 , the matter which is added to maintain the floor pressure can have a tendency to flow out of the super - keplerian magnetosphere due to centrifugal forces , thereby forming an artificial outflow .",
    "however , for low enough values of @xmath420 ( up to @xmath421 ) , no artificial outflows from the inner magnetosphere were observed .",
    "[ 2d - propeller ] shows matter flux and also energy and angular momentum carried by the matter and the magnetic field ( see details and description of fluxes in @xcite ) .",
    "the axisymmetric grid is in cylindrical ( @xmath15 , @xmath17 ) coordinates with mesh compression towards the disk and towards the @xmath17-axis such that there are a larger number of cells in the disk plane and near the star . in the models presented here",
    ", we use a non - uniform grid with dimension @xmath422 cells . corresponding to a grid that is 66 by 140 stellar radii in size . at @xmath423 ,",
    "the number of grid cells which cover the disk in the vertical direction is about 200 .    at the disk - magnetosphere boundary",
    ", 3d instabilities may cause the disk matter to penetrate through the magnetic field lines into the magnetosphere .",
    "since these instabilites are intrinsically three dimensional , they are not modeled in the current axisymmetric 2.5d simulations . to mimic these processes ,",
    "we implement diffusivity near the star using the diffusivity module described in sec .",
    "[ subsec : viscosity and diffusivity ] . to prevent modifications to the overall disk accretion rate , the diffusivity is only enabled near the disk - magnetosphere boundary .",
    "we study the disk - magnetosphere interaction in this region for different diffusivity parameters @xmath424 .",
    "we find that for larger values of @xmath425 , the disk matter penetrates through the magnetosphere more rapidly causing most of the accreting matter to be ejected into an outflow .",
    "a version of the code in 2d polar coordinates has been used to model the migration of a planet through a magnetized disk ( comins et al .",
    "2015 , in prep . ) . in a test version of this problem",
    ", we followed the approach by @xcite which used two different codes to solve this problem ( _ fargo _ and another code ) .",
    "our initial conditions are almost identical to those taken by @xcite : the planet s mass is 5 earth masses ; the disk has a constant surface density distribution ; the initial magnetic field has only an azimuthal component , @xmath312 , which scales with radius as @xmath426 where @xmath427 ; and",
    "lastly , the disk is locally - isothermal .",
    "we take @xmath428 for the adiabatic index to mimic a locally - isothermal disk .",
    "the size of simulation region is @xmath429 and @xmath430 , and the grid @xmath431 and @xmath432 .",
    "the grid is stretched in the radial direction such that the grid cells are almost rectangular in all parts of the simulation region .",
    "the magnetic resonances are resolved at 12 grid cells in the radial direction .",
    "our simulations confirm the results obtained by @xcite .",
    "namely , that if the plasma parameter @xmath406 is of order unity , then the magnetic resonances can be more important than the lindblad resonances ( which lead to inward migration ) and the migration can be stopped if the radial gradient of the azimuthal magnetic field is sufficiently large .",
    "[ magres ] shows the density distribution where the magnetic resonances are observed as azimuthally - stretched density depletions near the planet ( see left panel ) .",
    "the middle panel shows that in the region of magnetic resonances , the magnetic field is enhanced .",
    "the right panel shows a radial cut of the density and magnetic field along the planet s radial vector .",
    "we find that at @xmath433 the migration is inward ; in contrast , for steeper density profiles ( @xmath434 and @xmath435 ) the planet migrates outward .",
    "this is in accord with the results obtained by @xcite , who find that the inward migration consistently slows and reverses direction as @xmath436 increases .",
    "a version of the 3d code in cylindrical coordinates has been used to model the migration of a planet in a 3d hydrodynamic disk .",
    "the cylindrical simulation region extends between @xmath429 and @xmath430 and @xmath437 .",
    "the number of grid cells in each direction is @xmath438 , @xmath439 , and @xmath440 .",
    "the simulations show that the planet excites two waves in the disk at the lindblad resonances and migrates inward due to angular momentum transfer from the planet to the disk .",
    "the density perturbation is largest in the equatorial plane , and falls off away from the equatorial plane .",
    "[ 3d - planet ] shows an example of simulations which show typical waves in the disk .",
    "we have developed and tested a godunov - type code where the hlld solver of miyoshi and kusano @xcite is implemented . due to the nature of many of our astrophysical problems ( where strong shock waves are not expected ) ,",
    "we choose the adiabatic form of the energy equations .",
    "the codes pass standard tests and were used for solving different astrophysical problems .",
    "the simulations show that our entropy - conserving hlld solver performs satisfactorily in many astrophysical applications , such as studies of low - density , high - velocity outflows in propeller - driven winds .",
    "the ideal mhd module , viscosity module and diffusivity module were tested in different astrophysical situations .",
    "the authors thank the anonymous referee for valuable comments and constructive criticism and alisa blinova for help with this paper .",
    "resources supporting this work were provided by the nasa high - end computing ( hec ) program through the nasa advanced supercomputing ( nas ) division at the nasa ames research center and the nasa center for computational sciences ( nccs ) at goddard space flight center .",
    "the research was supported by nasa grant nnx12ai85 g and nsf grant ast-1211318 .",
    "avk was supported by the russian academic excellence project",
    " 5top100 \" .",
    "koren , b. ( 1993 ) ,  a robust upwind discretisation method for advection , diffusion and source terms \" , in vreugdenhil , c.b . ; koren , b. , _ numerical methods for advection  diffusion problems _ , braunschweig : vieweg , p. 117",
    ", isbn 3 - 528 - 07645 - 3"
  ],
  "abstract_text": [
    "<S> we describe a godunov - type magnetohydrodynamic ( mhd ) code based on the miyoshi & kusano ( 2005 ) solver which can be used to solve various astrophysical hydrodynamic and mhd problems . </S>",
    "<S> the energy equation is in the form of entropy conservation . </S>",
    "<S> the code has been implemented on several different coordinate systems : 2.5d axisymmetric cylindrical coordinates , 2d cartesian coordinates , 2d plane polar coordinates , and fully 3d cylindrical coordinates . </S>",
    "<S> viscosity and diffusivity are implemented in the code to control the accretion rate in the disk and the rate of penetration of the disk matter through the magnetic field lines . </S>",
    "<S> the code has been utilized for the numerical investigations of a number of different astrophysical problems , several examples of which are shown .    </S>",
    "<S> numerical methods , codes , magnetohydrodynamics </S>"
  ]
}