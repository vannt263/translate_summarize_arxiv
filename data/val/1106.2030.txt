{
  "article_text": [
    "let a billiard ball be shot from a corner of a rectangular billiard .",
    "consider the ball as a point , and truncate the orbit somewhere at the boundary .",
    "the truncated orbit of the ball generates a partition of the rectangular billiard into polygons , similar to figure [ billiard ] .",
    "many of these triangles and quadrangles seem to have the same shape and size . in this paper",
    "we will show that ( for a fixed shooting angle and stopping point ) the number of different areas is at most thirteen .",
    "this universal upper bound is the sharpest possible .",
    "we also consider rational shooting angles and irrational shooting angles for which the thirteen is never reached .",
    "[ billiard ]",
    "the results in this paper are closely related to the three gap theorem ( see e.g. @xcite , @xcite ) and the four gap theorem ( see @xcite ) .",
    "the statements of these two theorems are best illustrated by a picture ; see figure [ 3gt4gt ] .    [ cols= \" > , < \" , ]     now do the same starting from the other corners , traversing the square @xmath0 times with a line either with slope @xmath1 or @xmath2 .",
    "explicit expressions for these four sets ( one for each corner ) are given in lemma [ lemma_aexpressions ] .",
    "for an illustration , see the middle plot in figure [ construction ] .",
    "+ the key observation now is that intersection of all @xmath3 lines with @xmath4 ^ 2 $ ] gives exactly a truncated billiard orbit with slope @xmath1 , as is proved in lemma [ lemma_orbit ] .",
    "this fact is illustrated in the right plot in figure [ construction ] .",
    "obviously not all @xmath3 lines actually contribute to the billiard orbit .",
    "however , there is a good reason to consider them all : the intercepts of the @xmath5 lines with positive slope form a truncated orbit of a rotation on the interval @xmath6 $ ] , see lemma [ lemma_rotation ] . for the lines with negative slope a similar result holds . having collected these insights",
    ", a simple counting argument suffices to obtain the upper bounds claimed in theorem [ theorem_13areas ] : +   + * proof of theorem [ theorem_13areas ] * lemma [ lemma_orbit ] writes the billiard orbit as an intersection of the square @xmath4 ^ 2 $ ] with a set of lines .",
    "let us concentrate on the lines with positive slope .",
    "by lemma [ lemma_rotation ] the intercepts of these lines form a rotation orbit on the interval @xmath6 $ ] .",
    "so by property [ prop_rotation ] they induce a partition of this interval in subintervals of _ at most _ three different lengths .",
    "denote the set of these lengths by @xmath7 , where @xmath8 .",
    "for the lines with negative slope , the intercepts are the numbers @xmath9 , @xmath10 .",
    "they induce a partition of @xmath11 $ ] in subintervals having lengths in the same set @xmath12 .",
    "it now follows that vertical distances between adjacent parallel lines are in the set @xmath12 .",
    "we will distinguish between three types of polygons : those that have no side which is part of the boundary of @xmath4 ^ 2 $ ] ( type @xmath13 ) , those that have exactly one such a side ( type @xmath14 ) and those that have two or more ( type @xmath15 ) .",
    "+ the polygons of type @xmath13 must be parallelograms .",
    "the area of such a parallelogram is given by @xmath16 for some @xmath17 , and consequently they can have at most six different areas . +",
    "a polygon of type @xmath14 that is triangular must be half of a rhombus of which the vertical diagonal has length @xmath18 , and therefore its area is @xmath19 .",
    "there is at most one non - triangular type @xmath14 polygon , as is explained in figure [ pic_extreme ] .",
    "so polygons of type @xmath14 can have at most four different areas .",
    "+ polygons of type @xmath15 must be in one of the corners of @xmath4 ^ 2 $ ] , but not in @xmath20 since the orbit starts there .",
    "so this gives at most three more areas .",
    "+ putting everything together , it turns out that the number of different areas is bounded by thirteen .",
    "+ for the number of shapes a similar counting argument holds .",
    "the number of parallelogram shapes is again six , since reflections do not count .",
    "the triangles that are half of a rhombus can have at most six different shapes , since there are three types of rhombi which can be cut either horizontally or vertically .",
    "the rest of the argument does nt change , so there are at most three more different shapes than different areas , which establishes the upper bound of at most sixteen different shapes .",
    "+ the sharpness of these bounds follows from example [ ex_13flakes ] in section [ example ] .",
    "@xmath21    [ remark]as the careful reader may have noted , the construction of the billiard orbit always gives a truncation on the left boundary or on the lower boundary of the square .",
    "so strictly speaking , theorem [ theorem_13areas ] is not proved in full generality yet .",
    "suppose we have an orbit truncated at the upper or right boundary . by removing the last linear part or adding the next linear part",
    ", we can transform this orbit into an orbit truncated at the left or lower boundary .",
    "this means that in the proof above , the rotation orbit on the interval @xmath6 $ ] contains one element more or one less than the rotation orbit on @xmath11 $ ] .",
    "now property [ prop_strong ] tells us that vertical distances between adjacent parallel lines can still have at most three different values , completing the proof .",
    "theorem [ theorem_13areas ] gives an upper bound for the number of different areas of shapes on the billiard table .",
    "some natural questions remain . for example , what happens if @xmath1 is rational ?",
    "can we prove sharper upper bounds under suitable conditions ?",
    "in this section we explore these properties .",
    "+ obviously , taking @xmath1 rational gives a special case .",
    "the first thing to note is that the orbit will be periodic : if @xmath22 , then for @xmath23 @xmath24 a bit less trivial is the following result .",
    "the best upper bound for @xmath25}^\\alpha$ ] with @xmath26 is @xmath27 , but for all @xmath26 there is an @xmath28 such that @xmath29}^\\alpha \\leq 3 $ ] for @xmath30 .",
    "these bounds are sharp .",
    "* proof * note that the areas of the polygons continuously depend on @xmath1 .",
    "so if we have an @xmath31 and @xmath32 such that @xmath25}^{\\tilde\\alpha } = 13 $ ] , then we can find @xmath33 such that the upper bound of thirteen is reached for all @xmath34 .",
    "since this interval contains rationals , we see that rationality is not sufficient for a sharper upper bound .",
    "+ since the orbit is periodic , the partition does nt change anymore if @xmath32 is large enough .",
    "taking @xmath35 shows that @xmath13 is a sharp lower bound for the limiting number of shapes .",
    "for the upper bound , suppose that @xmath22 .",
    "by lemma [ lemma_rotation ] the intercepts satisfy @xmath36 it follows that the numbers @xmath37 form a periodic rotation orbit on @xmath6 $ ] and therefore the set @xmath12 as defined in the proof of theorem [ theorem_13areas ] contains only one length if @xmath32 is large enough .",
    "if @xmath38 and @xmath39 are relative prime , then this length is @xmath40 . now",
    "a type @xmath13 polygon is a rhombus with area @xmath41 . since there is no endpoint of the orbit anymore , a type @xmath14 polygon is half of such a rhombus .",
    "polygons in the corners are also triangular , because the orbit touches all sides of the square before becoming periodic . these triangles are quarters of the rhombus , thus having area @xmath42 .",
    "this makes at most three different areas in total . to see that this upper bound is sharp ,",
    "see figure [ pic_rational].@xmath21    surprisingly , there exist irrational @xmath1 for which the upper bound of thirteen different areas is never reached :    let @xmath43 denote the small golden mean .",
    "if @xmath44 for some @xmath45 , then @xmath25}^\\alpha\\leq 12 $ ] .    * proof * consider the numbers @xmath37 that form a rotation orbit on @xmath6 $ ] .",
    "the partition of @xmath6 $ ] induced by this orbit gives subintervals with lengths in a set @xmath12 .",
    "this set @xmath12 changes if we extend the orbit ( i.e. we increase @xmath32 ) : some lengths will disappear and new lengths will be created . in @xcite and @xcite",
    "it was shown that the largest length is always the first to disappear .",
    "a new length only pops up if there are only two lengths in @xmath12 , and the new length is the difference of these two existing lengths .",
    "together with the fact that @xmath46 , this is the basis of our argument .",
    "+ let @xmath47 .",
    "from the way points are added to the rotation orbit it is clear that we can choose @xmath32 such that @xmath6 $ ] will be partitioned in @xmath48 intervals of length @xmath1 and an interval of length @xmath49 .",
    "this gives @xmath50 .",
    "extending the orbit with one more point transforms @xmath12 into @xmath51 and this is the first time that @xmath12 contains three lengths .",
    "increasing @xmath32 further , @xmath12 will change into @xmath52 and then into @xmath53 .",
    "an inductive argument suffices to show that the ratios between the lengths in @xmath12 are preserved . +",
    "recall that the areas of the parallelograms are determined by a product of two lengths in @xmath12 . by the above reasoning , if @xmath54 , then @xmath55 , which implies that the parallelograms can have at most five different areas .",
    "consequently @xmath25}^\\alpha\\leq 12 $ ] .",
    "let @xmath56 be an irrational number and consider the halfline @xmath57 .",
    "let @xmath58 and define @xmath59 to be the squares of the form @xmath60 , with @xmath61 and @xmath62 integers , that are consecutively traversed by the halfline , see figure [ squares ] .",
    "choosing an index @xmath0 , there exists @xmath63 such that @xmath64    taking fractional parts in both coordinates can be seen as mapping each of the squares @xmath65 to @xmath66 .",
    "therefore , doing this for the above set gives @xmath67 for numbers @xmath37 defined by the recursion @xmath68    we will denote the set in ( [ a++ ] ) by @xmath69 .",
    "the @xmath70 superscript reflects the fact that we started with a halfline in the first quadrant , so both coordinates are positive .",
    "doing similar operations to halflines in the second , third and fourth quadrant , we can define sets @xmath71 , @xmath72 and @xmath73 respectively as follows : @xmath74    taking the union of these four sets and intersecting with @xmath4 $ ] gives us a billiard orbit , as is proved in the lemma below .",
    "[ lemma_orbitopen ] the billiard orbit @xmath75 satisfies @xmath76 ^ 2.\\ ] ]    * proof * observe that @xmath77 ^ 2\\cap\\bigcup_{a\\in\\left\\{\\left\\{x\\right\\},1-\\left\\{x\\right\\}\\right\\ } } \\bigcup_{b\\in\\left\\{\\left\\{\\alpha x\\right\\},1-\\left\\{\\alpha x\\right\\}\\right\\ } } ( a , b),\\end{aligned}\\ ] ] and now take the union over all @xmath78.@xmath21 +   + in the next lemma expressions similar to ( [ a++ ] ) are derived for @xmath71 , @xmath72 and @xmath73 .",
    "[ lemma_aexpressions ] let @xmath79 for @xmath80 .",
    "then @xmath81\\times[0,1 ) \\cap \\bigcup_{k=1}^n \\left\\{(x,-\\alpha x+1-y_{-k}):x\\in\\mathbb{r}\\right\\},\\\\ a^{-- } & = & ( 0,1]^2 \\cap \\bigcup_{k=1}^n \\left\\{(x,\\alpha x + y_{-k}):x\\in\\mathbb{r}\\right\\ } , \\\\ a^{+- } & = & [ 0,1)\\times(0,1 ] \\cap \\bigcup_{k=1}^n \\left\\{(x,-\\alpha x+1-y_k):x\\in\\mathbb{r}\\right\\},\\end{aligned}\\ ] ]    * proof * define the functions @xmath82 by @xmath83 , @xmath84 and @xmath85 . applying these functions to the left hand side of ( [ a++ ] ) , we get @xmath86 , @xmath87 and @xmath88 . on the other hand",
    ", @xmath89 whence application of @xmath90 to the right hand side of ( [ a++ ] ) leads to @xmath91\\times[0,1)\\cap \\bigcup_{k=1}^n f\\bigl(\\left\\{(x,\\alpha x + y_k):x\\in\\mathbb{r}\\right\\}\\bigr)\\\\ & = & ( 0,1]\\times[0,1)\\cap \\bigcup_{k=1}^n \\left\\{(x,-\\alpha x + 1-y_{-k}):x\\in\\mathbb{r}\\right\\},\\end{aligned}\\ ] ] so for @xmath71 we established the equality claimed in the lemma .",
    "the other two equalities for @xmath72 and @xmath73 follow from a similar reasoning since @xmath92 and @xmath93 @xmath21    the numbers @xmath37 and @xmath94 satisfy a nice relation , as is shown in the following lemma .",
    "[ lemma_rotation ] let @xmath95 .",
    "then the numbers @xmath96 form a rotation orbit on the interval @xmath6 $ ] .",
    "they are given by @xmath97    * proof * the recursion ( [ recursion ] ) can be rewritten as @xmath98 and therefore @xmath99 letting @xmath100 and @xmath101 , this reduces to @xmath102 since @xmath103 , we have @xmath104 , which leads to @xmath105 on the other hand , for @xmath106 , @xmath107 since @xmath31 is irrational . by definition",
    "we have @xmath108 , and hence @xmath109 solving for @xmath37 gives the result .",
    "@xmath21 +   + in lemma [ lemma_orbitopen ] we already derived an expression for @xmath75 , but this is not so easy to analyze directly .",
    "in the next lemma we describe @xmath110}^\\alpha$ ] as the union of two collections of lines intersected with @xmath4 ^ 2 $ ] .",
    "all lines in the first collection have slope @xmath1 and all lines in the second collection have slope @xmath2 .    [ lemma_orbit ]",
    "let @xmath111 and @xmath112 .",
    "then @xmath113}^\\alpha = [ 0,\\frac{1}{2}]^2\\cap \\bigcup_{u\\in\\left\\{+,-\\right\\}}\\bigcup_{k =- n}^n \\left\\{(x , l_k^u(x):x\\in\\mathbb{r})\\right\\}\\ ] ]    * proof * this lemma will be proved by taking closures in the equation in lemma [ lemma_orbitopen ] .",
    "@xmath114}^\\alpha,\\ ] ] since @xmath115 is a continuous function from @xmath116 to @xmath117 . on the other hand ,",
    "@xmath118 ^ 2\\cap\\bigcup_{u , v\\in\\left\\{+,-\\right\\}}a^{uv } } = [ 0,\\frac{1}{2}]^2\\cap\\bigcup_{u , v\\in\\left\\{+,-\\right\\}}\\overline{a^{uv}},\\ ] ] and since @xmath119 is a finite collection of lines intersected by a ` half open ' unit square its closure is the same collection of lines but now intersected by the closed square @xmath120 ^ 2 $ ]",
    ". therefore , @xmath121 ^ 2\\cap\\bigcup_{\\begin{array}{l } k =- n\\\\k\\neq 0\\end{array}}^n\\left\\{(x , l_k^+(x)):x\\in\\mathbb{r}\\right\\}\\ ] ] now note that since @xmath122 we have @xmath123 ^ 2\\cap\\left\\{(x , l_0^+(x)):x\\in\\mathbb{r}\\right\\ } = \\emptyset.\\ ] ] intersecting both sides of ( [ + +  ] ) with @xmath4 ^ 2 $ ] gives @xmath123 ^ 2\\cap\\overline{a^{++}}\\cup\\overline{a^{-- } } = [ 0,\\frac{1}{2}]^2\\cap\\bigcup_{k =- n}^n\\left\\{(x , l_k^+(x)):x\\in\\mathbb{r}\\right\\}\\ ] ] analogously it follows that @xmath123 ^ 2\\cap\\overline{a^{+-}}\\cup\\overline{a^{-+ } } = [ 0,\\frac{1}{2}]^2\\cap\\bigcup_{k =- n}^n\\left\\{(x , l_k^-(x)):x\\in\\mathbb{r}\\right\\}\\ ] ] combination of the last two equations gives the result .",
    "in this section we present an example in which the upper bounds of theorem [ theorem_13areas ] are reached .",
    "this proves sharpness of the bounds .    [ ex_13flakes ]",
    "let @xmath124 and choose @xmath125 .",
    "the corresponding orbit is shown in figure [ pic_13flakes ] .",
    "use lemma [ lemma_rotation ] to find the numbers @xmath37 and let @xmath126 denote the three different vertical distances between adjacent parallel lines .",
    "the areas of the shapes are of the following form : @xmath127 calculating these thirteen areas indeed gives thirteen different values , where a precision of two decimals suffices .",
    "the flakes @xmath128 , @xmath129 and @xmath130 have the same areas as @xmath131 , @xmath132 and @xmath133 respectively , so the maximal number of sixteen different shapes is also reached .",
    "we checked the calculations by using the outcomes to determine the area of @xmath4 ^ 2 $ ] .",
    "the author thanks michel dekking and cor kraaikamp for their useful comments ."
  ],
  "abstract_text": [
    "<S> we study the geometry of billiard orbits on rectangular billiards . </S>",
    "<S> a truncated billiard orbit induces a partition of the rectangle into polygons . </S>",
    "<S> we prove that thirteen is a sharp upper bound for the number of different areas of these polygons .    </S>",
    "<S> billiard orbit , geometry of partitions 11b75 </S>"
  ]
}