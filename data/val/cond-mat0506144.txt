{
  "article_text": [
    "the calculation of the electromagnetic properties of thin superconducting films of finite size as used , e.g. , in superconducting quantum interference devices ( squids ) @xcite is a complicated problem since these sensitively depend on the shape and size of the film .",
    "this is so since the currents in thin films are not screened as in bulk superconductors , but interact via the magnetic stray field they generate outside the film .",
    "in particular , the self energy of a magnetic vortex in thin films ( called pearl vortex @xcite ) and the interaction between two such vortices depend on their position in the film even for very large films .",
    "this means a vortex is never `` far from the film edges '' , in contrast to the behavior of vortices in the bulk , whose energy , current density , and magnetic field become independent of the vortex position and of the specimen shape when the distance from the surface is much larger than the london penetration depth @xmath1 .",
    "this is so since in the bulk the factor @xmath2 in the fourier transforms ( with wave vector components @xmath3 ,",
    "@xmath4 , @xmath5 , @xmath6 ) causes the fields and currents to decay exponentially over the length @xmath1 at large distances from the vortex core . in thin films of thickness",
    "@xmath7 the effective magnetic penetration depth @xmath8 is larger than @xmath1 and the fourier transforms contain a factor @xmath9 that describes also the long - range non - exponential interaction of vortices via the magnetic stray field outside the film .",
    "but even films in the ideal meissner state containing no vortices present a difficult problem .",
    "properties of macroscopic circular disks and rings in a perpendicular applied magnetic field were calculated recently for ideal screening ( @xmath10 ) @xcite and for arbitrary @xmath1 .",
    "@xcite when this ring has a radial slit , e.g. in a washer - shaped squid , the circular symmetry is lost , but some properties like the sheet current and the concentration of magnetic flux into the central hole ( flux focussing ) can still be calculated approximately from this circular symmetric model by forcing the current in the ring to be zero .",
    "@xcite ( this situation may be achieved by appropriate magnetic history . ) below we shall compare this approximation with the exact two - dimensional ( 2d ) solution for a slitted ring and find partial agreement ( sec .",
    "iii ) .    while the slitted ring or slitted square film with an applied magnetic field @xmath11 and/or transport current @xmath12 are simply connected geometries ( fig .  1",
    ", right two plots ) , a closed ring or a slitted film with the entrance of the slit short - cut by superconducting contacts ( e.g. by weak links ) present multiply connected geometries ( fig .  1",
    ", left two plots ) .",
    "these are more difficult to calculate since the ( quantized ) magnetic flux @xmath13 ( or fluxoid @xmath14 when @xmath15 ) trapped in this hole , and the current @xmath16 circulating around the hole , are additional parameters , besides @xmath11 and @xmath12 . in films with @xmath17 holes or slots that are fully surrounded by superconducting material , there are @xmath17 such fluxoids @xmath18 and currents @xmath19 that depend on the magnetic history and that may be used to define @xmath17 self - inductances @xmath20 and @xmath21 mutual inductances @xmath22 .",
    "this paper shows how all these ( actually 3d ) thin - film problems can be solved numerically by a 2d matrix inversion method allowing for non - equidistant grid points .",
    "the presented general equations and concrete examples generalize previous methods that either work only for equidistant spatial grids @xcite ( which are not very accurate near the film edges or near a narrow slit or small hole ) , or for general grid did not account for finite penetration depth @xmath23 , @xcite or assumed simply connected geometry , @xcite or applied only to circular disks or rings .",
    "@xcite in this paper i consider the electrodynamics of finite - sized macroscopic films that can be described by london theory , which applies when the magnetic field is much smaller than the upper critical field @xmath24 and the superconductor is much larger than the coherence length @xmath25 .",
    "the application to squids will be dealt with elsewhere .",
    "@xcite in the present paper i shall thus not need the notions of fluxoid quantization , phase of the superconducting order parameter , vector potential , and voltages caused by the josephson effect , but some quantities computed here will be needed in the theory of squids , e.g. , self - inductance and effective area .",
    "our 2d matrix inversion method can be quite accurate even when the number of grid points is not very large .",
    "for example , in the ideal meissner state with @xmath26 , the computed current density exactly yields @xmath27 inside the film ( @xmath28 is the film plane ) . for @xmath29 ,",
    "accurate results are obtained even when @xmath0 is smaller than the spacing of our rectangular grid . for similar calculations using a finite - element method and a different integral kernel ( or matrix )",
    "see ref .  .",
    "analytical @xcite and numerical @xcite london calculations were performed in the limit of large @xmath0 , i.e. , for small disks with radius @xmath30 .",
    "( here i shall not list numerous recent work on mesoscopically small superconductors with vortices computed from ginzburg - landau theory . )",
    "an elegant and fast method that computes the currents in films from the magnetic field pattern measured at the film surface with high resolution , without having to store or explicitly invert a large matrix , is described by wijngaarden et al . ;",
    "@xcite this method has all advantages of the direct matrix inversion method and avoids the inversion by fourier transform , that would require knowledge of the magnetic field pattern also outside the film area . the static bean model for thin films of any shape",
    "is computed by prigozhin using a variational method .",
    "this section describes how for thin flat superconducting films of any shape , also multiply connected as needed for squids , one can calculate the static and dynamic response to an applied magnetic field , applied electric current , and to vortices moving in the film .",
    "in such problems the central physical quantity is the thickness - integrated current density , called sheet current @xmath31 . for films with constant thickness @xmath32 and nearly @xmath33-independent current density",
    "@xmath34 one approximately has @xmath35 , but the following equations are more general , applying also to films with spatially varying thickness @xmath36 if the typical length of this variation is @xmath37 .",
    "since one has @xmath38 in the film except at small contacts , one can express @xmath39 in terms of a scalar potential or stream function @xmath40 as @xmath41 .",
    "the function @xmath40 has several useful properties and interpretations :    1 .",
    "@xmath40 is the local magnetization or density of tiny current loops .    2 .",
    "the contour lines of @xmath40 are the current stream lines .",
    "typical @xmath40 look like a mountain ( fig .  2 ) .",
    "3 .   on the boundary of the film",
    "one may put @xmath42 since the boundary coincides with a stream line .",
    "the integral of @xmath40 over the film area equals the magnetic moment of the film if @xmath43 on its edge .",
    "the difference @xmath44 is the current that crosses any line connecting the two points @xmath45 and @xmath46 .",
    "if the film contains an isolated hole or slot such that magnetic flux can be trapped in it or a current @xmath16 can circulate around it , then in this hole one has @xmath47 if @xmath42 is chosen outside the film .",
    "7 .  in a multiply connected film with @xmath17 holes , @xmath17 independent constants @xmath48",
    "@xmath49 @xmath50 can be chosen for the values of @xmath40 in each of these holes .",
    "the current flowing between hole 1 and hole 2 is then @xmath51 .",
    "a vortex with flux @xmath52 in the film moves in the potential @xmath53 , since the lorentz force on a vortex is @xmath54 .",
    "9 .  a vortex moving from the edge of the film into a hole connected to the outside by a slit , at each position @xmath55 couples a fluxoid @xmath56 into this hole , where @xmath40 is the solution that has @xmath57 in this hole ( with closed slit , see point 6 ) and @xmath43 outside the film",
    ".    10 .  when the film has @xmath17 holes , a vortex in the film at @xmath55 couples a fluxoid @xmath58 into the @xmath59th hole ( if this is connected to the edge by a slit ) , where @xmath60 is the solution exhibiting @xmath61 in this hole and @xmath62 in all other ( isolated ) holes and on the film edge .      from ampre s",
    "local 3d law @xmath63 one obtains for a current - carrying film in the plane @xmath28 a nonlocal 2d relation between the perpendicular magnetic field @xmath64 and the stream function @xmath40 : @xmath65 here @xmath66 , @xmath67 is the @xmath33 component of the applied magnetic field , and @xmath68 is the area of the film . the integral kernel @xmath69 has the meaning of the magnetic field ( along @xmath33 ) caused at point @xmath70 in the plane of the film by a magnetic dipole ( or tiny current loop ) of unit strength positioned at @xmath71 and directed along @xmath33 . from the known dipole field in any plane @xmath72 const , one obtains formally : @xmath73 note that this kernel depends only on the distance @xmath74 . for @xmath75 one",
    "has @xmath76 , but the integral of @xmath77 over the infinite plane vanishes , i.e. , the total magnetic flux of a dipole is zero in any plane @xmath72 const , also for @xmath78 , thus @xmath79 is _ highly singular _ at @xmath80 .",
    "for explicit calculations one has to decide how to deal with this singularity of @xmath81 .    for numerics",
    ", one has to write the integral as a sum . defining a 2d grid",
    "whose @xmath82 points @xmath83 fill the film area @xmath68 , one may approximate any integral over @xmath68 by a sum , @xmath84 where the @xmath85 are weights , e.g. , @xmath86 for equidistant grids that avoid the film edges , see appendix a. the accuracy of this numerical integration can be strongly increased by choosing an appropriate non - equidistant grid , e.g. , a grid that is denser near the boundary of @xmath68 or near possible poles or jumps of the integrand @xmath87 .",
    "equation ( 1 ) now becomes @xmath88 with the matrix @xmath89 .",
    "equation ( 4 ) is formally solved by matrix inversion , i.e. , by writing @xmath90 \\,,\\ ] ] where @xmath91 is the inverse matrix @xmath92 defined by the equation @xmath93 with @xmath94 for @xmath95 and @xmath96 for @xmath97 .",
    "note that , in contrast to @xmath98 , the inverse matrix @xmath91 depends on the shape of the film and not only on the difference @xmath99 . for the film shapes we have tested , all the matrix elements @xmath91",
    "are found to be negative , with a sharp negative peak at @xmath95 , and tending to zero when @xmath83 or @xmath100 approaches the film edge , see fig .  3 for an example . in principle ,",
    "the inverse kernel @xmath101 , integrated over @xmath102 and @xmath103 ( the strip width ) was introduced @xcite and depicted @xcite earlier in the context of the magnetostatic energy of a tilted and curved narrow superconducting strip with pinned vortices . then , and later,@xcite @xmath101 was calculated by iterating an integral equation .",
    "a useful expression for the matrix @xmath98 was obtained in terms of a fourier series in ref .  , but this method works only for equidistant grids , while for non - equidistant grids the matrix inversion is singular .",
    "this numerical form of @xmath98 is thus not very accurate when one is interested in the sharply peaked @xmath39 and @xmath104 near the film edges , or when the film exhibits fine structures , e.g. , a small hole or narrow slit , since the maximum number of grid points on present personal computers is limited to about @xmath105 , yielding a very large @xmath106 matrix @xmath98 .",
    "a matrix @xmath98 that works well for any grid @xmath83 , also with non - constant weights @xmath85 , is obtained as follows . from eq .",
    "( 2 ) one has for @xmath107 : @xmath108 the diagonal terms @xmath109 are obtained from the condition that the integral of @xmath79 taken over the infinite area has to vanish . splitting this integral into the integral over the film area @xmath68 plus the integral over the infinite area @xmath110 outside @xmath68 , and writing the first integral as a sum",
    ", we get : @xmath111 defining a 2d function @xmath112 as an integral over the film area or as a contour integral over the film edge , @xmath113 with @xmath114 ( @xmath115 is the angle between the vector @xmath116 pointing to the point @xmath71 on the film edge and any fixed direction , say , the @xmath117 axis ) , and writing @xmath118 , @xmath119 , we get from ( 8) the diagonal term @xmath120 .",
    "the full matrix reads thus : @xmath121 note that the terms in ( 10 ) should not be rearranged since @xmath122 .",
    "the matrix ( 10 ) is well behaved during inversion , so one may write @xmath123^{-1 } .\\ ] ]    for a rectangular film filling the area @xmath124 , @xmath125 one has explicitly from eq .",
    "( 9):@xcite @xmath126 ^{1/2}\\ ] ] with @xmath127 .",
    "interestingly , expression ( 12 ) may be used also for films that have a hole or slit , or several holes , or that do not fill the rectangle completely , e.g. , a circular disk with radius @xmath128 . in such cases",
    "one has to omit in eq .",
    "( 4 ) and ( 5 ) the grid points that fall outside the film ( but keep the points in isolated holes , see sct .",
    "ii e ) . therefore , eq",
    ".  ( 5 ) with the explicit kernel @xmath91 from eq .  ( 11 ) and @xmath129 from eq .  ( 12 ) , allows one to compute the stream function @xmath40 and thus the sheet current for thin films of arbitrary shape when one knows the magnetic field @xmath130 generated inside the film by this current .",
    "information on @xmath104 outside the film is _ not _ required for this stable inversion method .      in superconductor films with thickness @xmath7 , the london penetration depth",
    ", the 3d static london equation @xmath131 may be integrated over the film thickness @xmath32 to yield the 2d equation @xmath132     \\ , { \\bf\\hat z } = \\lambda \\nabla^2 g(x , y ) \\,,\\ ] ] where @xmath133 is the effective london depth of the film .",
    "eliminating @xmath134 from eqs .",
    "( 1 ) and ( 13 ) one obtains an implicit equation for @xmath40 : @xmath135          g({\\bf r } ' )     \\end{aligned}\\ ] ] or with the discretized eq .",
    "( 4 ) , @xmath136 in it the matrix @xmath137 computes the laplacean @xmath138 at @xmath139 of a function defined on a grid , e.g. , from the values @xmath140 at @xmath141 and its four nearest neighbors . equation ( 15 ) is solved for @xmath40 by matrix inversion : @xmath142 with the inverse matrix @xmath143 now depending on @xmath0 .",
    "this matrix inversion is the more stable the larger is @xmath0 , since finite @xmath0 increases the diagonal terms and makes the resulting @xmath144 a smoother function as compared to the case @xmath26 considered in eq .",
    "examples for @xmath134 are shown in fig .  4 for a square with slit and hole , while fig .",
    "5 shows some profiles @xmath145 along the @xmath102-axis for the same square .",
    "note that even small @xmath146 allows @xmath104 to partly penetrate the entire film .",
    "the time dependent behavior of superconducting films containing vortices may be described within continuum theory by the following realistic relation between the local electric field @xmath147 and the sheet current @xmath39 and magnetic induction @xmath148 : @xcite @xmath149 here @xmath150 is the sheet resistivity caused by moving vortices , and the second term with @xmath151 and @xmath152 is the london term describing acceleration of cooper pairs . the isotropic model ( 18 )",
    "assumes that the resistivity @xmath153 depends only on the magnitudes @xmath154 and @xmath155 .",
    "for example , without vortex pinning and hall effect , one has free flux flow with @xmath156 , where @xmath157 is the resistivity in the normal conducting state and @xmath158 is the upper critical field .",
    "for thermally activated depinning a realistic model is @xmath159 with creep exponent @xmath160 and an in general @xmath155 dependent critical sheet current @xmath161 . for a generalization to anisotropic superconductors",
    "see ref .  .",
    "from the induction law @xmath162 , which in the film plane reduces to @xmath163 , and from @xmath164 , one obtains @xmath165   + \\mu_0 \\lambda \\nabla^2 \\dot g$ ] . inserting this into the time derivative of eq .",
    "( 1 ) one finds an equation for @xmath166 : @xmath167     \\dot g({\\bf r}',t )                      \\nonumber \\\\[-1 mm ]    = f({\\bf r},t ) -\\dot h_a({\\bf r},t ) \\",
    ", ,   \\nonumber \\\\ [ 2 mm ]     f({\\bf r},t ) =   \\mu_0^{-1 } \\nabla       \\big[\\ , \\rho_s({\\bf r},t ) \\nabla",
    "g({\\bf r},t ) \\,\\big ] \\ , .",
    "\\end{aligned}\\ ] ] in discretized form this becomes [ cf .",
    "( 15 ) ] : @xmath168 inverting this one obtains the equation of motion for @xmath169 in explicit form : @xmath170\\ ] ] with @xmath144 from eq .",
    "( 17 ) . in the meissner state or for rigidly pinned vortices",
    "one has @xmath171 and these dynamic equations reduce to the static equations of sct .",
    "ii c.      multiply connected films have one or more holes or slots that are completely surrounded by superconducting material and thus can trap magnetic flux . as a fundamental example",
    "i consider here a film containing one such hole with flux trapped such that a current @xmath16 circulates around the hole when no magnetic field is applied , @xmath172 . in this case one",
    "has @xmath42 outside the film and @xmath57 in the hole , and inside the film @xmath40 smoothly goes from 0 to @xmath16 .",
    "generalization of this example to the presence of more holes and to @xmath173 is possible by linear superposition .",
    "current stream lines in a thin film square with square hole and radial slit , and in a circular disk with circular hole and slit , in the ideal meissner state @xmath26 .",
    "top left : slit bridged at the edge , circulating current @xmath184 flows due to flux trapped in the hole and slit , no applied field @xmath172 .",
    "top right and bottom right : slit open , applied field @xmath185 , magnetic flux enters the slit and is focussed into the hole where @xmath186 .",
    "bottom left : closed slit , applied field @xmath187 , some current @xmath188 flows such that the flux in hole and slit is exactly zero ( ideal screening ) ; this state is a superposition of the two upper states .",
    "note that the current near the hole circulates in opposite direction , except in the trapped - flux case . ]",
    "the three examples of fig .  1 for the stream function @xmath40 in a square film ( size @xmath189 in units of half width @xmath190 ) with square hole ( half width @xmath191 ) and open slit ( width 0.04 a ) , for @xmath192 grid points , as fig .  3 .",
    "for penetration depth @xmath179 ( ideal screening ) . at the film edges @xmath40 goes to zero with vertical slope , and outside the film @xmath43 ( for @xmath23 ,",
    "the slope of @xmath193 at the edges is finite , equal to the sheet current ) .",
    "top : constant applied field @xmath194 , open slit meaning a current @xmath195 , thus @xmath43 in slit and hole ( like fig .",
    "1 top right ) .",
    "middle : @xmath172 , current @xmath196 flowing around the hole and closed slit due to trapped flux , yielding @xmath197 in hole and slit ( like fig .  1",
    "top left ) .",
    "bottom : top and middle cases superimposed such that the flux trapped in the hole and slit is zero ( like fig .  1 bottom left ) : weights 1 and 1.2 , thus in slit and hole @xmath198 . ]     example for the inverse matrix @xmath199 in a square film ( half width @xmath190 ) with square hole ( half width @xmath200 ) and open slit ( width @xmath201 ) , similar to the squares in figs .",
    "1 and fig .  2 . for @xmath202 grid points @xmath83 and constant @xmath203 , penetration depth @xmath204 . at the film edges and in hole and slit one has @xmath205 .",
    "the plotted @xmath144 is approximately symmetric in @xmath206 since here the weights @xmath207 const .",
    "it also shows the interaction between a vortex at @xmath55 and a vortex pair ( due to the imposed symmetry ) sitting at @xmath208 , cf .",
    "its contours are the current stream lines of this vortex pair . for @xmath10 , @xmath209 looks similar , but the peak is higher and the slopes at the edges are vertical . ]",
    "the magnetic field @xmath134 in the plane of a thin square with hole and slit , @xmath210 , @xmath195 ( case of flux focussing , see fig .",
    "1 top right and fig .  2 top ) for ideal screening @xmath26 ( top ) and for @xmath211 ( bottom ) ( @xmath212 grid points , only half the square is shown ) .",
    "note that even such small @xmath0 strongly changes @xmath134 inside the superconductor , which penetrates much farther than @xmath0 .",
    "the corresponding profiles @xmath145 are show in fig .  5 .",
    "]     the profiles of the magnetic field @xmath145 in the thin square of fig .",
    "1 ( top right ) taken along the @xmath213 axis that passes through the hole and slit , in units of the applied field @xmath11 and shown for several values of the 2d magnetic penetration depth @xmath214 , 0.01 , 0.03 , 0.1 , 0.3 , and 1 in units of the half width @xmath190 of the square .",
    "same case as in fig .  4 but with more grid points ( @xmath215 ) .",
    "note that in the center of the square hole the magnetic field is enhanced by a factor of 3 when @xmath26 , @xmath216 ( flux focussing ) ; in the narrow slit @xmath217 is even higher .",
    "finite @xmath0 reduces this enhancement and the spatial variation of @xmath218 . ]",
    "thin superconducting square ( half width @xmath190 ) with central square hole ( half width @xmath219 ) in applied field @xmath220 and with no circulating current ( @xmath195 , case of flux focussing ) . plotted",
    "are the magnetic field @xmath221 in the center of the hole ( top ) and the magnetic flux @xmath13 inside the hole ( bottom ) , for squares without slit ( left , versus @xmath222 ) and with a narrow radial slit ( right , versus @xmath223 ) , like in fig .  1 , for several values of the 2d penetration depths @xmath224 . for @xmath26 and @xmath225 ,",
    "both the minimum field and the average field in the hole diverge , @xmath226 , see also the corresponding figs .  15 and 16 of ref .   for rings . for small holes ,",
    "@xmath227 , the presence of a slit reduces this field enhancement . ]     the fluxoid @xmath14 trapped in the square hole of a thin square without radial slit in the flux - focussing case of fig .",
    "this figure is very similar to fig .",
    "14 of ref .   for rings . for small and large @xmath0 nearly the same limiting curves are reached as for rings .",
    "the dots show the large-@xmath0 limit for rings with radii @xmath219 and @xmath190 : @xmath228.@xcite for @xmath179 this @xmath14 coincides with the @xmath13 in fig .",
    "6 ( bottom left ) . ]",
    "the fluxoid @xmath14 trapped in the square hole of the square of fig .  7 , but now with a narrow radial slit . since the integration path of the fluxoid must run inside the superconductor , the path has to cross the slit by a narrow bridge , through which no current flows since @xmath195 in this flux - focussing case .",
    "the plot shows the fluxoid when this bridge is chosen at @xmath229 ( where the slit enters the hole , top ) and at @xmath230 ( where the slit exits the square , bottom ) . for large holes these two @xmath14 are similar , but for small holes the larger integration path ( bottom ) yields a larger fluxoid since the integration includes the not negligible magnetic flux inside the narrow slit . for @xmath26",
    "the fluxoid of the smaller path ( top ) coincides with the flux @xmath13 of fig .",
    "6 ( bottom right ) . ]",
    "the current stream lines in a thin superconductor square ( @xmath231 , @xmath232 ) with radial slit running at @xmath233 from @xmath234 to @xmath230 , with a superconducting bridge at @xmath235 . shown",
    "is the flux - focusing case @xmath210 , @xmath195 , i.e. , no current crosses the bridge .",
    "the dots mark the numerical grid of @xmath237 points used for this plot . ]",
    "the fluxoid @xmath14 and magnetic flux @xmath13 inside a concentric square of half width @xmath238 passing through the bridge",
    "( at @xmath239 ) of the slitted square of fig",
    ".  9 , plotted versus @xmath240 for several values @xmath241 . for better presentation @xmath14",
    "is shown 4 times larger than @xmath13 , and @xmath13 is plotted versus @xmath242 . for @xmath26 one",
    "has @xmath243 . for @xmath244 one",
    "has @xmath245 ( dashed line , full penetration ) , and @xmath246 . ]",
    "the sheet current , magnetic field , and energy of vortices in the film is obtained by linear superposition from the solution for one vortex and the interaction energy of a vortex pair . in a film of finite size",
    "all these results explicitly depend on the vortex positions and not only on their distances due to the strong effect of the film edges .",
    "the existence of one vortex at position @xmath247 modifies the static london equation of sct .",
    "ii c to give @xmath248 , where @xmath249 tm@xmath250 is the quantum of flux and @xmath251 is the 2d delta function .",
    "equations ( 13 ) and ( 14 ) then become @xmath252        g({\\bf r } ' ) \\nonumber \\\\",
    "= \\mu_0^{-1}\\phi_0 \\ ,",
    "\\delta_2({\\bf r}-{\\bf r}_v ) -h_a({\\bf r } ) \\ , .     \\end{aligned}\\ ] ] writing the integral as a sum yields @xmath253 to invert this and find @xmath254 and the vortex interaction , we have to assume that the vortex sits on a grid point , @xmath255 .",
    "averaging over the grid cell centered at @xmath100 and having an area @xmath256 , replaces @xmath257 by @xmath258 . inverting this and performing the sum containing @xmath259 then yields the stream function caused by a vortex positioned at @xmath100 and by the applied field @xmath260 : @xmath261 with the inverse matrix @xmath91 from eq .",
    "( 17 ) , see also eq .",
    "( 16 ) .",
    "a second vortex sitting at @xmath83 sees the potential @xmath262 ; the interaction energy between two vortices positioned at @xmath83 and @xmath100 is thus : @xmath263 this potential is repulsive ( positive ) and sharply peaked at @xmath264 , since all the @xmath144 are negative .",
    "one can show that the matrix @xmath265 is indeed symmetric in @xmath206 , @xmath266 . for @xmath26 this is directly seen from the definition , eq .",
    "( 6 ) , writing @xmath267 , which shows that @xmath268 is the inverse of the symmetric matrix @xmath269 and is thus symmetric itself . for @xmath29",
    "one also has to prove that the operator @xmath270 is symmetric , see appendix .",
    "when the film contains several vortices positioned at some of the grid points @xmath100 , then the sum over these @xmath100 has to be performed in the first term of eq .",
    "( 28 ) , and the total energy of this vortex system becomes : @xmath271 where the sums are over the vortex positions @xmath206 , @xmath272 is the self energy of the vortex , @xmath273 is the vortex interaction ( 29 ) , and @xmath274 is the potential caused by the applied field @xmath67 . for constant @xmath11",
    "the external potential @xmath275 has the shape of a negative trough which is zero along the film edges .",
    "the vortices are thus pulled into the film by this potential .",
    "in contrast to vortices in large bulk superconductors , the self energy of a vortex in a thin film depends on the film size and shape and on the vortex position even when it is far from the film edges .",
    "calculating this vortex energy from the 2d current density in the film and the 3d magnetic stray field outside the film would be a formidable task .",
    "fortunately , a much simpler calculation is possible using our above results and the known lorentz force @xmath276 on the vortex : in a thought experiment , we move a first vortex from the film edge to its final position @xmath83 . at the edge",
    "the energy of this vortex , and also the interaction with other vortices needed later , are zero",
    ". then its energy increases according to the integrated lorentz force that originates from the interaction of this vortex with its own sheet current ( more precisely : with the film edges , or with its images if an image method can be used , but this argument will not be required here ) . when the vortex has reached position @xmath83 its energy is just its self energy @xmath277 .",
    "now move a second vortex from the edge and merge it with the first one .",
    "the self energy of this new vortex , @xmath278 , is composed of the two self energies and the energy needed to move the second vortex against the sheet current of the first one , equal to the interaction energy @xmath279 , eq .",
    "( 29 ) . from this",
    "we obtain the self energy @xmath280 used in eq .",
    "( 30 ) .",
    "this result is exact within our numerical method , but in real films the self energy depends on the logarithm of the vortex core radius @xmath281 , the coherence length . in our numerics @xmath25",
    "is effectively replaced by some cut - off length of the order of the grid spacing .",
    "if required , an improved consideration of the vortex core is possible if its radius exceeds the local grid spacing . the core shape",
    "may then be taken from the gl solution for infinite films .",
    "@xcite if @xmath25 is smaller than the grid spacing , the correct self energy is slightly larger than @xmath282 , by a position - independent constant .",
    "the fluxoid @xmath14 inside a given closed path @xmath68 inside the film is defined as the magnetic flux through this loop plus the 2d penetration depth @xmath0 times the path integral of the sheet current , @xmath283 .",
    "when @xmath40 and @xmath134 are given on a rectangular grid , the integration path is conveniently chosen along a closed rectangle which runs in the middle between the grid points ( app .",
    "a ) . the components @xmath284 and @xmath285",
    "are then obtained from the difference of the values of @xmath40 at neighboring grid points , while the flux is the sum of @xmath286 over all points @xmath287 inside this loop ( app .",
    "the fluxoid obtained in this way from our solutions is indeed independent of the chosen path to within 4 to 5 significant digits , confirming thus that the solutions @xmath40 and @xmath134 are accurate also for finite @xmath0 and even when @xmath288 , see figs .  7 and 8 below .",
    "surprizingly , the obtained @xmath0-dependent @xmath193 and @xmath104 are quite accurate even when @xmath0 is much smaller than the spacing of the numerical grid ( typically @xmath289 ) , down to @xmath290 . besides this",
    ", the solutions for @xmath26 are very accurate , with @xmath291 inside the film , see fig .",
    "to illustrate how this method works and to check previous approximations of a slitted ring by a full ring ,",
    "@xcite i discuss here the case of flux focussing in some detail .",
    "consider a thin square film of half width @xmath190 with a central square hole of half width @xmath219 ( @xmath292 , @xmath293 ) without slit , or with a narrow radial slit of width @xmath294 extending along the @xmath213 axis from @xmath229 to @xmath230 ( fig .  1 ) .",
    "the current @xmath16 circulating around the hole is forced to zero either `` artificially '' by putting the stream function @xmath42 everywhere outside the superconducting film , i.e. , also in the hole and slit , or , naturally , by cutting a slit that makes @xmath195 . a uniform magnetic field @xmath295 applied along @xmath33",
    "is screened inside the film ( or partly screened if the 2d penetration depth is @xmath296 for thickness @xmath7 ) by a sheet current @xmath41 that circulates clockwise near the edges and anticlockwise near the hole , see fig .  1 ( top right ) .",
    "this screening current causes a magnetic field in the hole ( and in the slit ) that can be much higher than @xmath11 , see figs .  4 and 5 .",
    "this field enhancement ( or flux focussing ) is plotted versus the relative hole size @xmath222 in fig .",
    "6 . for squares with no slit our numerics yields for small holes with @xmath297 and ideal screening ( @xmath26 ) for the central field @xmath298 , and for the magnetic flux in the hole @xmath299 , i.e.",
    ", both values diverge as @xmath300 when @xmath301 .",
    "this result is very similar to the flux focussing in circular rings depicted in figs .",
    "15 and 16 of ref .  .",
    "in particular , compared to a ring with radius @xmath190 and hole radius @xmath219 , the limit @xmath179 ( where the flux @xmath13 equals the fluxoid @xmath14 ) is almost identical both for @xmath302 and for the trapped flux plotted as the effective area @xmath303 referred to the hole area .",
    "namely , for small holes at @xmath26 one has for squares @xmath304 and for circular rings @xmath305 ( exact result @xcite ) .",
    "the corresponding results for the fluxoid @xmath14 in squares without slit are shown in fig .",
    "as expected , @xmath14 is independent of the integration path around the hole , which was chosen as any concentric square of half width between @xmath219 and @xmath190 .",
    "again , these @xmath14 are very similar to those for circular rings shown in fig .  14 of ref .  .",
    "for @xmath26 ( where @xmath306 ) they agree closely , as discussed above .",
    "but even for large @xmath307 and all hole sizes one has for rings @xcite @xmath308 , which is also a good approximation for the square , see the dots in fig .",
    "our 2d method allows us to check this approximation of slit - free flux focussing by considering squares or rings with slit .",
    "the results for the square with slit are depicted in fig .",
    "6 [ @xmath309 and @xmath13 plotted versus @xmath223 ] and fig .",
    "8 ( @xmath14 for two different integration paths ) .",
    "one can see that for large holes these realistic @xmath309 , @xmath13 , and @xmath14 are similar to those of slit - free squares .",
    "however , for small holes @xmath311 , the field enhancement is considerably weakened by the presence of a slit , in particular for small @xmath241 . for @xmath26",
    "the enhancement factor does no longer diverge as @xmath300 but tends to saturate ( or possibly diverges very weakly , as one over some logarithm , as is the case for finite @xmath0 in the absence of a slit ) .",
    "this means that the slit changes the screening currents near small holes considerably and thus reduces the field enhancement . as can be seen from the curves in fig .  6",
    ", the presence of a slit has qualitatively the same effect as an increased value of @xmath0 .",
    "this finding applies even though the width @xmath312 of our slit was very small , @xmath313 and less .",
    "by the same token , the presence of a slit changes the fluxoid @xmath14 , fig .",
    "moreover , the fluxoid now depends on the integration path .",
    "since this path has to run inside the superconductor , one has to bridge the slit by a narrow superconducting bridge .",
    "the current through this bridge by definition is @xmath195 in this flux - focussing case .",
    "it turns out that the resulting @xmath14 depends on the position of this bridge . in fig .",
    "8 the two extreme cases are shown when this bridge is chosen at @xmath229 ( where the slit emerges from the hole ) and at @xmath230 ( where the slit exits the square ) .",
    "for large holes these two choices yield similar @xmath14 , but for small holes the large integration path yields a larger fluxoid than the small path .",
    "one reason for this difference is that the fluxoid for the large path includes the magnetic flux @xmath314 inside the slit . for @xmath26",
    "one can show that @xmath314 is _ very large _ and almost does not decrease when the slit width @xmath312 is decreased . from the simplified model of two long parallel strips ( length @xmath315 ) with borders at @xmath316 and @xmath317 in perpendicular field @xmath318 , one finds for narrow slits the trapped flux @xcite @xmath319 for our squares with small hole we put the slit length @xmath320 and estimate the flux in the slit as @xmath321 , which depends weakly on the slit width @xmath312 . comparing this with the flux in small holes from above , @xmath322 , we get the ratio @xmath323 when @xmath324 is of the order @xmath325 .",
    "this means , for small holes with relative width @xmath326 , the magnetic flux even in a very narrow slit _",
    "exceeds _ the flux in the hole .",
    "this finding explains why for small holes our flux - focussing results for slit - free and slitted disks differ considerably while they agree for large holes .    to check this further , we computed the magnetic flux @xmath13 and the fluxoid @xmath14 for a square with no hole , but with a narrow radial slit ranging from @xmath234 to @xmath230 on the @xmath213 axis .",
    "we bridge this slit by a narrow superconducting bridge centered at @xmath239 , @xmath327 , see fig .",
    "the contour within which @xmath13 and @xmath14 are calculated is a concentric square passing through this bridge at @xmath239 .",
    "we consider the case of flux - focussing ( @xmath210 , @xmath195 ) , thus the current through the bridge is zero . in fig .",
    "10 the resulting @xmath13 and @xmath14 are plotted versus @xmath240 for @xmath241 = 0 , 0.001 , 0.003 , 0.01 , 0.03 , 0.1 , 0.3 , 1 , and @xmath328 .",
    "note that the scales differ by a factor of 4 . as expected , for @xmath26 ( ideal screening ) one has @xmath329 , and for @xmath244 ( full penetration ) @xmath245 .",
    "interestingly , for @xmath330 , one has approximately @xmath331 , where the constant @xmath332 slightly depends on the slit width .",
    "this proportionality of the flux to the slit length within the square path , confirms that the magnetic flux in the narrow slit is approximately proportional to its length , and that eq .",
    "( 31 ) ( derived for a long double strip ) is a good approximation for our radial slit in the square .",
    "in this paper i presented a method that allows to calculate the 2d distributions of the sheet current @xmath333 and magnetic field component @xmath134 ( and , of course , the full 3d magnetic field ) for thin flat superconductors of arbitrary shape .",
    "if the film thickness is @xmath7 ( the london depth ) , our method accounts for the 2d magnetic penetration depth @xmath151 , which may have any value , @xmath334 .",
    "the sheet current is expressed by the scalar potential ( or stream function ) @xmath40 , for which we list 10 useful properties in sec .",
    "ii a. the statics and dynamics of superconductors in the meissner state , or with pinned and depinning vortices described by a complex or nonlinear resistivity , can be calculated .",
    "it is shown how this is generalized to multiply connected film shapes , e.g. , squares or disks with a hole or closed slot , or with several such holes , slots , slits .",
    "for individual 2d vortices in the film we give their mutual interaction and self energy , which both depend on the specimen shape .",
    "the coupling of part of the magnetic flux of a moving vortex into a hole or slit is expressed in terms of the stream function @xmath40 , which is computed and depicted for some basic examples .",
    "if a slitted square or circular disk is used as a squid , the applied magnetic field and applied currents induce a signal across the weak link that bridges the slit , and the moving vortices cause a noisy signal.@xcite the squid signal in principle can be calculated by our 2d method , see ref .",
    "for a detailed theory of such squids and for the 1d problem of a long double strip that models a linear squid .    as a useful example for application of our 2d method we consider in sec .",
    "iii the phenomenon of flux focussing , which occurs when the total current circulating in a square or circular disk around a central hole is zero , @xmath195 .",
    "we compare the `` ideal case '' when the disk has no slit ( @xmath195 can then be achieved by appropriate magnetic history ) with the realistic situation where a radial slit forces @xmath195 .",
    "we find good agreement for large holes , but for squares with small central hole and radial slit , flux focussing is reduced by this slit .",
    "more applications will be published .",
    "helpful discussions with j.  r.  clem , d.  koelle , g.  p.  mikitik , rinke wijngaarden , and e. zeldov are gratefully acknowledged .",
    "this work was supported in part by the german israeli research grant agreement ( gif ) no g-705 - 50.14/01 .",
    "for the computation of the stream function @xmath335 with symmetry @xmath336 , @xmath337 , @xmath338 , a 2d grid of @xmath17 points @xmath339 with weights @xmath340 , @xmath341 , is chosen that covers the basic area @xmath342 ( upper half of the rectangular film @xmath343 ) .",
    "for simplicity we chose a rectangular grid @xmath344 with @xmath345 and @xmath346 , e.g. , the equidistant grid @xmath347 , @xmath348 with constant weights @xmath349 , @xmath350 .",
    "a better choice is a nonequidistant grid that is denser near the edges of the thin film .",
    "for example , for a rectangular film with rectangular hole with borders at @xmath351 , @xmath352 and a narrow slit along @xmath233 ( see fig .  1 )",
    ", a possible choice for the @xmath353 and weights @xmath354 ( and correspondingly for the @xmath355 and @xmath356 ) is @xmath357 , @xmath358 , @xmath359 for @xmath360 , and @xmath361 , @xmath362 , @xmath363 for @xmath364 , with any function @xmath365 defined in @xmath366 and having a derivative @xmath367 that at @xmath368 and @xmath369 is zero or small .",
    "we choose , e.g. , @xmath370 with @xmath371 ; @xmath372 means equidistant @xmath353 with constant weights @xmath354 , and @xmath373 ( highest accuracy ) means that the distances @xmath374 and weights @xmath354 vanish linearly at @xmath233 , @xmath375 , and @xmath376 . one can show that @xmath377 for any sufficiently smooth function @xmath378 .    for our 2d grid @xmath344",
    "the weights are @xmath379 .",
    "this 2d counting of grid points is required for graphics and for computing derivatives , e.g. , @xmath380 and @xmath381 . however , for computation of 2d integrals or for matrix operations , a 1d counting of the grid points is required : @xmath382 , @xmath383 , @xmath384 , @xmath385 , and any 2d function like @xmath40 is represented as a vector @xmath386 .",
    "the magnetic moment of the film , sec .",
    "2a , is then @xmath387 .",
    "the magnetic flux through a closed rectangular path running between the grid points ( along @xmath213 and @xmath102 values obtained from the above formulae for @xmath355 , @xmath388 by using half - integer values for @xmath59 , @xmath389 , e.g. , @xmath390 ) is then @xmath391 where the sum is over all points @xmath287 inside this loop .",
    "particular attention requires the computation of the laplacian @xmath392 acting on @xmath40 [ e.g. , in eq .",
    "( 13 ) ] , and computed by multiplication by a matrix @xmath393 [ e.g. , in eq .",
    "this operator should contain the information that @xmath42 outside and on the outer edges of the rectangular film @xmath124 , @xmath125 , and that at @xmath233 one has @xmath394 due to the symmetry @xmath336 . a 2d method that in principle applies to any 2d grid @xmath339 computes @xmath393 as the inverse of the green function @xmath395 satisfying @xmath396 and the conditions that @xmath397 for @xmath70 on the outer edge of the rectangle @xmath343 and having even symmetry with respect to @xmath102 .",
    "this @xmath395 may be expressed by an infinite sum , with alternating signs , of functions @xmath398 , where the @xmath399 are the vectors of a rectangular lattice with spacings @xmath400 and @xmath401 .",
    "the resulting matrix indeed works , however , it is less accurate ( and takes much more computation time ) than the simple 1d method of computing @xmath402 from @xmath403 and the values @xmath404 at the four neighboring points . with our nonequidistant grid",
    "we need for this the formula for @xmath405 at @xmath406 .",
    "writing @xmath407 , @xmath408 , @xmath409 , @xmath410 , @xmath411 , one has @xmath412 the boundary and symmetry conditions for @xmath40 allow to define the required values of @xmath193 on the grid lines lying one grid spacing outside the basic area @xmath337 , @xmath338 : @xmath413 , @xmath414 , @xmath415 , @xmath416 , @xmath417 , @xmath418 .",
    "m.  m.  khapaev , m.  yu .  kuprianov , e.  goldobin , and m.  siegel , supercond .",
    ".  technol .",
    "* 16 * , 24 ( 2003 ) ; see also : g.  hildebrandt and h.  uhlmann , ieee trans .",
    "* 32 * , 690 ( 1996 ) ; m.  m.  khapaev , supercond .",
    "* 10 * , 389 ( 1997 ) ; m.  m.  khapaev , ieee trans .  microwave theory and technol . *",
    "41 * , 217 ( 2001 ) .",
    "e.  h.  brandt , phys .",
    "* 114a * , 51 ( 1985 ) ; e.  h.  brandt , p.  esquinazi , and h.  neckel , j.  low temp .",
    "* 63 * , 187 ( 1985 ) .",
    "e.  h.  brandt , j. de pysique , colloque c8 , * 31 * , ( 1987 ) .",
    "e.  h.  brandt , phys .",
    "b.  * 46 * , 8628 ( 1992 ) .",
    "m.  b.  ketchen , w.  j.  gallagher , a.  w.  kleinsasser , s.  murphy , and j.  r.  clem , in _",
    "squid 85 , superconducting quantum interference devices and their applications , _ edited by h.  d.  hahlbohm and h.  lbbig ( de gruyter , berlin , 1985 ) , p.  865 ."
  ],
  "abstract_text": [
    "<S> it is shown how the static and dynamic electromagnetic properties can be calculated for thin flat superconducting films of any shape and size , also multiply connected as used for squids , and for any value of the effective magnetic london penetration depth @xmath0 . as examples , the distributions of sheet current and magnetic field are obtained for rectangular and circular films without and with slits and holes , in response to an applied perpendicular magnetic field and to magnetic vortices moving in the film . </S>",
    "<S> the self energy and interaction of vortices with each other and with an applied magnetic field and/or transport current are given . </S>",
    "<S> due to the long ranging magnetic stray field , these energies depend on the size and shape of the film and on the vortex position even in large films , in contrast to the situation in large bulk superconductors . </S>",
    "<S> the focussing of magnetic flux into the central hole of square films without and with a radial slit is compared . </S>"
  ]
}