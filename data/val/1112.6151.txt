{
  "article_text": [
    "in this paper we provide a new approach , along with extensions , to results in two important papers closely tied to the statistical analysis of fmri ( functional magnetic resonance imaging ) brain data .",
    "the first , by david siegmund and the late keith worsley  @xcite , treated the problem of testing for a spatial signal with unknown location and scale perturbed by a gaussian random field on @xmath0 . while their motivation came from fmri , their results are also relevant to areas such as astronomy and genetics , or indeed to many applications in which one searches a large space of noisy data for a relatively small number of signals which manifest as `` bumps '' in the random noise .    in a second paper , together with shafie and sigal @xcite , they treated an extended version of the same basic problem , allowing the asymmetric bumps to also have a direction associated to them , in addition to scale changes that were direction dependent .",
    "this added an additional `` rotation parameter '' to the model and complicated it to the extent that they were unable to treat anything beyond the two - dimensional ( @xmath1 ) case .",
    "thus , for example , while their results could be used to examine cortical surface images , they could not be applied to three - dimensional fmri analysis .    for etymological reasons , the first of these cases",
    "was called the _ scale space _ case and the second the _ rotation space _ case . in both cases , the mathematics of these papers concentrated on approximating the exceedence probabilities @xmath2 for large @xmath3 , a smooth , gaussian , real - valued , random field @xmath4 , and some parameter space @xmath5 . for reasons that will become clearer soon , in the @xmath6-dimensional scale space case ,",
    "the effective dimension of @xmath5 was @xmath7 , while in the rotation space case it jumped to @xmath8 ( or 5 , for the only case they could handle , when @xmath1 ) .",
    "the aims of the current paper are twofold .",
    "first , we shall generalize the results of the rotation space to any dimension , but by a very different method .",
    "rather than taking a `` from first principles '' approach , as was the case in  @xcite , we shall compute everything from a basic result known as the _ gaussian kinematic formula _ [ gkf , cf . ( [ pmainequation ] ) below ] , using techniques of riemannian geometry .",
    "in fact , we shall derive the rotation space results from a more general setting , which is of interest in itself .",
    "this is quite different from the analysis in @xcite , in which calculations were so involved that they could only be handled by symbolic calculus using computers and , then , as already mentioned , only in two dimensions . according to the `` no free lunch '' principle , there is a price to pay here , in that the specific @xmath1 approximations of  @xcite have a slightly higher level of precision .",
    "second , we shall recover the results of the scale space case , again using the gkf .",
    "we shall do this in two ways .",
    "first , we shall obtain it as an immediate corollary to the `` more general setting '' mentioned above .",
    "this is quick , but once again does not give the best results .",
    "however , we shall also derive the `` best '' results from a more detailed calculation , something which seems too difficult to do for rotation space fields .    at first this",
    "might seem as if we are attempting to kill the proverbial ant with a sledge hammer , but it turns out that there are at least three advantages to this approach .",
    "first of all , the ant in question is a rather large one , and any way of dealing with it requires considerable effort .",
    "the basic calculations in both @xcite and here take about 10 pages , and the essential difference is whether one prefers to work with riemannian topology or integral geometry , hard calculus and occasionally symbolic ( machine ) calculus",
    ". this may be more a question of mathematical taste than anything else .",
    "the second advantage of using the gkf as the basic starting point , which is significant and no longer merely an issue of taste , is that while the results of  @xcite and @xcite apply , as stated , only to gaussian fields , the gkf allows immediate extension to a much wider class of examples .",
    "section [ gkfsubsec ] explains this .",
    "finally , both of these cases are instructive in terms of how to use the gkf in more general settings , and our hope is that presenting them in detail will provide examples which will make the gkf easier to use in the future for other , perhaps quite different , examples .",
    "we shall say no more in the way of motivation for this paper .",
    "discussions and examples can be found in both  @xcite and @xcite as well as the papers cited there , and the many more recent papers citing  @xcite and  @xcite . in particular , it is explained there why ( [ exceedence1equn ] ) is an important quantity in statistical hypothesis testing . rather , we shall , in the following section , immediately turn to formal definitions of scale and rotation random fields , a description of the gkf and its relation to  @xcite and  @xcite , and a statement of the main results of the paper in section  [ lkcrotatesubsec ] .",
    "fuller results for scale space fields , which go considerably beyond those of section  [ lkcrotatesubsec ] , are given at the end of the paper , in section  [ scalesec ] .",
    "understanding or using the results of the paper does not require a deeper knowledge of differential geometry beyond that which we describe along the way .",
    "this is not true of the proofs , and in section  [ beforesection ] we point to what else is needed .",
    "the remainder of the paper is taken up with proofs .",
    "the common element behind all the random fields in this paper is gaussian white noise .",
    "the simplest way to define gaussian white noise @xmath9 on @xmath0 is as a random field indexed by the borel sets @xmath10 , finitely additive , taking independent values on disjoint sets , and such that , for all @xmath11 with finite lebesgue measure @xmath12 , @xmath13 .",
    "it is standard fare to define integrals @xmath14 , for _ deterministic _",
    "@xmath15 , which are mean zero , gaussian random variable with covariances @xmath16      the gaussian scale space random field is obtained by smoothing white noise with a spatial filter over a range of filter widths or scales .",
    "formally , for a `` filter '' @xmath17 it is defined as @xmath18 typically @xmath19 ranges over a nice subset @xmath20 of @xmath0 , and we take @xmath21 $ ] , for finite @xmath22 .",
    "the parameter space therefore includes both scale and location parameters . from a statistical point of view",
    ", the scale space field is a continuous wavelet transform of white noise that is designed to be powerful at detecting a localized signal of unknown spatial scale and location .",
    "this concludes the definition , and we now turn to some additional assumptions , as well as setting up some notation and further definitions that we shall require to state the main results and to carry out the proofs .    for convenience , and without loss of generality , we shall assume that the filter @xmath23 is normalized so that @xmath24 , which will ensure that the variance of @xmath4 is also one .",
    "we shall also assume that @xmath23 is twice continuously differentiable on @xmath0 and that all partial derivatives are in @xmath25 .    with some loss of generality ,",
    "that , in practice , is not generally too restrictive , we shall assume that there exists a @xmath26 such that @xmath27 where we write @xmath28 or @xmath29 to denote the @xmath30 identity matrix .",
    "( note : we take all our vectors to be column vectors . )",
    "equation ( [ ecscaledequn ] ) will follow , for example , if the filter is spherically symmetric .",
    "two common examples are given by the standard gaussian kernel @xmath31 and the marr or `` mexican hat '' wavelet @xmath32^{1/2 } \\biggl(1-\\frac { |t|^2}{n } \\biggr ) e^{-|t|^2/2}.\\ ] ] it is easy to check that in the gaussian case ( [ ecscaledequn ] ) holds with @xmath33 and in the marr wavelet case with @xmath34 .",
    "furthermore , the covariance function of the scale space field is easily calculated , via ( [ introinnerprodallequation ] ) , to be @xmath35 note that , for fixed @xmath36 , it follows from the previous line that @xmath4 is stationary in @xmath19 .",
    "however , @xmath4 is definitely not stationary as a process in the pair @xmath37 .    to apply the gkf and to state our results",
    ", we shall need information about the derivatives of @xmath4 , which exist due to our assumptions on @xmath23 . either from first principles , by differentiating the covariance function or by using ( 5.5.5 ) of  @xcite , we find that all first - order partial derivatives of @xmath4 with respect to the space variables are uncorrelated with the first - order derivative in the scale variable .",
    "this lack of correlation , which of course is equivalent to independence since all fields are gaussian , is _ crucial _ to the proofs , and without it , it is unlikely that we could complete the detailed calculations that we shall carry out later .",
    "the same techniques also give @xmath38 ^ 2 \\,du , \\\\",
    "\\label{ecscale - variances2equn } \\lambda_{\\sigma } & \\definedby & { \\operatorname{var}}\\bigl ( \\nabla_t f ( \\sigma , t ) \\bigr ) = \\sigma^2 \\int_{\\mathbb{r}^n } \\nabla h(u ) \\bigl(\\nabla h(u)\\bigr)^\\prime \\,du,\\end{aligned}\\ ] ] where @xmath39 denotes the gradient of @xmath4 with respect to the elements of @xmath19 only . in view of ( [ ecscaledequn ] )",
    ", we have @xmath40 .",
    "we should note that it is not obvious at this point that the quantity @xmath41 should be independent of @xmath36 .",
    "however , this is in fact a consequence of calculations in section  [ secscale ] . for the gaussian and marr wavelet kernels the values of @xmath42",
    "are @xmath43 and @xmath44 , respectively .    excluding section  [ scalesec ] , from now on we shall assume that @xmath23 is spherically symmetric , so that we can define @xmath45 by @xmath46 in this case , @xmath47 , @xmath42 and other constants which will appear throughout can be expressed in terms of @xmath48 . in particular",
    ", retaining consistency with ( [ ecscaledequn ] ) and ( [ ecscale - variancesequn ] ) and introducing three new terms , we have @xmath49\\\\[-8pt ] \\kappa_{4}&=&\\int_{\\mathbb{r}^{n}}\\dot{k}^{2 } \\bigl ( u'u \\bigr ) u_{1}^{4 } \\,du , \\qquad\\rho=\\int _",
    "{ \\mathbb{r}^{n}}k \\bigl ( u'u \\bigr ) \\dot{k } \\bigl ( u'u \\bigr ) u_{1}^{2 } \\,du \\nonumber\\end{aligned}\\ ] ] and also define @xmath50    note for later use that @xmath51 this can be easily proved for a general isotropic kernel [ instead of @xmath52 above ] by using fubini s theorem to restrict to the two - dimensional case and then expressing the integral using spherical coordinates .",
    "as already described , rotation space random fields are based on the same underlying white noise model as scale space fields , but also allow for rotations and scale changes that are direction dependent . more precisely ,",
    "write @xmath53 where @xmath54 is the set of @xmath55 positive definite symmetric matrices , @xmath56 , @xmath57 , @xmath58 and for two matrices @xmath59 and @xmath60 we write @xmath61 if , and only if , @xmath62 is nonnegative definite .",
    "then the rotation space random field , defined over the @xmath63-dimensional space @xmath64 , is given by @xmath65 again , we shall assume that @xmath66 is spherically symmetric , twice continuously differentiable on @xmath0 , that all partial derivatives are in @xmath67 ) and normalized so that @xmath24 .",
    "note that the eigenvalues and eigenvectors of @xmath68 determine the scalings and the corresponding `` principal directions '' for the rotation space field .",
    "the constant analogous to @xmath69 in rotation space is @xmath70 where @xmath71    reassuringly , when @xmath72 , in which case scale space is equivalent to rotation space , it is easy to check that @xmath73 .",
    "another constant which will appear later is @xmath74    as for scale space fields , we shall once again need information about variances and covariances of the first - order derivatives of rotation space fields .",
    "this time , however , the formulae are somewhat more complicated , and , since one of the parameters of @xmath75 is a matrix , we shall have to explain what we mean by differentiation with respect to this parameter .",
    "details will be given below in section [ dependencesubsec ] .",
    "at this point we note only that , as before , derivatives with respect to @xmath19 and @xmath68 are independent , and , again , this is crucial to our ability to carry out detailed computations .",
    "furthermore , although once again @xmath4 is neither stationary nor isotropic , it does have zero mean and constant variance .",
    "before we state the gkf , we need to say something about the regularity conditions needed for it to hold",
    ". these are of three kinds , relating to the smoothness of the scale and rotation space fields , the structure of @xmath20 ( and so of @xmath5 ) and the smoothness of a transformation @xmath76 that we shall meet only in the next subsection .",
    "full details are given in chapters 11 and 12 of @xcite .",
    "we start with @xmath20 , which we take to be a compact domain in @xmath77 with a @xmath78 boundary ( although @xcite would allow us to assume less ) . for the remainder of this paper",
    "we require no convexity conditions on @xmath20 , although in order to apply the euler characteristic heuristic of section  [ motivationsec ] it is necessary to assume that @xmath20 is locally convex in the sense of definition 8.2.1 of  @xcite .",
    "the second set of conditions is required to ensure that @xmath4 is , with probability one , @xmath78 , as a function of each of the space and scale or rotation variables , and also nondegenerate in a certain ( morse theoretic ) sense .",
    "sufficient conditions under which this holds are given in sections 11.3 and 12.1 of  @xcite .",
    "it is easy to check that these conditions are satisfied for the gaussian , marr and other smooth kernels .",
    "we shall state the gkf in more generality than needed for this paper , since to do so requires little more than an additional sentence or two .",
    "suppose @xmath5 is a @xmath78 , whitney stratified manifold satisfying mild side conditions and @xmath63 a similarly nice stratified submanifold of @xmath79 .",
    "for the exact definitions of `` mild '' and `` nice '' see  @xcite , but , for the purposes of this paper , it suffices that @xmath5 is either a scale or rotation space , with @xmath20 satisfying the conditions of the previous subsection .",
    "also , if @xmath80 is @xmath78 , then it will suffice that @xmath81 for some  @xmath3 .",
    "let @xmath82 be a vector valued random process , the components of which are independent , identically distributed , real - valued , @xmath78 , centered , unit variance , gaussian processes , satisfying the conditions of the previous subsection .",
    "the gaussian kinematic formula ( due originally to taylor in  @xcite and extended in @xcite ) states that , for certain additive set functionals @xmath83 , @xmath84 ( 2\\pi ) ^{-j/2}{{\\cal l}}_{i+j}(m ) \\min_j^{k}(d).\\ ] ] there is a lot to explain here .",
    "the `` flag '' coefficients @xmath85 = { n\\choose j } { \\omega_n}/{\\omega_{n - j } \\omega_j}$ ] , where @xmath86 is the volume of the unit ball in @xmath87 .",
    "the @xmath88 , known as the gaussian minkowski functionals of @xmath63 , are determined via the tube expansion @xmath89 where @xmath90 and dist is the usual euclidean distance . in the case",
    "@xmath81 it typically involves no more than multivariate calculus to compute the @xmath88 , and many examples are given in  @xcite and  @xcite .",
    "we shall give one example in a moment .",
    "the most important elements of ( [ pmainequation ] ) are the @xmath91 , known as lipschitz  killing curvatures ( lkcs ) .",
    "the first of these is rather simple , as it is always the euler characteristic @xmath92 , that is , @xmath93 for all nice @xmath59 .",
    "thus , ( [ pmainequation ] ) , with @xmath94 , provides us with an expression for @xmath95 , which is what is needed to approximate exceedance probabilities , as explained in the following section .    for a simple but extremely important example , suppose that @xmath96 and @xmath76 is the identity .",
    "then it is easy to compute the @xmath97 to see that , with @xmath94 , and @xmath98 satisfying the conditions above , ( [ pmainequation ] ) becomes @xmath99 where @xmath100 is an excursion set , the @xmath101 , @xmath102 , are hermite polynomials , and @xmath103^{-1}\\int_x^\\infty\\varphi(u ) \\,du$ ] , where @xmath104 is the standard gaussian density .",
    "since the structure of @xmath5 affects only the lkcs , and neither the minkowski functionals nor the flag coefficients , computing lkcs is an independent problem .",
    "this is what this paper is about , for scale and rotation space fields .",
    "( a word to the purely applied statistician who needs only a numerical , data driven method for estimating lkcs from data and wishes to avoid theory .",
    "two different such methods  @xcite are currently available . )    throughout , we assume that @xmath5 is a regular ( in the sense of @xcite ) stratified manifold .",
    "these are basically sets that can be partitioned into a disjoint union of @xmath78 manifolds , so that we can write @xmath105 where each nonempty stratum , @xmath106 , @xmath107 , is a @xmath108-dimensional manifold whose closure contains @xmath109 for all @xmath110 . for a @xmath6-dimensional cube , @xmath111 is its interior , @xmath112 is the union of its ( @xmath113)-dimensional ( open ) faces and so on , down to @xmath114 , which is the collection of its vertices .    if such a space is locally convex , then a simple way to define a euclidean version @xmath115 of the lkcs is via a _ tube formula _ , which states that , for small enough @xmath116 , and @xmath117 , @xmath118 where ( for reasons that will become clearer later ) we write @xmath119 for the lebesgue ( hausdorff ) measure on @xmath0 .",
    "it follows that , for rectangles,@xmath120 ) = \\sum t_{i_1}\\cdots t_{i_j } , $ ] where the sum is taken over all distinct choices of subscripts .",
    "note that it will always be true that @xmath121 is the volume of @xmath5 , while @xmath122 is half the surface measure of @xmath5 .",
    "furthermore , @xmath123 .    in",
    "what follows , however , we shall need to work in a non - euclidean setting , as the lipschitz  killing curvatures in the gkf , and thus in ( [ eecgaussianequn ] ) , are computed relative to a riemannian metric induced by a gaussian field .",
    "this metric @xmath124 on @xmath5 is defined by @xmath125 for any @xmath126 and for @xmath127 , the tangent space to @xmath5 at @xmath128 .",
    "this can also be written in terms of the covariance function as @xmath129    both of the gaussian fields of interest to us ",
    "the scale and rotation space fields  which we defined on compact sets , can easily be extended , to @xmath130 and @xmath131 , respectively , and so ( [ metric ] ) defines metrics on these spaces . in all that follows , unless stated otherwise , these metrics , or their restrictions , are what we shall work with , and it will be in relation to them that hausdorff measures @xmath132 and lipschitz  killing curvatures @xmath91 are defined . when we consider a submanifold @xmath133 of either of these spaces the notation @xmath134 , @xmath135 will be used .",
    "when the standard euclidean metric is used these will be replaced by @xmath136 and @xmath137 .",
    "a riemannian metric defines a volume form , a riemannian curvature and a second fundamental form on @xmath5 ( and , indeed , on each the @xmath138 ) .",
    "then @xmath139 is its riemannian volume and so is an integral of the volume form .",
    "@xmath140 is closely related to the ( riemannian ) area of @xmath141 , the ( @xmath142)-dimensional boundary of @xmath5 .",
    "the remaining lipschitz  killing curvatures involve integrals of both curvatures and second fundamental forms , and are more complicated .",
    "rather than give the general form ( for which you can see chapter 10 of @xcite ) , we shall give specific definitions for each of the cases we treat , in the following sections .",
    "now , however , we shall give ( relatively ) simple expressions for the cases of interest to us .",
    "these are the main results of this paper .",
    "we shall present the results of this section in stages . in the first we shall represent the lipschitz  killing curvatures as an integral for a situation more general than that needed to handle rotation space fields .",
    "this is theorem  [ decompositiontheorem ] , and it shows how to write these integrals as products of lebesgue measures of subsets of @xmath143 and integrals over submanifolds of @xmath144 . in theorem  [ rotatetheorem ] we shall compute these integrals for certain situations , which will lead to corollaries  [ rotatecorollary ] and [ corscale ] .",
    "these give relatively simple , quite explicit , expressions for the highest - order lipschitz  killing curvatures for rotation and scale space fields , respectively .",
    "more detailed information for scale space fields is given in section  [ scalesec ] .",
    "we say that a manifold @xmath145 is orthogonally invariant if @xmath146 for every @xmath147 , the set of orthogonal matrices . for such @xmath133 of dimension  @xmath148",
    ", we define @xmath149 where @xmath150 , @xmath151 is the haar probability measure on @xmath152 , and for a matrix @xmath59 , @xmath153 denotes the upper left submatrix of size @xmath154 .",
    "the measure @xmath155 is the haar measure induced by the restriction of the metric induced by the field @xmath124 to a fiber @xmath156 , which , as we shall see , is independent of the choice of @xmath19 . with these definitions",
    ", we can now state the following :    [ decompositiontheorem ] let @xmath157 be the restriction of the rotation space random field defined in section [ rotationspacesubsec ] , to the product of an @xmath158-dimensional regular stratified manifold @xmath159 and a @xmath48-dimensional regular stratified manifold @xmath160 . furthermore , suppose that each stratum @xmath161 , @xmath162 , is orthogonally invariant and that the regularity conditions of section  [ regularitysubsec ] vis - a - vis @xmath4 all hold .",
    "then , @xmath163,\\end{aligned}\\ ] ] where @xmath47 is given by ( [ ecscaledequn ] ) or ( [ eqconstants ] ) .",
    "it is not hard to see that @xmath164 is a symmetric function of the eigenvalues of @xmath68 .",
    "furthermore , as we shall see , as each stratum of @xmath165 is orthogonally invariant , its hausdorff measure is in fact invariant under @xmath166 , for any orthogonal @xmath167 .",
    "hence , the @xmath168 are expressible as integrals over certain functions of the eigenvalues of @xmath169 .",
    "in particular , for rotation space , with search region @xmath170 , we arrive at the following explicit expressions .",
    "[ rotatetheorem ] with the notation defined above , under the conditions of theorem [ decompositiontheorem ] , and for a spherically symmetric kernel , @xmath171\\,d \\lambda,\\end{aligned}\\ ] ] where @xmath172 and @xmath173 are given in ( [ eqdefck ] ) and ( [ eqdefdk ] ) .",
    "theorem  [ decompositiontheorem ] implies the following corollary , with all @xmath168 s as above .",
    "[ rotatecorollary ] under the conditions of theorem  [ rotatetheorem ] and the regularity conditions of section [ regularitysubsec ] , the top two lipschitz  killing curvatures for the rotation random field on @xmath170 are @xmath174    to obtain a parallel result for scale space fields , we use the fact that the scale space random field on @xmath175 $ ] , with a spherically symmetric kernel , has the same distribution as the restriction of the rotation space random field defined in section  [ rotationspacesubsec ] to @xmath176 , where @xmath177 once we study the metric induced by the rotation field , theorem [ decompositiontheorem ] will effortlessly yield the following result .",
    "[ corscale ] under the conditions of theorem  [ rotatetheorem ] and the regularity conditions of section [ regularitysubsec ] , the top two lipschitz  killing curvatures for the scale space random field on @xmath175 $ ] are @xmath178 and @xmath179 where @xmath69 is as in ( [ eqdefctildek ] ) .    in section  [ scalesec ]",
    "we analyze scale space fields independently of the rotation space case for a manifold with a boundary and without assuming spherical symmetry .",
    "the formulae for all lipschitz  killing curvatures are given via ( [ ecsumoflsequn ] ) , the terms of which are all computed in section  [ scalelkcssubsubsec ] .      while the formulae of theorem  [ rotatetheorem ] may look rather forbidding , one should note two facts . the first is that , for dimension @xmath180 , they are the first of their kind . the second is that although for dimension @xmath1 they are implicit in @xcite , one computation relied on computer algebra and gave a large , unstructured formula , while the second , based on tube formulae , does not precisely give the lkcs .",
    "( this is not unreasonable , since that computation was directed explicitly at approximating exceedance probabilities , and not computing lkcs . ) to recoup the results of  @xcite , we treat , as an example , the case @xmath1 ( so that @xmath181 ) . in that case , it is possible to carry out the integrations needed to compute @xmath182 and @xmath183 .",
    "a page or so of calculus shows that , for the gaussian kernel , @xmath184,\\ ] ] where @xmath185 is the simple euclidean area of @xmath20 and @xmath186 .    the lkc @xmath183 is a little harder to calculate , since while the first term inside the brackets is again amenable to simple calculus , the second term leads us to special functions .",
    "however , a simple answer is attainable , and @xmath187 where @xmath188 is the length of @xmath189 , and , with @xmath190 the elliptic integral @xmath191 , we have @xmath192 .",
    "note also that , as stated , theorem  [ rotatetheorem ] is weaker than the result for the scale case in section  [ scalesec ] in that it gives only the highest two lkcs , rather than all of them .",
    "however , while more would be desirable , it is the higher ones that are most important for the euler characteristic heuristic discussed in the following section .",
    "we shall explain there why this is the case .",
    "as intimated in the , signal plus noise problems often boil down to being able to compute the exceedance probabilities ( [ exceedence1equn ] ) . for smooth gaussian processes",
    ", there is typically no way to directly compute these probabilities , and they must be approximated , using approximations that are accurate for the tail 5% or so of the distribution .",
    "there are a number of ways to carry out such approximations , and two of these are at the center of the papers  @xcite and  @xcite , discussed in the .",
    "one relies on _ tube formulae _ and moves the problem from one about gaussian processes on euclidean sets @xmath5 to one involving computation of volumes of tubes around embeddings of @xmath5 in high - dimensional spheres .",
    "the other is the euler characteristic heuristic @xcite which provides a generally easier route , along with the advantage that it also provides information on sample paths at all levels .",
    "the ech states that for smooth random fields  @xmath4 , on nice , locally convex , compact sets @xmath5 ( which will be the case in our scenarios if @xmath20 is locally convex , since @xmath193 and @xmath194 are convex ) and large @xmath3 , @xmath195    in the case of smooth , gaussian , @xmath4 , with zero mean and constant unit variance ( but with no stationarity assumptions ) the approximation in ( [ approxequn ] ) can be quantified ( cf .",
    "@xcite ) , and it is known that @xmath196 where we write @xmath197 for the difference of the two terms in ( [ approxequn ] ) , and @xmath198 is an @xmath4-dependent constant , that is , in many cases , computable .",
    "the importance of ( [ validitymainequation ] ) is that it shows that the two terms in ( [ approxequn ] ) , both of which are known from the general theory of gaussian processes to be of order @xmath199 , differ by a term of exponentially smaller order , viz . of order @xmath200",
    "this fact is what justifies the use of the ech for gaussian fields ( in which case it is no longer heuristic ) and in large part motivates the computations of this paper , and also explains the claim of the previous section , that the leading lipschitz  killing curvatures are the important ones in applying the ech .",
    "as we wrote earlier , it should have been possible to read the paper up to this point without a knowledge of differential geometry",
    ". this will not be true for the proofs .",
    "the derivations of the leading lipschitz  killing curvatures for the rotation space case , which is what we have concentrated on so far , and all lkcs for the scale space case , which will be treated in section [ scalesec ] , begin in the same fashion .",
    "each starts by taking the parameter space @xmath5 , writing it as a stratified manifold , and carefully identifying the strata @xmath106 of ( [ ppartitionequation ] ) .",
    "the next step will be to take the generic formulae for lkcs , given in ( necessary , but sometimes painful ) detail in  @xcite , and rewrite them for the current setting , that is , for the specific stratification , and for the induced riemannian metric ( [ metric ] ) .",
    "we shall not explain in detail how this is done other than to say , at each stage , which generic formula we are using .",
    "then , the riemannian metric induced by the field is computed .    at this point",
    "the proofs diverge . for scale space",
    "we compute all lkcs , and so geometric objects such as curvature and second fundamental forms arise . for rotation space , with only the two leading lkcs , we can avoid them .",
    "the problem lies not in the the higher dimension of rotation space , but in its more complicated riemannian metric .",
    "nevertheless , in section  [ secscale ] we shall see that once the geometry of rotation space is understood , the two leading lkcs of scale space are effortlessly computed .    throughout",
    ", we have tried to carry out computations as carefully as possible , so that not only can the interested reader follow the calculations , but also can see how they need to be adjusted for other cases .",
    "we shall break the proof of theorem  [ decompositiontheorem ] into stages , the first of which relates to the crucial orthogonality properties mentioned in the .",
    "our aim in this subsection is to establish the orthogonality of the two subspaces @xmath201 under the inner product defined by the riemannian metric induced by the process .",
    "another factor that comes into play is a structured dependence of the restrictions of the riemannian metric on @xmath202 to fibers of the form @xmath203 .",
    "this will turn out to be the key that allows us to carry out further detailed computations .    to establish this independence , let @xmath204 be a point in @xmath202 and let @xmath205 be two derivations in @xmath206 , respectively . using the connection to the covariance function",
    "given in ( [ eqriemannianmetric ] ) , and writing @xmath207 and @xmath208 to denote the elementwise derivatives of the identity functions on @xmath0 and @xmath209 , respectively , we have@xmath210 & = & 2{\\vert}s{\\vert}^{{1}/{4 } } \\bigl(y { \\vert}s{\\vert}^{{1}/{4 } } \\bigr ) \\int\\bigl((xt)'su\\bigr ) \\dot{k}\\bigl ( u'su\\bigr ) k\\bigl(u'su\\bigr ) \\,du \\\\[-2pt ] & & { } + 2{\\vert}s{\\vert}^{{1}/{2 } } \\int \\bigl((xt)'su \\bigr ) \\bigl(u'(ys)u\\bigr ) \\bigl[\\dot{k}\\bigl ( u'su \\bigr)\\bigr]^2 \\,du\\\\[-2pt ] & = & 0,\\end{aligned}\\ ] ] where the last equality follows since both integrands are odd functions .",
    "this shows that the subspaces @xmath211 and @xmath212 are orthogonal at each point .",
    "we now compute the restriction of the riemannian metric @xmath124 to a fiber , again based on ( [ eqriemannianmetric ] ) .",
    "writing , again , @xmath39 for the spatial derivative of @xmath4 with respect to the elements of @xmath19 , the gram matrix of the riemannian metric on , relative to the standard euclidean basis , is @xmath213 & & \\qquad = { \\vert}s{\\vert}^{{1}/{2}}\\int_{\\mathbb{r}^{n } } \\nabla_{t}k \\bigl ( ( t - u ) 's ( t - u ) \\bigr ) \\bigl ( \\nabla_{t}k \\bigl ( ( t - u ) 's ( t - u ) \\bigr ) \\bigr)'\\,du \\\\[-2pt ] & & \\qquad = 4{\\vert}s{\\vert}^{{1}/{2}}\\int_{\\mathbb{r}^{n}}\\dot { k } \\bigl ( w'sw \\bigr ) sw \\bigl(\\dot{k } \\bigl ( w'sw \\bigr ) sw \\bigr)'\\,dw \\\\[-2pt ] & & \\qquad = 4{\\vert}s{\\vert}^{{1}/{2}}s \\biggl[\\int_{\\mathbb { r}^{n } } \\bigl(\\dot{k } \\bigl ( w'sw \\bigr ) \\bigr)^{2}ww'\\,dw \\biggr]s \\\\[-2pt ] & & \\qquad = 4s^{{1}/{2 } } \\biggl[\\int _ { \\mathbb{r}^{n } } \\bigl(\\dot { k } \\bigl ( v'v \\bigr ) \\bigr)^{2}vv'\\,dv \\biggr]s^{{1}/{2 } } \\\\[-2pt ] & & \\qquad = \\gamma s.\\end{aligned}\\ ] ]      relying on ( [ eqriemannianmetric ] ) to express the riemannian metric and using a simple change of variables , it can easily be seen that the restriction of @xmath124 to @xmath214 is independent of @xmath19 .",
    "denote this metric on @xmath215 by @xmath216 . using the identity @xmath217 , valid on @xmath144 , we have @xmath218 & & \\qquad = \\tfrac{1}{4}{\\vert}s{\\vert}^{{1}/{4}}s^{-1}k \\bigl ( ( t - u ) 's ( t - u ) \\bigr ) \\\\[-2pt ] & & \\qquad\\quad { } + { \\vert}s{\\vert}^{{1}/{4}}\\dot { k } \\bigl ( ( t - u ) 's ( t - u ) \\bigr ) ( t - u ) ( t - u ) ' .\\end{aligned}\\ ] ] therefore , for tangent vectors @xmath219 , @xmath220 & & \\hspace*{15pt } { } \\times\\bigl\\langle\\nabla_s \\bigl({\\vert}s{\\vert}^{{1}/{4}}k \\bigl ( ( t - u ) 's ( t - u ) \\bigr ) \\bigr),b \\bigr\\rangle \\,du \\\\[-2pt ] & = & { \\vert}s{\\vert}^{{1}/{2}}\\int_{\\mathbb{r}^{n } } \\biggl [ \\frac { 1}{4}k \\bigl ( u'su \\bigr ) \\bigl\\langle s^{-1},a \\bigr\\rangle+\\dot { k } \\bigl ( u'su \\bigr ) \\bigl \\langle uu',a \\bigr\\rangle \\biggr ] \\\\[-2pt ] & & \\hspace*{43.4pt } { } \\times\\biggl[\\frac{1}{4}k \\bigl ( u'su \\bigr ) \\bigl\\langle s^{-1},b \\bigr\\rangle+\\dot{k } \\bigl ( u'su \\bigr ) \\bigl \\langle uu',b \\bigr\\rangle \\biggr]\\,du.\\end{aligned}\\ ] ] after some slightly tedious calculus , and based on the fact that @xmath221 [ see  ( [ eqkappaidentity ] ) ] , all of the terms above can be expressed in terms of moments of the kernel @xmath48 and its derivative @xmath222 as follows : @xmath223    when @xmath23 is the gaussian kernel @xmath224 , and therefore @xmath225 , simple calculations show that @xmath226 , leaving only the term @xmath227 above .",
    "let @xmath228 denote the riemannian measures on @xmath229 induced by @xmath124 and let @xmath230 denote the hausdorff measure , that is , riemannian measure under the standard euclidean metric on @xmath20 .",
    "a standard calculation gives @xmath231 where @xmath232 is defined to be the determinant of @xmath233 for some @xmath234 matrix @xmath235 , the rows of which form an orthonormal basis of @xmath236 ( under the euclidean inner product ) .",
    "the determinant , of course , is independent of the choice of basis .    working in a chart and relying on the orthogonality established above ,",
    "it is easy to see that @xmath237 & = & \\int _ { \\partial_{k}b_k}\\int_{\\partial_{l}a_l}d\\mathcal { h}_{l}^{a_l \\times\\{s\\ } } ( t ) \\,d\\mathcal{h}_{k}^{b_k } ( s ) \\\\[-2pt ] & = & \\gamma^{l/2 } \\int_{\\partial_l a_l}\\int _ { \\partial_k b_k}{\\vert}s{\\vert}_{t_{t}\\partial_la_l}^{{1}/{2}}\\,d\\mathcal { h}_{k}^{b_k } ( s ) \\,d\\mathcal{h}_{l}^{e } ( t ) . \\nonumber\\end{aligned}\\ ] ] the equality above relies on the expression for the radon  nikodym derivative above and a fubini theorem .",
    "we recall now our assumption that @xmath238 is orthogonally invariant , that is , @xmath239 for any @xmath147 .",
    "thus , the mapping @xmath166 is a diffeomorphism from @xmath238 to itself .",
    "moreover , for the covariance function of the rotation field , we have @xmath240 therefore , @xmath166 is also a riemannian isometry .",
    "thus , the measure @xmath241 , induced by the riemannian metric , is also invariant under @xmath166 .",
    "this implies that we can drop the dependence of the integral in ( [ eq41 ] ) on the tangent space @xmath242 .",
    "that is , we can replace it , for all @xmath19 , with a fixed @xmath108-dimensional subspace of our choice or a random one .",
    "therefore , @xmath243\\\\[-8pt ] & = & \\gamma^{l/2 } { { \\cal h}}_l(\\partial_la_l ) f_{k , l}(\\partial_kb_k ) .",
    "\\nonumber \\ ] ]    to complete the proof of the theorem , one must repeat essentially the same calculation for the codimension part of @xmath244 .",
    "in this section we perform the computations necessary to evaluate the expression in corollary  [ corscale ] .",
    "these calculations are much simpler than those for rotation space .",
    "the set @xmath245 can be stratified as @xmath246 clearly , each stratum is orthogonally invariant .",
    "consequently , theorem [ decompositiontheorem ] implies we need only compute the following three terms , each of which is straightforward : @xmath247 where @xmath248 is the appropriate density with respect to the lebesgue measure .",
    "above , we expressed the necessary integrals in terms of the parametrization of @xmath249 by the curve @xmath250 .",
    "hence , @xmath251 therefore , @xmath252",
    "we start the proof of theorem  [ rotatetheorem ] by describing a stratification of @xmath253 , which is one of the regularity conditions required for applying the gkf .",
    "in fact , we shall actually only use the strata of codimension 0 and 1 .",
    "our first step is to express the manifold @xmath254 as a whitney stratified manifold .",
    "note that a stratification for @xmath253 yields a stratification for @xmath5 as the product stratification , given that a whitney stratification of @xmath20 is assumed given .",
    "thus , our first goal is to stratify @xmath255 for arbitrary @xmath256 .",
    "semialgebraic orbits of the lie group action @xmath257 , @xmath258 , @xmath259 constitute a whitney stratification of @xmath260 ( cf .",
    "@xcite , page 21 ) .",
    "since @xmath261 are obtained by applying affine transformations to the strata of ( [ eqnonegdef - stratification ] ) , they form whitney stratifications of @xmath262    the final step in stratifying @xmath263 is to verify that these stratifications intersect transversely . for this , it suffices to show that for any @xmath264 such that @xmath265 , a matrix @xmath266 and nonzero matrix @xmath267 , there exist smooth paths @xmath268 , @xmath269 with @xmath270 such that for any @xmath271 , @xmath272    based on the fact that the group action above preserves rank , the problem of finding the paths @xmath273 is equivalent to defining them by @xmath274 and finding appropriate invertible matrices @xmath275 .    even under the restriction",
    "@xmath276 a solution exists . substitution in ( [ eq3 ] ) gives @xmath277 which is equivalent to @xmath278    for small @xmath19 , define @xmath279 to be the unique positive definite square root of @xmath280 . substituting @xmath279 in ( [ eq4 ] ) and ( [ eq5 ] ) defines , for small @xmath281 , the required paths @xmath282 , @xmath283 , and proves transversality .",
    "the transversality of the intersections , together with the stratifications in ( [ eq9 ] ) , yield the whitney stratification @xmath284 where @xmath285 .",
    "that is , we have found that the partition of @xmath263 according to the geometrical multiplicity of @xmath286 and @xmath287 is a whitney stratification .",
    "note for later use that the submanifold of @xmath288 of matrices of rank @xmath289 , and thus @xmath290 and @xmath291 , are of codimension @xmath292 .",
    "since , for @xmath264 with @xmath265 , @xmath293 and @xmath291 intersect tranversely , the codimension of @xmath294 is @xmath295/2 $ ] .",
    "having computed the riemannian metric on @xmath144 , in order to apply theorem  [ decompositiontheorem ] to the rotation space random field on @xmath170 , we first explicitly compute @xmath296 , that is , the density with respect to the lebesgue measure on @xmath144 when viewed as @xmath297 via the choice of a basis for the hilbert ",
    "schmidt inner product on @xmath298 .    before turning to the calculation",
    "we need some notation .",
    "denote the standard basis of @xmath288 by @xmath299 . normalizing the elements @xmath300 with @xmath301 by a factor of @xmath302 yields an orthonormal basis relative to the hilbert ",
    "schmidt inner product which we denote by @xmath303 .    working with",
    "the chart defined by mapping a matrix to its coordinates relative to @xmath304 , we see that the density is given by @xmath305 where @xmath306 is obtained by vectorizing @xmath307 .",
    "as already stated in section  [ puttogethersubsec ] , for any @xmath308 , the mapping @xmath166 is a riemannian isometry of @xmath309 , and thus preserves the measure @xmath310 .",
    "clearly , it also preserves the euclidean hausdorff measure @xmath311 .",
    "therefore , the density in ( [ eqdensity ] ) is invariant under @xmath166 as well .",
    "since any real symmetric matrix is orthogonally diagonalizable , it follows that the density only depends on the eigenvalues of @xmath68 .",
    "it is therefore sufficient to compute it for diagonal matrices .",
    "let @xmath312 .",
    "for any two basis elements of @xmath304 , @xmath313    suppose we order the basis in such a way that its first @xmath6 elements are @xmath314 .",
    "then , the corresponding @xmath315 matrix has the form @xmath316 where @xmath317 .    by inspection ,",
    "this is a rank - one perturbation of a diagonal matrix .",
    "now , for a diagonal matrix @xmath63 and vector @xmath3 , @xmath318 , which , when applied in this setting , yields @xmath319 where @xmath320 is defined in ( [ eqdefck ] ) . by the argument above , for general @xmath321 , @xmath322      rewriting the integral defining @xmath323 , ( [ eqfdef ] ) , in terms of the density @xmath324 , gives a relatively complicated integral .",
    "fortunately , there is a simple way to convert it to an integral against a simpler density and , more importantly , over a much simpler domain .",
    "to do this , we need first to recall a classical result from the theory of random matrices .    the starting point of the computation of the joint density of the eigenvalues in the gaussian orthogonal ensemble ( goe ) model ( cf .",
    "@xcite ) is similar to our situation .",
    "we begin with a measure @xmath325 on @xmath288 with density ( relative to @xmath326 ) that depends strictly on the eigenvalues . the goal is to compute the density of the push - forward of @xmath325 , denoted by @xmath327 , under the mapping @xmath328 which maps a matrix to the vector composed of its ordered eigenvalues .    in the case of the goe ,",
    "the density of @xmath325 is simply the product of the densities of the independent entries of the ( real symmetric ) random matrix .",
    "the entries of the matrix are zero - mean gaussian variables with variance @xmath329 on the diagonal and variance @xmath330 off the diagonal .",
    "that is , @xmath331 where the factor of @xmath332 comes from the fact that @xmath326 was defined via identification with the hilbert ",
    "schmidt basis and not the standard basis of symmetric matrices .",
    "the classical result is that @xmath333 where @xmath158 is the lebesgue measure on @xmath334 and @xmath335 is the vandermonde determinant .",
    "the specific gaussian nature of @xmath325 has only a limited role to play in this result , and all that is relevant for our needs is that the density is determined by @xmath336 at each point .",
    "in fact , for any measure @xmath337 with such a density , we can write @xmath338 and rely on the goe argument to conclude that , for the corresponding push - forward measure @xmath339 , @xmath340 where @xmath325 and @xmath327 are the measures corresponding to the goe model .    in particular , denoting the push - forward of @xmath341 by @xmath342 by @xmath116",
    "gives @xmath343      in view of theorem  [ decompositiontheorem ] , having computed the density @xmath344 , the computation of @xmath345 simply becomes a matter of rewriting the integral of @xmath346 in terms of eigenvalues .",
    "doing so leads to @xmath347    we now turn to @xmath348 , for which an identical argument yields @xmath349    it remains to evaluate @xmath350 .",
    "although this depends on @xmath351 , we shall not have to study this measure directly in order to compute the integral .",
    "rather , an application of federer s coarea formula @xcite with a carefully chosen map will suffice .    for any @xmath352 define @xmath353 to be the set of real , symmetric matrices with unique minimal eigenvalue and with all eigenvalues in @xmath354 .",
    "consider the smooth mapping @xmath355 which maps a matrix to its minimal eigenvalue . to apply the coarea formula , we need a riemannian structure on the domain and range of @xmath356 . for the domain",
    "we take @xmath309 as the riemannian metric , and on @xmath357 consider the euclidean metric .",
    "now , fix some @xmath352 .",
    "let @xmath358 and write @xmath359 with @xmath308 , @xmath360 diagonal and @xmath361 ordered so that @xmath362 .",
    "defining @xmath363 , @xmath364 forms a basis of @xmath365 .",
    "let @xmath366 be the orthogonal projection onto @xmath367 let @xmath368 be an orthonormal basis of @xmath369 relative to @xmath309 , such that for all @xmath370 with @xmath371 , @xmath372 , and such that , denoting @xmath373 , @xmath374 with @xmath173 given in ( [ eqdefdk ] ) .",
    "the last equality follows from a page or two of calculus , using the projection formula of @xcite , page 173 , and the sherman - morrison formula ( see @xcite , section 2.7.1 ) .",
    "since the basis is orthonormal , the jacobian can be expressed by @xmath375^{1/2}.\\ ] ]    note that if we can show that @xmath376 is zero for any @xmath371 , then it will follow that @xmath377 in order to show this , and also compute this value , we examine the eigenvalues of @xmath378 , for small @xmath19 .",
    "write @xmath379 and note that therefore we can work with the eigenvalues of @xmath380 instead .",
    "when @xmath381 , @xmath382 is diagonal with eigenvalues @xmath383 . when @xmath301 , @xmath382 also takes a very simple form , with eigenvalues @xmath384 therefore , @xmath385 which implies @xmath386 . finally , federer s coarea formula gives @xmath387 since the integral on @xmath388 is continuous in @xmath389 , differentiating by @xmath390 yields @xmath391 where the second equality is implied by the fact that any point of @xmath392 is a boundary point or has zero density and the last equality follows by writing the integral as an iterated integral and differentiating .",
    "obviously , we can also consider the maximal eigenvalue , define @xmath393 and @xmath394 accordingly , and carry out a similar computation .",
    "combined with the last result and the fact that @xmath395 , we can compute the final term needed to complete the proof : @xmath396 & & \\qquad = \\int_{\\partial_{k-1}\\mathbb{s } ( \\sigma _ { 2}^{-2},\\sigma_{1}^{-2 } ) } { \\vert}s{\\vert}^ { { 1}/{2}}\\,d \\mathcal{h}_{k-1}^{\\mathbb{s } ( \\sigma_{2}^{-2},\\sigma _ { 1}^{-2 } ) } ( s ) \\\\[-2pt ] & & \\qquad = \\frac{c_{k , n}}{d_{k , n}}\\int_{\\sigma_{2}^{-2}\\leq\\lambda _ { 1}\\leq\\cdots\\leq\\lambda_{n-1}\\leq\\sigma_{1}^{-2}}\\bigl{\\vert}\\triangle ( \\lambda ) \\bigr{\\vert}\\\\[-2pt ] & & \\hspace*{120.4pt}\\qquad\\quad { } \\times \\prod_{j=1}^{n-1 } \\lambda_{j}^{-{n}/{2}}\\biggl[\\sigma_{2}^{n-2}\\prod _ { j=1}^{n-1}\\bigl{\\vert}\\lambda_{j}- \\sigma_{2}^{-2}\\bigr{\\vert}\\\\[-2pt ] & & \\qquad\\quad\\hspace*{186pt } { } + \\sigma_{1}^{n-2 } \\prod_{j=1}^{n-1}\\bigl{\\vert}\\sigma_{1}^{-2}-\\lambda_{j}\\bigr{\\vert}\\biggr]\\,d \\lambda.\\end{aligned}\\ ] ]",
    "in this section we shall compute _ all _ the lipschitz  killing curvatures for the scale space random field , under the assumptions of section  [ scalespacesubsec ] on the kernel @xmath23 and of section [ regularitysubsec ] on the parameter space @xmath20 .",
    "also , we require only that @xmath23 satisfy ( [ ecscaledequn ] ) , and not full rotational symmetry .    in the final analysis , the formulae that we shall obtain are quite simple .",
    "they involve no more than the euclidean lipschitz  killing curvatures of @xmath20 , the parameters @xmath47 and @xmath42 of ( [ ecscaledequn ] ) and ( [ ecscale - variancesequn ] ) , and combinatorial coefficients .",
    "on the other hand , there are many elements to each formula , so that any explicit computation of them will involve a computer .",
    "thus , we shall proceed by setting out two general formulae([eqdefcurvaturemeasureonetubes ] ) and ( [ ecsumoflsequn])and then in section  [ scalelkcssubsubsec ] list explicit expressions for each of the summands in these formulae . putting it all together to get actual numbers",
    "is a simple computing exercise .    as for the two leading lipschitz  killing curvatures , simple algebra shows that the results of this section coincide with those of corollary  [ corscale ] .    for notational convenience in what follows",
    ", we make the simple scale transformation @xmath397 , so that our random field is now denoted by @xmath398 and has covariance function @xmath399 the parameter space of @xmath4 , which we shall denote by @xmath5 , is now of the form @xmath400\\subset\\real^{n+1}$ ] , for some @xmath401 .",
    "we start by stratifying the parameter space @xmath5 into manifolds of common dimension . in particular , we write the @xmath402-dimensional parameter space @xmath403 $ ] as the disjoint union of four types of pieces , arranged in three strata , according to their dimension ( recall that @xmath20 has a smooth boundary @xmath404 ) : @xmath405      ultimately , we need to compute the lipschitz  killing curvatures @xmath406 of @xmath5 under the riemannian metric induced by the random field @xmath4 . rather than doing this directly",
    ", we shall compute certain other curvatures , denoted by @xmath407 , specifically designed to be simpler to handle on sets of constant curvature .",
    "( we shall soon see that @xmath5 has constant curvature , given by  @xmath408 . )",
    "there are simple relationships between the @xmath406 and @xmath407 , including the following one , which is ( 10.5.12 ) of  @xcite : @xmath409    to compute the @xmath407 themselves , we first write @xmath410 and then restrict ourselves to the case @xmath411 . applying ( 10.7.10 ) in @xmath412 . ] of  @xcite along with the (",
    "yet to be proven ) fact that @xmath5 has constant curvature @xmath408 gives that , for @xmath413 , @xmath414\\\\[-8pt ] & & \\qquad = \\frac { 1}{(2\\pi)^{(j - i)/2}(j - i ) ! } \\int_{\\partial_jm } \\e \\bigl\\ { { \\operatorname{tr}}^{t_t\\partial_jm}\\bigl({s}_{z_{j , t}}^{j - i}\\bigr ) \\indic_{n_tm}(z_{j , t } ) \\bigr\\ } { { \\cal h}}_j(dt ) .",
    "\\nonumber\\end{aligned}\\ ] ] here , for each @xmath415 , @xmath416 is a normally distributed random vector of dimension @xmath417 in the space @xmath418 , the orthogonal complement of @xmath419 in @xmath420 , @xmath68  is the riemannian shape operator of @xmath5 , @xmath421 is the normal cone to @xmath5 at @xmath19 , and @xmath422 is the volume measure on @xmath106 corresponding to the riemannian metric induced by the random field @xmath4 .",
    "the next step is to compute each element in ( [ eqcurvaturemeasuresgaussiangeneral ] ) .",
    "the next step is to identify the riemannian metric @xmath124 that the random field induces on @xmath5 . in order to describe this , however , we need first to choose a family of vector fields generating the tangent bundle of @xmath5 .",
    "we do this sequentially , starting with the set @xmath20 , ignoring for the moment the scale component of the parameter space . for @xmath20 ,",
    "let @xmath423 be the ( euclidean ) outward unit normal vector field on @xmath189 , and extend this to a full ( euclidean ) @xmath78 , orthonormal tangent vector bundle @xmath424 , on @xmath20 , with @xmath425 .",
    "enlarge this to a vector bundle on all of @xmath5 by adding the vector field @xmath426 , the field of tangent vectors in the scale direction .",
    "the riemannian metric @xmath124 at points @xmath427 can now be calculated on pairs of vectors from the above vector field using the variances ( [ ecscale - variancesequn ] ) and ( [ ecscale - variances2equn ] ) and the independence discussed there .",
    "these yield @xmath428 where @xmath429 is the kronecker delta .",
    "we note , once again , that ( [ ecrm2equn ] ) implies that the metric @xmath124 is actually of product form is essential to all that follows .",
    "note that the above three equations also imply that the structure of the normal cones to @xmath5 is well described by the initial , euclidean , choice of vector fields .",
    "there is , of course , no normal cone at points @xmath430 , the interior of @xmath5 . for the sets in @xmath111 , one of the vector fields @xmath423 and @xmath327 describes the normal geometry . in particular , along the side the normal is an @xmath431-dependent multiple of @xmath423 and along the top and bottom the normals are constant multiples of @xmath327 .",
    "along @xmath432 all normals are linear combinations of elements in the vector fields @xmath423 and @xmath327 .",
    "the next step involves computing the second fundamental forms in ( [ eqcurvaturemeasuresgaussiangeneral ] ) and so requires identifying the levi - civita connections .",
    "if we think of @xmath5 as embedded in a smooth open subset of @xmath420 , with the same induced metric , then we shall write @xmath433 for the levi - civita connection on @xmath5 and @xmath434 for the levi - civita connection on the ambient set .    for our purposes",
    ", we need only to know how @xmath435 operates on vectors normal to  @xmath5 . furthermore , since the lie bracket @xmath436 = 0\\qquad \\mbox{for all }   1 \\leq i \\leq n,\\ ] ] we need only compute @xmath437 , @xmath438 and @xmath439 .    to start , note that a straightforward application of koszul s formula [ which in the current situation simplifies to @xmath440 and ( [ ecrm1equn ] ) and ( [ ecrm2equn ] ) imply , for @xmath441 , that @xmath442 where @xmath433 is the standard euclidean connection , and @xmath443 now note that for any tangent vectors @xmath205 to @xmath20 , @xmath444 is a vector in @xmath420 , and so can be written as @xmath445 for appropriate coefficients .",
    "this fact , together with the last two equalities and ( [ ecrm3equn ] ) , implies that for any two vector fields @xmath446 on @xmath20 , @xmath447 giving us the first computation .",
    "as far as @xmath448 is concerned , note first that another easy consequence of koszul s formula is that @xmath449 giving us @xmath450 .",
    "all that remains is to compute @xmath451 .",
    "an application of the weingarten equation [ i.e. , the scalar second fundamental form is given by @xmath452 and ( [ ecconnection1equn ] ) yield @xmath453 and @xmath454 applying now the torsion freeness of connections ( i.e. , @xmath455 = 0 $ ] ) , along with ( [ ecxinuzeroequn ] ) to the above , gives @xmath456 and we have the last of the three cases we were seeking .",
    "with the relevant connections determined , we can now turn to computing second fundamental forms and curvature matrices along the three stratifications of @xmath5 .",
    "@xmath457 , _ the interior @xmath458 _ : since the normal space in the interior is empty , there are no normals , no second fundamental form and no curvature matrix here .    \\2 .",
    "@xmath111 : _ the side @xmath459 _ : a convenient choice for an orthonormal ( in the metric @xmath124 ) basis for the tangent space at any point on the side is given  by=-1 @xmath460=0 with outward unit normal vector @xmath461 .",
    "the scalar second fundamental forms of interest are therefore @xmath462 all of which can be computed directly using weingarten s equation and ( [ ecconnection1equn])([eqmixedconnection ] ) .",
    "we summarize them in a curvature matrix , writing @xmath463 where @xmath464 is the @xmath465 euclidean curvature matrix of @xmath189 in the basis @xmath466 .",
    "recall for later use that , from section 7.2 of  @xcite , in the current scenario , the trace in ( [ eqcurvaturemeasuresgaussiangeneral ] ) can be replaced by @xmath467 where @xmath468 is our usual sum of determinants of @xmath469 principal minors .",
    "@xmath111 , _ the bottom @xmath470 and the top @xmath471 _ : starting with the bottom @xmath472 , the outward unit normal vector is @xmath473 , and a convenient orthonormal basis is given by @xmath474 .",
    "the curvature matrix is therefore @xmath475 with entries @xmath476 by weingarten s equation and ( [ ecconnection0equn ] ) .",
    "thus , for the bottom , the outward curvature matrix is @xmath477 , while along the top the same arguments give it as @xmath478 .",
    "@xmath479 : _ the edges @xmath480 and @xmath481 _ : for the edges , we need to consider the scalar second fundamental form itself and not just the curvature matrix . as",
    "above , an orthonormal basis for the tangent space is @xmath482 , but now an orthonormal basis for the normal space is @xmath483 .    applying the weingarten equation , we need to compute @xmath484 for arbitrary @xmath485 . applying ( [ ecconnection1equn ] )",
    "gives that this is @xmath486 , where , with a minor abuse of notation , we now use @xmath464 to denote the @xmath465 euclidean curvature matrix of @xmath487 at @xmath19 .",
    "we now have all the pieces we need to compute the lipschitz  killing curvatures @xmath488 , and could actually proceed to the final computation . however , in justifying the formula ( [ eqcurvaturemeasuresgaussiangeneral ] ) , we used the fact that @xmath5 has constant negative curvature @xmath408 .",
    "now we shall take a moment to prove this .",
    "let @xmath489}$ ] be the curvature operator . from previous calculations of the connection @xmath490 & = & \\widetilde{\\nabla}_{x_i}x_k - \\widetilde { \\nabla}_{\\nu } \\bigl(\\nabla_{x_i}x_k - \\delta_{ik } \\kappa^{-1 } \\gamma e^{2s } \\nu\\bigr ) \\\\[-2pt ] & = & \\nabla_{x_i}x_k - \\delta_{ik } \\kappa^{-1 } \\gamma e^{2s } \\nu- \\nabla_{x_i}x_k + \\delta_{ik } \\kappa^{-1 } \\,\\frac{\\partial}{\\partial s } \\gamma e^{2s } \\nu \\\\[-2pt ] & = & \\delta_{ik } \\kappa^{-1}\\gamma e^{2s } \\nu , \\\\[-2pt ] r(x_i , \\nu)\\nu&= & \\widetilde{\\nabla}_{x_i } \\widetilde { \\nabla}_{\\nu } \\nu- \\widetilde{\\nabla}_{\\nu } \\widetilde { \\nabla}_{x_i}\\nu \\\\[-2pt ] & = & - \\widetilde{\\nabla}_{\\nu}x_i \\\\[-2pt ] & = & -x_i , \\\\[-2pt ] r(x_i , x_j)\\nu&= & \\widetilde{\\nabla}_{x_i } \\widetilde{\\nabla } _",
    "{ x_j}\\nu- \\widetilde{\\nabla}_{x_j } \\widetilde{\\nabla}_{x_i}\\nu- \\widetilde{\\nabla}_{[x_i , x_j]}\\nu \\\\[-2pt ] & = & \\widetilde{\\nabla}_{x_i}x_j - \\widetilde { \\nabla}_{x_j}x_i - [ x_i , x_j ] \\\\[-2pt ] & = & \\nabla_{x_i}x_j - \\nabla_{x_j}x_i - [ x_i , x_j ] - \\kappa^{-1}\\gamma e^{2s } ( \\delta_{ij } - \\delta_{ji } ) \\nu \\\\[-2pt ] & = & 0 , \\\\[-2pt ] r(x_i , x_j)x_k & = & \\widetilde { \\nabla}_{x_i}\\widetilde{\\nabla } _ { x_j}x_k - \\widetilde{\\nabla}_{x_j}\\widetilde{\\nabla}_{x_i}x_k - \\widetilde{\\nabla}_{[x_i , x_j]}x_k \\\\[-2pt ] & = & \\widetilde{\\nabla}_{x_i } \\bigl(\\nabla_{x_j}x_k - \\delta_{jk } \\kappa^{-1 } \\gamma e^{2s } \\nu\\bigr ) - \\widetilde{\\nabla}_{x_j } \\bigl(\\nabla_{x_i}x_k - \\delta_{ik } \\kappa^{-1}\\gamma e^{2s } \\nu\\bigr ) \\\\[-2pt ] & & { } - \\nabla_{[x_i , x_j]}x_k + \\kappa^{-1}\\gamma e^{2s } \\bigl\\langle[x_i , x_j ] , x_k \\bigr\\rangle\\nu \\\\[-2pt ] & = & \\nabla_{x_i } \\nabla_{x_j}x_k - \\delta_{jk } \\kappa^{-1}\\gamma e^{2s } x_i - \\kappa^{-1 } \\gamma e^{2s } \\langle \\nabla_{x_j}x_k , x_i \\rangle\\nu \\\\[-2pt ] & & { } - \\nabla_{x_j } \\nabla_{x_i}x_k + \\delta_{ik } \\kappa^{-1 } \\gamma e^{2s } x_j - \\kappa^{-1 } \\gamma e^{2s } \\langle \\nabla_{x_i}x_k , x_j \\rangle\\nu \\\\[-2pt ] & & { } - \\nabla_{[x_i , x_j]}x_k + \\kappa^{-1}\\gamma e^{2s } \\bigl\\langle[x_i , x_j ] , x_k \\bigr\\rangle\\nu \\\\[-2pt ] & = & \\nabla_{x_i } \\nabla_{x_j}x_k - \\nabla_{x_j } \\nabla_{x_i}x_k - \\nabla_{[x_i , x_j]}x_k \\\\[-2pt ] & & { } + \\kappa^{-1}\\gamma e^{2s } \\nu \\bigl ( \\bigl \\langle[x_i , x_j ] , x_k \\bigr\\rangle- \\langle \\nabla_{x_j}x_k , x_i \\rangle+ \\langle \\nabla_{x_i}x_k , x_j \\rangle \\bigr ) \\\\[-2pt ] & & { } - \\delta_{jk } \\kappa^{-1}\\gamma e^{2s } x_i + \\delta_{ik } \\kappa^{-1}\\gamma e^{2s } x_j \\\\[-2pt ] & = & - \\delta_{jk } \\kappa^{-1}\\gamma e^{2s } x_i + \\delta_{ik } \\kappa^{-1}\\gamma e^{2s } x_j,\\end{aligned}\\ ] ] the last equality following from the flatness of @xmath420 and torsion freeness .",
    "since the curvature tensor is given by @xmath491 , it is now easy to use the above calculations to check cases and see that @xmath492 where @xmath28 is the identity form given by @xmath493 , and with the usual tensor product @xmath494 .",
    "from this follows our claim that @xmath5 is a space of constant curvature @xmath408 .",
    "with all the preparation done , we can now begin the computation of the lipschitz  killing curvatures @xmath495 , according to their definition in ( [ eqcurvaturemeasuresgaussiangeneral ] ) .",
    "as in the discussion of second fundamental forms , we divide the computation into separate sections , each corresponding to a different stratum in the stratification of @xmath5 .    throughout the following computation we take @xmath496 and @xmath497 to be two independent @xmath498 random variables .",
    "we shall associate the @xmath499 with the normal vector fields to obtain normal vectors of the form @xmath500 .",
    "we also adopt the notation @xmath501\\\\[-9pt ] & = & \\cases{\\displaystyle   \\frac{1}{2 } , & \\quad if $ k=0 $ , \\vspace*{2pt}\\cr \\displaystyle \\frac{2^{n-1}n!}{\\sqrt{2\\pi } } , & \\quad if $ k=2n+1 $ is odd , \\vspace*{2pt}\\cr \\displaystyle \\frac{(2n-1)(2n-3)\\cdots}{2 } , & \\quad if $ k=2n$ is even.}\\nonumber\\end{aligned}\\ ] ]    \\1 .",
    "@xmath457 , _ the interior @xmath502 _ : since the second fundamental form is zero in @xmath457 , the only nonzero lipschitz  killing curvature occurs when @xmath503 in ( [ eqcurvaturemeasuresgaussiangeneral ] ) . in this case",
    "@xmath504 & = & \\kappa^{1/2 } \\gamma^{n/2 } \\int_{s_1}^{s_2 } \\int_{{t}^{\\circ } } e^{ns } \\,dt \\,ds \\\\[-2pt ] & = & \\kappa^{1/2 } \\gamma^{n/2 } \\frac{e^{ns_2 } - e^{ns_1}}{n } { { \\cal l}}_n^e\\bigl(t ; { t}^{\\circ}\\bigr ) , \\nonumber\\end{aligned}\\ ] ] where @xmath505 is computed in the standard euclidean sense .",
    "@xmath111 : _ the side @xmath506 _ : for this case , all the lipschitz  killing curvatures need to be computed , and we replace the trace in ( [ eqcurvaturemeasuresgaussiangeneral ] ) by the determinants of the curvature matrix as in ( [ ectrace - detequn ] )",
    ". then @xmath507 & & \\qquad = ( 2\\pi)^{-(n - j)/2 } \\ee \\bigl\\{z_2^{n - j } \\indic_{\\{z_2 > 0\\ } } \\bigr\\ } \\nonumber\\\\ & & \\qquad\\quad { } \\times\\int_{(s_1,s_2 ) \\times\\partial t } { \\operatorname{detr}}_{n - j } \\pmatrix { e^{-s } c_t & 0 \\cr 0 & 0 } \\,d{{\\cal h}}_n(s , t ) \\nonumber\\\\[-9pt]\\\\[-9pt ] & & \\qquad = ( 2\\pi)^{-(n - j)/2 } \\kappa^{1/2}\\ee \\bigl \\{z_2^{n - j}\\indic_{\\{z_2 > 0\\ } } \\bigr\\ } \\nonumber\\\\[-2pt ] & & \\qquad\\quad { } \\times\\int_{s_1}^{s_2 } \\int _ { \\partial t } \\bigl(\\gamma^{-1/2}e^{-s } \\bigr)^{n - j } \\bigl(\\gamma^{1/2}e^s \\bigr)^{n-1 } { \\operatorname{detr}}_{n - j}(c_t ) \\,dt",
    "\\,ds \\nonumber\\\\[-2pt ] & & \\qquad = \\kappa^{1/2}\\gamma^{(j-1)/2 } \\frac { e^{(j-1)s_2}-e^{(j-1)s_1}}{j-1 } { { \\cal l}}^e_{j-1}(t ; \\partial t)\\nonumber\\end{aligned}\\ ] ] in a parallel notation to ( [ eclkckappa1equn ] ) .",
    "@xmath111 , _ the bottom @xmath508 and the top @xmath471 _ : beginning with the bottom , @xmath472 , for @xmath509 we have @xmath510 & & \\qquad = ( 2\\pi)^{-(n - j)/2 } \\ee \\bigl\\{z_1^{n - j } \\indic_{\\{z_1 > 0\\ } } \\bigr\\ } \\nonumber\\\\[-9pt]\\\\[-9pt ] & & \\qquad\\quad { } \\times\\int_{\\{s_1\\ } \\times { t}^{\\circ } } { \\operatorname{detr}}_{n - j } \\bigl ( \\kappa^{1/2}i_{n \\times n } \\bigr ) \\,d{{\\cal h}}_{n}(t ) \\nonumber \\\\[-2pt ] & & \\qquad = \\bigl(2\\pi\\kappa^{-1}\\bigr)^{-(n - j)/2 } \\mu_{n - j } \\pmatrix{n \\cr j } \\gamma^{n/2 } e^{ns_1 } { { \\cal l}}_n^e\\bigl(t ; { t}^{\\circ}\\bigr).\\nonumber\\end{aligned}\\ ] ] a similar result holds for the top , @xmath471 , namely , @xmath511\\\\[-9pt ] & & \\qquad = ( -1)^{n - j}\\bigl(2\\pi\\kappa^{-1 } \\bigr)^{-(n - j)/2 } \\mu_{n - j } \\pmatrix{n \\cr j } \\gamma^{n/2 } e^{ns_2}{{\\cal l}}_n^e\\bigl(t ; { t}^{\\circ } \\bigr).\\nonumber\\end{aligned}\\ ] ]    \\4 .",
    "@xmath479 : _ the edges @xmath480 and @xmath481 _ : we start with the top edge , @xmath481 , @xmath512 & & \\qquad = ( 2\\pi)^{-(n-1-j)/2 } \\\\[-2pt ] & & \\qquad\\quad{}\\times\\int_{\\{s_2\\ } \\times\\partial t } \\ee \\bigl\\ { { \\operatorname{detr}}_{n-1-j}\\bigl ( z_1 \\kappa^{-1/2 } i - z_2 \\gamma^{-1/2}e^{-s } c_t \\bigr ) \\\\[-2pt ] & & \\hspace*{161pt}\\qquad\\quad { } \\times\\indic_{\\{z_1 > 0\\ } } \\indic_{\\{z_2 > 0\\ } } \\bigr\\ } \\,d { { \\cal h}}_{n-1}(s , t).\\end{aligned}\\ ] ] use now the easily checked expansion that , for @xmath513 , @xmath514 to expand the @xmath515 term in the expectation above and see that @xmath516 & & \\qquad = ( 2\\pi)^{-(n-1-j)/2 } \\nonumber\\\\[-2pt ] & & \\qquad\\quad{}\\times\\sum_{m=0}^{n-1-j } \\kappa^{-(n-1-j - m)/2 } \\pmatrix{n-1-m \\cr j } \\nonumber\\\\[-2pt ] & & \\hspace*{40pt}\\qquad\\quad { } \\times\\ee \\bigl\\{z_1^{n-1-j - m } \\indic_{\\{z_1 > 0\\ } } \\bigr\\ } \\bigl(\\gamma^{1/2 } e^{s_2 } \\bigr)^{n-1 } \\ee \\bigl\\{z_2^{m } \\indic_{\\{z_2 > 0 \\ } } \\bigr\\ } \\nonumber\\\\[-2pt ] & & \\hspace*{40pt}\\qquad\\quad { } \\times\\int_{\\partial t } { \\operatorname{detr}}_{m}\\bigl ( \\gamma^{-1/2}e^{-s_2}c_t\\bigr ) \\,d { { \\cal h}}_{n-1}(t ) \\nonumber\\\\[-9pt]\\\\[-9pt ] & & \\qquad = \\bigl(2\\pi\\kappa^{-1}\\bigr)^{-(n-1-j)/2}\\nonumber\\\\[-2pt ] & & \\qquad\\quad{}\\times \\sum _ { m=0}^{n-1-j } \\bigl(\\gamma^{1/2}e^{s_2 } \\bigr)^{n-1-m}\\pmatrix{n-1-m \\cr j } \\kappa^{m/2 } \\nonumber\\\\[-2pt ] & & \\hspace*{40pt}\\qquad\\quad { } \\times\\mu_{n-1-j - m } \\ee\\bigl\\{z_2^{m }",
    "\\indic_{\\ { z_2 > 0 \\}}\\bigr\\ } \\int_{\\partial t } { \\operatorname{detr}}_{m}(c_t ) \\,d{{\\cal h}}_{n-1}(t ) \\nonumber\\\\[-2pt ] & & \\qquad = \\kappa^{(n-1-j)/2 } \\bigl(\\gamma^{1/2}e^{s_2 } \\bigr)^{n-1 } \\nonumber\\sum_{m=0}^{n-1-j } \\pmatrix{n-1-m \\cr j } \\bigl(\\gamma^{-1/2}e^{-s_2 } \\kappa^{1/2}\\bigr)^m\\\\[-2pt ] & & \\hspace*{139pt}\\qquad\\quad { } \\times \\mu_{n-1-j - m } { { \\cal l}}^e_{n-1-m}(t ; \\partial t).\\nonumber\\end{aligned}\\ ] ]    a similar argument also works for the bottom edge @xmath517 , the only change being that @xmath518 becomes @xmath519 , giving the final form @xmath520 & & \\qquad = \\kappa^{(n-1-j)/2 } \\bigl(\\gamma^{1/2}e^{s_1 } \\bigr)^{n-1 } \\nonumber\\\\[-9pt]\\\\[-9pt ] & & \\qquad\\quad{}\\times\\sum_{m=0}^{n-1-j } \\pmatrix{n-1-m \\cr j } \\bigl(\\gamma^{-1/2}e^{-s_1 } \\kappa^{1/2}\\bigr)^m \\nonumber\\\\[-2pt ] & & \\hspace*{41.5pt}\\qquad\\quad { } \\times(-1)^{n-1-j - m } \\mu_{n-1-j - m } { { \\cal l}}^e_{n-1-m}(t ; \\partial t ) .",
    "\\nonumber\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> we provide a new approach , along with extensions , to results in two important papers of worsley , siegmund and coworkers closely tied to the statistical analysis of fmri ( functional magnetic resonance imaging ) brain data . </S>",
    "<S> these papers studied approximations for the exceedence probabilities of scale and rotation space random fields , the latter playing an important role in the statistical analysis of fmri data . the techniques used there came either from the euler characteristic heuristic or via tube formulae , and to a large extent were carefully attuned to the specific examples of the paper .    </S>",
    "<S> this paper treats the same problem , but via calculations based on the so - called gaussian kinematic formula . </S>",
    "<S> this allows for extensions of the worsley  siegmund results to a wide class of non - gaussian cases . </S>",
    "<S> in addition , it allows one to obtain results for rotation space random fields in any dimension via reasonably straightforward riemannian geometric calculations . </S>",
    "<S> previously only the two - dimensional case could be covered , and then only via computer algebra .    by adopting this more structured approach to this particular problem , </S>",
    "<S> a  solution path for other , related problems becomes clearer .    </S>",
    "<S> ,     + </S>"
  ]
}