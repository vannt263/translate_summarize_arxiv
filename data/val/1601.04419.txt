{
  "article_text": [
    "electrocardiology rests upon the study of electric fields generated by the heart . as a physicist one immediately asks : what are the sources of these fields .",
    "this question has two answers .",
    "( i ) on the microscopic scale the sources are @xmath2 and @xmath3 ions and negatively @xmath4 ions and proteins .",
    "but there is no large separation of positive and negative charges .",
    "the membrane of the active cells is able to open channels for the positive ions only , the negative ones remain confined in the cell , the result is a microscopic dipole .",
    "( ii ) on the macroscopic scale , where individual cells can not be resolved , we then have a macroscopic dipole density but no charge density ( monopole ) .",
    "the variation of this dipole density in space and time spreads through the tissue as a propagating wave of depolarization .",
    "if the dipole density as the source is known it is straightforward to calculate the corresponding electric potential which can be measured .",
    "this is the so - called forward problem which in mathematical terms is the solution of poisson s equation .",
    "however , the desired medical information is given by the sources , i.e. by the macroscopic dipole density",
    ". therefore we must solve the inverse problem of calculating the dipole density from potential measurements . in the past",
    "most authors have considered a different inverse problem , namely the determination of the potential near the heart wall from potential measurements in the heart chamber or on the body surface . in this case",
    "no assumption about the sources is made , one solves a boundary - value problem for laplace s equation .",
    "however , the potential near or on the heart wall is a superposition of the fields generated by near and distant active regions . as a consequence the potential only presents a broad and smooth depiction of the local electric activity .    from these arguments",
    "it is clear that the dipole density is better suited for the mapping of complicated arrhythmias than the potential .",
    "one may ask why this approach has not been tried before , to be correct : almost not . there is a pioneering work by a. van oosterom [ 1 ] who always tried to model the sources instead of calculating potentials .",
    "he already discusses the scalar dipole density as a model of cardiac activity under the name `` equivalent double layer model '' ( edl ) .",
    "the reason why other authors did not follow this route may be the fact that the dipole density is harder to obtain than the contact potential at the heart wall , we shall discuss this in the next section . to compute the dipole density requires much better input data .",
    "indeed , four years ago we have made test calculation with data which were collected by the ensite system of st.jude .",
    "the results were unsatisfactory . only the new device from acutus medical inc .",
    "called acqmap system seems to be suited for our purpose .",
    "it has a recording catheter with 48 electrodes plus 48 ultrasound transducers for distance measurements .",
    "it allows determination of the heart chamber geometry and the potential measurements simultaneously at the same time .",
    "this eliminates the error due to the motion of the measuring electrodes and of the heart itself .",
    "the paper is organized as follows . in the next section",
    "we discuss the forward and inverse problems for the dipole density .",
    "we show that the mapping between the dipole density and the potential is a compact integral operator which can well be represented by a finite dimensional matrix .",
    "but its inverse is an unbounded operator .",
    "this has the bad consequence that the inverse problem is a so - called ill - defined problem which requires special techniques of solution .",
    "these facts are illustrated in section 3 by a simple solvable model which we also use to test the general numerical code for solving the inverse problem for the dipole density . in the last section we consider phase mapping which seems to be the suitable technique to map complicated arrhythmias as atrial fibrillation .",
    "we compare the dynamics of phase singularities with the vortex dynamics in 2-dimensional hydrodynamics .",
    "we apply macroscopic electrodynamics in matter to the heart filled with blood . at this point one",
    "usually refers to jackson [ 2 ] and starts from the phenomenological maxwell s equations @xmath5 @xmath6 unfortunately jackson does not make a clear distinction between microscopic electrodynamics in vacuum and macroscopic electrodynamics in matter .",
    "so we prefer the concise book by the first author [ 3 ] and refer to the derivation of the macroscopic maxwell s equations given there .",
    "since the temporal variation of the cardiac fields is slow compared to the propagation of the fields through the body ( with the speed of light ) , we can use the quasi - static approximation and neglect the time derivatives of @xmath7 and @xmath8 .",
    "then by ( 2.1 ) the conduction current @xmath9 is divergence - less @xmath10 and by ( 2.2 ) the electric field is curl - less @xmath11 this implies that the electric field has a scalar potential @xmath12 the blood in the heart is a homogeneous medium with constant conductivity @xmath13 , so that @xmath14 . substituting this into equation ( 2.3 ) yields @xmath15 . then equation ( 2.5 )",
    "implies laplace s equation @xmath16 in the quasi - static approximation the time dependence of the fields has completely disappeared .",
    "one calculates the potential or dipole density at fixed time , and then makes a movie for successive time instants . summing up we describe the heart as a uniform volume conductor [ 4 ] with electric dipole sources in the heart wall .",
    "the laplace equation holds inside the heart chamber filled with blood . in the whole body",
    "the situation is much more complicated .",
    "here we have large inhomogeneities ( lunges and bones ) so that @xmath13 is no longer constant .",
    "if one measures potentials on the body surface ( ecg ) one must construct a detailed model of the body , in order to derive the sources from those data . to avoid this severe problem",
    "we assume that we have a multi - electrode catheter in the heart chamber which measures the potential @xmath17 at various locations . in the heart wall",
    "we have the dipole sources which we assume to be localized on a 2-dimensional surface @xmath18 .",
    "then instead of ( 2.6 ) we have poisson s equation of the form @xmath19 where @xmath20 is the dirac measure on @xmath18 , @xmath21 is the outer normal at point x on the surface and @xmath22 is the surface dipole density ( dipole strength per area ) .",
    "such a source is also called a dipole layer or double layer in electrostatics .",
    "the direction of the dipole moment is normal to the surface s. note that this source describes the @xmath23 dipole density .",
    "the microscopic dipoles can have different directions , but this microscopic structure can hardly be resolved in detail by macroscopic non - contact techniques .",
    "the solution of ( 2.7 ) for @xmath24 is given by the surface integral @xmath25 where @xmath26 is the derivative in the normal direction at point @xmath27 on @xmath18 and @xmath28 is the surface measure .",
    "this integral can be rewritten as follows @xmath29 where @xmath30 is the angle between the vector @xmath31 and the normal @xmath21 [ 5 ] .",
    "if the dipole density @xmath1 is given the calculation of the potential @xmath0 is straightforward , this is the forward problem .",
    "the inverse problem of computing @xmath1 from measured @xmath0 is much harder .",
    "the reason is the following .",
    "the integral operator ( 2.8 ) which maps @xmath1 to the potential @xmath0 is a @xmath32 operator in the mathematical sense .",
    "this important fact must be proved .",
    "* proof : *    here we follow the best mathematical reference we know [ 6 ] .",
    "let the heart wall be a closed smooth surface @xmath18 where the dipole density @xmath1 is located .",
    "this is no serious restriction because at the valves @xmath1 can be put equal to 0 .",
    "let @xmath33 be another smooth closed surface completely inside the blood volume where electrodes are placed to measure the potential @xmath0 .",
    "the dipole density @xmath1 is assumed to be bounded and continuous on @xmath18 .",
    "this implies that @xmath0 is bounded and continuous on @xmath33 , because the kernel in ( 2.9 ) is continuous ( note that @xmath34 and @xmath35 so that we have always @xmath36 ) . as usually let @xmath37 be the banach space of bounded continuous functions on @xmath18 and similarly @xmath38 .",
    "then the integral operator ( 2.9 ) maps @xmath37 on @xmath38 and to simplify the notation we write it as @xmath39 this is a bounded operator @xmath40 with the operator norm @xmath41    to prove that @xmath40 is even compact we must use a decomposition of unity .",
    "this is a sequence of positive continuous functions @xmath42 with compact support on @xmath33 with @xmath43 and the following property : for every compact set @xmath44 the intersection of @xmath45 and the support of @xmath46 is not empty for finitely many @xmath47 , only . since the kernel @xmath48 is uniformly continuous on @xmath49 there exists a decomposition of unity and points @xmath50 in the support of @xmath46 such that @xmath51 for all @xmath35 , @xmath34 and arbitrary @xmath52 .",
    "the approximating integral operator @xmath53 defined by the sum of product kernels in here is clearly compact .",
    "the approximation is in the operator norm because @xmath54 where @xmath55 is the total area of @xmath33 .",
    "this proves that @xmath40 is the limit of a converging sequence of compact operators and , therefore , compact .    *",
    "end of proof.*.    this fact has one good and one bad consequence .",
    "the good one is that compact operators can well be approximated by finite - dimensional matrices . then (",
    "2.9 ) becomes a matrix equation @xmath56 the solution of the inverse problem is then given by the inverse matrix @xmath57 compact operators have infinitely many eigenvalues @xmath58 which accumulate only at 0 , @xmath59 for @xmath60 ( theorem of f.riesz [ 6 ] ) . as a consequence",
    "the approximating matrix @xmath61 in ( 2.14 ) has small eigenvalues and this is unavoidable . in the inverse ( 2.15 ) we then have @xmath62 , so that the corresponding part in the data @xmath63 gets strongly amplified .",
    "this is the ill - posed nature of the inverse problem . to avoid a huge amplification of the noise one must cut off the smallest eigenvalues",
    "this is a convenient regularization method called truncated singular value decomposition ( tsvd ) .",
    "another widely used method of regularization is the one of tikhonov [ 7 ] . to solve the linear equation ( 2.14 )",
    "@xmath64 one considers the variation principle @xmath65 where @xmath66 is a `` regularizing ' ' operator ( mostly @xmath67 ) and @xmath68 is the regularization parameter . putting the variational derivative @xmath69 equal to 0 we obtain the equation @xmath70 where the cross means the adjoint operator . for positive @xmath68 the accumulation of eigenvalues at 0 is removed in the operator on the left .",
    "the latter can be inverted ( the inverse is bounded ) and the dipole density can be computed .",
    "the advantage of this regularization method is that the regularization parameter @xmath68 can be varied continuously .",
    "the optimal choice of @xmath68 is a serious problem which is discussed in the next section . for @xmath67 one",
    "has the first order tikhonov regularization .",
    "the inverse problem of electrocardiology in the standard sense is a voltage to voltage approach where one calculates the potential @xmath71 at points @xmath72 on or near the wall @xmath18 .",
    "if the dipole density @xmath73 is known this is a forward calculation ( 2.9 ) @xmath74 with a new integral operator @xmath75 because @xmath72 is now on or near the surface .",
    "if @xmath72 is on the wall @xmath18 the kernel of @xmath75 has a singularity at @xmath76 .",
    "nevertheless @xmath75 is still compact because it is again the limit of compact operators ( corresponding to a sequence of surfaces @xmath33 converging to @xmath18 from the interior ) . using @xmath77 with the unbounded operator @xmath78 , we can eliminate @xmath73 and get @xmath79 this operator is better behaved than @xmath78 alone , because @xmath75 damps the large eigenvalues of @xmath78 .",
    "therefore the standard voltage inverse problem is easier to solve , which means that less strong regularization is necessary .",
    "but as discussed in the introduction , it gives less precise information on the electrical activity of the heart .",
    "to compare dipole density and potential and test candidate regularization methods , a mathematical model with absolutely known dipole density @xmath1 was defined for which the corresponding potential @xmath0 can be calculated exactly .",
    "this model represents dipole density `` frozen '' at one instant of time .",
    "a simple solvable model is obtained as follows .",
    "let a sphere of radius 1 represent the heart wall ( endocardial surface ) @xmath18 and choose the dipole density applied upon it according to the formula @xmath80 where @xmath81 is the polar angle with respect to the @xmath82-axis , @xmath83 is a positive parameter and @xmath84 a normalization factor .",
    "this distribution is rotationally symmetric around the @xmath82-axis , it has a maximum at the south pole @xmath85 and diminishes toward the north pole .",
    "a large value of the parameter @xmath83 causes the maximum - region on the south pole to be narrow , whereas a small value of @xmath83 causes the maximum - region to be broad .",
    "the normalization factor @xmath84 conveniently scales the density values so that the integral over the unit sphere is equal to 1 : @xmath86    the corresponding voltage @xmath0 for this dipole density can be exactly calculated as follows .",
    "we expand @xmath1 in terms of legendre polynomials @xmath87 with respect to the polar angle @xmath81 using the integral @xmath88 where @xmath89 is the modified spherical bessel function .",
    "then we obtain @xmath90 with @xmath91    on the other hand the kernel in the potential integral ( 2.8 ) can also be expanded in terms of legendre polynomials .",
    "we start from the well - known expansion @xmath92 where @xmath93 , @xmath94 is the angle between the vectors @xmath95 and @xmath27 and @xmath96 .",
    "the normal derivative @xmath97 in ( 2.8 ) on the unit sphere is equal to @xmath98 , hence @xmath99 substituting this into ( 2.8 ) we arrive at @xmath100 a general bounded continuous dipole density on the unit sphere can be expanded in terms of spherical harmonics @xmath101 inserting this into ( 3.8 ) and using the following integral over the angles @xmath102 we get the desired potential in the form @xmath103 this general result can be applied to our rotationally symmetric dipole density ( 3.4 ) which gives the potential everywhere in the unit sphere : @xmath104 with @xmath105 the sum over @xmath106 is rapidly converging so that one can stop at a finite value @xmath107 and gets any desired accuracy .    in figure a we compare @xmath108 and @xmath109 for @xmath110 .",
    "we have normalized both quantities to a maximum value 1 for the purpose of direct comparison .",
    "as we follow both distributions from maximum ( south pole ) toward the minimum ( north pole ) , the voltage has a long rightward tail ( power law ) , compared to the rapid ( exponential ) descent of the dipole density .",
    "this shows clearly the local nature of the dipole density in contrast to the broad distribution of the potential .",
    "next we consider the general numerical code .",
    "the heart wall @xmath18 is covered by a triangular mesh . since we want to have a continuous dipole density @xmath1 we approximate it by piecewise linear functions @xmath111 and zero otherwise . here",
    "@xmath112 , @xmath113 , @xmath114 are the vectors of the corner points of the triangle @xmath115 and det is the @xmath116 determinant of the 3 vectors .",
    "these functions satisfy the condition @xmath117 the unknown dipole density is expanded in the form @xmath118 then the integral equation ( 2.8 ) becomes the following set of linear equations for @xmath119 unknowns @xmath120 @xmath121 where @xmath122    the integral ( 3.18 ) is a sum of integrals over the triangles with corner @xmath21 .",
    "these integrals can be calculated analytically [ 8 ] .",
    "the result for one triangle @xmath115 is equal to @xmath123.\\eqno(3.19)\\ ] ] here @xmath124 @xmath125 and @xmath126 is the normal of the triangle and @xmath127 its absolute value @xmath128 where @xmath129 is the area of the triangle .",
    "the vector @xmath130 is given by @xmath131 with @xmath132 and cyclic @xmath133 .",
    "finally @xmath134 is the solid angle of the triangle subtended at the view point @xmath135 .",
    "a convenient formula for @xmath134 has been given by van oosterom and strackee [ 9 ] .",
    "if we substitute @xmath136 in ( 3.18 ) by 1 , we obtain the so - called gauss - integral which is equal to the solid angle @xmath134 .",
    "since @xmath18 is a closed surface and @xmath135 is in the interior we get @xmath137 .",
    "this leads to the sum rule @xmath138 which holds exactly because the discrete triangulated surface subtends the same solid angle @xmath137 .",
    "the sum rule is an important test of the code , it must be satisfied with machine accuracy . in other words ,",
    "the matrix @xmath139 is a stochastic matrix times @xmath137 , it has an eigenvector @xmath140 with eigenvalue @xmath137 .",
    "unfortunately , it also has very small eigenvalues because it approximates a compact operator .",
    "then the inverse problem requires regularization .",
    "this leads to some error in the resulting dipole density .",
    "we now discuss this essential problem in our solvable model .    to be near reality we define a spherical `` basket '' of radius r=0.5 which we first place concentric with the unit sphere representing the heart wall .",
    "we calculate the exact potential values at 186 evenly distributed points on this basket .",
    "this represents the measured values on an array of electrodes of a basket catheter . finally , we calculate the dipole density on the heart wall ( @xmath141 ) by solving the inverse problem @xmath142 where @xmath143 is a regularized inverse . since we know the exact dipole density we can choose the regularization parameter in an optimal way . using truncated singular - value regularization ( tsvd ) with 110 singular values from total 186",
    "we obtain very good results as shown in figure b plotted in red , compared with the exact dipole density values plotted on the blue curve . the normalized rms error is 0.01 . in the case of real data from living hearts",
    "a good eye of the medical doctor is required to find out the optimal regularization parameter .",
    "if we use tikhonov regularization instead of tsvd we find no statistically significant difference in the resultant calculated dipole density . if the basket is not placed in the center the results get worse , but not dramatically . however using only 48 electrodes instead of",
    "186 gives poor results showing that we have a large discretization error in this case .",
    "the remedy in view of the real situation with the acqmap system is interpolation of the measured potential values . for this interpolation on a triangular surface",
    "the method of oostendorp , van oosterom and huiskamp [ 10 ] is very useful , because it minimizes @xmath144 .",
    "this is the best strategy because the exact potential would satisfy laplace s equation @xmath145 . .",
    "cardiac fibrillation is the main cause of death in the western world .",
    "nevertheless its underlying mechanisms of activation are still poorly understood .",
    "obviously mapping of cardiac potentials is not sensitive enough to improve the situation .",
    "there is considerable hope that dipole density maps can help .",
    "these maps show the amplitude of the dipole density @xmath146 distributed over the heart wall ( @xmath147 ) as a function of time @xmath148 .",
    "but in addition to the amplitude the phase of the dipole density gives important information as it is the case in the phase analysis of electrograms [ 11 - 14 ] ( and references given there ) .    to define the phase , the dipole density @xmath73 is considered as the real part of a complex function whose imaginary part is given by the hilbert transform @xmath149 where @xmath150 stands for the principle value integral .",
    "the phase @xmath151 is then equal to the phase of the complex number @xmath152 , that means @xmath153 if the phase moves out of the interval @xmath154 $ ] it must be continued continuously until the full period @xmath155 $ ] is reached .",
    "this arctan - function is denoted by arctan2 in matlab so that the general definition is @xmath156 in this definition we have assumed that the mean value of @xmath157 over time is zero . by",
    "adding or subtracting @xmath158 , @xmath151 can be made continuous in @xmath148 .",
    "since the phase can be calculated at every point @xmath95 where the dipole density @xmath146 has been determined , we actually get a phase map @xmath159 on the heart wall for every instant @xmath148 .",
    "this map shows singular points where the phase is undetermined .",
    "such a phase singularity is actually a singularity of the gradient of @xmath159 .",
    "in fact , iif we integrate @xmath160 along a closed curve we get zero , except some singularity of the gradient is included .",
    "this is the same situation as in 2-dimensional hydrodynamics where the flow velocity integrated along a closed curve give the circulation which vanishes except a vertex is included . considering @xmath161 as a flow velocity we get a complete hydrodynamical analogy .",
    "we have a potential flow , the phase is the velocity potential . in hydrodynamics",
    "the circulation is conserved in the course of time .",
    "we want to investigate the same property for the phase singularities on the heart wall .",
    "the first observation is that the phase singularities are quantized vortices .",
    "that means the contour integral of @xmath160 ( the circulation ) always has the same value @xmath162 .",
    "studying various phase maps on the heart wall we have found that the vortices always appear in pairs : one with circulation @xmath163 and a second one with circulation @xmath164 .",
    "this shows that the circulation is indeed conserved like in hydrodynamics .",
    "one vortex can not appear or disappear suddenly , it can only annihilate together with a partner of opposite circulation . in the healthy heart",
    "there seems to exist one pair of rather stable vortices only .",
    "the two vortices can be joined by a line where the flow velocity @xmath165 is maximal ( see figure 2 ) .",
    "this line may be considered as the activation front .",
    "the front is most easily found by a jump from @xmath166 to @xmath167 in the phase . during one heart",
    "beat this activation front moves over the heart wall , while its endpoints at the vortices remain more or less fixed .",
    "if some arrhytmia is developed , more and more vortex pairs appear and move around . beside vortices sometimes",
    "sources and perhaps also sinks show up which have a closed activation front . it is clear that the study of this flow dynamics will be an important tool for understanding complicated arrhytmias .     vertices ( black and white ) together with the phase flow .",
    "the black line is the activation front .",
    "laa : left atrial appendage , lspv : left superior pulmonary vein , lipv : left inferior pulmonary vein , rspv : right superior pulmonary vein , ripv : right inferior pulmonry vein , mv : mitral valve . ]",
    "we thank graydon beatty from acutus medical for innumerable elucidating discussions and communication of information .",
    "thanks are also due to other members of the acutus team , in particular min zhu and xinwei shi and , of course , randy werneth .",
    "kuklik p , zeemering s , maesen b , maesson j , crijns hj , verheule s , ganesan an , scotten u , reconstruction of instantaneous phase of unipolar atrial contact electrogram , ieee trans.biomed .",
    "engeneering , 62 , 296 ( 2015 )"
  ],
  "abstract_text": [
    "<S> we discuss the forward and inverse problems between the potential @xmath0 measured in a heart chamber and its sources represented by a dipole density @xmath1 located on the heart wall . </S>",
    "<S> we show that the mapping from @xmath1 to @xmath0 is a compact integral operator . </S>",
    "<S> its inverse is unbounded which makes the inverse problem ill - posed in the mathematical sense . </S>",
    "<S> we investigate methods to solve the inverse problem approximately in view of the mapping of complicated cardiac arrhythmias . </S>",
    "<S> we point out an analogy between phase mapping and 2-dimensional hydrodynamics . </S>"
  ]
}