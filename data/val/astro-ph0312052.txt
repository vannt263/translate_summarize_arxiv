{
  "article_text": [
    "the quest for solutions of dynamical strong gravity problems , such as black hole formation or mergers and gamma - ray burst production , that are astrophysically relevant and accurate enough to predict gravitational wave forms , has occupied much of the last half of the @xmath3 century and beyond .",
    "its history has been frustrated by the need to address several unforeseen numerical problems , including 1 ) proper initial data to begin the evolution , 2 ) the development of coordinate and physical singularities during the evolution , and 3 ) the growth of numerical instabilities in the time - dependent solutions .",
    "these problems have been dealt with by addressing each in turn with such techniques as 1 ) elevation of the initial data problem to a complete sub - field ; 2 ) development and analysis of appropriate gauge / slicing conditions that avoid coordinate singularities ; 3 ) excision of black hole centers , inside horizons , to avoid physical singularities ; and 4 ) the use of symmetric / hyperbolic equations to enhance numerical stability .",
    "one of the several remaining problems in this field is that , for some problems and some coordinate systems , the constraint - violating modes will grow exponentially .",
    "these eventually overwhelm any solution in only a short period of time ( @xmath4 ) , rendering a long simulation ( and the computation of any gravitational wave forms ) impossible .",
    "for very high - resolution simulations the exponential growth of errors begins early and continues until the errors diverge . on the other hand , for simulations with coarse spatial resolution",
    "the errors begin and remain at the truncation level until the much smaller constraint violations grow to a level that exceeds the truncation accuracy .",
    "then the solution joins the general exponential growth seen in the high - resolution simulations , blowing up in much the same manner as in the high - resolution case @xcite .",
    "the similar behavior of this error at a variety of mesh spacings indicates that it may be a numerical solution to the discrete equations that are being integrated .",
    "current attempts to solve this problem include adding the constraints as penalty functions to the evolution equations and techniques that re - converge the constraint equations every few time steps .",
    "constraint propagation is also an issue in the solution of maxwell s equations .",
    "techniques for doing so in the fields of astrophysical magnetohydrodynamics ( mhd ) and electromagnetics of antennas and waves have been in place for decades .",
    "these enforce the constraints not just stably , but _ to machine accuracy_.",
    "finite difference methods for constraint propagation in astrophysical mhd are known as the evans - hawley constrained transport ( ct ) method @xcite and now are an integral part of publicly used codes , such as zeus @xcite and zeus-3d @xcite . in engineering electromagnetics",
    "these are known as the yee algorithm @xcite , and have many variants @xcite .",
    "they all involve building a mesh that is staggered in space , and often in time as well , and then defining appropriate vector and scalar quantities at whole or half mesh points .    while the success of ct for electromagnetics is certainly due in part to the linearity of the physical equations , its ability to maintain accuracy of the solenoidal ( @xmath5 ) and coulomb ( @xmath6 ) constraints , to a few parts in @xmath7 over tens or hundreds of thousands of time steps , is enticing .",
    "if such an algorithm can be found for numerical relativity , it could be as useful as excision and other such proven methods .    in this paper the properties of the electromagnetic ct method ( and of spacetime itself ) are examined , and a similar method is developed for numerical relativity .",
    "it is the thesis of this paper , and subsequent ones in this series , that ct methods work because they build spacetimes in which the temporal and spatial derivatives commute ( @xmath8 = o(\\epsilon_r)$ ] , where @xmath9 is the machine roundoff error ) .",
    "this naturally enforces the bianchi identities , and it is those implicit identities that propagate the constraints . this thesis is not fully tested in this first paper on the subject .",
    "in fact , it will take some time and numerical effort to verify or refute it . instead",
    ", only the first steps are taken here .",
    "it is shown that the proposed ct scheme for nr works exactly in riemann normal coordinates ; in general coordinates most terms also cancel .",
    "detailed numerical simulations in four dimensions will be needed to fully explore the method s stability properties to see if these conditions are sufficient for stable constraint propagation . if successful , however , similar ct methods should be possible for other implementations of numerical relativity , not just for finite differences .",
    "this paper is intended to be the first in a long series that will culminate in a numerical code that is capable of simulating black hole formation and the gamma - ray burst jet generation and gravitational wave production that is expected to result from such events .",
    "these issues are important both for dealing properly with the energetics in the system as well as with the expected observational consequences of the event . in order to treat these problems properly ,",
    "such a code must be capable of evolving the relativistic gravitational field , as well as the fluid matter flowing within that field _ and _ the electromagnetic field generated by currents flowing in that matter .",
    "part of achieving this goal will be to present a consistent numerical method , from the relativistic gravitational field to specific issues of stellar mergers and collapse . in this paper",
    "we lay the groundwork for generating the time - dependent gravitational field and for evolving the electromagnetic field in that metric . in subsequent papers",
    "we will present tests of the constrained transport techniques developed herein , and eventually add the stress - energy due to matter and fluid motion to complete the code . then",
    ", specific astrophysical problems will be addressed .",
    "the ultimate aim of this work is to foster a closer relationship between astronomers who _ observe _ black hole systems and those numerical physicists and astrophysicists who study them _",
    "for astrophysical mhd the field equations that are solved are @xmath10 with the solenoidal constraint @xmath11 ( additional equations are solved , of course , including the conservation of mass , momentum , and energy ; but these are not relevant here . )",
    "the evans - hawley constrained transport technique satisfies equation ( [ mhd_constraint ] ) on the initial hypersurface , usually to machine accuracy , and then uses a differencing scheme for equation ( [ mhd_evolution ] ) that ensures that equation ( [ mhd_constraint ] ) is satisfied on each subsequent hypersurface to the same level of accuracy as on the first .",
    "this is done by staggering the grid in space and time ( see figure [ fig1 ] ) . at whole time",
    "steps the magnetic field vector components are defined normal to , and centered on , grid cube faces . at half time",
    "steps the electric vector is defined parallel to , and centered on , cube edges .",
    "for the initial conditions the magnetic field is derived from a vector potential @xmath12 this vector potential is defined on cube edges at @xmath13 , and for evolutionary computations @xmath14 is defined on cube faces , centered in time between @xmath15 and @xmath16 , _ i.e. _ , at @xmath17 .",
    "at @xmath18 we see that the solenoidal constraint is satisfied to machine accuracy by this method . for @xmath19",
    "we have , simply , @xmath20 where @xmath21 and @xmath22 are components on upper and lower cube @xmath23-faces , respectively , and the two pre - appended subscript signs on vector potential components @xmath24 indicate the @xmath25 edge at the intersection of the upper and/or lower cube faces with normals in the two spatial dimensions orthogonal to @xmath26 . similarly , taking the numerical divergence of equation ( [ mhd_evolution ] ) at @xmath27 ,",
    "we have @xmath28 so , at time @xmath29 the magnetic field remains divergence - free @xmath30 because it is the sum of two divergence - free fields .",
    "the solenoidal constraint is therefore preserved to machine accuracy _ specifically because the vector identity _ @xmath31 _ is naturally satisfied by the differencing scheme_.    in the above equations the electric field can be computed by any means , and ct still would be maintained .",
    "ideal mhd codes use ohm s law with infinite conductivity to relate the fluid velocity and the magnetic field : @xmath32 some astrophysical codes , like zeus and several in japan , use the method of characteristics to preserve alfven waves in the @xmath33 update , and so are often called moc - ct codes .",
    "however , it is important to realize that ct results simply from the grid staggering and has nothing to do with the method of characteristics or any other @xmath34 update scheme .      in full electrodynamics two more",
    "maxwell s equations are used to determine the electric field , instead of ohm s law . in vacuum",
    "these are @xmath35 figure [ fig1 ] then must be modified to include the new quantities @xmath36 ( current density ) , @xmath37 ( charge density ) , and @xmath38 ( electric potential ) .",
    "( see figure [ fig2 ] . )",
    "we also add another initial data problem at @xmath39 that solves equation ( [ ed_constraint ] ) for @xmath33 .",
    "if , for the moment , we choose the coulomb gauge and ignore the vector potential , we have @xmath40 electric potential and charge density then must be defined at cube corners on half time steps , and current density must be defined on cube edges at whole time steps ( same as @xmath41 , @xmath42 , and @xmath43 ; see figure [ fig2 ] ) . in an arbitrary gauge , we will have @xmath44 indicating that @xmath45 and @xmath33 are co - located .",
    "the equations are closed by specifying the evolution of @xmath37 and @xmath36 , which together must satisfy the conservation of charge @xmath46 so @xmath47 must be defined on cell corners at whole time steps .",
    "this method of staggering was suggested buy yee almost 40 years ago @xcite .",
    "constraints are preserved in the yee algorithm in the same manner as in the evans - hawley algorithm . for faraday s law and the solenoidal constraint , the procedure is identical . and for ampere s law we have @xmath48 which gives the following update for @xmath49 : @xmath50 so the coulomb constraint is preserved to machine accuracy as long as @xmath37 is conserved in the update .",
    "figure [ fig3 ] re - casts the yee algorithm in covariant form , using the faraday tensor @xmath51 ( instead of the vector fields ) , the four - current @xmath52 , and the vector four - potential @xmath53 .",
    "this will give important clues to developing a ct scheme for einstein s field equations .",
    "maxwell s equations then become , including constraints , @xmath54 where @xmath55 is the maxwell tensor ( the dual of @xmath51 ) and @xmath56 is now the _ four_-gradient operator @xmath57 . because @xmath58 and @xmath51 are antisymmetric",
    ", they satisfy tensor identities ( analogous to the vector identities @xmath59 ) called the bianchi identities @xmath60 these identities are related to j. a. wheeler s classic statement that `` the boundary of a boundary is zero '' .",
    "but , does the staggered grid in figure 3 automatically satisfy these identities to machine accuracy ?",
    "a quick analysis of @xmath61 shows that , in fact , it does .",
    "@xmath61 is a vector that is defined on cell edges at whole time steps and on cell corners at half time steps , and it involves tensor components that are two half - steps away from scalar points ( whole time - step cell corners ) .",
    "taking the divergence of this vector causes like components to cancel , so that @xmath62 holds in this differencing scheme .",
    "because of the zero on the right hand side of equation ( [ ed_cov_magnetic ] ) , that equation itself also is often described as a bianchi identity @xmath63 where @xmath64 is the differential of the tensor @xmath51 , which in component form is given by @xmath65 }   ~ = ~ { \\rm f}_{\\alpha \\beta \\ , , \\ , \\gamma } ~ + ~ { \\rm f}_{\\beta \\gamma \\ , , \\ , \\alpha } ~ + ~   { \\rm f}_{\\gamma \\alpha \\ , , \\ , \\beta }   \\nonumber\\end{aligned}\\ ] ] where the comma denotes ordinary differentiation ( @xmath66 ) and the brackets denote permuted summation .",
    "range from 1 to 3 , and roman indices @xmath67 will be used to denote a set of three integers with one of the spatial indices missing ( _ i.e. _ , one of the sets [ 0 , 1 , 2 ] , [ 0 , 1 , 3 ] , or [ 0 , 2 , 3 ] ) . ]",
    "this allows the faraday tensor to be derived from a vector four - potential @xmath68 or @xmath69 this is the covariant form for equations ( [ initial_b ] ) and ( [ ed_gauge ] ) .",
    "does the staggered grid automatically enforce @xmath70 also ?",
    "we have already shown this to be the case for the magnetic part ( equation [ divb_discrete ] ) .",
    "for the electric part of @xmath71 we have @xmath72 the second term is @xmath73 to order @xmath9 , and the first term is zero to the same order because of the staggered grid ( see the @xmath39 panel in figure [ fig2 ] ) .",
    "so equation ( [ dda_electric ] ) is just the same faraday s law that we are solving to machine accuracy in the spatial part of equation ( [ ed_cov_magnetic ] ) ( or equation [ mhd_evolution ] ) .",
    "to summarize , then , the staggered grid naturally satisfies the bianchi ( and vector ) identities in space and time @xmath74 to machine accuracy for any antisymmetric tensor @xmath51 and for any four - vector @xmath53 .",
    "here we use the einstein summation convention , where a repeated index indicates summation over the four coordinates ( @xmath75 ) .",
    "note that equation ( [ ed_bi1 ] ) uses the raised form of @xmath51 , but in flat space this involves only multiplying by @xmath76 with the minkowski metric . as a result of this cancellation , when the spatial parts of equations ( [ ed_cov_magnetic ] ) and ( [ ed_cov_electric ] ) are integrated forward in time @xmath77 ( where the spatial projection tensor @xmath78 is orthogonal to @xmath79 ) , the time parts ( the constraints ) are _ automatically satisfied to machine accuracy _",
    "@xmath80 with no additional computation required . _ a staggered grid ,",
    "therefore , has `` deep geometric significance '' _ , because it naturally satisfies the bianchi identities .",
    "ct also works in curvilinear coordinates and in curved spacetime , but the method requires iteration .",
    "again , maxwell s equations are @xmath81 but the gradient operator is now the covariant derivative rather than the ordinary derivative @xmath82 } ~ = ~ 0\\end{aligned}\\ ] ] where @xmath83 are the covariant derivatives of a general second - rank tensor @xmath84 , @xmath85 are different forms of the connection coefficients , and @xmath86 is the inverse of the metric @xmath87 . however , because the faraday tensor is antisymmetric ( as is the maxwell tensor ) , equations ( [ maxwell_curved1 ] ) reduce to @xmath88 } ~ = ~ 0\\end{aligned}\\ ] ] where @xmath89 and @xmath90 is the volume element ( square root of the negative metric determinant ) . equations ( [ maxwell_curved2 ] ) involve only simple differences and known values for the metric . however , unless @xmath91 is a diagonal , the raised version of the faraday tensor @xmath92 involves the sum of several lowered version components at different grid locations @xmath93 therefore , the time update of the fundamental variables @xmath94 will necessarily be implicit , and therefore iterative , as it involves sums over time as well as space .",
    "it is important to realize , however , that even in curvilinear coordinates and curved spacetime , the bianchi identities @xmath95 will be satisfied to machine accuracy , because @xmath96 is constructed _ before _ it is differenced and because that differencing is done in precisely the same manner as in equation ( [ ed_bi1 ] )",
    ". it does not matter that @xmath97 involves the sum of many tensor components and products of metric components .",
    "it only matters that the @xmath98 and @xmath99 derivatives commute .",
    "figure [ fig3 ] suggests the following geometric prescription for a staggered grid when solving covariant tensor field evolution problems .",
    "this prescription is depicted schematically in figure [ fig4 ] , and appears to work for tensors up to at least rank five .",
    "the basic rules are    1 .   extend and stagger the grid in time as well as in space .",
    "the time extension need not be very deep  only enough cells to compute the tensor components , derivatives , _ etc . _ to the order of the method .",
    "in this paper we use a second order differencing scheme , so we need only one additional half , and one full , time slice .",
    "2 .   treat time otherwise like a spatial coordinate .",
    "that is , use the same differencing scheme in time as used in space so that temporal and spatial differences commute .",
    "starting at corner nodes on the four - dimensional hypercube cell , define the following quantities in the manner described below .",
    "simply put , a tensor component is located one - half step away from hypercube cell corners in each dimension specified by that component s indices ; two repeated indices are equivalent to no shift at all .",
    "scalars : located on 4-cube cell corners ( 3-cube corners at whole time steps ) 2 .",
    "vectors : located on 4-cube edges , shifted one - half cell step in the direction specified by that component .",
    "that is , 1 .",
    "@xmath100 on 3-cube cell corners at half time steps 2 .",
    "@xmath101 centered on 3-cube @xmath102 edges at whole time steps 3 .",
    "@xmath103 centered on @xmath104 edges 4 .",
    "@xmath105 centered on @xmath106 edges 3 .",
    "one - forms : defined like vectors 4 .",
    "second - ranked tensors of any type 1 .",
    "@xmath107 : defined like scalars , on 3-cube cell corners at whole time steps 2 .",
    "@xmath108 : centered on 3-cube @xmath23-edges at _ half _ time steps 3 .",
    "@xmath109 : centered on @xmath110 faces at whole time steps 5 .",
    "third - ranked tensors and connection coefficients 1 .",
    "@xmath111 , @xmath112 , @xmath113 : defined like @xmath114 2 .",
    "@xmath115 , @xmath116 , @xmath117 : centered on 3-cube @xmath110-faces at half time steps 3 .",
    "@xmath118 : 3-cube - centered at whole time steps 6 .",
    "fourth - ranked tensors 1 .",
    "@xmath119 : defined like @xmath120 2 .",
    "@xmath121 ( @xmath122 ) : located at 4-cube body centers 7 .",
    "bianchi identities : defined like third - ranked tensors ( at least one index must be repeated ) .",
    "examples are @xmath123 ( same as @xmath105 ) and @xmath124 , ( centered on the 1 - 3 face at half time steps ) .",
    "this differencing scheme has a number of properties that make it look like a finite implementation of differential calculus .",
    "first , the differential operator , which creates a tensor of one higher order ( _ e.g. _ , equation [ df_bi ] ) , naturally places the new tensor on the proper grid if the differencing is centered .",
    "this is also true of the generation of @xmath125 from the metric field @xmath87 .",
    "second , one of the most fundamental properties of a spacetime , the covariant derivative of the metric ( @xmath126 ) vanishes , is naturally satisfied to machine accuracy because of this property .",
    "third , the contraction of a mixed tensor is trivial : for each staggered component of the contracted tensor the four components of the parent tensor that are needed for the sum are already located at the same grid point as the contracted component .",
    "no additional averaging is needed .",
    "fourth , as shown below , in a local riemann normal coordinate system , the bianchi identities are satisfied to machine accuracy .",
    "all terms cancel exactly , so the constraints are propagated exactly as well .",
    "certain special tensors also have interesting properties .",
    "the kronecker delta @xmath127 , for example , has non - zero elements ( unity ) only at hypercube cell corners .",
    "this is also true of other identity tensors ( @xmath128 , @xmath129 , _ etc . _ ) , which are @xmath76 at cell corners .",
    "the levi - civita tensor @xmath130 and antisymmetric symbol @xmath131 $ ] are just the opposite .",
    "they are zero everywhere except at the hypercube _ body centers_. they look much like the identity tensors , but on a grid that is shifted one - half step in each dimension .",
    "furthermore , as the levi - civita tensor expresses the volume element @xmath132 \\nonumber\\end{aligned}\\ ] ] its placement at the hypercube center creates a natural scheme for forming volume integrals over those hypercubes .",
    "for reasons that are developed more fully below , we will use mixed tensors to define the problem of numerical relativity . as noted above",
    ", such tensors will lend themselves easily to contraction .",
    "the classic problem of general relativity is to solve einstein s field equations @xmath133 ( @xmath134 ) for the metric coefficients .",
    "the einstein curvature tensor is derived from the ricci curvature tensor @xmath135 with @xmath136 being the ricci curvature scalar .",
    "the ricci tensor is the contraction of the riemann tensor on the first and third indices @xmath137 the riemann tensor is the full statement of curvature of the spacetime . in its mixed form",
    "it is given by @xmath138 for a coordinate basis .",
    "the doubly - raised connection coefficients are given by @xmath139 we assume that the metric @xmath87 has a unique inverse @xmath86 such that @xmath140 in this paper we will treat only the vacuum problem ( the source of stress - energy @xmath141 ) so that equation ( [ ein_field ] ) becomes @xmath142 the riemann tensor @xmath143 possesses several symmetries , including algebraic antisymmetry on @xmath99 and @xmath98 ( and on @xmath144 and @xmath145 ) and differential symmetries ( bianchi identities ) @xmath146 } & \\equiv &   { { \\rm r}^{\\alpha \\beta}}_{\\gamma    \\ , \\delta    ; \\ , \\epsilon } ~ + ~   { { \\rm r}^{\\alpha \\beta}}_{\\epsilon \\ , \\gamma    ; \\ ,",
    "\\delta } ~ + ~ { { \\rm r}^{\\alpha \\beta}}_{\\delta    \\ , \\epsilon ; \\ , \\gamma } ~ = ~ 0\\end{aligned}\\ ] ] the reader will note that the mixed riemann tensor is missing one additional symmetry that is possessed by the covariant version : @xmath147 .",
    "( a raised index can not be swapped with a lower one . ) when contracted on the first and third indices , the bianchi identities become simply @xmath148 _",
    "i.e. _ , the divergence free condition on the einstein tensor .",
    "these four conditions are responsible for propagating the four constraints @xmath149 if the other equations are satisfied @xmath150        how does satisfying the bianchi identities propagate the constraints numerically ? this is easy to show in riemann normal coordinates . for the vacuum problem ,",
    "the constraints are given by @xmath158 and we seek a scheme in which the constraints propagate to machine accuracy @xmath159 but satisfying the bianchi identities ( equation [ rn_bi ] ) will mean that the contracted identities are also satisfied to machine accuracy @xmath160 or @xmath161    all that needs to be shown is that @xmath162 also .",
    "for the three momentum constraints ( @xmath163 ) this is straightforward , because @xmath164 are the field equations being computed , so @xmath165 is @xmath166 by definition .",
    "is accurate to only @xmath167 .",
    "however , if we use this truncation - accurate solution to re - compute @xmath165 , _ using exactly the same mathematical definition of terms that we used in the evolution equation _ , then that re - computed @xmath165 will be zero to machine accuracy .",
    "( it will not be so only if we use a different differencing scheme than the one used in the original evolution equation . ) as a simple example , consider a line of code that computes @xmath168 . then",
    ", if we later compute the function @xmath169 , by definition , @xmath170 will be zero to machine accuracy .",
    "] so the spatial gradients @xmath171 will be @xmath166 , thereby propagating @xmath172 to machine accuracy .    for the hamiltonian constraint ( @xmath173 ) we require satisfaction of the momentum constraints on the hypersurface , _",
    "i.e. _ , @xmath174 .",
    "therefore , as long as the momentum constraints propagate to machine accuracy on each hypersurface , which we have shown above to be the case , the hamiltonian constraint will propagate also .",
    "note , however , if the gradient of the momentum constraints has a constant bias , then the hamiltonian constraint will grow . on the other hand , if the divergence fluctuates randomly , the the hamiltonian constraint will fluctuate only randomly as well .      because a riemann normal coordinate system is local only and can not be used to cover the entire spacetime , we are forced to deal with non - zero connection coefficients .",
    "but we still will attempt to propagate the constraints in the same manner  with a scheme that enforces the bianchi identities by employing temporal and spatial differences that commute .",
    "it is important to note that the bianchi identities are never _ explicitly _ calculated in the ct method .",
    "instead , we develop a scheme in which @xmath175 is satisfied to at least truncation accuracy for all time .",
    "( we will find that machine accuracy may be an unattainable goal .",
    ") however , in a general coordinate system , the update of @xmath176 will depend on an `` advection '' of curvature from surrounding cells , due to the covariant derivative connection terms .",
    "so , we equivalently seek a scheme in which @xmath177 to at least truncation accuracy .",
    "if we set up a grid in which @xmath178 } & = & o(\\epsilon_{tr})\\end{aligned}\\ ] ] then we can proceed in much the same manner as in riemann normal coordinates , but with covariant derivatives .",
    "if the bianchi identities are satisfied to truncation accuracy , then their contracted form also will hold @xmath179 so , if the momentum constraints are satisfied on each hypersurface , the hamiltonian constraint will propagate , albeit along geodesics , not coordinate lines . and",
    "the momentum constraints will propagate if the field equations are satisfied to at least truncation accuracy .      in order to demonstrate cancellation of terms in the bianchi identities , we choose the following form for the mixed riemann tensor @xmath181 with the singly - raised connection coefficient _",
    "re_-computed from the doubly - raised ones and the gradient of the inverse metric @xmath182 this form has the following properties    1 .",
    "@xmath143 possesses explicitly all of the algebraic symmetries discussed in section [ prob_statement ] .",
    "2 .   when the bianchi identities are formed and the symmetry in the last two indices of @xmath183 , the connection terms involving @xmath144 and @xmath145 will cancel , just as they did for the antisymmetric faraday tensor bianchi identities in equation ( [ maxwell_curved2 ] ) . ]",
    "@xmath184 and equation ( [ alt_raised_gamma ] ) is inserted , the @xmath185 terms will cancel _ to machine accuracy _ , as described before in section [ ct_in_rn ] .      in equation ( [ cb_full_bi ] )",
    "the @xmath187 terms will cancel explicitly _ algebraically_. will they cancel numerically also ?",
    "the answer is yes , if we apply the following numerical procedures    1 .",
    "use linear interpolation ( averaging ) to determine quantities at intermediate grid points 2 .",
    "when forming a product , such as @xmath188 , first average the factors to the grid point in question , then form the products and finally the sum .",
    "do not form the products on different grid points and then average .        while we are reasonably confident that , with these measures , @xmath200 terms in the bianchi identities will cancel , it is clear that the @xmath199 terms will _ not _ cancel to machine accuracy .",
    "these are all produced by connection of the double-@xmath201 terms in the riemann tensor .",
    "however , when forming the bianchi identities , the connection takes place on an already - multiplied and summed @xmath202 product .",
    "one can not undo the sums and products , form averages , and then re - form the triple-@xmath201 product . and the product of averages does _ not _ commute with the average of products .",
    "the bianchi identities , therefore , will be left with terms proportional to the truncation error and @xmath2 .",
    "unless some clever averaging scheme can be found to allow the triple-@xmath201 terms to also cancel to machine accuracy , any ct scheme developed along these lines will be subject to truncation error .",
    "the hope , then , is that cancellation of second and first order derivatives of the connection ( third and second order derivatives of the metric coefficients ) will be sufficient to improve the stability of the discrete evolution scheme .",
    "therefore , while the staggered grid ct method clearly works in riemann normal coordinates , detailed numerical experiments will be needed to see if it maintains its desirable properties when applied in a general coordinate basis .",
    "the goal of this ct scheme is to produce an interlocking , staggered four - dimensional grid of @xmath87 tensor values by successively adding new half and whole temporal hypersurfaces . because interpolation is in time , as well as space , the scheme necessarily will be an implicit one and , therefore , iterative .",
    "our approach then will be to first produce an initial guess for @xmath87 on the next level of hypersurfaces using an existing explicit scheme .",
    "this solution will not satisfy the interlocking staggered grid equations , so it will be iterated using the latter until it does .",
    "the exact iterative scheme is still under development , but one possible implementation is a multigrid technique in which the variables are the spatial @xmath203 and the equations are the @xmath204 field equations .",
    "this method appears similar to recently - suggested approaches in which the constraints are re - solved at each time step .",
    "there are , however , two key differences .",
    "first , the constraints are not solved explicitly . instead",
    ", the evolution equations are solved in such a way that they are implicitly enforced .",
    "this ensures a scheme in which the evolution and constraints are fully compatible and not tracking different numerical solutions to the differential equations .",
    "secondly , the equations being iterated are implicit hyperbolic , not elliptic .",
    "in addition to information on the new hypersurface , at each iteration these equations utilize information from the _ previous _ hypersurface  information that constraint equations do not have . with this",
    "added information , if implemented properly , the iterative scheme should exhibit faster convergence than a regular constraint solver would have .",
    "figure [ fig5 ] shows implementation of a simple 1 + 1 space - time problem .",
    "comparison of this figure with figure [ fig4 ] will give insight into implementation of the full 4-d interlocking grid .",
    "@xmath205 and @xmath206 are quantities known from the previous time step , the first being a gauge condition and the second being the solution . @xmath207 and @xmath208 are gauge conditions on the _ new _ hypersurfaces , and @xmath209 is the new solution that will be determined by the iterative numerical scheme .",
    "specification of the coordinate gauge is similar to doing so in classic 3 + 1 schemes : @xmath210 is freely specified at cube corners on whole hypersurfaces , and @xmath211 is freely specified at cube edge centers on half hypersurfaces .",
    "@xmath211 is related to the shift vector @xmath212 , and both are properly located at half time steps vector points .",
    "@xmath213 is related to the lapse @xmath99 , and properly located in this scheme at scalar points .",
    "the @xmath203 are the six unique gravitational potential fields that we intend to solve .",
    "a typical time step then begins with @xmath87 components known on hypersurfaces @xmath214 , @xmath215 , and @xmath216 .",
    "one then specifies the @xmath211 vector on hypersurface @xmath217 and the @xmath210 scalar at @xmath218 .",
    "the explicit predictors for @xmath219 at @xmath218 then complete the new @xmath87 field , and the iteration on the @xmath203 can then begin . if the @xmath220 are dependent on the @xmath203 field ( which generally will be the case here ) , then the gauge conditions need to be updated at each iteration for a consistent solution .      the inverse of @xmath87 is often needed to raise the connection coefficients for use in the evolution equations . in principle",
    "these @xmath86 should also be located at second - ranked tensor grid points . in practice , however , we never need the actual staggered @xmath86 fields . instead , we need their interpolated averages @xmath221 at third - ranked tensor points . furthermore , in order for the raising and lowering of connection coefficient indices to commute , the staggered field of @xmath86 values must be constructed in such a way that its average , and that of @xmath222 , are orthogonal at those third - ranked tensor points @xmath223 so construction of the index - raising tensor @xmath221 is a straightforward matter of averaging @xmath87 to places where the @xmath224 are computed , and then inverting that average _ locally _ at those grid points .",
    "the actual staggered fields of @xmath86 values , whose averages should give us these @xmath221 at third - ranked tensor points , never need to be determined .",
    "this procedure is fast , gives us raising and lowering operators that commute , and follows the afore - mentioned rule of averaging first and then multiplying and summing second .",
    "the initial data problem for a staggered grid will be a little more complicated than that for a non - staggered scheme . in the latter case , there are 12 unknowns ( @xmath225 and @xmath226 ) and four equations ( @xmath227 ) on the initial hypersurface at @xmath228 , for a net total of eight degrees of freedom . in the staggered case , @xmath229 is computed at @xmath230 , but the @xmath231 are computed at @xmath232 .",
    "solution of the momentum constraints , given @xmath225 at @xmath230 , is fairly straightforward in the staggered case .",
    "they are not functions of second - order time derivatives of the metric ( _ e.g. _ , @xmath233 ) , so the placement of those constraints at @xmath234 allows them to directly relate @xmath235 at to @xmath236 .",
    "all @xmath201s can be computed in a staggered manner .",
    "the momentum constraint solution at @xmath237 , then , would have six unknowns ( @xmath236 ) and three constraints , leaving three degrees of freedom , just like the non - staggered grid case .    the hamiltonian constraint , however , presents a problem .",
    "while @xmath229 also does not involve any second - order time derivatives , nevertheless it does involve _ first _ order time derivatives @xmath238 .",
    "those still are defined on half - hypersurfaces and , therefore , need to be _ interpolated _ to @xmath239 .",
    "that is , we need the @xmath226 at both @xmath237 and @xmath240 anyway , even if we are not going to compute @xmath241 . at first glance there does not appear to be a method of providing an accurate @xmath242 field to properly compute this interpolation .",
    "of course , one simply could extrapolate @xmath243 at @xmath237 forward to @xmath239 ( _ i.e. _ , assume @xmath244 ) and then solve @xmath245 there .",
    "the hamiltonian constraint solution then would have the six @xmath246 unknowns and one constraint  five degrees of freedom  just like the non - staggered case .",
    "but a serious problem still remains .",
    "_ there is no means of enforcing the hamiltonian constraint at @xmath247 .",
    "_ while the staggered grid is , in principle , capable of doing that , it can do so only through the evolution equations @xmath248 .",
    "but at this stage we have not yet begun to enforce the evolution .",
    "one possible method of solving this is to do nothing .",
    "just accept the fact that , at @xmath249 , @xmath245 is good only to truncation accuracy . choosing a very small @xmath250 ( a `` thin sandwich '' ) would keep this error small .",
    "a second approach would be to also explicitly enforce the constraint on @xmath247 , which would reduce the number of degrees of freedom of the hamiltonian problem from five to four .",
    "while producing a more constrained problem , this solution would result in two successive hypersurfaces on which the hamiltonian constraint is satisfied . yet",
    "a third alternative would be to locate @xmath231 on the @xmath240 hypersurface and extrapolate quantities like @xmath226 _ forward _ to @xmath251 .",
    "the problem with this approach is that , while the hamiltonian constraint is satisfied for the _ extrapolated _ @xmath226 field , when the evolution is begun , the hamiltonian constraint that is implicit in the evolution equations will use fields that are _ interpolated _ in time between @xmath237 and @xmath240 .",
    "there will be , therefore , an implicit constraint violation injected into the evolution at the outset .    the elegant , and proper , method of solving this problem is to _ solve all ten of the einstein field equations simultaneously on the initial hypersurfaces_. there will be 18 unknowns ( @xmath225 at @xmath252 , @xmath239 , and @xmath251 ) and 10 equations , leaving 8 degrees of freedom , just like the non - staggered case .",
    "the resulting fields will be properly staggered , and the @xmath201s will be properly staggered and interpolated .",
    "the hamiltonian constraint will be satisfied at @xmath239 using the correctly interpolated fields , and it will be satisfied at @xmath251 ( and even @xmath252 ) as well , because the evolution equations ( and therefore the bianchi identities ) are fully enforced .",
    "similarly , the momentum constraints will be satisfied at @xmath237 and @xmath240 for the same reason , regardless of whether they are actually applied at @xmath237 or at @xmath240 .",
    "the reader will , of course , recognize that this is more than solving an initial data problem ; in actuality the proposed scheme solves the initial data problem plus the first file evolutionary time step simultaneously .",
    "this is done to ensure that the initial data on the first three hypersurfaces are solutions of the discrete , staggered evolutionary field equations .",
    "no constraint violation will be introduced implicitly other than what is naturally present in the evolutionary method already .      when @xmath253 and @xmath254 are specified on the same boundary , where @xmath255 is the boundary normal , the boundary data problem is similar to the initial data problem . in all such cases , the boundary constraints are given by @xmath256 and for rectilinear grids with the boundary normal being a coordinate unit 1-form @xmath257 , this yields @xmath258 where the symbol @xmath259 is a label indicating the boundary direction in question , not strictly a coordinate index .",
    "the equation @xmath260 ( no sum ) is located at 3-cube corners and plays the role of boundary constraint in much the same manner as the hamiltonian constraint does at @xmath239 .",
    "similarly , the equations @xmath261 ( @xmath262 ) play the same role as the momentum constraints did earlier . by analogy ,",
    "then , the boundary problem is as follows .",
    "there are 12 unknowns ( @xmath263 [ @xmath262 , @xmath264 at @xmath265 and at @xmath266 , _",
    "i.e. _ , on the @xmath267 boundary and one ghost node _ beyond _ the boundary ) , and there are 4 equations ( [ boundary_constraints ] ) .",
    "this leaves 8 degrees of freedom again , which must be specified with additional boundary conditions .",
    "the diagonal constraint @xmath268 is applied at @xmath269 at 3-cube corners .",
    "two of the off - diagonal constraints ( @xmath270 @xmath271 $ ] ) are applied on whole hypersurfaces at @xmath272 , and the final constraint @xmath273 is applied also at @xmath272 but on time half - hypersurfaces .",
    "the reader will note that this latter set of equations is related to the set of momentum constraints @xmath274 , but the momentum constraints are defined at @xmath275 , @xmath276 , @xmath277 , ... , @xmath278 and propagated forward by the evolution equations .",
    "the constraint at @xmath272 must be explicitly enforced in most cases , along with the three others and the eight freely - specified @xmath87 at @xmath279 and @xmath280 .",
    "any number of additional boundary data problems are possible .",
    "@xmath281 could be specified at the upper @xmath259 boundary , while @xmath282 could be be specified at the lower @xmath259 boundary , for example .",
    "also , some of the eight free @xmath222 could be specified on opposing boundaries as well .    for periodic boundary conditions ,",
    "the six unknown @xmath87 at @xmath279 are set to those near @xmath283 , and those at @xmath284 are set to those near @xmath280 .",
    "no constraints are applied explicitly , only implicitly through the wrapping conditions and the evolutionary solution of the field equations .",
    "it is useful to summarize how a complete problem will proceed .",
    "the computation begins by using gauge conditions to specify @xmath285 at @xmath252 , @xmath239 , and @xmath251 and @xmath286 at @xmath237 and @xmath240 .",
    "the full initial data plus time - step problem , including the field equations , is then solved for @xmath225 on @xmath252 , @xmath239 , and @xmath251 , applying eight freely - specified @xmath225 ( or eight functions thereof ) in the process .",
    "appropriate boundary constraints also need to be applied in order to obtain a consistent solution .",
    "the field equations are generated as follows .",
    "an initial guess for the @xmath225 is obtained by some means , perhaps using conformal or other existing initial value methods or , for the evolution , an explicit forward integration scheme .",
    "the full @xmath87 field values then are differenced onto third - rank tensor grid points , and the @xmath224 are formed .",
    "the @xmath87 values are also averaged to those same third - rank tensor points , and an inverse of that average @xmath221 is used to raise the connection coefficients ( equations [ singly_raised_gamma ] and [ doubly_raised_gamma ] ) .",
    "the @xmath201s , in turn , then are differenced and averaged to second - rank tensor points for the riemann tensor calculation .",
    "( note that there will be no need for values at other fourth - rank tensor points [ hypercube body centers ] , as riemann will be immediately contracted into ricci . )",
    "equation ( [ mixed_riemann ] ) should suffice for the riemann calculation ( _ i.e. _ , the explicit version [ equation [ new_mixed_riemann ] ] should not be needed ) , because our raising and lowering operators commute , rendering the results of equations ( [ singly_raised_gamma ] ) and ( [ alt_raised_gamma ] ) the same to machine accuracy .",
    "contraction to ricci is trivial , as it sums riemann components already computed at second - rank tensor points , and the @xmath287 are then tested to see if they are zero . if not , the local values of @xmath225 are modified in an appropriate manner , and the computation of the ricci components is repeated until convergence .",
    "it is important to remember that at grid boundaries , the boundary constraints ( which are evolutionary equations in their own right ) must be applied and iterated upon as well , and the freely - specified boundary conditions must be applied .",
    "when the iterative solution is acceptable , the computation continues to the next hypersurface , first specifying the gauge conditions and then solving the field equations .",
    "the largest uncertainty in the proposed method is the effect of the truncation errors introduced by non - cancellation of the triple-@xmath201 terms .",
    "analytically we can be sure of exact constraint propagation only if the bianchi identities are satisfied exactly , and that is not the case in a general coordinate basis . on the other hand , the fact that the method does work in a local riemann normal system , and has some attractive properties of a finite differential calculus , are encouraging .",
    "furthermore , most of the time - dependent derivatives of @xmath91 do cancel in the general case , and this should enhance stability",
    ". analytical investigation of the stability of this method is difficult , so we have chosen to do so numerically .",
    "two numerical implementations of this scheme are being developed currently .",
    "the first assumes symmetries in two spatial dimensions , rendering the scheme explicit and avoiding the need for iteration .",
    "the second is a full implementation using staggered grids in four dimensions .",
    "results of these studies will help in determining the stability of the method .    at best",
    ", the method is expected to be conditionally stable .",
    "the evans - hawley and yee methods have this property , and are subject to a courant - like condition on the time step @xcite . with @xmath288 ,",
    "this implies @xmath289 , which a typical condition applied in most numerical relativity implementations .",
    "if it can be shown that such techniques provide stable constraint transport for finite difference implementations of numerical relativity , then other implementations might benefit from similar schemes that use four - dimensional grids and that have temporal and spatial derivatives that commute . in the finite element case ,",
    "this would begin by extending the elements into the time direction , rather than simply time - stepping a three - dimensional finite element grid .",
    "however , some additional features would have to be introduced , analogous to grid staggering , to ensure commutation of spatial and time derivatives across element boundaries .",
    "the pseudo - spectral may be intractable at the present time .",
    "as spatial derivatives are computed using the full spatial extent of the grid , in order to create a method in which these commuted with time derivatives , one could imagine using many , if not all , previous and future time hypersurfaces to compute the latter .",
    "this would be a truly four - dimensional grid method and involve solving the entire spacetime structure in one giant iterative procedure .",
    "present - day computers still struggle with three - dimensional explicit schemes , so a four - dimensional implicit one is clearly beyond current technology .",
    "however , in the not - too - distant future such codes might begin to be feasible .",
    "the author has benefited greatly from discussions with f. estabrook , l. lindblom , m. miller , d. murphy , and m. scheel .",
    "he is also grateful for a jpl institutional research and development grant , and for the continued hospitality of the tapir group at caltech .",
    "this research was performed at the jet propulsion laboratory , california institute of technology , under contract to the national aeronautics and space administration .",
    "clarke , d. a. 1996 , , 457 , 291320 . de raedt , h. , kole , j. s. , michielsen , k. f. l. , & figge , m. t. 2002 , arxiv : physics/0210035 .",
    "evans , c. r. & hawley , j. f. 1988 , , 332 , 659677 .",
    "stone , j. m. & norman , m. l. 1992a , , 80 , 753790 .",
    "stone , j. m. & norman , m. l. 1992b , , 80 , 791818 .",
    "scheel , m. a. , kidder , l. e. , lindblom , l. , pfeiffer , h. p. , & teukolsky , s. a. 2002 , phys .",
    "d , 66 , 124005 .",
    "yee , k. s. 1966 , ieee transactions on antennas and propagation , 14 , 302307 ."
  ],
  "abstract_text": [
    "<S> a scheme is presented for accurately propagating the gravitational field constraints in finite difference implementations of numerical relativity . </S>",
    "<S> the method is based on similar techniques used in astrophysical magnetohydrodynamics and engineering electromagnetics , and has properties of a finite differential calculus on a four - dimensional manifold . </S>",
    "<S> it is motivated by the arguments that 1 ) an evolutionary scheme that naturally satisfies the bianchi identities will propagate the constraints , and 2 ) methods in which temporal and spatial derivatives commute will satisfy the bianchi identities implicitly . </S>",
    "<S> the proposed algorithm exactly propagates the constraints in a local riemann normal coordinate system ; _ i.e. _ , all terms in the bianchi identities ( which all vary as @xmath0 ) cancel to machine roundoff accuracy at each time step . in a general </S>",
    "<S> coordinate basis , these terms , and those that vary as @xmath1 , also can be made to cancel , but differences of connection terms , proportional to @xmath2 , will remain , resulting in a net truncation error . </S>",
    "<S> detailed and complex numerical experiments with four - dimensional staggered grids will be needed to completely examine the stability and convergence properties of this method .    if such techniques are successful for finite difference implementations of numerical relativity , other implementations , such as finite element ( and eventually pseudo - spectral ) techniques , might benefit from schemes that use four - dimensional grids and that have temporal and spatial derivatives that commute . </S>"
  ]
}