{
  "article_text": [
    "the effort to design and build a quantum computer is motivated by the discovery of a number of quantum algorithms that are more efficient than their best known classical equivalents @xcite .",
    "some practical benefit could arise from these algorithms with a quantum computer of only tens or hundreds of qubits , but a quantum computer with thousands of logical qubits will be required to outperform the most powerful classical computers @xcite . to mitigate the effects of decoherence and systematic imprecision",
    "it is expected that fault tolerant error correction @xcite will be required at the expense of additional quantum resources . motivated by the fact that a limited amount of resources can be allocated to error correction , here we present a new method for error correction which uses message passing to achieve lower error rates than conventional methods that incur the same resource cost .    with the notable exceptions of topological quantum computing @xcite and the surface code @xcite ,",
    "most methods for error correction involve concatenation .",
    "our result is in this context and so we briefly review this approach .    first , information represented by the state of a single physical qubit is encoded in the states of several physical qubits , which together form the logical qubit of an error correction code . using error correction circuitry constructed from physical operations ( including state preparation , measurement , and quantum logic gates such as hadamard and controlled - not ) some number of errors affecting the data qubits that make up the logical qubit can be detected and corrected . typically this is done by interacting the data qubits with some ancillary qubits and then measuring the ancillary qubits to extract a syndrome from which errors are diagnosed .",
    "then , to form a concatenated quantum code , this process is applied recursively - that is , logical qubits are used to encode higher level logical qubits and logical operations are used to construct higher level error correction circuits .",
    "it is known that by concatenating a quantum code , an arbitrarily accurate and arbitrarily large quantum computation can be performed efficiently with faulty components provided that the failure rate of all physical operations is below some threshold @xcite . with each level of concatenation the failure rate of the logical operations",
    "reduces double - exponentially , however both the number of physical qubits to encode each logical qubit and the time required to perform each logical operation increase exponentially .",
    "this increase in resources makes it impractical to use more than just a few levels of concatenation .",
    "conventional implementations of quantum error correction implicitly assume that errors are equally likely on all data qubits and so the correction is always to apply the fewest possible bit or phase flips required to return the state to the code space .",
    "error correction at each level of concatenation operates independently in this way .",
    "however , not only does error correction reduce the probability of a logical error , it also gives some indication of the likelihood that an error has occurred at a higher level of encoding - a logical error is more likely to have occurred if a correction was applied during error correction than if a correction was not applied .",
    "if this classical information is passed from lower levels of error correction to higher levels it is possible to correct a larger set of errors .",
    "message passing in quantum computation was first considered in the context of an error detection code , where errors at the level below would become located errors at the next level up and thus be corrected @xcite .",
    "the idea was also applied to an error correction code in the context of communication across a noisy channel @xcite .    here",
    "we extend this idea by applying message passing to fault tolerant error correction under the nine - qubit bacon - shor subsystem code @xcite .",
    "in particular we present a method for error correction at the second level of concatenation which uses both the regular syndrome and messages from the first level of concatenation .",
    "we refer to this method as message passing error correction ( mpec ) . using simulations we find that mpec will correct all cases with four physical errors , whereas conventional error correction can only guarantee success with up to three physical errors .",
    "we also show that mpec retains fault tolerance and so for physical error rates well below the threshold the use of this method can lead to a significant improvement in the fidelity of a large scale computation relative to conventional error correction .",
    "note that while message passing error detection has been shown to increase the asymptotic threshold @xcite , our method is designed to improve the performance of error correction without requiring additional resources .",
    "we do not explicitly consider any effect that message passing may have on the asymptotic threshold .",
    "in this paper we focus entirely on improving the performance of the second level of concatenated error correction using the [ [ 9,1,3 ] ] bacon - shor code .",
    "the bacon - shor error correction circuits we use are shown in fig .",
    "[ fig : ec circuit ] @xcite .    in the [ [ 9,1,3 ] ] code",
    "a logical failure can occur if at least two of the data qubits have errors .",
    "when the error correction circuit measures a non - zero syndrome we know that at least one of the data qubits has an error and that any additional error may cause failure . to have a logical error and observe no syndrome requires at least three physical errors .",
    "therefore logical errors are of order @xmath0 more likely at logical circuit locations which measured non - zero syndrome . at these level-1 locations , which have detected an error at the physical level",
    ", we raise a _ flag _ to indicate an increased probability of level-1 error .",
    "these flags are simply classical information that can be tracked through the quantum circuit .",
    "bit ( @xmath1 ) and phase ( @xmath2 ) errors can be treated independently .",
    "there will be @xmath1 flags and @xmath2 flags each indicating increased probability of the respective errors .",
    "since the @xmath1 and @xmath2 error correction circuits are similar the same rules apply independently to both @xmath1 and @xmath2 correction .",
    "table [ tab : outcomes ] shows the four possible outcomes of a level-1 error correction block .",
    ".possible outcomes of a level-1 error correction block .",
    "the error correction block is _ flagged _ if a non - zero syndrome is measured , indicating that at least one error has occurred .",
    "error correction can only detect deviations from the code space , and so logical failures can not be detected without higher level error correction . in terms of the probability of a physical gate failure , @xmath3 ,",
    "the weights of the outcomes are @xmath4 and @xmath5 respectively . [ cols=\"^,^,^ \" , ]",
    "using conventional concatenation each level of error correction works independently .",
    "the @xmath6 level of error correction can correct any single gate failure at the level below .",
    "all gates in the error correction circuit are assumed to be equally likely to fail , and so when a non - trivial error syndrome is measured the lowest possible number of errors is assumed and the corresponding correction is applied .",
    "information about the syndrome and the corrections applied is then thrown away . in our method",
    "we use this same information to estimate the relative probability of gate failures at a higher level .",
    "the key ideas are that more errors can be corrected if the locations of the errors are known and that logical failure is more likely when a non - trivial correction is applied .",
    "that is , there is a significant correlation between flags and logical failure .",
    "codeword states with two errors share the same set of syndromes as codeword states with single errors .",
    "however , with the additional flag information , is it possible to distinguish between a larger set of errors .",
    "we call the combined information of the flags and the measured syndrome the _ super syndrome_. at the second level of error correction , the syndrome of a single @xmath7 may be indistinguishable from that of two @xmath7s , and so without message passing , four physical errors ( if they result in two @xmath7s ) can cause a logical error at level 2 .",
    "when the full super syndrome is considered one @xmath7 is distinguishable from two @xmath7s and so we can attempt to correct two level-1 errors at once .",
    "cases with two @xmath7s can be accurately diagnosed and corrected . @xmath8",
    "may share the same super syndrome with two @xmath7 , but @xmath8 is weight @xmath9 in terms of the physical error rate .",
    "it turns out that all weight 4 cases can be corrected using mpec .",
    "when the error correction circuitry itself is made from noisy gates the problem is significantly more complicated .",
    "the error correction circuits are designed to be fault tolerant - a fault at any given physical location will not spread to multiple data qubits in the same logical qubit . however",
    ", this type of fault tolerance does not guarantee the protection of the properties that make message passing assisted error correction superior .",
    "for example , consider an encoded level-1 cnot that is part of a level-2 error correction circuit .",
    "a single physical error during this cnot could result in a flag being raised on one or both of the qubits depending on the location of the error .",
    "two physical errors could result in @xmath10 , @xmath11 , @xmath12 , @xmath13 , etc .",
    "[ fig : cnot errors ] ) . with three physical errors ,",
    "all combinations of flags and failures are possible .",
    "therefore not all two @xmath7 cases are weight 4 for example .",
    "this effect complicates the process of interpreting the super syndrome and ensuring fault tolerance .",
    "we found that not all fault tolerant circuits for conventional error correction can be readily adapted to mpec .    to provide the best possible error correction",
    ", we aim to apply a correction corresponding to the most likely cause of the super syndrome .",
    "we assume a low physical error rate , and so the most likely cause is the one with the fewest physical errors .",
    "here is an overview of how our scheme works : the error correction circuit used is shown in fig .",
    "[ fig : ec circuit ] . @xmath1 and @xmath2 error correction are treated separately .",
    "there are @xmath1 flags and @xmath2 flags , which represent potential @xmath1 and @xmath2 errors respectively .",
    "a flag is raised on a level-1 qubit whenever lower level error correction measures a non - zero syndrome .",
    "each flag has its own identity .",
    "the propagation of each flag is tracked through the circuit as if it were an actual error , spreading through cnot gates .",
    "@xmath1 flags copy downwards through cnot gates and @xmath2 flags copy upwards .",
    "when the second level syndrome is measured we look for combinations of one , two , or three flags on the ancilla which if corresponded to actual errors would produce the syndrome that was measured .",
    "such a combination is called a _",
    "flag match_. ( for examples of this see figures in appendix a. ) if a flag match is found , we apply corrections to the data qubits that share the same flags as used in the flag match .",
    "some super syndromes have more than one flag match , in these cases we preference the match which implies the fewest errors and _ results in the fewest corrections to the data qubits_. if no flag match is found , we fall back to the default error correction action ; ie .",
    "we correct based on the syndrome alone . after error correction ,",
    "all flags found on the ancillary qubits at the point of measurement are cleared from the data qubits - these flags have either been established to be @xmath7 ( and have been corrected ) or @xmath14 , so they are of no further use .    note that although @xmath15 has equal weight to @xmath16 , triple flag matches must still be preferenced over the default correction to avoid particular cases in which four physical errors would otherwise cause level-2 failure due to certain combinations of 2-qubit gate failures .",
    "( see appendix a. )    further levels of concatenated error correction will compound the benefits of mpec .",
    "however , making use of message passing at all levels is not so easy . finding a flag scheme that works at all levels is non - trivial , and",
    "so for this paper we have focused on just two levels of error correction .",
    "a simple method for concatenation beyond level 2 is to alternate between error correction that provides flags for the next level , and error correction that uses flags from the previous level but provides no flags . for this alternating sequence",
    "the number of physical errors required for logical failure at increasing levels of concatenation is @xmath17 ; in contrast with the regular scaling , @xmath18 , for the same physical resources .",
    "the procedure described in the previous section ensures that _ no combination of four physical errors will result in a level-2 logical error_. this is an improvement over conventional concatenation which can only guarantee the correction of three physical errors at level-2 .",
    "however , to show that our scheme is effective for large circuits we must show that an arbitrary length chain of level-2 locations will not fail for any combination of four physical errors in each level-2 extended rectangle .",
    "an extended rectangle is defined to be an encoded gate with error correction before and after @xcite .    usually , fault tolerance of error correction circuits is considered from the point of view that all levels act independently .",
    "the basic rule is that a single error should not spread to multiple errors on the same data qubit . for mpec",
    "the fault tolerant condition is more complicated .",
    "since corrections are based on the entire super syndrome we must take into account the error weight of each of the possibilities in table [ tab : outcomes ] rather than just counting the failures .    to ensure fault tolerance",
    ", an mpec box must satisfy the following condition : @xmath19 where @xmath20 is the error weight of the state entering the mpec box , @xmath21 is the weight of errors occurring inside the box , and @xmath22 is the error weight of the state leaving the box after any corrections have been applied .",
    "error weights are calculated according to table [ tab : outcomes ] . evidence that the mpec scheme satisfies the condition can be found in appendix a. a proof that this condition guarantees the performance of the error correction can be found in appendix b.",
    "to test our message passing error correction we simulate a level-2 cnot extended rectangle .",
    "we compare the failure rates with and without message passing .",
    "the failure rate of this circuit is meant to approximate the failure rate of the level-2 cnot which might be an algorithmic location .    to simulate the error correction circuit we need only simulate the propagation of errors that occur during the circuit @xcite .",
    "this avoids having to store the complete state of the computer which we assume is an arbitrary codeword state perturbed by the errors .",
    "the circuit is deemed to fail if a readout of the data qubits at the end of the circuit in either the @xmath1 or @xmath2 basis would not produce the correct output .",
    "equivalently , a circuit is defined to have succeeded if an errorless error correction cycle applied to its output state would produce the correct state .    for @xmath23",
    "we perform many simulations of the entire two level circuit with a fixed error rate and tally the failures . at each physical circuit location",
    "we apply an error with probability @xmath3 . for all single qubit locations ( preparation , measurement , memory )",
    "the error is a randomly selected single qubit pauli error , @xmath1 , @xmath24 , or @xmath2 . for two - qubit locations ( cnot )",
    "the error is a randomly selected two - qubit pauli error ( @xmath25 , @xmath26 , @xmath27 , etc . )",
    "errors at all locations are independent .    for error rates below @xmath28",
    "the number of trials required to generate sufficiently accurate statistics directly is too large ; so we use an alternative approach . instead of giving each circuit location some probability of error , we simulate the circuit with exactly @xmath29 errors placed randomly .",
    "this is repeated many times for @xmath30 $ ] to generate the probability @xmath31 that the circuit fails given that there were @xmath29 errors .",
    "these conditional probabilities can be combined to give the failure rate of the circuit as a function of @xmath3 , @xmath32 where @xmath33 is the number of locations in the entire circuit , 72657 .    to ensure randomness over the large number of trials required we use the simd - oriented mersenne twister pseudo random number generator @xcite .",
    "the results of the simulations are in fig .",
    "[ fig : results ] .",
    "note that eq .",
    "[ eq : expansion ] is truncated after @xmath34 after which @xmath31 is set to equal zero .",
    "this is why the curves drop to zero at higher error rates .",
    "a second set of lines connect the direct data points taken above @xmath35 .",
    "our simulations indicate that all combinations of four errors are corrected by mpec .",
    "this is in contrast to standard error correction which fails for some four error combinations . for values of @xmath3 close to the threshold , @xmath36 ,",
    "the failure rate is not significantly reduced , but for @xmath37 the failure rate is reduced by a factor of @xmath38 the superscripts indicate standard error correction and message passing error correction .",
    "in the region of interest - for physical error rates where two or three levels of error correction is sufficient for logical computation - mpec is significantly better than standard quantum error correction .",
    "we emphasize that this benefit is achieved only at the cost of additional classical processing . for more than two levels of error correction",
    "the benefit can be compounded , but the problem of finding an optimal and general flagging scheme ( one that can be applied at all levels ) is an open question and the subject of further work . also of interest",
    "is that the complexity of correctly interpreting the super syndrome appears to depend on the circuits that are used to extract the syndrome .",
    "can mpec work fault tolerantly for other codes such as the steane code @xcite and if so is it compatible with the most compact steane circuits @xcite ?",
    "we acknowledge the assistance of anthony agius , geoff attwater , magdalena carrasco , andrew greentree , charles hill , and lloyd hollenberg .",
    "we acknowledge the support of the australian research council ( arc ) , the us national security agency ( nsa ) , and the army research office ( aro ) under contract number w911nf-04 - 1 - 0290 .",
    "the primary purpose of this section is to demonstrate that the circuits and rules described in section [ sec : method ] satisfy the fault tolerance condition , eq .",
    "[ eq : ft rule ] . in doing",
    "so we also give examples of flag propagation and flag matching which could be useful for a general understanding of the mpec scheme .",
    "it is important to note that the [ [ 9,1,3 ] ] bacon - shor subsystem code has some symmetries which can be used to greatly simplify the fault tolerance analysis .",
    "the nine data qubits form a 3x3 grid for which the rows essentially form a repetition code that protects against @xmath1 errors and the columns a repetition code that protects against @xmath2 errors ( fig .",
    "[ fig : ec circuit ] ) .",
    "the code is defined to take the binary addition of the columns / rows for the syndrome , so that any even number of @xmath1 errors on a column is benign and even number of @xmath2 errors on a row is benign .",
    "the entire error correction circuit consists of three sets of the circuit shown in fig .",
    "[ fig : ec circuit ] run in parallel followed by three sets of the equivalent @xmath2 syndrome extraction . as @xmath1 and @xmath2 error correction",
    "are similar and operate independently , and all errors and flags from circuits performed in parallel are added in binary at end of the syndrome extraction , only a single block ( the circuit in fig .",
    "[ fig : ec circuit ] ) need be considered .",
    "all errors and flags on parallel circuit blocks are equivalent to the same errors and flags on a single block .",
    "although these symmetries are used for our explanations and diagrams , our simulations always used the full circuits with both @xmath1 and @xmath2 errors .",
    "cnot gates copy @xmath1 errors from the control to the target , and copy @xmath2 errors from the target to the control .",
    "@xmath39 flags represent potential errors and so they are propagated in the same way that the errors are .",
    "each flag that is raised is given a unique identity , but they can by copied to multiple qubits by cnot gates in the same way that errors are . for the diagrams in this section the flags are distinguishable by their patterns .",
    "a set of flags is said to match the syndrome if identifying those flags as errors can exactly describe the measured syndrome .",
    "when testing for a flag match , each ancillary qubit has its flags added in binary , flags that are not part of the set to be tested are ignored , if the result of all the ancillary qubits is identical to the syndrome then the set of flags is a match .    the figures shown in this section depict the propagation of flags and errors on the second level of error correction .",
    "it is implicit that at every circuit location there is a lower level of error correction being performed which can raise flags .",
    "these flags are indicated by the flags drawn on the circuits .",
    "crosses indicate a level-1 error ( or correction at the end of the circuit ) . the propagation of the errors is shown using bold lines . at the end of the circuit ,",
    "the figures show the values of the syndrome measurements and the flags that have propagated onto the ancilla .",
    "the flags used in a flag match are highlighted and corrections are shown by crosses at the end of the circuit .",
    "the flags and crosses result from physical errors during the lower level error correction .",
    "the error weights of these locations can be inferred from table [ tab : outcomes ] .",
    "errors during the cnot gates can result in flags and errors on both qubits ( fig .",
    "[ fig : cnot errors ] ) . in these cases",
    "the number of physical errors during the cnot limit the error weight of each logical qubit .    to demonstrate that eq .",
    "[ eq : ft rule ] is satisfied ( ie . that the error weight of the output from an ec box is no greater than the number of errors occurring inside the box )",
    "we reason on a case by case basis with cases grouped according to the weight of the incoming errors .",
    "[ fig : mpec fail1 ] shows how a single @xmath14 can cause failure by masking the flags of two @xmath7s . for this failure to occur",
    ", the two @xmath7s and the @xmath14 must each affect different qubit lines ( rows for @xmath2 errors , columns for @xmath1 errors ) .",
    "[ fig : mpec fail2 ] shows that a pair of @xmath14s can match the syndrome of a @xmath41 and thus cause the wrong correction to be applied .",
    "again , each of the @xmath14s and the @xmath41 must affect different qubit lines . if there is a flag from an @xmath14 that follows the same path as a @xmath41 , the combination of the @xmath41 and the @xmath14 is equivalent to an @xmath7 .",
    "a single incoming @xmath7 can not be masked by one or two @xmath14s .",
    "the two @xmath14s can be positioned to make a two - flag match , but mpec will always prefer to use the single flag match which is provided by the @xmath7 .",
    "this time , we have the freedom to place a single @xmath14 anywhere within the circuit . but this does nt affect any of arguments given for @xmath44 .",
    "an @xmath14 can not interfere with the correction of a single incoming @xmath7 or @xmath41 no matter where it is placed .",
    "one of the important properties of the ec circuit we have chosen is that no single @xmath14 can mask an error to prevent its correction , because each incoming error on the data will affect two of the ancillary qubits .",
    "this property is not a feature of all ( conventionally ) fault tolerant circuits .",
    "cnot errors can that result in @xmath46 pairs in addition to an incoming @xmath7 ( fig .",
    "[ fig : mpec3 ] ) , but not in any configuration that will cause problems .",
    "the @xmath14 and @xmath7 from cnot failure can be thought of as an effect on the same data qubit line . with this in mind",
    "it is clear that no situation like fig .",
    "[ fig : mpec fail1 ] can occur without extra errors .",
    "with @xmath48 there must be an incoming @xmath14 on one of the data qubits .",
    "three physical errors inside the ec box is still only enough to cause failure at one location , but this time there may be a @xmath41 .",
    "if flag from the @xmath14 matches the syndrome , this will result in successful correction .",
    "there can be a @xmath41 that produces a syndrome with no flag match .",
    "when there is no flag match mpec falls back to the conventional bacon - shor error correction rules for this circuit .",
    "this will either result in a successful correction of the failure ( if it occurs before or during the first set of cnots ) or a parity mismatch on the syndrome and hence no correction .",
    "with @xmath49 it is acceptable to let a @xmath41 or @xmath7 leave the ec box , eg .",
    "[ fig : mpec4 ] .      with @xmath51 there can either be two separate flagged failure locations , or one @xmath41 location and one @xmath14 location .",
    "as we have already seen , the @xmath41 cases are all work in the same way as they do for conventional error correction .",
    "the worst case is shown in fig .",
    "[ fig : mpec5 ] , where two pairs of physical errors case two @xmath7 pairs .",
    "when this happens there will be a two flag match which will not correct all of the errors but will not cause logical failure . since @xmath51 it is acceptable for the ec box to let through a single @xmath41 or even two @xmath7s .",
    "with @xmath51 there are still not enough errors to affect two data qubits with errors and have a flag on the third line ( fig .",
    "[ fig : mpec fail1 ] ) or to have a @xmath41 on one data qubit that matches misleading flags on the other two qubit lines ( fig .",
    "[ fig : mpec fail2 ] ) .",
    "having demonstrated in appendix [ sec : ap .",
    "a ] that eq .",
    "[ eq : ft rule ] is satisfied , in this section we aim to prove that improved failure rate scaling for mpec extended rectangles found in section [ sec : simulation ] carries over to arbitrary length logical computation .",
    "for simplicity we consider only identity gates at the logical level , but it is not hard to extend this proof to an arbitrary logical circuit given standard requirements of fault tolerant circuits , which are already satisfied by the bacon - shor code ( eg . transversal gates ) .      an error correction box is defined to have succeeded if an errorless error correction cycle applied to its output state would produce the correct state .",
    "ie . if an ec box succeeded then any errors remaining on the output can be corrected .",
    "let @xmath52 be the physical error weight of the input state to the @xmath6 ec box , and @xmath53 be the number of physical errors occurring inside the @xmath6 ec box .",
    "let @xmath54 denote the success of the @xmath6 ec box .",
    "then the success condition can be written as @xmath55      no initial errors : @xmath56 all extended rectangles have at most four errors , that is , the sum of the errors in any two adjacent ec boxes is no more than 4 : @xmath57 mpec is fault tolerant , as described in section [ sec : fault tolerance ] and demonstrated in appendix [ sec : ap .",
    "a ] : @xmath58      suppose @xmath60 , then @xmath61 by the fault tolerance rule , eq",
    ".  [ eq : ft logic ] ( with @xmath62 added to both sides ) .",
    "therefore , using eq .",
    "[ eq : ex - rects ] we have @xmath63 with eq .",
    "[ eq : a0b0 ] and eq .",
    "[ eq : induction rule ] , @xmath64 is true by induction . with eq .",
    "[ eq : ft logic ] we then have @xmath65 for all @xmath66 .",
    "therefore @xmath67 which with eq .",
    "[ eq : success condition ] means success for all ec boxes . @xmath68"
  ],
  "abstract_text": [
    "<S> inspired by knill s scheme for message passing error detection , here we develop a scheme for message passing error correction for the nine - qubit bacon - shor code . </S>",
    "<S> we show that for two levels of concatenated error correction , where classical information obtained at the first level is used to help interpret the syndrome at the second level , our scheme will correct all cases with four physical errors . </S>",
    "<S> this results in a reduction of the logical failure rate relative to conventional error correction by a factor proportional to the reciprocal of the physical error rate . </S>"
  ]
}