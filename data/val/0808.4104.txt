{
  "article_text": [
    "according to ironport s 2008 security trend report  @xcite , as much as 90% of inbound mail is spam today .",
    "morever , spam is no longer simply an irritant but becomes increasingly dangerous .",
    "83% of spam contains a url .",
    "thus , phishing sites and trojan infections of office and home systems alike are just one click away .",
    "state - of - the - art spam filtering techniques are based on content analysis ( e.g. spamassassin  @xcite ) , host reputation ( spamcop  @xcite , spamhaus  @xcite ) or authentication services ( spf  @xcite , dkim  @xcite ) . yet , with the increased use of attachment spam , success rate of content filtering decreases while its cost increases . at the same time , despite the initial reported success of blacklists , it has been shown recently that their effectiveness is challenged by a new generation of low profile , short - lived , and highly dynamic botnets used to send spam  @xcite .    consequently , new methods are needed to keep up with the spam arms race .",
    "one promising new approach to counteract this development is to focus on network - level characteristics of spammers .",
    "first , the network footprint of spamming activity can not be adapted as easily as the content of an email .",
    "second , the rapid increase of spam traffic poses significant processing , storage , and scalability challenges for end - host systems , creating a need to at least perform some fast `` pre - filtering '' on the network level .",
    "although the email content is not available in flow data , it can be used to profile potential spammers according to activities on other protocols and services offered .",
    "the network behavior of a legitimate email server is likely to be very different from a user pc acting as a botnet drone and sending spam .    to this end",
    ", a number of efforts have turned their attention towards network - level characteristics of spammers .",
    "for example , in an interesting recent study ramachandran et al .",
    "@xcite have studied spam with respect to ip address and as space and have demonstrated that clustering techniques can be applied to detect target domain patterns that are similar to those of spammers  @xcite . link analysis in mta graphs has been applied by  @xcite to identify potentially malicious nodes .",
    "gomes et al .",
    "@xcite showed that analysis of both static and evolving graph models allows to discriminate between socially unrelated spammer - receiver connections and socially related legitimate email traffic .",
    "finally , an extensive characterization of spam traffic was given by gomes et al .",
    "the authors highlighted differences between spam and legitimate emails with respect to a variety of aspects ( not necessarily network - related ) , such as workload , temporal patterns , or sender and receiver distributions .",
    "the majority of these works base their findings on mail server logs ( e.g.  @xcite ) while a smaller minority on network flow data  @xcite .",
    "log analysis provides detailed information about the local smtp traffic _ and the local spam filtering knowledge _",
    "( i.e. which connections got accepted or rejected , along with the reasons thereupon ) that goes far beyond simple reputation mechanisms , but is missing network - wide traffic statistics .",
    "collecting server logs from many email servers can somewhat improve the situation . yet , gathering logs from a large number of administration domains is a tedious process also involving privacy issues . on the other hand ,",
    "flow data contains information for a much larger number of hosts , collected passively in the core of the network .",
    "furthermore , flow traces are not limited to smtp traffic and could allow one to correlate the behavior between different protocols or services . yet , flow traces do not contain details about the content of smtp sessions as they are restricted to packet header information .",
    "most importantly , they do not right - away reveal the `` identity '' of a given connection with respect to the endpoints intentions ( legitimate , spam , scanning , etc . ) .",
    "we find that an `` either / or '' approach fails to combine the advantages of both methods , and suggest a different direction .",
    "our proposal is to try to exploit and combine the valuable ( and _ non - overlapping _ ) knowledge of local mail servers , on a network - wide scale , _ without actually collecting or looking at the individual server logs_.    as a first step towards this goal , this paper presents two main contributions .",
    "_ first _ , we show that email server s pre - filtering decisions can be accurately inferred directly from flow traces and therefore collected at the network core as illustrated in fig .",
    "[ fig : ispview ] . in particular , the distributions of smtp flow properties , such as byte or packet count , reliably indicate which smtp sessions were closed by the server before accepting contents . based on this , mta hosts can be classified as good or bad ( sending spam ) relying solely on packet header information .",
    "our approach is validated using server logs and public black- and white - lists . in other words , _ spammer identities and the countermeasures deployed by mail servers become visible in flow traces_.    to demonstrate the utility of these preliminary results , our _ second _ contribution in this paper is to discuss a number of potential applications that could benefit from our approach , including anti - spam technique validation , global spam monitoring , server monitoring , and novel network - level spam countermeasures . in short , we believe that the rich information offered by flow traces will be crucial in the fight against current and next - generation spammers .",
    "the rest of the paper is structured as follows . in the next section ,",
    "we describe our methodology and datasets used in this study . section  [ sec : results ] we present our results with respect to the flow characteristics of accepted and rejected connections on single - server , and network - wide scales .",
    "section  [ sec : discussion ] describes a number of potential applications , as well as some limitations of our approach .",
    "finally , we conclude this work in section  [ sec : conclusion ] .",
    "in this section , we briefly describe our methodology and the datasets used for our study .",
    "as stated earlier , our goal is to combine the local knowledge available at individual email servers , on a network - wide level . to this end , we need first a model of the network - level behavior of an email server .    consider the email reception process depicted in fig .",
    "[ fig : filteringphases ] .",
    "the first phase is the tcp three - way handshake initialized by the client . in the second phase ,",
    "the email envelope is sent , according to the smtp protocol  @xcite . at this stage",
    ", the server may apply certain pre - filtering rules to early close smtp sessions from suspected spammers and in turn save valuable network , cpu and storage resources .",
    "if the server decides to go on , the email content is then transmitted in the third and last phase .    here",
    ", we are interested in the pre - filtering phase . during this phase ,",
    "the server combines local and global knowledge to decide whether a new connection is a spam attempt .",
    "local knowledge , for example , helps to decide whether the receiver address actually belongs to the server s domain ( open relay attempt ) or targets an existing user .",
    "furthermore , greylisting could be used as a local reputation - based service .",
    "global knowledge refers to the various open and commercial services , known as `` blacklists '' , listing whether a sender has been known to send unsolicited content in the past . only if the client does not `` clear ''",
    "the pre - filtering phase the smtp session is closed by the server .    we analyzed the logs of a university email server and show the top reject reasons in table  [ tab : reject ] . as much as 78.3% of the smtp sessions were rejected in the pre - filtering phase .",
    "rejects based on local information ( including many reasons subsumed in _ others _ ) make up for roughly 45% of the reject reasons .",
    "_ these results nicely illustrate the importance of local mail server knowledge for spam detection . _    .reject reasons in pre - filtering . [ cols=\"<,>\",options=\"header \" , ]",
    "the above classification was derived from the logs of a single server .",
    "the question arises whether the results can be extended to other servers in the network . to address this question we now look at the total smtp traffic of the 50 most active email servers of the network .    because we could not get the server logs of all the servers we classify flows according to the membership of the sender in either a black- or whitelist .",
    "we are interested whether flows originating from blacklisted hosts exhibit characteristics similar to the rejected flows of the previous section .",
    "similarly , whitelisted hosts should mainly send accepted traffic and thus exhibit according flow characteristics .",
    "exemplified for flow sizes , figure  [ fig : sizeslist ] shows that , indeed , the shape of rejected and accepted flows is nicely reflected by the black-/whitelisted curves .",
    "the cdf of blacklisted traffic rises in the region of 300 bytes and achieves a ratio of 92% at 1500 bytes . in contrast , the cdf ot the whitelisted traffic stays on a low level of 10% up to 1500 bytes and starts to increase above 1500 bytes .",
    "yet , the fraction of whitelisted flows below 1500 bytes is not so small as for accepted traffic in fig .",
    "[ fig : sizeslog ] .",
    "we assume this is due to applied greylisting in servers , which leads to a number of rejected flows even for whitelisted hosts .",
    "in addition , whereas the fraction of rejected flows smaller than 1500 bytes was 99% in fig .  [",
    "fig : sizeslog ] , we now have a slightly smaller ratio of about 92% for blacklisted flows .",
    "this means that the ensemble of the top 50 servers has a less aggressive pre - filtering configuration than the single email server studied before .",
    "also , if other servers use a blacklist that performs worse than spamhaus , the blacklist used by our server , this effect would be expected .",
    "that also implies that less knowledgeable servers could benefit from the knowledge of servers that are better configured , that is , servers that exhibit a sharper reject curve .",
    "again , the curve of all traffic is dominated by blacklisted flows .    summing up",
    ", these results imply that the discriminating power of the three metrics ( bytes per flow , packets per flow , and bytes per packet ) with regard to spamming activity is also valid in a network - wide setting .",
    "[ [ impact ] ] impact + + + + + +    in this paper , we established a passive measurement method for detecting the mail server s acceptance of email sending attempts .",
    "the method requires no additional communication or configuration changes on the mail server . to our best knowledge , this is the first method that scales to _ large networks _ and _ passively _ transfers knowledge about spam from the edge of the network ( servers ) to the core ( as shown in fig .",
    "[ fig : ispview ] ) .",
    "although the proposed method is quite simple and based on few basic flow characteristics , we believe it paves the way towards more sophisticated algorithms for network - level spam detection that could successfully complement existing methods .    servers at the edge of the network have local knowledge , such as the user database or the email envelope , that is not accessible at the core of the network .",
    "further on , servers correlate this knowledge with services ( dbl , spf ) to improve the accuracy of their decision . with the presented method it is possible to concentrate the local decisions of several email servers in the core of the network .",
    "this approach can be interpreted as a distributed computer cluster where the email servers perform a detection algorithm on part of the global smtp traffic and we are then collecting the results .    mail servers only see their own traffic . in the core of the network",
    "we have the `` bird s eye view '' over the activity of all nodes .",
    "this allows to correlate the gained information from one email server with the information of many others .",
    "further on , our approach is not restricted to smtp traffic and , therefore , one can try to find suspicious behavior in other protocols , too ( a subject of future work ) .",
    "although being only a first step , we believe the proposed method has important potential applications in production networks and also paves the way for future research in the area of network - level and network - wide characteristics of spam traffic . in the rest , we try to illustrate some of these applications .",
    "[ [ isp - use - case ] ] isp use case + + + + + + + + + + + +    _ network - wide spam monitoring : _ by looking at the flow characteristics of incoming email traffic , an isp is now able to _ estimate the total spam traffic _ collected by its network .",
    "furthermore , it is possible to focus on the statistics of a specific server and to _ detect potential performance problems_. for example , figure  [ fig : overtime ] shows the three categories of flows that arrive at an email server inside the network in 15 min",
    ". intervals . on 18 .",
    "feb at 6:00 , the server rejects up to 80,000 flows .",
    "we think that this event corresponds to a spam campaign arriving at the server . during this time , the server is probably overloaded and starts rejecting connection attempts .",
    "three similar events are visible at the end of the week . these events are visible on other severs as well and are therefore of a distributed nature .",
    "we believe that an isp could monitor its network thus , and re - act in near real - time to such suspicious events .    as a second observation ,",
    "note how the diurnal pattern of rejected / failed flows has an offset of approximately 6h compared to accepted flows .",
    "since the local time zone of the server is gmt+1h , this indicates that most spam to that server is sent from time zone gmt-5h ( including eastern usa ) .    _",
    "internal server monitoring : _ in addition , the isp could _ rate servers _ by calculating the ratio of accepted vs. rejected flows for each server .",
    "this ratio could be used to to detect open relay servers or servers with a suboptimal pre - filtering process , triggered by an unusually high number of accepted flows .",
    "these misconfigured servers produce unnecessary and costly traffic .",
    "the isp can now take counteractive measures .",
    "for example , fig .",
    "[ fig : perserver ] shows the flow size curves for different mail servers in our network .",
    "some of the servers perform a very aggressive pre - filtering ( server a ) while others do not seem to care too much about it ( server c ) .    by monitoring the three categories of outgoing smtp traffic ,",
    "the isp could infer the reputation of internal sources .",
    "for example , the reputation could be calculated as the ratio of accepted versus total flows .",
    "based on this value , the isp would be able to _ detected blacklisted internal servers _ or servers abused for a spam campaign . with the same method , _ spamming botnet members _ inside the network",
    "could possibly be detected by the isp .",
    "_ rating external email sources : _ further the internal servers could be used as agents of a collaborative filtering system .",
    "the external mail senders could be rated based on the three categories of their incoming and outgoing smtp traffic .",
    "this system could be used to possibly even filter out spam on the edge of the network .",
    "the rating of the external email sources could be published as a service for other email servers .",
    "given that an operator is already collecting flow data , e.g. for accounting , the data required by the outlined applications is already available .",
    "there is _ no need to correlate the traffic again _ with different blacklists or other sources .",
    "the email servers have already done this work . to implement a similar service without flow data ,",
    "the isp would have to contact each mail server administrator to get access to their local server log .",
    "this process is bound to be cumbersome or even impossible due to privacy issues . with our approach",
    "only one sensor must be maintained .",
    "[ [ limitations ] ] limitations + + + + + + + + + + +    tracing the footprints of pre - filtering methods in network traffic has the inherent limitation that it only detects patterns if pre - filtering is applied by servers in the first place .",
    "however , in production environments it is the email administrator s intention to block spam as early as possible to save network , cpu and storage resources .",
    "pre - filtering is the preferred choice to achieve this .",
    "moreover , pre - filtering allows to reduce the amount of non - delivery messages to be sent  @xcite .",
    "therefore , we believe it is reasonable to rely on the presence of pre - filtering in production networks .    in principle , spammers could adapt to our method by prolonging the envelope phase , e.g. by sending multiple rcpt or helo commands or providing very long sender email addresses .",
    "however , any deviation from normal smtp behavior could again be detected and mail servers could enforce the shortness of the envelope as there is no need to be overly long .",
    "mail server administrators are engaged in an arms race against spammers .",
    "they urgently need new approaches to fight state - of - the - art attachment spam increasingly originating from low - profile botnet spammers .    in this paper",
    ", we demonstrated that simple flow metrics , such as byte count , packet count , and bytes per packet , successfully discriminate between spam and ham flows when pre - filtering is deployed in mail servers .",
    "thus , one could infer individual mail server s decisions with respect to the legitimacy and acceptance of a given connection .",
    "this allows an operator i ) to concentrate dispersed mail server knowledge at the network core and ii ) to passively accumulate network - wide spam statistics , profile filtering performance of servers , and rate clients .",
    "thus , the advantages of flow and server log analysis finally meet at the network core .",
    "we believe this is an important step towards successfully fighting spammers at the network - level .",
    "s.  frei , g.  ollmann , and i.  silvestri .",
    "mail ddos attacks through non delivery messages .",
    "http://www.techzoom.net / papers / mail_non_delivery_notice_attacks_2004.pd% f[http://www.techzoom.net / papers / mail_non_delivery_notice_attacks_2004.pd% f ] , 2004 .      l.  h. gomes , c.  cazita , j.  m. almeida , v.  almeida , and j.  wagner  meira . characterizing a spam traffic . in _",
    "imc 04 : proceedings of the 4th acm sigcomm conference on internet measurement _ , pages 356369 , new york , ny , usa , 2004 ."
  ],
  "abstract_text": [
    "<S> despite a large amount of effort devoted in the past years trying to limit unsolicited mail , spam is still a major global concern . </S>",
    "<S> content - analysis techniques and blacklists , the most popular methods used to identify and block spam , are beginning to lose their edge in the battle . </S>",
    "<S> we argue here that one not only needs to look into the network - related characteristics of spam traffic , as has been recently suggested , but also to look deeper into the network core , in order to counter the increasing sophistication of spam - ing methods . yet , at the same time , local knowledge available at a given server can often be irreplaceable in identifying specific spammers .    to this end , in this paper we show how the local intelligence of mail servers can be gathered and correlated _ passively _ at the isp - level providing valuable network - wide information . </S>",
    "<S> specifically , we use first a large network flow trace from a medium size , national isp , to demonstrate that the pre - filtering decisions of individual mail servers can be tracked and combined at the flow level . </S>",
    "<S> then , we argue that such aggregated knowledge not only can allow isps to develop and evaluate powerful new methods for fighting spam , but also to monitor remotely what their `` own '' servers are doing . </S>"
  ]
}