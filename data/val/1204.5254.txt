{
  "article_text": [
    "the hartree - fock - bogoliubov ( hfb ) equation of the density functional theory ( dft ) is suitable for describing superfluid fermi systems by properly accounting for the self - consistent coupling between the particle - hole and particle - particle mean fields .",
    "recently , we solved hfb equations in complicated geometries to describe nuclei and ultra - cold polarized fermi gases  @xcite .",
    "the general hfb equation for a polarized system can be written as : @xmath0 where @xmath1 and @xmath2 are hartree - fock hamiltonians for the two spin components , @xmath3 and @xmath4 are the corresponding chemical potentials , and @xmath5 is the pairing potential .    in some cases , solving the hfb equation in large boxes in coordinate space is essential .",
    "weakly - bound nuclei and the large - amplitude nuclear collective motion such as fission and fusion are examples of problems that require large - box calculations  @xcite .",
    "the ultra - cold atoms trapped in elongated optical traps also require a description involving large spatial dimensions @xcite , as well as hfb description of nucleonic pasta phases in the neutron star crusts @xcite .",
    "all these problems are both interesting and important but the underlying calculations are challenging .",
    "many hfb solvers used in the nuclear physics context are based on the basis expansion method employing harmonic oscillator wave functions .",
    "the configuration - space method is efficient but offers a fairly poor accuracy for cases involving weakly - bound systems and large deformations , see discussion in ref .",
    "on the other hand , solving hfb equations directly in coordinate - space can offer very precise results .",
    "unfortunately , because of numerical challenges involved , hfb calculations in non - spherical geometries require high computation cost . in this context ,",
    "multi - core processor architectures such as the jaguar and kraken cray xt5 with 12 cores per node , or hopper cray xe6 supercomputer with 24 cores per node , promise to revolutionize the deformed hfb problem . to fully take advantage of unique computational capabilities , hfb solvers should be adapted and improved in terms of scalability .    to this end , we developed two parallel hfb codes : 2d hfb - ax for axially symmetric systems and madness - hfb for fully 3d systems .",
    "both solvers take advantage of modern multi - core architectures .",
    "the following sections , overview computational and numerical techniques employed by these two codes and present benchmark calculations for ultra - cold fermi atoms . to illustrate the deformed hfb problem in coordinate space",
    ", we present an extreme application to novel pairing phases in polarized cold fermi gases in extremely elongated traps  @xcite .",
    "in hfb - ax  @xcite , the wave functions are discretized on a 2-d grid ( @xmath6 , @xmath7 ) with the @xmath8-order b - splines : @xmath9 where the coefficients @xmath10 can be obtained by diagonalizing the hamiltonian matrix .     left : performance of the complex eigensolver zgeev_a using different number of threads ( zgeev_a is a modified version of lapack s zgeev ) .",
    "right : performance of the complex matrix multiplication routine zgemm .",
    "the two routines are employed by hfb - ax and tested on jaguar with the xt - libsci/10.5.0 library.,scaledwidth=80.0% ]    to reduce computational costs , we assume reflection symmetry ; hence , the intrinsic parity @xmath11 is a good quantum number that can be used to enumerate hfb eigenstates .",
    "another quantum number preserved by hfb - ax is the angular momentum projection @xmath12 on the symmetric axis .",
    "the boundary conditions are implemented through first- and second - order derivative operators .",
    "the precision of computations depends on the mesh size , order of b - splines , and the box size .",
    "those parameters determine the numerical effort involved .    in hfb - ax ,",
    "the diagonalization of the complex hamiltonian matrix takes the bulk of the computing time .",
    "diagonalization blocks of given @xmath12 and @xmath11 quantum numbers are assigned to computing cores through mpi communications .",
    "we modified the lapack diagonalization routine zgeev to calculate only the selected eigenvectors . for calculations of a heavy nucleus with the mesh size of 0.6 fm , 10-th order b - splines , and a box size of 24 fm ,",
    "the rank of hamilton matrix is @xmath13=4608 . to take the advantage of multi - core architectures , we use the threaded lapack library , which can speed up the diagonalization by a factor of 3 with 6 threads , as shown in fig .",
    "[ threads](a ) . for the matrix multiplication problem in fig .",
    "[ threads](b ) , the routine zgemm scales perfectly . for other matrix operations , we use openmp for parallel calculations .",
    "the modified broyden method is used to accelerate the iteration convergence  @xcite .",
    "the hybrid mpi and openmp programming have made hfb - ax an accurate and fast hfb solver for large box calculations .",
    "besides the threaded library on cray machines , one can also utilize the threaded amd s acml library or the threaded intel mkl library . in the near future",
    ", the multi - core+gpu cray xt6 machine is expected , and the corresponding magma library  @xcite can further improve the capability of hfb - ax .",
    "the precision of hfb - ax has been demonstrated in calculations of weakly - bound nuclei in which the coupling to scattering continuum is essential  @xcite .",
    "in large - box calculations , very dense quasi - particle spectrum is obtained , and the non - resonant continuum contribution can be precisely taken into account by means of the direct integration @xcite .",
    "furthermore , hfb - ax is expected to provide precise solutions for the continuum qrpa description of excited states by means of the recently developed finite - amplitude method @xcite .",
    "the recent success of hfb - ax is the prediction of rapidly oscillating pairing potential in highly elongated traps @xcite by using the slda  @xcite and aslda  @xcite energy density functionals for polarized fermi gases .",
    "the software madness - hfb @xcite is a fast @xmath14 method based on the multiresolution analysis and low separation rank methods of representing and approximating functions and operators for solving schrdinger and lippman - schwinger equations up to user - determined precision @xmath15 .",
    "madness is an acronym for multiresolution adaptive numerical environment for scientific simulations @xcite .",
    "the application of multiresolution analysis separates the behavior of functions and operators at different length scales in a functional way .",
    "interesting mathematical and computational feature in our madness library implementation is that each of the operators and wave functions has its own adaptive structure of refinement to achieve and guarantee the desired accuracy .",
    "the representation of functions and operators in madness is based on an adaptive pseudo - spectral representations of functions and operators using the discontinuous alpert s multiwavelets @xcite and the low - separation rank representations and applications of green s functions .",
    "alpert s multiwavelets have compact support . for representing functions in 3d",
    ", we use tensor products of 1d multiwavelets .",
    "the two - scale relations provides for an adaptive approximation of the expansion in terms of multiwavelet basis as a function of accuracy in terms of the regularity of the solutions .",
    "the support of the bases functions in each level resembles that of structure adaptive refinement .",
    "a schematic figure of such a refinement process is shown in fig .  [ multi ] .     a schematic picture illustrating the two - scale generated refinement process of a multi - resolution representation of a function in 2d with 3-levels .",
    "]    using two - scale relations , the multiwavelet basis provides a way of constructing an adaptive pseudo - spectral method .",
    "the multiwavelet basis is a local basis of degree @xmath16 defined on the interval @xmath17 generated from scaling functions which are defined by shifted , rescaled and orthonormalized legendre polynomials from degree 0 to @xmath18 from @xmath19 with a value of 0 defined outside of @xmath17 .",
    "the subspace , of @xmath20 , spanned by scaling functions of degree @xmath16 is denoted by @xmath21 where @xmath22 is the @xmath23-th legendre polynomial on @xmath19 . for each level @xmath24",
    ", we further define an ascending sequence of the subspaces @xmath25 .",
    "specifically , @xmath26 ; the multiwavelets basis , denoted by @xmath27 , is the orthogonal complement of @xmath28 in @xmath29 . for each level @xmath24",
    ", we can further construct @xmath30 in the same way of shifting and rescaling the basis functions of @xmath27 as in @xmath31 to construct @xmath32 .",
    "thus ,    @xmath33    the notable features of the multiwavelet bases are that at each level the support of the basis functions are of width @xmath34 , and that there is an exact algebraic relationship between the basis functions at level @xmath24 and level @xmath35 .",
    "in particular , the coefficients of a representation of a smooth function in the multiwavelet basis decays proportionally to the width of the interval at level @xmath24 .",
    "thus , we can estimate the accuracy of the representation and truncate coefficients below a specified threshold for a sparse representation .    in 3d , we use a tensor product basis generated from the 1d multiwavelet basis ; the representation of operators uses a non - standard approximation or a low separation rank approximation based on gaussians .",
    "the structure of the support of a function resembles that of an oct - tree .",
    "each node of the oct - tree consists of a tensor of coefficients .",
    "the truncation of the sparse coefficients produce a pruned tree .",
    "the oct - tree is distributed across the nodes of a massively parallel computer referenced by a global hash - table for each node of the tree .",
    "the singular integral operators are represented using a low - separation rank approximation of the green s functions @xcite with details described in @xcite .",
    "the madness library uses a combined mpi and pthread parallel computing method in a task based computing model with a task graph scheduling and queue on each node . on each node of a parallel multicore computer",
    ", one core is devoted to processing internode communication via mpi , and one core is devoted to handling thread scheduling and task allocation and queue scheduling within the node .",
    "the code is polymorphic with the use of c++ templates .",
    "each operation on functions and the application of operators are defined in terms of tasks to be performed on the nodes or tensors of the `` oct - trees '' in the representation the functions or operators .",
    "in addition , a data path and flow path dependency analysis is performed to determine when different steps of the code can be overlapped and scheduled in each node s task queue so that distributed multi - threading computation can be performed .",
    "furthermore , since different functions and operations have different data and work - loads , a user directed dynamic load - balancing of data memory can be performed to permit more efficient data and work load distribution .    the solution methodology for the madness - hfb consists of two main steps : ( i ) diagonalization of the hamiltonian matrix using wave functions expanded in the multiwavelet bases in 3d , and ( ii ) computation of each of the wave functions using the associated lippman - schwinger equation .",
    "recall that the green s function for the operator @xmath36 is @xmath37 , the yukawa potential .",
    "the solving procedure is similar to that for solving hartree - fock problems  @xcite . in short ,",
    "the solution algorithm is :    * obtain a set of guess wave - function @xmath38 in the multiwavelet basis . *",
    "iterate until convergence : * * compute and diagonalize the hamiltonian matrix @xmath39 to obtain the latest orthogonal wave functions ; * * compute densities , properties and gradients ; * * compute the approximation of the yukawa potential for each eigenvalue @xmath40 ; * * solve the lippman - schwinger equation by convolving with the green s function based on yukawa potential , @xmath41 . * compute observables .",
    "we carried out benchmark calculations with hfb - ax and madness - hfb for 100 ultra - cold fermionic atoms in elongated traps .",
    "the cold fermions at the unitary limit can be described by the superfluid density functional slda  @xcite .",
    "the single - particle hamiltonian of slda can be written as : @xmath42 where the deformed external trap potential is : @xmath43.\\ ] ] the densities of spin - up ( @xmath44 ) and spin - down ( @xmath45 ) atoms , the pairing densities @xmath46 , and pairing gaps @xmath5 can be expressed in terms of the hfb two - component eigenvectors ( [ hfbm ] ) : @xmath47 where @xmath48 and @xmath49 is the regularized pairing strength . in eq .",
    "( [ dens ] ) , @xmath50^{-1}$ ] and the temperature is @xmath51=0.01 . the parameters @xmath52 , @xmath53 and @xmath54 in eq.([slda ] ) are taken as 1.14 , @xmath550.553 and @xmath551/0.0906 , respectively @xcite .",
    "we work in trap units for which @xmath56 .",
    "the trap aspect ratio @xmath57 in ( [ vtrap ] ) denotes the trap elongation . in experiments ,",
    "the adopted optical trap is highly elongated with @xmath57 up to 50  @xcite .",
    "the highly elongated trap is interesting because it provides a connection to quasi one - dimensional systems . in madness - hfb",
    ", we employed very large boxes : @xmath58[-100 , 100 ] for @xmath59 and [ -160 , 160 ] for @xmath60 . in hfb - ax ,",
    "the 2d box sizes are 10.5@xmath6135 ( @xmath59 ) and 9.1@xmath6170 ( @xmath60 ) .",
    "the potential depth @xmath62 is 12 and 10 for @xmath59 and @xmath60 , respectively .",
    "pairing densities @xmath63 calculated by madness - hfb and hfb - ax for 100 polarized atoms in an elongated trap with @xmath59 ( left ) and @xmath60 ( right).,scaledwidth=80.0% ]    figure  [ compare ] displays the calculated pairing densities @xmath63 for ultra - cold fermi gas with polarization of 0.2 .",
    "the energy cutoff is taken as 6.75 and 5.05 for @xmath59 and 16 , respectively .",
    "it is seen that the two solvers agree very well at @xmath57=5 . at @xmath60",
    ", there appears a very small difference between hfb solutions ; this may be an indication that an even larger box is needed in hfb - ax .",
    "it is to be noted that at @xmath60 there appear coexisting solutions which are close in energy @xcite .",
    "figure  [ 3dview ] shows the 3d pairing density distribution computed by madness - hfb for very elongated system with @xmath60 .",
    "the characteristic transversal oscillations of the pairing field are indicative of the larkin - ovchinnikov phase @xcite .     pairing density @xmath64 , calculated by madness - hfb for the elongated trap with @xmath60 .",
    "the box scale in view is @xmath65[-12 , 12 ] , @xmath66[-12 , 12 ] and @xmath67[-32 , 32 ] .",
    ", scaledwidth=80.0% ]    in general , the computational effort of 3d hfb calculations is significantly greater than in the 2d case .",
    "thus , the adaptive representation using multiwavelet techniques and parallel computing are crucial for the success of madness - hfb .",
    "to put things in perspective , madness - hfb takes about 5 minutes per iteration on 5000 cores for @xmath59 and @xmath60 , while hfb - ax takes about 10 minutes per iteration for @xmath59 on 400 cores and 25 minutes for @xmath60 on 800 cores . from this trend ,",
    "we conclude that the parallel performance of madness - hfb is superior to hfb - ax in large - box calculations .",
    "the coordinate - space hfb solvers hfb - ax and madness - hfb have been developed for large - box calculations of superfluid fermi systems .",
    "the 2d solver hfb - ax has been adapted to the multi - core supercomputers by using a hybrid mpi and openmp programming model .",
    "the 3d solver madness - hfb is based on multi - resolution multiwavelet techniques and more sophisticated hybrid mpi and pthreads based task parallelism programming methodologies .",
    "a scaling benchmark test for 100 ultracold fermions in elongated traps has been carried out .",
    "developments are underway to efficiently use the next generation of multi - core+gpu architectures for more demanding nuclear problems .",
    "this work was supported in part by the u.s .",
    "department of energy under contract nos .",
    "de - fg02 - 96er40963 ( university of tennessee ) and de - fc02 - 09er41583 ( unedf scidac collaboration ) .",
    "it is also partially sponsored by the office of advanced scientific computing research ; u.s .",
    "department of energy .",
    "the work was partially performed at the oak ridge national laboratory , which is managed by ut - battelle , llc under contract no",
    ". de - ac05 - 00or22725 .",
    "computational resources were provided through an incite award  computational nuclear structure \" by the national center for computational sciences ( nccs ) and national institute for computational sciences ( nics ) at oak ridge national laboratory , and the national energy research scientific computing center ( nersc ) ."
  ],
  "abstract_text": [
    "<S> the self - consistent hartree - fock - bogoliubov problem in large boxes can be solved accurately in the coordinate space with the recently developed solvers hfb - ax ( 2d ) and madness - hfb ( 3d ) . </S>",
    "<S> this is essential for the description of superfluid fermi systems with complicated topologies and significant spatial extend , such as fissioning nuclei , weakly - bound nuclei , nuclear matter in the neutron star rust , and ultracold fermi atoms in elongated traps . </S>",
    "<S> the hfb - ax solver based on b - spline techniques uses a hybrid mpi and openmp programming model for parallel computation for distributed parallel computation , within a node multi - threaded lapack and blas libraries are used to further enable parallel calculations of large eigensystems . </S>",
    "<S> the madness - hfb solver uses a novel multi - resolution analysis based adaptive pseudo - spectral techniques to enable fully parallel 3d calculations of very large systems . in this work </S>",
    "<S> we present benchmark results for hfb - ax and madness - hfb on ultracold trapped fermions . </S>"
  ]
}