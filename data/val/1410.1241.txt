{
  "article_text": [
    "dark matter haloes play a crucial role in galaxy formation and evolution .",
    "they provide gravitational potential wells that are deep enough to gather baryons together within a hubble time  @xcite .",
    "stars are born within cold gas clouds which either form at the centre of dark haloes via cooling  @xcite or within filaments of cold material which pervade the large scale structure of the universe  @xcite .",
    "these stars form and feed galaxies which are assembled into galaxy groups or clusters via the hierarchical clustering of their haloes .",
    "eventually , halo mergers give rise to galaxy mergers , as subhaloes fall into the central region of their main halo .",
    "thus , the evolution of haloes is directly involved in the formation and evolution of galaxies .",
    "one of the leading approaches for modeling galaxies in the @xmath1cdm cosmology uses semi - analytic models of galaxy formation ( sam ) .",
    "this approach uses the evolution of dark matter haloes to `` paint '' galaxies using phenomenological prescriptions of the baryonic physics governing galaxy formation .",
    "two different methodologies are used to produce the halo merger trees that are the backbones of sams .",
    "halo merger trees can be built by taking advantage of the extended press - schechter formalism  @xcite and monte carlo simulations .",
    "many sams have utilised this analytic method because it allows for the rapid construction of merger trees in large volumes with high mass resolutions  @xcite .",
    "@xcite made a comparison between several algorithms developed to construct halo merger trees using the extended press - schechter formalism .",
    "they showed that even when using the same formalism , differences in the details of the algorithms make halo merger trees with different growth properties .",
    "halo merger trees can also be constructed directly from n - body simulations . despite the time needed to run n - body simulations with high - resolution and the complicated process of finding haloes ,",
    "this method has become popular because it results in a more realistic evolutionary history of the haloes in various environments @xcite .    a series of processes are required to convert raw n - body simulation data into a format applicable to semi - analytic models .",
    "first , haloes are identified from the sea of hundreds of millions of particles in an n - body simulation .",
    "@xcite demonstrated that most of the widely - used halo - finding codes generate similar results ; however , poor resolution or dense environments can be problematic in terms of identifying substructures  ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "these halo - finding codes are then used to create halo catalogues , from which halo merger trees are constructed .",
    "* hereafter s13 ) analyzed the diversity of halo merger trees constructed by different tree building algorithms from a common halo catalogue .",
    "they stipulated the necessary conditions for reliable tree building codes : the codes should be able to trace particle transfers in order to link haloes in sequential snapshots ; analyze more than two snapshots simultaneously to restore any missing subhaloes , especially in dense regions ; and repair any transient artifacts in the halo properties , such as a sharp mass fluctuation .",
    "the influence of the specific halo finder on merger trees has been studied by @xcite who concluded that although the choice of halo finding algorithm itself was at least as important as the tree building routine the same types of issues arose for all the available halo finding methods .",
    "many previous studies using semi - analytic models have focused predominantly on improving the phenomenological prescriptions of the baryonic physics governing galaxy formation as the vast uncertainties in these processes are critical in understanding the observable universe .",
    "furthermore , aforementioned studies dedicated to  the dark universe \" imply that technical issues concerning dark matter halo merger trees can also impose other uncertainties when modeling the observable universe .",
    "thus , this study was proposed at the `` sussing merger trees '' workshop , as one of the follow - up studies for , to examine the effect of different merger tree building algorithms on galaxy properties using a semi - analytic model .",
    "this paper is organized as follows . in section 2 ,",
    "we briefly introduce the features of halo merger tree algorithms . in section 3",
    ", we describe the semi - analytic model used in this study .",
    "then , we demonstrate the impact of halo merger trees on galaxies in the semi - analytic model in section 4 , discussing the differences in galaxy properties and looking into whether different trees can produce similar results by calibrating the various parameters . in section 5 ,",
    "we summarise and present our conclusions .",
    "the halo catalogue used in this study was extracted from a cosmological n - body volume simulation of structure formation run using gadget-3  @xcite with the cosmological parameters derived from the _ wilkinson microwave anisotropy probe _ seven year observations  @xcite , @xmath2 , @xmath3 , and @xmath4 .",
    "the periodic cube size of the volume is @xmath5 on a side and the volume contains @xmath6 particles , resulting in a particle mass resolution of @xmath7 . to produce halo merger trees , 61 snapshots distributed between @xmath8 and @xmath9",
    "were used .",
    "after friends - of - friends ( fof ) groups were identified in each snapshot , we used subfind  @xcite to find sub - structures in the fof groups . for this work we set a mass threshold of @xmath10 ( 20 particles ) in order to limit ourselves to haloes that can be reliably identified .        in this study , we used halo merger trees that were generated using various tree building algorithms that have been independently developed by nine groups .",
    "all of the trees were constructed from the common halo catalogue , save in two special cases .",
    "figure  [ algorithm ] briefly shows the main features of the algorithms .",
    "the codes grow their trees principally using particle identifiers ( ids ) in each halo and/or halo trajectory information , such as the positions and velocities of the haloes .",
    "mergertree  @xcite , treemaker  @xcite , velociraptor  @xcite , and ysamtm  @xcite investigate particle transfer between haloes in two snapshots , one taken after the other , and then determine the most probable direct descendants .",
    "this scheme , however , may be insufficient to build sound merger trees .",
    "if a halo is close to a more massive halo or embedded in a dense environment , it could be misidentified or even missed by the halo finder .",
    "thus , in order to insert the missing links into the halo merger trees , d - trees  @xcite and sublink  ( rodriguez - gomez et al .",
    ", in prep . ) utilize additional information .",
    "these processes evaluate how tightly particles are bound to haloes to identify the most likely descendants .",
    "furthermore , they analyze the particle ratios in more than two consecutive snapshots .    unlike other algorithms , the hierarchical bound tracing ( hbt ) algorithm  @xcite builds halo merger trees while it finds subhaloes . starting from an input main halo catalogue ,",
    "hbt  builds merger trees of main haloes by matching particle ids between adjacent snapshots .",
    "once a merger is identified , the progenitor haloes are tracked in subsequent snapshots , and the self - bound remnant of progenitor haloes are identified as descendent subhaloes . as a result , every subhalo identified by hbt  must have an explicit progenitor that traces back before infall , with no missing link along its evolution history .",
    "because hbt  identifies its own set of subhaloes , it does not build merger trees from external subhalo catalogues .",
    "for the purpose of this study , we apply hbt  to the main haloes in the commonly supplied halo catalogue , and allow hbt  to generate a merger tree together with its own list of subhaloes .",
    "consistent trees  @xcite is the only method that makes use of both particle ids and halo trajectories .",
    "it first constructs primary merger trees by examining the origin of particles in descendant haloes , similar to the aforementioned algorithms .",
    "however , it additionally calculates the motion of the haloes using position , velocity , and mass profile information returned by the halo finder . by comparing the primary merger trees with these motion calculations , consistent trees  updates its original halo catalogue with the halo properties calculated by the additional processes .",
    "thus , consistent trees  also produces a modified halo catalogue , like hbt .",
    "jmerge  @xcite uses halo trajectories only to identify the descendant - progenitor relationship between two snapshots .",
    "it calculates the expected forward and backward positions of haloes in snapshot @xmath11 and snapshot @xmath12 at the midway point between the two outputs .",
    "with imposed limits on the allowed change in position , mass and maximum circular velocity , jmerge  matches haloes between the two snapshots .",
    "thus , it is sensitive to time resolution .",
    "further details of the aforementioned algorithms are described in .",
    "in this study , we used the semi - analytic model developed by  @xcite .",
    "this model has simple , but appropriate , ingredients to deal with the motion of subhaloes and baryonic physics for galaxy formation and evolution .",
    ".number and fraction of haloes . by column , the halo finding algorithm , the total number of haloes surviving to @xmath0 after removing those with abnormal histories , the number of main haloes and the number of subhaloes .",
    "these are the haloes that survived the tree cleaning process of ysam ( see text ) . [ cols=\"^,^,^,^\",options=\"header \" , ]     [ abnormal ]    we modified the merger trees that were constructed using the algorithms described in so that they would be applicable to our semi - analytic model .",
    "we first identified all the branches that corresponded to abnormal haloes : main haloes that disappear suddenly without merging and subhaloes that appear suddenly within a main halo without a physical trace in the previous snapshots .",
    "we then remove these from the merger trees .",
    "such  abnormal \" haloes happen when halo finders have difficulty identifying haloes from limited numbers of particles or when tree building algorithms do not correctly trace the descendants or progenitors between snapshots .",
    "if an algorithm fails to make a link between two haloes in two sequential snapshots , a halo in a later snapshot appears to be a new halo , losing its previous growth history .",
    "table 1 shows the number of haloes supplied to our semi - analytic model after removing abnormal branches .",
    "the total number varies from tree to tree ranging from 41750 to 72988 . while the number of main haloes , @xmath13 , are similar to each other , the number of objects finally identified as subhaloes , @xmath14 , is remarkably different between the algorithms .",
    "most of the small difference in @xmath13 between algorithms is attributed to the process in our sam that detects and removes the abnormal main haloes that suddenly appeared at @xmath0 without progenitors .",
    "they are fortunately rare , and thus correction for them makes little difference in @xmath13 .",
    "the number of subhaloes varies between the algorithms .",
    "d - trees , hbt , and sublink , each of which has additional processes to minimize missing links between snapshots , have more subhaloes than the others . for example , hbt  has four times more subhaloes than jmerge .",
    "consistent trees  was developed to minimize missing haloes but presents the second least number of subhaloes after jmerge .",
    "this is due to the fact that consistent trees  removes subhalo branches with big mass fluctuations , suspected to be the results of misidentification by halo finders .",
    "the difference in @xmath14 leads to a difference in halo and galaxy merger rates and histories , which in return affects galaxy properties .",
    "the real issue of missing haloes is that the tree building algorithms with higher missing halo fractions will have younger haloes as these missing haloes can re - appear at some point and they would be considered to be newborn haloes . as a result , these haloes will contain galaxies that are artificially young .",
    "fortunately , the fraction of the newborn haloes that are in actuality descendants of the missing haloes is only of order 1% when we inspect haloes of @xmath15 .",
    "this criterion corresponds to galaxy s stellar mass @xmath16 at @xmath0 according to the stellar - to - halo mass relation of  @xcite .",
    "the missing halo fraction naturally increases substantially as we lower the halo mass cut , as it is more difficult to identify smaller haloes and measure their properties accurately .      as demonstrated above some subhaloes",
    "suddenly appear without having a prior history as independent haloes .",
    "most of these are found in actuality to be the descendants of haloes missed by the halo finder in the previous snapshot , often due to the dense , crowded environment .",
    "thus for this study we remove any branches of the tree that are due to subhaloes that are suddenly born .    for the same argument",
    ", a subhalo can disappear before reaching 0.1@xmath17 of their main haloes . in this case",
    "we follow the evolution of a virtual subhalo and calculate its orbit .",
    "we assume that virtual subhaloes follow an isothermal profile truncated at @xmath17 .",
    "we first compute the dynamical friction using the prescription derived by  @xcite : @xmath18 \\right\\ } \\vec{e_{v } } , \\label{eqn : dynf}\\end{aligned}\\ ] ] where @xmath19 is the mass enclosed within @xmath17 for the satellite halo , @xmath20 is the distance from the centre of the main halo within which the satellite resides , @xmath21 is the coulomb logarithm with @xmath22 as formulated by  @xcite , @xmath23 is the circular velocity of the main halo at @xmath17 , and @xmath24 is the orbital velocity of the subhalo .",
    "when the subhalo reaches @xmath25 under this prescription(@xmath26 ) , the galaxy in the subhalo is considered to have merged into the central galaxy of the main halo .",
    "we also calculate a virtual subhalo s merger timescale , @xmath27 , using the following fitting formula introduced by  @xcite : @xmath28 } \\frac{m_{\\rm halo}}{m_{\\rm sat } } \\frac{r_{\\rm 200}}{v_{c } } , \\label{eqn : jiang}\\end{aligned}\\ ] ] where @xmath29 is the orbital eccentricity of the satellite , @xmath30 and @xmath19 are the @xmath31 of the halo and subhalo , @xmath17 is the radius of the main halo , and @xmath23 is the circular velocity of the main halo at @xmath17 .",
    "we assume the galaxy in the virtual subhalo merges with the central galaxy at the smaller timescale between @xmath26 and @xmath27 .",
    "tidal stripping leads to mass loss from subhaloes in dense environments .",
    "we calculate the radius at which the gravitational force exerted by a virtual subhalo and its main halo are equivalent , the so - called sphere of influence , as follows  @xcite :    @xmath32 ^{-1 } , \\ ] ] where @xmath20 is the distance between the centres of the virtual satellite and its main halo , @xmath33 is the @xmath31 mass of the virtual satellite halo , @xmath34 is the total ( dark matter+baryon ) mass of the main halo within @xmath20 , and @xmath35 is the angle between the line connecting a particle in the virtual satellite to the centre of the virtual satellite halo and the line connecting the centres of the virtual satellite and its main halo .",
    "we assume that dark matter outside this radius is tidally stripped on the dynamical timescale of the virtual subhalo , and the density profile of the virtual subhalo is instantly relaxed following the suggestion for a modification of the nfw profile by  @xcite .    finally , when a satellite galaxy merges with the central galaxy , not all of its stellar mass is added to the central galaxy .",
    "observations show that the stellar halo surrounding our own galaxy is composed in part from the remains of destroyed satellites .",
    "following observations for intra - cluster light in groups or clusters  ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and theoretical studies of their origins  @xcite , we scatter some stellar components from satellite galaxies over the main halo in our model .",
    "these components make up diffuse intracluster light in groups and clusters .",
    "the details of how we do this is not important for this study , so we refer interested readers to @xcite          here we briefly summarize the baryonic physics implemented in our sam .",
    "further details can be found in  @xcite .",
    "our model calculates the cooling of hot gas based on the models proposed by  @xcite and  @xcite .",
    "we assume that stars are formed in disks from a cold gas component , according to the simple law proposed by  @xcite .",
    "we enable merger - induced starbursts in our model by adopting the prescription in  @xcite , which is formulated using the hydrodynamic simulations performed by  @xcite .",
    "in addition , our model takes into account feedback processes .",
    "the prescription for supernova feedback comes from  @xcite .",
    "our sam includes both quasar - mode and radio - mode agn feedback , following the prescriptions proposed by  @xcite and  @xcite , respectively .",
    "our model also addresses some of the environmental issues that can affect the gas component of subhaloes ; for instance , the hot gas component can be stripped by tidal forces  ( see * ? ? ?",
    "* ) and ram pressure  @xcite .",
    "different halo growth histories give rise to different galaxy merger and gas accretion histories .",
    "thus , the effect of varying the halo merger trees is evident when we examine the growth history of an individual galaxy .",
    "figure  [ history ] shows examples of central galaxy mass growth histories derived from nine different halo merger tree building algorithms working on a common halo catalogue . even though the @xmath0 differences in stellar mass of these galaxies are small , the main haloes have different growth histories resulting in different evolutionary histories .",
    "we find that the galaxies grown in the trees extracted from similar algorithms naturally have similar properties .",
    "thus , mergertree , treemaker , velociraptor , and ysamtm , which all have similar algorithms , result in approximately the same galaxy merger histories , as well as final stellar mass in all cases . on the other hand , consistent trees , d - trees , hbt , jmerge , and sublink  show distinctive differences in the mass range where galaxy mergers are most frequent .    in this section ,",
    "we investigate the impact of different halo merger tree building algorithms on global galaxy properties ( as aggregates of individual galaxy properties ) , from the nine tree builders shown in figure  [ algorithm ] .      in order to cleanly evaluate the differences induced by the trees , we ran our sam using a common parameter set .",
    "the parameter set was initially optimized for the ysamtm  tree that we developed for the semi - analytic model used in this study .",
    "thus , the differences between the trees shown in this section do not indicate which tree is better or worse .          in semi - analytic approaches an initial hot gas reservoir , which is the main source of cold gas ,",
    "is seeded using the cosmic baryonic fraction ( @xmath36 ) and the halo mass .",
    "baryons additionally flow into haloes via smooth accretion , which we assume is shock heated to the virial temperature of the main halo .",
    "sometimes , galaxies can lose their hot gas if the halo harbouring them undergoes mass loss .",
    "thus , if there are no feedback processes capable of disturbing the gas , the growth history of a halo strongly correlates with its star formation history .",
    "figure  [ sfr2 ] shows the evolution of the mean star formation rates ( sfrs ) of galaxies living in main haloes within the given mass ranges at @xmath0 with and without feedback . in both cases",
    ", it is apparent that there are four distinct groups , classified according to the sfr histories .",
    "consistent trees , hbt , and jmerge  have distinct features from the other six trees .",
    "interestingly , the trees with similar sfrs are also based on algorithms that are similar as shown in figure  [ algorithm ] . as seen in all the panels , the mean sfrs of jmerge",
    "are always lower and peak later than the others .",
    "the spike on the sfrs of sublink , shown in the bottom left panel , appears due to a starburst induced by a major merger .",
    "the starburst is conspicuous in the mean sfrs because there are only 10 galaxies in the mass bin and galaxies without feedback have more cold gas .",
    "thus , one should not pay much attention to the spike and other wiggles in the most massive case ( first column in figure  [ sfr2 ] ) .        across all of the tree building algorithms and mass ranges , feedback processes",
    "reduce the sfrs to less than half of the no feedback values ( note the different y - axis scales ) .",
    "supernova feedback takes effect in small haloes , while agns become important at larger halo masses .",
    "the amount by which the sfrs are suppressed increases as the halo masses are lowered , from a factor of two for high mass haloes to a factor of three for the smaller haloes .",
    "this is entirely in line with previous work and required in order to produce galaxies with realistic stellar masses .",
    "on the other hand , the central galaxies in massive haloes ( @xmath37 ) experience a sharp decline in sfr over time due to agn feedback which effectively shuts off the star formation at @xmath38 .",
    "it has been suggested that super massive black holes ( smbhs ) grow primarily via mergers  @xcite .",
    "this process activates a quasar feedback mode which eventually terminates star formation by violently blowing away cold gas due to high accretion rates onto the smbh .",
    "furthermore , smbhs can persistently suppress star formation by radio mode feedback which is turned on at low gas accretion rates  ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "because the accretion rate in the prescription for the radio mode agn feedback in our model is proportional to the cube of the virial velocity  @xcite , central galaxies in more massive haloes are expected to show stronger radio mode feedback .",
    "however , smbhs in small haloes do not accrete material at a high enough rate due to a low merger rate for agn feedback to be the main channel of quenching star formation in this mass range .",
    "figure  [ gsfr1 ] presents the evolutionary histories of the global star formation rates ( gsfrs ) with and without feedback .",
    "there are trends here that are similar to those seen in figure  [ sfr2 ] .",
    "the gsfrs of jmerge  are always lower than the others .",
    "the star formation histories with feedback processes follow observations well , except for that of jmerge , which has the lowest peak amongst all of the trees .",
    "although the peak sfrs and the epochs at which the trees reach the peaks differ from each other , the final sfrs at @xmath0 are almost the same between the trees .",
    "this is mainly because the differences in halo growth history between the algorithms is prominent at early epochs when haloes are small and their mergers are frequent .",
    "thus , the uncertainty of progenitor - descendant relation between the trees is bigger in earlier epochs .",
    "on the other hand , the recent growth history of haloes does not differ much between the trees .     in a comoving volume .",
    "the dashed lines represent the number density of the central galaxies .",
    "the solid lines display the evolutionary history of the satellite number density.,scaledwidth=45.0% ]      as described in  3.2 , although all of the tree building algorithms used a common halo catalogue as a starting point , the number of trees and branches produced that are suitable for our semi - analytic model can vary .",
    "for instance , if there are missing links along a main branch the earlier progenitor haloes prior to the break were discarded by our semi - analytic model .",
    "thus , if an algorithm has additional processes to minimise the segmentation of merger trees , it can result in a larger number of galaxies at an epoch than other algorithms do .",
    "figure  [ ngal_evo ] shows the number density evolution of galaxies more massive than @xmath39 in a comoving volume for all of the tree builders . as expected",
    "the number density of the satellite galaxies varies , while that of the main galaxies is similar , even at high redshifts .",
    "additionally , our semi - analytic model calculates the orbits of the subhaloes that disappear from a halo catalogue before reaching the central region of the main halo .",
    "therefore , the number of satellite galaxies in the models is not always the same as the number of subhaloes that was initially provided by the halo catalogue . among all of the trees ,",
    "hbt  has the largest number of satellite galaxies at @xmath0 , followed by consistent trees , d - trees  and sublink .",
    "we are barely able to distinguish between those of mergertree , treemaker , velociraptor , and ysamtm  which are all very similar tree building algorithms .",
    "jmerge  has the smallest number of satellites .",
    "as the star formation history implies ( figure  [ sfr2 ] ) , jmerge  tends to have the shortest halo growth histories among all of the tree building routines ( figure  [ ngal_evo ] ) .",
    "it barely reaches the number density of central galaxies of other algorithms by @xmath0 , and the situation is even more striking for satellite galaxies . while consistent trees  does not have a distinguishable history in terms of the number density of main galaxies the story is not the same when it comes to satellites . even though it has the lowest number density at @xmath40 , it surpasses jmerge  with a rapid increase and ends up as second at @xmath0 .",
    "this is because consistent trees  prunes haloes that show large mass fluctuation , considered to be the outcome of misidentification by halo finders .",
    "subhaloes at high redshifts are more likely to undergo mass fluctuation due to their low mass , and thus many of them are removed by the algorithm .",
    "however , at the mass resolution of this model , there are 5 to 10 times more central than satellite galaxies at all redshifts and thus the large difference in the number of satellites does not cause a noticeable difference in the galaxy mass function as will be discussed later .",
    "( solid ) and @xmath41(dashed ) within a main halo with the indicated halo mass at @xmath0.,scaledwidth=45.0% ]        figure  [ ngal ] presents the mean number of satellite galaxies with stellar masses @xmath42 and @xmath43 per halo plotted relative to the main halo s @xmath31 at @xmath0 .",
    "hbt  has more satellites than the other tree building methods by virtue of its algorithm , which was developed specifically to track subhaloes . on the other hand , due to its algorithm",
    ", jmerge  has the smallest number of satellites .",
    "therefore , jmerge  loses many of its subhaloes when it builds merger trees .",
    "the other seven trees have almost the same number of satellite galaxies at all main halo masses .      in this section ,",
    "we describe our analysis of galaxy merger history and its contribution to the final galaxy mass .",
    "figure  [ merger1 ] shows the evolution of the mean merger rates of galaxies according to stellar mass for all epochs ( top panels ) and the history of the mean merger rates of central galaxies that end up in a given halo mass at @xmath0 ( bottom panels ) . because galaxy mergers is one of the channels that affects galaxy stellar mass , different merger rates lead to different compositions of the stars in terms of their origins",
    "there are some missing links in the most massive cases as seen in the bottom panels , and this is due to the lack of massive haloes .     of main haloes at @xmath0 .",
    "the residuals show the differences between the mean value of all the models and the fractions of the individual algorithms .",
    "the numbers in the bottom panel present the mean number of haloes at each mass bin , with intervals of 0.5 dex from 10.5.,scaledwidth=45.0% ]    consistent trees , hbt and jmerge  show notable differences for different reasons .",
    "first , consistent trees  trims haloes showing large mass fluctuations , as described in 4.1.2 , which occur more frequently in dense environments .",
    "hence , subhaloes in dense environments are often removed by this algorithm , which results in lower merger rates than others in some conditions ( e.g. , panels a , b , c , e , f ) .",
    "hbt  on the other hand shows lower merger rates ( panels b , c , f ) because subhaloes in hbt  have longer lifetime than those in the other trees .",
    "demonstrate that haloes in hbt  have the fewest direct progenitors among all the algorithms .",
    "if a tree building algorithm fails to trace a branch of a subhalo , then the subhalo would be regarded as being merged into its main halo as one of direct progenitors . accordingly , better algorithms in terms of tracking subhalo branches would have fewer direct progenitors on average . with its algorithm allowing itself to rigorously build the branches of subhaloes ,",
    "hbt  has the highest satellite number density across cosmic time , as shown in figure  [ ngal_evo ] , inevitably accompanying lower merger rates .",
    "jmerge  in the upper panels of figure  [ merger1 ] does not appear significantly different from other trees .",
    "it is a result of two facts about jmerge : there are fewer mergers but there are also fewer galaxies in a unit volume . in bottom panels ( in particular in panels e and f ) , jmerge  shows remarkably lower merger rates due to the fact that main haloes of jmerge  have fewer branches than those of the other trees . in the most massive cases ( panel d ) , however , all the algorithms are similar to each other because subhaloes haboring satellite galaxies with @xmath44 in massive haloes are also massive enough to be well tracked , regardless of the algorithms",
    ".    the different galaxy merger rates naturally result in varying stellar accretion rates .",
    "figure  [ accr ] shows the fraction of stellar mass accreted by central galaxies from mergers according to halo mass at @xmath0 .",
    "central galaxies in massive haloes @xmath45 accrete @xmath46 of their stars via mergers .",
    "this fraction rapidly falls with decreasing halo masses . with its low merger rates in the bottom panels of figure  [ merger1 ] , jmerge  has the smallest fraction .",
    "note that the most massive bin ( @xmath47 ) contains only one halo and thus is vulnerable to stochastic effects .",
    "for example in the case of d - trees , the central galaxy of the sole most massive bin has less than @xmath39 of stars that are born in - situ .",
    "sublink  shows a sudden break at the most massive range .",
    "it happens because the central galaxy undergoes a big starburst due to a gas rich merger ; it is just a stochastic effect as well . in short , the merger accretion rates , @xmath48 ,",
    "tightly correlates with halo mass mainly because the halo merger rate increases with halo mass .          in previous sections",
    ", we discussed the mechanisms that increase galaxy stellar mass .",
    "the star formation histories shown in figure  [ sfr2 ] reveal that , for our sam at least , galaxies in more massive haloes are born earlier and grow faster than those in less massive haloes .",
    "figures  [ merger1 ] and  [ accr ] clearly demonstrate that galaxies in more massive haloes are involved in more mergers , even at low redshifts , and thus acquire stellar mass predominantly from mergers .    in this study ,",
    "the ` formation time ' is the time by which half of the stars which end up in the galaxy at @xmath0 have formed .",
    "the ` assembly time ' of a galaxy indicates the epoch at which the stellar mass assembled into the central object reaches half the final stellar mass .",
    "if a galaxy grows only through in - situ star formation , its formation time and assembly time should be the same .",
    "on the other hand , if galaxy mergers continuously supply additional stellar components to a galaxy , the assembly and formation time of the stellar components can be different . in practice , as galaxies do not form monolithically , a galaxy s formation always occurs before its assembly time .",
    "figure  [ half ] shows the formation and assembly time of galaxies according to their final stellar mass .",
    "as the concept of downsizing stipulates  @xcite , stars in more massive galaxies tend to be formed earlier than those in less massive ones ( dashed lines ) .",
    "this trend is shown in figure  [ sfr2 ] .",
    "when the stellar mass of the main branches ( direct progenitors ) increases , however , it takes longer to reach half of its final stellar mass .",
    "more massive galaxies are more likely to obtain their mass via accretion through mergers , and the merger accretion rates decay more slowly than the sfrs  @xcite .",
    "thus , with increasing mass , the time interval between the formation and assembly time increases . as seen in figures  [ sfr2 ] and  [ gsfr1 ] , the galaxies in jmerge  are formed and assembled on average later than those from the other tree building algorithms .",
    "this is entirely in line with our assertion that jmerge  artificially truncates many trees when it fails to link two halos between successive snapshots .",
    "the galaxy mass function , or luminosity function , is one of the important global galaxy properties .",
    "although there can be degeneracy , the galaxy mass function reflects important physical processes involved in galaxy formation and evolution .",
    "figure  [ mf1 ] shows the galaxy stellar mass functions from empirical data  @xcite and models , and the residuals between them .",
    "we also present a case without feedback using dashed lines .",
    "the residuals are not huge in the low mass region(@xmath49 ) ; however , they severely diverge from each other at the high mass end .",
    "most of the low mass galaxies reside in small haloes , either alone or with a few companions .",
    "the channel through which they grow is quiescent star formation .",
    "therefore , their growth histories may be far less complicated than those of galaxies in large haloes .",
    "massive galaxies in big haloes , however , are in the forefront of all physical processes governing galaxy formation and evolution .",
    "we should note that the small number of massive haloes in our volume causes a stochastic effect , so the variance seen at the massive end should be treated with caution .     at @xmath0 .",
    "the white solid line shows the mean ratio derived by  @xcite , and the dim and bright gray shades indicate @xmath50 and @xmath51 ranges , respectively .",
    "the solid and dashed - dotted lines come from models with feedback processes and the dashed lines indicate the cases with no feedback.,scaledwidth=45.0% ]    the differences between the models are not as pronounced in the no feedback case . however , both cases , with and without feedback , reveal a unique characteristic of the jmerge  algorithm : a short formation time .",
    "jmerge  has fewer galaxies between @xmath52 for the feedback case than the other algorithms as seen in figure  [ ngal_evo ] .",
    "feedback alters the simple proportional relationship between halo mass and stellar mass .",
    "figure  [ virm_star1 ] presents the stellar to halo mass ratio of the empirical data and our models with and without feedback at @xmath0 .",
    "all the trees with feedback produce galaxies that follow the empirical data of  @xcite , although the deviation and fluctuations increase with increasing mass .",
    "the stellar to halo mass ratios with and without feedback demonstrate how feedback processes work in our models .",
    "the gradually decreasing ratio with the increasing @xmath31 in the no - feedback case can be attributed to two factors .",
    "firstly , the cooling efficiency of hot gas decreases with increasing halo mass .",
    "in addition , stars in massive haloes belong not just to the central galaxy , but to its satellites and the diffuse stellar halo .",
    "the case without feedback more directly demonstrates the effect of the tree building algorithms . as previously stated , jmerge  has the lowest stellar mass in all halo mass ranges , due to its short formation and assembly time .",
    "however , all the other tree building algorithms behave similarly .",
    "confidence regions , respectively .",
    ", scaledwidth=45.0% ]      the @xmath53-@xmath54 relation can be a simple calibration point .",
    "figure  [ mbh ] displays the @xmath53-@xmath54 relations for our models and empirical data .",
    "the relations of the model galaxies are similar to the empirical data derived by  @xcite and also to each other .",
    "it is impossible to recognize distinct differences between the algorithms in essence due to the fact that the prescriptions used to feed smbhs in our models allow for black hole growth mainly when galaxy mergers take place .",
    "if a tree building algorithm gives rise to more galaxy mergers , the galaxies governed by the algorithm have an increased chance of fueling their central galaxies , which would increase bulge stellar mass at the same time .",
    "although the radio - mode agn feedback also contributes to the growth of central black holes , the accretion rate of the radio - mode is far lower than that of the quasar - mode , which is turned on by mergers with enough cold gas .",
    "thus , even the use of different merger tree algorithms simply moves model galaxies along a pre - defined locus in the @xmath53-@xmath54 diagram .      in the previous section",
    ", we detailed the effect of various tree building algorithms on galaxy properties using a semi - analytic model . in order to focus on the impact of halo merger trees",
    ", we adopted a common parameter set for all of the trees , initially derived using the ysamtm  tree builder .",
    "here we find sam parameter sets optimized for a given tree and examine the resulting differences not only in the galaxy distribution but the underlying physics characterised by the parameters of our sam .",
    "the impact of merger tree appears larger on the most massive galaxies ( figure  [ mf1 ] ) .",
    "thus , we search for the optimal parameter set for each model as follows .",
    "first , we find the parameter space that matches the overall shape of the lower - mass end ( @xmath55 ) of the mass function at @xmath0 .",
    "then , we choose a parameter set which minimizes the absolute residuals in the massive end ( @xmath56 ) of the mass function as a calibration .          , but with individually calibrated ( see text ) models with feedback.,scaledwidth=45.0% ]        we calibrated the models to each tree by modifying the strength of four physical processes : star formation efficiency , the stellar mass fraction scattered due to mergers , radio mode agn feedback , and supernova feedback efficiency .",
    "we calculate star formation rates within cold gas discs using a simple formula proposed by  @xcite : @xmath57 where @xmath58 is the star formation efficiency , @xmath59 is the amount of cold gas , and @xmath60 is the dynamical timescale of a cold gas disc .",
    "we adopt @xmath61 as a default , but we can change this to adjust the overall star formation rate .    it has been suggested that some of the stellar component of satellite galaxies are scattered by dynamical disturbances during mergers , and that these components finally belong to a diffuse stellar component in haloes ( the intra - cluster light ) rather than being simply added to the stellar mass of the central galaxy once the central and satellite galaxy have merged .",
    "this stellar mass , lost from the satellite galaxy , is described as follows :        @xmath62    where @xmath63 is the fraction of stars scattered by mergers and @xmath19 is the stellar mass of a satellite galaxy .",
    "therefore , a higher value of @xmath63 leads to more intra - cluster light and a lower final central galaxy mass .",
    "the radio - mode agn feedback has been adopted in many semi - analytic models to regulate the massive end of the galaxy mass function .",
    "we follow a prescription formulated by  @xcite to calculate the accretion rates in the radio - mode : @xmath64 where @xmath65 is a free parameter with units of @xmath66 , @xmath67 is the black hole mass , @xmath68 is the mass fraction of hot gas in haloes , and @xmath69 is the virial velocity of haloes .",
    "part of the mass accreted by the radio - mode turns into energy by @xmath70 , where @xmath71 is the conversion efficiency of rest mass to radiation , which is set to be 0.1 in general , and @xmath72 is the speed of light .",
    "we enhance or suppress the radio - mode agn by tuning @xmath65 .",
    "supernova feedback is effective on regulating the growth of small galaxies .",
    "we implement supernova feedback by adopting the prescription in  @xcite : @xmath73 where @xmath74 is the reheating rate of cold gas , @xmath75 and @xmath76 are free parameters , @xmath77 is the rotational velocity of a disc , and @xmath78 is the star formation rate . in this study , we use @xmath79 as a proxy of @xmath77 , and modify the velocity criterion of eq .  [ snf ]",
    ".    figures  [ mf2 ] & [ virm_star2 ] show the stellar mass functions of the model galaxies and the stellar mass to halo mass , respectively , with parameter sets calibrated for each tree algorithm .",
    "the model mass functions in figure  [ mf1 ] shows very small residuals in the low mass regions ( @xmath80 ) .",
    "therefore , we focused on calibrating them to reproduce the high mass end .",
    "comparing to figure  [ mf1 ] , the mean absolute residual in each mass bin slightly decreases with the calibrations .",
    "both the mass function and stellar mass to halo mass of the trees are now in better agreement with the empirical data , though the stellar to halo mass ratio still remains slightly lower than the mean empirical values from  @xcite at the massive end .",
    "figure  [ param ] shows the results of calibrating the sam prescriptions for each tree algorithm individually .",
    "here we show the efficiency ratios of the four processes between the models based on calibrated and common parameter sets : for instance , @xmath81 . since the prescription for the supernova feedback , eq .",
    "[ snf ] , depends on the rotational velocity of discs , we plot the efficiency ratios for two cases , @xmath82 and @xmath83 .",
    "as figure  [ param ] demonstrates , the massive end of consistent trees  is suppressed with stronger radio mode agn feedback and a higher fraction of stellar mass in satellites scattered during mergers .",
    "there are galaxies that are more massive than @xmath84 in figure  [ mf1 ] ; however , for the new calibrations , the most massive one produced by consistent trees  is @xmath85 .",
    "d - trees , which had few massive galaxies in the common case , is now in better agreement due to a higher star formation efficiency and weaker supernova feedback .",
    "the efficiency of radio mode agn feedback is enhanced to balance the increase in the galaxy stellar mass .",
    "as the massive objects are suppressed , the stellar to halo mass ratio of consistent trees  is also reduced . that of hbt  and sublink  was lowered in the low mass region , as their mass function was tuned with stronger supernova feedback in low @xmath77 , correlating with low @xmath31 in general . on the other hand ,",
    "jmerge  is enhanced in the low mass region by weaker supernova feedback efficiency in low @xmath77 . the higher star formation efficiency and overall decrease of supernova feedback boost d - trees  around @xmath86 .",
    "figure  [ sfr3 ] shows sfrs from the best parameter sets compared to sfrs with a common parameter set , shown in the second row .",
    "figure  [ mf1 ] demonstrated that consistent trees  has more massive galaxies than is seen in the empirical data .",
    "the new parameter set with stronger feedback and lower star formation efficiency suppresses star formation . on the other hand ,",
    "d - trees , which had a deficiency of massive galaxies , has much higher sfrs for haloes of all masses .",
    "hbt  had slightly fewer galaxies in @xmath56 and more in @xmath55 .",
    "the parameters for hbt  were modified in order to diminish sfrs in the low @xmath31 range and to increase them in the most massive range .",
    "jmerge , which has fewer small galaxies than any of the other algorithms , undergoes an enhancement of sfrs in the low mass region .",
    "sublink  is able to decrease its low mass galaxy number by suppressing the sfr of the galaxies in the low @xmath31 range .",
    "the other trees have parameters similar to our fiducial set so they do not show any notable differences with the new parameters .",
    "the new global star formation rates are shown in figure  [ gsfr2 ] .",
    "compared to the common parameter case ( figure  [ gsfr1 ] ) , d - trees  and jmerge  have increased noticeably at high- and low - redshifts , respectively .",
    "overall , the new models individually calibrated to match the galaxy mass function better show a larger variety of star formation history compared to the common - parameter case ( figure  [ gsfr1 ] ) .    , but with individually calibrated ( see text ) models with feedback.,scaledwidth=45.0% ]    the new models produce different individual galaxy growth histories .",
    "therefore , we expected that the amount of stars accreted by the mergers would also change . figure  [ accr2 ] shows the ratio between the accretion fractions in figure  [ accr ] and those in the new models .",
    "the ratio of consistent trees  is almost equal to unity for @xmath87 , then drops to below unity for smaller mass haloes .",
    "d - trees  and sublink  show a similar trend",
    ". however , the drop in the accretion rate at small masses may not be significant as the accretion stellar mass fraction amounts to less than a few percent for low mass haloes .",
    "sublink  shows a dramatic sudden jump at @xmath88 .",
    "first , we note that it is derived from just one galaxy in the bin and thus subject to stochastic effect . in this particular case ,",
    "the galaxy had significantly different _ in - situ _ star formation histories between common - parameter and individually - calibrated cases due to subtle changes in the mass ratios of merging galaxies which affect the  wetness \" of mergers .",
    "it is difficult to judge at the moment whether such a sensitivity is realistic or a computational artifact .",
    "the fraction for hbt  is lower than unity across the whole mass range . in figure",
    "[ sfr3 ] , the sfrs of hbt  are lower in low mass regions and slightly higher at the massive end when compared to the original parameter set due to enhanced supernova feedback and higher star formation efficiency .",
    "thus , smaller galaxies are more strongly suppressed than before , resulting in lower accretion rates .",
    "calibrating jmerge  required higher sfrs in the low mass regions ; thus , its accretion rates have increased .",
    "discussed the differences between the halo merger trees built by various algorithms .",
    "here we investigated the impact on the results of a semi - analytic model due to the differences between the halo merger trees extracted from nine different tree building algorithms . when the evolutionary histories of individual galaxies are compared , the effect of different halo merger trees is apparent .",
    "even though we selected the same haloes at @xmath0 from a common halo catalogue , the galaxies in them show a variety of growth histories , due to differences in the halo merger trees .",
    "the mean star formation histories of modeled galaxies slightly vary between trees , but the peak values of sfr in the most massive group of galaxies can be different by almost a factor of three .",
    "this difference is especially remarkable at high redshifts , where haloes are smaller and less clustered than at @xmath0 .",
    "the number density of satellite galaxies is markedly different between the trees , while that of the main haloes rapidly converged with time .",
    "this naturally gives rise to different galaxy merger rates and stellar accretion fractions .",
    "in general , the trees with lower satellite number densities have lower merger rates and fractions of accreted stellar mass .",
    "overall , tree building algorithms can result in different galaxy formation and assembly times .",
    "the time intervals between them , however , follow the trend in which more massive galaxies are formed earlier and assembled later than their smaller brethren .",
    "tree building algorithms that do not utilise particle identification information but rather rely upon spatial matching of haloes between snapshots ( such as jmerge ) should be used with caution .",
    "it is difficult for such methods to accurately trace haloes back in time , which results in a truncation of their halo history .",
    "thus the age and evolutionary history of an object are severely curtailed .",
    "this leads to a poor representation of the evolution of the galaxy population .",
    "many of the tree building algorithms tested here give similar results , but as has been shown previously this is because they have very similar underlying algorithms . these methods all make either none or limited attempts to correct for haloes missing between two snapshots .",
    "this agreement in no way makes them the best choice and we make no such inference .",
    "some of our tree building algorithms , hbt , consistent trees  and to some extent d - trees  and sublink  make attempts to correct for dropouts in the underlying halo catalogue either by rewriting the catalogue itself in the former two cases or patching up a gap in the latter two cases .",
    "while this can demonstrably increase the main branch length and therefore the length of time during which a galaxy can be seen , it does not universally improve everything .",
    "for instance , `` improving '' the halo catalogue can lead to the removal of legitimate satellite haloes .",
    "we have deliberately employed only a single sam model to illustrate the differences between the tree building algorithms .",
    "as such it is the scatter between the models which is the important characteristic here . they indicate that for any particular sam , coupled to a simulation from which haloes were extracted using a standard procedure , a range of physical properties ( such as the global star formation rate ) could be obtained simply by varying the algorithm used to link the set of dark matter halo catalogues together into a tree structure .",
    "the difference between the bulk of our basic ( and similar ) algorithms ( mergertree , ysamtm , velociraptor , treemaker ) and a full tracking algorithm ( hbt ) indicates how far such results would be expected to change if the tree building and underlying halo finding were to some extent completed in ideal manner .    as summarized above ,",
    "models based on the various merger trees show _ noticeable differences _ in the model galaxy properties .",
    "however , they can still be calibrated to fit some basic empirical distributions by adopting physically reasonable parameters .",
    "we are tempted to conclude that the current level of variety in merger tree building algorithms , albeit seemingly large , _ does not result _ in significant differences in synthetic galaxy properties that is significant when compared with the uncertainties in the empirical data and in other input physics in the modeling procedure .",
    "one notable finding , however , is that the use of in - principle `` superior '' algorithms does not lead to better reproduction of the empirical data , at least in our tests .",
    "more robust testing will be possible when empirical data and other input physics are better constrained .",
    "sky acknowledges support from the national research foundation of korea(doyak 2014003730 ) .",
    "numerical simulations were performed using the kisti supercomputer under the programme of ksc-2012-c3 - 10 .",
    "this study was performed under the drc collaboration between yonsei university and the korea astronomy and space science institute .",
    "ak is supported by the _ ministerio de economa y competitividad _ ( mineco ) in spain through grant aya2012 - 31101 as well as the consolider - ingenio 2010 programme of the _ spanish ministerio de ciencia e innovacin _ ( micinn ) under grant multidark csd2009 - 00064 .",
    "he also acknowledges support from the _",
    "australian research council _ ( arc ) grants dp130100117 and dp140100198 .",
    "he further thanks red house painters for japanese to english .",
    "psb is funded by a giacconi fellowship through the space telescope science institute , which is operated by the association of universities for research in astronomy , incorporated , under nasa contract nas5 - 26555 .",
    "the authors contributed in the following ways to this paper : jl & sky designed the comparison and performed the analysis .",
    "jl is a phd student supervised by sky .",
    "they along with pje & frp wrote the paper .",
    "pat , cs , ak , frp & as organized the sussing merger trees workshop at which this work was initiated . the other authors ( as listed in section 2 ) provided results via their respective tree building algorithms .",
    "all authors also helped proof - read the paper ."
  ],
  "abstract_text": [
    "<S> a halo merger tree forms the essential backbone of a semi - analytic model for galaxy formation and evolution . </S>",
    "<S> recent studies have pointed out that extracting merger trees from numerical simulations of structure formation is non - trivial ; different tree building algorithms can give differing merger histories . </S>",
    "<S> these differences should be carefully understood before merger trees are used as input for models of galaxy formation . </S>",
    "<S> we investigate the impact of different halo merger trees on a semi - analytic model . </S>",
    "<S> we find that the @xmath0 galaxy properties in our model show differences between trees when using a common parameter set . </S>",
    "<S> the star formation history of the universe and the properties of satellite galaxies can show marked differences between trees with different construction methods . independently calibrating the semi - analytic model for each tree can reduce the discrepancies between the @xmath0 global galaxy properties , at the cost of _ increasing _ the differences in the evolutionary histories of galaxies . </S>",
    "<S> furthermore , the underlying physics implied can vary , resulting in key quantities such as the supernova feedback efficiency differing by factors of 2 . </S>",
    "<S> such a change alters the regimes where star formation is primarily suppressed by supernovae . </S>",
    "<S> therefore , halo merger trees extracted from a common halo catalogue using different , but reliable , algorithms _ can _ result in a difference in the semi - analytic model . </S>",
    "<S> given the uncertainties in galaxy formation physics , however , these differences may not necessarily be viewed as significant .    </S>",
    "<S> methods : numerical  galaxies : evolution  galaxies : formation  galaxies : haloes </S>"
  ]
}