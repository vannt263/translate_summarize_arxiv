{
  "article_text": [
    "systems with long - range interactions are particularly important in physics , coulomb forces being probably the most prominent example . albeit their relevance ,",
    "many of its properties are still not well understood .",
    "the long - range nature of the interaction leads to some interesting phenomena not observed for short - range interactions , such as the existence of quasi - stationary non - gaussian states with diverging life - times with the number of particles , negative microcanonical heat capacity , inequivalence of ensembles and non - ergodicity  @xcite .",
    "examples of systems with long range forces include self - gravitating systems  @xcite , non - neutral plasmas  @xcite and models as the ring model  @xcite hamiltonian mean field ( hmf )  @xcite , one - dimensional gravity ( infinite uniform density sheets )  @xcite , free electron laser  @xcite and plasma single wave models  @xcite , among others .",
    "for out of equilibrium situations , many of these studies rely on molecular dynamics simulations , i.  e.  solving numerically the hamiltonian equations of motion for the @xmath0-particle system .",
    "it is also a well known fact that , under suitable conditions , the statistical description of the dynamics of long range interacting systems is equivalent to the vlasov equation  @xcite .",
    "the numerical solution of the vlasov equation was applied to the hmf model in ref .",
    "@xcite and more recently to characterize non - equilibrium phase - transitions in the same model  @xcite , although the phase diagram is still open to a closer scrutiny  @xcite .",
    "one - dimensional models are important for a better understanding of many properties of long - range interacting systems .",
    "therefore a fast numeric implementation of the solution of the vlasov equation is of uttermost value in their investigation .",
    "numerical solutions of the vlasov equation are obtained either by particle in cell ( pic ) methods  @xcite , where the distribution function is represented by a collection of macro - particles under the dynamics of the self - consistent mean - field force , or eulerian methods where the distribution is represented as the density of a non - compressible fluid on a numerical grid  @xcite . for higher dimensional models , pic methods",
    "are more effective in computational effort , even though its applicability is limited by inherent statistical noise and a poor description of the tails of the distribution . on the other hand ,",
    "eulerian methods are limited at higher dimensions by the number of grid points required to accurately represent the distribution function ( see  @xcite for a comparison of different eulerian codes ) . with the rapid increase in computational power and the use of parallel machines eulerian codes have been implemented up to two spatial dimensions  @xcite .",
    "we present in this paper an implementation in the cuda framework  @xcite of a semi - lagrangian solution method for the vlasov equation in one dimensional systems with long range interactions , and applications to the ring , hmf and self - gravitating sheet models . in this approach",
    "the distribution function is represented on a numerical grid and a times - split algorithm is used to evolve the function by computing the characteristic curves and equating the value of the solution to its value at the foot of the characteristic  @xcite .",
    "this last step requires an interpolation scheme , and a common choice is to use a cubic spline , which is global on the grid due to the requirement to compute second order derivatives of the distribution function at grid points  @xcite . as a consequence its parallel",
    "implementation is of limited efficiency .",
    "an alternative in ref .",
    "@xcite is to use a local spline on patches ( tiles ) in the grid , with the continuity of first derivatives at the borders of each patch .",
    "the values of the distribution at the grid points on each patch is stored in shared memory , and all steps are then performed on a patch - by - patch basis .",
    "this approach requires communication between processors handling different patches , which can be reduced by suitably restricting the time step  @xcite .",
    "here we implement a different approach where the interpolation relies on the same form of cubic spline with second order derivatives computed from an eighth order finite difference method .",
    "the structure of the paper is as follows : in section  [ onedm ] we present the one - dimensional models to which our approach is applied , and section  [ paralg ] presents and discusses the algorithms implemented in cuda for the solution of the vlasov equation .",
    "section  [ resdis ] presents the results obtained from the implementation of the algorithm to the one - dimensional models , and speedups relative to a serial code .",
    "we conclude the paper with some concluding remarks in section  [ conrem ] .",
    "since a detailed direct study of real three - dimensional systems with long - range interactions is a very difficult task , some simplified models have been introduced in the literature retaining qualitative features of realistic long - range systems ( see  @xcite and references therein ) .",
    "the hamiltonian of a one - dimensional model of @xmath0 identical particles with unit mass can be written as : @xmath1 where @xmath2 is the potential energy between particles @xmath3 and @xmath4 and the factor @xmath5 ensures extensivity of the energy and corresponds to a change of time units .",
    "the three different models considered here correspond to different choices for @xmath2 .",
    "the ring model describes a system of @xmath0 identical particles on a ring or radius @xmath6 interacting through their gravitational attraction  @xcite . with a choice of units ,",
    "the interacting potential is given by @xmath7 where @xmath8 is an angle coordinate specifying the position of particle @xmath3 on the circle , and @xmath9 is a ( small ) softening parameter used to avoid the divergence of the potential at zero distance .",
    "for increasing @xmath9 the ring model tends to the hmf model , with potential  @xcite : @xmath10 the third system considered is the sheet model formed by @xmath0 identical infinite self - gravitating parallel sheets of constant mass density  @xcite .",
    "he gravitational force between two sheets is therefore constant and they are allowed to cross each other , when the force changes sign . considering only the motion in the direction @xmath11 perpendicular to the sheets , and again with a choice of units ,",
    "the pair interaction potential is written as : @xmath12    the vlasov equation for those models is thus : @xmath13 where @xmath14 is the one particle distribution function , @xmath15 the velocity of the particle , @xmath11 the position coordinate ( @xmath16 for the hmf and ring models ) , and the mean - field force @xmath17 : @xmath18 with @xmath19 given in eqs .",
    "( [ ringpot][sheetpot ] ) . for the hmf model",
    "the mean - field force can be written as : @xmath20 where the components of the `` magnetization '' vector @xmath21 are then @xmath22 this property implies that molecular dynamics simulation times for the hmf model with @xmath0 particles scale as @xmath0 instead of @xmath23 , and is one the reasons why it is so extensively studied .",
    "the semi - lagrangian scheme used here is described in references  @xcite and can be summarized as follows .",
    "the one - particle distribution function is represented in a numerical grid in the one - particle phase space as @xmath24 where @xmath25 and @xmath26 are position and velocity coordinates of the points in the grid on a finite domain @xmath27 $ ] and @xmath28 $ ] .",
    "the distribution function at time @xmath29 is obtained numerically by evolving the function back in time and using the invariance of @xmath30 along the characteristic lines .",
    "this backwards evolution is performed using a a time - split method .",
    "the mains steps are :    1 .",
    "backwards time evolution ( advection ) of @xmath30 in the spatial direction by a time step @xmath31 with constant momentum : [ st1 ] @xmath32 2 .",
    "computation of the mean - field force using @xmath33 : [ st2 ] @xmath34 3 .",
    "backwards time evolution in the momentum direction by a full time step @xmath35 using @xmath36 : [ st3 ] @xmath37 4 .   and as last step repeat  ( [ st1 ] ) : [ st4 ] @xmath38    the values of the intermediate @xmath33 , @xmath39 and final distribution functions in steps  ( [ st1 ] ) , ( [ st3 ] ) and  ( [ st4 ] ) at the numerical grid points must be obtained from the known values at the previous step with a cubic spline as interpolation method . for a point with coordinate @xmath11 , @xmath40 , the interpolated value for @xmath41 knowing @xmath42 and @xmath43 is given by  @xcite : @xmath44 where @xmath45 and @xmath46 stands for the second derivative of @xmath30 at @xmath25 . by requiring that first order derivatives computed from eq .",
    "( [ splinegen ] ) are continuum across the boundaries of neighboring intervals , we obtain a tridiagonal system of equations for @xmath47 : @xmath48 with @xmath49 the number of points in the corresponding direction .",
    "even though useful in a sequential context , a direct efficient parallel implementation of the solution of system  ( [ tridiagsys ] ) is not effective enough .    in order to compute the second order derivatives locally ,",
    "i.  e.  involving only a small number of neighbor points , with good accuracy in order not to spoil the quality of the cubic interpolation an eighth order centered finite difference approximation is used  @xcite : @xmath50 where @xmath51 stands for either the momentum or position variables .",
    "periodic boundary conditions are used both in the spatial and momentum direction .",
    "unphysical effects are avoided by choosing the size of the domain sufficiently large .",
    "the distribution function is represented on an equally spaced grid @xmath52 , with @xmath53 points , by a one - dimensional array @xmath54 $ ] , @xmath55 and @xmath56 .",
    "the second order derivatives are represented similarly .",
    "the initial condition array is loaded in global gpu memory and all subsequent operations are performed there .",
    "memory bandwidth is an important issue for efficiency is this memory intensive application , and the algorithm must exploit as much as possible coalesced memory access .",
    "reading and writing in the one - dimensional array in the @xmath11 direction tends to be coalesced , but not on the @xmath57 direction .",
    "this is an issue when computing the spline coefficients ( the second order derivatives ) necessary for the interpolation in the spatial advection , but is avoided in the other parts of the advection process . to overcome this difficulty a global transpose of the @xmath30 array is performed before computing @xmath58 , and then another transpose is performed it the array @xmath58 . as a consequence the same routine is used to compute the derivatives for both spatial and momentum directions .",
    "the transpose of a bidimensional array written in the one - dimensional form can be performed efficiently close to full bandwidth in cuda  @xcite .",
    "our algorithm is synthesized as :    1 .",
    "transpose @xmath30;[tt1 ] 2 .",
    "compute @xmath58;[tt2 ] 3 .",
    "transpose @xmath58;[tt3 ] 4 .",
    "perform a spatial advection ( step  [ st1 ] above ) using @xmath58 obtained in step  ( [ tt2 ] ) for the spline interpolation ; 5 .",
    "compute the mean - field force @xmath59 ( step  [ st2 ] above);[tt4 ] 6 .   compute @xmath58;[tt5 ]",
    "perform a momentum advection ( step  [ st3 ] ) using @xmath58 from step  [ tt5 ] ; 8 .",
    "repeat steps  ( [ tt1][tt4 ] ) ( step  [ st4 ] ) .",
    "the computation of the force in step  ( [ tt4 ] ) is implemented by a discretization of eq .",
    "( [ meanforce ] ) .",
    "the simulations presented here were performed on a gtx 560 ti gpu with 384 cores , 1 gb global memory and 1,64 ghz clock speed , and a gtx 590 gpu with 512 cores , 1,5 gb global memory and 1.26 ghz  clock ( in fact the gtx 590 has two identical devices but only one was used for the runs ) .",
    "the cpu has an i7 - 2600 processor with 3.4ghz clock and 16 gb of ram . in this section",
    "we present and discuss the results of simulations for the three one - dimensional models presented in section  [ onedm ] .",
    "all computations performed use double precision .      as a first test case",
    "let us apply our approach to the self - gravitating sheet model with pair interaction potential given by eq .",
    "( [ sheetpot ] ) , with a ( waterbag ) constant distribution in an interval as initial condition , i.  e : @xmath60 the parameters of the numeric grid are @xmath61 , @xmath62 and @xmath63 ( different number of points in each direction can also be used ) .",
    "the waterbag initial condition is chosen with @xmath64 and @xmath65 .",
    "two time steps @xmath66 and @xmath67 were considered to assess numerical errors .",
    "figure  [ fig1 ] shows some snapshots of the time evolution of the distribution function obtained from our code .",
    "tables  [ tab1 ] and  [ tab2 ] present the relative errors for the energy @xmath68 and total norm @xmath69 .",
    "the accuracy of our approach is similar to the a global spline as describe in  @xcite , for all cases considered .",
    ".maximum relative error for the energy ( @xmath68 ) and norm ( @xmath69 ) for the finite difference ( fd ) approximation in eq .",
    "( [ findif ] ) and global spline ( gs ) , with @xmath70 . [ cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "we presented a gpu implementation using cuda of a parallel numeric solver for the vlasov equation on a gpu , based on a time - split scheme with a modified cubic spline interpolation for both the spatial and momentum direction in phase space .",
    "the interpolation relies on a finite - difference scheme to accurately determine the second order derivatives required by the cubic spline interpolation in such a a way than only a small number of neighboring points is required , leading to a faster and simpler parallel implementation .",
    "coalesced access to global memory in the gpu is ensured by performing a transpose of the distribution function and its second derivatives when performing the advection in the spatial direction .",
    "implementations for three different one - dimensional long - range interacting models were presented with a discussion of accuracy and speedups of the simulations .",
    "the vlasov dynamics leads to the formation of indentations in a scale which becomes smaller with time , and due to the finite grid accuracy , information loss ensues after some time , leading to a coarse - grained distribution , and an increase in entropy .",
    "before the scale of indentation reaches grid accuracy the entropy is conserved by our approach .",
    "the same occurs after the distribution has been coarse - grained .",
    "higher order time split schemes and a filtering procedure can also be implemented if required  @xcite .",
    "although there is certainly room for improvements in our algorithm , the speedups obtained allow to conclude that the present parallel implementation is a useful tool in the ongoing investigations on open problems for long - range interacting systems .",
    "the author would like to thank cnpq and capes ( brazil ) for partial financial support .",
    "99 a.  campa , t.  dauxois and s.  ruffo , phys .  rep .",
    "* 480 * ( 2009 ) 57 .",
    ", t.  dauxois , s.  ruffo , e.  arimondo and m.  wilkens ( eds . ) , springer ( berlin , 2002 ) , a.  campa , a.  giansanti , g.  morigi and f.  s.  labini ( eds . ) , aip conf.proceedings vol .  970 ( 2008 ) .",
    ", t.  dauxois , s.  ruffo and l.  f.  cugliandolo eds , oxford univ .  press ( oxford , 2010 ) .",
    "t.  m.  rocha filho , a.  figueiredo and m.  a.  amato , phys .",
    "* 95 * ( 2005 ) 190601 .",
    "a.  figueiredo , t.  m.  rocha filho and m.  a.  amato , europhys .",
    "* 83 * ( 2008 ) 30011 .",
    "f.  p.  c.  benetti , t.  n.  teles , r.  pakter and y.  levin , cond - mat:1202.1810 .",
    "t.  m.  rocha filho , m.  a.  amato , b.  a.  mello and a.  figueiredo , phys .",
    "e * 84 * ( 2011 ) 041121 .",
    "t.  padmanabhan , phys .  rep .",
    "* 188 * ( 1990 ) 285 .",
    "y.  levin , r.  pakter and t.  n.  teles , _ phys .",
    "* 100 * ( 2008 ) 040604 .",
    "y.  levin , r.  pakter and t.  n.  teles , _ phys .",
    "e _ * 78 * ( 2008 ) 021130 .",
    "y.  sota , o.  iguchi , m.  morikawa , t.  tatekawa and k.  i.  maeda , phys .",
    "e * 64 * ( 2001 ) 056133 .",
    "t.  tatekawa , f.  bouchet , t.  dauxois and s.  ruffo , phys .",
    "e * 71 * ( 2005 ) 056111 .",
    "m.  antoni and s.  ruffo , phys .",
    "e * 52 * ( 1995 ) 2361 .",
    "t.  n.  teles , y.  levin and r.  pakter , mon .  not .",
    "r.  atron .",
    "* 417 * ( 2011 ) l21 .",
    "m.  joyce and t.  worrakitpoonpon , phys .",
    "e * 84 * ( 2011 ) 011139 .",
    "k.  r.  yawn and b.  n.  miller , phys .",
    "e * 68 * ( 2003 ) 056120 .",
    "r.  bonifacio , f.  casagrande , g.  cerchioni , l.  de salvo souza , p.  pierini and n.  piovella , riv .",
    "nuovo cimento * 13 * ( 1990 ) 1 .",
    "j.  l.  tennyson , j.  d.  meiss and p.  j.  morrison , physica d * 71 * ( 1994 ) 1 .",
    "w.  braun and k.  hepp , commun .",
    "* 56 * ( 1977 ) 101 .",
    "a.  antoniazzi , f.  califano , d.  fanelli and s.  ruffo , phys .",
    "* 98 * ( 2007 ) 160602 .",
    "de buyl , d.  fanelli and s.  ruffo , cond - mat:1112.1102 .",
    "de buyl , commun .",
    "nonlinear sci .",
    "simulat .  * 15 * ( 2010 ) 2133 .",
    "r.  pakter and y.  levin , phys .",
    "* 106 * ( 2011 ) 200603 .",
    "notes in physics , j.  bchner , c.  t.  dum and m.  scholer eds .",
    "springer ( berlin , 2003 ) .",
    "e.  pohn , m.  shoucri and g.  kamerlander , comp .",
    "* 166 * ( 2005 ) 81 .",
    "n.  crouseilles , m.  gutnic , g.  latu and e.  sonnerdrcker , comm .",
    "num .  sim .",
    "* 13 * ( 2008 ) 88 .",
    "n.  crouseilles , g.  latu and e.  sonnerdrcker , j.  comp .",
    "* 228 * ( 2009 ) 1429 .",
    "l.  k.  s.  daldorff and b.  elisson , parallel computing * 35 * ( 2009 ) 109 .",
    "e.  bengt , transp .",
    "* 39 * ( 2010 ) 387 .",
    "t.  d.  arber and r.  g.  l.  vann , j.  comp .",
    "* 180 * ( 2002 ) 339 .",
    "f.  filbet and e.  sonnerdrcker , comp .",
    "* 150 * ( 2003 ) 247 .",
    "m.  shoucri , commun .",
    "nonlinear sci .",
    "simulat .",
    "* 13 * ( 2008 ) 174 .",
    "nvidia , cuda programming guide , ver .  4.0 , 2011 . c.  z.  cheng and g.  knorr , j.  comp .",
    "* 22 * ( 1976 ) 330 .",
    "e.  sonnerdrcker , j.  roche , p.  bertrand abd a ,  ghuizzom j.  comp .",
    "* 149 * ( 1999 ) 201 .",
    "w.  h.  press , s.  a.  teukolsky , w.  t.  vetterling adn b.  p.  flannery , _ numerical recipes _",
    "3rd ed , cambridge university press ( cambridge , 2007 ) .",
    "g.  latu .",
    "_ fine - grained parallelization of vlasov - poisson application on gpu _ , euro - par 2010 , parallel processing workshops , springer ( new york , 2011 ) .",
    "g.  ruetsch and p.  micikevicius , _ optimizing matrix transpose in cuda _ , nvidia technical report ( 2009 ) .",
    "b.  fornberg , math .  comp .",
    "* 51 * ( 1988 ) 699 .",
    "l.  galeotti and f.  califano , phys .",
    "* 95 * ( 2005 ) 015002 .",
    "f.  califano and l.  galeotti , phys .",
    "plasmas * 13 * ( 2006 ) 082102 .",
    "v.  carbone , r.  de marco , f.  valentini and p.  veltri , eur .",
    "* 78 * ( 2007 ) 65001 .",
    "h.  yoshida , phys .",
    "a * 150 * ( 1990 ) 262 ."
  ],
  "abstract_text": [
    "<S> we present a gpu parallel implementation of the numeric integration of the vlasov equation in one spatial dimension based on a second order time - split algorithm with a local modified cubic - spline interpolation . </S>",
    "<S> we apply our approach to three different systems with long - range interactions : the hamiltonian mean field , ring and the self - gravitating sheet models . </S>",
    "<S> speedups and accuracy for each model and different grid resolutions are presented .    </S>",
    "<S> vlasov equation ; long - range interaction ; </S>"
  ]
}