{
  "article_text": [
    "the method of surrogate data was proposed by theiler @xcite as a general procedure to test whether data are consistent with some class of models .",
    "it has been used to test a proposed nonlinear dynamics in geophysics @xcite , certain properties of neural spike dynamics @xcite , but the most common application is testing for linear models @xcite . in order to test the hypothesis that the data are consistent with being generated by a linear system , the ft algorithm is applied .",
    "based on an example and the theory of linear stochastic systems we will show that this algorithm does not produce the correct distribution of time series and therefore might not generally yield the correct distribution of the test statistic .",
    "the surrogate data method is similar to a monte carlo implementation of a standard hypothesis test in which one specifies a procedure for generating an ensemble of new time series with a distribution that matches a model to be tested .",
    "one generates several sample time series , the surrogate data .",
    "next , a selected feature function @xmath0 is evaluated for the original time series @xmath1 and for each of the surrogates .",
    "if the distribution of the feature values is well approximated by a gaussian it can be characterized by its mean @xmath2 and standard deviation @xmath3 .",
    "if @xmath4 , the feature value calculated for the measured time series , is more than a few standard deviations away from @xmath5 , the null hypothesis that the original data were generated by the tested model is rejected , and the significance is reported as the distance @xmath6 . if the distribution of the feature is not well approximated by a gaussian distribution , nonparametric rank statistics should be used .",
    "the surrogate data method differs from a simple monte carlo implementation of a hypothesis test in that it tests not against a single model , but a class of models , i.e. linear systems driven by gaussian noise .",
    "the idea is to select a single model from the class on the basis of the measured data @xmath1 , and then do a monte carlo hypothesis test for the selected model and the original data .",
    "the statistical properties of a time series generated by a linear process are specified by the autocovariance function ( acf ) or equivalently by its fourier transform , the power spectrum @xmath7 .",
    "theiler use the periodogram @xmath8 , , the squared modulus of the fourier transform of the data , to specify the linear model to be tested .",
    "they generate surrogates ( ft algorithm ) by drawing complex numbers with amplitude @xmath9 and random phases and fourier transforming back into the time domain .",
    "there are two problems in this procedure : first , the periodogram @xmath10 is not a consistent estimator of the power spectrum @xmath11 , and second , the distribution of surrogates generated by randomizing the phases but not the amplitudes does not correspond to any linear stochastic system at all .",
    "the consequences of these two points on the estimated distribution of the feature , in case of gaussianity @xmath2 and @xmath12 , are the primary focus of this paper .    in the next section",
    "we briefly summarize the main ideas of surrogate data testing for linearity based on the periodogram and demonstrate by a simple example that this procedure might misspecificy the distribution of the test statistic . to explain this result we refer to some results of the theory of linear systems in section [ review ] and discuss the consequences for surrogate data testing for linearity in section [ consequ ] .",
    "the key to a hypothesis test is the distribution of a test statistic @xmath0 when the null hypothesis @xmath13 is true , i.e. @xmath14 . given a measured sample @xmath15 , one calculates @xmath16 and decides if it is reasonable to suppose that @xmath17 was drawn from @xmath14 , in general by an a priori choosen significance level .",
    "the surrogate data method was proposed by theiler primarily to test the null hypothesis that the data come from a linear gaussian process . once again , the key to designing a hypothesis test is the identification of the distribution of a test statistic @xmath14 . for a class as large and complex as all linear processes",
    ", it seems impossible .",
    "the idea of theiler is to use the observation itself to limit the size of the whole class to a single member .",
    "surrogate data testing needs two ingredients : a procedure to generate data from the class of models to be tested and a feature or statistic to perform the testing .",
    "if a single model is given , the first step is simple .",
    "one generates a large number of time series and approximates the distribution @xmath14 . for instance , see the paper by witt @xcite in which a nonlinear difference equation proposed to describe the dynamics of the reversals of the earth s magnetic field was rejected using a feature that describes the transition probabilities .",
    "theiler proposed their ft algorithm to determine if a given time series could have been produced by a linear system driven by gaussian noise .",
    "the basic idea is that the statistical properties of a linear process are captured completely by its spectral properties .",
    "therefore , they first calculate the periodogram @xmath18 , the squared modulus of the fourier transform , for the positive frequencies . in order to generate the surrogate data they draw complex numbers with amplitude @xmath19 and random phases , symmetrize the negative frequencies with @xmath20 to obtain a real time series by fourier transforming back into the time domain .",
    "we now give a simple example that demonstrates that the ft algorithm , might not reproduce the parent distribution of a feature for a linear process .",
    "we used a simple gaussian white noise process with mean zero and unit variance and evaluated the simple feature :    [ ableit ] f(*x * ) = _ t=1^n-1",
    "|x(t+1 ) - x(t)|    for new realizations of the process and for ensembles generated by the ft algorithm .",
    "these ensembles were based on different realizations of the process .",
    "the results were independent from the number of data points @xmath21 used .",
    "we only show the results for @xmath22 in fig .",
    "[ surro_ex ] . to exclude",
    "any variance dependent effect , all time series are normalized to mean zero and variance 1 .",
    "the lowest line displays the cumulative distribution of the feature from @xmath23 new realizations of the process .",
    "the lines above show the results for @xmath23 realizations based on the ft algorithm .",
    "the ft algorithm fails to recover the parent distribution .",
    "the surrogate distributions @xmath24 are grouped too tightly around the value of the test statistic @xmath4 ( marked by @xmath25 ) for that time series on which the surrogates were based .    the kolmogorov smirnov test for gaussianity does not reject the consistency with a normal distribution at the @xmath26 level of confidence for the shown distributions .",
    "thus , they may be described by mean and standard deviation .",
    "the standard deviation of the true distribution is underestimated by a factor of two .",
    "the kolmogorov smirnov test for consistency of two distributions applied to each surrogate distributions and the distribution of new realizations of the process rejected the null hypothesis in every case at the @xmath26 level of confidence .",
    "the choosen test statistic is indeed able to detect nonlinearities since its expectation value for a gaussian white noise process with unit variance is @xmath27 and for  gaussified  data of the logistic map , @xmath28 , which shows also a flat spectrum , it is @xmath29 .",
    "the misallocation of @xmath2 and the underestimation of the true standard deviation by @xmath3 that appear in fig .  [ surro_ex ] can be explained in terms of the theory of linear processes .      in order to model the fluctuations in the periodicity of sunspot data",
    "yule @xcite introduced linear stochastic systems :    x(t ) = a_1 x(t-1 ) + a_2 x(t-2 ) + ( t ) , ( t)~n(0,^2 ) .",
    "these are now called autoregressive ( ar ) processes can be generalized to autoregressive moving average ( arma ) processes by including not only past values of the observations but also past values of the noise .",
    "the general arma[p , q ] process reads :    x(t ) = _",
    "i=1^p a_i x(t - i ) + _",
    "j=1^q b_j ( t - j ) + ( t )    state space models are a further generalization .",
    "they consist of a vector valued ar[1 ] process and a linear observation function with observation noise :    @xmath30    where @xmath31 is the covariance matrix of the dynamical noise , and @xmath32 the variance of the observation noise",
    ". state space models model observation noise explicitly . for ar and arma models",
    ", observation noise causes the estimated parameters to be biased towards zero .",
    "once the type of model has been chosen , one must select the model order .",
    "generally , one fits a sequence of higher and higher order models and tests the prediction errors for consistency with white noise , e.g. by a kolmogorov ",
    "test on the periodogram @xcite .",
    "if a particular class and order of model is selected , when the parameters of the model are estimated using data from a random process , the estimated parameters are random variables . by restricting the number of parameters to be fit , one insures that as the number of observed data increases , the variance of the estimates goes to zero . in the next subsection",
    "we emphasize that periodograms do not have this property .",
    "we now examine the spectrum of linear processes and the relationship between the spectrum and the periodogram .",
    "the autocovariance function @xmath33 is given by    @xmath34    and the spectrum is defined by :    @xmath35    the spectrum of a state space model is given by :    [ specar ] s ( ) = * c * ( * 1 * -*a*e^-i ) ^-1 * q * ( * 1 * -*a*e^i ) ^-1 t * c*^t + * r * .",
    "thus the spectrum @xmath11 of this process is a smooth function of @xmath36 .",
    "spectra of ar or arma processes are special cases of eq .",
    "( [ specar ] ) .",
    "we now turn to the distribution of the periodogram . for details see @xcite , we only summarize the results .",
    "asymptotically , the fourier transform of a linear stochastic process x ( ) = _ t x(t ) ( t ) + _ t x(t ) ( t ) is a complex gaussian random variable [ fourverteil ] x ( ) = ( 0,s ( ) ) + i ( 0,s ( ) ) where @xmath37 is independent of @xmath21 .",
    "furthermore , fourier components are asymptotically uncorrelated for different frequencies . in terms of modulus and phase instead of real and imaginary part",
    ", this means that not only is the phase a random variable but so is the modulus .    the distribution of the periodogram ( ) = ( _ t x(t)(t ) ) ^2 + ( _ t x(t ) ( t))^2 follows from eq .",
    "( [ fourverteil ] ) to be a @xmath38 distritubion with two degrees of freedom @xmath39 : ( ) ~s ( ) ^2_2 again independent of @xmath21 .",
    "since the mean and variance of @xmath40 are @xmath41 and @xmath42 respectively , the standard deviation of the periodogram is equal to its mean , @xmath43 thus , the periodogram fluctuates wildly regardless of the number of data points used to calculate it .",
    "it is an unbiased but not a consistent estimator of the spectrum since its variance does not decrease with @xmath21 .",
    "this is true not only for linear stochastic processes but also for nonlinear stochastic and even for chaotic processes if only the autocovariance function decays fast enough .",
    "the characteristics of the spectrum and periodogram described in the previous section lead to the following two points concerning the ft algorithm :    1 .",
    "the ft algorithm does not use its estimate of the spectrum correctly . both phases and amplitudes",
    "should be randomized .",
    "2 .   a better estimator of the spectrum than the periodogram is required .",
    "below we elaborate on these points .",
    "( [ fourverteil ] ) means that at each frequency the fourier transform of a time series from a linear stochastic system is a two dimensional gaussian random variable .",
    "the ft algorithm , by fixing the modulus and only randomizing the phases , restricts the new realization to a set of measure zero in the set of all possible realizations of the linear stochastic system under consideration .",
    "it interprets the periodogram of a stochastic process as the spectrum of @xmath44 linear deterministic oscillators with fixed amplitudes .",
    "thus , instead of testing for linear stochastic systems , the ft algorithm by construction tests for the time  discrete version of the following deterministic process @xmath45 :    @xmath46    note , that this process depends on the length @xmath21 of the time series .",
    "if the true spectrum of the process were known the following algorithm would yield the correct distribution of surrogates .",
    "the algorithm is based on eq .",
    "( [ fourverteil ] ) that connects the spectrum @xmath11 with the variance of the complex random variable @xmath47 .    * for each frequency @xmath48 , draw two gaussian distributed random numbers , multiply them by @xmath49 and take the result as the real and imaginary parts of the fourier transform of the desired data . * for reasons of symmetry the last frequency is always real for even number of data points .",
    "thus , in this case , only one gaussian distributed random number has to be drawn .",
    "* to obtain a real valued time series , chose the fourier components for the negative frequencies as the complex conjugates of the components at positive frequencies , i.e. , @xmath50 . * do an inverse fourier transformation of @xmath47 to get the surrogate time series .",
    "[ surro_wahr ] shows the results of a simulation study analogously to fig .",
    "[ surro_ex ] .",
    "again , the bottom line displays the cumulative distribution of the feature from eq .",
    "( [ ableit ] ) for new realizations of the white noise process .",
    "the upper lines show the distributions based on the proposed algorithm using the true flat spectrum of white noise .",
    "the critical issue for the procedure described in the previous section is spectral estimation .",
    "there are two general approaches commonly used for this purpose : fit an ar or arma model to the data and calculate the spectrum from the resulting parameters or smooth the periodogram . for more than the brief discussion given here ,",
    "see @xcite .",
    "this method can not be recommended for two reasons . on the one hand ,",
    "as discussed in section [ review ] , in presence of observation noise these models do not give correct results even if the underlying dynamic is linear .",
    "on the other hand , if the process is nonlinear they are , in general , not consistent estimators of the spectrum .",
    "of course , the parameters of linear models determine the spectrum .",
    "but not every spectrum , e.g. of a chaotic process , is well described by a linear model , since the prediction errors will not be consistent with white noise .",
    "increasing the order of the model does not help , because the `` spectrum '' calculated from the parameters will begin to interpolate the periodogram .",
    "for the same reason , surrogate data generated by realizations from a fitted arma model test , in general , for some linear model , but not for that specified by the spectrum .      estimating the spectrum by smoothing the periodogram rests on three results of the theory of linear processes : the expectation value of the periodogram is the spectrum ,",
    "the spectrum is a continuous function , and the random variables @xmath10 and @xmath51 are asymptotically uncorrelated .",
    "the idea is to smooth the periodogram to reduce the variance ( or equivalently split the time series into segments and average the periodograms ) . denoting the number of data points by @xmath52 , the number of frequency bins included in the smoothing by @xmath53",
    ", one can show that in the limit of @xmath54 and @xmath55 , with @xmath53 constrained to increase slowly enough to insure @xmath56 , this procedure leads to a consistent estimator for the spectrum .    for finite data sequences , the smoothing will introduce a bias and",
    "there is a trade  off between bias and variance of the estimator which is discussed at length in @xcite .      the bias and the variance of the spectral estimate lead to a misspecification of the surrogate data distribution that vanishes asymptotically .",
    "[ right_ex ] is analogous to fig .",
    "[ surro_ex ] .",
    "it shows the results of a simulation study using a moving average kernel of width 2000 frequency bins to estimate the spectrum and the algorithm of section [ randi_all ] to generate the surrogate data .",
    "the kolmogorov - smirnov - test for consistency of two distributions does not reject the null hypothesis in 7 of the 9 cases shown at the @xmath57 level of confidence , demonstrating the convergence .",
    "the appeal of the general idea of surrogate data testing is clarified by a comparison with the tests for linearity proposed in the stochastic systems literature .",
    "these tests rely on asymptotic results for linear processes , mainly concerning third order properties .",
    "there are two classes of these tests .",
    "the first class is based on fitting an ar model to the data and investigating third order properties of the prediction errors .",
    "examples of these parametric tests are given by @xcite .",
    "the other class of tests is based on the asympotitic property that the three  point ",
    "correlations : c(_1 , _ 2 ) = _ t x(t ) x(t+_1 ) x(t+_2 ) are zero for any linear process . for examples of these nonparametric tests see @xcite . in order to perform the test ,",
    "@xmath58 is fourier transformed and the normalized bispectrum is estimated . for linear",
    "gaussian processes it should be zero and the consistency with zero can be tested .",
    "both classes of tests test data of a given process by a property that is fulfilled by all possible linear processes .",
    "the sampling properties of a test statistic of a linear process depend on the the details of the process and the statistic .",
    "in particular , the variance will often be larger for processes with sharper peaks in the spectrum or equivalently longer coherence times .",
    "for example , the variance of the sample mean @xmath59 for an iid gaussian process @xmath60 is @xmath61 , but if the process has correlations , the variance of the sample mean will decrease more slowly as a function of @xmath21 . by construction , the surrogate data method produces the process specific sampling properties .",
    "the power of any test , i.e. the ability to detect a violation of the null hypothesis , depends on the statistic .",
    "the bispectral tests considering the three  point ",
    "correlations are sensitive to quadratic nonlinearities but can be fooled completely by processes showing only cubic nonlinearities like the duffing - oscillator .",
    "the general scheme of surrogate data testing can use any statistic , and the power of the test will depend on the statistic chosen .",
    "thus one can detect a larger class of violations of the null hypothesis .",
    "we showed by an example that the ft algorithm proposed by theiler et al .",
    "@xcite might specify the distribution of the test statistic incorrectly , independent of the number of data points used .",
    "based on the theory of linear stochastic systems , we proposed an alternative that involves spectral estimation .",
    "therefore , testing for linearity by the idea of surrogate data is , in general , also a procedure that is only valid asymptotically . for a finite number of data ,",
    "simulation studies should be performed to evaluate the estimation error .",
    "999 j. theiler , s. eubank , b. gladrikian , j.d .",
    "farmer : testing for linearity in time series : the method of surrogate data , physica d , * 58 * ( 1992 ) 77 a. witt , j. kurths , f. krause , k. fischer : on the reversals of the earth s magnetic field , geophys .",
    "fluid dyn . , 1994 , in press a. longtin : nonlinear forecasting of spike trains from sensory neurons , int . j. bif .",
    "chaos * 3 * ( 1993 ) 651 p. grassberger : do climatic attractors exist ?",
    "nature * 323 * ( 1986 ) 609 j. kurths , h. herzel : an attrator in a solar time series , physica d * 25 * ( 1987 ) 165 a.m. fraser : reconstructing attractors from scalar time series : a comparison of singular system and redundancy criteria , physica d * 34 * ( 1989 ) 391 j.p .",
    "pijn , j.v neerven , a. noest , f.h .",
    "lopes da silva : chaos or noise in eeg signals ; dependence on state and brain site , eletroenceph .",
    "* 79 * ( 1991 ) 371 s.j .",
    "schiff , t. chung : differentiation of linearly correlated noise from chaos in a biologic system using surrogate data , biol .",
    "cybern * 67 * ( 1992 ) 387 j. theiler , p.s .",
    "lindsay , d.m .",
    "rubin : detecting nonlinearities in data with long cohererence times , in : a.s .",
    "weigend , n.a .",
    "gerschenfeld ( eds . ) : time series prediction , addison - wesley , 1994 m. palus , d. novotna : testing for nonlinearity in weather records , phys .",
    "a * 193 * ( 1994 ) 67 p.e .",
    "rapp , a.m. albano , i.d .",
    "zimmerman , m.a .",
    "jimenez - montano : phase - randomized surrogates can produce spurious identifications of non - random structure , phys .",
    "a * 192 * ( 1994 ) 27 g. yule : on a method of investigating periodicies in disturbed series , with special reference to wolfer s sunspot numbers , phil .",
    "a * 226 * ( 1927 ) 267 p.j .",
    "brockwell , r.a .",
    "davis : time series : theory and methods , springer , 1987 a. papoulis : probability , random variables and stochastic processes , mcgraw  hill , 1984      d. keenan : a tuckey nonadditivity  type test for time series nonlinearity , biometrica * 72 * ( 1985 ) 39 r. tsay : nonlinearity test for time series , biometrica * 73 * ( 1986 ) 461 t. subba rao , m.m : gabr : a test for linearity of stationary time series , j. time ser .",
    "* 1 * ( 1980 ) 145 m. hinich : testing for gaussianity and linearity of stationary time series , j. time ser",
    ". anal . * 3 * ( 1982 ) 1689"
  ],
  "abstract_text": [
    "<S> the method of surrogate data is a tool to test whether data were generated by some class of model . </S>",
    "<S> tests based on the periodogram have been proposed to decide if linear systems driven by gaussian noise could have generated a sample time series . </S>",
    "<S> we show that this procedure based on the periodogram , in general , misspecifies the test statistic . based on the theory of linear systems we suggest an alternative procedure to obtain the correct distribution of the test statistic and discuss problems of this approach .     </S>"
  ]
}