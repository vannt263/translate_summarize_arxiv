{
  "article_text": [
    "in 1963 sykes and essam  @xcite noticed that , in independent bond percolation , a star with bond probabilities @xmath0 , @xmath1 and @xmath2 may be replaced by a triangle with bond probabilities @xmath3 , @xmath4 and @xmath5 , provided the @xmath6 and @xmath7 satisfy certain equations ; in particular , a star in which each bond has probability @xmath8 of being open may be replaced by a triangle with bond probabilities @xmath9 .",
    "sykes and essam went on to use this star - triangle transformation to predict that @xmath10 and @xmath9 should be the critical probabilities for bond percolation on the hexagonal and triangular lattices , respectively . in 1981 wierman  @xcite gave a rigorous proof of this result with the aid of a russo  seymour  welsh - type theorem . in 1982 kesten  @xcite extended wierman s theorem to describe the ` critical surface ' of weighted bond percolation on the triangular lattice , although the details were worked out only in 1999 by grimmett  @xcite .",
    "later , in 2008 , it was shown  @xcite that the sum of the critical probabilities of a centrally symmetric planar lattice and its dual is 1 ; more generally , an analogous statement allowing for percolation with different probabilities for different bonds was proved , giving the kesten  grimmett theorem as an easy corollary .    in 1984",
    "wierman  @xcite used the general star - triangle transformation to determine the exact critical probability for bond percolation ( with equal bond probabilities ) on a lattice obtained from the square lattice by adding some diagonals . using a simpler transformation , suding and",
    "ziff  @xcite deduced the critical probability for site percolation on the extended kagom lattice from wierman s result for the hexagonal lattice .",
    "recently , extending work of scullard  @xcite and chayes and lei  @xcite , ziff  @xcite and ziff and scullard  @xcite proposed a simple criterion predicting the value of the critical probability for a wide variety of percolation models in the plane . in addition to the usual independent site and/or bond percolation models on a number of lattices , these models include cases which can be seen as bond percolation with local dependencies between the states of certain bonds .",
    "the predictions of scullard and ziff are similar in nature to those of sykes and essam  @xcite mentioned above : having shown that for a certain probability @xmath10 the percolation model is ` self - dual ' , they state that this probability @xmath10 is therefore critical .",
    "mathematically , there is a folklore ` conjecture ' ( with , as far as we are aware , no precise formulation ) stating that any ` reasonable ' self - dual planar model is critical .",
    "this conjecture is still wide open .",
    "it is well known to hold in certain special cases , in particular for site or bond percolation on lattices with certain symmetries , such as reflection in a line ( see kesten  @xcite ) , or rotational symmetry of any order , as shown in  @xcite . more generally ,",
    "as remarked in  @xcite , it can be shown for site or bond percolation on any lattice by combining results of sheffield  ( * ? ? ?",
    "* corollary 9.4.6 ) , aizenman , kesten and newman  @xcite and menshikov  @xcite .",
    "chayes and lei  @xcite independently described a special case of the scullard ",
    "ziff criterion ( as well as a generalization to random cluster models ) , and gave a sketch proof of criticality under an extra assumption .",
    "in a recent preprint , wierman and ziff  @xcite proved criticality in certain special cases , using known results on self - dual planar lattices .",
    "in this paper we shall prove that the scullard ",
    "ziff criterion does indeed give the critical point for a wide variety of planar percolation models .",
    "in the original papers in the physics literature , the exact scope of applicability of the criterion is not entirely clear . in this paper",
    "we shall define _ precisely _ a general class of models that are self - dual in the appropriate sense , and use new methods to show that the self - dual point is indeed critical in _ all _ cases .",
    "although full definitions will be given only in the next section , let us illustrate some simple special cases of our main result , starting with one very concrete ( but rather specific ) example , and then turning to a more general family .",
    "[ ex1 ] consider the usual triangular lattice shown in figure  [ fig_simpletri ] .",
    "given a parameter @xmath11 , we initially select each bond ( i.e. , edge ) independently with probability @xmath12 .",
    "but then bonds within a shaded triangle ` compete ' : if there are two bonds , the first in the clockwise order ` wins ' , and the other is deleted .",
    "however , if all three bonds are present there is a standoff , and all three remain .",
    "this results in a configuration of bonds such that , within each shaded triangle , with probability @xmath13 no bonds are present , with probability @xmath14 all three are present , and otherwise exactly one bond is present , with each of these cases having probability @xmath15 .",
    "the configurations in different triangles are of course independent .    applying our main results to this particular model",
    "we shall see that ( with probability 1 ) the remaining bonds form a graph containing an infinite component if and only if @xmath16 ; in other words , the model _ percolates _ if and only if @xmath16 .",
    "note for later that considering a single shaded triangle , the probability that the vertices @xmath17 and @xmath18 are connected within this triangle is @xmath19 , as is the probability that @xmath18 and @xmath20 are connected .",
    "the probability that both events hold is @xmath14 , since this happens if and only if all three bonds are selected .",
    "[ ex2 ] more generally , consider , for example , either the usual triangular lattice as above ( viewed as an arrangement of shaded triangles ) , or the lattice of triangles a small part of which is illustrated in figure  [ fig_reflsym_1 ] .",
    "these are both examples of _ self - dual hyperlattices _ , to be defined in the next section .",
    "suppose that each shaded triangle contains some mechanism that connects certain subsets of its vertices , with these processes independent in different triangles ; we have given one example above , but the mechanism is irrelevant , only the final connection probabilities matter .",
    "suppose that in each triangle the probability that all vertices are connected ( inside the triangle ) is @xmath21 , that none are connected is @xmath22 , that @xmath17 and @xmath18 are connected to each other but not to @xmath20 is @xmath23 , and so on , with these probabilities the same for all triangles .",
    "then , except possibly in the degenerate case @xmath24 , there is ( with probability 1 ) an infinite connected component if and only if @xmath25 .",
    "even the very special cases described above are outside the scope of existing results , for several reasons .",
    "firstly , in general they do not correspond to independent bond or site percolation on any lattice ( as required in  @xcite ) .",
    "this is certainly the case when increasing events are not positively correlated ; see the discussion in section  [ sec_mod ] .",
    "such correlation is absent in example  [ ex1 ] when @xmath12 is equal to or close to @xmath26 , since @xmath27 when @xmath28 .",
    "positive correlation is also required for the arguments in  @xcite .",
    "secondly , in example  [ ex2 ] there is no rotational or reflectional symmetry , as required in  @xcite and in  @xcite , so existing russo ",
    "welsh - type results do not apply .",
    "our results show that self - duality implies criticality in a context that is much broader than the scullard ",
    "ziff criterion ; an example is given in figure  [ fig_square ] .    mathematically , the main interest of this paper is perhaps in the development of new tools needed to analyze the general model , including new proofs of analogues of the russo ",
    "seymour  welsh lemma , and a generalization of harris s lemma .",
    "the rest of the paper is organized as follows . in section  [ sec_mod ]",
    "we describe the model we shall study , and state our main results . in section  [ sec_harris ]",
    "we present a generalization of harris s lemma to products of posets . in section  [ sec_cc ]",
    "we prove various technical results about the model .",
    "the heart of the paper is section  [ sec_rsw ] , where we prove a new rsw - type lemma ; the proof is rather involved , so we first illustrate the ideas in a simpler setting ( bond percolation on @xmath29 ) in subsection  [ ss_z2 ] . in section  [ sec_rswapp ]",
    "we show how to apply this lemma using only the minimal symmetry guaranteed by self - duality .",
    "finally , in section  [ sec_deduce ] we show that ( as in  @xcite ) , using a suitable sharp - threshold result , it is but a small step from rectangle crossings to the final results . in section  [ sec_crit ]",
    "we conclude with a brief discussion of the behaviour of the model in the critical case .",
    "the starting point of our investigation is an embedding of a suitable hypergraph in the plane , as described implicitly by ziff and scullard  @xcite and explicitly by wierman and ziff  @xcite . in these papers",
    "the hypergraphs considered are 3-uniform , but much of the time there is no need for this restriction . since the concept of a plane hypergraph seems fundamental , we give several equivalent definitions . to avoid irrelevant difficulties we always assume piecewise linearity of all curves .    by a _",
    "we mean a piecewise - linear closed curve @xmath30 in the plane that , if it touches itself at all , does so only externally at some vertices .",
    "( to be pedantic , @xmath30 is the image of some regular @xmath31-gon @xmath32 under a piecewise linear map defined on the closed domain bounded by @xmath32 that is injective except possibly at the vertices of @xmath32 . )",
    "such a polygon surrounds ( more precisely winds around ) a simply connected open set that we call its _",
    "interior_.    by a _",
    "plane hypergraph _ @xmath33 we mean a set of points of @xmath34 , the _ vertices _ , together with a set of polygons , the _ hyperedges _ , with the following properties :    1 .",
    "[ p1 ] any bounded subset of the plane contains only finitely many vertices , and meets only finitely many hyperedges , 2 .",
    "the interiors of the hyperedges are disjoint , 3 .",
    "each hyperedge is incident with at least one vertex , and 4 .",
    "hyperedges meet themselves or each other only at vertices .",
    "note that we allow a hyperedge to meet the same vertex several times , as in figure  [ fig_hypergraph ] , simply because there turns out to be no reason not to .",
    "property [ p1 ] ensures that each vertex meets only finitely many hyperedges , and vice versa . in this paper ,",
    "all plane hypergraphs we consider are connected , in the natural sense .",
    "@xmath35    two plane hypergraphs are _ isomorphic _ if there is a homeomorphism from the plane to itself mapping one into the other , in the obvious sense .",
    "of course , given a plane hypergraph ( or indeed an isomorphism class of plane hypergraphs ) there is a corresponding abstract hypergraph ; more precisely , a ( multi-)hyper(-multi-)graph , where we have included ` multi ' twice to indicate that two or more hyperedges may be incident with the same set of vertices , and a single hyperedge may be incident with a vertex more than once .",
    "however , we shall work directly with the drawings throughout .",
    "plane hypergraphs are natural generalizations of plane ( multi)graphs . indeed , we may think of a plane graph as a representation of an abstract graph , with the vertices represented by points , and the edges by connected sets meeting only at the vertices .",
    "the edges of a graph are naturally represented by minimal sets connecting the corresponding vertices , i.e. , simple curves , but in the hypergraph case polygons are more natural , so we use them even for hyperedges with only two vertices ( or indeed , one vertex ) .",
    "when we come to percolation in a moment , the idea is that instead of each edge in a graph randomly either connecting its vertices or not , independently of the other edges , each hyperedge will randomly connect some subsets of its vertices , independently of the other hyperedges .",
    "it is easy to check that ( connected , as always in this paper ) plane hypergraphs @xmath33 correspond exactly to _ shaded _ locally finite connected plane multigraphs @xmath36 , where the faces of @xmath36 are properly coloured grey and white , so that every edge borders faces of different colours , with any unbounded faces white .",
    "( at this stage there may be one or more unbounded faces ; in the bulk of the paper all faces will be bounded . ) indeed , vertices correspond to vertices , and the hyperedges of @xmath33 are simply the grey faces of @xmath36 , as on the left in figure  [ fig_hypergraph ] .",
    "of course , a plane graph @xmath36 with at most one unbounded face has an appropriate shading if and only if every degree is even , and then it has either one or two shadings , depending on whether or not it has an unbounded face .",
    "note that if @xmath37 is a hyperedge incident with @xmath38 vertices ( counting multiplicity ) , then , as a polygon , @xmath37 is made up of @xmath38 segments joining vertices , corresponding to the edges of @xmath36 .",
    "we can not in general draw these segments as straight lines .",
    "for example , @xmath33 may contain triples @xmath39 and @xmath40 , say ; furthermore , there may be further hyperedges inside the region bounded by the two curves joining @xmath41 and @xmath42 associated to these triples .    by a _ face _ of a plane hypergraph @xmath33 ( defined as above ) we mean a component of what is left of the plane after removing all hyperedges and their interiors , i.e. , a white face of the corresponding graph @xmath36 . for our next few definitions ( in particular that of duality ) to make sense , it is convenient to insist that each face of @xmath33 has finitely many edges in its boundary .",
    "this is equivalent to imposing the condition that if @xmath33 is infinite , then it has no unbounded faces .",
    "( of course , if @xmath33 is finite , then it necessarily has exactly one unbounded face . )",
    "when it comes to percolation , we naturally consider only infinite @xmath33 .",
    "there is yet another way of defining plane hypergraphs , which will turn out to be much more convenient to work with , but is at first sight perhaps less natural ( at least for percolation ) . given a ( connected , as usual ) plane hypergraph @xmath33 and the corresponding graph @xmath36 as above ,",
    "replace each vertex @xmath42 of @xmath33 by a _",
    "@xmath43-gon , where @xmath44 is the degree of @xmath42 , each face by a _ white _",
    "@xmath43-gon , where @xmath45 is the number of edges ( of @xmath36 ) bounding the face , and each hyperedge @xmath37 incident with @xmath45 vertices ( counted with multiplicity ) by a _ grey _ @xmath43-gon . in this way",
    "we obtain a cubic planar map @xmath46 in which the faces are properly coloured black , white and grey ; see figure  [ fig_hypergraph ] .",
    "( as before , we can not necessarily draw the edges of the polygons as straight lines . )",
    "the reverse transformation is even simpler : starting from a cubic map @xmath46 ( i.e. , a connected locally finite 3-regular plane graph in which each face has finitely many edges in its boundary ) in which the faces are properly coloured black , white and grey , we simply contract each black face to a point to form a vertex of @xmath33 , and take the grey faces to form the hyperedges .",
    "in what follows we shall refer to such a coloured map @xmath46 as a _ map hypergraph _",
    "( or simply a hypergraph , when there is no danger of confusion ) , and denote it also by @xmath33 .",
    "note that when @xmath33 is a graph ( i.e. , @xmath33 is 2-uniform ) , then the corresponding map is the one considered in chapter 3 of  @xcite ( see figures 2 and 4 , for example ) .",
    "there , the 4-gon corresponding to an edge is coloured black or white according to whether the edge is open or closed ; here , the @xmath47-gon corresponding to a hyperedge @xmath37 is grey for now , but will be coloured with a mixture of black and white later .    by a _",
    "plane hyperlattice _",
    "@xmath33 we shall mean an infinite connected plane hypergraph ( defined in any of the three ways above ) with a lattice @xmath48 of translational symmetries , i.e. , such that there are linearly independent vectors @xmath49 and @xmath50 with the property that translation of the plane through either vector maps the drawing into itself in the obvious sense , corresponding to an isomorphism of the underlying hypergraph . throughout , we view @xmath51 as a subset of @xmath34 .",
    "more formally , we define a _ plane hyperlattice _ to be a pair @xmath52 as above , since in what follows @xmath48 need not be the full lattice of translational symmetries of @xmath33 ; in spite of this , we usually omit @xmath48 from the notation . naturally , when we consider isomorphisms of plane hyperlattices , these are required to preserve the corresponding lattices of symmetries .",
    "more precisely , a homeomorphism @xmath53 is an isomorphism from the plane hyperlattice @xmath52 to @xmath54 if it corresponds to a plane hypergraph isomorphism and satisfies @xmath55 for all @xmath56 and @xmath57 , where @xmath58 is a linear map with @xmath59 .    in the context of percolation ,",
    "the natural notion of the dual of a plane hypergraph @xmath33 turns out to be the plane hypergraph @xmath60 defined as follows .",
    "take a vertex of @xmath60 inside each face of @xmath33 . to obtain the hyperedges of @xmath60 , replace each hyperedge @xmath37 of @xmath33 by the _",
    "dual hyperedge _",
    "@xmath61 joining the vertices corresponding to the faces that @xmath37 meets , as in figure  [ fig_dual ] .    in the special case of 2-uniform hypergraphs , i.e. , graphs , this is the usual notion of planar duality . in the 3-uniform case considered ( with mild additional restrictions ) by wierman and ziff  @xcite , the notion of duality",
    "just defined coincides with theirs ; the description of ziff and scullard  @xcite seems to be ambiguous .    in terms of the shaded graph @xmath36 , the operation of taking the dual is rather complicated ",
    "it is _ not _ simply reversing the shading .",
    "however , in the 3-coloured map formulation , it is very simple to construct the dual : simply exchange black and white .",
    "indeed , one can think of a hyperedge and its dual together as corresponding to a grey face of the map @xmath46 ( for example , in figure  [ fig_dual ] one can take the intersection of @xmath37 and @xmath61 as the grey face ) ; the vertices of @xmath33 correspond to the black faces of @xmath46 , and the vertices of @xmath60 to the white faces of @xmath46 .    of course , choosing the drawing appropriately , we may take the dual @xmath60 of a plane hyperlattice @xmath33 to be a plane hyperlattice , and the dual of @xmath60 to be @xmath33 .",
    "a plane hyperlattice @xmath33 is _ self - dual _ if @xmath60 is isomorphic to @xmath33 ; examples are shown in figures  [ fig_dual ] ,  [ fig_tri ] and  [ fig_square ] .",
    "if @xmath30 is a polygon in the plane , then by a _ non - crossing partition _ of its vertex set @xmath62 we mean a partition @xmath63 such that no two distinct parts of @xmath63 contain interlaced pairs of vertices :",
    "if @xmath64 , @xmath65 , @xmath66 , @xmath67 are four distinct vertices appearing in this cyclic order around @xmath30 , a non - crossing partition  @xmath63 can not contain two parts one of which includes @xmath64 and @xmath66 , and the other @xmath65 and @xmath67 .",
    "equivalently , a partition @xmath63 of @xmath62 is a non - crossing partition  if and only if it may be realized by constructing disjoint ( path-)connected subsets @xmath68 of @xmath30 ( which we take to include its interior ) so that each part of @xmath63 is the intersection of some @xmath68 with @xmath62 .",
    "the _ dual _ @xmath69 of a non - crossing partition  @xmath63 is the non - crossing partition  of the _ edges _ of @xmath30 in which two edges @xmath37 and @xmath70 are in the same part if and only if they are not interlaced with two vertices @xmath64 and @xmath65 in a common part of @xmath63 .",
    "here interlaced means that the edges and vertices occur in the cyclic order @xmath37 , @xmath64 , @xmath70 , @xmath65 or its reverse .",
    "turning finally to percolation , the _ state _ of a hyperedge @xmath37 will simply be a non - crossing partition  of its vertices .",
    "( more precisely , of the incidences of @xmath37 with its vertex set , so if @xmath37 touches itself , the relevant vertex appears multiple times in the groundset of the partition . ) a _ configuration _",
    "@xmath71 is an assignment of a state to each hyperedge of the hypergraph @xmath33 under consideration .",
    "we think of the state of a hyperedge @xmath37 as describing connections within @xmath37 . in particular , by an _",
    "open path _ in a configuration @xmath71 we mean a sequence @xmath72 such that , for each @xmath73 , the partition of the vertices of @xmath74 has a part containing both @xmath75 and @xmath76 .",
    "two vertices are _ connected _ in @xmath71 if they are joined by an open path , and the _ open clusters _ of @xmath71 are the maximal connected sets of vertices .",
    "finally , a _ hyperlattice percolation model _ consists of a plane hyperlattice @xmath52 together with a probability measure on configurations on @xmath33 such that the states of different hyperedges are independent , and the measure is preserved by the action of @xmath48 . in other words ,",
    "if @xmath77 is a translate of @xmath37 under an element of @xmath48 , then corresponding states in @xmath77 and @xmath37 have the same probabilities .",
    "note that for a single hyperedge @xmath37 , all probability distributions on the set of non - crossing partitions associated to @xmath37 are allowed .    as usual , the sigma - field of measurable events is the one generated by cylindrical sets , i.e. , by events depending only on the states of a finite set of hyperedges .",
    "in fact , except when defining percolation , throughout this paper we can work with large enough finite regions of @xmath33 , so there are no issues of measurability .",
    "the _ dual _ @xmath78 of a configuration @xmath71 on @xmath33 is the configuration on @xmath60 in which the state of @xmath61 is the dual of the state of @xmath37 ( noting that vertices of @xmath61 correspond to edges of the polygon @xmath37 ) .",
    "it is not hard to check that finite open clusters in @xmath71 are surrounded by open cycles in @xmath79 and _ vice versa _ ; this is most easily seen in the colouring formulation described at the start of section  [ sec_cc ] .    given a plane hyperlattice @xmath52 , suppressing @xmath48 in the notation as usual",
    ", the hyperlattice percolation models on @xmath33 may be parametrized as follows .",
    "first pick one representative @xmath74 of each orbit of the action of @xmath48 on the hyperedges .",
    "then for each non - crossing partition  @xmath63 of the vertices of @xmath74 , choose a probability @xmath80 , subject only to @xmath81 for each @xmath73 .",
    "we call such a vector @xmath82 a _ probability vector _ ( for @xmath33 ) , and write @xmath83 for the corresponding percolation model . the _ dual vector _ @xmath84 assigns the probability @xmath80 to the partition @xmath69 of @xmath85 , so @xmath86 is a hyperlattice percolation model on @xmath60 .",
    "the hyperlattice percolation model @xmath83 is _ self - dual _ if @xmath83 and @xmath86 are isomorphic , i.e. , if there is an isomorphism from @xmath33 to @xmath60 such if @xmath87 and @xmath88 correspond under the isomorphism , then each partition @xmath63 of @xmath70 has the same probability in @xmath86 as the corresponding partition of @xmath37 does in @xmath83 .",
    "our aim is to show that self - dual hyperlattice models are ` critical ' , but first we must define what critical means .",
    "the set of partitions of a ( here finite ) set @xmath89 forms a poset @xmath90 in a natural way : we have @xmath91 if any two elements in the same part of @xmath63 are in the same part of @xmath92 , i.e. , the parts of @xmath92 are unions of those of @xmath63 , i.e. , if @xmath63 _ refines _ @xmath92 .    given a hyperedge @xmath74 as above , let @xmath93 be the poset formed by the _ non - crossing _ partitions of the vertices of @xmath74 . an _ upset _",
    "@xmath94 in @xmath90 is a subset of @xmath90 such that if @xmath95 and @xmath96 then @xmath97 .",
    "given an upset @xmath94 in @xmath98 and a probability vector @xmath99 , let @xmath100 denote the probability that the state of @xmath74 is in @xmath94 .",
    "given two probability vectors @xmath99 and @xmath101 , we say that @xmath101 _ dominates _",
    "@xmath99 if @xmath102 for each @xmath73 and each upset @xmath103 .",
    "we say that @xmath101 _ strictly dominates _",
    "@xmath99 , and write @xmath104 , if @xmath105 for each @xmath73 and each non - trivial upset @xmath103 , i.e. , for all upsets apart from @xmath106 and @xmath107 . note that we can have @xmath108 such that @xmath101 dominates @xmath99 but does not strictly dominate it .",
    "hall s theorem implies that @xmath101 dominates @xmath99 if and only if @xmath101 can be obtained from @xmath99 by moving ` probability mass ' from elements @xmath80 to elements @xmath109 with @xmath96 . in the case of strict domination , we can assume that , for each @xmath73 , a non - zero mass is moved from each @xmath63 to each @xmath110 .",
    "a percolation model @xmath83 _ percolates _ if the probability that the open cluster containing any given vertex is infinite is positive . as usual",
    ", this is equivalent to the existence with probability 1 of an infinite open cluster .",
    "the model @xmath83 is _ critical _ if two conditions hold : for any @xmath104 the model @xmath111 percolates , and for any @xmath112 the model @xmath111 does not percolate .",
    "we say that the model @xmath83 exhibits _ exponential decay _",
    "( of the volume ) if there is a constant @xmath113 such that for any fixed vertex @xmath42 the probability that the open cluster containing @xmath42 contains at least @xmath31 vertices is at most @xmath114 for all @xmath115 .",
    "our main result is the following .",
    "[ th1 ] let @xmath83 be a self - dual hyperlattice percolation model .",
    "then for any @xmath104 the model @xmath111 percolates , and for any @xmath112 the model @xmath111 exhibits exponential decay . in particular , @xmath83 is critical .",
    "although this is far from the main point , a very special case is that the critical probability for bond percolation on any self - dual planar lattice is @xmath26 .",
    "note that the condition @xmath104 is stronger than what one could hope for , namely a similar result with this condition replaced by @xmath101 dominating @xmath99 and @xmath116 .",
    "however , one would then need to rule out degenerate special cases ( corresponding to increasing the probability of bonds that are ` dead ends ' in a bond percolation model , for example ) .",
    "also , theorem  [ th1 ] with the present conditions is strong enough for the main application , corollary  [ c1 ] below .",
    "it turns out that in proving theorem  [ th1 ] , we do not require an exact isomorphism between @xmath83 and @xmath117 .",
    "we call two hyperlattice percolation models @xmath118 and @xmath119 _ equivalent _ if they can be coupled so that , for some constant @xmath20 , for every open path @xmath30 in either model there is an open path @xmath32 in the other model at hausdorff distance at most @xmath20 from @xmath30 . roughly speaking",
    ", the typical reason for two models to be equivalent is that they can be viewed as different ways of realizing a single underlying model .",
    "for example , consider a plane triangulation @xmath36 with a lattice @xmath48 of translational symmetries , such as the triangular lattice .",
    "then there are two natural ways to form a hyperlattice from @xmath36 , illustrated ( for a more complicated lattice ) in figure  [ fig_tri_rel ] .",
    "@xmath120    in the first , there is a vertex for each edge of @xmath36 , in the second , a vertex for each face of @xmath36 . in either case , there is a hyperedge for each vertex @xmath42 of @xmath36 ; this hyperedge is incident to all vertices corresponding to edges or faces of @xmath36 that @xmath42 is incident to . within each hyperedge , assign probability @xmath12 to the partition in which all vertices are in a single part , and @xmath121 to that in which every vertex is in a separate part .",
    "let us call a hyperedge _ open _ if we select the partition into one part , and _ closed _ otherwise .",
    "then the resulting models @xmath122 and @xmath123 are equivalent using the natural coupling , i.e. , the coupling in which the hyperedges in the two models corresponding to a vertex @xmath42 of @xmath36 have the same state , open or closed . indeed , in either model an open path of length more than 1 consists of a sequence of open hyperedges with consecutive ones sharing ( hyperlattice ) vertices .",
    "but two hyperedges share a vertex in @xmath33 if and only if the corresponding vertices of @xmath36 are joined by an edge , and share a vertex in @xmath124 if and only if the corresponding vertices of @xmath36 are in a common face . in a triangulation , two vertices are in a common face if and only if they are joined by an edge .    emphasizing the lattice in the notation , for a change",
    ", we say that a hyperlattice percolation model @xmath125 is _ approximately self - dual _ if there is a model @xmath126 equivalent to @xmath127 such that @xmath126 and @xmath125 are isomorphic as plane hyperlattices , with the corresponding linear map @xmath58 an isometry of the plane . the last restriction is a technicality : in the case of ( exact ) self - duality we did not impose it , but as we shall see in lemma  [ lsymclass ] , any isomorphism witnessing self - duality has this property ( after a suitable affine transformation ) .",
    "this is presumably also true for approximate self - duality , but as the condition will ( we believe ) self - evidently hold in any applications , we do not bother checking this . for our proofs ,",
    "approximate self - duality is ( apart from one technicality ) just as good as self - duality , so we obtain the following strengthening of theorem  [ th1 ] . in this result",
    "` malleability ' is a technical condition we shall introduce later ( see definitions  [ maldef ] and  [ maldef2 ] ) ; in the 3-uniform case , all hyperlattice percolation models are malleable .",
    "also , any ` site percolation ' model , where only the partition into singletons and that into a single part occur , is malleable .",
    "[ th2 ] let @xmath83 be a malleable approximately self - dual hyperlattice percolation model .",
    "then for any @xmath104 the model @xmath111 percolates , and for any @xmath112 the model @xmath111 exhibits exponential decay . in particular , @xmath83 is critical .    to indicate that this extension may be useful , consider a plane triangulation @xmath36 with a lattice of translational symmetries , and a real number @xmath11 .",
    "consider the two hyperlattice percolation models @xmath122 and @xmath123 corresponding to site percolation on @xmath36 , defined as above .",
    "then @xmath33 and @xmath124 are dual to each other , so @xmath122 and @xmath128 are dual as hyperlattice percolation models . since ,",
    "as noted above , @xmath122 and @xmath123 are equivalent , we see that @xmath129 is approximately self - dual , so theorem  [ th2 ] implies that the critical probability for site percolation on @xmath36 is @xmath26 . in itself this is not new ( see the discussion in the introduction ) , but it indicates that the models to which theorem  [ th2 ] applies include ones with a site percolation ` flavour ' .",
    "we have just seen that site percolation on a triangulation with a lattice of symmetries , which for @xmath28 is easily seen to be self - dual in an appropriate sense , may be transformed to a hyperlattice percolation model that is only approximately self - dual . in this case , the duality is clearer in the site percolation formulation than the hyperlattice one . unsurprisingly , there are also cases where the reverse holds . indeed , for any plane hyperlattice @xmath33 , selecting only the partitions in which all vertices in a given edge are connected or none are",
    ", we obtain a site percolation model on an ( in general non - planar ) graph .",
    "for example , taking @xmath33 as in figure  [ fig_reflsym_1 ] , one obtains the non - planar graph in figure  [ fig_nonpl ] .",
    "@xmath130    theorem  [ th1 ] shows that if @xmath33 is self - dual , then the critical probability for site percolation on the resulting graph is @xmath26 .",
    "returning to the original motivation , the key observation of ziff  @xcite and ziff and scullard  @xcite ( present also in the original papers of scullard  @xcite and chayes and lei  @xcite in the special case where @xmath33 is the ` triangular hyperlattice ' @xmath58 shown in figure  [ fig_tri ] ) is that if @xmath33 is 3-uniform , then the condition for self - duality becomes very simple , at least if one takes the same connection probabilities in all triangles .",
    "unfortunately , this involves some further definitions , to allow for non - symmetric cases .    by a _ labelled  plane hyperlattice",
    "_ we mean a plane hyperlattice in which the vertices around each hyperedge are labelled @xmath131 in a way that is consistent with either the clockwise or anti - clockwise cyclic order within each hyperedge , and is globally consistent with the lattice @xmath48 of translational symmetries .",
    "when @xmath132 or @xmath133 we often use letters @xmath17 , @xmath134 to denote the labels rather than numbers . in the 3-uniform case , assigning labels as above amounts to designating the vertices of a hyperedge @xmath37 as its @xmath17- , @xmath18- and @xmath20-vertex in any order , as in  @xcite .",
    "the simplest example of a labelled  plane hyperlattice is the _",
    "labelled  triangular hyperlattice _ shown in figure  [ fig_tri ] .",
    "another example is illustrated in figure  [ fig_reflsym ] .",
    "note that the @xmath17-vertex of one hyperedge may be the @xmath18-vertex of another hyperedge ( or indeed , of the same hyperedge if it touches itself ) . given",
    "a @xmath135-uniform labelled  plane hyperlattice and a probability vector @xmath99 consisting of probabilities @xmath136 , @xmath137 , that sum to @xmath138 , there is a corresponding hyperlattice percolation model @xmath83 : for every hyperedge @xmath37 , we assign @xmath136 as the probability that the vertices of @xmath37 are partitioned according to @xmath63 , with the groundset @xmath139 of @xmath63 corresponding to the vertices of @xmath37 in a manner indicated by the labelling .",
    "specializing to the 3-uniform case , the dual @xmath61 of an edge @xmath37 inherits a labelling from @xmath37 : take the first vertex to be the one opposite the first vertex of @xmath37 , and so on , so a labelled  3-uniform plane hyperlattice @xmath33 has a dual @xmath60 that is again a labelled  3-uniform plane hyperlattice .",
    "if @xmath140 is a triangle with vertices @xmath17 , @xmath18 , @xmath20 and edges @xmath141 , @xmath142 and @xmath143 , then there are five possible partitions of the vertex set , all of which are non - crossing .",
    "these are represented by wierman and ziff  @xcite as @xmath144 , @xmath145 , @xmath146 , @xmath147 , and @xmath148 ; we use the more compact notation @xmath149 , @xmath150 , @xmath151 , @xmath152 and @xmath148 .",
    "the duals of these partitions are , respectively , @xmath153 , @xmath154 , @xmath155 , @xmath156 and @xmath149 . in this",
    "setting , a probability vector @xmath99 is simply a vector @xmath157 of non - negative reals summing to @xmath138 , and the dual of @xmath83 is simply @xmath86 , where @xmath84 is formed from @xmath99 by interchanging @xmath22 and @xmath21 .",
    "the observation of scullard and ziff mentioned earlier may be formulated as follows : if the labelled  plane hyperlattice @xmath33 is self - dual , then the model @xmath83 is self - dual if and only if @xmath158 .",
    "the key point is that the other three partitions are all self - dual , as long as the dual triangle is labelled in the appropriate way , so only two entries in the probability vector , namely @xmath22 and @xmath21 , change when we pass to the dual .",
    "[ in the papers  @xcite , the formulation of duality is not totally clear .",
    "wierman and ziff  @xcite clearly formulate the notion of self - duality for unlabelled  plane hyperlattices , and state that one can consider any labelling with lattice structure , but this seems to be an oversight ; one needs the labelledhyperlattice to be self - dual _ as a labelled  hyperlattice _ , which is not always the case .",
    "]    if the probabilities in @xmath99 are appropriate functions of a single parameter @xmath12 , the condition @xmath158 allows one to determine the critical point of the model ; in general it gives the critical surface .",
    "as remarked earlier , scullard and ziff do not discuss whether self - duality in fact implies criticality ; that it does is shown by theorem  [ th1 ] .",
    "[ c1 ] let @xmath33 be a labelled  3-uniform plane hyperlattice that is isomorphic ( as a labelled  plane hyperlattice ) to its dual , and let @xmath99 be a probability vector @xmath159 .",
    "then @xmath83 percolates if @xmath25 , and exhibits exponential decay if @xmath160 .",
    "let @xmath101 be the probability vector @xmath161 , where @xmath162 , and note that @xmath163 .",
    "then the dual of the hyperlattice percolation model @xmath111 is @xmath164 , which is isomorphic to @xmath111 by the assumption on @xmath33 .",
    "thus @xmath111 is a self - dual hyperlattice percolation model , and so is critical by theorem  [ th1 ] . if @xmath25 , then @xmath165 , while if @xmath160 , then @xmath166 , so the result follows from theorem  [ th1 ] .    when @xmath167 , the model @xmath83 may or may not percolate .",
    "a ( degenerate ) example that percolates is given by taking @xmath168 and all other probabilities zero in the triangular hyperlattice shown in figure  [ fig_tri ] .",
    "an example that does not is given by taking connection probabilities in the same hyperlattice corresponding to critical bond percolation on the triangular lattice . as we shall see in section  [ sec_crit ] , in non - degenerate models",
    "there is no percolation at the self - dual point .",
    "as we have seen , corollary  [ c1 ] follows from theorem  [ th1 ] simply by restricting the parametrization of the percolation model , using the same partition probabilities for all triangles , rather than allowing different ones for each orbit under the action of the lattice of symmetries . in other words",
    ", we took all triangles to be of the same _ type_. of course , one can restrict the model in other ways , considering two or more types of triangle , or one type of triangle and one type of @xmath169-gon , etc .",
    "since any results obtained in this way are simply special cases of theorem  [ th1 ] we omit the details ; the case of a single type of triangle is of special importance , since ( for self - dual @xmath170 , self - duality reduces to a single equation , so one obtains the entire critical surface , rather than a lower dimensional subset of it .",
    "for example , consider the self - dual plane hyperlattice @xmath33 shown in figure  [ fig_square ] .",
    "depending on the parameters we choose , @xmath83 can be self - dual via several different maps @xmath89 from the plane to itself . letting @xmath171 denote the hyperedge @xmath172 and @xmath173 @xmath174",
    ", there is a translation mapping @xmath171 into @xmath175 and @xmath175 into a hyperedge congruent to @xmath171 .",
    "the model @xmath83 is self - dual under this translation if and only if the following equations hold : @xmath176 , @xmath177 , @xmath178 , @xmath179 , @xmath180 , and @xmath181 , together with the images of these equations under rotation . one natural way to satisfy these equations is simply to take the same probability @xmath182 for each of the @xmath183 non - crossing partitions in each square ; taking probability @xmath184 for all partitions other than that into a single part or into four singletons , and probabilities @xmath12 and @xmath185 for these two partitions , it follows that the percolation threshold in this model is at @xmath182 .    before turning to the proof of theorem  [ th1 ] ,",
    "let us make some remarks .",
    "firstly , an important special class of hyperlattice percolation models consists of those corresponding to bond or site percolation on ( planar ) lattices . by a _",
    "@xmath135-generator _ we mean a finite graph @xmath36 with @xmath135 distinguished vertices ; when @xmath132 , we denote these vertices by @xmath17 , @xmath18 and @xmath20 . in a _ planar generator _",
    "we insist that @xmath36 is planar , and that the distinguished vertices lie in a common face , which we may take to be the outer face .",
    "suppose that each bond ( edge ) of @xmath36 is assigned a probability .",
    "then , taking the bonds open independently with these probabilities , for each partition @xmath63 of the distinguished vertices , let @xmath186 be the probability that precisely those vertices in the same part of @xmath63 are connected by open paths in @xmath36 .",
    "replacing each hyperedge in a labelled  @xmath135-uniform plane hyperlattice @xmath33 by a copy of @xmath36 one obtains a ( planar , if @xmath36 is planar ) lattice @xmath187 .",
    "taking all bonds open independently with the appropriate probabilities , the resulting bond percolation model is equivalent to @xmath83 in an obvious sense . in this case",
    "we say that @xmath83 is _",
    "bond realizable_. we may define _ site realizability _ analogously ; this time , in each generator we insist that the distinguished vertices are always open .",
    "the definitions extend to general plane hyperlattices using one generator for each equivalence class of hyperedges .",
    "the key observation of ziff  @xcite and ziff and scullard  @xcite is that , for any self - dual labelled  @xmath188-uniform plane hyperlattice @xmath33 and any generator @xmath36 , no matter how complicated , the equation @xmath189 reduces to a _",
    "single _ polynomial equation in the probabilities associated to the bonds or sites of @xmath36 , so , assuming self - duality implies criticality , this equation gives the entire critical surface in the inhomogeneous case .",
    "moreover , if we take the same probability for each bond or site , this polynomial equation gives the critical probability for bond or site percolation on the lattice generated .",
    "indeed , this was how scullard  @xcite found the critical point for the ` martini lattice ' .",
    "as an example , this method predicts the critical point for bond percolation on the lattice @xmath187 shown on the right in figure  [ fig_tri ] , as the root of a certain polynomial of degree  9 .",
    "corollary  [ c1 ] proves that this predicted value is indeed critical . to see the power of the method , consider the original proof of wierman  @xcite that the critical probability for bond percolation on the triangular lattice is the root @xmath190 of the equation @xmath191 .",
    "this proof relied on the star - triangle transformation , and an apparent coincidence between the various connection probabilities associated to a star and to a triangle .",
    "scullard and ziff s method gives an argument ( which becomes a proof using the results of wierman and ziff  @xcite or corollary  [ c1 ] ) that does not rely on this ",
    "one simply considers a triangle and writes down the equation that the probability @xmath192 that all vertices are connected is equal to the probability @xmath13 that none are .",
    "the fact that one need not consider the dual lattice is key for examples such as the lattice shown on the right in figure  [ fig_tri ] , which is not simply related to its dual .",
    "we should emphasize that having observed that a certain percolation model is self - dual , one is very far from proving criticality .",
    "the classical example is bond percolation on the square lattice with @xmath28 .",
    "this model is obviously self - dual ; proving the conjectured criticality was one of the key open problems in the early days of percolation theory , finally settled after 20 years by kesten  @xcite .",
    "since then , criticality at the self - dual point has been proved for a number of other models , but these remain the exceptions . in the hyperlattice context , wierman and ziff",
    "@xcite proved a result of this type using existing results on planar lattices ; for this reason they consider only a subclass of bond - realizable models , with planar generators and certain symmetries .",
    "this does not include examples such as that in figure  [ fig_tri ] , which has no symmetries other than translations .",
    "however , as outlined earlier , one can easily adapt their method to such lattices , as long as the generator is planar .",
    "chayes and lei  @xcite proved a result of this class for triangular hyperlattices ; they considered only the symmetric case , and imposed an additional condition on the parameters to ensure positive correlation ( see below ) .",
    "they sketched an argument using standard techniques for independent percolation on planar lattices that they claimed extends to this case .",
    "the real significance of theorem  [ th1 ] is that it applies to models that are not bond or site realizable . in such cases , standard results ( such as menshikov s theorem  @xcite , for example )",
    "do not apply , and there seems to be no simple way to adapt the arguments of chayes and lei or wierman and ziff .",
    "indeed , considerable work will be needed to prove lemmas corresponding to , for example , harris s lemma and the russo ",
    "welsh lemma .",
    "let us note that there _ are _ hyperlattice percolation models that are not bond or site realizable .",
    "indeed , considering a single generator @xmath36 and the corresponding probabilities @xmath99 , the event that two given vertices are connected in @xmath36 is an upset in terms of the states of the individual bonds or sites .",
    "thus harris s lemma implies that if the vector @xmath99 is realizable , then for any two upsets @xmath193 , @xmath194 in @xmath90 we have @xmath195 .",
    "for example , we must have @xmath196 .",
    "( in the 3-uniform case , chayes and lei  @xcite show that a necessary and sufficient condition for such positive correlation is that @xmath197 , and the equations obtained from this by permuting @xmath17 , @xmath18 and @xmath20 , all hold . )",
    "of course it is trivial to find a probability vector @xmath99 for which this does not hold ; an example is given in the introduction .",
    "the applicability of corollary  [ c1 ] is also not limited to models that are bond or site realizable .",
    "indeed scullard and ziff  @xcite noted that their duality observation does not require the model to be bond or site realizable .",
    "as in the original paper of scullard  @xcite , one may think of any model @xmath83 as bond percolation on a suitable ( planar ) lattice , where the states of the bonds within a generator may be dependent , although those in different generators must be independent .",
    "for example , we may take each 3-generator to be a triangle , and declare that with probability @xmath198 none of the edges are open , with probability @xmath199 all three are , with probability @xmath200 the edge @xmath150 is open and the other edges are closed , and so on .",
    "alternatively , we can take the generator to be a star .",
    "however , there is no need to think of bonds at all ; for percolation , the only relevant property of the configuration within a triangle is which of the vertices @xmath17 , @xmath18 and @xmath20 the configuration connects to which others , so it is natural to take this ( random ) partition of the vertices as the fundamental object of study . for the mathematical work ( deducing criticality from self - duality ) ,",
    "the details of the hyperlattice turn out to be mostly irrelevant ; this is why we consider general plane hyperlattices in the rest of the paper .    finally , let us note that extensions of the scullard ",
    "ziff criterion to the random cluster model and potts model have been described by chayes and lei  @xcite and wu  @xcite ; establishing criticality at the self - dual point remains an open problem in these cases .",
    "returning to hyperlattice percolation , in a few very special cases results have been proved that go further than determining the critical point .",
    "for example , sedlock and wierman  @xcite established the equality of the critical exponents between certain pairs of models , and chayes and lei  @xcite extended smirnov s conformal invariance result  @xcite to what is essentially a very restricted case of the present model . in this paper",
    "we shall not consider such extensions ; rather we shall prove that self - duality does imply criticality , in the full generality of hyperlattice percolation .",
    "given posets @xmath201 , their _ product _ is the poset @xmath202 where each element @xmath203 is a list @xmath204 with @xmath205 an element of @xmath206 , with @xmath207 if and only if @xmath208 for @xmath209 . if @xmath210 is a product probability measure on a product of posets , then with a slight abuse of notation we write @xmath210 for any of the corresponding marginal measures",
    ".    in the later sections of this paper we shall make repeated use of the following generalization of harris s lemma  @xcite to products of posets .",
    "we only need the case where all @xmath206 are equal and finite , but since the proof gives a little more , we state the result more generally . as usual , a _ greatest element _ in a poset @xmath90 means an element @xmath65 such that @xmath211 for all @xmath212 .",
    "of course , if a greatest element exists , then it is unique .",
    "[ l_ourharris ] let @xmath213 .",
    "there is a constant @xmath214 such that if @xmath210 is a product measure on a product @xmath215 in which each factor @xmath206 is a poset with a greatest element whose probability is at least @xmath12 , then for any two upsets @xmath17 and @xmath18 in @xmath90 we have @xmath216    we shall prove the result with @xmath217 .    as usual , we use induction on @xmath31 . when @xmath218 , the set @xmath90 contains only a single element , and the inequality is trivial .",
    "( it is also not hard to verify directly for @xmath219 . )",
    "suppose then that @xmath220 , and that the result holds for smaller @xmath31 .",
    "suppose for notational convenience that @xmath221 is finite , and list its elements as @xmath222 , with @xmath223 the greatest element .",
    "let @xmath6 denote the probability of element @xmath73 in @xmath221 ,",
    "so our assumption is that @xmath224 .    given a set @xmath225 , let @xmath226 denote the @xmath73th _ slice _ of @xmath89 ( with respect to the last factor in the product ) .",
    "clearly , if @xmath89 is an upset , then so is @xmath68 , so the induction hypothesis gives @xmath227 for each @xmath73 . also , the upset conditions give @xmath228 and @xmath229 for @xmath230 . since @xmath210 is a product measure , we have @xmath231 for any @xmath89 . using these observations",
    ", it suffices to show that @xmath232 holds whenever the non - negative real numbers @xmath6 , @xmath233 and @xmath234 satisfy the following conditions : @xmath235 sum to 1 , @xmath224 , @xmath236 , @xmath237 , @xmath238 , and @xmath239 .    in proving we may assume that @xmath141 , @xmath240 .",
    "dividing the @xmath233 through by @xmath141 and the @xmath234 by @xmath142 , we may assume that @xmath241 .",
    "let @xmath242 and @xmath243 .",
    "since @xmath244 , we have @xmath245 . also , @xmath246 and similarly for the @xmath247 .",
    "our aim is to prove that @xmath248 . recalling that @xmath249 , this is equivalent to showing that @xmath250 since @xmath251 , @xmath252 , we have @xmath253 , so the contribution to the sum @xmath254 from the @xmath255 term is at least @xmath256 .    turning to the remaining terms , since @xmath257",
    "if @xmath258 and @xmath31 is a positive integer , we have @xmath259 if @xmath260 and @xmath247 have the same sign , then the contribution of the @xmath73th summand to is nonnegative . if @xmath261 and @xmath262 , then the negative of the contribution of the @xmath73th summand to is at most @xmath263",
    ", the negative of the sum of the contribution of all such terms is at most @xmath264 the same bound holds for terms with @xmath265 and @xmath266 , so we conclude that the sum in satisfies @xmath267 since @xmath268 by our choice of @xmath20 , this establishes the inequality , and hence the lemma .    note that we have not attempted to optimize the value of @xmath20 above .",
    "indeed , for @xmath10 small , the proof above goes through with @xmath20 only slightly larger than @xmath269 , noting that the contribution to @xmath254 from @xmath255 is at least @xmath270 .    of course , harris s lemma itself does not apply in this setting , i.e. , one can not simply take @xmath271 . indeed , considering the upsets @xmath272 and @xmath273 in the poset on @xmath274",
    "in which @xmath223 is greatest and @xmath275 and @xmath276 are incomparable , with @xmath277 and @xmath278 , we may have @xmath279 and @xmath280 . for @xmath10 small , this shows that we need the exponent @xmath20 to be at least a constant times @xmath281 .    since the form of the bound obtained will be irrelevant in our remaining arguments ,",
    "let us state as a corollary a weaker , more abstract version of the result .",
    "[ ourharris2 ] let @xmath90 be a finite poset with a greatest element @xmath223 and let @xmath210 be a probability measure on @xmath90 with @xmath282 .",
    "there is a function @xmath283 from @xmath284 ^ 2 $ ] to @xmath284 $ ] that is strictly increasing in each argument such that , for any @xmath220 and any upsets @xmath17 and @xmath18 in @xmath285 with @xmath286 , @xmath287 , we have @xmath288    immediate from lemma  [ l_ourharris ] .    as usual , the extension to infinite products is immediate by approximating with the finite case .",
    "note that while the form of the function @xmath289 is irrelevant , it is natural to look for an @xmath289 of the form @xmath290 .",
    "indeed , given upsets @xmath291 and @xmath292 in @xmath293 then , considering the product upsets @xmath294 and @xmath295 in @xmath296 , one sees that the optimal @xmath289 satisfies @xmath297 .",
    "of course the optimal @xmath289 can not be precisely @xmath290 , since we certainly need @xmath298 , and then the bound is not tight if @xmath299 , for example .      in many applications of harris s lemma in percolation ,",
    "the exact form of the bound is not important , so the weaker conclusion of the more generally applicable lemma  [ ourharris2 ] may be used instead of harris s bound .",
    "we give one example that we shall use later : a form of the ` square - root ' trick , showing that if the union of a fixed number of upsets has high enough probability , then one of the upsets has high probability .",
    "[ csr ] let @xmath90 be a finite poset with a least element @xmath223 and let @xmath210 be a probability measure on @xmath90 with @xmath282 .",
    "given @xmath300 and a positive integer @xmath135 there is a @xmath301 such that , for any @xmath220 , if @xmath302 are upsets in @xmath285 with @xmath303 , then @xmath304 for some @xmath73 .",
    "note that @xmath223 is a _",
    "least _ element here , not a greatest one .",
    "set @xmath305 .",
    "for @xmath306 let @xmath307 , where @xmath289 is the function given by lemma  [ ourharris2 ] applied to the reverse of @xmath90 , and set @xmath308 .",
    "if @xmath309 for each @xmath73 , then the downsets @xmath310 each have probability at least @xmath311 . viewing these downsets as upsets in the reversed poset , it follows by lemma  [ ourharris2 ] and induction on @xmath312 that @xmath313 .",
    "thus @xmath314 , a contradiction .",
    "we shall also need a related result , stating that if we have a union of upsets which is extremely likely to hold , then it is very likely that _ many _ of the individual upsets hold , as long as we rule out the trivial case that the union is extremely likely because one of the individual upsets is itself extremely likely .",
    "[ manyhold ] let @xmath90 be a poset with a least element @xmath223 , and let @xmath210 be a probability measure on @xmath90 with @xmath282 . given an integer @xmath315 and a real number @xmath300 , there exists a @xmath316 such that , for any @xmath31 and any collection @xmath317 of upsets in @xmath285 with @xmath318 for all @xmath73 and @xmath303 , the probability that at least @xmath319 of the events @xmath291 hold is at least @xmath320 .",
    "let @xmath289 be the function appearing in lemma  [ ourharris2 ] applied to the reverse of the poset @xmath90 .",
    "set @xmath321 and @xmath322 .",
    "inductively define @xmath323 by @xmath324 for @xmath325 .",
    "we claim that , for any @xmath326 , if @xmath317 is any collection of upsets in any power @xmath285 of @xmath90 with @xmath327 , then we can find disjoint index sets @xmath328 such that for each @xmath329 we have @xmath330 .",
    "the result then follows by setting @xmath331 and @xmath332 : the claim tells us that with probability at least @xmath333 , for every @xmath312 at least one of the events @xmath334 holds , so at least @xmath319 of the @xmath291 hold .    for @xmath335",
    "the claim is trivial , taking @xmath336 .",
    "suppose then that @xmath325 and that the claim holds when we replace @xmath135 by @xmath337 .",
    "let @xmath338 be the probability that none of @xmath339 holds .",
    "for any @xmath135 we have @xmath340 , so @xmath341 , and @xmath342 is defined .",
    "setting @xmath343 , note that the event @xmath344 has probability at least @xmath345 .",
    "consider the downsets @xmath346 and @xmath347 .",
    "applying lemma  [ ourharris2 ] to these events , seen as upsets in the reversed poset , we have @xmath348 .",
    "since @xmath289 is increasing , using the definition of @xmath349 and our assumption on @xmath350 , it follows that @xmath351 .",
    "let @xmath352 and @xmath353 .",
    "applying lemma  [ ourharris2 ] to @xmath354 and @xmath355 , we have @xmath356 since @xmath289 is strictly increasing , @xmath357 , and @xmath324 , it follows that @xmath358 so @xmath359 , and the union of @xmath360 has probability at least @xmath361 .",
    "applying the induction hypotheses to this set of events gives us @xmath362 with the required properties , completing the proof .",
    "our next aim is to prove a form of rectangle - crossing lemma loosely analogous to the russo  seymour ",
    "welsh lemma  @xcite , but applicable in the hyperlattice percolation context .",
    "naturally , this involves considering ` open crossings of rectangles ' . as in  @xcite , for example",
    "( see also  @xcite ) , to make this precise and clean we shall work instead with ` black crossings ' in a suitable black / white colouring of the faces of a cubic map ( i.e. , 3-regular plane graph ) .",
    "we assume throughout that our maps are _ well - behaved _ , meaning that the edges are drawn as piecewise - linear curves , every face is bounded , and any bounded subset of the plane contains only finitely many vertices and meets only finitely many edges .",
    "recall that a plane hyperlattice @xmath33 may be thought of as a 3-coloured cubic map , where the faces are properly coloured black , white and grey , with a lattice @xmath48 of translational symmetries ; as usual we view @xmath48 as a subset of @xmath34 . from now on this is our default viewpoint when considering any plane hyperlattice .",
    "a _ colouring _",
    "@xmath363 of @xmath33 is a 2-coloured cubic map obtained as follows : first subdivide each grey face of @xmath33 into one or more _ subfaces _ , in such a way that the resulting map is still cubic .",
    "then colour each subface black or white , as in figure  [ fig_shading3 ] , for example .",
    "the resulting colouring @xmath363 is an ( improper , of course ) black / white colouring of the faces of a ( well - behaved ) cubic map",
    ". it will be convenient to declare that points in the boundary of a face have the colour of that face , so some points are both black _ and _ white .",
    "a _ black path _ in @xmath363 is then simply a ( piecewise - linear ) path in the plane every point of which is black ; such a path corresponds to a sequence of black faces in which consecutive faces share a point and thus ( since the map is cubic ) an edge .",
    "white paths are defined similarly .",
    "recall that a grey face @xmath364 of @xmath33 corresponds to a hyperedge @xmath37 .",
    "also , since @xmath33 is properly 3-coloured , @xmath364 is surrounded alternately by black and white faces , corresponding to vertices and dual vertices . in @xmath363 , certain pairs of vertices incident with @xmath37 are connected by black paths within @xmath364 ; this generates a partition @xmath63 of the vertices of @xmath37 , which is easily seen to be non - crossing .",
    "thus @xmath363 corresponds to a configuration @xmath71 on @xmath33 , with open paths in @xmath71 corresponding to black paths in @xmath363 and vice versa .",
    "( of course , each open path is represented by many ` nearby ' black paths ) .",
    "crucially , _",
    "white _ paths within @xmath365 induce the dual partition @xmath69 of the dual vertices incident with @xmath61 , so the _ negative _ of @xmath363 , obtained by interchanging black and white throughout , corresponds to the dual configuration @xmath79 on @xmath366 .    by a",
    "_ black cluster _ in @xmath363 we mean a maximal connected black subset of the plane .",
    "a _ white cycle _ is a white path that starts and ends at the same point .",
    "since @xmath363 is a black / white colouring of a cubic planar map , it is easy to see that a black cluster is surrounded by a white cycle if and only if it is finite .",
    "this is a precise form of the duality property relating @xmath71 and @xmath79 mentioned in section  [ sec_mod ] .",
    "[ single ] it will be convenient later to assume that all partitions corresponding to @xmath37 are realized by colourings of a single subdivision of @xmath364 into subfaces , as in figure  [ fig_shading3 ] .",
    "this can be achieved for all non - crossing partitions of hyperedges with any number of vertices , as illustrated in figure  [ fig_shading6 ] .",
    "note that there are many possible colourings @xmath363 corresponding to a given configuration @xmath71 on @xmath33 : even if we fix the division of each grey face into subfaces ( as we shall ) , there may be many colourings of the subfaces giving the same partition of the vertices . for much of the rest of the paper , we shall take the random colouring @xmath363 as the fundamental object of study , rather than the random configuration @xmath71 .",
    "more formally , an _ independent lattice colouring _ @xmath363 , or simply a _ colouring _ , is a colouring obtained from a plane hyperlattice @xmath52 by subdividing each grey face in a deterministic manner , and then colouring the resulting subfaces randomly black and white , in such a way that the colourings inside different grey faces are independent , and translations through elements of the lattice @xmath48 preserve the distribution of @xmath363 . from the remarks above , any plane lattice percolation model @xmath83 can be realized by an independent lattice colouring @xmath363 associated to @xmath33 .",
    "we assume throughout that our colourings @xmath363 are _ non - degenerate _ , meaning that within any grey face , the all - black and all - white colourings have positive probability . later on we shall have to impose some additional conditions for faces corresponding to hyperedges with more than three vertices .",
    "note that the state space @xmath367 underlying the random colouring @xmath363 may be viewed as a product of one poset @xmath368 for each grey face @xmath289 of @xmath33 : in the partial order , we have @xmath369 if every subface that is black in @xmath370 is black in @xmath371 .",
    "picking a finite set @xmath372 of faces representing the orbits of @xmath373 ( the set of grey faces ) under the action of @xmath48 , from lattice invariance we may regard @xmath367 as a power of the poset @xmath374 . from independence ,",
    "the probability measure associated to @xmath363 is then a product probability measure on @xmath367 .",
    "the non - degeneracy condition implies that @xmath90 has a greatest element ( all subfaces of each @xmath375 black ) and a least element ( all white ) , and that each has positive probability .",
    "the event that a given path is black , or that a black path exists with certain properties , is an upset in @xmath367 , in the sense of section  [ sec_harris ] .",
    "thus lemma  [ ourharris2 ] applies to two such events .",
    "similarly , considering the reverse poset , lemma  [ ourharris2 ] applies to two events each defined by the existence of a white path with certain properties .",
    "this is the reason for the non - degeneracy assumption .",
    "note that we are always considering two coloured maps : @xmath33 ( which is deterministic ) and @xmath363 . to avoid ambiguity",
    ", we say that a point or face is _",
    "@xmath33-black _ if it is black in @xmath33 , and _ @xmath363-black _ if it is black in @xmath363 , and similarly for other colours . by default , _ black _ or _ white _ refers to @xmath363 , while _ grey _ necessarily refers to @xmath33 .",
    "the lattice structure ensures that the faces of the hyperlattice @xmath33 ( seen as a map , as usual ) can not be too wild .",
    "[ reg ] let @xmath52 be a plane hyperlattice , viewed as a cubic map .",
    "there are finitely many faces @xmath376 of @xmath33 such that for any face @xmath289 , there is an element of @xmath48 such that the corresponding translation of @xmath34 induces an isomorphism of @xmath33 mapping @xmath289 to one of @xmath376 .",
    "furthermore , there is a constant @xmath377 such that ( i ) every face has diameter at most @xmath377 and ( ii ) every point of @xmath34 is within distance @xmath377 of an element of @xmath48 , and for each @xmath378 there is a constant @xmath379 such that any disk of radius @xmath380 meets at most @xmath379 faces .",
    "let @xmath381 be a fundamental domain of @xmath48 .",
    "since @xmath381 is bounded , by the definition of a plane hypergraph @xmath381 contains finitely many vertices of @xmath33 , and meets finitely many hyperedges .",
    "it follows that @xmath381 meets only finitely many faces of @xmath33 , viewed now as a cubic map .",
    "hence there is a finite set @xmath376 of faces , all meeting @xmath381 , containing one representative of each orbit of the action of @xmath48 on the faces of @xmath33 .",
    "the remaining statements follow easily , taking @xmath377 to be the larger of @xmath382 and @xmath383 .",
    "the parameter @xmath384 appearing in lemma  [ reg ] will be used throughout this and the next section .",
    "for example , we say that a rectangle is _ large _ if all its sides have length at least @xmath385 . in what follows , to avoid trivialities such as a rectangle having a black crossing with probability @xmath138",
    ", we only ever consider large rectangles .",
    "let us remark briefly on the numerical constants appearing in this paper . in many places ,",
    "rather than argue that some constants exist with certain properties , we simply give numerical values that work , such as @xmath386 ( here ) or the less natural constants @xmath387 , @xmath388 , @xmath389 , etc appearing later .",
    "of course the precise values are not important .    given an angle @xmath390 , by a _",
    "@xmath390-aligned rectangle _ we mean a rectangle @xmath391 such that one pair of sides makes an angle @xmath390 to the @xmath64-axis , measured in the positive sense from the @xmath64-axis .",
    "we refer to these sides as _ horizontal _ and the other sides as _",
    "vertical_. thus , after rotating @xmath392 clockwise through an angle @xmath390 , the horizontal sides become horizontal in the usual sense .",
    "whenever we speak of a rectangle @xmath392 , we have an angle @xmath390 in mind and assume that @xmath392 is @xmath390-aligned .",
    "note that the same geometric rectangle is @xmath390-aligned for two values of @xmath390 differing by @xmath393 .    by the _ width _ and _ height _ of a rectangle , we mean the length of the horizontal and vertical sides , respectively ; which is which depends on whether we view @xmath392 as @xmath390-aligned or @xmath394-aligned .",
    "we always assume that our rectangles @xmath392 are in _ general position _ with respect to our colouring @xmath363 , meaning that each vertex of @xmath392 lies in the interior of a face of the colouring , no vertices of the colouring are on the boundary of @xmath392 , and the edges of the colouring can only cross the edges of @xmath392 transversely .",
    "given a rectangle @xmath392 , by a _ black horizontal crossing _ of @xmath392 we mean a @xmath363-black path within @xmath392 starting at some point on one vertical side of @xmath392 and ending at some point on the other vertical side .",
    "white vertical crossings are defined similarly , and so on .",
    "we write @xmath395 for the event that @xmath392 has a black horizontal crossing ( in the random colouring @xmath363 ) , and @xmath396 for the event that it has a white vertical crossing , and so on . for a proof of the following ` obvious ' lemma concerning (",
    "well - behaved ) 2-coloured maps see  ( * ? ? ?",
    "8 , lemma 12 ) .",
    "[ oneway ] given any well - behaved colouring @xmath363 of the plane and any rectangle @xmath392 in general position with respect to @xmath363 , exactly one of the events @xmath395 and @xmath396 holds.@xmath397    this lemma , together with self - duality , will be the starting point for our russo ",
    "seymour  welsh - type argument .",
    "this argument will be rather involved",
    ". there are various technical complications arising from the generality of plane hyperlattices ; we deal with most of these in the rest of this section . in the next section we turn to the core of the argument , where the complications are mostly due to the lack of symmetry .    for the rest of the section we consider a given non - degenerate independent lattice colouring @xmath363 , associated to a plane hyperlattice @xmath33 .",
    "let @xmath398 be the probability that @xmath392 has a black horizontal crossing , and let @xmath399 .",
    "note that if we switch from viewing a given geometric rectangle @xmath392 as @xmath390-aligned to viewing it as @xmath394-aligned , then @xmath400 and @xmath401 swap .",
    "our next aim is to show that @xmath400 and @xmath401 do not change too much if we move the edges of @xmath392 slightly .",
    "this is not very surprising , but giving full details in the present generality requires a little work .",
    "we start with a technical lemma .",
    "we say that a path @xmath30 in the plane is _ potentially black _ with respect to a hyperlattice @xmath33 if no point of @xmath30 is @xmath33-white , so @xmath30 corresponds to a sequence of black and grey faces of @xmath33 .",
    "in other words , @xmath30 is potentially black if and only if there is a positive probability that @xmath30 is actually black in the random colouring @xmath363 .",
    "we write @xmath402 for the hausdorff distance between subsets of @xmath34 .",
    "let @xmath384 be the constant given by lemma  [ reg ] , so every face of @xmath33 has diameter at most @xmath377 .",
    "[ ba ] let @xmath33 be a hyperlattice and @xmath30 a piecewise - linear path .",
    "then there is a potentially black path @xmath32 with @xmath403 .",
    "recall that in the 3-coloured map @xmath33 , no two white faces are adjacent .",
    "whenever @xmath30 passes through a white face , simply take a detour around ( or just outside ) this face .",
    "similarly , if @xmath30 starts or ends in a white face , modify @xmath30 to start / end just outside this face .",
    "[ cont1 ] let @xmath363 be a non - degenerate independent lattice colouring .",
    "then there exists a constant @xmath404 , depending only on ( the distribution of ) @xmath363 , such that , for any large rectangle @xmath392 , if @xmath405 is a rectangle formed by moving one vertical side of @xmath392 outwards by a distance of at most @xmath138 , then @xmath406 .",
    "note first that any black horizontal crossing of @xmath405 contains a black horizontal crossing of @xmath392 , so @xmath407 .",
    "also , we may assume without loss of generality that we move a side of @xmath392 outwards by distance _ exactly _ 1 to obtain @xmath405 .    in the arguments that follow ,",
    "various constants appear that depend on @xmath363 .",
    "however , they will depend only on ( a ) the quantity @xmath384 , where @xmath33 is the hyperlattice underlying @xmath363 , and ( b ) the minimum probability of the all - black state in a grey face .",
    "these are invariant under rotation and translation , so , rotating and translating @xmath392 _ and @xmath363 _ , without loss of generality we may assume that @xmath408 , so horizontal means horizontal in the usual sense , and that @xmath409\\times [ 0,b]$ ] and @xmath410\\times [ 0,b]$ ] , even though @xmath400 itself varies as @xmath392 is rotated and/or translated with @xmath363 fixed .",
    "we may assume that @xmath411 .",
    "applying lemma  [ ba ] to the line segment @xmath187 from @xmath412 to @xmath413 , and truncating the resulting path @xmath32 when it last hits the bottom side of @xmath392 and first hits the top side , we find a potentially black path @xmath414 crossing @xmath392 from top to bottom , where all points have @xmath64-coordinate between @xmath415 and @xmath416 .",
    "let @xmath89 be the ` strip ' consisting of those points of @xmath405 to the right of @xmath414 , and let @xmath417 denote the rest of @xmath405 , so @xmath418 is a ` distorted rectangle ' whose right - hand side is potentially black .",
    "let @xmath419 be the event that @xmath417 has a horizontal black crossing , noting that if @xmath395 holds then so does @xmath419 , so @xmath420 .",
    "let @xmath421 be the set of grey faces meeting @xmath417 but not @xmath89 , and let @xmath422 be the set of grey faces meeting @xmath89 , so @xmath419 depends on the colourings of the faces in @xmath423 .",
    "let @xmath424 be the event that @xmath419 would hold after recolouring ( in @xmath363 ) all faces in @xmath422 to black ; thus @xmath424 is the event that there is a path @xmath30 crossing @xmath417 from left to right , every point of which is either @xmath363-black or in a face in @xmath422 . if @xmath419 holds then so does @xmath424 , so @xmath425",
    "now @xmath424 depends only on the states of the faces in @xmath421 .",
    "let us condition on these states , assuming that @xmath424 holds .",
    "our aim is to show that the conditional probability that @xmath426 holds is not too small . to do this",
    "we shall first modify @xmath30 in a certain way ( if needed ) , and then extend @xmath30 , obtaining a path @xmath427 crossing @xmath405 from left to right in which every point is either @xmath363-black or in a face in @xmath422 , in such a way that the set of faces in @xmath422 that @xmath427 meets has size @xmath428",
    ". then we reveal the ( as yet unexamined ) states of these faces .",
    "since there are @xmath428 of them , with probability bounded away from zero they are all entirely black in @xmath363 .",
    "we start with the modification of @xmath30 .",
    "let us call a face _ bad _ if it meets both @xmath417 and @xmath89 , but does not lie entirely in @xmath429 , and _ good _ otherwise . since all faces have diameter at most @xmath377 , any bad face must contain a point within distance @xmath430 of either @xmath431 or @xmath432 . in particular , there are @xmath428 bad faces .",
    "suppose @xmath30 meets one or more good faces in @xmath422 .",
    "tracing @xmath30 from the left , stop the first time it meets such a face @xmath289 .",
    "since @xmath289 is connected and meets @xmath89 , we can continue within this face to a point of @xmath89 .",
    "since @xmath289 is contained in @xmath405 , in doing so we do not go outside @xmath405 , but we do leave @xmath417 , so we cross the right - hand side of @xmath417 .",
    "stop when this happens .",
    "after this modification , @xmath30 has the properties above ( all points @xmath363-black or in faces in @xmath422 ) , and it meets at most one good face in @xmath422 , and thus ( since there are @xmath428 bad faces in total ) @xmath428 faces in @xmath422 .    let @xmath433 be the right - hand end of @xmath30 , so @xmath433 lies on @xmath414 .",
    "pick @xmath434 $ ] with @xmath435 .",
    "let @xmath436 be the line - segment from @xmath437 to @xmath438 .",
    "apply lemma  [ ba ] to @xmath436 to obtain a potentially black path @xmath439 .",
    "then @xmath439 starts inside @xmath417 , ends outside @xmath405 , and can not cross the lines @xmath440 and @xmath441 , so it contains a sub - path @xmath442 within @xmath89 crossing @xmath89 from left to right .",
    "the left - hand end of @xmath442 is within distance @xmath430 of @xmath433 . to construct our final path @xmath427 , trace @xmath30 from left to right , run along @xmath414 from @xmath433 to the first end of @xmath442 , and then trace @xmath442 .",
    "this path crosses @xmath405 from left to right .",
    "furthermore , any point of @xmath443 is within distance @xmath444 of @xmath433 , so @xmath443 meets @xmath428 grey faces .",
    "now @xmath427 is potentially black .",
    "any point of @xmath427 in a grey face in @xmath421 is necessarily a point of @xmath30 , and so is @xmath363-black by the properties of @xmath30 .",
    "finally , @xmath427 meets @xmath428 grey faces in @xmath422 . with ( conditional ) probability",
    "bounded away from 0 the latter faces are all entirely @xmath363-black , and then @xmath427 is a black path , so @xmath426 holds .",
    "when @xmath400 is very close to 1 , lemma  [ cont1 ] is not very informative ; it does not rule out @xmath400 dropping from @xmath138 to @xmath445 , say , as @xmath392 is extended a tiny bit horizontally . in this case",
    "the probability of a white vertical crossing would increase from @xmath446 to @xmath447 .",
    "note that this vertical crossing probability _ can _ change by a large ratio : if the white colouring is subcritical , with @xmath141 constant and @xmath142 large , the white vertical crossing probability is approximately of the form @xmath448 , where @xmath449 is a positive constant depending on @xmath141 . increasing @xmath141 by @xmath138 decreases @xmath449 to a new constant value , which can change @xmath448 by an arbitrarily large ratio .    however , it is still true that the white vertical crossing probability can not jump from very small to fairly large .",
    "we phrase the result in terms of black horizontal crossings as above .",
    "[ cont2 ] let @xmath363 be a non - degenerate independent lattice colouring .",
    "given @xmath300 there is a @xmath450 such that for any large rectangle @xmath392 and any rectangle @xmath405 formed by moving one vertical side of @xmath392 outwards by a distance of at most @xmath138 , if @xmath451 then @xmath452 .",
    "the proof is an extension of that of lemma  [ cont1 ] ; we define the path @xmath414 splitting @xmath405 into @xmath417 and @xmath89 as before , and let @xmath421 be the set of grey faces meeting @xmath417 but not @xmath89 , and @xmath422 the set of grey faces meeting @xmath89 . as",
    "before , let @xmath424 be the event that @xmath417 has a horizontal crossing every point of which is @xmath363-black or in a grey face in @xmath422 , recalling that @xmath453 .    let @xmath454 list all grey or @xmath33-black faces of @xmath33 meeting @xmath89 .",
    "let @xmath455 be the event that @xmath417 contains a @xmath363-black path @xmath30 starting on the left - hand side of @xmath417 , ending at a boundary point of @xmath338 , and meeting no other @xmath456 , nor the interior of @xmath338 .",
    "note that @xmath455 depends only on the states of grey faces in @xmath421 , not those in @xmath422 .",
    "if @xmath424 holds then , truncating a path @xmath30 witnessing this event the first time @xmath30 meets any @xmath338 , we see that one of the @xmath455 must hold .",
    "hence , @xmath457 we claim that any given face @xmath70 of @xmath33 is surrounded by a ` ring ' of white and grey faces of @xmath33 with bounded size such that if all grey faces in the ring happen to be coloured white in @xmath363 , then no @xmath363-black path starting outside the ring can end at a point of @xmath70 . here the bound depends only on @xmath33 , not the face chosen . indeed ,",
    "if @xmath70 is @xmath33-black , we simply take the faces neighbouring @xmath70 to form the ring .",
    "if @xmath70 is white or grey , we may simply take all white or grey faces of @xmath33 within distance @xmath458 of @xmath70 as our ring : since no black face of @xmath33 touches any other black face , any @xmath363-black path to @xmath70 from distance more than @xmath458 must meet a grey face in our ring .",
    "if every grey face in the ring just described about @xmath338 happens to be coloured entirely white in @xmath363 , then no black path ends at any point of @xmath338 , and @xmath455 does not hold .",
    "it follows that for some constant @xmath459 we have @xmath460 for all @xmath73 .",
    "let @xmath461 be the maximum number of faces meeting any disk of radius @xmath385 , and let @xmath462 be the number of _ bad _ grey or @xmath33-black faces , i.e. , grey or black faces meeting @xmath89 , @xmath417 , and the exterior of @xmath405 .",
    "note that @xmath461 and @xmath462 are bounded by constants as before .",
    "let @xmath46 be a huge constant to be chosen in a moment .    by lemma  [ manyhold ] ( applied with @xmath463 in place of @xmath311 ) , our assumption @xmath451 , and ,",
    "if we choose @xmath464 small enough , then with probability at least @xmath465 at least @xmath466 of the events @xmath467 hold .",
    "let us condition on the states of all faces in @xmath421 , assuming that at least @xmath468 of the @xmath455 hold .",
    "it suffices to show that the conditional probability that @xmath426 holds is then at least @xmath465 . as",
    "before , we use the fact that we have not yet looked at the faces in @xmath422 .",
    "since there are at most @xmath462 bad faces among the @xmath338 , there is a set @xmath469 of size at least @xmath470 such that for every @xmath471 the event @xmath455 holds and @xmath338 is good . using the greedy algorithm",
    ", we may pick a subset @xmath472 of size at least @xmath46 such that for distinct @xmath473 the faces @xmath338 and @xmath456 are at distance at least @xmath474 . for @xmath471 ,",
    "let @xmath475 be a path witnessing @xmath455 .",
    "our aim is to complete the proof as before , but now showing that each @xmath475 has a not - too - small chance of being extendable to cross @xmath405 , and that these events ( that the particular extensions we look for are present ) are independent , so with high probability at least one hold .",
    "the details are essentially as before : since @xmath338 is good , we may extend @xmath475 within the face @xmath338 to meet our right - hand side @xmath414 .",
    "then we find an extension @xmath476 of @xmath475 as before , remaining within distance @xmath430 of the end of @xmath475 .",
    "the extensions meet disjoint sets of faces , so we are done .",
    "together , lemmas  [ cont1 ] ,  [ cont2 ] and  [ oneway ] show that no crossing probability changes ` too much ' when a rectangle is moved slightly .",
    "this statement needs a little interpretation : we could in principle obtain explicit bounds in lemmas  [ cont1 ] and  [ cont2 ] .",
    "however , these turn out to be irrelevant . in the end , all we care about is whether certain probabilities tend to 0 or tend to 1 as some parameter ( the area of the rectangles we consider ) tends to infinity .",
    "it will thus be convenient to ` re - scale ' all probabilities by an increasing function @xmath477 with @xmath478 as @xmath479 and @xmath480 as @xmath481 , in such a way that the maximum change in a probability @xmath12 ` allowed ' by our lemmas corresponds to a change in @xmath482 of at most @xmath483 , say .    to make this precise , let @xmath484 be the constant given by lemma  [ cont1 ] ; recall that this does not depend on the orientation of @xmath392 .",
    "let @xmath485 be the corresponding constant with black and white exchanged , and let @xmath486 .",
    "similarly , given @xmath300 , let @xmath487 , where @xmath488 is given by lemma  [ cont2 ] , and @xmath489 by lemma  [ cont2 ] with black and white exchanged .    define a sequence @xmath490 inductively by setting @xmath491 and @xmath492 . set @xmath493 for @xmath494 and @xmath495 for @xmath496 . consider the _ scaling function _",
    "@xmath497 defined as follows : set @xmath498 for all @xmath499 , and interpolate linearly between these points .",
    "note that @xmath500 . this function ( or rather its inverse ) is illustrated in figure  [ fig_scaling ] .",
    "recall that we call a rectangle _ large _ if both sides have length at least @xmath385 .",
    "[ cont ] let @xmath501 and @xmath502 be two large rectangles such that one of @xmath501 and @xmath502 is obtained from the other by moving one side outwards by a distance between @xmath446 and @xmath138 .",
    "let @xmath503 be any of the four functions @xmath504 , @xmath505 , @xmath506 and @xmath507",
    ". then @xmath508 .",
    "without loss of generality , @xmath502 extends @xmath501 horizontally . using lemma  [ oneway ] and the fact that @xmath509 .",
    "let @xmath510 , noting that @xmath511 .",
    "let @xmath512 , so @xmath513 . if @xmath514 then by definition of @xmath515 we have @xmath516 .",
    "by lemma  [ cont1 ] we have @xmath517 , so @xmath518 and @xmath519 .    on the other hand , if @xmath520 then @xmath521 .",
    "since @xmath522 , lemma  [ cont2 ] gives @xmath523 . in either case",
    "we have @xmath524 , so @xmath525 and the result follows .",
    "lemma  [ cont ] shows that if we measure probabilities in the right way , they do nt change too much when we move a rectangle slightly .",
    "since we have a lattice of translational symmetries , this has the following consequence .",
    "( recall that a rectangle is ` large ' if its sides have length at least @xmath385 , where @xmath384 is the constant from lemma  [ reg ] . )",
    "[ c_trans ] there is a constant @xmath20 such that if @xmath526 is a translate of a large rectangle @xmath392 , then @xmath527 .",
    "pick a fundamental domain @xmath381 of the lattice @xmath48 of symmetries .",
    "since our colouring @xmath363 is invariant under translations corresponding to elements of @xmath48 , we may assume that @xmath392 and @xmath526 are related by translation by a vector in @xmath381 .",
    "since @xmath381 is bounded , the result follows by applying lemma  [ cont ] a bounded number of times .",
    "define @xmath528 by @xmath529 , where @xmath20 is the constant given by corollary  [ c_trans ]",
    ". then @xmath530 is increasing .",
    "in fact , although we shall not use this , @xmath530 is strictly increasing , and @xmath531 tends to @xmath446 as @xmath532 and to @xmath138 as @xmath533 .",
    "we may rewrite corollary  [ c_trans ] is the following more convenient form .",
    "[ c_trans_lower ] suppose that @xmath392 and @xmath526 are large rectangles with the same orientation , width and height .",
    "then @xmath534 and @xmath535.@xmath397    we may also rotate a rectangle slightly without changing the crossing probabilities much .",
    "[ c_rot ] let @xmath392 be any rectangle of width  @xmath141 and height  @xmath142 , with @xmath411 ( so @xmath392 is large ) , and let @xmath526 be obtained from @xmath392 by rotating it about its centre through an angle @xmath536 . if @xmath537 denotes any of the four crossing probability functions considered in lemma  [ cont ] , then @xmath538 .    without loss of generality",
    "we may assume that @xmath70 is the function @xmath539 giving the probability of a black horizontal crossing .",
    "rotating and translating the rectangles and @xmath363 together as before ( or simply changing coordinates ) we may assume that @xmath540\\times [ -b , b]$ ] .",
    "let @xmath541\\times [ -b+1,b-1]$ ] .",
    "then any horizontal crossing of @xmath542 crosses @xmath526 horizontally , so @xmath543 .",
    "hence , by lemma  [ cont ] , @xmath544 .",
    "a similar argument interchanging @xmath392 and @xmath526 gives @xmath545 , so the result follows .",
    "a key consequence of the lemma above is that for any given orientation , we may find a large rectangle @xmath392 with @xmath400 not too close to @xmath446 or @xmath138 , and that when we rotate , we can assume that the dimensions of @xmath392 vary ` smoothly ' .",
    "for now we formalize only the first of these statements . given an angle @xmath390",
    ", we write @xmath546 and @xmath547 for @xmath504 and @xmath506 , where @xmath392 is an @xmath548-by-@xmath549 @xmath390-aligned rectangle centred on the origin .",
    "( thus @xmath550 . )",
    "[ 1mod ] let @xmath363 be a non - degenerate independent lattice colouring associated to a hyperlattice @xmath33 .",
    "given @xmath551 , there is a constant @xmath552 that for any @xmath553 and any angle @xmath390 , there are @xmath554 with @xmath555 such that @xmath556 .    by lemma  [ reg ]",
    "there is a constant @xmath557 such that any disk of radius @xmath558 meets at most @xmath319 faces of @xmath33 . by lemma  [ ba ] ,",
    "if @xmath392 is a rectangle of any orientation with width  @xmath559 and height  @xmath560 , then we can find @xmath561 potentially white paths @xmath475 crossing @xmath392 from top to bottom , with these paths separated by distances of at least @xmath377 . since the events that these paths are white are independent , and each path meets at most @xmath319 grey faces , the probability that no @xmath475 is white is at most @xmath562 for some constant @xmath113 that does not depend on @xmath390 . by lemma  [ oneway ] ,",
    "if any @xmath475 is white , then @xmath395 does not hold . taking @xmath17 large enough ( i.e. , @xmath563 and @xmath564 ) , we thus have @xmath565 ; similarly , if @xmath17 is large enough then @xmath566 .    now consider a rectangle @xmath392 with area @xmath17 that varies smoothly between these two extremes , centred always on the origin .",
    "as @xmath567 varies , lemma  [ cont ] implies that @xmath568 can not jump by more than 8 at any point , and the result follows .",
    "in the original context of independent bond percolation on the square lattice , there are now several different proofs of the key lemma of russo  @xcite and seymour and welsh  @xcite ; see , for example ,  @xcite .",
    "the various proofs extend ( with differing degrees of additional complication ) to various more general classes of percolation model",
    ". however , as far as we are aware , none of the published proofs can be made to work in the context of general self - dual hyperlattices ",
    "in addition to various technical problems , they all require symmetry assumptions that may not hold here",
    ".    in this section we shall prove an analogue of the russo ",
    "welsh lemma for self - dual hyperlattice percolation .",
    "since this proof is a little involved , we first illustrate the key ideas by writing out the argument for bond percolation on @xmath29 .",
    "this amounts to reproving the original rsw lemma in a more complicated way than necessary .",
    "even among proofs using our new strategy , we do not aim to present the simplest , but rather one that extends easily to hyperlattices .      throughout this subsection",
    "we consider independent bond percolation on @xmath29 with @xmath28 .",
    "thus a _ configuration _",
    "@xmath71 is an assignment of a _ state _ ( _ open _ or _ closed _ ) to each edge @xmath37 of @xmath29 , and @xmath210 is the probability measure on the set @xmath569 of configurations in which the states @xmath570 of different bonds are independent and each bond is open with probability @xmath26 .",
    "all rectangles @xmath392 we consider will be aligned with the axes and have corners with integer coordinates ; a rectangle includes its boundary .",
    "open horizontal crossing _ of @xmath392 is a path of open bonds in @xmath392 joining a vertex on the left to one on the right ; we write @xmath571 for the event that @xmath392 has such a crossing .",
    "similarly , @xmath572 is the event that @xmath392 has an open vertical crossing , defined analogously .    as inputs to the argument we shall present ,",
    "we need two simple lemmas , which _ do _ make use of the symmetries of @xmath29 ; the main argument will then use only translational symmetries .",
    "the first lemma is a standard fact which is an easy consequence of the self - duality of @xmath29 .",
    "it is well known to hold with @xmath573 ; see  @xcite , for example .",
    "we write @xmath370 rather than @xmath26 since the main argument below does not depend on the particular value of @xmath370 , and in the case of hyperlattices , the value of @xmath370 in the analogous statement will be different .",
    "[ z1/2 ] there is a constant @xmath574 such that if @xmath89 is any square in @xmath29 then @xmath575.@xmath397    our second ` input lemma ' is the following consequence of lemma  [ z1/2 ] , whose proof also requires the use of symmetry .",
    "here we can take @xmath576 , but again the value of @xmath371 is irrelevant later .",
    "[ zdown ] given an @xmath31-by-@xmath31 square @xmath89 , let @xmath577 be the event that there is an open vertical crossing @xmath30 of @xmath89 such that the @xmath64-coordinates of the endpoints of @xmath30 differ by at most @xmath578 .",
    "there is a constant @xmath579 such that @xmath580 for all squares @xmath89 .",
    "let @xmath574 be as in lemma  [ z1/2 ] and consider @xmath581 ^ 2 $ ] .",
    "we may suppose that @xmath582 .",
    "let @xmath583 be the event that @xmath89 has an open vertical crossing from some point @xmath584 to some point @xmath585 with @xmath586 , and @xmath587 the horizontal mirror image of this event .",
    "now @xmath588 , so we must have @xmath589 for some @xmath73 . since @xmath590 by symmetry , it follows that @xmath591 .",
    "but then , by harris s lemma , @xmath592 .",
    "suppose that @xmath583 and @xmath587 hold , and let @xmath442 and @xmath593 be open paths witnessing these events , with @xmath475 joining @xmath594 to @xmath595 ; see figure  [ fig_f1f2 ] . since @xmath596 , we have @xmath597 and @xmath598 , and similarly @xmath599 and @xmath600 .",
    "it follows that @xmath442 and @xmath593 cross .",
    "hence there is an open path @xmath30 within @xmath89 joining @xmath601 to @xmath602 . since @xmath603",
    ", this shows that @xmath604 holds . in conclusion , if @xmath582 , then @xmath605 , so @xmath606 .",
    "let us write @xmath607 for the probability that a rectangle @xmath392 of width  @xmath548 and height  @xmath549 has an open horizontal crossing , and @xmath608 for the probability that it has an open vertical crossing .",
    "our aim is to prove the following form of the rsw lemma .",
    "[ th_rswz ] there is a constant @xmath404 such that @xmath609 for all @xmath31 .",
    "of course , theorem  [ th_rswz ] is a well known result of russo  @xcite and seymour and welsh  @xcite .",
    "as noted above , our aim in this subsection is to present a ( complicated ) way of deducing theorem  [ th_rswz ] from lemmas  [ z1/2 ] and  [ zdown ] using minimal properties of the measure @xmath210 . in particular",
    ", we shall restrict ourselves to properties that extend to general hyperlattice percolation , so the argument will adapt to prove theorem  [ th_rsw1 ] below .",
    "for example , we shall use translational symmetry but no other symmetry .",
    "we shall make repeated use of harris s lemma , and of the geometric fact that open horizontal and vertical crossings of the same rectangle must meet .",
    "we also use one more very important property of the measure",
    "@xmath210 : if a rectangle @xmath392 has an open horizontal crossing , then it has an _ uppermost open horizontal crossing _",
    "@xmath610 with the property that the event @xmath611 is independent of the states of all bonds below @xmath414 .",
    "indeed , @xmath610 may be found by ` exploring @xmath392 from above ' ; see  @xcite , for example .",
    "similarly , if @xmath571 holds then @xmath392 has a _",
    "lowest open horizontal crossing _",
    "@xmath612 , defined analogously , and found by exploring from below .",
    "the proof of theorem  [ th_rswz ] that we shall present , although simpler than that of theorem  [ th_rsw1 ] , is still somewhat lengthy .",
    "we shall start with three lemmas , the first two of which are standard observations .    in what follows , we shall often implicitly assume that @xmath31 is ` large enough ' , meaning larger than a suitable constant @xmath613 depending on the parameters , e.g. , @xmath311 , that we choose . to avoid clutter",
    ", we ignore the rounding of plane coordinates to integers ; it is easy to see that the effect of rounding can be handled by adjusting the various constants suitably .",
    "( recall that in this subsection we are not proving new results , merely rehearsing the arguments that we shall use in the next subsection ; formally , nothing outside this subsection depends on anything inside it .",
    "so we do not feel the need to dot all i s and cross all t s . )",
    "[ l1e ] for any @xmath300 and @xmath614 there is a @xmath404 such that for any @xmath31 , if @xmath615 then @xmath616 .",
    "given @xmath617 , let @xmath501 and @xmath618 be rectangles of width @xmath31 and heights @xmath619 and @xmath620 , respectively , overlapping in a square @xmath502 of side @xmath31 .",
    "if @xmath621 , @xmath622 and @xmath623 all hold , then so does @xmath624 ; see figure  [ fig_r123 ] for an illustration of this in a slightly different context . by the original form of harris s lemma  @xcite",
    ", it follows that @xmath625 since @xmath626 and @xmath627 by lemma  [ z1/2 ] , applying inductively @xmath628 times gives the result",
    ".    given two overlapping @xmath31-by-@xmath31 squares @xmath629 and @xmath630 such that @xmath630 is obtained from @xmath629 by translating it upwards through a distance of at most @xmath31 , let @xmath631 denote the infinite strip bounded by the vertical lines containing the vertical sides of @xmath629 and @xmath630 .",
    "let @xmath632 be the event that @xmath629 and @xmath630 have open horizontal crossings @xmath442 and @xmath593 that are _ joined _ within @xmath633 , meaning that there is an open path @xmath30 within @xmath633 joining some point of @xmath442 to some point of @xmath593 ; this includes the case where @xmath442 and @xmath593 meet ; see figure  [ fig_j1j2 ] .",
    "note that when @xmath632 holds , a minimal @xmath30 lies entirely between @xmath442 and @xmath593 in the strip , so we may assume that @xmath30 is contained in @xmath634 .",
    "for later , note also that if there is an open horizontal crossing @xmath442 of @xmath629 above an open horizontal crossing @xmath593 of @xmath630 , then @xmath442 is in fact contained in @xmath630 , and the crossings @xmath442 of @xmath629 and @xmath442 of @xmath630 meet , so @xmath632 holds .",
    "[ lj ] for any @xmath300 and @xmath614 there is a @xmath404 such that for any @xmath31 , if there exist @xmath31-by-@xmath31 squares @xmath629 and @xmath630 with @xmath630 obtained by translating @xmath629 upwards by a distance of @xmath635 such that @xmath636 , then @xmath609 .",
    "the event @xmath637 is increasing . hence , by harris s lemma and lemma  [ z1/2 ] , the event @xmath638 has probability at least @xmath639 .",
    "using the fact that horizontal and vertical crossings of the same square must meet , it is easy to see that whenever @xmath604 holds , so does @xmath640 ; see figure  [ fig_j1j2 ] .",
    "hence @xmath641 , and the result follows by applying lemma  [ l1e ] with @xmath639 in place of @xmath642 .",
    "our next lemma is less run - of - the - mill .",
    "given @xmath300 and two @xmath31-by-@xmath31 squares @xmath629 and @xmath630 with @xmath630 obtained by translating @xmath629 upwards by a distance of @xmath643 , define the strip @xmath631 as above , and let @xmath644 be the event that @xmath645 and @xmath646 hold , the path @xmath647 is below @xmath648 in @xmath633 , and the area of @xmath633 between @xmath442 and @xmath593 is at most @xmath649 . in other words ,",
    "the lowest open horizontal crossing of the lower square and the highest of the higher square do not meet , but they are ` close together ' , in the sense that the area between them is small .",
    "[ smallgap ] for any @xmath650 there are constants @xmath651 and @xmath404 such that for any @xmath31 , either there exist @xmath31-by-@xmath31 squares @xmath629 and @xmath630 as above with @xmath652 , or @xmath616 .",
    "set @xmath653 , and , for @xmath654 , let @xmath655\\times [ i{\\varepsilon}n/10,n+i{\\varepsilon}n/10]$ ] , so @xmath656 is obtained by translating @xmath68 upwards through a distance @xmath643 .",
    "let @xmath657 .",
    "since each @xmath658 has probability at least @xmath370 , by harris s lemma there is some @xmath614 such that @xmath659 .",
    "( we may take @xmath660 , but we prefer to be less specific , with an eye to the hyperlattice case . ) set @xmath661 .",
    "if for some @xmath73 the event @xmath662 has probability at least @xmath663 , then we are done by lemma  [ lj ] .",
    "let @xmath664 .",
    "then we may assume that @xmath665 .",
    "hence @xmath666 .",
    "we claim that if @xmath667 holds , then so does @xmath668 .",
    "assuming the claim , the result follows , since for some @xmath73 we have @xmath669    suppose then that @xmath667 holds , and let @xmath670 and @xmath476 be the lowest and highest open horizontal crossings of @xmath68 .",
    "note that @xmath670 and @xmath476 may meet , but @xmath670 lies ( weakly ) below @xmath476 .",
    "since @xmath671 does not hold , for @xmath672 , the path @xmath476 is strictly below @xmath673 ; it follows that @xmath670 is strictly below @xmath673 . for @xmath674 , let @xmath291 be the region in @xmath633 between @xmath670 and @xmath675",
    ". then the @xmath291 are disjoint .",
    "since there are @xmath676 such regions @xmath291 , and their union is contained in a rectangle of width @xmath31 and height @xmath677 , it follows that some @xmath291 has area at most @xmath649 .",
    "since the region between @xmath670 and @xmath678 is contained in @xmath291 , it follows that @xmath679 holds , as required .",
    "clearly , in the present context the events @xmath679 considered above all have the same probability due to translational symmetry ; with an eye to the general case , we avoided using this fact .",
    "we now turn to the key idea , which is a rather involved way of generating a configuration . given a configuration @xmath71 and a vector @xmath680 ,",
    "let @xmath681 be obtained by translating @xmath71 through the vector @xmath42 .",
    "thus the state of a bond @xmath37 in @xmath681 is the state of its translate @xmath682 in @xmath71 .",
    "let us say that a random configuration @xmath71 has the _ standard distribution _ if it has the distribution corresponding to @xmath210 , so bonds are open independently in @xmath71 and each is open with probability @xmath26 . from translation invariance ,",
    "if @xmath71 is random with the standard distribution and @xmath42 is constant , then @xmath681 has the standard distribution .",
    "this conclusion also holds if @xmath42 is random , as long as @xmath71 and @xmath42 are independent .",
    "suppose we have some algorithm @xmath683 whose input is a configuration @xmath71 , and that @xmath683 examines the states of bonds one by one , with the next bond to be examined depending on the results of previous examinations , but not on the states of any other bonds .",
    "we assume that @xmath683 terminates after a finite number of steps , and write @xmath684 for the set of bonds examined by @xmath683 when @xmath683 is run on the configuration @xmath71 .",
    "let @xmath685 and @xmath686 be independent standard configurations .",
    "define a new configuration @xmath71 by running @xmath683 on @xmath685 , setting @xmath687 if @xmath688 and @xmath689 otherwise .",
    "then it is easy to check that @xmath71 has the standard distribution : we can think of tossing coins corresponding to @xmath685 to determine the states of all bonds , looking at certain bonds ( corresponding to @xmath690 ) , and then retossing the coins we have not yet looked at",
    ".    given an algorithm @xmath683 as above , and a corresponding map @xmath691 from the set @xmath367 of all configurations to the set of subsets of @xmath692 , define a map @xmath693 from @xmath694 to @xmath367 by @xmath695 combining the two observations above , we see that if @xmath685 , @xmath686 and @xmath42 are independent and @xmath685 and @xmath686 have the standard distribution , then @xmath696 does too .",
    "recall that our task is to show that the probability @xmath697 that an @xmath31-by-@xmath698 rectangle has an open vertical crossing is bounded away from zero , using lemmas  [ z1/2 ] and  [ zdown ] as ` inputs ' , and otherwise making no use of reflectional or rotational symmetry .    with an eye to later generalizations ,",
    "suppose that @xmath699 , @xmath700 , @xmath701 and @xmath702 are positive constants satisfying @xmath703 let @xmath704 be the event that the rectangle @xmath705\\times [ 0,\\beta_2 n]$ ] contains an open path from some point @xmath433 to some point @xmath706 with @xmath707 and @xmath708 .",
    "( here ` v ' stands for ` vertical ' : the overall orientation of the path is significantly closer to vertical than to horizontal . ) taking @xmath709 and @xmath710 , lemma  [ zdown ] tells us that for all ( large enough ) @xmath31 , we have @xmath711 . in the rest of the proof",
    "we assume only that our various constants satisfy and that , for these constants , @xmath712 is bounded away from @xmath446 .",
    "pick @xmath713 such that @xmath714 and choose @xmath300 such that @xmath715 and @xmath716    let @xmath663 and @xmath143 be the constants given by lemma  [ smallgap ] . for any @xmath31 , by lemma  [ smallgap ] , either @xmath609 , in which case we are done , or there are squares @xmath629 and @xmath630 with @xmath630 obtained by translating @xmath629 upwards by a distance of @xmath643 such that @xmath717 we may assume that the second case holds . by translational symmetry , we may assume that @xmath718 ^ 2 $ ] and @xmath719\\times[{\\varepsilon}n/10,(1+{\\varepsilon}/10)n]$ ] .",
    "recall that @xmath637 is the event that there are open horizontal crossings of @xmath629 and @xmath630 that meet , or are connected by an open path lying within the strip @xmath720 generated by @xmath634 .",
    "also , @xmath721 is the event that @xmath645 and @xmath646 hold , the path @xmath647 is below @xmath648 in @xmath633 , and the area of @xmath633 between @xmath442 and @xmath593 is at most @xmath649 . we shall show that @xmath722 for some constant @xmath642 depending on the various constants we have chosen so far , but not on @xmath31 .",
    "then @xmath723 and so , applying lemma  [ lj ] and reducing @xmath143 if necessary , we have @xmath609 , as required .",
    "consider the following algorithm @xmath683 for testing whether @xmath724 holds : explore @xmath629 from below ( as in  @xcite ) to find its lowest horizontal crossing @xmath442 , if @xmath645 holds . similarly ,",
    "explore @xmath630 from above to find its uppermost horizontal crossing @xmath593 , if @xmath646 holds ; then , from the positions of @xmath442 and @xmath593 , decide whether @xmath724 holds .",
    "define @xmath725 as in above .",
    "let @xmath685 , @xmath686 and @xmath726 be independent , where the @xmath727 are random configurations ( with the standard distribution ) and @xmath726 is uniformly random on @xmath728 ^ 2=\\{-5n,-5n-1,\\ldots,5n-1\\}^2\\subset { { \\mathbb z}}^2 $ ] , and let @xmath729 , so @xmath71 has the standard distribution .",
    "the reason for the slightly incongruous notation is that the core of our argument will involve conditioning on @xmath685 and @xmath686 , but keeping @xmath726 random .    to establish , we first examine @xmath71 to check whether @xmath730 .",
    "this depends only on the states of bonds examined by the algorithm @xmath683 above ; by the definition of @xmath725 , the state of such bonds in @xmath71 is the same as in @xmath685 .",
    "thus @xmath730 if and only if @xmath731 .",
    "when this event holds , let @xmath442 and @xmath593 be the paths defined above , and write @xmath17 for the part of the strip @xmath633 on or below @xmath442 , @xmath18 for the part of @xmath633 on or above @xmath593 , and @xmath36 for the ` gap ' between @xmath442 and @xmath593 , i.e. , the rest of @xmath633 ; see figure  [ fig_p * ] .",
    "note that all bonds whose interiors lie within @xmath36 have their states in @xmath732 given by @xmath733 .",
    "suppose that @xmath686 contains an open path @xmath30 from a point @xmath41 to a point @xmath42 .",
    "then @xmath733 contains the open path @xmath734 , the translate of @xmath30 through @xmath735 , joining @xmath736 to @xmath737 .",
    "if @xmath738 , @xmath739 , and @xmath734 remains within the strip @xmath740 , then the minimal subpath @xmath32 of @xmath734 meeting @xmath17 and @xmath18 contains bonds only in @xmath36 , so this path @xmath32 is present in @xmath71 and joins @xmath442 and @xmath593 , and @xmath741 .    let @xmath604 be the event that @xmath731 and @xmath742 . since @xmath685 and @xmath686 are independent , we have @xmath743 . for the rest of the proof we condition on @xmath685 and @xmath686 , so the only remaining randomness is in the choice of @xmath726 .",
    "we assume that @xmath604 holds ; we shall show that for any @xmath685 and @xmath686 such that @xmath604 holds , the conditional probability that @xmath671 holds satisfies @xmath744 then we have @xmath745 , establishing .",
    "it remains only to prove .",
    "let us choose an open path @xmath30 in the configuration @xmath686 witnessing @xmath742 ; thus @xmath30 lies within @xmath705\\times [ 0,\\beta_2 n]$ ] and joins some point @xmath433 to some @xmath706 with @xmath746 and @xmath747 . let @xmath42 be the vector @xmath748 .",
    "let @xmath749 , and note that @xmath750 since @xmath746 and @xmath751 .",
    "for @xmath752 , set @xmath753 ; we think of @xmath754 as an _ offset _ , for reasons that will hopefully become clear .",
    "let @xmath755 be the ( ` virtual ' , in the sense that it is not known to be open in any configuration we are considering ) path formed by starting at the origin and concatenating @xmath756 copies of @xmath30 .",
    "thus @xmath755 is the union of the paths @xmath757 , where each @xmath758 is the translate of @xmath30 joining the point @xmath759 to @xmath754 ; see figure  [ fig_p * ] .    if @xmath760 , let @xmath761 be the point @xmath762 ; otherwise , set @xmath763 .",
    "we claim that if a translate @xmath764 of @xmath755 starts at a point within the square @xmath765 of side @xmath619 centred at @xmath761 , then this translate lies entirely within the strip @xmath633 .",
    "indeed , in the case @xmath760 , the @xmath64-coordinate of any point of @xmath764 is within @xmath766 of the @xmath64-coordinate of some point @xmath767 , and hence is at least @xmath446 and at most @xmath768 using the assumption that @xmath769 in the final step . in the case @xmath770 the argument is similar , subtracting all @xmath64-coordinates from @xmath31 .",
    "note that @xmath765 lies entirely below @xmath629 , so , recalling that @xmath17 and @xmath18 are the portions of the strip @xmath633 that lie below @xmath442 and above @xmath593 , respectively , we have @xmath771 .",
    "if a translate of @xmath755 starts at a point in @xmath765 , then it ends at a point with @xmath65-coordinate at least @xmath772 , so its upper endpoint is above @xmath630 , and hence lies in @xmath18 .    for any point @xmath773 , we have seen that @xmath774 , while @xmath775 .",
    "also , @xmath776 for @xmath752 .",
    "hence , either some point @xmath777 , @xmath778 , lies in the ` gap ' @xmath36 , or there is some @xmath73 such that @xmath779 and @xmath780 .",
    "let us colour the points of @xmath765 with @xmath781 colours , assigning colour 0 in the first case , and colour @xmath73 in the second ( choosing the minimal @xmath73 if there are several ) .",
    "let @xmath782 denote the set of points in @xmath765 assigned colour @xmath73 .",
    "now @xmath783 is a subset of the union of @xmath784 translates of @xmath36 . since @xmath36 has area at most @xmath649 , while @xmath785 , the area of @xmath783 is thus at most @xmath786 , recalling .",
    "since @xmath765 has area @xmath787 , it follows that there is some @xmath230 for which @xmath782 has area at least @xmath788 .",
    "recall that in constructing our random configuration @xmath71 as @xmath729 , we shift the configuration @xmath686 by a random vector @xmath726 uniformly distributed on ( the integer points in ) @xmath728 ^ 2 $ ] . recall also that the open path @xmath30 in @xmath686 starts at @xmath789\\times[0,\\beta_2 n]\\subset[0,2n]^2 $ ] .",
    "consider the set @xmath790 .",
    "then @xmath791 has the same area as @xmath782 , and certainly lies within @xmath728 ^ 2 $ ] .",
    "hence the probability that @xmath726 falls in @xmath791 is at least @xmath792 .",
    "but when this happens , the translate @xmath793 of @xmath30 starts at a point of @xmath794 .",
    "hence we may think of @xmath793 as the path @xmath795 in a translate of @xmath755 starting at a point of @xmath782 . from the comments above and",
    "the definition of @xmath782 it follows that @xmath793 lies entirely within @xmath58 , starts in @xmath17 , and ends in @xmath18 . as noted earlier , the presence of such a path in @xmath733 guarantees that the configuration @xmath732 has the property @xmath671 .",
    "hence the conditional probability that @xmath71 belongs to @xmath671 given @xmath685 and @xmath686 is at least @xmath796 , establishing and completing the proof .",
    "[ rchain ] the key step of the proof above involved selecting an open path @xmath30 in @xmath686 , and then chaining together translates of @xmath30 to form a path @xmath755 with the following properties : @xmath755 stays well within the strip @xmath633 , starts well below @xmath629 , and ends well above @xmath630 , where ` well within ' means at least a distance @xmath797 away from the boundary .",
    "this elbow room ensures that we can translate @xmath755 through distances of up to @xmath797 while retaining the properties of starting below @xmath629 , ending above @xmath630 , and remaining within @xmath633 .",
    "then we randomly shifted the whole path @xmath755 , and randomly chose one of the links in the chain to focus on , thinking of this link as being the final random shift @xmath32 of the path @xmath30 in @xmath686 .",
    "since it is unlikely that any randomly shifted link starts or ends in the gap @xmath36 , there is always at least one link that crosses from @xmath17 to @xmath18 , so the probability that @xmath32 does so is bounded away from zero . in order to construct a suitable @xmath755",
    ", we required that @xmath30 remain within a fairly small region , and that its endpoints be significantly further apart vertically than horizontally .",
    "it is just as easy to start from more than one path in @xmath686 . indeed , suppose that there are constants @xmath404 and @xmath20 such that with probability at least @xmath143 the configuration @xmath686 contains a set of open paths @xmath798 such that we can chain together at most @xmath20 paths @xmath758 , each of which is a translate of some @xmath798 , to form a path @xmath755 with the properties above . note that this will hold ( for example ) whenever @xmath686 contains paths @xmath442 and @xmath593 each of which stays within some not - too - large region , such that the overall directions of @xmath442 and @xmath593 are significantly different , and each is not too short , in the sense that the vector from the start to the end is not too short",
    ". then one can always chain @xmath428 copies together to produce an approximation to a vertical line .",
    "taking @xmath759 to be the start of the @xmath73th path in the chain as above , the proof goes through essentially unaltered , except that at the very end we set @xmath799 if the @xmath73th path in our chain is a copy of @xmath798 , where @xmath800 is the starting point of @xmath798 .",
    "our aim in this subsection is to prove an analogue of theorem  [ th_rswz ] in the context of percolation on plane hyperlattices ; we have already illustrated the main ideas in a simpler context in the previous subsection .",
    "recall that a plane hyperlattice @xmath52 , originally defined as an embedding of a hypergraph , may also be defined simply as a cubic map whose faces are properly coloured black , white and grey , in a way that is invariant under translations through elements of the lattice @xmath48 ; see section  [ sec_mod ] .",
    "recall from section  [ sec_cc ] that an _ independent lattice colouring _ @xmath363 associated to @xmath33 is a random black / white - coloured map obtained from @xmath33 as follows : first subdivide each grey face into _ subfaces _ in a deterministic manner , keeping the resulting map cubic .",
    "then recolour these subfaces randomly black and white , with the colourings inside different grey faces independent , such that if one grey face is obtained by translating another through an element of @xmath48 , then their colourings have the same distribution .",
    "such a random colouring @xmath363 gives rise to a hyperlattice percolation model @xmath83 : simply take the non - crossing partition  of a hyperedge @xmath37 to be the partition of the black faces around the corresponding grey face @xmath364 induced by the ( black part of ) the colouring of @xmath364 .",
    "we say that @xmath363 _ realizes _ the model @xmath83 .",
    "it turns out that , at one point in the coming argument , we may need to modify the colouring within certain faces . to enable this",
    ", we need our random colouring to satisfy a certain technical assumption . given a colouring @xmath801 of a grey face @xmath364 ,",
    "the _ colour components _ of @xmath801 are the maximal connected monochromatic subsets of @xmath364 .",
    "[ maldef ] an independent lattice colouring @xmath363 is _ malleable _ if two conditions hold .",
    "first , within each grey face @xmath364 , the all - white colouring has positive probability .",
    "second , if @xmath801 is a colouring of @xmath364 with positive probability , and @xmath802 is obtained from @xmath801 by recolouring a white component black , then @xmath802 has positive probability .",
    "note that , in a malleable colouring , the all - black colouring of a grey face necessarily has positive probability , so a malleable colouring is non - degenerate ( meaning , as before , that within each grey face , the all - black and all - white colourings have positive probability ) .    in general , recolouring as above may change the partition @xmath63 corresponding to the colouring @xmath801 in many different ways .",
    "however , if we restrict the colourings suitably , the situation becomes simpler .",
    "let us call a part of a partition @xmath63 _ non - trivial _ if it is not a singleton .",
    "a colouring @xmath801 of a grey face @xmath364 is _ minimal _ if its black components are in one - to - one correspondence with the non - trivial parts of @xmath63 , and its white components with those of the dual partition @xmath69 .",
    "let us say that a part @xmath30 of @xmath63 is _ adjacent _ to a part @xmath32 of @xmath69 if , in the original polygon formulation of non - crossing partitions , @xmath30 contains a vertex @xmath42 and @xmath32 an edge @xmath37 incident to @xmath42 .",
    "this corresponds to @xmath30 containing a black vertex adjacent to a white dual vertex in @xmath32 .",
    "if @xmath801 is a minimal colouring associated to a partition @xmath63 , then recolouring a white component black has the effect of uniting all parts of @xmath63 adjacent to some non - trivial part of @xmath69 .",
    "we call such an operation on a partition a _ joining_. in the dual , the operation is simpler : simply split a non - trivial part into singletons .    given a hyperedge @xmath37 , by the _ top _ partition of its vertices we mean the partition into a single part .",
    "the _ bottom _ partition is that into singletons . recall that a probability vector @xmath99 associated to a hyperlattice @xmath52 assigns a probability @xmath80 to each non - crossing partition @xmath63 of the vertices of a hyperedge @xmath37 , where @xmath73 encodes which orbit of the action of @xmath48 the hyperedge @xmath37 belongs to .",
    "a hyperlattice percolation model @xmath83 is _ non - degenerate _ if @xmath803 whenever @xmath63 is a top or bottom partition .",
    "[ maldef2 ] a hyperlattice percolation model @xmath83 is _ malleable _ if it is non - degenerate and , whenever @xmath803 and @xmath92 is obtained from @xmath63 by a joining operation as defined above , then @xmath804 .",
    "note that if @xmath33 is 3-uniform , then any non - degenerate model @xmath83 is automatically malleable : any joining operation results in the top partition .",
    "also , any @xmath99 assigning positive probability to all top and bottom partitions but to no other partitions gives a malleable model : the unique joining operation that may be performed on a bottom partition yields the corresponding top partition .",
    "thus malleability holds automatically in the ` site percolation ' models considered in the discussion surrounding theorem  [ th2 ] .    if @xmath83 is self - dual , then malleability is equivalent to its dual formulation , that if @xmath803 and @xmath92 is obtained from @xmath63 by splitting a part into singletons , then @xmath804 .",
    "the next lemma captures the connection between the notions of malleability for probability vectors and for lattice colourings .",
    "[ regpos ] let @xmath83 be a malleable hyperlattice percolation model .",
    "then @xmath83 may be realized by a malleable independent lattice colouring .",
    "regard @xmath33 as a 3-coloured cubic map , as usual . for each grey face",
    "@xmath364 corresponding to hyperedge @xmath37 with at least 3 vertices , subdivide it into subfaces as in figure  [ fig_shading6 ] .",
    "( when @xmath805 one can also use the simpler subdivision shown in figure  [ fig_shading3 ] . ) it is not hard to check that for any non - crossing partition @xmath63 of the vertices of @xmath37 , there is at least one black / white colouring of the subfaces of @xmath364 that gives a _ minimal _ colouring realizing the partition @xmath63 .",
    "if there are @xmath806 such colourings , assign each probability @xmath807 , where @xmath73 is the probability vector entry corresponding to @xmath37 . since @xmath83 is non - degenerate , the all - black and all - white colourings ( which are minimal ) receive positive probability . also , if @xmath801 is any colouring of @xmath364 receiving positive probability , then @xmath803 for the corresponding @xmath63 .",
    "if @xmath802 is obtained from @xmath801 by recolouring a white component to black , then @xmath802 is minimal , and corresponds to a partition @xmath92 obtained from @xmath63 by a joining operation . since @xmath83 is malleable , we have @xmath804 , so @xmath802 has positive probability .    for a hyperedge @xmath37 with @xmath808 ,",
    "there is no need to subdivide @xmath364 at all ; simply colour @xmath364 black or white with the appropriate ( positive ) probabilities .",
    "finally , if @xmath809 then the colouring of @xmath364 is irrelevant , so we may colour @xmath364 black with probability @xmath26 and white otherwise .",
    "of course , a similar but simpler argument shows that any non - degenerate hyperlattice percolation model may be realized by a non - degenerate independent lattice colouring .",
    "as noted in section  [ sec_cc ] , a non - degenerate independent lattice colouring @xmath363 corresponds to a product probability measure on a power of a certain poset in a natural way ; furthermore , the non - degeneracy condition ensures that lemma  [ ourharris2 ] applies both to this poset and to its reverse .",
    "events defined by the existence of black paths with certain properties are upsets ; events defined by the existence of white paths are downsets .    for the rest of this section we fix a malleable independent lattice colouring @xmath363 .",
    "recall that a black horizontal crossing of a rectangle @xmath392 is a piecewise - linear path @xmath30 in the plane joining a point on the left - hand side of @xmath392 to a point on the right and otherwise lying in the interior of @xmath392 , such that every point of @xmath30 is black .",
    "white vertical crossings are defined similarly , and so on . in our product probability space ,",
    "events such as @xmath395 are increasing .",
    "we shall use the following lemma , which applies to all black / white colourings of cubic planar maps , i.e. , involves no randomness .",
    "[ oneway_i ] let @xmath392 be a rectangle in @xmath34 in general position with respect to a colouring @xmath363",
    ". then precisely one of the events @xmath395 and @xmath396 holds .    as in  (",
    "* ch . 8 , lemma 12 ) , from where figure  [ fig_ow ] is adapted , re - colour the points outside @xmath392 as in figure  [ fig_ow ] , and consider the interfaces between black and white regions .",
    "@xmath810    we shall need the equivalent of highest and lowest open crossings ; these are the highest and lowest _ black _ crossings of a rectangle , defined below .",
    "the definitions require a little care , as the independence properties are not quite what one would like .    given a rectangle @xmath392 and our colouring @xmath363 , shade the outside of the rectangle as in figure  [ fig_ow ] .",
    "let @xmath811 be the _ interface _ shown by the thick black line , starting at the top left corner .",
    "thus if @xmath395 holds , then @xmath811 leaves the rectangle @xmath392 from the top right corner .",
    "let @xmath812 be the minimal subpath of @xmath811 meeting both vertical sides of @xmath392 . in the figure",
    ", points just to the right of @xmath811 are black .",
    "hence , points just to the right of @xmath812 give a black path within @xmath392 joining the left to the right .",
    "we call this path the _ highest black horizontal crossing _ of @xmath392 , and denote it @xmath610 . similarly , again assuming @xmath395 holds , the interface @xmath813 starting at the bottom right corner leaves at the bottom left ; we define @xmath814 to be the minimal subpath joining the vertical sides of @xmath392 ; the points to the right of @xmath814 form the _ lowest black horizontal crossing _ of @xmath392 , written @xmath612 .",
    "in fact , we can usually work directly with the interfaces @xmath815 and @xmath816 .",
    "as before , a rectangle @xmath392 is _ large _ if all its sides have length at least @xmath385 , where @xmath377 is the constant from lemma  [ reg ] .    given an angle @xmath390 , a @xmath390-aligned rectangle @xmath526 , and ` length scales ' @xmath548 and @xmath549 , let @xmath817 be the event that @xmath526 contains a black path @xmath30 such that , after rotating so that @xmath526 is horizontal , the endpoints @xmath433 and @xmath706 of @xmath30 satisfy @xmath818 and @xmath819 .",
    "our aim now is to adapt the proof of theorem  [ th_rswz ] to prove the following result .",
    "[ th_rsw1 ] let @xmath363 be a malleable independent lattice colouring .",
    "given constants @xmath820 , @xmath821 , @xmath822 , and @xmath370 , @xmath823 , there exists a constant @xmath404 such that the following holds .",
    "suppose that @xmath392 is a large rectangle with width  @xmath548 and height  @xmath549 and any orientation , and @xmath526 is a large rectangle with the same orientation , width  @xmath824 , and height  @xmath825 .",
    "if @xmath826 , @xmath827 , and @xmath828 , then @xmath829 for any rectangle @xmath542 with the same orientation as @xmath392 , width  @xmath548 and height  @xmath830 .",
    "our proof of theorem  [ th_rsw1 ] will follow that of theorem  [ th_rswz ] in the previous subsection , rescaling to map the square @xmath629 considered there onto the rectangle @xmath392 .",
    "unfortunately , there are various additional complications ; for example , we can not assume that congruent rectangles with the same orientation have the same crossing probabilities .",
    "these complications can be dealt with using corollary  [ c_trans_lower ] .",
    "there will also be some other difficulties .",
    "[ rsym ] as noted in section  [ sec_cc ] , although the probabilities of events such as the existence of various crossings of a rectangle @xmath392 will depend very much on the orientation of @xmath392 , and to a lesser extent on its position , all the lower bounds we shall prove will depend on @xmath363 only via three quantities : the quantity @xmath377 appearing in lemma  [ reg ] ( which provides an upper bound on the diameter of a face ) , the maximum number @xmath319 of faces meeting any disk of radius @xmath138 , and the minimum probability @xmath10 of a configuration within a face .",
    "these three quantities are preserved by rotations and translations , so whenever we consider a single rectangle @xmath392 , we may rotate and translate @xmath392 _ and @xmath363 _ together so that @xmath392 has the form @xmath831\\times [ 0,{n}]$ ] .",
    "let us write @xmath400 for @xmath504 and @xmath401 for @xmath506 . also , we write @xmath832 for the probability that @xmath831\\times [ 0,{n}]$ ] has a black horizontal crossing , and @xmath833 for the probability that it has a black vertical crossing . recall that by corollary  [ c_trans_lower ] there is an increasing function @xmath834 such that if @xmath392 and @xmath526 are large rectangles with the same orientation , width and height , then @xmath534 and @xmath535 .",
    "recall that the colouring @xmath363 we are considering is malleable and hence non - degenerate , meaning that within any grey face , the all - black and all - white colourings have positive probabilities .",
    "as noted earlier , non - degeneracy allows us to apply our harris - type lemma , lemma  [ ourharris2 ] , to two black - increasing events , or two white - increasing events . throughout the proof of theorem  [ th_rsw1 ]",
    "we write @xmath289 for the function whose existence is guaranteed by lemma  [ ourharris2 ] , so for any two black - increasing events @xmath17 and @xmath18 we have @xmath835    the first step in our proof of theorem  [ th_rsw1 ] is the analogue of lemma  [ l1e ] ; there is an additional assumption ( that @xmath832 and @xmath833 are at least @xmath370 ) since we do _ not _ have the analogue of lemma  [ z1/2 ] in this context .",
    "[ cextend ] let @xmath363 be a non - degenerate independent lattice colouring , and let @xmath300 , @xmath574 and @xmath614 .",
    "there is a @xmath404 such that for any @xmath836 , if @xmath837 , @xmath838 , and @xmath839 , then @xmath840 .",
    "fix @xmath311 , @xmath370 and @xmath614 . let @xmath841 ; for @xmath842 let @xmath843 where @xmath530 is the function appearing in corollary  [ c_trans_lower ] , and set @xmath844",
    ". note that @xmath404 .",
    "suppose that @xmath836 , @xmath837 , @xmath838 , and @xmath839 .",
    "we claim that for every @xmath842 we have @xmath845 setting @xmath846 , we then have @xmath847 , so @xmath848 , and the result follows .",
    "we prove by induction .",
    "for @xmath255 it is true by assumption . turning to the induction step ,",
    "suppose that holds for some @xmath73 , and consider the rectangles @xmath849\\times[0,(1+i{\\varepsilon}){n}]$ ] , @xmath850\\times [ i{\\varepsilon}{n},(1+i{\\varepsilon}){n}]$ ] , and @xmath851\\times[i{\\varepsilon}{n},1+(i+1){\\varepsilon}{n}]$ ] , as in figure  [ fig_r123 ] .",
    "let @xmath852\\times[0,{n}]$ ] and @xmath853\\times [ 0,(1+{\\varepsilon}){n}]$ ] , so @xmath854 and @xmath855 are images of @xmath502 and @xmath618 under appropriate translations .    by the induction hypothesis we have @xmath856 and by assumption we have @xmath857 .",
    "hence , by corollary  [ c_trans_lower ] , we have @xmath858 . similarly , by assumption @xmath859 , so @xmath860 .",
    "since @xmath861 and @xmath862 are increasing events , from it follows that @xmath863 . applying to the increasing events @xmath864 and @xmath865",
    ", it follows that with probability at least @xmath866 , the events @xmath861 , @xmath862 and @xmath865 all hold .",
    "choosing black paths @xmath442 , @xmath593 and @xmath867 witnessing these events , @xmath593 meets both @xmath442 and @xmath867 , and it follows that @xmath868 holds .",
    "hence @xmath869 proving the induction step and so completing the proof of .",
    "the next step is the analogue of lemma  [ lj ] ; this concerns crossings of nearby squares ( now rectangles ) that are joined . as in the previous lemma",
    ", we work with rectangles , not squares , and add the assumptions that @xmath832 and @xmath833 are at least some constant @xmath370 rather than appeal to lemma  [ z1/2 ] .",
    "the definition of the event @xmath671 is as before , _ mutatis mutandis _ :",
    "specifically , wherever @xmath31 appears in the definition , it is replaced by @xmath548 or @xmath549 depending on whether we are considering an @xmath64-coordinate or a @xmath65-coordinate .",
    "[ lj2 ] let @xmath363 be a non - degenerate independent lattice colouring .",
    "for any @xmath300 , @xmath574 and @xmath614 , there is a @xmath404 such that for any @xmath836 with @xmath832 , @xmath838 , if there exist @xmath548-by-@xmath549 rectangles @xmath501 and @xmath502 , with @xmath502 obtained by translating @xmath501 upwards by a distance of @xmath870 , for which @xmath871 , then @xmath840 .",
    "modify the proof of lemma  [ lj ] as above : replace each application of harris s lemma by an appeal to , and use the fact that , under our assumptions , any @xmath548-by-@xmath549 rectangle @xmath392 has @xmath400 , @xmath872 by corollary  [ c_trans_lower ] .",
    "next comes the analogue of lemma  [ smallgap ] . for two @xmath548-by-@xmath549 rectangles @xmath501 and @xmath502 , with @xmath502 obtained by translating @xmath501 upwards by a distance of @xmath873 , define the strip @xmath874 to be the region between the vertical lines containing the vertical sides of @xmath501 and @xmath502 , and let @xmath875 be the event that @xmath876 and @xmath862 hold , the path @xmath877 is below @xmath878 in @xmath633 , and the area of @xmath633 between @xmath442 and @xmath593 is at most @xmath879 .",
    "[ smallgap2 ] let @xmath363 be a non - degenerate independent lattice colouring .",
    "for any @xmath300 and @xmath574 there are constants @xmath651 and @xmath404 such that for any @xmath836 with @xmath832 , @xmath838 , either there exist @xmath548-by-@xmath549 rectangles @xmath501 and @xmath502 as above with @xmath880 , or @xmath881 .",
    "imitate the proof of lemma  [ smallgap ] , _ mutatis mutandis_.    in adapting the main part of the proof of theorem  [ th_rswz ] there is only one genuine additional complication : we shall have to work to join up paths in our two configurations @xmath685 and @xmath882 .",
    "the other changes are mostly in notation .",
    "recall that our independent lattice colouring @xmath363 is obtained by randomly colouring the subdivided grey faces of the 3-coloured planar map @xmath33 .",
    "as before , let @xmath367 denote the set of all configurations , i.e. , assignments of states to the grey faces of @xmath33 .",
    "let @xmath683 be an algorithm that examines the states of grey faces in its input configuration one by one , with the next face to be examined determined by the states of the faces examined so far .",
    "assume that @xmath683 terminates and write @xmath883 for the set of grey faces examined by @xmath683 when run on the configuration @xmath71 .",
    "recalling that @xmath33 is invariant under translations through elements of the lattice @xmath48 , define a function @xmath693 from @xmath884 to @xmath367 by @xmath885 , where @xmath886 is the configuration given by @xmath887 here @xmath888 denotes an arbitrary grey face , and @xmath889 the grey face obtained by translating @xmath888 through the vector @xmath890 .",
    "in other words , as before , the state of a grey face in @xmath886 is given either by its state in @xmath685 or by its state in the translate @xmath891 of @xmath686 , according to whether or not the algorithm @xmath683 examines @xmath888 when run on the configuration @xmath685 .",
    "let @xmath892 be the set of points of @xmath48 in @xmath893\\times [ -5n,5n]$ ] , and interpret @xmath894 as the product probability space in which the two configurations have the distribution associated to @xmath363 and are independent , and the random vector @xmath895 is chosen uniformly from @xmath892 .",
    "as before , @xmath732 has the distribution appropriate for @xmath363 .",
    "we follow the proof of theorem  [ th_rswz ] , concentrating on the differences . in the light of remark  [ rsym ] , rotating the rectangles under consideration together with @xmath363 , we may assume that @xmath392 and @xmath526 are aligned with the coordinate axes , i.e. , are @xmath446-aligned .",
    "first , note that now holds by assumption .",
    "as before , choose @xmath713 such that holds , and then choose @xmath300 such that @xmath715 and holds .",
    "let @xmath548 and @xmath549 satisfy the assumptions of the theorem . then , since @xmath832 , @xmath838 , we can apply lemma  [ smallgap2 ] .",
    "let @xmath663 and @xmath143 be the constants given by lemma  [ smallgap2 ] , so either @xmath840 , in which case we are done , or there are @xmath548-by-@xmath549 @xmath446-aligned rectangles @xmath629 and @xmath630 with @xmath630 obtained by translating @xmath629 upwards by a distance of @xmath873 such that @xmath896 we may assume that the second case holds .",
    "translating the rectangles under consideration together with @xmath363 , we may assume that @xmath897\\times[0,{n}]$ ] and @xmath898\\times[{\\varepsilon}{n}/10,(1+{\\varepsilon}/10){n}]$ ] .",
    "as before , we explore @xmath629 from below to find its lowest black horizontal crossing @xmath442 , if it exists , and @xmath630 from above to find its highest black horizontal crossing @xmath593 .",
    "more precisely , we let @xmath899 be the interface @xmath815 in @xmath629 described earlier in the subsection , and @xmath900 the interface @xmath816 in @xmath630 .",
    "note that orienting these interfaces as in figure  [ fig_interfaces ] , the points just to the right of each interface are black while those to the left are either white , or inside @xmath58 but outside the relevant rectangle @xmath68 vertically , if the interface runs along the top / bottom of @xmath68 .",
    "it follows that @xmath899 and @xmath900 can not meet .",
    "our definitions allow us to view @xmath901 as a black path itself , although it is perhaps clearer to think of @xmath475 as running next to @xmath901 . in the present context ,",
    "the _ gap _ @xmath36 is the region between @xmath899 and @xmath900 ; we define @xmath17 and @xmath18 to be the regions of our strip @xmath831\\times{{\\mathbb r}}$ ] below @xmath899 and above @xmath900 , respectively .    as before , we first test whether @xmath731 , using the algorithm @xmath683 implicitly defined above .",
    "more precisely , we implement @xmath683 by following the full interfaces @xmath813 and @xmath811 in the relevant rectangles .",
    "note that this only involves ` testing ' the state of grey faces @xmath70 that meet one of these interfaces , where @xmath70 _ meets _",
    "@xmath756 if @xmath756 passes through @xmath70 , or along one of the sides of @xmath70 . it is easy to check that all of @xmath813 lies below @xmath902 , and all of @xmath811 above @xmath900 .",
    "let @xmath903 denote the union of @xmath901 and all grey faces that meet @xmath901 , which we think of as the _ zone of influence _ of @xmath901 .",
    "then when @xmath724 holds , the algorithm @xmath683 establishes this by looking only at grey faces in @xmath904 . defining @xmath732 as before",
    ", it follows that any grey face contained in @xmath905 has its state in @xmath71 given by its state in @xmath906 , the configuration @xmath686 translated through the random vector @xmath726 .    as before ,",
    "we condition on @xmath685 , assuming that @xmath724 holds , which it does with probability bounded away from zero .",
    "furthermore , we condition on @xmath686 , assuming the existence of a path @xmath30 with the property described in the definition of @xmath817 .",
    "again , the probability of this event is bounded away from zero , this time by assumption .",
    "as before , the only remaining randomness is in the choice of the random translation @xmath726 .    recalling that we may take @xmath567 and @xmath31 large ,",
    "apart from one very minor technical issue that we postpone to the end of the proof , trivial modifications to our previous arguments show that with probability bounded away from zero , the random translate @xmath734 of @xmath30 crosses from @xmath17 to @xmath18 , while remaining within the strip @xmath633 .",
    "in fact , adjusting the constants slightly if necessary , we can assume that it does not come within distance @xmath377 of the edges of @xmath633 .",
    "let @xmath907 denote the set of triples @xmath908 such that @xmath731 , and @xmath686 contains a path @xmath30 as above whose translate @xmath909 meets the interfaces @xmath899 and @xmath900 in @xmath685 .",
    "we have shown that @xmath910 is bounded away from zero . unfortunately , unlike in the @xmath29 setting , it is not true that if @xmath911 , then @xmath912 ; the problem is illustrated in figure  [ fig_problem ] .    to overcome this problem , we adjust the colourings of at most two faces .",
    "let @xmath911 , and let @xmath32 denote a minimal part of the path @xmath909 joining @xmath899 to @xmath900 .",
    "then @xmath32 necessarily lies in the gap @xmath36 .",
    "let @xmath913 denote a minimal subpath of @xmath32 joining @xmath914 to @xmath915 ) , and let @xmath916 and @xmath917 denote its endpoints ( which may coincide , if @xmath914 and @xmath918 meet ) ; see figure  [ fig_gap ] . note that any interior point of @xmath913 lies in @xmath905",
    ", so its colour in @xmath886 is its colour in @xmath891 ; since @xmath919 , such points are therefore black .",
    "now each @xmath76 is either on @xmath901 , or belongs to a grey face @xmath338 which meets @xmath901 .",
    "suppose the latter case holds for @xmath920 . to handle the remaining cases we simply recolour at most one face in the following argument , rather than two .",
    "recalling that @xmath909 does not pass within distance @xmath377 of the edges of @xmath58 , note that each @xmath338 lies entirely with the strip @xmath58 .",
    "let @xmath921 be the configuration obtained from @xmath685 by recolouring all points of @xmath922 black . as we shall show in a moment ,",
    "this is a legal configuration . assuming this for the moment ,",
    "if we restrict our attention overall to a finite region of the plane , as we may , the ratio @xmath923 of the probabilities of the individual configurations is bounded below by @xmath924 , where @xmath925 is the minimum probability of any possible state of a grey face .",
    "the key point is that recolouring a set of points within the gap @xmath36 black does not change the interfaces @xmath899 and @xmath900 ; these interfaces are determined by the full interfaces @xmath926 shown in figure  [ fig_interfaces ] , which are defined ` locally ' , and the side of @xmath901 on which the gap lies is already ` locally black ' .",
    "thus the algorithm @xmath683 examines the states of the same set of faces if run on @xmath921 or on @xmath685 . recalling that the states of @xmath927 and @xmath928 in @xmath71 are those in @xmath685",
    ", it follows that in the configuration @xmath929 there is a black path joining @xmath899 to @xmath900 , given by the union of @xmath913 and two short paths from @xmath76 to @xmath901 within @xmath930 . hence @xmath931 .",
    "let @xmath932 denote the map @xmath933 , and let @xmath934 .",
    "we have shown that @xmath935 .",
    "recalling that @xmath693 is measure preserving , it follows that @xmath936 . since our recolouring does not change the interfaces @xmath899 and @xmath900 , given some @xmath937 known to be the image of some unknown @xmath908 under @xmath888 , we can read off the interfaces @xmath899 and @xmath900 ( defined in @xmath685 ) by looking at @xmath938 .",
    "we also know the path @xmath30 from @xmath686 .",
    "this allows us to determine @xmath32 and @xmath913 as defined above , and hence @xmath927 and @xmath928 . in other words ,",
    "we know which two ( or at most two ) faces were recoloured , though not how .",
    "it follows that @xmath939 consists of a bounded number of configurations , each of whose probabilities is at most @xmath940 times that of @xmath941 .",
    "hence there is a constant @xmath20 such that @xmath942 . since @xmath943",
    ", it follows that @xmath944 .",
    "since @xmath604 is known to have probability bounded away from zero , the result follows .",
    "it remains to establish that the recolouring is permissible , i.e. , to show that if we recolour within a grey face @xmath888 ( either @xmath927 or @xmath928 above ) , the new colouring has positive probability ; this is where we use the assumption that @xmath363 is malleable ( a condition of theorem  [ th_rsw1 ] ) .",
    "now @xmath36 is bounded by interfaces running between black and white regions , as well as the sides of the strip @xmath633 ; the latter do not meet @xmath888 .",
    "it follows that @xmath945 is the union of one or more colour components ( maximal connected monochromatic subsets ) of @xmath888 .",
    "our recolouring thus recolours one or more white components within @xmath888 to black ; the definition of malleability ensures that the resulting colouring has positive probability .",
    "finally , let us comment on the technical issue we overlooked , which is that since the endpoints of @xmath30 may not differ by a lattice element , we can not exactly join up translates of @xmath30 though lattice elements to form @xmath755 .",
    "one way to handle this is to find a short ( length @xmath428 ) black path @xmath32 in @xmath686 joining appropriate points within a fundamental domain of @xmath48 , and form @xmath755 by chaining together alternate copies of @xmath30 and @xmath32 , as described in remark  [ rchain ] at the end of subsection  [ ss_z2 ] .",
    "alternatively , simply leave small ( length at most @xmath946 ) gaps between the translates of @xmath30 making up @xmath755 : when colouring @xmath765 , assign colour 0 to any point @xmath42 such that in the copy of @xmath755 starting at @xmath42 , one or more of these small gaps meets @xmath36 .",
    "it remains the case that few points receive colour 0 : the set of such points is contained in the union of @xmath947 translates of the @xmath377-neighbourhood @xmath948 of @xmath36 .",
    "since @xmath36 is made up of faces whose size is bounded below , the area of @xmath948 is at most a constant times that of @xmath36 , so the area receiving colour 0 is still @xmath949 ; choosing @xmath311 small enough , the rest of the argument is unchanged .",
    "although technically we can do without it , we now present a more convenient version of theorem  [ th_rsw1 ] giving the same conclusion under a weaker assumption .",
    "first we need a simple geometric lemma .    by the _ displacement _ of a path @xmath30 we mean the euclidean distance from its start to its endpoint . by the _ direction _ of @xmath30",
    "we mean the direction from its start to its endpoint , considered as an angle modulo @xmath63 .",
    "the _ angle _ between two paths is simply the ( unsigned ) angle between their directions , taken as a real number between @xmath446 and @xmath393 .",
    "[ lchain ] given @xmath450 there exists a constant @xmath950 such that whenever @xmath442 and @xmath593 are two paths in @xmath951 ^ 2 $ ] with displacement at least @xmath464 such that the angle between @xmath442 and @xmath593 is at least @xmath464 , then we can chain together at most @xmath20 paths each of which is a translate of @xmath442 or @xmath593 to form a path @xmath755 that lies within @xmath952\\times [ -0.5,1.5]$ ] , starts below @xmath953 , and ends above @xmath954 .",
    "let @xmath76 be the vector from the start of @xmath475 to its end , and let @xmath48 be the lattice @xmath955 .",
    "let @xmath381 be the fundamental domain of @xmath48 whose corners are the origin , @xmath916 , @xmath917 and @xmath956 .",
    "note that the area of @xmath381 is bounded below by a constant depending on @xmath464 .",
    "the idea is simply to approximate the line - segment @xmath187 joining the points @xmath957 and @xmath958 by a path @xmath959 in the graph associated to @xmath48 where two lattice points are neighbours if they differ by @xmath960 for some @xmath73 ; then replace each edge by an appropriate translate of @xmath475 .",
    "we can find such a path @xmath959 so that every point of @xmath959 is in the same domain @xmath961 as some point of @xmath187 , and @xmath959 starts and ends in the same domains as the start and end of @xmath187 ; to see this , simply apply an affine transformation mapping @xmath48 to the usual square grid , and approximate the image of @xmath187 by an appropriate path .",
    "since any two points of @xmath381 have @xmath64-coordinates that differ by at most @xmath962 and @xmath65-coordinates that differ by at most @xmath962 , the path @xmath755 obtained from @xmath959 has the required properties .",
    "[ th_rsw2 ] let @xmath363 be a malleable independent lattice colouring , and let @xmath464 , @xmath370 and @xmath371 be positive constants .",
    "then there exists a constant @xmath404 such that the following holds .",
    "suppose that @xmath392 is a large rectangle with width  @xmath548 , height  @xmath549 and any orientation , and @xmath526 is a large rectangle with the same orientation , width  @xmath963 , and height  @xmath964 .",
    "let @xmath604 be the event that @xmath526 contains two black paths such that their images under the affine transformation mapping @xmath526 to @xmath951 ^ 2 $ ] satisfy the conditions of lemma  [ lchain ] .",
    "if @xmath826 , @xmath827 , and @xmath965 , then @xmath829 for any rectangle @xmath542 with the same orientation as @xmath392 , width  @xmath548 and height  @xmath830 .",
    "the proof is the same as that of theorem  [ th_rsw1 ] , except that we construct the ` virtual ' path @xmath755 as the union of translates of our black paths @xmath442 and @xmath593 in @xmath686 given by lemma  [ lchain ] .",
    "as before , since we can only translate by elements of the lattice @xmath48 of symmetries of @xmath363 , we may need additional short paths to join up these translates .",
    "each of these additional paths lies within a fundamental domain of @xmath48 , and we may take them to be translates of appropriate short black paths @xmath966 in @xmath686 .",
    "( with extremely high probability , such paths will exist ; we only need one of the many domains to have the property that every grey face meeting it is coloured black . )    arguing as before , after conditioning on @xmath685 and @xmath686 , we find that with probability bounded away from zero our random translate of one of the @xmath475 joins @xmath899 to @xmath900 , and the rest of the proof is as before .",
    "the precise constants appearing in lemma  [ lchain ] are not important ; the key point is that we can chain together translates of our paths @xmath475 to give a path @xmath755 with the properties discussed in remark  [ rchain ] .",
    "after appropriate rescaling , these properties are that @xmath755 crosses a square from bottom to top , with some ` elbow room ' , i.e. , starting well below the bottom and ending well above the top , without coming too close to the vertical sides .",
    "our aim in this section is to show that if @xmath363 is a malleable independent lattice colouring associated to a self - dual plane hyperlattice @xmath33 , then an analogue of theorem  [ th_rswz ] holds for @xmath363 .",
    "it turns out that , due to the lack of symmetry , we can not specify in advance the orientation of the rectangles we work with .",
    "in fact , we can not even fix their aspect ratio .",
    "recall that @xmath546 and @xmath547 denote @xmath504 and @xmath506 , where @xmath392 is an @xmath548-by-@xmath549 @xmath390-aligned rectangle centred on the origin .",
    "[ lrrdef ] let @xmath967 .",
    "we say that a lattice colouring @xmath363 has the ` large rectangles ' property @xmath968 if there exists a constant @xmath404 such that for all @xmath187 and for all large enough @xmath17 ( depending on @xmath187 ) there are @xmath969 with @xmath970 and an angle @xmath390 such that @xmath971 and @xmath972 .    in symbols , this large rectangles property with parameter @xmath973",
    "may be stated as follows : @xmath974 roughly speaking , the idea is that we can find a rectangle @xmath392 so that when we extend it by a factor of @xmath973 horizontally or vertically , the probability of a black horizontal or vertical crossing , respectively , is not too small .",
    "we can take this rectangle to have any given large area , and can assume that both sides are at least any given length .",
    "however , the orientation and aspect ratio can not be specified in advance .",
    "recall that @xmath363 is non - degenerate if , within each grey face , the all - black and all - white colourings have positive probability . under this assumption",
    ", one can adapt the usual argument from harris s lemma to show that for any @xmath975 , @xmath976 , the property @xmath977 implies @xmath978 ; the argument is as for lemma  [ cextend ] . in the light of this",
    ", the following definition makes sense .",
    "[ lrdef ] a non - degenerate independent lattice colouring @xmath363 has the _ large rectangles property _ if it has the property @xmath968 for some @xmath967 , and hence for all @xmath967 .",
    "recall that @xmath363 is _ malleable _ if it is non - degenerate and satisfies certain technical extra conditions ; for the full definition see subsection  [ ss_rswh ] .",
    "our aim in this section is to prove the following result ; as we shall see in the next section , it is then easy to deduce theorems  [ th1 ] and  [ th2 ] .",
    "[ rswc ] let @xmath363 be a malleable independent lattice colouring realizing an ( approximately ) self - dual hyperlattice percolation model @xmath83",
    ". then @xmath363 has the large rectangles property .",
    "the proof of theorem  [ rswc ] will require a little preparation .",
    "first , let us restate the property slightly",
    ". given an ellipse @xmath604 with centre @xmath223 , let @xmath979 denote the ellipse @xmath980 obtained by shrinking @xmath604 by a factor of 3/2 , keeping the centre the same .",
    "let @xmath981 denote the ` annulus ' between @xmath604 and @xmath979 , and let @xmath982 denote the event that there is a closed black path in @xmath981 surrounding the central hole .",
    "[ ledef ] a lattice colouring @xmath363 has the _ large ellipses property _ if there exists a constant @xmath404 such that for all @xmath187 and for all large enough @xmath17 ( depending on @xmath187 ) there is an ellipse @xmath604 centred on the origin with area @xmath17 and with both axes having length at least @xmath187 such that @xmath983 .    it is easy to see that the large rectangles property and the large ellipses property are equivalent .    [ r_e ] a non - degenerate independent lattice colouring @xmath363 has the large rectangles property if and only if it has the large ellipses property .",
    "suppose first that @xmath363 has the large rectangles property ; in particular , it has the property @xmath984 .    consider the arrangement of overlapping rectangles shown in figure  [ fig_rinc](a ) . taking the shorter side of each rectangle to have length @xmath138 ,",
    "the arrangement is such that the longer side of each rectangle has length at most @xmath985 . also , if each rectangle has a black crossing in the long direction , then @xmath986 holds , where @xmath20 is the outer circle .",
    "let @xmath141 denote the area of @xmath20 , so @xmath141 is an absolute constant .",
    "we must show the existence of an ellipse @xmath604 with ( large enough ) area @xmath17 and both axes at least @xmath187 such that @xmath987 , for some constant @xmath370 .",
    "let @xmath988 be the constant in lemma  [ reg ] .",
    "the large rectangles property @xmath984 gives us a @xmath390 and @xmath989 with @xmath990 such that @xmath991 and @xmath992 , for some constant @xmath143 that is independent of @xmath17 .",
    "consider the image of figure  [ fig_rinc](a ) under a linear transformation mapping each 1-by-1 square to a @xmath390-aligned @xmath567-by-@xmath31 rectangle .",
    "note that the resulting ellipse @xmath604 ( the image of @xmath20 ) has both axes at least @xmath187 and has area @xmath17 . using corollary  [ c_trans_lower ] to allow for translation",
    ", each image rectangle has a black crossing in the relevant direction with probability at least some constant @xmath993 . using lemma  [ ourharris2 ] ( in the form  )",
    ", it follows that @xmath994 is bounded away from zero .    for the reverse implication",
    ", we assume the large ellipses property and deduce the property @xmath995 . as shown in figure  [ fig_rinc](b ) , one can arrange 9 circles @xmath782 of radius @xmath996 to ` cross ' a @xmath483-by-@xmath138 rectangle @xmath501 and a @xmath138-by-@xmath483 rectangle @xmath502 in such a way that if @xmath997 holds for each @xmath73 , then @xmath876 and @xmath998 hold .",
    "moreover , this remains true if each circle is translated by a small distance ( at most @xmath999 , say ) .",
    "given an ellipse @xmath604 with both axes at least @xmath1000 such that @xmath983 , one can rotate the arrangement in figure  [ fig_rinc](b ) and then scale it along the directions of the axes of @xmath604 so that each circle is mapped to a translate @xmath455 of @xmath604 , and @xmath501 and @xmath502 are mapped to @xmath390-aligned @xmath1001-by-@xmath31 and @xmath567-by-@xmath1002 rectangles @xmath1003 and @xmath854 , for some @xmath390 , @xmath567 and @xmath31 .",
    "note that @xmath567 , @xmath1004 , and @xmath1005 is an absolute constant times the area of @xmath604 .    moving each @xmath455 by a distance of at most @xmath377 ( which corresponds to translating @xmath782 through a distance of at most @xmath999 )",
    ", we may assume that @xmath1006 for some @xmath1007 .",
    "then @xmath1008 , and if all 9 upsets @xmath1009 hold , then @xmath1010 and @xmath1011 hold . using lemma  [ ourharris2 ]",
    "thus gives a constant lower bound on @xmath1012 and @xmath1013 , establishing the property @xmath995 .",
    "most of the time , we work with the large rectangles property ; the large ellipses property will be convenient to use in section  [ sec_crit ] .",
    "the equivalence is also useful in that it leads to a quick proof that the large rectangles property is affine - invariant .",
    "[ raf ] let @xmath58 be an invertible linear map from @xmath34 to @xmath34 and let @xmath363 be a non - degenerate independent lattice colouring .",
    "if @xmath363 has the large rectangles property , then so does @xmath1014 .",
    "there is a constant @xmath1015 such that if @xmath604 is an ellipse both of whose axes have length at least @xmath187 then @xmath1016 is an ellipse both of whose axes have length at least @xmath1017 .",
    "( for example , note that @xmath604 contains a circle of radius @xmath187 , and the image of this circle contains a circle of radius @xmath1017 for some @xmath1018 . )",
    "hence the large ellipses property is invariant under @xmath58 .",
    "applying lemma  [ r_e ] twice , we see that the large rectangles property is too .",
    "our next lemma shows that after a linear transformation , a self - dual hyperlattice percolation model must be related to its dual by one of a small number of linear transformations .",
    "we consider both the self - dual case ( for theorem  [ th1 ] ) and the approximately self - dual case ( for theorem  [ th2 ] ) .",
    "[ lsymclass ] let @xmath83 be an ( approximately ) self - dual hyperlattice percolation model .",
    "then there is a map @xmath1019 giving an isomorphism between @xmath83 and a hyperlattice model equivalent to @xmath1020 such that @xmath89 can be written in the form @xmath1021 , where @xmath58 is linear and @xmath1022 is bounded .",
    "furthermore , after a linear change of coordinates ( if necessary ) , we may assume that @xmath58 is either reflection in some line , or rotation through one of the angles @xmath446 , @xmath393 , or @xmath63 .",
    "suppose first that @xmath83 is self - dual . by the definition of self - duality for hyperlattices , there is a homeomorphism @xmath89 from @xmath34 to @xmath34 mapping @xmath33 to its dual , and preserving the lattice structure .",
    "more precisely , there is a linear map @xmath58 with @xmath1023 such that @xmath55 whenever @xmath57 .",
    "since @xmath1024 is continuous and doubly periodic , it is bounded , giving the first statement .    since @xmath1023 , the map @xmath58 preserves area , so @xmath1025 with @xmath1026 . from standard results ,",
    "@xmath58 is conjugate in @xmath1027 to a map @xmath1028 that is either a rotation , a shear with matrix @xmath1029 , or a stretch with matrix @xmath1030 .",
    "changing coordinates ( or applying a linear transformation to @xmath33 and its dual simultaneously ) , we may assume that @xmath1031 .",
    "now @xmath1032 maps @xmath33 into itself , and @xmath1033 where @xmath1034 is bounded .",
    "if @xmath58 is a shear with @xmath1035 or a stretch with @xmath1036 , then repeated application of @xmath1032 shows the existence of arbitrarily long edges in @xmath33 , giving a contradiction .",
    "thus @xmath58 is either a rotation or a reflection . in the former case , the fact that @xmath58 maps @xmath48 into itself guarantees that the angle of rotation @xmath390 is a multiple of either @xmath1037 or @xmath393 .",
    "replacing @xmath89 by the isomorphism @xmath1038 from @xmath83 to its dual allows us to reduce the cases @xmath1039 , @xmath1040 , to the cases @xmath408 or @xmath1041 , and the case @xmath1042 to the case @xmath1043 .",
    "the argument for the approximately self - dual case is similar , except that from the definition of approximate self - duality we may simply assume that @xmath58 is a rotation or a reflection .    for the rest of the section , in the light of lemma  [ raf ]",
    ", we assume as we may that @xmath83 and its dual are related as described in lemma  [ lsymclass ] . in the case where the map @xmath58 is a reflection ,",
    "we take it to be reflection in the @xmath64-axis , and call this the _ reflection _ case .",
    "the remaining cases are _ rotation _ cases ; we write @xmath1044 for the angle of rotation passing from @xmath33 to @xmath60 , so @xmath1045 .",
    "let @xmath1046 be the _ negative _ of the colouring @xmath363 , defined simply by interchanging black and white ( both in @xmath33 , and in the colours of the subfaces of the grey faces of @xmath33 ) .",
    "even in the self - dual case , although @xmath363 realizes @xmath83 , which is self - dual via the map @xmath1019 , we can not assume that @xmath363 is self - dual in the natural sense .",
    "for example , in the dual colouring to that shown in the centre of figure  [ fig_shading3 ] , there are two black subfaces within the hexagon .",
    "this pattern may not occur in @xmath363 .",
    "however , writing @xmath377 for the constant given by lemma  [ reg ] , since @xmath363 realizes @xmath83 , there is a natural coupling of @xmath363 and @xmath83 such that any black path @xmath30 in @xmath363 is within hausdorff distance @xmath377 of an open path in @xmath83 , and vice versa . applying this observation also to @xmath1046 , which realizes @xmath1047",
    ", it follows that we can couple @xmath363 and @xmath1046 so that for any black path @xmath30 in @xmath363 there is a black path in @xmath1046 within distance @xmath428 of @xmath1048 , and vice versa . recalling that black in @xmath1046 simply means white in @xmath363 , and using lemma  [ lsymclass ] ,",
    "this has the following consequence .",
    "here , @xmath1049 is the ` probability scaling function ' defined before lemma  [ cont ] .",
    "[ wb ] let @xmath363 be a non - degenerate independent lattice colouring realizing an ( approximately ) self - dual hyperlattice percolation model @xmath83 , and let @xmath58 be the linear map given by lemma  [ lsymclass ]",
    ". then there are constants @xmath187 and @xmath20 such that , for any angle @xmath390 and any @xmath390-aligned @xmath567-by-@xmath31 rectangle @xmath392 with @xmath567 , @xmath1004 , we have @xmath1050\\ ] ]    we write out only the self - dual case ; since we in any case allow some ` elbow room ' when passing from @xmath83 to its dual , there are no additional difficulties in the approximately self - dual case .",
    "let @xmath1051 , where @xmath1052 , which is finite by lemma  [ lsymclass ] .",
    "couple @xmath363 and @xmath1053 as above .",
    "let @xmath1054 be the colouring obtained from @xmath1055 by interchanging white and black , so @xmath1054 has the same distribution as @xmath363 .",
    "let @xmath392 be a rectangle as described , and let @xmath1056 be obtained by moving the vertical sides of @xmath392 outwards by a distance @xmath381 and the horizontal sides inwards by the same distance .",
    "suppose @xmath1056 has a black horizontal crossing in @xmath363 .",
    "then from the remarks before the lemma , there is a black path in @xmath1055 close to @xmath1048 and hence to @xmath1057 , and thus a white path in @xmath1054 close to @xmath1057 .",
    "but any such path crosses @xmath1058 .",
    "hence @xmath1059 writing @xmath210 for @xmath1060 as usual , and using lemma  [ cont ] , this gives @xmath1061 .",
    "the reverse inequality is proved similarly .    in what follows we assume throughout that our ` large ' length @xmath187 is at least @xmath385 , and is such that lemma  [ wb ] applies .",
    "note that rectangles with dimensions at least @xmath187 are ` large ' in the terminology of the previous sections .",
    "[ 2mod ] let @xmath363 be a non - degenerate independent lattice colouring realizing an ( approximately ) self - dual hyperlattice percolation model @xmath83 .",
    "for any @xmath187 there are constants @xmath1062 and @xmath1063 such that for any @xmath553 , and any @xmath390 in the rotation case or @xmath408 in the reflection case , we may find @xmath548 , @xmath1064 with @xmath555 such that @xmath1065 , @xmath1066 $ ] .",
    "in other words , both the horizontal and vertical crossing probabilities for some rectangle of the given area and orientation are bounded away from 0 and  1 .",
    "let us write @xmath1067 and @xmath1068 for the probabilities that an @xmath548-by-@xmath549 @xmath390-aligned rectangle has a white horizontal crossing or a white vertical crossing , respectively .",
    "consider first the rotation case with @xmath1069 .",
    "in this case we simply set @xmath1070 , and choose @xmath1071 .",
    "let @xmath392 be the @xmath548-by-@xmath548 @xmath390-aligned square centred on the origin .",
    "note that @xmath1058 is the same rectangle @xmath392 , but viewed as @xmath394-aligned , so @xmath1072 .",
    "hence lemma  [ wb ] gives @xmath1073 .",
    "but by lemma  [ oneway ] , we have @xmath1074 , so @xmath1075 .",
    "it follows that @xmath1076 .",
    "similarly , @xmath1077 .    for the remaining cases , for @xmath17 large enough , lemma  [ 1mod ] gives us @xmath554 with @xmath555 and @xmath1078 $ ] .",
    "this time ( noting that @xmath408 in the reflection case ) , the map @xmath58 maps our @xmath390-aligned @xmath548-by-@xmath549 rectangle into itself , and lemma  [ wb ] gives @xmath1079 . hence @xmath1080 .",
    "we are now ready to prove theorem  [ rswc ] .",
    "we assume as we may that @xmath551 . throughout",
    "we fix an arbitrary @xmath1081 , where @xmath1082 is the constant in lemma  [ 2mod ] .",
    "all constants @xmath143 or @xmath1083 below will depend only on @xmath363 , not on @xmath17 or @xmath187 .",
    "we shall show that for some @xmath390 , @xmath141 and @xmath142 with @xmath1084 we have @xmath1085 where @xmath404 does not depend on @xmath17 .",
    "this will establish that @xmath363 has the large rectangles property @xmath1086 .",
    "fix an orientation @xmath390 , with @xmath408 in the reflection case , and @xmath390 arbitrary otherwise . suppressing the dependence on @xmath390 in the notation , by lemma  [ 2mod ]",
    "there are @xmath548 , @xmath1064 with @xmath555 such that @xmath1087 where @xmath1088 is a constant depending only on @xmath363 .",
    "suppose for the moment that @xmath1089 , where @xmath370 is a positive constant not depending on @xmath17 .",
    "set @xmath1090 and @xmath1091 , and consider an @xmath1092-by-@xmath1093 rectangle @xmath392 and the @xmath1094-by-@xmath1093 rectangle @xmath526 inside it .",
    "note that @xmath1095 .",
    "also , since @xmath526 is @xmath548-by-@xmath549 , we have @xmath1096",
    ". we may thus apply theorem  [ th_rsw1 ] with @xmath548 and @xmath549 replaced by @xmath1092 and @xmath1093 , and @xmath1097 , @xmath1098 , and @xmath1099 .",
    "any black vertical crossing of @xmath526 satisfies the conditions for the event @xmath1100 considered in theorem  [ th_rsw1 ] simply because , seen with respect to the @xmath1092-by-@xmath1093 grid , @xmath526 is much taller than wide .",
    "theorem  [ th_rsw1 ] thus gives @xmath1101 , for some constant @xmath404 .",
    "but then @xmath1102 and @xmath1103 are both at least @xmath1104 , establishing with @xmath1105 and @xmath1106 .",
    "a similar argument ( using a ` rotated ' version of theorem  [ th_rsw1 ] ) shows that if @xmath1107 , then holds with @xmath1108 and @xmath1109 .",
    "thus , in what follows , it suffices to show that one of @xmath1110 and @xmath1111 is not too small .",
    "applying lemma  [ 2mod ] again we find @xmath1112 , @xmath1113 with @xmath1114 such that @xmath1115 let @xmath501 be the @xmath1112-by-@xmath1116 rectangle centred on the origin , so @xmath1117 and @xmath1118 .",
    "fix a small constant @xmath450 ; for example , @xmath1119 will do .",
    "suppose first that @xmath1120 , say . then on the @xmath548-by-@xmath549 scale , the rectangle @xmath501 is significantly taller than wide , and has area @xmath1121 .",
    "after truncating @xmath501 vertically if necessary ( after which we still have @xmath1118 ) , we may apply theorem  [ th_rsw1 ] with @xmath392 an @xmath548-by-@xmath549 rectangle , with @xmath1122 , @xmath1123 , and @xmath1124 . a black vertical crossing of @xmath501",
    "once again ensures that @xmath1100 holds , and it follows that @xmath840 for some constant @xmath404 . as noted above , we are done in this case .",
    "a similar argument applies if @xmath1125 , so we may assume that @xmath1126 .    as before ,",
    "let @xmath289 be the function given by lemma  [ ourharris2 ] applied to the product of partially ordered sets corresponding to the random partitions induced by each edge @xmath37 of @xmath33 .",
    "recalling that @xmath1127 , @xmath1128 , set @xmath1129 , where @xmath530 is the function appearing in corollary  [ c_trans_lower ] . for any rectangle @xmath392 ,",
    "let @xmath1130 denote the event @xmath1131 that @xmath392 has both horizontal and vertical black crossings .",
    "for any @xmath1112-by-@xmath1116 rectangle @xmath392 , we have @xmath504 , @xmath1132 by corollary  [ c_trans_lower ] , and thus @xmath1133 set @xmath1134 , and @xmath1135 .",
    "let us say that a rectangle @xmath392 is _ useful _ if it contains two black paths @xmath442 and @xmath593 such that , after scaling by dividing all @xmath64-coordinates by @xmath548 and all @xmath65-coordinates by @xmath549 , the paths satisfy the assumptions of lemma  [ lchain ] .",
    "in other words , for each @xmath73 , the vector @xmath76 from the start of @xmath475 to the end has ( after rescaling ) length at least @xmath464 , and the angle between @xmath916 and @xmath917 is at least @xmath464 . we write @xmath1136 for the event that @xmath392 is useful .",
    "if there is any rectangle @xmath392 with width at most @xmath963 and height at most @xmath964 for which @xmath1137 then , recalling , theorem  [ th_rsw2 ] gives @xmath840 for some @xmath404 .",
    "hence we may assume that @xmath1138 for any rectangle with these dimensions .",
    "note that @xmath1139 and @xmath1140 , so the rectangle @xmath501 defined earlier satisfies the size restriction above with room to spare .",
    "suppose that some @xmath1112-by-@xmath1116 rectangle @xmath392 is coloured in such a way that @xmath1141 holds .",
    "then @xmath392 has a black horizontal crossing @xmath442 and a black vertical crossing @xmath593 .",
    "the angle ( after scaling ) between these crossings must be very close to 0 , so it follows that either both @xmath442 and @xmath593 cross @xmath392 from near the top left to near the bottom right , or both cross from near the bottom left to near the top right .",
    "suppose the former holds .",
    "then , in addition , every black horizontal or vertical crossing stays ( after the usual scaling ) within distance @xmath1142 of the diagonal ; otherwise , such a crossing can be split into two parts ( @xmath150 and @xmath152 in the figure ) with an angle of at least @xmath464 between them , so @xmath1136 holds ; see figure  [ fig_u1u2 ] .",
    "let @xmath1143 and @xmath1144 denote the strips of width ( after rescaling as above ) @xmath1142 about the two diagonals of @xmath392 .",
    "let @xmath1145 denote the event that @xmath1146 contains both horizontal and vertical crossings of @xmath392 ; then @xmath1147 .",
    "hence , for any @xmath1112-by-@xmath1116 rectangle @xmath392 , for some @xmath73 we have @xmath1148 , using and .",
    "we say that @xmath392 is _ of type @xmath73 _",
    "if @xmath1149 , so any @xmath392 is of type 1 or type 2 .",
    "furthermore , no @xmath392 can be of both types : otherwise , using lemma  [ ourharris2 ] again , we have @xmath1150 , contradicting .",
    "at this point we consider two separate cases .",
    "_ reflection case .",
    "_ let @xmath501 and @xmath502 be two @xmath1112-by-@xmath1116 rectangles with @xmath502 obtained by translating @xmath501 vertically through a distance @xmath1151 .",
    "recalling that our orientation @xmath390 is the standard orientation @xmath408 in this case , we may choose @xmath501 and @xmath502 so that the rectangle @xmath1152 is centred at the origin ; in particular , the @xmath64-axis is an axis of symmetry of @xmath1152 .",
    "suppose first that @xmath501 and @xmath502 are of opposite types , say with @xmath1153 of type @xmath73 .",
    "then @xmath1154 , contradicting .",
    "it follows that @xmath501 and @xmath502 must be of the same type , say type @xmath138 .",
    "let @xmath604 be the event @xmath1155 , so @xmath1156 by .",
    "if @xmath604 holds , then @xmath501 contains a black horizontal crossing @xmath442 in the strip @xmath1157 , and @xmath502 contains a black horizontal crossing @xmath593 in the strip @xmath1158 .",
    "it is easy to check that if @xmath442 and @xmath593 are joined by a black path in @xmath1152 , then @xmath1159 holds .",
    "( for example , since we also have vertical crossings of @xmath501 and @xmath502 , we obtain a vertical crossing of @xmath1152 , whose direction is necessarily more than an angle @xmath464 away from that of @xmath442 or @xmath593 . ) hence , whenever @xmath604 holds , so does the event @xmath289 , that @xmath1160 contains a _ white _ horizontal crossing of @xmath1152 .",
    "thus , @xmath1161 .",
    "we now apply self - duality as in the proof of lemma  [ wb ] , recalling that now @xmath58 is reflection in the @xmath64-axis , an axis of symmetry of @xmath1152 .",
    "let @xmath1162 be the image of @xmath289 under the symmetry transformation . then @xmath1163 .",
    "also , if @xmath1162 holds then there is a black path in @xmath1152 that almost crosses @xmath1152 horizontally , and lies within or close to the mirror image of @xmath1160 . since @xmath1162 is an upset , by lemma  [ ourharris2 ] we have @xmath1164 .",
    "but whenever this event holds , @xmath1152 is clearly useful : the relevant crossings must in fact meet , but we do not even need this , simply the observation that @xmath1152 then contains two longish black paths that , after the usual rescaling , are at almost 90 degrees to each other .",
    "thus @xmath1165 , contradicting .",
    "this contradiction completes the proof in the reflection case .",
    "_ rotation case .",
    "_ in this case , lemma  [ 2mod ] applies _ regardless of the orientation @xmath390_. the idea is to observe that the argument above shows that for each @xmath390 , the @xmath390-aligned @xmath1112-by-@xmath1116 rectangle @xmath501 centred on the origin is either of type  1 or of type 2 .",
    "as we rotate , we can assume ( as we will shortly show ) that @xmath501 varies continuously .",
    "thus it should not jump from type 1 to type 2 .",
    "but after rotating by 90 degrees , we return to the same rectangle viewed with a different orientation . changing orientation in this way interchanges types 1 and 2 .    to make this precise , first note that the argument above establishes the following .",
    "let @xmath20 be the constant in lemma  [ 2mod ] , let @xmath390 be any orientation , and let @xmath1112 and @xmath1116 satisfy @xmath1166 and @xmath1112 , @xmath1113 .",
    "if @xmath392 is the @xmath390-aligned @xmath1112-by-@xmath1116 rectangle centred on the origin , and @xmath1167 , @xmath1168 $ ] , then @xmath392 is either of type 1 or of type 2 ( and not both , although we shall not use this ) . to see this , simply use the rectangle @xmath392 under consideration as @xmath501 in the argument above : so far we selected an arbitrary rectangle with the properties described by lemma  [ 2mod ] ; now we choose a specific one with the same properties , except that we have replaced @xmath20 by @xmath1169 , which makes no difference .",
    "pick an integer @xmath1170 , and let @xmath1171 .",
    "we claim that we can construct a finite sequence @xmath1172 of rectangles , all centred on the origin , where @xmath1153 is @xmath1173-aligned and satisfies the conditions above , with @xmath1174 , @xmath1175 and @xmath765 and @xmath1176 the same geometric rectangle , such that for @xmath1177 , either @xmath1153 and @xmath1178 have the same dimensions and @xmath1179 , or @xmath1153 and @xmath1178 have the same orientation , and their corresponding dimensions differ by at most one .    to establish the claim , simply start with @xmath1174 and @xmath765 of the dimensions given by lemma  [ 2mod ] .",
    "at each stage , if @xmath1153 satisfies @xmath1180 , @xmath1181 $ ] , then rotate it through an angle @xmath311 to obtain @xmath1178 .",
    "since the largest dimension of @xmath392 is at most @xmath1182 , corollary  [ c_rot ] ensures that @xmath1178 has the required properties .",
    "otherwise , by assumption we have @xmath1180 , @xmath1183 $ ] . applying lemma  [ 2mod ] ,",
    "pick a rectangle @xmath392 with the same orientation and area for which @xmath1184 , @xmath1185 $ ] .",
    "since @xmath1153 and @xmath392 have the same orientation , we may pass gradually from one to the other with @xmath1186 increasing and @xmath1187 decreasing or vice versa ; the intermediate rectangles thus all satisfy our requirements .",
    "once we reach @xmath392 , we are ready for the next rotation step .",
    "since the type of @xmath1176 is the opposite of that of @xmath765 , there is some @xmath73 such that @xmath1153 and @xmath1178 have different types ; suppose that @xmath1153 is of type @xmath138 and @xmath1178 of type 2 .",
    "then by lemma  [ ourharris2 ] we have @xmath1188 .",
    "although the dimensions of our rectangles may change radically as we rotate them , they can not do so in one step .",
    "in particular , after the rescaling above applied to @xmath1153 , the paths witnessing @xmath1189 and @xmath1190 are close to orthogonal .",
    "it follows that if @xmath1191 holds , then @xmath1153 is useful , so @xmath1192 , contradicting above .",
    "in this section we shall deduce theorems  [ th1 ] and  [ th2 ] from theorem  [ rswc ] ; this turns out to be relatively straightforward , adapting the very simple argument for bond percolation on @xmath29 described in  @xcite .",
    "first , we get one technical detail out of the way .",
    "recall that we can represent any hyperlattice percolation model @xmath83 by an independent lattice colouring @xmath363 ; our results in the previous section apply only to _ malleable _ @xmath363 . in the bulk of this section",
    "we shall prove the following variant of theorem  [ th1 ] , differing only in the additional assumption of malleability .",
    "[ th1p ] let @xmath83 be a malleable ( approximately ) self - dual hyperlattice percolation model .",
    "then for any @xmath104 the model @xmath111 percolates , and for any @xmath112 the model @xmath111 exhibits exponential decay .    before proving this result , we note that theorem  [ th1 ] follows .",
    "let @xmath83 be self - dual , and let @xmath89 be an isomorphism from @xmath33 to @xmath60 witnessing this . for this @xmath89",
    ", the self - duality condition reduces to a set of equations equating certain entries @xmath80 of @xmath99 .",
    "in particular , any entry @xmath80 where @xmath63 is a partition into singletons is equated with some @xmath1193 , where @xmath92 is a partition into one part . recall that we call entries of these two types _ bottom _ and _ top _ entries , respectively .    if @xmath104 , then by definition of our partial order , each bottom entry of @xmath99 is non - zero .",
    "hence by self - duality each top entry is non - zero .",
    "since corresponding top or bottom entries of @xmath99 and @xmath101 can not be equal , it follows that we can adjust @xmath99 slightly to find some @xmath1194 all of whose entries are strictly positive such that @xmath1195 is self - dual , with @xmath1196 .",
    "since @xmath1194 is malleable , theorem  [ th1p ] implies that @xmath111 percolates , as required .    the argument that any @xmath112 exhibits exponential decay proceeds similarly .",
    "the argument above shows that in proving theorem  [ th1 ] , we may impose the condition of malleability ( which we need in the proof ) without loss of generality , so we do not need to assume malleability in the statement of the theorem .",
    "unfortunately , there does not seem to be an obvious analogous argument in the approximately self - dual case : it is not clear how to adjust the probabilities slightly while preserving approximate self - duality .",
    "for this reason we simply impose malleability as a condition in theorem  [ th2 ] , so theorem  [ th2 ] trivially follows from theorem  [ th1p ] .    to deduce theorem  [ th1p ] from theorem  [ rswc ] , we shall use an analogue for posets of the well - known friedgut ",
    "kalai sharp - threshold result for symmetric events , theorem 2.1 of  @xcite , which is itself a consequence of a result of kahn , kalai and linial  @xcite ( see also  @xcite ) concerning the influences of coordinates in a product space . this sharp - threshold result has been applied in many contexts  it was first used to prove criticality ( for random voronoi percolation ) in  @xcite ; we shall use the same technique here ( see also  @xcite ) .",
    "let @xmath90 be a finite poset .",
    "given two probability measures @xmath1197 and @xmath1198 on @xmath90 , recall that @xmath1198 _ strictly dominates _",
    "@xmath1197 , written @xmath1199 , if @xmath1200 for every upset @xmath1201 , except the trivial upsets @xmath106 , @xmath90 .    as usual , given a ( po)set @xmath90 and a subset @xmath1202 of @xmath285 ,",
    "a coordinate @xmath73 is _ pivotal _ for @xmath1202 in a configuration @xmath1203 if changing the @xmath73th coordinate of @xmath71 can affect whether @xmath1204 .",
    "let @xmath1205 denote the set of values that , when substituted for the @xmath73th coordinate of @xmath71 , give some @xmath1206 .",
    "thus @xmath73 is pivotal for @xmath1202 in @xmath71 if and only if @xmath1207 .",
    "if @xmath1202 is an upset , then @xmath1208 is an upset .",
    "given @xmath1209 , for @xmath1210 define @xmath1211 by linear interpolation : @xmath1212 for all @xmath212 .",
    "let @xmath1213 be the minimum of @xmath1214 over all non - trivial upsets in @xmath90 , so @xmath1088 by assumption .",
    "then , for any non - trivial upset @xmath94 , we have @xmath1215 . considering partial derivatives in a product with different values for @xmath1216 in each coordinate ,",
    "one obtains an analogue of the margulis ",
    "russo formula  @xcite : if @xmath1217 is an upset , then with @xmath1218 as above , we have @xmath1219 where @xmath1220 denotes expectation with respect to the product measure @xmath1221 , and @xmath1222 is the number of pivotal coordinates for @xmath1202 in the random configuration @xmath71 .",
    "bourgain , kahn , kalai , katznelson and linial  @xcite showed that if @xmath735 is any probability space , and @xmath1202 is a subset of @xmath1223 , then then there is some coordinate @xmath73 such that the probability that @xmath73 is pivotal for @xmath1202 is at least @xmath1224 , where @xmath404 is an absolute constant , and @xmath1225 is the probability of @xmath1202 . as usual , we say that @xmath1202 is _ symmetric _ if there is a permutation group acting transitively on @xmath1226 whose induced action on @xmath1223 preserves @xmath1202 .",
    "if @xmath1202 is symmetric , each coordinate has the same probability of being pivotal , so the expected number of pivotal elements is at least @xmath1227 . using in place of the usual margulis ",
    "russo formula , one then obtains the following result ; we omit the simple calculation , noting that one may take @xmath1228 .",
    "[ sharp ] let @xmath1197 and @xmath1198 be probability measures on a poset @xmath90 with @xmath1209 .",
    "there is a constant @xmath1229 with the following property .",
    "let @xmath1230 , and let @xmath1202 be a symmetric , increasing event in a power @xmath285 of @xmath90 with @xmath1231 . if @xmath1232 then @xmath1233.@xmath397    using theorem  [ sharp ] in place of the friedgut  kalai result , it is very simple to adapt ( one of ) the simple arguments given in  @xcite to deduce theorem  [ th1p ] from theorem  [ rswc ] .    let @xmath83 be a malleable ( approximately ) self - dual hyperlattice percolation model , with @xmath48 the corresponding lattice of translational symmetries , and let @xmath104 .",
    "note that since @xmath83 is non - degenerate , so is @xmath1234 , where @xmath1235 .",
    "if some bottom entries in @xmath101 are zero , we replace @xmath101 by @xmath1236 in what follows : since @xmath1237 , it suffices to prove percolation in @xmath1234 .",
    "thus we may assume without loss of generality that @xmath111 is non - degenerate .    as usual",
    ", we wish to work with crossings of rectangles , so it is more convenient to work with independent lattice colourings .    by lemma  [ regpos ]",
    "there is a malleable independent lattice colouring @xmath1238 realizing @xmath83 . as in section  [ sec_cc ]",
    "( before lemma  [ reg ] ) , we regard the state space @xmath367 underlying the random colouring @xmath1238 as a product of one poset @xmath368 for each grey face @xmath289 of @xmath33 : in the partial order , we have @xmath369 if every subface that is black in @xmath370 is black in @xmath371 . picking a finite set @xmath1239 of faces representing the orbits of @xmath373 ( the set of grey faces ) under the action of @xmath48 , from lattice invariance",
    "we may regard @xmath367 as a countable power of the poset @xmath1240 .",
    "( as usual , the events we consider in the following arguments will be defined in terms of finite regions of the plane , and so can be viewed as events in a finite power of @xmath90 . )    from independence , the probability measure associated to @xmath1238 is a power of a probability measure @xmath1197 on @xmath90 .",
    "furthermore , since @xmath166 , we may choose another measure @xmath1198 on @xmath90 with @xmath1209 such that the corresponding independent lattice colouring @xmath1055 realizes @xmath111 .",
    "we may and shall assume that @xmath1055 is non - degenerate .",
    "let @xmath1241 be the function appearing in corollary  [ csr ] ( our version of the square - root trick ) , and set @xmath1242 let @xmath404 be the constant in the @xmath1086 property of @xmath1238 ; such a constant exists by theorem  [ rswc ] . let @xmath300 be the minimum of @xmath143 and @xmath464 , and choose @xmath319 such that @xmath1243 where @xmath1244 is defined as in theorem  [ sharp ] .",
    "let @xmath1245 , and choose @xmath1246 so that @xmath1247 , so any region of area at least @xmath1248 meets at least @xmath319 translates of @xmath381 by elements of @xmath48 .",
    "let @xmath1249 be the maximum of the quantity @xmath377 appearing in lemma  [ reg ] and @xmath383 , the diameter of @xmath381 .",
    "since @xmath1238 has the large rectangles property @xmath1086 , we can find an angle @xmath390 and @xmath1250 such that @xmath1251 and @xmath1252 .",
    "in other words , there are orthogonal vectors @xmath916 and @xmath917 ( obtained by rotating @xmath1253 and @xmath1254 through an angle @xmath390 ) with the following property : the rectangles @xmath501 with corners @xmath1255 and @xmath502 with corners @xmath1256 are such that the probability that @xmath1153 has a ` long ' ( parallel to the @xmath1257 side ) black crossing in @xmath1238 is at least @xmath143 .    by lemma  [ reg ] ,",
    "every point of @xmath34 is within distance @xmath1249 of some point of @xmath48 , so we may find @xmath1258 , @xmath1259 within distance @xmath1249 of @xmath1260 and @xmath1261 , respectively .",
    "let @xmath1262 be the parallelogram with corners @xmath446 , @xmath1263 , @xmath1264 and @xmath1265 .",
    "since @xmath916 and @xmath917 have length at least @xmath1266 , this parallelogram is obtained from a translate of @xmath501 by first ` distorting it very slightly ' , and then making it significantly shorter and thicker .",
    "it is easy to check that a translate of @xmath1262 through a suitable lattice element has the property that any ` long ' crossing of @xmath501 includes a ` long ' crossing of @xmath1262 , so , in @xmath1238 , the probability that @xmath1262 has a ` long ' black crossing is at least @xmath143 . define @xmath1267 from @xmath502 similarly . since @xmath1268 is close to @xmath1269 and the vectors @xmath76 are not too short and are orthogonal , the area of @xmath1270 is ( crudely ) at least @xmath1271 .",
    "applying a linear transformation mapping @xmath1258 to @xmath1272 and @xmath1265 to @xmath1273 , we find that in the transformed model @xmath1274 , with lattice of symmetries @xmath1275 , the probability that the rectangle @xmath1276\\times [ 0,1]$ ] has a black horizontal crossing is at least @xmath143 , as is the probability that @xmath1277\\times [ 0,8]$ ] has a black vertical crossing .",
    "note that the image @xmath1278 of our fundamental domain @xmath381 has diameter at most @xmath1279 , say , since @xmath1280 and the @xmath1268 are close to orthogonal .",
    "also , the area of @xmath1278 is @xmath1281 .",
    "let @xmath1282 be the torus obtained by taking the quotient of @xmath34 by the lattice @xmath1283 generated by @xmath1284 and @xmath1285 . since @xmath1286 , we may choose @xmath1287 translates of @xmath1278 by elements of @xmath1288 so that their images in @xmath1282 cover @xmath1282 exactly once .",
    "this allows us to define a natural equivalent of @xmath1274 on @xmath1282 ; the corresponding probability measure may be seen as @xmath1289 , where @xmath1290 .",
    "moreover , given a rectangle that does not come ` close ' to wrapping around the torus , the events that it has a horizontal black crossing in the plane or in the torus have the same probability .",
    "let @xmath604 be the event that some translate of @xmath1291\\times [ 0,1]$ ] in @xmath1282 has a black horizontal crossing .",
    "then @xmath1292 , and @xmath604 is a symmetric , increasing event in @xmath1289 in the sense of theorem  [ sharp ] .",
    "since @xmath1293 , from our choice of @xmath319 and theorem  [ sharp ] , we have @xmath1294 . as in  @xcite , let @xmath1295 be translates in @xmath1282 of the rectangle @xmath1296\\times [ 0,2]$ ] arranged so that any @xmath389-by-@xmath138 rectangle crosses some @xmath1153 horizontally .",
    "then we have @xmath1297 , so by corollary  [ csr ] and our choice of @xmath464 we have @xmath1298 for some @xmath73 , and thus for all  @xmath73 .",
    "translating back to the plane , we see that in @xmath1299 ( obtained from @xmath1055 by the linear transformation mapping @xmath1238 to @xmath1274 ) , any @xmath1300-by-@xmath483 rectangle @xmath392 with corners at points of the lattice @xmath1288 has @xmath1301 .",
    "the same argument shows that any @xmath483-by-@xmath1300 rectangle @xmath526 with lattice point corners has @xmath1302 . from here",
    "it is very easy to prove that percolation occurs , using any of several standard methods ; we shall give one example .",
    "note that if @xmath89 is a @xmath483-by-@xmath483 square then , with @xmath210 denoting the probability measure associated to @xmath1299 , we have @xmath1303 and @xmath1304 . as in  @xcite ( the third version of the proof of theorem 10 there ) , let @xmath1305 be the event that @xmath395 holds and each of the two @xmath483-by-@xmath483 ` end squares ' of @xmath392 has a black vertical crossing , and define @xmath1306 similarly .",
    "then @xmath1307 , @xmath1308 . of course",
    ", the bound @xmath1309 here can be replaced by any constant less than @xmath138 , although , as we shall see , @xmath1309 is more than good enough .    considering a square grid of @xmath1300-by-@xmath483 and @xmath483-by-@xmath1300 rectangles overlapping in @xmath483-by-@xmath483 squares as in  @xcite , and taking a bond of @xmath29 to be open if @xmath1305 holds for the corresponding rectangle , one obtains a dependent bond percolation measure on @xmath29 . given sets @xmath89 and @xmath58 of bonds of @xmath29 separated by a distance ( in the graph @xmath29 ) of at least 1 , the corresponding unions of rectangles are disjoint , and are separated in the plane by a distance of at least @xmath1310 .",
    "it follows that the states of the bonds in @xmath89 are independent of the sates of the bonds in @xmath58 , i.e. , the bond percolation measure is _ @xmath138-independent_. it is rather easy to see that any such measure in which each bond is open with high enough probability has an infinite open cluster with probability @xmath138 ; see , for example , the general domination result of liggett , schonmann and stacey @xcite .",
    "the best current bound on what ` high enough ' means is due to balister , bollobs and walters  @xcite , who showed that all bond probabilities at least @xmath1311 will do .",
    "since @xmath1307 , @xmath1312 , we see that with probability @xmath138 there is an infinite open cluster in @xmath29 . translating back",
    ", the definition of @xmath1305 ensures that we find a corresponding infinite black cluster in @xmath1299 .",
    "since @xmath1299 is simply a linear image of @xmath1055 , it follows that @xmath1055 contains an infinite black cluster with probability @xmath138 ; hence @xmath111 percolates , as required .",
    "it remains to establish exponential decay of the volume in @xmath111 for @xmath112 .",
    "but first note that with @xmath104 as above , and with the arbitrary constant @xmath1313 replaced by a suitable constant @xmath1314 , the argument in  ( * ? ? ?",
    "* section 3 ) ( again using locally - dependent percolation ) shows that the dual of the model @xmath1315 exhibits exponential decay ( of the volume ) .",
    "it follows that the dual @xmath1316 of @xmath111 exhibits exponential decay .",
    "given a self - dual model @xmath83 and @xmath112 , the model @xmath86 is self - dual ( it is isomorphic to @xmath83 ) , and @xmath1317 . applying the result above to @xmath86 and @xmath1316 , we see that the dual @xmath111 of @xmath1316 exhibits exponential decay , as required .",
    "suppose instead that @xmath83 is approximately self - dual .",
    "then by definition there is a model @xmath1318 that is isomorphic to @xmath83 , such that @xmath86 and @xmath1318 are equivalent , in the sense that they may be coupled so that for any open path in either model there is a nearby open path in the other model .",
    "recall also that we may take the isomorphism to be given by an isometry of the plane ( plus a small ` distortion ' , if needed ) .",
    "taking the colouring viewpoint , open paths are simply black paths . now the notion of equivalence is not obviously preserved under taking duals , i.e. , inverting the colouring .",
    "however , the condition for approximate self - duality is exactly that for every _ white _ path in @xmath83 ( corresponding to a black path in @xmath86 ) , there is a nearby _ black _ path in @xmath1318 , and vice versa .",
    "since @xmath83 and @xmath1318 are isomorphic , @xmath1318 also satisfies this condition , so we may couple @xmath1318 and @xmath83 so that for every white path in @xmath1318 there is a nearby black path in @xmath83 , and vice versa . in other words , approximate self - duality holds after interchanging black and white , i.e. , @xmath86 is approximately self - dual . from this point",
    "the argument for exponential decay is as in the self - dual case .",
    "in the bulk of this paper we have shown that any self - dual hyperlattice percolation model @xmath83 is ` critical ' in the sense that if @xmath104 then @xmath111 percolates , while if @xmath112 then @xmath111 exhibits exponential decay .",
    "as noted earlier , the model @xmath83 itself may or may not percolate . here",
    "we show that , except for degenerate cases , it does not .",
    "furthermore , we show that one has power - law decay of the radius , as expected .",
    "let @xmath761 be any fixed vertex of @xmath33 ; we write @xmath1319 for the event that there is an open path from @xmath761 to a vertex at distance at least @xmath380 from @xmath761 .",
    "note that since we argue directly about properties of the self - dual case , we need to impose the technical condition of malleability defined in definition  [ maldef2 ] .",
    "it seems likely that this can be weakened to non - degeneracy ; the latter condition is used throughout the proofs in the previous sections , whereas malleability is only used at one point , where the need for it could perhaps be circumvented .    by lemma  [ regpos ]",
    ", @xmath83 can be realized by a malleable independent lattice colouring @xmath363 . by theorem  [ rswc ]",
    ", @xmath363 has the large rectangles property and hence , by lemma  [ r_e ] , the large ellipses property .",
    "let @xmath89 and @xmath58 be the maps exhibiting self - duality , as described in lemma  [ lsymclass ] .",
    "let @xmath1324 , where @xmath377 is the constant in lemma  [ reg ] and @xmath1249 is the bound on @xmath1325 from lemma  [ lsymclass ] .",
    "the large ellipses property tells us that there are constants @xmath404 and @xmath552 such that for every @xmath553 there is an ellipse @xmath1326 centred on the origin with area @xmath17 and with both axes having length at least @xmath187 such that @xmath983 .",
    "let @xmath319 be an integer such that @xmath1327 .",
    "for @xmath842 let @xmath1328 be an ellipse as above with area @xmath1329 .",
    "we claim that for each @xmath73 , @xmath1330 fits inside a copy of @xmath1331 scaled by a factor @xmath26 . to see this , rotate and scale so that the ellipse @xmath1330 becomes a circle with diameter @xmath138 , and @xmath1331 has horizontal major axis with length @xmath141 and vertical minor axis with length @xmath142 .",
    "our claim is exactly that @xmath1332 .",
    "but if not , then @xmath1333 so , since @xmath1334 , we have @xmath1335 . writing @xmath981 for the annulus between an ellipse @xmath604 and the concentric ellipse @xmath979 , it is not hard to see that when @xmath1333 and @xmath1335 one can arrange @xmath319 disjoint copies of @xmath1330 to ` cross ' the annulus @xmath1336 as in figure  [ fig_ellipse ] .",
    "moreover , in the rescaled arrangement one can easily ensure that the circles are separated by a distance of at least @xmath1279 , say , and each ` crosses ' @xmath1336 even after any transformation moving points by a distance of at most @xmath1279 .",
    "since lengths with original scale @xmath1338 have transformed scale at most @xmath445 , it follows that each image @xmath1339 crosses @xmath1336 , and the @xmath1339 are separated by a distance of at least @xmath377 .",
    "but by self - duality each @xmath1339 contains a _ white _ path surrounding its centre with probability at least @xmath143 , and these events are independent .",
    "whenever one of these white paths is present , @xmath1340 can not hold .",
    "hence @xmath1341 , a contradiction .",
    "recalling from lemma  [ lsymclass ] that @xmath1342 is either the identity or reflection in the origin , we see that @xmath1343 surrounds @xmath1344 which surrounds @xmath1345 .",
    "hence the annuli @xmath1346 are disjoint . moreover , since @xmath1347 and all axes of all @xmath455 have length at least @xmath187 , the annuli @xmath1346 are separated by distances of at least @xmath377 , and so meet disjoint sets of faces of @xmath33 .",
    "now the shorter axis of @xmath455 has length at least @xmath1348 , so its longer axis has length at most @xmath1349 .",
    "it follows that for large @xmath380 , any point at distance @xmath380 from the origin is outside @xmath1350 , where @xmath1351 .",
    "there can only be a _ white _ path starting at the origin and ending at least distance @xmath380 away if none of the events @xmath1352 , @xmath1353 , holds .",
    "since these events are independent , this has probability at most @xmath1354 . passing to the dual",
    ", this proves the upper bound on @xmath1355 .",
    "the lower bound is essentially immediate , with @xmath138 as the exponent .",
    "indeed , lemma  [ oneway ] tells us that if @xmath392 is an @xmath380-by-@xmath380 square , then either @xmath1356 or @xmath1357 .",
    "suppose first that @xmath1356 .",
    "then considering one of the @xmath1358 translates of our reference vertex @xmath761 within distance @xmath428 of the left - hand side of @xmath392 , by the union bound there is a translate of @xmath761 such that the probability that there is an open path starting at @xmath761 with length at least @xmath1359 is at least @xmath1360 .",
    "it seems very probable that the general conjecture of aizenman and langlands , pouliot and saint - aubin  @xcite concerning conformal invariance of the scaling limit of critical plane percolation will hold for all non - degenerate self - dual hyperlattice percolation models .",
    "however , this is likely to be very hard to prove . this conjecture asserts , among other things , that if @xmath392 is any rectangle , @xmath1361 denotes its image under a dilation with scale - factor @xmath1362 , and @xmath571 denotes the event that @xmath392 has an open ( or here , black ) horizontal crossing , then for any fixed @xmath392 , the limit @xmath1363 exists and lies strictly between @xmath446 and @xmath138 .",
    "moreover , this limit should be given by cardy s formula  @xcite , after first applying a suitable linear transformation to the model .",
    "this conjecture has been proved by smirnov  @xcite for site percolation on the triangular lattice ; this is essentially the only case known .",
    "for many other models , such as bond percolation on the square lattice , rsw - type theorems give the much weaker result that @xmath1364 ( this applies just as well to shapes other than rectangles . ) unfortunately , theorem  [ rswc ] , while strong enough to establish criticality , lacks the uniformity needed to prove , so we leave this as a conjecture .      as far as we are aware , this conjecture is open even for the simple special case of inhomogeneous bond percolation on the square lattice , where each horizontal bond is open with probability @xmath12 and each vertical one with probability @xmath121 , with the states of all bonds independent .",
    "* acknowledgements .",
    "* we are grateful to robert ziff for bringing the results of scullard and himself to our attention : this paper started from an attempt to show that the self - duality they established in certain ( quite general ) cases does imply criticality .",
    "the last section of this paper was added in response to a question asked by marek biskup .",
    "m.  aizenman , h.  kesten and c.  m.  newman , uniqueness of the infinite cluster and related results in percolation , in _ percolation theory and ergodic theory of infinite particle systems ( minneapolis , minn . , 19841985 )",
    "_ , springer ( 1987 ) , pp .  1320 .",
    "g.  grimmett , _ percolation _ , second edition , springer , 1999 , xiv+444 pp .",
    "harris , a lower bound for the critical probability in a certain percolation process , _ proc . cam",
    "* 56 * ( 1960 ) , 1320 .",
    "h.  kesten , _ percolation theory for mathematicians _ , birkhuser , 1982 , iv+423 pp . r. langlands , p. pouliot and y.  saint - aubin , conformal invariance in two - dimensional percolation , _ bull .",
    "_ * 30 * ( 1994 ) , 161 .                  p.d .",
    "seymour and d.j.a .",
    "welsh , percolation probabilities on the square lattice , in advances in graph theory ( cambridge combinatorial conf . , trinity college , cambridge , 1977 ) .",
    "_ ann . discrete math .",
    "_ * 3 * ( 1978 ) , pp .",
    "227245 .",
    "s.  smirnov , critical percolation in the plane : conformal invariance , cardy s formula , scaling limits , _ comptes rendus de lacadmie des sciences .",
    "srie i. mathmatique _ ,",
    "* 333 * ( 2001 ) , 239244 .",
    "expanded version available at `  ~www.math.kth.se/  stas / papers ` ."
  ],
  "abstract_text": [
    "<S> recently , scullard and ziff noticed that a broad class of planar percolation models are self - dual under a simple condition that , in a parametrized version of such a model , reduces to a single equation . </S>",
    "<S> they state that the solution of the resulting equation gives the critical point . </S>",
    "<S> however , just as in the classical case of bond percolation on the square lattice , self - duality is simply the starting point : the mathematical difficulty is precisely showing that self - duality implies criticality . here </S>",
    "<S> we do so for a generalization of the models considered by scullard and ziff . in these models , the states of the bonds need not be independent ; furthermore , increasing events need not be positively correlated , so new techniques are needed in the analysis . </S>",
    "<S> the main new ingredients are a generalization of harris s lemma to products of partially ordered sets , and a new proof of a type of russo  seymour  </S>",
    "<S> welsh lemma with minimal symmetry assumptions . </S>"
  ]
}