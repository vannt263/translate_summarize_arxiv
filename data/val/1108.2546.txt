{
  "article_text": [
    "strong , coherent interactions between atoms and light are an attractive resource for storing , manipulating , and retrieving quantum information in a quantum network with atoms serving as nodes for quantum processing and storage and with photons acting as a long - distance carrier for communication of quantum information  @xcite . one realization of a quantum node is an optical cavity , where light - matter interactions are enhanced by confining optical fields to small mode volumes . in the canonical implementation , a fabry - perot resonator with intracavity trapped atoms enables a panoply of cavity quantum electrodynamics ( cqed ) phenomena using single photons and single atoms , and thereby , validates many aspects of a cqed quantum node  @xcite .    despite these achievements ,",
    "high - quality fabry - perot mirror cavities typically require significant care to construct and complex experimental instrumentation to stabilize .",
    "these practical issues have begun to be addressed by atom chips  @xcite , in which atoms are manipulated in integrated on - chip microcavity structures offering a scalable interface between light and matter  @xcite .",
    "owing to their high quality factors , low mode volumes , and efficient coupling to tapered optical fibers  @xcite , microtoroidal resonators are a promising example of microcavities well - suited for on - chip cqed with single atoms and single photons  @xcite .",
    "strong coupling  @xcite and non - classical regulation of optical fields  @xcite have been demonstrated with atoms and the whispering - gallery modes of a silica microtoroidal resonator .    in our experiments with microtoroids ,",
    "cs atoms are released from an optical trap and fall near a silica toroid , undergoing coherent interactions with cavity modes as each atom individually transits through the evanescent field of the resonator . in the most recent work of  @xcite , atom transits",
    "are triggered in real - time to enable measurement of the rabi - split spectrum of a strongly - coupled cqed system .",
    "whereas a single atom is sufficient to modify the cavity dynamics , falling atoms are coupled to the cavity for only a few microseconds .",
    "atom dropping experiments necessarily involve a large ensemble of individual atomic trajectories and represent , consequently , a far more complex measurement result .",
    "interactions between a neutral atom and a dielectric surface modify the radiative environment of the atom resulting in an enhanced decay rate  @xcite and casimir - polder ( cp ) forces  @xcite .",
    "these _ perturbative _ radiative surface interactions are usually insignificant in cqed experiments with fabry - perot resonators where atoms are far from mirror surfaces , but in microcavity cqed , atoms are localized in evanescent fields with scale lengths @xmath0 nm near a dielectric surface .",
    "the experimental conditions for microtoroidal cqed with falling atoms in  @xcite necessarily involve significant cp forces and level shifts while simultaneously addressing strong coupling to optical cavity modes .",
    "theoretical analysis of this experiment requires addressing both the strong atom - cavity interactions and atom interactions with the dielectric surface of the microtoroid . as reported in  @xcite ,",
    "spectral and temporal measurements offer signatures of both strong coupling to the cavity mode and the significant influence of surface interactions on atomic motion . the role of these effects",
    "is quantified with detailed simulation of the trajectories of falling atoms detected in the real - time at low photon numbers .    in this article",
    ", we discuss in detail the approach used to simulate atomic motion near the surface of an axisymmetric dielectric resonator under the influence of strong coherent interactions with cavity modes .",
    "the experimental detection method of  @xcite is implemented stochastically in a semiclassical simulation of atom trajectories .",
    "these simulations provide a perspective on the atomic motion of atom transits recorded in our microtoroid experiments , while offering additional insights into the loading of optical evanescent field traps . in section  [ sec : theory ] , we outline the semiclassical model of a two - level atom coupled to the whispering gallery modes of a microtoroidal resonator . in section",
    "[ sec : opticalforce ] , we review the optical dipole forces which are a critical factor influencing atomic motion in an optical cavity .",
    "our calculations of modified emission rates and casimir - polder surface interactions are detailed in section  [ sec : surface ] .",
    "section  [ sec : exp ] describes the implementation of our model for simulating recent atom - toroid experiments .",
    "finally , section  [ sec : trap ] extends our simulation to evanescent field traps around a microtoroid .",
    "we approach the motion of atoms moving under the influence of surface interactions and coherent cavity dynamics with a semiclassical method to efficiently simulate a large number of atom trajectories . for surface interactions ,",
    "dispersion forces are calculated _ perturbatively _ using the linear response functions of sio@xmath1 and a multi - level atom . for nearly - resonant",
    "_ non - perturbative _ coherent interactions between atom and cavity , the atomic internal state and the cavity field are treated quantum mechanically within the two - level and rotating - wave approximations .",
    "simulations of atomic motion follow the semiclassical method detailed in  @xcite",
    ". mechanical effects of light are incorporated classically as a force @xmath2 on a point particle atom at location @xmath3 .",
    "trajectories @xmath4 are calculated with a langevin equation approach to incorporate momentum diffusion from fluctuations . at each simulation time",
    "step @xmath5 , the atomic velocity is calculated as : @xmath6 where @xmath7 is the velocity at the @xmath8 time step , @xmath9 is the atomic mass , and @xmath10 is the simulation time step @xmath11 .",
    "the @xmath12 are normally distributed with zero mean and standard deviation of 1 .",
    "given the force @xmath13 and diffusion tensor @xmath14 as discussed in section  [ sec : opticalforce ] , the atom trajectory @xmath4 and cavity transmission and reflection coefficients , @xmath15 and @xmath16 are calculated .",
    "a single atom strongly coupled to the cavity mode has a large effect on cavity fields and optical forces , requiring simultaneous solutions of atomic motion and cqed dynamics .",
    "full quantization of atomic motion leads to an unwieldy hilbert space not conducive to efficient simulation .",
    "in contrast , semiclassical methods are well - suited for simulating atomic motion in experiments with falling atoms near resonators .",
    "the ratio of the recoil energy to the linewidth of the cesium @xmath17 transition is less than @xmath18 .",
    "further , the recoil velocity of @xmath19 mm / s is much less than the typical velocity of falling atoms of order @xmath20 mm / s so that each spontaneous emission event represents a small momentum kick .",
    "cavity fields and internal atomic states respond quickly to environment changes , allowing calculation of optical forces and momentum diffusion in a constant - velocity limit at time @xmath21 and energy shifts from surface interactions as if atom the atom were stationary .",
    "the remainder of this section discusses the quantum mechanical equations of motion for the atom and cavity fields in the low - probe intensity limit , to be followed later by contributions to the force @xmath13 used in  .",
    "an idealized microtoroid has axial symmetry , so we work in a standard cylindrical coordinate system @xmath22 .",
    "the toroid is modeled as a circle of diameter @xmath23 with dielectric constant @xmath24 revolved around the @xmath25-axis to make a torus of major diameter @xmath26 ( fig .",
    "[ fig - modes](a ) ) .",
    "the toroid is therefore defined by its minor diameter @xmath23 and its principal diameter @xmath27 .",
    "the fabrication and characterization of high - quality microtoroids are described in detail elsewhere  @xcite .",
    "the axisymmetric cavity modes of interest are whispering - gallery modes ( wgm ) , which lie near the edge of the resonator surface and circulate in either a clockwise or counter - clockwise direction .",
    "these modes are characterized by an azimuthal mode number @xmath28 , whose magnitude gives the periodicity around the toroid and whose sign indicates the direction of propagation .",
    "the wgms for @xmath29 are degenerate in frequency but travel around the toroid in opposite directions .",
    "the mode electric fields for the wgm traveling waves are written as @xmath30 , where @xmath31 is the mode function in the @xmath32 cross - section normalized by the maximum electric field @xmath33 . in general , backscattering couples these two modes so that a more useful eigenbasis for the system consists of the normal , standing wave modes characterized by a phase and the periodicity @xmath34 .",
    "this backscattering coupling @xmath35 is assumed to be real , with the phase absorbed into the definition of the origin of the coordinate @xmath36 .",
    "in addition , the mode s field decays at a rate @xmath37 through radiation , scattering , and absorption . in our simulations ,",
    "a cavity mode is fully described by its spatial mode function @xmath38 , its azimuthal mode number @xmath28 , its loss rate @xmath37 , and the coupling @xmath35 to the counter - propagating mode with mode number @xmath39 .",
    "we model the microtoroid modes using a commercial finite - element software package ( comsol ) to solve numerically for the vector mode functions @xmath40 for modes of a given @xmath28  @xcite .",
    "mode volumes are calculated from , @xmath41 in this notation  @xcite , the coupling of a circularly polarized optical field to an atomic dipole located in the evanescent field of the cavity is calculated as : @xmath42 where @xmath43 is the dipole operator and @xmath44 is the vacuum transition frequency of the two - level atom with free - space wavelength @xmath45 .",
    "wgms are predominantly linearly polarized , and so we average over the dipole matrix elements to obtain an effective traveling wave coupling @xmath46 which is approximately @xmath47 of the value for circularly polarized light  ( see supplementary information of  @xcite . travelling wave modes of an axisymmetric resonator are not strictly transverse . for the toroid geometries considered here , with @xmath48 ,",
    "the azimuthal component is small and we assume that the optical field is linear outside of the toroid .",
    "since the cavity losses are dominated by absorption and defect scattering rather than the radiative lifetime set by the toroid geometry  @xcite , we let @xmath37 and @xmath35 be experimental parameters .",
    "[ fig - modes ] shows the lowest - order mode with @xmath49 for a toroid with @xmath50 @xmath51 m .",
    "the index @xmath28 is chosen so that the cavity frequency @xmath52 is near the @xmath17 transition of cs with @xmath53 thz .    the local polarization of modes varies throughout the interior and exterior of the toroid .",
    "approximate solutions for constant polarization suggest classifications as quasi - transverse modes , labeled transverse electric ( te ) and transverse magnetic ( tm ) modes , although actual solutions are not transverse .",
    "a reasonable analytic approximation for the lowest - order mode function with mode number @xmath28 outside of the toroid is that of a gaussian wrapped around the toroid s surface that decays exponentially with distance scale set by the free space wavevector @xmath54 , @xmath55 where @xmath56 is the distance to the toroid surface , @xmath57 is the angle around the toroid cross - section ( @xmath58 at @xmath59 ) , and @xmath60 is a characteristic mode width ( see fig .",
    "higher order angular modes are characterized by additional nodes along the coordinate @xmath61 .",
    "( a ) a scanning electron microscope image of a microtoroid with definitions of the relevant parameters discussed in the text .",
    "( b ) the lowest order mode function @xmath62 of a toroid mode with @xmath63 @xmath51 m and @xmath64 and @xmath65 mn . ]",
    "we consider a quantum model of a two - level atom at position @xmath4 coupled to an axisymmetric resonator shown schematically in fig .",
    "[ fig - schematic ] .",
    "the terminology used here follows the supplemental material of  @xcite ,  @xcite , and  @xcite , but the general formalism can be found in additional sources ( see @xcite , for example ) . as described in section  [ subsec : modes ] , an axisymmetric resonator supports two degenerate counter - propagating whispering - gallery modes at resonance frequency @xmath52 to which we associate the annihilation ( creation ) operators @xmath66 and @xmath67 ( @xmath68 and @xmath69 ) .",
    "each traveling - wave mode has an intrinsic loss rate , @xmath37 ; the modes are coupled via scattering at rate @xmath35 .",
    "external optical access to the cavity is provided by a tapered fiber carrying input fields @xmath70 at probe frequency @xmath71 .",
    "fiber fields couple to the cavity modes with an external coupling rate @xmath72 .",
    "the output fields of the fiber taper in each direction are the coherent sum of the input field and the leaking cavity field , @xmath73  @xcite .",
    "we specialize to the situation of single - sided excitation , where @xmath74 . the input field @xmath75 drives the @xmath66 mode with strength @xmath76 so that the incident photon flux is @xmath77 .",
    "experimentally accessible quantities are the transmitted and reflected photon fluxes , @xmath78 and @xmath79 , respectively . in experiments ,",
    "data is typically presented as normalized transmission and reflection coefficients defined as @xmath80 and @xmath81 . in the absence of an atom , the functions @xmath82 and @xmath83 for the bare cavity depend on the detuning @xmath84 and the cavity rates @xmath35 , @xmath37 , and @xmath72 . at critical coupling ,",
    "@xmath85 , the bare cavity @xmath86 when @xmath87  @xcite .     (",
    "a ) schematic of the atom - toroid system .",
    "coherent optical fields in the tapered fiber couple into whispering - gallery cavity modes of an axisymmetric resonator .",
    "these fields can couple to an atomic transition with rate @xmath88 , scatter to the counter - propagating mode ( @xmath35 ) , escape to the environment ( @xmath37 ) , or couple in / out of the fiber ( @xmath72 ) .",
    "the atom is described as a two - level system with transition frequency @xmath89 and spontaneous emission rate @xmath90 .",
    "( b ) imaginary part of the eigenvalues @xmath91 of the linearized systems as a function of detuning @xmath92 for a cs atom at @xmath93 and @xmath94 mhz critically coupled to a cavity with parameters @xmath95 mhz ( eqs .  ) . ]    the cavity modes @xmath96 both couple to a single two - level atom with transition frequency @xmath89 at location @xmath3 . in the context of cqed",
    ", the atomic system is described by a single transition with frequency @xmath89 with the associated raising and lowering operators @xmath97 and @xmath98 and an excited state field decay rate @xmath90 .",
    "the atomic frequency @xmath99 may be shifted from the free - space value @xmath100 by frequency @xmath101 due to interactions with the dielectric surface .",
    "the coupling of the traveling - wave modes @xmath102 to the atomic dipole is described by the single - photon coupling rate @xmath103 , where @xmath104 is the cavity mode function and @xmath105 .",
    "a discussion of @xmath104 for the modes of a microtoroid appears in section  [ subsec : modes ] . for an atom in motion , @xmath99 , @xmath106 , and @xmath107",
    "are spatially - dependent quantities that depend on the atomic position @xmath4 .    to study the atom - cavity dynamics , we write the standard jaynes - cummings - style cqed hamiltonian for coupled field modes  @xcite : @xmath108 following the rotating - wave approximation",
    ", we write the hamiltonian in a frame rotating at @xmath71  @xcite : @xmath109 where @xmath110 and @xmath84 .",
    "dissipation from coupling to external modes is treated using the master equation for the density operator of the system @xmath111 : @xmath112+\\kappa\\left(2a\\rho a^\\dagger - a^\\dagger a\\rho - \\rho a^\\dagger a\\right ) + \\kappa \\left ( 2b\\rho b^\\dagger - b^\\dagger b \\rho - \\rho b^\\dagger b\\right)\\nonumber \\\\ & + \\gamma\\left(2\\sigma^-\\rho\\sigma^+ - \\sigma^+\\sigma^-\\rho - \\rho\\sigma^+\\sigma^-\\right)\\end{aligned}\\ ] ] here , @xmath113 is the total field decay rate of each cavity mode , and @xmath114 is the atomic dipole spontaneous emission rate , which is orientation dependent near a dielectric surface ( section  [ sec : spontem ] ) .    the hamiltonian   can be rewritten in a standing wave basis using normal modes @xmath115 and @xmath116 , @xmath117 where @xmath118 , @xmath119 , and @xmath120 . in the absence of atomic coupling ( @xmath121 ) , these normal modes are eigenstates of  . with @xmath122 ,",
    "the eigenstates of the hamiltonian are dressed states of atom - cavity excitations . with @xmath123 and @xmath122 ,",
    "the atom defines a natural basis in which it couples to only a single standing wave mode . for the modes @xmath124 defined above",
    ", coupling may occur predominantly , or even exclusively , to one of the two normal modes depending the azimuthal coordinate @xmath125 .",
    "for such @xmath125 , the system can be interpreted as an atom coupled to one normal mode in a traditional jaynes - cummings model with dressed - state splitting given by the single - photon rabi frequency @xmath126 , along with a second complementary cavity mode uncoupled to the atom .",
    "approximately for @xmath127 , this interpretation is consistent for any arbitrary atomic coordinate @xmath125 . for @xmath128 and comparable to @xmath37 with a fixed phase convention ( such as im@xmath129 used here ) , this decomposition is not possible for arbitrary atomic coordinate @xmath125 ; the atom in general couples to both normal modes as a function of @xmath36  @xcite .",
    "the master equation   can be numerically solved using a truncated number state basis for the cavity modes .",
    "alternatively , the system is linearized by treating the atom operators @xmath130 as approximate bosonic harmonic oscillator operators with @xmath131 \\approx 1 $ ] . for a sufficiently weak probe field ,",
    "the atomic excited state population is small enough that the oscillator has negligible population above the first excited level and the harmonic approximation is quite good . as part of this linearization",
    ", we factor expectation values of normally - ordered operator products into products of operator expectation values  @xcite .",
    "reducing operators to complex numbers suppresses coherence , but numerical calculations confirm that this approximation is accurate when calculating cavity output fields and classical forces for the weak driving power levels considered here .",
    "in particular , experiments typically utilize a photon flux @xmath132 cts/@xmath51s corresponding to an average cavity photon population of @xmath133 . at these photon numbers ,",
    "cavity expectation values effectively factorize such that @xmath134 for the semiclassical treatment used here  @xcite .",
    "we use this approximation to write @xmath135 , implying that we only need the complex number @xmath136 and its conjugate to calculate the cavity transmission at these photon numbers .",
    "this approximation is not sufficient for calculation of the @xmath137 correlation function where the nonlinearities must be included  @xcite .",
    "the relevant equations of motion for the field amplitudes of the linearized master equation are , @xmath138    time and spectral dependence of this system of equations are governed by its eigenvalues @xmath91 .",
    "the imaginary part of the eigenvalues as a function of detuning @xmath139 are illustrated in fig .",
    "[ fig - schematic]b .",
    "for large @xmath140 , the three eigenvalues include one atom - like eigenvalue and two cavity - like eigenvalues separated by the mode splitting @xmath35 . for intermediate @xmath141",
    ", there is an anti - crossing of two dressed - state eigenvalues @xmath142 , while the third ( cavity - like ) @xmath143 is uncoupled to the atom .    for a slowly - moving atom ,",
    "the mode fields remain approximately in steady state as the parameters evolve with the atom trajectory @xmath4 .",
    "analytic steady - state solutions to   for @xmath144 and @xmath145 are :    @xmath146}{\\left[{i } h",
    "( \\gamma + { i } \\delta_{\\rm ap})+(g^*_{\\rm tw})^2 \\right ] \\left[{i } h ( \\gamma+{i}\\delta_{\\rm ap})+g_{\\rm tw}^2\\right]-\\left[(\\kappa+{i}\\delta_{\\rm cp})(\\gamma+{i}\\delta_{\\rm ap})+|g_{\\rm tw}|^2\\right]^2 } \\label{eq : linsolsa } \\\\",
    "\\hspace{-3.0cm}\\langle b \\rangle_{\\rm ss } & =   - \\frac{{i } h",
    "\\left(\\gamma+{i}\\delta_{\\rm ap}\\right)+g^2_{\\rm tw}}{(\\kappa+{i}\\delta_{\\rm cp})(\\gamma+{i}\\delta_{\\rm ap})+|g_{\\rm tw}|^2 } \\langle a \\rangle_{\\rm ss } \\label{eq : linsolsb } \\\\",
    "\\hspace{-3.0cm}\\langle \\sigma^- \\rangle_{\\rm ss } & =   -i \\frac{g_{\\rm tw } \\langle a\\rangle_{\\rm ss } + g^*_{\\rm tw } \\langle b\\rangle_{\\rm ss } } { \\gamma+i \\delta_{\\rm ap}}. \\label{eq : linsolss}\\end{aligned}\\ ] ]",
    "neutral atoms experience forces from the interaction of the atomic dipole moment with the radiation field .",
    "these optical dipole forces have a quantum mechanical interpretation as coherent photon scattering  @xcite . for a light field near resonance with the atomic dipole transition",
    ", these optical forces can be quite strong , even at the single photon level ; cavity - enhanced dipole forces  @xcite have been exploited to trap  @xcite and localize  @xcite a single atom with the force generated by a single strongly - coupled photon . in this section , we discuss how the optical forces , their first - order velocity dependence , and their fluctuations are included in our semiclassical simulation .      in a quantum mechanical treatment of light - matter interactions",
    "@xcite , the eigenstates of the system are dressed states of atom and optical field . the quantum mechanical optical force on the atom at location @xmath3 can be found from the commutator of the atom momentum @xmath147 with the interaction hamiltonian @xmath148 consisting of the last two terms from the hamiltonian  : @xmath149   = -   \\hbar \\nabla g^*_{\\rm tw}({\\vec{r } } ) \\left(a^\\dagger \\sigma^- + \\sigma^+ b\\right ) - \\hbar \\nabla g_{\\rm tw}({\\vec{r } } ) \\left ( \\sigma^+ a + b^\\dagger \\sigma^-\\right)\\ ] ] the gradient from the position space representation of the momentum operator @xmath147 only acts on @xmath107 and not on the field operators  @xcite .",
    "the steady - state expectation values of   give the dipole force on the atom in the semiclassical approximation : @xmath150 as described in section  [ sec : theory ] , the steady - state operator expressions are simplified by reducing expectation values of operator products to products of linearized steady - state operator expectation values . ignoring fiber and spontaneous emission losses ,",
    "an effective conservative dipole potential @xmath151 can be defined by integration of  .",
    "non - zero velocity effects on the force   are found by including a first - order velocity correction in the steady state expectation values  @xcite .",
    "consider a vector of operators @xmath152 whose expectation values obey a linearized equation system such as  . assuming a small velocity , we expand the operator expectation values @xmath153 as : @xmath154 where the subscripts denote the order of the velocity @xmath155 in each term .",
    "if an atom is moving through these fields , then the cavity parameters depend in general on atomic position @xmath3 .",
    "as @xmath3 changes in time , the fields must evolve in response .",
    "consequently , the time derivative of the expectation value evolves not only from explicit time dependence , but from atomic motion as well .",
    "@xmath156 setting the explicit time derivatives in   to zero , the perturbative expansion of the time derivative can be equated to the original linearized equation system .",
    "collecting terms of each order in velocity gives an equation for the first - order term @xmath157 in terms of the zero - velocity steady - state solution @xmath158 .",
    "this procedure requires the spatial derivative of the zero - order steady - state solutions , where spatial dependence enters through the atomic transition frequency @xmath99 , the spontaneous emission rate @xmath106 , and the atom - cavity coupling @xmath159 .",
    "only terms linear in velocity are kept in the operator products of the force @xmath2 in  .    in practice ,",
    "first - order velocity corrections are small in our simulation .",
    "for example , doppler shifts arising from spatial derivatives of the cavity modes are on the order of @xmath160 , where @xmath161 is the mode wavevector . for typical azimuthal velocities of less than 0.1 m",
    "/ s , the doppler shift is less than 1 mhz . the effect becomes more significant as atoms accelerate to high velocities near the surface , but atomic level shifts from surface interactions are more significant in this regime than the doppler shifts .",
    "quantum fluctuations of optical forces are treated by adding a stochastic momentum diffusion contribution to the atomic velocity in the langevin equations of motion .",
    "we calculate the diffusion tensor components used in  , @xmath162 , using general expressions for diffusion in an atom - cavity system generalized for the two - mode cavity of a toroid  @xcite : @xmath163 for @xmath164 , where @xmath90 is the atomic field spontaneous decay rate .",
    "the first term represents fluctuations from spontaneous emission , the second term describes a fluctuating atomic dipole coupled to a cavity field , and the third represents a fluctuating cavity field coupled to an atomic dipole .   is approximated using steady - state fields calculated from the linearized solutions to the master equation  .",
    "although included in the trajectory model , momentum diffusion does not significantly alter averages over ensembles of trajectories at the weak excitation levels and low atomic velocities used in the relevant experiments .",
    "in the vicinity of a material surface , the mode structure of the full electromagnetic field is modified due to the dielectric properties of nearby objects .",
    "these off - resonant radiative interactions modify the dipole decay rate of atomic states and shift electronic energy levels .",
    "this surface interaction varies spatially as the relative atom - surface configuration changes .",
    "the surface phenomena are dispersive and depend on the multi - level description of the atom s electronic structure ; they are calculated using traditional perturbation theory with the full electromagnetic field without focusing on a few select modes enhanced by a cavity in cqed .",
    "when a classical oscillating dipole is placed near a surface , its radiation pattern is modified by the time - lagged reflected field from the dielectric surface .",
    "the spontaneous emission rate oscillates with distance @xmath165 from the surface , which can be interpreted as interference between the radiation field of the dipole and its reflection .",
    "the variation of the emission rate depends on whether the dipole vector is parallel or perpendicular to the surface , as intuitively expected from the asymmetry of image dipole orientations of dipoles aligned parallel and perpendicular to the surface normal . for either orientation",
    ", the spontaneous emission rate features a marked increase within a wavelength of the surface due to surface evanescent modes that become available for decay for @xmath166 .",
    "we calculate the surface - modified dipole decay rates @xmath167 and @xmath168 for a cesium atom near an sio@xmath1 surface following the methods of refs .",
    "@xcite ( see fig .  [ fig - gammadistance ] ) .",
    "this calculation involves an integration of surface reflection coefficients over possible wavevectors of radiated light .",
    "the integrand depends on the dielectric function of sio@xmath1 evaluated at the frequency @xmath89 of the atomic transition .",
    "the orientations refer to the alignment of a classical dipole relative to the surface plane .     for a dipole oriented parallel @xmath169 and perpendicular @xmath170 to the surface normal as a function of distance @xmath165 from a semi - infinite region of sio@xmath1 .",
    "the decay rate is in units of the vacuum decay rate @xmath171 and the wavelength of the transition is @xmath65 nm . ]      radiative interactions with a surface are important components of motion for neutral atoms within a few hundred nm of a surface , with the potential for manipulating atomic motion through attractive  @xcite or repulsive forces  @xcite . depending on the theoretical framework ,",
    "these forces are naturally thought of as radiative self - interactions between two polarizable objects , fluctuations of virtual electromagnetic excitations , or as a manifestation of vacuum energy of the electromagnetic field .",
    "these surface interactions , represented by a conservative potential @xmath172 , are sensitive to the frequency dispersion of the electromagnetic response properties of the atoms and surfaces .    for an atom located a short distance @xmath173 from a dielectric , the fluctuating dipole of the atom interacts with its own surface image dipole in the well - known nonretarded van der waals interaction . using only classical electrodynamics with a fluctuating dipole , the surface interaction potential is found to take the lennard - jones ( lj ) form @xmath174 , where @xmath175 is a constant that depends on the atomic polarizability and dielectric permittivity of the surface  @xcite . at larger separations , virtual photons exchanged between atoms and surfaces",
    "can not travel the distance in time @xmath176 due to the finite speed of light .",
    "consequently , the interaction potential is reduced , as first calculated in the 1948 paper by casimir and polder @xcite .",
    "the retarded surface potential takes the form @xmath177 for a constant @xmath178 , where @xmath178 depends on both @xmath179 and @xmath180 as this is fundamentally both a relativistic and quantum phenomenon .",
    "the full theory of surface forces for real materials with dispersive dielectric functions came with the work of lifshitz  @xcite .",
    "this framework reduces to both the above situations for the proper limits , and , importantly , it accounts for finite temperatures , predicting a @xmath181 potential caused by thermal photons dominant at large distances for @xmath182  @xcite . in our discussion",
    ", we refer to these generalized dispersion forces as _ casimir - polder _ ( cp ) forces , whereas @xmath183 , @xmath184 , and @xmath185 refer to the appropriate distance limits .    in microcavity cqed ,",
    "evanescent field distance scales are set by the scale length of the evanescent field , @xmath186 nm ( for the cs @xmath187 line ) .",
    "the relevant distances ( @xmath188 nm ) span both the lj and retarded regimes , but are much shorter than the thermal regime ( @xmath189 m ) . in the transition region , the limiting power laws do not fully describe @xmath172 over the relevant range of @xmath165 . in our modeling , we utilize a calculation of @xmath172 with the lifshitz approach .",
    "the lennard - jones , retarded , and thermal limits arise naturally from the lifshitz formalism  @xcite .",
    "the potential @xmath172 enters our simulation in two ways .",
    "first , the transition frequency @xmath89 of the two - level atomic system shifts away from the vacuum frequency by @xmath190 , where @xmath191 and @xmath192 are the surface potentials for the ground and excited states , respectively . since the atom transitions between the ground and excited states during its passage through the mode , the average net force used in calculations is found by weighting each contribution by the steady - state atomic state populations , @xmath193 .",
    "we calculate @xmath194 and @xmath195 for a cesium atom near a glass sio@xmath1 surface using the lifshitz approach .",
    "this calculation depends on the dispersion properties of the response functions of materials , in this case the polarizability of the cs ground state @xmath196 and the complex dielectric function @xmath197 of the silica surface .",
    "modeling of these functions is discussed in  [ app : response ] . in particular",
    ", these response functions must be evaluated on the imaginary frequency axis @xmath198 , as shown in figure  [ fig - response ] .",
    "dispersive response functions for sio@xmath1 and cesium atoms .",
    "( a ) the dielectric function @xmath199 for sio@xmath1 evaluated for frequency @xmath200 along the imaginary axis .",
    "( b ) total atomic polarizability @xmath201 for sio@xmath1 evaluated for frequency @xmath200 along the imaginary axis for the @xmath202 ground state ( red ) and the @xmath203 excited state calculated as described in  [ app : response ] . ]    following the method of  @xcite , curvature of the toroid surface is implemented by treating the toroid as a cylinder with radius of curvature @xmath204 .",
    "the major axis curvature is neglected because for all relevant distances @xmath205 .",
    "the resulting formula can be interpreted as a sum over discrete matsubara frequencies @xmath206 with an integration over transverse wave vectors , which we quote without derivation :  @xcite @xmath207 \\nonumber \\\\",
    "\\hspace{-1cm}&\\left\\ { 2 r_{\\parallel}(i \\xi_n , k_{\\perp } ) + \\frac{\\xi_n^2}{q_n^2 c^2 } \\left[r_{\\perp}(i \\xi_n , k_{\\perp } ) - r_{\\parallel}(i \\xi_n , k_{\\perp } ) \\right ] \\right\\}\\end{aligned}\\ ] ] here , @xmath208 is the atomic polarizability and @xmath209 are the reflection coefficients of the dielectric material evaluated for imaginary frequency @xmath210 .",
    "the primed summation implies a factor of @xmath211 for the @xmath212 term .",
    "the reflection coefficients for the two orthogonal light polarizations are : @xmath213 where @xmath214 and @xmath215 is the complex dielectric function evaluated for imaginary frequencies @xmath216 .",
    "depending on the author , @xmath217 ( @xmath218 ) is sometimes referred to as @xmath219 ( @xmath220 ) .",
    "@xmath194 is calculated by numerical evaluation of  .",
    "@xmath195 is also calculated using  , but with an additional contribution accounting for real photon exchange from the excited state with the surface , which is proportional to @xmath221 $ ] in the lj limit  @xcite .",
    "the atom - surface potential @xmath194 for the ground state of cesium near a sio@xmath1 surface is shown in fig .",
    "[ fig - cp ] , including calculations for both a planar and a cylindrical surface . without the cylindrical correction ,",
    "the potential approaches the lj , retarded , and thermal limits at appropriate distance scales .",
    "for the planar dielectric , our calculation yields @xmath222 hz @xmath51m@xmath223 and @xmath224 hz @xmath51m@xmath225 for the lj and retarded limits .",
    "note that the transition region between lj and retarded regimes occurs around @xmath226 nm , the relevant distance scale for the experiments we are modeling . for @xmath227 , the perturbative method accounting for the curvature is no longer accurate  @xcite , but at these distances , the surface forces are insignificant to atomic motion due to their steep power law fall - off .",
    "the excited state potential @xmath195 has a similar form to @xmath194 .",
    "atom - surface potentials @xmath194 ( red ) and @xmath195 ( blue ) for a cesium atom at distance @xmath165 from a sio@xmath1 surface .",
    "the solid lines are for a planar surface whereas the dashed lines are for a curved surface with radius of curvature @xmath228 @xmath51 m .",
    "the limiting regimes for @xmath194 with a planar surface are shown as dotted lines , each calculated from analytic expressions not using the lifshitz formalism .",
    "the cylindrical surface correction weakens the potential , which is noticeable in the retarded and thermal regimes . ]",
    "in order for the semiclassical model to be applied to our falling atom experiments , we must simulate the atom detection processes .",
    "in particular , in  @xcite , falling cs atoms are detected with real - time photon counting using a field programmable gate array ( fpga ) , with subsequent probe modulation triggered by atom detection .",
    "a microtoroidal cavity with frequency @xmath52 is locked near the @xmath229 atomic transition of cs at @xmath230 at desired detuning @xmath231 .",
    "fiber - cavity coupling is tuned to critical coupling where the bare cavity transmission vanishes , @xmath232 . for atom detection , a probe field at frequency @xmath233 and flux @xmath234 cts/@xmath51s",
    "is launched in the fiber taper and the transmitted output power @xmath235 is monitored by a series of single photon detectors .",
    "photoelectric events in a running time window of length @xmath236 are counted and compared to a threshold count @xmath237 .",
    "a single atom disturbs the critical coupling balance so that @xmath238 , resulting in a burst of photons which correspond to a possible trigger event .",
    "extensive details of the experimental procedure are given in  @xcite and the associated supplementary information .",
    "whereas only a single atom is required to produce a trigger , spectral and temporal data are accumulated over many thousands of trigger events since each individual atom is only coupled to the cavity for a few microseconds .",
    "simulation is a valuable technique to disentangle atomic dynamics from the aggregate data and offer insights into the atomic motion which underlies the experimental measurements .",
    "central to our simulations is the generation of a set of @xmath239 representative atomic trajectories for the experimental conditions of atoms falling past a microtoroid fulfilling the criteria for real - time detection . since experimental triggering is stochastic ,",
    "the trajectory set is generated randomly as well .",
    "for each desired collection of experimental parameters @xmath240 , a set of semiclassical atomic trajectories @xmath241 is generated that satisfies the detection trigger criteria .",
    "this ensemble is used to extract the cavity output functions @xmath242 and @xmath243 . for each individual trajectory , @xmath244 is defined to be the time when the trajectory is experimentally triggered by the fpga . for each set @xmath240",
    ", @xmath239 is chosen large enough for a sufficient ensemble average to be obtained for the final output functions , which is typically at least 400 unique triggered trajectories .    within each simulation , the probe field",
    "is fixed to a given @xmath71 .",
    "cavity behavior is determined by the parameters @xmath52 , @xmath35 , @xmath37 , and @xmath72 .",
    "@xmath35 and @xmath37 are determined from measurements of the bare cavity with no atoms present .",
    "low - bandwidth fluctuations in @xmath72 and @xmath52 from mechanical vibration and temperature locking are modeled as normally distributed random variations with standard deviations of 3 mhz and 1.5 mhz , respectively , that are fixed once for the duration of each simulated trajectory .",
    "similar to the experimental procedure , we impose that the bare - cavity output flux is less than 0.4 cts/@xmath51s at critical coupling and on resonance .",
    "this rate would be identically zero for @xmath87 and critical coupling in the absence of these fluctuations .",
    "if the noise threshold is not met , then the particular trajectory is thrown out as it would have been in experiments .",
    "the atomic cloud is characterized by its temperature , size , and its height above the microtoroid .",
    "its shape is assumed to be gaussian in each direction with parameters determined by florescence imaging . for each simulation loop ,",
    "an initial atomic position @xmath245 is selected from the cloud and the initial velocity @xmath246 is selected from a maxwell - boltzmann distribution of temperature @xmath82 .",
    "the trajectory is propagated forward in time under the influence of gravity until it crosses the toroid equatorial plane at @xmath59 .",
    "only trajectories which pass within @xmath247 @xmath51 m of the toroid surface at @xmath59 are kept as a candidate for detection , as other atoms couple too weakly for triggering .",
    "once an acceptable set of initial conditions is obtained , the trajectory @xmath4 is calculated over a 50 @xmath51s time window around its crossing of @xmath59 , this time with the gravity , optical dipole forces , and surface interactions included .",
    "as the atom moves through the cavity mode , the atom - cavity coupling @xmath88 , level shifts , decay rates , and forces change with position @xmath3 , causing deviations of the trajectory from the preliminary free - fall trajectory .",
    "if the atom crashes into the surface of the toroid , then the coupling is set to @xmath248 onwards and the trajectory effectively ends ( except for random ` noise ' photon counts arising from the non - zero background transmission ) .",
    "using @xmath4 and the steady - state expressions for the fields ( section  [ sec : theory ] ) , we find the transmission @xmath15 .",
    "the photon count record @xmath249 on each photodetector @xmath8 for time step @xmath250 is generated from a time - dependent poisson process with mean count per bin of @xmath251 , where @xmath252 ns and @xmath253 is the input flux .",
    "since the typical flux is @xmath254 mhz and the timescale of quantum correlations is @xmath255 ns , the photon count process is assumed to be poissonian on the relevant timescale of a few hundred nanoseconds for atom detection .",
    "the count record @xmath249 is compared to the desired threshold of @xmath237 in a time window @xmath236  @xcite .",
    "if the trigger condition is met , the initial conditions @xmath256 , @xmath257 , the random cavity parameters @xmath52 and @xmath72 , and the random number seed used to generate @xmath12 for diffusion processes are stored for later use .",
    "the semiclassical trajectory @xmath258 can be fully reconstructed from these parameters .",
    "the time coordinate is shifted so that the trigger event occurs at @xmath244 .",
    "this process is repeated to acquire @xmath239 triggered trajectories .",
    "cavity output functions such as the experimentally measurable transmission @xmath259 for each simulation parameter set @xmath240 are calculated from the set of trajectories @xmath260 : @xmath261 reflection coefficients @xmath262 are calculated similarly .",
    "spectra are calculated by averaging output powers over a time window @xmath263 for each probe frequency @xmath71 .",
    "the times @xmath264 and @xmath265 are chosen to be the same as in our experiments , which is typically @xmath266 ns and @xmath265 = 750 ns .",
    "the set of triggered trajectories @xmath260 is valid for a given set of conditions @xmath240 and detection criteria @xmath267 until the trigger at @xmath244 . in experiments ,",
    "the probe frequency @xmath71 can be changed in power and detuning upon fpga trigger .",
    "although the same set of trajectories is valid before @xmath244 for each detuning , the trajectory set must be recalculated for @xmath268 for each probe detuning to mimic experimental conditions for spectral measurements .",
    "a numerical solution of the master equation in a number state basis is used for calculation of @xmath15 in  ; the linearized model is only used to calculate the trajectory @xmath4 and efficiently generate triggers .",
    "whereas experiments give access only to ensemble averaged output functions , simulations contain the full trajectory paths .",
    "provided that the simulation offers a reasonable approximation of the true ensemble of trajectories , then these results provide a window into the atomic dynamics underlying the cqed measurement of falling atoms which are not readily clear from observations .      the experimentally measurable cavity transmission @xmath269 is obtained in   as an average over the trajectory set @xmath260 at each time @xmath21 .",
    "eq .   can formally be written as an integration over the probability distribution of coupling constants at time @xmath21 , @xmath270 , for the given experimental parameters @xmath240 : @xmath271 the function @xmath272 is shown in fig .",
    "[ fig : tfunc ] for the parameters @xmath240 relevant to experiments , specifically with @xmath273 mhz . for this discussion , we assume all frequencies are fixed and neglect surface shifts . in this perspective , @xmath269 is not directly related to the trajectory set @xmath260 but rather the probability distribution @xmath270 at time @xmath21 .",
    "the time dependence of @xmath274 evolves based on the underlying trajectory ensemble .     for ( a ) and",
    "( b ) calculated numerically from  . atoms with higher @xmath46 generally have higher @xmath82 and a larger probability for detection .",
    "the variation of @xmath82 with @xmath125 is evident , with a different periodicity for the two cavity detunings . ]",
    "it is instructive to consider the probability distribution @xmath270 in more detail since it is the formal output of the simulations .",
    "we consider only the distribution @xmath275 over the coupling parameter @xmath88 at the trigger time @xmath244 by integrating out the angular dependence . through a reasonably simple analytic model ( detailed in  [ app : toy ] ) , we calculate @xmath275 and compare to the results of the semiclassical simulation , which includes dipole and surface forces ( fig .  [ fig : dist ] ) . for a cavity on resonance with the atom transition , @xmath276",
    ", the analytic model agrees well with a simulation when dipole and surface forces are not included . in this case ,",
    "atom trajectories are nearly straight and vertical near the toroid , and the approximations of  [ app : toy ] are sufficient .",
    "when the full forces are included in the semiclassical model , the additional forces shift the distribution toward lower @xmath88 .",
    "this effect is more significant for @xmath277 mhz .",
    "the corresponding experimental cqed spectra confirm that the semiclassical model with dipole and surface forces is necessary to reproduce spectral features in the real - time experiments ( fig .",
    "[ fig : dist]c ) .     of coupling constants calculated for ( a ) @xmath276 and ( b ) @xmath278 mhz .",
    "distributions from the analytic model ( red ) , semiclassical trajectory simulation with no dipole or surface forces ( blue ) , and the simulation with all forces ( black ) are shown for comparison .",
    "( c ) experimental cqed spectra data for cavity detuning @xmath279 mhz ( blue points ) from  @xcite plotted with model spectra calculated from the distributions @xmath275 in panel ( b ) .",
    "the red is the analytic model of  [ app : toy ] and black is the semiclassical simulation . ]",
    "the cavity transmission @xmath82 varies as a function of the atomic azimuthal coordinate @xmath105 , as evident in fig .",
    "[ fig : tfunc ] . this biases atomic detection towards specific locations around the toroid and leads to a non - uniform angular distribution @xmath280 for atom location at detection .",
    "[ fig : phidistribution ] shows distributions of the atomic angular coordinate at the detection trigger @xmath244 for three simulation conditions relevant to the experiments of  @xcite .",
    "although averaged spectra do not explicitly measure the coordinate @xmath125 , these simulation makes clear that trajectories passing through certain regions around the toroid are preferentially detected .",
    "the phase of the cavity output field depends on @xmath125 , suggesting the possibility for future experiments to measure the distribution of fig .",
    "[ fig : phidistribution ] .     of atomic azimuthal angle @xmath281 at transit detection time",
    "@xmath244 presented as histograms of simulation runs .",
    "shown are the cases for cavity detunings ( a ) @xmath282 and ( b ) @xmath283 mhz .",
    "normalization is such that the sum across all @xmath125 is unity . ]",
    "we now turn to the simulated trajectories @xmath260 .",
    "in contrast to experiments , in simulations we have the capability of turning certain forces selectively on and off . in particular , we can adjust the surface potential @xmath172 and the dipole forces , referred to symbolically as @xmath151 ( despite them not being strictly derivable from a potential ) . to investigate the effects these optical phenomena have on atomic trajectories , we run simulations for four cases : the full semiclassical model , the model without surface forces ( @xmath284 ) , the model without dipole forces ( @xmath285 ) , and the model without any radiative forces ( @xmath286 ) .    considering conditions relevant to  @xcite , we plot simulations for two sets of experimental parameters @xmath287 in fig .",
    "[ fig : trajectories ] . for @xmath288 ,",
    "the cavity is detuned to the red , whereas the cavity is blue - detuned in @xmath289 ( @xmath290 mhz for @xmath288 and @xmath291 mhz for @xmath289 ) . in each set of conditions ,",
    "the probe field is on resonance with the cavity for high signal - to - noise atom detection ( @xmath292 ) and the average bare - cavity mode population of @xmath66 is @xmath293 photons .",
    "the toroid cavity parameters are those of  @xcite , @xmath294 mhz . comparing the full model",
    ", we see that trajectories for @xmath288 primarily crash into the surface , whereas those from @xmath289 both crash and are repelled from the toroid .",
    "this asymmetry is due to the repulsive or attractive dipole force for different probe detunings relative to the atomic transition .",
    "the largest effect of turning surface forces _ off _ is seen in the blue - detuned trajectories , which have a lower crash rate when @xmath295 . with @xmath285 , both @xmath296 and @xmath297 trajectories",
    "look nominally the same ; the detuning @xmath298 only affects cqed spectra , with a minor imperceptible effect arising from cp potentials initially shifting the atomic transition either closer to ( red ) or further from ( blue ) the cavity field .",
    "in addition to the qualitative differences in detected atom trajectories summarized here , the effects of @xmath151 and @xmath172 are evident in the experimental quantities @xmath269 and @xmath299 .",
    "since here we focus specifically on trajectory calculations , the reader is referred to  @xcite for detailed comparisons of spectral and temporal simulations to experimental data .",
    "( @xmath300 mhz ) plotted for four models of radiative forces : the full semiclassical model , @xmath295 , @xmath301 , and @xmath302 .",
    "for the full model , a three - dimensional representation is shown , while trajectories are projected onto the two - dimensional @xmath32 plane for all conditions .",
    "magenta trajectories represent _ un - triggered _ atoms , blue paths are detected atoms for @xmath303 and red paths represent atom trajectories after the trigger for @xmath304 . ]",
    "our trajectory simulation can be extended to study trapping of atoms in a two - color evanescent far off - resonant trap ( efort ) near a microtoroidal resonator .",
    "an evanescent field trap takes advantage of the wavelength dependence of scale lengths for the optical dipole force of two optical fields with frequencies far - detuned from the atomic transition to limit scattering  @xcite .",
    "the relative powers of the two fields are set so that near the surface , the blue - detuned , repulsive field is stronger than a red - detuned attractive field . as each field falls off with a decay constant of roughly @xmath305 , at some distance , the red , attractive field will dominate and the atom will be attracted to the surface forming a potential minimum . recently , evanescent fields have been harnessed to trap atoms in a two - color efort around a tapered optical fiber  @xcite , where the fiber enables efficient optical access to deliver both high intensity trapping fields and weaker probe fields to the trapped atoms in a single structure .",
    "the tapered fiber can be positioned as desired , bringing the trapped atoms near a device for atomic coupling .",
    "the tapered nanofiber efort is a remarkable achievement toward integrating atom traps with solid - state resonators , but the nanofiber scheme does not allow direct integration with a cavity for achieving strong , coherent coupling between light and trapped atoms .",
    "another disadvantage is that trap depth is limited by the large total power required to achieve trapping with evanescent fields .",
    "the high quality factors and monolithic structure of wgm resonators allow evanescent field traps free from these problems while maintaining efficient optical access from tapered fiber coupling .",
    "two - color evanescent field traps in wgm resonators have been analyzed in detail for spheres  @xcite and microdisks  @xcite . in this section ,",
    "we extend our simulations of atoms in the evanescent field of a microtoroid to an efort that can capture single falling cs atoms triggered upon an atom detection event .    unlike nanofibers",
    ", a microtoroid can not be placed directly in a magneto - optical trap for a source of cold atoms . as shown in  @xcite",
    ", we have the experimental capability to detect a single atom falling by a microtoroid and trigger optical fields while that atom remains coupled to the cavity mode .",
    "the semiclassical simulations described here are ideal for investigating the capture of falling atoms in a trap triggered upon experimental atom detection .",
    "we add an additional efort potential @xmath306 to our semiclassical trajectory model in addition to the dipole forces and surface potential @xmath172 .",
    "for our simulation , @xmath306 is formed from a red ( blue)-detuned mode near 898 nm ( 848 nm ) with powers @xmath307 @xmath51w to give a trap depth of @xmath308 mk at @xmath309 nm from the surface ( fig .",
    "[ fig : trap]a ) .",
    "the red ( blue ) fields interact primarily with the @xmath310 @xmath311 transition .",
    "the trap depth is limited by the total power in vacuum that can propagate in the tapered fibers of  @xcite .",
    "power handling can be improved with specific attention to taper cleanliness , so with experimental care the trap depth can be increased reasonably from the discussion here , although we simulate under the conditions given to illustrate that this trap is already experimentally accessible .",
    "the difference in vertical scale lengths ( @xmath60 in  ) for modes of different wavelength leads to a trap that is not fully confined if both the red- and blue - detuned trap modes are of the lowest order ( as in fig .  [ subsec : modes]b ) . as @xmath312 increases ,",
    "the repulsive blue - detuned light weakens faster than the red - detuned field , and atoms can crash into the toroid surface .",
    "this problem is alleviated by exciting a higher - order mode for the 898 nm light , as shown in fig .",
    "[ fig : trap]b .",
    "the modal pattern confines atoms near @xmath59 and prevents trap leakage along @xmath61 .",
    "this problem is not present in the microdisk efort of  @xcite because the optical mode extent is determined by structural confinement and not the optical scale length .",
    "use of a higher - order mode was also used to form an atom - gallery in a microsphere  @xcite .     along the @xmath59 axis with the cp potential included .",
    "also shown are the red and blue evanescent potentials of the two trapping modes , @xmath306 , respectively .",
    "( b ) the mode function used in @xmath306 for the 898 nm mode with @xmath313 .",
    "( c ) simulated trajectories for trapping simulations with a efort @xmath306 triggered  on \" by atom detection at @xmath314 with @xmath315 . falling atoms with the fort beams  off \" @xmath316",
    "are colored blue , whereas trajectories after the trap is triggered are red .",
    "trajectories are colored pink for @xmath317 @xmath51s to illustrate the timescale .",
    "roughly @xmath318 of the triggered trajectories become trapped .",
    "( d ) same as ( c ) showing only the trapped trajectories and a clearer view of atom orbits in the evanescent trap . ]    during the detection phase of the simulation , @xmath319 . at @xmath244 conditioned on an atom detection trigger , @xmath306 is turned on .",
    "the kinetic energy of an atom with typical fall velocity of @xmath320 m / s is equivalent to 0.3 mk , so a 1.5 mk trap is sufficiently deep to capture an atom if it is triggered near the trap potential minimum . defining a trapped trajectory to be one such that the atom has @xmath321 mhz at @xmath322 @xmath51s , approximately @xmath318 of triggered atom trajectories",
    "are captured when the trapping potential is turned on .",
    "simulated trapping times exceed 50 @xmath51s , limited not by heating from trapping light but by the radiation pressure from the unbalanced traveling whispering - gallery modes of nearly - resonant optical probe field .",
    "this probe field can be turned off so that the atoms remain trapped beyond the simulation time .",
    "in contrast to the standing - wave structure of a typical efort or fabry - perot cavity trap  @xcite , microtoroidal resonators offer the tantalizing possibility of radially confining an atom in a circular orbit around the toroid  @xcite .",
    "the @xmath319 outlined here does not confine the atoms azimuthally , forming circular atom - gallery orbits around the microtoroid  @xcite ( fig .",
    "[ fig : trap]c , d ) . in the same manner as  @xcite",
    ", a localized trap can be achieved by exciting a red - detuned standing wave for three - dimensional trap confinement .",
    "this trapping simulation outlines how real - time atom detection can be utilized to trap a falling atom in a microtoroidal efort . in practice",
    ", microtoroidal traps present some serious practical challenges .",
    "notably , because the trap quality is sensitive to the particular whispering - gallery mode , the excited optical mode must be experimentally controlled .",
    "the success of an efort for cs atoms around a tapered nanofiber  @xcite strongly suggests that similar trap performance might be achieved for an efort around a high-_q _ wgm cavity , localizing atoms in a region of strong coupling to a microresonator .",
    "we have presented simulations of atomic motion near a dielectric surface in the regime of strong coupling to a cavity with weak atomic excitation . as required by experimental distance scales ,",
    "this simulation includes surface interactions , which manifest through transition level shifts and center - of - mass casimir - polder forces .",
    "analysis of the simulated trajectories gives insight into the atomic motion underlying experimental measurements of ensemble - averaged spectral and temporal measurements for single atoms detected in real - time .",
    "we have adapted our simulations to investigate the capturing of atoms in an evanescent field far off - resonant optical trap in a microtoroid .",
    "our simulations suggest that falling atoms can be captured into an efort around a microtoroid , offering an experimental route towards trapping a single atom in atom - chip trap in a regime with both strong cqed interactions and significant casimir - polder forces simultaneously . in this system",
    ", the sensitivity afforded by coherent cqed can be used not only for atom - chip devices , but also as a tool for precision measurements of optical phenomena near surfaces .",
    "we acknowledge support from nsf , dod nsseff program , northrop grumman aerospace systems , and previous funding from aro and iarpa . n.p.s",
    ". acknowledges support of the caltech tolman postdoctoral fellowship .",
    "evaluation of casimir - polder interactions of atoms with the surface of the dielectric resonator requires evaluation of the atomic polarizability and of the dielectric function as functions of a complex frequency .",
    "here we outline our analytic model of the complex dielectric function for sio@xmath323 and the atomic polarizability of cesium atoms in the ground and excited states .",
    "the complex dielectric function @xmath324 is modeled using a lorentz oscillator model of the real and imaginary parts of the response function to analytically introduce frequency dependence and enforce causality , @xmath325 here , @xmath326 is the resonance frequency , @xmath327 is the damping coefficient , and @xmath328 is the oscillator strength for each oscillator in the model . @xmath329 .",
    "@xmath24 can be expressed in terms of the complex index of refraction @xmath330 as @xmath331 , where @xmath332 is the refractive index and @xmath333 is the extinction coefficient .",
    "experimental data for @xmath334 for sio@xmath323 is available over a wide frequency range  @xcite , which is used to fit the parameters of   for a seven - oscillator model ( @xmath335 ) . using the analytic form of  , the dielectric function",
    "can readily be evaluated over complex frequencies as shown in fig .",
    "[ fig - response ] .",
    "the frequency - dependent atomic polarizability @xmath336 for cesium in a state @xmath337 is calculated as a sum over transitions of the form , @xmath338 where @xmath339 is the electron charge , @xmath340 is the electron mass , @xmath341 is the transition frequency , and @xmath342 is the signed oscillator strength for the transition of state @xmath332 to the state @xmath337 ( @xmath343 if state @xmath332 is above @xmath337 in energy ) . a more complete expression for the response function @xmath196 should include damping coefficients given by the transition linewidths . since our calculations involve integrals over infinite frequency on the imaginary axis and atomic linewidths are generally narrow with respect to transition frequencies , we assume that the off - resonant form given by   without damping is sufficient",
    ". we also note that this expression does not account for the differences between magnetic sublevels and hyperfine splitting , which again represent small corrections when these expressions are integrated over the imaginary frequency axis .",
    "the general form of   applies to the polarizabilities for both the @xmath202 ground state and the @xmath203 excited state , with an additional tensor polarizability for the @xmath203 state .",
    "the total atomic polarizability is composed of contributions from valence electron transitions ( @xmath344 ) and high - energy electron transitions from the core shells to the continuum ( @xmath345 ) , such that @xmath346 .",
    "the valence polarizability @xmath344 constitutes 96% of the total static polarizability  @xcite in cs , with @xmath345 only significant at high frequencies .",
    "we take @xmath345 to be the same for both the ground and excited states of cs , whereas @xmath347 is obviously sensitive to the different electronic transition manifolds for @xmath202 and @xmath203 states .",
    "valence electron oscillator strengths and transition frequencies are tabulated in many sources  @xcite .",
    "our estimate of @xmath348 for the ground state includes all @xmath349 and @xmath350 transitions , with @xmath351 . for the excited state ,",
    "@xmath348 is calculated using @xmath352 , @xmath353 , and @xmath354 transitions .",
    "tensor polarizability contributions sum to zero when averaged over all angular momentum sublevels  @xcite . in agreement with  @xcite ,",
    "our calculation of @xmath344 comprises about 95% of the total static polarizability .    for simplicity",
    ", all core electron transitions are lumped into a single high - frequency term of the form used in  .",
    "this term contains two free parameters , @xmath355 and @xmath356 , which are found from the following two conditions . using the calculation of @xmath348 for the cs ground state",
    ", we enforce that the ground state static polarizability @xmath357 matches the known value calculated theoretically  @xcite @xmath358 cm@xmath223 .",
    "we also ensure that the ground state lj constant for a cs atom near a metallic surface agrees with the known value  @xcite @xmath360 khz @xmath51m@xmath223 .",
    "these conditions are sufficient to fix the two free parameters in @xmath361 for this single oscillator core model , although the high - frequency structure of the core polarizability is lost . for the excited state calculation",
    ", we use the same @xmath361 .",
    "here we develop an analytic model of the distribution @xmath362 of coupling parameters @xmath88 and azimuthal coordinate @xmath363 .",
    "atoms are assumed to fall at constant vertical velocity with no forces , in contrast to the more complete semiclassical trajectories used in this manuscript to generate @xmath364 .",
    "an abbreviated description of this model appears in the supplementary information of @xcite .",
    "the linearized steady - state cavity transmission @xmath365 is a known function of @xmath366 and @xmath3 .",
    "we only consider the lowest order mode where the cavity mode function is approximately gaussian in @xmath25 and exponential in distance from the surface @xmath165 .",
    "the approximate temporal behavior of the coupling constant @xmath88 for a single trajectory is , @xmath367 where @xmath368 is the maximum value of the @xmath88 at the closest approach of its trajectory ( @xmath59 ) , @xmath369 is a characteristic width assumed to be independent of @xmath111 , and @xmath370 .",
    "@xmath368 decays exponentially from the maximum @xmath371 at the toroid surface , @xmath372 .",
    "the transmission @xmath82 and hence the detection probability depend on @xmath125 ; in general , if atoms fall uniformly around the toroid , the most numerous trajectories detected will be at the values of @xmath125 which maximize @xmath373 for the cavity parameters of interest ( @xmath374 for @xmath375 mhz , for example , as in fig .",
    "[ fig : phidistribution ] ) .",
    "the probability density function for the full ensemble of detected falling atoms @xmath362 can be estimated as the product of the probability of any atom having a particular @xmath88 and the probability of a trigger event occurring for an atom with coupling @xmath88 , @xmath376 an atom transit is triggered when the total detected photon counts exceeds a threshold number , @xmath237 , within a detection time window @xmath236 . for a probe beam of input flux",
    "@xmath253 , the mean counts in this window are @xmath377 .",
    "this expression assumes that the atom is moving slowly so that the @xmath378 at trigger event is the only @xmath378 that contributes to the detection probability .",
    "the detection probability @xmath379 is estimated from a poisson distribution of mean count @xmath380 .    from",
    ", @xmath381 can be written as a product of the probability @xmath382 of an atom in a trajectory with a given @xmath383 to have coupling @xmath88 and the probability of a trajectory to have that @xmath383 , @xmath384 , integrated over all @xmath383 , @xmath385 the integral has limits from @xmath88 to @xmath371 since @xmath383 can not be smaller than @xmath88 .    for atoms falling uniformly over the @xmath386 plane",
    ", @xmath387 is proportional to the area of a ring of radius @xmath111 and thickness @xmath388 , @xmath389 . using @xmath390 , @xmath391 .",
    "hence , @xmath392 for @xmath393 .",
    "to find @xmath382 we note that that the probability is proportional to the time an atom in the trajectory is at a particular @xmath88 . from   for a constant velocity @xmath155 ,",
    "this trajectory is gaussian and the relative probability must be proportional to @xmath394 . finding the differential as a function of @xmath88 gives @xmath395 .",
    "putting the results together in   gives @xmath396 this result diverges as @xmath88 goes to zero since there are infinite transits with small @xmath383 and infinite time for atoms with small @xmath88 for any transit regardless of @xmath383 for @xmath397 .",
    "this divergence is not problematic in calculating   since @xmath398 cuts off for low @xmath88 faster than the logarithmic divergence in @xmath381 .",
    "the spectrum for given experimental parameters as a function of probe detuning @xmath399 can be written as : @xmath400 where the normalization of @xmath401 is chosen such that @xmath402 the overall probability of @xmath88 , @xmath403 independent of @xmath125 , is found by integrating over @xmath125 . in practice",
    ", @xmath403 is quite similar to @xmath362 evaluated for the @xmath125 which maximizes the transmission .",
    "[ fig : dist ] compares this simple model for @xmath403 with the equivalent distribution from the semiclassical trajectory simulation , @xmath275 ."
  ],
  "abstract_text": [
    "<S> we present a semiclassical model of an atom moving in the evanescent field of a microtoroidal resonator . </S>",
    "<S> atoms falling through whispering - gallery modes can achieve strong , coherent coupling with the cavity at distances of approximately 100 nanometers from the surface ; in this regime , surface - induced casmir - polder level shifts become significant for atomic motion and detection . </S>",
    "<S> atomic transit events detected in recent experiments are analyzed with our simulation , which is extended to consider atom trapping in the evanescent field of a microtoroid .    </S>",
    "<S> = 1 </S>"
  ]
}