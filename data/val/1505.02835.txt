{
  "article_text": [
    "global tropospheric chemistry transport models ( ctm ) are used to address important issues ranging from air quality to climate change . in order to continuously improve their performance ,",
    "it is of crucial importance to understand and quantify the diverse sources of uncertainties and errors present in them .",
    "we group these in three different categories , ( _ i _ ) errors and uncertainties coming from observations and data used in our models ( such as emission inventories , wind fields , reaction rates ) ; ( _ ii _ ) errors coming from our choice of governing equations ( or mathematical model ) , parametrizations , and the level of complexity of the physical modules included in our formulation ; and ( _ iii _ ) numerical errors coming from the choice of algorithms we use to solve the governing equations using computers @xcite .",
    "+ in this study , we focus our attention on estimating the magnitude of numerical errors ( _ iii _ ) , in particular , those arising from the choice of operator splitting technique utilized to integrate in time the transport and chemistry operators in real - life global ctms . in order to achieve this",
    ", we numerically extend the results introduced for the linear diffusion - reaction case in @xcite , to a non - linear 1-d chemistry - transport numerical model .",
    "the latter numerical results provide us with a framework to estimate upper bounds for operator splitting errors in the fully non - linear 3-d state - of - the - art global ctm : geos - chem @xcite . to the best of our knowledge ,",
    "our contribution is the first in estimating operator splitting errors in the context of real - life global atmospheric chemistry simulations .",
    "+ ctms simulate the dynamics of chemical species in the atmosphere by numerically integrating a set of coupled nonlinear partial differential equations of the type : @xmath0 for @xmath1 ; where @xmath2 represents the spatio - temporal evolution of the concentration of species @xmath3 ( typically over a hundred species are considered ) , @xmath4 is the wind velocity , @xmath5 is the air density , @xmath6 the eddy diffusivity matrix , @xmath7 are the nonlinear production terms , @xmath8 are the destruction terms , @xmath9 are the volume emission sources , and @xmath10 are the sinks ( ex . precipitation or in - cloud removal ) .",
    "see @xcite for a detailed description of these equations .",
    "+ due to the dimensions of grid boxes in global ctms , like geos - chem ( with hundreds of kilometers in the horizontal versus tens to hundreds of meters in the vertical ) , intertial vertical transport processes in this global models are simulated ( a ) using vertical mass fluxes schemes that ensure that the horizontal air flow is divergent - free ( @xmath11 ) , ( b ) using convection parametrizations , and ( c ) using a boundary layer mixing algorithm @xcite .",
    "in addition , horizontal diffusion due to numerical errors in transport schemes are typically higher than their eddy difusivity counterpart , as measured by aircraft missions @xcite . as a consequence , the first term of the right - hand side of equation ( [ eq : advec - reac ] ) , which models the dynamics of intertial vertical transport as an eddy diffusion process , is not explicitly integrated in global ctms ; and the governing equations ( [ eq : advec - reac ] ) are sometimes written @xcite in a simplified way as @xmath12    the chemistry operator on the right - hand - side of equations ( [ eq : advec - reac2 ] ) models the chemical interaction of atmospheric species whose lifetimes range from milliseconds to many years .",
    "the chemistry operator is very stiff as a consequence of this large range of time - scales and thus , implicit - in - time methods are an appropriate choice to integrate equations ( [ eq : advec - reac ] ) .",
    "traditional methods , such as the method of lines , aimed at achieving this task in realistic 3d simulations , involve solving for an enormous number of degrees of freedom at each time step in a coupled fashion ( @xmath13 100 chemical species in @xmath14 grid cells , for a @xmath15 spatial resolution ) .",
    "this is due to the inter - species coupling in the chemistry operator and the spatial coupling in the transport operator . in practical situations , however , efficient computational algorithms to integrate equations ( [ eq : advec - reac ] ) use operator splitting strategies that allow the explicit time  integration of the transport and implicit time  integration of the chemistry operators separately and sequentially , thus , reducing significantly the degrees of freedom solved in a coupled fashion at a given time step .",
    "this is done at the expense of a loss of accuracy in the approximate solution @xcite . + estimating the magnitude of the numerical errors introduced by the time ",
    "integration of equations ( [ eq : advec - reac ] ) in realistic 3-d computer simulations is a hard task since no relevant analytic solution can be used as a reference to estimate them . in theory , estimates of these errors depend directly on the regularity properties of the analytic solution of equations ( [ eq : advec - reac ] ) , the set of initial and boundary conditions , and the chosen numerical scheme @xcite . in this study",
    ", we assume that the analytic solution of equations ( [ eq : advec - reac ] ) is unique and regular enough so that numerical error estimates can be expressed as inequalities of the form ( [ eq : error_est ] ) .",
    "operator splitting errors , as well as numerical errors arising from the time  integration of the chemistry operator depend explicitly on the magnitude of the chosen time steps , while numerical errors coming from the time  integration of the transport operator depend both on the time step and on the grid size .",
    "this fact , in combination with an expression of the analytic solution of equations ( [ eq : advec - reac ] ) , is exploited to obtain the exact magnitude of operator splitting errors in our one - dimensional proto - type transport - chemistry numerical model .",
    "+ our one - dimensional numerical experiments show three main results : ( a ) operator splitting sequences where the stiff non  linear chemistry operator is evaluated at the end of the time step are more accurate than those where the transport is evaluated lastly , independently of the operator splitting time - step , as in the linear case introduced in @xcite ; ( b ) the results of numerical simulations that use different operator splitting strategies differ by at most 10% ; and ( c ) numerical errors coming from the integration of the transport operator are much bigger than those coming form the operator splitting technique for spatial and temporal scales comparable to those used in global ctm .",
    "we use this fact , and evidence from papers such as @xcite , to suggest that in realistic 3d simulations , errors due to operator splitting are much smaller than those introduced by transport schemes .",
    "upper bounds of the numerical errors introduced by solving partial differential equations with regular boundary and initial conditions , using a given numerical scheme , can be expressed by inequalities represented as @xmath16 where @xmath17 is the true solution of the partial differential equation , @xmath18 the numerical approximation , @xmath19 and @xmath20 are the time step and grid size respectively , @xmath21 and @xmath22 are exponents ( typically larger than one ) that determine the order of convergence of the method in time and space respectively , @xmath23 and @xmath24 are constants that depend on the regularity of the true solution @xmath17 and parameters in the equation , and @xmath25 is the norm in the appropriate banach space @xmath26 . for a convergent method , as @xmath27 and @xmath28 , the numerical error vanishes , ( _ i.e. _ @xmath29 ) and",
    "the numerical approximation @xmath30 converges to the true solution @xmath31 , in the normed space @xmath26 .",
    "more details about the integral representation ( equation [ eq : error_est ] ) of numerical errors due to discretization of partial differential equations can be found in : @xcite + for the specific set of partial differential equations ( [ eq : advec - reac ] ) , operator splitting errors and errors coming from the numerical integration of the chemistry operator ( where no coupling in space exists ) contribute to the first term on the right - hand - side of inequality ( [ eq : error_est ] ) , whereas , numerical errors from the integration of the transport operator contribute to the first and second terms of the right - hand - side of inequality ( [ eq : error_est ] ) . quantifying the independent contribution of each processes to each term of inequality ( [ eq : error_est ] ) is not simple in practical applications . in the following section ,",
    "we show how to estimate the magnitude of operator splitting errors in the absence of other numerical error coming from the time  integration of the transport and chemistry operators .",
    "+      classical approaches to estimate the numerical errors introduced by operator splitting approaches are based on asymptotic expansions of exponential operators ( linear case ) and lie operator formalism ( nonlinear case ) . for completeness ,",
    "we briefly describe important results of the linear analysis of operator splitting methods in this section .",
    "we refer the reader to @xcite and the references therein for more details . in this section",
    ", it is assumed that the time ",
    "integration of each operator separately can be found exactly giving rise to no numerical error , _",
    "i.e. _ the numerical errors discussed below come only from the choice of the operator splitting technique .",
    "+ we use as an example the linear evolution equation , @xmath32 where @xmath33 and @xmath34 are linear operators .",
    "one of these operators could represent the linear spatial differential operator @xmath35 ( transport ) in equations ( [ eq : advec - reac ] ) . the analytic solution for this problem",
    "is given by : @xmath36 the simplest operator splitting method , called godunov and denoted by @xmath37 , can be obtained for @xmath38 $ ] by solving the two evolution equations in sequence as : @xmath39\\\\ \\dfrac{d { v^{**}}}{d t } & = bv^ { * * } , \\qquad & v^{**}(0 ) = & v^*(\\delta t ) \\qquad & in \\ ; [ 0 , \\delta t ] .",
    "\\end{aligned } \\right.\\ ] ] the value for @xmath40 at @xmath41 is given by @xmath42 .",
    "the solution obtained with this operator splitting method at @xmath41 is given by @xmath43 the exact solution ( [ eq : exact ] ) and the solution @xmath44 in the previous equation will be the same if @xmath45 this will happen if the operators @xmath33 and @xmath34 commute ( think of matrices ) , _ i.e. _ if @xmath46 . when @xmath47 , then the ( point - wise ) local - in - time numerical error associated to solving problem ( [ eq : op_split1 ] ) using godunov s operator splitting technique can be shown to be @xmath48 which leads to a global error @xmath49 ,",
    "_ i.e. _ @xmath50 ( for a constant @xmath51 that depends only on the regularity of the analytic solution @xmath40 ) . since the numerical error vanishes as @xmath52 ,",
    "godunov s method is a convergent first order method in time , in the linear case .",
    "another simple godunov operator splitting can be obtained by reversing the order of evaluation of the operators @xmath33 and @xmath34 to obtain the @xmath53 method ( @xmath54 ) . a more accurate and symmetric operator splitting method , often referred to as strang method ( strang , 1968 ) , can be obtained by averaging the output of the two previous methods , i.e. @xmath55 .",
    "it can be shown that the strang operator method is globally second order accurate , _",
    "i.e. _ @xmath56 for a constant @xmath57 @xcite .",
    "+ the linear analysis presented above may fail and lead to different convergence results if one of the operators is stiff , _",
    "i.e. _ if the dynamics of one operator take place in much faster time scales than the dynamics in the other operator @xcite",
    ". this can be seen by introducing a small parameter @xmath58 ( representing the ratio between fast time scales in the stiff operator and the slow time scales of the other operator ) and re - writing the linear evolution equation ( [ eq : op_split1 ] ) as a singular perturbation equation by re - defining @xmath59 for our purposes , one can identify the chemistry operator with the stiff operator @xmath60 , ( the nonlinear chemistry can be , locally - in - time and space , approximated by a linear and stiff mechanism at least for some subset of fast species ) , and identify the transport operator with the slow operator @xmath61 , for which the dynamics takes place in a more confined range of time scales ( as represented by our global models ) .",
    "it is shown in @xcite that the local error for the @xmath62 godunov method becomes ( compare to equation ( [ eq : ab_error ] ) ) : @xmath63 leading to a global error @xmath64 , implying that @xmath65 .",
    "note that convergence of the operator splitting method , in this case , can only be guaranteed provided the operator splitting time step , @xmath19 , is small enough to satisfy @xmath66 so that higher order terms , @xmath67 , will indeed vanish as @xmath68 in the taylor expansion of the error . + in atmospheric chemistry simulations , we use operator splitting methods to integrate in - time two operators in equations ( [ eq : advec - reac ] ) : transport and chemistry .",
    "transport and chemistry are known to commute when the velocity field is divergent free and chemistry is independent of the spatial location . in real atmospheric situations , these conditions are typically not met .",
    "indeed , the non - linear chemistry operator depends dynamically on the geographic location ( due to photolysis ) , and atmospheric wind fields are in general not divergent - free .",
    "the result of the linear analysis above suggests that operator splitting approaches will converge only if the operator splitting time step is much smaller than the lifetime of the fastest species in the chemistry mechanism ( @xmath66 ) .",
    "this is also the criterion established to ensure stability and convergence of explicit - in - time chemistry solvers , and suggests the use of prohibitively small operator splitting time - steps in order to guarantee convergence of the method . in practice , however , the use of implicit schemes to integrate the chemistry operator in global chemistry models leads to the choice of large operator splitting time - steps compared to the intrinsic stiffness of the chemistry system ( @xmath69 ) . as a consequence , and according to expression ( [ eq : stiff_error ] ) , we may expect to observe large operator splitting errors when solving equations ( [ eq : advec - reac ] ) with stiff and potentially non  linear chemistry operators . + it is argued in @xcite , that operator splitting errors , even in the presence of large operator splitting time steps ( such that @xmath69 ) , may not be as big as suggested by expression ( [ eq : stiff_error ] ) .",
    "@xcite argues that the stiffness of the system can be balanced by the existence of an underlying reduced model ( low - dimensional manifold ) describing the dynamics of the system and thus , by choosing the appropriate order of operator evaluation in a time - step , the splitting error may be bounded even with the increase of stiffness .",
    "moreover , he shows for the linear case that sequences where the stiff operator is evaluated at the end of the time step lead to convergent and accurate methods in a one dimensional diffusion - chemistry toy example , even for large operator splitting time steps . in solving equations ( [ eq : advec - reac ] ) , examples of these sequences",
    "include : transport  chemistry and chemistry  transport  chemistry .",
    "+ intuitively speaking , evaluating the transport operator at the end of the time step sets the state of the system far from the underlying low dimensional manifold driving the chemical system and provides an initial condition @xmath70 for the next time evaluation that enhances error propagation .",
    "this is avoided by evaluating the stiff chemistry operator at the end of the time step .",
    "the existence of these reduced models driving the dynamics in regional and global atmospheric chemistry models has been found in @xcite , suggesting that the operator splitting order should be selected carefully . to the best of our knowledge , a careful investigation of these errors in the realistic non",
    " linear case does not exist so far and thus we aim at achieving this here .",
    "+ isolating operator splitting errors in practical global atmospheric chemistry models is not straightforward , first , because we lack expressions for the analytic solution of the system in realistic circumstances , and second , since the solutions of the chemistry and transport operators , separately , are obtained using numerical schemes and thus are not exact as it was assumed in the previous analysis . in order to estimate upper bound estimates of operator splitting errors we proceeded as follows .",
    "we first found sharp estimates of numerical errors in a 1d non  linear chemistry - transport prototype problem with a known analytic solution .",
    "we designed this 1d problem to resemble the interaction of numerical errors in the time ",
    "integration of the transport and ( stiff ) non  linear chemistry , when using operator splitting methods , at spatial and time scales used in 3d global simulations .",
    "our 1d findings guide our methodology to understand the differences observed between the outputs of 3d global simulations using different operator splitting strategies .",
    "we performed multiple 3d global simulations in order to further understand additional numerical errors , due to the time integration of relevant processes ( emissions , convective transport , and deposition ) inherently solved with operator splitting approaches .",
    "we considered a one - dimensional advection - reaction system that can be solved analytically and thus exact values of numerical errors can be obtained .",
    "the system is characterized by a constant wind field throughout the domain , and a three - species ( @xmath71 , @xmath72 , @xmath73 ) stiff non  linear chemistry - mechanism modeling the @xmath74 cycle through oxidation by ozone ( @xmath73 ) .",
    "this cycle is key in determining the balance of ozone ( @xmath73 ) in the atmosphere .",
    "the chemical reactions are given by : @xmath75 where the parameters @xmath76 and @xmath77 represent the constant reaction rates throughout the domain .",
    "the resulting advection - reaction system of equations can be written as @xmath78 where @xmath71 , @xmath72 , and @xmath73 , represent the concentration of each chemical in space and time , and @xmath79 the constant velocity of the flow ( compare with equations ( [ eq : advec - reac ] ) ) .",
    "+ the advection and reaction operators commute in this problem ( since the advection operator is divergent - free , @xmath80 , and the chemistry is independent of the location in space ) , thus , the use of operator splitting approaches should not introduce any error when the exact solutions of the chemistry and advection operators are known . however , when solving numerically the advection operator , with an eulerian advection scheme , undesired numerical diffusion will cause the numerical advection operator to not commute with the chemistry operator ( since nonlinear chemical operators do not commute with diffusion , as shown in @xcite ) thus signalling the emergence of operator splitting errors in the numerical solution of equations ( [ eq : toy_syst])-([eq : toy_syst3 ] ) . +",
    "this one - dimensional problem is relevant in realistic global 3d simulations since the transport operator is solved utilizing eulerian numerical schemes , and thus , giving rise to undesired numerical diffusion that will not commute with the time - integration of the chemistry operator .",
    "moreover , in regions in the atmosphere where the flow is near ( 2d ) divergent - free ( due to a well stratified atmosphere ) and during the night ( or day ) so that chemistry is independent of space , chemistry and transport operators may commute locally in space and time as in the 1d prototype . + in more complicated circumstances , for example in regions of space close to the terminator line ( where the day and night boundary is ) , and in equatorial regions where convection makes the atmosphere be far from divergent - free conditions , operator splitting errors can be expected to be larger since the advection and chemistry operators will not commute . +      when the chemistry is fast with respect to transport processes , an exact expression can be found for the steady - state solution of system ( [ eq : toy_syst])-([eq : toy_syst3 ] ) .",
    "for example , by choosing @xmath81 and @xmath82 , as in @xcite , and introducing the non - stiff combined - chemistry operator @xmath83 , we can represent a stiff ( fast ) chemistry operator as the quotient @xmath60 for a small parameter @xmath58 .",
    "equations ( [ eq : toy_syst]-[eq : toy_syst3 ] ) can be re - written , as suggested in equation ( [ eq : defn_stiff ] ) , as : @xmath84 here @xmath58 represents the stiffness of the system and is given by the ratio between the slow advection scales and the fast chemistry time scales .",
    "for example if @xmath85 and @xmath86 , then @xmath87 .",
    "+ the expression of the steady - state solution of system is found by introducing the lumped species @xmath88 and @xmath89 ( references , sportisse 2000 ) in order to re - write equations ( [ eq : toy_stiff1])-([eq : toy_stiff2 ] ) as : @xmath90 in this new form , and denoting @xmath91 , it can be seen that the lumped species @xmath92 and @xmath93 are conserved in time , since @xmath94 as a consequence , for regions where the three species are initially present , the exact asymptotic value of the concentration of all species , @xmath95 , @xmath96 , and @xmath97 , can be found explicitly as a function of the initial concentration of the lumped species .",
    "this is achieved in two steps .",
    "first , by expressing the values of the steady state concentrations , @xmath95 and @xmath96 , as a function of the conserved lumped species as : @xmath98 and substituting them in equation ( [ eq : toy_stiff_lumped2 ] ) . the system reaches a chemical steady state when @xmath99 , or equivalently when @xmath100 o_3^{\\dagger } - 2 [ o_x(0)- o_3^{\\dagger}]= [ no_x(0)- [ o_x(0)- o_3^{\\dagger } ] ] o_3^{\\dagger } - 2 [ o_x(0)- o_3^{\\dagger}]=0 , \\label{eq : steady_1d}\\ ] ] which is a second order equation for the steady state of @xmath97 with solutions given by @xmath101 and second , the values of @xmath95 , and @xmath96 can be found by substituting the ( physically relevant ) positive solution of ( [ eq : steady_1d_2 ] ) in equations ( [ eq : lumped_steady ] ) . for time scales",
    "@xmath102 such that @xmath103 ( for @xmath104 ) , the system will have reached chemical steady - state and from then on , equations ( [ eq : toy_stiff_lumped1])-([eq : toy_stiff_lumped2 ] ) ( and thus the original system ( [ eq : toy_syst])-([eq : toy_syst3 ] ) ) will behave as a transport - only process propagating the steady - state concentrations with a constant velocity @xmath79 .",
    "we chose to solve equations ( [ eq : toy_syst])-([eq : toy_syst3 ] ) to simulate the fate of an instantaneous release containing the three chemicals over a @xmath105 km one - dimensional region .",
    "the constant flow velocity was chosen to resemble realistic atmospheric values of @xmath106 m / s .",
    "we prescribed a computational spatial domain , @xmath107 $ ] for @xmath108 km , so that the plume would stay within the domain for the whole simulation time , @xmath109 $ ] for @xmath110 hours , and in order to not introduce any errors due to boundary conditions in the numerical advection operator .",
    "the values of @xmath81 and @xmath82 were chosen for the stiff chemistry operator .",
    "the effective stiffness of the chemistry with respect to the transport is @xmath111 since @xmath112 .",
    "the initial conditions are given by @xmath113 , where @xmath114\\\\         0 & \\text{elsewhere}.       \\end{array }     \\right.\\ ] ]    in a 10-hour simulation time period , the initial release is advected exactly @xmath105 km to the right , and the concentrations of all species have reached chemical equilibrium . according to expression ( [ eq : steady_1d_2 ] ) , @xmath115 , and @xmath116 . the exact solution at time @xmath117 hours is explicitly given by @xmath118 and @xmath119 .",
    "this is our reference solution .",
    "+    km and different time steps , when compared to the analytic solution.,title=\"fig : \" ] km and different time steps , when compared to the analytic solution.,title=\"fig : \" ] km and different time steps , when compared to the analytic solution.,title=\"fig : \" ]    for the numerical simulations , we implemented an explicit , second order accurate ( in space ) , one - dimensional advection - scheme based on the lax - wendroff method with superbee slope limiters ( see @xcite , pp 112 for details ) , and used for the chemistry , the built - in implicit stiff - ode integrator ode23 from matlab .",
    "in order to minimize contributions to the numerical error , to the first term in inequality ( [ eq : error_est ] ) , from both the advection scheme and chemistry integrator , we utilized a very small internal advection time step , @xmath120 seconds , and set the convergence relative - tolerance parameter to @xmath121 in the routine ode23 ( it adaptively chooses a small internal time step in order to meet the prescribed @xmath122 error convergence criterion ) .",
    "+ we solved equations ( [ eq : toy_syst])-([eq : toy_syst3 ] ) using multiple first order godunov operator splitting approaches ( where transport and chemistry were evaluated in different orders ) for multiple operator - splitting time - steps , @xmath123 and @xmath124 seconds , and for multiple grid sizes @xmath125 and @xmath105 km ( the three largest grid sizes were chosen to resemble spatial resolutions of @xmath126 , @xmath127 , and @xmath128 , in current 3d global ctms ) .",
    "the results of these numerical simulations and the exact solution are plotted in the top plot of figure [ fig : ozone_1d ] .",
    "the numerical solutions corresponding to the multiple operator splitting approaches , for a given value of @xmath20 , appear as a single curve since their differences were smaller than the line - width chosen for the plot . +",
    "the quantification of numerical errors was performed using the modified relative root mean square ( rrms ) , commonly used in 3d atmospheric chemistry simulations given by @xmath129 where @xmath130 and @xmath131 are the concentrations of species @xmath3 calculated in simulations @xmath33 and @xmath34 , respectively , @xmath132 is the set of grid - boxes where @xmath130 exceeds a threshold @xmath133 , and @xmath134 is the number of such grid - boxes .",
    "we used @xmath13510@xmath136 , thus neglecting concentrations smaller than @xmath137 with respect to the original concentration . in our one - dimensional experiments ,",
    "simulation @xmath33 is the exact solution , and simulation @xmath34 was one of the multiple godunov operator splitting approaches .",
    "the second plot of figure [ fig : ozone_1d ] shows the quantity @xmath138 for @xmath139 species , for the multiple values of @xmath19 and @xmath20 . in this plot ,",
    "the red triangles represent simulations where transport was evaluated last , ( @xmath140 ) , and the green dots where chemistry was evaluated last ( @xmath141 ) .",
    "this plot confirms what is observed in the top plot , _",
    "i.e. _ , the fact that the differences across the multiple operator splitting approaches , for a given @xmath20 , are very small ( @xmath142 ) .",
    "+ in the bottom plot of figure [ fig : ozone_1d ] , we further show the values of the numerical error for the two sequences , @xmath140 and @xmath141 , for @xmath143 km , for the multiple values of the operator splitting time - steps .",
    "we found this plot to be representative of the behaviour of the numerical error for other values of @xmath20 . note that while the differences across the multiple approaches are very small , the interesting mathematical behaviour of the numerical error , discussed in section [ sec : op_split ] , can be observed .",
    "indeed , the numerical error of the sequences @xmath141 , where the chemistry ( the stiff process ) is evaluated last , produce better numerical results than their counter parts @xmath144 .",
    "moreover , @xmath141 sequences appear to be almost insensitive to the magnitude of the operator splitting time - step ( the error even seems to grow as @xmath27 as reported in sportisse , 2000 ) making them a preferred choice , since larger operator splitting time steps allow faster computations when exploiting the intrinsic parallelizable nature of the chemistry operator .",
    "the quality of results produced by sequences where transport is evaluated last , follows the traditional behaviour of linear analysis where the numerical error decreases as the operator splitting time decreases .",
    "since the magnitude of these first order operator splitting errors was so small , we chose to not implement higher order operator splitting approaches . + while the bottom plot of figure [ fig : ozone_1d ] shows a clear picture of the magnitude of operator splitting errors ( @xmath142 ) , we performed transport - only simulations in order to verify the magnitude of the numerical errors coming from the numerical advection scheme itself .",
    "the results of these simulations are shown in the top plot of figure [ fig : ozone_1d_transp ] .",
    "note that while the magnitude of the concentration of @xmath73 in these simulations is exactly one ( since no chemistry is present ) , the numerically simulated profiles , for the different values of @xmath20 , look very similar to those in the top plot of figure [ fig : ozone_1d ] . indeed , when computing the modified rrms error associated to these simulations , as shown in the bottom plot of figure [ fig : ozone_1d_transp ] , the behaviour of the relative errors resembles the one observed in the middle plot of figure [ fig : ozone_1d ] . in short , the numerical errors coming from the choice of operator splitting are eclipsed by the largest component of the numerical error coming from the spatial discretization ( second term in inequality ( [ eq : error_est ] ) ) in the numerical advection scheme .",
    "+ having chosen an initial condition in the shape of a step function in our experiments , caused our second order numerical advection scheme to behave as a first order scheme .",
    "indeed the numerical error decreases close to linearly in our numerical experiments when using the @xmath145-norm instead of the modified rrms ( plot not shown ) .",
    "estimates for the numerical errors , in the form of an effective numerical diffusion , @xmath146 , for 1d first order numerical advection schemes place their value at @xmath147 , where @xmath79 is the mean flow velocity and @xmath20 the grid spacing . in our 1d experiments ,",
    "these numerical diffusion is of the order @xmath148 m@xmath149/s .",
    "numerical diffusion in 3d global models ( @xcite ) is estimated to be around @xmath150 m@xmath149/s .",
    "these 3d estimates place our one - dimensional experiments within a relevant range .",
    "determining the exact magnitude of numerical errors in 3d global ctm simulations in the exact same way we did for our 1d prototype is not possible .",
    "this is due to the lack of an analytic expression for the solution to equations ( [ eq : advec - reac ] ) in realistic circumstances ( time - dependent winds , time - dependent chemistry rates changing throughout the geographic domain due to photolysis , time - dependent emissions ) . in order to estimate operator splitting errors in 3d ctms",
    ", we can only compare the output of simulations where everything is kept the same except for the operator splitting sequence and the operator splitting time step .",
    "this is the strategy we present in this section , which in combination with the results from our one - dimensional simulations , allowed us to determine upper bounds of operator splitting errors in geos - chem . in order to further understand additional numerical errors , due to the time integration of relevant processes inherently solved with operator splitting approaches and not present in our 1d toy example , we performed multiple additional 3d global simulations . in these simulations",
    ", we gradually included inhomogeneous boundary conditions ( emission processes ) to the time integration ( @xcite ) , and vertical processes ( convection and dry deposition ) .",
    "+ geos - chem is a state - of - the - art 3d global eulerian model of tropospheric chemistry driven by assimilated meteorological observations from the goddard earth observing system ( geos ) of the nasa global modeling and assimilation ofice ( gmao ) .",
    "the model simulates global tropospheric ozone - nox - voc - aerosol chemistry .",
    "the full chemical mechanism for the troposphere involves over a hundred species and over three hundred reactions .",
    "the ozone-@xmath151aerosol chemical mechanism of geos - chem has been described by @xcite and recently updated by@xcite .",
    "details of the chemical reactions and rate constants are reported in the chemical mechanism document ( http://acmg.seas.harvard.edu /geos / wiki_docs / chemistry /chemistry _ updates_v6.pdf ) . in figures",
    "4@xmath1526 the chemical species are arranged in the order of their chemical lifetimes in the atmosphere , from oh ( @xmath153 1 second ) and @xmath92 ( @xmath1541 hour ) , to co and @xmath155 ( 23 months ) .",
    "the chemical mass balance equations are integrated using a gear - type solver @xcite .",
    "stratospheric chemistry is not explicitly simulated and it instead uses the `` synoz '' cross - tropopause ozone flux boundary condition of @xcite .",
    "the model uses the flux form semi - langrangian advection scheme of @xcite .",
    "we used the geos - chem model ( v8 - 02 - 03 ) driven by the geos-5 data at the 4 x 5 horizontal resolution and 47 levels in the vertical .",
    "detailed descriptions of the model are given by @xcite and @xcite .",
    "in this study , we initiate the model simulations on january 1 , 2005 with model fields from a 6-month spin - up run , and focus on the weekly averaged model results for january 1 - 7 , 2005 .      our strategy consisted of comparing the instantaneous concentration of several chemical species , after multiple one - week long , 4@xmath156 x 5@xmath156 horizontal resolution , geos - chem simulations ( version v8 - 02 - 02 ) , using two versions of the ( default ) second order strang operator splitting method given by the sequences : @xmath157 for different values of the operator - splitting time step @xmath19 .",
    "these sequences are denoted as @xmath158 and @xmath159 respectively in the subsequent paragraphs .",
    "we used @xmath160 mins . in all these simulations , transport and chemistry were the only active mechanisms , all other mechanisms were turned off .",
    "the inactive mechanisms include : emissions , convective transport , deposition , and planetary boundary layer mixing .",
    "emissions correspond to inhomogenous boundary conditions that are treated numerically as production rates distributed in the boundary layer and solved together in the chemistry operator .",
    "+ we used the modified rrms ( [ eq : rms ] ) with a threshold @xmath13510@xmath161 molecules @xmath162 to quantify the numerical differences in our global simulations .",
    "figure [ fig : rms_opsplit_all ] shows the relative differences between the reference simulation @xmath159 with @xmath163 mins , and the other operator splitting approaches for multiple @xmath19 s .",
    "note that the maximum differences across simulations ( and species ) are of the order of @xmath164 .",
    "+ using our one - dimensional prototype and fixing @xmath143 km , we compared the results of two operator splitting strategies ( @xmath141 and @xmath140 ) for multiple values of @xmath19 , with the sequence @xmath141 and @xmath165 sec set as a reference .",
    "the results are displayed in figure [ fig:1d_opsplit_tch_as_ref ] .",
    "note that while the bottom plot of figure [ fig : ozone_1d ] shows that operator splitting ( relative ) errors are less than @xmath166 ( when comparing to the analytic solution ) , the relative differences between simulations using alternative operator splitting methods may be as large as @xmath167 .",
    "this is roughly the same magnitude of the differences observed between the 3d ( transport - chemistry ) simulations in the top panel of figure [ fig : rms_opsplit_all ] .",
    "+ note that we chose the sequence @xmath159 with @xmath163 mins as the reference simulation for our 3d experiments , instead of the sequence @xmath159 with @xmath168 that would have been suggested by our 1d experiments ( as in figure [ fig:1d_opsplit_tch_as_ref ] ) .",
    "the reason for this is shown in the top panel of figure [ fig : rms_op_split_dt ] , where we can see that the differences between ( transport - chemistry ) simulations with different operator splitting sequences but with the same time step , get smaller as @xmath19 gets smaller .",
    "this behaviour would be expected from a converging operator splitting method where none of the operators is stiff and where the order of evaluation of the operators is not relevant .",
    "an alternative explanation could be that the operator splitting errors are very small and what we are observing is the convergence of the time  integration of each operator , separately , as @xmath19 gets small .",
    "this would suggest that the numerical errors of the time ",
    "integration of the transport and the chemistry contribute significantly to the first term ( involving @xmath19 ) on the right hand - side of inequality ( [ eq : error_est ] ) , and should be comparable , in magnitude , to those observed between different operator splitting sequences . + in order to investigate this , we plotted the differences between simulations where the only active mechanism was either chemistry or transport , for multiple @xmath19 s , while keeping all other parameters exactly the same as in the previous simulations .",
    "the results are plotted in figure [ fig : rms_chem_only ] .",
    "these two plots show that indeed the numerical errors arising from the time  integration of each of the operators separately lead to differences of the same magnitude as those observed in the operator splitting simulations .",
    "we also observe that the differences get smaller as @xmath169 decreases suggesting numerical convergence .",
    "this comparable differences make it hard to disentangle a sharp estimate of the operator splitting in 3d .",
    "+ note also that in our one dimensional prototype a cleaner analysis was achieved since we chose a smaller internal time step ( @xmath170= 90 seconds ) to integrate the ( explicit - in - time ) transport operator than the operator splitting time step ( 180 seconds@xmath171mins ) .",
    "this choice reduced the contribution to the numerical errors involving @xmath19 in inequality ( [ eq : error_est ] ) from the transport integration . in order to save computational time in geos - chem ( and in most ctms ) , however , the time step of the ( explicit - in - time ) transport scheme is chosen to be equal to the operator splitting time step leading to larger numerical errors . + in our one dimensional prototype , the chemistry operator was solved using an adaptive time  integration routine with very tight convergence constraints , thus reducing numerical errors . the time ",
    "integration of the chemistry operator in geos - chem uses an adaptive time stepping strategy ( @xcite ) in order to meet convergence requirements ( absolute and relative numerical error tolerances ) at every user - defined time step .",
    "these parameters have been internally set to keep simulation times reasonable while maintaining acceptable numerical accuracy .",
    "we kept these settings as they are typically used in global simulations for our numerical experiments .",
    "figure [ fig : rms_chem_only ] shows the differences between chemistry  only simulations for different user - defined chemistry time - steps .",
    "presumably these errors could be decreased by fine tuning the error tolerances in the time integration routine appropriately , but this approach may increase processing times considerably .",
    "+ despite all of these numerical issues , we highlight the fact that we can establish an upper limit of about a @xmath167 for the magnitude of operator splitting errors based on the results of our multiple simulations in 3d . moreover ,",
    "we show that differences of the single chemical species with largest discrepancies across simulations , isoprene , are not significant in figures [ fig : isoprene_chem_only ] , [ fig : isoprene_transp_only ] , and [ fig : isoprene_op_split_only ] , for chemistry only simulations , transport only simulations , and different sequences of operator splitting methods , respectively . from these plots and the results of our one - dimensional prototype ,",
    "we hypothesize that the operator splitting errors may be much smaller than @xmath167 .",
    "+ we also highlight the fact that we did not pursue further efforts to show that the sequences evaluating the chemistry at the end of the time step in 3d compare better with observations , since our one - dimensional prototype , as well as multiple studies in global ctms @xcite , suggest that the numerical errors associated to the transport integration , at current spatial resolutions , are significantly larger than those observed in operator splitting methods .",
    "in addition , uncertainties in emission fields and deposition mechanisms may pose further difficulties in addressing this question . in our one - dimensional proto - type , subsequent reductions in the spatial resolution lead to significant improvements in the accuracy of the numerical solution globally ( for any operator splitting sequence ) .",
    "whereas a better choice of operator splitting ( where chemistry is evaluated last ) leads to a very modest improvement at a given spatial resolution @xmath20 .",
    "other important processes in 3d simulations are integrated in time using operator splitting strategies .",
    "as noted in @xcite and @xcite the time integration of inhomogeneous boundary conditions , such as emission processes in global simulations , using operator splitting strategies may lead to considerable numerical errors .",
    "additionally , the time integration of vertical processes such as convection and deposition using operator splitting may also lead to important numerical errors .    in order to investigate the magnitude of numerical errors due to these processes , we performed additional 3d simulations that gradually included inhomogeneous boundary conditions ( emissions ) and vertical process .",
    "in other words , aside from the 3d `` transport - chemistry '' simulations discussed in the previous sections , we performed simulations with ( i ) `` transport , chemistry , and emissions '' and simulations with ( ii ) `` transport , chemistry , emissions , convective transport and deposition '' . when emissions are included , they are integrated within the chemistry solver , using the chemistry time step .",
    "convective transport and deposition are solved using the standard setting of geos - chem , which integrate these two processes ( sequentially ) during the chemistry time step .    the differences between these two sets of simulations ,",
    "using the same methodology explained in the previous section , are plotted in the two lower panels of figures [ fig : rms_opsplit_all ] and [ fig : rms_op_split_dt ] .",
    "as these figures show , the additional numerical errors coming from the inclusion of inhomogenous boundary conditions ( emissions ) are significant .",
    "indeed , the differences between the simulations that include `` transport , chemistry , and emissions '' are roughly double the magnitude of the differences between the simulations that include only `` transport - chemistry '' for different operator splitting strategies .",
    "the incorporation of convective transport and deposition to the simulations does increase the differences between simulation , mainly when changes in time steps are large , as shown in the bottom panel of figure [ fig : rms_opsplit_all ] .",
    "when time - steps are fixed and operator splitting approaches are different , these vertical processes do not seem to lead to larger differences in the different simulations .     and @xmath140 ) , fixing @xmath143 km , for multiples time steps .",
    "the reference solution is obtained with the sequence @xmath141 for @xmath165 seconds . ]     to months @xmath172 .",
    "active processes in these simulations are as follows : transport and chemistry ( top panel ) ; transport , chemistry and emissions ( middle panel ) ; trasnport , chemistry , emissions , convective transport and deposition ( bottom panel ) . ]",
    "mins.active processes in these simulations are as follows : transport and chemistry ( top panel ) ; transport , chemistry and emissions ( middle panel ) ; trasnport , chemistry , emissions , convective transport and deposition ( bottom panel ) . ]",
    "we have presented a way to characterize operator splitting errors in the context of atmospheric chemistry modeling .",
    "our approach numerically extends one  dimensional linear results to non - linear 1d and 3d cases .",
    "these numerical findings are relevant to global atmospheric chemistry modeling .",
    "our findings suggest that stiff operators should be evaluated lastly in operator splitting methodologies .",
    "this results is consistent with the linear results presented in @xcite , and previous studies in numerical weather prediction @xcite .",
    "differences of approximately @xmath167 across species are found when comparing the outputs of global simulations using different operator splitting approaches , using multiple splitting time steps .",
    "this , in combination with our one - dimensional results , suggests that operator splitting errors do not exceed @xmath167 relative errors in global simulations .",
    "we show also , that in current spatial resolutions , the numerical diffusion errors introduced in global atmospheric chemistry models eclipse errors emerging from operator splitting techniques .",
    "future studies should identify whether operator splitting strategies that evaluate fast dynamics operators lastly in global simulations lead to simulations that improve the match between simulations and observations .",
    "further exploration is also required regarding the effect of different operator splitting strategies in the time integration of of the governing equations of aerosol dynamics and different choices of boundary layer mixing schemes .",
    "additional `` toy - tests '' that should be explored in order to further understand numerical errors introduced by different operator splitting strategies include those discussed in @xcite .",
    "finally , nuances between operator splitting approaches in eulerian and semi - lagrangian transport schemes should be more deeply investigated @xcite .",
    "ms and lz would like to thank the technical assistance provided by claire carouge . ms would like to thank jonathan pines for his involvement in the exploratory phases of this project .",
    "this work was partially funded by the national natural science foundation of china ( 41205103 )      allen , dale j. , richard b. rood , anne m. thompson , and robert d. hudson .",
    "three - dimensional radon 222 calculations using assimilated meteorological data and a convective mixing algorithm .",
    "journal of geophysical research : atmospheres 101 ( 1996 ) , no .",
    "68716881.doi : 10.1029/95jd03408    bey i. , d. j. jacob , r. m. yantosca , j. a. logan , b. field , a. m. fiore , q. li , h. liu , l. j. mickley , and m. schultz .",
    "global modeling of tropospheric chemistry with assimilated meteorology : model description and evaluation , journal of geophysical research , 106 ( 2001 ) , d19 : pp .",
    "doi:10.1029/2001jd000807 .",
    "dubal , mark , nigel wood , and andrew staniforth .",
    "mixed parallel - sequential - split schemes for time - stepping multiple physical parameterizations . monthly weather review 133 ( 2005 ) , no .",
    "4 : pp . 9891002 .",
    "doi:10.1175/mwr2893.1          hundsdorfer w. and verwer j.g .",
    "numerical solution of time ",
    "dependent advection  diffusion  reaction equations , springer series in computational mathematics ( 2003 ) , 33 , springer .",
    "doi : 10.1007/978 - 3 - 662 - 09017 - 6        lanser d. , verwer j.g .",
    "analysis of operator splitting for advection-diffusion-reaction problems from air pollution modelling , journal of computational and applied mathematics .",
    "111 ( 1999 ) , pp .",
    "doi : 10.1016/s0377 - 0427(99)00143 - 0    lauritzen , p. h. , conley , a. j. , lamarque , j. f. , vitt , f. , & taylor , m. a. , the terminator toy - chemistry test : a simple tool to assess errors in transport schemes , geoscientific model development discussions , 7 ( 6)(2014 ) , pp .",
    "doi:10.5194/gmd-8 - 1299 - 2015        lowe , r. and tomlin , a. low - dimensional manifolds and reduced chemical models for tropospheric chemistry simulations , atmospheric environment , 34 ( 2000 ) , pp . 24252436 . doi:10.1016/s1352 - 2310(99)00447 - 1    j. mao , d. j. jacob , m. j. evans , j. r. olson , x. ren , w. h. brune , j. m. st .",
    "clair , j. d. crounse , k. m. spencer , m. r. beaver , p. o. wennberg , m. j. cubison , j. l. jimenez , a. fried , p. weibring , j. g. walega , s. r. hall , a. j. weinheimer , r. c. cohen , g. chen , j. h. crawford , c .",
    "mcnaughton , a .",
    "d. clarke , l .",
    "jaegl , j. a. fisher , r. m. yantosca , p. le sager , and c. carouge .",
    "chemistry of hydrogen oxide radicals ( hox ) in the arctic troposphere in spring , atmospheric chemistry and physics , 10 ( 2010 ) , pp .",
    "doi:10.5194/acp-10 - 5823 - 2010    mclinden , c. a. , olsen , s. c. , hannegan , b. , wild , o. , prather , m. j. , & sundet , j. stratospheric ozone in 3-d models : a simple chemistry and the cross - tropopause flux , journal of geophysical research , 105(d11 ) ( 200 ) , pp .",
    "doi : 10.1029/2000jd900124    park , r. j. , d. j. jacob , b. d. field , r. m. yantosca , and m. chin . natural and transboundary pollution influences on sulfate  nitrate ",
    "ammonium aerosols in the united states : implications for policy , journal of geophysical research , 109 ( 2004 ) , d15204 , doi : 10.1029/2003jd004473    pisso , i. , elsa real , kathy s. law , b. legras , n. bousserez , j. l. atti , and h. schlager .",
    "estimation of mixing in the troposphere from lagrangian trace gas reconstructions during long  range pollution plume transport .",
    "journal of geophysical research : atmospheres , 114 ( d19 ) ( 2009 ) .",
    "doi:10.1029/2008jd011289          rastigejev , y. , m. p. brenner , and d. j. jacob .",
    "spatial reduction algorithm for atmospheric chemical transport models .",
    "proceedings of the national academy of sciences 104(35 ) ( 2007 ) , pp 1387513880 .",
    "doi : 10.1073/pnas.0705649104    m. santillana , p. le sager , d. j. jacob , and m. p. brenner .",
    "an adaptive reduction algorithm for efficient chemical calculations in global atmospheric chemistry models , atmospheric environment 44 ( 35 ) ( 2010 ) , pp .",
    "doi:10.1016/j.atmosenv.2010.07.044                l. zhang , d. j. jacob , n. v. downey , d. a. wood , d. blewitt , c. c. carouge , a. van donkelaar , d. ba jones , l. t. murray , and y. wang .",
    "improved estimate of the policy - relevant background ozone in the united states using the geos - chem global model with 1/2  2/3 horizontal resolution over north america , atmospheric environment 45 ( 2011 ) , pp ."
  ],
  "abstract_text": [
    "<S> we present upper bounds for the numerical errors introduced when using operator splitting methods to integrate transport and non  linear chemistry processes in global chemical transport models ( ctm ) . </S>",
    "<S> we show that ( a ) operator splitting strategies that evaluate the stiff non  linear chemistry operator at the end of the time step are more accurate , and ( b ) the results of numerical simulations that use different operator splitting strategies differ by at most 10% , in a prototype one  dimensional non  linear chemistry - transport model . </S>",
    "<S> we find similar upper bounds in operator splitting numerical errors in global ctm simulations .    </S>",
    "<S> atmospheric chemistry , operator splitting , model verification , numerical errors </S>"
  ]
}