{
  "article_text": [
    "since the beginning of modern astronomy , the scientific community expressed a great interest in scientific visualisation tools .",
    "a strong boost in this direction was determined by the introduction of modern ccd detectors to collect observational data in a digital form .",
    "today , almost all the standard measures are digital and each measure can be generally considered as a collection of images forming a multi - dimensional data set . in many cases",
    "extensive image processing is required to obtain meaningful images .",
    "useful scientific information can be obtained from the raw data only using a data reduction pipeline .",
    "the most common data reduction tools , like iraf @xcite from national optical astronomy observatories ( noao ) and midas @xcite from european southern observatory , make an extensive use of visualization .",
    "this is supported by popular tools like avs , iris explorer , data visualizer and idl .",
    "however , these are generic purpose packages , not specifically designed for astrophysics .",
    "this makes often difficult their usage and they often required to learn a new specific programming language .",
    "furthermore it is usually hard , and some time impossible , to add user - developed data analysis tools .    besides observational data",
    ", the improvement of technology and the availability of super - computing multiprocessor system , have led to a dramatic increase of the volume of data coming from numerical simulations .",
    "astrophysical simulations produce today gigabytes of data which have to be efficiently visualized and analyzed .",
    "in fact a simulation produces several output to be correlated and analyzed , corresponding to different temporal tags and associated computational meshes ( sometimes irregular or structured grids ) .",
    "furthermore , particle methods @xcite ( n - body , sph , etc ) are , especially in cosmology , extremely popular . for this class of data the use of the above mentioned tools",
    "is not adequate .",
    "specific tools , like tipsy @xcite , have been created and are commonly used .",
    "however , these tools are quite limited in their functionalities , can not describe and handle mesh - defined fields , usually associated to particles related quantities ( like mass ) , and are not designed to work efficiently with large amount of data .",
    "in this paper we present astromd , an analysis and visualization tool specifically designed to deal with the visualization and analysis of astrophysical data , avoiding or solving most of the previously described difficulties and limitations .",
    "astromd can manage different physical quantities .",
    "it can find structures having a not well defined shape or symmetries , and performs quantitative calculations on a selected region or structure .",
    "furthermore , it also makes use of virtual reality techniques which are particularly effective for understanding the three dimensional distribution of the fields , their geometry , topology or specific patterns .",
    "the display of data gives the illusion of a surrounding medium into which the user is immersed .",
    "the result is that the user has the impression of travelling through a computer - based multi - dimensional model which could be directly hand - manipulated . in this sense ,",
    "the virtual reality is a progressive lowering of the barrier which separates users from their data @xcite .",
    "astromd is developed by the visit ( visual information technology ) laboratory at cineca ( casalecchio di reno - bologna ) in collaboration with the astrophysical observatory of catania ( hereafter oact ) .",
    "astromd is an open source completely free code which is freely available ( see http://www.cineca.it/astromd ) .",
    "the plan of the paper is as follows . in section 2",
    "we will describe the basic features of astromd and the graphic user interface , in section 3 we describe the first test case on which astromd has been tested : the data produced in cosmological simulations performed using the parallel n - body tree code of the oact group .",
    "the preliminary results and data manipulation performed using astromd on these data are presented in section 4 . finally ,",
    "in section 5 , we draw the conclusions and future developments .",
    "data produced by astrophysical simulations have peculiarities that make them different from data produced with other kind of simulation or experiment @xcite .",
    "the principal features can be summarized as follows :    @xmath0different physical species have to be considered : for example , cosmological simulations consider both baryonic and dark matter .",
    "these two components have different physical properties and they have to be treated with different numerical approach .",
    "dark matter is usually described by n - body algorithms , while simulation carried out with baryons have a fluid - dynamical description ( either eulerian or lagrangian ) .",
    "further components , like stars or different chemical species , can be introduced and followed in a specific way .",
    "these kinds of data require different types of analysis and different kind of visualization techniques .",
    "dark matter needs the analysis of particle positions and velocity , while baryons require mesh based analysis and visualization .",
    "furthermore particle associated quantities , like the mass density or the gravitational potential , require their calculation and visualization on a mesh .",
    "@xmath0simulated structures in general have not a well defined shape or particular symmetries .",
    "furthermore they can be distributed with no regularity in the computational box .",
    "therefore it is necessary to have a clear 3d representation and efficient and fast tools of navigation , selection , zoom and the possibility of improving the resolution and the accuracy of calculations in specific user - selected regions    @xmath0evolution changes dynamically the properties of the simulated objects and the information that can be retrieved , therefore it is important to control efficiently sequences of time - frames .",
    "astromd is specifically designed to deal properly with all these requirements . in the following subsections",
    "we will describe in detail the basic features of the package , the visualization , the data analysis , the graphic user interface and the stereo - graphic capabilities .",
    "astromd is developed using the visualization toolkit ( vtk ) by kitware , a freely available software portable on several platforms which range from the pc to the most powerful visualization systems , with a good scalability .",
    "vtk @xcite is designed for 3d computer graphics , image processing , and visualization .",
    "it includes a c++ class library and several interpreted interface layers .",
    "vtk has been ported on nearly every unix - based platform ( irix , solaris , linux etc . ) and pc s ( windows nt and windows 98 ) .",
    "the design and implementation of the library has been strongly influenced by object - oriented principles .",
    "the graphics model in vtk is at a higher level of abstraction than rendering libraries like opengl or pex .",
    "this means it is much easier to create useful graphics and visualization applications . in vtk applications",
    "can be written directly in c++ , tcl , java , or python . using these languages it is possible to build powerful , fast and portable applications .",
    "vtk supports a wide variety of visualization algorithms including scalar , vector , tensor , texture , and volumetric methods and advanced modelling techniques .",
    "it supports stereo - graphic rendering and can be used for virtual reality visualization .",
    "furthermore , being easily extensible , vtk allows the user to build ad hoc implementation of specific data analysis modules .",
    "the input data format presently accepted by astromd is the common unformatted c standard .",
    "binary quantities ( e.g. vector components ) are written in a continuous sequence with no labels or other symbols in within .",
    "the same result can be obtained in fortran using direct access files .",
    "however several data input formats like tipsy and hdf will be soon integrated .",
    "astromd can use the full dynamic range of the data , in order to retain the highest accuracy in the analysis .",
    "data are visualized with respect to a box which can describe the whole computational mesh or just a fraction of it .",
    "a sub - box can be selected interactively inside the parent box with a different spatial resolution , so that the user can focus on the most interesting regions .",
    "boxes can be translated , rotated , zoomed in and out with respect to selected positions .",
    "colors and luminosities can be chosen freely by the user .",
    "images of different evolutionary stages can be combined in order to obtain a dynamic view of the behaviour of the system .",
    "the program allows one to treat both particles and fields related data .",
    "the distribution of the particles can be easily visualized by astromd using the particles positions , as shown in fig . 1 and fig",
    ". 2 . +    the user can choose to use a sample of the data , in order to get a faster and easier visualization .",
    "the opacity of the particles can be increased , so that low density regions are more easily detectable , or decreased , so that the details of the high density regions substructures are better visualized .",
    "different particles species ( e.g. dark matter and baryons ) can be visualized at the same time using different colours .",
    "other particle - related continuous quantities , like density fields or the gravitational field , can be calculated as typical grid based fields .    in general , fields have a discrete representation on the cells of a computational mesh .",
    "the values of a field on a cell can be interpreted as the average value of the field over that cell . in section 4",
    "we will show several complementary ways of visualizing a field : different colours are associated to the values of the analyzed field .",
    "further possibilities of visualizing the field are either using cutting planes where iso - value curves are drawn , or projecting the distribution on a plane , integrating the field along the line of sight orthogonal to the plane . this last representation ,",
    "that is closer to what actually comes from observations , will be soon included in the package .",
    "finally , different time frames can be shown in a sequence .",
    "when particles are used , their positions are linearly interpolated between two available key - frames .",
    "this technique engenders a graphic animation in real time , giving the impression of a continuous movement of particles , generally a randomized sample of the global data set .",
    "both the single images and the whole sequence of time - step can be saved in bitmap format .",
    "further output formats will be soon made available .",
    "there are several astromd built - in tools which allow an efficient manipulation and analysis of the data .",
    "the following functionalities are in progress and all of them will be integrated in version 1 of the package .",
    "@xmath1 * particles mass density *    the mass density field associated to the particle distribution is calculated distributing the mass of each particle over the computational mesh by a eight points cloud in cell smoothing algorithm @xcite . the computation can be done with the maximum accuracy using all the particles over a uniform high resolution mesh , but astromd allows the user to use only a sample of the whole set of particles , and the final result can be extrapolated to all particles of the simulation , reducing the cpu time consuming and the memory request .",
    "the smoothing of the masses can be performed generally using a coarse grid , that can be refined where high resolution is necessary .",
    "the same tool can be used to calculate other fields related to quantities possibly associated to the particles , like , for example , the thermal energy density field or the x - ray luminosity field .",
    "* gravitational field calculation *    considering the mass density @xmath2 defined over the computational mesh as above , the gravitational field can be calculated solving the poisson equation @xmath3 where @xmath4 is the gravitational potential , by a fourier transform procedure . the poisson equation is transformed in its momentum space image using a fft vtk built - in function .",
    "this reduces the equation to a much simpler algebraic operation @xmath5 where @xmath6 and @xmath7 are the fourier images of the potential and of the density and @xmath8 is the square module of the wavenumber .",
    "finally the potential is transformed to the physical space using an inverse fft .",
    "@xmath1 * fourier decomposition , power spectrum and correlation function *    the quantity @xmath7 is used to calculate the power spectrum @xmath9 of the matter distribution , which is defined as the average value of the square norm of @xmath7 : @xmath10 the power spectrum expresses the weight of each of the fourier components of the mass distribution between @xmath11 and @xmath12 which represent the inverse of the size of the computational mesh and the nyquist frequency .",
    "the power spectrum is a powerful measure of the statistical properties of the distribution , together with the associated correlation function @xmath13 , which is its fourier transform .",
    "the correlation function indicates the probability to find a particle at a distance @xmath14 from any other particle , and is usually used to analyze the clustering properties of a sample of discrete objects ( particle , galaxies , galaxy clusters . etc . )",
    "the astromd graphic user interface has been projected for a simple and useful setting of the visualization parameters . + the commands are located in two main sections : a set of four menu buttons on the top of the astromd window and two columns of commands on the left side ( fig .",
    "3 ) . in the following we describe in detail the most important displayed commands . +    [ [ menu - buttons . ] ] menu buttons .",
    "+ + + + + + + + + + + + +    the * file * button contains the command to load three types of data : it is possible to load data which can refer to the gas , dark matter and stellar components of a simulated system .",
    "the different types of particles can be displayed all together or separately , depending on the type of information the user wants to obtain .",
    "+ the * view * button allows the selection of a point of view of the visualized system . these choices ( being also reported in the column of the commands ) , integrate the possibility to rotate , scale and zoom into the domain of the visualized system , using the mouse . + with the * tools * button , the user can select several utilities .",
    "the _ interactor _ permits to give vtk commands interactively ; the _ pipeline _ shows the vtk pipeline , that is the network of filters which transform data into graphics primitives and creates the visualized objects .",
    "the _ opacity _ selection allows to choice the values of opacity for the components of the astrophysical system .",
    "a more accurate setting of the opacities can be performed using the _ actor properties _",
    "4 ) : for each visualized object , permits the user to regulate the intensity and colour of the _ ambient light _ ,",
    "i.e. the light reflected or scattered from other objects in the scene ; the _ diffuse light _ , which is the light reflected by the object taking into account the angle of incidence of the light onto the object itself , the _ specular light _ , representing direct reflection of a light source off a shiny object , the _ specular power _ which tells how the object reflects the incoming light and the _ opacity _ which regulates the transparency of the object : an opacity value of 0 produces the object to be completely transparent .",
    "+ the surface colours of the displayed objects are obtained interpolating across polygons . the buttons , _ flat _ , _ gourand _ and _ phong _ correspond to three different types of interpolation :",
    "they are related to the process of transformation from graphic primitives to the visualized objects .",
    "the background colour can be selected from a button in the * tools * menu , the combination of colours and lights of the objects can be saved and reloaded .",
    "+ with the * options * button the user can select the stereo - graphic modality of visualization , wide the rendering window up to full screen and save the window geometry for particular situations . +    [ [ command - column . ] ] command column .",
    "+ + + + + + + + + + + + + + +    the * zoom * and * view from * section of commands allow the regulation of the point of view of the objects while the * show / hide * section of buttons select the components of the simulated system that the user wants to visualize .",
    "the _ box _ , _ gas _ ,",
    "_ dark _ and _ stars _ have obvious meanings ; the _ contour _ button is referred to the visualization of iso - surfaces , the _ sampler _ activation permits the computation of the properties for a subset of particles , and the _ boundary _ button shows a periodic reproduction with one tenth of the total number of particles in the box including all the system .",
    "+ the user can choose the sample of the loaded particle type ( i.e. stars , dark matter and gas particles ) , the size of the visualization box and the starting time from which he wants to show the evolution of the simulation .",
    "+ the * density * entries control the visualization of the iso - surfaces .",
    "these are calculated on a grid whose resolution can be user - selectable . + to allow the user to investigate with more accuracy a subset of the visualized system it is possible to use a cubic _",
    "sampler_. if the sampler is selected ( * show / hide * menu ) , visualized in the scene and enabled ( * sampler * menu ) , all the computations are performed only inside the region of the sampler .",
    "+ astromd can also show the evolution in time of the simulated system over all the interval of time for which the data are available , performing interpolations at intermediate frames .",
    "the * evolve * section permit to fix the initial and final times of the evolution and the number of steps used for the evolution . during the evolution the updated time of evolution",
    "is displayed in the _ time _ entry of the * cloud * section .",
    "+ finally snapshots of the images displayed can be created using the button _ take it _ in the * screenshot * menu .",
    "a subdirectory named _ screenshot _ is created ( if it does not exist ) and bitmap images ( progressively numbered ) are created .",
    "+ all the groups of commands can be changed and are applied using the corresponding _ update _ command , the _ update _ command at the end of the left column updates all the system as a whole .",
    "astromd can represent data using stereo - graphic visualization and display data in three dimensions with a stereo - scopic technique .",
    "the 3d stereo - scopic perception , is based on the different angles we see a near object due to the distance of the eyes .",
    "the combination of the two images determine the position of the object in space .",
    "this process is reproduced by stereo - graphic visualization devices .",
    "the visualization system displays the same image as it is seen from slightly different points of view and presents it separately to each eye .",
    "this is done by different methods .",
    "the most common is using shutter glasses ( made with liquid crystals ) that act so that each eye only sees the image intended .",
    "the final superposition of the two images gives the impression of a 3d scene where th user is full immersed .",
    "the stereo images can be created on different kind of displays : the screen of a pc , the virtual theatre , up to the cave environments or the head mounted displays    the stereo - graphic functionalities of astromd are developed in the virtual theatre of cineca . in this environment",
    "we can use two different kind of displays : a wide cylindric screen ( @xmath15 m , @xmath16 view angle ) and a projective desk ( @xmath17 m , 29.1 dpi ) .",
    "the visualization is controlled by a sgi onix2 infinite reality2 system with eight mips r10000 processors , 4 gbytes dram and three graphic pipes .",
    "stereo - graphic visualization gives a useful enhancement of common 2d rendering for many applications .",
    "for example , the perception of the three dimensional distribution of structures is much easier .",
    "specific geometric or topological features of the sample comes out clearly from the 3d immersive representation .",
    "furthermore , it is possible to analyze quantities not directly dependent on the position , visualizing their correlations as planes or surfaces .",
    "a typical example is the fundamental plane of elliptic galaxies , which relates three observable quantities like the half - light radius , the mean surface brightness and the central velocity dispersion of these systems .",
    "in this section we will show some preliminary result we obtain applying the astromd tool to the data obtained from a simulation of 16 millions of particles @xcite studying the formation and the evolution of the universe .",
    "the simulation has been performed using the n - body tree code of the oact group run on the cray t3e supercomputer of cineca @xcite , @xcite . in the following subsection",
    "we briefly describe the tree code based on the barnes - hut algorithm ( hereafter bh ) @xcite , and the cosmological model we use to obtain the multi - dimensional data set .",
    "large cosmic structure simulations have improved enormously over the past decade both in terms of mass and force resolution .",
    "state - of - the - art n - body codes hardly allow one to deal with a number of particle n@xmath18 .",
    "+ the cosmological n - body simulations aim at finding a solution to a set of general relativistic equations of motions describing the motions of particles ( e.g. the postulated _ dark matter _ particles ) in the universe .",
    "these equations can be written in the form : @xmath19 @xmath20    where @xmath21 is the mass of a particle , @xmath22 is the gravitational constant , @xmath23 is the time - varying expansion parameter ( the scale factor of the universe ) , @xmath24 and @xmath25 are the gravitational potential and the local density respectively at comoving coordinate @xmath26 , and @xmath27 is the mean mass density of the universe .",
    "the bh tree algorithm is a @xmath28 procedure to compute the gravitational force through a hierarchical subdivision of the computational domain into a set of cubic nested regions that form an adaptive tree data structure . generally speaking ,",
    "the _ bodies _ evolve in time according to the laws of newtonian physics : @xmath29 where @xmath30 .",
    "+ the fundamental approximation of the tree codes consist in the approximation of the force component for the _ i _ body . considering a region @xmath31 the force component on",
    "_ i _ may be computed as :    @xmath32    where @xmath33 and @xmath34 is the center of mass of @xmath31 .",
    "+ the system dynamics involves the advancement of the trajectories of all particles , and this is carried out through a discrete integration of the trajectory of each particle .",
    "+ the code has been parallelized in order to be used on the cray t3e system using both hpf - craft and shmem libraries .      as a test case for the astromd tool we use the output of a simulation with 16.777.216 particles run on a cray - t3e 256 processor based machine at the cineca .",
    "the system evolves in a cubic region with size of 50mpc ( about @xmath35 km ) .",
    "the cold dark matter cosmological model was used , each particle having about @xmath36 solar masses . with this kind of cosmological model",
    "it is possible to study the formation and the evolution of galaxies and clusters of galaxies @xcite .",
    "the simulation starts at a time ( red - shift ) @xmath37 , where the latter parameter is a standard measure of time adopted in cosmology .",
    "the age of the universe can be calculated from the red - shift parameter @xmath38 using the following equation : @xmath39 where @xmath40 , which is valid for the cosmological models we have simulated . at @xmath37 the age of the universe was about 24 million years , when the matter of the universe was still almost uniformly distributed .",
    "the simulation was stopped at the value @xmath41 , the actual age of the universe .",
    "the system evolve for about 270 time - steps using the opening parameter @xmath42 and clusters of galaxies start to form at about @xmath43 .",
    "we collected 22 output check point files starting from @xmath44 up to the end of the simulation totalling 18 gbytes of data ( position and velocity for each particle ) .",
    "this files were managed and randomized so that each selection of the first n particles in the output file , correspond to a selection of n random particles in the box where the system evolves . the astromd use this randomized files and the ancillary informations to visualize data and to extract the scientific informations as specified in the following paragraphs .",
    "1 shows a primordial distribution of dark matter particles inside the 50 mpc cubic region of the simulation above mentioned . in the displayed picture ,",
    "only a subset of 200,000 particles has been used , but owing to the fact that the data are randomized , a very good representation of the distribution of particles is obtained .",
    "this configuration is quite uniform , with small peaks of density .",
    "as it is well known , during the evolution the dark matter collapses onto these peaks of density leading to the formation of at least three main clusters of galaxies and several minor groups , embedded in a typical structure of voids and filaments ( fig .",
    "the system evolution , from the primordial distribution of matter up to the formation of the final structures , can be visualized by astromd .",
    "it is possible to note the augmentation of the velocity of collapse onto the proto - clusters and the oscillations of the matter density ( around the main peaks ) during the formation of the clusters . using the mouse it is possible to rotate the box and analyze the shapes of the clusters from different points of view ; moreover , zooming into the main structures , the details of the high density regions can be studied .",
    "a detailed analysis can be done setting a grid .",
    "5 shows the matter density field : the iso - surfaces are determined by connecting the cells in where the field has the same user - defined threshold value . in this figure the _ sampler _ has been used to show the iso - surfaces around the main cluster of galaxies in the simulation , fixing a value for the density 50 times greater than the mean background density , and using a grid of @xmath45 .",
    "the displayed iso - surface of the inner distribution of matter has the ellipsoidal shape . in fig .",
    "5 the iso - surfaces are completely opaque but lowering the opacity parameter value it is possible to see the particles of dark matter inside the iso - surface .",
    "+    another different way of visualizing the field is by a volume rendering technique , where the colour opacity is a function of the field and its value typically increase with the magnitude of the field itself .",
    "therefore , for example , low density regions appear more transparent ( and differently coloured ) than higher density ones .",
    "looking at the gas distribution in a cluster of galaxies , we can see through the outer shells , until the inner , more dense and more opaque core . in this way we mimic the actual behaviour of light through a dense medium .",
    "the enormous amount of data presently obtained both by observation and by numerical simulations , determines a growing request by astrophysicists of powerful tools which combine efficient visualization and accurate analysis capabilities .",
    "in this way both a qualitative and quantitative analysis of the data can be obtained and great benefits can be achieved .",
    "visualization , in fact , allows one to have a more intuitive approach to the data , to find out easily their overall properties and characteristics and to focus on the most interesting of them .",
    "data analysis gives the quantitative results required by the scientific analysis .",
    "we have presented astromd , a new data analysis and visualization tool , which should respond to this demand . in the preliminary version",
    "we have focused on the visualization aspects , with particular attention to 3d immersive rendering and on creating a friendly graphic user interface .",
    "this makes astromd a useful instrument already competitive with other existing software used in astronomy .",
    "the package is rapidly evolving and new functionalities , like a cluster identification and reconstruction algorithm , are being added .",
    "astromd has been built such that it is open source and portable on all the most common unix systems and ms windows .",
    "one of our basic purpose is to make it a wide spread product , highly diffused and used by the astrophysical community .",
    "the immersive virtual reality was tested using the virtual theatre immersive visualization facility made available from cineca .",
    "this is made up by : a graphic supercomputers , ( sgi onix2 infinite reality 2 , 8 processors r10000 , 4 gbytes ram ) ; a high resolution projection system ( 3 projectors barcographics ) ; a cylindric screen ( 2.7x9.1 m , 2816x768 pixels ) ; a projective desk ( 1.6x1.8 m , 29.6 dpi ) .",
    "we gratefully acknowledge useful discussion with dr .",
    "s. bassini , and we would like to thank g. erbacci of cineca for the useful help they gave us ."
  ],
  "abstract_text": [
    "<S> over the past few years , the role of visualization for scientific purpose has grown up enormously . </S>",
    "<S> astronomy makes an extended use of visualization techniques to analyze data , and scientific visualization has became a fundamental part of modern researches in astronomy . with the evolution of high performance computers , </S>",
    "<S> numerical simulations have assumed a great role in the scientific investigation , allowing the user to run simulation with higher and higher resolution . </S>",
    "<S> data produced in these simulations are often multi - dimensional arrays with several physical quantities . </S>",
    "<S> these data are very hard to manage and to analyze efficiently . </S>",
    "<S> consequently the data analysis and visualization tools must follow the new requirements of the research . </S>",
    "<S> astromd is a tool for data analysis and visualization of astrophysical data and can manage different physical quantities and multi - dimensional data sets . </S>",
    "<S> the tool uses virtual reality techniques by which the user has the impression of travelling through a computer - based multi - dimensional model . </S>",
    "<S> astromd will be a freely available tool for the whole astronomical community .    </S>",
    "<S> _ keyword : _ n - body simulations , analysis tool , scientific visualization </S>"
  ]
}