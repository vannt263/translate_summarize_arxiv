{
  "article_text": [
    "tuberculosis ( tb ) is the second leading cause of death from an infectious disease worldwide @xcite .",
    "active tb refers to disease that occurs in someone infected with _",
    "mycobacterium tuberculosis_. it is characterized by signs or symptoms of active disease , or both , and is distinct from latent tuberculosis infection , which occurs without signs or symptoms of active disease .",
    "only individuals with active tb can transmit the infection .",
    "many people with active tb do not experience typical tb symptoms in the early stages of the disease .",
    "these individuals are unlikely to seek care early , and may not be properly diagnosed when seeking care @xcite .",
    "delays to diagnosis of active tb present a major obstacle to the control of a tb epidemic @xcite , it may worsen the disease , increase the risk of death and enhance tuberculosis transmission to the community @xcite . both patient and",
    "the health system may be responsible for the diagnosis delay @xcite .",
    "efforts should be done in patient knowledge / awareness about tb , and health care systems should improve case finding strategies to reduce the delay in diagnosis of active tb @xcite .",
    "mathematical models are an important tool in analyzing the spread and control of infectious diseases @xcite .",
    "there are several mathematical dynamic models for tb , see , e.g. , @xcite . in this paper",
    "we consider the mathematical model for tb proposed in @xcite .",
    "we introduce a discrete time delay which represents the delay on the diagnosis of individuals with active tb and commencement of treatment .",
    "the stability of the disease free and endemic equilibriums is analyzed for any time delay .",
    "optimal control theory has been successfully applied to tb mathematical models ( see , e.g. , @xcite and references cited therein ) .",
    "we propose and analyze an optimal control problem where the control system is the mathematical model from @xcite , but with a time delay in the state variable that represents individuals with active tb , and introduce two control functions .",
    "the control functions represent the fraction of early and persistent latent individuals that are treated for tb .",
    "treatment of latent tb infection greatly reduces the risk that tb infection will progress to active tb disease .",
    "certain groups are at very high risk of developing active tb disease once infected .",
    "every effort should be made to begin appropriate treatment and to ensure completion of the entire course of treatment for latent tb infection @xcite .",
    "treatment of latent tb infection should be initiated after the possibility of tb disease has been excluded .",
    "it can take 2 to 8 weeks after tb infection for the body s immune system to react to tuberculin and for the infected to be detected , which justifies the introduction of a time delay on the control associated to treatment of early latent individuals .",
    "on the other hand , delays in the treatment of latent tb may also occur due to clinical and demographic patient and health care services characteristics . for these reasons ,",
    "we consider discrete time delays in both control functions . to our knowledge , this work is the first to apply optimal control theory to a tb model with time delay in state and control variables .",
    "the paper is organized as follows . in section  [ sec:2 ]",
    "we formulate the tb model with state delay .",
    "the stability of the disease free equilibrium is analyzed in section  [ sec:3 ] while stability of the endemic equilibrium is investigated in section  [ sec:4 ] .",
    "optimal control of tb with state and control delays is carried out in section  [ sec:5 ] and some numerical results given in section  [ sec:6 ] .",
    "we end with section  [ sec:7 ] of conclusions .",
    "in this section we consider a tb mathematical model proposed in @xcite , where reinfection and post - exposure interventions for tuberculosis are considered .",
    "the model divides the total population into five categories : susceptible ( @xmath1 ) ; early latent ( @xmath2 ) , , individuals recently infected ( less than two years ) but not infectious ; infected ( @xmath3 ) , , individuals who have active tb and are infectious ; persistent latent ( @xmath4 ) , , individuals who were infected and remain latent ; and recovered ( @xmath5 ) , , individuals who were previously infected and have been treated . as in @xcite , we assume that the total population , @xmath6 , with @xmath7 , is constant in time . in other words ,",
    "we assume that the birth and death rates are equal and there are no tb - related deaths .",
    "we introduce a discrete time - delay in the state variable @xmath3 , denoted by @xmath8 , that represents the delay to diagnosis and commencement of treatment of active tb infection , @xmath9 the initial conditions for system ( [ tbmodel : delay : state ] ) are @xmath10 @xmath11 , where @xmath12 with @xmath13 the banach space @xmath14 , { \\mathbb{r}}^5 \\right)$ ] of continuous functions mapping the interval @xmath15 $ ] into @xmath16 . from biological meaning , we further assume that @xmath17 for @xmath18 .",
    "throughout this paper , we focus on the dynamics of the solutions of ( [ tbmodel : delay : state ] ) in the restricted region @xmath19 in this region , the usual local existence , uniqueness and continuation results apply @xcite .",
    "hence , a unique solution @xmath20 of ( [ tbmodel : delay : state ] ) with initial condition ( [ eq : init : cond : moddelay ] ) exists for all time @xmath21 .",
    "consider the solutions of ( [ tbmodel : delay : state ] ) with @xmath22 , @xmath18 , for all @xmath23 $ ] .",
    "then the solutions stay in the interior of the region @xmath24 for all time @xmath21 , i.e. , the region @xmath24 is positively invariant with respect to system ( [ tbmodel : delay : state ] ) ( see , e.g. , @xcite ) .",
    "a mathematical model has a disease free equilibrium if it has an equilibrium point at which the population remains in the absence of the disease @xcite .",
    "the model ( [ tbmodel : delay : state ] ) has a disease free equilibrium given by @xmath25 .    the basic reproduction number @xmath26 represents the expected average number of new tb infections produced by a single tb active infected individual when in contact with a completely susceptible population @xcite . for model ( [ tbmodel : delay : state ] ) it is given by @xmath27   } { \\left ( \\tau_0 + \\mu+\\omega_r \\right ) \\left ( \\omega+\\tau_2 + \\mu \\right ) \\left(\\delta+\\tau_1+\\mu \\right ) } = \\frac{\\mathcal{n}}{\\mathcal{d}}\\ , .\\ ] ] note that in @xcite the basic reproduction number is deduced under the assumption that @xmath28 .",
    "the expression ( [ eq : r0 ] ) generalizes the one given in @xcite .",
    "it is important to analyze the stability of the disease free equilibrium , as it indicates whether the population will remain in the absence of the disease , or the disease will persist for all time @xcite .",
    "system is equivalent to @xmath29 where the equation for @xmath30 is derived from @xmath31 .",
    "the disease free equilibrium of system is given by @xmath32 . to discuss its local asymptotic stability ,",
    "let us consider the coordinate transformation @xmath33 , @xmath34 , @xmath35 , @xmath36 , where @xmath37 denotes any equilibrium of ( [ tbmodel : delay : state:4eq ] ) .",
    "hence , we have that the corresponding linearized system of ( [ tbmodel : delay : state:4eq ] ) is of the form @xmath38 \\dot{l}_1(t ) = - \\frac{\\beta}{n}\\,\\overline{i}\\,\\left(\\sigma_r -1 \\right)\\,s(t ) - \\frac{\\beta}{n } \\left ( \\sigma_r \\ , \\overline{i } + ( \\delta + \\tau_1 + \\mu ) n \\right ) \\ , l_1(t)\\\\ \\quad \\quad \\quad -\\frac{\\beta}{n } \\left ( -\\overline{s}-\\sigma\\,\\overline{l}_2 - \\sigma_r ( n+ \\overline{s}+ \\overline{l}_1 + 2\\,\\overline{i}+ \\overline{l}_2 ) \\right ) \\ ,",
    "i(t ) + { \\frac { \\beta\\,\\overline{i}\\ , \\left ( \\sigma- \\sigma_r   \\right ) } { n } } \\ , l_2(t ) \\\\[0.2 cm ] \\dot{i}(t ) =   - \\omega_r \\ ,",
    "s(t )   + \\left(\\phi\\,\\delta- \\omega_r \\right ) l_1(t ) - \\left(\\omega_r -\\mu \\right )   i(t ) + \\left(\\omega- \\omega_r \\right ) l_2(t ) -",
    "\\tau_0 \\,i(t - d_i)\\\\[0.2 cm ] \\dot{l}_2(t ) =    \\left ( 1 - \\phi \\right ) \\delta \\ , l_1(t ) -\\frac{\\beta}{n}\\sigma \\,\\overline{l}_2 \\ ,",
    "i(t ) - \\frac{\\beta}{n } \\left(\\sigma \\overline{i } + ( \\omega + \\tau_2 + \\mu ) n \\right)\\ , l_2(t ) \\ , .",
    "\\end{cases}\\ ] ] we then express system ( [ model : linear : delay:4eq ] ) in matrix form as follows : @xmath39 with @xmath40 the @xmath41 matrix @xmath42,\\ ] ] where @xmath43 and @xmath44 , and @xmath45 the @xmath41 diagonal matrix @xmath46 .",
    "the transcendental characteristic equation of system ( [ model : linear : delay:4eq ] ) is defined by @xmath47 and is given by @xmath48 where @xmath49 with @xmath50 , @xmath51 and @xmath52 , @xmath53 , @xmath54 , @xmath55 .    for any @xmath56 and @xmath57 , if @xmath58 , then @xmath59 .",
    "recall that an equilibrium point is asymptotically stable if all roots of the corresponding characteristic equation have negative real parts @xcite .",
    "[ lemma : e0:instable ] if @xmath60 , then the disease free equilibrium @xmath61 is unstable for any @xmath56 .",
    "the characteristic equation ( [ eq : caract ] ) satisfies @xmath62 .",
    "assuming @xmath60 , then @xmath63 .",
    "since @xmath64 , there exists at least one positive root of ( [ eq : caract ] ) .    if ( i ) @xmath58 , ( ii ) @xmath65 , ( iii ) @xmath66 , ( iv ) @xmath67 , and ( v )  @xmath68 , then the disease free equilibrium @xmath61 is locally asymptotically stable for @xmath69 .    when @xmath70 , the associated transcendental characteristic equation ( [ eq : caract ] ) of system ( [ model : linear : delay:4eq ] ) at @xmath71 becomes @xmath72 . using the routh ",
    "hurwitz criterion for fourth - order polynomials , all the roots of @xmath73 have negative real part if all coefficients satisfy @xmath74 for @xmath75 , @xmath67 , and @xmath68 .    in the case",
    "@xmath76 , by rouch s theorem @xcite , if instability occurs for a particular value of the delay @xmath77 , then a characteristic root of ( [ eq : caract ] ) must intersect the imaginary axis . our aim is to prove that the polynomial ( [ eq : caract ] ) does not have purely imaginary roots for all positive delays ( see , e.g. , @xcite ) .",
    "the complex @xmath78 , @xmath79 , is a root of ( [ eq : caract ] ) if and only if @xmath80 . by using euler s formula @xmath81 , and by separating real and imaginary parts",
    ", we have @xmath82 with @xmath83 and @xmath84 . adding up the squares of both equations , we obtain that @xmath85 where @xmath86 , @xmath87 \\alpha_3 & = 2 \\tau_0 ( \\mu+c_1+c_2)+{a_3}^{2 } -2(a_3 \\tau_0+a_2 ) .",
    "\\end{split}\\ ] ] let @xmath88 .",
    "then ( [ eq : square ] ) becomes @xmath89 by the routh ",
    "hurwitz criterion , ( [ eq : square2 ] ) has no positive real roots if @xmath90 , @xmath91 , @xmath92 , and @xmath93 .    for the parameter values of table  [ table : parameters ] and @xmath94 ( @xmath95 ) , the routh",
    " hurwitz criterion does not hold .",
    "in fact , equation ( [ eq : square2 ] ) takes the form @xmath96 and we immediately see that the coefficient @xmath97 is not positive .",
    "moreover , the roots of equation ( [ eq : square : param ] ) are approximately @xmath98 , @xmath99 , @xmath100 , @xmath101 , therefore there exists a positive imaginary root given by @xmath102 .",
    "thus , there exists at least one time delay such that the disease free equilibrium is unstable .",
    "we have just proved the following result .",
    "let @xmath58 .",
    "then there exists at least one positive time delay @xmath76 such that the disease free equilibrium @xmath103 is unstable .",
    "[ obs1 ] observe that there may exist specific time delays for which the disease free equilibrium @xmath103 is locally asymptotically stable when @xmath58 . as we show next",
    ", this is the case for the time delay @xmath104 .",
    "indeed , consider the parameter values of table  [ table : parameters ] and @xmath105 such that @xmath58 .",
    "for example , let @xmath94 , for which @xmath95 .",
    "the results are given in figure  [ fig : statevar : dfe ] , where to compute the trajectories we have used the matlab routine ` dde23 ` , which solves delay differential equations with constant delays .",
    "for the theoretical results that underlie this solver we refer to @xcite .",
    "the characteristic equation ( [ eq : caract ] ) takes the form @xmath106 with @xmath107 the derivative @xmath108 has exactly four zeros : @xmath109 , @xmath110 , @xmath111 , and @xmath112 . for all @xmath113-\\infty , \\bar{\\lambda}_1[$ ] one",
    "has @xmath114 and since @xmath115 and @xmath116 , we conclude that there exists a unique @xmath117 in the interval @xmath118-\\infty , \\bar{\\lambda}_1[$ ] such that @xmath119 .",
    "analogously , we prove that there exists exactly five roots of @xmath106 : @xmath120 , @xmath121 , @xmath122 , @xmath123 , @xmath124 .",
    "we conclude that there are no positive real roots and that the disease free equilibrium @xmath103 is locally asymptotically stable for @xmath104 and the considered parameter values .",
    "in this paper we assume that the time delay @xmath77 associated to the diagnosis of active tb is equal to 0.1 , that is , 36.5 days .",
    "this value makes sense from the epidemiological point of view , since it fits in the intervals available in the literature for the delay in the diagnosis of active tb .",
    "for instance , in @xcite the reported overall patient delay is similar to the health system delay for diagnosis of active tb , 31.03 and 27.2 days , respectively .",
    "the average ( median or mean ) patient delay and health system delay range from 4.9 to 162 days and 2 to 87 days , respectively , in both low and middle income countries and high income countries .",
    "system ( [ tbmodel : delay : state ] ) has an unique endemic equilibrium such that @xmath125 for any @xmath126 .",
    "the analytic expression is cumbersome and not useful for our purposes .",
    "consider the parameter values from table  [ table : parameters ] with @xmath127 .",
    "then the basic reproduction number is @xmath128 . the endemic equilibrium @xmath129 is given by @xmath130 , @xmath131 , @xmath132 , @xmath133 .",
    "the matrices @xmath40 and @xmath45 associated to the linearized system ( [ model : linear : delay:4eq ] ) at the endemic equilibrium @xmath129 are computed as @xmath134\\ ] ] and @xmath135 .",
    "the transcendental characteristic equation is given by @xmath136 when @xmath69 , we have the following characteristic equation : @xmath137 the roots of ( [ eq : charac : ee : nui:0 ] ) are @xmath138 , @xmath139 , @xmath140 , @xmath141 .",
    "all the roots of ( [ eq : charac : ee : nui:0 ] ) have negative real part , thus the endemic equilibrium @xmath129 is asymptotical stable .",
    "consider now the case @xmath76 and suppose that ( [ eq : charac : ee ] ) has a purely imaginary root @xmath142 , with @xmath79 .",
    "separating the real and imaginary parts in ( [ eq : charac : ee ] ) , we have @xmath143 it is easy to verify that @xmath144 is a root of equation ( [ eq : charac : ee : nui : pos ] ) . thus , by rouch s theorem , there exists at least a time delay @xmath76 such that the endemic equilibrium @xmath129 is unstable . in the specific case @xmath104",
    ", the characteristic equation is given by @xmath145 similarly to remark  [ obs1 ] , it follows from bolzano s theorem and the monotonicity of the characteristic function associated to ( [ eq : carac : ee : nui:01 ] ) that all roots of equation ( [ eq : carac : ee : nui:01 ] ) have a negative real part .",
    "therefore , the endemic equilibrium @xmath129 is locally asymptotically stable for @xmath104 and @xmath60 .    .parameter values .",
    "[ cols= \" < , < , < \" , ]",
    "we now consider the tb model with a time delay in the state variable @xmath146 and introduce two control functions @xmath147 and @xmath148 and two real positive model constants @xmath149 and @xmath150 .",
    "the control @xmath151 represents the effort on early detection and treatment of recently infected individuals @xmath2 and the control @xmath152 represents the application of chemotherapy or post - exposure vaccine to persistent latent individuals @xmath4 .",
    "the parameters @xmath153 , @xmath154 , measure the effectiveness of the controls @xmath155 , @xmath154 , respectively , , these parameters measure the efficacy of post - exposure interventions for early and persistent latent tb individuals , respectively . since after tb infection",
    "the human immune system can take from 2 to 8 weeks to react , it takes at least the same time to detect the infection by the medical test @xcite .",
    "hence , we introduce a time delay @xmath156 in the control @xmath151 which represents the delay in the diagnosis of latent tb and commencement of latent tb treatment .",
    "the prophylactic treatment of persistent latent individuals may also suffer from a delay due to personal reasons of the patient , who may be resistant to treatment having spent more than two years with latent infection without passing to active disease , or the delay may be caused by priorities given to early latent and active infectious individuals from the health care system .",
    "based on these facts , for numerical simulations we shall consider the following delays with bounds on the control delays : @xmath157\\,.\\ ] ] the resulting model is given by the following system of nonlinear ordinary delay differential equations : @xmath158 \\dot{l_1}(t ) = \\frac{\\beta}{n } i(t)\\left ( s(t ) + \\sigma l_2(t ) + \\sigma_r r(t)\\right ) - \\left(\\delta + \\tau_1 + \\epsilon_1 u_1(t - d_{u_1 } ) + \\mu\\right)l_1(t),\\\\[0.3 mm ] \\dot{i}(t ) = \\phi \\delta l_1(t ) + \\omega l_2(t ) + \\omega_r r(t ) -",
    "\\tau_0 i(t - d_i ) - \\mu i(t),\\\\[0.3 mm ] \\dot{l_2}(t ) = ( 1 - \\phi ) \\delta l_1(t ) - \\sigma \\frac{\\beta}{n }",
    "i(t ) l_2(t ) - ( \\omega + \\epsilon_2 u_2(t - d_{u_2 } ) + \\tau_2 + \\mu)l_2(t )",
    ". \\end{cases}\\ ] ] recall that the recovered population is determined by @xmath159 , which formally gives the equation @xmath160 note , however , that this equation is not needed in the subsequent optimal control computations .",
    "we prescribe the following initial conditions for the state variables @xmath161 and , due to the delays , initial functions for the state variable @xmath3 and controls @xmath151 and",
    "@xmath152 : @xmath162 i(t ) = ( 5/120)n \\;\\ ; \\mbox{for } \\ ; -d_i \\leq t \\leq 0 , \\ ; u_k(t ) = 0   \\;\\ ; \\mbox{for } \\ ; -d_{u_k } \\leq t < 0 \\;\\ ; ( k=1,2 ) .",
    "\\end{array}\\ ] ] in the case @xmath163 of no control delays , the last condition is void .",
    "the following box constraints are imposed on the control variables : @xmath164 \\quad ( k=1,2).\\ ] ] let us denote the state and control variable of the control system , respectively , by @xmath165 and @xmath166 .",
    "we shall consider two types of objectives : either the @xmath167type objective @xmath168 which is linear in the control variable @xmath169 , or the @xmath170type objective @xmath171 which is quadratic in the control variable . in both objectives , @xmath172 , @xmath173",
    "are appropriate weights to be chosen later .",
    "@xmath170-type functionals like are often used in economics to describe , e.g. , productions costs , but are not appropriate in a biological framework ; cf .",
    "the remarks in @xcite .",
    "the @xmath167 functional @xmath174 incorporates the total amount of drug used as a penalty and thus appears to be more realistic .",
    "for that reason , we shall mainly focus on the functional @xmath174 .",
    "the optimal control problem then is defined as follows : determine a control function @xmath175,\\mathbb{r}^2)$ ] that _ minimizes _ either the cost functional @xmath174 in or @xmath176 in subject to the dynamic constraints , initial conditions and control constraints .",
    "necessary optimality conditions for optimal control problems with multiple time delays in control and state variables may be found , e.g. , in @xcite . here",
    ", we discuss the _ maximum principle _ in order to display the controls and the switching functions in a convenient way . to define the hamiltonian for the delayed control problem",
    ", we introduce the delayed state variable @xmath177 and the delayed control variables @xmath178 , @xmath179 . using the adjoint variable @xmath180 ,",
    "the hamiltonian for the objective @xmath181 and the control system is given by @xmath182 \\quad + \\lambda_{l_1 } ( \\frac{\\beta}{n } ( s + \\sigma l_2 + \\sigma_r r ) - ( \\delta + \\tau_1 + \\epsilon_1 v_1 + \\mu ) l_1)\\\\[1 mm ] \\quad + \\lambda_i ( \\phi \\delta l_1 + \\omega l_2 + \\omega_r r - \\tau_0 y_3 - \\mu i ) \\\\[1 mm ] \\quad + \\lambda_{l_2 } ( ( 1 - \\phi ) \\delta",
    "l_1- \\sigma \\frac{\\beta}{n } i l_2 - ( \\omega + \\epsilon_2 v_2 + \\tau_2 + \\mu)l_2 ) . \\end{array}\\ ] ] we obtain the adjoint equations @xmath183 $ ] , @xmath184 $ ] , @xmath185 $ ] , and @xmath186 + \\chi_{\\,[0,t - d_i]}\\ , h_{y_3}[t+d_i]$ ] , where subscripts denote partial derivatives and @xmath187}$ ] is the characteristic function in the interval @xmath188 $ ] @xcite .",
    "note that only the equation for @xmath189 contains the _ advanced _ time @xmath190 . since the terminal state @xmath191 is free , the transversality conditions are @xmath192 to characterize the optimal controls @xmath151 and",
    "@xmath152 , we introduce the following _ switching functions _ for @xmath179 : @xmath193 + \\chi_{\\,[0,t - d_{u_k}]}(t+d_{u_k})\\ ,   h_{v_k}[t+d_{u_k}]\\\\[1 mm ] & = \\ ; \\left\\ { \\begin{array}{lcl } -w_k - \\epsilon_k \\lambda_{l_k}(t+d_{u_k } )   l_k(t+d_{u_k } ) & \\mbox{for } & 0 \\leq t \\leq t - d_{u_k},\\\\[1 mm ] -w_k & \\mbox{for } &   t - d_{u_k } \\leq t \\leq t. \\end{array } \\right .",
    "\\end{array}\\ ] ] then the maximum condition for the optimal controls @xmath194 , @xmath195 is equivalent to the maximization @xmath196 , @xmath179 , which gives the control law @xmath197 0 & & \\mbox{if } \\quad \\phi_k(t ) < 0 ,   \\\\[1 mm ] { \\rm singular } & &   \\mbox{if } \\quad \\phi_k(t ) = 0 \\;\\ ; \\mbox{on } \\ ; i_s \\subset [ 0,t ] , \\end{array } \\right .",
    "\\quad k=1,2.\\ ] ] we do not discuss singular controls further , since both in the non - delayed and the delayed control problem we did not find singular arcs . in view of the transversality conditions , the terminal value of the switching function is @xmath198 for @xmath179 .",
    "hence , we may conclude from the control law that @xmath199 holds on a terminal interval .",
    "we choose the numerical approach `` first discretize then optimize '' to solve both the non - delayed and delayed optimal control problem .",
    "the discretization of the control problem on a fine grid leads to a large - scale nonlinear programming problem ( nlp ) that can be conveniently formulated with the help of the applied modeling programming language ampl @xcite .",
    "ampl can be linked to several powerful optimization solvers .",
    "we use the interior - point optimization solver ipopt developed by wchter and biegler @xcite .",
    "details of discretization methods for delayed control problems may be found in @xcite .",
    "the subsequent computations for the terminal time @xmath200 have been performed with @xmath201 to @xmath202 grid points using the trapezoidal rule as integration method .",
    "choosing the error tolerance @xmath203 in ipopt , we can expect that the state variables are correct up to @xmath204 or @xmath205 decimal digits .",
    "since lagrange multipliers are computed a posteriori in ipopt , we can not expect more than 6 correct decimal digits in the adjoint variables .",
    "also , the control package nudocccs developed by bskens @xcite ( cf . also @xcite ) provides a highly efficient method for solving the discretized control problem , because it allows to implement higher order integration methods .",
    "however , so far nudocccs can only be implemented for non - delayed control problems . for the non - delayed tb control problem",
    ", we obtained only bang - bang controls .",
    "an important feature of nudocccs is the fact that it provides an efficient method for optimizing the switching times of bang - bang controls using the arc - parametrization method @xcite .",
    "this approach is called the induced optimization problem ( iop ) for bang - bang controls .",
    "nudocccs then allows for a check of second - order sufficient conditions of the iop , whereby the second - order sufficient conditions for bang - bang controls can be verified with high accuracy ; cf .",
    "@xcite .",
    "first , we consider the optimal control of non - delayed tb model , where formally we put @xmath206 .",
    "the numerical solutions serve as reference solutions , which later will be compared with the solutions to the delayed control problem .",
    "we choose the weights @xmath207 in the objective ( [ j1-objective ] ) and the parameter @xmath127 ( @xmath208 ) in table  [ table : parameters ] .",
    "the discretization approach shows that controls @xmath209 are bang - bang and with only one switch at @xmath210 , @xmath179 : @xmath211 to obtain a refined solution , we solve the iop with respect to the switching times @xmath212 and @xmath213 using the arc - parametrization method @xcite and the code nudocccs @xcite .",
    "we get the following numerical results : @xmath214 the initial value of the adjoint variable @xmath215 is computed as @xmath216 the control and state trajectories are displayed in figure  [ label : of : fig:2 ] .",
    "objective and weights @xmath217 .",
    "_ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 .",
    "_ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 .",
    "_ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 . _",
    "top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ] +   objective and weights @xmath217 . _ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 .",
    "_ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3",
    ". _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 . _",
    "top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 ,",
    "( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=31.0% ]    the hessian @xmath222 of the lagrangian for the iop is positive definite : @xmath223 .",
    "it can be seen from figure  [ label : of : fig:2 ] , top row ( a ) and bottom row ( a ) , that the switching functions satisfy the strict bang - bang property ( cf .",
    "@xcite ) corresponding to the maximum principle : @xmath224 for @xmath225 , @xmath226 , @xmath227 for @xmath228 .",
    "hence , the bang - bang controls characterized by the data satisfies the second - order sufficient conditions in ( * ? ? ?",
    "* chap .  7 ) and thus provides a strict strong minimum .",
    "figure  [ label : of : fig:3 ] displays the comparison of the optimal controls for the functionals @xmath174 and @xmath176 .",
    "the state variables are nearly identical , since the control variables differ only a terminal interval .",
    "also the objective values are very close : @xmath229 , @xmath230 .",
    "note that the controls for @xmath176 are _ continuous _ , since the strict legendre ",
    "clebsch condition holds and the hamiltonian has a unique minimum .",
    "the proof , that second - order sufficient conditions ( ssc ) are satisfied for the controls corresponding to @xmath176 , is quite elaborated since it requires to test whether an associated matrix riccati equation has a bounded solution ; cf .",
    "@xcite .     and @xmath152 for the @xmath167-type objective and @xmath170-type objective with weights @xmath231.,title=\"fig:\",scaledwidth=40.0% ]   and @xmath152 for the @xmath167-type objective and @xmath170-type objective with weights @xmath231.,title=\"fig:\",scaledwidth=40.0% ]    when we increase the weights @xmath232 and @xmath233 , the control @xmath151 stays to be bang - bang with only one switching time which gets smaller , whereas the control @xmath152 may have an additional zero arc at the beginning .",
    "e.g. , for @xmath234 we obtain the controls @xmath235 the objective value and the switching times are computed as @xmath236 , @xmath237 , @xmath238 , and @xmath239 .",
    "the optimal controls are shown in figure  [ label : of : fig:4 ] .     and @xmath152 for the @xmath167-type objective with weights @xmath240.,title=\"fig:\",scaledwidth=40.0% ]    and @xmath152 for the @xmath167-type objective with weights @xmath240.,title=\"fig:\",scaledwidth=40.0% ]      to see more distinctively the difference between delayed and non - delayed solutions , we consider state and control delays with values at their upper bounds in , that is , @xmath104 , @xmath241 , and @xmath242 .",
    "again , we choose the weights @xmath207 in the objective ( [ j1-objective ] ) and the parameter @xmath127 in table  [ table : parameters ] , for which @xmath208 .",
    "the discretization approach with @xmath202 grid points and the trapezoidal rule as integration method yields the following bang - bang controls with only one switch as in the non - delayed case : @xmath243 we obtain the numerical results @xmath244 , @xmath245 , @xmath246 , @xmath247 , @xmath248 , @xmath249 , @xmath250 , and @xmath251 .",
    "however , in contrast to the non - delayed case , we are not able to optimize the switching times directly because the time - transformation in the arc - parametrization method @xcite can not be applied to the delayed problem . the initial value of the adjoint variable is computed as @xmath252 . when comparing the results for the delayed problem with those in for the non - delayed problem , we notice the surprising fact that the terminal values @xmath253 , @xmath254 , @xmath255 and the switching times @xmath212 , @xmath213 are significantly smaller in the delayed problem on the expense that the terminal value @xmath256 is significantly higher .",
    "-objective , @xmath217 and delays @xmath257 .",
    "_ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=32.0% ] -objective , @xmath217 and delays @xmath257 . _ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=29.0% ] -objective , @xmath217 and delays @xmath257 . _ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=29.0% ] + -objective , @xmath217 and delays @xmath257 . _ top row _ : ( a )",
    "control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=32.0% ] -objective , @xmath217 and delays @xmath257 .",
    "_ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=30.0% ] -objective , @xmath217 and delays @xmath257 . _ top row _ : ( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) susceptible individuals @xmath1 and recovered individuals @xmath5 , ( c ) infectious individuals @xmath3 . _ bottom row _ : ( a ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221 , ( b ) early latent @xmath2 , ( c ) persistent latent @xmath4.,title=\"fig:\",scaledwidth=30.0% ]    as in the non - delayed problem , the switching functions satisfy the strict bang - bang property related to the maximum principle : @xmath258 however , we are not aware in the literature of any type of _ sufficient conditions _ which could be applied to the extremal solution shown in figure  [ label : of : fig:5 ] .",
    "we also compared the extremal solutions for the @xmath167-type objective and the @xmath170-type objective .",
    "since the controls are very similar to those in figure  [ label : of : fig:3 ] , they are not displayed here .",
    "figure  [ label : of : fig:6 ] shows the extremal controls for the @xmath167-objective for the increased weights @xmath259 .",
    "objective , @xmath259 and delays @xmath260 , @xmath261 .",
    "( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 , ( b ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221.,title=\"fig:\",width=196,height=143 ]   objective , @xmath259 and delays @xmath260 , @xmath261 .",
    "( a ) control @xmath151 and ( scaled ) switching function @xmath218 satisfying the control law for @xmath219 ,",
    "( b ) control @xmath152 and ( scaled ) switching function @xmath220 satisfying the control law for @xmath221.,title=\"fig:\",width=196,height=143 ]    the most significant influence on the optimal controls is exerted by the transmission coefficient @xmath105 .     and",
    "@xmath262 in the delayed tb model with @xmath167 objective , weights @xmath259 and delays @xmath257.,title=\"fig:\",width=196,height=151 ]   and @xmath262 in the delayed tb model with @xmath167 objective , weights @xmath259 and delays @xmath257.,title=\"fig:\",width=196,height=151 ]    it can be clearly seen that the increase of the transmission coefficient @xmath105 triggers a substantial increase in the switching times @xmath210 of the bang - bang controls @xmath263 for @xmath179 ( cf .",
    "figure  [ label : of : fig:7 ] ) as could be expected from the equation for @xmath264 .",
    "let us perform in this case a more detailed sensitivity analysis of the trajectories with respect to the parameter @xmath265 $ ] .",
    "we compute the extremal solutions for a sufficiently fine grid of parameters @xmath265 $ ] by a homotopy method and plot the objective @xmath174 and the terminal state @xmath266 as a function of @xmath105 .",
    "the numerical results are shown in figure  [ label : of : fig:8 ] .",
    "objective and weights @xmath217 for parameters @xmath265 $ ] . displayed",
    "are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 for parameters @xmath265 $ ] .",
    "displayed are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 for parameters @xmath265 $ ] .",
    "displayed are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ] +   objective and weights @xmath217 for parameters @xmath265 $ ] .",
    "displayed are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 for parameters @xmath265 $ ] .",
    "displayed are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ]   objective and weights @xmath217 for parameters @xmath265 $ ] .",
    "displayed are the objective value @xmath174 and the terminal states @xmath256 , @xmath267 , @xmath254 , @xmath253 , @xmath255.,title=\"fig:\",scaledwidth=31.0% ]",
    "we introduced a discrete time delay @xmath77 in a mathematical model for tuberculosis ( tb ) , which represents the delay on the diagnosis of active tb infection and commencement of treatment .",
    "the delay on the diagnosis of active tb has important negative consequences on tb control and eradication .",
    "the later the treatment of active tb starts , the more people can be infected and may die from tb .",
    "the introduction of a time delay on the state variable of active tb infected individuals @xmath3 is therefore justified from the epidemiological point of view .",
    "when a time delay is introduced into a mathematical model , the stability of its disease free and endemic equilibriums may change .",
    "we proved that the disease free equilibrium ( dfe ) of the tb model with delay in the state variable @xmath3 is unstable for any time delay @xmath56 , whenever the basic reproduction number is greater than one .",
    "we derived conditions under which the model is locally asymptotically stable for @xmath69 and proved that there exists at least one positive time delay @xmath76 such that the dfe is unstable for @xmath58 . despite of this",
    ", we also proved that for the concrete time delay @xmath104 , the set of parameters of table  [ table : parameters ] , and a transmission coefficient for which @xmath58 , the dfe is locally asymptotically stable .",
    "the value @xmath104 ( 36.5 days ) fits the data reported in the literature for the delay in the diagnosis of active tb . for the endemic equilibrium ( ee )",
    ", we considered that the transmission coefficient @xmath105 is such that @xmath60 and proved the local stability of the specific ee associated to our set of parameters and discrete time delay @xmath104 .",
    "we proposed an optimal control problem where the control system is the mathematical model for tb with time delay in the state variable @xmath3 and where the control functions @xmath151 and @xmath152 represent , respectively , the effort on early detection and treatment of recently infected individuals @xmath2 , and the application of prophylactic treatment to persistent latent individuals @xmath4 .",
    "the objective is to minimize the number of individuals with active and persistent latent tb as well as the cost associated to the implementation of the control measures .",
    "human immune system can take from two to eight weeks to react to tb infection and detection . moreover , prophylactic treatment of early and persistent latent individuals may face resistance from patients and health care services . based on these facts , we introduced discrete time delays in the controls @xmath151 and @xmath152 . to our knowledge , this is the first time an optimal control problem for tb with delays in the state and control variables is investigated .",
    "firstly , we considered the non - delayed case ( @xmath268 ) and compared the solutions for @xmath167 and @xmath170 objectives .",
    "our results show that the optimal state variables are nearly identical for both objectives , the control variables differing only on a terminal interval .",
    "the optimal values of the objective functionals are also very close .",
    "we observed that for the @xmath167 objective the optimal control @xmath152 may have an additional zero arc at the beginning if the weight constants associated to the implementation of the control policies @xmath151 and @xmath152 are big enough .",
    "for the delayed optimal control problem , our focus was on the @xmath167 objective since it seems to be the more realistic and , comparing the extremal solutions of @xmath167 and @xmath170 objectives , the differences are similar to the non - delayed case . in the delayed case , the switching times @xmath212 and @xmath213 are significantly smaller and the costs are also smaller , when compared to the non - delayed case . from an epidemiological point of view , when we introduce delays in the tb model , the optimal solutions for the reduction of the number of individuals with active and persistent latent tb infection are associated to control policies that are less costly and can be implemented in a shorter period of time .",
    "associated to these positive facts , we observed that if a delay is introduced in the state variable @xmath3 and in the controls , the number of individuals with active tb infection at the end of five years is reduced in approximately 45.2 per cent , when compared to the non - delayed case .",
    "similarly , the number of persistent latent individuals at the end of five years is also reduced in approximately 60.1 per cent .",
    "moreover , the terminal number of susceptible and recovered individuals is bigger in the delayed case . through a sensitivity analysis",
    ", we observed that the transmission coefficient @xmath105 has a significant influence on the optimal controls and the cost functional , and that the number of active infected individuals and the number of early and persistent latent individuals also increase with @xmath105 .",
    "the number of recovered individuals increases for @xmath269 $ ] and decreases for @xmath270 $ ] , which means that for @xmath271 the control measures are no longer effective and should be rethought .",
    "this work was partially supported by fct within project toccata , reference ptdc / eei - aut/2933/2014 .",
    "silva and torres were also supported by cidma and project uid / mat/04106/2013 ; silva by the post - doc grant sfrh / bpd/72061/2010 .",
    "the authors are very grateful to anonymous reviewers for their careful reading and helpful comments .",
    "( mr1781710 ) [ 10.1016/s0377 - 0427(00)00305 - 8 ] c. bskens and h. maurer , sqp methods for solving optimal control problems with control and state constraints : adjoint variables , sensitivity analysis and real - time control , _ j. comput",
    "_ , * 120 * ( 2000 ) , 85108 .              ( mr3124697 ) [ 10.3934/jimo.2014.10.413 ] l. gllmann and h. maurer , theory and applications of optimal control problems with multiple time - delays , special issue on computational methods for optimization and control , _ j. ind",
    "_ , * 10 * ( 2014 ) , 413441 .",
    "( mr2899084 ) [ 10.1016/j.jtbi.2007.06.005 ] m.  g.  m.  gomes , p.  rodrigues , f.  m.  hilker , n.  b.  mantilla - beniers , m.  muehlen , a.  c.  paulo and g.  f.  medley , implications of partial immunity on the prospects for tuberculosis control by post - exposure interventions , _ j. theoret .",
    "_ , * 248 * ( 2007 ) 608617 .            (",
    "mr2150512 ) [ 10.1002/oca.756 ] h. maurer , c. bskens , j .- h.r .",
    "kim and y. kaya , optimization methods for the verification of second order sufficient conditions for bang - bang controls , _ optimal control appl . methods _ , * 26 * ( 2005 ) , 129156 .",
    "( mr3012263 ) [ 10.1137/1.9781611972368 ] n. p.",
    "osmolovskii and h. maurer , _ applications to regular and bang - bang control : second - order necessary and sufficient optimality conditions in calculus of variations and optimal control _ , siam advances in design and control , vol . dc 24 , siam publications , philadelphia , 2012 .",
    "( mr3266821 ) [ 10.1007/s11538 - 014 - 0028 - 6 ] p.  rodrigues , c.  j.  silva and d.  f.  m.  torres , cost - effectiveness analysis of optimal control measures for tuberculosis , _ bull .",
    "_ , * 76 * ( 2014 ) , 26272645 .",
    "( mr3275020 ) [ 10.3934/dcdsb.2014.19.2657 ] h. schttler , u. ledzewicz and h. maurer , sufficient conditions for strong local optimality in optimal control problems with @xmath170-type objectives and control constraints , _ discrete contin .",
    "* 19 * ( 2014 ) , 26572679 .      ( mr2970904 ) [ 10.3934/naco.2012.2.601 ] c. j. silva and d. f. m. torres , optimal control strategies for tuberculosis treatment : a case study in angola , _ numer .",
    "algebra control optim .",
    "_ , * 2 * ( 2012 ) , 601617 .",
    "[ 10.1186/1471 - 2334 - 9 - 91 ] c.  t.  sreeramareddy , k.  v.  panduru , j.  menten and j. van den ende , time delays in diagnosis of pulmonary tuberculosis : a systematic review of literature , _ bmc infectious diseases _ , * 9 * ( 91 ) ( 2009 ) , 10  pp .          ( mr1950747 ) [ 10.1016/s0025 - 5564(02)00108 - 6 ] p.  van den driessche and j.  watmough , reproduction numbers and subthreshold endemic equilibria for compartmental models of disease transmission , _ math .",
    "_ , * 180 * ( 2002 ) , 2948 .",
    "( mr3356544 ) [ 10.3934/dcdsb.2015.20.1573 ] h.  yang and j.  wei , global behaviour of a delayed viral kinetic model with general incidence rate , _ discrete contin .",
    "b _ , * 20 * ( 2015 ) , 15731582 .",
    "( mr2195616 ) [ 10.1007/s10107 - 004 - 0559-y ] a. wchter and l. t. biegler , on the implementation of an interior - point filter line - search algorithm for large - scale nonlinear programming , _ math",
    ". program .",
    "_ , * 106 * ( 2006 ) , 2557 ."
  ],
  "abstract_text": [
    "<S> we introduce delays in a tuberculosis ( tb ) model , representing the time delay on the diagnosis and commencement of treatment of individuals with active tb infection . </S>",
    "<S> the stability of the disease free and endemic equilibriums is investigated for any time delay . corresponding optimal control problems , with time delays in both state and control variables , are formulated and studied . </S>",
    "<S> although it is well - known that there is a delay between two to eight weeks between tb infection and reaction of body s immune system to tuberculin , delays for the active infected to be detected and treated , and delays on the treatment of persistent latent individuals due to clinical and patient reasons , which clearly justifies the introduction of time delays on state and control measures , our work seems to be the first to consider such time - delays for tb and apply time - delay optimal control to carry out the optimality analysis .    </S>",
    "<S> cristiana j. silva    helmut maurer@xmath0    delfim f. m. torres </S>"
  ]
}