{
  "article_text": [
    "consider a finite set of particles or points in @xmath0 , moving in time along continuous trajectories .",
    "interpreting these points as the centers of moving objects , we are interested in the topological changes the configuration undergoes .",
    "our interest in this problem originates in a sorting process that segregates cells during zebrafish development , as studied by heisenberg and krens @xcite .",
    "the sorting process operates on intermixed configurations of cells in which different types have different physical properties .",
    "one example is a mix of two cell types , in which the cells of the first type have a strong preference for neighboring cells of the same type and a strong dislike of exposed boundary , while the cells of the second type have milder preferences and dislikes .",
    "the typical outcome is that the cells of the first type form a ball - like shape that is engulfed by a spherical shell consisting of cells of the second type .    in an effort to formalize the sorting process and to make it amenable to detailed and objective measurements , heisenberg , krens , and the authors of this paper introduced the _ restricted voronoi medusa _ as a mathematical representation .",
    "it is a geometric body in @xmath1-dimensional space - time obtained by stacking up restricted voronoi regions in @xmath0 @xcite . at any moment in time ,",
    "the voronoi region of a particle is intersected with a ball , and the resulting bodies are glued together to form a @xmath1-dimensional structure .",
    "applying persistent homology to the time function on this structure yields fine - grained information about the sorting process that is difficult to observe directly .",
    "this paper complements this foundational work with a description of the computational aspects of the medusa construction .",
    "[ [ results . ] ] results .",
    "+ + + + + + + +    @xcite proves that the restricted voronoi medusa has the same homotopy type as the medusa obtained by stacking up simplices in the corresponding alpha complex .",
    "the latter _ alpha medusa _ is combinatorial in nature , which has computational advantages .",
    "continuing in this direction , this paper makes three contributions :    1 .",
    "we describe an algorithm that maintains a fixed - radius alpha complex for points moving on piecewise algebraic trajectories in @xmath0 .",
    "the algorithm supports insertions and deletions of points and allows for piecewise algebraic trajectories . 2 .",
    "maintaining an alpha complex , we construct the alpha medusa whose geometric and topological properties reflect the events during the sorting process .",
    "we convert the kinetic algorithm and the medusa construction into robust and efficient software . basing the implementation on the cgal package for kinetic data structures by daniel russel @xcite , it achieves correctness through the exact geometric computation paradigm .",
    "part of contribution 1 is an extension of previous work from kinetic delaunay triangulations to kinetic alpha complexes , which is of independent interest .",
    "the requirement of correctly comparing algebraic numbers , without tolerance for inaccuracy or approximation in contribution 3 seriously slows down the software , even for piecewise - linear trajectories . to counteract , we introduce techniques that speed - up the computations without sacrificing their correctness .",
    "we evaluate the effectivity of these techniques experimentally .",
    "[ [ outline . ] ] outline .",
    "+ + + + + + + +    section [ sec2 ] explains background from computational geometry and topology .",
    "section [ sec3 ] describes the kinetic algorithm for fixed - radius alpha complexes .",
    "section [ sec4 ] explains the algorithm that constructs the medusa of a set of moving cells .",
    "section [ sec5 ] describes techniques to speed up the computations .",
    "section [ sec6 ] concludes the paper .",
    "we review the fundamental geometric data structures that are required in this work .",
    "voronoi tessellations and delaunay triangulations are treated in most computational geometry textbooks , including @xcite , and alpha complexes are described in @xcite . for the most part , the discussion focuses on the @xmath2-dimensional case .",
    "most definitions and properties extend to higher dimensions as well as to the plane .",
    "we will exploit the latter fact when we draw illustrations .",
    "[ [ cell - complexes . ] ] cell complexes .",
    "+ + + + + + + + + + + + + + +    we recall that a _ @xmath3-simplex _ is the convex hull of an affinely independent set of @xmath4 points in some euclidean space .",
    "face _ is a simplex defined by a subset of the @xmath4 points .",
    "it is _ proper _ if the subset is different from the set . reversing the direction , we call the @xmath3-simplex a _ coface _ of its face . we define a _ simplicial complex _ as a finite collection of simplices that is closed under the face relation , with the additional property that any two simplices in the collection are either disjoint or their intersection is a face of both .",
    "the _ boundary _ of a @xmath3-simplex is the collection of its @xmath5-faces .",
    "the simplices of dimension @xmath6 , @xmath7 , @xmath8 , and @xmath2 are referred to as _ vertices _ , _ edges _ , _ triangles _ , and _",
    "tetrahedra_. the _ star _ of a @xmath3-simplex is the set of simplices that contain the @xmath3-simplex as a face . noting that the star is in general not closed under the face relation , we define the _ closed star _ as the set of all simplices in the star and of all faces of these simplices .",
    "it is the smallest simplicial complex that contains the star . finally , if @xmath9 is a @xmath3-simplex and @xmath10 is a point that does not lie in the @xmath3-plane of the simplex , then the _ join _ , denoted as @xmath11 , is the @xmath12-simplex that is the convex hull of @xmath10 and the vertices of @xmath9 .",
    "it is convenient to also introduce an abstract counterpart to the above geometric concept of a simplicial complex .",
    "specifically , an _ abstract simplicial complex _ consists of a finite set of ( abstract ) elements and a collection of subsets that is closed under the subset relation .",
    "we may map each element to a point in some euclidean space , and each subset to the convex hull of the points that correspond to its elements .",
    "if the dimension of the space is sufficiently high and the points are well chosen , this is a simplicial complex , which we refer to as a _ geometric realization _ of the abstract simplicial complex .",
    "here is an example of this construction .",
    "consider a finite set , @xmath13 , of possibly overlapping bodies , and define the _ nerve _ as the collection of subsets of @xmath13 with non - empty common intersection .",
    "we note that the nerve is an abstract simplicial complex . indeed , the bodies are the elements , and if @xmath14 is a set in the nerve , then every subset of @xmath15 is also in the nerve .",
    "a useful result is the nerve theorem @xcite , which states that if the bodies in @xmath13 are convex then every geometric realization of the nerve has the same homotopy type as the union of the bodies .",
    "intuitively , this means that one can be transformed into the other by continuous transformations like bending , shrinking , and expanding , but without gluing and cutting .",
    "most complexes in this paper will be constructed using the nerve operation .",
    "we will have occasion to also use complexes that are more general than simplicial complexes . instead of @xmath3-simplices ,",
    "they contain _",
    "@xmath3-cells _ , which are homeomorphic to the @xmath3-dimensional unit ball .",
    "the _ boundary _ of a @xmath3-cell is the homeomorphic image of the @xmath5-sphere that bounds the @xmath3-ball .",
    "we define a _ cell complex _ as a finite collection of cells with pairwise disjoint interiors such that the boundary of each @xmath3-cell is a union of @xmath5-cells in the complex .",
    "[ [ voronoi - tessellations - and - delaunay - complexes . ] ] voronoi tessellations and delaunay complexes .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider now a finite set of points , @xmath16 , in @xmath0 .",
    "the _ voronoi region _ of a point @xmath10 in @xmath16 is the set of points @xmath17 that have @xmath10 as the closest point in @xmath16 : @xmath18 note that @xmath19 is convex .",
    "we usually drop @xmath16 from the notation .",
    "the _ voronoi tessellation _ of @xmath16 is the set of voronoi regions of its points .",
    "while it is not a cell complex formally , we get a cell complex if we add the common intersections of voronoi regions as lower - dimensional cells to the set .",
    "if the points in @xmath16 are in general position , by which we mean that no four lie in a common plane and no five lie on a common sphere , then the voronoi regions intersect in a rather predictable pattern .",
    "specifically , the intersection of any two is either empty or a ( @xmath8-dimensional ) polygon , the intersection of any three is either empty or a ( @xmath7-dimensional ) edge , and the intersection any four is either empty or a ( @xmath6-dimensional ) point .",
    "furthermore , the intersection of five or more voronoi regions is necessarily empty .    we get the dual _ delaunay complex _ if we replace each non - empty intersection of voronoi regions by the convex hull of the points that generate the voronoi regions containing the intersection .",
    "equivalently , we may define the delaunay complex as the set of convex hulls of subsets of points that have the _ empty sphere property_. specifically , this means that there exists a sphere that passes through the points of the subset and all other points in @xmath16 lie strictly outside this sphere .",
    "we note that the center of this sphere belongs to the intersection of the corresponding voronoi regions . assuming general position",
    ", the delaunay complex is a simplicial complex , which is generally referred to as the _ delaunay triangulation_. it is a geometric realization of the nerve of the voronoi tessellation .",
    "[ [ restricted - voronoi - tessellations - and - alpha - complexes . ] ] restricted voronoi tessellations and alpha complexes .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    fixing a positive radius , @xmath20 , we define the _ restriction _ of a voronoi region to be its intersection with the closed ball of radius @xmath20 centered at the generating point : @xmath21 again , we usually drop @xmath16 from the notation .",
    "the _ restricted voronoi tessellation _ of @xmath16 is the set of restricted voronoi regions of its points .",
    "in contrast to the unrestricted case , each restricted voronoi region is bounded , and the tessellation covers only the union of balls and not the entire space .    as before , we assume general position so we can dualize by geometrically realizing the nerve . the resulting simplicial complex",
    "is called the _ alpha complex_. since @xmath22 , for each point @xmath10 in @xmath16 , the alpha complex is a subcomplex of the delaunay triangulation .",
    "next , we derive an equivalent condition for a delaunay simplex to lie in the alpha complex which is more suitable for computations .",
    "each @xmath3-simplex in the delaunay triangulation has a unique circumscribed @xmath5-sphere in its supporting @xmath3-plane .",
    "we call its center the _ circumcenter _ , its radius the _ circumradius _ , the ball in @xmath0 with this center and this radius the _ circumball _ , and the sphere that bounds the circumball the _ circumsphere _ of the @xmath3-simplex . note that the circumsphere is the smallest sphere that passes through the vertices of the @xmath3-simplex .",
    "we call the @xmath3-simplex _ short _ if its circumradius is smaller than or equal to @xmath20 .",
    "finally , we call the @xmath3-simplex _ gabriel _ if its circumball has no point of @xmath16 in its interior .",
    "a simplex in the delaunay triangulation of @xmath16 belongs to the alpha complex , for radius @xmath20 , iff it is short and gabriel , or it is the face of another delaunay simplex that is short and gabriel .",
    "the face of a short simplex is necessarily short , but the face of a gabriel simplex is not necessarily gabriel .",
    "it follows that all simplices in the alpha complex are short , but not all simplices need to be gabriel .",
    "also note that a tetrahedron is in the delaunay triangulation iff it is gabriel ; therefore , it is in the alpha complex iff it is short . in our application , we use the restricted voronoi tessellation to model a set of biological cells for which the positions of their nuclei are known .",
    "indeed , a cell tends to minimize its surface area and usually does not grow larger than a certain size .",
    "therefore , a restricted voronoi region appears to be a good approximation of the actual cell shape and is still simple enough for our computational purposes .",
    "in this section , we describe the algorithm that maintains the alpha complex for a fixed radius @xmath23 .",
    "we pay particular attention to the certificates that govern the sequence of operations needed to preserve the correctness of the structure at all times .",
    "[ [ the - kinetic - framework . ] ] the kinetic framework .",
    "+ + + + + + + + + + + + + + + + + + + + + +    the input to our algorithm is a finite set of trajectories , each a continuous map @xmath24 \\to { { \\ifmmode{{\\mathbb r}}\\else{\\mbox{\\({\\mathbb r}\\)}}\\fi}}^3 $ ] with @xmath25 . for simplicity , we assume it to be piecewise linear , with @xmath26 such that there are points @xmath27 for which @xmath28 for @xmath29 . in other words , we can write @xmath30 such that between @xmath31 and @xmath32 , each @xmath33 is a polynomial of degree @xmath7 .",
    "we call @xmath34 the _ bending events _ of the trajectory .",
    "furthermore , we assume that the trajectories do not meet each other , that is , @xmath35 for all @xmath36 and all @xmath37 for which both trajectories are defined .",
    "our task is to maintain a data structure that goes from an initial configuration , at time @xmath38 , to the final configuration , at time @xmath39 .",
    "for that , the data structure is constructed at time @xmath38 , and maintained through a sequence of update operations until the final configuration is reached .",
    "it is assumed that the number of updates is finite , and we call the time of an update an _ event_. events are detected by defining suitable _ certificate functions _ , also referred to as _ certificates_. at any moment @xmath37 different from any event , we have a collection of _ active _ certificates , all being non - zero at @xmath37 .",
    "importantly , they guarantee that as long as no certificate changes its sign , our data structure remains structurally unchanged . to detect the next event",
    ", the algorithm then finds the smallest root of any active certificate that is greater than @xmath37 .",
    "it handles the event by updating the data structure and the collection of active certificates . throughout this paper",
    ", we make the simplifying assumption that all events are distinct , that is , no two events happen at the same moment in time ; see also section [ sec6 ] .",
    "[ [ maintaining - the - delaunay - triangulation . ] ] maintaining the delaunay triangulation . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    since we need it later , we begin by reviewing the kinetic algorithm for @xmath2-dimensional delaunay triangulations described in @xcite . besides changes brought about by insertions and deletions of points , and switches to new trajectory segments ,",
    "there are only two configurations that trigger a structural change in the triangulation :    * five points of @xmath16 lie on a common sphere , and the open ball bounded by this sphere contains no points of @xmath16 ; * four points of @xmath16 lie on a common plane , and one of the open half - spaces bounded by this plane contains no points of @xmath16 .",
    "we call each such configuration a _",
    "degeneracy_. consistent with the above assumption of distinct events , we assume that at every moment of time there is only one degeneracy , and that each degeneracy lasts only for a single moment .",
    "in other words , we can find a small open interval in time during which the given degeneracy exists at a single point in time , and it is the only degeneracy that occurs during this interval .",
    "we can therefore study the effect of the degeneracy by considering the non - degenerate local configurations right before and right after the degeneracy .",
    "consider for example a degeneracy of the first type , which involves five points .",
    "right before the degeneracy , the five points span two delaunay tetrahedra with a common triangle , and right after the degeneracy they span three tetrahedra so that each pair shares a triangle and all three share an edge .",
    "of course , it can also be the other way round .",
    "importantly , we can transform one configuration to the other by flipping . in this particular case",
    ", we substitute three for two or two for three tetrahedra , calling the operation a _ @xmath8-@xmath2-flip _ ; see figure [ fig:2 - 3-flip ] .",
    "-@xmath2-flip that alters the triangulation of a triangular double pyramid . on the left ,",
    "the five points span two tetrahedra meeting in a triangle . after the flip ,",
    "the triangle is replaced by an edge and the three incident triangles that connect the edge to the remaining three points.,width=264 ]    to avoid a case analysis , we represent the triangulation using a vertex at infinity that is joined to every simplex in the boundary of the convex hull of @xmath16 .",
    "effectively , we embed the triangulation on a @xmath2-sphere . this way , we can add the point at infinity to the set of four points forming a degeneracy of the second type , thus getting a degeneracy of the first type , which is handled by a @xmath8-@xmath2-flip , as described above .",
    "[ [ flip - events . ] ] flip events . + + + + + + + + + + + +    the transition of the delaunay triangulation across degenerate configurations is controlled by two certificate functions .",
    "let @xmath40 be the five trajectories of the points that span two tetrahedra sharing a triangle or three tetrahedra sharing a common edge , as in figure [ fig:2 - 3-flip ] .",
    "if one of the trajectories belongs to the infinite vertex then we reorder them such that this trajectory is @xmath41 .",
    "let @xmath42 be the coordinate functions of the finite points , and recall that the squared norm of this point is the sum of the squares of its three coordinates .",
    "if all five points are finite , we create the certificate @xmath43 ,    \\label{eqn : flipa}\\end{aligned}\\ ] ] which is a univariate polynomial in @xmath37 that is zero iff the five points are co - spherical .",
    "assuming the coordinate functions are linear , the degree of the polynomial is @xmath44 .",
    "if the fifth point is at infinity , we create the certificate @xmath45 ,    \\label{eqn : flipb}\\end{aligned}\\ ] ] which is zero iff the four point are coplanar .",
    "we call the polynomials in ( [ eqn : flipa],[eqn : flipb ] ) _ flip certificates _ and their roots _ flip events_.    after having constructed the initial certificates , at time @xmath46 , the algorithm finds the first positive flip event .",
    "it then performs a @xmath8-@xmath2-flip , creating certificates for the ( new ) simplices inside the double pyramid , and updating the certificates of the simplices in the boundary of the double pyramid .",
    "the updating is necessary because the star of each boundary simplex changes during the flip .",
    "after these steps , both data structure and certificates are again valid , and the iteration continues with the next flip event .",
    "[ [ radius - events . ] ] radius events .",
    "+ + + + + + + + + + + + + +    next , we extend the kinetic algorithm from delaunay triangulations to alpha complexes . as before , we use a fixed radius @xmath23 .",
    "we represent the alpha complex by equipping each delaunay simplex with a flag that indicates whether or not the simplex belongs to the alpha complex . to construct these flags at time @xmath46",
    ", we check every delaunay simplex for being short and for being gabriel . following the short&gabriel lemma in section [ sec2 ] ,",
    "we add all delaunay simplices that are short and gabriel , as well as all their faces , to the alpha complex .",
    "to maintain the flags , we construct a certificate for each edge , triangle , and tetrahedron whose roots are the times when the circumradius of the simplex equals @xmath20 . to simplify the discussion , we assume the generic case in which the circumradius changes from strictly smaller to strictly larger than @xmath20 , or vice versa .",
    "we call these functions _ radius certificates _ and their roots _ radius events_. whenever a delaunay simplex is inserted or deleted , the algorithm also creates or removes the corresponding radius certificate .",
    "the certificate of an edge compares the length to @xmath47 , and taking squares , we get a polynomial of degree @xmath8 .",
    "the radius certificates of a triangle and a tetrahedron are more complicated , but can be derived from suitable minors of the matrix that defines the circumsphere of the simplex ; see @xcite for the formula in the tetrahedral case .",
    "we will discuss the triangle case in section [ sec5 ] .",
    "after initializing the alpha complex and the certificates , the algorithm looks for the next event .",
    "if this is a flip event , we proceed as described above .",
    "in addition , we update the flags that identify the alpha complex as a subcomplex of the delaunay triangulation . because all tetrahedra involved in the @xmath8-@xmath2-flip",
    "have the same circumsphere , they are either all short or all non - short . if they are short , all new delaunay simplices are added to the alpha complex , and otherwise , none of them is added to the alpha complex .",
    "second , consider the case in which the next event is a radius event .",
    "let @xmath9 be the corresponding delaunay simplex .",
    "if @xmath9 goes from non - short to short , then its proper cofaces are necessarily non - short .",
    "we check whether @xmath9 is also gabriel , noting that this is always the case if @xmath9 is a tetrahedron .",
    "if so , @xmath9 is added to the alpha complex together will all its faces . on the other hand ,",
    "if @xmath9 goes from short to non - short , then its proper faces are necessarily short .",
    "we remove @xmath9 from the alpha complex , unless is was not in the complex even before the event .",
    "if the event causes the deletion of @xmath9 from the alpha complex , then this may have consequences for its faces .",
    "in particular , if @xmath9 was the last proper coface of @xmath48 in the alpha complex , and @xmath48 is not gabriel , then @xmath48 is also deleted from the alpha complex . afterwards , the algorithm continues with the next event .",
    "[ [ redundancy - of - gabriel - events . ] ] redundancy of gabriel events .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    perhaps surprisingly , flip and radius events suffice to maintain the alpha complex .",
    "flip certificates monitor when tetrahedra become non - delaunay , and radius events monitor when simplices become short or non - short .",
    "we do not need certificates that monitor when simplices become gabriel or non - gabriel . to understand",
    "why such certificates are not necessary , we call a time @xmath37 _ g - critical _ for a simplex @xmath9 , if at that time , @xmath9 changes from gabriel to non - gabriel , or vice versa .",
    "let @xmath37 be a g - critical time for a short delaunay edge or triangle .",
    "then this edge or triangle has a proper coface that is in the alpha complex at time @xmath37 .",
    "denote the edge or triangle by @xmath9 and consider its circumball , @xmath49 , at time @xmath37 .",
    "no point of @xmath16 lies in the interior of @xmath49 , but there is a point @xmath10 on the bounding sphere that is not a vertex of @xmath9 .",
    "the join @xmath11 is another simplex in the delaunay triangulation , and it is a proper coface of @xmath9 .",
    "it has the same circumball as @xmath9 , which implies that @xmath11 is short and gabriel and therefore belongs to the alpha complex at time @xmath37 .",
    "the lemma implies that when a short edge or triangle changes its gabriel status , it is a face of a simplex in the alpha complex .",
    "the status change has therefore no impact on its membership in the alpha complex .",
    "[ [ other - events . ] ] other events . + + + + + + + + + + + + +    for later reference , we briefly mention the remaining types of events supported by our algorithm .",
    "first , we consider a bending event , at which a trajectory starts a new segment .",
    "such an event leaves the alpha complex unchanged , but all flip and radius certificates that involve the coordinates of the corresponding vertex are recomputed .",
    "these are the certificates associated to the simplices in the closed star of the vertex .",
    "second , we allow for insertions and deletions of points .",
    "the two operations are mostly symmetric , and we only discuss the insertion of a point @xmath10 .",
    "we add @xmath10 to the delaunay triangulation by identifying all tetrahedra whose circumballs contain @xmath10 , referring to their union as the _ conflict region _ of @xmath10 .",
    "since these tetrahedra no longer satisfy the empty sphere criterion , we remove them from the delaunay triangulation , together with their faces in the interior of the conflict region .",
    "next , we add @xmath10 and connect it to all simplices in the boundary of the conflict region . after the operation",
    ", these simplices form the boundary of the closed star of @xmath10 .",
    "finally , the simplices in the closed star are checked for being in the alpha complex , and their certificates are created or updated .",
    "in this section , we focus on the construction of space - time complexes that give a static @xmath1-dimensional representation of a dynamic spatial process . after a brief review of the medusa concept , we discuss its construction using kinetic algorithms .",
    "[ [ restricted - voronoi - and - alpha - medusa . ] ] restricted voronoi and alpha medusa .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath50 be a finite set of trajectories , and write @xmath51 for the set of points obtained by evaluating all trajectories at time @xmath37 .",
    "of course , we evaluate only those trajectories that are defined at @xmath37 .",
    "the restricted voronoi tessellation of @xmath52 is constructed as described in section [ sec2 ] .",
    "letting @xmath24 \\to { { \\ifmmode{{\\mathbb r}}\\else{\\mbox{\\({\\mathbb r}\\)}}\\fi}}^3 $ ] be a particular trajectory , we get the region of @xmath53 within the tessellation of @xmath52 for each time @xmath54 . piling up these regions in @xmath55 and taking the closure",
    ", we call the result the _ stack _ of the trajectory @xmath56 : @xmath57 \\right).\\end{aligned}\\ ] ] taking the closure is not redundant because the region of a trajectory can change discontinuously when inserting another trajectories , causing a locally open pile .",
    "the set of stacks of trajectories in @xmath50 is the _ restricted voronoi medusa _ , which we denote as @xmath58 .",
    "while it is the preferred representation of a spatial sorting process , we introduce a dual structure that is easier to compute and gives the same measurements . as a first approximation of this construction",
    ", we exploit the duality between restricted voronoi diagrams and alpha complexes and pile up the simplices of the latter to form cells in @xmath55 ; see figure [ fig : alpha_medusa_illu ] .",
    "this construction has two shortcomings .",
    "first , the cells do not define a cell complex , but this can be corrected by adding ( geometrically degenerate ) cells that represent flip , insertion , and deletion events .",
    "second , the walls are redundant and are better contracted .",
    "the contraction produces simplices , but they are connected to each other in more general ways than allowed in a simplicial complex .",
    "the main difficulty in defining the alpha medusa formally is a lack of regularity of the stacks in @xmath59 . while every restricted voronoi region is convex , the stack of such regions is generally not convex , and the intersection of two stacks is generally not connected .",
    "taking the nerve of the set of stacks would thus produce an abstract complex that does not respect the nerve theorem . to finesse these difficulties , we take the _ multi - nerve _ as follows",
    ". if @xmath4 stacks intersect in @xmath60 different connected components , then the multi - nerve has @xmath60 copies of the abstract @xmath3-simplex , each representing one component of the intersection .",
    "moreover , each abstract simplex is associated with the _ lifetime interval _ , @xmath61 $ ] , of the corresponding connected component . because there is at most one component at every moment in time",
    ", we have disjoint intervals for different copies of the same simplex .",
    "the case @xmath62 is allowed and represents connectivity at a single moment in time .",
    "the result of this multi - nerve construction is what we call the _ alpha medusa _ and denote as @xmath63 . in (",
    "* lemma b ) , it is shown that @xmath64 is homotopy equivalent to @xmath59 as well as the space covered by the prismatic cells swept out by simplices of the alpha complex .",
    "[ [ construction . ] ] construction .",
    "+ + + + + + + + + + + + +    a simplex with lifetime interval @xmath65 $ ] is _ active _ for all @xmath66 and _ finished _ for all @xmath67 .",
    "we construct the alpha medusa by running the kinetic alpha complex algorithm and updating the medusa at each event .",
    "we maintain two lists of simplices , called the _ output list _ and the _ active list _ , preserving the following property at all times :    after the algorithm has handled an event at time @xmath37 , the output list consists of all simplices finished at @xmath37 , and the active list consists of all simplices active at @xmath37 .",
    "at the beginning , all simplices in the alpha complex are put into the active list . whenever a simplex is added to the alpha complex at a time @xmath37",
    ", we put it into the active list , and when it is removed from the alpha complex at a later time @xmath68 , we remove it from the active list and put it into the output list with lifetime interval @xmath69 $ ] .",
    "there are additional steps to be taken during special types of events .",
    "we discuss flip events now and the more complicated insertion and deletion events later .",
    "consider a @xmath8-@xmath2-flip at time @xmath37 .",
    "we have two tetrahedra before and three after the flip , or vice versa . at time @xmath37",
    ", they all have the same circumball , so either all or none of them belong to the alpha complex . in the former case",
    ", the five corresponding restricted voronoi regions meet in the center of the common circumball .",
    "it follows that the dual @xmath1-simplex belongs to the multi - nerve , with lifetime interval @xmath70 $ ] .",
    "we thus add the @xmath1-simplex , connecting it its five boundary tetrahedra , which are the ones involved in the flip .",
    "indeed , the @xmath1-simplex fills the void between the five tetrahedra , which could not be filled by gluing the tetrahedra to each other as they are not face - to - face .",
    "[ [ insertions - and - deletions . ] ] insertions and deletions .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    finally , we consider the case in which a trajectory , @xmath71 , is inserted at time @xmath37 .",
    "the case of a deletion is symmetric and omitted .",
    "let @xmath72 be the vertex inserted into the alpha complex .",
    "as described in section [ sec3 ] , the insertion of @xmath73 into the delaunay triangulation is synonymous with the substitution of the star for the simplices in the conflict region of @xmath73 .",
    "any subset of these simplices may belong to the alpha complex .",
    "in addition to finding this subset , we need to construct simplices that fill the gap between the deleted and the inserted alpha complex simplices in the medusa .",
    "this is similar to a flip , in which the void formed by the five tetrahedra is filled by a @xmath1-simplex . to describe a general solution to this problem ,",
    "let @xmath16 be a finite set of points , @xmath73 a point not in @xmath16 , and write @xmath74 for the set including the new point .",
    "we call each @xmath75 an _ old region _ , each @xmath76 a _ new region _ , and @xmath77 the _ region _ of @xmath73 .",
    "let @xmath78 be a non - empty common intersection of old regions .",
    "then , @xmath78 intersects the region of @xmath73 iff the common intersection of the corresponding new regions is either empty or it also intersects the region of @xmath73 .",
    "proof .   for",
    "the forward direction , assume that @xmath78 intersects the region of @xmath73 , and let @xmath79 be an arbitrary point in that intersection .",
    "note that @xmath80 , where @xmath81 is the distance to the closest points in @xmath16 . in the first case",
    ", we have @xmath82 , for all @xmath83 , which implies that the corresponding new regions do not intersect . in the second case",
    ", we have @xmath84 , for some @xmath85 , then there exists a point @xmath86 such that @xmath87 , which implies that @xmath88 belongs to the intersection of the new regions with the region of @xmath73 .    for the backward direction , if the new regions intersect the region of @xmath73 , so do the old regions . in the remaining case ,",
    "the new regions do not intersect .",
    "let @xmath79 be a point in the intersection of the old regions .",
    "since @xmath79 is not in the intersection of the new regions , it must be in the region of @xmath73 .",
    "we use the insertion lemma to derive an algorithm that updates the alpha medusa upon the insertion of a point @xmath73 at time @xmath37 . similar to the case of the delaunay triangulation",
    ", we identify the conflict region and remove all simplices in its interior .",
    "in addition , if a removed @xmath3-simplex @xmath9 is in the alpha complex just before @xmath37 , we add the join , @xmath89 , to the alpha medusa with lifetime interval @xmath90 $ ] .",
    "we do this because the @xmath4 old regions represented by @xmath9 have a non - empty common intersection , but the corresponding new regions do not . in the second step ,",
    "we insert the star of @xmath73 into the delaunay triangulation , check for every inserted simplex whether it belongs to the alpha complex , and if it does then we add it to the active list . clearly , every inserted simplex is of the form @xmath89 , with @xmath9 on the boundary of the conflict region .",
    "in this section , we turn to implementation issues . in particular , we discuss how to implement the algorithm in a robust manner , we study the effect of practical choices , and we present experimental results obtained with our software .    [ [ robust - computation . ] ] robust computation .",
    "+ + + + + + + + + + + + + + + + + + +    recall the basic structure of a kinetic data structure as explained in section [ sec3 ] : it consists of certificate functions , which are polynomials in @xmath37 , and each step advances the state to the smallest root larger than the current time . to maintain the certificates and to advance to the next event , the algorithm computes and compares real roots of univariate polynomials .",
    "these roots are algebraic numbers  irrational in general  which makes the computations non - trivial .",
    "the naive solution of approximating these roots by inexact floating - point numbers can have unpredictable effects .",
    "it is not true that the outcome is just slightly wrong , e.g.  by switching the order of events that happen almost simultaneously , but the incorrect order can lead to inconsistent configurations , causing program crashes , non - termination , and non - sensical results . this problem is well - known in geometric contexts @xcite and several approaches have been proposed .",
    "we follow the _ exact geometric computation ( egc ) paradigm _ , popularized by chee yap @xcite .",
    "it suggests that the basic primitives be mathematically correct , so that an algorithm using these primitives is in the position to compute provably correct results .",
    "translated to our situation , we require that the events of our process are handled in the mathematically correct order .",
    "the price we pay for this interpretation of robustness is the burden to compute with algebraic numbers .",
    "we implement our algorithm using the cgal library , which is designed in the spirit of the egc paradigm .",
    "another aspect of cgal is its generic programming approach : algorithms access underlying data structures and primitives through a well - defined interface , so that these layers can be easily replaced with alternative implementations .",
    "more specifically , we make use of the kinetic data structures package @xcite , which provides an egc implementation of kinetic delaunay triangulations in two and three dimensions .",
    "internally , the package contains an algebraic kernel , providing the low - level functionality needed to handle roots of polynomials , and a combinatorial layer , maintaining the data structure and the certificates over time .",
    "as mentioned earlier , we have extended the combinatorial layer to maintaining an alpha complex .",
    "[ [ experimental - set - up . ] ] experimental set - up .",
    "+ + + + + + + + + + + + + + + + + + + +    we use datasets obtained with the compucell3d software , which allows for the simulation of a @xmath2-dimensional cell segregation process using a monte - carlo algorithm for energy minimization ; see the companion paper @xcite for more details .",
    "we focus on simulated as opposed to observed data because they offer a better control of the input size and the direct accessibility of the cell trajectories . in our particular example",
    ", the cells are colored blue or red , each color with probability one half , and the parameters of the simulation are chosen so that the blue cells eventually engulf the red ones ; see figure [ fig : vor - tessel ] for an illustration .",
    "we created datasets for several input sizes .",
    "in all cases , each trajectory represents the path of a cell nucleus which exists throughout the entire process .",
    "hence , no new cells are ever inserted after the start of the process , and no old cells are deleted before the end of the process .",
    "the trajectories follow a global rhythm in which each trajectory starts a new segment at each value in a common sequence of bending events . in between two bending events , each trajectory is linear .",
    "all experiments are performed on a intel core 2 dual cpu clocked with 2.4 ghz each , with 3 mb of cache size , and 4 gb of total memory .",
    "the code runs under debian squeeze , compiled with gcc-4.4.5 and cgal version 3.9 .    in a first test",
    ", we compare the running times for maintaining the delaunay triangulation and the alpha complex , and for constructing the alpha medusa , all for the same datasets ; see table [ tbl : del_alpha_compare ] .",
    "we observe that the overhead of computing the medusa is negligible .",
    "for this reason , we concentrate on the maintenance of the alpha complex . comparing the third and fourth columns of the table ,",
    "we see that the radius events slow down the algorithm by more than a magnitude , in spite of the fact that their number is not much larger than the number of flip events . in the remainder of this section ,",
    "we explain improvements of our algorithm aimed at reducing the performance gap between delaunay and alpha complexes .    [ [ number - of - certificates . ] ] number of certificates .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    the bottleneck is the construction of radius certificates and the computation of their real roots . recall that in our original formulation , we maintain a radius certificate for each edge , triangle , and tetrahedron .",
    "our first optimization is based on the observation that many of these certificates are not necessary : if a simplex is short , then all its faces are short , and if a simplex is non - short , then all its cofaces are non - short .    whenever a triangle or tetrahedron becomes short ,",
    "we remove the radius certificates of its proper faces , and when an edge or triangle becomes non - short , we remove the radius certificates of its proper cofaces .    of course , this implies that we sometimes have to construct certificates that would otherwise still exist .",
    "for example , we construct the certificate of a triangle at the time its third edge becomes short . on the other hand",
    ", we avoid unnecessary certificates , for instance the certificates of the boundary edges of a triangle that stays short for the whole simulation .",
    "as we see in table [ tbl : reduced_cert ] , the strategy saves time in practice .",
    "we observe that the constructions of radius certificates and the running time both decrease roughly by a factor of two .",
    "[ [ degree . ] ] degree .",
    "+ + + + + + +    we turn to the computation of certificates .",
    "assuming piecewise - linear trajectories , the radius certificate of an edge is a polynomial of degree @xmath8 ; compare with section [ sec3 ] .",
    "there is a standard construction of a radius certificate of a tetrahedron , which is a polynomial of degree @xmath91 ; see @xcite .",
    "our interest lies in the remaining triangle case .",
    "the current cgal implementation computes the squared circumradius of a triangle @xmath92 in @xmath0 with an expression of the form @xmath93 where @xmath94 is the determinant of the matrix in , and @xmath95 , @xmath96 , @xmath97 are expressions formed by minors of this matrix . the corresponding certificate",
    ", @xmath98 is a polynomial whose degree is @xmath99 , which is higher than the degree for the tetrahedron .",
    "we replace by a simpler expression . writing @xmath10 , @xmath100 , @xmath101 for the three vertices of the triangle",
    ", the circumradius can also be written as @xmath102 a formula that is straightforward to derive using elementary matrix calculus ; see also wikipedia @xcite .",
    "monitor the radius of a triangle using the following certificate function : @xmath103    the degree of this certificate is @xmath104 .",
    "we see the effect of this improvement in table [ tbl : reduced_degree ] .",
    "the running time improves by more than a factor of two .",
    "[ [ algebraic - kernel . ] ] algebraic kernel",
    ". + + + + + + + + + + + + + + + + +    as already mentioned , the cgal package for kinetic data structures contains an internal algebraic kernel , which , among other things , is used to isolate the roots of polynomials and sort them in the event queue . by the generic design of the package",
    ", the combinatorial layer communicates with the kernel via a small and well - defined interface , which makes it possible to replace the algebraic kernel with a different implementation .    in recent years",
    ", a mature and generic algebraic kernel for geometric computations has been developed @xcite .",
    "it has been integrated into cgal and is available since version 3.7 under the name ` algebraic_kernel_d ` .",
    "we refer to it as the ak_d kernel .",
    "both the internal kds and the ak_d kernels use subdivision methods for root isolation , but they differ in the strategy for detecting empty intervals and isolating intervals .",
    "the kds kernel uses sturm theory @xcite , while the ak_d kernel is based on descartes rule of sign @xcite , which leads to a better performance in practice ; see @xcite for a comparison of various root solvers .",
    "the difference between the third and fourth columns in table [ tbl : new_kernel ] shows that exchanging the kernel yields another improvement of roughly a factor of two .",
    "[ [ filter - and - cache . ] ] filter and cache .",
    "+ + + + + + + + + + + + + + + + +    we get further optimizations by exploiting the special structure of our experimental setup . for any certificate ,",
    "we are only interested in the roots between the current time and the next bending event , when the certificate becomes invalid .",
    "many certificates do not have roots in this interval , but may have roots outside .",
    "the current implementation first computes all real roots and thereafter discards the ones that lie outside the mentioned interval .",
    "we use descartes rule of sign to certify the non - existence of roots in the interval until the next bending event , and if successful , we skip the root isolation algorithm .    the fifth column of table [ tbl : new_kernel ] shows the improvement",
    ". more than ninety percent of the certificates that do not have a root before the next bending event are filtered out . as a final improvement",
    ", we avoid isolating the roots of the same polynomial multiple times .",
    "we store polynomials together with their real roots in the interval until the next bending event in cache , which is cleared at the next bending event .",
    "we see in the sixth column of table [ tbl : new_kernel ] that the cache yields another substantial speed - up , which suggests that certificates are frequently devalidated and revalidated during the runtime of the algorithm .",
    "we remark that also the kds kernel would benefit from caching . comparing the running times for maintaining the alpha complex before and after the four steps of optimization",
    ", we see that the performance improves by roughly a factor of @xmath105 .",
    "moreover , compared to maintaining the delaunay triangulation , the optimized algorithm is slower by a factor up to @xmath1 .",
    "it is no surprise that the extension to alpha complexes is expensive .",
    "after all , it requires additional radius certificates , which have higher degrees than the flip certificates needed to maintain the delaunay triangulation .",
    "we have demonstrated that with some algorithmic engineering , the overhead needed for alpha complexes can be kept within a moderate bound .",
    "the main contributions of this paper are a kinetic algorithm for alpha complexes , its use to construct a space - time representation of a spatial sorting process  called a medusa  and the implementation of a moderately fast but correct software . in a companion paper @xcite",
    ", we have demonstrated that the theory of persistent homology applied to the time function on the medusa quantifies the sorting process by measuring its topological features . while the work in this and the companion papers is limited to simulated data , an application of our methods to observed biological data is under way .",
    "there is no theoretical obstacle to generalizing our algorithm and its implementation to the weighted case , in which different voronoi regions are restricted to within different size balls .",
    "a more challenging problem is the restriction to within bodies different than balls , e.g.  arbitrarily oriented ellipsoids .",
    "the first author of this paper made a considerable effort to accelerate the implementation of the kinetic alpha complex algorithm , since this was necessary to compute examples of reasonable size in acceptable time ; the instances computed in @xcite each took about 4 hours with our best configuration .",
    "nevertheless , there are opportunities to further speed up the software , in particular on the level of the algebraic kernel . for example",
    ", it would be desirable to restrict the root isolation method to within a given interval , without wasting any time on roots outside this interval .",
    "similarly , we expect an improvement from implementing the filter for ruling out empty intervals in certified approximate arithmetic .",
    "we believe that kinetic data structures are an important tool in the topological analysis of time - varying shapes .",
    "we hope that our work on cell segregation initiates further work on such data . to facilitate this research",
    ", it would be useful if our extension of cgal s package on kinetic data structures is transformed from an experimental branch to a redesign of the package .",
    "it is desirable that such a redesign solves the problem of degeneracies in the implementation of kinetic delaunay triangulations and alpha complexes .",
    "except for some special cases , the current versions of both algorithms are not guaranteed to work correctly when two or more events happen at exactly the same time ."
  ],
  "abstract_text": [
    "<S> motivated by an application in cell biology , we consider spatial sorting processes defined by particles moving from an initial to a final configuration . </S>",
    "<S> we describe an algorithm for constructing a cell complex in space - time , called the _ </S>",
    "<S> medusa _ , that measures topological properties of the sorting process . </S>",
    "<S> the algorithm requires an extension of the kinetic data structures framework from delaunay triangulations to fixed - radius alpha complexes . </S>",
    "<S> we report on several techniques to accelerate the computation . </S>"
  ]
}