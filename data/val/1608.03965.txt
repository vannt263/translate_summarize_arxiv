{
  "article_text": [
    "in word combinatorics , sturmian words and regular continued fractions are known to provide a very fruitful interaction between arithmetics , discrete geometry and symbolic dynamics . recall that sturmian words can be defined as infinite words which code irrational discrete lines over a two - letter alphabet ( one speaks about digitizations of irrational straight lines ) .",
    "recall also that a substitution is a non - erasing morphism of the free monoid which acts naturally on all finite and infinite words . then",
    ", most combinatorial properties of sturmian words can be described in terms of the continued fraction expansion of the slope of the discrete line that they code ( see chap . 2 in @xcite and chap . 6 in @xcite ) .",
    "for example , let us briefly sketch the proof that sturmian words can be obtained as an infinite composition of a finite number of substitutions , _",
    "i.e. _ , sturmian words are @xmath0-adic ( for more details , see @xcite and chap .",
    "12 in @xcite ) .",
    "first , one can deduce from the combinatorial properties of sturmian words defined over @xmath1 that factors @xmath2 and @xmath3 can not occur simultaneoulsy in a sturmian word .",
    "this allows to _ desubstitute _ any sturmian word @xmath4 , _",
    "i.e. _ to write @xmath5 or @xmath6 , where @xmath7 is an infinite word over @xmath1 , and @xmath8 and @xmath9 are the substitutions defined by @xmath10 , @xmath11 , @xmath12 and @xmath13 .",
    "then , one can show that the desubstituted word @xmath7 is itself a sturmian word ( it corresponds to a digitization of the same line after a change of lattice basis ) .",
    "we can thus reiterate the process _",
    "ad infinitum _ , and the corresponding sequence of substitutions @xmath8 and @xmath9 turns out to be determined by the continued fraction expansion of the slope of the initial sturmian word .",
    "+ in this paper , we would like to extend this interaction to higher dimensions .",
    "we thus need to generalize the notions of free group morphisms ( among them substitutions ) , of sturmian words and to work with a multi - dimensional version of the euclidean algorithm , that is , a multi - dimensional continued fraction algorithm . here , we show that this can be respectively done by _ dual maps _ , _ stepped planes _ and the _ brun algorithm_. this allows to provide a first step towards a multi - dimensional extension of the above interaction .",
    "dual maps have been introduced by arnoux and ito in @xcite as a generalization to higher dimensions of free monoid and free group morphisms .",
    "they are inspired by the geometrical formalism of @xcite , whose aim was to provide explicit markov partitions for hyperbolic automorphisms of the torus associated with particular morphisms of the free group .",
    "indeed , iterations of dual maps generate stepped planes approximating the stable and unstable spaces of toral automorphisms .",
    "they have already proved their efficiency for the construction of explicit markov partitions @xcite , for diophantine approximation @xcite , in the spectral study of pisot substitutive dynamical systems @xcite or else in discrete geometry @xcite .",
    "+ stepped planes have been introduced in @xcite as multi - dimensional sturmian words : they are digitizations of real hyperplanes ( see remark  [ rem : digitization_linear_group1 ] below for more details ) . stepped surfaces have then been introduced in @xcite as a generalization of two - letter words : a stepped surface is defined as a union of facets of integer translates of the unit hypercube which is homeormophic to the antidiagonal plane ( the hyperplane with normal vector @xmath14 ) .",
    "hence , stepped planes are particular stepped surfaces , as sturmian words are particular two - letter words .",
    "following @xcite , we also rely in this paper on the notion of _ flip_. the flip is a classical notion in the study of dimer tilings : this is a local reorganization of tiles that transforms a tiling into another one ( see , _",
    "e.g. _ , @xcite ) . in our context , flips turn out to be a powerful technical tool that allows us to transfer properties from stepped planes to stepped surfaces , by describing the latter as stepped planes on which flips are performed .",
    "+ last , the brun algorithm ( also called modified jacobi - perron algorithm ) , introduced in @xcite , is one of the most classical unimodular multi - dimensional continued fraction algorithms ( in the sense of @xcite , see also @xcite ) .",
    "although we choose the brun algorithm , many other algorithms as , _ e.g. _ , the jacobi - perron , selmer or poincar ones could be also used .",
    "+ let us outline the contents and the main results of the present paper .",
    "first , sec .",
    "[ sec : stepped ] is devoted to the basic introductory material , namely stepped functions , which include both stepped planes and stepped surfaces .",
    "then , sec .",
    "[ sec : flips ] introduces the notion of flip in the general context of stepped functions .",
    "this leads to the notion of _ pseudo - flip - accessibility _ , which extends the usual notion of _ flip - accessibility_. + the next section , sec .",
    "[ sec : dual_maps ] , recalls the notion of dual map and provides two of the main results of this paper , whose proofs are combinatorial : the image of stepped planes and stepped surfaces under dual maps are , respectively , stepped planes and stepped surfaces ( th .  [",
    "th : image_stepped_plane ] and th .",
    "[ th : image_stepped_surface ] ) .",
    "this extends similar results that we have previously obtained in the particular case of _ positive _ dual maps ( which includes substitutions but not any free group morphism ) .",
    "last , sec .",
    "[ sec : brun_expansions ] relies on the results of the previous section to define brun expansions of both stepped planes and stepped surfaces .",
    "we first handle the case of a stepped plane : its brun expansion indeed naturally corresponds to the brun expansion of its normal vector .",
    "however , we also provide a definition of the brun expansion of a stepped plane which relies not on its normal vector but only on some of its local geometric configurations , namely _ runs _ ( see def .  [",
    "def : run ] and [ def : tilde_t ] ) .",
    "this allows us to then extend the notion of brun expansion to stepped surfaces ( even with a lack of a notion of a normal vector ) ( th .",
    "[ th : tilde_t_stepped_surface ] and def .",
    "[ def : stepped_surface_exp ] ) .",
    "we also here prove the following `` classification '' result : the longer the brun expansion of a stepped surface is , the more planar this stepped surface is ( th .  [",
    "th : weak_cv_surfaces ] ) .",
    "[ sec : con ] ends the paper with additional remarks .",
    "let us provide here some notation used throughout this paper .",
    "the dimension of the space is denoted by @xmath15 , and we assume @xmath16 ; we thus work in @xmath17 .",
    "let @xmath18 be equal to @xmath19 or @xmath20 .",
    "the set of non - zero ( resp .",
    "non - negative ) elements of @xmath18 is denoted by @xmath21 ( resp .",
    "@xmath22 ) .",
    "the set @xmath23 denotes the set @xmath24 of non - negative integers .",
    "we stress the fact that the term positive refers to strictly positive in all that follows .",
    "the cardinality of a set @xmath25 is denoted by @xmath26 .",
    "if @xmath27 and @xmath28 belong to @xmath17 , then we write @xmath29 ( resp .",
    "@xmath30 ) if , for all @xmath31 , @xmath32 ( resp .",
    "@xmath33 ) .",
    "we also denote by @xmath34 the scalar product of @xmath35 and @xmath36 . the euclidean norm in @xmath17 is denoted by @xmath37 , and @xmath38 stands for the euclidean closed ball of center @xmath35 and radius @xmath39 .",
    "we also use the notation @xmath37 for the matrix norm associated with the euclidean norm , _ i.e. _ , @xmath40 for a @xmath41 real matrix @xmath42 .",
    "last , for @xmath43 , @xmath44 stands for the hyperplane orthogonal to the real line @xmath45 .",
    "we here introduce basic objects of this paper , thanks to an algebraic formalism for unions of facets of integer translates of the unit cube .",
    "we first introduce the notion of _ stepped function _ :    [ def : stepped_function ] a _ stepped function _",
    "@xmath46 is a function from @xmath47 to @xmath19 .",
    "its _ size _ is the cardinality of the subset of @xmath47 where it takes non - zero values .",
    "the set of stepped functions is denoted by @xmath48 .",
    "the set of stepped functions is a @xmath19-module .",
    "for any two stepped functions @xmath46 and @xmath49 , we write @xmath50 if @xmath51 for any @xmath52 .",
    "we then endow @xmath48 with the following metric :    [ def : distance ] let @xmath53 be the distance on @xmath48 defined by @xmath54 if @xmath55 , and by @xmath56 otherwise , where @xmath57    this metric is inspired by the rigid version of the so - called _ local metric _ often used for tilings ( see , _ e.g. _ , @xcite ) .",
    "note that the distance between two stepped functions which agree nowhere is equal to one ( @xmath58 ) .",
    "the only non - trivial point to ensure that @xmath53 is a distance is that the triangle inequality holds .",
    "one checks that , for any three stepped functions @xmath46 , @xmath49 and @xmath59 , the following ultrametric inequality holds : @xmath60    among stepped functions , we distinguish the following elementary ones :    [ def : face ] the _ face of type @xmath61 located at @xmath62 _ , denoted by @xmath63 , is the stepped function taking value one at @xmath64 and zero elsewhere .",
    "the notation @xmath63 allows one to distinguish between the function and the element @xmath65 .",
    "although it would be more natural to use the notation @xmath66 , we prefer @xmath63 for simplicity .",
    "+ faces allow us to write any stepped function @xmath67 as an at most countable weighted sum of faces : @xmath68 where @xmath69 is called the _ weight _ of the face @xmath63 .",
    "this notation is convenient and will later be used ( see , _ e.g. _ , def .",
    "[ def : stepped_quasi_plane ] , below ) .",
    "let us stress the fact that such sums are formal and do not raise any problem of convergence .",
    "+ let us now provide a geometric interpretation of faces .",
    "let @xmath70 denote the canonical basis of @xmath17 .",
    "the _ geometric interpretation _ of the face @xmath63 is defined as the facet and not @xmath35 ( in other words , we add an offset @xmath71 ) : this is only for compatibility with formulas of @xcite used here in sec . [",
    "sec : dual_maps ] . ] of unit hypercube of @xmath17 ( see fig .  [",
    "fig : faces ] ) : @xmath72    , for @xmath73 ( from left to right).,scaledwidth=60.0% ]    then , the geometric interpretation of a sum of faces whose weights are all equal to zero or one is naturally defined as the union of geometric interpretations of faces with weight one .",
    "this leads to distinguish particular stepped functions :    [ def : binary_stepped_function ] a stepped function is said to be _ binary _ if it takes only values zero or one .",
    "the set of binary stepped functions is denoted by @xmath74 .",
    "thus , binary stepped functions are the stepped functions having a geometric interpretation ( which is a union of facets of unit hypercubes ) . + we are now in a position to introduce two types of stepped functions playing a key role throughout this paper , namely _ stepped surfaces _ and _ stepped planes _ :    [ def : stepped_surface ] let @xmath75 be the orthogonal projection onto the euclidean hyperplane @xmath76 . a binary stepped function",
    "whose geometric interpretation is homeomorphic to @xmath77 under @xmath75 is called a _ stepped surface_. the set of stepped surfaces is denoted by @xmath78 .    in other words ,",
    "stepped surfaces correspond ( by projecting under @xmath75 their geometrical interpretation ) to tilings of @xmath77 by @xmath15 types of rhomboedras ( @xmath79 types of lozenges when @xmath80 , see _",
    "e.g. _ fig .",
    "[ fig : stepped_plane_surface ] below ) .",
    "[ def : stepped_plane ] the _ stepped plane _ of _ normal vector _ @xmath81 and _ intercept _",
    "@xmath82 is the binary stepped function denoted by @xmath83 and defined by : @xmath84 the set of stepped planes is denoted by @xmath85 .",
    "the set of vertices of the geometric interpretation of a stepped plane is usually called a standard arithmetic discrete plane in discrete geometry , according to the terminology of @xcite .",
    "[ fig : stepped_plane_surface ] illustrates def .",
    "[ def : stepped_surface ] and [ def : stepped_plane ] .    , whose images under @xmath75 can be seen as tilings of the hyperplane @xmath77 ( here , @xmath86 ) . ]",
    "note that the condition @xmath81 of def .",
    "[ def : stepped_plane ] ensures that the geometric interpretation of a stepped plane is homeomorphic to @xmath77 under @xmath75 .",
    "stepped planes are thus particular stepped surfaces , namely `` straight '' ones , and the different types of stepped functions previously introduced verify the following inclusions ( with all of them being strict ) : @xmath87 one can also check that @xmath78 , @xmath74 and @xmath48 are closed ( w.r.t . the distance @xmath53 ) , while @xmath85 is neither closed nor open .",
    "+ we conclude this section by stating a technical property of stepped surfaces that will be used later ( in the proofs of prop .",
    "[ prop : positive_image_stepped_surface ] and lem .",
    "[ lem : zarbi ] ) :    [ prop : stepped_surface ] if @xmath35 and @xmath36 are two integer vectors belonging to the geometric interpretation of a stepped surface , then @xmath88 is neither positive nor negative .",
    "let @xmath89 be a stepped surface , and @xmath0 stand for its geometric interpretation .",
    "we denote by @xmath90 the vector @xmath91 .",
    "since @xmath92 is homeomorphic to the hyperplane @xmath93 , @xmath0 divides @xmath17 into two open halfspaces @xmath94 and @xmath95 .",
    "let @xmath94 be the open halfspace in the direction @xmath90 .",
    "one has : @xmath96 let us prove that if @xmath97 , then @xmath98 , for @xmath31 .",
    ", we can assume @xmath99 .",
    "assume furthermore that @xmath100 .",
    "we want to prove that @xmath101 there is @xmath102 which is mapped to @xmath103 under @xmath75 .",
    "hence there is @xmath104 such that @xmath105 .",
    "we want to prove that @xmath106 .",
    "the claim will follow directly by noticing that @xmath107 and @xmath108 , i.e. , @xmath109 .",
    "+ thus , let us prove that @xmath106 .",
    "there is a facet @xmath110 included in @xmath0 , with @xmath110 being the geometric interpretation of a face with weight one of @xmath89 , such that @xmath111 contains the line segment with ends @xmath112 and @xmath113 .",
    "the set of vertices of @xmath114 is included in @xmath115 indeed , for any @xmath116 , the set of all vertices of @xmath114 can not contain both @xmath117 and @xmath118 .",
    "hence , @xmath103 can be reached from @xmath119 by an edge path in @xmath114 .",
    "if we lift up this path in @xmath0 , we also obtain that @xmath120 can be reached from @xmath119 by an edge path in @xmath110 .",
    "( for an illustration of an example of such a path in the case of @xmath121 , see fig .",
    "[ fig : proof : stepped_surface ] . ) hence , @xmath122 which implies that @xmath106 .",
    "this ends the proof of the fact that if @xmath97 , then @xmath98 , for @xmath31 .",
    "+ now , let @xmath123 .",
    "there is @xmath124 such that @xmath125 .",
    "we deduce from above that @xmath126 , and thus @xmath127 .",
    "we thus have proved that if @xmath128 , then @xmath98 , for @xmath31 .",
    "this inductively implies that if @xmath129 , then , for any @xmath130 , @xmath131 .",
    "+ finally , let @xmath35 and @xmath36 in @xmath132 such that @xmath133 .",
    "one has @xmath134 , hence there is @xmath135 such that @xmath136 .",
    "this yields @xmath137 and @xmath138 .",
    "this contradicts @xmath139 .     from @xmath119 to @xmath140 ( here , @xmath86 ) .",
    ", width=302 ]",
    "in mechanical physics , matter is often modeled by tilings , with local rearrangements of inter - atomic links being modeled by local rearrangements of tiles called _",
    "flips_. this rises questions about the structure of the space of tilings endowed with the flip operation , as well as about the dynamics of flips over this space .",
    "in particular , the question of _ flip - accessibility _ is natural : can one transform a tiling into another one by performing a sequence of flips ? + in the previous section , we mentioned that the orthogonal projection @xmath75 onto @xmath77 naturally associates with each stepped surface of @xmath17 a tiling of @xmath77 ( see fig .",
    "[ fig : stepped_plane_surface ] ) . here , we take an @xmath17-viewpoint and directly define a notion of flip on stepped surfaces , so that performing a flip on a stepped surface corresponds to performing a classic flip on the associated tiling .",
    "more formally , we introduce the following stepped functions :    [ def : flip ] the _ flip _ located at @xmath62 is the stepped function @xmath141 defined by : @xmath142    performing a flip on a stepped surface @xmath89 thus means adding some @xmath141 to @xmath89 , provided @xmath143 is still a stepped surface . then , transforming a tiling into another one by flips becomes pushing outwards the difference between the two corresponding stepped surfaces ( see fig .",
    "[ fig : flip ] ) .",
    "the precise definition of flip - accessibility in this setting is the following :    [ def : flip_acc ] a stepped surface @xmath144 is _ flip - accessible _ from a stepped surface @xmath89 if there is a sequence @xmath145 of stepped surfaces such that : @xmath146     as adding the upper facets of a unit hypercube to the geometric interpretation of a stepped surface or , once projected under @xmath75 , as a local rearrangement of tiles in a tiling of @xmath77 . ,",
    "scaledwidth=70.0% ]    note that the sequence of stepped surfaces @xmath145 connecting two stepped surfaces can be finite as well as infinite .",
    "it is easily seen that two stepped surfaces are not always flip - accessible .",
    "for example , consider the stepped plane @xmath147 : since it takes values one only on faces of type @xmath148 , @xmath149 takes negative values , whatever @xmath35 is .",
    "thus , no stepped surface is flip - accessible from @xmath147 ( it is a sink ) .",
    "let us mention that a characterization of flip - accessible stepped surfaces in terms of _ shadows _ is provided in @xcite ( see also @xcite ) .",
    "furthermore , it is proven there that any stepped surface is flip - accessible from a stepped plane whose normal vector is positive ( that is , each entry is strictly positive ) .",
    "[ def : flip_acc ] translates flip - accessibility from tilings to stepped surfaces .",
    "but the formalism introduced in sec .",
    "[ sec : stepped ] allows us to define a more general notion of flip - accessibility , namely _ pseudo - flip - accessibility _ , which involves not only stepped surfaces but also stepped functions :    [ def : pseudo_flip_acc ] a stepped function @xmath49 is _ pseudo - flip - accessible _ from a stepped function @xmath46 if there is a sequence @xmath150 of stepped functions such that : @xmath151    while flip - accessibility connects two stepped surfaces by a sequence of stepped surfaces , such a restriction does no longer hold on the connecting sequence for pseudo - flip - accessibility ( _ i.e. _ , the @xmath152 appearing in def .",
    "[ def : pseudo_flip_acc ] are not necessarily stepped surfaces , even if @xmath46 and @xmath49 do )",
    ". in particular , characterizing pseudo - flip - accessibility between stepped surfaces becomes a trivial question :    [ prop : pseudo_flip_acc ] any two stepped surfaces are mutually pseudo - flip - accessible .",
    "we use the notation of the proof of prop .",
    "[ prop : stepped_surface ] .",
    "we consider two stepped surfaces @xmath89 and @xmath144 .",
    "let @xmath153 be defined by : @xmath154 we label the elements of the countable set @xmath155 in such a way that @xmath156 whenever @xmath157 .",
    "this ensures the convergence of the sequence @xmath158 of stepped functions ( which have no reason to be stepped surfaces ) defined , for any @xmath159 , by : @xmath160 moreover , this sequence tends towards @xmath144 .",
    "indeed , while a vector @xmath62 of @xmath89 is still above ( resp .",
    "below ) @xmath144 , it will be moved downwards ( resp",
    ". upwards ) by a flip ( according to the sign of @xmath161 ) .",
    "this shows that @xmath144 is pseudo - flip - accessible from @xmath89 .",
    "[ fig : pseudo_flip_acc ] illustrates the proof of prop .",
    "[ prop : pseudo_flip_acc ] , and more precisely how the labeling and flipping is performed .",
    "+     into the stepped surface @xmath162 , _ i.e. _ to translate it by @xmath163 . following the proof of prop .",
    "[ prop : pseudo_flip_acc ] , we add flips on white points ( where @xmath164 is equal to @xmath148 ) .",
    "these flips are sorted by increasing distance from the origin , as indicated on the figure . by performing these flips ,",
    "we thus transform @xmath89 into @xmath144 ( from left to right ) .",
    "note that intermediary stepped functions are not necessarily stepped surfaces ( dashed edges stand for faces with weight @xmath165 ) . , scaledwidth=60.0% ]    one can ask whether pseudo - flip - accessibility is too general for being worthwhile .",
    "we will however use it in the proofs of th .",
    "[ th : image_stepped_surface ] and [ th : weak_cv_surfaces ] , by decomposing a stepped surface into a sum of a stepped plane and flips .",
    "we will in particular need the following result :    [ prop : binary_pseudo_flip_acc ] if a non - zero binary stepped function is pseudo - flip - accessible from a stepped surface , then it is a stepped surface .",
    "let @xmath166 be a non - zero binary function pseudo - flip - accessible from a stepped surface @xmath89 .",
    "thus , there is a sequence @xmath167 with values in @xmath168 and a sequence @xmath169 with values in @xmath170 such that the sequence of stepped functions @xmath171 defined as follows tends towards @xmath166 : @xmath172 w.l.o.g .",
    ", the @xmath173 s are pairwise different .",
    "we then introduce a second sequence of stepped functions : @xmath174 this sequence also tends towards @xmath166 when @xmath159 goes to infinity .",
    "we now fix @xmath175 let us show that @xmath75 is a homeomorphism from the restriction of @xmath176 to @xmath177 onto @xmath178 , that is , @xmath176 is `` locally '' a stepped surface .",
    "this property will be referred to as the `` wanted property '' in the remaining of the proof .",
    "up to a relabeling , we can assume that the finite sequence @xmath179 satisfies : @xmath180 indeed , it suffices to sort @xmath181 and @xmath182 w.r.t .",
    "the partial orders @xmath183 and @xmath184 , respectively .",
    "let us show the wanted property by induction on the cardinality @xmath185 of the set @xmath186 .",
    "note that @xmath185 depends on @xmath159 .",
    "this holds for @xmath187 , since @xmath75 is a homeomorphism from the whole geometric realization of @xmath89 onto @xmath188 .",
    "the next step of the induction consists in adding a weighted pseudo - flip @xmath189 to a stepped function which satisfies the wanted property .",
    "one checks that the way pseudo - flips have been sorted ensures that , if adding @xmath190 yields weigth @xmath191 ( resp .",
    "@xmath192 ) to some face , then the weight can only be decreased ( resp .",
    "increased ) by further pseudo - flips , _",
    "i.e. _ , by adding @xmath193 for @xmath194 . in particular",
    ", this contradicts the fact that , after having performed all the pseudo - flips , we get the binary stepped function @xmath166 . hence , adding @xmath190 simply exchanges the weights ( @xmath195 or @xmath148 ) of the faces @xmath196 ( the lower facets of a unit hypercube ) and @xmath197 ( the upper facets of the same unit hypercube ) . note that for any hypercube , the respective images under @xmath75 of the union of its upper facets and of the union of its lower facets .",
    "this ensures that , by adding @xmath189 , one gets a stepped function whose restriction to @xmath177 is still homeomorphic under @xmath75 to @xmath178 .",
    "this shows that the wanted property holds whatever is the cardinality of @xmath198 .",
    "+ thus , @xmath176 is `` locally '' a stepped surface ( _ i.e. _ , on @xmath177 ) . in order to finish the proof ,",
    "let us fix now @xmath199 . since @xmath166 is non - zero , there is @xmath64 such that @xmath200 .",
    "since the sequence @xmath201 tends towards @xmath166 , there is @xmath202 such that , for @xmath203 , @xmath176 and @xmath166 agree on @xmath38 .",
    "then , for @xmath204 , @xmath75 is a homeomorphism from the restriction of @xmath176 to @xmath38  hence from the restriction of @xmath166 to @xmath38  onto @xmath205 .",
    "when @xmath39 goes to infinity , this shows that @xmath75 is a homeomorphism from @xmath166 onto @xmath188 , that is , @xmath166 is a stepped surface .",
    "[ fig : pseudo_flip_acc_reord ] illustrates the relabeling ( or sorting ) of flips in the proof of prop .",
    "[ prop : binary_pseudo_flip_acc ] .     and",
    "@xmath144 as on fig .",
    "[ fig : pseudo_flip_acc ] .",
    "we consider the open ball @xmath206 ( depicted as a circle ) . following the proof of prop .",
    "[ prop : binary_pseudo_flip_acc ] , we can sort the flips ( as depicted on the figure ) so that the projection @xmath75 is a homeomorphism from the restrictions to @xmath206 of intermediate stepped functions onto their images under @xmath75 . ,",
    "in this section , we first recall the notion of _ dual map _ from @xcite which yields maps defined on stepped functions .",
    "we then characterize their action respectively on stepped planes and surfaces .",
    "we first need to briefly recall some basic notions and notation of words combinatorics .",
    "the free group over the alphabet @xmath207 is denoted by @xmath208 .",
    "the identity element is the empty word , usually denoted by @xmath209 .",
    "all elements of @xmath208 will be given in their reduced form .",
    "for @xmath210 and a letter @xmath61 , one denotes by @xmath211 the sum of powers of the occurences of @xmath212 in @xmath213 .",
    "then , the _ abelianization map _",
    "@xmath214 maps any @xmath210 to the vector of @xmath168 whose @xmath212-th entry is @xmath211 .",
    "for example : @xmath215 a _ morphism _ of @xmath208 is a map @xmath216 such that , for any @xmath4 and @xmath7 in @xmath208 , @xmath217 .",
    "it is said to be non - erasing if no letter is mapped onto the empty word .",
    "the _ incidence matrix _ of a morphism @xmath218 , denoted @xmath219 , is the @xmath41 integer matrix whose @xmath212-th column is @xmath220 .",
    "a morphism @xmath218 is said to be _ unimodular _ if @xmath221 , that is , if @xmath219 belongs to the linear group @xmath222 .",
    "it is said to be _ non - negative _ if it is non - negative with respect to the canonical basis ( let us stress the fact that the notion of non - negativity for a morphism heavily depends on the choice of a basis for the free group ) .",
    "non - erasing and non - negative morphisms ( in the canonical basis ) are usually called _ substitutions _ : they map words with positive power letters onto non - empty words with positive power letters , and thus have non - negative incidence matrix ( for more on substitutions , see , _",
    "e.g. _ , @xcite ) .",
    "for example , @xmath223 is a unimodular substitution with incidence matrix : @xmath224    we are now in a position to recall the notion of _ dual map _ :    [ def : dual_map ] the _ dual map _ associated with a unimodular morphism @xmath218 is the endomorphism of @xmath48 denoted by @xmath225 and defined , for any @xmath67 , by : @xmath226    note that @xmath227 takes finite values , as finite sums of values of @xmath46 .",
    "thus , @xmath225 is well - defined .",
    "dual maps have been introduced in @xcite under the name _ generalized substitutions _ in the particular case where @xmath218 is a unimodular substitution .",
    "they have been extended to the case of unimodular morphisms of the free group in @xcite .",
    "extensions to more general spaces than @xmath48 ( based on higher codimension facets of cubes ) have also been provided in @xcite .",
    "in particular , we keep here the notation @xmath225 introduced in the papers @xcite , although it can seem at first view obfuscating . indeed , the subscript of @xmath225 stands for the codimension of the geometric interpretation of faces ( in the present paper , they are codimension one facets of hypercubes ) , while the superscript of @xmath225 indicates that it is the dual map of some map @xmath228 , hence also the term _ dual _ map .    since elements of @xmath48 are weighted sums of faces and dual maps are linear",
    ", the image of any element of @xmath48 can be deduced from the images of faces .",
    "it is thus worth computing the action of dual maps on faces :    [ prop : image_face ] the image under the dual map @xmath225 of the face @xmath63 is : @xmath229    let @xmath230 .",
    "one the one hand , def .",
    "[ def : dual_map ] yields : @xmath231 by definition of a face , @xmath232 is equal either to one if @xmath233 and @xmath234 , or to zero .",
    "the first sum is thus equal either to one if there is @xmath235 such that @xmath236 and @xmath234 , or to zero .",
    "+ one the other hand , consider the formula given in prop .",
    "[ prop : image_face ] .",
    "here , @xmath237 is equal either to one if @xmath238 and @xmath239 , _",
    "i.e. _ , @xmath234 , or to zero . the first sum of this formula is thus equal either to one if there is @xmath240 such that @xmath241 and @xmath234 , or to zero .",
    "this shows that the first sums of both formulaes are identical .",
    "we similarly prove that the second sums of both formulaes  hence the whole formulaes  are identical .",
    "this ends the proof .",
    "it follows from def .",
    "[ def : dual_map ] that @xmath225 has finite range .",
    "indeed , @xmath227 takes on @xmath64 a value which depends only on the values of @xmath242 for @xmath243 , where @xmath244 is a constant depending only on @xmath218 .",
    "thus , for any @xmath199 , if two stepped functions agree on @xmath245 , then their images under @xmath225 agree on @xmath246 .",
    "in particular , this shows that dual maps are uniformly continuous on @xmath48 .",
    "+ let us also mention that , for two unimodular morphisms @xmath218 and @xmath247 , one has : @xmath248 this can be checked by a direct computation from the formula in def .",
    "[ def : dual_map ] , although this also easily follows from the way dual maps are defined in @xcite .",
    "[ ex : brun_substitutions ] for @xmath249 and @xmath250 , one defines the _ _ brun substitution__. ] @xmath251 by : @xmath252 its incidence matrix is @xmath253 one checks that @xmath251 is unimodular .",
    "it is also invertible , with inverse : @xmath254 let us compute the images under @xmath255 and @xmath256 of the faces located at @xmath119 : @xmath257 @xmath258 fig .",
    "[ fig : brun_substitutions ] illustrates the action of @xmath255 for @xmath259 , @xmath260 , @xmath261 .     on each of the three types of faces ( left ) .",
    "two iterations of @xmath262 on the upper faces of a unit cube ( right ) .",
    ", scaledwidth=80.0% ]      in the previous section , dual maps have been defined over @xmath48 . here , we are interested in their action over @xmath85 , which is characterized by the main result of this section :    [ th : image_stepped_plane ] let @xmath218 be a unimodular morphism .",
    "let @xmath81 and @xmath82 .",
    "then , the action of @xmath225 on the stepped plane @xmath83 satisfies the equivalence : @xmath263    let @xmath264 .",
    "let us first compute @xmath242 , with @xmath265 being fixed .",
    "we write @xmath266 , where , for @xmath267 , @xmath268 and @xmath269 .",
    "each @xmath52 such that @xmath270 contributes to : + @xmath271 increment @xmath242 by @xmath148 for each @xmath272 such that @xmath273 and @xmath274 ; + @xmath271 decrement @xmath242 by @xmath148 for each @xmath272 such that @xmath275 and @xmath276 . + by introducing @xmath277 , for @xmath278 , the first case becomes : @xmath279 and the second : @xmath280 since @xmath270 if and only if @xmath281 , one computes : @xmath282 one then gets ( see fig .",
    "[ fig : proof_image_stepped_plane ] ) : @xmath283 last , note that one has : @xmath284 @xmath285 we can now rely on this computation to prove the claimed equivalences . if @xmath286 , then @xmath287 , and above computations yield that @xmath288 if and only if @xmath289 , _ i.e. _ , @xmath290 according to def .",
    "[ def : stepped_plane ] . on the contrary ,",
    "@xmath291 yields that there is @xmath212 such that @xmath292 , and above computations show that there is a face @xmath293 with @xmath294 , hence @xmath295 . other implications",
    "are straightforward .    , for @xmath296 .",
    "the value @xmath242 is equal to the number of times this broken line crosses upwards the line @xmath297 minus the number of times it crosses downwards this line .",
    "it is thus equal to @xmath148 if the first point is below this line and the last one above , @xmath165 if the first point is above this line and the last one below , and @xmath195 otherwise ( from left to right ) . ]",
    "[ fig : image_stepped_plane ] gives an example how a dual map acts on a stepped plane .",
    "note that the previous theorem in particular holds if @xmath219 is non - negative : in such a case , the image of any stepped plane is a stepped plane .",
    "+     under a dual map @xmath225 is a binary stepped function , then it is the stepped plane @xmath298 . ]",
    "[ rem : digitization_linear_group1 ] for any invertible matrix @xmath42 , one has @xmath299 this holds in particular for the incidence matrix @xmath300 of any unimodular morphism @xmath218 . in other words",
    ", @xmath301 maps a real plane of normal vector @xmath302 onto a real plane of normal vector @xmath303 . by comparing with the action of the dual map @xmath225 on stepped planes and by noting that stepped planes",
    "are digitizations of real planes , we get a more intuitive viewpoint : the action of dual maps over stepped planes can be seen as a digitization of the action of the linear group @xmath304 over real planes .",
    "[ rem : commutative_action1 ] according to th .",
    "[ th : image_stepped_plane ] , the image of a stepped plane under a dual map @xmath225 depends only on the incidence matrix of @xmath218 .",
    "this enables to make choice by picking a morphism whose incidence matrix is given ( we will rely on this in sec .",
    "[ sec : brun_expansions ] to define suitable _ brun substitutions _ ) .",
    "this is however generally false for a stepped function , for example , a single face .",
    "nevertheless , this does not contradict the fact that the action of @xmath218 on the free group is non - commutative and not characterized by @xmath219 .    to conclude this section ,",
    "let us stress two weakened statements of th .",
    "[ th : image_stepped_plane ] :    [ cor : image_stepped_plane ] let @xmath218 be a unimodular morphism .",
    "if the image of a stepped plane under @xmath225 is a binary stepped function , then it is a stepped plane : @xmath305    [ cor : positive_image_stepped_plane ] let @xmath218 be a unimodular morphism . if the incidence matrix of @xmath218 is non - negative , then @xmath225 maps any stepped plane onto a stepped plane : @xmath306      in this section , the notion of flip ( introduced in sec .",
    "[ sec : flips ] ) is used to extend the results of the previous section from stepped planes to stepped surfaces .",
    "the idea is to see stepped surfaces as flips performed on stepped planes .",
    "we first characterize the action of dual maps on flips :    [ prop : image_flip ] let @xmath218 be a unimodular morphism and @xmath62 .",
    "then , @xmath225 maps the flip located at @xmath35 onto the flip located at @xmath307 : @xmath308    let @xmath309 .",
    "fix @xmath265 and compute @xmath242 .",
    "as in the proof of th .",
    "[ th : image_stepped_plane ] , let us write @xmath266 , where , for @xmath267 , @xmath268 and @xmath269 , and let us introduce , for @xmath296 : @xmath310 first , def .",
    "[ def : dual_map ] yields : @xmath311 then , def .",
    "[ def : flip ] yields both : @xmath312 and : @xmath313 one deduces : @xmath314 since @xmath315 and @xmath316 , the above equation shows that @xmath317 . the result follows .",
    "we also need a technical lemma which plays the role of the @xmath286 condition of th .",
    "[ th : image_stepped_plane ] :    [ lem : positivement_orientable ] let @xmath218 be a unimodular morphism of the free group .",
    "if there is a stepped surface whose image under @xmath225 is a binary stepped function , then there is @xmath81 such that @xmath286 : @xmath318    for any stepped function @xmath46 of finite size , let @xmath319 be the vector of @xmath168 whose @xmath212-th entry is equal to the sum of the values of @xmath46 over @xmath320 ( @xmath321 plays on @xmath48 the role played on @xmath208 by the abelianization map @xmath214 ) . according to prop .  [ prop : image_face ] , one has : @xmath322 now , assume that @xmath89 is a stepped surface such that @xmath323 . for @xmath324 ,",
    "the restriction of @xmath89 to @xmath177 is a finite binary stepped function that we denote by @xmath325 .",
    "the vector @xmath326 is non - negative ; it is also non - zero for @xmath159 big enough . since @xmath327 is invertible",
    ", @xmath328 is also non - zero .",
    "we can thus define : @xmath329 these two vectors have norm @xmath148 and satisfy @xmath330 , where : @xmath331 by compactness , we can extract convergent sequences from the bounded sequences @xmath332 , @xmath333 and @xmath334 .",
    "let @xmath302 , @xmath335 and @xmath336 denote their respective limits : they are non - negative and satisfy @xmath337 .",
    "moreover , @xmath302 is non - zero since the @xmath338 have norm @xmath148 .",
    "this ends the proof .",
    "we are now in a position to extend th .",
    "[ th : image_stepped_plane ] ( more exactly , cor .",
    "[ cor : image_stepped_plane ] ) to the stepped surface case , by combining all the results previously obtained :    [ th : image_stepped_surface ] let @xmath218 be a unimodular morphism . if the image of a stepped surface under @xmath225 is a binary stepped function , then it is a stepped surface : @xmath339    assume that @xmath89 is a stepped surface such that @xmath323 .",
    "[ lem : positivement_orientable ] ensures that there is @xmath81 such that @xmath340 . since @xmath81 , prop .",
    "[ prop : pseudo_flip_acc ] thus yields that @xmath89 is pseudo - flip - accessible from the stepped plane @xmath341 : @xmath342 where , for any @xmath235 , @xmath269 and @xmath343 .",
    "the uniform continuity of @xmath225 gives : @xmath344 then , th .",
    "[ th : image_stepped_plane ] and prop .",
    "[ prop : image_flip ] imply : @xmath345 this shows that the binary stepped function @xmath346 is pseudo - flip - accessible from @xmath347 .",
    "[ prop : binary_pseudo_flip_acc ] thus finally yields that @xmath346 is a stepped surface .    fig .",
    "[ fig : image_stepped_surface ] illustrates this theorem . note",
    "that if @xmath300 is non - negative , then the image by @xmath348 of any stepped surface is a stepped surface .     is a binary stepped function , then it is a stepped surface . ]",
    "[ rem : digitization_linear_group2 ] the viewpoint according to which the action of dual maps over stepped planes is a digitization of the action of the linear group over real planes ( rem .",
    "[ rem : digitization_linear_group1 ] ) can be extended to stepped surfaces . indeed , by seeing a stepped surface as flips added to a stepped plane ( according to prop .",
    "[ prop : pseudo_flip_acc ] ) , the action of a dual map is decomposed into its action on a stepped plane and on flips , with each of them being moved according to the linear map @xmath301 ( according to prop .",
    "[ prop : image_flip ] ) .    as for stepped planes ( rem .",
    "[ rem : commutative_action1 ] ) , the action of dual maps over stepped surfaces only depends on incidence matrices . indeed , since it holds both for stepped planes and flips ( see prop .",
    "[ prop : image_flip ] ) , prop .  [ prop : pseudo_flip_acc ] easily yields the following :    [ theo : commutative_action2 ] let @xmath218 , @xmath247 be two unimodular morphisms with the same incidence matrix . if the image of of a stepped surface @xmath89 by @xmath348 is a binary stepped function , then its images by @xmath348 and @xmath349 do coincide .    to conclude this section ,",
    "let us show that the action of dual maps over stepped planes in the substitution case ( cor .",
    "[ cor : positive_image_stepped_plane ] ) admits a natural extension for stepped surfaces :    [ prop : positive_image_stepped_surface ] let @xmath218 be a unimodular morphism .",
    "if the incidence matrix of @xmath218 is non - negative , then @xmath225 maps any stepped surface onto a stepped surface : @xmath350    since the action of dual maps over stepped surfaces depends only on incidences matrices , we can w.l.o.g .",
    "assume that @xmath218 is non - negative .",
    "let us then show that @xmath351 and @xmath352 yield a contradiction . on the one hand , @xmath352 provides us @xmath353 such that @xmath354 .",
    "one even deduces from th .",
    "[ th : image_stepped_surface ] that @xmath355 . on the other hand , @xmath351 yields that the weights of faces in @xmath346 are non - negative , according to the expression of @xmath225 provided by prop .",
    "[ prop : image_face ] .",
    "thus , @xmath355 means that there are two distinct faces @xmath356 and @xmath357 with weight @xmath148 in @xmath89 whose images under @xmath225 `` overlap '' , _",
    "i.e. _ , for some @xmath358 : @xmath359 note that @xmath360 yields @xmath361 .",
    "assume , w.l.o.g .",
    ", that @xmath362 is shorter than @xmath363 .",
    "one computes : @xmath364 let us now introduce the two following integer vectors : @xmath365 they respectively belong to the geometric interpretation of @xmath356 and @xmath357 .",
    "moreover , one has : @xmath366 the wanted contradiction thus follows from prop .",
    "[ prop : stepped_surface ] .",
    "this section provides an interpretation of multi - dimensional continued fraction algorithms in terms of dual maps acting on stepped planes or surfaces .      in the one - dimensional case",
    ", there is a canonical continued fraction algorithm , namely the euclidean algorithm . in the multi - dimensional case",
    ", there is no such canonical algorithm , and several different definitions have been proposed ( see brentjes @xcite or schweiger @xcite for a summary ) . here",
    ", we follow the definition of lagarias @xcite , where multi - dimensional continued fraction algorithms produce sequences of matrices in @xmath222 . we first state the general definition of such algorithms , and then detail one of them , namely the brun algorithm .",
    "[ def : continued_fraction ] let @xmath367 and @xmath368 .",
    "elements of @xmath369 are called _",
    "terminal_. a @xmath15-dimensional _ continued fraction map _ over @xmath25 is a map @xmath370 such that @xmath371 and , for any @xmath372 , there is @xmath373 satisfying : @xmath374 the associated _ continued fraction algorithm _ consists in iteratively applying the map @xmath375 on a vector @xmath372 .",
    "this yields the following sequence of matrices , called the _ continued fraction expansion _ of @xmath302 : @xmath376 this expansion is said to be _ finite _ if there is @xmath159 such that @xmath377 , infinite otherwise . in the former case ,",
    "the smallest such @xmath159 is called the _ length _ of the expansion .",
    "the jacobi - perron , poincar , selmer or brun algorithms match this definition .",
    "+ the intuitive principle of a continued fraction algorithm is that each application of the map @xmath375 captures a partial information about @xmath302 , with all the information being captured by the whole expansion .",
    "a good algorithm should capture as much as possible information with as less as possible matrices .",
    "this can be formalized by various notions of _ convergence _ for continued fraction algorithms . here",
    ", let us just recall _ weak convergence_. + we say that a sequence @xmath378 of non - zero vectors tends _ in direction _ towards a non - zero vector @xmath379 if @xmath380 tends towards @xmath381 , that is @xmath382    [ def : weak_cv ] a muldi - dimensional continued fraction algorithm is said to be _ weakly convergent _ in @xmath372 if the expansion @xmath383 of @xmath302 is such that the sequence @xmath384 tends in direction towards @xmath302 , uniformly for @xmath385",
    ".    in particular , weakly convergent continued fraction algorithms allow to approximate real vectors by sequences of rational vectors .",
    "indeed , let @xmath302 be a @xmath386-dimensional real vector of @xmath25 for @xmath387 .",
    "let then @xmath388 be the continued fraction expansion of the @xmath15-dimensional vector @xmath389 , that is , for all @xmath390 , @xmath391 , and define : @xmath392 where @xmath393 is a @xmath15-dimensional vector and @xmath394 is a @xmath395-dimensional vector .",
    "the sequence @xmath396 is thus a sequence of @xmath395-dimensional rational vectors , and the weak convergence ensures that it tends towards @xmath302 .",
    "+ let us end this section by presenting the _ brun algorithm _",
    ", one of the most classical multi - dimensional continued fraction algorithms matching def .",
    "[ def : continued_fraction ] ( see @xcite and @xcite ) . in this case",
    ", @xmath25 is the set of non - zero non - negative @xmath15-dimensional real vectors , and a vector of @xmath25 is _ terminal _ if it has only one non - zero entry : @xmath397 for @xmath398 , @xmath399 is the @xmath41 identity matrix @xmath400 , and for @xmath401 , we set : @xmath402 where @xmath212 and @xmath240 are the indexes of , respectively , the first and second largest entries of @xmath302 ( with the smallest index being taken into account if several entries are equal ) , and @xmath403 is the integer part of the quotient of the @xmath212-th entry by the @xmath240-th one ensures that this @xmath240-th entry is non - zero , hence @xmath403 is well defined . ] . in other words , for @xmath404 , let @xmath405 be the lexicographically smallest pair of integers in @xmath207 satisfying : @xmath406 note that @xmath407 .",
    "the map @xmath375 of def .",
    "[ def : continued_fraction ] is called the _",
    "brun map_. one has for all @xmath408 : @xmath409    according to this definition , each step of the brun algorithm consists in , first , subtracting @xmath403 times the second largest entry of a vector of @xmath410 to its first largest entry ( that is , as many times as this first entry remains non - negative ) , and second , in exchanging both entries . in the @xmath80 case , we thus recover the euclidean algorithm .",
    "let us conclude by recalling that the brun algorithm is weakly convergent ( see , _",
    "e.g. _ , @xcite ) .      in this section ,",
    "we show how brun expansions of vectors can be naturally extended to brun expansions of stepped planes , providing a new geometric viewpoint .",
    "more generally , we want to define over binary functions a map @xmath411 whose restriction over the set of stepped planes satisfies , for any @xmath412 and @xmath82 : @xmath413 this can be easily done thanks to dual maps . indeed , for any invertible morphism @xmath414 whose incidence matrix is equal to the unimodular matrix @xmath399 , th .  [",
    "th : image_stepped_plane ] yields , by using the fact that @xmath415 : @xmath416 for example , we can choose for @xmath414 the brun substitution @xmath251 introduced in ex .",
    "[ ex : brun_substitutions ] ( hence the name ) .",
    "this is the choice we do throughout the present paper .",
    "+ however , we also would like an _ effective _ and _ geometric _ definition of @xmath411 based on `` local '' data : the way the image of a stepped plane @xmath417 is defined should rely only on @xmath417 ( seen as a binary stepped function ) and not , as above , on its normal vector ( which is not assumed to be known ) .",
    "let us show that this can be done by introducing the notion of _ run _ , which will allow us to give a multi - dimensional analogue of the fact that factors @xmath2 and @xmath3 can not occur simultaneously in a sturmian word :    [ def : run ] let @xmath418 in @xmath207 with @xmath419 .",
    "let @xmath166 be a binary stepped function .",
    "@xmath420-run _ of @xmath166 is a non - zero binary function @xmath421 which can be written : @xmath422 where @xmath62 and @xmath423 is maximal among the intervals of @xmath19 such that @xmath424 .",
    "such a run is said to be of _ type _ @xmath420 and to have _ length _ @xmath425 .",
    "in other words , the geometric interpretation of a length @xmath235 @xmath420-run of a binary function @xmath166 is a maximal sequence of @xmath235 contiguous faces of type @xmath212 , aligned with the direction @xmath426 and included in the geometric interpretation of @xmath166 ( fig .",
    "[ fig : runs ] ) .",
    "+    -runs of length @xmath427 and @xmath79 ( left , framed runs ) and of a stepped surface with @xmath428-runs of length @xmath427@xmath429 ( right , framed runs )  see also fig .",
    "[ fig : faces ] for the directions @xmath71 and for the labeling of the faces . ]",
    "a stepped plane has @xmath420-runs if and only if its geometric interpretation contains the geometric interpretation of a type @xmath212 face .",
    "it follows from def .",
    "[ def : stepped_plane ] that this holds if and only if the @xmath212-th entry of the normal vector of this stepped plane is non - zero . in this case",
    ", we can characterize the length of @xmath420-runs :    [ prop : runs_stepped_plane ] let @xmath418 in @xmath207 with @xmath419 .",
    "let @xmath83 be a stepped plane , with @xmath404 and @xmath430 .",
    "consider the @xmath420-runs of @xmath83 . if @xmath431 , these runs are all infinite . if @xmath432 , they have all length @xmath433",
    "otherwise , there are runs of length @xmath434 and runs of length @xmath435 .    since @xmath430 , then @xmath83 has @xmath420-runs .",
    "let @xmath421 be an @xmath420-run of @xmath83 : @xmath422 where @xmath62 and @xmath436 .",
    "we first assume that @xmath431 .",
    "then , according to def .",
    "[ def : stepped_plane ] , for any @xmath437 , @xmath438 , _",
    "i.e. _ , @xmath439 .",
    "by maximality of @xmath423 , this implies @xmath440 .",
    "+ let us now also assume @xmath441 : @xmath423 is thus finite , say @xmath442 .",
    "on the one hand , one checks : @xmath443,\\ ] ] @xmath444.\\ ] ] the intervals @xmath445 $ ] and @xmath446 $ ] thus have a non - empty intersection .",
    "this yields : @xmath447 on the other hand , one checks : @xmath448,\\ ] ] @xmath449.\\ ] ] since one already knows that @xmath450 $ ] , this yields : @xmath451 the two above inequalities allow us to bound the length @xmath452 of @xmath423 : @xmath453 that is : @xmath454 with @xmath455 and @xmath456 standing , respectively , for the floor and the ceiling of @xmath457 . + this proves that the @xmath420-runs can only have the two claimed lengths .",
    "+ it remains to show that these lengths indeed occur .",
    "remark that for @xmath458 or @xmath459 , both lengths are in fact equal ( resp . to @xmath148 and @xmath403 ) : there is nothing to show .",
    "let us now assume that @xmath460 and @xmath461 .",
    "suppose that all the @xmath420-runs of @xmath83 have the same length , say @xmath403 , and let us obtain a contradiction .",
    "consider the @xmath462-runs of @xmath83 : according to what preceeds , they exist and can only have length @xmath463 and @xmath464 , that is , length @xmath148 .",
    "roughly speaking , this enforces @xmath83 to alternate @xmath420-runs of length @xmath403 and @xmath462-runs of length @xmath148 .",
    "more precisely , @xmath83 is larger than the following ( infinite ) binary stepped function : @xmath465 in particular , this yields @xmath466 for any @xmath467 , and thus : @xmath468 by dividing by @xmath469 and by taking the limit when @xmath470 goes to infinity , we get @xmath471 , _",
    "i.e. _ , @xmath472 .",
    "this contradicts the assumption @xmath461 .",
    "we deduce that @xmath462-runs runs of both lengths @xmath473 and @xmath474 occur in @xmath83 .",
    "the previous proposition allows us to deduce partial information about the normal vector of a stepped plane from its runs .",
    "for example , one can compare the entries of the ( unknown ) normal vector @xmath404 of a given stepped plane .",
    "indeed , one has @xmath475 if and only if @xmath476 , _",
    "i.e. _ , if and only if this stepped plane has an @xmath420-run of length at least @xmath427 .",
    "more precisely , let us show that runs contain enough information to give an effective definition of the map @xmath411 ( discussed in the beginning of this section ) . for the sake of generality , we state a definition for binary stepped functions ( as for runs  recall def .  [ def : run ] ) :    [ def : tilde_t ] let @xmath411 be the map defined over binary stepped functions as follows .",
    "let @xmath477 .",
    "assume that there are @xmath478 with @xmath419 satisfying the two conditions :    1 .",
    "for any @xmath479 , all @xmath480- and @xmath481-runs ( if any ) of @xmath166 have length @xmath148 ; 2 .",
    "@xmath166 has at least one finite @xmath420-run .",
    "take for @xmath405 the lexicographically smallest pair which satisfies cond . 1 and 2 ( with @xmath482 , and let @xmath403 be the length of the shortest @xmath420-run of @xmath166 .",
    "we set : @xmath483 otherwise , we set @xmath484 .",
    "this defines a map @xmath411 from @xmath74 to @xmath48 which satisfies the wanted property :    [ th : tilde_t_stepped_plane ] for any @xmath81 and @xmath82 , one has : @xmath413    let us consider a stepped plane @xmath83 , and let us write @xmath404 .",
    "first , let us assume that there are @xmath212 and @xmath240 satisfying the two conditions stated in def .",
    "[ def : tilde_t ] . on the one hand , the first condition yields following from the @xmath485 case . ] : @xmath486 on the other hand , the second condition ensures @xmath441 .",
    "we deduce from prop .",
    "[ prop : runs_stepped_plane ] that @xmath487 .",
    "the result then follows from th .",
    "[ th : image_stepped_plane ] and from the definition of the brun map @xmath375 .",
    "+ let us now assume that there is no @xmath212 and @xmath240 satisfying the two conditions .",
    "let @xmath488 and @xmath489 be respectively the first and the second largest entry of @xmath302 . as",
    "previously , it follows from prop .",
    "[ prop : runs_stepped_plane ] that @xmath212 and @xmath240 satisfy the first condition .",
    "they thus can not satisfy the second one , that is , there is no finite @xmath420-run .",
    "[ prop : runs_stepped_plane ] thus yields @xmath431 , that is , @xmath302 has only one non - zero entry .",
    "in such a case , the definition of @xmath375 yields @xmath490 . the result follows .",
    "[ ex : runs_stepped_plane ] consider the stepped plane corresponding to fig .",
    "[ fig : runs ] ( left ) .",
    "one has :    [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     assume that @xmath491 yields @xmath492 .",
    "the above table shows that @xmath493 takes values in @xmath1 , except in the second and seventh cases . in the second case , @xmath494 yields @xmath495 , and @xmath496 yields either @xmath497 , or @xmath498 .",
    "this ensures @xmath491 , and thus @xmath492 .",
    "but it is not compatible with @xmath499 and @xmath500 : this case is ruled out . in the seventh case , @xmath270 yields @xmath501 .",
    "but @xmath502 yields @xmath503 : this case is also ruled out .",
    "this proves that @xmath493 is a binary function .",
    "[ prop : binary_pseudo_flip_acc ] then ensures that it is a stepped surface , as it is pseudo - flip - accessible from a stepped plane .",
    "the `` if '' part is proven .",
    "+ conversely , assume that @xmath493 is a stepped quasi - plane .",
    "it is thus a binary function .",
    "this rules out the second and the seventh cases .",
    "one then checks that all the other cases are compatible with @xmath492 , except the sixth one . in this case ,",
    "@xmath270 yields @xmath504 , and @xmath494 yields @xmath495 .",
    "this ensures that @xmath505 is non - zero .",
    "the `` only if '' part is proven .    we can now state the main result of this section ( recall that @xmath506 stands for the set of stepped surfaces having the same brun expansion as @xmath412 ) :    [ th : weak_cv_surfaces ] let @xmath81 . for any @xmath507",
    ", there is @xmath508 such that if @xmath302 has a brun expansion of length at least @xmath509 , then any stepped surface in @xmath506 is at distance at most @xmath209 from a stepped quasi - plane of normal vector @xmath302 .",
    "in other words , the longer the brun expansion of a stepped surface is , the closer it is to a stepped quasi - plane whose normal vector has the same brun expansion . before proving this theorem , let us state a corollary in the particular case of infinite brun expansions :    [ cor : tot ] if a stepped surface has the same infinite brun expansion as a vector @xmath81 , then it is a stepped quasi - plane of normal vector @xmath302 . if , moreover , @xmath302 is totally irrational ,",
    "i.e. _ , @xmath510 , then this stepped surface is a `` generalized '' stepped plane , _",
    "i.e. _ , it matches def .",
    "[ def : stepped_plane ] but with strict and non - strict inequalities possibly interchanged .",
    "the first statement is a direct consequence of th .",
    "[ th : weak_cv_surfaces ] .",
    "assume now that @xmath302 is totally irrational .",
    "then , @xmath511 is satisfied for at most one @xmath512 , hence the defect @xmath513 has cardinality at most one .",
    "if @xmath513 is empty , then one gets the stepped plane @xmath514 ( recall def .  [ def : stepped_plane ] ) .",
    "otherwise , one gets the stepped surface @xmath515 , which is a `` generalized '' stepped plane since it satisfies : @xmath516 note that the set of vertices of the geometric interpretation of such a `` generalized '' stepped plane is still a digitization of a euclidean plane , namely a standard arithmetic discrete plane .",
    "let us now prove th .",
    "[ th : weak_cv_surfaces ] .",
    "we first need the following technical lemma which , informally , translates weak convergence of the brun algorithm for real vectors ( def .",
    "[ def : weak_cv ] ) into flip divergence for stepped surfaces :    [ lem : transfer ] let @xmath81 . for any @xmath517",
    ", there is @xmath518 such that if the brun expansion @xmath383 of @xmath302 has length at least @xmath509 , then any integer vector @xmath35 which is neither positive nor negative satisfies : latexmath:[\\[\\langle b_1^{-1}\\ldots b_n^{-1}\\vec{x}|\\vec{\\alpha}\\rangle\\neq 0 ~\\rightarrow~     let @xmath27 be an integer vector which is neither positive nor negative .",
    "it admits an orthogonal vector @xmath520 .",
    "indeed , if there is @xmath212 such that @xmath521 , then @xmath522 suits . otherwise , there are @xmath212 and @xmath240 such that @xmath523 and @xmath524 , and one checks that @xmath525 suits . then , @xmath526 yields : @xmath527 thus , for any @xmath159 , the vectors @xmath173 and @xmath528 defined by @xmath529 and @xmath530 are orthogonal .",
    "the point is that weak convergence of the brun algorithm ensures that the sequence @xmath531 tends in direction towards @xmath302 .",
    "what does it yield for the sequence @xmath532 ? to answer this question , let us introduce the set @xmath533 of neither positive nor negative integer vectors which do not belong to @xmath44 .",
    "for any @xmath534 , the number @xmath535 defined as follows is positive : @xmath536 moreover , one checks that any two orthogonal unitary vectors @xmath90 and @xmath537 satisfy : @xmath538 indeed , let us write @xmath539 with @xmath540 and @xmath541 and , similarly , @xmath542 .",
    "we deduce from @xmath543 that @xmath544 this yields @xmath545 and the claim follows , since the mapping @xmath546 is monotonically increasing : @xmath547 let us now fix @xmath534 . according to the weak convergence of the brun algorithm , there is @xmath518 such that @xmath548 .",
    "the above inequality then ensures @xmath549 , and the definition of @xmath535 yields @xmath550 .",
    "hence , @xmath551 implies @xmath552 .",
    "this ends the proof .",
    "we also need the following lemma , which derives from prop .",
    "[ prop : stepped_surface ] and [ prop : pseudo_flip_acc ] :    [ lem : zarbi ] let @xmath89 and @xmath144 be two stepped surfaces whose geometric interpretations both contain @xmath119 .",
    "then , there exist a sequence @xmath532 of neither positive nor negative integer vectors and a sequence @xmath553 with values in @xmath554 such that : @xmath555    according to prop .",
    "[ prop : pseudo_flip_acc ] , there exist a sequence @xmath532 of integer vectors and a sequence @xmath553 with values in @xmath554 such that : @xmath555 moreover , by looking more carefully at the proof of prop .",
    "[ prop : pseudo_flip_acc ] , one sees that any flip @xmath556 is located _ between _ @xmath89 and @xmath144 .",
    "more precisely , there are two integer vectors @xmath528 and @xmath557 in the geometric interpretations of @xmath89 and @xmath144 , respectively , such that @xmath558 , with either @xmath559 if @xmath173 is above @xmath89 and strictly below @xmath144 , or @xmath560 $ ] if @xmath173 is above @xmath144 and strictly below @xmath89 ( only these cases occur ) .",
    "then , @xmath561 yields @xmath562 in the former case and @xmath563 in the latter case , while @xmath564 yields @xmath565 in the former case and @xmath566 in the latter case .",
    "[ prop : stepped_surface ] together with the fact that the geometric interpretations of @xmath89 and @xmath144 both contain @xmath119 ensure that @xmath528 and @xmath557 are neither positive nor negative , which is thus also the case for @xmath173 .",
    "the result follows .",
    "we are now in a position to prove th .",
    "[ th : weak_cv_surfaces ] :    let us fix @xmath507 .",
    "let @xmath509 be a positive integer .",
    "we will determine @xmath509 more precisely later .",
    "let @xmath567 and let @xmath383 denote the common brun expansion of @xmath89 and @xmath302 . on the one hand , one has @xmath568 where @xmath569 is the brun substitution of incidence matrix @xmath570 . since , for two unimodular morphisms @xmath218 and @xmath247 , one has @xmath571 , this yields @xmath572 on the other hand , since @xmath573 , prop .  [ prop : pseudo_flip_acc ] ensures that the stepped surface @xmath574 can be written @xmath575 where @xmath576 and @xmath577 for all @xmath578 . note that @xmath579 has _ a priori",
    "_ no reason for being a defect .",
    "moreover , since the brun expansion of a stepped surface is translation - invariant , one can assume that @xmath119 belongs to the geometric interpretation of @xmath574 .",
    "note that @xmath119 also belongs to the geometrical interpretation of @xmath580 , since any face @xmath581 belongs to a stepped plane of intercept @xmath195 ( hence the choice of intercept @xmath195 here ) .",
    "thus , according to lem .",
    "[ lem : zarbi ] , one can assume that vectors of @xmath579 are neither positive nor negative .",
    "let us now go back to @xmath89 .",
    "one deduces from the two above equalities : @xmath582 using th .",
    "[ th : image_stepped_plane ] and prop .",
    "[ prop : image_flip ] and that the matrices @xmath570 are symmetric , this yields @xmath583 let us now assume that @xmath509 is given by lem .",
    "[ lem : transfer ] with @xmath584 .",
    "we split @xmath579 into two parts @xmath585 and @xmath586 , where @xmath587 this leads to rewrite @xmath89 as follows : @xmath588 on the one hand , since vectors of @xmath579 ( hence of @xmath586 ) are neither positive nor negative , one can apply lem .",
    "[ lem : transfer ] , which ensures that the flips located at @xmath589 for @xmath590 are located outside @xmath591 .",
    "thus @xmath592 on the other hand , for @xmath593 and @xmath594 , one has @xmath595 is a stepped quasi - plane of normal vector @xmath302 .",
    "but it is not clear that @xmath596 is a suitable defect , _",
    "i.e. _ , satisfies the characterization of prop .",
    "[ prop : suitable_defect ] .",
    "therefore , we slightly modify @xmath596 into the set @xmath597 defined by @xmath598 which satisfies the characterization of prop .",
    "[ prop : suitable_defect ] .",
    "moreover , @xmath596 and @xmath597 coincide on @xmath591 ( otherwise @xmath599 would not coincide on this ball with a stepped surface , namely @xmath89 ) .",
    "thus , by replacing @xmath596 by @xmath597 in the expression of @xmath599 , we get a new stepped function @xmath600 , which is a stepped quasi - plane of normal vector @xmath302 and satisfies : @xmath601 finally , @xmath89 is at distance at most @xmath209 from @xmath600 .",
    "the result follows .",
    "let us summarize the strategy we have followed for defining a continued fraction expansion of stepped planes and stepped surfaces .",
    "we start from a multi - dimensional continued fraction algorithm formulated with unimodular matrices , namely the brun algorithm .",
    "we then interpret these unimodular matrices as incidence matrices of well - chosen morphisms , namely brun substitutions , with this choice being highly non - canonical .",
    "we finally use the formalism of dual maps to associate with these unimodular matrices geometric maps acting on stepped planes and stepped surfaces .",
    "+ let us stress that we are not only able to substitute , _",
    "i.e. _ , to replace facets of hypercubes by unions of facets , but also to desubstitute , _",
    "i.e. _ , to perform the converse operation , by using the algebraic property @xmath602 .",
    "we thus define a desubstitution process on geometric objects : local configurations determine the choice of the brun substitution whose inverse dual map is applied .",
    "we then show that any infinitely desubstituable stepped surface is almost a stepped plane ( th .",
    "[ th : weak_cv_surfaces ] ) . in particular",
    ", there are thus very few such surfaces .",
    "this can seem disappointing , but this suggests an effective way to check planarity of a given stepped surface by computing its brun expansion , since the longer this expansion is , the more planar the surface is . in @xcite , we rely on the theoretical background here provided to obtain original algorithms for both _ digital plane recognition _ and _ digital plane generation _ problems .",
    "+ we also plan to extend our approach to higher codimensions .",
    "indeed , stepped planes or surfaces here considered can be seen as codimension @xmath148 canonical projection tilings .",
    "roughly speaking , a dimension @xmath15 and codimension @xmath235 canonical projection tiling is a tiling of @xmath603 obtained by projecting onto @xmath603 the @xmath604-dimensional unit facets lying in a  slice ",
    "@xmath605 of @xmath17 , where @xmath606 is a @xmath604-dimensional affine space ( see , for more details , @xcite ) .",
    "a first step in this direction is provided in @xcite .",
    "+ last , note that if a stepped plane has a purely periodic brun expansion , then it is a fixed - point of a dual map , namely the dual map of the composition of the brun substitutions associated with this brun expansion .",
    "it is however unclear whether this property characterizes fixed - point stepped planes , mainly because of the lack of a lagrange - like theorem for multi - dimensional continued fraction algorithms ( see the discussion in @xcite ) .",
    "a way to tackle this problem could be to extend in our multi - dimensional framework the approach of @xcite .",
    "we also would like to characterize linearly recurrent stepped planes in terms of their brun expansions .",
    "we would like to warmly thank the anonymous referees of a previous version of the present paper for their careful reading and their numerous and very valuable remarks ( in particular , the clearer proof of prop .",
    "[ prop : stepped_surface ] , here given ) .",
    "f.  durand , _ linearly recurrent subshifts have a finite number of non - periodic subshift factors _ , ergod .",
    ". sys . * 20 * ( 2000 ) , 10611078 .",
    "_ corrigendum and addendum to : linearly recurrent subshifts have a finite number of non - periodic factors _ , ergod .",
    "* 23 * ( 2003 ) , 663669 ."
  ],
  "abstract_text": [
    "<S> _ dual maps _ have been introduced as a generalization to higher dimensions of word substitutions and free group morphisms . in this paper , we study the action of these dual maps on particular discrete planes and surfaces  namely _ stepped planes _ and _ stepped surfaces_. we show that dual maps can be seen as discretizations of toral automorphisms . </S>",
    "<S> we then provide a connection between stepped planes and the _ brun _ multi - dimensional continued fraction algorithm , based on a desubstitution process defined on local geometric configurations of stepped planes . by extending this connection to stepped surfaces </S>",
    "<S> , we obtain an effective characterization of stepped planes ( more exactly , _ stepped quasi - planes _ ) among stepped surfaces . </S>"
  ]
}