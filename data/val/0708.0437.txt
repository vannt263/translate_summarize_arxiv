{
  "article_text": [
    "we consider the model reduction problem for stable , discrete - time periodic systems , using an approximation of balanced trunctation .",
    "in particular , we combine the lifting approach developed in  @xcite with a snapshot - based approximation described in  @xcite , which is tractable even for very high - dimensional systems , on the order of millions of states .",
    "several different algorithms are available for extending balanced truncation from linear time - invariant systems to time - periodic systems ( see , e.g. , @xcite ) . here , our interest is in systems with very large state dimension , on the order of tens of thousands or millions , for which the algorithms used in these previous approaches become intractable .",
    "such systems arise in the control of systems governed by partial differential equations , for instance in fluid mechanics , where often one approximates the full infinite - dimensional dynamics by a high - dimensional discretization .",
    "periodic systems may arise in these settings either as linearizations around a periodic orbit ( e.g. , vortex shedding  @xcite ) , or as linearizations of a system with periodic open - loop forcing ( e.g. , periodic pulsed blowing ) .",
    "the goal of this paper is to describe a model reduction procedure that closely approximates balanced truncation , yet is computationally tractable even for these high - dimensional systems .",
    "the resulting reduced - order models may be used for control synthesis , or other studies where the full high - dimensional system is unwieldy .",
    "we suppose that while the number of states and outputs are both very large , the number of control inputs is small ( by duality , we may alternatively assume that the number of outputs is small ) .",
    "this case is also typical in practice , in which one often has a small number of actuators , or sources of disturbances , that one wants to model .",
    "we also assume that the system is asymptotically stable .",
    "key ideas in the method presented here involve the computation of the balancing transformation directly from snapshots , without computing the controllability and observability gramians , which become prohibitively large for these systems ; and two different output projection methods for tractable computation with systems with high - dimensional output spaces .",
    "the paper is organized as follows : in section  [ background_sec ] we summarize an existing approach to balanced truncation for time - periodic systems , and the corresponding lifted time - invariant reformulation . in section  [ bpod_sec ]",
    "we present the main results , an approximate method based on snapshots , and an output projection based on the lifting approach that makes the snapshot method feasible for large numbers of outputs . in section  [ example_sec ] ,",
    "we demonstrate the method on a numerical example .",
    "consider a discrete linear time - periodic system @xmath0 with state variable @xmath1 , input @xmath2 and output @xmath3 , and @xmath4 , where the matrices @xmath5 , @xmath6 and @xmath7 are @xmath8-periodic ( e.g. , @xmath9 for all  @xmath10 ) .",
    "we assume that this system is asymptotically stable , in the following sense : defining @xmath11 for @xmath12 , with @xmath13 , the @xmath14 identity matrix , we consider the case where the spectral radius  @xmath15 is smaller than  @xmath16 .",
    "note that periodicity implies that the non - zero eigenvalues of @xmath17 are independent of time  @xmath18 @xcite , whereby asymptotic stability is equivalent to uniform geometric decay , as in the lti case .",
    "many different approaches are available for model reduction , including singular perturbation  @xcite , hankel norm reduction , and balanced truncation .",
    "balanced truncation  @xcite has become a widely used method for linear systems , since it has a priori error bounds comparable to other methods , and is computationally tractable , at least for systems of moderate dimension , say @xmath19 .",
    "however , for very large systems , exact balanced truncation becomes computationally intractable , as the procedure involves finding coordinate transformations that simultaneously diagonalize non - sparse @xmath14 matrices ( controllability and observability gramians ) . to overcome this difficulty , a snapshot - based method has been proposed for approximate balanced truncation  @xcite , sometimes referred to as _ balanced proper orthogonal decomposition _",
    "( balanced pod ) . here , the idea is to use `` empirical gramians '' defined using snapshots of a simulation of the system , as in  @xcite , and to compute the balancing transformation directly from the snapshots , without ever computing the gramians .",
    "the method of balanced truncation has been applied to linear time - periodic systems using several different approaches .",
    "one approach , used in  @xcite , is to perform @xmath8 separate balanced truncations along a period .",
    "an alternative , suggested by  @xcite , is a lifting approach , in which balanced truncation is applied to a time - invariant reformulation .",
    "however , both of these approaches require the solution of lyapunov equations or inequalities and are not computationally tractable for very large systems . thus , the objective of our work is to obtain more computationally efficient algorithms for computing approximate balanced truncations for these large systems .    before reviewing the theory for periodic systems , first recall the main idea of balanced truncation for linear time - invariant ( lti ) stable systems ( for more detail , see standard textbooks , such as  @xcite ) .",
    "one begins by defining controllability and observability gramians @xmath20 and @xmath21 to measure to what degree each state is excited by an input , and each state excites future outputs , respectively .",
    "one then seeks a coordinate transformation @xmath22 , called balancing transformation , so that the transformed gramians @xmath23 and @xmath24 are equal and diagonal ( hence balanced ) : @xmath25 , where @xmath26 are the hankel singular values .",
    "finally , in these new coordinates , one truncates the states that are least controllable and observable , corresponding to the smallest hankel singular values .      for time - periodic systems",
    ", one may also define controllability and observability gramians , as in  @xcite .",
    "the _ controllability gramian at time @xmath18 _ , @xmath27 , and _",
    "observability gramian at time @xmath18 _ , @xmath28 , for the complex stable periodic system ( [ lps ] ) are defined similarly by the following two positive - semidefinite @xmath14 matrices @xmath29 where the superscript @xmath30 denotes the adjoint of a linear operator .",
    "see the appendix for the specific properties these gramians satisfy .",
    "both @xmath27 and @xmath28 are @xmath8-periodic .",
    "also , for each @xmath18 , @xmath27 and @xmath28 satisfy the following respective discrete lyapunov equations : @xmath31 as discussed in the appendix , when convergent , the definitions ( [ grammian_def ] ) ( equivalently ,  ( [ lyapunoveqn ] ) ) extend to general linear time - varying systems of the form  ( [ lps ] ) , with the same interpretations in terms of input - to - state and state - to - output mappings .",
    "if the dimension  @xmath32 of the system is not too large , it is possible to solve the above pairs of lyapunov equations for gramians @xmath27 , @xmath28 for each @xmath18 , @xmath33 .",
    "one can then do balanced truncation _ at each time @xmath18_. refer to @xcite , @xcite , @xcite for detailed discussions .",
    "note that farhood et al .",
    "@xcite also compute the gramians / generalized gramians by solving corresponding lyapunov equations / inequalities at each time step ; however , the balanced truncation is then realized in a lifted time - invariant setting , not in the original periodic one . in this paper",
    "we will also use the lifting approach , in conjunction with a method of snapshots as in @xcite .      as discussed in  @xcite , the linear periodic time - variant system ( [ lps ] )",
    "can be equivalently rewritten as a linear time invariant ( lti ) system : @xmath34 where @xmath18 is fixed and @xmath35 and @xmath36\\\\ \\tilde{c}_j&=\\begin{bmatrix } c(j)\\\\c(j+1)f(j+1,j)\\\\\\vdots\\\\c(j+t-1)f(j+t-1,j ) \\end{bmatrix}\\\\ \\tilde{d}_j&=\\begin{bmatrix } 0 & & & 0\\\\f_{j,2,1}&0 & & \\\\\\vdots & \\vdots & \\ddots & \\\\f_{j , t,1 } & f_{j , t,2 } & \\cdots & 0 \\end{bmatrix},\\end{aligned}\\ ] ] where @xmath37 .",
    "we refer to the time invariant system ( [ lti_sys ] ) as a _ lifted system at time @xmath18 _ , in which @xmath38 , @xmath39 , @xmath40 and @xmath41 are constant matrices .",
    "the lifted system may be viewed as a poincar map of the original periodic system in the state space at times @xmath42 , while the input and output information for an entire period is kept at each iteration of the poincar map .",
    "the controllability gramian @xmath43 and observability gramian @xmath44 for this lti lifted system are conventionally defined by the two positive - semidefinite @xmath14 matrices @xmath45 they respectively satisfy the following discrete lyapunov equations : @xmath46 the above setting allows one to study the lifted lti system instead of the original periodic one such that the well - developed balanced truncation techniques for lti systems are available .",
    "we emphasize that in the lifted lti system , only one time of balanced truncation is needed .",
    "however , the drawbacks of working on the lifted system are that it has even higher dimensional inputs and outputs , and that we usually do not have the explicit form of the lifted system in computations .",
    "the approach taken in this paper is as follows : _ by using the equivalence between the lti ( lifted ) and time - periodic systems , we apply the balanced pod procedure in the lti setting but do computations in the original periodic setting_. to realize this plan , first we list the following statement establishing the equivalent relations between the gramians of the lifted system and the original periodic system .",
    "proofs are by direct calculations , using periodicity .    consider an arbitrary time @xmath18 .",
    "the controllability and observability gramians at time @xmath18 of the periodic system ( [ lps ] ) , i.e. , @xmath27 and @xmath28 given by ( [ grammian_def ] ) are respectively equal to the controllability and observability gramians @xmath43 and @xmath44 of the lifted system ( [ lti_sys ] ) at time @xmath18 given by ( [ grammian_def_lti ] ) .",
    "[ prop gramian contrl observ ]    an immediate corollary from the above statement is that , as stated in  @xcite ,  @xcite , solutions of the time - varying lyapunov equations  ( [ lyapunoveqn ] ) are equivalent to the solution of the time - invariant lyapunov equations  ( [ lyapunoveqn_lti ] ) in the lifted setting .",
    "this result plays an important role in traditional lifting approaches of balanced truncations for periodic systems , where the gramians are found by solving lyapunov equations . in the following section ,",
    "we show how proposition  [ prop gramian contrl observ ] allows us to apply a snapshot - based algorithm for computing balancing transformations for periodic systems , thereby avoiding the need to solve lyapunov equations .",
    "the method of snapshots provides a numerical approximation of gramians directly based on their definitions .",
    "refer to @xcite and the references therein for the application of this method to linear time - invariant systems .    for time - varying discrete systems , first",
    ", we define the _ empirical controllability gramian _ and _ empirical observability gramian _ at time @xmath18 for the periodic system ( [ lps ] ) as @xmath47 where @xmath48 is a nonnegative integer . clearly , @xmath49 ; @xmath50 .",
    "further , the following result gives upper error bounds of @xmath51 and @xmath52 .",
    "consider an arbitrary time @xmath18 .",
    "let @xmath53 , where @xmath54 is a nonnegative integer . for the linear periodic system ( [ lps ] ) , @xmath55 where an induced norm is used .",
    "[ lemma empirical gramian error bound lps ]    the proof is based on the following result for linear time - invariant systems .",
    "consider a linear stable time - invariant system @xmath56 where @xmath57 , @xmath58 and @xmath59 are constant matrices and whose controllability and observability gramians are @xmath60 and @xmath61",
    ". define the empirical controllability and observability gramians for this lti system as @xmath62 where @xmath54 is a nonnegative integer .",
    "thus , @xmath63 where an induced norm is used .",
    "[ lemma empirical gramian error bound lti ]    under any induced norm , @xmath64 similarly , we have @xmath65 .    by proposition [ prop gramian contrl observ ] , @xmath66 . also , it is straightforward to show @xmath67 , where @xmath68 is the empirical controllability gramian of the lifted lti system at time @xmath18 , defined in form of ( [ gramian_controllability_empirical lti ] )",
    ". thus , @xmath69 and the result follows by applying lemma [ lemma empirical gramian error bound lti ] to the lifted lti system at time @xmath18 .",
    "the result for the observability gramian follows from a similar argument .",
    "indeed , for any @xmath70 , there is an induced norm @xmath71 such that @xmath72 ( by lemma 5.6.10 in  @xcite ) .",
    "thus , with an @xmath73 satisfying @xmath74 , lemma [ lemma empirical gramian error bound lps ] implies that under a certain matrix norm , @xmath75 where @xmath53 .",
    "thus , a large enough @xmath48 guarantees that the error between empirical and exact gramians is small .",
    "this result encourages one to use empirical gramians instead of exact ones to realize approximate balanced truncations , whenever it is difficult to compute exact gramians .",
    "the following subsections introduce the method of snapshots by which we can calculate those empirical gramians for linear periodic systems .",
    "also note that it is clear that the condition @xmath53 is not crucial to obtain a result similar to that in the lemma [ lemma empirical gramian error bound lps ] .      without loss of generality ,",
    "let @xmath33 .",
    "the empirical controllability gramian @xmath76 can be obtained by running a series of impulse - response simulations for system  ( [ lps ] ) as follows .",
    "consider the @xmath77-th column of @xmath78 , denoted by @xmath79^d$ ] . to obtain a finite sum @xmath80^d\\left([b(k)]^d\\right)^*f(j , i+1)^*$ ] ,",
    "one starts the first simulation with the initial condition @xmath81 and a unit impulse @xmath82^{\\top}$ ] whose @xmath77-th entry is @xmath16 . by running @xmath48 steps ,",
    "we obtain @xmath83^d;\\\\ x(j - m+2)&=f(j - m+2,j - m+1)[b(j - m)]^d;\\\\ & \\;\\vdots\\\\ x(j)&=f(j , j - m+1)[b(j - m)]^d.\\end{aligned}\\ ] ] notice that @xmath84 is a snapshot we need since @xmath85 appears in the finite sum .",
    "similarly , we run the second simulation with initial condition @xmath86 and unit impulse @xmath87^{\\top}$ ] , and by running @xmath88 steps we get @xmath89^i$ ] , @xmath90 , @xmath91^i$ ] , where the @xmath84 will be used to construct the finite sum . repeat the above process until the @xmath48-th simulation , with initial condition @xmath92 and unit impulse @xmath93^{\\top}$ ] , where only one step of simulation is needed to obtain @xmath94^d$ ] . by running the @xmath48 simulations with @xmath95 steps in all , we can thus construct the sum @xmath80^d\\left([b(k)]^d\\right)^*f(j , i+1)^*$ ] .",
    "since @xmath78 has @xmath96 columns , we need to run @xmath97 simulations , with @xmath98 steps total , to obtain @xmath97 snapshots .",
    "clearly , we have    * ( controllability gramian from snapshots ) * define an @xmath99 dimensional matrix @xmath100 ^ 1,\\cdots,[b(j-1)]^1,\\cdots,\\\\ f(j , j - m+1)[b(j - m)]^p,\\cdots,[b(j-1)]^p\\big ] ,      \\end{gathered}\\ ] ] whose columns are the snapshots obtained through the @xmath97 impulse - response simulations described above",
    ". then @xmath101 [ prop empirical contrl gramian ]    note that physically the empirical controllability gramian is based on considering the total influence of the past history of impulse inputs on the ` current state ' @xmath84 by neglecting those impulses @xmath102 , @xmath103 , whose influence on the current state has mostly decayed with sufficiently large @xmath48 .",
    "the above procedure is generally valid for calculation of the empirical controllability gramian of a time - varying stable system .",
    "the @xmath8-periodic feature of our system can substantially save the computational effort .",
    "for instance , the snapshot @xmath104^d$ ] is obtained by running the ` @xmath105-th ' simulation mentioned above for @xmath106 steps , with initial condition @xmath107 and corresponding unit impulse . however , to run this simulation is not necessary , since @xmath104^d = f(j - t , j - m+1)[b(j - m)]^d$ ] , which has been calculated in the ` first ' simulation we mentioned above at the @xmath108-th step .",
    "indeed , it is clear that for a @xmath8-periodic system , when @xmath109 , to obtain the @xmath97 snapshots for construction of @xmath110 , one needs only run @xmath111 impulse - response simulations : for each column @xmath79^d$ ] , starting from @xmath81 run a simulation for @xmath48 steps . then , start from @xmath86 , running for @xmath112 steps . repeat the process until the simulation starting from @xmath113 and running for @xmath114 steps .",
    "the data set obtained is sufficient for construction of @xmath110 .      to calculate @xmath115 for a fixed @xmath18 , @xmath33 , by the method of snapshots",
    ", one needs to construct an _ adjoint system _ @xmath116 where @xmath117 , the state @xmath118 , the control input @xmath119 , and @xmath120 as above , here we run a series of impulse - response simulations for the adjoint system .",
    "consider the @xmath77-th column of @xmath121 , @xmath122^d=\\left[c(2j+m - k-1)^*\\right]^d$ ] .",
    "one starts the first simulation with the initial condition @xmath123 and a unit impulse @xmath124^{\\top}$ ] whose @xmath77-th entry is  @xmath16 . by running the simulation for @xmath48 steps ,",
    "we obtain @xmath125^d;\\\\ z(j+2)&=f(j+m-1,j+m-2)^*\\left[c(j+m-1)^*\\right]^d;\\\\ & \\;\\vdots\\\\ z(j+m)&=f(j+m-1,j)^*\\left[c(j+m-1)^*\\right]^d,\\end{aligned}\\ ] ] where @xmath126 is a snapshot we need for computing the @xmath115 .",
    "the second simulation starts with initial condition @xmath127 and unit impulse @xmath128^{\\top}$ ] , and by running @xmath88 steps we stop at @xmath129^d$ ] , another snapshot we need .",
    "repeat the above process until the @xmath48-th simulation , with initial condition @xmath130 and unit impulse @xmath131^{\\top}$ ] , where only one step of simulation is needed to obtain @xmath132^d$ ] .",
    "since @xmath133 has @xmath134 columns , we need to run @xmath135 simulations , with @xmath136 steps total , to obtain @xmath135 snapshots , with which we have the following statement :    * ( observability gramian from snapshots ) * define an @xmath137 dimensional matrix @xmath138 ^ 1,\\cdots,\\left[c(j)^*\\right]^1,\\cdots,\\\\ f(j+m-1,j)^*\\left[c(j+m-1)^*\\right]^q,\\cdots,\\left[c(j)^*\\right]^q\\big ] , \\end{gathered}\\ ] ] whose columns are the @xmath139 snapshots obtained through the @xmath135 impulse - response simulations described above .",
    "then @xmath140 [ prop empirical observb gramian ]    again , the above procedure is valid for general stable time - varying systems . if the system is @xmath8-periodic , then as for the empirical controllability gramian case , one only needs to run @xmath141 simulations to obtain the @xmath135 snapshots .",
    "suppose we have obtained the factors @xmath142 and @xmath143 mentioned above , where @xmath144 may be different .",
    "then for the _ lifted lti system at time @xmath18 _ , by proposition [ prop gramian contrl observ ] , [ prop empirical contrl gramian ] and [ prop empirical observb gramian ] , its gramians are approximated by @xmath145 for lti systems , the method of snapshots presented in  @xcite gives an algorithm for computing the transformation that exactly balances the empirical gramians @xmath146 and @xmath147 , directly from the factors @xmath142 and @xmath143 , without computing the gramians themselves :    * ( balanced truncation using the method of snapshots  @xcite ) * let @xmath148 be a real diagonal matrix including the non - zero hankel singular values , obtained by singular value decomposition ( svd ) of the matrix @xmath149 @xmath150 in which @xmath151 is the rank of @xmath149 , and @xmath152 , @xmath153 satisfy @xmath154 .",
    "the balancing transformation is then found by computing matrices @xmath155 if @xmath156 , then @xmath22 is the balancing transformation and @xmath157 is its inverse . if @xmath158 , then the columns of @xmath22 form the first @xmath151 columns of the balancing transformation , and the rows of @xmath157 form the first @xmath151 rows of the inverse transformation .",
    "we emphasize that computing the balancing transformation by the method of snapshots _ exactly _ balances the empirical gramians .",
    "the only approximation here is to use @xmath159 and @xmath160 to approximately construct the gramians as in ( [ approximation of gramians ] ) .",
    "balanced truncation of order @xmath161 is then done as follows .",
    "let @xmath162 denote the first @xmath161 columns of @xmath22 , and @xmath163 the first @xmath161 rows of @xmath157 .",
    "the reduced state variable @xmath164 satisfies @xmath165 . the reduced model , in the lifted setting ,",
    "is then given by @xmath166 in simulations , the reduced output equation ( [ reduced system part2 ] ) shall be un - lifted to the original periodic setting : for each @xmath167 , @xmath168 , @xmath169 where @xmath170 denotes the entry of @xmath41 at @xmath167-th row and @xmath10-th column .",
    "when the number of outputs @xmath134 is very large , direct construction of @xmath143 as described in section  [ sec : obsv_gram ] will be computationally intractable , because @xmath141 adjoint simulations are required . to overcome this , an _ output projection method _",
    "@xcite may be used , by which one can substantially reduce the number of adjoint simulations . the starting point of this method",
    "is to define an optimization problem that minimizes the error between the input - output behavior of the original system and that of a projected system with a smaller - dimensional output space . for a time - periodic system ,",
    "this optimization problem is cumbersome to define directly . we instead consider the lifted lti system , for which we design a version of output projection , and then relate the method back to the periodic system .",
    "fix a time  @xmath18 .",
    "the lifted system at time  @xmath18 , though with an even higher dimension of output  @xmath141 , is a standard lti system , and its input - output behavior can be measured by a sequence of @xmath171 dimensional impulse - response matrices @xmath172 , the @xmath167-th column of each @xmath173 representing the output response @xmath174 corresponding to a unit impulse input @xmath175^{\\top}$ ] whose @xmath167-th entry is @xmath16 . by output projection @xcite",
    ", we mean the search of an orthogonal projection on @xmath176 with rank @xmath177 , i.e. a @xmath178 where @xmath179 , @xmath180 , that leads to a _ projected lifted system at time @xmath18 _ @xmath181 which is an approximation of the original lifted system , such that only @xmath182 adjoint simulations of the corresponding adjoint system are needed for calculation of the empirical observability gramian of the projected system .",
    "more details will be discussed soon .",
    "the @xmath183 shall be chosen such that the input - output behavior of the projected system is as close as possible to that of the original lti system .",
    "more precisely , @xmath183 is the solution of the optimization problem @xmath184 with respect to some norm on matrices , where @xmath185 denotes a space of rank-@xmath161 orthogonal projections .",
    "if we use an induced norm , such as the frobenius norm @xmath186 induced by the inner product @xmath187 , then the minimization problem has a standard solution : @xmath188 , where @xmath189 $ ] in which the column vectors @xmath190 are the orthonormal eigenvectors of @xmath191 .",
    "it is a typical eigenvalue problem in pod reduction and can be numerically solved by the method of snapshots @xcite , where the snapshots are provided by the data sets @xmath192 obtained through simulations .",
    "the above output projection generally produces a full matrix @xmath183 .",
    "thus the components of the projected @xmath193 no longer cleanly correspond to the outputs of the periodic system at different time steps respectively , but the intermixed combinations of them , which is not desirable both for physical understanding of the system , and for numerical simulation purposes ( recall that in simulations we do not really compute with the lifted system , so the projected lifted system should be ` unlifted ' back to a periodic system for computation ) . to deal with this difficulty , we propose a modified version of output projection , in which we seek a sub - optimal solution that solves ( [ error_outputprojection_lifted ] ) with a constraint imposing that the orthogonal projection @xmath183 with rank @xmath182 takes a diagonal form @xmath194 \\label{p_rtilde constrained}\\ ] ] where each @xmath195 block is an orthogonal projection on @xmath196 with rank @xmath197 in form of @xmath198 where @xmath199 and @xmath200 .",
    "note that in this case @xmath201 .",
    "\\label{phi_rtilde constrained}\\ ] ] here we need @xmath202 .",
    "the diagonal @xmath183 makes it easy to unlift the projected lifted system ( [ lti part1 projected ] ) & ( [ lti part2 projected ] ) to a _ projected time - periodic system _",
    "@xmath203 for @xmath204 , where the @xmath8-periodic orthogonal projection @xmath205 of rank @xmath197 on @xmath196 is defined by @xmath206 we write @xmath207 where the @xmath8-periodic @xmath208 is defined by @xmath209 .    by the above unlifting , though solving for the sub - optimal @xmath183 is no longer a standard pod reduction problem in the lifted setting , we can attack it in the periodic setting such that standard pod reduction techniques are available .    to realize that , first we rewrite @xmath173 as @xmath210 where each block @xmath211 is a @xmath212 matrix .",
    "let @xmath213 , @xmath214 .",
    "the @xmath215-th column of @xmath211 represents the output response of the original periodic system at time @xmath216 to the unit impulse @xmath217^{\\top}$ ] whose @xmath218-th component is  @xmath16 .",
    "thus , for the periodic system ( [ lps ] ) , we define @xmath219 as its impulse - response matrix at time @xmath220 , since it includes all different responses at the current time respectively to corresponding unit impulse inputs during the whole time period @xmath221 $ ] .",
    "this definition matches that proposed in bamieh and pearson 1992 @xcite .",
    "the following statement links the constrained optimization problem given above for the lifted system to an equivalent optimization problem defined in the periodic system .    under the frobenius norm ,",
    "the optimization problem ( [ error_outputprojection_lifted ] ) , with its solution @xmath183 constrained in form of ( [ p_rtilde constrained ] ) , is equivalent to the optimization problem @xmath222 which implies , for each @xmath223 , @xmath224 is the solution of the optimization problem @xmath225 [ prop optimization ]    by direct calculation , using ( [ p_rtilde constrained ] ) , ( [ gtilde_blocks ] ) , ( [ p def ] ) , ( [ g matrix def ] ) and the linearity of the @xmath226 operation .",
    "this statement allows us to obtain the @xmath183 in form of  ( [ p_rtilde constrained ] ) by solving @xmath8 unconstrained optimization problems for @xmath207 , @xmath227 , in the periodic setting , each of which is a typical eigenvalue problem in pod reduction with solutions satisfying that the @xmath197 columns of each @xmath228 , @xmath229 , are orthonormal eigenvectors of @xmath230 , i.e. , they satisfy @xmath231    numerically , the eigenvectors can be solved by the method of snapshots , in which @xmath8 svds are needed to obtain @xmath232 , @xmath90 , @xmath233 .",
    "see details of this method in , for example , @xcite and @xcite .",
    "the snapshots are the columns of impulse - response matrices @xmath234 for @xmath223 .",
    "a convenient computational feature of the output projection method is that by periodicity we see all the snapshots have already been obtained during the computation of @xmath142 described in section  [ sec : ctrb_gram ] , as long as @xmath235 , except that the data obtained there needs to be left - multiplied with a corresponding @xmath59 matrix .",
    "for instance , the matrix @xmath236 includes all the columns of matrices @xmath237 for @xmath238 .",
    "suppose we have found the @xmath183 in form of ( [ p_rtilde constrained ] ) . by definition , the observability gramian of the projected lifted system at time @xmath18 is @xmath239 and the observability gramian at time @xmath18 for the projected periodic system is @xmath240    the following statement for the projected systems is an analog to proposition [ prop gramian contrl observ ] for the full case .",
    "its proof is by direct calculation .",
    "the observability gramian for the projected lifted system at time @xmath18 , @xmath241 , is equal to the observability gramian at time @xmath18 for the projected periodic system , @xmath242 .",
    "[ prop gramian observ projected ]    therefore , @xmath243 , where @xmath244 is the empirical observability gramian at time @xmath18 of the projected periodic system obtained by the method of snapshots introduced in section 3.1 .",
    "now the input is only @xmath197 dimensional , @xmath245 , in the corresponding _ projected adjoint time - periodic system _",
    "@xmath246 where @xmath247 , the state @xmath118 , the control input @xmath248 , and @xmath249 thus , only @xmath250 adjoint simulations in total is needed for computing @xmath251 .    instead of seeking sub - optimal solutions for ( [ error_outputprojection_lifted ] ) in form of ( [ p_rtilde constrained ] ) , ( [ phi_rtilde constrained ] ) , where each @xmath252 , @xmath253 , are different and given by the solutions of ( [ eigenvalue problem pod ] )",
    ", one can also alternatively impose a stronger constraint that all the projection matrices at each time step are the same , which means @xmath254 , and @xmath255 .",
    "\\label{phi_rtilde constrained_one phi}\\ ] ] it is straightforward to show that , similar to ( [ eigenvalue problem pod ] ) , the single @xmath256 is obtained by solving the eigenvalue problem @xmath257 where @xmath258 are the columns of @xmath256 , and @xmath259 .",
    "the @xmath256 obtained by this setting reflects the overall impulse - responses of the periodic system , mixing those at different time steps along each time period .",
    "the stronger constraint given here let us expect that the solution is even less optimal .",
    "however , a numerical advantage is that only one svd is needed in the method of snapshots for solving the single @xmath256 .",
    "[ remark single projection ]      following the terminology in @xcite , the approximate balanced truncation based on the method of snapshots given in section [ snapshot_subsec ] & [ sec : balpod ] , plus the output projection introduced in section  [ sec : outputproj ] , is named _",
    "balanced pod_. we summarize the computational procedures of the balanced pod method for linear asymptotically stable time - periodic systems :    * step 0 : pick a time @xmath18 , @xmath33 , as the `` base point , '' based on which the balanced truncation will be done . *",
    "step 1 : run @xmath111 impulse - response simulations to obtain @xmath260 snapshots and form @xmath261 dimensional @xmath142 as described in section  [ snapshot_subsec ]",
    ". * step 2 : for each @xmath262 , @xmath223 ( corresponding to one whole period ) , left - multiply the state responses stored during computing @xmath142 by corresponding @xmath59 matrices , and then use the method of snapshots to solve the @xmath8 eigenvalue problems defined by ( [ eigenvalue problem pod ] ) for the @xmath8 output projection matrices @xmath224 along one time period",
    ". * step 3 : construct the `` projected adjoint system ''  ( [ adjoint system_projected ] ) and run @xmath250 impulse - response simulations for the adjoint system to form @xmath263 dimensional @xmath143 , as described in section  [ snapshot_subsec ] * step 4 : compute the svd of @xmath149 defined in ( [ svd ] ) and compute the balancing pod modes for the lifted system given by ( [ t1 s1 ] ) . * step 5 : obtain the reduced lifted system in form of ( [ reduced system part1 ] ) &  ( [ reduced system part2 ] ) . for computational purposes ,",
    "rewrite the output equation ( [ reduced system part2 ] ) as ( [ reduced system part2_periodic setting ] ) .",
    "if the dimension of output @xmath134 is small , then we can skip step 2 for output projection , and directly run @xmath141 impulse - response simulations for the adjoint system ( [ adjoint system ] ) as in section 3.1 to form the @xmath264 dimensional @xmath143 .",
    "on the other hand , in step 2 , instead of solving for the time varying @xmath8-periodic output projection matrices , one can alternatively seek a single time - invariant projection matrix by solving the eigenvalue problem ( [ eigenvalue problem pod one phi ] ) as we mentioned in remark [ remark single projection ] .",
    "note that to pick up an optimal base time @xmath18 in the sense that the upper error bound of the reduced system of a fixed order is minimized , one needs to solve for the hankel singular value matrices @xmath265 corresponding to the lifted systems at different times during one whole period ( see farhood et al .",
    "this method is therefore not attractive or even computationally feasible for large systems .",
    "[ remark optimal base time ]     a `` dual '' version of the above algorithm is readily available for balanced truncations of linear periodic systems with high - dimensional states and inputs , but only few outputs . in that case",
    ", one can start with the construction of @xmath143 by running a series of impulse - response simulations for the adjoint system , since the dimension of outputs is small .",
    "then an _ input projection _ based on pod reduction shall be done in the same spirit as that underlies the output projection to obtain a projected system whose dimension of inputs is reasonably small .",
    "one then runs a corresponding number of impulse - response simulations for the projected system to construct @xmath142 .",
    "[ remark input projection ]",
    "to validate and demonstrate the balanced pod algorithm , we consider the following example . consider a linear periodic system  ( [ lps ] ) with period @xmath266 , state dimension @xmath267 , output dimension @xmath268 , control input dimension @xmath269 , and @xmath270",
    "are randomly generated diagonal matrices with diagonal entries bounded in @xmath271 $ ] , guaranteeing the asymptotical stability .",
    "@xmath272 and @xmath273 matrices are also randomly generated , with entries bounded in @xmath274 $ ] .",
    "the setting is similar to that used in the example in farhood , et .",
    "al @xcite .",
    "it is not a high - dimensional problem , such that exact balanced realizations for the corresponding lifted system can be done by solving lyapunov equations for gramians of the lifted system , and the result can thus be compared with that by the balanced pod approach .",
    "we pick the `` base time '' @xmath275 .",
    "choose @xmath276 , and test different cases of balanced truncation , including balanced pods with the order of output projection for the periodic system at each time step @xmath277 and @xmath278 respectively .",
    "recall that , to the lifted system , the order of output projection is @xmath202 .",
    "figure [ figure hankel singular values ] shows the hankel singular values in the lifted setting , obtained by the exact balanced realization , the balanced truncation based on the method of snapshots given in section  [ sec : balpod ] but without output projection , and the balanced pod ( with @xmath8 different output projection matrices along one period for the periodic system ) .",
    "figure [ figure g inf norm ] shows the error plots of the infinity norm , @xmath279 versus @xmath280 , for those different cases . here",
    "@xmath281 is the impulse - response matrix of the reduced lifted system of order @xmath280 .",
    "we do not show the balanced pod with @xmath282 case since the result is almost identical to that by balanced truncation based on the method of snapshots but without output projection .",
    "we see that the balanced truncation based on the method of snapshots gives a good approximation of the exact balanced truncation , and further , the balanced pod , even with low orders of output projection @xmath197 , generates satisfying results .",
    "figure [ figure g inf norm diff output projections ] shows comparisons between balanced pod results with the same order of output projection , one set based on @xmath8 different projection matrices along one period in the periodic setting , and the other only having one time - invariant projection matrix ( see section  [ sec : outputproj ] ) . for the cases where @xmath197 are low ,",
    "these two approaches give almost identical results , or even the latter one gives better results .",
    "however , when the order of output projection @xmath197 increases , such as @xmath283 , the results based on @xmath8 different projection matrices at each time step are better than those by a single projection matrix , as we expect .",
    ": exact balanced truncation ( ) ; balanced truncation by the method of snapshots but without output projection ( ) ; balanced pod with @xmath284 ( ) ; balanced pod with @xmath285 ( ) ; balanced pod with @xmath283 ( ) ; balanced pod with @xmath282 ( ) . ]    , for exact balanced truncation ( ) , balanced truncation by the method of snapshots but without output projection ( ) , balanced pod with @xmath284 ( ) , balanced pod with @xmath285 ( ) , balanced pod with @xmath283 ( ) , and the lower bound for any model reduction scheme ( ) . ]",
    "-periodic output projections versus time - invariant output projections : error @xmath279 , for balanced pod with @xmath284 ( ) , balanced pod with @xmath285 ( ) and balanced pod with @xmath283 ( ) .",
    "solid lines correspond to cases using @xmath8 different projection matrices along one period for the periodic system , and dashed lines using one single projection matrix .",
    "the black solid line is the lower bound for any model reduction scheme ( ) . ]",
    "we have proposed a version of the balanced pod method to realize approximate balanced truncation for linear asymptotically stable periodic systems , especially with very high - dimensional states and outputs but a small number of inputs .",
    "it is a generalization of the balanced pod method for linear time invariant system developed in  @xcite .",
    "the development of this balanced pod is based on a lifting approach , and key parts include the method of snapshots for computing empirical gramians , and a version of output projection that gives a periodic projected system based on pod reduction , with which the number of adjoint simulations needed for computing the empirical observability gramian is substantially decreased .",
    "simulation results given in the previous section validate the approach .",
    "this snapshot - based approach is also readily applicable to high - dimensional systems with high - dimensional inputs and few outputs , where an input projection is needed .",
    "a future direction of this work is to apply the balanced pod method to construct reduced - order models of high - dimensional ( linearized ) periodic systems arising in engineering applications and then , based on the low - dimensional models , to design closed - loop control laws based on these models . for instance , such periodic orbits may arise as periodic shedding in the wake of a bluff body  @xcite , or from open - loop forcing at a prescribed frequency , as in the recent results of  @xcite , which show that a periodic blowing and suction of flow added at the walls of a channel flow may reduce drag .",
    "the dimension of states of such systems , including the three components of velocity and pressure at each grid point in the channel , can be on the order of @xmath286 , and thus reduced - order models of such systems are quite valuable for designing model - based control laws .",
    "the observability gramian provides a measure of the influence of an initial state @xmath84 on future outputs with zero control inputs . to see that ,",
    "first , for a fixed time @xmath18 , we define a linear operator @xmath287 for system ( [ lps ] ) to describe the state - output behavior @xmath288 with zero inputs and an initial state @xmath84 .",
    "more precisely , @xmath289 , @xmath290 . to measure to what degree",
    "the state @xmath84 excites the output @xmath291 , it is natural to compute the square of the induced norm @xmath292 denotes an inner product , with subscripts specifying the vector space where the inner product is defined .",
    "the observability gramian given in ( [ grammian_def ] ) has the following property :        first , it is clear that @xmath297 , we consider , for an arbitrary @xmath298 , @xmath299 where matrices are considered as linear operators and @xmath300 denotes the corresponding adjoint .",
    "so @xmath301 , and @xmath302 .",
    "controllability gramian for linear time - varying systems similarly , the controllability gramian provides a measure of the influence of a sequence of input history on the current state . in other words , to reach a given current state ( if possible ) , the controllability gramian measures how much effort from control inputs is needed . for a fixed current time @xmath18 , define a linear operator @xmath303\\rightarrow \\mathbb{c}^n$ ] such that @xmath304 .",
    "this operator describes the input - state behavior with initial state @xmath305 and a sequence of inputs @xmath306 .",
    "consider the ` energy ' of input needed for reaching the current state @xmath84 ( suppose the system is controllable at time @xmath18 ) @xmath307 defined in ( [ grammian_def ] ) satisfies @xmath308 where @xmath309 $ ] is the adjoint of @xmath310 . and",
    ", @xmath311 is the inverse of @xmath312 .",
    "[ prop controllability gramian property ]      similar to the observability gramian case , by calculations under standard inner products of @xmath315 and @xmath316 $ ] , one obtains @xmath317 , @xmath318 , @xmath319 .",
    "it follows from definition that @xmath320 ."
  ],
  "abstract_text": [
    "<S> we introduce an algorithm based on a method of snapshots for computing approximate balanced truncations for discrete - time , stable , linear time - periodic systems . by construction , this algorithm is applicable to very high - dimensional systems , even with very high - dimensional outputs ( or , alternatively , very high - dimensional inputs ) . </S>",
    "<S> an example is shown to validate the method . </S>"
  ]
}