{
  "article_text": [
    "the ongoing computational revolution in physics relies on accurate solutions of fundamental equations , newton s ( or lagrange s or hamilton s ) laws of motion , in the case of classical mechanics .",
    "the determinism of these ordinary differential equations is illusory in many cases , as typically the equations are `` lyapunov unstable '' .",
    "such instabilities grow exponentially fast , @xmath0 , where @xmath1 is the largest lyapunov exponent of the solution .",
    "particle mechanics , our own research interest , provides many examples ranging from one - particle chaos to biomolecule simulations using models with many thousands of atomic degrees of freedom@xcite .",
    "we consider here the simplest particle model for chaos , a one - body `` cell model '' with the periodic four - body cell boundaries shown in * figure 1*. the resulting motion , approximated with the simplest possible `` leapfrog '' integrator , described below , is generally lyapunov unstable.@xcite we simplify the initial conditions by starting the particle trajectory in the field - free cell interior .",
    "we benchmark this problem with three quadruple - precision integrators using timesteps chosen to maximize accuracy .",
    "we compare the resulting benchmark trajectory to six other trajectories from self - starting double - precision algorithms typical of molecular dynamics simulations .",
    "five of these algorithms are `` symplectic '' , including the justifiably - popular leapfrog algorithm .",
    "the two others are runge - kutta algorithms .",
    "unit cell is shown at the left .",
    "the black regions , with potential energy greater than one half , are inacessible to the wanderer particle .",
    "initially the wanderer is at the origin with velocity @xmath2 . outside the central diamond - shaped region",
    "the fixed scatterers at the cell corners exert repulsive forces on the wanderer particle .",
    "a visually - accurate trajectory , calculated with a quadruple - precision fifth - order runge - kutta integrator , using five million timesteps and @xmath3 , is shown at the right with filled circles marking the configurations at times 10 , 20 , 30 , and 40 .",
    "the open circle corresponds to the maximum time @xmath4 .",
    ", width=384 ]    in the following sections we describe the specially - smooth differential equations governing the motion of the wandering cell - model particle , and then quantify the algorithmic accuracy with which leapfrog and the six more sophisticated integrators `` solve '' this same problem .",
    "our conclusions make up the final summary section .",
    "cell models played a role in models of the liquid state long before the development of molecular dynamics.@xcite the geometry treated here is shown at the left in * figure 1*. a mass point , the `` wanderer '' particle , moves in a periodic square cell with a motionless fixed particle at each of the four vertices .",
    "using periodic boundary conditions the equations of motion are : @xmath5 the force on the wanderer is the gradient of the potential function @xmath6 , a sum over the contributions of the four corner scatterers located at @xmath7 : @xmath8 ^ 4 { \\rm \\ for \\ } | r - r_i| < 1 \\ .\\ ] ] after advancing the coordinates one timestep @xmath9 it is convenient to localize the motion to the cell centered on the origin .",
    "whenever the wanderer moves `` out '' , we replace it `` in '' the basic @xmath10 unit cell as follows : @xmath11 @xmath12 we choose initial conditions @xmath13 and show an accurate benchmark solution of the motion equations for a time of 50 at the righthandside of * figure 1 * . at times of 10 , 20 , 30 , 40 , and 50 the benchmark values of @xmath14 are :    10 : + 0.321356333887505 , + 0.585921713605895 + 20 : + 0.81481797353866 , -0.572042192203162 + 30 : -0.040449409487 , + 0.38290501902 + 40 : + 0.3742439 , -0.842854 + 50 : + 0.4696 , -0.3568 +    * figure 1 * shows a unit cell of a periodic two - dimensional lattice in which a single particle moves in the field of scattering particles arranged in a fixed square lattice with nearest - neighbor spacing of 2 .",
    "the potential energy maximum of unity is twice the energy of the initial condition , shown at the center of the cell .",
    "the benchmark solution of the motion equations @xmath15 is shown at the right .",
    "this same accurate trajectory was obtained with both the candy - rozmus fourth - order and a runge - kutta fifth - order integrator using 50 million and 500 million timesteps , respectively .",
    "the two trajectories agree throughout within visual accuracy . at a time of 50 @xmath16",
    "are : @xmath17 } \\ ; \\ ] ] @xmath18 } \\ .\\ ] ]",
    "we consider seven solution algorithms for the wanderer particle trajectory , [ 1 ] leapfrog ( symplectic ) , [ 2 ] fourth - order candy - rozmus symplectic , [ 3 ] monte carlo symplectic , [ 4 ] sixth - order symplectic , [ 5 ] fourth - order runge - kutta , [ 6 ] fifth - order runge - kutta , and [ 7 ] eighth - order schlier - seiter - teloy symplectic .",
    "for the first six of these we use a fixed timestep typical of `` accurate '' molecular dynamics simulations @xmath19 .",
    "solutions for those six integrators appear in * figures 2 - 7 * .",
    "the particle mass is unity and the energy @xmath20 is one half . for the last integrator , which has a trajectory visually identical to that of * figure 1 * we have chosen timesteps as small as 0.00000001 in order to obtain ten - digit accuracy in the wanderer trajectory up to a time of 50 .",
    "let us consider the details of all the integrators next .",
    "`` symplectic '' integrators@xcite automatically obey liouville s theorem by advancing the solution of hamiltonian problems in time according to a series of phase - volume - conserving shears .",
    "symplectic algorithms alternate steps advancing the coordinates and momenta in time .",
    "the simplest example is equivalent to the strmer - verlet `` leapfrog algorithm '' : @xcite @xmath21 @xmath22 this algorithm is said to be `` second order''@xcite , with a fixed - time coordinate error of order @xmath23 for @xmath24 when applied to the simple harmonic oscillator .",
    "it is time reversible in that changing @xmath25 gives the same trajectory points either forward or backward in time .",
    "how does the simulation begin ?",
    "starting out at the origin , with the wanderer speed equal to unity and a fixed timestep @xmath26 , the first 420 steps leave the momenta unchanged and @xmath27 becomes 1.0004 . during the 421st step the upper right scatterer",
    "is contacted and begins to repel the wandering particle with a force : @xmath28 where @xmath29 and @xmath30 are the wanderer coordinates .",
    "after an elapsed time @xmath31 we reverse the sign of the time so as to integrate _",
    "backward _ to see how closely the wanderer returns to its initial location .",
    "so long as @xmath32 we find that the trajectory reverses to within a distance 0.01 of the origin .",
    "we will see that this retracing of steps does not guarantee a match with the accurate trajectory shown at the right in * figure 1*. both the trajectory reversal and the conservation of energy are poor diagnostics for trajectory _ accuracy _ , where accuracy means reproducing correct values of the coordinates @xmath33 .",
    "higher - order algorithms , with fixed - time integration errors of order @xmath34 , @xmath35 , @xmath36  can be developed from taylor s series about @xmath31 giving small increments in the coordinates and momenta as three- , four- , five-  term series in @xmath9 .",
    "candy and rozmus fourth - order integrator ( with an error of order @xmath35 at a fixed not - too - large , time ) is a simple example , cited in the very useful summary paper by gray , noid , and sumpter@xcite : @xmath37 @xmath38 @xmath39 reference 7 gives the analytic forms of all of the coefficients .",
    "notice that the coefficients incrementing the coordinates sum to unity as do also those incrementing the momenta .",
    "each timestep requires three separate evaluations of the forces .",
    "although it is usual to provide coefficients in integration algorithms to many significant figures , in most cases an approximate rendition is sufficient .",
    "it is quite possible to develop algorithms with a monte carlo method , adjusting the coefficients to minimize the trajectory error for the simple harmonic oscillator problem .",
    "an integrator requiring five force evaluations per timestep was developed by monte carlo sampling@xcite adjusting the coefficients subject to the constraints of time reversibility and normalization so that the monte carlo trajectory optimization occurs in a four - dimensional space .",
    "the resulting integrator was successful in modelling many - body dynamics but is here applied to the cell - model problem of * figure 1 * : @xmath40 @xmath41 @xmath42 @xmath43 @xmath44 the cell model trajectory using this monte carlo integrator is illustrated in * figure 4*.      yoshida developed and applied a general technique for finding a variety of higher - order symplectic integrators.@xcite his sixth - order time - reversible integrator advances the coordinates @xmath45 eight times per timestep , using the symmetric ( so as to guarantee time - reversibility ) set of eight coefficients which sum to unity : @xmath46 @xmath47 between the successive coordinate updates there is a force calculation and an update of the momenta @xmath48 , using seven coefficients , which likewise sum to unity : @xmath49 @xmath50      runge - kutta integrators ( _ circa _ 1900 , as described in wikipedia ) advance both coordinates and momenta _ simultaneously _ in a series of stages within each timestep @xmath9 .",
    "as in the symplectic case the variables at time @xmath51 are expressed as series in @xmath9 , putting conditions on the summed - up coefficients for each power of @xmath9 to be treated correctly by the algorithm .",
    "the main advantage of runge - kutta methods is that they can be applied to arbitrary sets of ordinary differential equations , not just those from hamiltonian mechanics .",
    "the fourth - order `` classic '' runge - kutta method has been a standard workhorse model for solving sets of coupled ordinary differential equations for 100 years",
    ". applied to the harmonic oscillator the fourth - order algorithm suffers a loss in energy proportional to the fifth power of the timestep .",
    "the fifth - order runge - kutta integrator behaves in the opposite manner with the energy increasing rather than decreasing .",
    "hybrid `` adaptive '' models , incorporating both fourth- and fifth - order algorithms , provide a simple means for the automatic control of integration errors .",
    "the harmonic oscillator is an excellent test case of integrator accuracy where lyapunov instability is absent.@xcite * figure 6 * illustrates the same cell - model orbit for the classic fourth - order runge - kutta integrator .",
    "* figure 7 * shows a fifth - order runge - kutta integrator : @xmath52}\\ ] ] @xmath53}\\ ] ] @xmath54}\\ ] ] @xmath55}\\ ] ] @xmath56}\\ ] ] @xmath57}\\ ] ] @xmath58 here yp [  ...  ] represents the righthandside of the vector differential equation @xmath59 where the six force evaluations in each timestep are indicated by @xmath60 .",
    "both runge - kutta integrators return to the origin with errors no more than 0.01 with reversal at time 42 . forward in time their trajectories are accurate through times of 35 and 37 , the last being the best of the double - precision integrators .",
    "the energy errors for the two runge - kutta integerators are in the thirteenth and fourteenth decimal places .",
    "ernst teloy , christoph schlier , and ansgar seiter developed and implemented a useful eighth - order time - reversible symplectic integrator with 17 force evaluations per step . applied to the harmonic oscillator the rms coordinate error increases by about eight orders of magnitude when the timestep is increased by a factor of ten , consistent with an eighth - order method .    for the reader",
    "s convenience we reproduce here the 18 coefficients required to implement the method .",
    "they can be found quoted to 35 decimal places at christoph schlier s freiburg website or in reference 12 .",
    "this precision is steadily reduced , digit by digit , through lyapunov instability , described in more detail in section iv . in the cell - model case",
    "the rate of precision loss is 0.7 , one binary bit per unit time .",
    "accordingly , for the eighth - order integrator in quadruple precision at time 50 we would expect an exponentially amplified error of order @xmath61 .",
    "in fact , we find a trajectory error of order @xmath62 using a timestep of @xmath63 , as is shown below .",
    "even so the eighth - order integrator with @xmath19 loses only seven of the original 35 digits in energy along with twenty digits in position when run forward and backward for 50,000 steps to match the time illustrated in all the figures .",
    "as was illustrated and emphasized in references 12 and 13 energy conservation and trajectory reversibility are both of them misleading diagnostics of trajectory accuracy .",
    "it is only through a study of _ convergence _ that trajectories can be validated . for the eighth - order symplectic integrator the timestep dependence of",
    "the @xmath14 coordinates at time 50 is as follows : @xmath64 @xmath65 @xmath66 @xmath67 @xmath68 @xmath69 for the convenience of the reader we reproduce the integrator coefficients here from reference 12 , together with a short harmonic - oscillator program to demonstrate their use .",
    "c ( 1 ) = + 0.04463 79505 23590 22755 91399",
    "96257 33590 d00 + c ( 2 ) = + 0.13593 25807 16909 59145 54326",
    "42134 95574 d00 + c ( 3 ) = + 0.21988 44042 71470 72254 44553",
    "50696 06167 d00 + c ( 4 ) = + 0.13024 94678 05238 28601 62119 37781 96846 d00 + c ( 5 ) = + 0.10250 36569 39750 69608 26124",
    "10077 79814 d00 + c ( 6 ) = + 0.43234 52186 93585 47487 98325 78848 77035 d00 + c ( 7 ) = -0.00477 48291 69168 81658 02248 90639 62934 d00 + c ( 8) = -0.58253 47690 40408 45493 11283",
    "79308 61212 d00 + c ( 9 ) = -0.03886 26428 21118 17697 73742 08751 89743 d00 + c(10 ) = + 0.31548 72853 79404 79698 27360",
    "37972 74199 d00 + c(11 ) = + 0.18681 58374 32971 55471 52615 35039 72746 d00 + c(12 ) = + 0.26500 27549 90620 83398 34600",
    "29630 79872 d00 + c(13 ) = -0.02405 08473 57473 61993 57358",
    "79824 07554 d00 + c(14 ) = -0.45040 49249 97722 51180 92289",
    "67121 51891 d00 + c(15 ) = -0.05897 43301 55923 86914 57532 39267 66330 d00 + c(16 ) = -0.02168 47617 18613 35324 93438 86847 07580 d00 + c(17 ) = + 0.07282 08003 35901 28173 76189",
    "26412 34244 d00 + c(18 ) = + 0.55121 42963 41970 67334 40560 13815 94315 d00 +   oscillator program with q , p , dt and 18 c(i ) : +   do i = 1,17,2 + q = q + c(i)*p*dt + p = p - c(i+1)*q*dt + enddo + do i = 17,1,-2 + q = q + c(i)*p*dt + if(i.gt.1 ) p = p - c(i-1)*q*dt + enddo",
    "for chaotic systems the algorithmic accuracy of numerical integrators deteriorates exponentially rather than linearly in the time@xcite .",
    "the underlying exponential lyapunov instability of dynamical systems is easily measured by following the motion of a `` reference '' trajectory in the usual way , for instance with any one of the seven algorithms discussed here .",
    "an additional `` satellite '' trajectory , separated from the reference by a small length @xmath70 , is also followed using the same algorithm . at the end of each timestep",
    "the separation is rescaled , maintaining the length of the offset between the trajectories constant , but allowing the direction to vary : @xmath71 \\ ; \\\\ ] ] @xmath72 \\ .\\ ] ] the largest lyapunov exponent is simply the average value of the growth rates measured at the ends of every timestep prior to rescaling : @xmath73 \\ \\rangle \\ .\\ ] ] previous studies of this cell model,@xcite with the same initial condition , have shown that the largest lyapunov exponent is about 0.7 .",
    "this means that an error of the order @xmath74 at the initiation of a run of length 50 will increase by a factor of @xmath75 .",
    "this exponential growth rate explains why it is that _ all _ of the double - precision integrators fail , from the standpoint of reproducing a reversible trajectory , at about the same time , at about _",
    "half _ the time where quadruple - precision trajectories fail .",
    "it is because these trajectories are just approximations that the most sophisticated biomolecule simulations are based on the rudimentary leapfrog algorithm rather than more sophisticated algorithms .",
    "of course , even the slightest difference in the error prior to amplification will yield a different history .",
    "just summing the particle interactions in a different order leads to qualitatively different histories once the lyapunov instability rises to the level of visibility , an increase of 16 digits for routine double - precision simulations .",
    "the phase - shift errors in all of the algorithms discussed here can be measured by choosing the initial velocity @xmath76 for which the roundoff errors in the @xmath29 and @xmath30 directions are identical .    if high accuracy is required , as in astronomical simulations , multiple precision can be employed , as demonstrated by lorenz attractor simulations using a precision of thousands of decimal digits .",
    "but , as joseph ford was fond of pointing out , lyapunov instability is incompatible with high accuracy .",
    "doubling the number of significant figures in the integration algorithm only doubles the time for which the simulation is accurate .",
    "recently hanno rein and david siegel@xcite developed and implemented a relatively complicated fifteenth - order integrator for gravitational problems with the provocative title `` a fast , adaptive , high - order integrator for gravitational dynamics , accurate to machine precision over a billion orbits '' .",
    "evidently this integrator is not at all intended for long - time applications to chaotic problems , where errors grow exponentially with time .",
    "conversations with ben leimkuhler and mark tuckerman , both of whom summarily dismiss the use of runge - kutta techniques , due to their monotonic energy drift , plus the appearance of rein and siegel s high - order long - time work led to the present article .",
    "to summarize , for simple chaotic simulations ( such as classical fluids ) symplectic integrators attain accuracies similar to those obtained with runge - kutta integration and are primarily limited by lyapunov instability .",
    "although energy conservation and trajectory reversibility characterize symplectic integrators , those properties do not ensure trajectory accuracy .",
    "the reversibility of the double - precision leapfrog integrator , to a time of 47 and back , exceeds that of all the more accurate double - precision integrators .    for us",
    "it was illuminating to find that the humble leapfrog integrator , presumably nearing its 330th anniversary@xcite , is nearly as useful as are its more complex relatives , and is certainly far more economical . for higher accuracy",
    "there is little distinction between the symplectic and the runge - kutta integrators for chaotic problems , because both types lose accuracy at the very same rate , determined by the maximum lyapunov exponent .",
    "it is significant that all of the integrators used here conserve energy almost perfectly for the benchmark problem .",
    "they also reverse back to the initial conditions _ even when their trajectories are inaccurate_. one takeaway message from these simulations is the one to which joseph ford devoted much thought and many thought - provoking words , among them these taken from reference 16 :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ `` newtonian determinism assures us that chaotic orbits exist and are unique , but they are nevertheless so complex that they are humanly indistinguishable from realisations of truly random processes . ''",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    liao has confronted the lyapunov instability problem headon for the lorenz attractor.@xcite by using 3500-term series expansions coupled with 4180-digit arithmetic he followed the evolution of the lorenz model to a time of 10,000 . like the continuing discovery of the digits of @xmath77",
    "this activity will last as long as mankind .",
    "lyapunov instability often shows up in peculiar places . simply changing",
    "the order of operations in adding up forces or in computing the weights of contributions to differential equations righthandsides can provide the seeds from which macroscopic change develops .",
    "we learned this lesson in simulating the collisions of mirror - image manybody drops and crystals . to retain accurate mirror symmetry it was necessary to symmetrize the force calculations at every timestep.@xcite",
    "we thank ben leimkuhler , hanno rein , and mark tuckerman for their useful and stimulating comments , clint sprott for his constant encouragement , and christoph schlier for several helpful emails .",
    "we are grateful to the gnu fortran project for furnishing their no - cost quadruple - precision compiler . to find it google `` gnu fortran project '' .",
    "s. k. gray , d. w. noid , and b. g. sumpter , `` symplectic integrators for large scale molecular dynamics simulations : a comparison of several explicit methods '' , the journal of chemical physics * 101 * , 4062 - 4072 ( 1994 ) .",
    "h. rein and d. s. spiegel , `` ias15 : a fast , adaptive , high - order integrator for gravitational dynamics , accurate to machine precision over a billion orbits '' , ar@xmath78iv 1409.4779 , also available in the monthly notices of the royal astonomical society .",
    "w. g. hoover and c. g. hoover , `` what is liquid ?",
    "lyapunov instability reveals symmetry - breaking irreversibility hidden within hamilton s many - body equations of motion '' , condensed matter physics * 18 * , 13003 - 1 - 13 ( 2015 ) = ar@xmath78iv 1405.2485 ."
  ],
  "abstract_text": [
    "<S> time - reversible symplectic methods , which are precisely compatible with liouville s phase - volume - conservation theorem , are often recommended for computational simulations of hamiltonian mechanics . </S>",
    "<S> lack of energy drift is an apparent advantage of such methods . </S>",
    "<S> but _ all _ numerical methods are susceptible to lyapunov instability , which severely limits the maximum time for which chaotic solutions can be `` accurate '' . </S>",
    "<S> the `` advantages '' of higher - order methods are lost rapidly for typical chaotic hamiltonians . </S>",
    "<S> we illustrate these difficulties for a useful reproducible test case , the two - dimensional one - particle cell model with specially smooth forces . </S>",
    "<S> this hamiltonian problem is chaotic and occurs on a three - dimensional constant - energy shell , the minimum dimension for chaos . </S>",
    "<S> we benchmark the problem with quadruple - precision trajectories using the fourth - order candy - rozmus , fifth - order runge - kutta , and eighth - order schlier - seiter - teloy integrators . </S>",
    "<S> we compare the last , most - accurate particle trajectories to those from six double - precision algorithms , four symplectic and two runge - kutta .    0.5 cm </S>"
  ]
}