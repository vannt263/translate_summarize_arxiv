{
  "article_text": [
    "an important issue in astronomical ccd photometry is obtaining an unbiased flux estimate for an extended source .",
    "usually , a circular or elliptic aperture is used for estimating the total flux of a source .",
    "while the aperture must be sufficiently wide for including most of the fluxes from the source , its size should be limited in order to minimize the sky noise and avoid contamination from the nearby sources .",
    "some adaptive schemes , such as kron aperture @xcite and petrosian aperture @xcite , have been proposed for optimization of results .",
    "however , galaxy photometry is not a straightforward process . for galaxies in a crowded region or for irregular galaxies with odd shapes ,",
    "it is difficult to obtain the `` best '' aperture . automatic elliptical / circular apertures could include extra contributions from the nearby sources or miss the faint parts of the irregular galaxies . sometimes , it is also difficult to de - blend the flux from the nearby objects with an elliptical or circular aperture in a crowded region .",
    "the uncertainties in the flux measurement not only stem from the background noise but also from the shape and size uncertainties of the integrating aperture itself .    ideally , the sky noise could be minimized and the contamination from the nearby sources could be avoided if the aperture used is similar to or has the same shape as the source .",
    "isophotal technique has been applied for similar purposes @xcite . however",
    ", isophotal apertures might miss the faint edges of the objects and thus could underestimate the fluxes from the objects ; a corrected isophotal aperture photometry has thus been proposed to correct the problem @xcite .",
    "the corrected isophotal aperture assumes that the faint edge of an object is mainly affected with gaussian atmospheric blurring ; therefore , the total flux owing to the object can be derived from the isophotal aperture with a gaussian blurring correction .",
    "the correction might be suitable for point sources ; however , it has large uncertainty when applied to spheroidal galaxies .",
    "moreover , the wing of atmospheric point spread function was found to behave more like a power law rather than a gaussian profile @xcite .    for merging galaxies , which usually have more complex morphology",
    ", we would likely have too many unwanted background noises or contamination sources when applying elliptical apertures .",
    "isophotal technique might be quite suitable for merging galaxies , but it might miss the faint structures of the merging galaxies .",
    "currently , there is no suitable aperture technique that is specifically designed for merging galaxies . to achieve this goal",
    ", we provide a completely different algorithm by utilizing pattern recognition routines for obtaining an adaptive aperture which is enlarged from the original shape of the source by extending its boundary .",
    "we considered such an enlarged aperture is `` quasi - homomorphic '' to the original shape of the source .",
    "such a quasi - homomorphic aperture is very suitable for estimating the total magnitudes of irregular galaxies or normal sources in crowded regions .    in this supplement",
    ", we present a new technique for obtaining adaptive homomorphic apertures automatically by using pattern recognition routines . in section [ method ]",
    ", we describe the adaptive aperture photometry process in detail .",
    "this technique was applied to the merging galaxies observed in several survey projects , and the results are shown in section [ application ] .",
    "finally , in the last section , we discuss our results and summarize our methods .",
    "we developed a new algorithm for measuring the magnitudes of irregular objects by using adaptive homomorphic aperture photometry .",
    "the algorithm uses pattern recognition routines to create homomorphic apertures that are similar to the shapes of the irregular objects .",
    "the shapes of the sources and the apertures are identified in binary images , which are converted from the original ccd images based on detection thresholds .",
    "our photometry processes include background subtraction , binary image creation and homomorphic dilations .",
    "the software for these processes was implemented in the interactive data language ( idl ) .      before measuring the flux of a source in a ccd image",
    ", the background has to be subtracted from the ccd image .",
    "a global background value is usually not representative of the entire ccd image . to do the background subtraction",
    ", we basically follow the background subtraction steps in the sextractor package .",
    "our algorithm first divides the ccd image into several grids ( usually 200x200 pixels for one grid ) in order to get the local background values . after rejecting the outliers , the algorithm estimates the mode ( @xmath0 ) and the standard deviation for each grid .",
    "the algorithm applies a 3x3 median filter on the grids to reduce the overestimation around bright objects . in other words , for each grid the algorithm selects the median value of its eight neighbors to replace the value of that grid .",
    "the algorithm applies the bi - cubic - convolution interpolation to the entire ccd image to construct a smooth background map and a standard deviation map for background subtraction and following processes .",
    "the algorithm sets a threshold on the background - subtracted image to create a binary image .",
    "a specific pixel value will be set to 1(0 ) if the corresponding pixel of the background - subtracted image has a value higher ( lower ) than the local threshold . in the algorithm ,",
    "the threshold is a free parameter , measured in units of local standard deviation @xmath1 .",
    "the default threshold is 1.5 @xmath1 in order to retain the faint structures of the sources . in the binary images ,",
    "a group of connected pixels that exceed the threshold value is considered as an object .    to identify real sources",
    ", the algorithm applies the smoothing operator _",
    "opening _ on the binary image .",
    "the operator _ opening _ is a combination operator of the image operators _ erosion _ and _ dilation _ , which are two basic image operators in the area of mathematical morphology @xcite .",
    "the effect of _",
    "dilation_/_erosion _ on a binary image is to enlarge / reduce the boundaries of the objects .",
    "graphical illustrations of these processes are shown in figure  [ fig1 ] .",
    "the operator _ opening _ will eliminate the objects that are due to background noise fluctuations ; these fake sources are usually have the sizes less than 5 pixels in the binary images .",
    "such a smoothing process might not reduce some noises that are correlated , but they will not affect on the photometry of real sources .",
    "the _ opening _ operator also disconnects the weak links between the object and nearby sources in the binary image . after completing the _ opening _ ,",
    "the remaining group of connected pixels will be considered as a real object , and its coordinates will be set at the geometric center of the connected pixels .",
    "the adaptive aperture uses an irregular aperture that is quasi - homomorphic to the real shape of a source . for an irregular source ,",
    "the source s shape can be derived from the binary image . however , galaxies have fluxes that decrease slowly as a function of radius and could have parts of their fluxes mixed with background noise , especially on the edges . to capture most of the fluxes of an irregular object , our algorithm takes the object s shape in the binary image to be its original shape and increases the aperture size in a quasi - homomorphic manner , implying that the aperture s size is enlarged while trying to preserve the original source s shape .",
    "the quasi - homomorphic extension of the aperture is implemented by using the _ dilation _ operator .",
    "the _ dilation _",
    "operator can be applied more than once for obtaining the best estimate of the flux .",
    "the best size of the aperture should be the smallest size that captures all of the source s flux . for an isolated normal galaxy ,",
    "this technique should yield the same results as other aperture techniques .",
    "we selected several known normal galaxies , which have well - defined photometric information , for examining the relation between the measured fluxes and the aperture sizes for several different instruments .",
    "the sizes of the apertures could be determined by comparing our results with the results for these known galaxies . because of the different sensitivity and observation conditions at different observations , the best aperture size for different instruments might be different .",
    "the number of _ dilations _ was set as a free parameter in the algorithm , for determining suitable aperture sizes for different observational data .",
    "to look for suitable parameters of the aperture sizes , we created 100,000 virtual galaxy images for testing .",
    "the artificial galaxies were created by using the combination of the s@xmath2rsic and the exponential profiles .",
    "these galaxies have different bulge - to - disk ratios , s@xmath2rsic indexes , and ellipticities and have the brightness difference as large as ten magnitudes .",
    "besides , 20,000 of the galaxies have asymmetric structures produced by adding an additional s@xmath2rsic model .",
    "we took these 100,000 artificial galaxy images to exam the performance of our algorithms .",
    "the results show that our method can detect more than 90% of the total fluxes for most of the galaxies using the threshold of 1.5  @xmath1 .",
    "these apertures with more _ dilations _ will recover more fluxes , but had little improvement after 3 _ dilations_. the testing also showed that the performance of this method is mainly affected by the the signal - to - noise ratios of the sources .    for testing the proposed method in real data , we applied the algorithm on the sloan digital sky survey ( * ? ? ?",
    "* sdss ) images and the red sequence survey 2 ( * ? ? ?",
    "* rcs2 ) images .",
    "we selected a group of known isolated normal galaxies for determining suitable parameters for the images .",
    "we then applied the method by using these parameters for measuring the magnitudes of merging galaxies .",
    "the sdss database provides well - calibrated background - subtracted images . to test our algorithms , we selected 3,219 isolated normal galaxies from the sdss data release 9 and 42 mergers from the galaxy zoo project @xcite . figure  [ fig2 ] shows the measured fluxes vs. the aperture sizes of the 3,219 isolated galaxies .",
    "the results indicate that the best aperture sizes require four _ dilation _ operations with the threshold of 1.5 @xmath1 .",
    "we applied the parameters to obtain the homomorphic apertures for the 42 mergers and measured their fluxes .",
    "we compared our results with the sdss pertrosian measurements . since we only measured the total fluxes of the merging galaxy systems , we summed the sdss pertrosian fluxes of individual galaxies in the systems for comparison .",
    "as shown in figure  [ fig3 ] , our algorithm was able to detect more fluxes from the merging galaxy systems .",
    "this result are most likely caused by the faint structures of the objects which did not contained in the individual galaxies measurements .",
    "the results indicate that this method is able to detect fluxes from the faint structures of the merging galaxy systems .",
    "@xcite have found more than 13,000 merging galaxy candidates by analyzing the rcs2 images .",
    "the rcs2 images were observed by the canada - france - hawaii telescope ( cfht ) with the wide - field imager megacam @xcite .",
    "we adopted the adaptive homomorphic aperture method for retrieving the photometric information of these merging galaxy candidates .",
    "we used 1,081 isolated normal galaxies for estimating the best dilation number in determining the size of the homomorphic apertures ( figure  [ fig4 ] ) .",
    "the empirical test shows that the best size of an aperture requires 2 homomorphic dilations . with these parameters ,",
    "the photometric information on the g , r , z bands for 13,290 mergers out of the 13,577 candidates has been successfully obtained .",
    "for the 287 failure cases , 102 were owing to the pollution of cosmic rays ; 110 sources had objects in immediate neighborhood , which were less than 0.6 arcseconds ( @xmath3 3 pixels ) away from the edges of the sources ; the rest were owing to false background subtraction .",
    "we developed an adaptive homomorphic aperture technique for measuring the fluxes of irregular objects .",
    "this technique needs to decide suitable parameters in determining the best size of an aperture .",
    "we can use a catalog of artificial sources or a group of known isolated galaxies with regular shapes to decide the suitable parameters . to contain minimum noises",
    ", the adaptive homomorphic apertures should be as small as possible but would capture the fluxes of the sources as much as possible . for irregular objects , this method might also contain faint structures of the sources , which might not be included by other automatically aperture techniques .",
    "our test showed that our algorithms could capture more fluxes for merging galaxies than did the petrosian aperture technique ( figure  [ fig3 ] ) , whereas these two techniques demonstrated similar results for normal galaxies .",
    "this results indicate that the adaptive homomorphic apertures can be useful for detecting faint structures , which might not be detected by using the petrosian aperture technique .    in the algorithms ,",
    "the threshold and the number of _ dilations _ are two main parameters that need to be decided .",
    "threshold value will determine the shapes of the objects .",
    "using high threshold values can minimize the contamination of background noises and separate very nearby sources but may loss the structure information at the edges of the objects . through the test for the known isolated galaxies with regular shapes",
    ", we found that the threshold value and the number of _ dilations _ are not independent ; using high threshold values need more _ dilations _ in order to have more accurate estimation of the fluxes of the sources .",
    "the adaptive homomorphic aperture technique requires different number of _ dilations _ for yielding the best aperture sizes for images with different sensitivity and resolutions .",
    "our tests showed that the number of _ dilations _ for the sdss images is four ; however , under the same threshold condition , the number of _ dilations _ for the rcs2 images is two .",
    "the method might require a group of known isolated galaxies with regular shapes for empirically deciding the suitable parameters for different observations .",
    "the influence of seeing will also be taken into account through the parameter deciding ; the dilated regions usually need to be greater than or similar to the seeing .",
    "the adaptive homomorphic aperture technique is also useful for objects located in the crowded regions .",
    "many merging galaxies in the rcs2 images were detected with additional nearby objects .",
    "the median seeing of the rcs2 images is about 0.7 arcseconds and the pixel sizes are about 0.2 arcseconds . with these observational conditions , we found that the homomorphic apertures can avoid contaminations from the nearby objects as long as the nearby objects are more than 0.6 arcseconds away from the edges of the sources .",
    "the images in different observing bands may require different parameters in creating the best adaptive homomorphic apertures .",
    "this might cause a problem when estimating the colors of objects since the detected areas on different images are different . to avoid this problem , we used a common aperture to measure the fluxes of an object in different observing bands .",
    "the basic shape in creating the common aperture of an object was the union of three basic shapes from aligned images of different observing bands .",
    "this technique is similar to the isophotal technique .",
    "the isophotal aperture photometry determines the aperture sizes by considering the pixels that have signals above the detection threshold , which is similar to the sizes of the original objects in the first step of the binary image process in our algorithm",
    ". generally speaking , the isophotal technique might miss the faint structures of the objects and might underestimate their total fluxes .",
    "there is a corrected isophotal aperture photometry attempting to correct the problem theoretically @xcite .",
    "the corrected isophotal apertures assume that the faint edges of the objects mainly stem from the gaussian atmospheric blurring ; thus , the total fluxes of the objects can be derived from the isophotal aperture photometry results by applying the correction relation . on the other hand",
    ", our algorithm avoids this problem by using the homomorphic dilation process .",
    "we applied these three aperture photometry techniques on the isolated normal galaxy samples of the sdss and the rcs2 for examining their performance ( figure  [ fig7 ] ) .",
    "we found that the measurement results obtained by using our algorithm are comparable with the results of the corrected isophotal technique for the rcs2 galaxies ; however , for the sdss sources , the results obtained by our algorithm are consistent with those of the petrosian measurement results , whereas both the isophotal and corrected isophotal measurement results seem to underestimate the true fluxes .",
    "these results suggest that the adaptive homomorphic aperture technique works well for different observations and the photometry information can be acquired in a straightforward manner .",
    "the adaptive homomorphic aperture technique is applicable to irregularly shaped extended sources and is also useful for sources in crowded regions .",
    "however , it might be necessary to decide the best number of dilations empirically for different instruments .",
    "once the number of dilations has been decided for specific observation data , the algorithms can be used for obtaining the fluxes of the sources .",
    "this work was partially supported by the ministry of science and technology ( most ) of taiwan through grant most 103 - 2119-m-008 - 017-my3 .",
    "99 bertin e. , arnouts s. , 1996 , a&as , 117 , 393 gladders m.  d. , yee h.  k.  c. , 2000 , aj , 120 , 2148 hwang c .- y . , chang m .- y . , 2009 ,",
    "apjs , 181 , 233 kibblewhite e.  j. , bridgeland m.  t. , bunclark p.  s. , irwin m.  j. , 1984 , amd .. conf , 277 kron r.  g. , 1980 , apjs , 43 , 305 lintott c. , et al . , 2011 , mnras , 410 , 166 maddox s.  j. , efstathiou g. , sutherland w.  j. , 1990 , mnras , 246 , 433 magnier e.  a. , cuillandre j .- c . , 2004 , pasp , 116 , 449 petrosian v. , 1976 , apj , 209 , l1 racine , rene , 1996 , pasp , 108 , 699r pierre soille , 2003 , morphological image analysis : principles and applications .",
    "2nd edition .",
    "springer - verlag , berlin york d.  g. , et al . , 2000 ,",
    "aj , 120 , 1579"
  ],
  "abstract_text": [
    "<S> we present a novel automatic adaptive aperture photometry algorithm for measuring the total magnitudes of merging galaxies with irregular shapes . </S>",
    "<S> first , we use a morphological pattern recognition routine for identifying the shape of an irregular source in a background - subtracted image . </S>",
    "<S> then , we extend the shape of the source by using the _ dilation _ image operation to obtain an aperture that is quasi - homomorphic to the shape of the irregular source . </S>",
    "<S> the magnitude measured from the homomorphic aperture would thus have minimal contamination from the nearby background . as a test of our algorithm </S>",
    "<S> , we applied our technique to the merging galaxies observed by the sloan digital sky survey ( sdss ) and the canada - france - hawaii telescope ( cfht ) . </S>",
    "<S> our results suggest that the adaptive homomorphic aperture algorithm can be very useful for investigating extended sources with irregular shapes and sources in crowded regions . </S>"
  ]
}