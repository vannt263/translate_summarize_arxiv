{
  "article_text": [
    "anisotropic mesh adaptation is an established technique for ensuring computational efficiency in the context of multiscale problems @xcite , sometimes reducing the computational work with several orders of magnitude @xcite . within the field of structural optimisation fixed structured",
    "meshes remain popular due to ease of implementation and compatibility with mathematical optimisers .",
    "it is thus mainly in the context of methods utilising various continuous sensitivities @xcite that mesh adaptivity has been applied , and even then mainly in the context of mesh refinement , but some of the most recent advancements also relate to the use of swapping operations@xcite .",
    "parallelism is another popular technique for speeding up computations @xcite and for truly large scale problems , it indeed is the only option .",
    "the community of structural optimisation has devoted significant effort towards not only finding stiff and light structures , but also structures that do not break under load .",
    "that is the structure has to satisfy a stress constraint .",
    "recent strategies include methods with global stress constraints , either with an explicit design representation , such that computation of void elements and related stress is avoided @xcite , or an implicit representation @xcite .",
    "an essential question in this context is a global versus a local constraint as investigated in the context of level - set methods @xcite .",
    "one can also choose to let the number of constraints vary throughout the optimisation @xcite .",
    "an older , but still popular approach @xcite , approximates the local stress constraints with a single global constraint using a p - norm .",
    "the approximation is good for large values of p , but this causes numerical problems and therefore a compromise has to be made in practice . if the numerical problems are due to discretisation errors , one can hope to achieve a better compromise with more computational power or by being more efficient with the power available .",
    "it is the second option , that we choose to pursue with anisotropic mesh adaptation in this paper .",
    "the mesh adaptation introduces inconsistencies , but this drawback can be outweighed by the benefits of improved resolution of small length scales .",
    "we choose to calculate discrete sensitivities as this allows us to harness the power of libraries for automatic adjoint derivation @xcite .",
    "a continuous sensitivity is required for driving the mesh adaptation as well as when interpolating between meshes , but this is trivial to compute by dividing the discrete sensitivity with the design variable volumes , and one can invert the operation , if discrete variables are desired for the optimiser .",
    "stretched elements with small or large angles are normally discouraged in the context of the finite element method , as they give rise to not only large discretisation errors , but also cause problems with iterative solvers .",
    "this wisdom is , however , only applicable to problems without any anisotropic features in the solution .",
    "in fact , problems with strong anisotropy require anisotropic meshes for optimal use of the computational degrees of freedom . note that the problems with large angles and iterative solvers are only severe for extreme anisotropy and , furthermore , it is possible to create anisotropic meshes with few large angles @xcite .",
    "the properties of the quasi optimal mesh can be derived in a continuous sense @xcite using a metric tensor , @xmath0 .",
    "this is a symmetric and positive definite tensor field that maps the optimal element to the unit element , which has unit length edges .",
    "the first step is to compute the hessian , @xmath1 , of the variable whose discretisation error is to be minimised and convert it into a positive definite matrix .",
    "this is done by taking the absolute value in the principal frame using the operator @xmath2 , which corresponds to removing the sign of the eigenvalues .",
    "the optimal mesh metric @xcite can then be expressed as @xmath3\\right)^{-\\frac{1}{2q+d } } { \\underline{\\underline{\\mathbf{\\mathrm{abs}}}}}({\\underline{\\underline{\\mathbf{h } } } } ) \\label{eqn : m } ,   \\end{aligned}\\ ] ] where @xmath4 is the number of dimensions , @xmath5 is the error norm to be minimised , @xmath6 is the determinant and @xmath7 is a scaling factor .",
    "it is possible to combine the metrics of several variables using the inner ellipse method illustrated in figure [ fig : ellipse ] , see @xcite for implementation details .",
    "note that the unit of @xmath7 is always so that the metric in equation ( [ eqn : m ] ) has dimension of squared inverse length .",
    "once a final metric has been calculated , it can be passed to an anisotropic mesh generator together with the current mesh , in fact our metric is defined on the nodes of the current mesh .",
    "we use two mesh generators , which applies four local mesh modifications : coarsening , refinement , swapping and smoothing , see figure [ fig : meshmod ] .",
    "the mesh generators work by applying the modifications to optimise a heuristic quality measure@xcite , which quantifies the difference between the discrete mesh and the optimal continuous one .",
    "we use an optimised c++ mesh generator , pragmatic @xcite to illustrate the negligible performance penalty of mesh adaptation , but presently this does not support curved geometries , so in that case we resort to a slower matlab / octave implementation .",
    "our implementation can generate a metric from a function represented on continuous 2nd order polynomials , but 1st order polynomials can also be used . in the latter case galerkin projection",
    "is used as derivative recovery technique to compute the hessian . in any case , galerkin projection is used to convert the element wise constant metric to a node based representation , before it is passed to the mesh generator .",
    "in an effort to maximise the impact of this paper , we have tried to choose the most popular method for topology optimisation with stress constraints , but we see no reason why other methods could not benefit equally well from the use of mesh adaptation . similarly other problems with small length scales , such as many convective problems , could most definitely be solved more efficiently using anisotropic mesh adaptation .",
    "this being said , we will focus on the density method with simp penalisation @xcite and a p - norm for relaxing the local stress constraints to a single global constraint @xcite .",
    "the idea is that the local constraint is satisfied in the limit of @xmath8 going to infinity . in practice a finite value",
    "is chosen , but in the following we will show that adaptive meshing allows for @xmath9 and that this effectively removes kinks in the design .",
    "we use a stress penalisation scheme to eliminate problems with void stress @xcite , and the method of moving asymptotes is used to update the design variables @xcite .",
    "it is likely that the perfect solution to stress constrained topology optimisation will continue to allude the scientific community , but one might hope that scholars demonstrate their various heuristic schemes in the context of mesh independence such that the uncertainties of objective and constraint functions can be estimated , allowing for techniques to be compared on an objective basis .",
    "we have found the selection of papers including quantitative information related to computational cost in the context of stress constrained topology optimisation to be rather scarce@xcite , and we have been unable to identify any papers containing a discussion of mesh independence .",
    "this might be due to it being well known that the stress does not converge for designs with kinks , but in fact it has been shown that the design curvature can be effectively controlled using projection methods @xcite .",
    "it is well known that the p - norm underestimates the maximum stress , but we have deliberately chosen not to implement a",
    " local stress fix  scheme @xcite , that is a scheme that changes the maximum stress to a conservative value such that the local stress constraint is satisfied .",
    "this is due to the fact that local stress constraints constitute a much more difficult problem .",
    "the alternative is to solve the relaxed stress problem first , and address the local stress problem by employing a conservative maximum stress in combination with a large p - norm .",
    "regardless , the design has to go through a manual post - processing step as it is already typical for designs obtained with topology optimisation , but the topology is normally fixed in the post - processing and therefore it is important that the optimisation result is robust and thus mesh independent .",
    "in order to avoid a stress singularity in the problem definitions .",
    "sharp corners can also give rise to stress singularities , and we have investigated the effect of this by rounding the corner of the l - bracket .",
    "the rollers to the lower right of the portal frame are associated with zero normal displacement , @xmath10,scaledwidth=35.0% ]    we consider two 2d problems , the l - bracket and the portal frame @xcite , both with finite load and support areas , @xmath11 and @xmath12 , as illustrated in figure [ fig : lgeom ] .",
    "we model plane stress and use a helmholtz filter @xcite to compute a filtered design , @xmath13 , with a minimum length scale , @xmath14 , @xmath15^t \\right ) , \\quad \\partial_z u_z = -\\frac{\\nu}{1-\\nu } { \\boldsymbol{\\nabla}}\\cdot{\\mathbf{u } } , { \\nonumber}\\\\ g & = & e\\frac{1}{2(1+\\nu ) } , \\quad \\lambda = e\\frac{\\nu}{(1+\\nu)(1 - 2\\nu ) } , { \\nonumber}\\\\ \\tilde{\\rho } & = & \\rho + { \\boldsymbol{\\nabla}}\\cdot l_\\mathrm{min}^2 \\cdot { \\boldsymbol{\\nabla}}\\tilde{\\rho } , \\label{eqn : filter}\\\\ e & = & e_\\mathrm{min}+(e_\\mathrm{max}-e_\\mathrm{min } ) \\rho^{p_e } \\label{eqn : e}\\end{aligned}\\ ] ] where @xmath16 is the lagrangian displacement , @xmath17 is the stress , @xmath18 is the strain , @xmath19 is the out of plane deformation , @xmath20 is the identity tensor , @xmath21 is the trace , @xmath22 is the shear modulus , @xmath23 is lam s first parameter , @xmath24 is young s modulus , @xmath25 is the poisson ratio , @xmath26 is the design variable , and @xmath27 is the simp penalisation exponent . note that we intend to use a sensitivity filter for the compliance .",
    "we thus avoid using the filtered design variable in equation ( [ eqn : e ] ) , it is only calculated for the purpose of driving the mesh adaptation .    the displacement as well as the design variables are discretised with continuous 1st order polynomials , while we use 2nd order when applying the pde filter ( [ eqn : filter ] ) .",
    "the use of discontinuous constant design variables gives rise to excessive stress concentrations in the context of a sensitivity filter , and thus we have found significantly better results ( objective functions ) using nodal densities .",
    "element wise constant densities might be used with a density filter , but then the issue of dealing with negative filtered design variables in a robust way arises , hence we use a sensitivity filter .    the forward problem defined in equations ( [ eqn : stress]-[eqn : e ] )",
    "is solved using fenics , an open source finite element engine with a high degree of automation @xcite .",
    "we use a direct solver for the forward , adjoint and filter problems , and an iterative solver for galerkin projections between different element types .",
    "we use the current design and displacement to calculate objective and constraint functions , @xmath28^{1/p } - 1 { \\nonumber } , \\ ] ] where @xmath29 is the maximum compliance , @xmath30 is the stress penalisation exponent , @xmath31 is the von mises stress and @xmath32 is its maximum value .",
    "the interpolations of the young s modulus in equations ( [ eqn : e ] ) and ( [ eqn : es ] ) agree in the limits of @xmath33 and @xmath34 corresponding to void and material , respectively , but one has to penalise the intermediate values differently for stress constrained optimisations @xcite .",
    "the discrete gradient of @xmath35 can be calculated explicitly , and we use dolfint - adjoint @xcite to calculate the gradients of @xmath36 and @xmath37 . these two discrete gradients are converted to continuous ones by division with the gradient of @xmath35 and anisotropic helmholtz smoothing is applied to the stress sensitivity .",
    "this smoothing is defined on the continuous level using an equation identical to ( [ eqn : filter ] ) with a tensor version of @xmath14 , which is based on the steiner ellipse of the elements .",
    "we use the helmholtz filter ( [ eqn : filter ] ) for the compliance sensitivity , that is we do not use a sensitivity filter related to non - local elasticity as discussed in @xcite .",
    "these continuous and smooth sensitivities are then used to calculate metrics associated with the compliance and stress constraints .",
    "the filtered design variable is used to calculate a metric associated with the volume constraint and all three metrics are combined using the inner ellipse method , see figure [ fig : ellipse ] .",
    "after the metric has been used to adapt the mesh , the optimiser variables ( the asymptotes , continuous sensitivities , previous , and previous previous design variables ) are interpolated on to the new mesh .",
    "due to extrapolation at curved boundaries it can become necessary to enforce the box constraints on the asymptotes and design variables after this interpolation step .",
    "once this interpolation step is complete , the continuous sensitivities are converted to discrete ones , and the optimiser is called to update the design variables .",
    "this completes the optimisation loop as illustrated in figure [ fig : flowchart ] .",
    "this methodology is inconsistent from a mathematical programming point of view , but except for the compliance sensitivity filter , we expect the errors to decrease with mesh refinement .",
    "we consider volume minimisation under stress and compliance constraints , the formal problem statement being @xmath38 the optimisation is initialised with a completely solid design , @xmath39 .",
    "we make the problem dimensionless using @xmath40 and @xmath41 as characteristic length scale and stress , respectively .",
    "this is reflected in the set of parameters used in the optimisations , @xmath42 the maximum compliance and two of the length scales differ between the two benchmarks as shown in table [ tab : tab1 ] .",
    "ideally the values for the maximum stress and compliance should be chosen according to the application , but for the academic benchmarks considered here , we just choose a maximum compliance that results in a non - extreme volume fraction and a maximum stress that results in the stress constraint being active .",
    ".the @xmath43 and @xmath44 length scale differs between the portal and l - bracket problems , and the maximum compliance is significantly higher for the l - bracket problem . [",
    "cols=\"^,^,^\",options=\"header \" , ]     [ [ computational - cost ] ] computational cost + + + + + + + + + + + + + + + + + +    all computations are single threaded , but it is possible to perform mesh adaptation in parallel , see @xcite .",
    "we terminate the optimisations using an iteration limit only , and the total computation time before this triggers is shown in hours at the top of each plot in figure [ fig : designs ] .",
    "we use a direct solver for the filter operations as well as for the forward and adjoint problems .",
    "the coarse optimisation of the l - bracket with a rounded corner probably only took around an hour to find the best design , but others have found similar designs with an order of magnitude less effort @xcite and comparing figures [ fig : static ] and [ fig : designs](a - c ) reveals that it is possible to achieve a similar volume fraction using a fixed mesh and a similar amount of computational time .",
    "there is thus reason to believe that the presented method needs improvement , if it is to be competitive .",
    "it is , however , worth noting that the resolution of the design near the corner is significantly worse for the static mesh , even compared to the most coarse adaptive optimisation , so the fixed mesh might be benefiting from under resolving the stress singularity .",
    "the optimisations with sharp corners are performed with pragmatic as mesh adaptation library , which is an optimised c++ implementation , so the actual mesh adaptation only takes 1 - 2% of the total computation time .",
    "the optimisations with a rounded corner use an almost identical octave / matlab implementation , which ( although fully vectorised ) is significantly slower , and therefore the mesh generation takes 20 - 30% of the total computation time",
    ". note that although the meshes conform well to the designs in figure [ fig : designs ] , this is not true for the intermediate iterations .",
    "this is due to the fact that we optimise with @xmath9 , so small imperfections in the designs can cause concentrations of stress away from the corner , which lead to many small elements in areas that are close to becoming void .",
    "we calculate the steiner ellipse for each element , and use this to calculate the element aspect ratio by diving the radii product with the square of the smaller radius .",
    "this element aspect ratio is between 4 and 5 on average throughout the optimisations , which is a indication of speedup due to the anisotropic elements .",
    "one can expect the square of this in 3d corresponding to an order of magnitude reduction in computational cost compared to isotropic adaptation .",
    "we have performed stress constrained topology optimisations using a combination of anisotropic mesh adaptation and the method of moving asymptotes with interpolation of the asymptotes between iterations .",
    "we find that it is necessary to use continuous linear design variables and a sensitivity filter .",
    "the computational cost of introducing the mesh adaptation is negligible for an optimised implementation .",
    "we argue that it might be beneficial to relax the problem statement to a rounded corner , as a radius of just 1% of the characteristic length scale helps the optimiser find better designs .",
    "at least , in this case we are able to demonstrate mesh independence .",
    "it would be interesting to see the method applied to design of compliant mechanisms or meta materials due to the fact that the stress concentration results from the nature of the problem rather than the geometry .",
    "another interesting aspect is the post - processing of the result , i.e. to which extend is it beneficial to have many small elements aligned with the design contour , when the design is to be extracted ?",
    "furthermore , the fact that anisotropic elements can give rise to large angles which cause problems for iterative solvers should be quantified in three dimensions and possibly also addressed by means of a meshing technique relying on advancing fronts @xcite .",
    "another point for three dimensions is , that due to the trend of increasing number of cores in workstations , the fastest methods generally rely on shared memory parallelism @xcite .",
    "therefore one ought to investigate the benefit of parallelism , when extending the method to three dimensions .",
    "finally , the meshes that occur during the optimisation loop have only small variations during the later stages of the procedure , meaning that the degrees of freedom are chosen efficiently in the spatial dimension only , not in the  optimisation dimension  .",
    "we suggest to address this issue using time - space elements and an optimiser defined at the continuous level .",
    "this work is supported by the villum foundation .",
    "wagdi  g habashi , julien dompierre , yves bourgault , djaffar ait - ali - yahia , michel fortin , and marie - gabrielle vallet .",
    "anisotropic mesh adaptation : towards user - independent , mesh - independent and solver - independent cfd .",
    "part i : general principles . , 32(6):725744 , 2000 .",
    "pierre duysinx and ole sigmund .",
    "new developments in handling stress constraints in optimal material distribution . in _ proc of the 7th aiaa / usaf / nasaissmo symp on multidisciplinary analysis and optimization _ , volume  1 , pages 15011509 , 1998 ."
  ],
  "abstract_text": [
    "<S> the p - norm often used in stress constrained topology optimisation supposedly mimics a delta function and it is thus characterised by a small length scale and ideally one would also prefer to have the solid - void transition occur over a small length scale , since the material in this transition does not have a clear physical interpretation . </S>",
    "<S> we propose to resolve these small length scales using anisotropic mesh adaptation . </S>",
    "<S> we use the method of moving asymptotes with interpolation of sensitivities , asymptotes and design variables between iterations . </S>",
    "<S> we demonstrate this combination for the portal and l - bracket problems with p=10 , and we are able to investigate mesh dependence . </S>",
    "<S> finally , we suggest relaxing the l - bracket problem statement by introducing a rounded corner . </S>"
  ]
}