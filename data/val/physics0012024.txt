{
  "article_text": [
    "density - functional theory @xcite in its time - dependent @xcite as well as ground or time - independent forms has proved to be an efficient method for treating electron - electron interactions and has been applied successfully to finite systems such as clusters , @xcite to bulk systems or surfaces , and to aperiodic systems such as defects .",
    "@xcite however , the high computational cost of treating large systems places a practical limit on the size of systems that can be studied .",
    "the use of pseudopotentials @xcite enhances the performance of this sort of calculation by avoiding an explicit treatment of the kohn - sham orbitals associated with the core .",
    "furthermore , the smoothness of the resulting valence pseudowavefunctions allows the use of a plane wave basis for describing them , and consequently also the electronic density .",
    "a plane wave basis is particularly attractive because it allows use of the fast fourier transform ( fft ) , for rapid and memory efficient transformations .",
    "a discrete but truncated set of plane waves based on the reciprocal lattice is one natural basis set for a periodic system .",
    "however , for finite systems , or more generally , for systems lacking periodicity such as defects in solids , the use of a discrete set of plane waves will generate periodic images of the finite cell to be studied . in the case of a finite system",
    "this leads to a problem in the calculation of the electrostatic potential due to the electrons , the so - called hartree potential , due to the long range of the coulomb interaction .",
    "nevertheless , discrete plane wave basis sets are often used for finite systems because of the great efficiency of the fft , and errors in the hartree potential due to periodic images are usually ignored , or reduced by increasing the size of the supercell .",
    "these spurious effects might seriously affect the calculated equilibrium structure and dynamics of weakly bounded molecules or clusters , eg .",
    "however , several methods have been proposed recently for treating this problem .",
    "our purpose here is to compare four methods for solving poisson s equation for finite systems .",
    "one of them is an iterative , real - space method based on finite differences and conjugate - gradients minimization , which obviously does nt suffer from the problems related to periodic images . the other three use discrete plane wave basis sets and fft s , but treat the cell - to - cell interactions in different ways .",
    "two of these plane wave methods impose a cut - off to the coulomb interaction in real space , and have been described elsewhere .",
    "@xcite however , for one of these , which uses what we term a cubic cut - off , we have found significant improvements which we believe will be of interest to practitioners .",
    "the third plane wave method has been developed and tested by us , but we have found a close relationship between it and the local moment countercharge ( lmcc ) method proposed by schultz , @xcite and also to the fourier analysis with long range forces ( falr ) method of lauritsch and reinhard .",
    "@xcite however , our scheme is formulated more generally , and allows for better control of errors .    in order to compare the performance of the different methods we have studied some exactly soluble model systems , and @xmath0 and @xmath1 molecules which , because of their polar or charged nature , are difficult to treat with plane wave methods . of particular interest",
    "is the way the computational time scales with system size .",
    "although all the plane wave methods scale as a few times @xmath2 , where @xmath3 is the number of real - space mesh points , the proportionality factor varies substantially from method to method . we shall compare the speed and memory requirements of the methods , and how these scale with the size of the systems .",
    "the plane wave schemes we discuss are intended mainly to deal with neutral or charged molecules or clusters in free space and could be implemented directly in existing _",
    "ab initio _ plane wave or real - space codes , but they could also be used in those lcao basis set codes which base the calculation of the hartree potential on the fft .",
    "general subroutines for calculating the hartree potential using these methods are available upon request from the authors or can be downloaded from the web page.@xcite    short theoretical descriptions of the plane wave methods are given in section ii where we emphasize the improvements we have developed .",
    "section iii presents and compares the results for the hartree potential calculated using the different methods , and concluding remarks are made in the final section .",
    "atomic units are used unless otherwise stated .",
    "the solution of poisson s equation , @xmath4 , which goes to zero at infinity , for a charge density @xmath5 , localized within a cell @xmath6 of volume @xmath7 , is given by    @xmath8 = \\int d{\\bf r } ' \\frac{n({\\bf r}')}{|{\\bf r}'-{\\bf r}|}.\\ ] ]    within the cell @xmath5 and @xmath9 may be expressed as fourier series : @xmath10 where @xmath11 , and similarly for @xmath9 , and where the @xmath12 vectors are reciprocal vectors of the lattice formed by repeating the cell @xmath6 .",
    "if the fourier coefficients , @xmath13 , are negligible for @xmath14 larger than some cut - off so that the sums over @xmath12 may be truncated , then the @xmath13 and the @xmath15 points are related through a discrete fourier transform",
    ". this amounts to approximating the integral over the cell in the definition of @xmath13 by the trapezium rule , a point to which we shall return later .",
    "however , @xmath15 given by the fourier sum is periodic so that the straightforward substitution into eq .",
    "( [ eq : v_hartree ] ) gives a potential :    @xmath16 = \\frac{4\\pi}{\\omega } \\sum_{{\\bf g}\\ne { \\bf 0 } }   \\frac{\\tilde{n}({\\bf g})}{{\\bf g}^2 } e^{i{\\bf g}{\\bf r}},\\ ] ]    which differs from @xmath9 .",
    "but the merit of v is that it can be calculated using the the very efficient fft with its @xmath17 scaling , and so we now modify or apply corrections to eq .",
    "( [ eq : conv ] ) so that it can be used to obtain @xmath9 .",
    "two aspects of @xmath18 given by eq .",
    "( [ eq : conv ] ) require attention .    * the @xmath19 component in eq .",
    "( [ eq : conv ] ) is arbitrarily set to zero . for a charged system",
    ", this corresponds physically to introducing a uniform compensating charge background , @xmath20 , so that the system is electrically neutral . for a neutral system",
    ", this means that the boundary condition , @xmath21 , is not satisfied ( which , of course , also happens in the charged case ) .",
    "* @xmath18 is the potential due to the charge distribution @xmath5 in the central cell plus that due to the images of @xmath22 in all other cells .",
    "since we are dealing with the electron charge distribution , there is obviously a net charge .",
    "the fact that the whole system ( _ cores _",
    "+ electrons ) may or may not be charged , is irrelevant for the discussion presented in this paper .",
    "however , it might be important if the calculations are total - energy supercell calculations . in this case , the system of ion cores is also treated using reciprocal space , so that a background of opposite sign has to be added .",
    "if the finite system is neutral , the effect of the backgrounds cancels .",
    "the spurious effect of higher multipoles , however , will remain .",
    "the distinction is important , though , because the uniform background introduces an important error in the total energy of order @xmath23 , @xmath24 being the size of the cell , whereas the leading effect of the presence of the multipoles is the dipole - dipole term , behaving like @xmath25 .",
    "this is shown in the calculations presented in next section .",
    "we can start to deal with the cell - to - cell interaction , by eliminating the effects of net charge .",
    "this can be done by subtracting from the original charge distribution , @xmath5 , an auxiliary charge distribution @xmath26 , so that no net charge remains .",
    "the potential @xmath9 then becomes :    @xmath27=v_h[n - n_{aux}]+v_h[n_{aux}].\\ ] ]    the term @xmath28 $ ] can be treated using the fft techniques , and then the correction @xmath29 $ ] , calculated explicitly in real space , added on .",
    "this method is especially convenient if the fourier components of @xmath26 can be calculated analytically , so that the expression becomes :    @xmath27 \\approx v[n ] - \\psi,\\ ] ]    where @xmath30 $ ] follows the definition given in eq .",
    "( [ eq : conv ] ) , and @xmath31-v_h[n_{aux}]$ ] is a function which can be calculated analytically .",
    "the sign @xmath32 denotes that the effect of higher multipoles is still included .",
    "the choice of @xmath26 is arbitrary ; it could be a uniform density , or a gaussian centered on the origin , in both cases the function @xmath33 can be calculated analytically.@xcite    this procedure can be easily generalized , to account for the interaction of higher multipoles .",
    "we merely need to add an auxiliary charge distribution which mimics the multipoles whose effect we want to subtract .",
    "this procedure is called by shultz @xcite local moment countercharge method ( lmcc ) .",
    "shultz accounts for the monopole and dipole corrections through a superposition of localized gaussian charge distributions constructed to have the same net charge and dipole moment .",
    "higher multipoles can similarly be accounted for by the superposition of additional gaussian distributions , but the procedure becomes complicated . a straightforward approach which is more easily generalized introduces an auxiliary charge distribution in the form :    @xmath34    where @xmath35 and @xmath36 is the multipole moment of @xmath5 given by @xmath37    the width parameter @xmath38 is to be chosen so that @xmath26 is negligible at the cell boundary .",
    "if high order moments are required @xmath38 could be taken to be @xmath39-dependent , decreasing somewhat with @xmath39 .",
    "note that the @xmath40 term in eq .",
    "( [ eq : def_of_naux ] ) corrects for the net charge as described above .",
    "the auxiliary density is localized within a cell and has the same multipole moments as @xmath5 .",
    "we can now correct for the presence of the periodic images of @xmath5 , and obtain for the required hartree potential in the central cell :    @xmath41 = v[n,{\\bf r } ] - \\sum_{l=0}^{\\infty}\\sum_{m =- l}^{l }   m_{lm}\\psi_{lm } + v_0,\\ ] ]    where @xmath42 is a constant shift yet to be determined , and the functions @xmath43 , which are independent of the charge distribution @xmath5 , are given by    @xmath44    the first term in @xmath43 is the periodic potential due to @xmath45 in every cell , and the second term subtracts the effect of @xmath45 in the central cell .",
    "the function @xmath46 is : @xmath47    the procedure for obtaining @xmath9 is to calculate and store the functions @xmath43 once and for all for as many of the multipoles as are needed to achieve the desired precision , then for the particular charge distribution @xmath18 is calculated using ffts , the @xmath36 are computed , and eqs .",
    "( [ eq : mc_general_formula ] ) and ( [ eq : mc_corrections ] ) used to obtain @xmath9 within the central cell apart from the constant shift .",
    "the shift @xmath42 is chosen so that the boundary condition @xmath48 is satisfied .",
    "this we accomplish by computing the average value over the surface of the cell of the corrected but unshifted potential @xmath9 obtained by simply putting @xmath49 in eq .",
    "( [ eq : mc_general_formula ] ) . for a cubic cell we have:@xcite @xmath50    since @xmath5 is zero at the boundary we may interchange the order of integration in eq .",
    "( [ eq : constant_shift ] ) to give :    @xmath51    where @xmath52 is the potential inside the cube due to a unit charge uniformly distributed over the cube surface . as such , by gauss s theorem and symmetry , @xmath53 is constant inside the cell and has the value @xmath54 with @xmath55 for a cube .",
    "if @xmath5 integrates to @xmath56 , then we have finally : @xmath57 and @xmath42 should be chosen so that @xmath58 has this value .",
    "the calculation of the correct shift to satisfy the boundary condition requires the computation of the surface average of @xmath18 , but since the kohn - sham orbitals are unaffected by the addition of a constant to the potential , this only needs to be performed at the end of a self - consistent cycle.@xcite      we now review two established methods , @xcite based on imposing a cut - off on the coulomb interactions .",
    "they are exact , but need a bigger cell , which is a computational drawback as we shall see .",
    "let us define a new cell @xmath59 , which includes @xmath6 .",
    "this new cell will define new coefficients @xmath60 , which are the reciprocal vectors of the lattice formed by repeating @xmath59 .",
    "retrieving eq .",
    "( [ eq : conv ] ) , we realize that the function @xmath30 $ ] can also be expressed as : @xmath61 = \\int d{\\bf r'}n^{(p)}({\\bf r'})\\frac{1}{|{\\bf r'}-{\\bf r}|},\\ ] ] where @xmath62 is the function formed by the sum of @xmath5 and all its periodic repetitions in the superlattice .",
    "we now introduce a truncated coulomb potential , with the following properties :    @xmath63    it is easily seen that :    @xmath64\\ ] ]    for every @xmath65 .",
    "and thus we can calculate @xmath9 as we did for @xmath18 in eq .",
    "( [ eq : conv ] ) :    @xmath66    where @xmath67 .",
    "two choices for @xmath59 and @xmath68 have been given .",
    "one of them uses a spherical shape @xcite for the cut - off of the coulombic interaction , and the other a cubic shape,@xcite based on the assumption that the original cell @xmath6 is cubic itself .",
    "let @xmath69 be the length of the side of @xmath6 .",
    "we will define a larger cubic cell of side @xmath70 , centered on @xmath6 . for this choice of @xmath59",
    "we define next the truncated coulomb interaction :    @xmath71    defined in this way , @xmath68 meets the required conditions expressed in eq .  ( [ eq : conditions ] ) , because any two points belonging to @xmath6 are always closer than @xmath72 , and any two points belonging to different images of @xmath6 are always farther away than @xmath72 .",
    "the fourier transform of @xmath5 has to be calculated numerically in the larger cell @xmath59 ; however that of @xmath68 is easily obtained analytically :    @xmath73      the former proposal is exact ; but a very large cell is needed , which increases the time to evaluate the ffts .",
    "reducing @xmath74 introduces spurious interactions and thus spoils the precision of the calculations , but if extremely precise calculation are not needed , a compromise could be reached .",
    "our aim now is to reduce @xmath74 but maintain an accurate evaluation of @xmath9 .",
    "we take the larger cell to have @xmath75 and the _ cut - off _ coulomb interaction to be :    @xmath76    if @xmath77 and @xmath78 belong to @xmath6 , @xmath79 belongs to @xmath59 . and",
    "if @xmath77 and @xmath78 belong to different images of @xmath6 , then @xmath79 will not belong to @xmath59 .",
    "thus again @xmath68 is correctly defined .",
    "the fourier transform of this function @xmath68 has to be calculated numerically , and we face here two drawbacks : the function has a singularity at the origin , and is not analytic at the boundary .",
    "jarvis _ et al _ @xcite dealt with the first problem by integrating and averaging the singularity over a grid unit , which may not be adequate .",
    "the second problem appears to have been overlooked . in any event",
    ", their treatment of the mg atom using the cubic cut - off method converges poorly compared with the results with the spherical cut - off , and they declare a preference for the spherical cut - off despite the larger cell size required .",
    "however , we shall show how to overcome these difficulties so that the cubic cutoff method , to be preferred because of its smaller cell size , can be used with great precision .",
    "the singularity at @xmath80 can be treated as follows :    @xmath81    where @xmath38 is chosen small enough so as to make @xmath82 negligible at the cell boundaries .",
    "the second term can be calculated analytically    @xmath83    and the numerical integration reduces to the first term , which is free of singularities .",
    "even so , this term can not be calculated by simply applying an fft because the repeated function , although periodic , is not analytic at the boundary .",
    "use of the fft amounts to using the trapezium rule for the integration , which is exact for a periodic analytic function , but leads to substantial errors when there are discontinuous derivatives as we have in this case .",
    "we evaluated the integral using a second - order filon s method , @xcite which proved to be effective .",
    "other procedures @xcite ( simpson s , romberg s ... ) could have been used - they are all rather slow if accurate results are to be obtained , but this calculation needs to be done only once for a cubic cell .",
    "if we denote by @xmath84(n_1,n_2,n_3)$ ] the integral in eq .",
    "( [ eq : cubic_cutoff_int ] ) for a cubic box of side @xmath24 and frequency indices @xmath85 , it is clear that @xmath84(n_1,n_2,n_3 ) = l^2 i[d(1)](n_1,n_2,n_3)$ ] .",
    "it is interesting to see the effect of the various multipoles that a charge distribution might have by using the multipoles - correction method on an exactly soluble system .",
    "we have studied systems consisting of superpositions of gaussian charge distributions placed at various points @xmath86 within the cubic cell of side @xmath24 :    @xmath87    we have investigated the efficiency with which the multipole corrections remove the effects of the images of the charge distributions in other cells . this has been done as functions of l , as for a large enough cell the results for the periodic system should become exact , but at rates depending on the order of the multipoles .",
    "the results are shown in fig .",
    "[ figure1 ] for the cases in which there are ( i ) no corrections ( by which we mean that only the constant to meet the proper boundary conditions is added to the raw potential obtained from the fourier transform ) , ( ii ) monopole corrections , ( iii ) monopole + dipole corrections , and ( iv ) monopole + dipole + quadrupole corrections .",
    "the following points are noteworthy .",
    "* there is a serious , roughly 10% , error in the total energy when the hartee potential is uncorrected .",
    "although this is not a consideration in superlattice calculations provided the system is neutral , it is an important matter in real space calculations when the hartree potentials due to the electrons alone is calculated in reciprocal space . *",
    "the time for the calculations behaves roughly as @xmath88 , but with irregularities .",
    "the efficiency of the fft algorithm depends on the prime factorization of the number of points to be transformed .",
    "the original fft was developed for powers of two , but now algorithms exist with more flexibility.@xcite we have used the fftw package,@xcite with support for all the primes involved in our calculations . *",
    "adding the quadrupole corrections does not seem to improve the accuracy of the result , nor is the @xmath24-dependence improved .",
    "this is because the interaction energy between the dipole of the charge distribution in the central cell and octupoles in other cells , has the same @xmath24-dependence and order of magnitude as the quadrupole - quadrupole energy .",
    "consequently , although the potential will be improved by adding to it the quadrupole corrections , there could be no significant improvement in the total energy if the system has a strong dipole .",
    "in general , it can be shown that the error in the electrostatic energy due to the presence of an @xmath39 multipole in the charge distribution in the central cell , and @xmath89 multipoles in all other cells goes to zero like @xmath90 , or in some special cases faster due to symmetry ( for instance , if @xmath40 and @xmath91 , or @xmath39 and @xmath89 have different parity ) .",
    "thus , adding octupole corrections to the potential will not change the @xmath24-dependence of the total energy if the system is charged because of the interaction of the monopole with the @xmath92 multipole .",
    "our calculations below on the @xmath1 cluster provide an interesting example of this behaviour .",
    "we have performed several electronic structure calculations on real systems to assess the performance of the methods .",
    "we have used a real - space code,@xcite in which a superlattice and plane waves are only used to accelerate the solution of poisson s equation for the electron charge distribution . in this type of approach a correction for the net charge",
    "is always needed irregardless of whether the molecule or cluster itself is charged or neutral .",
    "furthermore , in this approach the value of the multipoles will depend on the position of the molecule with respect to the centre of the cell . in order to minimize the multipole corrections the centre of charge of the system of ions",
    "should be placed at the centre of the cell . if this is not done in real space calculations the errors caused by cell - to - cell interactions could be magnified . in order to illustrate the effects we take the center of charge as the cell center for one of our test cases , and not for the other . as for other details of the calculations we used density - functional theory with the local - density approximation for exchange and correlation , and troullier - martins@xcite nonlocal , norm - conserving pseudopotentials .",
    "our first choice for a realistic system was the nacl molecule , also treated by shultz @xcite and jarvis _",
    "et al_,@xcite because of its strong dipole moment ( experimental value of 9.0d in the gas phase , as reported by nelson _",
    "et al_.@xcite ) in this case , the center of charge of the system of ions is placed at the center of the cell .",
    "the equilibrium bond - length was calculated : ( i ) using the spherical cut - off method which is exact with a large enough cutoff , and ( ii ) using the multipoles correction and correcting only for the monopole term so as to show the influence of the dipole - dipole interactions which are ignored .",
    "our calculated `` exact '' value is 2.413 , whereas the result ignoring the dipole - dipole interactions is 2.448 .",
    "next , we investigated the performance and accuracy of the methods by determining the errors in the total energy and electric dipole moment , while monitoring the calculation times .",
    "we compared results for the energy and dipole moment against those obtained with the spherical cutoff method with a cut - off radius of @xmath72 , grid parameter ( 0.2 ) and cell size ( @xmath24=10 ) . in this way an electric dipole moment of 8.4551d",
    "was obtained .",
    "each of the four methods was then used to converge the electronic ground state of the molecule for successive values of a `` control parameter '' for speed and accuracy :    * for the real - space , conjugate - gradients method this parameter was the order of the difference formula used to evaluate derivatives . * for the spherical cut - off method , we note that , if the electron density is well localized within the @xmath6 cell , the need for the full cut - off radius , @xmath72 , may be relaxed and a correspondingly smaller @xmath59 cell used , introducing some error but accrueing time savings .",
    "we have investigated the effect of using a reduced cut - off radius , @xmath93 , through a control parameter , @xmath94 , which is the ratio of the @xmath59 and @xmath6 cubic cell edges : + @xmath95 + so that @xmath96 is the minimum value for which exact results are guaranteed . * the @xmath59 cell size can also be reduced in the case of the cubic cut - off method , and the control parameter is again @xmath97 where @xmath98 guarantees exact results . * for the multipoles correction method , the order of the multipoles corrected for is the control parameter .    in fig .",
    "[ figure2 ] we illustrate the results obtained for each of the methods .",
    "both cut - off methods are presented in the same column as they use the same control parameter , although the ranges of values are different .    1 .",
    "the real - space method is significantly slower than the other methods for the same accuracy , and a case can be made for using reciprocal space methods for calculating the hartree potential in what are otherwise real - space codes .",
    "however , enhancements of the conjugate - gradients method are possible through preconditioning and multigrid techniques.@xcite 2 .",
    "the cut - off methods reach acceptable accuracy much below the values for @xmath94 which guarantee exact results : @xmath99 and @xmath100 respectively , for the spherical and cubic cut - off .",
    "this to be expected when the charge distribution is well localized within the cell .",
    "however , it is clearly demonstrated that , for a given accuracy , the size of the auxiliary cell is smaller for the cubic cut - off method , and as a result , the calculation time is also shorter .",
    "the multipoles - correction method already gives good accuracy if the dipole interactions are corrected for ( @xmath101ev error in the energy , and @xmath102d error in the electric dipole ) . without the dipole correction ,",
    "the error in the energy is @xmath103ev , and in the dipole is 0.17d , which give an indication of the size of errors to be expected when supercell calculations are performed for neutral molecules and no corrections are made .",
    "we have also performed calculations on the @xmath1 cluster containing the same number of valence electrons as the nacl molecule .",
    "results are similar to those presented for nacl , but some differences should be reported . in this case",
    "the center of charge was not placed at the center of the cell , consequently , although the cluster has a calculated net dipole of @xmath104 , the electronic dipole responsible for the errors is a much larger @xmath105 .",
    "the cluster was positioned in the cell so that the charge density occupied most of the cell , allowing an optimally small cell . as a result , to achieve similar accuracy as for the nacl molecule",
    ", we should expect the need for ( i ) larger cut - off lengths for the cut - off methods , and ( ii ) higher multipole corrections .    in fig .",
    "[ figure3 ] we show the error in the energy obtained by using the multipoles correction method .",
    "it can be seen how the inclusion of the dipole correction yields a much less satisfactory error in the energy than for nacl .",
    "furthermore , for the reasons given earlier , the removal of the quadrupole - quadrupole , dipole - octupole , and octupole - octupole terms does not significantly improve the accuracy . only by including all corrections to the potential up to fourth order multipole moments",
    "do we obtain a comparable result for the energy .",
    "the calculation time , which is also shown in the figure , is beginning to increase sharply by fourth order as further corrections are added .    in fig .",
    "[ figure4 ] we present , as well , the results for the error in the total energy and the calculation time for the cubic - cutoff method .",
    "comparison with fig .",
    "[ figure2 ] confirms that the energy converges much less rapidly as a function of @xmath94 than for the nacl molecule .",
    "we have studied some of the methods which have been proposed recently for solving poisson s equation in reciprocal space for electronic structure calculations on finite systems .",
    "we also propose a method based on multipole corrections .",
    "test calculations have been performed to assess the performance of the methods .",
    "we conclude that reciprocal - space methods can be accurate enough for finite or aperiodic systems , and their efficiency is a significant improvement over that of real - space methods .",
    "two basic reciprocal - space methods have been investigated : one which imposes a cut - off on the coulomb potential , and one based on the removal of the spurious effects through a multipole expansion .",
    "both yield satisfactory results , and comparable efficiency .",
    "the former approach has been already been surveyed by jarvis _",
    "@xcite there are two possibilities for the cut - off function , one , the spherical cut - off , was highlighted for having superior convergence with the plane wave cut - off of the reciprocal lattice .",
    "however , we have identified and corrected problems with the other possibility , the cubic cut - off , which eliminates the poor behaviour , and makes this cut - off method the better of the two because smaller fft s are allowed .    the method based on multipoles corrections",
    "was initiated by shultz , @xcite but we have developed a scheme which we think is more general .",
    "its performance is more predictable than that of the cut - off methods , which are sensitive to the choice of the cut - off length .",
    "the reason for the sensitivity is that the cut - off length determines the size of a larger auxiliary cell and the number of grid points over which fft calculations are performed , and the fft is sensitive to the prime number decomposition of the number of points . on the other hand , the speed and accuracy of our `` multipoles correction '' method , are adequate for most applications , and can be easily controlled by choosing the order of corrections applied .",
    "all the methods have been presented assuming a cubic cell .",
    "however , generalizations to other cell shapes are possible if the geometry of the system requires it .",
    "the multipoles correction method is immediately applicable to any cell .",
    "clearly the spherical cut - off method would be inefficient for elongated cells because the radius of the cut - off sphere is determined by the longest dimension of the cell .",
    "but , the cubic cut - off method can easily be generalized to other cell shapes , at the cost of more , and more lengthy calculations of the fourier transforms of the truncated coulomb interaction .",
    "we have made a simple implementation of the solvers within the self - consistent framework , but smarter algorithms can be developed , since not all the iterations of a self - consistent calculation need be done with the same accuracy . for example , significant improvements in efficiency can be gained if , for a given method , the iterations are started with a fast but inexact solver through appropriate choice of the control parameter , but improved as self - consistency is approached .",
    "moreover , methods could be combined using , for instance , the real - space method for the last few iterations because of its efficiency when a good starting point is known .",
    "we are pleased to acknowledge useful discussions with j. a. alonso .",
    "we also acknowledge financial support from jcyl ( grant : va 28/99 ) and dges ( grant no . dges - pb98 - 0345 ) and european community tmr contract nanophase : hprn - ct-2000 - 00167 .",
    "a. c. acknowledges financial support by the mec , and hospitality by queen s university , where most of this work has been done , during a research visit .",
    "m. j. s. acknowledges the support of the nserc of canada , of iberdrola through its visiting professor program , and of the universidad de valladolid where this work began .",
    "in fact , some numerical difficulties arise when calculating this constant .",
    "a better approach is splitting the function into periodic and aperiodic parts , and performing the integration only for the periodic part , which should integrate to zero ."
  ],
  "abstract_text": [
    "<S> reciprocal space methods for solving poisson s equation for finite charge distributions are investigated . </S>",
    "<S> improvements to previous proposals are presented , and their performance is compared in the context of a real - space density functional theory code . </S>",
    "<S> two basic methodologies are followed : calculation of correction terms , and imposition of a cut - off to the coulomb potential . </S>",
    "<S> we conclude that these methods can be safely applied to finite or aperiodic systems with a reasonable control of speed and accuracy . </S>"
  ]
}