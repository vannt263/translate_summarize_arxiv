{
  "article_text": [
    "type ia supernovae , empirically established to be standardized candles , are a staple of experimental cosmology . a number of future cosmological probes ( _ e.g. _ , des , pan - starrs , lsst , jdem ) are planning massive sky surveys that will collect very large samples of supernovae , which will have to be classified into several known types .",
    "supernova candidates are most easily classified by their spectra , but for very large ground - based surveys it may be impractical to obtain a spectral confirmation of the supernova type for each candidate .",
    "therefore , it is imperative to develop reliable methods of supernova classification based on photometric information alone .",
    "photometric typing has been described in  @xcite ,  @xcite ,  @xcite and  @xcite , among others .",
    "most of the existing methods rely on color - color or color - magnitude diagrams for supernova classification .    in this paper",
    ", we propose a novel approach to the photometric typing of supernova candidates .",
    "this method is based on a probability derived using a bayesian approach , and is well suited for extracting the maximum amount of information out of limited data .",
    "unlike methods relying on color - color or color - magnitude diagrams , which require a comparison of the candidate s color(s ) with pre - existing tables or plots  a comparison that requires a good understanding of the errors and assumptions that went into the making of the literature data  our approach calls for a calculation of a single number and automatically takes into account all of the information that is available for a given candidate while incorporating the currently best - known models for supernova behavior .",
    "a bayesian method in the context of supernova light curve fitting has been used in  @xcite ; however , it was applied specifically to type ia supernovae to deduce redshift - independent distance moduli . in this paper , on the other hand , we describe a probabilistic approach to typing photometrically surveyed supernovae .",
    "such an approach allows the possibility of the marginalization ( integration ) of the unknown , or nuisance , parameters .",
    "in contrast to a traditional @xmath0 calculation , this technique is simply a calculation of a probability and does not involve fitting or minimization .",
    "however , it does require that the candidate sample be well understood ; or , in other words , that each candidate be one of a number of hypothesized objects whose behavior can be well modeled .",
    "the purpose of this paper is twofold .",
    "apart from introducing a methodology that can be easily applied `` as is '' or extended as needed , we would like to test the extent to which applying the best currently available supernova models helps in typing supernova candidates .",
    "there is no doubt that within the next several years new and improved supernova models will be constructed ; when they are , they can be easily worked into the method .",
    "the paper is structured as follows . in section  [ sec : like ] , we derive the probability that a given candidate is a type ia supernova . in section  [ sec : valid ] , we discuss how well the method works when applied to poorly sampled , hubble space telescope goods data , and to well - sampled , ground - based snls data .",
    "we suggest further improvements to the method in section  [ sec : improve ] , discuss its possible application to `` anomalous '' objects in section  [ sec : anomalies ] ; and to fitting for supernova parameters , in section  [ sec : fitting ] .",
    "conclusions are given in section  [ sec : concl ] .",
    "let us suppose that we have a sample of supernova candidates where it has been established that every candidate is consistent with some type of astronomical object with known or well - modeled photometric behavior ( one approach to making sure that this is indeed the case is discussed in section  [ sec : anomalies ] ) . in our example , we consider photometric models for type ibc iil , iip , iin , and standard , or `` branch - normal ''  @xcite , type ia supernovae because they are currently best known ; however , the method can be trivially extended to include other supernova types , as well as variable objects that are not supernovae , once reliable models for such objects are available .",
    "we would like to determine the probability that a given candidate in the sample is a supernova of some known type @xmath1 , given its measured light curve data . here",
    ", we will focus on the case where @xmath1 is ia , but the method can be easily applied to other types as well .    here and for the remainder of the paper we assume that the redshift of the supernova candidate is perfectly known .",
    "we begin by assuming that the light curve of the candidate is measured in a single broadband filter @xmath2 ( the method can be trivially extended to any number of filter bands ) .",
    "the light curve measurements are represented in @xmath3 ( observing times ) as @xmath4 , where @xmath5 = [ 1, ... ,@xmath6 . we would like to know the probability that this candidate is a type @xmath1 supernova , @xmath7 .",
    "technically , since @xmath4 defines the candidate , we are calculating the probability that the type @xmath1 hypothesis is true given a candidate , or : @xmath8 the probability @xmath7 depends on many parameters .",
    "we will express @xmath7 as a function of these parameters and , in the end , marginalize them to quantify @xmath7 .",
    "assume now that we have a photometric model ( which we will also refer to as a template ) , @xmath9 , for the expected light curve for a supernova of type @xmath1 at a given redshift , observed in filter @xmath2 .",
    "in general , this model depends on parameters such as the date of maximum light @xmath10 ( or , equivalently , the time difference between the dates of maximum light for the model and the data , @xmath11 ) ; stretch @xmath12  @xcite , which parametrizes the width of the light curve ( if @xmath1 = ia ) ; the assumed absolute magnitude @xmath13 in the restframe @xmath14-band ; and interstellar extinction parametrized , _",
    "e.g. _ , by the cardelli - clayton - mathis parameters @xmath15 and @xmath16  @xcite",
    ". we will refer to this collection of parameters as @xmath17 the parameters @xmath18 uniquely define @xmath9 for type @xmath1 : @xmath19    in this study , we would like to determine the probability @xmath20 that the candidate is a type ia supernova given the measurements @xmath4 .",
    "unfortunately , this probability is not directly calculable , but one can easily calculate @xmath21 , the probability of obtaining the measurement given that the candidate is a type ia supernova .",
    "bayes theorem allows us to relate these two quantities .",
    "navely , we may write @xmath22 where @xmath23 is the probability to obtain data @xmath4 for supernova type ia , @xmath24 contains prior information about type ia supernovae , and the denominator is the normalization over all of the known supernova types @xmath1 .",
    "this sum is over a finite number of supernova types , which gives a legitimate probability because we assume that each candidate must be one of the types summed in the denominator .",
    "of course , one would like the denominator to include a model for every possible object that could mimic or be a supernova ; in practice , we have to limit ourselves to a subset of major supernova types with well - known photometric models .",
    "when calculating @xmath25 one must consider that a range of possible values is allowed for the stretch , extinction , and other parameters that characterize a type ia supernova .",
    "therefore , we express @xmath25 as a function of these parameters and then marginalize them : @xmath26 the prior probability @xmath27 contains all known information about the distributions of @xmath11 , @xmath13 , @xmath12 , and other relevant parameters for type @xmath1 supernovae .",
    "note that @xmath28 could also include the relative probabilities of obtaining a type @xmath1 supernova , _",
    "i.e. _ , the relative rates of the different supernova types . however , in this study we will assume no prior knowledge of the relative supernova rates , and instead assume the rates are all the same .",
    "because @xmath18 and @xmath1 uniquely define @xmath9 , @xmath29 can be written as : @xmath30 the measured light curve , @xmath4 , is taken to be in units of counts / second , and can fluctuate from the model @xmath9 according to gaussian statistics : @xmath31 in this expression , @xmath32 and @xmath33 are experimental measurements and errors for epoch @xmath5 , @xmath9 represents the predicted light curve for a type @xmath1 supernova , and @xmath34 is an increment of @xmath35 .",
    "we use the models ( represented by @xmath9 ) for supernova ia , ibc , iil , iip , and iin from  @xcite .",
    "several issues are of the essence here .",
    "first , the model for type ia supernovae extends both into the uv ( below 3460  in the supernova rest frame ) and into the ir ( above 6600  in the supernova rest frame ) regions .",
    "both of these regions are poorly constrained with the currently available data .",
    "this is in fact the reason why some authors  ( * ? ? ?",
    "* for example ) choose to limit themselves to only the well - known part of the type ia supernova spectrum .",
    "second , the behavior of non - type ia supernovae , especially at high redshifts , is not well known ; the currently available models may or may not be an adequate representation of these objects . in our work",
    ", however , we are interested in exploring the extent to which the best possible supernova models currently available offer a discriminating power . a bayesian approach that allows",
    "one to easily work in the uncertainties on any prior knowledge of supernovae appears quite natural for the situation .",
    "the supernova models used in this work are discussed in more detail in appendix a.    in order to calculate the prior @xmath36 , we make the simplifying assumption that @xmath15 and @xmath16 , @xmath11 , @xmath13 and @xmath12 are all independent , allowing us to factorize the probability : @xmath37    let us consider each of the terms in eqn .",
    "[ equation : prior ] in turn , starting with the probability @xmath38 of observing a supernova of type @xmath1 . since we assume no prior knowledge of the relative rates of the various types , each type has an equal probability of appearing in the candidate sample .",
    "therefore , @xmath38 is a constant : @xmath39 where @xmath40 is the number of supernova types considered .",
    "we also assume a flat prior for the difference in the dates of maximum light between the model and the data , @xmath11 . in practice , we compare the measured and modeled light curves shifting their relative dates of maximum by one day .",
    "marginalization over @xmath11 thus means summing over a finite number of such shifts .",
    "as each shift has an equal probability and the prior must be normalized to 1 , @xmath41 where @xmath42 is an increment of @xmath11 , @xmath43 is the number of shifts , and the maximum @xmath44 and minimum @xmath45 set the limits on @xmath11 .",
    "we take @xmath43 to be 160 .",
    "there are potentially large uncertainties associated with how well the luminosity function of a particular type supernova is known .",
    "this is accounted for in the prior @xmath46 : @xmath47 here , @xmath48 is an interval in @xmath13 .",
    "we extract the mean magnitudes @xmath49 in the restframe @xmath14-band from  @xcite , and the standard deviations , @xmath50 , from  @xcite .",
    "table  [ tab : mags ] summarizes the values used .",
    ".[tab : mags ] mean magnitudes ( vega , restframe @xmath14-band ) and standard deviations for different supernova types . [ cols=\"^,^,^\",options=\"header \" , ]     it should be noted that all four of these candidates had one band that was not fit by salt , as the mean wavelength corresponding to the omitted band in the supernova restframe was outside the acceptable salt wavelength range .",
    "most other candidates in fig .",
    "[ fig : ground ] ( left ) have a near - one @xmath25 .",
    "only one of them , 03d1fq , is somewhat of an outlier with a @xmath25 = 0.73 .",
    "this candidate has data in only two out of the four bands , @xmath5 and @xmath51 .",
    "the four failures and the fact that for all of them there was at least one band that was outside the [ 3460  - 6600  ] restframe range may well signal a failure of the template to provide an adequate description of the supernova behavior outside this range ; however , the fact that only 4 out of 73 candidates failed to yield desired discrimination is encouraging .",
    "it is also interesting to compare our probabilities @xmath7 with the results of the salt fits ",
    "namely , the @xmath0 probabilities given @xmath52 degrees of freedom , @xmath53 . table  [ tab : badsnls ] shows that the three `` undefined '' candidates also had exceptionally low @xmath0 probabilities from the salt fits .",
    "figure  [ fig : probvschi2 ] ( left ) presents the @xmath0 probability of the salt fits vs. @xmath25 .",
    "one feature of this plot is the spread of the @xmath0 probabilities for the candidates for which we calculated @xmath20 to be essentially one .",
    "@xmath54{f6a.eps } & \\includegraphics[width=2.7in]{f6b.eps }   \\end{array}$ ]    figure  [ fig : probvschi2 ] ( right ) shows the efficiency of selecting type ia supernovae in the snls sample for one choice of @xmath55 = 0.98 ( where we require @xmath25 to be greater than @xmath55 ) , as a function of redshift .",
    "it is apparent that the efficiency remains flat within errors .",
    "we are unable to test the purity of this selection , as the non - type ia candidates from the snls collaboration are not yet publicly available ; however , we will certainly be able to do so when the data are released .      in order to investigate how changing the assumptions on the priors",
    "affects our results , we performed a number of simple tests . for all of the tests",
    ", we varied only one prior while keeping the rest of them unchanged .    * assuming that the stretch parameter for all type ia candidates is 1 increases the number of type ia / ia * snls candidates that have low ( @xmath56 0.5 ) or undefined @xmath25 from 4 to 6",
    ". it also lowers the probability for one gold ia goods candidate , 2002hp , from 0.83 to 0.32 ; and for one silver ia goods candidate , 2002fy , from 0.52 to 0.03 . *",
    "assuming no extinction increases the number of snls candidates with low / undefined probabilities from 4 to 13 .",
    "this change does not significantly alter the probabilities for the gold goods ia candidates ; however , it does lower @xmath25 for 2002fy to 0.15 ; and increases @xmath25 for one silver cc candidate , 2002kl , from 0.01 to 0.80 . *",
    "using a flat prior on the magnitudes does not change the number of undefined probability snls candidates and moves candidate s 03d1fq probability from 0.73 to 0.43 . for the goods candidates",
    ", it lowers the probability for one silver ia , 2002fy , from 0.52 to 0.14 , but does not change the cc candidates probabilities . *",
    "the assumption of the flat prior on the supernova rates is undoubtedly incorrect ; however , it is difficult to suggest a plausible alternative since the rates for different supernova types ( particularly for non - type ias ) are not well known , especially at high redshifts .",
    "recent work  ( * ? ? ?",
    "* for example ) seems to indicate that the rates of cc supernovae with respect to type ia s are higher by approximately a factor of 3 at redshifts up to @xmath51 @xmath57 1 . assuming this ratio holds at all redshifts , and modifying the prior accordingly",
    ", 5 snls candidates end up with low or undefined probabilities . as far as goods candidates are concerned",
    ", this change lowers @xmath25 for 2002fy from 0.52 to 0.27 ; but does not alter the distribution for the cc candidates",
    ".    the choice of priors in any bayesian method should be as complete as possible , reflecting the general belief about the relative probabilities of various choices of parameters .",
    "for the data we have considered , the choice of the extinction prior appears to have the biggest effect , although it is clear that all of the priors can have a dramatic effect on @xmath58 for some candidates .",
    "a change in any prior appears to be particularly consequential for the candidates whose classification was not strong to begin with ( _ e.g. _ , the starting @xmath25 with all of the default priors for the most affected gold ia , 2002hp , was only about 0.83 ; and for the most affected silver ia , 2002fy , it was 0.52 ) .",
    "while the method described in the paper appears to be quite promising , there are a number of improvements that are still to be explored .",
    "for instance , we have ignored the correlations between supernova parameters by assuming the factorizable prior in eqn .",
    "[ equation : prior ] . provided that these correlations are well known , they can be included in a hessian matrix within the gaussians . another improvement would be to use the poisson distributions in lieu of the gaussians in eqn .",
    "[ equation : likelihood ] , especially for low photon statistics .",
    "in general , poisson distributions have the added advantage of integrating nicely to gamma functions under certain circumstances . here , the photon rates are average counts over time , so they lend themselves better to gaussian approximations .",
    "however , one could just as easily use absolute number of counts taken for a given epoch and use poisson errors .",
    "using better models , both for the supernova behavior and for the behavior of the parameters that affect supernova observations ( _ e.g. _ , the interstellar dust ) , is another issue that is important for providing a better discrimination .",
    "the proposed method is of course only as useful as the ability of the models it relies on to accurately represent the actual diversity of the observed supernova sample ; future ground- and space- based samples will yield tremendous improvements in this regard .",
    "the calculation of @xmath59 is highly dependent on characterizing the full range of objects that may be in the candidate sample . in practice",
    ", we must always consider the possibility that the candidate sample may be contaminated with `` anomalies '' that are merely mimicking a supernova signal  _",
    "e.g. _ , certain known variable astronomical types , such as agns , or residual `` objects '' resulting from poor image processing . furthermore , while there are now spectral templates for many special supernova types ( _ e.g. _ , ia 1991bg , 1991 t , high velocity ibc ) , there always exists the possibility that there are other , as of yet , undiscovered , supernova species . however , eqns .",
    "[ eqn : final_ia ] and  [ eqn : final_t ] can be used to discard such anomalous supernovae with the following prescription .",
    "first , we define a likelihood : @xmath60",
    "so that @xmath61 then , for each candidate , we calculate the likelihoods for the various types @xmath1 , @xmath62 , as described above . we also generate large samples of monte carlo events for each type considered ( ia , ibc , iil , _ etc . _ ) , and calculate a corresponding likelihood distribution + @xmath63 for each type @xmath1 .",
    "we define parameter @xmath64 such that if the probability of obtaining @xmath63 @xmath56 @xmath62 is smaller than @xmath64 , then the candidate is designated an anomaly . effectively , @xmath64 is the confidence level that the candidate is not a type @xmath1 supernova .",
    "note that it is advantageous to consider each type @xmath1 in turn , rather than the entire denominator of eqn .",
    "[ eqn : bayes ] , since this approach does not force one to make any assumptions about the relative numbers of supernovae of type @xmath1 in the likelihood distributions",
    ".    the parameter @xmath64 must be larger than the inverse of the number of simulated events for type @xmath1 . in practice",
    ", the amount of cpu time limits the number of simulated supernovae that one can generate , and therefore constrains @xmath64 .",
    "note that this method does not remove events whose light curves are similar to known types ; @xmath64 essentially defines how different the light curves of an anomaly must be from the known supernova light curves for it to be tagged an anomaly .",
    "large values of @xmath64 will possibly allow fewer anomalies that look similar to known supernova types to contaminate the `` purified '' sample , but will also decrease the statistics in the number of candidates of interest .",
    "a small @xmath64 will require that anomalies differ more dramatically from the known supernova types , but it increases the statistics for the candidates that we want to measure .",
    "small @xmath64 values are also difficult to obtain as @xmath64 is constrained by the number of simulations .    using parameter @xmath64 to make a cut on @xmath62 is quite similar to using the more traditional @xmath0 analysis for candidate selection .",
    "the @xmath0 probability quantifies how likely it is that a measured distribution would have an equal or greater deviation from the model than the one observed .",
    "likewise , we calculate the likelihood @xmath62 and find how likely it is to for a particular candidate s data to fluctuate to model @xmath1 ; if it is unlikely ( _ i.e. _ , the likelihood is less than @xmath64 ) for all types , we call such a candidate an anomaly .    note that this method would not effectively remove poorly sampled anomalies , as their probability would be relatively high for every type",
    ". the practicality of this approach for purging anomalies will be explored in a future paper .",
    "finally , note that using a method based on this simple likelihood criterion to provide the actual classification of supernovae is very different from our bayesian classification approach , since it does not account for the possibility that a number of supernova types might have the same values for @xmath18 .",
    "the bayesian adapted template match ( batm ) method described in  @xcite uses a maximum likelihood fit to extract supernova parameters . for completeness",
    ", we also describe the procedure for maximizing the likelihood for a given parameter , as well as for estimating the errors on the parameter .",
    "the formulation of @xmath65 lends itself to a maximum likelihood fit to @xmath11 , @xmath13 , @xmath12 or @xmath15 and @xmath16 provided that the supernova type @xmath1 is known .",
    "indeed , we have maximized @xmath65 to find the `` best - matching '' configurations of these variables in section  [ sec : valid ] ( see figs .",
    "[ fig : best_space ] and  [ fig : ground](right plot ) ) , where we see that it does an excellent job .",
    "however , these configurations were found by maximizing all the parameters at the same time . to find the best estimate for one parameter",
    ", we must assume the possibility that the others have some range of values - each with a corresponding probability .",
    "that is , we need only maximize one parameter at a time and marginalize the rest . in this scheme",
    ", errors are estimated by integrating the likelihood to obtain the upper and lower bound of the 68% confidence region .",
    "for instance , suppose that we want the best estimate for the magnitude , @xmath13 .",
    "we first marginalize all the parameters in the likelihood to obtain @xmath66 .",
    "then , assuming that maximizing @xmath66 gives the best estimate for the fitted parameters , we maximize @xmath66 to obtain the best estimate for @xmath13 , @xmath67 . with the best estimate calculated , we then find the uncertainties by satisfying    @xmath68    where @xmath69 and @xmath70 are the upper and lower bounds of the @xmath71 confidence region .",
    "this procedure would then be repeated for all the parameters for which we want estimates , by maximizing @xmath72 , @xmath73 , _ etc .",
    "_ computationally , it may be necessary to replace the integrals with finite sums up to values where the terms of the likelihood are negligible , provided there is a single peak in the likelihood distribution .",
    "note that there are circumstances where maximizing @xmath66 does not give the best estimate for the fitted parameters . as an example",
    ",  @xcite argue that a correction to the parameters is needed for this to be the case .",
    "this is one crucial reason why the performance of the likelihood always needs to be tested with monte carlo calculations .",
    "we introduced a novel method to determine the probability that a supernova candidate is indeed a certain type of supernova sing photometric information alone .",
    "the probability is derived using a bayesian approach .",
    "we have tested the method on both poorly sampled hst goods space - based data and well - populated snls ground - based light curves , with good results even for data where very few epochs available .",
    "while we considered primarily the application of this method to identifying type ia supernova candidates , it can of course be used to identify any other known supernova types ( see fig .  [",
    "fig : mc ] ) .",
    "the results of these studies show the method to be promising .    we have assumed that the candidate sample consists entirely of supernovae .",
    "the method naturally incorporates a number of possible hypotheses for the supernova types , allowing one to introduce prior knowledge of the probability distributions for various supernova parameters , as well as to marginalize them . because it is crucial that the sample consist of candidates that have reliable models ( _ i.e. _ , well understood supernova types such as branch - normal ia , ibc , _ etc . _ ) , we also proposed a possible approach for eliminating anomalous or less well understood candidates from the data .",
    "as more models for different supernova types become available , more candidates will pass this preliminary selection to be further considered for typing .",
    "we have used the best currently available supernova models for all of the supernova types considered . while aware of their limitations , we note that using these models already yields good discriminating power ; as better supernova models become available from the ongoing and upcoming ground- and space- based supernova surveys , classifying supernovae with this approach will become proportionally more reliable .    the method described in this paper",
    "could be useful for a number of studies .",
    "an obvious application is selecting a high - purity sample of type ia s for further analysis  _",
    "e.g. _ , creating a hubble diagram and extracting cosmology . in order to do so , one would re - parametrize the likelihood in terms of the distance modulus @xmath74 and maximize @xmath75 to obtain the best estimates of the distance modulus and the redshift of the candidate , as well as the errors on these parameters , as described in section  [ sec : fitting ] . a pure sample of type @xmath1 supernovae",
    "could also be used for calculating the rates of this class of objects , provided one performs careful monte carlo studies of the method s rejection factor for type @xmath1 supernovae .",
    "another potentially useful application would be adapting the method for early - time light curve parameters in such a way as to make it a trigger for type ia supernovae in large supernova surveys .",
    "other possible extensions of the method would include introducing prior information on supernova rates for the different supernova types , as well as building a bayes factor to measure the relative likelihood that a given candidate is more or less likely to be a ia supernova than another type .",
    "we are grateful to the anonymous referee for many useful comments and suggestions .",
    "we would like to thank reynald pain for providing us with the snls type ia supernova photometry , and mark sullivan for making his stretch data available to us .",
    "we are also grateful to natalie roe , alex kim , kyle barbary , greg aldering , saul perlmutter , eric linder , and tony spadafora for fruitful discussions .",
    "we would especially like to thank segev benzvi for his careful reading of the paper draft and his many useful suggestions .",
    "nk is partially supported by the director , office of science , department of energy , under grant de - ac02 - 05ch11231 .",
    "in order to create the template supernova light curves in the available filter bands , we do the following .",
    "we start with a spectral template from  @xcite .",
    "the templates are made primarily from the publicly available supernova data assembled in the suspect database.suspect/index1.html ] we consider five supernova types : ibc , iil , iip , iin , and branch - normal ia .",
    "the branch - normal ia template is based on  @xcite , with some additional features such as the smoothing out of the uv part .",
    "this template is for a stretch 1 ia .",
    "the ibc template is based on  @xcite ; the iil , iip , and iin templates are based on  @xcite , with a contribution from  @xcite for iip s and from  @xcite for iin s .    using the template for a given type , we compute the expected flux of the supernova at a given redshift , assuming the @xmath76cdm cosmology ( @xmath77 = 0.7 , @xmath78 = 0.3 , and @xmath79 = const = -1 ) .",
    "the templates are created for 12 different values of the peak @xmath14-band magnitudes , in the range of @xmath80 3 @xmath50 , as listed in table  [ tab : mags ] . for type ia s , each template is also generated for 14 different values of stretch , ranging from 0.6 to 1.3 .",
    "three types of templates are made : one assuming no interstellar extinction , and two with extinction parametrized by the cardelli - clayton - mathis parameters @xmath81",
    "= @xmath82 and @xmath83 .",
    "the simulation enables one to simulate either a ground- or a space- based observatory .",
    "the generated supernova flux is convolved with the atmospheric transmission ( for the ground - based case ) , as well as relevant telescope , detector , and filter transmissions ( for either ground- or space- based case ) . after the observations",
    "are thus generated , they are realized by an aperture exposure time calculator , creating light curves in each of the relevant filter bands .",
    "the signal - to - noise @xmath84 ratio is computed as : @xmath85 where @xmath86 is the supernova source rate , @xmath87 is the fraction of the source flux in the aperture , @xmath88 is the exposure time , @xmath89 is the sky rate , @xmath90 is the effective seeing area , ( computed taking into account the atmospheric seeing for the ground - based case , the diffraction radius calculated for a given filter central wavelength , the detector diffusion , and the detector pixel size ) , @xmath91 is the detector dark current rate , @xmath92 is the detector read noise , @xmath93 is the number of pixels in the aperture , @xmath94 is the number of exposures , and @xmath95 is the flatfielding contribution from the detector inter - pixel sensitivity variations : @xmath96 where @xmath97 is the flatfielding error , taken to be 10@xmath98 .",
    "the stretch parameter is not defined for non - type ia supernovae . however , the calculation of @xmath99 necessitates that it be formally introduced for all candidates , regardless of type . if it was not included , the sum over the stretch in the numerator and denominator of eqn .",
    "[ eqn : bayes ] would weight the non - type ia s by a factor of @xmath100 .    to show how the stretch might be introduced for non - type ia supernovae",
    ", we define @xmath101 as some generic non - type ia supernova type , and @xmath102 we then calculate @xmath103 imposing eqn.[equation : prior ] : @xmath104 where , not specifying anything about the stretch parameter @xmath12 , we allow it to take on any value between @xmath105 and @xmath106 .    then , for type @xmath101 supernovae , we require that the likelihood , @xmath107 remain unchanged for any choice of @xmath12 . that is , @xmath108 therefore , eqn.[eqn : almost_there ] becomes @xmath109 if @xmath110 is the probability density such that @xmath111 , then probability theory requires @xmath112    however , eqn.[eqn : bayes ] remains the same if we set @xmath113 as well as replace the upper and lower bounds in eqn.[eqn : integrate_s ] with @xmath114 and @xmath115 , respectively ; and use the same limits of integration , @xmath115 and @xmath114 , for both the numerator and denominator .",
    "this is the reason for the choice of stretch prior in eqn .",
    "[ eqn : spriornonia ] .",
    "g.  aldering _ et al .",
    "_ , preprint astro - ph/0607030 ( 2006 ) p.  astier _ et al .",
    "447 , 31 ( 2006 ) e.  baron _ et al . _ ,",
    "apj 616 , 91 ( 2004 ) b.  j.  barris and j.  l.  tonry , apj 613 , l21 ( 2004 ) p.  bhat , h.  prosper , and s.  snyder , phys . lett .",
    "b 407 , 73 , ( 1997 ) d.  branch , a.  fisher , p.  nugent , aj 106 , 2383 ( 1993 ) j.  a.  cardelli , g.  c.  clayton , and j.  s.  mathis , apj 329 , l33 ( 1988 ) t.  dahlen _ et al .",
    "_ , apj 613 , 189 ( 2004 ) e.  di carlo _ et al _ , apj 573 , 144 ( 2002 ) . m.  dickinson _",
    "et al . _ , in the proceedings of the eso / usm workshop `` the mass of galaxies at low and high redshift '' ( venice , italy , october 2001 ) , eds .",
    "r. bender and a. renzini ( 2003 ) a.  fruchter and r.  n.  hook , pasp 114 , 144 ( 2002 ) m.  giavalisco _ et al .",
    "_ , apj 600 , l93 ( 2004 ) r.  l.  gilliland , p.  e.  nugent , m.  m.  phillips , apj 521 , 30 ( 1999 ) j.  guy _",
    "et al . _ , accepted for publication in a&a , preprint astro - ph/0506583 ( 2005 ) k.  hatano , d.  branch , and j.  deaton , apj 502 , 177 ( 1998 ) d.  a.  howell _ et al . _",
    ", to be published in apj , ( 2005 ) b.  johnson and a.  crotts , submitted to aj , preprint astro - ph/0511377 ( 2005 ) a.  levan _ et al .",
    "_ , apj 624 880 ( 2005 ) s.  nobili _ et al .",
    "_ , a&a , 437 , 789 ( 2005 ) p.  e.  nugent , http://supernova.lbl.gov/@xmath57nugent/nugent_templates.html ( 2006 ) p.  e.  nugent , a.  kim , and s.  perlmutter , pasp 114 , 803 ( 2002 ) m.  k.  patil , s.  k.  pandey , d.  k.  sahu , a.  k.  kembhavi , accepted for publication in a$a , preprint astro - ph/0611369 s.  perlmutter _ et al .",
    "_ , apj 483 , 565 ( 1997 ) d.  poznanski _ et al .",
    "_ , pasp , 114 , 833 ( 2002 ) a.  renzini _ et al .",
    "_ , in the proceedings of the eso / usm workshop `` the mass of galaxies at low and high redshift '' ( venice , italy , october 2001 ) , eds .",
    "r. bender and a. renzini ( 2003 ) d.  richardson _ et al .",
    "_ , aj 123 , 745 ( 2002 ) a.  g.  riess _ et al .",
    "_ , apj 600 , l163 ( 2004a ) a.  g.  riess _ et al .",
    "_ , apj 607 , 665 - 687 ( 2004b ) m.  sullivan _ et al . _ , accepted for publication in aj , preprint astro - ph/0510857 ( 2006 ) m.  sullivan _ et al . _ ,",
    "accepted for publication in apj , preprint astro - ph/0605455 ( 2006 ) l.  a.  valencic , g.  c.  clayton , k  d.  gordon , apj 616 , 912 ( 2004 )"
  ],
  "abstract_text": [
    "<S> this paper presents a novel method for determining the probability that a supernova candidate belongs to a known supernova type ( such as ia , ibc , iil , _ etc . _ ) , using its photometric information alone . </S>",
    "<S> it is validated with monte carlo , and both space- and ground- based data . </S>",
    "<S> we examine the application of the method to well - sampled as well as poorly sampled supernova light curves and investigate to what extent the best currently available supernova models can be used for typing supernova candidates . </S>",
    "<S> central to the method is the assumption that a supernova candidate belongs to a group of objects that can be modeled ; we therefore discuss possible ways of removing anomalous or less well understood events from the sample . </S>",
    "<S> this method is particularly advantageous for analyses where the purity of the supernova sample is of the essence , or for those where it is important to know the number of the supernova candidates of a certain type ( _ e.g. _ , in supernova rate studies ) . </S>"
  ]
}