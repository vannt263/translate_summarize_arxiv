{
  "article_text": [
    "since the completion of the sloan digital sky survey ( sdss ) @xcite optical astronomy has moved on from the detailed studies of single objects to a phase where catalogues with millions of entries can be produced . this has allowed for detailed statistical studies of entire populations , as well as searches for extremely rare objects .",
    "consequently , astronomers are forced to update their approach to data analysis and to embed their codes in database - supported applications that support efficient automatic procedures and easy administration of the analysis processes .",
    "one such case is the measurement of photometric redshifts for the hundreds of millions of galaxies that ongoing or future optical and near infrared photometric surveys will deliver .",
    "we are directly involved in three large scale imaging surveys .",
    "the panoramic survey telescope and rapid response system 1 ( panstarrs1 , see @xcite ) project started regular operations in may 2010 and is producing a 5 band ( grizy ) survey of 3/4 of the sky that at the end of the forseen 3 years of observations , will be @xmath0 mag deeper than sdss .",
    "approximately two hundred million galaxies , a similar number of stars , about a million quasars and @xmath1 type ia supernovae will be detected .",
    "viking ( vista kilo - degree infrared galaxy survey ) is a near - infrared 4 band ( zjhk ) survey of 1500 square degrees of extragalactic sky that started in december 2009 at the vista telescope .",
    "this will be complemented in 5 optical bands ( ubgri ) by the kilo degree survey ( kidskuijken / kids/ ] ) at the vst telescope , to start in october 2011 .",
    "finally , the dark energy survey ( des ) will image 5000 square degrees around the southern galactic pole in 4 optical bands ( bgri ) at the ctio telescope .",
    "looking to the future , we are participating in the euclid bid .",
    "if approved , the satellite will image 20000 square degrees of the extragalactic sky in the optical and nir channels , providing unprecedented deep photometry for many millions of galaxies .",
    "the science driving these projects ranges from baryonic acoustic oscillations and growth of structure , to weak shear , galaxy - galaxy lensing and lensing tomography .",
    "all of them rely on the determination of accurate photometric redshifts for extremely large numbers of galaxies .",
    "further science goals , like the detection of high redshift quasars and galaxies , the discovery of very cool stars , or the study of galaxy evolution with cosmic time will also profit from the availability of good photometric redshift and star / galaxy photometric classification .",
    "therefore , in the last few years we have designed and implemented schemes to derive and keep organized photometric redshifts , probability distributions and star / galaxy classification for extremely large datasets .    here",
    "we describe two aspects of these efforts ; the photoz implementation for astro - wise and the panstarrs1 photometric classification server .",
    "the structure of the paper is as follows .",
    "[ sec : photoz ] considers the algorithm at the core of our implementations and its recent scientific use .",
    "[ sec : implementation ] discusses the implementation of the code for large data sets . in sect .",
    "[ sec : awphotoz ] we present its astro - wise incarnation and give examples of its use and evaluate its performances in sect .",
    "[ sec : awperformances ] .",
    "[ sec : pcs ] is dedicated to the implementation of the code for the panstarrs1 survey .",
    "we draw our conclusions in sect . [",
    "sec : conclusions ] .",
    "in the last decade several efficient codes for the determination of photometric redshifts have been developed and a fair summary of these efforts would go well beyond the scope of the present contribution . in short , there are mainly two approaches , one based on empirical methods , the other on template fitting . in the first case one",
    "tries to parametrize the low - dimensional surface in color - redshift space that galaxies occupy using low - order polynomials , nearest - neighbor searches or neural networks @xcite .",
    "these codes extract the information directly from the data , given an appropriate training set with spectroscopic information .",
    "template fitting methods work instead with a set of model spectra from observed galaxies and stellar population models @xcite .",
    "the photoz code that we have implemented under astro - wise belongs to the second category and its original incarnation is described in @xcite .",
    "the code estimates redshifts @xmath2 by comparing a set of discrete template seds t to the broadband photometry of the ( redshifted ) galaxies . for each",
    "sed the full redshift likelihood function including priors for redshift , absolute luminosity and sed probability is computed using the bayes theorem : @xmath3 where @xmath4 is the vector of measured colors , @xmath5 the galaxy absolute magnitude , @xmath6 is the probability of obtaining a normalized @xmath7 for the given dataset with its errors , redshift and template @xmath8 , and @xmath9 the prior distribution .",
    "this is a product of parametrized functions of the type : @xmath10,\\ ] ] where the variable @xmath11 stands for redshift or absolute magnitudes .",
    "typically we use @xmath12 , @xmath13 or @xmath14 , and @xmath15 and @xmath16 with appropriate values for mean redshifts and ranges , or mean absolute magnitudes and ranges , which depend on the sed type .",
    "the set of galaxy templates is semi - empirical and is chosen to map the color space spanned by the different types of objects at different redshifts .",
    "the original set @xcite includes 31 seds describing a broad range of galaxy spectral types , from early to late to star - bursting objects .",
    "recently , we added a set of seds tailored to fit luminous red galaxies and one sed to represent the average qso spectrum at redshift @xmath17 @xcite .",
    "furthermore , the method also fits a set of stellar templates , allowing a star / galaxy classification and an estimate of the line - of - sight extinction for stellar objects .",
    "the templates cover typically the wavelength range @xmath18   up to 25000   ( with the qso template covering instead 300 - 8000  ) and are sampled with a step typically 10 wide ( varying from 5 to 20  ; the qso sed has @xmath19  ) .",
    "the method has been extensively tested and applied to several photometric catalogues with spectroscopic follow - ups . given a ( deep ) photometric dataset covering the wavelength range from the u to the k band , excellent photometric redshifts with @xmath20 up to @xmath21 with at most a few percent catastrophic failures can be derived for every sed type ( @xcite , @xcite , @xcite ) . when applied to the 5 filter band catalogs @xmath22 of sdss @xcite or @xmath23 of panstarrs @xcite , the code delivers @xmath24 for luminous red galaxies up to redshift @xmath25 .",
    "a more detailed description of the scientific merits of photoz goes beyond the scope of this paper , see @xcite to compare these performances to the ones achieved by other packages .",
    "the code is available in fortran and c++ versions .",
    "the science applications described in the previous section dealt with some thousand objects and could be managed by simple means , i.e. ascii - based catalogues . in the era of all - sky surveys and/or very deep fields , where millions , if not billions of objects are imaged , this approach is doomed to fail .",
    "the support of a database , the automatisation of the procedures and the tools to administrate the testing and analysis of the results become essential ingredients for a successful science project . therefore , having in mind our participation in the panstarrs1 survey and future projects like kids , des and possibly euclid ( see introduction ) , we designed and implemented two packages , photoz for astro - wise ( see sect .",
    "[ sec : awphotoz ] and [ sec : awperformances ] ) and the photometric classification server ( pcs ) for panstarrs1 ( see sect . [",
    "sec : pcs ] ) .",
    "we embedded the photoz code in astro - wise following the general philosophy of the package .",
    "a python wrapper ( _ photredcatalog _ ) interfaces the oracle astro - wise database to the ( fortran ) code , providing the necessary reading , executing and writing calls to construct the ascii input files with the photometry vectors , call the ( compiled fortran ) photoz code and transfer the ascii output back into the database . as usual in every astro - wise application , each persistent entry created in this last phase allows the backward tracing of the components down to the single raw and calibration frames that went into the production of the photometry used in the process .",
    "the option for a posteriori evaluation of the full redshift probability distribution for a list of selected objects is provided . a separate routine ( _ photredconfig _ )",
    "allows the folding of the available spectral energy distributions with the given filter curves on a predefined grid of redshifts to maximize the speed of the photoz code for a given photometric set .",
    "parallelization is obtained by splitting the list of objects to be analysed in smaller chunks , and executing separate calls of photoz on the multiple cluster nodes .",
    "visualization routines give the possibility to plot the best - fitting sed , the best - fitting stellar sed , the datapoints and the redshift probability distribution of selected objects . a schematic description of the structure of the photoz code is given in fig . [ fig : flowchart ]          photoz runs under astro - wise as implemented at the munich node on the panstarrs cluster , a 175 nodes ( each with 2.6ghz 4 cpus and 6 gb memory , for a total of 700 cpus ) beowulf machine with 180 tb disk space , attached to a pb robotic storing device , mounted at the max - planck rechenzentrum in garching .",
    "two servers run the oracle database .",
    "the munich astro - wise node is federated with the central node of groningen .    as an example how the system works",
    ", we describe the derivation of the photometric redshifts of galaxies detected in the medium deep field 4 ( mdf04 ) of panstarrs1 ( see also [ sec : pcs ] and @xcite ) in an astro - wise session . in this context below we indicate with `` awe@xmath26 '' the python astro - wise prompt . for a detailed description _ how to _ run the commands discussed below we refer to the astro - wise manual .",
    "we first ingest the panstarrs1 filter curves :    awe@xmath26 photredfilter = photredfilter ( pathname=ps_g.filter )    awe@xmath26 photredfilter.filter=(filter.mag_id==ps_g g )    awe@xmath26 ...    awe@xmath26 photredfilter.make ( )    where ps_g.filter is an ascii file with two columns , wavelength in angstroms and the transmission of the panstarrs1 g filter at this wavelength .",
    "we repeat the process for the filters r , i , z and y. then we configure the system , specifying the galaxy and stellar libraries ( see @xcite ) :    awe@xmath26 filt = ( filter.name = = ps_g)[0 ]    awe@xmath26 pfg = ( photredfilter.filter = = filt ) [ 0 ]    awe@xmath26 ...    awe@xmath26 pse = ( photredsed.sed_name = = mod_e.sed)[0 ]    awe@xmath26 ps1 = ( photredsed.sed_name = = mod_s210.sed)[0 ]    awe@xmath26 ...    awe@xmath26 starlib=(photredstarlib.filename==starlib_pickles.lis)[0 ]    awe@xmath26 pc = photredconfig ( )    awe@xmath26 pc.seds=[pse,ps1 , ... ]    awe@xmath26 pc.filters=[pfg,pfr,pfi,pfz,pfy ]    awe@xmath26 pc.starlib=(starlib)[0 ]    awe@xmath26 pc.name=panstarrs1_mdf04    awe@xmath26 pc.make ( )    we now ingest the panstarrs1 photometric catalogue into the _ sourcelists _ sg , sr , si , sz , sy and generate the photometric redshifts with the commands :    awe@xmath26 pr = photredcatalog ( )    awe@xmath26 pr.config=pc    awe@xmath26 pr.master=sg    awe@xmath26 pr.sourcelists=[sg,sr,si,sz,sy ]    awe@xmath26 pr.name=panstarrs1_mdf04    awe@xmath26 pr.make ( )    the results are stored in the pr.associate_list associatelist and can be examined through the oracle database tools and/or the python awe@xmath26 prompt . for example , the command    awe@xmath26 pr.plot ( 23 )    plots the best - fitting sed , the best - fitting stellar sed , the datapoints and the redshift probability distribution for the objects with identification number 23 in the associate_list .",
    "the derivation of photometric redshifts for the @xmath27 entries in the mdf04 photometric catalogue down to the @xmath28 magnitude takes 3.3 sec if our full panstarrs cluster ( 700 cpus ) is available ( i.e. @xmath29 objects per second per node ) . through the federation mechanism",
    "the results can be seen from each astro - wise federated node that has the relevant permissions to access the data .",
    "we are in the process of optimizing the seds and validating the photometric redshifts through available spectroscopic data for the panstarrs1 filter set .",
    "first results are discussed in @xcite , where a precision of @xmath30 for red luminous galaxies up to redshift @xmath31 is achieved .",
    "the photometric classification server ( pcs ) for panstarrs1 provides software tools to perform a photometric star / qso / galaxy classification , compute photometric redshifts for galaxies and ( a subset of ) best - fitting temperature , metallicity , gravity and interstellar extinction parameters for stars .",
    "a detailed description of the system can be found in @xcite , @xcite and @xcite .",
    "the code is interfaced to the published science products system ( psps ) database of panstarrs1 ( see @xcite ) , based on microsoft sql and inspired in its structure by the sdss database .",
    "the `` manual mode '' of operations is similar to the one described in sect .",
    "[ sec : awphotoz ] .",
    "the user can query the database and run the code off - line through sql commands and calls to shell scripts , or also through a web interface .",
    "this mode is useful when optimizing the seds using available datasets with spectroscopic redshifts",
    ". the normal mode of operation , however , is fully automatized .",
    "the interface to psps triggers the analysis of newly produced object catalogues of the static sky on a regular basis .",
    "when new entries are found , cas - like jobs extract them from the database in hawaii , format them on our panstarrs cluster and submit multiple runs of the c++ version of photoz with sub - blocks of data to parallelize the processing .",
    "finally , the resulting photometric redshifts are stored in a local mysql database and the corresponding table is pulled by the central one in hawaii .",
    "the process to download from the psps database the mdf04 catalogue ( @xmath17 minutes ) , measure the photometric redshifts on our panstarrs cluster ( @xmath32 sec if 700 nodes are available ) and provide the results for pulling by the psps database ( @xmath17 minutes ) takes at most 5 minutes .",
    "therefore we expect to sustain the expected regular flow of new photometric data of panstarrs1 without problems .",
    "the system is open for the implementation of further different approaches to photometric redshifts ( see sect . [",
    "sec : photoz ] ) .",
    "photoz under astro - wise and pcs for panstarrs1 , the systems to compute accurate photometric redshifts for large datasets described in this paper , are up and running .",
    "they are ready to analyse and archive the photometric catalogues with millions of entries that the wide area surveys started recently or starting in the near future will provide . they can be considered as prototypes for the future development of the data analysis schemes of euclid @xcite .",
    "abazajian , k.  n. et al .",
    "`` the seventh data release of the sloan digital sky survey '' apjs , 182 , 543 ( 2009 ) kaiser , n. , `` pan - starrs : a wide - field optical survey telescope array '' , spie , 5489 , 11 - 12 ( 2004 ) csabai , i. et al .",
    "`` the application of photometric redshifts to the sdss early data release '' , aj , 125 , 580 ( 2003 ) collister , a.a .",
    ", lahav , o. , `` annz : estimating photometric redshifts using artificial neural networks '' , pasp , 116 , 345 ( 2004 ) padmanabhan , n. et al .",
    ", `` calibrating photometric redshifts of luminous red galaxies '' , mnras , 359 , 237 ( 2005 ) ilbert , o. et al . , `` accurate photometric redshifts for the cfht legacy survey calibrated using the vimos vlt deep survey '' , a&a , 457 , 841 ( 2006 ) mobasher , b. et al . , `` photometric redshifts of galaxies in cosmos '' , apjs , 172 , 117 pello , r. et al . , `` photometric redshifts and cluster tomography in the eso distant cluster survey '' , a&a , 508 , 1173 ( 2009 ) bender , r. et al . , `` the fors deep field : photometric data and photometric redshifts '' , in _ deep fields _ , edited by s. cristiani , a. renzini , and r.e .",
    "williams , springer - verlag , berlin / heidelberg , p. 96 - 101 ( 2001 ) saglia , r.p .",
    "et al . , `` the photometric classification server for pan - starrs1 '' , apj , in press ( 2011 ) , arxiv:1109.5080 gabasch , a. et al . , `` the evolution of the luminosity functions in the fors deep field from low to high redshift : i. the blue bands '' , a&a , 421 , 41 - 58 ( 2004 ) feulner , g. , et al . , `` specific star formation rates to redshift 5 from the fors deep field and the goods - s field '' , apj , 633 , l9-l12 ( 2005 ) gabasch , a. et al . , `` a deep i - selected multiwaveband galaxy catalogue in the cosmos field '' , mnras , 383 , 1319 - 1335 ( 2008 ) greisel , n. , `` elliptical galaxies as traces of large scale structure '' , master thesis , ludwig maximilian university , munich ( 2010 ) hildebrandt , et al .",
    ", `` phat : photo - z accuracy testing '' , a&a , 523 , a31 ( 2010 ) saglia , r.p . ,",
    "`` the photometric classification server of panstarrs1 '' , proc . of the conference `` classification and discovery in large astronomical surveys '' , ringberg castle , 14 - 17 october 2008 , ed .",
    "bailer - jones , aip conference proceedings vol . 1082 , aip ( melville , new york ) , p. 366 - 372 ( 2008 )",
    "snigula , j.m . , bender , r. saglia , r. , drory , n. , `` the photometric classification client for pan - starrs-1 '' , asp conference series , j. lewis , r. argyle , p. bunclarck , d. evans , e. gonzales - solares eds . , 421 , 268 - 271 ( 2009 ) heasley , j.n . , `` the pan - starrs data processing and science analysis software systems '' , proc . of the conference `` classification and discovery in large astronomical surveys '' , ringberg castle , 14 - 17 october 2008 , ed .",
    "bailer - jones , aip conference proceedings vol . 1082 , aip ( melville , new york ) , p. 352",
    "- 358 ( 2008 ) laureijs , r. , `` euclid assessment study report for the esa cosmic visions '' , astro - ph/0912.0914 ( 2009 ) ."
  ],
  "abstract_text": [
    "<S> we describe the implementation of the photoz code in the framework of the astro - wise package and as part of the photometric classification server of the panstarrs pipeline . </S>",
    "<S> both systems allow the automatic measurement of photometric redshifts for the millions of objects being observed in the panstarrs project or expected to be observed by future surveys like kids , des or euclid . </S>"
  ]
}