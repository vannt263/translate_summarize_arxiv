{
  "article_text": [
    "a mesh is a partition of a domain into smaller parts , typically with simpler geometry , called cells . in two dimensions , both on the plane and on curved surfaces , cells are usually triangles or quadrilaterals",
    ". the shapes of the cells may be important ; for many applications , cells with shapes similar to an equilateral triangle or a square are preferred .",
    "the problem of mesh generation can then be seen as an optimization problem :  to find a partition of a domain into well - shaped cells , possibly under additional demands , such as cell size requirements .",
    "the mesh generation problem has been the subject of extensive research .",
    "many techniques for creating meshes exist , especially in two dimensions @xcite,@xcite,@xcite . nevertheless , some of the most popular techniques , which create good meshes in many cases , are heuristic in nature , and may create less than optimal meshes for some inputs .",
    "two of the inherent characteristics of the mesh generation problem seem to make it very difficult to solve :    ( characteristic 1 ) : :    the constraints on cells shapes are _",
    "global_. that is , the shape of    one cell is constrained by the possible shapes of its neighbors , which    in turn are constrained by the shapes of their neighbors , and so on .",
    "thus , at least in principle , the constraints on the mesh layout extend    over the whole domain ( or more precisely , over each connected    component of the domain ) .",
    "( characteristic 2 ) : :    the problem combines _ discrete and continuous aspects_. the number of    cells and the mesh connectivity ( i.e. : which cells are neighbors ?    which faces do they share ? ) are of discrete nature , whereas the    locations of the vertices can vary continuously .",
    "these aspects are    closely intertwined , preventing the sole use of purely discrete    techniques ( algebraic , graph - theoretic , etc . ) , or techniques designed    for use in problems of continuous nature .",
    "[ ptb ]    the meshes created by mesh generation algorithms  can be divided into structured meshes , and unstructured meshes . a structured mesh is a mesh whose connectivity is that of a regular grid , see fig .",
    "[ mapping_vs_unstructured ] , ( iii ) . by assuming the connectivity of the mesh beforehand ,",
    "the problem of creating such a mesh is considerably simplified ( see characteristic 2 above ) , and reduces to the problem of assigning locations to the mesh vertices .",
    "one way of doing that is by finding a _ mapping function _ that maps the domain of the regular grid to the domain to be meshed , and using it to map the vertices .",
    "such techniques are known as _",
    "mapping techniques_. for small enough cells , the differential properties of the mapping function at the cell s location dictate its shape . if , for example , a mapping is angle preserving , then the inner angle of a small enough cell will be approximately preserved under the mapping . for a survey ,",
    "mapping techniques have also been offered for unstructured meshes , ( in the context of smoothing a given mesh see @xcite,@xcite and references therein ) , as long as the connectivity of the mesh is given beforehand .    just as a structured mesh can be imagined as created by mapping of a region of the plane to the domain to be mapped , an unstructured mesh in two dimensions can be imagined as a surface , that is mapped onto the domain to be meshed .",
    "the simplest example is that of an unstructured mesh with just one irregular vertex ( a vertex that has more or less than four cells incident upon it ) . the surface to be mapped in this case is a cone",
    "this can be visualized using the volterra construction @xcite : consider a piece of paper with an angular section cut out , see fig .",
    "[ 3_cone_all],(i ) . if the two edges of the section are identified , i.e. glued together , the paper will assume the shape of a cone , see fig .",
    "[ 3_cone_all],(ii ) .",
    "if the cone is then mapped to the plane , a regular grid drawn on the cone would be mapped to an unstructured mesh such as the one shown in fig . [ 3_cone_all],(iii ) . the mapping shown in fig . [",
    "3_cone_all],(iii ) has the special property of being _ conformal _ : a small square on the cone is approximately mapped to a square on plane .",
    "this creates well shaped cells in the resulting mesh : in the limit of an increasingly smaller cell , its square shape is preserved under the conformal mapping . a similar construction can be imagined for creating an unstructured mesh with more than one irregular vertex ; each irregular vertex will then correspond to one cone tip  of the surface .",
    "the approach of the present work to the problem of creating unstructured meshes can be expressed as follows : given a domain to be meshed , _ what  surface ,  with  a  square  grid  drawn  upon  it , can  be  mapped  conformally into this domain ?",
    "_ thus , it is not just the mapping function that is sought after , but rather the surface to be mapped together with the mapping function . unlike mapping techniques",
    ", however , the mapping function is required to be conformal .",
    "[ tbh ]    a mathematical framework highly suitable for dealing with such questions is riemannian geometry .",
    "given the domain to be meshed , riemannian geometry allows one to define a new geometry  for that domain .",
    "this includes a redefinition of the distances between points of the domain , and it is used here to redefine distances such that _ a cell edge have unit length_. thus , instead of defining the surface that is mapped and the mapping function separately , both are treated together , as the mapping induces a new distance definition on the domain to be meshed .",
    "for example , the cone in fig . [ 3_cone_all],(ii ) and the surface in fig .",
    "[ 3_cone_all ] , ( iii ) have the same geometry  ( i.e. are isometric ) if the distances in fig . [",
    "3_cone_all],(iii ) are _ defined _ such that cell - edges have unit length . using the terminology of riemannian geometry",
    ", the problem can be restated as assigning a new metric to the domain being meshed , having the following properties :    ( property 1 ) : :    the metric is locally _ flat _ everywhere , except at some points , called    _",
    "cone points_. a flat  region can be imagined as a bent , but not    stretched , piece of paper .",
    "the cone points are the tips of the    cones  as described above .",
    "( property 2 ) : :    a single real function @xmath0 is defined in the domain    ( except at cone points ) , such that at any given point @xmath1 ,    the new metric @xmath2 at    @xmath1 is proportional to the original metric    @xmath3 :    @xmath4 , with    @xmath5 , .",
    "( on the plane with cartesian    coordinates @xmath6 . )",
    "we stress that the    proportionality @xmath7 can vary throughout the    domain .",
    "the quantity @xmath8 is the local change in    the distance definition and will be associated with the local cell    size .",
    "( in manifold theory terminology , the metric    @xmath9 is _ conformally _ _ _ _ related _ to    @xmath10 ) .",
    "these two properties are not sufficient for our purposes .",
    "first of all , as the volterra construction implies , for a grid of squares to be drawn around a cone tip , the total angle as measured around the tip must be a multiple of @xmath11 radians .",
    "secondly , the mesh must be aligned along the boundary , see fig .",
    "[ boundary_aligment ] . to formalize these demands",
    ", we define the direction of mesh - edges at each point on the surface .",
    "since the edges are assumed to form right angles at incidence , this direction is defined up to an addition of @xmath11 radians . ] .",
    "the four directions at each point will hence be called a _ cross _ , and the field of directions on the entire domain being meshed will be called a _ cross - field_. the cross - field is related to the new metric by requiring that the curves , generated by following the directions of the cross - field , along which the edges will be laid , will be geodesics of the new metric @xmath9 .",
    "( geodesics are the generalizations of straight lines for surfaces and manifolds . )",
    "the boundary alignment is formalized by requiring that the crosses be aligned with the boundary .",
    "we therefore add the following property to the required properties of the new metric :    ( property 3 ) : :    a cross - field exists .",
    "( exact definition is given in section    [ sec : cross_field ] . )",
    "property 1 states that the gaussian curvature @xmath12 of the manifold with metric @xmath9 be identically zero everywhere , except at cone points .",
    "combined with the equation @xmath13 of property 2 , the two formulas give a remarkably simple result , viz .",
    "that @xmath0 must obey the poisson equation @xmath14 everywhere exept at cone points , where @xmath15 is the gaussian curvature of the surface .",
    "this is a well known result in conformal geometry , see section [ sec : cross_field ] .",
    "[ tbh ]    the main result of the present work is that for a cross - field to exist the function @xmath0 , which uniquely defines the manifold , has to obey the poisson equation @xmath16 , with @xmath15 the gaussian curvature of the surface to be meshed ( @xmath15 vanishes for the plane ) , and @xmath17 a sum of localized charges  ( dirac delta functions ) .",
    "the charges are placed at the cone points locations , thus corresponding to the irregular vertices of the mesh .",
    "the charge strength is equal to the cone excess angle ( the difference between the cone angle and @xmath18 ) which corresponds to the number of cells incident on the irregular vertex .",
    "for example , in the manifold shown in fig .",
    "[ 3_cone_all],(iii ) , the cone point has an excess angle of @xmath19 .",
    "the charge of the cone point , located at a point @xmath1 , corresponding to such a excess angle is @xmath20 , where @xmath21 is the dirac delta function in two dimensions .",
    "this is the charge of any singularity corresponding to an irregular vertex surrounded by three cells . along with the boundary alignment conditions on @xmath0 , the problem of finding an appropriate manifold",
    "is thus reduced to an _ inverse poisson _ problem , of finding a charge distribution adhering to these conditions .",
    "the reduction gives _ exact , global _ relations that the function @xmath0 must obey .",
    "the inverse poisson problem on planar domains is of interest in many fields of science and engineering ( see references in section [ sec : case_c ] ) ; the relevance of existing techniques to the present application remains to be examined .",
    "another possible application is to the problem of creating a surface mesh aligned with predefined directions , which has recently attracted much attention @xcite,@xcite,@xcite,@xcite .",
    "the algorithm described in @xcite creates conformal parametrizations and meshes approximately aligned with predefined directions . in that work ,",
    "the local size and the local direction are treated as independent variables . in order to reduce the number of singularities , a preprocessing step that modifies the cell size demand ( the curl correction  process ) can be applied .",
    "in contrast , the theory developed in the present work uses conformality to a - priory link the cell - size and cell - direction fields , leaving just one field to work with , either the cell - size or the cell - direction .",
    "the applications of this theory to surface parameterization and surface quadrangulation problems are an interesting subject for future work .",
    "conformal parametrization of manifolds with conical singularities have been used in surface parametrization problems . for reviews and related work ,",
    "see @xcite-@xcite .",
    "mesh generation with boundaries and surface parametrization are different problems , because of the boundary alignment requirement in mesh generation .",
    "for example , the parametrization problem for planar domains is trivial : the coordinates of the plane form a good parametrization , but do not solve the mesh generation problem .",
    "the rest of the article is organized as follows : in section [ sec : parallel_transport_and_geodesics ] some elements of differential geometry are shortly reviewed . in section [ sec : cross_field ] the cross - field and @xmath0-manifold are defined .",
    "section [ sec : relation_to_mesh_generation ] discusses the relation of the definitions in previous sections to mesh generation .",
    "cone points are analyzed in section [ sec : cone_points ] .",
    "the necessary and sufficient conditions for cross - field existence are developed in section [ sec : boundary_alignment_conditions ] .",
    "the set of conditions derived in sections [ sec : cone_points],[sec : boundary_alignment_conditions ] forms the core result of the work . in section [ sec : discussion ]",
    "the theory is discussed through four case studies .",
    "case studies a , b are used to discuss the meaning of the conditions derived before . in case study c the possible structure of a mesh generation algorithm is discussed .",
    "an example quadrilateral mesh problem , though admittedly simple and artificial , demonstrates  how , given an input , a manifold with cone points is constructed , adhering to the imposed conditions . this manifold allows the construction of meshes with irregular vertices ; at any given point in the domain that is not an irregular vertex , at the limit of increasingly finer meshes , the cells shapes tend to a square .",
    "case study d gives an example of a curved surface meshing problem , and how it is solved .",
    "in this section basic facts from differential geometry , required in subsequent sections , are shortly reviewed .",
    "more complete accounts can be found in any textbook on differential geometry , such as @xcite,@xcite .    for a surface @xmath22",
    "embedded in three - dimensional space , distances and angles on the surface can be defined by the embedding . in some coordinate system ,",
    "denote by @xmath10 the metric given by the embedding .",
    "for example , on the plane with cartesian coordinates , @xmath6 , the kronecker delta .",
    "another metric , @xmath9 , is said to be _ conformally related _ to @xmath23 , if there exists a real function @xmath0 on the surface such that @xmath24    given two vectors @xmath25 defined at some point on a surface or riemannian manifold , the angle between them is given by @xmath26 where summation over repeated indices ( the einstein convension ) is assumed .",
    "the angle @xmath27 as measured with the metric @xmath9 is @xmath28 substituting @xmath13 in eq .",
    "( [ eq : cos_theta_tilde ] ) , and comparing with eq .",
    "( [ eq : cos_theta ] ) it is found that @xmath29 ,  so the measurement of angles using the two conformally related metrics agrees .",
    "given a vector field on the plane ( with the euclidean metric ) the question of whether two vectors at two different points are parallel has a definite answer .",
    "this is not the case on curved surfaces , and more generally , for riemannian manifolds .",
    "there , the definition of parallel vectors at different locations generally depends on the path chosen between the points . for a curve @xmath30 connecting points @xmath31 and @xmath32 , the parallel transport of a vector from @xmath31 to @xmath32 along @xmath30",
    "can be defined .",
    "if @xmath33 is such a vector at @xmath31 we denote its parallel translate to @xmath32 along @xmath30 by @xmath34 , see fig .",
    "[ parallel_transport_basic ] .",
    "[ ptb ]    the geodesic curvature @xmath35 of a curve is the amount by which a curve turns . on the plane ( with the euclidean metric ) turning",
    "is measured by the change of the angle of the tangent vector to the curve . on a surface",
    "( and , more generally , on a riemannian manifold ) the angle is defined relative to a vector that is parallel translated along the very same curve . for a curve @xmath30 ,",
    "denote the tangent vector at @xmath36 by @xmath37 .",
    "define @xmath38 .",
    "then @xmath39 where @xmath40 is the length parameterization of @xmath30 , see fig .",
    "[ parallel_transport ] .",
    "[ ptb ]    the parallel transport depends on the metric , so a curve can have different geodesic curvatures under different metrics .",
    "let @xmath41 be the geodesic curvatures of a curve @xmath30 at some point @xmath36 , with the metrics @xmath42 respectively , related as in eq .",
    "( [ eq : conformal_relation ] ) .",
    "( henceforth , all quantities relating to the metric @xmath9 will be marked with a tilde . )",
    "then @xmath43 are related by @xmath44 where @xmath45 is the derivative of @xmath0 along the normal vector @xmath46 , which is defined such that @xmath47 form a right hand system .",
    "( [ kappa_g_relation ] ) is derived in appendix [ app : k_g_different_metrics ] .",
    "a geodesic is a generalization of a straight line .",
    "it is the curve whose geodesic curvature vanishes .",
    "the equation for a geodesic of the metric @xmath9 is found by substituting @xmath48  in eq .",
    "( [ kappa_g_relation ] ) : @xmath49    two integral theorems are used throughout the paper .",
    "the first is the gauss - bonnet theorem , which relates the change in a vector undergoing parallel transport along a closed loop , to the total gaussian curvature inside the loop .",
    "let @xmath50 be a closed curve , @xmath51 @xmath52 , enclosing a region @xmath53 .",
    "the junction angles , @xmath54 , measure the change in direction of the tangent at junction points . as a convention",
    "we assume that @xmath30 is traversed in a counter - clockwise direction .",
    "let @xmath55 be a vector at @xmath56 .",
    "then the angle @xmath57 is equal to @xmath58 where @xmath15 is the gaussian curvature .",
    "the second integral theorem is green s theorem , also known as the divergence theorem , or gauss theorem .",
    "suppose @xmath50 is a curve enclosing a region @xmath53 , transversed in a counter - clockwise manner , and @xmath0 a function defined on the surface .",
    "then @xmath59 the ( unconventional ) minus sign appears because the normal direction to @xmath30 was defined such that @xmath60 form a right hand system , so @xmath46 points _",
    "inwards_. for a surface the laplacian operator @xmath61 denotes the laplace - beltrami operator @xcite .    if two metrics are conformally related as in eq .",
    "( [ eq : conformal_relation ] ) , and the manifold with the metric @xmath9 is flat , i.e. @xmath62 a differential equation for @xmath0 can be derived .",
    "this can be done using the expression for the curvature @xmath12 in terms of @xmath9 .",
    "it is derived here in a different way , using the integral theorems quoted above , as this technique is used again in subsequent sections .",
    "suppose that a region @xmath53 equipped with the metric @xmath9 is flat , i.e. eq . ( [ eq : flatness_assumption ] ) holds in @xmath53 . then according to the gauss - bonnet theorem , eq .",
    "( [ gauss_bonnet ] ) , @xmath63 the length element for the two metrics discussed are related by @xmath64 substitute eq .",
    "( [ kappa_g_relation]),([ds_vs_ds_tilde ] ) in eq .",
    "( [ derive1:lap_phi_eq_k ] ) to get @xmath65 here green s theorem , eq .",
    "( [ greens_theorem ] ) , was used .",
    "subtracting eq .",
    "( [ derive1:lap_phi_eq_k ] ) from ( [ derive2:lap_phi_eq_k ] ) , @xmath66 where gauss - bonnet was used . since",
    "this result is true for an arbitrary flat region @xmath53 , the integrand @xmath67 must vanish , i.e. , for any point in @xmath22 where eq .",
    "( [ eq : flatness_assumption ] ) holds : @xmath68 eq .",
    "( [ lap_phi_eq_k ] ) is a differential equation for @xmath0 .",
    "it is a well - known result in conformal geometry , see e.g. @xcite,@xcite .",
    "the input to the mesh generation problem is assumed to be a surface @xmath22 embedded in three dimensional euclidean space , such that :    ( i ) : :    its boundary @xmath69 is a union of a finite number of    connected components @xmath70 . (",
    "ii ) : :    every component @xmath71 is a piecewise    @xmath72 closed curve .    the points where a boundary component @xmath71 is not differentiable will be called",
    "_ junction points_. the set of all junction points will be denoted by @xmath73 .",
    "the edges of the final mesh are to be laid along geodesic curves of a manifold that will be defined below , the @xmath0__-manifold__. to create a high quality mesh , these curves should cross each other , and reach the boundary , at certain angles . in the case of a quadrilateral mesh ,",
    "a cell with right inner angles is preferred for many applications . in the case of a triangular mesh ,",
    "the preferred inner angle is @xmath74 radians .",
    "it is therefore natural to define the direction of edges at a point to within an addition of @xmath11 radians in the quadrilateral case , and @xmath74 radians in the triangular case .",
    "this difference between the two cases leads to slightly different results ; for clarity of presentation , the quadrilateral case is presented first , and the results for the triangular case are defered to appendix [ triangular_mesh ] .",
    "the directions of edges at a point will be called a _",
    "cross_. the field of edge directions will be called a _ cross - field_.    [ cross]first , define an equivalence @xmath75 of vectors in @xmath76 : for 2 vectors @xmath77 , @xmath78 if and only if @xmath79,@xmath80 are parallel or perpendicular .",
    "cross _ is an element of @xmath81 .",
    "thus , a given cross is a set of vectors , every pair of which are either perpendicular or parallel .",
    "if two vectors , defined at some point , undergo parallel transport along the same curve , the angle between two vectors is preserved : the angle before the parallel transport is equal to the angle after the parallel transport @xcite . therefore , the cross equivalence class structure is preserved , and the parallel transport of crosses is well - defined .",
    "let @xmath82 be a finite set of points in @xmath83 .",
    "denote the metric on @xmath22 by @xmath10 .",
    "supoose a metric @xmath9 is defined on @xmath84 .",
    "the following definition of a cross - field assures that the flow lines of the cross - field are geodesics , and that the crosses on the boundary are aligned with boundary .",
    "[ cross - field][cross_field_definition ] a _ cross - field _ on a given manifold with metric @xmath9 is a mapping @xmath85 such that :    ( i ) : :    for points @xmath86 ,    the parallel transport under the metric @xmath9    of @xmath87 to @xmath32 along a curve    @xmath30 is independent of @xmath30 , and is    equal to @xmath88 :    @xmath89 .",
    "( ii ) : :    for @xmath90    @xmath91 , the    tangent belongs to the cross there :    @xmath92 @xmath93 .",
    "[ ptb ]    the flow - lines curves of a cross - field are geodesics of the metric @xmath94 .",
    "that is , a geodesic aligned with the cross - field at one point ( i.e. , whose tangent belongs to the cross at that point ) , is aligned with the cross - field everywhere else on the curve .",
    "this is because both the cross - field and the tangent to a geodesic are parallel - translated along the geodesic , see definition [ cross_field_definition],(i ) , and the discussion preceding eq .",
    "( [ phi_manifold_geodesic ] ) .",
    "geodesic curves aligned with the cross - field will be called _ cross - field geodesics_. cross - field geodesics and their relation to the cross - field are illustrated in fig .",
    "[ c - frame_illustration ] .    as before ,",
    "let @xmath82 be a finite set of points in @xmath95 .",
    "we now define the @xmath0__-manifold__.    [ @xmath0-manifold][def : phi_manifold]a @xmath0__-manifold _ _ is a riemannian manifold defined on @xmath84 , with metric @xmath9 such that :    ( i ) : :    @xmath9 is conformally related to    @xmath10 , i.e.    @xmath13 where @xmath0    is a real function on @xmath84 . (",
    "ii ) : :    the @xmath0-manifold is locally flat , i.e. its gaussian    curvature tensor @xmath96 for all points in    @xmath84 .",
    "( iii ) : :    for every boundary point @xmath97 ,    @xmath98 , the limits    @xmath99 and    @xmath100 exist and are continuous    along @xmath71 at @xmath31 .",
    "( iv ) : :    a cross - field with the metric @xmath9 exists .",
    "the points in @xmath82 will be called _",
    "cone points_. this name is justified in section [ sec : cone_points ] , see also section [ sec : overview ] . for",
    "now , the points in @xmath82 are just points where @xmath0 is undefined .    in the following sections ,",
    "the requirement that a @xmath0-manifold exists is translated into conditions on the function @xmath0 .",
    "the cross - field formulates the demand that mesh cells have certain inner angles . in order to have square - like shapes",
    ", the cells should further have edges of similar lengths .",
    "this is where the conformal metric property of the @xmath0-manifold comes into play .    integrating over eq .",
    "( [ ds_vs_ds_tilde ] ) , the length of a curve @xmath30 on a @xmath0-manifold is given by @xmath101    the area of a region of a manifold is given by @xcite,@xcite @xmath102 where @xmath103 @xmath104 .",
    "the tilde denotes , as before , a quantity with respect to @xmath0-manifold metric @xmath9 .",
    "the following claim is a consequence of the isometry of a flat manifold to the euclidean plane @xcite .",
    "it is the manifold version  of the properties of a rectangle .",
    "[ claim : rectangle]let @xmath105 be 4 geodesic segments in a flat region of a manifold , organized as in fig .",
    "[ rectangle ] .",
    "suppose that the inner angles at the vertices @xmath106 are right angles , and @xmath107 is the manifold - length of the i - th side of the rectangle .",
    "then the inner angle at @xmath22 , @xmath108 , is a right angle , and @xmath109 .",
    "the area of the rectangle  is * *  * * @xmath110 .",
    "[ ptb ]    on an euclidean plane , the properties of a rectangle allow one to lay a grid on a region of the plane . a grid can be regarded as two families of mutually perpendicular straight lines , with equal spacing between lines of each family . the same can be done for a @xmath0-manifold using the rectangle  properties stated in claim [ claim : rectangle ] , see fig .",
    "[ lay_grid ] .",
    "the grid divides the space into square - like regions , each bounded by four geodesic segments of manifold length @xmath111 , that will be called _ manifold - edges_. the regions enclosed by the manifold - edges will be called _ manifold - cells_.    [ ptb ]    @xmath111 is a single , fixed number for the mesh .",
    "the overall size on the surface or plane of the manifold - cells can be controlled by adding a constant to @xmath0 , so the freedom in choosing @xmath111 is redundant , and we set @xmath112 .",
    "according to claim [ claim : rectangle ] such a cell has unit @xmath113-manifold area . according to eq .",
    "( [ eq : curve_manifold length ] ) , for small enough manifold cells ( large enough @xmath0 ) , a manifold edge of length @xmath112 has length @xmath114 , and @xmath115 is interpreted as the _ local edge length _ , or _",
    "local cell size_.    a geometrical interpretation of the relation@xmath116 , eq . ( [ phi_manifold_geodesic ] ) , can now be given .",
    "for a mesh with approximately square cells , the curving  of manifold - edges is related to the changes in cell size _ in the perpendicular direction _ , see fig .",
    "[ fig : lay_grid_interpretation ] .",
    "this is quantified in eq .",
    "( [ phi_manifold_geodesic ] ) : @xmath35 is the curvature of the lines defining the edges , and @xmath117 is the change in @xmath0 , which is related to local cell size by @xmath8 .",
    "the existence of a cross - field restricts the possible behavior of @xmath0 in the vicinity of cone points .",
    "let @xmath118 be a cone point , and @xmath119 a point that is not a cone point .",
    "let @xmath30 be a simple closed curve starting from @xmath31 that encloses @xmath1 , and only @xmath1 of @xmath82 , see fig .",
    "[ loop_around_charge ] .",
    "the junction angles of @xmath30 are denoted by @xmath120 . according to cross - field definition ,",
    "the cross @xmath121 is parallel translated to @xmath87 along @xmath30 , that is , a vector @xmath122 is parallel translated along @xmath30 , to @xmath123 . by the defintion of a cross , @xmath124 are either parallel or perpendicular , and",
    "the angle @xmath125 is @xmath126 , @xmath127 . using eq .",
    "( [ kappa_g_relation]),([gauss_bonnet ] ) : @xmath128 where @xmath129 is the region enclosed by @xmath30 .",
    "[ ptb ]    on a @xmath0-manifold a manifold - cell has unit area , so in order to have a finite number of cells , the the area of the @xmath0-manifold must be finite",
    ". this will further restrict the type of singularity allowed at a point @xmath1 , as is now shown .    for a cone point @xmath1 on the surface",
    "let @xmath130 be a neighborhood of @xmath1 in which there exist isothermal coordinates @xmath131 .",
    "in such coordinates , which can always be found locally , the metric takes the form : @xmath132 , where @xmath133 is a real function of @xmath134 .",
    "note that on the plane , the standard cartesian coordinates satisfy @xmath6 , and hence are isothermal . in isothermal",
    "coordinates the laplace - beltrami operator can be written as into the definition of the laplace - beltrami operator : @xmath135 , see e.g. @xcite . ]",
    "@xmath136 eq .",
    "[ lap_in_isothermal ] can be seen as a generalization of the usual planar laplacian , given by @xmath137 .",
    "let @xmath138 be a disk of radius @xmath53  in @xmath131 , i.e. the region for which @xmath139",
    ". in isothermal coordinates eq .",
    "( [ lap_phi_eq_k ] ) reads @xmath140 in the _ punctured _ disk @xmath141 . in polar",
    "isothermal coordinates @xmath142 , ( that is , the polar coordinates corresponding to @xmath131 ) , the general form of this solution can be written as ( see e.g. @xcite ) : @xmath143 where @xmath144 is a solution to the poisson equation @xmath145 in @xmath138 ( _ including _",
    "@xmath1 ) , and @xmath146 are all real numbers .",
    "let @xmath30 be a curve tracing the circle @xmath147 , in the counter - clockwise direction . for @xmath0 given by eq .",
    "( [ jackson_solution ] ) , the flux of @xmath148 through @xmath30 is @xmath149 where green s theorem , eq .",
    "( [ greens_theorem ] ) was used to convert the first term to a surface integral . in the limit",
    "@xmath150 eq .",
    "( [ eq : flux_from_cone_poine ] ) becomes : @xmath151 , and eq .",
    "( [ charge_possible_values ] ) with @xmath152 becomes : @xmath153 for some @xmath154 .",
    "comparing the two limiting values for @xmath155 we find @xmath156 for some @xmath157 .",
    "the quantity @xmath158 will be called the _ charge _ of the cone - point .",
    "( [ eq : charge_is_quantized ] ) states that the charges must be multiples of @xmath11 .    in order to have a finite number of unit - area manifold cells , the manifold - area of a neighbourhood of @xmath1",
    "must be finite .",
    "the manifold area of the disc @xmath138 of radius @xmath53 around @xmath1 is obtained by substituting eq .",
    "( [ jackson_solution ] ) into eq .",
    "( [ manifold_area ] ) : @xmath159 since a solution of @xmath160 is bounded in a compact region,@xmath161 does not effect the convergence of the integral , nor does @xmath162 , which is bounded away from zero . to converge , it is required that @xmath163 for every @xmath164 , and that @xmath165 .",
    "this restricts @xmath0 to the form @xmath166 with @xmath165 .",
    "this is a solution of the poisson equation for one point - source @xmath167 in a neighborhood of @xmath168 . for many cone points eq .",
    "( [ one_defect_solution ] ) becomes :    * condition 1 : *    @xmath0 _ _  obeys the equation _ _ @xmath169 _ the poisson equation with point sources ( delta functions ) _ @xmath170 _ _ , with _ _ @xmath171 _ _ , _ _ @xmath172__. _ _    [ ptb ]    for a planar domain , condition 1 can be rewritten as    * condition 1 ( planar domain ) : *    _ for _ @xmath173 _ _ , _ _ @xmath174 _ _  can be written as _ _",
    "@xmath175 _ with _",
    "@xmath176 _ _ , and _ _ @xmath177 _ _  on _ _ @xmath22__. _ _    fig .",
    "[ defects_3_5_inf ] shows selected cross - field geodesics for a planar domain around a singularity ( with @xmath178 ) , spaced at manifold - distances of @xmath112  from each other , for different singularity strengths . in practice",
    ", good candidates for meshes will only have singularities of charge @xmath179 , due to the inner - angles of cells incident on the singularity , see also remark [ star_geodesics ] in section [ sec : case_c ] below .    to summarize this section",
    ", it has been shown that the existence of a grid of geodesics that follow a cross - field and create a finite number of cells , restrict the form that the function @xmath0 can take .",
    "this is formulated in condition 1 , stating that @xmath0 must obey the poisson equation , with delta function charges corresponding to cone points .",
    "this section examines the conditions for boundary alignment of a cross - field , see definition [ cross_field_definition],(ii ) .",
    "three conditions will shown to be necessary .",
    "sufficiency of the conditions is discussed in section [ sec : sufficient_conditions ] .",
    "we start by developing an equation that will be used in the derivation of the conditions below .",
    "let @xmath180 be two points on two boundary curves @xmath181 , respectively .",
    "note that @xmath181 may be the same boundary curve : @xmath182 .",
    "let @xmath30 be some curve from @xmath183 to @xmath184 , see fig .",
    "[ condition4_2_boundaries_surface ] . for @xmath185",
    "denote by @xmath186 . by definition of a cross - field",
    ", the cross in @xmath183 must be parallel - translated along @xmath30 to the cross in @xmath184 .",
    "the cross in @xmath183 contains @xmath187 , and the cross in @xmath184 contains @xmath188 so @xmath189    [ ptb ]    where @xmath190 is defined as @xmath191 the last equality is due to the preservation of angle in parallel transport , together with eq .",
    "( [ kappa_is_dtheta_ds ] ) .",
    "( [ kappa_g_relation ] ) and ( [ ds_vs_ds_tilde ] ) can now be used with eq .",
    "( [ eq : cond_4_proof_1 ] ) @xmath192 substituting this into eq .",
    "( [ eq : cond_4_proof_0 ] ) we find the relation @xmath193 eq .",
    "( [ eq : general_boundary_cond_equation ] ) is used below to develop the next three conditions .",
    "[ ptb ]    let @xmath194 be a segment of a boundary curve @xmath71 , between points @xmath195 that are not junction points : @xmath196 , and suppose @xmath194 does not contain junction points . choose some smooth curve @xmath30 from @xmath32 to @xmath31 ,",
    "whose tangents at @xmath197 coincide with the tangents to @xmath194 , see fig .",
    "[ kappa_eq_d_phi_ds ] , i.e. @xmath198 , and such that the region enclosed by @xmath199 does not include any cone points . according to eq .",
    "( [ eq : general_boundary_cond_equation ] ) , @xmath200 according to gauss - bonnet , eq . ( [ gauss_bonnet ] ) , @xmath201 where @xmath129 is the area enclosed by @xmath202 .",
    "green s theorem gives @xmath203 substituting eq .",
    "( [ cond_2_proof2]),([cond2_proof3 ] ) and recalling that @xmath14  in @xmath84 ( see eq .",
    "( [ lap_phi_eq_k ] ) ) , eq .",
    "( [ cond_2_proof1_1 ] ) now reads @xmath204    when @xmath205 , the integrals both tend to zero , and the equality is possible only if @xmath206",
    ". then @xmath207 and with @xmath205 it follows that    * condition 2 : *    _ for a point _ @xmath208 _ with boundary curvature _",
    "@xmath35 _ _ , _ _",
    "@xmath0 _ must satisfy _",
    "the equation in condition 2 is the same as eq .",
    "( [ phi_manifold_geodesic ] ) .",
    "this is not incidental : condition 2 causes cross - field geodesics , that are close and parallel to the boundary , to follow the shape of the boundary , as shown in fig .",
    "[ boundary_aligment ] .",
    "for a point @xmath210 , that is , a junction or cone point of the boundary , let @xmath211 be two points on both sides of the junction point @xmath212 , and @xmath194 the boundary segment from @xmath32 to @xmath31 , see fig .",
    "[ condition3_boundary_singularity ] .",
    "let @xmath30 be a curve from @xmath31 to @xmath32 .",
    "the gauss - bonnet theorem , eq .",
    "( [ gauss_bonnet ] ) , for the curve @xmath213 $ ] reads @xmath214 where @xmath215 is inner angle at @xmath212 , and @xmath216 are defined as in eq .",
    "( [ eq : general_boundary_cond_equation ] ) . eq .",
    "( [ eq : general_boundary_cond_equation ] ) reads    @xmath217    adding eq .",
    "( [ eq : cond_3_proof_1 ] ) and eq .",
    "( [ eq : cond_3_proof_2 ] ) and rearranging : @xmath218 when @xmath219 then @xmath220 , leading to :    [ ptb ]    * condition 3 : *    _ for a curve _ @xmath30 _ as described above : _ @xmath221 with @xmath222 .",
    "this requires @xmath117 to have a singularity at @xmath212 . on the plane , for example",
    ", @xmath0 has a singularity of type @xmath223  at distance @xmath224 from @xmath212 .",
    "the final condition to be imposed on @xmath113  is a relation between different boundary components , and accordingly , its formulation is not local .",
    "it is just a restatment of eq .",
    "( [ eq : general_boundary_cond_equation ] ) .",
    "* condition 4 : *    _ for two boundary components _",
    "@xmath225 _ _ , and a curve _ _ @xmath30 _ connecting _",
    "@xmath226 _ to _ @xmath227 _ it is necessary that _ @xmath228 _ for an integer _",
    "_ @xmath229 are defined as in eq .",
    "( [ eq : general_boundary_cond_equation ] ) .",
    "condition 4 states that the total flux through a curve connecting the two boundary components can only belong to a certain , discrete , set of values .",
    "[ ptb ]    condition 4 has can be put in a simpler form when the domain is planar .",
    "let @xmath230 be the angle between the @xmath36-axis and @xmath231 , see fig .",
    "[ condition4_2_boundaries_planar ] . then , because @xmath232 is equal to the change from @xmath183 to @xmath184 in the angle between the tangent to @xmath30 and the @xmath36-axis we have @xmath233 condition 4 for the planar case then reads    * condition 4 ( planar domain ) : *    _ for two boundary components _",
    "@xmath225 _ _ , and a curve _",
    "_ @xmath30 _ connecting _",
    "@xmath226 _ to _ @xmath227 _ it is necessary that _ @xmath234 _ for an integer _",
    "@xmath164__. _ _      in the previous sections conditions 1 - 4 were shown to be necessary for the existance of a @xmath0-manifold .",
    "this section considers the question : when are conditions 1 - 4 sufficient ?",
    "it turns out that the answer to this question depends on the genus of the surface . intuitively , the genus of a surface is the number of handles a surface has @xcite .",
    "for example a sphere or a disk are genus-0 surfaces , and a torus is a genus-1 surface .",
    "a surface of any genus can have any number of boundaries : for example , any planar domain , with an arbitrary number of boundaries , is a genus-0 surface .",
    "the following theorem states that for genus zero surfaces , conditions 1 - 4 are sufficient .",
    "the theorem also shows how to construct the cross - field given the function @xmath0 . for higher genus surfaces ,",
    "an additional condition is required , constraining the parallel transport along curves passing through  the handles of higher genus surfaces .",
    "a detailed disscusion is out of the scope of the present work , but a brief account is given in appendix [ appen : theorem_proof ] .",
    "[ theorem : sufficient ] suppose @xmath22 is a surface of genus-@xmath235 .",
    "let @xmath236 be some boundary point such that @xmath237 .",
    "assume @xmath0 satisfies conditions ( 1),(2),(3 ) , and satisfies condition ( 4 ) with curves @xmath238 between @xmath239 and points @xmath240 @xmath241 , for every @xmath242 .",
    "let @xmath243 be the ( unique ) cross such that @xmath244 .",
    "for every @xmath245 , let @xmath30 be some curve from @xmath239 to @xmath32 , and define @xmath88 to be the translate of @xmath243 along @xmath30 .",
    "then @xmath246 is independent of @xmath30 , and @xmath247 is a cross - field .",
    "the proof is given in appendix [ appen : theorem_proof ] .",
    "if the surface is closed , i.e. has no boundaries , the cross at some point @xmath239 on the surface must be fixed for the cross - field to be unique .",
    "according to theorem [ theorem : sufficient ] in section  [ sec : sufficient_conditions ] , if a function @xmath0 is found , satisfying conditions 1 - 4 , a @xmath0-manifold exists , and its cross - field can be calculated .",
    "in addition to conditions 1 - 4 , a meshing problem can include other requirements , such as cell size requirements on the boundaries , or inside the mesh .",
    "clearly , finding an appropriate @xmath0-manifold then depends on these conditions as well . in what follows the problem of finding a @xmath0-manifold under different requirements will be discussed .",
    "the next three sections focus on the planar case , and give concrete examples of the theory presented above .",
    "the fourth section gives an example of a curved surface meshing , that is solved analytically .",
    "after finding a valid @xmath0-manifold , the final stage of a mesh generation process involves finding a discrete partition into well - shaped manifold cells , see below .",
    "a comprehensive discussion of this step will not be given here , but some comments on this process will be made as part of the case studies .",
    "sections [ case_a],[sec : case_b],[sec : case_c ] deal with meshing of planar domains . on the plane",
    ", the geodesic curvature @xmath35 reduces to the curvature of a planar curve , which will be denoted by @xmath248 .",
    "we start with a simple planar case .",
    "suppose that the boundary has only one connectivity element ( loop ) @xmath249 .",
    "furthermore , suppose that all junction angles @xmath250 ( equal to @xmath251 , @xmath215 the inner angle ) are multiples of @xmath11 , and that the their sum is @xmath252 .",
    "in such a case , condition 4 is empty ( since there is only one boundary loop ) , and condition 3 can be satisfied with @xmath253 , and without any additional singularities at the junction points .",
    "condition 2 are neumann boundary conditions on @xmath0 .",
    "@xmath249 is a simple loop , and the sum of junction angles is @xmath18 , thus the total is flux of @xmath0 through the boundary is @xmath254 therefore given the boundary conditions a solution to the laplace equation ( that is , with no singularities ) exists , and is unique up to an additive constant @xcite .",
    "a simple example of such a case , that can be solved analytically , is a section of an annulus between two radial lines , see fig .",
    "[ polar_boundaries ] .",
    "the boundary conditions on the sides of the boundary , dictated by the shape of the boundary are given , according to condition 2 , by ( note that @xmath248 can be negative , see eq .",
    "( [ kappa_is_dtheta_ds ] ) ) : @xmath255    [ ptb ]    [ ptb ]    the solution to the laplace equation @xmath256 with boundary conditions given in eq .",
    "( [ eq : boundary conditions polar2 ] ) is @xmath257 here , @xmath224 is the distance from the center of the ring , and @xmath258 is a constant .",
    "note that no specification of the local cell size was given in the input , and , according to section [ sec : relation_to_mesh_generation ] , the resulting local cell - size function is part of the solution .",
    "it is given by @xmath259 , with @xmath260 .",
    "[ polar2 ] shows geodesics starting from the boundaries . to create the figure , as well as fig .",
    "( [ polar_recess_geodesics_and_flow ] ) , fig .",
    "( [ splash_flow_and_mesh ] ) and fig .",
    "( [ double_diamond_ignore_both ] ) , ( iii ) , the poisson equation was solved numerically on a triangular mesh inside the domain ( even though an analytical solution is known in the case shown in fig .",
    "( [ polar2 ] ) ) .",
    "the geodesics were calculated by solving the geodesic equation , eq .",
    "( [ phi_manifold_geodesic ] ) , with initial tangent perpendicular to the boundary .",
    "the  integration constant @xmath261 was chosen such that 10 manifold - edges will fit on the radial boundaries , i.e. that @xmath262 .",
    "this fixes the solution completely , and gives a non - integer manifold - length along the arcs .",
    "[ polar2],(i ) shows geodesics spaced at unit manifold - distances of each other . whereas the radial direction fits exactly 10 manifold - edges of equal length , the manifold - distance from the left - most geodesic to the boundary is less then 1 , resulting in manifold cells with high aspect ratio in the left - most row of cells . in fig .",
    "[ polar2 ] , ( ii ) , two different spacings are used , so as to allow equal spacing in both the radial and tangential directions , with an aspect ratio as close to one as possible .",
    "[ polar_recess_geodesics_and_flow ] shows an example with a more elaborate boundary adhering to the restrictions stated in the beginning of section [ case_a ] .",
    "again , the equally - spaced geodesics of fig .",
    "[ polar_recess_geodesics_and_flow],(ii ) do not form well - shaped ( or even valid ) cells  are not parallel to the boundary .",
    "this is due to the change in cell size .",
    "other geodesics , closer to the boundary , follow the shape of the boundary more closely . ] .",
    "a valid discretization can be created , e.g. by using geodesics emanating from the junction points to decompose the domain .",
    "note that in general , local edge directions are _ not _ aligned with the flow lines of @xmath263 , as can be seen e.g in fig .",
    "[ polar_recess_geodesics_and_flow ] .",
    "[ ptb ]    we now lift the restriction that all junction angles are multiples of @xmath11 .",
    "if the angle is not @xmath11 , condition 3 requires that @xmath0 have a radial - singularity at the junction point . denote the junction inner - angle by @xmath215 .",
    "suppose that @xmath0 contains a singularity caused by placing a charge at the junction point , i.e. @xmath264 .",
    "( if two or more boundary segments are incident on the same point , other functions may be required . )",
    "let @xmath265 be the curve formed by traversing an arc of the circle at a distance @xmath224 from the junction point in a counter - clockwise direction , as in fig .",
    "[ condition3_boundary_singularity ] . then according to condition 3 ( eq .",
    "( [ eq : condition3 ] ) ) @xmath266 for @xmath267 , so @xmath268 for @xmath269 .",
    "@xmath164 must be positive , since otherwise @xmath270 , causing the manifold - area to diverge at the singularity , by the same argument as presented in section [ sec : cone_points ] .",
    "apart from this restriction the number @xmath164 is not fixed , and affects the manifold - angle  at the singularity , i.e. the number of manifold - cells incident on the junction .",
    "[ ptbh ]    the example in fig .",
    "[ splash_flow_and_mesh ] shows a domain enclosed by one boundary element . in one junction",
    ", the inner angle is @xmath74 , which , according to eq .",
    "( [ eq : charge_for_angle_sigularity ] ) , requires a singularity of charge @xmath271 , for @xmath272 placed at the junction .",
    "the solution was calculated by decomposing @xmath0 into 2 contributions : @xmath273 .",
    "@xmath274 is the charge potential , @xmath275 .",
    "@xmath276 was computed by numerically solving the laplace equation on a triangular mesh with boundary conditions @xmath277 @xmath278 .",
    "the examples that were presented in this case study could have been obtained by a conformal mapping from a logical  domain .",
    "this is , of course , not true when cone points are present inside the domain to the logical  domain is not , in general , one - to - one . in manifold - theory terminology , even if the manifold is flat and simply connected , it is not necessarily covered by a single geodesic coordinate patch of the conformal metric . ] .",
    "note , however , that unlike many mapping techniques , even if such a logical  domain can be defined , its shape _ is not fixed in advance , and is part of the solution_. this is even more pronounced in problems involving cone points , see below .",
    "conformal mappings that are also boundary aligned are quite limited in the scope of problems they can mesh , and sometimes yield large differences in cell size ( as in the example shown in fig .",
    "[ polar_recess_geodesics_and_flow ] ) . that is why in mapping techniques the conformal restriction is lifted ,",
    "see e.g. ref .",
    "2 . in the present work ,",
    "the conformal condition ( in its manifold formulation ) is retained , and instead cone points are allowed into the manifold .",
    "the purpose of the example in this section is to demonstrate the meaning and relevance of condition 4 . unlike the other boundary alignment conditions , the formulation of condition 4 , stating the required relations between different boundary elements , is not local .",
    "we now show that the relative placement of different boundary elements can force the introduction of cone points in order to obtain a valid cross - field .    fig .",
    "[ double_diamond_ignore_both],(i ) shows a domain bounded by two boundary elements , an outer loop  @xmath249 , and an inner loop  @xmath279 .",
    "assume that there are no cell - size demands .",
    "we start by ignoring condition 4 , and trying to proceed as in case a , that is , searching for a solution without any cone points .",
    "the curves composing @xmath280 are straight lines , so the neumann boundary conditions read @xmath281 , and    [ ptb ]    the solution to the laplace equation is trivial : @xmath282 . condition 3 is also fulfilled with @xmath272 at all junctions . however",
    ", this solution does not give a valid cross - field . a cross - field geodesic running from @xmath249 to @xmath279",
    "will not reach @xmath279 at a right angle , see fig .",
    "[ double_diamond_ignore_both],(ii ) .",
    "thus , we can not do without condition ( 4 ) , and since the _ only _ solution without cone points with boundary conditions @xmath281 is @xmath282 , we learn that a solution without cone points does not exist .",
    "one possible solution with cone points is shown in fig . [ double_diamond_ignore_both],(iii ) .",
    "this solution , obtained using symmetry arguments , contains two cone points with opposite signs .",
    "selected cross - field geodesics are shown in fig .",
    "[ double_diamond_ignore_both],(iii ) .",
    "one of them runs from one boundary to the other .",
    "the rest are geodesics that are incident on the cone points .",
    "[ star_geodesics]in fig .",
    "[ double_diamond_ignore_both],(iii ) , cross - field geodesics reaching the cone points are shown .",
    "three cross - field geodesics reach the left cone point , which has a charge of @xmath283 , and five reach the right cone point , which has a charge of @xmath272 . moreover , it seems they reach the cone points at equally distributed angles .",
    "these observations are true in general .",
    "it can be proved that there are always exactly @xmath284 angles from which cross - field geodesics are incident upon a singularity , and these angles are equally distributed around the cone point .",
    "such geodesics will be called _ star - geodesics_. note that this affects the angles of the mesh - cells created : for small cells with a cone point on one vertex , that vertex s inner angle will be approximately @xmath285 .      in case",
    "studies a , b above no constraint on the size of boundary edges was given . yet the boundary edge - length is often specified in meshing problems .",
    "suppose we are given a function @xmath286 stating the required cell size ( that is , cell edge length ) at each point on the boundary .",
    "the local cell size is @xmath8 , thus @xmath287 , giving a dirichlet boundary condition on @xmath0 : @xmath288 condition 1 states that @xmath0 obeys a poisson equation with point charges playing the role of cone points .",
    "the problem of finding a suitable @xmath0 is reduced to finding a charge distribution ( number of charges , their locations and charge - strengths ) , such that @xmath0 will fulfill conditions 2,3,4 , together with eq .",
    "( [ eq : size_boundary_condition ] ) .",
    "this is an _",
    "inverse poisson ( ip ) _ problem . as opposed to a direct poisson problem , where the charge - distribution @xmath17 in @xmath289 is known , and one is asked to find @xmath0 , in an ip problem , _  certain information on _",
    "@xmath0 _ _  is given , and the charge distribution _",
    "_ @xmath290 _ _  is to be found__.    ip problems have important applications in various areas of science and engineering @xcite-@xcite . by its nature",
    ", the ip problem is ill - posed , and the solution may not be unique , and may be sensitive to small changes of the input , such as small changes in boundary conditions . in problems of this type any prior information on the charge distribution can play an important role in the solution of the problem .",
    "the problem of finding @xmath0 can be broken into the following steps :    ( i ) : :    given the boundaries @xmath291 of the domain , and the    cell - size requirement @xmath286 on the boundary , calculate the    neumann boundary conditions    @xmath292    ( condition ( 2 ) ) , and dirichlet boundary condition    @xmath293 @xmath294 ( eq .",
    "( [ eq :    size_boundary_condition ] ) ) . ( ii ) : :    impose boundary condition ( 3 ) , e.g. by placing charges at the junction    points ( see eq .",
    "( [ eq : charge_for_angle_sigularity ] ) ) .",
    "( iii ) : :    solve the ip problem : find the ( finite ) number , location and strength    of charges such that neumann and dirichlet boundary conditions    calculated in ( i ) , and condition 4 hold approximately .",
    "according to    condition 1 , the charges should be of strength    @xmath295 , with @xmath172 .",
    "the charges can    be placed :    +    1 .   inside @xmath22",
    "( forming the set @xmath82 ) .    2 .",
    "at junction points ( which amounts to changing @xmath296 in    eq .",
    "( [ eq : charge_for_angle_sigularity ] ) ) .    3 .   on the rest of the boundary ( forming the set    @xmath297 ) , where according to eq .",
    "( [ eq :    charge_for_angle_sigularity ] ) with @xmath298 , charges of strength @xmath299 can be placed .",
    "( iv ) : :    once the charges are placed , @xmath0 is found by solving    the standard ( direct ) poisson problem .",
    "( i ) : :    note that since this is an inverse problem , i.e. the charge    distribution is not fixed , both neumann and dirichlet boundary    conditions can be imposed together .",
    "( ii ) : :    though the limit on @xmath300 due to condition ( 1 ) is    @xmath172 , charges should be of charge    @xmath301 in order to have convex cells , and    preferably with @xmath302 .",
    "this is due to inner angles    of cells incident on the singularity , see remark [ star_geodesics ] in    section [ sec : case_b ] .",
    "[ ptbh ]    the steps outlined above are illustrated in fig . [ double_dislocation_mesh ] . for the purpose of this example",
    ", an input to the algorithm described above was created artificially by joining four geodesics of a @xmath0-field chosen in advance , at right angles to each other .",
    "the @xmath0-field chosen for creating the boundary is a sum of fields from four charges : @xmath303 , with @xmath304 the charges strengths and locations .",
    "two charges are located inside the boundary , and two outside , see fig .",
    "[ double_dislocation_mesh ] , ( i ) .",
    "this defines the shape of the boundary .",
    "the cell size requirement imposed on the boundary was @xmath305 , plotted in fig .",
    "[ edge_length_demand ] .",
    "the boundary shape and the cell size demand are the input of the problem .",
    "[ ptbh ]    using this input , the steps of the algorithm outlined above were followed . first ( step ( i ) ) , neumann and dirichlet boundary conditions were calculated from the input .",
    "step ( ii ) was fulfilled automatically without adding additional charges , because all junction have right inner angles . in step ( iii )",
    "an algorithm solving the ip problem @xcite was invoked .",
    "the algorithm exactly reconstructed the location and charge of the two charges inside the domain .",
    "( it is important to note that the ip algorithm of @xcite could be readily applied due to the artificial nature of the example : the input was constructed such that these two charges will reconstruct the input conditions exactly",
    ". this may not be the case in other cases , and may require other ip solution methods . )",
    "the @xmath0-field was then constructed by solving the _ direct _ , standard poisson problem , with _ given _ charges . in this example , since the location of the charges inside the domain where recovered exactly , the @xmath0 recovered was exactly @xmath306 .",
    "[ double_dislocation_mesh],(ii ) shows cross - field geodesics at equal manifold - distances @xmath112 . as was discussed in section [ sec : relation_to_mesh_generation ] , the function @xmath0 is defined up to an additive constant , that controls the overall cell - size .",
    "this constant was chosen such that the manifold - distance @xmath111  between two geodesics incident on the two charges be equal to one , see fig .",
    "[ double_dislocation_mesh],(ii ) . in fig .",
    "[ double_dislocation_mesh ] , ( iii ) cross - field geodesics spaced at approximately equal manifold - distances are shown , such that no high aspect - ratio manifold cells , as those in fig .",
    "[ double_dislocation_mesh],(ii ) , exist .",
    "note that the star - geodesics divide the domain into sub - domains without charges , that can be meshed more easily .",
    "this hints at possible ways of using the @xmath0-manifold for creating meshes .",
    "other mesh requirements can be formulated .",
    "examples include cell - size within the domain ( as in adaptive meshing ) , and cell direction .",
    "we comment briefly on these subjects . in the case of",
    "adaptive meshing , a requirement for cell size @xmath286 as a function of location inside the domain is given .",
    "this is translated to a requirement on @xmath0 by @xmath307 @xmath294 .",
    "this fixes @xmath0 completely , and therefore may not be fulfilled exactly along with other conditions , such as having @xmath256 ( in the planar case ) almost everywhere .",
    "however , weaker constraints may be given , such as specifying @xmath286 along curves within the domain .",
    "when specifing cell direction , the direction of the cross - field is given .",
    "this translated to a constraint similar to condition 4 , on the flux @xmath308 through some arbitrary curve .",
    "as is the case with adaptive meshing , a requirement for cell direction everywhere inside the domain is too restrictive , but more limited demands may be applied , such as an approximate alignment .",
    "for many surface meshing applications it is desired that the cells be aligned with certain prescribed directions , such as the principle curvature directions of the surface . as an example of a meshing problem of this type",
    ", the class of surfaces known as surfaces of revolution is analyzed analytically in this section , and it is shown how a cross - field aligned with the principle directions is constructed in this case .",
    "[ ptb ]    a surface of revolution is defined by a curve in the @xmath309 plane , that is revolved around the @xmath310-axis , see fig .",
    "[ revolution_surface ] . the direction of rotation will be called the @xmath311-direction . the line traced by the curve at a given @xmath311",
    "is known as a _",
    "meridian_. the circles at given @xmath309 values are known as _",
    "circles of revolution _ @xcite .",
    "the principle axis directions at a point are the directions of the circle of revolution and meridian passing through that point .",
    "a mesh aligned with these directions has @xmath312 cells around every circle of revolution at a given @xmath309 .",
    "the cell size at a given point should therefore be @xmath313 .",
    "but the cell size is equal to @xmath8 , so @xmath0 is expected to be @xmath314    we now show that this is indeed the case . by the alignment requirement",
    ", edges must be laid along circles of revolution and meridians .",
    "therefore , these must be geodesics of the manifold with metric @xmath9 .",
    "let @xmath315 be the tangent to the curve @xmath316 tracing a circle of revolution at @xmath309 , see fig .",
    "[ revolution_surface ] .",
    "then the geodesic curvature @xmath317 is equal to @xmath318 where the angle @xmath311 between @xmath30 and the meridian , @xmath194 , is equal to @xmath319 , so @xmath320 for a geodesic of @xmath9 , @xmath321 .",
    "the normal is directed along the meridian , so @xmath0 can is found by integrating along the meridian @xmath194 .",
    "noting that @xmath322 along @xmath194 , we have @xmath323 as expected in eq .",
    "( [ eq : revolution_expected_cell_size ] ) .",
    "the constant @xmath261 is determined once for the surface , e.g. by the number of cells on a given circle of revolution . by comparing with eq .",
    "( [ eq : revolution_expected_cell_size ] ) , @xmath261 is interpreted as @xmath324 .",
    "if the surface of revolution reaches the @xmath310-axis at some point @xmath1 , and is not parallel to the @xmath310-axis there , the manifold will have a cone points of charge @xmath325 at @xmath1 . to see this",
    ", we again use the fact that for a circle of revolution @xmath326 . integrating over a revolution circle surrounding @xmath1 : @xmath327 eq .",
    "( [ gauss_bonnet]),([eq : condition1 ] ) were used .",
    "thus , by @xmath328 we have @xmath329 .",
    "we note that in the vicinity of a singularity of charge @xmath325 the number of cells diverges , see section [ sec : cone_points ] .",
    "if this is undesirable , a mesh that is nt exactly aligned with the principal directions may be constructed , e.g. by replacing the single charge with a few cone points with smaller charges .",
    "in this work a continuum description of unstructured meshes was proposed.the structure aims at describing meshes that , away from irregular vertices , have well - shaped cells . in the limit of an increasingly finer mesh ,",
    "the cell s shape approaches the shape of a square ( in the case of a quadrilateral mesh ) or equilateral triangle ( for triangle meshes ) .",
    "accordingly , in the continum limit such meshes can be described by just two local properties : the local cell size , and the local directions of edges , formalized by the notion of a cross .",
    "the connection between cell size and cell direction is established by defining a riemmanian manifold , the @xmath0-manifold .",
    "the geodesics of the manifold trace the edges of the mesh , as is formalized via the definition of a cross - field .",
    "this analysis allows the focus to turn to the irregular vertices , represented in the continuum structure by cone points .",
    "the demand that the mesh conform to the boundary , and have a finite number of cells , produces conditions on the function @xmath0 .",
    "the resulting reduced problem is an inverse poisson problem , of finding a distribution of localized charges adhering to these conditions .",
    "the charges correspond to cone points .",
    "the main component needed to apply the theory to mesh generation of planar domains is a suitable inverse poisson algorithm .",
    "an algorithm for creating the final discrete mesh is also required .",
    "i am indebted to dov levine for introducing me to the theory of defects , from which this work began .",
    "helpful discussions with mirela ben - chen , michael entov , craig gotsman and shlomi hillel are greatly appreciated .",
    "in this appendix eq . ( [ kappa_is_dtheta_ds ] ) is derived .",
    "( [ kappa_is_dtheta_ds ] ) is a known relation in conformal geometry , however sign and direction convensions vary , so a derivation is given for completeness .",
    "let @xmath131 be a coordinate system , @xmath330 the metric components , and @xmath331 .",
    "for a curve @xmath30 parametrized by the length parameter @xmath332 , @xmath35 is given by @xcite @xmath333 where @xmath334 satisfies @xmath335 , @xmath336 .",
    "@xmath337 are the christoffel symbols , related to the metric by the formulas @xmath338 where @xmath339 is the @xmath340 entry of the inverse of the matrix @xmath341 .",
    "denote by @xmath10 the standard  metric induced by the embedding in three dimensional space , by @xmath342 the metric of the @xmath0-manifold , ( see definition [ def : phi_manifold ] ) , and the corresponding christoffel symbols by @xmath343 respectively . substituting @xmath13 ( see definition [ def : phi_manifold ] ) into eq .",
    "( [ eq : christofell_gij ] ) , the equation for @xmath344  reads @xmath345 where comas denote differentiation : @xmath346 .",
    "( [ eq : christ_relation ] ) can now be used to derive a relation between @xmath35 and @xmath347 , the geodesic curvatures in the two metrics , at a point @xmath1 on the curve @xmath30 .",
    "the derivation is simpler if a normal coordinate system is chosen , for which @xmath348 , and @xmath349 ( this can always be done , see @xcite ) .",
    "noting that @xmath350 , @xmath351 , the equation for @xmath347 reads @xmath352 the last equality holds because @xmath353 , as can be directly verified , because @xmath354 in arc length parametrization .",
    "the convension that @xmath355 form a right - hand system has been used .",
    "in this appendix the changes in the definitions and results in sections [ sec : cross_field],[sec : relation_to_mesh_generation ] , and [ sec : cone_points ] for the case of triangular meshes are outlined .",
    "[ triangle cross field]define an equivalence @xmath75 of vectors in @xmath76 : for 2 vectors @xmath77 , @xmath356 if and only if @xmath79,@xmath80 are form an angle of @xmath357 , with @xmath358 .",
    "cross _ is an element of @xmath359 .",
    "the cross - field and @xmath0-manifold are the same as for the quadrilateral case .",
    "the conditions for the existence of a triangle cross - field are : condition 1 for triangular meshes reads:*condition 1 .",
    "* @xmath0 _",
    "_  obeys the equation _ _ @xmath360 _ the poisson equation with point sources ( delta functions ) _ @xmath170 _ _ , with _",
    "_ @xmath171 _ _ , _ _ @xmath361__.__*condition 2 .",
    "* is the same as in the quadrilateral case.*condition 3 .",
    "( [ eq : condition3 ] ) for the triangular case reads @xmath362 * condition 4 .",
    "( [ eq : condition_4 ] ) of becomes @xmath363    fig .",
    "[ defects_tri_5_7 ] shows selected triangle cross - field geodesics around a singularity ( with @xmath364 ) , spaced at manifold - distances of @xmath112  from each other , for different singularity strengths .",
    "this appendix includes a proof of theorem [ theorem : sufficient ] , but first , the case of surfaces with genus higher than zero is briefly disscussed .",
    "basic notions of algebraic - topology are used , see e.g. @xcite .    as the proof of theorem [ theorem : sufficient ] presented below shows , for a cross - field to exist , the angle change in the parallel - transport of a vector along a loop based at @xmath239 must be a multiple of @xmath11 .",
    "let @xmath365 be the surface @xmath22 with holes are cut around the cone points of @xmath22 .",
    "let @xmath239 be a base point , as in theorem [ theorem : sufficient ] .",
    "let @xmath366 be a set of loops starting at @xmath239 , each encircling a single boundary of @xmath365 ( including the holes cut around the cone points ) .",
    "the angle change due to parallel transport around these loops is a multiple of  @xmath11 , see the proof of the theorem below . complete the set @xmath367 to a homotopy basis @xcite of @xmath365 , by adding a set of loops @xmath368 based at @xmath239 .",
    "the additional condition is that the angle change due to parallel transport around a loop of @xmath368 is a multiple of  @xmath11 .",
    "any loop based at @xmath239 is homotopic to a composition of loops from the homotopy basis .",
    "since the manifold @xmath365 is flat with the conformal metric , parallel transport is preserved by the homotopy , hence the change in the angle along any loop is a multiple of @xmath11 and the cross - field is well - defined .",
    "the second part of the proof below remains unchanged .",
    "we first prove that @xmath88 for some @xmath245 is independent of @xmath30 .",
    "let @xmath369 be two curves from @xmath239 to @xmath32 .",
    "denote @xmath370 .",
    "we need to show that the parallel transport of @xmath371 to @xmath32 gives vectors that belong to the same cross , i.e. @xmath372 for some @xmath157 . using eq .",
    "( [ kappa_is_dtheta_ds]),([kappa_g_relation ] ) , eq .",
    "( [ eq : two parallel transports of t in 1 - 4 proof ] ) becomes @xmath373 where @xmath374 $ ] .",
    "( note that eq .",
    "( [ eq : 1 need to show in theorem ] ) is equivalent to the requirement that the cross in @xmath375 be parallel - translated to itself along @xmath30 . )",
    "we now prove eq .",
    "( [ eq : 1 need to show in theorem ] ) . the region enclosed by @xmath30 can contain singularities and boundary curves .",
    "surround them by additional curves , as shown in fig .",
    "[ sufficient_theorem1 ] .",
    "denote the region between the @xmath30 curve and the @xmath376 and @xmath377 curves as @xmath129 ( here the assumption that @xmath22 has genus zero enters ) . since @xmath378 , eq .",
    "( [ lap_phi_eq_k ] ) , everywhere in @xmath129 , and @xmath379 are finite on the boundary of @xmath129 ( due to @xmath0-manifold definition , ( iii ) ) , green s theorem , eq .",
    "( [ greens_theorem ] ) , can be applied in this case , giving @xmath380 where @xmath381 are the number of points in @xmath82 , and @xmath382 inner - curves enclosed by @xmath30 .",
    "consider a single loop @xmath383 around an inner curve @xmath384 , @xmath385 .",
    "@xmath383 is composed of curves @xmath386 around points of @xmath387 on the boundary , and curves @xmath388 between junctions , i.e. @xmath389 $ ] , see fig .",
    "[ sufficient_theorem1 ]",
    ".      the total flux through @xmath383 is given by @xmath390 with @xmath391 .",
    "the second equality uses conditions 2,3 .",
    "the flux through @xmath392 is given by condition 1 : @xmath393 after substituting eq .",
    "( [ eq : total_flux_in_theorem ] ) , ( [ eq : total flux singularity ] ) , eq .",
    "( [ eq : total flux in theorem ] ) becomes @xmath394 and using gauss - bonnet theorem for a domain with more then one boundary component we find @xmath395 for some @xmath157 .",
    "this proves eq .",
    "( [ eq : 1 need to show in theorem ] ) .",
    "we now turn to prove the property ( ii ) of a cross - field , its boundary alignment .",
    "let @xmath212 be a boundary point , @xmath396 , @xmath385 .",
    "as was shown above , the cross at @xmath212 , @xmath397 , is well - defined .",
    "it is left to show that @xmath398 @xmath399 .",
    "denote @xmath400 .",
    "the assumptions of the theorem , together with condition 4 , assure that @xmath401 @xmath402 . let @xmath194 * * be the section of @xmath384 between @xmath403 and @xmath212 . define a curve @xmath30 from @xmath403 to @xmath212 composed of smooth curves @xmath404 around the points of @xmath387 in the image of @xmath194 , and @xmath405 curves between junctions , see fig .",
    "[ sufficient_theorem2 ] .",
    "the curves @xmath404 avoid the sigularities that the function @xmath0 might have at points in @xmath387 . let @xmath406 be the junction angle at the point of @xmath387 bypassed  by the curve @xmath404 ( zero for points that are not juction points ) . then",
    ", if @xmath404 follows @xmath384 closely , the total turn of @xmath404 is equal to @xmath407 : @xmath408 as can be formally verified by applying the gauss - bonet theorem to the area between @xmath386 and @xmath384 .",
    "note furthermore that @xmath409 , the inner angle at that point .",
    "the variation of @xmath410 along @xmath30 is @xmath411 with @xmath127 .",
    "conditions 2 and 3 were applied for the @xmath405 and @xmath412 curves , respectively .",
    "thus @xmath413 @xmath414 , which completes the proof of the boundary properties of the cross - field @xmath247 .                      m. s. floater , and k. hormann , surface parameterization : a tutorial and survey , in _",
    "advances on multiresolution in geometric modelling_. m. s. f. n. dodgson and m. sabin , eds .",
    "( springer - verlag , new york , 2004 ) .",
    "m. hmlinen , r. hari , r. j. ilmoniemi , j. knuutila and o. v. lounasmaa , magnetoencephalography - theory , instrumentation , and applications to noninvasive studies of the working human brain , _ reviews of modern physics _ * 65 * issue 2 ( 1993 ) 413 - 497 ."
  ],
  "abstract_text": [
    "<S> a continuum description of unstructured meshes in two dimensions , both for planar and curved surface domains , is proposed . </S>",
    "<S> the meshes described are those which , in the limit of an increasingly finer mesh ( smaller cells ) , and away from irregular vertices , have ideally - shaped cells ( squares or equilateral triangles ) , and can therefore be completely described by two local properties : local cell size and local edge directions . </S>",
    "<S> the connection between the two properties is derived by defining a riemannian manifold whose geodesics trace the edges of the mesh . </S>",
    "<S> a function @xmath0 , proportional to the logarithm of the cell size , is shown to obey the poisson equation , with localized charges corresponding to irregular vertices . </S>",
    "<S> the problem of finding a suitable manifold for a given domain is thus shown to _ </S>",
    "<S> exactly _ reduce to an inverse poisson problem on @xmath0 , of finding a distribution of localized charges adhering to the conditions derived for boundary alignment . </S>",
    "<S> possible applications to mesh generation are discussed .    unstructured mesh generation , differential geometry . </S>"
  ]
}