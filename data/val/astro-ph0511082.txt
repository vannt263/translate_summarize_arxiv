{
  "article_text": [
    "the dynamical evolution of planets in proto - planetary disks has become a topic of renewed interest in the last decade , boosted by the discovery of extra - solar planets , and in particular of hot jupiters .",
    "in fact , the observation of giant planets close to their parent stars argues for the existence of effective mechanisms of planetary migration , which can be found in the study of planet - disk interactions .",
    "several types of migration have been identified , depending on how the planet modifies the local density of the disk .",
    "type i migration occurs when the planet is not massive enough to significantly alter the local density of the disk ; the planet migrates inward with a speed proportional to its mass ( ward , 1997 ) .",
    "type ii migration corresponds to the case where the planet is so massive that it opens a clear gap in the disk ; the migration then depends on the viscous evolution of the disk ( lin and papaloizou , 1986a , b ) .",
    "type iii ( or runaway ) migration corresponds to planets with intermediate mass , which do not open a clear gap , but only form a dip around their orbits in the gas surface density profile ; under some conditions , their migration drift rate can grow exponentially , in a runaway process ( masset and papaloizou , 2003 ) .    the modification of the disk density is the result of the competition of torques exerted on the disk by the planet and by the disk itself .",
    "more precisely , the planet gives some angular momentum to the outer part of the disk , while it takes some from the inner part ( lin and papaloizou , 1979 ; goldreich and tremaine , 1980 ) .",
    "in doing so , it pushes the outer part of the disk outward and the inner part inward , and therefore tends to open a gap .",
    "however , the internal evolution of the disk , which tends to spread the gas into the void regions , opposes to the opening of the gap .",
    "however , there is a lack of an analytical prediction of the gap profiles .",
    "classically , the gap is considered to have a step function profile , with the edges located at the sites where the total gravity torque is equal to the total viscous torque .",
    "this is obviously an oversimplification .",
    "a more sophisticated approach has been recently presented by varnire _",
    "they provide an analytic expression that describes the gap profile , by equating the viscous and gravity torques on any elementary disk ring",
    ". we will provide more details on this approach in section  [ sec : gravity_and_viscous_torques ] .",
    "the problem is that , when the viscosity is small , the viscous torque is small as well , and thus it can not counterbalance the gravity torque . consequently , in a low viscosity disk , a non - migrating planet should open a very wide gap , unlike what is observed in numerical simulations ( see e.g. fig .",
    "[ fig : figure1poster ] ) : gaps do increase in width and depth as the viscosity decreases , but the dependence of the gap profile is less sensitive on viscosity in the numerical simulations than it is expected in theory .",
    "planetary orbits for the three largest viscosities , and @xmath0 orbits for @xmath1 and @xmath2 .",
    ", title=\"fig : \" ]   planetary orbits for the three largest viscosities , and @xmath0 orbits for @xmath1 and @xmath2 .",
    ", title=\"fig : \" ]    the reason for this difference is that not all of the gravity torque is locally deposited in the disk .",
    "it is transported away by density waves ( goldreich and nicholson , 1989 ; papaloizou and lin , 1984 ; rafikov , 2002 ; see appendix  c ) .",
    "these waves are observed in simulations .",
    "in this situation , the viscous torque has to counterbalance only a _ fraction _ of the gravity torque , which yields narrower gaps than expected from the simple viscous / gravitational torque balance .",
    "an evaluation of the fraction of the gravitational torque that is locally deposited at shock sites in the disk has been undertaken by rafikov ( 2002 ) .",
    "however he did not use his analysis to provide an analytic representation of the gap profile .",
    "moreover , his calculation required several assumptions ( the planet hill radius had to be much smaller than the local disk height , the disk surface density was assumed to be uniform , etc . ) , which are not satisfied in the general giant planet case .",
    "here we introduce a novel approach .",
    "we follow a fluid element along its trajectory which , in the steady state , is periodic in the planet corotating frame .",
    "a flux of angular momentum carried by the density waves corresponds to a pressure torque acting on the fluid element , whose average over a synodic period is non - zero . in this work ,",
    "we evaluate this averaged pressure torque , together with the gravity and viscous torques . the fact that the fluid element path is closed implies that these time averaged torques balance .    in section  [ sec : pressure_torque ]",
    "we introduce the pressure torque , and we use numerical simulations to check that the gap structure is set by the equilibrium between the gravity torque and the sum of the viscous and the pressure torques . in section  [ sec : semi - analytic_results ] we construct a semi - analytic algorithm and we get an expression to compute that gap profile .",
    "we compare our results with the profiles obtained in numerical simulation , and we discuss the merits and limitations of our method . in section",
    "[ sec : gap_profil_visc_ar ] we use our algorithm to explore the dependence of the gap structure on disk viscosity and aspect ratio .",
    "we recover the trends observed in numerical simulations , namely the limited gap width in low viscosity disks and the filling of the gap with increasing viscosity and/or aspect ratio . finally in section  [ sec : new_criterion ] , we provide a gap opening criterion that simultaneously involves the viscosity , the scale height and the planet mass .",
    "in this section we revisit the calculation of the gravity and viscous torques mentioned in the introduction . we show that considering them alone , as usually done , is not sufficient to achieve a quantitatively correct description of the gap profiles .",
    "the disk is represented in cylindrical coordinates @xmath3 , centered on the star , where the plane @xmath4 corresponds to the mid - plane of the disk .",
    "the disk viscosity @xmath5 and aspect ratio @xmath6 where @xmath7 denotes the thickness of the disk are assumed to be invariant in time and space .",
    "the equations of fluid dynamics are integrated with respect to the @xmath8-coordinate , so that @xmath8 disappears from the equations and only two dimensions are effectively used .",
    "this procedure introduces the concept of surface density @xmath9 , which is defined as @xmath10 , where @xmath11 is the volume density in the disk .    in the theoretical analysis",
    "( but not in the numerical calculations ) the disk is assumed to be axisymmetric , so that @xmath9 only depends on @xmath12 . the angular velocity @xmath13 is assumed to be keplerian : @xmath14 . the planet is assumed on a circular orbit around the star .",
    "the radius of its orbit is denoted @xmath15 .",
    "the mass of the planet is denoted @xmath16 and its ratio with the mass of the central star @xmath17 is @xmath18 .",
    "normalized units are introduced , so that @xmath19 and the gravitational constant @xmath20 is also assumed to be unity . in the limit @xmath21",
    ", this sets the angular orbital velocity of the planet @xmath22 and its period equal to @xmath23 .",
    "usually , one considers the part of the disk extending from a given radius @xmath24 to infinity .",
    "the study of the part of the disk extending from 0 to @xmath25 is done in an analogous way .",
    "two torques are evaluated .",
    "the first one is due to the disk viscosity and can be easily derived from the stress tensor in a keplerian disk with circular orbits .",
    "the torque exerted on the considered part of the disk ( @xmath26 ) by the complementary part is written ( see for instance lin and papaloizou , 1993 ) : @xmath27 notice that more refined expression for perturbed disks with eccentric orbits have been proposed in the literature ( see for instance borderies _ et al .",
    "_ 1982 ) , but they have not been used in the works that we review in this section .",
    "the second torque comes from the gravity of the planet .",
    "it can be computed following two different approaches . in the first one ( goldreich and tremaine , 1980 ; ward , 1986 ) , it is decomposed into the sum of the individual torques exerted at each lindblad resonance . in the second approach ( lin and papaloizou , 1979 ; goldreich and tremaine , 1980 ) it is obtained by computing the angular momentum change for fluid elements at conjunction with the planet , using an impulse approximation .",
    "the two approaches are known to give equivalent results . in the following ,",
    "we use the expression from the impulse approximation : @xmath28 where @xmath29 .",
    "the above expression gives the torque exerted by the planet on a disk extended from @xmath30 to infinity .",
    "it is valid only for @xmath31 , where @xmath32 is the maximum of @xmath7 ( the local thickness of the disk ) and the hill radius of the planet @xmath33 ( goldreich and tremaine , 1980 ; ward , 1997 ) .",
    "the value of the numerical coefficient @xmath34 depends on the approach followed for the calculation of the torque . in the most recent and refined calculation ,",
    "lin and papaloizou ( 1993 ) found @xmath35 ^ 2 \\approx 0.836 $ ] ( where @xmath36 and @xmath37 are modified bessel functions ) .",
    "classically , the gap is modeled as a step function profile in the disk surface density , with edges placed at a distance @xmath38 from the planet orbit , with @xmath38 given by the solution of the equation @xmath39 , and @xmath40 and @xmath41 given in and .",
    "the maximal gravity torque is : @xmath42 thus , a gap can be opened only if : @xmath43 otherwise @xmath41 is larger than @xmath40 and the gas overruns the planet .",
    "condition is equivalent to that given in bryden _",
    "( 1999 ) , expressed as a constraint on the mass of the planet relative to the viscosity of the disk .",
    "[ [ differential - torques . ] ] differential torques .",
    "+ + + + + + + + + + + + + + + + + + + + +    varnire _ et al . _",
    "( 2004 ) proposed a more refined approach to model the surface density profile in the gap .",
    "their approach is based on a simple consideration : in equilibrium , when a steady state is reached , the gravity torque and the viscous torque must be equal on every elementary ring of the disk .",
    "the torques acting on elementary rings can be computed by differentiation relative to @xmath44 of and : @xmath45\\left(2\\pi   r \\sigma\\right ) \\label{eq : dtnu}\\ ] ] @xmath46 matching @xmath47 and @xmath48 gives a differential equation in @xmath9 : @xmath49 the integration of this equation gives the profile of the gap .",
    "the top panel of fig .",
    "[ fig : figure1poster ] gives examples of the solution of eq .   for several values of the viscosity , from strong ( @xmath50 )",
    "to weak ( @xmath51 ) . to compute them from",
    ", we have ( i ) assumed that the mass of the planet is @xmath52 in our normalized units , ( ii ) imposed the boundary condition @xmath53 and ( iii ) assumed that the gravity torque is null in the horseshoe region , here approximated by : @xmath54 .",
    "as a consequence of ( iii ) the surface density profile in the vicinity of the planet assumes an equilibrium slope proportional to @xmath55 , which makes @xmath47 null .",
    "notice that the slopes of the surface density at the edges of the gap do not depend on our assumptions ( ii ) and ( iii ) , but are dictated solely by the differential equation .",
    "we remark that the profiles illustrated in the figure are the same as in varnire _",
    "_ 2004 , despite the fact that these authors consider the gravity torque as given by the sum of the individual lindblad resonances .",
    "this again underlines the equivalence of the two approaches for the calculation of the gravity torque discussed in [ tt ] .    [",
    "[ numerical - simulations . ] ] numerical simulations .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we have tested the results of these analytic calculations using purely numerical simulations . for this purpose ,",
    "we have used the 2d hydrodynamic code described in masset ( 2000 ) , and considered a jupiter mass planet ( @xmath56 ) in a disk , whose initial surface density profile decays as @xmath55 , and @xmath57 ( the value of the minimal mass solar nebula at 5 au ( hayashi , 1981 ) ) .",
    "the disk aspect ratio was fixed at @xmath58 .",
    "the viscosity was chosen equal to the values used for the analytic computations , for direct comparison .",
    "in these simulations , the planet was assumed not to feel the gravity of the disk , so that it did not migrate . the grid used by the code for the hydrodynamical calculations extended from @xmath59 to @xmath60 ( we remind that the planet location is @xmath61 ) .",
    "the boundary conditions in @xmath12 are non - reflecting , which means that the waves behave as if they were propagating outside the boundaries of the grid . the angular momentum they carry",
    "is thus lost ; we have checked that the flux through the outer boundary represents only a negligible fraction of the total gravity torque ( see appendix  c ) .",
    "the relative surface density amplitude perturbation at the outer boundary has been measured to be less than 5% .",
    "the size of the grid was 150 cells in radius and 325 cells in azimuth .",
    "the simulations were carried on for @xmath62 planetary orbits , for viscosity down to @xmath63 and @xmath0 orbits for weaker viscosities . at these times , the profile of the gap does not seem to evolve significantly any more , as also found by varnire _",
    "( 2004 ) .",
    "[ [ comparisons . ] ] comparisons .",
    "+ + + + + + + + + + + +    the results are illustrated in the bottom panel of fig .",
    "[ fig : figure1poster ] .",
    "as anticipated in the introduction , we remark an evident difference with the analytic predictions .",
    "the simulated gap is much narrower than the one predicted by the analytic expression for low viscosities ( @xmath64 ) . at first sight",
    ", one might think that the discrepancy between the analytical and numerical solutions is due to the numerical viscosity ( dissipation due to numerical errors ) of the computer code .",
    "this is unlikely for the following reasons : ( i ) different gap profiles are observed for different viscosities , which shows that the simulation is not dominated by the numerical viscosity , as the latter should be the same in all simulations ; ( ii ) changing the resolution of the grid used in the numerical scheme , which changes the numerical viscosity , does not affect the gap profiles significantly ; ( iii ) different numerical schemes give consistent results ( de valborro , private communication ) .",
    "as anticipated in the introduction , the problem with this analytical modeling is the assumption that the gravity torque is entirely deposited in each annulus of the disk .",
    "a condition for such deposition to happen is that @xmath65 ( lin and papaloizou , 1993 ) .",
    "thus , this is usually considered as a second independent criterion for gap opening , in addition to ( bate _ et al .",
    "_ , 2003 ) .",
    "however , even if this condition is satisfied , a fraction of the gravity torque is still evacuated by the waves ( goldreich and nicholson , 1989 ; papaloizou and lin , 1984 ; rafikov , 2002 ) .",
    "the problem is to evaluate this fraction .",
    "below we show that it can be computed from a mean pressure torque acting on the fluid elements over their periodic equilibrium trajectories .",
    "consider an arbitrary closed curve in the disk and a little tube around it .",
    "the rate of change of angular momentum of the matter in the tube is the sum of the differential flux of angular momentum through its boundaries ( due to the advection of matter ) and of the torques acting on it . from the navier - stokes equations , in addition to the gravity and viscous torques ,",
    "there is a third torque due to pressure : @xmath66 where the integral is computed along the curve and we have assumed the usual state equation @xmath67 ( with @xmath68 denoting the sound speed ) . if the tube is a ring centered at the origin @xmath69 , the torque @xmath70 is equal to zero ( on the ring , @xmath12 is constant and @xmath71 ) , while the differential flux of angular momentum is generally not zero .",
    "the latter is the flux carried by the pressure supported wave ( goldreich and nicholson , 1989 ; see appendix  c ) . on the contrary , if one chooses a stream tube ( _ i.e. _ a tube bounded by two neighboring streamlines ) , the differential flux is obviously zero ( there is no flux of matter , by definition of stream tube ) , while @xmath70 is non zero in general .",
    "the latter is true because the streamlines are strongly distorted ( see fig .  [ fig : wake ] ) so that @xmath72 and thus @xmath73 .",
    "this shows that one can translate the angular momentum flux carried by the waves into a pressure torque , by a suitable partition of the disk in concentric tubes .",
    "obviously the two approaches are equivalent as the physics is the same .",
    "however , working with stream tubes and pressure torques gives practical computational advantages .",
    "this is therefore the approach that we follow in this paper .",
    "below , we check that the gravity , pressure and viscous torques really cancel each other in the numerical simulations , once the steady state is reached .    .",
    "light grey denotes high density and black low density , in a logarithmic scale .",
    "the white curves show some streamlines , in the frame corotating with the planet .",
    "they are followed from @xmath74 to @xmath75 for @xmath76 , and from @xmath75 to @xmath74 for @xmath77 , periodically .",
    "two of them correspond to horseshoe orbits in the planet corotation region .",
    "notice the strong distortion of the streamlines when they cross the over - density corresponding to the spiral wave ( wake ) launched by the planet . ]",
    "the approach outlined above requires that the stream tubes are closed . in our simulations",
    "this is true at the steady state , because our boundary conditions preserve the initial radial velocity at the edges of the grid , which is null as a result of our choice for the initial disk density profile @xmath78 .",
    "the calculation of the streamlines , which is done in fourier space to ensure periodicity , is detailed in appendix  a. we remark that , in the steady state , the streamlines coincide with the fluid element trajectories .    denoting the streamline by @xmath79",
    ", we numerically compute the following expressions , which are the integrals of @xmath80 with @xmath81 the azimuthal component of the force due to gravity , viscosity , or pressure respectively : @xmath82 @xmath83 _ { ( r_i(\\theta'),\\theta ' ) } \\left|\\frac{d\\theta'}{\\dot{\\theta'}}\\right|\\\\ t_\\nu(\\theta )   =   \\frac{1}{t_i(\\theta ) } \\int_\\pi^{\\theta } \\frac{1}{\\sigma_{(r_i(\\theta'),\\theta')}}r_i(\\theta')\\textbf{f}_\\theta^\\nu(r_i(\\theta'),\\theta ' ) \\left|\\frac{d\\theta'}{\\dot{\\theta'}}\\right| % \\\\\\ ] ] @xmath84 here , @xmath85 denotes the gravitational potential of the planet , and @xmath86 $ ] , where @xmath87 is the local viscous stress tensor for a newtonian fluid : @xmath88 , where @xmath89 is the strain tensor and @xmath90 is the identity matrix .",
    "we integrate from @xmath74 to @xmath91 , with @xmath92 , because we consider @xmath24 , so that the angular velocity is negative in the corotating frame .",
    "the time required to reach @xmath91 from @xmath74 is denoted @xmath93 . thus , as the trajectories coincide with the streamlines in the steady state , the expressions above describe the averaged torques felt by a fluid element that travels from the planet opposition to @xmath91 .    in the following ,",
    "we denote for simplicity by @xmath94 , @xmath95 , @xmath70 the expressions - evaluated at @xmath96 .",
    "the total torques acting on the stream tube centered around the considered streamline are simply the product of these quantities times the mass carried by the tube .    in the next paragraphs",
    "we give a brief description of the integrated torques - as functions of @xmath91 , which are plotted in fig .",
    "[ fig : torquesc ] for the streamline starting at @xmath97 at opposition with the planet .",
    ", while the position of the planet is shown by a filled dot at the bottom ; the corresponding scale is reported on the right vertical axis .",
    "the thin solid curve shows the difference between the angular momentum measured along the streamline ( @xmath98 ) , and the sum of the three integrated torques and of the initial angular momentum ( @xmath99 ) .",
    "a small difference is almost impulsively acquired at the wake crossing , due to numerical approximations . ]",
    "[ [ viscous - torque ] ] viscous torque : + + + + + + + + + + + + + + +    the growth of the integrated viscous torque appears to be nearly linear with respect to the azimuth , leading to a total negative torque .",
    "we verified that on this streamline @xmath100 , with @xmath47 from .",
    "thus , the viscous torque depends only on the radial relative derivative of the azimuthally averaged density @xmath101 .",
    "however , on streamlines that pass closer to the planet , the difference between @xmath95 and @xmath102 becomes more significant ( see fig .  [",
    "fig : tptgtnu_r0 ] ) .",
    "[ [ gravity - torque ] ] gravity torque : + + + + + + + + + + + + + + +    the evolution of this integrated torque is not monotonic . the fluid element is first repelled by the planet , as a result of the indirect term in the gravitational potential .",
    "then , when @xmath91 decreases below @xmath103 , it starts to be attracted by the planet .",
    "the attraction becomes stronger and stronger as the fluid element approaches conjunction , namely as @xmath91 decreases to @xmath104 .",
    "the integrated torque becomes negative .",
    "after conjunction , the planet tends to pull the fluid element toward positive @xmath91 , giving a positive torque . as a result",
    ", the fluid element is rapidly repelled toward larger @xmath12 , as one can see from the trajectory on fig .",
    "[ fig : torquesc ] .",
    "this is typical of the scattering of test particles in the restricted three body problem , which qualitatively justifies the impulse approach for the calculation of the gravitational torque , as in lin and papaloizou ( 1979 ) .",
    "however , lin and papaloizou s calculation holds in the approximation @xmath105 . by comparing the numerical estimate of @xmath106 with @xmath48 given by eq .",
    "( [ eq : dtg ] ) , we find that the following expression , which has the same dependence in @xmath107 and nearly the same numerical coefficient , but which distinguishes @xmath12 and @xmath15 , provides a much more accurate representation of the gravity torque : @xmath108 in reality , @xmath94 depends on the exact shape of the streamlines , which in turn depends on the scale height and the viscosity ( see fig .",
    "[ fig : gravity_torque ] and [ fig : tptgtnu_r0 ] ) . however , the difference is moderate and limited to the vicinity of the planet , so that in the following we use expression for all cases .",
    "we stress that expression gives the torque exerted on the fluid element , which is generally _ not _ the torque deposited in the disk .",
    "in fact , even in the absence of viscosity , it does not correspond to the change of angular momentum of the fluid element , because some of the angular momentum is carried away by the pressure torque .     as a function of @xmath12 , where @xmath12 is the distance to the central star at planet opposition of the streamline on which the gravity torque is integrated .",
    "the bold long - dashed curve is obtained from the simulation with @xmath56 , @xmath109 , and @xmath110 , while the bold short - dashed curve corresponds to a more viscous case ( @xmath111 ) .",
    "the solid line traces expression , which remarkably fits the results obtained in the less viscous case .",
    "the dashed - dotted curve traces expression , which shows that @xmath112 . ]",
    "[ [ pressure - torque ] ] pressure torque : + + + + + + + + + + + + + + + +    the dependence of this torque on @xmath91 is simple to understand if one takes into account that : ( i ) the trajectories cross the wake immediately after the conjunction with the planet ( fig .",
    "[ fig : wake ] ) ; ( ii ) the wake is a strong over - density in the disk ; ( iii ) the pressure term @xmath113 makes over - densities repellent .",
    "thus , as the fluid element approaches the wake , its azimuth @xmath91 decreasing in the corotating frame , the pressure rises and tends to push the fluid element back in the direction of increasing @xmath91 .",
    "this gives a positive local torque and it explains the peak in the integrated pressure torque in fig .",
    "[ fig : torquesc ] .",
    "then , after that the fluid element has crossed the wake , the pressure decreases as @xmath91 decreases .",
    "this leads to a negative local pressure torque .",
    "it corresponds to the fall after the peak on fig .",
    "[ fig : torquesc ] . the negative contribution is bigger than the positive one because of the asymmetry of the trajectory relative to the wake position , which is clearly visible in fig .",
    "[ fig : gradient ] .",
    "clearly , the pressure torque must depend on the shape of the streamlines and on the surface density relative radial gradient , which govern the shape of the wake and its density enhancement .",
    "we return to this in section  [ sec : semi - analytic_results ] .          from fig .",
    "[ fig : torquesc ] we remark that , at @xmath96 , the sum of the viscous and pressure torques is basically the opposite of the gravity torque .",
    "therefore , the three torques approximately balance out .    given the angular momentum @xmath7 of a fluid element at @xmath114 , one can compute the angular momentum @xmath115 that it would have if its trajectory were governed exclusively by the three torques mentioned above : @xmath116 .",
    "this can be compared with the local angular momentum on the trajectory @xmath98 , measured directly from the numerical simulation . in fig .",
    "[ fig : torquesc ] the thin line shows @xmath117 .",
    "this function is zero for @xmath91 evolving from @xmath74 down to @xmath118 , where the wake is crossed . at the wake",
    "crossing , a small kick is observed .",
    "then , when @xmath91 evolves from the wake location to @xmath75 , the function @xmath119 remains constant again .",
    "this confirms that the trajectory is essentially governed by the three torques mentioned above .    the small difference between @xmath7 and @xmath120 ( fig .",
    "[ fig : torquesc ] ) could in principle be due to the pseudo - viscous pressure introduced in the simulation to avoid numerical instabilities ( lin and papaloizou , 1986a ) , but we have verified that the effect of the latter is negligible .",
    "thus , we conclude that it is a consequence of numerical errors , introduced by the grid discretization at the shock site .",
    "this numerical issue evidently prevents the three cumulative torques from balancing out perfectly at @xmath96 : indeed , their sum is equal to @xmath121 .    , @xmath95 , @xmath70",
    "are plotted in bold lines as a function of @xmath12 , which denotes here and in the following plots the radius of the streamline at opposition with respect to the planet ( @xmath122 ) ; the horseshoe region @xmath123 ( see fig .  [",
    "fig : wake ] ) is excluded .",
    "the thin dotted line shows the value of the viscous torque given by @xmath102 , with @xmath47 from ( keplerian circular approximation ) .",
    "the thin solid line is the sum of the three torques .",
    "it is not exactly zero , in particular in the vicinity of the planet , because of numerical approximations generated at the wake crossing .",
    "top panel : large viscosity case ; the pressure torque becomes relevant only close to the planet .",
    "bottom panel : low viscosity case ; the pressure torque appears further from planet , compensating for the smaller viscous torque.,title=\"fig : \" ] , @xmath95 , @xmath70 are plotted in bold lines as a function of @xmath12 , which denotes here and in the following plots the radius of the streamline at opposition with respect to the planet ( @xmath122 ) ; the horseshoe region @xmath123 ( see fig .  [",
    "fig : wake ] ) is excluded .",
    "the thin dotted line shows the value of the viscous torque given by @xmath102 , with @xmath47 from ( keplerian circular approximation ) .",
    "the thin solid line is the sum of the three torques .",
    "it is not exactly zero , in particular in the vicinity of the planet , because of numerical approximations generated at the wake crossing .",
    "top panel : large viscosity case ; the pressure torque becomes relevant only close to the planet .",
    "bottom panel : low viscosity case ; the pressure torque appears further from planet , compensating for the smaller viscous torque.,title=\"fig : \" ]    in order to explore the relative importance of viscosity and pressure in different situations , we show in fig .  [",
    "fig : tptgtnu_r0 ] the three averaged torques as a function of @xmath12 for two simulations , with @xmath111 ( top panel ) and @xmath110 ( bottom panel ) . in the more viscous case ,",
    "the pressure torque becomes relevant for @xmath124 , _",
    "i.e. _ at the edge of the gap .",
    "there , it substantially helps the viscous torque in counterbalancing the gravity torque .",
    "this explains why the gap observed in the simulation is narrower than the one predicted by the theory considering only the gravity and the viscous torques alone ( see fig .",
    "[ fig : figure1poster ] ) .",
    "in fact , if the pressure torque were not present , all over the region @xmath124 the relative radial gradient of the surface density of the disk would have needed to be much steeper , in order to enhance the viscous torque up to the value of the gravity torque ( see eq .  ) .",
    "this would have given a wider and deeper gap profile .",
    "it is interesting to compare the top panel of fig .",
    "[ fig : tptgtnu_r0 ] with the lower panel , which is plotted for a value of the viscosity that is almost an order of magnitude smaller .",
    "first , we remark that the gravity torque is somewhat smaller in the vicinity of the planet ; this is due to a ( moderate ) change of the shape of the streamlines , as discussed in last subsection .",
    "the viscous torque has decreased much more than the gravity torque , but not proportionally to the viscosity ; this is because the profile of the gap has changed and the relative radial gradient of the surface density is now steeper .",
    "the pressure torque has _ increased _ relative to the gravity torque , and is now non - negligible in the full region @xmath125 .",
    "it is always larger in absolute value than the viscous torque .",
    "its radial profile looks very similar to that of the gravity torque .",
    "in essence , it is the pressure torque that counterbalances the action of the planet , with the viscosity only playing a minor role .",
    "thus there is a dramatic qualitative change , with respect to the previous case , in how the torques balance out to settle the equilibrium configuration .",
    "the two cases discussed above convincingly show that the disk equilibrium is set by the equation @xmath126 when the viscosity fades , the role of pressure takes over in controlling the gap opening process , limiting the gap width .",
    "this means that , as viscosity decreases , a larger fraction of the gravity torque is transported away by the pressure supported waves .",
    "this phenomenon explains why the width of the gap increases with decreasing viscosity in a much less pronounced way than in varnire _",
    "et al . _ s model , which does not include a pressure torque .",
    "the role of pressure in limiting the gap width may still appear surprising , but it can be understood with some physical intuition . in an inertial environment , it is pressure and not viscosity which makes a gas fill the void space . in a rotating disk",
    "the situation is different , because a radial pressure gradient simply adds or subtracts a force to the gravitational force exerted by the central star .",
    "this changes the angular velocity of rotation of the gas , without causing any radial transport of matter .",
    "thus if the edges of the gap were circular , the pressure could not play any role in limiting the gap opening .",
    "however , as the gap edges are not circular , as shown in fig .  [",
    "fig : gradient ] , the pressure gradient is not entirely in the radial direction , and thus it exerts a force with a non - null azimuthal component .",
    "this gives a net torque , and tends to fill the gap .",
    "[ sub : semi - analytic_formula ]    in the last section , the pressure torque has been numerically computed in different cases .",
    "it has been shown that , when the disk is in equilibrium , the pressure , gravity and viscous torques cancel out .",
    "this suggests that it should be possible to compute a priori the shape of the gap by imposing that this equilibrium is respected .",
    "indeed , the viscous and pressure torques depend on the relative radial gradient of the azimuth - averaged density , whereas the gravity torque has no direct dependence on it . therefore , on a given trajectory , there must be a value of this gradient that corresponds to the exact equilibrium between these three torques .",
    "our semi - numerical algorithm for the computation of this equilibrium value is described in appendix  b. the results are shown in fig .",
    "[ fig : semi - anal - sol ] ( crosses ) and satisfactorily agree with the real values measured in the corresponding numerical simulation ( solid curve ) , _ i.e. _ the simulation from which the streamlines used by the algorithm have been obtained .    the knowledge of the relative radial gradient of the azimuth - averaged density as a function of the radial distance enables us to construct a gap profile by simple numerical step by step integration , starting from a boundary condition . in the secondary panel of fig .",
    "[ fig : semi - anal - sol ] this integrated profile ( dashed curve ) is plotted against the real one from the considered simulation .",
    "the match between the two profiles is almost perfect , which again proves that the gap profile is set by the balance between the three torques due to gravity , viscosity , and pressure .    ,",
    "viscosity = @xmath127 , planet mass = @xmath128 ) . from the algorithm ,",
    "the gap profile is computed ( dashed curve in the little box ) , and compared to that obtained in the numerical simulation ( solid curve ) . ]",
    "we now wish to go beyond the semi - numerical algorithm of appendix  b and obtain an approximate analytic expression for the pressure torque , to be used in an explicit differential equation for the gap profile .",
    "as we have seen above , for a given streamline , the absolute value of the pressure torque is an increasing function of the relative radial gradient of the azimuthally averaged surface density .",
    "furthermore , in a disk with no density gradient , the pressure torque must be zero .",
    "thus , we approximate the dependence of the pressure torque on the relative radial density gradient with a linear function : @xmath129    before looking for a numerical approximation of the function @xmath130 , we make two considerations on its functional dependence on the scale height of the disk and on the mass of the planet .     first , because of eq .",
    ", @xmath130 is necessarily proportional to @xmath131 . as @xmath132 is proportionnal to the scale height @xmath7",
    ", we can write @xmath133 .",
    "second , in the limit of negligible viscosity , scaling the aspect ratio @xmath134 proportionally to @xmath135 , and adopting @xmath136 as basic unit of length , the equation of motion becomes independant of the planet mass ( korycansky and papaloizou , 1996 ) .",
    "thus , if the disk aspect ratio scales with the planet hill radius , the resulting surface density @xmath137 at equilibrium is a function of @xmath138 only .",
    "consequently @xmath139 is a function of @xmath138 , divided by @xmath136 .",
    "as the gravity torque @xmath94 is proportional to @xmath140 ( see ) , the equilibrium @xmath141 can hold if and only if @xmath142 , where @xmath143 is a dimensionless function and the constant factor @xmath144 stands for homogeneity reasons .",
    "to evaluate the function @xmath145 , we use numerical simulations from which we measure the pressure torque and the relative radial gradient of the surface density . in practice , we consider two simulations : ( i ) the reference one , with a jupiter mass planet in a disk with aspect ratio = @xmath146 and viscosity = @xmath127 , which gives information for @xmath138 in the range 27 , and ( ii ) a similar simulation but with viscosity @xmath51 which , because of its wider gap , allows us to better estimate the asymptotic behavior of @xmath145 at large @xmath107 .",
    "we find that @xmath143 can be approximately fitted by the function @xmath147    equation has been determined for the external part of the disk ( @xmath148 ) , outside of the horseshoe region . however , assuming that the streamlines are symmetric relative to the position of the planet , the same expression can be applied in the inner part of the disk , which justifies the absolute value of @xmath107 . in fact , to represent the inner edge of the gap , just rotate fig .",
    "[ fig : gradient ] by 180 degrees , and it becomes evident that a negative density gradient leads to a positive torque .",
    "note that eq .   has been determined with reference to the streamlines corresponding to the case with @xmath56 , @xmath110 , and @xmath149 . however , the exact shape of the streamlines depends on @xmath18 , @xmath5 , and @xmath134 , even in rescaled coordinates .",
    "we neglect this dependence at this stage .",
    "thus , we assume that is valid for any value of @xmath5 and @xmath134 and @xmath145 depends on @xmath18 only via @xmath136 .",
    "this approximation has the advantage of providing us an analytic expression for the computation of the gap profiles .",
    "in fact , the disk equilibrium equation becomes : @xmath150^{-1}\\left[\\frac{3}{4}\\nu\\omega - t_g \\right ] \\label{eq : gap_analytic}\\ ] ] with @xmath145 and @xmath94 given in eq .   and respectively .",
    "the right hand side of eq .",
    "is independent of @xmath137 and is an explicit function of @xmath12 .",
    "this differential equation can be integrated , once a boundary condition @xmath151 is given .",
    "unfortunately the integral has no analytic solution , so that it has to be computed numerically .    , @xmath149 , @xmath110 .",
    "_ case 2 : _ more viscous case : @xmath56 , @xmath149 , @xmath152 .",
    "_ case 3 : _ less viscous case : @xmath56 , @xmath149 , @xmath51 .",
    "_ case 4 : _ scaled case : @xmath153 , @xmath154 , @xmath110 .",
    "_ case 5 : _ thicker disk case : @xmath56 , @xmath155 , @xmath110 .",
    "_ case 6 : _ more massive case : @xmath153 , @xmath149 , @xmath110 . ]",
    "figure  [ fig : semi - anal_vs_num ] shows comparisons of the gap profiles obtained in numerical simulations with those obtained with the integration of eq .",
    ", for six different cases with different viscosities or aspect ratios and planetary mass ( see figure caption for a list of parameters ) .",
    "the comparisons are done only for the outer part of the disk , because in the inner part , the effect of the boundary condition , not considered in our model , is too prominent in the numerical results . in the integration of eq .",
    "equal to the value found in the numerical simulations at a point on the brink of the gap , so as to allow an easier comparison between the numerical and semi - analytic density gradients at the edge of the gap .",
    "we remark that in case  1 , the semi - analytic gap profile matches almost perfectly the numerical profile .",
    "this is not surprising , because this is the reference case for which the streamlines have been computed , so that our expression is virtually exact .    in cases  2 and 3 ,",
    "we change the viscosity and keep the same planet mass and aspect ratio as in case  1 . now , the agreement between the numerical and semi - analytic profiles is less good .",
    "in particular , in the high - viscosity case , the real density gradient is shallower than the one we compute , while in the low - viscosity case it is steeper .",
    "this is because the real streamlines are not identical to those for which eq .",
    "has been computed . in the more viscous case ,",
    "the equilibrium in the disk is achieved with a weaker pressure torque .",
    "the distortion of the streamlines at the wake is dictated by the difference between the local gravity and pressure torques .",
    "thus , a weaker pressure torque gives streamlines that are more distorted at the wake than in our reference case .",
    "but , as sketched in fig .",
    "[ fig : gradient ] , the more a streamline is distorted , the more efficient it is in producing a pressure torque from a radial surface density gradient .",
    "consequently the pressure torque required to set the equilibrium in the disk is achieved with a smaller density gradient than the one needed if the streamlines were as in the reference case .",
    "the opposite holds in the less viscous case .    in case  4 , we increase the mass of the planet and the disk aspect ratio , in a way such that @xmath156 is the same as in case  1 .",
    "the viscosity is also the same as in case  1 , and the agreement between the model and the simulation is equally good .    finally , in case  5 and 6",
    ", we change @xmath156 . in case  5 , we keep the planet mass and viscosity of case  1 but increase the aspect ratio to @xmath157 ; the model gap is quite narrower and shallower than the numerical one . in case  6 , we use the same planet as in case  4 but with the aspect ratio and viscosity of case  1 , which gives as smaller @xmath156 ; the gap that our model predicts is now slightly wider than the one obtained in the numerical calculation .",
    "the interpretation for the disagreements observed in cases 5 and 6 is the same as that offered for cases 2 and 3 .",
    "figure  [ fig : semi - anal_vs_num ] shows significant differences in the value of @xmath9 between the numerical simulation and the analytic expression .",
    "however , we stress that a large difference in @xmath9 can correspond to almost no difference in the relative slope @xmath158 . for instance , in the case with viscosity equal to @xmath159 ( case 2 ) , the surface density profiles for @xmath160 seem quite different , but in fact , they have the same relative slope .     aspect ratio disk , with a @xmath161 viscosity .",
    "top panel shows the relative radial gradient of the density ; the fact that the curves overlap argues that the equilibrium function has been rapidly reached .",
    "bottom panel shows the evolution of the surface density at the same times ; a bump appears , which is a consequence of the matter removed from the gap , and it is eroded on a viscous time scale .",
    "this happens without modifying substantially the relative slope . ]    as we have shown above , it is the relative slope @xmath162 that sets the equilibrium .",
    "this equilibrium must be reached quickly , on a time scale independent of viscosity .",
    "in fact , in absence of equilibrium , the fluid elements are displaced radially over a synodic period and the trajectories are not periodic .",
    "this corresponds to the opening of the gap .",
    "then , once the equilibrium is almost set , the value of @xmath9 can still significantly evolve on a long ( viscous ) time scale , but keeping @xmath163 essentially unchanged .",
    "this fact is illustrated on fig .",
    "[ fig : bump - evol ] , which compares the evolution of @xmath164 ( top panel ) with the evolution of @xmath9 ( bottom panel ) for a weakly viscous case ( @xmath51 ) .",
    "this behavior explains why , when simulating the gap opening in low viscosity disks , the surface density profile seems to have attained a stationary solution within a limited number of planetary orbits , despite that the presence a prominent bump at the outer edge of the gap indicates that there is still room for evolution ( see fig .",
    "[ fig : figure1poster ] ) .    in the inner disk ,",
    "once the gap profile is set in terms of relative slope , we expect that the density @xmath9 decreases on a viscous timescale , because of the accretion on the central star . in the approximation of a fixed planet",
    ", this viscous evolution would lead to the formation of an inner hole in the disk , extended up to the planet position .",
    "in the previous section , we have presented a semi - analytic method to compute gap profiles .",
    "it gave overall satisfactory results , as shown in fig .",
    "[ fig : semi - anal_vs_num ] . in this section ,",
    "we use our method to explore the dependence of the gap profile on the two key parameters of the disk : viscosity @xmath5 and aspect ratio @xmath134 .",
    "in particular , we wish to revisit , with a unitary approach , the gap opening criteria mentioned in section  [ sec : gravity_and_viscous_torques ] :    \\(i ) the viscosity needs to be smaller than a threshold value . according to eq .",
    ", in our case of a jupiter mass planet this value is @xmath165 .",
    "\\(ii ) the disk height at the location of the planet needs to be smaller than @xmath166 . for a jupiter mass planet",
    "it corresponds to an aspect ratio @xmath167 .    in the computation of the gap profiles by integration of eq .",
    ", two problems are encountered .",
    "first , a boundary condition is needed .",
    "this choice is arbitrary , but in principle it should be consistent with the steady state of the disk .",
    "however , the steady state is an academic concept which exists only if the density is kept fixed somewhere in the disk , otherwise the disk spreads to infinity following lynden - bell & pringle ( 1974 ) equation . in our numerical code ,",
    "the surface density is kept equal to the unperturbed value at the outer boundary of the grid ( @xmath168 ) .",
    "thus , for the solutions of eq .   presented in figs .",
    "[ fig : pa - v ] and [ fig : pa - ar ] , we impose @xmath169 . in this way",
    ", our solution should correspond to the steady state solution that the code would converge to .",
    "moreover , this choice allows a direct comparison of our profiles with those obtained with varnire _",
    "_ model , illustrated in the top panel of fig .",
    "[ fig : figure1poster ] using the same boundary condition .",
    "the steady state solution provided by the numerical simulation does not depend on the size of the grid , provided that the boundaries are sufficiently far from the planet ( negligible differential planetary and pressure torques , or equivalently , negligible wave carried angular momentum flux , as in our nominal case see appendix  c ) .",
    "this required size increases with decreasing viscosity because the radial range over which the wave is damped increases .",
    "thus , in a very low viscosity case , the steady state solution obtained by the numerical simulation over an extended disk would be different from the model profiles given on fig .",
    "[ fig : pa - v ] . however , our model profiles would bound the gap observed in the numerical simulation as long as the normalized surface density at @xmath168 does not decrease below @xmath170 . in such low viscosity cases",
    ", this happens after an exceedingly long time .",
    "thus , we claim that our model profiles are significant for the description of gaps in realistic disks .",
    "the second problem concerns the treatment of the horseshoe region .",
    "the gravity and pressure torques , @xmath94 and @xmath70 , are considered null in the horseshoe region @xmath171 .",
    "the depth of the gap is thus set by the value of the density at @xmath172 . at the edges of the gap ,",
    "the slope is very steep , so that a little change in the assumed width of the horseshoe region leads to a major change in the gap depth .",
    "this is a limitation of our results from a quantitative point of view .",
    "though , it does not change the qualitative evolution of the gap profiles with respect to the disk parameters .",
    "this sensitivity to the width of the horseshoe region is also a problem for the construction of the surface density profile in the inner disk .",
    "the integration for the inner disk starts from @xmath173 down to @xmath69 , with the density at the bottom of the gap acting as the boundary condition . in principle , if the gap profile is symmetric , the errors at the right hand side and left hand side borders of the gap compensate each other : the value of the surface density at the bottom of the gap is not quantitatively correct , but the density profile in the inner disk is realistic .    . ]",
    "figure  [ fig : pa - v ] shows the results of our semi - analytic calculation for a fixed value of the aspect ratio ( @xmath58 ) and different values of the viscosity @xmath5 ( from @xmath104 to @xmath52 in normalized units ) .",
    "figure  [ fig : pa - ar ] keeps the viscosity @xmath110 and explores the dependence of the gap profile on the disk aspect ratio ( from @xmath104 to @xmath174 ) .",
    "the plotted curves naturally order themselves from bottom to top , from the less viscous case ( respectively the smallest aspect ratio ) to the most viscous case ( respectively the biggest aspect ratio ) .",
    "notice that this progression does not represent an evolution with time , but different steady state gap profiles , for different parameters .",
    "[ [ dependence - on - viscosity ] ] dependence on viscosity : + + + + + + + + + + + + + + + + + + + + + + + +    first of all , we remark on fig .",
    "[ fig : pa - v ] that the different shapes of the gaps qualitatively agree with those computed with numerical simulations , shown in the bottom panel of fig .",
    "[ fig : figure1poster ] .",
    "indeed , not only do we get deeper and wider gaps as viscosity decreases , but we also correctly reproduce the limited gap width achieved in the small viscosity cases .",
    "this means we have solved the problem that initially motivated our investigation .    as viscosity increases ,",
    "the gap is filled with gas , and the profile tends to the unperturbed profile set by the sole viscous effects : @xmath175 ( see section [ sec : gravity_and_viscous_torques ] ) .",
    "nevertheless , it is hard to determine a precise threshold value for gap opening , for at least two reasons .",
    "the first one is that the gap profiles have a smooth dependence on the viscosity .",
    "the concept of threshold viscosity for gap opening does not hold .",
    "the gap gradually increases in depth over a range of viscosities of about one order of magnitude .",
    "the second reason is that the depth of our gaps is very sensitive to the assumed width of the horseshoe region , as discussed above .",
    "thus , there is some uncertainty on the value of the viscosity that makes the gap become only a dip . assuming that a gap is opened if the surface density falls below @xmath157 of the unperturbed density , we find that @xmath176 .",
    "we remind that the ` classical ' threshold for gap opening is @xmath177 .",
    "however , the numerical experiments in fig .  [ fig : figure1poster ] ( bottom panel ) also suggest that @xmath178 at the bottom of the gap is achieved for @xmath179 .",
    "[ [ dependence - on - aspect - ratio ] ] dependence on aspect ratio : + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider now fig .  [ fig : pa - ar ] .",
    "we see a smooth evolution from deep gaps to shallow or inexistent gaps with increasing aspect ratios .",
    "this is easy to understand , because @xmath180 is a multiplicative coefficient in the expression of the pressure torque ( see section  [ sec : semi - analytic_results ] ) .",
    "therefore , the larger @xmath6 , the shallower needs to be the relative slope at the edge of the gap to achieve the equilibrium . as in the previous case , it is not possible to determine a threshold value of @xmath6 for gap opening , but we find that the ` classical ' value @xmath181 corresponds to about @xmath182 depletion in the gap .    more generally , with our approach we find that the viscosity required to fill the gap is a decreasing function of the aspect ratio .",
    "if the aspect ratio is too large , the gap can not be opened whatever the viscosity . to our knowledge , this is the first time that an analytic approach gives the correct description of the evolution of the gap profile with respect to _ both _ disk viscosity _ and _ aspect ratio .",
    "to go beyond the qualitative considerations of the previous section , we try to generalize the gap opening criterion with an expression that involves simultaneously the three main parameters of the problem : mass of the planet , scale height of the disk and viscosity .",
    "we start with a few considerations on two limiting cases . in the zero viscosity limit , as we have seen in section [ sec : semi - analytic_results ] , changing the scale height of the disk in proportion to the hill radius of the planet preserves the gap profile in scaled units @xmath138 .",
    "this means that , whatever depth threshold is adopted for the definition of ` gap ' , the threshold value of @xmath7 for gap opening in the zero viscosity limit , @xmath183 , is proportional to @xmath136 : @xmath184    in the infinitely thin disk limit ( @xmath185 ) , the disk equilibrium is set by the equation @xmath186 . at the border of the gap where the slope of the surface density is relevant , @xmath95 is proportional to @xmath187 . by changing the mass of the planet , the gravity torque changes proportionally to @xmath140 .",
    "if the viscosity @xmath5 is changed proportionally to @xmath188 , then the surface density profile @xmath9 remains an invariant function of @xmath138 .",
    "thus , independently of the adopted definition of ` gap ' as in the previous case , the threshold viscosity for gap opening in the infinitely thin disk limit , @xmath189 , scales proportionally to @xmath18 .",
    "this is consistent with the gap opening criterion given in bryden _",
    "@xmath190    we now come to the general case where neither @xmath7 nor @xmath5 are null . from the considerations above and",
    "it is evident that a change in the planet mass @xmath18 can give an invariant surface density profile in scaled units @xmath138 provided that @xmath7 is changed proportionally to @xmath191 _ and _ @xmath5 is changed proportionally to @xmath18 .",
    "the most complicated case that remains to be analyzed is that where @xmath18 is constant , but @xmath7 and @xmath5 are changed .",
    "it is evident from eq .   that it is not possible to have an invariant surface density profile by decreasing @xmath7 and increasing @xmath5 or vice - versa .",
    "the question is therefore how to keep the central gap depth invariant , despite changes in the gap profile .",
    "we answer this question using our semi - analytic calculation of gap profiles , based on the integration of eq .  .",
    "for this , we define arbitrarily that the minimal depth that defines a gap is 1/10 of the unperturbed disk density at @xmath192 .",
    "figure  [ fig : thresholds ] shows as bold lines , for six different values of the planet mass , the relationships @xmath7 vs. @xmath5 that preserve such central gap depth .     that make the gap depth be @xmath157 of the unperturbed density for given values of @xmath5 .",
    "they have been computed from the solutions of eq . .",
    "each curve corresponds to a planet mass .",
    "the thin lines represent our linear approximations given by eq . for the corresponding planet mass . ]",
    "as one can see , these relationships are almost linear .",
    "we can fit each one with a relation of type @xmath193 , where @xmath183 and @xmath189 have been defined above . as we have @xmath194 and @xmath195",
    ", we can derive a general relation involving @xmath7 , @xmath5 and @xmath18 that approximately describes all the curves plotted on fig .",
    "[ fig : thresholds ] , and thus a general criterion for gap opening .",
    "denoting by @xmath196 the reynolds number @xmath197 , we find that a gap is opened if @xmath18 , @xmath7 and @xmath196 satisfy the following inequality :    @xmath198    the thin lines on fig .",
    "[ fig : thresholds ] correspond to the limit case @xmath199 , for any of the six considered values of @xmath18 .",
    "in this paper , we have analyzed in detail the process of gap opening in proto - planetary disks . in this respect ,",
    "a key problem is to calculate which fraction of the torque exerted by the planet is locally deposited in the disk and which fraction is transported away by pressure supported waves .",
    "we have shown that the angular momentum evacuated by the waves can be computed as a pressure torque .",
    "we found that the steady state of the disk is set by the equilibrium among the total gravity torque , the viscous torque , and the pressure torque . from this consideration , we have built a semi - analytical algorithm that , given viscosity and aspect ratio , provides the equilibrium profile of the surface density of the disk , enabling us to explore the gap shape for a large range of parameters .",
    "this work has two types of application .",
    "it can be used to achieve a first realistic estimate of the width and depth of gaps in various situations , in view of the future high resolution observations of proto - planetary disks ( with alma or the ska projects ) .",
    "it can also give equilibrium gap profiles to be used as a starting condition in numerical simulations if one wants to avoid the intermediate , cpu - consuming phase which leads to the steady state .",
    "our work is not fully analytic .",
    "indeed our final equation involves a function @xmath145 which we approximated by the ansatz function  , with coefficients determined with respect to a reference numerical simulation .",
    "also the gravity torque has been refined using fits to the reference numerical results . as a consequence ,",
    "if our model matches the results of the reference numerical simulation , it still is in satisfactory agreement with the results of other numerical simulations .",
    "moreover , the equilibrium profile that we obtain corresponds to the equilibrium configuration of the disk at infinite time in presence of a non - migrating planet , which is evidently an ideal case .",
    "our model is two - dimensional , intended to approximate the behavior of a vertically isothermal 3d disk ; in a 3d , thermally stratified disk , the density waves would not propagate exactly the same way ( bate _ et al .",
    "_ , 2003 ) and consequently the pressure torque is expected to be somewhat different . finally , we have assumed a constant kinematic viscosity ; in reality , in the regions where the perturbations are nonlinear , the effective viscosity depends on the local planet s gravitational torque ( goodman and rafikov , 2001 ) , although this dependance may be weak ( papaloizou _ et al .",
    ".    in spite of these limitations , our work clearly demonstrates the fundamental role of the pressure in setting the equilibrium of the disk .",
    "moreover , it gives a correct , nearly quantitative , description of the evolution of the gap profile with respect to the key parameters of the problem : planet mass , viscosity and aspect ratio . from this",
    "we derive a new general criterion for gap opening , involving simultaneously these three parameters .",
    "our work shows why the width of the gap is bounded even in the case with very small viscosity , which was the open problem that originally motivated our work .",
    "it provides a conceptual unification of the two classically , but independently derived , criteria for gap opening , based on threshold viscosity and aspect ratio .",
    "aknowledgements : the authors thank anonymous referees for their carefull reading and their interesting remarks .",
    "we also thank david obrien for his comments on the manuscript .",
    "in a steady state , trajectories and streamlines coincide .",
    "computing the streamlines is then equivalent to computing the trajectories . in principle , to compute a trajectory it is enough to integrate the velocity field .",
    "the latter is defined on the grid and output by the code , from which the velocity at any point of the disk can be computed by interpolation . however , using this procedure , the resulting trajectories would in general not be periodic , as a consequence of the accumulation of the integration and interpolation errors .",
    "this is a serious problem , because the loss of periodicity would introduce a spurious change of angular momentum , namely a spurious torque .    to obtain perfectly periodic streamlines , we used the following algorithm , that for simplicity we detail for the outer part of the disk ( @xmath200 ) .",
    "we first compute a trajectory from @xmath201 to @xmath96 by simple numerical integration of the velocity field ( the integration runs from @xmath74 to @xmath75 because @xmath24 , so that the fluid element rotates clockwise in the corotating frame ) .",
    "this gives a first curve @xmath202 , defined on the interval @xmath203 $ ] . by definition @xmath204 , but @xmath205 is in general close but not equal to @xmath30 , because of numerical errors , as said above . on this trajectory",
    ", we calculate @xmath206 .",
    "this is a pseudo - derivative of @xmath207 , i. e. the slope of the tangent to the curve according to the velocity field",
    ". it should be equal to @xmath208 , but is not exactly equal because of the numerical errors in the computation of @xmath207 .",
    "then , we compute the fourier coefficients @xmath209 of @xmath210 .",
    "the first one @xmath211 is real , and corresponds to the mean of @xmath212 , namely to a radial drift .",
    "it is not zero as @xmath207 is not exactly periodic , and therefore we set it to zero .",
    "the pseudo - derivative of @xmath207 with respect to @xmath91 is thus modified . to get back to a trajectory , we integrate this modified pseudo - derivative .",
    "we denote the new trajectory by @xmath213 .",
    "this trajectory is periodic by construction as its zeroth order fourier coefficient is null . from @xmath214 , we repeat the algorithm to find @xmath215 , and so on , until the algorithm converges to a fixed point . this fixed point @xmath216 is a periodic trajectory by construction .",
    "it fits the velocity field , as it verifies @xmath217 , provided that the zeroth order fourier coefficient of its pseudo - derivative is negligible . if it is nt , it means that the algorithm failed .",
    "this happens in particular if the real streamlines are not periodic because a steady state has not been reached yet .    in practice , for the implementation of this algorithm , we used simulations computed over a grid with a larger resolution than that used in section  [ sec : gravity_and_viscous_torques ] .",
    "more precisely , we have used 512 cells in radius and 1024 in azimuth .",
    "the number of points used to compute the fourier coefficients of the pseudo - derivative was 1024 too . in all cases ,",
    "the algorithm explained above converged , and the zeroth order fourier coefficient of the final pseudo - derivative was negligible ( less than @xmath52 in our normalized units , even @xmath159 for all trajectories with @xmath218 ) .",
    "we present an algorithm that , given the shape of the streamlines , computes the relative surface density radial gradient that ensures the equilibrium condition .",
    "this is done in two steps .",
    "first , we design a procedure that evaluates @xmath70 on each streamline , for any given value of @xmath219 .",
    "second , we solve numerically the implicit equation for @xmath101 given by eq .  .",
    "[ [ first - step - computation - of - the - torques ] ] first step : computation of the torques + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the streamlines are ordered with respect to increasing distance to the central star , so that @xmath220 for every @xmath221 , @xmath91 .",
    "we call the @xmath221th _ streamtube _ the zone around the @xmath221th streamline : @xmath222 . a total mass @xmath223 or mean density @xmath224 can be imposed to be carried by a given streamtube @xmath221 . because the steady state is reached",
    ", the flux of matter in streamtube @xmath221 is constant with respect to time and azimuth , and is @xmath225 , where @xmath226 is the synodic period along the streamline .",
    "thus , the mass has to be distributed in the streamtube in such a way that the flux @xmath227/2 \\label{f}\\ ] ] is equal to @xmath228 for all @xmath91 .",
    "the azimuthal speed @xmath229 can be obtained by interpolation from the output of the numerical code ; the local density @xmath230 is therefore the only unknown in eq .",
    ", so that one has : @xmath231\\ .",
    "\\label{sigma}\\ ] ]    any relative radial density gradient @xmath232 around the @xmath221th streamline can be created by imposing appropriate values for @xmath233 and @xmath234 .",
    "the masses @xmath235 and @xmath236 carried by the streamlines are obtained by multiplying the mean surface densities by the areas of the stream tubes .",
    "then , the local densities are computed using eq .  .",
    "once the streamlines and the local densities are known , the numerical computation of the pressure torque can be done using eq .  .",
    "the partial derivative of the density with respect to the azimuth is delicate to compute . indeed , from eq .",
    "we know @xmath230 only on a discrete set of values @xmath79 .",
    "to compute @xmath237 at the location @xmath238 we need to know @xmath239 , for some small @xmath240 .",
    "this is computed by interpolation between @xmath241 and @xmath242 , where the @xmath243th streamline is chosen such that @xmath244 .",
    "the viscous and gravity torques are given by expressions and respectively , with @xmath245 .",
    "expression   is preferred to expression , despite of its limitations in the very vicinity of the planet ( see fig .  [",
    "fig : tptgtnu_r0 ] ) because it is simple and explicit .",
    "[ [ second - step - computation - of - the - gap - profile ] ] second step : computation of the gap profile + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to obtain the density profile we impose that the sum of the three torques vanishes on every streamline . thus , for each streamline , the goal is to find the value of the relative surface density slope @xmath246 that makes the total torque @xmath247 equal to zero .",
    "as the pressure torque is numerically computed , the solution can be found only numerically .",
    "we use a secant method algorithm , described next .    a first value @xmath248 of @xmath249 is arbitrarily chosen ( typically @xmath104 or the solution found on a neighboring streamline ) .",
    "then , another value @xmath250 is taken ( for instance @xmath251 ) .",
    "the secant method algorithm is then used .",
    "the value chosen for @xmath252 is : @xmath253 $ ] .",
    "a sequence @xmath254 is build this way . at each step , the tested value is : @xmath255 $ ] .",
    "the sequence converges to @xmath256 , such that @xmath257 .",
    "we stop when we reach a value for @xmath249 that makes @xmath258 smaller than @xmath259 , and we take that as our solution for @xmath260 .    with this procedure , we get @xmath261 for each streamline or , equivalently , each @xmath262 .",
    "it represents a data point for the relative radial derivative of the density , shown as a cross on fig .",
    "[ fig : semi - anal - sol ] .",
    "the flux of angular momentum has to be evaluated in a frame in which angular momentum is conserved .",
    "this is not the case for the frame centered on the primary ( which is accelerated ) , whereas it is the case in the non - rotating frame centered on the barycenter @xmath20 of the system ( star plus planet plus disk ) , which is inertial .",
    "one therefore needs to evaluate the following expression : @xmath263 where @xmath264 and @xmath265 are the perturbed azimuthal and radial velocities in the @xmath20 centered frame : @xmath266 and @xmath267 , the barred quantities denoting the averages over the circle of integration .",
    "we assume that @xmath268 .",
    "we remark that the perturbed quantities are proportionnal to @xmath18 , and @xmath269 to @xmath270 .",
    "then , to compute from the velocities output by the code , we need a sequence of transformations . neglecting terms that will give corrections of order @xmath271 in @xmath269 ,",
    "this reduces to two transformations on @xmath272 and @xmath273 :    1 .",
    "the velocity of @xmath20 in the heliocentric frame has to be substracted . in polar",
    "coordinates centred on the star , it is to first order in @xmath18 : @xmath274 where the subscript @xmath275 refers to the planet .",
    "the radial and azimuthal components of a fluid element velocity are different in the heliocentric and barycentric frames . for any vector @xmath276 in the heliocentric frame , the radial component in the barycentric frame",
    "is written , to first order in @xmath18 , as : @xmath277 .",
    "similarly , the azimuthal component of @xmath278 in the barycentric frame is : @xmath279 .",
    "we stress that the radial component of the velocity of a fluid element is proportional to @xmath18 , so that the above correction on the azimuthal component is second order in @xmath18 and will be neglected .    the application of ( i ) and ( ii ) give the following expression for @xmath269 : @xmath280 @xmath281 \\",
    "r{\\rm d}\\theta\\ , \\label{eq : f_h_barycentric}\\ ] ] where @xmath282 is the mean density on the circle and all the quantities are the ones output by the code in the heliocentric frame .",
    "this corresponds to the flux of angular momentum through the circle of radius @xmath12 , due exclusively to the wave launched by the planet .      1 .",
    "the density @xmath9 should be evaluated along the circle , but @xmath283 , and @xmath284 , so that @xmath9 can be replaced by @xmath282 in the integral .",
    "the circle of radius @xmath12 centered on @xmath20 differs from the circle of radius @xmath12 centered on the star .",
    "as the distance between the two circles is proportional to q , this only introduces negligible modifications in the value of every quantity .",
    "3 .   in the previous calculations",
    ", @xmath20 corresponds to the barycenter of the star - planet system , and not of the whole system including the disk .",
    "the latter is initially axisymmetric , and the perturbations are proportional to @xmath18 .",
    "as the mass of the disk is also of the order of the mass of the planet , the influence of the disk on the barycenter position is negligible .",
    "we computed the flux @xmath269 on our reference simulation ( @xmath56 , @xmath110 , @xmath285 ) using eq .  . in fig .",
    "[ fig : flux ] , @xmath286 is plotted as a bold plain line , whereas the total gravity torque @xmath40 computed on the annulus between the planet orbit and the circle of radius @xmath12 is shown as a bold dashed line .",
    "the gravity torque is computed using the direct terms due to the planet ( @xmath287 , @xmath288 being the distance between the planet and the considered point ) and to the star ( @xmath289 ) , as it is evaluated in an inertial frame .",
    "the difference between @xmath269 and @xmath40 is the thin dot - dashed line ; it corresponds to the cumulative locally deposited gravity torque ( i. e. the fraction of the gravity torque that is not evacuated by the pressure supported wave ) .",
    "the wave carries an increasing flux near the planet ( in the zone @xmath290 ) , and takes away a large fraction of the gravity torque ; this corresponds to the raduis where the pressure torque @xmath70 appears to be of the same order as the gravity torque @xmath94 ( see fig .  [",
    "fig : tptgtnu_r0 ] ) .",
    "this angular momentum is then deposited further from the planet , in particular in the @xmath291 region , where @xmath286 sharply decreases .",
    "beyond @xmath292 the flux vanishes . at the outer boundary of our grid ,",
    "the flux of angular momentum taken away by the wave is negligible with respect to the total gravity torque .",
    "this shows that the outer boundary of the grid is sufficiently far from the planet so that the angular momentum transfer from the wake to the disk is correctly described , while the angular momentum leakage at the outer boundary is negligible .",
    "thus , we conclude that our simulations are realistic , and our gap profiles correspond to steady states in the non - migrating planet hypothesis .",
    "bate , m.  r. , lubow , s.  h. , ogilvie , g.  i. , miller , k.  a.  2003 .",
    "three - dimensional calculations of high- and low - mass planets embedded in protoplanetary discs .  monthly notices of the royal astronomical society 341 , 213 - 229 .",
    "bryden , g. , chen , x. , lin , d.  n.  c. , nelson , r.  p. , papaloizou , j.  c.  b.  1999 .",
    "tidally induced gap formation in protostellar disks : gap clearing and suppression of protoplanetary growth .",
    "astrophysical journal 514 , 344 - 367 .",
    "hayashi , c.  1981 .",
    "structure of the solar nebula , growth and decay of magnetic fields and effects of magnetic and turbulent viscosities on the nebula .",
    "progress of theoretical physics supplement 70 , 35 - 53 .",
    "korycansky , d.  g. , papaloizou , j.  c.  b.  1996 .",
    "a method for calculations of nonlinear shear flow : application to formation of giant planets in the solar nebula .",
    "astrophysical journal supplement series 105 , 181                papaloizou , j. , lin , d.  n.  c.  1984 .  on the tidal interaction between protoplanets and the primordial solar nebula .",
    "i - linear calculation of the role of angular momentum exchange .",
    "astrophysical journal 285 , 818 - 834 .",
    "papaloizou , j.  c.  b. , nelson , r.  p. , snellgrove , m.  d.  2004 .",
    "the interaction of giant planets with a disc with mhd turbulence - iii . flow morphology and conditions for gap formation in local and global simulations .",
    "monthly notices of the royal astronomical society 350 , 829 - 848 ."
  ],
  "abstract_text": [
    "<S> although it is well known that a massive planet opens a gap in a proto - planetary gaseous disk , there is no analytic description of the surface density profile in and near the gap . </S>",
    "<S> the simplest approach , which is based upon the balance between the torques due to the viscosity and the gravity of the planet and assumes local damping , leads to gaps with overestimated width , especially at low viscosity . here , we take into account the fraction of the gravity torque that is evacuated by pressure supported waves . with a novel approach , which consists of following the fluid elements along their trajectories , </S>",
    "<S> we show that the flux of angular momentum carried by the waves corresponds to a pressure torque . </S>",
    "<S> the equilibrium profile of the disk is then set by the balance between gravity , viscous and pressure torques . </S>",
    "<S> we check that this balance is satisfied in numerical simulations , with a planet on a fixed circular orbit . </S>",
    "<S> we then use a reference numerical simulation to get an ansatz for the pressure torque , that yields gap profiles for any value of the disk viscosity , pressure scale height and planet to primary mass ratio . </S>",
    "<S> those are in good agreement with profiles obtained in numerical simulations over a wide range of parameters . </S>",
    "<S> finally , we provide a gap opening criterion that simultaneously involves the planet mass , the disk viscosity and the aspect ratio . </S>"
  ]
}