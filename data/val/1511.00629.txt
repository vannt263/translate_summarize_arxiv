{
  "article_text": [
    "photoelectron spectroscopy is a powerful tool for studying photoionization in atoms , molecules and solids  @xcite . with the advent of new light sources , photoelectron spectroscopy using intense , short pulses",
    "has become available , revealing important information about electron dynamics and time - dependent phenomena  @xcite . in particular",
    ", it allows for characterizing the light - matter interaction of increasingly complex systems  @xcite .",
    "photoelectron spectra ( pes ) and photoelectron angular distributions ( pad ) contain not only fingerprints of the interaction of the electrons with the electromagnetic fields , but also of their interaction and their correlations with each other  @xcite .",
    "pad in particular can be used to uncover electron interactions and correlations  @xcite .",
    "tailoring the pulsed electric field in its amplitude , phase or polarization allows to control the electron dynamics , with corresponding signatures in the photoelectron spectrum  @xcite . while it is natural to ask how the electron dynamics is reflected in the experimental observables  pes and pad  @xcite , it may also be interesting to see whether one can control or manipulate directly these observables by tailoring the excitation pulse . moreover , one may be interested in certain features such as directed electron emission without analyzing all the details of the time evolution .",
    "this is particularly true for complex systems where it may not be easy to trace the full dynamics all the way to the spectrum .",
    "the question that we ask here is how to find an external field that steers the dynamics such that the resulting photoelectron distribution fulfills certain prescribed properties .",
    "importantly , the final state of the dynamics does not need to be known .",
    "the desired features may be reflected in the angle - integrated pes , the energy - integrated pad , or both .    to answer this question",
    ", we employ optimal control theory ( oct ) , using krotov s monotonically convergent method  @xcite and adapting it to the specific task of realizing photoelectron distributions with prescribed features .",
    "the photoelectron distributions are calculated within the time - dependent configuration interaction singles scheme ( tdcis )  @xcite , employing the splitting method for extracting the spectral components from the outgoing wavepacket  @xcite . while oct has been utilized to study the quantum control of electron dynamics before , in the framework of tdcis  @xcite as well as the multi - configurational time - dependent hartree - fock ( mctdhf ) method  @xcite or time - dependent density functional theory ( tddft )  @xcite , the pes and pad",
    "have not been tackled as control targets before .",
    "in fact , most previous studies did not even account for the presence of the ionization continuum .",
    "a proper representation of the ionization continuum becomes unavoidable  @xcite , however , when investigating the interaction with xuv light where a single photon is sufficient to ionize  @xcite , and it is indispensable for the full description of photoionization experiments .    to demonstrate the versatility of our approach , we apply it to two different control problems : ( i ) we prescribe the full three - dimensional photoelectron distribution and search for a field that produces , at least approximately , a given angle - integrated pes and energy - integrated pad .",
    "such a detailed control objective is rather demanding and corresponds to a difficult control problem .",
    "( ii ) we seek to maximize the relative number of photoelectrons emitted into the upper as opposed to the lower hemisphere , assuming that the polarization axis of the light pulse runs through the poles of the two hemispheres .",
    "this implies a condition on the pad alone , leaving complete freedom to the energy dependence .",
    "the corresponding control objective leaves considerable freedom to the optimization algorithm and the control problem becomes much simpler . maximizing the relative number of photoelectrons emitted into the upper as opposed to the lower hemisphere corresponds to a maximization of the pad s asymmetry .",
    "asymmetric photoelectron distributions arising in strong - field ionization were studied previously for near - infrared few - cycle pulses where the effect was attributed to the carrier envelope phase  @xcite . here , we pose the question whether it is possible to achieve asymmetry in the pad for multiphoton ionization in the xuv regime and we seek to determine the shaped pulse that steers the electrons into one hemisphere . to ensure experimental feasibility of the optimized pulses , we introduce spectral as well as amplitude constraints .",
    "we test our control toolbox for hydrogen and argon atoms , corresponding to a single channel and three active channels , respectively .",
    "these comparatively simple examples allow for a complete discussion of our optimization approach , while keeping the numerical effort at an acceptable level .",
    "the remainder of this paper is organized as follows . section  [ sec : theory ] briefly reviews the methodology for describing the electron dynamics , with sec .",
    "[ subsec : tdcis ] devoted to the tdcis method , and sec .  [ subsec : wfsm ] presenting the wave function splitting approach .",
    "optimal control theory for photoelectron distributions is developed in sec .",
    "[ sec : oct ] .",
    "specifically , we introduce the optimization functionals to prescribe a certain pes plus pad and to generate directed photoelectron emission in sec .",
    "[ subsec : optimizationproblem ] .",
    "the corresponding optimization algorithms are presented in sec .",
    "[ subsec : krotov ] , emphasizing the combination of oct with the wave function splitting method . for the additional functionality of restricting the spectral bandwidth of the field in the optimization ,",
    "the reader is referred to appendix  [ sec : frseqrestriction ] .",
    "our numerical results are presented in sec .",
    "[ sec : appl1 ] to  [ sec : appl3 ] , demonstrating , for hydrogen , the prescription of the pes and pad in sec .",
    "[ sec : appl1 ] and the minimization of photoelectron emission into the lower hemisphere in sec .",
    "[ sec : appl2 ] .",
    "maximization of the relative number of photoelectrons emitted into the upper hemisphere is discussed for both hydrogen and argon in sec .",
    "[ sec : appl3 ] . finally , sec .",
    "[ sec : concl ] concludes .",
    "in the following , we briefly review , following refs .",
    "@xcite , the theoretical framework for describing the electron dynamics and the interaction with strong electric fields .",
    "our method for calculating the outgoing electron wave packet is based on the time - dependent configuration interaction singles ( tdcis ) scheme @xcite .",
    "the time - dependent schrdinger equation of the full @xmath0-electron system , @xmath1 is solved numerically using the lanczos - arnoldi propagator  @xcite . to this end",
    ", the @xmath0-electron wave function is expanded in the one - particle  one - hole basis : @xmath2 where the index @xmath3 denotes an initially occupied orbital , @xmath4 stands for a virtual orbital to which the particle can be excited and @xmath5 symbolizes the hartree - fock ground state . the full time dependent hamiltonian has the form @xmath6 where @xmath7 contains the kinetic energy @xmath8 , the nuclear potential @xmath9 , the potential at the mean - field level @xmath10 and the hartree - fock energy @xmath11 .",
    "@xmath12 describes the coulomb interactions beyond the mean - field level , and @xmath13 is the light - matter interaction within the velocity form in the dipole approximation , assuming linear polarization .",
    "the tdcis approach is a multi - channel method , i.e. , all ionization channels that lead to a single excitation of the system are included in the calculation .",
    "since only states with total spin @xmath14 are considered , only spin singlets occur and we denote the occupied orbitals by @xmath15 . as introduced in ref .",
    "@xcite , for each ionization channel all single excitations from the occupied orbital @xmath15 may be collected in one `` channel wave function '' : @xmath16 where the summation runs over all virtual orbitals ,  labeled with @xmath4 , which is a multi - index  @xcite .",
    "these channel wave functions allow to calculate all quantities in a channel - resolved manner  @xcite . in the actual implementation , the orbitals in eq .",
    "are expressed as a product of radial and angular parts  @xcite , @xmath17 where @xmath18 denote the spherical harmonics and @xmath19 is the radial part of the wave function which is represented on a pseudo - spectral spatial grid  @xcite .",
    "the pes and pad are calculated using the splitting method @xcite which was implemented within the tdcis scheme @xcite .",
    "briefly , in this propagation approach the wave function is split into an inner and an outer part using a smooth radial splitting function , @xmath20^{-1}\\ , , \\end{aligned}\\ ] ] where the parameter @xmath21 controls how steep the slope of the function is and @xmath22 is the splitting radius .",
    "the channel wave functions   are used to calculate the spectral components in a channel - resolved manner by projecting the outer part onto volkov states , @xmath23 . to this end , each channel wavefunction is split into an inner and an outer part at every splitting time @xmath24 ,    @xmath25    where @xmath26 and @xmath27    at each splitting time , the inner part , @xmath28 , is represented in the cis basis and further propagated with the full hamiltonian  ( [ ham ] ) , whereas the outer part is stored and propagated analytically to large times with the volkov hamiltonian , @xmath29 ^ 2\\ , .",
    "\\label{volkovham } \\end{aligned}\\ ] ] in this way , the outer part of the wave function can be analyzed separately in order to obtain information on the photoelectron .",
    "furthermore , since the outgoing part of the wave function is absorbed efficiently at the splitting times , large box sizes are avoided in the inner region .",
    "the spectral coefficient @xmath30 for a given channel @xmath3 , originating from splitting time @xmath24 and evaluated at the final time @xmath31 is obtained as a function of the momentum vector @xmath32  @xcite ,    @xmath33    where @xmath34 denotes the volkov phase ,  given by @xmath35 ^ 2 \\,,\\end{aligned}\\ ] ] the sum runs over the virtual orbitals , @xmath36 is the overlap of the outer part with the virtual orbital , @xmath37 and @xmath38 is the @xmath39th bessel function .",
    "@xmath40 is the evolution operator associated with the volkov hamiltonian and @xmath41 is a sufficiently long time so that all parts of the wave function that are of interest have reached the outer region and are included in the pes .",
    "the contributions from all splitting times must be added up coherently to form the total spectral coefficient for the channel @xmath3 , @xmath42 finally , incoherent summation over all possible ionization channels yields the total spectrum  @xcite , @xmath43 the energy - integrated pad is given by integrating over energy or , equivalently , momentum ,    [ eq : pad_pes ] @xmath44 analogously , the angle - integrated pes is obtained upon integration over the solid angle , @xmath45    with @xmath46 . the optimizations considered below are based on these measurable quantities .",
    "our goal is to find a vector potential , or control , @xmath47 , that steers the system from the ground state @xmath48 , defined in eq .  ,",
    "to an unknown final state @xmath49 whose pes and/or pad display certain desired features . such an optimization target is expressed mathematically as a final time functional @xmath50 $ ]  @xcite .",
    "we consider two different final time optimization functionals in the following .    as a first example",
    ", we seek to prescribe the angle - integrated pes and energy - integrated pad together .",
    "the corresponding final time cost functional is defined as @xmath51 & = &                \\lambda_{1 } \\int \\left(\\tilde{\\sigma}(\\mathbf{p},t ) )    -\\tilde{\\sigma}_0(\\mathbf{p})\\right)^2\\ , d^3 p \\,,\\quad\\quad\\end{aligned}\\ ] ] where @xmath52 denotes the actual photoelectron distribution , cf .",
    "eq .  , @xmath53 stands for the target distribution , and @xmath54 is a weight that stresses the importance of @xmath55 $ ] compared to additional terms in the total optimization functional .",
    "the goal is thus to minimize the squared euclidean distance between the actual and the desired photoelectron distributions .",
    "alternatively , we would like to control the difference in the number of electrons emitted into the lower and upper hemispheres .",
    "this can be expressed via the following final - time functional @xmath56 = \\\\ \\nonumber & & \\quad\\quad\\quad\\quad\\lambda_2^{(- ) } \\int^{\\pi}_{\\pi/2 } \\sin\\theta\\,d\\theta\\int_0^{+\\infty } \\big|\\tilde{\\varphi}_{\\rm out}(\\mathbf{p},t)\\big|^2 p^2\\ , dp\\\\ \\nonumber & & \\quad\\quad\\quad\\quad+ \\lambda_2^{(+)}\\int^{\\pi/2}_{0 } \\sin\\theta\\,d\\theta\\int_0^{+\\infty }   \\big|\\tilde{\\varphi}_{\\rm out}(\\mathbf{p},t)\\big|^2 p^2\\ , dp\\\\ \\nonumber & & \\quad\\quad\\quad\\quad+\\lambda_2^{tot } \\int^{\\pi}_{0 } \\sin\\theta\\,d\\theta\\int_0^{+\\infty }   \\big|\\tilde{\\varphi}_{\\rm out}(\\mathbf{p},t)\\big|^2 p^2\\ , dp\\,,\\end{aligned}\\ ] ] where the first and second term correspond to the probability of the photoelectron being emitted into the lower and upper hemisphere , whereas the third term is the total ionization probability .",
    "@xmath57 , @xmath58 and @xmath59 are weights .",
    "the factor of @xmath60 resulting from integration over the azimuthal angle has been absorbed into the weights .",
    "directed emission can be achieved in several ways  one can suppress the emission of the photoelectron into the lower hemisphere , without imposing any specific constraint on the number of electrons emitted into the upper hemisphere .",
    "this is achieved by choosing @xmath61 and @xmath62 .",
    "alternatively , one can maximize the difference in the number of electrons emitted into the upper and lower hemispheres . to this end ,",
    "the relative weights need to be chosen such that @xmath62 and @xmath63 . if @xmath64 , the optimization seeks to increase the _ absolute _ difference in the number of electrons emitted into the upper and lower hemisphere .",
    "close to an optimum , this may result in a strong increase in the overall ionization probability , accompanied by a very small increase in the difference , since only the complete functional is required to converge monotonically , and not each of its parts .",
    "this undesired behavior can be avoided by maximizing the relative instead of the absolute difference of electrons emitted into the upper and lower hemispheres .",
    "it requires @xmath65 , i.e. , minimization of the total ionization probability in addition to maximizing the difference .",
    "note that @xmath59 could also be absorbed into the weights for the hemispheres , @xmath66 = \\\\\\nonumber                                        & & \\quad\\quad\\quad\\quad + \\lambda^{(-)}_{eff }    \\int^{\\pi}_{\\pi/2 } \\sin\\theta\\,d\\theta\\int_0^{+\\infty } \\big|\\tilde{\\varphi}_{\\rm out}(\\mathbf{p},t)\\big|^2 p^2\\ , dp \\\\ \\nonumber & & \\quad\\quad\\quad\\quad+\\lambda^{(+)}_{eff }    \\int^{\\pi/2}_{0 } \\sin\\theta\\,d\\theta\\int_0^{+\\infty } \\big|\\tilde{\\varphi}_{\\rm out}(\\mathbf{p},t)\\big|^2 p^2\\ , dp \\,,\\end{aligned}\\ ] ] where @xmath67 and @xmath68 are effective weights .",
    "since @xmath69 and @xmath70 in order to maximize ( minimize ) emission into the upper ( lower ) hemisphere , the weights need to fulfill the condition @xmath71 .",
    "the complete functional to be minimized , @xmath72 + c[\\mathbf{a } ] \\ , , \\label{eq : jtotal}\\end{aligned}\\ ] ] also includes constraints @xmath73 $ ] to ensure that the control remains finite or has a limited spectral bandwidth .",
    "the constraints may be written for the electric field @xmath74 associated with the vector potential @xmath47 , even though the minimization problem is expressed in terms of @xmath47 and the dynamics is generated by @xmath75 $ ] , cf .",
    "the relation between the vector potential @xmath47 and the electric field @xmath74 is given by @xmath76 with @xmath77 .",
    "without loss of generality , we can write @xmath78 & = & c_a[\\mathbf{a } ] + c_{\\omega}[\\mathbf{a } ] + c_e[\\mathbf{a}],\\ \\label{eq : c_def}\\end{aligned}\\ ] ] where the independent terms in the rhs . of eq .",
    "are defined below .",
    "the first property that the optimized electric field must fulfill is that its integral over time vanishes , i.e. , @xmath79 which implies , according to eq .  , @xmath80",
    "therefore , we choose initial guess fields with @xmath80 and utilize @xmath81 & = & \\lambda_a\\int s^{-1}(t )    \\left(\\mathbf{a}(t)- \\mathbf{a}_{\\rm ref}(t)\\right)^2\\ , dt \\label{eq : ca}\\end{aligned}\\ ] ] with @xmath82 to ensure that eq .",
    "is fulfilled . in eq .  , @xmath83 and @xmath84 refer to a reference vector potential and a shape function , respectively , and @xmath85 is a weight that stresses the importance of @xmath86 $ ] compared to all other terms in the complete functional , eq .  .",
    "the shape function , @xmath84 , can be used to guarantee that the control is smoothly switched on and off at the initial and final times .",
    "a second important property of the optimized field is a limited spectral bandwidth .",
    "typically , optimization without spectral constraints leads to pulses with unnecessarily broad spectra which would be very hard or impossible to produce experimentally . to restrict the bandwidth of the electric field , @xmath74",
    ",  we construct a constraint @xmath87 $ ] in frequency domain , @xmath88 & = & \\lambda_{\\omega } \\int    \\tilde{\\gamma}(\\omega)\\big|\\tilde{\\mathbf{e}}(\\omega ) \\big|^2\\,d\\omega    \\nonumber \\\\    & = & \\lambda_{\\omega } \\int    \\tilde{\\gamma}(\\omega)\\omega^2\\big|\\tilde{\\mathbf{a}}(\\omega )    \\big|^2\\,d\\omega   \\ , , \\label{eq : comega }   \\end{aligned}\\ ] ] with @xmath89 being the fourier transform of the field , @xmath90 constraints of the form of eq .",
    "were previously discussed in refs .",
    "@xcite : the kernel @xmath91 plays a role similarly to the inverse shape function @xmath92 in eq .  , that is , it takes large values at all undesired frequencies .",
    "additionally , we assume that the symmetry requirement @xmath93 is fulfilled , see appendix  [ sec : frseqrestriction ] for details .    finally , in view of experimental feasibility",
    ", we would also like to limit the amplitude of the electric field to reasonable values .",
    "to this end , we construct a constraint that penalizes changes in the first time derivative of @xmath47 .",
    "in fact , since @xmath94 , large values in the derivative of the vector potential translate into large amplitudes of the corresponding electric field @xmath74 . to avoid this ,",
    "we adopt here a modified regularization condition  @xcite for @xmath95 , defining @xmath96 & = & \\nonumber    \\lambda_e\\int s^{-1}(t)|{\\mathbf{e}}(t)|^2\\ , dt\\\\    & = & \\lambda_e\\int s^{-1}(t)|\\dot{\\mathbf{a}}(t)|^2\\ , dt \\ , .",
    "\\label{eq : ce}\\end{aligned}\\ ] ] @xmath97 $ ] plays the role of a penalty functional  @xcite , ensuring the regularity of @xmath47 , and , as a consequence , penalizing large values on the electric field amplitude @xmath74 .",
    "the choice of the same @xmath92 in both eq .   and eq .   will simplify the optimization algorithm as shown below .",
    "krotov s method for quantum optimal control provides a recipe to construct monotonically convergent optimization algorithms , depending on the target functional and additional constraints , the type of equation of motion , and the power of the control in the light - matter interaction  @xcite .",
    "the optimization algorithm consists of a set of coupled equations for the update of the control , the forward propagation of the state and the backward propagation of the so - called co - state .",
    "this set of equations needs to be solved iteratively .",
    "the final - time target functional ( or , more precisely , its functional derivative with respect to the propagated state , evaluated at the final time , which reflects the extremum condition on the optimization functional  @xcite ) determines the `` initial '' condition , at final time , for the backward propagation of the co - state  @xcite .",
    "additional constraints which depend on the control such as those in eq .",
    "show up in the update equation for the control  @xcite .",
    "the challenge when combining krotov s method with the wave function splitting approach is due to the fact that splitting in the forward propagation of the state implies `` glueing '' in the backward propagation of the co - state . here",
    ", we present an extension of the optimization algorithm obtained with krotov s method that takes the splitting procedure into account .    evaluating the prescription given in refs .",
    "@xcite , we find for the update equation , with @xmath98 labeling the iteration step ,    [ eq : mykrotov ] @xmath99 with @xmath100 .",
    "@xmath101 denotes the convolution of @xmath102 and @xmath103 , @xmath104 with @xmath103 the inverse fourier transform of @xmath105 . the second term in eq .",
    "is given by @xmath106    where @xmath107 and @xmath108 denote the forward propagated state and backward propagated co - state at iterations @xmath109 and @xmath98 , respectively .",
    "the derivation of eqs .",
    "is detailed in appendix  [ sec : frseqrestriction ] . in order to evaluate eqs .",
    ", the co - state obtained at the previous iteration , @xmath108 , using the old control , @xmath110 , must be known .",
    "its equation of motion is found to be  @xcite    [ adjointsystem ] @xmath111 just as @xmath112 is decomposed into channels wavefunctions , cf .",
    "eq .  , so is the co - state .",
    "the `` initial '' condition at the final time @xmath41 is written separately for each channel , @xmath113}{\\pa\\langle \\tilde{\\varphi}_{i,\\rm out}(t)|}\\,.\\end{aligned}\\ ] ]    evaluation of eq .",
    "requires knowledge of the outer part of each channel wavefunction , @xmath114 , which is obtained by forward propagation of the initial state , including the splitting procedure . in what follows",
    ", @xmath115 denotes the evolution operator that propagates a given state from time @xmath116 to @xmath117 under the control @xmath47 .",
    "we distinguish the time evolution operators for the inner part , @xmath118 , generated by the full hamiltonian , eq .  , and for the outer part , @xmath119 , generated by the volkov hamiltonian , eq .  .",
    "for every channel , the total wavefunction is given by @xmath120 which is valid for arbitrary times @xmath121 with @xmath122 the first splitting time .",
    "the second term in eq .",
    "reads @xmath123 with @xmath124 .",
    "equation   accounts for the fact that for @xmath125 , all outer parts @xmath126 that originate at splitting times @xmath127 must be summed up coherently .",
    "propagation of all @xmath126 and continued splitting of @xmath128 eventually yields the state at final time , @xmath129 .",
    "its outer part is given by @xmath130 where @xmath0 denotes the number of splitting times utilized during propagation , and the last splitting time @xmath131 is chosen such that @xmath132 .",
    "the best compromise between size of the spatial grid ,  time step and duration between two consecutive splitting times is discussed in ref .",
    "@xcite .",
    "equation   can now be evaluated : since our final time functionals all involve the product @xmath133 ,   eq .",
    "can be written , at the @xmath98th iteration of the optimization , as    [ eq : chit ] @xmath134 where @xmath135 is a function that depends on the target functional under consideration .",
    "it becomes @xmath136 for @xmath137 given in eq .   and",
    "@xmath138 for @xmath139 given in eq .  .",
    "the intervals @xmath140 $ ] and @xmath141 $ ] denote the lower and upper hemispheres , respectively , and @xmath142 is the characteristic function on a given interval , @xmath143 with @xmath144 $ ] the polar angle with respect to the polarization axis . according to eqs .   and  , or",
    ", more precisely , since we do not consider intermediate - time constraints that depend on the state of the system  @xcite , @xmath145 and its co - state @xmath146 obey the same equation of motion .",
    "for that reason , it is convenient to define inner and outer parts of @xmath146 , analogously to the forward propagated state ,    [ eq : sub_chis ] @xmath147 with @xmath148    eq .",
    "implies that also @xmath149 is obtained by coherently summing up the contributions from all splitting times .",
    "conversely , the outer part of the co - state originating at the splitting time @xmath24 and evaluated at the same time is given by @xmath150 the next step is to construct the total co - state at an arbitrary time @xmath151 , @xmath152 , required in eq .",
    ", from all @xmath153 using eq .  .",
    "this is achieved by backward propagation and `` glueing '' inner and outer parts , as opposite to `` splitting '' during the forward propagation . however , when reconstructing the co - state by backward propagation , care should be taken to not to perform the `` glue '' procedure twice or more , at a given splitting time .",
    "the backward propagation of the co - state is explicitly explained in what follows : since at the final time @xmath41 , the total co - state is given by a coherent superposition of all outer parts originating at the splitting times @xmath24 , cf .",
    "eq .  , it suffices to store all @xmath154 and apply eq .   to evaluate @xmath155 .",
    "we recall that @xmath155 , respectively @xmath156 , denote the outer part born exclusively at @xmath157 and evaluated at the same splitting time .",
    "once all outer parts of the co - state are evaluated at every splitting time using eq .",
    ", @xmath152 is obtained for all times @xmath151 by backward propagation and  glueing \" , with the additional care of not `` glueing '' twice or more . in detail",
    ", @xmath158 is propagated backwards from @xmath131 to @xmath159 using the full cis hamiltonian , @xmath160 , cf .",
    "the resulting wave function at @xmath161 is @xmath162 .",
    "the outer part born exclusively at the splitting time @xmath161 is obtained using eq .  , and",
    "the `` composite '' wave function @xmath163 is obtained by `` glueing '' @xmath162 and @xmath164 , latexmath:[\\[|{\\chi}^{(k)}_i(t_{n-1})\\rangle = |\\chi^{(k)}_{i,\\rm in}(t_{n-1})\\rangle +    now repeated : the composite co - state @xmath163 is propagated backwards from @xmath161 to @xmath166 using the full cis hamiltonian , resulting in @xmath167 , and `` glueing '' yields the composite wave function at @xmath166 , @xmath168 given by eq .  ; and so on and so forth for all splitting times @xmath24 , until @xmath169 , where @xmath170 refers to the initial time . during the backward propagation ,",
    "as described above , the resulting co - state is stored in cis basis .",
    "it gives by construction , at an arbitrary time @xmath151 , the first term in eq .  .",
    "the second term in eq .   involving the outer parts `` born '' at the splitting times @xmath157 and evaluated at @xmath171",
    "is merely given by forward propagating analytically all @xmath172 using the volkov hamiltonian , and summing them up coherently according to eq .  .",
    "this allows to calculate the `` total '' co - state wavefunction at an arbitrary time @xmath151 , analogously to @xmath173 .",
    "finally , eqs .   and",
    "allow for evaluating krotov s update equation for the control , eq .  , where the iteration label just indicates whether the guess , @xmath174 , the old , @xmath175 , or the new control , @xmath176 , enter the propagation of @xmath177 and @xmath173 , respectively .",
    "a difficulty in solving the update equation for the control , is given by the fact that eq .",
    "is implicit in @xmath176 .",
    "strategies to overcome this obstacle depend on the additional constraints .",
    "implicitness of eq .   in @xmath176 for @xmath178 can easily be circumvented by a zeroth - order solution , employing two shifted time grids , one for the states ,  which are evaluated at @xmath179 ,   and another one for the control , which is evaluated at @xmath180  @xcite . however , for @xmath181 ,  eq .   corresponds to a second order fredholm equation with inhomogeneity @xmath182  @xcite .",
    "numerical solution is possible using , for example , the method of degenerate kernels  @xcite . to this end , the inhomogeneity @xmath182 , which depends on @xmath183 and thus on @xmath176 , is first approximated to zeroth order by solving eq .   with @xmath184",
    "that is ,  without frequency constraints ; and the resulting approximation @xmath185 is then used to solve the fredholm equation . while an iterative procedure to improve the approximation of @xmath182 is conceivable , the zeroth order approximation was found to be sufficient in refs .",
    "@xcite . here",
    ", we adopt a slightly different procedure ,  in the sense that the fredholm equation is not solved in time domain but in frequency domain .",
    "this allows us to treat the cases @xmath181 and @xmath186 on the same footing .",
    "it is made possible by assuming that @xmath84 in eqs .   and   rises and falls off very quickly at the beginning and end of the optimization time interval .",
    "this judicious choice of @xmath84 together with the fact that the fourier transform of a convolution of two functions in time domain , as encountered in eq .  , is the product of the functions in frequency domain , allows to approximate @xmath187 where @xmath188 is a small , positive number and @xmath189 is defined as @xmath190 a possible choice for @xmath84 to fulfill the condition   is @xmath191 where @xmath192 refers to the duration of the pulse centered at @xmath193 . if eq .",
    "is satisfied ,  we can easily take the fourier transform of both sides of eq .   to get    [ eq : newmethod ] @xmath194 with @xmath195 .",
    "note that eq",
    ".   becomes exact if @xmath84 is constant . approximating @xmath196 by its zeroth order solution analogously to ref .",
    "@xcite , eq .   can be expressed as @xmath197 where @xmath198 is the zeroth order solution of the updated control ,  found by solving eq .   with @xmath199 , @xmath200 and",
    "@xmath201 is a transfer function given by @xmath202      the complete implementation of the optimization within the time - splitting framework of the tdcis method is summarized as follows :    1 .",
    "choose an initial guess for the vector potential , @xmath203 .",
    "forward propagation of the state : 1 .",
    "propagate @xmath204 , cf .",
    "eq .  , from @xmath205 until the first splitting time , @xmath206 , in the cis basis .",
    "we label the projection of the propagated state onto the channel wavefunctions defined in eq .   by @xmath207 , while @xmath208 is reserved for the projection onto the hartree - fock ground state .",
    "2 .   at @xmath206 ,",
    "apply the splitting function defined in eq .   to obtain @xmath209 and @xmath210 .",
    "store the outer part in the cis representation , before transforming @xmath210 to the volkov representation .",
    "3 .   propagate @xmath209 using @xmath160 and @xmath210 using @xmath211 from @xmath206 to the next splitting time , @xmath212 .",
    "[ item : split ] at @xmath212 , apply the splitting function to @xmath213 , again store the resulting outer part in cis representation ,  and transform @xmath214 to the volkov representation .",
    "[ item : prop ] propagate @xmath213 using @xmath160 and @xmath215 using @xmath211 from @xmath212 to the next splitting time @xmath216 .",
    "repeat steps   and   for all remaining splitting times @xmath24 up to @xmath131 .",
    "propagate for each channel wave function ,  @xmath217 from the last splitting time , @xmath218 , to the final time , @xmath31 , to obtain @xmath219 and evaluate the target functional @xmath220 .",
    "calculate @xmath221 according to eq .  .",
    "[ item : backw ] backward propagation of the co - state : 1 .",
    "calculate @xmath222 according to eq .   or  .",
    "2 .   calculate @xmath223 from eq .   and propagate it backwards using @xmath160 from @xmath218 to the previous splitting time @xmath159 .",
    "the resulting state is @xmath162 .",
    "[ item : glue ] at @xmath161 , calculate @xmath224 from eq .   and glue to obtain @xmath225 .",
    "this procedure is performed in the cis basis for each channel wave function .",
    "[ item : bprop ] propagate @xmath163 from @xmath161 to @xmath226 using @xmath160 to obtain @xmath167 .",
    "5 .   repeat steps   and   for all remaining splitting times and propagate backward up to @xmath205 . during the backward propagation",
    ", the resulting wavefunction is stored in the cis basis .",
    "as previously detailed , this procedure allows for performing the `` glueing '' procedure only once at every splitting time .",
    "it gives gives rises to the first term in eq .  .",
    "the second term involving the evaluation of the outer part ( coherent summation ) at any arbitrary time @xmath151 is obtained upon application eq .",
    "to each of the individual contribution @xmath172 for all splitting times .",
    "[ item : forw ] forward propagation and update of control : 1 .",
    "determine the zeroth order approximation of the new control at times @xmath180 , @xmath227 , from eq .",
    ", using the states at times @xmath179 , i.e. , the co - state obtained in step  [ item : backw ] , @xmath228 and @xmath229 obtained with the control @xmath230 .",
    "2 .   if @xmath181 or @xmath186 , solve eq .   to obtain @xmath231 , using the approximated @xmath232 , and fourier transform @xmath231 to time domain .",
    "increase @xmath98 by one and repeat steps  [ item : backw ] and  [ item : forw ] until convergence of @xmath220 is reached .    at this point",
    ", we would like to stress that the parameters chosen for the momentum grid require particular attention for the optimization algorithm to work .",
    "this is due to the transformation from the cis representation to the volkov basis ( cis  to@xmath233 transformation ) at each splitting time , as discussed in section  [ subsec : wfsm ] . during the backward propagation ,",
    "correspondingly , the inverse transformation is required , i.e. , the @xmath233to  cis transformation .",
    "to@xmath233 transformation of the outer part is evaluated using eq .  ; the inverse of this transformation is straightforwardly derived . since the dynamics is reversible , forward propagation ( involving wavefunction splitting and the cis  to@xmath233 transformation )",
    "needs to give identical results to backward propagation ( involving wavefunction `` glueing '' and the @xmath233to  cis transformation ) .",
    "this can and needs to be used to check the numerical accuracy of the cis  to@xmath233 transformation and its inverse : since the inverse transformation involves integration over @xmath32 , a significant error is introduced if the sampling of the momentum grid is insufficient .",
    "consequently , transforming the outer part from the cis representation to the volkov basis and then back may not yield exactly the same wave function . while for each @xmath233to  cis transformation the error may be relatively small , it accumulates as the optimization proceeds iteratively according to eq .  .",
    "it results in optimized pulses with non - physical and undesirable `` jumps '' at those splitting times where the accuracy of the @xmath233to  cis transformation is insufficient and destroys the monotonic convergence of the optimization algorithm .",
    "the jumps disappear when the number of the momentum grid points is increased and @xmath234 is adjusted .",
    "therefore , a naive solution to this problem would be to considerably enlarge the number of momentum grid points .",
    "however , this will significantly increase the numerical effort of the optimization , i.e. , evaluation of the inner product in the rhs . of eq .",
    "the inner product involves not only calculation of the overlap of the inner part in the cis representation and the outer part in the volkov basis but it also requires evaluation of the mixed terms , @xmath235 and @xmath236 and thus one cis  to@xmath233 transformation and integration over two  perhaps even three  degrees of freedom at every time @xmath151 , for each channel @xmath3 and in every iteration step @xmath109 .",
    "thence , finding the best balance between efficiency and accuracy in the @xmath233to  cis transformation is essential for the proper functioning and feasibility of the optimization calculations . also , reducing the total size of the radial coordinate while simultaneously increasing the number of splitting times translates into a more important number of evaluations of the inner product defined in eq .   in momentum representation .",
    "below , we state explicitly the momentum grid parameters utilized in our simulations which allowed for a good compromise between efficiency and accuracy .",
    "we consider , as a first example , the optimization of the complete photoelectron distribution , cf .",
    "eq .  , for a hydrogen atom .",
    "the wavepacket is represented , according to eq .  , in terms of the ground state @xmath237 and excitations @xmath238 .",
    "the calculations employed a pseudo - spectral grid with density parameter @xmath239  @xcite , a spatial extension of @xmath240a.u . and 800 grid points .",
    "all optimization calculations employed a linearly polarized electric field along the @xmath241 axis .",
    "this translates into a rotational symmetry of the photoelectron distribution along the @xmath241 axis .",
    "therefore , only wave functions of the form @xmath242 need to be considered . for the calculation of the spectral components ,",
    "the outer parts of the wave functions were projected onto the volkov basis , defined on a spherical grid in momentum representation @xmath32 . for our calculations , we adopted an evenly spaced grid in @xmath233 as well as in the polar coordinate @xmath243 .",
    "the size of the radial component of the spherical momentum grid was set to @xmath244a.u .",
    ", sampled at @xmath245 points .",
    "the same number of points was utilized for the polar coordinate .",
    "the splitting radius was set to @xmath246a.u . , the total number of splitting times is @xmath247 with a smoothing parameter @xmath248a.u .",
    "the splitting procedure was applied every @xmath249a.u . of time . finally , a total integration time of @xmath250a.u . with a time step of @xmath251a.u .",
    "was utilized for the time propagation .         chosen to start the optimization shown in fig .",
    "[ fig : func1_iterations ] and ( b ) optimized electric field obtained after about 700 iterations .",
    "( c ) the final time cost functional @xmath252 decreases monotonically , as expected for krotov s method . ]",
    "we consider first the minimization of the functional @xmath253 $ ] defined in eq .  .",
    "the goal is to find a vector potential @xmath254 such that the photoelectron distribution resulting from the electron dynamics generated by @xmath254 coincides with @xmath255 at every point @xmath32 , cf .",
    "for visualization convenience , we plot the angle - integrated pes and energy - integrated pad , cf .",
    "eq .  , associated to `` target '' photoelectron distribution @xmath255 , as shown by the solid - black lines in figs .",
    "[ fig : func1_iterations](a ) and  [ fig : func1_iterations](b ) , respectively . to simplify the optimization , neither frequency restriction nor amplitude constraint on @xmath256",
    "is imposed , i.e. , @xmath178 . the initial guess for the vector potential",
    "is chosen in such a way that the fidelity with respect to the target @xmath255 is poor , see the green dashed lines in fig .  [ fig : func1_iterations ] . despite the bad initial guess",
    ", the optimization quickly approaches the desired photoelectron distribution , converging monotonically , as expected for krotov s method and demonstrated in fig .",
    "[ fig : func1_combined_1](c ) : after about 700 iterations , the target distribution is realized with an error of 2% .",
    "the reason for such a large number of iterations can be understood by considering that the optimized photoelectron distribution must coincide ( point - by - point ) with a two - dimensional target object .",
    "this represents a non - trivial optimization problem .",
    "the optimized electric field is shown in fig .",
    "[ fig : func1_combined_1](b ) : compared to the initial guess , cf . fig .",
    "[ fig : func1_combined_1](a ) , the amplitude of the optimized field is somewhat increased , and a high - frequency oscillation has been added . the monotonic convergence towards the target distribution in terms of angle - integrated pes and energy - integrated pad is illustrated in fig .  [ fig : func1_iterations ] .",
    "we can appreciate that the algorithm first tends to match all points with higher values , starting with the peak near 15@xmath257ev , while adjusting the remainder of the spectrum , with lower values , later in the optimization . the slow - down of convergence , observed in fig .",
    "[ fig : func1_combined_1](c ) after about 200 iterations , is typical for optimization methods that rely on gradient information alone : as the optimum is approached , the gradient vanishes  @xcite .",
    "such a slow - down of convergence can only be avoided by incorporating information from higher order derivatives in the optimization .",
    "this is rather non - trivial in the framework of krotov s method  @xcite and beyond the scope of our current study .",
    "as a second application of our control toolbox , we are interested in minimizing the probability of emission into the upper hemisphere without imposing any specific constraint on the number of electrons emitted into the lower hemisphere . the final time",
    "cost functional is given by eq .",
    "with @xmath258 and @xmath259 .",
    "we consider again a hydrogen atom and a linearly polarized electric field along the @xmath241-axis , using the same numerical parameters as in section  [ sec : appl1 ] .        .",
    "[ fig : appl2:angle ]    . also for this target functional , eq .",
    ", monotonic convergence of the optimization algorithm is achieved ( c ) . ]    in contrast to the example discussed in section  [ sec : appl1 ] , no particular expression for the target pes and pad needs to be imposed ",
    "we only require the probability of emission into the upper hemisphere to be minimized regardless of the actual shape of angle - integrated pes and energy - integrated pad .",
    "we employ the optimization prescription described in section  [ subsec : krotov ] using eq .   in the final time condition for the adjoint state .",
    "as the optimization proceeds iteratively , the energy - integrated pad becomes more and more asymmetric , see fig .",
    "[ fig : appl2:angle ] , minimizing emission into the upper hemisphere , as desired .",
    "the guess and optimized pulses are shown in fig .",
    "[ fig : combined_zero1](a ) and  ( b ) . as illustrated by the solid green line in fig .",
    "[ fig : appl2:angle ] , the guess field was chosen such that it leads to a symmetric probability of emission for the two hemispheres . again",
    ", monotonic convergence of the final time cost functional is achieved , cf .",
    "[ fig : combined_zero1](c ) . at the end of the iteration procedure",
    ", the probability of emission into the upper hemisphere vanishes completely . as for the lower hemisphere",
    ", the emission probability initially remains almost invariant as the algorithm proceeds iteratively , see fig .",
    "[ fig : appl2:angle ] , while the probability of emission into the upper hemisphere decreases very fast , and monotonically , as expected .",
    "however , for a large number of iterations , the probability of emission into the lower hemisphere starts to decrease as well .",
    "after about 150 iterations it reaches an emission probability of @xmath260 , that is two orders of magnitude smaller than for the guess pulse .",
    "although our goal is only for the probability of emission into the upper hemisphere to be minimized , without specific constraints on the probability of emission into the lower hemisphere , the current results are completely consistent in terms of the optimization problem .",
    "more precisely , the optimization does exactly what the functional @xmath261 , eq .   with @xmath258 and @xmath259 , targets .",
    "in fact , since the target functional depends on the upper hemisphere alone , then , by construction , the algorithm calculates the corrections to the field according to eq .  , regardless of how these changes affect the probability of emission into the lower hemisphere . to keep the probability of emission into the lower hemisphere constant or to maximize it ,",
    "an additional optimization functional is required .",
    "this is investigated in the following section and defines the motivation for the maximization of the anisotropy of emission discussed in the following lines .",
    "finally we maximize the difference in probability for emission into the upper and the lower hemispheres . to this end",
    ", we construct the final - time cost functional such that it maximizes emission into the upper hemisphere while simultaneously minimizing emission into the lower hemisphere .",
    "this is expressed by the functional   where both weights are non - zero and have different signs , @xmath262 and @xmath263 .",
    "the signs correspond to maximization and minimization , respectively .",
    "we consider this control problem for two different atoms  hydrogen as a one - channel case and argon as an example with three active channels  @xcite .",
    "the latter serves to underline the appropriateness of our methodology for quantum control of multi - channel problems .",
    "furthermore , in order to demonstrate the versatility of our optimal control toolbox in constraining specific properties of the optimized electric field , we consider the following options : ( i ) a spectral constraint , i.e. , @xmath181 in eq .  , and",
    "( ii ) the constraint to minimize fast changes in the vector potential , with @xmath186 in eq .  .",
    "the latter is equivalent to avoiding large electric field amplitudes .      )",
    "increases significantly as the optimization proceeds .",
    "although the probability for emission with angles ( @xmath264 ) also grows somewhat , the overall difference increases . the energy - integrated pad obtained with the guess pulse",
    "is shown in ( b ) .",
    "note the different y - axis scales in ( a ) and ( b ) . ]    , for the optimization shown in fig .",
    "[ fig : h_pes ] , measuring the difference in probability for emission into upper and lower hemisphere increases monotonically with ( @xmath265 ) and without ( @xmath266 ) spectral constraint ( a ) . the guess field ( green line )",
    "is shown in ( b ) together with the shape function @xmath84 used in both optimizations . the optimized field obtained with the spectral constraint",
    "is displayed in ( c ) . ]     and  [ fig : h_bdw1 ] with ( b ) and without ( a ) spectral constraint .",
    "the corresponding penalty function @xmath267 and transfer function @xmath201 , cf .",
    "eqs .   and  ,",
    "are shown in ( c ) and ( d ) , respectively . ]",
    "we consider a hydrogen atom , interacting with an electric field linearly polarized along the @xmath241-axis , using the same numerical parameters as in sec .",
    "[ sec : appl1 ] .",
    "the optimization was carried out with and without restricting the spectral bandwidth of @xmath268 .",
    "figure  [ fig : h_pes](b ) displays the symmetric energy - integrated pad obtained with the gaussian guess field , shown in fig .",
    "[ fig : h_bdw1](b ) , for which a central frequency @xmath269ev was used . for the optimization with spectral constraint ,",
    "the admissible frequency components for @xmath268 are chosen such that @xmath270 with @xmath271a.u.@xmath272ev .",
    "this requirement translates into the penalty function @xmath273 shown in fig .",
    "[ fig : frequency_components](c ) , for which we have used the form @xmath274 where the parameters @xmath275 , @xmath276 and @xmath277 must be chosen such that the term @xmath278 in the functional @xmath87 $ ] in eq",
    ".   takes very large values in the region of undesired frequencies . for our first example",
    ", @xmath279 , @xmath280 and @xmath281 allows for strongly penalizing , and therefore filtering all undesirable frequency components above @xmath282 , as it is shown by the corresponding transfer function @xmath201 , cf .",
    "[ fig : frequency_components](d ) .",
    "note that it is not the weight @xmath283 alone that determines how strictly the spectral constraint is enforced ; it is the ratio @xmath284 that enters in the transfer function @xmath201 .",
    "this reflects the competition of the different terms in the complete optimization functional , eq .  .    as in the previous two examples",
    ", the optimization approach developed leads to monotonic convergence of the target functional , eq .  , with and without spectral constraint",
    "this is illustrated in fig .",
    "[ fig : h_bdw1](a ) . even though the spectra of the fields optimized with and without spectral constraint , are completely different , cf .",
    "[ fig : frequency_components](a ) and  ( b ) , the speed of convergence is roughly the same , and the maximum values for @xmath139 reached using both fields are also very similar , cf .",
    "[ fig : h_bdw1](a ) .",
    "this means that the algorithm finds two distinct solutions .",
    "such a finding is very encouraging as it implies that the spectral constraint does not put a large restriction onto the control problem .",
    "in other words , more than one , and probably many , control solutions exist , and it is just a matter of picking the suitable one with the help of the additional constraint .",
    "it also implies that most of the frequency components in the spectrum of the field optimized without spectral constraint are probably not essential .",
    "this is verified by removing the undesired spectral components in fig .",
    "[ fig : frequency_components](a ) , using the same transfer function utilized for the frequency - constrained optimization shown in fig .",
    "[ fig : frequency_components](d ) .",
    "the energy - integrated pad obtained with such a filtered optimized pulse remains asymmetric , and the value of the target functional @xmath139 is decreased by only about 10 per cent .",
    "the peak amplitude of the optimized field is about one order of magnitude larger than that of the guess field , cf .",
    "[ fig : h_bdw1](b ) and  ( c ) .",
    "the increase in peak amplitude is connected to the gain in emission probability for the northern hemisphere by almost three orders of magnitude .",
    "the optimized pulse thus ionizes much more efficiently than the guess pulse .    ) and without ( @xmath184 ) frequency restriction ( a ) where the red curve shows the same data as in fig .",
    "[ fig : h_bdw1](c ) . also compared are the energy - integrated pad ( b ) and total emission probability ( c ) obtained with the frequency - constrained and unconstrained optimized fields . ]",
    "figure  [ fig : h_contrast](a ) compares the electric fields optimized with and without spectral constraints  a huge difference is observed for the two fields .",
    "while the electric field optimized without spectral constraint presents very sharp and high peaks in amplitude , beyond experimental feasibility , the frequency - constrained optimized field is characterized by reasonable amplitudes and a much smoother shape .",
    "the frequency components of the unconstrained field shown in fig .",
    "[ fig : frequency_components](a ) now become clear .",
    "note that the difference in amplitude only appears during the first half of the overall pulse duration , see fig .",
    "[ fig : h_contrast](a )",
    ". it is a known feature of krotov s method to favor changes in the field in an asymmetric fashion ; the feature results from the sequential update of the control , as opposed to a concurrent one  @xcite .",
    "figure  [ fig : h_contrast](b ) shows the energy - integrated pad obtained upon propagation with the two fields .",
    "one notes that , although the probability of emission into the lower hemisphere is larger for the unconstrained than for the constrained field , the same applies to the probability of emission into the upper hemisphere .",
    "therefore the difference in the number of electrons emitted into upper and lower hemisphere is in the end relatively close , which explains the behavior of the final - time functional observed in fig .",
    "[ fig : h_bdw1](a ) .",
    "the electron dynamics generated by the frequency - unconstrained field leads to a larger total probability of emission into both hemispheres , with respect to that obtained with the frequency - constrained field , as shown in fig .",
    "[ fig : h_contrast](c )",
    ". more precisely , propagation with the unconstrained optimized field results in a total probability of emission of @xmath285 , i.e. , probabilities of @xmath286 and @xmath287 for emission into the upper and lower hemisphere , respectively . in comparison , a total probability of emission of @xmath288 is obtained for the frequency - constrained field , with probabilities of emission into the upper and lower hemispheres of @xmath289 and @xmath290 , respectively .",
    "the fact that the spikes observed in the unconstrained optimized field do not have any significant impact on the asymmetry of the pad can be rationalized by the short timescale on which the intensity is very high .",
    "this time is too short for the electronic system to respond to the rapid variations of the field amplitude .    in order to rationalize how anisotropy of electron emission is achieved by the optimized field ,",
    "we analyze in fig .",
    "[ fig : anto2_v2 ] the partial wave decomposition of the angle - integrated pes , comparing the results obtained with the guess field to those obtained with the frequency - constrained optimized field . inspection of fig .",
    "[ fig : anto2_v2 ] reveals that upon optimization , there is a clear transition from distinct ati peaks , fig .",
    "[ fig : anto2_v2](a ) , to a quasicontinuum energy spectrum , fig .",
    "[ fig : anto2_v2](b ) .",
    "also , the optimized field enhances the contribution of states of higher angular momentum that have the same kinetic energy .",
    "in particular , the peaks for @xmath291 are dramatically higher than in the pes obtained with the guess field .",
    "in fact , the symmetric case , cf . fig .",
    "[ fig : anto2_v2](a ) , shows an energy distribution of partial waves characterized by waves of the same parity at the same energy , whereas the asymmetric case reveals a partial wave distribution of opposite parity at the same energy , cf .",
    "[ fig : anto2_v2](b ) . figure  [ fig : anto2_v2 ] thus demonstrates that the desired asymmetry in the energy - integrated pad is achieved through the mixing of various partial waves of opposite parity at the same energy .",
    "interestingly , especially lower frequencies are mixed with a considerable intensity into the pulse spectrum which leads to higher order multiphoton ionization leading to comparable final energies in the pes .",
    "thus , more angular momentum states are mixed .",
    ", obtained with the guess ( a ) and the frequency - constrained optimized field ( b ) . ]",
    "next , we would like to constrain not only the frequency components but also the maximal field amplitude , as the maximal field amplitude of the electric field , shown in fig .  [",
    "fig : h_bdw1](c ) is still important . to this end , we employ eq .   for @xmath292 , which penalizes large changes on the derivative of the vector potential , cf .",
    "eq .  , and thus large values of the electric field amplitude .",
    "as can be seen in fig .",
    "[ fig : newh1](a ) , the resulting optimized field is one order of magnitude smaller than that for which no amplitude restriction was imposed , cf . fig .",
    "[ fig : h_bdw1](c ) , and of the same order of magnitude as the guess field . despite the constraint and as shown in fig .",
    "[ fig : newh1](c ) , a perfect top - bottom asymmetry is obtained .     with @xmath293 .",
    "a perfect anisotropy of emission is obtained . ]    a common feature observed between the amplitude - unconstrained and constrained cases concerns the low frequencies appearing upon optimization , cf .",
    "[ fig : frequency_components](b ) and fig .",
    "[ fig : newh1](b ) , respectively . to quantify the role of the frequency components for achieving anisotropy ,",
    "we start by suppressing all frequency components above @xmath294 ev : the anisotropy of emission is preserved . on the other hand ,",
    "removing frequencies below the xuv re - establish the initial symmetry of emission into both hemispheres .",
    "therefore , in both cases the top - bottom asymmetry arises from low frequency components of the optimized field and is achieved through the mixing of various partial waves of opposite parity at the same energy .",
    "we extend now our quantum control multi - channel approach to the study of electron dynamics in argon , interacting with an electric field linearly polarized along the @xmath241-direction .",
    "we consider the @xmath295 and @xmath296 orbitals to contribute to the ionization dynamics and define three ionization channels @xmath295 , @xmath296 with @xmath297 and @xmath296 with @xmath298 ( the case @xmath296 with @xmath299 is symmetric to @xmath298 due to the polarization direction of the electric field , linearly polarized along to the @xmath241 axis ) . in order to describe the multi - channel dynamics , a spatial grid of @xmath300a.u . with @xmath301 grid points and a density parameter of @xmath302",
    "was utilized .",
    "the size of the radial component of the spherical momentum grid was set to @xmath303a.u .",
    ", sampled by @xmath304 evenly spaced points , while the polar component @xmath144 $ ] was discretized using @xmath245 points . a splitting radius of @xmath246 a.u . , and a smoothing parameter @xmath305a.u . were employed , together with a splitting step of @xmath306a.u . and a total number of @xmath307 splitting times . for time propagation",
    ", the time step was chosen to be @xmath308a.u .",
    ", for an overall integration time @xmath309a.u .         and @xmath293 in ( b ) and ( c ) , respectively .",
    "note the different scales for the probability of emission . ]",
    "analogously to the results shown for hydrogen in sec .",
    "[ subsec : appl3:h ] , the goal is to maximize the difference in the probability for electron emission into the upper and lower hemispheres . to start the optimization , a gaussian - shaped guess electric field with central frequency @xmath310ev and maximal amplitude @xmath311gv / m was chosen . it is depicted in fig .  [ fig : newargon1](a ) and yields a symmetric distribution for the upper and lower hemispheres , see fig .",
    "[ fig : newargon2](a ) .",
    "the total emission probability amounts to only @xmath312 . in order to obtain reasonable pulses",
    "which result in a maximally anisotropic pad , we utilize eq .   with @xmath313 to minimize fast changes in the vector potential and avoid large peaks of the electric field amplitude .",
    "the optimized pulses for two values of the ratio @xmath314 , charaterizing the relative weight of minimizing peak values in the electric field compared to minimizing the integrated vector potential , are shown in figs .",
    "[ fig : newargon1](b ) and ( c ) , respectively . as expected , a larger amplitude constraint yields an electric field with a smaller maximal amplitude .",
    "in fact , the maximal amplitude for @xmath315 is one order of magnitude larger than that of the guess field , whereas for @xmath316 it is only three times larger .",
    "figures  [ fig : newargon2](b ) and ( c ) display the energy - integrated pads obtained with these fields . a significant top - bottom asymmetry of emission is achieved in both cases , the main difference being the total emission probability of @xmath317 for fig .",
    "[ fig : newargon2](b ) compared to @xmath318 for fig .",
    "[ fig : newargon2](c ) .",
    "the spectra of the two optimized fields are examined in fig .",
    "[ fig : spectra_argon ] . despite the difference in amplitude , both optimized fields are characterized by low frequency components .",
    "note that no frequency restriction was imposed .",
    "this finding suggests that the low frequency components are responsible for achieving the top - bottom asymmetry .",
    "indeed , removing all optical and infra - red ( ir ) components results in a complete loss of the asymmetry . on the other hand , removing frequency components above @xmath319ev does not affect the top - bottom asymmetry achieved by both optimized fields considerably .",
    "these optimization results raise the question whether frequency components in the optical and ir range are essential for achieving the top - bottom asymmetry or whether a pure xuv field can also realize the desired control . to answer this question ,",
    "we now penalize all frequency components in the optical and ir region .",
    "the resulting optimized electric field and its spectrum are depicted in fig .",
    "[ fig : xuv_optim](a ) and ( b ) , respectively .",
    "this field indeed possesses frequency components only in the xuv region , cf .",
    "[ fig : xuv_optim](b )",
    ". nevertheless , a strongly asymmetric top - bottom emission is again achieved , cf .",
    "[ fig : xuv_optim](c ) .",
    "therefore , while optical or ir excitation may significantly contribute to achieving anisotropy of the photoelectron emission , fields with frequency components in the xuv alone may also lead to such an asymmetry .     and @xmath320 with a penalty function @xmath321 with @xmath322 , @xmath323 ev , @xmath324 and @xmath325 were utilized , cf .",
    "the quantity @xmath326 has been introduced in order to avoid numerical instabilities when evaluating the transfer function @xmath201 , cf .",
    "]    finally , we would like to understand the physical mechanism from which the anisotropy in the emission into both hemispheres arises . to this end , we consider the partial wave decomposition of the angle - integrated pes .",
    "analogously to our analysis for hydrogen , cf .",
    "section  [ subsec : appl3:h ] , a symmetric pad , as obtained with the guess field , is characterized by an energy distribution of partial waves of the same parity at the same energy , cf .",
    "[ fig : argon_partial](a ) .",
    "in contrast , the partial wave decomposition corresponding to the asymmetric pad reveals an energy distribution of partial waves of different parity at the same energy , cf .",
    "[ fig : argon_partial](b ) , [ fig : argon_partial2](a ) . for the optimized fields with significant optical and ir components , many partial waves , including those with high angular momentum , contribute to the angle - integrated pes .",
    "this suggests that the top - bottom anisotropy of photoelectron emission is achieved by absorbing low - energy photons at relatively high intensity which is accompanied by strong mixing of a number of partial waves of opposite parity at the same energy .",
    "the same mechanism had previously been found for hydrogen , cf .",
    "section  [ subsec : appl3:h ] .     obtained with the guess ( a ) and the amplitude - constrained optimized field corresponding to the ratio @xmath315 in ( b ) . ]",
    "( c ) obtained amplitude - constrained optimized field for the ratio @xmath316 and that corresponding to the pad shown in fig .",
    "[ fig : xuv_optim](c ) obtained with the optimized xuv pulse in pannels ( a ) and ( b ) , respectively . ]    as for the optimized xuv electric field yielding an asymmetric probability for emission , shown in fig .  [",
    "fig : xuv_optim](c ) , the same mechanism involving mixing of partial waves of different parity at the same energy is found , cf . fig .  [",
    "fig : argon_partial2](b ) .",
    "nevertheless , a much smaller number of partial waves is involved , cf .",
    "[ fig : argon_partial2](a ) and ( b ) . for the xuv pulse ( fig .",
    "[ fig : xuv_optim](b ) ) , it is mainly the components of the continuum wavefunction with angular momentum @xmath327 and @xmath328 that contribute to the anisotropy of emission .",
    "the reason why partial waves with different parity are always present for anisotropic photoelectron emission can be straightforwardly understood .",
    "it lies in the fact that the angular distribution arises from products of spherical harmonics , cf .",
    "eqs .  , and , and",
    "the product of two spherical harmonics with the same ( opposite ) parity is a symmetric ( antisymmetric ) function of @xmath243 .",
    "the optimized pulses take advantage of this property and realize the desired asymmetry by driving the dynamics in such a way that it results in partial wave components which interfere constructively ( destructively ) in the upper ( lower ) hemisphere .",
    "we have also investigated whether channel coupling plays a role in the generation of the anisotropy . while switching off the interchannel coupling in the dynamics under the optimized pulse shown in fig .",
    "[ fig : xuv_optim](a ) decreases the resulting anisotropy slightly , overall it still yields an anisotropic pad .",
    "this shows that interchannel coupling in argon is not a key factor in achieving top - bottom asymmetry in photoelectron angular distributions .",
    "to summarize , we have developed a quantum optimal control toolbox to target specific features in photoelectron spectra and photoelectron angular distributions that result from the interaction of a closed - shell atom with strong xuv radiation . to this end , we have combined krotov s method for quantum control  @xcite with the time - dependent configuration interaction singles approach to treat the electron dynamics  @xcite and the wave - function splitting method to calculate photoelectron spectra  @xcite .",
    "we have presented here the algorithm and its implementation in detail . to the best of our knowledge ,",
    "our work is the first to directly target photoelectron observables in quantum optimal control .",
    "we have utilized this toolbox to identify , for the benchmark systems of hydrogen and argon atoms , photoionization pathways which result in asymmetric photoelectron emission .",
    "our optimization results show that efficient mechanisms for achieving top - bottom asymmetry exist in both single - channel and multi - channel systems .",
    "we have found the channel coupling to be beneficial , albeit not essential for achieving asymmetric photoelectron emission . since typically the solution to a quantum control problem is not unique , additional constraints are useful to ensure certain desired properties of the control fields , such as limits to peak amplitude and spectral width .",
    "we have demonstrated how such constraints allow to determine solutions characterized by low or high photon frequency . in the low frequency regime ,",
    "our control solutions require relatively high intensities .",
    "correspondingly , the anisotropy of the photoelectron emission is realized by strong mixing of many partial waves .",
    "in contrast , for pure xuv pulses , we have found low to moderate peak amplitudes to be sufficient for asymmetric photoelectron emission . in both cases ,",
    "we have identified the top - bottom asymmetry to originate from mixing , in the photoelectron wavefunction , various partial waves of opposite parity at the same energy . the corresponding constructive ( destructive ) interference pattern in the upper ( lower ) hemisphere yields the desired asymmetry of photoelectron emission .",
    "whereas many partial waves contribute for control fields characterized by low photon energy and high intensity , interference of two partial waves is found to be sufficient in the pure xuv regime . in all our examples ,",
    "we have found surprisingly simple shapes of the optimized electric fields . in the case of hydrogen ,",
    "tailored electric fields to achieve asymmetric photoelectron emission have been discussed before and we can compare our results to those of refs .  @xcite .",
    "our work differs from these studies in that we avoid a parametrization of the field and allow for complete freedom in the change the electric field , whereas refs .",
    "@xcite considered only the carrier - envelope phase , intensity and duration of the pulse as control knobs .",
    "the additional freedom of quantum optimal control theory is important , in particular when more complex systems are considered .",
    "the set of applications that we have presented here is far from being exhaustive , and our current work opens many perspectives for both photoionization studies and quantum optimal control theory . on the one hand , we have shown how to develop optimization functionals that target directly an experimentally measurable quantity obtained from continuum wavefunctions .",
    "on the other hand , since our approach is general , it can straightforwardly be applied to more complex examples . in this respect",
    "it is desirable to lift the restriction to closed - shell systems",
    ". this would pave the way to studying the role of electron correlation in maximizing certain features in the photoelectron spectrum .",
    "similarly , allowing for circular or elliptic polarization of the electric field , one could envision , for example , to maximize signatures of chirality in the photoelectron angular distributions .",
    "this requires , however , substantial further development on the level of the time - dependent electronic structure theory .    financial support by the state hessen initiative for the development of scientific and economic excellence ( loewe ) within the focus project electron dynamic of chiral systems ( elch ) and the deutsche forschungsgemeinschaft under grant no .",
    "sfb 925/a5 is gratefully acknowledged .",
    "in the following , we present the derivation of krotov s update equation for the control , eq .   using the approximation for @xmath84 previously described .",
    "this allows for a more compact expression for krotov s equation for the specific constraints on the field used in this work .",
    "it is obtained following ref .",
    "@xcite : we seek to minimize the complete functional , eq .  . in order to evaluate the extremum condition ,",
    "we start by evaluating the functional derivative of the penalty functional with respect to the changes in the control field @xmath47 in eq .",
    ", @xmath329}{\\delta\\mathbf{a}(t ) } & = & 2\\lambda_a s^{-1}(t )    \\left(\\mathbf{a}(t)- \\mathbf{a}_{\\rm ref}(t)\\right ) .",
    "\\label{eq : tchikonovca}\\end{aligned}\\ ] ] next , we evaluate the functional derivative of eq .  .",
    "abbreviating @xmath330 by @xmath331 in eq .  , the functional derivative reads @xmath332}{\\delta\\mathbf{a}(t ) } & = &    \\lambda_{\\omega } \\int   \\mathbf{a}^{\\star}(\\omega)\\dfrac{\\delta\\tilde{\\mathbf{a}}(\\omega)}{\\delta     \\mathbf{a}(t)}\\tilde{h}(\\omega)\\,d\\omega \\nonumber \\\\     & & + \\lambda_{\\omega } \\int     \\tilde{\\mathbf{a}}(\\omega)\\dfrac{\\delta\\tilde{\\mathbf{a}}^{\\star}(\\omega)}{\\delta       \\mathbf{a}(t)}\\tilde{h}(\\omega)\\,d\\omega\\ , .",
    "\\label{eq : omega0}\\end{aligned}\\ ] ] using the fact that @xmath333 is the fourier transform of @xmath47 , @xmath334 the functional derivative becomes , @xmath335 such that @xmath336}{\\delta\\mathbf{a}(t ) } & = &   \\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}^{\\star}(\\omega)e^{-i\\omega t}\\tilde{h}(\\omega)\\,d\\omega\\nn\\\\   & & + \\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}(\\omega ) e^{+i\\omega t}\\tilde{h}(\\omega)\\,d\\omega\\,\\nn\\,.\\end{aligned}\\ ] ] this can be rewritten as @xmath337}{\\delta\\mathbf{a}(t ) } & = &    \\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}^{\\star}(-\\omega)e^{+i\\omega t}\\tilde{h}(-\\omega)\\,d\\omega\\nn\\\\ & & + \\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}(\\omega ) e^{+i\\omega t}\\tilde{h}(\\omega)\\,d\\omega\\,.\\end{aligned}\\ ] ] since the control @xmath47 is a real function of time , @xmath338 .",
    "moreover , by construction @xmath339 . therefore , eq .   becomes @xmath340}{\\delta\\mathbf{a}(t ) } & = &    2\\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}(\\omega)e^{+i\\omega t}\\tilde{h}(\\omega)\\,d\\omega \\\\ & = & 2\\lambda_{\\omega}\\int \\tilde{\\mathbf{a}}(\\omega)e^{i\\omega t}d\\omega\\int h(\\tau)e^{-i\\omega\\tau}\\,d\\tau\\nonumber\\\\ & = & 2\\lambda_{\\omega}\\int h(\\tau)d\\tau\\int \\tilde{\\mathbf{a}}(\\omega ) e^{+i\\omega(t-\\tau)}d\\omega \\nonumber\\\\ & = & 2\\tilde{\\lambda}_{\\omega}\\int h(\\tau)\\mathbf{a}(t-\\tau)d\\tau = 2\\tilde{\\lambda}_{\\omega}\\mathbf{a}\\star h(t)\\ , , \\nonumber\\end{aligned}\\ ] ] with @xmath100 , and @xmath341 and where @xmath342 refers to the convolution product of @xmath343 and @xmath344 .",
    "we now calculate the functional derivative of the constraint penalizing large values of @xmath345 , eq .  .",
    "assuming vanishing boundary conditions for @xmath47 , we find , upon integration by parts , @xmath346}{\\delta\\mathbf{a}(t ) } & = & -2\\lambda_e    s^{-1}(t)\\ddot{\\mathbf{a}}(t)\\ , .",
    "\\label{eq : tchikonov2}\\end{aligned}\\ ] ] using eqs .",
    ",   and  , the extremum condition with respect to a variation in the control becomes @xmath347 where the last term has been previously introduced in eq .  .",
    "it can be straightforwardly derived from variational principles , ie .",
    "euler - lagrange lagrange equation , or in the context of pontriagin s maximum / minimum principle or in the context of krotov s optimization method , cf",
    "it stresses the dynamics to which the forward propagated state is subject to .",
    "solving for @xmath95 gives us the update rule for the optimized pulse , @xmath348 i.e. , we retrieve eq .  .",
    "using the property @xmath349 together with eq .   for @xmath84 ,",
    "it is straighforward to write krotov s equation in frequency domain . to this end",
    ", we merely take the fourier transform of eq .   and utilize the well - known property that the fourier transform of a convolution of two functions in time domain is the product of the functions in frequency domain .",
    "we thus find @xmath350 which yields eq .  ."
  ],
  "abstract_text": [
    "<S> photoelectron spectra and photoelectron angular distributions obtained in photoionization reveal important information on e.g. charge transfer or hole coherence in the parent ion . here </S>",
    "<S> we show that optimal control of the underlying quantum dynamics can be used to enhance desired features in the photoelectron spectra and angular distributions . to this end , we combine krotov s method for optimal control theory with the time - dependent configuration interaction singles formalism and a splitting approach to calculate photoelectron spectra and angular distributions </S>",
    "<S> . the optimization target can account for specific desired properties in the photoelectron angular distribution alone , in the photoelectron spectrum , or in both . </S>",
    "<S> we demonstrate the method for hydrogen and then apply it to argon under strong xuv radiation , maximizing the difference of emission into the upper and lower hemispheres , in order to realize directed electron emission in the xuv regime . </S>"
  ]
}