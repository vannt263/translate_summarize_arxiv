{
  "article_text": [
    "as a neutrino propagates through matter the non - zero density modulates the flavor oscillations of the neutrino wavefunction .",
    "the evolution of the wavefunction differs from that in vacuum with the consequnce that neutrino flavour transformation may be enhanced .",
    "appreciation of this effect , first discussed by mikheyev & smirnov and wolfenstein , is particularly important when the source of neutrinos is buried deep within dense matter such as those one can find in astrophysical settings .",
    "indeed , this transformation was first invoked to resolve the discrepancy between the observed and predicted detection rates of solar electron neutrinos @xcite and the most compelling experimental evidence for this effect has come from the sudbury neutrino observatory which is capable of measuring the @xmath1 or @xmath2 flavor content of the neutrinos initially produced in the center of the sun as electron type @xcite . in the same fashion , the flavor content of neutrinos emitted from the neutrinosphere in a proto - neutron star will be altered by their propagation through the overlying progenitor material @xcite and it is also apparent that understanding the matter effect of the earth is crucial for interpreting any future long baseline experiment , see e.g. @xcite .    for each of these situations one is provided with the initial state of the neutrino at the source and wishes to determine the flavor content of the wavefunction after it has passed through the intervening material .",
    "gauging the matter effects means possessing a suitable calculational tool .",
    "the most obvious point of departure for such a calculation is the schrodinger equation .",
    "since there are three neutrino flavors the neutrino wavefunction must posses three complex components and the hamiltonian , @xmath3 , is a 3 @xmath4 3 matrix . in vacuum",
    "the hamiltonian in the flavor basis is not diagonal and it is the presence of the off - diagonal terms in @xmath3 that lead to flavor oscillations .",
    "the vacuum hamiltonian may be diagonalized by a suitable unitary transformation and it is this new basis that form the ` mass eigenstates ' .    in the presence of matter a potential , @xmath5 , that takes into account coherent forward scattering of the neutrinos , must be included in the hamiltonian .",
    "for the case of only active neutrino flavors ( i.e. all the flavors that have ordinary weak interactions ) passing through normal matter the only relevant portion of @xmath5 is the @xmath6 component of @xmath5 .",
    "this is the well - known @xmath7 where @xmath8 is fermi s constant and @xmath9 is the electron number density . with the addition of @xmath5",
    "the hamiltonian is no longer diagonal in the mass basis . a new basis , the ` matter eigenstates ' , diagonalizes @xmath10 but the spatial variance now within the hamiltonian means that the unitary transformtion that relates the flavor to the matter basis also varies with the propagtion distance .",
    "the gradient of this unitary transformation is non - zero and one finds that the schrodinger equation in this new basis picks up off - diagonal terms .",
    "again , the presence of off - diagonal terms in the schrodinger equation leads to mixing of the complex coefficients describing the wavefunction and this will occur even in the matter basis if those terms are sufficiently large .",
    "though , in general , the three complex components of the wavefunction oscillate simulataneously the large difference in vacuum mass splittings usually permits us to consider the evolution of the neutrino wavefunction as being factored into two , localized , spatially separated , two - neutrino mixings .",
    "this factorization simplifies matters greatly . for two - neutrino mixing",
    "there is a single rotation angle @xmath11 that describes the relationship between the two mass eigenstates and the flavor states , and , similarly , within matter there is only one rotation angle @xmath12 , the matter mixing angle , for the relationship between the matter and flavor bases . in the matter eigenstate",
    "basis the schrodinger equation for the evolution of the 2-component neutrino wavefunction is @xmath13 the prime denotes differentiation with respect to position @xmath14 , the quantity @xmath15 is @xmath16 with @xmath17 where @xmath18 is the mass squared difference between the neutrino mass eigenstates , and @xmath19 examination of equation ( [ eq : k ] ) reveals that @xmath15 passes through minima whenever @xmath20 and these points in the profile are known as the ` resonances ' .",
    "the ratio @xmath21 defining the adibaticity parameter is a measure of the strength of the mixing and the positions where @xmath22 reaches minima are ` points of maximal violation of adiabaticity ' .",
    "it is here that the off - diagonal terms in equation ( [ eq : hmatter ] ) are most important and the mixing is at is strongest .",
    "note , as pointed out by friedland @xcite , that in general the positions of ` resonaces ' and ` points of maximal violation of adiabaticity ' do not coincide and it is actually the latter that are more important for the evolution of the wavefunction .",
    "that said , throughout the remainder of the paper we will use these terms interchangeably .",
    "the schrodinger equation forms a starting point from which the neutrino wavefunction emerging from the density profile can be determined . for 2-flavor mixing",
    "this is completley specified by calculating the ` survival probability ' i.e. the probability that a neutrino born as a particular flavor will emerge from the density profile as that same flavor .",
    "unitarity provides the probability of detecting the counterpart flavor . quite generally ,",
    "if the rotation angle @xmath23 at the neutrino source is @xmath24 and the neutrino propagates to the vacuum then , after dropping the phase dependent terms , the flavor basis survival probability is @xmath25 .",
    "\\label{eq : pelz}\\ ] ] here the quantity @xmath26 is known as the crossing probability .",
    "the crossing probability is a quantity defined in the matter basis and is the chance that an initial neutrino wavefunction transits from one matter eigenstate to the other .",
    "one obvious method to calculate @xmath26 is to simply integrate the schrodinger equation in the matter basis .",
    "if @xmath22 is always large as the neutrino propagates then the off - diagonal terms in equation ( [ eq : hmatter ] ) may be neglected , the integration of the schrodinger equation is trivial and the wavefunction is said to evolve adibatically .",
    "there are also a handful of profiles where @xmath26 has an exact analytic solution , the most well - known being the landau - zener result for the infinite linear profile : @xmath27 , \\label{eq : plz}\\ ] ] where @xmath28 is the adibaticity parameter evaluated at the resonance .",
    "the landau - zener equation for @xmath26 possesses ` troublesome pathologies ' as discussed , and corrected , by haxton @xcite .",
    "but exact results are scant and often one finds that numeric integration of the schrodinger equation for many interesting applications can be a frustrating exercise . as we mentioned previously , off - diagonal terms lead to oscillations and this is true even in the matter basis if the @xmath29 term in equation ( [ eq : hmatter ] ) becomes large .",
    "oscillatory solutions of differential equations obtained numerically are notorious for a gradual accumulation of error in both the phase and amplitude of the solution . a suitable change of variables can help to control some of these problems but even so , with a conventional solver , one usually has to be very aggressive with the error control in order to keep the solution accurate .",
    "this requirement can lead to very long run times .",
    "in addition , the numeric integration of equation ( [ eq : hmatter ] ) is inefficient . with a convential differential equation solver the increments of the integration variable ( here",
    "it is @xmath14 ) are necessarily smaller than the local oscillation length @xmath30 . in regions of very high density , such as those found at the centers of supernova progenitor profiles",
    ", @xmath15 is very large and so the oscillation lengthscale will be very small .",
    "the differential equation solver will expend a great deal of time computing the wavefunction in such regions even though the large effective mass splitting indicates that the wavefunction is far from any resonance and @xmath22 is large so that , in some regard , its evolution is both simple and uninteresting .",
    "specialized methods , such as that by petzold @xcite , for highly oscillatory solutions of differential equations can help with the problem of small step sizes but their use may be limited by the requirement that any solution evolve adibatically .    due to these numeric problems , and motivated by a desire to comprehend the msw effect ,",
    "a number of alternate methods have been developed for calculating @xmath26 .",
    "for example , one could estimate @xmath26 by using one of the exact results , most typically the landau - zener , if that approximation for the profile is adequate for the situation at hand .",
    "an alterantive approach would be to use the semi - analytic method by balantekin & beacom @xcite for arbitrary monotonic profiles .",
    "but for one reason or another these alternate approaches can break down or are difficult to automate .",
    "one such occurence is the case of multiple resonances and the computational methods used for the case of fluctuations in the solar profile are much more sophisticated than brute - force application of a convential differential equation solver .    in this paper",
    "we outline a new computational method for determining the neutrino wavefunction after its passage through a density profile .",
    "our method undertakes the monte carlo integration of a scattering matrix and makes no assumptions with regard to adiabaticity or number of resonances and devotes the bulk of the computational time to the region around the point of maximal violation of adiabaticity .",
    "we derive our equations in section  [ sec : equations ] and discuss the monte carlo integration in section ",
    "[ sec : calculating s ] . we then consider the most important numerical difficulty in section ",
    "[ sec : unitarity ] before ending with applications of the technique to the density profile of the sun and a density profile obtained from the evolution of supernova progenitor profile with a hydrodynamical calculation in section ",
    "[ sec : applications ] . throughout this paper",
    "we will only consider two - flavor oscillations . in an appendix we expand on our ponderments of practical implementations .",
    "one persepctive on the evolution of the neutrino wavefunction through a density profile would be to regard the initial wavefunction as having been ` scattered ' so as to produce the emerging wavefunction .",
    "the scattering matrix that relates the outgoing wavefunction to the initial may be derived from the schrodinger equation . as a first step in its determination",
    "we define a new variable @xmath31 via @xmath32 so that @xmath33 and , secondly , we introduce a new basis , @xmath34 , related to the matter eigenstates via @xmath35 equation ( [ eq : dphidx ] ) allows us to change the independent variable from @xmath14 to @xmath31 and so measure distances in terms of this quantity . we see that @xmath31 has a physical interpretation as the number of half periods of the purely adiabatic solutions ( i.e. @xmath36 ) of the schrodinger equation ( [ eq : hmatter ] ) .",
    "substitution of these definitions into equation ( [ eq : hmatter ] ) produces @xmath37 where @xmath38 is the related to the adiabaticity parameter , @xmath39 note that this definition indicates that a wavefunction will evolve non - adiabaticly if @xmath40 . the change in basis allows us to focus the problem on the non - adiabatic part of the solution by which we mean that portion that jumps from one matter eigenstate to the other because , in this new basis , the schrodinger equation is now purely off - diagonal . by integrating equation ( [ eq : hbeta ] )",
    "we obtain @xmath41 and repeated substitution of this result into itself yields    @xmath42    where the subscripts on the @xmath3 s indicate their argument with respect to @xmath31 by which we mean @xmath43 .",
    "this equation defines the scattering matrix @xmath44 in this basis as @xmath45 the upper limits on the integrals appearing in equation ( [ eq : integral ] ) indicate the space / time ordering ( @xmath31 is a monotonically increasing function of @xmath14 ) but we may change all the upper limits to @xmath46 by using such identities as @xmath47 where @xmath48 is the step function .",
    "this , and similar identities for the the higher order multiple integrals , allows us to write @xmath44 as    @xmath49    where @xmath50 is the @xmath31-ordered product . with the scattering matrix",
    "defined we describe our approach to its calculation .",
    "the conversion from a differential to an integral equation means that completely different numerical algorithms must be applied .",
    "the number of terms that one may have to include in equation ( [ eq : sproduct ] ) to achieve sufficient accuracy , and the fact that @xmath51 involves an @xmath52 oscillatory terms , likely precludes any approach other than a monte carlo integration .",
    "though monte carlo methods are often regarded as a last resort their usefulness becomes apparent when either the boundaries of the integration region are very complicated or , as in this case , when the dimensionality of the integration measure means that more sophisticated algorithms will not produce a result in a respectable amount of time .",
    "the quantities we select randomly are @xmath53 to be drawn from a probability distribution @xmath54 .",
    "navely we could pick values for @xmath55 from a uniform range between @xmath56 and @xmath46 but the structure of equation ( [ eq : sproduct ] ) shows that this would be inefficient because the hamiltonians are all proportional to @xmath38 and this quantity is largest in the region close to the resonance .",
    "this would suggest that we should select @xmath57 and hence use importance sampling for the @xmath31 s .",
    "this would be fine for the case of only one resonance but if there are multiple resonances we encounter problems due to the fact that @xmath58 .",
    "if @xmath29 ever switches sign then @xmath54 would switch sign and , over some portion of the profile , we would have a negative probability distribution .",
    "so instead we use @xmath59 .     as a function of the period counting variable @xmath31 .",
    "the density profile is the bs2005-ags , op standard solar model @xcite and we selected @xmath60 , @xmath61 . in the top panel we used @xmath62 and for the bottom @xmath63 .",
    "[ fig : gammasolar ] , width=325 ]    to illustrate just how sharply peaked @xmath64 can be we show in figure ( [ fig : gammasolar ] ) this function for the bs2005-ags , op standard solar model @xcite for two different values of @xmath65 . for the upper panel we selected @xmath60 , @xmath61 and @xmath62",
    "which , as the figure indicates since the peak is @xmath66 , means that the resonance is non - adiabatic .",
    "the point of maximal violation of adiabaticity is where @xmath67 reaches it s minimum value so by using @xmath59 as the probability distribution for @xmath31 we concentrate our efforts around this point .",
    "the bottom panel shows @xmath68 for the case of @xmath69 . for this larger value ,",
    "@xmath68 is less sharply peaked , the wavefunction evolves adibatically and the values of @xmath31 we obtain from this probability distribution are spread over a broad range .",
    "before we proceed the probability distribution must be normalized .",
    "the normalization @xmath70 for the distribution , @xmath71 , is simply @xmath72",
    "with @xmath54 identified we can pull out from @xmath51 the probability distribution @xmath54 and define a reduced hamiltonian @xmath73 as @xmath74 ; written explicitly @xmath73 is @xmath75}{a}\\;\\left(\\begin{array}{cc } 0 & \\imath\\,\\,e^{2\\imath\\pi\\phi } \\\\ -\\imath\\,e^{-2\\imath\\pi\\phi } & 0 \\end{array}\\right ) .",
    "\\label{eq : hreduced}\\ ] ] the definition for the scattering matrix in equation ( [ eq : sproduct ] ) is a sum of multiple integrals but by utilizing the identity @xmath76 the sum can be collapsed down to a single multiple integral albeit one with infinite dimensionality for its measure :    @xmath77    this expression for the scattering matrix is more useful from a practical standpoint because it allows us to reuse values of @xmath31 .",
    "the scattering matrix is therefore the expectation value of the quantity @xmath78 where @xmath79 our algorithm for the calculation of @xmath0 is to simply form a set with @xmath80 samples of the matrix @xmath78 and average them .",
    "the scattering matrix possesses a simple structure defined by two complex numbers @xmath81 and @xmath82 so that @xmath83 it is tempting to regard @xmath81 and @xmath82 as cayley - klein parameters but , as we shall discuss below , the monte carlo does not guarantee that @xmath84 or , equivalently , @xmath85    once @xmath0 is calculated we apply @xmath0 to the initial wavefunction @xmath86 in order to determine @xmath87 , i.e @xmath88 .",
    "the crossing probability , @xmath26 , is the chance that a wavefunction prepared in a pure matter eigenstate has transited to the other matter eigenstate as it emerges from the profile .",
    "our scattering matrix is defined in the @xmath34 basis , not the matter , @xmath89 , basis and these are related by the expression in equation ( [ eq : beta definition ] ) .",
    "the crossing probability is thus @xmath90 the superscript upon @xmath91 is to remind the reader of the second line of this equation .",
    "we may also define @xmath26 as being the difference from unity of the probability that a wavefunction prepared in a pure matter eigenstate survives as that same matter eigenstate as it emerges from the profile : i.e.    @xmath92    again , the superscript upon @xmath93 is to remind the reader of the second line of this equation .    thus our scattering matrix can be used to construct two values for @xmath26 and if @xmath0 were unitary then they would be equal .",
    "the difference between them is due to finite sampling and is the subject of the next section .",
    "after execution of the monte carlo algorithm for a given profile and mixing parameters , one obtains a scattering matrix @xmath0 from which @xmath94 and @xmath95 can be formed . the scattering matrix calculated by this method",
    "does not , in general , guarantee that the identity @xmath96 is satisfied .",
    "this is equivalent to the statements that @xmath97 and @xmath98 .",
    "thus @xmath81 and @xmath82 are not cayley - klein parameters and the two calculated crossing probabilities are not exactly equal .",
    "also , if the calculation for a given profile and mixing paramaters is repeated then we obtain a new scattering matrix and new values for @xmath94 and @xmath95 .",
    "the difference between the two crossing probabilities for a given run and their change from one run to the next arises because we only construct a finite set of samples of @xmath78 . only in the limit of an infinite number of samples",
    "would @xmath94 and @xmath95 be exactly equal and our calcualtion give the same result every time .",
    "we stress that this behavior is not a fundamental flaw of the monte carlo technique but rather a numeric issue related to the usual lack of infinite computing resources . for this reason one must be content with values for @xmath94 and @xmath95 that differ from the true crossing probability and from each other . with the cautionary note that what follows is specific to our implementation of the algorithm and the test problems we selected , we try and provide some guidance on how to obtain the most accurate calculation in the least computational time .",
    "( solid ) and @xmath95 ( dashed ) of 10,000 results from the monte carlo calculation using the bs2005-ags , op standard solar model @xcite , @xmath60 , @xmath99 and @xmath62 as the physical parameters .",
    "the number of trials is @xmath100 .",
    "[ fig : f091 ] , width=325 ]    the values of @xmath94 and @xmath95 obtained from a given calculation are drawn from parent distributions that , in general , are unique to the particular profile , mixing parameters and also the implementation of the algorithm .",
    "these parent distributions may be reconstructed by repeating the calculation for @xmath94 and @xmath95 until a sufficiently large sample of results has been extracted . as an example , the frequency distributions of @xmath94 and @xmath95 for the case of @xmath101 neutrino passing through the bs2005-ags , op standard solar model density profile with @xmath60 and @xmath62 are shown in figure ( [ fig : f091 ] ) .",
    "the initial impression is that the distributions for @xmath94 and @xmath95 are both gaussian with similar means and variances and indeed the @xmath102-statistic from a kolmogorov - smirnov test ( using the lilliefors @xcite critical values ) verifies this conclusion .",
    "indicated by the squares as a function of @xmath80 for the calculation outlined in the text .",
    "the error bars are not the error in the mean but rather indicate the @xmath103 spread in the values of @xmath104",
    ". the dashed lines are @xmath105 with @xmath106 .",
    "[ fig : sdags ] , width=325 ]    the departure from unitarity is affected by the number of trials that go into the calculation of @xmath0 . in figure ( [ fig : sdags ] ) we plot the mean value of @xmath107 and the @xmath103 spread of the sample for various values of @xmath80 .",
    "again , the calculation is for a neutrino passing through the bs2005-ags , op standard solar model @xcite density profile and for @xmath60 , @xmath99 and @xmath62 .",
    "the mean values of @xmath107 all lie above zero indicating that the mean value of @xmath95 is apparently slightly larger than the mean for @xmath94 but that this difference disappears as @xmath80 increases .",
    "the error bars on each point are the @xmath103 spread in @xmath104 and these clearly diminish as @xmath80 increases .",
    "we find that the size of the error bars follows a trend proportional to @xmath108 as indicated by the dashed lines in the figure .",
    "the figure indicates unitarity is achieved in the limit when the number of samples of the scattering matrix becomes infinite .",
    "( solid ) and @xmath95 ( dashed ) of 10,000 results from the monte carlo calculation using the bs2005-ags , op standard solar model @xcite , @xmath60 , @xmath99 and @xmath63 as the physical parameters .",
    "the number of trials is again @xmath100 .",
    "[ fig : f922 ] , width=325 ]    but gaussianity in the distributions for @xmath94 and @xmath95 does not always occur and should not be taken for granted .",
    "if we consider a case where @xmath26 is close to zero non - gaussianity becomes apparent . in figure ( [ fig : f922 ] ) we show the frequency distributions for the case of @xmath60 , @xmath61 and @xmath63 .",
    "the distribution for @xmath94 remains gaussian but we immediately notice that the distribution for @xmath95 has changed and we find that a gamma distribution with an @xmath81 parameter that is close to unity is a good fit .",
    "the figure also shows that _ negative _ values @xmath94 can be obtained whereas @xmath95 is always positive .",
    "this result arises due to the definitions in equation ( [ eq : pcb ] ) and ( [ eq : pca ] ) : values of @xmath95 less than zero are not allowed but there is no similar restriction for @xmath94 .",
    "note also the very different widths of the distributions : the width of the @xmath94 distribution is similar to that in figure ( [ fig : f091 ] ) but the width of @xmath95 has shrunk considerably .",
    "this difference in the widths of the two crossing probabilities would indicate that the deviation from unitarity , @xmath104 , will be dominated by the spread in @xmath94 , the values of @xmath95 having such a small variance .",
    "thus , when @xmath26 is close to zero @xmath95 is much more accurately calculated than @xmath94 .",
    "we also find that for this test case , the width of the two distributions varies with @xmath80 in different fashions . for @xmath94",
    "the spread again varies as @xmath108 but the width of the @xmath95 distribution now behaves as @xmath109 . from additional test cases we found that that when @xmath26 approaches unity it is @xmath94 that is the more accurately calcualted .",
    "our experience has also shown that in some circumstances the distributions for @xmath94 and @xmath95 can also change shape as @xmath80 is varied : for small @xmath80 the distibution may be like a gamma distribution with a modest @xmath81 parameter but then will morph to something closer to a gaussian distribution as @xmath80 increases .",
    "these results hint at the interesting underlying numerics of this monte carlo approach but they also introduce some confusion into what would be a reasonable modus operandi .",
    "the parent distributions for @xmath94 and @xmath95 are not , in general , the same and we do not know a priori their shape or if they are similar",
    ". this would seem to preclude combining the results for @xmath94 and @xmath95 in some way so as to obtain a more accurate result .",
    "the accuracy of the results depend upon @xmath80 but in a way that varies as we change the profile and mixing parameters .",
    "before we do the calculation we do not know how large we must make @xmath80 to reach our intended level of accuracy . in practice we adopted a ` worst case scneario ' approach",
    "whereby we calculate both @xmath94 and @xmath95 assuming that the accuracy varies as @xmath108 . one",
    "would then require @xmath110 trials to reach a level of accuracy of @xmath111 .",
    "we then used @xmath95 for the crossing probability if @xmath112 and @xmath94 otherwise .",
    "as we said , the shape of the distributions for @xmath94 and @xmath95 can vary with the number of samples so breaking up the @xmath80 trials into a number of smaller runs ( e.g. @xmath113 runs with @xmath114 samples in each ) , calculating @xmath94 and @xmath95 from each run and then averaging the results must also be approached with caution . to avoid potential bias in such a procedure",
    "we only accepted the result from the one run with the full number of trials we specified . though this conservative approach has the drawback that the runtime of our code may be longer than necessary",
    "the results always achieve our desired level of accuracy and often considerably so .",
    "we finish with three applications of our method .",
    "we first demonstrate the method with a calculation of the survival probability of electron neutrinos using the solar density profile and two different values of @xmath65 .",
    "we then go on to use profile from an aspherical supernova simulation , which involves multiple resonances .    .",
    "in the top panel @xmath62 , in the bottom @xmath63 .",
    "the source of neutrinos is located at @xmath115 and the neutrinos propagate back through the core and out the other side .",
    "the error bars on each point are the rms spread in the results from 8 repetitions .",
    "the gaussian estimator leads to a bias so the accuracy should be regarded as illustrative .",
    "[ fig : psolar ] , width=325 ]    the passage of neutrinos through the solar density profile is a well studied problem and therefore there are a number of already published calculations . in figure ( [ fig : psolar ] ) we calculate the survival probability of electron neutrinos over a spectrum in energy through the bs2005-ags , op standard solar model @xcite . for these figures we select either @xmath62 or @xmath63 .",
    "the source of neutrinos is located at @xmath116 of the solar radius and they propagate back through the core and emerge the other side .",
    "these figures agree those of haxton @xcite for the same calculation . in these calculations",
    "the lower energy neutrinos experience a double resonance while the higher energy neutrinos experience only one .",
    "this changeover is seen in the bottom panel of figure ( [ fig : psolar ] ) where the survival probability transits from @xmath117 to @xmath118 at @xmath119 .",
    "the top panel in figure ( [ fig : psolar ] ) exhibits rapid fluctuations in the survival probability ( which are by no means resolved with energy spacing we used ) and indicate phase effects as discussed in .",
    "these features in the figure demonstrate that the monte carlo is capable of reproducing the results of other calculations .",
    "the measured value of @xmath120 is larger than what we have used in our example calculations here , and therefore neutrinos from the sun go through adiabatic neutrino flavor transformation .",
    "however , the value of @xmath121 is yet unknown .",
    "this angle will determine the degree of flavor transformation in the core collapse supernova .",
    ", as a function of radial distance for the model discussed in the text .",
    "the upper figure is the entire profile , the lower focuses upon that portion up to @xmath122 . in both panels",
    "the dashed lines indicate the resonance potential energies for @xmath123 ( upper ) and @xmath124 ( lower ) neutrinos indicating that neutrinos with energies between these values will experience a triple resonance . the mass splitting is chosen to be @xmath125 and @xmath126 .",
    "[ fig:3resv ] , width=325 ]    ) as a function of the neutrino energy . for this calculation @xmath125 and @xmath126 .",
    "again , the error bars on each point are the rms spread in the results from 8 repetitions of the calculation using the gaussian estimator .",
    "though this estimator is biased they indicate the accuracry of the result .",
    "[ fig : p3res ] , width=325 ]    therefore , we consider finally the more complicated profile shown in figure ( [ fig:3resv ] ) .",
    "this profile is a product of the evolution of a supernova progenitor model using the vhi hydrodynamical code .",
    "an @xmath127 spherical harmonic velocity perturbation was inserted by hand into the u13.2 progenitor profile of heger @xcite to cause the star to explode asymmetrically . as a consequence of the asphericity",
    "several density minima were produced and the profile shown is a radial slice through the model @xmath128 after the bounce .",
    "we select @xmath125 and @xmath126 and find that neutrinos with energies between @xmath123 and @xmath124 will experience a triple resonance , this region is magnified in the lower panel of figure ( [ fig:3resv ] ) .",
    "the results of the calculation are shown in figure ( [ fig : p3res ] ) . between @xmath123 and @xmath124 the survival probability , again , exhibits phase effects . at present",
    "we only wish to illustrate a potential use of the technique presented here for the case of multiple resonances .",
    "the calculation leading to this profile will be discussed elsewhere along with a more detailed studied of the observable consequences of multiple resonances from aspherical supernova explosions @xcite .",
    "we have shown that the effects of matter upon the propagation of neutrinos may be described as the scattering of an initial neutrino wavefunction permitting us to exchange the differential schrodinger equation for an integral equation for the scattering matrix . in this formulism",
    "we are able to avoid the numerical difficulties associated with oscillatory solutions to differential equations by , instead , using monte carlo integrators that focus the calculation onto the most important aspects of the problem .",
    "though slow to converge compared to more sophisticated methods , and possessing inherent numerical error due to finite sampling , monte carlo integrators have the advantage of easily controlled runtimes and the numerical errors are both understood and ameliorated by repetition .",
    "this technique may be useful in a number of interesting density profiles that are difficult to work with using traditional techniques , particularily those involving multiple resonance regions , such as in a core collapse supernovae .",
    "this work was supported at ncsu by the u.s .",
    "department of energy under grant de - fg02 - 02er41216 and at umn under grant de - fg02 - 87er40328 .",
    "as we described in section  [ sec : calculating s ] , the scattering matrix is found to be the average of a set of samples for @xmath78 . as a reminder ,",
    "@xmath78 is given by @xmath129 and the subscripts on the reduced hamiltonians @xmath130 indicate the @xmath31 argument by which we mean @xmath131 and @xmath73 is given by equation ( [ eq : hreduced ] ) .",
    "constructing a set of @xmath78 to average is the principle task of the algorithm .",
    "it is not our intention to proscribe a recipe for the construction of @xmath78 , and the reader can find many additional runtime savings that are not discussed here , but rather we outline some considerations that may be useful .",
    "formally @xmath78 is the sum of an infinite number of terms but in practice we must truncate the series at some order @xmath132 .",
    "the basis for selection of @xmath132 comes from noticing that the terms in @xmath78 are proportional to a unitary matrix and a weighting factor @xmath133 with @xmath134 we can set a value for @xmath132 by requiring that the weight of the terms we retain are larger than some specified level @xmath135 ; that is , @xmath136 . since the weights are inversely related to the normalization the smaller the value of @xmath70 then then larger @xmath132 .",
    "small value of @xmath70 , as seen in equation ( [ eq : normalization ] ) , occur for greater differences between the initial and final rotation angles across a resonance and/or the greater the number of zeros for @xmath38 . the value of @xmath135 should be sufficiently small that the numerical error in the values of @xmath94 and @xmath95 should be dominated by the finite sampling error otherwise the crossing probabilities would contain a systematic error due to this truncation . for a desired level of accuracy of @xmath111 in @xmath94 and @xmath95 we found that @xmath137 was sufficient .",
    "with @xmath132 chosen the structure of equation ( [ eq : sappendix ] ) indicates we need @xmath132 values of @xmath31 to compute @xmath78 .",
    "the most efficient method for obtaining a sequence of @xmath31 s from the probability distribution @xmath54 is to relate @xmath54 to the uniform distribution so that one may use a pseudo - random number generator .",
    "this is achieved by calculating the accumulated probability , @xmath138 , from @xmath139 and then inversion of the relationship to form @xmath140 .",
    "the requirement that @xmath141 sets the normalization @xmath70 as shown in equation ( [ eq : normalization ] ) . after substituting the definition of @xmath38 , equation ( [ eq : gamma ] ) , and @xmath31 , equation ( [ eq : dphidx ] )",
    ", we find that for a monotonic profile @xmath142 .",
    "this result suggests that for a general profile we can also avoid performing the integration if we identify the zeros of @xmath38 and break apart the profile at those points so as to create a series of monotonic profiles .",
    "the absolute difference of the mixing angle across each monotonic region can be computed and the calculation for @xmath138 is then an appropriate summation .",
    "the advantages of calculating @xmath138 this way are : firstly , that it is far quicker than doing the integration , and secondly , @xmath38 can be somewhat noisy - as shown in figure ( [ fig : gammasolar ] ) - due to numerical problems associated with forming derivatives .    to use the relationship between @xmath31 and @xmath143 one generates a pseudo - random number @xmath144 from a uniform probability distribution and sets @xmath145 before inserting this value into @xmath140 .",
    "there is one circumstance where inversion of @xmath138 to @xmath140 is not possible and this occurs whenever @xmath146 over some extended distance within a profile .",
    "such a region would possess a constant density .",
    "but over this region @xmath147 in the @xmath34 basis so there is no need to perform the monte carlo calculation for this region .",
    "if this situation arises a simple solution is , again , to break apart the profile and only calculate the scattering matrix for those regions where @xmath148 . in this way",
    "the total scattering matrix for the entire profile is the ordered product of the scattering matrices for each @xmath148 zone .        1 .",
    "use the first value , @xmath149 , to calculate @xmath150 and add it to the unit matrix , 2 .",
    "@xmath31-order the first two values , @xmath149 and @xmath151 , calculate @xmath152 , and add it to the @xmath153 sum , 3 .",
    "repeat for all @xmath132 terms .    in this scheme",
    "each term in @xmath78 is calculated just once .",
    "but the presence of the weighting factors @xmath154 indicate that this is not optimal : we should calculate a term @xmath155 much more frequently if its weight is large and less frequently if the weight is small .",
    "there are many ways one can achieve a better load balancing : we adopted , after realizing that the labels on the @xmath31 s may be swapped amongst themselves , a scheme whereby we rewrite equation ( [ eq : sappendix ] ) as      where @xmath157 are the binomial coefficients , @xmath158 is an integer that satisfies @xmath159 and @xmath160 indicates all combinations of two @xmath31 s from the first @xmath158 in the list .",
    "this equation expresses the fact that any element of the first @xmath158 values of @xmath31 from our array may be used to calculate @xmath150 , any ordered pair of the first @xmath158 may be selected for @xmath152 and so up to @xmath161 , thereafter we calculate the higher order terms as described before .",
    "the appearance of the binomial coefficients in the denominators has the effect of increasing the number of trials that will form the first @xmath158 terms of @xmath0 .",
    "but the additional computation obviously leads to an increase in the amount of time required to generate just one @xmath78 . to compensate for the longer runtime we can reduce the number of samples of @xmath78 that we average to form the scattering matrix .",
    "if @xmath162 is the time required to form @xmath78 via equation ( [ eq : sappendix ] ) , and @xmath163 is the amount of time to calculate @xmath78 according to equation ( [ eq : averaging ] ) , then the number of @xmath78 samples that we would have averaged with equation ( [ eq : sappendix ] ) , which we call @xmath164 , is reduced to @xmath165 when we use equation ( [ eq : averaging ] ) so as maintain @xmath166 .",
    "even though the number of @xmath78 that we average to form the scattering matrix is reduced a judicious choice for @xmath158 and the presence of the binomial coefficients can more than compensate this loss so that our scattering matrix is more accurate and the code more efficient .",
    "we base our decision for selecting @xmath158 by defining a quantity @xmath167 as @xmath168               \\ ; \\left [ \\frac{\\tau(n_{\\phi})}{\\tau(0 ) } \\right ] \\label{eq : vs}\\ ] ] and determine the value of @xmath158 that minimizes @xmath167 .",
    "the reader may find that an alternate selection criteria leads to a more efficient algorithm .",
    "the computation times @xmath2 were found by numerical experiments and the application of fitting formulae to the results although one may alternatively have some knowledge of their relative size from the design of the algorithm .",
    "i.  mocioiu and r.  shrock , phys .",
    "d * 62 * , 053017 ( 2000 ) [ arxiv : hep - ph/0002149 ] .",
    "g.  m.  fuller , w.  c.  haxton and g.  c.  mclaughlin , phys .",
    "d * 59 * , 085005 ( 1999 ) [ arxiv : astro - ph/9809164 ] .",
    "a.  s.  dighe and a.  y.  smirnov , phys .",
    "d * 62 * , 033007 ( 2000 ) [ arxiv : hep - ph/9907423 ] .",
    "petzold , siam j. numer .",
    ", * 18 * , 455 ( 1981 )                    f.n .",
    "loreti , and a.b .",
    "balantekin , phys.rev . *",
    "d50 * , 4762 ( 1994 ) f.n .",
    "loreti , _ et al .",
    "_ , , * 52 * , 6664 ( 1995 ) a.b .",
    "balantekin , j.m .",
    "fetter , and f.n .",
    "loreti , phys.rev . , * d54 * , 3941 ( 1996 ) p.m. fishbane , and p. kaus ,",
    "journal of physics g , * 27 * , 2405 ( 2001 )"
  ],
  "abstract_text": [
    "<S> we demonstrate that the effects of matter upon neutrino propagation may be recast as the scattering of the initial neutrino wavefunction . exchanging the differential , </S>",
    "<S> schrodinger equation for an integral equation for the scattering matrix @xmath0 permits a monte carlo method for the computation of @xmath0 that removes many of the numerical difficulties associated with direct integration techniques . </S>"
  ]
}