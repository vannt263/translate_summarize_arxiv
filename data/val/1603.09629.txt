{
  "article_text": [
    "spacecraft attitude control and reaction wheel desaturation are normally regarded as two different control system design problems and are discussed in separate chapters in text books , such as @xcite . while spacecraft attitude control using magnetic torques",
    "has been one of the main research areas ( see , for example , @xcite and extensive references therein ) , there are quite a few research papers that address reaction wheel momentum management , see for example , @xcite and references therein . in @xcite , dzielsk et al . formulated the problem as an optimization problem and a nonlinear programming method was proposed to find the solution .",
    "their method can be very expensive and there is no guarantee to find the global optimal solution .",
    "chen et al .",
    "@xcite discussed optimal desaturation controllers using magnetic torques and thrusters .",
    "their methods find the optimal torques which , however , may not be able to achieve by magnetic torque coils because given the desired torques in a three dimensional space , magnetic torque coils can only generate torques in a two dimensional plane @xcite .",
    "like most publications on this problem ,",
    "the above two papers do not consider the time - varying effect of the geomagnetic field in body frame , which arises when a spacecraft flies around the earth .",
    "giulietti et al .",
    "@xcite considered the same problem with more details on the geomagnetic field , but the periodic feature of the magnetic field along the orbit was not used in their proposed design . in addition , all these proposed designs considered only momentum management but not attitude control .",
    "since both attitude control and reaction wheel desaturation are performed at the same time using the same magnetic torque coils , the control system design should consider these two design objectives at the same time and some very recent research papers tackled the problem in this direction , for example , @xcite . in @xcite , tregouet et al",
    ". studied the problem of the spacecraft stabilization and reaction wheel desaturation at the same time .",
    "they considered time - variation of the magnetic field in body frame , and their reference frame was the inertial frame .",
    "however , for a low earth orbit ( leo ) spacecraft that uses earth s magnetic field , the reference frame for the spacecraft is most likely local vertical local horizontal ( lvlh ) frame .",
    "in addition , their design method depends on some assumption which is not easy to verify and their proposed design does not use the periodic feature of the magnetic field . moreover , their design is composed of two loops , which is essentially an idea of dealing with attitude control and wheel momentum management in separate considerations . in @xcite , a heuristic proportional controller was proposed and a lyapunov function was used to prove that the controller can simultaneously stabilize the spacecraft with respect to the lvlh frame and achieve reaction wheel management .",
    "but this design method does not consider the the time - varying effect of the geomagnetic field in body frame .",
    "although these two designs are impressive , as we have seen , these designs do not consider some factors in reality and their solutions are not optimal .    in this paper",
    ", we propose a more attractive design method which considers as many factors as practical .",
    "the controlled attitude is aligned with lvlh frame . a general reduced quaternion model , including ( a ) reaction wheels , ( b ) magnetic torque coils , ( c ) the gravity gradient torque , and ( d ) the periodic time - varying effects of the geomagnetic field along the orbit and its interaction with magnetic torque coils , is proposed .",
    "the model is an extension of the one discussed in @xcite",
    ". a single objective function , which considers the performance of both attitude control and reaction wheel management at the same time , is suggested .",
    "since a well - designed periodic controller for a period system is better than constant controllers as pointed out in @xcite , this objective function is optimized using the solution of a matrix periodic riccati equation described in @xcite , which leads to a periodic time - varying optimal control . based on the algorithm for the periodic riccati equations @xcite ,",
    "we show that the design can be calculated in an efficient way and the designed controller is optimal for both the spacecraft attitude control and for the reaction wheel momentum manage at the same time .",
    "we provide a simulation test to demonstrate that the designed system achieves more accurate attitude than the optimal control system that uses only magnetic torques . moreover , the designed controller based on lqr method works on the nonlinear spacecraft system .",
    "the remainder of the paper is organized as follows .",
    "section 2 derives the reduced quaternion spacecraft control system model using reaction wheel and magnetic control torques with the attitude defined as the rotation of the body frame respect to the lvlh frame .",
    "section 3 reduces the nonlinear spacecraft system model to a linearized periodic time - varying model which includes the time - varying geomagnetic field along the orbit , the gravity gradient disturbance torque , the reaction wheel speed control , and the magnetic torque control .",
    "section 4 introduces a single objective function for both attitude control and wheel management .",
    "it also gives the optimal control solutions for this linear time - varying system in different conditions .",
    "simulation test is provided in section 5 .",
    "the conclusions are summarized in section 6 .",
    "throughout the discussion , we assume that the inertia matrix of a spacecraft @xmath0 is a diagonal matrix .",
    "this assumption is reasonable because in practical spacecraft design , spacecraft inertia matrix j is always designed as close to a diagonal matrix as possible @xcite .",
    "( it is actually very close to a diagonal matrix . ) for spacecraft using earth s magnetic torques , the nadir pointing model is probably the mostly desired one .",
    "therefore , the attitude of the spacecraft is represented by the rotation of the spacecraft body frame relative to the local vertical and local horizontal frame .",
    "this means that the quaternion and spacecraft body rate should be represented in terms of the rotation of the spacecraft body frame relative to the lvlh frame ( see @xcite for the definition of lvlh frame ) .",
    "let @xmath1^{\\tr}$ ] be the body rate with respect to the lvlh frame represented in the body frame , @xmath2^{\\tr}$ ] the orbit rate ( the rotation of lvlh frame ) with respect to the inertial frame represented in the lvlh frame , @xmath3 is a known constant . ] , and @xmath4^{\\tr}$ ] be the angular velocity vector of the spacecraft body with respect to the inertial frame , represented in the spacecraft body frame .",
    "let @xmath5 represent the rotational transformation matrix from the lvlh frame to the spacecraft body frame .",
    "then , @xmath6 can be expressed as @xcite @xmath7 where @xmath8 is the rotational rate of lvlh frame relative to the inertial frame represented in the spacecraft body frame .",
    "assuming that the orbit is circular , i.e. , @xmath9 , using the fact ( see ( * ? ? ?",
    "* eq.(19 ) ) ) @xmath10 we have @xmath11    assuming that the three reaction wheels are aligned with the body frame axes , the total angular momentum of the spacecraft @xmath12 in the body frame comprises the angular momentum of the spacecraft @xmath13 and the angular momentum of the reaction wheels @xmath14^{\\tr}$ ] @xmath15 where @xmath16 @xmath17 is the inertia matrix of the three reaction wheels aligned with the spacecraft body axes , and @xmath18^{\\tr}$ ] is the angular rate vector of the three reaction wheels .",
    "let @xmath19 be the same vector of @xmath12 represented in inertial frame .",
    "let @xmath20 be the total external torques acting on the spacecraft , we have ( see @xcite ) @xmath21 using eq .",
    "( 20 ) of @xcite and equation ( [ angularm ] ) , we have the dynamics equations of the spacecraft as follows @xmath22 where @xmath20 includes the gravity gradient torque @xmath23 , magnetic control torque @xmath24 , and internal and external disturbance torque @xmath25 ( including residual magnetic moment induced torque , atmosphere induced torque , solar radiation torque , etc ) .",
    "the torques generated by the reaction wheels @xmath26 are given by @xmath27 substituting these relations into ( [ dynamics ] ) gives @xmath28 substituting ( [ 3 ] ) and ( [ 4 ] ) into ( [ dynamics1 ] ) , we have @xmath29 -\\t_w + \\t_g+\\t_m+\\t_d . \\label{dynamics2}\\ ] ] let @xmath30^{\\tr}=[q_0 , \\q^{\\tr}]^{\\tr}= \\left [ \\cos(\\frac{\\alpha}{2 } ) , \\hat{\\e}^{\\tr}\\sin(\\frac{\\alpha}{2 } ) \\right]^{\\tr}\\ ] ] be the quaternion representing the rotation of the body frame relative to the lvlh frame , where @xmath31 is the unit length rotational axis and @xmath32 is the rotation angle about @xmath31 .",
    "therefore , the reduced kinematics equation becomes @xcite @xmath33 & = & \\frac{1}{2 }   \\left [   \\begin{array } { ccc }   \\sqrt{1-q_1 ^ 2-q_2 ^ 2-q_3 ^ 2 } & -q_3   & q_2 \\\\ q_3 & \\sqrt{1-q_1 ^ 2-q_2 ^ 2-q_3 ^ 2 } & -q_1 \\\\",
    "-q_2   &   q_1   & \\sqrt{1-q_1 ^ 2-q_2 ^ 2-q_3 ^ 2 } \\\\",
    "\\end{array } \\right ]   \\left [   \\begin{array } { c }   \\omega_{1 } \\\\",
    "\\omega_{2 } \\\\",
    "\\omega_{3 } \\end{array } \\right ]   \\\\ & = & \\g(q_1,q_2 , q_3 , \\boldsymbol{\\omega } ) , \\label{nadirmodel2}\\end{aligned}\\ ] ] or simply @xmath34 since ( see @xcite ) , @xmath35,\\end{aligned}\\ ] ] we have @xmath36 \\omega_0 , \\label{n9}\\ ] ] which is a function of @xmath37 .",
    "interestingly , given spacecraft inertia matrix @xmath38 , @xmath23 is also a function of @xmath37 . using the facts ( a ) the spacecraft mass is negligible compared to the earth mass , and ( b ) the size of the spacecraft is negligible compared to the magnitude of the vector from the center of the earth to the center of the mass of the spacecraft @xmath39 , the gravitational torque is given by @xcite : @xmath40 where @xmath41",
    ", @xmath42 is the universal constant of gravitation , and @xmath43 is the mass of the earth .",
    "noticing that in local vertical local horizontal frame , @xmath44^{\\tr}$ ] , we can represent @xmath39 in body frame as @xmath45 \\left [ \\begin{array}{c } 0 \\\\ 0 \\\\",
    "-|\\r| \\end{array } \\right ] .",
    "\\label{rl}\\ ] ] denote the last column of @xmath46 as @xmath47 , and using the following relation @xcite @xmath48 and ( [ rl ] ) , we can rewrite ( [ gg1 ] ) as @xmath49    let @xmath50^{\\tr}$ ] be the earth s magnetic field in the spacecraft coordinates , computed using the spacecraft position , the spacecraft attitude , and a spherical harmonic model of the earth s magnetic field @xcite .",
    "let @xmath51^{\\tr}$ ] be the spacecraft magnetic torque coils induced magnetic moment in the spacecraft coordinates .",
    "the desired magnetic control torque @xmath24 may not be achievable because @xmath52 provides only a torque in a two dimensional plane but not in the three dimensional space @xcite .",
    "however , the spacecraft magnetic torque coils induced magnetic moment @xmath53 is an achievable engineering variable .",
    "therefore , equation ( [ dynamics2 ] ) should be rewritten as @xmath54 where @xmath55 . \\label{ffunction}\\ ] ] notice that the cross product of @xmath56 can be expressed as product of an asymmetric matrix @xmath57 and the vector @xmath53 with @xmath58 .",
    "\\label{productm}\\ ] ] denote the system states @xmath59^{\\tr}$ ] and control inputs @xmath60^{\\tr}$ ] , the spacecraft control system model can be written as follows :    @xmath61 \\u + \\t_d ,   \\label{nonlineara } \\\\ \\j_w   \\dot{\\boldsymbol{\\omega } } = \\t_w , \\label{nonlinearb }   \\\\",
    "\\dot{\\q}=\\g(\\q , \\boldsymbol{\\omega } ) \\label{nonlinearc}.\\end{gathered}\\ ] ]    [ dynamicsall ]    the reduced quaternion , instead of the full quaternion , is proposed in this model because of many merits discussed in @xcite .",
    "the nonlinear model of ( [ dynamicsall ] ) can be used to design control systems .",
    "one popular design method for nonlinear model involves lyponuv stability theorem , which is actually used in @xcite .",
    "a design based on this method focuses on stability but not on performance .",
    "another widely known method is nonlinear optimal control design @xcite , it normally produces an open loop controller which is not robust @xcite and its computational cost is high .",
    "therefore , we propose to use linear quadratic regulator ( lqr ) which achieves the optimal performance for the linearized system and is a closed - loop feedback control .",
    "our task in this section is to derive the linearized model for the nonlinear system ( [ dynamicsall ] ) .    using the linearization technique of @xcite",
    ", we can express @xmath62 in ( [ n9 ] ) approximately as a linear function of @xmath37 as follows @xmath63 \\omega_0 = \\left [   \\begin{array}{ccc }   0 & 0 & 2\\omega_0 \\\\ 0 & 0 & 0 \\\\ -2\\omega_0 & 0 & 0 \\\\ \\end{array }   \\right ] \\q   + \\left [   \\begin{array}{c }   0 \\\\ \\omega_0\\\\ 0 \\\\ \\end{array }   \\right ] .",
    "\\label{9}\\end{aligned}\\ ] ] similarly , we can express @xmath23 in ( [ ginterm1 ] ) approximately as a linear function of @xmath37 as follows @xmath64= \\left [   \\begin{array}{ccc }   6\\omega_0 ^ 2 ( j_{3}-j_{2 } ) &   0 & 0 \\\\ 0 & 6\\omega_0 ^ 2 ( j_{3}-j_{1 } )   & 0 \\\\ 0 & 0 & 0 \\\\ \\end{array }   \\right ] \\q : = \\t \\q . \\label{22}\\end{aligned}\\ ] ] since @xmath23 and @xmath8 are functions of @xmath37 , the linearized spacecraft model can be expressed as follows : @xmath65 \\left [ \\begin{array}{c } \\dot{\\boldsymbol{\\omega } }   \\\\ \\dot{\\boldsymbol{\\omega } } \\\\ \\dot{\\q } \\end{array } \\right ] =   \\left [ \\begin{array}{ccc } \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{\\omega } } }    & \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{\\omega } } }     & \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{q } } }   + \\t \\\\ \\0 & \\0   & \\0 \\\\   \\frac{\\partial{\\g}}{\\partial{\\boldsymbol{\\omega } } }   & \\0 & \\frac{\\partial{\\g}}{\\partial{\\q } } \\end{array } \\right ] \\left [ \\begin{array}{c } { \\boldsymbol{\\omega } }   \\\\ { \\boldsymbol{\\omega } } \\\\",
    "{ \\q } \\end{array } \\right ] + \\left [ \\begin{array}{cc } -\\i & -\\b^{\\times } \\\\",
    "\\i   & \\0 \\\\   \\0   & \\0   \\end{array } \\right ] \\left [ \\begin{array}{c } \\t_w   \\\\ \\m \\end{array } \\right ] + \\left [ \\begin{array}{c } \\t_d   \\\\",
    "\\0    \\\\ \\0 \\end{array } \\right ] , \\label{linearmodel}\\end{aligned}\\ ] ] where @xmath66 , @xmath67 , @xmath68 , @xmath69 , and @xmath70 are evaluated at the desired equilibrium point @xmath71 , @xmath72 , and @xmath73 . using the definition of ( [ productm ] ) , ( [ 9 ] ) , ( [ 22 ] ) , and ( [ ffunction ] ) , we have @xmath74 + \\left [ \\begin{array}{ccc } 0 & 0 & j_2 \\omega_0 \\\\ 0 & 0 & 0 \\\\   -j_2 \\omega_0   & 0 & 0 \\end{array } \\right ] - \\left [ \\begin{array}{ccc } 0 & 0 & \\omega_0 \\\\ 0 & 0 & 0 \\\\   -\\omega_0   & 0 & 0 \\end{array } \\right ] \\j   \\nonumber \\\\   & = &   \\left [ \\begin{array}{ccc } 0 & 0 & \\omega_0(-j_1+j_2-j_3 ) \\\\ 0 & 0 & 0 \\\\   \\omega_0(j_1-j_2+j_3 )   & 0 & 0 \\end{array } \\right ] , \\label{12}\\end{aligned}\\ ] ] @xmath75 \\j_w   \\nonumber \\\\   & = &   \\left [ \\begin{array}{ccc } 0 & 0 & -\\omega_0 j_{w_3 } \\\\ 0 & 0 & 0 \\\\   \\omega_0 j_{w_1 }   & 0 & 0 \\end{array } \\right ] , \\label{12a}\\end{aligned}\\ ] ] and @xmath76   - ( \\boldsymbol{\\omega}_{lvlh}^b ) ^{\\times } \\j     \\left [ \\begin{array}{ccc } 0 & 0 & 2 \\omega_0 \\\\ 0 & 0 & 0 \\\\   -2 \\omega_0   & 0 & 0",
    "\\end{array } \\right ]    \\nonumber \\\\   &    \\approx   &   \\omega_0 \\left (   \\left [ \\begin{array}{c } 2j_1q_3   \\\\ j_2 \\\\",
    "-2j_3q_1 \\end{array } \\right]^{\\times } -\\left [ \\begin{array}{ccc } 0 & 0 & 1   \\\\ 0 & 0 & 0 \\\\   -1    & 0 & 0 \\end{array } \\right ] \\j \\right ) \\left [ \\begin{array}{ccc } 0 & 0 & 2\\omega_0   \\\\ 0 & 0 & 0 \\\\   -2\\omega_0    & 0 & 0 \\end{array } \\right ]   \\nonumber \\\\   &    \\approx    &   \\omega_0 \\left",
    "[ \\begin{array}{ccc } 0 & 0 & j_2-j_3   \\\\ 0 & 0 & 0 \\\\   j_1-j_2    & 0 & 0 \\end{array } \\right ]   \\left [ \\begin{array}{ccc } 0 & 0 & 2\\omega_0   \\\\ 0 & 0 & 0 \\\\   -2\\omega_0    & 0 & 0 \\end{array } \\right ]   \\nonumber \\\\   &   =    &     \\left [ \\begin{array}{ccc } 2\\omega_0 ^ 2   ( j_3-j_2 )   & 0 & 0\\\\ 0 & 0 & 0 \\\\   0   & 0 & 2\\omega_0 ^ 2   ( j_1-j_2 )   \\end{array } \\right ] .",
    "\\label{12b}\\end{aligned}\\ ] ] from ( [ gfunction ] ) , we have @xmath77 @xmath78 substituting ( [ 22 ] ) , ( [ productm ] ) , ( [ 12 ] ) , ( [ 12a ] ) , ( [ 12b ] ) , ( [ 14 ] ) , and ( [ 15 ] ) into ( [ linearmodel ] ) , we have @xmath79 & =   &   \\left [ \\begin{array}{ccc } \\j^{-1 } \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{\\omega } } }    & \\j^{-1 }   \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{\\omega } } }     & \\j^{-1 } \\left ( \\frac{\\partial{\\f}}{\\partial{\\boldsymbol{q } } }   +   \\t \\right ) \\\\",
    "\\0 & \\0   & \\0 \\\\   \\frac{\\partial{\\g}}{\\partial{\\boldsymbol{\\omega } } }   & \\0 & \\frac{\\partial{\\g}}{\\partial{\\q } } \\end{array } \\right ] \\left [ \\begin{array}{c } { \\boldsymbol{\\omega } }   \\\\ { \\boldsymbol{\\omega } } \\\\ { \\q } \\end{array } \\right ] + \\left [ \\begin{array}{cc } -\\j^{-1 }   & -\\j^{-1 } \\b^{\\times } \\\\ \\j_w^{-1 }   & \\0",
    "\\\\   \\0   & \\0   \\end{array } \\right ] \\left [ \\begin{array}{c } \\t_w   \\\\ \\m \\end{array } \\right ] + \\left [ \\begin{array}{c } \\j^{-1 } \\\\",
    "\\0   \\\\ \\0 \\end{array } \\right ] \\t_d   \\nonumber \\\\    & = & \\left [ \\begin{array}{ccccccccc } 0   &   0   &   \\omega_0\\frac{j_1-j_2+j_3}{-j_1 }    &   0   &   0   &   \\frac{\\omega_0 j_{w_3}}{-j_1 }    &   8\\omega_0 ^ 2 \\frac{j_3-j_2}{j_1 }   &   0   &   0 \\\\ 0   &   0   &   0   &   0   &   0   &   0    &   0   &   6\\omega_0 ^ 2 \\frac{j_3-j_1}{j_2 }   &   0 \\\\   \\omega_0\\frac{j_1-j_2+j_3}{j_3 }   &   0   &   0   &   \\frac{\\omega_0 j_{w_1}}{j_3 }   &   0   &   0    &   0   &   0   &   2\\omega_0 ^ 2 \\frac{j_1-j_2}{j_3 } \\\\ 0   &   0   &   0   &   0   &   0   &   0    &   0   &   0   &   0 \\\\ 0   &   0   &   0   &   0   &   0   &   0    &   0   &   0   &   0 \\\\ 0   &   0   &   0   &   0   &   0   &   0    &   0   &   0   &   0 \\\\ 0.5   &   0   &   0   &   0   &   0   &   0    &   0   &   0   &   0 \\\\ 0   &   0.5   &   0   &   0   &   0   &   0    &   0   &   0   &   0 \\\\ 0   &   0   &   0.5   &   0   &   0   &   0    &   0   &   0   &   0   \\end{array } \\right ]   \\left [ \\begin{array}{c } \\omega_1",
    "\\\\ \\omega_2 \\\\ \\omega_3 \\\\ \\omega_1 \\\\",
    "\\omega_2 \\\\ \\omega_3 \\\\ q_1",
    "\\\\ q_3 \\end{array } \\right ]    \\nonumber \\\\ & +    &   \\left [ \\begin{array}{cccccc } -j_1^{-1 }   &   0   &   0   &   0   &   \\frac{b_3}{j_1 }   &   -\\frac{b_2}{j_1 }        \\\\ 0   &   -j_2^{-1 }    &   0   &   -\\frac{b_3}{j_2 }   &   0   &   \\frac{b_1}{j_2 }      \\\\ 0   &   0   &   -j_3^{-1 }    & \\frac{b_2}{j_3 }   & -\\frac{b_1}{j_3 }    &   0        \\\\ j_{w_1}^{-1 }    &   0   &   0   &   0   &   0   &   0        \\\\ 0   &   j_{w_2}^{-1 }    &   0   &   0   &   0   &   0       \\\\ 0   &   0   &   j_{w_3}^{-1 }    &   0   &   0   &   0       \\\\ 0   &   0   &   0   &   0   &   0   &   0       \\\\ 0   &   0   &   0   &   0   &   0   &   0       \\\\ 0   &   0   &   0   &   0   &   0   &   0        \\end{array } \\right ]   \\left [ \\begin{array}{c } t_{w_1 } \\\\ t_{w_1 } \\\\",
    "t_{w_1 } \\\\ m_1 \\\\ m_2 \\\\",
    "m_3   \\end{array } \\right ]   + \\left [ \\begin{array}{c } t_{d_1}/j_1 \\\\ t_{d_2}/j_2 \\\\",
    "t_{d_3}/j_3 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{array } \\right ]   : = \\a\\x+\\b\\u+\\d . \\label{linearmodel1}\\end{aligned}\\ ] ]    it is worthwhile to notice that ( [ linearmodel1 ] ) is in general a time - varying system . the time - variation of the system arises from an approximately periodic function of @xmath80 , where @xmath81 is the orbital period , @xmath82 is the orbital radius ( approximately equal to the spacecraft altitude plus the radius of the earth ) , and @xmath83 @xcite .",
    "this magnetic field @xmath84 can be approximately expressed as follows @xcite : @xmath85   = \\frac{\\mu_f}{a^{3 } } \\left [   \\begin{array}{c }   \\cos(\\omega_0t)\\sin(i_m ) \\\\",
    "-\\cos(i_m ) \\\\",
    "2\\sin(\\omega_0t)\\sin(i_m )   \\end{array }   \\right ] , \\label{field}\\ ] ] where @xmath86 is the inclination of the spacecraft orbit with respect to the magnetic equator , @xmath87 wb - m is the field s dipole strength .",
    "the time @xmath88 is measured at the ascending - node crossing of the magnetic equator .",
    "therefore , the periodic time - varying matrix @xmath89 in ( [ linearmodel1 ] ) can be written as @xmath90 .",
    "\\label{varyb}\\ ] ] a special case is when @xmath91 , i.e. , the spacecraft orbit is on the equator plane of the earth s magnetic field . in this case ,",
    "@xmath92^{\\tr}$ ] is a constant vector and @xmath89 is reduced to a constant matrix given as follows : @xmath93 .",
    "\\label{constantb}\\ ] ] in the remainder of the discussion , we will consider the discrete time system of ( [ linearmodel1 ] ) because it is more suitable for computer controlled system implementations .",
    "the discrete time system is given as follows : @xmath94 assuming the sampling time is @xmath95 , the simplest but less accurate discretization formulas to get @xmath96 and @xmath97 are given as follows : @xmath98 a slightly more complex but more accurate discretization formulas to get @xmath96 and @xmath97 are given as follows @xcite : @xmath99",
    "given the linearized spacecraft model ( [ linearmodel1 ] ) which has the state variables composed of spacecraft quaternion @xmath37 , the spacecraft rotational rate with respect to the lvlh frame @xmath100 , and the reaction wheel rotational speed @xmath101 , we can see that to control the spacecraft attitude and to manage the reaction wheel momentum are equivalent to minimize the following objective function @xmath102 under the constraints of ( [ linearmodel1 ] ) .",
    "this is clearly a lqr design problem which has known efficient methods to solve .",
    "however , in each special case , this system has some special properties which should be fully utilized to select the most efficient and effective method for each of these cases .",
    "the corresponding discrete time system is given as follows : @xmath103      it was shown in @xcite that a spacecraft without a reaction wheel in this orbit is not controllable . but for a spacecraft with three reaction wheels as we discussed in this paper , the system is fully controllable . the controllability condition can be checked straightforward but the check is tedious and is omitted in this paper ( also the controllability check is not the focus of this paper ) . in this case , as we have seen from ( [ linearmodel1 ] ) , ( [ constantb ] ) , and ( [ abk ] ) that the linear system is time - invariant .",
    "therefore , a method for time - varying system is not appropriate for this simple problem . for this linear time - invariant system ,",
    "the optimal solution of ( [ discreteall ] ) is given by ( see @xcite ) @xmath105 where @xmath106 is a constant positive semi - definite solution of the following discrete - time algebraic riccati equation ( dare ) @xmath107 there is an efficient algorithms @xcite for this dare system and an matlab function dare implements this algorithm .",
    "it was shown in @xcite that a spacecraft without any reaction wheel in any orbit of this case is controllable if the spacecraft design satisfies some additional conditions imposed on @xmath38 matrix . by intuition , the system is also controllable by adding reaction wheels . as a matter of fact , adding reaction wheels will achieve better performance of spacecraft attitude as pointed in @xcite .",
    "the best algorithm for this case is a little tricky because @xmath89 is a time - varying matrix but @xmath109 is a constant matrix .",
    "therefore , a method for time - varying system must be used . the optimal solution of ( [ discreteall ] ) is given by ( see @xcite ) @xmath110 where @xmath111 is a periodic positive semi - definite solution of the following periodic time - varying riccati ( ptvr ) equation @xmath112 hench and laub @xcite developed an efficient algorithm for solving the general ptvr equation . however , since @xmath113 is a constant matrix , their algorithm is not optimized . a more efficient algorithm in this case",
    "was recently proposed in @xcite , which is particularly useful for time - varying system with long period and a constant @xmath109 matrix because it may save hundreds of matrix inverses .",
    "the algorithm is presented below ( its proof is in @xcite ) :     +    * data : @xmath86 , @xmath38 , @xmath114 , @xmath115 , @xmath39 , the altitude of the spacecraft ( for the calculation of @xmath82 in ( [ field ] ) ) , @xmath95 ( the selected sample time period ) , and @xmath116 ( the total samples in one period @xmath117 ) .",
    "* step 1 : for @xmath118 , calculate @xmath96 and @xmath97 using ( [ abk ] ) or ( [ abk1 ] ) . * step 2 : calculate @xmath119 and @xmath120 using @xmath121 , \\label{ek}\\ ] ] @xmath122=\\f .",
    "\\label{fk}\\ ] ] * step 3 : calculate @xmath123 , for @xmath118 , using @xmath124 * step 4 : use schur decomposition @xmath125^{\\tr } \\boldsymbol{\\gamma_k }   \\left [ \\begin{array}{cc } \\w_{11k } &   \\w_{12k }   \\\\ \\w_{21k }    &     \\w_{22k } \\end{array } \\right]= \\left [ \\begin{array}{cc } \\s_{11k } &   \\s_{12k }   \\\\",
    "\\0    &     \\s_{22k } \\end{array } \\right ] .",
    "\\label{decomp1}\\ ] ] * step 5 : calculate @xmath126 using @xmath127    [ desat ]    this algorithm makes full use of the fact that @xmath109 is a constant matrix in ( [ fk ] ) .",
    "therefore , @xmath128 is a constant matrix and the inverse of @xmath128 in ( [ gamma ] ) does not need to be repeated many times which is the main difference between the method in @xcite and the method in @xcite ( where @xmath129 is a constant matrix but @xmath120 is a series of time varying matrices and inverse has to take for every @xmath120 with @xmath118 ) .    the proposed method can easily be extended to the case of using momentum wheel where the speed of the flywheel is desired to be a non - zero constant .",
    "let @xmath130 be the desired speed of the momentum wheels and @xmath131^{\\tr}$ ] .",
    "the objective function of ( [ object ] ) should be revised to @xmath132dt .",
    "\\label{object1}\\ ] ]",
    "our simulation has several goals .",
    "first , we would like to show that the proposed design achieves both attitude control and reaction wheel momentum management .",
    "second , we would like to compare with the design @xcite which does not use reaction wheels , our purpose is to show that using reaction wheels achieves better attitude pointing accuracy . more important",
    ", we would like to demonstrate that the lqr design works very well for attitude and desaturation control for the nonlinear spacecraft in the environment close to the reality .",
    "finally , we will discuss the strategy in real spacecraft control system implementation .",
    "the proposed design algorithm has been tested using the same spacecraft model and orbit parameters as in @xcite with the spacecraft inertia matrix given by @xmath133 the orbital inclination @xmath134 and the orbit is assumed to be circular with the altitude @xmath135 km . in view of equation ( [ period ] ) , the orbital period is @xmath136 seconds and the orbital rate is @xmath137 rad / second . assuming that the total number of samples taken in one orbit is @xmath138 , then , each sample period is @xmath139 second .",
    "it is easy to see that all parameters are selected the same as @xcite so that we can compare the two different designs .",
    "select @xmath140)$ ] and @xmath141)$ ] .",
    "we have calculated and stored @xmath126 for @xmath142 using algorithm [ desat ] .",
    "assuming that the initial quaternion error is @xmath143 , initial body rate vector is @xmath144 radians / second , and the initial wheel speed vector is @xmath144 radians / second , applying the feedback ( [ soluv ] ) to the linearized system ( [ linearmodel1 ] ) and ( [ varyb ] ) , we get the linearized spacecraft rotational rate response described in figure [ fig : linearscw ] , the reaction wheel response descried in figure [ fig : linearwheelw ] , and the spacecraft attitude responses given in figures [ fig : linearscq ] .    comparing the response obtained here using both reaction wheels and magnetic torque coils and the response obtained in @xcite that uses magnetic torques",
    "only , we can see that both control methods stabilize the spacecraft , but using reaction wheels achieve much accurate nadir pointing .",
    "also reaction wheel speeds approach to zero as @xmath145 goes to infinity .",
    "therefore , the second design goal for reaction wheel desaturation is achieved nicely .",
    "it is nature to ask the following question : can the designed controller ( [ soluv ] ) , which is based on the linearized model , stabilize the original nonlinear spacecraft system ( [ dynamicsall ] ) with satisfied performance ?",
    "we answer this question by applying the designed controller to the original nonlinear spacecraft system ( [ dynamicsall ] ) .",
    "more specifically , the lvlh frame rotational rate @xmath8 is calculated using the accurate nonlinear formula ( [ n9 ] ) not the approximated linear model ( [ 9 ] ) .",
    "the gravity gradient torque @xmath23 is calculated using the accurate nonlinear formula ( [ ginterm1 ] ) not the approximated linear model ( [ 22 ] ) .",
    "the earth s magnetic field is calculated using the much accurate international geomagnetic reference field ( igrf ) model @xcite not the simplified model ( [ field ] ) .",
    "this is done as follows .",
    "given the altitude of the spacecraft ( @xmath135 km ) , the orbital radius @xmath146 is @xmath147 kilo meters and the lateral speed of the spacecraft is @xmath148 @xcite . assuming that the ascending node at @xmath88 ( `` now '' ) is the @xmath149 axis of the ecef frame , the velocity vector @xmath150^{\\tr}$ ] . using algorithm 3.4 of @xcite",
    ", we can get the spacecraft coordinate in eci frame at any time after @xmath88 . converting eci coordinate to ecef coordinate , we can calculate a much accurate earth magnetic field vector @xmath151 using igrf model @xcite , which has been implemented in matlab . applying this earth magnetic field vector @xmath151 and feedback control @xmath152 designed by the lqr method to ( [ dynamicsall ] ) , we control the nonlinear spacecraft system using the lqr controller .",
    "also , we allow randomly generated larger initial errors ( possibly @xmath153 time large than we used in the previous simulation test ) in this simulation test .",
    "the nonlinear spacecraft system response to the lqr controller is given in figures [ fig : nonlinearscw ] , [ fig : nonlinearwheelw ] , and [ fig : nonlinearscq ] .",
    "these figures show that the proposed design does achieve our design goals .",
    "moreover , the difference between the linear ( approximate ) system response and nonlinear ( true ) system response for the lqr design is very small !      in real space environment , even the magnetic field vector obtained from the high fidelity igrf model may not be identical to the real magnetic field vector which can be measured by magnetometer installed on spacecraft .",
    "therefore , it is suggested to use the measured magnetic field vector @xmath151 to form @xmath97 in the state feedback ( [ soluv ] ) . because of the interaction between the magnetic torque coils and the magnetometer , it is a common practice that measurement and control are not taken at the same time ( some time slot in the sample period",
    "is allocated to the measurement and the rest time in the sample period is allocated for control ) .",
    "therefore , a scaling for the control gain should be taken to compensate for the time loss in the sample period when measurement is taken .",
    "for example , if the magnetic field measurement uses half time of the sample period , the control gain should be doubled because only half sample period is used for control .",
    "this is similar to the method used in @xcite .",
    "in this paper , we developed a reduced quaternion spacecraft model which includes gravity gradient torque , geomagnetic field along the spacecrat orbit and its interaction with the magnetic torque coils , and the reaction wheels .",
    "we investigate a time - varying lqr design method to control the spacecraft attitude to align the body frame with the local vertical local horizontal frame and to desaturate the reaction momentum at the same time .",
    "a periodic optimal controller is proposed for this purpose .",
    "the periodic controller design is based on an efficient algorithm for the periodic time - varying riccati equations .",
    "simulation test is given to show that the design objective is achieved and the control system using both reaction wheels and magnetic torques accomplishes more accurate attitude than the control system using only magnetic torques .",
    "99 , kluwer academic publishers , dordrecht , holland , 1978 . spacecraft dynamics and",
    "control : a practical engineering approach , cambridge university press , cambridge , uk , 1997 .",
    "silani e. and lovera m. magnetic spacecraft attitude control : a survey and some new results , control engineering practice , 13 , pp .",
    "357 - 371 , 2005 .",
    "rodriquez - vazouez , a. martin - prats , m. a. and bernelli - zazzera f. spacecraft magnetic attitude control using approximating sequence riccati equations , ieee transactions on aerospace and electronic systems , 51(4 ) , pp .",
    "3374 - 3385 , 2015 .",
    "dzielsk , j. bergmann e. and paradiso j. a computational algorithm for spacecraft control and momentum management , proceedings of the 1990 american control conference , pp .",
    "1320 - 1325 , 1990 .",
    "chen x. steyn , w. h. hodgart , s. and hashida , y. optimal combined reaction - wheel momentum management for earth - pointing satellites , journal of guidance , control , and dynamics , 22(4 ) , pp .",
    "543 - 550 , 1999 .",
    "giulietti , f. quarta , a. a. and tortora , p. optimal control laws for momentum - wheel desaturation using magnetorquers , journal of guidance , control , and dynamics , 29(6 ) , pp .",
    "1464 - 1468 , 2006 .",
    "treqouet , j - f .",
    "arzelier , d. peaucelle , d. pittet , c. and zaccarian , l. reaction wheel desaturation using magnetorquers and and static input allocation , ieee transactions on control system technology , 23(2 ) , pp .",
    "525 - 539 , 2015 .",
    "de angelis , e.l .",
    "giulietti , f. de ruiter , a.h.j . and",
    "avanzini , g. spacecraft attitude control using magnetic and mechanical actuation , to appear in journal of guidance , control , and dynamics .",
    "yang , y. quaternion based model for momentum biased nadir pointing spacecraft , aerospace science and technology , 14(3 ) , pp .",
    "199 - 202 , 2010 .",
    "flamm , d.s . a new shift - invariant representation for periodic linear system , systems and control letters , 17(1 ) , pp . 9 - 14 , 1991 .",
    "khargonekar , p. p. poolla , k. and tanenbaum , a. robust control of linear time - invariant plants using periodic compensation , ieee transactions on automatic control , 30 ( 11 ) , pp .",
    "1088 - 1096 , 1985 .",
    "yang , y. an efficient algorithm for periodic riccati equation for spacecraft attitude control using magnetic torques , submitted , 2016 .",
    "available in arxiv:1601.01990 .",
    "yang , y. spacecraft attitude determination and control : quaternion - based method , annual reviews in control , 36 ( 2 ) , pp .",
    "198 - 219 , 2012 . , books / cole thomson learing , belmont , ca , 2004 .",
    "wie , b. vehicle dynamics and control , aiaa education series , reston , va , 1998 .",
    "yang , y. analytic lqr design for spacecraft control system based on quaternion model , journal of aerospace engineering , 25(3 ) , pp .",
    "448 - 453 , 2012 .",
    "yang , y. quaternion based lqr spacecraft control design is a robust pole assignment design , journal of aerospace engineering , 27(1 ) , pp .",
    "168 - 176 , 2014 .",
    "lewis , f.l .",
    "vrabie , d. and syrmos , v.l . optimal control , 3rd edition , john wiley & sons , inc .",
    ", new york , usa , 2012 .",
    "paiaki , m.l .",
    "magnetic torque attitude control via asymptotic period linear quadratic regulation , journal of guidance , control , and dynamics , 24(2 ) , pp .",
    "386 - 394 , 2001 .",
    "yang , y. controllability of spacecraft using only magnetic torques , ieee transactions on aerospace and electronic system , 52(2 ) , pp . 955 - 962 , 2016 .",
    "arnold , w.f . ,",
    "iii and laub , a.j .",
    "generalized eigenproblem algorithms and software for algebraic riccati equations , proc .",
    "ieee , 72 , pp .",
    "1746 - 1754 , 1984 .",
    "bittanti , s. periodic riccati equation , the riccati equation , edited by s. bittanti , et .",
    "al , spriner , berlin , pp .",
    "127 - 162 , 1991 .",
    "hench , j.j . and",
    "laub , a.j .",
    "numerical solution of the discrete - time periodic riccati equation , ieee transactions on automatic control , 39(6 ) , pp .",
    "1197 - 1210 , 1994 .",
    "curtis , h. d. orbital mechanics for engineering students , elsevier butterworth - heinemann , burlington , ma , 2005 .",
    "finlay , c.c .",
    "et al , special issue `` international geomagnetic reference field - the twelfth generation '' , earth , planets and space , 67:158 , 2015 .",
    "yang , y. attitude control in spacecraft orbit - raising using a reduced quaternion model , advances in aircraft and spacecraft science , vol . 1 , no . 4 ( 2014 ) pp .",
    "427 - 441 ."
  ],
  "abstract_text": [
    "<S> two popular types of spacecraft actuators are reaction wheels and magnetic torque coils . </S>",
    "<S> magnetic torque coils are particularly interesting because they can be used for both attitude control and reaction wheel momentum management ( desaturation control ) . </S>",
    "<S> although these two tasks are performed at the same time using the same set of actuators , most design methods deal with only one of the these tasks or consider these two tasks separately . in this paper , a design with these two tasks in mind is formulated as a single problem . </S>",
    "<S> a periodic time - varying linear quadratic regulator design method is then proposed to solve this problem . </S>",
    "<S> a simulation example is provided to describe the benefit of the new strategy .    </S>",
    "<S> * keywords : * spacecraft attitude control , reaction wheel desaturation , linear time - varying system , reduced quaternion model , linear quadratic regulator . </S>"
  ]
}