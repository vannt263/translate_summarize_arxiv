{
  "article_text": [
    "advancements in quantum research have enabled breakthroughs in biology , chemistry , physics , engineering , and medicine including better methods to understand the structure of macromolecules used in biochemical signaling and drug delivery , to facilitate the fast and efficient storage of information , and to yield higher resolution medical images for diagnosis and treatment of early stage cancer @xcite .",
    "most , if not all , measurements and manipulations of quantum systems are achieved through the appropriate design of externally applied time - varying electromagnetic pulses , or controls @xcite .",
    "these pulses guide the system to produce a desired time - evolution or a specific terminal state .",
    "the design of such pulses is made significantly more difficult by inherent variations within the systems of interest .",
    "inhomogeneity is one of the fundamental obstacles for the practical implementation and physical realization of quantum science and quantum technology . in classical systems",
    "the dispersions resulting from inhomogeneity is often compensated for by feedback control .",
    "significant research effort has been employed in the area of quantum feedback control with several promising theoretical and practical discoveries in recent years @xcite .",
    "there is still a large portion of quantum systems for which state feedback is either impractical or difficult to achieve due to the short timescales and large state - space of quantum phenomena .",
    "these limitations motivate us to consider the open - loop synthesis of optimal pulses that achieve a desired goal while compensating for the inhomogeneity present in the quantum ensemble .",
    "the behavior of a bulk quantum _",
    "system _ is the aggregate behavior of a large ensemble of individual quantum _",
    "systems_. although in isolation these individual systems , e.g. atoms , spins , qubits , etc . , are fundamentally identical , in a physical system they are distinct due to different chemical and electromagnetic environments .",
    "this variation across the ensemble exhibits itself at the macroscopic level as variation in the values of parameters that characterize the dynamics of the bulk quantum system @xcite .",
    "for example , adjacent atoms within the same macromolecule shield the full strength of the applied external magnetic fields . varied levels of shielding create a dispersion in the frequency of the quantum spins , which is observed as inhomogeneity in the value of the natural frequency of the bulk sample .",
    "in addition , hardware imperfection causes attenuation in the applied electromagnetic pulse over the ensemble and can be represented as variation in a scaling factor multiplying the applied pulse . often several pulses are applied in sequence in order to achieve an intricate time - evolution of the system @xcite .",
    "each pulse is designed assuming an exact ( usually uniform ) initial system state , however , in practice , the previous pulses only prepare the system to within a neighborhood of the assumed initial state .",
    "the additive error in such a pulse sequence can cause significant performance degradation .",
    "guiding the evolution of inhomogeneous ensembles is a central idea in the design and implementation of quantum experiments . as such",
    ", there is a rich literature of methods addressing this class of challenging problems .",
    "initially these were intuitive or ad - hoc methods motivated by the symmetry of the state space @xcite , which were then augmented with various heuristic and specifically designed techniques @xcite .",
    "more recently pulse design problems have been cast as optimal control problems @xcite .",
    "here we present a methodology that addresses the difficulties of the current methods and is easily generalizable to any inhomogeneous ensemble or uncertain system .",
    "the proposed method has both theoretical , such as convergence rates and computational complexity , and practical , such as ease of implementation and computation time , advantages .    in this article",
    "we describe a framework to pose robust quantum pulse design problems in the language of mathematical control theory with support from new theoretical concepts in ensemble control @xcite and computational advances in multidimensional pseudospectral methods adapted for ensemble systems @xcite . in a larger context",
    ", we provide a rigorous methodology to study and control inhomogeneous ensembles or systems with parameter uncertainty from any area or application . in the following section we introduce the problem statement as well as our theoretical and computational tools . in section",
    "[ sec : examples ] , we take several examples from nuclear magnetic resonance ( nmr ) in liquids modeled by the bilinear bloch equations , including broadband excitation in the presence of inhomogeneity , a sequence of broadband pulses robust to variation in the initial conditions , and systems with a time - varying frequency .",
    "we then provide empirical and theoretical justifications that the solutions computed using the pseudospectral method converge to solution of the original optimal control problem .",
    "in this section , we review the underlying concepts involved in our approach to design robust quantum pulses as well as the broader mathematical formulations necessary to characterize and solve such design problems . in",
    "what follows , we present a highly general model of quantum dynamics , which demonstrates the abundance of inhomogeneity in these problems and motivates studying the control of a family of parameterized systems .",
    "we then show how the notion of ensemble control is well suited for dealing with the inherent variation and uncertainty in practical quantum systems and formulate a new type of optimal control problem based on ensemble control .",
    "the dynamics of a quantum system is given by the time - evolution of its density matrix .",
    "we consider here general dynamics in which the system may have interaction with the environment that leads to dissipation in the system state . under the markovian approximation , where the environment is modeled as an infinite thermostat which has constant state ,",
    "the evolution of the density matrix can be written in lindblad form in terms of the system hamiltonian @xmath0 and superoperator @xmath1 which model the unitary and nonunitary dynamics @xcite , respectively , @xmath2-l(\\rho ) , \\qquad ( \\hbar=1).\\ ] ] the expression of the hamiltonian has components corresponding to free evolution hamiltonian , @xmath3 , and the control hamiltonians @xmath4 , @xmath5 where @xmath6 are externally applied electromagnetic pulses that can be used to manipulate , or guide , the evolution of the system state .",
    "typical pulse design problems involve designing these pulses , or controls , to bring the final state of the density matrix @xmath7 as close as possible to a target operator .",
    "this problem can be transformed , by taking the expectation values of the operators involved in the state transfer , to the vector - valued , bilinear control problem , @xmath8 and @xmath9 given by , @xmath10x,\\ ] ] where @xmath11 corresponds to the drift evolution representing @xmath3 and @xmath12 , @xmath13 corresponds to the controlled evolution representing @xmath4 , and @xmath14 $ ] @xcite . while ( [ eq : quantum_single ] ) accurately represents the classical interaction of magnetic fields , in practice the effective fields - and , therefore , the matrices representing the hamiltonians @xmath15 and @xmath16 - show variation in magnitude due to different chemical environments and equipment errors . the system can no longer be described by a single equation but rather by a family of equations with variation in the parameters that characterize the motion , which motivates us to consider the dispersion in the dynamics as a continuum parameterized by the system values , @xmath17x(t , s),\\ ] ] where @xmath18 is a @xmath19-dimensional interval representing the @xmath19 parameters exhibiting variation @xcite . in a more general formulation the matrices representing the hamiltonians can be time - dependent , @xmath20 and @xmath21 , as in the case of random fluctuations .",
    "designing a single set of controls ( pulses ) @xmath6 that simultaneously steer an ensemble of dispersive systems in ( [ eq : quantum_ensemble ] ) from an initial state to a desired final state is a fundamental problem in the control of quantum systems .",
    "moreover , similar parameterized structures can be found across all areas of science and engineering , such as in neuroscience where a single stimulus is used to trigger a simultaneous firing of neuron oscillators with distinct oscillation frequencies @xcite . in these applications full state feedback , which is required in most current methods to compensate for system uncertainty ,",
    "is impractical to obtain due to the sheer number of members ( and states ) within the ensemble .",
    "averaged measurement is possible in some applications , however , this type of measurement restricts the forms of available feedback .",
    "it is , then , of particular importance to consider the corresponding open - loop control problem .",
    "systems as in ( [ eq : quantum_ensemble ] ) motivate the study of a new class of inhomogeneous control systems .",
    "ensemble control @xcite is a mathematical framework to characterize parameterized systems of the form , @xmath22 where @xmath8 , @xmath9 , @xmath18 , with @xmath23 and @xmath24 smooth functions of their respective arguments .",
    "the significant challenge of this class of control problems originates from requiring the same open - loop control , @xmath25 to guide the continuum of systems from an initial distribution , @xmath24 , to a desired final distribution , over the corresponding function space .",
    "fundamental properties of these systems , such as controllability , are of particular interest - specifically addressing what types of inhomogeneities can be compensated for robustly .",
    "for example , it has been shown that the controllability of an ensemble of bilinear bloch equations , used as a sample system in this paper ( see section [ sec : examples ] ) , corresponds to the synthesis of appropriate polynomials @xcite and controllability conditions for an ensemble of time - varying linear systems are related to the picard criterion of fredholm integral equations of the first kind @xcite .    subsequently , given dynamics and initial and final distributions , we seek methods to construct controls for such steering problems . as with any control problem ,",
    "in general there may be many possible solutions that satisfy a state - to - state ensemble control problem .",
    "in addition there are often benefits , penalties , and limitations that are associated with the physical system , which can be used to rank the different solutions .",
    "such practical considerations lead to considering an optimal control problem based on the ensemble dynamics in ( [ eq : ensembledynamics ] ) which includes a cost functional ( with terminal , @xmath26 , and running , @xmath27 , cost terms ) to be minimized as well as possible endpoint and path constraints ( @xmath28 and @xmath29 , respectively ) , @xmath30 an optimal nonlinear control problem of this form is , in general , analytically intractable .",
    "computational methods are then required to solve such exceedingly complex optimal ensemble control problems .",
    "the idea from our previous work that constructing appropriate polynomials is a key tool in characterizing the controllability of ensemble systems of interest motivates the use of polynomials within the computational framework @xcite .",
    "below we review the main ideas of the previously established pseudospectral method for optimal control to lay the foundation for our developed extension to optimal ensemble control problems . in section [ sec : convergence ] we complete this framework with a proof of convergence of this numerical method .    without loss of generality , we consider a general continuous - time optimal control problem defined on the time interval @xmath31 $ ] , which can be achieved by a simple affine transformation .",
    "[ prob : c ] @xmath32 where @xmath33 is the terminal cost ; the running cost , @xmath34 , where @xmath35 is the space of continuous functions with @xmath36 classical derivatives , and dynamics , @xmath37 , where @xmath38 is the space of @xmath39-vector valued @xmath40 functions , with respect to the state , @xmath41 , and control , @xmath42 ; @xmath28 and @xmath29 are terminal and path constraints , respectively ; @xmath43 is the @xmath44-vector valued sobolev space .",
    "the norm associated with the sobolev space with @xmath45 , @xmath46 , is given with respect to the @xmath47 norm @xcite ,    @xmath48      the pseudospectral method was originally developed to solve problems in fluid dynamics and since then has been successfully used for optimal control @xcite and applied to various areas @xcite .",
    "pseudospectral discretization methods use expansions of orthogonal polynomials to approximate the states of the system and thereby inherit the spectral accuracy characteristic of orthogonal polynomial expansions ( the @xmath49 coefficient of the expansion decreases faster than any inverse power of @xmath50 ) @xcite . through special properties , derivatives of these orthogonal polynomials",
    "can be expressed in terms of the polynomials themselves , making it possible to accurately approximate the differential equation that describes the dynamics with an algebraic relation imposed at a small number of discretization points .",
    "an appropriate choice of these discretization points , or nodes , facilitates the approximation of the states as well as ensuring accurate numerical integration through gaussian quadrature .    as a collocation ( or interpolation ) method ,",
    "the pseudospectral method uses lagrange polynomials to approximate the states and controls of the optimal control problem , @xmath51 where @xmath52 and @xmath53 because the lagrange polynomials have the property @xmath54 , where @xmath55 is the kronecker delta function and @xmath56 are the interpolation nodes @xcite . therefore , the coefficients @xmath57 and @xmath58 are the discretized values of the original problem and become the decision variables of the subsequent discrete problem .",
    "although the interpolation with lagrange polynomials discretizes the original problem , we require a means to ensure that both the integral in the cost functional is computed accurately and the dynamics are obeyed",
    ". the integral can be approximated through gauss quadrature ; here we use legendre polynomials as the orthogonal basis for the pseudospectral method .",
    "the legendre - gauss - lobatto ( lgl ) quadrature approximation , @xmath59 is exact if the integrand @xmath60 and the nodes @xmath61 , where @xmath62 denotes the set of polynomials of degree at most @xmath63 and where @xmath64 are the @xmath65 lgl nodes determined by the derivative of the @xmath66 order legendre polynomial , @xmath67 , and the interval endpoints @xcite .    using the lgl nodes",
    ", we can rewrite the lagrange polynomials in terms of the orthogonal legendre polynomials , which is critical to inherit the special derivative and spectral accuracy properties of the orthogonal polynomials despite using lagrange interpolating polynomials .",
    "given @xmath68 , we can express the lagrange polynomials as @xcite , @xmath69 the derivative of ( [ eq : ix ] ) at @xmath70 is then , @xmath71 where @xmath72 is the constant differentiation matrix @xcite .",
    "we are now able to write the discretized optimal control problem using equations ( [ eq : ix ] ) , ( [ eq : iu ] ) , ( [ eq : gaussquad ] ) , and ( [ eq : dinterpsc_j ] ) .",
    "we transform the continuous - time problem to a constrained optimization , @xmath73      the pseudospectral method lends itself to a natural extension to consider the ensemble case , which we develop here .",
    "this is most readily apparent for a single parameter variation , i.e. , @xmath74\\subset\\mathbb{r}$ ] , however , is easily scaled to an arbitrary parameter dimension . in this basic case ,",
    "the ensemble extension of ( [ eq : ix ] ) is @xmath75 the approximate derivative from ( [ eq : dinterpsc_j ] ) at the lgl nodes in the respective @xmath76 and @xmath77 domains , @xmath61 and @xmath78 , is @xmath79 where @xmath80 . in these equations",
    "we use a two - dimensional interpolating grid at the @xmath65 and @xmath81 lgl nodes in time and the parameter , respectively . for a general number of parameters , @xmath82 , @xmath83 and",
    "the derivative is , correspondingly , with @xmath84 , @xmath85 the simplification from ( [ eq : xdd ] ) to ( [ eq : dxdd ] ) illustrates why the pseudospectral approximations are effective methods for ensemble control , as they mimic the lack of information in the parameter dimension .",
    "this aspect will also make the extension of the convergence proof for ensemble systems straightforward , as will be discussed in section [ sec : convergence ] .",
    "in this paper , we consider several examples based on the prototypical quantum control system described by the bloch equations @xcite .",
    "the bloch equations have been found to model a range of quantum phenomena from protein spectroscopy in nuclear magnetic resonance ( nmr ) @xcite and medical scans in magnetic resonance imaging ( mri ) @xcite to rabbi oscillations in quantum optics @xcite . in the following discussion",
    ", we will consider the specific application and terminology for nmr spectroscopy , however , the methods and results are easily transferred to these other areas of interest . in nmr spectroscopy ,",
    "when the duration of the pulse design problem is small compared with the relaxation times ( @xmath86 , the characteristic longitudinal and transverse relaxation times , respectively ) , the evolution of spins can be well approximated as sequences of unitary rotations driven by the static magnetic field and the applied electromagnetic controls . in practice ,",
    "the effective fields generating these rotations show variation across the quantum sample due to hardware imperfection and chemical shielding , which leads us to consider a range of magnetic field variations .",
    "the corresponding dimensionless bloch equations in the rotating frame ( see appendix [ apdx : bloch ] ) are , @xmath87m(t,\\omega,\\epsilon),\\ ] ] where @xmath88 is the cartesian magnetization vector for the parameter values @xmath89 ,",
    "@xmath90\\subset\\mathbb{r}$ ] , is the dispersion of natural frequencies , @xmath91 $ ] , @xmath92 , is the amplitude attenuation factor , and @xmath93 is the generator of rotation around the @xmath36 axis .",
    "a pulse that compensates for the dispersion in frequency and is insensitive to the scaling of the applied controls is called a broadband pulse robust to inhomogeneity . in this section we consider several examples based on this model , including pulses robust not only to frequency dispersion and inhomogeneity , but also robust to uncertainty in initial conditions and time - varying frequencies .",
    "variation and dispersion in system dynamics pervade all physical experiments . in quantum systems , these inhomogeneities are often large enough to cause significant reduction in performance .",
    "the systematic framework we present here provides a rigorous way to frame any general pulse design problem for quantum control , as well as other areas of parameterized and uncertain systems .",
    "a canonical problem in the control of quantum systems modeled by the bloch equations is to design pulses that will accomplish a state - to - state transfer of the system .",
    "such pulses , e.g. , @xmath95 and @xmath94 pulses ( accomplishing @xmath95 and @xmath94 rotations , respectively ) , are the fundamental building blocks of the pulse sequences used in many quantum experiments . here , consider the inversion , or @xmath94 , pulse that rotates the net magnetization from the equilibrium position ( @xmath96 ) to the @xmath97 axis , i.e. , @xmath98 . in the ensemble case",
    ", this goal corresponds to a uniform inversion of the spin vector across all choices of frequency and inhomogeneity .",
    "specifically we consider the optimal ensemble control problem , @xmath99m(t,\\omega,\\epsilon ) , \\nonumber \\\\ & m(0,\\omega,\\epsilon ) = ( 0\\ 0\\ 1)^\\prime , \\vphantom{\\bigl ( } \\nonumber\\\\ & \\sqrt{u^2(t ) + v^2(t ) } \\leq a,\\ \\forall\\ , t\\in[0,t ] , \\vphantom{\\bigl ( } \\nonumber\\end{aligned}\\ ] ] where @xmath100 is the maximum allowable amplitude and the cost functional serves to equally minimize the z - component of the spin vector ( integrated across the ensemble ) and the energy of the designed pulse .     while compensating for @xmath101 $ ] and @xmath102 $ ] , i.e. , @xmath103 and @xmath104 .",
    "the final states @xmath105 shown have an average value less than -0.99 , achieving a highly uniform transfer across the ensemble . ]",
    "figure [ fig : pattern ] displays a pulse that compensates for @xmath103 and @xmath104 ( 10% ) as well as the corresponding inversion profile . in physical units for a normalizing amplitude of 10 khz ,",
    "the maximum amplitude is @xmath106 khz with bandwidth @xmath107 $ ] khz and duration @xmath108 @xmath109s .",
    "pulses developed in this manner have been implemented experimentally in true protein nmr experiments to yield significant improvement in signal recovery @xcite .",
    "although designing individual pulses is of importance and benefit there are a myriad of other variations and uncertainties within typical quantum experiments , which calls for an approach that can address such new inhomogeneities and their corresponding challenges .      in most experiments , individual pulses , such as the one in figure [ fig : pattern ] ,",
    "are combined into a longer pulse sequence , which performs a more complicated manipulation of the system state with intermediate steps and goals . even in the case of highly optimized individual pulses ,",
    "as shown in the prior example , there is an error between the desired and actual final states .",
    "moreover , pulses depend upon an exact ( and usually uniform ) initial condition in order to achieve their expected levels of performance .",
    "these effects combine to create a magnified accumulated error at the termination of the pulse sequence .",
    "the variation of the initial conditions of these pulses , therefore , causes significant degradation in achievable performance .",
    "evolution of the bloch equations .",
    "the upper plot displays the concatenation of individually optimized @xmath110 and @xmath111 pulses , which achieves the dashed terminal profiles shown below , with respective average performances : 0.99 , 0.98 , 0.97 ( 0.91 minimum ) .",
    "the middle plot displays a 3-part simultaneously - optimized pulse robust to variation in the initial condition and achieves the solid terminal profiles shown below , with respective average performances : 0.99 , 0.99 , 0.99 ( 0.97 minimum ) .",
    "the noticeable enhancement in performance and uniformity is due to compensating for the inhomogeneity in the initial condition of the individual pulses . ]",
    "a representative example of such a pulse sequence is to perform a three step pulse sequence , which rotates the magnetization of the ensemble ( 1 ) from equilibrium ( @xmath96 ) to a point on the transverse plane ( e.g. @xmath112 ) ; ( 2 ) to the opposite point on the transverse plane ( e.g. @xmath113 ) ; ( 3 ) back to the equilibrium position ( @xmath96 ) .",
    "such pulses generally include `` phase locking '' pulses before and after the second pulse during which the magnetization dissipates .",
    "this dissipation is the portion of the experiment that is important to recover accurately and reflects a quantity to be measured , for example , a metabolic rate @xcite . if , in addition , there is accumulated error due to uncertainty in the initial conditions of the individual pulses , this leads directly to measurement inaccuracy . here , by removing the `` phase locking '' pulses , we can abstract this pulse sequence to a unitary process and directly address any losses due to error .",
    "the controllability of the bloch equations is shown constructing parameter - dependent ( e.g. frequency , rf inhomogeneity ) rotations of the spin vectors @xcite .",
    "this , therefore , ensures that the problem with variation in initial conditions can be solved provided that the initial conditions can be parameterized by the frequency and rf - inhomogeneity .",
    "figure [ fig : initialcond ] displays a three - stage optimized pulse designed by the multidimensional pseudospectral method which is robust to frequency dispersion and variation in the initial conditions of the three stages .",
    "this pulse was run as three concurrent optimizations , with the final states of one pulse fed in as the initial conditions of the next .",
    "this optimized pulse is compared with the combination of three separately optimized pulses ; these combined pulses were designed with equal total duration .",
    "the terminal profiles at each intermediate goal quickly show the evidence of accumulated error in the case of the individually optimized pulses ( each individual pulse has an average performance greater than 0.98 ) .",
    "most importantly , the uniformity of the inversion is lost in the additive error , with dips in performance down to 0.91 .      until now",
    ", we have considered that the dispersion and uncertainty of the system are stationary . however , addressing time - varying fluctuations in parameters is also of particular theoretical and practical importance .",
    "for example , in the formulation of quantum control problems given in ( [ eq : quantum_ensemble ] ) we noted that the hamiltonians can be time - varying , motivated by such phenomena as random telegraph noise @xcite .",
    "the first step to addressing stochastic variations in such physical systems is to demonstrate control of time - varying systems , such as given by the expectation value of the corresponding random process .    .",
    "a single - system state transfer @xmath114 is designed using the terminal cost @xmath115 and running costs @xmath116 ( left ) , @xmath117 ( middle ) , @xmath118 ( right ) .",
    "the terminal time was free in all cases , bounded by @xmath119 . ]",
    "figure [ fig : timevarying ] presents a series of optimizations designing @xmath95 pulses providing a state transfer @xmath96 to @xmath120 , while compensating for a time - varying frequency , @xmath121 .",
    "various choices of cost functional yield different results .",
    "the arbitrary control pulse profile corresponding to the terminal cost @xmath122 ( fig .",
    "[ fig : timevarying ] , left ) motivates studying optimal control methods that provide the capacity for hybrid objectives resulting in more physically meaningful controls , e.g. minimizing energy ( middle ) and time ( right ) .",
    "by accepting and implementing a numerical method , we implicitly assume that the transformations and discretization used to prepare the problem for computational work does not fundamentally alter the nature of the problem .",
    "it is then critically important to show that this assumption is justified .",
    "here we do so by both empirical and theoretical means . more specifically , we show that as the number of discretizations in the pseudospectral method ( and samples in the multidimensional pseudospectral method ) increases the solution of the algebraic nonlinear programming problem converges to the solution of the original continuous - time optimal control problem . for this argument",
    ", we consider a modified nonlinear programming problem statement .",
    "[ prob : d ] @xmath123 where @xmath124 is a positive constant ; we define the discrete @xmath125 norm @xmath126 , for @xmath127 , @xmath31 $ ] , with , @xmath128 where @xmath129 denotes the transpose and @xmath130 is the gauss quadrature weight from ( [ eq : gaussquad ] ) .",
    "[ rmk : relax_dynamics ] the dynamics in ( [ eq : d_dynamics ] ) have been relaxed from the equality in ( [ eq : d1_dynamics ] ) to ensure the feasibility of the discrete problem , which is used in proposition [ prop : feasibility ] .",
    "it is trivial to show that in the limit , as @xmath131 , these two conditions coincide .",
    "we seek to address three questions related to solving the continuous - time optimal control ( problem [ prob : c ] ) by solving the pseudospectral discretized constrained optimization ( problem [ prob : d ] ) .",
    "suppose a feasible solution @xmath132 exists to problem [ prob : c ] . under what conditions :    1 .",
    "* _ feasibility : _ * for a given order of approximation , @xmath133 , does problem [ prob : d ] have a feasible solution , @xmath134 , which are the interpolation coefficients given in ( [ eq : ix ] ) and ( [ eq : iu ] ) ? 2 .",
    "* _ convergence : _ * as @xmath133 increases , does the sequence of optimal solutions , @xmath135 , to problem [ prob : d ] have a corresponding sequence of interpolating polynomials which converges to a feasible solution of problem [ prob : c ] ?",
    "namely , @xmath136 3 .",
    "* _ consistency : _ * as @xmath133 increases , does the convergent sequence of interpolating polynomials corresponding to the optimal solutions of problem [ prob : d ] converge to an optimal solution of problem [ prob : c ] ?",
    "namely , @xmath137    [ rmk : consistency ] it is possible that problem [ prob : c ] has more than one optimal solution , i.e. , there is more than one solution with the same optimal cost @xmath138 .",
    "therefore , to show that the sequence of discrete solutions converges to _ an _ optimal solution , we can instead show that the cost of the discrete solution , @xmath139 , converges to the optimal cost @xmath140 .",
    "previous work has been done in the area of convergence of the pseudospectral method and we aim to augment this literature with several key insights that make convergence results applicable to a wider class of systems and relax the conditions on which the current proofs are based .",
    "rather complete analysis has been done for the class of nonlinear systems which can be feedback linearized , including convergence rates @xcite .",
    "we show below that ensemble quantum systems of interest do not fall within the class of feedback linearizable systems .",
    "work has also included general nonlinear systems , but with the assumption that the solutions of the algebraic nonlinear programming problem have a limit point ( i.e. , have a convergent subsequence ) @xcite . in the language",
    "used above , this is very close to assuming `` convergence '' , which in this presentation we relax and prove feasibility , convergence , and consistency directly .",
    "finally , we examine the convergence of the multidimensional pseudospectral method as applied to ensemble optimal control problems . in what follows",
    "we consider first the convergence of the standard pseudospectral method and then discuss the convergence of the ensemble case .",
    "we first observe that ensemble control systems of interest are not feedback linearizable @xcite , which motivates a need for a more general convergence proof .",
    "consider the bilinear bloch equations in ( [ eq : bloch ] ) without variation in rf inhomogeneity ( i.e. , @xmath141 ) .",
    "the ability to feedback linearize a general nonlinear system is given by the lie algebra generated by the drift and control vector fields ( the conditions on this algebra must hold for each control term individually ; here we consider the case for @xmath142 ) .",
    "in particular , the terms @xmath143 , @xmath144 , @xmath145 , @xmath146 , and , @xmath147 where @xmath148 , and @xmath149 is any value in the interval @xmath150 .",
    "it is clear that this lie algebra , with increasing powers of the parameter @xmath149 , is never closed .",
    "therefore , the span of the appropriate lie brackets is not involutive , which indicates that such a system is not feedback linearizable .",
    "the orthogonal polynomials of the pseudospectral method provide spectral convergence rates similar to fourier series approximations for periodic functions , which can easily be seen in practice .",
    "figure [ fig : convergence ] shows the rapid convergence of the method in both the discretization ( time ) and sampling ( parameter ) dimensions for a broadband @xmath95 pulse maximizing the terminal @xmath151 value across the ensemble . as the order of discretization ( n ) and/or sampling ( @xmath152 ) increase , the method yields an objective ( @xmath153 ) that converges to the maximum value of unity .",
    "the low order of approximation is a characteristic of the orthogonal approximations at the heart of the numerical method .",
    "although such empirical figures are convincing , we now show this convergence in a more rigorous fashion .",
    "pulse designed to perform the state transfer @xmath154 , with @xmath103 and @xmath155 .",
    "average terminal values of @xmath156 are shown for various choices of @xmath133 and @xmath157 . ]      the results in this section will provide the foundation on which we can analyze the feasibility , convergence , and consistency of the pseudospectral approximation method for optimal control problems .",
    "we begin by presenting several key established results in polynomial approximation theory and the natural vector extensions . with these identities , we are able to then prove feasibility and convergence .",
    "we define an optimal solution to problem [ prob : c ] as any feasible solution that achieves the optimal cost @xmath138 .",
    "we use this definition of an optimal solution within the subsequent preliminaries and the main result .",
    "[ lem : xha ] given problem [ prob : c ] , @xmath158 . since @xmath159 exists and @xmath37 , all the derivatives @xmath160 , @xmath161 exist and are square integrable on the compact domain @xmath162 , @xmath163 .",
    "therefore , @xmath158 .",
    "[ lem : poly_approx ] if @xmath164 , the following hold with @xmath165 .",
    "a.   [ lem : interp ] the interpolation error is bounded , @xmath166 b.   [ lem : interp_derivative ] the error between the exact derivative and the derivative of the interpolation is bounded , @xmath167 the same bound holds for the discrete @xmath47 norm , @xmath168 c.   [ lem : interp_integral ] the error due to quadrature integration is bounded , @xmath169 where @xmath56 is the @xmath170 lgl node and @xmath130 is the corresponding @xmath170 weight for lgl quadrature as defined in ( [ eq : gaussquad ] ) .",
    "[ lem : vector ] if @xmath171 , i.e. , an @xmath39-vector valued sobolev space , @xmath172 , @xmath173 , @xmath174 .",
    "a.   the vector - valued extension of lemma [ lem : poly_approx][lem : interp ] is , by the triangle inequality on the @xmath125 norm , @xmath175 b.   similarly , [ lem : poly_approx][lem : interp_derivative ] can be extended , @xmath176 which again also holds for the discrete @xmath125 norm .    [",
    "prop : feasibility ] given a solution @xmath132 of problem [ prob : c ] , then problem [ prob : d ] has a feasible solution , @xmath134 , which are the corresponding interpolation coefficients .    given the feasible solution @xmath132 , let @xmath177 be the polynomial interpolation of this solution at the lgl nodes .",
    "our aim is to show that the coefficients of this interpolation satisfy ( [ eq : d_dynamics])-([eq : d_path ] ) of problem [ prob : d ] .",
    "consider the constraints imposed by the dynamics in ( [ eq : d_dynamics ] ) . because the discrete norm is evaluated only at the interpolation points , @xmath178 where the last step is given by lemma [ lem : vector][lem : interp_derivative ] .",
    "therefore , the interpolation coefficients @xmath134 satisfy the dynamics of problem [ prob : d ] in ( [ eq : d_dynamics ] ) .",
    "we can easily show that the path constraints are also satisfied because @xmath179 for all @xmath180 by ( [ eq : c_path ] ) .",
    "since this holds for all @xmath180 , it also holds for all lgl nodes @xmath181 , i.e. , @xmath182 which gives ( [ eq : d_path ] ) .",
    "the endpoint constraints are trivially satisfied by the definition of interpolation and the presence of interpolation nodes at both endpoints .",
    "therefore , @xmath134 is a feasible solution to problem [ prob : d ] .",
    "[ prop : convergence ] given the sequence of solutions to problem [ prob : d ] , @xmath183 , then the sequence of corresponding interpolation polynomials , @xmath184 , has a convergent subsequence , such that @xmath185 which is a feasible solution to problem [ prob : c ] .",
    "given that @xmath134 is a feasible solution of problem [ prob : d ] , it satisfies ( [ eq : d_dynamics])-([eq : d_path ] ) . our goal is to show ( i ) that the sequence of solutions , @xmath186 , has a convergent subsequence and ( ii ) that the limit point of this function subsequence is a feasible solution of problem [ prob : c ] , satisfying ( [ eq : c_dynamics])-([eq : c_path ] ) .    _",
    "( i ) _ the sequence @xmath187 , is a sequence of polynomials on a compact domain , therefore , @xmath188 . with the boundedness of the interpolating polynomials and the compactness of @xmath162 , rellich s theorem ( see appendix [ apdx : rellich ] ) states there is a subsequence @xmath189 which converges in @xmath190 .",
    "the same is true for the control interpolating polynomial .",
    "therefore , there exists at least one limit point of the function sequence @xmath184 which we denote @xmath191 .",
    "_ ( ii ) _ explicitly writing out the calculation of the discrete norm in ( [ eq : d_dynamics ] ) gives @xmath192 in the limit , because @xmath193 is continuous , @xmath194 therefore , @xmath195 which states that @xmath191 satisfies the dynamics in ( [ eq : c_dynamics ] ) at the interpolation nodes .",
    "moreover , as @xmath131 , the lgl nodes @xmath181 are dense in @xmath162 , which further shows that @xmath191 satisfies the dynamics of problem [ prob : c ] at all points on the interval @xmath162 .",
    "similarly , one can prove that this solution satisfies the path constraints because the lgl nodes become dense in @xmath162 as @xmath131 and @xmath196 at all lgl nodes .",
    "again , the endpoint constraints are met exactly because the lgl grid has nodes at the endpoints .",
    "[ lem : interp_cost_error ] given @xmath132 , where @xmath158 , @xmath197 , and the corresponding interpolation coefficients , @xmath134 , then the error in the continuous and discrete cost functionals defined in ( [ eq : c_cost ] ) and ( [ eq : d_cost ] ) , respectively , due to interpolation is given by , @xmath198    notice that @xmath132 and @xmath134 are not required to be a feasible solutions to problem [ prob : c ] and [ prob : d ] , respectively .",
    "this result characterizes the error due to interpolation .    from ( [ eq : c_dynamics ] ) and ( [ eq : d_dynamics ] ) since @xmath199 , @xmath200 since @xmath34 with respect to both the state and control , @xmath158 and @xmath197 , the composite function @xmath201 .",
    "let @xmath202 . substituting these definitions and employing lemma [ lem : poly_approx][lem : interp_integral ]",
    ", we obtain @xmath203 since @xmath204 , @xmath205 is bounded and the result follows .",
    "[ thm : convergence ] suppose problem [ prob : c ] has an optimal solution @xmath206 . given a sequence of optimal solutions to problem [ prob : d ] , @xmath207 , then the corresponding sequence of interpolating polynomials , @xmath208 , has a limit point , @xmath209 which is an optimal solution to the original optimal control problem .",
    "we break the proof into four sections , employing the results from the previous section .    _",
    "( i ) _ by proposition [ prop : feasibility ] , since @xmath210 is a solution to problem [ prob : c ] , then for each choice of @xmath133 , the corresponding interpolation coefficients , @xmath211 , are a feasible solution to problem [ prob : d ] . by the definition of optimality of @xmath212 , @xmath213    _ ( ii ) _ by proposition [ prop : convergence ] ,",
    "the limit point of the polynomial interpolation of the discrete optimal solution to problem [ prob : d ] , @xmath214 , is a feasible solution of problem [ prob : c ] .",
    "therefore , we have , by the definition of the optimality of @xmath210 and the continuity of @xmath215 , @xmath216    _ ( iii ) _ using lemma [ lem : interp_cost_error ] , we can bound the error in the cost between the optimal solution of problem [ prob : c ] , @xmath210 , and the corresponding interpolating coefficients , @xmath211 , as @xmath217 similarly , we can bound the error in the cost between the optimal solution of problem [ prob : d ] , @xmath218 , and the polynomial interpolation of this solution , @xmath219 , as @xmath220 recall that lemma [ lem : interp_cost_error ] does not require @xmath219 to be a feasible solution of problem [ prob : c ] . from ( [ eq : cinterp_error ] ) and ( [ eq : dinterp_error ] ) , @xmath221 = 0 .",
    "\\label{eq : jlimit_dopt }          \\end{aligned}\\ ] ]    _ ( iv ) _ we are now ready to assemble the various pieces of this proof . combining ( [ eq : jlimit_copt ] ) and ( [ eq : doptimality ] ) we have , @xmath222 adding the result from ( [ eq : coptimality ] ) , @xmath223 since the difference between the left and right sides , as given by ( [ eq : jlimit_dopt ] ) , decreases to zero as @xmath131 , the quantities @xmath224 and @xmath225 converge to @xmath226 . in particular , @xmath227 \\leq \\lim_{n\\rightarrow\\infty } \\big[j({\\mathcal{i}_n{{{x}^{\\dag}}}},{\\mathcal{i}_n{{{u}^{\\dag } } } } ) - { \\bar{j}}{({{\\bar{x}}^{\\dag}},{{\\bar{u}}^{\\dag}})}\\big ] = 0 .",
    "\\end{aligned}\\ ] ]    thus the optimal discrete cost @xmath224 of problem [ prob : d ] and the continuous cost @xmath225 of the corresponding interpolation polynomials converge to the optimal cost @xmath226 of problem [ prob : c ] .",
    "moreover , @xmath209 is a feasible solution to problem [ prob : c ] and achieves the optimal cost .",
    "therefore , @xmath209 is an optimal solution to problem [ prob : c ] .",
    "[ rmk : ensembleextension ] the nature in which the ensemble extension enters into the multidimensional pseudospectral method makes it straightforward to extend this convergence proof to the ensemble case . section [ sec : ensembleextension ] showed the simplicity of the derivative term in multidimensional sampling with equation ( [ eq : dxdd ] ) .",
    "similarly , in the ensemble case , the constraints corresponding to the dynamics ( [ eq : d_dynamics ] ) operate entirely in parallel for different parameter values . the additional integration in the cost function over the parameter domain , as in ( [ eq : ensemble_cost ] ) adds another layer of quadrature approximation that can be shown to converge with arguments similar to those presented above .",
    "in this work we have presented a cohesive perspective and methodology for optimal control of inhomogeneous ensembles , as particularly motivated by compelling problems in quantum control and extendable to both parameterized systems in , for example , neuroscience @xcite and uncertain systems throughout science and engineering .",
    "such systems are mathematically characterized by considering a parameterized family of differential equations indexed by a parameter vector that shows variation .",
    "applying this rigorous framework prompts us to solve the corresponding optimal control problems with computational methods of particular form .",
    "the notion of polynomial approximation entering into the controllability analysis of the bloch equations indicates that a modified pseudospectral method is a prime candidate .",
    "the method has natural extensions which we develop to model ensemble variation .",
    "this direct collocation method transforms the continuous - time optimal control problem into an algebraic nonlinear programming problem , which we show to be effective in a variety of applications .",
    "we supplied additional and more general arguments for the convergence of this method , in particular relaxing several assumptions and discussing the convergence characteristic of the multidimensional pseudospectral method for optimal ensemble control .",
    "the bloch equations without relaxation , @xmath228 , utilizes the classical description of interacting electromagnetic forces , where @xmath229 is the spin magnetization vector , @xmath230 is the gyromagnetic ratio , the effective externally applied field is @xmath231 , @xmath232 and @xmath233 are the amplitudes of the applied fields in the transverse plane and @xmath234 direction respectively , and @xmath235 is the phase angle @xcite . conventionally , the fields are given as frequencies @xmath236 and measured in units of hertz . using the generators of rotation , @xmath237 \\qquad \\omega_y = \\left [ \\begin{array}{ccc } 0 & 0 & 1 \\\\ 0 & 0 & 0 \\\\ -1 & 0 & 0 \\end{array } \\right ] \\qquad \\omega_z = \\left [ \\begin{array}{ccc } 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{array } \\right ] \\qquad\\ ] ]",
    "the bloch equations are be given by @xmath238{{\\mathcal{m}}}(t).\\ ] ]    if we consider variation in the applied electromagnetic fields @xmath233 and @xmath239 , we can express ( [ eq : blochreal ] ) in matrix form ,    @xmath240 = \\gamma      \\left [          \\begin{array}{ccc } 0 & -(\\omega_0+\\omega ) & \\epsilon b_1 \\sin(\\omega_0 t + \\phi ) \\\\",
    "\\omega_0+\\omega & 0 & -\\epsilon b_1 \\cos(\\omega_0 t + \\phi ) \\\\                  -\\epsilon b_1 \\sin(\\omega_0 t + \\phi ) & \\epsilon b_1 \\cos(\\omega_0 t + \\phi ) & 0          \\end{array }      \\right ]      \\left [ \\begin{array}{c } { { \\mathcal{m}}}_x(t,\\omega,\\epsilon ) \\\\ { { \\mathcal{m}}}_y(t,\\omega,\\epsilon ) \\\\ { { \\mathcal{m}}}_z(t,\\omega,\\epsilon ) \\end{array } \\right]\\ ] ]    where @xmath241 $ ] and @xmath91 $ ] , @xmath242",
    ". for calculation and computation , it is useful to transform the bloch equations into the so - called rotating frame and normalize the system by a nominal pulse amplitude @xmath100 to yield a dimensionless equation . solutions based on the dimensionless equation can then be scaled for a specific choice of nominal amplitude .",
    "consider a transformation @xmath243 .",
    "in addition we scale time with @xmath244 .",
    "it is straightforward to show that the new state equation is given by , @xmath245m(\\tau,\\omega,\\epsilon),\\ ] ] where @xmath246 $ ] , @xmath90 $ ] , @xmath247 , and @xmath248 ( all dimensionless ) .",
    "note the @xmath249 factor in the time scaling is introduced to convert from units of hertz to radians / second . designing the time - varying controls @xmath250 and",
    "@xmath251 is equivalent to the original design of amplitude @xmath232 and phase @xmath235 .",
    "[ thm : rellich ] suppose @xmath252 is a sequence in @xmath253 such that                                t. e. skinner , t. reiss , b. luy , n. khaneja , s. j. glaser , `` application of optimal control theory to the design of broadband excitation pulses for high resolution nmr , '' _ j. magn",
    "8 - 15 , 2003 .",
    "n. khaneja , t. reiss , c. kehlet , t. schulte - herbrggen , s. j. glaser , `` optimal control of coupled spin dynamics : design of nmr pulse sequences by gradient ascent algorithms , '' _ j. magn . reson .",
    "296 - 305 , 2005 .",
    "i. i. maximov , z. tosner , n. c. nielsen , `` optimal control design of nmr and dynamic nuclear polarization experiments using monotonically convergent algorithms , '' _ j. chem .",
    "128 , pp . 184505 , 2008 .",
    "i. ross and f. fahroo , `` legendre pseudospectral approximations of optimal control problems '' , in _ new trends in nonlinear dynamics and control _ , edited by w. kang et al .",
    "( springer , berlin , 2003 ) ; pp .",
    "327 - 342 .",
    "d. gottlieb , y. hussaini , s. orszag , `` theory and applications of spectral methods '' , in _ spectral methods for partial differential equations _",
    ", edited by r. voigt , d. gottlieb , and m. y. hussaini , siam , philadelphia , 1984 , pp . 1 - 117 .",
    "q. gong , m. ross , w. kang , f. fahroo , `` connections between the covector mapping theorem and convergence of pseudospectral methods for optimal control '' , _ comput .",
    "appl _ , vol .",
    "307 - 335 , 2008 ."
  ],
  "abstract_text": [
    "<S> inhomogeneity , in its many forms , appears frequently in practical physical systems . readily apparent in quantum systems , inhomogeneity is caused by hardware imperfections , measurement inaccuracies , and environmental variations , and subsequently limits the performance and efficiency achievable in current experiments . in this paper , we provide a systematic methodology to mathematically characterize and optimally manipulate inhomogeneous ensembles with concepts taken from ensemble control . in particular , we develop a computational method to solve practical quantum pulse design problems cast as optimal ensemble control problems , based on multidimensional pseudospectral approximations . </S>",
    "<S> we motivate the utility of this method by designing pulses for both standard and novel applications . </S>",
    "<S> we also show the convergence of the pseudospectral method for optimal ensemble control . </S>",
    "<S> the concepts developed here are applicable beyond quantum control , such as to neuron systems , and furthermore to systems with by parameter uncertainty , which pervade all areas of science and engineering . </S>"
  ]
}