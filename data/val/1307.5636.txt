{
  "article_text": [
    "causal bayesian networks are widely used for causal reasoning [ e.g. , @xcite , @xcite ( @xcite ) , @xcite ( @xcite ) ] . in particular ,",
    "if the causal structure is known and represented by a directed acyclic graph ( dag ) , this framework allows one to deduce post - intervention distributions and causal effects from the pre - intervention ( or observational ) distribution .",
    "hence , if the causal dag is known , one can estimate causal effects from observational data .",
    "covariate adjustment is often used for this purpose .",
    "the _ back - door criterion _ [ @xcite ] is a graphical criterion that is sufficient for adjustment , in the sense that a set of variables can be used for covariate adjustment if it satisfies the back - door criterion for the given graph .    in practice , there are two important complications . first , the underlying dag may be unknown . in this case",
    "one can try to estimate the dag , but in general one can not identify the underlying dag uniquely .",
    "instead , one can identify its markov equivalence class , which consists of all dags that encode the same conditional independence relationships as the underlying dag .",
    "such a markov equivalence class can be represented uniquely by a different type of graph , called a completed partially directed acyclic graph ( cpdag ) [ @xcite ] .",
    "second , it is often the case that some important variables were not measured , meaning that we do not have causal sufficiency . in this case , one can work with maximal ancestral graphs ( mags ) instead of dags [ @xcite ( @xcite ) ] .",
    "finally , the underlying mag may be unknown , so that it must be estimated from data .",
    "again , there is an identifiability problem here , as we can generally only identify the markov equivalence class of the underlying mag , which can be represented uniquely by a partial ancestral graph ( pag ) [ @xcite ] .    in this paper",
    ", we therefore consider generalizations of the back - door criterion to the following three scenarios :    we assume causal sufficiency , and we only know the cpdag , that is , the markov equivalence class of the underlying dag ;    we do _ not _ assume causal sufficiency , and we know the mag on the observed variables ;    we do _ not _ assume causal sufficiency , and we only know the pag , that is , the markov equivalence class of the underlying mag on the observed variables .    in scenarios 2 and 3 , we allow for arbitrarily many hidden ( or unmeasured ) variables . we do not , however , allow for selection variables , that is , for unmeasured variables that determine whether a unit is included in the sample .",
    "since the back - door criterion is a simple criterion that is widely used for dags , it seems useful to have similar criteria for cpdags , mags and pags .",
    "we also hope that our generalized back - door criterion will make working with mags and pags less daunting , and more accessible to people in practice .",
    "our generalized back - door criterion for dags , cpdags , mags and pags is given in section  [ secgeneralizedbackdoorcriterion ] ; see especially definition  [ defbackdoorgraphical ] and theorem  [ thgeneralizedbackdoorsufficientforadjustment ] .",
    "corresponding r - code is available in the function ` backdoor ` in the r - package ` pcalg ` [ @xcite ] .",
    "our results are derived by first formulating invariance conditions that are sufficient for adjustment , and then using the graphical criteria for invariance derived by @xcite .",
    "we also show that the generalized back - door criterion is equivalent to pearl s back - door criterion for single interventions in dags , and is slightly more general for multiple interventions in dags ( lemma  [ lemmaourbackdoorstrongerthanpearls ] and example  [ exourbackdoorstrongerthanpearls ] ) . in section  [ secfindingbackdoorset ] ,",
    "we give necessary and sufficient criteria for the existence of a set that satisfies the generalized back - door criterion relative to a pair of variables @xmath0 and a dag , mag , cpdag or pag .",
    "moreover , if a generalized back - door set exists , we provide an explicit such set .",
    "these results are summarized in theorem  [ thbackdoorsetforgeneralgraph ] , using a general framework that covers dags , cpdags , mags and pags .",
    "corollaries [ corbackdoorsetdag][corbackdoorsetmag ] specialize the results for dags , cpdags and mags , respectively .",
    "we illustrate our results with several examples in section  [ secexamples ] .",
    "all proofs are given in section  [ secproofs ] .",
    "we close this introduction by discussing related work . for a given causal dag , identifiability of causal effects in general or via covariate adjustment has been studied by various authors .",
    "in particular , there are complete graphical criteria for the identification of causal effects if a causal dag with unmeasured variables is given [ e.g. , @xcite , @xcite ( @xcite ) , @xcite ] .",
    "shpitser , van  der weele androbins ( @xcite ) studied effects that are identifiable via covariate adjustment , and provided necessary and sufficient graphical criteria for this purpose , again if the causal dag is given .",
    "their results can be viewed as an improvement on the back - door criterion , which is only sufficient for adjustment .",
    "@xcite studied covariate adjustment for a given dag from an algorithmic perspective . among other things",
    ", they showed that the back - door criterion and the adjustment criterion of @xcite are equivalent if one is interested in minimal adjustment sets for a certain subclass of graphs .",
    "@xcite extended these necessary and sufficient graphical criteria for covariate adjustment to mags .",
    "there are also existing approaches that do not make the assumption that the causal dag or mag is given .",
    "the prediction algorithm [ @xcite , chapter  7 ] roughly starts from a pag and uses invariance results . in this sense",
    "it is probably closest to our work .",
    "the main difference between this method and our results is that the prediction algorithm is more complex .",
    "in particular , it searches over all possible orderings of the variables , which quickly becomes infeasible for large graphs .",
    "the prediction algorithm may , however , be more informative , in the sense that certain distributions may be identifiable by the prediction algorithm but not by the generalized back - door criterion .",
    "studying the exact relationship between these two approaches would be an interesting topic for future work .    other work on data driven methods for selection of adjustment variables for",
    "the estimation of causal effects does not assume that the causal structure is known , but does make some assumptions about causal relationships between the variables of interest and/or about the existence of a set of variables that can be used for covariate adjustment [ @xcite ] . in the current paper , we do not make any such assumptions . on the other hand ,",
    "we start from a given dag , cpdag , mag or pag .",
    "we do not see this as a genuine restriction of our approach , however , since there are algorithms to estimate cpdags and pags from data ( e.g. , the pc algorithm [ @xcite ] , greedy equivalence search [ @xcite ] and versions of the fci algorithm [ @xcite ] ) .",
    "these algorithms have been shown to be consistent , even in certain sparse high - dimensional settings [ @xcite ] . in practice",
    ", one could therefore first employ such an algorithm , and then apply the results in the current paper .",
    "throughout this paper , we denote sets in a bold font ( e.g. , @xmath1 ) and graphs in a calligraphic font ( e.g. , @xmath2 or @xmath3 ) .",
    "a graph @xmath4 consists of a set of vertices @xmath5 and a set of edges @xmath6 .",
    "the vertices represent random variables , and the edges describe conditional independence and causal ( ancestral ) relationships .",
    "there is at most one edge between every pair of vertices , and the edge set @xmath6 can contain ( a subset of ) the following four edge types : @xmath7 ( _ directed _ ) , @xmath8 ( _ bi - directed _ ) , @xmath9 ( _ nondirected _ ) and @xmath10 ( _ partially directed _ ) . a _ directed graph _",
    "contains only directed edges , a _ mixed graph _ can contain directed and bi - directed edges and a _ partial mixed graph _ can contain all four edge types .",
    "the endpoints of an edge are called _ marks _ , and they can be _ tails _ , _ arrowheads _ or _ circles_. we use the symbol `` @xmath11 '' to denote an arbitrary edge mark .",
    "if we are only interested in the presence or absence of edges , and not in the edge marks , then we refer to the _ skeleton _ of a graph .",
    "two vertices are _ adjacent _ if there is an edge between them .",
    "the adjacency set of a vertex @xmath12 in @xmath13 , denoted by @xmath14 , consists of all vertices adjacent to @xmath12 in @xmath13 .",
    "a _ path _ is a sequence of distinct adjacent vertices .",
    "the _ length of a path _ @xmath15 equals the corresponding number of edges , in this case @xmath16 .",
    "the path @xmath17 is said to be _ out of _ ( _ into _ ) @xmath18 if the edge between @xmath18 and @xmath19 has a tail ( arrowhead ) at @xmath18 . a sub - path of @xmath17 from @xmath20 to @xmath21",
    "is denoted by @xmath22 .",
    "we denote the concatenation of paths by @xmath23 , so that , for example , @xmath24 for @xmath25 .",
    "we use the convention that we remove any loops that may occur due to the concatenation , so that the result does not contain duplicate vertices and is again a path .",
    "the path @xmath17 is a _ directed path _ from @xmath18 to @xmath26 if for all @xmath27 , the edge @xmath28 occurs , and it is a _ possibly directed path _ if for all @xmath27 , the edge between @xmath29 and @xmath30 is not into @xmath29 .",
    "a _ cycle _ occurs if there is a path between @xmath18 and @xmath20 of length greater than one , and @xmath18 and @xmath20 are adjacent . a directed path from @xmath18 to @xmath20 forms a _ directed cycle _ together with the edge @xmath31 , and an _ almost directed cycle _ together with the edge @xmath32 .",
    "a _ directed acyclic graph _ ( dag ) is a directed graph without directed cycles .",
    "an _ ancestral _",
    "graph is a mixed graph without directed and almost directed cycles .",
    "if @xmath31 , we say that @xmath18 is a _ child _ of @xmath20 , and @xmath20 is a _ parent _ of @xmath18 .",
    "the corresponding sets of parents and children are denoted by @xmath33 and @xmath34 .",
    "if there is a ( possibly ) directed path from @xmath18 to @xmath20 or if @xmath35 , then @xmath18 is a ( _ possible _ ) _ ancestor _ of @xmath20 and @xmath20 a ( _ possible _ ) _ descendant _ of @xmath18 .",
    "the sets of ancestors , descendants , possible ancestors , and possible descendants of a vertex @xmath18 in @xmath36 are denoted by an@xmath37 , @xmath38 , @xmath39 , and @xmath40 , respectively .",
    "these definitions are applied disjunctively to a set @xmath41 , for example , @xmath42 .",
    "a path @xmath43 is an _ unshielded triple _ if @xmath18 and @xmath44 are not adjacent .",
    "a  nonendpoint vertex @xmath20 on a path is a _ collider _ on the path if the path contains  @xmath45 .",
    "a nonendpoint vertex on a path which is not a collider is a _ noncollider _ on the path .",
    "a _ collider path _ is a path on which every nonendpoint vertex is a collider .",
    "a path of length one is a trivial collider path .",
    "a bayesian network for a set of variables @xmath5 is a pair @xmath46 , where @xmath47 is a dag , and @xmath48 is a joint probability density for @xmath49 ( with respect to some dominating measure ) that factorizes according to @xmath2 : @xmath50 . if the dag is interpreted causally , in the sense that @xmath51 means that @xmath18 has a ( potential ) direct causal effect on @xmath20 , then we talk about a _ causal dag _ and a _ causal bayesian network_.    one can easily derive post - intervention densities if the causal bayesian network is given and all variables are observed .",
    "in particular , we consider interventions @xmath52 for @xmath53 [ @xcite ] , which represent outside interventions that set the variables in @xmath54 to their respective values in @xmath55 .",
    "we assume that such interventions are effective , meaning that @xmath56 after the intervention .",
    "moreover , we assume that the interventions are local , meaning that the generating mechanisms of the other variables , and hence their conditional distributions given their parents , do not change .",
    "we then have @xmath57 this is known as the g - formula or the truncated factorization formula [ @xcite ] .    in a bayesian network @xmath46 , the dag @xmath2 encodes conditional independence relationships in the density @xmath48 via d - separation [ @xcite ; see also definition  [ defm - connection ] ] .",
    "several dags can encode the same conditional independence relationships .",
    "such dags form a markov equivalence class which can be uniquely represented by a cpdag .",
    "a cpdag is a graph with the same skeleton as each dag in its equivalence class , and its edges are either directed ( @xmath58 ) or nondirected ( @xmath59 ) .",
    "an edge @xmath60 in such a cpdag means that @xmath51 is present in every dag in the markov equivalence class , while an edge @xmath61 represents uncertainty about the edge marks , in the sense that the markov equivalence class contains at least one dag with @xmath62 and at least one dag with @xmath63 .",
    "( note that many authors use @xmath64 instead of @xmath61 ; we use @xmath9 to ensure that the cpdag satisfies the syntactic properties of a pag ; see below . )",
    "if some of the variables in a dag are unobserved , one can transform the dag into a unique _ maximal ancestral graph _",
    "( mag ) on the observed variables ; see @xcite [ ( @xcite ) , page 981 ] for an algorithm",
    ". in particular , two vertices @xmath18 and @xmath20 are adjacent in a mag if and only if no subset of the remaining observed variables makes them conditionally independent .",
    "moreover , a tail mark @xmath65 in a mag @xmath3 means that @xmath18 is an ancestor of @xmath20 in all dags represented by @xmath3 , while an arrowhead @xmath66 means that @xmath18 is not an ancestor of @xmath20 in all dags represented by @xmath3 .",
    "thus an edge @xmath51 in @xmath3 means that there is a directed path from @xmath18 to @xmath20 in all dags represented by @xmath3 , but we emphasize that it does not represent a direct effect with respect to the observed variables , in the sense that there may be other observed variables on the directed path .",
    "several different dags can lead to the same mag , and a mag represents a class of ( infinitely many ) dags that have the same d - separation and ancestral relationships among the observed variables .",
    "the mag of a causal dag is called a _",
    "causal mag_. a mag encodes conditional independence relationships via the concept of m - separation ( definition  [ defm - connection ] ) . again",
    ", several mags can encode the same conditional independence relationships .",
    "such mags are called markov equivalent , and can be uniquely represented by a _ partial ancestral graph _ ( pag ) .",
    "this is a partial mixed graph with the same skeleton as each mag in its markov equivalence class . a  tail mark ( arrowhead ) at an edge @xmath65",
    "( @xmath67 in such a pag means that @xmath65 ( @xmath66 ) in every mag in the markov equivalence class , while a circle mark at an edge @xmath68 represents uncertainty about the edge mark , in the sense that the markov equivalence class contains at least one mag with @xmath65 , and at least one mag with @xmath69 .",
    "we say that a density @xmath48 is _ compatible with a dag @xmath2 _ if the pair @xmath46 forms a causal bayesian network .",
    "a density @xmath48 is _ compatible with a cpdag @xmath70 _ if it is compatible with a dag in the markov equivalence class described by @xmath70 .",
    "a density @xmath48 is _ compatible with a mag @xmath71 _ if there exists a causal bayesian network @xmath72 ( including hidden variables ) , such that @xmath3 is the mag of @xmath73 and @xmath48 is the corresponding marginal of @xmath74 .",
    "finally , @xmath48 is _ compatible with a pag @xmath75 _ if it is compatible with a mag in the markov equivalence class described by @xmath75 .",
    "we now present our generalized back - door criterion in definition  [ defbackdoorgraphical ] and theorem  [ thgeneralizedbackdoorsufficientforadjustment ] , where the name `` generalized back - door criterion '' is motivated by lemma  [ lemmaourbackdoorstrongerthanpearls ] .",
    "we first introduce some more specialized definitions .",
    "@xcite introduced the concept of ( _ definitely _ ) _ visible _ edges in mags and pags .",
    "the reason for this is as follows .",
    "a directed edge @xmath76 in a dag , cpdag , mag or pag always means that @xmath12 is a cause ( or ancestor ) of @xmath77 , because of the tail mark at @xmath12 .",
    "however , if we allow for hidden variables ( i.e. , in mags and pags ) , there may be a hidden confounding variable between @xmath12 and @xmath77 .",
    "visible edges refer to situations where there can not be such a hidden confounder between @xmath12 and @xmath77 .",
    "invisible edges , on the other hand , are possibly confounded in the sense that there is a dag represented by the mag or pag with @xmath78 , where @xmath79 is not measured ( in addition to @xmath80 ) .",
    "[ defvisibleedge ] all directed edges in dags and cpdags are said to be _",
    "visible_. given a @xmath81 , a directed edge @xmath82 in @xmath83 is _ visible _ if there is a vertex @xmath84 not adjacent to @xmath85 , such that there is an edge between @xmath84 and @xmath86 that is into @xmath86 , or there is a collider path between @xmath84 and @xmath86 that is into @xmath86 and every nonendpoint vertex on the path is a parent of @xmath85 .",
    "otherwise @xmath82 is said to be invisible .    ;",
    "@xcite , figure  6 . instead of the tail mark at @xmath84",
    ", one can also have an arrowhead or circle mark . ]",
    "figure  [ figvisibileedges ] illustrates the different graphical configurations that can lead to a visible edge .",
    "we note that @xcite used slightly different terminology , referring to _ definitely visible _ edges in a pag , while we simply say _",
    "visible _ for both mags and pags .",
    "@xcite used the term _ pure - causal _ edges instead of _ visible _ edges in mags .",
    "we can now generalize the concept of a _ back - door path _ in definition  [ defbackdoorpath ] .",
    "[ defbackdoorpath ] let @xmath0 be an ordered pair of vertices in @xmath36 , where @xmath36 is a dag , cpdag , mag or pag .",
    "we say that a path between @xmath12 and @xmath77 is a _ back - door path from @xmath12 to @xmath77 _ if it does not have a visible edge out of @xmath12 .    in a dag",
    ", this definition reduces to a path between @xmath12 and @xmath77 that starts with @xmath87 , which is the usual back - door path as defined by @xcite . in a cpdag ,",
    "a back - door path from @xmath12 to @xmath77 is a path between @xmath12 and @xmath77 that starts with @xmath88 or @xmath89 . in a mag ,",
    "it is a path between @xmath12 and @xmath77 that starts with @xmath90 , @xmath87 or an invisible edge @xmath91 . finally , in a pag , it is a path between @xmath12 and @xmath77 that starts with @xmath92 , @xmath93 or an invisible edge @xmath91 .",
    "we also need generalizations of the concept of d - separation in dags [ definition  1.2.3 of @xcite ] . in mags",
    ", one can use m - separation [ section  3.4 of @xcite ] . in cpdags and pags",
    ", there is the additional complication that it may be unclear whether a vertex is a collider or a noncollider on the path .",
    "we therefore need the following definitions :    [ defdefinitenoncollider ] a nonendpoint vertex @xmath20 on a path @xmath94 in a partial mixed graph @xmath13 is a _ definite noncollider _ on the path if ( i ) there is a tail mark at @xmath20 , that is , @xmath95 or @xmath96 , or ( ii ) @xmath97 is unshielded and has circle marks at @xmath20 , that is , @xmath98 and @xmath18 and @xmath44 are not adjacent in @xmath13 .",
    "the motivation for conditions ( i ) and ( ii ) is straightforward .",
    "a tail mark out of  @xmath20 on the path ensures that @xmath20 is a noncollider on the path in any graph obtained by orienting any possible circle marks .",
    "condition ( ii ) comes from the fact that the collider status of unshielded triples is known in cpdags and pags .",
    "hence , if the graph contains an unshielded triple that was not oriented as a collider , then it must be a noncollider in all underlying dags or mags .",
    "if @xmath99 is a dag or a mag , then only condition ( i ) applies and reduces to the usual definition of a noncollider .",
    "a nonendpoint vertex @xmath20 on a path @xmath17 in a partial mixed graph is said to be of a _ definite status _ if it is either a collider or a definite noncollider on @xmath17",
    ". the path @xmath17 is said to be of a _ definite status _ if all nonendpoint vertices on the path are of a definite status .",
    "a path of length one is a trivial definite status path .",
    "moreover , in dags and mags , all paths are of a definite status .",
    "we now define m - connection for definite status paths .",
    "[ defm - connection ] a definite status path @xmath17 between vertices @xmath12 and @xmath77 in a partial mixed graph is _",
    "m - connecting _ given a ( possibly empty )",
    "set of variables @xmath100 @xmath101 if the following two conditions hold :    every definite noncollider on the path is not in @xmath100 ;    every collider on the path is an ancestor of some member of @xmath100 .",
    "if a definite status path @xmath17 is not m - connecting given @xmath100 , then we say that @xmath100 blocks  @xmath17 .    if @xmath102 , we usually omit the phrase `` given the empty set .",
    "'' definition  [ defm - connection ] reduces to m - connection for mags and d - connection for dags .",
    "we note that @xcite used the notions of _ possible m - connection _ and _ definite m - connection _ in pags , where his notion of definite m - connection is the same as our notion of m - connection for definite status paths .",
    "we now define an adjustment criterion for dags , cpdags , mags and pags . throughout , we think of @xmath54 and @xmath103 as nonempty sets .",
    "[ defadjustmentcriterion ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in @xmath36 , where @xmath36 represents a dag , cpdag , mag or pag .",
    "then we say that @xmath104 satisfies the adjustment criterion relative to @xmath105 and @xmath13 if for any density @xmath48 compatible with @xmath13 , we have @xmath106    if @xmath107 and @xmath108 , we simply say that a set satisfies the criterion relative to @xmath0 [ rather than @xmath109 and the given graph .",
    "we now propose our generalized back - door criterion for dags , cpdags , mags and pags .",
    "we will show in theorem  [ thgeneralizedbackdoorsufficientforadjustment ] that this criterion is sufficient for adjustment .",
    "[ defbackdoorgraphical ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in @xmath36 , where @xmath36 represents a dag , cpdag , mag or pag .",
    "then @xmath104 satisfies the _",
    "generalized back - door criterion _ relative to @xmath105 and @xmath13 if the following two conditions hold :    @xmath104 does not contain possible descendants of @xmath54 in @xmath13 ;    for every @xmath110 , the set @xmath111 blocks every definite status back - door path from @xmath12 to any member of @xmath103 , if any , in @xmath13 .",
    "a set @xmath104 that satisfies the generalized back - door criterion relative to @xmath105 and @xmath13 is called a _ generalized back - door set _ relative to @xmath105 and @xmath13 .    [ rempossibledescendantsdefinitestatuspath ] condition ( b - i ) in definition  [ defbackdoorgraphical ] is equivalent to the following :    @xmath104 does not contain possible descendants of @xmath54 _ along a definite status path _ in @xmath13 .    condition ( b - i)@xmath112 may be easier to check computationally than ( b - i ) .",
    "the equivalence of ( b - i ) and ( b - i)@xmath112 is shown in the proof of theorem  [ thgeneralizedbackdoorsufficientforadjustment ] , using lemma  [ lemmapossibledescendantsdefinitestatuspath ] .",
    "[ thgeneralizedbackdoorsufficientforadjustment ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in @xmath36 , where @xmath36 represents a dag , mag , cpdag or pag . if @xmath104 satisfies the _",
    "generalized back - door criterion _ relative to @xmath105 and @xmath13 ( definition  [ defbackdoorgraphical ] ) , then it satisfies the adjustment criterion relative to @xmath105 and @xmath13 ( definition  [ defadjustmentcriterion ] ) .",
    "the proof of theorem  [ thgeneralizedbackdoorsufficientforadjustment ] consists of two steps .",
    "first , we formulate invariance criteria that are sufficient for adjustment ( theorem  [ thinvarianceimpliesadjustment ] ) .",
    "next , we translate the invariance criteria into the graphical criteria given in definition  [ defbackdoorgraphical ] , using results of @xcite ( theorem  [ thbackdoorequivalenttoinvariance ] ) .",
    "we refer to definition  [ defbackdoorgraphical ] as generalized back - door criterion because its conditions are closely related to pearl s original back - door criterion [ @xcite ( @xcite ) ] .    [ defbackdoorpearl ] a set of variables @xmath104 satisfies the back - door criterion relative to an ordered pair of variables @xmath0 in a dag @xmath2 if the following two conditions hold :    no vertex in @xmath104 is a descendant of @xmath12 in @xmath2 ;    @xmath104 blocks every path between @xmath12 and @xmath77 in @xmath2 that is into @xmath12 .    similarly ,",
    "if @xmath54 and @xmath103 are two disjoint subsets of vertices in @xmath2 , then @xmath104 is said to satisfy the back - door criterion relative to @xmath105 in @xmath113 if it satisfies the criterion relative to any pair @xmath0 such that @xmath114 and @xmath115 .    in particular , the conditions in definition  [ defbackdoorgraphical ] are equivalent to pearl s back - door criterion for a dag with a single intervention ( @xmath116 ) . for a dag with multiple interventions ,",
    "any set that satisfies pearl s back - door criterion also satisfies the generalized back - door criterion , but not necessarily the other way around . in this sense ,",
    "our criterion is slightly better ; see lemma  [ lemmaourbackdoorstrongerthanpearls ] and example  [ exourbackdoorstrongerthanpearls ] .",
    "[ lemmaourbackdoorstrongerthanpearls ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in a dag @xmath2 .",
    "if @xmath104 satisfies pearl s back - door criterion ( definition  [ defbackdoorpearl ] ) relative to @xmath105 and  @xmath2 , then @xmath104 satisfies the generalized back - door criterion ( definition  [ defbackdoorgraphical ] ) relative to @xmath105 and @xmath2 .",
    "an important reason for the popularity of pearl s back - door criterion is the following .",
    "consider two distinct vertices @xmath12 and @xmath77 in a dag @xmath2 .",
    "then @xmath117 satisfies the back - door criterion relative to @xmath0 and @xmath2 , unless @xmath118 . in the latter case",
    ", there is no set that satisfies the back - door criterion relative to @xmath0 and @xmath2 , but it is easy to see that @xmath119 for any density @xmath48 compatible with @xmath2 , since there can not be a directed path from @xmath12 to @xmath77 in @xmath2 .    in this section , we formulate similar results for the generalized back - door criterion . in particular , we consider the following problem . given two distinct vertices @xmath12 and @xmath77 in a dag , cpdag , mag or pag , can we easily determine if there exists a generalized back - door set relative to @xmath0 and the given graph ? moreover , if this question is answered positively , can we give an explicit set that satisfies the criterion ?",
    "theorem  [ thbackdoorsetforgeneralgraph ] addresses these questions in general , while corollaries [ corbackdoorsetdag][corbackdoorsetmag ] give specific results for dags , cpdags and mags .",
    "we emphasize that throughout this section , we focus on the setting with a single intervention variable @xmath12 and a single variable of interest @xmath77 .",
    "the setting with multiple interventions ( i.e. , a set @xmath54 ) is considerably more difficult , even for dags [ @xcite ] .",
    "it therefore seems challenging to generalize the results in this section to sets @xmath54 .",
    "handling sets @xmath103 seems less difficult , and we plan to study this in future work .    in a dag , the following result is well known .",
    "if @xmath12 and @xmath77 are not adjacent in a dag @xmath2 and @xmath120 , then @xmath117 blocks all paths between @xmath12 and @xmath77 . in mags , we have a similar result , but we need to use @xmath121 instead of the parent set ; see definition  [ defd - sep ] and lemma  [ lemmad - sep ] .",
    "[ defd - sep ] let @xmath12 and @xmath77 be two distinct vertices in a mixed graph @xmath36 .",
    "we say that @xmath122 if @xmath123 , and there is a collider path between @xmath12 and @xmath124 in @xmath13 , such that every vertex on this path ( including @xmath124 ) is an ancestor of @xmath12 or @xmath77 in @xmath13 .",
    "[ lemmad - sep ] let @xmath12 and @xmath77 be two distinct vertices in an ancestral graph @xmath13 .",
    "then the following statements are equivalent : @xmath12 and @xmath77 are m - separated in @xmath13 by some subset of the remaining variables , @xmath125 , and @xmath12 and @xmath77 are m - separated in @xmath13 by @xmath126 . moreover ,",
    "if @xmath13 is a mag , a fourth equivalent statement is @xmath12 and @xmath77 are not adjacent in @xmath13 .",
    "we now introduce important definitions that are needed to formulate our generalized back - door criterion in theorem  [ thbackdoorsetforgeneralgraph ] .",
    "[ defr ] let @xmath12 be a vertex in @xmath36 , where @xmath36 is a dag , cpdag , mag or pag .",
    "let @xmath127 be a class of dags or mags , defined as follows .",
    "if @xmath13 is a dag or a mag , we simply let @xmath128 . if @xmath13 is a cpdag / pag , we let @xmath129 be the subclass of dags / mags in the markov equivalence class described by @xmath13 that have the same number of edges into @xmath12 as @xmath13 .    for any @xmath130 , let @xmath131 be the graph obtained from @xmath132 by removing all directed edges out of @xmath12 that are visible in @xmath13 ; see definition  [ defvisibleedge ] .    for any given @xmath13 and @xmath12 ,",
    "we say that a graph @xmath133 satisfies definition  [ defr ] if there exists an @xmath134 such that @xmath135 .",
    "lemma  [ lemmamagwithsameindegreeaspag ] shows that the class @xmath129 is always nonempty .",
    "the definition of @xmath133 is related to the @xmath12-lower manipulated mags that were used by @xcite .",
    "it is important to note , however , that @xmath136 is obtained from @xmath132 by removing the edges out of @xmath12 that are visible in @xmath13 ( rather than @xmath132 ) .",
    "moreover , zhang replaced invisible edges by bi - directed edges , but that is not needed for our purposes ( although it would not hurt to do so ) .",
    "finally , we note that @xmath136 is ancestral , since any @xmath137 is ancestral",
    ".    we can now present the main result of this section .",
    "[ thbackdoorsetforgeneralgraph ] let @xmath12 and @xmath77 be two distinct vertices in @xmath36 , where @xmath36 is a dag , cpdag , mag or pag .",
    "let @xmath136 be any graph satisfying definition  [ defr ] .",
    "then there exists a generalized back - door set relative to @xmath0 and @xmath36 if and only if @xmath138 and @xmath139 .",
    "moreover , if such a generalized back - door set exists , then @xmath140 is such a set .",
    "the definitions of @xmath129 and @xmath136 in definition  [ defr ] are needed in theorem  [ thbackdoorsetforgeneralgraph ] to ensure that @xmath141 implies that there does not exist a generalized back - door set relative to @xmath0 and @xmath36 ; see also example  [ expag ] . for dags , cpdags and mags",
    "we can simplify theorem  [ thbackdoorsetforgeneralgraph ] somewhat ; see corollaries [ corbackdoorsetdag][corbackdoorsetmag ] .",
    "corollary  [ corbackdoorsetdag ] is the well - known result for dags that we discussed earlier .",
    "corollary  [ corbackdoorsetmag ] is given without proof , since it follows straightforwardly from theorem  [ thbackdoorsetforgeneralgraph ] .",
    "[ corbackdoorsetdag ] let @xmath12 and @xmath77 be two distinct vertices in a dag @xmath2 .",
    "then there exists a generalized back - door set relative to @xmath0 and @xmath142 if and only if @xmath143 .",
    "moreover , if such a generalized back - door set exists , then @xmath117 is such a set .",
    "[ corbackdoorsetcpdag ] let @xmath12 and @xmath77 be two distinct vertices in a cpdag @xmath70 .",
    "let @xmath144 be the graph obtained from @xmath70 by removing all directed edges out of @xmath12 .",
    "then there exists a generalized back - door set relative to @xmath0 and @xmath145 if and only if @xmath146 and @xmath147 .",
    "moreover , if such a generalized back - door set exists , then @xmath148 is such a set .",
    "[ corbackdoorsetmag ] let @xmath12 and @xmath77 be two distinct vertices in a mag @xmath3 .",
    "then there exists generalized backdoor set relative to @xmath0 and @xmath3 if and only if @xmath149 and @xmath150 .",
    "moreover , if such a generalized back - door set exists , then @xmath151 is such a set .",
    "we now give several examples to illustrate the theory for dags , cpdags , mags and pags .",
    "we start with an example that shows that the generalized back - door criterion for dags is weaker than pearl s back - door criterion for dags , in the sense that it can happen that there is no set that satisfies pearl s back - door criterion , while there is a set that satisfies the generalized back - door criterion .    [ cols=\"^,^ \" , ]     [ figpag->mag ]    [ expag ] consider the pag @xmath75 in figure  [ figpag](a ) , and suppose we are interested in @xmath152 .",
    "note that the mag @xmath153 as given in figure  [ figpag->mag](b ) is in  @xmath129 ; see definition  [ defr ]",
    ". we will apply theorem  [ thbackdoorsetforgeneralgraph ] using the corresponding graph @xmath136 , which is as @xmath3 but without the edge @xmath154 .",
    "we then have @xmath155 and @xmath156 .",
    "hence theorem  [ thbackdoorsetforgeneralgraph ] implies that @xmath157 is a generalized back - door set relative to @xmath0 and  @xmath75 .",
    "one can easily verify that all subsets of @xmath157 are also generalized back - door sets relative to @xmath0 and @xmath75 , since all back - door paths from @xmath12 to @xmath77 are blocked by the collider @xmath158 on these paths .",
    "this shows that @xmath140 is not minimal .",
    "this example also shows the importance of definition  [ defr ] . to see this ,",
    "let @xmath159 be as @xmath132 , but with the edge @xmath160 instead of @xmath161 , so that there is an additional edge into @xmath12 .",
    "then @xmath162 , and we get @xmath163 .",
    "this shows that applying theorem  [ thbackdoorsetforgeneralgraph ] with @xmath164 instead of @xmath136 leads to incorrect results .",
    "in this paper , we generalize pearl s back - door criterion [ @xcite ] to a generalized back - door criterion for dags , cpdags , mags and pags .",
    "we also provide easily checkable necessary and sufficient criteria for the existence of a generalized back - door set , when considering a single intervention variable and a single outcome variable . moreover ,",
    "if such a set exists , we provide an explicit set that satisfies the generalized back - door criterion .",
    "this set is not necessarily minimal , so if one is interested in a minimal set , one could consider all subsets .",
    "although effects that can be computed via the generalized back - door criterion are only a subset of all identifiable causal effects , we hope that the generalized back - door criterion will be useful in practice , and will make it easier to work with cpdags , mags and pags .",
    "moreover , combining our results for cpdags and pags with fast causal structure learning algorithms such as the pc algorithm [ @xcite ] or the fci algorithm [ @xcite ] yields a computationally efficient way to obtain information on causal effects when assuming that the observational distribution is faithful to the true unknown causal dag with or without hidden variables . to our knowledge ,",
    "the prediction algorithm of @xcite is the only alternative approach under the same assumptions , but the prediction algorithm is computationally much more complex .",
    "the ida algorithm [ @xcite ] has been designed to obtain bounds on causal effects when assuming that the observational distribution is faithful to the true underlying causal dag without hidden variables .",
    "ida roughly combines the pc algorithm with pearl s back - door criterion .",
    "we could now apply a similar approach in the setting with hidden variables , by combining the fci algorithm with the generalized back - door criterion for mags .",
    "possible directions for future work include studying the exact relationship between the prediction algorithm and our generalized back - door criterion , generalizing the results in section  [ secfindingbackdoorset ] to allow for sets @xmath54 and @xmath103 and extending the recent results of @xcite to cpdags and pags .",
    "in order to prove theorem  [ thgeneralizedbackdoorsufficientforadjustment ] , we formulate so - called invariance conditions that will turn out to be sufficient for adjustment ; see definition  [ definvariancecriterion ] and theorem  [ thinvarianceimpliesadjustment ] below .",
    "first , we briefly define what is meant by invariance .",
    "we refer to @xcite for full details .",
    "let @xmath103 , @xmath100 and @xmath54 be three subsets of vertices in a causal dag @xmath2 , where @xmath165 .",
    "then a density @xmath166 is said to be entailed to be invariant under interventions on @xmath54 given @xmath2 if @xmath167 for all causal bayesian networks @xmath168 , where the subscript @xmath169 denotes @xmath170 .",
    "( this notation is used since @xmath54 and @xmath100 are allowed to overlap . )",
    "the density @xmath166 is said to be entailed to be invariant under interventions on @xmath54 given a cpdag @xmath70 , a mag @xmath3 or a pag @xmath75 if it is entailed to be invariant under interventions on @xmath54 given all dags represented by @xmath70 , @xmath3 or @xmath75 , respectively .",
    "[ definvariancecriterion ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in @xmath36 , where @xmath36 is a dag , cpdag , mag or pag .",
    "then @xmath104 satisfies the _ invariance criterion _ relative to @xmath105 and @xmath13 if the following two conditions hold for any density @xmath48 compatible with @xmath13 :    @xmath171 ;    @xmath172 .    in other words , conditions",
    "( i - i ) and ( i - ii ) state that @xmath173 and @xmath174 are entailed to be invariant under interventions on @xmath54 given @xmath13 .",
    "the conditions are also closely related to the conditions in equation ( 9 ) of @xcite .",
    "we note that condition ( i - i ) is trivially satisfied if @xmath175 .",
    "[ thinvarianceimpliesadjustment ] let @xmath54 , @xmath103 and @xmath104 be pairwise disjoint sets of vertices in @xmath13 , where @xmath13 is a dag , cpdag , mag or pag .",
    "if @xmath104 satisfies the invariance criterion relative to @xmath105 and @xmath13 , then it satisfies the adjustment criterion relative to @xmath105 and @xmath13 .",
    "if @xmath175 , condition ( i - ii ) immediately gives @xmath176 .",
    "otherwise , we have @xmath177 under conditions ( i - i ) and ( i - ii ) , the right - hand side of ( [ eq1 ] ) simplifies to @xmath178 .",
    "@xcite ( @xcite ) , @xcite formulated invariance results for dags , mags and pags .",
    "we derive a similar result for cpdags and then summarize the results for all these types of graphs in theorem  [ thinvariancegeneral ] .    [ thinvariancegeneral ]",
    "let @xmath179 be three subsets of observed vertices in @xmath13 , where @xmath13 represents a dag , cpdag , mag or pag .",
    "moreover , let @xmath180 .",
    "then @xmath166 is entailed to be invariant under interventions on @xmath54 given @xmath13 if and only if :    for every @xmath181 , every m - connecting definite status path , if any , between @xmath12 and any member of @xmath103 given @xmath182 is out of @xmath12 with a visible edge ;    for every @xmath183 , there is no m - connecting definite status path between @xmath12 and any member of @xmath103 given @xmath100 ;    for every @xmath184 , every m - connecting definite status path , if any , between @xmath12 and any member of @xmath103 given @xmath100 is into @xmath12 .",
    "one can easily check that the conditions reduce to the appropriate conditions for dags , mags and pags [ @xcite , proposition  18 , theorem  24 and theorem  30 ] . the result for cpdags",
    "can be proved analogously .",
    "note that @xmath185 , @xmath186 and @xmath187 form a partition of @xmath54 .",
    "hence , only one of the conditions in theorem  [ thinvariancegeneral ] is relevant for a given @xmath110 .",
    "we also need the following basic property of pags and cpdags :    [ lemmapropertycp1forcpdagsandpags ] for any three vertices @xmath86 , @xmath85 and @xmath84 in a cpdag @xmath70 or pag @xmath75 , the following holds : if @xmath188 , then there is an edge between @xmath86 and @xmath84 with an arrowhead at @xmath84 , namely @xmath189 .",
    "furthermore , if the edge between @xmath86 and @xmath85 is @xmath82 , then the edge between @xmath86 and @xmath84 is either @xmath190 or @xmath191 ( i.e. , not @xmath192 ) .",
    "we now show that the invariance conditions in definition  [ definvariancecriterion ] are equivalent to the graphical conditions of definition  [ defbackdoorgraphical ] .",
    "[ thbackdoorequivalenttoinvariance ] the generalized back - door criterion ( definition  [ defbackdoorgraphical ] ) is equivalent to the invariance criterion ( definition  [ definvariancecriterion ] ) .",
    "we first show that condition ( b - ii ) of definition  [ defbackdoorgraphical ] is equivalent to condition ( i - ii ) of definition  [ definvariancecriterion ] .",
    "we use theorem  [ thinvariancegeneral ] with @xmath193 , where @xmath194 , @xmath195 and @xmath196 .",
    "then @xmath197 , and clause ( 1 ) of the theorem yields that ( i - ii ) is equivalent to the following : for every @xmath198 , every m - connecting definite status path , if any , between @xmath12 and any member of @xmath103 given @xmath199 is out of @xmath12 with a visible edge .",
    "this is equivalent to condition  ( b - ii ) by our definition of a back - door path ; see definition  [ defbackdoorpath ] .    by lemma  [ lemmapossibledescendantsdefinitestatuspath ] ( below ) ,",
    "condition ( b - i ) of definition  [ defbackdoorgraphical ] is equivalent to condition ( b - i)@xmath112 of remark  [ rempossibledescendantsdefinitestatuspath ] .    we now show that condition ( b - i)@xmath112 is equivalent to condition ( i - i ) in definition  [ definvariancecriterion ] .",
    "we use theorem  [ thinvariancegeneral ] with @xmath193 , where @xmath194 , @xmath200 and @xmath201 .",
    "then @xmath202 and clause ( 3 ) of the theorem yields that ( i - i ) is equivalent to the following condition ( i - i)@xmath112 : for every @xmath110 , every m - connecting definite status path , if any , between @xmath12 and any member of @xmath104 is into @xmath12 . we now show that ( i - i)@xmath112 is equivalent to ( b - i)@xmath112 .",
    "first suppose that @xmath104 violates ( b - i)@xmath112 .",
    "then there are @xmath203 and @xmath110 such that there is a possibly directed definite status path @xmath17 from @xmath12 to @xmath204 . since @xmath17 is possibly directed , it is not into @xmath12 and it can not contain colliders . hence , it is an m - connecting definite status path between @xmath12 and @xmath204 that is not into @xmath12 .",
    "this violates ( i - i)@xmath112 .",
    "now suppose that @xmath104 violates ( i - i)@xmath112 . then there are @xmath205 and @xmath114 such that there is an m - connecting definite status path between @xmath12 and @xmath204 that is not into @xmath12 .",
    "let @xmath206 be such a path .",
    "then every nonendpoint vertex on @xmath17 must be a definite noncollider .",
    "suppose that @xmath17 is not a possibly directed path from @xmath12 to @xmath204 , meaning that there exists an @xmath207 such that the edge between @xmath208 and @xmath209 is into @xmath208 .",
    "if @xmath210 , this means that the path is into @xmath12 , which is a contradiction . if @xmath211 , then the edge between @xmath212 and @xmath208 must be out of @xmath208 , since @xmath208 is a definite noncollider",
    "but this means that the edge must be into @xmath212 , since edges of the form @xmath213 or @xmath214 are not allowed .",
    "continuing this argument , we find that for all @xmath215 , the edge between @xmath216 and @xmath217 is into @xmath216 .",
    "but this means that the path is into @xmath218 , which is a contradiction .",
    "hence , @xmath17 is a possibly directed path from @xmath12 to @xmath204 .",
    "together with the fact that @xmath17 is of a definite status , this violates ( b - i)@xmath112 .",
    "[ lemmapossibledescendantsdefinitestatuspath ] let @xmath12 and @xmath77 be two distinct vertices in @xmath13 , where @xmath13 is a dag , cpdag , mag or pag .",
    "if @xmath219 , then there is a possibly directed definite status path @xmath220 from @xmath12 to @xmath77 .",
    "moreover , if @xmath221 for some @xmath222 , then @xmath223 for all @xmath224 .",
    "if @xmath13 is a dag or a mag , the lemma is trivially true .",
    "so let @xmath13 be a cpdag or a pag , and assume that @xmath225 .",
    "this implies that there is a possibly directed path from @xmath12 to @xmath77 in @xmath13 .",
    "let @xmath226 be a shortest such path .",
    "if @xmath17 is of length one , then the lemma is trivially true .",
    "so assume that the length of @xmath17 is at least two , that is , @xmath227 .",
    "we first show that @xmath17 is a definite status path .",
    "note that @xmath17 can contain the following edges @xmath228 , @xmath229 and @xmath230 ( @xmath231 ) .",
    "we now consider a sub - path @xmath232 of @xmath17 , for some @xmath233 .",
    "this sub - path can not be of the form @xmath234 or @xmath235 .",
    "to see this , suppose that the sub - path takes such a form .",
    "then lemma  [ lemmapropertycp1forcpdagsandpags ] implies the edge @xmath236 .",
    "suppose that this edge is into @xmath208 ; that is , it is @xmath237 .",
    "then lemma  [ lemmapropertycp1forcpdagsandpags ] applied to @xmath238 implies the edge @xmath239 , which is a contradiction .",
    "if the edge @xmath236 is not into @xmath208 , then @xmath17 is not a shortest possibly directed path .",
    "similarly , the sub - path can not be of the form @xmath240 or @xmath241 . to see this ,",
    "suppose that the sub - path takes such a form .",
    "then lemma  [ lemmapropertycp1forcpdagsandpags ] implies the edge @xmath242 or @xmath243 . in either case ,",
    "@xmath17 is not a shortest possibly directed path .    moreover ,",
    "if the sub - path is of the form @xmath244 , @xmath245 or @xmath246 , then it must be unshielded . to see this ,",
    "suppose that the sub - path takes such a form and is not unshielded .",
    "if the edge between @xmath208 and @xmath247 is into @xmath208 , then lemma  [ lemmapropertycp1forcpdagsandpags ] applied to @xmath248 implies the edge @xmath239 , which is a contradiction .",
    "if the edge between @xmath208 and @xmath247 is not into @xmath208 , then @xmath17 is not a shortest possibly directed path .",
    "hence , @xmath17 can only contain triples of the form @xmath249 or @xmath250 , or of the form @xmath251 , @xmath252 or @xmath253 where @xmath208 and @xmath247 are not adjacent .",
    "in all these cases , the middle vertex @xmath209 is a definite noncollider , so that @xmath17 is a definite status path .",
    "finally , if @xmath221 for some @xmath254 , it follows that @xmath223 for all @xmath255 .",
    "proof of theorem [ thgeneralizedbackdoorsufficientforadjustment ] this follows directly from theorems [ thinvarianceimpliesadjustment ] and [ thbackdoorequivalenttoinvariance ] .",
    "proof of lemma [ lemmaourbackdoorstrongerthanpearls ] conditions ( p - i ) and ( b - i ) are trivially equivalent for dags . we therefore only show that ( p - ii ) implies ( b - ii ) , by contradiction . thus , suppose that @xmath104 blocks all back - door paths between @xmath198 and @xmath115 in @xmath142 , but there exist @xmath256 and @xmath257 such that there is a back - door path @xmath17 from @xmath12 to @xmath77 that is not blocked by @xmath258 .",
    "this means that : ( i ) no noncollider on @xmath17 is in @xmath259 , ( ii ) all colliders on @xmath17 have a descendant in @xmath260 , ( iii ) there is at least one collider on @xmath17 that has a descendant in @xmath261 but not in @xmath104 . among all colliders satisfying ( iii ) , let @xmath262 be the one that is closest to @xmath77 on @xmath17 , and let @xmath263 denote a descendant of @xmath262 in @xmath264 .",
    "then the directed path @xmath265 from @xmath262 to @xmath263 is m - connecting given @xmath104 , since it is a path consisting of noncolliders and none of its vertices are in @xmath104 . moreover , the sub - path @xmath266 of @xmath17 is m - connecting given @xmath104 by construction . but",
    "this means that @xmath267 is a back - door path from @xmath263 to @xmath77 that is m - connecting given @xmath104 .",
    "this contradicts ( p - ii ) .",
    "we first give several lemmas , starting with a result about m - connection in mags .",
    "this result basically says that replacing condition ( b ) in definition  [ defm - connection ] by `` every collider on the path is an ancestor of some member of @xmath268 '' does not change the m - separation relations in a mag .",
    "[ lemmarichardsoncorollary ] let @xmath12 and @xmath77 be two distinct vertices and @xmath100 be a subset of vertices in a mixed graph @xmath3 , with @xmath269 .",
    "if there is a path between @xmath12 and @xmath77 in @xmath3 on which no noncollider is in @xmath100 and every collider is in @xmath270 , then there is a path ( not necessarily the same path ) m - connecting @xmath12 and @xmath77 given @xmath100 in @xmath3 .",
    "proof of lemma [ lemmad - sep ] let @xmath13 be an ancestral graph .",
    "first , we note that ( iii ) trivially implies ( i ) .",
    "next , we show that ( i ) implies ( ii ) , or equivalently , that not ( ii ) implies not ( i ) . thus , suppose that @xmath271",
    ". then there is a collider path between @xmath12 and @xmath77 such that every vertex on the path is an ancestor of @xmath272 in @xmath13 .",
    "this path is m - connecting given any subset of the remaining vertices , by lemma  [ lemmarichardsoncorollary ] .",
    "next , we show that ( ii ) implies ( iii ) .",
    "suppose that @xmath273 .",
    "if there is no path between @xmath12 and @xmath77 in @xmath13 , then @xmath12 and @xmath77 are trivially m - separated by any subset of the remaining vertices .",
    "thus , assume that there is at least one path between @xmath12 and @xmath77 .",
    "consider an arbitrary such path , and call it @xmath17 .",
    "since @xmath125 , we have @xmath274 .",
    "hence the length of @xmath17 must be at least two .",
    "we will show that @xmath17 is blocked by @xmath275 .",
    "suppose @xmath17 starts with @xmath276 .",
    "then @xmath277 , since @xmath278 .",
    "since @xmath124 is a noncollider on @xmath17 , this implies that @xmath17 is blocked by @xmath126 .",
    "suppose @xmath17 is of the form @xmath279 . then @xmath280 , so that @xmath281 .",
    "since @xmath124 is a noncollider on @xmath17 , this implies that @xmath17 is blocked by @xmath126 .",
    "suppose @xmath17 starts with @xmath282 and the sub - path @xmath283 of @xmath17 contains at least one collider .",
    "let @xmath84 be the collider closest to @xmath124 on @xmath17 . then @xmath284 .",
    "if @xmath285 , then @xmath17 is blocked by @xmath126 . hence , suppose @xmath286 .",
    "since any vertex in @xmath287 is an ancestor of @xmath272 in @xmath13 , this implies @xmath288 and hence @xmath289 and @xmath290 .",
    "since @xmath124 is a noncollider on @xmath17 , @xmath17 is blocked by @xmath126 .",
    "suppose @xmath17 is a collider path of the form @xmath291 .",
    "then at least one of the colliders is not in @xmath292 , since otherwise @xmath293 .",
    "let @xmath84 be the collider closest to @xmath12 on @xmath17 that is not in @xmath292",
    ". then @xmath294 .",
    "hence , @xmath17 is blocked by @xmath126 .",
    "suppose @xmath17 is of the form @xmath295 , with @xmath296 ( @xmath297 was treated in the previous case ) and the sub - path @xmath298 is allowed to be of length one ( i.e. , @xmath299 ) .",
    "if @xmath300 , then @xmath17 is blocked by @xmath126 .",
    "so suppose that @xmath301 .",
    "then there does not exist a collider path between @xmath12 and @xmath204 such that each vertex on the path is in @xmath292 .",
    "this implies that there is a collider on the sub - path @xmath302 of @xmath17 that is not in @xmath292 . among such vertices ,",
    "let @xmath303 be the one that is closest to @xmath12 on @xmath302",
    ". then @xmath304 .",
    "hence , @xmath17 is blocked by @xmath126",
    ".    finally , if @xmath13 is a mag , two vertices are adjacent if and only if no subset of the remaining variables can m - separate them .",
    "hence , ( i ) and ( iv ) are equivalent for mags .",
    "the following lemma says that we can check the existence of m - connecting definite status back - door paths in @xmath36 by checking the existence of m - connecting paths in @xmath136 , where @xmath136 is any graph satisfying definition  [ defr ] .",
    "this lemma is closely related to lemma  5.1.7 of @xcite and lemmas 26 and 27 of @xcite .",
    "[ lemmam - seppag2mag ] let @xmath12 and @xmath77 be two distinct vertices and @xmath100 be a subset of vertices in @xmath13 , where @xmath13 is a dag , cpdag , mag or pag .",
    "let @xmath136 be any graph satisfying definition  [ defr ] .",
    "then there is a definite status m - connecting back - door path from @xmath12 to @xmath77 given @xmath100 in @xmath13 if and only if there is an m - connecting path between @xmath12 and @xmath77 given @xmath100 in @xmath136 .",
    "let @xmath130 and @xmath136 satisfy definition  [ defr ] .",
    "we first prove the `` only if '' statement .",
    "suppose there is a definite status m - connecting back - door path @xmath17 from @xmath12 to @xmath77 given @xmath100 in @xmath13 .",
    "let @xmath305 and @xmath306 be the corresponding paths in @xmath132 and @xmath307 , consisting of the same sequence of vertices .",
    "( note that @xmath306 exists by the definition of @xmath136 and the fact that @xmath17 is a back - door path in @xmath13 . )",
    "then the path @xmath305 is m - connecting given @xmath100 in @xmath132 .",
    "the path @xmath306 , however , is not necessarily m - connecting in @xmath307 , since it may happen that there is a collider @xmath262 on the path such that @xmath308 but @xmath309 . but",
    "this can only occur if @xmath310 .",
    "hence , @xmath306 satisfies the following properties : no noncollider on @xmath306 is in @xmath100 and every collider on @xmath306 is in @xmath311 .",
    "it then follows from lemma  [ lemmarichardsoncorollary ] that there is an m - connecting path between @xmath12 and @xmath77 given @xmath100 in @xmath136 .",
    "we now prove the `` if '' statement .",
    "suppose that there is an m - connecting path @xmath306 between @xmath12 and @xmath77 given @xmath100 in @xmath133 .",
    "let @xmath305 be the corresponding path in @xmath132 , consisting of the same sequence of vertices .",
    "then @xmath305 is also m - connecting given @xmath100 in @xmath132 .",
    "moreover , @xmath17 does not start with a visible edge out of @xmath12 in @xmath13 , because @xmath306 exists in @xmath136 . by lemma  2@xmath112 in the proof of lemma  5.1.7 of @xcite",
    ", it then follows that there exists an m - connecting definite status back - door path between @xmath12 and @xmath77 given @xmath100 in @xmath13 .",
    "the next lemma is used several times to derive a contradiction .",
    "[ lemmapossiblydirectedpathandedgeinto ] let @xmath312 and @xmath124 be two distinct vertices in @xmath13 , where @xmath13 denotes a dag , cpdag , mag or pag .",
    "then @xmath13 can not have both a possibly directed path from @xmath312 to @xmath124 and an edge of the form @xmath313 .",
    "this lemma is trivial for dags and mags , since they can not contain ( almost ) directed cycles .",
    "so we only show the result for cpdags and pags .",
    "let @xmath13 denote the cpdag or pag , and suppose that @xmath13 contains an edge of the form @xmath313 as well as a possibly directed path from @xmath312 to @xmath124 in @xmath13 .",
    "then there is also a possibly directed definite status path @xmath314 from @xmath312 to @xmath124 in  @xmath13 , by lemma  [ lemmapossibledescendantsdefinitestatuspath ] .",
    "the path @xmath17 has the following properties : if @xmath221 for some @xmath315 , then @xmath316 for all @xmath255 , and the length of @xmath17 must be at least two , because of the edge @xmath317 .",
    "if @xmath17 is fully directed , there is an ( almost ) directed cycle in any dag or mag in the markov equivalence class described by @xmath13 , which violates the ancestral property .    otherwise , if @xmath17 contains a directed sub - path , let @xmath318 be the longest directed sub - path",
    ". then the sub - path @xmath319 must be of the form @xmath320 or @xmath321 . in either case ,",
    "the edge @xmath313 and repeated applications of lemma  [ lemmapropertycp1forcpdagsandpags ] imply the edge @xmath322 .",
    "this gives an ( almost ) directed cycle together with the directed path @xmath318 in any dag or mag in the markov equivalence class described by @xmath13 .",
    "this again contradicts the ancestral property .",
    "otherwise , @xmath17 does not contain a directed sub - path .",
    "let @xmath323 be the vertex preceding @xmath124 on the path .",
    "then the path has one of the following two forms : @xmath324 or @xmath325 .",
    "the edge @xmath313 and repeated applications of lemma  [ lemmapropertycp1forcpdagsandpags ] yield the edge @xmath326 , which contradicts @xmath327 or @xmath328 .",
    "theorem  [ thbackdoorsetforgeneralgraph ] requires a dag or mag in @xmath129 ; see definition  [ defr ] .",
    "the following lemma establishes such a dag or mag exists , since @xmath129 is always nonempty .",
    "this result is closely related to constructions in @xcite , theorem  2 of @xcite and lemma  27 of @xcite .",
    "[ lemmamagwithsameindegreeaspag ] let @xmath13 be a pag ( cpdag ) with @xmath329 edges into @xmath12 , @xmath330 .",
    "then there exists at least one mag ( dag ) @xmath132 in the markov equivalence class represented by @xmath13 that has @xmath329 edges into @xmath12 .",
    "building on the work of @xcite , theorem  2 of @xcite gives a procedure to create a mag ( dag ) in the markov equivalence class represented by a pag ( cpdag ) @xmath13 .",
    "one first replaces all partially directed ( @xmath10 ) edges in @xmath13 by directed ( @xmath58 ) edges .",
    "next , one considers the circle component @xmath331 of @xmath13 , that is , the sub - graph of @xmath13 consisting of nondirected ( @xmath59 ) edges and orients this into a directed graph without directed cycles and unshielded colliders .",
    "the first step of this procedure only creates tail marks , and hence can not yield an additional edge into @xmath12 . for the second step , we will argue that we can construct such a graph that does not have any edges into @xmath12 .",
    "first , we note that @xmath331 is chordal ; that is , any cycle of length four or more has a chord , which is an edge joining two vertices that are not adjacent in the cycle ; see the proof of lemma  4.1 of @xcite .",
    "any chordal graph with more than one vertex has two simplicial vertices , that is , vertices @xmath124 such that all vertices adjacent to @xmath124 are also adjacent to each other [ e.g. , @xcite ] .",
    "hence , @xmath331 must have at least one simplicial vertex that is different from @xmath12 .",
    "we choose such a vertex @xmath332 and orient any edges incident to @xmath332 into @xmath332 .",
    "since @xmath332 is simplicial , this does not create unshielded colliders .",
    "we then remove @xmath332 and these edges from the graph .",
    "the resulting graph is again chordal [ e.g. , @xcite ] and therefore again has at least one simplicial vertex that is different from @xmath12 .",
    "choose such a vertex @xmath333 , and orient any edges incident to @xmath333 into @xmath333 .",
    "we continue this procedure until all edges are oriented .",
    "the resulting ordering is called a perfect elimination scheme for @xmath331 . by construction",
    ", this procedure yields an acyclic directed graph without unshielded colliders .",
    "moreover , since @xmath12 is chosen as the last vertex in the perfect elimination scheme , we do not orient any edges into @xmath12 .    [ lemmaancestorofy ] let @xmath12 and @xmath77 be two distinct vertices in @xmath36 , where @xmath36 is a dag , cpdag , mag or pag .",
    "let @xmath136 be any graph satisfying definition  [ defr ] .",
    "if @xmath334 , then @xmath335 .",
    "let @xmath136 satisfy definition  [ defr ] , and let @xmath336 .",
    "this means that there is a collider path @xmath337 between @xmath12 and @xmath124 in @xmath136 such that every vertex on the path is an ancestor of @xmath12 or @xmath77 in @xmath133 .",
    "in particular , @xmath338 .    we first show that @xmath339 leads to a contradiction .",
    "thus , suppose there is an edge @xmath276 in @xmath136 . by construction of @xmath307",
    ", @xmath13 then contains an edge of the form @xmath340 or @xmath276 , but this forms a contradiction together with @xmath341 , by lemma  [ lemmapossiblydirectedpathandedgeinto ] .",
    "we now show that @xmath342 leads to a contradiction .",
    "thus suppose there is a directed path from @xmath124 to @xmath12 in @xmath136 of the form @xmath343 , where @xmath344 and @xmath345 . by construction of @xmath133",
    ", the edge @xmath346 must also be into @xmath12 in @xmath13 , so that @xmath13 contains @xmath347 or @xmath348 .",
    "since @xmath349 , there is a possibly directed path @xmath350 from @xmath12 to @xmath124 in @xmath13 .",
    "since @xmath133 contains a directed path from @xmath124 to @xmath204 , @xmath99 must also contain a possibly directed path @xmath351 from  @xmath124 to @xmath204 .",
    "this implies that @xmath352 is a possibly directed path from @xmath12 to @xmath204 in @xmath13 , so that @xmath353 .",
    "but this forms a contradiction with @xmath347 or @xmath346 in @xmath13 , by lemma  [ lemmapossiblydirectedpathandedgeinto ] .",
    "hence , we must have @xmath354",
    ".    we can now prove the main result in section  [ secfindingbackdoorset ] .",
    "proof of theorem  [ thbackdoorsetforgeneralgraph ] let @xmath136 satisfy definition  [ defr ] . we first show that @xmath355 or @xmath141 implies that there does not exist a generalized back - door set relative to @xmath0 and @xmath13 , since no set @xmath104 can satisfy conditions ( b - i ) and ( b - ii ) in definition  [ defbackdoorgraphical ] .",
    "thus suppose that @xmath355 .",
    "then there is a definite status back - door path of length one in @xmath13 that can not be blocked . hence condition ( b - ii )",
    "can not be satisfied by any set @xmath104 .",
    "next , suppose that there exists some vertex @xmath356 . then there is a collider path @xmath337 between @xmath12 and @xmath124 in @xmath136 such that every vertex on the path is in @xmath357 .",
    "moreover , by lemma  [ lemmaancestorofy ] , there is a directed path @xmath358 from @xmath124 to @xmath77 in @xmath136 . now consider @xmath359 .",
    "all nonendpoint vertices on @xmath17 that are not on @xmath358 are colliders on @xmath17 and in @xmath360 .",
    "the remaining nonendpoint vertices on @xmath17 are noncolliders and in @xmath361 [ since @xmath362 , so that including them in @xmath104 violates condition ( b - i ) .",
    "it then follows by lemma  [ lemmarichardsoncorollary ] that for any subset @xmath104 satisfying condition ( b - i ) , there exists an m - connecting path between @xmath12 and @xmath77 given @xmath104 in @xmath136 . by lemma  [ lemmam - seppag2mag ] , this means that we can not block all definite status back - door paths from @xmath12 to @xmath77 in @xmath13 without violating condition ( b - i ) .",
    "we now prove the other direction .",
    "thus suppose that @xmath363 and @xmath364 .",
    "then we need to show that @xmath365 satisfies conditions ( b - i ) and ( b - ii ) of definition  [ defbackdoorgraphical ] .",
    "condition ( b - i ) is satisfied trivially , since @xmath366 . to prove that condition ( b - ii ) is satisfied as well , we first show @xmath367 , by contradiction . thus ,",
    "suppose @xmath368 .",
    "by lemma  [ lemmad - sep ] , this implies @xmath369 . since @xmath155",
    ", this implies that @xmath76 in @xmath13 with a visible edge .",
    "but this means that @xmath225 , so that @xmath370 .",
    "this is a contradiction , which implies @xmath371 .",
    "hence @xmath140 m - separates @xmath12 and @xmath77 in @xmath136 by lemma  [ lemmad - sep ] ( we use here that @xmath136 is ancestral ) . by lemma  [ lemmam - seppag2mag ]",
    ", this implies that @xmath372 blocks all definite status back - door paths from @xmath12 to @xmath77 in @xmath13 , so that condition ( b - ii ) is satisfied .",
    "proof of corollary [ corbackdoorsetdag ] although this result for dags is well known , we show how one can derive this from theorem  [ thbackdoorsetforgeneralgraph ] .",
    "note that @xmath373 is the graph obtained by removing all directed edges out of @xmath12 from @xmath2 .",
    "moreover , @xmath374 and @xmath375 .",
    "now the condition @xmath376 is equivalent to @xmath143 .",
    "the other condition @xmath377 reduces to @xmath378 , and this is fulfilled automatically by the acyclicity of @xmath2 .",
    "hence theorem  [ thbackdoorsetforgeneralgraph ] reduces to the given statement .",
    "proof of corollary [ corbackdoorsetcpdag ] let @xmath2 be a dag in the markov equivalence class represented by @xmath70 , constructed without orienting additional edges into @xmath12 .",
    "let @xmath373 be obtained from @xmath2 by removing all directed edges out of @xmath12 that were directed out of @xmath12 in @xmath70 .",
    "let @xmath144 be obtained from @xmath70 by removing all directed edges out of @xmath12 .",
    "we first show that @xmath379 or @xmath380 imply @xmath381 or @xmath382 .",
    "thus suppose @xmath379",
    ". then @xmath383 .",
    "next , suppose @xmath384 .",
    "it can be easily shown that @xmath144 satisfies the basic property of lemma  [ lemmapropertycp1forcpdagsandpags ] , that @xmath385 implies @xmath386 ( since all edges that are removed are directed edges out of @xmath12 ) .",
    "hence , lemma  [ lemmapossibledescendantsdefinitestatuspath ] applies to @xmath387 , and it follows that there is a possibly directed definite status path from @xmath12 to @xmath77 in @xmath144 .",
    "all nonendpoint vertices on this path must be definite noncolliders . by construction of @xmath144 , the first edge on this path",
    "must be nondirected in @xmath144 , and by construction of @xmath373 , this edge must be oriented out of @xmath12 in @xmath373 .",
    "this implies that the entire path must be directed from @xmath12 to @xmath77 in @xmath373 , since all nonendpoint vertices are noncolliders .",
    "let @xmath124 be the vertex adjacent to @xmath12 on the path",
    ". then @xmath388 .",
    "moreover , @xmath389 .",
    "hence @xmath382 .",
    "we now show that @xmath390 or @xmath391 imply @xmath392 or @xmath393 .",
    "thus suppose that @xmath379 imply @xmath394 or @xmath395 .",
    "thus suppose @xmath396 .",
    "then either @xmath397 or @xmath398 in @xmath70 .",
    "this implies that @xmath399 or @xmath400 .",
    "next , suppose that there exists a vertex @xmath401 .",
    "note that @xmath402 implies : ( i ) @xmath403 or ( ii ) @xmath404 or ( iii ) @xmath405 . by construction of @xmath373 ,",
    "case ( i ) implies @xmath406 .",
    "but this is in contradiction with @xmath407 , by lemma  [ lemmapossiblydirectedpathandedgeinto ] . in case ( ii )",
    ", we have @xmath408 and a directed path from @xmath124 to @xmath77 in @xmath409 , so that @xmath410 .",
    "similarly , we can obtain @xmath410 in case ( iii ) .",
    "this implies @xmath393 in cases ( ii ) and ( iii ) .",
    "the above shows the following : if @xmath399 or @xmath411 , then it is impossible to satisfy the generalized back - door criterion relative to @xmath0 and @xmath70 . on the other hand ,",
    "if @xmath412 and @xmath147 , then @xmath413 satisfies the generalized back - door criterion relative to @xmath0 and @xmath70 .",
    "it is left to show that in the latter case , we can replace @xmath413 by @xmath414 . since @xmath415 , it is clear that @xmath414 satisfies condition ( b - i ) of definition  [ defbackdoorgraphical ] .",
    "we will now show that it also satisfies condition ( b - ii ) .",
    "thus , suppose that @xmath416 and @xmath417 .",
    "consider a definite status back - door path @xmath226 from @xmath12 to @xmath77 in @xmath70 .",
    "since @xmath17 is a back - door path , it must start with @xmath418 or @xmath419 .",
    "moreover , the length of @xmath17 is at least two . if @xmath418 , then it is clear that @xmath414 blocks @xmath17 .",
    "if @xmath420 , then @xmath17 can not have a sub - path of the form @xmath421 , @xmath422 , because @xmath209 is of a definite status .",
    "moreover , @xmath17 can not be possibly directed , because then @xmath380 .",
    "hence , there must be at least one collider on @xmath17 .",
    "let @xmath262 be the collider on @xmath17 that is closest to @xmath12 .",
    "then the sub - path @xmath423 is a possibly directed path from @xmath12 to @xmath262 in @xmath70 .",
    "suppose that @xmath262 is an ancestor of some vertex @xmath424 in @xmath70 .",
    "then there is a possibly directed path from @xmath12 to @xmath204 in @xmath70 , as well as an edge @xmath346 .",
    "but this is impossible by lemma  [ lemmapossiblydirectedpathandedgeinto ] .",
    "hence , @xmath262 can not be an ancestor of any member of @xmath414 in @xmath70 .",
    "this implies that @xmath17 is blocked by @xmath414 .",
    "we are very grateful to markus kalisch , thomas richardson and two anonymous referees for their comments and suggestions that have significantly improved the paper ."
  ],
  "abstract_text": [
    "<S> we generalize pearl s back - door criterion for directed acyclic graphs ( dags ) to more general types of graphs that describe markov equivalence classes of dags and/or allow for arbitrarily many hidden variables . </S>",
    "<S> we also give easily checkable necessary and sufficient graphical criteria for the existence of a set of variables that satisfies our generalized back - door criterion , when considering a single intervention and a single outcome variable . </S>",
    "<S> moreover , if such a set exists , we provide an explicit set that fulfills the criterion . </S>",
    "<S> we illustrate the results in several examples . </S>",
    "<S> r - code is available in the ` pcalg ` </S>",
    "<S> .    ./style / arxiv - general.cfg </S>"
  ]
}