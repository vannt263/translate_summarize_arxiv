{
  "article_text": [
    "tropical geometry is the study of algebraic geometry in terms of a `` combinatorial shadow '' ; for instance , the study of algebraic curves becomes a study of graphs and metric graphs .",
    "many notions in classical algebraic geometry now have combinatorial counterparts , such as _ divisors _ , _ jacobians _ , and the _ riemann - roch theorem _ for graphs and metric graphs @xcite , @xcite , @xcite .",
    "furthermore , tropical geometry also possesses some combinatorial tools that do not exist in the classical world .",
    "one example is the notion of _ break divisors _ introduced by mikhalkin and zharkov @xcite .",
    "they proved that there is a continuous section to the map @xmath2 from degree @xmath3 effective divisors to the degree @xmath3 divisor classes on a metric graph @xmath4 of genus @xmath3 ; the set of break divisors is the image of this section .",
    "such a section does not exist in the world of algebraic curves . a combinatorial proof of the mikhalkin - zharkov result was given by an , baker , kuperberg and shokrieh @xcite , who also proved a discrete version of the theorem for finite graphs , namely that _ integral break divisors _ form a set of representatives for @xmath5 .",
    "+ break divisors are closely related to _ spanning trees _ of a graph and other combinatorial concepts . on finite graphs ,",
    "the set of ( integral ) break divisors has the same cardinality as the set of spanning trees , and break divisors are equivalent to _ indegree sequences of root - connected orientations _ and gioan s _ cycle - cocycle reversal classes _ @xcite . on metric graphs ,",
    "the authors of @xcite constructed a _",
    "polyhedral decomposition _ of @xmath6 where each full - dimensional cell canonically represents a spanning tree . using this polyhedral decomposition , they gave a `` volume proof '' of the classical kirchhoff s matrix  tree theorem ; such a polyhedral decomposition is also related to tropical geometry topics including brill - noether theory and tropical theta divisors ; we refer the reader to ( * ? ? ?",
    "* section 5.4 ) for details .",
    "+ the authors of @xcite observed that generic `` shiftings '' of their polyhedral decomposition induce bijections between integral break divisors and spanning trees . in this paper",
    "we give a combinatorial description of such bijections .",
    "these `` geometric bijections '' are special cases of what we call _ cycle orientation maps_. we give a necessary and sufficient condition for a cycle orientation map to be geometric , and hence a sufficient condition for a cycle orientation map to be bijective .",
    "our proof is geometric in nature , and gives a new `` non - combinatorial '' approach to proving bijectivity ; indeed , we do not know a combinatorial proof of bijectivity for general geometric bijections .",
    "we also study algorithmic aspects of a particular class of cycle orientation maps that we call _ edge ordering maps_. + bernardi introduced a process on graphs using _ ribbon structures _",
    "@xcite , that is , combinatorial data to specify embeddings of graphs on orientable surfaces . using his process",
    ", bernardi obtained various bijections between certain classes of subgraphs and certain classes of ( indegree sequences of ) orientations , as well as a new characterization of the tutte polynomial .",
    "in particular , bernardi gave a bijection between spanning trees and indegree sequences of root - connected orientations .",
    "treating those indegree sequences as elements of @xmath5 , bernardi s bijections induce simply transitive group actions ( or _ torsor structures _ ) of the jacobian on the set of spanning trees .",
    "motivated by a question of ellenberg @xcite , @xcite , baker and wang proved that if the ribbon structure is planar , then all bernardi torsors are isomorphic and they respect plane duality @xcite .",
    "similar results were proven for _ rotor routing _ by chan et al .",
    "@xcite , @xcite ( see @xcite for background on rotor routing ) .",
    "in fact , baker and wang showed that the torsors induced by bernardi bijections are isomorphic to the torsors induced by rotor routing if the ribbon structure is planar .",
    "based on these results about plane graphs , baker asked whether planar bernardi bijections come from the aforementioned geometric picture @xcite . in this paper , we answer baker s question in the affirmative , and we give alternative proofs and sharpenings of baker and wang s results . + the paper is structured as follows . in section",
    "[ sec : intro ] , we give some background for various topics we consider in this paper ; [ sec : intro_graph ] is fundamental for all of the paper , [ sec : intro_metric ] and [ sec : intro_decomp ] are used in for section [ sec : gb ] , [ sec : intro_go ] is the combinatorial background for sections [ sec : bijection ] and [ sec : bernardi ] , [ sec : intro_bernardi ] and [ sec : intro_duality ] contain material needed for section [ sec : bernardi ] . in section [ sec : gb ] , we give our combinatorial description of geometric bijections . in section",
    "[ sec : bijection ] , we focus on edge ordering maps , which have good combinatorial and algorithmic properties . in section [ sec : bernardi ] , we study when a bernardi bijection is geometric and give new proofs of some fundamental facts about bernardi bijections . in section [ sec : problems ] , we mention several open problems for future research .",
    "section [ sec : bijection ] is purely combinatorial , and can be read independently of the geometric discussion in section [ sec : gb ] ; section [ sec : bernardi ] is almost independent of the previous two sections except definitions for definition [ def_coc ] and theorem [ def_eom ] . therefore readers interested in particular parts can read the corresponding background and jump to the individual section directly . + * acknowledgement * : many thanks to matt baker for proposing the conjecture relating geometric bijections and bernardi bijections to the author , as well as for helpful comments and suggestions throughout the author s research and writing process .",
    "the author also wants to thank spencer backman , farbod shokrieh , olivier bernardi , greg kuperberg and lionel levine for engaging conversations .",
    "finally the author would like to thank robin thomas , josephine yu , chun - hung liu , yan wang and marcel celaya for checking some of the technical graph theory and polyhedral geometry lemmas in this paper , and emma cohen for drawing figure [ bernardi_om_diag ] .",
    "unless otherwise specified , all graphs in this paper are assumed to be finite and connected , possibly with parallel edges but without any loops ; the term cycle will refer to a simple cycle .",
    "we use @xmath7 and @xmath8 to denote the number of vertices , edges and cycles of a graph , respectively .",
    "the _ laplacian matrix _",
    "@xmath9 of a graph is the @xmath10 matrix defined as @xmath11 , where @xmath12 is a diagonal matrix with the @xmath13-entry being the degree of the vertex @xmath14 , and @xmath15 is the adjacency matrix of @xmath1 with the @xmath16-entry being the number of edges between @xmath14 and @xmath17 for @xmath18 and 0 for @xmath19 .",
    "+ a _ divisor _ on a graph @xmath20 is a function @xmath21 .",
    "the set of all divisors on @xmath1 is denoted by @xmath22 ; it has a natural group structure as the free abelian group generated by @xmath23 .",
    "the _ degree _ @xmath24 of a divisor @xmath12 is @xmath25 , and the set of all divisors of degree @xmath26 is denoted by @xmath27 . identifying divisors with vectors in @xmath28 , we say a divisor is _ principal _ if it is equal to @xmath29 for some integral vector @xmath30 .",
    "the set of all principal divisors is denoted by @xmath31 .",
    "@xmath31 is a subgroup of @xmath32 and the quotient group @xmath33 is the ( degree 0 ) _ picard group _",
    "@xmath34 of @xmath1 ; the picard group of a graph is also known as the jacobian , the sandpile group or the critical group of the graph in other literature .",
    "more generally we say two divisors @xmath35 are _ linearly equivalent _ , denoted @xmath36 , if @xmath37 .",
    "we denote by @xmath38 the set @xmath39 .",
    "it is easy to see that @xmath38 and @xmath34 differ only by a degree @xmath26 translating element .",
    "+ given a divisor @xmath12 , we often say there are @xmath40 _ chips _ at vertex @xmath41 , and we can construct a divisor on @xmath1 by adding or removing chips on vertices in various ways .",
    "the concept of linear equivalence can be captured by the _ chip - firing game _ on @xmath1 , see @xcite for its usage in the riemann - roch theory on graphs and @xcite for a brief overview of chip - firing in other parts of mathematics . + a _ spanning tree _ of @xmath1 is a connected spanning subgraph of @xmath1 with no cycles .",
    "denote by @xmath42 the _ genus _ ( or cyclomatic number ) of @xmath1 , which is the number of edges outside any spanning tree of @xmath1 ; we clarify that @xmath3 is not the topological genus of @xmath1 as in the usual topological graph theory sense .",
    "it is known that the picard group has the same cardinality as the set of spanning trees @xmath43 of a graph @xcite .",
    "a degree @xmath3 divisor is called an ( integral ) _ break divisor _ if it can be obtained from the following procedure : choose a spanning tree @xmath44 of @xmath1 , and for every edge @xmath45 , pick an orientation of @xmath46 and add a chip at the head of @xmath46 . in general , different choices of spanning trees and orientations",
    "can produce the same break divisor .",
    "it is proven in ( * ? ? ?",
    "* theorem 1.3 ) that break divisors form a set of representatives for the divisor classes in @xmath5 . in particular , the number of break divisors is equal to the number of spanning trees of @xmath1 .      a _ metric graph _",
    "@xmath4 ( or an abstract tropical curve ) is a compact connected metric space such that every point has a neighborhood isometric to a star - shaped set .",
    "every metric graph can be constructed in the following way : start with a weighted graph @xmath47 , associate with each edge @xmath48 a closed line segment @xmath49 of length @xmath50 , and identify the endpoints of the @xmath49 s according to the graph structure in the obvious way .",
    "a ( weighted ) graph @xmath1 that yields a metric graph @xmath4 is said to be a _ model _ of @xmath4 .",
    "the _ genus _ of @xmath4 is the genus of any model of @xmath4 .",
    "see @xcite for details . for simplicity",
    ", we assume all graphs we consider have uniform edge weights 1 , though most geometric propositions in this paper remain valid for the general case .",
    "+ metric graphs have an analogous theory of divisors as graphs ; we refer the reader to @xcite for details and only explain the most relevant notions here .",
    "a _ divisor _ on @xmath4 is an element of the free abelian group generated by @xmath4 ; equivalently , it is a function @xmath51 of finite support .",
    "a divisor @xmath52 is a _ break divisor _ if there is a model @xmath1 for @xmath4 and an edge @xmath53 of @xmath1 for each @xmath54 such that @xmath55 , and @xmath56 is a spanning tree of @xmath1 . as in the case in graphs , break divisors on @xmath4 form a set of representatives for the equivalence classes in @xmath6 , cf .",
    "* theorem 1.1 ) , @xcite . + we say a divisor on a metric graph @xmath4 is _ integral _ with respect to a model @xmath1 if the support of @xmath12 consists of vertices of @xmath1 . for any model @xmath1 of @xmath4 , the break divisors of @xmath1 naturally correspond to the integral break divisors on @xmath4 with respect to @xmath1 .",
    "the picard group @xmath57 , and hence any @xmath58 , has a natural @xmath3-dimensional real torus structure .",
    "we give an informal description here ; readers interested in a rigorous treatment can refer to @xcite .",
    "+ let @xmath1 be a ( weighted ) graph with every edge given some arbitrary but fixed orientation , which we will call the _ reference orientation_. the _ real edge space _ @xmath59 of @xmath1 is the @xmath60-dimensional vector space with @xmath61 as a basis over @xmath62 .",
    "this space is equipped with an _ inner product _ @xmath63 that extends @xmath64 bilinearly . the _ real cycle space _",
    "@xmath65 is the @xmath3-dimensional subspace of @xmath59 spanned by all cycles of @xmath1 ; denote by @xmath66 the orthogonal projection .",
    "the projections of @xmath26 edges @xmath67 onto @xmath65 are linearly independent if and only if @xmath68 is connected , and in particular @xmath69 is a basis of @xmath65 exactly when @xmath70 are the edges outside some spanning tree @xmath44 .",
    "let @xmath71 denotes the unique cycle ( known as the _ fundamental cycle _ ) contained in @xmath72 , then @xmath73 is a basis of @xmath65 . the _ integral cycle space _",
    "@xmath74 is the @xmath3-dimensional lattice in @xmath65 consisting of integral combinations of cycles of @xmath1 ; it is generated by @xmath73 for the set of fundamental cycles of any spanning tree @xcite .",
    "the _ tropical jacobian _",
    "@xmath75 is the @xmath3-dimensional real torus @xmath76 with the induced inner product .",
    "+ now we define an isomorphism @xmath77 between @xmath6 and @xmath75 . fix a vertex @xmath78 of @xmath1 . for each divisor class in @xmath6 , pick the unique break divisor @xmath79 from it . for each @xmath54 , choose a path @xmath80 from @xmath78 to @xmath54 and interpret @xmath80 as an element of @xmath59 .",
    "then the image of @xmath81 $ ] in @xmath75 is @xmath82\\in h_1(g,\\mathbb{r})/h_1(g,\\mathbb{z})={\\operatorname{jac}}(\\gamma)$ ] . from now on we will often abuse notations and identify @xmath6 and @xmath75 using @xmath77 . +",
    "* example . * in figure [ aj_diag ] , take the spanning tree @xmath83 .",
    "the cycle space is spanned by @xmath84 .",
    "take the paths @xmath85 from @xmath78 to @xmath86 .",
    "the image of @xmath87 in @xmath75 is @xmath88=[\\frac{-1}{24}c_1+\\frac{1}{8}c_2]=[\\frac{23}{24}c_1+\\frac{1}{8}c_2]$ ] . +     and a break divisor @xmath87 on it . ]",
    "it is interesting to ask how the image of @xmath77 changes when a break divisor is perturbed by a small amount .",
    "let @xmath79 be a break divisor , choose a spanning tree @xmath44 with @xmath89 denoting the ( unit length ) edges not in @xmath44 in such a way that @xmath90 .",
    "suppose that for some @xmath91 the segment @xmath92 is of length @xmath93 , let @xmath94 where @xmath95 is a point in @xmath96 such that @xmath97 is of length @xmath98",
    ". then @xmath99)=\\phi([d])+[(\\alpha'_j-\\alpha_j)\\pi(e_j)]$ ] .",
    "+ a generic break divisor with respect to a model @xmath1 , that is a break divisor with each point @xmath54 of its support lying in the interior of some edge @xmath53 , determines a unique spanning tree @xmath100 .",
    "the set of all generic break divisors that determine the same spanning tree @xmath44 forms a connected open set in @xmath6 .",
    "more precisely , let @xmath44 be a spanning tree and let the edges not in @xmath44 be @xmath89 . then by definition @xmath101 is a break divisor and the image of every generic break divisor compatible with @xmath44 is equal to @xmath102)+[\\sum_{i=1}^g \\alpha_i\\pi(e_i)]$ ] for some @xmath103 .",
    "the closure @xmath104 of such subset is therefore the image of ( a translation of ) the parallelotope @xmath105 in @xmath75 .",
    "we call @xmath104 the _ cell corresponding to @xmath44_. the tropical jacobian is the union of @xmath104 as @xmath44 runs through all spanning trees of @xmath1 .",
    "as two distinct cells are disjoint except possibly at the boundary , they give a _",
    "polyhedral decomposition _ of @xmath106 . also , by construction , the vertices of such decomposition are exactly the integral break divisors on @xmath4 .",
    "+     ( ( * ? ? ?",
    "* figure 1)).,scaledwidth=50.0% ]     ( ( * ? ? ?",
    "* figure 1)).,scaledwidth=80.0% ]    * remark .",
    "* as an outcome of studying the combinatorial meaning of the polyhedral decomposition , we state a combinatorial interpretation of all faces of the polyhedral decomposition here , which might be useful for future work .",
    "we say a pair @xmath107 , with @xmath108 , is a _",
    "break @xmath16-configuration _ if @xmath109 is connected and @xmath110 is a break divisor of @xmath109 .",
    "thus , for examples , a @xmath111-configuration specifies a break divisor and a @xmath112-configuration specifies a spanning tree . for each @xmath113",
    ", there is a one - to - one correspondence between the @xmath114-dimensional faces and the break @xmath115-configurations , where a break configuration @xmath107 corresponds to the face consisting of break divisors of the form @xmath116 where each chip of @xmath117 is in an edge of @xmath118 .      in the paper of an - baker - kuperberg - shokrieh @xcite ,",
    "many key results related to break divisors were proven using the concept of _ orientable divisors _ , which were further developed into an algorithmic theory by backman @xcite . in this section , basic definitions and results are reviewed .",
    "we mostly work with full orientations on finite graphs , though the general theory includes partial orientations on metric graphs .",
    "let @xmath119 be an orientation of a graph @xmath1 .",
    "the divisor @xmath120 is @xmath121 , so @xmath122 .",
    "a divisor is orientable if it can be obtained this way .",
    "fix @xmath123 .",
    "an orientation @xmath119 is @xmath78-connected if any vertex of @xmath1 can be reached from @xmath78 via a directed path .",
    "a divisor is @xmath78-orientable if it is of the form @xmath120 for some @xmath78-connected orientation @xmath119 .",
    "( note that a @xmath78-orientable divisor is equivalent to the indegree sequence of a root - connected orientation in the sense of @xcite . )",
    "the following observation reduces many questions related to break divisors to orientable divisors .",
    "( ( * ? ? ?",
    "* lemma 3.3 ) , ( * ? ? ?",
    "* theorem 7.5 ) ) [ break_equal_qconn ] fix @xmath123 .",
    "the map @xmath124 gives a bijection between break divisors and @xmath78-orientable divisors . in terms of orientations , given a spanning tree @xmath44 and an orientation of the edges not in @xmath44",
    ", one can get a @xmath78-connected orientation of @xmath1 by orienting edges in @xmath44 away from @xmath78 .    next we mention gioan s work on the _ cycle - cocycle reversal system _ @xcite in the language of divisors , as in backman s paper @xcite",
    ". given an orientation @xmath119 of a graph @xmath1 , a _ cycle reversal _ operation reverses all edges of a directed cycle of @xmath119 and a _ cocycle reversal _ reverses all edges of a directed cut .",
    "these two operations have concise interpretations at the level of divisors :    ( ( * ? ? ?",
    "* lemma 3.1 , theorem 3.3 ) , ( * ? ? ?",
    "* proposition 4.10 , corollary 4.13 ) ) let @xmath125 be two orientations of a graph @xmath1",
    ". then @xmath126 if and only if @xmath127 can be obtained from @xmath119 by a sequence of cycle reversals , and @xmath128 if and only if @xmath127 can be obtained from @xmath119 by a sequence of cycle reversals and cocycle reversals .    as a corollary",
    ", we can define an equivalence relation @xmath129 on the set @xmath130 of orientations of @xmath1 by setting @xmath131 if @xmath119 and @xmath127 differ by a sequence of cycle / cocycle reversals .",
    "the set of such _ cycle - cocycle reversal classes _ is naturally in bijection with @xmath132 :    ( ( * ? ? ?",
    "* section 5 ) ) the map @xmath133 given by @xmath134\\mapsto [ d_{{{\\mathcal o}}}]$ ] is a well - defined bijection .",
    "backman , generalizing work of felsner , gives a polynomial time algorithm ( * ? ? ?",
    "* algorithm 7.6 ) which , given a degree @xmath3 divisor @xmath12 and a vertex @xmath78 , produces a @xmath78-connected orientation @xmath119 such that @xmath135 .",
    "in particular , if @xmath12 is itself a break divisor , then @xmath136 .",
    "it is worth mentioning that the key ingredient underlying backman s algorithm is the max - flow - min - cut theorem in graph theory , and the algorithm itself uses a maximum flow algorithm .",
    "bernardi introduced an algorithmic bijection from the set @xmath43 of spanning trees of a graph @xmath1 to the set of indegree sequences of @xmath78-connected orientations @xcite .",
    "his bijection uses the notion of _ ribbon graph _ ( also known as a combinatorial map or rotation system ) , which is a finite graph @xmath1 together with a cyclic ordering of the edges around each vertex .",
    "every embedding of a graph into a closed orientable surface induces a ribbon structure on @xmath1 , where the cyclic ordering of edges around a vertex comes from the orientation of the surface ; conversely every ribbon structure on @xmath1 induces an embedding of @xmath1 onto a closed orientable surface upto homeomorphism .",
    "we refer the reader to ( * ? ? ?",
    "* section 3.2 ) for details .",
    "we say a ribbon graph is _ planar _ if the surface of the corresponding embedding is the sphere , and whenever we talk about a planar ribbon graph we implicitly assume the graph is a plane graph , i.e. a graph already embedded into @xmath137 as a geometric object ( cf .",
    "* section 4.2 ) ) , and the ribbon structure is induced by the counter - clockwise orientation of the plane .",
    "the only exception is when we are working with planar duals ( see section [ sec : intro_duality ] ) , in which case we assume that the ribbon structures of planar duals are induced by the clockwise orientation of the plane . + fix a ribbon structure of a graph @xmath1 and a _ starting pair _",
    "@xmath138 , where @xmath48 is an edge and @xmath41 is a vertex incident to @xmath48 . for any spanning tree @xmath44 of @xmath1 , _",
    "bernardi s process _ produces a tour @xmath139 of the vertices and edges of @xmath1 .",
    "explicitly , start with @xmath140 , and in each step , determine @xmath141 using @xmath142 as follows : if @xmath143 , then set @xmath144 and set @xmath145 to be the next edge of @xmath53 around @xmath14 in the fixed cyclic order ; otherwise set @xmath146 to be the other end of @xmath53 and set @xmath145 to be the next edge of @xmath53 around @xmath146 .",
    "the process stops when every edge is traversed exactly twice .",
    "informally , the tour is obtained by walking along edges belonging to @xmath44 and cutting through edges not belonging to @xmath44 , beginning with @xmath48 and proceeding according to the ribbon structure , see @xcite , @xcite for details .",
    "we shall also use the term _ state _ to indicate a pair @xmath147 .",
    "+ we can associate a break divisor @xmath148 to such a tour .",
    "for each edge @xmath48 of @xmath1 , @xmath48 appears in the tour twice as @xmath149 , @xmath150 , denote by @xmath151 the vertex @xmath14 .",
    "now @xmath148 is defined as @xmath152 , i.e. whenever it is the first time we cut through an edge @xmath153 , we put a chip at the vertex we cut @xmath48 from .",
    "it is ( implicitly ) shown by bernardi @xcite that for any fixed ribbon structure and starting pair , the bernardi process induces a bijection between @xmath43 and the set of break divisors .",
    "we call these bijections _ bernardi bijections_. explicit inverses to @xmath154 arre given by bernardi @xcite and baker - wang @xcite . in this paper , we often abuse notation and interpret @xmath154 as a map from @xmath43 to @xmath5 , as well as a map from @xmath43 to the set of partial orientations of @xmath1 , i.e. whenever @xmath153 , orient it from @xmath17 to @xmath14 .",
    "the divisor @xmath148 is thus the in - degree sequence of such a partial orientation . as in proposition",
    "[ break_equal_qconn ] , one can extend such a partial orientation to a full orientation by orienting edges in @xmath44 away from some vertex @xmath78 .",
    "+          let @xmath20 be a plane graph and let @xmath155 be a _ planar dual _ , so each face @xmath156 of @xmath1 corresponds to a _ dual vertex _",
    "@xmath157 of @xmath158 , and every edge @xmath48 of @xmath1 corresponds to a _ dual edge _",
    "@xmath159 in which @xmath160 are adjacent along @xmath159 if and only if the two faces @xmath161 are adjacent along @xmath48 in @xmath1 , see ( * ? ? ? * chapter 4 ) for details .",
    "denote by @xmath162 the genus of @xmath158 . +",
    "every spanning tree @xmath44 of @xmath1 corresponds to a _ dual tree _",
    "@xmath163 of @xmath158 , denote the corresponding map by @xmath164 .",
    "every full orientation @xmath119 of @xmath1 corresponds to a _ dual orientation _",
    "@xmath165 of @xmath158 , by the convention that locally near the crossing of @xmath48 and @xmath159 , the orientation of @xmath159 is obtained from the orientation of @xmath48 by following the orientation of the plane . since the directed cycles ( resp .",
    "cocycles ) in @xmath119 are the directed cocycles ( resp",
    ". cycles ) in @xmath165 , the map @xmath166\\mapsto[{{\\mathcal o}}^\\star]$ ] is well - defined and gives a bijection between the cycle / cocycle reversal systems @xmath167 of @xmath1 and @xmath158 respectively . composing with the maps @xmath168 from section [ sec : intro_go ] , we have a bijective map @xmath169 given by @xmath170\\mapsto [ d_{{{\\mathcal o}}^\\star}]$ ] .",
    "on the other hand , @xmath34 can be identified with @xmath171 , where @xmath172 are the _ lattice of 1-chains _ , the _ lattice of integer cuts _ ( cocycles ) , and the _ lattice of integer flows _ ( cycles ) of @xmath1 , respectively ( * ? ? ?",
    "* proposition 28.2 ) .",
    "hence there is a canonical isomorphism @xmath173 using the canonical isomorphism between @xmath174 and @xmath175 , @xmath176 and @xmath177 ( * ? ? ?",
    "* proposition 8) and the identification of @xmath178 and @xmath179 .",
    "+ given a set @xmath180 , a group @xmath1 and a group action @xmath181 , we say @xmath180 is a _",
    "@xmath1-torsor _ if the action is simple transitive .",
    "for example , @xmath132 is a @xmath34-torsor via the action @xmath81\\cdot [ e]=[d+e]$ ] for @xmath81\\in{\\operatorname{pic}}^0(g),[e]\\in{\\operatorname{pic}}^{g-1}(g)$ ] .",
    "more generally , whenever we have a bijection @xmath182 between some set @xmath180 and @xmath132 , @xmath180 is a @xmath34-torsor , where the group action is @xmath81\\cdot x=\\beta^{-1}([d]\\cdot [ \\beta(x)])$ ] .",
    "two bijections @xmath183 give _ isomorphic torsors _ if there exists some translating element @xmath184\\in{\\operatorname{pic}}^0(g)$ ] such that @xmath185+\\beta_1(x)$ ] for all @xmath186 . in the notation of the previous paragraph , one can show that @xmath187\\cdot[e])=\\sigma'_d([d])\\cdot\\sigma_d([e])$ ] for @xmath81\\in{\\operatorname{pic}}^0(g),[e]\\in{\\operatorname{pic}}^{g-1}(g)$ ] .",
    "consider the polyhedral decomposition of @xmath106 introduced in section [ sec : intro_decomp ] .",
    "we can get a bijection between vertices and cells of the decomposition by `` shifting '' ( * ? ? ? * remark 4.26 ) . explicitly , choose some direction @xmath188 in @xmath65 , superimpose two copies of @xmath75 , shift one copy along the direction of @xmath188 by an infinitesimally small distance .",
    "if @xmath188 is generic ( whose definition will be clear below ) , then each cell in the shifted copy will contain exactly one vertex in the fixed copy ( because a cell is essentially a parallelotope ) . in this manner",
    ", we have a bijection from cells to vertices .",
    "+ our study of such bijection will be divided in three steps .",
    "first we work with a single cell as a subset of @xmath65 so we can use linear algebra , then we put the same cell back to @xmath75 , and finally we handle all cells in @xmath75 together .",
    "+ let @xmath44 be a spanning tree of @xmath1 and let @xmath70 be the edges outside @xmath44 .",
    "recall that the cell @xmath104 can be thought of the image of the parallelotope @xmath189 in @xmath190 . given a vector @xmath191 ,",
    "a vertex @xmath41 will be shifted into @xmath192 along @xmath188 if and only if @xmath188 is in the interior of the _ tangent cone _ @xmath193 .",
    "as @xmath192 is a parallelotope , the tangent cones of all vertices patch together nicely to a complete fan in @xmath194 , which we temporarily call the _ tangent fan _ of @xmath192 . here",
    "we list some simple properties of this fan in general .",
    "let @xmath195 be a full - dimensional parallelotope and let @xmath196 be its tangent fan .",
    "the ( full dimensional ) cone corresponding to the vertex @xmath197 ( here @xmath198 ) is @xmath199 .",
    "+ two full - dimensional cones @xmath200 of @xmath196 intersect in a @xmath201-dimensional cone if and only if @xmath202 are adjacent in the 1-skeleton of @xmath203 , i.e. @xmath204 differ by exactly one coordinate @xmath114 . in this case , the @xmath201-dimensional cone of intersection is @xmath205 hence @xmath196 can be thought of as the fan corresponding to the hyperplane arrangement with hyperplanes @xmath206 for each @xmath114 .    for the case",
    "where each @xmath207 is the projection of some edge of @xmath1 , the hyperplanes @xmath206 have a simple combinatorial interpretation .",
    "[ hp_interpret ] let @xmath208 where @xmath209 is connected , and let @xmath210 be the unique cycle of @xmath211 .",
    "then for an edge @xmath46 of @xmath1 , @xmath212 if and only if @xmath213 ; and we have @xmath214 .",
    "proof : given @xmath215 , @xmath212 if and only if @xmath216 and @xmath217 do not span the whole @xmath65 , if and only if @xmath218 is not connected , if and only if @xmath213 .",
    "for the second part note that for every @xmath219 , @xmath220 , which is 0 because @xmath221.@xmath222 + when @xmath223 are the edges outside @xmath44 , the cycle @xmath210 in proposition [ hp_interpret ] is the fundamental cycle of @xmath44 with respect to @xmath46 .",
    "therefore the tangent fan @xmath196 of @xmath192 is exactly the fan corresponding to the hyperplane arrangement with hyperplanes @xmath224 as @xmath210 ranges over all fundamental cycles of @xmath44 .",
    "let @xmath191 be the shifting vector and write @xmath188 as @xmath225 . by proposition [ hp_interpret ] , @xmath188",
    "is contained in some hyperplane @xmath224 if and only if some @xmath226 is zero ; for the _ generic case _",
    "when all @xmath226 s are non - zero , @xmath188 lies in the interior of the cone @xmath227 , where @xmath228 is 0 if @xmath229 and @xmath230 if @xmath231 .",
    "+ the map from @xmath232 to @xmath75 might not be injective , but it is injective when restricted to the interior of @xmath192 , and a vertex of @xmath192 will only be mapped to other vertices .",
    "hence it still makes sense to talk about the tangent fan of the cell @xmath104 . given a generic vector @xmath233 , @xmath234 is in the cone @xmath227 where @xmath228 is 1 if @xmath229 and @xmath235 if @xmath231 .",
    "the image of @xmath236 in @xmath75 is the integral break divisor @xmath237 , where @xmath238 equals the tail of @xmath53 and @xmath239 is the head of @xmath53 .",
    "@xmath12 will be the break divisor @xmath44 maps to after shifting along @xmath188 . in terms of orientation , for each @xmath143 , orient @xmath53 as its reference orientation if @xmath229 and as the opposite orientation if @xmath231 .",
    "note that all vectors in the interior of a cone of @xmath196 produce the same divisor ( resp .",
    "orientation ) .",
    "+ let @xmath210 be the fundamental cycle of @xmath44 with respect to @xmath53 , and pick the orientation for @xmath210 such that @xmath240 . by proposition [ hp_interpret ] , @xmath241 , where @xmath242 is 1 if the orientation of @xmath53 in @xmath210 agrees with the reference orientation of @xmath53 , and -1 otherwise .",
    "therefore the sign of @xmath226 equals @xmath242 , and one can check that whatever the sign of @xmath226 is , the orientation of @xmath53 we obtained in the last paragraph is the same as its orientation in @xmath210 .",
    "the advantage of working with orientation of cycles is that it depends solely on the position of a generic vector ( resp . a cone ) in the fan , but not on a particular basis .",
    "+ finally , take the common refinement of all tangent fans of the cells @xmath104 as @xmath44 varies over all spanning trees .",
    "this is the fan corresponding to the hyperplane arrangement with hyperplanes @xmath224 perpendicular to various cycles @xmath210 of @xmath1 .",
    "a vector is _ generic _ if it is not perpendicular to any cycle involved in the fan .",
    "the following simple observation shows that every cycle of @xmath1 occurs in this fan .",
    "[ every_cyc_gbcs ] for every cycle @xmath210 of a graph @xmath1 , @xmath224 occurs as a hyperplane in the above fan system .",
    "proof : pick any edge @xmath243 .",
    "since @xmath244 is connected and @xmath245 is acyclic , there exists some spanning tree @xmath44 of @xmath1 that contains all edges of @xmath210 except @xmath48 .",
    "therefore @xmath210 is a fundamental cycle of @xmath44 and @xmath224 occurs in the tangent fan of @xmath104.@xmath222 + we call this fan the _ geometric bijection fan_. every full - dimensional cone gives rise to an orientation for each cycle of @xmath1 as in the single cell case : a cone orients a cycle @xmath210 so that @xmath246 is positive , where @xmath188 is an arbitrary vector in the interior of the cone . using these orientations , we can describe the geometric bijection corresponding to the cone .",
    "let @xmath44 be a spanning tree , and for every @xmath45 , let @xmath247 be its fundamental cycle .",
    "orient @xmath46 according to its orientation in @xmath247 , and put a chip at the head of @xmath46 ; the resulting break divisor is the one that lands in @xmath104 after shifting by a small amount along any direction in the cone . +",
    "this discussion motivates the following definitions , which will be used throughout in the rest of our paper .",
    "[ def_coc ] a cycle orientation configuration is an assignment of an orientation to each cycle of the graph @xmath1 .",
    "given a cycle orientation configuration , one can define a map from the set of spanning trees to the set of break divisors by first orienting each edge outside a spanning tree according to the orientation of its fundamental cycle , then putting a chip at the head of each edge ; we call such a map a cycle orientation map .",
    "if the resulting map from spanning trees to break divisors ( resp . the corresponding cycle orientation configuration ) comes from geometric shifting , we say it is geometric .",
    "not every cycle orientation configuration is geometric . in this section",
    "we give two combinatorial criteria for a cycle orientation configuration to be geometric .",
    "[ first_criterion ] a cycle orientation configuration is geometric if and only if for some ( hence every ) spanning tree @xmath44 , one can assign weights @xmath248 to the edges @xmath249 such that for each cycle @xmath210 , @xmath250 .",
    "proof : this follows from the discussion in section [ sec : com ] . since @xmath251 each cycle orientation configuration comes from shifting along the vector @xmath252 .",
    "conversely , if we write the shifting vector with respect to the basis @xmath69 , then we can take the coordinates as weights.@xmath222 + it is difficult to show that a cycle orientation configuration is ( not ) geometric using theorem [ first_criterion ] .",
    "the following proposition , which provides an alternate criterion , is a direct corollary of the gordan s lemma in linear programming ( * ? ? ?",
    "* theorem 14 ) .    [ generic_lp_criterion ]",
    "a cycle orientation configuration @xmath253 is geometric if and only if there exist no non - negative integral solutions to @xmath254 other than the zero solution",
    ".    * remark .",
    "* the condition in theorem [ generic_lp_criterion ] is often called the _ acyclic _ condition in the oriented matroid literature , cf . @xcite . + as an application of the second criterion , we show that the edge weight formulation of our first criterion can be generalized to any edge set outside a forest .",
    "let @xmath156 be an arbitrary forest of @xmath1 and let @xmath255 be the edges not in @xmath156 . assign a generic weight @xmath226 to every edge @xmath53 .",
    "then orient each cycle @xmath210 of @xmath1 so that @xmath256 is positive .",
    "the resulting cycle orientation configuration is geometric .",
    "proof : consider the equation @xmath257 .",
    "taking the inner product with @xmath258 of both sides of the equation gives @xmath259 .",
    "since all @xmath260 s are positive and the @xmath261 s are assumed to be non - negative , @xmath262 for all @xmath114.@xmath222 + figure [ counter_example_diag ] shows that not all cycle orientation configurations yield bijective cycle orientation maps , so the acyclic condition is a non - trivial sufficient condition for a cycle orientation map to be bijective .",
    "+     ( top ) , and two distinct spanning trees that map to the same break divisor ( bottom).,title=\"fig:\",scaledwidth=45.0% ]   ( top ) , and two distinct spanning trees that map to the same break divisor ( bottom).,title=\"fig:\",scaledwidth=45.0% ]     ( top ) , and two distinct spanning trees that map to the same break divisor ( bottom).,title=\"fig:\",scaledwidth=45.0% ]   ( top ) , and two distinct spanning trees that map to the same break divisor ( bottom).,title=\"fig:\",scaledwidth=45.0% ]",
    "lastly , we mention two classes of objects that are indexed by the full - dimensional cones of the geometric bijection fan .",
    "the first one is a generalization of the _ cycle minimal orientations _ considered in @xcite , @xcite , @xcite . given an ordering @xmath263 of the edges of @xmath1 , together with a reference orientation , we say that an orientation @xmath119 is _ cycle minimal _ if every directed cycle is oriented according to its minimum edge . it is proven that cycle minimal orientations form a system of representatives for the cycle reversal system of @xmath1 ( * ? ? ?",
    "* theorem 3.4 ) . given a cycle orientation configuration @xmath264",
    ", we say an orientation @xmath119 is _",
    "@xmath264-faithful _ if every directed cycle of @xmath119 is oriented as in @xmath264 .",
    "note that the notion of cycle minimal orientation is saying that one is orienting each cycle according to the reference orientation of its minimal edge , and it can be seen that any such cycle orientation configuration is acyclic ( cf .",
    "theorem [ def_eom ] below ) .",
    "[ def_fo ] given an acyclic cycle orientation configuration @xmath264 , the set of @xmath264-faithful orientations form a system of representatives for the cycle reversal system of @xmath1 .",
    "proof : for uniqueness , note that any two orientations in the same cycle reversal class differ by a disjoint union of directed cycles , so they can not both be @xmath264-faithful . for existence , start with an orientation @xmath119 and reverse some directed cycle not oriented as in @xmath264 .",
    "we claim that this process will eventually stop .",
    "suppose not : since the number of orientations is finite , wlog the orientation returns to @xmath119 after flipping some directed cycles @xmath265 in that order ( the cycles might not be distinct ) .",
    "since each @xmath266 is of the opposite orientation as in @xmath264 , we have @xmath267 , contradicting the acyclicity of @xmath264 . @xmath222 + * remark . * an alternative proof of proposition [ def_fo ] can be obtained from the discussion below , using the unique remainder property of division by a grbner basis , cf .",
    "* section 4 ) .",
    "+ the second class of objects indexed by the full - dimensional cones of the geometric bijection fan is the set of monomial initial ideals of the lawrence ideal @xmath268 associated to the cycle lattice @xmath74 of @xmath1 .",
    "this ideal is also the ideal of the classical quasisymmetry model in statistics @xcite .",
    "formally , @xmath269 $ ] is generated by binomials @xmath270 for @xmath271 , where @xmath272 .",
    "it is known that @xmath273 is a ( minimal ) universal grbner basis of @xmath268 ( * ? ? ?",
    "* lemma 3.1 ) , ( * ? ? ?",
    "* proposition 7.8 ) , so a generic term order on @xmath268 essentially picks an orientation for each cycle of @xmath1 and gives a cycle orientation configuration .",
    "it can be proven that a cycle orientation configuration can be constructed this way if and only if it is acyclic @xcite , so there is a bijection between the full - dimensional cones of the geometric bijection fan and those of the grbner fan of @xmath268 ( resp .",
    "the monomial initial ideals of @xmath268 ) .",
    "geometrically , this says that the geometric bijection fan is the grbner fan of @xmath268 after quotienting by a @xmath274-dimensional lineality space",
    ". + * remark . *",
    "the above two classes of objects have dual versions in which we replace `` cycles '' with `` cocycles '' , and our results have corresponding dual counterparts .",
    "in particular , given an acyclic cycle orientation configuration @xmath264 and an acyclic cocycle orientation @xmath275 , one can define @xmath276-faithful orientations , generalizing backman s cycle - cocycle minimal orientations .",
    "in general it is not easy to decide whether a vector in @xmath65 is generic , nor whether a cycle orientation configuration is geometric . but by finding vectors that satisfy some stronger `` genericity '' conditions , we have a surprisingly simple family of generic vectors / cycle orientation configurations .",
    "[ def_eom ] let @xmath156 be an arbitrary forest of @xmath1 , orient and order the @xmath277 edges not in @xmath156 as @xmath278 . for each cycle @xmath210 of the graph , orient @xmath210 according to the smallest edge among @xmath279 that is contained in @xmath210 .",
    "then the resulting cycle orientation configuration is geometric .",
    "proof : define the weight @xmath280 for each edge @xmath53 .",
    "any ( non - empty ) signed subset sum of @xmath226 s is non - zero , so _ a priori _ the signed sum over any cycle is non - zero ( note that every cycle contains at least one @xmath53 ) .",
    "moreover , the sign of a sum depends solely on the sign of the largest @xmath226 appear in the sum , so it suffices to orient @xmath210 according to the smallest edge to guarantee that the signed sum is positive.@xmath222 + we call such bijections _ edge ordering maps / bijections_. as explained in section [ sec : fan ] , each edge ordering map corresponds to the cone in the geometric bijection fan containing the vector @xmath281 in its relative interior .",
    "+ assuming the initial data from theorem [ def_eom ] are given , a pseudocode for edge ordering map is given below .    set @xmath282 .",
    "output @xmath12 .",
    "[ edgeorderingmap ]      in this section , we give a combinatorial inverse algorithm for algorithm [ edgeorderingmap ] , thereby providing a combinatorial proof that the map given by algorithm [ edgeorderingmap ] is indeed a bijection . + throughout the algorithm , we assume the following global data as in the previous section : choose any arbitrary forest and let @xmath283 be a fixed orientation and ordering of the edges not in the forest .",
    "the subroutine @xmath284 is the algorithm by backman @xcite which , given a break divisor @xmath12 on a graph @xmath285 and a vertex @xmath78 , outputs an orientation @xmath119 such that @xmath136",
    ". +    output @xmath44 .",
    "[ inverse_eom ]    algorithm [ inverse_eom ] always terminates and it is the inverse of algorithm [ edgeorderingmap ] .",
    "proof : we shall first prove every recursive step is valid , then show the output is correct by induction . + in the case of @xmath286 , @xmath285 must be a tree and the program output is obviously correct .",
    "+ in the case of @xmath287 , we may assume wlog that @xmath53 is oriented from @xmath207 to @xmath14 in @xmath119 .",
    "indeed , if this is not the case , since @xmath14 is reachable from @xmath207 in @xmath119 , there exists a directed path @xmath203 from @xmath207 to @xmath14 , and @xmath288 is a directed cycle in @xmath119 .",
    "perform cycle reversal to get a new orientation @xmath127 with @xmath289 .",
    "now @xmath290 is a @xmath14-connected orientation of @xmath291 , so @xmath292 is a break divisor of @xmath291 . letting @xmath293 , by induction",
    "the break divisor obtained from @xmath44 in @xmath291 using algorithm [ edgeorderingmap ] is @xmath294 .",
    "consider the fundamental cycle @xmath210 in @xmath72 .",
    "since @xmath53 is the smallest edge in @xmath210 by the choice of @xmath114 , @xmath53 will be oriented according to its reference orientation , and a chip will be placed at @xmath14 , hence the break divisor obtained from @xmath44 in @xmath285 using algorithm [ edgeorderingmap ] is @xmath12 .",
    "+ in the last case with @xmath295 , every edge between @xmath296 and @xmath297 goes from @xmath297 to @xmath296 in @xmath119 by the construction of @xmath296 .",
    "therefore @xmath119 restricted to @xmath298 $ ] , say @xmath299 , is @xmath14-connected , hence @xmath300 is a break divisor of @xmath298 $ ] . on the other hand , @xmath119 restricted to @xmath301 $ ] , say @xmath302 , is @xmath207-connected , and we have @xmath303 ( the divisor @xmath304 is being modified by a for - loop in the algorithm after being defined as @xmath12 restricted to @xmath296 , and we are referring to its value after modification here ) , so @xmath304 is a break divisor of @xmath301 $ ] .",
    "let @xmath305,d_l)\\cup{\\rm inverse}(h[u^{c}],d_r)$ ] and consider the outputted divisor if @xmath44 is inputted to algorithm [ edgeorderingmap ] to @xmath44 .",
    "the non - tree edges in @xmath301,h[u^c]$ ] will produce @xmath306 , respectively , by induction ( again , @xmath304 here is the after - modification version ) .",
    "for every non - tree edge @xmath46 between @xmath307 , the fundamental cycle of @xmath308 contains @xmath53 so @xmath46 will be oriented from @xmath297 to @xmath296 , and these edges contribute to the removed chips in the for - loop of algorithm [ inverse_eom ] , hence the outputted divisor is @xmath12 .",
    "@xmath222 + a simple analysis shows the above inverse algorithm runs in @xmath309 time where @xmath310 is the complexity of network flow algorithm one uses in the implementation ( any exact algorithm for unit capacity directed graphs suffices , say the @xmath311 algorithm by madry @xcite ) .",
    "we give a brief explanation here : the @xmath312 term comes from the program calls involving the first case of the algorithm , as each instance takes @xmath313 time and any two such @xmath285 s are disjoint .",
    "the @xmath277 term comes from the number of program calls involving the last two cases , as each such program call uses a different smallest edge @xmath53 .",
    "the @xmath310 term comes from the complexity to solve such an instance , as divisortoorientation takes @xmath314 time ; this is the bottleneck of the algorithm . +",
    "as an application of our algorithm , one can use it to design a polynomial time sampling algorithm for sampling random spanning trees uniformly exactly , using information theoretically minimal random bits .",
    "the idea is that one can generate a random element of @xmath5 in polynomial time using only @xmath315 random bits , and using backman s algorithm @xcite one can find the break divisor in the random divisor class of @xmath5 . finally , using our inverse algorithm",
    ", one can output a random spanning tree of @xmath1 .",
    "see the paper by baker and shokrieh @xcite for further discussion of this paradigm and see @xcite for applications of random spanning tree sampling algorithms .",
    "one difference between the present approach and baker - shokrieh s approach is our algorithm is more matroidal , in the sense that our approach can be thought of handling cycle - cocycle reversal classes rather than break divisors , and the concept of cycle - cocycle reversal system extends to regular matroids @xcite .",
    "in this section we prove that every bernardi bijection on a plane graph is a geometric bijection .",
    "we adopt the convention that the ribbon structures on plane graphs are induced by the counter - clockwise orientation of the plane .",
    "[ plane_bp_as_om ] let @xmath1 be a planar ribbon graph .",
    "then every bernardi process on @xmath1 is a cycle orientation map .",
    "more explicitly , if the bernardi process starts with the pair @xmath316 , then the cycles are oriented as follows : if @xmath48 is outside @xmath210 , orient @xmath210 clockwise ; if @xmath48 is inside @xmath210 , orient @xmath210 counter - clockwise ; if @xmath48 is on @xmath210 , orient @xmath210 as the opposite of @xmath317 .",
    "proof : let @xmath318 be a cycle with vertices indexed in counter - clockwise order , and let @xmath44 be a spanning tree for which @xmath210 is a fundamental cycle .",
    "wlog @xmath44 is missing the edge @xmath319 from @xmath210 .",
    "suppose @xmath48 is outside @xmath210 .",
    "the intuition is that the bernardi tour starting from @xmath48 , when restricted to @xmath210 , traverses the `` outside '' of @xmath210 in a counter - clockwise manner before going to the `` inside '' of @xmath210 by cutting through @xmath320 , see figure [ bernardi_om_diag ] for illustration .",
    "+ let @xmath321 be the unique vertex for which there is a path @xmath203 from @xmath322 to @xmath323 in @xmath44 that does not involve other vertices of @xmath210",
    ". then @xmath323 will be the first vertex on @xmath210 visited by the tour .",
    "denote by @xmath324 the subtree of @xmath44 consisting of the component of @xmath325 containing @xmath322 and @xmath326 ( it might happen that @xmath327 or @xmath328 , but @xmath324 remains well - defined ) together with @xmath323 .",
    "if @xmath329 , set @xmath330 to be the last edge of @xmath203 , otherwise set @xmath331 and @xmath332 ; in counter - clockwise order label the edges incident to @xmath323 as @xmath333 .",
    "+ if @xmath329 or @xmath334 , then the bernardi tour starting with @xmath335 will traverse ( part of ) @xmath324 and reach the state @xmath336 without using any edge on or inside @xmath210 , and the tour will move to the state @xmath337 next . similarly ,",
    "if @xmath338 , then the tour will move to @xmath337 in next step immediately . with a sequence of similar arguments , we can see that the tour will visit the states @xmath339 in order without visiting edges inside @xmath210 . if @xmath340 ( thus @xmath341 ) then a chip will be placed at @xmath342 , which corresponds to orienting @xmath210 clockwise .",
    "otherwise the tour will visit the state @xmath343 , where @xmath46 is the next edge after @xmath344 in the counter - clockwise order around @xmath345 , and @xmath46 is either outside @xmath210 or is the edge @xmath346 . by repeating similar arguments",
    ", we can see that the tour will visit @xmath347 in order without visiting edges inside @xmath210 , hence the tour will put a chip at @xmath342 and orient @xmath210 clockwise .",
    "+ the analysis of the remaining cases are similar .",
    "the case where the starting pair is @xmath348 for some @xmath114 is included in the above , and the other two cases are essentially the `` opposite '' of the considered cases.@xmath222 +    .,scaledwidth=80.0% ]    one immediate observation is that a more `` correct '' way to index bernardi processes / bijections on a plane graph is by faces rather than by edges .",
    "[ face_bp_bijection ] for every bernardi bijection @xmath349 , there exists a face @xmath156 such that the cycle orientation configuration of @xmath350 orients a cycle counter - clockwise if and only if @xmath156 is in the interior of the cycle .",
    "conversely every face corresponds to some bernardi bijection in this way .",
    "proof : pick a point @xmath351 on @xmath48 , not equal to @xmath352 or @xmath41 , and rotate @xmath351 around @xmath41 in a clockwise direction by a small amount , in the sense that @xmath351 does not pass through any other edges in the process , to get a new point @xmath353 .",
    "it is easy to see from the description in theorem [ plane_bp_as_om ] that a cycle is oriented counter - clockwise if and only if @xmath353 is in its interior , but the role of @xmath353 can be replaced by the unique face @xmath354 containing @xmath353 . finally , for every face @xmath156 of @xmath1 , if we choose an edge @xmath355 on the boundary of @xmath156 , then either @xmath356 or @xmath354 will be @xmath156.@xmath222 + for each face @xmath156 of a plane graph @xmath1 , denote by @xmath357 the cycle orientation map coming from the cycle orientation configuration in corollary [ face_bp_bijection ] , so that every bernardi bijection on @xmath1 is @xmath357 for some face @xmath156 and vice - versa .",
    "+ we give two proofs for the following theorem , which is our main result in this section .",
    "the first proof checks the acyclic condition in theorem [ generic_lp_criterion ] directly , while the less straightforward second proof shows that a bernardi bijection is actually an edge ordering map .",
    "[ plane_bp_are_geom ] let @xmath1 be a planar ribbon graph .",
    "then every bernardi bijection on @xmath1 is a geometric cycle orientation map .",
    "first proof : let @xmath357 be a bernardi bijection on @xmath1 .",
    "wlog @xmath156 is the unique unbounded face of @xmath1 , so every cycle is oriented clockwise ( one can always lift @xmath1 to a sphere and project back down , making @xmath156 the unbounded face , the orientation of cycles changes accordingly . )",
    "suppose there exists some relation of cycles @xmath358 where @xmath359 . for simplicity",
    "we pass to the subgraph @xmath360 of @xmath1 and let @xmath48 be an edge incident to the unbounded face of @xmath211 . by construction , some @xmath266 contains @xmath48 .",
    "every cycle @xmath266 that contains @xmath48 orients @xmath48 in the same way , so no cancellation of @xmath48 can happen in the sum @xmath361 , a contradiction.@xmath222 + second proof : consider algorithm [ maptoorder ] ( the algorithm always terminates , as in any step one can find suitable @xmath53 and orient it . )",
    "let @xmath210 be an arbitrary cycle in @xmath1 , and let @xmath53 be the smallest edge @xmath210 contains .",
    "then @xmath362 and @xmath53 is not a cut edge of @xmath363 . by construction , @xmath53 is incident to the unbounded face of @xmath363 and inherits its orientation from a clockwise - oriented @xmath266 , so orienting @xmath210 according to @xmath53 will make @xmath210 clockwise as well .",
    "therefore the output of algorithm [ maptoorder ] will orient every cycle clockwise .",
    "this is the cycle orientation configuration for @xmath357 , where @xmath156 is the unbounded face .",
    "( the algorithm can be easily modified to produce edge ordering of any other @xmath357 . ) we know by theorem [ def_eom ] that every edge ordering map is geometric .",
    "@xmath222 +    set @xmath364 .",
    "+ output @xmath263 and their orientations .",
    "[ maptoorder ]    with a closer look at the second proof , we obtain a stronger assertion about planar bernardi bijections .",
    "[ bp_as_eom ] let @xmath1 be a planar ribbon graph .",
    "then every bernardi bijection on @xmath1 is an edge ordering map .",
    "moreover , if @xmath365 are two bernardi bijections corresponding to adjacent faces @xmath366 of @xmath1 , then the data describing the two edge ordering maps can be chosen so that they are the same except the orientation of the first edge @xmath367 , and @xmath367 can further be chosen to be a common edge of @xmath366 .",
    "proof : the first part follows from the second proof of theorem [ plane_bp_are_geom ] . for the second part , algorithm [ maptoorder ] can choose the same edge as @xmath367 for both maps , namely the common edge of @xmath366 , but with the opposite orientation .",
    "once @xmath367 is removed , the two cases are the same as @xmath156 and @xmath368 become the same face of @xmath369.@xmath222 +      baker and wang proved several propositions about bernardi torsors of planar graphs in their paper @xcite .",
    "( they also use the convention that the ribbon structures on planar duals are induced by the clockwise orientation of the plane . )    ( ( * ? ? ?",
    "* theorem 5.1 ) ) [ bw_isom ] let @xmath1 be a planar ribbon graph",
    ". then all bernardi torsors are isomorphic .",
    "( ( * ? ? ?",
    "* theorem 6.1 ) ) [ bw_dual ] let @xmath1 be a bridgeless planar ribbon graph , and let @xmath370 be some bernardi bijections on @xmath1 and @xmath158 , respectively",
    ". then the following diagram is commutative : @xmath371    ( ( * ? ? ?",
    "* theorem 7.1 ) ) [ bw_rotor ] let @xmath1 be a planar ribbon graph .",
    "then the bernardi and rotor - routing processes define the same @xmath34-torsor structure on @xmath43 .",
    "we give new proofs to the first two propositions using our language of cycle orientation maps and edge ordering maps .",
    "the new proofs are more concise and produce more precise versions of statements . combined with theorem [ bw_rotor ] ,",
    "our arguments give a new proofthat torsors induced by rotor - routing on planar graphs are isomorphic and respect plane duality .",
    "[ eom_torsor ] let @xmath372 be edge ordering maps with data @xmath278 and @xmath373 respectively , where @xmath374 denotes a reversed @xmath367 .",
    "then the two bijections give isomorphic torsors , with translating element @xmath375\\in { \\operatorname{pic}}^0(g)$ ] .",
    "proof : given a spanning tree @xmath44 , we compute @xmath376 .",
    "say @xmath377 .",
    "if @xmath378 , then the only edge that changes orientation is @xmath367 so the difference is @xmath379 .",
    "otherwise @xmath334 and let @xmath380 $ ] be the fundamental cut of @xmath367 with @xmath381 .",
    "an edge changes orientation if and only if its fundamental cycle contains @xmath367 , if and only if it is in @xmath382 .",
    "edges in @xmath383 orient from @xmath384 to @xmath385 in the first edge ordering map and from @xmath385 to @xmath384 in the second map , so the difference is @xmath386 , which is equal to @xmath387 in @xmath34.@xmath222    ( more precise version of theorem [ bw_isom ] ) let @xmath1 be a planar ribbon graph",
    ". then all bernardi torsors are isomorphic .",
    "more precisely , suppose two bijections correspond to the two faces @xmath366 of @xmath1 , and let @xmath388 be a trail in @xmath158 .",
    "then the translating element between two torsors is @xmath389 ( with a suitable orientation of the @xmath219 s . )",
    "proof : this follows easily by repeatedly applying theorem [ eom_torsor ] to corollary [ bp_as_eom ] .",
    "@xmath222    [ dual_orient ] let @xmath1 be a bridgeless planar ribbon graph and let @xmath158 be a planar dual of @xmath1 .",
    "let @xmath390 be the bernardi bijection on @xmath158 corresponding to dual face @xmath391 .",
    "then for any spanning tree @xmath44 of @xmath1 and @xmath392 , @xmath390 orients @xmath159 the same way as orienting @xmath48 away from @xmath41 in @xmath44 , where we use the canonical identification of edge orientations in @xmath1 and @xmath158 .",
    "proof : wlog @xmath391 is the unbounded face of @xmath158 .",
    "let @xmath393 be the fundamental cycle of @xmath159 with respect to @xmath394 . on one hand , by theorem [ plane_bp_as_om ]",
    "@xmath393 is oriented clockwise and @xmath159 will be oriented according to this orientation of @xmath393 by @xmath390 . on the other hand , @xmath393 bounds a region that does not contain @xmath391 , so orienting @xmath48 away from @xmath41 means orienting @xmath48 to go into the bounded region . hence the two methods give the same orientation to @xmath48 and @xmath159 using the canonical orientation identification.@xmath222    ( stronger version of theorem [ bw_dual ] , cf .",
    "the last sentence of section [ sec : intro_duality ] ) let @xmath1 be a bridgeless planar ribbon graph and let @xmath158 be a planar dual of @xmath1 .",
    "let @xmath395 be bernardi bijections of @xmath396 correspond to a face @xmath156 and a dual face @xmath391 , respectively .",
    "then the torsors induced by @xmath357 and @xmath397 are compatible with plane duality .",
    "more precisely , the following diagram commutes : @xmath398    proof : the diagram says that for every spanning tree @xmath44 of @xmath1 , @xmath399 we claim that the orientation class @xmath400 contains the orientation @xmath119 , which is obtained by orienting edges in @xmath394 ( identified as edges in @xmath1 ) using @xmath401 and edges in @xmath44 using @xmath397 ( @xmath397 orients edges outside @xmath394 in @xmath158 , which can be identified as edges in @xmath44 ) . to see this note first that if @xmath1 is partially oriented using @xmath357 , then @xmath397 orients edges in @xmath44 away from @xmath41 by lemma [ dual_orient ] , which gives an extra out - going edge for every vertex of @xmath1 except @xmath41 , thus @xmath402)=[\\beta_{f}(t)-(v)]$ ] .",
    "dually @xmath403 contains the orientation @xmath165 , which is obtained by orienting edges in @xmath44 using @xmath397 and edges in @xmath394 using @xmath401 . now",
    "visibly @xmath404=\\sigma_o([{{\\mathcal o}}])$ ] , as @xmath405 are produced from essentially the same procedure.@xmath222      based on the new results and proofs of the last two sections , one might ask whether bernardi bijections on non - planar ribbon graphs are also geometric , or at least whether they are cycle orientation maps .",
    "one could also ask the opposite question , whether planarity is a necessary condition for a bernardi bijection to be geometric . in this section , we show that both assertions are incorrect , but the truth is closer to the latter .",
    "+ first we characterize non - planar ribbon graphs by forbidden subdivisions .",
    "we say a ribbon graph @xmath406 is a _ subdivision _ of the ribbon graph @xmath285 if one can get @xmath406 from @xmath285 by inserting degree 2 vertices ( equipped with the unique cyclic ordering on two edges ) inside the edges of @xmath285 , keeping the cyclic orderings of edges around the original vertices the same .",
    "also we say a ribbon graph @xmath285 is a _",
    "subgraph _ of a ribbon graph @xmath1 if graph - theoretically @xmath285 is a subgraph of @xmath1 and the cyclic ordering of edges around each vertex of @xmath285 is inherited from the cyclic ordering of @xmath1 in the natural way .",
    "finally we say that a ribbon graph @xmath1 contains a ribbon graph @xmath285 as a subdivision if @xmath406 is a subgraph of @xmath1 for some subdivision @xmath406 of @xmath285 .",
    "the first basic non - planar ribbon graph ( bng i ) is a ribbon graph on two vertices @xmath407 and three edges @xmath408 so that the cyclic order of the edges around each vertex is @xmath408 .",
    "the second basic non - planar ribbon graph ( bng ii ) is a ribbon graph on three vertices @xmath409 , two edges @xmath410 between @xmath411 and two edges @xmath412 between @xmath413 , where the cyclic order of the edges around @xmath414 is @xmath415 .",
    "the next proposition is known within the communities working on structural or topological graph theory .",
    "but we could not find an explicit reference in literature so we include a brief proof here .",
    "every non - planar ribbon graph contains at least one of the bngs as a subdivision .",
    "proof : we will demonstrate a way to either find a planar embedding of the ribbon graph @xmath1 , or find a bng as a subdivision in @xmath1 .",
    "first we assume @xmath1 is 2-connected , and we apply induction via an ear decomposition ( cf .",
    "* proposition 3.1.3 ) ) .",
    "the base case is a cycle and is trivial .",
    "suppose a subgraph @xmath416 is embedded in the plane , and let @xmath417 be an ear to be added .",
    "say in @xmath418 the cyclic ordering of edges around @xmath419 includes @xmath420 consecutively , then some cycle @xmath210 containing @xmath421 bounds a face @xmath156 of @xmath211 that @xmath367 is to be embedded in ; similarly there is a face @xmath368 of @xmath211 that @xmath422 is to be embedded in .",
    "if @xmath423 then we are done , otherwise if we let @xmath424 be a shortest path ( possibly trivial ) going from @xmath425 to any vertex @xmath426 on @xmath210 then @xmath427 will be a subdivision of bng i. + for the general case , we induct on the number of blocks . let @xmath41 be a cut vertex and let @xmath428 be subgraphs corresponding to the components of @xmath429 , where @xmath44 is the block decomposition tree of @xmath1 ( cf .",
    "* proposition 3.1.2 ) ) . by induction , each @xmath363 can be embedded in the plane , and we may further assume that @xmath41 is on the boundary of the unbounded face of each embedding if needed . if there exist some interlacing edges @xmath430 in the cyclic order with @xmath431 and @xmath432 , then letting @xmath433 be cycles containing @xmath421 and @xmath434 , respectively .",
    "we have @xmath435 as a subdivision of bng ii in @xmath1 .",
    "otherwise , it can be seen that for all blocks @xmath363 s except possibly one block ( say @xmath436 ) , all edges in @xmath363 incident to @xmath41 are in some interval @xmath437 of the cyclic ordering around @xmath41 , so we can embed @xmath436 in the plane then embed other blocks one by one according to the cyclic order of @xmath437 s .",
    "@xmath222 + our partial converse shows that the property `` every bernardi process is geometric '' is in some sense a property of @xmath1 as a geometric object , as passing to subdivision does not change the embedding properties of @xmath1 on surfaces , nor does it change the tropical jacobian if we keep track of the metric information when we are subdividing edges .",
    "[ non_planar_bp ] let @xmath1 be a non - planar ribbon graph .",
    "then there exists some subdivision @xmath211 of @xmath1 such that some bernardi bijection on @xmath211 is not a cycle orientation map , thereby not geometric .",
    "in particular , @xmath211 can be chosen to have at most 2 more vertices than @xmath1 .",
    "proof : first we study the case where @xmath1 is bng i. insert vertices @xmath438 inside @xmath439 , respectively , and subdivide @xmath439 into @xmath440 and @xmath441 respectively .",
    "start the bernardi process from @xmath442 , and consider the spanning trees @xmath443 and @xmath444 .",
    "a routine calculation shows that @xmath445 and @xmath446 .",
    "+ for the general case , suppose @xmath1 contains @xmath447 as a subdivision of bng i , where @xmath448 are three internally disjoint paths sharing two common endpoints @xmath407 . insert a vertex @xmath352 inside @xmath449 in such a way that there are no other vertices from @xmath450 to @xmath352 in @xmath449 . name the two new edges incident to @xmath352 as @xmath451 .",
    "similarly , insert a vertex @xmath452 inside @xmath453 in a way that there are no other vertices from @xmath454 to @xmath452 in @xmath453 .",
    "name the two new edges incident to @xmath452 as @xmath455 .",
    "extend the acyclic subgraph @xmath456 to a spanning tree @xmath457 of @xmath1 , and set @xmath458 .",
    "consider the bernardi tours of @xmath459 starting from @xmath442 .",
    "these two tours restricted to @xmath447 are the same as the tours of @xmath460 starting from @xmath442 .",
    "since @xmath452 is only incident to @xmath461 in @xmath1 , the bernardi process on @xmath1 will place exactly one chip at @xmath452 in the @xmath457 case while no chip will be placed at @xmath452 in the @xmath462 case .",
    "+ if the bernardi bijection was a cycle orientation map , the tour of @xmath457 implies that the cycle @xmath463 must be oriented as @xmath464 in order to put a chip at @xmath452 , but in @xmath462 the fundamental cycle of @xmath465 is also @xmath210 , a contradiction as no chip was placed at @xmath452 .",
    "+ the case for bng ii is similar : for a subdivision @xmath435 of bng ii in @xmath1 where @xmath466 are cycles that are disjoint except at @xmath414 , insert vertices @xmath438 near @xmath414 inside @xmath466 , respectively , and do the same type of analysis.@xmath222 + * remark .",
    "* we can actually show that adding just one more vertex , namely `` @xmath352 '' , suffices .",
    "the idea is to show that either `` @xmath450 '' or `` @xmath414 '' of some carefully chosen bng subdivision is sufficient to `` witness '' that the bernardi process can not produce consistent cycle orientation ( as @xmath452 does in the above proof . )",
    "but the proof is more tedious without making the conclusion conceptually more interesting , so we omit the details here .",
    "+ we end this section by noting that it can be checked that all bernardi bijections on bng i are geometric , so working with subdivisions is indeed necessary in theorem [ non_planar_bp ] .",
    "we started with a geometric object rooted in tropical geometry and discovered several classes of bijections between spanning trees and other combinatorial objects which have nice combinatorial and algorithmic properties .",
    "the new bijections have surprising connections to other bijections defined in quite different ways .",
    "we conclude with a few open questions .",
    "+ to motivate some of the following questions we list several observations about the polyhedral decomposition without proof .",
    "[ gb_torsor ] let @xmath372 be edge ordering maps with data @xmath278 and @xmath373 respectively .",
    "let @xmath466 be the cone in the geometric bijection fan corresponding to @xmath467 .",
    "then @xmath468 intersects the antipodal cone of @xmath210 by some positive dimensional face , which contains the ray spanned by @xmath469 .    when do two geometric bijections give isomorphic torsors ?",
    "is it true that for any full - dimensional cone @xmath210 of the geometric bijection fan , there exists some cone adjacent to the antipodal cone of @xmath210 that gives an isomorphic torsor ?      can one describes a `` geometric bijection '' between the @xmath114-dimensional faces and the @xmath471-dimensional faces of the polyhedral decomposition , or at least give a high level explanation for the equality of cardinalities ?",
    "( the generic shifting setup does not work in general . )"
  ],
  "abstract_text": [
    "<S> the jacobian group @xmath0 of a finite graph @xmath1 is a group whose cardinality is the number of spanning trees of @xmath1 . </S>",
    "<S> @xmath1 also has a tropical jacobian which has the structure of a real torus ; using the notion of break divisors , an et al . </S>",
    "<S> @xcite obtained a polyhedral decomposition of the tropical jacobian where vertices and cells correspond to elements of @xmath0 and spanning trees of @xmath1 , respectively . </S>",
    "<S> we give a combinatorial description of bijections coming from this geometric setting . </S>",
    "<S> this provides a new geometric method for constructing bijections in combinatorics . </S>",
    "<S> we introduce a special class of geometric bijections that we call edge ordering maps , which have good algorithmic properties . </S>",
    "<S> finally , we study the connection between our geometric bijections and the class of bijections introduced by bernardi @xcite ; in particular we prove a conjecture of baker that planar bernardi bijections are `` geometric '' . </S>",
    "<S> we also give sharpened versions of results by baker and wang @xcite on bernardi torsors . </S>"
  ]
}