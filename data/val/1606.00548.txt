{
  "article_text": [
    "nowadays , large - scale reservoir simulations are becoming more and more popular in the oil and gas industry in order to simulate complex geological models .",
    "however , when a model is large enough , a simulator may take days or even weeks to finish one run using regular workstations and personal computers . this problem can also be observed in black oil , compositional and thermal simulations .",
    "efficient computational methods and fast reservoir simulators should be investigated .",
    "reservoir simulations have been studied for decades and various models and methods have been developed .",
    "coats studied black oil , compositional and thermal models , and he also investigated numerical methods , linear solver , preconditioner , grid effects and stability issues in his publications @xcite .",
    "kaarstad et al .",
    "@xcite implemented a parallel two - dimensional two - phase oil - water simulator , which could solve problems with millions of grid cells .",
    "rutledge et al .",
    "@xcite implemented a compositional simulator for parallel computers using the impes ( implicit pressure - explicit saturation ) method .",
    "shiralkar et al .",
    "@xcite developed a portable parallel production qualified simulator , which could run on a variety of parallel systems .",
    "killough et al .",
    "@xcite studied locally refined grids in their parallel simulator .",
    "dogru et al .",
    "@xcite developed a parallel black oil simulator , which was highly efficient and was capable of simulating models with up to one billion cells .",
    "zhang et al . developed a scalable general - purpose platform to support adaptive finite element and adaptive finite volume methods , which was also applied to reservoir simulations using discontineous galerkin method @xcite .",
    "for many reservoir simulations , most of the running time is spent on the solution of linear systems .",
    "we know that the most important is to develop efficient preconditioners .",
    "many preconditioners have been proposed , such as constrained pressure residual ( cpr ) methods @xcite , multi - stage methods @xcite , multiple level preconditioners @xcite and fast auxiliary space preconditioners ( fasp ) @xcite .",
    "chen et al . studied parallel reservoir simulations and developed a family of cpr - like preconditioners for black oil simulations and compositional simulations , including cpr - fp , cpr - fpf and cpr - ffpf methods @xcite .",
    "a black oil simulator has been developed based on our in - house parallel platform .",
    "the black oil model has three mass conservation equations for three components ( water , gas and oil ) .",
    "the system is fully coupled nonlinear system , which is solved by inexact newton - raphson methods , and structured grids and finite difference methods are applied .",
    "the performance of the black oil simulator is studied on ibm blue gene / q system using large - scale reservoir models for standard black oil model and two - phase oil - water model .",
    "numerical experiments show that our simulator is scalable and it is capable of simulating models with hundreds of millions of grid cells .",
    "the black oil model and its simplified model , two - phase oil - water model , are briefly introduced here .",
    "the black oil model has three phases ( water , oil and gas ) , and three components .",
    "the model assumes that there is no mass transfer between water phase and the other two phases , and gas component can exist in gas and oil phases .",
    "oil component is also assumed that it can exist in oil phase only .",
    "the reservoir is isothermal and no energy change is considered .",
    "the darcy s law is applied for black oil model , which establishes a relationship between volumetric flow rates of three components and their pressure changes in a reservoir , which is described as : @xmath0 where @xmath1 is the absolute permeability of rock , @xmath2 is a cross - section area , @xmath3 is the pressure difference , @xmath4 is viscosity of fluid , and @xmath5 is the length of a porous medium . in three - dimensional space ,",
    "the differential form of darcy s law is : @xmath6    by combining darcy s law , black oil model has the following mass conservation equations for each component : @xmath7 where , for phase @xmath8 @xmath9 , @xmath10 is its potential , @xmath11 and @xmath12 are porosity and permeability of a resevoir , and @xmath13 , @xmath14 , @xmath15 , @xmath16 , @xmath17 and @xmath18 are its saturation , phase viscosity , phase pressure , density , relative permeability and production ( injection ) rate , respectively . @xmath19 and @xmath20 are density of the oil component in the oil phase and the density of the solution gas in the oil phase , respectively .",
    "they have the following relations : @xmath21 where @xmath22 is reservoir depth , @xmath23 is capillary pressure between water phase and oil phase , @xmath24 is pressure of phase @xmath8 , and @xmath25 is capillary between gas phase and oil phase .",
    "the properties of fluids and rock are functions of pressure and saturation .",
    "the pressures of water and gas phases are functions of oil phase pressure and saturation ; see equation .",
    "the density of water is a function of its pressure : @xmath26 and the density of the oil phase is a function of its phase pressure and the bubble point pressure : @xmath27 where @xmath28 is bubble point pressure .",
    "the bubble point pressure is the pressure at which infinitesimal gas appears . the water viscosity @xmath29 is assumed to be a constant .",
    "the oil phase viscosity is a function of its pressure @xmath30 and the bubble point pressure @xmath28 : @xmath31 the relative permeabilities @xmath32 , @xmath33 and @xmath34 are functions of water and gas saturations @xmath35 and @xmath36 : @xmath37 where @xmath33 is calculated using the stone ii formula .    for real simulations ,",
    "the relative permeabilities are given by tables or analytic formulas .",
    "other properties , such as density , viscosity and capillary pressure , have analytic formulas and they can be calculated by table input too . with proper boundary conditions and initial conditions , a close system is given .",
    "here no flow boundary condition is assumed .",
    "this model is a simplified model of the standard black oil model , which assumes that the reservoir has two phases , oil and water , and they are immiscible .",
    "the model is similar to black oil model , which is written as @xcite : @xmath38      different well constraints can be set for each active well .",
    "one commonly - used method is a sink - source model . for each perforation block @xmath39 , its well rate ( production or injection ) @xmath40",
    "is calculated by : @xmath41 where @xmath42 is bottom hole pressure of a well , @xmath43 is its well index , @xmath44 is reference depth of bottom hole pressure , @xmath22 is depth of the perforated grid block @xmath39 , and @xmath24 is phase pressure of the perforated grid block , such as oil , gas and water .",
    "@xmath43 can be calculated by several different models . in our simulator ,",
    "a peaceman model @xcite is chosen .",
    "many operation constraints and their combinations may be applied to each well at different time stages , such as a fixed bottom hole pressure constraint , a fixed oil rate constraint , a fixed water rate constraint , a fixed liquid rate constraint and a fixed gas rate constraint . when the fixed bottom hole pressure condition is applied to some well , its bottom hole pressure , @xmath42 , is known and its well rate @xmath45 is known if we have phase pressure of the perforated block .",
    "the constraint equation for the well is @xmath46 where @xmath47 is a constant set by the user input .",
    "no known exists for this constraint .",
    "when a fixed rate constraint is applied to a well , its bottom hole pressure is an unknown .",
    "for the fixed water rate constraint , the equation is @xmath48 where @xmath49 is constant . for the fixed oil rate constraint ,",
    "its equation is @xmath50 where @xmath51 is constant and known .",
    "a well may be applied different constraints at different time period .",
    "a schedule can be set by input , in which users can set operation changes for each well .      in this paper ,",
    "conservative finite difference schemes are employed to discretize these models .",
    "the inexact newton method is employed to solve the nonlinear equations .",
    "the time term is discretized by the backward euler difference scheme .",
    "if we let @xmath52 represent the value of a function @xmath53 at any time step @xmath54 , then its derivative at time step @xmath55 is approximated by @xmath56    the space terms are discretized by cell - centered finite difference method @xcite . here",
    "if we assume @xmath57 is a space direction and @xmath2 is the area of the corresponding face of a grid cell , the transmissibility term @xmath58 can be written as : @xmath59      the nonlinear system can be represented by @xmath60 where @xmath61 is unknown vector , including oil phase pressure , water saturation and well bottom hole pressure .",
    "for black oil model , a gas saturation ( or bubble point pressure ) is also included .",
    "after linearization , a linear system , @xmath62 , is obtained in each newton iteration , where @xmath2 is jacobian matrix , @xmath61 is unknown to be determined , and @xmath63 is right - hand side .",
    "the standard newton method solves the linear system accurately .",
    "however , it is computationally expensive and it is not necessary sometimes . in our implementation , the inexact newton method is applied , whose algorithm is described in algorithm [ inewton - alg ] .",
    "give an initial guess @xmath64 and stopping criterion @xmath65 , let @xmath66 , and assemble right - hand side @xmath63 .",
    "assemble the jacobian matrix @xmath2 .",
    "find @xmath67 and @xmath68 such that @xmath69 let @xmath70 and @xmath71 .",
    "@xmath61 is the solution of the nonlinear system .",
    "the only difference between standard newton method and inexact newton method is how to choose @xmath67 .",
    "usually the parameter , @xmath67 , for standard newton method is fixed and small , such as @xmath72 .",
    "the parameter , @xmath67 , for inexact newton method is automatically adjusted .",
    "three different choices are listed as follows @xcite : @xmath73 where @xmath74 and @xmath75 are residual and right - hand side of @xmath76-th iteration , respectively .",
    "the residual is defined as , @xmath77      if a proper matrix ordering ( numbering of unknowns ) is applied , the matrix @xmath2 derived from each newton iteration can be written as    @xmath78    where @xmath79 is the matrix corresponding to oil phase pressure unknowns , @xmath80 is the matrix corresponding to other unknowns in each grid cell , such as water saturation , gas saturation and bubble point pressure , and @xmath81 is the matrix coefficients corresponding to well bottom hole pressure unknowns , and other matrices are coupled items .",
    "the matrix @xmath2 is hard to solve in large - scale reservoir simulations .",
    "many multi - stage preconditioners have been developed to overcome this problem , such as cpr , fasp , cpr - fp and cpr - fpf methods .",
    "the key idea is to solve a sub - problem ( @xmath79 ) using algebraic multi - grid methods ( amg ) . in this paper ,",
    "the cpr - fpf method developed by chen et al .",
    "@xcite is applied .",
    "matrix decoupling techniques are also employed , such as abf decoupling and quasi - impes decoupling .",
    "an blue gene / q from ibm is employed to run reservoir simulations .",
    "the system , wat2q , is located in the ibm thomas j. watson research center .",
    "each node has 32 computer cards ( 64-bit powerpc a2 processor ) , which has 17 cores .",
    "one of them is for the operation system and the other 16 cores for computation .",
    "the system has 32,768 cpu cores for computation .",
    "the performance of each core is really low compared with intel processors .",
    "however , the system has strong network relative to cpu performance , and the system is scalable .",
    "the spe10 model is described on a regular cartesian grid , whose dimensions are @xmath82 ( ft ) @xcite .",
    "the model has @xmath83 cells ( @xmath84 cells ) .",
    "it has one injection well and four production wells .",
    "the original model is designed for two - phase oil - water model and it has around 2.244 millions of unknowns .",
    "the model is highly heterogeneous .",
    "its permeability is ranged from 6.65e-7 darcy to 20 darcy , and the x - direction permeability , @xmath85 , is shown in figure [ fig - spe10-perm ] .",
    "its porosity shown in figure [ fig - spe10-poro ] , ranges from 0 to 0.5 .",
    "data sets for porosity and permeability can be downloaded from spe10 s official website .",
    "the relative permeability of water phase is calculated by @xmath86 and the relative permeability of oil phase is calculated by @xmath87 where @xmath88 .",
    "capillary pressure is ignored .",
    "[ ex2 ] the original spe10 project is simulated .",
    "the termination tolerance for inexact newton method is @xmath89 and its maximal newton iterations are 20 . the linear solver bicgstab is applied and its maximal inner iterations are 50 .",
    "the quasi - impes decoupling strategy is used .",
    "simulation period is 2,000 days and maximal time step is 100 days .",
    "summaries of numerical results are shown in table [ tab - ex2 - 4 ] @xcite , and its scalability is shown by figure [ fig - ex2-cpr ] .",
    ".summaries of example [ ex2 ] [ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     [ tab - ex9 - 1 ]    ]    the original spe1 project is a small one with 300 grid cells ( @xmath90 ) and the project is refined to 100 millions of grid cells ( @xmath91 ) .",
    "it has a homogeneous geological model .",
    "table [ tab - ex9 - 1 ] presents numerical summaries for nonlinear method , linear solver and performance .",
    "all four simulations use around 27 time steps .",
    "the simulation with 512 mpi tasks uses 140 newton iterations , which is more than other cases due to one time step cut .",
    "the linear solver and preconditioner are robust , which can solve a linear system in a few iterations . again , running time and figure [ fig - ex9-cpr ] show our simulator has excellent scalability .",
    "parallel reservoir simulations are studied in the paper , which are based on our in - house parallel platform .",
    "the platform provides grids , data , linear solvers and preconditioners for reservoir simulators .",
    "a black oil model is implemented .",
    "numerical experiments show that our simulator has excellent scalability and simulations can be sped up thousands of times faster .",
    "the paper also demonstrates that parallel computing techniques are powerful tools for large - scale reservoir simulations and ibm blue gene / q system is scalable .",
    "the support of department of chemical and petroleum engineering , university of calgary and reservoir simulation group is gratefully acknowledged . the research is partly supported by nserc / aiee / foundation cmg and aitf chairs .",
    "hu , x. , liu , w. , qin , g. , xu , j. , zhang , z. , development of a fast auxiliary subspace pre - conditioner for numerical reservoir simulators , spe reservoir characterisation and simulation conference and exhibition . 2011 .",
    "feng , c. , shu , s. , xu , j. , and zhang , c. , a multi - stage preconditioner for the black oil model and its openmp implementation , 21st international conference on domain decomposition methods , 2012 , france .",
    "baohua wang , shuhong wu , qiaoyun li , xiaobo li , hua li , chensong zhang , jinchao xu , a multilevel preconditioner and its shared memory implementation for new generation reservoir simulator , spe-172988-ms , spe large scale computing and big data challenges in reservoir simulation conference and exhibition , 15 - 17 september , istanbul , turkey , 2014 .",
    "wang , k. , zhang , l. , and chen , z. , development of discontinuous galerkin methods and a parallel simulator for reservoir simulation , spe-176168-ms , spe / iatmi asia pacific oil & gas conference and exhibition , 20 - 22 october , nusa dua , bali , indonesia , 2015 ."
  ],
  "abstract_text": [
    "<S> this paper presents our work on simulation of large - scale reservoir models on ibm blue gene / q and studying the scalability of our parallel reservoir simulators . </S>",
    "<S> an in - house black oil simulator has been implemented . </S>",
    "<S> it uses mpi for communication and is capable of simulating reservoir models with hundreds of millions of grid cells . </S>",
    "<S> benchmarks show that our parallel simulator are thousands of times faster than sequential simulators that designed for workstations and personal computers , and the simulator has excellent scalability .    </S>",
    "<S> -scale reservoir , simulation , blue gene / q , parallel computing </S>"
  ]
}