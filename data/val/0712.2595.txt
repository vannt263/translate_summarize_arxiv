{
  "article_text": [
    "much of the difficulty in implementing quantum algorithms in practice is that qubits quickly decohere upon interacting with the environment .",
    "this entanglement destroying process limits the length of the computations that can be realized by experiment .",
    "implementing quantum algorithms as circuits of low depth can provide a way to perform as much computation as possible within the limited time available , and for this reason there is significant interest in finding short quantum circuits for important problems .",
    "log - depth quantum circuits have been found for several significant problems including the approximate quantum fourier transform  @xcite and the encoding and decoding operations for many quantum error correcting codes  @xcite .",
    "in addition to these applications , a procedure for parallelizing to log - depth a large class of quantum circuits has recently been discovered  @xcite .",
    "these examples demonstrate the surprising power of short quantum circuits .",
    "much of the work on quantum circuits is done in the standard model of unitary quantum circuits on pure states . in this paper a slightly different model of computation",
    "is considered : the model of mixed state quantum circuits , introduced by aharonov , kitaev , and nisan  @xcite .",
    "while much of the previous complexity - theoretic work on short quantum circuits has been in the unitary model  @xcite , there has also been work outside of this model  @xcite .",
    "there are several advantages to considering the more general model of mixed state circuits .",
    "the primary advantage is that the mixed state model is able to capture any process allowed by quantum mechanics , so that results on this model may have implications for experimental work in quantum computing .",
    "the problem of distinguishing circuits may thus be thought of as the problem of distinguishing potentially noisy physical processes . as an example , finding an error in an implementation of a quantum algorithm is simply the problem of distinguishing the constructed circuit from one that is known to be correct .",
    "unfortunately , in this paper it is shown that the apparent power of short quantum computations comes with a price : logarithmic depth quantum circuits are _ exactly _ as difficult to distinguish as polynomial depth quantum circuits .",
    "this equivalence implies the surprising result that distinguishing log - depth quantum computations is complete for the class , the set of all problems that have quantum interactive proof systems . as @xmath0  @xcite",
    ", this result also implies that the problem is -hard .    the result on circuit distinguishability",
    "is shown using the closely related problem of determining if two circuits can be made to output states that are close together .",
    "this problem was introduced by kitaev and watrous  @xcite who show it to be both complete for and contained in .",
    "the main result of the present paper is obtained by reducing an instance of this problem of polynomial depth to an equivalent instance of logarithmic depth .",
    "this demonstrates that the problem of close images remains complete for even under a logarithmic depth restriction .",
    "the hardness of distinguishing short quantum circuits is then demonstrated by a modification to the argument in  @xcite to show that the equivalence of close images problem and the distinguishability holds even for log - depth circuits .",
    "the remainder of this paper is organized as follows . in the next section ,",
    "some of the notation and results that will be needed are summarized .",
    "this is followed by section  [ scn : problems ] , where the complete problems for are discussed . in section  [ scn : construction ] the reduction from the polynomial depth to logarithmic depth versions of the close images problem is given , and the correctness of this construction is shown in section  [ scn : soundness ] .",
    "the equivalence between the log - depth close images problem and the problem of distinguishing log - depth computations is discussed in section  [ scn : distinguish ] .",
    "this section outlines some of the definitions and results that will be used throughout the paper . for a more thorough treatment of the concepts introduced here",
    "see  @xcite and  @xcite .    throughout the paper",
    "scripted letters such as @xmath1 will refer to finite dimensional hilbert spaces , @xmath2 will denote the set of all density matrices on @xmath1 , and @xmath3 will denote the norm - preserving linear operators from @xmath1 to @xmath4 .",
    "the proof of the main result will make extensive use of two notions of distance between quantum states .",
    "the first of these is the fidelity .",
    "the _ fidelity _ between two positive semidefinite operators @xmath5 and @xmath6 on a space @xmath1 can be defined as @xmath7 this definition is known as uhlmann s theorem , and it is used here as it is more directly applicable to the task at hand than the usual definition . as any purification of a state necessarily purifies the partial trace of that state , this equation implies that the fidelity is nondecreasing under the partial trace .",
    "this property is known as _ monotonicity _ and can be stated more formally as @xmath8 where @xmath9 are positive semidefinite operators on @xmath10 .",
    "the final property of the fidelity that will be needed is the result that the maximum fidelity of any outputs of two transformations is multiplicative with respect to the tensor product .",
    "this result can be found in  @xcite ( see problem  11.10 and apply the multiplicativity of the diamond norm with respect to the tensor product ) .",
    "[ thm : outfid - mult ] for any completely positive transformations @xmath11 on states in @xmath1 @xmath12    the second notion of distance that will be used is the _ trace norm _",
    ", which can be defined for any linear operator @xmath5 by @xmath13 or equivalently as the sum of the singular values of @xmath5 .",
    "this quantity is a norm , and so in particular it satisfies the triangle inequality .",
    "similar to the fidelity , the trace norm is monotone under the partial trace , though in this case the trace norm is non - increasing under this operation .",
    "the proofs that follow will make essential use of the fuchs - van de graaf inequalities  @xcite that relate the trace norm and the fidelity .",
    "for any density operators @xmath14 and @xmath15 on the same space , these inequalities are @xmath16    in addition to these measures on quantum states , it will be helpful to have a distance measure on quantum transformations .",
    "one such measure is the _ diamond norm _ , which for a completely positive transformation @xmath17 on density operators on @xmath1 is given by @xmath18 this norm is essential when considering transformations as it represents the distinguishability of two transformations when a reference system is taken into account .",
    "the simple supremum of the trace norm over all inputs to the channel is not stable under the addition of a reference system , and so the diamond norm is used in place of the simpler one .",
    "more properties and a more thorough definition of this norm can be found in  @xcite .",
    "the circuit model that will be used in this paper is the mixed state model introduced by aharonov , kitaev , and nisan  @xcite .",
    "circuits in this model are composed of qubits that are acted upon by arbitrary trace preserving and completely positive operations .",
    "this model allows for non - unitary operations , such as measurement or the introduction of ancillary qubits , to occur in the middle of the circuit .",
    "it is important to note that this model captures any physical process that quantum mechanics allows , and so in particular , any computation that can be done on mixed states with measurements can be represented in this model .",
    "fortunately this model is polynomially equivalent to the standard model of unitary quantum circuits ( with ancilla ) followed by measurement , as shown in  @xcite .",
    "this will allow us to consider only circuits composed of unitary gates from some finite basis of one and two qubit gates with the additional operations of introducing qubits in the @xmath19 state and measuring in the computational basis .",
    "this restriction can be strengthened , again with no loss of generality , to assume that all ancillary qubits are introduced at the start of the circuit and that all measurements are performed at the end .",
    "we will often add to this circuit model one additional gate : the unbounded fan - out gate .",
    "this gate , in constant depth , applies a controlled - not operation from one qubit to an arbitrary number of output qubits .",
    "it is not clear that this gate is a reasonable choice in a standard basis of gates , and so it will be clearly marked when this gate is allowed into the circuit model under consideration . as an example of the power of this gate",
    "it can be used to build a constant depth circuit for the approximate quantum fourier transform  @xcite .",
    "this gate is considered here for the sole reason that if it is included in the standard set of gates , the main result will also hold for constant depth circuits .    for spaces @xmath1 and @xmath4 of the same dimension , we use @xmath20 to represent the operation that swaps the states in the two spaces . as",
    "@xmath21 is a permutation matrix when expressed in the computational basis , and the permutation that it encodes is composed exclusively of transpositions , the swap operation is both hermitian and unitary .",
    "furthermore , @xmath21 can easily be implemented in constant depth , as all of the required transpositions can be performed in parallel .",
    "this operator is the essential component of the _ swap test _ , where a controlled @xmath21 operation is used to determine how close two states are to each other .",
    "a circuit performing the swap test is given in figure  [ fig : swaptest ] , where the measurement is performed in the computational basis .    #",
    "1#2#3#4#5 @font    ( 3300,1899)(1339,-1423 ) ( 4426,164)(0,0)[lb ] ( 1351,-511 ) ( 1 , 0)1350 ( 1351,-586 ) ( 1 , 0)1350 ( 1351,-661 ) ( 1 , 0)1350 ( 1351,-736 ) ( 1 , 0)1350 ( 1351,-961 ) ( 1 , 0)1350 ( 1351,-886 ) ( 1 , 0)1350 ( 1351,-1036 ) ( 1 , 0)1350 ( 1351,-1111 ) ( 1 , 0)1350 ( 1351,-1186 ) ( 1 , 0)1350 ( 1351,-1261 ) ( 1 , 0)1350 ( 3301,-961 ) ( 1 , 0)1350 ( 3301,-886 ) ( 1 , 0)1350 ( 3301,-1036 ) ( 1 , 0)1350 ( 3301,-1111 ) ( 1 , 0)1350 ( 3301,-1186 ) ( 1 , 0)1350 ( 3301,-1261 ) ( 1 , 0)1350 ( 3301,-436 ) ( 1 , 0)1350 ( 3301,-361 ) ( 1 , 0)1350 ( 3301,-511 ) ( 1 , 0)1350 ( 3301,-586 ) ( 1 , 0)1350 ( 3301,-661 ) ( 1 , 0)1350 ( 3301,-736 ) ( 1 , 0)1350 ( 3001,239 ) ( 2701,-1411)(600,1200)@xmath21 ( 3601,239)(-1 , 0)1200 ( 3001,239 ) ( 0,-1)450 ( 1951 , 14)(450,450)@xmath22 ( 3601 , 14)(450,450)@xmath22 ( 4051,239 ) ( 1 , 0)300 ( 1651,239 ) ( 1 , 0)300 ( 1351,164)(0,0)[lb ] ( 1351,-436 ) ( 1 , 0)1350    another way to view the swap test is as a projective measurement onto the symmetric and antisymmetric subspaces .",
    "the projections in this measurement are given by @xmath23 and @xmath24 .",
    "this formulation of the swap test is equivalent to the circuit presented in figure  [ fig : swaptest ] .",
    "it is not immediately clear how a controlled operation on @xmath25 qubits , such as the controlled - swap operation used in the swap test , can be performed in depth logarithmic in @xmath25 .",
    "the straightforward implementation requires using one control qubit to control each of the gates in the operation",
    ". however , moore and nilsson  @xcite give a simple construction that allows such an operation to be performed in log - depth .    any log depth operation on @xmath25 qubits controlled by one qubit",
    "can be implemented in @xmath26 depth with @xmath27 ancillary qubits .",
    "moore and nilsson prove this only for the constant depth case , but the method of proof that they use immediately extends to the log depth case .",
    "they prove this proposition by using a tree of @xmath28 controlled - not operations to ` duplicate ' the control qubit .",
    "these copies can then be used to control the remaining operations , with each control qubit used at most a logarithmic number of times .",
    "this proposition , as an example , implies that the swap test circuit on @xmath25 qubits shown in figure  [ fig : swaptest ] can be implemented in depth @xmath26 .",
    "if the fan - out gate is allowed into the standard basis of gates , then controlled operations can be performed with only constant depth overhead . a circuit that performs this",
    "can be obtained by simply using one fan - out gate to make @xmath25 copies ( in the computational basis ) of the control qubit onto ancillary qubits .",
    "these ` copies ' may then be used to control each of the @xmath25 operations , with a final application of the fan - out gate to restore the ancillary qubits to the @xmath19 state . as",
    "controlled operations will be the only place that the circuits constructed here exceed constant depth , this will allow the proof of the main result for constant depth circuits with fan - out .",
    "the problem , defined and shown to be complete for in  @xcite can be stated as follows .",
    "close images for constants @xmath29 , the input consists of quantum circuits @xmath30 and @xmath31 that implement transformations from @xmath1 to @xmath4 .",
    "the promise problem is to distinguish the two cases :    yes : :    @xmath32 for some    @xmath33 , no : :    @xmath34 for all    @xmath35 .",
    "this is simply the problem of determining if there are inputs to @xmath30 and @xmath31 that cause them to output states that are nearly the same",
    ". it will be helpful to abbreviate the name of this problem as @xmath36 .",
    "a closely related problem is that of distinguishing two quantum circuits .",
    "this problem was introduced and shown complete for in  @xcite .",
    "quantum circuit distinguishability for constants @xmath37 , the input consists of quantum circuits @xmath30 and @xmath31 that implement transformations from @xmath1 to @xmath4 .",
    "the promise problem is to distinguish the two cases :    yes : :    @xmath38 , no : :    @xmath39 .",
    "less formally , this problem asks : is there an input density matrix @xmath14 on which the circuits @xmath30 and @xmath31 can be made to act differently ?",
    "this problem will be referred to as @xmath40 .",
    "it is our aim to prove that these problems remain complete for when restricted to circuits @xmath30 and @xmath31 that are of depth logarithmic in the number of input qubits .",
    "this will be achieved in the case of perfect soundness error , i.e. @xmath41 in the above problem definitions .",
    "both of these problem remain complete for in this case .",
    "this restriction serves only to make these problems easier , as distinguishing the two cases for a weaker promise can only be more difficult , so the results of this paper will also imply the hardness of the more general problems . the log - depth versions of these problems will be referred to as @xmath42 and @xmath43 , and since these are restrictions of -complete problems it is clear that they are also in .",
    "similarly , the abbreviations @xmath44 and @xmath45 for the versions of these problems on constant - depth circuits will be convenient .",
    "in this section the reduction from the general @xmath46 problem to the log - depth restriction of the problem is described . the general idea behind the construction is to simply slice the circuits of an instance of @xmath46 into logarithmic - depth pieces and run them in parallel .",
    "these circuits will require more input , but if each piece of the circuit is given as input the same state output by the previous piece , then the output of the last piece of the circuit will be equal to the output of the original circuit",
    ". this may not be the case if the intermediate inputs are not the outputs of the previous pieces , and so additional tests that ensure these inputs are at least close to the desired states are required .    to describe the reduction ,",
    "let @xmath30 and @xmath31 be the circuits from an instance of @xmath46 , and let @xmath25 be the size ( number of gates ) of @xmath30 and @xmath31 ( by padding the smaller circuit , if necessary ) . in order to perform the slicing of the circuit into pieces",
    "it is assumed that @xmath30 and @xmath31 first introduce any necessary ancillary qubits , then apply local unitary gates , and finally trace out any qubits that are not part of the input .",
    "this restriction can be made with no loss in generality , as any quantum circuit , even one that incorporates measurements and other non - unitary operations , can be approximated by such a circuit , and furthermore , this circuit uses a number of gates that is a polynomial in the size of the original circuit  @xcite .    a simple way to decompose @xmath30 into constant depth pieces is to simply let each gate of @xmath30 be a piece in the decomposition . let @xmath47 be these pieces , with the additional complication that the operation @xmath48 both adds the ancillary qubits and performs the first gate of the circuit .",
    "in a similar way , @xmath31 can be decomposed into constant depth pieces @xmath49 .",
    "these pieces are shown in figure  [ fig : original ] .    # 1#2#3#4#5 @font    ( 4350,1524)(376,-1573 ) ( 4726,-1186)(0,0)[lb ] ( 3601,-1561)(450,1500)@xmath50 ( 901,-361 ) ( 1 , 0)300 ( 901,-436 ) ( 1 , 0)300 ( 901,-511 ) ( 1 , 0)300 ( 901,-586 ) ( 1 , 0)300 ( 901,-661 ) ( 1 , 0)300 ( 901,-736 ) ( 1 , 0)300 ( 1651,-361 ) ( 1 , 0)300 ( 1651,-436 ) ( 1 , 0)300 ( 1651,-511 ) ( 1 , 0)300 ( 1651,-586 ) ( 1 , 0)300 ( 1651,-661 ) ( 1 , 0)300 ( 1651,-736 ) ( 1 , 0)300 ( 1651,-961 ) ( 1 , 0)300 ( 1651,-1036 ) ( 1 , 0)300 ( 1651,-1111 ) ( 1 , 0)300 ( 1651,-1186 ) ( 1 , 0)300 ( 1651,-1261 ) ( 1 , 0)300 ( 2401,-361 ) ( 1 , 0)300 ( 2401,-436 ) ( 1 , 0)300 ( 2401,-511 ) ( 1 , 0)300 ( 2401,-586 ) ( 1 , 0)300 ( 2401,-661 ) ( 1 , 0)300 ( 2401,-736 ) ( 1 , 0)300 ( 2401,-961 ) ( 1 , 0)300 ( 2401,-1036 ) ( 1 , 0)300 ( 2401,-1111 ) ( 1 , 0)300 ( 2401,-1186 ) ( 1 , 0)300 ( 2401,-1261 ) ( 1 , 0)300 ( 3301,-361 ) ( 1 , 0)300 ( 3301,-436 ) ( 1 , 0)300 ( 3301,-511 ) ( 1 , 0)300 ( 3301,-586 ) ( 1 , 0)300 ( 3301,-661 ) ( 1 , 0)300 ( 3301,-736 ) ( 1 , 0)300 ( 3301,-961 ) ( 1 , 0)300 ( 3301,-1036 ) ( 1 , 0)300 ( 3301,-1111 ) ( 1 , 0)300 ( 3301,-1186 ) ( 1 , 0)300 ( 3301,-1261 ) ( 1 , 0)300 ( 4351,-1036 ) ( 1 , 0)300 ( 4351,-961 ) ( 1 , 0)300 ( 4351,-1111 ) ( 1 , 0)300 ( 4351,-1186 ) ( 1 , 0)300 ( 4351,-1261 ) ( 1 , 0)300 ( 4051,-961 ) ( 1 , 0)300 ( 4051,-1036 ) ( 1 , 0)300 ( 4051,-1111 ) ( 1 , 0)300 ( 4051,-1186 ) ( 1 , 0)300 ( 4051,-1261 ) ( 1 , 0)300 ( 601,-361 ) ( 1 , 0)300 ( 601,-511 ) ( 1 , 0)300 ( 601,-436 ) ( 1 , 0)300 ( 601,-586 ) ( 1 , 0)300 ( 601,-661 ) ( 1 , 0)300 ( 601,-736 ) ( 1 , 0)300 ( 376,-586)(0,0)[lb ] ( 2851,-886)(0,0)[lb ] ( 1201,-1561)(450,1500)@xmath48    if @xmath30 and @xmath31 implement transformations from @xmath1 to @xmath4 , using ancillary qubits that fit into @xmath51 , and trace out the qubits in @xmath52 , then the spaces @xmath53 and @xmath54 are isomorphic , since by assumption @xmath30 and @xmath31 first introduce any",
    "needed ancilla and only trace qubits out at the end of the computation . using these spaces , and implicitly this isomorphism",
    ", we have @xmath55 where the subscripted spaces are copies of the non - subscripted spaces that hold the input or output of one of the pieces of the original circuits . as an example of this notation ,",
    "if @xmath56 , then the output of @xmath30 on @xmath14 is given by @xmath57 and the output of @xmath31 is given by the same expression using the @xmath58 operators .",
    "using this decomposition of @xmath30 and @xmath31 , circuits @xmath59 and @xmath60 are constructed that are logarithmic in depth and still in some sense faithfully implement @xmath30 and @xmath31 .",
    "this is done by running the circuits corresponding to @xmath61 in parallel , and tracing out all the qubits that are not in the output of @xmath50 .",
    "such a circuit is constant depth , but does not necessarily output a state in the image of @xmath30 , as the input to @xmath62 is not necessarily close to the output from @xmath63 .",
    "this problem can be dealt with by comparing the output of @xmath63 to the input to @xmath64 . in order to do this in logarithmic depth an auxiliary input that is first compared against the input to @xmath62 and then held in reserve to compare to the output of @xmath63",
    "is needed . to compare these quantum states",
    "the swap test can be used .",
    "this test will fail with some probability depending on the distance between the two states .",
    "an example of the construction used to ensure that the output of @xmath63 agrees with the input to @xmath62 is given in figure  [ fig : test ] .    # 1#2#3#4#5 @font    ( 4200,2049)(-524,-2623 ) ( -374,-1486)(0,0)[lb ] ( 601,-1936 ) ( 1 , 0)600 ( 601,-1786)(-1 , 0)600 ( 601,-1861)(-1 , 0)600 ( 601,-1936)(-1 , 0)600 ( 601,-2311 ) ( 1 , 0)600 ( 601,-2386 ) ( 1 , 0)600 ( 601,-2461 ) ( 1 , 0)600 ( 601,-2311)(-1 , 0)600 ( 601,-2386)(-1 , 0)600 ( 601,-2461)(-1 , 0)600 ( 2626,-811 ) ( 1426,-811 ) ( 1651,-1336 ) ( 1 , 0)150 ( 1651,-1411 ) ( 1 , 0)150 ( 1651,-1486 ) ( 1 , 0)150 ( 1801,-1636)(450,450)@xmath62 ( 2401,-2011)(450,825 ) ( 2851,-1636 ) ( 1 , 0)600 ( 3451,-1636 ) ( 1 , 0)150 ( 1651,-1786 ) ( 1 , 0)750 ( 1651,-1861 ) ( 1 , 0)750 ( 1651,-1936 ) ( 1 , 0)750 ( 2251,-1336 ) ( 1 , 0)150 ( 2251,-1411 ) ( 1 , 0)150 ( 2251,-1486 ) ( 1 , 0)150 ( 1651,-2086 ) ( 1 , 0)1950 ( 1801,-2611)(450,450)@xmath65 ( 1651,-2311 ) ( 1 , 0)150 ( 1651,-2386 ) ( 1 , 0)150 ( 1651,-2461 ) ( 1 , 0)150 ( 2251,-2311 ) ( 1 , 0)150 ( 2251,-2386 ) ( 1 , 0)150 ( 2251,-2461 ) ( 1 , 0)150 ( 1201,-2536)(450,825 ) ( 1651,-1336)(-1 , 0)1650 ( 1651,-1411)(-1 , 0)1650 ( 1,-1486 ) ( 1 , 0)1650 ( 2401,-2311 ) ( 1 , 0)1200 ( 2401,-2386 ) ( 1 , 0)1200 ( 2401,-2461 ) ( 1 , 0)1200 ( 2626,-1186 ) ( 0 , 1)375 ( 1426,-1711 ) ( 0 , 1)900 ( 601,-1786 ) ( 1 , 0)600 ( 1801,-1036)(450,450)@xmath5 ( 601,-1036)(450,450)@xmath22 ( 451,-811 ) ( 1 , 0)150 ( 1051,-811 ) ( 1 , 0)750 ( 2251,-811 ) ( 1 , 0)375 ( 151,-886)(0,0)[lb ] ( 3676,-2461)(0,0)[lb ] ( -524,-1936)(0,0)[lb ] ( -524,-2461)(0,0)[lb ] ( 1426,-811 )    to simplify the analysis of the constructed circuits these tests are controlled so that either one or the other is performed .",
    "this will affect the failure probability by a factor of at most two , but will allow the analysis of each swap test to ignore the effect of the other . to implement this a control qubit",
    "is used so that either the first or the second test is performed between every two pieces @xmath66 of the circuit .",
    "if a test is not performed , then the value of the output qubit of the swap test is left unchanged , and so the result of the test is a qubit in the @xmath19 state .",
    "these controlled operations can be implemented in logarithmic depth using the technique of moore and nilsson  @xcite .    after adding these tests between each piece of the circuit",
    "there is one final modification required .",
    "if any of the swap tests fail , i.e. detect states that are not the same , then they will output qubits in the @xmath67 state . as",
    "yes instances of @xmath46 have outputs that are close together , we can ensure that no outputs of the constructed circuits can be close if any swap tests fail by adding dummy qubits in the @xmath19 state to be compared to the outputs of the swap tests in the other circuit .",
    "these dummy qubits are shown in figure  [ fig : dummy ] .",
    "1#2#3#4#5 @font    ( 5561,1824)(1114,-2473 ) ( 2551,-2386)(0,0)[lb ] ( 4051,-886 ) ( 1 , 0)375 ( 4051,-1036 ) ( 1 , 0)375 ( 4051,-1111 ) ( 1 , 0)375 ( 4051,-1186 ) ( 1 , 0)375 ( 4051,-1336 ) ( 1 , 0)375 ( 4051,-1411 ) ( 1 , 0)375 ( 4051,-1486 ) ( 1 , 0)375 ( 4051,-2236 ) ( 1 , 0)375 ( 4051,-2311 ) ( 1 , 0)375 ( 4051,-2386 ) ( 1 , 0)375 ( 5026,-736 ) ( 1 , 0)375 ( 5026,-811 ) ( 1 , 0)375 ( 5026,-886 ) ( 1 , 0)375 ( 5026,-1111 ) ( 1 , 0)375 ( 5026,-1186 ) ( 1 , 0)375 ( 5026,-1261 ) ( 1 , 0)375 ( 5026,-1486 ) ( 1 , 0)375 ( 5026,-1561 ) ( 1 , 0)375 ( 5026,-1636 ) ( 1 , 0)375 ( 5026,-1861 ) ( 1 , 0)375 ( 5026,-1936 ) ( 1 , 0)375 ( 5026,-2011 ) ( 1 , 0)375 ( 5026,-2236 ) ( 1 , 0)375 ( 5026,-2311 ) ( 1 , 0)375 ( 5026,-2386 ) ( 1 , 0)375 ( 1126,-736 ) ( 1 , 0)375 ( 1126,-811 ) ( 1 , 0)375 ( 1126,-886 ) ( 1 , 0)375 ( 1126,-1036 ) ( 1 , 0)375 ( 1126,-1111 ) ( 1 , 0)375 ( 1126,-1186 ) ( 1 , 0)375 ( 1126,-1336 ) ( 1 , 0)375 ( 1126,-1411 ) ( 1 , 0)375 ( 1126,-1486 ) ( 1 , 0)375 ( 1126,-2236 ) ( 1 , 0)375 ( 1126,-2311 ) ( 1 , 0)375 ( 1126,-2386 ) ( 1 , 0)375 ( 2101,-736 ) ( 1 , 0)375 ( 2101,-811 ) ( 1 , 0)375 ( 2101,-886 ) ( 1 , 0)375 ( 2101,-1111 ) ( 1 , 0)375 ( 2101,-1186 ) ( 1 , 0)375 ( 2101,-1261 ) ( 1 , 0)375 ( 2101,-1486 ) ( 1 , 0)375 ( 2101,-1561 ) ( 1 , 0)375 ( 2101,-1636 ) ( 1 , 0)375 ( 2101,-1861 ) ( 1 , 0)375 ( 2101,-1936 ) ( 1 , 0)375 ( 2101,-2011 ) ( 1 , 0)375 ( 2101,-2236 ) ( 1 , 0)375 ( 2101,-2311 ) ( 1 , 0)375 ( 2101,-2386 ) ( 1 , 0)375 ( 4426,-2461)(600,1800)@xmath60 ( 1501,-2461)(600,1800)@xmath59 ( 4201,-1936)(0,0)[lb ] ( 5176,-1074)(0,0)[lb ] ( 5176,-1824)(0,0)[lb ] ( 1276,-1936)(0,0)[lb ] ( 2251,-1074)(0,0)[lb ] ( 2251,-1824)(0,0)[lb ] ( 2551,-1036)(0,0)[lb ] ( 2551,-1786)(0,0)[lb ] ( 5476,-1036)(0,0)[lb ] ( 5476,-1786)(0,0)[lb ] ( 5476,-2386)(0,0)[lb ] ( 4051,-736 ) ( 1 , 0)375    the constructed circuits @xmath59 and @xmath60 are obtained by decomposing @xmath30 and @xmath31 into constant depth pieces , inserting the swap tests shown in figure  [ fig : test ] , and adding dummy qubits to ensure that the swap tests in the other circuit do not fail . at the end of these circuits ,",
    "all qubits are traced out , except the output ( in the space @xmath68 ) of @xmath50 or @xmath69 , the output of the swap tests , and the dummy zero qubits .",
    "if the outputs of @xmath59 and @xmath60 are close together , then intuitively the output of the swap tests in each circuit must be close to zero and the output of @xmath50 and @xmath69 must also be close . if the swap tests do not fail with high probability ( i.e. the outputs are close to zero ) , then these circuits will more or less faithfully reproduce the output of @xmath30 and @xmath31 .",
    "thus , in the case that the outputs of @xmath59 and @xmath60 can be made close , we will be able to argue that the output of @xmath30 and @xmath31 can also be made close . proving that this intuitive picture is accurate forms the content of the next section .    in the other direction",
    ", it is not hard to see that if there are states @xmath70 such that @xmath71 , then there are similar states for the constructed circuits @xmath59 and @xmath60 . to do this , notice that the circuit construction does not change if additional qubits are added to the circuits to allow purification of the states @xmath14 and @xmath15 to be used as inputs to @xmath59 and @xmath60 .",
    "these additional qubits are traced out with the other qubits at the end of the circuit , so that the output state of the circuit are not changed .",
    "as these purifications are pure states and all operations performed during the circuit are unitary , the intermediate states of the circuits must also be pure states . if the input state to @xmath59 is @xmath72 , then by providing the state @xmath73 as input to @xmath59 , the output of each block of the circuit will be identical to the input to the next block , ensuring that all the swap tests will succeed with probability one .",
    "it remains only to check on such input states that @xmath59 produces the same output as @xmath30 on @xmath14 .",
    "this can be observed by noting that the output of the circuit is exactly @xmath57 which by construction is equal to the output of @xmath30 on @xmath14 .",
    "thus if the circuits @xmath30 and @xmath31 have intersecting images then so do the circuits @xmath59 and @xmath60 .",
    "this observation proves the completeness of the construction .",
    "soundness is considerably more intricate , and is the focus of the next section .",
    "in this section it is demonstrated that if the images of the original circuits @xmath30 and @xmath31 are far apart then so must be the images of the constructed circuits @xmath59 and @xmath60 . as the constructed circuits essentially simulate @xmath30 and @xmath31 the desired result can be obtained by arguing that either the outputs of @xmath59 and @xmath60 are far apart or the input to at least one of the constructed circuits is not a faithful simulation of the corresponding original circuit . in the case that this simulation is not faithful it will be shown that there is some swap test that fails with reasonable probability .",
    "this implies that outputs of the constructed circuits must also be distant , as the failing swap test produces a state of the form @xmath74 that has low fidelity with the corresponding dummy zero qubit of the other circuit .    as a first step ,",
    "we place a lower bound on the failure probability of a swap test in terms of the fidelity of the two states being compared . in the following lemma the swap test is viewed as a measurement of the symmetric and antisymmetric projectors , with the outcome that produces a qubit in the state @xmath67 corresponding to the antisymmetric case .",
    "[ lem : swap - fidelity ] if @xmath75 then a swap test on @xmath76 returns the antisymmetric outcome with probability at least @xmath77    let @xmath78 be a purification of @xmath14 , where @xmath79 is an arbitrary space of sufficient dimension to allow such a purification . the swap test measures the state on @xmath76 with the projectors @xmath80 and @xmath81 , where @xmath21 is the swap operator on @xmath76 .",
    "thus , the antisymmetric outcome occurs with probability @xmath82 { |\\psi\\rangle}{\\langle \\psi| } [ ( i - w^*){\\otimes}i ]          \\right )        =   \\frac{1}{2 } { \\langle \\psi| } i { \\otimes}i                        - w { \\otimes}i { |\\psi\\rangle }        =   \\frac{1}{2 } - \\frac{1}{2 }          { \\langle \\psi| } w { \\otimes}i { |\\psi\\rangle},\\ ] ] as @xmath21 is hermitian .",
    "then as @xmath21 is also unitary , the states @xmath72 and @xmath83 each purify both @xmath84 and @xmath85 , and so by uhlmann s theorem @xmath86 after tracing out the space @xmath79 , this is exactly the statement of the lemma .",
    "this lemma can not be immediately applied to the circuits @xmath59 and @xmath60 , as in these circuits the output of one block of the circuit is not directly compared to the input to the next block , but instead each of these states are with probability @xmath87 compared to some intermediate value . in order to deal with this difficulty , we use the fuchs - van de graaf inequalities to translate the fidelity to a relation involving the trace norm , which we can then apply the triangle inequality to .",
    "this application of the triangle inequality shows that at least one of the two swap tests fails with probability bounded below by an expression involving the fidelity . in the following corollary the reduced states of various parts of the input to either of the circuits @xmath59 or @xmath60 are used , but it is not assumed that these states are given in a separable form .",
    "for instance , the density matrices @xmath88 and @xmath89 that appear in the lemma may be part of some larger entangled pure state , so that the failure probabilities of the two swap tests need not be independent .",
    "[ cor : failprob ] if @xmath72 is input to the circuit @xmath90 for @xmath91 , with @xmath92 the reduced state of @xmath93 on @xmath94 , then at least one of the swap tests on the @xmath95th block of @xmath90 fails with probability at least @xmath96    in the @xmath95th block of @xmath90 there are two inputs to the first swap test : let the reduced density operators of these inputs be @xmath92 and @xmath97 .",
    "the inputs to the second swap test are then given by @xmath97 and @xmath98 .",
    "as exactly one of these tests is performed we do not need to consider the effect of the first test on the state when considering the second test , and so the same input state @xmath97 is used in both swap tests .    by lemma  [ lem : swap - fidelity ] , the failure probability of first and second tests , when performed , are at least @xmath99 and @xmath100 , respectively .",
    "thus , the probability @xmath101 that at least one of these tests fails , given that each of them is performed with probability @xmath87 , is at least @xmath102 by the fuchs - van de graaf inequalities , this fidelity may be replaced by the trace norm .",
    "doing so , we obtain @xmath103 finally , as this maximum must be at least the average of the two values , @xmath104 where the last inequality follows from an application of the triangle inequality .    by repeatedly applying some of the properties of the trace norm discussed in section  [ scn : prelim ]",
    "it is somewhat tedious but not difficult to reduce the problem at hand to the previous corollary .",
    "this is the content of the following theorem .",
    "[ thm : soundness ] if @xmath105 for all @xmath106 then @xmath107 for all @xmath108 .",
    "let @xmath14 and @xmath15 be inputs to @xmath59 and @xmath60 , and let @xmath109 be the reduced states of these inputs on @xmath94 for @xmath110 , where the states for @xmath111 are the inputs that are only used by the swap tests , which we will not need to refer to explicitly .",
    "that is , @xmath92 and @xmath89 for @xmath112 are the portions of the state that are input to the unitaries @xmath62 and @xmath58 that make up the circuits @xmath30 and @xmath31 .",
    "the output of the circuits @xmath59 and @xmath60 is then given by a number of qubits corresponding to the swap tests as well as the states @xmath113 and @xmath114 , where @xmath115 is simply the space that is traced out to obtain the output from the unitary representations of the original circuits .    by the condition on the fidelity of @xmath30 and @xmath31 and the fuchs - van de graaf inequalities",
    ", we have @xmath116 using the triangle inequality we can relate this to the distance between the constructed circuits .",
    "adding terms and simplifying , we obtain @xmath117 we now observe that @xmath118 by the monotonicity of the trace norm under the partial trace , since the former can be obtained from the later by tracing out the appropriate spaces . using this",
    "we have @xmath119 as the three terms on the right are nonnegative , at least one of them must be larger than the average @xmath120 . if @xmath121 then @xmath122 and there is nothing left to prove .",
    "the cases where one of the first two terms of exceeds @xmath120 are symmetric , and so we can consider only the first term . expanding @xmath123 in terms of the @xmath62 , we obtain @xmath124 where once again the monotonicity of the trace norm under the partial trace has been used . by repeating the strategy of adding terms and then applying the triangle inequality we have @xmath125 here we have made use of the unitary invariance of the trace norm to discard the operators @xmath126 from the first term . continuing in this fashion",
    "we have @xmath127 as all terms in this sum are nonnegative , there must be at least one term in the sum that exceeds @xmath128 , as this is a lower bound on the average of all terms .",
    "thus , for some value of @xmath95 , we have @xmath129 and so by corollary  [ cor : failprob ] one of the corresponding swap tests fails with probability @xmath130 .",
    "the qubit representing the output value of this swap test is then of the form @xmath131 , and so , by the monotonicity of the fidelity under the partial trace , @xmath132 as in the statement of the theorem .    by combining theorem  [ thm : soundness ] with the observation in section  [ scn : construction ] and the multiplicativity of the maximum output fidelity of two transformations , we obtain the following result .    the problem @xmath42 is -complete for any constant @xmath133 .    theorem  [ thm : soundness ] establishes the completeness of the problem for any @xmath134 , where @xmath25 is an upper bound on the size of the circuits . using theorem  [ thm : outfid - mult ] of kitaev , shen , and vyalyi  @xcite we can repeat each of the circuits @xmath135 times in parallel to obtain the completeness of the problem for @xmath136 which can be made smaller than any constant for @xmath135 some polynomial in @xmath25 .",
    "as the circuits constructed by the reduction only make use of logarithmic depth when performing swap tests , and the controlled swap operations performed by these tests can be accomplished in constant depth using unbounded fan - out gates , the following corollary follows immediately from the previous one .",
    "the problem @xmath44 on circuits with the unbounded fan - out gate is -complete for for any constant @xmath133 .",
    "the hardness of @xmath42 can be extended to @xmath43 by observing that the reduction for the polynomial depth version of this problem in  @xcite can be made to preserve the depth of the constructed circuits .",
    "once this observation is made , the hardness of the log - depth ( and constant - depth with fan - out ) versions of the circuit distinguishability problem is immediate .",
    "the reduction in  @xcite takes as input circuits @xmath137 and produces circuits @xmath59 and @xmath60 . without describing the reduction in detail , the constructed circuits @xmath59 and @xmath60 run , depending on the value of a control qubit , one of @xmath30 and @xmath31 , followed by a constant depth circuit . if the input circuits @xmath30 and @xmath31 have logarithmic depth , then the only significant difficulty is the fact that controlled versions of these circuits are needed .",
    "however , as we have already seen , if we replace the gates in @xmath30 and @xmath31 with controlled versions , then we can use the scheme of moore and nilsson  @xcite to implement the controlled operations in logarithmic depth . with this modification ,",
    "the reduction in  @xcite can be reused to show the hardness of the problem on log - depth circuits .",
    "@xmath43 is -complete for any constant @xmath138 .",
    "once again these controlled operations can be implemented in a constant depth circuit if the unbounded fan - out gate is allowed into the set of allowed gates .",
    "@xmath45 on circuits with the unbounded fan - out gate is -complete for any constant @xmath138 .",
    "the hardness of distinguishing even log - depth mixed state quantum circuits leaves several related open problems , a few of which are listed here .",
    "* can this new complete problem be used to further understand ? *",
    "does this result rely in an essential way on the mixed state circuit model ?",
    "how difficult is it to distinguish quantum circuits in less general models of computation ?",
    "* what is the complexity of distinguishing constant depth quantum circuits that do not use the unbounded fan - out gate ?",
    "i would like to thank john watrous for several helpful discussions , the anonymous reviewers for constructive comments , as well as canada s nserc and mitacs for supporting this research .",
    "s.  fenner , f.  green , s.  homer , and y.  zhang .",
    "bounds on the power of constant - depth quantum circuits . in _ proceedings of the 15th international symposium on fundamentals of computation theory _ , pages 4455 , 2005 .",
    "a.  kitaev and j.  watrous .",
    "parallelization , amplification , and exponential time simulation of quantum interactive proof systems . in _ proceedings of the 32nd acm symposium on the theory of computing _ ,",
    "pages 608617 , 2000 ."
  ],
  "abstract_text": [
    "<S> distinguishing logarithmic depth quantum circuits on mixed states is shown to be complete for , the class of problems having quantum interactive proof systems . </S>",
    "<S> circuits in this model can represent arbitrary quantum processes , and thus this result has implications for the verification of implementations of quantum algorithms . </S>",
    "<S> the distinguishability problem is also complete for on constant depth circuits containing the unbounded fan - out gate . </S>",
    "<S> these results are shown by reducing a -complete problem to a logarithmic depth version of itself using a parallelization technique .    </S>",
    "<S> bill rosgen </S>"
  ]
}