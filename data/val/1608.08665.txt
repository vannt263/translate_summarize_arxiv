{
  "article_text": [
    "optimization with pde constraints is nowadays a well - studied topic motivated by its relevance in industrial applications .",
    "we are interested in the numerical approximation of such optimization problems in an efficient and reliable way using surrogate models obtained with pod - mor .",
    "the surrogate models are built upon _",
    "snapshots _ of the system to provide information about the underlying problem .",
    "this stage is usually called the offline stage . for the snapshot pod approach",
    "we refer the reader to @xcite .",
    "+ several works focus their attention on the choice of the snapshots , in order to approximate either dynamical systems or optimal control problems by suitable surrogate models . in @xcite",
    ", it is proposed to optimize the choice of the time instances such that the error between pod and the trajectory of the dynamical system is minimized .",
    "a recent approach proposes to choose the snapshots by an a - posteriori error estimator in order to equidistribute the state error on the time grid related to the snapshot locations ( see @xcite ) .",
    "we also mention an adaptive method , proposed in @xcite , where the aim is to reduce expensive offline costs selecting the snapshots according to an adaptive time - stepping algorithm using time error - control . for further references",
    "we refer the interested reader to @xcite . + in optimal control problems",
    "the reduced model is usually built upon a forecast on the control .",
    "this approach does not guarantee a proper construction of the surrogate model since we do not know how far away the optimal solution is from the reference control .",
    "more sophisticated approaches select snapshots by solving an optimization problem in order to improve the selection of the snapshots according to the desired controlled dynamics . for this purpose optimality system for pod ( os - pod )",
    "is introduced in @xcite . in os - pod ,",
    "the computation of the basis functions is performed by means of the solution of an enlarged optimal control problem which involves the full problem , the reduced equation and the eigenvalue problem for the pod modes .",
    "+ the reduction of optimal control problems with particular focus on adaptive adjustments of the surrogate models can be found in @xcite .",
    "we should also mention another adaptive method for feedback control problems by means of the hamilton - jacobi - bellman equation , introduced in @xcite .",
    "+ recently , an a - posteriori error estimator was introduced in @xcite for optimal control problems . in these",
    "works the error between the unknown optimal and the computed pod suboptimal control is estimated for linear and nonlinear problems , and it is shown that increasing the number of basis functions leads to the desired convergence .",
    "os - pod and a - posteriori error estimation is combined in @xcite .",
    "+ all these works have in common that they compute basis functions for optimal control problems . in our paper",
    "we address the question of an efficient and suitable selection of snapshot locations by means of an a - posteriori error control approach proposed in @xcite .",
    "we rewrite the optimality conditions as a second order in time and fourth order in space elliptic equation for the adjoint variable and we generalize this approach to control constraints .",
    "in particular , a time adaptive concept is used to build the snapshot grid which should be used to construct the pod surrogate model for the approximate solution of the optimal control problem . here the novelty for the reduced control problem is twofold : we directly obtain snapshots related to an approximation of the optimal control and , at the same time , we get information about the time grid .    we have proposed a similar approach based on a reformulation of the optimality system with respect to the state variable in @xcite .",
    "now , we focus our approach on the adjoint variable and generalize the idea presented in @xcite to time dependent control intensities with control shape functions including control constraints .",
    "furthermore , we certify our approach by means of several error bounds for the state , adjoint state and control variable .",
    "+ the outline of this paper is as follows . in section 2",
    "we present the optimal control problem together with the optimality conditions . in section 3",
    "we recall the main results of @xcite .",
    "proper orthogonal decomposition and its application to optimal control problems is presented in section 4 .",
    "the focus of section 5 lies in investigating our snapshot location strategy .",
    "finally , numerical tests are discussed in section 6 and conclusions are driven in section 7 .",
    "in this section we describe the optimal control problem .",
    "the governing equation is given by a linear parabolic pde : @xmath0 where @xmath1 is an open bounded domain with smooth boundary , @xmath2 , @xmath3 $ ] is the space - time cylinder , @xmath4 $ ] , and the state is denoted by @xmath5 . as control space we use @xmath6 , where @xmath7 , and define the control operator as @xmath8 , @xmath9 , where @xmath10 denote specified control actions . thus @xmath11 is linear and bounded . for the control variable",
    "we require @xmath12 \\ } \\subset l^\\infty(0,t;\\mathbb{r}^m)\\ ] ] with @xmath13 almost everywhere in @xmath14 .",
    "it is well - known ( see @xcite , for example ) that for a given initial condition @xmath15 and a forcing term @xmath16 the equation admits a unique solution @xmath17 , where @xmath18 if @xmath19 , higher regularity results can be derived according to @xcite .",
    "we also note that the unconstrained case is related to @xmath20 .",
    "the weak formulation of is given by : find @xmath21 with @xmath22 and @xmath23    the cost functional we want to minimize is given by @xmath24 where @xmath25 is the desired state and the regularization parameter @xmath26 is a real positive constant .",
    "the optimal control problem then reads @xmath27 note that @xmath28 is a non - empty , bounded , convex and closed subset of @xmath29 .",
    "hence , it is easy to argue that admits a unique solution @xmath30 with associated state @xmath31 , see e.g. @xcite .",
    "the first order optimality system of the optimal control problem is given by the state equation , together with the adjoint equation @xmath32 and the variational inequality @xmath33 where @xmath34 is the dual operator of @xmath11 .",
    "in we have identified @xmath35 with @xmath36 and @xmath37 with @xmath38 , where we use that hilbert spaces are reflexive .",
    "the variational inequality is equivalent to the projection formula @xmath39,\\ ] ] where @xmath40 denotes the orthogonal projection onto @xmath28 .",
    "it follows from the reflexivity of the involved spaces that the action of the adjoint operator @xmath41 is given as @xmath42 and @xmath43    since our domain is smooth , the regularities of the optimal state , the optimal control and the associated adjoint state are limited through the regularities of the initial state @xmath44 , the right hand side @xmath45 , the control @xmath46 and the desired state @xmath47 + the numerical approximation of the optimality system -- with a standard finite element method ( fem ) in the spatial variable leads to a high - dimensional system of ordinary differential equations :    @xmath48    here @xmath49\\rightarrow{\\mathbb r}^n$ ] are the semi - discrete state and adjoint , respectively , @xmath50 are the time derivatives , @xmath51 denotes the mass matrix and @xmath52 the stiffness matrix .",
    "note that the dimension @xmath53 of each equation in the semi - discrete system is related to the number of element nodes chosen in the fem approach .",
    "in this section , we consider the reformulation of the optimality system -- as an elliptic equation of fourth order in space and second order in time for the adjoint variable @xmath54 .",
    "this is carried out for the unconstrained control problem in @xcite and generalized to control constrained optimal control problems in @xcite . following these works , we include control constraints . here",
    ", we aim to derive an a - posteriori error estimate for the time discretization as suggested in @xcite , which then turns out to be the basis for our model reduction approach to solve .",
    "+ we define @xmath55 where @xmath56 is equipped with the norm @xmath57 under the assumptions @xmath19 , @xmath58 for @xmath59 and @xmath60 , the regularity of @xmath61 is ensured , see @xcite for the details .",
    "then , the first order optimality conditions -- can be transformed into an initial boundary value problem for @xmath54 in space - time :    @xmath62    where , without loss of generality , we have set @xmath63 .",
    "we note that the quantity @xmath64 is nondifferentiable and nonlinear in @xmath54 and thus becomes a semilinear second order in time and fourth order in space elliptic problem with a monotone nonlinearity .",
    "existence of a unique weak solution for can be proved analogously to @xcite and follows from the fact that the optimal control problem in the case of control constraints with closed and convex @xmath65 admits a unique solution .",
    "+ in order to provide the weak formulation of , we define the operator @xmath66 and the linear form @xmath67 as @xmath68 @xmath69 @xmath70 where @xmath71 denotes the outer normal to the boundary @xmath72 .",
    "the weak formulation of equation for given @xmath73 reads : @xmath74    it follows from the monotonicity of the orthogonal projection that admits a unique solution @xmath54 , compare e.g. ( * ? ? ?",
    "* th . 1.25 ) .",
    "we put our attention on the semi - discrete approximation of and investigate a - priori and a - posteriori error estimates for the time discrete problem , where the space is kept continuous .",
    "let us consider the time discretization @xmath75 with @xmath76 and @xmath77 .",
    "let @xmath78 $ ] .",
    "we define the time discrete space @xmath79 where the notation @xmath80 stands for the polynomials of first order on the interval @xmath81 .",
    "then , we consider the semi - discrete problem : @xmath82 using the arguments of e.g. ( * ? ? ?",
    "* th . 1.25 ) one can show that problem admits a unique solution @xmath83 .",
    "+ we note that with and we have the galerkin orthogonality @xmath84 thus , for @xmath85 it holds true @xmath86 the following theorem states a temporal residual type a - posteriori error estimate for @xmath54 , which transfers the estimation of ( * ? ? ?",
    "* theorem 3.5 ) to the control constrained optimal control problem :    [ thm : apost ] let @xmath87 and @xmath88 denote the solutions to and , respectively .",
    "then we obtain @xmath89 where @xmath90 and @xmath91    _ proof .",
    "_ we start the proof showing a consequence of the monotonicity of the projector operator @xmath92 .",
    "we find that @xmath93 and hence @xmath94    for easier notation , we set @xmath95 . + let @xmath96 and let @xmath97 denote the standard lagrange type temporal interpolation of @xmath98",
    ". using the inequality @xmath99 for @xmath85 and @xmath100 from ( * ? ? ?",
    "* lemma 2.5 ) , the monotonicity and the galerkin orthogonality , we can estimate : @xmath101    & \\leq &   \\left\\| \\displaystyle\\frac{\\partial ( p - p_k)}{\\partial t } \\right\\|_{l^2(\\omega_t)}^2 + \\| \\delta ( p - p_k ) \\|_{l^2(\\omega_t)}^2 \\\\   & \\leq & \\left\\| \\displaystyle\\frac{\\partial ( p - p_k)}{\\partial t }    \\right\\|_{l^2(\\omega_t)}^2 + \\| \\delta ( p - p_k )",
    "\\|_{l^2(\\omega_t)}^2   +   \\displaystyle\\int_{\\omega_t } ( n(p)-n(p_k))(p - p_k ) \\\\[2ex ] & = & \\displaystyle\\int_{\\omega_t } \\displaystyle\\frac{\\partial ( p - p_k)}{\\partial t } \\frac{\\partial e^p}{\\partial t } + \\int_{\\omega_t } \\delta ( p - p_k ) \\delta e^p + \\int_{\\omega_t}(n(p ) - n(p_k))e^p \\\\[2ex ]   & = & \\displaystyle\\int_{\\omega_t } \\displaystyle\\frac{\\partial ( p - p_k)}{\\partial t } \\frac{\\partial ( e^p-\\pi_k e^p)}{\\partial t } + \\int_{\\omega_t } \\delta ( p - p_k ) \\delta ( e^p-\\pi_k e^p ) + \\int_{\\omega_t}(n(p ) - n(p_k))(e^p - \\pi_k e^p ) \\\\[2ex ]   & = & \\displaystyle\\int_{\\omega_t } ( -\\frac{\\partial y_d}{\\partial t } + \\delta y_d)(e^p - \\pi_k e^p ) + \\int_{\\sigma_t } y_d \\nabla(e^p - \\pi_k e^p ) \\cdot \\hat{n } - \\int_{\\omega_t } \\frac{\\partial p_k}{\\partial t } \\frac{\\partial ( e^p - \\pi_k e^p)}{\\partial t}\\\\[2ex ]   & & - \\displaystyle\\int_{\\omega_t } \\delta p_k \\delta ( e^p - \\pi_k e^p)- \\int_{\\omega_t}n(p_k)(e^p - \\pi_k e^p )   \\end{array}\\ ] ] integration by parts on each time interval and green s formula lead to @xmath101   & \\leq & \\displaystyle\\sum_j \\int_{i_j } \\int_\\omega ( - \\frac{\\partial y_d}{\\partial t } + \\delta y_d + \\frac{\\partial^2 p_k}{\\partial t^2 } - \\delta^2 p_k - n(p_k))(e^p - \\pi_k e^p ) + \\sum_j \\int_{i_j } \\int_{\\partial \\omega } ( y_d - \\delta p_k ) \\nabla ( e^p - \\pi_k e^p ) \\cdot \\hat{n}.   \\end{array}\\ ] ] utilizing error estimates of the lagrange interpolation @xmath102 , the trace inequality and young s inequality , we find @xmath103   & \\leq & c_1 \\displaystyle\\sum_j \\delta",
    "t_j^2 \\int_{i_j } \\left\\| -    \\frac{\\partial y_d}{\\partial t } + \\delta y_d +    \\frac{\\partial^2 p_k}{\\partial t^2 } - \\delta^2 p_k + \\mathcal{b }    \\mathcal{p}_{u_{ad } } \\left\\{-\\frac{1}{\\alpha } \\mathcal{b}^ * p_k \\right\\ } \\right\\|_{l^2(\\omega)}^2 \\\\[2ex ]   & & + c_1 \\displaystyle\\sum_j \\int_{i_j } \\| y_d - \\delta p_k \\|_{l^2(\\partial \\omega)}^2 .",
    "\\hspace{9.5 cm } \\square   \\end{array}\\ ] ]    theorem [ thm : apost ] provides a tool to refine the time grid by means of the residual of the system . due to ,",
    "the time instances of this grid may be regarded as ideal snapshot locations for pod - mor applied to problem .",
    "in this section , we recall the pod method which we use in order to replace the original problem by a surrogate model .",
    "the main interest when applying the pod method is to reduce computation times and storage capacity while retaining a satisfying approximation quality .",
    "this is possible due to the key fact that pod basis functions ( unlike typical finite element ansatz functions ) contain information about the underlying model , since the pod modes are derived from snapshots of a solution data set .",
    "for this reason it is important to use rich snapshot ensembles reflecting the dynamics of the modeled system .",
    "usually , we are able to improve the accuracy of a pod suboptimal solution by enlarging the number of utilized pod basis functions or enriching the snapshot ensemble , for instance . the snapshot form of pod proposed by sirovich in @xcite works in the continuous version as follows .",
    "+ let us suppose that the continuous solution @xmath104 of and @xmath105 of belongs to a real separable hilbert space @xmath106 , where @xmath107 or @xmath108 , equipped with its inner product @xmath109 and associated norm @xmath110 .",
    "we set , where @xmath111 , @xmath112 , @xmath113 .",
    "note that the initial condition @xmath114 is included in @xmath115 .",
    "the aim is to determine a pod basis @xmath116 of rank @xmath117 with @xmath118 , by solving the following constrained minimization problem : @xmath119 where @xmath120 denotes the kronecker symbol , i.e. @xmath121 for @xmath122 and @xmath123 .",
    "+ it is well - known ( see @xcite ) that a solution to problem ( [ prb : pod ] ) is given by the first @xmath124 eigenvectors @xmath125 corresponding to the @xmath124 largest eigenvalues @xmath126 of the self - adjoint linear operator @xmath127 i.e. @xmath128 , where @xmath129 is defined as follows : @xmath130 moreover , we can quantify the pod approximation error by the neglected eigenvalues ( more details in @xcite ) as follows : @xmath131    let us assume that we have computed pod basis functions @xmath132 .",
    "then , we define the pod galerkin ansatz of order @xmath124 for the state @xmath133 as : @xmath134    where @xmath135 and the unknown coefficients are denoted by @xmath136 . if we plug this ansatz into the weak formulation of the state equation and use @xmath137 as the test space , we get the following reduced order model for of low dimension :    @xmath138 \\text { a.e.},\\\\[2ex ] \\displaystyle\\int_\\omega y^\\ell(0 ) \\psi dx & = & \\displaystyle\\int_\\omega y_0 \\psi dx\\\\[2ex ] \\end{array}\\ ] ]    choosing @xmath139 for @xmath128 and utilizing , we infer from that the coefficients satisfy @xmath140 , \\quad m^\\ell w(0 ) = y_0^\\ell,\\ ] ] where @xmath141 , @xmath142 , @xmath143 and @xmath144 .",
    "note that @xmath145 is the identity matrix , if we choose as inner product @xmath146 .",
    "the reduced order model surrogate ( rom ) for the optimal control problem is given by @xmath147 where @xmath148 is the reduced cost functional , i.e. @xmath149 .",
    "we recall that the discretization of the optimal solution @xmath150 to is determined by the relation between the adjoint state and control and refer to @xcite for more details about the variational discretization concept . + in order to solve the reduced optimal control problem , we consider the well - known first order optimality condition given by the variational inequality @xmath151 which is sufficient since the underlying problem is convex .",
    "+ the first order optimality conditions of also deliver that the adjoint pod scheme for the approximation of @xmath54 is given by : find @xmath152 with @xmath153 satisfying @xmath154",
    "in section 4 , the pod method in the continuous framework is recalled , where the pod basis functions are computed in such a way that the error between the trajectories @xmath104 of and @xmath105 of and its pod galerkin approximation is minimized in . in practice",
    ", we do not have the whole solution trajectories @xmath155 } , 1 \\leq k \\leq 4 $ ] at hand .",
    "but we have snapshots available , which are the solutions @xmath156 to and the solutions @xmath157 to at times @xmath158 .",
    "this motivates to replace the time integration in by an appropriate quadrature rule based on @xmath159 , i.e. @xmath160 for @xmath161)$ ] with quadrature weights @xmath162 we later choose the weights for the trapezoidal rule , compare . in the present work ,",
    "we neglect the error introduced by quadrature weights .",
    "the minimization problem related to then becomes @xmath163 and obviously constitutes a strong dependence of the pod basis functions on the chosen snapshot locations @xmath164 .",
    "the related snapshots shall have the property to capture the main features of the dynamics of the truth solution as good as possible . here",
    "it is important to select suitable time instances at which characteristic dynamical properties of the optimal state are located .",
    "a natural question is :    _ how to pick time instances that represent good locations for snapshots in pod - mor for ? _",
    "+    moreover , we face some difficulties since the reduction of optimal control problems is usually initialized with snapshots computed from a given input control @xmath165 . this problem is usually addressed in the offline stage for pod , which is the phase needed for snapshot generation , pod basis computation and building the reduced order model .",
    "mostly , we do not have any information about the optimal control , such that in pod - mor the input control @xmath166 is often chosen as @xmath167 .",
    "this circumstance raises the question about the quality of the pod basis and the quality of the pod suboptimal solution .",
    "the a - posteriori error estimator in section 3 motivates a suitable location of time instances for the pod adjoint state and at the same time we get an approximation of the optimal control which can be used as an input control @xmath166 in order to generate the snapshots .",
    "the use , in the offline - stage , of a time adaptive mesh refinement process allows to overcome the choice of an input control @xmath166 and the choice of the snapshot locations by solving equation .",
    "then , we take advantage of the a - posteriori error estimation presented in theorem [ thm : apost ] .",
    "equation provides the optimal adjoint state associated with , which does not require the explicit knowledge of a control input @xmath166 .",
    "we note that the ellipticity of equation play a crucial role in this approach .",
    "the same approach would not work , if one solves the optimality conditions directly .",
    "the numerical approximation of @xmath54 provides important information about the control input .",
    "in fact , thanks to the variational inequality we are first able to build an approximate control @xmath168 and finally compute the associated state @xmath169 . in this way",
    "our snapshot set will contain information about the state corresponding to an approximation of the optimal control .",
    "thanks to this numerical approximation of the optimal control problem we can build the snapshot matrix and compute the pod basis functions where the number @xmath124 is chosen such that @xmath170 . + the approximation of equation is very useful in model order reduction since we overcome the choice of the initial input control to generate the snapshot set",
    ". moreover , we also gain information about a temporal grid , which allows us to better resolve @xmath54 with respect to time .",
    "the a - posteriori error estimation guarantees that the finite element approximation of in the time variable is below a certain tolerance .",
    "therefore , the reduced optimal control problem is set up and solved on the resulting adaptive time grid .",
    "now the question is :    _ how good is the quality of the computed time grid in terms of the error between + the optimal solution and the pod surrogate solution ? _",
    "+      let us motivate our approach by analyzing the error @xmath171 between the optimal adjoint solution @xmath172 of associated with the optimal control @xmath168 for , i.e. @xmath173 and the pod reduced approximation @xmath174 , which is the time discrete solution to the pod - rom for associated with the time discrete optimal control @xmath175 for , i.e. @xmath176 in .",
    "we denote by @xmath106 the space @xmath107 and by @xmath177 the space @xmath108 . by the triangular inequality we get the following estimates for the @xmath178-norm : @xmath179 where @xmath180 is the time discrete adjoint solution of associated with the control @xmath181 and @xmath182",
    "is the time discrete adjoint solution to with respect to the suboptimal control @xmath175 , i.e. @xmath176 in .",
    "by @xmath183 we denote the orthogonal pod projection operator as follows : @xmath184 the term ( [ err : est_new].1 ) can be estimated by and concerns the snapshot generation .",
    "thus , we can decide on a certain tolerance in order to have a prescribed error . the second term ( [ err : est_new].2 ) in is the pod projection error and can be estimated by the sum of the neglected eigenvalues .",
    "then , we note that the third term ( [ err : est_new].3 ) can be estimated as follows : @xmath185 where @xmath186 and @xmath187 is the constant referring to the lipschitz continuity of @xmath188 independent of @xmath189 as in @xcite . in order to control the quantity @xmath190",
    "we make use of the a - posteriori error estimation of @xcite , which provides an upper bound for the error between the ( unknown ) optimal control and any arbitrary control @xmath191 ( here @xmath192 and @xmath193 ) by @xmath194 where @xmath26 is the regularization parameter in the cost functional and @xmath195 is chosen such that @xmath196 is satisfied . finally ,",
    "last term ( [ err : est_new].4 ) can be estimated according to @xcite and involves the sum of the eigenvalues not considered , the first derivative of the time discrete adjoint variable and the difference between the state and the pod state : @xmath197 for a constant @xmath198 .",
    "we note that the sum of the neglected eigenvalues is sufficiently small provided that @xmath124 is large enough . furthermore , error estimation depends on the time derivative @xmath199 . to avoid this dependence ,",
    "we include time derivative information concerning the adjoint variable into the snapshot set , see @xcite .",
    "to summarize , the error estimation reads :    @xmath200    finally , we note that estimation involves the state variable which is estimated in the following section 5.2 .      in this section",
    "we address the problem of the certification of the quality for pod approximation for the state variable .",
    "it may happen that the time grid selected for the adjoint @xmath54 will not be accurate enough for the state variable @xmath133 .",
    "therefore a further refinement of the time grid might be useful in order to reduce the error between the pod state and the true state below a given threshold .",
    "this is not guarenteed if we use the time grid , which results from the use of the estimate . here",
    ", we consider the error between the full solution @xmath201 corresponding to the suboptimal control @xmath175 and the time discrete pod solution @xmath202 , where we assume to have the same temporal grid for snapshots and the solution of our pod reduced order problem .",
    "in this situation , the following estimate is proved in @xcite :    [ post_p ] @xmath203 & \\hspace{1 cm } + \\displaystyle\\sum_{j=1}^n c_y\\left(\\sum_{i=\\ell+1}^d\\left(|\\langle \\psi_i , y_0\\rangle_v|^2+\\lambda_i\\right)\\right ) \\label{post_p_b}\\\\[0.4 cm ] & \\hspace{1 cm } + \\displaystyle\\sum_{j=1}^n \\sum_{i=\\ell+1}^d c_y \\dfrac{\\lambda_i}{\\delta{t_j^2 } } \\label{post_p_c}\\end{aligned}\\ ] ]    where @xmath204 is a constant depending on @xmath205 , but independent of the time grid @xmath158 .",
    "we note that @xmath206 is the continuous solution of at given time instances related to the suboptimal control @xmath175 .",
    "the temporal step size in the subinterval @xmath207 $ ] is denoted by @xmath208 .",
    "the positive weights @xmath209 are given by @xmath210 the constant @xmath211 is an upper bound of the projection operator . a similar estimate can be carried out for the @xmath212norm .",
    "we refer the interested reader to @xcite .",
    "estimate provides now a recipe for further refinement of the time grid in order to approximate the state @xmath133 within a prescribed tolerance .",
    "one option here consists in equidistributing the error contributions of the term , while the number of modes has to be adapted to the time grid size according to the term .",
    "finally , the number @xmath124 of modes should be chosen such that the term in remains within the prescribed tolerance .",
    "the a - posteriori error control concept for now offers the possibility to select snapshot locations by a time adaptive procedure . for this purpose , is solved adaptively in time , where the spatial resolution ( @xmath213 in algorithm [ alg : optpod ] ) is chosen to be very coarse in order to keep the computational costs low .",
    "this is possible due to the fact that spatial and temporal discretization decouple when using the solution technique of @xcite as we will see in section 6 , compare figure [ fig3:mesh ] .",
    "the resulting time grid points now serve as snapshot locations , on which our pod reduced order model for the optimization is based .",
    "the snapshots are now obtained from a simulation of with high spatial resolution h , which is used in to obtain highly resolved snapshots of p , which are accomplished with time finite differences of those adjoint snapshots .",
    "the right - hand side @xmath168 in the simulation of is obtained from with @xmath54 from computed with spatially coarse resolution @xmath213 .",
    "the certification of the state variable is then performed according to as a post - processing procedure .",
    "this strategy might not deliver the optimal time instances , but it is a practical and efficient strategy , which turns out to deliver good approximation results ( compare section 6 ) at low costs .",
    "the algorithm is summarized below in algorithm [ alg : optpod ] .",
    "coarse spatial grid size @xmath213 , fine spatial grid size @xmath214 , maximal number of degrees of freedom ( dof ) + for the adaptive time discretization , @xmath2 .",
    "solve adaptively w.r.t .",
    "time with spatial resolution @xmath213 and obtain the time grid @xmath215 with solution @xmath216 .",
    "set @xmath217 solve on @xmath215 with spatial resolution @xmath213 corresponding to the control @xmath218 .",
    "refine the time interval @xmath215 according to and construct the time grid @xmath219 .",
    "generate state and adjoint snapshots by solving with r.h.s .",
    "@xmath218 and , respectively , on @xmath219 with spatial resolution @xmath214 .",
    "generate time derivative adjoint snapshots with time finite differences on those adjoint snapshots .",
    "compute a pod basis of order @xmath124 and build the pod reduced order model based on the state , + adjoint state and time derivative adjoint state snapshots .",
    "solve with the time grid @xmath219",
    "in our numerical computations we use a one - dimensional spatial domain and a finite element discretization in space by means of conformal piecewise linear polynomials .",
    "we use the implicit euler method for time integration .",
    "the solution of the optimal control problem is done by a gradient method with stopping criteria @xmath220 and an armijo linesearch . in the following numerical examples ,",
    "we apply algorithm [ alg : optpod ] in order to validate this strategy by numerical results .",
    "+ the numerical tests illustrate that utilizing a time adaptive grid for snapshot location and for solving the pod reduced order optimal control problem delivers more accurate approximation results than utilizing a uniform time grid .",
    "we show three different numerical tests .",
    "the first example presents a steep gradient at the end of the time interval in the adjoint variable . in the second example the adjoint state develops an interior layer in the middle of the time interval and",
    "finally we introduce control contraints in the third example .",
    "moreover we also show the benefits of the post processing for the state variable ( step 4 in algorithm [ alg : optpod ] ) to achieve more accurate approximation results for both state and adjoint state .",
    "+ all coding is done in matlab r2015a and the computations are performed on a 2.50ghz computer .",
    "+      the data for this test example is inspired from example 5.3 in @xcite , with the following choices : @xmath221 and @xmath222 = [ 0,1]$ ] .",
    "we set @xmath223 .",
    "the example is built in such a way that the exact optimal solution @xmath224 of problem with associated optimal adjoint state @xmath225 is known : @xmath226 with @xmath227 and the control shape function @xmath228 for the operator @xmath11 .",
    "this leads to the right hand side @xmath229 the desired state @xmath230 and the initial condition @xmath231 .",
    "we choose the regularization parameter to be @xmath232 . for small values of @xmath233 ( we use @xmath234 ) ,",
    "the adjoint state @xmath225 develops a layer towards @xmath235 , which can be seen in the left plots of figure [ fig1:sol ] and figure [ fig2:con ] .",
    "( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]   ( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]   ( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]     ( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]   ( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]   ( left ) , pod adjoint solution @xmath236 utilizing an equidistant time grid with @xmath237 ( middle ) , pod adjoint solution @xmath236 utilizing an adaptive time grid with dof=21 ( right).,title=\"fig : \" ]    in this test run we focus on the influence of the time grid to approximate of the pod solution .",
    "therefore , we compare the use of two different types of time grids : an equidistant time grid characterized by the time increment @xmath238 and a non - equidistant ( adaptive ) time grid characterized by @xmath239 degrees of freedom ( dof ) .",
    "we build the pod - rom from the uncontrolled problem ; we create the snapshot ensemble by determining the associated state @xmath240 and adjoint state @xmath241 corresponding to the control function @xmath167 and we also include the initial condition @xmath44 and the time derivatives of the adjoint @xmath242 into our snapshot set , which is accomplished with time finite differences of the adjoint snapshots .",
    "we use @xmath243 pod basis function .",
    "although we would also have the possibility to use suboptimal snapshots corresponding to an approximation @xmath218 of the optimal control , here , we want to emphasize the importance of the time grid . nevertheless in this example , the quality of the pod solution does not really differ , if we consider suboptimal or uncontrolled snapshots .",
    "first , we leave out the post - processing step 4 of algorithm [ alg : optpod ] and discuss the inclusion of this part later .",
    "+ figure [ fig3:mesh ] visualizes the space - time mesh of the numerical solution of ( [ 2ordp ] ) utilizing the temporal residual type a - posteriori error estimate ( [ est - thm31 ] ) .",
    "the first grid in figure [ fig3:mesh ] corresponds to the choice of dof=21 and @xmath244 , whereas the grid in the middle refers to using dof = 21 and @xmath245 .",
    "both choices for spatial discretization lead to the exact same time grid , which displays fine time steps towards the end of the time horizon ( where the layer in the optimal adjoint state is located ) , whereas at the beginning and in the middle of the time interval the time steps are larger .",
    "this clearly indicates that the resulting time adaptive grid is very insensitive against changes in the spatial resolution . for the sake of completeness",
    ", the equidistant grid with the same number of degrees of freedom is shown in the right plot of figure [ fig3:mesh ] . +",
    "since the generation of the time adaptive grid as well as the approximation of the optimal solution is done in the offline computation part of pod - mor , this process shall be perfomred quickly , which is why we pick @xmath245 for step 1 in algorithm 1 . +     according to the strategy in @xcite and @xmath244 ( left ) and @xmath245 ( middle ) , respectively , and the equidistant grid with @xmath246 ( right),title=\"fig : \" ]   according to the strategy in @xcite and @xmath244 ( left ) and @xmath245 ( middle ) , respectively , and the equidistant grid with @xmath246 ( right),title=\"fig : \" ]   according to the strategy in @xcite and @xmath244 ( left ) and @xmath245 ( middle ) , respectively , and the equidistant grid with @xmath246 ( right),title=\"fig : \" ]     ( top left ) , approximation @xmath218 of the optimal control gained by step 1 of algorithm [ alg : optpod ] ( top right ) ; pod control utilizing a uniform time grid with @xmath246 ( bottom left ) , pod control utilizing an adaptive time grid with dof=21 ( bottom right),title=\"fig : \" ]   ( top left ) , approximation @xmath218 of the optimal control gained by step 1 of algorithm [ alg : optpod ] ( top right ) ; pod control utilizing a uniform time grid with @xmath246 ( bottom left ) , pod control utilizing an adaptive time grid with dof=21 ( bottom right),title=\"fig : \" ] +   ( top left ) , approximation @xmath218 of the optimal control gained by step 1 of algorithm [ alg : optpod ] ( top right ) ; pod control utilizing a uniform time grid with @xmath246 ( bottom left ) , pod control utilizing an adaptive time grid with dof=21 ( bottom right),title=\"fig : \" ]   ( top left ) , approximation @xmath218 of the optimal control gained by step 1 of algorithm [ alg : optpod ] ( top right ) ; pod control utilizing a uniform time grid with @xmath246 ( bottom left ) , pod control utilizing an adaptive time grid with dof=21 ( bottom right),title=\"fig : \" ]    figures [ fig1:sol ] and [ fig2:con ] ( middle and right plots ) show the surface and contour lines of the pod adjoint state utilizing an equidistant time grid and utilizing the time adaptive grid , respectively .",
    "the analytical control intensity @xmath247 , the approximation @xmath218 of the optimal control computed in step 1 of algorithm [ alg : optpod ] as well as the pod controls utilizing a uniform and time adaptive grid , respectively , are shown in figure [ fig2b : control ] .",
    "+ table [ tab:1 ] summarizes the approximation quality of the pod solution depending on different time discretizations .",
    "the fineness of the time discretization ( characterized by @xmath248 and dof , respectively ) is chosen in such a way that the results of uniform and adaptive temporal discretization are comparable .",
    "the absolute errors between the analytical optimal state @xmath249 and the pod solution @xmath250 , defined by @xmath251 , are listed in columns 2 and 6 ; same applies for the errors in the control @xmath252 ( columns 3 and 7 ) and adjoint state @xmath253 ( columns 4 and 8) .",
    "if we compare the results , we note that we gain one order of accuracy for the adjoint and control variable with the time adaptive grid . in order to achieve an accuracy in the control variable of order @xmath254 utilizing an equidistant time grid , we need about @xmath255 time steps ( not listed in table [ tab:1 ] ) .",
    "this emphasizes that using an appropriate ( non - equidistant ) time grid for the adjoint variable is of particular importance in order to efficiently achieve pod controls of good quality .",
    ".test 1 : absolute errors between the analytical optimal solution and the pod solution depending on the time discretization ( equidistant : columns 1 - 4 , adaptive : columns 5 - 8 ) [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "in this paper we investigated the problem of snapshot location in optimal control problems .",
    "we showed that the numerical pod solution is much more accurate if we use an adaptive time grid , especially when the solution of the problem presents steep gradients .",
    "the time grid was computed by means of an a - posteriori error estimation strategy of space - time approximation of a second order in time and fourth order in space elliptic equation which describes the optimal control problem and has the advantage that it is independent of an input control function .",
    "furthermore , a coarse approximation with respect to space of the latter equation gives information on the snapshots one can use to build the surrogate model .",
    "finally , we provided a certification of our surrogate model by means of an a - posteriori error estimation for the error between the optimal solution and the pod solution . + for future work , we are interested in transferring our approach to optimal control problems subject to nonlinear parabolic equations .      k. afanasiev and m. hinze . adaptive control of a wake flow using proper orthogonal decomposition .",
    "_ lecture notes in pure and applied mathematics 216 _ , 317 - 332 .",
    "shape optimization & optimal design , marcel dekker , 2001 .",
    "e. arian , m. fahl and e. sachs .",
    "trust - region proper orthogonal decomposition models by optimization methods . _ in proceedings of the 41st ieee conference on decision and control , las vegas , nevada _ , 2002 , 3300 - 3305 ."
  ],
  "abstract_text": [
    "<S> in this paper we study the approximation of an optimal control problem for linear parabolic pdes with model order reduction based on proper orthogonal decomposition ( pod - mor ) . </S>",
    "<S> pod - mor is a galerkin approach where the basis functions are obtained upon information contained in time snapshots of the parabolic pde related to given input data . in the present work </S>",
    "<S> we show that for pod - mor in optimal control of parabolic equations it is important to have knowledge about the controlled system at the right time instances . </S>",
    "<S> we propose to determine the time instances ( snapshot locations ) by an a - posteriori error control concept . </S>",
    "<S> this method is based on a reformulation of the optimality system of the underlying optimal control problem as a second order in time and fourth order in space elliptic system which is approximated by a space - time finite element method . </S>",
    "<S> finally , we present numerical tests to illustrate our approach and to show the effectiveness of the method in comparison to existing approaches . </S>"
  ]
}