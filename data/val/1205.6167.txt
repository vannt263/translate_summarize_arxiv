{
  "article_text": [
    "functional data analysis has grown in popularity for the last years due to the increasingly data availability for continuous time processes .",
    "typical examples of functional data include the temperature evolution , stock prices and path trajectories for objects in movement .",
    "new statistical methods have been developed to deal with the richer nature of functional data , being @xcite , @xcite and @xcite some of the main reference books in this area . + in many situations , the functional data is related to a scalar variable . for this cases",
    ", it is interesting to assess the relation of the variables via a regression model , which can be used to predict the scalar response from the functional input . analogue to the multivariate situation , the simplest functional regression model corresponds to the functional linear model with scalar response ( see @xcite for a review ) .",
    "+ an interesting methodology approach to deal with functional data is the use of random projections .",
    "the objective is to characterize the behaviour of a functional process , which has infinite dimension , via the behaviour of the one dimensional inner products of the functional process with suitable random functions .",
    "this method has interesting applications for the goodness  of  fit of the distribution of the process , as it can be seen in @xcite .",
    "more recently , @xcite provide a projection  based test for functional covariate effect in a functional regression model with scalar response . in their paper",
    ", the authors adapt the tests of @xcite and @xcite , based on smoothing techniques , to the context of functional covariates .",
    "+ in this work , a first goodness  of  fit test for the null hypothesis of the functional linear model , @xmath0 , being @xmath1 the hilbert space of square integrable functions , is proposed .",
    "the statistic test is of a cramr ",
    "von mises type and is based on a generalization of a previous test of @xcite , designed for the case of a regression model with multivariate covariates .",
    "the test statistic is easy to compute using geometrical arguments and simple to calibrate in its distribution by a wild bootstrap on the residuals .",
    "further , although the test is given for the functional linear model , it can be extended to other functional models with scalar response , as it is based on the residuals of the model . +",
    "this work is organized as follows .",
    "some background on functional data , the functional linear model and the random projections paradigm are introduced in section [ back ] .",
    "the main part of this work is section [ thetest ] , where the theoretical arguments of the test , jointly with the bootstrap calibration procedure , are presented .",
    "the finite sample properties of the test are illustrated by a simulation study in section [ simu ] .",
    "section [ appli ] illustrates the application of the test to two datasets and introduces a graphical tool to evaluate the goodness  of  fit of the functional linear model with scalar response .",
    "final comments and conclusions are given in section [ final ] .",
    "an appendix attached contains omitted proofs , tables and figures .",
    "the main goal of this paper is to propose a goodness  of  fit test for the null hypothesis of the functional linear model with scalar response .",
    "bearing in mind the different nature of the functional variables , some background on functional data , the functional linear model and the use of random projections is introduced .",
    "one of the first and most important problems when we deal with functional data is to choose a suitable functional space to work .",
    "the most used functional spaces are the metric , the banach and the hilbert spaces .",
    "this is a sequence of functional spaces with increasing richer structure , where the tools available for the former space are included in the latter .",
    "specifically , in a metric space we can measure distances between functions ; in addition , in a banach space we can also measure the functions and cauchy sequences are convergent ; and finally , in a hilbert space we have inner product , which allows to consider functional basis . + while there are a lot of types of metrics and norm spaces , the @xmath2 spaces are one of the most used .",
    "the @xmath3 $ ] space , @xmath4 , is defined as the set of all functions @xmath5\\rightarrow{\\mathbb{r}}$ ] such that their norm @xmath6 is finite .",
    "the choice of the interval @xmath7 $ ] is done only to fix the integration limits and other intervals can be considered without major changes .",
    "the most important @xmath2 space corresponds to @xmath8 , because is the only which has an associated inner product @xmath9 such that @xmath10 . for two functions",
    "@xmath11 $ ] , their inner product is defined as @xmath12    in what follows we will consider as our working space the hilbert space @xmath13 $ ] , bearing in mind that @xmath7 $ ] can be trivially replaced by another interval .",
    "the inner product allows for a basis representation of the elements of @xmath1 and , given a functional basis @xmath14 of @xmath1 , then any function @xmath15 in @xmath1 can be expressed by the linear combination @xmath16 , where @xmath17 , @xmath18 .",
    "a basis is said to be orthogonal if @xmath19 , @xmath20 and orthonormal if , in addition , @xmath21 , @xmath18 .",
    "typical examples of basis of @xmath1 are the fourier basis @xmath22 and the b  splines basis ( see @xcite ) . + for the development of the test statistic",
    ", we will also need to introduce a @xmath23truncated basis @xmath24 , which corresponds to the first @xmath23 elements of the infinite basis @xmath14 .",
    "the representation of @xmath15 in this truncated basis is denoted by @xmath25 .",
    "the choice of the number of basis elements @xmath23 is crucial to have a reliable representation of the function @xmath15 by @xmath26 .",
    "although there exists several methods to select an appropriate @xmath23 , we will refer to the gcv criteria ( see @xcite , page 97 ) to select @xmath23 and represent adequately the function @xmath15 in @xmath27 .",
    "this criteria will be used in section [ simu : simp ] to select a suitable @xmath23 for the case of the simple hypothesis .",
    "+ to deal with functional random projections we will need to define the functional analogue of the euclidean @xmath23sphere @xmath28 . in the functional case we have the _ functional sphere _ of @xmath1 , defined as @xmath29 , and the _ functional sphere of dimension @xmath23 _ , which is the set of functions of @xmath1 that , expressed in the @xmath23truncated basis , have unit norm : @xmath30 .",
    "+ the relationship between @xmath31 and @xmath32 is particularly interesting to develop the test .",
    "let be @xmath33 the matrix of inner products of the @xmath23truncated basis , @xmath34 the @xmath23ellipsoid generated by this matrix and @xmath35 the cholesky decomposition of @xmath36 ( a semi  positive matrix ) .",
    "first of all , we have the trivial isomorphism that maps elements of @xmath32 to elements of @xmath37 by means of the functional coefficients : @xmath38 .",
    "recall that functions @xmath39 and @xmath40 are well defined because @xmath41 .",
    "we must consider also a linear transformation from @xmath31 to @xmath37 , which is given by @xmath42 and whose jacobian is @xmath43 , the determinant of the matrix @xmath44 .",
    "+ using these two transformations , the integration of a functional operator @xmath45 with respect to a functional covariate @xmath46 in @xmath32 can be reduced to a real integration on the @xmath23sphere : @xmath47 in the case where the basis is orthonormal , @xmath48 and @xmath49 are the identity matrix of order @xmath23 . then the coefficients of @xmath50 in the basis @xmath24 belong to @xmath31 without any transformation .",
    "suppose that @xmath15 is a functional random variable in @xmath1 and @xmath51 is a real random variable .",
    "if both variables are centred , i.e. , @xmath52}}=0 $ ] for a.e .",
    "@xmath53 $ ] and @xmath54}}=0 $ ] , the functional linear model ( flm ) with scalar response claims for the following relation : @xmath55 where the functional parameter @xmath56 belongs to @xmath1 and @xmath57 is a random variable with zero mean , variance @xmath58 and such that @xmath59}}=0,\\ , \\forall t$ ] .",
    "the prediction of @xmath51 is done with the conditional expectation of @xmath51 given @xmath15 : @xmath60}}={\\left<{\\mathcal{x}},\\beta\\right>}.\\end{aligned}\\ ] ] saying that @xmath61 share the functional linear model is equivalent to saying that the regression function of @xmath51 on @xmath15 , @xmath62 , belongs to the family @xmath63 .",
    "+ given a sample @xmath64 , the estimation of the functional parameter can be done by minimising the residual sum of squares ( rss ) : @xmath65 a possible method to search for the parameter @xmath56 that minimises the rss is representing the functional data and the functional parameter in the truncated functional basis @xmath66 and @xmath67 , respectively : @xmath68 using the vector notation @xmath69 , @xmath70 , @xmath71 , @xmath72 and @xmath73 , the previous representation can be expressed as @xmath74 and @xmath75 .",
    "the functional linear model results in @xmath76 where @xmath77 .",
    "then , basis representation allows to express the flm as a standard linear regression , where the estimated coefficients of @xmath56 in the basis @xmath67 are given by @xmath78 .",
    "although different combinations of @xmath66 and @xmath67 are possible , the usual choice is @xmath79 , being @xmath80 an orthogonal basis because in that case the matrix @xmath81 is diagonal .",
    "+ there are several alternatives to represent the functional process and estimate the parameter @xmath56 in a truncated basis .",
    "for instance , a general review of the estimation based on the use of basis expansions such as fourier series or b  splines can be found in the book by @xcite . the so called functional principal component ( fpc ) regression estimation , proposed by @xcite , provide an orthogonal data  driven basis that gives the most rapidly convergent representation of the functional dataset predictor in a @xmath82 sense ( see @xcite ) . @xcite",
    "have proposed the functional partial least squares ( fpls ) regression method that produces iteratively a sequence of orthogonal functions , as the fpc are , but with maximum predictive performance . to implement any of the methods shown before ,",
    "it is required to fix the number of basis elements ( or components ) that are used in the estimation .",
    "+ the optimal number of components , @xmath23 , has to be fixed based on the information provided by the data .",
    "to do this , @xcite and @xcite use the predictive cross  validation criterion ( pcv ) , @xcite and @xcite consider the generalized cross ",
    "validation criterion ( gcv ) and @xcite and @xcite consider those methods based on the aic , aicc and bic information approaches .",
    "+ let denote by @xmath83 and @xmath84 the prediction of @xmath85 using @xmath23 components with the whole sample and with the whole sample excluding the @xmath86th element , respectively .",
    "the pcv is defined as : @xmath87 which is computationally expensive because it involves the estimation of the @xmath88 @xmath89 times .",
    "this is especially expensive in the case of data  driven basis ( fpc , fpls ) because the basis has to be recalculate for every datum . as an alternative , gcv avoids recalculating the @xmath90 for every datum by introducing a penalty term .",
    "the gcv is defined as @xmath91 where @xmath92 is the number of degrees of freedom consumed by the model , typically given by the trace of the matrix @xmath93 .",
    "gcv is closely related with aic , aicc and bic although they come from different perspectives .",
    "random projections are becoming quite popular when dealing with high dimensional data , as a way to overcome the well known _",
    "curse of the dimensionality_. the main idea behind is to reduce the dimension , and characterize the original distribution of the multidimensional data by the distribution of the randomly projected univariate data . + in the goodness  of  fit field , this is specially interesting , as the test procedures tend to become less efficient , less powerful , when the dimension of the model increases .",
    "@xcite used this technique to develop a goodness  of  fit test for multivariate regression models based on random projections . according to his simulation study",
    ", the test has an excellent power performance and has the best empirical power for most situations when comparing to their competitors .",
    "+ in the functional framework , it is also possible to consider random projections .",
    "usually , this is achieved by considering the inner product of the functional variable @xmath15 of @xmath1 and a suitable family of projectors , i.e. random functions @xmath94 in @xmath1 .",
    "for example , using with this approach @xcite developed some goodness  of  fit tests for parametric families of functional distributions , which includes goodness  of  fit tests for gaussianity and for the black ",
    "scholes model . +",
    "a very interesting result on projections can be found in @xcite . in their paper , the authors provide a characterization of the conditional expectation of a scalar variable @xmath51 with respect to a functional variable @xmath15 given in terms of the conditional expectation of @xmath51 with respect to the projected @xmath15 .",
    "the result is stated here in the following lemma .",
    "[ l1 ] let @xmath51 be a random variable and @xmath15 a functional random variable in the functional space @xmath1 .",
    "the following statements are equivalent :    1 .   @xmath95}}=0 $ ] , for almost every ( a.e . )",
    "[ l1:1 ] 2 .",
    "@xmath97}}=0 $ ] , for a.e . @xmath98 and @xmath99 .",
    "[ l1:2 ] 3 .",
    "@xmath97}}=0 $ ] , for a.e . @xmath98 and @xmath100 , @xmath101 .",
    "the presentation of the goodness  of  fit test that we propose in this paper is divided into three sections .",
    "the first and most important presents the theoretical fundamentals of the test , with starting point in lemma [ p1 ] , which proof is detailed in the appendix .",
    "the second derives the effective implementation of the test statistic in practise considering some geometrical and matrix arguments .",
    "finally , the bootstrap resampling for the calibration of the test statistic is presented in the last section .",
    "let @xmath51 be a real random variable and @xmath15 a functional random variable in the space @xmath1 .",
    "given a random sample @xmath102 , we are interested in checking if a functional linear model is suitable to explain the relation between the functional covariate and the scalar response , i.e. , test for the composite hypothesis : @xmath103 versus a general alternative of the form @xmath104 .",
    "further , the simple hypothesis , i.e. checking for a specific functional linear model : @xmath105 is also of interest as it includes the important case of no interaction between the functional covariate and the scalar response ( considering @xmath106 ) . in what follows we will focus on the procedure for the composite hypothesis , given that the simple is obtained just considering that the functional parameter is known and substituting @xmath107 and @xmath108 by @xmath109 and @xmath110 , respectively .",
    "+ the key point to test the null hypothesis @xmath111 is the following lemma , an adaptation of the lemma [ l1 ] to our setting , which gives the characterization of @xmath111 in terms of the random projections of @xmath15 .",
    "[ p1 ] let @xmath56 be an element of @xmath1 .",
    "the following statements are equivalent :    1 .",
    "@xmath112 , @xmath113 .",
    "[ p1:1 ] 2 .",
    "@xmath114}}=0 $ ] , for a.e . @xmath115 .",
    "[ p1:2 ] 3 .",
    "@xmath116}}=0 $ ] , for a.e . @xmath117 and @xmath118 .",
    "[ p1:3 ] 4 .",
    "@xmath116}}=0 $ ] , for a.e . @xmath117 and @xmath119 , @xmath101 .",
    "[ p1:3b ] 5 .",
    "@xmath120}}=0 $ ] , for a.e . @xmath117 and @xmath118 .",
    "[ p1:4 ] 6 .",
    "@xmath120}}=0 $ ] , for a.e . @xmath117 and @xmath119 , @xmath101 .",
    "[ p1:4b ]    then @xmath111 is characterized by the null value of the moment @xmath120}}$ ] , for a.e . @xmath117 and",
    "@xmath118 ( or @xmath119 , @xmath101 ) and a possible way to measure the deviation of the data from @xmath111 is by the empirical process arising from the estimation of this moment : @xmath121 that will be denoted as the _ residual marked empirical process based on projections _ ( rmpp ) .",
    "the marks of ( [ rmpp ] ) are given by the residuals @xmath122 and the jumps by the projected functional regressor in the direction @xmath94 , @xmath123 .",
    "the estimation of @xmath56 can be done by different methods as described in section [ back ] .",
    "note that the rmpp only depends on the residuals of the model considered ( in this case the residuals of the flm ) and therefore it can be easily extended to other regression models ( see section [ final ] for discussion ) .",
    "+ to measure the distance of the empirical process ( [ rmpp ] ) from zero , two possibilities are the classical cramr ",
    "von mises and kolmogorov  smirnov norms , adapted to the _ projected _ space @xmath124 : @xmath125 where @xmath126 is the empirical cumulative distribution function ( ecdf ) of the projected functional data in the direction @xmath94 ( i.e. the ecdf of the data @xmath123 ) and @xmath127 represents a measure on @xmath128 .",
    "unfortunately , the infinite dimension of the space @xmath128 makes infeasible to compute the functionals ( [ cvm ] ) and ( [ ks ] ) and some kind of discretization is needed .",
    "a solution to this problem is to consider the properties of the hilbert space @xmath1 and use a basis representation .",
    "+ up to this end , let us introduce some notation .",
    "let @xmath14 be a basis of @xmath1 and consider the @xmath23truncated basis @xmath24 , with matrix of inner products @xmath48 .",
    "denote by @xmath129 and @xmath46 the representation of the functions @xmath130 and @xmath94 in the @xmath23truncated basis , with vectors of coefficients @xmath131 and @xmath132 , respectively , and for @xmath133 . using this",
    ", as @xmath14 is any basis , we have that @xmath134 by analogy with the previously defined @xmath126 , we will denote @xmath135 to the ecdf of the projected functional data expressed in the @xmath23truncated basis , both for the projector @xmath94 and for the functional data .",
    "then , the rmpp can be expressed in terms of a @xmath23truncated basis , yielding @xmath136 where @xmath137 represents the coefficients of @xmath107 in the @xmath23truncated basis @xmath24 .",
    "+ bearing in mind this , our test statistic propose is a modified version of ( [ cvm ] ) that results from expressing all the functions in a @xmath23truncated basis of @xmath1 : @xmath138 we have decided to choose the cramr ",
    "von mises statistic because , as we will see , presents important computational advantages and can be adapted to the given framework of @xcite for the finite dimensional case .",
    "the most important advantage is that we can derive an explicit expression where there is no need to compute the rmpp for different projections , property that does not hold for the kolmogorov ",
    "smirnov statistic .",
    "+ using that the integration in the @xmath23sphere of @xmath1 can be expressed as the integration in the @xmath23sphere of @xmath139 via the transformations defined in section [ func ] , we have : @xmath140 where @xmath127 now represents a measure in the @xmath23sphere @xmath31 that , for simplicity purposes , will be considered as the uniform distribution on @xmath31 .",
    "+ essentially , what we have done is to treat the functional process as a @xmath23multivariate process , expressing the functions in a basis of @xmath23 elements . the methods to choose the number of elements @xmath23 and to estimate the parameter @xmath56 both for the simple and for the composite hypothesis are the ones introduced in section [ back ] .",
    "these methods will be illustrated in section [ simu ] .",
    "following the steps of @xcite it is possible to derive a simpler expression for ( [ pcvmp2 ] ) . using the definition of the rmpp in a @xmath23truncated basis , the fact that @xmath141 is the ecdf of @xmath142 and some simple algebra , we have : @xmath143 with @xmath144 .",
    "the terms @xmath145 represent the integrals @xmath146 where @xmath147 and @xmath148 represents the angle between vectors @xmath149 and @xmath150 .",
    "to simplify notation , we denote @xmath151 ( @xmath152 if the basis is orthonormal ) for @xmath153 . depending on @xmath154",
    ", the region @xmath155 can be the whole sphere @xmath31 ( @xmath156 ) , a hemisphere of @xmath31 ( @xmath157 , @xmath158 or @xmath159 ) or a spherical wedge ( see figure b1 in appendix ) of width angle given by @xmath160    thus @xmath145 is the product of the surface area of a spherical wedge of angle @xmath161 times @xmath43 , and is given by @xmath162    we also have a symmetric property , @xmath163 , which simplifies the evaluation of the test statistic from @xmath164 to @xmath165 computations .",
    "the memory requirement is expensive , because we need to store the @xmath166 elements of the three dimensional array @xmath167 , which is symmetric in its two first indexes .",
    "however , this requirement can be stretched if we consider the following expression for the statistic : @xmath168 where @xmath169 is a @xmath170 matrix and @xmath171 is the vector of the residuals . by the definition of @xmath172 and its symmetry in the first two entries , the matrix @xmath173 is symmetric and its diagonal terms are given by @xmath174 .",
    "although the order of computations remains similar , @xmath175 , the memory required for storing the matrix @xmath173 is substantially lower and drops to @xmath176 elements .",
    "this fact improves drastically the time of computation of the statistic and allows to apply the test to larger datasets .",
    "+ again , let us remark that the expression derived for the @xmath177 statistic remains valid for any functional regression model with scalar response and not just for the flm , as the expression is based on the residuals of the model .      to calibrate the distribution of the statistic @xmath177 under the null hypothesis , a wild bootstrap on the residuals",
    "is applied .",
    "this bootstrap procedure is consistent in the finite dimensional case , as it was shown in @xcite , and is adequate to situations with potential heterocedasticity , quite common in functional data .",
    "the resampling process for the case of the composite hypothesis , given an initial estimation @xmath108 of the functional parameter , is the following :    1 .",
    "construct the estimated residuals : @xmath178 .",
    "[ boot1 ] 2 .",
    "draw independent random variables @xmath179 satisfying @xmath180}=0\\text { and } \\mathbb{e}^*{\\left[v_i^{*2}\\right]}=1 $ ] .",
    "for example , if @xmath181 is a discrete random variable with distribution weights @xmath182 @xmath183 , we have the _ golden section bootstrap_.[boot2 ] 3 .",
    "construct the bootstrap residuals @xmath184.[boot3 ] 4 .",
    "set @xmath185 and estimate @xmath186 for the sample @xmath187.[boot4 ] 5 .",
    "obtain the estimated bootstrap residuals @xmath188.[boot5 ]    then , the procedure to calibrate the test is the following . in step [ boot1 ]",
    "we compute the test statistic with the residuals under @xmath111 using the implementation ( [ efficpcvm ] ) of the previous section",
    ". then repeat steps [ boot2][boot5 ] for @xmath189 , computing each time the bootstrap statistic @xmath190 and estimate the @xmath23value of the test by monte carlo : @xmath191 . for computational efficiency",
    ", it is important to note that we do not have to compute again the matrix @xmath173 in the bootstrap replicates . +",
    "a very interesting fact of the flm is that step [ boot5 ] can be easily performed using the properties of the estimation of @xmath108 . from ( [ modlin ] ) it is clear that the vector of coefficients of @xmath108 is estimated throughout @xmath192 .",
    "then , the estimated bootstrap residuals , represented by the vector @xmath193 , can be obtained as @xmath194 , where @xmath195 is the vector of bootstrap responses given in step [ boot4 ] and @xmath196 is the identity matrix of order @xmath23 .",
    "the projection matrix @xmath197 remains the same for all the bootstrap replicates , so it can be stored without the need of computing it again .",
    "obtaining the residuals in this way implies a significative computational saving .",
    "+ the bootstrap resampling in the case of the simple hypothesis is easier : just replace @xmath108 by @xmath110 and omit steps [ boot4 ] and [ boot5 ] , considering @xmath198 .",
    "to illustrate the finite sample properties of the proposed test , a simulation study was carried out for the simple and the composite hypotheses . the functional process considered for the functional covariate",
    "@xmath15 is an ornstein  uhlenbeck process in @xmath7 $ ] , which corresponds to a brownian motion with functional mean @xmath199 and covariance function given by @xmath200 .",
    "we have considered @xmath201 , @xmath202 and the functional mean @xmath203 $ ] .",
    "see figure b2 in appendix for further details . +",
    "all the functional data in this simulation study is represented in @xmath204 equidistant points in the interval @xmath7 $ ] .",
    "the number of bootstrap replicates considered is @xmath205 and the number of monte carlo replicates for determining the empirical sizes and powers , @xmath206 . the sample size , except otherwise stated , is @xmath207 .",
    "lastly , in order to properly compare the effect of the kind of basis , the number of elements and the sample sizes , the initial seed for the random generation of the functional underlying process is the same for each model . + several lengthy tables",
    "have been reduced in this section for space saving .",
    "the reader is referred to the appendix to see the whole tables as well as other explanatory figures .",
    "the simulation study for the simple hypothesis is centred on the case @xmath208 , where @xmath209 $ ] .",
    "this is equivalent to test that the functional covariate @xmath15 has no effect on the scalar response , i.e. , test the null hypothesis @xmath210 .",
    "although there is an extensive collection of goodness  of  fit tests for finite dimensional covariates ( see @xcite ) , the literature for the case of functional covariates is more limited . therefore , we will focus on the competing procedures of @xcite and @xcite to compare the different tests in terms of level and power .",
    "let us describe briefly these two test statistics .",
    "+ @xcite propose a test statistic for @xmath211 , deriving its asymptotic law and giving a bootstrap procedure based on the residuals .",
    "the statistic , inspired in the propose of @xcite , is @xmath212 where @xmath213 is a kernel function , @xmath214 is a semimetric and @xmath215 is the bandwidth parameter .",
    "@xmath216 represents the probability distribution of the functional process and @xmath127 is a suitable weight function .",
    "the test used in our implementation results from considering no functional effect , i.e. @xmath217 , and from approximating the integral with respect to @xmath218 by the empirical mean of the sample .",
    "we have also considered the kernel @xmath219 , being @xmath39 the density of a @xmath220 , the @xmath82 distance in @xmath1 for @xmath214 and the uniform weight function .",
    "the bandwidth parameter is given by the pcv criterion and bootstrap resampling was done using golden wild bootstrap .",
    "+ the other competing test is the one proposed by @xcite and is based on the idea of extending the covariance to functional  scalar data : @xmath221 where @xmath222 is the functional mean of @xmath223 and is @xmath224 the usual scalar mean of @xmath225 .",
    "the authors extend the ideas of the classical @xmath226test to the functional framework , resulting a statistic to test the null hypothesis of no interaction _ inside _ the functional linear model .",
    "the test is consistent and the authors derived the asymptotic distribution of the process @xmath227 , resulting in a brownian motion with mean @xmath228}}$ ] and a particular covariance structure .",
    "this test can be viewed as a possible benchmark in our simulation study and , recalling its similarity with the classical @xmath226test , will be denoted as the _ functional @xmath226test_. the bootstrap resampling was also performed using golden wild bootstrap .",
    "+ three different blocks of deviations from the null are considered .",
    "the first two blocks represent a deviation inside the linear model , i.e. , considering different functions @xmath229 instead of @xmath109 .",
    "the linear functions are @xmath230 , with coefficients @xmath231 , @xmath232 and @xmath233 for @xmath234 and @xmath235 , with @xmath236 , @xmath237 and @xmath238 for @xmath239 .",
    "the second block of deviations from the null hypothesis consists on adding a _ second order _",
    "term @xmath240 to the regression function , thus the model is no longer linear .",
    "different weights for the second term are represented in the alternatives @xmath241 , where @xmath242 , @xmath243 and @xmath244 .",
    "the relation between the variance of the response with respect to the variance of the error can be measured by the _ signal  to  noise ratio _ : @xmath245}}\\right)}$ ] .",
    "for block 1 the snr s of the alternatives are @xmath246 , @xmath247 and @xmath248 , respectively for @xmath234 , @xmath249 . for block 2 ,",
    "the snr s are @xmath250 , @xmath251 and @xmath252 . for block 3",
    ", we have @xmath253 , @xmath254 and @xmath255 .",
    "+ in the case of the simple hypothesis there is no estimation of the parameter @xmath109 , as it is known .",
    "however , it is necessary to express the functional process @xmath23 and the function @xmath109 in a suitable basis in order to compute the test statistic . up to this end , we consider a b  splines basis and we choose automatically its number of elements by the gcv criteria commented in section [ func ] .",
    "+ the results of the study for the simple hypothesis are collected in table [ tab1 ] , which shows the empirical sizes and powers of the functional @xmath226test , the test of delsol et al . and the pcvm test for simple hypothesis , for the models previously commented .",
    "all of the tests seem to calibrate the significance level @xmath256 .",
    "with respect to the power , the functional @xmath226test has in average a superior behaviour in the alternatives @xmath239 , which represents deviations from the null _ inside _ a linear model . the test of delsol et al .",
    "performs also well with the cross ",
    "validatory bandwidth , being the most competitive for the block @xmath234 .",
    "the pcvm test performs worse than the functional @xmath226test for alternatives @xmath234 and @xmath239 and similarly to the test of delsol et al .. nevertheless , for alternatives that are not inside the linear model , the pcvm test results the most powerful .",
    "similar results are obtained with a noise given by a recentred exponential distribution with parameter @xmath257 .",
    ".empirical power of the competing tests for the simple hypothesis @xmath258 , @xmath106 and significance level @xmath256 .",
    "noise follows a @xmath259 and a recentred @xmath260.[tab1 ] [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> in this work , a goodness  of  fit test for the null hypothesis of a functional linear model with scalar response is proposed . </S>",
    "<S> the test is based on a generalization to the functional framework of a previous one , designed for the goodness  of  fit of regression models with multivariate covariates using random projections . </S>",
    "<S> the test statistic is easy to compute using geometrical and matrix arguments , and simple to calibrate in its distribution by a wild bootstrap on the residuals . </S>",
    "<S> the finite sample properties of the test are illustrated by a simulation study for several types of basis and under different alternatives . </S>",
    "<S> finally , the test is applied to two datasets for checking the assumption of the functional linear model and a graphical tool is introduced . </S>",
    "<S> supplementary materials are available online .    </S>",
    "<S> * keywords : * functional data ; goodness  of  fit ; functional linear model ; bootstrap calibration . </S>"
  ]
}