{
  "article_text": [
    "a key ingredient of lattice qcd simulations is the inversion of the dirac operator which enters the generation of unquenched gauge field configurations and the computation of hadronic observables .",
    "one needs to solve numerically a linear system of the form @xmath0+m)_{x , y}\\ s(y ) = \\eta(x ) \\label{eq : linsysunprec}\\end{aligned}\\ ] ] where @xmath1 $ ] is the chosen discretization of the massless interacting dirac operator , @xmath2 is the quark mass in lattice units , @xmath3 is a source vector that is different from zero on a single time - slice ( that without any loss we shall assume to be at @xmath4 ) . the solution @xmath5 is obtained by iterative numerical algorithms , solvers , devised to invert so - called sparse matrices , like the matrices that result from the discretization of differential equations by finite differences methods . in this letter",
    "we shall not discuss the details of any particular solver ( see ref .",
    "@xcite for a complete review and for an updated list of references ) . for any solver",
    "one checks if the condition @xmath6+m)_{x , y}\\ s^n(y ) - \\eta(x ) \\right\\vert < r \\label{eq : stopping}\\end{aligned}\\ ] ] is satisfyed . here",
    "@xmath7 is the tentative solution at iteration number @xmath8 , the norm is any good norm in field space and @xmath9 , the residue , is the global numerical accuracy requested for the solution .",
    "typically @xmath9 is a small number of the order of the arithmetic precision allowed by the computer architecture .",
    "depending on the values of the quark mass the solution of eq .",
    "( [ eq : linsysunprec ] ) poses different numerical problems . for light quarks the matrix @xmath10+m)_{x , y}$ ]",
    "is badly conditioned and its numerical inversion requires a big number of iterations . at the other extreme ,",
    "the number of iterations required for heavy quark masses is small but there may be problems with the numerical accuracy resulting for the time - slices far away from the source ( @xmath11 ) . indeed",
    "( [ eq : stopping ] ) is a",
    "_ global _ condition while for heavy quark propagators the time - slices far away from the source are exponentially suppresed by a factor of the order of @xmath12 and give a negligible contribution to the norm on the left side of eq .",
    "( [ eq : stopping ] ) .",
    "when this problem arises one can not trust numerical results at large times and it becomes impossible to extract physical informations by fitting the leading exponentials contributing to correlation functions .    in order to alleviate both difficulties , we propose a preconditioning of the dirac operator that factorises from the propagator a function aiming to modify its leading decay with the distance .",
    "the simplest choice is to factorize a function @xmath13 , to solve numerically the preconditioned equation , and to restore the original propagator by multiplying each time slice for @xmath14 .",
    "@xmath13 is defined such that all the different time - slices give comparable contributions to the calculation of the residue in the preconditioned case .",
    "our preconditioning is inspired to what is usually done in deriving the eichten and hill  @xcite lattice hqet action but of course does not introduce any approximation . indeed , the choice above is suited for heavy quark propagators , while for light quark masses we will introduce a generalisation of the factorised function .",
    "we work with the @xmath15-improved wilson lattice dirac operator but the numerical problems that we address arise also with alternative discretisations of the continuum action and the proposed solution can as well be easily implemented in those cases .",
    "we have tested our preconditioning scheme both for heavy and for light quark masses and in the free and in the interacting case .",
    "we start with the results for the heavy quarks .",
    "we first want to pick up a case where the problem arises . as an example",
    ", we have calculated the correlation function @xmath16}\\end{aligned}\\ ] ] by solving eq .",
    "( [ eq : linsysunprec ] ) for a heavy quark propagator of mass @xmath17 in the free theory for different choices of the residue .",
    "more precisely the red points in fig .",
    "[ fig : treeuncorrect1 ] have been obtained with a residue @xmath18 while the black points with a residue @xmath19 and the two black lines correspond to the squares of these two values of @xmath9 . as is clearly visible from fig .",
    "[ fig : treeuncorrect1 ] , and from fig .",
    "[ fig : treeuncorrect2 ] where we show the effective masses of the correlations shown in fig .",
    "[ fig : treeuncorrect1 ] , the black points start to deviate from the red ones for @xmath20 , i.e. when the correlator , which in this case is just the square module of the propagator , becomes smaller than the square of the `` loose '' residue @xmath19 .",
    "if the time extent of the lattice is not too large the problem can be solved by brute force by lowering the residue and the results obtained in the preset case with @xmath18 can be considered as exact . if instead the time extent of the lattice is rather large the brute force approach can not be considered because the required residues would be smaller than what is allowed on double - precision architectures , even in the case of moderately heavy quarks . in the case under consideration , by choosing a loose precision , i.e. a residue @xmath19 , we make the numerical problem evident and we show that also such an `` extreme '' situation can be recovered by using our proposal .",
    "moreover , we notice that a residue @xmath19 is the smallest allowed on single - precision architectures that presently are considerably much faster than double - precision ones .",
    "we now come to the proposed solution .",
    "we redefine the quark fields and the propagators as follows @xmath21 once the previous expressions are inserted in eq .",
    "( [ eq : linsysunprec ] ) we get the preconditioned system @xmath22+m)_{x , y}\\ s^\\prime(y ) = \\eta^\\prime(x ) \\label{eq : linsysprec}\\end{aligned}\\ ] ] that we solve numerically in place of eq .",
    "( [ eq : linsysunprec ] ) . in order to write the preconditioned dirac operator it is sufficient to modify the forward and backward lattice covariant derivatives in the time direction accoring to @xmath23 particular care has to be used at the boundaries of the lattice in order to respect the boundary conditions originally satisfied by the quark fields . if as in the case of fig .",
    "[ fig : treeuncorrect1 ] @xmath5 satisfies anti - periodic boundary conditions along the time direction , it follows from eq .",
    "( [ eq : redeft ] ) that @xmath24 the blue points in fig .",
    "[ fig : treeuncorrect1 ] correspond to the correlation function @xmath25}\\end{aligned}\\ ] ] obtained by solving eq .",
    "( [ eq : linsysprec ] ) with the loose residue @xmath19 but after having factorized the function @xmath26 \\label{eq : pbcalpha}\\end{aligned}\\ ] ] by setting @xmath27 .",
    "as expected , the preconditioned correlator stays above the line of the loose precision residue and the `` exact '' result can be back recovered as follows @xmath28 ^ 2\\ c_{pp}^\\prime(y_0 ) \\label{eq : backcorrection}\\end{aligned}\\ ] ] in fig .",
    "[ fig : treeuncorrect2 ] the blue points correspond to the effective mass of the preconditioned correlator after the `` restoration '' of eq .",
    "( [ eq : backcorrection ] ) and fall exactly on top of the red ones in spite of the fact that they have been obtained with the same loose precision that affected the non preconditioned black points .        in fig .",
    "[ fig : iuncorrect ] we show the same plot as in fig .",
    "[ fig : treeuncorrect2 ] but in the interacting theory .",
    "the gauge ensamble used correspond to the entry @xmath29 in table  [ tab : iterations ] .",
    "the size of the lattice is @xmath30 and the hopping parameter of the sea quarks is @xmath31 corresponding to a pcac quark mass of about @xmath32 .",
    "the data shown in fig .",
    "[ fig : iuncorrect ] correspond to a pseudoscalar - pseudoscalar correlator , as in the free theory case , of two degenerate heavy quarks with hopping parameters @xmath33 corresponding to a pcac quark mass of about @xmath34 .",
    "the unpreconditioned correlators decay approximately as fast as in the free theory case and from the difference of the black ( unpreconditioned , @xmath19 ) and red ( unpreconditioned , @xmath18 ) sets of data we see the same distortion of fig .",
    "[ fig : treeuncorrect2 ] .",
    "the blue points have been obtained by solving eq .",
    "( [ eq : linsysprec ] ) after having factorized @xmath13 with @xmath27 and by restoring the results according to eq .",
    "( [ eq : backcorrection ] ) .",
    "also in the interacting theory the blue points are identical to red points though they have been obtained with the same loose residue @xmath19 used to obtain the black points .",
    "we close this section by observing that our preconditioning technique may be particularly useful when working with the schrdinger functional  @xcite formulation of the theory . in this case ,",
    "countrary to the case of periodic boundary conditions along the time direction , the correlators decay exponantially over the whole time extent of the lattice and one has to choose very small residues also in computing relatively light quark propagators .",
    "we have performed several succesful experiments with our preconditioning technique also in the schrdinger functional case by using @xmath35 .",
    "ccccccc @xmath36 & @xmath37 & @xmath38 & @xmath39 & @xmath40 & @xmath41 & iterations +   + @xmath42 & 5.3 & @xmath43 & 0.13625 & @xmath44 & 0.0 & 175 + @xmath42 & 5.3 & @xmath43 & 0.13625 & @xmath44 & 0.4 & 141 + @xmath45 & 5.3 & @xmath46 & 0.13605 & @xmath47 & 0.0 & 99 + @xmath45 & 5.3 & @xmath46 & 0.13605 & @xmath47 & 0.2 & 78 + @xmath45 & 5.3 & @xmath46 & 0.13605 & @xmath47 & 0.4 & 69 + @xmath48 & 5.3 & @xmath46 & 0.13610 & @xmath47 & 0.0 & 115 + @xmath48 & 5.3 & @xmath46 & 0.13610 & @xmath47 & 0.2 & 91 + @xmath48 & 5.3 & @xmath46 & 0.13610 & @xmath47 & 0.4 & 81 + @xmath29 & 5.3 & @xmath46 & 0.13625 & @xmath47 & 0.0 & 194 + @xmath29 & 5.3 & @xmath46 & 0.13625 & @xmath47 & 0.2 & 153 + @xmath29 & 5.3 & @xmath46 & 0.13625 & @xmath47 & 0.4 & 141 +    in this section we shall briefly discuss how the ideas developed and discussed in the previous section can be used to accelerate the numerical calculation of light quark propagators .",
    "we start our discussion by generalizing eq .",
    "( [ eq : redeft ] ) as follows @xmath49 in the following we shall consider the particular choice @xmath50 } } \\label{eq : betaa}\\end{aligned}\\ ] ] and the preconditioned lattice dirac operator can be obtained as easily as before by changing all the covariant derivatives according to @xmath51 and by changing accordingly the boundary conditions in all directions as done in eqs .",
    "( [ eq : redeftbc ] ) for the time direction",
    ".    an important difference of the present case with respect to the one discussed in the previous section is that the restoration of the true propagator must be performed before making the contractions needed to build correlation functions by using the first of eqs .",
    "( [ eq : redefa ] ) .",
    "here the preconditioning is not to gain precision , but to accelerate the convergence of the inversion .",
    "therefore , by applying eqs .",
    "( [ eq : redefa ] ) , ( [ eq : betaa ] ) and ( [ eq : redefcovs ] ) to the calculation of a light quark propagator one aims to make the propagator to decay faster than the original unpreconditioned operator . by judiciously chosing the parameter @xmath41 it is possible to change the condition number of the preconditioned system without compromising the numerical accuracy of the solution , an operation that should be performed on double - precision computer architectures .    in table",
    "[ tab : iterations ] we quantify the gain in computational time that can be achieved by showing the number of iterations of the sap+gcr solver required to solve the lattice dirac equation for light quarks with and without our preconditioning .",
    "the sap+gcr solver has been introduced and explained in details by the author in ref .",
    "the gauge ensambles used to perform this test have been generated within the cls agreement  @xcite with the parameters given in the table . in the case of the @xmath52-lattices",
    "the sap+gcr solver has been ran on @xmath53 processors of a cluster of pc s by dividing the global lattices into blocks of @xmath54 points . in the case of the @xmath55-lattice",
    "the sap+gcr solver has been ran on @xmath56 processors of a cluster of pc s by dividing the global lattices into blocks of @xmath57 points .",
    "the table shows that by increasing the value of the parameter @xmath41 the number of iterations goes down with a time gain that can easily reach the @xmath58 . in the case under discussion",
    ", we checked that higher values of @xmath41 would induce a `` heavy quark '' like behavior and produce distorted results for the reasons discussed at lenghty in the previous section .",
    "9 m.  luscher , arxiv:1002.4232 [ hep - lat ] .",
    "e.  eichten and b.  r.  hill , phys .",
    "b * 234 * ( 1990 ) 511 .",
    "a.  juttner and m.  della morte , pos * lat2005 * ( 2006 ) 204 [ arxiv : hep - lat/0508023 ] .",
    "b.  joo , r.  g.  edwards and m.  j.  peardon , arxiv:0910.0992 [ hep - lat ] .",
    "m.  luscher , r.  narayanan , p.  weisz and u.  wolff , nucl .",
    "b * 384 * ( 1992 ) 168 [ arxiv : hep - lat/9207009 ] .",
    "s.  sint , nucl .",
    "b * 421 * ( 1994 ) 135 [ arxiv : hep - lat/9312079 ] .",
    "m.  luscher , comput .",
    "commun .",
    "* 156 * ( 2004 ) 209 [ arxiv : hep - lat/0310048 ] ."
  ],
  "abstract_text": [
    "<S> we propose a preconditioning of the dirac operator based on the factorisation of a predefined function related to the decay of the propagator with the distance . </S>",
    "<S> we show that it can improve the accuracy of correlators involving heavy quarks at large distances and accelerate the computation of light quark propagators . </S>"
  ]
}