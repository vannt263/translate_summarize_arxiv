{
  "article_text": [
    "there has been much work on the issue of unlabeled data in classification problems .",
    "some papers , such as @xcite , have taken the point of view that the data is missing , due to some deficiency in the data collection process , while others , such as @xcite , are aimed at situations in which some observations are deliberately left unlabeled .",
    "the latter approach is motivated by the fact that in many applications it is very difficult or expensive to determine class membership .",
    "thus @xcite proposed that in part of the training set , class membership be left undetermined .",
    "the unlabeled observations would still provide information on the marginal distribution of the features , and it was shown that this information can contribute to increased classification accuracy for future observations .    in the present work , it is again assumed that we have both labeled and unlabeled data , but the focus is on estimation of the class prior probabilities rather than estimation of the classification function .",
    "we wish to estimate those probabilities via a mixture of labeled and unlabeled data , in order to economize on the time and effort needed to acquire labeling information .",
    "for example , consider the geographic application in @xcite .",
    "our class variable here is forest cover type , representing one of seven classes .",
    "suppose we wish to estimate the population proportions of the various cover types .",
    "the authors note that a problem arises in that cover data is generally `` directly recorded by field personnel or estimated from remotely sensed data ... [both of which ] may be prohibitively time consuming and/or costly in some situations . ''",
    "however , various feature variables are easily recorded , such as elevation , horizontal distance to the nearest roadway and so on . previous work in the estimation of classification functions suggests that we may use this other data , without labeling , as a means of reducing the time and effort needed to determine class membership .    as another example , consider the patent analysis reported in @xcite . the overall goal was to estimate the proportion of patents whose research was publicly funded",
    "so , we would have just two classes , indicating public funding or lack of it .",
    "the determination of which patents were publicly funded involved inspection of not only the patents themselves , but also the papers cited in the patents , a very time - consuming , human - intensive task . however , using the approach discussed here , we could define our features to consist of some key words which have some predictive power for public funding status , such as appearance of the word _",
    "university _ in the assignee section of the patent document , and then use the feature data to help achieve our goal of estimating the class probabilities .    specifically , one might develop a classification rule from the labeled observations , and then use the rule to classify the remaining observations in the training set . in other words , we would find predicted forest cover types for each of the unlabeled observations . finally , one would obtain estimates for the proportions of forest cover types in the full training set , using the predicted cover types for those on which labels had not been collected .",
    "actually , one can do even better by using estimated conditional class probabilities of the unlabeled and labeled observations , as will be proven here .",
    "let us set some notation .",
    "suppose there are c classes , and let @xmath0 be the class identification vector , so that @xmath1 is 1 or 0 , according to whether the item belongs to class j. take on the values @xmath2",
    ". however , the statistics notation will be convenient here in various ways , e.g. that @xmath3 is simply @xmath4 .",
    "] let @xmath5 be the feature vector .",
    "for some observations in our training set , we will have data on both @xmath6 and @xmath7 , but others will be unlabeled , i.e. we will have data only on @xmath6 . in our context here , our goal is to estimate @xmath8 , the prior probability of class j.    the key point is that the unlabeled observations provide additional information on the marginal distribution of @xmath6 .",
    "since in the law of total expectation , @xmath9 $ ] , the outer expectation is with respect to x , the better our estimate of the marginal distribution of @xmath6 , the better our estimate of @xmath10 .",
    "thus using the two data sets in concert can give us more accurate estimates of the target quantity , @xmath10 , than can the labeled set alone .",
    "in this paper such estimates will be developed and analyzed .",
    "it is important to note that that not only do we want to be able to estimate @xmath10 , but we also may need a measure of the accuracy of our estimates .",
    "most journals in the sciences , for example , want statistical inference to accompany findings , in the form of confidence intervals and hypothesis tests .",
    "this issue is also addressed in this paper .",
    "in addition , we may be interested in estimating subclass probabilities , again using labeled and unlabeled data .",
    "for instance , we may wish to compare the rates of public funding of patents in the computer field on one hand , and in the optics field on the other .",
    "section [ me ] first notes that the statistical literature , such as @xcite and @xcite , contains some semiparametric methodology which is related to our goals . a typical case here might be the popular logistic model,@xcite , especially in settings with continuous features such as in the forest example .",
    "asymptotic distributions are derived for our estimators of class prior probabilities in section [ mv ] , and that section also proves that the use of unlabeled data does reduce asymptotic variance in estimating the priors .",
    "the question then arises as to how much reduction in asymptotic variance can be attained .",
    "an analyst faced with a real data set must decide whether the method proposed here will work well in his / her particular setting .",
    "is it worth collecting some unlabeled data ?",
    "in section [ assessing ] techniques are developed for assessing this .",
    "these techniques may also be useful for the original application of unlabeled data , which was to enhance the accuracy of classification function estimators .",
    "section [ empirical ] assesses how well the method introduced here for estimating @xmath10 works on some real data sets .",
    "the remainder of the paper covers variations .",
    "section [ subclass ] addresses the subclass problem , and section [ discrete ] treats the case of purely discrete features .",
    "asymptotic inference methodology is again developed , and again it is proven that asymptotic variance is reduced .",
    "finally , section [ dsc ] will discuss possible extensions of these approaches .",
    "denote ithe @xmath11 observation in our data by @xmath12 . keep in mind that @xmath13 and @xmath14 are vectors , of length c and f.",
    "we will assume that the first r observations are labeled but the remainder are not .",
    "in other words , @xmath13 is known for i = 1, ... ,r but unknown for i = r+1, ... ,n .",
    "let @xmath15 denote the value of @xmath1 in observation i , i.e. the value of component j in @xmath13 .",
    "as statistical inference is involved , we will be determining asymptotic distributions of various estimators , as @xmath16 .",
    "it is assumed that the ratio @xmath17 goes to the limit @xmath18 as @xmath19 .",
    "the main analysis will be semiparametric .",
    "this means that we assume that it has been determined that the conditional class membership probability functions belong to some parametric family @xmath20 , i.e. that    @xmath21    for some vector - valued parameter @xmath22 , but we assume no parametric model for the distribution of x.    in the material that follows , the reader may wish to keep in mind the familiar logistic model ,    @xmath23    where t includes a constant component and t denotes matrix transpose .",
    "the estimator @xmath24 for the population value @xmath22 is obtained from @xmath25 via the usual iteratively reweighted least squares method , with weight function    @xmath26}\\ ] ]    that is , the estimator is the root of    @xmath27    where @xmath28 is the vector of partial derivatives of g with respect to its second argument",
    ".    routines to perform the computation are commonly available , such as the glm function in the r statistical package , with the argument * family = binomial*.    since the law of total expectation implies that    @xmath29 = e[g(x,\\theta_j)]\\ ] ]    we take as our new estimator of @xmath30    @xmath31    this will be compared to the classical estimator based on the labeled data ,    @xmath32",
    "we will assume that g satisfies the necessary smoothness conditions , such as the ones given in @xcite , and that the means exist and so on .",
    "[ thm1 ]    define    @xmath33    and    @xmath34\\ ] ]    then @xmath35 is asymptotically equivalent to    @xmath36   % \\end{split}\\ ] ]    write    @xmath37\\ ] ]    form the taylor expansion of @xmath38 around the point @xmath22 .",
    "then there is a @xmath39 between @xmath22 and @xmath24 such that    @xmath40   \\\\ & + & \\left [    n^{-1 } \\sum_{i=1}^n g'(x_i,\\tilde{\\theta_j } )   \\right ] ^t ~ n^{\\frac{1}{2 } } ( \\hat{\\theta}_j - \\theta_j ) \\\\ & = & c_n + d_n\\end{aligned}\\ ] ]    the @xmath41 term converges in distribution , by the central limit theorem .",
    "what about @xmath42 ?",
    "it is well established , for example in @xcite , that @xmath43 is asymptotically equivalent to    @xmath44    meanwhile ,    @xmath45    thus @xmath42 is asymptotically equivalent to    @xmath46\\ ] ]    by slutsky s theorem [ @xcite ] .",
    "so @xmath47 is @xmath48 , and thus the same is true for @xmath49 .",
    "the result follows .    we can now determine the asymptotic variance of @xmath50 :    the asymptotic variance of @xmath51 is    @xmath52 +   \\frac{1}{r } b_j^t a_j^{-1 } b_j\\ ] ]    write ( [ qasy ] ) as @xmath53 , where    @xmath54    and    @xmath55    let us first establish that @xmath56 and @xmath57 are uncorrelated . to show this , let us find the expected value of the product of two minor terms . again applying the law of total expectation ,",
    "write    @xmath58 \\nonumber \\\\   & = & e \\left [   e \\left ( g(x,\\theta_j )   w(x,\\theta_j ) \\ { y(j ) - g(x,\\theta_j ) \\ }   g'(x,\\theta_j )    & = & e   \\left [   g(x,\\theta_j )   w(x,\\theta_j ) e \\left ( y^{(j ) } - g(x,\\theta_j ) | x \\right ) g'(x,\\theta_j ) \\right ] \\nonumber \\\\ & = & 0\\end{aligned}\\ ] ]    from ( [ ygivenx ] ) .    for a random vector w ,",
    "let cov(w ) denote the covariance matrix of w. the law of total expectation can be used to derive the relation    @xmath59 + cov[e(r|s)]\\ ] ]    for random vectors @xmath60 and @xmath61 .",
    "apply this with @xmath62 and    @xmath63    then @xmath64 .",
    "also    @xmath65 g'(x,\\theta_j ) g'(x,\\theta_j)^t a_j^{-1 }   b_j \\\\ & = &   r^{-1 } b_j^t   a_j^{-1 }   w(x,\\theta_j ) g'(x,\\theta_j ) g'(x,\\theta_j)^t a_j^{-1 }   b_j \\\\\\end{aligned}\\ ] ]    from ( [ wdef ] ) .",
    "this yields    @xmath66   = r^{-1 } b_j^t   a_j^{-1 }   b_j\\ ] ]    from ( [ ajdef ] ) .",
    "therefore the asympotic variance of @xmath50 is as given in ( [ av ] ) .",
    "statistical inference is then enabled , with @xmath67 being approximately normally distributed .",
    "the standard error is obtained as the square root of the estimated version of the quantities in ( [ av ] ) , taking for instance    @xmath68 = \\frac{1}{n } \\sum_{i=1}^n [ g(x_i,\\hat{\\theta_j } ) - \\hat{q_j}]^2\\ ] ]    an approximate 100(1-@xmath69)% confidence interval for @xmath70 is then obtained by adding and subtracting @xmath71 times the standard error , where @xmath72 is the standard normal distribution function .    the asympotic variance of the estimator based on both the labeled and unlabeled data , @xmath51 , is less than or equal to that of the estimator based only on labeled data , @xmath73 . the inequality is strict as long as the random variable @xmath74 is not constant .",
    "if we were to use only the labeled data , the asympotic variance of our estimator of @xmath70 would be the result of setting n = r in ( [ av ] ) , i.e.    @xmath75\\ ] ]    comparing ( [ av2 ] ) and ( [ av ] ) , we see that use of the unlabeled data does indeed yield a reduction in asympotic variance , by the amount of    @xmath76    it was proven in @xcite that even with no unlabeled data , the asympotic variance of ( [ qhatj ] ) is less than or equal to that of @xmath73 .",
    "( this result was later sharpened and extended by @xcite . )",
    "the claimed relation then follows .",
    "clearly , the stronger the relationship between @xmath6 and y , the greater the potential improvement that can accrue from use of unlabeled data .",
    "this raises the question of how to assess that potential improvement .",
    "one approach would be to use a measure of the strength of the relationship between @xmath6 and @xmath7 itself .",
    "a number of such measures have been proposed , such as those described in @xcite .",
    "many aim to act as an analog of the @xmath77 value traditionally used in linear regression analysis . here",
    "we suggest what appears to be a new measure , whose form more directly evokes the spirit of @xmath77 .",
    "consider first random variables u and v , with v being continuous .",
    "if we are predicting v from u , the population version of @xmath77 is    @xmath78 - e \\left [ \\{v - e(v|u)\\}^2 \\right ] } { e \\left [ ( v - ev)^2 \\right ] } \\ ] ]    this is the proportional reduction in mean squared prediction error attained by using u , versus not using it .",
    "can be shown to be the correlation between v and @xmath79 . ]",
    "the analog of this quantity in the case of binary v could be defined to be the proportional reduction in classification error . to determine this",
    ", note that without u , we always predict v to be 1 if @xmath80 ; otherwise our prediction is always 0 .",
    "the probability of misclassification is then @xmath81 .",
    "similarly , the conditional probability of misclassification , given u , is @xmath82 $ ] , and the unconditional probability , still using u , is the expected value of that quantity .",
    "accordingly , we take our binary - v analog of @xmath77 to be    @xmath83 } { \\min(ev,1-ev)}\\ ] ]    applying jensen s inequality to the convex function @xmath84 , and using @xmath85 $ ] , we have that    @xmath86 \\leq \\min(ev,1-ev)\\ ] ]    thus @xmath87 , as with @xmath77 .",
    "one could use @xmath88 as a means of assessing whether to make use of unlabeled data .",
    "another approach , motivated by ( [ improvement ] ) , would be to use    @xmath89    note that in the extreme case @xmath90 , @xmath91 is a constant and @xmath92 , so unlabeled data would be useless .",
    "note too that since @xmath93 , this measure @xmath94 is in some sense scale - free .",
    "accordingly , we might base our decision as to whether to use unlabeled data on ( [ varghat ] ) , making use of the unlabeled data if this quantity is sufficiently far from 0 .",
    "rather than merely presenting some examples of our methodology s use on real data , we aim here to assess the methodology s _ performance _ on real data . the bootstrap will be used for this purpose .",
    "( the reader should note that this is intended just a means of assessing the general value of the methodology , rather than part of the methodology itself . )",
    "suppose we wish to study the efficiency of estimating some population value @xmath95 using @xmath96 , an asymptotically unbiased function of a random sample of size s from the population .",
    "we are interested in studying the efficiency of @xmath96 for various sample sizes s , as measured by mean squared error    @xmath97\\ ] ]    now suppose we have an actual sample of size h from the population .",
    "we take this as the `` population , '' and then draw m subsamples of size s. in the i@xmath98 of these subsamples , we calculate @xmath96 , denoting its value by @xmath99 .",
    "the point is that the empirical c.d.f . of the @xmath99 , i = 1, ... ,m , is an approximation to the true c.d.f . of @xmath96 .",
    "moreover ,    @xmath100    is an estimate of the true mean squared estimation error , ( [ msenu ] ) .",
    "this bootstrap framework was used to study the the efficiency of our classification probability estimator @xmath51 . on each of three real data sets ,",
    "the ratio was computed of the estimated mse for @xmath51 to that resulting from merely using @xmath73 and the labeled data .",
    "figure [ pima ] below shows the estimated mse ratios for the pima indians diabetes data in the uci machine learning repository , @xcite .",
    "( the figures here have been smoothed using the r * lowess ( ) * function . ) here we are predicting whether a woman will develop diabetes , using glucose and bmi as features .",
    "the methodology developed here brings as much as a 22 percent improvement .",
    "as expected , the improvement is better for larger values of n - r . in other words , for each fixed number r of labeled observations , the larger the number n - r of unlabeled observations , the better we do . on the other hand , for each fixed number of unlabeled observations , the smaller the number of labeled observations , the better ( since n - r is a larger proportion of r ) .        figure [ abalone ] shows similar behavior for another famous uci data set , on abalones .",
    "we are predicting whether the animal has less than or equal to nine rings , based on length and diameter .        as pointed out in section [ assessing ] , our method here may produce little or no improvement for some data sets .",
    "here is an example , from the 2000 census data , @xcite .",
    "the data consist of records on engineers and programmers in silicon valley , and we are using age and income to predict whether the worker has a graduate degree . the results , seen in figure [ pumsfig ] , show that our methodology produces essentially no improvement in this case .",
    "now let us examine the two possible measures proposed in section [ assessing ] , in the context of the above three data sets .",
    "table [ worthit ] shows the results , which are rather striking . even though the misclassification rate , @xmath88 , was approximately equal across the three data sets , the value of @xmath101 was an order of magnitude smaller for pums than for the other two data sets .",
    "the latter pattern exactly reflects the pattern we saw in the mse values in the figures .    in other words , classification power by itself does not suffice to indicate whether our method yields an improvement .",
    "it is also necessary that the feature vector @xmath6 have a substantial amount of variation .",
    "the measure @xmath94 provides a direct assessment of the potential for improvement .",
    ".comparison of measures proposed in section [ assessing ] [ cols=\"<,<,<\",options=\"header \" , ]",
    "here the focus will be on quantities of the form    @xmath102    for various sets w of interest .",
    "it was mentioned earlier , for instance , that one may wish to compare the proportions of public funding for subcategories of patents , say computers and optics . here",
    "we outline how the methodology developed earlier in this paper can be extended to this situation , focusing on the semiparametric case .",
    "write ( [ sbc ] ) as    @xmath103}{p(x \\epsilon w)}\\ ] ]    where @xmath104 is the indicator function for membership in w. by analogy with ( [ qhatj ] ) , then , our estimator for @xmath105 is    @xmath106    the `` ordinary '' estimator , based only on labeled @xmath7 values , is    @xmath107    the asymptotic variance of @xmath108 is    @xmath109 +   \\frac{1}{r }   c_j^t a_j^{-1 } c_j\\ ] ]    since    @xmath110    we can again apply slutsky s theorem and derive the asymptotic distribution of @xmath108 . toward that end , define    @xmath111\\ ] ]    and concentrate for the moment on estimating @xmath112 , using    @xmath113    the analog of ( [ taylor ] ) is then    @xmath114   \\\\ & + & \\left [    n^{-1 } \\sum_{i=1}^n g'(x_i,\\tilde{\\theta}_j ) i_w(x_i ) \\right ] ^t ~ n^{\\frac{1}{2 } } ( \\hat{\\theta}_j - \\theta_j ) \\nonumber\\end{aligned}\\ ] ]    for some @xmath39 between @xmath22 and @xmath24 .",
    "proceeding as in ( [ qasy ] ) we have that @xmath115 is asympotically equivalent to    @xmath116\\ ] ]    where    @xmath117\\ ] ]    thus @xmath118 is asympotically equivalent to    @xmath119\\ ] ]    continuing as before , the desired result follows :    @xmath120 +   \\frac{1}{r }   c_j^t a_j^{-1 } c_j   \\right ] \\ ] ]    the asympotic variance of the estimator based on both the labeled and unlabeled data , @xmath121 , is less than or equal to that of the estimator based only on labeled data , @xmath122 .",
    "the inequality as strict as long as the random variable @xmath123 is not constant .",
    "define @xmath124 .",
    "theorem [ thm1 ] , applied to h and @xmath125 rather than g and @xmath6 , shows that    @xmath126    has asympotic variance less than that of    @xmath127    the result then follows by applying slutsky s theorem to the denominators in ( [ qhatjw ] ) and ( [ ordinary ] ) , and noting ( [ zz ] ) .",
    "suppose @xmath6 is discrete , taking on b vector values @xmath128 .",
    "we assume here that our labeled data is extensive enough that for each k , there is some i with @xmath129 .",
    "then we can find direct estimates of the @xmath70 without resorting to using a parametric model or smoothing methods such as nearest - neighbor .",
    "we can write the prior probabilities as    @xmath130    where @xmath131 and @xmath132x@xmath133 .",
    "let @xmath134 be the indicator variable for @xmath129 , for i = 1, ... ,n and k = 1, ... ,b",
    ". then denote the counts of labeled and unlabeled observations taking the value k by    @xmath135    and    @xmath136    also define the count of class - j observations among the labeled data having feature value k :    @xmath137    we can estimate the quantities @xmath138 and @xmath139 by    @xmath140    and    @xmath141    our estimates of the class prior probabilities are then , in analogy to ( [ prioreqn ] ) ,    @xmath142    note that if we do not use unlabeled data , this estimate reduces to the standard estimate of @xmath8 , the class sample proportion @xmath73 , in ( [ ybarj ] ) .",
    "the quantities @xmath143 , @xmath144 and @xmath145 have an asympotically multivariate normal distribution .",
    "thus from the multivariate version of slutsky s theorem is asympotically equivalent to    @xmath146    this is a key point in addressing the question as to whether the unlabeled data provide our estimators with smaller asympotic variance .",
    "since the only randomness in ( [ gjhconst ] ) is in the @xmath147 , the larger the sample used to calculate those quantities , the smaller the variance of ( [ gjhconst ] ) will be .",
    "using the unlabeled data provides us with that larger sample , and thus ( [ gjhconst ] ) will be superior to ( [ ybarj ] ) .    stating this more precisely , the variance of ( [ gjhconst ] ) is    @xmath148    without the unlabeled data",
    ", this expression would be the same but with a factor of 1/r instead of 1/n .",
    "so , again , it is demonstrated that use of the unlabeled data is advantageous .    to form confidence intervals and hypothesis tests from ( [ ourest ] )",
    ", we obtain a standard error by substituting @xmath149 and @xmath150 in ( [ ourestav ] ) , and taking the square root .",
    "this paper has developed methodology for estimating class prior probabilities in situations in which class membership is difficult / expensive to determine .",
    "asymptotic distributions of the estimators were obtained , enabling users to form confidence intervals and perform hypothesis tests .",
    "it was proven that use of unlabeled data does bring an improvement in asymptotic variance , compared to using only the labeled data .    in the parametric cases , the usual considerations for model fitting hold .",
    "one should first assess the goodness of fit of the model though many formal test procedures exist , with the large samples often encountered in classification problems it may be preferable to use informal assessment .",
    "one can , for instance , estimate the function @xmath151 nonparametrically , using say kernel or nearest - neighbor methods , and then compare the estimates to those resulting from a parametric fit .",
    "the paper first built from the semiparametric framework of @xcite , and then also derived a fully nonparametric estimator for the case of purely discrete features .",
    "the latter methodology requires that the training set be large enough that there is at least one observation for every possible value of x. if there are many such values , or if the training set is not large enough , one might turn to smoothing methods , such as kernel - based approaches .",
    "another possibility in the purely discrete case is to use the log - linear model [ @xcite ] , which is fully parametric",
    ".    one might pursue possible further improvement by using the unlabeled data not just to attain a better estimate for the marginal distribution of @xmath6 , but also to enhance the accuracy of the estimate of the conditional distribution of @xmath7 given @xmath6 . as noted in section",
    "[ intro ] , much work has been done on this problem in the context of estimating classification functions .",
    "it would be of interest to investigate the asymptotic behavior in our present context of estimation of class prior probabilities .",
    "it would also be useful to investigate whether the methods of section [ assessing ] can be applied to the classification function problem .",
    "j. blackard and d. dean .",
    "comparative accuracies of artificial neural networks and discriminant analysis in predicting forest cover types from cartographic variables , _ computers and electronics in agriculture _ , 1999 , 24 , 131 - 151 .",
    "u. muller , a. schick and w. wefelmeyer .",
    "imputing responses that are not missing .",
    "_ probability , statistics and modelling in public health _ ( m. nikulin , d. commenges and c. huber , eds . ) , 2006 , 350 - 363 , springer ."
  ],
  "abstract_text": [
    "<S> work in the classification literature has shown that in computing a classification function , one need not know the class membership of all observations in the training set ; the unlabeled observations still provide information on the marginal distribution of the feature set , and can thus contribute to increased classification accuracy for future observations . </S>",
    "<S> the present paper will show that this scheme can also be used for the estimation of class prior probabilities , which would be very useful in applications in which it is difficult or expensive to determine class membership . </S>",
    "<S> both parametric and nonparametric estimators are developed . </S>",
    "<S> asymptotic distributions of the estimators are derived , and it is proven that the use of the unlabeled observations does reduce asymptotic variance . </S>",
    "<S> this methodology is also extended to the estimation of subclass probabilities . </S>"
  ]
}