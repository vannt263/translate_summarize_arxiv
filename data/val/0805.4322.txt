{
  "article_text": [
    "entanglement swapping @xcite is a phenomenon where 2 or more qubits which did nt interact in the past are brought into an entangled state .",
    "for example , two parties alice and bob share the bell states @xmath0 and @xmath1 such that alice is in possession of qubits 1 and 3 and bob of qubits 2 and 4 . if alice performs a measurement in the bell basis on qubits 1 and 3 she will end up with one of the four bell states .",
    "simultaneously bob s qubits 2 and 4 are also brought into a bell state .",
    "this measurement can be described by the equation @xmath2 this equation shows that alice s result is completely random , i.e. she will obtain any of the four bell states with equal probability .",
    "but the state of the qubits 2 and 4 is completely determined by the result of alice s measurement .",
    "this correlation is used in a number of key distribution protocols @xcite to share a secret key between alice and bob .",
    "since the practical realization of entanglement swapping is rather complex to achieve with today s technology none of these qkd protocols has been implemented yet .",
    "also li et al . presented a qkd protocol @xcite based on entanglement swapping which not only produces random key bits but also certain key bits .",
    "this is achieved by introducing a pauli operation in eq .",
    "( [ eq_entswap ] ) as it will be described in detail in section [ sec_origprot ] . as it is shown in this protocol",
    "is secure against an intercept / resend attack as well as a collective attack .",
    "but we will present an attack strategy in section [ sec_attstrat ] which is based on a 6-qubit state .",
    "this state is more complex than the system of the sender and the receiver , but it provides an adversary with full information about the key shared between the two parties .",
    "the main idea of this attack is that the adversary eve entangles herself with alice and bob using a state which preserves the correlations of alice s bell state measurement .",
    "further this state contains additional information which allows eve to eavesdrop bob s secret result .",
    "an attack where eve is entangled with one party was presented by zhang , li and guo @xcite on the protocol of cabello @xcite but it would nt work for the protocol in since eve would nt stay undetected .",
    "we will also make a proposal how to secure the protocol against this new attack strategy .",
    "this can be achieved using a hadamard operation and we will describe the new version in detail in section [ sec_modprot ] . in section [ sec_secanal ] we will discuss the security of our new version .",
    "alice creates @xmath3 epr pairs , each in a bell state , e.g. @xmath4 . in the following",
    "we will focus on the simple case @xmath5 , where alice and bob share the states @xmath0 and @xmath1 , which are publicly known . in li et al . start the protocol with preshared entangled states which is a very strong assumption because the qubits have to be shared somehow between the two parties .",
    "but in the security analysis in an adversary eve is granted the possibility to interact with the bell states .",
    "thus we can conclude that there have to be some qubits in transit between alice and bob .",
    "there are two possible ways to share the bell states between the legitimate parties : either one party , e.g. alice , prepares both bell states and sends two qubits to the other party or both parties prepare one bell state and they exchange two qubits .",
    "the first scenario is insecure against a simple intercept - resend attack : if alice prepares the bell states @xmath0 and @xmath1 and sends qubits 2 and 4 to bob eve can intercept these qubits and perform a bell state measurement on them .",
    "this will bring qubits 1 and 3 also into a bell state which is known to eve .",
    "then she forwards qubits 2 and 4 to bob .",
    "thus eve has full information about alice s and bob s secret measurement result and is able to eavesdrop the key perfectly .",
    "therefore we will assume that alice prepares @xmath0 and bob prepares @xmath1 and that they exchange the qubits 2 and 3 ( cf .",
    "picture ( 2 ) in figure [ pic_origprot ] ) .",
    "alice randomly chooses one of the four pauli operations , @xmath6 , @xmath7 , @xmath8 or @xmath9 and applies it to qubit 1 ( cf .",
    "picture ( 3 ) in figure [ pic_origprot ] ) .",
    "alice s operation will generally be described as @xmath10 , where the superscript @xmath11 denotes that it is applied on qubit @xmath12 . as a next step alice performs a bell state measurement on qubits 1 and 3 in her possession ( cf . picture ( 4 ) in figure [ pic_origprot ] ) .    with this measurement",
    "the effect of entanglement swapping arises and entangles bob s qubits 2 and 4 . following",
    "the equation @xmath13 alice can determine in which state bob s qubits are after her bell state measurement if she applied the operation @xmath14 on qubit 1 .",
    "additionally , she can compute also what the state of qubits 2 and 4 would be , if she did nt apply any operation on qubit 1 using eq .",
    "( [ eq_entswap ] ) from above .",
    "now alice announces to bob that she made a bell state measurement but keeps her result secret .",
    "to infere alice s result bob performs a bell state measurement on qubit 2 and 4 in his possession .",
    "since he does not know yet which operation alice applied and in which state qubits 1 and 2 have been before the measurement he does not know the exact state of qubits 1 and 3 . with the help of eq .",
    "( [ eq_entswap ] ) he can at least deduce in which state qubits 1 and 3 should be if alice did nt apply anything to qubit 1 .",
    "this is called alice s imaginary result .    to get the correct state of qubits 1 and 3 bob asks alice about her result but keeps his own result secret .",
    "using the information about alice s and his own result bob can deduce which pauli operation alice applied .",
    "alice and bob now share information about alice s randomly chosen operation and the result bob obtained , which is also random .",
    "they use these two pieces of information to extract a classical raw key .",
    "therefore they agree beforehand on a mapping of bell states onto classical 2-bit strings , e.g. @xmath15 as well as of pauli operations onto classical 2-bit strings ,",
    "i.e. @xmath16    if we take the general case with @xmath3 epr pairs alice and bob repeat these steps for all the pairs . in the end",
    "they publicly compare a certain number of bits of the generated raw key to detect an eavesdropper .",
    "in this section we discuss an attack strategy where eve is able to perfectly eavesdrop the secret key of alice and bob without being detected .",
    "therefore she uses the six qubit state ( cf .",
    "picture ( 1 ) in figure [ pic_attack ] ) @xmath17 this state is rather complex and not easy to generate ( cf .",
    "appendix ) but it has the special property that it can be written as @xmath18 that means , a measurement on qubits @xmath19 and @xmath20 as well as @xmath21 and @xmath22 yields in the same result as it would be expected from entanglement swapping in eq .",
    "( [ eq_entswap ] ) .",
    "further the remaining two qubits @xmath23 and @xmath24 are in the same state as the qubits @xmath21 and @xmath22 .",
    "eve can use this fact to obtain enough information to deduce the secret measurement results of alice and bob if she somehow manages that the two parties share the state @xmath25 instead of two bell states .",
    "that can be achieved easily using entanglement swapping on qubits 2 and 3 in transit together with her six qubits .    when alice sends out qubit 2 and bob qubit 3 eve preforms bell state measurements on both of them with respective qubits from @xmath26 ( cf . picture ( 2 ) in figure [ pic_attack ] ) .",
    "a problem is that eve , at first , does nt know which initial state alice prepared .",
    "but , as we will show in the next paragraphs , she can overcome this problem fairly easy .",
    "eve s first bell state measurement on qubits 2 and @xmath19 is described in eq .",
    "( [ eq_cesp_espo_as_es_es1 ] ) .",
    "( as already pointed out above , we will use @xmath14 to describe alice s secret pauli operation . )",
    "@xmath27 at this point eve can not clearly say which state the qubits 1 , @xmath28 and @xmath24 are in .",
    "all four results of her bell state measurement are equally likely and she has absolutely no information about the operation @xmath14 .",
    "nevertheless , eve is able to transform the 6-qubit state in a way that it is always in the state @xmath29 .",
    "therefore she performs a @xmath7 operation on qubits @xmath22 and @xmath23 if she gets @xmath30 or does nothing if her result is @xmath31 . to correct the negative signs in case eve obtains a @xmath32 she performs a @xmath9 on qubits @xmath22 and @xmath24 . in case of @xmath33 she first has to apply the @xmath7 operator on qubits @xmath22 and @xmath23 and then the @xmath9 operator on qubits @xmath22 and @xmath24 .",
    "the second bell state measurement is performed on qubits 3 and @xmath22 .",
    "again , the resulting 6-qubit state is not entirely known but it can be one out of four possible states .",
    "we wo nt describe this bell state measurements explicitly but we want to stress that eve is able to bring the 6 qubits in the state @xmath34 .",
    "therefore she uses a similar method as described above applying the pauli operations @xmath7 and @xmath9 on qubits @xmath20 , @xmath23 and @xmath24 .",
    "now eve sends qubit @xmath20 to alice and qubit @xmath21 to bob and keeps qubits @xmath23 and @xmath24 by herself ( cf .",
    "picture ( 4 ) in figure [ pic_attack ] ) .",
    "alice and bob , who are not aware of eve s intervention follow the protocol and perform bell state measurements on their respective particles ( cf . pictures ( 5 ) and ( 6 ) in figure [ pic_attack ] ) .",
    "if we look at the 6-qubit state @xmath34 , alice s bell state measurement on qubits 1 and @xmath20 changes the state in a way that it leaves the qubit pairs @xmath21 , 4 and @xmath23 , @xmath24 in an entangled state .",
    "this can be seen from the alternative description of the state @xmath34 in eq .",
    "( [ eq_cesp_espo_as_es_esalice ] ) and picture ( 7 ) in figure [ pic_attack ] ) .",
    "@xmath35 alice gets each possible result with equal probability of @xmath36 as she would expect it .",
    "further , bob s bell state measurement will end up with certainty in a specific bell state , which is fully dependent on alice s result .",
    "due to the special choice of the state @xmath25 the correlation between his and alice s result is preserved as they would expect it if no eavesdropper was present .",
    "thus the presence of eve wo nt be detected when alice and bob compare some bits of the raw key .",
    "additionally , it leaves the qubits @xmath23 and @xmath24 , which are in eve s possession , in the very same state bob obtains as result ( cf . also picture ( 7 ) in figure [ pic_attack ] ) .",
    "this is easy to see if we look at the alternative description in the bell basis of the remaining four qubits @xmath21 , 4 , @xmath23 and @xmath24 after alice s measurement @xmath37    at this time , eve has full information about bob s secret measurement .",
    "that means , eve has as much information as bob and thus can obtain the classical secret raw key in the same way bob does : from her result of the bell state measurement eve can compute alice s imaginary result .",
    "moreover , when alice publicly announces her result , eve is able to infere which pauli operation alice has chosen .",
    "thus eve knows both parts of the shared secret information .",
    "therefore she easily can infere the classical bit string which is used as a raw key by alice and bob and so she is able to obtain the secret key , too .    instead of performing the bell state measurements on the qubit pairs 2 , @xmath19 and 3 , @xmath22 as soon as she receives them , eve has the opportunity to delay her measurement and immediately send qubit @xmath20 to alice ( cf . picture ( 2 ) in figure [ pic_modprotattack2 ] ) . with this strategy eve",
    "is able to overcome operations alice applies on qubit 1 but she introduces a much higher error rate as we will describe in section [ sec_secanal ] .",
    "another , but rather strong , assumption is that eve is in control of alice s and bob s epr source .",
    "that means she is able to distribute the state @xmath26 between her and the two parties without further bell state measurements . in this case",
    "alice s measurement on qubits @xmath19 and @xmath20 leaves bob s qubits in a correlated state and eve with the full information about the results , as described above .",
    "since alice and bob can prepare their epr source themself this assumption is not very practical .",
    "the protocol can be improved by performing a hadamard operation before alice applies her secret pauli operation on qubit 1 ( cf .",
    "picture ( 3 ) in figure [ pic_modprot ] ) .",
    "the hadamard operation alters the initial state in a way that eve ca nt eavesdrop the secret key without introducing a certain error rate .",
    "thus alice and bob can detect her easily as it will be shown in section [ sec_secanal ] .    due to the use of the additional hadamard operation",
    "it is not important any more wether alice prepares both bell states or each party prepares a bell state by its own . to stay consistent with the above descriptions of the protocol and the attack we will discuss the scenario where alice prepares the state @xmath0 and bob prepares @xmath1 ( for the simple case @xmath5 ) .",
    "alice sends out qubit 2 to bob and he sends qubit 3 to alice .",
    "when she receives bob s qubit she randomly applies either the identity operator @xmath6 or the hadamard operator @xmath38 on qubit 1 .",
    "this alters the initial state to @xmath39 where @xmath40 is one of the four possible superpositions of bell states , i.e. @xmath41 then alice applies her secret pauli operation @xmath14 on qubit 1 and performs a bell state measurement on qubits 1 and 3 ( cf .",
    "picture ( 5 ) in figure [ pic_modprot ] ) .",
    "this bell state measurement can be described as @xmath42    further she publicly tells bob wether she has applied the @xmath43 operator or not .",
    "if she did so , bob applies the @xmath43 operator on qubit 2 and otherwise he does nothing ( cf .",
    "picture ( 6 ) in figure [ pic_modprot ] ) . as we can see from eq .",
    "( [ eq_supbell ] ) a repeated application of the hadamard operator eliminates the superposition and the correlation from the original bell state measurement is preserved . in the end bob performs a bell measurement on qubits 2 and 4 and computes alice s actual and imaginary result as it is described in the original protocol .",
    "in the following we will provide a security analysis of the modified protocol .",
    "since the application of the hadamard operation is just a minor change of the original protocol , the modified version is also secure against an intercept / resend attack as well as a collective attack , as described in .",
    "therefore we will first inspect eve s probability to stay undetected if she follows the same attack strategy just described in section [ sec_attstrat ] .",
    "if alice does not apply the hadamard operator eve s attack will be successfull as we already pointed out above .",
    "thus we will discuss the case where alice performs the hadamard operation on qubit 1 ( cf .",
    "figure [ pic_modprotattack ] ) . due to the fact that the hadamard operation alters the initial state as we have seen in eq .",
    "( [ eq_altinitstate ] ) eve s first bell state measurement on qubits 2 and @xmath19 will also change as described in eq .",
    "( [ eq_modprot_evebsm ] ) . @xmath44 as it has been shown in section [ sec_attstrat ] eve is able to change the resulting states of her measurements such that she will always end up with a slight variation of her initial state .",
    "a similar argument holds for eve s second measurement on qubits 3 and @xmath22 . thus the state after these two measurements is ( cf .",
    "picture ( 6 ) in figure [ pic_modprotattack ] ) @xmath45 then eve sends out qubit @xmath20 to alice and qubit @xmath21 to bob .",
    "when alice performs her bell state measurement the state @xmath46 can be described as in eq .",
    "( [ eq_modprot_alicebsm ] ) ( cf .",
    "also picture ( 7 ) in figure [ pic_modprotattack ] ) .",
    "@xmath47    for reasons of simplicity we will assume that alice s result is @xmath48 as it is illustrated in picture ( 8) in figure [ pic_modprotattack ] ( the computations for any other result are analog ) .",
    "bob also applies the hadamard operator on qubit @xmath21 in his possession and thus alters the state of qubits @xmath49 and @xmath24 to @xmath50 which can be alternatively written as @xmath51 from this it is easy to see that bob will get the expected result , @xmath52 only with 50% probability . in the other half of the cases he will obtain @xmath53 .",
    "alice and bob will detect this error when they check the correlation between their results .",
    "that means in @xmath54 of the cases , when alice does nt apply the hadamard operation , eve will stay undetected with certainty . in the other half of the cases when alice performs the hadamard transformation on qubit 1 eve",
    "will be detected with probability @xmath54 .",
    "these probabilities are valid for the simple case ( @xmath5 ) where alice and bob share only 2 bell states . in general ,",
    "alice and bob share @xmath3 entangled qubit pairs and then they will detect eve with the probability @xmath55 which can be brought close to 1 for large @xmath56 .    a possibility for eve to overcome the effect of the hadamard operation is to apply a @xmath43 operation herself on the qubits @xmath19 and @xmath21 before the protocol starts .",
    "this changes the initial state @xmath26 to @xmath57 and in the course of the protocol alice and bob s application of the hadamard operator will invert eve s operations . in detail , eq .",
    "[ eq_evealtstate ] changes to @xmath58 and further , after bob s application of the hadamard operation @xmath59 which is equal to the state from eq .",
    "[ eq_cesp_espo_as_es_esalice ] .",
    "thus , the attack reduces to the version described in section [ sec_attstrat ] and eve will obtain full information about the key whenever alice decides to perform the @xmath43 operation . in all the other cases eve",
    "will introduce an error equal to eq .",
    "[ eq_modprot_error ] due to her hadamard operations , which is easy to see following the arguments in the paragraphs above . at this point",
    "we want to stress that alice and bob will become suspicious if they find errors only in those cases when alice does ( or does not , respectively ) perform the hadamard operation .",
    "thus , a better strategy for eve is to randomly apply the two hadamard operations on qubits @xmath19 and @xmath21 .",
    "she will introduce the same error rate but the errors will be equally distributed .",
    "another option for eve to invert alice s hadamard operation is to delay her measurement on the qubit pairs 2 , @xmath19 and 3 , @xmath22 until alice publicly announces whether she applied the hadamard operation or not .",
    "that means , eve intercepts qubits 2 and 3 in transit between alice and bob and immediately forwards qubit @xmath20 to alice ( cf . picture ( 2 ) in figure [ pic_modprotattack2 ] ) .",
    "alice , convinced to have received bob s qubit , applies the hadamard operation and performs the bell state measurement on qubits 1 and @xmath20 ( cf . pictures ( 3)-(5 ) in figure [ pic_modprotattack2 ] ) . due to entanglement swapping qubit 2",
    "is now entangled with qubits @xmath19 , @xmath21 , @xmath22 , @xmath23 and @xmath24 , as described in eq .",
    "[ eq_secanal_alicebsm ] .",
    "@xmath60    here , eve does not know in which state her qubits 2 , @xmath19 , @xmath21 , @xmath22 , @xmath23 and @xmath24 are because she does not know alice s result .",
    "but for our further considerations we assume that alice s result is @xmath61 , i.e. eve is in possession of some state @xmath62 similar to her initial state @xmath63 .",
    "next , alice publicly announces that she applied the hadamard operation . having that knowledge eve applies a @xmath43 operation on qubits 2 and @xmath21 in her possession inverting the effect of alice @xmath43 operation and preparing for bob s @xmath43 operation ( cf . picture ( 7 ) in figure [ pic_modprotattack2 ] ) .",
    "then she sends qubit @xmath21 to bob and performs a bell state measurement on qubits 3 and @xmath22 which changes the state to @xmath64 .",
    "finally , bob inverts the hadamard operation due to alice s public announcement ( cf .",
    "picture ( 8) in figure [ pic_modprotattack2 ] ) .",
    "similar to eq .",
    "[ eq_cesp_espo_as_es_esalice ] bob s bell state measurement on qubits @xmath21 and 4 can be described as @xmath65 it is easy to see that bob s obtains every bell state with equal probability of 25% , i.e. his and alice s results are completely uncorrelated . in case alice does not apply the hadamard operation eve will introduce the same error rate .",
    "therefore , the probability eve will be detected is @xmath66 which converges much faster to 1 compared to the first strategy described above ( cf .",
    ". [ eq_modprot_error ] ) .",
    "we showed that the protocol presented by li et al . @xcite is open to an attack strategy where eve entangles herself with both legitimate communication parties . using a special 6-qubit state which preserves the correlated results of entanglement swapping an adversary is able to obtain full information about the key alice and bob share in the end .",
    "we also discussed an improvement where alice uses a hadamard transformation on one qubit to secure the protocol .",
    "we showed that due to the change of the initial state caused by the hadamard operation an adversary will be detected with a high probability .",
    "we would like to thank christian kollmitzer and oliver maurhart for fruitful discussions and comments .",
    "further we want to thank our reviewer for showing us an interesting new aspect of this topic .",
    "this work was supported by the integrated project secoqc ( contract no .",
    "ist-2003 - 506813 ) in the sixth framework program of the european union .",
    "eve s initial state @xmath26 from eq .",
    "( [ eq_eveinitstate ] ) is rather complex and it might not be producible due to today s physical limitations . nevertheless , we can show that it is , in principle , possible for eve to generate this state using a sequence of hadamard operations and controlled pauli operations .",
    "first we assume that eve is in possession of 3 sources emitting bell states .",
    "the state of these 6 qubits is @xmath67 eve performs a hadamard operation @xmath43 on qubits @xmath19 and @xmath21 ( indicated by the superscripts @xmath68 and @xmath69 ) , which alters the initial state first to @xmath70 and further to @xmath71 then eve applies a @xmath9 operation on qubit @xmath21 if qubits @xmath19 and @xmath20 are in the bell state @xmath72 .",
    "otherwise the identity operator is applied .",
    "this action can be described as @xmath73 and it changes the state to @xmath74 next eve performs a @xmath7 operation on qubit @xmath19 and a @xmath9 on qubit @xmath23 if qubits @xmath21 and @xmath22 are in the state @xmath75 .",
    "alternatively , she performs a @xmath9 operation on qubit @xmath19 and a @xmath7 operation on qubit @xmath23 if qubits qubits @xmath21 and @xmath22 are in the state @xmath76 .",
    "if qubits @xmath21 and @xmath22 are in the state @xmath77 eve applies a @xmath78 operation on both qubits @xmath19 and @xmath23 .",
    "these three controlled operation can be stated as @xmath79 using this operator eve is able to bring the 6 qubits into the desired state from eq .",
    "( [ eq_eveinitstate ] ) ."
  ],
  "abstract_text": [
    "<S> li et al . presented a protocol [ int . </S>",
    "<S> journal of quantum information , vol . </S>",
    "<S> 4 , no . 6 ( 2006 ) 899 - 906 ] for quantum key distribution based on entanglement swapping . in this protocol </S>",
    "<S> they use random and certain bits to construct a classical key and they claim that this key is secure . in our article we show that the protocol by li et al . is insecure presenting a new type of attack strategy which gives an adversary full information about the key without being detected . </S>",
    "<S> this strategy is based on entanglement swapping , too , and manages to preserve the correlation between the measurement results of the legitimate parties . </S>",
    "<S> further we present a modified version of the protocol and show that it is secure against this new attack strategy . </S>"
  ]
}