{
  "article_text": [
    "we consider two simple problems for setting confidence belts .",
    "the first problem is that of the poisson distribution in the presence of background . the second problem is the measurement of a non - negative parameter @xmath0 , with a normally distributed error .",
    "although simple problems , there has been considerable work and discussion on them in the last few years . most of the discussion has centered on the poisson case , when the number of observed events is small .",
    "this is an important current topic because there are many search experiments involving small numbers of events .",
    "these include higgs particle searches , supersymmetry searches , and neutrino oscillation searches such as lsnd and karmen .",
    "we will briefly describe some recent attempts to address these problems .",
    "the standard method for setting 90% cl bounds has been to select a region with a 5% probability above and a 5% probability below the bounds .",
    "about two years ago , gary feldman and bob cousins@xcite suggested a method , new to physics analyses , called the unified procedure . for the poisson case , for each possible value of the parameter @xmath0 , they looked at the ratio of the probability of getting the observed number of events @xmath1 for that @xmath0 compared to the maximum probability for all physically allowed @xmath0 s , and picked @xmath1 s with the highest ratio to build a 90% confidence region .",
    "this solved two problems with the old procedure .",
    "it automatically transitioned from an upper limit to a confidence belt and it always produced confidence sets in the physical region .",
    "the unified procedure works well for many problems and is a significant improvement over the symmetric tails procedure .",
    "however it has a serious problem if few or no events are observed .",
    "if 0 events are seen , there are 0 signal and 0 background events . that there are 0 background events is interesting , but irrelevant to the question of whether signal events are seen . a 90% c.l .",
    "limit on @xmath0 should come from @xmath2% , which sets a limit at @xmath3 .",
    "( throughout this article probabilities for a fixed parameter @xmath4 are denoted by a subscript @xmath5 .",
    "probability densities and probability masses are denoted with lower case letters and distribution functions by upper case letters . )",
    "such a case did occur in the summer of 1998 from initial karmen results @xcite .",
    "they had 0 events with a background of 2.88 , and using the unified method obtained an upper limit of @xmath6 .",
    "it is desirable to have a method set a confidence limit near 2.3 , independent of background , for a 90% c.l .",
    ", when no events are seen .",
    "we @xcite presented a variant of the feldman - cousins unified procedure which corrected this problem and introduced the concept of conditional coverage . for any observation we know that the background is less or equal to the observed number of events , @xmath7 .",
    "we suggested the use of a sample space not of all experimental outcomes , but of outcomes with background @xmath8 .",
    "thus , if @xmath9 , we considered only measurements in which there are @xmath10 background events , even for 20 events observed in the sample space .",
    "this probability was used both to set the ratio used in the unified method and to calculate the coverage probability .",
    "this method had the advantage of giving an upper limit of about 2.42 for 0 observed events independently of the background mean @xmath11 .",
    "see figure 1 .",
    "robert cousins @xcite found that this procedure had a problem with its lower limit when applied to a continuous observable .",
    "suppose one measures a parameter @xmath12 with a measurement error @xmath13 , where @xmath14 is normal ( 0,1 ) .",
    "the r - w procedure eliminated @xmath15 for all @xmath16 . however , if @xmath15 , the probability of measuring @xmath17 is 10% . see figure 2 .",
    "it appeared that the r - w upper limit and the f - c lower limit were needed .",
    "since the conditional coverage concept is , as yet , unfamiliar , it is desirable that a method should have reasonable conventional coverage as well as conditional coverage .",
    "in this section , we derive baysian credible intervals when the expected signal is given a uniform prior distribution .",
    "these intervals have several desirable properties . like the unified intervals ,",
    "bayesian intervals lie in the physical region and automatically change from confidence bounds to two - sided intervals .",
    "they avoid the known pitfalls mentioned above , the problems with low counts in unified method and the large lower boundary of the conditional confidence intervals in the continuous case .",
    "finally , and importantly , the bayesian intervals are optimal on their own terms .",
    "the intervals derived minimize length among all credible intervals .",
    "the price paid for these desirable properties is dependence on the prior and metric .",
    "we address the first of these concerns by showing that the frequentist coverage probability of the bayesian intervals is quite close to the bayesian posterior credible level .",
    "that is , while the two probabilities are conceptually quite different , they are close numerically . in addition , we show that the bayesian credible intervals have exact conditional ( frequentist ) coverage probability , except for discreteness in the poisson case . with regard to the metric",
    ", it is primarily the optimality of our procedures that depends on the metric .",
    "see section 7 .",
    "we will illustrate with two examples , a poisson case in which the mean is composed of an unknown signal mean @xmath18 and a known background mean @xmath11 and the measurement @xmath19 of a parameter @xmath18 , with a measurement error @xmath14 which is normal ( 0,1 ) .",
    "we use a uniform ( improper ) prior of 1 for @xmath20 in both problems .",
    "this is a simple problem in which the statistical issues are clear and which approximates the poisson problem for large @xmath21 .",
    "we measure @xmath22 , where @xmath18 , and the density function for @xmath19 is @xmath23 for the uniform prior probability @xmath24 , the marginal density of @xmath19 becomes @xmath25 where @xmath26 the standard normal distribution function .",
    "we now use bayes theorem @xmath27 .",
    "the conditional density of @xmath0 given @xmath19 is @xmath28 @xmath29 is proper ; the improper ( infinite ) prior has cancelled out .",
    "we wish to find an upper limit @xmath30 and a lower limit @xmath31 , dependent on @xmath19 , for which @xmath32 in bayes theory , such intervals are called _",
    "credible intervals_. it is desirable to minimize the interval @xmath33 $ ] , subject to ( [ eq : cred ] ) .",
    "we do that by picking @xmath0 s with the largest probability density to be within the interval , @xmath34 = \\{\\theta : f(\\theta|x)\\ge c\\},\\ ] ] where @xmath35 is chosen to satisfy equation ( [ eq : cred ] ) .",
    "now , @xmath36 if and only if @xmath37 , where @xmath38}.\\ ] ]    there are two cases to be considered . if @xmath39 , then the condition ( [ eq : cred ] ) becomes @xmath40 @xmath41,\\ ] ] where @xmath42 denotes the inverse function to @xmath43 .",
    "if @xmath44 , ( [ eq : cred ] ) becomes @xmath45 @xmath46.\\ ] ]    if @xmath47 is the point where these two curves meet , then , @xmath48 hence , the desired credible interval is @xmath33 = [ \\max(x - d,0),x+d],$ ] where @xmath49 $ ] , if @xmath50 , and @xmath51 $ ] if @xmath52 .",
    "the probability mass function and distribution function for the poisson distribution with mean @xmath4 are : @xmath53 and @xmath54 . for our present problem @xmath55 , where @xmath56 is the fixed ( known ) `` background '' mean .",
    "if we let @xmath0 have a prior uniform distribution @xmath57 for @xmath18 , we then have @xmath58 @xmath59 as derived in our previous paper@xcite . the derivation proceeded by expanding @xmath60 and noting that @xmath61 .",
    "we again use bayes theorem @xmath62 .",
    "then , recalling that @xmath57 for @xmath18 and @xmath63 , we have @xmath64    to set upper and lower confidence bounds for @xmath0 , we need to solve the equation @xmath65 for @xmath31 and @xmath30 . a 90% c.l .",
    "corresponds to setting @xmath66 .",
    "the second equality here is obtained by writing @xmath67 and using the reasoning described after equation ( 8) . to get the shortest interval @xmath68 we need to include values of @xmath0 with highest density , _",
    "i.e. _ , @xmath34=[\\theta : p_b(\\theta|n)\\ge c]\\ ] ] for some @xmath69 . the conditions ( 10 ) and ( 11 ) may be solved numerically by an iterative procedure .",
    "this procedure is described in section * 6 * in a more general context .",
    "the bayesian credible intervals just derived have exact posterior coverage probability @xmath70 , by construction . in this section",
    ", we show that they also have high frequentist coverage probability .      in the continuous example , @xmath71 , and @xmath72 .",
    "fix a @xmath0 and find the points at this fixed @xmath0 where @xmath19 meets the upper and lower bayesian limits .",
    "let @xmath73 be that @xmath19 which meets the upper limit , @xmath74 and @xmath75 be that @xmath19 which meets the lower limit , @xmath76 $ ] .",
    "then @xmath77 $ ] covers @xmath0 iff @xmath78 , and the conventional unconditional coverage is @xmath79 .",
    "this is not exactly @xmath70 .",
    "a lower limit on the coverage is shown in the appendix to be @xmath80 but this is a very conservative limit . for @xmath81 ,",
    "this lower limit is 0.8182 , while a numerical calculation finds a minimum coverage of about 0.86 .",
    "the conventional coverage probability can be improved for a very small increase in limits .",
    "we will consider a conservative ad - hoc modification of the upper limit on @xmath0 using the one - sided limit for a higher confidence level , @xmath82 .",
    "let @xmath83.\\ ] ] let @xmath84 be the @xmath19 corresponding to @xmath85 .",
    "the formula for the conventional coverage is @xmath86 , as above .",
    "the undercoverage , derived in the appendix , is very small for this conservative modification . for a 90% c.l .",
    ", the conventional coverage is at least .900 everywhere to three significant figures .",
    "figure 3 shows a plot of the coverage bands , plotted as @xmath87 vs @xmath19 .",
    "the confidence bands are shown in figure 4 and compared with the old r - w upper bound and the feldman - cousins unified procedure lower bound .",
    "the conventional frequentist coverage for the bayesian model and for this conservative modification are shown in figure 5 .",
    "the bayesian credible intervals also have an exact conditional frequentist property , in terms of the error @xmath88 .",
    "note that if @xmath19 is observed , then , necessarily , @xmath89 , since @xmath18 .",
    "@xmath90 is just the probability that @xmath89 .",
    "let @xmath91 $ ] .",
    "then the interval @xmath77 $ ] covers @xmath0 iff @xmath92 or , equivalently , @xmath93 . in the appendix",
    ", it is shown that if @xmath94 is an independent copy of @xmath19 , then @xmath95=1-\\epsilon\\ ] ] and @xmath77 $ ] is the shortest interval with these properties .",
    "as in the continuous case , the conventional coverage is not exact in the poisson case . for @xmath96 and @xmath97 , for example , the conventional coverage varies from about 86% to 96.6% .",
    "figure 6 shows the resulting confidence belt for @xmath98 .",
    "the conditional coverage is shown in the appendix to be @xmath99 , except for discreteness .",
    "the conventional coverage can be improved by a small ad hoc modification similar to that used for the continuous case .",
    "consider an alternate bayesian upper limit @xmath100 for @xmath0 defined as the one - sided limit for a credible level @xmath101 .",
    "take the modified upper limit as the maximum of @xmath30 and @xmath100 . in the continuous example we chose @xmath82 . here",
    ", we make a different ad hoc choice .",
    "the effect of the modification for @xmath102 and @xmath103 is shown in figure 7 .",
    "the value of the limit for @xmath104 then increases from 2.3 to 2.53 .",
    "see figure 8 . for a fixed @xmath105",
    "the limit at @xmath104 is independent of @xmath11 , but the appropriate choice of @xmath105 will depend weakly on @xmath11 .",
    "in this section , we extend the method to processes in which we have some information concerning whether a given event is a signal or a background event",
    ". suppose on each event one measures a statistic @xmath19 ( or a vector of statistics ) for which the density function is @xmath106 for signal events and @xmath107 for background events .",
    "suppose , further , that the number of observed events @xmath1 has a poisson distribution with mean @xmath21 , where @xmath0 is the expected number of signal events .",
    "we assume that @xmath11 , the expected number of background events , is known .",
    "then the joint probability mass function / density for observing @xmath1 events and parameters @xmath108 is @xmath109\\ ] ] @xmath110\\times    \\prod_{k=1}^n h(x_k),\\ ] ] where @xmath111 . for a uniform prior",
    ", @xmath57 for @xmath112 , the marginal and posterior probability mass function / densities of @xmath1 and @xmath108 , and of @xmath0 are then @xmath113e^{-(b+\\theta)}d\\theta   \\end{aligned}\\ ] ]    @xmath114    observe that @xmath115 d\\theta = n!\\sum_{m=0}^nc_{n , m}{b^{n - m } \\over   ( n - m ) ! } e^{-b } , \\ ] ] where @xmath116 \\sum_{j_1 + \\cdots   + j_n = m}\\prod_{k=1}^n r(x_k)^{j_k},\\ ] ] and where @xmath117 are restricted to the values 0 or 1 .",
    "cancelling common factors , @xmath118 \\over   n!\\sum_{m=0}^n c_{n , m } { b^{n - m } \\over ( n - m)!}}. \\label{eq : q}\\ ] ] observe also that if @xmath119 , then @xmath120 and @xmath121 is the same as the posterior density of @xmath0 given @xmath1 in the poisson case without the extra variables @xmath19 .",
    "we want to find upper and lower limits @xmath122 for @xmath0 such that @xmath123 and to minimize that interval .",
    "this means we want @xmath33=\\{\\theta : q(\\theta|n , x)\\ge c\\}$ ] .",
    "we first find the value @xmath124 at which @xmath121 is maximum , or , equivalently , @xmath125 $ ] is maximum . since the denominator in equation ( [ eq : q ] ) @xmath126 does not depend on @xmath0 , @xmath127 = \\sum_{k=1}^n { r(x_k ) \\over   b+\\theta r(x_k ) } -1.\\ ] ] if @xmath128 , then @xmath129 .",
    "otherwise , setting the derivative equal to 0 then leads to the equation @xmath130 if @xmath119 , then it is easy to see that @xmath131 $ ] .",
    "it is clear from ( [ eq : thetahat ] ) that @xmath132 , and it can be shown that the obvious iteration starting at @xmath133 converges to @xmath124 .",
    "this iteration is a special case of the em algorithm @xcite .",
    "next integrate @xmath121 .",
    "let @xmath134 then @xmath135d\\theta\\ ] ] @xmath136 we use the reasoning described after equation(8 ) to evaluate this integral .",
    "@xmath137 @xmath138 we can use either equation ( 19 ) , recognizing that the integral is an incomplete gamma function , or use equation ( 20 ) to find @xmath139 .",
    "the limits can then be found by iterations as follows .    1 .",
    "first solve the equation @xmath140 for @xmath141 .",
    "this is straightforward , since @xmath142 is increasing in @xmath141 .",
    "2 .   if @xmath143 , then @xmath144 and @xmath145 .",
    "3 .   if @xmath146 , solve the equations    @xmath147 @xmath148 @xmath149 for @xmath150 by a double iteration .",
    "in solving these equations , start with @xmath151 , where @xmath152 and @xmath153 is the maximum value of @xmath121 , corresponding to @xmath154 .",
    "solve the first two equations for @xmath155 .",
    "this is straightforward , since @xmath121 is increasing for @xmath156 and decreasing for @xmath157 .",
    "then replace @xmath153 ( respectively , @xmath158 ) by @xmath69 , accordingly as @xmath159 ( respectively , @xmath160 ) .",
    "note that the iteration procedure for the poisson example without additional parameters measured is just a special case of this iteration procedure .",
    "we have proposed methods for setting credible / confidence intervals for the _ means _ @xmath0 of a poisson variable , observed in the presence of background , and of a normal distribution , when @xmath0 is known to be non - negative . in the process , we have made specific choices for the prior distributions and loss structure .",
    "the ( uniform ) prior distributions were chosen for mathematical tractability and agreement between the bayesian credible level and conventional confidence level ; and one of the main findings is that such agreement is possible .",
    "the intervals have an optimality property : they minimize the length of credible intervals in the @xmath0 scale for the uniform prior . for both problems , the mean provides a physically meaningful and mathematically tractable metric .",
    "our procedures depend on the choice of metric , prior , and loss structure as follows : if the interval for @xmath0 is @xmath161 and the metric were changed , to @xmath162 say , then a valid interval for @xmath163 is @xmath164 .",
    "this has the same frequentist coverage as the original interval and is an exact credible interval for the induced prior , @xmath165 .",
    "the optimality is lost , however .",
    "the transformed interval does not minimize length in the @xmath163-scale .",
    "the situation for our method is similar to that in the cramer - rao limit , equation 13.10 of roe @xcite .",
    "this very useful bound also depends on the metric .",
    "the derivations of the ad hoc modifications in section 5 mix bayesian and frequentist reasoning , and this may seem inelegant .",
    "we believe that any inelegance is mitigated by the minor nature of the changes and the resulting good properties of the procedure from both the bayesian and frequentist viewpoints .    in the case of a poisson distribution without auxiliary variables , there is a close connection between our method and @xmath166 : the @xmath166 procedure is mathematically equivalent to an upper credible bound with a uniform prior distribution .",
    "read @xcite calls this a coincidence .",
    "we think that there is a deeper connection @xcite .",
    "the optimality claimed for @xmath167 in read s work is optimality for testing background only versus background plus a specified signal .",
    "our procedures are designed to produce intervals of shortest length , not most powerful tests . that these two criteria can lead to different procedures",
    "was noted in the statistical literature by pratt @xcite .",
    "this research is supported by the national security agency under mda904 - 99 - 1 - 004 and the national science foundation under phy-9725921 .",
    "proof : the result follows from @xmath174= { \\phi[min(x , z ) ] \\over   \\phi(x ) } = prob[x-\\theta\\le z|x].\\ ] ] in words , the conditional frequentist distribution of @xmath175 is the same as the posterior distribution of @xmath173 .",
    "it follows that @xmath176 & = & prob[x - u(x)\\le   x-\\theta\\le min(x , d(x))|x ] \\\\       & = & prob[\\ell(x)\\le\\theta\\le u(x)|x ] = 1-\\epsilon ,   \\end{aligned}\\ ] ] where the last equality follows from the definitions of @xmath177 and @xmath178 .",
    "next , if @xmath179 $ ] is any interval for which @xmath180 = 1-\\epsilon$ ] , where @xmath181 and @xmath182 , then @xmath183=prob[-d(x)\\le x-\\theta\\le a(x)|x]=1-\\epsilon\\ ] ] and , therefore , @xmath184 , since the bayesian limits were chosen to minimize the length of the interval .",
    "proof : recall that @xmath189 and @xmath190 were the values of @xmath19 for a given @xmath0 meeting the upper and lower bayesian limits , so @xmath74 and @xmath191 $ ] .",
    "the unconditional frequentist coverage probability is @xmath192 = prob_\\theta[x_\\ell\\le x\\le x_u ] =   \\phi(x_u-\\theta ) -\\phi(x_\\ell - \\theta).\\ ] ] recall the definition of @xmath47 and observe that @xmath193 for all @xmath194 , since @xmath195 and @xmath196 for @xmath197 .",
    "first suppose that @xmath198",
    ". then @xmath199 and @xmath200 by ( 6 ) . also , by ( 4 ) and ( 5 ) , @xmath201 =   1-\\phi[d(x_\\ell)]=\\epsilon\\phi(x_\\ell),\\ \\phi(x_u-\\theta)=\\phi[d(x_u ) ]   = { 1 \\over 2 } + { 1 \\over 2}(1-\\epsilon)\\phi(x_u),$ ] and @xmath202 next suppose @xmath203 .",
    "then @xmath204 , @xmath205= 1-\\left[{1 \\over 2 } + { 1 \\over   2}\\left(1-\\epsilon\\right)\\phi(x_\\ell)\\right]$ ] , and @xmath206 \\\\   & = & { 1 \\over 2 } ( 1-\\epsilon)[\\phi(x_\\ell ) + \\phi(x_u ) ] \\\\    & \\ge & { 1-\\epsilon \\over 1 + \\epsilon}. \\end{aligned}\\ ] ]      proof : for the modified procedure , the upper limit is defined as @xmath208.\\ ] ] we set @xmath84 to be the @xmath19 corresponding to @xmath209 . then @xmath210 $ ] , and @xmath211 .",
    "observe that @xmath212 for @xmath213 and @xmath214 for @xmath16 .",
    "for if @xmath213 , then @xmath215>\\phi^{-1}(1- { 1 \\over 2}\\epsilon)$ ] using equation ( 5 ) .",
    "similarly , if @xmath216 , then @xmath217<\\phi^{-1}(1- { 1 \\over 2}\\epsilon)$ ] ; and if @xmath218 , then @xmath219<\\phi^{-1}(1- {   1 \\over 2}\\epsilon)$ ] .",
    "it follows that @xmath220 for @xmath221 and @xmath222 if @xmath223 .          to see this ,",
    "let @xmath230 where @xmath231 is the gamma function . then , using reasoning similar to that following equation ( 8) , @xmath232 . from equation",
    "( 9 ) , the posterior distribution function of @xmath0 is @xmath233 fix @xmath11 and let @xmath234 be the conditional probability of at most @xmath235 events from the conditional sample space , given at most @xmath1 background events in the experiment , _",
    "i.e. _ , @xmath236 .",
    "then    @xmath237 for @xmath238 , and @xmath239 for @xmath240 .",
    "letting @xmath241 be the random count obtained in a particular experiment @xmath242\\approx y \\label{eq : approx}\\ ] ] for @xmath243 , where the approximation arises because @xmath235 is discrete .",
    "specifically , ( [ eq : approx ] ) is exact for @xmath244 of the form @xmath245 , since @xmath246 = prob_\\theta[m\\le m|n_{background}\\le n]= k_{\\theta , n}(m)$ ] for all @xmath247 .    clearly",
    ", @xmath248 iff @xmath249 iff @xmath250 .",
    "thus , @xmath248 iff @xmath251 , or equivalently , @xmath252 using ( [ eq : approx ] ) , the conditional probability of the latter event given @xmath253 is approximately @xmath254 where the last equality follows from the definitions of @xmath255 and @xmath256 .    to appreciate ( [ eq : approx2 ] ) , it is instructive to use a different approach .",
    "suppose that we knew apriori that @xmath257 .",
    "then the mass function of @xmath241 is then @xmath258 to form confidence intervals in this model , we might construct tests that the parameter has a given value and then invert this family of tests .",
    "this requires finding @xmath259 and @xmath260 for which @xmath261 for each @xmath0 , where @xmath259 and @xmath260 are functions of @xmath0 and @xmath1 .",
    "this implies and is nearly equivalent to @xmath262\\ge 1-\\epsilon .",
    "\\label{eq : cndcnf}\\ ] ] except for discreteness , the left side of ( [ eq : cndcnf ] ) is @xmath263 .",
    "the bayesian credible intervals implicitly determine values of @xmath259 and @xmath260 , namely @xmath264 @xmath265 the relation ( [ eq : approx2 ] ) shows that these values nearly satisfy ( [ eq : cndcnf ] ) , except for discreteness .",
    "feldman and r.d .",
    "cousins , unified approach to the classical statistical analysis of small signals , _ phys .",
    "rev . _ * d57 * , 3873 ( 1998 ) .",
    "k. eitel and b. zeitnitz , the search for neutrino oscillations",
    "@xmath266 with karmen , in neutrino physics and astrophysics , procedings of the xviii international conference on neutrino physics and astrophysics , takayama , japan , edited by y. suzuki and y. totsuka , north holland ( 1999 ) . b.p .  roe and m.b .",
    "woodroofe , improved probability method for estimating signal in the presence of background , _ phys .",
    "* 60 * , 053009 ( 1999 ) .",
    "robert d. cousins , application of conditioning to the gaussian - with - boundary problem in the unified approach to confidence intervals , arxiv : physics/0001031 , 15 jan 2000 , submitted to _ phys .",
    "dempster , n.m .",
    "laird , and d.b .",
    "rubin , maximum likelihood from incomplete data via the em algorithm , _ roy .",
    "soc . _ * b39 * , 1 ( 1977 ) .",
    "roe , probability and statistics in experimental physics , second edition , springer - verlag , new york , to be published in 2001 .",
    "read , modified frequentist analysis of search results ( the @xmath166 method ) , _ proceedings of the workshop on confidence limits at cern , january 17 - 18 , 2000 _",
    ", to be issued as a cern yellow report . h. wang and m. woodroofe , to appear in _ ann .",
    "_ j. pratt , _",
    "j. amer . statist .",
    "_ , * 56 * 549 - 567,(1961 ) ."
  ],
  "abstract_text": [
    "<S> we propose using a bayes procedure with uniform improper prior to determine credible belts for the mean of a poisson distribution in the presence of background and for the continuous problem of measuring a non - negative quantity @xmath0 with a normally distributed measurement error . within the bayesian framework , these belts are optimal . </S>",
    "<S> the credible limits are then examined from a frequentist point of view and found to have good frequentist and conditional frequentist properties . </S>"
  ]
}