{
  "article_text": [
    "redshift surveys are a fundamental tool in modern observational astronomy .",
    "these surveys aim to measure redshifts of galaxies , galaxy clusters , and quasars to map the 3-dimensional distribution of matter .",
    "these observations allow measurements of the statistical properties of the large - scale structure of the universe . in conjunction with observations of the cosmic microwave background",
    ", redshift surveys can also be used to place constraints on cosmological parameters , such as the hubble constant ( e.g. , @xcite ) and the dark energy equation of state through measurements of the baryon acoustic oscillation ( bao ) peak , first detected in the clustering of galaxies ( @xcite , @xcite ) .",
    "the first systematic redshift survey was the cfa redshift survey @xcite , measuring redshifts for approximately 2,200 galaxies .",
    "such early surveys were limited in scale due to single object spectroscopy .",
    "the development of fiber - optic and multi - slit spectrographs enabled the simultaneous observations of hundreds or thousands of spectra , making possible much larger surveys , such as the deep2 redshift survey @xcite , the 6df galaxy survey ( 6dfgs ; @xcite ) , galaxy and mass assembly ( gama ; @xcite ) , and the vimos public extragalactic survey ( vipers ; @xcite ) , measuring redshifts for approximately 50,000 , 136,000 , 300,000 , and 55,000 objects , respectively .    the sloan digital sky survey ( sdss ; @xcite ) is the largest redshift survey undertaken to date . at the conclusion of sdss - iii ,",
    "the third iteration of sdss @xcite , a total of 4,355,200 spectra had been obtained . of these",
    ", 2,497,484 were taken as part of the baryon oscillation spectroscopic survey ( boss ; @xcite ) , containing 1,480,945 galaxies , 350,793 quasars , and 274,811 stars .",
    "the `` constant mass '' ( cmass ) subset of the boss sample is composed of massive galaxies over the approximate redshift range of @xmath7 and typical s / n values of @xmath8/pixel . the automated redshift measurement and spectral classification of such large numbers of objects presents a unique challenge , inspiring refinements of the ` spectro1d ` pipeline @xcite .",
    "this software models each co - added spectrum as a linear combination of principal component analysis ( pca ) basis vectors and polynomial nuisance vectors and adopts the combination that produces the minimum @xmath9 as the output classification and redshift .",
    "pca - reconstructed models were chosen due to its close ties to the data , allowing the pca eigenspectra to potentially capture any intrinsic populations within the training sample .",
    "this pipeline was able to achieve an automated classification success rate of 98.7% on the cmass sample ( and 99.9% on the lower - redshift , higher - s /",
    "n lowz sample ) .",
    "the software was only able to successfully classify 79% of the quasar sample , which resulted in the need for the entire sample to be visually inspected @xcite .    the sloan digital sky survey iv ( sdss - iv ; @xcite ) is the fourth iteration of the sdss . within sdss - iv , the extended baryon oscillation spectroscopic survey ( eboss ; @xcite ) will precisely measure the expansion history of the universe throughout eighty percent of cosmic time through observations of galaxies and quasars in a range of redshifts left unexplored by previous redshift surveys .",
    "ultimately , eboss plans to use approximately 300,000 luminous red galaxies ( lrgs ; 0.6  @xmath10  @xmath1  @xmath10  1.0 ) , 200,000 emission line galaxies ( elgs ; 0.7  @xmath10  @xmath1  @xmath10  1.1 ) , and 700,000 quasars ( 0.9  @xmath10  @xmath1  @xmath10  3.5 ) to measure the clustering of matter .",
    "the primary science goal of eboss is to measure the length scale of the bao feature in the spatial correlation function in four discrete redshift intervals to @xmath11% precision , thereby constraining the nature of the dark energy that drives the accelerated expansion of the present - day universe .",
    "the eboss redshift range is only sparsely sampled by supernova surveys , yet it is within this redshift range that cosmic expansion transitioned from deceleration to acceleration .",
    "a set of requirements for the redshift and classification pipeline was established to meet these goals . as given in @xcite ,",
    "these requirements are : ( 1 ) redshift accuracy @xmath12  300 km  s@xmath3 for all tracers at redshift @xmath13 and @xmath14 km  s@xmath3 rms for quasars at @xmath15 ; and ( 2 ) fewer than 1% unrecognized redshift errors of @xmath16 km  s@xmath3 for lrgs and @xmath17 km  s@xmath3 for quasars ( referred to in this paper as  catastrophic redshift failures \" ) .",
    "additionally , the pipeline should return confident redshift measurements and classifications for @xmath18% of spectra .",
    "the higher - redshift , lower - s / n ( typically @xmath19/pixel for galaxies ) targets in eboss present a new challenge for automated redshift measurement and classification software .",
    "initial tests with the ` spectro1d ` pca basis vectors predicted success rates of @xmath20% for the lrg sample , which is well below the specified science requirements .",
    "this is due , in part , to the flexibility in fitting pca components to a spectrum , which allows non - physical combinations of basis vectors to pollute the redshift measurements and statistical confidences thereof .",
    "additionally , while possible ( e.g. , @xcite ) , mapping pca coefficients onto physical properties is a difficult task .",
    "it requires the use of a transformation matrix , and confidence in the results is , at best , unintuitive , and possibly uncertain .    to meet these challenges",
    ", we have developed an archetype - based software system for redshift measurement and spectral classification named ` redmonster ` .",
    "we have developed a set of theoretical templates from which spectra can be classified .",
    "` redmonster ` is written in the python programming language .",
    "the development of this software was driven by the following goals :    1 .",
    "redshift measurement and classification on the basis of discrete , non - negative , and physically - motivated model spectra ; 2 .   robustness against unphysical pca solutions likely to arise for low - s / n elg and lrg spectra in eboss , particularly in the presence of imperfect sky - subtraction ; 3 .",
    "determination of joint likelihood functions over redshift and physical parameters ; 4 .",
    "self - consistent determination and application of hierarchical redshift priors ; 5 .",
    "self - consistent incorporation of photometry and spectroscopy in performing redshift constraints ; 6 .",
    "simultaneous redshift and parameter fits to each individual exposure in multi - exposure data ; 7 .",
    "custom configurability of spectroscopic templates for different target classes ; 8 .",
    "automated identification of multi - object superposition spectra .",
    "the software as described in this paper meets design goals 1 , 2 , 3 , and 7 .",
    "we have chosen to enumerate the full list of design goals to provide a forward - looking vision of new and interesting possibilities .    in this paper , we describe ` redmonster ` and its application to the eboss lrg sample .",
    "the organization is as follows : section  [ sec : software ] describes automated redshift and classification algorithms and procedures of ` redmonster ` .",
    "we include the requirements and standardized format for templates and a description of the eboss galaxy and star templates in section  [ sec : templates ] .",
    "the core redshift measurement algorithm is described in section  [ sec : fitting ] and section  [ sec : interpretation ] .",
    "section  [ sec : parameters ] gives an overview of the spectroscopic data sample of eboss and an analysis of the tuning and performance of the software on eboss data , including completeness and purity .",
    "section  [ sec : classification ] provides a description of the classification of eboss lrg spectra , including redshift success dependence , effects on the final redshift distribution in eboss , and precision and accuracy .",
    "finally , section  [ sec : conclusion ] provides a summary and conclusion .",
    "the content and structure of the output files of ` redmonster ` are described in appendix  [ sec : output ] .",
    "the use of physically - motivated templates allows mapping of physical properties from the best - fitting template onto the model used to create the suite of templates . to better facilitate the exploration of large , multi - dimensional parameter spaces , spectral fitting",
    "is performed in fourier space , allowing ` redmonster ` to combine the speed of cross - correlation techniques with the statistical framework of forward - modeling .",
    "additionally , significant effort has been made to write software not specific solely to sdss , but rather in a manner that facilitates use in other redshift surveys , such as the dark energy spectroscopic instrument ( desi ; @xcite ) .",
    "we have also prioritized end - user customizability in the way the software operates",
    ".    informed by our design goal of developing survey - agnostic software , the current version of ` redmonster ` requires only the following data as input :    1 .   wavelength - calibrated , sky - subtracted , flux - calibrated , and co - added spectra , rebinned onto a uniform baseline of constant @xmath21log@xmath22 per pixel ; 2 .",
    "statistical error - estimate vectors for each spectrum , expressed as inverse variance .      in order to make redshift and parameter measurements and",
    "select among galaxy , quasar , and stellar ( and possibly other ) object types with the highest statistical confidence , the pipeline requires a set of templates that both spans the entire space of object types within the survey and covers the full wavelength range of the spectrograph over the redshift range of interest . to this end , ` redmonster ` uses `` archetype '' template grids , where  archetype \" refers to single spectral templates that are not fit in linear combination with any other templates , excluding low - order polynomial nuisance vectors .",
    "a series of archetype spectral templates spanning the relevant parameter space is recorded in an ` ndarch.fits ` ( signifying n - dimensional archetypes ) file .",
    "these ` ndarch.fits ` files conform to a standard that requires a general form of template spectra written by end users and ingested into the redshift software .",
    "the format allows highly configurable spectroscopic template classes without any re - coding of the low - level fitting routines .",
    "this file standard is oriented towards the familiar units and conventions of optical spectroscopic redshift measurement .",
    "reader and writer routines for ` ndarch.fits ` files conforming to this standard are included in the ` redmonster ` package .",
    "a brief description of the standard is given here , while full documentation can be found in the software package .",
    "the data contained in an ` ndarch.fits ` file consists of a single multi - dimensional array that contains all possible spectral templates for a class of object , containing flux densities or luminosity densities in units of @xmath23 ( power per unit area per unit wavelength ) or @xmath24 ( power per unit wavelength ) . the absolute normalization may be physically meaningful , but is not required to be so . the first axis of the data array corresponds to vacuum wavelength and is gridded in positive increments of constant @xmath25",
    ".    there may be one or more axes in addition to the first axis , up to the maximum number allowed by the fits standard .",
    "each axis beyond the first will generally correspond to a monotonically ordered physical model - parameter dimension ( age , metallicity , emission - line strength , etc . ) , but may also correspond to an arbitrary labeled or unlabeled collection .",
    "the archetype template vectors are assumed to have a uniform resolution characterized by a gaussian line - spread function with a dispersion parameter @xmath26 equal to one sampling pixel .",
    "templates are segregated into template classes , with each class corresponding to a single object type of interest and contained in a single ` ndarch.fits ` file .",
    "these classes are used by ` redmonster ` to classify the object type of a given spectrum .",
    "three template classes have been developed for use in the eboss pipeline .",
    "galaxy templates for lrg and elg targets are described in  [ sec : lrgs ] .",
    "quasar and stellar templates have been developed and are included with ` redmonster ` .",
    "because this paper focuses primarily on performance of ` redmonster ` spectroscopic classifications on the eboss lrg target sample , these templates function primarily to identify non - galaxy objects that arise due to targeting impurities . as such ,",
    "we defer description of quasar and stellar templates to a later work .",
    "our lrg templates are selected from the flexible stellar population synthesis ( fsps ) model suite ( @xcite , @xcite ) with the padova isochrones @xcite and a kroupa imf @xcite .",
    "the spectra used in the models are custom high resolution theoretical spectra @xcite ; the resulting models are referred to as fsps - c3k .",
    "the synthetic spectral library was constructed with the latest set of atomic and molecular line lists ( courtesy of r. kurucz ) and is based on the kurucz suite of spectral synthesis and stellar atmosphere routines ( synthe and atlas12 ; @xcite , @xcite ; @xcite ) .",
    "the grid of spectra was computed assuming the @xcite solar abundance pattern and a constant microturbulence of 2 km  s@xmath3 .",
    "for further details see @xcite .",
    "table  [ tab : galparams ] lists the physical parameters of the lrg template suite , their range , and the frequency with which they are binned .",
    "all models are solar metallicity .",
    "several example templates are shown in figure  [ fig : templates ] .",
    "the templates have been vertically offset by 800 , 600 , 400 , 250 , and 100 for visual clarity .",
    "cll @xmath27 & [ -2.5 , 1 ] gyr & 15 + @xmath28 & [ 2 , 2.6 ] km  s@xmath3 & 4 + h@xmath29 ew & [ 0 , 100 ]  & 5      our stellar templates are synthetic spectra computed using kurucz atlas9 models by @xcite and the radiative transfer code ass@xmath30 t @xcite .",
    "the reference solar abundances are from @xcite , with enhanced @xmath29-element abundances , mimicking the trends found in the milky way , and a constant micro - turbulence velocity of 2 km s@xmath3 .",
    "continuum opacity is based on the opacity project and iron project photoionization cross - sections , collected by @xcite and @xcite , and line opacities are based on data compiled by kurucz , with updates from @xcite . line absorption coefficients for balmer lines",
    "are computed with the codes provided by @xcite .",
    "the ` redmonster ` software approaches redshift measurement and classification as a @xmath9 minimization problem by cross - correlating the observed spectrum with each spectral template in the ` ndarch.fits ` file over a discretely sampled redshift interval . the algorithm is similar to the method described by @xcite . by default ,",
    "pixels with s / n @xmath31 ( which likely indicates a cosmic ray ) or with @xmath32 , are masked for each observed spectrum .",
    "these values are configurable when running the software .",
    "the spectrum is then fit with an error - weighted least - squares linear combination of a single template and a low - order polynomial across the range of trial redshifts .",
    "the polynomial term serves to absorb galactic and intrinsic interstellar extinction , sky - subtraction residuals , and spectro - photometric calibration errors not accounted in the templates . by default , trial redshifts are separated by the spacing set by a single pixel in wavelength , though this , too , is configurable . for the eboss classifications , we have chosen to separate trial redshifts by one pixel for stars , two pixels for galaxies , and four pixels for quasars ( @xmath33 km  s@xmath3 , @xmath34 km  s@xmath3 , and @xmath35 km  s@xmath3 , respectively ) to reduce computation time .",
    "a redshift range must also be specified for each ` ndarch.fits ` file being used ; for the eboss data , we use @xmath36 for galaxies , @xmath37 for stars , and @xmath38 for quasars .",
    "this fitting process results in a @xmath9 value for a spectral template at a single trial redshift . repeating this fit for all templates within the ` ndarch.fits ` and across all trial redshifts defines a @xmath39 surface , where @xmath40 is a vector spanning the parameter - space of the template class .",
    "the software is able to explore large parameter spaces within a template class by pre - computing some matrix elements in fourier space during the fitting process ( see also @xcite ) . in order to fit a set of data",
    "@xmath41 with a set of @xmath42 basis vectors @xmath43 in a minimum @xmath9 sense , the model @xmath44 takes the form @xmath45 where , in the case of ` redmonster ` , @xmath43 consists of a single physical template and @xmath46 polynomial terms .",
    "thus , the @xmath9 of the model relative to the data , assuming @xmath47 data points , is @xmath48 where @xmath49 is the statistical variance of the @xmath50 pixel of @xmath41 .",
    "we find the @xmath51 maximum likelihood estimator , @xmath52 , by minimizing @xmath53 with respect to @xmath54 .",
    "solving @xmath55 yields @xmath56",
    "because eboss spectra are binned linearly in @xmath25 , velocity redshifts are uniform linear shifts in pixel space .",
    "thus , fitting at a trial redshift introduces a  lag \" in pixel - space @xmath57 of the basis vectors relative to the data , after which estimators become a function of @xmath57 , and eq .",
    "[ eq:4 ] becomes @xmath58 this result can be cast in terms of matrices : @xmath59 where @xmath60 is an @xmath61 matrix with each column a basis vector , @xmath62 is an @xmath63 diagonal matrix with @xmath64 @xmath49 , and @xmath65 is the vector of maximum likelihood esimators for which we wish to solve .",
    "the product @xmath66 is the correlation matrix of the templates , with elements @xmath67 while the elements @xmath68 are given by the right - hand side of eq .",
    "[ eq:5 ] . over a range of continuous @xmath57 ,",
    "these elements are the discrete convolutions @xmath69 and @xmath70 , respectively , and may be computed as products in fourier space . since the polynomial terms have no physical meaning , they may remain fixed in the observed frame of the data ( i.e. , have no @xmath57 dependence ) , and it is possible to pre - compute the fraction @xmath71 of the total matrix elements for a template class , greatly reducing computational requirements .",
    "one of the motivations for the development of ` redmonster ` and its galaxy templates was the restriction that all redshifts and classifications must be derived from physical models . to that end , the resulting @xmath72 at each point in redshift - parameter space is evaluated for physicality based on the coefficient of the template component of the model .",
    "fits with a negative template amplitude are rejected , and that point in the @xmath39 surface is assigned a value of @xmath73 , where @xmath73 is defined as the @xmath9 of the best - fit model where the amplitude of the template coefficient is forced to 0 ( i.e. , a polynomial - only model ) . because the best - fit models produce the lowest possible @xmath9 value at each point in redshift - parameter space , and because the value of @xmath73 is a function only of the data itself , the effect of this physicality constraint is to introduce a flat  ceiling \" in the @xmath39 surface , while maintaining continuity .",
    "cll 0 & ` sky ` & sky fiber + 1 & ` little_coverage ` & insufficient wavelength coverage + 2 & ` small_delta_chi2 ` & @xmath9 of best fit is too close to that of second best ( @xmath74 in @xmath75 ) + 5 & ` z_fitlimit ` & @xmath76 at edge of the redshift fitting range ( ` z_err ` set to -1 ) + 7 & ` unplugged ` & fiber was broken or unplugged , and no spectrum was obtained + 8 & ` null_fit ` & at least one template class had constant - valued @xmath9 surface      after the computation of the @xmath39 surface for each template class , the minimum @xmath9 in spanning all templates is found at each trial redshift .",
    "the resulting series of best fits defines a @xmath77 curve for each template class ( similar to figure 2 of @xcite ) .",
    "interpolation over this curve is then performed using a cubic b - spline ( i.e. , a c2-continuous composite bzier curve ) , through which all local minima are identified .",
    "the @xmath47 best redshifts for a particular template class are defined by the @xmath47 lowest minima of the @xmath77 curve .",
    "the curve around each of these minima is then fit by a quadratic function using the three points nearest the minimum .",
    "the analytic minima of each quadratic fit are adopted as the spectrum s candidate redshifts .",
    "the statistical error on each candidate is evaluated as the change in redshift @xmath78 for which the @xmath9 of the quadratic fit increases by one from its minimum value .    in the event",
    "the global minimum falls on the edge of the explored redshift range , the ` z_fitlimit ` bit is triggered within the ` zwarning ` bit - mask , and both ` z ` and ` z_err ` are set to -1 .",
    "the definitions of all failure modes captured by ` zwarning ` are shown in table  [ tab : zwarning ] .",
    "bit - masks 0 - 7 are identical to those of ` spectro1d ` , although bits 3 , 4 and 6 are not used by ` redmonster ` and are retained only for consistency . bit 4 ( ` many_outliers ` ) was found in sdss - iii to flag too many good quasar redshifts .",
    "bit 6 ( ` negative_emission ` ) has been deprecated , allowing all spectra to be considered .",
    "the ` negative_model ` bit ( bit 3 ) is unnecessary as ` redmonster ` restricts the template amplitude to be positive for reasons of physicality .",
    "bit 8 is new and is triggered in the rare case of a template class having a @xmath9 surface with no local minima .",
    "the output files are discussed in detail in appendix  [ sec : output ] .    due to noise",
    ", some spectra can have multiple minima in the vicinity of one another that are not statistically significant .",
    "for all template classes , we ignore local minima that are separated in redshift from a lower-@xmath9 minimum by less than a given threshold , @xmath21v .",
    "local minima separated by more than @xmath21v are explicitly evaluated , since they constitute redshift failures if they are statistically indistinguishable from one another .",
    "we define a quantity , @xmath79 , as the minimum acceptable @xmath80dof , where @xmath81 corresponds to the global minimum and @xmath82 corresponds to some secondary minimum .",
    "the @xmath83 between two minima must be greater than this threshold for statistical confidence to be declared .",
    "values of @xmath83 less than this threshold will trigger the ` small_delta_chi2 ` bit in the ` zwarning ` bit - mask , indicating a lack of statistical confidence .",
    "this process is illustrated schematically in figure 2 of @xcite ; example @xmath77 curves from eboss spectra are shown in figure  [ fig : chi2curves ] .",
    "the fits are then compared across template classes if multiple ` ndarch ` files were used .",
    "the @xmath47 best fits from each template class are combined into a single set , and are then sorted in ascending order of @xmath84 .",
    "the @xmath47 best fits from this combined set are adopted as the best redshifts and classifications for the object .",
    "these fits are re - evaluated for statistical confidence and flagged according to the above criteria , although @xmath85 separated by less than @xmath21v will no longer trigger the ` small_delta_chi2 ` flag .",
    "additionally , redshift differences between two classes less than the quadrature sum of the error estimates are not flagged even if the @xmath86 is below the threshold , as the redshift , and not the class , is the primary measurement being made . by default ,",
    "the software keeps five redshifts and classifications per spectrum ( @xmath87 ) , but this is user - configurable .",
    "the main targets for eboss spectroscopy consist of lrgs at redshifts @xmath88 @xcite , elgs in the range @xmath89 ( @xcite , @xcite , @xcite ) ,  clustering \" quasars in the range @xmath90 , re - observations of faint ly@xmath29 quasars in the range @xmath91 , and new ly@xmath29 quasars at redshifts @xmath91 @xcite .",
    "a selection of example eboss spectra is shown in figure  [ fig:6panel ] .",
    "the spectral classification and redshift software described here will be applied to all spectra obtained with the boss spectrograph , including targets outside the lrg , elg , and quasar selection algorithms . here",
    "we demonstrate the tuning of ` redmonster ` parameters and the performance of ` redmonster ` on the lrg target sample from eboss .",
    "the lrg target class consists of massive red galaxies that have been color - selected using sdss imaging @xcite in _ ugriz _ filters @xcite and imaging from the wide - field infrared survey explorer ( wise ; @xcite ) .",
    "these targets have a faint magnitude limit of @xmath92 ( ab ) .",
    "a full investigation of the lrg selection is presented in @xcite .",
    "spectroscopic data for eboss are obtained using the 2.5-m sloan telescope at apache point observatory @xcite with the boss spectrograph system .",
    "the boss instrument is composed of two double - arm spectrographs fed by 1000 optical fibers plugged into a drilled aluminum plate that is positioned in the telescope focal plane .",
    "a summary of this system is given in table 2 of @xcite and a full account is given in @xcite .",
    "each of the optical fibers feeding the spectrographs is numbered with a ` fiberid ` index ranging from 1 - 1000 .",
    "each physical plug plate is given a unique ` plate ` number . finally , because a given ` plate ` may be observed more than once with different mappings between ` fiberid ` and target spectra , each plugging is given an ` mjd ` number corresponding to the modified julian date of the observation .",
    "thus , any combination of ` plate ` , ` mjd ` , and ` fiberid ` constitutes a unique eboss co - added spectrum .",
    "pluggings are observed in 15-minute exposures , which are co - added during the data reduction process as described in @xcite .",
    "the 1d spectral outputs of this calibration , extraction , and co - addition process are stored in the `` ` spplate ` '' fits files , which become the inputs to the software described in this paper .",
    "two significant changes have been made to the spectral extraction and co - addition of individual exposures for the second data release ( dr14 ) of sdss - iv .",
    "these changes were developed to improve classification of lower signal - to - noise data in eboss .",
    "the first major change improves the way atmospheric differential refraction ( adr ) corrections are applied to eboss spectra , and is described in @xcite .",
    "the improved adr corrections are similar to prior work ( @xcite , @xcite ) and primarily improve flux calibrations for quasar spectra .",
    "the second change corrects a known bias in the co - addition of individual exposures .",
    "this correction has significant impact on the classification of galaxy spectra ; thus , we provide a description below .",
    "individual exposures are initially flux calibrated with no constraint that the same object has the same flux across different exposures .",
    "empirical `` fluxcorr '' vectors are broadband corrections to bring the different exposures into alignment for each object prior to co - addition . in dr13 and prior , these were implemented for each spectrum by minimizing    @xmath93    where @xmath94 is the flux of exposure @xmath95 at wavelength @xmath96 , @xmath97 is the flux of the selected reference exposure , and @xmath98 are low order legendre polynomials .",
    "the number of polynomial terms is dynamic , up to a maximum of 5 terms .",
    "higher order terms are added only if they improve the @xmath9 by 5 compared to one less term .",
    "this approach is biased toward small @xmath98 since that inflates the denominator to reduce the @xmath9 .    for dr14",
    ", we solve the fluxcorr vectors relative to a common weighted co - add @xmath99 which is treated as noiseless compared to the individual exposures ,    @xmath100    we additionally include an empirically tuned prior that @xmath101 to avoid large excursions in the solution for very low signal - to - noise data .",
    "figure  [ fig : fluxcorr ] shows the fluxcorr corrections for five exposures of 155 lrgs .",
    "the left panel shows the dr13 corrections , which have a large scatter and average value less than one due to biased fluxcorr .",
    "the right panel shows the new algorithm in dr14 , which reduces scatter and gives the corrections a mean close to unity .    due to the highly configurable nature of ` redmonster ` , several input values must be determined for each unique data set to optimize performance . in this section",
    ", we demonstrate the optimization of the most influential , interesting , and challenging of those : @xmath79 and the degree of the polynomial , @xmath102 to be fit in linear combination with the templates .",
    "a third important parameter to be determined is @xmath103 , the half - width of the window around a @xmath9-minimum in which secondary minima are ignored .",
    "this was chosen for eboss as 1000 km  s@xmath3 based on clustering science requirements , and thus will not be discussed here .    in order to explore the effects of these parameters and quantify performance of the software on galaxy spectra ,",
    "we analyze the eboss lrg target sample , containing 99,449 unique observations of lrg targets .",
    "we use reductions produced by the tagged version ` v5_10_0 ` of the ` idlspec2d ` pipeline that will be released in dr14 .",
    "determination of the configurable @xmath102 is described in  [ sec : npoly ] , and that of @xmath79 in  [ sec : chi2thresh ] .",
    "the number of additive polynomial terms fit in linear combination with the template spectrum can have a large impact on the quality of the fits and , thus , the failure rate and redshift errors .",
    "some polynomial terms are necessary to absorb broad - band spectrophotometric calibration errors and astrophysical signal not reflected in the templates .",
    "allowing too much freedom to the polynomial terms ( i.e. , too high an order ) will allow them to fit real astrophysical features .",
    "shifting the quality of the fit to the non - physical components of the model reduces the ability of the physical templates to provide statistically distinguishable fits to the data , thus increasing failure rates . in order to understand the effects of @xmath102 , we processed the lrg sample with ` redmonster ` four separate times , using each of a constant , linear , quadratic , and cubic polynomial , producing a unique output file for each .",
    "first , we computed the failure rate for each degree of polynomial . in all cases ,",
    "the ` zwarning ` flag corresponding to ` small_delta_chi2 ` dominates the redshift failure modes .",
    "the failure rates for a constant , linear , quadratic , and cubic polynomial were 9.5% , 20.9% , 14.2% , and 12.9% , respectively .",
    "additionally , we computed the distribution of @xmath86 per degree of freedom for each run , shown in figure  [ fig : drchi2_poly_histos ] .",
    "the use of a constant polynomial term stands out as having both the lowest failure rate ( @xmath104 ) , and a systematic shift in the @xmath105 distribution toward higher values .    in order to understand how the order of the polynomial affects our best - fit models and their distinguishing power , we focus on the two candidates with the lowest failure rates - constant and cubic .",
    "figure  [ fig:1poly_4poly_scatters ] shows object - matched comparisons of several statistics of our fits for the constant- and cubic - order polynomials .",
    "we have highlighted cases where one of the models returned a successful measurement ( ` zwarning ` = 0 ) while the other failed .",
    "the top panel shows the value @xmath106 of each spectrum for both model types .",
    "all points lie to the right of the dashed line , meaning the constant - polynomial model absorbs less information from the spectrum than does the cubic - polynomial in every case .",
    "further , the constant - polynomial has an rms of @xmath637,000 , roughly 6.5 times larger than the rms of the cubic - polynomial .",
    "the narrow range of values around @xmath107 suggests the cubic - polynomial is consistently absorbing most of the broadband information , while the constant - polynomial often can not .",
    "meanwhile , the central plot , showing the minimum @xmath108 for both models , shows a similar range of values for each .",
    "thus , in the cases where the constant - polynomial component is unable to fit broadband information , the templates effectively take a significant fraction of the signal absorbed by the cubic - polynomial and transfer it to the physical template .",
    "the bottom panel of figure  [ fig:1poly_4poly_scatters ] illustrates this further .",
    "the data show a linear relationship between the two values of @xmath109 with a slope of @xmath110 . on average , @xmath111 is larger for the constant - polynomial model than for the cubic - polynomial model , consistent with the trend in figure  [ fig : drchi2_poly_histos ] .",
    "figure  [ fig : jointplot3 ] shows @xmath112 of both polynomial choices for each object , where @xmath113 is the @xmath9 of a zero model ( i.e , the ( s / n)@xmath114 of the data ) ; thus , this quantity may be interpreted as the fraction of the total ( s / n)@xmath114 of the data absorbed by the polynomial .",
    "note that all data points fall above the unity relationship , meaning the cubic polynomial always absorbs more of the information in the spectrum than does the constant .",
    "we have overlaid contours from a bivariate kernel density estimate , which has a maximum at ( 0.573 , 0.831 ) .",
    "the marginal plots show the univariate kernel density estimates for the constant polynomial on the horizontal axis and cubic polynomial on the vertical axis .",
    "the median values of the constant and cubic are 0.553 and 0.787 , respectively , suggesting that , on average , the cubic polynomial and spectral template absorbs @xmath115 more , in absolute terms , of the spectrum s signal than does the constant polynomial and spectral template .    as a final means of exploring the effects of changing the order of the polynomial , we visually inspected spectra which returned a successful measurement in one run but a failure in the other .",
    "the visual inspections help us to develop a qualitative understanding of the types of spectra or spectral features that are handled successfully in one case and are problematic for the other .",
    "figure  [ fig : yes1no4 ] shows a @xmath116 galaxy from the lrg sample for which the constant - polynomial model returned a successful redshift measurement and the cubic - polynomial model returned a failure .",
    "this spectrum was chosen as being representative of the typical behavior of models with constant - success and cubic - failure .",
    "there is a clear unphysical upturn in the noisy blue end of the spectrum due to calibration errors , which happens occasionally among low s / n eboss spectra .",
    "the higher flexibility of the cubic - polynomial fit allows the model to chase this upturn , which shifts power into the non - physical component of the model and away from the physical template . because the long wavelength corrections are coupled to the short wavelength corrections through the cubic polynomial , this results in the suppression of the equivalent width of narrow - band features such as ca  h&k at 3968.5 and 3933.7   , respectively , h@xmath117 at 4863   , mg  i at 5175   , and na  i at 5894   . in low signal - to - noise spectra , such as those of eboss",
    ", it becomes difficult for the software to distinguish between the model fitting a real narrow - band feature and fitting noise . in this case",
    ", the cubic - polynomial model does , in fact , have the correct redshift , but due to reduced template amplitude relative to the constant - polynomial model , lacks the statistical confidence to declare a confident measurement .    on the other hand , for spectra with the largest broadband deviations from the templates or deviations that extend beyond the blue end ( due to flux calibration errors , object superpositions , etc . )",
    ", the constant - polynomial model lacks the flexibility to fit these features . in these cases ,",
    "the @xmath9 is driven by poor fitting of the broadband features , and the relative contribution from the astrophysical features is small .",
    "this hinders the software s ability to distinguish between models with different physical parameters .",
    "the cubic - polynomial , on the other hand , has the flexibility to absorb these strong broadband features , allowing the astrophysical features to dominate the @xmath9 , and the software is able to return a successful measurement .",
    "an example of this type of spectrum is shown in figure  [ fig : no1yes4 ] , a @xmath118 galaxy in the lrg sample in which broadband features extend across the entire range of the spectrograph .",
    "the constant - polynomial is unable to capture this , forcing the fitter to choose a stellar template , despite clear absorption features being visible from ca  h&k around 6000   , the g - band around 6500   , h@xmath117 around 7350   , and a less well - defined mg  i line around 7800   .",
    "the cubic - polynomial was able to absorb the broadband features , meaning the @xmath9 is dominated by the template s fit to astrophysical signal and a successful measurement was returned .",
    "at this point , it is clear that a constant - polynomial term produces lower failure rates , and is empirically the best choice for our data set .",
    "further , a qualitative understanding of the failure modes of the two model types leads us to believe that , in the presence of better flux calibration , the failure rates of a constant - polynomial are likely to decrease further .",
    "thus , we use a constant - polynomial model to classify the eboss lrg sample and in all subsequent analyses .",
    "decreasing the value of @xmath79 relaxes the requirement for a declaration of statistical confidence , resulting in higher redshift completeness rates .",
    "doing so comes at the expense of higher rates of catastrophic failures , as incorrect measurements that would have been flagged at a higher threshold are allowed through with no ` zwarning ` flag .",
    "similarly , increasing the value of @xmath79 decreases catastrophic failure rates as it restricts statistical confidence to only the best of fits , but does so at the expense of completeness rates , reducing usable sample size and statistical power towards cosmology constraints .",
    "thus , determining a value of @xmath79 means striking an optimal balance between completeness and purity while ensuring science requirements are met . here , we remind the reader that @xmath79 is always scaled to the degrees of freedom to account for possibly varying degrees of freedom between fits .",
    "we first investigate the failure rate as a function of @xmath79 , as shown in figure  [ fig : drchi2_vs_failure ] . at @xmath119 , the value used by ` spectro1d ` , ` redmonster ` reduces the failure rate from 24.3% to 16.3% . while significant , the failure rate is still more than a factor of 1.5 times the desired @xmath120% failure rate for eboss science . to ensure sub-10% failure rates ,",
    "the ` zwarning ` flag for ` small_delta_chi2 ` would need to be set at or below @xmath121 .",
    "while quantifying completeness is straightforward , doing so for catastrophic failure rates is not .",
    "the eboss science requirement for catastrophic failures is @xmath122 . by definition ,",
    "catastrophic failures pass through the software unnoticed , making identification difficult .",
    "we consider two tests to characterize the rate of catastrophic failures .",
    "we first asses the completeness of eboss sky fibers as a function of @xmath79 as a proxy for catastrophic failures .",
    "sky fibers are those fibers that are not placed on any target , but rather are intended to measure the sky emission , unpolluted by astronomical objects , to aid in sky - subtraction .",
    "roughly @xmath123 of the fibers on each eboss plate are placed as sky fibers .",
    "while a small fraction of these will inevitably be placed over real objects , the vast majority should contain no object at all .",
    "these should trigger the softwares ` small_delta_chi2 ` flag since there is no astronomical object ; a confident redshift is impossible .",
    "while the rate of false positives within this sample is not a direct measurement of the catastrophic failure rate , it does provide a testing ground for the software s behavior in the limit of low signal - to - noise .",
    "as signal - to - noise is the best predictor of redshift measurement success , this sample is informative of the true rates of catastrophic failures .",
    "the left panel of figure  [ fig : sky_failure_vs_drchi2 ] shows the cumulative fraction of eboss sky fibers above a given @xmath79 for ` redmonster ` and ` spectro1d ` . at a given threshold , ` redmonster ` returns a factor of seven fewer confident measurements .",
    "the increased rigidity of modeling with a single , physically - motivated template over a set of pca basis vectors reduces the ability of ` redmonster ` to fit sky residuals and noise , greatly reducing its rate of false positives .",
    "the eboss science requirement for catastrophic failures is @xmath122 , which we see in ` redmonster ` at a @xmath79 value of @xmath124 . in ` spectro1d ` , meanwhile , it does not reach sub-1% values until @xmath125 .",
    "we then assess the redshift differences between different spectra of the same object , as in @xcite .",
    "first , we identified 2128 targets that were tiled on more than one plate and , thus , have multiple independent observations .",
    "we then compared redshift differences as a function of @xmath105 , as shown in the right panel of figure  [ fig : sky_failure_vs_drchi2 ] . assuming that , in the cases of discrepant redshifts , one redshift is correct , the rate of catastrophic failures can be estimated by counting objects with @xmath126 km s@xmath3 and @xmath105 above the threshold . for this sample , there are 12 catastrophic failures out of 2520 confident measurements for @xmath127 and 32 catastrophic failures out of 3270 confident measurements for @xmath128 , corresponding to catastrophic failure rates of @xmath129% and @xmath130% , respectively .",
    "a similar analysis for the ` spectro1d ` reductions yields failure rates of @xmath131% and @xmath132% .    in order to maximize completeness while maintaining an acceptable catastrophic failure rate , we set @xmath133 for all subsequent analyses .",
    "we also use @xmath134 for ` spectro1d ` when making comparisons , to ensure that the catastrophic failure rate requirement is being met in both sets of reductions . amongst the full set of eboss lrg target spectra",
    ", we find an automated completeness ( ` zwarning ` = = 0 ) rate of 90.5% , with a catastrophic failure rate of 0.98% .",
    "meanwhile , ` spectro1d ` produces a completeness of 75.6% with a catastrophic failure rate of 0.32% .",
    "thus , ` redmonster ` satisfies the requirements of completeness and purity , while ` spectro1d ` does not .",
    "this improvement is illustrated by the dashed lines in figure  [ fig : drchi2_vs_failure ] .",
    "we made use of 99,449 eboss lrg targets reduced with tagged version ` v5_10_0 ` of ` idlspec2d ` to demonstrate the performance of ` redmonster ` .",
    "galaxy redshift success dependence is described in  [ sec : dependence ] , the effect on the final lrg sample redshift distribution is described in  [ sec : distribution ] , and galaxy redshift precision and accuracy in  [ sec : precision ] .",
    "a description of composite spectra and the distribution of physical galaxy parameters in the sample is given in ",
    "[ sec : composites ] .",
    "as in all redshift surveys , spectroscopic s / n is the primary determinant of redshift success . in the eboss lrg sample , 95.4% of spectra with ` zwarning ` @xmath135 0 are due solely to a ` small_delta_chi2 ` failure .",
    "figure  [ fig : failure_vs_sn ] shows the dependence of the lrg galaxy redshift failure rate as a function of the median spectroscopic signal - to - noise ratio over the sdss r , i , and z bandpass ranges .",
    "these represent the most relevant regions of the spectrum for measuring redshifts of passive galaxies over the redshift range of interest for the large - scale structure science in eboss .",
    "failure is defined in the sense of ` zwarning ` @xmath136 , so that targets confidently identified as objects other than galaxies are counted as a success for the pipeline .",
    "we see a decrease in the failure rate as a function of r - band s / n up to s / n @xmath137 , where it becomes asymptotic to @xmath138 .",
    "the @xmath95- and @xmath1-bands behave in a more expected manner , with failure rate decreasing until s / n @xmath139 , where it reaches an asymptotic minimum of @xmath140 .",
    "the @xmath95- and @xmath1-band s / n is more predictive of redshift success rate due to the 4000    break and the small number of strong narrow absorption features ( e.g. , ca h&k , na i , etc . )",
    "being located in those bands over the targeted redshift range .",
    "galaxy magnitude correlates strongly with spectroscopic s / n and hence with redshift success ; this is the motivation for the @xmath95-band magnitude limit of @xmath141 in the target selection algorithm . to assess the dependence of redshift completeness on target selection , the right panel of figure  [ fig : failure_vs_sn ] shows the lrg sample s redshift failure rate as a function of @xmath142 , defined as the @xmath95-band magnitude in a 2  diameter eboss fiber . at the formal eboss lrg magnitude cutoff ,",
    "the marginal failure rate is @xmath143 .",
    "additionally , redshift success has a weak dependence on fiber identification number along the spectrograph slit heads .",
    "the left panel in figure  [ fig : failure_vs_fiberid ] shows this effect for eboss lrgs .",
    "upturns near fibers 1 , 500 and 1000 are due to imperfections in the camera optics near the edge of the spectrograph focal plane .",
    "narrow peaks , such as those around fibers 525 - 530 , are due to bad ccd columns",
    ". fiber numbers below 500 show a higher average failure rate ( 9.4% ) than those above 500 ( 9.0% ) due to lower end - to - end throughput of spectrograph 1 relative to spectrograph 2 @xcite .    finally , we investigated the dependence of failure rate on the location of the fiber on the plug plate .",
    "the right panel of figure  [ fig : failure_vs_fiberid ] shows this relationship .",
    "the fibers within the central region covering 50% of the total area show failure rates of @xmath144 .",
    "however , near the edges and , particularly , the left and right sides of the plate , failure rates spike to values of 25% or greater .",
    "plates are generally plugged in a counter - clockwise direction , beginning in the first quadrant , meaning the right edge of the plate contains fibers near 1 and 1000 , while the left edge contains fibers near 500 ; thus , the increased failure rates at the extreme values of xfocal are primarily due to the imperfect spectrograph optics described above .      in order to quantify the effects of the ` redmonster ` spectral classification on the survey s expected cosmological constraints , we compare the resulting redshift distribution to the predictions presented in @xcite .",
    "those cosmological projections were based on the redshift distribution derived from visually inspected redshifts and classifications for 1997 lrg targets across 16 plates .",
    "plates with deeper than average observations were intentionally chosen to facilitate these visual inspections .",
    "these spectra were processed using ` idlspec2d ` tagged version ` v5_8_0 ` , and were visually inspected by ten members of the eboss team in august 2015 .",
    "each spectrum was manually assigned a redshift and spectral classification , as well as a confidence value @xmath145 ranging from 0 ( entirely uncertain ) to 3 ( entirely certain ) .",
    "a full qualitative description of all @xmath145 values is given in @xcite .",
    "a subset of plates was inspected by two people , providing a degree of self - calibration of the results .",
    "lcccccc poor spectra & 4.0 & 6.7 & 17.7 & 7.7 & 14.3 & 5.7 + stellar & 5.3 & 5.3 & 6.5 & 2.9 & 5.4 & 4.9 + @xmath146 & 0.6 & 0.6 & 0.6 & 0.5 & 0.6 & 0.5 + @xmath147 & 6.2 & 5.9 & 5.2 & 6.2 & 3.4 & 6.2 + @xmath148 & * 15.2 & * 14.8 & * 11.3 & * 14.3 & * 12.4 & * 14.7 + @xmath149 & * 15.3 & * 14.7 & * 11.4 & * 16.1 & * 12.9 & * 15.3 + @xmath150 & * 9.4 & * 8.7 & * 5.6 & * 8.8 & * 6.8 & * 8.9 + @xmath151 & * 3.2 & * 2.7 & * 1.4 & * 2.5 & * 1.7 & * 2.7 + @xmath152 & 0.5 & 0.4 & 0.3 & 0.9 & 0.3 & 1.0 + @xmath153 & 0.1 & 0.1 & 0.1 & 0.2 & 0.1 & 0.2 +   + total targets & 60 & 60 & 60 & 60 & 60 & 60 + total tracers & * 43.1 & * 41.0 & * 29.7 & * 41.7 & * 33.9 & * 41.7 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    the survey science goals require a minimum of 40 deg@xmath154 spectroscopically confirmed lrgs in the redshift range @xmath88 . to compensate for incomplete fiber assignment ,",
    "the lrg parent sample is selected at a surface density of 60 deg@xmath154 .",
    "table  [ tab : n_of_z ] shows the estimated final tracer density of the lrg sample , binned by redshift .",
    "we show the optimistic ( @xmath155 ) and conservative ( @xmath156 ) scenarios from the visual inspections alongside the ` redmonster ` and ` spectro1d ` n@xmath157 results using reduction versions ` v5_9_0 ` and ` v5_10_0 ` .",
    "the surface density of tracers is increased by ` redmonster ` relative to ` spectro1d ` by 40.4% and 23.9% in dr13 and dr14 , respectively . while the improvements to the reductions described in  [ sec : parameters ] increased the rate of successful redshifts by `",
    "spectro1d ` by 14.1% , the tracer density for ` redmonster ` remained constant at 41.7  deg@xmath154 .",
    "twenty - six percent of spectra that were previously failures were reclassified by ` redmonster ` as stars in the improved reductions . in the optimistic case using extra deep spectra ,",
    "the visual inspections report a failure of @xmath158% , while ` redmonster ` finds a failure rate of 7.4% on those same spectra .",
    "this suggests ` redmonster ` is producing failure rates nearly as low as what any software can achieve .",
    "we use the final redshift distribution from ` redmonster ` to predict changes to the cosmological projections given in @xcite .",
    "those projections were made using the conservative case ( @xmath156 ) of the visual inspections .",
    "the surface density of tracers using ` redmonster ` is increased by @xmath159 relative to those used in the projections . because the measurements of cosmological parameters are poisson - limited , `",
    "redmonster ` provides an additional 2% margin on achieving the cosmological precision expected from the eboss lrg sample .",
    "redshift errors are calculated from the curvature of the @xmath77 function in the vicinity of the value that is used to determine the best - fit redshift measurement . to assess the precision of these statistical error estimates",
    ", we used the same repeat spectra as those used to assess catastrophic failure rates .",
    "we scaled the redshift difference between the two observations by the quadrature sum of the error estimates from the spectra from each observation .",
    "we then assessed the full distribution of the velocity differences and fit it with a gaussian function .",
    "if the estimated errors accounted for all the statistical uncertainty , the fit would have a dispersion parameter of unity and a mean of zero .",
    "figure  [ fig : reobs_errors ] shows the results of this analysis .",
    "the fitted dispersion is @xmath160 and the mean is @xmath161 .",
    "thus , redshift errors are overestimated by @xmath654% , meaning that redshift estimates are more precise than reported . a similar analysis performed on the ` spectro1d ` reductions of the sdss - iii cmass ( for  constant mass \" ) galaxy sample ( @xmath162 ) in @xcite resulted in a fitted dispersion parameter of @xmath163 .",
    "next , we examine the statistical redshift error  distributions as a function of median s /",
    "n in the sdss @xmath164- , @xmath95- , and @xmath1-bands , and find a weak anti - correlation .",
    "this is as expected , and is consistent with previous sdss data sets .",
    "a summary of these statistics is given in table  [ tab : redshift_errors_sigma ] . finally , for all lrg targets",
    ", we also compute the distribution of estimated redshift errors as a function of redshift .",
    "a summary of the statistics is given in table  [ tab : redshift_errors_z ] .",
    "in all cases , typical errors are a few tens of km  s@xmath3 .",
    "they should be reduced by an additional factor of 1.54 to reflect the statistical scatter displayed in figure  [ fig : reobs_errors ] .",
    "these errors are well below the 300 km  s@xmath3 redshift precision requirement of the eboss galaxy large - scale structure and redshift space distortion science analyses .",
    "cccc @xmath164 & @xmath165 s / n @xmath166 & 34.50 & 10.41 + @xmath164 & @xmath167 s / n @xmath168 & 28.10 & 8.83 + @xmath164 & @xmath169 s / n @xmath170 & 22.38 & 7.99 + @xmath164 & @xmath171 s / n @xmath172 & 18.59 & 15.25 + @xmath95 & @xmath165 s / n @xmath166 & 52.18 & 17.40 + @xmath95 & @xmath167 s / n @xmath168 & 46.50 & 14.80 + @xmath95 & @xmath169 s / n @xmath170 & 41.56 & 12.52 + @xmath95 & @xmath171 s / n @xmath172 & 36.76 & 9.97 + @xmath95 & @xmath173 s / n @xmath174 & 32.89 & 8.88 + @xmath95 & @xmath175 s / n @xmath176 & 29.56 & 8.48 + @xmath1 & @xmath165 s / n @xmath166 & 51.51 & 16.88 + @xmath1 & @xmath167 s / n @xmath168 & 46.10 & 13.99 + @xmath1 & @xmath169 s / n @xmath170 & 40.38 & 10.96 + @xmath1 & @xmath171 s / n @xmath172 & 35.68 & 9.42 + @xmath1 & @xmath173 s / n @xmath174 & 32.02 & 8.49 + @xmath1 & @xmath175 s /",
    "n @xmath176 & 28.93 & 7.38 +    ccc @xmath148 & 37.36 & 12.24 + @xmath149 & 38.69 & 13.21 + @xmath150 & 41.70 & 15.23 + @xmath151 & 45.22 & 17.33      a primary advantage of ` redmonster ` over pca - based redshift classification techniques is the simple manner in which the best - fitting template can be translated to physical parameters . in this section ,",
    "we briefly discuss two types of analyses made possible by this parameterization .",
    "we seek only to demonstrate these possibilities and defer analysis of the results to a later work .    stacking large numbers of spectra",
    "has become a widely - used technique in extragalactic physics and cosmology .",
    "we derive composite spectra of high signal - to - noise ratios to enable analysis of the quality of our templates in relation to the true spectral features in eboss galaxies .",
    "previous work ( e.g. , @xcite ) concentrated on analyzing and averaging spectra based on observed quantities , such as color or magnitude .",
    "the physicality of the ` redmonster ` parameterization allows us to separate and bin our galaxy sample based on quantities such as age , velocity dispersion , emission line ratio and strength , metallicity , and star formation history ( sfh ) , as determined by the best - fitting template .",
    "we first binned a subset of the eboss galaxy sample based on the age of the template that produced the best - fit model .",
    "objects were chosen with best - fitting templates of zero line flux to identify a passively - evolving sample . to derive meaningful composites ,",
    "these spectra then must be normalized .",
    "due to the relatively low signal - to - noise of eboss spectra , we cropped the noisy blue- and red - end of each spectrum , and scaled the spectrum such that the median of the pixels in the wavelength range @xmath177 is unity .",
    "we scaled the template corresponding to each bin to fit the composite spectrum .",
    "example composite spectra for observed spectra best fit by the 0.56  gyr , 1.0  gyr , 1.78  gyr , 3.16  gyr , and 5.62  gyr templates are shown in figure  [ fig : comps ] ; they contain 412 , 1,486 , 14,739 , 22,288 , and 11,134 unique galaxies , respectively .",
    "we stress that these composites are selected only by template age ; metallicity is assumed to be solar @xcite and velocity dispersion is assumed to be 250  km  s@xmath3 .",
    "an example of fitting similar composites over the wavelength range @xmath178 while allowing metallicity and velocity dispersion to vary is given in @xcite .",
    "these eboss data will allow a similar analysis to be extended to shorter wavelengths .",
    "in general , the templates better describe the continuum in the red than the blue .",
    "the templates systematically over - estimate flux density between @xmath179    and @xmath180   .",
    "all three templates have a broad feature at @xmath181    that is exaggerated relative to the composite spectra , likely due to missing atomic opacities in the models .",
    "discrepancies in the continuum may be due to the effects of dust attenuation . in the core fitting algorithm",
    ", these effects can be accounted for by the polynomial nuisance vectors ;",
    "the models in this figure are scaled to the composite spectra without any polynomial terms , allowing the effects of dust in the data to appear as shortcomings in the templates . on the other hand ,",
    "the models are able to reproduce the observed behavior of the narrow - band features .",
    "all five composite spectra clearly display lines from the mg  ii doublet ( 2796    and 2803   ) , ca  h&k  ( 3934    and 3968   ) , h@xmath182  ( 4103   ) , g - band  ( 4307   ) , and h@xmath117  ( 4863   ) that are well fit by the templates . the 0.56  gyr and 1.0  gyr composite spectra have a well - fit h@xmath183 line  ( 4341   ) and more prominent balmer features , as expected from a younger stellar population . additionally , an mg  i line at 2852   , a band of mg  i absorption just blueward of ca  h&k , and an mg  i line at 5175    become more prominent at older stellar populations .",
    "finally , the template fits contain no polynomial terms ; thus , the effects of dust attenuation that are accounted for by the nuisance vectors in the core fitting algorithm    next , we evaluate the distribution of the physical parameters across the galaxy sample .",
    "these distribitions are informative of both the accuracy of the spectral features in the templates and the targeting completeness and selection bias of the survey .",
    "as an example , we again consider galaxy template age .",
    "we binned our sample into four redshift bins and show the distribution of the ages of the best - fit templates in figure  [ fig : ages_histos ] .",
    "the mean values of the four redshift bins , @xmath147 , @xmath148 , @xmath149 , and @xmath150 , are 4.9 gyr , 4.3 gyr , 3.9 gyr , and 3.7 gyr , respectively . assuming a @xmath184cdm cosmology with @xmath185 , @xmath186 km s@xmath3 mpc@xmath3 , @xmath187 , and @xmath188 @xcite",
    ", the age of the universe at redshifts @xmath189 , @xmath190 , @xmath191 , and @xmath192 , the sample mean in each bin , is 8.18 gyr , 7.61 gyr , 7.03 gyr , and 6.57 gyr , respectively .",
    "a comparison with the median template age in each bin reveals a galaxy sample that ages more slowly than the universe . due to not allowing metallicity and abundance patterns to be fit as free parameters ( as the templates in this paper use only solar metallicity ) , it is likely not possible to meaningfully interpret the ages .",
    "however , a more careful analysis could be used to investigate targeting selection bias in the survey .",
    "we have described the ` redmonster `  software that provides automated redshift measurement and spectral classification and its performance on the sdss - iv eboss lrg sample , comprising 99,449 spectra .",
    "this software provides a new algorithm and new sets of templates that restrict all spectral fitting to only physically - motivated models .",
    "the advantages over the current algorithm include robustness against unphysical solutions likely to arise for low signal - to - noise spectra ( particularly in the presence of imperfect sky - subtraction ) , determination of joint likelihood functions over redshift and physical parameters , and custom configurability of spectroscopic templates for different target classes .",
    "the redshift success rate of the ` redmonster `  software on eboss lrgs is 90.5% , meeting the eboss scientific requirement of 90% and providing a significant improvement over the previous redshift pipeline , ` spectro1d ` .",
    "the improvement translates to a 23.9% increase in the surface density of tracers that can now be used to constrain cosmology through clustering measurements .",
    "we have shown catastrophic failure rates for ` redmonster ` of 0.98% , in agreement with the scientific requirements of @xmath110% .",
    "the software also provides robust estimates of statistical redshift errors that are gaussian distributed , typically a few tens of km  s@xmath3 , well below the specified maximum of 300 km  s@xmath3 .",
    "looking forward , using @xmath193 would give ` redmonster ` a completeness of 95.7% and a catastrophic failure rate of 1.9% , which would very nearly meet the desi science requirements of at least 95% completeness and a maximum of 5% catastrophic failures on eboss data .",
    "the raw s / n in desi will be comparable to that in eboss , though the image quality in eboss two - dimensional spectra is degraded relative to the image quality we expect in the bench - mounted desi system .",
    "eboss also shows a failure rate that increases to @xmath194 near the edges of the focal plane .",
    "this is imperfect optics towards the edges of the spectrographs , which will be less significant in desi .",
    "therefore , we expect improved ` redmonster ` performance on the more well - behaved desi spectra .",
    "development work is ongoing for eboss , both in the calibration and extraction of spectra and on ` redmonster `  itself .",
    "the next priority for ` redmonster `  development is to build and test templates for elg and quasar spectra .",
    "additionally , we will incorporate simultaneous fitting to the individual exposures at their native resolution to remove covariances between neighboring pixels introduced by the co - adding process .",
    "subsequent eboss data releases will be accompanied by catalogues of redshift measurements and spectral classifications produced by ` redmonster ` .",
    "funding for the sloan digital sky survey iv has been provided by the alfred p. sloan foundation and the participating institutions .",
    "sdss - iv acknowledges support and resources from the center for high - performance computing at the university of utah .",
    "the sdss web site is www.sdss.org .",
    "sdss - iv is managed by the astrophysical research consortium for the participating institutions of the sdss collaboration including the brazilian participation group , carnegie institution for science , carnegie mellon university , the chilean participation group , harvard - smithsonian center for astrophysics , instituto de astrofsica de canarias , the johns hopkins university , kavli institute for the physics and mathematics of the universe ( ipmu ) / university of tokyo , lawrence berkeley national laboratory , leibniz institut fr astrophysik potsdam ( aip ) , max - planck - institut fr astrophysik ( mpa garching ) , max - planck - institut fr extraterrestrische physik ( mpe ) , max - planck - institut fr astronomie ( mpia heidelberg ) , national astronomical observatory of china , new mexico state university , new york university , university of notre dame , observatrio nacional do brasil , the ohio state university , pennsylvania state university , shanghai astronomical observatory , united kingdom participation group , universidad nacional autnoma de mxico , university of arizona , university of colorado boulder , university of portsmouth , university of utah , university of washington , university of wisconsin , vanderbilt university , and yale university .",
    "the work of th , ab , kd , jb , and mv was supported in part by the u.s . department of energy , office of science , office of high energy physics , under award numbers de - sc0010331 and de - sc0009959 , and that of jn and ap under award number de - sc0007914 .",
    "the ` redmonster ` software generates two output files for each input set of spectra and summary files of all objects processed by the software .",
    "the `` ` redmonsterall ` '' file is the primary output and contains all redshifts , spectral classifications , parameter estimates , and models , and is described in  [ sec : redmonsterfile ] .",
    "the  ` chi2arr ` \" file is an optional output containing the entire @xmath39 surface for a template class and is described in  [ sec : chi2arrfile ] . a more detailed description of these files can be found in the online documentation .",
    "the  ` redmonsterall ` \" file is the primary output of the software .",
    "this file contains all redshift and parameter measurements , spectral classifications , and the best fit model for each object .",
    "this output is an uncompressed fits file with all relevant information in the primary hdu header and first bin table .",
    "the contents of the bin table are detailed in table  [ tab : redmonsterfile ] .",
    "it has the naming scheme _",
    "redmonsterall-vvvvvv.fits_ , where _ vvvvvv _ is the version of the reduction used .",
    "this file is the parallel to the ` spall ` file produced by ` spectro1d ` in boss and eboss .",
    "additionally , a batch file is created for each batch of spectra processed .",
    "it is the parallel to ` spectro1d ` s ` spzall ` for an sdss plate in boss and eboss , and is named ` redmonster-pppp-mmmmm.fits ` , where ` pppp ` is the plate number and ` mmmmm ` is the mjd .",
    "the file contains a primary header , a binary extension ( similar in format to that of ` redmonsterall ` ) containing the best five redshifts and classifications for each fiber , and an imagehdu containing a two - dimensional image of the five best - fit models for all fibers .",
    "the size of this file is approximately 20 mb for 1000 spectra of @xmath195 pixels each .",
    "the software also has the ability to write the full @xmath39 surfaces for each template class to an output file .",
    "these are also uncompressed fits files .",
    "the primary hdu contains a multi - dimensional image of all @xmath9 values for a single template class for each spectrum .",
    "these files follow the naming scheme _",
    "chi2arr-ttttttt-vvvvvv.fits_ , where _ tttttt _ is the name of the template class and _ vvvvvv _ is the version of the reduction used .",
    "the primary hdu contains a multi - dimensional array of the full @xmath9 surface for that template class .",
    "these files are written per batch of spectra processed . a summary file similar to ` redmonsterall ` does not exist due to the large size of these files ( often several gb per 1000 spectra ) .",
    "ll ` fiberid ` & _ spplate _ fiber number ( 0-based ) for each object + ` plate ` & _ spplate _ plate number for each object + ` mjd ` & _ spplate _ mjd for each object + ` dof ` & degrees of freedom used to calculate @xmath196 + ` boss_target1 ` & boss targeting bit + ` eboss_target0 ` & sequels targeting bit + ` eboss_target1 ` & eboss targeting bit + ` z ` & best redshift ( least @xmath196 ) + ` z_err ` & 1-@xmath26 error associated with z + ` class ` & object type classification + ` subclass ` & best - fit template parameters + ` fname ` & full name of _ ndarch _ file of template + ` minvector ` & coordinates of best - fit template in _ ndarch _ file + ` minrchi2 ` & @xmath196 value of fit + ` npoly ` & number of additive polynomials used + ` npixstep ` & pixel step size used + ` theta ` & coefficients of template and polynomial terms in fit + ` zwarning ` & ` zwarning ` flags + ` rchi2diff ` & @xmath197 between first- and second - best fits + ` chi2null ` & @xmath198 value for each spectrum + ` sn2data ` & ( s / n)@xmath114 of each spectrum"
  ],
  "abstract_text": [
    "<S> we describe the ` redmonster ` automated redshift measurement and spectral classification software designed for the extended baryon oscillation spectroscopic survey ( eboss ) of the sloan digital sky survey iv ( sdss - iv ) . </S>",
    "<S> we describe the algorithms , the template standard and requirements , and the newly developed galaxy templates to be used on eboss spectra . </S>",
    "<S> we present results from testing on early data from eboss , where we have found a 90.5% automated redshift and spectral classification success rate for the luminous red galaxy sample ( redshifts 0.6  @xmath0  @xmath1  @xmath0  1.0 ) . the ` </S>",
    "<S> redmonster ` performance meets the eboss cosmology requirements for redshift classification and catastrophic failures , and represents a significant improvement over the previous pipeline . </S>",
    "<S> we describe the empirical processes used to determine the optimum number of additive polynomial terms in our models and an acceptable @xmath2 threshold for declaring statistical confidence . </S>",
    "<S> statistical errors on redshift measurement due to photon shot noise are assessed , and we find typical values of a few tens of km  s@xmath3 . </S>",
    "<S> an investigation of redshift differences in repeat observations scaled by error estimates yields a distribution with a gaussian mean and standard deviation of @xmath4  0.01 and @xmath5  0.65 , respectively , suggesting the accuracy of the statistical redshift errors estimates are over - estimated by @xmath6  54% . </S>",
    "<S> we assess the effects of object magnitude , signal - to - noise ratio , fiber number , and fiber head location on the pipeline s redshift success rate . </S>",
    "<S> finally , we describe directions of ongoing development . </S>"
  ]
}