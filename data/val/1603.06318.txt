{
  "article_text": [
    "deep neural networks provide a powerful mechanism for learning patterns from massive data , achieving new levels of performance on image classification  @xcite , speech recognition  @xcite , machine translation  @xcite , playing strategic board games  @xcite , and so forth .    despite the impressive advances , the widely - used dnn methods still have limitations . the high predictive accuracy has heavily relied on large amounts of labeled data ; and the purely data - driven learning can lead to uninterpretable and sometimes counter - intuitive results  @xcite .",
    "it is also difficult to encode human intention to guide the models to capture desired patterns , without expensive direct supervision or ad - hoc initialization .    on the other hand",
    ", the cognitive process of human beings have indicated that people learn not only from concrete examples ( as dnns do ) but also from different forms of general knowledge and rich experiences @xcite . _ logic rules _ provide a flexible declarative language for communicating high - level cognition and expressing structured knowledge .",
    "it is therefore desirable to integrate logic rules into dnns , to transfer human intention and domain knowledge to neural models , and regulate the learning process .    in this paper",
    ", we present a framework capable of enhancing general types of neural networks , such as convolutional networks ( cnns ) and recurrent networks ( rnns ) , on various tasks , with logic rule knowledge .",
    "combining symbolic representations with neural methods have been considered in different contexts .",
    "neural - symbolic systems  @xcite construct a network from a given rule set to execute reasoning . to exploit _ a priori _ knowledge in general neural architectures , recent work augments each raw data instance with useful features  @xcite , while network training , however , is still limited to instance - label supervision and suffers from the same issues mentioned above .",
    "besides , a large variety of structural knowledge can not be naturally encoded in the feature - label form .",
    "our framework enables a neural network to learn simultaneously from labeled instances as well as logic rules , through an _ iterative rule knowledge distillation _",
    "procedure that transfers the structured information encoded in the logic rules into the network parameters .",
    "since the general logic rules are complementary to the specific data labels , a natural `` side - product '' of the integration is the support for semi - supervised learning where unlabeled data is used to better absorb the logical knowledge .",
    "methodologically , our approach can be seen as a combination of the knowledge distillation  @xcite and the posterior regularization ( pr ) method  @xcite . in particular , at each iteration we adapt the posterior constraint principle from pr to construct a rule - regularized _ teacher _ , and train the _ student _ network of interest to imitate the predictions of the teacher network .",
    "we leverage soft logic to support flexible rule encoding .",
    "we apply the proposed framework on both cnn and rnn , and deploy on the task of sentiment analysis ( sa ) and named entity recognition ( ner ) , respectively . with only a few ( one or two ) very intuitive rules , both the distilled networks and the joint teacher networks",
    "strongly improve over their basic forms ( without rules ) , and achieve better or comparable performance to state - of - the - art models which typically have more parameters and complicated architectures .",
    "to the best of our knowledge , this is the first work to integrate logic rules with general workhorse types of deep neural networks in a principled framework .",
    "the encouraging results indicate our method can be potentially useful for incorporating richer types of human knowledge , and improving other application domains .",
    "combination of logic rules and neural networks has been considered in different contexts .",
    "neural - symbolic systems  @xcite , such as kbann  @xcite and cilp++  @xcite , construct network architectures from given rules to perform reasoning and knowledge acquisition .",
    "a related line of research , such as markov logic networks  @xcite , derives probabilistic graphical models ( rather than neural networks ) from the rule set .    with the recent success of deep neural networks in a vast variety of application domains ,",
    "it is increasingly desirable to incorporate structured logic knowledge into general types of networks to harness flexibility and reduce uninterpretability .",
    "recent work that trains on extra features from domain knowledge @xcite , while producing improved results , does not go beyond the data - label paradigm .",
    "@xcite uses a specialized training procedure with careful ordering of training instances to obtain an interpretable neural layer of an image network .",
    "@xcite develops a generative model jointly over data - labels and similarity knowledge expressed in triplet format to learn improved disentangled representations .",
    "though there do exist general frameworks that allow encoding various structured constraints on latent variable models  @xcite , they either are not directly applicable to the nn case , or could yield inferior performance as in our empirical study .",
    "@xcite transfers predictive power of pre - trained structured models to unstructured ones in a pipelined fashion .",
    "our proposed approach is distinct in that we use an iterative rule distillation process to effectively transfer rich structured knowledge , expressed in the declarative first - order logic language , into parameters of general neural networks .",
    "we show that the proposed approach strongly outperforms an extensive array of other either ad - hoc or general integration methods .",
    "in this section we present our framework which encapsulates the logical structured knowledge into a neural network .",
    "this is achieved by forcing the network to emulate the predictions of a rule - regularized teacher , and evolving both models iteratively throughout training ( section  [ sec : distill ] ) .",
    "the process is agnostic to the network architecture , and thus applicable to general types of neural models including cnns and rnns .",
    "we construct the teacher network in each iteration by adapting the posterior regularization principle in our logical constraint setting ( section  [ sec : teacher ] ) , where our formulation provides a closed - form solution . figure  [ fig : arch ] shows an overview of the proposed framework .",
    "our approach allows neural networks to learn from both specific examples and general rules .",
    "here we give the settings of these `` learning resources '' .",
    "assume we have input variable @xmath0 and target variable @xmath1 . for clarity ,",
    "we focus on @xmath2-way classification , where @xmath3 is the @xmath2-dimensional probability simplex and @xmath4 is a one - hot encoding of the class label .",
    "however , our method specification can straightforwardly be applied to other contexts such as regression and sequence learning ( e.g. , ner tagging , which is a sequence of classification decisions ) .",
    "the training data @xmath5 is a set of instantiations of @xmath6 .",
    "further consider a set of first - order logic ( fol ) rules with confidences , denoted as @xmath7 , where @xmath8 is the @xmath9th rule over the input - target space @xmath10 , and @xmath11 $ ] is the confidence level with @xmath12 indicating a hard rule , i.e. , all groundings are required to be true ( = 1 ) . here",
    "a grounding is the logic expression with all variables being instantiated . given a set of examples @xmath13 ( e.g. , a minibatch from @xmath14 ) , the set of groundings of @xmath8 are denoted as @xmath15 . in practice",
    "a rule grounding is typically relevant to only a single or subset of examples , though here we give the most general form on the entire set .",
    "we encode the fol rules using soft logic  @xcite for flexible encoding and stable optimization .",
    "specifically , soft logic allows continuous truth values from the interval @xmath16 $ ] instead of @xmath17 , and the boolean logic operators are reformulated as : @xmath18 here @xmath19 and @xmath20 are two different approximations to logical conjunction  @xcite : @xmath19 is useful as a selection operator ( e.g. , @xmath21 when @xmath22 , and @xmath23 when @xmath24 ) , while @xmath20 is an averaging operator .",
    "a neural network defines a conditional probability @xmath25 by using a softmax output layer that produces a @xmath2-dimensional soft prediction vector denoted as @xmath26 .",
    "the network is parameterized by weights @xmath27 .",
    "standard neural network training has been to iteratively update @xmath27 to produce the correct labels of training instances . to integrate the information encoded in the rules , we propose to train the network to also imitate the outputs of a rule - regularized projection of @xmath25 , denoted as @xmath28 , which explicitly includes rule constraints as regularization terms . in each iteration @xmath29",
    "is constructed by projecting @xmath30 into a subspace constrained by the rules , and thus has desirable properties .",
    "we present the construction in the next section .",
    "the prediction behavior of @xmath29 reveals the information of the regularized subspace and structured rules .",
    "emulating the @xmath29 outputs serves to transfer this knowledge into @xmath31 . the new objective is then formulated as a balancing between imitating the soft predictions of @xmath29 and predicting the true hard labels : @xmath32 where @xmath33 denotes the loss function selected according to specific applications ( e.g. , the cross entropy loss for classification ) ; @xmath34 is the soft prediction vector of @xmath29 on @xmath35 at iteration @xmath36 ; and @xmath37 is the imitation parameter calibrating the relative importance of the two objectives .    a similar imitation procedure has been used in other settings such as model compression  @xcite where the process is termed _",
    "distillation_. following them we call @xmath25 the `` student '' and @xmath38 the `` teacher '' , which can be intuitively explained in analogous to human education where a teacher is aware of systematic general rules and she instructs students by providing her solutions to particular questions ( i.e. , the soft predictions ) .",
    "an important difference from previous distillation work , where the teacher is obtained beforehand and the student is trained thereafter , is that our teacher and student are learned simultaneously during training .    though it is possible to combine a neural network with rule constraints by projecting the network to the rule - regularized subspace after it is fully trained as before with only data - label instances , or by optimizing projected network directly , we found our iterative teacher - student distillation approach provides a much superior performance , as shown in the experiments .",
    "moreover , since @xmath31 distills the rule information into the weights @xmath27 instead of relying on explicit rule representations , we can use @xmath31 for predicting new examples at test time when the rule assessment is expensive or even unavailable ( i.e. , the _ privileged information _ setting  @xcite ) while still enjoying the benefit of integration .",
    "besides , the second loss term in eq . can be augmented with rich unlabeled data in addition to the labeled examples , which enables _ semi - supervised _ learning for better absorbing the rule knowledge .",
    "we now proceed to construct the teacher network @xmath28 at each iteration from @xmath25 .",
    "the iteration index @xmath36 is omitted for clarity .",
    "we adapt the posterior regularization principle in our logic constraint setting .",
    "our formulation ensures a closed - form solution for @xmath29 and thus avoids any significant increases in computational overhead .",
    "recall the set of fol rules @xmath7 .",
    "our goal is to find the optimal @xmath29 that fits the rules while at the same time staying close to @xmath31 .",
    "for the first property , we apply a commonly - used strategy that imposes the rule constraints on @xmath29 through an expectation operator .",
    "that is , for each rule ( indexed by @xmath9 ) and each of its groundings ( indexed by @xmath39 ) on @xmath40 , we expect @xmath41=1 $ ] , with confidence @xmath42 .",
    "the constraints define a rule - regularized space of all valid distributions . for the second property",
    ", we measure the closeness between @xmath29 and @xmath31 with kl - divergence , and wish to minimize it . combining the two factors together and further allowing slackness for the constraints , we finally get the following optimization problem : @xmath43 ) \\leq \\xi_{l , g_l } \\\\ & \\ g_l = 1 , \\dots , g_l,\\ \\",
    "l = 1 , \\dots ,",
    "l , \\end{split}\\ ] ] where @xmath44 is the slack variable for respective logic constraint ; and @xmath45 is the regularization parameter . the problem can be seen as projecting @xmath31 into the constrained subspace .",
    "the problem is convex and can be efficiently solved in its dual form with closed - form solutions .",
    "we provide the detailed derivation in the supplementary materials and directly give the solution here : @xmath46 intuitively , a strong rule with large @xmath42 will lead to low probabilities of predictions that fail to meet the constraints .",
    "we discuss the computation of the normalization factor in section  [ sec : implement ] .",
    "our framework is related to the posterior regularization ( pr ) method @xcite which places constraints over model posterior in unsupervised setting . in classification ,",
    "our optimization procedure is analogous to the modified em algorithm for pr , by using cross - entropy loss in eq . and",
    "evaluating the second loss term on unlabeled data differing from @xmath14 , so that eq . corresponds to the e - step and eq .",
    "is analogous to the m - step .",
    "this sheds light from another perspective on why our framework would work .",
    "however , we found in our experiments ( section  [ sec : exp ] ) that to produce strong performance it is crucial to use the same labeled data @xmath35 in the two losses of eq . so as to form a direct trade - off between imitating soft predictions and predicting correct hard labels .",
    "the procedure of iterative distilling optimization of our framework is summarized in algorithm  [ alg : opt ] .    during training",
    "we need to compute the soft predictions of @xmath29 at each iteration , which is straightforward through direct enumeration if the rule constraints in eq .",
    "are factored in the same way as the base neural model @xmath31 ( e.g. , the `` but''-rule of sentiment classification in section  [ sec : sent ] ) . if the constraints introduce additional dependencies , e.g. , bi - gram dependency as the transition rule in the ner task ( section  [ sec : ner ] ) , we can use dynamic programming for efficient computation . for higher - order constraints ( e.g. , the listing rule in ner ) , we approximate through gibbs sampling that iteratively samples from @xmath47 for each position @xmath48 .",
    "if the constraints span multiple instances , we group the relevant instances in minibatches for joint inference ( and randomly break some dependencies when a group is too large ) .",
    "note that calculating the soft predictions is efficient since only one nn forward pass is required to compute the base distribution @xmath49 ( and few more , if needed , for calculating the truth values of relevant rules ) .    [",
    "[ p - v.s .- q - at - test - time ] ] @xmath50 v.s .",
    "@xmath29 at test time + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    at test time we can use either the distilled student network @xmath50 , or the teacher network @xmath29 after a final projection .",
    "our empirical results show that both models substantially improve over the base network that is trained with only data - label instances . in general @xmath29 performs better than @xmath50 .",
    "particularly , @xmath29 is more suitable when the logic rules introduce additional dependencies ( e.g. , spanning over multiple examples ) , requiring joint inference .",
    "in contrast , as mentioned above , @xmath50 is more lightweight and efficient , and useful when rule evaluation is expensive or impossible at prediction time .",
    "our experiments compare the performance of @xmath50 and @xmath29 extensively .",
    "[ [ imitation - strength - pi ] ] imitation strength @xmath37 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the imitation parameter @xmath37 in eq .",
    "balances between emulating the teacher soft predictions and predicting the true hard labels . since the teacher network is constructed from @xmath31 , which , at the beginning of training , would produce low - quality predictions , we thus favor predicting the true labels more at initial stage .",
    "as training goes on , we gradually bias towards emulating the teacher predictions to effectively distill the structured knowledge .",
    "specifically , we define @xmath51 at iteration @xmath52 , where @xmath53 specifies the speed of decay and @xmath54 is a lower bound .",
    "the training data @xmath55 , +   the rule set @xmath56 , +   parameters : @xmath37  imitation parameter +  @xmath45  regularization strength initialize neural network parameter @xmath27 sample a minibatch @xmath57 construct teacher network @xmath29 with eq .",
    "transfer knowledge into @xmath31 by updating @xmath27 with eq .",
    "distill student network @xmath31 and teacher network @xmath29",
    "we have presented our framework that is general enough to improve various types of neural networks with rules , and easy to use in that users are allowed to impose their knowledge and intentions through the declarative first - order logic . in this section",
    "we illustrate the versatility of our approach by applying it on two workhorse network architectures , i.e. , convolutional network and recurrent network , on two representative applications , i.e. , _ sentence - level sentiment analysis _ which is a classification problem , and _ named entity recognition _ which is a sequence learning problem .    for each task , we first briefly describe the base neural network .",
    "since we are not focusing on tuning network architectures , we largely use the same or similar networks to previous successful neural models .",
    "we then design the linguistically - motivated rules to be integrated .",
    "sentence - level sentiment analysis is to identify the sentiment ( e.g. , positive or negative ) underlying an individual sentence .",
    "the task is crucial for many opinion mining applications .",
    "one challenging point of the task is to capture the contrastive sense ( e.g. , by conjunction `` but '' ) within a sentence .",
    "[ [ base - network ] ] base network + + + + + + + + + + + +    we use the single - channel convolutional network proposed in @xcite . the simple model has achieved compelling performance on various sentiment classification benchmarks .",
    "the network contains a convolutional layer on top of word vectors of a given sentence , followed by a max - over - time pooling layer and then a fully - connected layer with softmax output activation .",
    "a convolution operation is to apply a filter to word windows .",
    "multiple filters with varying window sizes are used to obtain multiple features .",
    "figure  [ fig : base - nn ] , left panel , shows the network architecture .",
    "[ [ logic - rules ] ] logic rules + + + + + + + + + + +    one difficulty for the plain neural network is to identify contrastive sense in order to capture the dominant sentiment precisely . the conjunction word `` but '' is one of the strong indicators for such sentiment changes in a sentence , where the sentiment of clauses following `` but '' generally dominates .",
    "we thus consider sentences @xmath58 with an `` a - but - b '' structure , and expect the sentiment of the whole sentence to be consistent with the sentiment of clause @xmath59 .",
    "the logic rule is written as : @xmath60 where @xmath61 is an indicator function that takes 1 when its argument is true , and 0 otherwise ; class ` + ' represents ` positive ' ; and @xmath62 is the element of @xmath63 for class +. by eq .",
    ", when @xmath58 has the ` a - but - b ' structure , the truth value of the above logic rule equals to @xmath64 when @xmath65 , and @xmath66 otherwise   with @xmath19 in eq .",
    "leads to a probably more intuitive rule which takes the value @xmath62 when @xmath65 , and @xmath67 otherwise . ] .",
    "note that here we assume two - way classification ( i.e. , positive and negative ) , though it is straightforward to design rules for finer grained sentiment classification .",
    "ner is to locate and classify elements in text into entity categories such as `` persons '' and `` organizations '' .",
    "it is an essential first step for downstream language understanding applications .",
    "the task assigns to each word a named entity tag in an `` x - y '' format where x is one of bieos ( beginning , inside , end , outside , and singleton ) and y is the entity category .",
    "a valid tag sequence has to follow certain constraints by the definition of the tagging scheme .",
    "besides , text with structures ( e.g. , lists ) within or across sentences can usually expose some consistency patterns .",
    "[ [ base - network-1 ] ] base network + + + + + + + + + + + +    the base network has a similar architecture with the bi - directional lstm recurrent network ( called blstm - cnn ) proposed in @xcite for ner which has outperformed most of previous neural models .",
    "the model uses a cnn and pre - trained word vectors to capture character- and word - level information , respectively .",
    "these features are then fed into a bi - directional rnn with lstm units for sequence tagging .",
    "compared to @xcite we omit the character type and capitalization features , as well as the additive transition matrix in the output layer .",
    "figure  [ fig : base - nn ] , right panel , shows the network architecture .",
    "[ [ logic - rules-1 ] ] logic rules + + + + + + + + + + +    the base network largely makes independent tagging decisions at each position , ignoring the constraints on successive labels for a valid tag sequence ( e.g. , i - org can not follow b - per ) .",
    "in contrast to recent work  @xcite which adds a conditional random field ( crf ) to capture bi - gram dependencies between outputs , we instead apply logic rules which does not introduce extra parameters to learn . an example rule is : @xmath68 the confidence levels are set to @xmath69 to prevent any violation .",
    "we further leverage the _ list _ structures within and across sentences of the same documents .",
    "specifically , named entities at corresponding positions in a list are likely to be in the same categories .",
    "for instance , in `` 1 .",
    "juventus , 2 .",
    "barcelona , 3 . ... '' we know `` barcelona '' must be an organization rather than a location , since its counterpart entity `` juventus '' is an organization .",
    "we describe our simple procedure for identifying lists and counterparts in the supplementary materials .",
    "the logic rule is encoded as : @xmath70 where @xmath71 is the one - hot encoding of @xmath72 ( the class prediction of @xmath73 ) ; @xmath74 collapses the probability mass on the labels with the same categories into a single probability , yielding a vector with length equaling to the number of categories .",
    "we use @xmath75 distance as a measure for the closeness between predictions of @xmath73 and its counterpart @xmath76 . note that the distance takes value in @xmath16 $ ] which is a proper soft truth value .",
    "the list rule can span multiple sentences ( within the same document ) .",
    "we found the teacher network @xmath29 that enables explicit joint inference provides much better performance over the distilled student network @xmath50 ( section  [ sec : exp ] ) .",
    "we validate our framework by evaluating its applications of sentiment classification and named entity recognition on a variety of public benchmarks . by integrating the simple yet effective rules with the base networks ,",
    "we obtain substantial improvements on both tasks and achieve state - of - the - art or comparable results to previous best - performing systems .",
    "comparison with a diverse set of other rule integration methods demonstrates the unique effectiveness of our framework .",
    "our approach also shows promising potentials in the semi - supervised learning and sparse data context .    throughout the experiments we set the regularization parameter to @xmath77 . in sentiment classification",
    "we set the imitation parameter to @xmath78 , while in ner @xmath79 to downplay the noisy listing rule .",
    "the confidence levels of rules are set to @xmath80 , except for hard constraints whose confidence is @xmath69 . for neural network configuration , we largely followed the reference work , as specified in the following respective sections .",
    "all experiments were performed on a linux machine with eight 4.0ghz cpu cores , one tesla k40c gpu , and 32 gb ram .",
    "we implemented neural networks using theano  , a popular deep learning platform .",
    "we test our method on a number of commonly used benchmarks , including * 1 ) sst2 * , stanford sentiment treebank @xcite which contains 2 classes ( negative and positive ) , and 6920/872/1821 sentences in the train / dev / test sets respectively .",
    "following @xcite we train models on both sentences and phrases since all labels are provided . *",
    "2 ) mr * @xcite , a set of 10,662 one - sentence movie reviews with negative or positive sentiment . *",
    "3 ) cr * @xcite , customer reviews of various products , containing 2 classes and 3,775 instances . for mr and cr ,",
    "we use 10-fold cross validation as in previous work . in each of the three datasets , around 15% sentences",
    "contains the word `` but '' .    for the base neural network we use the `` non - static '' version in @xcite with the exact same configurations .",
    "specifically , word vectors are initialized using word2vec @xcite and fine - tuned throughout training , and the neural parameters are trained using sgd with the adadelta update rule @xcite .",
    "r l200pt l40pt l60pt l55pt & model & sst2 & mr & cr + 1 & cnn  @xcite & 87.2 & 81.3@xmath810.1 & 84.3@xmath810.2 + 2 & cnn - rule-@xmath50 & 88.8 & 81.6@xmath810.1 & 85.0@xmath810.3 + 3 & cnn - rule-@xmath29 & 89.3 & * 81.7@xmath810.1 * & * 85.3@xmath810.3 * + 4 & mgnc - cnn  @xcite & 88.4 &  &  + 5 & mvcnn  @xcite & * 89.4 * &  &  + 6 & cnn - multichannel  @xcite & 88.1 & 81.1 & 85.0 + 7 & paragraph - vec  @xcite & 87.8 &  &  + 8 & crf - pr  @xcite &  &  & 82.7 + 9 & rntn  @xcite & 85.4 &  &  + 10 & g - dropout  @xcite &  & 79.0 & 82.1 +      table  [ tab : sent ] shows the sentiment classification performance .",
    "rows 1 - 3 compare the base neural model with the models enhanced by our framework with the `` but''-rule ( eq . ) .",
    "we see that our method provides a strong boost on accuracy over all three datasets .",
    "the teacher network @xmath29 further improves over the student network @xmath50 , though the student network is more widely applicable in certain contexts as discussed in sections  [ sec : distill ] and  [ sec : implement ] .",
    "rows 4 - 10 show the accuracy of recent top - performing methods . on the mr and cr datasets ,",
    "our model outperforms all the baselines .",
    "on sst2 , mvcnn  @xcite ( row 5 ) is the only system that shows a slightly better result than ours .",
    "their neural network has combined diverse sets of pre - trained word embeddings ( while we use only word2vec ) and contained more neural layers and parameters than our model .    to further investigate the effectiveness of our framework in integrating structured rule knowledge , we compare with an extensive array of other possible integration approaches .",
    "table  [ tab : sent - internal ] lists these methods and their performance on the sst2 task .",
    "we see that : 1 ) although all methods lead to different degrees of improvement , our framework outperforms all other competitors with a large margin .",
    "2 ) in particular , compared to the pipelined method in row 6 which is in analogous to the structure compilation work  @xcite , our iterative distillation ( section  [ sec : distill ] ) provides better performance .",
    "another advantage of our method is that we only train one set of neural parameters , as opposed to two separate sets as in the pipelined approach .",
    "3 ) the distilled student network `` -rule-@xmath50 '' achieves much superior accuracy compared to the base cnn , as well as `` -project '' and `` -opt - project '' which explicitly project cnn to the rule - constrained subspace .",
    "this validates that our distillation procedure transfers the structured knowledge into the neural parameters effectively .",
    "the inferior accuracy of `` -opt - project '' can be partially attributed to the poor performance of its neural network part which achieves only 85.1% accuracy and leads to inaccurate evaluation of the `` but''-rule in eq ..",
    "r l l & model & accuracy ( % ) + 1 & cnn  @xcite & 87.2 + 2 & -but - clause & 87.3 + 3 & -@xmath75-reg & 87.5 + 4 & -project & 87.9 + 5 & -opt - project & 88.3 + 6 & -pipeline & 87.9 + 7 & -rule-@xmath50 & 88.8 + 8 & -rule-@xmath29 & * 89.3 * +    r l l l l l & data size & 5% & 10% & 30% & 100% + 1 & cnn & 79.9 & 81.6 & 83.6 & 87.2 + 2 & -rule-@xmath50 & 81.5 & 83.2 & 84.5 & 88.8 + 3 & -rule-@xmath29 & 82.5 & 83.9 & 85.6 & * 89.3 * + 4 & -semi - pr & 81.5 & 83.1 & 84.6 & ",
    "+ 5 & -semi - rule-@xmath50 & 81.7 & 83.3 & 84.7 &  + 6 & -semi - rule-@xmath29 & * 82.7 * & * 84.2 * & * 85.7 * &",
    " +    we next explore the performance of our framework with varying numbers of labeled instances as well as the effect of exploiting unlabeled data .",
    "intuitively , with less labeled examples we expect the general rules would contribute more to the performance , and unlabeled data should help better learn from the rules .",
    "this can be a useful property especially when data are sparse and labels are expensive to obtain .",
    "table  [ tab : sent - semi ] shows the results .",
    "the subsampling is conducted on the sentence level .",
    "that is , for instance , in `` 5% ''",
    "we first selected 5% training sentences uniformly at random , then trained the models on these sentences as well as their phrases .",
    "the results verify our expectations .",
    "1 ) rows 1 - 3 give the accuracy of using only data - label subsets for training . in every setting",
    "our methods consistently outperform the base cnn .",
    "2 ) `` -rule-@xmath29 '' provides higher improvement on 5% data ( with margin 2.6% ) than on larger data ( e.g. , 2.3% on 10% data , and 2.0% on 30% data ) , showing promising potential in the sparse data context .",
    "3 ) by adding unlabeled instances for semi - supervised learning as in rows 5 - 6 , we get further improved accuracy .",
    "4 ) row 4 , `` -semi - pr '' is the posterior regularization  @xcite which imposes the rule constraint through only unlabeled data during training .",
    "our distillation framework consistently provides substantially better results .",
    "we evaluate on the well - established conll-2003 ner benchmark  @xcite , which contains 14,987/3,466/3,684 sentences and 204,567/51,578/46,666 tokens in train / dev / test sets , respectively .",
    "the dataset includes 4 categories , i.e. , _ person , location , organization _ , and _",
    "misc_. bioes tagging scheme is used .",
    "around 1.7% named entities occur in lists .",
    "we use the mostly same configurations for the base blstm network as in @xcite , except that , besides the slight architecture difference ( section  [ sec : ner ] ) , we apply adadelta for parameter updating .",
    "glove  @xcite word vectors are used to initialize word features .",
    "@r l l@ & model & f1 + 1 & blstm & 89.55 + 2 & blstm - rule - trans & @xmath50 : 89.80 ,  @xmath29 : 91.11 + 3 & blstm - rules & @xmath50 : 89.93 ,  @xmath29 : * 91.18 * + 4 & nn - lex  @xcite & 89.59 + 5 & s - lstm  @xcite & 90.33 + 6 & blstm - lex  @xcite & 90.77 + 7 & blstm - crf@xmath82  @xcite & 90.94 + 8 & joint - ner - el  @xcite & 91.20 + 9 & blstm - crf@xmath83  @xcite & * 91.21 * +      table  [ tab : ner ] presents the performance on the ner task . by incorporating the bi - gram transition rules ( row 2 ) ,",
    "the joint teacher model @xmath29 achieves 1.56 improvement in f1 score that outperforms most previous neural based methods ( rows 4 - 7 ) , including the blstm - crf model  @xcite which applies a conditional random field ( crf ) on top of a blstm in order to capture the transition patterns and encourage valid sequences . in contrast , our method implements the desired constraints in a more straightforward way by using the declarative logic rule language , and at the same time does not introduce extra model parameters to learn .",
    "further integration of the list rule ( row 3 ) provides a second boost in performance , achieving an f1 score very close to the best - performing systems including joint - ner - el  @xcite ( row 8) , a probabilistic graphical model optimizing ner and entity linking jointly with massive external resources , and blstm - crf  @xcite , a combination of blstm and crf with more parameters than our rule - enhanced neural networks .    from the table",
    "we see that the accuracy gap between the joint teacher model @xmath29 and the distilled student @xmath50 is relatively larger than in the sentiment classification task ( table  [ tab : sent ] ) .",
    "this is because in the ner task we have used logic rules that introduce extra dependencies between adjacent tag positions as well as multiple instances , making the explicit joint inference of @xmath29 useful for fulfilling these structured constraints .",
    "we have developed a framework which combines deep neural networks with first - order logic rules to allow integrating human knowledge and intentions into the neural models . in particular",
    ", we proposed an iterative distillation procedure that transfers the structured information of logic rules into the weights of neural networks .",
    "the transferring is done via a teacher network constructed using the posterior regularization principle .",
    "our framework is general and applicable to various types of neural architectures . with a few intuitive rules ,",
    "our framework significantly improves base networks on sentiment analysis and named entity recognition , demonstrating the practical significance of our approach .",
    "though we have focused on first - order logic rules , we leveraged soft logic formulation which can be easily extended to general probabilistic models for expressing structured distributions and performing inference and reasoning @xcite .",
    "we plan to explore these diverse knowledge representations to guide the dnn learning .",
    "the proposed iterative distillation procedure also reveals connections to recent neural autoencoders  @xcite where generative models encode probabilistic structures and neural recognition models distill the information through iterative optimization  @xcite .",
    "the encouraging empirical results indicate a strong potential of our approach for improving other application domains such as vision tasks , which we plan to explore in the future .",
    "finally , we also would like to generalize our framework to automatically learn the confidence of different rules , and derive new rules from data .",
    "we thank the anonymous reviewers for their valuable comments . this work is supported by nsf iis1218282 , nsf iis1447676 , air force fa8721 - 05-c-0003 , and fa8750 - 12 - 2 - 0342 .",
    "we provide the detailed derivation for solving the problem in eq . , section  [ sec : teacher ] , which we repeat here : @xmath84 ) \\leq \\xi_{l , g_l } \\\\ & \\ g_l = 1 , \\dots , g_l,\\ \\",
    "l = 1 , \\dots ,",
    "l , \\end{split}\\ ] ]      the lagrangian is @xmath85 where @xmath86 - \\xi_{l , g_l } \\right ) + \\alpha(\\sum_{{{{\\boldsymbol{\\mathbf{}}}}}{y}}q({{{\\boldsymbol{\\mathbf{}}}}}{y}|{{{\\boldsymbol{\\mathbf{}}}}}{x } ) - 1 ) \\end{split}\\ ] ] solving eq . , we obtain @xmath87 + \\alpha = 0\\\\ & \\qquad\\qquad\\longrightarrow\\qquad q({{{\\boldsymbol{\\mathbf{}}}}}{y}|{{{\\boldsymbol{\\mathbf{}}}}}{x } ) = \\frac{p_\\theta({{{\\boldsymbol{\\mathbf{}}}}}{y}|{{{\\boldsymbol{\\mathbf{}}}}}{x } ) \\exp\\left\\{-\\sum_{l}\\eta_{l}\\lambda_{l}(1-r_{l , g_l}({{{\\boldsymbol{\\mathbf{}}}}}{x},{{{\\boldsymbol{\\mathbf{}}}}}{y}))\\right\\}}{e\\exp(\\alpha ) } \\end{split}\\ ] ]              we design a simple pattern - matching based method to identify lists and counterparts in the ner task .",
    "we ensure high precision and do not expect high recall .",
    "in particular , we only retrieve lists that with the pattern `` 1 . ...",
    "3 . ... '' ( i.e. , indexed by numbers ) , and `` - ... - ... - ... '' ( i.e. , each item marked with `` - '' ) .",
    "we require at least 3 items to form a list .",
    "we further require the text of each item follows certain patterns to ensure the text is highly likely to be named entities , and rule out those lists whose item text is largely free text .",
    "specifically , we require 1 ) all words of the item text all start with capital letters ; 2 ) referring the text between punctuations as `` block '' , each block includes no more than 3 words .",
    "we detect both intra - sentence lists and inter - sentence lists in documents .",
    "we found the above patterns are effective to identify true lists .",
    "a better list detection method is expected to further improve our ner results ."
  ],
  "abstract_text": [
    "<S> combining deep neural networks with structured logic rules is desirable to harness flexibility and reduce uninterpretability of the neural models . </S>",
    "<S> we propose a general framework capable of enhancing various types of neural networks ( e.g. , cnns and rnns ) with declarative first - order logic rules . </S>",
    "<S> specifically , we develop an iterative distillation method that transfers the structured information of logic rules into the weights of neural networks . </S>",
    "<S> we deploy the framework on a cnn for sentiment analysis , and an rnn for named entity recognition . with a few highly intuitive rules , </S>",
    "<S> we obtain substantial improvements and achieve state - of - the - art or comparable results to previous best - performing systems . </S>"
  ]
}