{
  "article_text": [
    "aster models [ @xcite ] are a partial generalization of generalized linear models ( glm ) that allow different components of the response vector to have different families ( some bernoulli , some poisson , some zero - truncated poisson , some normal ) and also to be dependent , the dependence being specified by a simple graphical model . because of the way they incorporate dependence among components of the response , aster models are not glm nor like other regression models with which statisticians are familiar , but they are special cases of graphical models and of exponential families .",
    "although aster models can be used whenever their assumptions hold [ for which see @xcite ] , they were designed particularly for life history analysis of plants and animals , which aims to model total lifetime reproductive output ( observed darwinian fitness ) , a random variable that fits no familiar distribution , often having a large atom at zero ( individuals that died before producing offspring ) as well as multiple modes .",
    "aster models can fit such data adequately by using data on other components of fitness ( survival in each year , number of flowers in each year , number of seeds in each year , and number of seeds that germinate in each year for a plant and similar sorts of data for other organisms ) and modeling all these data jointly .",
    "it often turns out that , although the marginal distribution of total lifetime reproductive output is intractable , the conditional distribution of each component of the response vector given some other component is tractable ( e.g. , number of seeds per flower is poisson ) .",
    "biologists had recognized for decades that no statistical methods before aster allowed valid statistical analysis of life history data [ @xcite ] , so aster models are becoming widely used .",
    "here we extend aster models to allow for random effects .",
    "our applications illustrate three areas where random effects models are traditional .",
    "first , when one categorical predictor is nested within another , the effects for the nested predictor are commonly treated as random , especially when they are nuisance parameters .",
    "this is seen in both of our analyses of local adaptation .",
    "second , when levels of a categorical predictor ( such as years ) are not interesting in themselves but only as representatives of a larger population , the corresponding effects are commonly treated as random .",
    "this is seen in one of our analyses of local adaptation .",
    "third , @xcite , a paper that was the forerunner of all random effects models , introduced the idea of random effects representing the cumulative effects of many genes . to obtain evolutionary predictions from life history analysis ,",
    "random effects models are necessary .",
    "this is seen in our analysis of genetic variance for fitness .",
    "( mapping the genes that contribute to variation in fitness is not feasible ; the number of them is so large , and many are individually of such small effect , that it is unrealistic to generate a sufficiently large study population to detect an informative subset of them [ @xcite ] . if there were only a few genes for fitness , then sequencing and `` machine learning '' would help , but there is no sparsity here . ) as with glm with random effects ( generalized linear mixed models , glmm ) , aster models with random effects have analytically intractable likelihoods necessitating the use of monte carlo , numerical integration or approximate likelihood .",
    "markov chain monte carlo likelihood inference has a rich literature [ @xcite ] , but we have avoided it because it is very computationally intensive and also very difficult for ordinary users to do correctly .",
    "ordinary monte carlo [ @xcite ] has also been used , but is also very computationally intensive . numerical integration [ @xcite ]",
    "is useful when there is only one variance component but not otherwise [ @xcite , section  7.2 ] , and we have avoided this too .",
    "approximate integrated likelihood ( ail ) is based on the idea that if the complete data log likelihood were quadratic in the random effects , then the random effects could be integrated out analytically , and if the complete data log likelihood is only close to quadratic in the random effects , then this is a reasonable approximation , usually referred to as laplace approximation [ @xcite ] . for sufficiently large sample sizes and sufficiently few random effects ,",
    "the log likelihood is asymptotically expected to be approximately quadratic [ @xcite , chapter  6 ; @xcite ] , so this approximation may work well .",
    "we use a second approximation , also introduced by @xcite , that is likewise an assumption that the log likelihood is close to quadratic in the random effects .",
    "if the complete data log likelihood were exactly quadratic in the random effects , then all derivatives higher than second would be zero , and we assume this . since the ail already involves second derivatives with respect to the random effects of the complete data log likelihood , second derivatives of the log ail would involve fourth derivatives of the complete data log likelihood and would be computationally intractable .",
    "this approximation allows us to compute approximate second derivatives of the log ail and hence approximate observed fisher information .",
    "although we are particularly interested in aster models , our theory works for any exponential family model .",
    "the log likelihood can be written @xmath0 where @xmath1 is the canonical statistic vector , @xmath2 is the canonical parameter vector , and the cumulant function @xmath3 satisfies @xmath4 where @xmath5 denotes the vector of first partial derivatives and @xmath6 denotes the matrix of second partial derivatives .    we assume a canonical affine submodel with random effects determined by @xmath7 where @xmath8 is a known vector , @xmath9 and @xmath10 are known matrices , @xmath11 is a normal random vector with mean vector zero and variance matrix @xmath12 .",
    "the vector @xmath8 is called the _ offset vector _ and the matrices @xmath9 and @xmath10 are called the _ model matrices _ for fixed and random effects , respectively , in the terminology of the r function ` glm ` .",
    "we assume the matrix @xmath12 is diagonal , so the random effects are independent random variables .",
    "the diagonal components of @xmath12 are called _ variance components_.    the unknown parameter vectors are @xmath13 and @xmath14 , where @xmath14 is the vector of variance components .",
    "thus , @xmath12 is a function of @xmath14 , although this is not indicated by the notation .",
    "typically each variance component corresponds to many random effects , so each component of @xmath14 occurs multiple times as a diagonal element of @xmath12 .    in order to agree with the optimization literature , we prefer to minimize rather than maximize .",
    "thus , we use minus log likelihoods . minus",
    "the complete data log likelihood is @xmath15 in case none of the variance components are zero .",
    "we deal with the case of zero variance components in sections  [ secroot ] and [ seczero ] .",
    "let @xmath16 denote the result of minimizing ( [ eqfoo ] ) considered as a function of @xmath11 for fixed @xmath13 and @xmath14 .",
    "since minus the log likelihood of an exponential family is a convex function [ @xcite , theorem 9.1 ] and the middle term on the right - hand side of ( [ eqfoo ] ) is a strictly convex function , it follows that ( [ eqfoo ] ) considered as a function of @xmath11 for fixed @xmath13 and @xmath14 is a strictly convex function",
    ". moreover , this function has bounded level sets , because the first term on the right - hand side of ( [ eqfoo ] ) is bounded below [ @xcite , theorems 4 and 6 ] and the second term has bounded level sets .",
    "it follows that there is a unique global minimizer [ @xcite , theorems 1.9 and 2.6 ] .",
    "thus , @xmath17 is well defined for all values of @xmath13 and @xmath14 .",
    "we define minus the log ail to be @xmath18\\\\[-8pt ] & & { } + \\tfrac{1}{2 } \\log \\det \\bigl [ z^t w\\bigl(a + m \\alpha+ z",
    "b^*\\bigr ) z d + i \\bigr],\\nonumber\\end{aligned}\\ ] ] where @xmath19 denotes the identity matrix of the appropriate dimension , where @xmath16 is a function of @xmath13 and @xmath14 and @xmath12 is a function of @xmath14 , although this is not indicated by the notation .",
    "our equation ( [ eqlog - pickle ] ) is the negation of equation ( 5 ) in @xcite , who introduced the terminology _ penalized quasi - likelihood _ ( pql ) for this approach .",
    "minimizing ( [ eqlog - pickle ] ) gives approximate maximum likelihood estimates of @xmath13 and @xmath14 , and differentiating ( [ eqlog - pickle ] ) twice gives an approximate observed fisher information matrix .",
    "however , ( [ eqlog - pickle ] ) is not easy to differentiate because @xmath20 is already the second derivative matrix of the cumulant function , so second derivatives of ( [ eqlog - pickle ] ) involve fourth derivatives of the cumulant function . for aster models",
    "there are no published formulas for derivatives higher than second of the aster model cumulant function and the software [ the r package ` aster ` , @xcite ] does not compute them .",
    "the derivatives do , of course , exist because every cumulant function of a regular exponential family is infinitely differentiable at every point of the canonical parameter space [ @xcite , theorem 8.1 ] .",
    "thus , we ignore derivatives higher than second , which is equivalent to assuming @xmath20 is constant or that @xmath3 and @xmath21 are quadratic .",
    "this leads to the following idea . rather than basing inference on ( [ eqlog - pickle ] ) , we actually use @xmath22,\\hspace*{-28pt}\\ ] ] where @xmath23 is a constant matrix ( not a function of @xmath13 and @xmath14 ) .",
    "this makes sense for any choice of @xmath23 that is symmetric and positive semidefinite , but we will choose @xmath23 that are close to @xmath24 , where @xmath25 and @xmath26 are the joint minimizers of ( [ eqlog - pickle ] ) and @xmath27 .",
    "note that ( [ eqlog - pickle - too ] ) is a redefinition of @xmath28 .",
    "hereafter we will no longer use the definition ( [ eqlog - pickle ] ) .    introduce @xmath29,\\hspace*{-22pt}\\ ] ] where , as the left - hand side says , @xmath13 , @xmath11 and @xmath14 are all free variables and , as usual , @xmath12 is a function of @xmath14 .",
    "since the terms that contain @xmath11 are the same in both ( [ eqfoo ] ) and ( [ eqkey ] ) , @xmath16 can also be defined as the result of minimizing ( [ eqkey ] ) considered as a function of @xmath11 for fixed @xmath13 and @xmath14 .",
    "thus , ( [ eqlog - pickle - too ] ) is a profile of ( [ eqkey ] ) and @xmath30 is the joint minimizer of ( [ eqkey ] ) .",
    "we now switch notation for partial derivatives , using subscripts to indicate derivatives , explained in more detail in section  1.6 of the accompanying technical report [ @xcite ]",
    ". then second derivatives of ( [ eqlog - pickle - too ] ) can be written using the implicit function theorem and the fact that @xmath16 minimizes ( [ eqkey ] ) as @xmath31 a particularly simple and symmetric form [ for a detailed derivation see sections  1.7 and 1.8 of @xcite ] .",
    "if we combine all the parameters in one vector @xmath32 and write @xmath33 instead of @xmath34 , we have @xmath35 this form is familiar from the conditional variance formula for normal distributions ; if @xmath36 is the partitioned variance matrix of a partitioned normal random vector with components @xmath37 and @xmath38 , then the variance matrix of the conditional distribution of @xmath37 given @xmath38 is @xmath39 assuming that @xmath38 is nondegenerate [ @xcite , theorem 2.5.1 ] .",
    "moreover , if the conditional distribution is degenerate , that is , if there exists a nonrandom vector @xmath40 such that @xmath41 , then @xmath42 almost surely , assuming @xmath37 and @xmath38 have mean zero [ also by @xcite , theorem 2.5.1 ] , and the joint distribution of @xmath37 and @xmath38 is also degenerate .",
    "thus , we conclude that if the ( joint ) hessian matrix of @xmath43 is nonsingular , then so is the ( joint ) hessian matrix of @xmath44 given by ( [ eqpsi - psi ] ) .",
    "the second derivatives of @xmath43 we need for the second derivatives of @xmath44 are @xmath45^{- 1 } z^t { \\hat}{w } z e_j \\\\ & & \\hspace*{29.7pt}{}\\times\\bigl [ z^t { \\hat}{w } z d + i \\bigr]^{- 1 } z^t { \\hat}{w } z e_k \\bigr),\\end{aligned}\\ ] ] where @xmath46 [ for a detailed derivation see section  1.8 of @xcite ] . in our use of the implicit function theorem we needed @xmath47 to be invertible . from the explicit form given above",
    "we see that it is actually positive definite , because @xmath48 is positive semidefinite by ( [ eqw ] ) .",
    "it is part of the folklore of random effects models that introducing square roots of variance components avoids issues with zero variance components and with constrained optimization .",
    "introduce new parameters by @xmath49 and new random effects by @xmath50 , where @xmath51 is diagonal and @xmath52",
    ". then the objective function ( [ eqkey ] ) becomes @xmath53.\\ ] ] there are now no constraints ( the @xmath54 are allowed to be negative ) and ( [ eqkey - rooted ] ) is a continuous function of all variables ( there is no discontinuity when @xmath55 ) .",
    "we find this change - of - parameter useful and use it to avoid constrained optimization [ r package ` aster ` , @xcite ] .",
    "however , it also causes problems .",
    "first , it introduces spurious zeros of the first derivative of ( [ eqkey - rooted ] ) that are not stationary points of ( [ eqkey ] ) .",
    "in fact , the partial of ( [ eqkey - rooted ] ) with respect to @xmath54 is always zero when @xmath55 by symmetry .",
    "thus , first derivatives of ( [ eqkey - rooted ] ) can not be used to test whether the minimum occurs when some variance component is zero .",
    "since the issue of whether a variance component is zero is often of scientific interest , this is very problematic .",
    "we solve this problem by looking at first derivatives of ( [ eqlog - pickle - too ] ) on the original parameter scale ( section  [ seczero ] below ) and using the theory of constrained optimization .",
    "second , the formula ( [ eqpsi - psi ] ) for observed fisher information , although guaranteed to be positive definite if infinite precision arithmetic is used , is not so guaranteed if it is evaluated by the usual computer arithmetic ( with 16 decimal digit precision ) .",
    "we found that the analog of ( [ eqpsi - psi ] ) after the change of parameter from @xmath14 to @xmath56 was even more computationally unstable .",
    "thus , although ( [ eqkey - rooted ] ) is useful for finding approximate maximum likelihood estimates , we find it problematic for calculating approximate observed fisher information or for determining whether approximate maximum likelihood estimates of variance components are zero .",
    "in order to determine whether the minimizer of ( [ eqkey ] ) occurs on the boundary of the parameter space where some variance component is zero , we need to use the theory of constrained optimization . unfortunately , we can not use the karush ",
    "kuhn  tucker theory [ @xcite , section  9.1 ; @xcite , section  12.2 ] , which is familiar to some statisticians , because the constraint set is not determined by smooth inequality constraints .",
    "more advanced nonsmooth analysis [ @xcite ] does handle our problem , but is unfamiliar to most statisticians .",
    "fortunately , for our analysis we can use a simplification of the latter theory based on the notion of directional derivatives .",
    "the technical report [ @xcite ] uses the full theory from @xcite , but the results are the same as those stated here in terms of directional derivatives .",
    "the formula ( [ eqkey ] ) makes sense when all variance components are positive ( so @xmath12 is invertible ) .",
    "otherwise , it does not . as is common in nonsmooth analysis [ @xcite , section 1a ]",
    ", we define the objective function to have the value @xmath57 off of the constraint set .",
    "since @xmath57 can never minimize the objective function , this incorporates the constraints in the objective function . on the boundary of the constraint set ( where some variance components are zero and the corresponding random effects are also zero ) we extend the objective function by lower semicontinuity .    since all but the middle term on the right - hand side of ( [ eqkey ] ) are actually defined on some neighborhood of each point of the constraint set and differentiable at each point of the constraint set , we only need to deal with the middle term .",
    "define @xmath58 let @xmath59 denote the variance of @xmath60 , and let @xmath61 denote the number of random effects . then ( [ eqkey ] ) can be rewritten @xmath62\\\\[-8pt ] & & { } + \\frac{1}{2 } \\log \\det \\bigl [ z^t { \\hat}{w } z d + i \\bigr],\\nonumber\\end{aligned}\\ ] ] where @xmath63 is given by ( [ eqh - lsc ] ) , provided all of the components of @xmath14",
    "are nonnegative .",
    "the proviso is necessary because the third term on the right - hand side is not defined for all values of @xmath14 , only those such that the argument of the determinant is a positive definite matrix .",
    "hence , we must separately define @xmath64 whenever any component of @xmath14 is negative .",
    "a necessary condition for a local minimum of a smooth function is that the first derivative is zero ( fermat s rule ) .",
    "this works at points in the interior of the constraint set where ( [ eqkey - lsc ] ) is differentiable .",
    "it does not work at points on the boundary .",
    "there we need what rockafellar and wets [ ( @xcite ) , theorem 10.1 ] call _ fermat s rule , generalized : _ a necessary condition for a local minimum is that all directional derivatives are nonnegative .    for any extended",
    "- real - valued function @xmath65 on @xmath66 , the directional derivative of @xmath65 at the point @xmath67 in the direction @xmath68 is defined by @xmath69 at a point @xmath67 where @xmath65 is differentiable , we have @xmath70 , and the notion of directional derivatives gives no information that can not be obtained from partial derivatives .",
    "it is only on the boundary where we need directional derivatives .    in the interior of the constraint set , where this function is smooth , ordinary calculus gives @xmath71 where the notation on the left - hand side means the directional derivative of @xmath63 at the point @xmath72 in the direction @xmath73 . on the boundary of the constraint set , which consists of the single point @xmath74 ,",
    "the directional derivatives are given by @xmath75      this theory tells us nothing we did not already know about points in the interior of the constraint set . the only way we can have @xmath76 for all vectors @xmath68 is if @xmath77 .",
    "it is only at points on the boundary of the constraint set , where directional derivatives are the key .    even on the boundary , the conclusions of the theory about components of the state that are not on the boundary agree with what we already knew . at a local minimum",
    "we have @xmath78 and @xmath79\\\\[-8pt ] p_{b_i}(\\alpha , b , \\nu ) & = & 0,\\qquad \\mbox{$i$ such that $ \\nu _ { k(i ) } > 0$}\\nonumber\\end{aligned}\\ ] ] [ @xcite , section  1.10.4 , gives details ] .",
    "thus , assuming that we are at a point @xmath80 ) where ( [ eqdescent - alpha ] ) and ( [ eqdescent - other - smooth ] ) hold , and we do assume this throughout the rest of this section , @xmath81 actually involves only @xmath82 and @xmath83 such that @xmath84 and @xmath85 .",
    "define @xmath86\\ ] ] [ the part of ( [ eqkey - lsc ] ) consisting of the smooth terms ] .",
    "then @xmath87\\\\[-8pt ] & & \\qquad = \\sum _ { j \\in j } \\biggl [ v_j \\bar{p}_{\\nu_j } ( \\alpha , b , \\nu ) + \\sum_{i \\in k^{- 1}(j ) } \\bigl ( u_i \\bar{p}_{b_i}(\\alpha , b , \\nu ) + h(u_i , v_j ) \\bigr ) \\biggr],\\nonumber\\end{aligned}\\ ] ] where @xmath88 is the set of @xmath89 such that @xmath84 , where @xmath90 denotes the set of @xmath91 such that @xmath85 , and where @xmath63 is defined by ( [ eqh - lsc ] ) . to check that we are at a local minimum",
    ", we need to show that ( [ eqdescent - other - nonsmooth ] ) is nonnegative for all vectors @xmath92 and @xmath40 .",
    "conversely , to verify that we are not at a local minimum , we need to find one pair of vectors @xmath92 and @xmath40 such that ( [ eqdescent - other - nonsmooth ] ) is negative .",
    "such a pair @xmath73 we call a _ descent direction_. since fermat s rule generalized is a necessary but not sufficient condition ( like the ordinary fermat s rule ) , the check that we are at a local minimum is not definitive , but the check that we are not is .",
    "if a descent direction is found , then moving in that direction away from the current value of @xmath93 will decrease the objective function ( [ eqkey - lsc ] ) .",
    "so how do we find a descent direction ?",
    "we want to minimize ( [ eqdescent - other - nonsmooth ] ) considered as a function of @xmath92 and @xmath40 for fixed @xmath13 , @xmath11 and @xmath14 .",
    "we can consider the terms of ( [ eqdescent - other - nonsmooth ] ) for each @xmath89 separately .",
    "if the minimum of @xmath94 over all vectors @xmath92 and @xmath40 is nonnegative , then the minimum is zero , because ( [ eqdescent - other - nonsmooth - j ] ) has the value zero when @xmath95 and @xmath96 .",
    "thus , we can ignore this @xmath89 in calculating the descent direction .",
    "since we are only interested in finding a descent direction , the length of the direction vector does not matter .",
    "thus , we can do a constrained minimization of  ( [ eqdescent - other - nonsmooth - j ] ) , constraining @xmath73 to lie in a ball .",
    "this is found by the well - known karush ",
    "kuhn  tucker theory of constrained optimization [ @xcite , section  9.1 ; @xcite , section  12.2 ] to be the minimum of the lagrangian function @xmath97 where @xmath98 is the lagrange multiplier , which would have to be adjusted if we were interested in constraining @xmath73 to lie in a particular ball .",
    "since we do not care about the length of @xmath73 , we can use any @xmath99 .",
    "we have replaced @xmath100 by @xmath101 because we know that if we are finding an actual descent direction , then we will have @xmath102 .",
    "now @xmath103 the minimum occurs where these are zero .",
    "setting the first equal to zero and solving for @xmath83 gives @xmath104 plugging this back into the second gives @xmath105 and we seek zeros of this .",
    "the right - hand is clearly an increasing function of @xmath82 , so it is negative somewhere only if it is negative when @xmath106 where it has the value @xmath107 so that gives us a test for a descent direction : we have a descent direction if and only if ( [ eqdescent - test ] ) is negative .",
    "conversely , we appear to have @xmath108 if ( [ eqdescent - test ] ) is nonnegative .",
    "we illustrate the use of this work with three examples , beginning with a study of the invasive california wild radish ( _ raphanus sativus _ ) described by @xcite . for each individual , three response variables are observed , connected by the following graphical model : @xmath109 with @xmath110 being an indicator of whether any flowers were produced , @xmath111 being the count of the number of flowers produced , @xmath112 being the count of the number of fruits produced , the unconditional distribution of @xmath110 being bernoulli , the conditional distribution of @xmath111 given @xmath110 being zero - truncated poisson , and the conditional distribution of @xmath112 given @xmath111 being poisson .",
    "( the combination of a bernoulli arrow followed by a zero - truncated poisson arrow gives a combined zero - inflated poisson distribution , that is , the unconditional distribution of @xmath111 is zero - inflated poisson . )",
    "these data are found in the data set ` radish ` in the r package ` aster ` .",
    "they come from a designed experiment started with seeds collected from three large wild populations of northern , coastal california wild radish and three populations of southern , inland california wild radish .",
    "thus , we have populations nested within region .",
    "plants were grown at two experimental sites , one northern , coastal california field site located at point reyes national seashore and one southern , inland site located at the university of california riverside agricultural experiment station .",
    "thus , we have blocks nested within site .",
    "the issue of main scientific interest is the interaction of region and site , which is indicative of local adaptation when the pattern of mean values shows that each population has higher fitness in its home environment than in other environments .",
    "testing significance of this interaction is complicated by the nesting of populations within region and blocks within site and the goal of scientists to account for variation due to these nested factors in evaluating effects of the higher factors .",
    "the best surrogate of fitness in these data is the number of fruits produced .",
    "thus , we form the `` interaction '' with the indicator of this component and all scientifically interesting predictors [ see section  5 of @xcite or section  4 of @xcite ] .    the traditional way to deal with a situation like this is to treat the population effects as random ( within region ) and the block effects as random ( within site ) .",
    "when we fit this model [ see the technical report @xcite for details ] , we obtained positive and statistically significantly greater than zero estimates of both variance components and an estimate 0.499 with standard error 0.012 for the fixed effect that is the scientifically important site - region interaction parameter .",
    "@xcite did not do a random effects aster analysis because it had not yet been invented . nevertheless , the conclusions from their fixed effect aster analysis hold up .",
    "the main conclusion of interest is that there is evidence of local adaptation .",
    "this is indicated by the statistical significance of the fixed effect for region - site interaction together with the pattern of mean values for the different populations in the two sites , showing that populations growing near to their sampling locations had higher fitness than in the other location as found by @xcite .",
    "the fact that random effects analysis and fixed effects analysis agree qualitatively on this one example does not , of course , imply that they would agree on all examples . in these data",
    "the region - site interaction is very large and almost any sensible statistical analysis would show it .",
    "when the interaction is not so large , the analysis done will make a difference .",
    "the analysis reported above is based on the approximations derived in the theory section .",
    "we are using the log approximate integrated likelihood and its hessian matrix to do likelihood inference .",
    "but what if its approximations are not valid ?",
    "section  6 of @xcite does a parametric bootstrap of this analysis .",
    "it turns out that a 95% confidence interval for the parameter of interest ( the region - site interaction ) does not change much , but other aspects of the parametric bootstrap are interesting . sampling distributions of the estimates of the variance components ( as simulated by the parametric bootstrap )",
    "turn out to be highly nonnormal , and these estimators have bias that is a significant fraction of their standard errors .",
    "we use data on the slender wild oat ( _ avena barbata _ ) described by @xcite and contained in the data set ` oats ` in the r contributed package ` aster ` . for each individual , two response variables",
    "are observed , connected by the following graphical model : @xmath113 with @xmath110 being an indicator of survival and @xmath111 being the count of the number of spikelets ( compound flowers ) produced , the unconditional distribution of @xmath110 being bernoulli , and the conditional distribution of @xmath111 given @xmath110 being zero - truncated poisson .",
    "these data come from a designed experiment started with seeds collected in the 1980s in northern california of the xeric ( found in drier regions ) and mesic ( found in less dry regions ) ecotypes .",
    "the variable ` gen ` is the ecotype ( `` ` x ` '' or `` ` m ` '' ) .",
    "the variable ` fam ` is the accession ( nested within ` gen ` ) .",
    "the variable ` site ` is the site .",
    "the variable ` year ` is the year ( 2003 to 2007 ) .",
    "the experimental sites were at the sierra foothills research and extension center ( ) , which is northeast of sacramento on the east side of the central valley of california , and at the hopland research and extension center ( ) , which is in the california coastal ranges north of san francisco .",
    "hopland receives 30% more rainfall and has a less severe summer drought than the sierra foothills .",
    "the best surrogate of fitness in these data is the number of spikelets produced .",
    "thus , we form the `` interaction '' with the indicator of this component and all scientifically interesting predictors .    in the previous analysis [ @xcite ] a linear mixed model",
    "was used , despite the response being highly nonnormal , because no better tool was available .",
    "here we reanalyze these data using the same random effects structure in an aster model .    [",
    "cols=\"<,^\",options=\"header \" , ]     we have only three fixed effects parameters because there are only two levels of ` site ` and two levels of ` gen ` .",
    "there are five variance components , one for each row of the table having random type .",
    "all variance components are estimated to be significantly different from zero except for the ` fam ` random effect , which is estimated to be exactly zero .",
    "the results of the reanalysis agree qualitatively with the original analysis .",
    "local adaptation , which would have been shown by a statistically significant site - ecotype ( @xmath114 ) interaction , was not found in either analysis ( for this interaction , the aster random effects analysis obtained the point estimate 0.091 and standard error 0.143 ) .",
    "moreover , the pattern of mean values was not consistent with local adaptation .",
    "@xcite found that the mesic ecotype had higher fitness ( survived and reproduced better ) in all environments .",
    "this means that even if the site - ecotype interaction had been statistically significant , it would not have indicated local adaptation .",
    "we use data on the partridge pea ( _ chamaecrista fasciculata _ ) described by etterson ( @xcite ) and @xcite and contained in the data set ` chamae3 ` in the r contributed package ` aster ` . _",
    "c. fasciculata _ grows in the great plains of north america from southern minnesota to mexico .",
    "three focal populations were sampled in the following locations :    1 .",
    "kellog - weaver dunes , wabasha county , minnesota ; 2 .",
    "konza prairie , riley county , kansas ; 3 .",
    "pontotoc ridge , pontotoc county , oklahoma .",
    "these sites are progressively more arid from north to south and also differ in other characteristics .",
    "seed pods were collected from 200 plants in each of these three natural populations . from these ,",
    "plants were grown and crosses were done ; parent plants are indicated by the variables ` sire ` and ` dam ` in the data set .",
    "the resulting seeds were germinated and established as seedlings in the greenhouse and then planted using a randomized block design [ @xcite ] in three field sites :    1 .",
    "robert s. kerr environmental research center , ada , oklahoma ; 2 .",
    "konza prairie research natural area , manhatten , kansas ; 3 .",
    "university of minnesota , st .",
    "paul minnesota .",
    "the oklahoma field site was 30 km northwest of the oklahoma natural population ; the kansas field site was 5 km from the kansas natural population ; the minnesota field site was 110 km northwest of the minnesota natural population .",
    "for each individual , two response variables are observed , connected by the following graphical model : @xmath113 with @xmath110 being an indicator of whether any fruits were produced , @xmath111 being the count of the number of fruits produced , the unconditional distribution of @xmath110 being bernoulli , and the conditional distribution of @xmath111 given @xmath110 being zero - truncated poisson .    we here consider a subset of data previously analyzed by nonaster methods by etterson ( @xcite ) and @xcite and by aster without allowing for random ( genetic ) effects by @xcite .",
    "though seed counts were also observed , the complexity of the seed count data makes analysis difficult [ @xcite ] , so it does not serve as a good example .",
    "thus , here we analyze only the pod number data , which does have straightforward aster analysis and serves as a better example , even though this makes our reanalysis not really comparable with the analysis in @xcite which does use the seed counts . to aid design of future experiments , @xcite , page e43 ,",
    "explain two alternative experimental designs that permit straightforward aster analysis ( including random effects aster models ) .",
    "@xcite used one of these designs .",
    "individuals descended from all three natural populations were planted in all three field sites , so these data can address local adaptation and previous analyses [ @xcite , discussion ] did find local adaptation .",
    "but local adaptation is not the main point of interest for our analysis here .",
    "instead we investigate sire and dam effects , which we treat as random effects , as did the previous conventional quantitative genetics analysis [ @xcite ] .",
    "we focus on sire effects because in this experimental design sire effects are expected to correspond closely to pure breeding values ( additive genetic effects ) but dam effects confound additive with maternal and dominance effects .",
    "because the biology that leads to fitness may differ at different sites and in different populations , we did nine separate analyses , one for each population - site combination .",
    "we found that the sire variance components for the minnesota and oklahoma natural population are not close to statistically significant at the minnesota field site .",
    "all the other sire variance components are at least borderline statistically significant .",
    "our analysis produces not only estimates of the variance components but also estimates of the random effects ( these are the penalized quasi - likelihood estimates @xmath16 described in the theory sections ) . as a matter of purely statistical interest",
    ", we examined the gaussianity of the random effects .",
    "they seemed to be normal ( or at least not statistically significantly nonnormal by a shapiro ",
    "wilk test ) .",
    "we conjectured that this apparent normality was due to the estimation procedure , but this turned out not to be the case , since when we redid penalized quasi - likelihood estimates of the random effects using much smaller penalties than the maximum likelihood penalty , the random effects still seemed normal .    for interpretability ,",
    "biologists want random effects mapped to the mean value parameter scale ( rather than the canonical parameter scale where they originally are ) . to illustrate this , we mapped the sire effects for two population - site pairs to the mean value parameter scale , setting the dam effects to be zero ( the middling value ) and setting the block effect to be block  1 ( each site was divided into blocks ) .",
    "figure  [ figone ] shows these plots ; for details of how they were done see section  8.6 of @xcite .",
    "this figure was made using the default smoothing parameter selection of the r function ` density ` .",
    "the apparent non - gaussianity is not statistically significant [ shapiro  wilk test , @xcite , section  8.6 ] .",
    "thus , the aster model can include random effects for parents and permit quantitative genetic inference for fitness variation .",
    "our methods are founded on two approximations taken from @xcite .",
    "our technical innovations are that we provide derivatives of the log approximate integrated likelihood ( section  [ seclail ] ) and the test ( [ eqdescent - test ] ) for when variance components are zero , which is based on the theory of constrained optimization .",
    "our methods work well when there are multiple variance components .",
    "two examples had two variance components and one had five variance components .",
    "however , problems arise when there are thousands of random effects , and especially when there is one random effect per individual .",
    "since quantitative genetics traditionally does have individual random effects as well as parental random effects , our methods are not fully comparable to traditional quantitative genetics .",
    "past experience [ @xcite ] with examples taken from the literature shows that log integrated likelihoods are often far from quadratic , even when no approximations are done , in which case asymptotics based on fisher information are inaccurate .",
    "thus , we recommend the parametric bootstrap here , as we do whenever there is doubt about the validity of asymptotics for parametric inference .",
    "we illustrate the parametric bootstrap for one of our examples .",
    "this need for doing a parametric bootstrap is another reason for preferring computationally efficient methods . in particular , it is incredibly time consuming to bootstrap monte carlo calculations if monte carlo run lengths are long enough for accurate calculation .",
    "@xcite introduced yet another approximation that is supposed to be analogous to restricted maximum likelihood ( reml ) , but we did not use this .",
    "first , the analogy to reml is weak , and this method has no provable mathematical properties .",
    "second , we do not see how this method extends to general exponential family models , such as aster models .",
    "third , even in conventional linear mixed models , reml does not seem to be appropriate when the parameters of interest are fixed effects , which is often the case in biology and is the case in some of our examples ."
  ],
  "abstract_text": [
    "<S> random effects are implemented for aster models using two approximations taken from breslow and clayton [ _ j . </S>",
    "<S> amer . </S>",
    "<S> statist . </S>",
    "<S> assoc . _ * 88 * ( 1993 ) 925 ] . </S>",
    "<S> random effects are analytically integrated out of the laplace approximation to the complete data log likelihood , giving a closed - form expression for an approximate missing data log likelihood . </S>",
    "<S> third and higher derivatives of the complete data log likelihood with respect to the random effects are ignored , giving a closed - form expression for second derivatives of the approximate missing data log likelihood , hence approximate observed fisher information . </S>",
    "<S> this method is applicable to any exponential family random effects model . </S>",
    "<S> it is implemented in the cran package ` aster ` ( r core team [ r : a language and environment for statistical computing ( @xcite ) r foundation for statistical computing ] , geyer [ r package aster ( 2012 ) http://cran.r-project.org/package=aster ] ) . </S>",
    "<S> applications are analyses of local adaptation in the invasive california wild radish ( _ raphanus sativus _ ) and the slender wild oat ( _ avena barbata _ ) and of additive genetic variance for fitness in the partridge pea ( _ chamaecrista fasciculata _ ) .    ,    ,    , + </S>"
  ]
}