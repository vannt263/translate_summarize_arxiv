{
  "article_text": [
    "recently h5n1 avian influenza and sars have raised the profile of emerging infectious diseases . both can infect humans , but have a primary animal host .",
    "typically such zoonotic diseases emerge periodically into the human population and disappear ( _ e.g. _ , ebola , hanta virus , and rabies ) , but sometimes ( _ e.g. _ , hiv ) the disease achieves sustained person - to - person spread . with the advent of modern transportation networks ,",
    "diseases that formerly emerged in isolated villages and died out without further spread may now spread worldwide .",
    "a number of interventions are available to control emerging diseases , each with distinct costs and benefits . to design optimal policies",
    ", we must address several related , but nevertheless distinct , questions .",
    "how fast would an epidemic spread ?",
    "how likely is a single introduced infection to result in an epidemic ?",
    "how many people would an epidemic infect ?",
    "we quantify these using @xmath0 , the _ basic reproductive ratio _ , which measures the average number of new cases each infection causes early in the outbreak ; @xmath1 , the probability that a single infection sparks an epidemic ; and @xmath2 , the _ attack rate _ or fraction of the population infected in an epidemic .",
    "understanding these different quantities and what affects them helps us to select policies with maximal impact for given cost .",
    "many different models are used to study disease spread .",
    "perhaps the most important decision in developing a model is how the interactions of the population are represented .",
    "because of the complexity of the population , it is invariably necessary to make simplifying assumptions . the errors ( and therefore , the conclusions ) resulting from many of these approximations are not well - quantified . in this paper",
    "we will focus on quantifying the impact of clustering ( the tendency to interact in small groups ) and individual - scale heterogeneity on the spread of an epidemic .",
    "based on how they handle clustering , models for population structure fit into a hierarchy of three classes ( which in turn may be subdivided ) . at the simplest level",
    "the population is assumed to mix without any clustering .",
    "most existing models fall into this category . at the most complex level ,",
    "agent - based models are used : the movements of each individual are tracked , and people who are in the same location are able to infect one another .",
    "these models typically require significant resources to develop , and the clustering is explicitly included . an intermediate level of complexity attempts to introduce the clustering as a parameter ( or several parameters ) .",
    "usually these models only consider clustering in terms of the number of triangles in a network , but as we shall see , other structures may play a role .    before introducing the details of our model , we review some previous work .",
    "all the models we consider are susceptible - infected - recovered ( sir ) epidemic models  @xcite , in which individuals begin susceptible , become infected by contacting infected individuals , and finally recover with immunity .    for unclustered populations , ordinary differential equation ( ode ) models",
    "were among the earliest models used  @xcite and remain the most common .",
    "they are deterministic , and so can not directly calculate @xmath1 , but they give insight into the factors controlling @xmath0 and @xmath2 . because they assume mass - action mixing , it is difficult to incorporate individual heterogeneity in the number of contacts",
    ". more recently some network - based models have been introduced for unclustered populations  @xcite .",
    "these models represent the population as nodes with edges between nodes representing contacts , along which disease spreads stochastically .",
    "heterogeneity in the number of contacts is introduced by modifying the degree ( number of edges ) of each node . by neglecting clustering ,",
    "these studies are able to make analytic predictions through branching process arguments . a recent sociological study  @xcite used surveys with participants recording the length and nature of their contacts .",
    "this data is valuable for providing the contact distribution needed for the above network models , and allows us to apply network results to real populations .",
    "however , this data does not directly tell us anything about the clustering of the population resulting from family / work / other groups .",
    "other recent work by  @xcite analytically addresses the impact of heterogeneity in infectiousness and susceptibility in unclustered networks .",
    "using agent - based simulations  @xcite allows us to directly incorporate clustering . in these simulations ,",
    "the population is a collection of individuals who move and contact one another .",
    "the modeller has complete control over the parameters governing interactions and how the disease spreads .",
    "this allows us to study many effects , but also introduces many parameters .",
    "it is difficult to test the accuracy of the assumptions used to generate these models and to extract which parameters are essential to the disease dynamics .",
    "the expense of developing these simulations is frequently prohibitive .    in this paper",
    "we introduce a systematic approach for calculating the impact of clustering , and quantifying the error . because our model investigates disease spread in clustered networks ,",
    "we provide a more detailed review of previous work on clustering and disease .",
    "a few investigations have been made into the interaction of clustering with disease spread using network models .",
    "the attempts that have been made  @xcite typically use approximations whose errors are not quantified , resulting in apparently contradictory results . a few papers  @xcite have considered clustering and heterogeneities , rigorously showing that increased heterogeneity tends to decrease @xmath1 and @xmath2 , but without quantitative predictions .",
    "recently  @xcite considered the spread of epidemics in a class of random networks for which the number of triangles could be controlled . it may be inferred from their figure 3 that clustering decreases the growth rate and that sufficient clustering can increase the epidemic threshold . however , at small and moderate levels clustering appears not to alter the final size of epidemics significantly .",
    "similar observations have been made by  @xcite . at first glance",
    ", this contradicts observations of  @xcite that clustering significantly reduces the size of epidemics , but that sufficiently strong clustering reduces the epidemic threshold ( see also  @xcite ) , allowing epidemics at lower transmissibility . the discrepancy in epidemic size",
    "may be resolved by noting that the networks in  @xcite have low average degree .",
    "we will see that clustering only affects the size if the typical degree is small or clustering is very high .",
    "the apparent discrepancy in epidemic threshold with strong clustering may be resolved by noting that the form of strong clustering considered by  @xcite forces preferential contacts between high degree nodes .",
    "the reduction in epidemic threshold is perhaps better understood in terms of degree - degree correlations than in terms of clustering .    in this paper",
    "we develop techniques to incorporate general small - scale structure ( beyond triangles ) into the calculation of @xmath0 , @xmath1 , and @xmath2 . to calculate @xmath0",
    ", we develop a systematic series expansion which allows us to interpolate between unclustered and clustered results by including more terms . to calculate @xmath1 and @xmath2",
    ", we use a similar approach , but only give estimates on the size of correction terms .",
    "our methods give us a rigorous means to understand how unclustered results relate to more realistic populations , and our results resolve the apparent discrepancies mentioned above .",
    "our theory accurately predicts epidemic behaviour in a more realistic contact network derived from an agent - based simulation of portland , oregon by episims  @xcite .",
    "we expand this to investigate the interplay of clustering , heterogeneities in individual infectiousness or susceptibility , and variation in edge weights in their effect on @xmath0 , @xmath1 , and @xmath2 .",
    "the paper is organised as follows : section  [ sec : formulation ] describes our model and networks and summarises earlier work on unclustered networks .",
    "these results will be the leading order terms for our expansions for clustered networks in the remainder of the paper .",
    "section  [ sec : homogeneous ] considers how epidemics spread in a clustered network assuming homogeneous transmission .",
    "we derive the corrections to @xmath0 and show that the corrections to @xmath1 and @xmath2 are insignificant unless the typical degree is small or clustering very high . section  [ sec : heterogeneous ] considers epidemics in clustered networks with heterogeneous infectiousness or susceptibility , building on section  [ sec : homogeneous ] .",
    "section  [ sec : weighted ] extends this further to consider epidemics spreading on clustered networks with weighted edges",
    ". edges with large weights tend to occur in family or work groups which magnifies the impact of clustering .",
    "finally section  [ sec : discussion ] discusses the implications of our results , particularly for designing interventions .",
    "we conclude that in general , heterogeneity significantly impacts @xmath1 and @xmath2 , but not @xmath0 , while clustering impacts @xmath0 significantly , but not @xmath1 and @xmath2 . heterogeneity or edge weights may enhance the impact of clustering .",
    "we consider the spread of a disease using a discrete sir model on a static network @xmath3 .",
    "nodes of @xmath3 represent individuals and edges represent ( potentially infectious ) contacts .",
    "the contact structure of the network is fixed during the course of the outbreak . the _ degree _ @xmath4 of a node @xmath5 is the number of edges containing @xmath5 .",
    "figure  [ fig : sample ] shows a sample outbreak .",
    "a single infection , the _ index case _ is chosen uniformly from the population to begin an _",
    "outbreak_. infection spreads along an edge from an infected node @xmath5 to a susceptible node @xmath6 with probability @xmath7 , the _",
    "transmissibility_. the time it takes for infection and recovery to occur may vary but does not affect our results .",
    "once @xmath5 recovers it can not be reinfected . typically for a large random network with a population of @xmath8 nodes ,",
    "the final size of outbreaks is either large , with @xmath9 cumulative infections , or small , with @xmath10 infections  @xcite .",
    "large outbreaks are _ epidemics _ and small outbreaks are _ non - epidemic outbreaks_.      a number of factors influence the transmissibility from @xmath5 to @xmath6 such as the viral load and duration of infection of @xmath5 , the vaccination history and general health of @xmath6 , the duration and nature of the contact between @xmath5 and @xmath6 , and characteristics of the disease .    for each node @xmath5",
    "we denote its ability to infect others by @xmath11 and its ability to be infected by @xmath12 .",
    "each edge has a weight @xmath13 .",
    "the parameter @xmath14 measures disease - specific quantities . in most of our calculations we assume these",
    "are scalars and follow  @xcite , setting @xmath15 if all contacts are identical , @xmath13 may be absorbed into @xmath14 @xmath16 note that @xmath7 is a number assigned to an edge , while @xmath17 is a function which states what the transmissibility between two nodes would be if they shared an edge .    with mild abuse of notation",
    "we denote the probability density functions ( pdfs ) of @xmath18 , @xmath19 , and @xmath20 by @xmath21 , @xmath22 , and @xmath23 respectively .",
    "we assign @xmath18 and @xmath19 independently , but allow @xmath20 to be assigned either independently or based on observed contacts ( _ i.e. _ , by observing contacts in a population we may create a static network with edge weights assigned based on the observed contact ) . if @xmath20 is assigned independently , then it is possible to eliminate edge weights from the analysis by marginalising over the distribution of weights . however , if weights are not independent ( for example work or family contacts tend to have correlated weights ) then the details of the distribution and the correlations are important .    given the infectiousness @xmath11 of node @xmath5 , we follow  @xcite and define its _ out - transmissibility _",
    "@xmath24 this is the marginalised probability that @xmath5 infects a randomly chosen neighbour given @xmath11 . from the definition of @xmath25 and the pdf @xmath21",
    "we can calculate the pdf @xmath26 .",
    "we symmetrically define the _ in - transmissibility _ @xmath27 and its pdf @xmath28 .",
    "we denote the average of a quantity by @xmath29 .",
    "the average transmissibility @xmath30 is @xmath31      rather than studying outbreaks as dynamic processes on networks , we may consider them in the context of epidemic percolation networks ( epns )  @xcite .",
    "the epn framework allows us to study epidemics as static objects and is useful for quickly estimating @xmath1 , @xmath2 , and @xmath0 . in this section",
    "we summarise properties of epns ; more details are provided in  @xcite and  [ app : epn ] .",
    "once the properties of the nodes and edges are assigned , an epn @xmath32 is created as follows : we place each node of @xmath3 into @xmath32 . for each edge @xmath33 in @xmath3 we place directed edges @xmath34 and @xmath35 into @xmath32 independently with probability @xmath7 and @xmath36 respectively .",
    "the nodes infected in an outbreak correspond exactly to those nodes that may be reached from the index case following edges of @xmath32 .",
    "more specifically , the distribution of out - components of a node @xmath5 in different epn realisations matches the distribution of outbreaks resulting from different epidemic realisations in the original model with @xmath5 as the index case .",
    "it may be shown that the distributions of out- and in - component sizes give us information about the probability of nodes to start an epidemic or become infected in an epidemic .",
    "we will see that in a large population the structure of a single epn can be used to accurately estimate @xmath1 , @xmath2 , and @xmath0 .",
    "once we create an epn and choose the index case , we define the _ rank _ of node @xmath6 as the length of the shortest directed path from the index case to @xmath6 .",
    "if no such path exists , @xmath6 is never infected .    interchanging all arrow directions interchanges @xmath1 and @xmath2 .",
    "this means that if we can calculate @xmath1 , then @xmath2 may be calculated by the same technique , but with the direction of infection reversed . because of this , we focus our attention on calculating @xmath1 , and apply the same methodology to calculate @xmath2 .",
    "an important consequence is that if @xmath37 is constant , then @xmath38  @xcite .",
    "we expect that epidemics are possible if and only if the _ basic reproductive ratio _ @xmath0 is greater than @xmath39 .",
    "that is , if an average infection causes more than one new case , an epidemic may occur , but otherwise the outbreak dies out quickly .",
    "however , this use of @xmath0 is not consistent with the typical definition : _ the average number of new infections caused by a single infected individual introduced into a fully susceptible population _ , which gives @xmath40 .",
    "a more appropriate definition is _ the average number of new infections caused by infected individuals early in outbreaks_. the distinction is subtle , but results from the fact that whether an outbreak can grow depends on whether the people of low rank infect more than one person each  @xcite .",
    "low rank individuals may be different from the average individual .",
    "most obviously , they have more contacts  @xcite ; but with clustering , they also have a disproportionately large fraction of neighbours infected or recovered .    in order to quantify @xmath0 more rigorously , we first define @xmath41 to be the number of people of rank @xmath42 for a given outbreak simulation .",
    "we then define the _ rank reproductive ratio _ @xmath43}{{\\mathbb{e}}[n_r ] } \\label{eqn : rog}\\ ] ] to be the expected number of new cases caused by a rank @xmath42 node ( averaged over all possible outbreak realisations ) .",
    "@xmath44 corresponds to the usual definition of @xmath0 . in practise , we find that @xmath45 reaches a plateau quickly as @xmath42 increases before eventually decreasing as the finite size of the population becomes important .",
    "consequently , an improved definition of @xmath0 is the limit of @xmath45 as @xmath42 grows , subject to the assumption that @xmath45 is unaffected by the finite size of @xmath3 .",
    "this gives ( _ cf _ , @xcite ) @xmath46 and generalises the definition given by  @xcite for ode models .",
    "under this definition , epidemics are possible if @xmath47 , but not if @xmath48 .",
    "we discuss this further in  [ app : r0 ] . in a large population considering multiple index cases with a single epn",
    "gives a good estimate of @xmath49 $ ] and hence @xmath45 .",
    "we consider two different types of networks .",
    "the first is a class of ( unclustered ) random networks for which we can derive analytic results based only on the degree distribution .",
    "these analytic results will form the leading order term of our perturbation expansions .",
    "the second is a more complicated network resulting from an agent - based simulation , which we will use to demonstrate the accuracy of our perturbation expansions .",
    "our random networks are created by an algorithm which has been discovered independently a number of times ( see _ e.g. _ , @xcite and  @xcite ) .",
    "these have come to be called configuration model ( cm )  @xcite networks .",
    "these networks are maximally random given the degree distribution .",
    "as the number of nodes in a cm network grows , the frequency of short cycles becomes negligible .",
    "the resulting lack of clustering allows us to calculate analytic results for epidemics .",
    "we briefly discuss these results assuming @xmath37 is constant .",
    "more details are in  @xcite and  [ app : unclustered_review ] ( which also addresses edge weights ) .    in the early stages of an outbreak in a cm network , the probability that a newly infected ( non - index case ) node has",
    "degree @xmath4 is @xmath50 .",
    "clustering is unimportant and so the node will have @xmath51 susceptible neighbours , regardless of its rank .",
    "thus the expected number of infections caused by a newly infected node is @xmath52    to calculate the probability @xmath1 that infection of a randomly chosen index case results in an epidemic , we instead calculate the probability @xmath53 that it does not .",
    "then @xmath54 is the probability that each neighbour of the index case either is not infected , or is infected but does not start an epidemic . defining @xmath55 to be the probability that a secondary case does not start an epidemic , @xmath56^k \\ , .",
    "\\label{eqn : f}\\ ] ] we find a similar relation for @xmath55 , except that the probability for a secondary case to have degree @xmath4 is @xmath50 and only @xmath51 neighbours are susceptible @xmath57^{k-1 } \\ , .",
    "\\label{eqn : h}\\ ] ] we solve this recurrence relation for @xmath55 numerically , and use the result to find @xmath54 .",
    "@xmath1 follows immediately .",
    "because @xmath37 is constant , this also gives @xmath2  @xcite .",
    "if @xmath37 is not constant , the calculation becomes more difficult , and is discussed further in  [ app : unclustered_review ] and  @xcite .",
    "in general , if @xmath37 can vary for cm networks , @xmath58 , while @xmath1 and @xmath2 are overestimated by the values calculated assuming constant @xmath37 .",
    "we are interested in understanding the impact of clustering on disease spread .",
    "the term _ clustering _ is rather vague , and is usually measured by the number of triangles in a network  @xcite . however",
    ", any sufficiently short cycles impact the spread of an infectious disease . for our purposes",
    "we think of a clustered network as a network with enough short cycles to impact disease dynamics .",
    "it is relatively simple to measure the degree distribution of a population using survey methods .",
    "we can easily calculate @xmath1 , @xmath2 , and @xmath0 for a cm network with the same degree distribution , but the error between these values and the values for the original clustered network are unknown . our goal in this paper is to develop analytical techniques to quantify these errors .    to test our predictions",
    "we turn to an agent - based network derived from a single episims  @xcite simulation of portland , oregon .",
    "the simulation includes roads , buildings , and a statistically accurate ( based on census data ) population of approximately 1.6 million people who perform daily tasks based on population surveys .",
    "this gives a highly detailed knowledge of the interactions in the synthetic population .",
    "the degree distribution and contact structure emerge from the simulation .",
    "the resulting network has significant clustering and average degree of about 16 .",
    "more details are in  [ app : episims ] .",
    "in this section we assume that the population is homogeneous and all contacts are equally weighted . consequently transmissibility is constant : @xmath59 for all edges .",
    "it follows that @xmath38  @xcite .",
    "we develop a predictive theory for @xmath1 , @xmath2 , and @xmath0 and test the theory with simulations on the episims network .",
    "we begin with @xmath0 .",
    "the simulated rank reproductive ratio @xmath45 is shown in figure  [ fig : r0 g ] for @xmath60 . at all values of @xmath37",
    ", @xmath61 is clearly distinct from @xmath45 , @xmath62 ( which are close together ) . for @xmath62",
    ", @xmath45 is asymptotic to the unclustered approximation @xmath63 as @xmath64 .",
    "this is because at small @xmath37 the disease only rarely follows all edges of short cycles and so clustering has no impact . as @xmath37 increases , these curves lie significantly below the unclustered approximation , because clustering reduces the number of available susceptibles .",
    "@xmath65 peels away from @xmath66 , @xmath67 , and @xmath68 for larger @xmath37",
    "because the population is finite , and so the number of susceptibles available to infect after rank four is reduced . in larger populations , @xmath65 would not deviate .",
    "/{\\mathbb{e}}[n_r]$ ] for @xmath69 ,  , @xmath70 using an epn from the ( fixed ) episims network with a homogeneous population , compared with the unclustered prediction . at small @xmath37 ( right panel )",
    "@xmath66@xmath65 match the unclustered prediction.,title=\"fig : \" ] /{\\mathbb{e}}[n_r]$ ] for @xmath69 , ",
    ", @xmath70 using an epn from the ( fixed ) episims network with a homogeneous population , compared with the unclustered prediction . at small @xmath37 ( right panel )",
    "@xmath66@xmath65 match the unclustered prediction.,title=\"fig : \" ]    we conclude that @xmath45 converges quickly , and that @xmath66 is a good approximation to @xmath0 , but @xmath71 is not .",
    "this implies that the network has important structure contained in paths of length @xmath72 , but not in paths of length @xmath73 .",
    "this fortunate observation allows us to approximate @xmath0 by @xmath66 , which we may analytically calculate with relative ease ( @xmath45 becomes combinatorially hard as @xmath42 grows ) . to find @xmath74/{\\mathbb{e}}[n_1]$ ]",
    "we first note that @xmath75 = t{\\left \\langle k \\right \\rangle}$ ] .",
    "calculating @xmath76 $ ] is more difficult : consider all pairs of nodes @xmath5 and @xmath6 with at least one path of length @xmath72 between them .",
    "let @xmath77 be the number of paths of length @xmath72 between @xmath5 and @xmath6 and @xmath78 be an indicator function : @xmath79 if @xmath33 is an edge and @xmath80 if it is not ( see figure  [ fig : en2 ] ) .",
    "the probability that an infection of @xmath5 results in infection of @xmath6 in exactly two steps is @xmath81[1-t]^{\\chi_{uv}}$ ] .",
    "summing this over all pairs yields @xmath82 = \\frac{1}{n } \\sum_u \\sum_{v\\neq u } [ 1-(1-t^2)^{n_{uv}}][1-t]^{\\chi_{uv } } \\ , , \\ ] ] ( where @xmath83 is the size of the population and each pair @xmath5 and @xmath6 appears twice ) which allows us to calculate @xmath66 exactly .",
    "this sum is straightforward to calculate , but we can increase our understanding with a small @xmath37 expansion .",
    "we approximate @xmath76 $ ] for @xmath84 by @xmath85 & =    \\frac{1}{n } \\sum_u\\sum_{v\\neq u } t^2n_{uv}(1-t)^{\\chi_{uv } } -    \\binom{n_{uv}}{2 } t^4 + { \\mathcal{o}}(t^5 ) \\",
    ", , \\\\    & = t^2{\\left \\langle k^2-k \\right \\rangle } - 2t^3{\\left \\langle n_\\triangle \\right \\rangle } - t^4{\\left \\langle n_\\square \\right \\rangle } +    { \\mathcal{o}}(t^5 ) \\ , , \\end{aligned}\\ ] ] where @xmath86 is the average number of triangles each node is in , and @xmath87 is the average number of squares each node is in ( _ cf _ , @xcite ) .",
    "higher order terms involve more complicated shapes .",
    "this gives @xmath88 at leading order we recover the unclustered prediction for @xmath0 , reflecting the fact that at small @xmath37 the probability the outbreak follows all edges of a cycle is negligible .",
    "as @xmath37 increases , the first corrections are due to triangles , then squares , then pairs of triangles sharing an edge , and sequentially larger and larger structures made up of paths of length two .",
    "a comparison of these approximations with the exact value is shown in figure  [ fig : r01approx ] .     from equation   with the exact value ( solid ) for the episims network .",
    "the right panel shows the comparison at small @xmath37.,title=\"fig : \" ]   from equation   with the exact value ( solid ) for the episims network .",
    "the right panel shows the comparison at small @xmath37.,title=\"fig : \" ] +    although we have defined @xmath0 for an ensemble of realisations , figure  [ fig : simulations ] shows that @xmath66 accurately predicts the observed ratio @xmath89 for individual simulations once the outbreaks are well - established .",
    "early in outbreaks , the behaviour is dominated by stochastic effects , and so the ratio of successive rank sizes is noisy .",
    "once the outbreak has grown large enough , random events become unimportant and the ratio settles at @xmath66 .     and ( right ) @xmath90 in the episims network .",
    "the left panels show @xmath89 against rank and right panels show the cumulative fraction of the population infected.,title=\"fig : \" ]   and ( right ) @xmath90 in the episims network .",
    "the left panels show @xmath89 against rank and right panels show the cumulative fraction of the population infected.,title=\"fig : \" ]       and attack rate @xmath2 of epidemics for the ( clustered ) episims network ( @xmath91 ) versus @xmath37 , compared to the prediction derived from the degree distribution assuming no clustering .",
    "each data point is from a single epn , ( the variation in @xmath1 resulting from different epns is negligible ) . ]    in order to assess the effect of clustering on @xmath1 and @xmath2 , we compare epidemics on the episims network with the analytic predictions derived assuming a cm network of the same degree distribution in figure  [ fig : probcomp ] .",
    "the epidemic threshold is not noticeably altered , and the values of @xmath1 and @xmath2 are almost indistinguishable from the predictions made assuming no clustering , despite the large amount of clustering in the network .    although initially surprising , these results may be understood intuitively as follows : if @xmath37 is large enough that the disease follows all edges of a short cycle then some other edge from a node of that cycle is likely to start an epidemic and the cycle does not prevent an epidemic .",
    "on the other hand , if @xmath37 is smaller so that it does not follow all edges of a cycle , then the disease never sees the existence of the cycle , and the outbreak progresses as if there were no cycle .    to make this more rigorous , we first look at the epidemic threshold .",
    "we assume @xmath0 is well - approximated by @xmath66 .",
    "let @xmath92 be the threshold without clustering and @xmath93 be the threshold found by including the correction due to triangles . from equation",
    "it follows that @xmath94 ^ 2 \\right)\\ , .",
    "\\label{eqn : homog_cond}\\ ] ]",
    "because a given node of degree @xmath4 is contained in at most @xmath95 triangles , we conclude @xmath96 .",
    "so if @xmath97 is small the leading order term of equation   is small and triangles do not significantly alter the epidemic threshold regardless of the density of triangles . for the episims network",
    ", @xmath97 takes the value @xmath98 , and so we do not anticipate clustering to play an important role in determining the threshold .    above threshold , we assume that @xmath1 may be expanded much like   @xmath99 where @xmath100 is the epidemic probability in a cm network of the same degree distribution . although calculating @xmath66 only requires information about nodes of distance at most two from the index case , @xmath1 may depend on effects occurring at larger distance , and so the expansion has many additional terms . in general , we expect that if the average degree is large , then the various coefficients of the correction terms are all small .",
    "the larger a structure is , the smaller we expect its corresponding coefficient to be",
    ". the coefficient for triangles @xmath101 may be found by @xmath102 where @xmath103 is the probability that a given triangle prevents an epidemic if @xmath5 is the index case ( regardless of whether @xmath5 is part of the triangle ) . reversing the order of summation we get @xmath104 where @xmath105 is the number of triangles in @xmath3 and @xmath106 is the average of the given quantity taken over all triangles .",
    "thus @xmath107 and we can find @xmath101 by considering the average effect of a single triangle in an unclustered network .    to calculate the impact of a triangle with nodes @xmath5 , @xmath6 , and @xmath20 on @xmath1 for a given network",
    ", we consider that triangle and a randomly chosen edge @xmath108 elsewhere in the network .",
    "if we replace the edges @xmath109 and @xmath108 with @xmath110 and @xmath111 , then we have a new network without the triangle , but with the same degree distribution .",
    "we must estimate the expected change in @xmath1 caused by switching the edges .",
    "we begin by assuming @xmath5 is the index case .",
    "the triangle can affect @xmath1 only if the infection tries to cross all three edges , that is , if the infection process ` loses ' an edge because of clustering .",
    "this may happen in three distinct ways .",
    "in the first , node @xmath5 infects both @xmath6 and @xmath20 , and then @xmath6 and/or @xmath20 tries to infect the other . in the second @xmath5 infects @xmath6 but not @xmath20 , then @xmath6 infects @xmath20 , and finally @xmath20 tries to infect @xmath5 .",
    "the third is symmetric to the second ( with @xmath5 infecting @xmath20 ) .    to leading order",
    "we can ignore other short cycles , so the probability that an edge leading out of @xmath5 ( not to @xmath6 or @xmath20 ) will not cause an epidemic is @xmath112 , where @xmath55 ( as before ) is the probability that a randomly chosen secondary case does not cause an epidemic in an unclustered network and can be calculated using equation  .     and @xmath108 with @xmath110 and @xmath111 breaks the triangle and allows more infections , without affecting the degree distribution.,title=\"fig : \" ] and @xmath108 with @xmath110 and @xmath111 breaks the triangle and allows more infections , without affecting the degree distribution.,title=\"fig : \" ]    we perform a sample calculation with the first case : @xmath5 infects both @xmath6 and @xmath20 .",
    "assume that @xmath5 has degree @xmath113 , @xmath6 has degree @xmath114 , and @xmath20 has degree @xmath115 .",
    "the probability that @xmath5 infects both @xmath6 and @xmath20 without some other edge leading from @xmath5 , @xmath6 , or @xmath20 starting an epidemic is @xmath116 . if the @xmath109 edge were broken and @xmath6 and @xmath20 were joined to @xmath117 and @xmath118 respectively ( see figure  [ fig : trianglebreak ] ) , then the new probability of @xmath5 to infect both @xmath6 and @xmath20 without an epidemic becomes @xmath119 .",
    "the difference is @xmath120 , which is the product of three terms , all at most @xmath39 .",
    "if the sum @xmath121 is moderately large , then either @xmath122 or @xmath123 ( if @xmath124 is not close to @xmath39 then the first term is small , otherwise the second term is small ) .",
    "thus the triangle has little impact on the epidemic probability in this case . is small , then",
    "the _ relative _ change may be large , but the absolute change is small .",
    "] similar analysis applies to the other two cases where the @xmath20 to @xmath5 or @xmath6 to @xmath5 infections are lost .",
    "provided the typical sum of degrees of nodes in a triangle is relatively large , the probability of an epidemic when the index case is in the triangle is not impacted significantly .",
    "if the index case is not part of the triangle , then the above analysis is modified because we must also consider each node in the path from the index case to the triangle .",
    "we must first calculate the probability that infection reaches a node in the triangle while simultaneously no intermediate node sparks an epidemic , and then we calculate the probability as above that the triangle prevents an epidemic .",
    "if the index case is @xmath125 and the path from @xmath125 to the triangle goes through @xmath126 ,  ,",
    "@xmath127 and then reaches @xmath5 , then the probability that the triangle prevents an epidemic @xmath128 is given by @xmath129 .",
    "this falls off very quickly , and so nodes not in the triangle are unimportant , unless typical degrees are small .    in contrast , in a network with small average degree and a significant number of triangles",
    "this becomes significant .",
    "this explains observations of  @xcite who use networks with average degree less than @xmath73 and find that clustering significantly alters @xmath2 .    it is tempting to generalise our conclusion and state that if the average degree is large , clustering has no impact on @xmath1 or @xmath2 . however , there are a number of counter - examples : consider a network made up of isolated cliques with @xmath130 nodes , then in expansion   the coefficient for cliques of @xmath130 nodes will not be small .",
    "consequently care must be taken when using such an expansion to ensure that neglected terms resulting from larger scale structures are in fact negligible . for social networks",
    ", we generally anticipate this highly segregated situation to be unimportant .",
    "we conclude that for most reasonable networks , clustering is only important for @xmath1 and @xmath2 if the typical degrees of nodes are low in which case @xmath0 is small .",
    "a consequence of these results is that if @xmath0 is moderately large , then @xmath1 and @xmath2 are effectively unaltered by clustering . if @xmath0 is small , however , clustering may or may not play a role in determining @xmath1 and @xmath2 , depending on whether @xmath0 is small because the degrees are small or because @xmath37 is small .",
    "when we drop the assumption of constant transmissibility , disease spread becomes more complicated .",
    "if @xmath18 is heterogeneous and @xmath5 infects a neighbour , then the _ a posteriori _ expectation for @xmath131 becomes higher : it is likely to infect more neighbours .",
    "this accentuates the effect of short cycles , enhancing the impact of clustering on @xmath0 , @xmath1 , and @xmath2 .",
    "a similar argument applies with heterogeneity in @xmath19 : if @xmath6 is not infected by one of its neighbours , then the _ a posteriori _ expectation for @xmath132 becomes lower : it is less likely to be infected by other neighbours , and so has multiple opportunities to prevent an epidemic .",
    "again this accentuates the effect of short cycles .    in this section",
    "we investigate how varying the infectiousness and susceptibility of nodes in the episims network enables clustering to alter the values of @xmath1 and @xmath2 .",
    "we will make use of the _ ordering assumption _ and its consequences from  @xcite : if @xmath125 is `` more infectious '' than @xmath126 in a given instance [ or @xmath133 `` more susceptible '' than @xmath134 , then @xmath125 is always more infectious than @xmath126 [ or @xmath133 always more susceptible than @xmath134 .",
    "more specifically , the ordering assumption states that if @xmath135 , then @xmath136 for all @xmath19 , and the corresponding statement for @xmath27 .",
    "the results of  @xcite show that if the ordering assumption holds , heterogeneity tends to reduce @xmath1 and @xmath2 , and the upper bounds on @xmath1 and @xmath2 correspond to homogeneous populations ( constant @xmath37 ) .",
    ".for the calculations of sections  [ sec : heterogeneous ] and  [ sec : weighted ] we determine @xmath7 using equations   and   with the distributions of @xmath18 and @xmath19 given in the first four rows , or by considering a maximally heterogeneous population for which @xmath30 of the population infects all neighbours and @xmath137 infect no neighbours .",
    "the function @xmath138 is the dirac delta function . [",
    "cols=\"^,^,^\",options=\"header \" , ]     for simulations in this section , we consider five different illustrative cases , which will be denoted throughout by the symbol given in table  [ table : symbols ] . in the first four , we use equation   so that @xmath139 with the distribution of @xmath18 and @xmath19 varying for each .",
    "we vary @xmath14 to change the average transmissibility . in the fifth case",
    "the out - transmissibility is maximally heterogeneous : a fraction @xmath30 of the population infect all neighbours , while the remaining @xmath137 infect no neighbours .",
    "the fifth case gives a lower bound on @xmath1 for a homogeneously susceptible population  @xcite .",
    "it is hypothesised to remain a lower bound on @xmath1 if susceptibility is allowed to vary  @xcite .",
    "we could also consider maximal heterogeneity in susceptibility , but the results for @xmath1 and @xmath2 merely correspond to interchanging their values for maximal heterogeneity in infectiousness , and so we do not need to consider it explicitly .",
    "we use simulations to calculate the rank reproductive ratio @xmath45 for the cases of table  [ table : symbols ] and plot the result for @xmath140 in figure  [ fig : hetr0 g ] .",
    "note that @xmath66 remains a good approximation to @xmath0 . in the first four cases ,",
    "@xmath0 is again again asymptotic to the unclustered approximation as @xmath141 .",
    "there are small kinks for [ 0pt][0pt ] and [ 0pt][0pt ] at @xmath142 and @xmath143 respectively , resulting from the nature of those distributions .",
    "the heterogeneities act to enhance the effect of clustering on @xmath0 , but the effect is relatively small .",
    "/{\\mathbb{e}}[n_r]$ ] calculated from simulations for the heterogeneous examples of table  [ table : symbols ] .",
    "the final panel ( lower right ) compares @xmath66 for all of the different cases , including both unclustered and homogeneous.,title=\"fig:\"]/{\\mathbb{e}}[n_r]$ ] calculated from simulations for the heterogeneous examples of table  [ table : symbols ] .",
    "the final panel ( lower right ) compares @xmath66 for all of the different cases , including both unclustered and homogeneous.,title=\"fig : \" ] + /{\\mathbb{e}}[n_r]$ ] calculated from simulations for the heterogeneous examples of table  [ table : symbols ] .",
    "the final panel ( lower right ) compares @xmath66 for all of the different cases , including both unclustered and homogeneous.,title=\"fig:\"]/{\\mathbb{e}}[n_r]$ ] calculated from simulations for the heterogeneous examples of table  [ table : symbols ] .",
    "the final panel ( lower right ) compares @xmath66 for all of the different cases , including both unclustered and homogeneous.,title=\"fig : \" ] +    in the final , maximally heterogeneous case [ 0pt][0pt ] , @xmath66 remains a good approximation to @xmath0 . at small values of @xmath30 ,",
    "the heterogeneity causes clustering to have a larger impact than in a homogeneous population as seen in the lower right panel of figure  [ fig : hetr0 g ] , and so this is not asymptotic to the unclustered approximation . at larger values of @xmath30",
    "the heterogeneous and homogeneous growth rates are similar .",
    "as before , we can calculate @xmath66 analytically , which helps explain our observations .",
    "if the ordering assumption holds , we may use a simplified notation @xmath144 to denote the transmissibility from a node with out - transmissibility @xmath25 to a node with in - transmissibility @xmath27 . from @xmath25 and @xmath19 from @xmath27 .",
    "if the ordering assumption fails , similar results hold , but the notation is more cumbersome . ] we have @xmath75 = { \\left \\langle t \\right \\rangle } { \\left \\langle k \\right \\rangle}$ ] and @xmath145 & = \\frac{1}{n } \\sum_u \\sum_{v\\neq u } \\iint[1-(1-t_{out}t_{in})^{n_{uv}}][1-t(t_{out},t_{in})]^{\\chi_{uv } } q_{out}(t_{out } ) q_{in}(t_{in } ) dt_{out } dt_{in}\\\\    & = { \\left \\langle k^2-k \\right \\rangle}{\\left \\langle t",
    "\\right \\rangle}^2 - 2{\\left \\langle n_\\triangle \\right \\rangle } { \\left \\langle t_{out}t_{in}t(t_{out},t_{in } ) \\right \\rangle }    - { \\left \\langle n_\\square \\right \\rangle } { \\left \\langle t_{out}^2 \\right \\rangle}{\\left \\langle t_{in}^2 \\right \\rangle } + \\cdots \\ , , \\end{aligned}\\ ] ] and so we may express the growth rate as a perturbation about the unclustered case @xmath146 giving @xmath147 for the second term , it may be shown that @xmath148 .",
    "the minimum occurs when @xmath37 is constant , suggesting that the maximum growth rate occurs in a homogeneous population .",
    "the maximum @xmath149 occurs either for [ 0pt][0pt ] : @xmath150 that is , when the out - transmissibility is maximally heterogeneous , or when the in - transmissibility is maximally heterogeneous : @xmath151 consequently , we expect that for given @xmath30 the minimum growth rate occurs with maximally heterogeneous infectiousness or susceptibility .",
    "these two minima for @xmath66 have previously been hypothesised to give lower bounds on @xmath1 and @xmath2 respectively  @xcite .",
    "we note that in the maximally heterogeneous case , the correction term in   is significant at leading order in @xmath37 . consequently , if @xmath152 is comparable to @xmath153 ( that is , the clustering coefficient  @xcite is comparable to @xmath39 ) , the threshold value of @xmath30 may be increased by clustering , and @xmath0 is not asymptotic to the unclustered prediction as @xmath141 .",
    "figure  [ fig : hetsizeprob ] shows that the unclustered predictions provide a good estimate of @xmath1 and @xmath2 in the clustered episims network .",
    "we expect that in a network with sufficiently large average degree , the impact of clustering should once again be small .",
    "we use arguments similar to before , taking a triangle with nodes @xmath5 , @xmath6 , and @xmath20 .",
    "the reasoning becomes more difficult because knowledge that @xmath5 infects @xmath6 may increase the expectation that @xmath5 infects @xmath20 .",
    "consequently the lost edges in triangles are more frequently encountered by the outbreak .",
    "however , the knowledge that @xmath5 infects @xmath6 also increases the expectation that @xmath5 infects its other neighbours . for a triangle to prevent an epidemic ,",
    "we need both that no edge outside the triangle leads to an epidemic and that the lost edge would otherwise have caused an epidemic .",
    "if the typical degree of the network is not small , then the fact that the lost edge is encountered more frequently may be offset by the fact that when it is encountered , other edges are more likely to spark an epidemic .    for [ 0pt][0pt ] where nodes infect all or none of their neighbours , the effect of different triangles that share the index case can not be separated as easily .",
    "the probability the index case directly infects a set of @xmath154 nodes of interest is @xmath30 , rather than @xmath155 .",
    "thus expansions as in   do not work as well : terms that were previously higher order become significant .",
    "close to the epidemic threshold , this can play an important role .",
    "however , well above the epidemic threshold , if the index case infects all of its neighbours , an epidemic is almost guaranteed and so @xmath156 regardless of whether the network is clustered .",
    "thus for [ 0pt][0pt ] , clustering affects @xmath1 only close to the epidemic threshold .    in the opposite case where",
    "nodes would be infected by any neighbour or else no neighbour , the values of @xmath1 and @xmath2 are interchanged .",
    "thus for maximally heterogeneous susceptibility @xmath1 could be significantly altered close to the threshold .",
    "the reason for this is as follows : for the first step the spread is indistinguishable from that of an outbreak with constant @xmath37 .",
    "however , when infections of rank 1 attempt to infect their neighbours , they can not infect any of the neighbours of the index case .",
    "in contrast , in the constant @xmath37 case , any neighbour not infected by the index case would be susceptible at later steps .",
    "consequently , the impact of triangles becomes much more important ( by a factor of @xmath157 ) and our earlier argument for neglecting them fails .",
    "the interaction of maximal heterogeneity with clustering in this case is larger , but it nevertheless becomes unimportant far from the threshold .",
    "our prediction that heterogeneity allows clustering to be more significant close to the threshold is borne out for [ 0pt][0pt ] where there is relatively strong heterogeneity in susceptibility just above the epidemic threshold . the epidemic threshold for [ 0pt][0pt ]",
    "is increased compared to the other cases .",
    "in contrast there is much stronger heterogeneity in susceptibility for [ 0pt][0pt ] at @xmath142 and in infectiousness for [ 0pt][0pt ] at @xmath143 .",
    "this results in a reduction in @xmath2 and @xmath1 respectively , but because it is far from threshold , there is little deviation from the unclustered predictions .",
    "when we allow edges to be weighted , new complications arise .",
    "the weights we use in our simulations are the durations of contacts from the episims simulation and are discussed in detail in  [ app : episims ] .",
    "if a contact in the original episims simulation is longer , a higher weight is assigned .",
    "if the weights of different edges were independent , then we could simply take @xmath158",
    ". however , edge weights are not independent : clustered connections tend to have larger weights .",
    "if brief contacts are negligible , the disease spreads on a subnetwork of the original network .",
    "the new network has a comparable number of short cycles to the original , but lower typical degree .",
    "this should enhance the impact of clustering .    for our calculations in this section ,",
    "we first isolate the impact of weighted edges by taking a homogeneous population ( @xmath159 ) and using @xmath160 .",
    "we vary @xmath14 in order to set @xmath30 .",
    "we then investigate a heterogeneous population using equation   with the first four distributions of table  [ table : symbols ] .",
    "results for a homogeneous population are shown in figure  [ fig : hom_weighted ] . because @xmath161 for all pairs , it follows that @xmath162 .",
    "if different edge weights were uncorrelated , then the value of @xmath0 would match with figure  [ fig : r0 g ] and @xmath1 and @xmath2 would match with figure  [ fig : probcomp ] .",
    "we see , however , that @xmath0 is significantly reduced from the homogeneous unweighted population ( but @xmath66 remains a good approximation ) .",
    "close to the threshold @xmath1 and @xmath2 are mildly reduced .",
    "these observations are consistent with our expectation that clustering should be accentuated by incorporating edge weights .",
    "although the predictions for @xmath1 and @xmath2 are not far off , we expect that they would improve if we adjusted the degree distribution to match that of the effective network on which the disease spreads .    when the population is moderately heterogeneous ( figure  [ fig : het_weightedr0 ] )",
    ", we still find that @xmath66 is a reasonable approximation to the true value of @xmath0 , however , it slightly underestimates @xmath0 as @xmath30 grows .",
    "unfortunately the analytic calculation of @xmath66 is much more difficult , and so it is more appropriate to use simulations to estimate its value .",
    "if there were no correlation between weights of different edges , then the calculation would reduce to that of section  [ sec : heterogeneous ] .     with heterogeneous transmissibility and weighted edges on the episims network.,title=\"fig : \" ] with heterogeneous transmissibility and weighted edges on the episims network.,title=\"fig : \" ] +   with heterogeneous transmissibility and weighted edges on the episims network.,title=\"fig : \" ] with heterogeneous transmissibility and weighted edges on the episims network.,title=\"fig : \" ]    we consider @xmath1 and @xmath2 in figure  [ fig : weightedsizeprob ] .",
    "the unclustered predictions are reasonable approximations of the actual values .",
    "the error is larger than before because we have combined two effects ( edge weights and heterogeneity ) that both accentuate the impact of clustering . in spite of this ,",
    "the predicted values of @xmath1 and @xmath2 are not far off , and the direction of the error is consistent : the unclustered prediction is always an overestimate .     and",
    "@xmath2 ( symbols ) for the weighted episims network compared with predictions in unclustered networks with the same edge weight distribution ( curves).,title=\"fig : \" ]   and @xmath2 ( symbols ) for the weighted episims network compared with predictions in unclustered networks with the same edge weight distribution ( curves).,title=\"fig : \" ]",
    "we have investigated the interplay of clustering , node heterogeneity , and edge weights on the growth rate @xmath0 , probability @xmath1 , and size of epidemics @xmath2 in social networks . for unclustered networks with independently distributed edge weights ,",
    "it is possible to predict all these quantities analytically . under weak assumptions we can accurately estimate @xmath0 , @xmath1 , and @xmath2 for clustered networks .    if the typical degrees are not small , then for a given average transmissibility and degree distribution :    * the dominant effect controlling the growth rate of epidemics is clustering .",
    "increased clustering reduces @xmath0 .",
    "* the dominant effect controlling the probability of epidemics is heterogeneity in infectiousness .",
    "increased heterogeneity reduces @xmath1 * the dominant effect controlling the size of epidemics is heterogeneity in susceptibility .",
    "increased heterogeneity reduces @xmath2    we are thus able to neglect clustering and still closely estimate @xmath1 based only on the degree distribution and the out - transmissibility pdf @xmath163 . the estimate for @xmath2 depends only on degree distribution and the in - transmissibility pdf @xmath164 .",
    "the impact of clustering is significant in altering @xmath0 , and its impact is mildly enhanced by heterogeneities .",
    "this enhancement occurs because the probability of following all edges of a cycle is increased if some of the edges are correlated due to the heterogeneity .",
    "if heterogeneity is large , clustering may play a small role in moving the epidemic threshold , but otherwise its effect on the threshold is negligible . in networks with small typical degree , it has been observed that clustering can modify @xmath1 or @xmath2  @xcite , which is consistent with our estimates .    if edge weights are included , but are independently distributed , then their impact is in modifying @xmath28 and @xmath26 .",
    "the resulting modification may be calculated explicitly , and edge weights have no further effect .",
    "if edge weights are correlated , they have a more important role in governing the behaviour of epidemics , particularly if higher weight edges tend to be the clustered edges ( as frequently occurs in social networks ) .",
    "if this happens , then the impact of clustering is enhanced , and the growth rate of epidemics is further reduced .",
    "when we move from predicting @xmath1 and @xmath2 to predicting @xmath0 , we find that the growth rate is well approximated by @xmath165/{\\mathbb{e}}[n_1]$ ] .",
    "this may be calculated analytically in the homogeneous case ( constant @xmath37 ) .",
    "when heterogeneities are included , the calculation becomes harder , and when edge weights are included it becomes largely intractable .",
    "however , these are easily estimated through simulation .",
    "these observations show that using @xmath0 to predict @xmath2 will generally be inadequate . in a homogeneous but clustered population , @xmath0",
    "is reduced but @xmath2 is unaffected , and so predictions of @xmath2 based on @xmath0 will be too small . in networks that are not clustered but",
    "have heterogeneities in susceptibility , @xmath0 is unaffected but @xmath2 is substantially reduced .",
    "consequently , the value of @xmath2 predicted from @xmath0 will be too large",
    ".    perhaps our most important conclusion about clustering is that it plays an important role in altering the growth of an epidemic , but it only plays a small role in determining whether an epidemic may occur or how big it would be .",
    "if the relevant questions are , `` how likely is an epidemic and how large would it be ? ''",
    "then the modeller may proceed ignoring clustering . if however , the question is `` how fast will an epidemic grow ? ''",
    "then clustering must be considered , but only enough to calculate @xmath66 .",
    "our results have implications for designing intervention strategies .",
    "a number of strategies are available to control epidemic spread , including travel restrictions , quarantines , and vaccination .",
    "most of the mathematical theory predicting the effects of these strategies has been developed under the assumption of no clustering .",
    "most immediately , if we measure @xmath166 at the early stages of an epidemic , traditional approaches will suggest that vaccinating just over half of the population will bring the epidemic below threshold .",
    "however , if the population is clustered , then the observed @xmath0 was already affected by the fact that some transmission chains were redundant . following vaccination",
    ", some of these chains will no longer be redundant and the disease may still spread with @xmath47 .    achieving a better understanding of the effect of clustering further helps to guide our intuition when choosing between strategies . for example , let us assume that we have the choice between two strategies : in the first , we stagger work schedules in such a way that a typical person s contacts is reduced by @xmath167 ; in the second , we implement population - wide behavior changes so that the same reduction in number of contacts is achieved , but the work contacts are unaltered .",
    "the first reduces clustering while the second increases the relative frequency of clustering .",
    "the value of @xmath0 is much smaller in the second case than in the first because of the larger clustering , but @xmath1 and @xmath2 are reduced by a comparable amount in both cases .",
    "which strategy is best depends on our goals and relative costs .",
    "strategies that enhance heterogeneity in infectiousness or susceptibility can be important to help reduce @xmath1 or @xmath2 , even when there is little impact on @xmath0 . depending on which quantity",
    "we want to minimize , different choices will be optimal .",
    "consider a choice between vaccinating all individuals with a vaccine that reduces @xmath7 by a factor of @xmath168 for all pairs @xmath5 and @xmath6 or a contact tracing strategy that will remove @xmath168 of all new infections before they have a chance to infect anyone .",
    "both strategies reduce @xmath30 by a half .",
    "however , the first reduces @xmath25 uniformly , while the second increases heterogeneity in @xmath25 . thus if we have the choice of the two strategies , contact tracing is more likely to eliminate the disease before an epidemic can happen .",
    "if our choice is instead between a global vaccine reducing @xmath27 by a factor of @xmath168 for all individuals , or a completely effective vaccine that is only available for @xmath168 of the population , the latter choice will be more effective for reducing @xmath2 .",
    "this work was supported by the division of mathematical modeling at the ubc cdc under cihr ( grants no .",
    "mop-81273 and ppr-79231 ) and the bc ministry of health ( pandemic preparedness modeling project ) , by doe at lanl under contract de - ac52 - 06na25396 and the doe office of ascr program in applied mathematical sciences , and by the rapidd program of the science & technology directorate , department of homeland security and the fogarty international center , national institutes of health .",
    "lus m. a. bettencourt contributed greatly to the early development of this work .",
    "i am grateful to sara y del valle for providing the episims network data .",
    "in this appendix , we describe the _ epidemic percolation network _ ( epn ) , a tool that allows us to consider an epidemic as a static object rather than a dynamically changing process .",
    "this eases the understanding of certain key features and provides an improved technique to efficiently estimate @xmath1 .",
    "epns have received moderate use recently  @xcite , and a precursor appeared in  @xcite .",
    "a sample epn for an erds  rnyi network of average degree @xmath73 and @xmath169 is shown in figure  [ fig : epn ] .     and an epn that leads to the same outbreak .",
    "nodes in the @xmath170 are denoted by large circles , nodes in the @xmath171 ( but not in the @xmath170 ) are denoted by pentagons , nodes in the @xmath172 ( but not in the @xmath170 ) are denoted by triangles , and nodes not in any of these components are denoted by small circles.,title=\"fig : \" ] and an epn that leads to the same outbreak .",
    "nodes in the @xmath170 are denoted by large circles , nodes in the @xmath171 ( but not in the @xmath170 ) are denoted by pentagons , nodes in the @xmath172 ( but not in the @xmath170 ) are denoted by triangles , and nodes not in any of these components are denoted by small circles.,title=\"fig : \" ]    typically to estimate @xmath1 in an sir model many monte carlo simulations are performed .",
    "this process requires many iterations to have confidence in the results .",
    "representative results from @xmath173 such simulations are found in figure  [ fig : er_vb_sim ] .",
    "note that there is considerably more noise in the estimates of @xmath1 than in the estimates of @xmath2 .     and",
    "@xmath2 in an erds  rnyi network of @xmath174 nodes and @xmath175 .",
    "theory ( curves ) compare well with results of @xmath173 simulations ( symbols ) .",
    "we take @xmath176 , with distributions of @xmath18 and @xmath19 as given in table  [ table : symbols].,title=\"fig : \" ]   and @xmath2 in an erds  rnyi network of @xmath174 nodes and @xmath175 .",
    "theory ( curves ) compare well with results of @xmath173 simulations ( symbols ) .",
    "we take @xmath176 , with distributions of @xmath18 and @xmath19 as given in table  [ table : symbols].,title=\"fig : \" ]    instead we generate a single epn @xmath32 .",
    "we first assign @xmath18 and @xmath19 to each node and ( if necessary ) @xmath20 to each edge .. if the infectiousness of @xmath6 depends on the infectiousness of the node that infected @xmath6 , then these results fail .",
    "this is the _ time - homogeneity _ assumption of  @xcite and is also used by  @xcite .",
    "some effects that can occur when this assumption is false appear in  @xcite . ]",
    "then for each node @xmath5 and neighbour @xmath6 we calculate @xmath7 and place the directed edge @xmath34 into @xmath32 with probability @xmath7 .",
    "the distribution of out - components of a given node is the same as for the final outbreak following an introduced infection of that node in the original epidemic model .    , but calculated through a single epn for each @xmath37 .",
    "the noise is substantially reduced in the @xmath1 calculations , but slightly increased in the @xmath2 calculations.,title=\"fig : \" ] , but calculated through a single epn for each @xmath37 .",
    "the noise is substantially reduced in the @xmath1 calculations , but slightly increased in the @xmath2 calculations.,title=\"fig : \" ]    if the system is above the epidemic threshold , then @xmath32 will ( almost surely ) have a giant strongly connected component @xmath170  @xcite .",
    "we follow  @xcite and define the set of nodes ( including @xmath170 ) from which @xmath170 may be reached following the directed edges to be the giant in - component @xmath171 .",
    "we symmetrically define @xmath172 to be the set of nodes reachable from @xmath170 .",
    "note that @xmath177 . if the initial infection is in @xmath171 , an epidemic occurs , and all nodes in @xmath172",
    "become infected .",
    "thus the size of @xmath171 corresponds to the probability of an epidemic @xmath1 and the size of @xmath172 corresponds to the size of an epidemic @xmath2 .",
    "this may be seen by comparing the epn in figure  [ fig : epn ] with the outbreak shown in figure  [ fig : sample ] .",
    "are infected , but the proportion vanishes as @xmath178 . ]",
    "thus in the limit of large networks , epidemic probability is well - approximated by @xmath179 while the fraction infected is well - approximated by @xmath180 .",
    "this observation allows us to estimate @xmath1 from a single epn ( figure  [ fig : er_vb_epn ] ) , rather than from hundreds of simulations ( figure  [ fig : er_vb_sim ] ) . if the structure of the network is sufficiently random , the error in @xmath1 and @xmath2 from a single epn is @xmath181 ( see , _",
    "e.g. _ ,  @xcite ) , and so in a large population a single simulation will provide a sufficiently good estimate .",
    "in this appendix we provide examples demonstrating the need for the more careful definition of @xmath0 in section  [ sec : formulation ] , and we explore properties of this definition .    a pair of simple examples demonstrates the difficulties with the standard definition . in our first example , the standard definition suggests no epidemic is possible ( @xmath48 ) , while in fact they are . in our second example , the standard definition suggests epidemics are possible ( @xmath47 ) , while in fact they are not .    for the first example , consider a fully - connected population of @xmath182 nodes .",
    "we add @xmath183 isolated nodes and consider a disease for which @xmath184 .",
    "a node in the connected component will infect on average @xmath73 nodes , while an isolated node infects none . on average therefore , a random index case infects @xmath185 other nodes . under the standard definition @xmath186 and epidemics should be impossible .",
    "however , if the index case is in the connected component , the introduction is likely to lead to an epidemic .    alternately , consider a population of @xmath187 nodes with each node having three neighbours .",
    "for simplicity we assume no short cycles .",
    "assume that a disease spreads with probability @xmath188 to a given neighbour .",
    "the average number of secondary infections caused by a single introduced infection is @xmath189 , giving @xmath47 under the standard definition .",
    "however , each secondary infection has only two susceptible neighbours , and so infects on average @xmath190 neighbours , and the outbreak dies out .",
    "some of these issues have been dealt with by  @xcite , who considered compartmental deterministic models of several types of individuals . at early time",
    "nonlinear terms are unimportant , and the profile of the infected population aligns with the eigenvector of the `` next - generation '' matrix . in stochastic settings ,",
    "the same alignment occurs , but it may do so more quickly or slowly than predicted and for some realisations it may instead die out . to make a more rigorous definition of @xmath0 , we turn to statements about the average behaviour .",
    "we set @xmath43}{{\\mathbb{e}}[n_r]}\\ ] ] to be the ratio of the expected number of infections in rank @xmath191 to the expected number in rank @xmath42 .",
    "this value is affected by local small - scale structures .",
    "if the network is small , it is also affected by the finite size of the network , but if the network is large enough relative to @xmath42 , we expect that the value will be unaffected by large - scale structure",
    ". in more concrete terms , the early growth of a disease in a neighbourhood is unaffected by whether that neighbourhood is part of a city of 100000 , 1 million , or 10 million .",
    "as the disease spreads further , the effect of the finite city size will be noticeable for the smaller cities first .",
    "if the population is large enough , the ratio converges before the finite size has any impact .",
    "we define @xmath0 mathematically as @xmath192    this definition is similar to that of  @xcite , who used @xmath193^{1/(r+1 ) } \\nonumber\\\\ { \\ifx\\relax\\relax \\ensuremath{\\mathcal{r}_0 }    \\else \\ensuremath{\\mathcal{r}_{0,\\relax } } \\fi}&=\\limsup_{r \\to \\infty } \\limsup_{|g|\\to\\infty }   \\hat{r}_r\\ , , \\label{eqn : trapman}\\end{aligned}\\ ] ] which is the limit as @xmath194 of the geometric mean of @xmath195 ( assuming the limit exists ) .",
    "this definition is more general and will converge in some cases where   does not .",
    "however , if   does converge ( and typically we see that it does ) , then it reaches the same value , but does so sooner .",
    "so to clearly see @xmath0 from  , we must have a larger network .",
    ", @xmath196 , and @xmath197 for epidemics in the episims network ( @xmath198 ) , an unclustered bimodal network ( @xmath199 with each node s degree coming either from a poisson distribution peaked at @xmath73 or a poisson distribution peaked at @xmath200 ) , and an erds  rnyi network ( @xmath199 , average degree @xmath70 ) .",
    "the calculations used @xmath174 simulations for each network . note the difference in vertical scales.,title=\"fig : \" ] , @xmath196 , and @xmath197 for epidemics in the episims network ( @xmath198 ) , an unclustered bimodal network ( @xmath199 with each node s degree coming either from a poisson distribution peaked at @xmath73 or a poisson distribution peaked at @xmath200 ) , and an erds  rnyi network ( @xmath199 , average degree @xmath70 ) .",
    "the calculations used @xmath174 simulations for each network . note the difference in vertical scales.,title=\"fig : \" ] , @xmath196 , and @xmath197 for epidemics in the episims network ( @xmath198 ) , an unclustered bimodal network ( @xmath199 with each node s degree coming either from a poisson distribution peaked at @xmath73 or a poisson distribution peaked at @xmath200 ) , and an erds  rnyi network ( @xmath199 , average degree @xmath70 ) .",
    "the calculations used @xmath174 simulations for each network . note the difference in vertical scales.,title=\"fig : \" ]    another suitable definition would be @xmath201\\nonumber \\\\ { \\ifx\\relax\\relax \\ensuremath{\\mathcal{r}_0 }    \\else \\ensuremath{\\mathcal{r}_{0,\\relax } } \\fi}&=\\lim_{r \\to \\infty } \\lim_{|g| \\to \\infty } \\overline{r}_r \\ , , \\label{eqn : rhat}\\end{aligned}\\ ] ] where the expectation is taken over realisations with @xmath202 .",
    "this will tend to require more steps to converge because it counts small outbreaks equally with large outbreaks , and so outbreaks which have not yet grown and are dominated by stochastic effects would be as important to the average as well - established epidemics .    a comparison of these three definitions of @xmath0 is shown in figure  [ fig : r0defn_comp ] .",
    "they all result in similar values for @xmath0 . for a clustered network ,",
    "equation   converges more quickly . for large unclustered networks , @xmath203 and",
    "both converge to @xmath0 at @xmath204 while @xmath196 takes longer . in an erds  rnyi network ,",
    "all three definitions give @xmath205 for all @xmath42 ; only noise due to insufficient simulations affects the calculation .    to be fully rigorous , the @xmath178 limit must be appropriately defined .",
    "it does not make sense to talk about @xmath178 for a given network , and we can not simply add nodes to the pre - existing network .",
    "we must take a sequence of networks in such a way that the small - scale structure is preserved , and as the network size grows , the size of the preserved structure increases .    to make this rigorous",
    ", we follow  @xcite .",
    "take a sequence of finite networks @xmath206 , with @xmath207 as @xmath208 .",
    "we define @xmath209 to be the network induced on the set of nodes within distance @xmath42 of a central node .",
    "the sequence of networks is taken so that the probability that the structure surrounding a randomly chosen central node is isomorphic to a given @xmath209 is the same for all @xmath206 if @xmath210 .",
    "this means that the small - scale structure in the different networks is the same , and the size of what is considered `` small - scale '' increases with @xmath211 .",
    "we note that although the @xmath178 limit may be well - defined , it is possible that the @xmath194 limit in does not converge .",
    "this may occur because , for example , growth within a neighbourhood may happen at one rate , while spread between neighbourhoods in a suburb may happen at another , and spread between suburbs in a city may happen at yet another .",
    "if the rate of spread continues to change as the grouping size changes , then the @xmath194 limit may not exist .",
    "an effect analogous to this may appear in  @xcite which considered disease spread in italy .",
    "two distinct growth rates are seen depending on whether the disease is spreading in the general country or in rome .    , @xmath196 , and @xmath197 for the same networks and conditions as in figure  [ fig : r0defn_comp ] except using a single epn for each data point with @xmath174 different index cases within that epn rather than @xmath174 distinct simulations [ actually at submission the first two plots used only @xmath212 index cases , more will be added when calculations complete].,title=\"fig : \" ] , @xmath196 , and @xmath197 for the same networks and conditions as in figure  [ fig : r0defn_comp ] except using a single epn for each data point with @xmath174 different index cases within that epn rather than @xmath174 distinct simulations",
    "[ actually at submission the first two plots used only @xmath212 index cases , more will be added when calculations complete].,title=\"fig : \" ] , @xmath196 , and @xmath197 for the same networks and conditions as in figure  [ fig : r0defn_comp ] except using a single epn for each data point with @xmath174 different index cases within that epn rather than @xmath174 distinct simulations [ actually at submission the first two plots used only @xmath212 index cases , more will be added when calculations complete].,title=\"fig : \" ]    finally , it is possible to estimate @xmath0 using a single epn rather than multiple simulations . this is a much faster process , and so it is possible to do many more simulations to reduce the noise .",
    "however , because it is chosen from a single epn , there may be a small systematic error . in figure",
    "[ fig : epn_r0defn_comp ] , we plot the values for the same conditions as in figure  [ fig : r0defn_comp ] .",
    "we use the same number of index cases and so the noise is comparable .",
    "the value of @xmath0 is not noticably affected by choosing a single epn rather than multiple simulations . in the calculations in the paper , we have used a single epn rather than multiple simulations .",
    "we briefly review previous work for epidemic spread in cm networks .",
    "these are the simplest networks to investigate , and so the theory has been developed further than for other networks  @xcite .",
    "see  @xcite for some discussion of more arbitrary unclustered networks .",
    "we extend the earlier theory by allowing independently assigned edge weights .",
    "early in the spread of an infectious disease on a cm network , the probability of a node becoming infected is proportional to its degree , and so the pdf for the degree of infected nodes is @xmath50 .",
    "we choose an infected node @xmath5 with degree @xmath4 uniformly from nodes of rank @xmath42 .",
    "if the network is large enough that we can ignore short cycles , then all of @xmath5 s neighbours are susceptible except the node which infected @xmath5 .",
    "thus @xmath5 may infect up to @xmath51 neighbours .",
    "the probability @xmath131 that @xmath5 will infect a randomly chosen neighbour is chosen from @xmath26 , and so the probability @xmath5 infects exactly @xmath213 neighbours is @xmath214^{k-1-j}$ ] . integrating this over possible values of @xmath25 and summing over @xmath4 and @xmath215",
    ", we find that for @xmath62 the rank reproductive ratio is @xmath216 and so @xmath217 thus we find that for cm networks .",
    "the best - known such networks are erds ",
    "rnyi networks which have a poisson degree distribution in the limit of large network size . ]",
    "@xmath218 .",
    "we look for the probability that a single infected node causes a chain of infections leading to an epidemic .",
    "because interchanging edge direction in an epn interchanges @xmath1 and @xmath2 , we may focus on calculating @xmath1 .",
    "equivalent techniques replacing @xmath25 by @xmath27 below give @xmath2 .",
    "our analysis is performed in the infinite network limit .",
    "we set @xmath54 to be the probability a randomly chosen index case does not start an epidemic .",
    "we find @xmath219^k p(t_{out } ) dt_{out } \\right ) \\",
    ", , \\ ] ] where @xmath55 is the probability a randomly chosen secondary case does not start an epidemic .",
    "the value of @xmath55 satisfies the recurrence relation @xmath220^{k-1 } p(t_{out } ) \\ , dt_{out } \\right)\\ , .\\ ] ] if @xmath48 , the trivial solution @xmath221 is the only solution .",
    "for @xmath47 an additional solution appears and is the physically relevant root . from this",
    "we can calculate @xmath222 .",
    "note that @xmath1 depends on the distribution of @xmath25 , but is not affected by the distribution of @xmath27 .",
    "similarly , @xmath2 depends on the distribution of @xmath27 but is not affected by the distribution of @xmath25 .",
    "this result holds for unclustered , but not for clustered , networks .",
    "we have shown that for cm networks , @xmath223 .",
    "in particular it depends only on the network properties and the average transmissibility .",
    "in contrast , the probability @xmath1 and size @xmath2 are affected by the details of the distribution . intuitively , this is easy to understand .",
    "for example , if we consider @xmath2 in populations with varying @xmath27 , at early times the rate of growth is governed by the average number of new infections created , which depends on the average transmissibility . however , a disproportionate number of highly susceptible nodes are infected , and so the average @xmath27 of remaining nodes drops . by the end of the epidemic nodes",
    "are much harder to infect than they would have been if all were equally susceptible initially , and so the epidemic infects fewer people .",
    "a consequence of this is that we can not predict @xmath2 based only on the early growth rate .",
    "although this is frequently done ( see for example  @xcite and references therein ) , these calculations usually assume that the population is homogeneously susceptible , which is not always the case , particularly when a vaccine or previous exposure to similar diseases exists .",
    "+     we consider a network produced by episims for portland , oregon  @xcite . this simulation uses census data , road structure , building locations , and population surveys to construct a virtual population that travels through the city . from the activity of individuals in the simulation , we may reconstruct who was in contact with whom and for how long .",
    "there are @xmath224 nodes in the network , of which @xmath225 are in the giant component .",
    "the average degree is approximately @xmath226 , and the average squared degree is approximately @xmath227 .",
    "the degree distribution has an exponential tail , and clustering is concentrated in the low - degree nodes . for our approximations of @xmath0 , we also need information about length @xmath72 paths .",
    "we calculate the number of pairs of nodes with each value of @xmath77 for which @xmath80 and @xmath79 .",
    "large values of @xmath77 are more frequent when @xmath79 .",
    "the distribution of edge weights is fairly broad .",
    "many contacts are very short , but the number of long contacts is not negligible .",
    "sara  y del valle , phillip  d. stroud , james  p. smith , susan  m. mniszewski , jane  m. riese , stephen  j. sydoriak , and deborah  a. kubicek . :",
    "epidemic simulation system .",
    "technical report laur06 - 6714 , los alamos national laboratory , 2006 .",
    "o.  diekmann , j.  a.  p. heesterbeek , and j.  a.  j. metz . on the definition and the computation of the basic reproduction ratio @xmath228 in models for infectious diseases in heterogeneous populations . , 28:365382 , 1990 .",
    "stephen eubank , hasan guclu , v  s  anil kumar , madhav  v marathe , aravind srinivasan , zoltn toroczkai , and nan wang .",
    "modelling disease outbreaks in realistic urban social networks . , 429(6988):180184 , 2004 .",
    "neil  m. ferguson , derek a.  t. cummings , simon cauchemez , christophe fraser , steven riley , aronrag meeyai , sopon iamsirithaworn , and donald  s. burke .",
    "strategies for containing an emerging influenza pandemic in southeast asia . , 437(7056):209214 , 2005 .",
    "jol mossong , niel hens , mark jit , philippe beutels , kari auranen , rafael mikolajczyk , marco massari , stefania salmaso , gianpaolo  scalia tomba , jacco wallinga , janneke heijne , malgorzata sadkowska - todys , magdalena rosinska , and w.  john edmunds . social contacts and mixing patterns relevant to the spread of infectious diseases .",
    ", 5(3):381391 , 2008 ."
  ],
  "abstract_text": [
    "<S> networks of person - person contacts form the substrate along which infectious diseases spread . </S>",
    "<S> most network - based studies of the spread focus on the impact of variations in degree ( the number of contacts an individual has ) . </S>",
    "<S> however , other effects such as clustering , variations in infectiousness or susceptibility , or variations in closeness of contacts may play a significant role . </S>",
    "<S> we develop analytic techniques to predict how these effects alter the growth rate , probability , and size of epidemics and validate the predictions with a realistic social network . </S>",
    "<S> we find that ( for given degree distribution and average transmissibility ) clustering is the dominant factor controlling the growth rate , heterogeneity in infectiousness is the dominant factor controlling the probability of an epidemic , and heterogeneity in susceptibility is the dominant factor controlling the size of an epidemic . </S>",
    "<S> edge weights ( measuring closeness or duration of contacts ) have impact only if correlations exist between different edges . </S>",
    "<S> combined , these effects can play a minor role in reinforcing one another , with the impact of clustering largest when the population is maximally heterogeneous or if the closer contacts are also strongly clustered . </S>",
    "<S> our most significant contribution is a systematic way to address clustering in infectious disease models , and our results have a number of implications for the design of interventions . </S>"
  ]
}