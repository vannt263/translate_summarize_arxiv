{
  "article_text": [
    "very high energy ( vhe ) @xmath0rays  interact in the earth s atmosphere , giving rise to highly relativistic showers which produce a few - nanosecond flash of cherenkov photons in a `` light pool '' of @xmath5 diameter .",
    "this can be detected by one or more ground - based telescopes , which collect this light using a mirror that reflects it onto a camera composed by an array of photomultipliers , converting the photons to a charge per pixel , and the pixel size is @xmath6 , which is quite well adapted to the shower image size , with four such telescopes spaced by @xmath7 making up the stereoscopic array , see @xcite . ] and thus giving an image of the shower as seen by each telescope .",
    "@xmath0ray  induced atmospheric showers have a rotational symmetry around the shower axis ( neglecting geomagnetic effects ) , which results in elliptical images on the cameras . by combining the information from all the shower images seen",
    ", the arrival direction and the energy of the @xmath0ray  can be reconstructed by well - established methods @xcite .",
    "the @xmath0ray  signal is , however , drowned out by an enormous number of background air showers initiated by charged hadronic cosmic - rays .",
    "contrarily to the @xmath0rays , the hadronic component of air showers is characterized by an asymmetric development of the particle cascade due to the hadronic interactions , which have large transverse momenta , and due to longer - lived muons reaching the telescope altitude .",
    "after decades of research @xcite , great progress has been made in the field of vhe @xmath0ray  astronomy in recent years , with the advent of the new generation of iacts .",
    "the major keys to this success have been stereoscopy  offering a three - dimensional view of the atmospheric shower  and fast imaging cameras characterized both by their time response at the nanosecond scale and by a fine pixel granularity .",
    "these features have led to larger effective detection areas , a better angular resolution and a much improved discrimination power against the abundant cosmic - ray background .",
    "nonetheless , the detection using standard analysis methods of sources at the level of 1% of the crab nebula flux requires several tens of hours with arrays such as  or , even at their optimal sensitivity , out of @xmath8 of available good - weather moonless nights .",
    "this observation time needed for detection of very low - flux sources , for the discovery of new classes of @xmath0ray  emitting sources , or for detailed morphological studies of extended sources can even become prohibitively long if mirror ageing occurs , causing an increase in threshold energy and thus a decrease in sensitivity .",
    "long experience has demonstrated the robustness against changing data - taking conditions of the standard hillas - parameter based analysis ( see @xcite and also a short description in sec .  [ stereo ] ) , essentially because of its stability under variable conditions , allowing its application to the entire set of iacts world - wide since the 1980 s .",
    "however , this kind of analysis does not exploit the correlation between images of the same shower as seen by different telescopes in a simple way , nor take advantage of fine - pixelization imaging .",
    "so , in recent years , additional methods have been developed in order to enhance the analysis sensitivity by fitting a model of the cherenkov photons produced by a @xmath0ray  shower to the images seen by each telescope , overcoming the above - mentioned limitations .",
    "a first successful development was carried out over a decade ago for the  experiment in mono - telescope mode @xcite with the 2d - model , where the image of the shower ( in particular its longitudinal profile but also its transverse profile ) is used to predict the angular origin of the event along the image axis , allowing the event direction on the sky to be obtained , as well as giving a @xmath9-based discrimination variable for background rejection .",
    "this method has subsequently been improved ( passing from a @xmath9 minimization to a maximum - likelihood , among other developments ) , and has been optimized to take full advantage of the stereoscopy provided by  ( see @xcite ) .",
    "in addition , a three - dimensional ( 3d - model ) reconstruction method has been introduced in  @xcite , where the result of the fit is a set of parameters describing the shower characteristics and where the selection analysis cuts are defined on the physical shower properties , rather than on the likelihood value .",
    "an upgraded version of the 3d - model analysis introduced a cut based on a @xmath9 value in order to include the information from untriggered telescopes , see @xcite .",
    "more recently , two different types of multivariate analyses ( ) have been applied for : the first using hillas - parameter based discriminant variables @xcite ; the second using discrimination based on hillas - parameter based variables , plus 3d - model parameters and 2d - model goodness - of - fit @xcite .    the new method presented in this paper",
    "is based on an  approach optimized for the detection of low - flux sources , in which new ideas have also been implemented .",
    "first of all , the decision was taken to explore only discriminant parameters which are not a goodness - of - fit value , principally so as to lower the sensitivity of the analysis to uncertainties due to nsb variations . indeed , in order for the systematics due to the nsb to be under control , goodness - of - fit",
    "based discrimination analyses need a rather precise knowledge of the underlying probability distribution ( for likelihood fits ) fit .",
    "] of the pixel response to @xmath0ray  showers and noise , together with its variation as a function of the nsb rate ( see for example sec .  3.7 of @xcite and the @xmath9 definition of @xcite )",
    ". these distributions may also be sensitive to imperfections of the electronics or the acquisition system and their drift over time , which might be difficult to reproduce or time - costly to implement with mc simulations of the instrument .",
    "avoiding such types of parameters should provide a more `` portable '' method , applicable to many current and future iacts .",
    "secondly , the information carried by the 3d - model about the predicted shape of @xmath0ray  images on the cameras is found to provide additional discrimination power when the hillas moments of the predicted images are calculated and used to derive new discriminant variables .",
    "thirdly , an energy reconstruction method has been developed explicitly for this work , the conception of which has allowed the definition of two new discriminant parameters .",
    "these parameters , combined with a third new one  all of which are detailed below  provide additional power for hadron rejection .",
    "special attention has been paid in this work to the cut optimization for different expected source characteristics ( intensity and spectral hardness ) , as well as for studies of source morphology .",
    "after a brief overview of the choices made for stereo reconstruction ( sec .",
    "[ stereo ] ) a versatile @xmath0ray  energy reconstruction algorithm will be presented in sec .",
    "[ oakenergy ] , which is used as the basis for two newly - developed parameters .",
    "the parameters chosen for the @xmath0/hadron discrimination are introduced in sec .",
    "[ selepara ] , while the details of the multivariate event classification method are presented in sec .",
    "the stability of the method is tested through comparison of mc simulations and real @xmath0ray  data in sec .",
    "[ robu ] . finally , in sec .",
    "[ perf ] the performance is evaluated through application to  sources .",
    "the steps of the shower reconstruction process used for the present work are described here .",
    "first of all , the images triggered by the event in the telescopes are cleaned so as to eliminate the pixels not containing a significant fraction of the cherenkov photon signal ( comparable to the nsb fluctuations ) using the methodology described in @xcite ; and a pixel is also rejected if its charge is less than @xmath10 above its pedestal level .",
    "this is the case for the standard  analysis",
    ". other iacts use thresholds which are adapted to their instruments . ] .",
    "the charges of the selected pixels are used to calculate the first and second moments of the images in each telescope , allowing the `` hillas parameters '' to be derived ( equivalent to fitting an ellipse to each image ) .",
    "a hillas ellipse is characterized by its _ length _ and _ width _ , as well as by its position with respect to the camera centre , by the total charge in photo - electrons ( p.e . ) , and by its main axis direction .",
    "images whose centres - of - gravity fall near the edge of the cameras are discarded so as to minimize shower parameter misreconstruction due to image truncation ; all the remaining images passing a pre - defined charge threshold are used to calculate the shower arrival direction and the intersection of the shower axis with the ground ( also known as _ impact position _ ) , see @xcite .",
    "the geometry of the stereoscopic images allows the slant depth of the shower maximum to be estimated , assuming the centre of gravity of the images to be the projection of the maximum into the image plane .",
    "the shower characteristics derived from the hillas - parameter based variables are useful as such , but also as the first guess for the subsequent 3d - model optimization @xcite . in the 3d - model",
    ", the @xmath0ray  shower is modelled by a 3d - photosphere of cherenkov photon origins in the atmosphere which is assumed to have a gaussian distribution along all axes .",
    "this photosphere is described by eight parameters which are intrinsic to the shower : the direction and the impact position of the incident @xmath0ray , the photosphere length ( along the shower axis ) and transverse width ( rotational symmetry around the shower axis being assumed ) , the slant depth of the shower maximum , and the number of cherenkov photons generated by the electrons and positrons in the shower development . the 3d - model is used to predict the distribution of cherenkov light in the cameras of a telescope array ; then the intrinsic parameters of the shower are adjusted to achieve a good fit ( using a maximum - likelihood optimization ) of the ensemble of @xmath0ray  shower images .    given",
    "the hillas and the 3d - model reconstruction procedures , two estimations of the event direction are available .",
    "the 3d - model point - spread - function ( psf ) is better than that provided by the hillas - parameter based reconstruction for energies below @xmath11 , whereas the inverse applies for higher energies . in this work",
    ", the hillas - parameter based direction has been chosen for simplicity of implementation .",
    "studies of the use of optimized combination of the two reconstructed directions will be undertaken for a future upgrade .",
    "in ground - based @xmath0ray  astronomy , sources are observed under various conditions of zenith angle , under which the images produced by @xmath0ray  showers propagating in the atmosphere vary markedly , and the shower images also vary depending on the impact parameter of the shower with respect to the given telescope position ( see for example the two - dimensional image profiles for such varying conditions in @xcite ) . in addition , sources may be observed at different offsets with respect to the centre of the camera , resulting in different detector responses . moreover",
    ", any loss of photon collection or detection efficiency can play an important role in the evaluation of the total image charge amplitude .",
    "therefore , the data analysis in this field is characterised by a wide use of lookup tables , in which the @xmath0ray  image characteristics as a function of the varying data taking conditions are stored to allow the modelling of the detector response to signal events .",
    "the energy of the @xmath0ray  shower can be reconstructed by using such lookup tables generated either with the hillas - parameter based information , or with that provided by the 3d - model .",
    "however , the method for the evaluation of the energy with the 3d - model requires the convergence of the model fit , which is not guaranteed , especially for low - charge two - telescope events . as a generic method usable for all analysis configurations",
    "was deemed preferable , the choice was made to work in the hillas - parameter based reconstruction framework .",
    "the proposed method of calculating the @xmath0ray  energy has the advantage of being flexible , because the definition of the charge profiles can be performed with any kind of @xmath0ray  simulation , and moreover , the energy evaluation phase is relatively fast with respect to other alternative methods , such as those requiring minimization @xcite .",
    "the energy reconstruction method presented here is composed of two separate phases : a preparatory phase and an evaluation phase .      the preparatory phase requires the generation of lookup tables ( _ charge profiles _",
    ", see for example fig .",
    "[ oak]a ) of the sum of the charges measured in a simulated @xmath0ray  cleaned image as a function of the impact parameter ( referred to below as @xmath12 ) .",
    "these are created for discrete sets of values of the simulated energy @xmath13 , of zenith angles @xmath14 , of values of the mirror efficiency @xmath15 , of offsets @xmath16 of the shower angular origin with respect to the centre of the camera , and for multiple bands of reconstructed shower maximum depths @xmath17 ( as estimated from the hillas parameters of the images ) .",
    "note that these charge profiles are related to the cherenkov light profile on the ground , but as detected in the images seen by the telescopes ( including the photomultiplier efficiency with wavelength and image cleaning effects , etc . ) .",
    "the energy evaluation phase consists of the use of these pre - generated charge profiles to calculate the event energy based on a weighted combination of the estimates of the energy in each telescope .",
    "the strategy for the evaluation of the energy in each telescope can be easily visualized by a tree , see fig .",
    "[ oak]b . for an event having a triggered telescope @xmath18 with an associated mirror efficiency @xmath19 and a measured charge @xmath20 ,",
    "there are four reconstructed parameters : the zenith angle @xmath21 , the offset @xmath22 , the maximum depth @xmath23 and the impact parameter with respect to the position of the telescope @xmath24 .",
    "the weight of each branch of the tree @xmath25 can be calculated , where @xmath25 is given by : @xmath26 and where the weights @xmath27 are given by the interpolation of the nearest simulated values . as an example , for an event having a reconstructed zenith angle @xmath21 the algorithm searches for the two fixed values @xmath28}$ ] between which to interpolate such that @xmath29 $ ] , and applies a weight of @xmath30 . for each branch of the tree ,",
    "given the value of the measured charge @xmath31 , the event energy associated with the telescope can be retrieved using the charge profiles mentioned in sec .",
    "[ prepa ] , which were defined for a set of energy values .",
    "the energy in each triggered telescope can thus be easily calculated by a weighted mean on all the energy values and weights obtained from the @xmath32 branches : @xmath33}{\\sum_{j=1}^{32 } { w_{j } } }    \\label{etel}\\ ] ] the energies @xmath34 calculated separately for each triggered telescope are combined in the final step with a charge - weighted mean : @xmath35,\\ ;    { \\rm where}\\ ; { q_{\\rm tot } } = \\sum_{i=1}^{n_{\\rm tels } } { q_{{\\rm tel}_{i } } }    \\label{meane}\\ ] ] @xmath36 being the total charge of the event .",
    "the resolution and bias of the current implementation of the algorithm can be seen in fig .",
    "[ energyresol ] : in the energy range 0.2@xmath37 the resolution is almost stable at @xmath38 , while the bias is better than @xmath39 for @xmath40 .",
    "the definitions of the discriminant parameters take advantage of the information carried by the two different stereo reconstruction algorithms discussed in sec .",
    "[ stereo ] ( the 3d - model and hillas - parameter based ones ) and of the energy reconstruction algorithm introduced in sec .",
    "[ eval ] . as will be mentioned in sec .",
    "[ importance ] , the parameters have been chosen according to their discriminant power and in order to avoid strongly - correlated variables .      for a given reconstructed shower , two powerful discriminant parameters commonly used for stereoscopic arrays can be defined : a _ mean scaled length _ ( mscl ) and a _ mean scaled width _ ( mscw ) . as described in @xcite ,",
    "lookup tables are prepared based on simulations , which contain the mean width and length and their respective rms scatter for a @xmath0ray  as a function of the amplitude of the shower image in the camera and the impact parameter relative to the telescope .",
    "the mscl and mscw are then calculated as the mean values of the deviations of the measured lengths and widths from the predicted mean values , divided by their rms . in short ,",
    "these mean scaled parameters indicate deviations of the shape of the detected images compared to those resulting from the @xmath0ray  simulations , and hence allow for discrimination , see fig .  7 of @xcite for further details .",
    "the hillas - parameter based reconstruction and discrimination have been the basis of a large number of discoveries in recent years , showing that these two simple scaled parameters were sufficient for an efficient @xmath0/hadron discrimination in case of bright sources ( i.e. , @xmath41 c.u . ) .      as described in sec .",
    "[ stereo ] , eight parameters are adjusted by the 3d - model fit , which also provides the error estimates for these parameters . among these , two parameters , the _ _ reduced 3d - width__/hadron discrimination parameter called _ reduced 3d - width _ has been defined , though for simplicity this is referred to as the 3d - width in the following . ] and the depth of shower maximum ( _ 3d - depth _ ) , together with the error on the former parameter ( _ 3d - width - err _ ) , have been retained for their high discriminant power .",
    "the distribution for the 3d - width for @xmath0rays  ( fig .",
    "[ model3dpar]a ) is narrower and has a peak at lower values compared to that of the background .",
    "the same applies to the 3d - width - err ( fig .",
    "[ model3dpar]b ) , showing that the model is not suitable for the representation of a hadron - induced shower , thus giving larger error values as a consequence , with an associated discrimination power .",
    "moreover , it was found that the two 3d - width related parameters show a significant separation performance over the entire energy range , while 3d - depth ( fig .",
    "[ model3dpar]c ) is highly discriminant for lower energies , with decreasing separation power with increasing energy , as will be shown also in sec .",
    "[ importance ] .              beyond the five above - mentioned discriminant parameters ,",
    "three new ones have been defined for the purpose of further enhancing the @xmath0/hadron separation performance . due to the difference in the shower development , especially regarding its rotational asymmetry / symmetry around the shower axis , even in the case where the fit of a hadronic shower with a @xmath0ray  model ( as for instance in @xcite ) succeeds",
    ", it may lead to incoherencies  in both shape and total charge  between the predicted shower images and those observed ( or absent ) in the individual telescopes ( see fig .  [ model ] ) . the alternative method proposed here",
    "is to explore these differences by defining additional hillas parameters ( here called _ hillasonmodel _",
    "parameters ) using the predicted images in the cameras , to which the same cleaning and moment calculation procedures are applied and which can be used to define new discriminant variables . in this way the inter - telescope correlations which are inherently included by the 3d - model optimization are further exploited in a simple hillas - parameter based discrimination framework .      the discriminant parameter named @xmath42 is based on the expected difference in the angular distance on the sky between the two reconstructed shower directions when using _",
    "hillas _ and the _ hillasonmodel _ ellipses : @xmath43 where @xmath44 and @xmath45 are the normalized vectors corresponding to the two directions . the shift in the mean value of the @xmath42 distributions",
    "( see fig .",
    "[ newpars]a ) is due to the fact that the difference in the major axis of the two ellipses is small for a well - fitted @xmath0rayand larger for a badly - fitted hadron .",
    "the energy reconstruction procedure described in sec .",
    "[ oakenergy ] allows the derivation of the following parameter based on the ratio of two reconstructed energy values : @xmath47    \\label{de}\\ ] ] where the energy of the event , @xmath48 , is estimated with the hillas parameters of the detected images , and the additional energy estimation , @xmath49 , is carried out based on the _ hillasonmodel _ parameters .",
    "this ratio is expected to have small deviations from zero for well - reconstructed @xmath0rays , while for misreconstructed hadrons larger deviations are expected .",
    "the distributions of @xmath46 for simulated @xmath0rays  and for real background are illustrated in fig .",
    "[ newpars]b , and these differ as expected , the background having a large tail towards smaller @xmath46 .",
    "the third new parameter also takes advantage of the new energy reconstruction procedure .",
    "having calculated the event energy and knowing the reconstructed impact parameter of the event , the second phase of the procedure for the energy evaluation per telescope described in sec .",
    "[ oakenergy ] can be inverted to find the expected image charges @xmath51 on each telescope .",
    "a discriminant parameter based on the deviation of @xmath51 with respect to the measured charges @xmath52 can be defined using a least squares in charge : @xmath53 ^ 2    \\label{missing}\\ ] ] where @xmath54 is the number of telescopes in the array and @xmath55 is the summed charge in all telescopes as defined previously in eq .",
    "[ meane ] . for poorly - reconstructed events ,",
    "an inconsistency between the energy evaluation and the reconstructed impact position is expected .",
    "hence , the predicted charge @xmath56 on a telescope for such an event is expected to be very different from the @xmath52 measured ( or not measured , in the case where a telescope did not trigger ) . as shown in fig .",
    "[ newpars]c , the shape of the @xmath50 distributions reflect the expected behaviour , the background events having larger values .",
    "in order to achieve an efficient hadron rejection , all the above - mentioned parameters are used within a multivariate discrimination scheme based on the @xcite package within the @xcite framework . among all the available discrimination algorithms , this work had initially focused on neural networks ( _ multi layer perceptron _ or mlp ) and on _ boosted decision trees _ ( bdt ) . during these early tests",
    ", it became immediately clear that the bdt technique was more stable and gave better results in terms of signal - to - background discrimination , thus confirming that this technique is the best out - of - the - box multivariate procedure , requiring minor adjustments to be applicable .",
    "a summary of the operation of the bdt technique is given in appendix [ bdtdesign ] , with details particularly concerning the design of the decision trees , the difficulties which can be encountered through overtraining , and the best pruning strategies to apply for the case of iacts .",
    "the multivariate classification technique consists of four main phases : the first one is the _ training _ ( see appendices  [ trainingphase ] , [ boosting ] ) where the  forests \" of decision trees are constructed , with a set of events randomly chosen from the input .",
    "then , in a second phase , the classifier performance is _ tested _ with an independent set of events , and _ evaluated _ ( see appendices [ pruning ] , [ classifier ] ) .",
    "this study led to a specific design of the decision trees , differing somewhat from the default options of the bdt procedure as implemented in . since these details could be useful for the implementation of this technique for other iacts , they are included in appendix [ treedesign ] .",
    "after the definition of the final cut values , the classifier is finally _ applied _ to the data ( see appendix [ cutappli ] ) .",
    "the @xmath0ray  shower samples were produced by mc simulations with kaskade , @xcite .",
    "the @xmath0ray  showers are simulated between @xmath57 and @xmath58 for two different azimuths ( _ north _ and _ south _ ) , several zenith angle bands spaced regularly in @xmath59 ( in steps of 0.05 ) from @xmath60 to @xmath61 , and for a point - like source .",
    "the resulting cherenkov light is then propagated through the  detector with smash , @xcite , where the source position can be shifted to different offsets @xmath16 from the centre of the camera ( six @xmath16 values spaced by @xmath62 from @xmath60 to @xmath63 are simulated , where @xmath63 corresponds to the radius of the  field - of - view or fov ) .",
    "taking advantage of the large set of available  data as a background sample , the use of time - consuming and marginally - reliable hadron simulations could be avoided .",
    "the background was therefore extracted from extragalactic observations using regions of the camera which do not contain any known @xmath0ray  source , at various zenith angles , and taking into account the northern or southern azimuth of the observations ( to account for different geomagnetic field effects ) .",
    "all the hadrons reconstructed out to angles including the  fov plus @xmath64 are taken into account .",
    "interval in @xmath65 ( tev ) + 1 & 0.01  5.80 & 0.0  0.1 + 2 & 5.80  6.18 & 0.1  0.3 + 3 & 6.18  6.35 & 0.3  0.5 + 4 & 6.35  6.59 & 0.5  1.0 + 5 & 6.59  6.82 & 1.0  2.0 + 6 & 6.82  7.13 & 2.0  5.0 + 7 & 7.13  10.0 & 5.0  1000 +      a set of bins in energy , zenith angle , and telescope multiplicity ( i.e. , the number of triggering telescopes ; two to four in the case of ) are defined for the training / test phases of each of the implemented analysis configurations ( see sec .",
    "[ hardsoftspectra ] ) .",
    "there are eight zenith angle bins and seven energy bins , in order to regroup the different classes of events showing similar properties .",
    "the shape of the parameter distributions for each defined group may differ from the other groups , leading to a different background rejection performance . the zenith angle bins are defined in @xmath66 intervals from @xmath67 up to @xmath68 , then in @xmath69 intervals , and finally in a single interval ) as used in the mc simulations is more convenient ; however , the different choice used here for the  training has been imposed by some initial compatibility constraints with other modules inside the  analysis package . ] from @xmath70 to @xmath71 for each of which seven energy bins are defined by the number of photons in the shower as fitted by the 3d - model ( referred as to _ nphot _ ) , as shown in fig .",
    "[ nphotbins ] .",
    "the latter choice has been found to be effective in avoiding brusque variations in the final effective area .",
    "the phase space is additionally subdivided in two bins in telescope multiplicity : one for the two - telescope events and one for the three and four - telescope events , leading to a total of 112 bins altogether .",
    "this split has been motivated by the fact that for events which trigger only two telescopes , less information is available for geometric reconstruction , therefore leading to a parameter space which is considerably different with respect to that for events triggering three and four - telescopes .",
    "it should be noted that in order to avoid badly - reconstructed @xmath0ray  events polluting the training and test phases , such events are excluded using a cut on the angular distance on the sky between the reconstructed event direction with respect to the source direction ( @xmath72 ) .",
    "the multivariate method _ ranks _ the discriminant parameters according to the frequency with which they are used in the splitting of the decision tree nodes .",
    "the values shown in the boxes of fig .",
    "[ variableimportance]a are given by the sum of the relative weights given by the bdt training .",
    "it can be observed that at low energies ( @xmath73 ) the most important discriminant parameter is the 3d - model estimated depth of the shower maximum , with its importance decreasing as a function of energy .",
    "the second parameter in order of importance is @xmath74 : while its discrimination performance is clearly high in all energy bins , it is more powerful at low energies is still less discriminant than the depth at shower maximum . ]",
    "( @xmath73 , bin in _ nphot _",
    "@xmath75 ) or high energies ( @xmath76 , bin in _ nphot _ @xmath77 ) .",
    "the least discriminant parameter in almost all cases is mscl .",
    "the importance of the chosen parameters can also be evaluated by checking the relative quality factor when progressively adding groups of variables to the training , where the quality factor is defined as @xmath78 with @xmath79 , @xmath80 being the number of events after and before cuts , respectively , in a given bin .",
    "three different test configurations are defined : the first group includes only mscl and mscw ; the second comprises mscl , mscw plus the group of the three chosen 3d - model parameters ; and the third adds the three new ones defined for the purpose of this work to the preceding groups .",
    "the results are given in fig .",
    "[ variableimportance]b : a significant gain in performance is achieved when adding the group of the three 3d - model parameters to the hillas - parameter based ones ; and with the addition of the new parameter group a further @xmath81 of background is cut away , leading to an additional gain in @xmath82 of @xmath83 .",
    "finally , it should be noted that investigation of the effects of the correlations between the discriminant parameters resulted in the elimination of a few parameters which had been defined at an early stage of the analysis development ( see @xcite ) .",
    "optimization tests within the specific framework used here showed that the inclusion of pairs of highly - correlated variables resulted in a loss of discrimination performance , probably due to the overall development of the trees in the forest being more sensitive to fluctuations .      the training on each event class described in sec .",
    "[ trainingtest ] provides a separate bdt classifier ( see fig .",
    "[ bdtresponse ] for two examples ) , on which the analysis cut is based . for the definition of the final cut values , the use of the highest significance criterion provided by the bdt training process was found to be subject to statistical fluctuations .",
    "for this reason , @xmath0ray  efficiency profiles as a function of energy were defined in order to optimize the detection sensitivity for sources with different fluxes , through an iterative optimization process . for illustration , the pre - defined @xmath0ray  and corresponding background efficiencies for one analysis configuration , of the five described below ,",
    "is shown in fig .",
    "[ hardspectra ] . for the purpose of the analysis of sources showing different spectral indices ,",
    "five configurations are defined based on the following charge thresholds : 40 , 60 , 80 , 110 and @xmath84 .    to achieve an optimal sensitivity for sources with spectral indices . ]",
    "@xmath85 and fluxes above @xmath86 c.u .",
    ", an analysis configuration having a charge threshold of @xmath87 ( and a similar one at @xmath88 ) has been developed .",
    "this configuration is therefore adapted for most galactic - plane observations , where most of the sources discovered have hard spectra ( see @xcite ) and is also used for low - redshift extragalactic observations . for similar spectral indices but lower fluxes ( @xmath89 c.u . ) , another configuration has been defined with a charge threshold of @xmath90 and for which the @xmath0ray  efficiencies have been set so as to yield a lower rate of low - energy two - telescope events than the other configurations , see fig .",
    "[ hardspectra ] .",
    "these two characteristics help in reducing the lower energy fluctuations due to the background events , thus enhancing the sensitivity for this source class .",
    "for morphological studies of extended sources , a dedicated configuration has been developed which has an enhanced psf , optimizing the performance in geometrical reconstruction by raising the charge threshold to @xmath91    for high - redshift extragalactic observations where the effect of @xmath0ray  absorption becomes significant , steep - spectrum ( @xmath92 ) sources are naturally expected . to optimize the sensitivity for the detection of this class of sources ,",
    "the image size threshold has been lowered to @xmath93 p.e . in order to enhance the signal of the abundant lower energy events .",
    "[ psfcuts ] discusses the instrument response functions associated with these configurations .",
    "one of the key points of the present approach is its ease of implementation without the need for calibration of the discriminant variables as a function of the nsb rate for a given fov . with the  telescopes , the nsb median value of the latter can vary from few tens of mhz per pixel for extragalactic observations , up to @xmath94 for @xmath95 of  observations and for central parts of the galactic plane .",
    "[ bdtnsb]a shows the distribution of the bdt response for simulated @xmath0rays  following a power - law ( @xmath96 ) at zenith , with different nsb rates ranging from 40 to 200mhz .",
    "the stability of the bdt response to nsb rates up to 150mhz is remarkable : the relative migration of events from the signal to the background range remains well below 2% . for a larger nsb rate of 200mhz ,",
    "the migration attains @xmath9710% , however , the resulting systematic error on the effective area ( i.e. , @xmath98 ) remains dominated by the error due to the uncertainty in the energy scale @xcite , depending on the spectral index of the source .",
    "a check of the energy dependence of such an effect has also been carried out through reconstruction of simulated @xmath0rays  following the same power - law and the same nsb levels as above .",
    "no significant bias was found on the measured spectral index .",
    "this was expected , since the choice of those variables already available ( mscl , mscw , 3d - width , 3d - width - err , 3d - depth , see sec .",
    "[ hillaspara ] and [ modelpara ] ) , and the definition of the new discriminant parameters ( @xmath42 , @xmath99 and @xmath50 , see section [ newpara ] ) was made following the study of their individual robustness with respect to the nsb rate .      the consistency of the bdt response was checked by comparison of its distribution for simulated @xmath0rays  to that of the signal from the crab nebula .",
    "mc simulations were made for @xmath0rays  with a spectrum following a power - law up to 100tev with a differential photon index @xmath100 , and a zenith angle of @xmath101 , matching closely the chosen data - set . as can be seen on fig .",
    "[ bdtnsb]b , there is a good agreement between the simulated sample s bdt distribution and that of the crab nebula signal .",
    "finally , as is mandatory in vhe @xmath0ray  astronomy , an overall consistency check of the analysis chain was performed by comparing the spectrum as measured with the present  approach to that obtained with the standard hillas - parameter based one , for a source such as the crab nebula @xcite . as shown in fig .",
    "[ bdtperf ] , fitting an exponentially cut - off power - law to the data in the range 380gev to 44tev using the method in @xcite yields a flux of @xmath102 , an index of @xmath103 , and a cut - off energy @xmath104 .",
    "these values are fully compatible with those published , evaluated in the range 410gev to 40tev : @xmath105 , @xmath106 , and @xmath107 , noting that the data - set used here is twice as large as that in @xcite and that the difference ( @xmath9715% ) in the differential flux is well within the systematic error of the iact measurements .",
    "the same type of check made on other established sources yielded an excellent level of compatibility , further reinforcing the confidence in the approach presented here .",
    "source & @xmath108 & @xmath109 c.u . &",
    "@xmath110 & analysis & lt & on & off & n@xmath111 & n@xmath112 & @xmath113 + @xmath114 & @xmath115 & 3.4% & @xmath116 & hillas 40 p.e . &",
    "24.8 & 5748 & 4962 & 785 & 10.2 & 2.05 + @xcite &  @xmath117 & & & mva 80 p.e .",
    "& 24.8 & 409 & 269 & 140 & 7.6 & 1.51 + &  @xmath118 & & & mva 40 p.e .",
    "& 24.8 & 1015 & 665 & 349 & 11.9 & * 2.39 * + @xmath119 & @xmath120 & 2.0% & @xmath121 & hillas 80 p.e . & 25.4 & 1167 & 840 & 327 & 10.1 & 2.00 + @xcite &  @xmath122 & & & mva 80 p.e . & 25.4 & 490 & 263 & 226 & 11.8 & 2.35 + &  @xmath123 & & & mva 40 p.e . & 25.4 & 1082 & 706 & 375 & 12.4 & * 2.46 * + @xmath124 & @xmath125 & 1.6% & @xmath126 & hillas 80 p.e . & 116.8 & 8899 & 7718 & 1185 & 12.6 & 1.16 + @xcite &  @xmath127 & & & mva 80 p.e . & 116.8 & 2152 & 1319 & 833 & 20.0 & * 1.85 * + &  @xmath128 & & & mva 40 p.e . & 116.8 & 4477 & 3277 & 1199 & 18.9 & 1.74 + @xmath129 & @xmath130 & 0.8% & @xmath131 & hillas 80 p.e . & 120.0 & 4199 & 3868 & 330 & 5.0 & 0.46 + @xcite & @xmath132 & & & mva 80 p.e . & 120.0 & 1437 & 1109 & 324 & 9.0 & * 0.82 * + & @xmath133 & & & mva 40 p.e . & 120.0 & 3306 & 2967 & 338 & 5.9 & 0.54 + @xmath134 & @xmath135 & 2.0% & @xmath136 & hillas 200 p.e .",
    "& 50.1 & 606 & 310 & 296 & 14.4 & 2.03 + @xcite & @xmath137 & & & mva 110 p.e .",
    "& 50.1 & 731 & 312 & 419 & 19.3 & * 2.73 * + & @xmath138 & & & mva 80 p.e .",
    "& 50.1 & 1010 & 553 & 457 & 16.8 & 2.37 +    [ tableperformance ]    the performance of the analysis scheme proposed here has been tested on a set of faint  sources .",
    "the spectral index is used to select , a priori , two test configurations which are expected to be the best adapted .",
    "the results obtained for a sample of five cases are presented in tab .  1 and compared to the standard analysis ( labelled as hillas ) , so as to illustrate the trends as a function of the sources spectral indices .",
    "there are four extragalactic sources ordered by spectral index  the three blazars @xmath114 , @xmath119 and @xmath124 , and the radio - galaxy @xmath139  together with one hard - spectrum galactic source , the composite supernova remnant @xmath134 ( references are given in the table ) .",
    "the main trend which can be seen is that the best - adapted  configuration for the source with the softest spectrum ( @xmath114 ) is the one with the lowest charge threshold ( i.e. , @xmath140 ) , whereas the @xmath141 configuration yields the best performance for the hardest spectrum source ( @xmath134 ) .",
    "the @xmath87 and @xmath140 configurations are somewhat equivalent for sources with spectral indices @xmath142 , a value which appears to constitute a pivot index above which the use of the lowest charge threshold configuration is the best adapted .    in more detail , indeed ,",
    "the  @xmath140 and @xmath87 configurations give a similar gain in sensitivity over the standard hillas - parameter based analysis for the two blazars for which @xmath142 ( by a factor of about @xmath1 for both configurations for @xmath119 , and 1.5@xmath143 for @xmath124 ) .",
    "in contrast , for @xmath114 ,  at @xmath144 is significantly less efficient than that at @xmath145 , the reference in the table also applies specific hillas _ soft spectrum _ cuts with a @xmath145 threshold , similarly to the best  configuration here . ] on the other hand , for @xmath139 , which shows a harder spectrum ( @xmath146 ) than the other extragalactic sources , the  @xmath87 configuration becomes dominant over the @xmath140 one , with a clear gain in sensitivity as compared to the standard hillas analysis by a factor of @xmath2 ( versus a factor @xmath1 for the @xmath140 case ) .    with a gain in sensitivity of the  approach over the hillas - parameter based analysis ranging from a factor @xmath1 to @xmath2 for the sample of sources shown here",
    ", this corresponds in a gain in observation time by a factor @xmath3 to @xmath4 , as can be seen from the column @xmath113 of tab .  1 .",
    "a new analysis method is presented , based on an  approach optimized for the detection of low - flux sources , conceived so as to be easily and quickly adaptable to other current and future iacts .",
    "three new discriminant variables are combined with the already - known hillas - parameter based variables mean - scaled image width and length ( mscl , mscw ) , and with carefully - selected parameters from the more recent 3d - model ( the 3d - width of the cherenkov photosphere , its error , and the 3d - depth of shower maximum ) in a multi - variate discrimination procedure using _ boosted decision trees _",
    ", where this analysis has been adapted to the particularities of detection with iacts .",
    "two of the new discriminant parameters  one of which uses a new energy reconstruction method described here  are based on the hillas moments calculated from the 3d - model predicted images in the different telescopes , which provides a means to take into account the inter - telescope correlations which are missing from a simple hillas - parameter based discrimination framework . for the third new discriminant parameter , the energy evaluation method is inverted to predict the expected image charges and compare them in a least squares with the images measured in each telescope .",
    "a number of bdt classifiers are defined , in order to take account of the different classes of data , with bins in zenith angle , telescope - multiplicity and reconstructed energy . note that the number of photons in the cherenkov photosphere as fitted by the 3d - model is used as a proxy for the reconstructed energy as this is found to be effective in avoiding brusque variations of the final effective area .",
    "the robustness of the new analysis method is shown with respect to the variations in nsb for mc simulated @xmath0rays  by examining the evolution of the bdt response .",
    "the consistency is checked by comparing the bdt response with that for the real @xmath0ray  excess from the crab nebula as seen by a final consistency check is performed by comparing the spectrum from the crab nebula as derived by the present approach to that published by  using the hillas - parameter based analysis , and the two spectra are shown to have an excellent compatibility .",
    "the performance of the different groups of parameters when applied to mc simulated @xmath0rays  and real background data is presented , showing the relative gains achieved in each case above the standard hillas - parameter based analysis . for the application to the analysis of real sources , several configurations",
    "have been defined so as to allow cut optimization for different expected source characteristics ( intensity and spectral hardness ) , as well as for studies of source morphology .",
    "the method is applied to a set of known  sources with measured characteristics .",
    "the gain in sensitivity ( @xmath1 to @xmath2 ) is in conformance with the expectation based on their spectra and intensities .",
    "the method is currently being applied successfully to  observations , contributing to discovery of new faint sources , see e.g. , @xcite .",
    "the overall development of this new  approach presented here has been carried out in order to be easily adapted and applied to other current and future stereoscopic arrays  such as , and in the near future the  upgrade ( in the stereo energy regime )  this ease of application being achieved thanks to the rapidity and flexibility of the method presented .",
    "these features have been recently demonstrated through successful application for the future cherenkov telescope array ( cta ) project .",
    "future improvements of the method include a deeper study of the parameter decorrelation prior to the use of the  training procedure , as mentioned in sec .",
    "[ importance ] and a further investigation on the possibility to mix the two reconstructed directions ( the hillas - parameter based and the 3d - model ones ) as a function of an observable related to the energy ( see sec .",
    "[ stereo ] ) .",
    "the study of the stability and performance of the method as a function of a degraded performance of the telescopes through mc simulations constitutes also an interesting point to be investigated in a future work .",
    "the _ training _ phase of a multivariate background rejection method consists of the construction of a decision tree ( see fig .  [",
    "bdtree]a ) given a pre - defined specific binary tree architecture .",
    "the separation of the events into signal and background is carried out starting from a root node using the parameter giving the best separation performance and according to a chosen splitting criterion .",
    "the decision tree continues to grow until its pre - defined maximum size has been reached or a minimum number of events are present in the node .",
    "a single decision tree is , however , unstable with respect to statistical fluctuations , so , once the first tree is grown , the same procedure is repeated in order to build an ensemble of decision trees ( called a _ forest _ ) by reweighting the same sample of events ( this step is called the bdt _ boosting _ ) .",
    "the _ boosting _ has the important feature of contributing greatly to the statistical stability of the algorithm and further improving the separation performance .      a key point during the _ training _",
    "phase is the need to avoid the so - called _ overtraining _ of the multivariate procedure : the _ overtraining _ phenomenon occurs when the separation is too powerful for the training sample , generally resulting in the overestimate of the real discrimination power . if _ overtraining _",
    "occurs , the multivariate method is then not capable of learning the real trend in the data , but simply memorizes the data by heart resulting in a poor generalization of the problem .",
    "when in presence of _ overtraining _ , which leads to a too - good fit to the training data , the overall performance of the method on an independent set of data is generally bad .",
    "so , in order to maximize the separation performance algorithm and also to avoid keeping statistically insignificant nodes during the decision process , a technique known as _ pruning _ is applied to the tree by cutting back the poorly populated nodes from the bottom part where the tree has reached its maximum size , up to the root node .      at a final stage of the bdt procedure",
    ", all the trees are combined together resulting in a single classifier output given by the average ( or weighted ) behaviour of the individual decision trees .",
    "the classifier resulting from the _ training _ phase is tested to evaluate the global performance of the multivariate method and this is done during the _ test _ phase . during the _ testing _ , an independent set of events is used as input for the splitting procedure so that the _ training _ classifier distribution can be compared with that resulting from the _",
    "test_.         separationtype & gini index + maxdepth & 20 + neventsmin & 30 + ncuts & 20 + max events for training & @xmath147 + trees / events & 100/10000 + max events for test & @xmath147 + vartransform & none + useyesnoleaf & true + boosttype & adaboost + useweightedtrees & true + prunemethod & costcomplexity + prunestrength & -1 + nodepuritylimit & 0.5 +    the comparison of the two classifiers is usually evaluated by a kolmogorov test on the shape of the two resulting distributions . as shown in fig .",
    "[ bdtresponse ] , the kolmogorov test value is an important check on the reliability of the signal - to - background classification behaviour .",
    "if the statistical test of compatibility fails , the reliability of the analysis results will not be guaranteed .",
    "the result of the tuning of the values defining the tree architecture in our specific parameter environment , is summarized in the table shown in fig .",
    "[ bdtree]b .",
    "the tests carried out by the authors showed that the discrimination performance was enhanced when allowing the tree to develop quite deeply and then cutting back the branches with an optimal _",
    "prunestrength_. for this reason , in this analysis the splitting can be carried out up to a maximum tree depth of 20 node layers ( _ maxdepth _ ) , however , the sequence of event separation splits is stopped once a minimum number of 30 events has been reached in a node ( _ neventsmin _ ) .",
    "having fixed all the other training parameters , the discrimination performance can vary substantially depending on the value of _ prunestrength_. tests have shown that the optimal choice was to set this value to @xmath148 , giving the possibility to use an algorithm which tries to detect the optimal strength of _ pruning _ for the given problem .",
    "every bin in this analysis is a separate entity having its own number of signal and background events , and a specific approach has been used for the calculation of the statistics available for each bin and for the choice of the number of trees composing the different forests . given a total number of background and signal events ( @xmath149 , @xmath150 ) available for a specific bin , the number of events to be used during the _ training _ phase @xmath151 is calculated in the following way : @xmath152 the resulting number of events for the different bins can vary considerably due to threshold effects as a function of the zenith angle and due to the available simulations and real observations . in the 112 bins , @xmath151 can vary from @xmath153 to @xmath154 . finally , the number of events during the _ test _ phase is calculated by the remaining set of events after @xmath151 subtraction by : @xmath155    during the development of this analysis method , it has been observed that an instability in performance occurs when the number of requested trees in the forest is high and the number of events present in the sample is low .",
    "for this reason , the number of trees composing the forest has been adjusted as a function of the available @xmath151 statistics present in each bin as : @xmath156 leading to forests composed of 10 to 200 decision trees .      the final step of the multivariate procedure is the application of the cuts during the data analysis using the bdt classifier adapted for the mean zenith angle of each run . for each event in the run ,",
    "the values of the discriminant parameters are evaluated , and , according to the number of photons in the shower as fitted by the 3d - model and the telescope multiplicity of the event , the weights and the cut value of the corresponding training bin can be identified straightforwardly . for events",
    "whose parameters correspond to a bin for which not many simulated events were available for the training / test phases ( which is the case for instance for the events whose energy is well below the threshold for a given zenith angle ) , no discrimination is possible and the event is classified as being background .",
    "the response of the instrument to @xmath0ray  point sources , or @xmath0ray  point - spread function ( psf ) , is usually characterised by the @xmath157 containment radius .",
    "it is important that this be small in order to allow the background to be better rejected .",
    "the @xmath157 containment radii ( see fig .  [",
    "allpsfs]a ) remain almost constant up to zenith angles of @xmath68 , so for the evaluation of the final cuts for point - like sources the mean values in the range @xmath60@xmath158 for the analysis configuration under consideration are taken , and , given that the systematic error of the pointing accuracy is @xmath159 , slightly larger values are applied as cuts for the final analysis : a good compromise is found with @xmath160 at @xmath161 , @xmath162 at @xmath163 ( and @xmath88 ) and finally @xmath164 at @xmath165 the @xmath91 configuration has been conceived for source morphology studies where a very good psf is requested . as shown in fig .",
    "[ allpsfs]a , thanks to the charge threshold and the chosen @xmath0ray  efficiencies , the @xmath157 containment radius for this latter configuration reaches @xmath166 .",
    "the effective detection areas in the case of a point - like source for the analysis configurations , evaluated after this additional angular cut , are shown in fig .",
    "[ allpsfs]b . as expected from the different minimal charge values for the hillas - parameter based reconstruction , the configurations have different energy thresholds and different integrated effective areas .",
    "when setting the charge threshold at @xmath161 , a mean gain in detection threshold of a factor of about @xmath167 with respect to the @xmath168 charge threshold is seen , as can be deduced from effective areas in fig .",
    "[ allpsfs]b , which is extremely important for the study of sources with soft spectra . on the other hand ,",
    "when a higher charge threshold is set , the effective area is smaller , with the compensation of a better psf .",
    "the authors would like to thank prof .",
    "w. hofmann , spokesperson of the  collaboration and prof .",
    "g. fontaine , chair of the collaboration board , for the permission to use the   data in this publication .",
    "yb would like to thank patrick fleury and the referees for reading the manuscript and for providing extremely useful suggestions .",
    "99 http://www.mpi-hd.mpg.de/hess w. hofmann , i. jung , a. konopelko et al .",
    ", astrop .",
    "12 ( 1999 ) 135143  collab . , f. aharonian et al .",
    "457 ( 2006 ) 899915 m. lemoine - goumard , b. degrange , m. tluczykont , astrop .",
    "25 ( 2006 ) 195211 c.m .",
    "hoffman , g. sinnis , p. fleury , m. punch , reviews of modern physics , 71 , issue 4 ( 1999 ) 897936 s. lebohec , b. degrange , m. punch et al .",
    "instrum .",
    "meth .  a 416 ( 1998 )",
    "425437 m. de naurois , l. rolland , astrop . phys .",
    "32 ( 2009 ) 231252 m. naumann - god , m. lemoine - goumard , b. degrange , astrop .",
    "31 , 6 ( 2009 ) 421 - 430 s. ohm , c. van eldik , k. egberts , astrop .",
    "phys .  31 ( 2009 )",
    "383391 a. fiasson , f. dubois , g. lamanna , et al .",
    ", astrop .",
    "phys .  34 ( 2010 ) , 2532 f. aharonian , j. buckley , t. kifune , g. sinnis , rep .",
    "phys .  71 ( 2008 )",
    "096901 a. lemire , phd thesis , universit paris vii ( 2006 ) http://tmva.sourceforge.net/ http://root.cern.ch/ m.p .",
    "ketzman , g.h .",
    "sembroski , nucl .",
    "instrum .",
    "meth .  a 347 , ( 1994 ) 629643 j. guy , phd thesis , universit paris vi ( 2003 ) j. guy , p. vincent , `` comparison of hadronic atmospheric shower generators '' , internal  collab .",
    "note 00/18 ( 2000 ) corsika web page and references therein : + http://www-ik.fzk.de/corsika/physics_description/corsika_phys.html y. becherini et al .",
    ", `` a new analysis strategy for imaging atmospheric cherenkov telescopes '' , proceedings of the @xmath169 icrc , d ( 2009 ) f. piron , a. djannati - ata , m. punch et al .",
    ", astron .  astrophys",
    ".  374 ( 2001 ) 895906  collab . , f. aharonian et al .",
    ", astrophys .",
    "journal 636 ( 2006 ) 777797  collab .",
    ", f. aharonian et al . , astron .",
    ".  477 ( 2008 ) 481489  collab . , f. aharonian et al .",
    ", astron .",
    "astrophys .  473 ( 2007 )",
    "l25l28  collab . ,",
    "h. abramowski et al . , astron .",
    "astrophys .  516 ( 2010 ) a56  collab . , f. aharonian et al .",
    ", astrophys .",
    "journal lett .  695 ( 2009 ) l40l44  collab . , f. aharonian et al",
    ", astron .",
    "astrophys .  432 ( 2005 ) l25l29 t. li , y. ma , y. , astrophys .",
    "journal , 272 ( 1983 ) 317 y. becherini for the  collab .",
    ", `` new agns discovered at vhe by h.e.s.s . '' , 25th texas symposium on relativistic astrophysics"
  ],
  "abstract_text": [
    "<S> a new background rejection strategy for @xmath0ray  astrophysics with stereoscopic imaging atmospheric cherenkov telescopes ( iact ) , based on monte carlo ( mc ) simulations and real background data from the  [ high energy stereoscopic system , see @xcite . ] </S>",
    "<S> experiment , is described . </S>",
    "<S> the analysis is based on a multivariate combination of both previously - known and newly - derived discriminant variables using the physical shower properties , as well as its multiple images , for a total of eight variables . </S>",
    "<S> two of these new variables are defined thanks to a new energy evaluation procedure , which is also presented here . </S>",
    "<S> the method allows an enhanced sensitivity with the current generation of ground - based cherenkov telescopes to be achieved , and at the same time its main features of rapidity and flexibility allow an easy generalization to any type of iact . </S>",
    "<S> the robustness against night sky background ( nsb ) variations of this approach is tested with mc simulated events . </S>",
    "<S> the overall consistency of the analysis chain has been checked by comparison of the real @xmath0ray  signal obtained from  observations with mc simulations and through reconstruction of known source spectra . </S>",
    "<S> finally , the performance has been evaluated by application to faint  sources . </S>",
    "<S> the gain in sensitivity as compared to the best standard _ hillas _ </S>",
    "<S> analysis ranges approximately from @xmath1 to @xmath2 depending on the source characteristics , which corresponds to an economy in observation time of a factor @xmath3 to @xmath4 .    </S>",
    "<S> @xmath0/hadron discrimination ; weak @xmath0ray  sources ; imaging atmospheric cherenkov telescopes ; multivariate analysis ; boosted decision trees . </S>"
  ]
}