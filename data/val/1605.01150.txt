{
  "article_text": [
    "markov state models ( msms ) have become an integral part of the toolbox used to analyze the output of molecular dynamics ( md ) simulations of complex systems such as proteins and other large biomolecules  @xcite .",
    "they were developed in response to the need to process ever longer md timeseries data , made either of one long trajectory or very many shorter ones , generated e.g by special - purpose high - performance computers  @xcite , high - performance gpus  @xcite , or massively parallel simulations  @xcite .",
    "the basic idea of msms is to represent the original dynamics as memoryless jumps between predefined states in the configuration space of the molecular system . under this markovian assumption",
    ", md timeseries data can then be processed via inference techniques such as maximum likelihood estimation to calculate the rate matrix between these states .",
    "this matrix defines a markov jump process ( mjp ) , which in turns permits the calculation of interesting kinetic quantities of the system on time scales that may be larger than those reached in the md simulations : indeed msms also permit to recombine short simulations run in parallel to extract long time information about the system .    a recurrent issue in the context of msms is how to pick the states on which to map the original dynamics  see refs .",
    "@xcite for some recent works in this direction .",
    "indeed this mapping amounts to a drastic coarse - graining of the dynamics , and the jumps between poorly chosen coarse states will not be markovian in general .",
    "this invalidates the basic assumption of msms and affect their reliability and accuracy .",
    "fortunately , md systems typically display metastability and this offers a way around this difficulty . in metastable systems",
    "there exists regions that play the role of hubs : after visiting one such hub , the system returns often to it before making a transition to another .",
    "this guarantees that transitions between these hubs is indeed approximately markovian , and metastability has therefore been invoked as they key property to justify msms and assess their accuracy ( see e.g.  [ ] and [ ] for modern perspectives on the topic that summarizes this viewpoint ) . what remains mostly open",
    ", however , is how to identify these hubs in practice .    in the present paper we aim at addressing this question in the context of milestoning - based msms @xcite",
    "that combine the core set method originally introduced in ref .",
    "[ ] with the milestoning of the trajectories developed in refs .",
    "unlike standard msms that are based on a full partition of the configuration space of the system into blocks that are used as states  @xcite , milestoning - based msms uses non - adjacent core sets as states ( the milestones ) , and assign the md timeseries to the index of the last such milestone it visited .",
    "this maps the original dynamics onto a symbolic dynamics on these indices that is then used as input to build the msm by maximum likelihood estimation of its transition matrix . in metastable systems ,",
    "the proper milestones to use should be the hubs mentioned before .",
    "here we propose to identify these hubs among a set of trial milestones via optimization of a metastability index that measures how good the hubs are .",
    "the method can be justified within the framework of the potential theoretic approach to metastability developed by bovier and collaborators  @xcite .",
    "it has the advantage that it can be used even in situations where the dynamics on the trial milestones is non - markovian . in this sense",
    ", it alleviates a difficulty with the standard approach used to build msms via clustering of trial states  @xcite : this clustering is typically done using spectral analysis of the rate matrix of the chain built on these trial states , which may lead to artifacts since the dynamics on these trial states is non - markovian in general .",
    "the method we propose avoids this difficulty altogether .",
    "in addition it avoids the need to introduce a time - lag to process the data , which may be difficult to adjust .",
    "as we will see , our method also offers a way to partition the state space of the system by identifying regions made of configurations most likely to reach a given hub , and to identify the members of the transition state ensemble as those trial milestones that have a non - negligible probability to reach more than one target milestone next .",
    "the remainder of this paper is organized as follows . in sec .",
    "[ sec : algo ] we start by presenting the algorithmic aspects of the method we propose , including how to define the trial milestones ( sec .",
    "[ sec : trialvstarget ] ) and the metastability index ( sec .",
    "[ sec : metaindex ] ) , how to identify the target milestones that optimize this metastability index ( sec .",
    "[ sub : how - to - find ] ) , and how to build the msm on these target milestones ( sec .",
    "[ sec : msm ] ) .",
    "we also introduce a variety of diagnostic tests that can be used _ a  posteriori _ to analyze the output of the msm and use the trial milestones to get additional information about the system s dynamics ( sec .",
    "[ sec : diagno ] ) . a theoretical justification of this algorithm",
    "is then given in sec .",
    "[ sec : theo ] , first in the context of markov jump processes , which is relevant e.g. if one assumes that the dynamics on the trial milestones is itself markovian ( sec .",
    "[ sec : ctmc ] ) , then in the context of systems whose configurational space is continuous , like those encountered in md simulations , where we can not expect the dynamics on the trial milestones to be markovian ( sec .  [",
    "sec : csp ] ) .",
    "we also test the method on a simple one - dimensional example with a multiscale energy landscape ( sec .",
    "[ sec : illustrativeex ] ) . in sec .",
    "[ sec : glyalagly ] we then apply the method to analyze the dynamics of a gly - ala - gly peptide , and in sec .",
    "[ sec : beta3s ] we use it to analyze the folding pathways of the beta3s mini - protein .",
    "concluding remarks are given in sec .",
    "[ sec : conclu ] .",
    "some technical derivations are relegated to an appendix .",
    "in this section , we outline the algorithm we propose to identify the milestones ( or core sets ) over which to build an msm . in a nutshell , this is done by picking among a set of trial milestones a subset of target milestones which minimizes a metastability index  this index is defined so that small values are indicative of markovianity .",
    "the target milestones are taken as states in the msm , while the trial milestones are used to complement the predictions of this msm and e.g. partition the system s configurational space or identify transition state regions in it .     milestoning procedure .",
    "( a ) : piece of a long trajectory @xmath0 crossing a set of three circular milestones , @xmath1 , @xmath2 , and @xmath3 .",
    "( b ) : the trajectory shown in ( a ) is mapped onto the index of the last milestone it hit , thereby defining the piecewise constant function @xmath4 . ]",
    "denote by @xmath5 a trajectory containing the instantaneous position of the @xmath6 atoms in a molecular system .",
    "we assume that we have generated one or several such trajectories and our goal is to build a msm that captures their main features . to this end",
    ", we introduce a set of  @xmath7 trial milestones , which we will denote by @xmath8 , @xmath9 ,  , @xmath10 and label them by their index , i.e.  @xmath11 identifies  @xmath12 .",
    "these milestones are disjoint sets in the system s configuration space that can be defined e.g. by requiring that some of the dihedral angles of the molecules take values between specific bounds , etc .  how to actually choose the trial milestones  @xmath12 will be illustrated below on specific examples . in the spirit of milestoning",
    ", we then map each trajectory @xmath0 onto the index of the last trial milestone @xmath12 it hit , see fig .",
    "[ fig : milestoning ] for an illustration . this way we obtain a piecewise constant index function @xmath13",
    "whose value at time @xmath14 is the index of the last milestone hit by  @xmath0 .",
    "note in this procedure we discount recrossings : we only update the index function when a new milestone is hit .",
    "we stress that at this stage we do not assume that the dynamics of the index function  @xmath13 on the trial milestones is markov  in general it will not be .",
    "what we would like to do next is extract from the set of @xmath7 trial milestones a subset of @xmath15 target milestones such that if we map the trajectory  @xmath0 onto this subset of target milestones , the corresponding index function will be approximately markovian  these target milestones are shown in red in the cartoon shown in fig .  [",
    "fig : metastabilityscheme ] . in the sequel",
    ", we will denote by @xmath16 the set of indices identifying the target milestones , i.e. these are @xmath17 .",
    "we will also refer to trial milestones that are not target ones as non - target milestones .",
    "how should the target milestones be chosen ?",
    "intuitively , they should be such that they are hubs among the trial milestones towards which the trajectory is attracted but between which it seldom makes transitions , as illustrated in fig .  [",
    "fig : metastabilityscheme ] . to make this idea concrete ,",
    "let us first introduce the probability @xmath18 that , if the trajectory hits milestone @xmath12 , then subsequently it will hit @xmath19 with @xmath20 before hitting @xmath12 again ( discounting recrossings : recall that only hits of different milestones are counted  in other words , to hit @xmath12 again , the trajectory must have hit at least one other milestone in between ) . to estimate @xmath18 , out of each of the piecewise constant index function @xmath13",
    ", we first extract the sequence @xmath21 of successive values that this function takes  for example , for the timeseries illustrated in fig .",
    "[ fig : milestoning ] this sequence starts with @xmath22 , @xmath23 , @xmath24 , @xmath25 , etc .",
    "we then cut this sequence into the @xmath26 pieces which start from @xmath11 and contain all the indices visited after @xmath11 before @xmath11 appears again .",
    "for example , if the sequence is made of 3 indices , @xmath27 , and reads @xmath28 we cut it into three pieces ( @xmath29 ) @xmath30 finally we count the number of pieces @xmath31 in which @xmath32 appears at least once ( in the example above @xmath33 since @xmath32 appears in the last two pieces but not in the first ) , we add up these numbers coming from every piece of @xmath13 at our disposal , and we set @xmath34 as estimator for @xmath35 .",
    "note that the quality of this estimator depends on the lengths of the pieces of timeseries @xmath0 that we have at our disposal , and how to assess the statistical accuracy of   is nontrivial . as usual , we can not expect the estimator to be accurate if these pieces are too short to observe all the relevant events in the dynamics of the system : in the context of   this requires that these pieces be long enough that trajectories starting at a non - target milestone have time to reach a target one .",
    "indeed , as we will see below , this condition is sufficient to guarantee that we will correctly identify target from non - target milestones among the trial ones .",
    "we will now use the matrix with entries @xmath18 to quantify how good a set of target milestones will be to build an msm . specifically , given a candidate @xmath36 identifying the target milestones , we estimate the quality of these milestones via their metastability index defined as @xmath37 the smaller @xmath38 , the better the set of target milestones identified by @xmath39 .",
    "this claim will be justified in sec .",
    "[ sec : theo ] by connecting @xmath40 to a quantity originally introduced by bovier , but let us briefly explain here why it is true .",
    "the numerator in  , @xmath41 identifies the target milestone @xmath12 for which the probability is the highest that , after hitting @xmath12 , the trajectory will hit some other target milestone @xmath19 before hitting @xmath12 again . in this sense , @xmath12 is the worst target milestone in the set since we would like that transitions between these target milestones be unlikely , and the smaller the better .",
    "correspondingly , the denominator in  , @xmath42 identifies the non - target milestone @xmath12 which is such that the trajectory has the lowest probability to hit a target milestone @xmath19 before hitting @xmath12 again . in this sense",
    ", @xmath12 is the worst non - target milestone since we would like that transitions from non - target to target milestones be likely , and the larger the better . the metastability index @xmath43 in   accounts for both the desiderata that be small and   be large , and in this sense it measures the quality of the set of target milestones identified by @xmath44 .",
    "schematic representation of a subset of target milestones ( shown in red ) immersed in a set of trial milestones .",
    "a good subset of target milestone is such that transitions from non - target to target milestones are likely , while transitions between target milestones are not .",
    "this can be quantified via the metastability index defined in  . ]      since good sets of target milestones are those whose metastability index @xmath38 is small , we can systematically search for such good sets by minimizing @xmath38 . in principle , this can be done by considering increasing values @xmath45 , @xmath46 , etc . of the cardinal of @xmath47 , and for each compute @xmath38 for every choice of @xmath36 so as to identify the one with minimum @xmath38 . any choice @xmath47",
    "for which @xmath38 is small leads to a good set of target milestones .",
    "note however that @xmath38 can be small for different values of @xmath48 , and so several of them should be considered  this effect will be illustrated in the examples below .",
    "of course , if the number @xmath7 of trial milestones is large , this direct search strategy will quickly become inefficient as @xmath48 increases since the number of sets @xmath47 to consider for each @xmath48 is @xmath49 to avoid this difficulty , we must adopt more efficient optimization strategies , for example using monte carlo schemes .",
    "we have used such schemes in the examples below .",
    "however , we found that the following searching strategy was typically the most efficient .",
    "given @xmath18 , we can identify the index @xmath50 of the milestone that the trajectory is most likely to hit after hitting  @xmath11 as the one that maximizes @xmath18 over all @xmath20 , i.e. @xmath51 the function @xmath50 can be used to define ` trajectories ' in index space : given @xmath11 , we update it to @xmath50 , then to @xmath52 , etc .",
    "correspondingly , given a set @xmath53 we can update this set by updating every entry in it , and only keeping the ones that remain different ( for example we could have @xmath54 in which case only one of these entries is kept in the update of @xmath47 ) . because this updating identifies set of indices of milestones that are likely to be hit , these sets should have small metastability index @xmath38 , and this is indeed what we observed in practice .",
    "specifically , we took random sets of indices @xmath53 with random values of @xmath48 and updated them as described above while monitoring the metastability index @xmath38 of these updated sets .",
    "we observed that this metastability index typically diminishes before starting to oscillates in a periodic fashion ( this is because the update has no fixed point , @xmath55 by construction ) . when this happened we stopped the update , kept the updated set @xmath53 with smallest @xmath38 , and restarted the procedure with a different random set of indices @xmath53 .",
    "after a few such iterations , we typically got a few different sets @xmath53 ( with different @xmath48 ) with small @xmath38 .",
    "once we have identified a good set of target milestones specified by the index set @xmath53 , we can build an msm using these milestones as states . how to do so was explained in refs .",
    "@xcite , so let us be brief here and refer the reader to the original papers for details .",
    "for the sake of clarity , in the sequel it will be convenient to distinguish between target and non - target milestones : we will do so by using greek letters @xmath56 , @xmath57 , ... to refer to the indices in the index set @xmath47 , and @xmath58 , @xmath59 , ... to refer to the target milestones @xmath60 , @xmath61 , ...    similarly to what was done before , we can map the trajectory @xmath0 onto the index of the last target milestone it hit .",
    "this defines a piecewise constant function @xmath62 taking values in @xmath47 . because we are now using target milestones instead of trial ones , unlike @xmath13 , @xmath62 should be approximately markov .",
    "this means that the evolution of this function can be completely specified by a rate matrix with entries @xmath63 : to leading order in @xmath64 , @xmath65 gives the probability that @xmath62 jumps from the value @xmath56 to the value @xmath66 in the interval @xmath67 ( i.e. that @xmath0 hits the target milestone @xmath59 in that time interval if the last target milestone it hit before time @xmath14 was @xmath58 ) .",
    "in particular , if @xmath68 denotes the probability distribution that @xmath62 takes the value @xmath56 at time  @xmath14 , then @xmath68 satisfies the master equation @xmath69 similarly , we can write down equations for the distribution of first passage time from target milestone @xmath58 to target milestone @xmath59 , its mean , etc . in terms of @xmath63",
    " see e.g. refs .",
    "@xcite .",
    "the rate matrix entries @xmath63 can be estimated from the timeseries @xmath0 by the method of maximum likelihood .",
    "if we denote by @xmath70 the total time the last target milestone hit by @xmath0 is @xmath58 and by @xmath71 the number of times the target milestone @xmath59 was hit directly after @xmath58 along this timeseries , the maximum likelihood estimator for @xmath63 is @xmath72 this estimator is unbiased in the sense that , if @xmath62 is indeed markov with rate matrix entries @xmath63 and the length of the timeseries tends to infinity , then @xmath73 in this limit . if the length of the timeseries is finite , the statistical errors on @xmath74 can be estimated by bayesian sampling , see ref .  [ ] for detail .",
    "another source of errors are those due to residual non - markovian effects in @xmath62 .",
    "the smaller @xmath38 , the smaller these non - markovian effects are , as discussed in sec .",
    "[ sec : theo ] .",
    "in practice they can also be estimated via markovianity tests , as illustrated on examples in secs .",
    "[ sec : glyalagly ] and  [ sec : beta3s ] .",
    "notice also that if @xmath0 satisfies detailed balance , then we should have that @xmath75 as the length of the timeseries goes to infinity .",
    "when this length is finite , however , @xmath76 in general , and to enforce detailed balance of the msm , it is better to use the following symmetrized estimator for the rate matrix entries : @xmath77 with this choice , the equilibrium distribution of the msm , i.e. the distribution @xmath78 towards which the solution to   with @xmath63 replaced by its estimator @xmath74 converges as @xmath79 , is @xmath80 where @xmath81 is the total length of the timeseries used to estimate @xmath74 .",
    "the distribution @xmath82 gives the proportion of time during which @xmath58 was the last milestone hit by @xmath0 and as the length of the timeseries increases , @xmath83 , @xmath78 converges to the true equilibrium distribution of milestone @xmath58  explicit expressions for this distribution in the context of a system whose dynamics is governed by a markov jump process or a langevin equation will be given in secs .",
    "[ sec : ctmc ] and  [ sec : csp ] , respectively .",
    "we can use @xmath82 to estimate the free energy of milestone  @xmath58 @xmath84 where @xmath57 denotes the reciprocal of the thermodynamic temperature of the system .      even though the trial milestones merely serve as intermediary to construct the actual msm ,",
    "these milestones can still be used to analyze the md data and partition the state space in ways that highlights important features of its dynamics .",
    "first we can organize the trial milestones onto a network : if @xmath31 denotes the number of times milestone @xmath19 was hit directly after @xmath12 , we put an edge between node @xmath11 and node @xmath32 with weight @xmath85 where @xmath86 is the total length of the timeseries for @xmath0 .",
    "note that , consistent with the detailed balance condition , we have symmetrized the weight @xmath87 , i.e. the network is undirected , @xmath88 .    next we can compute the free energy of the trial milestones .",
    "if @xmath89 denotes the total time that the last milestone hit was @xmath12 ( so that @xmath90 , the total length of the timeseries ) , we can define the probability distribution @xmath91 the distribution @xmath92 gives the proportion of time during which @xmath12 was the last milestone hit by @xmath0 ( see secs .  [",
    "sec : ctmc ] and  [ sec : csp ] for its expression in the limit as @xmath83 when the system s dynamics is governed by a markov jump process or a langevin equation , respectively ) , and we can estimate the free energy of the trial milestone  @xmath12 via : @xmath93 the free energy @xmath94 defines a landscape on the network of trial milestones . one may expect that the nodes associated with the target milestones will be close to the local minima of @xmath94 ; however , we stress that this need not be the case , since the dynamics on the full network ( rather than the one restricted to the target milestones alone ) can be quite complicated ( in particular , not markovian ) .",
    "to partition the state space , it is better to introduce the committor functions of the trial milestone  @xmath12 with respect to the target milestone @xmath58 , @xmath95 . by definition , @xmath95 gives probability that , after hitting @xmath12 , the trajectory will hit the target milestone @xmath58 before hitting any other target milestones , and it can be estimated from the timeseries as @xmath96 where @xmath97 ( so that @xmath98 ) .",
    "the committor functions can be used to do a ( soft ) partitioning of the network into basins of nodes that are more likely to be attracted next to one target milestone rather than any other : for example , those nodes  @xmath11 such that @xmath95 is close to 1 are associated with milestones @xmath12 out of which the trajectory is very likely to hit @xmath58 next .",
    "a hard partitioning can also be performed by assigning @xmath11 to @xmath99 .",
    "the committor probability @xmath100 whose estimator is given in   can also be used to identify the transition state ensemble ( tse ) , i.e. the trial milestones that lie in between the states in the target set @xmath47 . if the target set contains only two states , @xmath101 , it follows that all trial milestones @xmath11 satisfy @xmath102 and the tse is such that @xmath103 . for target sets with more than 2 states",
    "the @xmath104 criterium may become less effective as the tse as it can in general connect multiple states . to get around this difficulty",
    ", we can introduce a tse index based on the entropy of the committor probability @xmath100 .",
    "recalling that @xmath105 for any milestone @xmath106 ( i.e. @xmath100 is a probability distribution in @xmath56 ) , we propose to use the normalized entropy ( sometimes also referred to as efficiency ) of @xmath100 as tse index : @xmath107 were the sum is carried out over the non - zero entries of @xmath95 and @xmath108 is the number of such entries ( more generally , we could restrict the sum to the entries of @xmath95 that are above some small threshold @xmath109 ) .",
    "the tse index @xmath110 is 1 if the non zero values of @xmath100 are all identical , and it is 0 if only one value of @xmath100 is different than zero .",
    "therefore , the closer @xmath110 is to 1 , the higher the chance that state @xmath11 be a member of the transition state ensemble .",
    "once the states in the tse have been identified , we can go back to their committor values to determine between which target states they lay .    to characterize the physical origin of the metastability of the target milestones",
    ", it is also useful to decompose their free energy into an energetic component and an entropic one .",
    "this can be done as follows .",
    "given the system s potential energy @xmath111 , a mean energy can be assigned to each of the target milestones via @xmath112 where @xmath70 the total time the last target milestone hit by @xmath0 is @xmath58 and @xmath113 so that @xmath114 .",
    "we can then estimate the entropy @xmath115 of the target milestone via @xmath116 where @xmath117 is the free energy estimated in   and @xmath118 is boltzmann constant .",
    "target milestones with comparable @xmath119 have similar statistical weights , and the lower @xmath119 the more thermodynamically stable they are ( meaning the timeseries @xmath0 tends to return to them more often , comparatively ) : by comparing their values of @xmath120 and @xmath115 we can then determine whether their stability is of energetic or entropic origin , respectively .",
    "the usefulness of the diagnostic tools introduced above will be illustrated in the examples treated in secs .",
    "[ sec : glyalagly ] and  [ sec : beta3s ] .",
    "let us now justify the use of the metastability index defined in   to identify target milestones over which the dynamics can be mapped in an approximately markovian way .",
    "we begin by discussing the simpler case when the dynamics of @xmath13 on the trial milestones is itself markovian  as we mentioned in sec .",
    "[ sec : algo ] , we do not make this assumption in general , but it is a convenient starting point for our theoretical explanation .",
    "the general situation when @xmath13 is not markovian will be discussed in sec .",
    "[ sec : csp ] .",
    "if @xmath13 is markov , its dynamics is specified by a rate matrix @xmath121 whose entries we will denote by @xmath122 to distinguish them from the rate matrix entries @xmath63 on the target milestones . assuming detailed balance , @xmath122 satisfies @xmath123 where @xmath7 is the number of trial milestones and @xmath124 is their equilibrium probability density  the estimator for @xmath124 was given in  .",
    "together with the assumption of ergodicity ( i.e. that time averages along @xmath13 converge towards ensemble averages over @xmath124 ) , implies that all the @xmath7 eigenvalues of @xmath122 are real , with one being 0 and all the other negative .",
    "we will denote these eigenvalues by @xmath125 , and order them so that latexmath:[$0=\\lambda_0 \\le |\\lambda_1| \\le \\cdots \\le     the eigenvalues of @xmath121 permit to give a precise definition of what it means for the chain to display metastability . in turns",
    "this indicates how to coarse - grain this chain , which in our context means how to chose good target milestones .",
    "specifically , a chain will be metastable if its eigenvalues can be separated into two well separated groups , i.e. if there exists an @xmath127 such that @xmath128 if such a separation exists , it means that the @xmath48 eigenvalues with index smaller than @xmath48 describe relaxation processes in the chain that occur on timescales that are much slower than those described by the @xmath129 eigenvalues with index larger or equal to @xmath48 . in turn",
    ", this implies that these slow processes can be approximately described by a smaller chain with only @xmath48 states .",
    "the practical questions then become : ( i ) how to assess whether is satisfied for some @xmath48 without having to compute the full spectrum of @xmath121 ( since this computation is hard in general ) , and ( ii ) how to reduce the dynamics to a chain with only @xmath48 states ?    in ref .",
    "[ ] , bovier and collaborators addressed these two questions , and the answers they provided are the basis for the algorithm we presented in sec .",
    "[ sec : algo ] .",
    "first they proved that holds if and only if an indicator closely related to the metastability index @xmath38 in   is small for some @xmath130 .",
    "if that is the case , the ratio in   is in fact proportional to @xmath131 .",
    "second , they showed how to reduce the chain onto a smaller chain involving only the nodes identified by @xmath47 ( i.e. in our context , involving only the target milestones ) in such a way that the @xmath48 eigenvalues of this reduced chain be close to the @xmath48 first eigenvalues of the original chain ( where closeness can again be measured in terms of @xmath38 ) .",
    "it should be stressed that can be satisfied with more than one value of @xmath48 .",
    "this simply means that there can be more than one low - lying group of eigenvalues . in turns",
    "this implies that there can be more than one choice of good target milestones .    for completeness ,",
    "let us end this section by giving explicit expressions for some of the quantities that were defined in sec .",
    "[ sec : algo ] in the context of a system whose dynamics is governed by an mjp with generator @xmath121 .",
    "first , the probability @xmath132 whose estimator was given in can be expressed as : @xmath133 here @xmath134",
    "( not to be confused with the entries of the transfer operator @xmath135 , @xmath136 ) are the entries of the transition matrix defined as @xmath137 which gives the probability that the state first visited by the chain after @xmath11 is @xmath138 ; and @xmath139 is the committor probability solution of @xmath140 the probabilities @xmath132 can also be conveniently calculated in terms of mean recurrence times ( mrt ) and mean first passage times ( mfpt ) via the formula @xmath141 where @xmath142 is the mrt of the state @xmath11 and @xmath143 is the mfpt to go from state @xmath11 to state @xmath32 . a proof of relation can be found in the appendix of this paper . in addition , the committor probability @xmath100 whose estimator was given in solves an equation similar to  , with different boundary conditions : @xmath144 we can relate the distributions @xmath145 and @xmath124 , whose estimator were given in   and   respectively , as @xmath146 which also means that the corresponding free energies whose estimators were given in   and   respectively , are related as @xmath147 finally , the rate matrix entries on the target milestone , @xmath63 , whose estimator was given in   can be expressed as @xmath148 these formulas can be justified within the framework of transition path theory ( tpt ) @xcite and are useful for analysis .",
    "however we stress that we do not need to solve any of the equations above to apply the procedure outlined in sec .",
    "[ sec : algo ] .",
    "indeed , this procedure can be used with the estimators given in that section , which only require the timeseries  @xmath0 as input .      in refs .",
    "[ , ] , the results of ref .",
    "[ ] were generalized to situations were the markovian dynamics takes place on a continuous state - space , like @xmath0 does ( or more generally the pair @xmath149 if the momentum @xmath150 needs to be added to make the description markovian , as in   below ) .",
    "the main technical difficulty in that case is that the metastability index @xmath38 defined in   measures the probability to go to a state after leaving another one , rather than returning to that state .",
    "the problem is that , in the continuous state - space setting , these states can not be identified with points in the state space , since the probability to hit a point is zero as soon as the space dimension is higher than 1 .    to get around this difficulty",
    ", it was shown in refs .",
    "[ , ] that one can redefine states by fattening any specific point into a little domain that contains it , so that a metastability index @xmath38 can again be defined as in   and allows to identify low - lying groups of eigenvalues when they exist .",
    "this fattening procedure is similar to that of defining trial milestones : they are indeed regions containing specific points in the original state - space of the system , which provides a theoretical justification to the algorithm proposed in sec .",
    "[ sec : theo ] .",
    "it is important to note , however , that refs .",
    "[ , ] only gave prescriptions on how to perform this fattening ( i.e. how to define trial milestones ) in very specific ( and simple ) cases , like that of an system governed by overdamped dynamics in the limit of very small temperature .",
    "we are obviously interested in more complicated situations here , in which case it is no _ a  priori _ obvious how to define the trial milestones .",
    "a few procedures to do so will be discussed in secs .",
    "[ sec : glyalagly ] and  [ sec : beta3s ] : these procedures are by no means the only ones one could envision , but they proved sufficient in these examples and should be transportable to other ones .",
    "note that this also means that one should verify _ a  posteriori _ that the dynamics on the target milestones identified by the procedure is indeed approximately markovian .",
    "as usual , this can be done by checking that the first passage time between target milestones adjacent on the network of the msm are exponentially distributed . in the examples we treated below , this turned out to be the case , indicating that the msms we constructed were indeed accurate .    assuming that we have picked trial milestones and identified target ones , for completeness let us give explicit formulas for some of the quantities introduced in sec .",
    "[ sec : algo ] in the context of a system whose dynamics is governed by the langevin equation @xmath151 where @xmath111 is the potential energy of the system , @xmath152 the mass matrix , @xmath153 the friction tensor , and @xmath154 is a white - noise satisfying @xmath155 , @xmath156  other choices of thermostats are possible , and the formula below can be adapted to those straightforwardly .",
    "system   is ergodic with respect to boltzmann - gibbs probability density function @xmath157 where @xmath158 is the hamiltonian and @xmath159 .",
    "the expression for the probability @xmath132 whose estimator was given in   is quite complicated if , unlike what we did in sec .",
    "[ sec : ctmc ] , we do not assume that the dynamics on the trial milestones is markovian .",
    "we can , however , give explicit expression for the rate matrix entries @xmath63 , the distribution @xmath145 , and the free energy @xmath160 whose estimators were given in , , and  , respectively .",
    "these expressions were derived in ref .",
    "@xcite and they involve the committor function   @xmath161 solution of @xmath162 with the boundary condition @xmath163 if @xmath164 and @xmath165 and @xmath166 if @xmath167 and @xmath168 , where @xmath169 denotes the unit normal vector pointing outward @xmath170 at point  @xmath171 and similarly for @xmath172 . the committor function @xmath173 gives the probability that the trajectory initiated at @xmath174 reaches @xmath175 before any @xmath176 with @xmath66 ; using the invariance of the dynamics under @xmath177 and @xmath178 , @xmath179 also gives the probability that the trajectory arriving at @xmath174 was last in @xmath175 rather than in any @xmath176 with @xmath66 .",
    "we then have @xmath180 so that @xmath181 .",
    "also @xmath182 where @xmath183 denotes the surface element on @xmath184 .",
    "these formulas can again be derived from tpt  @xcite .",
    "similar expressions can be given for @xmath124 and @xmath185 , whose estimators were given in   and   by modifying the boundary conditions in  .",
    "( a ) the one - dimensional multiple well energy landscape example .",
    "the red dots identify and label the milestones contained in the sets of target milestones .",
    "their corresponding index sets are @xmath186 , @xmath187 , @xmath188 and @xmath189 .",
    "( b ) overdamped langevin trajectories solution of   at three temperatures @xmath190 , 0.75 and 1.0 ( black curves ) .",
    "the index function @xmath62 associated with the target sets @xmath191 , @xmath192 and @xmath193 are superimposed on the trajectories @xmath194 ( red curves ) . ]      it is useful to illustrate the results of this section on a simple example .",
    "specifically , we consider the motion of a particle by overdamped langevin dynamics on the one - dimensional potential energy depicted in fig .",
    "[ fig:1dland](a ) .",
    "the governing equation is @xmath195 where @xmath196 denotes the derivative of potential energy @xmath197",
    ", @xmath153 is the friction coefficient ( which we will set to @xmath198 ) and @xmath199 a white - noise such that @xmath200 and @xmath201 . typical trajectories solution of   at three different temperatures are shown in fig .",
    "[ fig:1dland](b ) .    as can been seen in fig .",
    "[ fig:1dland](a ) , the potential has a hierarchical structure with a total of 27 local minima separated by barriers of various heights .",
    "correspondingly , the generator of the process governed by  , namely the operator @xmath202 has a spectrum with several groups of low - lying eigenvalues .",
    "this spectrum was obtained by spatial - discretization of   on a grid of 200 points , and the ratio of successive eigenvalues are shown in fig .",
    "[ fig:1drhob](a ) at several different temperatures .",
    "small ratios identify low - lying groups of eigenvalues , and several of them can be seen : @xmath203 , @xmath204 , @xmath205 , and finally @xmath206 are all small at temperatures ranging from @xmath207 to @xmath208 .",
    "the eigenvalues involved in these groups describe processes arising on slow time scales that can be organized as follows : @xmath209 is associated with longest timescale of hopping over the largest barrier separating the left basin left centered around milestone 1 and right one centered around milestone 2 in fig .",
    "[ fig:1dland](a ) ; @xmath210 is associated with the next longest time hopping over the barrier separating the basin at the extreme left centered around milestone 1 and the one in the center centered around milestone 3 ; @xmath211 , ... , @xmath212 are associated with hoping over the barriers separating milestones @xmath213 , @xmath214 , @xmath215 , milestones @xmath216 , @xmath217 , @xmath218 and milestones @xmath219 , @xmath220 , @xmath221 ; and finally @xmath222 , ... ,",
    "@xmath223 are associated with hoping over the barriers separating milestones @xmath214 , @xmath224 , @xmath225 , milestones @xmath213 , @xmath226 , @xmath227 , etc . from the results in secs .",
    "[ sec : ctmc ] and  [ sec : csp ] , the existence of the low lying groups also suggests that the continuous - time dynamics can be approximated by markov chains ( i.e msms ) containing , respectively , 2 , 3 , 9 and 27 states .    ( a ) first 30 ratios of consecutive eigenvalues of the generator   in a range of temperatures from 0.5 to 1.0 .",
    "the small ratios are @xmath228 , @xmath229 , @xmath230 and @xmath206 .",
    "( b ) the values of the metastability index @xmath38 minimized over index sets @xmath47 of increasing cardinal @xmath48 : @xmath38 clearly correlates well with the eigenvalue ratios shown in panel ( a ) , and the associated index sets @xmath47 permit to identify the target milestones shown in fig .",
    "[ fig:1dland ] that capture the slow processes in the system . ]",
    "the eigenvalues of the msms made of the states in @xmath192 ( circles ) , @xmath193 ( diamonds ) , @xmath191 ( squares ) , and @xmath231 ( stars ) are plotted against the eigenvalues of the generator of the original process with the same indices .",
    "as can be seen , the msms capture the low - lying part of the spectrum accurately , with deviations observed only for the largest eigenvalues in the low - lying group , where metastability becomes weaker . ]    to confirm this prediction , we used the algorithm presented in sec .",
    "[ sec : algo ] to construct these msms .",
    "specifically , we used the 200 discretization points uniformly spaced between @xmath232 and @xmath233 as trial milestones and computed the matrix entries @xmath18 defined in   from a trajectory obtained by integrating  .",
    "we then minimized the metastability index @xmath38 over index sets @xmath47 containing from @xmath45 up to @xmath234 indices .",
    "the minimum values of @xmath38 for each value of @xmath48 are shown in fig .  [ fig:1drhob](b ) and , consistent with bovier s result , they correlate well with the values of the eigenvalue ratios @xmath235 shown in fig .",
    "[ fig:1drhob](a ) , thereby confirming that we can use the metastability index @xmath38 to identify low - lying groups of eigenvalues .",
    "in particular , @xmath38 could be made small when @xmath45 , 3 , 9 and 27 , and the corresponding index sets were @xmath186 , @xmath187 , @xmath236 , and @xmath237 .",
    "the associated target milestones are shown in fig .",
    "[ fig:1dland](a ) .",
    "they clearly identify the lowest point of the wells on the hierarchical potential landscape @xmath197 .",
    "the trajectory projected onto these target milestones when @xmath186 , @xmath187 , and @xmath236 are shown in red in fig .",
    "[ fig:1dland](b ) : these red pieces can be used to calculate the rate matrices @xmath63 of the different msms on @xmath192 , @xmath193 , @xmath191 , and @xmath231 via maximum likelihood maximization , as explained in sec .",
    "[ sec : msm ] .",
    "we can then calculate the spectrum of these rate matrices and compared them to the spectrum of the generator   of the original process .",
    "the result of these calculation is shown in fig .",
    "[ fig : crossval ] which shows that the eigenvalues of these different msms do indeed match the low - lying ones of the generator of the original process .",
    "note that the calculations above to identify target milestones were conducted at different temperatures , and showed that the target milestones were robust for temperature ranging from @xmath238 to @xmath208 , even though their corresponding metastability index @xmath38 slowly grew with temperature .",
    "this is consistent with the fact that the ratios @xmath235 also grow with temperature , as the system becomes slowly less metastable as it is heated up , with the groups associated with the lowest barriers disappearing first .",
    "note also that in these calculations , few transitions events between the target milestones were observed ( much less in particular that what is required to calculate the rate matrix entries @xmath63 accurately ) , and yet the procedure was able to identify these milestones correctly .",
    "( a ) trial milestones used to analyze the trajectory from the md simulation of the gag peptide at @xmath239 k. these trial milestones are disks centered around grid points in the @xmath240-space , and they are colored according to their free energy @xmath185 , whose estimator is given in  .",
    "the states composing the target milesones @xmath241 , @xmath242 , @xmath243 and @xmath244 are represented as white filled circles .",
    "( b ) a portion of a @xmath245 @xmath246s md simulation at @xmath239 k projected onto @xmath247 and @xmath248 ( black curve ) . in red",
    "we show the index function @xmath62 of the states in the target set @xmath249 . ]",
    "gag peptide : minimum values of the metastability index @xmath38 as a function of @xmath48 , along with the index sets @xmath47 associated with @xmath38 smaller than 1 .",
    "a monte carlo scheme was utilized to perform the minimization . ]",
    "in this section , we use the method outlined in sec .  [",
    "sec : algo ] to analyze a md trajectory of a solvated glycine - alanine - glycine peptide ( gag ) .",
    "the gag peptide was modeled using the charmm 27 force field and simulated in a box of 475 tip3p water molecules using the program namd version 2.8 @xcite .",
    "after minimization the system was equilibrated for 10ns with the peptide held constrained .",
    "the equilibration was followed by a 1.3 @xmath246s production run with langevin dynamics at 330 k , using a friction constant of 5 ps .",
    "the bonds between hydrogens and heavy atoms were kept rigid to allow integration at 2 fs .",
    "frames were saved every 0.5 ps and a total of @xmath250 trajectory snapshots were collected .    to construct the set of trial milestones",
    ", we projected the md trajectory onto the pair of dihedral angles @xmath240 that corresponds to the central residue alanine .",
    "we discretized the @xmath240-space into a square grid of size @xmath220 deg and used circles of radius @xmath214 deg around these discretization points as trial milestones  we also used a finer grained definition of the trial milestones , a grid of points at 5 deg but this did not significantly change the results . only those milestones that we were hit by the trajectory were kept : these consist of the @xmath251 milestones shown as circles in fig .",
    "[ fig : gagland](a ) , and colored according to their free energy @xmath185 whose estimator is given in  .",
    "this free energy defines a landscape that is divided in four macro - regions , often labeled as c5 , @xmath243 , @xmath252 , @xmath253 and @xmath254 .",
    "interestingly , the overall topography of this landscape is consistent with that obtained in a reference study on a solvated alanine dipeptide @xcite where the @xmath241 conformation is the most populated ( see the ramachandran map in ref .  [ ] for the conformation names and refs .  [ ] for comparison with nmr studies on the alanine conformational preferences ) .",
    "since the target milestones that emerged from our analysis were located in the regions around c5 , @xmath243 , @xmath252 , @xmath253 and @xmath254 ( these target milestones are shown as filled white circles in fig .",
    "[ fig : gagland](a ) ) , we used this nomenclature to designate them .",
    "[ fig : gagland](b ) shows a portion of the trajectory projected on the angles @xmath247 and @xmath248 .    from the md trajectory",
    "the matrix of probabilities @xmath18 was estimated from  , and the metastability index @xmath38 was minimized over index sets @xmath47 of different cardinals @xmath48 .",
    "the results are shown in fig .",
    "[ fig : gagrhob ] . two sets of target milestones",
    "were found to be clearly metastable : @xmath255 with metastability index @xmath256 , and @xmath257 with metastability index @xmath258 . a third set of target milestones , @xmath259 was also metastable , but with a higher metastability index @xmath260 .",
    "interestingly , the index set minimizing @xmath38 when @xmath261 was @xmath262 , but its metastability index @xmath38 was close to 1 , i.e. it was not deemed suitable by our analysis to be used to construct an msm .",
    "beta3s mini - protein : ( a ) trajectory of the dihedral angles @xmath240 of a single amino acid crossing the three circular milestones @xmath263 , @xmath213 , and @xmath219 .",
    "the part of the trajectory in red contributes to the statistics of the events @xmath264 while the white double stroked portion contributes to the event @xmath265 .",
    "( b ) combinations of the dihedral milestones of two residues into chain milestones ( strings ) .",
    "( c ) ranked frequencies of the dihedral milestones prior ( black ) and after ( red ) the filtering that yielded a trial set of @xmath266 milestones with a filter cutoff of 30 .",
    "the unfiltered ranked frequencies follow the zipf s law @xmath267 with exponent @xmath268 . ]    to confirm that the target milestones in @xmath192 , @xmath193 and @xmath269 were good core sets to build an msm ( whereas others , including @xmath270 , were not ) , we estimated the transition rate matrix entries @xmath63 of the corresponding msms using the procedure described in sec .",
    "[ sec : msm ] .",
    "we then estimated the empirical first passage time ( fpt ) distributions from the md trajectory for the transitions between the states in these msms .",
    "these were found to be approximately exponential , with decay rates consistent with those deduced from the matrix with entries @xmath63 ( data shown in fig .",
    "s1 of the supplementary materials @xcite ) .",
    "this indicates that the dynamics projected on these states is approximately markovian , and confirms that a low metastability index is indeed a sign of markovianity .",
    "conversely , the fpt distributions between milestones @xmath271 and @xmath243 were non - exponential , which is indicative of the non - markovian character of these transitions ( see fig .",
    "s1(a ) in supplementary materials @xcite ) .",
    "interestingly , this result is consistent with the experimental findings about the non - cooperativity of the alanine @xmath243 conformation in ggagg peptides due to highly local hydration effects @xcite .",
    "it is also noteworthy that the transitions between the target milestones occur on different time scales : @xmath272  ns , @xmath273  ns , @xmath274  ns , @xmath275  ns , @xmath276  ns , @xmath277  ns . this explains why different sets of target milestones can be identified , similar to what we observed in the illustrative example of sec .",
    "[ sec : illustrativeex ] . note that the transition time scales between @xmath243 and @xmath241 are consistent with the @xmath278 ns@xmath279 interconversion rates reported in earlier studies on a solvated alanine dipeptide @xcite .",
    "note also that the target milestone @xmath242 plays the role of a hub for the transitions involving the left quadrant of the ramachandran plot with the basin centered in @xmath244 . that is due to the fact that direct transitions from the helical region @xmath241 to the bottom right quadrant are very rare events in a solvated alanine .",
    "finally , the msm with the target milestones in @xmath269 was used to cluster the state space of the system .",
    "these results are shown in fig .",
    "[ fig : gag - commtscluster ] .",
    "the committor probabilities @xmath280 shown in fig .  [ fig : gag - commtscluster](a ) permit one to assign each of the trial milestones to the target milestones it is most likely to reach next , thereby partitioning the dihedral space into basins ( see fig .",
    "[ fig : gag - commtscluster](c ) ) . in fig .",
    "[ fig : gag - commtscluster](b ) the trial milestones are colored according to the tse index @xmath110 defined in  .",
    "the red regions represent the trial milestones @xmath106 which are likely to part of a transition state ensemble .",
    "also shown in fig .",
    "[ fig : gag - commtscluster](d ) is the network of the msm .",
    "as a last example we applied our method to analyze a 20 @xmath246s long md trajectory of the beta3s peptide in implicit solvent at 330k , where multiple folding / unfolding events were observed .",
    "the beta3s is a 20 residue peptide which is known to assume a triple stranded @xmath57-sheet fold @xcite .",
    "the simulation details of the md data we analyzed here can be found in ref .",
    "the 20 @xmath281 long trajectory is composed of @xmath282 microstates saved at a lag - time @xmath283 ps . in the context of the gag peptide ( sec .",
    "[ sec : glyalagly ] ) , the torsional angles of the central alanine residue were shown to be sufficiently good descriptors of the conformational space and were used to define the trial milestones .",
    "this procedure , however , is not applicable to a 20 residues mini protein such as beta3s , whose configurational space is much more complex than that of a tri - peptide . for the initial definition of the trial set of milestones several alternatives",
    "are in principle viable . here",
    "we used the main dihedral angles along the chain as starting point .",
    "specifically , the trial milestones were defined at the level of the individual amino acids . for a protein of @xmath284 residues",
    "there are @xmath285 pairs of main dihedral angles @xmath286 along the chain , where @xmath287 denotes the residue index . for each of the @xmath285 ramachandran plots that are associated to a residue",
    ", three trial milestones were defined as circles of radius 30 deg , and denoted as milestone @xmath263 , @xmath213 , and @xmath219 .",
    "the centers of these circles are located at the minima of the free energy landscape obtained from the empirical @xmath286 probability density of all the residues combined ( see the free energy contour plot in fig .  [",
    "fig : dihemile](a ) ) that is estimated from the md trajectory .",
    "the locations of the milestone centers are @xmath288 for state @xmath263 ( beta - sheet region ) , @xmath289 for the state @xmath213 ( helix region ) , and @xmath290 for state @xmath219 ( turn / loop region ) . in this way",
    ", the value of each pair of residue @xmath286 along the md trajectory is first mapped on a three - letter alphabet , and these letters are then combined into a word , resulting in the representation @xmath291 where @xmath292 and @xmath293 the residue index .",
    "for example , the folded state is represented as `` @xmath294 '' .",
    "[ fig : dihemile](b ) gives a pictorial representation of the construction of symbolic milestones . since beta3s is a 20 residues mini - protein , the upper limit of accessible trial milestones constructed this way is therefore @xmath295 .",
    "metastability index for the beta3s peptide at 330k calculated using four different sets of trial milestones obtained with different filtering cutoff . in each case , the procedure identify the same target milestones with metastability index lower than 1 .. ]        in practice , not all these trial milestones were visited even once along the trajectory , and some were visited much more often than others . to avoid using trial milestones",
    "visited too few times , we filtered out the milestones that were visited less than a threshold value of times .",
    "the first step of dihedral milestoning gave a total number of @xmath296 dihedral strings , 373456 of which were visited only once , which is about @xmath29737% of the whole set .",
    "interestingly , the ranked distribution of the visting frequencies follows a zipf s law decay , namely a power law @xmath298 with @xmath293 the rank and @xmath299 the exponent ( see figure [ fig : dihemile](c ) ) .",
    "different frequency thresholds were used to filter out trial milestones .",
    "cutoffs corresponding to 20 , 30 , 40 , and 50 reduced the number of trial milestones to 3439 , 2120 , 1516 , and 1162 , respectively .",
    "all these four sets of trial milestones were used to process the md trajectory and estimate the probabilities @xmath132 .",
    "the metastability index @xmath38 was calculated for target sets @xmath47 with cardinality in the range @xmath300 .",
    "[ fig : metaindex_beta3s ] shows the result of this calculation .",
    "irrespective of the cutoffs used to define the set of trial milestones , the resulting target sets were robust in the range @xmath301 where at the low values of @xmath302 .",
    "to better understand the conformational dynamics of the beta3s peptide , we used the tools introduced in sec .",
    "[ sec : diagno ] . the committor probability @xmath100 ( obtained from ) permits one to perform a soft partitioning of the trial milestones .",
    "each target set milestone @xmath303 is the center of a partition with statistical weight @xmath304 that is obtained from  , and from which the free energy @xmath119 is determined from  .",
    "this free energy can then be decomposed into energetic and entropic contributions according to   and  . here",
    "the effective energy of the system is identified as the sum of two contributions : @xmath305 where @xmath306 is the total potential energy in the charmm force field and @xmath307 is the solvent accessible term due to the implicit solvation model . using   we obtained @xmath308 kcal / mol as mean effective energy of the entire set of conformation sampled .",
    "llccccc    i d & symbolic milestone & @xmath304 & @xmath309 & @xmath310 & @xmath311 & @xmath312 & & % ] & & & & * 1 * & ` 000021000000210000 ` & * 76 * & 48 & * 0.2 * & * -0.6 * & * 0.8 * 106 & ` 111111111111100000 ` & 8.2 & 42 & 1.6 & 4.9 & -3.3 164 & ` 001211001000210010 ` & 3.1 & 9 & 2.3 & -5.5 & 7.8 241 & ` 111111111111111111 ` & 3.1 & 37 & 2.3 & 4.7 & -2.5 264 & ` 010001111111111111 ` & 4.5 & 33 & 2.0 & 5.1 & -3.0 319 & ` 001111000011111000 ` & 2.3 & 19 & 2.5 & -3.6 & 6.0 473 & ` 001111000000200000 ` & 1.4 & 23 & 2.8 & -2.2 & 4.9 843 & ` 001111000111210010 ` & 1.4 & 5 & 2.8 & -2.8 & 5.7    we focused our analysis on the target set @xmath313 that resulted the largest metastable target set with @xmath314 .",
    "the committor probability @xmath100 is calculated from the time series of trial milestones , with @xmath315 .",
    "table [ tab : thermo - mile ] lists the statistical weights of the most populated states in the msm build on @xmath313 .",
    "the mean effective energies @xmath311 are also reported in table [ tab : thermo - mile ] , along with the entropy contributions @xmath312 to the free energy @xmath316 .",
    "the basin centered around the target milestone associated with the folded state ( i d 1 in table [ tab : thermo - mile ] ) has a statistical weight @xmath317 of about 76% , meaning that beta3s spends about the 3/4 of the simulation time in this basin .",
    "as expected for a folded state , it has an energetic advantage ( @xmath318 kcal / mol ) which compensates its entropic disadvantage ( @xmath319=0.8 kcal / mol ) .",
    "the other basins identified in the target set @xmath313 include helical and beta - curl type configurations .",
    "interestingly , the helical basins ( i d 106 , 241 , and 264 in table  [ tab : thermo - mile ] ) are entropically favored ( @xmath320 and @xmath321 ) while the beta - curl states are energetically favored basins ( i d 164 , 319 , 473 , and 843 in table  [ tab : thermo - mile ] ) with @xmath320 and @xmath322 .",
    "the statistical error on the mean effective energies @xmath323 is estimated as @xmath324 where @xmath325 is a standard deviation and @xmath309 is the number of times the system enters a target milestone @xmath303 .",
    "the values of @xmath309 are reported in table  [ tab : thermo - mile ] .",
    "the statistical errors on @xmath323 are reported in fig .",
    "s4 of the supplementary materials @xcite along with the empirical probability density functions of the effective energy for each of the target milestones @xmath303 .",
    "while these errors are large , the information contained in @xmath326 remains statistically significant .",
    "[ fig : redunetwork ] shows the network of the msm built on the target set @xmath313 .",
    "notably , the folded state lies in between the helical region , which is entropically favored , and the beta - curl region , which is energetically favored . except very rare direct connections between the helical and beta - curl regions ,",
    "most of the transitions between the helix and beta - curl basins occur via the folded state .",
    "thus , as was remarked elsewhere @xcite , the folded state is not only the region of the configurational space where energy and entropy compensate each other , but it also plays the role of a dynamical hub in the network .",
    "this observation is confirmed by the high number of times the target milestone associated to the folded state is revisited ( @xmath327 is the highest values observed , see @xmath309 column in table  [ tab : thermo - mile ] ) .    the high entropy character of the helical states is also reflected by the high connectivity within the helical region ( left side of the network shown in fig .",
    "[ fig : redunetwork ] ) and the comparable values of @xmath309 with that of the folded state ( @xmath328 , @xmath329 , and @xmath330 in table  [ tab : thermo - mile ] ) . on the contrary , the beta - curl states ( right side of the network shown in fig .  [ fig : redunetwork ] ) are less connected ( @xmath331 , @xmath332 , @xmath333 , and @xmath334 ) .",
    "this is consistent with the observation reported in @xcite that these beta - curl states act as kinetic traps .",
    "the probability distributions of fpt from the folded state to the other member of the target set and back are fairly well described by an exponential decay ( see fig . s2 and s3 in the supplementary materials @xcite ) .",
    "this indicates that the reduced dynamics of the beta3s to a msm built on the target set @xmath313 is approximatively markovian .",
    "interestingly , the emerging picture from the network representation in fig .",
    "[ fig : redunetwork ] is qualitatively consistent with the simplified kinetic network representation proposed in ref .",
    "@xcite .",
    "the committor probability @xmath100 calculated for the target set @xmath313 allows one to project the configurational space onto a simplex .",
    "three aggregated committor probabilities are defined as @xmath335 for the folded state , @xmath336 for the helix state , and @xmath337 for the beta - curl state ( see table [ tab : thermo - mile ] for the state indexes ) . by definition of committor probability one",
    "has @xmath338 .",
    "[ fig : simplex ] shows the simplex representation of the aggregated committor probabilities in a triangular plot .",
    "[ fig : simplex](a ) shows the time series of the committor probabilities @xmath339 projected onto a triangular plot .",
    "interestingly , the conformers are clustered around the three vertexes of the triangular plot .",
    "the blue lines represent direct transitions between conformer and only 4 direct transitions link the helix channel to the trap channel .",
    "[ fig : simplex](b ) shows a triangular scatter plot of the committor probabilities with the points colored according to their tse index @xmath110 defined in .",
    "red points correspond to milestones belonging to transition state ensembles .",
    "for instance , the channel connecting the helix to the fold basin is composed by milestones @xmath106 such that @xmath340 .",
    "similarly , along the channel trap@xmath341fold one has milestones @xmath106 with @xmath342 . the simplex representation in fig .",
    "[ fig : simplex ] corroborates the observation that the folded state acts as a kinetic hub @xcite , and it also suggests that beta3s oscillates between two extreme conformational regions : a low energy one versus a high entropy one .    [ fig : simplex ] , @xmath336 and @xmath337 ( these indices are the same as those used in fig .  [",
    "fig : redunetwork ] ) .",
    "the continuous blue line represent the time series @xmath343 , @xmath344 and @xmath345 only 4 transition events connect directly the helix and beta regions .",
    "( b ) same representation with nodes colored according 1 to the ts index @xmath110 defined in  .,title=\"fig : \" ]",
    "despite their growing popularity to analyze and interpret molecular dynamics ( md ) simulations , markov state models ( msms ) remain somewhat tricky to use and justify . how to pick the states over which to build the msm and how to assess its accuracy are nontrivial issues that are related to the degree to which the dynamical coarse - graining over these states preserves the markovianity of the original system .",
    "typically , states in msms are picked in a somewhat _",
    "ad  hoc _ fashion , and their quality is assessed _ a  posteriori _ via markovianity tests . in this paper",
    ", we propose a strategy that may help systematize the operation of msm building .",
    "it is based on the observation that , in metastable systems , the states in an msm should be hubs to which the trajectory has a high probability to return often , and between which it seldom transitions .",
    "these intuitive properties can be captured via a metastability index that measures how good a set of target milestones chosen among trial ones is : the smaller its metastability index , the better the target milestones it contains are as hubs .",
    "this metastability index is not a new concept : it was introduced in a closely related form in potential theoretic approaches to metastability .",
    "our main goal in this paper was to show that this index can also be turned into a practical computational tool for the identification of good target milestones upon which to build accurate msms . as we shown here",
    "the procedure is simple to use , it does not require to make markovian assumptions at the intermediate stages of the construction ( in particular , the jumps between the trial milestones could be correlated and non - markovian ) , and it has the added advantage that it allows one to cluster the system s state space _ a  posteriori _ and",
    "identify the transition state ensembles ( tses ) between the target milestones . here",
    ", these features were illustrated on a collections of examples of increasing complexity .",
    "in particular , our last test case involving the beta3s mini - protein , showed that the method can reveal interesting properties of the folding landscape of proteins , including the presence of kinetic traps and misfolded states on the way to the native state , and how these features affects the folding and unfolding pathways of the protein .",
    "we certainly hope that the technique will be similarly useful to analyze the dynamics of other proteins and macromolecules .",
    "we thank amedeo caflisch for sharing the md trajectories of the beta3s peptide .",
    "we also thank jianfeng lu for helpful discussions .",
    "in this section a proof of   is given in case of a markov process with generator @xmath346 and transition probability @xmath347 , @xmath348 , @xmath349 .",
    "to begin , recall that the mfpt @xmath143 from state @xmath11 to state @xmath32 is the solution to @xmath350 while the mrt is given by @xmath351 where the first term at the right hand - side accounts for the mean time to exit @xmath11 to some state @xmath352 , and the second for the mean time to come back from any such state @xmath138 to @xmath11 .",
    "we are interested to find an expression for the probabilities @xmath132 as a function of the mfpt and mrt .",
    "since @xmath353 , we can equivalently express the committor function @xmath354 in terms of mfpt and the mrt .",
    "we claim that @xmath355 let us check that this relation holds by verifying that the function @xmath139 defined this way satisfies @xmath356 , @xmath357 and @xmath358 for @xmath359 .",
    "the two boundary conditions are trivially verified and the third condition is @xmath360 where we have used  .",
    "we can now calculate @xmath132 using and @xmath361 where we used   and .",
    "thus , for any pair of states @xmath362 , the probability @xmath18 can be computed from the mfpts and mrts only .",
    "43ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1063/1.2714538 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1063/1.3590108 [ * * ,   ( ) ] @noop _ _ ,  vol .",
    "( ,  ) @noop _ _ , vol .",
    "( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1021/jp411822r [ * * , ( ) ] link:\\doibase    10.1021/ct500353 m [ * * ,   ( ) ] @noop ( ) ,   @noop * * ,   ( ) link:\\doibase 10.1063/1.1738640 [ * * , ( ) ] link:\\doibase 10.1063/1.2996509 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3129843 [ * * , ( ) ] link:\\doibase 10.1021/jp060039b [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) http://scitation.aip.org/content/aip/journal/jcp/143/4/10.1063/1.4926940 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1137/070699500 [ * * , ( ) ] @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop `` ''   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase doi 10.1021/jp711864r [ * * ,   ( ) ] link:\\doibase 10.1002/prot.21565 [ * * ,   ( ) ] @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> a method is proposed to identify target states that optimize a metastability index amongst a set of trial states and use these target states as milestones ( or core sets ) to build markov state models ( msms ) . </S>",
    "<S> if the optimized metastability index is small , this automatically guarantees the accuracy of the msm , in the sense that the transitions between the target milestones is indeed approximately markovian . </S>",
    "<S> the method is simple to implement and use , it does not require that the dynamics on the trial milestones be markovian , and it also offers the possibility to partition the system s state - space by assigning every trial milestone to the target milestones it is most likely to visit next and to identify transition state regions . here the method is tested on the gly - ala - gly peptide , where it shown to correctly identify the expected metastable states in the dihedral angle space of the molecule without _ a  priori _ information about these states . </S>",
    "<S> it is also applied to analyze the folding landscape of the beta3s mini - protein , where it is shown to identify the folded basin as a connecting hub between an helix - rich region , which is entropically stabilized , and a beta - rich region , which is energetically stabilized and acts as a kinetic trap . </S>"
  ]
}