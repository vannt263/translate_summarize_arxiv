{
  "article_text": [
    "detecting road borders has broad applications in future autonomous vehicles and intelligent transportation systems as an important component of scene understanding .",
    "it can provides cues about road structure that benefit motion planning and cruise behavior control . in autonomous driving , the detection of road border is often done by gps , high quality road map and some other active sensors such as radar and lidar .",
    "this , however , can sometimes be limited by the accuracy of gps positioning signal as well as the resolution of active sensors .",
    "a natural question is whether we can address the problem with computer vision .    besides detecting the physical road border , part of our task",
    "also includes robustly detecting the shoulder region in order to provide necessary maneuver guidance for future autonomous driving systems . in the united states ,",
    "highways often contain a so - called `` shoulder region '' usually defined as the region between the outer - most solid lane marking and the physical road border .",
    "this shoulder region serves as a buffer zone before the physical limit of the road .",
    "non - emergency vehicles are mostly not allowed to drive on shoulder regions .",
    "but under emergency conditions , they may be allowed on shoulder regions for purposes such as evasive maneuver and emergency parking .",
    "[ fig1a ]     we start from the most basic setting where a side - view production camera looks out from the right side of a vehicle , as illustrated in fig.[fig1 ] .",
    "the detection problem is approached as the problem of detecting the road border ( e.g. , guard rails , concrete barriers , etc . ) and detecting the closest lane marking on the shoulder - side of the vehicle .",
    "the expectation is that the algorithm will return an estimate of the drivable regions before the physical road border .",
    "if the vehicle is on the right - most lane , the shoulder region is expected to be detected , while if the vehicle is on inner lanes , the detection also include available lanes on the right .",
    "we will assume that the shoulder is on the right side of the car , but we can easily apply our approach to the shoulder on the left side provided that the side camera is mounted on the left side of the vehicle .",
    "we emphasize that the current system is just one part of a future surround view system where side - view detection and front - view detection can jointly support and improve each other .",
    "the current system can also benefit future autonomous driving systems by providing information about road structure .",
    "our goal is to achieve robust detection within 0.5 to 6 meters detection range , while being able to handle various challenging scenarios including strong shadows , diverse border types / appearances and complicated scenarios such as highway entrances and exits .    in the united states , typical highway borders",
    "can be classified into three types : concrete barrier , guard rail and soft shoulder . given this observation ,",
    "our key assumption is that the types of highway border are not as diverse as the borders in urban or other uncontrolled scenarios and can be learned from a set of labelled images .",
    "this assumption , however , by no means makes the problem trivial : the border and shoulder detection problem still needs to address the limited resolution challenge , meet the required speed constraints , deal with complicated border situations and contend with a number of other challenges such as strong shadows , dynamic appearances and other patterns that look like borders .",
    "we show that our problem can be theoretically formulated as a joint detection - and - tracking problem under a graphical model called `` structured hough voting '' .",
    "our contribution in this paper lies in the fact that the proposed structured hough voting model exploits a variety of inter - frame and intra - frame structural information to achieve very robust performance , while using multiple candidate hypotheses and mode selection to retain necessary flexibility .",
    "we will show that the proposed model performs very well on the highway border and shoulder detection problem .",
    "the problem of vision - based scene understanding for autonomous driving has been widely studied .",
    "many seek to address the problem of general object detection , such as the detection of pedestrians @xcite , bicycles @xcite , motorcycles and vehicles @xcite .",
    "there has also been a considerable amount of work regarding scene parsing where each pixel / superpixel in an image is labeled with a certain object class @xcite . however , most of them focus on the understanding of general objects and the algorithms are often not possible to run in real - time on a regular cpu .",
    "some relevant works try to understand the structure of road and these works are indispensable parts of the autonomous driving system .",
    "considerable effort has been devoted to automatically detect roads @xcite and lane markings @xcite , or to find vanishing points @xcite .",
    "others have addressed the problem by exploring more capable sensors , including stereo vision sensors @xcite and lidar sensors @xcite .",
    "these sensors provide extra depth information which makes the tasks considerably easier .",
    "thus they have been adopted in some autonomous systems @xcite . while these sensors are able to provide more information than monocular cameras , their costs are often very high .",
    "the problem of road border detection has been previously addressed @xcite but none has addressed the highway scenario where border detection can become particularly difficult with concrete barriers due to their textureless nature .",
    "in addition , most of them focus on features and detectors while our work also presents a novel robust model .",
    "given a video from the side camera , we investigate both the inter - frame and intra - frame structural information instead of performing hough voting independently for each frame .",
    "our high - level intuition here is that these structural cues are the key to robust performance . to utilize such cues",
    "we formulate our model under a conditional random field ( crf ) .",
    "we shall see that independent hough voting corresponds to unary prediction in our crf model , returning how likely the hypotheses are .",
    "the inter - frame and intra - frame structural information corresponds to pairwise potentials , introducing additional constraints to refine the results .",
    "geometrically , a straight line in a 2-d @xmath0 space can be represented by the following equation : @xmath1 where @xmath2 is the algebraic distance between the line and the origin , @xmath3 is the angle of the vector orthogonal to the line .",
    "voting points are the points indicating where a line should be .",
    "given a set of voting points whose coordinates are @xmath4 , the voting weight is defined as : @xmath5 where @xmath6 is the weight associated with each voting point .",
    "@xmath7 is the bandwidth parameter that adjusts how sensitive voting is to relatively far away voting points and is empirically fixed as 5 in this work for its good performance .",
    "let @xmath8 , conventional hough voting seeks to find a hypothesis @xmath9 that maximizes the voting weight : @xmath10 finding @xmath11 with continuous optimization is difficult as it is non - convex .",
    "a common way is to discretize @xmath9 and search for the one with the maximum vote weight .",
    "the remaining questions are : 1 .",
    "how are the voting points defined ? 2 . how to obtain these voting points ?",
    "* type 1 voting points : * voting points are returned by triggered border or lane marking detectors . here",
    "we adopt scanning window detection where each detected positive window returns an equally weighted voting point estimating where the border / lane marking is .",
    "we deliberately allow multiple dense triggers ( see fig .",
    "[ fig5 ] ) and the returned voting points are the main source of detection information .",
    "* type 2 voting points : * these are voting points whose coordinates are simply the coordinates of all pixels , while the hough voting is now weighted by the gradient of each pixel .",
    "the intuition is obvious : borders and lane markings often have relatively strong vertical gradients . in case where detectors have failed and very few type 1 voting points are returned , estimating with gradient might be a good approximate strategy to obtain a reasonable result .",
    "we seek to treat the hough voting hypotheses jointly , exploring their probabilistic and structured relations with a graphical model .",
    "crf is a highly suitable model for our problem .",
    "suppose @xmath12 denotes the aggregate of observations ( i.e. , the coordinates and weights of voting points ) in all the frames and @xmath13 the aggregate of all the hough hypotheses , crf discriminatively defines the joint posterior probability @xmath14 and the inference of crf is to find the joint hypothesis configuration that maximizes @xmath14 : @xmath15    different from many conventional models , our structured hough voting model first generates three different candidate hypotheses in every frame ( except the initial one ) .",
    "we will show how they are generated later .",
    "the intuition is that we want to handle certain situations where : 1 .",
    "borders and lane markings can `` jump '' suddenly due to entrances and lane changes and 2 .",
    "failures of border / lane marking detectors can return very few type 1 voting points .",
    "we hope that at least one of them can return a good `` guess '' of the border / lane marking in every situation and that the model can appropriately select the best expert .",
    "once the candidate hypotheses are obtained , the model selects the best one as the detection output .",
    "finally , we also check whether the chosen hypotheses for border and lane marking in each frame have violated certain structure restrictions ( e.g. , whether they have intersected ) .",
    "if violations occur , perturbation is performed on the border hypothesis candidates to guarantee that such structural restrictions are followed .",
    "again , one of the perturbated hypothesis candidates is selected as the final detection result .",
    "let `` bd '' and `` ln '' denote `` border '' and `` lane marking '' for short , we define the following notations to better describe our model . in the @xmath16th ( @xmath17 ) frame , we have : + * bd candidate hypotheses : * @xmath18 + * ln candidate hypotheses : * @xmath19 + * selected bd / ln hypotheses : * @xmath20 + * observations ( bd , ln , grad ) : * @xmath21 .",
    "+    let @xmath22 be the number of video frames .",
    "we model the log crf conditional probability as a set of potentials :    the graphical model is shown in fig .",
    "[ model ] .",
    "let @xmath23 denote @xmath24 , and similarly for @xmath25 , @xmath26 , @xmath27 and @xmath28 , we will give detailed definition and intuition for each term in our model .",
    "to better illustrate each term , we decompose the model and show them in fig .",
    "[ model_decompose ] .",
    "the term @xmath24 seeks to generate multiple candidate border hypotheses based on the observations in current frame and the selected hypotheses in the previous frame .",
    "the intuition here is that the first hypothesis candidate @xmath29 is generated by performing unconstrained hough voting with type 1 bd voting points .",
    "it is able to discover sudden border changes . the second candidate is also generated by hough voting with type 1 bd voting points , but is additionally constrained ( smoothed ) by the previous frame .",
    "the third candidate concerns the constrained hough voting with type 2 voting points ( image gradients ) .",
    "it specifically handles the case of very few returned type 1 voting points due to occlusions and faded lane markings .",
    "the graphical representation is shown in fig .",
    "[ model_decompose ] ( a ) .",
    "note that the unit is not a clique potential .",
    "however , it is a composition of a set of potential functions : @xmath30 where @xmath31 is the hough voting function defined in eq .",
    "( [ weighted_hough ] ) .",
    "let @xmath32 and @xmath33 , @xmath34 is the inter - frame pairwise potential defined as a binary loss function : @xmath35 where @xmath36 and @xmath37 are the potential parameters to be learned .",
    "they respectively describe the tolerance of the inter - frame offset and angle difference of the hypotheses .",
    "similarly , @xmath38 is defined as : @xmath39      the mode selection potential @xmath40 seeks to select the best candidate bd hypothesis .",
    "a decision tree is used to guide the selection .",
    "since the voting weights of candidates can indicate the hypotheses confidence , the decision tree takes such input to predict the best candidate .",
    "let @xmath41 be denoted as @xmath42 for short , the decision tree diagram for border is shown in fig .",
    "[ model_decision_tree ] :    let @xmath43 denote the candidate selected by the decision tree , and @xmath44 the candidates not selected by the decision tree .",
    "the mode selection potential is defined as : @xmath45 where @xmath46 is a nonnegative penalty parameter to be learned .",
    "it controls how sensitive the model is to the violation of decision tree output .",
    "the mode selection potential basically forces the output to be one of the candidate hypotheses , but allows discrepancy with the decision tree prediction with a penalty . the graphical model of the mode selection potential",
    "is shown in fig .",
    "[ model_decompose ] ( b ) .",
    "the decision tree for lane marking is similarly defined .",
    "the condition for the root decision node is chosen as : @xmath47 and the conditions for the two child decision nodes are respectively @xmath48 and @xmath49 .",
    "the coupled structure potential @xmath50 further regularizes the results by exploiting the intra - frame structure . with this potential ,",
    "border and lane marking are no longer independent but coupled and it can significantly improve the results under certain cases . the graphical representation of the coupled structure potential is illustrated in fig .",
    "[ model_decompose ] ( c ) .",
    "the potential mainly captures two properties of structural restrictions between border and lane marking : + * parallelism : * the border and lane marking hypotheses are approximately parallel to each other .",
    "the closer they are , the stronger such property holds .",
    "most important of all , they can not intersect .",
    "+ * distance : * a border often keeps certain distance from the lane marking . they can not be too close to each other .",
    "let @xmath51 and @xmath52 . the coupled structure potential is defined as :    @xmath53    where @xmath54 and @xmath55 are the potential parameters learned from training data to control the level of parallelism .",
    "@xmath56 , @xmath57 and @xmath58 are empirically set to 10 , 17 and 35 respectively .",
    "@xmath59 is a piecewise - linear function defined as : @xmath60 where @xmath61 and @xmath62 are parameters that can also be learned through a linear regression from training data .",
    "the online updating nature ( real - time requirement ) of this problem limits our scope of observations to the past frames .",
    "suppose at time @xmath63 the set of available observations is denoted as @xmath64 .",
    "the inference problem is to : @xmath65    however , conducting the above whole inference each time given a new frame is computationally infeasible .",
    "a relaxation is to initialize with the inferred state variable configuration of the previous @xmath66 frames and infer the current state variables , updating in an incremental way . at @xmath67 ,",
    "the inference is to optimize the following problem : @xmath68 this is to search the maximum hough voting for border and lane marking based on type 1 voting points , subject to the constraint from the coupled structure potential .    at @xmath69",
    ", the log probability can be represented as : @xmath70 since we reuse the previously inferred results , the inference problem becomes : @xmath71 where @xmath72 .",
    "the @xmath73 penalty in the potential functions essentially serve as hard constraints on the search space of hough voting hypotheses . to perform inference one needs to follow these constraints and conduct the following 4-step optimization :     * step-1 * : optimize with @xmath74 and @xmath75 .",
    "@xmath76 given @xmath77 from the previous frame , generate the candidate hypothesis @xmath78 using unconstrained hough voting and @xmath79 and @xmath80 using constrained hough voting .",
    "similar for lane marking candidate hypotheses .",
    "* step-2 * : optimize with @xmath81 . @xmath82",
    "this step selects the candidate indicated by the decision tree for both border and lane marking .     * step-3 * : back perturbation with @xmath74 .",
    "( optional )    check whether @xmath83 equals to @xmath73 .",
    "if it is then one needs to go back adjust @xmath74 such that the three candidates also follow the structure restriction with @xmath84 : @xmath85     * step-4 * : optimize with @xmath86 .",
    "( optional )    given the adjusted border hypotheses @xmath74 , again perform mode selection with the decision tree .",
    "much of the potential parameters in our model can be automatically learned from training data .",
    "we use gaussian models to fit the differences of @xmath2 and @xmath3 from ground truth hypotheses in consecutive frames .",
    "this gives a statistical estimate of how quick the hypotheses can change .",
    "thus @xmath36 , @xmath37 , @xmath36 and @xmath37 are learned as twice of the model standard deviation .",
    "the estimation of @xmath54 and @xmath55 is conducted similarly .",
    "@xmath46 is learned to be larger than the largest vote weight loss caused by back perturbation , such that one would not risk violating the decision tree to generate a candidate that does not follow the coupled structure restriction but with a larger voting weight .",
    "we first describe how to obtain the type 1 voting points .",
    "we extract the filter bank responses and histogram of oriented gradient ( hog ) to perform scanning window detection .",
    "the filter bank we used is the same as in @xcite , while the adopted hog descriptor follows the work of @xcite .",
    "we divide each image patch into upper and lower two cells , and concatenate their mean filter bank responses .",
    "in addition , we also divide each image patch into 8 cells for hog , where the normalized gradient histogram of all the cells are concatenated .",
    "the final feature for each detector window is the concatenation of the above filter bank responses and hog features .",
    "[ fig6 ] illustrates our feature extraction method .",
    "it is worth mentioning that the computation of filter bank and hog features for scanning windows can be conducted in an extremely efficient way using integral image .",
    "thus the proposed feature extraction method has the potential to work real time .",
    "we train two classifiers , one for border detection and the other for lane marker detection . in detail",
    ", we perform fisher discriminant analysis on both the border training set and the lane marker training set , where the features of each training set are extracted as described previously . then , we train two radial basis function ( rbf ) kernel svms on the dimensionality reduced training sets .",
    "in addition to the basic border and shoulder detection , we include highway entrance detection and lane state tracking which allow us to jointly estimate the position of merging / neighboring lane and tracking the lane state of the vehicle ( e.g. , whether it is the right - most lane ) .",
    "figure [ addfeat ] shows some example results returned by the algorithm , where yellow regions in ( a ) and ( b ) indicate non - shoulder merging / neighboring lanes .",
    "the true shoulders on the other hand are detected as green regions in ( c ) .",
    "we collected 4200 highway road shoulder images . among them , 1592 images are used for training where the images come from the frames of multiple video segments .",
    "the remaining 2608 images are used for testing and all the images form a complete video .",
    "the dataset contains many challenging and complicated scenarios .",
    "example images from the dataset are shown in fig .",
    "[ fig2 ] ( a)-(d ) .",
    "the number of training images containing concrete barriers , guard rails and soft shoulders are 839 , 300 and 453 , respectively .",
    "we use the mit labelme open annotation tool to label borders and lane markings .",
    "we label the borders into `` concrete barriers '' , `` guard rails '' and `` soft shoulders '' .",
    "a set of well - aligned border image patches can be extracted from each annotated border and lane marker region ( see fig .",
    "[ fig2 ] ( e ) ) .",
    "these patches form the positive training samples for the scanning window detectors , while negative samples are randomly mined from the background of the training images . the ratio between the number of positive samples and number of negative samples",
    "is set as @xmath87 .",
    "[ fig4 ] illustrates some examples of the training patches .    for test sequence ,",
    "we label shoulder regions where the upper edges are the ground truth of highway borders . in the experimental section",
    ", we will use such ground truth to generate a set of benchmarks for quantitative comparison .",
    "we conducted an experiment on the 2608 frames of the test video using structured hough voting .",
    "the test sequence contains a variety of challenging situations , including complicated scenarios such as entrances and exits , as well as interfering visual manifestations such as strong shadows , dynamic appearances , drastic illumination change , weak border / lane marking and fake border / lane marking patterns .    to illustrate the performance of the proposed method",
    ", we compare our method with 3 baseline methods : 1 .",
    "independent hough voting in each frame using the fired detector voting points , 2 .",
    "hough voting using the triggered detector voting points constrained by previous frame and 3 .",
    "adding gradient tracking to baseline 2 .",
    "we also compare to results obtained by the kalman filter which is a standard method widely used in lane marking tracking .",
    "we first illustrate examples that show the difference brought by the coupled structure restrictions .",
    "one can see that such restrictions have successfully corrected results where the detection of border failed .",
    "some typical examples are illustrated in fig .",
    "[ fig10 ] .",
    "the first row corresponds to the method without coupled structure restriction , while the second row corresponds to the method with such restriction .",
    "we conducted a series of evaluations based on the annotated test sequence ground truth and benchmarks . + * ln_pen * : defined similarly to * bd_pen * for lane markings .",
    "+ * accept_ratio * : percentage of good frames defined by thresholding both * bd_pen * and * ln_pen*. a frame is `` good '' if both are within the threshold . + * overlap_score * : @xmath88 . ] .",
    "the quantitative results of the baselines and the proposed method ( proposed2 denotes with coupled structure restriction , while proposed1 denotes without the restriction . ) are listed in the table in table [ table1 ] .",
    "again , one can see the performance of the proposed method is the best one .",
    "we also select some challenging frames where the baseline methods usually fail .",
    "the results obtained by the baseline methods and the proposed method are shown in fig .",
    "the 6 sets of images ( from left to right and top to bottom ) correspond to ground truth , baseline1 , baseline2 , baseline3 , kalman filter and the proposed method .",
    "one can see that our model performs more robustly than the baseline methods in normal situations and is more responsive to drastic border changes in case of highway entrance due to the model flexibility achieved by the scheme of generating multiple hypothesis candidates .",
    "+   +            +   +                 [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]      we finally show some failure cases in fig .",
    "the failure cases are mostly caused by false positive voting points and there is little a model could do given such input .",
    "this shows that the next step to the improve the method is to enhance the quality of voting point input .",
    "in this paper , we have proposed a novel model called structured hough voting , and reported its application on vision - based highway border and shoulder detection .",
    "experimental results have validated the good performance of the proposed model and its superiority over some popular models such as kalman filter .",
    "our proposed method is also computationally efficient .",
    "first , the feature extraction unit can be implemented with integral image operations where the extraction of both mean filter bank responses and hog in every scanning window is extremely fast .",
    "second , our proposed inference method performs incremental ( online ) update , which also requires very few computation .",
    "the algorithm complexity of hough voting is @xmath89 where @xmath90 is the number of possible hypotheses and @xmath91 the number of voters .",
    "voting with image gradients takes the most computation among the three candidate hypotheses generation methods .",
    "but it is still highly efficient since both hypotheses and voting points are significantly truncated by previous frame . in general , the method is able to run real - time without any gpu acceleration ."
  ],
  "abstract_text": [
    "<S> we propose a vision - based highway border detection algorithm using structured hough voting . </S>",
    "<S> our approach takes advantage of the geometric relationship between highway road borders and highway lane markings . </S>",
    "<S> it uses a strategy where a number of trained road border and lane marking detectors are triggered , followed by hough voting to generate corresponding detection of the border and lane marking . </S>",
    "<S> since the initially triggered detectors usually result in large number of positives , conventional frame - wise hough voting is not able to always generate robust border and lane marking results . </S>",
    "<S> therefore , we formulate this problem as a joint detection - and - tracking problem under the structured hough voting model , where tracking refers to exploiting inter - frame structural information to stabilize the detection results . </S>",
    "<S> both qualitative and quantitative evaluations show the superiority of the proposed structured hough voting model over a number of baseline methods . </S>"
  ]
}