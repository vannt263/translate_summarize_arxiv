{
  "article_text": [
    "sandwiched singularities are normal surface singularities which birationally dominate a non - singular surface .",
    "they are rational surface singularities and among them are included all cyclic quotients and minimal surface singularities .",
    "the original interest in sandwiched singularities comes from a question posed by nash in the early sixties : _ does a finite succession of nash transformations or normalized nash transformations resolve the singularities of a reduced algebraic variety ? _ hironaka had proved in @xcite that after a finite succession of normalized nash transformations one obtains a surface @xmath6 having only sandwiched singularities .",
    "some years later , in @xcite , m. spivakovsky proves that sandwiched singularities are resolved by normalized nash transformations , thus giving a positive answer to the original question posed by nash for the case of surfaces .",
    "since then , a constant interest in sandwiched singularities has been shown , and they have been deeply studied as a nice testing ground for the nash and the wedge problem by lejeune - jalabert and reguera in @xcite .",
    "a recent paper by reguera proves the nash conjecture for sandwiched singularities @xcite .",
    "sandwiched singularities have been also studied from the point of view of deformation theory by de jong , van straten in @xcite and by gustavsen in @xcite .",
    "any sandwiched surface singularity can be obtained by blowing up a complete @xmath2-primary ideal @xmath3 in a local ring @xmath4 of a non - singular surface @xmath1 .",
    "the main purpose of this paper is to study the curves ( effective weil divisors ) on the sandwiched surface @xmath5 through their relationship to the infinitely near base points of @xmath3 .",
    "one motivation for this study comes from @xcite and the study of the divisor class group for rational surface singularities in general .",
    "another motivation comes from the fact that the study of the curves on a surface singularity may lead to a deeper understanding of the singularity itself ( see @xcite ) .",
    "criteria for the principality of weil divisors on @xmath6 are given in this paper .",
    "a number of invariants for the curves on @xmath6 ( such as their multiplicity and their order of singularity ) are also recovered in terms of the relative position of their projection to @xmath1 with the base points of @xmath3 .",
    "we keep the point of view of @xcite and make use of the theory of infinitely near points as revised and developed by casas - alvero in @xcite .",
    "relevant to our purposes is the fact that any complete ideal has a cluster of infinitely near base points that in turn determines the ideal .",
    "the organization of the paper is as follows .",
    "concepts and well - known facts about infinitely near points and sandwiched surface singularities are reviewed from @xcite and @xcite in section 2 .",
    "we also give a formula for the multiplicity of curves on @xmath5 going through a sandwiched singularity in terms of the base points of the ideal @xmath3 ( corollary [ multip_curve ] ) .",
    "section 3 deals with the existence of equations for curves on a sandwiched surface .",
    "the main result of the paper is theorem [ cartier ] , which provides different criteria for their principality . in section 4",
    "we derive easy consequences and show some examples to illustrate these results . in section 5",
    ", we suggest a procedure to compute effective cartier divisors containing a given ( not necessarily principal ) curve @xmath7 . to this aim",
    ", we introduce a slight modification of the unloading procedure called _ partial unloading_. it is explained in the appendix and it may be useful in any other context where precise control of unloading is needed .",
    "the procedure of section 5 gives rise to flags of clusters depending on the ideal @xmath3 ( and hence , on the surface @xmath6 ) and the curve @xmath7 .",
    "these flags keep deep information about the strict transform of @xmath7 and they are used in section 6 to infer formulas for its order of singularity ( proposition [ delta / general ] ) and to compute effectively the semigroup of a branch on any singularity of @xmath6 ( proposition [ semlemma ] ) .",
    "throughout this work the base field is the field @xmath8 of complex numbers .",
    "a standard reference for most of the material treated here is the book by casas - alvero @xcite .",
    "let @xmath9 be a regular local two - dimensional @xmath8-algebra and @xmath10 .",
    "a _ cluster _ of points of @xmath1 with origin @xmath0 is a finite set @xmath11 of points infinitely near or equal to @xmath0 such that for any @xmath12 , @xmath11 contains all points preceding @xmath13 . by assigning integral multiplicities @xmath14 to the points of @xmath11",
    ", we get a _ weighted cluster _",
    "@xmath15 , the multiplicities @xmath16 being called the _ virtual multiplicities _ of @xmath17 .",
    "we write @xmath18 if @xmath13 is proximate to @xmath19 .",
    "if @xmath20 is the _ excess _ at @xmath13 of @xmath21 , _ consistent _ clusters are those clusters with no negative excesses .",
    "moreover , @xmath22 is the set of _ dicritical _ points of @xmath17 . _",
    "strictly consistent _ clusters are consistent clusters with no points of virtual multiplicity zero .",
    "if @xmath21 is a weighted cluster , the equations of all curves going through it define a complete @xmath2-primary ideal @xmath23 in @xmath24 ( see @xcite 8.3 ) .",
    "two weighted clusters @xmath21 and @xmath25 are _ equivalent _ if @xmath26 .",
    "any complete @xmath27primary ideal @xmath28 in @xmath24 has a cluster of base points , denoted by @xmath29 , which consists of the points shared by , and the multiplicities of , the curves defined by a generic element of @xmath28 .",
    "moreover , the maps @xmath30 and @xmath31 are reciprocal isomorphisms between the semigroup @xmath32 of complete @xmath2-primary ideals in @xmath24 and the semigroup of strictly consistent clusters ( see @xcite 8.4.11 for details ) . if @xmath33 , we denote by @xmath34 the simple ideal generated by the equations of the branches going through @xmath13 and by @xmath35 the weighted cluster corresponding to it by the above isomorphism . clearly , @xmath36 . in this language ,",
    "if @xmath37 and @xmath38 is the cluster of base points of @xmath3 , we have that @xmath39 if and only if @xmath40 is the zariski factorization of @xmath3 into simple ideals .",
    "hence , the exponent @xmath41 of @xmath34 in the factorization of @xmath3 equals the excess of @xmath17 at @xmath13 , so we can write @xmath42 if @xmath43 is consistent , then the _ virtual codimension _ of @xmath17 equals ( proposition 4.7.1 of @xcite ) @xmath44    consistent clusters are characterized as those clusters whose virtual multiplicities may be realized effectively by some curve on @xmath1 .",
    "if @xmath21 is not consistent , @xmath45 is the cluster given rise from @xmath21 by _",
    "unloading_. equivalently , @xmath46 is the unique consistent cluster which is equivalent to @xmath21 and has the same points ( see @xcite  4.2 and  4.6 for details ) .",
    "if @xmath47 is the composition of the blowing - ups of all points in @xmath11 , write @xmath48 for the exceptional divisor of @xmath49 and @xmath50 for its irreducible components .",
    "use @xmath51 as meaning intersection number and @xmath52_p$ ] as intersection multiplicity at @xmath53 .",
    "we denote by @xmath54 the _ intersection matrix _ of @xmath48 , where @xmath55 is the _ proximity matrix _ of @xmath11 .",
    "if @xmath7 is a curve on @xmath1 , @xmath56 is the value of @xmath7 relative to the divisorial valuation associated with @xmath57 .",
    "then , @xmath58 . we write @xmath59 for the vector of virtual values of @xmath17 . moreover ,",
    "if @xmath60 is the strict transform of @xmath7 on @xmath61 , we have @xmath62 and we have the equality ( _ projection formula _ ) for @xmath49 : @xmath63_o$ ] for any curve @xmath64 on @xmath61 .",
    "we will make use also of the noether formula for the intersection multiplicity of two curves at @xmath0 ( theorem 3.3.1 of @xcite ) : @xmath65_o=\\sum_{p}e_p(c)e_p(c').\\end{aligned}\\ ] ] for consistent clusters , write @xmath66_o=\\sum_{p\\in k}\\nu_p e_p(c)}$ ] for the _ intersection multiplicity _ of @xmath21 and a curve @xmath7 on @xmath1 , and @xmath67 for the _ self - intersection _ of @xmath21 .",
    "we will also make use of the following results for rational surface singularities .",
    "let @xmath68 be a rational surface singularity and let @xmath69 be any resolution of it .",
    "write @xmath70 for the irreducible components of the exceptional locus of @xmath71 . if @xmath72 is a curve on @xmath6 ( i.e. an effective weil divisor )",
    ", it is possible to associate to @xmath72 a @xmath73-cartier exceptional divisor @xmath74 on @xmath75 , being defined by the condition ( see ii ( b ) of @xcite ) @xmath76 on the other hand , if @xmath77 is a divisor on @xmath75 such that @xmath78 for each exceptional component , then there exists an element @xmath79 such that @xmath77 is the total transform of the curve defined by @xmath80 ( see the proof of theorem 4 of @xcite ) .",
    "because of this , we have that    [ mumf ] @xmath72 is cartier if and only if @xmath74 is a divisor on @xmath75 .      in this section ,",
    "we fix notation and recall some facts concerning sandwiched singularities and base points of ideals which will be useful throughout this paper .",
    "the main references are @xcite and @xcite .",
    "a _ curve _ will be an effective weil divisor on a surface .",
    "let @xmath37 .",
    "the ideal @xmath3 is fixed throughout the paper , so that no confusion should arise if the notation introduced from now on does not reflect its dependence of @xmath3 .",
    "write @xmath43 for the cluster of base points of @xmath3 and @xmath81 for the blowing - up of @xmath3 .",
    "the singularities of @xmath6 are by definition sandwiched singularities and we have a commutative diagram @xmath82^{f}\\ar[rd]_{\\pi_k } & { x } \\ar[d]^{\\pi_i } \\\\ &   { s}}\\ ] ] where the morphism @xmath83 , given by the universal property of the blowing - up , is the minimal resolution of the singularities of @xmath6 ( remark 1.4 of @xcite )",
    ".    if @xmath84 is in the exceptional locus of @xmath6 , write @xmath85 for the maximal ideal in @xmath86 and @xmath87 for the ideal sheaf on @xmath6 associated with @xmath84 . then , the ideal @xmath88 is complete , @xmath2-primary and has codimension one in @xmath3 and moreover , the map @xmath89 defines a bijection between the set of points in the exceptional locus of @xmath6 and the set of complete @xmath2-primary of codimension one in @xmath3 ( theorem 3.5 of @xcite ) .",
    "it can be seen that if @xmath90 , and @xmath91 is the weighted cluster obtained from @xmath17 by adding @xmath19 as a simple point , then @xmath92 has codimension one in @xmath3 , and every complete @xmath2-primary ideal of codimension one in @xmath3 has this form ( lemma 3.1 of @xcite )",
    ". therefore , for every point @xmath84 in the exceptional locus of @xmath6 , there exists some @xmath93 such that @xmath94 it follows also that any @xmath93 can be mapped to the point of @xmath6 corresponding to @xmath95 by the above bijection .",
    "this correspondence is surjective , but not injective since the pre - image by this map of any singular point of @xmath6 consist of the points lying on the exceptional components contracting by @xmath83 to that singularity . on the other hand , non - singular points of @xmath6",
    "are characterized as those points for which there is only one @xmath93 such that @xmath94 ( proposition 4.4 of @xcite ) . in any case , we denote by @xmath96 the cluster of base points of @xmath97 , @xmath98 .    for any sandwiched singularity @xmath99 ,",
    "write @xmath100 so that @xmath101 is the set of the exceptional components of @xmath61 contracting to @xmath84 .",
    "in particular , we have that @xmath102 recall that there is a bijection between the set of simple ideals @xmath103 in the ( zariski ) factorization of @xmath3 ( see ( [ for : factorization ] ) ) and the set of irreducible components of @xmath104 ( @xcite corollary 1.5 ; see also @xcite proposition 21.3 ) .",
    "we write @xmath105 for the set of these components . if @xmath106 , we write @xmath107 and if @xmath7 is a curve on @xmath1 , @xmath108 . for @xmath109 , write @xmath110 .",
    "the following proposition is easy , but will be very useful in the future :    [ projection formula for @xmath111 if @xmath112 are curves on @xmath1 , we have that @xmath113_o=|c^*\\cdot \\widetilde{d}|_x.\\]]also , @xmath114 , for any @xmath109 .",
    "let @xmath69 be a resolution of @xmath6 .",
    "to prove the claim it is enough to apply the projection formula for @xmath49 and for @xmath71 .",
    "the following technical result is a generalization of lemma 4.2 of @xcite . given two points @xmath115 , the chain @xmath116 is the subgraph of the dual graph @xmath117 of @xmath118 of all vertices and edges between the vertices representing @xmath19 and @xmath13 in @xmath117 ( see  4.4 of @xcite ) .",
    "[ new_multiplicities ] let @xmath99 be singular and write @xmath119 .",
    "* by taking the partial order relation of _ being infinitely near to _ , there exists a unique minimal point in @xmath120 .",
    "we will denote this point by @xmath121 ; * @xmath122 . if @xmath12 and @xmath123 , then @xmath124 .",
    "\\(a ) assume that @xmath125 are different and minimal among the points of @xmath120 .",
    "let @xmath126 be such that @xmath127 and @xmath128 are infinitely near to @xmath129 and maximal with this property .",
    "then , @xmath130 . by the minimality of @xmath127 and @xmath128 , @xmath131 . by zariski s main theorem ( see , for example , theorem v 5.2 of @xcite ) , the union of the components @xmath101 is connected and by theorem 1.7 of @xcite , @xmath48 contains no cycles .",
    "this leads to contradiction , and ( a ) follows .    to prove ( b ) , denote by @xmath132 the surface obtained by blowing up the points preceding @xmath121 , so that @xmath121 is a proper point of @xmath132 ( @xmath133 if @xmath134 ) .",
    "denote by @xmath135 the morphism induced by blowing up . by corollary 3.6 of @xcite , we know that @xmath136 and so , @xmath137 for each @xmath13 preceding @xmath121 .",
    "therefore , the exceptional component of the total transform on @xmath132 of curves going sharply through @xmath17 or @xmath96 are equal .",
    "write @xmath138 for an equation of this exceptional component at @xmath121 . then , the ideal @xmath139 ( resp .",
    "@xmath140 ) generated by @xmath141 ( resp .",
    "@xmath142 ) is complete and @xmath143-primary in @xmath144 .",
    "since @xmath145 , we have @xmath146 . moreover , the base points of @xmath140 ( resp .",
    "@xmath139 ) equal the base points of @xmath3 ( resp .",
    "@xmath97 ) infinitely near or equal to @xmath121 . direct computation using ( [ for : cod_cluster ] )",
    "shows that @xmath147 .",
    "now , the proof of ( b ) follows as in lemma 4.2 of @xcite .",
    "the details are left to the reader .",
    "the above lemma shows that the virtual multiplicities of @xmath96 differ as much in one from the original multiplicities of @xmath17 .",
    "the set @xmath148 will play an important role in the sequel . given @xmath12",
    ", we denote @xmath149 if @xmath150 , @xmath151 and @xmath152 , otherwise .",
    "let us quote some consequences of [ new_multiplicities ] .",
    "the first one follows immediately from @xmath153 by using ( [ for : cod_cluster ] ) .",
    "[ equilbq ] @xmath154 .",
    "we also obtain a new formula for the multiplicity at @xmath84 of curves on @xmath6 in terms of @xmath121 and the points of @xmath155 .",
    "namely ,    [ multip_curve ] let @xmath84 be a point in the exceptional locus of @xmath6 and let @xmath7 be a curve on @xmath1 . then @xmath156    first of all , notice that if @xmath84 is not singular , then @xmath155 is empty and @xmath134 , so there is nothing to prove .",
    "hence , we assume that @xmath84 is singular . by the projection formula applied to @xmath83 , we have that @xmath157 the last equality by corollary 3.6 of @xcite .",
    "now , since the sheaves @xmath158 and @xmath159 are invertible , we can take two curves @xmath64 and @xmath160 going sharply through @xmath17 and @xmath96 , respectively and such that @xmath161 and @xmath162 share no points with @xmath60 on @xmath61 .",
    "by the projection formula applied to @xmath49 , @xmath163_o =     @xmath164_o = |\\widetilde{c}^{k}\\cdot { { \\mathcal e}}_{i_q}|_{s_k}$ ] . hence , by ( [ for : mult_curve ] ) above , @xmath165_o -[c , b]_o$ ] , and by noether s formula ( see ( [ for : noether ] ) ) , we have @xmath166 . finally , by ( b ) of [ new_multiplicities ]",
    ", we obtain @xmath167 as claimed .",
    "an easy formula for the multiplicity of a sandwiched singularity @xmath84 is also obtained in terms of the set @xmath155 .",
    "moreover , it shows that the number of these points is an invariant of the singularity and so , it is independent of the particular ideal blown - up to obtain it . recall that @xmath168 is said to be _ maximally regular _ in @xmath169 if there are no regular rings @xmath170 such that @xmath171 ( see @xcite ) .",
    "[ multsand ] let @xmath84 be a point in the exceptional locus of @xmath6 .",
    "then ,    * @xmath172 ; * @xmath173 , and the equality holds if and only if @xmath24 is maximally regular in @xmath86 and all the points in @xmath155 are simple .",
    "it is enough to compute the multiplicity of a transverse hypersurface section of @xmath68 , that is , of the strict transform of a curve @xmath7 going sharply through @xmath96 , see theorem 3.5 of @xcite .",
    "( a ) follows from [ multip_curve ] and [ equilbq ] by direct computation .",
    "now , the inequality in ( b ) is obvious if @xmath84 is regular , so we assume that @xmath84 is singular . clearly , @xmath174 .",
    "again by [ equilbq ] , we have @xmath175 and the equality holds if and only if the virtual multiplicity of all the points in @xmath155 is one and @xmath176 .",
    "now , if @xmath177 , there must be some @xmath19 preceding @xmath121 with @xmath178 ( recall that @xmath121 is minimal in @xmath120 , see [ new_multiplicities ] ) and so , @xmath179 .",
    "hence , @xmath180 and @xmath181 .",
    "now , this is equivalent to the maximally regular condition , since @xmath169 can always be projected birationally into the surface obtained by blowing up all the points preceding @xmath121 , i.e. the surface where @xmath121 is lying as a proper point , so @xmath182 .",
    "this completes the proof .",
    "[ cartier ] let @xmath7 be a curve on @xmath1 and write @xmath183 .",
    "the following conditions are equivalent :    * @xmath184 is a cartier divisor on @xmath6 ; * @xmath185 ; * there exists a curve @xmath64 on @xmath1 such that @xmath186 and @xmath187 goes through no singularity of @xmath6 ; * if @xmath188 and @xmath189 , then every dicritical point of @xmath190 is a dicritical point of @xmath17 .    before proving [ cartier ]",
    "we need a technical result .",
    "[ basis ]    * the set @xmath191 is a basis of the @xmath73-vector space generated by @xmath192 .",
    "the matrix of the change of basis from @xmath191 to @xmath50 is @xmath193 . *",
    "the set @xmath194 is a basis of the @xmath73-vector space generated by @xmath195 .",
    "we have @xmath196 where @xmath197 is the @xmath11-vector having all its entries equal to @xmath198 but the corresponding to @xmath13 which is @xmath199 .",
    "thus , @xmath200 and the claim ( a ) follows . to prove ( b ) , it is enough to show that the @xmath194 are linearly independent .",
    "assume that there exist rational numbers @xmath201 such that @xmath202 by multiplying by an integer , we may assume that the @xmath203 for all @xmath204 .",
    "now , for each @xmath204 take @xmath205 a curve going sharply through @xmath206 and missing all points after @xmath207 in @xmath11 , and write @xmath208 where @xmath209 and @xmath210 .",
    "then , by ( [ for : auxc ] ) we have that @xmath211 and @xmath212 are equal .",
    "hence , by taking total transforms on @xmath61 , we see that @xmath213 against ( a ) .",
    "proof of [ cartier ] .",
    "we prove that @xmath214 .",
    "assume that @xmath184 is cartier on @xmath6 and hence , that @xmath216 is so ( as @xmath217 is always cartier ) .",
    "then , by [ mumf ] , @xmath218 is a divisor on @xmath61 and so , the coefficients of the components @xmath101 in @xmath219 are integers , i.e. @xmath220 on the other hand , by ( b ) of [ basis ] , we can write @xmath221 , with @xmath222 rational numbers . now , if @xmath204 , then @xmath223 and @xmath224 is the expression of @xmath219 in the basis @xmath191 .",
    "therefore , by ( a ) of [ basis ] and the equality ( [ for : coefl ] ) , @xmath225 and hence all the @xmath226 are integers .",
    "assume that @xmath228 with @xmath229 .",
    "if @xmath204 , the projection formula applied to @xmath230 gives that @xmath231 .",
    "hence , @xmath232 is a curve going sharply through @xmath233 ( @xmath109 ) and missing all points in @xmath11 after @xmath13 , then @xmath234 it follows that @xmath235 and thus , @xmath236 for all @xmath204 .",
    "now , let @xmath64 be a curve going sharply through @xmath237 and missing those points of @xmath11 not contained in the underlying cluster of @xmath238 ( corollary 4.2.8 of @xcite ) .",
    "the strict transform @xmath239 cuts transversally each exceptional component @xmath240 at @xmath226 different points and goes through no singularity of @xmath6 .",
    "moreover , @xmath241 .    @xmath242 .",
    "since @xmath186 , we have @xmath243 for all @xmath109 , and hence , @xmath64 is defined by an element of @xmath244 . therefore , @xmath245 for all @xmath13 , and so @xmath246 on the other hand , since @xmath187 goes through no singularities of @xmath6 , the total transform of @xmath187 by @xmath83 has no exceptional part , and @xmath247 .",
    "thus , @xmath248 .",
    "now , if @xmath249 goes sharply through @xmath190 , @xmath250 and @xmath251 .",
    "assume that there exists @xmath252 so that @xmath190 has positive excess at it",
    ". then @xmath253 and by the equality ( [ for : excsing ] ) in page , there is some singularity @xmath84 in @xmath6 such that @xmath254 .",
    "moreover , @xmath255 goes through @xmath84 and @xmath256 where @xmath257 is a _ non - zero effective _ divisor .",
    "thus , @xmath258 against ( [ auxxcartier ] ) .",
    "therefore , @xmath190 has excess @xmath198 at every @xmath259 .",
    "assume that every dicritical point of @xmath190 is also dicritical for @xmath17 .",
    "let @xmath64 be a curve going sharply through @xmath190 and such that no points in @xmath261 belong to it . then , @xmath262 intersects no components @xmath57 with @xmath263 .",
    "since the direct image of @xmath262 by @xmath83 is the strict transform @xmath187 on @xmath6 , it follows that @xmath187 goes through no singularities of @xmath6 and is cartier . using that @xmath186 and that @xmath264 and @xmath217 are cartier divisors",
    ", we deduce that @xmath216 and @xmath184 are so .    _ primitive _ singularities are those singularities that can be obtained by blowing - up a simple complete ideal ( definition i.3.1 of @xcite ) . in this case ,",
    "[ cartier ] has a very easy formulation .",
    "let @xmath265 be a simple ideal and @xmath266 .",
    "if @xmath267 is a curve , @xmath184 is a cartier divisor on @xmath6 if and only if @xmath56 is a multiple of @xmath268 .",
    "moreover , @xmath269 is the minimal integer @xmath270 such that @xmath271 is a cartier divisor .",
    "it is clear that @xmath272 and @xmath273 . since @xmath274",
    ", we infer that @xmath275 if and only if @xmath276 .",
    "the second claim follows by direct computation .",
    "clearly , the question of whether @xmath184 on @xmath6 is cartier is local as it depends only on the existence of an equation for @xmath184 near the singularities of @xmath6 ( recall that every weil divisor on a neighbourhood of a regular point is principal , see @xcite ii.6.11 ) .",
    "if @xmath84 is in the exceptional locus of @xmath6 , we write @xmath277 for the set of points @xmath109 such that @xmath84 lies on @xmath278 .",
    "then , @xmath279 are the exceptional components going through @xmath84 . from [ cartier ]",
    ", we get the following local criterion .",
    "[ localcriterion ] let @xmath84 be a point in the exceptional locus of @xmath6 .",
    "if @xmath267 , denote by @xmath280 the curve on @xmath1 composed of the branches @xmath281 of @xmath7 whose strict transform @xmath282 on @xmath6 goes through @xmath84 .",
    "then , @xmath184 is locally principal in a neighbourhood of @xmath84 if and only if @xmath283    from the definition of @xmath280 the germs of @xmath184 and @xmath284 at @xmath84 are equal .",
    "moreover , @xmath84 is the unique point in the intersection of @xmath285 with the exceptional locus of @xmath6 .",
    "therefore , @xmath184 is locally principal near @xmath84 if and only if @xmath284 is cartier . by [ cartier",
    "] , this is the case if and only if @xmath286 . by [ intersect / strict ] , @xmath287_q>0 $ ] if @xmath288 and zero , otherwise . the claim follows .    from [ cartier ] and [ localcriterion ] , an algorithm providing a test to verify if the strict transform on @xmath6 of a given curve is cartier or locally principal at some point is deduced .",
    "if @xmath267 is a curve , then the cluster @xmath190 ( defined in [ cartier ] ) is consistent and equivalent to the ( weighted ) cluster @xmath289 defined by the system of virtual values given by @xmath290 in order to know the dicritical points of @xmath291 , it is enough to unload @xmath289 . by [ cartier ] , @xmath184 is cartier if and only if @xmath292 .",
    "to study the local principality of @xmath184 at some singularity @xmath84 , proceeding analogously with @xmath293 is enough .",
    "forthcoming [ ex:1 ] and [ ex:2 ] provide examples of this .",
    "a curve on @xmath6 containing no exceptional component is the strict transform of some curve on @xmath1 , so [ cartier ] actually gives criteria for the principality of any such curves .",
    "the principality of exceptional curves can be studied componentwise in terms of curves with no exceptional component , taking into account [ mumf ] : for and @xmath109 , write @xmath294 for a generic curve going sharply through @xmath233 and missing all points in @xmath11 after @xmath13 .",
    "then , the principality of a curve @xmath295 is equivalent to the principality of the strict transform on @xmath6 of @xmath296 , where @xmath297 and @xmath298 .",
    "indeed , the curves @xmath299 are defined in this way so that the equality @xmath300 holds , and we can apply [ mumf ] . now , if @xmath301 is cartier or not can be decided by using the equivalent assertions of [ cartier ] .",
    "given @xmath7 on @xmath1 , let @xmath302 be the branches of @xmath7 at @xmath0 and for each @xmath303 denote by @xmath304 the first non - singular point on @xmath305 and not in @xmath11 .",
    "write @xmath306 for the minimal cluster containing @xmath11 and the points @xmath307 .",
    "since the sheaf @xmath308 is invertible , there is a morphism @xmath309 induced by the universal property of the blowing - up .",
    "moreover , @xmath71 factors through @xmath310 because this is the minimal resolution of @xmath6 .",
    "since @xmath306 contains @xmath307 , the strict transform of @xmath7 on @xmath311 is non - singular , while the total transform has normal crossings only : @xmath312 \\ar @/^2pc/[rr]^{g } \\ar[rrd]_{\\pi_{k ' } } & s_k \\ar[r]^{f } \\ar[rd]^{\\pi_k } & { x } \\ar[d]^{\\pi_i } \\\\ & & { s } } \\ ] ]    _ remark on the notation .",
    "_ from now on , we are working on the surface @xmath311 rather that on @xmath61 .",
    "for the sake of simplicity in the notation , we will make a slight abuse of language and write @xmath313 for @xmath311 , @xmath314 and @xmath315 for the strict transform and the exceptional part of the total transform of @xmath184 on @xmath313 , and also @xmath316 and @xmath317 for the exceptional parts of @xmath106 and @xmath7 on @xmath313 , respectively .",
    "recall from [ cartier ] that @xmath318 and @xmath319 .    during the proof of [ cartier ]",
    "we have proved the following fact relating the coefficients of @xmath216 in the base @xmath320 to the intersection product of @xmath184 with @xmath321 .    * _ ( corollary of the proof of [ cartier ] ) _ * [ intersect / strict ] if @xmath322 , then @xmath323moreover , if @xmath184 is cartier , then @xmath324 is the ( zariski ) factorization of @xmath244 .",
    "in particular , @xmath325 .",
    "[ hypersharplycartier ] let @xmath326 be the ( zariski ) factorization of @xmath3 and let @xmath84 be a point in the exceptional locus of @xmath6 . if @xmath7 goes sharply through @xmath96 , then @xmath184 is cartier on @xmath6 and @xmath327 , for all @xmath109 .",
    "we already know that for such a curve @xmath7 , @xmath328 .",
    "then , it is enough to apply [ cartier ] and [ intersect / strict ] .",
    "the following proposition is technical and will be useful later on .    [ hil ]    * if @xmath184 is cartier , then @xmath329 . *",
    "if @xmath330 are curves on @xmath1 , then @xmath331_o-[{{\\mathcal q}}_{\\operatorname{\\scriptscriptstyle \\textit{c}}_1},c_2]_o.\\ ] ]    since @xmath332 and @xmath333 , we infer that @xmath334 let @xmath64 be a curve going sharply through @xmath291 and missing the points in @xmath335 .",
    "then , @xmath336 and @xmath187 goes through no singularities of @xmath6 and shares no points with @xmath184 .",
    "thus , @xmath337 and so , @xmath338 .",
    "( a ) follows from ( [ auxdc ] ) above .",
    "now , by the projection formula applied to @xmath339 , we have @xmath340 be a curve going sharply through @xmath341 and such that @xmath342 shares no point with @xmath343 on @xmath313 . then , @xmath344_o = [ b_1,c_2]_o=|(\\widetilde{b_1}+{{\\mathcal e}}_{{\\mathcal q}_{\\operatorname{\\scriptscriptstyle \\textit{c}}_1}})\\cdot \\widetilde{c_2}|_{s ' } = |{{\\mathcal e}}_{{\\mathcal q}_{\\operatorname{\\scriptscriptstyle \\textit{c}}_1}}\\cdot \\widetilde{c_2}|_{s'}\\end{aligned}\\ ] ] and @xmath345_o =    the claim of ( b ) is derived from ( [ astaux ] ) .    to close this section , we illustrate the results in it and in the previous one with some examples .",
    "[ ex:1 ] take @xmath37 with base points as on ( a ) of figure [ fig:1 ] .",
    "the dicritical points of @xmath38 are @xmath346 and @xmath347 and so , the surface @xmath5 has three exceptional components @xmath348 and @xmath349 .",
    "@xmath6 has two singularities : @xmath350 in the intersection of @xmath351 and @xmath352 , with @xmath353 and @xmath354 in the intersection of @xmath351 and @xmath349 , with @xmath355 .",
    "we have @xmath356 , @xmath357 and @xmath358",
    ". if @xmath7 is a curve on @xmath1 with singular points as represented on ( b ) of figure [ fig:1 ] , then @xmath359 . by [ cartier ] , @xmath184 is not a cartier divisor on @xmath6 .",
    "however , @xmath360 , so @xmath184 is principal in a neighborhood of @xmath350 , but not near @xmath354 ( see [ localcriterion ] ) .",
    "( a ) the enriques diagram of @xmath17 ; ( b ) the singular points of @xmath7 in bold ; ( c ) the enriques diagram of the cluster @xmath361 ( example [ ex:1 ] ) . ]    [ ex:2 ] let @xmath37 with base points as on ( a ) of figure [ fig:2 ] .",
    "the dicritical points of @xmath38 are @xmath362 and @xmath363 and so , the surface @xmath5 has exceptional components @xmath364 and @xmath365 .",
    "there is only one singularity on @xmath6 , say @xmath84 , and @xmath366 .",
    "( a ) the enriques diagrams of @xmath21 ; ( b ) the singular points of the curves @xmath7 ; ( c ) the singular points of @xmath77 ( example [ ex:2 ] ) . ]",
    "take the curves @xmath7 and @xmath77 having singularities as ( c ) and ( d ) of figure [ fig:2 ] .",
    "direct computation shows that @xmath367 , so @xmath184 is a cartier divisor on @xmath6 and @xmath368 , @xmath369 , @xmath370 and @xmath371 .",
    "the cluster @xmath190 is represented on ( b ) of figure [ fig:2 ] .",
    "we have that @xmath372_o=88 $ ] and @xmath373_o=82 $ ] .",
    "thus , in virtue of ( b ) of [ hil ] , @xmath374 .",
    "in this section , we are interested in studying the ( effective ) cartier divisors containing a given curve on @xmath6 . for the sake of simplicity in the exposition , we restrict our study to curves containing no exceptional components on @xmath6 and whose strict transform on @xmath313 is already non - singular . moreover",
    ", we add a minimality condition concerning the values of these curves relative to the divisorial valuations @xmath375 . to this aim , recall that if @xmath72 is a curve on @xmath6 , @xmath72 is a cartier divisor if and only if @xmath376 is a divisor on @xmath313 ( see [ mumf ] ) .",
    "when @xmath72 is not cartier , it is also possible to associate a divisor @xmath377 on @xmath313 to @xmath72 such that @xmath378and minimal with this property .",
    "this divisor @xmath379 can be easily computed by laufer s method ; moreover , @xmath72 is cartier if and only if @xmath380 ( see @xcite  1 for details ) .",
    "fix @xmath7 be a curve on @xmath1 .",
    "an effective cartier divisor @xmath381 containing @xmath184 will be called _ @xmath382-minimal _ ( relative to @xmath7 )",
    "if    * @xmath383 ; * the strict transform of @xmath381 on @xmath313 is non - singular and @xmath384 has normal crossings only ; * @xmath381 contains no exceptional components on @xmath6 .    by using partial unloading ( see appendix ) , we are going to construct flags of clusters that will allow us to give a complete description of the @xmath382-minimal cartier divisors containing @xmath184 .",
    "these flags will play a basic role in the forthcoming sections since , as it will be shown there , they carry deep information relative to @xmath184 .",
    "recall that @xmath306 is the minimal cluster containing @xmath11 and the first non - singular points @xmath304 of the branches of @xmath7 which are not in @xmath11 .",
    "fix non - negative integers @xmath385 , and write @xmath386 for the cluster whose underlying set of points is @xmath306 and whose excess at @xmath13 is @xmath387 if @xmath388 and @xmath198 , otherwise .",
    "take the sequence of clusters @xmath389 defined as follows : for @xmath390 , as far as there exists some @xmath304 such that @xmath391 , @xmath392 is the cluster obtained from @xmath393 by increasing its multiplicity at @xmath304 by one and performing partial unloading relative to the set @xmath394 . note that as long as there exists such a @xmath304 , @xmath395 , and moreover @xmath396 a flag of clusters as in ( [ cahin ] ) will be called a _",
    "flag for _ ( @xmath17,@xmath7 ) ( an _ @xmath397-flag _ if we want to precise the original excesses of @xmath398 ) . for simplicity in the notation and",
    "if no confussion may arise , we will write @xmath399 for the clusters appearing in such a flag .    [ finsteps ] after finitely many steps , this procedure stops giving rise to a cluster @xmath400 such that    * @xmath401 , for @xmath402 ; * @xmath403 , for @xmath404 .    and non - negative integers @xmath405 such that @xmath406 for @xmath109 .",
    "moreover , the number @xmath407 and the integers @xmath408 depend only on @xmath17 and the points @xmath409 , and not on @xmath397 .",
    "write @xmath410 .",
    "first of all , we show by using induction on @xmath411 that @xmath412 for every @xmath393 defined as above .",
    "this is clear for @xmath413 .",
    "assume it is also true for some @xmath390 . to prove that @xmath414 , it is enough to show that the virtual transform relative to the multiplicities of @xmath415 of a generic curve going through @xmath416 goes through the point @xmath304 .",
    "but this is clear since any curve going sharply through @xmath416 goes _ effectively _ through @xmath304 . because of ( [ sh ] ) , this procedure stops after finitely many steps .",
    "hence , we obtain a ( not necessarily consistent ) cluster @xmath400 such that @xmath417 notice by the way that @xmath407 is the codimension of @xmath400 in @xmath398 .",
    "now , assume that we have a couple of ( not necessarily consistent ) clusters @xmath418 and @xmath419 such that @xmath420 and @xmath421 for @xmath402 .",
    "define a new cluster @xmath422 as follows : take@xmath423 where @xmath424and define virtual multiplicities for @xmath306 by @xmath425where @xmath426 are the virtual multiplicities of @xmath416 . clearly , @xmath427 and @xmath428 for @xmath429 . since @xmath430 for any @xmath12",
    ", we have @xmath431 . by using artin s trick as in the proof of [ partunload ]",
    ", we see that @xmath432 for @xmath433 .",
    "this proves the uniqueness of a minimal cluster @xmath434 with @xmath435 and @xmath436 for @xmath402 , and shows actually that @xmath437 for @xmath402 . from the way the cluster @xmath400 has been constructed ,",
    "necessarily @xmath438 , and so @xmath400 does not depend on the choices done when constructing the flag ( [ cahin ] ) . in virtue of [ tech ] , if @xmath439 and @xmath440 , @xmath441 does not depend on the excesses @xmath442 . by induction ,",
    "the multiplicities @xmath443 do not depend on @xmath397 , and neither the difference @xmath444 .",
    "hence , the numbers @xmath445 ( @xmath109 ) are independent of @xmath446 and @xmath406 as claimed .",
    "[ turner ] notice that @xmath447 ( this meaning that @xmath448 ) if and only if all the clusters @xmath449 are consistent . in this case ,",
    "partial unloading relative to @xmath394 equals usual unloading .",
    "write @xmath450 for the cluster obtained by taking as virtual multiplicities the effective multiplicities of @xmath7 .",
    "if @xmath184 is already cartier , the integers @xmath451 given by [ finsteps ] equal the effective values @xmath452 .",
    "in fact , in this case we have that @xmath453 and @xmath454 .",
    "we state the following easy lemma for future reference .",
    "[ laia ] let @xmath447 and @xmath455 an @xmath397-flag for ( @xmath17,@xmath7 ) .",
    "for any curve @xmath64 on @xmath1 , we have that    * the value of @xmath456_o-[{{\\mathcal t}}_0,b]_o$ ] does not depend on @xmath397 .",
    "* if @xmath187 shares no points on @xmath6 with @xmath184 , @xmath456_o=[{{\\mathcal t}}_0,b]_o$ ] fopr any @xmath390 .",
    "in particular , @xmath457    if @xmath458 is a curve going sharply through @xmath393 , we have that @xmath459 .",
    "then , by the projection formula applied to @xmath230 , @xmath456_o=|(\\widetilde{c_j}+{{\\mathcal l}}_{\\mathbf{m}})\\cdot \\widetilde{b}|_x$ ] .",
    "the first claim follows immediately .",
    "now , notice that for a generic curve going through @xmath398 , @xmath460 .",
    "if @xmath187 shares no points on @xmath6 with @xmath184 and @xmath461 , then @xmath462 also .",
    "the second assertion is derived now from the first one and ( b ) of [ hil ] .",
    "the following proposition is the main result of this section and gives a complete description of the @xmath382-minimal cartier divisors containing @xmath184 .",
    "[ mincardiv ] take @xmath408 as in [ finsteps ] .    * if @xmath447 , the system of virtual multiplicities @xmath463 is consistent .",
    "* every @xmath382-minimal cartier divisor for @xmath184 has the form @xmath464 , where @xmath64 is a generic curve going through @xmath465 , for some @xmath466 .",
    "* @xmath467 , where @xmath468 is the number of unloadings performed on each @xmath469 .",
    "[ cartc2 ] after [ mincardiv ] , one should think of the strict transform of the generic curves going through @xmath470 ( for some @xmath466 ) as the curves to be added to @xmath184 to obtain ( @xmath382-minimal ) cartier divisors on @xmath6",
    ".    since @xmath447 , the cluster @xmath471 is consistent ( see [ turner ] ) , and from its construction , the points @xmath409 have virtual multiplicity one at it and are maximal in @xmath306 .",
    "it follows that @xmath472 for @xmath473 . on the other hand , from its own definition the cluster @xmath474 has excess equal to one at @xmath475 , and zero at the remaining points .",
    "since the excesses of @xmath476 are the difference between the excesses of @xmath471 and @xmath474 , we infer that @xmath477 is consistent .",
    "let @xmath72 be an effective cartier divisor on @xmath6 containing @xmath184 and without exceptional components .",
    "there exists some curve @xmath64 on @xmath1 such that @xmath72 is the strict transform of @xmath478 . by [ cartier ]",
    ", we have that @xmath479 write @xmath385 . by [ turner ]",
    ", we have that @xmath447 and so , the clusters in any @xmath397-flag @xmath480are consistent .",
    "now , @xmath481 goes through @xmath482 and @xmath483 for @xmath402 . by the minimality of @xmath484 ( see [ finsteps ] ) , it follows that @xmath481 goes through it .",
    "thus , @xmath481 goes virtually through @xmath485 and @xmath486 .",
    "hence , by ( a ) of [ hil ] , @xmath487and the equality holds if and only if @xmath481 goes through @xmath485 with effective multiplicities equal to the virtual ones .",
    "this is equivalent to say that the curve @xmath64 goes through @xmath488 with effective multiplicities equal to the virtual ones . by definition of the cluster @xmath306 ,",
    "@xmath489 intersects transversally the exceptional divisor of @xmath490 .",
    "therefore , the strict transform @xmath491 intersects transversally the exceptional divisor of @xmath490 if and only if for each @xmath433 , @xmath481 has @xmath492 branches through @xmath13 and misses all points after @xmath13 in @xmath306 .",
    "therefore , we see that @xmath72 is a @xmath382-minimal cartier divisor containing @xmath184 if and only if @xmath64 goes through @xmath470 with effective multiplicities equal to the virtual ones and has @xmath492 branches through @xmath13 and misses all points after @xmath13 in @xmath11 .",
    "this completes the proof of ( b ) .",
    "moreover , if @xmath72 is @xmath382-minimal , then @xmath493 and in particular , @xmath494 .",
    "now , from the definition of @xmath485 , we know that @xmath495 for every @xmath496 .",
    "therefore , @xmath497 is a dicritical point of @xmath485 if and only if @xmath498 for some @xmath303 . from its own definition",
    ", it follows that @xmath476 has no dicritical points out of @xmath11 .",
    "this gives ( c ) and completes the proof of the proposition .",
    "we finish with an example    [ ex:4 ] take @xmath37 as in example [ ex:2 ] . on ( a ) of figure [ fig:6 ] , the clusters @xmath398 and @xmath400 of a @xmath397-flag for ( @xmath17 , @xmath7 ) are represented .",
    "the excesses of @xmath400 at @xmath346 and @xmath347 are @xmath499 , @xmath500 , @xmath501 , and so , @xmath502 , @xmath503 and @xmath504 . by taking @xmath505 ,",
    "the virtual values of @xmath400 and @xmath398 are @xmath506 and @xmath507 . by [ mincardiv ] ,",
    "the @xmath382-minimal cartier divisors on @xmath6 containing @xmath184 are the curves @xmath464 , where @xmath64 is a generic curve going through @xmath488 . by ( b ) of [ mincardiv ] , @xmath508 , so @xmath509 .",
    "( a ) the enriques diagram of @xmath482 ; ( b ) the enriques diagram of @xmath485 ; ( c ) the enriques diagram of @xmath510 ( example [ ex:4 ] ) . ]",
    "for a given curve @xmath7 on @xmath1 , write @xmath511 and call this value the _ total order of singularity of @xmath184_. our aim in this section is to get some formulas for the order of singularity of curves on @xmath6 without exceptional support . then , we will use them to compute the semigroup of a branch going through a sandwiched singularity    [ delta / general ] let @xmath7 be a curve on @xmath1 and take a flag @xmath455 for @xmath512 . then",
    ", @xmath513_o-[{{\\mathcal t}}_0,c]_o- n.\\ ] ]    in virtue of [ laia ] the right term of the above equality does not depend on the particular flag @xmath455 chosen .    to prove this result we need a technical lemma .",
    "[ div / canonical ] let @xmath514 be a a consistent cluster , and write @xmath515 for the canonical divisor on the surface @xmath516 obtained by blowing up all the points of @xmath517 .",
    "if @xmath72 is a curve on @xmath1 and @xmath518 is the exceptional part of its total transform on @xmath516 , then @xmath519    the adjunction formula ( see @xcite v.1.5 ) says that @xmath520    write @xmath521 for the cluster obtained by taking @xmath522 as the system of virtual multiplicities .",
    "let @xmath523 be curves going sharply through @xmath238 and @xmath521 , respectively .",
    "direct computation using ( [ for : int / comp ] ) and that @xmath524 shows that @xmath525therefore , by the projection formula , @xmath526_o-[a , b]_o=-\\sum_{p\\in t}e_p(a),\\]]the last equality by noether s formula .",
    "proof of [ delta / general ] .",
    "write @xmath527 for the canonical divisor on @xmath313 for the sake of simplicity , write @xmath77 and @xmath528 for @xmath315 and @xmath529 , respectively .",
    "add the subindex @xmath84 to denote the exceptional part of @xmath77 and @xmath528 contracting to some @xmath99 . by corollary 2.1.2 .",
    "of @xcite , we have the following formula for the order of singularity of @xmath184 at @xmath84 : @xmath530 from this and the fact that @xmath531 and @xmath532 are disjoint if @xmath533 , we have @xmath534 thus , @xmath535 in virtue of ( b ) of [ mincardiv ] , @xmath536 .",
    "let @xmath64 be a curve going sharply through @xmath400 .",
    "then , @xmath187 is cartier on @xmath6 and by ( a ) of [ hil ] , @xmath537 . by the projection formula applied to @xmath490 , @xmath538 for any exceptional divisor @xmath539 being contracted by @xmath540 . therefore , we have @xmath541 now , since a generic curve through @xmath400 ( resp . through @xmath398 )",
    "goes sharply through it and shares no points with @xmath64 outside @xmath306 ( see theorem 4.2.8 of @xcite ) , we have that @xmath542_o-[{{\\mathcal t}}_n\\cdot b]_o.\\]]on the other hand , in virtue of ( [ for : delta ] ) , @xmath543from all of this , ( [ for : delta / general ] ) and the noether s formula ( see ( [ for : noether ] ) ) , we infer that @xmath544 the last equality because @xmath545 ( see ( b ) of [ hil ] ) .",
    "hence , @xmath546 on the other hand , since @xmath547 , the projection formulas for @xmath490 and @xmath548 say that @xmath549_o-[{{\\mathcal t}}_n , c]_o$ ] .",
    "the claim follows from ( [ for : delta ] ) .    from [ delta / general ]",
    "we deduce the following formula for the order of singularity of a cartier divisor on @xmath6 .",
    "[ delta ] if @xmath184 is a cartier divisor on @xmath6 and @xmath550 , we have that @xmath551    if @xmath184 is cartier , @xmath552 and @xmath553 ( see [ cartc2 ] ) .",
    "the strict transfrom of a generic curve @xmath64 going sharply through @xmath398 shares no points with @xmath184 on @xmath6 .",
    "therefore , by ( b ) of [ hil ] , we have @xmath554_o=[b,{{\\mathcal t}}_n]_o=[b,{{\\mathcal t}}_0]_o={{\\mathcal t}}_0 ^ 2\\]]thus , @xmath555_o=({{\\mathcal q}}'_{\\operatorname{\\scriptscriptstyle \\textit{c}}})^2 $ ] and also @xmath556_o={\\mathcal q}_{\\operatorname{\\scriptscriptstyle \\textit{c}}}^2 $ ] . using [ delta / general ] and the fact that @xmath557 , the first equality follows .",
    "the second follows by direct computation since by ( b ) of [ hil ] again , @xmath558 .",
    "let @xmath559 be the local ring of @xmath7 at @xmath0 and assume that @xmath184 is cartier .",
    "write @xmath560 for the points of @xmath184 in the exceptional locus of @xmath6 and @xmath561 for the ideal of @xmath184 in @xmath562 .",
    "clearly , we have a monomorphism @xmath563induced by the monomorphisms @xmath564 .",
    "then , the above corollary says that @xmath565 notice that if @xmath566 , @xmath567 is the ring of @xmath7 in the first neighbourhood of @xmath0 introduced by northcott ( see @xcite ) .",
    "then , [ delta ] says that @xmath568 which is known to be the variation in the order of singularity of @xmath7 after blowing up the point @xmath0 .",
    "[ ex:5 ] take the cluster and the curve @xmath7 of example [ ex:1 ] ( see figure [ fig:1 ] ) .",
    "we have that @xmath555_o=49 $ ] and @xmath556_o=42 $ ] .",
    "direct computation shows that @xmath569 .",
    "therefore , by [ delta / general ] , we obtain @xmath570 . since @xmath350 is the only singularity of @xmath184 , we derive that @xmath571 .",
    "let @xmath64 be a curve going sharply through @xmath572 and let @xmath478 .",
    "then , as noticed above , @xmath573 is cartier and @xmath574 . by [ delta ] , @xmath575 . in example [ ex:2 ] we have seen that @xmath184 is principal in a neighbourhood of @xmath350 , so the germs of @xmath184 and @xmath573 in a neighbourhood of @xmath350 are equal , and @xmath576 .",
    "therefore , @xmath577 .",
    "let @xmath7 be a branch on @xmath1 and let @xmath84 be the point where @xmath184 intersects the exceptional divisor of @xmath6 .",
    "here we show how the flags for @xmath512 already defined determine the semigroup of @xmath184 on @xmath68 .",
    "recall that since @xmath578 is analytically irreducible , the integral closure @xmath579 is a discrete valuation ring and the semigroup @xmath580 of @xmath184 at @xmath84 is @xmath581 where @xmath582 is the valuation corresponding to @xmath583 .",
    "it is also known that @xmath584 is the number of elements in @xmath585 ( see appendix of @xcite ) .",
    "the following proposition gives a description of @xmath580 in terms of differences of intersection multiplicities of curves at @xmath0 .",
    "[ semlemma]take a flag @xmath586 for @xmath512 , and for @xmath587 , write @xmath588_o-[{{\\mathcal t}}_0,c]_o.\\]]then , the integers @xmath589 are the first @xmath590 elements of the semigroup @xmath580 .",
    "moreover @xmath591 , the conductor of @xmath580 .    for each @xmath303",
    ", let @xmath592 be a curve going sharply through @xmath593 .",
    "then @xmath594 and so , the strict transform @xmath595 is a cartier divisor on @xmath6 .",
    "let @xmath596 be a local equation for @xmath595 near @xmath84 , and @xmath597 its class in @xmath598 .",
    "then , @xmath599_o-[{{\\mathcal t}}_0,c]_o= [ \\widetilde{c_i},\\widetilde{c}]_q = v_t(\\overline{g_i})\\ ] ] is an element in @xmath580 . on the other hand , @xmath600_o<[{{\\mathcal t}}_{i+1},c]_o$ ] for each @xmath303 . from this",
    "it follows that @xmath601 and @xmath602\\cap \\sigma_q(\\widetilde{c } ) \\geq n+1.\\end{aligned}\\ ] ] since @xmath584 is the number of elements in the complement of @xmath580 , [ delta / general ] implies that the above inequality is actually an equality .",
    "now , if @xmath603 , take a curve @xmath381 going sharply through @xmath400 and sharing exactly @xmath604_o-[{{\\mathcal t}}_n , c]_o$ ] points with @xmath7 outside @xmath605 . then , @xmath606 and so , @xmath607 is cartier ( see [ cartier ] ) . from noether s formula",
    ", we infer that @xmath608_o & = & \\sum_{p\\in k_c}e_p(c')e_p(c)+(j + [ { { \\mathcal t}}_0,c]_o-[{{\\mathcal t}}_n , c]_o ) = j + [ { { \\mathcal t}}_0,c]_o.\\end{aligned}\\]]hence , @xmath609_o-[{{\\mathcal t}}_n , c]_o= v_t(g')$ ] belongs to @xmath580 and so , @xmath610 .",
    "the above proposition provides an easy way to compute the semigroup of @xmath184 once a flag for @xmath512 has been computed : the differences @xmath611_o-[{{\\mathcal t}}_0,c]_o$ ] for @xmath612 provide the first elements of @xmath580 ; then add all the integers greater or equal than @xmath613 .",
    "the bound for the conductor of [ semlemma ] is far from being sharp , and in general the semigroup @xmath580 is not symmetric as shown in the following example ( so the curves @xmath184 needs not to be gorenstein , see @xcite for details ) .",
    "[ ex:6 ] take a cluster @xmath17 and a curve @xmath7 as shown in figure [ fig:7 ] . by means of the algorithm explained in section 5 ,",
    "we compute the clusters @xmath400 and @xmath398 for some @xmath397-flag for @xmath512 .",
    "the virtual multiplicities of @xmath400 and @xmath398 are respectively , @xmath614 , @xmath615 .",
    "the cluster @xmath400 is shown on ( c ) of figure [ fig:7 ] .",
    "then , @xmath616_o=176 $ ] and @xmath617_o=105 $ ] . also , we have @xmath618 .",
    "thus , by [ delta / general ] , @xmath619_o-[{{\\mathcal t}}^{\\mathbf{m}}_0,c]_o- \\dim_{\\mathbb{c}}(\\frac{h_{{{\\mathcal t}}_0}}{h_{{{\\mathcal t}}_n } } ) = 176 - 105 - 41=30 $ ] .",
    "( a ) the enriques diagram of @xmath17 ; ( b ) the singular points of @xmath7 are represented in bold ; ( c ) the enriques diagram of @xmath620 ( example [ ex:6 ] ) . ]    in virtue of [ semlemma ] , we see that @xmath621 therefore , the conductor of the semigroup is @xmath622 .",
    "note that the semigroup is not symmetric ( see figure [ fig:7 ] ) so , the curve @xmath184 is not gorenstein ( see @xcite ; see also @xcite ) .",
    "the goal is to describe a slight modification of the unloading procedure that we call _ partial unloading_. partial unloading has been used in section 5 , but it is explained separately for clarity and because it may be useful in any other context where precise control of unloading is needed .",
    "the main virtue of partial unloading is that , fixed a non - consitent cluster @xmath17 it gives rise to an equivalent cluster , with no variation of the virtual values at some prefixed points and with non - negative excesses at the remaining points .",
    "first of all , we introduce a partial order in the set of weighted ( not necessarily consistent ) clusters : if @xmath623 and @xmath624 are weighted clusters , we can assume that they have the same set of points .",
    "then , if @xmath625 and @xmath626 , we write @xmath627 to mean that @xmath628 , for each @xmath629 .",
    "we denote by @xmath54 the _ intersection matrix _ of @xmath118 , where @xmath55 is the _ proximity matrix _ of @xmath11 .          put @xmath638 and , inductively ,",
    "as far as @xmath639 has negative excess at some point @xmath633 , define @xmath640 from @xmath639 by unloading on @xmath13 .",
    "we claim that there is an @xmath270 such that @xmath641 has non - negative excess at each point in @xmath642 , and @xmath643 if @xmath635 . to show this",
    ", note that the steps of the above procedure are part of an unloading sequence giving rise to a consistent cluster as described in theorem 4.6.2 of @xcite .",
    "we reach this cluster after finitely many steps , independently on the order of the unloadings performed . hence , after finitely many steps we reach a cluster @xmath644 satisfying the condition ( i ) .",
    "the condition ( ii ) is clear , because no unloading is performed on any point of @xmath645 .",
    "now , assume that @xmath646 and @xmath647 are equivalent to @xmath17 and verify the conditions ( i ) and ( ii ) .",
    "then , for @xmath648 and for every @xmath12 , @xmath649 put @xmath650 the cluster defined by taking virtual values @xmath651 for every @xmath12 . since @xmath652 , @xmath653 is equivalent to @xmath17 . for @xmath12 ,",
    "write @xmath654 . then ,",
    "if @xmath633 and say @xmath655 , we have ( artin s trick : see lemma 1.3 @xcite ) @xmath656 the last inequality by assumption . moreover , if @xmath635 , then @xmath657 , so @xmath653 verifies the conditions ( i ) and ( ii ) . from this , the last assertion follows .    in practice ,",
    "@xmath637 is computed by performing usual unloading on the points not in @xmath645 with negative excess , so we say that it is obtained from @xmath17 by _ partial unloading ( relative to @xmath645)_. note that if @xmath658 , partial unloading equals usual unloading .",
    "the following lemma shows that the variation of the excesses from @xmath17 to @xmath637 ( also , of the virtual multiplicities and values ) is independent of the excesses of @xmath17 in the points of @xmath645 .",
    "recall that @xmath659 , where @xmath660 has non - negative entries and @xmath661 if and only if @xmath17 is consistent .    [ tech ] let @xmath11 be a cluster and @xmath630 a proper subset .",
    "let @xmath662 be clusters with @xmath663 for each @xmath633 .",
    "write @xmath664 for the cluster obtained from @xmath665 by partial unloading relative to @xmath645",
    ". then , there exists non - negative integers @xmath666 such that @xmath667 if @xmath633 and for @xmath648 @xmath668    by definition of partial unloading , we have @xmath669 where the entries of @xmath670 are non - negative and @xmath671 if @xmath635 .",
    "take @xmath672 , @xmath673 , and write @xmath674 for the cluster with set of points @xmath11 and system of values given by @xmath675 .",
    "i claim that @xmath674 satisfies the conditions ( i ) and ( ii ) of [ partunload ] .",
    "if @xmath635 , we have that @xmath676 .",
    "thus , @xmath677 and the condition ( ii ) follows . for the condition ( i ) , assume that @xmath633 and take @xmath678 such that @xmath679",
    ". then , @xmath680 hence , @xmath681 the last inequality by definition of @xmath682 . by the minimality of @xmath664",
    ", we deduce that @xmath683 and therefore , @xmath684 for each @xmath12 .",
    "in particular , for every @xmath12 , @xmath685 .",
    "now , if we write @xmath686 , we have that for @xmath648 , @xmath687 moreover , since @xmath688 , we infer that @xmath689.now , if @xmath690 , @xmath691 and so , we have @xmath692 . since the excess of @xmath664 at @xmath13 is non - negative , it is clear that @xmath693 . on the other hand ,",
    "if @xmath635 , we have @xmath694 and @xmath695 .    in the study of the principality of curves on a sandwiched surface ,",
    "partial unloding is specially useful because of [ cartier ] . keeping the notation already used ,",
    "assume that we want to prove the existence of some cartier divisors on @xmath5 satisfying some prefixed properties , or even , we want to construct them .",
    "the general sketch of the procedure is the following : write @xmath43 for the cluster @xmath696 and take @xmath697 , where @xmath387 are integers to be determined",
    ". add convenient extra conditions to @xmath386 ( i.e. extra points with virtual multiplicity one ) in order to force the curves going through the obtained cluster to have the desired properties and perform partial unloading relative to @xmath394 . after repeating this procedure a number of times ,",
    "a new cluster @xmath698 with non - negative excesses at the points of @xmath699 is obtained . moreover , for @xmath109      since @xmath702 is independent of @xmath397 , @xmath703 is consistent if we take the @xmath387 big enough .",
    "the curves going sharply through it will verify the prefixed conditions .",
    "the local principality of the strict transform on @xmath6 of generic curves going through this cluster follows from the condition ( ii ) together with [ cartier ] .",
    "m.  morales , _ calcul de quelques invariants des singularits de surface normale _ , knots , braids and singularities ( plans - sur - bex , 1982 ) , monogr .",
    "31 , enseignement math . ,",
    "geneva , 1983 , pp .",
    "191203 .",
    "o.  zariski , _ le problme des",
    "modules pour les branches planes _ , second ed . ,",
    "hermann , paris , 1986 , course given at the centre de mathmatiques de lcole polytechnique , paris , october ",
    "november 1973 , with an appendix by bernard teissier ."
  ],
  "abstract_text": [
    "<S> fixed a point @xmath0 on a non - singular surface @xmath1 and a complete @xmath2-primary ideal @xmath3 in @xmath4 , the curves on the surface @xmath5 obtained by blowing - up @xmath3 are studied in terms of the base points of @xmath3 . </S>",
    "<S> criteria for the principality of these curves are obtained . </S>",
    "<S> new formulas for their multiplicity , intersection numbers and order of singularity at the singularities of @xmath6 are given . </S>",
    "<S> the semigroup of branches going through a sandwiched singularity is effectively determined , too . </S>"
  ]
}