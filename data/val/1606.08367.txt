{
  "article_text": [
    "relaying systems achieve higher spectral efficiency than one - way relaying systems . in two - way relay channel ( twrc ) , two source nodes exchange messages with each other via a relay , using various multiple access broadcast ( mabc ) protocols consisting of the multiple access ( mac ) phase and the broadcast ( bc ) phase @xcite .",
    "basically , in the mac phase , two source nodes simultaneously send their signals to the relay node , and then the relay node amplifies and forwards the signal received in the mac phase to the two source nodes in the bc phase . with a prior knowledge of its own transmitted signal ,",
    "each source node is able to cancel the propagated self - interference ( si ) back to it and decode the desired signal .",
    "because full - duplex ( fd ) systems allow concurrent transmission and reception in the same frequency band , they usually achieve higher spectral efficiency than half - duplex ( hd ) systems only if the loopback si due to the concurrent transmission and reception is properly suppressed . using a circulator which connects antenna to transceiver",
    ", a single antenna can be shared between the transmitter and the receiver in fd systems .",
    "the merits of fd systems and two - way relaying systems in terms spectral efficiency motivated two - way relaying with a fd relay which outperforms both two - way relaying with a hd relay and one - way relaying with a fd relay . in @xcite , the two - way fd amplify - and - forward ( af ) relay systems with two sources and one relay with a single antenna each were studied . power allocation to maximize the achievable rate",
    "was explored in @xcite but residual si at each node was not considered assuming perfect si suppression . however , given loopback channel estimation errors and limitation of analog - to - digital converter ( adc ) in practical environments , the assumption of perfect si suppression is too ideal to evaluate practical gains of two - way fd relaying .",
    "contrary to @xcite , power allocation addressing residual si due to imperfect si cancelation was investigated under a sum power constraint in @xcite . to maximize the sum rate in the presence of residual si , power allocation under individual power constraints and relay mode selection , among one - way hd , two - way hd , one - way fd , and two - way fd ,",
    "were proposed in @xcite . as another performance metric in the presence of residual si , in @xcite , the outage probability of the two - way fd af relay system was derived . the application of physical layer network coding to the two - way fd af relay was investigated in terms of bit error rate @xcite when there exists residual si .",
    "a two - way fd af relay system with multiple relays was addressed in @xcite and an optimal relay selection scheme was proposed considering residual si .",
    "although residual si severely hurts the merit of fd , addressing the residual si only with single antenna at a fd af relay has limitations . on the other hand ,",
    "beamforming with multiple antennas enables to suppress the residual si , which motivated the study of a two - way fd af relay system with a relay having multiple antennas .",
    "however , to the authors best knowledge , there are only few studies on the two - way fd af relay system with multiple antennas . in @xcite , a two - way fd af relay system with multiple antennas",
    "was studied , where two sources have a single antenna each and the relay has multiple antennas . to maximize the achievable sum rate ,",
    "beamforming at relay and power allocation at sources were jointly optimized with a zero forcing ( zf ) constraint such that the residual loopback si is perfectly canceled at the relay .",
    "however , a closed form solution was not available and thus an iterative algorithm was proposed in @xcite .",
    "contrary to the beamforming matrix which perfectly cancel out the residual si with a zf constraint , beamforming at a fd relay is required to balance between the residual si suppression and the desired signal transmission . in this context , in a two - way fd af relay system with multiple antennas with circulator at the relay as well as the two sources , we design the beamforming matrix balancing them in terms of minimum mean square error ( mmse ) under a power constraint at the relay . because multiple antennas at the two sources are considered unlike @xcite , the beamforming matrix also need to be designed to address the inter - stream interference in the multi - input multi - output ( mimo ) channels . moreover , to optimally balance the residual si suppression and the desired signal transmission , the beamforming matrix should be updated every time slot because the residual si in the previous time slot is amplified by the current beamforming matrix and added to the received signals from the two sources in the current time slot .    in this paper , we analytically identify this coupled effect and show that the optimal beamforming matrix at each time slot is determined as a function of not only the current channels but also all the channels in the past time slots from the first transmission time slot .",
    "using the lagrangian method , we derive the optimized relay beamforming matrix and receive beamforming matrices at sources in closed form . to account for beamforming design with limited memory , we also propose a beamforming method using the channels in a limited number of the latest time slots , not from the first time slot , and show that the performance degradation is marginal relative to the beamforming method based on all the channel matrices from the first time slot to the current time slot . finally , from our numerical results , we identify the signal - to - noise ratio ( snr ) and interference - to - noise ratio ( inr ) region where the achievable sum rate of the proposed scheme is greater than that of the hd system . based on this result",
    ", we propose a duplex mode selection scheme in terms of achievable sum rate according to snr and inr .",
    "the rest of this paper is organized as follows .",
    "section ii describes the system model . in section iii",
    ", we derive the optimal beamforming matrix in terms of mmse and explore beamforming matrix design with limited memory size . in section iv , we present numerical results .",
    "finally , conclusions are drawn in section v.    _ notations _ : matrices and vectors are denoted , respectively , by uppercase and lowercase boldface characters ( e.g. , * a * and * a * ) .",
    "the transpose , hermitian , and inverse of * a * are denoted , respectively , by @xmath1 , @xmath2 , and @xmath3 .",
    "an @xmath4 identity matrix and @xmath4 matrix consisting of all zero entries are denoted , respectively , by @xmath5 and @xmath6 .",
    "the operators @xmath7 $ ] , @xmath8 , @xmath9 , @xmath10 , @xmath11 , @xmath12 , and @xmath13 indicate the expectation , trace of a matrix , determinant of a matrix , matrix vectorization , inverse operation of @xmath10 , kronecker product , and sequence product operators , respectively .",
    "notations @xmath14 and @xmath15 denotes 2-norm of * a * and the frobenius norm of * a * , respectively .",
    "[ t ! ] .,title=\"fig:\",width=529 ]    as shown in fig .",
    "[ fig_system ] , consider a two - way fd af relaying system consisting of two source nodes @xmath16 and @xmath17 with @xmath18 antennas , and one relay node @xmath19 with @xmath20 antennas , where all nodes operate in the fd mode . in time",
    "slot 0 , the two sources transmit their signals to the relay simultaneously . in time",
    "slot 1 , the relay forwards its received signal after multiplying it by a beamforming matrix to the source nodes and two source nodes transmit their next signals to the relay at the same time . in this manner ,",
    "the two source nodes repeatedly exchange their information with each other via relay . in the @xmath21th time slot ,",
    "source 1 , source 2 , and the relay transmit their signals @xmath22 , @xmath23 , and @xmath24 , respectively , of which covariance matrices are given by @xmath25=p_i\\textbf{i}_{n_s}$ ] for @xmath26 and @xmath27=p_r\\textbf{i}_{n_r}$ ] .",
    "the noise signals at source @xmath28 , source @xmath29 , and the relay are denoted as @xmath30 for @xmath26 and @xmath31 , respectively , and are assumed to be zero - mean white gaussian noise ( awgn ) with @xmath32=\\sigma_{n , i}^2\\textbf{i}_{n_s}$ ] for @xmath26 and @xmath33=\\sigma_{n , r}^2\\textbf{i}_{n_r}$ ] .",
    "the channel links are modeled as independent and frequency - flat fading channels and assumed to be static in each time slot . in time",
    "slot @xmath21 , the channel matrices between source @xmath28 and the relay , source @xmath29 and the relay , the relay and source @xmath28 , and the relay and source @xmath29 are represented as @xmath34 and @xmath35 , respectively . also , the loopback channel matrices at source 1 , source 2 , and the relay are represented as @xmath36 for @xmath26 and @xmath37 , respectively .",
    "the channel state information ( csi ) of the loopback channels is assumed to be imperfect due to channel estimation errors , whereas , to focus only on the residual loopback si related to full - duplex operation , csi between two nodes is assumed to be perfectly known at each node .",
    "since each node knows its own transmitted signals and perfect csi between two nodes , the backward propagated si can be canceled perfectly . however , due to imperfect csi of the loopback channels , each node can not perfectly cancel their loopback si .",
    "in a fd relay system , a loopback channel exists at each node .",
    "the imperfect loopback channel estimation results in loopback si , but the imperfect backward channel ( i.e. , channel between two sources via relay ) estimation errors are not related to loopback si . to focus on the effect of loopback si in fd relay systems",
    ", we consider imperfect loopback channel estimation but perfect backward channel estimation is assumed .",
    "moreover , as the number of involved time slots increase , the impact of the loopback channel estimation errors dominates that of the backward channel estimation errors .",
    "the relationship between the exact channel and the estimated channel is modeled as @xmath38 for @xmath39 , where @xmath40 for @xmath41 and @xmath42 are the estimated channel matrices , and @xmath43 and @xmath44 are channel estimation error matrices . it is assumed that @xmath45 is gaussian distributed with zero mean , and @xmath46=\\sigma_{e , j}^2\\textbf{i}_{n_s^2}$ ] and @xmath47=\\sigma_{e , r}^2\\textbf{i}_{n_r^2}$ ] .",
    "also , @xmath45 for @xmath48 are independent of each other .",
    "the transmission process starts from time slot 0 , so the sources transmit their signals but the relay do not in time slot 0 . because the relay starts transmitting from time slot 1 , fd operation substantially starts from time slot 1 . in time",
    "slot @xmath49 , the two source nodes simultaneously broadcast their signals @xmath50 and @xmath51 to the relay and then the received signal @xmath52 at the relay becomes @xmath53 in time slot @xmath28 , the relay forwards its received signal to the source nodes after multiplying it by a relay beamforming matrix @xmath54 and then the transmit signal @xmath55 at the relay is represented as @xmath56 of which transmit power is given by @xmath57=n_rp_r$ ] . with imperfect loopback si cancellation , the received signal at the relay in time slot @xmath28 is given by @xmath58 substituting into leads to @xmath59    at source @xmath60 in time slot @xmath28 , subtracting the propagated si back to the source node @xmath61 , and the loopback si @xmath62 , the received signal at source @xmath60 is given by @xmath63 where @xmath64 means the index of the other source ( i.e. , @xmath65 if @xmath66 and @xmath67 if @xmath68 ) . source @xmath60 multiplies @xmath69 by a receive beamforming matrix @xmath70 .    accordingly , considering imperfect loopback si cancellation , the received signal at the relay in time slot @xmath71 ( @xmath72 ) is given by @xmath73 which shows that the current received signal is affected by the beamforming matrices in the past time slots . in time",
    "slot @xmath21 , the forwarded signal from the relay to the source nodes is given by @xmath74 where @xmath75 is the relay beamforming matrix at time slot @xmath21 and @xmath24 .",
    "subtracting the propagated si back to the source node @xmath76 and the loopback si @xmath77 , the received signal at source @xmath60 in time slot @xmath21 ( @xmath72 ) is obtained as @xmath78 after subtracting si , source @xmath60 multiplies @xmath79 by a receive beamforming matrix @xmath80 .",
    "the problem for joint design of relay beamforming matrices and source receive beamforming matrices is non - convex and basically intractable .",
    "therefore , we propose an iterative algorithm which decouples the primal problem into two subproblems and solve them alternately ; one is for relay beamforming design and the other is for receive beamforming design at sources .    as identified in , the current received signal is a function of the beamforming matrices , the channel estimation error matrices , and transmitted signals at source in the past time slots , which implies that to optimally balance the residual si suppression and the desired signal transmission , the beamforming matrix should be updated every time slot . without loss of generality ,",
    "we design the relay beamforming matrix based on the @xmath0 latest time slots ; if @xmath81 , the beamforming matrix in time slot @xmath21 is based on all the time slots from the first time slot .",
    "otherwise if @xmath82 , the beamforming design corresponds to the scenario when the memory size at the relay is limited .",
    "unlike one - way relay systems , transmitted signals at each source during the past time slots become interference signals at each source in the current time slot in two - way relay systems . in addition , the relay transmits the received noise signals during the past time slots to the sources .",
    "therefore , the minimum mean square error ( mmse ) criterion is an effective metric enabling a compromise between interference suppression and noise reduction .",
    "moreover , the mmse criterion allows tractable analysis and optimization of the two - way fd af relay system . for similar reasons ,",
    "mean square error ( mse ) has been popularly used for beamforming design in two - way relay systems in the literature such as @xcite .    to balance the residual si suppression and the desired signal transmission , the relay beamforming matrix @xmath83 and receive beamforming matrices @xmath84 for @xmath26 in time slot @xmath85",
    "are determined based on the mse criterion under a transmit power constraint at the relay .",
    "the corresponding optimization problem is formulated as @xmath86 = n_rp_r \\label{}\\end{aligned}\\ ] ] where the sum of mse @xmath87 is defined as @xmath88 + \\mathbb{e}\\big[||\\textbf{x}_1^{(t-1)}- \\alpha^{(t)^{-1}}\\textbf{r}_2^{(t)^h}\\hat{\\textbf{y}}_2^{(t ) } ||^2 \\big ] \\label{}\\end{aligned}\\ ] ] and @xmath89 is a positive scaling factor .",
    "note that @xmath79 is multiplied by the positive scaling factor @xmath89 since the relay beamforming matrix @xmath83 is split into two components , as in @xcite , such that @xmath90 to facilitate the derivation of a closed form solution , where @xmath91 and thus @xmath92 and @xmath93 represent power amplification and steering directions , respectively .",
    "the lagrangian of the optimization problem is defined as @xmath94-n_rp_r)\\\\   & = n_s(p_1+p_2 ) - \\alpha^{(t)^{-1 } } \\",
    "{ \\text{tr}(\\textbf{w}_{f,0}^{(t)^h}\\textbf{f}^{(t ) } ) + \\text{tr}(\\textbf{w}_{f,0}^{(t)}\\textbf{f}^{(t)^h } ) \\ } \\\\ & \\quad+ \\alpha^{(t)^{-2 } } \\ { \\mathbb{e}\\big[|| \\textbf{r}_1^{(t)^h}\\hat{\\textbf{y}}_1^{(t ) } ||^{2}\\big ] + \\mathbb{e}\\big[|| \\textbf{r}_2^{(t)^h}\\hat{\\textbf{y}}_2^{(t ) } ||^{2}\\big ] \\ } + \\lambda^{(t)}(\\mathbb{e}\\big[||\\textbf{x}_r^{(t)}||^{2}\\big]-n_rp_r ) , \\label{l22 } \\end{split}\\ ] ] where @xmath95 is a lagrangian multiplier in time slot @xmath21 , @xmath96 ,    @xmath97 & = \\mathbb{e } \\big [ \\text{tr } \\big\\ { \\textbf{r}_1^{(t)^h}\\textbf{h}_{r,1}^{(t)}\\textbf{f}^{(t ) } ( \\textbf{g}_0^{(t ) } + p_2\\textbf{h}_{2,r}^{(t-1)}\\textbf{h}_{2,r}^{(t-1)^h } + \\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h}\\textbf{h}_{r,1}^{(t)^h}\\textbf{r}_1^{(t ) } \\big\\ } \\big ] \\\\ & + p_1 \\mathbb{e } \\big [ \\text{tr } ( \\textbf{r}_1^{(t)^h}\\boldsymbol{\\delta}_{1,1}^{(t)}\\boldsymbol{\\delta}_{1,1}^{(t)^h}\\textbf{r}_1^{(t ) } ) \\big ] + \\sigma_{n,1}^2\\text{tr}(\\textbf{r}_1^{(t)^h}\\textbf{r}_1^{(t ) } ) , \\\\ \\mathbb{e}\\big[|| \\textbf{r}_2^{(t)^h}\\hat{\\textbf{y}}_2^{(t ) } ||^{2}\\big ] & = \\mathbb{e}\\big [ \\text{tr } \\big\\ { \\textbf{r}_2^{(t)^h}\\textbf{h}_{r,2}^{(t)}\\textbf{f}^{(t ) } ( \\textbf{g}_0^{(t ) } + p_1\\textbf{h}_{1,r}^{(t-1)}\\textbf{h}_{1,r}^{(t-1)^h } + \\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h}\\textbf{h}_{r,2}^{(t)^h}\\textbf{r}_2^{(t ) } \\big\\ } \\big ] \\\\ & + p_2 \\mathbb{e } \\big [ \\text{tr } ( \\textbf{r}_2^{(t)^h}\\boldsymbol{\\delta}_{2,2}^{(t)}\\boldsymbol{\\delta}_{2,2}^{(t)^h}\\textbf{r}_2^{(t ) } ) \\big ] + \\sigma_{n,2}^2\\text{tr}(\\textbf{r}_2^{(t)^h}\\textbf{r}_2^{(t ) } ) , \\\\",
    "\\mathbb{e}\\big[|| \\textbf{x}_r^{(t ) } ||^{2}\\big ] & = \\mathbb{e}\\big [ \\text{tr } \\big\\ { \\textbf{f}^{(t ) } ( \\textbf{g}_0^{(t ) } + p_1\\textbf{h}_{1,r}^{(t-1)}\\textbf{h}_{1,r}^{(t-1)^h } + p_2\\textbf{h}_{2,r}^{(t-1)}\\textbf{h}_{2,r}^{(t-1)^h } + \\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h}\\big\\ } \\big ] , \\label{exp_y1_y2_xr } \\end{split}\\ ] ]    where @xmath98 , @xmath99 note that @xmath0 is the number of past time slots considered in the beamforming matrix design and the expectations in are with respect to @xmath45 for @xmath100 .",
    "let @xmath101 be an @xmath4 random matrix with @xmath102=\\sigma^2\\textbf{i}_{n^2}$ ] and @xmath101 for @xmath103 are independent of each other .",
    "@xmath104 =   ( \\sigma^2)^{v-1 } \\prod_{j=1}^{v}\\text{tr}(\\textbf{v}_j\\textbf{v}_j^h ) \\ \\text{for } \\ v \\geq 2 .",
    "\\label{lemma_1}\\end{aligned}\\ ] ]    we prove this by induction . from _",
    "lemma i _ in @xcite , holds for @xmath105 .",
    "that is , @xmath106 = \\sigma^2\\text{tr}(\\textbf{v}_1\\textbf{v}_1^h)\\text{tr}(\\textbf{v}_2\\textbf{v}_2^h).$ ] assume holds when @xmath107 and then we prove that it also holds when @xmath108 .    when @xmath108 , the left hand side of is rewritten as @xmath109\\label{lemma_proof_1}\\\\ & \\overset{(b)}{=}\\mathbb{e}\\bigg [ \\text{vec}(\\boldsymbol{\\delta}_{k-1})^h \\bigg\\ { \\bigg ( \\textbf{v}_{k-1 } \\prod_{j=1}^{k-2 } ( \\boldsymbol{\\delta}_{k-1-j}\\textbf{v}_{k-1-j } ) \\prod_{j=1}^{k-2 } ( \\textbf{v}_j^h\\boldsymbol{\\delta}_j^h ) \\textbf{v}_{k-1}^h",
    "\\bigg)^t \\otimes ( \\textbf{v}_k^h\\textbf{v}_k ) \\bigg\\ } \\text{vec}(\\boldsymbol{\\delta}_{k-1 } ) \\bigg]\\label{lemma_proof_2}\\\\ & \\overset{(c)}{= } \\text{tr}\\left ( \\mathbb{e}\\bigg [ \\text{vec}(\\boldsymbol{\\delta}_{k-1})^h \\bigg\\ { \\bigg ( \\textbf{v}_{k-1 } \\prod_{j=1}^{k-2 } ( \\boldsymbol{\\delta}_{k-1-j}\\textbf{v}_{k-1-j } ) \\prod_{j=1}^{k-2 } ( \\textbf{v}_j^h\\boldsymbol{\\delta}_j^h ) \\textbf{v}_{k-1}^h",
    "\\bigg)^t \\otimes ( \\textbf{v}_k^h\\textbf{v}_k ) \\bigg\\ } \\text{vec}(\\boldsymbol{\\delta}_{k-1 } ) \\bigg]\\right)\\\\ & \\overset{(d)}{=}\\text{tr } \\bigg\\ { \\mathbb{e}\\bigg [ \\bigg ( \\textbf{v}_{k-1 } \\prod_{j=1}^{k-2 } ( \\boldsymbol{\\delta}_{k-1-j}\\textbf{v}_{k-1-j } ) \\prod_{j=1}^{k-2 } ( \\textbf{v}_j^h\\boldsymbol{\\delta}_j^h ) \\textbf{v}_{k-1}^h",
    "\\bigg)^t \\otimes ( \\textbf{v}_k^h\\textbf{v}_k ) \\bigg ] \\mathbb{e}\\bigg [ \\text{vec}(\\boldsymbol{\\delta}_{k-1 } ) \\text{vec}(\\boldsymbol{\\delta}_{k-1})^h \\bigg ] \\bigg\\ } \\label{lemma_proof_3}\\\\ & \\overset{(e)}{=}\\sigma^2\\text{tr}(\\textbf{v}_k\\textbf{v}_k^h ) \\mathbb{e}\\bigg [ \\text{tr } \\bigg\\ { \\textbf{v}_{k-1 } \\prod_{j=1}^{k-2 } ( \\boldsymbol{\\delta}_{k-1-j}\\textbf{v}_{k-1-j } ) \\prod_{j=1}^{k-2 } ( \\textbf{v}_j^h\\boldsymbol{\\delta}_j^h ) \\textbf{v}_{k-1}^h \\bigg\\ } \\bigg ] \\label{lemma_proof_4}\\end{aligned}\\ ] ] where ( a ) is due to @xmath110 ; ( b ) is due to @xmath111 ; ( c ) is because @xmath112 when @xmath113 is a constant ; ( d ) follows from @xmath114)=\\mathbb{e}[\\text{tr}(\\textbf{a})]$ ] , @xmath110 , and independence of @xmath101 ; ( e ) holds because @xmath114)=\\mathbb{e}[\\text{tr}(\\textbf{a})]$ ] , @xmath115=\\sigma^2\\textbf{i}_{n^2}$ ] , @xmath116 , and @xmath117 .",
    "finally , using the induction hypothesis that holds for @xmath118 , becomes @xmath119    _ remark : _ _ lemma 1 _ provides a mathematical tool to reach the main result .",
    "specifically , to calculate mse , the expectations on the received signals have to be calculated and _ lemma 1 _ enables to calculate the expectations since the received signals are constituted by the product of unknown random matrices ( i.e. , channel estimation error matrices ) and known deterministic matrices ( i.e. , channel matrices and relay beamforming matrices ) in rotation , which is the form in _",
    "lemma 1_. consequently , _ lemma 1 _ can be applied to the system design in which the received signal is presented by the product of random matrices and deterministic matrices in rotation .    using _",
    "lemma 1 _ , @xmath120 $ ] , @xmath121 $ ] , and @xmath122 $ ] are obtained , respectively , as @xmath123 & = \\text{tr } \\big\\ { \\textbf{h}_{r,1}^{(t)^h}\\textbf{r}_1^{(t)}\\textbf{r}_1^{(t)^h}\\textbf{h}_{r,1}^{(t)}\\textbf{f}^{(t ) } ( \\textbf{g}_c^{(t ) } + p_2\\textbf{h}_{2,r}^{(t-1)}\\textbf{h}_{2,r}^{(t-1)^h}+\\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h } \\big\\ } \\\\ & + ( n_sp_1\\sigma_{e,1}^2 + \\sigma_{n,1}^2)\\text{tr}(\\textbf{r}_1^{(t)^h}\\textbf{r}_1^{(t ) } ) , \\\\",
    "\\mathbb{e}\\big[|| \\textbf{r}_2^{(t)}\\hat{\\textbf{y}}_2^{(t ) } ||^{2}\\big ] & = \\text{tr } \\big\\ { \\textbf{h}_{r,2}^{(t)^h}\\textbf{r}_2^{(t)}\\textbf{r}_2^{(t)^h}\\textbf{h}_{r,2}^{(t)}\\textbf{f}^{(t ) } ( \\textbf{g}_c^{(t ) } + p_1\\textbf{h}_{1,r}^{(t-1)}\\textbf{h}_{1,r}^{(t-1)^h}+\\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h } \\big\\ } \\\\ & + ( n_sp_2\\sigma_{e,2}^2 + \\sigma_{n,2}^2)\\text{tr}(\\textbf{r}_2^{(t)^h}\\textbf{r}_2^{(t ) } ) , \\\\",
    "\\mathbb{e}\\big[|| \\textbf{x}_r^{(t ) } ||^{2}\\big ] & = \\text{tr } \\big\\ { \\textbf{f}^{(t ) } ( \\textbf{g}_c^{(t ) } + p_1\\textbf{h}_{1,r}^{(t-1)}\\textbf{h}_{1,r}^{(t-1)^h } + p_2\\textbf{h}_{2,r}^{(t-1)}\\textbf{h}_{2,r}^{(t-1)^h}+\\sigma_{n , r}^2\\textbf{i}_{n_r } ) \\textbf{f}^{(t)^h}\\big\\ } , \\label{exp_y1_y2_xr_w } \\end{split}\\ ] ] where @xmath124 \\\\ + & \\mathbf{\\gamma}_3 \\sum_{i=2}^{t-1 }   \\bigg [ ( \\sigma_{e , r}^2)^i\\textbf{i}_{n_r } \\prod_{j = t+1-i}^{t-1 } \\text{tr}(\\textbf{f}^{(j)}\\textbf{f}^{(j)^h } ) \\\\ & \\text{tr } \\ { \\textbf{f}^{(t - i)}(p_1\\textbf{h}_{1,r}^{(t-1-i)}\\textbf{h}_{1,r}^{(t-1-i)^h}+p_2\\textbf{h}_{2,r}^{(t-1-i)}\\textbf{h}_{2,r}^{(t-1-i)^h}+\\sigma_{n , r}^2\\textbf{i}_{n_r})\\textbf{f}^{(t - i)^h } \\ } \\bigg ] \\label { } \\end{split}\\end{aligned}\\ ] ] and @xmath125 , @xmath126 , and @xmath127 are defined as @xmath128      the problem of relay beamforming matrix design in each time slot is formulated as @xmath129 = n_rp_r \\label{}\\end{aligned}\\ ] ] using and substituting @xmath90 , the lagrangian in is reduced to @xmath130 where @xmath131    for the lagrangian in , we have three conditions of optimality as @xmath132 , @xmath133 , and @xmath134 . using the linear and nonlinear properties of the complex matrix derivative @xcite and the cyclic permutation and linearity of the trace function , these conditions are reduced to @xmath135 from and , we have @xmath136 and substituting into , we obtain @xmath137 to solve , we use the following lemma from @xcite .",
    "let @xmath138 , @xmath139 , and @xmath140 for @xmath141 .",
    "a matrix @xmath142 is a solution of the general linear matrix equation .",
    "@xmath143 if and only if @xmath144vec@xmath145 is a solution of the equation @xmath146 with @xmath147 and @xmath148vec@xmath149 .    using _ lemma 2 _ , the optimal @xmath150 is expressed as @xmath151 where @xmath152 and @xmath153 .",
    "note that the optimal @xmath93 in time slot @xmath21 involves the past channels from time slot @xmath154 to time slot @xmath21 since it is a function of @xmath155 , @xmath156 , and @xmath157 in .",
    "once the optimal @xmath93 is obtained , the optimal @xmath158 can be obtained from such that @xmath159 substituting into , the optimal @xmath160 is given by @xmath161 then , the optimal relay beamforming matrix in time slot @xmath21 is obtained as @xmath162 . in the next time slot ,",
    "the optimal relay beamforming matrix is derived in the same way .",
    "_ remark _ : the proposed relay beamforming design method can be applied to one - way fd af relay systems .",
    "unlike the two - way fd af relay systems , using matrix inverse operation , the relay beamforming matrix solution can be obtained without _",
    "lemma 2_.      the problem of receive beamforming matrices design in each time slot is formulated as @xmath163 where the sum of mse @xmath164 is defined as @xmath165 where @xmath166 by solving @xmath167 for @xmath26 , the receive beamforming matrices at the sources are given by @xmath168 where @xmath64 means the index of the other source ( @xmath65 if @xmath66 and @xmath67 if @xmath68 ) .",
    "an iterative algorithm is proposed for the joint relay and receive beamforming design .",
    "the relay beamforming matrix and receive beamforming matrices are optimized alternately until convergence in each time slot .",
    "the proposed iterative algorithm is shown in algorithm 1 .    [",
    "cols=\"<\",options=\"header \" , ]",
    "in this section , we numerically evaluate the sum of mse and the achievable sum rate for the proposed scheme , conventional scheme , and the hd two - way relaying scheme .",
    "the proposed scheme updates the relay beamforming matrix @xmath83 and receive beamforming matrix @xmath84 for @xmath26 every time slot , which is based on the channels in the @xmath0 latest time slots . unlike the proposed scheme , the conventional scheme updates the relay beamforming matrix based only on the channels in the current time slot , i.e. @xmath169 .",
    "the hd two - way relaying scheme is used as a referential scheme .",
    "the sum of mse and achievable sum rate are obtained by averaging over 100 channel realizations .",
    "the number of iteration for relay and receive beamforming design is 30 .",
    "the channel matrices @xmath170 for @xmath171 are set to follow rayleigh fading , i.e. , the elements of each channel matrix are independent complex gaussian random variables with zero mean and unit variance .",
    "the channel estimation error matrices @xmath45 for @xmath39 are set to follow rayleigh fading , i.e. , the elements of each channel matrix are independent complex gaussian random variables with zero mean and variance @xmath172 . for simplicity , it is assumed that all the nodes transmit with power @xmath173 , i.e. , the power is set to be @xmath174 .",
    "the noise variance and the loopback channel estimation error variance at each node are set to be as @xmath175 and @xmath176 .",
    "snr and inr are defined as @xmath177 and @xmath178 , respectively .",
    "[ th ! ]    fig .",
    "[ fig_result_iteration ] shows the sum of mse and the achievable sum rate versus number of iterations for different inr values in the 10th time slot when snr@xmath179db , @xmath180 , @xmath181 , and @xmath182 , respectively .",
    "the proposed scheme addresses two sub - problems for relay beamforming design and receive beamforming design at sources .",
    "since the solution for each sub - problem is optimal , the sum of mse decreases with each iteration .",
    "[ t ! ]    fig .",
    "[ fig_result_snr_pro ] shows the sum of mse and achievable sum rate versus snr for different inr values in the 10th time slot when @xmath180 , @xmath181 , and @xmath182 , respectively .",
    "as shown , the proposed joint beamforming design achieves better performance than the proposed design of relay beamforming only . as snr increases and inr decreases , the sum of mse decreases and the achievable sum rate increases for both the proposed schemes .",
    "t ]    fig .",
    "[ fig_result_m ] shows the sum of mse and the achievable sum rate versus the time slot index for different values of @xmath0 and inr when snr@xmath183 db , @xmath180 , and @xmath181 .",
    "the proposed scheme with @xmath182 and @xmath184 are the methods that the relay and receive beamforming matrices are designed with all the beamforming and channel matrices from the first time slot and with only those in the @xmath185 latest time slots , respectively . if @xmath185 is too small , the performance is unstable after time slot @xmath186 because it can not handle the propagated effect of the residual loopback si .",
    "for instance , when @xmath187 under inr@xmath188 db and @xmath189 under inr@xmath179 db , both of the sum mse and the sum rate oscillate and the oscillations become larger as either inr increases or @xmath0 decreases .",
    "on the other hand , if @xmath190 under inr@xmath188 db , the performance gap from the case of @xmath182 is marginal .    [ t ! ]   for stability in the fd mode.,title=\"fig:\",width=377 ]    fig .",
    "[ fig_result_range ] shows the criteria for the duplex mode selection and the selection of @xmath185 for stability in the fd mode when @xmath180 and @xmath181 . in the region above the solid line ,",
    "the achievable sum rate of the proposed scheme in fd mode is greater than that of hd mode , so fd is preferred to hd .",
    "however , below the solid line , hd is better than fd .",
    "this figure also reveals that as inr increases , the snr required for selection of fd grows . for each pair of snr and inr , the values of @xmath185 for stability",
    "are presented , too . for the region where hd is preferred , @xmath185",
    "is not specified because the residual loopback si in the hd mode does not exist .    [ !",
    "t ]    fig .",
    "[ fig_result_snr_procon_mse ] shows the sum of mse versus snr for different inr values in the 10th time slot when @xmath180 and @xmath181 .",
    "it is shown that the proposed scheme of joint beamforming design provides a lower mse than the conventional scheme .",
    "as snr increases and inr decreases , the mse decreases for both the proposed and conventional schemes . the performance difference between the two schemes decreases as snr increases and inr decreases .",
    "this is because the proposed scheme updates the relay and receive beamforming matrices based on the covariance matrix of loopback channel estimation error .",
    "this figure also verifies that @xmath191 provides almost the same mse performance as @xmath182 .",
    "[ fig_result_snr_procon_rate ] compares the achievable sum rates of the proposed scheme of joint beamforming design and the conventional scheme at the 10th time slot when @xmath180 and @xmath181 . in either low snr or high inr regime ,",
    "fd is not beneficial relative to hd because the cost of handling the residual loopback si is higher than the hd loss in those regimes , which strongly suggests adaptive selection between hd and fd according to snr and inr ; if inr is less than @xmath49 db when snr @xmath192 @xmath193 db or less than @xmath193 db when snr @xmath192 @xmath194 db , fd with the proposed beamforming scheme is preferred to hd .",
    "if we focus on the scenarios where fd is preferred , @xmath191 offers almost the same achievable sum rate as @xmath182 , as in fig .",
    "[ fig_result_snr_procon_mse ] .",
    "[ fig_result_snr_procon_gain ] shows the achievable sum rate gain versus snr for different inr values at the 10th time slot when @xmath180 and @xmath181 .",
    "the achievable sum rate gain is defined as the ratio between the achievable sum rate of the proposed joint design scheme and that of the hd scheme .",
    "for example , the achievable sum rate gain is 2 and 1.9 when inr@xmath195 and inr is @xmath196 db , respectively .",
    "the gain increases as snr decreases or inr increases .",
    "t ]    fig .",
    "[ fig_result_ts ] shows the sum of mse and achievable sum rate versus the time slot index for different inr ( i.e. , inr@xmath188 db , @xmath49 db , and @xmath193 db ) when snr@xmath179 db , @xmath180 , and @xmath181 .",
    "the performance gap between the proposed joint design scheme and the conventional scheme is shown to be larger as the time slot index increase , for both mse and sum rate .",
    "the error propagation effect of residual loopback si over time slots is not properly addressed in the conventional scheme and accordingly the loss due to the error propagation increases with time slot index .",
    "interestingly , the performance gap between the first and the second time slots is greater than that between the second and the third time slots . this is because the residual si at relay starts to affect from the second time slot whereas the residual si at source affects from the first time slot . as in the previous figures ,",
    "it is verified again that @xmath191 offers almost the same performance as @xmath182 .",
    "[ fig_result_nr ] presents the sum of mse and achievable sum rate versus snr for different values of @xmath20 at the @xmath197th time slot when @xmath180 and inr@xmath195 db . as the @xmath20 increases , the mse decreases and achievable sum rate increases for both the proposed joint design scheme and the conventional scheme .",
    "the performance gap between the proposed and conventional schemes increases with @xmath20 because the multiple antennas at relay are more efficiently used in the proposed scheme .",
    "this paper investigated joint design of relay beamforming and receive beamforming at sources in fd two - way af relay systems under a relay transmit power constraint .",
    "we analyzed the coupled effect of beamforming matrix design across time slots and derived the optimal bemforming matrices in closed form at each time slot in terms of mmse , considering the coupled effect .",
    "to reduce the burden on the beamforming design incorporating all the time slots from the first time slot to the current time slot , we also proposed the beamforming design method based only on the @xmath0 latest time slots .",
    "it was shown that if @xmath0 is not too small , the performance degradation due to a limited number of @xmath0 was marginal . with numerical analysis",
    ", we revealed when full - duplex operation is beneficial compared to hd operation , and proposed adaptive selection between fd and hd according to inr and snr .",
    "f. s. tabataba , p. sadeghi , c. hucher , and m. r. pakravan , `` impact of channel estimation errors and power allocation on analog network coding and routing in two - way relaying , '' , vol .",
    "61 , no . 7 , pp",
    ". 3223 - 3239 , sep ."
  ],
  "abstract_text": [
    "<S> we consider the full - duplex ( fd ) two - way amplify - and - forward relay system with imperfect cancelation of loopback self - interference ( si ) and investigate joint design of relay and receive beamforming for minimizing the mean square error under a relay transmit power constraint . </S>",
    "<S> due to loopback channel estimation error and limitation of analog - to - digital converter , the loopback si can not be completely canceled . </S>",
    "<S> multiple antennas at the relay can help loopback si suppression but beamforming is required to balance between the residual si suppression and the desired signal transmission . </S>",
    "<S> moreover , the relay beamforming matrix should be updated every time slot because the residual si in the previous time slot is amplified by the current beamforming matrix and added to the received signals from the two sources in the current time slot . </S>",
    "<S> we derive the optimally balanced relay beamforming and receive beamforming matrices in closed form based on minimum mean square error , taking into account the propagation of the residual loopback si from the first to the current time slot . </S>",
    "<S> we also propose beamforming design using only the channels of the @xmath0 latest time slots , not from the first time slot . based on our numerical results </S>",
    "<S> , we also identify when fd is beneficial and propose selection between fd and half - duplex according to signal - to - noise ratio and interference - to - noise ratio . </S>"
  ]
}