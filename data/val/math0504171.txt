{
  "article_text": [
    "x - ray powder diffraction ( xrpd ) technique is nowadays a well known tool to study crystalline properties , which provide important information for applications in fields such as nanotechnology @xcite . all the applications benefit from a reliable pre - processing aimed at enhancing the quality of xrpd data .",
    "the pre - processing procedure consists of four steps : denoising , background suppression , peak fitting and signal deblurring , also known as line - broadening ( see fig .",
    "1 ) . many techniques can be applied to remove noise from xrpd data ( see ref . @xcite and references therein ) .",
    "the step of background suppression is needed to emphasize the peak features of the sample .",
    "traditional techniques are : young s polynomials , chebyshev approximation and linear interpolation @xcite .",
    "peak fitting is a very challenging step to extract information about the properties of polycrystalline powder @xcite .",
    "the final stage in xrpd data pre - processing is the signal deblurring aiming at disentangling the instrumental line - broadening out of data . on this topic",
    "we spot a recent review in ref . @xcite . in this paper we propose a new approach for two of the above pre - processing steps of xrpd data .",
    "the signal background is removed by means of a procedure based on morphological mathematics .",
    "the peak shape profile fitting is carried out by using a subspace - based parameter estimation method called hankel lanczos singular value decomposition ( hlsvd ) technique @xcite .",
    "the main advantage of this approach is twofold : while both background suppression and peak shape profile fitting are model independent , the signal deblurring procedure , employed thereafter , crucially benefits from the model independence of the previous two steps . indeed , our signal deblurring steps over the major drawback of most of the xrpd analysis tools available in the literature : the peak overlapping problem , namely the difficulty in singling the peak out of the full xrpd profile .",
    "this problem is mainly due to the model - induced bias in background / peak profile reconstruction . as to the denoising",
    "we use a wavelet based filter , a popular tool available in several software packages .",
    "real xrpd intensity profiles of ceria samples @xcite are used to test the performances .",
    "four different raw datasets were used in pairs @xcite . for each pair ,",
    "one dataset was collected on the annealed ceria specimen ( representing the instrumental broadening ) and the other was collected on the broadened sample .",
    "the selected pairs are those measured at the university of birmingham ( a high resolution x - ray laboratory ) and at the national synchrotron light source ( nsls x3b1 ) .",
    "the structure of the paper is as follows .",
    "section [ sec : method ] is devoted to the description of the proposed method and of the results .",
    "conclusions are drawn in section [ sec : conclusions ] .",
    "two different raw datasets were downloaded for the ceria sample : the instrumental standard representing the instrumental broadening and the ceria xrpd pattern of the broadened sample .",
    "our strategy in disentangling the profile broadening out of the experimental sample relies on a three step procedure which is sketched in the sequel .",
    "the noise was removed by applying wavelet transforms to the full xrpd spectrum and subtracted prior to the background suppression .    among the many applications of wavelets ,",
    "signal denoising has been deeply investigated and the wavelet filter can be considered as the state of art on this subject . the discrete wavelet transform ( dwt ) is a linear operator which modifies the data vector in a similar way as the discrete fourier transform ( dft ) . in both cases ,",
    "the transform , given by a @xmath0 matrix acting on the input @xmath1-vector data , is invertible @xcite .",
    "the matrix entries are combinations of basis functions ( the familiar sines and cosines in the case of dft ) .",
    "tables 1 - 2 summarize the main properties of some wavelet bases .",
    "an interesting property of wavelet basis is the localization in both space and frequency domain .",
    "this means that they have a finite support or a decay in both domains .",
    "regularity is another important property of wavelet basis .",
    "regularity @xmath2 means that the @xmath3 derivative exists _ almost everywhere _ ( see table 1 ) . in the case of daubechies wavelet",
    ", regularity depends on the order @xmath1 ( see table 2 ) .",
    "a wavelet is defined by particular set of numbers @xmath4 , called wavelet filter coefficients .",
    "they are determined by imposing the constraints of @xmath1 vanishing moments , @xmath5 ( @xmath6 ) , see table 1 , and orthogonality @xmath7 .",
    "the coefficients @xmath8 characterize a low - pass filter while the coefficients @xmath9 results in a high - pass filter .",
    "coefficients @xmath8 give the entries of a @xmath0 matrix , which iteratively applies to the @xmath1-data vector thus resulting in the @xmath1-vector of detail coefficients . the whole procedure described above",
    "is the wavelet transform ( see @xcite for further details ) . generally speaking ,",
    "the denoising procedure involves three steps .",
    "the basic version of the procedure is the following :    * calculate the wavelet transform of xrpd profile and sort the components of the output vector by increasing frequency .",
    "this shall result in @xmath1-vector containing the xrpd profile average coefficient and a set of detail coefficients .",
    "* noise thresholding , calculated on the highest frequency detail coefficient of the wavelet spectrum .",
    "* signal reconstruction by using the average coefficient and thresholded detail coefficients .    in this paper",
    "we choose the daubechies wavelet basis with @xmath10 .",
    "we address the reader to daubechies @xcite for further details .",
    "the background was determined by means of morphological transforms for the full xrpd spectrum and subtracted prior to the signal deblurring .",
    "the morphological mathematics is based on the language of set theory .",
    "considered a discrete binary image @xmath11 and a structuring element @xmath12 , the four basic morphological mathematical operations on @xmath13 by @xmath14 are : @xmath15 where @xmath16 denotes the translation of @xmath13 by @xmath17 , namely @xmath18 . the value of each pixel in the output image is based on a comparison of the corresponding pixel in the input image with its neighbours , whose number and location is given by the structuring element . generally , dilation expands image objects , whereas erosion shrinks them . in practice , dilation and erosion",
    "are employed in pairs .",
    "opening is the erosion of an image followed by the dilation of the eroded image , and closing is the dilation of an image followed by the erosion of the dilated image .",
    "opening eliminates sharp peaks smaller then the structuring element while the closing fills in the small holes and gaps .",
    "the binary morphological operations of dilation , erosion , opening and closing can be extended to grey - scale images .",
    "let @xmath19 and @xmath20 be the domains of the gray - scale image @xmath13 and the grey - scale structuring element @xmath14 respectively .",
    "the grey - scale dilation and erosion can be computed by @xmath21 where @xmath22 and @xmath23 . for such images ,",
    "the minimum and maximum values are computed within neighbourhood represented by the structuring element ( see @xcite for details ) .    in our background suppression procedure",
    "the xrpd pattern is reshaped and padded into a 2-d image .",
    "a disk with a radius of three pixels is used as structuring element both for erosion and for dilation . as to the erosion ( dilation ) , pixels beyond the image border",
    "are assigned the maximum ( minimum ) value afforded by the data type .",
    "the morphological opening removes small objects from the image while preserving the shape and size of larger objects in the image .",
    "the overall result is a peak smearing effect while the background intensity remains unalterated .",
    "restoring the original 1-d pattern provides the xrpd spectrum background .",
    "figure 2 summarizes the whole procedure .",
    "we compared our findings to the traditional interpolation method and we found a satisfactory agreement ( the percentage difference between the background computed by traditional techniques and our finding is below 3 % ) . up to our knowledge",
    ", this technique has never been applied to xrpd spectrum background suppression and it provides a reliable and user independent estimate of it .",
    "the main problem in analysing an xrpd spectrum is the peak search , since the exact @xmath24 position is crucial in the extraction of the relevant microstructural information .",
    "had the peak well defined , its shape would be straighforwardly achieved ( for instance by a high resolution interpolation / fit by means of a model ) . unfortunately the data resolution is rarely high enough to reach the goal of a well profiled peak . in that respect several methods have been devised so far to accomplish the peak fitting by means of gaussian , lorentzian , voigt , pseudo - voigt , pearson vii and other models @xcite .",
    "the main drawback of the aforementioned methods cited above is the dependence of results on the model used in the fit procedure itself and the poor description of the real peak profile shape ( for instance asymmetry ) .",
    "here we use hlsvd method to the purpose @xcite .",
    "the main advantage of this method is the flexibility since the number of parameters is not fixed and it can be chosen to achieve a more satisfactory agreement between the model and the real peak profile shape .",
    "the hlsvd method works as follows .",
    "let us model the xrpd intensity samples @xmath25 collected at angles @xmath26 , @xmath27 as the sum of @xmath28 exponentially damped complex sinusoids @xmath29 \\ ; , \\label{eq : model}\\ ] ] @xmath30 is the amplitude , @xmath31 the phase , @xmath32 the damping factor and @xmath33 the frequency of the @xmath34 sinusoid , @xmath35 , with @xmath28 the number of damped sinusoids .",
    "the @xmath1 data points defined in ( [ eq : model ] ) are arranged into a hankel matrix @xmath36 , @xmath37 , @xmath38 , with @xmath39 ( @xmath40 ) .",
    "the svd of the hankel matrix is computed as @xmath41 , where @xmath42 , @xmath43 , @xmath44 , @xmath45 and @xmath46 are orthogonal matrices and the superscript h denotes the hermitian conjugate .",
    "the lanczos bidiagonalization algorithm with partial reorthogonalization is used to compute svd .",
    "this algorithm , based on fft , computes the two matrix - vector products which are performed at each step of the lanczos procedure in @xmath47 rather than in @xmath48 in order to obtain the `` signal '' subspace , the matrix @xmath49 is truncated to a matrix @xmath50 of rank @xmath28 @xmath51 , where @xmath52 , @xmath53 , and @xmath54 are defined by taking the first @xmath28 columns of @xmath45 and @xmath46 , and the @xmath55 upper - left matrix of @xmath56 , respectively . as subsequent step ,",
    "the least - squares solution of the following over - determined set of equations is computed @xmath57 , where @xmath58 and @xmath59 are derived from @xmath53 by deleting its first and last row , respectively .",
    "the @xmath28 eigenvalues @xmath60 of matrix @xmath61 are used to estimate the frequencies @xmath62 and damping factors @xmath63 of the model damped sinusoids from the relationship @xmath64 , \\label{eq : eigen}\\ ] ] with @xmath35 .",
    "values so obtained are inserted into the model equation ( [ eq : model ] ) which yields the set of equations @xmath65 \\ ; , \\label{eq : model_eigen}\\ ] ] with @xmath66 .",
    "the least - squares solution of ( [ eq : model_eigen ] ) provides the amplitude @xmath67 and phase @xmath68 estimates of the model sinusoids which are used in the next step .",
    "the xrpd pattern has to be corrected for the instrumental broadening .",
    "several methods have been devised so far to deal with this problem . among them",
    "we quote the stokes method @xcite and the bayesian approach @xcite .",
    "the main drawbacks of these methods stem from the difficulty in evaluating the background level , mainly due to peak overlapping .",
    "the xrpd pattern plugged in the deblurring algorithm is noise - background free since it has been already pre - processed by the wavelets filter and the morphological operator .",
    "the technique proposed in this paper is a modified version of the one presented in ref .",
    "a blurred or degraded xrpd pattern can be approximately described by a volterra equation @xmath69 , where @xmath70 is the blurred xrpd pattern and @xmath71 is the distortion operator due to several causes , namely the point spread function ( psf ) , and @xmath72 is an additive noise , introduced in the xrpd acquisition , that corrupts the signal . strictly speaking in an xrpd experimental setup we deal with a poissonian noise which is a multiplicative noise .",
    "however the poisson distribution function resembles the gauss one provided a sufficiently large statistics in photons counting .",
    "as to the deblurring procedure we implement the damped lucy  richardson algorithm .",
    "this function performs multiple iterations , using optimization techniques and poisson statistics . in our approach",
    "the psf is the raw dataset downloaded for the ceria sample - the instrumental standard - resembling the instrument profile @xcite .",
    "the algorithm maximizes the likelihood that the resulting image , when convolved with the psf , is an instance of the blurred image , assuming poisson noise statistics .",
    "this function can be effective when the psf is known but the knowledge about the additive noise in the image is poor .",
    "richardson algorithm introduces several adaptations to the original maximum likelihood algorithm that addresses complex image restoration tasks . by using these adaptations ,",
    "the effect of noise amplification on image restoration can be reduced , nonuniform image quality can be accounted for ( e.g. , bad pixels , flat - field variation ) and the restored image resolution can be improved by subsampling .    due to the denoising / background suppression ,",
    "the original volterra equation is readily simplified : @xmath73 , where @xmath70 , @xmath71 and @xmath74 have been already defined . was the inverse @xmath75 explicitly known",
    ", we would solve the former equation at a glance .",
    "unfortunately this is not the case and the solution has to be approximated as follows .",
    "@xmath70 , @xmath71 and @xmath74 are positive and the psf can not change the @xmath70 norm , _ i.e. _ @xmath76 . thus : @xmath77 where @xmath78 ; the solution can be found by an iterative procedure : @xmath79 , where the initial guess xrpd spectrum is uniform . as already stressed in ref .",
    "@xcite , the main drawbacks in applying such an algorithm to the single peak deconvolution are the noise amplification and the peak fitting bias .",
    "noise amplification is dramatically reduced by both the denoising procedure and the small ( some five ) number of iterations used in the algorithm .",
    "moreover the damp in the algorithm specifies the threshold level for the deviation of the resulting image from the original image , below which damping occurs . for pixels that deviate in the vicinity of their original values ,",
    "iterations are suppressed .    as to the peak fitting bias , unlike the balzar approach",
    ", our procedure uses the instrumental standard pattern ( with no overlapping ) as the psf to deconvolve the full xrpd pattern and then we extract the deconvoluted / deblurred xrpd pattern in the same range of the psf used for the deconvolution itself .",
    "the rationale of this choice relies on the fact that while the psf peaks have no overlap , this is not the case for the broadened sample peaks and , thus , the peak ranges can be defined starting on the annealed sample rather than the broadened one .",
    "moreover the discrete fourier transform ( dft ) , used by the deblurring functions , assumes that the frequency pattern of an image is periodic .",
    "this assumption creates a high - frequency drop - off at the edges of an overlapping peaks cluster @xcite .",
    "this high - frequency drop - off can create an effect called boundary related ringing in deblurred images , that is a systematic error affecting any further investigation on the physical meaning of the deconvolved spectrum . to reduce ringing",
    ", our full pattern deconvolution , as described above , resembles an edgetaper function .",
    "it removes the high - frequency drop - off at the edge of an image by blurring the entire image and then replacing the center pixels of the blurred image with the original one . in this way , the edges of the image taper off to a lower frequency .",
    "in this paper we presented a new approach for background removal and peak fitting of xrpd profiles .",
    "such operations are crucial in the line - broadening analysis of x - ray diffraction profiles , an important pre - processing step in the investigation of the crystal powder samples by means of xrpd data .",
    "backgroud suppression relies on the use of morphological mathematics while peak fitting is carried out by means of hlsvd technique .",
    "in order to enhance the signal - to - noise ratio of xrpd profiles a wavelet based filter is preliminarly applied to xrpd data .",
    "the output of the proposed precedure is supplied to a damped lucy ",
    "richardson algorithm for deblurring .",
    "the main advantage of this approach is twofold : background suppression and peak shape profile fitting are model independent .",
    "real xrpd intensity profiles of ceria samples are used to test performances .",
    "results show that the background estimate is in agreement with that computed by traditional interpolation methods with a percentage difference below 3% .",
    "further , the output xrpd profile has narrower peaks , located at the same position and with the same shape as the original one .",
    "it is worth noting that once the deblurred , noise - background free xrpd spectrum is convoluted back to the psf and added to the removed noise and background signals , the resulting xrpd pattern resembles the original one .",
    "1 cervellino ,  a. , giannini ,  c. , guagliardi ,  a. & ladisa ,  m. ( 2005 ) , _ nanoparticle size distribution estimation by full - pattern diffraction analysis _ , 1em plus 0.5em minus 0.4emsubmitted to physical review b ; [ arxiv : cond - mat/0502583 ] .",
    "cervellino ,  a. , giannini ,  c. , guagliardi ,  a. & ladisa ,  m. ( 2005 ) , _ disentangling instrumental broadening _ ,",
    "1em plus 0.5em minus 0.4emsubmitted to journal of applied crystallography ; [ arxiv : cond - mat/0502582 ] .",
    "ladisa ,  m. , lamura ,  a. , laudadio ,  t. , and nico ,  g. ( 2005 ) , _ application of the hlsvd technique to the filtering of x - ray diffraction data _",
    ", 1em plus 0.5em minus 0.4emsubmitted to signal processing ; [ arxiv : math.sp/0502539 ] .",
    "jenkis ,  r. , and snyder ,  r.l .",
    "( 1996 ) , _ introduction to x - ray powder diffractometry _ ,",
    "1em plus 0.5em minus 0.4emnew york : wiley .",
    "rams ,  e. , penton ,  a. , martinez  garcia ,  j & fuess ,  h. ( 2005 ) , _ the use of analytical peak profile functions to fit diffraction data of planar faulted layer crystals _ , 1em plus 0.5em minus 0.4emcryst .",
    ", * 40 * , 1/2 , 166 - 176 .",
    "balzar ,  d. , audebrand ,  n. , daymond ,  m.r . , fitch ,  a. , hewat ,  a. , langford ,  j. i. , le bail ,  a. , louer ,  d. , masson ,  o. , mccowan ,  c.n . , popa ,  n.c .",
    ", stephens ,  p.w . &",
    "toby ,  b.h . (",
    "2004 ) , 1em plus 0.5em minus 0.4emjournal of applied crystallography , * 37 * , 911 - 924 .",
    "laudadio ,  t. , mastronardi ,  n. , vanhamme ,  l. , van hecke ,  p. and van huffel ,  s. ( 2002 ) , _ improved lanczos algorithms for blackbox mrs data quantitation _ ,",
    "1em plus 0.5em minus 0.4emjournal of magnetic resonance , * 157 * , 292 - 297 .",
    "data are available at the urls : www.du.edu/%7ebalzar/s-s_rr.htm , www.ccp14.ac.uk , www.boulder.nist.gov/div853/balzar .",
    "press ,  w.h . , teukolsky ,  s.a . ,",
    "vetterling ,  w.t . and",
    "flannery ,  b.p .",
    "( 1992 ) , _ numerical recipes in c _",
    ", 1em plus 0.5em minus 0.4emcambridge university press .",
    "daubechies ,  i. ( 1992 ) , _ ten lectures on wavelets _ , 1em plus 0.5em minus 0.4emsiam .",
    "serra ,  j. ( 1994 ) _ morphological filtering : an overview_,1em plus 0.5em minus 0.4emsignal processing , * 38 * , 3 - 11 .",
    "stokes ,  a.r .",
    "( 1948 ) , 1em plus 0.5em minus 0.4emproc .",
    "( london ) , * 61 * , 382 - 391 .",
    "lucy ,  l.b .",
    "( 1972 ) _ an iterative technique for the rectification of observed distributions_,1em plus 0.5em minus 0.4emthe astronomical journal , * 8 * , 243 - 246 .",
    "richardson ,  w.h .",
    "( 1972 ) , 1em plus 0.5em minus 0.4emjournal of optical society of america a , * 62 * , 55 - 59 .",
    "biemond ,  j. , lagendijk ,  r.l . ,",
    "mersereau ,  r.m .",
    "( 1990 ) , _ iterative methods for image deblurring _ , proceedings of the ieee , * 78 * , 5 , 856 - 883 ."
  ],
  "abstract_text": [
    "<S> precise knowledge of x - ray diffraction profile shape is crucial in the investigation of the properties of matter in crystals powder . </S>",
    "<S> line - broadening analysis is a pre - processing step in most of the full powder pattern fitting softwares . </S>",
    "<S> final result of line - broadening analysis strongly depends on preliminary three steps : noise filtering , removal of background signal and peak fitting . in this work a new model independent procedure for two of the aforementioned steps ( background suppression and peak fitting ) </S>",
    "<S> is presented . </S>",
    "<S> the former is dealt with by using morphological mathematics , while the latter relies on the hankel lanczos singular value decomposition technique . real x - ray powder diffraction ( xrpd ) intensity profiles of ceria samples are used to test the performance of the proposed procedure . </S>",
    "<S> results show the robustness of this approach and its capability of efficiently improving the disentangling of instrumental broadening . </S>",
    "<S> these features make the proposed approach an interesting and user - friendly tool for the pre - processing of xrpd data .    </S>",
    "<S> hankel lanczos singular value decomposition ( hlsvd ) , morphological filtering , x - ray powder diffraction </S>"
  ]
}