{
  "article_text": [
    "in this paper we give a detailed analysis of the asymptotic dynamics and stationary distribution for a special class of metastable markov chains .",
    "loosely speaking , a metastable markov chain is one that , on short time scales , looks like a stationary markov chain exploring only a small subset of its state space ; on longer time scales , however , it performs fast and rare transitions between different such subsets .",
    "the topic of metastability is an old one .",
    "its origins can be traced back at least to the works of eyring @xcite and kramers @xcite , who studied it in the context of chemical reaction rates . in the context of perturbed dynamical systems , freidlin and",
    "wentzell @xcite developed a systematic approach based on large deviation theory .",
    "this approach was extended by berglund and gentz @xcite to cover stochastic bifurcation and stochastic resonance , and by olivieri and scoppola @xcite to study dynamics of markov chains with exponentially small transition probabilities .",
    "bovier , eckhoff , gayrard and klein @xcite developed a systematic approach based on capacities , and gave a precise mathematical definition for metastability .",
    "the transition path theory @xcite investigates the most probable paths that the markov chain uses when travelling between different metastable states .",
    "recent books on various aspects of metastability include the monograph @xcite , and the lecture notes @xcite .    as we will discuss in section [ dynamics ] , the chains treated in the present paper are metastable in the sense of bovier et al .",
    "our situation is considerably simpler than the general one : the state space is of fixed finite ( but possibly large ) size , and the metastability enters via an explicit parameter in the transition matrix .",
    "in contrast , the theory described in @xcite is built to accommodate the difficult situation where metastability is not necessarily a consequence of some transition probabilities becoming small , but may also arise from a limit where the number of states diverges . in the case of reversible markov chains ,",
    "many of our main results can be deduced from the theory of @xcite , although our proofs are different and do not rely on the variational methods used there .",
    "the benefit of this is that our methods also cover the non - reversible situation where dirichlet - form techniques are less useful .",
    "let us describe our setup and results in some more detail .",
    "consider a family of discrete time markov chains @xmath4 with finite state space @xmath5 and transition matrices @xmath6 .",
    "we assume that the map @xmath7 is continuous at @xmath8 for all @xmath9 , and that the markov chain @xmath10 is irreducible when @xmath2 .",
    "for @xmath3 however , the chain may have several essential communicating classes .",
    "such a family of markov chains is called an irreducible perturbation of @xmath11 , or simply an irreducibly perturbed markov chain .    the first main result of the paper is a description of the multi - scale metastable behavior of the chain .",
    "let @xmath12 be the essential classes of the chain at parameter @xmath8 .",
    "we pick @xmath13 for all @xmath14 and define an effective chain @xmath15 with state space @xmath16 .",
    "we prove that this chain captures the effective dynamics of the original chain on the shortest metastable time scale , in the sense that its escape probabilities and stationary distribution are asymptotically independent of the choice of the representatives @xmath17 , and asymptotically equal to those of the original chain .",
    "for the stationary distribution , this means that @xmath18 , where @xmath19 and @xmath20 are the stationary distributions of the respective chains . a central tool is a natural , _",
    "reversible _ chain that has the same stationary distribution as @xmath15 and is interesting in its own right .    in order to explore longer metastable time scales",
    ", we renormalize the effective chain : for @xmath15 , all transitions between different states will vanish in the limit @xmath1 . by rescaling time under suitable conditions ,",
    "we obtain a new perturbed markov chain , where at least one transition probability between distinct states is of order one as @xmath1 .",
    "we can now iterate the procedure described above , yielding effective chains on smaller and smaller state spaces and encoding the dynamics of the original chain on longer and longer metastable time scales .",
    "a similar program has been carried out before by olivieri and scoppola @xcite .",
    "the difference to our approach is that @xcite relies on ( and extends ) the theory of freidlin and wentzell , while our approach is closer to the potential theoretic methods of bovier et .",
    "this allows us to avoid many of the technical complications found in @xcite . also , olivieri and scoppola only consider markov chains with exponentially small transition probabilities , and study asymptotics on a logarithmic scale .",
    "in contrast , our methods allow for much more general families of transition matrices , and our results are asymptotically sharp in the sense that we identify the correct prefactors for all our asymptotic identities .",
    "the last fact is particularly useful in practice , since it allows us to devise numerically stable algorithms for computing the asymptotic stationary distribution @xmath21 for all states @xmath22 .",
    "alternatively , we can compute the ratio of the stationary distributions for two given states @xmath23 without computing the full stationary distribution , thus potentially decreasing the computational cost considerably .",
    "these algorithms are the second main result of our work .    to see why numerically computing the asymptotic stationary distribution might be a problem , consider the following simple example",
    "let @xmath24 , and @xmath25 with elements @xmath26 , @xmath27 , for some @xmath28 . for @xmath8 , @xmath29 and @xmath30 are the essential classes of the chain , so both @xmath31 and @xmath32 are metastable .",
    "the stationary distribution of the chain is @xmath33 , @xmath34 .",
    "thus @xmath21 depends very sensitively on the behavior of the elements of the transition matrix at small @xmath0 .",
    "the reason for this is that the space of solutions to the defining equation @xmath35 is one - dimensional in the case @xmath2 , but multidimensional in the case @xmath8 .",
    "this also means that this linear equation is ill - conditioned for small @xmath0 .",
    "thus computing @xmath36 numerically by solving an eigenvalue problem is infeasible if the state space @xmath5 is large and the transition matrix is somewhat complicated .",
    "metastability also means that a monte carlo simulation of @xmath20 , i.e.  running the chain @xmath10 and recording the relative occupation times of the states @xmath22 , will fail for small @xmath0 . in the reversible case",
    ", the detailed balance equation @xmath37 can be used to compare the relative importance of @xmath36 and @xmath38 for neighboring @xmath9 , and by iterating for all @xmath9 , but there is no detailed balance equation for irreversible markov chains .",
    "therefore , it is not immediately clear how to compute the asymptotic stationary distribution of an irreversible perturbed markov chain in any numerically efficient way .    efficiently computing",
    "the stationary distribution of a large markov chain is an extremely important problem in many areas of applied science .",
    "maybe the most prominent example where it is needed is the computation of the page rank in search engines @xcite , where metastability also plays a role .",
    "it is therefore not surprising that a large body of literature is devoted to the topic , mainly in the computer science community .",
    "the seminal paper here seems to be by simon and ando @xcite , where they introduce a method for treating what is now known as almost decomposable markov chains , and derive the metastable behavior and some information on the asymptotic stationary measure for such chains .",
    "subsequently , the method was clarified and extended , and meyer @xcite realized that many of the extensions have a common foundation that he called the theory of the stochastic complement .",
    "many further extensions and refinements of the method have been given since .",
    "we can not give a full review of the literature here , but rather point the reader , by way of example , to the recent papers @xcite and the references therein .",
    "an apparently independent effort to treat metastable markov chains took place in the context of game theory and mathematical economy . here",
    "the start was made by hp young @xcite .",
    "he basically advocated using the markov chain tree theorem , as given in @xcite or @xcite .",
    "up to normalization , it gives the stationary measure @xmath39 as the sum of terms @xmath40 indexed by the directed spanning trees of @xmath5 rooted in @xmath31 , where the weight @xmath40 of a tree @xmath41 is the product of all transition probabilities along its edges ; for details see @xcite .",
    "as has been pointed out in @xcite , the problem with this formula is that while it is in principle not numerically unstable , it involves computing all spanning trees , which is exponentially expensive and thus becomes non tractable for large state spaces .",
    "moreover , all of the @xmath40 are usually tiny , and so we are trying to add an astronomical number of tiny terms , which is not a good idea .",
    "a different approach was taken by wicks and greenwald @xcite who offer a solution that is closer to the one described in @xcite , but differs in some important details . at the center of their method",
    "is what they call the quotient construction on stochastic matrices , which allows them to recursively simplify the state space and , by keeping track of the various simplifications , to compute @xmath42 in the end .",
    "as can already be guessed from the above discussion , the citation graph on metastable markov chains and their stationary distributions is somewhat disconnected .",
    "while some mathematicians , e.g.  @xcite or @xcite , are aware of the theory of ando and simon @xcite , it does not seem to be well known in the probability theory community . on the other hand ,",
    "the mathematical theory of metastability following @xcite is virtually unknown in the applied community , and the approaches by young @xcite and wicks and greenwald @xcite appear to be completely disjoint from the others .",
    "we hope that , among its other purposes , this paper helps connect these communities . for this reason we review the results related to simon / ando and those of wicks / greenwald at the end of our paper , translate their statements from the language of matrices to probabilistic terminology , and comment on how their results relate to the present paper .",
    "the paper is organized as follows : in section [ general escape ] , we collect some results on escape times for irreducible markov chains that seem hard to find in the literature . in section [ asymptotic escape ] , we introduce perturbed markov chains and show how the results from section [ general escape ] can be used to obtain asymptotic expressions of various important quantities .",
    "these will be used in section [ dynamics ] to describe the multi - scale effective dynamics of the chain .",
    "finally , in section [ algorithms ] , we present our numerical algorithms and compare them to those present in the computer science and economics literature .",
    "here we collect the main tools that we will use . in this section",
    ", @xmath43 is a general discrete time markov chain .",
    "in contrast to the remainder of the paper , we do not assume the state space @xmath5 to be finite , but we will assume that @xmath43 is irreducible and recurrent unless stated otherwise .",
    "all of the results below are relatively transparent , explicit identities involving hitting times . given the sheer amount of material on the subject , it is reasonable to assume that some or all of them have been derived elsewhere .",
    "we were unable to find an explicit reference for any of them , but will comment on related results where appropriate .    for a markov chain @xmath43 on a state space @xmath5 , the hitting time of a set @xmath44",
    "is denoted by @xmath45 , and the return time by @xmath46 . as usual , we will write @xmath47 instead of @xmath48 for @xmath22 , and similarly for @xmath49 .",
    "[ basic fact ] assume that @xmath43 is irreducible and positive recurrent , and write @xmath50 for the unique stationary distribution .",
    "then for all @xmath51 , [ useful equation ] ( x)p^x(^+_y < ^+_x ) = ( y)p^y(^+_x < ^+_y ) .    proposition [ basic fact ] looks like it should be part of every textbook on discrete time markov chains , but somewhat surprisingly it is not . before we comment on the status of proposition [ basic fact ] in the literature , note that is reminiscent of the detailed balance equation .",
    "let us write @xmath52 and for the moment assume that @xmath53 for all @xmath22 .",
    "then the quantities @xmath54 can be completed to become the transition matrix of a _",
    "reversible _ markov chain that has the same stationary distribution as @xmath43 . in general",
    ", @xmath55 will not hold for all @xmath31 , but below we will encounter a situation in the context of perturbed markov chains where it does .",
    "when the markov chain @xmath43 itself is reversible , proposition [ basic fact ] is a direct consequence of the well established theory of electrical networks : for example , from proposition 9.5 in @xcite it follows that @xmath56 , where @xmath57 is the effective conductance between @xmath31 and @xmath32 , and @xmath58 a global constant . since @xmath57 is symmetric in @xmath31 and @xmath32 , follows in the reversible case",
    ".    for the non - reversible case , proposition [ basic fact ] appears much less well known , although it can also be quickly deduced from a known result : corollary 8 of chapter 2 in the unfinished , but brilliant , monograph by aldous and fill @xcite directly implies it . as we have not found that statement anywhere else , we give a short proof here for the convenience of the reader .",
    "our proof differs somewhat from the one given in @xcite and uses the following more general lemma :    [ lem : ht ] let @xmath43 be irreducible and positive recurrent . for all states @xmath59 , @xmath60    since the chain is irreducible and positive recurrent , @xmath61 for all @xmath62 and @xmath31 in the state space @xmath5 , so in particular @xmath63 almost surely .",
    "thus @xmath64 the first two terms of the last line above sum up to @xmath65 .",
    "the last term is equal to @xmath66 , where @xmath67 denotes the time shift by @xmath68 steps . indeed , the random variables @xmath69 and @xmath70 , when nonzero , both count the number of steps from the first occurrence of @xmath32 until the first occurrence of @xmath31 . by the strong markov property , @xmath71 and the claim follows .",
    "if @xmath72 , the claim boils down to @xmath73 , so let us assume that @xmath74 .",
    "by using lemma  [ lem : ht ] in two different ways we obtain [ eq : prophsr ]    ^y(^+_y ) & = ^y((^+_y,^+_x ) ) + ^y(^+_x <",
    "^+_y)^x(^+_y ) , + ^y(^+_x ) & = ^y((^+_x,^+_y ) ) + ^y(^+_y < ^+_x)^y(^+_x ) .",
    "+    we rearrange the second equation above to obtain @xmath75 the last equality being due to @xmath74 . plugging this back into the first line of , using the fact that @xmath76 , and rearranging , gives [ lemma8 ] ( y ) p^y(^+_x <",
    "^+_y ) = , which is essentially corollary 8 of chapter 2 of @xcite . for our purposes",
    ", we note that the right - hand side of is invariant under swapping @xmath31 and @xmath32 , which proves the claim .",
    "* remark : * in the continuous time setting , the whole proof of lemma [ lem : ht ] and almost all of the proof of proposition [ basic fact ] goes through unchanged if we define @xmath77 the only difference is that the formula for the stationary measure in that case is given by @xmath78 , where @xmath79 is the exponential rate with which the process jumps away from @xmath32 .",
    "this gives the formula @xmath80 which is a special case of the symmetry result on capacities for non - reversible continuous time markov chains derived by gaudillire and landim @xcite , and applied to investigate metastability by beltrn and landim @xcite .",
    "their proof is quite different from the one presented here .",
    "a direct consequence of proposition [ basic fact ] is    [ stat dist representation ] the stationary distribution @xmath50 of @xmath43 fulfills the set of equations [ generic u expression ] = _ y s .",
    "since @xmath81 if @xmath74 , is equivalent to @xmath82 for all @xmath9 .",
    "we have @xmath83 by irreducibility for all @xmath9 , and so we can divide both sides by it . summing over @xmath84 and",
    "rearranging now shows the claim .    to get the most out of corollary [ stat dist representation ] , we need find a way to compute the escape probabilities appearing in .",
    "we will now collect some tools that will help us to do this , asymptotically , in the context of perturbed markov chains . unlike the statement of proposition [ basic fact ]",
    ", we have not been able to find them in the literature , but we still suspect that they are not completely new .",
    "[ first formula ] let @xmath43 be an irreducible , recurrent markov chain . for @xmath44 , @xmath22 and @xmath85 , we have [ hitting prob 1a ] p^x(x__a^+ = y ) = p(x , y ) + _ z s a p(z , y ) .",
    "when @xmath86 , simplifies to [ hitting prob 1b ] p^x(x__a^+ = y ) = _ z s a p(z , y ) .    for @xmath87 ,",
    "let us write @xmath88 for the set of paths that visit @xmath62 precisely @xmath89 times before entering @xmath90 , and in addition move directly from @xmath62 to @xmath85 .",
    "more formally , we put @xmath91 , and @xmath92 for @xmath93 , where @xmath94 denotes the cardinality of a set in this case .",
    "then , @xmath95 we have @xmath96 , and the sets @xmath88 are disjoint . as the chain is irreducible and recurrent",
    ", @xmath97 holds , and thus [ prelim 1 ] p^x(x__a^+ = y ) = p(x , y ) + _ z s a _ k 1 p^x(_y , k , z ) .",
    "now for @xmath93 we compute @xmath98 in the second line , we used the strong markov property , and in the third line , finite induction .",
    "we now sum up the geometric series in @xmath89 , use @xmath99 , and obtain @xmath100 in the last equality we used that @xmath101 implies @xmath102 . plugging this into proves .    for ,",
    "let us start from and note that for @xmath103 , we have @xmath104 . for the term with @xmath105 , we have @xmath106 the first equality holds because for @xmath107 , @xmath108 thus is shown .",
    "a variant of proposition [ first formula ] is well known and is the basis of many algorithms for computing stationary distributions of large markov chains .",
    "it is called the quotient construction by wicks and greenwald @xcite , and the stochastic complement by meyer @xcite . while in all those references ,",
    "it is written in matrix language , we give here the probabilistic formulation , which also has the benefit that we can give a short and transparent proof . below and in what follows @xmath109 denotes the complement of a set @xmath90 .    [",
    "quotient ] ( @xcite ) assume that the state space @xmath5 is finite , @xmath44 , @xmath22 and @xmath85 .",
    "then [ quot ] p^x ( x__a^+ = y ) = p(x , y ) + _ z , w a^c p(x , w ) ( 1 - p|_a^c)^-1(w , z ) p(z , y ) , where @xmath110 is the restriction of the transition matrix @xmath111 to @xmath109 .    clearly , @xmath112 .",
    "now , standard results @xcite state that @xmath113 is the unique harmonic extension of the function @xmath114 from @xmath90 to @xmath5 .",
    "in other words , @xmath115 is the unique function so that @xmath116 for all @xmath117 , and @xmath118 on @xmath90 .",
    "this can be rewritten as @xmath119 for all @xmath117 .",
    "since @xmath43 is irreducible , there exists @xmath120 with @xmath121 , where @xmath122 is the operator norm of a matrix .",
    "thus @xmath123 is invertible .",
    "the claim follows .",
    "* remark : * in , the probability of the set of all paths moving from @xmath124 to @xmath62 in @xmath109 and then entering @xmath90 from there is expressed as @xmath125 . in the probability of the set of all paths that leave @xmath109 at @xmath62 but enter anywhere is expressed as the quotient of two escape probabilities .",
    "comparing the two and varying over @xmath126 leads to the amusing identity @xmath127 for all @xmath44 , @xmath22 and @xmath128 . + for the following result , we do not assume irreducibility of the chain .",
    "[ committor formula ] let @xmath129 be an arbitrary markov chain , @xmath130 .",
    "assume @xmath131 and @xmath132 .",
    "then @xmath133    we have @xmath134 where in the last step we have used the strong markov property . by our assumption @xmath131 , we have @xmath135 .",
    "since we assumed @xmath132 , we must have @xmath136 ; otherwise the strong markov property would give @xmath137 .",
    "thus we can rearrange and obtain the result .    for our next statement ,",
    "fix a proper subset @xmath138 , and define for all @xmath9 [ effective p ] p(x , y ) : = p(x , y ) x c , p(x , y ) : = p^x(x__c^c = y ) x c.    [ effective chain ] let @xmath43 be an irreducible , recurrent markov chain",
    ". then @xmath139 is the transition matrix of a markov chain @xmath140 .",
    "denoting its path measure by @xmath141 , we have [ delete c ] p^x(_b < _ a ) = p^x(_b < _ a ) . for all @xmath130 with @xmath142 , and all @xmath22 .    since @xmath129 is irreducible and recurrent and @xmath143 , @xmath144 for all @xmath145 .",
    "thus it is obvious that @xmath146 is a stochastic matrix .",
    "the statement is also intuitively obvious , since all we do is replace the motion inside @xmath147 with the effective motion from @xmath147 to its exterior .",
    "we nevertheless give the short formal proof .",
    "we write @xmath148 for the @xmath149-th time that the chain @xmath129 travels between two states that are not both in @xmath147 , i.e. @xmath150 on @xmath151 , we define @xmath152 .",
    "then @xmath153 for all @xmath22 by recurrence and irreducibility of @xmath43 , and @xmath140 is a markov chain by the strong markov property of @xmath43 . since @xmath154 ,",
    "the transition probabilities of @xmath140 are given by .",
    "since @xmath147 is disjoint from @xmath90 and @xmath155 , we have @xmath156 and follows by taking expectations .    for our final general statement ,",
    "we introduce the notion of a direct path which will be useful in several places below .",
    "let @xmath157 , @xmath90 and @xmath155 be subsets of @xmath5 .",
    "a tuple @xmath158 is called a _ direct @xmath157-path of length @xmath68 from @xmath90 to @xmath155 _ if @xmath159 , @xmath160 , and for all @xmath161 , if @xmath162 then @xmath163 and @xmath164 .",
    "note that we allow @xmath165 .",
    "the set of all direct @xmath157-paths from @xmath90 to @xmath155 will be denoted by @xmath166 , and the components of @xmath167 will be written @xmath168 , @xmath169 .",
    "@xmath170 will denote the length of @xmath171 . for @xmath172 or @xmath173 we will use the notations @xmath174 instead of @xmath175 etc , and speak of direct @xmath157-paths from @xmath90 to @xmath32 , from @xmath31 to @xmath32 or from @xmath31 to @xmath155 .",
    "the probability of a direct @xmath157-path is defined by @xmath176 .",
    "[ second formula ] let @xmath157 be a finite subset of @xmath5 .",
    "then for all @xmath177 and @xmath178 , [ hitting prob 2 ] ^x(x__s",
    "j = y ) = _ _ j(x , y ) _ i=1^|| -1    the idea of the proof is to start at state @xmath31 and run the markov chain until it either hits @xmath179 or returns to @xmath31 . in the first case",
    "we have reduced the problem to computing @xmath180 and we iterate the argument for the smaller set @xmath181 ; in the second case we use the strong markov property to restart the process .",
    "formally , let us proceed by induction on @xmath182 .",
    "the claim trivially holds for @xmath183 ; so now let @xmath177 .",
    "the third equality below is obtained by the strong markov property .",
    "@xmath184 as the markov chain is recurrent and irreducible , we have @xmath185 .",
    "thus the last equation can be rearranged to @xmath186 where the numerator may be decomposed as @xmath187 .",
    "finally , we use the induction hypothesis for the set @xmath188 to rewrite @xmath189 for all @xmath190 , and obtain @xmath191 re - indexing yields the claim .",
    "let @xmath192 be a markov chain on a finite state space @xmath5 .",
    "a family @xmath193 of markov chains on @xmath5 indexed by @xmath194 is called a _ perturbation _ of @xmath11 if @xmath195 for all @xmath9 , where @xmath196 denotes the elements of the transition matrix @xmath25 of the chain @xmath10 , @xmath194 .",
    "we will speak of an _",
    "irreducible perturbation _ of @xmath11 ( or , alternatively , call the family @xmath10 an _ irreducibly perturbed markov chain _ ) if the chain @xmath10 is irreducible for all @xmath2 .",
    "note that in the definition of irreducibly perturbed markov chains , we do not require that @xmath11 be irreducible , and indeed the case where @xmath11 has several ergodic components is the interesting one .",
    "recall that @xmath22 is called _ accessible _ from @xmath84 under @xmath10 if @xmath197 for some @xmath198 .",
    "we write @xmath199 if @xmath32 is accessible from @xmath31 , and say that two states @xmath31 and @xmath32 _ communicate _ if @xmath199 and @xmath200 . the property to communicate forms an equivalence relation , and the respective equivalence classes are called _ communicating classes_. a state @xmath31 is called _ essential _ if @xmath200 for all @xmath84 such that @xmath199 , otherwise transient .",
    "it is easy to see that either all members of a communicating class @xmath201 are essential , or all are transient . in the first case",
    ", @xmath201 is called an essential ( communicating ) class , or ergodic component .",
    "@xmath5 can thus be decomposed into finitely many disjoint essential classes @xmath202 and the set @xmath203 of transient states . to emphasize that a nontrivial ergodic decomposition only exists for @xmath8",
    ", we will always speak of @xmath204-essential classes and @xmath204-transient states .",
    "@xmath205 will denote the set of all @xmath204-essential classes .",
    "the sets @xmath206 and @xmath207 can be conveniently described in terms direct paths .",
    "the following statement could be taken as a definition of @xmath204-essential classes and @xmath204-transient states ; the proof of equivalence to the traditional definition of essential classes ( see e.g.  @xcite ) is very easy , and omitted here . here and below",
    ", we will say that a direct path @xmath171 is _ @xmath204-relevant _ if @xmath208 , otherwise @xmath204-irrelevant .",
    "[ direct path lemma ] let @xmath10 be an irreducibly perturbed markov chain .",
    "+ a ) @xmath9 are in the same @xmath204-essential class @xmath201 if and only if there exists a @xmath204-relevant direct @xmath201-path from @xmath31 to @xmath32 , and a @xmath204-relevant direct @xmath201-path from @xmath32 to @xmath31 .",
    "+ b ) @xmath22 is in the transient set @xmath207 if and only if all direct @xmath5-paths from @xmath209 to @xmath31 are @xmath204-irrelevant .    in much of what follows , we will use the following concept of asymptotic equivalence .",
    "two functions @xmath210 and @xmath211 from @xmath212 to @xmath212 are _ asymptotically equivalent _ , if either @xmath213 and @xmath214 are identically zero , or @xmath215 for all @xmath216 with some @xmath217 and @xmath218 .",
    "note that in the latter case , we do not assume convergence of @xmath213 or @xmath214 .",
    "we write @xmath219 if @xmath213 is asymptotically equivalent to @xmath214 .",
    "it is easy to see that @xmath220 is indeed an equivalence relation , and in particular this implies @xmath221 whenever @xmath219 and @xmath213 is not identically zero .",
    "we will also need to know that @xmath220 is stable under addition and multiplication in the following sense : if @xmath219 and @xmath222 , then @xmath223 , and @xmath224 .",
    "stability under multiplication is trivial , and stability under addition follows from latexmath:[\\[|\\tfrac{a_\\eps + c_\\eps}{b_\\eps + c_\\eps } - 1| =     and transitivity of @xmath220 . note that we did not assume that @xmath226 in either case .",
    "let @xmath227 be a @xmath204-essential class .",
    "the restriction of @xmath11 to @xmath201 is the markov chain with state space @xmath201 and transition matrix @xmath228 .",
    "it is irreducible , and thus has a unique strictly positive stationary distribution @xmath229 .",
    "the trivial extension of @xmath229 to @xmath5 ( by putting @xmath230 for @xmath231 ) will be denoted by the same symbol , and is an extremal point of the convex set of stationary distributions for @xmath204 .",
    "the following lemma shows that when we focus our attention on a single @xmath204-essential class , the unperturbed chain gives a faithful asymptotic description of both the dynamics and the stationary distribution . here and",
    "below we will write @xmath20 for the unique stationary distribution of @xmath10 , when @xmath232 .",
    "[ like unperturbed ] let @xmath227 be a @xmath204-essential class .",
    "then for all @xmath233 and all @xmath234 , [ unperturbed1 ] _ 0 p^x _ ( _ y^+ < _ z^+ ) = p_0^x ( _ y^+ < _ z^+ ) , _ 0 p^x _",
    "( _ y < _ z ) = p_0^x ( _ y < _ z ) , and [ unperturbed 2 ] _ 0 = . in particular , @xmath235 .",
    "we only prove the first equality from , the proof for the second one is identical .",
    "we decompose [ decomp ] p_^x(_y^+ < _ z^+ ) = p_^x(_y^+",
    "< _ \\{z } e^c^+ ) + p_^x(_e^c < _ y^+ < _ z^+ ) .",
    "the second term is equal to @xmath236 , and proposition [ first formula ] gives @xmath237 now for each @xmath238 , there is a @xmath204-relevant direct @xmath201-path @xmath171 from @xmath239 to @xmath32 , and so @xmath240 thus @xmath241 , and thus the second term on the right - hand side of vanishes as @xmath1 .",
    "for the first term of , fix @xmath120 and decompose @xmath242 we have @xmath243 the first equality is because the probability on the left - hand side is a finite sum of at most @xmath68-fold products of transition probabilities .",
    "the elementary markov property at time @xmath244 gives @xmath245 for each @xmath246 , there is a @xmath204-relevant direct @xmath201-path @xmath171 from @xmath124 to @xmath32 , and thus there exists @xmath247 with @xmath248 for all @xmath0 sufficiently small . we conclude that @xmath249 for all sufficiently small @xmath194 and thus @xmath250 as @xmath68 was arbitrary , follows . for , we apply and obtain @xmath251 since the right - hand side above is strictly positive , this implies @xmath235 .    as an immediate corollary",
    ", we obtain some information on the structure of the stationary distribution in the limit @xmath1 .",
    "recall that @xmath252 is the collection of @xmath204-essential classes , and @xmath207 is the set of transient states .",
    "[ structure ] let @xmath234 . + a ) if @xmath253 , then @xmath254 .",
    "+ b ) if @xmath255 for some @xmath227 , then @xmath256 . + c ) in particular if @xmath257 exists for all @xmath227 , then @xmath21 exists for all @xmath22 , and @xmath258    for all @xmath253 , there exists a @xmath204-relevant path from @xmath62 to @xmath259 , and thus there is @xmath260 with @xmath261 . on the other hand , by , @xmath262 .",
    "so by proposition [ basic fact ] , @xmath263 proving a ) . now let @xmath255 for some @xmath204-essential class @xmath201 . summing the asymptotic equality @xmath264 over @xmath265",
    "gives b ) , and c ) is immediate from a ) and b ) .",
    "the practical usefulness of corollary [ structure ] depends on our ability to compute asymptotic expressions for the @xmath266 .",
    "we now give two statements that will play a key role in all that follows .",
    "the first says that hitting probabilities are asymptotically equivalent when the transition matrices are .",
    "the second describes how a perturbed markov chain leaves a @xmath204-essential class , with or without the additional condition that it can not return to its starting point .",
    "[ chain comparison ] let @xmath10 and @xmath267 be perturbed markov chains with finite state space @xmath5 , but not necessarily irreducible .",
    "let us assume that @xmath268 for the elements of the respective transition matrices .",
    "then for all @xmath130 and all @xmath22 , we have @xmath269    we will first show that the statement holds in the case where @xmath25 and @xmath270 only differ in one row , i.e.  where [ one row ] p_(z , y ) p_(z , y ) z s , p_(x , y ) = p_(x , y ) x s. once this is done , we can exploit the assumption that @xmath5 is finite , iteratively change row after row , and prove the full claim .",
    "for the case where holds , first note that for all @xmath22 , @xmath271 this can be seen by considering a coupling @xmath272 of the chains and by observing that by , @xmath273 for all @xmath68 .",
    "so , the first time when the chains @xmath10 and @xmath267 can differ is after they hit @xmath62 .",
    "thus , @xmath274 since @xmath275 , we can now use the strong markov property to find @xmath276 again @xmath277 , and it remains to show that @xmath278 . if @xmath279 , this is trivial . for @xmath280 , @xmath281 , and @xmath282 .",
    "we are aiming to use lemma [ committor formula ] , and thus need to deal with the possibility that @xmath283 .",
    "we assumed @xmath284 for all @xmath9 , and so we also have @xmath285 for each direct path from @xmath31 to @xmath155 . by the definition of @xmath220 , a direct path @xmath171 from @xmath31 to @xmath155 fulfills @xmath286 for all @xmath2 in a neighborhood of @xmath3 if and only if @xmath287 in a neighborhood of @xmath288 .",
    "let us first assume that no such direct path exists .",
    "then @xmath289 for all @xmath120 , and thus @xmath290 .",
    "now let us assume that such direct paths do exist .",
    "since @xmath291 , we can use lemma [ committor formula ] to get @xmath292 now , @xmath293 and the same argument shows @xmath294 .",
    "the claim follows .",
    "the statement of theorem [ chain comparison ] is rather surprising .",
    "the reason is that even though in each step that the chain takes from @xmath31 on its way to @xmath155 , the probabilities for the chains @xmath43 and @xmath140 differ only by a factor that becomes negligibly close to one as @xmath1 , in the same limit the number of steps needed to reach @xmath155 can diverge .",
    "indeed , imagine two @xmath204-essential classes @xmath201 and @xmath295 that are linked by direct paths @xmath171 with @xmath296 , but are linked to @xmath90 and @xmath155 only by paths @xmath297 with @xmath298 . then",
    ", starting from a point in @xmath201 , both @xmath201 and @xmath295 will be visited many times before either @xmath90 or @xmath155 is hit .",
    "so one could fear that the errors committed by changing each transition probability to an asymptotically equivalent one will pile up ; but as theorem [ chain comparison ] shows , this is not the case .",
    "[ magic formula ] let @xmath201 be a @xmath204-essential class , @xmath299 and @xmath300 .",
    "then [ magic formula 1 ] p^x_(_e^c^+ < _ x^+ , x__e^c = z ) _ y e _ e(y ) p_(y , z ) , and [ magic formula 2 ] p^x_(x__e^c = z ) _ y e _",
    "e(y ) p_(y , z ) , with normalizing constant @xmath301    * remark : * is intuitively clear : for small @xmath0 , the markov chain spends such a long time in @xmath201 before exiting that it essentially exits @xmath201 from its @xmath201-stationary distribution .",
    "formula on the other hand is rather remarkable , since a return to @xmath31 happens in a time of order one , so there is no time for the chain to become stationary .    to prove , choose @xmath302 in proposition [ first formula ] .",
    "then @xmath303 we decompose [ simple decomp ] p_^x(_y^+ < _ e^c \\{x}^+ ) = p_^x(_y^+ < _ e^c \\{x}^+ , _ e^c^+ > _ x^+ ) + p_^x(_y^+ < _ e^c \\{x}^+ , _ e^c^+ < _ x^+ )",
    ". the first term is equal to @xmath304 . the second term in this decomposition as well as the second term in",
    "are bounded by @xmath305 and thus vanish @xmath1 , due to lemma [ like unperturbed ] and the finiteness of @xmath306 .",
    "the same lemma then yields @xmath307 similarly , for @xmath265 we have @xmath308 by proposition [ basic fact ] , we conclude @xmath309 here , we have used that @xmath310 for all @xmath233 . since the right - hand side above is strictly positive ,",
    "we conclude that @xmath311 , and is shown .",
    "to see , we use proposition [ first formula ] with @xmath312 .",
    "since now @xmath107 , we can use and obtain [ easy ] p^x_(x__e^c^+ = z ) = _ y e p_(y , z ) . as before ,",
    "@xmath313 for all @xmath265 . by summing over all @xmath314 ,",
    "we get @xmath315 plugging these into , we obtain .",
    "here we describe the metastable dynamics of a perturbed markov chain . as in the previous section , we will restrict our attention to a finite state space @xmath5 throughout .",
    "first of all , we have to define what we mean by metastable dynamics .",
    "we follow the theory of bovier et al @xcite . in the case of perturbed markov chains on a finite state space , definition 2.1 from @xcite ( see also @xcite ) goes as follows : a set @xmath316 is called a _ set of metastable points _ if for all @xmath317 and @xmath318 , [ bovier def ] _ 0 = 0 . in words",
    ", this means that reaching @xmath319 from the outside of @xmath319 is much easier than traveling between different points of @xmath319 , in both cases with the restriction not to return to one s starting point first .    using lemma [ direct path lemma ] and lemma [ like unperturbed ]",
    ", it is easy to see that if we choose precisely one point from each of the @xmath204-essential classes @xmath12 , then the set @xmath320 is a set of metastable points . also",
    ", @xmath321 is maximal in the sense that adding a further point to @xmath321 will result in a set no longer fulfilling . on the other hand , removing points from @xmath321 or replacing them with points from @xmath207 may in certain cases still result in a metastable set , depending on the structure of the markov chain and the points in question .",
    "we will not pursue this further since @xmath321 is the most natural choice .",
    "of course , when some of the @xmath206 contain more than one point , the choice of @xmath321 is not unique .",
    "one of our main results is that when defining the effective chain by the transition matrix [ p hat ]    p_(x_i , x_j ) & : = _ e_i(x_i ) p^x_i_(x__s_0^+ = x_j ) i j , + p_(x_i , x_i ) & : = _ e_i(x_i ) p^x_i_(x__s_0^+ = x_i ) + 1 - _ e_i(x_i ) ,    then the relevant dynamical quantities will be asymptotically independent of the choice of the representatives @xmath322 .",
    "the occurrence of the expression @xmath323 in is intuitively obvious , since it means that we just monitor the chain when it hits one of our reference points @xmath324 .",
    "the factor @xmath325 may be less obvious . to motivate it ,",
    "note that by , [ explanation ]    p^x_i_(x__s_0^+ = x_j ) & = _ z s e_i p_^x(_e^c < _ x_i^+ , x__e^c = z ) p^z_(x__s_0 = x_j ) + & _ w e_i , z e_i _ e_i(w ) p_(w , z ) p^z_(x__s_0 = x_j ) .",
    "this shows that the factor @xmath325 in cancels one of the dependencies of @xmath323 on the choice of our set @xmath321 . while the terms @xmath326 still do depend on the choice of @xmath321",
    ", we will see below that including the factor @xmath325 in the definition is enough to obtain the asymptotically correct stationary distribution and escape probabilities .",
    "this justifies the following definition :    let @xmath10 be an irreducibly perturbed markov chain on a finite state space .",
    "the markov chain @xmath15 with state space @xmath321 and transition matrix is called the * effective metastable representation * of @xmath10 corresponding to @xmath321 .    in order to show the properties of the chain @xmath15 announced above",
    ", we define a second effective markov chain , this time without reference to a set of representatives . for @xmath327 with @xmath328",
    "we put [ q hat ] q_(e , e ) : = _ x e _",
    "e(x)^2 p_^x ( _ e^+ < _ x^+ ) , and @xmath329 .",
    "the @xmath330 are the elements of a transition matrix when @xmath0 is sufficiently small . as the following proposition shows , this chain is reversible and the reversible measure of @xmath227 is @xmath331 :    [ asymptotic detailed balance ] the quantities @xmath330 satisfy the asymptotic detailed balance equation @xmath332    the proof of proposition [ asymptotic detailed balance ] rests on the following simple lemma :    [ e instead of x ] let @xmath333 be @xmath204-essential classes , @xmath328 , @xmath299 , @xmath334 , and @xmath234 . then [ all the same ] p_^z(_y^+",
    "< _ x^+ ) p_^z(_e^+ <",
    "_ x^+ ) .    from lemma",
    "[ like unperturbed ] , we have @xmath335 for all @xmath336 .",
    "since @xmath337 for all @xmath299 , the strong markov property gives @xmath338    when @xmath339 , the claim holds trivially .",
    "for @xmath328 , pick @xmath299 and @xmath334 .",
    "we use corollary [ structure ] b ) , proposition [ basic fact ] , and corollary [ structure ] b ) again to find @xmath340 thus by , [ no x , y dependence ] _ ( e ) _",
    "e(x ) p_^x(_e^+ < _",
    "x^+ ) _ ( e ) _",
    "e(y ) p_^y(_e^+ < _ y^+ ) , for all @xmath299 .",
    "since the right - hand side is independent of @xmath31 , and the left - hand side is independent of @xmath32 , we find [ really no x dependence ] _",
    "e(x ) p_^x(_e^+ < _ x^+ ) _",
    "e(x ) p_^x ( _ e^+ < _ x^+ ) for all @xmath341 , and similarly for @xmath295 .",
    "thus when we multiply with @xmath342 and sum over @xmath299 and @xmath334 , we obtain the claim .",
    "the next result shows that the effective metastable representation @xmath15 indeed describes the metastable dynamics of @xmath10 correctly , in the sense that asymptotically it has the right escape probabilities and thus the right stationary distribution .",
    "let us write @xmath19 for the stationary distribution and @xmath343 for the path measure of @xmath15 .",
    "[ escape probs ] for @xmath344 , we have @xmath345 . in particular @xmath346 .    from and lemma [ e instead of x ]",
    ", we see that @xmath347 the markov property and the definition of @xmath348 then gives @xmath349 we will show below that for @xmath350 , [ remains ] p_^x_k(_x_j^+ < _ x_i^+ ) = p_^x_k(_x_j^+ < _ x_i^+ ) .",
    "once this is done , the markov property for @xmath343 shows the first claim , and from proposition [ asymptotic detailed balance ] we get @xmath351 since @xmath352 by proposition [ basic fact ] , we get @xmath353 since @xmath354 by corollary [ structure ] a ) , we can sum over @xmath355 and obtain @xmath356 , and thus @xmath346 .",
    "to show , we introduce the shorthand @xmath357 from , we get @xmath358 .",
    "now a standard application of the markov property with the stopping time @xmath359 shows that for @xmath350 , @xmath360 is the unique solution of the harmonic equation @xmath361 for all @xmath350 with boundary conditions @xmath362 , @xmath363 .",
    "likewise , @xmath364 is the unique solution of the harmonic equation @xmath365 for all @xmath350 with boundary conditions @xmath366 , @xmath367 .",
    "but since @xmath368 we must have @xmath369 , and the claim follows .    the advantage of the chain @xmath15 is that its transition matrix is almost diagonal in the sense that @xmath370 . in particular , @xmath15 is an irreducible perturbation of the trivial ( identity ) markov chain .",
    "it is now natural to rescale time so that the most likely transition between two different states becomes of order one .",
    "more precisely , we set [ p check ] p_(x_i , x_j ) : = , p_(x_i , x_i ) : = 1 - _ j : j i p_(x_i , x_j ) . since @xmath371",
    ", for each @xmath372 at least one of the terms in the finite sum must be large .",
    "the problem is that at this point we can not guarantee that the quantities @xmath373 converge . to see what could happen ,",
    "consider the example @xmath24 , @xmath374 , @xmath375 .",
    "then @xmath376 , but @xmath377 does not converge .",
    "of course , this also implies that @xmath42 does not exist .",
    "so far , we did not have to pay attention to that type of problem - all of our results above are valid as asymptotic equivalences , whether or not the quantities in question converge . now however , we need proper convergence to carry on , and will give a sufficient criterion .",
    "let @xmath210 , @xmath211 be two functions of @xmath2 .",
    "we say that @xmath213 and @xmath214 are _ asymptotically comparable _ , and write @xmath378 , if either both of them are strictly positive and @xmath379 exists in @xmath380 $ ] , or if one or both of them are identically zero .",
    "note that we allow @xmath288 and @xmath381 as possible limits .",
    "we caution the reader that unlike asymptotic equivalence , asymptotic comparability is not transitive , and is not stable under multiplications . on the other hand , it is obviously symmetric , and we have the following summability property : if @xmath382 , and @xmath383 are mutually asymptotically comparable , and if @xmath384 and @xmath385 have strictly positive , finite limits as @xmath1 , then [ asym comp summ ] _ a_+ _ b_~_c_.",
    "we say that an irreducibly perturbed markov chain @xmath10 is _ regular _ if for all @xmath386 and all sequences of pairs @xmath387 , @xmath388 with @xmath389 , we have [ regular def ] _",
    "i=1^n p_(x_i , y_i ) ~_i=1^m p_(z_i , w_i ) .",
    "we will call a transition matrix @xmath111 regular if the generated markov chain is regular .",
    "examples of regular perturbed markov chains include those treated in @xcite , where the transition elements are of the form @xmath390 with @xmath383 either converging to a strictly positive limit or identically zero , and @xmath391 independent of @xmath0 .",
    "they also include those with property @xmath392 introduced in @xcite .    [ conservation of regularity ] for a regular perturbed markov chain with transition matrix @xmath25 ,",
    "define @xmath348 as in , and @xmath393 as in .",
    "then @xmath348 and @xmath393 are transition matrices of regular perturbed markov chains .    by , for @xmath344 [ aa0 ] p_(x_i , x_j )",
    "_ w e_i , z",
    "e_i _ e_i(w ) p_(w , z ) p^z_(x__s_0 = x_j ) , and proposition [ second formula ] gives [ aaa ] p^z_(x__s_0 = x_j ) = _ _ s_0^c(z , x_j ) _ i=1^||-1 in lemma [ regularity lemma ] below we will show that if @xmath321 contains one representative of each @xmath204-essential class then @xmath394 exists and is strictly smaller than one for all @xmath171 .",
    "thus each @xmath395 exists .",
    "in other words , @xmath396 is given as a sum of terms of the form @xmath397 with @xmath398 , where @xmath399 exists for all @xmath400 .",
    "when plugging this into , we can apply the extension of to finite sums to show that @xmath348 is the transition matrix of a regular markov chain . by , this immediately implies convergence of the transition probabilities @xmath373 . rewriting the second equation in in the form @xmath401 we see in addition that the chain @xmath15 is a regular perturbed markov chain .",
    "it remains to prove the claim used in the proof above .",
    "[ regularity lemma ] let @xmath10 be a perturbed markov chain .",
    "assume that a set @xmath321 contains one element of each @xmath204-essential class .",
    "let @xmath44 with @xmath402 .",
    "then for all @xmath403 , @xmath404 exists and is strictly smaller than @xmath405 .",
    "as @xmath321 contains a representative of each @xmath204-essential class , there must be a @xmath204-relevant direct path @xmath171 from @xmath31 to some @xmath406 .",
    "so , @xmath407 .",
    "for the existence of the limit , let first @xmath408 . for @xmath409",
    ", we have @xmath410 as @xmath1 .",
    "let us now assume that the claim holds for all @xmath411 such that @xmath412 with some @xmath413 .",
    "let @xmath90 be such that @xmath414 .",
    "then , @xmath415 by the induction hypothesis , @xmath416 exists and is strictly smaller than @xmath405 .",
    "thus also @xmath417 exists and is strictly smaller than @xmath405 .",
    "the claim follows by induction .",
    "we have thus found a way to successively describe the multi - scale metastable dynamics of regular perturbed markov chains : starting with the original chain @xmath10 , we derive @xmath15 and then @xmath418 . by theorem",
    "[ conservation of regularity ] , @xmath15 and @xmath418 are again regular perturbed markov chains .",
    "moreover , all of the @xmath419-essential classes consist of exactly one element , and @xmath420 whenever @xmath344 .",
    "so , @xmath348 describes the effective metastable dynamics , but still in the original time scale .",
    "the transformation from @xmath348 to @xmath393 means that we go to a time scale where the most likely transitions between different states become of order one . in other words , there exist @xmath344 with @xmath421 . by lemma [ direct path lemma ] , this implies that @xmath422 will no longer be a @xmath423-essential class on its own : it will either form a larger @xmath423-essential class together with some @xmath424 , @xmath425 , or it will have become @xmath423-transient . in any case , the number of @xmath423-essential classes will be smaller than the number of @xmath204-essential classes .",
    "thus by applying the transformations @xmath426 to the matrix @xmath393 , and iterating the procedure , we can recursively explore longer and longer time scales of the dynamics .    on a purely theoretical level ,",
    "our theory of multi - scale metastable dynamics for regular perturbed markov chains is thus complete .",
    "however , if one attempts to ( numerically ) compute the transition probabilities at the different time scales , the problem arises that all relevant expressions in our theory still contain terms of the form @xmath427 . in the next section",
    ", we will show why naive attempts to compute this quantity numerically are likely to fail , and present a numerically stable algorithm for computing them .",
    "a byproduct of our algorithm is a numerically stable method to compute the matrix elements of the transition matrix @xmath428 , and thus the stationary weights @xmath266 for all @xmath204-essential classes @xmath201 .",
    "this section deals with aspects of the numerical computation of the transition probabilities @xmath429 and @xmath330 given in and , respectively . before we proceed we would like to make clear that subtle issues coming from the field of _ computable analysis _ fall beyond the scope of this article . intuitively though",
    ", we mean the following by `` numerical computation '' : if someone enumerates , step by step , all members of an infinite sequence of transition matrices @xmath430 that converge towards @xmath431 , we are able to process each @xmath430 using only a computer and produce , step by step , an infinite sequence that converges towards the matrices @xmath432 ( or @xmath433 ) .",
    "this corresponds roughly to the property of being _",
    "computably approximable_. note that in this case we do not know how fast the sequence is converging to the limit . said otherwise , if we want a precise approximation of , say , @xmath432 , we have no idea until which @xmath434 we should process the @xmath430 . this is a usual issue in numerical analysis . if in addition we would know that the @xmath68-th approximation is , _",
    "e.g. _ , at most @xmath435 away from the limit , we would know when to stop to obtain the desired precision .",
    "this corresponds roughly to the property of being _",
    "computable_.    the starting point of our considerations are the formulae [ p eps numeric ] p_(x_i , x_j ) = _ e_i(x_i ) ( _ j i p_(x_i , x_j ) + _ z s_0 p_(x_i , z ) p_^z ( x__s_0 = x_j ) ) , and [ q eps numeric ] q_(e , e ) = _ x e _ e(x)^2 ( _ y e p_(x , y ) + _ z \\{x } e p_(x , z ) p_^z(_e^+ < _ x^+ ) ) , both of which are obtained from the definition of the respective quantities using the strong markov property . in both cases , the task is to compute a hitting probability of the form [ committor def ] h_a , b(z ) : = p_^z(x__a b a ) , where @xmath130 and @xmath436 . in the case of @xmath437 , @xmath438 and @xmath439 . such hitting probabilities are well understood in the theory of markov processes : @xmath440 is called the committor function in @xcite and the equilibrium potential of the capacitator @xmath441 in @xcite , and is the unique harmonic continuation from @xmath442 to @xmath5 of the indicator function @xmath443 of @xmath90 .",
    "this means that @xmath440 is the unique solution of the linear system [ possibly ill conditioned ] _ z s c(p_(x , z ) - _ x , z ) h_a , b(z ) = - r(x ) , x c^c = s c , where @xmath444 .",
    "let us write @xmath445 for the restriction of @xmath25 to @xmath446 .",
    "if @xmath447 and @xmath25 is irreducible , we have seen in the proof of proposition [ quotient ] that @xmath448 is invertible .",
    "we thus find the committor function by matrix inversion : [ matrix formulation ] h_a , b(x ) = [ ( 1-     the problem with this formula is that as @xmath1 , the matrix @xmath449 may converge to a non - invertible matrix . in that case , some matrix elements of @xmath450 will diverge , and even though the quantities @xmath451 themselves are bounded by @xmath405 for all @xmath0 , computing them numerically becomes unreliable as @xmath1 .",
    "our first result will identify situations where this can not happen .",
    "we call a state @xmath84 an _ asymptotic dynamical trap _ ( or simply a trap ) with respect to @xmath147 if @xmath452 a necessary condition for @xmath32 to be a trap is that there exists no direct @xmath204-relevant path from @xmath32 into @xmath147 . on the other hand , for all @xmath234",
    "there is at least one @xmath204-relevant path from @xmath32 to some @xmath204-essential class .",
    "thus if @xmath147 intersects all @xmath204-essential classes , no traps will exist .",
    "recall that for a matrix @xmath111 , the _ condition number _ is given by @xmath453 , where @xmath122 is the operator norm with respect to any norm on the underlying vector space . in our case",
    ", it is convenient to use the supremum norm on the vector space .      since @xmath456 is substochastic , clearly @xmath457 . on the other hand ,",
    "the absence of traps with respect to @xmath147 allows us to find @xmath458 and @xmath459 , both of them independent of @xmath0 , and so that @xmath460 for all @xmath22 .",
    "the strong markov property then implies @xmath461 for all @xmath413 and all @xmath22 .",
    "thus for @xmath462 and bounded @xmath463 , we find @xmath464 consequently , the left - hand side above is absolutely summable , and @xmath465 for all @xmath462 . taking the supremum over @xmath31 , the claim follows .    by construction",
    ", @xmath321 contains precisely one point of each @xmath204-essential class , and thus there are no asymptotic dynamical traps with respect to @xmath321 . by proposition [ condition nr ] and",
    "we can thus compute @xmath466 in a numerically stable way .",
    "in fact , the perturbative nature of the problem makes the following newton scheme particularly useful .",
    "let @xmath467 denote the restriction of @xmath25 to @xmath468 , and set @xmath469 . by , we need to find @xmath470 .",
    "we use @xmath471 as a seed for the newton iteration , and employ the usual recursion @xmath472 . by putting @xmath473 , we find @xmath474 and @xmath475 .",
    "so , @xmath476 is a polynomial in @xmath477 , and we can use the resulting commutativity to obtain [ newton 2 ] b_k+1 - a_^-1 = - a_0 ^ -1 a_(b_k - a_^-1 ) a_0 ( b_k - a_^-1 ) for all @xmath89 . in the special case @xmath478 , this can be transformed to [ newton 1 ] b_1 - a_^-1 = a_0 ^ -1 ( a_- a_0 ) ( a_^-1 - a_0 ^ -1 ) = a_0 ^ -1 ( |p_0 - |p _ ) ( a_^-1 - a_0 ^ -1 ) .",
    "thus @xmath479 and @xmath480 proposition [ condition nr ] guarantees that we can choose @xmath0 sufficiently small so that @xmath481 converges to @xmath470 very quickly . to illustrate this , we restrict ourselves to the special case where @xmath482 with the matrix @xmath483 bounded uniformly in @xmath2 .",
    "then , @xmath484 for some @xmath485 , and @xmath486 this means that when we are interested only in transitions of size @xmath487 or bigger , we only have to calculate logarithmically ( in @xmath68 ) many @xmath481 .",
    "therefore , it might seem that all is well , but this is not entirely so .",
    "the reason is that a subtle problem arises from the multi - scale structure of the dynamics : at a given metastable time scale , it is in general not obvious what computational accuracy we need to achieve in order to obtain the asymptotically correct dynamics on longer metastable time scales .",
    "this phenomenon can best be explained by an example .",
    "figure [ figure example ] shows a graphical representation of a couple of metastable markov chains . for both of them , @xmath488 , and",
    "both of them have transition probabilities corresponding to the solid arrows : @xmath489 , @xmath490 , and @xmath491 .",
    "only one of them has the dashed arrows , i.e.  @xmath492 .",
    "all other transition probabilities are zero except those mapping a point to itself , which are adjusted to give a stochastic matrix . with or without the dashed arrows ,",
    "@xmath29 , @xmath30 and @xmath493 are the @xmath204-essential classes , while @xmath124 is @xmath204-transient . also in both cases , @xmath494 , while @xmath495 .",
    "so on the first metastable time scale , transitions from @xmath31 to @xmath62 play no role .",
    "but whether or not we can stop our computation of @xmath496 after reaching order @xmath0 depends on the presence of the dashed arrows .",
    "if the dashed arrows are present , we can stop the computation of @xmath429 after reaching order @xmath0 : on the next ( and final ) metastable time scale , we will have @xmath497 and @xmath498 .",
    "@xmath62 will be connected to @xmath31 via @xmath32 , by transition probabilities of order one .    however",
    ", if the dashed arrows are absent , stopping the calculation at order @xmath0 leads to an effective markov chain where @xmath62 can not be reached from @xmath31 , and thus to wrong results on the next metastable time scale . in the correct dynamics on that time scale @xmath31 and",
    "@xmath32 form a new effective metastable state , and transitions between it and @xmath62 are ( after rescaling ) of order @xmath0 .",
    "for this to be resolved correctly , the transition from @xmath31 to @xmath62 of order @xmath499 needs to be present already in the effective dynamics on the first metastable time scale .    in the simple example at hand it is easy to directly figure out what is going on , but to decide when a given approximation of @xmath429 is good enough to give correct dynamical results on all further metastable time scales for general chains on large state spaces is a subtle problem .",
    "here we only give a necessary condition , about which we conjecture that it is also sufficient , and which is accessible to numerical validation .",
    "let us write @xmath500 for path measure of a given approximation to the chain @xmath15 . by theorem [ escape probs ] , @xmath501 when @xmath322 is the representative from @xmath206 and @xmath324 the representative from @xmath502 , and thus @xmath503 for all @xmath355 .",
    "so in order to obtain the correct asymptotic stationary distribution for our approximate chain , we have to increase the accuracy at least until [ necessary cond ] q_(e_i , e_j ) p_,a^x_i ( _ x_j < _ x_i ) .",
    "it would not be surprising if this were already sufficient for some sort of agreement of the metastable dynamics on all further metastable time scales .",
    "since in general the escape probabilities do not characterize the transition probabilities of a markov chain , a proof of this conjecture is not immediate , and we do not pursue this any further here .",
    "instead , we discuss how to check numerically .    by , the numerically tricky part in computing @xmath504 is @xmath505 .",
    "since @xmath506 will not intersect all @xmath204-essential classes unless there are only two of them , we can not use proposition [ condition nr ] this time , and indeed in most situations a direct calculation of will be numerically unreliable .",
    "however , for the very same reason , namely since @xmath147 intersects only two @xmath204-essential classes , we can successively lift these traps and arrive at a simplified chain without traps for which the probability of hitting @xmath295 before @xmath31 is asymptotically equivalent to the original one .    the basic step in this procedure is the following .",
    "assume that @xmath201 is a @xmath204-essential class of a perturbed markov chain @xmath10 , and that @xmath507 .",
    "we define a new markov chain @xmath267 on the state space @xmath508 by its transition probabilities @xmath509 , where @xmath510 whenever @xmath511 , and [ hat transitions ] p_(x , e ) : = _ z e p_(x , z ) , p_(e , x ) : = _ z e _",
    "e(z ) p_(z , x ) , p(e , e):=0 for all @xmath512 .",
    "here , @xmath513 is the normalization that ensures that @xmath146 is a stochastic matrix .",
    "we say that the traps in @xmath201 ( with respect to @xmath514 ) have been lifted in @xmath267 .",
    "this terminology is justified by    [ lifting the trap ] let @xmath10 be a perturbed markov chain , @xmath201 a @xmath204-essential class of @xmath10 , and @xmath267 the markov chain where @xmath201 has been lifted . + a ) let @xmath515 .",
    "then for all @xmath516 , @xmath517 , while for @xmath255 , @xmath518",
    ". + b ) if @xmath10 is regular , then @xmath267 is a regular perturbed markov chain .",
    "+ c ) if @xmath10 is regular , then either @xmath201 is a @xmath519-transient state , or @xmath201 is an element of a @xmath519-essential class that contains at least one further element @xmath253 . in the latter case ,",
    "the number of @xmath519-transient states is strictly smaller than the number of @xmath204-transient states .",
    "consider the chain @xmath520 with state space @xmath5 and transition matrix @xmath483 , where @xmath521 when @xmath231 and @xmath522 when @xmath299 .",
    "denoting its path measure by @xmath523 , proposition [ effective chain ] gives @xmath524 for all @xmath234 .",
    "we now define @xmath525 by replacing @xmath526 with @xmath527 for @xmath299 , and keeping them the same if @xmath231 .",
    "then implies that @xmath528 for all @xmath9 , and thus theorem [ chain comparison ] gives @xmath529 .",
    "finally , noting that @xmath530 does not depend on @xmath62 whenever @xmath255 , we can replace all @xmath255 by a single state @xmath531 , and claim a ) follows .",
    "for b ) , note that by regularity of the chain , @xmath532 for all @xmath231 .",
    "so the quotient in either converges or diverges to infinity as @xmath533 .",
    "since it is bounded by @xmath405 by construction , the latter is not an option , and the @xmath534 converge .",
    "so the markov chain defined by them is a perturbed markov chain . finally , this markov chain is again regular , since products of its elements can be written as weighted sums of products of the @xmath535 with nonnegative weights .",
    "we have shown b ) .    for c ) ,",
    "note that by b ) @xmath536 exists , and since @xmath537 , there must be at least one state @xmath538 with @xmath539 .",
    "lemma [ direct path lemma ] implies that if @xmath295 is a @xmath204-essential class with @xmath328 , then all direct paths from @xmath295 to @xmath201 are @xmath204-irrelevant .",
    "so if one of the elements @xmath32 with @xmath539 is connected to a different @xmath204-essential class via a @xmath204-relevant direct path , then @xmath201 is @xmath519-transient . on the other hand ,",
    "if no @xmath32 is connected to any @xmath540 by such a direct path , then each such @xmath32 must be an element of @xmath207 , and must be connected to @xmath201 by a @xmath204-relevant direct path .",
    "it follows that @xmath32 is in the same @xmath519-essential class as @xmath201 , and thus not a @xmath519-transient state .",
    "the claim follows .",
    "using theorem [ lifting the trap ] , we can now give a general recursive algorithm for numerically computing expressions @xmath541 of the form given in simultaneously for all @xmath234 , up to asymptotic equivalence :    1 .",
    "determine the set @xmath542 of all @xmath204-essential classes not intersecting @xmath543 .",
    "2 .   if @xmath544 , compute @xmath440 by solving the well - conditioned linear system .",
    "finish the algorithm .",
    "3 .   compute the @xmath204-stationary measures @xmath229 for each @xmath545 .",
    "4 .   lift all the traps in @xmath545 by .",
    "this results in a new state space , where all elements of @xmath201 are replaced by a single state @xmath201 .",
    "keep track of the elements of the original state space that become lumped into @xmath201 .",
    "return to ( 1 ) with the new state space .",
    "we note that steps ( 3 ) and ( 4 ) are trivial to parallelize . by theorem [ lifting the trap ]",
    "c ) , each step either decreases the number of @xmath204-essential classes in the chain , or leaves it unchanged and decreases the number of transient states .",
    "we thus see that the algorithm terminates .",
    "once it does ( in step 2 ) , we know @xmath546 for all @xmath547 in the final state space @xmath548 .",
    "theorem [ lifting the trap ] a ) now guarantees that @xmath549 for all states @xmath62 of the chain from the previous step that were collapsed into @xmath547 .",
    "thus we can recursively go backwards until we reach the original state space , where we now know all @xmath451 up to asymptotic equivalence .",
    "in particular , this gives a stable algorithm for the asymptotic numerical approximation of the coefficients @xmath330 .",
    "since the expressions @xmath550 are also escape probabilities ( for a different markov chain ) , we can compute them by the same algorithm .",
    "if they agree with @xmath504 to leading order in @xmath0 , our necessary criterion is met and the approximate chain has the same asymptotic stationary measure as the true one .",
    "another useful aspect of our algorithm is that the @xmath330 determine the limiting stationary distribution of the chain through the formula @xmath551 which is derived in analogy to , using proposition [ asymptotic detailed balance ] .",
    "computing the stationary distribution of a large markov chain with many metastable sets is a very important problem in practice .",
    "for example , it is how internet search engines compute page importance ranks . as a consequence ,",
    "there has been tremendous activity in the computer science community on the topic .",
    "most of the developments seem to be based on a seminal paper by simon and ando @xcite .",
    "seemingly independently , the problem has been treated by a much smaller group of people in mathematical economy , starting with @xcite and with significant recent progress by wicks and greenwald @xcite .",
    "both approaches are based on formula , which itself is closely related to . in the literature following @xcite and @xcite",
    ", this leads to what is known as the method of the stochastic complement . for a finite markov chain @xmath43 on a state space @xmath5 , the first step of the method is to decompose @xmath5 into disjoint sets @xmath552 .",
    "equation with @xmath553 then allows to compute [ andos ] p(x , y ) : = p^x(x__s_j^+=y ) for @xmath9 by using matrix multiplications and by computing the inverse of the matrix @xmath554 .",
    "the @xmath555 are the transition probabilities of an effective markov chain only running inside @xmath556 .",
    "writing @xmath557 for the stationary distribution of the effective chain , and @xmath50 for the full stationary distribution , it can be shown that [ ando1 ] ( x ) = _ j _ j(x ) for all @xmath558 , where @xmath559 is the stationary distribution of the markov chain with state space @xmath560 and transition probabilities [ ando2 ] q(s_i , s_j ) = _ x s_i , y s_j _ i(x ) p(x , y ) .",
    "equation is similar to the statements of our corollary [ structure ] , with the @xmath561 taking the role of @xmath266 , and the @xmath562 the role of @xmath563 .",
    "equation is in analogy to the expression [ fo1 ] p_(x_i , x_j ) _ w e_i , z e_i",
    "_ e_i(w ) p_(w , z ) p_^z(x__s_0 = x_j ) that we get for @xmath564 when combining and .",
    "the drawback of the method is that a priori , we have no control over the numerical difficulty of computing @xmath565 . for example , let @xmath566 consist of two elements @xmath23 .",
    "then @xmath567 , and thus the computation of @xmath555 is no easier than the problem we have treated in the present paper ; in particular , if @xmath43 is a perturbed markov chain and @xmath31 and @xmath32 are in different @xmath204-essential classes , the matrix @xmath554 will become singular as @xmath1 . therefore without any further assumptions , the theory of simon and ando as it stands gives no numerically feasible way of computing @xmath50 .",
    "a suitable such further assumption is to choose the decomposition in a way that makes all transitions between different @xmath556 small .",
    "the situation where this is possible has been treated already in @xcite , and is nowadays known as a the theory of nearly reducible ( or nearly decomposable ) markov chains . in the framework of the present paper ,",
    "a perturbed markov chain is nearly reducible if for each @xmath84 there exists a unique @xmath204-essential class @xmath568 so that all @xmath204-relevant paths from @xmath32 to @xmath569 end in @xmath568 . in the terminology of @xcite ,",
    "this means that the local valleys corresponding to the maximal metastable set @xmath320 from section [ dynamics ] do not intersect .",
    "when a markov chain is nearly reducible , it is known ( and follows from in our case ) that we can ignore transitions between different @xmath556 for the approximate computation of the @xmath557 ; in the case of perturbed markov chains and when each @xmath556 contains exactly one @xmath204-essential class @xmath502 , this means @xmath570 .",
    "the reduced chain is then similar to our @xmath571 , and by a recursive algorithm similar to the one given in the present section , the stationary measure @xmath50 can be computed .",
    "so in the context of nearly reducible markov chains , the contribution of our work is on the one hand a systematic , rigorous asymptotic theory , and on the other hand an extension to the case where the markov chain no longer needs to be nearly reducible : in the latter case , the @xmath502 take the role of the @xmath556 , and the presence of the transient set is accounted for by replacing by , together with a recipe to compute the escape probabilities contained in the latter equation .",
    "the second approach that we are aware of which uses is the recent work by wicks and greenwald @xcite , who call their approach the method of the stochastic quotient .",
    "they work in the situation where @xmath482 with bounded corrector matrix @xmath483 , and they do not need to assume almost decomposability . as we do , they pick a representative @xmath31 from each @xmath204-essential class @xmath201 .",
    "then they apply with @xmath572 , i.e. they compute the probabilities to either leave @xmath201 at a given @xmath573 , or to return to @xmath31 .",
    "the leading order of this quantity can be computed efficiently by a matrix calculation , since the matrices @xmath574 remain bounded as @xmath1 thanks to the absence of @xmath31 from @xmath109 . indeed , as wicks and greenwald note",
    ", it suffices to invert @xmath575 .",
    "this construction leads to an effective chain where the class @xmath201 is replaced by a @xmath204-essential class containing just the one element @xmath31 .",
    "they do this construction for all @xmath204-essential classes , and indeed also for transient communicating classes .",
    "after that , they rescale transition probabilities out of each of the ( now trivial ) @xmath204-essential classes much like we do in , keeping track of the factors by which they speed up each individual trap .",
    "this results in a markov chain with fewer @xmath204-essential states , or fewer transient states .",
    "recursively iterating the procedure while always keeping track of the rescaling factors , they arrive at a stable algorithm for computing the stationary distribution .",
    "it is obvious that the algorithm of wicks and greenwald and ours share quite similar ideas .",
    "the difference is that while our algorithm lifts metastable traps completely , the wicks - greenwald algorithm keeps one point in each trap .",
    "the advantage of the wicks - greenwald algorithm is that the whole stationary distribution can be computed at once , while in our algorithm one has to compute @xmath576 separately for each pair @xmath333 .",
    "the advantage of our approach is that it is local : if we are only interested in the relative importance of two given states @xmath299 and @xmath334 , we need only compute the ratio @xmath577 . depending on the structure of the chain ,",
    "this can be done by lifting only a tiny fraction of the traps present in the state space .",
    "an additional advantage of our approach is of course that we also obtain information about the metastable dynamics , information which is not contained in the stationary distribution alone .",
    "a. milias - argeitis , j. lygeros .",
    "efficient stochastic simulation of metastable markov chains , _",
    "50th ieee conference on decision and control and european control conference ( cdc - ecc ) orlando , fl , usa , december 12 - 15 _ , 2011                    j.r .",
    "wicks , a. greenwald : an algorithm for computing stochastically stable distributions with applications to multiagent learning in repeated games . _",
    "proceedings of the 21st conference in uncertainty in artificial intelligence , 2005_. auai press 2005    j.r .",
    "wicks , a. greenwald : a quotient construction on markov chains with applications to the theory of generalized simulated annealing . _",
    "international symposium on artificial intelligence and mathematics ( isaim 2006 ) , fort lauderdale , florida , usa_."
  ],
  "abstract_text": [
    "<S> we consider a simple but important class of metastable discrete time markov chains , which we call perturbed markov chains . </S>",
    "<S> basically , we assume that the transition matrices depend on a parameter @xmath0 , and converge as @xmath1 . </S>",
    "<S> we further assume that the chain is irreducible for @xmath2 but may have several essential communicating classes when @xmath3 . </S>",
    "<S> this leads to metastable behavior , possibly on multiple time scales . for each of the relevant time scales , </S>",
    "<S> we derive two effective chains . </S>",
    "<S> the first one describes the ( possibly irreversible ) metastable dynamics , while the second one is reversible and describes metastable escape probabilities . </S>",
    "<S> closed probabilistic expressions are given for the asymptotic transition probabilities of these chains , but we also show how to compute them in a fast and numerically stable way . as a consequence , </S>",
    "<S> we obtain efficient algorithms for computing the committor function and the limiting stationary distribution .     </S>",
    "<S> escape times , non - reversible markov chains , asymptotics     60j10 , 60j22 </S>"
  ]
}