{
  "article_text": [
    "this paper is devoted to the numerical study of a macroscopic version of the vicsek model which describes swarming behavior .",
    "this macroscopic model has been derived in @xcite from the microscopic vicsek model @xcite .",
    "the goal of this work is to provide a numerical validation of the macroscopic model by comparing it with simulations of the microscopic model .    the vicsek model @xcite is widely used to describe swarming behavior such as flock of birds @xcite , schools of fish @xcite ( in this case the model is combined with an attractive - repulsive force ) or recently the motion of locusts @xcite .",
    "in this model , individuals have a constant velocity and they tend to align with their neighbors . despite the simplicity of the model , a lot of questions remain open about it .",
    "a first field of research concerns phase transitions within the model depending on the level of noise @xcite .",
    "another question arises from the long time dynamics of the model @xcite : is there convergence to a stationary state of the system ? from another perspective ,",
    "since collective displacements in natural environment can concern up to several million individuals , it is natural to look for a macroscopic version of the vicsek model . on the one hand ,",
    "macroscopic models constitute powerful analytical tools to study the dynamics at large scales @xcite . on the other hand ,",
    "the related numerical schemes are computationally much more efficient compared with particle simulations of a large number of interacting agents . in @xcite , a macroscopic vicsek model ( mv ) has been derived from a large scale limit of the microscopic vicsek model .",
    "the macroscopic model is obtained from a rigorous perturbation theory of the original vicsek model .",
    "another macroscopic model is obtained in @xcite based on more phenomenological closure assumptions .",
    "the mv model presents several specificities which make the model interesting .",
    "first , it is a non - conservative hyperbolic system and secondly it involves a geometric constraint .",
    "these are the consequences at the macroscopic level of two specificities of the microscopic model : the total momentum is not conserved by the particle dynamics and the speed of the particles is constant .",
    "the first property is an intrinsic property of self - propelled particles and the second property is a usual assumption in the models of collective displacements @xcite .",
    "up to our knowledge the theory of such systems is almost empty .",
    "non - conservative systems have been studied in the literature @xcite but none of them involve geometric constraints .    in this work , since a theoretical framework for such systems is not available , we adopt several approaches .",
    "first , we introduce a conservative formulation for the 1d formulation of the mv model which is equivalent to the initial one for smooth solutions only . with this conservative formulation",
    ", we can use standard hyperbolic theory to build riemann problem solution and shock capturing schemes @xcite . the numerical scheme based on the conservative formulation",
    "is called _ conservative method_. but since the equivalence with the original formulation is only valid for smooth solutions @xcite , there is no guarantee that the conservative formulation gives the right answer at shocks .",
    "for this reason , we introduce another formulation of the mv model where the constraint is treated through the relaxation limit of an unconstrained conservative system .",
    "this formulation leads to a natural numerical scheme based on a splitting between the conservative part of the equation and the relaxation .",
    "this scheme will be referred to as the _ splitting method_. for comparison purposes , two other numerical schemes are also used , an _ upwind scheme _ and a _ semi - conservative _ one ( where only the mass conservation equation is treated in a conservative way ) .",
    "the numerical simulations of the mv model reveal that the numerical schemes all agree on rarefaction waves but disagree on shock waves . to determine the correct solution",
    ", we use the microscopic model in a regime where its solution is close to that of the macroscopic model . in practice",
    ", this corresponds to regimes where the number of particles per domain of interaction is high .",
    "the splitting method turns out to be in good agreement with particle simulations of the microscopic model , by contrast with the other schemes .",
    "in particular , for an initial condition with a contact discontinuity , the solution given by the conservative form is simply a convection of the initial condition whereas the splitting method and the particle simulations agree on a different and more complex solution .",
    "these results show first that the mv model well describes the microscopic model in the dense regime .",
    "secondly , that the correct formulation of the mv model is given by the limit of a conservative equation with a stiff relaxation term .",
    "the theoretical and numerical studies of the mv model highlight the specificity of non - conservative hyperbolic models with geometric constraints .",
    "more theoretical work is necessary in order to understand why the splitting method matches the microscopic model whereas the other methods do not . in particular , an extension of the theory developed in @xcite to non - conservative relaxed models",
    "would be highly desirable .",
    "the outline of the paper is as follows : first , we present the vicsek and mv models in section [ sec : presentation_mv ] .",
    "then , we analyze the mv model and give two different formulations of the model in section [ sec : macro_equa ] . we develop different numerical schemes based on these formulations and we use them to numerically solve different riemann problems in section [ sec : num_simu_cva_macro ] .",
    "finally , we compare simulations of the microscopic model with those of the macroscopic system in the same situations in section [ sec : micro_cva ] . finally , we draw a conclusion .",
    "at the particle level , the vicsek model describes the motion of particles which tend to align with their neighbors .",
    "we denote by @xmath0 the position vector of the @xmath1 particle and by @xmath2 its velocity with a constant speed ( @xmath3 ) . to simplify , we suppose that the particles move in a plane .",
    "therefore @xmath4 and @xmath5 . the vicsek model at the microscopic level",
    "is given by the following equations ( in dimensionless variables ) : @xmath6 where @xmath7 is the identity matrix and the symbol @xmath8 denotes the tensor product of vectors .",
    "@xmath9 is the intensity of noise , @xmath10 is the brownian motion and @xmath11 is the direction of mean velocity around the @xmath12 particle defined by : @xmath13 where @xmath14 defines the radius of the interaction region . equation ( [ cont_orient_bis ] ) expresses the tendency of particles to move in the same direction as their neighbors . the operator @xmath15 is the orthogonal projector onto the plane perpendicular to @xmath2 .",
    "it ensures that the speed of particles remains constant .",
    "this model is already a modification of the original vicsek model @xcite , which is a time - discrete algorithm .",
    "the macroscopic vicsek model ( mv ) describes the evolution of two macroscopic quantities : the density of particles @xmath16 and the direction of the flow @xmath17 .",
    "the evolution of @xmath16 and @xmath17 is governed by the following equations : @xmath18 where @xmath19 , @xmath20 and @xmath21 are some constants depending on the noise parameter @xmath9 .",
    "the expressions of @xmath19 , @xmath20 and @xmath21 are given in appendix [ sec : coeff ] .",
    "by contrast with the standard euler system , the two convection coefficients @xmath19 and @xmath20 are different .",
    "the other specificity of this model is the constraint @xmath22 .",
    "the operator @xmath23 ensures that this constraint is propagated provided that it is true at the initial time . the passage from ( [ cont_pos_bis])-([cont_orient_bis ] ) to ( [ eq : macro_rho])-([eq : macro_omega])-([eq : macro_constraint ] )",
    "is detailed in @xcite .",
    "we note that vortex configurations are special stationary solutions of this model in two dimensions ( see appendix [ sec : moulin ] ) . up to our knowledge , this is the first swarming model which have such analytical solutions .",
    "to study model ( [ eq : macro_rho])-([eq : macro_omega])-([eq : macro_constraint ] ) , we first use the rescaling @xmath24",
    ". then equations ( [ eq : macro_rho])-([eq : macro_omega])-([eq : macro_constraint ] ) are written : @xmath25 with @xmath26 and @xmath27 . in the sequel , we drop the primes for clarity .",
    "we refer to the appendix [ sec : coeff ] for the computation of @xmath28 and @xmath29 and we just mention that we have ( see figure [ fig : div_c1 ] ) : @xmath30    in two dimensions , we can use a parameterization of @xmath17 in polar coordinates : @xmath31 .",
    "therefore , equations ( [ eq : macro2_rho])-([eq : macro2_omega ] ) can be rewritten as : @xmath32 in this section , we suppose that @xmath16 and @xmath33 are independent of @xmath34 meaning that we are looking at waves which propagate in the x - direction . under this assumption ,",
    "the system reads : @xmath35 with @xmath36.\\ ] ] the characteristic velocities of this system are given by @xmath37\\ ] ] with @xmath38 .",
    "therefore , the system is strictly _",
    "a possible choice of right eigenvectors is @xmath39 the two fields are genuinely nonlinear except at @xmath40 , @xmath41 and at the extrema values of @xmath42 which satisfy : @xmath43.\\ ] ]     and @xmath44 depending on @xmath33 ( @xmath45 in this graph ) . for each curve",
    ", there exists a unique extremum ( @xmath46 and @xmath47 ) which corresponds to a degeneracy of the system . ]    the riemann invariants of the system ( [ eq:2d_x_nc ] ) are given by : @xmath48 the integral curve @xmath49 and @xmath50 starting from @xmath51 are given by : @xmath52 these are the rarefaction curves .",
    "to select the physically admissible rarefaction curve , we remark that @xmath53 must grow from the left to right states .",
    "the proofs of these elementary facts are omitted .",
    "the quantities @xmath54 as functions of @xmath33 are depicted in figure [ fig : vp ] .      for non - conservative systems , shock waves are not uniquely defined @xcite . however , in the present case , a conservative formulation of the system can be found in dimension 1 .",
    "indeed , it is an easy matter to see that , if @xmath55 , system ( [ eq:2d_x_nc ] ) can be rewritten in conservative form : @xmath56 with : @xmath57 however , the functions @xmath58 and @xmath59 are singular when @xmath60 which means that the conservative form is only valid as long as @xmath33 stays away from @xmath61 .",
    "the conservative form ( [ eq:1dcons_x ] ) leads to the following rankine - hugoniot conditions for shock waves : two states @xmath51 and @xmath62 are connected by a shock wave traveling at a constant speed @xmath63 if they satisfy : @xmath64    we can combine the two equations of the system ( [ eq : rh ] ) to eliminate the constant @xmath63 and this leads to the following expression of the shock curve : @xmath65 this equation must be numerically solved .",
    "the entropic part of the shock curve is determined by the requirement that @xmath42 must satisfy the lax entropy condition . in figure",
    "[ fig : u_lmr ] , we give an example of a solution of a riemann problem obtained by computing the intersection of the shock and rarefaction curves .     and @xmath66 ( solid line for shock waves and dotted line for rarefaction waves ) .",
    "in this example , the solution is given by two shock waves . ]",
    "we are going to prove that the mv model ( [ eq : macro2_rho])-([eq : macro2_omega])-([eq : macro2_constraint ] ) can be seen as the relaxation limit of a conservative hyperbolic model with a relaxation term .",
    "this link will be used later to build a new numerical scheme .",
    "more precisely , we introduce the relaxation model : @xmath67 in this model , the constraint @xmath22 is replaced by a relaxation operator .",
    "formally , in the limit @xmath68 , we recover the constraint @xmath22 .",
    "[ ppo : umv_mv ] the relaxation model ( [ eq : umv_rho])-([eq : umv_rho ] ) converges to the mv model ( [ eq : macro2_rho])-([eq : macro2_omega])-([eq : macro2_constraint ] ) as @xmath69 goes to zero .",
    "we define @xmath70 .",
    "suppose that as @xmath69 goes to zero : @xmath71 then @xmath72 , which generically implies that @xmath73 ( except where @xmath74 which one assumes to be a negligible set ) .",
    "therefore , we have : @xmath75 then since @xmath76 , we have : @xmath77 and consequently when @xmath68 : @xmath78 for a real number @xmath79 to be determined . taking the scalar product of ( [ eq : om_0_alpha ] ) with @xmath80 and using ( [ eq : om_0 ] ) , we find : @xmath81 using the conservation of mass ( @xmath82 ) , we finally have : @xmath83 therefore , the relaxation term satisfies : @xmath84 \\omega^0 + o({\\varepsilon}).\\ ] ] inserting in ( [ eq : umv_rho])-([eq : umv_omega ] ) and taking the limit @xmath68 , we recover the mv model ( [ eq : macro2_rho])-([eq : macro2_omega ] ) at the first order in @xmath69 .    as for the mv model",
    ", we can also analyze the hyperbolicity of the left hand side of ( [ eq : umv_rho])-([eq : umv_omega ] ) .",
    "the eigenvalues are given by : @xmath85 where @xmath86 denotes the @xmath87-coordinate of @xmath17 and @xmath88 .",
    "the system is hyperbolic if and only if @xmath89 .",
    "as we can see in figure [ fig : hyp_umv2 ] , for @xmath90 , @xmath91 is positive for any values of the noise parameter @xmath9 . in particular",
    ", this implies that the relaxation model is hyperbolic for every @xmath92 .     depending on @xmath9 . the relaxation model ( [ eq : umv_rho])-([eq : umv_rho ] )",
    "is hyperbolic when the speed @xmath93 is below this curve . at the limit @xmath68 , @xmath94 and",
    "therefore the relaxation model is hyperbolic for any @xmath9 in this limit . ]",
    "we propose four different numerical schemes to solve the mv model .",
    "the first two schemes originate from the discussions of the previous section , the two other one are based on the non - conservative form of the mv model .",
    "+ we use the following notations : we fix a uniform stencil @xmath95 ( with @xmath96 ) and a time step @xmath97 .",
    "we denote by @xmath98 the value of the mass and flux direction at the position @xmath99 and at time @xmath100 .      here",
    "we use the conservative form of the mv model ( [ eq:1dcons_x ] ) : @xmath101 with @xmath102 and @xmath103 .",
    "we use a roe method to discretize this equation : @xmath104 where the intermediate flux @xmath105 is given by : @xmath106 and @xmath107 is the jacobian of the flux @xmath108 : @xmath109\\ ] ] calculated at the mean value @xmath110    as mentioned earlier , the conservative form is only valid when @xmath33 does not cross a singularity @xmath111 or @xmath112 ( i.e. @xmath60 ) .",
    "nevertheless , numerically we can still use the formulation ( [ eq : cons ] ) when @xmath33 changes sign .",
    "moreover , since @xmath58 is an even function , this only gives @xmath113 . to determine the sign of @xmath114",
    ", we use an auxiliary value @xmath115 which we update with the upwind scheme ( [ eq : upwind ] ) .",
    "the sign of @xmath33 is then determined using the sign of @xmath115 .",
    "the next scheme uses the relaxation model ( [ eq : umv_rho])-([eq : umv_omega ] ) .",
    "the idea is to split the relaxation model in two parts , first the conservative part : @xmath116 and then the relaxation part : @xmath117 this system reduces to : @xmath118 since this equation only changes the vector field @xmath17 in norm ( i.e. @xmath119 ) , we can once again reduce this equation to : @xmath120 equation ( [ eq : omega2 ] ) can be explicitly solved : @xmath121 with @xmath122 .",
    "we indeed take the limit @xmath68 of this expression and replace the relation term by a mere normalization : @xmath123 .",
    "the conservative part is solved by a roe method with a roe matrix computed following @xcite page 156 .",
    "we present two other numerical schemes based on the non - conservative formulation of the mv model .    *",
    "( i ) upwind scheme *    the method consists to update the value of @xmath124 with the formula : @xmath125 where @xmath126 and @xmath127 are ( respectively ) the positive and negative part of @xmath128 , defined such that @xmath129 and @xmath130 and @xmath131 are computed using an explicit diagonalization of @xmath128 .    *",
    "( ii ) semi - conservative scheme *    one of the problem with the upwind scheme is that it does not conserve the total mass ( @xmath132 ) . in order to keep this quantity constant in time",
    ", we use the equation of conservation of mass ( [ eq : macro2_rho ] ) in a conservative form : @xmath133 with @xmath134 .",
    "therefore , a conservative numerical scheme associated with this equation would be : @xmath135 where @xmath136 is the numerical estimation of the flux @xmath137 at the interface between @xmath99 and @xmath138 . to estimate numerically this flux , we use the following formula with @xmath139 : @xmath140 where the intermediate value is given by @xmath141 and @xmath142",
    "is the first line of the absolute value of @xmath128 .    for the estimation of the angle @xmath33 , we keep the same scheme as for the upwind scheme .",
    "this numerical scheme uses one conservative equation ( for the mass @xmath16 ) and a non - conservative equation ( for the angle @xmath33 ) .",
    "it is thus referred to as the _ semi - conservative _ scheme .      to compare the various numerical schemes",
    ", we use a riemann problem as initial condition .",
    "we choose solutions which consist of a rarefaction wave ( figure [ fig : rare11 ] ) or a single shock wave ( figures [ fig : choc1]-[fig : choc111 ] ) .",
    "we take the following parameters : @xmath143 , the length of the domain is @xmath144 units and the discontinuity for the riemann problem is at @xmath145 ( the middle of the domain ) .",
    "the simulations are run during two time units with a time step @xmath146 and a space step @xmath147 .",
    "for these values , the courant number ( @xmath148 ) is @xmath149 .",
    "we use homogeneous neumann conditions as boundary conditions .    for the rarefaction wave ,",
    "we take : @xmath150",
    "all the numerical schemes capture well the theoretical solution ( see figure [ fig : rare11 ] ) .    for the shock wave ,",
    "we choose : @xmath151 for these values , the shock speed computed with ( [ eq : hugo ] ) is @xmath152 .",
    "the results of the numerical simulations using the four schemes are given in figure [ fig : choc1 ] .",
    "the numerical solutions are in accordance with the theoretical solution given by the conservative formulation for all the numerical schemes .",
    "nevertheless , the conservative scheme is in better accordance with this solution . for the other schemes , the shock speed differs slightly . + a second example of a shock wave",
    "is computed using the following initial condition : @xmath153 the solutions given by the @xmath154 numerical schemes are very different .",
    "only the conservative method is in agreement with the solution given by the conservative formulation .",
    "but the conservative formulation is not necessary the right one .",
    "indeed , in the next section , particle simulations show that the right solution is not given by the conservative formulation but rather by the splitting method .    ) given by a rarefaction curve ( solid line ) and the numerical solutions ( points ) , @xmath16 ( blue ) and @xmath155 ( green ) as functions of space .",
    "the simulations are run during 2 time units , with a time step @xmath156 and a space step @xmath157 ( cfl=@xmath158 ) . ]    ) ]    ) ]",
    "in this part , we would like to validate the macroscopic vicsek model by the simulation of the microscopic vicsek .",
    "the macroscopic model relies on the fact that the particle distribution function is at local equilibrium given by a von mises distribution @xmath159 ( see @xcite ) : @xmath160 where @xmath161 is set by the normalization condition where @xmath162 is the modified bessel function of order 0 ] .",
    "the goal of this section is to show numerically that the particle distribution of the microscopic vicsek model is close in certain regimes to this von mises distribution .    to this aim , in appendix",
    "[ sec : num_scheme_ps ] we propose a numerical scheme to solve system ( [ cont_orient_bis ] ) .",
    "the setting for our particle simulations is as follows : we consider a square box with periodic boundary conditions . as initial condition for the position @xmath99",
    ", we choose a uniform random distribution in space .",
    "the velocity is initially distributed according to a uniform distribution on the unit circle .    during the simulation ,",
    "we compute the empirical distribution of the velocity direction @xmath33 and of the mean velocity @xmath17 of particles .",
    "we then compare this empirical distribution with its theoretical distribution @xmath163 given by ( [ eq : m_von_mises ] ) . in figure",
    "[ fig : distri_speed ] , we give an example of a comparison between the distribution of the velocity direction @xmath33 and the theoretical distribution @xmath159 predicted by the theory .",
    "( with @xmath164 ) compared with its theoretical distribution after @xmath165 time units of simulation .",
    "right figure : the corresponding particle simulation",
    ". parameters of the simulation : @xmath166 , @xmath167 ( domain size ) , number of particles @xmath168 , @xmath169 , @xmath170 , @xmath171 , @xmath172 . ]",
    "( with @xmath164 ) compared with its theoretical distribution after @xmath165 time units of simulation .",
    "right figure : the corresponding particle simulation .",
    "parameters of the simulation : @xmath166 , @xmath167 ( domain size ) , number of particles @xmath168 , @xmath169 , @xmath170 , @xmath171 , @xmath172 . ]",
    "( [ eq : total_flux ] ) for different values of @xmath9",
    ". parameters of the simulation : @xmath166 , @xmath167 ( domain size ) , number of particles @xmath173 , radius of interaction @xmath170 , @xmath174 unit time , the simulations are run during @xmath175 unit time . ]    since the distribution of velocity converges , we have a theoretical value for the mean velocity .",
    "we denote by @xmath176 the mean velocity of particles and @xmath177 the theoretical value given by the stationary distribution : @xmath178 at least locally in @xmath87 , we have that @xmath179 . in figure",
    "[ fig : mean_speed ] , we compare the two distributions for different values of the noise @xmath9 and we can see that the two distributions are in good agreement .",
    "we also observe a smooth transition from order ( @xmath180 ) to disorder ( @xmath181 ) as it has been measured in the original vicsek model @xcite .",
    "the situation is different when we look at a larger system .",
    "we still have convergence of the velocity distribution of particles to a local equilibrium @xmath182 , but the mean direction @xmath183 now depends on @xmath87 .",
    "therefore the mean velocity of the particles in all the domain differs from the expected theoretical value ( [ eq : m_von_mises])-([eq : total_flux ] ) .",
    "we illustrate this phenomena in figure [ fig : mean_speed_diff ] : we fix the density of particles and we increase the size of the box .",
    "as we can observe , the mean velocity @xmath176 ( [ eq : total_flux ] ) has a smaller value when the size of the box increases .",
    "this phenomena has been previously observed in @xcite .",
    "the mean velocity @xmath176 can also differ from the expected theoretical value @xmath177 ( [ eq : m_von_mises])-([eq : total_flux ] ) when the density of particles is low . in figure",
    "[ fig : mean_speed_diff2 ] , we fix the size of the box ( @xmath184 ) and we increase the density of particles ( the density is given by the number of particles inside the circle of interaction ) . at low density ,",
    "the mean velocity @xmath176 is much more smaller than the theoretical prediction @xmath177 .",
    "but as the density of particles increases , the mean velocity @xmath176 grows ( see also @xcite ) and moreover @xmath176 converges to @xmath177 . because of that , a dense regime of particles has to be used in the following in order to numerically compare the microscopic model with the mv model .",
    "( [ eq : total_flux ] ) for different values of @xmath9 .",
    "we use different domain sizes and we keep the same density of particles . as the domain size increases , the total flux @xmath177 decreases which means that particles are less aligned globally .",
    "parameters of the simulations : @xmath185 ( domain size ) , number of particles @xmath186 , radius of interaction @xmath170 , @xmath174 time units , the simulations are run during @xmath175 time units . ]",
    "( [ eq : total_flux ] ) for different values of @xmath9 .",
    "we change the density of particles ( given by the mean number of neighbors in unit of radius of interaction ) .",
    "when we increase the mean number of neighbors , particles are more aligned .",
    "parameters of the simulations : @xmath184 ( domain size ) , number of particles @xmath187 and @xmath188 , radius of interaction @xmath170 , @xmath174 time units , the simulations are run during @xmath175 time units . ]      we now compare the evolution of the two macroscopic quantities @xmath16 and @xmath17 for the two models . we have seen that the different schemes applied to the macroscopic equation can give different solutions ( see figure [ fig : choc111 ] ) .",
    "therefore , we expect that particle simulations will indicate what is the physically relevant solution of the macroscopic equation .",
    "we first briefly explain how we proceed to run the particle simulations of a riemann problem ( see also appendix [ sec : num_scheme_ps ] ) .",
    "first , we have to choose a left state @xmath51 , a right state @xmath62 and the noise parameter @xmath9 .",
    "then we distribute a proportion @xmath189 of particles uniformly in the interval @xmath190 $ ] and the remaining particles uniformly in the interval @xmath191 $ ] .",
    "then , we generate velocity distribution @xmath33 for the particles according to the distribution @xmath192 ( [ eq : m_von_mises ] ) with @xmath193 on the left side and @xmath194 on the right side .",
    "we use the numerical scheme given in appendix [ sec : num_scheme_ps ] to generate particle trajectories . to make the computation simpler , we choose periodic boundary conditions . therefore the number of particles is conserved . as a consequence ,",
    "there are two riemann problems corresponding to discontinuities at @xmath145 and at @xmath195 or @xmath144 ( which is the same by periodicity ) .",
    "we use a particle - in - cell method @xcite to estimate the two macroscopic quantities : the density @xmath16 and the direction of the flux @xmath17 ( which gives @xmath33 ) . in order to reduce the noise due to the finite number of particles , we take a mean over several simulations to estimate the density @xmath16 and @xmath33 ( @xmath144 simulations in our examples ) .    in figure",
    "[ fig : exple_2d ] , we show a numerical solution for the following riemann problem : @xmath196 using particle simulations and the macroscopic equation .",
    "we represent the solutions in a 2d representation .",
    "since the initial condition is such that the density @xmath16 and the direction @xmath33 are independent of the @xmath34-direction , we only represent @xmath16 and @xmath33 along the @xmath87-axis in the following figures .    in figure [",
    "fig : choc_d02_particle_split ] , we represent the two solutions ( the particle and the macroscopic one ) with only a dependence in the @xmath87-direction .",
    "three quantities are represented : the density ( blue ) , the flux direction @xmath33 ( green ) and the variance of the angle distribution ( red ) .",
    "the macroscopic model supposes that the variance of @xmath33 should be constant everywhere .",
    "nevertheless , we can see that the variance is larger in regions where the density is lower . for @xmath16 and @xmath33 , we see clearly the propagation of a shock in the middle of the domain and a rarefaction at the boundary .",
    "the cpu time for one numerical solution at the particle level is about @xmath197 seconds with the parameters given in figure [ fig : choc_d02_particle_split ] . for the macroscopic equation ,",
    "the cpu time is about @xmath198 second which represents a cost reduction of three orders of magnitude compared with the particle simulations .",
    "since we have to take a mean over many particle simulations , the cost reduction is even larger .    in figure",
    "[ fig : choc111_particle ] , we use the same riemann problem to set the initial position as in figure [ fig : choc111 ] both with @xmath45 ( [ eq : riemann_shock2 ] ) .",
    "we use a larger domain in @xmath87 ( @xmath199 space units ) in order to avoid the effect of the periodic boundary condition .",
    "the upwind scheme and the semi - conservative method are clearly not in accordance with the particle simulations . moreover , the splitting method is in better agreement with the particle simulation since the shock speed is closer to the values given by the particle simulations than that predicted by the conservative scheme .",
    "finally , our last simulations concern a contact discontinuity .",
    "we simply initialize with : @xmath200 i.e. we reflect the angle with respect to the x - axis across the middle point @xmath145 . a natural solution for this problem",
    "is the contact discontinuity propagating at speed @xmath201 : @xmath202 with @xmath203 when @xmath204 and @xmath205 when @xmath206 .",
    "this is the solution provided by the conservative scheme ( figure [ fig : theta_pm ] ) .",
    "but surprisingly , the splitting method and the particle simulation agree on a different solution .",
    "indeed , the solutions given by the particles and the splitting method are in fairly good agreement with each other , which seems to indicate that the `` physical solution '' to the contact problem ( [ eq : theta_pm ] ) is not given by the conservative formulation ( [ eq : theta_pm_sol ] ) but by a much more complex profile .",
    "the constraint of unit speed drastically changes the profile of the solution compared with what would be found for a standard system of conservative laws .",
    "computed with particle simulations ( left ) and the macroscopic equations ( right ) .",
    "we initialize with a riemann problem ( [ eq : ic_shock ] ) .",
    "numerical parameters for the particle simulations : @xmath207 particles , @xmath208 , @xmath209 , @xmath170 , @xmath210 , we take a mean over @xmath144 computations .",
    "numerical parameters for the macroscopic model : @xmath211 ( cfl=0.416 ) , we use the splitting method .",
    "the simulations are run during 2 time units . ]     computed with particle simulations ( left ) and the macroscopic equations ( right ) .",
    "we initialize with a riemann problem ( [ eq : ic_shock ] ) .",
    "numerical parameters for the particle simulations : @xmath207 particles , @xmath208 , @xmath209 , @xmath170 , @xmath210 , we take a mean over @xmath144 computations .",
    "numerical parameters for the macroscopic model : @xmath211 ( cfl=0.416 ) , we use the splitting method .",
    "the simulations are run during 2 time units . ]",
    "+    ) with @xmath45 computed using the macroscopic model and particle simulations of the microscopic model ( see figure [ fig : choc_d02_particle_split ] ) .",
    "numerical parameters for the macroscopic model : @xmath212 ( cfl=0.778 ) .",
    "numerical parameters for the particle simulation : @xmath207 particles , @xmath174 , @xmath213 , @xmath170 , @xmath214 and @xmath167 .",
    "we take a mean over @xmath215 simulations .",
    "the simulations are run during 6 time units . since @xmath45 , fluctuations are higher ( see figure [ fig : mean_speed_diff ] ) , we have to increase the density of particles to reduce this effect . ]",
    "+ ) computed with the conservative method ( top ) , the splitting method ( down ) and with particle simulations ( dots ) . numerical parameters for the macroscopic model : @xmath212 ( cfl=0.416 ) .",
    "numerical parameters for the particle simulations : @xmath216 particles , @xmath208 , @xmath209 , @xmath170 , @xmath217 , @xmath167 .",
    "we take a mean over @xmath218 simulations .",
    "the simulations are run during 2 time units.,title=\"fig : \" ]     + ) computed with the conservative method ( top ) , the splitting method ( down ) and with particle simulations ( dots ) .",
    "numerical parameters for the macroscopic model : @xmath212 ( cfl=0.416 ) .",
    "numerical parameters for the particle simulations : @xmath216 particles , @xmath208 , @xmath209 , @xmath170 , @xmath217 , @xmath167 .",
    "we take a mean over @xmath218 simulations .",
    "the simulations are run during 2 time units.,title=\"fig : \" ]",
    "in this work , we have numerically studied both the microscopic vicsek model and its macroscopic version @xcite . due to the geometric constraint that the velocity should be of norm one , the standard theory of hyperbolic systems is not applicable .",
    "therefore , we have proposed several numerical schemes to solve it . by comparing the numerical simulations of the microscopic and macroscopic equations",
    ", it appears that the scheme based on a relaxation formulation of the macroscopic model , used in conjunction with a splitting method is in good agreement with particle simulations .",
    "the other schemes do not show a similar good agreement .",
    "in particular , with an initial condition given by a contact discontinuity , the splitting method and the microscopic model provide a similar solution which turn to be much more complex than what we could be expected .",
    "these results confirm the relevance of the macroscopic vicsek model .",
    "since the cpu time is much lower with the macroscopic equation , the macroscopic vicsek model is an effective tool to simulate the vicsek dynamics in a dense regime of particles .",
    "many problems are still open concerning the macroscopic vicsek model .",
    "we have seen that the splitting method gives results which are in accordance with particle simulations .",
    "but , we have to understand why this particular scheme captures well the particle dynamics better than the other schemes .",
    "since the macroscopic equation has original characteristics , this question is challenging .",
    "another point concerns the particle simulations .",
    "we have seen that the particles density has a strong effect on the variance of the velocity distribution .",
    "when the density is low , the variance is larger .",
    "the macroscopic equation does not capture this effect since the variance of the distribution is constant .",
    "works in progress aims at taking into account this density effect .",
    "[ sec : coeff ]    the analytical expression of the coefficient @xmath19 involved the distribution of the local equilibrium @xmath192 ( [ eq : m_von_mises ] ) .",
    "the two other coefficients ( @xmath20 and @xmath21 ) involve also the solution @xmath219 of the following elliptic equation @xcite : @xmath220 + { \\mathrm{e}}^{x / d } g =    -(1-x^2)^{3/2 } { \\mathrm{e}}^{x / d},\\ ] ] on the interval @xmath221 .",
    "if we define the function @xmath222 and @xmath223 , these macroscopic coefficients can be written as : @xmath224 in the above expressions , we can see that @xmath225 .",
    "now we are going to explore two asymptotics of @xmath219 when the parameter @xmath9 is small or large .",
    "[ lem : g ] let @xmath219 be the solution of equation ( [ eq : el_fort ] ) .",
    "we have the asymptotics : @xmath226 +      o(d),\\\\      \\label{eq : g_d_large }      g & \\stackrel{d\\rightarrow \\infty}{\\sim } & -\\frac{1}{2}\\,\\sqrt{1-x^2 } +      \\frac{1}{12\\,d } x \\sqrt{1-x^2 } + o\\left(\\frac{1}{d}\\right ) .",
    "\\end{aligned}\\ ] ]    introducing the hilbert space : @xmath227 we have already seen in @xcite that there exists a unique solution @xmath219 of ( [ eq : el_fort ] ) .",
    "moreover this solution is negative .    to derive the asymptotic behavior of @xmath219 depending on @xmath9 , we first develop ( [ eq : el_fort ] ) : @xmath228 + ( 1-x^2)\\,\\frac{1}{d } \\partial_x g -      \\frac{g}{1-x^2 } = ( 1-x^2)^{1/2}.\\ ] ] when @xmath229 , we have : @xmath230 on the interval @xmath231 $ ] for all @xmath232 . since @xmath219 belongs to @xmath233",
    ", we also have the boundary condition @xmath234 , so @xmath219 converges to @xmath235 when @xmath229 .",
    "+ to derive the next order of convergence in the limit @xmath229 , we normalize @xmath219 with @xmath236 , which gives : @xmath237 + ( 1-x^2 ) \\partial_x \\widetilde{g } -      d\\,\\frac{\\widetilde{g}}{1-x^2 } = ( 1-x^2)^{1/2}.     \\end{aligned}\\ ] ] in the limit @xmath229 , we deduce that : @xmath238 which has an explicit solution : @xmath239 .",
    "since @xmath240 , we have @xmath241 .",
    "numerically , we find that @xmath242 but the proof is still open .",
    "this formally proves ( [ eq : g_d_low ] ) .",
    "when @xmath243 , ( [ eq : el_fort_dev ] ) gives : @xmath244 - \\frac{g_0}{1-x^2 } = ( 1-x^2)^{1/2}.     \\end{aligned}\\ ] ] a simple calculation shows that @xmath245 is a solution of ( [ eq : d_inf ] ) . + to derive the next order of convergence , we look at the difference @xmath246 , which satisfies ( see ( [ eq : el_fort_dev ] ) and ( [ eq : d_inf ] ) ) : @xmath247 + ( 1-x^2)\\,\\frac{1}{d } \\partial_x v -      \\frac{v}{1-x^2 } = -(1-x^2)\\,\\partial_x g_0.\\ ] ] in the limit @xmath248 , @xmath249 satisfies : @xmath250   -      \\frac{v}{1-x^2 } = -\\frac{1}{2 } x\\sqrt{1-x^2}.    \\end{aligned}\\ ] ] a simple calculation shows that @xmath251 is solution of ( [ eq : g_1_inf ] ) .",
    "therefore we formally have the expression ( [ eq : g_d_large ] ) in the proposition .    in figure",
    "[ fig : g ] , we compute numerically the function @xmath219 ( [ eq : el_fort ] ) .",
    "we use a finite element method with a space step @xmath252 .",
    "the two asymptotics of @xmath219 when @xmath229 and @xmath243 are computed in figure [ fig : g1 ] .",
    "[ ppo : c_12 ] the two coefficients @xmath19 and @xmath20 defined ( resp . ) by the equations ( [ eq : c_1 ] ) and ( [ eq : c_2 ] ) satisfy the following asymptotics : @xmath253    we have an explicit expression for the coefficient @xmath19 using the change of unknowns @xmath254 : @xmath255 where @xmath256 .",
    "the expressions of ( [ eq : c_1_asymp_0 ] ) and ( [ eq : c_1_asymp_inf ] ) are simply deduced by a taylor expansion of the last expression .    for the coefficient @xmath20 , we insert the development of @xmath219 ( [ eq : g_d_large ] ) in expression ( [ eq : c_2 ] ) .    the behavior of @xmath20 when @xmath229 is more difficult to analyze .",
    "the density probability @xmath257 used in formula ( [ eq : c_2 ] ) becomes singular in this limit .",
    "nevertheless , due to the expression of @xmath192 , the density converges to a dirac delta at @xmath235 which explains why @xmath258 . to capture the next order of convergence , we need to find the second order correction of @xmath219 in the limit @xmath229 which is not available",
    "however , numerically we find that : @xmath259    in figure [ fig : div_c1 ] , we numerically compute the coefficients @xmath260 , @xmath261 and their asymptotics .     of ( [ eq : el_fort ] ) for different values of the parameter @xmath9 .",
    "we have the following asymptotics ( see lemma [ lem : g ] ) : @xmath262 and @xmath263 . ]     of @xmath219 when @xmath229 .",
    "the red curve is the theoretical asymptotic limit : @xmath264 ( see lemma [ lem : g ] ) .",
    "right figure : the first correction @xmath265 of @xmath219 when @xmath248 .",
    "the red curve is the theoretical asymptotic : @xmath266 ( see lemma [ lem : g]).,title=\"fig : \" ]   of @xmath219 when @xmath229 .",
    "the red curve is the theoretical asymptotic limit : @xmath264 ( see lemma [ lem : g ] ) .",
    "right figure : the first correction @xmath265 of @xmath219 when @xmath248 .",
    "the red curve is the theoretical asymptotic : @xmath266 ( see lemma [ lem : g]).,title=\"fig : \" ]     and @xmath261 ( solid lines ) and their two asymptotics ( dashed lines ) ( see proposition [ ppo : c_12 ] ) computed with @xmath267.,title=\"fig : \" ]   and @xmath261 ( solid lines ) and their two asymptotics ( dashed lines ) ( see proposition [ ppo : c_12 ] ) computed with @xmath267.,title=\"fig : \" ]",
    "in this appendix , a vortex configuration is exhibited as a stationary solution of the mv model ( [ eq : macro_rho])-([eq : macro_omega])-([eq : macro_constraint ] ) in dimension 2 .",
    "a stationary state of the mv model has to satisfy : @xmath268 introducing the polar coordinates , @xmath269 , @xmath270 , where @xmath271 and @xmath272 , we are able to formulate the proposition :    [ ppo : vortex ] the following initial condition is a stationary state of the mv model ( [ eq : stationnary ] ) : @xmath273 where @xmath161 is a constant .    with the expression of @xmath16 and @xmath17 given by ( [ eq : init_vortex ] ) , the divergence of the mass is zero and the gradient of @xmath16 is orthogonal to @xmath17 , therefore the system ( [ eq : stationnary ] ) reduces to : @xmath274 or in polar coordinates : @xmath275 since @xmath276 , we can easily check that the solution of this equation is given by @xmath277 .",
    "in the limit @xmath68 , an explicit euler method for the differential system ( [ cont_pos_bis])-([cont_orient_bis ] ) imposes a restriction time step condition of @xmath278 .",
    "therefore , we develop an implicit scheme for this system . the idea is to go back to the original vicsek model ( see @xcite ) .",
    "we use the formulation : @xmath279 where @xmath280 and @xmath281 is the average velocity ( [ cv_moy_3_bis ] ) .",
    "when @xmath282 , we recover exactly the original vicsek model @xcite .",
    "( [ eq : mid_point ] ) can in fact be solved explicitly .",
    "first , we have to remember that @xmath283 belongs to the unit circle ( i.e. @xmath284 )",
    ". then we use that @xmath285 is the orthogonal projection of @xmath286 on the orthogonal plan of @xmath287 .",
    "therefore @xmath283 and @xmath288 are on the circle @xmath289 with center @xmath290 and radius @xmath291 ( see figure [ fig : tech_circ ] ) .",
    "this fully defines @xmath283 since @xmath292 and @xmath283 are the two intersection points of the unit circle and the circle @xmath289 . denoting @xmath33 the angle of the unit vector @xmath293",
    ", we easily check that we have in terms of angles : @xmath294 to take into account the effect of the noise , we simply add a random variable : @xmath295 where @xmath296 is a standard normal distribution independent of @xmath297 .        1 .",
    "choose a riemann problem @xmath298 and @xmath299 .",
    "2 .   initiate @xmath300 particles @xmath301 according to the distributions @xmath302 and @xmath303 .",
    "3 .   let evolve the particles in time using the time - discretization ( [ eq : discrete_micro_angle ] ) of equation ( [ cont_orient_bis ] ) .",
    "4 .   compute the mass @xmath16 and the direction of the flux @xmath17 using particle - in - cell method @xcite in order to compare the simulation with the one of the mv model ."
  ],
  "abstract_text": [
    "<S> the vicsek model is a very popular individual based model which describes collective behavior among animal societies . </S>",
    "<S> a macroscopic version of the vicsek model has been derived from a large scale limit of this individual based model @xcite . in this work , </S>",
    "<S> we want to numerically validate this macroscopic vicsek model ( mv ) . to this aim </S>",
    "<S> , we compare the simulations of the macroscopic and microscopic models one with each other . the mv model is a non - conservative hyperbolic equation with a geometric constraint . due to the lack of theory for this kind of equations , we derive several equivalents for this system leading to specific numerical schemes . </S>",
    "<S> the numerical simulations reveal that the microscopic and macroscopic models are in good agreement provided that we choose one of the proposed formulations based on a relaxation of the geometric constraint . </S>",
    "<S> this confirms the relevance of the macroscopic equation but it also calls for a better theoretical understanding of this type of equations .    </S>",
    "<S> * key words : * individual based model , hyperbolic systems , non - conservative equation , geometric constraint , relaxation , splitting scheme    * ams subject classifications : * 35q80 , 35l60 , 35l65 , 35l67 , 65m60 , 82c22 , 82c70 , 82c80 , 92d50    * acknowledgments : * the authors wish to thank pierre degond for his support and his fruitful suggestions . </S>",
    "<S> they also would like to thank guy theraulaz , jacques gautrais and richard bon for helpful discussions . </S>",
    "<S> this work was supported by the french agence nationale pour la recherche ( anr) in the frame of the contract anr-07-blan-0208 - 03 entitled panurge. </S>"
  ]
}