{
  "article_text": [
    "the mobile data traffic has been doubling each year during the last few years and the wireless industry is preparing a @xmath0-fold increase in data demands expected in this decade . to deal with this challenge , the fifth generation ( 5 g ) communications system has come at the forefront of wireless communications theoretical research @xcite .",
    "two main approaches in 5 g are massive antennas and dense deployments of access points , which lead to the massive multiple - input multiple - output ( mimo ) and small cell techniques @xcite .",
    "massive mimo employs hundreds of antenna elements at the base station ( bs ) to serve tens of users simultaneously at the same time - frequency resource @xcite .",
    "the large size of transmit antenna array not only significantly increases the capacity through excessive spatial dimensions @xcite , but also averages out the effect of fast channel fading and provides extremely sharp beamforming concentrated into small areas @xcite . aside from these",
    ", the huge degrees - of - freedom offered by massive mimo also reduce the transmit power @xcite .",
    "nevertheless , due to the finite channel coherence time , performance of massive mimo is mainly limited by pilot contamination which arises from pilot reuse among adjacent cells @xcite . on the other track ,",
    "small cell improves the system capacity by densely deploying low - power access points into the traditional high - power macro cells @xcite . in this fashion ,",
    "distance between transmitter and receiver can be significantly reduced which results in remarkably enhanced rate gains . as small cells do not always have direct links to the macro bs , they can be intelligently deployed in accordance to the traffic demand without much cost on the fiber usage and real estate . however , the performance of small cell is mainly affected by the additional inter - cell interference induced from massive transmitting nodes @xcite .    as both massive mimo and small cells have attractive attribute in capacity enhancement , it s natural to wonder which one performs better under which scenarios .",
    "comparison of massive mimo and small cell from special and energy efficiency is addressed in @xcite . however , @xcite model the small cell system as a one - tier network with dense bss , which is unreasonable since small cell is designed to offload heavy traffic from macro bs . in @xcite , a two - tier architecture including massive - antenna macro bs and small - cell access points is explored , but it only considers the single - cell scenario and ignores the randomness of bss locations .",
    "the flexible add - on small cells and further influence on user associations make it necessary to capture bss locations into analysis .",
    "therefore , a reasonable framework to compare massive mimo and small cell should be a heterogeneous cellular network ( hcn ) containing different types of multi - antenna and randomly located bss .",
    "stochastic geometry provides a useful tool to describe spatial distribution of bs sites and traffic flow @xcite .",
    "based on this , lots of work have focused on the hcn with poisson point process ( ppp ) distributed bss @xcite . a general multi - tier framework is proposed in @xcite , and the coverage probability with flexible biased cell association is analyzed in @xcite .",
    "on top of these , further extensions to multi - antenna transmission are presented in @xcite , which is much more challenging than the single - antenna scenario . however",
    ", none of these works can be applied directly on massive mimo systems , since they do not take into account channel estimation and the further effect of pilot contamination , which is the main limiting factor of massive mimo . moreover ,",
    "all these works adopt the single - slope path loss model with only non - line - of - sight ( nlos ) transmissions , which is not fit for dense small cell networks since the short propagation distance results in more line - of - sight ( los ) transmissions @xcite and multi - slope path loss affects the benefit of densification remarkably @xcite .    in this paper , we propose a framework for downlink hcn where the user location as well as the deployment of multi - antenna macro and small bss are modeled as independent ppps . in this network , users are flexibly associated with the strongest bs , and each bs simultaneously serves multiple users associated with it on the same time - frequency resource block .",
    "further , the signal propagation experiences a path loss model differentiating los and nlos transmissions , and the channel state information at bss is acquired through uplink training . using stochastic geometry tools",
    ", we quantify the rate performance in a general setting that accounts for the interference affecting both the channel estimation and data transmission phases .",
    "our main contributions are summarized as follows :    * we propose a general framework for the analysis of downlink hcn which consists of ppp distributed macro and small cell bss with multiple antennas .",
    "our analysis captures the essential keypoints of both massive mimo and small cells , including los / nlos transmission , bs deployment density , imperfect channel estimation , and random network topology . * based on our analytical results , we compare the system performance between densifying small cells and expanding macro bs antennas .",
    "it is found that adding small cells into the network can improve the achievable rate much faster than expanding antenna arrays at the macro bs .",
    "however , when the small cell density exceeds a critical threshold , the spacial densification will stop benefiting and further impair the network capacity .",
    "in contrast , the achievable rate always increases with growing antenna size and saturates to an upper bound caused by pilot contamination .",
    "this upper bound is also larger than the peak rate obtained from deployment of small cells .",
    "* we provide the optimal small cell density that maximizes the achievable downlink rate , which can be used as a rule - of - thumb for practical small cell deployment . to fully exploit the degrees - of - freedom offered by the large antenna array ,",
    "the optimal bias with different antenna numbers is provided as guidance for practical massive mimo configuration .",
    "* we also investigate the effect of distributed and centralized antennas .",
    "it is found that to attain higher data rate with fixed budget of antenna number , taking certain amount of antennas into distributed small cell bss is more beneficial than centralizing all antennas at the macro bs .",
    "the optimal antenna allocation proportion is also presented as a reference for practical antenna configuration while combining with the hardware constraint .",
    "the remainder of this paper is organized as follows .",
    "section [ sec : system model ] introduces the hcn framework , los / nlos transmission model , and the user association policy . in section",
    "[ sec : achievable downlink rate ] , we derive a tight approximation of the achievable downlink rate accounting for channel estimation with uplink training . in section [ sec : numerical results ] , we provide numerical results to validate the analytical results and further study the performance of the hcn .",
    "finally , section [ sec : conclusion ] summarizes the main results of this paper .",
    "_ notation_throughout the paper , vectors are expressed in lowercase boldface letters while matrices are denoted by uppercase boldface letters .",
    "we use @xmath1 to denote the conjugate - transpose of @xmath2 , and use @xmath3_{ij}$ ] to denote the ( @xmath4)-th entry of @xmath2 .",
    "finally , @xmath5 is the indicator function for logic @xmath6 , @xmath7 is the expectation operator and @xmath8 is the euclidean norm .",
    "in this section , we introduce the network topology , the propagation model , and the user association policy .",
    "the main notations used throughout the paper are summarized in table [ table : notation ] .",
    ".notation summary [ cols=\"^,<\",options=\"header \" , ]      we consider the downlink of a two - tier heterogenous cellular network , where high - power macro bss ( mbss ) are overlaid with successively denser and lower - power small cell bss ( scbs ) , as illustrated in fig .",
    "[ fig 1 ] .",
    "we assume that the mbss and scbs are deployed on a plane according to independent ppps @xmath9 and @xmath10 with spatial densities @xmath11 and @xmath12 , respectively .",
    "all mbss and scbs are equipped with @xmath13 and @xmath14 antennas , respectively , whereas each mbs transmits with power @xmath15 , and each scb has transmit power to be @xmath16 . in its light of high spectral utilization",
    ", we consider a co - channel deployment of small cells with the macro cell tier , i.e. , mbss and scbs share the same frequency band for transmission .",
    "we model the mobile users as another independent ppp @xmath17 with spatial density @xmath18 . additionally , we assume @xmath18 is much larger than @xmath11 , and each mbs has at least @xmath19 users in its coverage for analytical tractability is very small for large @xmath18 @xcite . ] . in each time - frequency resource block , a mbs first schedule @xmath19 users in its coverage based on the average received power and then these users are flexibly associated with the mbs or scb according to the association policy described in section [ subsec : user association policy ] .",
    "the user @xmath20 in macro cell @xmath21 is denoted as @xmath22 .",
    "we model the channels between any pair of antennas as independent and identically distributed ( i.i.d . ) and quasi - static , i.e. , the channel is constant during a sufficiently long coherence block , and varies independently from block to block .",
    "moreover , we assume that each channel is narrowband and affected by two attenuation components , namely small - scale rayleigh fading , and large - scale path loss .",
    "regarding the practical los and nlos transmissions , we model the path loss with two parts , i.e. , the los and nlos path .",
    "more formally , the path loss @xmath23 between @xmath22 and bs @xmath24 can be written as follows @xmath25 where @xmath26 is the distances between user @xmath22 and bs @xmath24 , @xmath27 and @xmath28 denote the path losses evaluated at a reference distance @xmath29 for los and nlos , respectively , and @xmath30 and @xmath31 are the los and nlos path loss exponents , respectively .",
    "as the probability of a wireless link being los or nlos is mainly affected by the distance between the transmitter and receiver , we model such probability as a homogeneous event in the following analysis @xcite .",
    "therefore , the channel coefficient between @xmath22 and the @xmath32-th antenna of mbs @xmath24 can be formulated as @xmath33 and the channel coefficient between @xmath22 and the @xmath32-th antenna of scb @xmath34 can be formulated as @xmath35 where @xmath36 and @xmath37 denote the small - scale fading while @xmath36 , @xmath38 , and @xmath39 and @xmath40 are the los probabilities function with the mbs and scb , respectively .",
    "note that the los probabilities can be different for macro and small cells due to the assorted propagation environment as well as various antenna heights .      from the perspective of load balancing",
    ", we adopt cell range expansion for user associations in this network .",
    "specifically , all the scbs employ a bias factor @xmath41 for the control of cell range expansion , and users associate to the bs that provides the largest average biased received power . note that with the existence of los path",
    ", it is possible that a user is associated to a far away los bs instead of a nearby nlos bs . due to the stationary property of ppp",
    ", we can evaluate the performance of a typical user located at the origin , denoted as @xmath42 , thanks to slivyark s theorem .",
    "as such , the average biased - received power of the typical user from the mbs @xmath24 is @xmath43 and the average biased - received power of the typical user from the scb @xmath34 is @xmath44 where @xmath41 is the small - cell bias factor , which can be set greater or smaller than one to extend or shrink the coverage .",
    "in this section , we analyze the achievable downlink rate of the hcn with los / nlos transmissions . particularly , we utilize tools from stochastic geometry to derive the user association probabilities , the distribution of serving distance , and finally the tight approximation of achievable downlink rate .",
    "the resulting analysis captures the effects of los / nlos transmissions , pilot contamination , and random network topology . for a better readability , most proofs and mathematical derivations",
    "have been relegated to the appendix .      with the presence of los / nlos transmission , coverage area of bss no longer form weighted voronoi cells because a user can associate to a far away bs with los path instead of a nearby bs with nlos path . to analyze this more challenging user association , we start with a decomposition of the ppps @xmath9 and @xmath10 .",
    "more precisely , if an mbs has a los path to the typical user located at the origin , we classify it as in the los mbs set @xmath45 , otherwise , we put it into the set of nlos mbs @xmath46 .",
    "given that this operation is performed independently for each point in @xmath9 , from the thinning theorem ( * ? ? ?",
    "* theorem 2.36 ) , it follows that @xmath45 and @xmath46 are two independent inhomogeneous ppps with densities @xmath47 and @xmath48 , respectively , where @xmath49 stands for the distance from an mbs to the typical user .",
    "similarly , we can also decompose @xmath10 into the sets of los scb @xmath50 and nlos scb @xmath51 , which are two inhomogeneous ppps with densities @xmath52 and @xmath53 , respectively .",
    "the distance from the typical user to its nearest bs in each @xmath45 , @xmath46 , @xmath50 , and @xmath51 are denoted as @xmath54 , @xmath55 , @xmath56 , and @xmath57 , respectively .",
    "we further define the event that the typical user is associated with the mbs in los and nlos , and associated with the scb in los and nlos , as @xmath58 , @xmath59 , @xmath60 , and @xmath61 , respectively .",
    "the following theorem provides the probabilities of these events .",
    "[ theorem 1 ] probabilities that the typical user is associated with the mbs in los and nlos path are given by @xmath62 & = 2 \\pi \\lambda_{\\tt m } \\int_0^\\infty r { \\mathbb{p}}_{\\tt m}^{\\tt l}(r ) \\zeta_1\\left(r , k_1 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right)\\zeta_2\\left(k_2 r , k_1 k_3 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right ) dr , \\label{prob eml } \\\\",
    "\\mathcal{a}_{\\tt m}^{\\tt nl } \\triangleq",
    "{ \\mathbb{p}}\\left[e_{\\tt m}^{\\tt nl}\\right ] & = 2 \\pi \\lambda_{\\tt m } \\int_0^\\infty r ( 1-{\\mathbb{p}}_{\\tt m}^{\\tt l}(r ) ) \\zeta_1\\left(k_4 r^\\frac{\\alpha^{\\tt nl}}{\\alpha^{\\tt l}},r\\right)\\zeta_2\\left(k_2 k_4 r^\\frac{\\alpha^{\\tt nl}}{\\alpha^{\\tt l } } , k_3 r\\right ) dr , \\label{prob emnl}\\end{aligned}\\ ] ] and probabilities that the typical user is associated with the scb in los and nlos path are given by @xmath63&=2 \\pi \\lambda_{\\tt s } \\int_0^\\infty r { \\mathbb{p}}_{\\tt s}^{\\tt l}(r ) \\zeta_1\\left(r",
    "/ k_2,k_1/k_3 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right)\\zeta_2\\left(r , k_1 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right ) dr ,",
    "\\label{prob esl}\\\\ \\mathcal{a}_{\\tt s}^{\\tt nl } \\triangleq { \\mathbb{p}}\\left[e_{\\tt s}^{\\tt nl}\\right]&=2 \\pi",
    "\\lambda_{\\tt s } \\int_0^\\infty r ( 1-{\\mathbb{p}}_{\\tt s}^{\\tt l}(r ) ) \\zeta_1\\left(k_4/k_2 r^\\frac{\\alpha^{\\tt nl}}{\\alpha^{\\tt l}},r / k_3\\right)\\zeta_2\\left ( k_4 r^\\frac{\\alpha^{\\tt nl}}{\\alpha^{\\tt l } } ,   r\\right ) dr , \\label{prob esnl}\\end{aligned}\\ ] ] where @xmath64 with @xmath65 , @xmath66 , @xmath67 , and @xmath68 .    see appendix [ proof of theorem 1 ] .",
    "the accuracy of theorem [ theorem 1 ] will be validated in fig .",
    "[ fig compare_assoprob ] . from theorem [",
    "theorem 1 ] , it is easy to obtain the probability that the typical user is associated with an mbs as @xmath69 , and with an scb as @xmath70 . based on the above results , we can further derive the average number of users associated with each bs as follows .",
    "[ corollary 1 ] the average number of users associated with an mbs is @xmath71 , and with an scb is @xmath72 .    see appendix [ proof of corollary 1 ] .",
    "[ remark 1 ] larger @xmath12 results in higher probability for a user to be associated with scb and reduces the probability associated with mbs , i.e. , @xmath73 grows and @xmath73 decreases . hence , as @xmath12 increases ,",
    "the decline of @xmath74 is obvious from corollary [ corollary 1 ] , while the behavior of @xmath75 is hard to fathom . in section [ sec : numerical results ]",
    ", we observe that @xmath73 is almost a linear function of @xmath12 with no offset , i.e. , @xmath76 , where @xmath77 is a positive value .",
    "following corollary [ corollary 1 ] , we get that @xmath78 , which means the average number of users associated with each scb remains unchanged as @xmath12 increases .",
    "when the typical user is associated with the mbs in a los or nlos path , the distance between the user and its serving bs are denoted as @xmath79 and @xmath80 , respectively .",
    "similarly , we use @xmath81 and @xmath82 to represent the distance between the typical user and its serving scb , when the association is through los or nlos path , respectively .",
    "the next theorem provides the probability density function ( pdf ) for each of these distances .",
    "[ theorem 2 ] the pdf of @xmath79 , @xmath80 , @xmath81 and @xmath82 are given as follows : @xmath83    see appendix [ proof of theorem 2 ] .",
    "the above results will be applied in the derivation of achievable downlink rate . in the next section ,",
    "we investigate the channel estimation procedure from uplink training .      during a dedicated uplink training phase ,",
    "users in each macro cell simultaneously transmit mutually orthogonal pilot sequences which allow the bss to estimate channels of users associated with them . due to the limited pilot length",
    ", we further assume that the same set of orthogonal pilot sequences is reused in every macro cell .",
    "in particular , the mbs assigns orthogonal pilots of length @xmath84 symbols for the @xmath19 users in its cell ( @xmath85 ) , and notifies each scb the pilot sequence of users associated with it .    the pilot sequence used by @xmath22",
    "is expressed as a @xmath86 vector @xmath87 , which satisfies @xmath88 $ ] , with @xmath89 $ ] being the kronecker delta function .",
    "furthermore , we assume that for any @xmath90 , @xmath91 , i.e , the @xmath20-th user in every macro cell has the same pilot sequence . by transmitting these pilot signals over @xmath84 symbols in the uplink , the collective",
    "received pilot signal at mbs @xmath24 can be expressed as @xmath92 where @xmath93 denotes the pilot power , @xmath94^t$ ] is the channel vector from @xmath22 to the mbs @xmath24 , and @xmath95 represents the @xmath96 additive white gaussian noise ( awgn ) matrix with i.i.d .",
    "zero - mean elements and variance @xmath97 .",
    "similarly , the @xmath98 noisy pilot matrix at scb @xmath34 can be written as @xmath99 where @xmath100^t$ ] , and @xmath101 is an awgn matrix .",
    "each bs estimates a user channel through multiplying the received pilot signal by the corresponding pilot sequence used by this user . in this work",
    ", we adopt the minimum mean - square - error ( mmse ) estimation method . as a result",
    ", the estimated channel vector @xmath102 is given by @xmath103 where @xmath104 .",
    "let @xmath105 denote the channel estimation error .",
    "then , we know that the elements of @xmath106 follows @xmath107 . similarly , the mmse estimate for channel vector @xmath108 is given by @xmath109 where @xmath110 , and elements of channel estimation error @xmath111 follows distribution @xmath112 .",
    "note that due to pilot reuse , the estimated channel vector is polluted by channels from users in other cells who share the same pilot , thus causing the pilot contamination . as mentioned in @xcite , pilot contamination is a main limiting factor for the performance of massive mimo , and the result of this impact with los / nlos transmissions will be further explored in section [ sec : numerical results ] .",
    "let @xmath113 and @xmath114 be the collection of users associated with the mbs @xmath24 and the scb @xmath34 , respectively , and @xmath115 and @xmath116 denote the corresponding cardinalities .",
    "each bs uses the estimated channel obtained from uplink training to establish the downlink precoding vector .",
    "then , the received signal at the typical user can be written as @xmath117 where @xmath118 is the @xmath119 precoding vector of mbs @xmath21 to @xmath22 , and @xmath120 is the @xmath121 precoding vector of scb @xmath34 to @xmath22 , @xmath122 and @xmath123 are the signals intended for @xmath22 from mbs @xmath21 and the scb @xmath34 , respectively , and @xmath124 is the awgn .",
    "we consider the maximal - ratio - transmission precoding in this work , and the precoding vector @xmath125 is given by @xmath126 where @xmath127 means the average over fast fading , and @xmath128 is a power normalization factor which conforms to the following constraint @xmath129 where @xmath130~| u_{nl } \\in \\mathcal{u}^{\\tt m}_{l}\\right\\}$ ] . therefore , we get that @xmath131 . similarly , the precoding vector @xmath132 for scb is given as @xmath133 where @xmath134 .    to this end , if the typical user is associated with mbs @xmath135 , the downlink sinr is given by @xmath136 where @xmath137 if the typical user is associated with the scb , denoted as @xmath138 , the downlink sinr is given by @xmath139 where @xmath140      based on the sinr given in and , the achievable downlink rate of the typical user can be expressed as @xmath141 where @xmath142 , @xmath143 , @xmath144 , and @xmath145 denote the received sinr of the typical user when it is associated with the mbs in los path , nlos path , and with the scb in los path and nlos path , respectively . to facilitate the rate derivation",
    ", we make the following assumptions .    [ assumption 1 ] we approximate the coverage region of the mbs @xmath146 as a ball centered at @xmath146 with radius @xmath147 @xcite .",
    "let @xmath148 be the point process formed by locations of the user @xmath20 in each macro cell .",
    "note that @xmath149 is a perturbation of the process @xmath9 and thus not a ppp .",
    "obtaining the exact correlation between @xmath9 and @xmath148 requires complicated mathematical derivations and is highly intractable . therefore",
    ", we use the similar method in @xcite to model the interfering users in @xmath148 , denoted by @xmath150 , as an inhomogeneous ppp .",
    "motivated by the fact that the probability that a user scheduled by the mbs @xmath146 in a los path is @xmath151 , and in a nlos path is @xmath152 , where @xmath49 is the distance of this user to @xmath146 , we make the following assumption .",
    "[ assumption 2 ] the point process @xmath153 can be approximated as an inhomogeneous ppp with density being @xmath154.\\ ] ]    moreover , for @xmath155 , @xmath156 and @xmath157 are independent .    based on all the analysis and assumptions mentioned above",
    ", a tight approximation of the achievable downlink rate is given in the following theorem .",
    "[ theorem 3 ] the achievable downlink rate of the typical user is approximated by @xmath158 where @xmath159\\right)\\notag\\\\ & \\times \\exp{\\negthickspace}\\left({\\negthickspace}-2 \\pi \\lambda_{\\tt s } \\left[\\int_{x_3}^\\infty { \\negthickspace}\\left(1-e^{-\\frac{z p_{\\tt s}l^{\\tt l}}{\\rho_1 u^{\\alpha^{\\tt l } } } } \\right){\\mathbb{p}}_{\\tt s}^{\\tt l}(u ) u du + { \\negthickspace}\\int_{x_4}^\\infty{\\negthickspace}\\left(1-e^{-\\frac{z p_{\\tt s}l^{\\tt nl } } { \\rho_1 u^{\\alpha^{\\tt nl } } } } \\right)\\left(1-{\\mathbb{p}}_{\\tt s}^{\\tt l}(u)\\right ) u du \\right]\\right),\\end{aligned}\\ ] ] and @xmath160\\right)-\\exp{\\negthickspace}\\left(-\\frac{z x_1}{\\rho_1}\\left[x_5+\\frac{x_3 x_5 ^ 2}{x_2\\left(x_5 { \\negthickspace}+{\\negthickspace}x_4{\\negthickspace}+{\\negthickspace}\\sigma^2/\\tau p_p\\right)}\\right]\\right),\\end{aligned}\\ ] ] while @xmath161 du$ ] , @xmath162 du$ ] , @xmath163 , @xmath164 , @xmath165 , where @xmath166 with @xmath167du$ ] , and @xmath168du$ ] , as well as @xmath169 , @xmath170 , @xmath171 , and @xmath172",
    ".    see appendix [ proof of theorem 3 ] .    from theorem [",
    "theorem 3 ] , we can observe the effects of @xmath12 and @xmath13 on the achievable downlink rate as described in following remarks . note",
    "that increasing @xmath12 means deploying more small cells , and increasing @xmath13 means expanding antenna array at the mbs .",
    "[ remark 2 ] it s not easy to determine the behavior of with respect to @xmath13 directly , but we can facilitate it with the aid of as well as numerical results . from , we know that the downlink rate in is a monotonic function of @xmath13 . meanwhile , fig .",
    "[ fig changewithmm ] reveals that the downlink rate grows as the increment of @xmath13 .",
    "therefore , it can be deduced that the downlink rate monotonically increases with @xmath13 at all the feasible region , which also coincides with our general intuition .",
    "when @xmath173 , the saturation of the downlink rate to a constant value can be directly observed form .",
    "[ remark 3 ] when @xmath12 increases , more users will be associated with scbs , so @xmath174 and @xmath175 grow , and @xmath176 and @xmath177 reduce , which further result in the impact of @xmath13 on downlink rate decays .",
    "larger @xmath12 can shorten the transmission distance and improve the achievable rate , but when @xmath12 exceeds a critical threshold , the aggravation of interferences due to switches from nlos to los will instead impair the rate performance .",
    "equation quantifies how all the key features of an hcn , i.e. , los / nlos transmissions , interference , and deployment strategy affect the achievable downlink rate .",
    "the validation of analysis as well as several numerical results based on will be shown in section  [ sec : numerical results ] to give more practical insights into the design of hcn .",
    "in this section , we validate the accuracy of our analysis through simulations and evaluate the performance of the hcn via numerical results . in particular , we compare the performance of downlink rate achieved by massive mimo and small cells .",
    "then , the optimal network configuration parameters are provided as useful guidance for practical implementations .",
    "finally , we explore the antenna allocation between centralized mbss and distributed scbs .    from a practical perspective",
    ", we use the linear los probability function adopted in 3gpp @xcite for both the mbs and scb path losses , which is given by @xmath178 according to @xcite , parameters used in our simulation are set as follows : @xmath179 km , @xmath180 , @xmath181 , @xmath182 , @xmath183 , @xmath184 dbm , @xmath185 dbm , and @xmath186 dbm .",
    "the uplink pilot power is @xmath187 dbm , and the mbs density is @xmath188 bss / km@xmath189 .      in fig .",
    "[ fig compare_assoprob ] , the simulated user association probability is compared with our analytical results in theorem [ theorem 1 ] . clearly , we can see perfect agreement between the simulated and analytical values , which justifies the accuracy of our calculations .",
    "when @xmath12 increases , as expected , the probability of user association with the mbs reduces and that with the scb grows .",
    "moreover , all the probabilities change with @xmath12 almost linearly , which coincides with the conclusion in remark [ remark 1 ] that the average number of users associated with each scb remains unchanged as @xmath12 increases .",
    "[ fig compare_assoprob ] also reveals that the macro cell users are more likely in nlos transmissions while small cell uses are more likely in los transmissions .",
    "this is because the sparse deployment of mbss leads to a large serving distance between users and their associated mbss , which results in rare los paths , and in contrary , the dense scbs make the los connection to a user more often .    , where @xmath190.,width=332,height=294 ]    in fig .",
    "[ fig compare_withm ] , the simulated achievable downlink rate is compared with the analytical approximation in under different values of @xmath13 and @xmath12 .",
    "we can see that the analytical approximation and simulation results fairly well match and follow the same trend , thus verifies the accuracy of theorem [ theorem 3 ] .",
    "due to the tightness between the simulations and analysis , we will use the latter for our following investigations . note that the number of bs antennas should be larger than the number of users it serves .",
    "hence , @xmath13 is set to be larger than @xmath19 , and @xmath14 is set according to the average number of users associated with each scb as given in corollary [ corollary 1 ] . from fig .",
    "[ fig compare_assoprob ] , we can get the curve slop by line fitting and obtain that @xmath191 .",
    "therefore , the average number of users associated with each scb is @xmath192 .    ,",
    "@xmath193 and @xmath190.,width=332,height=294 ]      in this subsection , we aim to compare the performance of massive mimo and small cells .",
    "in particular , fig .",
    "[ fig changewithlambdascb ] reveals the effect of increasing @xmath12 with fixed @xmath13 , while fig .",
    "[ fig changewithmm ] shows the effect of increasing @xmath13 with fixed @xmath12 . for fairness",
    ", we set the same starting configuration for these two cases , where the mbs antenna array is @xmath194 and the scb density is @xmath195 bss / km@xmath189 .    fig .",
    "[ fig changewithlambdascb ] shows that the downlink rate burgeons with the increment of @xmath12 until reaching a critical threshold , after which the expectancy for further improvement breaks into a slow decline . this is because when @xmath12 is small , the network can benefit a lot from the small cell densification due to the reduced distance between transceivers .",
    "however , when @xmath12 becomes large , more and more interference paths switch from nlos to los , resulting in an aggregated interference that significantly impair the rate performance .",
    "this observation is consistent with the conclusion in @xcite where the set up is with single antenna bss .",
    "the critical scb density threshold , i.e. , the optimal @xmath12 that maximizes the downlink rate , is marked out by black dots .",
    "note that as the scheduled user number @xmath19 grows , the optimal @xmath12 also grows , since more small cells are needed in a more crowded environment .",
    "the optimal @xmath12 for different @xmath19 is summarized in fig .",
    "[ fig optimallambdascb ] .",
    "[ fig changewithmm ] shows that the donwlink rate increases monotonically with respect to @xmath13 , but it can not grow without bound and saturates to a constant value limited by pilot contamination . it can be also observed that the smaller @xmath19 leads to a better rate performance , because we are considering the achievable rate per user , and less number of users gives less interferences .    by comparing figs .",
    "[ fig changewithlambdascb ] and [ fig changewithmm ] , we can see that adding small cells into a sparse network is more effective in boosting up the achievable rate than expanding antenna arrays at mbss .",
    "densification is remarkably beneficial when @xmath12 is low , where the rate can be enhanced almost linearly .",
    "for example , when @xmath196 , we observe that increasing @xmath12 by @xmath197 can bring almost @xmath198 rate gain .",
    "that means , on average , adding @xmath197 small cells into per macro cell can double the downlink rate . in contrast , for the massive mimo system in fig .",
    "[ fig changewithmm ] , we need to add more than @xmath199 antennas to have the same rate gain . however , the peak rate obtained from small cell densification is lower than that from antenna array extension .",
    "besides , as more number of antennas can tolerate more users in a single cell , massive mimo achieves better sum rate than small cell technique .",
    "therefore , we conclude that the deploying small cells can improve the achievable rate fast and effectively , but it will stop benefiting and further impair the network capacity when the scb density exceeds a critical threshold . on the contrary , though the massive mimo technique improves the system performance slower , but expanding antenna size can always benefit the network capacity , and the maximum rate with large @xmath13 is greater than that obtained from small cell deployment . in summary , if the rate demand is low , deploying smalls cell is preferred due to its rapid rate gain ; but if the rate requirement is high , the massive mimo technique is more preferable due to the higher achievable rate it provides .    , where @xmath193 , @xmath194 and @xmath190.,width=332,height=294 ]    , where @xmath195 bss / km@xmath189 , @xmath193 and @xmath190.,width=332,height=294 ]      in this subsection , we are interested in obtaining the optimal scb density @xmath12 that can maximize the achievable downlink rate as shown in fig . [ fig changewithlambdascb ] .",
    "moreover , with abandoned antennas available at mbss , the biasing policy should be adjusted to fully exploit the excessive degrees - of - freedom .",
    "therefore , we also investigate the impact of biasing factor in this subsection .    fig .",
    "[ fig changewithlambdascb ] illustrates how the optimal @xmath12 varies with the number of users scheduled by per mbs , @xmath19 , under different bs antenna numbers .",
    "we can see that the optimal @xmath12 increases monotonically with @xmath19 , since the most effective way to offload traffic caused by crowed users is deploying more scbs .",
    "we also find that the optimal @xmath12 increases @xmath14 and decreases with @xmath13 , which coincides with general intuition as a powerful mbs with large antenna array can provide sufficient data rate for users in its coverage thus requires less scb deployment , while scbs with more antennas are desirable for rate enhancement thus the optimal @xmath12 increases .     vs. number of scheduled users per macro cell @xmath19 , where @xmath190.,width=321,height=294 ]    fig .",
    "[ fig optimalb ] presents the optimal scb bias factor @xmath41 under different mbs antenna number @xmath13 .",
    "clearly , the optimal @xmath41 decreases as @xmath13 grows , since larger @xmath13 can bring more significant rate gain thus a smaller @xmath41 is desired to push more users associated with mbss and benefit from the vast degrees - of - freedom .",
    "we also note that the optimal @xmath41 also decreases with increment of @xmath12 due to a similar argument .",
    "all the above results can serve as useful guidance for practical network design .     vs. number of mbs antennas @xmath13 , where @xmath193 and @xmath196.,width=332,height=294 ]      in this subsection , we explore the antenna resource allocation between the mbs and scbs under fixed amount of antenna budget , i.e. , we aim to investigate how many antennas should be allocated to the mbs and scbs , respectively , such that the system performance can be maximized .",
    "let @xmath200 be the total number of antennas per macro cell .",
    "then , on average , @xmath201 . the proportion of antennas assigned to scbs per macro cell is defined as @xmath202 .",
    "[ fig changewithratio ] shows the achievable downlink rate as a function of @xmath203 for a fixed @xmath204 .",
    "we can see that the rate first increases as @xmath203 grows , which indicates that spare certain amount of centralized mbs antennas to the distributed scbs can improve the system performance .",
    "however , when @xmath203 exceeds a critical value , the rate begins to abate , which means assigning too many antennas to scbs will leave mbs without enough spatial diversity and impair the network capacity .",
    "we also note that the optimal @xmath203 that maximizes the downlink rate , as marked out by black dots , increases with @xmath12 .    , where @xmath204 and @xmath196.,width=332,height=294 ]    more precise information about the optimal @xmath203 is summarized in fig .",
    "[ fig optimalratio ] .",
    "we find that the optimal @xmath203 grows with scb density @xmath12 while remains unchanged for different @xmath19 .",
    "this is because more antennas need to be assigned to scbs when their density increases , while the user density has no impact on the optimal portion .",
    "particularly , the optimal @xmath203 is limited by an upper bounded smaller than @xmath29 , since we can not allocate all antennas to scbs as the mbs needs to schedule users and assign pilots before data transmission",
    ". the practical antenna allocation can get useful references from this figure while combining with hardware constraints .     vs. scb density @xmath12 ,",
    "where @xmath204.,width=332,height=294 ]",
    "in this paper , we have developed a framework for downlink hcn that consists of randomly distributed mbss and scbs with multiple antennas , and the los and nlos transmissions are differentiated . using stochastic geometry ,",
    "we have derived a tight approximation of achievable rates to compare the performance between densifying small cells and expanding bs antenna arrays .",
    "interestingly , we have found that adding small cells into the network is more effective in boosting up the achievable rate than expanding antenna arrays at mbs .",
    "however , when the small cell density exceeds a critical threshold value , the spatial densification stops benefiting and further impairs the network capacity .",
    "in contrast , expanding bs antenna array can always improve the capacity until reaching an upper bound caused by pilot contamination , and this upper bound is larger than the peak rate obtained from deployment of small cells .",
    "therefore , for low rate requirements , the small cell is preferred due to its sheer rate gain ; but for a higher rate requirements , the massive mimo is preferred due to better achievable rate .",
    "the optimal scb density is also presented as a guidance for practical small cell deployment .",
    "moreover , we have found that allocating part of antennas to the distributed scbs is better than centralizing all antennas at the macro bs , and the optimal allocation proportion has also been provided for practical configuration reference . in conclusion , this work has provided a further understanding on how to leverage small cells and massive mimo in future hcns deployment .",
    "in general , the typical user can receive four types of transmit powers , i.e. , from the mbs through los and nlos path , and from scb through los and nlos path , respectively .",
    "the typical user is associated with the mbs in a los path means that this received power is higher than other three cases , which can be formulated from and as follows @xmath205 & = { \\mathbb{p}}\\left [ \\left\\ { \\frac { p_{\\tt m } l^{\\tt l } } { \\left(s_{\\tt m}^{\\tt l}\\right)^{\\alpha^{\\tt l } } } > \\frac{p_{\\tt",
    "m } l^{\\tt nl } } {   \\left(s_{\\tt m}^{\\tt nl}\\right)^{\\alpha^{\\tt nl } } }   \\right\\ } \\bigcap \\left\\ { \\frac{p_{\\tt m } l^{\\tt l}}{\\left(s_{\\tt m}^{\\tt l}\\right)^{\\alpha^{\\tt l } } }   > \\frac{b",
    "p_{\\tt s } l^{\\tt l } } { \\left(s_{\\tt s}^{{\\tt l}}\\right)^{\\alpha^{\\tt l } } }   \\right\\ } \\bigcap \\left\\ { \\frac{p_{\\tt m } l^{\\tt l}}{\\left(s_{\\tt m}^{\\tt l}\\right)^{\\alpha^{\\tt l } } } > \\frac{b p_{\\tt s } l^{\\tt nl } } { \\left(s_{\\tt s}^{{\\tt nl}}\\right)^{\\alpha^{\\tt nl } } }   \\right\\ }   \\right]\\notag\\\\ & = \\",
    "! { \\mathbb{p}}\\!\\left[s_{\\tt m}^{\\tt nl } \\!>\\ !",
    "l}}{\\alpha^{\\tt nl}}}|s_{\\tt m}^{\\tt l } \\!=\\ ! r\\right ] \\",
    "! \\cdot \\ !",
    "{ \\mathbb{p}}\\!\\left[s_{\\tt s}^{{\\tt l } } \\!>\\ !",
    "k_2 r|s_{\\tt m}^{\\tt",
    "l } = r\\right ] \\ ! \\cdot \\ ! { \\mathbb{p}}\\!\\left[s_{\\tt s}^{{\\tt nl } } \\!>\\ !",
    "r^{\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}}| s_{\\tt m}^{\\tt",
    "l } \\!=\\ ! r\\right ] \\",
    "! \\cdot \\ !",
    "f_{s_{\\tt m}^{\\tt l } } ( r ) dr . \\ ] ] with results from void probability , the first term in the integral of can be calculated as follows @xmath206 & =   { \\mathbb{p}}\\left[\\text { no bs in } \\phi_{\\tt m}^{\\tt nl } \\text { is closer than } k_1",
    "r^{\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}}\\right]\\notag\\\\ & = \\exp\\left(-\\int_0^{k_1 r^{\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl } } } } \\lambda_{\\tt m}(1-{\\mathbb{p}}_{\\tt m}^{\\tt l}(u ) ) 2 \\pi u du\\right).\\end{aligned}\\ ] ] similarly , we can derive the second and third terms in respectively as follows @xmath207 & = \\exp\\left(-\\int_0^{k_2 r } \\lambda_{\\tt s}{\\mathbb{p}}_{\\tt s}^{\\tt l}(u ) 2 \\pi u du\\right),\\notag\\\\ { \\mathbb{p}}\\left[s_{\\tt s}^{{\\tt nl } } >",
    "k_1 k_3 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}|s_{\\tt m}^{\\tt l } = r\\right ] & = \\exp\\left(-\\int_0^{k_1 k_3 r^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl } } } \\lambda_{\\tt s}(1-{\\mathbb{p}}_{\\tt s}^{\\tt l}(u ) ) 2 \\pi u du\\right).\\end{aligned}\\ ] ] moreover , the pdf of @xmath54 can be obtained as @xmath208)}{dr}=\\exp\\left(-\\int_0^r \\lambda_{\\tt m } { \\mathbb{p}}_{\\tt m}^{\\tt l } ( u ) 2 \\pi u du \\right )   { \\mathbb{p}}_{\\tt m}^{\\tt l } ( r ) 2 \\pi r \\lambda_{\\tt m}.\\ ] ] therefore , follows from the substitution of  into . by performing the same procedure ,",
    "we can obtain the probabilities @xmath209 $ ] , @xmath210 $ ] , and @xmath211 $ ] .      in order to derive the pdf of @xmath79",
    ", we first investigate its complementary cumulative distribution function as @xmath221 $ ] .",
    "the event @xmath222 is equivalent to that @xmath223 given that the typical user is associated with the mbs in a los path , i.e. , @xmath224={\\mathbb{p}}\\left[s_{\\tt m}^{\\tt l } > r | e_{\\tt m}^{\\tt l}\\right ] = \\frac{{\\mathbb{p}}\\left[s_{\\tt m}^{\\tt l } > r , e_{\\tt m}^{\\tt l}\\right ] } { { \\mathbb{p}}\\left[e_{\\tt m}^{\\tt l}\\right]}.\\ ] ] a similar argument as in leads us to the following calulation @xmath225 & = \\int_r^\\infty   { \\mathbb{p}}\\left[p_{\\tt m } l^{\\tt l } \\left(s_{\\tt m}^{\\tt l}\\right)^{-\\alpha^{\\tt l}}>p_{\\tt m } l^{\\tt nl } \\left(s_{\\tt m}^{\\tt nl}\\right)^{-\\alpha^{\\tt nl}}| s_{\\tt m}^{\\tt",
    "l } = x\\right]\\notag\\\\ & ~~~~~~\\times { \\mathbb{p}}\\left[p_{\\tt m } l^{\\tt l } \\left(s_{\\tt m}^{\\tt l}\\right)^{-\\alpha^{\\tt l}}>p_{\\tt s } l^{\\tt l } \\left(s_{\\tt s}^{{\\tt l}}\\right)^{-\\alpha^{\\tt l}}b | s_{\\tt m}^{\\tt",
    "l } = x\\right]\\notag\\\\ & ~~~~~~\\times { \\mathbb{p}}\\left[p_{\\tt m } l^{\\tt l } \\left(s_{\\tt m}^{\\tt l}\\right)^{-\\alpha^{\\tt l}}>p_{\\tt s } l^{\\tt nl } \\left(s_{\\tt s}^{{\\tt nl}}\\right)^{-\\alpha^{\\tt nl}}b| s_{\\tt m}^{\\tt l } = x\\right]f_{s_{\\tt m}^{\\tt l}}(x ) dx,\\end{aligned}\\ ] ] by using results in  , we have @xmath226 & = \\frac{2 \\pi \\lambda_{\\tt m}}{\\mathcal{a}_{\\tt m}^{\\tt l } }   \\int_r^\\infty x { \\mathbb{p}}_{\\tt m}^{\\tt l}(x ) \\zeta_1\\left(x , k_1 x^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right)\\zeta_2\\left(k_2 x , k_1 k_3 x^\\frac{\\alpha^{\\tt l}}{\\alpha^{\\tt nl}}\\right ) dx.\\end{aligned}\\ ] ] the pdf of @xmath79 is then follows from taking derivative of @xmath227 with respect to @xmath49 .",
    "the pdf of @xmath80 , @xmath81 and @xmath82 can be obtained from the same procedure , which are omitted due to space limits .",
    "we take the derivation of @xmath142 for example . with the maximal - ratio - transmission precoder ,",
    "when the typical user is associated with the mbs @xmath135 in los path , from , we can get @xmath228 where @xmath229 denotes the average over path loss , @xmath230 follows from the approximation in ( * ? ? ?",
    "* lemma 1 ) , and @xmath231 is given as @xmath232 next , we calculate the expectations in separately .    from and , we know the variance of elements in @xmath233 and @xmath234 are @xmath235 and @xmath236 , respectively . hence , we have @xmath237 moreover , @xmath238 where @xmath239 is the @xmath32th element of the channel estimation vector @xmath233 , and @xmath240 is obtained from the substitution of as well as some basic algebraic operations .    for @xmath241 , we obtain @xmath242 where @xmath240 is obtained from the independence of @xmath243 and @xmath244 , and for @xmath245",
    ", we obtain @xmath246 which is got from the independence of @xmath247 and @xmath244 .",
    "when @xmath248 , the result is dependent on the association of @xmath249 , which leads to the following discussion :    * if @xmath250 , i.e. , @xmath249 is associated with the mbs , we have @xmath251 which is obtained according to the similar procedure as . for @xmath252 , @xmath253 which is obtained according to the similar procedure as , and for @xmath254 @xmath255 , @xmath256 * if @xmath257 , i.e. , @xmath249 is associated with the scb , denoted as @xmath258 , we have @xmath259 for @xmath260 , @xmath261 and for @xmath262 , @xmath253      considering that the path loss from interfering cells are much smaller than that from the associated cell , we approximate the large - scale fading coefficients of interfering cells by their means . therefore to denote @xmath229 when the expectation is only averaging over the large - scale fading . ] , we have @xmath265 next , we try to derive the expectations in .    for @xmath266 ,",
    "when @xmath249 is associated with the mbs @xmath21 in los , we obtain @xmath267=\\mathcal{a}_{\\tt m}^{\\tt l},\\ ] ] and @xmath268 similar results can be got for @xmath249 associated with the mbs @xmath21 in nlos , associated with the scb @xmath34 in los and nlos , respectively .",
    "the average number of association users in should be calculated conditioned on @xmath269 or @xmath270 .",
    "then , we have @xmath271 considering that the interference from other cells are generally quite small , according to _ assumption [ assumption 1 ] _ , we can get the following approximation from the campbell s theorem @xcite as follows : @xmath272dr,\\ ] ] and @xmath273dr.\\ ] ] moreover , according to _ assumption [ assumption 1 ] _ and _ [ assumption 2 ] _",
    ", for any @xmath21 , the expectation of the path loss from all interfering users are given by @xmath274 du,\\ ] ] and @xmath275 du.\\ ] ] the substitution of all these expectations into gives @xmath276 therefore , becomes @xmath277 where @xmath240 is from the continuous mapping theorem @xcite , and @xmath278,\\ ] ] @xmath279,\\ ] ] while @xmath280 . with the probability generating functional of the ppp @xcite",
    ", we have @xmath281\\right),\\end{aligned}\\ ] ] and @xmath282\\right).\\end{aligned}\\ ] ] the rate @xmath283 can be obtained by substituting  into .",
    "following the same procedure , we can also derive the rate @xmath284 , @xmath285 , and @xmath286 , respectively .",
    "then , the desired result can be obtained from .",
    "v.  jungnickel , k.  manolakis , w.  zirwas , b.  panzner , v.  braun , m.  lossow , m.  sternad , r.  apelfrojd , and t.  svensson , `` the role of small cells , coordinated multipoint , and massive mimo in 5 g , '' _ ieee commun . mag .",
    "_ , vol .",
    "52 , no .  5 , pp . 4451 , may 2014 .",
    "f.  rusek , d.  persson , b.  k. lau , e.  g. larsson , t.  l. marzetta , o.  edfors , and f.  tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee signal process . mag .",
    "_ , vol .  30 , no .  1 ,",
    "4060 , jan . 2013 .",
    "a.  pitarokoilis , s.  k. mohammed , and e.  g. larsson , `` on the optimality of single - carrier transmission in large - scale antenna systems , '' _ ieee wireless commun .",
    "_ , vol .  1 , no .  4 , pp . 276279 , aug .",
    "s.  wagner , r.  couillet , m.  debbah , and d.  t. slock , `` large system analysis of linear precoding in correlated miso broadcast channels under limited feedback , '' _ ieee trans .",
    "inf . theory _",
    "58 , no .  7 , pp .",
    "45094537 , july 2012 .",
    "h.  yin , d.  gesbert , m.  filippou , and y.  liu , `` a coordinated approach to channel estimation in large - scale multiple - antenna systems , '' _ ieee j. sel .",
    "areas commun .",
    "_ , vol .",
    "31 , no .  2 ,",
    "264273 , jan . 2013 .        q.",
    "zhang , s.  jin , k .- k .",
    "wong , h.  zhu , and m.  matthaiou , `` power scaling of uplink massive mimo systems with arbitrary - rank channel means , ''",
    "_ ieee j. sel .",
    "topics signal process .",
    "_ , vol .  8 , no .  5 , pp . 966981 , oct .",
    "2014 .",
    "d.  lpez - prez , i.  gven , g.  de  la roche , m.  kountouris , t.  q.  s. quek , and j.  zhang , `` enhanced inter - cell interference coordination challenges in heterogeneous networks , '' _ ieee wireless commun . mag .",
    "_ , vol .  18 , no .  3 , pp .",
    "2230 , june 2011 .",
    "h.  s. dhillon , r.  k. ganti , f.  baccelli , and j.  g. andrews , `` modeling and analysis of k - tier downlink heterogeneous cellular networks , ''",
    "_ ieee j. sel .",
    "areas commun . _ ,",
    "30 , no .  3 , pp .",
    "550560 , apr .",
    "jo , y.  j. sang , p.  xia , and j.  g. andrews , `` heterogeneous cellular networks with flexible cell association : a comprehensive downlink sinr analysis , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  11 , no .  10 , pp . 34843495 , oct .",
    "2012 .    h.  s. dhillon , m.  kountouris , and j.  g. andrews , `` downlink mimo hetnets : modeling , ordering results and performance analysis , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  12 , no .  10 , pp .",
    "52085222 , oct .",
    "a.  k. gupta , h.  s. dhillon , s.  vishwanath , and j.  g. andrews , `` downlink multi - antenna heterogeneous cellular network with load balancing , '' _ ieee trans .",
    "_ , vol .",
    "62 , no .  11 , pp . 40524067 , nov .",
    "2014 .",
    "m.  ding , p.  wang , d.  lpez - prez , g.  mao , and z.  lin , `` performance impact of los and nlos transmissions in dense cellular networks , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  15 , no .  3 , pp . 23652380 ,",
    "mar . 2016 .",
    "s.  singh , x.  zhang , and j.  g. andrews , `` joint rate and sinr coverage analysis for decoupled uplink - downlink biased cell associations in hetnets , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .",
    "14 , no .",
    "53605373 , oct .",
    "since each mbs randomly schedules @xmath19 users into its cell , the density of scheduled users are @xmath212 . let @xmath213 be the area of the entire network .",
    "then , the total number of scheduled users in the network is @xmath214 , where , on average , @xmath215 users are associated with the mbs , and @xmath216 users are associated with the scb .",
    "therefore , considering that the total number of mbss in the network is @xmath217 and the total number of scbs is @xmath218 , we can get average number of users associated with each mbs as @xmath219 and the average number of users associated with each scb as @xmath220"
  ],
  "abstract_text": [
    "<S> we develop a framework for downlink heterogeneous cellular networks with line - of - sight ( los ) and non - line - of - sight ( nlos ) transmissions . using stochastic geometry , </S>",
    "<S> we derive tight approximation of achievable downlink rate that enables us to compare the performance between densifying small cells and expanding bs antenna arrays . </S>",
    "<S> interestingly , we find that adding small cells into the network improves the achievable rate much faster than expanding antenna arrays at the macro bs . however , when the small cell density exceeds a critical threshold , the spacial densification will lose its benefits and further impair the network capacity . to this end , </S>",
    "<S> we present the optimal small cell density that maximizes the rate as practical deployment guidance . in contrast , expanding macro bs antenna array can always benefit the capacity until an upper bound caused by pilot contamination , and this bound also surpasses the peak rate obtained from deployment of small cells . furthermore , we find that allocating part of antennas to distributed small cell bss works better than centralizing all antennas at the macro bs , and the optimal allocation proportion is also given for practical configuration reference . in summary , this work provides a further understanding on how to leverage small cells and massive mimo in future heterogeneous cellular networks deployment .    </S>",
    "<S> heterogeneous cellular networks , los / nlos , massive mimo , small cells , stochastic geometry </S>"
  ]
}