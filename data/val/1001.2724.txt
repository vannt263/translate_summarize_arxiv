{
  "article_text": [
    "the wide use of pixe as an experimental technique has motivated several dedicated software systems ; nevertheless , limited functionality for pixe simulation is available in general - purpose monte carlo codes .",
    "geant4 @xcite addresses x - ray emission induced both by electrons and heavy particles like protons and @xmath0 particles .",
    "the simulation of pixe involves the energy loss and scattering of the incident particle , atomic shell ionization cross sections , and atomic transition probabilities and energies .",
    "intrinsically , pixe is a discrete process : x - ray emission occurs as the result of a vacancy in shell occupancy , in competition with auger electron emission and coster - kronig transitions .",
    "nevertheless , this discrete process is intertwined with the ionization process , which determines the production of the vacancy ; this process is treated in general - purpose monte carlo codes with mixed condensed and discrete transport schemes , since excessive computational resources would be necessary to handle the infra - red divergent cross section with a discrete scheme .    while this combined condensed and discrete particle transport scheme is appropriate to many simulation applications , it suffers from drawbacks with respect to the generation of pixe .",
    "atomic relaxation occurs only in connection with the discrete part of the transport scheme , where the production of a @xmath1-ray can be associated with the creation of a vacancy ; therefore the fluorescence yield depends on the threshold for the secondary electron production .",
    "another drawback is that the cross section for the production of a @xmath1-ray is calculated from a model for energy loss that is independent of the shell where the ionization occurs .",
    "this paper analyzes tools pertinent to pixe simulation available in geant4 at the time of the chep 2009 conference and describes a set of developments to extend the simulation capabilities in this domain .",
    "a more extensive account can be found in @xcite .",
    "software models for the simulation of pixe induced by protons and @xmath0 particles are currently available in the geant4 low energy electromagnetic package @xcite .      the first development cycle @xcite involved a software design for interchangeable ionization cross sections models .",
    "based on the cross section calculations , the ionisation process creates a vacancy , and uses geant4 atomic relaxation @xcite for producing fluorescence photons and auger electrons .",
    "three ionization cross section models were implemented .",
    "the _ g4hshellcrosssection _ class implements cross sections based on gryzinski s model @xcite .",
    "it appears to be affected by a severe problem of inconsistency with experimental data .",
    "k shell ionization cross sections based on fits to tabulated data are implemented @xcite in _ g4hshellcrosssectionexp _ and _ g4hshellcrosssectiondoupleexp_. these models have been documented by their implementers @xcite as cross sections for k shell ionization by protons based on paul and sacher compilation @xcite .",
    "nevertheless , they appear to describe the cross sections for k shell ionization by @xmath0 particles based on by paul and bolik compilation @xcite , as it is evident in fig .",
    "[ fig_saliceti ] .     particles ( open symbols ) : the curves are respectively for si ( squares ) , cu ( triangles ) , cd ( crosses ) and au ( white circles ) .",
    "the line represents ecpssr k shell cross sections for @xmath0 particles from the prototype developments of this paper.,width=321 ]    the algorithm implemented to identify the shell where a vacancy is created introduces a dependency on the user - defined electron production threshold .",
    "this is prone to generate inconsistent behavior , as it is illustrated in fig .",
    "[ fig_cut ] . a detailed discussion of this issue can be found in @xcite .",
    "-ray production thresholds : 1 kev ( white circles ) , 10 kev ( white squares ) and 100 kev ( white triangles ) . for some @xmath1-ray",
    "production thresholds the total cross section results smaller than the cross section for ionising any shell.,width=321 ]      a set of ionization cross section implementations @xcite for pixe simulation were released in geant4 9.2 .",
    "the cross sections for k shell ionization are based on interpolations of empirical data compilations ( paul and sacher @xcite for protons , paul and bolik @xcite for @xmath0 particles ) and on the ecpssr theory @xcite ; they are respectively implemented in the geant4 _ g4paulkcrosssection _ and _ g4ecpssrcrosssection _ classes .",
    "the cross sections for l shell ionization by protons are based on the semi - empirical model of @xcite .",
    "the plots in @xcite compare geant4 9.2 cross section implementations for k shell ionization by protons and proton ionization experimental data , with the cross section models for @xmath0 particles of the first development cycle : this comparison is not pertinent to demonstrate the capabilities of the geant4 9.2 implementations with respect to the previous ones .",
    "the software described in @xcite and released in geant4 9.2 is affected by several drawbacks .    _",
    "g4paulkcrosssection _ is slower in execution by a factor 40 to 60 approximately than the previously existing classes implementing the same functionality , and two orders of magnitude slower than the equivalent implementation described in this paper .",
    "other drawbacks are a memory leak and the attempt to open data files not included in the geant4 9.2 release .",
    "the _ g4ecpssrcrosssection _ class computes k shell ionization cross section for protons and @xmath0 particles nominally based on the ecpssr formulation @xcite .",
    "however , it does not appear to reproduce ecpssr cross sections correctly : for instance , fig . 1 to 3 in @xcite",
    "exhibit an evident divergence at higher energies of these implementations with respect to the empirical data by paul and sacher .",
    "figure [ fig_haifa_k29 ] shows that this discrepancy hints to a flawed software implementation of the ecpssr theory in _ g4ecpssrcrosssection _ , rather than a deficiency of the ecpssr theory as suggested by the authors of @xcite .",
    "this class results in slower execution ( by a factor 6 - 8 ) than the ecpssr models described in this paper .     based on isics tabulations ( solid line ) , and empirical model of paul and sacher @xcite ( black circles ) .",
    "_ g4ecpssrcrosssection _ does not appear to implement the ecpssr theoretical model correctly .",
    ", width=321 ]    the semi - empirical model by orlic et al .",
    "@xcite implemented in _",
    "g4orliclcrosssection _ has limited capabilities : it computes cross sections for l@xmath2 sub - shells only for elements with atomic number greater than 40 and is valid only for proton energies up to approximately 10  mev . moreover , as demonstrated in section [ sec_lvalidation ] , it is less accurate than other available models .",
    "the cross section models released in geant4 9.2 exhibit severe software design limitations , that prevent client code from exploiting either dynamic or static polymorphism . due to their design features , these models are not practically usable for pixe simulation applications based on geant4 ; their implementation features - correctness , computational performance and physical accuracy - motivate concerns about their use in experimental studies .",
    "the new developments for pixe simulation involved a re - design of the software , extended physics capabilities , the validation against experimental data and the application to an experimental use case .",
    "the domain decomposition at the basis of pixe simulation with geant4 identified three main entities with associated responsibilities : the hadron ionization process , the creation of a vacancy in the shell occupancy resulting from ionisation , the deexcitation of the ionised atom with the associated generation of x - rays .",
    "the simulation of pixe is the result of the collaboration of these entities .",
    "a class diagram in the unified modelling language ( uml ) illustrates the main features of the software design in fig .",
    "[ uml_fig ] .",
    "a wide choice of cross section models for k , l and m shell ionization is provided in the prototype software for protons and @xmath0 particles .",
    "the availability of ionization cross section calculations and experimental data for outer shells is very limited in literature .",
    "theoretical cross section models include plane wave born approximation ( pwba ) and variants of the ecpssr model : the original ecpssr formulation @xcite , ecpssr with united atom correction ( ecpssr - ua ) @xcite , ecpssr with corrections for the dirac - hartree - slater nature of the k shell @xcite ( ecpssr - hs ) , as well as calculations based on recent improvements to k shell cross section specific to high energy @xcite ( ecpssr - he ) .",
    "the cross sections have been tabulated and assembled in a data library ; the values at a given energy are calculated by interpolation .",
    "the tabulations corresponding to theoretical calculations span the energy range between 10  kev and 10  gev ; empirical models are tabulated consistently with their energy range of validity .",
    "the adopted data - driven approach optimizes performance speed and offers flexibility for chosing a cross section model .",
    "ecpssr tabulations have been produced using the isics software @xcite , 2006 version and an extended version @xcite including recent high energy developments .",
    "tabulations of ecpssr calculations as reported in @xcite are also provided .",
    "empirical cross section models for k shell ionization include the tabulations for protons documented in @xcite and a more recent one @xcite .",
    "an empirical cross section model for k shell ionization by @xmath0 particles is based on the tabulations in @xcite .",
    "empirical models for l shell ionization by protons have been developed by miyagawa et al .",
    "@xcite , sow et al .",
    "@xcite and orlic et al .",
    "@xcite .",
    "the isics software allows the calculation of cross sections for heavier ions as well ; therefore , the current pixe simulation capabilities can be easily extended in future development cycles .",
    "the determination of which atomic ( sub-)shell is ionised is related to its ionisation cross section with respect to the total cross section for ionising the target atom . however",
    ", as previously discussed , the condensed - random - walk scheme raises an issue as to estimating the total ionisation cross section at a given energy of the incident particle .",
    "a different algorithm has been adopted with respect to the one implemented in the first development cycle : the vacancy in the shell occupancy is determined based on the total cross section calculated by summing all the individual shell ionisation cross sections .",
    "this algorithm provides a correct distribution of the produced vacancies as long as ionisation cross sections can be calculated for all the atomic shells involved in the atomic structure of the target element . since",
    "cross section models are currently available for k , l and m shells only , at the present status of the software this algorithm overestimates pixe for elements whose atomic structure involves outer shells , because of the implicit underestimation of the total ionization cross section .",
    "this approach , however , provides better control on the simulation results than the algorithm implemented in the first development cycle .",
    "the production of secondary particles by the atomic relaxation of an ionized atom is delegated to the atomic relaxation component .",
    "the availability of a wide variety of cross section models for the first time in the same computational environment allowed a detailed comparative assessment of their features against experimental data .",
    "due to the limited page allocation in the conference proceedings and copyright constraints with the publisher of @xcite , only a brief summary is reported here ; further details can be found in @xcite , including the full list of elements subjects to test against experimental data and a large collection of plots demonstrating the comparison between simulation and experimental data .",
    "the comparison of cross sections as a function of energy was performed for each element by means of the @xmath3 test .",
    "contingency tables were built on the basis of the outcome of the @xmath3 test to determine the equivalent , or different behavior of model categories .",
    "the input to contingency tables derived from the results of the @xmath3 test : they were classified respectively as `` pass '' or `` fail '' according to whether the corresponding p - value was consistent with a 95% confidence level .",
    "the contingency tables were analyzed with fisher exact test @xcite .",
    "the reference experimental data were extracted from @xcite .",
    "c|c|c|c|c|c|c cl & ecpssr & ecpssr - he & ecpssr - hs & ecpssr - u & paul - sacher & kahoul +   + 95% & 67 & 74 & 77 & 68 & 71 & 46 + 99% & 85 & 83 & 83 & 85 & 80 & 57 +   + 95% & 69 & 75 & 86 & 69 & 70 & 48 + 99% & 83 & 81 & 91 & 83 & 80 & 56 +    the fraction of test cases for which the @xmath3 test fails to reject the null hypothesis at the 95% and 99% confidence level are listed in table [ tab_kpass ] : all the cross section models implemented in the simulation exhibit equivalent behaviour regards the compatibility with the experimental data , with the exception of the kahoul et al .",
    "the contingency table comparing the kahoul et al .",
    "and ecpssr - hs models confirms that the two models show a statistically significant difference regards their accuracy ( p - value of 0.001 ) .",
    "the contingency tables associated with the other models show that they are statistically equivalent regards their accuracy .",
    "however , when only the lower energy range ( below 5 - 7  mev , depending on the atomic number ) is considered , a statistically significant difference at the 95% confidence level ( p - value of 0.034 ) is observed between the ecpssr model and the ecpssr - hs one ; the latter is more accurate with respect to experimental data .    from this analysis",
    "one can conclude that the implemented k shell ionization cross section models exhibit a satisfactory accuracy with respect to experimental measurements .",
    "the cross sections for l sub - shell ionization cross sections were compared to the experimental data collected in two complementary compilations @xcite , @xcite . the same method was applied as described for the validation of k shell cross sections .",
    "the ecpssr model appears to provide a satisfactory representation of l shell ionisation cross sections with respect to experimental data , especially with its united atom variant .",
    "the ecpssr - ua exhibits the best overall accuracy among the various models ; the orlic et al .",
    "model exhibits the worst accuracy with respect to experimental data .",
    "this semi - empirical model is the only option implemented in geant4 9.2 for the calculation of l shell ionization cross sections .",
    "the accuracy of the various cross section models was studied by means of contingency tables to evaluate their differences quantitatively .",
    "the categorical analysis was performed between the ecpssr model with united atom correction , i.e. the model showing the best accuracy according to the results of the @xmath3 test , and the other cross section models .",
    "the contingency tables were built based on the results of the @xmath3 test at the 95% confidence level , summing the `` pass '' and `` fail '' outcome over the three sub - shells .",
    "the orlic et al .",
    "semi - empirical model is found to be significantly less accurate than the ecpssr - ua model : the hypothesis of equivalence of their accuracy with respect to experimental data is rejected at 99% confidence level .",
    "the p - values concerning the comparison of the miyagawa et al . empirical model are close to the critical region for 95% confidence , and slightly different for the three tests performed on the related contingency table .",
    "the sow et al . empirical model and the ecpssr model in its original",
    "formulation appears statistically equivalent in accuracy to the ecpssr model with united atom correction .    as a result of this analysis , the ecpssr model with united atom approximation",
    "can be recommended for usage in geant4-based simulation applications as the most accurate option for l shell ionization cross sections . the ecpssr model in its original formulation",
    "can be considered a satisfactory alternative ; the sow et al .",
    "empirical model has satisfactory accuracy , but limited applicability regards the target elements and proton energies it can handle .",
    "pixe as a technique for elemental analysis is usually performed with proton beams of a few mev . in the recent years",
    ", higher energy proton beams of a few tens mev have been effectively exploited too .",
    "high energy protons are a source of pixe in the space radiation environment .",
    "the interest in high energy pixe has motivated recent theoretical investigations @xcite concerning cross section calculations at higher energies . despite the emerging interest of high energy pixe ,",
    "only a limited set of experimental data is available above the energy range of conventional pixe techniques .",
    "the accuracy of the implemented k shell cross section models was evaluated against two sets of measurements at higher energy @xcite , respectively at 66 and 68 mev . the experimental measurement with uranium was not included in the comparison , since it appears affected by some experimental systematics .",
    "the @xmath3 test was performed first separately on either experimental data set to evaluate the possible presence of any systematics in the two test cases , then on the combined data set .",
    "the p - values from the @xmath3 test against these experimental data are listed in table [ tab_hepixe ] .    over the limited data sample considered in this test",
    ", the ecpssr model with the correction in @xcitethis model does not appear to provide better accuracy than the original ecpssr formulation ; nevertheless more high energy experimental data would be required to reach a firm conclusion .",
    "also , this analysis should be verified over tabulation deriving from a published version of the isics code , when it becomes available .",
    ".p - values from the @xmath3 test concerning high energy experimental data [ cols=\"<,^,^,^,^ \" , ]",
    "the prototype components for pixe simulation described in the previous sections were applied to a study of the passive , graded z shielding of the x - ray detectors of the erosita telescope @xcite on the upcoming russian spectrum - x - gamma space mission .",
    "the background spectra due to cosmic - ray protons were simulated for the three different erosita graded z shield designs .",
    "a comparison of the results is depicted in fig .",
    "[ comp_shield ] .",
    "this application demonstrates that the developed software is capable of supporting concrete experimental studies .",
    "nevertheless , the concerns outlined in the previous sections should be kept in mind : while the present pixe simulation component can provide valuable information in terms of relative fluorescence yields from inner shells , the intrinsic limitations of the mixed transport scheme in which ionization is modelled and the lack of cross section calculations for outer shells prevent an analysis of the simulation outcome in absolute terms .",
    "this paper presents a brief overview of the status , open issues and recent developments of pixe simulation with geant4 ; a more extensive report of the underlying concepts , developments and results is available in @xcite .",
    "the analysis of the related models currently available in geant4 showed their limitations under various aspects : physics functionality , correctness of implementation , accuracy , consistent behavior , software design , performance and usability .",
    "the new developments represent a significant step forward regards pixe simulation with geant4 .",
    "they extend the capabilities of the toolkit by enabling the generation of pixe associated with k , l and m shells for protons and @xmath0 particles ; for this purpose a variety of cross section models are provided . the adopted data - driven strategy and the software design improve the computational performance over previous geant4 models .",
    "the validity of the implemented models has been quantitatively estimated with respect to experimental data .",
    "the results provide objective guidance for the optimal selection of simulation models in user applications .",
    "an extensive ionisation cross section data library has been created as a by - product of the development process : it can be of interest to the experimental community for a variety of applications , not necessarily limited to pixe simulation with geant4 .",
    "some issues identified in the course of the development process are still open : they concern the consistency of pixe simulation in a mixed condensed - discrete particle transport scheme . a possible approach to address them , while preserving the current continuous - discrete design scheme of hadron ionisation in geant4 , would involve the calculation of ionization cross sections for outer shells than m , this calculation is feasible , exploiting known theoretical methods , yet it would require a significant investment of resources . in parallel ,",
    "a project @xcite is in progress to address design issues concerning co - working condensed and discrete transport methods in a general purpose simulation system .    despite the known limitations related to mixed transport schemes , the software developments described in this paper provide sufficient functionality for realistic experimental investigations .",
    "the plans concerning the public availability of these new developments are discussed in @xcite .",
    "the authors express their gratitude to a.  zucchiatti for valuable discussions on pixe experimental techniques , to s.  cipolla for providing a prototype version of isics 2008 , and to s. bertolucci and u. bratzler for helpful comments and advice .",
    "the authors are grateful to the rsicc staff at ornl , in particular b. l. kirk and j. b. manneschmidt , for the support to assemble a ionization cross section data library for public distribution resulting from the developments described in this paper ."
  ],
  "abstract_text": [
    "<S> particle induced x - ray emission ( pixe ) is a physical effect that is not yet adequately modelled in geant4 . the current status as in geant4 9.2 </S>",
    "<S> release is reviewed and new developments are described . </S>",
    "<S> the capabilities of the software prototype are illustrated in application to the shielding of the x - ray detectors of the erosita telescope on the upcoming spectrum - x - gamma space mission . </S>"
  ]
}