{
  "article_text": [
    "high energy density experiments conducted on large laser facilities are often highly complex in every way .",
    "the physics of the target s interaction with the laser , its evolution with time , the relevant material properties at the conditions of interest , and the relation between target properties and observable quantites all require significant effort to describe , and all involve approximations .",
    "this is particularly true of so - called ` integrated ' experiments , such as the inertial confinement fusion ( icf ) effort underway at lawrence livermore national laboratory @xcite , in which extremely complex targets probe all aspects of the icf approach to nuclear fusion .    in general the only way that such complex systems can be accurately understood",
    "is through computer simulation .",
    "these simulations take a range of inputs desribing the target , laser system , and input physics and provide a description of the target evolution .",
    "this can then be mapped onto the output of experimental diagnostics .",
    "the approach represents a nonlinear , ` black box ' transformation from the uncertain input physics to the measured quantites ; the inversion of this to provide information about difficult physics can be a very difficult statistical problem . in this paper",
    "we discuss the application of bayesian statistics @xcite to the solution of this problem , and in particular to the inference of interesting physical parameters from an icf experiment performed at the national ignition facility ( nif ) .",
    "the bayesian approach is a well developed statistical method that can be formulated to give powerful results for the inference of interesting quantities @xcite , or alternately to provide a rigorous framework for the design of new experimental methods @xcite .",
    "bayesian theory includes the prior knowledge of the system explicitly and so allows the evolution of interesting quantities to be charted as data accumulates from various sources .",
    "the numerical application of the theory is usually through markov chain monte carlo techniques @xcite ; in the below we develop a method of incorporating the advantages of the bayesian theory into genetic algorithm approaches which can be parrallelised very easily .",
    "these numerical methods have been applied in almost all areas of science for data analysis , including fusion studies , high energy density physics experiments @xcite , and hydrodynamic simulations @xcite .",
    "the example chosen here includes aspects of all of these types of experiment .    in the following section the bayesian approach",
    "is set out .",
    "particular attention is paid to the interpretation of bayes theorem as an information processing rule , since this can be very useful in understanding the evolution of physical models .",
    "the relationship between bayesian methods and the common @xmath0 methodology is discussed , which allows a generalised @xmath0 to be defined that takes into account the effect of nuisance parameters in an experiment , and of prior knowledge of the system .",
    "this is applied to a nif ` convergent ablator ' experiment , and used to show the variation in the expected carbon opacity as these bayesian factors are introduced .",
    "finally , the mcmc and ga approaches are applied to the same analysis and discussed .",
    "in the bayesian approach real numbers are used to describe the level of belief that a statement is true .",
    "a set of intuitive axioms govern these numbers , which coincide with the axioms of the usual probability theory . as such",
    ", bayesian statistics can be developed as a re - intepretation of frequentist statistics ; rather than the usual understanding that the probability @xmath1 , @xmath2 becomes the belief that the statement @xmath3 is true .",
    "this belief depends on some background information @xmath4 , a dependance that is expressed using the conditional probability @xmath5 .",
    "an experiment has the effect of updating the background information with some observation @xmath6 , so that after the experiment the belief becomes @xmath7 .",
    "the analysis of this updated probability forms the basis of bayesian analysis .",
    "the axioms of the theory allow the important bayes theorem to be derived , @xmath8 which relates the probability after the observation of @xmath9 ( the _ posterior _ ) to the probability before ( the _ prior _ ) through the probability of observing the data when the value of @xmath10 is assumed , @xmath11 ( the _ likelihood _ ) .",
    "the terms in equation can be viewed as functions of any of their arguments ; the study of @xmath12 as a function of @xmath13 allows the value of @xmath13 to be inferred from data , whereas treating @xmath12 as a function of @xmath14 allows the significance of particular observations to be explored .",
    "the latter of these allows the design of experiments by ensuring that an experiment collects the most significant data possible .",
    "bayes theorem can be viewed as rule for describing the flow of information in an experiment @xcite .",
    "the _ information _ associated with an observation of the random variable @xmath15 is @xmath16 where the above is measured in ` nats ' .",
    "the more usual unit of ` bits ' is found using a base 2 logarithm .",
    "the information associated with an unlikely observation is greater than that with an unsurprising result .",
    "bayes theorem becomes @xmath17 and so so the effect of an experiment is to add the new and prior informations .",
    "the information defined in equation is evaluated for a given observation result @xmath18 ; when this is not known ( as in problems of experimental design ) it is necessary to consider the expectation value of the information , the _ information entropy _",
    "@xmath19 = -\\int p(z){\\rm ln } p(z ) dz          \\label{eq : information_entropy }          ~{\\rm , } \\ ] ] which is now a property of the distribution @xmath20 only .",
    "cross entropy _ between two distributions @xmath20 and @xmath21 , @xmath22 = -\\int p(x){\\rm ln } q(x ) dx          \\label{eq : information_cross_entropy }          ~{\\rm , } \\ ] ] measures the common information in the two distributions .",
    "this is particularly useful since it is conserved in bayes theorem @xcite . using the above definition equation",
    "can be written as @xmath23 = h\\left [ p(x\\vert d,\\mathbb{i } ) \\vert p(d\\vert x,\\mathbb{i } ) \\right ]                  \\notag          ~{\\rm , } \\ ] ] or @xmath24 = h\\left [ p(x\\vert d,\\mathbb{i } ) \\vert p(d\\vert x,\\mathbb{i})\\right ]                  \\label{eq : kl_distance }          ~{\\rm , } \\ ] ] so that the increase in cross entropy between the posterior and prior ( the _ kullback - leibler distance _ ) is equal to the cross entropy between posterior and likelihood .",
    "experimental design problems often maximise @xmath25 to maximise the effectiveness of an experiment . using the above definitions it has been shown that bayes theorem is the only information processing rule that exactly conserves information cross entropy @xcite .",
    "the above definitions are all useful forms of the same rule ; the information that a given experiment provides is described by the likelihood function @xmath11 .",
    "data analysis is then the analysis of the likelihood function for a given experiment and model , and standard models can be understood as special cases of the likelihood and prior .",
    "for example , it is common to use a normally distributed likelihood @xmath26 where @xmath27 is a model for the data given the parameter @xmath13 ; in this case the information associated with an observation is the usual @xmath0 function @xcite .",
    "the @xmath0 minimisation method is then equivalent to finding the value of the parameter @xmath13 that minimises the information provided by the experiment ( that is , the parameter for which the observation is the least surprising ) . for a constant prior probability @xmath28 ( often used to describe complete ignorance )",
    "this is in turn equivalent to finding the value of @xmath13 that has the largest posterior probability .",
    "hence the @xmath0 minimisation method can be seen to contain two approximations ; the neglect of the structure of the posterior , and the neglect of prior information .",
    "the prior information plays an important role in bayesian analysis . in general",
    "it contains all information that is available before the experiment ; expert opinion , the results from previous experiments , etc .",
    "its inclusion allows otherwise very difficult problems to be tackled , and allows the belief in a model or parameter to evolve over time by using the posterior from one experiment as the prior of another . as such data analysis can include the results from entire campaigns of experiments common in modern science , and these experiments need not have the same design or be performed by the same people .",
    "all that is required is an expression for the likelihood function for a given experimental design .",
    "in this work we aim to investigate the bayesian analysis of inertial confinement fusion experiments performed at the national ignition facility .",
    "the usual analysis procedure is to use radiation - hydrodynamic simulations to provide post - shot analysis ; measured quantities like laser power are used as inputs for simulations , the outputs of which are compared to other measured quantities .",
    "this comparison is used to gain information about the physics used by simulations , and other unmeasured properties of the experiment .",
    "we consider nif shot n110625 , a ` convergent ablator ' experiment designed to mimick the implosion dynamics of a full ignition shot .",
    "this shot is of interest since large - scale post shot simulations have been performed in the past , in which a large number of target parameters were varied .",
    "this dataset will serve to benchmark the smaller set of simulations used in this study .",
    "the eventual aim is that advanced numerical methods such as markov - chain monte carlo ( mcmc ) routines , or genetic algorithms ( ga ) , are used to perform efficient analysis of nif data . to acheive this a robust platform for running hydrodynamic simulations",
    "is required , and the feasibility of such large - scale simulations must be investigated . to that end a set of fortran wrapper routines have been developed that allow the radiation - hydrodynamic code hydra to run as a subroutine to a generic mcmc or ga code .",
    "these routines take a set of values of various input parameters ( opacity , equation of state and drive modifiers , etc . ) and return various measurable characteristics of the implosion .",
    "modification of input physics databases , and extraction of implosion dynamics , is performed using existing scripts to ensure that returned values are consistent with those commonly used in nif data analysis .",
    "calculations are done in parallel , allowing an analysis code to consider several tens of thousands of hydra simulations in one job allocation .    in this work",
    "a grid of 1024 simulations of a convergent ablator implosion has been generated , in which a constant multiplier is applied to the absorption opacity of carbon and to the x - ray drive .",
    "a representation of the results is shown in figure [ fig : me_vs_dc ] , in which the velocity of the centre of mass of the fuel is plotted as a function of carbon opacity multiplier ( averaging over all other parameters ) .",
    "black points show the results of the earlier parameter scan , with the blue line and shading representing a moving average of the mean and standard deviation of those results .",
    "the mean and standard deviation of the results of this work are shown in red .",
    "the solid line represents the nominal ( unmodified drive ) case , and the broken line shows the drive - averaged case . the large difference between these lines demonstrates the difficulty in increasing implosion velocity in these targets . finally , the black region shows the experimental value @xcite .",
    "the data in figure [ fig : me_vs_dc ] agree well for the nominal case .",
    "the large number of parameters in the original data results in statistical noise in these results , the non - overlapping set of modifications made to simulations ( original simulations focused more on changes to the capsule design than input physics ) , and the differences between the sampling of parameter space mean that the averages do not agree .",
    "the good agreement between the current work s nominal case and the previous results demonstrates that the hydra simulations used here are reasonable .",
    "it should be noted , however , that the simple modifications to the drive used here do not reflect the current understanding of the x - ray drive in icf experiments , rather they were chosen as the drive multiplier is likely to correlate with the opacity multiplier .",
    "we will use three measured results in the calculation of the likelihood ; the implosion velocity when the centre of mass of the fuel reaches a radius of 310@xmath29 m , the time at which this radius is reached , and the fraction of ablator mass still remaining at this time @xcite .",
    "experimental data for these are available , and they can be easily extracted from hydra simulations .",
    "there are no simulated points that are able to match all three experimental values , making a statistical approach essential .",
    "as discussed in the previous section , a simple model for the likelihood is an uncorrelated multivariate normal distribution .",
    "the information associated with the likelihood in this case , as a function of the two parameters we wish to infer , is plotted in figure [ fig : normal_likelihood_info ] .",
    "the most likely values of the drive and opacity multipliers occur at the minimum point of this surface , when the data are the least surprising .",
    "if each of the 3 experimental points are considered individually , each one defines a range of values of opacity and drive multipliers that best match the experimental result .",
    "the minimum information point in figure [ fig : normal_likelihood_info ] results from the superposition of the three data points , giving rise to a broad range of ( approximately ) equally likely values of the simulation input parameters .",
    "the assumption of a normal distribution for the calculation of the likelihood is based on assumptions about the nature of the _ experimental _ error .",
    "simulations are treated as deterministic . in practice",
    "this is not the case ; the values of input parameters will have a probability distribution as well ( reflecting the accuracy with which they are calculated , for example ) and the resulting distribution of code outputs will change the shape of the likelihood function .",
    "proper inclusion of all sources of error rapidly increase the parameter space for simulations and so it is advantageous to use an approximate method for some parameters . for this",
    "we use a normal linear model @xcite , which we develop below .    consider the likelihood function for a simulation with two inputs as before , but where one is a ` nuisance ' parameter .",
    "if the nuisance parameter is normally distributed , and the response of the simulation to variations in the parameter is linear , then the likelihood function is a normal distribution with a modified width ( see below ) .",
    "this linear response method can be used to include the effect of a large number of nuisance parameters with a greatly reduced number of simulations .",
    "the potential accuracy of this approach is improved by the fact that input physics models , target fabrication , etc .",
    "are highly developed for icf applications making the expected variations in nuisance parameter values small .    to develop the linear response model ,",
    "consider a normal approximation in which the likelihood is given by the multivariate distribution with covariance matrix @xmath30 , @xmath31 splitting the simulation input vector @xmath13 into the set of interesting parameters @xmath32 and nuisance parameters @xmath33 , introducing a second multivariate normal distribution ( of covariance @xmath34 ) to describe the variations in nuisance parameters , and treating the response of a simulation as linear , @xmath35 the likelihood function can be found analytically . using @xmath36 ,",
    "the result is @xmath37 ( d-\\bar{d}(x^{\\prime}))}}{\\sqrt{(2\\pi)^{n_{d}}|\\lambda_{d}||\\lambda_{y}||\\alpha^{t}\\alpha| } }           ~{\\rm , }          \\label{eq : likelihood_marginal}\\ ] ] where @xmath38 is the nominal simulation result @xmath39 and the matrices @xmath40 and @xmath41 satisfy the equations @xmath42 in this approximation the likelihood is a normal distribution with a modified covariance matrix .",
    "the modification is not diagonal , and so the effect of the simulation response is to distort and rotate the likelihood ; the rotation is towards an axis determined by the strength of the simulation response to the various nuisance parameters and by the expected variation in those parameters . in the case of current interest ,",
    "in which experimental data have already been observed , the information associated with the observation @xmath14 ( equation ) is modified to become @xmath43 which defines a modified @xmath0 function that takes into account prior information and the effect of nuisance parameters .",
    "these considerations have an important effect on the information associated with a given measurement , and therefore the results of any analysis .",
    "the effect of nuisance parameters on n110625 can be included in the above way .",
    "we use previous design calculations to populate the response matrix @xmath44 , treating variations in capsule dimensions and chemical composition as nuisance parameters .",
    "these are allowed to vary according to their specified manufacturing tolerances @xcite .",
    "the modification to the likelihood by these parameters is quite significant ; the power of the linear response model is that once the modifications ( in the form of the new covariance matrix ) are known , subsequent analyses do not need to explicitly include the effect of nuisance parameters at all .",
    "given knowledge of the prior , from the work in the previous sections and the results of hydra simulations , we can infer the drive and carbon opacity multipliers from the described data , including prior information and the effect of nuisance parameters .",
    "the results are shown in figure [ fig : final_info ] ; ( a ) shows the information ( equivalently , the logarithm of the posterior ) where variations in capsule dimensions and atomic composition are neglected , and ( b ) show the results when they are included .",
    "both plots use an uncorrelated normal distribution for the prior , with a standard deviation of 0.1 in both directions ; as such both represent a more advanced analysis than the @xmath0 approach shown in figure [ fig : normal_likelihood_info ] .",
    "the distortion of the likelihood by nuisance parameters has the effect that the peak in the information is more localised , however the overall distribution is broader suggesting a larger error bar on the inferred values .",
    "this can be made more clear by re - casting the data as the posterior probability of the value of the carbon opacity multiplier , by integrating over the drive multiplier .",
    "this is not equivalent to the treatment of the drive multiplier as ` nuisance ' ; the detailed response of the system to changes in drive has been included ( not the linear response ) .",
    "this approach will prove more accurate for some rapidly varying parameters , however represents a calculation time penalty .",
    "the advantage is in the inspection of correlations between parameters that the multi - dimensional analysis allows .",
    "the results of integrating over variations in x ray drive are shown in figure [ fig : posterior_c_opac ] , with the blue line showing the inference when nuisance parameters are included , and purple showing the results when they are neglected .",
    "there is a significant change in the posterior probability with a corresponding change in the inferred carbon opacity modifier .",
    "table [ tab : inferred_c_opacity ] shows the results of this inference for the different bayesian models we have discussed .",
    "these results are ( weakly ) sensitive to the choice of prior ; in cases where the priors are taken as centred on 1 , the inferred carbon opacity multiplier is never larger than @xmath45 .",
    ".the results of the inference of the carbon multiplier from measured values of the implosion velocity , radius and fraction of ablator remaining in nif convergent ablator shot n110625 .",
    "error bars are 68% confidence limits .",
    "inference is based on a database of 1024 post - shot hydra simulations , using the bayesian inference models described in the text .",
    "the inclusion of prior information and of the variation in capsule dimensions and chemical composition is shown to signficantly reduce the measured carbon opacity multiplier , and the error bar on the result . [ cols=\"^,^\",options=\"header \" , ]      analysis is used ( blue ) .",
    "variations in target properties cause a shift in the maximum likelihood estimate of the opacity multiplier , and a change in the shape of the distribution of values . ]",
    "the complexity of icf experiments , and of the hydrodynamic simulations used to analyse and design them , make it unfeasible to perform the simple grid parameter scans that have concerned us until now .",
    "the statistical framework does , however , allow more advance monte - carlo approaches to be applied , and these have seen great success in the analysis of other large experiments .",
    "the application to icf experiments will still require careful consideration , however , and in the following we will discuss the possible approaches that are available .",
    "the linear response model described above allows the inclusion of nuisance parameters as described above , however the dependance on parameters that are of experimental interest should be treated more accurately .",
    "there is an advantage to keeping as many simulation parameters as possible out of the linear response model ; as we have seen in the previous low dimensional analysis , inspection of the posterior as a function of the model parameters can provide valuable insight .",
    "it is not possible to include all parameters however , and so the linear response model will be essential in the implementation of the following advanced methods .",
    "the mcmc approach is a statstical method of generating a set of samples of parameter space such that the distribution of samples reflects a given , unknown , probability distribution @xcite .",
    "the method has been used extensively to probe posterior distributions with very large numbers of parameters ; the potential pitfall is that using hydra simulations to form the step probability in these models , even using the efficient routines applied here , presents a significant computational challenge .",
    "the feasability of the mcmc approach can be investigated using a surrogate model , that will approximately reproduce the multi - dimensional behaviour of hydra simulations . in this way",
    "the number of steps required can be found , before resorting to time - consuming hydra simulations .",
    "an example solution is shown in figure [ fig : mcmc_posterior ] , where we plot a histogram of mcmc samples from a run of 2000 steps ( initialised at the peak of the prior and with a 500 step ` burn in ' period ) .",
    "these simulations use the metropolis - hastings algorithm with a normally distributed jump probability to explore the posterior probability formed from the linear response likelihood and prior described in previous sections .",
    "the likelihood is approximated by interpolating in the simulation grid described previously , with very good results .",
    "it is well known @xcite that even when mcmc simulations poorly describe the multi - dimensional target distribution , low dimensional quantities are often well described .",
    "this is seen in our results where the mcmc average and standard deviation carbon opacity multiplier are @xmath46 ; for an mcmc run with 1000 ( post burn in ) samples , this value is @xmath47 which still shows good accuracy .",
    "the very small number of simulations required to give a good reproduction of the opacity multiplier is encouraging .",
    "it should be noted , however , that even though 2500 hydra simulations are easily acheivable using the parrallel control routines used here , mcmc simulations do not lend themselves to easy parrallelisation .",
    "the genetic algorithm approach described in the next section are more ameanable to the large scale simulations necessary here .",
    "a ga is a computational tool where a set of samples of parameter space are selected and iterated in order to find the extreme value of some merit function , or fitness .",
    "new samples are generated from the old using methods inspired by natural selection - those members that have a large fitness are preferentially selected , and bred together .",
    "random jitter is introduced to avoid local maxima in the global fitness , mimiking random mutation in the current population . in data analysis applications",
    "it is usual to use the inverse @xmath0 function as a fitness , and in this application genetic algorithms are a very robust tool for finding the best fit to data when the parameter space has a high dimension . in previous sections we noted that the usual @xmath0 function can be interpreted as the information in the posterior , and showed how this can be modified to include variations in nuisance parameters and prior information .",
    "these considerations allow the application of genetic algorithm techniques to our bayesian analysis .",
    "in figure [ fig : ga_meanc ] we plot the evolution of the mean carbon opacity and drive multipliers of a population of 100 parameter space samples as subsequent generations are generated .",
    "we use a simple ga , where half the population is carried over between generations and the entire population is allowed to mutate .",
    "the breeding population is chosen according to the inverse of the generalised @xmath0 discussed previously .",
    "the carbon opacity approaches the expected value of 1.10 quickly , a value that is quite robust as the number of population members ( and therefore hydra calculations ) is reduced . in the case",
    "considered here a full ga simulation would require less than 2000 hydra simulations , representing a modest computational problem .",
    "the genetic algorithm technique is very easily parrallelised since all members of the sample population are known at the start of each iteration .",
    "it has the disadvantage , however , that the converged result gives no information regarding the form of the posterior distribution and so it is difficult to provide confidence intervals for the inferred parameters , or the information entropy in the posterior .",
    "a simple exploration of of the space close to the maximum , in order to calculate the hessian matrix @xcite , would provide an efficient solution to the problem .",
    "we have introduced the bayesian method and developed the normal linear model to describe nuisance parameters in integrated high energy density experiments .",
    "this approach allows a modified bayesian @xmath0 function to be defined that efficiently includes prior information and nuisance parameters .",
    "this function can be easily applied in any data analysis or experimental design problem , and is particularly well suited to systems with a large number of nuisance parameters .",
    "the compact format provided by the modified covariance matrix means that once a sensitivity study has been performed for a given experimental design , the results can be encorporated in all subsequent data analyses in a simple and consistent manner .",
    "the expression of the likelihood in these terms also allows powerful bayesian and information - theoretic results to be used .",
    "these considerations have been applied to a nif convergent ablator experiment , where it has been shown that they lead to a significant change in the inferred values of the carbon opacity .",
    "it has also been shown that the use of computational methods to speed up analysis is very feasible .",
    "this capability , along with the bayesian aspects presented here , will allow the integrate analysis of entire experimental campaigns at the nif and to the staistical design of future experiments .",
    "the authors would like to thank robbie scott and john castor for help with hydra simulations , and vijay sonnad for stimulating comments ."
  ],
  "abstract_text": [
    "<S> we develop a bayesian inference method that allows the efficient determination of several interesting parameters from complicated high - energy - density experiments performed on the national ignition facility ( nif ) . </S>",
    "<S> the model is based on an exploration of phase space using the hydrodynamic code hydra . </S>",
    "<S> a linear model is used to describe the effect of nuisance parameters on the analysis , allowing an analytic likelihood to be derived that can be determined from a small number of hydra runs and then used in existing advanced statistical analysis methods . </S>",
    "<S> this approach is applied to a recent experiment in order to determine the carbon opacity and x - ray drive ; it is found that the inclusion of prior expert knowledge and fluctuations in capsule dimensions and chemical composition significantly improve the agreement between experiment and theoretical opacity calculations . </S>",
    "<S> a parameterisation of hydra results is used to test the application of both markov chain monte carlo ( mcmc ) and genetic algorithm ( ga ) techniques to explore the posterior . </S>",
    "<S> these approaches have distinct advantages and we show that both can allow the efficient analysis of high energy density experiments .    inertial confinement fusion , hydrodynamic simulation , bayesian inference , plasma opacity , genetic algorithm , markov chain monte carlo </S>"
  ]
}