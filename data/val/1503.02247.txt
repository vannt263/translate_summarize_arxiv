{
  "article_text": [
    "analytical estimates for particle dynamics in electric and magnetic rings with and without focusing have been given in a variety of papers and notes .",
    "we have used these high precision estimates to provide benchmarks to test the accuracy of precision particle tracking programs .",
    "the term `` focusing '' in this paper is used to denote `` weak vertical focusing '' unless otherwise indicated .",
    "horizontal focusing is defined by the vertical focusing plus the geometry of the ring , always conforming with maxwell s equations .",
    "these benchmarks include :    * pitch correction@xcite to particle precession frequency in a uniform b - field with and without focusing . * vertical oscillations and energy oscillations in a uniform b - field with no focusing , electric focusing , and magnetic focusing . * radial and vertical oscillations and energy oscillations in an all - electric ring with and without weak focusing . * synchrotron oscillations and momentum storage with a radio frequency cavity ( rf ) in a uniform b - field . * an edm signal and systematic error with an rf wien filter in a magnetic ring .    in the analytical estimates that follow",
    ", we define @xmath0 as the lorentz factor of the design particle in the ring .",
    "the vertical pitch angle @xmath1 of a particle is defined such that @xmath2 where @xmath3 in cylindrical coordinates .",
    "the field focusing index is @xmath4 , with @xmath5 a number with range @xmath6 .",
    "these analytical estimates provide a means of benchmarking particle tracking programs . a precision tracking method that successfully passes all benchmarks",
    "can provide a baseline to benchmark faster programs .",
    "we study the developed benchmarks in the context of runge - kutta / predictor - corrector integration .",
    "the validity of the developed benchmarks extends to any precision tracking program .",
    "precision experiments such as the muon ( @xmath7 ) and storage ring electric dipole moment ( edm ) experiments@xcite require measurements of sub - part per million ( ppm ) accuracy . in the case of a proton or deuteron storage ring edm experiment , a tracking program of extraordinary precision",
    "is required to estimate the spin coherence time of the particle distribution and various lattice parameters , as well as to estimate the values of systematic errors associated with the experiment .",
    "many commonly used beam and spin dynamics programs ignore , or erroneously account for , second and higher - order effects .",
    "tracking in an electric storage ring poses the additional challenge of conforming with total - energy conservation while accounting for higher - order effects .    numerical integration with a sufficiently small step size allowed to run for",
    "a sufficiently long time may reproduce the analytical result with high accuracy .",
    "a tracking program to be used for estimates and investigations in precision experiments must be optimized to be as fast and accurate as possible .",
    "this calls for a well - tested and robust procedure to benchmark the accuracy of tracking programs in situations relevant to the experiments .    we summarize and derive analytical solutions to the equations of motion of a particle in various electric and magnetic rings .",
    "in several cases , comparison of the analytical estimate with precision tracking results identified discrepancies and indicated the need to improve the estimates . in this way",
    "it was determined that the total correction due to vertical particle oscillations , the so - called pitch effect , can be significantly reduced@xcite .",
    "these analytical estimates provide individual benchmarks for tracking programs .",
    "a program well - benchmarked against these estimates would provide additional , more flexible means to benchmark faster programs in different conditions .",
    "we benchmarked a program based on runge - kutta / predictor - corrector method@xcite against the developed analytical estimates .",
    "runge - kutta / predictor - corrector integration should reproduce the analytical estimates to sub - ppm accuracy on a time scale on the order of hours , in order to be a feasible candidate for benchmarking faster programs .",
    "together , the analytical estimates and a program based on runge - kutta / predictor - corrector integration provide a powerful tool for benchmarking precision tracking programs for muon @xmath8 , storage ring edm , and other precision physics experiments requiring high precision beam and spin dynamics simulation .",
    "for a particle of mass @xmath9 and charge @xmath10 , there are two differential equations that govern particle and spin dynamics . for particle velocity @xmath11 and rest spin @xmath12 in external fields , the equations are@xcite : @xmath13,\\ ] ] and the t - bmt equation , with an anomalous magnetic moment @xmath14 of the particle : @xmath15.\\end{aligned}\\ ] ]    the predictor - corrector integration was used with a step size of @xmath16ps to numerically solve the two differential equations with the corresponding initial conditions .",
    "although the method is relatively slow , it is very simple and accurate .",
    "this method uses the runge - kutta method to start the integration process and we refer to it as runge - kutta / predictor - corrector in this document .",
    "a magnetic ring consists of a uniform magnetic field @xmath17 , taken to be in the vertical direction .",
    "the correction @xmath18 to the precession frequency due to a vertical pitch is defined by @xmath19 , where @xmath20 is the ( @xmath7 ) frequency@xcite for a particle with anomalous magnetic moment @xmath14 .",
    "the predicted correction is@xcite : @xmath21 with @xmath22 , where @xmath23 is the vertical ( pitch ) oscillation frequency .      when there is no focusing or when @xmath24 , the correction from equation [ mrnf1 ] becomes :    @xmath25 where for linear oscillations , @xmath26 , where @xmath27 is the maximum pitch angle of the particle trajectory .",
    "for a particle with @xmath28 and a constant 1.0mrad vertical pitch as shown in figure [ pitch1 ] , the simulated correction to the ( @xmath7 ) precession frequency of @xmath29ppm is in very good agreement with the analytically predicted value of @xmath30ppm using equation [ mrnf2 ] .",
    "[ .65]the particle path in cartesian coordinates in a uniform b - field with pitch angle @xmath31mrad , for a ring with a 5 m radius.,title=\"fig : \" ]    checking over several values of @xmath1 confirms that the analytic expression and the pitch correction in the tracking simulation agree for small @xmath1 , as expected .",
    "when there is magnetic focusing and when @xmath32 , the correction from equation  [ mrnf1 ] becomes :    @xmath33    the analytical estimate@xcite for the average particle radial deviation from the ideal orbit with radius @xmath34 , with weak magnetic focusing index @xmath4 , takes the form : @xmath35 for a vertical pitch frequency significantly greater than the ( @xmath7 ) precession frequency of the particle , where @xmath36 is the momentum compaction factor",
    ".    equation [ mrmf1 ] predicts an average radial deviation @xmath37 of @xmath38 using @xmath39 1mrad and a field index @xmath40 , consistent with the tracking results shown in figure [ drmrmf ] to sub - part per billion ( ppb ) level .",
    "the dependence of @xmath41 on the field index is shown to hold over a range of @xmath4 values in figure [ bfdr ] .",
    "[ .29]the particle deviation from the ideal radial position over time , modulo 50@xmath42s .",
    "the simulations used a maximum pitch angle of @xmath43mrad and magnetic focusing with field index @xmath40.,title=\"fig : \" ]    [ 1.25]the average @xmath37 versus the field focusing index @xmath4 .",
    "the solid line represents the predicted values while the points are the results of tracking .",
    "the simulation used a maximum pitch angle of @xmath44mrad.,title=\"fig : \" ]    in a continuous storage ring with weak focusing , field strength @xmath45 , and ring radius @xmath34 , the vertical and horizontal magnetic field components around the ideal trajectory can be expressed to second - order in the vertical position @xmath46 as : @xmath47@xmath48 where the nonlinearity arises from the application of maxwell s equations in cylindrical coordinates .",
    "the horizontal and vertical tunes are given by @xmath49 and @xmath50 respectively .",
    "we make use of the relations@xcite from equation [ mrmf1 ] : @xmath51 and @xmath52 , where @xmath53 is the maximum vertical excursion . from this",
    "we see that : @xmath54    by considering the time - averaged relative b - field change , calling @xmath55 the modification due to the different b - field encountered by the particle , we find that the correction @xmath56 to the ( @xmath7 ) precession frequency in a magnetic storage ring with weak focusing , i.e. @xmath57 , is given by the expression : @xmath58 where we see that several terms of the inhomogeneous b - field correction and the correction in equation [ mrnf3 ] cancel , leaving a small correction .",
    "the necessity of including the second - order inhomogeneous magnetic field contributions was overlooked by previous authors .",
    "investigations with precision tracking identified the discrepancy and motivated the improvement of the analytical estimate .",
    "this holds for a vertical pitch frequency much greater than the ( @xmath7 ) precession frequency of the particle , which for a weak focusing ring means @xmath59 .",
    "equation [ mrmf2 ] implies that the pitch effect can , in principle , be made to vanish for @xmath60 , but the condition @xmath59 makes it rather difficult to achieve . to test the tracking program we introduced a particle with 10 times the muon mass , with same @xmath14 value as the muon , stored in a ring radius of 7.112 m .",
    "the program indeed showed that the pitch correction vanishes with an uncertainty at the part per billion ( ppb ) level when @xmath61 was used .    for realistic muon parameters ,",
    "the observed ( @xmath7 ) frequency is off from its correct value by + 0.109ppm , for a vertical maximum pitch angle @xmath62mrad , and @xmath63 , consistent with the offset shown in figure [ pitch2a ] to sub - ppb level .",
    "[ .3]the pitch correction to the ( @xmath7 ) frequency with angle @xmath44mrad , @xmath64 , and @xmath63 , is 0.109ppm , consistent with equation [ mrmf2 ] to sub - ppb level .",
    ", title=\"fig : \" ]    a resonance of the pitch effect correction occurs when the vertical pitch frequency @xmath65 is equal to the ( @xmath7 ) precession of the stored particles @xmath20 .",
    "the correction @xmath18 approaches equation [ mrnf2 ] for @xmath66 and equation [ mrnf3 ] for @xmath67 .",
    "the full range of pitch corrections @xmath18 over a range of index values is shown in figure [ pitch2 ] . when all the fields are taken properly into account , as shown above ,",
    "the tracking results reproduce the same curve to sub - ppb level for @xmath68 .",
    "[ 0.68]parameter @xmath18 from equation [ mrnf1 ] for the pitch correction to the ( @xmath7 ) frequency over a range of @xmath4 values using @xmath69mrad and @xmath70 .",
    "a resonance occurs when @xmath71 , at @xmath72 , as expected .",
    ", title=\"fig : \" ]    a comparison of the frequency shift predicted by equation [ mrmf2 ] and the results from tracking is given in table [ mrmft1 ] .",
    "the analytical estimates of the pitch correction and the tracking results are in very good agreement , better than ppb level .",
    "this level of precision is adequate for the muon @xmath7 experiments currently underway  @xcite , both aiming for better than 0.1ppm total systematic error .",
    ".comparison of the frequency shift estimated using equation [ mrmf2 ] and the tracking results .",
    "the tracking results assume a muon with @xmath64 , stored in a magnetic ring with magnetic focusing and a radius @xmath73 m .",
    "the vertical angle used is @xmath74mrad .",
    "the observed @xmath7 frequency is shifted higher by the small factors given below depending on the @xmath4-value used . [ cols=\"^,^,^ \" , ]     [ prot ]    the wien filter provides another benchmark for testing the accuracy of the analytical estimates and the runge - kutta / predictor - corrector tracking method .",
    "we again see very good agreement between the analytically predicted values and those calculated by tracking .",
    "we have determined an array of analytical estimates for benchmarking tracking programs for precision storage ring experiments .",
    "the benchmarks form a robust test for electric and magnetic rings , with and without focusing , as well as rf cavities and wien filters .",
    "the inclusion of a high - order contribution to the weak magnetic focusing estimate resulted in the discovery of a method to reduce or eliminate the pitch effect , which was overlooked by other authors . together",
    "these analytical estimates give a powerful tool to benchmark programs for studying particle motion and spin dynamics in a variety of storage ring configurations .",
    "the runge - kutta / predictor - corrector integration appears to be an accurate , albeit slow , tool for precision tracking .",
    "it has passed all the benchmarks that it was tested against , often to the part per billion level .",
    "the tracking program was able to successfully simulate particle dynamics in electric and magnetic rings with and without weak focusing , in agreement with analytical estimation .",
    "consequently , we conclude that the runge - kutta / predictor - corrector method can be used to benchmark faster tracking programs .",
    "other tracking programs are also capable of providing high accuracy at least under certain conditions , e.g. ,  @xcite .",
    "what we have presented here is an array of high precision analytical estimates that can be used to benchmark candidate simulation programs .",
    "we would like to thank the department of energy and brookhaven national laboratory for their continued support of the high school and supplemental undergraduate research programs .",
    "we especially thank the storage ring edm collaboration .",
    "doe partially supported this project under bnl contract no .",
    "de - sc0012704 .",
    "ibs - korea partially supported this project under system code ibs - r017-d1 - 2014-a00 .",
    "9 j.h . field and g.",
    "fiorentini , `` corrections to the @xmath7 frequency in weak focusing storage devices due to betatron oscillations . ''",
    "_ il nuovo cimento _ 21a ( 1974 ) 297 - 328 .",
    "morse , y.f .",
    "orlov , and y.k .",
    "semertzidis , `` rf wien filter in an electric dipole moment storage ring : the ` partially frozen spin ' effect . ''",
    "_ physical review special topics - accelerators and beams _ 16 ( 2013 ) 114001 .",
    "s.hacimerolu and y.k .",
    "`` results of precision particle simulations in an all - electric ring lattice using fourth - order runge - kutta integration . ''",
    "_ nuclear instruments and methods in physics research section a _ 743 ( 2014 ) 96 - 102 .",
    "mane , `` comment on ` results of precision particle simulations in an all - electric ring lattice using fourth - order runge - kutta integration'.''__nuclear instruments and methods in physics research a _ _ 769 ( 2015 ) : 26 - 31 ."
  ],
  "abstract_text": [
    "<S> a set of analytical benchmarks for tracking programs is required for precision storage ring experiments . to determine the accuracy of precision tracking programs in electric and magnetic rings , a variety of analytical estimates of particle and spin dynamics in the rings </S>",
    "<S> were developed and compared to the numerical results of tracking simulations . </S>",
    "<S> initial discrepancies in the comparisons indicated the need for improvement of several of the analytical estimates . as an example , we found that the fourth - order runge - kutta / predictor - corrector method was slow but accurate , and that it passed all the benchmarks it was tested against , often to the sub - part per billion level . </S>",
    "<S> thus , high precision analytical estimates and tracking programs based on fourth - order runge - kutta / predictor - corrector integration can be used to benchmark faster tracking programs for accuracy .    </S>",
    "<S> analytical benchmarking , precision particle tracking , electric and magnetic storage rings , runge - kutta , predictor - corrector </S>"
  ]
}