{
  "article_text": [
    "a reliable treatment of radiative processes in cosmological hydrodynamical simulations is essential to understanding the reheating and reionization of the intergalactic medium ( igm ) . besides enabling a detailed modeling of the structure and evolution of the ly @xmath1 forest , which is now thought to originate from density fluctuations in the low - density igm ( e.g. cen et al .",
    "1994 ; zhang , anninos & norman 1995 ; hernquist et al .",
    "1996 ) , the coupling between ambient radiation fields and baryons is essential for interpreting the nature of the first generation of sources in the universe . until recently ,",
    "radiative transfer effects have generally been treated by applying local self - shielding corrections to an optically thin medium ( e.g. katz et al .",
    "1996 ; gnedin & ostriker 1997 ) with only an approximate treatment of the reprocessing of the radiation by the igm ( e.g. haardt & madau 1996 ) .",
    "furthermore , at early times when the igm is still optically thick , radiation fields become increasingly inhomogeneous and anisotropic ( reimers et al .",
    "1997 ) , and the inclusion of radiative transfer effects becomes essential if one is to properly track their evolution .",
    "in fact , 3d radiative transfer calculations in an expanding universe reveal that the propagation of ionization fronts becomes quite complicated as the fronts expand from sources and penetrate into voids before breaking through dense filamentary structures ( abel , norman & madau 1999 ; hereafter anm ) .    in this paper",
    ", we describe an approach designed to model cosmological reionization by combining 3d radiative transfer calculations with outputs from hydrodynamical simulations .",
    "our calculation of radiative transfer around point sources involves the use of an algorithm based on a ray casting scheme similar to the one described in anm , implemented now in an evolving cosmological density field .",
    "our method also includes a treatment of the `` diffuse '' component of the radiation field which is thought to become significant once most of the volume is ionized . as a first application , we use our method to simulate how quasars reionize he in a cosmological density field .",
    "in general , a description of the evolution of ionization zones around cosmological sources requires a full solution to the radiative transfer equation .",
    "such a solution yields everywhere the monochromatic specific intensity of the radiation field in an expanding universe : @xmath2 , where @xmath3 is a unit vector along the direction of propagation of a ray with frequency @xmath4 .",
    "presently , it is computationally impractical to acquire a complete , multi - dimensional solution for @xmath5 at the high resolution required for cosmological simulations .",
    "however , using a sequence of well - motivated approximations , anm have shown that it is possible to reduce the dimensionality of the problem such that the calculations become feasible .",
    "namely , the transfer equation is reduced to a level where ionization rates can be computed on a cartesian grid using a ray casting scheme .",
    "the ionization state of a static density field can then be evolved through a series of time slices , where rates are computed and neutral fractions are updated .",
    "although this method has been proven to be very successful for computing the ionized regions surrounding multiple point sources , it is still not a viable approach for calculating the systematic reionization of an ionic species in a sizable volume containing a large number of sources , which would require time - consuming ray - casting calculations at each step .",
    "our approach relies on a new algorithm which employs a simple jump condition to compute all radiative ionizations from a given source in a single step .",
    "this removes the need to repeatedly re - cast rays and calculate rates at every time step , thereby greatly speeding up the process .",
    "moreover , our algorithm includes an approximate treatment of the diffuse component of the radiation field .    as in anm",
    ", we employ straightforward approximations to simplify the calculations .",
    "first , our radiative transfer calculations are done on a uniform cartesian grid whose scale @xmath6 will always be much smaller than the horizon , @xmath7 , where @xmath8 is the speed of light and @xmath9 is the time dependent hubble constant .",
    "this mitigates the need to include doppler shifting of frequencies in line transfer calculations .",
    "additionally , if the light crossing time @xmath10 is much shorter than the ionization timescale , the time dependence of the intensities drop out as well . in the volumes we simulate",
    "this will certainly be true and so we also make this approximation .",
    "( note that this latter assumption will inevitably break down near a source ; however , this problem can be remedied as shown below . )",
    "next , we assume that the density field will experience negligible cosmological evolution during the lifetime of single source .",
    "this requires us to consider only short - lived sources ( at most a few @xmath11 years ) .",
    "this assumption allows us to perform all our radiative calculations during a source s lifetime in a static density field , greatly reducing the complexity of the algorithm . finally , in our most brazen assumption",
    ", we ignore thermal feedback into the gas from radiative ionization , enabling us to decouple our calculation of the radiation field from the hydrodynamical evolution of the gas .",
    "this allows us to use existing outputs from cosmological simulations to describe the evolving density field during the reionization process . in reality",
    ", of course , ionization introduces extra heat into the medium , and as i - fronts move from small scales to large scales , there is a corresponding transfer of power from small to large scales through nonlinear evolution .",
    "this effect is somewhat accounted for in the underlying cosmological simulation used in this paper which includes a uniform ionizing background capable of heating the gas .",
    "however , one also expects extra heating due to radiative transfer effects during the reionization process , and such uniform backgrounds can not reproduce the observed increase in gas temperatures from the extra heating ( abel & haehnelt 1999 ) . as a result",
    "we expect systematic errors in our solutions ; however , the main purpose of this paper is to introduce a method which can describe the general morphological evolution of the reionization process on large scales , which is fairly insensitive to such systematic errors .",
    "in particular , recombination rates depend weakly on temperature and hence a proper accounting of photons is possible even if the temperatures are not computed perfectly .",
    "the approach we take is to approximately describe the evolution of the ionization state of the gas in a cosmological volume by iteratively calculating the net effect of ionizing sources at regularly spaced time intervals .",
    "density fields as well as information regarding sources will be specified from outputs at desired redshifts from a cosmological simulation .",
    "the exact prescription for deriving this information will be described in  4 , where we discuss our first application .    for simplicity ,",
    "all sources are taken to have identical lifetimes .",
    "since we assume there will be a negligible amount of cosmological evolution during a source lifetime , we compute the ionization state of the gas in a static density field corresponding to the time at which a source turns on . to simplify bookkeeping , sources that would be active during a particular time interval",
    "are assumed to all turn on at the same redshift .",
    "thus , sources are binned together in time , with the binsize being exactly one source lifetime . beginning with the earliest redshift bin ,",
    "the ionizing effects from member sources are determined and ionization fractions are updated . during the calculations , the number of photons escaping into a diffuse background component",
    "is tracked self - consistently .",
    "the ionizing effect from this background component is accounted for once all point source calculations in the given time bin are completed .",
    "if the source lifetime is shorter than the time between successive outputs of the density field , we use an interpolation scheme to update the density field for the next bin of sources from the outputs . in this way ,",
    "the evolution of the box is advanced by one source lifetime . in  3.1 and  3.2",
    "we describe the ray casting schemes used to carry out the ionization calculations for point sources and the diffuse background component respectively .",
    "then in  3.3 , we describe how the information derived from the ray casting schemes is used to set the ionization fractions in affected cells .      in figure 1",
    ", we give a block diagram for our algorithm , describing how ionization from sources is calculated . at a given redshift @xmath12",
    ", we have a list of sources which are destined to switch on . for each source",
    ", we gather information regarding its location ( @xmath13 ) and the rate at which it emits ionizing photons for the species in question , @xmath14 [ @xmath15 . a set of radial rays distributed quasi - uniformly in solid angle is constructed for the source .",
    "these rays will isotropically distribute ionizing photons from the source to the intergalactic medium represented by the grid .",
    "a sufficient number of rays is generated so that every cell at large distances from the source is crossed by at least one ray .",
    "each ray is `` cast '' into ray segments according to how it intersects a cell boundary .",
    "the total number of photoionizations is tracked along the ray and casting is halted as soon as the total number of ionizing photons assigned to the ray matches the cumulative number of absorptions ( ionizations ) . during the casting procedure , cells through which rays successfully traverse are marked as _",
    "ionized _ and their indices are stored .",
    "after all rays from the source have been cast , ionization fractions are computed for all cells marked _",
    "ionized _ before casting starts for the next source .      in this section",
    "we briefly describe the prescription for choosing the angles that define the rays .",
    "our first step is to choose at least @xmath16 rays so that at least one ray is cast into each cell of side - length @xmath17 at the equator of a sphere with radius @xmath18 . to determine the required number of rays , we store the maximum radius , @xmath19 , needed to capture the furthest point of the ionization front ( i - front ) .",
    "we find that setting @xmath20 , where @xmath6 is the length of the simulation box , gives us a safe number of rays to properly describe the i - front within a periodic box where rays can wrap around the box .",
    "of course , in the completely optically thin limit , ray path lengths may exceed @xmath19 , but as we discuss below where we describe our prescription for how rays contribute to the background radiation field , we turn off periodic boundary conditions for ray - casting long before the box has become optically thin , thereby ensuring that path lengths remain less than @xmath19 .    to describe the rays we use spherical coordinates @xmath21 , @xmath22 where a discrete set of angles @xmath23 is used to define the directional component of the rays which divide a sphere in segments of similar areas .",
    "the discrete values of @xmath24 are given by @xmath25 near the polar regions fewer azimuthal angles are required , @xmath26 with the azimuthal angles chosen to be , @xmath27 each ray will thus describe an area ( in units of @xmath28 ) , @xmath29 with the adjacent angles @xmath30 given by , @xmath31 each ray is then assigned a photoionization rate proportional to the area it describes on the sphere : @xmath32 .",
    "this implementation allows for a non - isotropic radiation field ( such as bi - polar beaming ) by , for example , restricting the angles along which rays are cast . in such cases ,",
    "the photoionization rate assigned to each ray will be @xmath33 , where @xmath34 is the total solid angle into which the radiation is beamed .",
    "once angles have been chosen , rays are cast from the source into the grid .",
    "the basic idea is to compute , for a given ray , the indices of the grid cells it traverses , as well as the path lengths rays travel within each cell . for a uniform , isotropic cartesian grid such as the one we will be using in our analysis ,",
    "ray casting is straightforward and we employ an implementation which is described in detail in  3.2 of anm .    in general",
    ", casting for a particular ray is terminated once the total number of ionizing photons assigned to it equals the total number of photoionizations that have occurred along its path through the grid .",
    "this process is described in detail in the following section .",
    "for the purpose of studying the systematic reionization of a particular ionic species , we shall primarily be concerned with the net ionization effect of each source",
    ". in particular , we shall be interested in calculating only the resultant i - front from all the photons believed to have been released from the source during its lifetime and we will be less concerned with the exact time dependent nature of the expanding front . furthermore , rather than describe the ionization structure around a source when it has just turned off and when there remains a substantial fraction of unabsorbed streaming photons , we opt to allow each ray to first completely exhaust all its ionizing photons before calculating the resulting structure .",
    "consequently , we will be unable to describe the i - front as it was _ exactly _ at @xmath12 when the source turned off , but will rather focus on how it appeared once all photons were absorbed .",
    "this allows us to conserve all the photons emitted from the source .",
    "the elapsed time between when the source turned off and when all photons are absorbed will depend on the intensity of the source , its lifetime , and the surrounding density field and corresponding ionization state .",
    "in general , we find that if the gas surrounding a source is optically thick to the ionizing radiation , then the difference in time is short compared to the time span over the reionization process occurs . in the case of a source turning on in a mostly ionized region ,",
    "the difference can be a significant fraction of the total simulation time , but in this case most rays reach the edges of the box without causing dramatic changes to the already optically thin medium . since we will have a prescription for converting such unobstructed rays into a background radiation field , this discrepancy will not significantly affect our statistical study of the reionization process .    to calculate where along its path a ray exhausts its photon supply ,",
    "we simply integrate along its path length during the casting process until the number of photoionizations of the species in question ( @xmath35 ) surpasses the number of ionizing photons ( @xmath36 ) carried by the ray minus the total number of recombinations ( @xmath37 ) occurring along its path during the line transfer .",
    "more explicitly , for each ray @xmath38 , casting is terminated as soon as the following inequality is satisfied , @xmath39 where @xmath40 is the source lifetime .",
    "this condition is checked at the edge of each grid cell encountered by the ray .    the number of absorbing ions encountered by a _",
    "ray - cone _ at a distance @xmath18 from the source can be written as : @xmath41 where @xmath42 is the proper number density of the species in question at redshift @xmath43 and @xmath44 is the area described by the ray at a distance @xmath18 .",
    "we can easily calculate @xmath35 numerically at each intervening cell by summing over all the ray segments @xmath45 in intervening cells , @xmath46,\\ ] ] where the radial length from the source to each cell crossing is given by @xmath47 ( see anm ",
    "proper number densities are evaluated at each intervening cell @xmath48 .",
    "we now turn to the task of calculating @xmath37 , the cumulative number of recombinations along the path . for our analysis here , we shall assume that each cell has a corresponding gas temperature , @xmath49 , which will be used to calculate recombination coefficients ( @xmath50 ) . in calculating the cumulative number of recombinations along the path",
    ", we need to take into account the fact that there will be recombinations from the n=@xmath51 @xmath52 n=@xmath53 transition which release extra ionizing photons that need to be included in the radiative transfer calculations . here",
    "we make the assumption that the majority of these recombination photons propagate unimpeded to the location of the i - front .",
    "this allows us to use our existing radial rays to describe the propagation of these extra photons .",
    "we therefore only use case b recombination coefficients ( which exclude the n=@xmath51 @xmath52 n=@xmath53 transition ) in calculating @xmath37 . in light of equation",
    "( 10 ) , one can see that this will allow the rays to penetrate further into the neutral medium due to the extra emissivity implicitly included in @xmath54 as opposed to @xmath55 .",
    "our approximate treatment for propagating this extra diffuse component of the ionizing flux should not cause any substantial departure from the true solution , especially since we are dealing with r type i - fronts where the rate of recombinations is much less than the rate of ionizing photons released from the source .",
    "it is important to point out , however , that the calculations associated with resultant ionization fractions ( see  3.3 ) will involve the use of case a recombination coefficients since there we will require an accounting of _ all _ recombination transitions .",
    "the expression for @xmath37 in our ray casting scheme can then be written as , @xmath56\\ t(l , t_c),\\ ] ] where @xmath57 and @xmath58 are the proper number densities of ionized atoms and electrons respectively and @xmath59 represents the clumping factor of the gas inside the cell . for the purposes of calculating recombinations , we shall assume that all intervening cells have been highly ionized ( @xmath60 where @xmath61 is the ionization fraction ) thereby fixing the values of @xmath57 and @xmath58 .",
    "the function @xmath62 represents the time elapsed in the cone segment residing in cell @xmath48 after it was ionized when a total time of @xmath63 has passed since the source was turned on .",
    "we track @xmath63 during the casting by summing over the crossing times through each cell .",
    "the crossing times , @xmath64 , are calculated by integrating the jump condition describing the propagation of the i - front radius @xmath65 in a static density field ( abel 2000 ) , @xmath66 the integral @xmath67 for a ray segment crossing a cell can be expressed numerically as , @xmath68}{\\frac{\\dot{n}_{ph}}{4\\pi}-\\sum_{l^{\\prime}=0}^{l}\\frac{1}{3 } c_f^{l^{\\prime } } n_e^{l^{\\prime } } n_+^{l^{\\prime } } \\alpha_b [ s(l^{\\prime})^3-s(l^{\\prime}-1)^3]},\\ ] ] where the summation in the denominator accounts for the recombination rate along the ray . in the case where @xmath69 is less than the light crossing time across the pathlength through the cell , @xmath70 , we simply reset @xmath69 to the light crossing time .",
    "this allows us to avoid the unphysical effect of having faster than light i - fronts near the source . in any case",
    ", arrival times to each cell can be calculated by summing over individual crossing times .",
    "the total elapsed time always includes a summation over all the ray segments leading up to the edge of the ray ( defined as ray segment @xmath71 ) during the casting , such that , @xmath72 figure 2 compares the results for arrival times computed using this technique on a @xmath73 grid against what is expected analytically in the case of a spherically expanding i - front ( for hydrogen ) in a homogeneous density field . the radius and the spherical geometry",
    "are perfectly recovered within the accuracy of the spatial resolution .",
    "the specific parameters used in this test were , @xmath74 , @xmath75 , cell - size @xmath76 , and a constant case b recombination rate for h @xmath52 hi reactions of @xmath77 was selected .",
    "finally we can write down our expression for the elapsed time in each cone segment @xmath62 in terms of the total elapsed time @xmath78 at the edge of the ray at @xmath71 , @xmath79 where @xmath63 and @xmath71 are updated at each new crossing .",
    "it is important to point out that @xmath63 can exceed a source lifetime before all photons have been absorbed from a given source . regardless of this fact",
    ", our interpolation scheme evolves the radiation field by exactly one source lifetime at each step . in an effort to adhere to this global time",
    ", we shall restrict the maximum time available for recombinations in any cone segment to a single source lifetime .",
    "in particular , in the case where @xmath80 , we count the number of recombinations starting from the edge of the ray ( ray segment @xmath71 ) and work our way backwards along the ray until the accumulated crossing times from the segments add up to a single source lifetime . in this case , the summation in the denominator of ( 15 ) will not start from @xmath81 , but rather @xmath82 , where @xmath83 designates the ray segment marking the accumulation of a source lifetime s worth of arrival times from segments spanning backwards from the current location of the i - front .",
    "similarly , the summation in ( 13 ) will start from @xmath83 resulting in an @xmath37 which excludes recombinations from segments very near the source .",
    "again , we do not anticipate that this will greatly alter the global statistical properties of the reionization process . as stated earlier",
    ", we find that during early times when most of the medium is optically thick , the discrepancy between @xmath63 and @xmath40 is negligibly small . in the optically thin case ,",
    "photons from the source will inevitably reach the boundaries of the box and become part of the diffuse background , where it is fair to approximate a single source lifetime s worth of recombinations for such rays .",
    "our treatment will thus suffer when only a fraction of the medium in the box is ionized , in which case @xmath63 is a few times larger than @xmath64 and only some of the rays reach the boundaries .",
    "however , due to the rather rapid onset of ionization overlap after just a few sources have been active , the probability for many sources to turn on in a partially ionized box is small .",
    "as more sources turn on and progressively ionize the volume , there is an increased likelihood that rays of ionizing radiation will loop continuously through the box without encountering neutral pockets of gas . in reality , this radiation becomes part of the diffuse background . to simulate this background",
    "we adopt a simple prescription for converting such perpetual rays into a uniform background which is cast evenly from each side of the box .",
    "our first step is to choose a criterion to determine when source rays become part of the background .",
    "here we make the simplifying assumption that the intensity of the background is correlated with the number of rays which reach the boundaries of the box once the entire volume has surpassed a certain level of ionization .",
    "in particular , once this global level of ionization has been reached , we turn off the periodic boundary conditions for the rays , strip the remaining photons from each exiting ray reaching the boundary and add them to a photon reservoir describing the background .",
    "the level of ionization when the background receives these photons should be chosen such that it reflects a time during the reionization process when a majority of the rays are able to reach the boundaries of the box unobstructed .",
    "although this may seem somewhat arbitrary , the rapid onset of the overlap epoch ensures that overall statistical properties of the reionization process remain insensitive to this choice . in this paper",
    ", we find that a reasonable choice is to turn on the background only after more than @xmath84 of the volume has been ionized .",
    "typically , cosmological simulations treat diffuse radiation fields as being uniform so that the intensity of the radiation is constant everywhere .",
    "although this is a good approximation in the limit when the entire box is optically thin , it can fail to reproduce the natural way in which pockets of neutral gas are ionized from the outside in . since in our simulations the background can gain in intensity while the volume is still partially neutral",
    ", we adopt a geometric scheme for casting background rays which can describe the ionization of pockets of neutral gas while retaining an isotropic nature .",
    "the scheme we choose has the geometric property of casting parallel rays inwards from each face of the box .",
    "in particular , one ray from each cell face is cast perpendicularly from its corresponding box face .",
    "thus for a box with a resolution of @xmath85 cells in each dimension , the number of background rays generated at each step is @xmath86 .",
    "in essence , the background can be thought of as being comprised of six distinct _ planar _ sources .      after the criterion for allowing rays to contribute to the background has been satisfied , the number of _ escaping _ photons is recorded during each redshift bin when sources are turning on .",
    "this is then added to a global variable , @xmath87 , representing the total number of photons available to the background .",
    "@xmath87 is allowed to change as the background exhausts its photon supply or gains more photons from sources at each step . additionally , to account for the redshifting of background photons below the ionization threshold frequency @xmath88 , at each redshift step",
    "@xmath12 the new number of ionizing photons present in the diffuse background is adjusted according to : @xmath89 where @xmath90 is the spectral profile of the specific intensity of the background with @xmath91 . assuming the sources responsible for the diffuse background are all described by the same power - law spectral index @xmath1 beyond @xmath88 and that there is negligible reprocessing of this radiation by the igm , equation ( 18 ) reduces to @xmath92    ionizations from the background",
    "are computed by assigning to each background ray @xmath93 ionizing photons and tracking how far it can penetrate into the volume .",
    "this is accomplished by following the same prescription for tracking source rays only now the geometry is much simpler . in particular , the number of absorbing atoms one background ray will intercept during its course through @xmath45 cells will simply be , @xmath94 where @xmath95 is the cell volume .",
    "similarly , the number of recombinations along the same path will be given by , @xmath96 where @xmath62 now represents the elapsed time spent in cell @xmath48 when a total time of @xmath63 has passed since the ray was cast from the edge of the box .",
    "the crossing times implicit in @xmath63 for background rays are given by , @xmath97 where the term @xmath98 represents the rate of ionizing photons streaming along the background ray at each time step ( @xmath64 ) .",
    "within each redshift bin , ionization fractions for the entire grid are updated after each source has been handled , with point sources always preceding plane sources ( the latter being the six faces comprising the background ) . to accomplish this in a self - consistent manner , we will need to introduce a set of variables for each cell .",
    "these variables will store various parameters needed to calculate the cumulative effects from all sources in a given redshift bin .",
    "we start by describing the role of the boolean variable @xmath99 , which is used to distinguish whether a particular cell has been ionized by a given source . at the start of the ray casting calculation for a source ,",
    "all cells in the grid are initialized with @xmath100 . during the casting , if a ray successfully traverses a given cell without exhausting its photon supply ( eq .",
    "10 ) , then it is flagged as an _",
    "ionized _ cell via the assignment @xmath101 .",
    "if the ray responsible for flagging the cell originates from a point source then the proper distance from the source to the cell is recorded in the variable @xmath102 , which is used to calculate the photoionization rate .",
    "after ray casting calculations are completed for each source , only marked cells will have their ionization fractions updated .    in a given redshift bin where multiple sources are due to switch on",
    ", we shall need to guard against the possibility of overestimating the number of recombinations in a cell which is affected by multiple sources .",
    "that is , we will restrict the number of recombinations allowed in each cell through which rays from different sources pass .",
    "we achieve this by allowing recombinations to occur only along rays that pass through cells which have not been affected by sources other than the one in question .",
    "we thus introduce for each cell a new integer variable @xmath103 , which will store the i d number of that source whose rays first penetrate it . for a ray to suffer recombinations within a given cell therefore requires that @xmath103 be equal to either the source i d , or to zero ( the cell is virgin ) .",
    "the recorded values are kept in memory until the last source in a given redshift bin has finished its ray casting calculations . in each new redshift bin ,",
    "values of @xmath103 are reset to zero everywhere . though our approach for restricting recombinations will be dependent on the order in which point sources in a given bin turn on , over the course of the simulation we expect to statistically reproduce the correct behavior . in the case of plane sources ,",
    "the order in which each face is turned on is randomized at each redshift bin to avoid producing preferential ionizations along certain sides of the box during the course of the calculation .",
    "after ray casting is completed for a given source , new ionization fractions are set for all cells marked @xmath101 according to the equilibrium condition , @xmath104 where @xmath105 and @xmath106 are the photoionization rate and the temperature dependent collisional ionization rate for the ionic species in question , respectively .",
    "note that we have used a case a recombination coefficient in our equilibrium condition since we are interested in accounting for all recombination transitions for regions that have been ionized .",
    "we shall discuss the details associated with extracting the temperature dependent terms @xmath107 , @xmath108 and @xmath106 as well the clumping factor @xmath109 from the cosmological simulation below .",
    "note that the equilibrium condition above is not necessarily achieved in highly underdense regions where chemical timescales exceed the hubble time ; however , this will have a negligible effect on the overall morphological description of the ionization process , which is the primary objective of our type of study . in any case",
    ", the above equation can then be solved for the ionization fraction @xmath61 of the species .",
    "the photoionization rate in a cell due to radiation from a point source is given by , @xmath110 where @xmath111 is the mean cross section for photoionization .",
    "in the case of a plane source , the photoionization rate is expressed as , @xmath112 where @xmath113 is the proper area of a cell face .",
    "our expression for the mean cross section for photoionization is computed for a known radiation spectrum of the sources @xmath114 according to , @xmath115 where @xmath116 is the value of the cross section at frequency @xmath4 .    since in a single redshift bin , a cell",
    "may be affected by multiple sources , the photoionization rate @xmath105 will have to be updated for each source . at each redshift bin , we initialize @xmath117 everywhere on the grid . once ray casting is completed for a given source ( point _ or _",
    "planar ) , the photoionization rate in each marked cell is updated according to , @xmath118 where @xmath119 is the additional contribution to the rate from the current source .",
    "we now describe how the above method can be used to analyze outputs from a cosmological simulation to study the systematic reionization of he from quasars .",
    "we will use information from coarsely spaced outputs of a cosmological simulation to interpolate density fields for the ionization calculation .",
    "source information will also be derived from the cosmological outputs with the aid of a particle group finder .",
    "figure 3 gives the block diagram which schematically describes how the analysis proceeds .",
    "the cosmological simulation we will use in our analysis is based on a smoothed particle hydrodynamics ( sph ) treatment , computed using the parallel tree - code gadget developed by springel , yoshida & white ( 2000 ) .",
    "the particular cosmology we examine is a @xmath120cdm model with @xmath121 , @xmath122 , @xmath123 , and @xmath124 ( see , e.g. , springel , white & hernquist 2000 ) .",
    "the simulation uses @xmath125 sph particles and @xmath125 dark matter particles in a @xmath126 comoving box , resulting in mass resolutions of @xmath127 and @xmath128 , respectively .",
    "since our ray casting scheme is designed within the context of a uniform cartesian grid , the gas represented by sph particles will first have to be distributed into cells to form the required density fields .",
    "density grids will have to be produced for each available cosmological output in the redshift range of interest , from which we will interpolate the dynamical evolution of the gas for intermediate steps for our ionization calculation . in our analysis",
    ", we will be interested in the redshift range @xmath129 where he reionization is believed to have occurred .",
    "the cosmological simulation we use provides us with roughly @xmath130 data snapshots in this range .",
    "we would like to retain as much of the sph resolution as possible and therefore employ grids which have a total number of cells comparable to the number of gas particles used in the cosmological simulation . in this paper",
    ", we choose a conservative resolution of @xmath131 for our grids .",
    "the basic idea behind gridding is to properly distribute the mass from the particles into cells according to how the volume associated with each particle overlaps the cells in its vicinity .",
    "since the effective size of an sph particle can vary according to its surrounding density , particles will distribute their mass over a varying number of cells .",
    "our prescription for distributing the mass relies on using the smoothing kernel associated with the sph particles .",
    "in particular , the density contribution from a particle into an overlapping cell is obtained by averaging over the density kernel of the particle at discrete points uniformly distributed within the cell in question . the number of points over which the kernel density is averaged is directly related to the accuracy of the mass distribution . however , due to the very large number of particles through which one must loop during the gridding process , it becomes computationally expensive to use many points .",
    "we found that just @xmath132 points within each cell gives a surprisingly good description of the distribution . to conserve mass in light of the limited accuracy of this scheme ,",
    "we normalize the total mass allotted in overlapping cells to equal the total mass of the contributing particle . in the case where a particle is entirely contained within one cell , the particle contributes all its mass to that cell , in the form of a uniform density over the cell s volume .    in an effort to retain information associated with the mass distribution on scales smaller than a cell",
    ", we calculate an overall clumping factor for each cell based on the clumping characteristics of the particles contained within .",
    "in particular , we calculate the volume averaged clumping factor in each cell according to , @xmath133 where the summations are over particle indices whose center positions are located within the cell . the variables @xmath134 and @xmath135 represent the quoted density and mass of particle @xmath136 respectively , with @xmath137 giving the corresponding particle volume .",
    "it is obvious that the clumping factor for a given cell can only be greater than unity if it contains more than one particle . in the case where a cell does not contain any particles ,",
    "its clumping factor is set to unity .",
    "it is important to point out that the above estimate assumes that all high density gas is uniformly ionized . as a result",
    "we expect that we will be overestimating the clumping factor significantly in cells which harbor highly dense compact systems .",
    "this represents one of the drawbacks of using a uniform cartesian grid to describe our density field , nevertheless , due to the comparable level of resolution to the underlying cosmological simulation , we expect only a small fraction of the total cells in our grid to significantly overestimate the clumping factor .",
    "furthermore , such cells generally harbor the sources themselves in which case we simply set the ionization fraction to unity within the virial radius of the mass group . for the grid resolution chosen in this paper ,",
    "the virial radius for a typical source is about the width of a cell .    in a similar fashion",
    ", recombination rates and collisional ionization rates for a given cell are calculated on a particle by particle basis .",
    "in particular , rates are calculated by averaging over particle contributions according to their temperatures .",
    "it is is important to restate at this point that the underlying cosmological simulation we use in this paper neglects to include radiative transfer effects in its calculations of the photoheating rate , thereby substantially underestimating the energy input during and after the reionization ( see abel & haehnelt 1999 ) . as a result",
    ", we expect that the corresponding gas temperatures of the particles to be significantly lower than expected . to compensate for this shortcoming we artificially set the temperature of all the gas which becomes fully ionized in helium to @xmath138 unless its temperature was greater beforehand , in which case the prior temperature is used to calculate rates . in this paper the fitting formulae for the temperature dependent he ii recombination rates ( cases a and b ) is taken from hui & gnedin ( 1997 ) ( based on a fit to the data from ferland et al .",
    "( 1992 ) ) and the fitting formula for the collisional ionization rate of he ii is taken from black ( 1981 ) .",
    "once all the particles from a cosmological output have been processed , the resulting grid including clumping factors , and rates is written to a file and stored .",
    "these files are used to interpolate the dynamic evolution of the gas during the ionization simulation .      the gunn - peterson constraint",
    "( gunn & peterson 1965 ) on the amount of neutral material along the line of sight to distant objects requires that the hydrogen component of the intergalactic gas to have become highly ionized by @xmath139 ( fan et al .",
    "2000 ) and that the helium component was ionized by @xmath140 ( davidsen , kriss , & zheng 1996 ) .",
    "there has been much debate over the nature of the sources responsible for ionizing the gas ; namely whether they were stellar in nature or quasars .",
    "however , a discerning feature of he is its relatively high ionization potential , requiring that the sources responsible for ionizing this component of the intergalactic gas had intrinsically hard spectra .",
    "this supports the idea that he was primarily ionized by quasars which have much harder spectra than stellar sources .",
    "in particular , the ratio of he to h lyman continuum photons from star - forming galaxies is only about 2% as compared to 10% for a typical quasar ( leitherer & heckman 1995 ) .",
    "moreover , observations of helium absorption ( jakobsen et al . 1994 ; davidsen , kriss , & zheng 1996 ; hogan , anderson , & rugers 1997 ; reimers et al .",
    "1997 ; heap et al .",
    "2000 ; smette et al .",
    "2000 ) suggest that the optical depth does not steadily increase with lookback time , but instead drops sharply around @xmath141 when quasars were prevalent . in our analysis we will consider quasars as the sole sources of he ionizing radiation .    in this section",
    "we describe how candidate quasars are selected from the cosmological simulation to act as sources of ionizing radiation .",
    "this will involve identifying dense clumps of gas particles that stand out from the background as galaxies which are plausible quasar hosts , and adopting a prescription for selecting a subset of these objects as actual sources according to an empirical quasar luminosity function .",
    "although it will be possible to interpolate gridded density fields between these redshifts , source information will be available only at the cosmological outputs where one can use an algorithm designed to employ particle information to identify collapsed , highly overdense objects . as a result ,",
    "during the course of the ionization evolution , source information will be based on the nearest former cosmological output .",
    "since highly collapsed objects harbor relatively large amounts of matter , their large inertia causes them to remain relatively stationary over the course of a single light crossing time , making our approximate treatment for identifying their locations during the intermediate steps very reasonable .    to compile the list of sources expected to turn on during the simulation we follow the algorithm represented by the block diagram in figure 4",
    "the first task required is to store in descending order an array of redshifts , @xmath142 , corresponding to intervals of one source lifetime .",
    "these redshifts will designate when sources turn on and off during the ionization calculation .",
    "next , we loop over the cosmological simulation outputs , hereafter referred to as hydro outputs , to identify plausible sources .",
    "due to the high resolution of the simulations we are restricted to employing a fast algorithm capable of searching through a large dataset for dense clumps containing many particles . for our analysis",
    "we employ a friends - of - friends group finder which is designed to efficiently handle groups with very large numbers of particles ( @xmath143 ) , where it becomes imperative that the number of pair comparisons is kept to an absolute minimum . to identify galaxy type objects ,",
    "we specify a maximum linking length corresponding to a group overdensity of roughly @xmath144 . additionally , we specify a minimum mass , @xmath145 , required for a group to be considered a source . for every possible source",
    "identified , the center of mass location and total gas mass of the group are recorded and stored in arrays .",
    "once a list of plausible sources for a given hydro output has been compiled , all identified groups are logarithmically binned by mass and a tally of the number of groups in each bin is made .",
    "the results can then be fitted to form an analytic representation of the mass function . here",
    "we use a simple power - law of the form : @xmath146 where @xmath147 is the number of groups with total gas masses between @xmath148 and @xmath149 , and @xmath150,@xmath151 are fitted parameters .",
    "our analytic representation is motivated by the general power - law nature of theoretical halo mass functions at high redshift ( see press & schechter 1974 ) .",
    "it is important to point out that the above mass function applies only to the range of group masses found in our simulation volume .",
    "it is thus imperative that our cosmological simulation be large enough in scale and also have sufficient resolution so that we sample a representative range of group ( source ) masses .",
    "as we shall discuss later in this section , the cosmological simulation used in this paper meets these criteria by being able to reproduce the observed range of quasar luminosities with a constant mass - to - light ratio .",
    "our next step is to define a selection criterion which will determine a realistic subset of sources that will actually be activated during the calculation of the radiation field . in particular",
    ", we would like to select sources according to the observed quasar luminosity function @xmath152 ( lf ) .",
    "here , @xmath153 is the number of quasars per unit comoving volume at redshift @xmath43 , with intrinsic luminosities between @xmath6 and @xmath154 .",
    "given the observational data , the inferred luminosity function will depend upon the assumed cosmology and quasar spectra . in our simulations",
    ", we will adopt the double - power - law model presented by boyle et al .",
    "( 1988 ) using the open - universe fitting formulae from pei ( 1995 ) for the @xmath155-band ( 4400   rest - wavelength ) lf of observed quasars , with a rescaling of luminosities and volume elements for our @xmath120cdm cosmology .",
    "the parametric form of the double power - law lf can be written as @xmath156 where the break luminosity , @xmath157 , evolves with redshift according to : @xmath158}.\\ ] ]    in this model , the evolution of quasars peaks at @xmath159 with a characteristic dispersion of @xmath160 .",
    "the redshift factor @xmath161 represents the explicit dependence of the spectral index @xmath1 where a uv spectrum , @xmath162 , has been assumed .",
    "the values of the fitting parameters are @xmath163 , @xmath164 , @xmath165 , @xmath166 , @xmath167 , and @xmath168 for an open - universe cosmology with @xmath169 , @xmath170 , and @xmath171 .",
    "we use the above values and convert the lf to our @xmath120cdm cosmology by rescaling the luminosity and volume element for each redshift of interest .",
    "our conversion of the lf ignores any spectrum - dependent @xmath172-corrections which are thought to be small assuming an @xmath171 power law for the quasars ( haiman & loeb 1998 ) .",
    "it is important to point out that this model predicts that a large fraction of the luminosity at @xmath173 arises from quasars that have not yet been observed . with a fit to the lf which goes as @xmath174 at the faint end",
    ", the emissivity , @xmath175 ( in ergs @xmath176 @xmath177 @xmath178 ) , converges only as @xmath179 , and it becomes apparent that a large portion of the total emissivity will arise from this regime .",
    "nevertheless , the extrapolation of the lf to fainter quasars seems to be reasonable based on the analysis of haardt & madau ( 1996 ) where they use the above lf and a realistic form for quasar spectra to calculate the intensity of the ionizing background , @xmath180 . using the cosmological radiative transfer equation for diffuse radiation ( e.g. peebles 1993 ) , @xmath181 where @xmath150 is the scale factor",
    ", @xmath182 is the continuum absorption coefficient per unit length along the line of sight , and @xmath183 is the proper space - averaged volume emissivity , haardt & madau include the effects of absorption and emission by intervening clouds to calculate the evolution of @xmath180 . they show that @xmath184 increases from @xmath185 ergs @xmath176 @xmath186 @xmath187 @xmath177 at the present epoch to @xmath188 ergs @xmath176 @xmath186 @xmath187 @xmath177 at @xmath189 .",
    "this result is very consistent with high - resolution studies of the proximity effect which give @xmath190 obtained for a redshift range @xmath191 ( giallongo et al .",
    "1996 ) and @xmath192 ( cooke et al . 1997 ) for a similar redshift range .",
    "it is furthermore consistent with limits imposed by the opacity of the lyman alpha forest at both high ( e.g. rauch et al . 1997 ) and low ( e.g. dav et al . 1999 ) redshifts .    to be able to utilize the lf in our selection process",
    ", we will first need to prescribe some way of assigning luminosities to our list of plausible sources . in this paper",
    "we will simply assume that all sources have @xmath155-band luminosities directly proportional to their gas mass .",
    "this introduces a constant mass - to - light ratio , @xmath193 as another parameter in the analysis .",
    "we begin the selection process by first determining the number of sources expected at redshift @xmath142 with luminosities above @xmath194 , @xmath195 here , the minimum luminosity , @xmath194 , is defined as the @xmath155-band luminosity corresponding to @xmath196 .",
    "@xmath197 will thus designate the total number of sources chosen at redshift @xmath142 during the selection process .",
    "to convert @xmath197 to an integer in an impartial manner , a random number between @xmath53 and @xmath198 is generated and compared to the fractional component of @xmath197 .",
    "if the fractional component is larger than the generated number , @xmath199 is rounded up to the nearest integer , else @xmath197 is rounded down .",
    "next , we loop over every plausible source to determine whether it will be chosen .",
    "our selection criterion will consist of assigning a random number between @xmath53 and @xmath198 to the candidate source of mass @xmath200 and selecting it if the assigned value matches or falls below the value of a some probability function @xmath201 . to ensure that we match the quasar luminosity function",
    ", we define the probability function to be : @xmath202 where @xmath203 is the expected source mass function for a simulation box with comoving volume , @xmath204 , as derived from the luminosity function : @xmath205 and @xmath206 is just our analytic representation of the mass function attained from the actual hydro simulation now rewritten as : @xmath207 the loop is terminated when exactly @xmath197 sources have been selected . if the number selected falls short of @xmath197 after one run through the list of plausible sources , the list is reordered randomly and source selection is continued from the beginning of the list . in this manner , a list of sources is compiled for every redshift step of the simulation , @xmath142 , with plausible source lists and mass functions being updated near every hydro output redshift .    once a source with mass , @xmath200 , has been selected , it is assigned a @xmath155-band luminosity , @xmath208 ( in ergs @xmath176 ) .",
    "this luminosity along with an assumed spectral form , is then used to compute the amount of he ionizing flux that will be generated while the source is active . in this paper",
    ", we shall assume for all sources , a multi - power - law form for the spectral energy distribution , adopted from madau , haardt , & rees ( 1999 ) for quasars , @xmath209 where the different slopes have been continuously matched .",
    "this is based on the rest - frame optical and uv spectra of francis et al .",
    "( 1991 ) , sargent , steidel , & boksenberg ( 1989 ) , and the euv spectra of radio - quiet quasars ( zheng et al .",
    "1998 ) , and is very similar to the spectrum assumed in haardt & madau ( 1996 ) except for the slightly steeper index at shorter wavelengths .",
    "it is important to bear in mind that there is significant dispersion in each of the spectral indices used to construct the composite spectrum which could influence our final results . to calculate the amount of he ionizing flux",
    ", we will need an expression for the intensity at wavelengths short of the ionization threshold ( @xmath210  ) . using the above spectral form , we thus derive the following expression for the specific intensity in the regime @xmath211  : @xmath212 where @xmath213 and @xmath214 are frequencies evaluated at @xmath215   and @xmath216   respectively , and @xmath217 is the source intensity evaluated at frequency @xmath218 ( in ergs @xmath219 ) .",
    "next , we calculate @xmath217 using the assigned @xmath220 for the source , @xmath221 where we have used the @xmath222 definition for band luminosities , and we have assumed an isotropically emitting surface with area @xmath223 for our source ( though this will inevitably drop out of our calculations ) .",
    "we then use our expression for @xmath224 to calculate the number of ionizing he photons released per second by the source , @xmath225 where @xmath226 is planck s constant , @xmath88 is the ionization threshold frequency for he , and @xmath227 is the solar @xmath155-band luminosity ( in ergs @xmath176 ) . an ionization rate is computed and recorded for each source immediately after it is selected .    at the end of the entire source selection process , we will have recorded a list of source locations and ionization rates for every redshift step of the simulation . in selecting the sources and computing their intensities",
    "we have introduced three parameters : ( 1 ) a universal source lifetime , ( 2 ) a minimum source mass , and ( 3 ) a source mass - to - light ratio . for our first application ,",
    "we have adopted a fiducial model with suitably chosen parameter values : @xmath228 yrs , @xmath229 , and @xmath230 . in figure 5 , we plot the resulting number of sources invoked as a function of redshift . in this model ,",
    "the choice for the source lifetime simply reflects a reasonable guess based on the quasar light curve derived by haiman & loeb ( 1998 ) for a similar cosmology and lf .",
    "our value for the minimum mass is set to the minimum group mass below which our simulation can no longer resolve collapsed objects .",
    "we infer this mass limit from the clear drop off in the low end of the mass function occurring at roughly 64 gas particles or @xmath231 ( see , also , katz et al .",
    "1999 ; weinberg et al .",
    "2000 ) . with the minimum and maximum mass of the groups identified ,",
    "a mass - to - light ratio of @xmath229 is then chosen to reproduce roughly the same range of observed quasar luminosities from the survey conducted by warren , hewett & osmer ( 1994 ) .",
    "consequently , our ability to properly match the high end of the luminosity function with our most massive groups ensures that our volume is large enough to properly sample the range of source masses .",
    "it is important to point out that although we have matched the observed range in luminosities , there are undoubtably many more sources that are too faint to have been observed that we are excluding from our analysis .",
    "in fact , the results of cheng et al .",
    "( 1985 ) show that the lf of seyfert galaxies ( which are well correlated with that of optically selected quasars at @xmath232 ) does not show clear evidence of leveling off down to @xmath233 or @xmath234 , a factor of roughly @xmath235 below our choice for @xmath194 . though these faint sources have a sizable contribution to the total emissivity at low redshifts , the majority of ionizing photons at high redshifts arise from the brightest ( observed ) sources . in particular , at @xmath236 the luminosity function used in this paper yields only a @xmath237 deficit in the total number of ionizing photons from quasars when considering sources with luminosities greater than @xmath235 times the minimum luminosity implied by cheng et al .",
    "thus for the sake of being able to match the observed range in luminosities with a constant mass - to - light ratio and avoid accounting for the plethora of dim sources , we use a minimum luminosity of @xmath238 .",
    "we do not expect the small fractional difference in the ionizing emissivity predicted using this inflated @xmath194 to significantly alter the morphological evolution of the reionization process .      in table 1 , we list some of the variables necessary to properly track the ionization state in a cell whose contents change dynamically in time . in this section",
    "we describe in detail the computational steps involved in determining the evolution of these parameters during the reionization calculation .",
    "we begin by first retrieving the gas density , @xmath239 , the clumping factor @xmath109 , the recombination rates @xmath240 and @xmath241 , and the collisional ionization rate @xmath242 , for the earliest redshift @xmath12 when sources are due to switch on .",
    "( note since @xmath243 and @xmath109 or @xmath241 and @xmath109 will always appear as a product in all our expressions , we conserve memory by combining them into the variables @xmath244 and @xmath245 respectively .",
    "similarly , the collisional ionization rate and the gas clumping factor is combined into the variable @xmath246 . ) having already calculated @xmath239 , @xmath247 , @xmath245 , and @xmath246 for every hydro output , we use information from two adjacent output grids at redshifts @xmath248 and @xmath249 , where @xmath250 , to linearly interpolate the variables for our grid at @xmath12 . in particular , for each cell we calculate derivatives for @xmath239 , @xmath247 , @xmath245 , and @xmath246 between redshifts @xmath248 and @xmath249 and store the results in @xmath251 , @xmath252 , @xmath253 , and @xmath254 respectively .",
    "these derivatives are then used to linearly interpolate the values of the variables at the intermediate redshifts .",
    "having retrieved @xmath239 we initialize the variable @xmath255 which stores the comoving number density of helium nuclei , @xmath256 where @xmath257 is the helium abundance by mass ( we adopt @xmath258 and @xmath259 for hydrogen from the hydro simulations ) and @xmath260 is the mass of the helium atom . to initialize the number density of electrons @xmath261 , we will first need to assume an initial ionization state of the gas at the start of our simulation .",
    "applications of the gunn - peterson constraint have shown that the hydrogen component of the intergalactic gas was in a highly ionized state by @xmath262 ( schneider , schmidt , & gunn 1991 ) or even @xmath263 ( fan et al .",
    "2000 ) and that almost all the helium in the universe was singly ionized by about the same time . due to the sharp decline in the number density of bright quasars for @xmath264 , it appears as if either low - luminosity quasars or first generation stellar sources were responsible for the ionization of these components of the intergalactic gas . in any case , since the first sources of he ionizing flux in our simulation switch on around @xmath265 , we simply initialize the ionization fraction for h and he to unity .",
    "we are now able to compute the initial comoving electron density , @xmath266 where the first two terms on the right hand side represent the free electrons contributed from h and he respectively , and where the last term represents electrons released from he ionizations .",
    "since we have initialized @xmath267 , our initial value for the electron density will come only from the first two terms .",
    "once variables are initialized we can proceed with the ionization calculation .",
    "the computation will progress in uniform time increments corresponding to source redshift bins @xmath12 . at each @xmath12 ,",
    "a predetermined number of sources will turn on throughout the box with @xmath268 and @xmath261 being updated for each source . for each @xmath12 , precalculated derivatives in each cell are used to interpolate new densities and rates , with derivatives being updated near every hydro output redshift .    to calculate the ionization fractions we require an expression for the cross section of the species which is implicit in the photoionization rate .",
    "using the smoothed interpolation formula for the photoionization cross section of he ii given in osterbrock ( 1989 ; eq .",
    "[ 2.31 ] ) and assuming that @xmath269 beyond the ionization threshold frequency @xmath88 , we arrive at a mean cross section of @xmath270 .",
    "the numerical value of @xmath271 is taken from osterbrock ( 1989 ; eq . [ 2.4 ] ) .      in figure 6",
    ", we show a series of snapshots of a slice through our simulation volume demonstrating how the reionization process develops for our particular model . in each snapshot ,",
    "ionized regions with @xmath272 are outlined by the solid contours , with the underlying greyscale image indicating the density field .",
    "one can notice how the fronts quickly expand first into the voids , then more slowly into the denser filaments .",
    "conversely , denser regions are the first to recombine after they are mostly ionized due to the fact that they have large clumping factors .",
    "snapshots such as these can allow for qualitative comparisons between a number of models which can then be linked to quantitative differences .    to examine the manner in which each model ionizes the igm , we track global parameters describing the ionization fraction of our box at each redshift .",
    "figure 7 shows how the ionized mass fraction ( solid line ) and the ionized volume fraction ( dashed line ) evolve with redshift .",
    "the entire volume can become fully ionized by @xmath273 , consistent with observations ( jakobsen et al . 1994 ; davidsen , kriss , & zheng 1996 ; hogan , anderson , & rugers 1997 ; reimers et al . 1997 ; heap et al . 2000 ; smette et al . 2000 ) .",
    "it is evident that whereas the volume can easily achieve full ionization , the mass component can not . this is a consequence of extremely overdense cells with large clumping factors quickly recombining after they have been ionized . due to their high overdensities ( factors of @xmath274 or more ) it takes relatively few such cells to substantially lower the ionized mass fraction .",
    "furthermore , one expects the volume fraction to quickly exceed the mass fraction as i - fronts seep into the more voluminous underdense regions , which is also evident from the plot .",
    "in light of recent observations of the spectra of high - redshift quasars , a detailed understanding of the thermal history of the igm and reionization is highly desirable . in this paper",
    "we have described a method that is able to simulate the inhomogeneous reionization of a cosmological volume from a set of point sources and a diffuse background component .",
    "this new method conceptually differs significantly from previous approaches in that it does not evolve the radiation on the opacity timescale but rather on source lifetimes ( anm99 ; ciardi et al .",
    "2000 ; razoumov and scott 1999 ; gnedin 2000 ; kessel - deynet and burkert 2000 ; norman , paschos & abel 1998 ) .",
    "our method is specifically designed with short - lived sources in mind where one expects a negligible amount of cosmological evolution during a source lifetime .",
    "however , it is feasible to extend the formalism described in this paper to long - lived sources as well by solving the radiative calculations in a series of sub - steps , each of which is comparable to the lifetimes of short - lived sources where the assumption of negligible cosmological evolution is still valid .    as a first application",
    ", we have used our algorithm to conduct a statistical study of the reionization of he from short - lived quasars .",
    "our main conclusions from this application are : ( 1 ) quasars with the spectral form given in madau , haardt , & rees ( 1999 ) are able to ionize the volume by a redshift @xmath275 for a reasonable choice of source characteristics , and ( 2 ) that ionization fronts preferentially expand into the least dense but more voluminous regions of the igm , resulting in the ionized volume fraction being consistently larger than the ionized mass fraction .",
    "this feature seems to be less pronounced when more sources are involved since their presence in overdense regions counteracts the effect .",
    "these findings are in accord with the expectations from the model for reionization of miralda  escud , haehnelt , and rees ( 2000 ) .    our analysis in this paper reflects a first step in applying our algorithm to address a large assortment of questions regarding radiation processes in the universe .",
    "in particular , the method we have presented here can be supplemented to include the effect of heating from photoionizations to more accurately study the thermal history of the igm .",
    "in addition , one can extract simulated ly@xmath1 spectra from these volumes , which can then be used as a comparison tool with observational results .",
    "we can also envision integrating our algorithm within a hydrodynamical cosmological simulation to study the effects of ionizations on the dynamics of matter on various scales .",
    "a more systematic study of radiative transfer effects for he reionization by short - lived quasars will be presented in a forthcoming paper .",
    "we thank volker springel for making the outputs from the cosmological simulation available to us in a convenient form as well as providing useful algorithms for handling the large datasets .",
    "we thank abraham loeb for stimulating and informative discussions regarding the reionization of the universe .",
    "we also thank zolt@xmath276n haiman for providing us with a useful program for computing luminosity functions as well as informative commentary .",
    "this work was supported in part by nsf grants aci96 - 19019 , ast-9803137 , and phy 9507695 .",
    "fan , x. , white , r. l. , davis , m. , becker , r. h. , strauss , m. a. , haiman , z. , schneider , d. p. , gregg , m. d. , gunn , j. e. , knapp , g. r. , lupton , r. h. , anderson , j. e. , jr . ,",
    "anderson , s. f. , annis , j. , bahcall , n. a. , boroski , w. n. , brunner , r. j. , chen , b. , connolly , a. j. , csabai , i. , doi , m. , fukugita , m. , hennessy , g. s. , hindsley , r. b. , ichikawa , t. , ivezic , z. , loveday , j. , meiksin , a. , mckay , t. a. , munn , j. a. , newberg , h. j. , nichol , r. , okamura , s. , pier , j. r. , sekiguchi , m. , shimasaku , k. , stoughton , c. , szalay , a. s. , szokoly , g. p. , thakar , a. r. , vogeley , m. s. , york , d. g. 2000 , apj , 120 , 1167                                                                            ll +   + variable & description + @xmath239 .......................... & comoving gas density + @xmath280 .................... & comoving number density of helium nuclei + @xmath261 ........................ & comoving electron number density + @xmath281 ................ & gas clumping factor @xmath282 case a recombination rate + @xmath283 ................ & gas clumping factor @xmath282 case b recombination rate + @xmath284 .................... & gas clumping factor @xmath282 collisional ionization rate + @xmath285 ................... & he ionization fraction ( @xmath286 ) + @xmath287 .................. & rate of change of comoving gas density with redshift + @xmath288 ...... & rate of change of product @xmath281 with redshift + @xmath289 ...... & rate of change of product @xmath283 with redshift + @xmath290 ............. & rate of change of product@xmath284 with redshift +"
  ],
  "abstract_text": [
    "<S> the incorporation of radiative transfer effects into cosmological hydrodynamical simulations is essential for understanding how the intergalactic medium ( igm ) makes the transition from a neutral medium to one that is almost fully ionized . here </S>",
    "<S> , we present an approximate numerical method designed to study in a statistical sense how a cosmological density field is ionized by a set of discrete point sources . a diffuse background radiation field is also computed self - consistently in our procedure . </S>",
    "<S> the method requires relatively few time steps and can be employed with simulations having high resolution . </S>",
    "<S> we describe the details of the algorithm and provide a description of how the method can be applied to the output from a pre - existing cosmological simulation to study the systematic reionization of a particular ionic species . as a first application </S>",
    "<S> , we compute the reionization of he by quasars in the range @xmath0 .    _ </S>",
    "<S> pacs : _  95.30.jx ; 98.80-k    _ keywords : _  </S>",
    "<S> radiative transfer cosmology : theory  galaxies : igm </S>"
  ]
}