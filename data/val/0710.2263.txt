{
  "article_text": [
    "the catalysis of chemical reactions by surfaces plays a crucial role in a vast range of physical , chemical and biological systems . in many cases ,",
    "the surfaces are of macroscopic dimensions and the reactants appear in large quantities . under these conditions",
    ", the law of large numbers applies and fluctuations in the surface concentrations of reactants and their reaction rates become negligible . as a result , these reactions can be analyzed using rate equation models that incorporate the mean - field approximation and ignore fluctuations .",
    "consider the case of a surface , which is partitioned into microscopic domains , that are disconnected , namely reactants can not diffuse between them .",
    "the population of reactive atoms and molecules in each domain becomes small and fluctuations become important . as a result ,",
    "rate equations fail and the simulation of these reactions requires stochastic methods such as direct integration of the master equation @xcite or monte carlo ( mc ) simulations @xcite . while mc simulations require the accumulation of statistical data over long times , the master equation provides the probability distribution from which the reaction rates can be obtained directly . in certain cases , the master equation can be solved using a generating function @xcite .",
    "the set of coupled ordinary differential equations is then transformed into a single partial differential equation for the generating function .",
    "this equation can solved numerically and in a few cases can also be solved analytically @xcite .",
    "the master equation can also be approximated using the fokker - planck equation @xcite .",
    "this is a partial differential equation in which the population sizes of the reactive species are represented by continuous variables @xcite .",
    "the master equation and related methods described above are useful for simple reaction networks , which involve few reactive species . however , as the number of reactive species increases , the number of equations in the master equation quickly proliferates .",
    "this makes the master equation infeasible for complex networks including a large number of reactive species .",
    "the recently introduced multiplane method provides a dramatic reduction in the number of equations @xcite . in this method , the reaction networks are described by graphs , where each node represents a species and each edge represents a reaction . typically , these networks are sparse , namely most species react only with few other species . in the multiplane method",
    "one breaks the network into a set of fully connected subnetworks ( cliques ) .",
    "lower - dimensional master equations are constructed for the marginal probability distributions associated with the cliques , with suitable couplings between them .",
    "this enables the simulation of large networks much beyond the feasibility limit of the master equation .",
    "however , it turns out that the construction of the multiplane equations for complex networks is difficult .    in this paper",
    "we present a method for stochastic simulations of surface reaction networks , which is based on moment equations .",
    "this method exhibits crucial advantages over the multiplane method @xcite .",
    "the number of equations is further reduced to one equation for each reactive species ( node ) and one equation for each reaction ( edge ) .",
    "thus , for typical sparse networks the complexity of the stochastic simulation becomes comparable to that of the rate equations .",
    "unlike the master equation ( and the multiplane method ) there is no need to adjust the cutoffs , namely the same set of equations is used under all physical conditions .",
    "moreover , for any given network the moment equations can be easily constructed using a diagrammatic approach .",
    "this enables to automate the construction of the set of equations - a feature which is essential in the case of complex networks .",
    "furthermore , the moment equations are linear in terms of the moments .",
    "thus , the stability and convergence properties can be easily controlled and the steady state solution can be obtained by standard algebraic methods .    below we consider some examples of surface reaction systems in which fluctuations play an important role . in surface catalysis systems ,",
    "the surface is often partitioned into facets on nanometric dimensions , with little diffusion between the facets . under these conditions",
    "the number of reactive atoms and molecules residing on a facet is small and fluctuations are strong . @xcite .",
    "another important example of chemical reaction networks that require stochastic analysis appears in the field of interstellar chemistry .",
    "some chemical reactions in interstellar clouds take place on the surfaces of dust grains @xcite .",
    "these include molecular hydrogen formation @xcite as well as reaction networks that form ice mantles and certain organic molecules .",
    "unlike gas phase reactions in cold clouds that mainly produce unsaturated molecules @xcite , surface processes are dominated by hydrogen - addition reactions that result in saturated , hydrogen - rich molecules , such as water ( h@xmath0o ) , ammonia ( nh@xmath1 ) , methane ( ch@xmath2 ) , formaldehyde ( h@xmath0co ) and methanol ( ch@xmath1oh ) @xcite . in particular , recent experiments have shown that methanol can not be efficiently produced by gas phase reactions @xcite .",
    "on the other hand , there are indications that it can be efficiently produced on ice - coated grains @xcite .",
    "therefore , the ability to perform efficient simulations of chemical reactions on interstellar grains is of great importance .    due to the submicron size of the grains and the low gas density , the populations of reactive species per grain are small and strongly fluctuate .",
    "therefore , rate equations are not suitable @xcite and stochastic methods such as the direct integration of the master equation @xcite or mc simulations @xcite are required . as discussed above , these methods apply in the case of small networks but become infeasible for large networks @xcite .    here",
    "we demonstrate the moment - equation method for a set of astrophysically relevant networks of increasing complexity , culminating in the network that describes the production of methanol .",
    "it is shown that in spite of the small number of equations and the ease of their construction , the accuracy of the results is not compromised .",
    "the results of the moment equations are in excellent agreement with the master equation and coincide with the rate equations in the limit of large grains .    the paper is organized as follows . in sec .",
    "ii we consider the production rate of molecular hydrogen using the rate equation , master equation and moment equation methods . in sec .",
    "iii we consider the simulation of complex reaction networks using the moment equations .",
    "the construction of the set of moment equations using diagrammatic methods is presented in sec .",
    "iv , followed by a summary in sec . v.",
    "consider the reaction h@xmath3h@xmath4h@xmath0 that takes place on the surfaces of interstellar dust grains .",
    "hydrogen atoms from the gas phase collide and stick to the surface of a dust grain .",
    "they diffuse between adsorption sites on the surface and when two of them encounter each other they recombine and form an h@xmath0 molecule , which desorbs into the gas phase .    for simplicity , we assume that the grains are spherical and denote their diameter by @xmath5 .",
    "the cross - section of a grain is @xmath6 and its surface area is @xmath7 .",
    "the density of adsorption sites on the surface of a grain is denoted by @xmath8 ( sites @xmath9 ) .",
    "thus , the number of adsorption sites on the grain is @xmath10 .",
    "each grain is exposed to a flux @xmath11 ( s@xmath12 ) of h atoms , where @xmath13 ( @xmath14 ) is the density of h atoms in the gas phase and @xmath15 ( cm s@xmath12 ) is their average velocity , which is determined by the gas temperature .",
    "it is also useful to define the flux in units of monolayers ( ml ) per second , namely @xmath16 ( ml s@xmath12 ) . clearly , this flux is independent of the grain size .",
    "the desorption rate of h atoms from the grain is given by @xmath17 , where @xmath18 is the attempt rate ( standardly taken to be @xmath19 s@xmath12 ) , @xmath20 is the activation energy barrier for desorption of an h atom , and @xmath21 ( k ) is the surface temperature .",
    "the hopping rate of adsorbed atoms between adjacent sites on the surface is @xmath22 , where @xmath23 is the activation energy barrier for hopping of the atoms .",
    "molecular hydrogen formation on astrophysically relevant surfaces of silicates , carbon and ice has been studied by laboratory experiments during the past decade @xcite . from the results of these experiments one can extract , for each surface , the energy barriers defined above and the density of adsorption sites . in the simulations presented below , the density of adsorption sites was @xmath24 ( sites @xmath9 ) , the activation energies were @xmath25 mev for diffusion and @xmath26 mev for desorption .",
    "these parameters are rounded values of the experimental results for hydrogen recombination on silicates @xcite .",
    "the grain temperature was taken as @xmath27k . here",
    "we assume that diffusion occurs only by thermal hopping , in agreement with the experimental results @xcite .",
    "for small grains , it is convenient to replace the hopping rate @xmath28 ( hops s@xmath12 ) by the sweeping rate @xmath29 , which is approximately the inverse of the time it takes for an h atom to visit nearly all the adsorption sites on the grain surface ( for a more precise evaluation of the sweeping rate see refs .",
    "the rate equation for this reaction takes the form    @xmath30    where @xmath31 is the average population size of h atoms residing on the grain . the first term on the right hand side of eq .",
    "( [ eq : rate_1specie ] ) describes the incoming flux of h atoms .",
    "the second term accounts for the desorption of h atoms from the surface , which is proportional to the number of adsorbed atoms .",
    "the third term accounts for the depletion in the population of adsorbed h atoms due to the recombination process .",
    "the production rate of h@xmath32 molecules on a single grain , is given by    @xmath33    for simplicity we assume that these molecules desorb from the surface upon formation .    the rate equation ( [ eq : rate_1specie ] ) can be solved either analytically or by numerical integration . the steady state solution can be obtained by setting the left hand side of eq .",
    "( [ eq : rate_1specie ] ) to zero . under steady state conditions ,",
    "the average population size of h atoms on a grain is    @xmath34 \\label{eq : rate_ss}\\ ] ]    and the formation rate of molecules per grain is    @xmath35 ^ 2 ,   \\label{eq : eta_ss}\\ ] ]    where @xmath36 . note that @xmath37 is independent of the grain size . under these conditions",
    ", one can define the recombination efficiency    @xmath38    which is the fraction of adsorbed atoms that come out in molecular form .",
    "note that @xmath39 .",
    "one can identify two limits . in the limit where @xmath40 the desorption process is dominant and the recombination efficiency is low . in this case , the recombination rate per grain is @xmath41 and the recombination efficiency is @xmath42 .",
    "since @xmath43 depends quadratically on the flux , this regime is referred to as second order kinetics . in the opposite limit , where @xmath44 , the recombination process is dominant and the efficiency is @xmath45 .",
    "this is the regime of first order kinetics , in which @xmath43 depends linearly on @xmath46 @xcite .    under given flux and surface temperature , for grains that are large enough to hold many h atoms , eq .",
    "( [ eq : rate_1specie ] ) provides a good description of the recombination process .",
    "however , in the limit of small grains and low flux , @xmath31 may be reduced to order unity or less . under these conditions , eq .",
    "( [ eq : rate_1specie ] ) becomes unsuitable , because it ignores the discrete nature of the population of adsorbed atoms and its fluctuations .",
    "to account correctly for the recombination rate on small grains , simulations using the master equation are required .",
    "the dynamical variables of the master equation are the probabilities @xmath47 of having a population of @xmath48 hydrogen atoms on the grain . in the case of hydrogen recombination",
    ", the master equation takes the form    @xmath49 + w   \\left [ ( n + 1 ) p   ( n + 1 ) - n   p ( n ) \\right ]   \\nonumber \\\\ & + & a   [ ( n + 2 ) ( n + 1 ) p ( n + 2 )   - n ( n -1 ) p ( n ) ] , \\label{eq : master_1specie}\\end{aligned}\\ ] ]    where @xmath50 . the first term on the right hand side of eq . ( [ eq : master_1specie ] ) describes the effect of the incoming flux .",
    "the probability @xmath51 increases when an h atom is adsorbed by a grain that already has @xmath52 adsorbed h atoms , and decreases when it is adsorbed on a grain with @xmath48 atoms .",
    "the second term accounts for the desorption process .",
    "the third term describes the recombination process .",
    "the recombination rate is proportional to the number of pairs of h atoms on the grain , namely @xmath53 .",
    "therefore , the h@xmath0 production rate can be expressed in terms of the moments of @xmath47 as    @xmath54    in numerical simulations the master equation must be truncated in order to keep the number of equations finite . a convenient way to achieve this is to assign an upper cutoff @xmath55 on the population size .",
    "the number of equations is thus @xmath56 .",
    "the truncated master equation is valid if the probability to have a larger population than the assigned cutoff is vanishingly small .",
    "therefore , the upper cutoff should be chosen according to the parameters of the simulation .",
    "as noted above , the population size of the adsorbed h atoms is given by the first moment of @xmath47 , while the reaction rate can be expressed in terms of the difference between the second moment and the first moment .",
    "therefore , a closed set of equations for the time derivatives of these first and second moments could directly provide all the information that we need about the population size and reaction rates @xcite .",
    "such equations can be obtained from the master equation using the identity    @xmath57    where @xmath58 is an integer . inserting @xmath59 according to eq .",
    "( [ eq : master_1specie ] ) , one obtains the moment equations    @xmath60    this is a set of coupled differential equations , which are linear in the moments @xmath61 . although we have written the equations only for the first two moments , the right hand side includes the third moment for which we have no equation .",
    "in order to close the set of equations one must express the third moment in terms of the first two moments .",
    "different such expressions have been proposed .",
    "for example , in the context of birth - death processes the relation @xmath62 was used @xcite .",
    "this choice makes the moment equations nonlinear , with possible effects on their stability .",
    "another common choice is to assume that the third central moment is zero ( which is exact for symmetric distributions ) and use this relation in order to express the third moment in terms of the first and second moments @xcite .    here",
    "we set up the closure condition by imposing a highly restrictive cutoff on the master equation .",
    "the cutoff is set at @xmath63 .",
    "this is the minimal cutoff that still enables the recombination process to take place . under this cutoff",
    ", one obtains the following relation between the first three moments @xcite    @xmath64    using this result , one can bring the moment equations [ eq .",
    "( [ eq : momentsh ] ) ] into a closed form :    @xmath65    numerical integration of these equations provides the first two moments , from which the population size and reaction rate are obtained .",
    "the steady state solution of the moment equations can be obtained by setting the derivatives on the left hand side of eq .",
    "( [ eq : moment_2 ] ) to zero .",
    "one obtains    @xmath66    using eq .",
    "( [ eq : master_production ] ) we find that the recombination rate is    @xmath67 .",
    "\\label{eq : r_moment_ss}\\ ] ]    in this system one can identify two characteristic spatial scales , namely @xmath68 and @xmath69 @xcite .",
    "the limit of small grains is obtained when @xmath70 is smaller than both @xmath71 and @xmath72 . in this limit",
    "the populations size of atoms on the grain is small , the rate equation fails while the moment equations are accurate .",
    "the limit of large grains is obtained when @xmath70 is larger than both @xmath71 and @xmath72 . in this limit",
    "the population size of atoms on the grain is large , the rate equation applies and the reaction rate satisfies @xmath73 .",
    "since @xmath74 and @xmath75 , the limit of large grains can be expressed by    @xmath76    we recall that the moment equations were derived by imposing a strict cutoff on the master equation .",
    "one may thus expect that the equations will apply only in the case of small grains , where this cutoff is suitable .",
    "however , it turns out that the moment equations are valid much beyond this limit .",
    "below we show that the reaction rate obtained from the moment equations is accurate for both small and large grains .    in fig .",
    "[ fig1 ] we present the population size of h atoms and the reaction rate , vs. grain diameter , obtained by the moment equations ( circles ) .",
    "the flux of h atoms was @xmath77 ( atoms s@xmath12 ) .",
    "the parameters used in fig .",
    "[ fig1 ] satisfy the conditions for second - order kinetics , namely @xmath40 .",
    "the results are in perfect agreement with the master equation ( solid lines ) for the entire range of grain sizes . for small grains , the rate equation ( dashed lines ) over - estimates the recombination rate , but coincides with the master equation and the moment equations for large grains . in fig .",
    "[ fig2 ] we present the population size of h atoms and the reaction rate , vs. grain diameter , under the conditions of first - order kinetics , where @xmath44 .",
    "these conditions were obtained by increasing the flux to @xmath78 ( atoms s@xmath12 ) .",
    "the moment equations still provide accurate results for the reaction rate on grains of all sizes .",
    "however , for large grains the population size of adsorbed h atoms , obtained from the moment equations , deviates from the master equation results .    in conclusion",
    ", one can identify two kinetic regimes ( first and second order ) and two limits ( small and large grains ) . in the limit of small grains , the moment equations are valid , as expected , for both kinetic regimes ( table i ) . in the case of second order kinetics ,",
    "the moment equations are valid both for small grains and for large grains .",
    "they provide accurate results both for the average number of atoms on a grain and for for the reaction rate . in the case of large grains under conditions of first order kinetics",
    "the situation is different .",
    "the moment equations still provide accurate results for the reaction rate but are not suitable for the evaluation of the population size on a grain . in the next section we present a more complete analysis of the moment equations and their validity .",
    "the moment equations were derived on the basis of a very strict cutoff , allowing at most two atoms to simultaneously reside on the surface of the grain .",
    "nevertheless , it turns out that the equations apply even under conditions in which the population size of adsorbed atoms is large . here",
    "we examine the validity of the moment equations in the regimes of first and second order kinetics and in the limits of small and large grains .",
    "for sufficiently small grains the population of adsorbed atoms on a grain is small and is consistent with the strict cutoff imposed in the derivation of the moment equations .",
    "therefore in the limit of small grains the approximation of eq .",
    "( [ eq : third_moment ] ) is justified , and the moment equations are valid .    in the limit of large grains",
    "the population of adsorbed atoms on a grain is large and the rate equation becomes accurate .",
    "therefore , we will test the validity of the moment equations in this limit by comparison with the rate equations . in the limit of large grains the relations @xmath79 and @xmath80 are satisfied .",
    "we will first consider the case of second order kinetics , where @xmath81 .",
    "using the relations above , we find that eqs .",
    "( [ eq : moment_ss ] ) are reduced to @xmath82 and @xmath83 .",
    "thus the results of the moment equations for the population size and for the reaction rate coincide with the rate equations .    in the case of first order kinetics @xmath84 . in the limit of large grains",
    ", we obtain from eq .",
    "( [ eq : moment_ss ] ) that @xmath85 , which is consistent with the h@xmath0 production rate obtained from rate equations . on the other hand ,",
    "the expression for the first moment is reduced to @xmath86 , which is inconsistent with the rate equations , in which @xmath87 .",
    "these results are in line with the numerical results shown above , indicating that the moment equations are suitable for the evaluation of reaction rates on large grains both in first and second order kinetics . however , they provide the correct population size of atoms on large grains only in the case of second order kinetics and not in first order kinetics .    in fig .",
    "[ fig3](a ) we show the first moment , @xmath88 , as obtained from the moment equations ( circles ) vs. @xmath37 , for a very large grain of diameter @xmath89 mm , where @xmath90 .",
    "the results are compared with those of the rate equation ( dashed line ) , which under these conditions is accurate . for @xmath40 ( second order kinetics )",
    "the rate equation and the moment equations coincide . for @xmath44 ( first order kinetics )",
    "the moment - equation results for the average population size deviate from those of the rate equation .",
    "note that even when @xmath40 , where the moment equations apply , the population size of atoms per grain is very large , much beyond the cutoffs used in the construction of the equations . in fig .",
    "[ fig3](b ) we present the production rate of h@xmath0 molecules per grain vs. @xmath37 , as obtained from the moment equations ( circles ) .",
    "the results are in perfect agreement with those of the rate equations ( dashed line ) in the regime of first order kinetics as well as in the regime of second order kinetics .",
    "these results can be generalized to more complex networks .",
    "the analysis becomes more tedious , but the conclusions about the domain of validity of the moment equations remain the same . from a physical perspective , in first order kinetics",
    "the reaction is dominant and desorption is suppressed , while in second order kinetics desorption is dominant and the reaction rate is low and diffusion limited .",
    "to generalize the analysis beyond the case of a single species , consider a simple chemical network that involves three reactive species : h and o atoms and oh molecules @xcite .",
    "for simplicity we denote the reactive species by @xmath91 h , @xmath92 o , @xmath93 oh , and the resulting non - reactive species by @xmath94 h@xmath0 , @xmath95 o@xmath0 , @xmath96 h@xmath0o .",
    "the reactions that take place in this network include h + o @xmath97 oh ( @xmath98 ) , h + h @xmath97 h@xmath0 ( @xmath99 ) , o + o @xmath97 o@xmath0 ( @xmath100 ) , and h + oh @xmath97 h@xmath0o ( @xmath101 ) . a graph of that network",
    "is displayed in fig .",
    "[ fig4](a ) .",
    "now , the desorption rates of atomic and molecular species on the grain are given by @xmath102 $ ] , where @xmath103 is the activation energy barrier for desorption of species @xmath104 and @xmath21 ( k ) is the surface temperature . the hopping rate of adsorbed atoms between adjacent sites on the surface is @xmath105 $ ] , where @xmath106 is the activation energy barrier for hopping of @xmath104 atoms ( or molecules ) .",
    "the sweeping rate will be @xmath107 .",
    "the master equation provides the time derivatives of the probabilities @xmath108 that a randomly chosen grain will have @xmath109 atoms or molecules of the reactive species @xmath104 .",
    "it takes the form    @xmath110    \\nonumber \\\\   & & + \\sum_{i=1}^3    w_i \\left [ ( n_i+1 ) p( .. ,n_i+1 , .. ) - n_i p(n_1,n_2,n_3 ) \\right ]    \\nonumber \\\\   & & + \\sum_{i=1}^2    a_i [ ( n_i+2)(n_i+1 ) p( .. ,n_i+2 , .. )   - n_i(n_i-1 ) p(n_1,n_2,n_3 ) ]    \\nonumber\\\\   & & + ( a_1+a_2 ) [ ( n_1 + 1)(n_2 + 1 ) p(n_1 + 1,n_2 + 1,n_3 - 1 )   - n_1 n_2 p(n_1,n_2,n_3 ) ]   \\nonumber \\\\   & & + ( a_1+a_3 ) [ ( n_1 + 1)(n_3 + 1 ) p(n_1 + 1,n_2,n_3 + 1 )   - n_1 n_3 p(n_1,n_2,n_3 ) ] .",
    "\\label{eq : master }   \\end{aligned}\\ ] ]    the terms in the first sum describe the incoming flux , where @xmath111 ( atoms s@xmath12 ) is the flux _ per grain _ of the species @xmath104 .",
    "the second sum describes the effect of desorption .",
    "the third sum describes the effect of diffusion - mediated reactions between two identical atoms and the last two terms account for reactions between different species .",
    "the rate of each reaction is proportional to the number of pairs of atoms of the two species involved , and to the sum of their sweeping rates .",
    "the average population size of the @xmath104 species on the grain is @xmath112 , where @xmath113 , and @xmath114 , 2 or 3 .",
    "the production rate per grain @xmath115 ( molecules s@xmath12 ) of @xmath116 molecules produced by the reaction @xmath117 is given by @xmath118 , or by @xmath119 in case that @xmath120 .",
    "for complex networks with more than one species the truncation of the master equation demands setting upper cutoffs for all the reactive species , @xmath121 , @xmath122 , where @xmath123 is the number of reactive species .",
    "the number of coupled equations is then @xmath124 , which grows exponentially with the number of reactive species .",
    "this severely limits the applicability of the master equation to interstellar chemistry @xcite . to reduce the number of equations one tries to use the lowest possible cutoffs under the given conditions . in any case , to enable all reaction processes to take place , the cutoffs must satisfy @xmath125 for species that form homonuclear diatomic molecules ( h@xmath0 , o@xmath0 , etc . ) and @xmath126 for other species .    as in the case of hydrogen recombination ,",
    "the population sizes and reaction rates are completely determined by all the first moments and selected second moments of the distribution @xmath108 .",
    "therefore , a closed set of equations for the time derivatives of these first and second moments could provide the complete information on the population sizes and reaction rates . for the simple network considered here one needs equations for the time derivatives of the first moments @xmath127 , @xmath128 and of the second moments @xmath129 , @xmath130 , @xmath131 and @xmath132 .",
    "we obtain these equations from the master equation using the identity    @xmath133    where @xmath134 are integers . here",
    "we show three of the resulting moment equations :    @xmath135    as expected , the right hand sides of these equations include third order moments for which we have no equations .",
    "if we add equations for their time derivatives , they will include fourth order moments , and again will not enable us to close the set of equations . in order to close the set of moment equations",
    "we must express the third order moments in terms of the first and second order moments .",
    "we recall that in the case of a single reactive specie this was achieved by imposing an extremely restrictive cutoff on the master equation .",
    "generalizing it to our present system we choose the minimal cutoffs that do not terminate any of the reactions taking part in the network .",
    "these cutoffs allow at most two atoms or molecules to be adsorbed on the surface at any given time .",
    "furthermore , any two atoms or molecules that reside simultaneously on the surface must belong to species that react with each other . in our network",
    "these cutoffs allow only eight non - vanishing probabilities , namely , @xmath136 , @xmath137 , @xmath138 , @xmath139 , @xmath140 , @xmath141 , @xmath142 and @xmath143 .",
    "expressing the third moments , with these cutoffs , leads to the following results :    @xmath144    using these rules to modify eqs .",
    "( [ eq : momenth_h2o ] ) one obtains a closed set of the form    @xmath145    this set of equations is the minimal set required for the system .",
    "it includes one equation that accounts for the population size of each reactive specie and one equation that accounts for the reaction rate of each reaction . as in the hydrogen system",
    ", the equations were derived using extremely strict cutoffs , that are expected to apply only in the limit of small grains and low flux .",
    "nevertheless , the moment equations are valid well beyond the restrictive cutoffs under which they were derived . in fig .",
    "[ fig5](a ) we present the population sizes of h ( @xmath146 ) and o ( @xmath3 ) atoms on a grain vs. grain diameter , obtained from the moment equations . in fig .",
    "[ fig5](b ) we show the production rates of h@xmath0 ( circles ) , o@xmath0 ( triangles ) and h@xmath0o ( squares ) , obtained from the moment equations .",
    "the results are in excellent agreement with the master equation and in the limit of large grains they also coincide with the rate equations .",
    "the parameters used in the simulations are @xmath147 ( atoms s@xmath12 ) , @xmath148 and @xmath149 .",
    "the activation energies for diffusion and desorption were taken as @xmath150 , @xmath151 , @xmath152 , @xmath153 , @xmath154 and @xmath155 mev for h , o and oh respectively . the surface temperature of the grain was @xmath156k .",
    "for the species other than h there are no concrete experimental results , and the values reflect the tendency of heavier species to bind more strongly .",
    "the generalization to more complex networks is straightforward . as explained above",
    ", the cutoffs imposed on the master equation give rise to a minimal set of non - vanishing probabilities , that allow all the reactions to take place .",
    "these non - vanishing probabilities are @xmath157 for the each node , @xmath158 , and @xmath159 for each edge connecting nodes @xmath158 and @xmath160 . a loop connected to the node @xmath158 corresponds to the probability @xmath161 .",
    "all other probabilities vanish . in the realm of two - body reactions",
    "additional probabilities such as @xmath162 or @xmath163 are never required . under these restrictions",
    ", one can easily show that all the third moments that appear in the moment equations can be expressed in terms of second moments according to eq .",
    "( [ eq : barzel_rules ] ) .",
    "let us now examine how the moment equation method performs in a more complex network .",
    "recent laboratory experiments provide evidence that methanol in interstellar clouds is formed via reaction networks on dust grains @xcite .",
    "to simulate these networks , consider the case in which a flux of co molecules is added to the network shown in fig .",
    "[ fig4](a ) .",
    "this gives rise to the network shown in fig .",
    "[ fig4](b ) , which includes the following sequence of hydrogen addition reactions @xcite : h + co @xmath97 hco ( @xmath164 ) , h + hco @xmath97 h@xmath0co ( @xmath165 ) , h + h@xmath0co @xmath97 h@xmath1co ( @xmath166 ) and h + h@xmath1co @xmath97 ch@xmath1oh ( @xmath167 ) .",
    "two other reactions that involve oxygen atoms also take place : o + co @xmath97 co@xmath0 ( @xmath168 ) and o + hco @xmath97 co@xmath0 + h ( @xmath169 ) .",
    "this network was studied before using the multiplane method , which required about a thousand equations compared to about a million equations in the master equation with similar cutoffs .",
    "the moment equations include one equation for each species ( node in the graph ) and one equation for each reaction ( edge in the graph ) , namely , the network shown in fig . [ fig4](b ) requires only 17 equations .",
    "we have performed extensive simulations of this network using the moment equations and found that they are in agreement with the master equation results . in fig .",
    "[ fig6](a ) we present the population sizes of h ( @xmath3 ) , o ( @xmath170 ) and co ( @xmath146 ) on a grain vs. grain diameter , as obtained from the moment equations . in fig .",
    "[ fig6](b ) we present the results of the moment equations for the formation rates of ch@xmath1oh ( squares ) , h@xmath0o ( circles ) and o@xmath0 ( triangles ) and compare them to the master equation ( solid line ) and the rate equations ( dashed lines ) . as before ,",
    "the moment equations prove to be consistent with the master equation , and for large grains with the rate equations as well .",
    "in the simulations presented here the activation energies for diffusion and desorption of co , hco , h@xmath0co and h@xmath1co were taken as @xmath171 , @xmath172 , @xmath173 , @xmath174 , @xmath175 , @xmath176 and @xmath177 , @xmath178 mev , respectively .",
    "the flux of co molecules was taken as @xmath179 .    in complex reaction networks",
    "the reduction in the number of equations becomes extremely significant .",
    "for each reactive species , @xmath104 ( denoted by a node in the graph ) , there is one equation for the time derivative of the first moment @xmath127 . for each reaction , between species @xmath104 and @xmath180 ( represented by an edge ) , there is one equation for the time derivative of the second moment @xmath181 .",
    "the number of equations is thus @xmath182 , where @xmath183 and @xmath184 are the numbers of nodes and edges , respectively .",
    "most reaction networks are sparse , namely the number of edges is of the same order of magnitude as the number of nodes . as a result ,",
    "the number of moment equations is roughly _ linearly _ dependent on the number of species .",
    "this is in contrast with the exponential growth of the master equation and the polynomial growth of the multiplane equations @xcite .",
    "in the previous section we described a procedure for the construction of the moment equations , that consists of three steps . in the first step the desired set of moment equations",
    "is determined according to the network graph .",
    "this set includes one equation for the first moment associated with each species ( node ) and one equation for the second moment associated with each reaction ( edge or loop ) . in the second step the time derivative of each of these moments",
    "is expressed as a suitable linear combination of first , second and third moments . in the third step",
    "the equations are brought into a closed form , by expressing all third moments in terms of first and second moments according to eq .",
    "( [ eq : barzel_rules ] ) .",
    "this procedure is suitable for simple networks but becomes difficult to execute as the network complexity increases .    here",
    "we present a simple and highly efficient diagrammatic approach for the construction of the moment equations for any given network . consider the reaction networks shown in fig .",
    "each node in the graphs represents one of the reactive species , and each edge stands for a reaction between two species .",
    "a loop represents a reaction between two atoms / molecules of the same species .",
    "the list of moments that should be included in the moment equations is easily obtained from the graph : ( a ) for each each node , @xmath158 , there is an equation for the first moment @xmath127 ; ( b ) for each edge connecting the nodes @xmath158 and @xmath160 there is an equation for the second moment @xmath181 ; ( c ) for each loop attached to node @xmath158 there is an equation for the second moment @xmath185 .    to derive the moment equations from the graph of a given network ,",
    "we show how each element in the graph is expressed in the master equation and then translate it into a corresponding term in the moment equations .",
    "consider first the contribution of nodes .",
    "each node represents a species , that may be adsorbed on the surface or desorbed from it . in the master equation , these two processes are described by    @xmath186 \\label{eq : node_master } \\\\ & + & w_i[(n_i+1)p(\\dots , n_i+1 , \\dots)- n_ip(\\dots , n_i , \\dots ) ] .",
    "\\nonumber \\end{aligned}\\ ] ]    to construct the equation for @xmath187 we sum over all the terms of the master equation , according to eq . (",
    "[ eq : moment_abc ] ) .",
    "the terms above then make the following contribution to the moment equations    @xmath188    in case that the species @xmath158 reacts with itself , one needs to include an equation for @xmath189 . as before , a proper summation over the master equation is performed , but here the contribution of the node @xmath158 will be    @xmath190    if the species",
    "@xmath158 reacts with some other species , @xmath160 , it will be necessary to include an equation for @xmath191 .",
    "the contribution of the node @xmath158 to this equation is    @xmath192    note that in the equation for @xmath191 , one should also include the analogous term for the node @xmath160 .",
    "consider the contribution of edges to the moment equations .",
    "each edge represents a reaction between two different species . in the master equation , the term related to the edge between @xmath158 and @xmath160 is    @xmath193 . \\nonumber",
    "\\\\\\end{aligned}\\ ] ]    the contributions of this term to the moment equations appear in all the equations for moments involving either species @xmath158 or species @xmath160 .",
    "for example , the contribution to the equation for @xmath191 is    @xmath194    after applying the rules of eq .",
    "( [ eq : barzel_rules ] ) , this term simplifies to @xmath195 .",
    "in general , each moment equation is obtained by a proper summation over terms of the master equation , using eq .",
    "( [ eq : moment_abc ] ) .",
    "each term in the master equation describes a certain process such as adsorption , desorption or reaction .",
    "consider the equations for @xmath187 and @xmath189 .",
    "when the summations are carried out , the only non - vanishing contributions are from processes that involve the species @xmath104 . similarly , consider the equation for @xmath191 . in this case",
    "the only non - vanishing contributions are from processes that involve either the species @xmath104 or the species @xmath180 .",
    "this gives rise to a dramatic simplification in the construction of the moment equations . in the equation for any desired moment",
    "we need to consider only those master equation terms related to the species that appear in that particular moment . in the diagrams , this means including only graph elements that are directly connected to the corresponding nodes .",
    "the complete set of translation rules from a given graph element to the corresponding terms in the moment equations is given in tables [ tab : moment_terms1 ] - [ tab : moment_terms3 ] .",
    "to demonstrate the construction of the moment equations we reconsider the reaction network shown in fig .",
    "[ fig4](a ) .",
    "first , we identify the relevant moments associated with the nodes , edges and loops in the network graph . in this particular network ,",
    "the nodes call for @xmath196 , @xmath197 and @xmath198 .",
    "the edges call for @xmath199 and @xmath200 .",
    "finally , the two loops in the graph require the inclusion of @xmath129 and @xmath130 .",
    "altogether , there are seven equations .",
    "let us begin with the equation for @xmath201 .",
    "this species is represented by a node connected to two edges and one loop . using our diagrammatic scheme",
    ", this equation takes the form    @xmath202    this equation simply consists of all the graph elements related to the species @xmath203 .",
    "that diagrammatic sum can be translated , using table [ tab : moment_terms1 ] , giving rise to the equation    @xmath204    the same diagrammatic equation [ eq .",
    "( [ eq : diag1 ] ) ] is used when writing the equation for the time derivative of @xmath129 . however , the translation rules from graph elements to equation terms are different and are given in table [ tab : moment_terms2 ] .",
    "using these rules we obtain    @xmath205    next , we construct the moment equation for @xmath206 . this time we need to include some additional graph elements , namely , those related to @xmath207",
    ", so the diagrammatic equation takes the form    @xmath208    this is an equation for a mixed second moment , that should be translated according to table [ tab : moment_terms3 ] .",
    "the resulting equation is    @xmath209    the last equation that we demonstrate explicitly is for the moment @xmath210 .",
    "this time the diagrammatic equation will include an additional graph element stating the fact that @xmath211 is produced by a reaction between the other two species in the network .",
    "the diagrammatic equation is    @xmath212    which , according to table [ tab : moment_terms1 ] translates to    @xmath213    this procedure enables an efficient and straightforward construction of the set of moment equations for any given graph , regardless of its complexity",
    ". the construction process can be easily automated into a computer program that receives the network structure as an input and provides the set of equations as an output .",
    "this opens the way to efficient stochastic modeling of complex reaction networks of any size .",
    "we have presented an efficient method for the stochastic simulation of complex reaction networks .",
    "the method is based on moment equations .",
    "it accounts correctly for the reaction rates not only for macroscopic populations , where rate equations apply , but also in the limit of low copy numbers where fluctuations dominate .",
    "the method exhibits several crucial advantages over existing techniques for stochastic simulations .",
    "the number of equations is reduced to the absolute minimum in a stochastic simulation , namely one equation for each reactive species and one equation for each reaction . for",
    "any given network the set of moment equations can be constructed easily and efficiently using a diagrammatic approach .",
    "the equations are linear , thus , for steady - state conditions they can be easily solved using algebraic methods .",
    "we have demonstrated the method for reactions taking place on dust - grain surfaces in interstellar clouds .",
    "we have shown that it applies very well even under the extreme interstellar conditions of low gas density and sub - micron grain sizes .",
    "the moment equations can be easily coupled to the rate equation models of interstellar gas - phase chemistry .",
    "therefore , the proposed method is expected to enable the incorporation of grain - surface chemistry into these models .",
    "we expect this method to be useful for the simulation of many other systems that exhibit a related mathematical structure @xcite .",
    "one such application is for reactions taking place on terrestrial surfaces such as metal catalysts in nanometric systems @xcite .",
    "another example is aerosol chemistry in stratospheric clouds , where complex reaction networks involving aerosol particles take place @xcite .",
    "the gas density is not nearly as low as in the interstellar clouds .",
    "however , the small size of the aerosol particles and the low density of some of the reactive species may require stochastic methods .",
    "another example is genetic networks in cells and bacteria @xcite .",
    "these networks describe the process of protein synthesis and its regulation .",
    "they include the interactions between genes , mrna s and proteins .",
    "since some of these components appear in low copy numbers , the simulation of these networks requires stochastic methods .",
    "graph element & equation term & reduced equation term + & & + @xmath214 & @xmath215 & @xmath216 + & & + & & + @xmath217 & @xmath218(@xmath219 ) & @xmath218(@xmath219 ) + & & + & & + & & + @xmath220 & @xmath195 & @xmath195 + & & + & & + @xmath221 & @xmath222 & @xmath222 + & & + & & + @xmath223{$i$ } } \\put(1,-1.875){\\circle{1.5 } } \\put(0,-2.875){\\makebox(2,2){$k$ } } \\end{picture } } $ ] & @xmath224(@xmath225 ) & @xmath224(@xmath225 ) + & & + & & +     graph element & equation term & reduced equation term + & & + @xmath214 & & + & & + & & + @xmath226 & & @xmath227(@xmath228 ) + & & + & & + @xmath220 & & @xmath195 + & & + & & + & & @xmath229 + & & + & & + & & @xmath224(@xmath225 ) + & & +        & @xmath233(@xmath234 & + @xmath235 & @xmath236 ) & + & & @xmath232 + & & + & & + & & + & & + @xmath223{$i(j)$ } } \\put(1,-1.875){\\circle{1.5 } } \\put(0,-2.875){\\makebox(2,2){$k$ } } \\end{picture } } $ ] & @xmath237 & @xmath232 + & & + & & +     molecules ( b ) on the surface of a grain vs. grain diameter , @xmath5 , under conditions of second - order kinetics .",
    "the number of adsorption sites , @xmath70 , is also shown .",
    "the results of the moment equations ( circles ) are in perfect agreement with the master equation ( solid line ) for all grain sizes . in the limit of large grains",
    "they also coincide with the rate equation ( dashed line ) .",
    ", width=480 ]     molecules ( b ) on the surface of a grain vs. grain diameter , @xmath5 , under conditions of first - order kinetics .",
    "the production rate obtained by the moment equations ( circles ) is in perfect agreement with the master equation ( solid line ) for all grain sizes .",
    "however , the population size deviates for large grains .",
    "the rate equation results are also shown ( dashed lines ) .",
    ", width=480 ]    , as obtained from the moment equations for a very large grain of diameter @xmath89 mm ( circles ) . under these conditions",
    "the rate equation is accurate . for @xmath238 ( second order kinetics ) ,",
    "the moment equations are in perfect agreement with the rate equation ( dashed line ) .",
    "this is in spite of the large population size . for @xmath239 ( first order kinetics )",
    ", the moment equations do not provide accurate results for the population size ; ( b ) the production rate of h@xmath0 molecules per grain vs. @xmath37 , as obtained from the moment equations ( circles ) .",
    "the results are in perfect agreement with those of the rate equation ( dashed line ) both for second order and for first order kinetics ( even when there is a deviation in the first moment ) . , width=432 ]        ) and o ( @xmath3 ) atoms on a grain vs. grain diameter , @xmath5 , obtained from the moment equations for the reaction network presented in fig .",
    "the results are in excellent agreement with the master equation ( solid line ) .",
    "the rate equation results are also shown ( dashed line ) .",
    "( b ) the production rates of h@xmath0 ( circles ) , h@xmath0o ( squares ) and o@xmath0 ( triangles ) per grain vs. @xmath5 , obtained by the moment equations .",
    "the results are in excellent agreement with the master equation ( solid line ) . in the limit of large grains",
    "they also coincide with the rate equations ( dashed line ) .",
    "note that the moment equations are valid both in the limit of small population sizes ( when @xmath5 is small ) , and even when the population is high ( large @xmath5s ) .",
    "the number of adsorption sites , @xmath70 , is also displayed .",
    ", width=480 ]    ) , o ( @xmath170 ) atoms and co molecules ( @xmath146 ) on a grain vs. grain diameter , @xmath5 , obtained from the moment equations for the reaction network presented in fig .",
    "the results are in excellent agreement with the master equation ( solid line ) .",
    "the rate equation results are also shown ( dashed line ) .",
    "( b ) the production rates of h@xmath0o ( circles ) , ch@xmath1oh ( squares ) and o@xmath0 ( triangles ) molecules on a grain vs. @xmath5 , obtained from the moment equations .",
    "the results are in agreement with the master equation ( solid line ) . for small grains ,",
    "the rate equation results ( dashed line ) show significant deviations . , width=432 ]"
  ],
  "abstract_text": [
    "<S> surfaces serve as highly efficient catalysts for a vast variety of chemical reactions . typically , such surface reactions involve billions of molecules which diffuse and react over macroscopic areas . </S>",
    "<S> therefore , stochastic fluctuations are negligible and the reaction rates can be evaluated using rate equations , which are based on the mean - field approximation . however , in case that the surface is partitioned into a large number of disconnected microscopic domains , the number of reactants in each domain becomes small and it strongly fluctuates . </S>",
    "<S> this is , in fact , the situation in the interstellar medium , where some crucial reactions take place on the surfaces of microscopic dust grains . in this case </S>",
    "<S> rate equations fail and the simulation of surface reactions requires stochastic methods such as the master equation . </S>",
    "<S> however , in the case of complex reaction networks , the master equation becomes infeasible because the number of equations proliferates exponentially . to solve this problem </S>",
    "<S> , we introduce a stochastic method based on moment equations . in this method the number of equations is dramatically reduced to just one equation for each reactive species and one equation for each reaction . </S>",
    "<S> moreover , the equations can be easily constructed using a diagrammatic approach . </S>",
    "<S> we demonstrate the method for a set of astrophysically relevant networks of increasing complexity . </S>",
    "<S> it is expected to be applicable in many other contexts in which problems that exhibit analogous structure appear , such as surface catalysis in nanoscale systems , aerosol chemistry in stratospheric clouds and genetic networks in cells . </S>"
  ]
}