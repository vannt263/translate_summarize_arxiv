{
  "article_text": [
    "with the development of new architectures and massively parallel codes , molecular dynamics ( md ) simulations have been applied to systems of increasing sizes , up to billions of atoms , and times , up to a few nanoseconds  @xcite .",
    "but md simulations still can not reach the time and length scales at which some complex phenomena , such as reactive waves in molecular systems , occur .",
    "a variety of mesoscopic methods have been designed to stretch these scales by several orders of magnitude , with decreasing predictive power compared to md .",
    "they generally consider fewer degrees of freedom and allow for larger timesteps since they do not need to track the interatomic vibrations and use softer potentials .",
    "dissipative particle dynamics ( dpd ) has been introduced as a coarse - grained mesoscopic model  @xcite which represents groups of atoms , typically forming one or several molecules , by a single particle .",
    "dpd particles interact through some potential energy ( usually , a soft potential ) while dissipative and stochastic forces are added to take into account the missing degrees of freedom .",
    "the magnitude of the fluctuation and dissipation forces are related through a fluctuation - dissipation relation , ensuring the sampling of the canonical ensemble  @xcite .",
    "dpd can however only be used when the temperature in the system is fixed , which prevents its application to nonequilibrium situations such as shock waves .",
    "dpd with conserved energy ( dpde )  @xcite has been introduced to cover such situations .",
    "the coarse - grained internal degrees of freedom in dpd are represented in this model by a single variable , called internal energy , which exchanges energy with the external degrees of freedom through a dissipation and fluctuation mechanism .",
    "this ensures the conservation of the total energy in the system and allows for its use in nonequilibrium situations such as the simulation of shock waves and reactive waves  @xcite .    however , dpde has some shortcomings on its own .",
    "while it is possible to choose the friction parameters without perturbing the equilibrium properties , as long as an appropriate fluctuation - dissipation relation is satisfied , it is still unclear whether it is possible to retrieve various dynamical properties such as the equilibration time between the internal and external degrees of freedom , and transport coefficients of the fluid ( _ e.g. _ self - diffusion , thermal conductivity , shear viscosity ,  )  @xcite .",
    "moreover , the fluctuations in dpde do not scale with the level of coarse - graining chosen to model the system and it is also questionable if one can satisfactorily represent several non - bonded particles by a single coarse - grained particle  @xcite .",
    "recent works such as  @xcite aim at providing firm theoretical grounds for the replacement of a single molecule by a thermal blob obeying dpde - like equations .",
    "such methods thus remains quite atomistic in their validity domains and do not allow to freely choose the level of resolution to be used .",
    "on the other hand , smoothed particle hydrodynamics ( sph )  @xcite is a particular lagrangian method to solve the navier - stokes equations .",
    "it has become a popular method in astrophysics  @xcite and in meshless simulations of fluid dynamics  @xcite .",
    "it is easy to implement since particles are used as interpolation nodes and no mesh is involved .",
    "however it does not account for thermal fluctuations which can be of importance for phenomena such as hydrodynamic instabilities  @xcite or for small fluid particles .    smoothed dissipative particle dynamics ( sdpd )  @xcite has been introduced to overcome the shortcomings of the previously mentioned methods .",
    "it blends the sph discretization of the navier - stokes equations with the thermal fluctuations of mesoscopic models , and thus allows to deal with hydrodynamics at the nanoscale .",
    "sdpd has in particular been used to study colloids  @xcite or polymer suspensions  @xcite .",
    "it has been shown that sdpd yields a consistent diffusion coefficient for a colloid in a sdpd bath  @xcite at any resolution .",
    "one of the main improvement of sdpd over dpde is the ability to select the desired level of resolution in the model by playing with a parameter fixing the number of molecules one mesoparticle stands for .",
    "this paves the way for multiscale simulations based on a concurrent coupling between models at different coarse - grained level , such as md and sdpd  @xcite , sdpd and navier - stokes  @xcite or even sdpd at various resolutions  @xcite .",
    "our aim in this work is to justify the use of sdpd in a multiscale setting by showing that sdpd can reproduce the thermodynamic properties of a microscopic system at any resolution .",
    "the method relies on fitting an equation of state obtained by md simulations to convey the physical information needed in sdpd .",
    "we will handle both equilibrium properties and dynamic properties in a nonequilibrium situation .",
    "we also present a new numerical scheme which preserve the invariants of the system for the integration of the full sdpd dynamics involving the evolutions of the positions , momenta and internal energies .",
    "this article is organized as follows .",
    "we first present in section  [ sec : equations ] a reformulation of the original sdpd equations in terms of the internal energy rather than entropy to increase the structural similarity between sdpd and dpde . in section  [ sec : schemes ]",
    ", we introduce a numerical scheme inspired by the ones used for dpde and study the energy conservation it provides . section  [ sec : results ] is devoted to the numerical study of the size consistency .",
    "we show that we are able to reproduce the microscopic equilibrium properties such as pressure or temperature for a wide range of resolutions in section  [ sec : pg ] and  [ sec : lj ] .",
    "we also study the effect of the sdpd resolution in the simulation of shock waves in section  [ sec : shocks ] .",
    "some conclusions are gathered in section  [ sec : conclusion ] , while more technical arguments are postponed to the appendix .",
    "at the hydrodynamic scale , the dynamics of the fluid is governed by the navier - stokes equations  , which read in their lagrangian form when the heat conduction is neglected ( for time @xmath0 and position @xmath1 in a domain @xmath2 ) : @xmath3 the material derivative used in the lagrangian description is defined as @xmath4 the unknowns are @xmath5 the density of the fluid , @xmath6 its velocity , @xmath7 its internal energy and @xmath8 the stress tensor : @xmath9 where @xmath10 is the pressure of the fluid , @xmath11 the shear viscosity and @xmath12 the bulk viscosity .    in the following ,",
    "we first present the sph discretization of the navier - stokes equations in section  [ sec : sph ] before introducing the original sdpd equations proposed by espaol and revenga  @xcite in section  [ sec : original - sdpd ] .",
    "we then formulate these equations in terms of internal energy variables in section  [ sec : nrj - sdpd ] by considering a fluctuation / dissipation mechanism structurally very similar to the one appearing in dpde  @xcite .",
    "this reformulation in particular allows us to more easily construct stable and accurate numerical schemes which preserve the invariants of the system , such as the energy ( see section  [ sec : schemes ] ) .",
    "it also provides a first step towards a more straightforward coupling with dpde although this issue is not discussed in this work . in section  [ sec : thermo ] , we study the thermodynamic properties of the reformulated sdpd equations .      smoothed particle hydrodynamics  @xcite is a lagrangian discretization of the navier - stokes equations  ( [ eq : navier - stokes ] ) on a finite number @xmath13 of fluid particles which play the role of interpolation nodes .",
    "these fluid particles are associated with a portion of fluid of mass @xmath14 .",
    "they are located at positions @xmath15 and have a momentum @xmath16 .",
    "the internal degrees of freedom are represented by an entropy @xmath17 .      in the sph discretization ,",
    "the field variables are approximated as a weighted average of their values at the particle positions .",
    "the weighting function @xmath18 is often referred to as a smoothing kernel function .",
    "the kernel function is generally chosen non negative , normalized as @xmath19 , regular and with compact support  @xcite .",
    "we denote by @xmath20 the smoothing length of the kernel @xmath18 so that @xmath21 if @xmath22",
    ". in the sequel , we use the notation @xmath23 .",
    "a variety of smoothing kernels have been introduced for the sph discretization and compared in the litterature  @xcite .",
    "a precise analysis of the kernel properties is however made difficult by the superposition of the two approximations made in the sph discretization : the kernel approximation which consists in replacing the function @xmath24 by a smoothed version of it @xmath25 and the particle approximation where the integral in equation   is replaced by a summation over the particles . the kernel approximation can be studied analytically and its accuracy improved by the choice of higher order kernels .",
    "the particle approximation depends by nature on the particle configuration and can lead to undesired behaviors and instabilities such as particle clustering  @xcite .",
    "numerical simulations are thus required to evaluate the quality of the kernel . in this work , since we do not focus on an exhaustive study of the influence of the kernel on the thermodynamic properties , we considered only two kernels : the lucy function proposed early on  @xcite : @xmath26 and , alternatively , a cubic spline  @xcite , whose expression reads @xmath27        \\displaystyle \\frac{16}{\\pi h^3 } \\left(1-\\frac{r}{h}\\right)^3 & \\displaystyle \\text",
    "{ if } \\frac{h}{2 } \\leq r \\leq h,\\\\[1em ]        0 & \\displaystyle   \\text { if } r \\geq h.      \\end{array }    \\right.\\ ] ] the field variables are then approximated as @xmath28 where @xmath29 denotes the value of the field @xmath24 on the particle  @xmath30 .",
    "the approximation of the gradient @xmath31 is obtained by deriving equation  , which yields @xmath32 in order to have more explicit expressions , we introduce the function @xmath33 such that @xmath34 . for the lucy function  ( [ eq : sdpd - lucy - w ] ) , @xmath35 while , for the cubic spline  ( [ eq : sdpd - cubic - w ] ) , @xmath36        \\displaystyle \\frac{48}{\\pi h^5 } \\frac1{r } \\left(1-{\\frac{r}{h}}\\right)^2 & \\displaystyle \\text",
    "{ if } \\frac{h}{2 } \\leq r \\leq h,\\\\[1em ]        0 & \\displaystyle \\text { if } r \\geq h.      \\end{array }      \\right.\\ ] ] the gradient approximation can then be rewritten as @xmath37    in order to simplify the notation , we define the following quantities for two particles @xmath30 and @xmath38 : @xmath39 we can associate a density @xmath40 and volume @xmath41 to each particle as @xmath42 the corresponding approximations of the density gradient evaluated at the particle points read @xmath43        -m \\sum\\limits_{j=1}^n f_{ij}{\\boldsymbol{r}}_{ij } & \\text { if } j = i .",
    "\\end{array }    \\right.\\ ] ]      as in the navier - stokes equations , an equation of state is required to close the set of equations provided by the sph discretization .",
    "this equation of state relates the internal energy @xmath44 associated with particle @xmath30 with its density @xmath45 ( as defined by  ) and its entropy @xmath46 through an internal energy function @xmath47 the equation of state @xmath48 can be computed by microscopic simulations or by an analytic expression modeling the material behavior ( see section  [ sec : results ] for some examples ) .",
    "it is then possible to define , in accordance with the equation of state , a temperature @xmath49 pressure @xmath50 and heat capacity at constant volume @xmath51(s,\\rho).\\ ] ] we assign to each particle the corresponding temperature @xmath52 , pressure @xmath53 and heat capacity @xmath54 as @xmath55 to simplify the notation , we omit in sections  [ sec : eom - sph ] and  [ sec : original - sdpd ] the dependence of @xmath52 , @xmath53 and @xmath54 on the variables @xmath46 and @xmath56 .",
    "the sph discretization can be split into two elementary dynamics , the first one being a conservative dynamics derived from the pressure gradient in the stress tensor   and the last one a dissipative dynamics stemming from the viscous terms in  .    the elementary force between particles @xmath30 and @xmath38 arising from the discretization of the pressure gradient in the navier - stokes momentum equation reads @xmath57 the corresponding total force is actually conservative since it can be rewritten in a hamiltonian form as @xmath58 where @xmath59 this allows us to write the conservative part of the dynamics in hamiltonian form as @xmath60 this dynamics preserves by construction the total momentum @xmath61 and the total energy @xmath62 .",
    "in order to give the expression of the viscous part of the dynamics , we define the relative velocity for a pair of particles @xmath30 and @xmath38 as @xmath63 the viscous terms in the momentum continuity equation result in an elementary pairwise dissipative force @xmath64 where the friction coefficients are defined from the fluid viscosities @xmath11 and @xmath12 appearing in the stress tensor  ( [ eq : stress - tensor ] ) as @xmath65 the pairwise dissipative elementary dynamics can be written as @xmath66 the third equation on the entropy is such that the total energy @xmath62 is preserved .",
    "in addition , galilean invariance is ensured by the dynamics  ( [ eq : sdpd - diss - espanol ] ) since @xmath67 .      smoothed dissipative particle dynamics  @xcite is a top - down mesoscopic method relying on the sph discretization of the navier - stokes equations with the addition of thermal fluctuations which are modeled by a stochastic force .",
    "sdpd is a set of stochastic differential equations for the variables used in the original sdpd equations : the positions @xmath68 , the momenta @xmath69 and the entropies @xmath70 for @xmath71 .",
    "the fluctuation terms read @xmath72 where the fluctuation amplitudes are given by @xmath73 these coefficients are determined in  @xcite through the generic framework  @xcite . here , for @xmath74 , @xmath75 are @xmath76 matrices of independent standard brownian motions such that @xmath77 .",
    "we denote by @xmath78 the symmetric traceless part of @xmath75 .",
    "the random fluctuation term is balanced by an extra dissipative force @xmath79 with @xmath80    the dissipative and stochastic forces produce a variation of the entropy which is accounted for by a dynamics on the entropy @xmath46 in order to ensure the conservation of the energy @xmath62 .",
    "the elementary fluctuation / dissipation dynamics reads @xmath81 where @xmath82 .",
    "the dynamics  ( [ eq : sdpd - fluct - espanol ] ) replaces the dissipative dynamics  ( [ eq : sdpd - diss - espanol ] ) of the sph discretization .",
    "it can be shown that it preserves the energy @xmath62 and the total momentum .",
    "finally , the complete set of equations of motion for the original sdpd  @xcite is obtained by concatenating the conservative dynamics  ( [ eq : sdpd - cons ] ) and the fluctuation / dissipation dynamics  ( [ eq : sdpd - fluct - espanol ] ) as @xmath83{{\\rm d}}t \\\\      & + \\left(a_{ij}{{\\rm d}}{\\boldsymbol{\\overline{w}}}_{ij}+\\frac13b_{ij}{\\rm tr}({{\\rm d}}{\\boldsymbol{w}}_{ij}){{\\boldsymbol{\\mathrm{id}}}}\\right){\\boldsymbol{e}}_{ij},\\\\      t_i{{\\rm d}}s_i = & \\sum_{j\\neq i } \\frac12\\mathscr{d}_{ij}\\left(a_{ij}{\\boldsymbol{v}}_{ij}^2+\\left(\\frac{a_{ij}}3+b_{ij}\\right)({\\boldsymbol{v}}_{ij}^t{\\boldsymbol{e}}_{ij})^2\\right){{\\rm d}}t\\\\      & -\\frac{8k_{\\rm b}}{m}\\frac{t_it_j}{t_i+t_j}\\left(\\frac{10}3a_{ij}+b_{ij}\\right){{\\rm d}}t\\\\      & -\\frac12 { \\boldsymbol{v}}_{ij}^t\\left(a_{ij}{{\\rm d}}{\\boldsymbol{\\overline{w}}}_{ij}+\\frac13b_{ij}{\\rm tr}({{\\rm d}}{\\boldsymbol{w}}_{ij}){{\\boldsymbol{\\mathrm{id}}}}\\right){\\boldsymbol{e}}_{ij}.    \\end{aligned }    \\right.\\ ] ] the dynamics   preserve the total momentum @xmath84 and the total energy @xmath62 since the elementary dynamics  ( [ eq : sdpd - cons ] ) and  ( [ eq : sdpd - fluct - espanol ] ) conserve these invariants .",
    "the generic framework  @xcite ensures that measures of the form @xmath85 are invariant for the dynamics  .",
    "we propose in this section a reformulation of the original sdpd equations  ( [ eq : sdpd - espanol ] ) in terms of positions , momenta and energies @xmath86 .",
    "the corresponding phase space is denoted by @xmath87 .",
    "we also propose a somewhat simpler expression for the fluctuation term in analogy with the stochastic term used in dpde  @xcite .",
    "the new expressions for the fluctuation / dissipation forces are chosen to ensure the same invariant measure as in the original sdpd equations .",
    "moreover , the same friction forces appear in both formulations .",
    "the interest of this reformulation is twofold : first , it allows for a better control of the energy conservation in the integration scheme , second , it is a first step towards a more straightforward coupling with dpde .    as in section",
    "[ sec : sph ] , we need an input equation of state in order to close the equations . in the energy formulation , the equation of state links the entropy @xmath46 with the internal energy @xmath44 and the density @xmath45 of the particles as @xmath88 the pressure , temperature and heat capacity are then determined accordingly as @xmath89(\\varepsilon,\\rho),\\\\      \\mathcal{p}(\\varepsilon,\\rho ) & = -\\frac{\\rho^2}{m}\\left[\\frac{\\partial_{\\rho}\\mathcal{s}}{\\partial_{\\varepsilon}\\mathcal{s}}\\right](\\varepsilon,\\rho),\\\\      \\mathcal{c}(\\varepsilon,\\rho ) & = -\\left[\\frac{(\\partial_{\\varepsilon } \\mathcal{s})^2}{\\partial_{\\varepsilon}^2\\mathcal{s}}\\right](\\varepsilon,\\rho ) ,    \\end{aligned}\\ ] ] and assigned to each particle as @xmath90 as in the previous sections , we now omit the dependence of @xmath52 , @xmath53 and @xmath54 on the variables @xmath44 and @xmath56 .",
    "we keep the conservative part of the dynamics  ( [ eq : sdpd - cons ] ) . in order to reformulate it in terms of internal energies ,",
    "we compute the associated variation in the energy , expressed in the new set of independent variables @xmath91 as @xmath92 since a change of variables should not change the energy , @xmath93 defined by   and @xmath94 are related by @xmath95 the dynamics  ( [ eq : sdpd - cons ] ) being isentropic , the induced energy variation is simply given by @xmath96 from the definition  ( [ eq : sdpd - rho - v ] ) of the density and volume of a particle , the infinitesimal volume variation reads @xmath97 with @xmath98 given by @xmath99 therefore , the conservative part of the dynamics can be rewritten as @xmath100 let us emphasize that the indices @xmath30 and @xmath38 do not play a symmetrical role in the evolutions of the internal energies , although the conservative forces are symmetric .",
    "this asymmetry is a consequence of the fact that the energy variation  ( [ eq : energy - variation ] ) for a given particle only involves the volume variation of this particle .    in the spirit of dpde",
    ", we choose a pairwise fluctuation and dissipation term for @xmath101 of the following form @xmath102{{\\rm d}}t -\\frac12 { \\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}{{\\rm d}}{\\boldsymbol{b}}_{ij},\\\\      { { \\rm d}}\\varepsilon_j & = \\frac12\\left[{\\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\gamma}}_{ij}{\\boldsymbol{v}}_{ij } - \\frac{{\\textrm{tr}}({\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t)}{m}\\right]{{\\rm d}}t -\\frac12 { \\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}{{\\rm d}}{\\boldsymbol{b}}_{ij } ,    \\end{aligned }    \\right.\\ ] ] where @xmath103 is a @xmath104-dimensional vector of standard brownian motions , @xmath105 and @xmath106 are @xmath76 symmetric matrices . in the dynamics",
    ", the equations acting on the momenta preserve the total momentum in the system .",
    "furthermore , as in dpde , the equations for the energy variables are determined to ensure the conservation of the total energy @xmath107 . as @xmath108 , it calculus yields the resulting equations in  .    for the friction and fluctuation coefficients , we consider matrices of the form @xmath109 with the projection matrices @xmath110 and @xmath111 given by @xmath112    using such a decomposition for the friction and fluctuation matrices , the dynamics  ( [ eq : sdpd - simple - fluct ] ) is obtained by superposing the following dynamics for @xmath113 : @xmath114{{\\rm d}}t\\\\      & -\\frac12 \\sigma_{ij}^{\\theta}{\\boldsymbol{v}}_{ij}^t{{\\boldsymbol{p}}}_{ij}^{\\theta}{{\\rm d}}{\\boldsymbol{b}}_{ij},\\\\      { { \\rm d}}\\varepsilon_j = & \\ , \\frac12\\left[\\gamma_{ij}^{\\theta}{\\boldsymbol{v}}_{ij}^t{{\\boldsymbol{p}}}^{\\theta}{\\boldsymbol{v}}_{ij } - \\frac{(\\sigma_{ij}^{\\theta})^2}{m}{\\textrm{tr}}({{\\boldsymbol{p}}}_{ij}^{\\theta})\\right]{{\\rm d}}t\\\\      & -\\frac12 \\sigma_{ij}^{\\theta}{\\boldsymbol{v}}_{ij}^t{{\\boldsymbol{p}}}_{ij}^{\\theta}{{\\rm d}}{\\boldsymbol{b}}_{ij}.    \\end{aligned }    \\right.\\ ] ] the choice @xmath115 with the coefficients @xmath116 and @xmath117 defined in section  [ sec : eom - sph ] ,",
    "ensures that measures of the form @xmath118 are left invariant by the elementary dynamics   ( see appendix  [ sec : app - minv ] for the proof ) . note that @xmath119 is just obtained from the measure @xmath120 defined in   by the change of variables @xmath121 . as our derivation shows , other choices",
    "are possible for the coefficients @xmath122 and @xmath123 ( see   in section  [ sec : minv - fd ] ) .",
    "this may be of interest since it is possible to choose a constant fluctuation magnitude @xmath123 while the friction coefficient @xmath122 still depends on the configuration of the system through the positions @xmath56 and the internal energies @xmath44 and @xmath124 as @xmath125 +   \\frac{(\\sigma_{ij}^{\\theta})^2}{k_{\\rm b } } \\frac{t_i+t_j}{t_it_j } \\right).\\ ] ] such a choice would further increase the similarity with dpde and simplify the numerical discretization .",
    "however , in this work , we stick to the choice  ( [ eq : sdpd - gamma - sigma ] ) which yields the same friction terms as in the original sdpd equations  .    as a result , the sdpd equations of motion reformulated in the position , momentum and internal energy variables read @xmath126{{\\rm d}}t\\\\      & - \\frac12 { \\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}{{\\rm d}}{\\boldsymbol{b}}_{ij } ,    \\end{aligned }    \\right.\\ ] ] with @xmath106 and @xmath105 given by   and  ( [ eq : sdpd - gamma - sigma ] ) .",
    "the dynamics   preserves the total momentum @xmath84 and the total energy @xmath107 since all the elementary sub - dynamics ensure these conservations ( see appendix  [ sec : app - cons ] for the proof ) .",
    "let us also emphasize that the reformulated dynamics involves only a @xmath104-dimensional brownian motion @xmath103 for each pair instead of the @xmath127-dimensional brownian motion @xmath128 appearing in the original dynamics  .",
    "we present in this section expressions for the estimators of thermodynamic quantities like temperature and pressure .",
    "following the same ideas as for dpde  @xcite , we rely on a thermodynamic equivalence with an appropriate canonical measure to make the computations tractable .",
    "although the dynamics  ( [ eq : sdpd - energy ] ) leaves any measure of the form   invariant ( as shown in appendix  [ sec : app - minv ] ) , there are no mathematical results about its ergodicity since the fluctuation may be degenerate . even for dpd , ergodicity is known to hold only for simple one - dimensional systems  @xcite . since the total energy and the total momentum are conserved , we assume the ergodicity of the dynamics   with respect to the measure @xmath129 with @xmath130 the initial total energy , @xmath131 the initial momentum and @xmath132 a normalization constant . under this assumption , the average of some observable @xmath133 can be estimated as @xmath134 where @xmath135 is the solution at time @xmath136 of  .",
    "we assume in the following that @xmath137 .",
    "this can be achieved by adopting the center of mass reference frame .    to justify the expressions of thermodynamic estimators of temperature , it is convenient to introduce the canonical measure @xmath138+\\frac{s_i(\\varepsilon_i,{\\boldsymbol{q}})}{k_{\\rm b}}\\right)}{t_i(\\varepsilon_i,{\\boldsymbol{q}})}\\,{{\\rm d}}{\\boldsymbol{q}}\\,{{\\rm d}}{\\boldsymbol{p}}\\,{{\\rm d}}\\varepsilon ,    \\end{aligned}\\ ] ] where @xmath139 is chosen such that @xmath140 and @xmath141 a normalization constant . in the thermodynamic limit , @xmath142 and @xmath143",
    "are expected to be equivalent in the same way that the microcanonical and canonical measures are equivalent for systems described only in terms of @xmath56 and @xmath144 .    under the canonical measure  ( [ eq : sdpd - minveq ] ) , the thermodynamic temperature @xmath145 can be estimated from the kinetic energy as @xmath146 which motivates the use of the kinetic temperature @xmath147 as an estimator of @xmath148 . under some assumptions on the equation of state  , which hold for instance for the ideal gas equation of state ( see equation   below ) , namely @xmath149{}-\\infty,\\\\      & \\quad \\mathcal{s}(\\rho,\\varepsilon ) - k_{\\rm b}\\beta\\varepsilon\\xrightarrow[\\varepsilon\\to+\\infty]{}-\\infty ,    \\end{aligned}\\ ] ]",
    "the internal temperature also provides an estimator of the thermodynamic temperature since @xmath150 the temperature @xmath148 can therefore be estimated from the average of the internal temperature in the system as @xmath151 let us stress that the internal temperature estimator for sdpd relies on an arithmetic average in contrast to dpde where an harmonic mean should be used  @xcite .",
    "the thermodynamic pressure in the system is defined as the derivative of the free energy @xmath152 with respect to the total volume @xmath153 of the system . with the previous ergodicity assumption",
    ", the pressure can be estimated as @xmath154 where @xmath155 is the kinetic pressure @xmath156 and @xmath157 is the virial pressure @xmath158 a detailed proof of the equalities  ( [ eq : estim - tint ] ) and  ( [ eq : estim - pressure ] ) can be read in appendix  [ sec : app - tp ] .",
    "one of the important feature of sdpd is that it is possible to prescribe a size for the particles , which enables a multiscale approach  @xcite . in the following ,",
    "we study the behavior of sdpd when the mass of the particles varies ( see section  [ sec : results ] ) . in this perspective",
    ", the mass of the fluid particles is given by @xmath159 , where @xmath160 is the mass of one microscopic particle ( _ i.e. _ a molecule ) .",
    "it is in fact convenient to define a system of reduced units for each size @xmath161 : @xmath162 where @xmath163 is the mass unit , @xmath164 the length unit , @xmath165 the energy unit and @xmath166 the average density of the fluid .",
    "with such a set of reduced units , the time unit is @xmath167    the smoothing length @xmath168 defining the cut - off radius in   and   also needs to be adapted to the size of the sdpd particles so that the approximations  ( [ eq : sph - approx ] ) continue to make sense . in order to keep the average number of neighbors roughly constant in the smoothing sum",
    ", @xmath168 should be rescaled as @xmath169 in this work , we have taken @xmath170 , which correspond to a typical number of 60 - 70 neighbors , a commonly accepted number  @xcite .",
    "to our knowledge , there are very few works providing numerical schemes for the integration of the full energy - conserving sdpd such as gatsonis _ et al . _",
    "@xcite who mix a velocity - verlet scheme for the update of positions and momenta and a runge - kutta scheme for the entropy updates . in such works ,",
    "no specific attention is devoted to the preservation of the invariants such as the energy .",
    "let us also mention that most of the work published for sdpd resort to a simplified version of the dynamics where internal temperatures are kept fixed at @xmath171 .",
    "the equations of motion are then integrated using a verlet scheme or more specific splitting schemes designed for sdpd  @xcite .",
    "these schemes are very much inspired by integration schemes designed for dpd such as the shardlow splitting scheme  @xcite .",
    "when considering the dynamics  ( [ eq : sdpd - espanol ] ) or  ( [ eq : sdpd - energy ] ) , the preservation of the invariants , especially the energy , requires some care in the design of the numerical scheme .",
    "other desirable properties include stability , accuracy and parallelizability .",
    "exhibiting a scheme satisfying all these constraints is not an easy task .",
    "there is , to our knowledge , no numerical scheme for sdpd able to meet these requirements . though the development of such an integration scheme is not the purpose of this work , we suggest in section  [ sec : splitting ] a convenient scheme inspired by works done for dpde  @xcite",
    ". the increased similarity of the reformulated dynamics  ( [ eq : sdpd - energy ] ) with dpde makes it indeed possible to resort to similar integration schemes in both methods .",
    "we analyze the properties of the scheme in terms of energy conservation in section  [ sec : vnum ] .",
    "a more detailed comparison with existing schemes ( such as  @xcite ) and adaptions of other dpde schemes to the sdpd setting is currently in progress .",
    "we propose a numerical scheme to integrate the stochastic dynamics  ( [ eq : sdpd - energy ] ) obtained from the superposition of the elementary dynamics  ( [ eq : sdpd - nrj - cons ] ) and  ( [ eq : sdpd - simple - fluct ] ) .",
    "we denote by @xmath172 the time step .",
    "since the sdpd and dpde equations have a similar structure , we follow the ideas introduced for the discretization of the dpd equations  @xcite and their adaptation to the dpde model  @xcite .",
    "the corresponding schemes are splitting schemes , which are a popular method to integrate differential equations ( as proposed in  @xcite ) and stochastic differential equations .",
    "the scheme presented in the following is based on a trotter splitting of the dynamics  .",
    "first the conservative dynamics   is integrated with a velocity - verlet scheme ( see   below ) during a time @xmath172 , then the fluctuation / dissipation part   is approximately evolved during a time @xmath172 by successive pairwise updates ( see   below ) .",
    "we first consider the conservative dynamics   formulated in terms of entropies as  .",
    "since it is of hamiltonian nature , it is natural to solve this part of the dynamics with a symplectic scheme such as the well - known velocity verlet scheme  @xcite which is able to conserve the energy in average in the long term  @xcite : @xmath173 since the entropy @xmath46 of each particle is preserved by the integration of this reversible dynamics , the internal energy @xmath44 after this step can be computed by inverting the equation of state as @xmath174 with the updated density @xmath175 .",
    "if no analytic form is available for @xmath48 , a numerical inversion may be required ( see section  [ sec : lj ] for more details ) .    to deal with the fluctuation / dissipation part",
    ", we use a modification of the shardlow scheme  @xcite which relies on a splitting of the fluctuation / dissipation into pairwise elementary dynamics  , each pair being handled successively . if we consider the internal energies to be constant ,",
    "the equations on the momenta become an ornstein - uhlenbeck process that can be solved analytically . as suggested by marsh  @xcite , and later used in  @xcite ,",
    "it is possible to ensure the conservation of the energy by a redistribution of the kinetic energy variation induced by the dissipative and stochastic forces in the internal energies .",
    "we define the kinetic energy of the pair of particles @xmath30 and @xmath38 as @xmath176 we also introduce , for @xmath177 @xmath178    for a random gaussian vector @xmath179 , we define the updated momenta as @xmath180      { \\boldsymbol{p}}_j    \\end{pmatrix}\\\\    & \\quad +   \\sum\\limits_{\\theta\\in\\{\\parallel,\\perp\\ } } { { \\boldsymbol{p}}}_{ij}^{\\theta}\\left[\\frac{m}2   ( \\alpha_{ij}^{\\theta}-1 ) { \\boldsymbol{v}}_{ij } + \\zeta_{ij}^{\\theta } { \\boldsymbol{g}}_{ij } \\right ]    \\begin{pmatrix }      { \\boldsymbol{1}}\\\\[.5em ]      { \\boldsymbol{-1 } }    \\end{pmatrix } , \\end{aligned}\\ ] ] and the induced kinetic energy variation when changing @xmath181 to @xmath182 as @xmath183 we would like to stress that @xmath184 and @xmath185 include cut - off functions in their expressions , which limits the range of the fluctuation / dissipation interactions and allows an evaluation of the corresponding forces scaling linearly with the system size . the integration of the elementary fluctuation / dissipation dynamics   then proceeds as follows .",
    "we denote by @xmath186 and @xmath187 the momentum and internal energy at the moment just before the dynamics for the pair @xmath188 is integrated : @xmath189 and @xmath190 have thus been obtained by performing a step of the verlet scheme   and by integrating the previous pairs .",
    "we generate a vector of 3 standard gaussian variables @xmath191 .",
    "the integration of the pair @xmath188 consists in replacing @xmath192 by @xmath193        \\displaystyle \\overline{\\varepsilon}_i^{n , ij } + \\frac12\\delta_{{\\boldsymbol{\\pi}}}e_{\\rm kin}({\\boldsymbol{\\overline{p}}}_i^{n , ij},{\\boldsymbol{\\overline{p}}}_j^{n , ij},\\overline{\\varepsilon}_i^{n , ij},\\overline{\\varepsilon}_j^{n , ij},{\\boldsymbol{g}}_{ij}^n)\\\\[.5em ]        \\displaystyle \\overline{\\varepsilon}_j^{n , ij } + \\frac12\\delta_{{\\boldsymbol{\\pi}}}e_{\\rm kin}({\\boldsymbol{\\overline{p}}}_i^{n , ij},{\\boldsymbol{\\overline{p}}}_j^{n , ij},\\overline{\\varepsilon}_i^{n , ij},\\overline{\\varepsilon}_j^{n , ij},{\\boldsymbol{g}}_{ij}^n )      \\end{pmatrix}.\\ ] ] as a consequence of the energy redistribution , the total energy is exactly conserved by these elementary updates .",
    "the final scheme for the integration of the reformulated dynamics consists in the superposition of the verlet scheme   and of the shardlow - like scheme   for all pairs @xmath194 .",
    "this scheme is essentially sequential as it requires considering each pair of particles one after another .",
    "the availability of parallel integration schemes is obviously crucial to apply the method to large physical systems .",
    "it is still a challenge to design an accurate and efficient parallel algorithm for this kind of stochastic dynamics .",
    "some recent results were obtained for dpde with a parallelization of shardlow - like algorithms  @xcite or with the splitting with energy reinjection integration ( ser ) which allows for an easy parallelization at the cost of a larger energy drift  @xcite .",
    "the ser scheme has been introduced for dpde but the similarities between the dpde and sdpd equations make it possible to adapt ser for the dynamics  .    the two parts of the scheme separately ensure a good energy conservation : the velocity - verlet scheme   preserves energy in average while the algorithm   preserves it exactly .",
    "however , the overall scheme obtained by superposing   and   can lead to energy drifts as observed in dpde  @xcite ( see section  [ sec : vnum ] ) .",
    "a standard numerical analysis shows that the scheme is of weak order 1 so that the error on average properties is of order @xmath172  @xcite .      to validate our numerical scheme , we consider the ideal gas , whose equation of state is given by @xmath195 where @xmath161 is the size of the sdpd particles .",
    "we recall that this equation of state satisfies the conditions  .",
    "the equation of state is formulated in the reduced units introduced in section  [ sec : scaling - sdpd ] .",
    "we first check the energy conservation for different particle sizes @xmath161 .",
    "the scheme presented in section  [ sec : splitting ] displays a linear drift in energy with respect to the simulation time ( see the inset in figure  [ fig : sdpd - energy - drift ] ) .",
    "the results have been obtained by averaging over @xmath196 realizations of the dynamics for a total time @xmath197 for each time step @xmath172 and size @xmath161 .",
    "we choose a unitary mass @xmath198  kg .",
    "the system is initialized as follows : the particles are initially located on a simple cubic lattice at density @xmath199  kg.m@xmath200 .",
    "their velocities are distributed according to a normal distribution with variance corresponding to a temperature @xmath201  k. the internal energies are chosen so that @xmath202 with the density @xmath45 evaluated from the initial distribution of the positions . unless otherwise specified , all the numerical results presented in this work are obtained by resorting to this initialization method .",
    "also , in all the simulations of this work , the bulk viscosity is neglected while the shear viscosity is chosen as @xmath203  pa.s .    to analyze the error in the energy conservation , we compute , for each timestep @xmath172 and size @xmath161 , the drift rate @xmath204 defined as the slope of the energy drift .",
    "we evaluate @xmath204 by fitting a linear function on the energy with a least - square minimization .",
    "the drift rate @xmath204 is represented in figure  [ fig : sdpd - energy - drift ] as a function of @xmath172 for @xmath205 , @xmath206 and @xmath207 .     as a function of the time step @xmath172 for the integration of sdpd with the scheme presented in section",
    "[ sec : splitting ] .",
    "the inset represents the average time - dependent energy drift for @xmath207 . ]",
    "assuming that the drift @xmath204 can be written as @xmath208 we find , by performing a least - square fit in a log - log scale , that @xmath209 is independent of @xmath161 , with @xmath210 .",
    "the prefactor @xmath211 varies with the mass of the particle . here",
    "we estimate @xmath212 , @xmath213 and @xmath214 .",
    "this suggests a way to choose the timestep to obtain a given drift rate : we perform a preliminary run with some timestep and measure the drift rate in this simulation .",
    "the power law , independent of @xmath161 , then allows us to estimate the timestep needed to keep the energy drift below a given threshold .",
    "the results of figure  [ fig : sdpd - energy - drift ] also show that , for larger particle sizes @xmath161 , we can increase the timestep in reduced units for a given drift rate , which allows us to integrate over longer times when using a coarse resolution .",
    "in this section , we study how the properties predicted by sdpd are influenced by the choice of the resolution , namely the size of the particles .",
    "we first study the size consistency of sdpd at equilibrium for both the ideal gas equation of state   ( see section  [ sec : pg ] ) and an equation of state optimized for a lennard - jones fluid  @xcite ( see section  [ sec : lj ] ) .",
    "we then consider nonequilibrium situations with the simulation of shock waves in section  [ sec : shocks ] .",
    "we first study a sdpd system with the ideal gas equation of state   at different masses @xmath159 with @xmath198  kg .",
    "we run simulations of a system of @xmath215 particles initialized according to the method described in section  [ sec : vnum ] at density @xmath216  kg.m@xmath200 and temperature @xmath217  k. the number of iterations is fixed to @xmath218 .",
    "the timestep is chosen for each @xmath161 such that the drift in relative energy is less than @xmath219 after @xmath220 iterations , which gives @xmath221 for @xmath205 in reduced units .    under the invariant measure  ,",
    "the momenta are distributed according to a normal distribution with mean @xmath222 and variance @xmath223 ( so that the variance of the velocities scales as @xmath224 ) , which is well recovered in our simulations .",
    "moreover , thanks to the analytic form of the equation of state  , we can determine the theoretical distribution of the internal energies . by integrating out the positions and momenta in the invariant measure  , the marginal law for the internal energy is given by @xmath225 where @xmath226 is the heat capacity in the equation of state   and",
    "@xmath227 is the gamma function .",
    "we check that we recover this distribution in our simulations for @xmath228 , @xmath205 and @xmath206 in figure  [ fig : pg - sdpd - eint ] .     of the particles .",
    "the simulation results ( histograms ) are compared to analytic distribution ( solid line ) . ]",
    "we now study the evolution of the average pressure and temperature with respect to the particle size for the lucy kernel   and the cubic kernel  .",
    "the pressure is estimated according to  .",
    "there are two temperature estimators : the kinetic temperature   and the internal temperature  .",
    "we compare the simulation results to the values given by the equation of state  .",
    "small biases ( around @xmath229 ) are observed for small particle sizes but , as predicted by equations   and  , the kinetic and internal temperatures are in excellent agreement with the equation of state as soon as @xmath230 .",
    "there is no theoretical result predicting a perfect agreement of the pressure obtained by sdpd with the equation of state .",
    "however , the results obtained from sdpd simulations with both the lucy kernel and the cubic kernel match the pressure from the equation of state with a maximum of @xmath231 difference for sizes varying from @xmath228 to @xmath232 . the thermodynamic limit for pressure",
    "is reached for sizes @xmath233 .",
    "let us however mention that we observe some metastability issues at large masses for the lucy kernel due to particle clumping .",
    "this leads us to prefer the cubic kernel in the following computations .",
    "+      we discuss in this section the size consistency of properties estimated for a more realistic fluid of lennard - jones type . in a fully atomistic model",
    ", particles interactions can be modeled by a pairwise potential of lennard - jones type : @xmath234.\\ ] ] we use the standard parameters for argon ( @xmath235  m , @xmath236  j , @xmath237  kg ) . for sdpd",
    ", we use the equation of state for lennard - jones fluids presented in  @xcite .",
    "it is based on microscopic simulations carried out with md in the nvt ensemble .",
    "the helmholtz free energy @xmath238 is fitted as a function of density and temperature on a modified form of the benedict - webb - rubin equation of state  @xcite , with 33 parameters .",
    "the useful quantities for sdpd , like the internal energy @xmath239 , the entropy @xmath240 , the pressure @xmath241 and the heat capacity @xmath242 , are then deduced from the free energy as @xmath243 since we use the internal energy as our primary variable , we perform a newton inversion algorithm to find the temperature corresponding to a given internal energy @xmath44 and density @xmath40 whenever we need to compute the associated pressure or temperature .",
    "denoting the temperature at iteration @xmath244 by @xmath245 , we initialize the algorithm with @xmath246 , with @xmath148 the thermodynamic temperature , and iterate until the relative residual @xmath247 decreases below a threshold @xmath248 . usually only a few iterations are required for convergence .",
    "the functional form of the equation of state  @xcite diverges for small temperatures .",
    "since a few particles can , at few occasions , reach this small temperature domain due to fluctuations , we continuously extend the equation of state for @xmath249 by choosing the heat capacity to be independent of temperature , _",
    "i.e. _ : @xmath250 we then write the energy and entropy in the regime @xmath251 as @xmath252 this enhances the stability of our simulations where we use @xmath253  k.    we run simulations for systems of @xmath254 particles initialized at temperature @xmath217  k and density @xmath255  kg.m@xmath200 as in section  [ sec : vnum ] .",
    "we use the cubic kernel and the reduced units defined in section  [ sec : scaling - sdpd ] .",
    "the number of iterations is fixed to @xmath218 .",
    "the timestep is chosen for each @xmath161 such that the drift in energy is less than @xmath219 after @xmath220 iterations , which gives @xmath256 for @xmath205 in reduced units .",
    "we plot the distributions of normalized internal energies @xmath257 , densities @xmath40 and pressures @xmath53 for several masses ( see figure  [ fig : ljc - dist ] ) .",
    "for each distribution , we find the appropriate scaling of their expected values @xmath258 and variance @xmath259 with respect to the particle size @xmath161 by fitting @xmath258 as a second - order polynomial in @xmath260 and @xmath259 as a power law in @xmath161 ( see table  [ tab : rescaling - dist ] ) .",
    "+   +    the distributions are then rescaled as @xmath261 where @xmath262 is the distribution function for some quantity .",
    "the rescaled distributions @xmath263 are represented as an inset in figure  [ fig : ljc - dist ] .",
    "we notice that , for @xmath264 , the rescaled distributions @xmath263 collapse to a single distribution independent of the particle size @xmath161 . as @xmath161 increases ,",
    "the mesoparticles stand for a larger collection of molecules , so that some effective averaging process takes place .",
    "standard results from probability theory suggest that the variances @xmath265 scale as @xmath266 and that the distribution should tend to a normal distribution .",
    "our numerical results are in excellent agreement with this prediction , the distributions becoming more symmetric for larger sizes @xmath161 with a variance inversely proportional to @xmath161 .",
    "we check the consistency of the sdpd simulations with the reference equation of state by plotting the average pressure , internal and kinetic temperatures with respect to the mass of the fluid particles in figure  [ fig : lj - consistency ] .",
    "+   +    for large masses , the thermal fluctuations included in the sdpd equations are no longer significant and the estimated pressure converges to some limiting pressure which is @xmath267 lower than the pressure predicted by the equation of state .",
    "however , we also note a discrepancy in the estimation of the density as we observe an average mean density of @xmath268  kg.m@xmath200 for @xmath269 instead of the expected value @xmath270  kg.m@xmath200 .",
    "as the size of the particles decreases , the agreement between the pressure obtained from sdpd simulations and the pressure predicted by the equation of state remains within @xmath231 of difference even for @xmath228 or @xmath205 , _",
    "i.e. _ for masses of the order of only a few multiples of @xmath160 .",
    "we turn in this section to the study of the consistency of sdpd in nonequilibrium situations such as shock waves .",
    "we consider a system of @xmath271 particles initialized on a simple cubic lattice @xmath272 .",
    "we use periodic boundary condition in the @xmath273- and @xmath274-directions whereas two walls are located at each end of the system in the @xmath275-direction . each wall",
    "is composed of 3 layers of `` virtual '' sdpd particles arranged in a cubic lattice , using the same ideas as bian _",
    "et al . _",
    "@xcite . the positions and momenta of the virtual particles",
    "are not updated with the dynamics but are kept fixed within the walls .",
    "these virtual particles enable us to evaluate the density of the sdpd particles in the neighborhood of the walls , as well as the conservative forces   acting on the actual particles . in order to ensure that walls are not permeable , these particles induce a repulsive force deriving from a truncated lennard - jones potential : @xmath276 \\mathds{1}_{r \\leq 2^{\\frac16}\\sigma_{\\rm rlj}}.\\ ] ] we set @xmath277 and @xmath278 in the reduced units  .",
    "we use the lennard - jones equation of state  @xcite in these simulations .",
    "the system is initialized at a temperature @xmath279  k and a density @xmath280  kg.m@xmath200 . to produce a sustained shock wave in the system",
    ", the bottom wall is set in motion at a velocity @xmath281  m.s@xmath282 in the @xmath275-direction and continues moving at velocity @xmath283 throughout the simulation .",
    "we run the simulation with particle sizes varying from @xmath205 to @xmath284 .    in order to avoid the effects due to the presence of the walls",
    ", we only consider the information arising from particles located at a distance larger than @xmath285 from a wall .",
    "making use of the stationarity of shock waves in the reference frame of the shock front , it is possible to average profiles over time .",
    "we split the simulation box into a number of slices @xmath286 regularly distributed along the @xmath275-axis and compute average quantities in the slices .",
    "we determine the position of the shock front at every step as the point where the mean particles velocity along the @xmath275-axis is the closest to the velocity @xmath287 .",
    "the various profiles are then averaged by setting the position of the shock front as the reference frame ( @xmath288 ) .",
    "table  [ tab : shock-500-ljv ] summarizes the main physical properties estimated with the simulations : the velocity of the shock front @xmath289 along with the thermodynamic properties in the shocked state ( the density @xmath290 , the pressure @xmath291 and the internal temperature @xmath292 ) .",
    "they are compared to the corresponding values obtained via direct md simulation and to the values predicted by the rankine - hugoniot relations applied to the equation of state  @xcite .",
    "assuming that the evolution can be described in an effective manner by a one - dimensional euler system ( in particular , viscosity effects can be neglected ) , the rankine - hugoniot conditions allow to predict the thermodynamic properties in the shocked state , knowing the initial thermodynamic state , the velocity of the shock wave and the velocity of the particles in the shocked region .",
    "these conditions are obtained from the conservation laws for mass , momentum and energy . the density @xmath290 , pressure @xmath291 and internal energy per unit mass @xmath293 in the shocked state are respectively predicted to be @xmath294 where @xmath295 , @xmath296 and @xmath297 are the density , pressure and internal energy per unit mass in the initial unshocked region .",
    "we find that sdpd gives similar results for all the resolutions which are considered .",
    "these results are consistent with the predictions obtained from the rankine - hugoniot relations",
    ". they also agree with md within a @xmath231-difference margin for pressure , density and temperature .",
    "while no particular bias is observed for temperature , the density observed in sdpd is slightly higher and the pressure slightly lower than the md results .",
    "the shock velocity is also a bit underestimated and seems to decay for larger particles .",
    "since we consider a bulk material , the viscosity has no effect on the average properties in the shocked state .",
    "as such , we obtain quasi identical results when @xmath298  pa.s ( as presented in table  [ tab : shock-500-ljv ] ) or @xmath299  pa.s    .[tab : shock-500-ljv]average observables in the shocked state .",
    "the wall velocity is fixed to @xmath300  m.s@xmath282 and the viscosity parameter for sdpd is set to @xmath298  pa.s . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     following  @xcite , we compute the one - dimensional navier - stokes shock wave profile . in this 1d stationary setting , the navier - stokes conservation equations   simplify to simple differential equations : @xmath301 where @xmath302 is the distance to the shock front ( located at @xmath288 ) .",
    "the unknowns are the density @xmath166 , the velocity @xmath303 , and the internal energy per unit mass @xmath304 , while the pressure @xmath10 is given by the equation of state .",
    "we choose the unshocked material to be at @xmath305 and the shocked fluid at @xmath306 .",
    "this determines the velocity in the unshocked state to be @xmath307 and the velocity in the shocked state @xmath308 .",
    "equations   are integrated with a finite differences scheme on a domain @xmath309 $ ] and with initial conditions @xmath310 .",
    "the density @xmath311 and energy @xmath312 at the origin are then determined thanks to equations  .",
    "we choose here @xmath313  m and a mesh spacing @xmath314  m.    we also present the results for a md simulation of the same setting . in md simulations , the walls are modeled as infinitely massive particles interacting with the other particles through a lennard - jones potential .",
    "we use a velocity - verlet scheme  @xcite and a timestep @xmath315  s for the integration of the hamiltonian dynamics .",
    "the mean profiles for density are given in figure  [ fig : shock - profiles ] in the corresponding reduced units and in physical units .",
    "the reduced length unit for md and navier - stokes is the same as the sdpd reduced length unit for @xmath316 to allow for a comparison with the other profiles .",
    "+    figure  [ fig : shock - profiles ] is obtained by using a viscosity @xmath298  pa.s , which is of the same order as the viscosity of the lennard - jones fluid , for the sdpd simulations and the navier - stokes solution , which allows for a comparison between these methods . while the profile derived from   is sharper than the md profile , we observe that we can recover reasonably well the profile from md for small sdpd particle sizes .",
    "when the size of the sdpd particles increases , the shock front widens and no longer agrees with the md profile . since the width of the shock front in sdpd seems constant in reduced units for any of the tested resolutions , the main factor governing the shock width in physical units in this situation appears to be the resolution chosen for sdpd .",
    "the profiles computed with sdpd display strong oscillations in the shocked state due to the small value of the viscosity .",
    "similar issues are encountered in sph , where an artificial viscosity is introduced to alleviate the oscillations  @xcite .",
    "figure  [ fig : shock - artificial - visco ] presents the profiles computed with a larger viscosity @xmath317  pa.s , which is comparable to water .",
    "the oscillations are effectively dampened but the shock front is now quite wide compared to md and agrees with the navier - stokes results .",
    "its width in physical units no longer depends on the particles size for the range of resolution we study .",
    "in this situation , it appears that the dominating effect is the viscosity and any of the tested particles sizes is able to accurately resolve the shock front for moderately viscous fluids .",
    "we anticipate similar results for higher viscosity fluids .",
    "we presented in this work a reformulation of the sdpd equations in terms of internal energies rather than internal entropies .",
    "this leads to a set of stochastic differential equations with a structure very similar to that of the dpde equations , which opens the way for a concurrent coupling of the two methods .",
    "it also enables us to integrate the sdpd equations with energy preserving numerical schemes originally developed for dpde .    in order for sdpd to reproduce the behavior of a microscopic system",
    ", we chose to use an equation of state fitted on equilibrium md simulations for a lennard - jones fluid  @xcite . using this equation of state",
    ", we studied the influence of the resolution level in sdpd on the fluid properties .",
    "we showed that the equilibrium thermodynamic properties can be retrieved by sdpd for a wide range of particle sizes , even down to the scale of microscopic particles .",
    "moreover , the distribution functions for the particles density , internal temperature and pressure behave as gaussian distributions with a variance scaling as @xmath266 when the size of the particle increase .",
    "this is consistent with the viewpoint that mesoparticles represent the average behavior of @xmath161 underlying microscopic particles .",
    "we finally tested the method in a non equilibrium situation , namely a shock wave , and compared the resulting profiles for md and sdpd at different resolutions .",
    "we found that the thermodynamic properties in the shocked state agree quite well with the predictions of md with errors of the same order as for equilibrium properties .",
    "as far as nonequilibrium properties are concerned , two regimes can be distinguished : for low viscosity fluids like argon , the width of the shock front in physical units is governed by the size of the sdpd particles , and the agreement with md profiles is only recovered for very small sizes ( @xmath318 ) . moreover , spurious oscillations appear behind the shock front . for higher viscosity fluids ( _ i.e. _ water or above ) ,",
    "the width of the shock front in physical units become independent of the resolution of sdpd simulations and is controlled by the viscosity .",
    "oscillations are also damped out .",
    "the consistency of the results at the various levels of coarse - graining , as well as the agreement with the original , atomistic system , allows us to envision a concurrent coupling of sdpd at different resolutions .",
    "we thank pep espaol for fruitful discussions and john brennan for bringing  @xcite to our attention . the work of g.s .",
    "was funded by the agence nationale de la recherche , under grant anr-14-ce23 - 0012 ( cosmos ) and by the european research council under the european union s seventh framework programme ( fp/2007 - 2013 ) / erc grant agreement number 614492 .",
    "we check in this appendix that the dynamics   preserves the energy @xmath319 by showing that each elementary dynamics   and   independently preserve the total energy @xmath107 .",
    "the variation of the energy along the trajectory is given by @xmath320 we next evaluate this variation for the sub - dynamics under consideration .",
    "we first study the conservative dynamics  .",
    "since it is a deterministic dynamics , the energy variation simply reads @xmath321 in view of the equations of motion  , we get @xmath322\\\\      & - \\sum\\limits_{i=1}^n\\sum_{j\\neq i}m^2\\frac{p_i}{\\rho_i^2}f_{ij}{\\boldsymbol{r}}_{ij}\\cdot{\\boldsymbol{v}}_{ij}\\,{{\\rm d}}t.\\\\    \\end{aligned}\\ ] ] a final reorganization of the second term makes it clear that the right hand side vanishes and proves the conservation of the energy by the elementary dynamics  .",
    "we now focus on the elementary pairwise fluctuation and dissipation dynamics   for a given pair @xmath188 .",
    "this dynamics is stochastic .",
    "it calculus yields @xmath323 & = \\frac{{\\boldsymbol{p}}_i}m\\cdot { { \\rm d}}{\\boldsymbol{p}}_i + \\frac{{\\boldsymbol{p}}_j}m\\cdot { { \\rm d}}{\\boldsymbol{p}}_j + \\frac{{\\rm tr}\\left({\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t\\right)}{m}{{\\rm d}}t\\\\      & = { \\boldsymbol{v}}_{ij}\\cdot { { \\rm d}}{\\boldsymbol{p}}_i + \\frac1m{\\rm tr}\\left({\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t\\right){{\\rm d}}t .",
    "\\end{aligned}\\ ] ] in view of the equations of motion  , the variation of the internal energies can be rewritten as @xmath324 this proves that @xmath325 .",
    "the energy is thus conserved by the pairwise dynamics  .",
    "since all the elementary dynamics preserve the energy , the global dynamics   obtained by the superposition of   and   also preserves the energy @xmath107 .",
    "we check that measures @xmath119 of the form   are left invariant by the sdpd dynamics  .",
    "we proceed by showing that @xmath119 is invariant by the conservative dynamics   in section  [ sec : minv - cons ] and by the elementary pairwise fluctuation / dissipation dynamics   in section  [ sec : minv - fd ] .",
    "we however need some preliminary material to this end , which we provide in section  [ sec : minv - and - gen ] and  [ sec : minv - deriv ]",
    ".      in this section , we present some standard tools which we use in the following sections to study the sdpd stochastic differential equations and to prove the invariance of  .",
    "we consider stochastic dynamics of the form @xmath326 where the variable @xmath327 is of dimension @xmath328 , the drift coefficient @xmath329 is a vector of dimension @xmath328 , the fluctuation amplitude @xmath330 a matrix of dimension @xmath331 and @xmath332 a standard brownian motion of dimension @xmath333 .",
    "we can associate to the dynamics   an operator @xmath334 , called the infinitesimal generator : @xmath335 where the contraction operation for two matrices @xmath133 and @xmath336 of size @xmath337 is defined as @xmath338    we define the adjoint @xmath339 of an operator @xmath340 as the operator such that , for any @xmath341 and @xmath342 , smooth and compactly supported test functions , @xmath343 the adjoint @xmath344 of the generator governs the evolution of the law @xmath345 of the process @xmath327 , solution of   through the well - known fokker - plank equation as @xmath346 thus , @xmath342 is a stationary solution of the fokker - plank equation if and only if @xmath347    in sections  [ sec : minv - cons ] and  [ sec : minv - fd ] , we study the elementary sub - dynamics by writing the associated infinitesimal generators @xmath348 and @xmath349 along with their adjoints . in order to prove the invariance of",
    ", we introduce @xmath350 the density of the measure @xmath119 ( see   below ) and compute @xmath351 and @xmath352 .",
    "since these operators are differential operators , we first need to evaluate the derivatives of the density function @xmath350 , which we do in section  [ sec : minv - deriv ] .",
    "we introduce a smooth function @xmath353 ( with @xmath354 and @xmath355 ) and the function @xmath356 where we made use of the relations  .",
    "we introduce the following notation : @xmath357 so that we can write the measure @xmath119 in  ( [ eq : sdpd - energy - minv ] ) as @xmath358 with @xmath359 in order to compute the derivatives of @xmath350 with respect to the variables @xmath360 , @xmath361 and @xmath44 , we first evaluate the derivatives of @xmath362 and @xmath363 with respect to these variables .",
    "since the total energy @xmath364 does not depend on @xmath56 , the derivatives of @xmath362 read @xmath365 we note that @xmath363 does not depend on the momenta @xmath361 and actually only depends on the positions @xmath360 through the densities @xmath40 .",
    "we therefore first compute the derivatives of @xmath20 with respect to @xmath40 and @xmath44 : @xmath366\\\\      & \\times \\prod\\limits_{j\\neq i }   \\partial_{\\varepsilon}\\mathcal{s}(\\varepsilon_i,\\rho_i)\\exp\\left(\\frac{\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}\\right)\\\\      = & \\left(\\frac{\\partial_{\\rho_i}\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}+\\frac{\\partial_{\\rho_i}\\partial_{\\varepsilon_i}\\mathcal{s}(\\varepsilon_i,\\rho_i)}{\\partial_{\\varepsilon_i}\\mathcal{s}(\\varepsilon_i,\\rho_i)}\\right)h(\\rho,\\varepsilon),\\\\[.5em ]      \\partial_{\\varepsilon_i } h(\\rho,\\varepsilon ) = & \\left[\\partial_{\\varepsilon_i } \\mathcal{s}(\\varepsilon_i,\\rho_i)\\partial_{\\varepsilon_i}\\left(\\exp\\left(\\frac{\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}\\right)\\right)\\right.\\\\      & \\quad\\left . + \\ , \\partial_{\\varepsilon_i}^2 s(\\rho_i,\\varepsilon_i ) \\exp\\left(\\frac{\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}\\right)\\right]\\\\      & \\times \\prod\\limits_{j\\neq i }   \\partial_{\\varepsilon}\\mathcal{s}(\\varepsilon_i,\\rho_i)\\exp\\left(\\frac{\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}\\right)\\\\      = & \\left(\\frac{\\partial_{\\varepsilon_i}\\mathcal{s}(\\varepsilon_i,\\rho_i)}{k_{\\rm b}}+\\frac{\\partial_{\\varepsilon_i}^2\\mathcal{s}(\\varepsilon_i,\\rho_i)}{\\partial_{\\varepsilon_i}\\mathcal{s}(\\varepsilon_i,\\rho_i)}\\right)h(\\rho,\\varepsilon ) .",
    "\\end{aligned}\\ ] ] equation   allow us to express the derivatives of @xmath363 with respect to the positions in terms of the derivatives of @xmath20 with respect to the densities @xmath40 as @xmath367 using equations  ,   and  , we are finally able to write the derivatives of @xmath350 with respect to the positions @xmath360 as @xmath368 the derivatives of @xmath350 with respect to the momenta @xmath361 as @xmath369,\\ ] ] and the derivatives with respect to the energies @xmath44 as @xmath370      the generator @xmath348 associated with the dynamics   reads @xmath371{\\sum\\limits_{1\\leq i < j \\leq n}}\\left[\\frac{p_i}{\\rho_i^2}+\\frac{p_j}{\\rho_j^2}\\right]f_{ij}{\\boldsymbol{r}}_{ij}\\cdot({{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_i}-{{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_j } ) .",
    "\\end{aligned}\\ ] ] in order to simplify the notation , we introduce @xmath372 the adjoint of the generator @xmath348 is readily given by @xmath373}{\\rho_i^2}\\mathfrak{f}_i \\right.\\\\      & \\left .",
    "- m^2\\smashoperator[l]{\\sum_{j = i+1}^n}\\left[\\frac{p_i}{\\rho_i^2}+\\frac{p_j}{\\rho_j^2}\\right]f_{ij}{\\boldsymbol{r}}_{ij}\\cdot({{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_i}-{{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_j})\\phi\\right ) .",
    "\\end{aligned}\\ ] ] for @xmath374 , we have @xmath375 . as all the other terms in @xmath376",
    "are first order linear differential operators , it holds @xmath377 where @xmath378.\\ ] ] we first check that @xmath379 . since @xmath363 does not depend on @xmath361 and thanks to the relations   and  , we have @xmath380 where , using again  , @xmath381 \\frac{mh}{\\partial_{\\varepsilon_i}s_i}\\\\    = & \\left [ \\left(\\partial_{\\rho_i}s_i + m\\frac{p_i}{\\rho_i^2}\\partial_{\\varepsilon_i}s_i\\right)\\frac{\\partial_{\\varepsilon_i}s_i}{k_{\\rm b } } + \\partial_{\\rho_i}\\partial_{\\varepsilon_i}s_i\\right.\\\\    & \\,\\left.+\\ , m\\frac{p_i}{\\rho_i^2}\\partial_{\\varepsilon_i}^2s_i + \\frac{m}{\\rho_i^2}(\\partial_{\\varepsilon_i}p_i)(\\partial_{\\varepsilon_i}s_i)\\right ] \\frac{mh}{\\partial_{\\varepsilon_i}s_i}.\\\\ \\end{aligned}\\ ] ] note that @xmath382 only involves derivatives of @xmath20 with respect to the density and energy of particle @xmath30 .",
    "we can make use of the relations   to get @xmath383 and @xmath384 this shows that @xmath385 .",
    "now , for a general function @xmath386 , we compute @xmath387 which clearly vanishes .",
    "the elementary conservative dynamics   thus keeps the measure   invariant .",
    "we follow here the same proof as for dpde  @xcite .",
    "we rewrite the elementary dynamics   using the variable @xmath388 : @xmath389 with @xmath390      \\displaystyle { \\boldsymbol{\\gamma}}_{ij}{\\boldsymbol{v}}_{ij}\\\\[.5em ]      \\displaystyle \\frac12\\left({\\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\gamma}}_{ij}{\\boldsymbol{v}}_{ij } - \\frac1{m}{\\textrm{tr}}({\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t)\\right)\\\\[.5em ]      \\displaystyle \\frac12\\left({\\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\gamma}}_{ij}{\\boldsymbol{v}}_{ij } - \\frac1{m}{\\textrm{tr}}({\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t)\\right )    \\end{pmatrix},\\ ] ] and @xmath391      \\displaystyle -{\\boldsymbol{\\sigma}}_{ij}\\\\[.5em ]      \\displaystyle -\\frac12{\\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}\\\\[.5em ]      \\displaystyle -\\frac12{\\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij }    \\end{pmatrix}.\\ ] ]    the generator for the dynamics   is then given by @xmath392 the matrix @xmath393 being @xmath394        \\displaystyle   -{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle { \\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle \\frac12{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v } } & \\displaystyle   -\\frac12{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v}}\\\\[.5em ]        \\displaystyle -\\frac12{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle \\frac12{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle \\frac14{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v } } & \\displaystyle \\frac14{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v}}\\\\[.5em ]        \\displaystyle \\frac12{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle -\\frac12{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t & \\displaystyle \\frac14{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v } } & \\displaystyle \\frac14{\\boldsymbol{v}}^t{\\boldsymbol{\\sigma}}{\\boldsymbol{\\sigma}}^t{\\boldsymbol{v } }      \\end{pmatrix } ,    \\end{aligned}\\ ] ] where we omitted the indices @xmath188 .",
    "more explicitly , assuming @xmath105 to be symmetric , @xmath395(\\partial_{\\varepsilon_i}+\\partial_{\\varepsilon_j})\\\\    & + \\frac12({{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_i}-{{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_j})^t{\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t({{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_i}-{{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_j})\\\\    & - \\frac12 { \\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t({{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_i}-{{\\boldsymbol{\\nabla}}}_{{\\boldsymbol{p}}_j})(\\partial_{\\varepsilon_i}+\\partial_{\\varepsilon_j})\\\\    & + \\frac18 { \\boldsymbol{v}}_{ij}^t{\\boldsymbol{\\sigma}}_{ij}{\\boldsymbol{\\sigma}}_{ij}^t { \\boldsymbol{v}}_{ij } ( \\partial_{\\varepsilon_i}+\\partial_{\\varepsilon_j})^2 . \\end{aligned}\\ ] ] introducing @xmath396 the generator can be rewritten as @xmath397    we now consider matrices of the form   and use the following relations @xmath398 to write the generator @xmath349 as a sum of two operators @xmath399 and @xmath400 , more precisely @xmath401 where @xmath402 for @xmath403 . since @xmath404 , the adjoint of the generator applied to @xmath350 reads @xmath405\\right).\\ ] ]    a sufficient condition for the measure @xmath119 to be left invariant by   is then @xmath406 = 0\\ ] ] for @xmath407 . since @xmath408 is a first order linear differential operator , we can write @xmath409 & =   { \\boldsymbol{a}}_{ij}\\left [ \\left(\\sigma_{ij}^{\\theta}\\right)^2\\mathfrak{gh } \\right]\\\\      & = \\left({\\boldsymbol{a}}_{ij}\\left[\\left(\\sigma_{ij}^{\\theta}\\right)^2\\mathfrak{h}\\right]\\right)\\mathfrak{g } + \\left(\\sigma_{ij}^{\\theta}\\right)^2\\mathfrak{h } \\left({\\boldsymbol{a}}_{ij}\\mathfrak{g}\\right ) .",
    "\\end{aligned}\\ ] ] for any function @xmath362 , it holds @xmath410 we assume that the fluctuation amplitude @xmath123 depends only on the positions @xmath56 and the internal energies @xmath44 and @xmath124 .",
    "we next compute @xmath411 = & \\ , { \\boldsymbol{a}}_{ij}\\left((\\sigma_{ij}^{\\theta})^2\\prod_{k=1}^n \\frac{\\exp\\left(\\frac{s_k(\\varepsilon_k,{\\boldsymbol{q}})}{k_{\\rm b}}\\right)}{t_k(\\varepsilon_k,{\\boldsymbol{q}})}\\right)\\\\    = & -\\frac12\\mathfrak{h}{\\boldsymbol{v}}_{ij } \\left(t_it_j(\\partial_{\\varepsilon_i}+\\partial_{\\varepsilon_j})\\left[\\frac{(\\sigma_{ij}^{\\theta})^2}{t_it_j}\\right]\\right.\\\\    & \\qquad\\qquad\\left . + ( \\sigma_{ij}^{\\theta})^2\\left [ \\frac{\\partial_{\\varepsilon_i}s_i}{k_{\\rm b } } + \\frac{\\partial_{\\varepsilon_j}s_j}{k_{\\rm b } } \\right ] \\vphantom{\\left[\\frac{(\\sigma_{ij}^{\\theta})^2}{t_it_j}\\right]}\\right)\\\\    = & -\\frac12 \\mathfrak{h}{\\boldsymbol{v}}_{ij}\\left ( t_it_j(\\partial_{\\varepsilon_i}+\\partial_{\\varepsilon_j})\\left[\\frac{(\\sigma_{ij}^{\\theta})^2}{t_it_j}\\right]\\right.\\\\    & \\qquad\\qquad\\left .",
    "+   \\frac{(\\sigma_{ij}^{\\theta})^2}{k_{\\rm b } } \\frac{t_i+t_j}{t_it_j } \\right ) \\end{aligned}\\ ] ] this leads us to the following sufficient condition on @xmath122 and @xmath123 : @xmath412 +   \\frac{(\\sigma_{ij}^{\\theta})^2}{k_{\\rm b } } \\frac{t_i+t_j}{t_it_j } \\right).\\ ] ] there are many possible solutions to this equation .",
    "actually any choice for @xmath123 ( for example @xmath123 constant as in dpde ) yields a corresponding expression for @xmath122 .",
    "the expression of the fluctuation amplitude in the original sdpd   suggests taking @xmath413 with @xmath414 a positive constant .",
    "we can then further evaluate @xmath415 + \\kappa^{\\theta}_{ij } \\right)\\\\      & = \\frac14\\kappa_{ij}^{\\theta}\\left ( 1 - k_{\\rm b}\\left(\\frac1{c_i } + \\frac1{c_j}\\right)\\frac{t_it_j}{(t_i+t_j)^2}\\right ) ,    \\end{aligned}\\ ] ] by using the expressions of the heat capacities  . more precisely , @xmath416 in order to retrieve the friction term of the original sdpd dynamics  , we choose @xmath417 this choice for the friction and fluctuation coefficients ensures that each pairwise elementary dynamics leaves the measure   invariant .",
    "we gather in this appendix the computation of estimators for thermodynamic quantities .",
    "we focus on the internal temperature in section  [ sec : tp - temp ] and on pressure in section  [ sec : tp - pressure ] . in the following",
    ", @xmath87 stands for the phase space as defined in section  [ sec : nrj - sdpd ] .          where we have integrated out the momenta and introduced @xmath419 along with the normalization constant @xmath420 .",
    "a simple computation based on   gives @xmath421 { { \\rm d}}\\varepsilon_j\\right.\\\\    & \\left .",
    "+ \\beta \\int_0^{+\\infty}\\exp\\left(\\frac{s_j(\\varepsilon_j,{\\boldsymbol{q}})}{k_{\\rm b}}-\\beta \\varepsilon_j\\right){{\\rm d}}\\varepsilon_j\\right ) .",
    "\\end{aligned}\\ ] ] under the assumptions  , we therefore obtain @xmath422 plugging this result in   leads to @xmath423      to evaluate the pressure in the sdpd system , we first compute the partition function of the canonical measure @xmath142  : @xmath424 + \\frac{s_i(\\varepsilon_i,{\\boldsymbol{q}})}{k_{\\rm b}}\\right)}{\\displaystyle \\prod\\limits_{i=1}^nt_i(\\varepsilon_i,{\\boldsymbol{q}})}\\,{{\\rm d}}{\\boldsymbol{q}}\\,{{\\rm d}}{\\boldsymbol{p}}\\,{{\\rm d}}\\varepsilon\\\\    = & \\int_{\\mathbb{r}^{3n}}\\exp\\left(-\\beta\\sum_{i=1}^n \\frac{{\\boldsymbol{p}}_i^2}{2m}\\right)\\,{{\\rm d}}{\\boldsymbol{p}}\\\\    & \\times \\int_{\\omega^n } \\prod_{i=1}^n \\left[\\int_{\\mathbb{r}_+ } \\frac { \\exp\\left(-\\beta \\varepsilon_i + \\frac{s_i(\\varepsilon_i,{\\boldsymbol{q}})}{k_{\\rm b}}\\right ) } { t_i(\\varepsilon_i,{\\boldsymbol{q}})}\\,{{\\rm d}}\\varepsilon_i\\right]{{\\rm d}}{\\boldsymbol{q}}. \\end{aligned}\\ ] ]    from the results of section  [ sec : tp - temp ] ( see  ) , @xmath425 which allows us to rewrite the partition function as @xmath426{{\\rm d}}{\\boldsymbol{q } } , \\end{aligned}\\ ] ] where @xmath427 does not depend on the volume @xmath428 of the domain .      in order to compute the derivative of @xmath431 with respect to the volume @xmath432 of the system ,",
    "we introduce a spatial dilation @xmath433 for @xmath434 .",
    "we then consider the partition function associated with the domain @xmath435 : @xmath436{\\int\\limits_{[(1+\\lambda)\\omega]^n}}\\hspace{-.3em}\\prod_{i=1}^n \\left[\\int_{\\mathbb{r}_+}\\hspace{-.5em}\\exp\\left(\\frac{s_i(\\varepsilon_i,{\\boldsymbol{\\tilde{q}}})}{k_{\\rm b}}-\\beta \\varepsilon_i \\right)\\,{{\\rm d}}\\varepsilon_i\\right]{{\\rm d}}{\\boldsymbol{\\tilde{q}}}\\ ] ] which gives , after a change of variables allowing to map back the integration domain to @xmath437 : @xmath438\\,{{\\rm d}}{\\boldsymbol{q}}.    \\end{aligned}\\ ] ] note that @xmath439 corresponds to no dilation and thus @xmath440 . since the volume of the dilated domain is given by @xmath441 it holds @xmath442 .",
    "the derivative of the partition function @xmath431 with respect to the volume @xmath432 can then be written as @xmath443 we can now derive @xmath444 with respect to @xmath445 at @xmath439 as @xmath446 in order to evaluate  , we first need to compute the derivatives of the density @xmath40 and of the entropy @xmath46 with respect to @xmath445 . we have , by deriving equation  ( [ eq : sdpd - rho - v ] ) , @xmath447 & = \\sum_{j\\neq i } m \\partial_{\\lambda } [ w((1+\\lambda){\\boldsymbol{r}}_{ij } ) ] \\\\    & = -(1+\\lambda)\\sum_{j\\neq i}mf((1+\\lambda){\\boldsymbol{r}}_{ij}){\\boldsymbol{r}}_{ij}^2 . \\end{aligned}\\ ] ] with this result and the equation of state  , we can compute @xmath448 as @xmath449 & = \\partial_{\\lambda}[\\rho_i((1+\\lambda){\\boldsymbol{q}})]\\partial_{\\rho_i}s_i\\\\    & = ( 1+\\lambda)\\sum_{j\\neq i}\\frac{m^2p_i}{\\rho_i^2t_i}f((1+\\lambda){\\boldsymbol{r}}_{ij}){\\boldsymbol{r}}_{ij}^2 . \\end{aligned}\\ ] ] finally , plugging these expressions evaluated at @xmath439 in equation   leads to    @xmath450 \\prod\\limits_{k=1}^n \\exp\\left ( -\\beta \\varepsilon_k + \\frac{s_k(\\varepsilon_k,{\\boldsymbol{q}})}{k_{\\rm b}}\\right)\\,{{\\rm d}}\\varepsilon\\,{{\\rm d}}{\\boldsymbol{q}}\\right)\\\\        = & \\ , 3n + \\sum_{i=1}^n \\beta z_{\\beta}^{-1}\\int_{\\mathscr{e } } \\left[\\frac{p_i}{\\rho_i^2}\\sum_{j\\neq i}m^2f_{ij}{\\boldsymbol{r}}_{ij}^2\\right ] \\exp\\left(-\\beta\\sum_{k=1}^n \\left[\\frac{{\\boldsymbol{p}}_k^2}{2 m } + \\varepsilon_k\\right]\\right ) \\frac{\\exp\\left(\\frac{s_i}{k_{\\rm b}}\\right)}{t_i } \\prod_{k\\neq i } \\frac{\\exp\\left(\\frac{s_k}{k_{\\rm b}}\\right)}{t_{\\beta } } \\,{{\\rm d}}{\\boldsymbol{q}}\\,{{\\rm d}}{\\boldsymbol{p}}\\,{{\\rm d}}\\varepsilon .",
    "\\end{aligned}\\ ] ]      we can finally compute the thermodynamic pressure in a sdpd system using  : @xmath454 where we identify the usual expressions for the kinetic part of the pressure : @xmath455 and for the potential part of the pressure : @xmath456 with the forces @xmath457 defined in  ( [ eq : cons - forces ] ) .",
    "57ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty in link:\\doibase 10.1145/1362622.1362700 [ _ _ ]  ( )  pp .",
    "link:\\doibase    10.1098/rsta.2009.0218 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/19/i=3/a=001 [ * * , ( ) ] http://stacks.iop.org/0295-5075/30/i=4/a=001 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/40/i=2/a=141 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/40/i=6/a=631 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/76/i=5/a=849 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/78/i=6/a=68001 [ * * , ( ) ] http://stacks.iop.org/0295-5075/96/i=6/a=68007 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.94.014301 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.4891308 [ * * , ( ) ] link:\\doibase    10.1021/jz500756s [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/144/6/10.1063/1.4941332 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.98.267801 [ * * , ( ) ] link:\\doibase 10.1039/c5sm03038b [ * * ,   ( ) ] http://adsabs.harvard.edu/abs/1977aj.....82.1013l [ * * ,   ( ) ] http://adsabs.harvard.edu/abs/1977mnras.181..375g [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999184710345 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999197957764 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.0702871104 [ * * ,   ( ) ] http://link.aps.org/doi/10.1103/physreve.67.026705 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/130/3/10.1063/1.3050100 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/pof2/24/1/10.1063/1.3676244 [ * * ,   ( ) ] http://link.aps.org/doi/10.1103/physreve.77.066703 [ * * , ( ) ] http://scitation.aip.org/content/aip/journal/jcp/130/2/10.1063/1.3058437 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/142/4/10.1063/1.4905720 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s1877050913005851 [ * * ,   ( ) ] ,   http://scitation.aip.org/content/aip/journal/jcp/138/23/10.1063/1.4810754 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/144/8/10.1063/1.4942499 [ * * ,   ( ) ] @noop _ _  ( ,  ) http://www.sciencedirect.com/science/article/pii/s0377042702008695 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1006/jcph.1996.0128 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1016/j.jcp.2010.12.011 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999100964398 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999185710108 [ * * ,   ( ) ] link:\\doibase 10.1111/j.1365 - 2966.2010.16577.x [ * * , ( ) ] http://journals.aps.org/pre/abstract/10.1103/physreve.56.6620 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/144/2/10.1063/1.4937797 [ * * ,   ( ) ] http://www.worldscientific.com/doi/abs/10.1142/s0219493706001670 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999113006037 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999110001592 [ * * ,   ( ) ] http://dx.doi.org/10.1137/s1064827501392879 [ * * ,   ( ) ] http://dx.doi.org/10.1090/s0002-9939-1959-0108732-6 [ * * ( ) ] http://epubs.siam.org/doi/abs/10.1137/0705041 [ * * ,   ( ) ] http://link.aps.org/doi/10.1103/physrev.159.98 [ * * ,   ( ) ] @noop _ _ , , vol .",
    "( ,  ) _ _ ,  @noop ph.d . thesis ,   ( ) http://www.sciencedirect.com/science/article/pii/s001046551400109x [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/135/20/10.1063/1.3660209 [ * * ,   ( ) ] link:\\doibase 10.1093/imanum / dru056 [ * * ,   ( ) ] _ _ ,  @noop ph.d . thesis ,   ( ) http://dx.doi.org/10.1080/00268979300100411 [ * * ,   ( ) ] link:\\doibase 10.1017/s0962492916000039 [ * * , ( ) ] http://scitation.aip.org/content/aip/journal/jpcrd/2/4/10.1063/1.3253132 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.47.r24 [ * * , ( ) ] http://scitation.aip.org/content/aip/journal/jcp/133/11/10.1063/1.3486088 [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/0021999183900360 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> smoothed dissipative particle dynamics ( sdpd ) is a mesoscopic method which allows to select the level of resolution at which a fluid is simulated . in this work , </S>",
    "<S> we study the consistency of the resulting thermodynamic properties as a function of the size of the mesoparticles , both at equilibrium and out of equilibrium . </S>",
    "<S> we also propose a reformulation of the sdpd equations in terms of energy variables . </S>",
    "<S> this increases the similarities with dissipative particle dynamics with energy conservation and opens the way for a coupling between the two methods . finally , we present a numerical scheme for sdpd that ensures the conservation of the invariants of the dynamics . </S>",
    "<S> numerical simulations illustrate this approach . </S>"
  ]
}