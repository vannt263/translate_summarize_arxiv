{
  "article_text": [
    "the water wave equations , also known as euler s equations for inviscid , irrotational waves , describe the motion of the free surface of an ideal fluid . for periodic waves in two dimensions over a flat surface in the absence of surface tension , they are given as follows @xcite : @xmath1 here",
    "@xmath2 is the velocity potential ( related to the fluid velocity by @xmath3 ) , @xmath4 is the graph of the free surface of the water , @xmath5 is the acceleration of gravity , @xmath6 is the depth of the undisturbed fluid , and subscripts denote partial derivatives .",
    "since we are interested in periodic waves , we consider periodic boundary conditions in the horizontal direction .",
    "we note that the above equations represent a free - boundary value problem for laplace s equation , _",
    "i.e. _  both @xmath4 and @xmath2 are unknowns .",
    "these equations readily generalize to three - dimensional fluids ( with two - dimensional surfaces ) ; however , in the present work , we limit ourselves to one - dimensional surfaces .    the water - wave equations may be reformulated in terms of only the surface variables @xmath7 and @xmath8 as @xcite @xmath9 where @xmath10 represents the dirichlet - neumann operator ( dno ) defined as @xmath11 where @xmath2 is the solution to the following boundary - value problem @xmath12 thus @xmath10 maps the given dirichlet data @xmath13 to the associated neumann data at the free surface .",
    "consequently , to evolve the surface variables in time using some numerical scheme , we require the solution to laplace s equation at every time step . numerically solving laplace s equation at every time step is expensive , particularly in three dimensions .    a characterization of @xmath10 that avoids the expensive numerical solution of laplace s equation is appealing . in the current work",
    "we discuss four such characterizations developed in the context of water waves .",
    "these four methods are the operator expansion method of craig & sulem ( cs ) @xcite , the transformed field expansion method ( tfe ) of bruno & reitich @xcite and nicholls & reitich @xcite , the nonlocal implicit formulation of the dno given by ablowitz , fokas & musslimani ( afm ) @xcite , and a dual version to the afm method , derived by ablowitz & haut @xcite , which we denote by afm@xmath14 .",
    "each of these methods has had remarkable theoretical utility in deriving reduced models for water waves in various physical regimes @xcite , in deriving conserved quantities @xcite , and also in providing the theoretical framework to pose some inverse problems @xcite .",
    "additionally , each of these methods readily generalizes to the case of both varying bottom boundaries and three dimensional fluids .    of course",
    ", many traditional methods to numerically solve laplace s equation exist , including the boundary integral method , conformal mapping techniques , and the finite element method . in the present work we chose to compare the cs and tfe operator expansions and the afm / afm@xmath14 nonlocal formulations with the boundary integral method .",
    "we do not consider conformal mapping @xcite , as it does not extend to three dimensional problems , nor traditional finite elements @xcite , as the trade - off between high - order elements and sparsity of the stiffness matrix makes them expensive when high accuracy is desired .",
    "though it is not usually described in this way , we regard the tfe method as a spectrally accurate variant of the finite element method .",
    "the boundary integral method is particularly efficient in two dimensions for periodic problems as the lattice sums involved have an explicit analytical representation .",
    "however , in three dimensions , boundary integral methods are considerably more difficult to implement .",
    "the overall goal of the present work is to understand the relative effectiveness and accuracy of each method for two - dimensional fluids .",
    "the cs , afm and afm@xmath0 methods involve highly ill - conditioned intermediate calculations , so much of the paper focuses on whether accurate results can be obtained if multiple - precision arithmetic is employed in these intermediate calculations .",
    "in particular , for timestepping the water wave , it is important that the methods work if the input data is only known with limited accuracy  additional precision in intermediate calculations is permissible as long as the output is roughly as accurate as the input .",
    "given the care required to obtain high accuracy in the present work , one must be cautious about using these methods in double - precision without carefully monitoring condition numbers and cancellation of digits .",
    "an outline of the paper is as follows . in   [ dno_reps ] , we briefly introduce the cs operator expansion , the afm and afm@xmath0 nonlocal formulations , and the boundary integral and tfe representations of the dno . in ",
    "[ assessment ] we present comparisons of the first four of these methods for specific choices of the free surface @xmath4 .",
    "here we seek to quantify how accurate the cs , afm and afm@xmath14 methods are .",
    "we assume the exact dno is obtained from the boundary integral method , and , where suitable , perform computations using higher precision .",
    "section [ converge ] discusses the subtle cancellation properties associated with the series representation of craig & sulem . in  [ examples ] , we present a specific example where the afm@xmath14 method ( in its usual interpretation as a system of equations for the coefficients of a certain series ) is guaranteed to fail , and other instances where afm and afm@xmath14 successfully converge to the correct neumann data .",
    "the subtle cancellation of the cs expansion is mirrored by the rapidly decaying singular values associated with the afm / afm@xmath14 methods .",
    "this leads us to consider regularized versions of afm / afm@xmath0 that involve oversampling the afm basis functions to accurately approximate a gram - schmidt orthogonalization procedure via @xmath15 factorization or the singular value decomposition . in the svd approach ,",
    "we also investigate the use of a pseudo - inverse cutoff threshold .",
    "we find that the afm basis functions can be more efficient at representing solutions than a fourier basis , but with the drawback of poor conditioning .",
    "finally , in  [ waterwave ] , we discuss the behavior of all the methods on examples relevant to water waves .",
    "as mentioned in the introduction , the dirichlet  neumann operator plays an important role in the mathematical formulation of the motion of surface gravity waves . to efficiently compute the time - dependent motion , we require a fast and efficient means to solve laplace s equation , or alternatively , a direct method to compute the dirichlet  neumann operator . in this section ,",
    "we outline five commonly used approaches .",
    "the first , due to craig & sulem @xcite , involves expanding the dno in a taylor series .",
    "the second , due to ablowitz , fokas and musslimani @xcite , involves deriving a global relation between the dirichlet and neumann data that can be used as an integral equation to solve for the neumann data .",
    "the third @xcite is a dual variant of the second , formulated more directly .",
    "the fourth is a boundary integral collocation method @xcite .",
    "and the fifth is the transformed field expansion method of bruno & reitich @xcite and nicholls & reitich @xcite .",
    "consider laplace s equation @xmath16 posed on the domain @xmath17 , where @xmath4 is a smooth periodic function with period @xmath18 .",
    "further assume that @xmath2 is periodic in the horizontal variable @xmath19 with period @xmath18 , and @xmath20 thus we restrict ourselves to a flat bottom boundary at @xmath21 .",
    "let @xmath22 and @xmath23 be the dirichlet and neumann values of the function @xmath2 at @xmath24 . if either @xmath25 or @xmath23 is given ( in appropriate function spaces ) , the problem of determining @xmath2 in @xmath26 is well - posed in the hadamard sense . as we require the map from the dirichlet to the neumann data , assume we are given a dirichlet condition at the boundary @xmath24 .",
    "the associated neumann condition at the boundary @xmath24 is given in terms of the solution to the following boundary - value problem : @xmath27 in abstract terms , the dirichlet ",
    "neumann operator @xmath28 is given by @xmath29 where @xmath2 satisfies the above boundary - value problem .",
    "note that a function of the form @xmath30 satisfies laplace s equation , periodicity and the boundary condition at @xmath21 for @xmath31 @xmath32 .",
    "hence @xmath33 it is well - known ( see @xcite and references therein ) that for a lipschitz domain , the dno is an analytic function of the domain shape .",
    "thus , @xmath28 has a power series expansion in @xmath4 .",
    "writing @xmath34 where @xmath35 for @xmath36 , we obtain an explicit representation for @xmath37 from ( [ eq : g : hyp ] ) by expanding the hyperbolic terms in their respective taylor series and identifying terms of the same degree in @xmath4 .",
    "to lowest order we obtain @xmath38 by decomposing the given dirichlet condition in a fourier series , we obtain the following representation of the lowest order term of the dno @xmath39 = k \\tanh(kh ) \\mathcal{f}\\left[\\mathscr{d}\\right].\\ ] ] similarly , proceeding to higher order , we obtain further terms in the expansion of the dno . for instance , @xmath40 where @xmath41 and @xmath42 .",
    "terms such as @xmath43 are understood as pseudo differential operators , _",
    "i.e. _  they are defined through associated fourier multipliers .",
    "we remark that higher order terms of the taylor expansion of @xmath28 involve increasingly higher order derivatives .",
    "although the taylor series of @xmath28 exists for @xmath4 with a limited ( even finite ) degree of smoothness , the formulas for @xmath37 are not valid in such cases , or must be interpreted very carefully , as a whole , rather than as a sum of individual operators .",
    "even when @xmath4 is real analytic , there is a delicate balance existing among the terms that leads to a high degree of cancellation @xcite .",
    "this causes numerical difficulties in finite precision arithmetic .",
    "we explore the extent of these cancellations in arbitrary precision arithmetic in ",
    "[ assessment ] . of course , many of these problems can be avoided by flattening the domain through a change of variables @xcite , or using boundary integral methods to compute the dno @xcite .",
    "however , the original craig ",
    "sulem expansion remains of theoretical interest , and is the one most closely related to the afm approach , discussed next .",
    "following @xcite , we now derive the global relation of the ablowitz  fokas ",
    "musslimani reformulation of the water - wave problem .",
    "the distinguishing feature of this reformulation is the implicit nonlocal characterization of the dirichlet ",
    "neumann operator . solving the resulting integral equation gives the full dno , effectively summing all the terms in the expansion of craig & sulem without having to compute them order by order .",
    "as above , the functions @xmath44 play a role , but now as dual functions rather than basis functions . from green s second identity",
    ", we have @xmath45dx - \\int_0^l\\phi(x,\\eta)\\left[\\psi_y(x,\\eta)-\\eta_x\\psi_x(x,\\eta)\\right]dx,\\\\ & = \\int_0^l\\psi(x,\\eta){\\mathscr{n}}(x ) dx - \\int_0^l{\\mathscr{d}}(x ) \\left[\\psi_y(x,\\eta)-\\eta_x\\psi_x(x,\\eta)\\right]dx,\\label{green}\\end{aligned}\\ ] ] where @xmath46 is the normal derivative to the surface . using the definition of @xmath47 and noting that @xmath48 we obtain @xmath49 which is the ablowitz - fokas - musslimani ( afm ) global relation @xcite for laplace s equation .",
    "note that the global relation thus obtained is but a rephrasing of green s identity . in @xcite",
    ", the authors obtain this expression in a different , but equivalent , manner . by a spectral collocation technique , this yields an algorithm in which approximate values @xmath50 are obtained on a grid @xmath51 by solving a linear system . in that case ,",
    "( [ afm ] ) is enforced for wave numbers @xmath52 .",
    "a third approach , due to ablowitz & haut @xcite , can be derived from ( [ afm ] ) through a type of inverse fourier transform .",
    "the resulting dno algorithm boils down to solving @xmath53 for the expansion coefficients @xmath54 , and then computing @xmath55 for those functions @xmath25 that permit an expansion of the form ( [ dirichlet ] ) , the normal derivative is expected ( from term by term differentiation ) to be of the form ( [ normal ] ) .",
    "the operation of solving the integral equation ( [ afm ] ) is the formal adjoint of solving the system ( [ dirichlet ] ) , ( [ normal ] ) .",
    "indeed , if the ( conjugate of the ) former is written @xmath56 , then the latter becomes @xmath57 , which are consistent since @xmath10 is self - adjoint . here",
    "@xmath58 and the weights @xmath59 are chosen to make @xmath60 and @xmath61 bounded from @xmath62 to @xmath63 .",
    "formally , these weights cancel internally in the products @xmath64 and @xmath65",
    ". indeed , the results are formally unchanged if both sides of ( [ afm ] ) are multiplied by @xmath66 , or if the weights are absorbed into @xmath54 in ( [ dirichlet ] ) , ( [ normal ] ) .",
    "these statements are only formal since @xmath60 and @xmath67 are not invertible .      whereas the afm@xmath0 method represents @xmath2 in the fluid as a superposition of basic solutions of the laplace equation of the form @xmath68 , the boundary integral method represents @xmath2 as a superposition of dipoles distributed along the surface , @xmath69 here @xmath70 is a parametrization of the free surface and @xmath71 is a field point in the fluid .",
    "we then use @xmath72 to reduce the integral to a period cell , and obtain @xmath73 using the plemelj formula @xcite , we take the limit as the field point approaches the boundary from below to obtain a second kind fredholm integral equation for @xmath74 : @xmath75 including @xmath76 in the formula has no effect on @xmath77 , but shows that @xmath60 is in fact a smooth function when @xmath4 is smooth . indeed , as @xmath78 , the @xmath79 singularities of the terms in braces cancel , yielding @xmath80\\big\\}$ ] .",
    "once @xmath74 is known , the neumann data is readily shown to satisfy @xmath81(\\alpha )    + \\frac{1}{2\\pi}\\int_0^{2\\pi}b(\\alpha,\\beta)\\mu'(\\beta)\\,d\\beta , \\\\    \\notag    & b(\\alpha,\\beta ) = { \\operatorname{re}}\\left\\ {      \\frac{\\zeta'(\\alpha)}{2 }",
    "\\cot\\left(\\frac{\\zeta(\\alpha)-\\zeta(\\beta)}{2}\\right ) -      \\frac{1}{2}\\cot\\left(\\frac{\\alpha - \\beta}{2}\\right )    \\right\\},\\end{aligned}\\ ] ] where @xmath82 is the hilbert transform , with symbol @xmath83 . to carry this out numerically",
    ", @xmath84 collocation points are used to turn the integral equation ( [ bim1 ] ) into an @xmath85 matrix equation , where integrals are approximated by the trapezoidal rule .",
    "the derivative and hilbert transform in ( [ bim2 ] ) are easily computed using the fft .",
    "the work involved in setting up and solving these integral equations is very similar to that of the afm and afm@xmath0 methods .",
    "however , the condition number is much better in the bim approach since the underlying infinite dimensional system is a second - kind fredholm integral equation .",
    "this makes a big difference in practice since intermediate calculations need only be done in double - precision to achieve double - precision results , and iterative methods such as gmres can be employed to reduce the work of solving the equations from @xmath86 to @xmath87 .",
    "see @xcite for similar boundary integral methods , including formulations that incorporate a bottom boundary and allow the interface to overturn .",
    "the aim of this approach @xcite is to compute successive terms in the craig ",
    "sulem expansion via formulas that do not suffer from catastrophic cancellation of digits in floating point arithmetic .",
    "the price we pay for this improvement is that the bulk fluid must be discretized . for simplicity",
    ", we consider only the finite depth case in two dimensions .",
    "the three - dimensional case is considered in @xcite , while infinite depth is treated in @xcite by introducing a fictitious interface coupling the unbounded problem on a half - space to the finite - depth problem with a curved upper boundary and a flat lower boundary .    instead of deriving the perturbation expansion for @xmath10 using the ill - conditioned basis functions @xmath88 , as was done in ( [ eq : g : hyp ] ) above",
    ", we perform a boundary - flattening change of variables : @xmath89 a straightforward calculation reveals that @xmath90 + \\partial_x [ \\circledast ] , \\\\",
    "u_{yy } & = \\phi_{yy } + \\big[1 - \\big(1 + h^{-1}\\eta \\big)^{-2}\\big ] u_{yy } , \\ ] ] where @xmath91 . since @xmath92 , we find that @xmath93 where @xmath94 next , we write @xmath95 and expand @xmath96 and @xmath97 in powers of @xmath98 to conclude that the terms of the series @xmath99 satisfy @xmath100 as well as @xmath101 and @xmath102 . here",
    "@xmath103 finally , we use @xmath104_{y=0 } =    \\big[-\\eta_xu_x + \\big(1 + \\eta_x^2)(1 + h^{-1}\\eta)^{-1}u_y\\big]_{y=0 } , \\\\    & \\mathbf{n } = ( -\\eta_x,1 ) , \\qquad    \\nabla\\phi = \\big ( u_x - ( 1+h^{-1}y)(1+h^{-1}\\eta)^{-1}\\eta_x u_y\\,,\\ ,    ( 1+h^{-1}\\eta)^{-1}u_y \\big)\\end{aligned}\\ ] ] to conclude that @xmath105 with @xmath106 where empty sums ( with upper index smaller than lower index ) are zero .    in our code , @xmath107 and @xmath108",
    "are stored on a rectilinear grid with @xmath84 uniformly spaced mesh points in the @xmath19-direction and @xmath109 chebyshev - lobatto nodes in the @xmath110-direction , mapped by an affine transformation to obtain @xmath111 and @xmath112 .",
    "functions on the grid are stored as matrices with entries in a column indexed by @xmath19 , holding @xmath110 fixed .",
    "the formulas for @xmath113 are evaluated pointwise on the grid from the known values of @xmath114 , @xmath115 , @xmath116 and @xmath117 for @xmath118 .",
    "the fft of the zeroth order term @xmath119 is computed from ( [ lap : u0 ] ) by expanding @xmath25 in a fourier series and evaluating @xmath120 at the grid points @xmath121 .",
    "to obtain @xmath122 , we multiply @xmath123 by @xmath124 and take the inverse fft .",
    "similarly , @xmath125 is obtained by taking the ifft of @xmath126 .",
    "this latter function is computed by transforming the rows of @xmath127 to their chebyshev coefficients ( also using an fft ) , differentiating the chebyshev polynomials , and evaluating the result on the grid using the clenshaw recurrence formula .",
    "the differentiation procedure amounts to determining the coefficients of @xmath128 from those of @xmath127 : @xmath129 where @xmath130 is the @xmath131th chebyshev polynomial .",
    "finally , ( [ lap : un ] ) is solved using an fft in the @xmath19-direction to convert the pde into a collection of uncoupled boundary value problems in @xmath110 .",
    "the @xmath132th bvp is @xmath133 subject to @xmath134 , @xmath135 . instead of using the chebyshev tau method @xcite to solve this bvp",
    ", we multiply by a test function , integrate the first term by parts , and proceed as if implementing a finite element method using chebyshev polynomials as the basis functions .",
    "our implementation is similar to what was done in @xcite to study the projected dynamics of kinetic diffusion equations in spaces of orthogonal polynomials .",
    "once @xmath136 is known for each @xmath132 , we compute @xmath137 and @xmath138 as described above for @xmath139 and @xmath140 .",
    "the key observation is that the derivatives on @xmath141 and @xmath142 in ( [ lap : un ] ) , and on @xmath143 at the end of the procedure ( to obtain @xmath137 and @xmath138 ) , are balanced by the inverse laplacian in ( [ lap : un ] ) . in other words , at the point in the algorithm where large numbers enter the computation due to applying derivatives in fourier space , we divide by even larger numbers by applying the inverse laplacian .",
    "by contrast , in the cs expansion , @xmath144 is expressed as a sum of several terms , each involving @xmath145 derivatives of products of @xmath146 with powers of @xmath4 .",
    "each derivative amplifies roundoff error , making it difficult to extract the desired sum , which is often many orders of magnitude smaller than the individual terms , as shown below .",
    "in this section we assess the merits and shortcomings of the cs method and the afm / afm@xmath0 methods . in ",
    "[ converge ] , we explore the convergence of the cs expansion and quantify the delicate cancellation of terms mentioned in @xcite . in  [ examples ] , we present an example illustrating a circumstance in which the afm@xmath14 method ( in its usual interpretation ) is guaranteed to fail . by oversampling the columns of the linear operators involved in the afm / afm@xmath14 methods , we are once again able to compute the true normal derivative with spectral accuracy",
    ". we also report on the performance of the cs expansion method for the examples considered for the afm method . finally in ",
    "[ waterwave ] we consider the performance of these three methods , as well as the tfe and bim methods , on two examples in which the dirichlet data and free surface come from solutions of the water - wave equations .",
    "the first is a standing water wave and the second involves two interacting traveling water waves .      for simplicity , until  [ waterwave ] , we restrict to the case of two - dimensional fluids of infinite depth . in that case , the dno expansion takes the form @xcite @xmath147 where the symbols of @xmath148 and @xmath149 are @xmath132 and @xmath150 , respectively .",
    "note that @xmath151 when @xmath152 .",
    "computationally , it is convenient to absorb the @xmath153 term into the first term : @xmath154 where @xmath155 for @xmath156 . in fourier space",
    ", @xmath157 is an infinite matrix with the quadrants containing the main diagonal zeroed out : @xmath158 this already accomplishes a fair amount of cancellation since @xmath159 when @xmath160 , so the rapid growth of @xmath161 is balanced by decay of @xmath162 when @xmath163 is smooth . indeed ,",
    "if @xmath163 is real analytic , one may show that there exist @xmath164 and @xmath165 such that @xmath166 , which is enough to guarantee that @xmath167 maps @xmath168 sequences @xmath169 to exponentially decaying sequences : @xmath170 here @xmath171 is the set of positive integers when @xmath132 is negative and the set of negative integers when @xmath132 is positive .",
    "thus , if @xmath163 is real analytic , ( [ recur ] ) implies that @xmath172 is real analytic for @xmath156 when @xmath173 is merely @xmath174 .",
    "also , aside from @xmath175 , @xmath144 is bounded on @xmath174 when @xmath163 is real analytic .",
    "numerical experiments reveal that significant additional cancellations occur in ( [ recur ] ) , beyond combining @xmath176 with @xmath177 . indeed , without these cancellations ,",
    "even when @xmath163 is real analytic , one would expect @xmath178 , which is one of the terms in ( [ recur ] ) when the recursion is unrolled , to grow super - exponentially with @xmath145 . in figure",
    "[ fig : growth ] , we plot the frobenius norm of the operators @xmath167 and @xmath179 versus @xmath145 for the functions @xmath180 which are band - limited , real - analytic , and @xmath181 , respectively .",
    "the frobenius norm of a matrix ( in this case doubly - infinite ) is the root sum of squares of the matrix entries .",
    "we computed it in arbitrary precision arithmetic using ( [ eq : an : formula ] ) to evaluate @xmath167 and ( [ recur ] ) to evaluate @xmath144 .",
    "the computations were done column by column , in parallel .",
    "we worked in fourier space except when computing @xmath182 , which was done by applying the inverse fft to a column of @xmath183 , then multiplying by @xmath184 in real space , and finally applying the fft again .",
    "the frobenius norm of @xmath185 was computed from the indices in the range @xmath186 where @xmath84 was chosen large enough that , for the range of @xmath145 s considered , the terms @xmath187 with @xmath188 are small compared to the largest of those satisfying @xmath189 , and may be set to zero . as explained above ,",
    "this is possible since the exponential decay of @xmath162 dominates the polynomial growth of @xmath190 in ( [ eq : an : formula ] ) .",
    "this @xmath84 was also used as the number of grid points in the fft .",
    "we include a factor of 2 when summing the squares of the matrix entries to account for the entries @xmath191 in the opposite quadrant , @xmath192 , @xmath193 .",
    "the other consideration for choosing @xmath84 is that errors near the boundary propagate inward when computing @xmath194 .",
    "thus , we choose a smaller integer @xmath195 and compute the frobenius norm of @xmath179 from the entries with indices @xmath196 the remaining columns of @xmath179 ( with @xmath197 ) are not computed , although the rows are computed out to @xmath198 .",
    "we always zero out the nyquist frequency , @xmath199 . as before ,",
    "@xmath200 is accounted for in figure  [ fig : growth ] with a factor of @xmath201 in the root sum of squares .",
    "the parameters used in these computations were @xmath202 here `` bits '' refers to the binary precision of the mantissa , where 53 would correspond to double - precision .",
    "we used mpfr @xcite for the floating - point arithmetic , which provides ieee - like arbitrary precision rounding behavior .",
    "we also used double - precision and quadruple - precision arithmetic ( using the qd package ) in some cases .",
    "the following table gives running times for multiplying two @xmath203 matrices on a 3.33 ghz intel xeon x5680 system with 12 cores : @xmath204 the double - precision calculation is particularly fast due to the use of intel s math kernel library .",
    "the higher - precision examples were parallelized using openmp , but do not employ block - matrix algorithms to re - use data that has been pulled from main memory to cache .",
    "our general experience ( excluding level 3 blas routines such as matrix - matrix multiplication ) is that switching from double to quadruple to arbitrary precision slows down the calculation by a factor of 10 each . in figure",
    "[ fig : cosa ] , we plot the non - zero matrix entries of @xmath167 and @xmath179 for example 1 . because @xmath205 , the fourier modes @xmath206 are zero for @xmath207 or @xmath208 odd . as a result , @xmath167 and @xmath179 have only finitely many nonzero terms in this example : @xmath209 in figure  [ fig : cosa ] , we explicitly filtered the data to zero out matrix entries of @xmath167 and @xmath179 with indices in these ranges .",
    "if this is not done , roundoff error from the fft is rapidly amplified by the recurrence ( [ recur ] ) , and requires additional precision to maintain accuracy .",
    "this is demonstrated in figure  [ fig : cosb ] , where we did not filter the data .",
    "increasing the precision from 300 bits to 600 causes the correct values of @xmath179 to emerge from the roundoff noise .",
    "this is less of an issue for @xmath167 , which involves errors from taking the fft of @xmath210 , amplified by @xmath161 , but no recurrence .    in figures  [ fig : alpha ] and",
    "[ fig : two3rds ] , we plot selected columns of @xmath167 and @xmath179 for examples  2 and  3 .",
    "the main change from the band - limited case of example  1 is that the matrices are no longer of finite rank , and do not have compactly supported columns . for small @xmath145 ,",
    "the decay rate of each column ( with respect to row index @xmath132 ) is still very fast , and the cancellations in obtaining @xmath179 from @xmath167 is fairly mild .",
    "however , as @xmath145 increases , the cancellations become quite severe . the cancellations can be seen in the figures as the vertical difference from one curve to the other . recall that @xmath167 is the first term in the formula ( [ recur ] ) for @xmath179 .",
    "the functions ( [ ex2 ] ) and ( [ ex3 ] ) have fourier modes of the form @xmath211 where @xmath212 in example 2 and @xmath213 in example 3 .",
    "example 2 is intended to represent a typical real - analytic function , while example 3 was designed to check if super - exponential growth in the norms of the operators @xmath157 might cause @xmath144 to also grow super - exponentially with @xmath145 .",
    "to see why @xmath157 grows super - exponentially , note that iterated convolution of @xmath214 with itself yields @xmath215 for functions of the form ( [ eq : fab ] ) .",
    "we then consider the @xmath216 column of ( [ eq : an : formula ] ) and maximize @xmath217 the maximum on the right occurs near @xmath218 , so we set @xmath219 and obtain , via sterling s formula , @xmath220 we tried @xmath221 and @xmath222 .",
    "the decay in the former case was too slow for the problem to be computationally tractable beyond @xmath223 .",
    "so we present the results in figure  [ fig : two3rds ] with @xmath222 , where we were able to compute terms out to @xmath224 .",
    "returning to figure  [ fig : growth ] , the right panel shows that the frobenius norm of @xmath167 does indeed grow super - exponentially , but the cancellations are strong enough that @xmath179 remains fairly flat . as a result",
    ", @xmath225 decays like @xmath226 for large @xmath145 even though @xmath227 eventually stops decaying for any positive @xmath98 .",
    "in addition to visual confirmation that roundoff error has not corrupted @xmath228 for @xmath150 small , as demonstrated in figures  [ fig : cosb][fig : two3rds ] , we also validate the results by checking self - adjointness of each @xmath179 .",
    "this is done by measuring @xmath229 in figure  [ fig : sym ] , we plot @xmath230 versus @xmath145 for each of the three examples .",
    "note that 300 bits of precision was not sufficient in the unfiltered case of example 1 to avoid @xmath231 errors in the symmetry of @xmath179 , whereas 600 bits gives at least 90 correct digits .",
    "this is consistent with the results of figure  [ fig : cosb ] , where the signal is barely distinguishable from the noise in the left panel , but is many orders of magnitude larger in the center panel . in hindsight",
    ", 1500 bits was overkill for example 3 since the symmetry errors in @xmath179 are still below @xmath232 when @xmath224 .",
    "further validation of the correctness of the dno expansion will be given in the following section , where it will be used to compute @xmath233 in a case where the solution is known .",
    "in this section we present examples which show that even for band - limited wave profiles @xmath4 of arbitrarily small amplitude , the system ( [ dirichlet]-[normal ] ) , with the sums interpreted as infinite series , may fail to produce the neumann data for dirichlet data of a certain class , which includes real analytic functions , regardless of how many digits of arithmetic are used in the computation .",
    "both afm and afm@xmath14 methods involve linear operators acting on the unknown neumann data . in this section ,",
    "we study the singular value decomposition ( svd ) of truncations of these linear operators . by over - sampling the columns",
    ", we obtain better approximations of the svd of the underlying quasi - matrices @xmath60 and @xmath61 in ( [ wts ] ) , whose columns are continuous functions .",
    "this leads to regularized versions of the afm / afm@xmath14 methods , the simplest version ( with no pseudo - inverse cutoff ) being equivalent to performing a gram - schmidt orthogonalization of the basis functions @xmath234 before attempting to represent @xmath25 or @xmath23 using these functions .",
    "the regularized approach enables these methods to be used even if no series of the form ( [ dirichlet ] ) exists for @xmath25 .",
    "we now construct a function @xmath25 for which no such series exists .",
    "consider the function @xmath235 which is @xmath236-periodic in @xmath19 and harmonic for all @xmath237 outside of the set @xmath238 .",
    "further , @xmath239 and hence @xmath240 for all @xmath19 .",
    "evaluating at @xmath21 , we obtain @xmath241 for values of @xmath110 in the range @xmath242 , we may also write @xmath243 in the form ( [ wilken_ex ] ) , @xmath2 is well - behaved except at the poles . however , the afm formulation is based on representing @xmath146 via the series ( [ phi : ex1 ] ) , which is divergent for @xmath244 .",
    "thus , we expect trouble for wave profiles @xmath245 that extend above @xmath246 .",
    "the simplest example illustrating these difficulties is the infinite depth case with @xmath247 introducing the weights @xmath248 in ( [ wts ] ) and taking the limit as @xmath249 , the system ( [ afm ] ) becomes @xmath250 where @xmath251 .",
    "similarly , ( [ dirichlet ] ) , ( [ normal ] ) become @xmath252 in our case , using @xmath253 in ( [ wilken_ex ] ) , we have @xmath254 since @xmath4 dips below the poles at @xmath255 , @xmath2 is harmonic on @xmath256 .",
    "moreover , @xmath257 is real analytic and @xmath236-periodic .",
    "nevertheless , there is no solution of ( [ dirichlet : h : inf ] ) valid over the whole interval @xmath258 . from ( [ phi : ex1 ] ) , we see that the coefficients @xmath259 will work over @xmath260 , but not elsewhere ; see figure  [ fig : wilken ] .",
    "comparison of the series representation ( [ dirichlet : h : inf ] ) , ( [ normal : h : inf ] ) , ( [ eq : ck : exact ] ) of @xmath146 and @xmath261 , ( blue curves ) , to the exact formulas ( [ dn : exact ] ) , ( red markers ) , for @xmath262 , @xmath263 .",
    "the series was truncated at @xmath264 , and the results were plotted at 128 grid points . a centered finite difference was used to compute the derivative in ( [ normal : h : inf ] ) . as expected",
    ", the series diverges for @xmath265 , where @xmath266 . ]",
    "there remains the possibility that for any prescribed tolerance , a choice of the @xmath267 can be made such that ( [ dirichlet : h : inf ] ) is satisfied approximately , to the specified tolerance . in other words ,",
    "the left - hand side is not treated as a series , but instead as a finite linear combination of basis functions that can approximate @xmath146 to arbitrary accuracy .",
    "rather than just add more terms to improve accuracy , it may be necessary to change all the coefficients @xmath267 . to explore this possibility",
    ", we construct the @xmath84 by @xmath268 matrices @xmath60 and @xmath61 with entries @xmath269\\big )    e^{ikx_j } , \\qquad    b_{jk } = i{\\operatorname{sgn}}(k)a_{jk},\\ ] ] where @xmath270 , @xmath271 , and @xmath272 .",
    "we then compute the singular value decomposition @xmath273 , with @xmath274 and @xmath275 square and @xmath276 of dimension @xmath277 , and evaluate @xmath278 here @xmath279 is computed spectrally via the fft ( with no filter ) .",
    "the idea here is to sample each column of @xmath60 and @xmath61 in ( [ wts ] ) with enough points that computing the svd of the resulting matrix @xmath60 in ( [ eq : ab ] ) is equivalent ( up to scaling by @xmath280 in various places ) to computing the svd of the quasi - matrix @xmath60 in ( [ wts ] ) , whose columns are continuous , @xmath174 functions : @xmath281 here @xmath60 has been truncated to have @xmath268 columns , @xmath276 and @xmath275 are unitary , @xmath274 is diagonal with positive decreasing entries , and @xmath174 is equipped with the inner product @xmath282 to avoid factors of @xmath283 elsewhere .",
    "the columns of @xmath276 form an orthonormal basis for the column - span of @xmath60 .",
    "once sufficient grid resolution is reached , approximating @xmath146 and @xmath261 at the @xmath84 collocation points leads to accurate approximation throughout @xmath284 , using trigonometric polynomials to interpolate between grid points .",
    "the columns of the matrix version of @xmath276 can be thought of as sampled versions of the columns of the quasi - matrix @xmath276 from ( [ eq : quasi ] ) , up to a factor of @xmath285 .",
    "for smaller values of @xmath84 , trigonometric interpolation becomes less accurate , and the errors can be amplified significantly on division by small singular values .",
    "we remark that if the pseudo - inverse in ( [ n : afm ] ) and ( [ n : afm1 ] ) is replaced by an inverse , then one can use a @xmath15 factorization instead of the svd to obtain an orthonormal basis @xmath276 for the column span of @xmath60 .",
    "this gives up some flexibility in regularizing the afm / afm@xmath0 methods , but is cheaper and has the advantage that the leading basis functions do not change if @xmath195 is increased .",
    "this @xmath15 approach is equivalent to gram - schmidt orthogonalization when the columns are sampled sufficiently .",
    "the results of computing @xmath261 from @xmath146 in ( [ dn : exact ] ) are shown in figure  [ fig : off0 ] .",
    "the first panel shows the singular values of @xmath60 with @xmath286 and @xmath287 . in all four cases ,",
    "the singular values decay very rapidly , with slightly slower decay when @xmath84 is larger .",
    "by contrast , the singular values of @xmath60 in the boundary integral approach ( bim ) remain nearly constant .",
    "panel b shows the error in @xmath261 from ( [ n : afm ] ) , @xmath288_j,\\ ] ] where @xmath261 refers to the exact solution ( [ dn : exact ] ) , plotted in panel d. the error depends on the pseudo - inverse cutoff index , @xmath289 , defined by @xmath290 it consists of two parts , one due to how well @xmath261 is approximated by the leading @xmath289 columns of @xmath276 , and one by how well the coefficients @xmath291 are approximated by @xmath292 for all values of @xmath272 , the error in panel b decreases initially as @xmath289 increases .",
    "this suggests that the leading entries of @xmath293 are a good approximation of those of @xmath294 .",
    "when @xmath84 is close to @xmath195 ( @xmath295 or @xmath296 in the figure ) , the error reaches a minimum at an optimal @xmath289 , and then increases rapidly .",
    "this occurs because the singular values @xmath297 become so small that the high - index entries of @xmath293 become large and no longer approximate the corresponding entries of @xmath294 . for larger @xmath84 ,",
    "the singular values decay more slowly and the error curve decreases monotonically all the way to @xmath298 .",
    "panel e shows the vector version of the error , namely @xmath299 in ( [ eq : error ] ) , corresponding to the minima of the error curves in panel b. for smaller values of @xmath84 , the error @xmath299 is largest where @xmath245 is smallest .",
    "this is not surprising since the corresponding rows of @xmath60 are smaller in this region due to the exponential growth of the basis functions @xmath68 in the @xmath110-direction .",
    "what is surprising is the extreme accuracy that is achieved by the afm method in the region where @xmath300 for smaller values of @xmath84 .",
    "we do not know why this occurs .",
    "this additional accuracy disappears as the errors are reduced in the region where @xmath301 by increasing @xmath84 .",
    "once @xmath84 reaches 384 , the columns of @xmath60 are well - resolved in @xmath302 as discussed above , and the error @xmath299 is roughly uniform throughout the domain .",
    "panels c and f show the same results for the afm@xmath0 method .",
    "the results are very poor when @xmath303 , presumably a consequence of aliasing errors in sampling the columns of @xmath60 being amplified on division by small singular values .",
    "as @xmath84 increases , the aliasing errors become smaller and the singular values become larger . by the time @xmath84 reaches 384 , the error of the afm@xmath0 method is similar to that of the afm method , of order @xmath304 . by contrast , the boundary integral method has errors of order @xmath305 with @xmath306 .",
    "there is little amplification of roundoff error in the bim approach since @xmath60 is so well - conditioned .",
    "figure  [ fig : off1 ] shows a similar computation to the above , but with @xmath245 offset vertically so that the series ( [ phi : ex1 ] ) converges at all points on the curve .",
    "specifically , we set @xmath307 the formulas ( [ dn : exact ] ) remain nearly the same , with @xmath308 replaced by @xmath309 .",
    "the singular values in panel a are the same as those in figure  [ fig : off0 ] since @xmath310 is also shifted downward by 1 in ( [ eq : ab ] ) .",
    "the afm method behaves similarly to before , achieving exceptional accuracy in the region where @xmath4 is largest when @xmath84 is close to @xmath195 , and achieving nearly uniform accuracy once @xmath84 is large enough to fully resolve the columns of the continuous version of @xmath60 . because @xmath146 and @xmath261 are smoother ( with faster decay of fourier modes ) ,",
    "all three methods ( afm , afm@xmath0 and bim ) yield smaller errors in figure  [ fig : off1 ] than in figure  [ fig : off0 ] .",
    "the afm@xmath0 method turns out to be superior to the afm method on this example for all four choices of @xmath84 .",
    "by contrast , in figure  [ fig : off0 ] , the afm method was better for @xmath311 and @xmath312 , and the two methods were equal when @xmath313 .",
    "a partial explanation is that the left - hand side of ( [ dirichlet : h : inf ] ) is a genuinely convergent series in this second example , as opposed to a finite linear combination of vectors from a dense set .",
    "thus , the afm@xmath0 method has an easier time selecting the coefficients @xmath267 that best represent @xmath146 .",
    "by contrast , for the afm method , there is little difference between the two examples . in either case",
    ", the exact solutions @xmath146 and @xmath261 satisfy the afm global relation , and the question of convergence comes down to how well the trapezoidal rule approximates the integrals , and how much the errors are amplified by the poorly - conditioned @xmath60 matrix .",
    "we do not know why the afm@xmath0 method turns out to be 25 orders of magnitude more accurate once @xmath84 reaches 384 .",
    "as before , the bim method is superior to both afm methods .    in figure",
    "[ fig : craigerr ] , we check convergence of the craig - sulem expansion for this example . as in figure",
    "[ fig : off0 ] , we consider @xmath262 , @xmath263 , with dirichlet data as in ( [ dn : exact ] ) .",
    "the computations were done on a 256-point grid with 360 bits of precision .",
    "panel a shows the errors in the partial sums , defined as @xmath314(x).\\ ] ] the errors decrease steadily until @xmath315 , where @xmath316 reaches @xmath317 , the level of aliasing errors in the fourier representation of @xmath146 and @xmath261 on a 256-point grid .",
    "recall that the error in the boundary integral method with 256 points was also around @xmath317 .",
    "panel b shows the fourier spectrum of @xmath23 ( from the exact solution ) and @xmath318 .",
    "the rapid decay of the fourier modes of @xmath318 show that the zeroth order approximation does an excellent job of predicting the high - frequency components of @xmath23 , but not the low - frequency ones .",
    "all further corrections will only be made to the first 50 fourier modes .",
    "in other words , we actually use @xmath319^\\wedge_k , & |k|<50 , \\\\",
    "\\hat{\\mathscr{n}}_k - [ g_0(\\eta){\\mathscr{d}}]^\\wedge_k , & |k|\\ge50     \\end{cases}\\ ] ] when reconstructing @xmath320 in panels e  h . as a result ,",
    "the modes marked `` unrecoverable error '' in panel b are frozen , and will not be altered by successive corrections .",
    "this is reasonable since these modes are dominated by aliasing errors in sampling @xmath23 on the 256-point grid . on a larger grid , if more accuracy were desired , the cutoff would need to be increased . the error plateau in panel a is due to these aliasing errors .",
    "panel c shows the magnitude of @xmath321 versus @xmath132 for @xmath223 and @xmath322 .",
    "each successive correction reduces the error in the leading fourier modes of the neumann data .",
    "note that the bulge near @xmath323 in @xmath324 is below @xmath317 , and therefore additional corrections do not improve the global error , which is dominated by high - frequency modes at that point .",
    "the rapid growth of @xmath324 above @xmath325 is due to truncating the fourier series to @xmath326 when computing the craig - sulem expansion .",
    "analogous behavior was seen in figures  [ fig : cosb][fig : sym ] , where we observed that errors in the columns of @xmath179 propagate inward from high to low wave numbers . due to the cutoff",
    ", these large errors do not affect the reconstruction of @xmath23 .",
    "panel d shows the exact solution @xmath23 while panels e  h show the errors in various partial sum reconstructions . because the low - order modes are the least accurate ( as seen in panel c ) , the corrections are remarkably smooth , non - oscillatory curves .",
    "the highly oscillatory error in @xmath327 is due to the `` unrecoverable error '' in panel b ; if @xmath84 were increased , @xmath327 would also be very smooth . in summary ,",
    "the craig - sulem expansion performs well on this example , converging to the exact solution , up to aliasing errors of order @xmath317 , in 95 iterations .",
    "we conclude with two examples in which the wave profile and velocity potential come from solutions of the water wave problem .",
    "the first is a large - amplitude standing water wave shortly before reaching maximum height .",
    "the second consists of two stokes waves of different amplitudes traveling to the right .",
    "both examples can be evolved efficiently using the boundary integral method @xcite .",
    "our interest here is whether the dno expansion method and the two afm methods can take data ( @xmath4 and @xmath146 ) that are only known to double- or quadruple - precision accuracy and return neumann data ( @xmath261 ) with the same accuracy . we allow ourselves to use additional precision for intermediate calculations .",
    "figures  [ fig : stand2][fig : afm : stand ] show the calculation of the dno operator for a large - amplitude standing water wave .",
    "we selected the infinite depth wave corresponding to the first local maximum of wave height ( half the vertical crest - to - trough distance ) for this example . when wavelength is set to @xmath328 and the acceleration of gravity",
    "is @xmath329 , this wave has period @xmath330 , wave height @xmath331 , crest acceleration @xmath332 , and fifth fourier mode of @xmath173 at @xmath333 ( a good bifurcation parameter in this regime ) of @xmath334 .",
    "see @xcite for details on how the wave was computed . since the wave comes to rest at @xmath335 , @xmath336 at that time .",
    "thus , to avoid a trivial dno calculation while keeping @xmath4 close to its maximum - amplitude state , we selected the wave profile at @xmath337 for this example .",
    "figure  [ fig : stand2 ] shows snapshots of @xmath7 at equal intervals of size @xmath338 over a quarter - period , along with the dirichlet and neumann data corresponding to @xmath337 .",
    "figure  [ fig : craig : stand ] shows the results of the dno calculation using the craig - sulem method .",
    "the left panel shows the error as a function of order for @xmath339 .",
    "the middle panel shows the fourier decomposition of the error at orders @xmath340 , @xmath341 and @xmath342 , together with the fourier modes of the `` exact '' solution . unlike the results of figure  [ fig : craigerr ]",
    ", the zeroth order approximation does not lead to a large improvement in the high - frequency modes ( seen as a faster decay rate in @xmath343 than @xmath344 in figure  [ fig : craigerr ] ) .",
    "in fact , @xmath343 is difficult to distinguish from @xmath345 , so we plotted @xmath346 instead , which has a similar decay rate but is shifted down slightly .",
    "the data for this problem , @xmath245 and @xmath25 , are specified via their leading 750 fourier modes ( recorded in quadruple - precision , i.e.  32 digits ) .",
    "this gives an approximation of the standing wave to 25 digits of accuracy , but is regarded here as specifying the dno problem with infinite precision .",
    "the `` exact '' solution was computed using the boundary integral method with 2304 collocation points and 212 bits of precision , leading to approximately 40 digits of accuracy .",
    "the resulting 1152 fourier modes of this `` exact '' solution are labeled @xmath347 in the middle panel .",
    "the craig - sulem expansion was performed using @xmath348 grid points for the fft and 900 bits of precision in intermediate calculations in order to achieve accurate results up to order @xmath224 for modes @xmath349 , @xmath350 .",
    "this cutoff @xmath351 was chosen to agree with the last computed mode of the `` exact '' solution .",
    "the right panel shows the error in the 120th order approximation as a function of @xmath19 .",
    "we see that the error is a smooth function of order @xmath352 that is largest near the crest tip at @xmath353 . in summary , using 900 bits ( 271 digits ) and @xmath348 grid points , the 150th order craig - sulem method is able to achieve errors around @xmath354 , which is comparable to the original standing wave calculation , which was done in quadruple - precision ( 32 digits ) with 2048 grid points using the boundary integral method .",
    "though the craig - sulem method is not competitive , it is still remarkable that such a large - amplitude wave would be inside the radius of convergence of the dno expansion .",
    "figure  [ fig : afm : stand ] shows the same calculation using the afm and afm@xmath0 methods .",
    "the same `` exact '' solution as in figure  [ fig : craig : stand ] was used to measure errors . the large ( crest - to - trough ) wave height leads to very rapidly - decaying singular values . nevertheless , using @xmath355 modes and @xmath356 collocation points with 360 bits ( 108 digits ) of precision , we are able to achieve 25 digits of accuracy in the solution .",
    "the afm and afm@xmath0 methods are comparable for cutoffs up to about @xmath357 .",
    "after that , the error in the afm method grows rapidly while the afm@xmath0 method flattens out .",
    "thus , the afm@xmath0 method is somewhat more robust in this example .",
    "the final example of this section consists of two stokes waves traveling right on a @xmath236-periodic domain .",
    "initially , one wave is centered at @xmath358 and the other is centered at @xmath353 .",
    "the fluid depth is @xmath359 and the parameters of the waves are @xmath360 where @xmath294 is the wave speed .",
    "plots of @xmath245 , @xmath25 and @xmath23 are given in figure  [ fig : stokes2 ] .",
    "figure  [ fig : craigstokes ] shows the results of the dno calculation using the craig - sulem method .",
    "the recursion ( [ recur ] ) is modified as follows to account for finite depth : @xmath361        ( n!)^{-1}|d|^{n-1}\\big ( d f^n d - g_0 f^n g_0 \\big ) , & n\\text { odd }      \\end{array}\\right\\ } , \\\\",
    "a_n(f)^\\wedge_{kj } & = \\frac{jk^n}{n ! } a_{nkj } ( f^n)^\\wedge_{k - j } , \\qquad    a_{nkj } = \\left\\{\\begin{array}{ll }        \\tanh kh - \\tanh jh , & n\\text { even } \\\\        1 - ( \\tanh kh)(\\tanh jh ) , & n\\text { odd }        \\end{array}\\right\\}.\\end{aligned}\\ ] ] we used @xmath362 grid points for the fft and computed the expansion through order @xmath322 .",
    "the `` exact '' solution was computed via the boundary - integral method in quadruple - precision , which is correct to about 28 digits of accuracy .",
    "the craig - sulem expansion reaches this level of accuracy at order @xmath363 .",
    "the errors then increase ( left panel ) due to the error growth region crossing the cutoff mode @xmath364 at 92nd order ( center panel ) .",
    "increasing @xmath84 would delay this crossing , but is unnecessary since @xmath365th order is sufficient to reach the accuracy of the underlying `` exact '' solution .",
    "the right panel shows the error as a function of @xmath19 at order @xmath223 .",
    "the error is concentrated near @xmath358 , where @xmath245 is largest . in the region",
    "not shown , the error is uniformly less than @xmath366 , even near @xmath353 , the location of the second stokes wave",
    ". thus , most of the work goes into resolving the solution near the larger peak .",
    "since this last example has finite - depth , we can also use the variant of the transformed field expansion method described in  [ sec : tfe ] to compute the neumann data from the dirichlet data .",
    "the left panel of figure  [ fig : tfestokes ] shows the error @xmath367 from ( [ eq : en : def ] ) in the neumann data as a function of the order @xmath145 , as well as the difference between the @xmath145th order terms from the tfe and cs expansions , @xmath368 the error @xmath367 reaches a plateau of @xmath369 for @xmath370 in double - precision , and @xmath366 for @xmath371 in quadruple - precision . as before ,",
    "the `` exact '' solution was computed in quadruple - precision using the boundary integral method .",
    "the orange markers show that the terms in the tfe expansion agree with the corresponding terms in the cs expansion to roundoff error accuracy .",
    "in particular , a plot of @xmath372 for the tfe method ( not shown ) looks identical to that of the cs expansion in the right panel of figure  [ fig : craigstokes ] .",
    "we also note in figure  [ fig : tfestokes ] that @xmath373 exhibits a downward trend as @xmath145 increases , indicating that the terms in the tfe expansion maintain several correct digits of relative accuracy beyond the point that @xmath367 reaches the plateau region , i.e.  the point where successive terms are smaller in magnitude than the absolute errors of the leading terms . in the double - precision case ,",
    "most of the error in the plateau region is due to the error in the zeroth order term  @xmath374 is larger than the sum of the other @xmath373 . in quadruple - precision , @xmath374 is still largest , although the @xmath373 with @xmath375 are of comparable size",
    ". this may be partly due to the cutoff at @xmath364 used in the cs expansion in figure  [ fig : craigstokes ] to eliminate high - frequency noise .",
    "certainly , the rapid growth in @xmath373 for @xmath376 in figure  [ fig : tfestokes ] is due to errors in the cs expansion rather than the tfe expansion .",
    "indeed , @xmath367 in figure  [ fig : craigstokes ] grows rapidly for @xmath377 while it remains flat for @xmath377 in figure  [ fig : tfestokes ] .",
    "recall that a third method ( the bim method ) was used for the exact solution in both plots .",
    "the middle and right panels of figure  [ fig : tfestokes ] were used to decide how many grid points to use in the tfe method .",
    "we used @xmath378 , @xmath379 in double - precision and @xmath380 , @xmath381 in quadruple - precision .",
    "these plots show the partial norms @xmath382 where @xmath383 are the chebyshev coefficients of the @xmath132th fourier mode of @xmath143 : @xmath384 recall that @xmath385 is defined on a rectangle and expanded in powers of @xmath98 , @xmath386 , where @xmath387 .",
    "the partial norms @xmath388 and @xmath389 are the norms of the rows and columns of the matrix of fourier - chebyshev coefficients of the function @xmath390 .",
    "to resolve the solution spectrally , the mesh needs to be large enough that the partial norms decay to the desired tolerance as @xmath391 or @xmath392 .",
    "as shown in figure  [ fig : tfestokes ] , the meshes we selected are sufficient to reach roundoff level tolerances in these limits .",
    "it is worth noting that many fewer grid points are needed in the @xmath110-direction than in the @xmath19-direction , so the price of discretizing the bulk fluid is not as severe as one might imagine .",
    "moreover , as with the bim method , intermediate calculations can be done in double or quadruple - precision arithmetic to achieve similar levels of accuracy in the solution .",
    "the overall running times ( in seconds ) of the various methods on this example are given in the following table : @xmath393 the code was run on a 3.33 ghz intel xeon x5680 system with 12 cores . here",
    "( d ) and ( q ) stand for double and quadruple - precision , and the other methods were run with 360 bits ( 108 digits ) of precision .",
    "the running time of afm@xmath0 is nearly identical to that of afm , and the afm - qr variant will be described below .",
    "clearly , the bim and tfe approaches are superior to the cs and afm - based methods since arbitrary - precision arithmetic is not required .",
    "we conclude with the results of the afm and afm@xmath0 methods on this example , which we selected initially as being relevant to water waves and likely to cause difficulties for the afm and afm@xmath0 methods .",
    "our reasoning was that the second wave is large enough to require many fourier modes to resolve its shape , but small enough that @xmath394 is many orders of magnitude larger at the crest of the first wave than at the crest of the second ( for large @xmath132 ) .",
    "thus , substantial cancellation must occur near @xmath358 in order to resolve the behavior of @xmath2 near @xmath353 .",
    "however , the singular values in the left panel of figure  [ fig : afmstokes ] decay slowly in comparison to the infinite - depth standing wave case of figure  [ fig : afm : stand ] .",
    "this is because the waves in these two examples have similar fourier decay rates for @xmath395 and @xmath396 , but the deep - water standing wave has a much larger vertical crest - to - trough height .",
    "to the extent that this is generally the case for waves in deep versus shallow water , the afm and afm@xmath0 methods appear to be better suited for finite depth problems .",
    "the errors in the afm and afm@xmath0 methods are nearly identical for every choice of pseudo - inverse cutoff in the center panel of figure  [ fig : afmstokes ] .",
    "thus , the methods are equally effective at computing the dno for this example . beyond @xmath397 ,",
    "the error in the center panel reaches a plateau of @xmath398 .",
    "this is due to errors in the `` exact '' solution .",
    "since this plateau is reached already at @xmath397 , it would appear that @xmath195 and possibly @xmath84 can be reduced while still achieving the target accuracy of @xmath399 .",
    "however , reducing @xmath195 leads to worse results ( not shown ) .",
    "the reason is that the high - index columns of @xmath60 in @xmath400}{\\cosh[k\\eta_\\text{max}+h ] }    \\begin{pmatrix } \\cos kx \\\\[2pt ] \\sin kx \\end{pmatrix } , \\qquad    ( 1\\le k < k/2)\\ ] ] comprise a small but important part of the low - index singular vectors @xmath276 of the singular value decomposition , @xmath401 .",
    "a better way to understand how large @xmath195 needs to be in order to achieve a prescribed accuracy is to perform a qr factorization , @xmath402 , which is a numerically robust way to perform a gram - schmidt orthogonalization of the columns of @xmath60 .",
    "we then define the `` discrete afm transform '' @xmath403 and , in figure  [ fig : afmdecay ] , compare it to the discrete fourier transform @xmath404 the red curves give the fourier modes of the input dirichlet data , which are taken to specify the problem with infinite precision even though they only describe the standing wave and traveling waves to around 25 and 30 digits , respectively .",
    "the black curves give the fourier modes of the boundary integral solutions , which were computed with 212 and 106 bits of precision , respectively .",
    "the orange and blue curves give the `` afm transform '' of the dirichlet and neumann data .",
    "the observation that @xmath195 can not be reduced significantly below 2048 for the traveling wave problem is seen clearly in the right panel , which shows that @xmath405 does not reach roundoff error until just below @xmath406 .    the fact that the afm coefficients @xmath407 and @xmath405 decay faster than the fourier coefficients @xmath408 and @xmath409 suggests that the gram - schmidt version of the afm basis is more efficient at representing the dirichlet and neumann data of many problems of physical interest ( such as standing and traveling waves ) than the fourier basis .",
    "the abrupt change in slope of the orange and blue curves in the left panel occurs when the afm method begins to resolve errors in the given dirichlet data , which is taken to be exact even though it only agrees with physical standing waves to 25 digits .",
    "while it is interesting that the gram - schmidt version of the afm basis is more efficient than a fourier basis for these problems , computing the orthogonal afm basis is expensive since it requires a great deal of additional precision to avoid losing all significant digits during the qr factorization process .",
    "comparison of the coefficients in an expansion of the dirichlet and neumann data in an orthogonalized afm basis versus a fourier basis . ]",
    "we have shown that the craig - sulem expansion of the dno operator , the implicit formulation due to ablowitz , fokas and musslimani , and its dual , due to ablowitz and haut , can all be used to compute spectrally accurate solutions of the dirichlet - neumann problem .",
    "all three methods involve ill - conditioned intermediate calculations when the vertical crest - to - trough distance becomes large relative to the inverse of the highest - frequency wave numbers involved in a fourier description of the wave profile @xmath245 and the dirichlet data @xmath25 . however , this ill - conditioning can be tamed using extended precision arithmetic .",
    "most importantly , @xmath245 and @xmath25 need only be specified in double - precision to obtain double - precision results for @xmath23 ; extended precision is only required in intermediate calculations . while it is undesirable to work in extended precision arithmetic , a spectrally accurate method requiring 64 digits of accuracy in intermediate calculations may require less work than a more traditional 16-digit calculation using a 2nd or 4th order method if high accuracy is desired .    nevertheless , our goal in writing the paper was not to advocate the use of these methods , but to explore their limits of applicability .",
    "we originally thought that the afm and afm@xmath0 would break down if the potential @xmath2 can not be extended analytically to a strip containing the peak of the wave profile .",
    "this was the motivation for studying a potential @xmath2 with poles on the real axis and a wave profile that dips below the poles but also extends above them .",
    "it is surprising that the afm basis can still be used to approximate @xmath146 in this case to arbitrary accuracy , and that the term - by - term neumann data turns out to be a good approximation of the correct solution .",
    "we also did not expect the cs expansion to converge for realistic large - amplitude standing waves , but it was able to achieve 25 digits of accuracy at 150th order .",
    "for the same problem , the afm and afm@xmath0 methods achieved 25 digits of accuracy in spite of singular values dropping below @xmath410 . for waves in shallow water ,",
    "the condition numbers are much more reasonable , making the afm methods more appealing .",
    "as noted in @xcite , the cs expansion suffers from significant cancellations requirements .",
    "our numerical investigations confirm this behavior .",
    "we note that a suitable rearrangement of the series permits one to account for some of these cancellations , though not all .",
    "one of the goals of the present work was to understand whether this behavior is present in the afm formulation and to what extent as the afm method may be interpreted as a certain summation of the cs expansion @xcite .",
    "our investigations reveal the afm method is similarly ill - conditioned .",
    "indeed the rapid decay of singular values in the afm ( and afm * ) method mirrors the cancellation properties observed in the cs expansion .",
    "given the delicate nature of cs , afm and afm * we recommend the bim , especially for two - dimensional flows .",
    "the tfe version of the cs expansion also performs remarkably well without the need for extended precision arithmetic in intermediate calculations .    regarding extension to three dimensions ,",
    "the cs and tfe expansions work with little change .",
    "since the latter can be run effectively in double - precision , it is a viable method .",
    "although the bulk fluid must be discretized , the system of equations that must be solved decouples into many one - dimensional boundary value problems rather than a large system of equations such as arise in finite element methods .",
    "the afm and afm@xmath0 methods will lead to large , highly ill - conditioned linear systems that are easy to set up but nearly impossible to solve . performing the svd or qr factorization of such a large matrix in extended precision arithmetic",
    "would be extremely costly , and iterative methods such as gmres will not converge when the condition number grows to @xmath411 or higher .",
    "by contrast , the boundary integral method yields condition numbers close to 1 ; hence , gmres converges in just a few iterations .",
    "although it is difficult to implement boundary integral methods in three dimensions due to the slowly decaying lattice sums involved , techniques such as ewald summation @xcite are available to accelerate convergence .",
    "jw was supported in part by the director , office of science , computational and technology research , u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 , and by the national science foundation through grant dms-0955078 .",
    "any opinions , findings , and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the funding sources .",
    "dyachenko , e.a .",
    "kuznetsov , m.d .",
    "spector , and v.e .",
    "analytical description of the free surface dynamics of an ideal fluid ( canonical formalism and conformal mapping ) .",
    "letters a _ , 221:0 73  79 , 1996 .",
    "laurent fousse , guillaume hanrot , vincent lefvre , patrick plissier , and paul zimmermann . : a multiple - precision binary floating - point library with correct rounding .",
    "_ acm transactions on mathematical software _ , 330 ( 2):0 13:113:15 , june 2007",
    "url http://doi.acm.org/10.1145/1236463.1236468 ."
  ],
  "abstract_text": [
    "<S> we compare the effectiveness of solving dirichlet  neumann problems via the craig  </S>",
    "<S> sulem ( cs ) expansion , the ablowitz - fokas - musslimani ( afm ) implicit formulation , the dual afm formulation ( afm@xmath0 ) , a boundary integral collocation method ( bim ) , and the transformed field expansion ( tfe ) method . </S>",
    "<S> the first three methods involve highly ill - conditioned intermediate calculations that we show can be overcome using multiple - precision arithmetic . </S>",
    "<S> the latter two methods avoid catastrophic cancellation of digits in intermediate results , and are much better suited to numerical computation .    for the craig  </S>",
    "<S> sulem expansion , we explore the cancellation of terms at each order ( up to 150th ) for three types of wave profiles , namely band - limited , real - analytic , or smooth . for the afm and afm@xmath0 methods , we present an example in which representing the dirichlet or neumann data as a series using the afm basis functions is impossible , causing the methods to fail . </S>",
    "<S> the example involves band - limited wave profiles of arbitrarily small amplitude , with analytic dirichlet data . </S>",
    "<S> we then show how to regularize the afm and afm@xmath0 methods by over - sampling the basis functions and using the singular value decomposition or qr - factorization to orthogonalize them . </S>",
    "<S> two additional examples are used to compare all five methods in the context of water waves , namely a large - amplitude standing wave in deep water , and a pair of interacting traveling waves in finite depth .    </S>",
    "<S> = 1 </S>"
  ]
}