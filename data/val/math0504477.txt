{
  "article_text": [
    "many important problems in study of complex systems require consideration of dense and nonlinear interaction between different functional modules .",
    "hybrid system is a framework first proposed by the engineering community @xcite to model systems that exhibit both continuous and discrete state changes , and has , in recent years , found increasingly wide applications in many practical fields in connection to both complex man - made systems or physical systems found in nature .",
    "however , most of the models proposed in literature so far are deterministic , and are not suitable to model inherent randomness .",
    "new data from high - throughput biology is enabling more ambitious , complete and validated simulation biological models and a lot of attention has recently been paid to the development of the computational methods for the _ in silico _ investigation of complex biological processes on a cellular level . to be valuable to biological and biomedical research computational methods",
    "must be scaled to account for to large number of interacting component of different nature and complex pathways . as it was already noted by many researches",
    "stochastic effects play an important role in the functionality of such systems @xcite and approximation of molecular behavior by continuous models fails to reproduce many interesting biological phenomena@xcite .",
    "the deterministic approach can be particularly misleading if the molecular population of some critical reactant species becomes so small that microscopic fluctuations can conspire with reaction channel feedback loops to produce macroscopic effects .",
    "recent work shows that this can happen with dramatic consequences in the genetic / enzymatic reactions that go on inside a living cell @xcite or non - equilibrium combustion reactions .",
    "correct methods for performing stochastic simulation of the discrete event simulation are usually based on the kinetic monte carlo methods(kmc ) @xcite , stochastic simulation algorithm(ssa)@xcite .",
    "kmc / ssa methods are exact i.e. they are designed to account for _ every _ possible discrete reaction event and become notoriously inefficient for the scenarios when stochastic effects are to be ignored and model can be abstracted as system of conventional ordinary differential equations ( odes ) and ambitions goals which require the intensive use of kinetic monte carlo methods will also require immense computational resources .",
    "that became a main motivation for the development of the hybrid simulation methods which will allow adequate levels of description for different parts of complex system in hand .",
    "recently several attempts were made to bridge the gap between different levels of discretion and in particular reduce excessive information content delivered by kmc / ssa methods on a temporal scale . to overcome excessive level of resolution on the temporal scale i.e. to perform the _ temporal coarse - graining _ @xmath0-leaping methods",
    "were developed @xcite .",
    "leaping methods allow to improve the efficiency of the standard kmc / ssa while maintaining acceptable losses in accuracy by approximating the time - inhomogeneous poisson process counting the reaction events via the gaussian process / diffusion approximation .",
    "the key idea here is to take a larger time steps and allow for more reactions to take place in that step , but under the proviso that propensity functions do not change too much in that interval .",
    "when it comes to practical usage of the @xmath0-leaping method a robust strategy is necessary for deciding when during the coarse of the simulation when to step exactly using kmc / ssa and when to leap approximately with diffusion methods @xcite .",
    "when leaping , consideration of the parameter values and error - reduction scheme is also necessary .",
    "this problem becomes of practical importance because it is often desirable to allow some chemical species to be treated as continuous random variables and some to be treated discretely .",
    "this is particularly true for the case of the transcriptional regulation by transcription factors ( tfs ) . in this case",
    "there may be as few as one dna / tf binding site and messenger rna ( mrna ) abundance may be as small as tens of molecules while there may be hundreds or even thousand molecules of regulatory proteins per cell .",
    "in addition to that , biochemical networks , as probably every complex system , show remarkably interesting dynamics due to the presence of different time scales describing the evolution of discrete and continuous components .",
    "the technical difficulty with implementing the hybrid schemes is that standard kmc / gillespie approach requires constant transition rates between reaction events of the discrete species",
    ". this may not be the case if some of chemical species are evolving continuously in time or with different time scales .",
    "several attempts have been made to illustrate the relevance and feasibility of hybrid algorithm , especially for the case of highly developed separation of time - scales .",
    "rao and arkin @xcite consider the case of two groups of species evolving with two very different time scales and present stochastic averaging procedure , constructing effective rates of the `` slow '' reaction in the presence of the `` fast '' species , termed stochastic quasi steady state approximation ( qssa ) .    in their work",
    "@xcite kiehl et .",
    "al . are developing an approach to integrate ode / sde schemes with kinetic monte carlo schemes . @xcite",
    "used synchronization algorithm to produce the numerical scheme which bridges together asynchronous in nature kmc / ssa algorithms and synchronous ode integration schemes .",
    "one should probably agree that following the paths presented in the literature up to date will give solutions which are very close to the exact dynamics in the limit of a very small time step , largely different time scales , etc .",
    "but verity of different implementation approaches presented in the literature to this point indicates the fact that unifying solid mathematical description has to be thought to justify the development of the hybrid simulation schemes applicable for modeling stochastic phenomena in chemical reaction networks .",
    "not many stochastic algorithms presented in the literature so far have gone through the rigorous error control analysis or even search for the fundamental justification of the presented methods .    in this publication",
    "we aim to provide not only the framework for the for the hybrid simulation method but also we outline it s rigorous mathematical justification including error analysis .",
    "outline of this paper is following . in section  [ notation::sec ]",
    "we briefly outline some basic notation and assumption used in this article . in the next section  [ stoch::sec ]",
    "our goal will be to give precise mathematical formulation of the stochastic process corresponding to the hybrid representation of the reaction network .",
    "we model the stochastic dynamics of the reaction network as a dynamics of the composite pair @xmath1 , governed by the system of the jump - diffusion sdes .",
    "this section will be followed immediately by simple example and view on error analysis .",
    "article is ended with discussion and outline for the future work .",
    "0.5 cm consider the reaction network which represent the dynamics of @xmath2 well - stirred molecular species @xmath3 which inter - react through @xmath4 ( @xmath5 ) channels of chemical reactions .",
    "the current state of the system is completely specified by the @xmath2-dimensional vector @xmath6 consisting of non - negative integer numbers , where each number @xmath7 defined to be the current total number of molecules of type @xmath8 in the system .",
    "formally reaction network can be expressed as a set of the transition rules :    [ massaction ] @xmath9    transition rates @xmath10 are the probabilities that reaction event corresponding to the reaction @xmath11 will take place in infinitesimal time interval @xmath12 somewhere inside the reaction volume .",
    "vectors @xmath13 are the stoichiometric al changes of number of molecules of types @xmath8 due to the reaction @xmath14 .",
    "as one can see , each reaction channel is specified by two quantities : transition rates @xmath15 and stoichiometric changes in molecular composition of the system due to each individual event in reaction channel @xmath16 .    in eqn .",
    "( [ massaction ] ) @xmath17 are transition probabilities for the reaction channel @xmath14 for any particular configurations of the interacting molecules on the right hand side of ( [ massaction ] ) .",
    "the functions @xmath18 are defined to be the number of distinct reaction combinations of the reacting molecules available in the state @xmath19 . the overall transition rate can be expressed as : @xmath20 for the mass - action kinetics transition rates @xmath21 are found to be a polynomial functions of variables @xmath19 .",
    "for the simple reaction system : @xmath22 statistical weights @xmath23 are : @xmath24 .",
    "we refer reader to the sources in @xcite and @xcite for more details .",
    "0.5 cm our interest in the next step will be to consider different reactions in the system in a different manner .",
    "we partition the set of molecular species into two groups : `` large population group '' ( with appropriate quantities labeled with `` @xmath25 '' ) and discrete group ( labeled with `` @xmath26 '' ) .",
    "species from the first group will be represented by the set of @xmath27 variables taking values on @xmath28 : @xmath29 and present in large copy numbers : @xmath30 the reminder of the @xmath31 species represent the discrete components of the network : @xmath32 partition of the species into the two separate groups correspond to the partition of the stoichiometric vectors @xmath16 into two sets : @xmath33 which correspond to the changes of species in sets @xmath34 and @xmath35 due to the reaction event in the channel @xmath14 .",
    "based on this partition of species we can introduce three groups of reactions :    first group of reactions which we shall call @xmath36 , consist of reactions with large combinatorial weights , i.e. which satisfy the condition @xmath37 .",
    "we state that this condition is sufficient for the use of the diffusion approximation ( see appendix sec .",
    "[ appendix::diffusion ] )    second group , @xmath38 consists of reactions which do not satisfy the constraint @xmath39 but change the species of the group @xmath34 , i.e. those reactions for which @xmath40    finally the third group , which we call @xmath41 consists of reactions for which @xmath42    note that , those subset of the reactions are not necessary independent , i.e . @xmath43 without the loss of generality we shall assume that reactions from the set @xmath44 ( set of `` jump '' reactions ) are formed by reactions in eqn .",
    "( [ massaction ] ) with indices @xmath45 ,",
    "the rest , @xmath47 are assumed to satisfy the condition of having large combinatorial weight .",
    "0.5 cm    chemical master equation @xcite is usually employed to describe the stochastic dynamics of reaction networks of the type ( [ massaction ] ) .",
    "it is notoriously hard to solve analytically even for the simple systems@xcite and , as we mentioned before , one usually has to resort to so called kinetic monte carlo methods @xcite to obtain numerical solution . in this article",
    "we shall abandon the description based on the chemical master equation(cme ) and resort to the explicit treatment of the stochastic trajectories of the process @xmath48 as a solution of the system of stochastic differential equations ( sdes ) providing the recepie for the construction of numerical schemes .",
    "poisson counter process is a simple but important process and below we extend its utility by combining with ideas from differential equations .",
    "we briefly describe this approach to pave our way to specific applications .    to describe the structure of the stochastic jump processes let us introduce in the rather traditional way a stochastic basis @xmath49 supplied with the filtration @xmath50 large enough to include @xmath4-dimensional unit poisson processes .",
    "we recall that state variables @xmath51 are defined on this probability space . on this space transition rates eqn .",
    "( [ rate ] ) define the set of time non - homogeneous counting processes @xmath52@xcite :    @xmath53    notation @xmath54 is used to underline the existence of jumps in the process @xmath55 : @xmath56 .",
    "the above equation states that differentials of processes @xmath57 , @xmath58 depend upon local intensities @xmath59 .",
    "notation @xmath54 is used to underline the existence of jumps in the process @xmath55 : @xmath56 .",
    "counting process @xmath57 can be also represented as a time changed unit - rate poisson processes @xmath60 @xcite : @xmath61    in turn , counting processes @xmath57 represent the stochastic dynamics of the markov process @xmath51 through the `` mass - balance '' equation : @xmath62 solution of eqn .",
    "( [ sdepoisson ] ) is a constant on the interval where all @xmath57 are constants and jumps by @xmath16 whenever the reaction event takes place in the reaction channel @xmath14 at the moment of time @xmath63 : @xmath64 using the partitioning which was introduced earlier , stochastic dynamics of the state vector @xmath1 can be presented as following system of sdes :    @xmath65    where integer vectors @xmath66 and @xmath67 represent the change of the components @xmath34 and @xmath35 due to the reaction event in the channel @xmath14 . in general , propensity functions @xmath68 depend on both @xmath34 and @xmath69 .",
    "large combinatorial weights @xmath37 of some reactions allow us to follow the _ diffusion approximation _",
    "@xcite , i.e. by using the weak convergence methods we express differentials of the time - inhomogeneous poisson processes in eqn .",
    "( [ sdepoisson ] ) corresponding the group @xmath36 as a gaussian processes with the drifts @xmath70 : @xmath71 where @xmath72 are brownian motions independent of each other and @xmath73 .",
    "this approximation of the stochastic dynamics allows us to make a simplification in which we can consider the components @xmath1 as defined on a hybrid space @xmath74 ; @xmath34 takes values on the continuum state space , @xmath75 , while @xmath69 still takes values on discrete state space@xmath76 .",
    "this brings us to the following formulation of the stochastic dynamics of the pair @xmath1    [ jump_diffusion ] @xmath77    where we explicitly demonstrated the dependence of the differential of the counting processes @xmath78 on local intensities .",
    "note that according to the presence of the jump component term in equation  ( [ jump_diffusionx ] ) @xmath79 and @xmath80 is a jump - diffusion process in @xmath75 .",
    "processes with state - dependent intensities of jump are notoriously hard to model .",
    "one complications which makes the study of the sdes of the type eqn .",
    "( [ jump_diffusion ] ) hard is the nature of the noise source driving the dynamics .",
    "in contrast to very well studied wiener or poisson driven sdes @xcite is that intensity of the noise source is stochastic in nature .",
    "we shall take a different representation of the noise source .",
    "namely we use the technique of the poisson random measures .",
    "our discussion of the random measures will be brief and rather informal ; for mathematical background see monograph by jacod and shiryaev @xcite or cox and isham @xcite .",
    "poisson random measure @xmath81 defines a sequence of points and marks @xmath82 with the simple interpretation that the mark @xmath83 arrives at time @xmath84 ;  @xmath84 take values on @xmath28 .",
    "marks @xmath83 take values in a general space @xmath85 , which in the context of the problem considered here can be taken as a subset of the euclidian space , @xmath86 .",
    "deterministic intensity of the poisson process @xmath87 is @xmath88 with @xmath89 being a measure on @xmath85 .",
    "arrival times follow a poisson process with deterministic intensity @xmath90 and marks a i.i.d distributed in the interval @xmath91 .    important procedure which can be used to simulate the intensity dependent process eqn .",
    "( [ massaction ] ) is based on introduction of the partition on the marked space . at every point of the state space @xmath92",
    "we construct the set of disjoint intervals based on transition rate of `` jump '' reactions , i.e. reactions from the subset @xmath44 , i.e. @xmath93 :    [ intervals ] @xmath94    where index @xmath14 runs over reactions which either do not satisfy condition @xmath95 of for which vector @xmath96 is non - zero i.e. they change discrete components .",
    "thus in general length of the interval @xmath97 is @xmath98 .",
    "now define a set of functions @xmath99 : @xmath100 suppose now that the space @xmath101 supports a poisson random measure @xmath102 in @xmath103 with a compensator @xmath104 and a set of wiener processes @xmath105 .",
    "then time non - homogenous counting process @xmath106 can be represented as @xcite : @xmath107 and @xmath108 valued process @xmath109 can be viewed as a solution of coupled ito - skorohod sdes driven by the poisson random measures @xcite :    [ random_measure ] [ jump_diffusion_poisson ] @xmath110    function @xmath111 in eqn .  ( [ random_measure ] )",
    "transforms arrived marks into magnitude of the jump of @xmath19 due to appropriate reaction channel .    for the practical insight on the dynamics described above",
    ", we will introduce _ reference poisson process_.    since the length of each interval @xmath97 is @xmath98 and bounded function for every @xmath112 then it is follows that the length of the interval @xmath113 ( we denote it @xmath114 ) is bounded function of @xmath92 .",
    "therefore , it has a maximum at some point @xmath115 : @xmath116 denote the maximum length of the joint intervals in the marked space .",
    "now consider a standard poisson process with intensity @xmath117 .",
    "let @xmath118 denote the jump times of this process ( sampled , perhaps , as the partial sums of the exponentially distributed random variables with mean @xmath119 ) .",
    "let @xmath120 be the marked space and @xmath121 be the sequence of i.i.d .",
    "distributed random variables with uniform distribution on @xmath122 , independent on @xmath123 . in this case",
    "we can represent a poisson random measure with intensity @xmath124 is related to the marked point process @xmath125 , constituting the sample path of the process .",
    "namely for each @xmath126 :    @xmath127,a)=\\sum_{n\\geq 1}1 _ { \\tau^{\\lambda}_n\\leq t } 1_{z_n \\in a } , \\\\",
    "\\mathbb{e}(n_{\\lambda}((0,t],a))=\\lambda_{max}t\\mathbb{p}(z_n\\in a)= t\\mu(a)\\end{gathered}\\ ] ]    this representation ( sometimes referred to as thinning of the poisson measure @xcite ) is very useful in practical numerical applications . in the next section",
    "we will use the reference process @xmath128 to construct the discretization scheme taking @xmath129 ( [ intervals ] ) for various @xmath130 .",
    "in this section we outline basic principles for the construction of the numerical scheme for the solution of the system given by eqn .",
    "( [ jump_diffusion_poisson ] ) . to begin with",
    ", we should introduce the appropriate discretization of the interval @xmath131 $ ] on which dynamics of the system has to be investigated .",
    "let us denote by @xmath131_{h , m}=\\lbrace 0=t_0<t_1<t_2<\\ldots",
    "< t_{m+1}=t \\rbrace$ ] , perhaps the usual equidistant , discretization of the time interval , i.e. @xmath132 .",
    "suppose now that @xmath133 $ ] are jump times of the reference poisson process [ poisson_master ] ; then we consider new time discretization which is a merger of the points from @xmath131_{h , n}$ ] and jumps of the reference poisson process [ poisson_master ] .",
    "it is important to note that jump - times of the poisson measure eqn .",
    "( [ poisson_master ] ) can be modeled without discretization error and with little prior information ; one has only make sure that transition rates from the groups @xmath134 are bounded , i.e. are less then chosen intensity of the reference poisson measure .",
    "armed with the time discretization scheme assembled from equidistant discretization and jump - times of the reference process we introduce the following simple jump - diffusion numerical scheme :    @xmath135    which recursively determines the values of the discretized processes @xmath136 and @xmath137 at points @xmath138 , starting from values @xmath139 .",
    "increments of the winer processes @xmath140 are zero - mean gaussian random variables : @xmath141 . according to the ( [ euler_diff_x ] ) , between the jumps dynamics of the component @xmath34 is purely diffusive . integral in eqn .  ( [ euler_jumps_sigma ] )",
    "is evaluated at the single point @xmath83 which belongs to the uniform distribution @xmath142)$ ] , i.e. jump in channel @xmath14 is accepted iff generated random variable @xmath143)$ ] , generated on the step @xmath138 satisfies the condition : @xmath144    depending on the relative ratio between characteristic time - scales of diffusion and discrete species different numerical schemes must be considered to achieve substantial speed - up of the simulation .",
    "here we consider only the case of fast diffusion modes and slow discrete modes . in this case",
    "every interval @xmath145 should be partitioned onto smaller intervals of the discrete grid on which numerical scheme ( [ euler_diff_x ] ) for diffusion approximation is used .",
    "opposite case of the fast switching in discrete component @xmath146 will be considered elsewhere .",
    "we now wish do demonstrate application of the above numerical scheme . in this section",
    "we consider the simple example , which nevertheless , is interesting enough for the purposes of the demonstration of the technique discussed in this paper .",
    "consider the following model of the reaction network :    @xmath147    with continuous and discrete components @xmath148 and @xmath149 respectively . the functions @xmath15 and vectors @xmath16 for this system",
    "are :    @xmath150    we have used the following set of kinetic parameters:@xmath151 , @xmath152 , @xmath153 and @xmath154 leads to the bursts of the transcription of protein @xmath155 with @xmath156 proteins per transcription event . ] .",
    "analysis of the propensity functions ( @xmath157 ) shows the following partition of the original reaction set @xmath158 : @xmath159 i.e. reactions @xmath160 correspond to the diffusion modes .",
    "we also constraint ourselves in this example considering the case : @xmath161 propagation of the diffusion mode was performed via euler - maruyama scheme @xcite,@xcite with set of different time - steps : @xmath162 .",
    "we performed @xmath163 monte carlo runs with both standard kmc / ssa and hybrid scheme outlined above to obtain the distributions of the number of molecular species @xmath164 at time - slice @xmath165 .",
    "figures([fig::histogramx1],[fig::histogramx2 ] ) show that distributions of the species @xmath166 , @xmath167 obtained with the hybrid scheme is almost indistinguishable from the results of the obtained by following complete kmc / ssa - based approach .",
    "we also report an observed speed - up in terms of the ratio of the cpu times @xmath168 , fig.([fig::speed_up ] ) as a function of time step @xmath169 used in numerical integration of diffusion modes . 0.5 cm",
    "advances in field of molecular biology outlined new directions of research in stochastic chemical kinetics .",
    "we now need to develop the software tools and mathematical approaches to integrate models from micro - scales to macro - scales in a seamless fashion .",
    "such multi - scale models are essential if we are to produce quantitative , predictive models of complex biological behaviors .",
    "an important step on this path is implementation of hybrid simulation methods , capable to account for heterogeneity of properties of interacting components .",
    "we have outlined rigorous framework for development of hybrid simulation schemes based on the path sample representation of reaction dynamics rather then on cme based approach . for the best of our knowledge",
    "this type of analysis has not being performed before .",
    "it was not the primal goal of this publication to justify the partitioning of the species / reactions into the different groups .",
    "one should probably have some prior knowledge when partitioning the species into different types .",
    "choice of the reactions ( `` diffusive '' or `` jump '' ) is based on functional law of large numbers and error generated by this step can probably be controlled rigorously with some insights on this subject outlined in section  [ appendix::diffusion ] .    numerical solution for the propagation of the diffusion modes",
    "were outlined via simple constant step explicit euler scheme .",
    "typical explicit or implicit scheme @xcite based on stochastic taylor approximation @xcite,@xcite might run into problems , since they do not conserve the non - negativity of the numerical solution , i.e. i.e. it can not guarantee @xmath170 almost surely .",
    "we point out here that use of balanced - implicit stochastic schemes ( bim ) , @xcite look promising when it comes to the construction of the numerical solution with the property of `` almost sure '' positivity .",
    "bim scheme known to have the same order of convergence as the euler - maruyama stochastic scheme , namely , the error @xmath171 for approximations of the individual trajectories and @xmath172 for moments .",
    "adaptive time - step control systems also look promising as a direction for the research aimed for achieving the simulation speed up@xcite .",
    "author would like to acknowledge valuable discussions and useful comments from prof . c. myers , prof .",
    "d. steinsaltz , k. ericksson and prof ."
  ],
  "abstract_text": [
    "<S> the existing literature on stochastic simulation of chemical reaction networks has a tendency to move as quickly as possible to the abstract formulation of the stochastic dynamics in terms of probabilities based on the concept of the chemical master equation ( cme ) , largely ignoring sample path representation . in this publication </S>",
    "<S> we discuss both theoretical basis and numerical approach for the problems in this area using sample path methods as a crucial part of the process . </S>",
    "<S> relying as it does on a representation of the underlying stochastic processes as a weak solution of a system of stochastic differential equations driven by poisson random measures this approach brings to bear a heretofore ignored but quite effective problem solving methodology .    </S>",
    "<S> we first present a simple and intuitive way of partitioning species and reactions of the interaction network into different groups . </S>",
    "<S> we then discuss how original stochastic dynamics with state dependent intensities of transitions can be reformulated in terms of jump - diffusion stochastic differential equations driven by both wiener noise sources and poisson random measures . </S>",
    "<S> finally , we show that this approach facilitates the construction of hybrid simulation techniques , an important step in the creation of efficient techniques for modeling multi - scale stochastic dynamics of the reaction networks . </S>",
    "<S> numerical methods related to sampling events from poisson random measures are demonstrated on simple intuitive examples . </S>",
    "<S> error control analysis of the finite differences scheme is also presented .    </S>",
    "<S> current version : march 20,2005    stochastic algorithms , chemical reaction networks , ito - skorohod stochastic differential equations , poisson random measure , + hybrid systems    91b74 , 60h35 , 60h10 , </S>"
  ]
}