{
  "article_text": [
    "this paper considers the infinite - time discounted optimal control problem for continuous - time input - affine polynomial dynamical systems subject to polynomial state constraints and box input constraints .",
    "this problem has a long history in both control and economics literature .",
    "various methods to tackle this problem have been developed , often based on the analysis of the associated hamilton - jacobi - bellman equation .    in this work",
    "we take a different approach : we first lift the problem into an infinite - dimensional space of measures with continuous densities where this problem becomes convex ; in fact a linear program  ( lp ) .",
    "this lifting is a _ tightening _ , i.e. , its optimal value is greater than or equal to the optimal value of the original problem , and under suitable technical conditions the two optimal values coincide .",
    "this infinite - dimensional lp is then further tightened by restricting the class of functions to polynomials of a prescribed degree and replacing nonnegativity constraints by sufficient sum - of - squares ( sos ) constraints .",
    "this leads to a hierarchy of semidefinite programming  ( sdp ) tightenings of the original problem indexed by the degree of the polynomials .",
    "the solutions to the sdps yield immediately a sequence of _ rational _ controllers , and we prove that , under suitable technical assumptions , the value functions associated to these controllers converge _ from above _ to the value function of the original problem .",
    "we also describe how to obtain a sequence of polynomial approximations converging from above and from below to the value function associated to each rational controller .",
    "combined with existing techniques to obtain polynomial under approximations of the value function of the original problem ( adapted to our setting ) , this method can be viewed as a design tool providing a sequence of rational controllers asymptotically optimal in the original problem with explicit estimates of suboptimality in each step .",
    "the idea of lifting a nonlinear problem to an infinite - dimensional space dates back at least to the work of l. c. young  @xcite and subsequent works of warga  @xcite , vinter and lewis  @xcite , rubio  @xcite and many others , both in deterministic and stochastic settings .",
    "these works typically lift the original problem into the space of measures and this lifting is a _ relaxation _",
    "( i.e. , its optimal value is less than or equal to the optimal value of the original problem ) and under suitable conditions the two values coincide .",
    "more recently , this infinite - dimensional lifting was utilized numerically by _ relaxing _ the infinite - dimensional lp into a finite - dimensional sdp  @xcite or finite - dimensional lp  @xcite . whereas the lp relaxations are obtained by classical state- and control - space gridding , the sdp relaxations are obtained by optimizing over truncated moment sequences ( i.e. , involving only finitely many moments ) of the measures and imposing conditions _ necessary _ for these truncated moment sequences to be feasible in the infinite - dimensional lifted problem .",
    "these finite - dimensional relaxations provide _ lower bounds _ on the value function of the optimal control problem and seem to be difficult to use for control design with strong convergence guarantees ; a controller extraction from the relaxations is possible although no convergence ( e.g. ,  @xcite ) or only very weak convergence can be established ( e.g. ,  @xcite in the related context of region of attraction approximation ) .",
    "contrary to these works , in this approach we tighten the infinite - dimensional lp by optimizing over polynomial densities of the measures and imposing conditions _ sufficient _ for these densities to be feasible in the infinite - dimensional lifted problem , thereby obtaining upper bounds as opposed to lower bounds .",
    "crucially , to ensure that polynomial densities of arbitrarily low degrees exist for our problem ( and therefore the resulting sdp tightenings are feasible ) , we work with free initial and final measures and set up the cost function and constraints such that this additional freedom does not affect optimality .",
    "importantly , we do _ not _ assume that the state constraint set is control invariant , a requirement that is often imposed in the existing literature ( e.g. , @xcite ) but rarely met in practice .",
    "the presented approach bears some similarity with the density approach of  @xcite for global stabilization later extended to optimal control ( in a purely theoretical setting ) in  @xcite and recently generalized to optimal stabilization of a given invariant set in  @xcite ( providing both theoretical results and a practical computation method ) .",
    "however , contrary to  @xcite we consider the problem of optimal control , not stabilization and moreover we work under state constraints .",
    "contrary to  @xcite we work in continuous time , consider a more general problem ( optimal control , not optimal stabilization of a given set ) and our approach of finite - dimensional approximation is completely different in the sense that it is based purely on convex optimization and it does not rely on state - space discretization .",
    "moreover , and importantly , our approach comes with convergence guarantees .",
    "finally , let us mention that this work is inspired by  @xcite , where a converging sequence of upper bounds on _ static _ polynomial optimization problems was proposed , as opposed to a converging sequence of lower bounds as originally developed in  @xcite .",
    "we use @xmath0 to denote the space of all lebesgue measurable functions defined on a set @xmath1 and taking values in the set @xmath2 . if the space @xmath3 is not specified it is understood to be  @xmath4 .",
    "the spaces of integrable functions and essentially bounded functions are denoted by @xmath5 and @xmath6 , respectively .",
    "the spaces of continuous respectively @xmath7-times continuously differentiable functions are denoted by @xmath8 respectively @xmath9 . by a ( borel ) measure we understand a countably additive mapping from ( borel ) sets to nonnegative real numbers .",
    "integration of a continuous function @xmath10 with respect to a measure @xmath11 on a set @xmath12 is denoted by @xmath13 or also @xmath14 when the variable and domain of integration are clear from the context .",
    "a probability measure is a measure with unit mass ( i.e. , @xmath15 ) .",
    "the support of a measure @xmath11 , defined as the smallest closed set whose complement has zero measure , is denoted by @xmath16 .",
    "the ring of all multivariate polynomials in a variable @xmath17 is denoted by @xmath18 $ ] , the vector space of all polynomials of degree no more than @xmath19 is denoted by @xmath18_d$ ] , and the vector space of @xmath20-dimensional polynomial vectors is denoted by @xmath18^m$ ] .",
    "the boundary of a set @xmath12 is denoted by @xmath21 , the interior by @xmath22 and the closure by @xmath23 .",
    "the euclidean distance of a point @xmath17 from a set @xmath12 is denoted by @xmath24 . for a possibly matrix - valued function",
    "@xmath25 we define @xmath26 and for a vector - valued function @xmath27 we define @xmath28 , where @xmath29 denotes the jacobian of @xmath30 . if clear from the context we write @xmath31 for @xmath32 and similarly for the @xmath33 norm .",
    "crucial to the material presented in the paper is the ability to decide whether a polynomial @xmath34 $ ] is nonnegative on a set @xmath35 with @xmath36 $ ] .",
    "a _ sufficient _",
    "condition for @xmath37 to be nonnegative on @xmath12 is that it belongs to the truncated quadratic module of degree @xmath19 associated to @xmath12 , @xmath38 where @xmath39 is the set of all polynomial sum - of - squares ( sos ) of degree at most @xmath40 .",
    "note in particular that @xmath41 .",
    "if @xmath42 for some @xmath43 then clearly @xmath37 is nonnegative on @xmath12 , and the following fundamental result shows that a certain converse result holds .",
    "[ prop : putinar ] let @xmath44 for some @xmath45 and @xmath46 and let @xmath34 $ ] be strictly positive on @xmath12.then @xmath42 for some @xmath43 .    combining with the stone - weierstrass theorem , as an immediate corollary we get :    [ cor : densnonneg ] let @xmath47 be nonnegative on @xmath12 and let @xmath44 for some @xmath45 and @xmath46 .",
    "then for every @xmath48 there exists @xmath49 and @xmath50 such that @xmath51 .",
    "corollary  [ cor : densnonneg ] says that polynomials in @xmath52 are dense ( with respect to the @xmath53 norm ) in the space of continuous functions nonnegative on @xmath12 when we let @xmath19 tend to infinity .    in the rest of the text we use standard algebraic operations on sets .",
    "for instance if we write that @xmath54_d$ ] , then it means that @xmath55 with @xmath56 and @xmath57_d$ ] .",
    "the inclusion of @xmath42 for a fixed @xmath19 is equivalent to the existence of a positive semidefinite matrix @xmath58 such that @xmath59 , where @xmath60 is a basis of @xmath18_{d/2}$ ] , the vector space of polynomials of degree at most @xmath61 .",
    "comparing coefficients leads to a set of affine constraints on the coefficients of @xmath37 and the entries of @xmath58 . deciding whether @xmath42 therefore translates to the feasibility of a semidefinite programming problem with the coefficients of @xmath37 entering affinely . as a result , optimization of a linear function of the coefficients of @xmath37 subject to",
    "the constraint @xmath42 translates to a semidefinite programming problem  ( sdp ) and hence to a well - understood and widely studied class of convex optimization problems for which powerful algorithms and off - the - shelf software are available .",
    "see , e.g. ,  @xcite and the references therein for more details .",
    "we consider the continuous - time input - affine depending nonlinearly on @xmath62 can be transformed to the input - affine form by using state inflation @xmath63 , where @xmath62 is now a part of the state and @xmath10 a new control input ; constraints on @xmath10 then correspond to rate constraints on @xmath62 .",
    "similarly , cost functions depending non - linearly on @xmath62 in problem  ( [ opt : main ] ) can be handled using state inflation in exactly the same fashion.[foot : augment ] ] controlled dynamical system @xmath64 where @xmath65 is the state , @xmath66 is the control input , and the data are polynomial : @xmath67^n$ ] , @xmath68^n$ ] , @xmath69 .",
    "the system is subject to semi - algebraic state and box$ ] . ]",
    "input constraints    [ eq : xu ] @xmath70^m,\\end{aligned}\\ ] ]    where @xmath71^{n_g}$ ] and @xmath72 .",
    "the set @xmath12 is assumed compact and the polynomials defining @xmath12 are assumed to be such that @xmath73 since @xmath12 is assumed compact , we also assume , without loss of generality , that the inequalities defining the sets @xmath12 contain the inequality @xmath74 for some @xmath75 .",
    "the goal of the paper is to ( approximately ) solve the following optimal control problem ( ocp ) :    @xmath76\\,dt + e^{-\\beta \\tau}m    \\vspace{1.5mm}\\\\ \\displaystyle & & \\hspace{0.6 cm } \\mathrm{s.t . }   & x(t ) = x_0 + \\int_0^t f(x(s ) ) +   \\sum_{i=1}^m f_{u_i}(x(s))u_i(s)\\,ds , \\vspace{1.5mm}\\\\ \\displaystyle & & & ( x(t),u(t ) ) \\in x\\times u\\;\\ ; \\forall t \\in [ 0,\\tau(x_0 ) ]   \\vspace{1.5 mm } \\\\",
    "\\displaystyle & & & u \\in l^{\\infty}([0,\\tau(x_0)];u),\\ ; \\tau \\in l(x;[0,\\infty ] ) \\end{array}\\ ] ]    where @xmath77 is a given discount factor and @xmath78 is a constant chosen such that @xmath79 where the joint stage cost @xmath80 is , without loss of generality , assumed to be nonnegative on @xmath81 .",
    "the state and input stage cost functions @xmath82 and @xmath83 , @xmath69 , are assumed to be polynomial .",
    "the function @xmath84 in    ocp ( [ opt : main ] ) is referred to as a _ stopping function _ ; the optimization is therefore both over the control input @xmath62 and over the final time @xmath85 , which can be finite or infinite and can depend on the initial condition @xmath86 .",
    "the function @xmath87 in ( [ opt : main ] ) is called the _ value function_. the reason for choosing the slightly non - standard objective function in  ( [ opt : main ] ) is because with this objective function the value function @xmath88 is bounded ( by @xmath78 ) on @xmath12 and it coincides with the standard\\,dt $ ] and no stopping function . ] discounted infinite - horizon value function for all initial conditions @xmath89 for which the trajectories can be kept within the state constraint set @xmath12 forever using admissible controls , i.e. , for all @xmath86 in the maximum control invariant set associated to the dynamics  ( [ eq : sys ] ) and the constraints  ( [ eq : xu ] ) . to see the first claim , set @xmath90 for all @xmath89 . to see the second claim notice that with @xmath78 chosen as in  ( [ eq : m ] ) , it is always beneficial to continue the time evolution whenever possible and therefore @xmath91 for all @xmath86 in the maximum controlled invariant set associated to ( [ eq : sys ] ) and ( [ eq : xu ] ) .",
    "[ rem : m ] a constant @xmath78 satisfying  ( [ eq : m ] ) can be found either by analytically evaluating the supremum in  ( [ eq : m ] ) or by using the techniques of  @xcite to find an upper bound .",
    "given a lipschitz continuous _",
    "controller @xmath92 and a stopping function @xmath93)$ ] , the ode  ( [ eq : sys ] ) has a unique solution and we let @xmath94)$ ] denote the value function attained by @xmath95 in  ( [ opt : main ] ) , i.e. , setting @xmath96 . by @xmath97",
    "we denote the value function @xmath98 , where @xmath99)$ ] is the optimal stopping function associated to  @xmath62 .",
    "note that , by the choice of @xmath78 in  ( [ eq : m ] ) , the optimal stopping function @xmath100 is equal to the first hitting time of the complement of the constraint set @xmath12 , i.e. , @xmath101 where @xmath102 is the trajectory of  ( [ eq : sys ] ) with @xmath96 starting from @xmath86 .",
    "notice also that @xmath103 for all @xmath104 and that for any pair @xmath95 feasible in  ( [ opt : main ] ) we have @xmath105 for all @xmath104 .    throughout the paper , we make the following technical assumption :    [ as : smoothcont ] there exists a sequence of lipschitz continuous feedback controllers @xmath106 and stopping functions @xmath107)\\}_{k=1}^\\infty$ ] feasible in  ( [ opt : main ] ) such that @xmath108 and such that for every @xmath109 there exist a function @xmath110 and a scalar @xmath111 such that @xmath112 if @xmath113 and @xmath114 where @xmath115 denotes the solution to  ( [ eq : sys ] ) controlled by @xmath116 .",
    "[ rem : l1 ] note that @xmath117 on @xmath12 by construction and therefore  ( [ eq : valconv ] ) is equivalent to the @xmath118 convergence of @xmath119 to @xmath88 .",
    "assumption  [ as : smoothcont ] says that the optimal control inputs and stopping functions for ocp ( [ opt : main ] ) can be well approximated by lipschitz continuous _",
    "controllers and measurable stopping functions such that the resulting densities of the discounted occupation measures are continuously differentiable and vanish near the boundary of @xmath12 .",
    "note that the existence of an optimal feedback controller , as well as whether it can be well approximated by lipschitz controllers , are subtle issues .",
    "similarly it is a subtle issue whether asymptotically optimal stopping functions can be found such that the associated densities @xmath120 in  ( [ eq : smoothdens2 ] ) are continuously differentiable and vanish near the boundary of @xmath12 ( note , however , that the left hand side of  ( [ eq : smoothdens2 ] ) can always be represented as @xmath121 for some nonnegative measure  @xmath122 ) .",
    "this problem is of rather technical nature and has been studied in the literature ( e.g. ,  ( * ? ? ?",
    "* section  1.4 ) or  @xcite ) , where affirmative results have been established in related settings .",
    "we do not undertake a study of this problem here and rely on assumption  [ as : smoothcont ] , which is , for ease of reading , not stated in its most general form .",
    "for example , the functions @xmath120 do not need to be @xmath33 but only weakly differentiable and the integration on the left - hand side of  ( [ eq : smoothdens2 ] ) can be weighted by a nonnegative function @xmath123 satisfying @xmath124 on @xmath12 and @xmath125 in @xmath126 .",
    "in addition , we conjecture that it is enough to require @xmath127 on @xmath21 and not necessarily on some neighborhood of @xmath21 ; this is in particular the case when @xmath12 is a box or a ball but we expect all the results of the paper to hold with a general semialgebraic set for which the defining functions satisfy  ( [ eq : barg ] ) .    the main result of this paper is a hierarchy of sum - of - squares ( sos ) problems providing an explicit sequence of _ rational _ feedback controllers @xmath128 such that , under assumption  [ as : smoothcont ] , ( [ eq : valconv ] ) holds with @xmath129 , i.e. , a sequence of asymptotically optimal rational controllers in the sense of the @xmath118 convergence of the associated value functions ( see remark  [ rem : l1 ] ) .",
    "in this section we present an infinite - dimensional linear program ( lp ) in the space of continuous functions whose sum - of - squares ( sos ) approximations provide a sequence of _ rational _ controllers @xmath116 satisfying  ( [ eq : valconv ] ) .",
    "this infinite - dimensional lp is closely related ( and in a weak sense equivalent ) to ocp ( [ opt : main ] ) ; the rationale behind the derivation of the lp and its relation to ocp ( [ opt : main ] ) is detailed in section  [ sec : rationale ] .",
    "the infinite - dimensional lp reads @xmath130 the optimization in  ( [ opt : dual_inf ] ) is over functions @xmath131 with @xmath132 .    the optimal value of  ( [ opt : dual_inf ] )",
    "will be denoted by @xmath133 .",
    "the value attained in  ( [ opt : dual_inf ] ) by any tuple of densities @xmath134 feasible in  ( [ opt : dual_inf ] ) will be denoted by  @xmath135 .",
    "[ rem : nonunifweight ] note that we could have imposed @xmath136 for any polynomial @xmath137 nonnegative on @xmath12 .",
    "choosing a different @xmath138 has no impact on the asymptotic convergence of the value functions established in the rest of the paper as long as @xmath138 is strictly positive on  @xmath12 .",
    "it may , however , influence the speed of convergence in different subsets of  @xmath12 .",
    "in general we expect faster convergence where @xmath138 is large and slower convergence where it is small . choosing a non - constant @xmath138",
    "therefore allows to assign a different importance to different subsets of @xmath12 .",
    "the infinite - dimensional lp  ( [ opt : dual_inf ] ) is then approximated by a hierarchy of sum - of - squares  ( sos ) problems , which immediately translate to finite - dimensional semidefinite programs  ( sdps ) .",
    "the sos approximation of degree @xmath19 of  ( [ opt : dual_inf ] ) reads @xmath139_d^{3+m } } &   \\int_x l_x(x ) \\rho(x ) \\ , dx + \\sum_{i=1}^m\\int_x l_{u_i}(x)\\sigma_i(x)\\ , dx + m\\int_x \\rho_t(x ) \\ , dx \\\\ & \\hspace{0.0 cm } \\mathrm{s.t . }   & \\rho_t   - \\rho_0 + \\beta\\rho + \\mathrm{div}(\\rho f ) + \\sum_{i = 1}^m\\mathrm{div}(\\sigma_i f_{u_i } ) = 0\\\\ & & -\\rho \\in q_d(x ) + g_i\\mathbb{r}[x]_{d-\\mathrm{deg}\\ , g_i } + \\bar{g}\\mathbb{r}[x]_{d-\\mathrm{deg}\\ , \\bar{g } }   & \\hspace{-2 cm } i=1,\\ldots , n_g\\\\ & & \\rho_0 - 1 \\in q_d(x )   \\\\ & & \\bar{u}\\rho - \\sigma_i \\in q_d(x ) + \\bar{g}q_{d-\\mathrm{deg}\\ , \\bar{g}}(x ) & \\hspace{-2 cm } i=1,\\ldots , m\\\\ & & \\rho_t \\in q_d(x)\\\\ & & \\sigma_i\\in q_d(x ) + \\bar{g}q_{d-\\mathrm{deg}\\ , \\bar{g}}(x ) ,   & \\hspace{-2 cm } i=1,\\ldots , m . \\end{array}\\ ] ] once a basis for @xmath18_d$ ] is fixed ( e.g. , the standard monomial basis ) , the objective becomes linear in the coefficients of polynomials @xmath140 , @xmath141 and @xmath142 , and the equality constraint is imposed by equating the coefficients .",
    "the inclusions in the quadratic modules translate to semidefinite constraints and affine equality constraints ; see section  [ sec : sosprog ] .",
    "optimization problem  ( [ opt : dual_sos ] ) therefore immediately translates to an sdp .",
    "[ rem : feasibility ] trivially , any feasible solution to  ( [ opt : dual_sos ] ) is feasible in  ( [ opt : dual_inf ] ) . also , problem  ( [ opt : dual_sos ] ) is feasible for any @xmath49 . indeed @xmath143 is always feasible in  ( [ opt : dual_sos ] ) .",
    "see also remark  [ rem : termmeasure ] below .",
    "if non - uniform weighting of initial conditions ( see remark  [ rem : nonunifweight ] ) was required , the constraint @xmath144 would be replaced by @xmath145 for a polynomial weighting function @xmath137 nonnegative on @xmath12 .",
    "given an optimal solution @xmath146 to  ( [ opt : dual_sos ] ) , we define a rational control law @xmath147 by @xmath148    the main result of the paper is the following theorem stating that the controllers @xmath147 are asymptotically optimal :    [ thm : main ] for all @xmath43 we have @xmath149 for all @xmath150 and if assumption  [ as : smoothcont ] holds , then @xmath151 that is , @xmath152 in @xmath126 ( note that @xmath153 on @xmath12 ) .",
    "this section explains the rationale behind the lp problem  ( [ opt : dual_inf ] ) and its relation to the ocp  ( [ opt : main ] ) and gives the proof of theorem  [ thm : main ] .",
    "first , we lift the original problem  ( [ opt : main ] ) into the space of measures with nonnegative densities in @xmath154 ; this lifting is problem  ( [ opt : dual_inf ] ) .",
    "next we tighten the problem by considering only polynomials of prescribed degree and with nonnegativity constraints enforced via sos conditions ; this is problem  ( [ opt : dual_sos ] ) .",
    "importantly , the lifting  ( [ opt : dual_inf ] ) is a _ tightening _ of the original problem  ( [ opt : main ] ) as show in theorem  [ thm : tighten ] below .",
    "this is in contrast with  @xcite where the original problem was lifted into the space of measures and this lifting was a _",
    "relaxation_.    to be more concrete , observe that any initial measure @xmath155 , stopping function @xmath156)$ ] , and family of trajectories @xmath157 of  ( [ eq : sys ] ) generated by a lipschitz controller @xmath158 give rise to a triplet of measures defined by    [ eq : meas_def ] @xmath159    the measure @xmath11 is called _ discounted occupation measure _ , the measure @xmath160 _ terminal measure _ and the measures @xmath161 , @xmath162 , _ control measures_. these measures satisfy the _ discounted liouville equation _",
    "@xmath163 for all @xmath164 .",
    "this follows by direct computation ; see , e.g. , @xcite .",
    "notice also that @xmath165 , i.e. , @xmath161 is absolutely continuous with respect to @xmath11 with radon - nikodm derivative equal to @xmath166 .",
    "crucially , the converse statement is also true , although we have to go from stopping functions to stopping measures :    [ superposition][thm : meas_rep_crucial ] if measures @xmath11 , @xmath155 , @xmath160 and @xmath161 , @xmath167 , satisfy  ( [ eq : discountliouville_general ] ) with @xmath168 , @xmath169 and @xmath170 and @xmath171 for some lipschitz @xmath172 , then there exists an ensemble of probability measures ( i.e. , measures with unit mass ) @xmath173 and an ensemble of trajectories @xmath157 of the system  ( [ eq : sys ] ) controlled with @xmath96 such that @xmath174 for all @xmath175 and    [ eq : meas_traj ] @xmath176    for all @xmath164",
    ".    see appendix  b.    theorem  2 says that any measures satisfying  ( [ eq : discountliouville_general ] ) are generated by a superposition of the trajectories of the dynamical system @xmath177 , where the superposition is over the final time of the trajectories .",
    "note that there is a unique trajectory corresponding to each initial condition ( since the vector field @xmath178 is lipschitz ) but this unique trajectory can be stopped at multiple times ( in fact at a whole continuum of times ) allowing for superposition ; this superposition is captured by the stopping measures @xmath173 .",
    "for example , if the @xmath179 is a dirac measure at a given time , then there is no superposition ; if @xmath179 has a discrete distribution , then there is a superposition of finitely or countably many overlapping trajectories starting at @xmath86 stopped at different time instances ; if @xmath179 has a continuous distribution then there is a superposition of a continuum of overlapping trajectories starting from @xmath86 stopped at different time instances .    if in addition the measures @xmath155 , @xmath11 , @xmath160 satisfying the discounted liouville equation ( [ eq : discountliouville_general ] ) are absolutely continuous with respect to the lebesgue measure with densities @xmath180 , @xmath181 , @xmath182 such that @xmath183 on @xmath21 , then these densities satisfy @xmath184 with @xmath185 , @xmath69",
    "this follows directly by substituting @xmath186 , @xmath187 , @xmath188 and @xmath189 in  ( [ eq : discountliouville_general ] ) and using integration by parts .",
    "equation  ( [ eq : disc_liouville_functional ] ) holds almost everywhere in @xmath12 with a lipschitz controller @xmath62 , since lipschitz functions are differentiable almost everywhere and the integration by parts formula applies to them , and everywhere with @xmath190 .",
    "[ rem : termmeasure ] an important feature of the sos tightenings  ( [ opt : dual_sos ] ) is that they are feasible for arbitrarily low degrees ( see remark  [ rem : feasibility ] ) , which is crucial from a practical point of view and is not satisfied with other , more obvious , formulations ( e.g. , those not involving a stopping function in  ( [ opt : main ] ) ) ; the reason for this is that , in the absence of a terminal measure ( i.e. , @xmath191 ) , the discounted liouville equation  ( [ eq : disc_liouville_functional ] ) may not have a solution with a polynomial @xmath140 even though @xmath192 and the dynamics are polynomial .",
    "indeed , for example with @xmath193 , @xmath194 , @xmath195 , @xmath196 on @xmath197 $ ] and zero elsewhere , the only solution to  ( [ eq : disc_liouville_functional ] ) with @xmath191 is @xmath198 .",
    "theorem  [ thm : meas_rep_crucial ] immediately enables us to prove a representation of the cost of problem  ( [ opt : dual_inf ] ) in terms of trajectories of  ( [ eq : sys ] ) .",
    "[ lem : costrep ] if @xmath199 is feasible in  ( [ opt : dual_inf ] ) and @xmath200 , then @xmath201 where @xmath202 are trajectories of  ( [ eq : sys ] ) controlled by @xmath96 and @xmath179 are stopping probability measures with support @xmath203 included in @xmath204 $ ] . moreover",
    "the state - control trajectories @xmath205 and @xmath206 are feasible in  ( [ opt : main ] ) in the sense that @xmath207 and @xmath208 for all @xmath209 .",
    "let @xmath210 be feasible in ( [ opt : dual_inf ] ) and let @xmath211 denote the value attained by @xmath210 in  ( [ opt : dual_inf ] ) . the equality constraint of  ( [ opt : dual_inf ] )",
    "is exactly  ( [ eq : disc_liouville_functional ] ) .",
    "since the constraint of  ( [ opt : dual_inf ] ) implies @xmath183 on @xmath21 , equation ( [ eq : discountliouville_general ] ) holds with @xmath186 , @xmath187 , @xmath188 and @xmath189 , where @xmath212 , @xmath69 . by theorem  [ thm : meas_rep_crucial ] ( setting @xmath213 in  ( [ eq : meas_mu ] ) , @xmath214 in  ( [ eq : meas_mut ] ) and @xmath215 in ( [ eq : meas_nu ] ) ) we obtain the result ( noticing that the constraints of  ( [ opt : dual_inf ] ) imply that @xmath216 for all @xmath104 ) .",
    "[ cor : costub ] if @xmath199 is feasible in  ( [ opt : dual_inf ] ) and @xmath200 , then @xmath217 if in addition the stopping measures @xmath218 in  ( [ eq : costrep ] ) are equal to the dirac measures @xmath219 for some stopping function @xmath156)$ ] , then @xmath220    let @xmath210 be feasible in ( [ opt : dual_inf ] ) . using lemma  [ lem : costrep ]",
    ", @xmath211 has representation  ( [ eq : costrep ] ) , where the state - control trajectories in  ( [ eq : costrep ] ) are feasible in  ( [ opt : main ] ) . since the measures @xmath179 in  ( [ eq : costrep ] ) have unit mass for all @xmath221",
    ", we obtain  ( [ eq : costub ] ) .",
    "if @xmath222 for some stopping function @xmath156)$ ] , then the integrals with respect to  @xmath179 in  ( [ eq : costrep ] ) become evaluations at @xmath85 and hence ( [ eq : costexact ] ) holds .",
    "corollary  [ cor : costub ] immediately implies that the problem  ( [ opt : dual_inf ] ) ( and hence problem  ( [ opt : dual_sos ] ) ) is a tightening of the original problem  ( [ opt : main ] ) :    [ thm : tighten ] the optimal value of  ( [ opt : dual_inf ] ) of @xmath133 satisfies @xmath223    follows from corollary  [ cor : costub ] since @xmath224 and @xmath225 .",
    "now we are in a position to prove the following crucial lemma linking problems ( [ opt : main ] ) and ( [ opt : dual_inf ] ) .",
    "[ lem : conv ] if @xmath226 and @xmath227)\\}_{k=1}^{\\infty}$ ] are respectively sequences of controllers and stopping functions satisfying the conditions of assumption  [ as : smoothcont ] , then the corresponding densities @xmath228 with @xmath229 are feasible in  ( [ opt : dual_inf ] ) and satisfy @xmath230    conversely , if @xmath228 is a sequence such that @xmath231 and if assumption  ( [ as : smoothcont ] ) holds , then equation  ( [ eq : valconv ] ) holds with @xmath232 .    to prove the first part of the statement consider the controllers @xmath116 , stopping functions @xmath233 and densities @xmath120 from assumption  ( [ as : smoothcont ] ) . setting @xmath229 and defining @xmath234 and @xmath235",
    "we see that @xmath236 satisfy  ( [ eq : disc_liouville_functional ] ) with @xmath127 on @xmath21 .",
    "therefore  @xmath236 are feasible in  ( [ opt : dual_inf ] ) .",
    "in addition , in view of  ( [ eq : smoothdens2 ] ) , the representation  ( [ eq : costrep ] ) holds with @xmath237 .",
    "therefore by lemma  [ lem : costrep ] @xmath238 and hence  ( [ eq : opteq ] ) holds since @xmath239 satisfies  ( [ eq : valconv ] ) and @xmath229 for all @xmath109 .    to prove the second part of the statement ,",
    "let @xmath240 be any sequence such that @xmath231 .",
    "then this sequence satisfies  ( [ eq : opteq ] ) by theorem  [ thm : tighten ] and by the first part of lemma  [ lem : conv ] just proven .",
    "therefore  ( [ eq : valconv ] ) holds with @xmath241 since @xmath242 by corollary  [ cor : costub ] .",
    "we will also need the following result showing that nonnegative @xmath33 functions vanishing on a neighborhood of @xmath21 can be approximated by polynomials in @xmath243 vanishing on @xmath21 .",
    "[ lem : polyapprox ] let @xmath181 such that @xmath244 on @xmath12 and @xmath245 on @xmath246 for some @xmath247 .",
    "then for any @xmath248 there exists @xmath43 and a polynomial @xmath249 such that @xmath250 and @xmath251 on @xmath21 .    since @xmath252 on @xmath22",
    ", we can factor @xmath253 with @xmath254 given by @xmath255 since polynomials are dense in @xmath33 there exists for every @xmath256 a polynomial @xmath257 such that @xmath258 applying proposition  [ prop : putinar ] to @xmath259 we see that there exists @xmath260 for some @xmath261 such that @xmath262 defining @xmath263 we see that @xmath249 with @xmath264 and that @xmath265 on @xmath21 .",
    "finally , @xmath266 and @xmath267 therefore choosing @xmath268 such that @xmath269 gives the desired result .",
    "now we are ready to prove our main result , theorem  [ thm : main ] .",
    "* proof * ( of theorem  [ thm : main ] ) : consider the sequences @xmath270 , @xmath271 )   \\}_{k=1}^\\infty$ ] from  assumption  [ as : smoothcont ] .",
    "by the first part of lemma  [ lem : conv ] the sequence of associated densities @xmath272 generated by @xmath273 is feasible in  ( [ opt : dual_inf ] ) and satisfies  ( [ eq : opteq ] ) . by assumption  [ as : smoothcont ] , @xmath127 and @xmath274 on @xmath275 ( since @xmath276 ) with @xmath277 .",
    "hence by lemma  [ lem : polyapprox ] there exist polynomial densities @xmath278 , @xmath279 for some degrees @xmath280 such that @xmath281 @xmath282    @xmath283 for all @xmath69 ( since @xmath284^m $ ] for all @xmath104 and hence @xmath285 on @xmath12 ) .",
    "notice also that since @xmath286 , we have @xmath287 .",
    "next , since @xmath124 and @xmath288 , we can find , by corollary  [ cor : densnonneg ] , polynomial densities @xmath289 and @xmath290 such that @xmath291 @xmath292 since @xmath272 satisfy the equality constraint of  ( [ opt : dual_inf ] ) we have @xmath293 where @xmath294 + \\sum_{i = 1}^m\\mathrm{div}[(\\sigma_i^{k,\\mathrm{pol}}-\\sigma_i^k)f_{u_i}]\\ ] ] is a polynomial such that @xmath295 as @xmath296 in view of  ( [ eq : auxfirst])-([eq : auxlast ] ) .",
    "defining the constants @xmath297 and setting @xmath298 @xmath299 we see that @xmath300 and @xmath301 and @xmath302 are strictly positive on @xmath12 and hence belong to @xmath303 .",
    "the densities @xmath304 are therefore feasible in  ( [ opt : dual_sos ] ) for some @xmath280 . in addition , by construction , @xmath305 and @xmath306 as @xmath296 .",
    "therefore we have obtained a sequence of polynomial densities @xmath304 that are feasible in  ( [ opt : dual_sos ] ) and such that @xmath307 as @xmath308 .",
    "this implies that @xmath309 and hence @xmath304 satisfies  ( [ eq : opteq ] ) and so @xmath310 by theorem  [ thm : tighten ] .",
    "therefore  ( [ eq : valconv ] ) holds with the rational controllers @xmath311 by the second part of lemma  [ lem : conv ] .",
    "this finishes the proof .",
    "in this section we propose a converging hierarchy of approximations from below and from above to the value function @xmath97 associated to a rational controller @xmath200 with @xmath313^m$ ] and @xmath314 $ ] satisfying @xmath315 on @xmath12 .",
    "in addition we describe a hierarchy of approximations from below to the optimal value function  @xmath88 .",
    "this is useful as a post - processing step , once a rational control law has been computed as described in section [ hierarchy ]    , providing an explicit bound on the suboptimality of the controller .",
    "note that , trivially , approximations from above to @xmath97 provide approximations from above to  @xmath88 . defining @xmath316^n$ ] and",
    "@xmath317 $ ] , the degree @xmath19 polynomial upper and lower bounds are given by @xmath318_d } &   \\int_x \\overline{v_u}(x)\\,dx   \\\\ & \\hspace{0.0 cm } \\mathrm{s.t . }",
    "& \\beta \\rho\\overline{v_u }   - \\nabla \\overline{v_u }    \\cdot \\hat{f } - \\hat{l } \\in q_d(x )   \\vspace{1mm}\\\\ & & \\overline{v_u }   - m \\in q_d(x ) + \\bar{g}\\mathbb{r}_{d-\\mathrm{deg}\\,\\bar{g } } , \\end{array}\\ ] ] and @xmath319_d } & \\int_x \\underline{v_u } ( x)\\,dx   \\\\ & \\hspace{0.0 cm } \\mathrm{s.t . }   & -(\\beta \\rho\\underline{v_u } - \\nabla \\underline{v_u }    \\cdot \\hat{f } - \\hat{l } ) \\in q_d(x ) \\vspace{1 mm } \\\\ & & m - \\underline{v_u }   \\in q_d(x ) + \\bar{g}\\mathbb{r}_{d-\\mathrm{deg}\\,\\bar{g } } , \\end{array}\\ ] ] respectively . fixing a basis of @xmath18_d$ ] , the objective functions of ( [ opt : val_u_ub ] ) and ( [ opt : val_u_lb ] )",
    "become linear in the coefficients of @xmath320 respectively @xmath321 in this basis .",
    "problems  ( [ opt : val_u_ub ] ) and ( [ opt : val_u_lb ] ) are therefore convex sos problems and immediately translate to sdps ( see section  [ sec : sosprog ] ) .",
    "[ thm : vu_ub_lb ] let @xmath322 and @xmath323 denote solutions to  ( [ opt : val_u_ub ] ) and ( [ opt : val_u_lb ] ) of degree @xmath19",
    ". then @xmath324 on @xmath12 and @xmath325    see appendix  a.    as a simple corollary we obtain a converging sequence of polynomial over - approximations to @xmath88 , the optimal value function of  ( [ opt : main ] ) :    let @xmath326 denote the degree @xmath327 polynomial approximation from above to the value function associated to the rational controller @xmath328 obtained from  ( [ opt : dual_sos ] ) using  ( [ eq : ud_def ] ) .",
    "then @xmath329 on @xmath12 and @xmath330    now we describe a hierarchy of lower bounds on @xmath88 : @xmath331_d,\\ ;   p \\in \\mathbb{r}[x]_d^m } &   \\int_x \\underline{v } ( x)\\,dx   \\\\ & \\hspace{0.0 cm } \\mathrm{s.t . }   & l_x - \\beta \\underline{v } + \\nabla \\underline{v } \\cdot f + \\bar{u } \\sum_{i=1}^m p_i \\in q_d(x ) \\vspace{1 mm } \\\\ & & l_{u_i } + \\nabla \\underline{v } \\cdot f_{u_i } - p_i \\in q_d(x)\\\\ & & - p_i \\in q_d(x)\\\\ & & m - \\underline{v }   \\in q_d(x ) + \\bar{g}\\mathbb{r}_{d-\\mathrm{deg}\\,\\bar{g}}. \\end{array}\\ ] ]    if @xmath332_d$ ] is feasible in  ( [ opt : val_opt_lb ] ) , then @xmath333 on @xmath12",
    ".    follows by similar arguments based on gronwall s lemma as in the proof of theorem  [ thm : vu_ub_lb ] .",
    "the question whether @xmath334 converges from below to @xmath88 as degree @xmath19 in  ( [ opt : val_opt_lb ] ) tends to infinity is open ( although likely to hold ) .",
    "a proof would require an extension of the superposition theorem  [ thm : meas_rep_crucial_thm ] to non - lipschitz vector fields ( in the spirit of the finite - time superposition result of  ( * ? ? ? *",
    "theorem 4.4 ) ) or an extension of the argument of  @xcite to the case of @xmath335 , either of which is beyond the scope of this paper .    besides closed - loop cost function with respect to the ocp  ( [ opt : main ] )",
    ", one can assess other aspects of the closed - loop behavior of the dynamical system  ( [ eq : sys ] ) controlled by the rational controller @xmath336 .",
    "in particular , regions of attraction or maximum controlled invariant sets can be estimated by methods of  @xcite , which extend readily to the case of rational systems .",
    "this section demonstrates the approach on numerical examples . to improve the numerical conditioning of the sdps solved",
    ", we use the chebyshev basis to parametrize all polynomials .",
    "more specifically , we use tensor products of univariate chebyshev polynomials of the first kind to obtain a multivariate chebyshev basis .",
    "we note , however , that similar results , albeit slightly less accurate could be obtained with the standard multivariate monomial basis ( in which case the sdps can be readily formulated using high level modelling tools such as yalmip  @xcite or sosopt  @xcite ) .",
    "the resulting sdps were solved using mosek .",
    "as our first example we consider the nonlinear double integrator @xmath337 subject to the constraints @xmath338 $ ] and @xmath339 and stage costs @xmath340 and @xmath341 .",
    "the discount factor @xmath342 was set to 1 ; the constant @xmath78 to @xmath343 .",
    "first we obtain a rational controller of degree six by solving  ( [ opt : dual_inf ] ) with @xmath344 .",
    "the graph of the controller is shown in figure  [ fig : nl_doubleinteg_cont ] .",
    "next we obtain a polynomial upper bound @xmath320 of degree 14 on the value function associated to @xmath62 by solving ( [ opt : val_u_ub ] ) with @xmath345 .",
    "to assess suboptimality of the controller @xmath62 we compare it with a lower bound @xmath334 on the optimal value function of the problem  ( [ opt : main ] ) obtained by solving  ( [ opt : val_opt_lb ] ) with @xmath345 .",
    "the graphs of the two value functions are plotted in figure  [ fig : nl_doubleinteg_valfun ] .",
    "we see that the gap between the upper bound on @xmath97 and lower bound on @xmath88 is relatively small , verifying a good performance of the extracted controller .",
    "quantitatively , the average performance gap defined as @xmath346 is equal to @xmath347 .",
    "( 140,210 )    ( 120,0 )    ( 180,09)@xmath348 ( 290,10)@xmath349 ( 110,85)@xmath350 ( 240,-20 )    ( 140,210 )    ( 120,00 ) ( 195,10)@xmath348 ( 312,14)@xmath349      in our second example we apply the proposed method to a population model governed by @xmath351-dimensional controlled lotka - volterra equations @xmath352 where @xmath353 is the vector of ones and @xmath354 denotes the componentwise ( hadamard ) product .",
    "each component @xmath355 of the state @xmath65 represents the size of the population of species @xmath356 .",
    "the vector @xmath357 contains the intrinsic growth rates of each species and the matrix @xmath358 captures the interaction between the species .",
    "if @xmath359 , then species @xmath360 is harmful to species @xmath356 ( e.g. , competes for resources ) and if @xmath361 , then species @xmath360 is helpful to species @xmath356 ( e.g. , species @xmath356 feeds on species @xmath360 ) ; the diagonal components @xmath362 are normalized to one .",
    "the control inputs @xmath363^n$ ] and @xmath364^n$ ] represent , respectively , the inflow and outflow of new species from the outside . for our numerical example",
    "we select @xmath365 and model parameters @xmath366 which results in a system with four states and eight control inputs .",
    "the economic objective is to harvest species number one while ensuring that no species goes extinct .",
    "more specifically the cost function is @xmath367 and @xmath368 , where the vector @xmath369 is associated with the control input vector @xmath370 .",
    "therefore there is a reward for harvesting species number one and cost associated with both introduction and hunting of all other species , the cost of hunting being lower than the cost of introduction .",
    "the reason for choosing @xmath368 is in order to make the joint stage cost @xmath371  ( [ eq : joinstagecost ] ) nonnegative ; this choice does not affect optimality since @xmath372 irrespective of the control input applied .",
    "the non - extinction constraint is expressed as @xmath373 with @xmath374 and @xmath375 .",
    "we choose @xmath195 and @xmath376 .",
    "we apply the coordinate transformation @xmath377 and solve solve obtain a rational controller of degree eight by solving  ( [ opt : dual_sos ] ) .",
    "figure  [ fig : lotkavolterra ] we shows plots for two different initial conditions , one with low population size of the first species and one with high .",
    "finally , we evaluate the suboptimality of the extracted controller using the polynomial lower bound on the optimal value function of degree 11 obtained from  ( [ opt : val_opt_lb ] ) . using monte carlo simulation with 1000 samples of initial conditions drawn from a uniform distribution over the constraint",
    "set we obtain average cost of the extracted controller to be 0.89 whereas the lower bounds predicts average cost of 0.72 ; hence the extracted controller is no more than @xmath378 suboptimal ( modulo the statistical estimation error ) .",
    "note that we could also obtain a deterministic suboptimality estimate using the upper bound on the value function of the extracted controller obtained from  ( [ opt : val_u_ub ] ) . in this case , however , the upper bound  ( [ opt : val_u_ub ] ) is not informative .",
    "nevertheless , the monte carlo simulation along with the lower bound  ( [ opt : val_opt_lb ] ) is a viable alternative in this case , since the extracted controller is simple and hence trajectories of the controlled system can be simulated rapidly .",
    "( 140,180 ) ( 0,90 ) ( 120,90 ) ( 240,90 ) ( 360,90 )    ( 0,0 ) ( 120,0 ) ( 240,0 ) ( 360,0 )",
    "this paper presented a method to obtain a sequence of rational controllers asymptotically optimal ( under suitable technical assumptions ) in a discounted optimal control problem and a method to explicitly estimate suboptimality of each controller .",
    "the rational controller of a given degree is obtained by solving a single sum - of - squares problem with no extraction step .",
    "the sos problem solved is feasible for any degree and therefore this method allows to trade off complexity of the controller against performance .",
    "the approach is based on lifting the nonconvex optimal control problem into an infinite dimensional space of measures with continuous densities , where this problem becomes linear . crucially , this problem is a tightening of the original problem , which follows immediately from the representation result for solutions of the discounted liouville s equation with a terminal measure  ( theorem  [ thm : meas_rep_crucial_thm ] ) .",
    "asymptotic optimality of the extracted controllers then follows by approximating the asymptotically optimal continuous densities ( guaranteed to exist by assumption  [ as : smoothcont ] ) with polynomial densities in such a way that these densities correspond to the densities of the dynamical system ( this is the essence of the proof of theorem  [ thm : main ] ) .",
    "this appendix contains the proof of theorem  [ thm : vu_ub_lb ] ; we use the same notation as in section  [ sec : valapprox ] .",
    "the inequalities @xmath324 follow from gronwall s lemma by noticing that the constraints of  ( [ opt : val_u_ub ] ) and ( [ opt : val_u_lb ] ) imply that @xmath379 @xmath380 on @xmath12 and @xmath381 , @xmath382 on @xmath21 .",
    "we detail the argument for the inequality @xmath383 , the inequality @xmath384 being similar .",
    "given @xmath89 the inequality  ( [ eq : ubgron ] ) implies that @xmath385,\\ ] ] and therefore by gronwall s lemma @xmath386\\ , ds\\ ] ] and hence @xmath387\\ , ds\\ ] ] for all @xmath388 $ ] , where @xmath389 $ ] is the first exit time of @xmath12 .",
    "next we observe that @xmath97 , the value function associated to @xmath62 , is equal to @xmath390ds , & \\tau = \\infty \\\\",
    "me^{-\\beta \\tau } + \\int_0^\\tau e^{-\\beta s}\\big [ l_x(x(s\\ ! \\mid \\ !",
    "x_0 ) ) + \\sum_{i=1}^m l_{u_i}(x(s\\ ! \\mid \\ !",
    "x_0))u_i(x(s\\ ! \\mid \\ !",
    "x_0 ) ) \\big ] ds , & \\tau < \\infty . \\end{cases}\\ ] ] in view of  ( [ eq : grownaux ] ) , we conclude that @xmath391 if @xmath392 since @xmath393 is polynomial and hence bounded on @xmath12 ( and hence @xmath394 ) ; and we conclude that @xmath391 if @xmath395 since @xmath396 and @xmath397 on @xmath21 .",
    "convergence of the upper and lower bounds  ( [ eq : convublb ] ) follows from theorem  [ thm : meas_rep_crucial_thm ] using infinite - dimensional lp duality and standard results on the convergence of moment relaxations .",
    "the proof is similar to the proof of theorem 5 in  @xcite or theorem 3.6 in  @xcite and therefore we only outline it .",
    "the hierarchy of sos programming problems  ( [ opt : val_u_ub ] ) and ( [ opt : val_u_lb ] ) is dual to the hierarchy of moment relaxations of an infinite - dimensional lp in the cone of nonnegative measures whose dual is an infinite - dimensional lp in @xmath398 and feasible solutions of this dual provide upper or lower bounds on @xmath97 .",
    "crucial to applying infinite - dimensional duality results ( e.g. , ( * ? ? ?",
    "* theorem 3.10 ) ) is the boundedness of measures satisfying the discounted liouville equation  ( [ eq : discountliouville_general ] ) with @xmath399 and @xmath400 , where @xmath401 is the restriction of the lebesgue measure to @xmath12 . plugging @xmath402 in  ( [ eq : discountliouville_general ] ) we have @xmath403 . since @xmath404 and @xmath77",
    "we conclude that @xmath160 and @xmath11 are indeed bounded , which implies that @xmath161 is also bounded for @xmath69 . equally important",
    "is the absence of duality gap between the finite - dimensional moment relaxations and sos tightenings ( which are both sdp problems ) ; this follows immediately from the presence of the constraint @xmath405 among the constraints describing @xmath12 , which implies the boundedness of the truncated moment sequences feasible in the moment relaxations .",
    "the absence of duality gap then follows from  ( * ? ? ?",
    "* lemma  2 ) . @xmath312",
    "this appendix presents a proof of theorem  [ thm : meas_rep_crucial ] . we will prove a slightly more general version of the result from which theorem  [ thm : meas_rep_crucial ] immediately follows :    [ thm : meas_rep_crucial_thm ] let @xmath406 be globally lipschitz and let the nonnegative measures @xmath11 , @xmath155 , @xmath160 on @xmath407 satisfy @xmath408 for all @xmath409 .",
    "then there exists an ensemble of probability measures @xmath410 with @xmath411 $ ] and an ensemble of trajectories @xmath157 of the ode  @xmath412 and        theorem  [ thm : meas_rep_crucial ] follows from theorem  [ thm : meas_rep_crucial_thm ] by setting @xmath415 and modifying @xmath416 and @xmath417 outside the compact set @xmath12 such that @xmath418 is globally lipschitz , where @xmath419 is the lipschitz constant of @xmath420 on @xmath12 . ] . the conclusion that @xmath174 for all @xmath175 follows by taking @xmath421 in  ( [ eq : meas_traj_thm ] ) , where @xmath422 is the indicator function of a set @xmath423 , i.e. @xmath424 if @xmath425 and @xmath426 otherwise .",
    "suppose therefore that  ( [ eq : meas_traj_thm ] ) holds .",
    "first we will prove a simple result . in the rest of this appendix we will use the notation @xmath427 for the space of all compactly supported @xmath7-times continuously differentiable functions .",
    "since @xmath418 is globally lipschitz the solution @xmath102 is defined for all @xmath430 and all @xmath432 . therefore  ( [ eq : v_rep ] ) is well defined ( notice that @xmath433 is bounded and @xmath77 ) .",
    "direct computation then gives : @xmath434_{0}^\\infty \\\\   & = -   \\beta \\int_0^\\infty e^{-\\beta s}w(x(s \\ ! \\mid \\ !",
    "x(t \\!\\mid \\ !",
    "x_0 ) ) ) \\ , ds   + w(x(t \\!\\mid \\ !",
    "x_0 ) ) \\\\   & = \\beta v(x(t \\ ! \\mid \\ !",
    "x_0 ) ) + w(x(t \\!\\mid \\ ! x_0 ) ) .\\end{aligned}\\ ] ] setting @xmath435 , we arrive at  ( [ eq : trans_disc ] ) .",
    "we start with the simplest case of @xmath436 and @xmath437 , @xmath438 , @xmath439 , and some @xmath440 .",
    "first we will show that if @xmath441 solves  ( [ eq : discountliouville_general_thm ] ) then there exists a time @xmath442 such that @xmath443 .",
    "consider now any @xmath444 , @xmath445 and the associated @xmath446 solving  ( [ eq : trans_disc ] ) .",
    "then we have @xmath447 therefore , by lemma  [ lem : transporteq_sol ] , @xmath448 using  ( [ eq : v_rep ] ) again on @xmath449 we get @xmath450 or @xmath451 now pick @xmath452 ( to be specified later ) and consider the traces @xmath453 @xmath454 assuming there is no @xmath442 such that @xmath443 we have @xmath455 and since @xmath456 and @xmath457 are compact there exist ( by uryshon s lemma with mollification ) a function @xmath458)$ ] such that @xmath459 on @xmath456 and @xmath460 on  @xmath457",
    ". then the left hand side of  ( [ eq : derivaux ] ) is greater than or equal to @xmath461 whereas the right hand side is less than or equal to @xmath462 . since @xmath438 and @xmath77 we arrive at a contradiction with  ( [ eq : derivaux ] ) by picking a sufficiently large @xmath463 .",
    "therefore there exists a @xmath442 such that @xmath464 ( i.e. , @xmath465 and @xmath86 are on the same trace of the flow associated to @xmath466 ) .",
    "now we prove that @xmath467 .",
    "since @xmath468 and @xmath86 are on the same trace we have @xmath469 using again @xmath470 if @xmath445 we get @xmath471 @xmath472 consider the set @xmath473 since @xmath86 and @xmath465 are on the same trace ( and @xmath465 follows @xmath86 ) there exists @xmath474 , @xmath475 , such that @xmath459 on @xmath476 and @xmath477 elsewhere ( e.g. , let @xmath478 with appropriate mollification ) . with this choice of @xmath433",
    "the equation  ( [ eq : asmall ] ) gives @xmath479 and therefore @xmath467 since the integral is strictly positive .",
    "this proves the first two claims .",
    "to finish we observe that any solution to  ( [ eq : trans_disc ] ) satisfies @xmath480 therefore @xmath481 using  ( [ eq : v_rep ] ) we get @xmath482 since @xmath483 we conclude that @xmath484 i.e. , @xmath11 is indeed generated by trajectories of @xmath466 ( in this case by two trajectories , both starting at @xmath86 , one stopping at @xmath84 , the other one continuing to infinity with weights given by the ratio of masses of @xmath155 and @xmath160 ) .",
    "that is the measure @xmath179 is given by @xmath485 as expected .",
    "next we treat the case where @xmath486 for some @xmath487 and @xmath488 . using the same argument as in the previous case",
    "we can show that @xmath489 for all @xmath356 and that the condition @xmath490 holds with @xmath491 being the times to reach @xmath355 from @xmath86 .",
    "then we have @xmath492      in the same way as before we can show that the support of @xmath160 must be on the trace @xmath456",
    ". then we can define the measure @xmath493 by @xmath494 and show that it has to satisfy the condition @xmath495 .",
    "next , using the fact that the mapping @xmath496 is invertible , we obtain @xmath497 the conclusion of the theorem then holds with @xmath179 defined by @xmath498 i_a(\\infty ) , \\quad a\\subset [ 0,\\infty].\\ ] ]          l. ambrosio , g. crippa .",
    "existence , uniqueness , stability and differentiability properties of the flow associated to weakly differentiable vector fields . transport equations and multi - d hyperbolic conservation laws , lecture notes of the unione matematica italiana , vol . 5 , springer , 2008 .",
    "m. korda , d. henrion , c. n. jones .",
    "controller design and region of attraction estimation for nonlinear dynamical systems .",
    "ifac symp .",
    "nonlinear control systems , toulouse , france , 2013 . extended version : ` arxiv:1310.2213 ` , 2013 ."
  ],
  "abstract_text": [
    "<S> this work considers the infinite - time discounted optimal control problem for continuous time input - affine polynomial dynamical systems subject to polynomial state and box input constraints . </S>",
    "<S> we propose a sequence of sum - of - squares ( sos ) approximations of this problem obtained by first lifting the original problem into the space of measures with continuous densities and then restricting these densities to polynomials . </S>",
    "<S> these approximations are tightenings , rather than relaxations , of the original problem and provide a sequence of rational controllers with value functions associated to these controllers converging ( under some technical assumptions ) to the value function of the original problem . </S>",
    "<S> in addition , we describe a method to obtain polynomial approximations from above and from below to the value function of the extracted rational controllers , and a method to obtain approximations from below to the optimal value function of the original problem , thereby obtaining a sequence of asymptotically optimal rational controllers with explicit estimates of suboptimality . </S>",
    "<S> numerical examples demonstrate the approach .    optimal control , nonlinear control , sum - of - squares , semidefinite programming , occupation measures , value function approximation </S>"
  ]
}