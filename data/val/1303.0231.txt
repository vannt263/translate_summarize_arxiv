{
  "article_text": [
    "complex systems in diverse fields are often represented as weighted networks @xcite .",
    "inferring information transfer between network elements from such representations can provide important insights into system structure and perturbations @xcite .",
    "this paper proposes a general methodology to quantify such transfer based on information theory and probability on graphs .",
    "+ previous attempts to infer dynamics from weighted networks include an interaction model based on electrical circuitry , to discover active pathways contributing to the pathogenesis of the brain cancer glioblastoma multiforme @xcite .",
    "reference @xcite uses a model of infection transmission , proportional to interaction frequency , to identify the spread of disease through social networks .",
    "such case by case approaches have proved informative , however they are often tailor made to their applications and the _ general _ quantification of information transfer in weighted networks currently lacks a theoretical foundation .",
    "+ the purpose of this paper is to construct an information theoretic measure , _ network transfer entropy _ , quantifying the directed amount of information transferred between any two vertices in a weighted network , with minimal assumptions and general applicability . following construction ( section ii )",
    ", we demonstrate the measure on simple synthetic networks and a biological signalling network ( section iii ) . + in the construction of general measures ,",
    "one aims at an insight into the theoretical concepts governing the process being studied .",
    "we demonstrate that the network transfer entropy framework can be interpreted in the context of metric spaces ( section iv ) . in this construction one",
    "defines a family of mappings from the space of weighted networks ( represented by matrices ) to a family of metric spaces , whose elements describe possible signal dynamics on networks .",
    "+ we prove a convergence principle , demonstrating that a form of convergence of weighted networks in the metric space @xmath0 implies convergence in the constructed metric space of signal dynamics .",
    "this result shows that in our general framework , deformation of network structure influences network dynamics in an intuitive way .",
    "this result has real world implications in , for example , network drug design , where one wishes to modify the chemical affinities of interacting proteins in a pathological signalling network ( _ i.e. _ modify the edge weights ) to restore a healthy signalling regime ( _ i.e. _ modify the dynamics ) .",
    "finally , we motivate how certain further theoretical problems in network evolution and network perturbation can be approached within this framework .",
    "+      in this appendix we provide certain mathematical derivations and technical methodologies to accompany the main text . in appendix",
    "b we derive a closed form expression for the probability distribution @xmath69 $ ] , describing the signal at a vertex @xmath14 in a weighted network , given an initial signal distribution ( isd ) , @xmath70 , has traversed a path of length @xmath20 . following the derivation of this expression",
    "we will explain how the network transfer entropy ( nte ) framework leads to the construction of a family of mappings from the space of weighted networks to a family of metric spaces describing signal dynamics . in appendix c",
    "we explain how the nte may be estimated from a simulation of the markovian dynamic model introduced in the main text and how error may be compensated for in this estimation . in appendix",
    "d we explain in detail the application of nte to biological signal transduction , specifically the assignment of an isd and edge weights for each perturbation . in appendix",
    "e we state and prove aa convergence theorem in the metric space framework . finally ,",
    "in appendix f , we outline an approach to network evolution from the perspective of dynamic programming .",
    "_ transfer entropy _ was introduced by schreiber , to quantify the directed amount of information transferred between two mutually dependent time series @xcite .",
    "this problem shares several important qualities with our problem of information transfer between network vertices , thus we follow schreiber s approach in the derivation of our measure .",
    "+ the definition of transfer entropy required a model in which it was possible to express whether two time series influenced each other . for transfer entropy to be widely applicable , this model needed to be sufficiently general to portray a wide array of diverse systems .",
    "it was thus intuitive to describe time series as realisations of ( approximately ) markov processes of order @xmath1 .",
    "for such a process @xmath2 the conditional probability of finding the process in state @xmath3 at time @xmath4 satisfies @xmath5 these generalised markov process are not all encompassing in their descriptive power ; for example , they are in general not - applicable to studying subsystems of markov processes @xcite .",
    "however for a broad range of datasets including heart and breathing rate data @xcite , magnetoencephalography data @xcite and financial time series @xcite , the approximate markov process model can be justified , making transfer entropy widely applicable . +",
    "the choice of a general dynamic model for a weighted network requires consideration of the literature .",
    "one must be careful to ensure the model makes minimal assumptions yet has sufficient descriptive power to portray complex systems .",
    "much work has focused on interaction models known as _ flow networks _",
    "( see for example @xcite ) , in which transport from source nodes to sink nodes is subject to edge weight dependant constraints .",
    "these models are useful in optimisation problems where one wants to find paths through a network that maximise or minimise some function associated with path traversal , and thus tend to be used in systems where traffic can be manipulated , such as supply management @xcite . + flow networks are less useful in the interrogation of network dynamics where constraints on traffic are unknown , and sink and source nodes and not readily defined",
    ". moreover , when network dynamics are stochastic and bursty rather than continuous flows , such as in social communication systems @xcite and gene regulatory networks @xcite , adaptations of flow networks are required .",
    "such adaptations include discrete flow networks @xcite and stochastic flow networks @xcite , in which the interaction of a vertex with neighbours is given by a probability distribution proportional to the edge weight distribution .",
    "the elegance of these discrete models is that they may approximate continuous models ( such as flow networks ) in the large time limit .",
    "such models are generalised , for example by the inclusion of holding rates , in queuing theory @xcite which with detailed information for parameter estimation can be used to describe and simulate a large variety of real world systems .",
    "+ given this literature we take our dynamic model for weighted networks as a balance between the descriptive power of stochastic networks of queuing theory and the simplicity of the stochastic flow networks .",
    "we consider the following markovian model for signal dynamic evolution .",
    "each vertex is assigned a data derived value quantifying a signal that the given vertex is capable of forwarding to one its neighbours .",
    "the vector containing these values for every vertex is referred to as the _ initial signal distribution _",
    "( isd ) of the network . in real world applications",
    "this distribution can be qualitatively diverse .",
    "for example , in biological networks , where vertices represent genes , the isd may quantify the differential expression of genes in pathological versus healthy samples . in the airport transportation network where vertices are airports and edges connect airports one can fly between",
    "directly , the isd may be the number of flights departing from each airport over a given time frame @xcite .",
    "there are no restrictions on the isd other than it being a vector in @xmath6 , where @xmath7 is the number of vertices .",
    "+ we evolve this signal over the network @xmath8 , where @xmath9 for @xmath10 , via a stochastic matrix @xmath11 defined as @xmath12 where @xmath13 denotes the set of neighbours of vertex @xmath14 and @xmath15 denotes the kronecker delta of @xmath14 and @xmath16 .",
    "we evolve the isd over multiple discrete time steps . at each time",
    "step the signal at each vertex @xmath14 is independently forwarded to vertex @xmath17 with probability @xmath18 ( we emphasise that self - edges can be added to the network and the weights on such edges would determine the probability that a vertex maintains its signal over a single time step ) .",
    "thus the number of time steps directly corresponds to the maximal path length the isd has traversed .",
    "+ given an isd , @xmath19 , and path length , @xmath20 , for every vertex @xmath14 in the network we can compute the probability distribution of the signal at vertex @xmath14 given that the isd has been forwarded along paths of length @xmath20 ( see appendix b ) .",
    "we denote this distribution @xmath21 $ ] .",
    "+ given a model of interactions , we wish to quantify paths of high or low traffic through the network . to proceed in this aim it suffices to identify the directed amount of information transferred between any two pairs of network vertices during a period of system evolution .",
    "to achieve this we again turn to schreiber s methodology . in the derivation of transfer entropy the directed amount of information transferred from a process @xmath22 to a process",
    "@xmath2 is formulated as the incorrectness of the assumption that @xmath2 is not conditional on @xmath22 .",
    "this quantity can be expressed as the _ kullback - leibler divergence _ @xcite @xmath23 where @xmath24 for @xmath25 .",
    "thus to quantify the amount of information vertex @xmath16 in our network transfers to vertex @xmath14 over paths of length @xmath20 we must derive a distribution for @xmath26 in which vertex @xmath16 sends no information to vertex @xmath14 .",
    "we must then compute the informational distance between this distribution and the above distribution @xmath27 $ ] in which @xmath16 is able to communicate with @xmath14 .",
    "clearly if we set the @xmath28 row in the stochastic matrix @xmath29 to @xmath30 ( _ i.e. , _ make @xmath16 an absorbing state ; @xmath31 denotes the @xmath28 element of the standard basis of @xmath6 ) , then it is impossible for vertex @xmath16 to communicate with any vertex @xmath32 under our model . given this modified matrix we can compute the probability distribution of @xmath26 given the isd and that @xmath16 can not communicate with @xmath14 .",
    "we denote this distribution @xmath33 $ ] . here",
    "we diverge from @xcite , however , as the kullback - leibler divergence @xmath34\\log \\frac { p[x^{i}_{n}|\\vec{{x}}_{0 } ] } { p[x^{i}_{n}|\\vec{{x}}_{0},j]}\\ ] ] is only well defined provided @xmath35=0\\ } \\subset \\ { x : p[x^{i}_{n}=x|\\vec{{x}}_{0}]=0\\},\\ ] ] which is an assumption that does not hold in general .",
    "consider , for example , a directed graph on two vertices @xmath36 and @xmath37 , with a single directed edge oriented from @xmath36 to @xmath37 ; if we assign the isd as @xmath38 , then it is trivial that @xmath39 = \\delta_{x}^{1}$ ] and @xmath40=\\delta_{x}^{0}$ ] .",
    "+ thus to quantify the directed amount of information transferred from vertex @xmath16 to @xmath14 we must employ a different measure of statistical distance .",
    "there are several possible choices available , among the most promising are the _ jensen - shannon divergence _ , which is a linear combination of kullback - leibler divergences and the statistical distance introduced by wootters @xcite .",
    "both measures are theoretically rich ; wootter s measure was designed as a distinguishably distance between pure quantum states after a finite number of observations , and applies equally well to distinguishing two probability distributions .",
    "the measure also has a geometric interpretation in the context of hilbert space .",
    "the jensen shannon divergence of two distributions , quantifies the total kullback - leibler divergence from each distribution to the average of the two , and thus is a measure of distributional similarity .",
    "the jensen shannon divergence is also the square of a metric over the space of probability distributions on a measurable set @xcite .",
    "these two measures have been shown to agree to second order in a quantum mechanical framework @xcite .",
    "+ we will use the jensen shannon divergence defined by @xmath41 where @xmath42 $ ] are probability distributions ( with no restrictions placed on their kernels ) and @xmath43 .",
    "we select this measure as the metric interpretation is of greater use to our theoretical framework .",
    "+ whence we define the _ network transfer entropy _ ( nte ) from @xmath16 to @xmath14 over path length @xmath20 and given an isd @xmath19 by @xmath44 , p[x^{i}_{n}|\\vec{{x}}_{0},j])\\end{aligned}\\ ] ] this is the central concept of the paper . note that @xmath45 $ ] is inherently asymmetric , and thus quantifies information transfer through a network in a directed sense , permitting the inference of causality .",
    "in order to demonstrate the use of nte we consider three examples , two synthetic networks and one application to biological signal transduction . to evaluate nte in these examples , we estimated the probability distributions @xmath27 $ ] and @xmath33 $ ] for all @xmath16 , using a simulation .",
    "we also devised a method to estimate the statistical error in the probability distributions ( see appendix c ) .",
    "+ the first and most simple example we consider is a directed path of length 5 with equal edge weights ( figure 1 ) .",
    "this induces the stochastic matrix @xmath46        the structure of this network provides a completely predictable path for signal transfer and thus is ideal for proving the capability of our measure to detect information transfer .",
    "we consider two isds on this network , firstly @xmath47 , where the first vertex in the path is given an initial signal and all other vertices have no signal to transfer .",
    "if we number the vertices 1 to 5 from the start of the path to the end , then it is clear that for this isd , over path length @xmath48 , vertex 1 sends information to vertex 2 , and no other vertices communicate , for @xmath49 vertex 1 sends information to vertex 3 and vertex 2 sends information to vertex 3 and no other vertices communicate , and similarly we can compute all pairwise information transfer events up to @xmath50 beyond which all signal is absorbed at vertex 5 and can not be transmitted through the network .",
    "this pattern is precisely what is seen if we calculate the nte between all vertex pairs over different path lengths @xmath20 ( figure 1 ) .",
    "+ we next consider the isd @xmath51 , on the same network , in order to demonstrate the ability of the nte measure to discern between situations where networks with identical edge weights have different starting signal states .",
    "one would expect that with this isd , for @xmath48 , rather than just vertex 1 forwarding information to vertex 2 , we have vertex @xmath16 forwarding information to vertex @xmath52 for @xmath53 , and similar extensions for longer path lengths .",
    "the nte measure can detect these differences due to initial signal distribution ( figure 1 ) .",
    "+ the next network we consider is a slight extension to the deterministic path which constitutes a directed feedback from vertex 2 to vertex 4 weighted @xmath54 ( figure 2 ) .",
    "this induces the stochastic matrix @xmath55        the network introduces some indeterminism in that if vertex 4 holds signal , it can either forward it to vertex 5 with probability @xmath56 or feedback the signal to vertex 2 with probability @xmath57 .",
    "this essentially sets up a feedback loop which dampens the signal received at node 5 over a given path length , by a factor dependant on @xmath57 .",
    "we calculated the nte for all vertex pairs in this altered path for @xmath58 and found that as @xmath57 is increased the nte to vertex 5 from all other vertices falls , as expected ( figure 2 ) .",
    "thus in the context of these very simple synthetic networks , the use of nte as a tool for detecting information transfer is clear .",
    "+ we next demonstrate nte in a real world biological network .",
    "to do this we consider the human primary naive cd4 + t cell intracellular signalling network analysed by sachs _",
    "et al_. @xcite , consisting of 11 vertices ( figure 3 ) . in this network vertices are proteins which can be phosphorylated and directed edges connect kinases ( capable of phosphorylating proteins ) with their targets .",
    "the kinases must be in an active state before they can phosphorylate a target ; activity can be achieved by either phosphorylation by an upstream kinase or activation by a reagent .",
    "et al_. generated data accompanying this network consisting of quantification ( by flow cytometry ) of the amount of phosphorylated protein for each vertex in the network following ten independent perturbations .",
    "the network perturbations consisted of the administration of reagents which could either activate or inhibit the kinase activity of particular vertices . +        to apply nte we considered two of these perturbations , firstly treatment with anti - cd3 and anti - cd28 to activate the t - cells and induce flux through the network , secondly treatment with anti - cd3 , anti - cd28 and psitectorigenin , a reagent which specifically inactivates pip2 .",
    "we computed the nte between all vertex pairs in the network over paths of length @xmath59 for the two perturbations as described in appendix d ( see figure 5 in appendix d , for matrices of ntes for each perturbation ) .",
    "+ we found that in the psitectorigenin treated network information transfer from pip2 to the rest of the network was reduced over all path lengths ( figure 3 ) .",
    "specifically , information transfer from pip2 to pip3 was greatly reduced and information transfer from pip2 to plcg was reduced over paths of maximal length greater than one ( implying pip3 received less information from plcg via pip2 under psitectorigenin treatment ) . at longer path lengths we also see a reduced information transfer from pip2 to akt and p38 in the psitectorigenin treated network .",
    "this indicates that specific inhibition of pip2 can lead to decreased akt and p38 activation downstream of pip2 signalling .",
    "+ interestingly , we also notice that in the pip2 inhibited network , there is increased information transfer from pka to akt and from pkc to p38 .",
    "this points at a compensatory mechanism , in which inhibition of pip2 leading to reduced akt and p38 activation is compensated for by pkc dependant p38 activation and pka dependant akt activation . +",
    "thus our nte measure is capable of providing novel insights into signalling mechanisms in biological networks .",
    "in defining our nte measure we have additionally constructed a family of mappings from the space of weighted networks to a family of metric spaces , in which elements of the metric spaces correspond to signal dynamics on the networks .",
    "the mappings and structure of the metric spaces are parameterised by the path length parameter @xmath20 , the isd @xmath60 and the topology ( _ i.e. , _ the zero pattern , but not the edge weights ) of the network and their construction is explained in detail in appendix b. + this formalism allows a more theoretical treatment of dynamics on networks from the perspective of metric spaces , and permits a coupling between weighted network structure and dynamics . in certain fields , understanding the reaction of network dynamics to perturbations of edge weights is of great importance .",
    "this is particularly true of network drug design @xcite , in which one is interested in sequentially deforming the quantitative strengths of interactions in a pathological signalling network ( via drugs ) into those of a healthy network , with the aim of establishing a healthy gene expression dynamic and mitigating the pathology .",
    "if this notion of treatment is logical within our framework , then one would postulate that convergence in weight distribution of a sequence of networks to a limit distribution ( in a matrix metric space ) would imply convergence of the corresponding sequence of dynamics to the dynamics of the limit network ( in the network dynamic metric space ) .",
    "we state and prove a theorem in appendix e which establishes this postulate as true .",
    "this result demonstrates an intuitive coupling between network structure and dynamics within our framework . + further theoretical questions may consider which isds are maintained under different networks , these represent persistent ( attractor ) states of the network information distribution . to identify such states we note that every graph ( if we permit self edges at every vertex to represent a non - zero probability of signal maintenance ) admits a disjoint vertex cycle decomposition @xcite .",
    "thus there is always a way of sending signal around the network , without combining signal from two vertices at any one vertex .",
    "this implies that for every weighted network @xmath61 , with self edges , there must exist a permutation matrix @xmath62 , which admits at least one vector @xmath63 satisfying @xmath64 ( _ e.g. , _ the vector @xmath65 ) , such that @xmath66>0 $ ] .",
    "the state @xmath67 thus has a non - zero probability of being a persistent information state of the network .",
    "+ questions concerning the evolution of self - assembling networks can also be considered in our framework via an application of dynamic programming .",
    "an introduction to this approach is detailed in appendix f.",
    "we have derived a general information theoretic measure , network transfer entropy , for quantifying the amount of information transferred between any two vertices of a weighted network over paths of varying length .",
    "we have demonstrated our measure on simple synthetic weighted networks and applied it to biological signal transduction , revealing insights into the robustness of kinase signalling .",
    "we have also constructed a general metric space framework for dynamics on weighted networks and proved a convergence principle relating weighted network structure to dynamics .",
    "we outlined how problems in network evolution and network dynamic stability can be approached within our framework , formalisation of these approaches is a topic of future work .",
    "00 w. li , c .- c .",
    "liu , t. zhang , h. li , m. s. waterman and x. j. zhou , _",
    "plos comput biol _ ,",
    "* 7 * , 6 , ( 2011 ) .",
    "d. garlaschelli , t. di matteo , t. aste g. caldarelli and m. i. loffredo , _",
    "european physical journal b _ , * 57 * 2 , ( 2007 ) . m.  .",
    "serrano , m. bogu@xmath68 and a. vespignani , _ proc natl acad sci usa _ * 106 * 16 , ( 2009 ) .",
    "kim , s. wuchty and t. m. przytycka , _ plos comput biol _ , * 7 * , 3 , ( 2011 ) .",
    "z. tu , l. wang , m. n. arbeitman , t. chen and f. sun , _ bioinformatics _ , * 22 * , 14 , ( 2006 ) .",
    "j. m read , k. t. eames and w. j. edmunds , _ j r soc interface _ , * 5 * , 26 , ( 2008 ) .",
    "t. schreiber , _ phys rev lett _ , * 85 * , 2 ( 2000 ) .",
    "n. g. van kampen , _",
    "stochastic processes in physics and chemistry _ , vol .",
    "3 , north holland , ( 2007 ) .",
    "r. vicente , m. wibral , m. lindner and g. pipa , _ j comput neurosci _",
    ", * 30 * , 1 , ( 2011 ) .",
    "o. kwon , and j - s .",
    "yang , _ epl _ , * 82 * , 6 ( 2008 ) .",
    "r. k. ahuja , t. l. magnanti , and j. b. orlin , _ network flows : theory , algorithms , and applications _ , prentice hall , upper saddle river , new jersey ( 1993 ) p. baptiste , c. le pape , and w. nuijten , _ constraint - based scheduling : applying constraint programming to scheduling problems _ , vol .",
    "39 , springer , ( 2001 ) .",
    "j. stehl , a. barrat and g. bianconi , _ phys rev e _ , * 81 * , 3 , ( 2010 ) .",
    "j. paulsson , _ physics of life reviews _ , * 2 * , 2 , ( 2005 ) .",
    "lin , _ computers and operations research _ , * 28 * , 13 , ( 2001 ) .",
    "h. chen and a. mandelbaum , _ mathematics of operations research _ , * 16 * , 2 , ( 1991 ) .",
    "r. serfozo , _ introduction to stochastic networks _ vol .",
    "44 , springer verlag , ( 1999 ) .",
    "t. m. cover , and j. a. thomas , _ elements of information theory _ , wiley - interscience , ( 2006 )",
    ". w. k. wootters , _ phys rev d _ , * 23 * , 2 , ( 1981 ) .",
    "d. m. endres and j. e. schindelin , _ ieee transactions on information theory _ , * 49 * , 7 , ( 2003 ) .",
    "m. casas , p. w. lamberti , a. plastino , and a. r. plastino , arxiv preprint quant - ph/0407147 ( 2004 ) .",
    "k. sachs , o. perez , d. peer , d. a. lauffenburger and g. p. nolan , _ science signalling _",
    ", * 308 * , 523 ( 2005 ) .",
    "p. csermelya , t. korcsmrosa , , h. j. m. kissa , g. londond and r. nussinove , _ pharmacology and therapeutics _ , ( 2013 ) . j. a. bondy and u. s. r. murty , _ graph theory _ , vol .",
    "244 , springer , ( 2008 ) . g. k. smyth , _ stat appl genet mol biol _",
    ", * 3 * , article 3 , ( 2004 ) .",
    "to compute the probability distribution @xmath69 $ ] for a given weighted network @xmath8 , with corresponding stochastic matrix @xmath11 ( see main text ) we first note that @xmath71 = \\sum_{\\vec { x } } p[\\vec { x}_{n}=\\vec { x}|\\vec { x_{0}}]\\delta_{x_{i}}^{y},\\end{aligned}\\ ] ] where @xmath15 denotes the kronecker delta of @xmath14 and @xmath16 .",
    "+ in addition by the markovian nature of our dynamic model    @xmath72= \\sum_{\\vec { x}_{1},\\ldots , \\vec { x}_{n-1}}p[\\vec { x}_{n}=\\vec{{x}}|\\vec { x}_{n-1}]\\ldots p[\\vec { x}_1|\\vec { x}_{0}],\\end{aligned}\\ ] ]    reducing our problem to the calculation of the transition probabilities @xmath73 $ ] , between states and the states themselves which must be summed over .",
    "these are not , however , immediate . for the calculation consider the following : given we know the full signal distribution at time - point @xmath74 _ i.e. _ @xmath75 , then all possible states of signal distribution at time - point @xmath76 have the form @xmath77 here @xmath78",
    ", @xmath79 is a binary matrix with a single non - zero entry in every row ; the column index @xmath16 of the non - zero entry in row @xmath14 corresponds to the unique vertex @xmath16 that @xmath14 has sent its signal to during the time - step @xmath80 .",
    "we note that in addition @xmath81 if @xmath82 and that @xmath83 is independent of @xmath84 .",
    "+ thus every realisation of a single signal transfer event in a given weighted network can be represented as a matrix operation @xmath83 , independently of isd .",
    "we denote the set of such matrices by @xmath85 , and emphasise that it depends only upon the topology of the weighted network .",
    "+ it is clear that for @xmath86 the set @xmath85 must be countable , and its cardinality must be @xmath87 , where @xmath88 .",
    "moreover , it is clear that we can construct every element in @xmath85 given @xmath89 .",
    "+ following this , it is clear that given any isd @xmath70 the signal distribution at time point @xmath90 must have the ( possibly non - unique ) form @xmath91 where @xmath92 for @xmath93 . whence eq . can be expressed as    @xmath94= \\sum_{a_{1},\\ldots , a_{n-1 } \\in \\mathcal{a}}p[\\vec { x}_{n}= \\vec { x}|\\vec { x}_{n-1}= a_{n-1}^{t}\\ldots a_{1}^{t}\\vec{{x}}_{0}]\\ldots",
    "p[\\vec { x}_1=a^{t}_{1}\\vec { x}_{0}|\\vec { x}_{0}].\\end{aligned}\\ ] ]    thus to compute @xmath69 $ ] , it suffices to compute @xmath95,\\ ] ] which is simply the probability of the signal dynamic @xmath96 being selected from @xmath85 . by model construction",
    "this can be expressed as @xmath97 whence combining this with and we derive the closed form expression    @xmath98 = \\sum_{a_{1},\\ldots , a_{n } \\in \\mathcal{a } } \\delta _ { ( { a_{1}^{t}\\ldots a_{n}^{t}\\vec { x}_0})_{i}}^{y } \\prod_{r=1}^{n } \\prod_{k=1}^{n } \\sum_{j=1}^{n } p_{kj}{(a_{r}})_{kj}.\\end{aligned}\\ ] ]      we demonstrated above how , for a specific network @xmath61 , and isd @xmath19 we can calculate a set of matrices describing possible signal dynamics over a single time - step of our model , as well as a probability distribution describing the signal on the entire network after @xmath20 time steps .",
    "we will denote these constructs for the weighted network @xmath61 by @xmath99 and @xmath100 $ ] , respectively and stress that the former only depends on the topology of @xmath61 and not the edge weights , we will denote the topology of @xmath61 by @xmath101 ( topology in this context refers to the zero pattern of the network and is independent of the edge weights ) .",
    "the probability distribution @xmath100 $ ] is a measure over the finite set @xmath102 which we will denote @xmath103 .",
    "if we denote the space of probability measures over @xmath103 by @xmath104 , then it is clear that for any two weighted networks @xmath105 and @xmath106 with the same topology , @xmath107 , the probability distributions @xmath108 $ ] and @xmath109 $ ] are elements of @xmath110 .",
    "+ it has been shown that for any measurable space @xmath111 , the square root of the jensen shannon divergence induces a metric on the space @xmath112 @xcite , thus the quantity @xmath113,p_{w_{2}}[\\vec { x}_{n}|\\vec{{x}}_{0}])}\\ ] ] computes a metric distance between the probability distributions describing the dynamics on @xmath105 and @xmath114 . + thus our nte framework results in a mapping from the space of weighted networks to a family of metric spaces in which elements of the metric space represent possible signal dynamics .",
    "network transfer entropy is formulated as the jensen shannon divergence between two probability distributions .",
    "as explored above we can derive closed form expressions for these probability distributions , however , their evaluation can be computationally expensive , if there are multiple vertices of large degree .",
    "this is because a main step in the evaluation of the expressions is constructing the set @xmath85 of possible signal dynamics over a single time step , which for a network on @xmath7 vertices is of dimension @xmath115 .",
    "moreover , the time complexity of evaluation scales exponentially with the path length parameter @xmath20 .",
    "+ for most networks , however , estimation of the probability distributions involved in the nte expression can be done efficiently . as the model underlying these distributions is a discrete time markov chain , with a discrete state space",
    ", we can employ monte carlo simulation for any isd to provide realisations of the signal distribution on the entire network , for any path length parameter @xmath20 . from these realisations the probability of a specified signal level at vertex @xmath14 , given an isd and path length parameter @xmath20 , can be estimated as the proportion of simulations in which the specified level is achieved .",
    "+ two major considerations need to be addressed to ensure accurate estimation from this procedure .",
    "firstly , it is clear that the more simulations of the model performed , the more accurate the estimate of the probability distribution , moreover the estimate computed from @xmath116 simulations will converge to the true distribution as @xmath117 . thus it is essential to select @xmath116 sufficiently large to ensure that the estimated distribution is sufficiently near the true distribution with high probability .",
    "secondly , given a specified @xmath116 it is important to establish how the error in estimating the probability distributions translates to error in estimating the nte .",
    "+ to address the first issue , we consider only the full network _",
    "i.e. , _ without any vertices set to absorbing state , as the stochastic matrix for the full network will have the fewest deterministic vertices , and thus will be the hardest to estimate probability distributions for .",
    "for each probability to be estimated we construct a trace plot describing the change of the estimate with the number of simulations @xmath116 .",
    "this plot allows us to assess convergence of the estimate as @xmath116 is increased .",
    "we select the number of simulations @xmath116 for each network as the maximal @xmath116 such that , the shape of the trace plots indicates convergence and the estimates ( for every vertex signal probability ) at @xmath116 and @xmath118 differ by no more than @xmath119 .",
    "+ to address the second issue of error in the nte after selecting @xmath116 , we computed multiple ( @xmath120 ) estimations of the signal probability distributions for the full network from @xmath116 simulations .",
    "we then computed , for every @xmath121 estimate pair , the jensen shannon divergence between the two estimates of the signal distributions at each vertex .",
    "this jensen shannon divergence , computed for vertex @xmath14 , can be interpreted as the nte from a vertex @xmath16 to @xmath14 , when @xmath16 sends no information to @xmath14 , if the estimation is perfect , this quantity should be zero .",
    "as the estimation is imperfect we obtain @xmath121 estimates of the error in the nte , deriving from error in the estimation of the probability distributions from simulation , for each receiving vertex . from these estimates",
    "we can estimate the first two moments of the error distribution , a nte for a given receiving vertex is considered not attributable to error , provided it lies at least two standard deviations above the maximal error observed for the vertex .",
    "to compute the ntes over the two perturbations of the biological signalling network considered in the main text we must first define the isd and the edge weights from the data . as the kinases in the network",
    "must be phosphorylated to phosphorylate their direct targets , two connected proteins with highly positively correlated phosphorylation levels across single cell observations under a given perturbation , are likely interacting .",
    "thus a suitable edge weight which captures the strength of a phosphorylation interaction represented by an edge @xmath122 under a given perturbation @xmath1 is @xmath123 , where @xmath124 is the pearson correlation of phosphorylated protein levels across single cell measurements under perturbation @xmath1 .",
    "+ defining the isd is less trivial and requires consideration of the question we wish to answer and some technicalities . to determine the differences in information transfer between the two perturbations",
    ", it makes sense to consider an isd which quantifies the difference in phosphorylated protein levels between the two treatments .",
    "a technical issue to consider is how different signal distributions on the same network lead to different nte values between vertices .",
    "it is clear that weighting a vertex with a non - zero signal leads to a higher nte value between that vertex and its downstream interaction partners ( depending on the value of @xmath20 ) than weighting the vertex with zero signal .",
    "thus vertices with an information deficit in one perturbation versus another should be weighted with zero signal in that perturbation and a non - zero signal in the other .",
    "+ a more subtle issue concerns the number of unique signal values attainable at each vertex for a given isd and how this relates to the nte .",
    "it is somewhat intuitive that if the inputs to a given vertex each have a unique initial signal value , then the range of values attainable by the receiving vertex will be more diverse than if all the inputs had the same initial signal value .",
    "thus one may hypothesise that the nte from one vertex to another vertex , with multiple inputs , will be larger if the input vertices have unique initial signal values than if they have identical signal values .",
    "+ to explain this concept , consider the network shown in figure 4 , consisting of one central vertex with 3 possible inputs , which are each as likely to forward signal to central vertex as they are to forward signal to a separate independent neighbour .",
    "we consider the effect of the isd on the nte from the circled vertex to the central vertex for path length parameter @xmath48 via two cases . in the first scenario",
    "the initial signal at every input vertex is identical ( in this example this signal value is one ) , while the signal at every other vertex starts at zero . in the second case",
    "every input vertex is given a unique value ( in our example these values are simply 1 , 2 and 3 ) , while the other vertices are again given initial signals of 0 .",
    "consider the probability distribution of signal at the central vertex after a single signal transfer event .",
    "for the first isd , this distribution can take 4 unique values ( namely 0 , 1 , 2 and 3 ) , however for the second isd , with unique signal values at the inputs , the distribution can take 7 values ( integers 0 through 6 ) .",
    "now consider the signal distribution at the central vertex given that we prevent the circled vertex from sending information .",
    "for the first isd , this distribution now admits only 3 possible values ( 0 , 1 and 2 ) , while for the second isd only 4 possible values are now attainable ( 0 , 2 , 3 and 5 ) .",
    "thus the size of the  coding alphabet \" at the central vertex after removal of input from the circled vertex has shrunk from 4 to 3 under the first isd but from 7 to 4 under the second isd ( a much greater fall ) .",
    "consequentially , we notice that the nte from the circled vertex to the central vertex is lower for the first isd than the second isd .",
    "+ if we follow this concept that inputs with unique initial signal send more information to their outputs , it is logical that vertices with significantly higher signal in one perturbation versus another should be given a unique initial signal value in the first perturbation , reflecting their capacity to send more information about the network .",
    "+ all that remains now is to consider how to assign initial signal to vertices which do not display a great difference in signal distribution across the two perturbations .",
    "one solution to this problem is to assign all these vertices an identical initial signal , in this way they can transfer more information than vertices with a signal deficit in one perturbation versus another but less information than vertices with a signal surplus . + guided by these concepts we constructed the isd for each perturbation as follows .",
    "we utilised the limma package in r @xcite to compute t - values testing , for each vertex in the network , the hypothesis that the phosphorylated protein level of the vertex was significantly different in the two treatments .",
    "if for a given vertex the phosphorylated protein levels were significantly lower ( @xmath125 ) in one perturbation versus another it was assigned an initial value of zero in that perturbation and a unique initial value ( here chosen as the absolute t - statistic of the test ) in the other perturbation .",
    "all vertices which did not display significant changes between the two perturbations were assigned the same non - unique initial value of 1 in both perturbations .",
    "+ the isds and edge weights for the two perturbations alongside nte matrices computed for each perturbation are provided in figure 5 .",
    "in this appendix we prove the following theorem    let @xmath126 be a sequence of weighted networks on @xmath7 vertices of fixed topology , @xmath107 , and let @xmath127^{n \\times n}$ ] be the corresponding row normalised stochastic matrices for the sequence .",
    "let @xmath128^{n \\times n}$ ] be a stochastic matrix of topology @xmath107 . if @xmath129 in @xmath130 , @xmath131 , as @xmath132 , then for fixed isd @xmath19 and path length parameter @xmath20 , the signal distributions @xmath133 \\rightarrow p_{p}[\\vec { x}_{n}|\\vec{{x}}_{0}]\\ ] ] as @xmath132 in the metric space @xmath134      firstly we define the @xmath135 norm of a matrix @xmath136 @xmath137 a well - known and easy to derive bound on @xmath135 spaces , which holds for any @xmath138 is @xmath139 + fix @xmath140 . as @xmath129 in @xmath130",
    ", we have that : there exists @xmath141 such that for all @xmath142 , @xmath143 + let us define the matrix @xmath144 via @xmath145 it is clear that @xmath146 .",
    "+ we now consider for a fixed isd @xmath19 and path length parameter @xmath20 the distributions @xmath147 $ ] and @xmath148 $ ] , which we will hereafter refer to as @xmath149 and @xmath150 .",
    "it was shown above that    @xmath151    the set of possible signal dynamics @xmath85 for a given weighted network was also explicitly constructed above and was shown to depend only on the network topology and not on the edge weights of the network .",
    "consequentially as the sequence @xmath152 and the network @xmath29 have the same topology @xmath107 , the set of possible signal dynamics @xmath85 is the same for every element of the sequence and the network @xmath29 .",
    "+ consider expanding the product    @xmath153\\notag\\\\ & \\ldots &   \\bigg[\\big(\\sum_{j=1}^{n } ( p^{m}_{1j}(a_{n})_{1j } -\\sum_{j=1}^{n }",
    "\\delta^{p}_{1j})(a_{n})_{1j}\\big ) \\ldots   \\big(\\sum_{j=1}^{n } ( p^{m}_{nj}(a_{n})_{nj } -\\sum_{j=1}^{n } \\delta^{p}_{nj})(a_{n})_{nj}\\big)\\bigg].\\end{aligned}\\ ] ]    grouping together terms we can express the product as    @xmath154 + o(\\epsilon).\\end{aligned}\\ ] ]    we will denote the second term in the above expression by    @xmath155\\end{aligned}\\ ] ]    substitution of into yields    @xmath156.\\end{aligned}\\ ] ]    clearly from the first term can be expressed    @xmath157    for the second term , notice that    @xmath158    where the second inequality follows from @xmath146 and @xmath159 by construction of the set @xmath85 . the final inequality follows from the facts that @xmath160 and @xmath161 .",
    "given these bounds and eq .",
    "it follows that @xmath162 an identical argument can be used exchanging @xmath163 and @xmath29 , in which case the sign of @xmath164 in changes to positive , however the bound established in bounds the modulus of @xmath164 and thus will always be greatest than the largest negative or largest positive value of @xmath164 . thus we obtain the symmetric bound @xmath165 let us define @xmath166 it follows from and that @xmath167 and @xmath168 thus it follows that    @xmath169    by algebra of limits , it is clear that as @xmath170 @xmath171 and @xmath172 whence it follows that @xmath173 as @xmath132 and the theorem is true .",
    "+ we note that the theorem also holds if the topologies of the sequence of weighted networks and limit network are different from one another , the proof of this statement follows precisely as above , the only difference being the set @xmath85 utilised is that induced by the complete graph topology .",
    "as mentioned in the main text the evolution of self - assembling networks can also be considered in our framework via an application of dynamic programming . to see this we consider the space @xmath85 ( explicitly constructed above ) containing matrix representations of all possible single path length , signal forwarding choices , induced by the complete graph on @xmath116 vertices .",
    "we note that for every weighted network , @xmath61 , on @xmath7 vertices , where @xmath174 , the corresponding stochastic matrix @xmath29 can be expressed as a convex combination of elements in @xmath85 , @xmath175 where @xmath176 , @xmath177 , @xmath178 for all @xmath16 .",
    "if one interprets the space @xmath85 as a state space of possible choices of signal dynamics through the network and considers @xmath179 as a policy , giving a probability distribution of selecting a given global signal dynamic from the state space , that has been obtained by some optimality criterion , then one has a dynamic programming framework for network dynamic evolution .",
    "we note that one can calculate the policy explicitly , as @xmath180 $ ] .",
    "thus we have information to guide to construction of an optimality criterion describing network evolution .",
    "forms of such a criterion can be posited and parameterised for different systems and suitable parameter regimes can be reverse engineered from the policy solution @xmath181 ."
  ],
  "abstract_text": [
    "<S> a measure is derived to quantify directed information transfer between pairs of vertices in a weighted network , over paths of a specified maximal length . </S>",
    "<S> our approach employs a general , probabilistic model of network traffic , from which the informational distance between dynamics on two weighted networks can be naturally expressed as a jensen shannon divergence . </S>",
    "<S> our _ network transfer entropy _ measure is shown to be able to distinguish and quantify causal relationships between network elements , in applications to simple synthetic networks and a biological signalling network . </S>",
    "<S> we conclude with a theoretical extension of our framework , in which the square root of the jensen shannon divergence induces a metric on the space of dynamics on weighted networks . </S>",
    "<S> we prove a convergence criterion , demonstrating that a form of convergence in the structure of weighted networks in a family of matrix metric spaces implies convergence of their dynamics with respect to the square root jensen shannon divergence metric . </S>"
  ]
}