{
  "article_text": [
    "we consider the problem of european and american option pricing and refer to  @xcite and the references therein for an introduction into computational methods for option pricing . while european options can be modeled by a parabolic partial differential equation , american options result in additional inequality constraints .",
    "different models can be used to price european and american options .",
    "the simplest ones , e.g. , the black - scholes model  @xcite , assume that the volatility is constant .",
    "however , in most of the cases , the real market violates this assumption due to its stochastic nature .",
    "thus , alternative models , which try to capture this phenomenon are frequently used , e.g. , the heston stochastic volatility model  @xcite .",
    "another difficulty which arises with solving partial differential equations ( pdes ) for option pricing , in particular for pricing american options , is that for most of the models no closed form solution exists .",
    "thus one has to develop appropriate numerical methods .",
    "the common methods to solve pricing equations with the heston model are finite differences , cf .",
    "@xcite and finite elements , cf .",
    "we refer to  @xcite for a possible numerical treatment of basket options with the black - scholes model by primal - dual finite elements and to  @xcite for an abstract framework on the theory of constrained variational problems .",
    "we are interested in providing fast numerical algorithms to accurately solve the variational equality and inequality systems associated with european and american call and put options for a large variety of different parameter values such as , e.g. , interest rate , dividend and correlation . reduced basis ( rb ) methods",
    "are an appropriate means for standard parametrized parabolic partial differential equations , cf . @xcite and the references therein .",
    "these techniques are based on low - dimensional approximation spaces , that are constructed by greedy procedures .",
    "convergence behavior is known in some cases @xcite .",
    "the computational advantage of rb - methods over standard discretization methods is obtained by its possible offline / online decomposition : first , a typically expensive offline - phase involving the computation of the reduced spaces is performed .",
    "this phase only needs to be precomputed once .",
    "then , the online phase allows an extremely fast computation of the rb solutions for many new parameters as only low dimensional systems need to be solved .",
    "recently , we adopted the rb methodology to constrained stationary elliptic problems @xcite , which we extend here to the instationary case .",
    "we refer to the recent contribution  @xcite for a tailored rb approach in option pricing with diffusion and jump - diffusion models , which later was generalized to basket options  @xcite and , in fact , was shown to be a variant of a proper orthogonal decomposition method ( pod )  @xcite .",
    "the application of the reduced basis method can be also extended to the calibration of option pricing models , e.g. ,  @xcite .",
    "in contrast to our setting , no inequality constraints are taken into account there .",
    "further work relevant for rb - methods and variational inequalities comprises @xcite , which addresses a time - space formulation of the problem and corresponding analysis .",
    "also , recently , ongoing work has been presented in  @xcite , which alternatively treats the inequality constraints both by a primal - dual technique and a penalization approach .",
    "one main challenge in our problem setting is the construction of a suitable low dimensional approximation of the dual cone required for the treatment of the constraints . in this work",
    ", we present an algorithm to overcome this difficulty which is based on the greedy procedure and tries to capture as much `` volume '' as possible in the construction of the dual cone .",
    "this is obtained by iteratively selecting snapshots maximizing the angle to the current space . as second main ingredient for treatment of additional inequality constraints , we provide analytical results , in particular a posteriori error control .",
    "let us briefly relate the current presentation to our previous works .",
    "in contrast to @xcite , which dealt with rb methods for stationary variational inequalities , we treat here instationary problems . in this way , we apply sharper a posteriori error estimator strategies , which can straightforwardly be applied to the stationary case and gives improvements over @xcite .",
    "in @xcite we presented an rb procedure for american option pricing with a black - scholes model and gave first simple examples .",
    "the current presentation considerably extends this by including the heston model and both european and american options and providing an analysis for the corresponding rb scheme .",
    "the content of this paper is structured as follows : in section  [ sec : var_form ] , we present both a strong and a variational formulation of pricing of european and american options with the black - scholes and heston model . in section  [ sec : rb ] , a reduced basis method is introduced together with the construction of the primal and dual reduced basis spaces .",
    "section  [ sec : error_analysis ] contains the a posteriori error analysis induced by the method and derived from equality and inequality residuals .",
    "the implementational aspects of the reduced basis method together with the construction algorithms for reduced basis spaces are presented in section  [ sec : implementation ] .",
    "numerical results , given in section  [ sec : results ] , illustrate the performance of the method for pricing options in one dimensional black - scholes and two dimensional heston models .",
    "in this section , we give a brief introduction to the theory of option pricing .",
    "an option is a contract which permits its owner the right to buy or sell an underlying asset ( a stock , or a parcel of shares ) at a prespecified fixed strike price @xmath0 before or at a certain time @xmath1 , called maturity .",
    "there are two basic types of an option : a _ call _ option which gives a holder a right to buy and a _ put _ option which allows an owner to sell an underlying asset .",
    "also one distinguishes between european options , where exercise is only permitted at maturity @xmath2 and american options which can be exercised at any time before an expiration time @xmath2 . we will denote the price of the underlying asset by @xmath3 , where @xmath4 is the time to maturity @xmath2 .    in standard option pricing models , e.g. , the black - scholes model  @xcite",
    ", a price of the underlying asset @xmath5 follows a stochastic process , governed by the following stochastic differential equation @xmath6 with a wiener process @xmath7 , a drift @xmath8 and a volatility @xmath9 .",
    "one of the main limitations of these models is the assumption that the volatility of the return on the underlying asset is constant @xmath10 , while in financial markets , the volatility is not a constant , but a stochastic variable .",
    "the heston stochastic volatility model  @xcite takes into account the randomness of the volatility and is based on the following stock price and variance dynamics @xmath11 where @xmath12 follows a square root process ( known as a cox - ingersoll - ross ( cir ) process ) with the mean variance @xmath13 , rate of mean reversion @xmath14 and so called volatility of volatility @xmath15 .",
    "the wiener processes @xmath16 and @xmath17 are correlated with the correlation parameter @xmath18 $ ] .    with the use of ito s formula  @xcite",
    ", each model can be formulated in terms of a partial differential equation ( pde ) . for purposes of brevity",
    ", we omit the derivation of the equations .",
    "the reader is referred to  @xcite for further details .",
    "we define the spatial differential operators corresponding to the black - scholes and heston model as follows @xmath19 where @xmath20 is the interest rate and @xmath21 is the dividend payment . then the value of an option @xmath22 in the black - scholes model and @xmath23 in the heston model paying @xmath24 at maturity time @xmath2 must satisfy the following partial differential equation @xmath25 where the value @xmath24 is called a payoff function and @xmath26 , @xmath27 for the black - scholes and the heston model , respectively .",
    "[ remark : bs ] assuming a constant volatility in the heston model and no dividend payment in the black - scholes model , @xmath28 , we have @xmath29 and @xmath30 , and the heston equation reduces to the black - scholes equation with the constant volatility @xmath31 .    for further derivation of the weak formulation of the problem ( [ eq : heston1 ] ) , we introduce the following notation .",
    "let @xmath32 , @xmath33 , be a bounded open domain with lipschitz continuous boundary @xmath34 .",
    "we consider @xmath35 for the black - scholes model and @xmath36 for the heston model .",
    "note that this is not a limitation for the rb - approach that we present .",
    "higher dimensional problems can readily be treated , as soon as suitable solvers for the discretized pde are available .",
    "we introduce the following functional space @xmath37 where @xmath38 denotes a dirichlet portion of the boundary @xmath39 .",
    "further @xmath40 and @xmath41 denote the inner product and norm of @xmath42 , similar for other spaces . in the error analysis ,",
    "we make use of a norm bound , i.e. we denote by @xmath43 a constant that satisfies , for any @xmath44 : @xmath45 in the experiments , we use @xmath46 or weighted @xmath46 norms for @xmath42 , but for the sake of generality of our analysis , we introduce this generic constant that includes other frameworks , e.g. , @xmath47 norm for which @xmath43 is the friedrichs - poincar constant .",
    "we define a backward time variable @xmath48 which we will use throughout the paper .",
    "this transforms the pde ( [ eq : heston1 ] ) into a standard forward evolution problem .",
    "we denote by @xmath49 , by  @xmath50 \" the hadamard product and introduce a parameter @xmath51 , @xmath52 , which parametrizes ( [ eq : heston1 ] ) .",
    "we set @xmath53 for the black - scholes model and @xmath54 for the heston model .",
    "we start our consideration with the simplest case of pricing the european type of options .",
    "since puts and calls of the european option can be easily interchanged via a put - call parity relation  @xcite , it suffices for us to consider , e.g. , only call options .",
    "in addition , there exists a semi - closed analytical solution for these options in the black - scholes and heston models .",
    "however , while the black - scholes formula  @xcite provides almost the exact value of the european option , the heston semi - analytical formula  @xcite requires some numerical techniques to approximate the integral .",
    "thus , it is more interesting to consider the case of the heston model",
    ". then the value of a european call option @xmath55 , @xmath56 ( the relation to @xmath57 being established soon ) satisfies the following linear equation @xmath58 , \\label{eq : eo1}\\end{aligned}\\ ] ] subject to initial and boundary conditions @xmath59 the description of the boundary conditions can be interpreted as follows : for a large stock price @xmath60 , we use a neumann boundary condition which establishes a linear growth of an option price .",
    "when the volatility @xmath61 is 0 , we can not impose any boundary conditions and assume that the equation ( [ eq : eo1 ] ) is satisfied on the line @xmath62 . when the stock price is worthless @xmath63 ,",
    "it is natural to assume that the value of the call is also worthless .",
    "the option price is increasing with the volatility but it remains bounded by the stock price , hence when the volatility @xmath61 is large , we assume the value of the option tends to reach the value of the stock price @xmath60 .",
    "note , this is not the only way to prescribe boundary conditions for the problem , other types of boundary conditions can be found , e.g. , in  @xcite .",
    "the variance process ( [ eq : varprocess ] ) is strictly positive if the condition on the parameters @xmath64 is satisfied , which is often referred as the feller condition , see , e.g. ,  @xcite .",
    "this condition plays a crucial role in the calibration process of the heston model , and it is uncommon that the parameters violate it .",
    "thus we restrict ourselves to the choice of model parameters , such that the feller condition is fulfilled .",
    "since the operator @xmath65 in ( [ eq : heston ] ) is a degenerate parabolic differential operator , the standard way to eliminate the variable coefficient @xmath60 is to perform the log - transformation of @xmath60 by introducing a new variable @xmath66 .",
    "then we are looking for the solution @xmath67 , with the initial condition @xmath68 which satisfies the transformed heston equation @xmath69 for all @xmath70 .",
    "the operator @xmath71 corresponds to the operator @xmath65 in ( [ eq : heston ] ) with respect to a change of variables and is defined as follows @xmath72 with @xmath73 and first oder spatial differential operator @xmath74 . to perform a numerical simulation",
    ", we localize the problem ( [ eq : heston_tr ] ) to a bounded computational domain @xmath75 with the variance @xmath76 .",
    "then the boundary conditions transform into @xmath77 with @xmath78 being an outward normal vector at the boundary , @xmath31 and @xmath79 and a cumulative distribution function @xmath80 defined as @xmath81 using the test function @xmath82 yields the following weak formulation of ( [ eq : heston_tr ] ) @xmath83 where @xmath84 various methods can be applied to solve this problem numerically , e.g. ,  @xcite . in what follows we use a @xmath85-scheme for the discretization in time and conforming piecewise linear finite elements for the discretization in spatial direction .",
    "we divide @xmath86 $ ] into @xmath87 subintervals of equal length @xmath88 and define @xmath89 , @xmath90 , @xmath91 . then , for given @xmath92 we are looking for @xmath93 that satisfy for all @xmath82 @xmath94 in order to ensure dirichlet boundary conditions we set @xmath95 , where @xmath96 solves ( [ eq : heston_tr ] ) with homogeneous dirichlet boundary conditions and @xmath97 is a dirichlet lift function , which extends non - homogeneous boundary conditions to the interior of the domain .",
    "then ( [ eq : eodisc1 ] ) becomes @xmath98 where @xmath99      we extend our considerations to american options based on the black - scholes and heston model , for which , in general , a closed form solution does not exist .",
    "since american calls are equal to european calls on non - dividend paying stocks  @xcite , we will focus only on american put options in both models .",
    "the value @xmath100 of an american put paying @xmath101 at @xmath102 is a solution of the following problem @xmath103 where the differential operator @xmath104 is defined in ( [ eq : bs ] ) and ( [ eq : heston ] ) for the black - scholes and heston model , respectively .",
    "we specify the boundary conditions for the black - scholes model @xmath105 and for the heston model @xmath106 following the same arguments as in section [ sec : eo ] , we consider the price of the american put in the log - transformed variable @xmath107 with a log - transformed payoff @xmath108 which solves the following problem @xmath109 the operator @xmath110 , @xmath27 for the black - scholes or heston model , where @xmath111 the boundary conditions for the heston model are set to @xmath112 on @xmath113 and @xmath114 on @xmath115 . for the black - scholes model we define @xmath116 and on this boundary we prescribe @xmath112 .    our aim is to reformulate the system ( [ eg : ao1_trans])([eq : ao2_trans ] ) in a variational saddle point form  @xcite .",
    "define @xmath117 to be the dual space of @xmath42 and @xmath118 to be a dual cone . for",
    "all @xmath119 , @xmath44 introduce a duality pairing @xmath120 , @xmath121 and @xmath122 .",
    "the bilinear form of the black - scholes equation reads @xmath123 with the use of these notations we are ready to recast the problem ( [ eg : ao1_trans])([eq : ao2_trans ] ) in a saddle point form : find @xmath124 such that @xmath125 with @xmath126 in ( [ eq : bilbs ] ) or @xmath127 in ( [ eq : bilheston ] ) for the black - scholes or heston model , respectively . to treat the problem numerically",
    ", we use a @xmath85-scheme for the discretization in time and conforming piecewise linear finite elements for the discretization in spatial direction .",
    "we divide @xmath86 $ ] into @xmath87 subintervals of equal length @xmath88 and define @xmath89 , @xmath90 , @xmath91 . in order to ensure dirichlet boundary conditions , we set @xmath128 , where @xmath129 solves   with homogeneous dirichlet boundary conditions and @xmath130 is a dirichlet lift function , which extends non - homogeneous boundary conditions to the interior of the domain . for @xmath131",
    "we introduce the operators @xmath132 and the discrete problem in a saddle point form reads :    for @xmath133 and given initial data @xmath134 find @xmath135 for @xmath131 and @xmath136 satisfying @xmath137    the bilinear form @xmath138 , @xmath27 is specified for each model in   or  . here and in the following , we frequently omit the argument @xmath139 whenever the parameter value is clear from the context . the problem ( [ eq : aodisc1])([eq : aodisc2 ] ) can be considered as a model independent formulation for pricing american put options . moreover ,",
    "the european call option is also enclosed in this formulation by the exchange of @xmath140 with @xmath141 , initial conditions and omitting @xmath142 and @xmath143 terms .",
    "therefore , in the further discussions of the implementation aspects and analysis , we will focus only on the general american put option case , and we will not distinguish the models which are used to price the option .",
    "however in section [ sec : results ] , we present and compare numerical results for european and american options in both models .    by a generalized lax - milgram argument , a problem of type  ( [ eq : aodisc1])([eq : aodisc2 ] ) is well - posed if the bilinear form @xmath144 is continuous and coercive , @xmath145 , @xmath146 are linear and continuous and @xmath142 is inf - sup stable . in particular , for the heston model , if @xmath147 the matrix @xmath148 in ( [ eq : heston_coef ] ) is positive definite on @xmath149 and under the suitable relation on the coefficients , we obtain the coercivity and continuity of @xmath150 .",
    "this issue for the european call option was studied in great detail in  @xcite .",
    "the well - posedness of the problem in the black - scholes settings can be found , e.g. , in  ( * ? ? ?",
    "* ch . 6 ) .",
    "the coercivity , continuity , and inf - sup constants are defined as follows @xmath151 also , for our choice of a dual space and cone we assume @xmath152",
    "in this section , we provide the rb - scheme for the variational inequality problem and present the main analytical results .",
    "standard finite element approaches do not exploit the structure of the solution manifold under parameter variation and for a given parameter value , a high dimensional system has to be solved . in what follows",
    ", we introduce a specific galerkin approximation of the solution , based on the reduced basis method .",
    "the first step of the reduced basis method mainly consists in computing parametric solutions in low dimensional subspaces of @xmath42 and @xmath153 , defined in section  [ sec : var_form ] , that are generated with particular solutions , the so - called _ snapshots _ , of our problem .",
    "let us explain the corresponding formulation in more detail .",
    "for @xmath154 , consider a finite subset @xmath155 with @xmath156 .",
    "the reduced spaces @xmath157 and @xmath158 are defined by @xmath159 and @xmath160 where @xmath161 and @xmath162 are suitably constructed from the large set of snapshot solutions @xmath163 , @xmath164 , @xmath165 and @xmath166 , @xmath164 , @xmath167 and the reduced dimensions @xmath168 are preferably small . both families @xmath169 and @xmath170 are supposed to be composed of linearly independent functions , hence are so - called _",
    "reduced bases_. numerical algorithms to build these two sets will be presented in section  [ sec : rbcomp ] .",
    "we define the reduced cone as @xmath171 which satisfies @xmath172 due to the assumption of @xmath173 . in this",
    "setting , the reduced problem reads :    given @xmath174 , find @xmath175 and @xmath176 for @xmath177 that satisfy @xmath178 for all @xmath179 and the initial value @xmath180 is chosen as an orthogonal projection of @xmath181 on @xmath157 , i.e. , @xmath182 for all @xmath183 .      by the construction procedure for @xmath184 in section  [ sec : implementation ] , we will assure inf - sup stability of @xmath142 on @xmath185 and guarantee that @xmath186 , where @xmath187 which implies the well - posedness of our reduced problem  ( [ eq : virb1])([eq : virb2 ] ) with identical arguments as for the detailed saddle point problem .",
    "hence , we ensure existence and uniqueness of the reduced solution . for the details of the proof",
    ", we refer to  @xcite .",
    "a further useful property is a basic consistency argument , the reproduction of solutions :    if for some @xmath139 holds @xmath188 and @xmath189 for @xmath131 and @xmath190 then @xmath191    we prove this property by induction . for @xmath192 , @xmath193 and for @xmath194",
    "we have @xmath195 , for all @xmath183 .",
    "set @xmath196 , then @xmath197 which is true only for @xmath198 . for the induction step ,",
    "we assume that @xmath199 , @xmath200",
    ". then , choosing @xmath201 , @xmath202 , we directly obtain @xmath203 which implies that @xmath204 solves the reduced problem . due to the uniqueness of the solution , we obtain @xmath205 and @xmath206 .",
    "in this section , we present an a posteriori analysis of our rb - scheme .",
    "in particular , only the more challenging constraint case of american options is considered , as for the european option model , the well established standard rb - error analysis for linear parabolic problems @xcite can be applied , which we omit in this work .    again , to simplify the presentation , we omit the parameter vector @xmath139 in the notation of @xmath207 . in the same way , we only consider the case @xmath208 , that is , an implicit euler time discretization .",
    "however the analysis presented hereafter holds for any @xmath209 $ ] , up to technical supplementary computations .",
    "we start by introducing relevant residuals and preliminary results .      in order to evaluate the approximation errors induced by our method",
    ", we define , for @xmath210 , the equality and inequality residuals by : @xmath211 we also introduce the primal and dual errors @xmath212 using the linearity of @xmath213 , one finds that : @xmath214 as a consequence of inf - sup stability , one can bound the dual error by the primal error , as stated in the next lemma .",
    "[ lemma : pderror ] for @xmath210 , the dual error at time step @xmath215 can be bounded by the primal error as @xmath216    the inf - sup stability of @xmath142 guarantees the existence of a @xmath217 such that @xmath218 using  , we find that : @xmath219 and the result then follows from  .      let us then introduce , for @xmath210 , the riesz - representer @xmath220 of our inequality residual : @xmath221 contrary to @xmath222 , the quantity @xmath223 is not a straightforward error estimator component because of the inequality constraint .",
    "we obviously would correctly penalize if @xmath224 for some @xmath225 as desired , but we would also penalize @xmath226 which is not necessary . hence , we need to cope with the inherent nonlinearity induced by the inequalities . for this purpose , we consider a family of projectors on the cone @xmath227 which are assumed to satisfy , for @xmath210 , @xmath228    having and the characterization of the dual cone @xmath229 we find that @xmath230    projectors satisfying   improve the one proposed in  @xcite , namely one term in the error bound can be cancelled .",
    "we also refer to  @xcite where such techniques are applied for finite element based error estimators in contact mechanics and for obstacle problems .",
    "we are now in a position to define an a posteriori error estimator associated with our method .",
    "[ apostest ] define the a posteriori quantities @xmath231 one has : @xmath232    first , we note that we have for all @xmath233 : @xmath234 and we recall that for all @xmath235 : @xmath236 from  , we then have : @xmath237 let us focus on the term @xmath238 . thanks to ,  , , definition of @xmath239 and the fact that @xmath240 from  , this term can be simplified as follows : @xmath241 this estimate combined with   and the coercivity of @xmath242 , gives rise to : @xmath243 the first term of the inequality   can be expressed as @xmath244 using lemma  [ lemma : pderror ] and young s inequality , we then bound @xmath245 in  : @xmath246 combining this estimate with  , we can simplify   as follows : @xmath247 using young s inequality gives : @xmath248 we get the result by combining the latter with  , summing the resulting inequalities from @xmath192 up to @xmath249 and multiplying the result by @xmath250 .",
    "we point out that @xmath251 can be regarded as measure for the violation of the constraint .",
    "thus it plays a similar role as typical penalty terms in primal methods .",
    "in this section , we mainly discuss the implementational aspects of solving a reduced basis problem ( [ eq : virb1])([eq : virb2 ] ) associated with our detailed formulation  ( [ eq : aodisc1])([eq : aodisc2 ] ) .",
    "let us give a few remarks about the solvability of the detailed problem .",
    "the differential operator in  ( [ eq : aodisc1 ] ) is of convection - diffusion type with constant ( in the black - scholes model ) or variable ( in the heston model ) coefficients .",
    "thus for the specific range of the parameters , the convective term may dominate the diffusive one , and applying the standard galerkin method might lead to instabilities and inaccurate results . to overcome this difficulty and enhance the quality of the discrete solution , one can use a different discretization scheme , e.g. , a streamline upwind petrov - galerkin method  @xcite .",
    "however , for our numerical simulations , we restrict the parameter range such that the diffusive term is large enough compared to the convective one and a standard galerkin finite element method can be applied .    for the remainder of the paper , @xmath42 is now a standard conforming piecewise linear finite element space used for the discretization of the variational inequality . more precisely , consider a triangulation @xmath252 of @xmath57 , consisting of @xmath253 simplices @xmath254 , @xmath255 , such that @xmath256 .",
    "we then use a standard conforming nodal first order finite element space .",
    "we define the discrete space @xmath257 of dimension @xmath258 . for the sake of simplicity ,",
    "we omit the index @xmath259 and consider @xmath42 to be a discrete finite element space .",
    "we associate the basis functions @xmath260 with its lagrange node @xmath261 , i.e. , @xmath262 .",
    "for the discretization of the lagrange multipliers in @xmath118 , we use dual basis functions  @xcite , that is , we consider a dual finite element basis @xmath263 of @xmath117 , so that @xmath264 , @xmath265 . the cone @xmath229 is defined by : @xmath266    as these spaces are assumed to be sufficiently accurate a priori , that is , the finite element discretization error is neglegible compared to the reduction error , we do not discriminate notationally between the true and the finite element spaces .",
    "however a more extensive analysis has to take into account also the quality of the detailed solution .",
    "we shall now present a method to solve the problem  ( [ eq : virb1])([eq : virb2 ] ) .",
    "the approach we follow is mainly based on the primal - dual - active - set - strategy  @xcite , which is equivalent to semi - smooth newton method , thus a superlinear convergence of the algorithm can be achieved .",
    "we expand the solution @xmath267 of  ( [ eq : virb1])([eq : virb2 ] ) as @xmath268 and @xmath269 with the coefficient vectors @xmath270 , @xmath271 .",
    "we also introduce the following set of notations : for @xmath272 $ ] , denote by @xmath273 , @xmath274 and @xmath275 the matrices of coefficients @xmath276 , @xmath277 and @xmath278 with @xmath279 and @xmath280 , respectively .",
    "denote also by @xmath281 and @xmath282 the vectors of components @xmath283 and @xmath284 , respectively .",
    "one can then rewrite equations  ( [ eq : virb1])([eq : virb2 ] ) in the matricial form : @xmath285 where `` @xmath50 '' denotes the hadamard product , @xmath286 , @xmath287 are the coefficient vectors of @xmath288 and @xmath289 in @xmath157 , respectively , @xmath290 is the coefficient vector of @xmath291 in @xmath158 and the initial data is obtained by solving @xmath292 . to solve efficiently this system , we apply a semi - smooth newton method which can easily be carried out in terms of a primal - dual active set strategy .",
    "thus , a superlinear convergence of the algorithm can be achieved . for the sake of completeness",
    ", we recall here the main features of this method .",
    "let @xmath293 and @xmath294 be generic coefficient vectors of length @xmath295 and @xmath296 , respectively , then we introduce the function @xmath297 , where @xmath298 and @xmath299 applies componentwise . with the use of these notations",
    ", the problem  ( [ eq : virb1])([eq : virb2 ] ) can be rewritten in the algebraic form @xmath300 and the initial data is obtained by solving @xmath292 . to employ the the primal - dual - active - set - strategy",
    ", we introduce the active and inactive sets @xmath301 where we have denoted by @xmath302 the @xmath303-th component of a vector .",
    "the equivalence between equations  ( [ eq : virb3])([eq : virb6 ] ) and equations  ( [ eq : virb7])([eq : virb8 ] ) follows from the fact that if @xmath304 , @xmath305 so that @xmath306 and otherwise , if @xmath307 , @xmath308 so that @xmath309 . a newton iteration can then be applied , which gives rise to the next algorithm .    given a tolerance @xmath310 and initial conditions @xmath311 , the trajectory @xmath312 , @xmath313 is computed recursively as follows .",
    "suppose that at time step @xmath314 , @xmath315 is known .    1 .",
    "set @xmath316 and @xmath317 .",
    "2 .   while @xmath318 , do 1 .",
    "define @xmath319 as the solution of : @xmath320 2 .",
    "set @xmath321 .",
    "3 .   define @xmath322 .",
    "note that @xmath323 and @xmath324 do not appear in the iteration ( except in the definitions of the sets @xmath325 and @xmath326 ) as the functions involved in  ( [ eq : virb7])([eq : virb8 ] ) are either linear or piecewise linear .",
    "using the previous time - step solution as a start iterate the active set is already a very good guess and thus we can expect a good convergence of the newton iteration .      for the a posteriori error estimators",
    ", we require suitable projectors on the cone . in the case of our finite element basis",
    ", we simply choose them by their discrete vectorial representation in the dual finite element space as @xmath327_+\\right),\\ ] ] where for @xmath328 , @xmath329 is defined by @xmath330 if @xmath331 , and @xmath332 else .",
    "given a coefficient vector @xmath333 , we denote by @xmath334_+$ ] its positive part , that is @xmath335_+\\right)_p=0 $ ] , if @xmath336 and @xmath335_+\\right)_p=\\left(x\\right)_p$ ] else . with this definition , the property ( [ prop : pi ] )",
    "is trivially fulfilled .      in this section ,",
    "we present a method to build the reduced primal basis @xmath337 and dual basis @xmath338 .",
    "the approach we follow consists in building iteratively and simultaneously the reduced primal and dual basis in a greedy fashion , as presented in algorithm 2 .",
    "we consider a finite training set @xmath339 small enough such that it can be scanned quickly , but sufficiently large to represent the parameter space well .",
    "after a ( quite arbitrary ) choice of the initial reduced spaces , we proceed in a greedy loop : for a given primal and dual space at stage @xmath340 , we identify the parameter vector @xmath341 in the training set that currently leads to the worst reduced basis approximation . for this",
    "parameter , new primal and dual basis vectors are generated , and this loop is repeated @xmath342 times . to be more precise , the selection of new primal vectors is based on the idea of the pod - greedy procedure , which meanwhile is standard for rb - methods for time - dependent parametric problems @xcite and has provable convergence rates @xcite .",
    "the main step consists in computing the complete simulation of the worst - resolved trajectory , extracting the new information by an orthogonal projection on the current primal space and a compression by a proper orthogonal decomposition ( pod ) to a single vector , the so called dominant pod - mode . in the algorithm",
    "@xmath343 denotes the orthogonal projection on @xmath344 with respect to @xmath345 and the dominant pod - mode is given as @xmath346 the new dual basis vectors are selected using an angle - greedy argument , which aims at maximizing the volume of the resulting cone @xcite .",
    "this means , we include the snapshot showing the largest deviation from the current reduced dual space , that is , the vector @xmath347 that maximizes @xmath348 where @xmath349 denotes the angle between a vector @xmath119 and a linear space @xmath350 .",
    "we point out that our system  has a saddle point structure .",
    "thus ignoring the dual basis in the construction of the primal basis may lead to a reduced system for which the stability can not be guaranteed . to guarantee the inf - sup stability of our approach ,",
    "we follow the `` inclusion of supremizers '' idea introduced in  @xcite for the stokes problem .",
    "this enrichment consists in including @xmath351 into the primal space , where @xmath352 is the solution of @xmath353 , for @xmath44 .",
    "then @xmath354 is the element that supremizes the expression @xmath355 , hence it is called a `` supremizer '' .",
    "this extension ensures that the reduced inf - sup condition ( [ eqn : reduced - inf - sup ] ) is satisfied , which can be proven following the lines of @xcite , and hence the reduced problem is well - posed .",
    "we conclude by defining the final reduced space @xmath356 of dimension @xmath357 .",
    "the selection of the `` worst '' parameter in the greedy loop requires a measure @xmath358 , which is an error estimator that can be chosen as one of these three quantities : @xmath359 hence @xmath360 is the squared true @xmath361-error , @xmath362 is the true error measured in a space - time energy , and @xmath363 is the a posteriori error bound from the previous section , cf .  theorem  [ apostest ] . with these notations ,",
    "the resulting pod - angle - greedy algorithm is fully specified .",
    "[ alg : global - greedy ] given @xmath364 , @xmath339    1",
    ".   choose arbitrarily @xmath365 and @xmath366 2 .",
    "set @xmath367 , @xmath368 , @xmath369 , 3 .",
    "set @xmath370 , @xmath371 , 4 .   for @xmath372 ,",
    "define @xmath373 , 2 .",
    "find @xmath374 3 .",
    "set @xmath375 , + @xmath376 , @xmath377 , 4 .",
    "define @xmath378 , + set @xmath379 , @xmath380 , 5 .",
    "define @xmath381 , @xmath382 , @xmath383 , 6 .",
    "define @xmath384 , @xmath385 , @xmath386 .",
    "let us give some additional comments on this procedure .",
    "first note , that the extension steps in the algorithm are only performed if the sets remain linearly independent .",
    "another way of stating this is to say that if a supremizer is already contained in the current space , it will not be inserted again in order to maintain the linear independence of the reduced bases .",
    "this results in @xmath387 and @xmath388 .    note also that the orthonormalization steps can either be done by a simple gram - schmidt orthonormalization , or a singular value decomposition ( svd ) .",
    "in particular the former is very attractive , as @xmath389 and @xmath390 are already orthonormal , hence in step 4.(d ) it is sufficient to orthonormalize the single vector @xmath351 .",
    "further , we emphasize that the supremizer enrichment in practice also may be skipped : this results in smaller and hence faster reduced models , by accepting the loss of a theoretical stability guarantee , see , e.g. ,  @xcite . using the error estimator @xmath391 or @xmath392 corresponds to work with quantities associated with the true error and is consequently more expensive , as the full trajectories for all parameters in the training set must be precomputed .",
    "this is in contrast to the case of working with @xmath393 , which only involves the reduced solver used in the online phase , and only detailed trajectories for the selected parameters must be computed .",
    "hence , when using @xmath393 , the training set @xmath394 can be potentially chosen much larger and hence much more representative for the complete parameter domain .",
    "we finally give a short comment on the european option case : in that case , we use the @xmath392 measure for selecting the worst parameter . due to the absence of the lagrange multiplier ,",
    "we do not obtain a saddle point structure of the problem .",
    "hence , we omit the supremizer enrichments and the angle - greedy step , and the algorithm then reduces to the classical ( strong ) pod - greedy algorithm .",
    "we use the @xmath85-scheme presented in section  [ sec : var_form ] for the time - discretization with @xmath395 for european and @xmath208 for american options . the time domain @xmath396=[0,1]$ ] is discretized with a uniform mesh of step size @xmath397 , @xmath398 .",
    "the space domain is set to @xmath399 and @xmath400 for the black - scholes and heston model , respectively .",
    "the black - scholes model is treated in the original @xmath60 variable , while the heston model is considered with respect to the log - transformation @xmath401 . as a consequence ,",
    "we use the @xmath46 norm for the heston model and the weighted @xmath46 norm @xmath402 for the black - scholes model .    for the black - scholes model we set @xmath403 nodes and the heston model @xmath404 nodes .",
    "to build the basis , we consider a subset @xmath394 of @xmath405 , which is specified for the black - scholes model as in and for the heston model as in for european options and as in   for american options .",
    "@xmath406\\times[0.0014,0.0016]\\times[0.4750,0.5250 ] \\label{eq : par_dombs}&\\subset\\mathbb{r}^3,\\\\ \\mathcal{p}&\\equiv[0.1,0.4]\\times[0.21,0.9]\\times[0.08,0.15]\\times[1.2 , 3]\\times[0.01,0.2]&\\subset\\mathbb{r}^5,\\label{eq : par_domh}\\\\ \\mathcal{p}&\\equiv[0.6,0.9]\\times[0.21,0.9]\\times[0.16,0.25]\\times[3 , 5]\\times[0.01,0.2]&\\subset\\mathbb{r}^5\\label{eq : par_domha}.\\end{aligned}\\ ] ] for the black - scholes setting we use @xmath407 composed of @xmath408 values chosen equidistantly distributed in @xmath409 , while for the heston model the set @xmath407 is varying and specified in every particular case .",
    "we define our model parameters @xmath133 as @xmath410 and @xmath411 for the black - scholes and heston models , respectively .",
    "the strike @xmath412 is not considered as a model parameter , since it scales the value of the option .",
    "we set @xmath413 and @xmath414 for the black - scholes and heston model , respectively . in order to design the reduced primal and dual bases",
    ", we use the pod - angle - greedy algorithm with different error measures @xmath358 .",
    "we first consider the numerical results and a performance of the reduced basis method for the simpler linear case of the european call option with the heston model .",
    "to illustrate the motivation to apply the reduced basis approach , we demonstrate the variability of the solution in parameter and time . in figure",
    "[ fig : snapshots_heston ] ( top left ) the detailed solution for a fixed parameter value at the final time @xmath415 is presented .",
    "the evolution of the solution for different time @xmath416 is shown in figure  [ fig : snapshots_heston ] ( top right ) and the variation with respect to parameters in figure  [ fig : snapshots_heston ] ( bottom ) .     at @xmath417 ( left ) and a time evolution of the option at @xmath418 ( right ) .",
    "bottom : snapshots of the solution for different parameter values extracted at a fixed volatility @xmath418.,title=\"fig : \" ]   at @xmath417 ( left ) and a time evolution of the option at @xmath418 ( right ) .",
    "bottom : snapshots of the solution for different parameter values extracted at a fixed volatility @xmath418.,title=\"fig : \" ] +   at @xmath417 ( left ) and a time evolution of the option at @xmath418 ( right ) .",
    "bottom : snapshots of the solution for different parameter values extracted at a fixed volatility @xmath418.,title=\"fig : \" ]   at @xmath417 ( left ) and a time evolution of the option at @xmath418 ( right ) .",
    "bottom : snapshots of the solution for different parameter values extracted at a fixed volatility @xmath418.,title=\"fig : \" ]    after computing the set of snapshots which consists of the detailed solutions for different @xmath419 , we employ the pod - angle - greedy algorithm with @xmath392 as a selection criterion to construct the reduced basis space @xmath157 .",
    "as mentioned earlier , this procedure corresponds to the standard strong pod - greedy algorithm .",
    "we test the reduced basis approach for different dimension of the parameter domain @xmath420 , @xmath421 , namely we consider @xmath422 , @xmath423 and @xmath424 . for each choice of @xmath139 ,",
    "the remaining parameter values are assumed to be fixed and taking the value from the default parameter vector @xmath425 . in our first test , we consider @xmath426 and @xmath427 equidistantly distributed points .",
    "the first six orthonormal reduced basis vectors produced by the algorithm are presented in figure  [ fig : rb_2d_basis ] .      to quantify the efficiency of the reduced basis method",
    ", we investigate the error decay when increasing the dimension @xmath295 .",
    "for each reduced model , we compute the maximal error @xmath430 over a random test set @xmath431 . in figure",
    "[ fig : rb_2d_error ] , we observe that the error plotted versus the dimension of the reduced model decays exponentially .     for the european option with the heston model and @xmath429 .",
    "the test grid is random @xmath431 .",
    "right : plot of the selected parameters @xmath432 and their frequency of the selection in the construction of the reduced basis in algorithm  [ alg : global - greedy ] .",
    "the train set composed of @xmath427 equidistantly distributed points.,title=\"fig : \" ]   for the european option with the heston model and @xmath429 .",
    "the test grid is random @xmath431 .",
    "right : plot of the selected parameters @xmath432 and their frequency of the selection in the construction of the reduced basis in algorithm  [ alg : global - greedy ] .",
    "the train set composed of @xmath427 equidistantly distributed points.,title=\"fig : \" ]    the analogous results for other choices of @xmath433 and @xmath434 are presented in figure  [ fig : rb_3d_error ] and figure  [ fig : rb_5d_error ] . for both cases the exponentially decaying behavior of the error is shown , however it can be observed that the convergence is slower for larger dimension of the parameter , which is explained by the increasingly complex parameter dependence of the model . in figure",
    "[ fig : rb_5d_error ] , we also present the evolution of the train error @xmath435 used for the reduced basis construction in the step @xmath436 of algorithm  [ alg : global - greedy ] .     for the european call option with the heston model with @xmath437 .",
    "the test grid is random @xmath438 .",
    "right : plot of the selected parameters @xmath432 and their frequency of the selection in the construction of the reduced basis in algorithm  [ alg : global - greedy ] .",
    "the train set composed of @xmath439 equidistantly distributed points.,title=\"fig : \" ]   for the european call option with the heston model with @xmath437 .",
    "the test grid is random @xmath438 .",
    "right : plot of the selected parameters @xmath432 and their frequency of the selection in the construction of the reduced basis in algorithm  [ alg : global - greedy ] .",
    "the train set composed of @xmath439 equidistantly distributed points.,title=\"fig : \" ]    ( blue stars ) and a test error @xmath430(green crosses ) for the european call option with the heston model with @xmath434 . the test grid is random @xmath440 .",
    "the train set composed of @xmath441 equidistantly distributed points . ]      in this section , we present the numerical results corresponding to the performance of the reduced basis approach for pricing american options with the black - scholes and heston model and the corresponding a posteriori error estimates .      for the american option case with the heston model , we consider the settings of the parameter domain defined in  . for the experiments presented in this section , we consider @xmath442 and , if not stated , the remaining parameter values are set to the corresponding entries of @xmath443 .        in figure",
    "[ fig : ao_snapshots ] , we show the snapshots of the primal solutions and their lagrange multipliers at different parameter values , which motivates us to apply the reduced basis method to this model .",
    "to study the efficiency of the reduced basis approach , we consider the pod - angle - greedy algorithm with the true error indicator @xmath444 .",
    "we build the hierarchical reduced basis with @xmath445 and @xmath446 using the training set @xmath447 uniformly distributed points",
    ". the evolution of the error produced by the algorithm is depicted in figure  [ fig : ao_basis2 ] .",
    "each reduced basis model is tested on the random test set @xmath448 and the corresponding error @xmath449 is also depicted in figure  [ fig : ao_basis2 ] .",
    "now , we restrict ourselves to the black - scholes model .",
    "we first demonstrate the parameter and time dependence of our model . in figure",
    "[ fig : bs_snapshots ] , the examples of the primal and dual solutions at different parameter values @xmath451 and time steps are presented .     at a final time",
    "step @xmath415 .",
    "the evolution of the solution for different times ( right ) .",
    ", title=\"fig : \" ]   at a final time step @xmath415 .",
    "the evolution of the solution for different times ( right ) .",
    ", title=\"fig : \" ]   at a final time step @xmath415 .",
    "the evolution of the solution for different times ( right ) .",
    ", title=\"fig : \" ]    as the next set of experiments , we consider the performance of the reduced basis approach using algorithm  [ alg : global - greedy ] with the true energy error @xmath452 .",
    "we construct the bases using the proposed algorithm with @xmath453 , @xmath454 and test the reduced basis approach first for a random value of the parameter @xmath455 .",
    "some steps of the simulation are represented in figure  [ fig : simu ] .",
    "the reduced basis and fine detailed simulation curves are hardly distinguishable , that reveals a good reduced basis approximation .    ) at time steps @xmath456 , @xmath457 and @xmath458 for the american put option with the black - scholes model , with @xmath459 .",
    "the payoff function is represented as the black line.,title=\"fig : \" ] ) at time steps @xmath456 , @xmath457 and @xmath458 for the american put option with the black - scholes model , with @xmath459 .",
    "the payoff function is represented as the black line.,title=\"fig : \" ] ) at time steps @xmath456 , @xmath457 and @xmath458 for the american put option with the black - scholes model , with @xmath459 .",
    "the payoff function is represented as the black line.,title=\"fig : \" ]    we then test our algorithm on a larger set of parameters .",
    "we consider @xmath460 , a random set of @xmath461 parameters and estimate the mean value of the error @xmath391 over @xmath462 .",
    "more precisely , we evaluate @xmath463 . the results are plotted in the diagram presented in figure  [ fig : errorcurve ] .",
    "we observe an error decay of several orders in magnitude when simultaneously increasing @xmath295 and @xmath296 .",
    "we now focus on the efficiency of the design procedure and an inclusion of an a posteriori error estimate using as an example the american put option with the black - scholes and heston model . for this",
    ", we consider the pod - angle - greedy algorithm and use alternatively @xmath452 and @xmath464 as selection criterion with @xmath465 , i.e. , @xmath453 , @xmath454 for both models .",
    "the other parameter settings remain the same as introduced in section  [ sec : bs_results ] and section  [ sec : h_results ] .",
    "the visualization of the reduced basis vectors of @xmath466 , @xmath467 for the black - scholes model with @xmath464 is represented in figure  [ fig : basis_bs ] .",
    "we now comment on an employment of the a posteriori error bounds developed in section  [ sec : error_analysis ] .",
    "we consider the values of the quantity @xmath468 along the iterations of algorithm  [ alg : global - greedy ] , choosing either @xmath452 or @xmath464 .",
    "the corresponding results for the black - scholes model are presented in figure  [ fig : convgreedy ] and for the heston model in figure  [ fig : convgreedyh ] .",
    "we observe that for both models using @xmath452 as an error measure in algorithm  [ alg : global - greedy ] results in less monotone error convergence of @xmath393 with respect to @xmath469 and vice versa .",
    "overall we obtain similar accuracy when using the ( cheap ) @xmath393 measure in contrast to the expensive true error @xmath391 , which illustrates the relevance of our a posteriori analysis .     for the american put option with the black - scholes model during the iterations of algorithm  [ alg : global - greedy ] with error estimator @xmath452 ( left ) and with @xmath464 ( right ) .",
    "blue stars : values of @xmath391 , green crosses : values of @xmath393.,title=\"fig : \" ]   for the american put option with the black - scholes model during the iterations of algorithm  [ alg : global - greedy ] with error estimator @xmath452 ( left ) and with @xmath464 ( right ) .",
    "blue stars : values of @xmath391 , green crosses : values of @xmath393.,title=\"fig : \" ]     for the american put option with the heston model during the iterations of algorithm  [ alg : global - greedy ] with error estimator @xmath452 ( left ) and with @xmath464 ( right ) .",
    "blue stars : values of @xmath391 , green crosses : values of @xmath393.,title=\"fig : \" ]   for the american put option with the heston model during the iterations of algorithm  [ alg : global - greedy ] with error estimator @xmath452 ( left ) and with @xmath464 ( right ) . blue stars : values of @xmath391 , green crosses :",
    "values of @xmath393.,title=\"fig : \" ]    as a measure of the quality of the proposed error estimate , we define the associated effectivities @xmath470 table  [ table : bs ] and table  [ table : heston ] provide the maximum effectivities @xmath471 associated with the error bounds for the black - scholes and heston model using different error measures in the pod - angle - greedy algorithm . note , that the choice of @xmath358 in the algorithm does not have a significant impact on the values of the maximum effectivities .",
    "we also observe that for the heston model the effectivity values are higher than for the black - scholes one , which can be justified by a more complex nature of the model .",
    "overall the effectivities of two orders of magnitude are very well acceptable for instationary rb problems .",
    ".maximum effectivities for the american put with the black - scholes model at different time steps @xmath472 and for different error measures @xmath358 and @xmath465 in algorithm  [ alg : global - greedy ] .",
    "[ cols=\"^,^,^,^,^,^\",options=\"header \" , ]                                                              , _ contact problems in elasticity : a study of variational inequalities and finite element methods _ , vol .  8 of siam studies in applied mathematics , society for industrial and applied mathematics ( siam ) , philadelphia , pa , 1988 .    , _ an introduction to variational inequalities and their applications _ , vol .  31 of classics in applied mathematics , society for industrial and applied mathematics ( siam ) , philadelphia , pa , 2000 .",
    "reprint of the 1980 original .",
    ", _ online - efficient rb methods for contact and other problems in nonlinear solid mechanics_. slides of the presentation on workshop : numerical methods for high - dimensional problems , ecole des ponts paristech , 2014 .    ,",
    "_ a posteriori error bounds for reduced - basis approximation of parametrized noncoercive and nonlinear elliptic partial differential equations _ , in in proceedings of 16th aiaa computational fluid dynamics conference , 2003 .",
    "paper 2003 - 3847 ."
  ],
  "abstract_text": [
    "<S> in this paper , we present a reduced basis method for pricing european and american options based on the black - scholes and heston model . to tackle each model numerically , </S>",
    "<S> we formulate the problem in terms of a time dependent variational equality or inequality . </S>",
    "<S> we apply a suitable reduced basis approach for both types of options . </S>",
    "<S> the characteristic ingredients used in the method are a combined pod - greedy and angle - greedy procedure for the construction of the primal and dual reduced spaces . analytically , we prove the reproduction property of the reduced scheme and derive a posteriori error estimators . </S>",
    "<S> numerical examples are provided , illustrating the approximation quality and convergence of our approach for the different option pricing models . </S>",
    "<S> also , we investigate the reliability and effectivity of the error estimators . </S>"
  ]
}