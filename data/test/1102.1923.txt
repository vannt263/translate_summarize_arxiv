{
  "article_text": [
    "early nonlinear calculations of stellar pulsation , as outlined by @xcite , used a 1d lagrangian framework and had considerable success producing full amplitude rr lyrae models that resembled the basic observations .",
    "however , these calculations used purely radiative envelopes and failed to identify a red edge to the rr lyrae instability strip .",
    "this lead to the hypothesis that convection in the ionization zones quenched pulsation @xcite . to explore this , @xcite used a 1d , linear , non - adiabatic code with a time - independent mixing length theory for the convective flux .",
    "they found that time - independent convection only reduced the growth rate of pulsation but did not produce pulsational stability .",
    "several formalisms and 1d codes were developed that included time - dependent convection by introducing an additional differential equation to calculate the evolution of the convective flux with time based on the standard mixing length theory @xcite .",
    "@xcite developed a time - dependent treatment of convection for 1d lagrangian models which follows the time evolution of averaged convective velocities and includes a treatment of overshooting and eddy viscosity to account for small length scale kinetic energy dissipation .",
    "there are several numerical difficulties associated with modeling radial pulsation .",
    "first there are very steep gradients in the ionization zones and adequately resolving these gradients is important for accurate modeling . @xcite and @xcite have both included adaptive grids too better resolve the steep gradients in the ionization zones as they sweep through the envelope during pulsation . using a version of stellingwerf s time - dependent convective model with his adaptive scheme , @xcite was able to produce a red edge at roughly the observed effective temperature .",
    "he notes that the effective temperature of the red edge is dependent on the parameters used for the convective model , and that the predicted temperature of the red edge could vary by a few hundred degrees kelvin depending on the values used for the convective model parameters . also , there are differences between gehmeyr s light amplitude - rise time relationship and the observed relationship in both slope and zero point .",
    "@xcite used their adaptive code to calculate light and radial velocity curves which exhibit shapes typical of rr lyrae stars .",
    "a second potential difficulty is an accurate representation of the surface boundary , which @xcite tested by including a model atmosphere and found that its inclusion did not impact the pulsational characteristics of the model .",
    "@xcite used the 1d , lagrangian , hydrodynamics code described by @xcite and @xcite to compute rr lyrae models to compare with the rr lyrae stars observed in m3 . in order to fully specify the problem @xcite needed to choose a mixing - length parameter , and adopted both @xmath0 and @xmath1 , where @xmath2 is the mixing - length and @xmath3 is the pressure scale height .",
    "they found that in order to match the boundaries of rr lyrae gap in m3 , they required two different mixing - length parameters , one to obtain the observed blue edge location ( @xmath4 ) and the other to obtain the observed red edge location ( @xmath5 ) .",
    "in addition the observed visual amplitude as a function of b - v displays nonlinear characteristics , while theoretical relations predict linear relationships .",
    "@xcite also mention that a mixing - length parameter of 2.0 produces luminosities for horizontal - branch models that are brighter than what is observed by @xmath6 mag .",
    "other models for time - dependent convection in one dimension have been proposed by @xcite and @xcite .",
    "@xcite argued that the convective model by @xcite does not use the diffusion approximation consistently throughout the model .",
    "@xcite developed their application of the @xcite convective model , which requires eight free parameters , and used it to study convection in @xmath7 cephei stars @xcite .",
    "they found that convection is not important for calculating pulsation amplitudes for their models .",
    "however , they caution that their convective model , while working well for classical pulsators , is at the limits of its applicability in the @xmath7-cephei models they are studying . more recently , @xcite have also developed a code including the @xcite convective model and present some test calculations of their program , mentioning that the turbulent viscosity parameter shows potential as an important determinant of the pulsation amplitudes .",
    "the distillation of multi - dimensional convective phenomenon to one dimension is always accompanied by extra equations and/or parameters to approximate the effects of convective motions of material in more than one spatial dimension .",
    "@xcite approached the interaction of convection and stellar pulsation in a fundamentally different way using a two - dimensional hydrodynamic code directly following the convective flow patterns .",
    "while @xcite was able to successfully determine the observed edges of the rr lyrae instability strip , he was unable to compute full amplitude solutions because his algorithm for moving the radial coordinate allowed the radial zoning to drift over time .",
    "consequently at later times , the radial zoning did not cover the hydrogen ionization zone adequately and the calculations were eventually numerically unreliable . the algorithm @xcite used for the moving radial coordinate used the horizontal average of the radial velocities at a particular radius as the grid velocity .",
    "recently @xcite have used a similar average radial velocity as the grid velocity to follow the core in fall phase in supernovae simulations .",
    "another form of a radial moving grid was by @xcite , where the radial grid velocity at the surface was set as the average of the radial velocities , and the inner grid velocity was held constant .",
    "the intermediate radial grid velocities were then set using a dilatation factor .",
    "recently @xcite developed an approach for model pulsation somewhere between the 2d model of @xcite and the 1d convective models .",
    "@xcite used two radial columns to model convection .",
    "one column represented the sum of all upward convective flows , and the other column represented the sum of all downward flows . while not including any mixing length parameter , it does contain free parameters related to the physical size of the convective cells , and the fraction of the surface area of a spherical surface which contains downdrafts .",
    "these parameters do have a physical basis , but in practice it would be difficult to determine them as they are probably functions of depth and likely depend on a particular star s properties . also , because the model only has two radial columns it may miss some of the more subtle features of convection .",
    "more recently others have begun working on directly simulating the interaction of convection and pulsation in 2d @xcite .",
    "both @xcite and @xcite have stressed the importance of improving the convective models used in variable stars .",
    "@xcite highlights some of the well known difficulties facing time - dependent mixing length noting that it is an empirical description , rather than a consistent physical description .",
    "also , the up to eight or more free parameters used in time - dependent mixing length approach can not be chosen based on physics , but instead must be calibrated by comparison with observations .",
    "@xcite mentions some remaining problems for rr lyrae models , particularly the unsatisfactory match between theoretical light curve morphology and observed light curve morphology near the red edge of the rr lyrae instability strip , supporting the suggestion that an improved treatment of turbulent convection is needed .",
    "3d convective simulations have had significant success in other areas of stellar astrophysics .",
    "for example @xcite note many of the recent successes in 3d modeling of solar surface convection , in particular that 3d models with numerical resolutions around @xmath8 reproduce widths , shifts , and shapes of observed photospheric spectral lines with high accuracy . 3d convective simulations by @xcite simulated core convection in a massive star finding differences in 2d and 3d convective velocities in both morphology and magnitude .",
    "3d models remove the need for many free parameters and the lack of a physically consistent description of convection , with convection resulting naturally from the conservation laws ; however , an algorithm to include the effects of sub - grid scale turbulence on the larger eddies is still required .",
    "here we build on the ideas of @xcite , with the goal of developing a fully 3d calculation in which the radial coordinate moves in such a manner to allow us to perform full amplitude solutions of rr lyrae models with large eddy simulations ( les ) of convective energy transport . as a first step we apply our approach to purely adiabatic models to verify that the method can compute accurate and stable large amplitude periodic solutions over many periods .",
    "calculation of full amplitude solutions requires following the pulsation for many periods .",
    "1d codes have been able to calculate full amplitude solutions , while @xcite s 2d code had difficulty after many periods because of his particular moving radial coordinate .",
    "this led us to try using the internal mass , @xmath9 , as the radial independent variable instead of radius , @xmath10 , and allow @xmath10 to change such that the mass within a shell remains constant .",
    "this requires introducing a grid velocity , @xmath11 , in the radial direction that dictates how the coordinate system radius changes .",
    "the intent is that our radial grid acts like that of a 1d lagrangian code while allowing the usual eulerian approach in the horizontal directions .",
    "note that this approach still allows fluid flow across radial zone boundaries .",
    "it just moves the radial gridding so that it maintains the mass in a spherical shell .",
    "it does not put any constraints on the horizontal flow and does not alter the physics of the conservation equations in any way .",
    "the calculations are performed in a limited range of the spherical polar coordinates @xmath12 and @xmath13 , a 3d version of a `` pie slice '' .",
    "periodic boundary conditions are placed in the horizontal directions .",
    "the interior boundary is placed at a location deeper than 0.15 of the stellar radius and is regarded as rigid .",
    "this is a common assumption in most 1d simulations . because the horizontal zoning would get very narrow ( leading , through the courant condition , to undesirably short time steps ) and because the 3d flow of interest is expected to be only in the surface ionization regions , we impose a purely radial region for an arbitrary number of radial zones above the interior boundary . in conjunction with the assumption",
    "that non - radial motion occurs only near the very low mass surface , we assume the gravitational force has its spherically symmetric form .",
    "we first define a horizontally averaged density which allows us to replace an infinitesimal radial change , @xmath14 , with an infinitesimal internal mass change , @xmath15 .",
    "the mass of a spherical shell of thickness @xmath16 is given by @xmath17 where @xmath18 is the volume averaged density within a spherical shell , @xmath19 here @xmath20 , @xmath21 , and @xmath22 are the @xmath23 , @xmath24 and @xmath25 zone indices defined at zone centers and increase with each of their respective spherical coordinates ( e.g. , @xmath20 increases from the center of the star towards the surface ) .",
    "@xmath26 is the volume of a spherical shell at a particular radial shell , @xmath20 , that spans all the @xmath21 and @xmath22 at that @xmath20 .",
    "@xmath27 is the volume of the ( @xmath20,@xmath21,@xmath22 ) grid cell .",
    "in order to develop and test this approach , we have assumed that the system is adiabatic . introducing both @xmath15 and the grid velocity , @xmath11 , into the 3d conservation equations for mass , three components of momentum , and energy produces : @xmath28 @xmath29 @xmath30 @xmath31 @xmath32 the above symbols have their usual meaning ( @xmath33 is the specific internal energy ) .",
    "finally the system is closed with three further equations : @xmath34 which is used to update the radius , @xmath35 a simple gamma - law gas for the equation of state , and an equation for solving for the grid velocity ( see equation [ eq : rad - grid - vel ] ) .",
    "before we present the equation for the grid velocity , we present an equivalent equation to equation ( [ eq : mass - cons - fd ] ) by which we solve mass conservation .      [",
    "sec : fv - mass - cons ] the definition of volume we will use in the equation for determining the grid velocity ( eq . [ [ eq : rad - grid - vel ] ] ) and the average density ( eq . [ [ eq : rho - ave ] ] ) must be consistent with the mass conservation equation . the definition of volume we use in equations ( [ eq : rad - grid - vel ] ) and ( [ eq : rho - ave ] ) is @xmath36 to make the mass equation consistent with this definition of the volume , one integrates equation ( [ eq : mass - cons - fd ] ) over the volume , then uses gauss s theorem to convert the volume integral into a surface integral , producing the finite volume form of the mass conservation equation .",
    "the mass in a cell changes only from mass flowing into and out of that cell .",
    "this change from one time step ( @xmath37 ) to the next ( @xmath38 ) can be written as @xmath39,\\end{aligned}\\ ] ] where @xmath40 is the area of a cell face ( see figure [ fig : cell ] ) and the @xmath41s are fluxes defined as @xmath42 to obtain the densities at the interfaces ( @xmath43 ) straight averages are computed of centered densities adjacent to the interface .",
    "the two centered subscripts have intentionally been omitted in the expressions for the fluxes and areas to reduce equation length ( e.g. @xmath20 was left off but @xmath44 was kept ) .",
    "note that the densities in the fluxes are at time @xmath37 and not @xmath45 , so our solution algorithm is straightforwardly explicit , as is true for many 1d calculations .",
    "it is not possible to properly time center all terms without introducing a more complex implicit or multi - step explicit algorithm . with this expression for the fluxes",
    ", we can directly solve equation ( [ eq : mass - cons - fv ] ) for the density at the new time step .      the final piece needed to complete the description is the calculation of the grid velocity .",
    "for a spherical shell to have constant mass , the net flow of mass into and out of that spherical shell must be zero .",
    "summing up all the fluxes into and out of the individual horizontal cells in a spherical shell , substituting equation ( [ eq : outer - flux ] ) in for the outer radial flux ( at @xmath44 ) and setting the result equal to zero we arrive at the equation , @xmath46.\\end{aligned}\\ ] ] solving for the outer grid velocity , @xmath47 , produces an equation for calculating the new grid velocity , @xmath48.\\end{aligned}\\ ] ]    the inner radial flux , @xmath49 , is dependent on the grid velocity at the inner interface . at the first radial zone boundary next to the rigid core",
    "we impose both a zero radial velocity and grid velocity .",
    "thus , equation ( [ eq : rad - grid - vel ] ) can be solved recursively from the model interior boundary to the surface to determine the grid velocity at all interfaces .",
    "the initial model for our adiabatic simulations is generated by requiring that it be in hydrostatic equilibrium .",
    "when this constraint is applied to the conservation equations the only terms that remain are the pressure and gravity terms in the radial momentum conservation equation . in particular , there are no terms left in the internal energy conservation equation , and thus no equation to solve for the energy structure . to provide this information ,",
    "an energy profile was generated from another stellar modeling code rotorc @xcite and energies were interpolated in @xmath50 to cell centers .",
    "once we impose the energy distribution , we can simultaneously solve the radial hydrostatic equilibrium finite difference equation and the equation of state for the pressure and density structure of the model given the spacing of the independent variable @xmath9 .",
    "the radius is determined from the volume required to produce the calculated density from the mass of the shell .",
    "no convective model is included in the starting model because rr lyrae do not have extensive convective regions to affect the structure . to induce pulsation a radial velocity profile from the linear , non - adiabatic , radial pulsation code , lna , @xcite , modified to allow a gamma law gas ,",
    "is imposed so that the model pulsates around the equilibrium point in either the fundamental or the first overtone modes .",
    "the simulation volume is separated into cells bounded by intersecting surfaces .",
    "these surfaces are defined at constant values of the three independent variables @xmath9 , @xmath12 , and @xmath13 .",
    "dependent quantities @xmath51 , @xmath33 , and @xmath52 are defined at cell centers and dependent quantities @xmath10 , @xmath53 , @xmath11 , @xmath54 , and @xmath55 are defined at appropriate cell interfaces .",
    "the models used for testing have 107 radial , 10 theta , and 10 phi zones .",
    "the inner 10 radial zones are handled in 1d as discussed in ",
    "[ sec : herls ] .",
    "the zone number at which the switch between 1d and 3d is made is chosen by the user .",
    "for the test cases used in this paper the total mass of the star was 0.575 m@xmath56 , with an initial mass spacing of @xmath57 m@xmath56 at the surface , and increasing by 10% each shell into the star .",
    "both the @xmath12 and @xmath13 zones have a spacing of 1@xmath58 , so that the total simulation volume covers 100 square degrees .",
    "the equations outlined in  [ sec : cons - eqs ] are in differential form and are approximated by appropriate finite difference expressions .",
    "spatial differentials are approximated by differences between quantities at either cell centers or cell interfaces depending on whether the quantity being updated in time is interface centered or cell centered , respectively .",
    "temporal differentials are approximated by differences between the current grid state and the updated grid state divided by the time step , @xmath59 , computed as a fraction of the minimum time step allowed by the courant condition for the model as a whole .",
    "this then allows us to explicitly solve for the updated grid state given the current grid state and the time step .",
    "equation ( [ eq : mass - cons - fv ] ) is written in finite volume form with fluxes defined at cell faces .",
    "the velocities required for these fluxes are already interface centered ; however , the densities are not . in general , quantities that are needed at interfaces but defined at cell centers , and quantities that are needed at cell centers but defined at interfaces",
    "are approximated by averages of adjacent quantities .",
    "we have used artificial viscosity given by @xcite to smooth out shocks with a threshold velocity of one - hundredth of the local sound speed for turning on the artificial viscosity and have used weighted donor cell to stabilize advection terms , with a weight of 0.1 on the upwind terms and 0.9 for centered terms .",
    "the order of calculation follows that of @xcite with a few minor modifications .",
    "we start by updating the three velocities using equations ( [ eq : rad - mom - cons ] , [ eq : theta - mom - cons ] , and [ eq : phi - mom - cons ] ) from time @xmath60 to @xmath45 using quantities at @xmath37 ( @xmath51 , @xmath18 , @xmath10 , and @xmath52 ) and quantities at @xmath60 ( @xmath53 , @xmath61,@xmath54 , and @xmath55 ) . next the grid velocity",
    "is calculated at time @xmath45 using equation ( [ eq : rad - grid - vel ] ) working from inner boundary of the model to the surface in a recursive manner .",
    "the updated radius is computed with equation ( [ eq : r - update ] ) .",
    "the density is updated from @xmath37 to @xmath38 using the equation for mass conservation ( eq . [ [ eq : mass - cons - fv ] ] ) , with quantities at @xmath37 ( @xmath51 and @xmath10 ) , and quantities at @xmath45 ( @xmath53 , @xmath61 , @xmath54 , and @xmath55 ) .",
    "the energy is updated in a similar manner .",
    "the equation of state then allows us to compute the pressure at the new time step from the updated density and specific internal energy .",
    "the code we have developed to perform these calculations has been named spherls ( stellar pulsation with a horizontal eulerian radial lagrangian scheme ) .",
    "spherls has been designed from the beginning to allow for parallel calculations using mpi protocols .",
    "the parallel design allows for domain decomposition in all three directions with the ability to vary the number of ghost cells ( used to express the boundary conditions of the local domain ) copied from other processors .",
    "note that boundary conditions in this sense are not the global boundary conditions of the calculation but only the information required from other processors to be able to perform the calculations on the processor in question",
    ". equations ( [ eq : rad - mom - cons ] ) , ( [ eq : theta - mom - cons ] ) , ( [ eq : phi - mom - cons ] ) , ( [ eq : e - cons ] ) , ( [ eq : mass - cons - fv ] ) depend on only local quantities and are easily applied to the local grids on each processor . the equation to calculate the grid velocity ( eq .",
    "[ [ eq : rad - grid - vel ] ] ) requires information across all @xmath21 and @xmath22 space .",
    "using this equation with domain decomposition in the @xmath21 and @xmath22 directions would require additional message passing which has not yet been implemented , and thus currently limits domain decomposition to the radial direction only .",
    "this could change in the future and may become helpful for optimizing calculations for larger horizontal grids .    during program initialization",
    ", each processor can be assigned different equations to solve on their local grid , which allows one to divide the computational domain up into a 3d and a 1d region .",
    "the 1d region is composed of only a single zone at each @xmath20 spanning all of @xmath21 and @xmath22 space .",
    "quantities are volume averaged from the 3d region to the 1d region to be used as boundary conditions for the 1d region ; while values in the 1d region are copied across @xmath21 and @xmath22 space to the 3d region to be used as boundary conditions there .    to date , only exploratory time trials have been performed because future additions to the code ( including both an implicit solution to the energy equation with radiation diffusion and an eddy viscosity sub - grid - scale model ) will impact the timing results significantly . at present",
    ", a calculation with 97 @xmath62 10 @xmath62 10 3d zones and 10 1d zones for 1 million time steps ( 10 million seconds , or approximately 178 fundamental mode periods ) takes 2 processors 12@xmath6322@xmath64 ; 4 processors 5@xmath6325@xmath64 ; 8 processors @xmath65 ; and 16 processors @xmath66 . at larger numbers of processors with the current gridding ,",
    "the overhead from mpi begins to negate any additional benefits .",
    "thus , for this gridding 16 processors represents the `` sweet spot '' . at",
    "larger horizontal grid sizes the `` sweet spot '' will likely be pushed to larger numbers of processors .",
    "five adiabatic test calculations have been performed using the method outlined above . the first calculation ( cali )",
    "was of a static stellar model with all velocities set to zero , which was used to test that the starting model was indeed generated in equilibrium consistently with respect to the hydrodynamic finite difference equations , and that spherls s finite difference and finite volume representations of the hydrodynamic equations are hydodynamically stable .",
    "the second calculation ( calii ) was a spherical blast wave ( e.g. * ? ? ? * ) , used to test that the code could handle strong shocks and check it against an analytical solution .",
    "the third calculation ( caliii ) was of a low amplitude radial pulsation ( 1 km s@xmath67 initial surface velocity ) in the fundamental mode with a horizontal velocity perturbation to break spherical symmetry .",
    "the forth calculation ( caliv ) was of an even lower amplitude radial pulsation ( 0.1 km s@xmath67 initial surface velocity ) in the first overtone mode again with a horizontal velocity perturbation .",
    "these two low amplitude calculations were used to compare the calculated periods to the linear adiabatic periods , and to insure that the scheme worked as expected at low velocities .",
    "the lower velocity is needed for comparison with the linear lna code which assumes small perturbations from the static model to calculate periods . the fifth calculation ( calv ) started with the same stellar model as caliii , but with a higher amplitude pulsation ( 10 km s@xmath67 initial surface velocity ) and a toroidal velocity perturbation instead of the horizontal velocity perturbation .",
    "this calculation was used to show that spherls reproduced quantities well from one period to the next over many periods in the presence of weak shocks and large scale structured motions .",
    "the static calculation ( cali ) started with all velocities ( @xmath10 , @xmath12 , and @xmath13 ) set to zero and was computed for over 20 million seconds ( 356 fundamental periods ) .",
    "the radial velocities in the surface zone reached the largest amplitudes . in this zone",
    "the radial velocity amplitude initially grew from zero to a temporal mean of about @xmath68 cm s@xmath67 within the first 80 periods .",
    "this mean was maintained for the rest of the calculation with a standard deviation of @xmath69 cm s@xmath67 .",
    "the horizontal velocities remain zero throughout the calculation .",
    "this is understandable because all terms in the horizontal momentum equations are zero and remain that way ; while the radial momentum equation is the balance between two nonzero terms and thus subject to round off error .    to assure that the method is behaving as designed we checked the mass calculated from the averaged density , @xmath18 , and the shell volume ( which is dependent on the radial grid velocity ) with the mass set as the independent variable .",
    "the largest relative difference between the calculated mass and the independent mass variable for all calculations is @xmath70 .",
    "this is only two significant digits above machine round off , and there are no signs of a trend with time .    to test how well spherls handles strong shocks and to compare the computed results with an analytic calculation we performed a sedov blast wave calculation ( calii ) .",
    "this calculation had 400 radial zones with an initial spacing of 10 cm and 10 @xmath12 and @xmath13 zones with spacings of 1@xmath71 .",
    "the 400 radial zones produces a 40 m radius spherical volume for the shock to expand into , and was chosen to allow enough volume for the shock to expand into over 10 ms , at which time the analytic solution has reached a shock radius of 32.7 m. the inner 10 radial zones were ( as in the adiabatic stellar models ) treated in 1d .",
    "the blast was accomplished by setting the initial energy in the inner 30 zones ( i.e. , a 3 m radius sphere ) to @xmath72 ergs with all other zones having an energy of @xmath73 ergs .",
    "the density was set to 2 g @xmath74 through out the starting model .",
    "a gamma - law gas was used for the equation of state , with a @xmath75 of 1.6 .",
    "all the initial velocities were set to zero and the blast was followed for 10 ms .",
    "the calculation was compared to an analytical solution with a point - source energy producing the blast , evaluated at times from 0.5 ms to 10 ms in 0.5 ms intervals .",
    "when comparing the extended - source to the point - source solution one would expect that at early times ( when the shock is closer to the source ) , and at later times closer to the initial location of the source , the discrepancies between the computed and analytical solutions should be larger .",
    "this is because the differences between a non - point source calculation and the point source analytic solution will diminish as the disturbance moves outward .",
    "the blast radii computed by spherls matched those form the analytic solution to within 7.5 cm at all times .",
    "the best match of shock radii ( within 1.7 cm ) occurred later in the calculation at a time of 10 ms , while the worst match ( 7.3 cm ) occurred much earlier in the calculation at 3.5 ms .",
    "the computed velocity , density , and pressure profiles were also compared to the analytic solution , but because of the extended source , only the zones outside the initial explosion source were compared .",
    "the root mean square of the fractional error in velocity , density , and pressure was less than 3% , 8% , and 5% respectively in the last half of the calculation ( 5 ms to 10 ms ) . in the first half of the calculation ( 0.5 ms to 5 ms )",
    "the root mean square of the fractional errors are a bit larger , mostly due to the difference between using an extended source in the calculation versus a point source in the analytic solution and are within 8% , 15% , and 11% for the velocity , density , and pressure respectively .",
    "the radial profiles of the velocity , density , and pressure fit quite well without any outlying points .    because the calculations are adiabatic",
    ", we expect the pulsation to neither grow nor decay and to be reproducible from one period to the next .",
    "this should provide a good test to verify that our numerical algorithm functions as desired over many periods .",
    "both the low amplitude fundamental and first overtone pulsation ( caliii and caliv respectively ) had a horizontal velocity perturbation imposed on them to break spherical symmetry , by setting specific values of @xmath54 and @xmath55 at a central horizontal zone located at 90% of the total radius ( 18 zones in from the surface of the 107 radial zone models ) .",
    "the velocities were directed horizontally out of the zone through sides @xmath76 and @xmath77 ( see figure [ fig : cell ] ) .",
    "the magnitude of these horizontal velocities was taken to be half of the initial radial velocity at this radial location ( 0.3 km s@xmath67 and 0.03 km s@xmath67 for caliii and caliv respectively ) .",
    "figure [ fig : r - theta - slice - horizontal ] shows a two - dimensional slice at constant @xmath13 of caliii slightly after the initial conditions . the slice is at 7225 s into the calculation ( relatively early in the @xmath78 s calculation ) and shows the disturbance resulting from the horizontal velocity perturbation as well as it s location and geometry with respect to the rest of the model .",
    "the period of the fundamental mode is 56178 s for the low amplitude calculation ( caliii ) , and compares well with the period calculated from lna of 56114 s. there is less than @xmath79% difference between the periods of the two codes .",
    "the first overtone model ( caliv ) was found to have a period of 38911 s and compares with the lna period of 39522 s , producing less than a 1.6% difference .",
    "in addition to the horizontal velocity perturbation we explored in caliii and caliv we also explored a velocity perturbation that is more structured over a larger scale ( calv ) . to create this model we started with the same structural model and radial velocity profile as cal iii , this time however , using a surface amplitude of 10 km s@xmath67 . on top of the radial velocity profile we added a velocity perturbation in the shape of a torus ( see figure [ fig : torus - geo ] for torus geometry ) .",
    "the velocity perturbations were taken to be constant on the surface of the torus ( the two circles in the lower half of figure [ fig : torus - geo ] ) and parallel to the surface of the torus . by locating the closest point ( defined by angles @xmath80 and @xmath7 ) on the surface of the torus to the point @xmath52 ,",
    "the distance @xmath81 in figure [ fig : torus - geo ] can be calculated",
    ". then a gaussian centered on the surface of the torus with a maximum amplitude of 5 km s@xmath67 is evaluated at @xmath81 providing the velocity magnitude .",
    "the fwhm of the gaussian is chosen so that the velocity perturbations do not overlap the other parts of the torus , and so that the velocity perturbations are still reasonably strong a zone or two away from the surface of the torus .",
    "the direction of the velocity is taken to be parallel to the surface of the torus at the locaiton closest to @xmath52 .",
    "the velocity magnitude is then broken into @xmath10 , @xmath12 , and @xmath13 components .",
    "the result of applying this perturbation is shown in figures [ fig : r - theta - slice - torus ] and [ fig : r - phi - slice - torus ] .",
    "these figures show slices through the center of the model at constant @xmath12 and @xmath13 respectively , 9031 s into the calculation and indicate that @xmath12 and @xmath13 directions behave identically .",
    "the high surface velocity model ( calv ) results are presented in figures [ fig : reproducibility - u0 ] and [ fig : reproducibility - da ] .",
    "figure [ fig : reproducibility - u0 ] shows that the radial grid velocity throughout the model is well reproduced at periods 50 , 110 , and 170 .",
    "figure [ fig : reproducibility - da ] shows that @xmath18 is well reproduced over a large number of periods and does not show the drifting apparent in @xcite .",
    "the fact that the calculations of dependent quantities are reproduced over many periods shows that the scheme is working as desired and we expect to calculate full amplitude solutions of pulsating variable stars in the future .",
    "a low radial surface velocity model(1 km s@xmath67 surface velocity ) that was spherically symmetric and did not use artificial viscosity has a very constant peak kinetic energies per period , with out any long term detectable growth or decay rates larger than @xmath82% per fundamental period . while caliii , that had a horizontal velocity perturbation , had a growth rate of @xmath83% per fundamental period . in the high radial surface velocity calculation ( calv ) artificial viscosity is required in the momentum equations ( eq .",
    "[ eq : rad - mom - cons ] , [ eq : theta - mom - cons ] , and [ eq : phi - mom - cons ] ) to reduce the very steep pressure gradients at shocks .",
    "if it is omitted when pulsation amplitudes exceed the local sound speed it ultimately leads to negative densities and energies .",
    "one might argue that including the artificial viscosity in the energy equation would produce a non - adiabatic calculation , since the inclusion of the artificial viscosity raises the internal energy more than otherwise when the volume is decreasing .",
    "in calv if the artificial viscosity is included in the energy equation we find that the peak kinetic energy decays at a rate 0.36% per fundamental period .",
    "if it is nt included the peak kinetic energy decays at a rate of 0.13% .",
    "these decay rates are dependent on the inclusion or omission of artificial viscosity in the energy equation , and may affect the amplitude of full amplitude solutions to some degree .",
    "this is not merely a concern for the present code , but for all non - linear hydrodynamics codes that use artificial viscosity .",
    "we have developed a numerical algorithm and the computer code , spherls , which is able to follow 3d adiabatic radial pulsations for many periods when spherical symmetry is broken .",
    "this is a necessary step for following the convective motions and radial pulsations of stars .",
    "we have shown that spherls maintains hydrostatic equilibrium to a high degree over 356 fundamental periods .",
    "the radial lagrangian algorithm for maintaining constant mass in the radial shells is effective over 178 periods to within one or two digits of machine round off , with no signs of any particular trend either decreasing or increasing .",
    "we have found that spherls reproduces both the fundamental and first overtone modes of the linear adiabatic code lna reasonably well ( @xmath840.12% for fundamental and @xmath84 1.6% for first over tone ) .",
    "the velocities as well as other dependent quantities ( e.g. the horizontally averaged density ) are reproducible over many periods when spherical symmetry is broken , again indicating that our radial lagrangian scheme is performing as designed .",
    "adiabaticity is maintained extremely well at low radial velocities when artificial viscosity is not included .",
    "however at higher radial velocities some kinetic energy is converted into internal energy via the artificial viscosity required to smooth out shocks .",
    "this should be kept in mind while using any non - linear hydrodynamics code employing artificial viscosity to compare full amplitude solutions with observations .    in order to calculate full amplitude pulsating models to compare with observations",
    "a few additions must be made to spherls .",
    "a more realistic equation of state and radiative rosseland mean opacities must be included and radiation diffusion must be added to the energy equation .",
    "the latter is expected to require an implicit integration of the energy equation , at least near the surface , because optically thin zones would require a very small time step based on the speed of light and not the speed of sound .",
    "we expect to use the current explicit solution to the energy equation deeper in the envelope where the mean free path of photons is much less than a computational zone , keeping the calculation time down .",
    "finally , we will add the subgrid scale terms required in a large eddy simulation for treating turbulent convection in the ionization zone .",
    "these calculations were performed with acenet computational resources .",
    "acenet , a part of compute canada , provides academic high performance computing to atlantic canada .",
    "cmg is supported in part by an nserc discovery grant to rgd and in part by an acenet fellowship .",
    ", r.  d. , & morton , k.  w. 1967 , interscience tracts in pure and applied mathematics , vol .  4 , difference methods for initial value problems , 2nd edn . , ed .",
    "l.  bers , r.  courant , & j.  stoker , j ( new york : wiley interscience )"
  ],
  "abstract_text": [
    "<S> we are developing a 3d radiation hydrodynamics code to simulate the interaction of convection and pulsation in classical variable stars . </S>",
    "<S> one key goal is the ability to carry these simulations to full amplitude in order to compare them with observed light and velocity curves . </S>",
    "<S> previous 2d calculations were prevented from doing this because of drift in the radial coordinate system , due to the algorithm defining radial movement of the coordinate system during the pulsation cycle . </S>",
    "<S> we remove this difficulty by defining our coordinate system flow algorithm to require that the mass in a spherical shell remain constant throughout the pulsation cycle . </S>",
    "<S> we perform adiabatic test calculations to show that large amplitude solutions repeat over more than 150 pulsation periods . </S>",
    "<S> we also verify that the computational method conserves the peak kinetic energy per period , as must be true for adiabatic pulsation models . </S>"
  ]
}