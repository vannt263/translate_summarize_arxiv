{
  "article_text": [
    "the dynamics of evolution depend an organism s  fitness landscape \" , the mapping from genotypes to reproductive capacity .",
    "knowledge of the fitness landscape can help resolve questions such as how quickly a pathogen will acquire drug resistance , or by what pattern of mutations . but direct measurement of a fitness landscape is impossible because of the vast number of genotypes .",
    "here we critically examine regression techniques used to approximate fitness landscapes from data .",
    "we find that such regressions are subject to two inherent biases that distort the biological quantities of greatest interest , often making evolution appear less predictable than it actually is .",
    "we discuss methods that may mitigate these biases in some cases .",
    "an organism s fitness , or expected reproductive output , is determined by its genotype , environment , and possibly the frequencies of other genotypes in the population . in the simplified setting of a fixed environment , and disregarding frequency - dependent effects , which is typical in many experimental populations @xcite ,",
    "fitnesses are described by a map from genotypes to reproductive rates , called the _ fitness landscape_. the dynamics of an adapting population fundamentally depend on characteristics of the organism s fitness landscape @xcite . however , mapping out an organism s fitness landscape is virtually impossible in practice because of the coarse resolution of fitness measurements , and because of _ epistasis _ : the fitness contribution of one locus may depend on the states of other loci . to account for all possible forms of epistasis ,",
    "a fitness landscape must assign a potentially different fitness to each genotype , and the number of genotypes increases exponentially with the number of loci .    as a result of these practical difficulties ,",
    "fitness landscapes have been directly measured in only very limited cases , such as for individual proteins , rna molecules , or viruses . even in these limited cases",
    "genetic variation was restricted to a handful of genetic sites @xcite .",
    "alternatively , one might try to infer properties of a fitness landscape from a time - series of samples from a reproducing population . despite considerable effort along these lines",
    "@xcite , this approach is difficult and such inferences from times - series can be subject to systematic biases @xcite . as a result ,",
    "very little is known about fitness landscapes in nature , despite their overwhelming importance in shaping the course of evolution .",
    "technological developments now allow researchers to assay growth rates of microbes or enzymatic activities of individual proteins and rnas for millions of variants @xcite . as a result",
    ", researchers are now beginning to sample and measure larger portions of the fitness landscapes than previously possible .",
    "nonetheless , even in these cases , the set of sampled genotypes still represents a tiny proportion of all genotypes , and likely also a tiny proportion of all viable genotypes .    in order to draw conclusions from the limited number of genotypes",
    "whose fitnesses can be assayed , researchers fit statistical models , notably by penalized regression , that approximate the fitness landscape based on the data available .",
    "this situation is perhaps best illustrated by recent studies of fitness for the hiv-1 virus , based on the measured reproductive capacity of hiv - derived amplicons inserted into a resistance test vector @xcite .",
    "these hiv genotypes were sampled from infected patients .",
    "( an alternative approach , often used for measuring activities of an individual enzyme , is to introduce mutations randomly into a wild - type sequence @xcite ) . whereas the entire fitness landscape of hiv-1 consists of reproductive values for roughly @xmath0 genotypes ,",
    "only @xmath1 genotypes were assayed in the experiment @xcite .",
    "researchers therefore approximated the fitness landscape by penalized regression , based on the measured data , using an expansion in terms of main effects of loci and epistatic interactions between loci .",
    "the principal goal of estimating the underlying fitness landscape was to assess the extent and form of epistasis @xcite , and , more generally , to understand how adaptation would proceed on such a landscape @xcite .",
    "these @xcite and other high - throughput fitness measurement studies @xcite produce massive amounts of data , but not nearly enough to determine an entire fitness landscape .",
    "this presents the field with several pressing questions : do statistical approximations based on available data faithfully reproduce the relevant aspects of the true fitness landscape and accurately predict the dynamics of adaptation ? or , do biases arising from statistical fits or measurement noise influence the conclusions we draw from such data ?    here , we begin to address these fundamental questions about empirical fitness measurements and how they inform our understanding of the underlying fitness landscape and evolution on the landscape .",
    "we study the effects of approximating a fitness landscape from data in terms of main and epistatic effects of loci .",
    "we demonstrate that such approximations , which are required to draw any general conclusions from a limited sample of genotypes , are subject to two distinct sources of biases .",
    "although these biases are known features of linear regressions , they have important consequences for the biological quantities inferred from such fitness landscapes . these biases",
    "systematically alter the form of epistasis in the inferred fitness landscape compared to the true underlying landscape .",
    "in particular , the inferred fitness landscape will typically exhibit less local ruggedness than the true landscape , and it will suggest that evolutionary trajectories are less predictable than they actually are in the true landscape .",
    "most of our analysis is based on samples from mathematically constructed fitness landscapes .",
    "but we argue that the types of biases we identify apply generally , and in more biologically realistic situations . indeed",
    ", we show that the same types of biases occur in rna - folding landscapes as well as empirically measured regulatory sequence binding landscapes .",
    "although it may be impossible to completely remove these biases , we conclude by suggesting steps to mitigate the biases in some cases .",
    "a function that maps genotype to fitness may be written as an expansion in terms of main effects and interactions between loci @xcite : @xmath2 where @xmath3 represents a genetic variant at locus @xmath4 , @xmath5 is the fitness ( typically the logarithm of growth rate ) , and @xmath6 is the number of loci .",
    "the nucleotides atgc , or any number of categorical variables , may be encoded by dummy variables , represented by @xmath3 , which equal either @xmath7 or @xmath8 in this study ( see methods ) .",
    "the term @xmath9 represents a sum over all pairs of interactions between loci , and the elipses represent higher - order terms , such as three - way interactions .",
    "since the statistical model is linear in the coefficients @xmath10 and @xmath11 , etc , the best - fit coefficients can be inferred by linear regression .",
    "experimental data are now sufficiently extensive that both the additive and pairwise epistatic coefficients , @xmath10 and @xmath11 , can often be estimated , whereas three - way and higher - order interactions are typically omitted from the statistical model of the fitness landscape .",
    "we refer to a statistical model with only additive and pairwise interactions as a quadratic model . even in the quadratic case",
    ", the statistical model may involve more free coefficients than empirical observations , so that over - fitting could become a problem .",
    "techniques to accommodate this problem , and the biases they introduce , are discussed below .",
    "the first type of bias we study arises from the use of penalized regressions  which are required when a large number of parameters must be inferred from a limited amount of data . under standard linear regression with limited data , overfitting can cause the magnitudes of inferred coefficients to be large , resulting in positive and negative effects that cancel out to fit the observed fitness measurements .",
    "the standard remedy for overfitting is a so - called ",
    "penalized least - squares regression \" , such as ridge or lasso regression @xcite , which constrains the complexity of the inferred model by limiting the magnitudes of the inferred coefficients .",
    "for example , in fitting a quadratic landscape to sampled hiv-1 fitness measurements , hinkley et al . employed a form of penalized linear regression in order to avoid overfitting their data @xcite .",
    "although often required when fitting complex fitness landscapes to data , the penalized least square regression has some drawbacks . in general , the mean square error of any regression can be decomposed into a bias and a variance .",
    "the gauss - markov theorem guarantees that the standard least - squares linear regression produces the lowest possible mean squared error ( mse ) that has no bias , whereas penalized least squares can reduce the mse further by adding bias in exchange for a reduction in variance @xcite .",
    "thus , in order to provide predictive power for the fitnesses of un - observed genotypes , these regressions necessarily produce biased fits .",
    "while the accuracy of predicting unobserved fitnesses may be improved by such a biased fit , other quantities of biological interest derived from these predictions , such as measures of epistasis , may be distorted by the bias .    in order to quantify the biases introduced by penalized least square regression , we compared mathematically constructed fitness landscapes to the landscapes inferred from a quadratic model fit by ridge regression ( similar results hold for lasso regressions , see discussion ) .",
    "our analyses are based on two types of mathematical fitness landscapes .",
    "the widely used @xmath12-landscapes of kauffman et al @xcite comprise a family of landscapes that range from additive to highly epistatic , depending upon the parameter @xmath13 , which determines the number of ( typically sparse ) interactions between sites .",
    "we also study  polynomial \" landscapes , which consist of additive effects and all possible pairwise and three - way interactions . in these landscapes ,",
    "the amount of epistasis can be tuned by controlling the proportion of fitness variation that arises from the additive contributions , pairwise interactions , and three - way interactions ( see methods ) .",
    "we constructed @xmath12 and polynomial landscapes with only additive and pairwise effects , we sampled genotypes and fitness from these landscapes , and we fit a quadratic model of the landscape based on the sampled  data \" using penalized least square regression . for both @xmath12 and polynomial landscapes , we found that the inferred landscape tends to overestimate the fitnesses of low - fitness genotypes and underestimate the fitnesses of high - fitness genotypes ( polynomial landscape fig .",
    "[ fig : regbias ] , @xmath12 landscape fig .",
    "[ fig : regbias_nk ] ) .",
    "thus , there is a fitness - dependent bias in the inferred landscape compared to the true underlying landscape .",
    "the extent of this bias depends on the amount of penalization used , which in turn depends on the amount of data sampled relative the number of free coefficients in the statistical model .",
    "when the number of independent samples equals the number of free coefficients these biases disappear ( fig .",
    "[ fig : regbias ] , red curve ) , but whenever data are in short supply these biases arise and they can be substantial in magnitude ( fig .  [",
    "fig : regbias ] ) .",
    "the only way to avoid this bias entirely is to obtain at least as many independent observations as model parameters , which is typically unfeasible for realistic protein lengths or genome sizes .",
    "furthermore , as we will discuss below , these inherent biases have important consequences for our understanding of epistasis in the fitness landscape and for our ability to predict the dynamics of adaptation .",
    ", towards the average value , so that the high fitnesses are underestimated and low fitnesses are overestimated .",
    "the plot shows the mean ( solid line ) and standard deviation ( shaded area ) , of the distribution of residuals at a given true fitness value @xmath5 , smoothed by a gaussian moving window ( see methods ) .",
    "the fewer the observations ( i.e.  the smaller the number of genotypes sampled for fitting the statistical model ) , the stronger the effect of this bias , as seen by comparing fits to training datasets of different sizes : 250 sampled genotypes ( red ) , 200 sampled genotypes ( green ) , and 150 sampled genotypes ( blue ) . genotypes were sampled randomly from a quadratic polynomial fitness landscape , which lacks any three - way interactions ( parameters @xmath14 , @xmath15 , @xmath16 , @xmath17 , and @xmath18 sites ; see methods ) .",
    "the training data were fit to a quadratic model , which has @xmath19 parameters , so that the statistical model is well - specified . a test set of 5,000 random genotypes was used to compare the predicted ( @xmath20 ) and true ( @xmath5 ) fitnesses of genotypes . with sufficient sampled data ,",
    "no penalization is required and the resulting statistical fit contains no bias ( red ) . [",
    "fig : regbias ] ]      even when there is sufficient data so that a penalized regression is unnecessary , there is another source of potential bias in the inferred fitness landscape due to variables that are omitted from the statistical model but present in the true landscape , e.g.  higher - order interactions between loci @xcite . in this case , the estimated coefficients of the statistical model will be biased in proportion to the amount of correlation between the omitted variables and the included variables @xcite .",
    "uncorrelated omitted variables , by contrast , may be regarded as noise , as we discuss below .",
    "interactions of different orders , e.g.  three - way and pairwise interactions , are generally correlated with each other , unless the genotypes are sampled randomly and encoded as @xmath21 forming an orthogonal basis @xcite . in this case , which rarely applies to samples drawn from an evolving population , the omitted interactions may be regarded as noise and the estimated coefficients are guaranteed to be unbiased .",
    "however , even in this case the inferred @xmath5 values may still be biased .    fig .",
    "[ fig : modelbias ] illustrates the biases arising from model mis - specification . to produce this figure we fit quadratic models to fitness landscapes that contain higher - order interactions . in both the cubic polynomial ( fig .  [ fig : modelbias ] ) and @xmath12 ( fig .",
    "[ fig : modelbias_nk ] ) landscapes , fitnesses that are very high or very low are likely to contain contributions from higher - order interactions with positive or negative effects , respectively . but",
    "these higher - order interactions are not estimated by the statistical model , and so the inferred model overestimates low fitnesses and underestimates high fitnesses .",
    "bias arising from model mis - specification is qualitatively similar to bias arising form penalized regression , discussed above .",
    "bias from a mis - specified model can be large , but it would be not be visible in a plot of residuals versus _ inferred _ fitnesses .    the mis - specified model bias shown in figure [ fig : modelbias ] is a form of _ regression towards the mean _ , and it is present even in a simple univariate regression with a large amount of noise @xcite .",
    "the slope in figure [ fig : modelbias ] , which plots true fitness @xmath5 against the residual @xmath22 , arises because the quadratic statistical model can not estimate the higher - order ( cubic ) interactions , which effectively act as noise in the regression .",
    "in fact , the slope in the figure equals @xmath23 , where @xmath24 denotes the coefficient of determination of the original regression ( see material and methods for a derivation ) .",
    "whether regression towards the mean is viewed as bias depends on the interpretation of the statistical model .",
    "if one assumes that the model can not be improved by adding any more predictor variables , i.e.  that the noise is caused by purely random factors , as opposed to unknown systematic factors , then the regression results are unbiased and the observed negative slope between @xmath22 and @xmath5 simply reflects the fact that the regression can not estimate the noise . however , in situations when there is a systematic signal that is missing from the statistical model , such as when fitting a quadratic model to a fitness landscape that contains higher - order interactions , then the regression is biased towards the mean in proportion to the amount of variance that is not explained by the model .",
    "this phenomenon is not caused by measurement noise but by the omission of relevant variables . in the experiments summarized in fig .",
    "[ fig : modelbias ] there is no measurement noise in the fitnesses , and so the negative slope shown in figure [ fig : modelbias ] reflects a true bias : the mis - specified model over - estimates low fitnesses and under - estimates high fitnesses .    with carefully tuned parameters , other forms of mis - specified model bias",
    "are also possible , see fig .",
    "[ fig : modelbias2 ] . in any case , whatever form it takes",
    ", mis - specified model bias has consequences for how accurately the landscape inferred from an experiment will reflect the amount of epistasis in the true landscape or predict the dynamics of adaptation , as we will demonstrate below .",
    "parameters ) to 5,000 randomly sampled individuals from three different cubic - polynomial landscapes each with with @xmath18 sites and @xmath17 : @xmath25 , @xmath15 , @xmath16 ( red ) , @xmath26 , @xmath27 , @xmath28 ( green ) , and @xmath25 , @xmath29 , @xmath30 ( blue ) . the larger the value of @xmath31 , the greater the amount of model mis - specification and the stronger the bias .",
    "a test set of 5,000 random genotypes was used to compare the predicted ( @xmath20 ) and true ( @xmath5 ) fitnesses of individuals .",
    "[ fig : modelbias ] ]      a third difficulty that arises when fitting a statistical model to measured fitnesses is the presence of correlations between observed states of loci in sampled genotypes .",
    "an adapting population does not explore sequence space randomly , but rather is guided by selection towards higher - fitness genotypes .",
    "sequences sampled from a population under selection will thus tend to have correlated loci , due either to shared ancestry or due to epistasis .",
    "correlated variables do not themselves bias inferred coefficients ( at least , when the model is specified correctly ) , but they can inflate the variance of those estimates @xcite .",
    "predictions from the inferred model are not affected , in expectation , provided the new data have the same correlations as in the original training data . however , in the context of the expansion in eq .",
    "[ eq : quad ] , if there are correlations between the included variables , then there are also correlations between the omitted higher - order interactions and the included variables .",
    "thus , sampling from a wright - fisher ( wf ) population will exacerbate the mis - specified model bias . as a result ,",
    "the inferred @xmath10 s and @xmath11 s will be further biased and so too will the inferred fitnesses .    to illustrate biases that arise from sampling a population under selection",
    ", we simulated wright - fisher populations for 100 generations on cubic polynomial and @xmath12 landscapes .",
    "we used large population sizes and mutation rates to produce a large amount of standing genetic diversity for sampling genotypes ( see methods ) .",
    "the resulting fits exhibit very high @xmath24 values , in many cases even larger than fits to randomly sampled genotypes .",
    "but the large @xmath24 values and apparent lack of bias in the training data are very misleading when the model is misspecified , i.e.   when the true landscape contains higher - order interactions . when predicting fitnesses of genotypes just one or two mutations away from the training data we find again large biases and large variance ( polynomial landscape fig .",
    "[ fig : wfsample2 ] and @xmath12 landscape fig .",
    "[ fig : wfsample_nk ] ) .",
    "as before , the resulting bias tends towards intermediate fitness values .    )",
    "were computed from cross - validated training data ( red ) , for genotypes sampled one mutation away from the training data ( purple ) , and for genotypes sampled two mutations away from the training data ( cyan ) .",
    "the true fitnesses ( @xmath5 ) are determined by a cubic polynomial fitness landscape on @xmath18 sites with @xmath26 , @xmath27 , @xmath28 , and @xmath32 .",
    "genotypes for fitting the quadratic statistical model were sampled from the population after 100 generations of wright - fisher evolution , with mutation rate @xmath33 and population size @xmath34 ( see methods ) .",
    "[ fig : wfsample2 ] ]      one of the motivations for fitting a statistical model of a fitness landscape is to predict the fitnesses of genotypes that were not sampled or assayed in the original experiment .",
    "this immediately raises the question , how much predictive power do such statistical fits have , and how does their power depend upon the form of the underlying landscape from which genotypes have been sampled , as well as the form of the fitting procedure ?    although extrapolation is easy to visualize in a linear regression with one component of @xmath35 , it can not be plotted as easily in high dimensions , where it is sometimes called _ hidden extrapolation _ @xcite . in the discrete , high - dimensional space of genotypes , no genotype is between any two other genotypes , so that every prediction is in some sense an extrapolation rather than an interpolation .    given experimental data , it may be hard to determine if a model is extrapolating accurately or not @xcite . here",
    ", we quantify the accuracy of extrapolation explicitly using mathematical fitness landscapes .",
    "[ fig : wfsample3 ] illustrates the ability of statistical fits to predict fitnesses of genotypes that were not sampled in the training data , for a range of models and for regressions with varying degrees of mis - specification .",
    "this figure quantifies the amount of error when predicting the fitnesses of genotypes that are one or two mutations from the training data , as well as for predicting fitness of random , unsampled genotypes .",
    "away from the training data , the bias and variance increase with each mutation , as reflected by the lower squared correlation coefficients between true and inferred values .",
    "the predictions are progressively worse as the amount of model mis - specification increases .",
    "a statistical model that has a good fit to the training data , i.e.  a high @xmath24 , does not necessarily imply that the model can make accurate predictions , especially if there is over - fitting .",
    "in fact , fig .  [",
    "fig : wfsample3 ] shows that even a high _ cross - validated _ @xmath24 can be misleading in the context of predicting unobserved fitnesses when the model is mis - specified .",
    "it is interesting to compare the extrapolative power of landscapes fitted to genotypes sampled from a wright - fisher population , versus genotypes sampled randomly .",
    "the dashed line in fig .  [ fig : wfsample3 ] indicates the expected @xmath24 for regressions fitted to randomly sampled genotypes .",
    "on the one hand , predictions that are local , i.e.  within a few mutations from the training data , typically have a higher @xmath24 for a model trained on wf - sampled genotypes compared to a model trained on random genotypes . on the other hand , predictions that are far from the training data ( i.e.  predictions for random genotypes ) , typically have much lower @xmath24 for a model trained on wf - sampled genotypes compared to a model trained on random genotypes .",
    "thus , samples from a wright - fisher population produce a more biased model , even of the training data , but may nonetheless produce better predictions for local unsampled genotypes , compared to a model fitted to random genotypes @xcite .    ) and true fitnesses ( @xmath5 ) , for sequences that are one mutation away from the training data ( purple ) , two mutations away from the training data ( cyan ) , and for random sequences ( black ) .",
    "genotypes used as training data were sampled from a wf population after 100 generations of evolution with mutation rates @xmath33 and population size @xmath34 ( see methods ) .",
    "landscapes were each instances of a cubic polynomial form , with @xmath31 values ranging from zero to one ( @xmath35-axis ) , with @xmath36 drawn uniformly in range @xmath37 , and with @xmath38 .",
    "the number of unique sequences sampled from each wf population varied from 34 to 603 ( not shown ) .",
    "[ fig : wfsample3 ] ]      the dynamics of an adapting population depend fundamentally on the form of epistasis , that is , the way in which fitness contributions from one locus depend upon the status of other loci .",
    "indeed , one of the primary goals in fitting a fitness landscape to empirical data is to quantify the amount and form of its epistasis , in order to understand how adaptation will proceed .",
    "given the two sources of biases discussed above , which are inherent to fitting fitness landscapes to empirical data and exacerbated by sampling from populations under selection , the question arises : how do these inferential biases influence the apparent form of epistasis in the fitted landscape ? in this section we address this question by comparing the form of epistasis in the true , underlying fitness landscape to the form of epistasis in the inferred landscape obtained from fitting a quadratic model to sampled genotypes .",
    "there are several measures of epistasis known to influence the dynamics of adaptation .",
    "we will focus on three measures commonly used in the experimental literature on epistasis .",
    "one measure of epistasis , which reflects the degree of predictability in adaptation , is to reconstruct all the possible genetic paths between a low - fitness ancestral genotype and a high - fitness derived genotype sampled from an experimental population @xcite the proportion of such paths that are `` accessible '' , or monotonically increasing in fitness , is then a natural measure of epistasis .",
    "when this proportion is high , many possible routes of adaptation are allowable , suggesting that the evolutionary trajectory can not be easily predicted in advance .",
    "whereas when this proportion is small , it suggests that the evolutionary trajectory is more predictable , at least in a large population .    to generate data similar to what would arise in an evolution experiment , we ran wright - fisher simulations on mathematical fitness landscapes ( see methods ) .",
    "each population began monomorphic and the most populated genotype at the end of the simulation was taken as the derived genotype , which typically contained between 5 to 7 mutations compared to the ancestral genotype .",
    "genotypes and their associated fitnesses were sampled from the population after 100 generations and used to fit a quadratic model of the landscape .",
    "figure [ fig : paths2]a shows an example of all the mutational paths between the ancestral and derived genotypes separated by 5 mutations , for both the true and the inferred fitnesses . since low fitnesses are likely to be overestimated , and high fitnesses are likely to be underestimated , the bias in the inferred landscape tends to eliminate fitness valleys . as a result , the number of accessible paths is higher in the inferred landscape than it is in the true underlying landscape ( fig .",
    "[ fig : paths2]a ) .",
    "epistasis appears to be less severe , and adaptation appears able to take more paths , than it actually is .",
    "this effect occurs systematically , as we have observed it over many realizations of different underlying fitness landscapes ( fig .",
    "[ fig : paths2]b ) .",
    "-axis ) and inferred ( @xmath5-axis ) landscapes .",
    "the inferred landscapes tend to over - estimate the proportion of accessible paths , compared to the true landscape : the proportion of accessible paths was overestimated 3.9-times more often than it was underestimated . in all cases the true landscape was cubic polynomial with @xmath25 , @xmath29 , @xmath30 , and @xmath39 . wf simulation parameters : @xmath33 , @xmath40 , with 500 generated landscapes and simulations .",
    "[ fig : paths2 ] ]    we also investigated two other measures of epistasis : the number of local maxima in the fitness landscape @xcite , and the prevalence of sign epistasis between pairs of mutations @xcite .",
    "both of these quantities are global measures of epistasis , which depend upon the entire landscape , as opposed to the local measure of accessible paths between an ancestral and a derived genotype .",
    "generally speaking , local maxima tend to slow adaptation towards very high fitnesses , even though valley - crossing can occur in large populations @xcite .",
    "sign epistasis occurs when the fitness effect of a mutation at one site changes sign depending upon the status of a second site .",
    "reciprocal sign epistasis is a subset of sign epistasis , and it occurs when the second site also has sign epistasis on the first site .",
    "[ fig : max_signep ] compares the true and inferred amounts of these two global measures of epistasis .",
    "both quantities can be either underestimated or overestimated by the inferred landscape , depending on the circumstances . when the model is miss - specified ( fig .",
    "[ fig : max_signep ] bottom row ) , and without penalization or local sampling of genotypes , both measures of epistasis are heavily underestimated , since the model is unable to capture the local maxima and sign epistasis caused by three - way interactions .",
    "but when genotypes are sampled locally ( fig .",
    "[ fig : max_signep ] top row ) , i.e.  sampled within a few mutations around a focal genotype , and penalized regression is applied , then the inferred landscape is influenced both by penalization bias and extrapolation error .",
    "the penalization bias tends to smooth the inferred landscape and eliminate local maxima ; wherease extrapolation adds noise to the estimated fitnesses and it may create spurious local maxima . which of these two effects dominates depends on the amount of data sampled and how it is distributed .",
    "sign epistasis appears to be less sensitive to extrapolation and bias when the model is well - specified , presumably because it depends only on the signs of effects and not magnitudes . in all cases considered , however , the inferred landscapes exhibit systematically biased global measures of epistasis .",
    "to complement the studies above , which are based on mathematically constructed fitness landscapes , we also investigated more realistic landscapes : computational rna - folding landscapes and empirical data relating regulatory sequences and expression levels ( i.e.  a regulatory sequence binding landscape , see methods ) .",
    "the rna - folding landscape and the regulatory sequence binding landscape ( fig .  [ fig : rnakinney ] ) both exhibit the same form of bias that we observed in the mathematical fitness landscapes .    in the case of the rna - folding landscape ( see fig .  [",
    "fig : rnakinney]a ) there is no measurement error and sufficient data to avoid the need for penalized regression .",
    "thus , the bias towards the mean fitness seen in fig .",
    "[ fig : rnakinney]a with @xmath41 is due entirely to model misspecification : the quadratic model does not capture some higher - order interactions that influence rna folding .",
    "the regulatory sequence expression level data ( fig .",
    "[ fig : rnakinney]b ) , on the other hand , contain some measurement noise which comprises about 10 - 24% of the variance @xcite , whereas the @xmath24 for statistical model is @xmath42 .",
    "these numbers suggest that higher - order interactions bias the predictions made from the statistical model of the regulatory sequence binding landscape , as well , at least to some extent .",
    "the form of the biases observed when fitting a quadratic model to these realistic fitness landscapes ( fig .",
    "[ fig : rnakinney ] ) are similar to the biases observed when fitting quadratic models to @xmath12 landscapes or to polynomial landscapes .",
    "therefore we expect that these biases will have similar consequences for measures of epistasis .",
    "bias arising in a quadratic fit to ( a ) computational rna - folding landscape ( see methods ) , and ( b ) regulatory sequence binding landscape from kinney et al .",
    "@xcite ( see methods ) .",
    "the data are discrete in true fitnesses , @xmath5 .",
    "circles indicate means of distributions of residuals within each bin , and error bars indicate standard deviations .",
    "the quadratic fit exhibits the same type of bias towards the mean fitness as observed in @xmath12 and polynomial fitness landscapes . ]",
    "bias arising from a mis - specified model may be reduced by adding relevant missing variables . in the context of the expansion in eq .",
    "[ eq : quad ] this requires adding higher - order interactions such as triplets of sites , quartets , etc . in practice , this approach is often infeasible because the number of such interactions is extremely large and relatively few of them may be present in the data . in fig .",
    "[ fig : unbias]a we show that the bias in the statistical model can be reduced by fitting a model that includes three - way interactions .",
    "however , there is still some residual bias , due to penalized regression .",
    "thus , incorporating additional predictor variables effectively trades bias due to model mis - specification for bias due to a more severe penalized regression .",
    "it is not always necessary to use penalized regression , especially when higher - order interactions are sparse . in such cases",
    "it may be appropriate first to select a limited number of relevant variables , and then to use standard regression that avoids the bias associated with penalization .",
    "selecting the variables to use in the statistical model may be done `` by hand '' based on prior knowledge , or by statistical methods such as lasso @xcite ( see methods ) .",
    "this approach is expected to perform well only when a relatively small number of variables / interactions are in fact present in the true fitness landscape .    as a proof of principle ,",
    "we have shown how lasso followed by standard unpenalized regression reduces bias in fits to the cubic polynomial and @xmath12 landscapes . notably , lasso is a form of penalized regression that favors sparse solutions .",
    "we do not use lasso in this procedure to make predictions , but rather to select the variables to retain for the eventual unpenalized regression .",
    "the cubic polynomial landscape contains interactions between all triplets of sites , and so the variables retained by lasso are expected to omit some important variables , leaving some bias . by contrast , the @xmath12 landscape has sparse interactions and the resulting fit of this two - step procedure is therefore expected to be far less biased . both of these expectations",
    "are confirmed in fig .",
    "[ fig : unbias ] .",
    "although this approach may have the benefit of reducing bias in the inferred fitnesses , it will not improve the overall @xmath24 of the fit , or the extrapolative power .     reducing bias when fitting a statistical model to ( a ) cubic polynomial landscape , and ( b ) @xmath12 landscape .",
    "bias in the inferred fitnesses can be reduced by adding third - order interactions to the statistical model ( quadratic fit in red , compared to cubic fit in green ) .",
    "although the green model is correctly specified , some bias still remains due to the penalized regression ( @xmath43 parameters fit with @xmath44 data points ) .",
    "further reduction of bias can be achieved by selecting model variables with lasso @xcite , and then performing an unpenalized regression only the selected variables ( blue ) .",
    "the variable selection step may omit some important variables , especially when the true landscapes includes a large number of higher - order interactions , as in the cubic polynomial case ( a ) . if the true landscape has a sparse set of interactions ( e.g.  the @xmath12 landscape , panel b ) , then bias can be removed almost entirely by this two - step procudure .",
    "( a ) : cubic polynomial landscape with @xmath25 , @xmath29 , @xmath30 .",
    "( b ) : @xmath12 landscape with @xmath45 .",
    "a test set of 5,000 random genotypes was used to compare the predicted ( @xmath20 ) and true ( @xmath5 ) fitnesses . ]",
    "our ability to measure the genotype - fitness relationship directly in experimental populations is advancing at a dramatic pace .",
    "and yet we can never hope to measure but a tiny fraction of an entire fitness landscape , even for individual proteins . as a result , there is increasing need to fit statistical models of landscapes to sampled data . here",
    "we have shown that such statistical fits can warp our view of epistasis in the landscape and , in turn , our expectations for the dynamics of an evolving population .",
    "we have identified two distinct sources of biases : penalized regression and model mis - specification .",
    "our analysis of the effects of penalized regression have been performed using ridge regression , but the same qualitative results hold for lasso regressions ( figs . [",
    "fig : regbias_poly_lasso ] , [ fig : regbias_nk_lasso ] , [ fig : wf_poly_lasso ] , [ fig : wf_nk_lasso ] , [ fig : paths_all_lasso ] analogous to figs .",
    "[ fig : regbias ] , [ fig : regbias_nk ] , [ fig : wfsample3 ] , [ fig : wfsample_nk ] , [ fig : paths2]b ) , and also , we expect , for other forms of penalization such as elastic net or the generalized kernel ridge regression in @xcite . notably , the bias arising from penalized regression has a slightly different form depending upon whether genotypes are encoded in the @xmath46 basis relative to the wild - type , in which case inferences will be biased towards the wild - type fitness , or the @xmath47 basis , used here , in which case inferences will be biased towards the average fitness .    aside from these biases , we have also shown that statistical fits have poor predictive power .",
    "even when a fitted landscape exhibits a large cross - validated @xmath24 value , the fitted landscape generally has poor power to predict the fitnesses of unsampled genotypes , including genotypes within only a single mutation of the genotypes used to fit the landscape .",
    "common measures of epistasis may be grossly distorted by statistical fits to sampled data .",
    "interestingly , different measures of epistasis can be affected differently .",
    "for example , the number of paths accessible between an ancestal and derived genotype will be systematically over estimated in such fits , suggesting that evolution is less predictable than it actually is",
    ". the number of local maxima in the inferred landscape can be severly over- or under - estimated , whereas the prevalence of sign epistasis is less prone to bias ( fig .",
    "[ fig : max_signep ] ) .",
    "estimates of pairwise sign epistasis may be more robust because quadratic fits capture pairwise interactions , whereas the number of local maxima can depend on higher - order interactions .",
    "the problems of bias towards smoothness due to penalized regression and ruggedness due to extrapolation error can co - exist in the same dataset , as observed in a recent study of regulatory sequence binding data @xcite . which of these two effects will dominate is unclear , in general , as it depends upon the underlying landscape and the form of sampling . as a result , it is difficult to interpret the predictions made by quadratic fits to fitness landscapes , such as fits made to hiv data @xcite .",
    "nevertheless , it is often possible to at least deduce the presence of epistatic interactions from sampled data @xcite .    in some cases , such as",
    "when the true landscape has sparse high - order interactions between loci , a combination of variable selection followed by unpenalized regression may ameliorate the biases we have identified .",
    "however , the degree to which this approach will reduce bias will surely depend upon the biological context .",
    "thus researchers should incorporate as much prior biological knowledge as possible when choosing a statistical model and fitting procedure . at the very least",
    ", it is important that researchers be aware of the biases inherent in fitting statistical of fitness landscapes to data .",
    "in order to build a statistical model with linear and interacting terms ( eq [ eq : quad ] ) , genetic sequences must be encoded as dummy variables , @xmath3 .",
    "if there is a well - defined wild - type sequence , then a natural parameterization is using zeros and ones , with the wild - type denoted as all zeros .",
    "the coefficients @xmath10 are the effect of single mutations , @xmath11 are the effects of pairs of mutations , and the constant term @xmath48 is the inferred wild - type fitness . in the case of a population with large diversity and no well - defined reference sequence ,",
    "the reference - free parameterization with @xmath49 may be more appropriate , with @xmath48 then denoting the inferred average fitness @xcite . in this work we used the @xmath49 basis , because a wild - type was not defined , and the polynomial landscapes ( see below ) are defined in the @xmath49 basis .",
    "we constructed `` polynomial landscapes '' by terminating the expansion ( eq . [ eq : quad ] ) at the third - order and specifying the coefficients in such a way as to control the contributions to the total variation in log fitness that arise from interactions of each order .",
    "in particular , the variance of @xmath5 is @xmath50 where @xmath51 denotes an average over all genotypes in the orthogonal ( @xmath49 ) basis , and the sums are taken overal all sites , pairs of sites , and triplets .",
    "the coefficients @xmath10 , @xmath11 , and @xmath52 are chosen from normal distributions with mean zero and variances : @xmath53 @xmath54 @xmath55 where @xmath56 is the fraction of total variance determined by the @xmath4th order , @xmath6 is the number of loci , and the total variance is @xmath57 . for our numerical investigations using the cubic polynomial landscapes we chose @xmath18 .",
    "@xmath58 makes no contribution to the variance or the evolutionary dynamics , and was set to zero .",
    "we followed a standard @xcite procedure for constructing @xmath12 fitness landscapes .",
    "the parameter @xmath59 denotes the length of the binary string defining the genotype ( @xmath60 throughout our analyses ) the logarithm of the fitness of a genotype is calculated as the mean of contributions from each site , which are themselves determined by a table of values each drawn independently from a uniform probability distribution .",
    "when @xmath61 , the contribution of a site depends only on its own state : 0 or 1 , and not on the state of other sites . when @xmath62 , the contribution of a site depends on its own ( binary ) allele as well as the states of k other sites , yielding a lookup table with @xmath63 entries",
    "thus , there are in general @xmath59 lookup tables each with @xmath63 independently drawn entries , which together determine the contribution of each locus , based on the status of all other loci . under such @xmath12 models ,",
    "the fitness effect of a substitution depends strongly and randomly on some fraction of the genetic background , determined by @xmath13 .",
    "@xmath13 is constant across sites and genotypes for a particular landscape , and the identifies of the @xmath13 sites upon which a given locus depends are drawn uniformly from the @xmath64 possibilities .",
    "notably , @xmath61 is an additive landscape , and @xmath65 is additive with sparse pairwise interactions .",
    "the amount of total variance in fitness due to the @xmath66th - order interactions is proportional to @xmath67 @xcite .",
    "the rna - folding landscape was generated by the vienna rna software @xcite .",
    "the target secondary structure was chosen as the most common structure observed in a sample of 10,000 structures generated from random genotypes of length 15 .",
    "the fitness function was defined as @xmath68 , where @xmath69 is hamming distance to the target in the tree - edit metric .",
    "training data consisted of @xmath70 random genotypes .",
    "the data consisted of 129,000 sequences of the _ e. coli _",
    "lac promoter and associated gene expression levels .",
    "each sequence contained 75 nucleotides and contained roughly 7 mutations relative to the wild type .",
    "_ e. coli _ were facs sorted by expression levels into 9 bins , and the bin numbers serves as the phenotype for fitting the quadratic model . in this case ,",
    "lasso was used for regression . for more details",
    "see @xcite .",
    "a quadratic fit with ridge regression was used ( unless otherwise stated ) , which identifies the coefficients that minimize @xmath71 where the last sum is taken over all coefficients denoted as @xmath72 .",
    "the first term is the mean squared error , and the last term is the penalization which biases coefficients towards zero .",
    "the free parameter @xmath73 was determined by choosing the largest @xmath73 within one standard deviation of the smallest ten - fold cross - validated mean squared error .",
    "an alternative form of penalization is lasso @xcite , which has a penalization term of the form @xmath74 .",
    "lasso favors sparse solutions of coefficients , and is useful for picking out important variables .",
    "ridge and lasso regression were done by matlab version r2013b .",
    "monte - carlo simulations of adaptation were based on standard wright - fisher dynamics @xcite .",
    "a population consists of @xmath59 individuals , each with a genotype consisting of a bit string of length 20 .",
    "the population replaces itself in discrete generations , such that each individual has a random number of offspring in proportion to its fitness , which is determined by its genotype via the fitness landscape . in practice , this is done efficiently with a multinomial random number generator .",
    "mutations are defined as bit flips , and they are introduced in every individual at each generation with probability @xmath75 per genome .",
    "the number of individuals receiving a mutation is thus binomially distributed , as double mutations are not allowed .",
    "the populations were initialized as monomorphic for a low - fitness genotype , chosen by generating 100 random genotypes and picking the one with the lowest fitness .",
    "simulations were run for 100 generations , and the resulting population was reduced to unique genotypes , and those genotypes , with the corresponding fitnesses , were used as the training data for regressions .",
    "the number of unique genotypes in the population is sensitive to @xmath75 , @xmath59 , the number of generations , and @xmath76 .",
    "these parameters were chosen such that there were at least a few hundred unique genotypes , representing substantial diversity in the population .",
    "the figures plotting true fitness versus residuals were produced using a gaussian moving window applied to the raw data . for each value of true fitness , @xmath5 ,",
    "a mean and standard deviation was calculated by weighting all the data points by a gaussian with a width @xmath77 , and normalized by the sum of all the weights for the given @xmath5 value .",
    "this procedure provides a sense of the distribution at a given @xmath5 , without regard to the density of points .",
    "areas on the extremes of @xmath5 had few points to estimate a mean and variance , and they were excluded if the sum of weights was smaller than the 10% percentile of the distribution of all normalization factors .",
    "we used the smoothing parameter @xmath78 for figures [ fig : regbias ] , [ fig : modelbias ] , [ fig : unbias]a , [ fig : modelbias2 ] , and [ fig : regbias_poly_lasso ] ; @xmath79 for figures [ fig : unbias]b , [ fig : regbias_nk ] , [ fig : modelbias_nk ] , and [ fig : regbias_nk_lasso ] ; @xmath80 for figures [ fig : wfsample2 ] and [ fig : wf_poly_lasso ] ; and @xmath81 for figures [ fig : wfsample_nk ] and [ fig : wf_nk_lasso ] .",
    "a scatter plot of true fitnesses , @xmath5 , versus estimated fitnesses inferred by regression , @xmath20 , reflects the quality of the statistical fit .",
    "one can calculate the slope of @xmath5 versus @xmath20 by using a second regression : @xmath82 where @xmath83 denotes the slope , found by minimizing the mean squared error @xmath84 @xmath85 @xmath86 recall that @xmath87 , where @xmath88 is the residual from the initial regression , and @xmath89 because residuals are uncorrelated with @xmath20 . as a result , we conclude that @xmath90 , which simply reflects the properties of the original linear regression .",
    "this result is analogous to plotting residuals on the @xmath5 axis and inferred values on the @xmath35-axis , and observing no relationship . in the main text , by contrast , we show plots of the true values @xmath5 versus the residuals @xmath22 . in this case",
    "we observe a `` bias '' , in that genotypes with large @xmath5 are underestimated , and genotypes with small @xmath5 are overestimated .",
    "this type of bias is a form of regression towards the mean .",
    "we can calculate the slope of @xmath5 versus @xmath20 as follows : @xmath91 and with a similar calculation we find @xmath92 if we have mean - centered data ( @xmath93 ) , then this slope equals the coefficient of determination of the initial regression , denoted @xmath24 .",
    "equivalently , the slope in plots of @xmath5 versus @xmath22 equals @xmath94 .",
    "we thank a. feder , j. draghi , d. mccandlish for constructive input ; and p. chesson for clarifying the usage of the word between .",
    "j.b.p . acknowledges funding from the burroughs wellcome fund , the david and lucile packard foundation , the u.s .",
    "department of the interior ( d12ap00025 ) , the u.s .",
    "army research office ( w911nf-12 - 1 - 0552 ) , and the foundational questions in evolutionary biology fund ( rfp-12 - 16 ) .",
    "lenski re , travisano m ( 1994 ) dynamics of adaptation and diversification : a 10,000-generation experiment with bacterial populations .",
    "_ proceedings of the national academy of sciences of the united states of america _ 91:68086814 .",
    "blount zd , borland cz , lenski re ( 2008 ) historical contingency and the evolution of a key innovation in an experimental population of escherichia coli .",
    "_ proceedings of the national academy of sciences of the united states of america _ 105:7899906 .",
    "lee yh , dsouza l , fox ge ( 1993 ) experimental investigation of an rna sequence space .",
    "_ origins of life and evolution of the biosphere : the journal of the international society for the study of the origin of life _ 23:36572 .",
    "schlosser k ,",
    "li y ( 2005 ) diverse evolutionary trajectories characterize a community of rna - cleaving deoxyribozymes : a case study into the population dynamics of in vitro selection .",
    "_ journal of molecular evolution _ 61:192206 .",
    "jimnez ji , xulvi - brunet r , campbell gw , turk - macleod r , chen ia ( 2013 ) comprehensive experimental fitness landscape and evolutionary network for small rna . _ proceedings of the national academy of sciences of the united states of america _ 110:149849 .",
    "kinney jb , murugan a , callan cg , cox ec ( 2010 ) using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence . _",
    "proceedings of the national academy of sciences of the united states of america _ 107:915863 .",
    "maharjan rp , ferenci t ( 2013 ) epistatic interactions determine the mutational pathways and coexistence of lineages in clonal escherichia coli populations .",
    "_ evolution ; international journal of organic evolution _",
    "67:27628 .          covert aw , lenski re , wilke co , ofria c ( 2013 ) experiments on the role of deleterious mutations as stepping stones in adaptive evolution .",
    "_ proceedings of the national academy of sciences of the united states of america _ 110:e31718 .",
    "a quadratic model was fit to a cubic polynomial landscape with large negative additive effects , small mean - zero pairwise effects , and positive 3-way effects .",
    "the result is a complicated bias in the inferred landscape , with very low fitnesses being underestimated and very high fitnesses being overestimated . nevertheless , the bias from missing , higher - order interactions as in fig .",
    "[ fig : modelbias ] may be a generic feature .",
    "when the distribution of interaction effects is centered around zero , the model tends to be biased towards the average fitness . ]",
    "the inferred number of local maxima and the prevalence of sign epistasis may be under- or over - estimated by a statistical model of the fitness landscape fit to sampled data .",
    "in the top row the genotypes were sampled  locally \" , so that they are close together in hamming distance .",
    "the sampled genotypes consist of a focal genotype plus all sequences within one and two mutations , totaling 211 sampled sequences .",
    "the true landscape was a quadratic polynomial ( @xmath14 , @xmath15 , @xmath16 ) , and it was fit with a quadratic model by ridge regression ( 211 coefficients ) .",
    "this fit did not require a penalized regression , but we imposed some arbitrary values of the penalization parameter , @xmath73 , to demonstrate its effects .",
    "when @xmath98 , there is no bias ( not shown ) , but when the penalization is modest @xmath99 , purple dots ) , the number of local maxima is over - estimated .",
    "the spurious local maxima are likely due to large extrapolation errors , away from the sampled genotypes .",
    "when the penalization is yet larger ( @xmath100 , pink ) , the penalization bias smooths out the inferred landscape and thus under - estimates the number of local maxima .",
    "the fraction of inferred sign epistasis ( pluses , upper right cluster ) and reciprocal sign epistasis ( crosses , cluster in the lower left ) , is typically overestimated for locally sampled genotypes . in the bottom row ,",
    "5000 genotypes are sampled randomly so that no penalization is required . however , the true landscape in these cases is cubic polynomial ( @xmath25 , @xmath29 , @xmath30 ) , whereas the statistical model is quadratic , resulting in bias from model mis - specification . in these cases ,",
    "the number of local maxima and the prevalence of sign epistasis are both under - estimated . in all cases , @xmath17 and dashed line indicates the line @xmath101 . ]"
  ],
  "abstract_text": [
    "<S> the genotype - fitness map plays a fundamental role in shaping the dynamics of evolution . </S>",
    "<S> however , it is difficult to directly measure a fitness landscape in practice , because the number of possible genotypes is astronomical . </S>",
    "<S> one approach is to sample as many genotypes as possible , measure their fitnesses , and fit a statistical model of the landscape that includes additive and pairwise interactive effects between loci . </S>",
    "<S> here we elucidate the pitfalls of using such regressions , by studying artificial but mathematically convenient fitness landscapes . </S>",
    "<S> we identify two sources of bias inherent in these regression procedures that each tends to under - estimate high fitnesses and over - estimate low fitnesses . </S>",
    "<S> we characterize these biases for random sampling of genotypes , as well as for samples drawn from a population under selection in the wright - fisher model of evolutionary dynamics . </S>",
    "<S> we show that common measures of epistasis , such as the number of monotonically increasing paths between ancestral and derived genotypes , the prevalence of sign epistasis , and the number of local fitness maxima , are distorted in the inferred landscape . as a result </S>",
    "<S> , the inferred landscape will provide systematically biased predictions for the dynamics of adaptation . </S>",
    "<S> we identify the same biases in a computational rna - folding landscape , as well as in regulatory sequence binding data , treated with the same fitting procedure . </S>",
    "<S> finally , we present a method that may ameliorate these biases in some cases . </S>"
  ]
}