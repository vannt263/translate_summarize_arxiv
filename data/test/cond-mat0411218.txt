{
  "article_text": [
    "density functional theory@xcite ( dft ) combined with the generalized gradient approximation ( gga ) for the exchange and correlation functional has become a popular method for studying materials and molecules at the atomic scale .",
    "recently , there has been an increasing interest in using uniform real - space grids and finite - difference methods for doing dft calculations@xcite .",
    "real - space grids give an unbiased description of the wave functions and the quality of the description can easily be controlled by changing the grid - point density .",
    "finite - difference operators are used because the wave function values are given on grid points in real - space , and not in terms of a basis set . by doing all operations in real - space",
    ", parallelization can be done by simple domain decomposition@xcite .",
    "furthermore , real - space methods can make use of multigrid acceleration schemes@xcite for solving the kohn - sham equations@xcite and the poisson equation .",
    "a further advantage of real space methods is the possibility for imposing localization constraints on the wave functions , which is the basis for linearly scaling electronic structure methods@xcite ( order-@xmath0 methods ) .    today , one of the most used methods for performing dft calculations is the pseudo potential method using periodic super - cells and plane - wave expansions for the pseudo wave - functions .",
    "this method shares with the grid - based methods the properties of unbiased representation of the wave functions and simple control of the quality of a calculation ( by changing the number of plane waves ) . however , there are three major difficulties with a plane - wave representation for the wave functions .",
    "1 ) working with spatially localized wave functions , which is important for order-@xmath0 methods , is difficult with the extended nature of plane waves .",
    "2 ) not all operations involving the wave functions , densities and potentials can be done directly in the plane - wave representation , and fourier transformations to and from real - space must be carried out .",
    "transformations between real and reciprocal spaces are highly non - local operations , and therefore difficult to parallelize .",
    "3 ) due to the periodicity of plane waves , the natural boundary conditions for a plane wave calculation is periodic boundary conditions . although all three problems have been addressed@xcite , the suggested solutions are not as simple as for grid - based approaches where all three problems have simple solutions .",
    "an advantage of a plane - wave representation for the wave functions is its compactness .",
    "the memory footprint of a wave function is typically 10 times larger in a real - space grid representation compared to a plane - wave representation of similar accuracy .",
    "for this reason it is important to use soft pseudo wave functions that can be accurately represented on coarse grids . to our knowledge , until now , all applications of grid - based electronic structure calculations have used norm - conserving pseudopotentials .",
    "one way to get smoother pseudo wave functions is to relax the norm - conservation of the wave functions and use ultra - soft pseudopotentials@xcite or the projector augmented wave ( paw ) method@xcite .",
    "we have decided to use the paw method .",
    "the paw method works with soft valence wave functions and , similar to the ultra - soft pseudopotential method , the wave functions need not be normalized .",
    "contrary to the ultra - soft pseudopotential method , the paw method is an all - electron method within the frozen core approximation , giving access to the true wave functions and the full electron density .",
    "the paw method has been implemented for plane waves by several groups@xcite .",
    "we see the combination of real - space grid - based methods and the paw method as an important step towards enabling larger calculations at a level of accuracy which is essentially all - electron in nature .",
    "there is a clear trend in electronic structure theory towards larger and more complex systems as for example nanostructures , large ( bio-)molecular complexes and extended defects in real materials .",
    "systems which all quickly challenge present day high accuracy dft codes , that are typically limited to at most a few hundred atoms .",
    "the great potential of the method presented here lies in the parallelization of the real - space algorithms .",
    "this makes it possible to make use of massively parallel computers as has been demonstrated by several other groups@xcite . in this paper ,",
    "we focus on how to do accurate dft calculations efficiently by using a real - space paw method .",
    "we demonstrate the accuracy of our grid - based paw calculations by showing that we are able to reproduce results for atomization energies from all - electron dft calculations .",
    "this very stringent test shows that the methodology that we have developed is useful for real applications .    the solution of poisson s equation is straightforward using multigrid methods@xcite ( no fourier transformations required ) . solving the kohn - sham equations using multigrid methods",
    "is a much more difficult task : keeping the different eigenstates separated and orthogonal to each other can be a problem , and representing the hamiltonian on the coarse grids can also be problematic .",
    "we have decided to use the techniques typically used in `` state of the art '' pseudopotential plane - wave calculations@xcite as they have been developed and improved over the the last few decades . for iteratively solving the kohn - sham equations",
    ", we use pulay mixing techniques for obtaining the self - consistent density@xcite , subspace diagonalizations , and the residual minimization method@xcite using preconditioning of the electronic gradients for iteratively improving the wave functions .",
    "the preconditioning operation is a single multigrid v - cycle using only the kinetic energy operator as an approximate hamiltonian@xcite .    in the following section",
    ", we will briefly summarize the paw method .",
    "then , in section  [ grids ] , we will go through the details of our grid - based formulation of the paw formalism . in section  [ groundstate ] ,",
    "we describe how we solve the kohn - sham equations , and the evaluation of atomic forces is discussed in section  [ forces ] .",
    "section  [ generalizations ] describes generalizations of the method to periodic systems with use of brillouin zone sampling . in section  [ applications ]",
    "we apply the methodology that we have developed to a number of example systems and discuss approximations necessary for realistic calculations .",
    "finally , in section  [ performance ] we discuss the computational performance of our implementation .",
    "the notation we use is close to the one used by p. e. blchl in his papers on the paw method@xcite .",
    "we have used hartree atomic units ( @xmath1 ) and we write the equations for the case of a spin - paired and finite system of electrons .",
    "the paw method is based on a transformation between smooth pseudo wave functions , @xmath2 , and the true all - electron kohn - sham wave functions , @xmath3 ( @xmath4 is the band index ) .",
    "the core states of the atoms , @xmath5 , are frozen . here",
    "@xmath6 is an atom index and @xmath7 is a combination of principal , angular momentum , and magnetic quantum numbers respectively ( @xmath4 , @xmath8 and @xmath9 ) .    given a smooth pseudo wave function , the corresponding all - electron wave function , which is orthogonal to the set of @xmath5 orbitals , can be obtained through a linear transformation    @xmath10    the transformation operator , @xmath11 , is given in terms of atom centered all - electron wave functions , @xmath12 , the corresponding smooth partial waves , @xmath13 , and projector functions , @xmath14 , as    @xmath15    the atom centered all - electron wave functions are taken from a calculation of a single atom with spherical symmetry : @xmath16 , where the @xmath17 s are real - valued spherical harmonics ( @xmath18 is a combined index for @xmath8 and @xmath9 ) .    a radial cutoff distance , @xmath19 , defining the atomic augmentation sphere is chosen .",
    "this radius is similar to a cutoff radius for a pseudopotential .",
    "the larger the augmentation sphere , the smoother the pseudo wave functions , but overlap with neighboring augmentation spheres must be avoided .",
    "for all all - electron valence states smooth partial waves @xmath20 are constructed .",
    "the partial waves must match the corresponding all - electron waves for @xmath21 .",
    "in this way , the correction in parenthesis in eq .",
    "( [ transform ] ) is zero outside the augmentation spheres and we will have @xmath22 in this region .",
    "notice , that there are no norm - conservation requirements to meet when choosing the shape of @xmath23 inside the augmentation sphere .",
    "smooth projector functions must also be defined  one for each partial wave : @xmath24 .",
    "they must be localized inside the augmentation spheres and satisfy @xmath25 , which for the radial part gives @xmath26 with this construction we have @xmath27 .    in principle , an infinite number of projectors and partial waves are required for the paw method to be exact . for practical calculations , a high accuracy data set will need only one or two projector functions for each angular momentum channel of importance .",
    "this is similar to an ultra - soft pseudopotential , where a comparable number of projectors is needed .",
    "one partial wave is usually taken as the bound valence state , and additional waves can be taken from `` excited states ''  solutions to the radial kohn - sham equation at different non - eigenvalue energies .",
    "the construction of partial waves and projector functions is described in appendix  [ construction ] .",
    "> from the atomic frozen core electron density , @xmath28 , a smooth core electron density , @xmath29 , is constructed .",
    "it must be identical to @xmath28 for @xmath21 .",
    "there is no norm - conservation requirement to meet when choosing the shape of @xmath29 inside the augmentation sphere .",
    "the pseudo electron density has contributions from the wave functions and from the atom centered smooth core electron densities : @xmath30 where the @xmath31 s are occupation numbers and @xmath32 is the position of atom @xmath6 .    an atomic density matrix ( see eq .  ( 22 ) in ref .  )",
    "is defined as @xmath33 where @xmath34    the paw formalism defines atom centered all - electron and pseudo electron densities as @xmath35 and @xmath36 respectively . by construction",
    ", @xmath37 is identical to the all - electron density , @xmath38 , for @xmath39 and @xmath40 for @xmath41 ( see ref .   for details ) .",
    "therefore , the true all - electron density can be obtained from the pseudo electron density : @xmath42.\\ ] ] again , the correction is zero outside the augmentation spheres .    a neutral charge density , @xmath43 ,",
    "is obtained by adding compensation charges , @xmath44 , inside the augmentation spheres to the pseudo electron density .",
    "these charges compensate for the lack of norm - conservation and for the nuclear charge : @xmath45    using localized functions @xmath46 normalized as @xmath47 the compensation charges are constructed with electrostatic multipole moments @xmath48 : @xmath49    the values to be used for the electrostatic multipole moments , @xmath48 , are found by requiring the pseudo charge density , @xmath50 , to have the same electrostatic multipole moments as the all - electron charge density , @xmath51 , where @xmath52 is the nuclear charge density ( @xmath53 is the atomic number ) .",
    "this requirement can be expressed as @xmath54    y_l(\\hat{\\mathbf{r } } ) = 0.\\ ] ]    inserting eqs .",
    "( [ n ] ) , ( [ nt ] ) and ( [ zt ] ) we get : @xmath55 where the constants @xmath56 and @xmath57 are given by : @xmath58\\ ] ] and @xmath59.\\ ] ]      the paw total energy is a function of the pseudo wave functions , @xmath60 , and the occupation numbers , @xmath31 .",
    "the energy can be divided into a `` soft '' contribution , @xmath61 , and corrections for each atom ( see ref .   and ):",
    "@xmath62    the `` soft '' energy contribution is : @xmath63\\nonumber \\\\    & & + \\int d\\mathbf{r } \\tilde{n}(\\mathbf{r } )    \\sum_a \\bar{v}^a(|\\mathbf{r } - \\mathbf{r}^a|),\\end{aligned}\\ ] ] where @xmath64 is the pseudo hartree potential , satisfying poisson s equation @xmath65 and @xmath66 is an exchange - correlation functional . finally , @xmath67 is an arbitrary localized potential vanishing for @xmath21 . the soft energy contribution , @xmath61 ,",
    "is to be evaluated on three dimensional grids in real space .",
    "the atomic corrections to the energy ( @xmath68 ) are given by : @xmath69      [ n^a(\\mathbf{r } ' ) + z^a(\\mathbf{r } ' ) ] }    { |\\mathbf{r } - \\mathbf{r}'|}\\nonumber \\\\    & + e_{\\text{xc}}[n^a(\\mathbf{r } ) ]    \\label{ea}\\end{aligned}\\ ] ] and @xmath70      [ \\tilde{n}^a(\\mathbf{r } ' ) + \\tilde{z}^a(\\mathbf{r } ' ) ] }    { |\\mathbf{r } - \\mathbf{r}'|}\\nonumber \\\\    & + e_{\\text{xc}}[\\tilde{n}^a(\\mathbf{r } ) ]    + \\int d \\mathbf{r } \\tilde{n}^a(\\mathbf{r } ) \\bar{v}^a(r ) .",
    "\\label{eat}\\end{aligned}\\ ] ] the energy contributions for @xmath71 and @xmath72 , are evaluated on radial grids inside the augmentation spheres .    by using eqs .",
    "( [ n ] ) , ( [ nt ] ) , ( [ zt ] ) and ( [ q ] ) we can reduce the atomic correction , @xmath68 , to a function of @xmath73 : @xmath74 the constants @xmath75 , @xmath76 and @xmath77 are evaluated in the appendix  [ constants ] .",
    "the last term is an exchange - correlation correction : @xmath78      - e_{\\text{xc}}[\\tilde{n}^a(\\mathbf{r } ) ] ,      \\label{xca}\\ ] ] which is a function of @xmath73 through eqs .",
    "( [ n ] ) and ( [ nt ] ) . for local and semi - local exchange - correlation functionals , @xmath79 is written as an integration inside the augmentation sphere .",
    "there are several possibilities for the evaluation of this term .",
    "we use radial integration along lines from the center to a number of points distributed evenly on the surface of the augmentation sphere@xcite .",
    "we find that this approach is the simplest for gga functionals@xcite .",
    "alternatively , one can expand the atomic densities in spherical harmonics , as described in ref .   or use grid free approaches@xcite .",
    "in this section we give the details of our real - space grid - based implementation of the paw method . from now on , wave functions , electron densities and potentials are represented on three - dimensional uniform grids in real - space .      in a grid representation ,",
    "integrals over space are turned into sums over grid points . in the paw method",
    "we often need to calculate the integral of a localized function , centered on an atom , multiplied by a function extended over all of space . as an example , let us take a projector function , @xmath80 , centered on atom @xmath6 at position @xmath32 , multiplied by an extended wave function , @xmath60 .    in the following ,",
    "we use the index @xmath81 to index the grid points used for the wave functions . transforming the integral to a sum over grid points , @xmath81 , with @xmath82 being the volume per grid point ,",
    "we get : @xmath83 where @xmath84 and @xmath85 is the position of grid point @xmath81 ( only the grid points in the localized region around atom @xmath6 needs to be summed over ) .",
    "for @xmath86 we could use @xmath87 .",
    "however , this is not accurate enough , unless we use a very fine grid , which would compromise efficiency .",
    "instead we use the elegant double grid technique of ono and hirose@xcite . here , the extended function is interpolated to a finer grid with grid points @xmath88 : @xmath89 .",
    "the interpolation operator @xmath90 takes the wave function from a coarse grid to a fine grid .",
    "typically , a cubic interpolation is used and the fine grid has five times more points in each direction as the coarse grid@xcite .",
    "the localized projector function is evaluated on a fine grid as @xmath91 . with @xmath92 being the volume per fine grid point",
    "we get a more accurate sum : @xmath93 \\tilde{\\psi}_{ng}.\\end{aligned}\\ ] ]    comparing the rightmost expression with eq .",
    "( [ sum ] ) , we identify the term in square brackets as the more accurate expression for @xmath86 : @xmath94    this is equivalent to a restriction operation taking the localized function from the fine temporary grid to the coarse grid ( restriction is the opposite of interpolation ) . notice that in eq .",
    "( [ sum ] ) , the sum is over coarse grid points , and no actual interpolation of the extended function needs to be done .",
    "the evaluation of the localized function on the temporary grid is a relatively inexpensive operation , with an operation count which for each atom is independent of the system size .",
    "we use the double grid technique to transfer localized functions , such as @xmath14 , @xmath29 and @xmath67 , to values on real - space grids ( @xmath86 , @xmath95 and @xmath96 ) .      the formulas for densities , potentials , and energies , given in section  [ paw ]",
    ", must be translated to a discretized form for use with a discrete representation of wave functions , densities and potentials . the pseudo electron density , eq .",
    "( [ nofr ] ) , is calculated on a coarse grid as @xmath97    the smooth atomic core electron densities can be chosen very soft , so that they can be added to the coarse grid .",
    "the pseudo electron density on the coarse grid is interpolated to a finer grid ( grid points indexed by @xmath98 ) : @xmath99 we use a cubic interpolation for @xmath100 , and the fine grid has twice as many grid points as the coarse grid in each direction . from the pseudo electron density on the fine grid , one can obtain the neutral charge density as [ see eq .",
    "( [ rhot ] ) ] : @xmath101    using our grid representation for wave functions , densities and potentials , we get for @xmath61 : @xmath102 where @xmath82 and @xmath103 are the volumes per grid point for the coarse wave function grids and the fine density and potential grids respectively , and @xmath104 is a central finite difference representation of the laplacian .",
    "the discretization that we use for the laplacian , uses a total of twelve neighbor points , giving an error of the order of @xmath105 , where @xmath106 is the grid spacing .",
    "the pseudo hartree potential @xmath107 is found by solving poisson s equation , @xmath65 , using a discretization for the laplacian : @xmath108    this equation is solved using the multigrid technique pioneered by brandt@xcite . solving the poisson equation iteratively on the finest grid will quickly reduce the short wavelength errors , but errors with larger wavelengths compared to the grid spacing are reduced only slowly .",
    "the multigrid technique introduces a series of coarser grids where the long wavelength errors can be effectively reduced .",
    "we use a mehrstellen discretization@xcite , where @xmath109 is expressed in terms of two short - ranged finite difference operators @xmath110 and @xmath111 : @xmath112    for the coarse grids used in the multigrid v - cycle , simple nearest neighbor central finite - difference laplacians are used .",
    "adding the compensation charges , @xmath113 , to the pseudo electron density [ eqs .",
    "( [ rhot ] ) and ( [ rho ] ) ] will require a very fine density grid in order to get an accurate description of the charge .",
    "the problem is that the compensation charges must be localized inside the augmentation spheres : @xmath114 for @xmath115 .",
    "blchl has described a method for plane - wave basis sets@xcite , that allows the use of softer compensation charges extending outside the augmentation spheres .",
    "we use the same method for our grid - based approach .",
    "a cutoff radius @xmath116 larger than @xmath19 is chosen .",
    "soft compensation charges with the same electrostatic multipole moments as the localized compensation charges are constructed : @xmath117 where @xmath118 is a soft function localized within @xmath119 .",
    "the soft function , @xmath118 , is normalized in the same way as @xmath120  see eq .",
    "( [ norm ] ) .    equation ( [ rho ] ) must now be replaced by : @xmath121 and a correction must be added to @xmath61 .",
    "the correction is ( see ref .  ):",
    "@xmath122 where @xmath123 , and @xmath124    the first term in eq .",
    "( [ correction ] ) is evaluated on the grid as @xmath125 .",
    "the transformation of the localized potential , @xmath126 , and the localized compensation charge , @xmath127 , ( both vanishing for @xmath128 ) to values at grid points , @xmath129 and @xmath130 , is done using the double grid technique@xcite .",
    "the last term in eq .",
    "( [ correction ] ) is a pair potential with range @xmath131 : @xmath132 where @xmath133 the pair potential terms , @xmath134 , are functions of the difference vectors @xmath135 .",
    "the orthogonality constraint of the all - electron wave functions , @xmath136 , can be expressed in terms of the pseudo wave functions@xcite as @xmath137 , where the paw overlap operator @xmath138 is non - local : @xmath139 with @xmath140\\nonumber \\\\    & = & \\sqrt{4 \\pi } \\delta_{00i_1i_2}^a.\\end{aligned}\\ ] ] the discretised overlap operator looks like : @xmath141 and the orthogonality constraint of the pseudo wave functions can be expressed as @xmath142",
    "in order to find the electronic ground state it is necessary to calculate the derivatives of the total energy with respect to the wave function values .",
    "this `` electronic gradient '' can be expressed in terms of a hamiltonian @xmath143 : @xmath144    the hamiltonian is given as a sum of the kinetic energy operator and the local and non - local parts of the effective potential : @xmath145    explicit formulas for the local effective potential , @xmath146 , and the `` atomic '' hamiltonian , @xmath147 , are given in the appendix  [ ham ] .",
    "the set of orthonormalized ground - state wave functions that diagonalize the hamiltonian matrix @xmath148 , must satisfy the kohn - sham equations : @xmath149      in order to locate the self - consistent ground state , we use the residual minimization method of wood and zunger@xcite ( see also ref .  ) .",
    "the residuals are calculated as @xmath150 where @xmath151 is the current estimate of the eigenvalue of the @xmath4th band .",
    "using a preconditioning operator @xmath152 ( to be discussed later ) , we can improve the wave function by taking a step along the direction of the preconditioned residual : @xmath153 ( @xmath154 is the step length ) .",
    "the optimal step length is found by minimizing the norm of the residual for the new guess : @xmath155 finding the optimal value for @xmath154 amounts to finding the minimum of a second order polynomial in @xmath154 .",
    "having found the optimal step length for the first step , we do the actual update of the wave function by taking an additional step using the same step length in the direction of the preconditioned residual @xmath156 : @xmath157 for updating one wave function , one must apply the hamiltonian twice , and two preconditioning operations are required .    if we were to take steps along the residual ( and not along the preconditioned residual ) , we would need very many iterations in order to converge .",
    "the problem is that the residual vector is not necessarily parallel to the error vector ( which we do nt know ) .",
    "the purpose of preconditioning is to produce a direction that more accurately represents the error vector@xcite .",
    "we would get the optimal preconditioned residual @xmath158 by solving @xmath159 . instead of solving this equation exactly ,",
    "we solve approximately the simpler equation @xmath160 .",
    "this is done using one multigrid v - cycle , where a nearest neighbor discretization is used for the laplacian on the coarse grids@xcite .",
    "when all wave functions have been updated , the wave functions are othonormalized , and the density is updated .",
    "from the new density , a new hamiltonian is generated ( @xmath146 and @xmath161 ) .",
    "finally , a subspace diagonalization is performed , and the next iteration towards self - consistency can begin . for each iteration",
    "a new input density is estimated using pulay mixing@xcite .",
    "typically three old densities are used .",
    "the atomic density matrices , @xmath73 , are mixed as well .",
    "we start the iterations from a good guess at the wave function : a linear combination of atomic orbitals .",
    "the atomic force acting on an atom is defined as @xmath162 in the last line , we have used eqs .",
    "( [ grad ] ) and ( [ ks ] ) .",
    "the variation of the wave function corresponding to a variation in the position can be found from eq .",
    "( [ o ] ) : @xmath163 inserting into eq .",
    "( [ f ] ) , we get : @xmath164 \\nonumber \\\\    & - \\sum_{a ' } \\sum_{ll ' } q_l^a \\frac{dv_{ll'}^{aa'}}{d\\mathbf{r}^a }    q_{l'}^{a'}.    \\label{ff}\\end{aligned}\\ ] ]    as an example , we show in fig .",
    "[ force ] , the force along the bond of a co molecule calculated using the analytical expression above .",
    "fitting a third order polynomial to the energies and taking the negative of the derivative with respect to the bond length , is seen to give exactly the same force .",
    "we have implemented the algorithms introduced above , and in addition we have made two extensions : 1 ) treatment of spin - polarized systems and 2 ) treatment of periodic systems using brillouin zone sampling .",
    "the first extension is straightforward .",
    "when @xmath165-points are introduced in order to treat periodic systems , we can work directly with the wave functions and use bloch boundary conditions@xcite : @xmath166 where @xmath167 is any bravais lattice vector .",
    "this is different from the plane wave approach , where the periodic basis set forces one to work with the periodic part of the wave function and the hamiltonian becomes @xmath165-point dependent . in our case , the boundary conditions become @xmath165-point dependent .",
    "it is only necessary to work with the @xmath165-points in the irreducible part of the brillouin zone .",
    "each @xmath165-point will have a specific weight , and densities , atomic density matrices , and forces should be appropriately symmetrized .    for evaluating the gga exchange - correlation energy and potential",
    ", we use a finite difference operator for calculating the gradient of the density .",
    "the exchange - correlation potential is calculated as the exact derivative of the discretised exchange - correlation energy with respect to @xmath168 ( similar in spirit to the method of white and bird@xcite used for plane - wave basis sets ) .",
    "the first application of the algorithms described here is the calculation of atomization energies for the twenty small molecules listed in table  [ mol20 ] using the pbe@xcite exchange - correlation functional .",
    "the augmentation sphere radii used and the number of projectors used are shown in table  [ rc ] .",
    "the choice of the augmentation sphere radii is a compromise between smooth pseudo wave functions and a low number of projector functions : a larger radius will allow us to have smoother pseudo wave functions , but more projector functions will be needed for high accuracy . furthermore , the radius is limited by the requirement that the overlap between neighboring augmentation spheres should be small .",
    "the radii we have chosen , will give slight overlaps in some of the molecular calculations .",
    ".pbe and experimental atomization energies ( experimental geometries are used@xcite , and zero point vibration energy has been removed ) .",
    "the ground states of c , o , f , p and cl are found to be non - spherical@xcite . all - electron and experimental numbers are taken from refs .   and .",
    "[ cols=\"<,^,^,^,^ \" , ]     [ al ]",
    "we have compared the performance of the real - space code with a highly optimized ultra - soft plane - wave code@xcite .",
    "the ground state of 64 si atoms in the diamond structure was found using both codes .",
    "for the plane wave calculation , plane waves with kinetic energies up to 100 ev were used and the size of the real - space grid for fast fourier transforms was @xmath169 points .",
    "the same grid size was used for the real - space code ( @xmath170  ) . after finding the electronic ground state ,",
    "one atom was displaced by 0.1  , and the time for converging to the new ground state was measured .",
    "the measured times were 21 and 26 minutes for the plane wave code and real - space code respectively on a pentium-4 2.6 ghz linux machine .",
    "we have estimated the degree of convergence of the two codes by calculating the cohesive energy of silicon . the cohesive energy calculated with the plane wave code and a plane wave cutoff of 100 ev , was converged to within 40 mev of the fully converged value . with the real - space code and @xmath170  ,",
    "the cohesive energy was converged to within 3 mev of the @xmath171 value .",
    "this result and similar results for other calculations we have performed seem to indicate that the real - space code obtains a somewhat better convergence at the same grid spacing as the plane - wave code .",
    "furthermore , the real - space code can , most likely , take advantage of a number of improvements , such as algorithmic improvements and optimizations of floating point operations and memory access .",
    "the plane wave code has already benefited from optimizations of this sort .",
    "regarding the memory requirements , the plane - wave code is clearly more economic .",
    "the memory required to store one wave function for the 64 atom silicon system is @xmath172 floating point numbers for the real - space code and 2897 floating point numbers@xcite for the plane - wave code .",
    "using the techniques described in this article , an important step in every electronic structure calculation , namely the application of the hamiltonian to all wave functions , can be done in @xmath173 operations .",
    "this is a more optimal scaling , than the @xmath174 scaling that can be achieved with plane - wave basis sets and fast fourier transforms .",
    "operations such as orthogonalization and subspace diagonalization of the wave functions scale as @xmath175 .",
    "luckily , the prefactors for these @xmath175 operations are very low , so that very large system sizes are required before the @xmath175 terms become the bottleneck@xcite . in the limit where @xmath175 terms start to dominate , plane wave methods will in principle have an advantage , because the number of plane wave coefficients will typically be less than the number of grid points used in real - space grid - based calculations . however , we believe , that for those very large systems , efficient parallelization on massively parallel computers and the use of @xmath176 methods is crucial .    currently , we have a single processor implementation of our paw real - space algorithms@xcite .",
    "this limits us to study rather small systems .",
    "obviously a parallelization using real - space domain decomposition is needed .",
    "for the small systems that we have studied so far , charge sloshing is less of a problem , but it may become a problem when we move on to larger systems .",
    "it will therefore be necessary to improve on our mixing of the density .",
    "a preconditioning , such as that proposed by kerker@xcite , that will damp the long wavelength changes to the density should be considered .",
    "another improvement would be to use a special metric , that weights long wavelength errors higher than short wavelength errors , for estimating the norm of the difference between input and output densities in the pulay method@xcite .",
    "these improvements to the density mixing are easily implemented in reciprocal space , but may be challenging to do in real - space .",
    "financial support from the carlsberg foundation is gratefully acknowledged .",
    "we furthermore acknowledge support from the materials research program of the danish research agency grant # 5020 - 00 - 0012 , and from the danish center for scientific computing .",
    "in the following , we provide explicit formulas needed for calculating the constants and functions that describe an atomic species .      a dft calculation for the atom",
    "is performed using radial grids for the wave functions , densities and potentials .",
    "the radial kohn - sham equation gives us a set of radial all - electron wave functions , normalized as @xmath177 ^ 2 = 1 $ ] .",
    "the core states are only used for constructing a frozen core electron density : @xmath178 ^ 2.\\ ] ]    the smooth partial wave functions are chosen as @xmath179 for @xmath180 , and the coefficients , @xmath181 , are chosen so that @xmath182 joins @xmath183 smoothly at @xmath184 .",
    "the projector functions are calculated as @xmath185 the projector functions must be orthonormalized as described by blchl@xcite .",
    "the potential @xmath186 is chosen so that the local effective potential , @xmath187 , has the following shape for @xmath188 in the atomic reference state : @xmath189 the constants @xmath190 and @xmath191 are found by requiring that @xmath192 and @xmath193 .",
    "for the compensation charges we use gaussians : @xmath194 and @xmath195 with this choice for the compensation charges , the integral , @xmath134 , in eq .",
    "( [ pair ] ) , can be evaluated analytically@xcite .",
    "we choose the @xmath196 s so that @xmath197 and @xmath198 .",
    "the integrals for @xmath200 , @xmath201 , @xmath202 , @xmath203 , @xmath204 and @xmath205 are ( all integrals are limited to inside the augmentation spheres ) : @xmath208 \\nonumber \\\\    & - \\int d\\mathbf{r } \\tilde{n}_c^a(r ) \\bar{v}^a(r),\\end{aligned}\\ ] ] @xmath209 \\nonumber \\\\    & + \\int d\\mathbf{r }    [ v_{i_1i_2}^a(\\mathbf{r})n_c(r ) +    v_c^a(r )     \\tilde{\\phi}_{i_1}^a(\\mathbf{r } ) \\tilde{\\phi}_{i_2}^a(\\mathbf{r } ) ]     \\nonumber \\\\    & - \\int d\\mathbf{r }    \\frac{\\phi_{i_1}^a(\\mathbf{r } ) \\phi_{i_2}^a(\\mathbf{r})}{r } \\mathcal{z}^a    \\nonumber \\\\    & - \\int d\\mathbf{r }    \\tilde{\\phi}_{i_1}^a(\\mathbf{r } )    \\tilde{\\phi}_{i_2}^a(\\mathbf{r } ) \\bar{v}^a(r),\\end{aligned}\\ ] ] @xmath210,\\ ] ] @xmath211 @xmath212 and @xmath213      it is advantageous to decompose @xmath214 into angular momentum contributions as @xmath218 and solve @xmath219 = -4\\pi    g_{l_1l_2}^l y_l(\\hat{\\mathbf{r } } ) \\nonumber \\\\    & \\times [ \\phi_{n_1\\ell_1}^a(r ) \\phi_{n_2\\ell_2}^a(r )    - \\tilde{\\phi}_{n_1\\ell_1}^a(r ) \\tilde{\\phi}_{n_2\\ell_2}^a(r)],\\end{aligned}\\ ] ] where @xmath220 is a gaunt coefficient .",
    "the discretized hamiltonian , eq .",
    "( [ h ] ) , depends on @xmath146 and @xmath147 . the local effective potential on the coarse grid , @xmath221 , is a restriction of the local effective potential on the fine grid : @xmath222 and the atomic hamiltonian , @xmath147 , is @xmath223 where @xmath224"
  ],
  "abstract_text": [
    "<S> a grid - based real - space implementation of the projector augmented wave ( paw ) method of p. e. blchl [ phys . rev . </S>",
    "<S> b * 50 * , 17953 ( 1994 ) ] for density functional theory ( dft ) calculations is presented . </S>",
    "<S> the use of uniform 3d real - space grids for representing wave functions , densities and potentials allows for flexible boundary conditions , efficient multigrid algorithms for solving poisson and kohn - sham equations , and efficient parallelization using simple real - space domain - decomposition . </S>",
    "<S> we use the paw method to perform all - electron calculations in the frozen core approximation , with smooth valence wave functions that can be represented on relatively coarse grids . </S>",
    "<S> we demonstrate the accuracy of the method by calculating the atomization energies of twenty small molecules , and the bulk modulus and lattice constants of bulk aluminum . </S>",
    "<S> we show that the approach in terms of computational efficiency is comparable to standard plane - wave methods , but the memory requirements are higher . </S>"
  ]
}