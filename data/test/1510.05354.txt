{
  "article_text": [
    "it is widely known that many classical results in model theory fail or become meaningless when considered at the finite level . an important class of such results are preservation theorems , which relate the form of syntactic expressions to the closure properties of classes they define .",
    "classical preservation theorems are almost uniformly false when restricted to the class of all finite relational structures , but also tend to fail when restricted to the class all of finite algebras .",
    "a key example is the os - tarski preservation theorem , which says that a first - order sentence is preserved under taking extensions if and only if it is equivalent to an existential sentence .",
    "see tait  @xcite or gurevich and shelah  @xcite for a counterexample in the finite setting for relational structures , and clark , davey , jackson and pitkethly  ( * ? ? ?",
    "* example @xmath0 ) for a counterexample in the finite setting for algebras . for some preservation theorems",
    "only one side of the story is explained ; for example the @xmath1-preservation theorem , which asserts that a first - order formula is preserved under taking substructures and direct products if and only if it is equivalent to a universal - horn sentence , remains to be settled at the finite - level in the relational setting . in contrast ,",
    "example 4.3 of @xcite also gives a counterexample for algebraic structures at the finite level . on the other hand , lyndon s positivity theorem , which says that a first - order sentence is preserved under taking surjective homomorphisms if and only if it is equivalent to a positive sentence , fails in the finite setting for relational structures ( see ajtai and gurevich  @xcite ) , while its status remains unknown in the algebraic setting .",
    "a notable exception is rossman s celebrated finite homomorphism preservation theorem  ( * ? ? ?",
    "* theorem 5.16 ) : a first - order sentence is preserved under homomorphisms on finite relational structures if and only if it is equivalent , amongst finite relational structures , to an existential positive sentence .",
    "the question whether the classical homomorphism preservation theorem would continue to hold on finite relational structures was a long - standing one in finite model theory .",
    "the analogous question for algebraic signatures remains unresolved .",
    "the proof for the relational case is highly non - trivial and , as rossman suggests , the task of adjusting for function symbols is conceivably more difficult .",
    "preservation theorems that hold for the class of all finite relational structures do not necessarily relativise to subclasses of this class , and moreover , while many classical preservation theorems fail amongst all finite relational structures , some preservation theorems are recovered in restricted classes of finite relational structures . in @xcite ,",
    "atserias , dawar , and grohe show that the os - tarski preservation theorem is recovered in a number of classes of finite relational structures that are of interest from a computational point of view , including classes of finite acyclic graphs , classes of structures of bounded degree , and classes of structures of treewidth at most @xmath2 , for any positive integer @xmath2 . in @xcite , atserias , dawar and kolaitis",
    "show that the homomorphism preservation property holds for a number of classes of finite relational structures , including classes of structures of bounded degree , classes of bounded treewidth , and more generally , classes of finite structures whose cores exclude at least one minor",
    ". however these results are not implied by rossman s finite homomorphism preservation theorem .",
    "furthermore , preservation theorems need not behave consistently when we restrict our attention to a particular subclass of the class of all finite relational structures : for example , the homomorphism preservation property holds for the class of all planar graphs , but in contrast , the extension preservation property fails in this setting .",
    "relativising preservation theorems to restricted classes of finite structures appears to be completely independent of whether or not the corresponding preservation property holds amongst all finite relational structures .",
    "on the other hand , relativisation of preservation theorems to restricted classes of finite algebras is not as well studied . in this paper",
    ", we are able to give some insight into this topic .    1 .",
    "[ item:1 ] we show that within the class of finite bounded lattices , there are many classes that demonstrate the failure of the homomorphism preservation property .",
    "more specifically , we show that for a fixed finite bounded lattice @xmath3 , the class of finite bounded lattices admitting a homomorphism into @xmath3 is definable by a single first - order sentence , relative to the class of finite bounded lattices , but is not definable by universal sentences . see theorem  [ thm : algfail ] in section  [ section : sectionalg ] .",
    "[ item:2 ] in contrast to ( [ item:1 ] ) , we establish a relativised homomorphism preservation theorem ( see theorem  [ thm : sausage ] in section  [ section : sectrelational ] ) for a wide range of classes of finite relational structures .",
    "theorem  [ thm : sausage ] gives us a complete characterisation of first - order definable classes of relational structures admitting a homomorphism into a fixed finite relational structure , relative to classes @xmath4 definable by sentences of some general forms .",
    "in theorem  [ thm : colourfam ] we extend this characterisation to classes of relational structures admitting a homomorphism into one of a finite number of relational structures .",
    "we will see that theorem  [ thm : algfail ] mentioned in ( [ item:1 ] ) not only demonstrates the failure of the homomorphism preservation property for the class of finite bounded lattices , but also the failure of the extension preservation property ( os - tarski preservation theorem ) . so the extension preservation property , which fails for the class of all finite algebras and also the class of all finite relational structures , continues to fail when we restrict to the class of finite bounded lattices .",
    "this result could be contrasted with the positive results of atserias , dawar and grohe  @xcite mentioned previously , which show that the extension preservation property is recovered in a number of restricted classes of finite relational structures .    when the class @xmath4 in theorem  [ thm : sausage ] is relaxed to include all finite relational structures , our result coincides with a well known one due to atserias , which says that first - order definable constraint satisfaction problems are precisely those with finite tree duality ( or equivalently , those definable by existential positive sentences ) , see theorem @xmath5 of @xcite .",
    "it is also a consequence rossman s finite homomorphism preservation theorem , which holds for classes of relational structures admitting a homomorphism into one of _ any _ number of finite relational structures .",
    "our proof , however , is independent of both atserias and rossman and relies mostly on some constructions borrowed from larose , loten and tardif given in  @xcite .",
    "we remark that while it remains unclear if the homomorphism preservation property in its full generality holds in these classes , the restricted preservation property , nevertheless , covers many commonly encountered homomorphism - closed classes .",
    "this article is comprised of three main sections .",
    "we begin with some background and definitions that will be required for the remainder of the paper , we then investigate the status of relativised homomorphism preservation theorem  [ thm : relhompresthm ] at the finite level for both algebraic and relational signatures . in section  [ section : sectionalg ]",
    ", we give counterexamples to the finite - level version of relativised homomorphism preservation theorem  [ thm : relhompresthm ] for algebraic structures .",
    "moreover , we completely characterise those classes of finite lattices admitting a homomorphism into a fixed finite bounded lattice . in section  [ section :",
    "sectrelational ] , we establish a restricted form of the finite - level version of relativised homomorphism theorem  [ thm : relhompresthm ] for relational structures .",
    "the proof follows an ehrenfeucht - frass game argument on structures obtained by adjusting some constructions borrowed from larose , loten and tardif given in  @xcite .",
    "a _ signature _ ( or _ language _ or _ type _ ) is a pair @xmath6 consisting of a set of relation symbols @xmath7 and a set of function symbols @xmath8 .",
    "each relation and function symbol has an associated _ arity _ @xmath9 ; we do not allow for nullary relation symbols so @xmath9 is quantified over @xmath10 in this case ; we do however include the possibility of @xmath11-ary function symbols so @xmath9 is quantified over @xmath12 in this case .",
    "an @xmath13-_structure _ @xmath14 consists of a universe @xmath15 together with an interpretation of    * each @xmath9-ary relation symbol @xmath16 as a subset @xmath17 of @xmath18 , * each @xmath9-ary function symbol @xmath19 as a function @xmath20 .",
    "if @xmath21 , then @xmath22 is an _ algebra _ , if @xmath23 then @xmath22 is a _",
    "relational structure_.    let @xmath24 be a structure in some signature @xmath13 consisting of possibly both relation and function symbols .",
    "we let @xmath25 be the language obtained by adding a nullary function symbol @xmath26 to @xmath13 , for each @xmath27 .",
    "let @xmath28 , let @xmath29 be a purely relational signature , and let @xmath30 .",
    "weak substructure _ of @xmath31 is a structure @xmath32 , where @xmath33 and @xmath34 for each @xmath35 .",
    "the weak substructure @xmath36 is _ proper _ if either @xmath37 or @xmath38 and there exists @xmath39 such that @xmath40 .",
    "let @xmath13 be some signature consisting of possibly both relation and function symbols , and let @xmath41 be a class of @xmath13-structures .",
    "we define @xmath42 to be the class of all @xmath13-structures admitting a homomorphism into some member of the class  @xmath41 .",
    "let @xmath43 be a set and let @xmath44 be a set of structures in some signature @xmath13 .",
    "we say that @xmath45 is a _ homomorphism - independent _ set if for all @xmath46 with @xmath47 , there is no homomorphism from @xmath48 to @xmath49 .",
    "let @xmath50 and let @xmath51 be a finite set of finite structures in the purely relational signature @xmath52 .",
    "we denote the finite models in @xmath53 by @xmath54 .",
    "obstruction _ for the class @xmath55 is any finite @xmath7-structure not belonging to @xmath54 .",
    "an obstruction @xmath56 for the class @xmath55 is _ critical _ if every proper weak substructure of @xmath56 belongs to @xmath54 .",
    "we say that @xmath54 satisfies the _ finite duality property _ if there exists a finite set @xmath57 of finite structures with the following property : a finite @xmath7-structure @xmath58 belongs to the class @xmath54 if and only if @xmath58 avoids a homomorphism from every member of @xmath57 .",
    "let @xmath24 be a finite structure in the purely relational signature @xmath7 .",
    "the class of all finite @xmath7-structures admitting a homomorphism into @xmath24 is denoted @xmath59 .",
    "the membership problem for @xmath59 is known as the _ constraint satisfaction problem _ over template @xmath24 .",
    "note that @xmath60 .",
    "let @xmath61 , let @xmath24 be a finite relational structure in the purely relational signature @xmath52 with @xmath62 of arity @xmath63 , for all @xmath64 .",
    "the _ incidence multigraph _ of @xmath24 , denoted @xmath65 , is defined as the bipartite multigraph with parts @xmath15 and @xmath66 , where @xmath66 consists of all pairs @xmath67 such that @xmath68 and @xmath69 , and with edges @xmath70 joining @xmath27 to @xmath71 , when @xmath72 for some @xmath73 .",
    "let @xmath26 and @xmath74 be two elements in @xmath15 .",
    "then the _ distance between @xmath26 and @xmath74 in _",
    "@xmath75 is defined to be half the number of edges in a shortest path connecting them in @xmath65 .",
    "the _ girth _ of @xmath24 is defined to be half the shortest length of a cycle in @xmath65 .",
    "the _ diameter _ of @xmath24 is defined to be @xmath76 .",
    "let @xmath4 be a class of @xmath13-structures and let @xmath41 be a subclass of @xmath4 .",
    "we define the following class : @xmath77 in the case where @xmath4 is the class of all @xmath13-structures we abbreviate @xmath78 to @xmath79 . in general , @xmath80 .",
    "let @xmath81 , let @xmath82 , and let @xmath83 be a finite set of structures in @xmath4 .",
    "we follow gorbunov  @xcite and refer to the class @xmath84 as a _ principal colour - family in @xmath4 _ , and we refer to the class @xmath85 as a _ colour - family in _ @xmath4 .",
    "let @xmath86 and let @xmath61 .",
    "a sentence @xmath87 is called an _ anti - identity _ if it is of the form @xmath88,\\ ] ] where @xmath89 is an atomic formula for all @xmath90 .",
    "let @xmath91 be a set of first - order sentences in some signature @xmath92 .",
    "we let @xmath93 denote the class of all models of @xmath91 .    .",
    "a subclass @xmath94 of a class @xmath95 is called _ strictly elementary relative to _",
    "@xmath4 if there is a first - order sentence @xmath96 such that @xmath97 .    a subclass @xmath94 of a class @xmath95 is called an _ anti - variety relative to _",
    "@xmath4 if @xmath98 where @xmath99 is a set of anti - identities .",
    "the proof of the relativised homomorphism preservation theorem  [ thm : relhompresthm ] requires only standard applications of some model - theoretic fundamentals .",
    "we have included its proof , however , for completeness sake .",
    "we remark that the results of this paper are more easily formulated for classes that are complements of homomorphism closed classes .",
    "such classes are closed under taking homomorphic pre - images : classes @xmath41 satisfying @xmath100 whenever @xmath58 admits a homomorphism to @xmath24 and @xmath101 . for this reason",
    ", we work with the homomorphism preservation theorem in its complemented form .",
    "[ thm : relhompresthm ] let @xmath91 be a set of sentences in the signature @xmath13 , let @xmath102 , and let @xmath41 be a subclass of  @xmath4 . then the class @xmath103 is an anti - variety relative to @xmath4 .",
    "moreover , if @xmath103 is strictly elementary with respect to @xmath4 , then there is a sentence consisting of a finite conjunction anti - identities that is logically equivalent to @xmath104 modulo @xmath91 .",
    "we first show that @xmath103 is axiomatisable by a set of anti - identities with respect to the class @xmath4 .",
    "the second part of the theorem will follow by compactness .",
    "let @xmath105 and let @xmath106 be the set of anti - identities true in @xmath41 . clearly , if @xmath107 , then @xmath108 , since anti - identities are preserved under taking homomorphic pre - images .",
    "now let @xmath82 and suppose that @xmath108 .",
    "let @xmath109 be the set of atomic sentences true in @xmath24 in the expanded signature @xmath25 , and let @xmath110 be the class of all @xmath25-structures whose @xmath13-reduct belongs to @xmath111 .",
    "for any finite subset @xmath112 of @xmath109 , we have @xmath113 so , @xmath24 fails the sentence @xmath114.\\ ] ] hence there is some structure @xmath115 that fails @xmath116 .",
    "let @xmath117 be the elements of @xmath118 that witness the failure of the sentence @xmath116 .",
    "now expand @xmath58 in the signature @xmath25 under the following interpretation : let @xmath74 be any element of @xmath118 , and define @xmath119 , if @xmath120 , and @xmath121 , otherwise .",
    "then @xmath122 , and satisfies @xmath123 since @xmath4 is elementary and @xmath111 is first order definable relative to @xmath4 it follows , by compactness , that there is some @xmath124 such that @xmath125 .",
    "now let @xmath126 be the map that sends each element @xmath127 of @xmath24 to its corresponding interpretation in @xmath128 .",
    "then , for every atomic formula @xmath129 in @xmath13 and every @xmath9-tuple @xmath130 , we have @xmath131 thus , the map @xmath126 is a homomorphism from @xmath24 to @xmath132 . since @xmath133",
    ", there exists a homomorphism @xmath134 from @xmath132 to some member @xmath135 of @xmath136 , and so @xmath137 is a homomorphism from @xmath24 to @xmath135 , thus @xmath138 .",
    "hence we have shown that there is a set @xmath139 of anti - identities such that @xmath140 , namely @xmath141 .",
    "now assume there is a single first - order sentence @xmath96 such that @xmath142 . then every model of @xmath143 is also a model of @xmath144 . by the completeness theorem of first - order logic , we get that @xmath145 .",
    "it then follows , by compactness , that there is a finite ( possibly empty ) set of anti - identities @xmath146 such @xmath147 .",
    "thus , the sentence @xmath96 is logically equivalent to the conjunction of anti - identities @xmath148 modulo @xmath91 .",
    "we now show that the finite - level version of the relativised homomorphism preservation theorem  [ thm : relhompresthm ] fails for algebraic signatures .",
    "if we restrict the class @xmath4 to all finite bounded lattices , then we can find many classes closed under taking homomorphic pre - images that are first - order definable relative to @xmath4 , but not definable by universal sentences .",
    "[ thm : algfail ] let @xmath4 be the class of finite bounded lattices in the signature @xmath149 and let @xmath3 be any lattice in @xmath4 with @xmath150 .",
    "the class @xmath151 of all finite bounded lattices admitting a homomorphism into @xmath3 is strictly first - order definable relative to @xmath4 but not definable by any universal sentence .",
    "the class @xmath151 of all finite bounded lattices admitting a homomorphism into @xmath3 is definable by a @xmath152 sentence @xmath96 by ( * ? ? ?",
    "* theorem  4.2 ) .",
    "we will show that the class @xmath151 is not definable by any universal sentence .",
    "specifically , we show that , for each @xmath153 , there exists a finite bounded lattice @xmath154 satisfying the following two conditions .",
    "1 .   @xmath155 ; 2 .",
    "every @xmath9-generated sublattice of @xmath154 belongs to @xmath151 .    for each @xmath153 ,",
    "let @xmath154 be the lattice depicted in figure  [ figure : a_n ] .",
    "the lattice @xmath154 is a `` stack '' of @xmath9 copies of @xmath156 , where @xmath2 is a natural number strictly greater than @xmath157 .",
    "( @xmath158 ) : let @xmath153 . the smallest lattice that @xmath154 collapses to , without identifying @xmath11 and @xmath158 , is isomorphic to the lattice @xmath156 . since @xmath156 is simple ( as @xmath159 ) , every congruence on @xmath156 collapses everything or collapses nothing .",
    "thus if @xmath154 is to map homomorphically into @xmath3 , then @xmath3 must contain a sublattice isomorphic to @xmath156 , but this is not possible since @xmath156 contains more elements than @xmath3 . hence @xmath160 .",
    "( @xmath161 ) : we will show that every @xmath9-generated sublattice of @xmath154 has a homomorphism onto the two - element lattice @xmath162 , and therefore has a homomorphism into @xmath3 .",
    "assume that we are selecting @xmath9 generators from the lattice @xmath163 . in order to generate a sublattice of @xmath154 that does not admit a homomorphism onto @xmath162 ( or equivalently , a sublattice that does not contain a prime ideal ) , we would need to select _ at least _",
    "three elements from each of the @xmath9 maximal anti - chains in @xmath154 .",
    "thus , the lattice @xmath164 given in figure  [ figure : p ] is the smallest sublattice of @xmath154 that does not admit a homomorphism onto @xmath162 .",
    "but this lattice is @xmath165-generated and not generated by fewer than @xmath165 elements .",
    "hence every @xmath9-generated a sublattice of @xmath154 admits a homomorphism onto @xmath162 , and therefore into @xmath3 .",
    "notice that within the class of finite bounded lattices , the ( first - order definable ) property of admitting a homomorphism onto @xmath166 is preserved by taking sublattices , and so the above examples also give us a counterexample to the finite - level relativised os - tarski preservation theorem for algebraic signatures .    also notice that the proof of theorem  [ thm : algfail ] works for the class @xmath167 , where @xmath168 is any class of finite bounded lattices containing at least one non - trivial lattice , and for which there exists @xmath159 such that @xmath169 .",
    "the proof of theorem [ thm : algfail ] also works with @xmath4 replaced by any class of finite lattices containing the lattices in figure [ figure : a_n ] ( for each @xmath170 ) . as the lattice",
    "@xmath154 is modular , the class @xmath4 in theorem  [ thm : algfail ] could be taken to be the class of all finite bounded modular lattices .",
    "alternatively , @xmath4 could to be the finite part of the variety generated by the bounded lattices @xmath154 .",
    "this variety can be shown to coincide with the variety generated by @xmath171 .",
    "[ unshaded/.style = draw , shape = circle , fill = white , inner sep=1.5pt , order/.style = very thin ]    label at ( 0,0 ) ; ( bot ) at ( 0,0 ) ; ( 2 ) at ( -2,1 ) ; ( 8) at ( -4,1 ) ; at ( 2.8,1 ) @xmath172 ; at ( -2.8,1 ) @xmath172 ; ( 3 ) at ( 2,1 ) ; ( 9 ) at ( 4,1 ) ; ( 5 ) at ( -1,1 ) ; ( 6 ) at ( 0,1 ) ; ( 7 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( half1 ) at ( -1.9,1.35 ) ; ( half2 ) at ( 1.9,1.35 ) ; ( half3 ) at ( -1.9,.65 ) ; ( half4 ) at ( 1.9,.65 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( bot ) to ( 5 ) ; ( bot ) to ( 6 ) ; ( bot ) to ( 7 ) ; ( bot ) to ( 8) ; ( bot ) to ( 9 ) ; ( bot ) to ( half3 ) ; ( bot ) to ( half4 ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ; ( 5 ) to ( top ) ; ( 6 ) to ( top ) ; ( 7 ) to ( top ) ; ( 8) to ( top ) ; ( 9 ) to ( top ) ; ( half1 ) to ( top ) ; ( half2 ) to ( top ) ;    ( bot ) at ( 0,0 ) ; ( 2 ) at ( -2,1 ) ; ( 8) at ( -4,1 ) ; at ( 2.8,1 ) @xmath172 ; at ( -2.8,1 ) @xmath172 ; ( 3 ) at ( 2,1 ) ; ( 9 ) at ( 4,1 ) ; ( 5 ) at ( -1,1 ) ; ( 6 ) at ( 0,1 ) ; ( 7 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( half1 ) at ( -1.9,1.35 ) ; ( half2 ) at ( 1.9,1.35 ) ; ( half3 ) at ( -1.9,.65 ) ; ( half4 ) at ( 1.9,.65 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( bot ) to ( 5 ) ; ( bot ) to ( 6 ) ; ( bot ) to ( 7 ) ; ( bot ) to ( 8) ; ( bot ) to ( 9 ) ; ( bot ) to ( half3 ) ; ( bot ) to ( half4 ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ; ( 5 ) to ( top ) ; ( 6 ) to ( top ) ; ( 7 ) to ( top ) ; ( 8) to ( top ) ; ( 9 ) to ( top ) ; ( half1 ) to ( top ) ; ( half2 ) to ( top ) ;    at ( 0,5 ) @xmath173 ;    ( bot ) at ( 0,0 ) ; ( 2 ) at ( -2,1 ) ; ( 8) at ( -4,1 ) ; at ( 2.8,1 ) @xmath172 ; at ( -2.8,1 ) @xmath172 ; ( 3 ) at ( 2,1 ) ; ( 9 ) at ( 4,1 ) ; ( 5 ) at ( -1,1 ) ; ( 6 ) at ( 0,1 ) ; ( 7 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( half1 ) at ( -1.9,1.35 ) ; ( half2 ) at ( 1.9,1.35 ) ; ( half3 ) at ( -1.9,.65 ) ; ( half4 ) at ( 1.9,.65 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( bot ) to ( 5 ) ; ( bot ) to ( 6 ) ; ( bot ) to ( 7 ) ; ( bot ) to ( 8) ; ( bot ) to ( 9 ) ; ( bot ) to ( half3 ) ; ( bot ) to ( half4 ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ; ( 5 ) to ( top ) ; ( 6 ) to ( top ) ; ( 7 ) to ( top ) ; ( 8) to ( top ) ; ( 9 ) to ( top ) ; ( half1 ) to ( top ) ; ( half2 ) to ( top ) ;    ( 0,7.8)(0,0 ) node[midway , right , xshift=10pt ]  * n copies * ;    [ unshaded/.style = draw , shape = circle , fill = white , inner sep=1.5pt , order/.style = very thin ]    ( bot ) at ( 0,0 ) ; ( 1 ) at ( -1,1 ) ; ( 2 ) at ( 0,1 ) ; ( 3 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( bot ) to ( 1 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( 1 ) to ( top ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ;    ( bot ) at ( 0,0 ) ; ( 1 ) at ( -1,1 ) ; ( 2 ) at ( 0,1 ) ; ( 3 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( bot ) to ( 1 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( 1 ) to ( top ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ;    at ( 0,5 ) @xmath173 ;    ( bot ) at ( 0,0 ) ; ( 1 ) at ( -1,1 ) ; ( 2 ) at ( 0,1 ) ; ( 3 ) at ( 1,1 ) ; ( top ) at ( 0,2 ) ; ( bot ) to ( 1 ) ; ( bot ) to ( 2 ) ; ( bot ) to ( 3 ) ; ( 1 ) to ( top ) ; ( 2 ) to ( top ) ; ( 3 ) to ( top ) ;    ( 0,7.8)(0,0 ) node[midway , right , xshift=10pt ]  * n copies * ;",
    "we now turn to the purely relational side of things . in this section ,",
    "we establish a finite - level version of the relativised homomorphism preservation theorem for relational signatures .",
    "we present this result as theorem  [ thm : sausage ] below .",
    "we first prove the non - relativised version of theorem  [ thm : sausage ] , namely theorem  [ thm : atserias ] , from which theorem  [ thm : sausage ] will follow almost immediately .",
    "the proof requires three constructions given in definition  [ defn : nlink ] , definition  [ defn : unpinch ] and definition  [ defn : npinch ] below , borrowed from @xcite .",
    "the quotient structure given in definition  [ defn : npinch ] , will play a key role in establishing theorem  [ thm : sausage ] .",
    "we follow jackson and trotta  @xcite and refer to this quotient structure as the _ @xmath9-pinch _ over @xmath24 . in @xcite ,",
    "larose , loten and tardif show that , for a relational structure @xmath24 , demonstrating membership of the @xmath9-pinch in @xmath59 , for some natural number @xmath9 , is equivalent to @xmath59 admitting the finite duality property .",
    "this fact will be crucial in the proof of theorem  [ thm : sausage ] .",
    "we conclude the section by extending theorem  [ thm : sausage ] .",
    "more specifically , we obtain a complete characterisation of not only first - order definable principal colour - families but also first - order definable colour - families in classes @xmath4 closed under forming the @xmath9-pinch construction and taking disjoint unions ; see theorem  [ thm : colourfam ] .",
    "[ defn : unpinch ] let @xmath153 and let @xmath24 be a structure in the signature @xmath52 . consider the product structure @xmath179 .",
    "we define an equivalence relation @xmath180 on @xmath179 as follows : @xmath181          observe that the first coordinate of the elements in @xmath179 is constant on each of the @xmath183-equivalence classes .",
    "in other words , the first coordinate is unchanged by the formation of the quotient structure @xmath184 .",
    "we therefore use the first coordinate as a means for specifying the position of an element in a copy of @xmath24 or @xmath185 in the @xmath9-pinch : notationally , we define a function @xmath186 by @xmath187 .",
    "we refer to the copy of @xmath24 in @xmath184 at position @xmath188 as the _ left pinch _ of @xmath184 , and we refer to the copy of @xmath24 at position @xmath189 as the _ right pinch _ of @xmath184 .",
    "we denote the substructures of @xmath184 induced by the sets @xmath190 and @xmath191 as @xmath192 and @xmath193 , respectively .",
    "we refer to the copy of @xmath185 in @xmath192 at position @xmath194 as the _ right slice _ of @xmath192 , and we refer to the copy of @xmath185 in @xmath193 at position @xmath195 as the _ left slice _ of @xmath193 .            1 .",
    "( @xcite , lemma  @xmath199 ) for each natural number @xmath9 , the substructures @xmath192 and @xmath193 of @xmath184 admit homomorphisms into @xmath24.[itm : part1 ] 2 .",
    "( @xcite theorem  @xmath200 and theorem  @xmath201)[itm : pinchequiv ] the following are equivalent : * @xmath59 satisfies the finite duality property ; * there exists some natural number @xmath9 such that @xmath184 admits a homomorphism to @xmath24 .",
    "[ itm : pinchsurjhom](@xcite lemma  @xmath202 ) for each @xmath153 , there exists a surjective homomorphism from @xmath203 to @xmath204 .    for ( @xmath158 )",
    ", it is routine to check that the map @xmath205 defined by @xmath206 is a homomorphism from @xmath192 to @xmath24 and similarly , that the map @xmath207 defined by @xmath208 is a homomorphism from @xmath192 to @xmath24 , see the proof of lemma  @xmath199 in @xcite .",
    "the proof of ( @xmath161 ) depends mostly on the observation that there are only finitely many critical obstructions of a given diameter ( see lemma  @xmath209 of @xcite . for ( @xmath210 ) , the map defined by @xmath211 is easily shown to be a surjective homomorphism , see the proof of lemma  @xmath202 in @xcite .",
    "let @xmath4 be a class of @xmath7-structures and let @xmath55 be a subclass of @xmath4 .",
    "we say that @xmath4 is _ closed under forming the @xmath9-pinch construction over @xmath55 _ , if for every @xmath28 and every @xmath212 , we have that @xmath213 and its substructures @xmath192 and @xmath193 belong to the class @xmath4 .",
    "[ thm : sausage ] let @xmath4 be a class of finite @xmath214-structures and let @xmath82 .",
    "if @xmath4 is closed under forming the @xmath9-pinch construction over @xmath24 and taking disjoint unions , then @xmath215 is equal to @xmath216 for some first order sentence @xmath96 if and only if there is a finite conjunction of anti - identities @xmath87 such that @xmath217 .",
    "we now prove ( @xmath210 ) @xmath218 ( @xmath158 ) by establishing the contrapositive .",
    "we show that for a finite relational structure @xmath24 , if the class @xmath59 fails the finite duality property , then the property of admitting a homomorphism to @xmath24 is not expressible by a first - order sentence .",
    "the proof follows an ehrenfeucht - frass game arguement ; we show that , for each non - negative integer @xmath2 , there are two structures @xmath219 and @xmath220 such that :      if @xmath59 does not satisfy the finite duality property , then theorem  [ thm : sausagefacts ] tells us that for each natural number @xmath9 , there exists no homomorphism from @xmath184 to  @xmath24 , but the substructures @xmath192 and @xmath193 of @xmath184 admit homomorphisms to @xmath24 .",
    "this suggests that we construct our structures @xmath219 and @xmath220 using combinations of @xmath184 and its substructures @xmath192 and @xmath193 , where @xmath9 is some number defined in terms of @xmath2 .",
    "let @xmath2 be a non - negative integer and assume that @xmath221 is an integer strictly greater than @xmath222 .",
    "now consider @xmath223 and the disjoint union @xmath224 .",
    "we build @xmath219 and @xmath220 in the following way .",
    "let @xmath220 be the structure obtained by taking the disjoint union of @xmath225 copies of @xmath224 , and let @xmath219 be @xmath226 .",
    "see figure  [ figure : sausies ] for an abstract depiction of the structures @xmath219 and @xmath220 .",
    "node[coordinate , label = below:@xmath15 ] ( v16 ) at ( -2,0.5 ) node[coordinate ] ( v17 ) at ( -3,3.5 ) ; ( v16)(v17 ) ; node[coordinate , label = below:@xmath228 ( v0 ) at ( 0,0 ) node[coordinate ] ( v1 ) at ( 1,3 ) node[coordinate ] ( v2 ) at ( 0,6 ) node[coordinate ] ( v3 ) at ( -1,3 ) ; ( v0)(v1)(v2)(v3)(v0 ) ; node[coordinate ] ( v4 ) at ( 1,0.5 ) node[coordinate ] ( v5 ) at ( 2,3.5 ) node[coordinate ] ( v6 ) at ( 1,6.5 ) node[coordinate ] ( v7 ) at ( 0,3.5 ) ; ( v4)(v5)(v6)(v7)(v4 ) ; node[coordinate ] ( v8 ) at ( 4,2 ) node[coordinate ] ( v9 ) at ( 5,5 ) node[coordinate ] ( v10 ) at ( 4,8 ) node[coordinate ] ( v11 ) at ( 3,5 ) ; ( v8)(v9)(v10)(v11)(v8 ) ; node[coordinate , label = below:@xmath228 ( v12 ) at ( 5,2.5 ) node[coordinate ] ( v13 ) at ( 6,5.5 ) node[coordinate ] ( v14 ) at ( 5,8.5 ) node[coordinate ] ( v15 ) at ( 4,5.5 ) ; ( v12)(v13)(v14)(v15)(v12 ) ; node[coordinate , label = below:@xmath15 ] ( v18 ) at ( 7,4.5 ) node[coordinate ] ( v19 ) at ( 8,7.5 ) ; ( v18)(v19 ) ; ( v17)(v2)(v6)(v10)(v14)(v19 ) ; ( v17)(v3)(v7)(v11)(v15)(v18 ) ; ( v16)(v0)(v4)(v8)(v12)(v18 ) ; ( v16)(v1)(v5)(v9)(v13)(v19 ) ;    node[coordinate ] ( v16 ) at ( -2,0.5 ) node[coordinate ] ( v17 ) at ( -3,3.5 ) ; ( v16)(v17 ) ; node[coordinate ] ( v0 ) at ( 0,0 ) node[coordinate ] ( v1 ) at ( 1,3 ) node[coordinate ] ( v2 ) at ( 0,6 ) node[coordinate ] ( v3 ) at ( -1,3 ) ; ( v0)(v1)(v2)(v3)(v0 ) ; node[coordinate ] ( v4 ) at ( 0.6,0.3 ) node[coordinate ] ( v5 ) at ( 1.6,3.3 ) node[coordinate ] ( v6 ) at ( 0.6,6.3 ) node[coordinate ] ( v7 ) at ( -0.4,3.3 ) ; ( v4)(v5)(v6)(v7)(v4 ) ; node[coordinate ] ( v8 ) at ( 4.4,2.2 ) node[coordinate ] ( v9 ) at ( 5.4,5.2 ) node[coordinate ] ( v10 ) at ( 4.4,8.2 ) node[coordinate ] ( v11 ) at ( 3.4,5.2 ) ; ( v8)(v9)(v10)(v11)(v8 ) ; node[coordinate ] ( v12 ) at ( 5,2.5 ) node[coordinate ] ( v13 ) at ( 6,5.5 ) node[coordinate ] ( v14 ) at ( 5,8.5 ) node[coordinate ] ( v15 ) at ( 4,5.5 ) ; ( v12)(v13)(v14)(v15)(v12 ) ; node[coordinate ] ( v20 ) at ( 3.4,1.7 ) node[coordinate ] ( v21 ) at ( 4.4,4.7 ) node[coordinate ] ( v22 ) at ( 3.4,7.7 ) node[coordinate ] ( v23 ) at ( 2.4,4.7 ) ; ( v20)(v21)(v22)(v23)(v20 ) ; node[coordinate ] ( v24 ) at ( 1.6,0.8 ) node[coordinate ] ( v25 ) at ( 2.6,3.8 ) node[coordinate ] ( v26 ) at ( 1.6,6.8 ) node[coordinate ] ( v27 ) at ( 0.6,3.8 ) ; ( v24)(v25)(v26)(v27)(v24 ) ; node[coordinate ] ( v18 ) at ( 7,4.5 ) node[coordinate ] ( v19 ) at ( 8,7.5 ) ; ( v18)(v19 ) ; ( v17)(v2)(v6)(v26 ) ; ( v22)(v10)(v14)(v19 ) ; ( v17)(v3)(v7)(v27 ) ; ( v23)(v11)(v15)(v18 ) ; ( v16)(v0)(v4)(v24 ) ; ( v20)(v8)(v12)(v18 ) ; ( v16)(v1)(v5)(v25 ) ; ( v21)(v9)(v13)(v19 ) ;    node[coordinate ] ( v16 ) at ( -2,0.5 ) node[coordinate ] ( v17 ) at ( -3,3.5 ) ; ( v16)(v17 ) ; node[coordinate ] ( v0 ) at ( 0,0 ) node[coordinate ] ( v1 ) at ( 1,3 ) node[coordinate ] ( v2 ) at ( 0,6 ) node[coordinate ] ( v3 ) at ( -1,3 ) ; ( v0)(v1)(v2)(v3)(v0 ) ; node[coordinate ] ( v4 ) at ( 0.6,0.3 ) node[coordinate ] ( v5 ) at ( 1.6,3.3 ) node[coordinate ] ( v6 ) at ( 0.6,6.3 ) node[coordinate ] ( v7 ) at ( -0.4,3.3 ) ; ( v4)(v5)(v6)(v7)(v4 ) ; node[coordinate ] ( v8 ) at ( 4.4,2.2 ) node[coordinate ] ( v9 ) at ( 5.4,5.2 ) node[coordinate ] ( v10 ) at ( 4.4,8.2 ) node[coordinate ] ( v11 ) at ( 3.4,5.2 ) ; ( v8)(v9)(v10)(v11)(v8 ) ; node[coordinate ] ( v12 ) at ( 5,2.5 ) node[coordinate ] ( v13 ) at ( 6,5.5 ) node[coordinate ] ( v14 ) at ( 5,8.5 ) node[coordinate ] ( v15 ) at ( 4,5.5 ) ; ( v12)(v13)(v14)(v15)(v12 ) ; node[coordinate ] ( v20 ) at ( 3.4,1.7 ) node[coordinate ] ( v21 ) at ( 4.4,4.7 ) node[coordinate ] ( v22 ) at ( 3.4,7.7 ) node[coordinate ] ( v23 ) at ( 2.4,4.7 ) ; ( v20)(v21)(v22)(v23)(v20 ) ; node[coordinate ] ( v24 ) at ( 1.6,0.8 ) node[coordinate ] ( v25 ) at ( 2.6,3.8 ) node[coordinate ] ( v26 ) at ( 1.6,6.8 ) node[coordinate ] ( v27 ) at ( 0.6,3.8 ) ; ( v24)(v25)(v26)(v27)(v24 ) ; node[coordinate ] ( v18 ) at ( 7,4.5 ) node[coordinate ] ( v19 ) at ( 8,7.5 ) ; ( v18)(v19 ) ; ( v17)(v2)(v6)(v26 ) ; ( v22)(v10)(v14)(v19 ) ; ( v17)(v3)(v7)(v27 ) ; ( v23)(v11)(v15)(v18 ) ; ( v16)(v0)(v4)(v24 ) ; ( v20)(v8)(v12)(v18 ) ; ( v16)(v1)(v5)(v25 ) ; ( v21)(v9)(v13)(v19 ) ;      node[coordinate ] ( v16 ) at ( -2,0.5 ) node[coordinate ] ( v17 ) at ( -3,3.5 ) ; ( v16)(v17 ) ; node[coordinate ] ( v0 ) at ( 0,0 ) node[coordinate ] ( v1 ) at ( 1,3 ) node[coordinate ] ( v2 ) at ( 0,6 ) node[coordinate ] ( v3 ) at ( -1,3 ) ; ( v0)(v1)(v2)(v3)(v0 ) ; node[coordinate ] ( v4 ) at ( 0.6,0.3 ) node[coordinate ] ( v5 ) at ( 1.6,3.3 ) node[coordinate ] ( v6 ) at ( 0.6,6.3 ) node[coordinate ] ( v7 ) at ( -0.4,3.3 ) ; ( v4)(v5)(v6)(v7)(v4 ) ; node[coordinate ] ( v8 ) at ( 4.4,2.2 ) node[coordinate ] ( v9 ) at ( 5.4,5.2 ) node[coordinate ] ( v10 ) at ( 4.4,8.2 ) node[coordinate ] ( v11 ) at ( 3.4,5.2 ) ; ( v8)(v9)(v10)(v11)(v8 ) ; node[coordinate ] ( v12 ) at ( 5,2.5 ) node[coordinate ] ( v13 ) at ( 6,5.5 ) node[coordinate ] ( v14 ) at ( 5,8.5 ) node[coordinate ] ( v15 ) at ( 4,5.5 ) ; ( v12)(v13)(v14)(v15)(v12 ) ; node[coordinate ] ( v20 ) at ( 3.4,1.7 ) node[coordinate ] ( v21 ) at ( 4.4,4.7 ) node[coordinate ] ( v22 ) at ( 3.4,7.7 ) node[coordinate ] ( v23 ) at ( 2.4,4.7 ) ; ( v20)(v21)(v22)(v23)(v20 ) ; node[coordinate ] ( v24 ) at ( 1.6,0.8 ) node[coordinate ] ( v25 ) at ( 2.6,3.8 ) node[coordinate ] ( v26 ) at ( 1.6,6.8 ) node[coordinate ] ( v27 ) at ( 0.6,3.8 ) ; ( v24)(v25)(v26)(v27)(v24 ) ; node[coordinate ] ( v18 ) at ( 7,4.5 ) node[coordinate ] ( v19 ) at ( 8,7.5 ) ; ( v18)(v19 ) ; ( v17)(v2)(v6)(v26 ) ; ( v22)(v10)(v14)(v19 ) ; ( v17)(v3)(v7)(v27 ) ; ( v23)(v11)(v15)(v18 ) ; ( v16)(v0)(v4)(v24 ) ; ( v20)(v8)(v12)(v18 ) ; ( v16)(v1)(v5)(v25 ) ; ( v21)(v9)(v13)(v19 ) ;      node[coordinate ] ( v16 ) at ( -2,0.5 ) node[coordinate ] ( v17 ) at ( -3,3.5 ) ; ( v16)(v17 ) ; node[coordinate ] ( v0 ) at ( 0,0 ) node[coordinate ] ( v1 ) at ( 1,3 ) node[coordinate ] ( v2 ) at ( 0,6 ) node[coordinate ] ( v3 ) at ( -1,3 ) ; ( v0)(v1)(v2)(v3)(v0 ) ; node[coordinate ] ( v4 ) at ( 0.6,0.3 ) node[coordinate ] ( v5 ) at ( 1.6,3.3 ) node[coordinate ] ( v6 ) at ( 0.6,6.3 ) node[coordinate ] ( v7 ) at ( -0.4,3.3 ) ; ( v4)(v5)(v6)(v7)(v4 ) ; node[coordinate ] ( v8 ) at ( 4.4,2.2 ) node[coordinate ] ( v9 ) at ( 5.4,5.2 ) node[coordinate ] ( v10 ) at ( 4.4,8.2 ) node[coordinate ] ( v11 ) at ( 3.4,5.2 ) ; ( v8)(v9)(v10)(v11)(v8 ) ; node[coordinate ] ( v12 ) at ( 5,2.5 ) node[coordinate ] ( v13 ) at ( 6,5.5 ) node[coordinate ] ( v14 ) at ( 5,8.5 ) node[coordinate ] ( v15 ) at ( 4,5.5 ) ; ( v12)(v13)(v14)(v15)(v12 ) ; node[coordinate ] ( v20 ) at ( 3.4,1.7 ) node[coordinate ] ( v21 ) at ( 4.4,4.7 ) node[coordinate ] ( v22 ) at ( 3.4,7.7 ) node[coordinate ] ( v23 ) at ( 2.4,4.7 ) ; ( v20)(v21)(v22)(v23)(v20 ) ; node[coordinate ] ( v24 ) at ( 1.6,0.8 ) node[coordinate ] ( v25 ) at ( 2.6,3.8 ) node[coordinate ] ( v26 ) at ( 1.6,6.8 ) node[coordinate ] ( v27 ) at ( 0.6,3.8 ) ; ( v24)(v25)(v26)(v27)(v24 ) ; node[coordinate ] ( v18 ) at ( 7,4.5 ) node[coordinate ] ( v19 ) at ( 8,7.5 ) ; ( v18)(v19 ) ; ( v17)(v2)(v6)(v26 ) ; ( v22)(v10)(v14)(v19 ) ; ( v17)(v3)(v7)(v27 ) ; ( v23)(v11)(v15)(v18 ) ; ( v16)(v0)(v4)(v24 ) ; ( v20)(v8)(v12)(v18 ) ; ( v16)(v1)(v5)(v25 ) ; ( v21)(v9)(v13)(v19 ) ;          we begin by defining a notion of what it means for two elements in @xmath219 or @xmath220 to be  close to \" or  far away \" from each other ; but first we need to give a concrete definition of distance between two elements in @xmath219 or @xmath220",
    ". we will refer to a copy of @xmath223 or @xmath230 or @xmath231 in @xmath219 or @xmath220 as a _ block - component_. every element @xmath232 in @xmath219 or @xmath220 is a copy of one of the form @xmath233 , thus we may unambiguously extend the function @xmath234 to both @xmath219 and @xmath220 .",
    "now define the distance between two elements within @xmath219 by @xmath235 with @xmath236 defined identically on @xmath220 .",
    "the subscripts @xmath219 or @xmath220 are dropped when no ambiguity arises .",
    "note that these `` distances '' are not metrics in the strict sense , as distinct points may have distance @xmath11 ( if they lie in the same block component and have the same @xmath237 value ) .    at each round @xmath238",
    ", we will say that the distance between two elements @xmath232 and @xmath239 in @xmath219 or @xmath220 is @xmath240 if it at least @xmath241 .",
    "note that this also includes the case where the distance between @xmath232 and @xmath239 is infinite .",
    "assume that spoiler and duplicator have played @xmath242 rounds of the @xmath2 round game and have selected some elements @xmath243 and @xmath244 .",
    "let @xmath245 .",
    "if the distance between @xmath232 and @xmath239 is greater than or equal to @xmath246 and there are no previously played elements between them , then @xmath247 is large enough so that spoiler can not connect @xmath232 and @xmath239 . more precisely : at each round of play , spoiler may halve the distance between @xmath232 and @xmath239 ; the value of @xmath240 is chosen such that all further plays ( to the @xmath248 round ) will result in a gap of distance at least @xmath249 somewhere `` between '' @xmath232 and @xmath239 .",
    "see libkin @xcite for very similar arguments .",
    "the  board \" on which spoiler and duplicator will play the @xmath2-round ehrenfeucht - frass game essentially consists of lots of copies of @xmath24 and @xmath250 ( some of which are connected to one another ) .",
    "of course , the orientation of @xmath250 is interchangeable , because @xmath250 admits a natural automorphism given by @xmath251 .",
    "however it is convenient for our discussion to fix the ordering on these coordinates , so that we make think of  pinching \" the second coordinate on the left side and the first coordinate on the right side . in the same way",
    ", @xmath230 is in fact isomorphic to @xmath231 , but it is convenient for us to visualize them with their pinches in dual orientation .    we can use the following assumption to shed some light on duplicator s strategy to win the @xmath2-round game . we can assume that spoiler s first move in the @xmath2-round ehrenfeucht - frass game will be in @xmath223 in @xmath219 , since @xmath252 is isomorphic to @xmath220 and so a first move made by spoiler outside of @xmath253 is a wasted one .",
    "assume that spoiler chooses an element @xmath254 that is distance @xmath255 strictly less than @xmath256 to the left pinch in @xmath253 ( the case for the right pinch is symmetric ) . since @xmath255 is small enough so that , after round @xmath2 , it is possible for spoiler to `` connect '' two elements and because the orientations at the left and right pinches differ , duplicator must choose an element @xmath257 from @xmath220 that is a copy of the element @xmath254 and in the exact corresponding position , that is , exactly distance @xmath255 from a left pinch .",
    "now assume that spoiler chooses an element @xmath254 that is @xmath256 from both the left and right pinch in @xmath253 .",
    "again , duplicator is forced to choose an element from a copy of @xmath192 or @xmath193 in @xmath220 and she must select an element @xmath257 that is also distance @xmath256 from any right or left pinch in @xmath220 . she can achieve this by selecting an exact corresponding element to @xmath254 that is somewhere around the middle of a copy of @xmath192 or @xmath193 ( her choice of @xmath192 or @xmath193 does not matter since they both have diameter greater than or equal to @xmath240 ) .      1 .   if @xmath260 , then @xmath261 ; 2 .   if @xmath262 , then @xmath263 ; 3 .",
    "if @xmath264 is of distance @xmath265 from a left pinch , then @xmath266 is of distance @xmath255 from left pinch ; 4 .",
    "if @xmath264 is of distance @xmath265 from a right pinch , then @xmath266 is of distance @xmath255 from right pinch ; 5 .",
    "if @xmath264 is of distance @xmath265 from a left slice , then @xmath266 is of distance @xmath255 from a left slice ; 6 .",
    "if @xmath264 is of distance @xmath265 from a right slice , then @xmath266 is of distance @xmath255 from a right slice ; 7 .",
    "the dual conditions to the above ( in other words , switching the roles of @xmath134 and @xmath267 ) .",
    "the base case holds vacuously . for the induction step ,",
    "suppose that duplicator has survived @xmath268 rounds of the game by maintaining the above conditions to the completion of round @xmath268 .",
    "assume that spoiler is making his @xmath269st move in @xmath219 ( the case for @xmath220 is symmetric ) . if spoiler s selection for @xmath270 is equal to some previously played element @xmath271 , where @xmath272 , then duplicator s response should be @xmath273 .",
    "case @xmath158 : spoiler chooses @xmath270 so that it has distance greater than or equal to @xmath274 from any other previously played element in @xmath219 . + case @xmath158(a ) : spoiler chooses @xmath270 to be distance greater than or equal to @xmath274 from any pinch or slice in @xmath219 .",
    "duplicator must select @xmath275 so that it is also distance greater than or equal to @xmath274 from any other previously played element and from any pinch or slice in @xmath220 .",
    "duplicator can always find a copy of @xmath230 or @xmath231 in @xmath220 that contains no previously played points : after round @xmath268 there are at least @xmath276 unplayed copies ( each of length @xmath277 ) remaining in @xmath220 .",
    "if duplicator selects @xmath275 to be as close as possible to the middle of one of these intervals , then we ensure that the @xmath278 property and all other conditions of the hypothesis are carried through to the ( @xmath279)st round .",
    "case @xmath158(b ) : spoiler chooses @xmath270 so that it is distance @xmath280 from a pinch or slice in @xmath219 . without loss of generality ,",
    "suppose spoiler chooses @xmath270 so that it is distance @xmath280 from a left pinch in @xmath219 .",
    "duplicator must select an element @xmath275 in @xmath220 that is exactly distance @xmath255 from a left pinch in @xmath220 and such that @xmath275 is distance greater than or equal to @xmath274 from any other previously played element .",
    "duplicator can always find a copy of @xmath231 in @xmath220 that contains no previously played elements : after round @xmath268 there are at least @xmath281 copies remaining in @xmath220 . now",
    "duplicator should select an element @xmath275 in one of these copies corresponding to the element that spoiler chose in his copy of @xmath231 ( or @xmath253 ) relative to the natural embedding of @xmath231 into @xmath253 , and so that it has distance exactly @xmath280 from the left pinch .",
    "then all the conditions of hypothesis are preserved to the ( @xmath282)st round in this case .",
    "case @xmath161(a ) : spoiler chooses @xmath270 to be distance greater than or equal to @xmath274 from any pinch or slice in @xmath219 . without loss of generality assume that spoiler has selected @xmath270 to be to the right of @xmath271 .",
    "there are two sub - cases to consider , however duplicator s strategy is the same in each case : she should select @xmath275 in @xmath220 to be an exact copy of the element @xmath270 , and exactly distance @xmath283 to the right of @xmath273 .",
    "we only need to check that conditions @xmath284 and @xmath285 are maintained in this case .",
    "+ case @xmath161(a)(i ) : if there exists a previously selected element @xmath264 to the right of @xmath270 that is distance strictly less than @xmath274 , then @xmath260 , and so condition ( @xmath161 ) hypothesis tells us that @xmath261",
    ". hence duplicator s selection of @xmath275 at exactly distance @xmath283 to the right of @xmath273 ensures that @xmath286 and @xmath287 .",
    "hence all conditions of the hypothesis are maintained in this case .",
    "+ case @xmath161(a)(ii ) : if the distance of any other previously played element to the right of @xmath270 is greater than or equal @xmath274 .",
    "then , at round @xmath268 , the distance of any previously played element to the right of @xmath271 was greater than or equal to @xmath241 , so condition ( @xmath158 ) of the hypothesis tells us that the distance of any previously played element to the right of @xmath273 in @xmath220 is @xmath241 .",
    "hence duplicator s selection of @xmath275 at exactly distance @xmath283 to the right of @xmath273 ensures that @xmath286 and the distance of any other previously played element to the right of @xmath270 is greater than or equal @xmath274 .",
    "hence all conditions of the hypothesis are maintained in this case .",
    "+ case @xmath161(b ) spoiler chooses @xmath270 to be distance strictly less than @xmath274 from any pinch or slice in @xmath219 .",
    "without loss of generality assume that spoiler chooses @xmath270 to be distance strictly less than @xmath274 from a left pinch .",
    "+ case @xmath161 ( b)(i ) : if spoiler chooses @xmath270 to be to the right of @xmath271 at distance @xmath288 , then at round @xmath268 , the distance @xmath289 between @xmath271 and the left pinch must have been strictly less than @xmath241 .",
    "so condition ( @xmath210 ) of the hypothesis ensures that @xmath273 is also distance @xmath289 from a left pinch .",
    "if duplicator selects @xmath275 to be distance @xmath288 to the right of @xmath273 , then @xmath275 is exactly the same distance ( @xmath290 ) as @xmath270 from a left pinch , so condition ( @xmath210 ) of the hypothesis is maintained to this round .",
    "it remains to check conditions ( @xmath158 ) and ( @xmath161 ) : applying the arguments given in case @xmath161(a)(i ) and case @xmath161(a)(ii ) , respectively guarantees that all the conditions of the hypothesis are maintained in this case .",
    "+ case @xmath161 ( b)(ii ) : if spoiler chooses @xmath270 to be to the left of @xmath271 at distance @xmath291 strictly less than @xmath274 , then @xmath271 must be distance @xmath292 strictly less than @xmath241 from the left pinch , and so the hypothesis ensures that @xmath273 is also distance @xmath292 from a left pinch .",
    "duplicator should select @xmath275 to be distance @xmath291 to the right of @xmath273 , then @xmath275 is exactly the same distance ( @xmath293 ) as @xmath270 from a left pinch , and so condition ( @xmath210 ) of the hypothesis is maintained to this round .",
    "this selection also guarantees that condition ( @xmath158 ) is maintained in this case .",
    "if there is no previously played element further to the left of @xmath270 , then we are done .",
    "if on the other hand , there exists a previously played element @xmath264 further to the left of @xmath270 , we know that @xmath294 , and so we need to check condition ( @xmath158 ) of the hypothesis . at round @xmath268 , we had @xmath295 , and so the hypothesis tells us that @xmath296 , and hence duplicator s selection ensures that @xmath297 .",
    "we prove the contrapositive .",
    "assume that @xmath298 is not definable by a finite conjunction of anti - identities modulo @xmath299 .",
    "then @xmath298 fails the finite duality property relative to the class @xmath4 ( clearly , ( @xmath158 ) @xmath218 ( @xmath161 ) of theorem  [ thm : atserias ] relativises to any class ) .",
    "hence @xmath59 fails the finite duality property and so for every natural number @xmath9 , the structure @xmath184 does not admit a homomorphism to @xmath24 . now",
    "since the class @xmath4 is closed under forming the @xmath9-pinch construction over @xmath24 and taking disjoint unions , the proof of ( @xmath210 ) @xmath218 ( @xmath158 ) of theorem  [ thm : atserias ] relativises to @xmath4 : we have found , for each non - negative integer @xmath2 , two structures @xmath219 and @xmath220 in @xmath4 such that :        we now complete this section by extending theorem  [ thm : sausage ] .",
    "the proof follows a similar structure : we first prove a non - relativised version , namely theorem  [ thm : genrlsdsausagefacts ] , from which the extended result will follow almost immediately .",
    "the following three results given in lemma  [ lem : erdos ] , corollary  [ cor : extendederdos ] and lemma  [ lem : finiteduality ] are required .",
    "the first lemma appears as lemma  @xmath301 in @xcite , and is proved by a probabilistic argument based on that originally given by erds to show the existence , for each non - negative @xmath2 , of a graph with chromatic number greater than @xmath2 and no cycles of length less than or equal to @xmath2 .",
    "see the proof given in theorem  @xmath302 of @xcite .",
    "[ lem : erdos ] let @xmath24 and @xmath58 be @xmath7-structures . if there exists no homomorphism from @xmath58 to @xmath24 , then for every natural number @xmath9 there exists an @xmath7-structure @xmath303 of girth at least @xmath9 such that the following conditions hold :        [ cor : extendederdos ] let @xmath61 , let @xmath304 be a finite set of @xmath7-structures and let @xmath58 be an @xmath7-structure .",
    "if @xmath58 does not admit a homomorphism to @xmath48 , for each @xmath178 , then for any natural number @xmath9 , there exists an @xmath7-structure @xmath303 of girth at least @xmath9 such that the following conditions hold :      let @xmath90 .",
    "since @xmath58 does not admit a homomorphism to @xmath48 , we can use lemma  [ lem : erdos ] , to find a structure @xmath305 of girth at least @xmath9 that admits a homomorphism to @xmath58 but does not admit one to @xmath48 . define @xmath303 to be the disjoint union of the @xmath305 .",
    "clearly , the structure @xmath303 has girth at least @xmath9 and does not admit a homomorphism to @xmath48 , for all @xmath178 .",
    "the proof of the next lemma is identical , up to replacing lemma  @xmath301 of @xcite with its extended version corollary  [ cor : extendederdos ] , to the proof of lemma  @xmath209 in @xcite .",
    "we refer the reader to the proof there .",
    "let @xmath55 be a class of finite @xmath214-structures , let @xmath56 be a critical obstruction for the class @xmath307 and let @xmath308 .",
    "we let @xmath309 denote the substructure of @xmath56 induced by the set @xmath310 .",
    "[ lem : hom2npinch ] let @xmath311 , let @xmath304 be a finite set of homomorphism - independent @xmath7-structures and let @xmath56 be a critical obstruction for the class @xmath54 with diameter at least @xmath312 .",
    "assume that there are @xmath313 and @xmath314 with @xmath232 and @xmath315 distance @xmath312 apart and with both @xmath309 and @xmath316 admitting a homomorphism to @xmath317 .",
    "then there exists a homomorphism from @xmath56 to @xmath318 .",
    "the lemma is essentially borrowed from @xcite , so we give only a proof sketch .",
    "let @xmath232 and @xmath315 be elements in @xmath56 at distance @xmath312 and let @xmath319 and @xmath320 be homomorphisms .",
    "the maps @xmath321 and @xmath96 defined below are shown to be homomorphisms in the proof of proposition  @xmath306 in  @xcite .",
    "define @xmath322 by @xmath323          1 .",
    "@xmath54 is definable by a first - order sentence ; 2 .   for each @xmath178 ,",
    "the class @xmath329 satisfies the finite duality property ; 3 .",
    "@xmath54 satisfies the finite duality property ; 4 .",
    "@xmath54 is definable by a finite conjunction of anti - identities .",
    "( @xmath158 ) @xmath218 ( @xmath161 ) : we prove the contrapositive .",
    "assume that @xmath330 fails to satisfy the finite duality property .",
    "for each @xmath331 , define @xmath332 and let @xmath333 be the @xmath334-pinch over @xmath317 .",
    "let @xmath192 and @xmath193 be the substructures of @xmath333 induced by the sets @xmath335 and @xmath336 , respectively . from part ( [ itm : part1 ] and",
    "[ itm : pinchequiv ] ) of theorem  [ thm : sausagefacts ] , we have that , for all @xmath337 , the structure @xmath338 does not admit a homomorphism to @xmath317 , but the substructures @xmath192 and @xmath193 both admit homomorphisms to @xmath317 .",
    "now consider the disjoint union @xmath339 .",
    "since @xmath304 is a homomorphism independent set , it follows that , for all @xmath340 , the structure @xmath341 does not belong to the class @xmath54 . for each @xmath340 let @xmath220 be the structure obtained by taking the disjoint union of @xmath49 with @xmath225 copies of @xmath224 , and",
    "let @xmath342 .",
    "then , for each @xmath340 , we have @xmath343 , while @xmath344 .",
    "now apply the argument given in theorem  [ thm : sausage ] with the extra condition that whenever spoiler selects an element @xmath134 from @xmath219 in the extra copy of @xmath49 , then duplicator selects the corresponding element @xmath267 from the extra copy of @xmath49 in @xmath220 , and vice - versa .",
    "hence , for each non - negative integer @xmath2 , duplicator has a winning strategy in the @xmath2-round ehrenfeucht - frass game played on @xmath219 and @xmath220 , and so the property of admitting a homomorphism to @xmath55 is not definable by a first - order sentence .",
    "( @xmath161 ) @xmath218 ( @xmath210 ) : we will show that there is a bound on the the diameter of the critical obstructions for @xmath54 .",
    "the required result will then follow by lemma  [ lem : finiteduality ] .",
    "assume that , for each @xmath178 , the class @xmath345 satisfies the finite duality property .",
    "then , for each @xmath346 , there exists a natural number @xmath347 with @xmath348 admitting a homomorphism to @xmath349 , by part ( [ itm : pinchequiv ] ) of theorem  [ thm : sausagefacts ] .",
    "let @xmath56 be any critical obstruction for @xmath54 .",
    "of course , for any element @xmath350 , the substructure @xmath351 admits a homomorphism to at least one of the @xmath349 .",
    "now let @xmath2 be the diameter of @xmath56 , and let @xmath232 and @xmath315 be elements in @xmath324 at distance @xmath2 .",
    "we need to consider two cases .",
    "_ case @xmath158 _ : there exists @xmath314 with @xmath352 and @xmath353 admitting homomorphisms to @xmath317 . lemma  [ lem : hom2npinch ] tells us that @xmath56 admits a homomorphism to @xmath354 .",
    "but since @xmath355 admits a homomorphism to @xmath317 , and therefore @xmath356 admits a homomorphism to @xmath49 , for all @xmath357 ( by part  [ itm : pinchsurjhom ] of theorem  [ thm : sausagefacts ] ) , we must have that @xmath2 is strictly less than @xmath358 .",
    "_ case @xmath161 _ : there exists @xmath359 with @xmath360 and with @xmath352 admitting a homomorphism to @xmath361 and @xmath353 admittng a homomorphism to @xmath362 . we will show that @xmath2 is less than or equal to @xmath363 . if there exists @xmath364 and @xmath314 with @xmath365 and @xmath366 admitting homomorphisms to @xmath367 , then from case @xmath158 , the maximum distance between @xmath239 and @xmath368 in @xmath56 is strictly less than @xmath358 . thus , since @xmath352 admits a homomorphism to @xmath361 , any element @xmath350 with @xmath351 admitting a homomorphism to @xmath361 must be at most distance @xmath369 from @xmath232 .",
    "therefore any element @xmath370 with distance exactly @xmath371 from @xmath232 must have @xmath372 admitting a homomorphism to @xmath373 , where @xmath374 and @xmath375 .",
    "then any element @xmath376 with distance @xmath377 from @xmath378 ( and distance @xmath379 from @xmath232 ) must have @xmath380 admitting a homomorphism to @xmath381 , for some @xmath382",
    ". we can continue this process until we run out of @xmath383 s .",
    "it follows that the diameter @xmath2 of @xmath56 is at most @xmath384 .",
    "[ thm : colourfam ] let @xmath386 .",
    "let @xmath4 be a class of finite relational structures in the signature @xmath7 and let @xmath304 be a finite set of homomorphism - independent structures in @xmath4 . if @xmath4 is closed under forming the @xmath9-pinch construction over @xmath55 and taking disjoint unions , then @xmath387 is equal to @xmath216 for some first order sentence @xmath96 if and only if there is a finite conjunction of anti - identities @xmath87 such that @xmath388 .",
    "we prove the contrapositive .",
    "assume that @xmath389 is not definable by a finite conjunction of anti - identities modulo @xmath299 .",
    "then @xmath389 fails the finite duality property relative to the class @xmath4 , and therefore @xmath390 fails the finite duality property .",
    "so there is some @xmath314 with @xmath330 failing to satisfy the finite duality property , using ( @xmath161 ) @xmath218 ( @xmath210 ) of theorem  [ thm : genrlsdsausagefacts ] .",
    "now since the class @xmath4 is closed under forming the @xmath9-pinch construction over @xmath55 and taking disjoint unions , the proof of ( @xmath158 ) @xmath218 ( @xmath161 ) of theorem  [ thm : genrlsdsausagefacts ] relativises to @xmath4 .",
    "hence the property of admitting a homomorphism into @xmath55 relative to the class @xmath4 is not definable by a first - order sentence .",
    "we have made multiple references to closure under formation of the @xmath9-pinch and taking disjoint unions .",
    "we conclude this section with some examples of sentences that are closed under these constructions .",
    "[ eg : examplelaws ] let @xmath391 be a relational signature",
    ". then a class of @xmath214-structures @xmath55 is closed under forming the @xmath9-pinch ( for sufficiently large @xmath9 ) and disjoint unions if it is definable by sentences of any of the following forms :      closure under disjoint unions is obvious in each case ; in case ( 3 ) this uses the fact that the conclusion of the implication involves variables only appearing in the premise .",
    "we now discuss the formation of @xmath9-pinches ( for sufficiently large @xmath9 ) .",
    "case ( 1 ) is trivial , while case ( 2 ) follows from the fact that for @xmath396 , the @xmath289-vertex substructures of the @xmath9-pinch over @xmath397 admit a homomorphism into @xmath397 ( by theorem  [ thm : sausagefacts](1 ) ) , and hence the @xmath9-pinch will satisfy any anti - identity in at most @xmath289 variables that is true on @xmath397 .    for case",
    "( 3 ) , let @xmath398 .",
    "we have @xmath399 .",
    "if @xmath400 , then from the definition of @xmath401 , for each @xmath402 , there exists @xmath403 satisfying @xmath404 .",
    "it follows that @xmath69 and @xmath405 .",
    "note that here we are implicitly using the condition that @xmath395 ; if @xmath406 contained repeated elements then we could not guarantee repeated elements in @xmath407 . now interpreting in @xmath24 ,",
    "gives @xmath408 and @xmath409 , where @xmath410 .",
    "it follows that @xmath411 .",
    "a similar argument works for @xmath412 and even easier argument works for @xmath413 ."
  ],
  "abstract_text": [
    "<S> in this article , we investigate the status of the homomorphism preservation property amongst restricted classes of finite relational structures and algebraic structures . </S>",
    "<S> we show that there are many homomorphism - closed classes of finite lattices that are definable by a first - order sentence but not by existential positive sentences , demonstrating the failure of the homomorphism preservation property for lattices at the finite level . </S>",
    "<S> in contrast to the negative results for algebras , we establish a finite - level relativised homomorphism preservation theorem in the relational case . more specifically , </S>",
    "<S> we give a complete finite - level characterisation of first - order definable finitely generated anti - varieties relative to classes of relational structures definable by sentences of some general forms . </S>",
    "<S> when relativisation is dropped , this gives a fresh proof of atserias s characterisation of first - order definable constraint satisfaction problems over a fixed template , a well known special case of rossman s finite homomorphism preservation theorem . </S>"
  ]
}