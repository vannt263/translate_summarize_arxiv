{
  "article_text": [
    "stochastic wave equations play an important role in the quantum theory of decoherence and measurement@xcite as well as in computational many - body physics@xcite .",
    "solutions of master equations for completely positive dynamical semigroups@xcite and for redfield theory@xcite can be expressed as expectations of diadics formed from wavefunctions obeying stochastic wave equations .",
    "recently it has been shown that exact solutions of the n - body schrdinger or liouville - von neumann equations can be expressed as averages of hartree products of single - body wavefunctions or densities which obey stochastic wave equations@xcite .",
    "such methods could have important applications in chemistry and condensed matter physics .",
    "stochastic differential equations ( sdes ) are also widely employed in other areas of physics , engineering and finance@xcite .",
    "unfortunately , efficient numerical techniques for solving such equations have not yet been developed .",
    "algorithms in the literature have not substantially improved on the primitive methods described ten years ago in the well known text by kloeden and platen@xcite .",
    "methods applicable to general systems of stochastic differential equations with multiple wiener processes have not exceeded an order of 2 .",
    "the low order of such methods restricts their domain of usefulness to one or few equations , and the larger systems of equations of interest in physics can not be solved .",
    "recently , one of us noted@xcite that with minor modifications classical methods for ordinary differential equations ( odes ) can be used to solve sdes with strong solutions .",
    "the technique was demonstrated by solving a wide range of low dimensional sdes with known exact solutions@xcite .",
    "here we expand upon this idea by developing variable stepsize ( i.e. adaptive ) explicit runge - kutta based integrators for sdes .",
    "we demonstrate the use of the method by solving a variety of stochastic wave equations arising in decoherence problems@xcite , and in stochastic decomposition of the many - body problem@xcite .",
    "there is a close connection between taylor expansions of solutions of odes and taylor expansions of strong solutions of sdes@xcite .",
    "consider a finite set of sdes , @xmath0 represented in it@xcite form , where @xmath1 . here @xmath2 and the @xmath3 are independent and normally distributed stochastic differentials with zero mean and variance @xmath4 ( i.e. sampled @xmath5 ) .",
    "the stochastic variables @xmath6 are wiener processes .",
    "assume that the coefficients @xmath7 and @xmath8 have regularity properties which guarantee strong solutions , i.e. that @xmath9 are some fixed functions of the wiener processes , and that they are differentiable to high order .",
    "we may then view the solutions of ( [ sdes ] ) as functions @xmath10 of time and the wiener processes .",
    "the solutions can therefore be expanded in taylor series .",
    "keeping terms of order @xmath4 or less then gives @xmath11 the product of _ differentials _ @xmath12 is equivalent to @xmath13 in the it@xcite formulation of stochastic calculus , so that @xmath14~dt \\nonumber \\\\ & + & \\sum_{k=1}^m\\frac{\\partial x^j_t}{\\partial w^k_t}~dw^k_t.\\end{aligned}\\ ] ] comparison to ( [ sdes ] ) allows us to identify the first derivatives @xmath15 from these first order derivatives , expressed in terms of @xmath7 and @xmath8 , higher order derivatives can be computed .",
    "thus a taylor expansion of the solutions @xmath16 can be obtained for finite displacements @xmath17 and @xmath18 .",
    "this taylor expansion of strong solutions of sdes can be employed to develop runge - kutta algorithms and other integration schemes@xcite . as an example consider the classic fourth order runge - kutta scheme with four stages @xmath19 with @xmath20 defined via @xmath21\\delta t \\nonumber \\\\ & + & \\sum_{k=1}^mb^j_k({\\bf x}_t , t ) \\delta w^k_t.\\label{rhs}\\end{aligned}\\ ] ] here @xmath22 is the initial time and @xmath23 .",
    "taylor expansion shows that @xmath24 differs from the exact solution by terms of order higher than @xmath25 ( i.e. terms of higher order than @xmath25 , @xmath26 , @xmath27 , @xmath28 , and @xmath29 ) .",
    "thus , this stochastic runge - kutta algorithm is very similar to its classical counterpart except that its order is 2 not 4 .",
    "generalizations to higher order runge - kutta schemes are straightforward .",
    "one simply replaces the usual stage evaluations of runge - kutta with evaluations of ( [ rhs ] ) .",
    "since ( [ rhs ] ) is order @xmath30 rather than order @xmath17 , the order of the sde method is half that of the ode method .",
    "sde methods of order 2 and 4 constructed in this fashion have been shown to be very accurate in fixed stepsize calculations for small systems of sdes@xcite . in this manuscript",
    "we adapt a 9th order runge - kutta method@xcite with 16 stages into an order 4.5 method for sdes",
    ".    however , fixed stepsize runge - kutta methods are neither accurate nor efficient for general systems of equations . to solve the large systems of sdes that arise in physical problems we need some means of controlling the local error .",
    "local error is typically controlled in runge - kutta schemes for odes via the use of embedded lower order methods@xcite .",
    "that is , runge - kutta methods can often be found wherein a method of order @xmath31 with @xmath32 stages has an embedded runge - kutta scheme of order @xmath33 which uses some subset of the @xmath34 stages of the higher order method .",
    "differences in the two solutions can be compared to a user requested tolerance to decide whether a contemplated step can be accepted or whether a smaller stepsize should be considered .",
    "thus local error can be estimated , and stepsizes adapted to ensure the accuracy of the solution , at negligible extra cost .",
    "well implemented examples of this approach are the 5(4 ) and 8(7 ) embedded pairs of dormand and prince ( see @xcite and @xcite , respectively ) which form the basis of the ode software package rksuite .",
    "a 9(8 ) pair has been derived by tsitouras@xcite although this algorithm has not been included in any software of which we are aware .",
    "runge - kutta methods of order 10 are known@xcite but embedded lower order pairs have not been reported .",
    "variable stepsize one step schemes such as runge - kutta are popular because they are simple to understand and easy to implement .",
    "multi - step schemes , such as predictor - corrector@xcite , which store and use information from previous steps are however often much faster and more accurate . unfortunately , it is not clear how the stochastic taylor expansion developed above can be incorporated into a multi - step scheme .",
    "predictor - corrector@xcite , for example , employs lagrange type interpolation formulae ( to fit @xmath20 at a set of times ) , which are explicitly integrated over a time interval , to construct both the predictor and the corrector .",
    "it is far from clear how an analogous scheme would work for the @xmath35 variables @xmath36 .",
    "thus , runge - kutta methods seem to be the easiest to develop for sdes .    once an error has been judged too large to be acceptable",
    ", ode codes simply try a smaller step and all information about the original step is lost .",
    "this procedure obviously can not yield unbaised solutions in an analogous scheme for sdes .",
    "therefore measures must be taken to ensure that the original wiener process is maintained .",
    "one way of doing this is to halve the original step and to generate stochastic differentials on the two subintervals such that their sum is the original step .",
    "this approach was originally proposed by gaines and lyons@xcite and is known as the method of binary brownian trees .",
    "more sophisticated strategies have since been developed@xcite but they are specific to individual algorithms and can not be easily adapted for our purposes .",
    "a number of schemes have been proposed for choosing the stochastic differentials on the subintervals@xcite .",
    "the correct approach appears to be that of lamba@xcite who generates the stochastic differential on the first subinterval by sampling the conditional probability @xmath37 where @xmath38 is the original stochastic differential , @xmath39 is the stochastic differential on the first subinterval and @xmath40 is the independent density for differentials on the subintervals .",
    "this implies that the stochastic differential @xmath39 on the first subinterval has mean @xmath41 and variance @xmath42 . the stochastic differential on the second subinterval @xmath43",
    "must then be given by @xmath44 in order to maintain the original wiener process .",
    "thus , runge - kutta methods can be developed for sdes with strong solutions from runge - kutta methods for odes , and a binary tree variable stepsize strategy can be implemented with sampling on the subintervals via lamba s method@xcite . to show that the combined approach yields an accurate numerical method we solve a variety of stochastic wave equations from the recent physics literature . with the adaptive stepsize strategy",
    "we have chosen there is a good correlation between the speed of an algorithm and its order .",
    "we thus chose to employ the highest order runge - kutta pair available , which as far as we are aware is the 9(8 ) pair of tsitouras@xcite .",
    "we have sucessfully used other lower order methods such as those of @xcite and @xcite , but for consistency all results reported in this paper were calculated using the method described in @xcite .",
    "here we solve 3 sets of equations from the recent physics literature using the order 4.5 runge - kutta method implemented with variable stepsizes as described above .",
    "[ [ section ] ]    the first example we consider is the gisin - percival@xcite stochastic wave equation for the nonlinear absorber ( eq .",
    "4.2 of ref .",
    "@xcite ) @xmath45 where @xmath46 denotes the usual harmonic oscillator lowering operator .",
    "we chose an initial state @xmath47 where @xmath48 is the lowest eigenstate of @xmath49 .",
    "we choose @xmath50 in this and later examples and the wiener process @xmath51 is real .",
    "the notation @xmath52 indicates the quantum expectation @xmath53 . the ensemble average over statistical realisations of the wiener processes",
    "is denoted via @xmath54 $ ] for any @xmath55 .",
    "the quantity of interest for this example is the average density @xmath56\\label{dens}\\ ] ] which obeys the deterministic master equation @xmath57 + 2a^2\\rho(t)a^{\\dag 2}-a^{\\dag 2}a^2\\rho(t)-\\rho(t)a^{\\dag 2}a^2.\\label{me1}\\ ] ]    to implement our approach we need to find the derivatives of @xmath58 with respect to @xmath59 and @xmath51 .",
    "we immediately see that @xmath60 and using ( [ derivs ] ) we also determine that @xmath61 from these results we can now construct @xmath20 using eq .",
    "( [ rhs ] ) .",
    "the runge - kutta scheme can thus be implemented as discussed above .",
    "the dynamics was solved in a basis consisting of the lowest 11 eigenstates @xmath62 of @xmath49 with @xmath63 .",
    "thus , including real and imaginary parts of @xmath64 for @xmath63 our equations consist of a total of 22 real nonlinear coupled stochastic equations .",
    "a relative tolerance of @xmath65 was requested . in fig .",
    "1 we plot the mean occupation number @xmath66 vs time for 50000 stochastic realisations ( dashed curve ) and for an exact solution of eq .",
    "( [ me1 ] ) performed in the same basis set ( solid curve ) .",
    "agreement is very good .    due to the increasing number of wiener processes in the following examples",
    ", we drop the @xmath51 s as arguments of the stochastic wavefunctions .",
    "this change of notation is necessary but regretable since this dependence is an essential requirement of the method we are testing .    [ [ section-1 ] ]    the second example is the gisin - percival@xcite stochastic wave equation for a quantum cascade with absorption and stimulated emission ( eq .",
    "4.4 of ref .",
    "@xcite ) @xmath67 here again we chose the initial state @xmath68 .",
    "there are now 2 real statistically independent wiener processes ( i.e. @xmath69=0 $ ] ) .",
    "the quantity of interest is again the density ( [ dens ] ) which in this case obeys the master equation @xmath70 + 2a^{\\dag}a\\rho(t)a^{\\dag}a-(a^{\\dag}a)^2\\rho(t)-\\rho(t)(a^{\\dag}a)^2\\nonumber \\\\ & + & .02a\\rho(t)a^{\\dag}-.01a^{\\dag}a\\rho(t)-.01\\rho(t)a^{\\dag}a.\\label{me2}\\end{aligned}\\ ] ]    the derivatives of @xmath71 with respect to @xmath59 , @xmath72 and @xmath73 are given by @xmath74 the same basis set and tolerance as in example 1 were employed .",
    "again we calculated the mean occupation number for 50000 trajectories ( dashed curve ) and for an exact solution of eq .",
    "( [ me2 ] ) ( solid curve ) .",
    "these quantities are plotted in fig .",
    "( [ hesp2 ] ) .",
    "agreement is again good but convergence is somewhat slower than in example 1 since we now have twice as many wiener processes .    [ [ section-2 ] ]    the third example consists of stochastic wave equations for a stochastic decomposition of the schrdinger equation for helium@xcite .",
    "neglecting nuclear motion about the center of mass , the helium wavefunction @xmath75 obeys the deterministic schrdinger equation ( in atomic units @xmath76 , @xmath77 , and @xmath78 ) @xmath79 for any specified anti - symmetric initial state @xmath80 . here",
    "@xmath81 and @xmath82 denote positions of electrons 1 and 2 with respect to the nucleus .",
    "for our example calculation we choose an initial wavefunction of the form @xmath83 ( where @xmath84 is a normalization factor ) which is obviously antisymmetric in @xmath81 and @xmath82 .",
    "note that we are implicitly incorporating the two - component electron spins into the definitions of @xmath85 and @xmath86 .",
    "for our purposes it is important that @xmath87 .",
    "the actual initial conditions for this example calculation were chosen randomly as a mixture of 1s and 2s he@xmath88 states for each electron .",
    "it can be shown@xcite that the exact deterministic wavefunction @xmath75 evolving from ( [ init ] ) can be decomposed into stochastic waves via an average of the form @xmath89\\end{aligned}\\ ] ] where @xmath90 and @xmath91 satisfy stochastic wave equations @xmath92 dt \\nonumber \\\\ & + &   \\sum_{s=1}^p\\sqrt{-i\\omega_s } \\left ( o_s - \\langle o_s \\rangle_1 \\right ) \\psi_{1}({\\bf r},t ) dw_t^s \\\\ & -&\\sum_{s=1}^p|\\omega_s|\\frac{\\langle \\psi_{1}|\\psi_{1}\\rangle [ \\langle o_s^{\\dag}o_s\\rangle_1 - |\\langle o_s \\rangle_1|^{2}]}{2 { \\rm re } \\left\\ { \\langle \\psi_{1 } |\\psi_{2}\\rangle \\right\\}}\\psi_2({\\bf r},t)dt\\nonumber \\\\ & & d\\psi_{2}({\\bf r},t ) =    [ -i ( -\\frac{1}{2}\\nabla^2-\\frac{2}{r})\\psi_{2}({\\bf r},t)-i\\sum_{s=1}^p\\omega_s\\langle o_s \\rangle_1 o_s \\psi_{2}({\\bf r},t)\\nonumber \\\\ & + & \\frac{i}{2}\\sum_{s=1}^p\\omega_s \\langle o_s \\rangle_2 \\langle o_s \\rangle_1 \\psi_{2 } ( { \\bf r},t ) ] dt \\nonumber \\\\ & + &   \\sum_{s=1}^p\\sqrt{-i\\omega } \\left ( o_s - \\langle o_s \\rangle_2 \\right ) \\psi_{2}({\\bf r},t )   dw_t^s \\\\ & -&\\sum_{s=1}^p|\\omega_s|\\frac{\\langle \\psi_{2}|\\psi_{2}\\rangle [ \\langle o_s^{\\dag}o_s\\rangle_2 - |\\langle o_s \\rangle_2|^{2}]}{2 { \\rm re } \\left\\ { \\langle \\psi_{1 } |\\psi_{2}\\rangle \\right\\}}\\psi_1({\\bf r},t)dt.\\nonumber \\label{oeqns2}\\end{aligned}\\ ] ] we have used a notation @xmath93 in the above equations . here",
    "the @xmath94 and operators @xmath95 arise through the one - body expansion of the coulomb interaction @xmath96 which we performed numerically in a basis of he@xmath88 eigenstates@xcite . in the calculation",
    "reported here @xmath97 which means that there are eight real wiener processes . since the initial states are of s type we included only the basis functions of s type with a principle he@xmath88 quantum number of 4 or less@xcite .",
    "this means that the total number of equations was 32 .",
    "clearly this is by far the most computationally difficult of the three examples .",
    "the derivatives of @xmath98 are given by @xmath99}{2 { \\rm re } \\left\\ { \\langle \\psi_{1 } |\\psi_{2}\\rangle \\right\\}}\\psi_k({\\bf r},t)\\nonumber \\\\ & + & \\frac{i}{2}\\sum_{s=1}^p\\omega_s(o_s^2 - 2\\langle o_s \\rangle_jo_s+2\\langle o_s \\rangle_j^2-\\langle o_s^2 \\rangle_j)\\psi_{j } ( { \\bf r},t)\\nonumber \\\\ & + & \\frac{1}{2}\\sum_{s=1}^p|\\omega_s|(\\langle o_s^{\\dag}o_s \\rangle_j-|\\langle o_s \\rangle_j|^2)\\psi_{j } ( { \\bf r},t)\\end{aligned}\\ ] ] where @xmath100 and @xmath101 . from these equations",
    "we can now construct @xmath20 using eq .",
    "( [ rhs ] ) .",
    "a numerical problem arises in eqs .",
    "( [ oeqns2 ] ) when the overlap @xmath102 becomes small .",
    "the terms inversely proportional to this factor vary rapidly and the speed of integration slows down greatly .",
    "this occurs every few atomic units .",
    "fortunately , this can be easily avoided by adding a small piece of @xmath103 to @xmath104 , renormalizing the wavefunctions , and carrying the new norm as a weight factor in the stochastic average .",
    "the antisymmetric nature of the full wavefunction guarantees that this manipulation makes no change in the solution .    in figs .",
    "( [ repsi ] ) and ( [ impsi ] ) we plot the real and imaginary parts of @xmath105 for 200000 trajectories ( dashed curve ) and for the exact solution ( solid curve ) of the shrdinger equation ( [ se1 ] ) .",
    "agreement is satisfactory with some deterioration of accuracy as time proceeds .    finally , we computed the energy spectrum via @xmath106 which we plot in fig .",
    "( [ hesp3 ] ) . again satisfactory agreement is obtained .",
    "the fact that complete convergence is not achieved even with 200000 realisations may be due to the relatively large number of wiener processes .",
    "unfortunately , examples with very large numbers of wiener processes will arise when the method of stochastic wave equations described in @xcite is applied to larger atoms or molecules .",
    "thus it may be necessary to explore some form of importance sampling to improve convergence for these simulation methods .",
    "the numerical strategy discussed in this manuscript provides a method for solving the large sets of coupled nonlinear sdes which arise in physical problems .",
    "this is currently the best strategy for solving systems of sdes like those that arise from stochastic wave equations .",
    "however , the large number of stages ( 16 for @xcite ) required for high order runge - kutta formulae limit the efficiency of our approach .",
    "multistep methods for odes such as predictor - corrector@xcite typically require only two evaluations of derivatives per step and can be implemented to any desired order .",
    "if such methods could be adapted for sdes the gain in efficiency could be enormous .",
    "unfortunately , to implement such a strategy would require interpolation in @xmath35 variables with variable stepsizes ( here @xmath107 is the number of wiener processes ) .",
    "at present we do not see how this can be accomplished .",
    "n. gisin and i. c. percival , j. phys .",
    "a 25 , 5677 ( 1992 ) .",
    "p. gaspard and m. nagaoka , j. chem .",
    "111 , 5676 ( 1999 ) .",
    "i. carusotto and y. castin , laser physics 13 , 509 ( 2003 ) ; i. carusotto , y. castin , and j. dalibard , phys . rev .",
    "a 63 , 023606 ( 2001 ) .",
    "o. juillet , ph .",
    "chomaz , phys .",
    "88 , 142503 ( 2002 ) .",
    "j. wilkie , phys .",
    "e 67 , 017102 ( 2003 ) .",
    "l. tessieri , j. wilkie and m. etinba , submitted for publication .",
    "gardiner , _ handbook of stochastic methods _ ,",
    "( springer , berlin , 1983 ) . p.e . kloeden and e. platen ,",
    "_ numerical solution of stochastic differential equations _ , ( springer , berlin , 1995 ) . j. wilkie , phys . rev .",
    "e , accepted for publication ( 2004 ) .",
    "w.h . press , s.a .",
    "teukolsky , w.t .",
    "vetterling and b.p .",
    "flannery , _ numerical recipes _ , ( cambridge university press , cambridge , 1992 ) .",
    "e. hairer , s.p .",
    "norsett , g. wanner , _ solving ordinary differential equations _ , ( springer - verlag , berlin , 1993 ) .",
    "dormand and p.j .",
    "prince , j. comput .",
    "6 , 19 ( 1980 ) .",
    "p.j . prince and j.r .",
    "dormand , j. comput .",
    "math 7 , 67 ( 1980 ) .",
    "tsitouras , appl .",
    "38 , 123 ( 2001 ) .",
    "e. hairer , j. inst .",
    ". applics .",
    "21 , 47 ( 1978 ) .",
    "l. f. shampine and m. k. gordon , _ computer solution of ordinary differential equations : the initial value problem _ , ( san francisco , w.h .",
    "freeman , 1975 ) .",
    "gaines and t.j .",
    "lyons , siam j. appl . math .",
    "57 , 1455 ( 1997 ) .",
    "see j. leyn , a. rbler and o. schein , j. comput .",
    "138 , 297 ( 2002 ) and references therein .",
    "h. lamba , j. comput .",
    "appl . math .",
    "161 , 417 ( 2003 ) ."
  ],
  "abstract_text": [
    "<S> we show that existing runge - kutta methods for ordinary differential equations ( odes ) can be modified to solve stochastic differential equations ( sdes ) with strong solutions provided that appropriate changes are made to the way stepsizes are selected . </S>",
    "<S> the order of the resulting sde scheme is half the order of the ode scheme . </S>",
    "<S> specifically , we show that an explicit 9th order runge - kutta method ( with an embedded 8th order method ) for odes yields an order 4.5 method for sdes which can be implemented with variable stepsizes . </S>",
    "<S> this method is tested by solving systems of sdes originating from stochastic wave equations arising from master equations and the many - body schrdinger equation . </S>"
  ]
}