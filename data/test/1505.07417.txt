{
  "article_text": [
    "the lhcb experiment records millions of proton collision events every second .",
    "most of them are not needed for further analysis and are discarded by a sophisticated multi - layer trigger system @xcite . what is left amounts to @xmath0 events in run 1 .",
    "before physics analysis takes place , the number of events is further reduced by a factor of around 10 .",
    "this `` stripping '' process takes place after the full reconstruction of the events , and produces a set of a dozen `` streams '' of the analysis dataset . @xcite .",
    "those streams contain candidate events for different processes  identified by `` stripping lines . ''",
    "events that passed the stripping process are indexed by event index .    along the stripping lines",
    "some other information is indexed  global activity counters ( such as total number of tracks and hits in individual subdetectors ) , logical file names ( lfns ) on the grid , and run conditions database tags .",
    "event index consists of four primary parts : backend , which hosts the indexes and processes the queries ; frontend , which interacts with the user ; the grid collector for downloading events from the grid ; and an indexer for compiling the indexes .",
    "their relationship is expressed on the figure [ fig : arch ] .",
    "the principle component that stores events and handles queries is a 7-node cluster .",
    "each node hosts several shards .",
    "a shard is an apache lucene index .",
    "indexes are build from .root files using mapreduce with events being evenly distributed between the nodes .",
    "events are represented in backend in a problem - agnostic generic format .",
    "thus event index can be used on new datasets with minimal modification .",
    "event index is optimized for read - only indexes on a static hardware configuration .",
    "cluster expansion is still possible and can be accomplished in two ways .",
    "first , if both new data and new nodes are available , the data can be indexed on these nodes without changes to the existing structure .",
    "this approach may be suboptimal , as the best performance is only achieved when the data is evenly distributed among the nodes .",
    "second , if only nodes are added , we must either redistribute the existing shards between nodes or reindex the dataset to include them into the cluster .",
    "index splitting is possible but constitutes a highly experimental @xcite procedure with computational costs similar to that of reindexing .",
    "requests are handled by a java application as follows .",
    "any node can become a master node by virtue of initiating a request .",
    "* search request : a master node receives a query , sends it to all the nodes , each in turn sends it to its shards , shards run the query , and cache the resulting bitset .",
    "* partial search results retrieval : a master node receives a query , asks all the nodes for the results counts , determines the nodes to send the request to .",
    "nodes receiving the following request do the same with shards .",
    "the master node then gathers the responses and forwards them to the user .",
    "* field value aggregation : a master node receives a query , sends it to all the nodes , each in turn sends it to its shards , each shard aggregates the field values from the matching events .",
    "the master node aggregates the results and returns them to the user . *",
    "histogram calculation : a master node receives a query , sends it to all the nodes , each in turn sends it to its shards , each shard counts unique values of the requested fields , and returns them to the master node , which computes the resulting histogram .",
    "queries are transformed into lucene filters using a simple top - down parser for context - free grammar .",
    "it consists of two parts : the tokenizer and the parser itself .",
    "the tokenizer transforms a query string into a list of tokens ( @xmath1and , or , has ) and values",
    ". the parser uses the list to build the solution tree , using prefix notation to handle parentheses and substituting has and and for missing unary and binary operators .",
    "it then converts the tree into a lucene filter .",
    "indexing @xmath2 events took three days and 0.5 tb of hard drive space per node .",
    "the backend response times for various requests can be seen in figure [ fig : performance ] .",
    "this response was within 20 seconds for the majority of requests .",
    "the outliers are currently being investigated .",
    "all user interaction is done through the web interface , protected by cern single sign - on @xcite .",
    "queries can either be typed manually or constructed with the help of an interactive wizard .",
    "example searches :    * for a specific stripping line : + * by file location : + `` lfn = lfn:/lhcb / lhcb / collision11/charmtobeswum.dst/ 00022760/0002/00022760_00029252_1.charmtobeswum.dst and stripping=20r1 '' * stripping line and npvs value : +    event index can compile a list of logical file names ( lfn ) containing the search results . if there are less than 1000 results , event index can fetch them from grid as a .root file and display them in the web browser using event display @xcite .",
    "users can also plot histograms for the global activity counters .",
    "the grid collector handles the .root file download requests .",
    "it resides on a dedicated server at cern .",
    "it uses lhcb dirac @xcite for retrieving event locations on the grid .",
    "then it launches parallel gaudi@xcite jobs for events retrieval and format conversion for event display .",
    "the source code is available on https://gitlab.cern.ch/ysda/grid_collector .",
    "event index is deployed into production on https://eindex.cern.ch/. data from strippnigs 20 , 20r1 , 21 , 21r1 is available .",
    "we are currently studying the needs of different groups in lhcb to make event index a better tool .",
    "plans include python api , mc and turbo stream @xcite indexing , and free form query processing .",
    "event index allows selection of events and viewing of histograms of basic properties in a matter of seconds .",
    "this is much faster than the current use of grid , which can take hours .",
    "event index s core architecture will allow it to scale with data and be used for different datasets .",
    "99 https://lucene.apache.org/ , apache software foundation head t , 2014 , the lhcb trigger system , _ jinst 9 c09015 _ doi:10.1088/1748 - 0221/9/09/c09015 charpentier p ( on behalf ofthe lhcb collaboration ) , the lhcb computing model and real data _ journal of physics : conference series , vol .  331 , num .  7 , chep-2010 _ lucene 5.1.0 misc api https://lucene.apache.org/core/5_1_0/misc/org/apache/lucene/index/indexsplitter.html ormancey e , 2007 , cern single sign on solution , _",
    "langenbruch  c , couturier  b , frank  m , a webgl event display for lhcb : status update , _",
    "5th lhcb computing workshop , may 18 , 2015 _ stagni  f , et al , lhcbdirac : distributed computing in lhcb , _ journal of physics : conference series , vol . 396 , num .",
    "3 , chep-2012 _ barrand  g et al . , gaudi - a software architecture and framework for building hep data processing applications , _",
    "computer physics communications 140 ( 2001 ) 4555 _ benson s , 2015 , the lhcb turbo stream _ chep-2015 _"
  ],
  "abstract_text": [
    "<S> during lhc run 1 , the lhcb experiment recorded around @xmath0 collision events . </S>",
    "<S> this paper describes event index  an event search system . </S>",
    "<S> its primary function is to quickly select subsets of events from a combination of conditions , such as the estimated decay channel or number of hits in a subdetector . </S>",
    "<S> event index is essentially apache lucene @xcite optimized for read - only indexes distributed over independent shards on independent nodes . </S>"
  ]
}