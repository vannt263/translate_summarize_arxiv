{
  "article_text": [
    "many fundamental experiments in quantum mechanics can be written and fully understood in terms of a quantum circuit @xcite .",
    "the current state of the art , however , provides a poor platform for implanting these circuits on what can be considered a universal quantum computer .",
    "the limited number of independent degrees of freedom that can be manipulated efficiently limit the possible experiments .",
    "many popular experiments involving a small number of qubits include some type of post - selection . by post - selecting",
    ", experimenters condition their statistics only on those experiments that ( will ) meet a certain criteria such as the result of a projective measurement performed at the end of the experiment .",
    "such conditioning produces a number of surprising effects like strange weak values @xcite and nonlinear quantum gates @xcite .",
    "although they are sometimes described via quantum circuits , experiments involving post - selection are usually implemented in a dedicated setup which is not intended to act as a universal quantum processor .",
    "for example in current optical implementations @xcite the addition of more gates would require extra hardware .",
    "nowadays , implementations of quantum computing tasks in nmr architectures provide a good test - bed for up to 12 qubits @xcite .",
    "universal quantum circuits can be implemented on mid - scale ( 5 - 7 qubit ) nmr quantum computers with the development of high - fidelity control @xcite .",
    "however , the difficulty in performing projective measurements poses a handicap with the implementation of circuits involving post - selection . here",
    "we will show how to overcome this difficulty theoretically and experimentally , in the setting of weak measurements .",
    "weak measurements provide an elegant way to learn something about a quantum system @xmath0 in the interval between preparation and post - selection @xcite .",
    "when the interaction between @xmath0 and a measuring device @xmath1 is weak enough , the back - action is negligible @xcite .",
    "moreover the effective evolution of the measuring device during the measurement is proportional to a _ weak value _ , a complex number which is a function of the pre - selection , post - selection and the desired observable .",
    "these weak values allow us to make statements that would otherwise be in the realm of _ counterfactuals _ @xcite .",
    "weak values have been interpreted as complex probabilities @xcite and/or _ element of reality _ @xcite and , although somewhat controversial @xcite , they are used to describe a number of fundamental issues in quantum mechanics including : non - locality in the two slit experiment @xcite , the trajectories of photons @xcite , the reality of the wave function@xcite , hardy s paradox@xcite , the three box paradox @xcite , measurement precision - disturbance relations @xcite and the leggett - garg inequality @xcite .",
    "recently the amplification effect associated with large real and imaginary weak values was used in practical schemes for precision measurements .",
    "while these schemes can not overcome the limits imposed by quantum mechanics , they can be used to improve precision under various types of operational imitations such as _ technical noise _ @xcite .",
    "experimental realizations of weak measurements have so far been limited to optics with only a few recent exceptions @xcite . in all cases post - selection",
    "was done using projective measurements that physically select events with successful post - selection .",
    "optical experiments ( e.g ref .",
    "@xcite ) exploit the fact that one degree of freedom can be used as the system while another ( usually a continuous degree of freedom ) can be used as the measuring device .",
    "post - selection is achieved by filtering out photons that fail post - selection and the readout is done at the end only on the surviving systems .",
    "this type of filtering is outside the scope of ensemble quantum computers where all operations apart from the final ensemble measurement are unitary .",
    "one can overcome the difficulty by either including a physical filter or by finding some way for post - selection using unitary operations .",
    "the former poses a technical challenge as well as a conceptual deviation from the circuit model . in what follows",
    "we show how to perform the latter by resetting the measuring device each time post - selection fails .",
    "our theoretical proposal is compatible with a number of current implementation of quantum processors such as such as liquid and solid state nmr@xcite , electron spin qubits @xcite and rare earth crystal implementations @xcite .",
    "we begin by describing the weak measurement process for qubits and the theoretical circuit for weak measurements on an ensemble quantum computer ( fig . [ circuit ] ) .",
    "next we describe our experiment in detail ( fig . [ molecule ] ) .",
    "we demonstrate two properties of weak values associated with post - selection : weak values outside the range of eigenvalues and imaginary weak values ( figs .",
    "[ gweak ] , [ thetaweak ] ) .",
    "we conclude with a discussion of future applications",
    "the weak measurement procedure ( for qubits ) @xcite involves a system @xmath0 qubit initially prepared in the state @xmath2 and a measuring device qubit initially in the state @xmath3 such that @xmath4 .",
    "the system and measuring device are coupled for a very short time via the interaction hamiltonian @xmath5 with the coupling constant @xmath6 and @xmath7 a pauli observable in the direction @xmath8 .",
    "this is followed by a projective ( post - selection ) measurement on @xmath0 with outcome @xmath9 . up to normalization",
    "we have    @xmath10    the unnormalized state of @xmath1 at the end is @xmath11\\ket{\\md_i}^\\sm\\ ] ]    where @xmath12 is the weak value of @xmath13 .",
    "we can now take the weak measurement approximation @xmath14 so that up to first order in @xmath15 we have @xmath16    the measurement device is rotated by @xmath17 around the @xmath18-axis .",
    "note that this is the actual unitary evolution ( at this approximation ) , not an average unitary .",
    "if we set the measuring device to be in the initial state @xmath19 $ ] , the expectation value for @xmath20 will be @xmath21 choosing @xmath22 appropriately we can get the real or imaginary part of the weak value .",
    "the scheme above is based on the fact that @xmath0 was post - selected in the correct state @xmath23 . since this",
    "can not be guaranteed in an experiment , we need to somehow disregard those events where post - selection fails .",
    "as noted previously , the standard method for implementing the post - selection is by filtering out the composite @xmath24 systems that fail post - selection .",
    "while this is relatively simple in some implementations it is not a generic property of a quantum processor . in particular post - selection is not implicit in the circuit model .",
    "the method to overcome this problem is to reset the measuring device whenever post - selection fails .",
    "one way to implement the controlled reset ( see fig . [ circuit ] ) is by using a controlled depolarizing gate with the following properties @xmath25 where @xmath26 is an arbitrary state and @xmath27 is the orthogonal state to the post - selection @xmath28 .",
    "this gate is not unitary and requires an ancillary system @xmath29 .",
    "it can be constructed by setting @xmath30 and using a controlled - swap with the swap between @xmath29 and @xmath1 . to keep the control in the computational basis",
    ", we preceded the controlled - swap gate by @xmath31 where @xmath32 . at the readout stage",
    "we need to measure the observable @xmath33 which will give the probability of post - selection @xmath34 as well as @xmath35 .",
    "finally we divide @xmath35 by @xmath34 to obtain the weak value . if we are only interested in reading out the real or imaginary part of the weak value we can further simplify this operation by a controlled dephasing in a complementary basis to @xmath36 .",
    "this allows us to replace the controlled - swap by a controlled - controlled - phase with @xmath1 as the target and @xmath37 as the control ( see fig .",
    "[ molecule]b ) . in our experimental setup",
    "we used the latter ( simplified ) approach .",
    "a controlled - controlled-@xmath38 was used in the post - selection for measuring real weak values and controlled - controlled-@xmath39 was used for complex weak values .",
    "is prepared in the state @xmath40 , it then interacts weakly with the measurement device @xmath1 ( the weak measurement stage ) .",
    "post - selection is performed by a controlled depolarizing channel in the desired basis , eq , decomposed into a rotation @xmath41 followed by a contolled depolarizing in the computational basis .",
    "finally at the readout stage we get the probability of post - selection @xmath34 from @xmath42 .",
    "the exception values @xmath43 are shifted by a factor proportional to the weak value and decayed by a factor @xmath34 . ]",
    "we conducted three types of experiments . in each experiment we prepared @xmath0 in an initial state on the @xmath44 plane , @xmath45 ,",
    "the weak measurement observable was a pauli operator in the @xmath46 plane , @xmath47 and the post - selection was always the @xmath48 state . in the first experiment ( fig .",
    "[ gweak]b ) we set @xmath49 to make a measurement of @xmath39 and varied the coupling strength from @xmath50 to @xmath51 .",
    "we used three different initial states : @xmath52 - corresponding to a measurement where the weak value coincides with the result of a projective ( @xmath53 ) measurement , @xmath54 - where we were able to observe a large weak value,@xmath55 , at @xmath50 , and @xmath56 - where the weak value ( first order ) approximation is off by more than @xmath57 at @xmath50 .",
    "next we kept the coupling constant at @xmath58 and varied over @xmath59 to observe real weak values both inside and outside the range of eigenvalues @xmath60 $ ] ( fig .",
    "[ thetaweak]a ) .",
    "finally we measured complex weak values with an absolute magnitude of 1 by keeping the initial state constant , @xmath52 , and varying over the measurement direction @xmath61 at @xmath58 ( fig .",
    "[ thetaweak]b ) .",
    "all experiments were conducted on a bruker drx 700mhz spectrometer at room temperature .",
    "our 3-qubit sample was @xmath62c labeled trichloroethylene ( tce ) dissolved in d - chloroform .",
    "the structure of the molecule is shown in fig .",
    "[ molecule]a , where we denote c1 as qubit 1 , c2 as qubit 2 , and h as qubit 3 .",
    "the internal hamiltonian of this system can be described as @xmath63 where @xmath64 is the chemical shift of the @xmath65th spin and @xmath66 is the scalar coupling strength between spins @xmath67 and @xmath65 . as the difference in frequencies between c1 and c2 is not large enough to adopt the ( nmr ) weak j - coupling approximation @xcite , these two carbon spins are treated in the strongly coupled regime .",
    "the parameters of the hamiltonian are obtained by iteratively fitting the calculated and observed spectra through perturbation , and shown in the table of fig .",
    "[ molecule]a .",
    "c and one @xmath68h spins form a 3-qubit sample . in the parameter table",
    "the diagonal elements are the chemical shifts ( hz ) , and the off - diagonal elements are scalar coupling strengths ( hz ) .",
    "t@xmath69 and t@xmath70 are the relaxation and dephasing time scales .",
    "( b ) the quantum network used to realize the post - selected weak measurement in the experiment with c1 as the ancilla @xmath29 , c2 as the measuring device @xmath1 , and h as the system @xmath0 .",
    "post - selection of @xmath48 was achieved using the controlled - controlled - z gate so that @xmath1 is dephased when post - selection fails .",
    "the final measurements give the expectation values @xmath71 and @xmath72 which are used to calculate the weak value via eq . ]",
    "we label c1 as the ancilla @xmath29 , c2 as the measuring device @xmath1 , and h as the system @xmath0 ( fig .",
    "[ molecule]b ) .",
    "each experiment can be divided into four parts : ( a ) pre - selection : initializing the ancilla to the identity matrix @xmath73 , the measurement device to @xmath74 , and the system to @xmath75 .",
    "( b ) weak measurement : interaction between the measuring device and system , denoted by u@xmath76 in the network . ( c )",
    "post - selection of the system in the state @xmath77 .",
    "( d ) measurement : @xmath78 on the measuring device ( @xmath79 for the imaginary part ) and @xmath80 on the system .",
    "the experimental details of the four parts above are as follows .",
    "\\(a ) pre - selection : starting from the thermal equilibrium state , first we excite the ancilla c1 to the transverse field by a @xmath81 rotation , followed with a gradient pulse to destroy coherence leaving c1 in the maximally mixed state @xmath73 .",
    "next we create the pseudopure state ( pps ) of c2 ( @xmath1 ) and h ( @xmath0 ) with deviation @xmath82 using the spatial average technique @xcite . for traceless observables and unital evolution the identity part of the pps",
    "can be treated as noise on top of a pure state .",
    "the spectra of the pps followed by @xmath81 readout pulses are shown in the upper part of fig .",
    "[ gweak]a .",
    "the readout pulses are applied on c2 ( left figure ) and h ( right figure ) , respectively .",
    "two peaks are generated in the pps spectra because c1 is in the maximally mixed state @xmath73 , and these two peaks are utilized as the benchmark for the following experiments .",
    "finally we apply one hadamard gate on c2 and one @xmath83 rotation on h. at the end of this procedure the state is @xmath84    \\(b ) weak measurement : the unitary operator to realize the weak measurement @xmath85 can be simulated by the interaction term @xmath86 between c2 and h using the average hamiltonian theory @xcite .",
    "however , since the internal hamiltonian contains a strongly coupling term and the refocusing scheme requires the wahuha-4 sequence @xcite we adopted the gradient ascent pulse engineering ( grape ) technique @xcite to improve the fidelity ( see discussion below ) .",
    "\\(c ) post - selection : in order to mimic the post - selection of @xmath77 on the system spin h in nmr , we introduce an ancilla qubit c1 in the maximally mixed state @xmath87 .",
    "the controlled resetting noise operation is a controlled - controlled-@xmath38 gate @xmath88 if post - selection is successful , the measurement device will point to the weak value .",
    "otherwise the measurement device will become dephased and the expectation value @xmath89 will be reset to 0 . for the measurement of complex weak values we used a standard toffoli and applied the same reasoning .",
    "\\(d ) measurement : finally we measure the expectation value @xmath90 on c2 and @xmath91 on h , to calculate the weak value by the expression @xmath92 for the imaginary part we similarly use @xmath93 .",
    "since the timescales for the experiment are much shorter than @xmath94 the evolution is very close to unital .    in the experiment , the @xmath81 rotation of h",
    "is realized by the hard pulse with a duration of 10 @xmath95s .",
    "all the other operations are implemented through grape pulses to achieve high - fidelity control .",
    "these grape pulses are designed to be robust to the inhomogeneity of the magnetic field , and the imprecisions of the parameters in the hamiltonian .",
    "for the two selective @xmath81 excitations on c1 and c2 , the grape pulses are generated with the length 1.5 ms , segments 300 and fidelity over 99.95% .",
    "these two pulses are only used for the preparation and observation of pps .",
    "besides these two grape pulses , the pps preparation involves another grape pulse of 10 ms and 99.99% fidelity for the creation of two - body coherence .",
    "the top spectra in fig .",
    "[ gweak]a are the pps both on c2 and h , which are used as the benchmark for the following experiments .    the main body of the network shown in fig .",
    "[ molecule]b , including the pre - selection , weak measurement and post - selection , is calculated by a single grape pulse . since we have to alter the initial state by @xmath59 and interaction strength @xmath15 in the experiment , we have used different grape pulses to implement the experiments with different group of parameters .",
    "all of these grape pulses have the same length : 20 ms , and fidelity over 99.98% .",
    "there are two essential advantages in utilizing the grape pulses : reducing the error accumulated by the long pulse sequence if we directly decompose the network , and reducing the error caused by decoherence . because the @xmath96 evolution is supposed to be very `` weak ''",
    ", the intensity of the output signal is quite small .",
    "moreover , the calculated weak values are more sensitive to the intensity of the signal , because the small @xmath15 in the denominator ( eq [ weakvalue ] ) will amplify the errors in the experiment .",
    "therefore , we need to achieve as accurate coherent control as we can to obtain precise experimental results .",
    "the direct decomposition of the original network requires many single rotations , as well as a relatively long evolution time .",
    "for example , an efficient way to decompose the controlled - controlled-@xmath38 gate is by six cnot gates and several one qubit gates @xcite , which requires more than 50 ms in our experimental condition .",
    "therefore , using _ short _ grape pulses of _ high fidelity _ we were able to decrease the potential errors due to decoherence and imperfect implementation of the long pulse sequence .",
    "[ gweak]a shows the experimental spectra compared with the simulated one in the case @xmath50 and @xmath97 .",
    "the top plots are the reference ( pps ) spectra while the bottom are the spectra measured at the end of the experiment .",
    "the predicted value of @xmath90 in this case is only 1.67% .",
    "however , since the experimental spectra are very close to the simulated one , we can obtain a good result after extracting the data .",
    "the effects of decoherence in the case of small post - selection probabilities values can be seen in fig .",
    "[ gweak]b where the experimental values are consistently lower than the theoretical predictions .",
    "since decoherence reduces the expectation values the results of eq   will be more sensitive to decoherence as @xmath98 .",
    "in the first experiment we varied the interaction strength @xmath50 to @xmath99 for @xmath49 and three different initial states @xmath97 , @xmath100 , and @xmath101 .",
    "we obtained the weak value through a final measurement of @xmath90 on the measuring device c2 and @xmath91 on the system h , respectively .",
    "the weak value @xmath102 was calculated through eq , with the result shown in fig .",
    "[ gweak]b .",
    "the error bars were obtained by repeating the experiment four times .",
    "the large error bars in the weak values at small values of @xmath15 and low post - selection probabilities are a result of imperfect calibration of the low experimental signals obtained at that range .     on c2 and @xmath71 on h.",
    "to observe the signal on h , we applied @xmath81 readout pulses after the sequence .",
    "the spectra in the figure are for @xmath50 and @xmath97 , the simulated spectra ( blue ) fit well with the experimental one ( red ) .",
    "( b ) weak values for various initial states , @xmath45 , were calculated using eq and compared the theoretical predictions as a function of the measurement strength from @xmath50 to @xmath51 .",
    "the solid curves are theoretical predictions without the weak measurement approximation . when the overlap between the pre and post - selection , @xmath103 is large enough we get very close to the asymptotic @xmath104 value at @xmath105 .",
    "however for @xmath56 the interaction was not weak enough at @xmath50 .",
    "the error bars are plotted by repeating each experiment four times . at low post - selection probabilities",
    "we see observed values decrease due to decoherence . ]    in the second experiment we studied the behavior of measured weak values as a function of the initial state parameter @xmath59 at @xmath58 and @xmath49 .",
    "the theoretical weak value should be @xmath106 ( at @xmath107 ) .",
    "we compared our results with a theoretical curve at @xmath58 ( fig .",
    "[ thetaweak]a ) .",
    "as expected this curve diverges from the weak value of @xmath106 as the overlap between the pre and post - selection vanishes and second order terms become more dominant .",
    "the experimental data matches with the smooth part of the curve .",
    "when @xmath59 is very close to @xmath81 , we were unable to measure the extremely low nmr signals due to the signal - to - noise ratio(snr ) issues , moreover decoherence effects become more prominent at these values ( see discussion above ) .",
    "as a function of the initial state @xmath108 for a fixed post - selection @xmath109 at @xmath58 .",
    "the theoretical ( blue ) curve is plotted for @xmath58 without the weak measurement approximation , and the experimental data is denoted by red circles . as expected at @xmath110 we measure a relative shift outside the range of eigenvalues , @xmath111 .",
    "as @xmath59 approached @xmath81 the signal was too weak to measure due to the low probability of post - selection .",
    "( b ) experimental result of measuring both the real and imaginary parts of the weak value @xmath112 at @xmath58 and @xmath113 as a function of @xmath61 . at these values it was possible to get the full range of weak values with an absolute magnitude of 1 . ]    in the final experiment we measured both the real part and imaginary parts of the weak value ( fig .",
    "[ thetaweak]b ) .",
    "we set @xmath113 and @xmath58 , and changed @xmath61 , the observable of the measuring device c2 .",
    "the expected weak values have an absolute magnitude of 1 and the overlap between the pre and post - selected state is @xmath114 . to measure the imaginary part , we replaced the controlled - controlled-@xmath38 gate in fig .",
    "[ molecule]b with a controlled - controlled-@xmath39 gate , and measured the expectation value @xmath115 on the measuring device c2 .",
    "the other parts of the experiments remain the same . in fig .",
    "[ molecule]b we can see the real part and imaginary part of the weak value along with the parameter @xmath61 .",
    "the results match well with the theory .",
    "post - selection is a useful and interesting conceptual and practical tool .",
    "its experimental implementations have so far been limited to dedicated quantum devices .",
    "here we showed that this paradigm can be realized in a more general setting of a quantum circuit with unitary gates .",
    "we implemented a weak measurement where shifts corresponding to weak values outside the range of eigenvalues ( @xmath60 $ ] in the case of pauli observables ) are an artifact of non trivial post - selection .",
    "our experiment involved a simple 3-qubit system and we were able to demonstrate the measurement of large ( fig [ gweak]b , [ thetaweak]a ) and imaginary ( fig . [ thetaweak]b ) weak values .",
    "we observed a shift of @xmath116 with an accuracy of @xmath117 at @xmath54 for @xmath50 compared with the theoretical weak value of @xmath118 ( at @xmath104 ) .",
    "the largest relative shift observed was @xmath119 for @xmath56 at @xmath50 compared with a theoretical value of @xmath120 . at this value",
    "the weak measurement approximation would require the interaction to be an order of magnitude smaller . for complex weak values we were able to demonstrate the full spectrum of complex weak values with unit absolute magnitude .",
    "our scheme has the advantage that it can be extended to systems with more qubits without significant changes .",
    "implementations on a four qubit system will allow the first fully quantum implementation of the three box paradox and further extensions will allow more intricate experiments such as the measurement of the wave - function and measurement - disturbance relations which have so far been limited to optical implementations , often with classical light .",
    "the reasonably large number of qubits that can be manipulated in nmr systems will also allow more intricate experiments that are not possible in optics .",
    "it remains an open question whether our techniques can be used for precision measurements in the same way as they are used in optics .",
    "given that this is the first implementation of weak measurements in nmr there is still much to be explored .",
    "we thank marco piani and sadegh raeisi for comments and discussion .",
    "this work was supported by industry canada , nserc and cifar .",
    "j. l. acknowledges national nature science foundation of china , the cas , and the national fundamental research program 2007cb925200 ."
  ],
  "abstract_text": [
    "<S> the ability to post - select the outcomes of an experiment is a useful theoretical concept and experimental tool . in the context of weak measurements , </S>",
    "<S> post - selection can lead to surprising results such as complex weak values outside the range of eigenvalues . </S>",
    "<S> usually post - selection is realized by a projective measurement , which is hard to implement in ensemble systems such as nmr . </S>",
    "<S> we demonstrate the first experiment of a weak measurement with post - selection on an nmr quantum information processor . our setup is used for measuring complex weak values and weak values outside the range of eigenvalues . </S>",
    "<S> the scheme for overcoming the problem of post - selection in an ensemble quantum computer is general and can be applied to any circuit - based implementation . </S>",
    "<S> this experiment paves the way for studying and exploiting post - selection and weak measurements in systems where projective measurements are hard to realize experimentally . </S>"
  ]
}