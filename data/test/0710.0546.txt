{
  "article_text": [
    "the large length scales and relatively high conductivity of the plasma in the solar corona imply that , to a good approximation , magnetic flux is frozen to the plasma there .",
    "consequently , the coronal magnetic field is `` line - tied '' to the plasma in lower atmospheric layers where hydrodynamic forces can be stronger than lorentz forces  the photosphere and lower chromosphere  and coronal evolution is strongly coupled to evolution in these layers .",
    "accordingly , observations of magnetic field evolution below the sun s corona  typically , sequences of photospheric or chromospheric magnetograms  provide crucial tools understand coronal evolution .",
    "usually , vector magnetograms are more useful than line - of - sight ( los ) magnetograms for studying coronal evolution , because information derived from los measurements alone will not , in general , be consistent with the actual magnetic field , which has field components both parallel and transverse to the los .",
    "although time series of vector magnetograms have historically been rare , solis @xcite , the solar optical telescope ( sot , tarbell 2006 ) on hinode , and the solar dynamics observatory s helioseismic and magnetic imager ( hmi ) @xcite , should dramatically improve photospheric vector magnetogram spatial and temporal coverage in the near future .",
    "several techniques have been developed to derive flows from time series of magnetograms @xcite .",
    "estimated flows at the base of the corona can be used to derive the fluxes of magnetic helicity , energy , and free energy into the corona , @xcite .",
    "further , flow estimates can be used to provide time - dependent boundary conditions for data - driven simulations of coronal magnetic field evolution .",
    "this paper briefly reviews progress on estimating surface flows from magnetogram sequences , and demonstrates some aspects of the problem with test data .",
    "how have velocities been derived from vector magnetograms ?",
    "chae ( 2001 ) applied local correlation tracking ( lct ) @xcite to los photospheric magnetograms to determine the proper motions of magnetic features on the magnetogram surface , and assumed the inferred flows @xmath3 were estimates of the horizontal plasma velocities @xmath4 .",
    "( here the @xmath5 subscript denotes a vector s components tangential to the magnetogram surface .",
    "we avoid the subscript @xmath6 , which has been used to refer to vector components both transverse to the los and tangential to the solar surface . ) assuming that the observed evolution of the photospheric magnetic field is governed by flows according to the ideal induction equation , @xmath7 kusano _ et al .",
    "_  ( 2002 ) proposed using the component of equation ( [ eqn : induct ] ) normal to the magnetogram , @xmath8 to derive three - component velocity fields  @xmath9 .",
    "here , we have defined the magnetogram surface to be the horizontal plane containing @xmath10 and @xmath11 , with a vertical normal @xmath12 .",
    "the three components of @xmath13 can not completely determined from ( [ eqn : normal ] ) alone , so more data or assumptions are required to close the system for @xmath13 .",
    "what about the horizontal components of equation ( [ eqn : induct ] ) ?",
    "as kusano _",
    "et al . _  ( 2002 ) noted , only the normal component of equation ( [ eqn : induct ] ) is completely specified by vector magnetic field measurements from a single atmospheric layer ; the other components of equation ( [ eqn : induct ] ) contain vertical derivatives of horizontal magnetic field components , and therefore require measurements of the vector magnetic field at a different height in the atmosphere ( e.g. , the chromosphere ) which are only rarely available @xcite .",
    "kusano _ et al .",
    "_  ( 2002 ) assumed lct velocities , @xmath14 , to be equivalent to @xmath4 to close the system .",
    "dmoulin and berger ( 2003 ) argued that tracked motions of magnetic flux on the solar photosphere , @xmath14 , result from the combined effects of horizontal plasma velocities transporting vertical magnetic fields and vertical plasma velocities transporting horizontal magnetic fields , via @xmath15 the distinction between apparent motions of flux and plasma velocities led welsch ( 2006 ) to term @xmath14 the `` flux transport velocity . ''",
    "dmoulin and berger ( 2003 ) suggested that lct could be used to infer @xmath14 , but not @xmath4 directly .",
    "we note that , in addition to ideal flux transport , diffusive effects can also lead to apparent flux transport velocities @xcite , although we ignore these effects in the present work .",
    "since the seminal work of kusano _ et al . _  ( 2002 ) , still more techniques have been developed that determine velocities from vector magnetograms .",
    "et al . _",
    "( 2004 ) used equation ( [ eqn : dandb ] ) to combine fourier lct ( flct ) results with equation ( [ eqn : normal ] ) to determine a photospheric flow field in a method they termed inductive local correlation tracking , or ilct .",
    "longcope ( 2004 ) developed the minimum energy fit ( mef ) , which finds the photospheric velocity field that is strictly consistent with equation ( [ eqn : normal ] ) and that minimizes a penalty function , e.g. , the integrated square of the three - component photospheric velocity .",
    "georgoulis and labonte ( 2006 ) extended the minimum structure method of georgoulis , labonte , and metcalf ( 2004 ) to the problem of velocity determination , in a method they termed minimum - structure reconstruction ( msr ) .",
    "schuck ( 2005 ) showed that , formally , lct is not consistent with the induction equation s normal component , which can be expressed as a continuity equation ; instead , lct is consistent with the advection equation .",
    "building upon the `` differential lct '' ( dlct ) method developed by lucas and kanade ( 1981 ) , schuck ( 2006 ) developed the differential affine velocity estimator ( dave ) , which employs least - squares fitting to solve the continuity - form of equation ( [ eqn : normal ] ) for @xmath14 and its spatial derivatives .",
    "all of the methods listed above can be applied to chromospheric as well as photospheric magnetograms .",
    "flow estimation techniques that explicitly employ equation ( [ eqn : normal ] ) have been termed `` inductive '' @xcite ; examples include i m , ilct , mef , and msr .",
    "tracking methods , e.g. , flct , dlct , and dave , use the evolution of structure in @xmath0 to quantify proper motions , and may also be referred to as `` optical flow '' techniques @xcite .",
    "tracking techniques usually apply a windowing function , centered on each pixel tracked , to derive the optical flow in the neighborhood of that pixel .",
    "since this window imposes a scale length , tracking methods have been criticized for their selective sensitivity to flows on the imposed window scale @xcite .",
    "the tracking techniques mentioned thus far might be termed `` eulerian methods , '' as they estimate velocities over a set of pixels from an image pair . in contrast , `` feature tracking '' techniques @xcite , in which discrete `` features '' are identified from structure in @xmath0 maps and followed in time , might be termed `` lagrangian '' techniques .",
    "we will not discuss feature tracking techniques further in this work .",
    "generally , velocity estimation techniques are susceptible to errors in magnetograms , because changes in the inferred magnetic field , @xmath1 , are assumed to arise from flows via equation ( [ eqn : normal ] ) .",
    "simply put , when noise or systematic errors introduce spurious fluctuations @xmath16 in @xmath0 , spurious velocities are derived . in particular , in regions where @xmath17 is small , @xmath16 due to noise can be on the order of changes @xmath18 due to actual field evolution . for this reason",
    ", tracking methods are expected to estimate flows more accurately in regions where @xmath17 is large ( barring magnetograph saturation effects ) than where @xmath17 is small .",
    "the recent proliferation of velocity estimation methods led welsch _",
    "et al . _  ( 2007 ) to test seven routines ability to reproduce known flows .",
    "they extracted several pairs of `` synthetic magnetograms '' from anmhd simulations of a rising flux rope in the upper solar convection zone , and used several methods methods  two lct codes , dave , i m , ilct , mef , and msr  to estimate flows responsible for magnetic evolution between each pair .",
    "they then compared properties of the estimated flows with those of the `` true '' flows from the mhd code .",
    "( these flow reconstructions were not blind : those deriving flow estimates had access to the true flow . )",
    "they found that mef , dave , flct , i m , and ilct performed similarly by many measures , but that mef estimated the fluxes of magnetic energy and helicity quite well .",
    "the other methods tested estimated the fluxes of magnetic energy and helicity through the magnetogram layer poorly .    while the mhd simulations of field evolution in the solar interior used by welsch _",
    "_  ( 2007 ) did not accurately model photospheric field evolution , they did provide a valuable tool for testing velocity estimates . in the near future ,",
    "blind tests , with simulated data that more accurately model photospheric field evolution , are planned , as are tests of the sensitivity of flow estimation methods to noise .",
    "( application of these methods to synthetic chromospheric vector magnetograms will also be investigated . )",
    "in this section , we briefly consider possible remedies to the remaining underdetermination , as well as its implications .",
    "doppler measurements of the velocity of the magnetized plasma , best determined from stokes @xmath29 and/or @xmath30 profiles ( not @xmath31 ; see chae _",
    "et al . _  [ 2004 ] ) , can not fully determine whether the inferred plasma flows lie either parallel to or perpendicular to the magnetic field if @xmath32 .",
    "this degeneracy is illustrated schematically in figure [ fig : dopdegen ] .",
    ", a flow @xmath33 perpendicular to @xmath2 can produce the same los velocity as a flow @xmath34 parallel to @xmath2 .",
    "this means los flows inferred from doppler shifts are insensitive to the relative orientation of @xmath13 and @xmath35 flows parallel to @xmath2 do not lead to evolution in @xmath2 , and do not transport magnetic energy or helicity .",
    "the evolution of @xmath0 at the photosphere , however , can be used to estimate @xmath36 the presence of a field component perpendicular to the page ( neglected in this figure ) would not affect this analysis . ,",
    "width=480 ]    doppler shifts do unambiguously determine the perpendicular flow when @xmath37 .",
    "near disk center , this is approximately satisfied along polarity inversion lines , where @xmath0 changes sign , as noted by @xcite and @xcite .",
    "doppler observations of have shown that some polarity inversion lines can also be velocity inversion lines ( deng _ et al . _",
    "2006 ) , which can be interpreted as the manifestation of siphon flows moving along field lines that arch over the polarity inversion line .",
    "doppler measurements can , however , be combined with an estimate of the perpendicular velocity @xmath33 from one of the techniques described above to recover the flow parallel to the magnetic field : subtracting the projection of @xmath33 onto the los from @xmath38 gives the los component of @xmath27 , which can be divided by the cosine of the angle between @xmath2 and the los to give @xmath27 .",
    "georgoulis and labonte ( 2006 ) have employed this approach in an observational study of active region flows , and ravindra and longcope ( 2007 ) have investigated the use of doppler shifts in a theoretical study using the data from welsch _ et al . _  ( 2007 ) .    in the following discussion , any reference to @xmath13 should be assumed to refer to @xmath33 .",
    "one can employ a helmholtz decomposition of equation ( [ eqn : dandb ] ) , @xmath39 to express @xmath40 in terms of `` inductive '' and `` electrostatic '' potentials @xcite @xmath41 and @xmath42 , respectively .",
    "( we note that , assuming the ideal ohm s law , these potentials can be expressed as sources of a horizontal electric field , @xmath43    inserting equation ( [ eqn : decomp ] ) into equation ( [ eqn : normal ] ) yields a poisson equation for @xmath41 , @xmath44 meaning the evolution of @xmath0 between a pair of sequential magnetograms , @xmath45 , specifies @xmath41 .",
    "this does not , however , constrain @xmath42 in any way .",
    "equation ( [ eqn : chi_poisson ] ) can be solved to determine the purely inductive flux transport rate , i.e. , one that assumes @xmath42 = 0 , @xmath46 where the subscript @xmath31 denotes that the flux transport velocity is inductive . in principle , equation ( [ eqn : uibz ] ) can be substituted into equation ( [ eqn : dandb ] ) and combined with equation ( [ eqn : vb0 ] ) to determine to determine @xmath13 . in practice , though , solving this system of equations for @xmath13 requires division by @xmath0 , which weights regions of weak @xmath17 more strongly than regions of large @xmath17 , and , as discussed in ",
    "[ sec : intro ] , flows are expected to be poorly estimated in such regions .",
    "for some applications , however , an estimate of @xmath47 is sufficient ; for instance , equations ( [ eqn : dsdt ] ) and ( [ eqn : dhdt_bf ] ) imply that @xmath40 can be used to estimate the fluxes of magnetic energy and helicity into the corona without determining @xmath13 .",
    "the anmhd data used by welsch _",
    "_  ( 2007 ) can be used to demonstrate the ability to estimate flow properties from the induction equation alone . in figure",
    "[ fig : data ] , we show a snapshot of the magnetic ( grayscale background for @xmath0 and white vectors for @xmath48 ) and velocity ( black / white contours for @xmath49 , and black arrows arrows for @xmath4 ) fields in a cross section of the simulation domain near the top of the convection zone .    , white vectors show @xmath48 , black ( white ) contours show smoothed downflows ( upflows ) of @xmath49 , and black arrows show @xmath4 .",
    "only components of @xmath13 perpendicular to @xmath2 are shown .",
    ", width=480 ]    we note that the strong fields present ( @xmath50 g ) are appropriate to the high-@xmath51 solar interior , but are substantially stronger than observed photospheric field strengths .",
    "these data are described in much greater detail in welsch _",
    "et al . _",
    "2007 @xcite .    using the @xmath18 between two synthetic magnetograms 125 seconds before and after the magnetogram shown in figure [ fig : data ] , we solved equation ( [ eqn : chi_poisson ] ) with a fourier technique to compute @xmath52 .",
    "figure [ fig : uibz ] shows a scatter plot comparing anmhd s flux transport rate , @xmath53 , with @xmath52 , along with the linear correlation coefficients for the @xmath54 and @xmath55 components .",
    ", with that derived from equation ( [ eqn : chi_poisson ] ) , @xmath56 , along with the linear correlation coefficients for the @xmath54 and @xmath55 components .",
    "the solid line is not a fit ; it is the desired slope , and is shown to emphasize departures from that slope.,width=480 ]    these correlation coefficients compare quite favorably with results of the tests by welsch _",
    "et al . _  ( 2007 ) .",
    "we also computed a least - absolute - difference linear fit of @xmath57 as a function of @xmath58 , and found a slope of 0.4 , when 1.0 would be ideal ; evidently , inductive flux displacements underestimate anmhd s true flux displacements .",
    "in addition , we calculated the estimated fluxes of magnetic energy and magnetic helicity , separately trying the methods of dmoulin and berger ( 2003 ) and pariat _ et al . _  ( 2005 ) for the helicity flux .",
    "we found that @xmath52 determined by our fourier method recovered 30% of the energy flux , but only 10% of the helicity flux .",
    "if , however , the estimated helicity flux was summed only over strong - field pixels  in which @xmath17 exceeded 5% of max(@xmath17 )  the dmoulin and berger ( 2003 ) approach recovered 20% of the helicity flux from all pixels , while the pariat _",
    "et al . _  ( 2005 ) approach recovered 15% of the helicity flux from all pixels . while these results compare favorably with most of the velocity estimation methods tested by welsch _",
    "et al . _  ( 2007 ) , they reveal that inductively determined flux transport rates lack essential information about the fluxes of energy and helicity  presumably related to @xmath42 being unconstrained by equation ( [ eqn : chi_poisson ] ) .    the inductive potential @xmath41 used in these test was determined with a fourier technique , which assumes periodicity , and solves for @xmath41 on all pixels , including those with weak vertical field .",
    "we ran the same tests with an alternative potential function , @xmath59 , which satisfies homogeneous boundary conditions over a masked region that includes only pixels with @xmath60 g. derived by b. ravindra and d.w .",
    "longcope , @xmath59 was used for the inductive component of mef flows in the tests conducted by welsch _",
    "et al . _  ( 2007 ) .",
    "we found that , compared to flux transport rates from @xmath41 , flux transport rates derived from @xmath59 were more poorly correlated with anmhd s flux transport rates , underestimated @xmath58 more severely , and recovered less of the vertical fluxes of magnetic energy and helicity .",
    "we note that mef overestimated @xmath58 in the tests performed by welsch _",
    "et al . _  ( 2007 ) .",
    "this implies that the superior performance of the mef approach at estimating fluxes of magnetic energy and helicity in welsch _",
    "et al . _",
    "( 2007 ) derives from mef s specification of @xmath42 .      as dmoulin and berger ( 2003 ) observed",
    ", the underdetermination of @xmath13 by equation ( [ eqn : normal ] ) implies that there exists a class of flows that cause no evolution in @xmath0 , but that can inject large amounts magnetic energy and helicity .",
    "flows that do not alter @xmath0 satisfy @xmath62 because these flows lie in the null space of equation ( [ eqn : normal ] ) , we call them `` null flows , '' and denote them with a zero subscript",
    ". while flows along contours of @xmath0  `` contour flows ''  are a well known subset of null flows , modelers have employed other null flows ; see , e.g. , @xcite .    taking the curl of equation ( [ eqn : decomp ] ) yields @xmath63 a flux transport velocity , @xmath64 , estimated from any optical flow technique ( e.g. , dave or flct ) can be used with ( [ eqn : psi_poisson ] ) to find @xmath42 , and equation ( [ eqn : chi_poisson ] ) to find @xmath41 .",
    "this is the essence of ilct @xcite ; but it goes a step further , and uses equations ( [ eqn : decomp ] ) and ( [ eqn : vb0 ] ) to determine @xmath13 . since , however , optical flow techniques ultimately depend on @xmath65 , and flows associated with @xmath42 do not alter @xmath0 , this procedure is expected to be insensitive to such flows .",
    "we can use flct flows to illustrate the difference in sensitivity of one velocity estimation technique to flows along contours of @xmath0 versus flows along gradients of @xmath0 . in figure",
    "[ fig : nullflow ] , we plot selected contours of anmhd s average @xmath0 over a grayscale image of the change @xmath18 over the same 250 second time interval used to estimate @xmath52 in  [ subsec : induct ] we also plot anmhd s instantaneous flux displacement , @xmath66 , decomposed into components along contours ( gradients ) of of @xmath0 with white ( black ) vectors .",
    "flow estimation techniques that depend upon @xmath1 are expected to be insensitive to flows that transport flux along contours of @xmath0 ( white vectors ) .     in the normal magnetic field",
    "is shown in grayscale , along with selected contours of @xmath0 ( white for @xmath67 , black for @xmath68 ) .",
    "anmhd s instantaneous flux displacement , @xmath69 , decomposed into components along contours ( white vectors ) and gradients ( black vectors ) of @xmath0 , is overplotted .",
    "flow estimation techniques that depend upon @xmath19 are insensitive to flows that transport flux along contours of @xmath0 ( white vectors ) .",
    ", width=480 ]    using @xmath14 from flct in equation ( [ eqn : psi_poisson ] ) to find @xmath42 , and equation ( [ eqn : decomp ] ) to combine @xmath41 from equation ( [ eqn : chi_poisson ] ) with @xmath42 , we attempted to reconstruct anmhd s flux displacement , @xmath69 , from figure [ fig : nullflow ] . in figure",
    "[ fig : contgradflow ] , we show scatter plots of flux displacements from anmhd and our estimates of these ( denoted @xmath69 and @xmath40 , respectively ) along @xmath61 ( horizontal dashes ) and contours of @xmath0 ( vertical line segments ) .",
    "flows along @xmath61 are recovered more accurately than flows along contours of @xmath0 , as quantified by the linear correlation coefficients shown on the plot . the fact that contour flows are even partially recovered presumably results from variations in the spatial structure of @xmath0 in the neighborhood of each tracked pixel .     and",
    "estimated @xmath40 are shown .",
    "the vectors have been decomposed into components along gradients in @xmath0 ( plotted with )and contours of @xmath0 ( plotted with @xmath70 ) .",
    "flux transport along gradients of @xmath0 is recovered more accurately than transport along contours of @xmath0 , as quantified by the linear correlation coefficients shown for each component .",
    "the solid line is not a fit ; it is the desired slope , and is shown to emphasize departures from that slope.,width=432 ]",
    "we have briefly reviewed central concepts regarding surface flow estimation from magnetograms . in addition , we have presented the results of simple tests which demonstrate that the induction equation s normal component , equation ( [ eqn : normal ] ) , can be used to quantitatively estimate flux transport rates .",
    "fluxes of magnetic energy and helicity derived from these estimates are , however , likely to possess significant systematic errors . we have also demonstrated that flow estimation techniques that depend upon evolution in @xmath0 alone are insensitive to flux transport along contours of @xmath0 , compared to flux transport along @xmath61 . equations ( [ eqn : dsdt ] ) and ( [ eqn : dhdt_bf ] ) , which depend on the dot products of @xmath40 with @xmath48 and with @xmath71 respectively , combined with the sensitivity of @xmath40 to @xmath61 , suggest that if @xmath48 and/or @xmath71 lie primarily along @xmath61 , then the fluxes of magnetic energy and/or helicity can , in principle , be recovered accurately from @xmath45 . if , in contrast , @xmath48 and/or @xmath71 lie primarily along contours of @xmath0 , then the fluxes of magnetic energy and/or helicity probably can not be recovered accurately from evolution in @xmath0 alone .",
    "we note that , as discussed in @xcite , the anmhd data used in the tests presented here differ from actual magnetograms in significant ways , so the properties of flows estimated from actual magnetograms will probably differ substantially from the properties of flows estimated from anmhd data .",
    "welsch , b.  t.  abbett , w.  p. , derosa , m.  l. , fisher , g.  h. , georgoulis , m.  k.  kusano , k. , longcope , d.  w. , ravindra , b. , and schuck , p.  w. 2007 , apj , in press , http://solarmuri.ssl.berkeley.edu/@xmath72welsch/public/manuscripts/shootout/maxmil/ms.pdf"
  ],
  "abstract_text": [
    "<S> estimates of velocities from time series of photospheric and/or chromospheric vector magnetograms can be used to determine fluxes of magnetic energy ( the poynting flux ) and helicity across the magnetogram layer , and to provide time - dependent boundary conditions for data - driven simulations of the solar atmosphere above this layer . </S>",
    "<S> velocity components perpendicular to the magnetic field are necessary both to compute these transport rates and to derive model boundary conditions . here </S>",
    "<S> , we discuss some possible approaches to estimating perpendicular flows from magnetograms . </S>",
    "<S> since doppler shifts contain contributions from flows parallel to the magnetic field , perpendicular velocities are not generally recoverable from doppler shifts alone . </S>",
    "<S> the induction equation s vertical component relates evolution in @xmath0 to the perpendicular flow field , but has a finite null space , meaning some `` null '' flows , e.g. , motions along contours of normal field , do not affect @xmath0 . </S>",
    "<S> consequently , additional information is required to accurately specify the perpendicular flow field . </S>",
    "<S> tracking methods , which analyze @xmath1 in a neighborhood , have a long heritage , but other approaches have recently been developed . in a recent paper </S>",
    "<S> , several such techniques were tested using synthetic magnetograms from mhd simulations . here </S>",
    "<S> , we use the same test data to characterize : 1 ) the ability of the induction equation s normal component , by itself , to estimate flows ; and 2 ) a tracking method s ability to recover flow components that are perpendicular to @xmath2 and parallel to contours of @xmath0 . </S>",
    "<S> this work has been supported by nasa heliophysics theory grant nng05g144 g . </S>"
  ]
}