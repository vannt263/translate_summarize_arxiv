{
  "article_text": [
    "in this paper we address the realization and identification problem for a subclass of piecewise - affine hybrid systems .",
    "* contribution of the paper * we define the class of _ piecewise - linear systems _ ( abbreviated by * pwl * ) .",
    "* pwl*s are a subclass of piecewise - affine hybrid systems .",
    "the continuous dynamics of * pwl *  is determined by a finite collection of affine subsystems . however , in contrast to traditional piecewise - affine systems , we allow any change of the continuous state during a discrete - state transition , as long as the new state belongs to the set of designated initial states of the affine subsystem associated with the new discrete state .",
    "in addition , we do not impose any specific mechanism for triggering discrete - state transitions .",
    "we formulate the realization problem for this system class and partially solve it by providing necessary and sufficient conditions for existence of a realization .",
    "we also present conditions for minimality .",
    "we show that the outputs of any * pwl *  can also be described by a switched ar model .",
    "the main conclusion is that any system can be transformed to a minimal system _ with one discrete state _ while preserving input - output behavior .",
    "this means that without further restrictions , the identification problem for such systems is not necessarily interesting .",
    "we discuss a number of restrictions on the system structure which avoid this problem .",
    "note that the conclusion above is not valid for other classes of hybrid systems . for hybrid systems from @xcite , there examples of input - output maps which provenly can not be realized by systems with one discrete state .",
    "in addition , we present an identification algorithm for systems with full observations .",
    "this algorithm is illustrated by example of physical and biological relevance .",
    "* motivation * the motivation for studying realization theory for * pwl*s is that it provides the theoretical foundations for systems identification .",
    "the motivation for investigating identification of * pwl*s is the following .",
    "* first , several systems of interest can be modeled by * pwl*s and * pwl*s tend to be convenient for analysis",
    ". however the parameters of * pwl *  models are often not directly available and hence they have to be estimated from measurements . * the problem of estimating the network dynamics of complex biological systems can be reduced to the identification problem for * pwl*s",
    ".    * identification of * pwl*s and biological networks * below we will elaborate on the relationship between identification of * pwl*s and the estimation of dynamic interactions of complex dynamical systems .",
    "numerous vital processes in nature involve complex signaling networks , varying from gene - protein interaction networks @xcite and complex communication in microbes @xcite to the synchronization in the heart of higher animals @xcite . in most cases , these signaling networks",
    "do not have a fixed topology , but vary their structure according to their internal states and certain external conditions @xcite .",
    "this flexibility allows the organism to exhibit complex behavior and flexible responses to various environmental conditions .",
    "the underlying biological problem is to describe these flexible dynamical networks , based on ( partial ) observations of their internal states .",
    "examples of potential observations are time series of gene expressions , protein densities , oxygen stress and sugar concentrations .    in almost all cases ,",
    "there is no explicit mathematical model available that even remotely describes the network dynamics .",
    "this is caused by the sheer size of the problem ; the many thousands of genes , rnas , proteins and other types of molecules involved , the complexity and idiosyncrasy of their interactions , and the large amount of noise in biological systems .",
    "basically , many agents involved in the network are unknown let alone their mechanism of interaction .",
    "mathematically , the processes above can be viewed as nonlinear dynamical systems with unknown parameters .",
    "such systems often have several equilibria , and hence their behavior can be seen as a mixture of certain affine systems , where each affine system is obtained by linearizing the original system around one of the equilibria .",
    "that is , such systems can be approximated by a * pwl*. in addition to their simplicity , the advantage of * pwl *  approximations is that they neatly capture the interaction among various state components around various equilibria .",
    "more precisely , interaction between the @xmath0th and @xmath1th state components can be viewed as the property that the @xmath2th entry of the jacobian of the system around equilibrium is non - zero .",
    "since we are often interested exactly in interactions rather than the detailed dynamics , it makes sense to recast the problem of identifying such interactions into the problem of identifying * pwl*s approximations . while the paper does not directly address identification of interactions , we believe that the presented results represent a step towards the solution of that problem .",
    "* related work * identification of piecewise - linear ( -affine ) hybrid systems has been subject of intensive research , @xcite .",
    "realization theory for hybrid systems was investigated in @xcite .",
    "the application of hybrid systems to modelling complex dynamical systems , originating from biology , and their identification has been a subject of intensive research @xcite .",
    "the results of this paper are new , to the best of our knowledge .",
    "what distinguishes the contribution of this paper from the existing work is * ( a ) * the system class considered , in particular , the emphasis on continuous - time systems , * ( b ) * the emphasis on realization theory and algorithms , * ( c ) * the details of the identification algorithm .",
    "* outline of the paper *  [ sect : pwl ] presents the formal definition of the system class of interest . ",
    "[ sect : approx ] discusses the relationship between nonlinear systems with complex dynamics and piecewise - affine hybrid systems . ",
    "[ sect : real ] presents the results on realization theory , and  [ sect : ident ] presents the identification algorithm and the results of the numerical experiments .",
    "* notation * we use the standard notation .",
    "we denote by @xmath3 the time - axis .",
    "we denote by @xmath4 the @xmath5 identity matrix .",
    "we denote the set of natural numbers including zero by @xmath6 .",
    "the aim of the section is to define the class of piecewise - linear systems formally .",
    "a _ piecewise - linear system _ ( abbreviated as pwl ) is a dynamical system determined by @xmath7 here @xmath8 is the finite set of discrete modes , @xmath9 is the output space , @xmath10 is the state - space of the system in mode @xmath11 , for each @xmath12 @xmath13 , @xmath14 , @xmath15 , and @xmath16 are the parameters of the affine system in mode @xmath11 , @xmath17  is the set of initial states of the affine system in mode @xmath11 .",
    "the _ state space _ @xmath18 of @xmath19 is @xmath20 we call @xmath19 _ linear _ , if @xmath21 and @xmath22 for all @xmath11 , otherwise @xmath19 is called _ affine_.    we will use the following short - hand notation @xmath23    informally , the evolution of @xmath19 takes place as follows .",
    "as long as the value of the discrete state @xmath24 at time @xmath25 does not change , the continuous state and the continuous output an time @xmath25 change according to the affine system @xmath26 and @xmath27 .",
    "the discrete state can change at any time , however , we do not allow consecutive changes of discrete states immediately one after the other .",
    "if the discrete state changes to @xmath28 at time @xmath25 , then the new continuous state should satisfy @xmath29 , i.e. it should belong to the set of the designated initial states of the new discrete state @xmath28 .",
    "note that we do not specify the mechanism which triggers the change of discrete state .",
    "we also do not specify the initial discrete state , it is chosen by an unspecified mechanism .",
    "hence , the _ description above allows for several state- and output - trajectories . _    note that the definition of * pwl*s presented above differs from the one used in the literature . in the standard definition",
    "it is assumed that after a discrete - state transition , the new continuous state depends on the previous one .",
    "in contrast , here we only require that the new continuous state belongs to the designated set of initial states of the affine system associated with the new discrete state .",
    "this implies that _ the behavior of the system in discrete state @xmath30 depends only on the affine system associated with that discrete state and it does not depend on the discrete modes which were visited in the past .",
    "_ another consequence of the definition is that the model is not predictive .",
    "that is , the knowledge of the system parameters and the inputs does not uniquely determine the state- and output - trajectory of the system . in order to define the evolution of * pwl*s formally , we need to introduce the following notation and terminology .    a time event sequence is a strictly monotone sequence @xmath31 such that @xmath32 , @xmath33 and for all @xmath34 , @xmath35 .",
    "if @xmath36 then we require that @xmath37 .",
    "if @xmath38 , then by convention @xmath39 .",
    "the role of time event sequences is to formalize the time instances at which discrete events occur .",
    "the restrictions formulated in the definition imply that the set of switching times does not have an accumulation point , i.e. no zeno - behavior can take place .",
    "a state - trajectory of @xmath19 is a map @xmath40 such that there exists a time event sequence @xmath41 and a sequence of discrete modes @xmath42 such that for all @xmath43 , @xmath44 , it holds that for all @xmath45 , @xmath46 and @xmath47 the time event sequence @xmath48 is called the sequence of _ switching times _ of the state - trajectory @xmath49 .",
    "we _ denote by @xmath50 the set of all state - trajectories of @xmath19_.    an output - trajectory of @xmath19 is a map @xmath51 such that the following holds . there exists a state - trajectory @xmath49 of @xmath19 , such that @xmath52 for all @xmath53 . here , @xmath54 is the _ readout - map _ of @xmath19 , defined as @xmath55 we _ denote by @xmath56 the set of all output - trajectories of @xmath19_.    in the sequel , unless stated otherwise , _",
    "@xmath57 denotes a function @xmath58_. the definition above implies that the external behavior of a * pwl *  is exactly a function of this type .",
    "the function @xmath57 is said to be realized by * pwl *  @xmath19 , if @xmath59 is an output - trajectory of @xmath19 , i.e. if @xmath60 . in this case",
    "@xmath19 is called a realization of @xmath57 .",
    "the dimension of a * pwl *  @xmath19 is a tuple @xmath61 , where @xmath62 if @xmath19 is linear , and @xmath63 , if @xmath19 is affine .",
    "that is , the first element of @xmath64 is the number of discrete states , the second element is the number of continuous state components .",
    "the additional dimension in the case of affine * pwl*s stems from the need to store the vectors @xmath65 , @xmath66 , @xmath11 .",
    "we use the following partial order relation on @xmath67 .",
    "we say that @xmath68 is smaller than or equal @xmath69 , denoted by @xmath70 , if @xmath71 and @xmath72 .",
    "note that the order relation @xmath73 in @xmath67 is indeed a partial order , it is not possible to compare all elements of @xmath67 .",
    "a * pwl *  @xmath19 is said to be a minimal realization of @xmath57 , if for any * pwl *  @xmath74 which is a realization of @xmath57 , @xmath75 .",
    "the definition above implies that if @xmath19 is minimal , then it is possible to compare its dimension to the dimension of any other realization of @xmath57 .",
    "since we work with a partial order on dimensions , the existence of a minimal system is not at all obvious .",
    "find conditions for existence of a * pwl *  realization of @xmath57 .",
    "characterize minimal * pwl*s  realizations of @xmath57 .",
    "find algorithms for computing a * pwl*s  realization from finite data .",
    "as it was indicated before , our motivation for studying the realization problem for * pwl*s is to lay the theoretical foundations for identification of * pwl*s .",
    "we present below the formulation of the identification problem .",
    "assume that the value of @xmath57 and its derivatives up to order @xmath76 , @xmath77 is measured at time instances @xmath78 .",
    "based on the ( possibly noisy ) data @xmath79 , find a * pwl *  realization of @xmath57 .",
    "our main motivation for studying identification of * pwl*s is the following .",
    "the problem of identifying interaction networks of complex dynamical systems can be reduced to the identification problem of * pwl*s .",
    "indeed , consider a partially observed non - linear system of the form @xmath80 where @xmath81 and @xmath82 are sufficiently smooth functions .",
    "we are interested in the dynamics of the network structure of . by _ the network structure of at time @xmath25 _ we mean the directed graph with nodes numbered by @xmath83 and where an edge goes from node @xmath0 to node @xmath1 if the @xmath0th component of @xmath84 influences the @xmath1th component of @xmath85 . as the values of @xmath84 changes , so does @xmath86 .",
    "hence the network structure described above depends on time .",
    "the basic question of interest is how to derive the dynamics of the interaction network based on the observed output @xmath87 .",
    "one obvious approach is to estimate @xmath57 and @xmath88 from @xmath87 , but this is feasible only if special restrictions are put on @xmath57 and @xmath88 .",
    "notice , however , that if we look at local linearizations of @xmath57 around an equilibrium and the interactions are strong enough , then @xmath89 influences @xmath90 , if the @xmath2th entry of the jacobian of @xmath57 is non - zero . prompted by the considerations above",
    "we propose the following approach to modelling and identification of the network structure of systems of the form .",
    "we assume that has finitely many equilibrium points .",
    "we assume that under influence of noise the system jumps between neighborhoods of these equilibrium points .",
    "we assume that the transition from the neighborhood of one equilibrium point to the neighborhood of another equilibrium point takes place very fast .",
    "hence , the behavior of the system during the transition can be ignored .",
    "we associate a * pwl *  @xmath19 of the form with as follows .",
    "let @xmath91 be the number of equilibrium points . for each @xmath11 ,",
    "let @xmath92 be the corresponding equilibrium point and define @xmath93 here @xmath94 and @xmath95 denote the jacobian of @xmath57 and @xmath88 respectively .",
    "let @xmath96 be a suitably chosen neighborhood of @xmath92 .",
    "it then follows that if the state @xmath84 of is close enough to @xmath92 , we can approximate as follows @xmath97 as it was noted above , the relevant information regarding the interactions of state variables is already included in @xmath98 . hence , _ for the purposes of network reconstructions , identification of the * pwl*s approximation is sufficient_.",
    "below we present some basic results on realization theory of * pwl*s .",
    "first we present a characterization of minimality , after that we present conditions for existence of a realization and a realization algorithm . throughout the section , _",
    "@xmath57 denotes a function @xmath58_.      in order to present our first result , we introduce the notion of a _ linear system with state - jumps_.    a linear system with state jumps , abbreviated as ( * lssj * ) is a linear * pwl *  @xmath19 of the form with one discrete state , i.e. @xmath99",
    ". we will identify the * lssj *  @xmath19 with the collection of data @xmath100 , where @xmath101 and @xmath102 .",
    "the reason we call a * pwl *  with one discrete state a linear system with state jumps is that the system behaves as a linear system , with the exception that its state occasionally jumps back to one of the initial states . for *",
    "lssj*s , we can easily define the concepts of observability and span - reachability .",
    "a * lssj *  @xmath103 is called _ observable _ , if @xmath104 is an observable pair , and @xmath19 is called _ span - reachable _ , if @xmath105 .",
    "[ lssj : min ] note that @xmath106 is an @xmath107 invariant subspace containing @xmath108 , hence by restricting @xmath107 and @xmath109 to @xmath110 we can transform @xmath19 to a span - reachable * lssj *  @xmath111 while preserving output trajectories , i.e. @xmath112 . by applying linear observability reduction , we can transform the * lssj *  @xmath111 to a * lssj *  @xmath113 which is span - reachable , observable and has the same output trajectories as @xmath19 , i.e. @xmath114 .    [ phas : min ] assume that @xmath57 admits a realization by a * pwl*. then @xmath57 admits a minimal * pwl *  realization @xmath19 such that @xmath19 is a span - reachable and observable * lssj*. a * lssj *  realization of @xmath57 is minimal if and only if it is span - reachable and observable .",
    "the theorem above says that in general , the external behavior of any * pwl*s can be represented by a linear system with several initial states .",
    "that is , without further restrictions , the realization and identification problems for * pwl*s are equivalent to that of * lssjs*.    the proof of theorem [ phas : min ] relies on the following transformations .    [ pahs2linpahs ] define the _ linear _ * pwls *  @xmath115 associated with an affine @xmath19 as follows .",
    "@xmath116 where @xmath117 , @xmath118 , @xmath119 and @xmath120    the output trajectories of @xmath19 and @xmath115 coincide , i.e. @xmath121 , and @xmath122 .",
    "a state trajectory @xmath49 of @xmath115 is always a map of the form @xmath123 , @xmath53 such that @xmath124 , @xmath53 is a state - trajectory of @xmath19 . since @xmath125 , the statement of the proposition follows .",
    "let @xmath19 be a linear * pwl *  of the form .",
    "define the * lssj *  @xmath126 associated with @xmath19 as follows .",
    "@xmath127 where @xmath62 and @xmath128    the output trajectories of @xmath19 and @xmath126 are the same , i.e. @xmath129 , moreover , @xmath130 where @xmath131 .    for each @xmath11 ,",
    "let @xmath132 be the subset of @xmath133 of the form @xmath134 , @xmath135 .",
    "for each @xmath136 of the above form , let @xmath137 .",
    "it then follows that @xmath138 is a state - trajectory of @xmath126 if and only if @xmath139 is a state - trajectory of @xmath19 , where @xmath140 for some @xmath11 if and only if @xmath141 . since @xmath142 for all @xmath143 , the statement of the proposition follows",
    ".    using the two transformations defined above , and remark [ lssj : min ] , we can present the proof of theorem [ phas : min ] .",
    "assume that @xmath19 is a * pwl *  realization of @xmath57 .",
    "if @xmath19 is affine , then replace @xmath19 with the associated linear * pwl *  @xmath115 , which is also a realization of @xmath57 .",
    "hence , we can assume that @xmath19 is already a linear * pwl*. construct then the * lssj *   @xmath126 associated with @xmath19 and apply remark [ lssj : min ] to @xmath126 to obtain a span - reachable and observable * lssj *  @xmath113 such that @xmath144 .",
    "it then follows that @xmath145 .",
    "hence , since @xmath19 was arbitrary , it is enough to look for minimal realizations among span - reachable and observable * lssj*s .",
    "notice that for any two * lssj*s  @xmath146 and @xmath147 , either @xmath148 or @xmath149 , hence , among all the possible * lssj*s  realizations of @xmath57 , there must exist a minimal one .",
    "the conditions for existence of a realization will be formulated using the rank of the hankel - matrix of @xmath57 . in order to define the hankel - matrix of @xmath57 , we have to define the notion of markov - parameters .",
    "to that end , we need the notion of _ piecewise - analytic functions_.    the map @xmath57 is called _ piecewise - analytic _ , if there exist a finite or infinite number of time instances , @xmath150 , @xmath151 , @xmath152 , @xmath44 for some @xmath153 , such that the following holds . if @xmath154 , let @xmath155 .",
    "then we require that @xmath33 and @xmath156 and for each @xmath44 , @xmath152 , @xmath57 is analytic on @xmath157 , but @xmath57 is not analytic on any neighborhood of @xmath158 in @xmath159 .",
    "we call the points @xmath160 the points of _ non - analyticity_. we define the set @xmath161 of indices of points of non - analyticity .    the intuition behind the definition is as follows . if @xmath57 has a realization by a * pwl *  @xmath19 , then the only points where @xmath57 is not analytic are the points where the corresponding state - trajectory of @xmath19 switches from one discrete mode to another .",
    "in fact , one can show that there always exists a state - trajectory of @xmath19 which yields @xmath57 as output trajectory and which switches only at time instances at which @xmath57 is not analytic .",
    "hence , if @xmath57 has a realization by a * pwl * , then @xmath57 is piecewise - analytic and the points of non - analyticity tell us the switching times of a * pwl *  realization of @xmath57 .    in the sequel , _",
    "@xmath57 is assumed to be piecewise - analytic_.    assume that @xmath57 is piecewise - analytic and let @xmath160 be the points of non - analyticity of @xmath57 .",
    "for each @xmath162 , define the @xmath0th _ markov - parameter _",
    "@xmath163 of @xmath57 as a sequence @xmath164 @xmath165    it is easy to see that the collection of markov - parameters @xmath166 determines the map @xmath57 uniquely .",
    "we use the markov - parameters to define the hankel - matrix of @xmath57 .",
    "we define the _ hankel - matrix _ @xmath167 of @xmath57 as the infinite matrix , rows of which are indexed by @xmath168 , and columns of which are indexed by @xmath169 .",
    "the entry of @xmath167 indexed by row index @xmath170 and by column index @xmath171 equals @xmath172_{(i , r),(j , l)}=(\\mathbf{m}_{l}^f(i+j))_{r}\\ ] ] where @xmath173 denotes the @xmath76th entry of markov - parameter @xmath174 .",
    "the rank of @xmath167 , denoted by @xmath175 , is the dimension of the linear space spanned by the columns of @xmath167 .",
    "[ theo : ex ] the map @xmath57 can be realized by a * pwl *  if and only if it is piecewise - analytic and @xmath176 .",
    "moreover , a minimal * lssj *  realization of @xmath57 of dimension @xmath177 can be constructed from @xmath167 .    * only if  * assume that @xmath57 can be realized by a * pwl*. then it can be realized by a * lssj *  @xmath103 .",
    "then @xmath178 @xmath179 for some @xmath180 , i.e. @xmath181 are the markov - parameters of the linear system @xmath104 from some initial condition .",
    "it then follows from linear systems theory that @xmath182 .    *",
    "if  * assume that @xmath183 and fix a basis in the linear span of the columns of @xmath167 .",
    "define @xmath109 as the matrix in this basis of the linear map which maps a column to the vector formed by the rows of that column indexed by @xmath184 , in this order .",
    "define the matrix @xmath107 as the matrix in this basis of the linear map which maps the column indexed by @xmath171 to the column indexed by @xmath185 .",
    "finally , let @xmath108 be the set of coordinate vectors of the columns of @xmath167 indexed by @xmath186 , @xmath187 .",
    "then @xmath188 is a * lssj *   realization of @xmath57 . if @xmath19 is another * lssj *  realization of @xmath57 , then from the * only if * part it follows that @xmath189 , i.e. @xmath190 is a minimal realization of @xmath57 .    in algorithm [ alg0 ]",
    "we present a kalman - ho - like realization algorithm for * lssj*s  and hence * pwl*s . to this end , we need the following definition .",
    "[ def : part ] fix integers + @xmath191 .",
    "define the set @xmath192 define the submatrix @xmath193 of @xmath167 as the matrix which is formed by the intersection of the rows of @xmath167 indexed by the elements of @xmath194 and the columns of @xmath167 indexed by the elements of @xmath195 .",
    "compute the decomposition @xmath196 such that @xmath197 and @xmath198 and @xmath199 .",
    "define @xmath200 as the matrix formed by the columns of @xmath201 indexed by elements of @xmath202 .",
    "let @xmath203 the matrix such that the column of @xmath204 indexed by @xmath171 equals the column of @xmath201 indexed by @xmath185 .",
    "define @xmath205 as follows .",
    "* the @xmath0th row of @xmath109 equals the row of @xmath206 indexed by @xmath207 , @xmath208 . *",
    "the matrix @xmath107 is the solution of the equation @xmath209 * the set @xmath108 consists of the columns of @xmath201 indexed by indices of the form @xmath186 , @xmath210 .",
    "[ alg0:theo ] if @xmath211 , and @xmath212 , then for some @xmath213 , the * lssj *  returned by algorithm [ alg0 ] is a minimal realization of @xmath57 .",
    "the conditions above hold if @xmath57 has a realization by a * lssj *  of dimension at most @xmath214 and with a finite set of initial states .",
    "the results on realization theory of * pwl*s indicate that the realization and identification problems for * pwl*s are in general ill - posed in the following sense .",
    "realizability by a * pwl*s is equivalent to realizability by a minimal * pwl*s with one single discrete state .",
    "hence , there seems to be no intrinsic way to choose discrete states based on the data .",
    "since the original intention was use the combination of the dynamics in various discrete modes to explain complex dynamics , the above conclusion is an unpleasant one .",
    "note that the main problem is that one can increase the dimension of the continuous state - space to encode discrete states .",
    "one way to remedy this is to place restriction on the dimension . to this end ,",
    "we introduce the notion of @xmath215 realization .",
    "a * pwl *  @xmath19 is said to be a @xmath215 * pwl * if @xmath19 is of the form and @xmath216 and for all @xmath11 , @xmath217 .",
    "the map @xmath57 is said to admit a @xmath215 realization , if there exists a @xmath215 * pwl *  which is a realization of @xmath57 .",
    "the motivation for using @xmath215 realizations is that by choosing an appropriate @xmath218 , we can make sure that the growth in the number of continuous states can not be used to replace discrete states .",
    "below we present conditions for existence of a @xmath215 realization of @xmath57 . to this end , we have to introduce the following concept .",
    "consider the partitioning @xmath219 of the set of @xmath220 . for each @xmath221 ,",
    "let @xmath222 be the sub - matrix of hankel - matrix @xmath167 which is formed by the columns of @xmath167 indexed by indices of the form @xmath171 , @xmath223 and @xmath224 .",
    "[ theo : pos1 ] the map @xmath57 has a realization by a linear @xmath215 * pwl * if and only if there exists a partitioning @xmath225 of @xmath226 with @xmath227 such that for all @xmath228 , @xmath229 . if the latter condition holds , then @xmath19 can be computed from @xmath167 with @xmath8 and with @xmath230 for all @xmath11 .",
    "theorem [ theo : pos1 ] above says that @xmath57 can be realized by a @xmath215 realization if the columns of the hankel - matrix @xmath167 can be divided in @xmath231 clusters such that for each fixed @xmath232 , all columns indexed by @xmath233 end up in the same cluster .",
    "moreover , the linear span of the elements of each cluster should have dimension at most @xmath218 .    in order to prove theorem [ theo : pos1 ] , we need the following transformation of a * lssj *  to a @xmath215 realization .    [ lss2pwls ] consider a partition @xmath234 of @xmath220 for some @xmath235 .",
    "consider an observable * lssj *  @xmath236 such that @xmath237 is a realization of @xmath57 .",
    "then there exists a unique state trajectory @xmath49 of @xmath237 , such that the switching times of @xmath49 coincide with the points of non - analyticity @xmath238 of @xmath57 and @xmath239 for all @xmath53 .",
    "define the * pwl *  realization @xmath240 of @xmath57 _ associated with @xmath237 and @xmath241 _ as follows .",
    "the * pwl *  @xmath240 is of the form , such that @xmath242 , and    * for all @xmath11 , let @xmath243 be the set of states @xmath244 such that for some @xmath224 , @xmath245 .",
    "define @xmath246 set @xmath247 and choose a basis of @xmath132 .",
    "* for each @xmath11 , define @xmath98 as the matrix in the basis of @xmath132 of the linear map @xmath248 obtained by restricting @xmath107 to @xmath132 .",
    "* let @xmath96 be the set of vector representations in the basis of @xmath132 of the elements of @xmath243 .",
    "* let @xmath249 be the matrix representation in the basis of @xmath132 of the linear map @xmath250 obtained by restricting @xmath109 to @xmath132 .",
    "if @xmath237 is a * lssj *  realization of @xmath57 , then the * pwl *  @xmath240 is a realization of @xmath57 .    * only if  * assume that @xmath19 is a * pwl *  realization of @xmath57 of the form , such that @xmath216 and @xmath217 for all @xmath11 .",
    "then there exists a state trajectory @xmath49 of @xmath19 such that @xmath251 and the switching times of @xmath49 contain the points of non - analyticity @xmath238 of @xmath57 .",
    "define @xmath252 .",
    "it then follows that @xmath253 is a partitioning of @xmath220 .",
    "moreover , for any @xmath254 , @xmath255 is the markov - parameter of the linear system @xmath256 from some initial condition .",
    "hence , by using linear systems theory we can show that @xmath257 .",
    "* if  * if the conditions of the theorem hold , then @xmath258 .",
    "construct the * lssj *  realization @xmath190 of @xmath57 , as in the proof of theorem [ theo : ex ] .",
    "apply definition [ lss2pwls ] to obtain a linear * pwl *  @xmath259 .",
    "then @xmath19 has @xmath227 discrete states .",
    "notice that the space @xmath132 from definition [ theo : pos1 ] is then isomorphic to the column space of @xmath222 , @xmath260 .",
    "hence @xmath261 .",
    "similarly to the general case , in algorithm [ alg05 ] we state an algorithm for computing a @xmath215 realization of @xmath57 .    apply algorithm [ alg0 ] to @xmath262 and denote the result by @xmath263 .",
    "[ alg05:clust ] compute a partitioning @xmath225 of @xmath264 such that @xmath227 and for all @xmath228 , @xmath265 . here",
    "@xmath266 is the sub - matrix of @xmath193 formed by the columns @xmath171 where @xmath267 and @xmath268 .",
    "return the * pwl *  @xmath269 .",
    "[ alg05:theo ] if @xmath57 has a @xmath215 realization of dimension at most @xmath270 , and and with a finite set of initial states , then for some @xmath213 , algorithm [ alg0 ] returns a minimal realization of @xmath57 .      below",
    "we show that @xmath57 is realizable by a * pwl *   if and only if @xmath57 satisfies a switched ar model .    a _",
    "switched ar system _ ( abbreviated as * sars * ) is a tuple @xmath271 where @xmath8 , @xmath272 , @xmath273 and @xmath274 for all @xmath275 .",
    "the function @xmath57 is said to satisfy the * sars *  model @xmath276 , if the following holds .",
    "let @xmath238 be the points of non - analiticity of @xmath57 .",
    "for any @xmath162 , and for any @xmath277 , denote by @xmath278 the @xmath279th order right - hand derivative @xmath280 . then we require that for any @xmath281 there exist @xmath282 , such that @xmath283 , @xmath284 the set @xmath285 is called the set of discrete modes of @xmath276 .",
    "notice that if @xmath99 , then the * sars *  @xmath276 corresponds to an ar system , and @xmath57 satisfies @xmath276 if it satisfies an ar equation .",
    "note , however , that in contrast to trajectories of an ar systems , @xmath57 is not smooth .",
    "[ sars : theo ] the function @xmath57 has a realization by a * pwl *  with @xmath91 discrete states if and only if there exists a * sars *  @xmath276 with @xmath91 discrete modes such that @xmath57 satisfies @xmath276 .    * only if  * let @xmath19 be a realization of @xmath57 . without loss of generality we can assume that @xmath19 is linear , it is of the form and @xmath286 for all @xmath11 .",
    "then for each @xmath162 , there exists @xmath282 such that on @xmath157 , @xmath57 is an output trajectory of the linear system @xmath287 . from classical theory",
    "we then know that there exists matrices @xmath288 such that holds . * if  * assume @xmath57 satisfies a * sars *  @xmath276 of the form .",
    "define the linear * pwl *  @xmath289 of the form such that @xmath289 is a realization of @xmath57 as follows .",
    "the sets of discrete modes of @xmath289 and @xmath276 coincide , @xmath286 , @xmath290 and the matrices @xmath249 and @xmath291 , @xmath11 are the matrices of the linear system which corresponds to the ar @xmath292 . here",
    "we consider the linear system , state vector of which is the regressor @xmath293 .",
    "theorem [ phas : min ] and theorem [ sars : theo ] yield the following .",
    "the function @xmath57 has a realization by a * pwl *  if and only if it satisfies an ar system , i.e. for some @xmath294 , @xmath295 , @xmath296",
    "below we present an algorithm which computes a realization with full observations based on measurements at finitely many time instances .",
    "more precisely , the algorithm solves the following problem .",
    "[ ident : full_obs ] fix integers @xmath272 and @xmath295 .",
    "consider a piecewise - analytic function @xmath297 and a finite sequence of time instances @xmath298 and assume that @xmath299 are known , i.e. we know that value of @xmath57 and its derivative at time instances @xmath300 .",
    "find a * pwl *  @xmath19 of the form with full - observations such that @xmath19 realizes @xmath57 , and @xmath301 , @xmath21 , and @xmath286 for all @xmath11 .",
    "* motivation of the identification problem * the motivation for considering the identification problem with full observations is the following .    1 .",
    "notice that the identification problem with full observations and the identification problem for * sars*s are equivalent .",
    "indeed , a * pwl *  with full observation can be considered as a * sars*s with @xmath302 .",
    "conversely , for a * sars *  @xmath276 , the associated * pwl *  @xmath289 from the proof of theorem [ sars : theo ] can be viewed as a * pwl *  with full observations , if the high - order derivatives of @xmath57 can be measured .",
    "hence , by theorem [ sars : theo ] , _ the identification problem for * pwl*s is equivalent to the identification problem for * pwl *  with full observations _",
    ", if we assume that high - order derivatives of the output can be measured too .",
    "the problem of identification with full observations is still a non - trivial problem . even in this case",
    "we have problems with identifiability , see example [ example1 ] .",
    "3 .   the solution of problem [ ident : full_obs ] enables us to prove experimentally the feasibility of approximating complex systems by * pwl*s .",
    "this is done by applying the identification algorithm which solves problem [ ident : full_obs ] to simulated trajectories of several well - known complex systems .",
    "[ example1 ] consider the * lssj*s @xmath303 and @xmath304 where @xmath305 is the identity matrix and @xmath306 and the remaining parameters are as follows ; @xmath307 and @xmath308 .",
    "it then follows that @xmath309 , @xmath53 can be realized both by @xmath146 and @xmath147 , but clearly @xmath310 . in other words ,",
    "_ realizations of @xmath57 with full observation are not identifiable . _",
    "the reason for this phenomenon is that the state of both @xmath146 and @xmath147 live in the subspace @xmath311 , @xmath312 , hence the difference in @xmath313 and @xmath314 is not visible .",
    "there is a wealth of results on identification of * sars * , mostly addressing the discrete - time siso case .",
    "many of these results , in particular , the algebraic approach @xcite could probably be adapted to the system class of this paper .",
    "investigating such adaptations remains a topic of future research .",
    "note that it is not at all clear that the convergence results for the discrete - time case have meaningful counterparts in the continuous - time case .",
    "in algorithm [ alg2 ] we present a solution for solving problem [ ident : full_obs ] .",
    "algorithm [ alg2 ] is an iteration consisting of the following steps .",
    "first , the algorithm starts with a random initialization of @xmath315 .",
    "subsequently , in each iteration step , the current estimates @xmath316 are updated by applying first the step [ alg : pwl-1 ] for estimating the updated weights with the fixed system parameters @xmath317 , and then applying step [ alg : pwl-2 ] with the previously updated weights @xmath318 for updating the estimates of the system parameters @xmath317 .",
    "the interpretation of the weights is as follows : @xmath319 is one if in @xmath158 the discrete state @xmath11 is active , and it is zero otherwise .",
    "the algorithm terminates when an absolute criterion @xmath320 falls below a pre - specified threshold @xmath321 .",
    "the iteration fails if after a pre - defined maximum number of iterations @xmath322 the criterion @xmath320 has not yet reached the lower threshold @xmath321 .",
    "unfortunately , the conditions under which the algorithm terminates and returns a correct realizations are not known yet .",
    "the criterion @xmath320 of the algorithm always decreases or stays the same during the iterations , and the same holds for the cost functions in step [ alg : pwl-1][alg : pwl-2 ] . hence , the criterion @xmath320 and the cost functions in step [ alg : pwl-1][alg : pwl-2 ] will converge to a fixed value . whether this value is a global optimum",
    "remains a topic of future research .",
    "note that the true parameters of a realization of @xmath57 render @xmath320 zero , but there might be many of them , see example [ example1 ] .",
    "initialize the estimates of @xmath323 , @xmath324 , @xmath325 .",
    "[ alg : pwl-1 ] solve the optimization for the weights @xmath326               \\end{split}\\ ] ] where for @xmath327 , @xmath328 , @xmath329 , @xmath11 , @xmath330    note that the optimization problem above is a linear programming problem , hence the optimal values of @xmath331 take values in the set @xmath332 .",
    "[ alg : pwl-2 ] using the weights @xmath331 recalculate the optimal values of @xmath333 , @xmath11 by solving the following minimization problem . @xmath334",
    "the optimization problem is equivalent to the following linear least squares problem .",
    "collect the unknowns @xmath333 , @xmath11 into the matrix @xmath335 @xmath336 define the matrices @xmath337 and @xmath338 @xmath339 then the solution of can be read off from the entries of @xmath335 , where @xmath340    update @xmath341 using the new values .",
    "return @xmath19 of the form with @xmath286 , @xmath301 , @xmath21 and @xmath342 as computed in the last iteration , for all @xmath11 , and @xmath343 for all @xmath11 .",
    "we conducted several numerical experiments .",
    "they were all performed on a pc with intel pentium 4 cpu 2.8 ghz processor and 1.21 gb ram memory under windows xp , using matlab 7.5 including the optimization toolbox . in line with the definitions",
    "above , we use @xmath231 and @xmath218 to quantify the dimension of the * pwl *  of interest and @xmath344 to denote the number of data points .",
    "dynamical data @xmath299 was sampled from a given dynamical model @xmath345 at regular time intervals @xmath346 , @xmath347 for some @xmath348 .",
    "several initial states were chosen randomly , and a sampled trajectory was obtained for each of them .",
    "we then concatenated these sampled trajectories into one time series .",
    "notice that concatenation of finite components of two output trajectories of a * pwl *  is itself a finite component of a valid output trajectory .",
    "hence , the combined data can be viewed as originating from the measurements of one valid output trajectory of a * pwl*. gaussian noise with zero mean and variance @xmath349 was added to the obtained data .",
    "finally , algorithm [ alg2 ] was applied to the resulting data . in the numerical experiments we first tested the performance of the algorithm on artificial * pwl *  systems .",
    "furthermore , we studied the algorithm on lorenz systems and on the tyson - novak model for the cell cycle of budding yeast .",
    "we generate an artificial * pwl *  system containing @xmath231 affine subsystems , each of the same dimension @xmath350 .",
    "the state switching is obtained by partitioning the state space in @xmath231 subsets @xmath351 .",
    "the switching is generated by using the following switching law : the discrete mode @xmath0 is active , if the continuous state belongs to @xmath352 . in the absence of noise , and if the subsystems are sufficiently sampled , the estimation algorithm is usually able to find the system parameters , though occasionally it gets stuck in a local minimum .",
    "the amount of empirical data required to reconstruct the system parameters , within the bounds set by the noise , increases proportionally with @xmath218 and @xmath231 .",
    "figure [ n1 ] below shows the result of the algorithm for @xmath353 , @xmath354 , @xmath355 data points .",
    "the voronoi partitioning of state space of the original dataset ( black ) and the reconstructed dataset ( red ) are identical .",
    "the reconstructed system parameters and the original system parameters are identical as well .    ]",
    "further tests reveal that algorithm [ alg2 ] is able to find the correct parameters even if the regions @xmath351 are disconnected .",
    "when applying zero - mean gaussian noise @xmath356 , the accuracy of the reconstruction decreases as @xmath357 increases .",
    "figure [ n3 ] below shows the result on a dataset of dimension @xmath353 with @xmath354 subsystems and @xmath355 data points with a snr ( signal - to - noise ratio ) of @xmath358 .",
    "two subsystems could not be reconstructed , but the correlation between the three reconstructed systems with the best fitting original subsystems is @xmath359    ]      we applied algorithm [ alg2 ] to lorenz systems @xcite .",
    "this example provides insight how the identification algorithm performs on systems that are not piecewise affine by nature .",
    "the lorenz attractor can be visualized approximately as consisting of two linear subsystems ` left ' and ` right ' , with two different central attractors .",
    "a third region can be defined that involves the transition between the left and right subsystem . in figure [ n4 ]",
    "the application of algorithm [ alg2 ] to lorenz systems with @xmath360 data points is presented for @xmath361 . for @xmath362",
    "the two main parts of the lorenz attractor are found .",
    "for @xmath363 also the transition region from the left to the right attractor is found . applying more than @xmath364 subsystems",
    "does not improve the performance .",
    ", title=\"fig : \" ] , title=\"fig : \" ]      we applied algorithm [ alg2 ] to data simulated using the tyson - novak model @xcite for the yeast cell cycle .",
    "the cell cycle is the succession of events whereby a cell grows and divides into two daughter cells .",
    "the simulated data was used to construct a * pwl *  approximation of the system using algorithm [ alg2 ] .",
    "this resulted in a clear partition of the cell cycle dynamics as a function of the selected number of classes @xmath231 .",
    "the best qualitative results were obtained for @xmath362 , see figure [ n6-a ] . moreover , for @xmath365 the results did not improve .",
    "it was found that the obtained two discrete modes correspond to the phases _ s _ ( dna synthesis ) and _ m _ ( mitosis ) of the cell cycle .",
    "the reconstruction remains valid under noise with snr at most @xmath366 .    ]",
    "we presented some basic results on realization theory of * pwl*s and a practical identification algorithm .",
    "analysis of the correctness and convergence of the presented algorithm remains a topic of future research .",
    "bako , l. , mercre , g. , vidal , r. , and lecoeuche . , s. ( 2009 ) . identification of switched linear state space models without minimum dwell time . in _",
    "ifac symposium on system identification , saint malo , france_.                              ma , y. and vidal , r. ( 2005 ) .",
    "identification of deterministic switched arx systems via identification of algebraic varieties . in _",
    "hybrid systems : computation and control _ , volume 3414 of _ lncs _ , 449  465 ."
  ],
  "abstract_text": [
    "<S> the paper address the realization and identification problem for a subclass of piecewise - affine hybrid systems . </S>",
    "<S> the paper provides necessary and sufficient conditions for existence of a realization , a characterization of minimality , and an identification algorithm for this subclass of hybrid systems . </S>",
    "<S> the considered system class and the identification problem are motivated by applications in systems biology .    ,    realization theory , minimization , identification , hybrid systems , network topology , gene - protein networks . </S>"
  ]
}