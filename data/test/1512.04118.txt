{
  "article_text": [
    "articulated pose estimation from a static image remains a challenge in computer vision .",
    "the difficulty lies in the wide variations in the appearance of object due to articulated deformations .",
    "therefore , an effective method generally relies on strong appearance models and expressive spatial models to capture the variations .",
    "more importantly , these models should be incorporated into a sensible framework where correct poses do enjoy relatively high likelihood .",
    "there has been great progress in developing appearance and spatial models .",
    "histogram of gradient ( hog )  @xcite was widely used as the part descriptor .",
    "however , hog is rather weak and introduces visual ambiguities  @xcite .",
    "recently , deep convolutional neural networks ( dcnns ) have demonstrated excellent performance in building appearance models for object detection  @xcite and human pose estimation  @xcite .",
    "compared with a shallow classifier with hand - crafted features , dcnns have the capacity of learning more discriminative features .    as for the spatial models , tree - structured model wins popularity by enjoying a simplified representation of object shape . in this model ,",
    "parts are connected with tree edges modeled as elastic springs . on top of such model , various formulations have been proposed .",
    "@xcite designed pictorial structure to combine appearance and spatial terms in a generative way .",
    "discriminatively trained method is more powerful , and easily adapts to extended deformable part models ( dpms ) with mixture of parts  @xcite and hierarchical representations  @xcite .",
    "there are efforts to go beyond the tree structure :  @xcite proposes a loopy model that contains composite parts implemented by poselets  @xcite ;  @xcite treat all the other parts as the neighbors of a target part ; grammar model has also been proposed to generalize the tree structure  @xcite .    as nonparametric spatial models , exemplars are also effective in part localization problems  @xcite , as an ensemble of labeled samples ( i.e. , exemplars ) literally capture plausible part configurations without assuming the distribution of part relations .",
    "however , the exemplar - based models have not shown much efficacy in human pose estimation due to degraded expressiveness of limited training samples  @xcite .    in our work",
    ", we improve the expressiveness of exemplar - based models by leveraging hierarchy and composite parts : each composite part is treated as an object , with exemplars dictating the configuration of its child parts . by doing so , we obtain exemplar - based models covering a spectrum of granularity . in addition , we propose a novel formulation that captures the interactions between object parts in two aspects : spatial relations between parts at the same granularity level are inferred by dcnns ( inspired by  @xcite ) , and constrained by exemplar - based models at that level ; spatial relations between parts at different levels follow the parent - child relations in the hierarchy , which are well maintained in the bottom - up inference through exemplars .",
    "these efforts together allow us to only model the part relations in each layer via dcnns without impairing the strength of the method . in some sense , our formulation is tailored for exemplar - based inference , which differs from other hierarchical models such as multi - layer dpms .",
    "also note that we use grouped parts to optimize the individual parts jointly , which differs from  @xcite .",
    "our method features a hierarchical representation of object",
    ". we will first describe the relevant notations and introduce hierarchical exemplars .",
    "then we will explain our formulation of pose estimation . in the end",
    ", a comparison with relevant techniques will be addressed .      a hierarchical object ( exemplar )",
    "contains two types of parts : _ atomic part _ and _ composite part_. an atomic part @xmath0 is at the finest level of granularity , and can be annotated as a keypoint with pixel location @xmath1 ( e.g. , elbow ) .",
    "a composite part @xmath2 is the composite of its child parts ( e.g. , arm = \\{sholder , elbow , wrist } ) , and is denoted as a tight bounding box @xmath3 containing all the child parts inside . in our work ,",
    "a _ part configuration _",
    "@xmath4 is denoted as the locations of atomic parts @xmath5 $ ] where @xmath6 is the total number of atomic parts .",
    "now , we define the _ spatial relation _ between parts of the same type . for atomic parts",
    "@xmath0 and @xmath7 , their offset @xmath8 characterizes the relation @xmath9 ( e.g. , shoulder is @xmath10 pixels above the elbow ) . for composite parts @xmath2 and @xmath11 , we first assign anchor points @xmath12 and @xmath13 to them .",
    "anchor points are manually determined such that they are relatively rigid w.r.t the articulated deformation .",
    "then we represent the relation @xmath14 as @xmath15 $ ] , where @xmath16 and @xmath17 are the top - left and bottom - right corners of part bounding box ( please see fig .  [",
    "fig : instant](a ) ) .",
    "the hierarchical representation follows a tree structure , as shown in fig .",
    "[ fig : instant](a ) .",
    "each leaf node denotes an atomic part .",
    "a node @xmath2 at level @xmath18 corresponds to a composite part @xmath19  the union of its children at level @xmath20 which are denoted as @xmath21 .",
    "the degree of the tree is not bounded , and the structure of the tree depends on the particular object category .",
    "a general rule is : geometrically neighboring parts ( at the same level ) can form a part at an upper level if their spatial relations can be captured by the training data .",
    "[ fig : instant](b ) shows the instantiation of hierarchical representation for human and bird .",
    "as the bird body is relatively more rigid than the human body , the degrees of bird s internal nodes can be larger , resulting in fewer levels .",
    "the exemplars in previous works  @xcite correspond to a depth-2 hierarchy , where all the atomic parts are the children of the unique composite part ( i.e. , root part ) . as a result",
    ", each exemplar models the relations between all the atomic parts , making the ensemble of training exemplars not capable of capturing unseen poses .",
    "our hierarchical exemplars , however , adapt to a hierarchy with larger depth which gives us multiple composite parts . by treating each composite part as a standalone object",
    ", we have exemplars only modeling the spatial relations between its child parts ( which are referred to as part pose ) .",
    "we use @xmath22 to denote the set of exemplar - based models for all the composite parts , where @xmath2 is the index , and @xmath23 denotes the level . by design ,",
    "the hierarchical exemplars cover a spectrum of granularity with proper decomposition of the object , which dramatically improves the expressiveness of exemplars .",
    "note that the depth had better not go too large , as we still want to make use of the strength of exemplars in constraining the configurations of more than two parts .",
    "we define an energy function to score a configuration @xmath4 given an image @xmath24 and the spatial models @xmath25 : @xmath26 where @xmath27 is the appearance term , @xmath28 is the spatial term , and @xmath29 is the bias parameter . our goal is to find the best configuration @xmath30 .",
    ", @xmath14 ) between sibling parts .",
    "the black dots on level @xmath31 denote the anchor points .",
    "( b ) the instantiations of part hierarchy on human and bird .",
    "the part levels increase from the left to the right .",
    "each figure shows the parts at the same level with the same color ( except for the atomic parts ) .",
    "immediate children are also plotted for level @xmath31 and above .",
    "the stars mark the anchor points for the composite parts . ]",
    "* appearance terms : * @xmath32 is a weighted combination of the detection scores for each atomic part : @xmath33 where @xmath34 is the weight parameter , @xmath35 scores the presence of part @xmath0 at the location @xmath1 based on the local image patch ( eq .  [ eq : app_level1 ] ) , and @xmath36 denotes the level-@xmath37 scaling factor based on @xmath4 s size . as we use sliding - window paradigm for detection , the local image patch is expected to fit the object size and the part s level .    * spatial terms : * we design multi - level spatial terms to evaluate the part relations .",
    "assuming there are @xmath38 levels in the object hierarchy , and there are @xmath39 parts at the @xmath23-th level , then @xmath40 is defined as @xmath41 where @xmath42 denotes the bounding box of part @xmath19 , @xmath43 denotes the pose of @xmath19 , @xmath44 denotes the corresponding spatial models , and @xmath45 scores @xmath43 based on both appearance and spatial models . note that @xmath43 is defined as the spatial relations between the children of @xmath19 .",
    "we now elaborate the derivation of @xmath45 . using exemplar - based models",
    ", we can assume @xmath44 contains @xmath46 exemplars @xmath47 , each of which dictates a particular pose @xmath48 ( e.g. , an example of raised arm ) . here",
    ", we drop the subscript @xmath2 and superscript @xmath23 for clarity . with these in hand",
    ", we evaluate @xmath45 as the combination of two terms : @xmath49 where @xmath50 and @xmath51 are the weight parameters , @xmath52 ( corresponding to exemplar @xmath53 ) is the pose that best fits @xmath43 .",
    "@xmath54 evaluates the likelihood of pose @xmath52 being present in the image region at @xmath42 ( eq .  [ eq : app_level2 ] ,  [ eq : app_level2plus ] ) .",
    "the relevant image patches also need to be resized as eq .",
    "[ eq : app_score ] .",
    "@xmath55 measures the similarity between @xmath43 and @xmath52 as @xmath56 where @xmath57 denotes the operation of similarity transformation ( the rotation angle is constrained ) , @xmath58 denotes the vectorized locations of parts @xmath21 in @xmath4 , and @xmath59 denotes the vectorized @xmath53 .    as multi - scale image cues and multi - level spatial models",
    "are both involved , @xmath45 covers part relations at different levels of granularity .",
    "for instance , at a fine scale ( small @xmath23 ) , it evaluates whether the arm is folded ; at a coarse scale ( large @xmath23 ) , it evaluates whether the person is seated .",
    "we make independence assumption on the spatial models in eq .",
    "[ eq : geo_score ] , which can benefit articulated pose estimation .",
    "the reason lies in that it gives us a collection of spatial models that can better handle rare poses .",
    "for instance , our models allow a person to exhibit arbitrarily plausible poses at either arm as long as the spatial relations between the two arms are plausible . with such assumption , our formulation still captures the part relations thoroughly and precisely : the relations between sibling parts are encoded explicitly in eq .",
    "[ eq : geo_term ] ; the relations between parent and child parts are implicitly enforced ( the same @xmath4 is referred to across the levels ) .",
    "below , we address the differences between our method and relevant techniques , such as image dependent spatial relations  @xcite and hierarchical models  @xcite :    * unlike  @xcite , our method infers from the image the spatial relations between atomic parts ( e.g. , elbow and shoulder ) , as well as the relations between composite parts ( e.g .. upper body and lower body ) .",
    "* unlike  @xcite , we do not conduct the selection of spatial models upfront as errors in this step are hard to correct afterwards . instead , our selection of spatial models is based on the configuration under evaluation ( the second term in eq .",
    "[ eq : geo_term ] ) , which avoids pruning the model space too aggressively .",
    "* unlike  @xcite , our method directly optimizes on the atomic part locations , avoiding the interference from localizing the composite parts .",
    "also , we turn to exemplars to constrain the part relations , rather than using piece - wisely stitched `` spring models '' .",
    "the optimization of eq .  [ eq : overall_opt ] does not conform to general message passing framework due to the dependency of @xmath52 on @xmath4 ( eq .  [ eq : geo_term ] ) and the interactions between variables @xmath60 across multiple levels ( eq .  [ eq : geo_score ] ) .",
    "therefore , we propose an algorithm ( algorithm  [ alg : opt ] ) which simplifies the evaluation of eq .",
    "[ eq : geo_score ] .",
    "although being approximate , the algorithm is efficient and yields good results . in the following sections , we explain the two major components of the algorithm .",
    "the first component is _ hypothesize and test _ , which leverages a ransac - like procedure of exemplar matching . for this , we rewrite eq .",
    "[ eq : geo_score ] in a recursive form which scores the subtree rooted at @xmath42 ( @xmath61 ) : @xmath62 note that @xmath63 for any @xmath2 . by comparing eq .",
    "[ eq : recur_score ] with eq .",
    "[ eq : geo_score ] , we can see that @xmath64 .",
    "_ hypothesize and test _ is conducted in a bottom - up manner : ( 1 ) given the hypothesized locations of all the parts at level @xmath20 ( each part has multiple hypotheses ) , transform the exemplars at level @xmath23 to the test image with similarity transformation such that each exemplar s child parts aligns with two randomly selected hypotheses of atomic parts ( if @xmath65 ) , or up to two hypotheses of composite parts ( if @xmath66 ) .",
    "( 2 ) the geometrically well - aligned exemplars generate hypotheses for the parts at level @xmath23 .",
    "each hypothesis carries from exemplar the object size , the corresponding subtree , as well as the pose @xmath52 for each node in the subtree .",
    "( 3 ) augment the hypotheses of @xmath19 ( if @xmath66 ) by swapping their subtrees with geometrically compatible hypotheses at level @xmath20 .",
    "( 4 ) evaluate all the hypotheses at level @xmath23 using eq .",
    "[ eq : recur_score ] and keep the top - scoring ones . ( 5 ) increment @xmath23 and go to step ( 1 ) .",
    "[ fig : algo ] shows examples of the first three steps .",
    "and the second row corresponds to @xmath67 .",
    "( a ) two training exemplars .",
    "( b ) the test image overlaid with hypotheses at level @xmath20 .",
    "( c ) part hypotheses at level @xmath23 which are inherited from the exemplars .",
    "( d ) augmented hypothesis after swapping hypotheses of child part . ]    @xmath68 top @xmath69 local maximas from @xmath70 , @xmath71 refine and re - score @xmath72 through _ backtrack _ @xmath73 highest - scoring @xmath74    .",
    "the architecture of dcnn - based models for composite parts .",
    "it consists of five convolutional layers , three max - pooling layers and three fully - connected layers .",
    "the last two layers branch out , with each branch targeting the possible spatial relations of one composite part to its predefined reference part . ]",
    "the second component of the algorithm is _",
    "backtrack_. assuming we have a hypothesis of the root part @xmath75 , we can trace down the hierarchy , which gives us @xmath52 in eq .",
    "[ eq : geo_term ] for each composite part , as well as the hypothesized locations for the atomic parts @xmath76 $ ] .",
    "the next step is to re - score @xmath77 by obtaining its refined configuration @xmath74 . for this purpose ,",
    "we define @xmath78 to approximate @xmath79 in eq .",
    "[ eq : overall_opt ] : @xmath80 where @xmath81 .",
    "such approximation assumes @xmath82 , @xmath52 and @xmath42 for @xmath66 change little during the refinement . after plugging eq .",
    "[ eq : app_score ] and eq .",
    "[ eq : psi_def ] into eq .",
    "[ eq : appro_s ] , we can solve each atomic part independently as @xmath83 where part @xmath84 is the parent of part @xmath0 , @xmath85 denotes the search region of part @xmath0 .",
    "we define the search region as a circle with radius equal to @xmath86% of the average side length of @xmath75 .",
    "we evaluate eq . 8 for all the pixel locations inside the circle , which gives us the highest - scoring location . in the end",
    ", we obtain the refined configuration @xmath87 $ ] with updated score @xmath88 .",
    "in this section , we describe how we learn the appearance models in eq .",
    "[ eq : overall_opt ] ( i.e. , @xmath35 and @xmath54 ) , as well as how we learn the weight parameters @xmath89 ( i.e. , @xmath34 , @xmath50 , and @xmath51 ) .",
    "we follow the method of  @xcite to infer the spatial relations between atomic parts .",
    "specifically , we design a dcnn - based multi - class classifier using caffe  @xcite .",
    "the architecture is shown in the first row of fig .",
    "[ fig : dnn_architecture_2 ] .",
    "each value in the output corresponds to @xmath90 , which is the likelihood of seeing an atomic part @xmath0 with a certain spatial relation ( type @xmath91 ) to its predefined neighbor @xmath7 , at location @xmath92 .",
    "if @xmath93 , then @xmath94 , indicating the background ; if @xmath95 , then @xmath96 . by marginalization , we can derive @xmath35 and @xmath54 as @xmath97 note that superscript @xmath98 and @xmath4 are dropped for clarity , @xmath0 and @xmath7 are siblings . to define type @xmath91 , during training , we discretize the orientations of @xmath9 into @xmath99 ( e.g. , @xmath100 ) uniform bins , and @xmath91 indicates a particular bin .",
    "the training samples are then labeled as @xmath101 .",
    "we build another dcnn - based model to infer the spatial relations between composite parts , as shown in the second row of fig .",
    "[ fig : dnn_architecture_2 ] , the architecture differs from that for atomic parts in multiple aspects .",
    "first , as the model targets composite parts which have coarser levels of granularity , the network has a larger receptive field .",
    "second , as there are relatively fewer composite parts than atomic parts , we let all the composite parts share the features in the first several layers ( the input patches of different composite parts have different receptive fields ) .",
    "third , as the composite parts have different granularity with possibly significant overlap with each other , the dcnn branches out to handle them separately .    assuming the @xmath0-th branch corresponds to part @xmath0 at level @xmath20 ( note that @xmath66 ) , then the branch has @xmath102-dim output with each value being @xmath103 based on the image patch centered at the anchor point @xmath104 .",
    "assuming the parent of part @xmath0 is part @xmath19 , then @xmath54 is evaluated as @xmath105 note that superscript @xmath106 and @xmath4 are dropped for clarity . to train this model , we cluster the relation vector @xmath9 into @xmath99 ( e.g. , @xmath107 ) clusters ( types ) for part @xmath0 , and",
    "the training samples are labeled accordingly .",
    "[ eq : overall_opt ] can be written as a dot product @xmath108 .",
    "given a training sample @xmath109 , we compute @xmath110 as its feature .",
    "each training sample also has a binary label , indicating if the configuration @xmath4 is correct .",
    "therefore , we build a binary max - margin classifier  @xcite to estimate @xmath111 , with non - negativity constraints imposed . to avoid over - fitting , the training is conducted on a held - out validation set that was not used to train the dcnns .    before training , we augment the positive samples by randomly perturbing their part locations as long as they are reasonably close to the ground - truth locations . to generate the negative samples",
    ", we randomly place the configurations of positive samples at the incorrect regions of the training images , with gaussian noise added to the part locations .",
    "we evaluate our method extensively on multiple benchmarks , and conduct diagnostic experiments to show the effect of different components in our method .",
    "the leeds sports pose ( lsp ) dataset  @xcite includes @xmath112 images for training and @xmath112 images for testing , where each image is annotated with @xmath113 joint locations .",
    "we augment the training data by left - right flipping , and rotating through @xmath114 .",
    "we use observer - centric ( oc ) annotations to have fair comparisons with the majority of existing methods . to measure the performance ,",
    "we use percentage of correct parts ( pcp ) . in pcp measure ,",
    "a `` part '' is defined as a line segment connecting two neighboring joints .",
    "if both of the segment endpoints ( joints ) lie within @xmath115% of the length of the ground - truth annotated endpoints , then the part is correct .    in this experiment",
    ", we build a hierarchy of four levels for human body .",
    "the first level contains the atomic body joints ; the second level has five composite parts ( head , right arm , left arm , right leg , and left leg ) ; the third level has two composite parts ( head&arms and legs ) ; and the fourth level corresponds to the whole body . to gain an understanding of the effect of the components of our inference algorithm , we evaluate our full method ( which will be referred to as `` ours - full '' ) , and variants of our method ( which will be referred to as `` ours - partial '' , and `` ours - no - hier '' ) .",
    "ours - full corresponds to the whole inference algorithm ; ours - partial only conducts the first part of the inference algorithm , traces down the best root hypothesis based on eq .",
    "[ eq : recur_score ] , and outputs the locations of its atomic parts ; ours - no - hier only uses full - body exemplars ( after augmentation ) as the spatial models .",
    "the quantitative results of our method as well as its counterparts are listed in tab .",
    "[ tbl : lsp ] .",
    "ours - full generally outperforms the state - of - the - art methods on all the parts .",
    "the improvement over idpr  @xcite demonstrates the effect of reasoning multi - level spatial relations .",
    "we expect to see even larger improvement if we augment the annotations with midway points between joints .",
    "we also experiment with person - centric ( pc ) annotations on the same dataset , where the accuracy drops slightly .",
    "ours - full achieves improvement over ours - partial and ours - no - hier by a large margin , which demonstrates the benefits of _ backtrack _ ( higher precision ) and hierarchical exemplars ( more expressive models ) .",
    "note that ours - partial already outperforms strong - ps  @xcite and posemachine  @xcite .",
    "[ fig : final_results ] shows some testing examples , which are selected with high diversity in poses .",
    "we can see that our method achieves accurate localization for most of the body joints , even in the case of large articulated deformation .",
    ".comparison of pose estimation results ( pcp ) on lsp dataset .",
    "our method achieves the best performance .",
    "[ cols=\"<,^,^,^,^,^,^,^\",options=\"header \" , ]     we use percentage of detected joints ( pdj ) to evaluate the performance , which provides an informative view of the localization precision . in this experiment",
    ", we evaluate the baseline of our method ( referred to as `` ours - base '' ) by only using the first term in eq .",
    "[ eq : overall_opt ] .",
    "it is equivalent to localizing the parts independently . in fig .",
    "[ fig : model_performance ] , we plot the detection rate vs. normalized error curves for different methods . from the curves , we can see that ours - base already achieves better accuracy than  @xcite except for knee .",
    "it demonstrates that a detector that scores the part appearance is more effective than a regressor that predicts the part offset .",
    "ours - full achieves significant improvement over ours - base by incorporating the multi - level spatial models .",
    "our method is also comparable to  @xcite which enjoys the benefit of jointly learning appearance models and spatial context .",
    "@xcite has higher accuracy on the lower arms , while we have better results on the lower legs .",
    "also note that  @xcite requires delicate implementation of a sophisticated network architecture , while our method allows the use of off - the - shelf dcnn models .",
    "we also evaluate our method on the cub-200 - 2011 bird dataset , which contains @xmath116 images for training and @xmath117 images for testing .",
    "each image is annotated with image locations for @xmath86 parts .",
    "we also augment the training data through flipping and rotation .",
    "as birds are less articulated than humans , we design a three - level hierarchy for birds .",
    "the first level contains the atomic parts ; the second level has three composite parts ( head , belly&legs , and back&tail ) ; and the third level corresponds to the whole bird . although we did not prove that the manually - designed hierarchy is optimal , we empirically find that it facilitates the prediction of part relations",
    ".    we use pcp to measure performance . in the bird dataset",
    ", a correct part detection should be within @xmath118 standard deviation of an mturk worker s click from the ground - truth location . for a semi - rigid object such as bird with sufficient training samples , directly applying exemplar - based models can produce very good results .",
    "therefore , we replace the part detectors in  @xcite with dcnn - based detectors ( only targeting the atomic parts ) , which will be referred to as `` dcnn - coe '' .    we compare the results of different methods in tab .",
    "[ table : global_loc ] , including coe  @xcite and part - pair  @xcite .",
    "first , dcnn - coe outperforms coe significantly , demonstrating that dcnn is much more powerful than the conventional classification model ( e.g. , svm ) .",
    "dcnn - coe also outperforms part - pair with much less overhead , thanks to the efficiency of multi - class detector . using our new method ,",
    "the localization accuracy is further improved .",
    "ours - partial improves slightly over dcnn - coe , which is reasonable as ours - partial is essentially multi - level dcnns plus multi - level exemplars , and the flexibility from our multi - level exemplars has limited effect for semi - rigid objects .",
    "also note that ours - partial uses an incomplete scoring function . by considering the full scoring function ,",
    "ours - full achieves the best results on all the parts .",
    "some qualitative results are shown in fig .",
    "[ fig : final_results_bird ] . from the examples",
    ", we can see that our method is capable of capturing a wide range of poses , shapes and viewpoints .",
    "in addition , our method localizes the bird parts with very high precision .",
    "in this paper , we propose a novel approach for articulated pose estimation .",
    "the approach exploits the part relations at different levels of granularity through multi - scale dcnn - based models and hierarchical exemplar - based models . by incorporating dcnn - based appearance models in the spatial terms ,",
    "our method couples spatial models with them , thus better adapting to the particular test image than otherwise . by introducing hierarchy in the exemplar - based models ,",
    "we enjoy much more expressive spatial models even if the training data are limited .",
    "in addition , we propose an efficient algorithm to infer `` good - enough '' part configurations from a less simplified formulation .",
    "these efforts together enable us to achieve state - of - the - art results on different datasets , which demonstrates the effectiveness and generalization ability of our method .",
    "this work was supported by nsf awards 0968546 and 1116631 , onr award n00014 - 08 - 1 - 0638 , and gordon and betty moore foundation grant 2987 ."
  ],
  "abstract_text": [
    "<S> exemplar - based models have achieved great success on localizing the parts of semi - rigid objects . </S>",
    "<S> however , their efficacy on highly articulated objects such as humans is yet to be explored . </S>",
    "<S> inspired by hierarchical object representation and recent application of deep convolutional neural networks ( dcnns ) on human pose estimation , we propose a novel formulation that incorporates both hierarchical exemplar - based models and dcnns in the spatial terms . </S>",
    "<S> specifically , we obtain more expressive spatial models by assuming independence between exemplars at different levels in the hierarchy ; we also obtain stronger spatial constraints by inferring the spatial relations between parts at the same level . as our method strikes a good balance between expressiveness and strength of spatial models , </S>",
    "<S> it is both effective and generalizable , achieving state - of - the - art results on different benchmarks : leeds sports dataset and cub-200 - 2011 .    </S>",
    "<S> = 1 </S>"
  ]
}