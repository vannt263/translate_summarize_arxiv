{
  "article_text": [
    "engineering the focal spot of a high numerical aperture ( na ) lens is a central problem in several optical applications such as laser scanning microscopy , optical trapping and laser micromachining . to obtain the desired spot , one usually has to solve a numerical optimization problem .",
    "there exist several examples for the design of annular amplitude or phase masks that tailor a given input beam for a specific application  @xcite .",
    "these calculations usually rely on the debye  wolf diffraction integral  @xcite to determine the focused field .    instead of the direct numerical evaluation of the debye ",
    "wolf integral , some methods use analytical series expansions .",
    "these methods include the multipole theory of focusing  @xcite , the technique of kant using gegenbauer polynomials and spherical bessel functions  @xcite , the extended nijboer  zernike ( enz ) approach  @xcite or the scalar eigenfunction expansion of sherif et al .",
    "using slepian s prolate spheroidal functions  @xcite .",
    "some of these methods were also used for solving the inverse problem of focusing  @xcite .",
    "recently , a technique using dipole arrays has also been proposed  @xcite .",
    "the methods above , however , possess some inherent drawbacks .",
    "the scalar slepian method  @xcite is not suitable for optimization problems with a prescribed intensity pattern  @xcite , the dipole array method is tailored for specific problems  @xcite and the multipole theory  @xcite lacks directionality thus requires additional constraints to ensure directional illumination .",
    "although the enz theory  @xcite is suitable for aberration retrieval where a linearized intensity approximation can be used  @xcite , it becomes , similarly to the method of kant  @xcite , computationally challenging for arbitrary focal intensity profiles .",
    "based on the multipole theory of focusing  @xcite , we have recently proposed an orthonormal basis of vector slepian harmonics ( vslhs ) which are naturally suitable for approximating the illumination in a high na system  @xcite .",
    "its main advantage is that a subset exhibits excellent directionality , i.e. its angular energy distribution is confined to the solid angle of illumination .",
    "each vslh basis function represents the vectorial plane - wave amplitudes ( pwas ) of a focused field described by a corresponding vector slepian multipole field ( vslmf ) .",
    "the directionality of the vslhs allows us to approximate common illumination pwas using a smaller number of coefficients than a representation using the vector spherical harmonics does  @xcite .    in this paper",
    ", we demonstrate the applicability of these novel vector bases for general inverse problems in high na focusing . as illustrations ,",
    "three examples are considered : the optical needle  @xcite , tube  @xcite and bubble  @xcite .",
    "first we give a brief introduction to the new vslhs and vslmfs discussed more comprehensively in ref .",
    "one can approximate a divergence - free , monochromatic focused electric field that satisfies the vector helmholtz equation as @xmath0 where the vector functions @xmath1 are the vslmfs and @xmath2 denotes complex expansion coefficients ( determined in this paper by numerical optimization , as discussed in section  [ sec : inverse ] ) .",
    "the vslmfs themselves are linear combinations of a finite number of vector multipole fields ( vmfs ) @xmath3 and @xmath4  @xcite of the same order @xmath5 , i.e. @xmath6,\\ ] ] where @xmath7 denotes the maximal degree of the contributing vmfs and the summation starts at @xmath8 on the calculation of the coefficients @xmath9 and @xmath10 of eq .  , see ref .",
    "@xcite .",
    "the azimuthal properties of @xmath1 are solely determined by the order @xmath5 . in most cases , e.g. for focused fields of linearly or circularly polarized input beams or cylindrical vector beams , only vslmfs of certain values of @xmath5",
    "contribute to the focused field .",
    "the second integer @xmath11 indexes vslmfs of the same order @xmath5 , however , the limit @xmath12 of eq .",
    "is usually chosen to be much smaller than the number @xmath13 of available vslmfs for a given order @xmath5 , where @xmath14 to clarify the reason for this choice , we must first recall the plane - wave representation of these fields .",
    "the vslmfs can also be expressed as a superposition of elementary plane - waves , i.e. @xmath15 where @xmath16 denotes the wavenumber ( @xmath17 is the wavelength ) , @xmath18 and @xmath19 are angular spherical coordinates , and @xmath20 is the propagation unit vector of a plane - wave component with an amplitude and polarization specified by @xmath21 . between @xmath21 and @xmath22 the transversality relation @xmath23 holds .",
    "analogously to eq .",
    ", the functions @xmath24 are also defined as a linear combination : @xmath25\\,,\\ ] ] where @xmath26 and @xmath27 are vector spherical harmonics ( vshs )  @xcite . since ( i ) the vshs represent the pwas of the vmfs  @xcite similarly to eq .   and",
    "( ii ) vslmfs are defined as a linear combination of the vmfs according to eq .  , the same expansion coefficients @xmath9 and @xmath10 appear in eq .",
    "as in eq .  .",
    "furthermore , following from the linearity of our expressions , the combination @xmath28 of vshs with the coefficients @xmath2 of eq .",
    "gives the pwas @xmath29 of the focused field .",
    "the electric field at the entrance pupil of the lens can then be found using the vectorial ray - tracing method of trk et al .",
    "@xcite .",
    "although eq .   resembles the debye ",
    "wolf integral  @xcite closely , it is important to stress that the integration is performed over the unit sphere of all possible plane - wave directions , not just for the spherical cap @xmath30 to be applicable to systems whose na restricts possible plane - wave directions to @xmath31 , the vslhs @xmath24 are constructed to maximize @xmath32 , the fraction of the energy falling onto @xmath31  @xcite .",
    "the vslhs @xmath24 for a given @xmath5 are ordered by decreasing @xmath32 , thus those with lower @xmath11 have less `` energy leakage '' outside @xmath31 . in our examples , we restrict ourselves to basis functions with @xmath33 .",
    "this leads to choosing the maximal index @xmath12 to be less than @xmath13 .",
    "we stress the fact that using this method , no extra constraints are necessary to ensure the directionality of the illumination , which would be inevitable when using the multipole theory of focusing  @xcite .",
    "next we demonstrate how to use our method of vslmfs and vslhs to treat the inverse problem , i.e. to find the illumination for a prescribed focal intensity profile . here",
    "we only consider examples of cylindrical vector beams that can be described as a superposition of radially and azimuthally polarized fields . in the context of vslhs",
    "this means a choice of @xmath34  @xcite .",
    "however , all optimization tasks could be performed in a straightforward way for linear , circular or more general polarization states as well , merely with different choices of @xmath5 .",
    "naturally , our method is easily applicable to inverse problems on the electric field distribution , too , provided that a physically feasible focal electric field is prescribed .    in our calculations",
    "an aplanatic lens with @xmath35 was used . assuming a cylindrical coordinate system @xmath36 centered at the focus , a rotationally symmetric intensity distribution @xmath37 was prescribed in the focal volume .",
    "the focused field can be written as @xmath38 where the task is to find the coefficients @xmath39 that minimize the cost function @xmath40 ^ 2\\ , \\mathrm{d}^3 \\mathbf{r},\\ ] ] the squared error of the intensity integrated over some reasonably chosen volume @xmath41 around the focus ( the asterisk denotes the complex conjugate and we have simplified the notation by omitting the zero @xmath5 index from @xmath42 ) .",
    "the optimization was performed by sequential least squares programming  @xcite .",
    "random initial values of @xmath39 were chosen and the process converged to a local minimum of @xmath43 . for a given problem , this optimization process was repeated 40 times and the lowest minimum was selected . although not guaranteed to find a global optimum , the process yielded satisfactory results from a practical point of view .",
    "if attaining the global optimum is of crucial importance , computationally intensive global optimizing algorithms can be used .",
    "we note that 40 runs generally yielded only at most 3 different local minima and there was less than 2% difference in the value of the cost function for the different local minima .    for the examples presented in this paper , we only considered real values of @xmath39 that correspond to a binary phase modulation of the radial and azimuthal components of the input beam . when allowing complex - valued @xmath39 ( i.e. a locally elliptically polarized input beam ) , the size of real optimization parameters doubled and the computation time increased by a factor of @xmath44@xmath45 on the average .",
    "however , we did not obtain any better local optima in terms of cost function value for the examples considered .",
    "the pwas of @xmath46 can be obtained as @xmath47 since @xmath48  @xcite , a small amount of energy leakage may still occur outside @xmath31 .",
    "because of that , the exact focused electric fields were also calculated by debye  wolf integration using chirp z - transform  @xcite after enforcing a hard limit at the edge of the entrance pupil .",
    "the prescribed focal intensity functions for the needle , tube and bubble were    [ eq : prescribed_intensities ] @xmath49 , \\label{eq : bubble_prescribed}\\end{aligned}\\ ] ]    respectively , where the parameters @xmath50 and @xmath51 were chosen such that the full width at half maximum ( fwhm ) of all functions in the focal plane was @xmath52 .",
    "for the optical tube and bubble this value refers to the inner fwhm size of the dark spot . for the optical bubble ,",
    "a physically feasible aspect ratio @xmath53 was chosen , as seen in eq .  .",
    "the integration in eq .   was performed over a cylinder with a length of @xmath54 and a radius of @xmath55 for the needle and the tube , and over a prolate ellipsoid of revolution with a length of @xmath56 and a radius of @xmath55 for the bubble .",
    "the shape of the integration volumes was chosen to be similar to each prescribed focal spot ; and their lateral size was large enough so that the prescribed intensity at the edges was at least 9 orders of magnitude smaller than the peak value .    in the case of the optical needle and tube ,",
    "the axial length of the integration volume approximately matched the maximal length of the focal spot attainable by the vslmf basis functions involved in the process .",
    "this maximal length can be increased by increasing @xmath7 of eq .",
    "for all examples presented here , we chose @xmath57 .",
    "for both the optical needle and tube , the 11 most concentrated @xmath58 functions were used . for the needle we included",
    "only @xmath58 corresponding to radially polarized illumination , because the azimuthally polarized components would only increase the lateral fwhm and would not contribute to the on - axis electric field .",
    "for analogous reasons , only @xmath58 corresponding to azimuthally polarized illumination were included for the optical tube .",
    "the bubble included both types of polarizations .",
    "moreover , since the ideal optical bubble demands zero electric field in its center , we introduced the extra constraint @xmath59 in the optimization process .",
    "[ fig : ff ] depicts the intensity distributions obtained from the optimization process for each spot and fig .  [",
    "fig : as ] shows the corresponding electric fields at the entrance pupil of the lens . in the case of the needle ( figs .",
    "[ fig : ff](a),(b ) ) , the length of the spot is @xmath60 ( axial full width at 90% maximum ) , while the lateral fwhm is @xmath61 in the focal plane and below @xmath62 throughout its full length . the beam purity ( expressing the fraction of energy of the longitudinally polarized component inside the needle volume , defined in ref .",
    "@xcite ) stays above @xmath63 along the needle with a value of @xmath64 in the focal plane .",
    "hence , we can conclude that the quality of the needle resulting from our method is comparable to that of wang et al .",
    "[ fig : ff](b ) shows a slight difference between the slepian approximation of the focused field using the vslmfs @xmath58 and the result of the debye  wolf integration .",
    "this discrepancy can be attributed to the fact that @xmath65 of the total energy falls outside the spherical cap of illumination .",
    "the optical tube shown in figs .",
    "[ fig : ff](c),(d ) has a length of @xmath60 , measured along @xmath66 , where @xmath67 is the peak radius in the focal plane .",
    "the lateral inner fwhm is @xmath68 in the focal plane and stays below @xmath69 throughout the entire length of the tube .",
    "again , our results are comparable with those of wang et al .  @xcite . here",
    "the energy leakage , when using the slepian approximation , is only @xmath70 , since the illumination intensity is low near the edge of the entrance pupil ( as seen in fig .",
    "[ fig : as](b ) ) .",
    "we note that by increasing @xmath7 the number of total vslhs increases , including the number of those with @xmath71 .",
    "while more optimization parameters are introduced , the maximal attainable length of the tube and needle also increases , as already noted in the previous section .",
    "thus when increased depth of field is of primary importance , a larger value for @xmath7 can simply be chosen .    finally , the optical bubble of figs .  [ fig : ff](e),(f ) qualitatively reproduces the result of bokor and davidson  @xcite . in this case , the illumination ( fig .",
    "[ fig : as](c ) ) is constructed from 22 basis functions .",
    "the axial and lateral fwhm of the dark core of the bubble are @xmath72 and @xmath73 , respectively . as seen in figs .",
    "[ fig : ff](e),(f ) , the intensity is zero at the center as prescribed , and the axial and transverse peak intensities are nearly equal in magnitude , which is advantageous e.g. in fluorescence depletion microscopy  @xcite .",
    "again , the illumination intensity is low near the edge of the entrance pupil , leading to an energy leakage of only @xmath74 .",
    "we have demonstrated with three well - known examples that vslhs and vslmfs are highly suitable for inverse problems of high na focusing . knowing the desired 3d intensity distribution in the focal volume , our method can be used effectively to design the electric field distribution at the entrance pupil .",
    "although the realization of the input field requires careful control of amplitude , phase and polarization , some practical methods using liquid crystal spatial light modulators or form - birefringent spatially variant subwavelength gratings have already been proposed to achieve this task  @xcite .    finally , it is important to note again that vslhs and vslmfs are suitable for treating the inverse problem not only for the focal intensity but for the focal electric field as well .",
    "in fact , in that case a least squares approach similar to eq .",
    "leads to an easily solvable system of linear equations .",
    "this work is connected to the scientific program of the `` development of quality - oriented and harmonized r+d+i strategy and functional model at bme '' project .",
    "this project is supported by the new hungary development plan ( project i d : tmop-4.2.1/b-09/1/kmr-2010 - 0002 ) .",
    "t.  jabbour , s.  kuebler , vector diffraction analysis of high numerical aperture focused beams modified by two - and three - zone annular multi - phase plates , opt .",
    "express 14  ( 3 ) ( 2006 ) 10331043 .",
    "http://dx.doi.org/10.1364/oe.14.001033 [ ] .",
    "e.  wolf , electromagnetic diffraction in optical systems .",
    "i. an integral representation of the image field , p. roy . soc . a - math .",
    "253  ( 1274 ) ( 1959 ) 349357 . http://dx.doi.org/10.1098/rspa.1959.0199 [ ] .    c.  sheppard , p.  trk , efficient calculation of electromagnetic diffraction in optical systems using a multipole expansion , j. mod .",
    "optics 44  ( 4 ) ( 1997 ) 803818 .",
    "http://dx.doi.org/10.1080/09500349708230696 [ ] .",
    "j.  braat , p.  dirksen , a.  janssen , a.  van  de nes , extended nijboer  zernike representation of the vector field in the focal region of an aberrated high - aperture optical system , j. opt .",
    "soc . am . a 20  ( 12 ) ( 2003 ) 22812292 .",
    "http://dx.doi.org/10.1364/josaa.20.002281 [ ] .",
    "s.  sherif , m.  foreman , p.  trk , eigenfunction expansion of the electric fields in the focal region of a high numerical aperture focusing system , opt .",
    "express 16  ( 5 ) ( 2008 ) 33973407 .",
    "j.  braat , p.  dirksen , a.  janssen , s.  van haver , a.  van  de nes , extended nijboer - zernike approach to aberration and birefringence retrieval in a high - numerical - aperture optical system , j. opt .",
    "a 22  ( 12 ) ( 2005 ) 26352650 . http://dx.doi.org/10.1364/josaa.22.002635 [ ] .",
    "m.  foreman , s.  sherif , p.  munro , p.  trk , inversion of the debye - wolf diffraction integral using an eigenfunction representation of the electric fields in the focal region , opt .",
    "express 16  ( 7 ) ( 2008 ) 49014917 .",
    "http://dx.doi.org/doi:10.1364/oe.16.004901 [ ] .",
    "j.  wang , w.  chen , q.  zhan , engineering of high purity ultra - long optical needle field through reversing the electric dipole array radiation , opt .",
    "express 18  ( 21 ) ( 2010 ) 2196521972 .",
    "http://dx.doi.org/10.1364/oe.18.021965 [ ] .",
    "k.  jahn , n.  bokor , vector slepian basis functions with optimal energy concentration in high numerical aperture focusing , opt .",
    "commun . 285",
    "( 2012 ) 20282038 .",
    "[ ] .",
    "x.  wang , j.  ding , w.  ni , c.  guo , h.  wang , generation of arbitrary vector beams with a spatial light modulator and a common path interferometric arrangement , opt .",
    "32  ( 24 ) ( 2007 ) 35493551 . http://dx.doi.org/10.1364/ol.32.003549 [ ] ."
  ],
  "abstract_text": [
    "<S> a technique using vector slepian harmonics and vector slepian multipole fields is presented for a general treatment of the inverse problem of high numerical aperture focusing . </S>",
    "<S> a prescribed intensity distribution or electric field distribution in the focal volume is approximated using numerical optimization and the corresponding illuminating field at the entrance pupil is constructed . </S>",
    "<S> three examples from the recent literature are chosen to illustrate the method .    high numerical aperture focusing , vector diffraction theory , inverse problem , slepian s concentration problem </S>"
  ]
}