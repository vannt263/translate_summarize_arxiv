{
  "article_text": [
    "the motion of star clusters in the galaxy is primarily determined by the monopole component of the galactic gravitational force ; their internal dynamics is often influenced by the tidal force .",
    "a steady tidal force imposes a cutoff of the stellar distribution in the cluster at the tidal radius , whereas fast encounters with the galactic disk or bulge cause gravitational shocks ( @xcite , hereafter osc ; @xcite ) .",
    "the overall effect of tidal shocks is the enhanced evaporation of clusters via the following processes .",
    "first , stars on average gain energy ( @xmath8 ) reducing the cluster binding energy . after a short period of contraction immediately following the shock , the cluster as a whole expands and some stars find themselves outside the tidal boundary .",
    "they are now captured by the galactic potential and are effectively lost from the cluster .",
    "second , tidal shocks induce a dispersion of stellar energies ( @xmath9 ) , named the `` tidal shock relaxation '' , which is very similar to the diffusion in energy space due to two - body relaxation ( @xcite ; hereafter ko )",
    ". both of these processes supply stars to the high - energy tail of the velocity distribution , which is not bound by the cluster potential .",
    "those stars eventually escape , thus enhancing the evaporation of the cluster .",
    "finally , shock - induced relaxation speeds up core collapse , which in turn leads to an ever faster evolution , faster evaporation , and subsequent disintegration of the cluster .",
    "osc considered the problem in the _ impulse approximation _ , wherein the stars are assumed to move little during the shock .",
    "this is appropriate in the outer regions of the cluster , near the tidal radius . in the cluster core",
    ", the impact of shocks is very different .",
    "the rapidly orbiting stars smear the perturbation over many rotations around the center of the cluster . because the conservation of adiabatic invariants prevents stars from gaining energy , the shocking effect is significantly reduced .",
    "spitzer ( 1987 ) studied this problem in the harmonic potential approximation and found that @xmath10 is exponentially suppressed . recently weinberg ( 1994a ) suggested that the actual impact of the shock is stronger because of the numerous resonances in a system with more than one degree of freedom .",
    "since the original formula for @xmath10 was derived by osc in the impulse approximation , we define the _ adiabatic correction _ as the ratio of the actual energy change to its `` impulsive '' value .",
    "in addition to the remaining question concerning the proper treatment of the adiabatic correction , there is a much larger open question .",
    "after the perturbing force has ceased , the cluster finds itself out of equilibrium .",
    "then there will be an interval of several dynamical times while the cluster oscillates until phase mixing and landau damping bring it into a new equilibrium state . during this phase",
    ", the total energy of the cluster will be conserved but individual stellar orbits may gain or lose energy in response to the fluctuating gravitational field .",
    "this may produce additional both the first and second order energy changes , @xmath0 and @xmath7 .",
    "these secondary effects have been studied very little and may contribute to the cluster evolution , along with the better known primary effects .",
    "as an instructive exercise , consider how the stars gain energy at the expense of the binding energy of the cluster in an impulsive shock .",
    "let @xmath11 be the energy of the @xmath12th star , @xmath13 where @xmath14 , @xmath15 , and @xmath16 are the mass , position , and velocity of the star , respectively .",
    "the total energy of the system is a sum of the kinetic ( @xmath17 ) and potential ( @xmath18 ) terms : @xmath19 this can be rewritten as @xmath20 immediately after the shock , the stars have gained some kinetic energy , @xmath21 , but have not yet had time to change the potential . as the result , the energy of the cluster changes by @xmath22 after the period of virialization following the shock , both the kinetic and the potential energies of the cluster change , @xmath23 , but the total energy is conserved .",
    "this implies @xmath24 , and combined with equations ( [ eq : vir_ei ] ) and ( [ eq : vir_etot ] ) gives the final energy change of the stars : @xmath25 the stars gain on average three times the initial kick due to the shock .",
    "the extra energy comes from the reduction of the binding energy of the cluster .",
    "a schematic picture of the potential change is presented in figure [ fig : pic ] .",
    "we use self - consistent n - body simulations to investigate the adiabatic correction as a function of the star energy and position in the cluster .",
    "this technique allows us to study directly the self - gravitating response of the cluster to the tidal perturbation , neglected in prior models .",
    "we find that collective effects play an important role in transporting the perturbation from the outer layers deep inside the cluster . while the postshock evolution conserves the total energy , the energy of individual stars changes because of the readjustment of the potential .",
    "a previous approach to include tidal shocks in the evolutionary fokker - planck code ( @xcite 1997 ) has been to first input the energy changes associated with the shock , and then update the potential using the adiabatic invariants .",
    "these adiabatic invariants change as a result of shocking and so the above procedure is not exactly correct , but no better alternative was available prior to the current work .",
    "also , this method does not include the energy transfer between stars subsequent to the shock which gives rise to additional changes in @xmath10 and @xmath7 .",
    "our current approach is fully self - consistent and treats all of the above processes exactly .",
    "a direct application of the linear perturbation theory has been done by weinberg ( 1994b , c ) and @xcite ( 1997a - c ) . both methods , our fully numerical and the semi - analytical by the authors , lead to the correct results but differ in implementation .",
    "we review the analytic calculations of the adiabatic correction of spitzer and weinberg in ",
    "[ sec : adiabatic ] . in ",
    "[ sec : code ] , we describe the n - body code and the parameters of the star cluster . in  [ sec : results ] , we present the results of our simulations of disk shocking and compare them with the analytical estimates .",
    "we consider the problem twice , keeping the cluster potential fixed , and allowing for self - gravity .",
    "also in  [ sec : radial ] , we investigate radial shocking to test the effects of the self - gravitating response of the cluster noted above . we summarize and discuss the implications of our results for the fokker - planck calculations of the dynamical evolution of stellar systems in  [ sec : summary ] .",
    "we need a parameter to quantify the transition from the impulse to the adiabatic regime of tidal shocking .",
    "let @xmath26 be the characteristic duration of the shock .",
    "we define the _ adiabatic parameter _",
    "@xmath27 where @xmath1 is the stellar orbital frequency , or , defined in terms of the root - mean - square velocity @xmath28 of stars at a distance @xmath29 from the center of the cluster , @xmath30 .",
    "this frequency is directly related to the ( inverse ) dynamical time of stars at a given distance @xmath29 . the effective time to cross the disk of the galaxy of half - thickness @xmath31 for the cluster with the perpendicular velocity @xmath32 is @xmath33 for the shock duration @xmath26 representative for globular clusters in the galaxy , @xmath34 close to the tidal radius , and @xmath35 in the core . to the second order in perturbation ,",
    "the initial energy change inside the cluster relative to the outer parts is independent of the shock amplitude .",
    "therefore we can define a function @xmath36 of a single variable @xmath37 as the ratio of the actual energy change to its impulse value .",
    "the _ adiabatic correction _",
    "@xmath36 should satisfy the following criteria : @xmath38    in the harmonic approximation , the first and second order terms for the average energy change of stars at the distance @xmath39 from the equatorial plane of the cluster are given by spitzer ( 1987 ) and ko , respectively :    @xmath40    @xmath41    where @xmath42 is the maximum vertical gravitational acceleration produced by the disk , and @xmath43 for a phase - mixed spherical mass distribution . here",
    "@xmath44    @xmath45    [ eq : spcorr ]    and we denote by the subscripts 1 and 2 the adiabatic correction for the first and second order terms , respectively . if we put @xmath46 , we recover the impulse approximation result .",
    "note that the value of @xmath47 jumps by the factor @xmath48 as @xmath49 ; i.e. , the harmonic approximation enhances the shock impact at large radii .",
    "however , we should not expect it to be unity , since the assumption of the parabolic potential is not valid on the cluster periphery .",
    "the derivation of the above result assumes that the oscillation frequencies of the system are not commensurable with the perturbation frequency . in general",
    ", it has been proved that under this condition the adiabatic factor vanishes faster than any power of @xmath37 ( @xcite ) , consistent with the exponential variation ( spitzer 1987 , p. 48 ) .",
    "recently @xcite ( 1994a ) showed that resonances do typically occur in a system with more than one degree of freedom .",
    "if the system is represented by a combination of multi - dimensional nonlinear oscillators , it becomes likely that some of the perturbation frequencies will be commensurable with the low oscillation frequencies of the stars .",
    "then those stars receive a significant kick from the perturbation and no longer conserve their actions . averaging over an ensemble of stars",
    "can give an appreciable energy change .",
    "as a result of summing over the resonant terms , the adiabatic factor @xmath36 is not exponentially small for the large values of @xmath37 , but rather follows approximately a power - law form .",
    "formulae derived by weinberg ( 1994b ; for example , his eq .",
    "[ 24 ] ) contain multiple infinite sums and integrals over all frequency range allowed to the system .",
    "instead of a direct application of the linear theory formalism , we derive an asymptotic result for the long duration of the shock , @xmath26 , and fit the intermediate regime .",
    "we follow closely the suggestion by @xcite .",
    "consider a shock with the duration comparable to or larger than the half - mass radius dynamical time of the cluster .",
    "the acceleration of stars due to the perturbation is roughly @xmath50 , and their energies change significantly only over the period when the stars are in resonance with the perturbation , @xmath51 .",
    "thus those stars would gain about @xmath52 the energy change per unit mass is @xmath53 ( fraction of resonant stars ) . equations ( 19 ) and ( 24 ) of weinberg ( 1994b ) indicate that the number of stars at the peak amplitude scales as @xmath54 .",
    "therefore , we approximate the fraction of resonant stars as @xmath55 and finally obtain @xmath56 where we have substituted equation ( [ eq : tau ] ) for @xmath26 .",
    "it follows from the equation above that the asymptotic form of the adiabatic correction is @xmath57 now we can construct the correction factor for all values of @xmath37 from its asymptotic behavior .",
    "the simplest fitting formula is @xmath58 in the following , we call equation ( [ eq : wcorr ] ) the _ weinberg correction _ , as it was derived from considerations brought forward by m. weinberg.we refer to equation ( [ eq : spcorr1 ] ) as the _ spitzer correction_. we plot the two adiabatic corrections on figure [ fig : addisk ] .",
    "the exponential drops much faster than the power - law in the central region of the cluster .",
    "we perform n - body simulations of a single tidal shock in a spherical system in order to investigate the validity of the adiabatic corrections considered in the previous section .",
    "we use first the self - consistent field ( scf ) method described in @xcite ( 1992 ) .",
    "the code is designed to reduce the numerical relaxation , which arises from close two - body interactions . instead of direct calculation of forces for all particles",
    ", the code computes orbits of the particles in a smooth potential of the cluster , expanded in a series of predetermined basis functions .",
    "the coefficients of the expansion are updated each time step based on the particle positions .",
    "this procedure provides a self - consistent solution to the poisson equation .",
    "the details of the calculation of the expansion coefficients are given in @xcite ( 1992 ) , whose set of basis functions we use here .",
    "we have done simulations with two sets of the expansion coefficients ( @xmath59 , @xmath60 ) and ( @xmath61 , @xmath62 ) . in both cases",
    "the results are indistinguishable and therefore are independent of the numerical method .    as our initial model for the cluster",
    "we take the king model ( @xcite ) with the structural parameter @xmath63 ( corresponding to the concentration @xmath64 ) .",
    "this is a relatively loosely bound cluster , for which the effects of tidal shocks should be important .",
    "working units of the code are such that @xmath65 , where @xmath66 is the total mass of the cluster and @xmath67 is the core radius .",
    "the tidal radius is determined by the concentration ; @xmath68 .",
    "the characteristic time for the whole cluster is the dynamical time at the half - mass radius @xmath69 ( @xcite , eq .",
    "[ 2 - 30 ] ) : @xmath70 in the code units . for our cluster ,",
    "we have chosen a time step which is 1% of the half - mass dynamical time , @xmath72 .",
    "this time step is sufficient to calculate accurately stellar orbits even at the center , since the shortest orbital period is @xmath73 , where @xmath74 is the central density , and @xmath75 is the density at half - mass radius ; @xmath76 for this cluster .",
    "we use @xmath77 equal - mass particles to model the cluster .",
    "the number of stars in observed globular clusters is of the same order , so that effects of `` noise '' ( such as the poisson noise ) are equally present in both our simulations and real clusters .",
    "the numerical accuracy of the calculations is secured by the conservation of the total energy of the cluster in isolation at the level @xmath78 .",
    "we investigate first the impulsive shocking that occurs during one time step .",
    "it allows us to study the self - gravitating response of the cluster separately from the adiabatic corrections . in run",
    "a the potential is fixed , and in run b it is fully self - consistent .",
    "then we allow for the time - varying perturbation with the duration of the order of the dynamical time of the cluster .",
    "for the real clusters in the galaxy , a typical shock lasts @xmath79 . run c explores the case with the fixed potential , run d is the final self - consistent simulation .",
    "the parameters of all runs are summarized in table [ tab : runs ] .      runs a and b study disk shocking in the impulsive regime .",
    "we apply an impulse of the form @xmath80 during one time step at the time @xmath81 and then follow the evolution of the cluster until @xmath82 .",
    "we take @xmath83 in the code units , which corresponds to @xmath84 .",
    "other components of the stellar velocity remain unchanged during the impulse .",
    "the overall effect of the shock is characterized by the relative reduction in the binding energy , @xmath85 .",
    "figure [ fig : delz_sg6_e ] illustrates the time evolution of the system .",
    "we plot here the change of the total energy of the cluster , as well as the partial contributions of the kinetic and potential energies .",
    "the total energy is very well conserved after the impulse , but both @xmath17 and @xmath18 undergo several oscillations .",
    "the lower panel of figure [ fig : delz_sg6_e ] shows deviations from the virial equilibrium as indicated by the ratios @xmath86 and @xmath87 , where @xmath32 is the virial of the system @xmath88 and @xmath89 for any system of particles moving in a finite region of space with finite velocities , when averaged over time ( e.g. , @xcite ) .",
    "thus , for an equilibrium system the virial ratios should be unity .    from these plots",
    "we see how the cluster responses to the perturbation . at first , it is compressed since all stars undergo instant acceleration toward the center .",
    "their kinetic energy is on average increased and soon they move outward , and an expansion follows the relatively short period of contraction . now",
    "the stars lose kinetic energy , and after about @xmath90 the virial relations are restored .",
    "however , the cluster continues to expand following inertia and undergoes a few more oscillations .",
    "the virial equilibrium is approached in about @xmath91 dynamical times . as expected , we find @xmath92 and @xmath93 to be within 5% accuracy at the end of the simulation .",
    "now we look at the distribution of the energy changes inside the cluster .",
    "first , we fix the cluster potential ( run a ) and see how well our results agree with the analytical predictions .",
    "figure [ fig : delz_fix6_b ] shows the relative changes @xmath94 and @xmath95 at the end of the simulation as a function of the initial energy , @xmath11 .",
    "the stars are grouped into 100 bins , each having @xmath96 particles .",
    "this assures proper averaging over the phase space of stellar orbits .",
    "we expect that statistical errors do not exceed the 1% level .",
    "the solid line shows the expected energy changes for stars of the same initial energy :    @xmath97    [ eq : defix ]    where @xmath98 is the time step , @xmath29 and @xmath28 are the mean position and rms velocity of stars of energy @xmath99 , and @xmath100 is the position - velocity correlation function ( see  [ sec : app.rv ] ) .",
    "the data points lie right along the predicted curve , confirming that the binning procedure is correct and numerical errors are not significant .    next",
    ", we study the self - gravitating response of the cluster to the perturbation .",
    "figure [ fig : delz_sg6_b ] shows the energy changes for run b. right after the shock , both the first and second order energy changes follow their estimates for the fixed potential .",
    "twenty dynamical times later , @xmath101 is significantly enhanced everywhere in the cluster .",
    "the energy dispersion is also much higher in the cluster core .",
    "what causes such a difference ?",
    "first we check whether it is simply a result of numerical relaxation .",
    "recent studies ( @xcite ; hernquist & ostriker 1992 ; @xcite ) showed that the self - consistent field method does not totally avoid relaxation because of the finite number of particles used in calculation of the potential .",
    "although reduced , compared to the direct summation methods , numerical relaxation drives dispersion of stellar energies over the time scale proportional to the number of particles in the system .",
    "we performed test simulations varying the number of particles from @xmath102 to @xmath103 .",
    "the energy dispersion , @xmath104 , does decrease with increasing @xmath105 , indicating that there exists a spurious numerical relaxation . in the core",
    ", the results can be approximated by @xmath106    the first order energy change is not affected by the numerical effects as the dispersion they induce has zero mean . the observed heating is the result of the cluster potential attaining a new equilibrium , causing energy exchange and phase mixing of stellar orbits .    as a result of the heating ,",
    "the cluster expands overall .",
    "figure [ fig : delz_sg6_rho ] shows the density distribution at the end of run b. some stars move beyond the tidal radius but are not necessarily lost : they are still gravitationally bound to the cluster .    in the new equilibrium , the depth of the potential well is decreased relative to the initial configuration ( cf .",
    "figure [ fig : pic ] ) . since the amplitude of the perturbation is small , the potential changes self - similarly , i.e. @xmath107 , where @xmath108 is the initial potential .",
    "we find that the simulation results can be fitted by an almost independent sum of the impulsive heating ( as calculated by osc ) and the potential gain : @xmath109 where @xmath110 is given by equation ( [ eq : defix ] ) , and @xmath111 where @xmath112 is a normalization constant such that the sum of total energy change over all particles is twice the total energy change of the cluster ( required by the virial theorem ; cf .",
    "[ [ eq : denorm ] ] ) .",
    "note that @xmath113 is positive for all stars and is unaffected by the phase space averaging .",
    "the evolution of the energy dispersion is less obvious .",
    "figure [ fig : delz_sg6_b ] shows that @xmath7 _ decreases _ relative to the impulsive value in the middle of the cluster .",
    "we found this behavior generic for all simulations we performed .",
    "the distribution of energies is illustrated in figure [ fig : delz_sg6_d ] , which shows the detailed structure of one bin at the half - mass radius .",
    "the energy change @xmath101 is slightly asymmetric with respect to the center of the bin , @xmath10 , immediately after the shock but it is very well phase mixed at the end of the run .",
    "the distribution is adequately represented by the gaussian form although the dispersion is indeed reduced by about 20% relative to the initial impulse . the normal shape of the distribution is intrinsic as it is unaffected by varying the size of the bins .",
    "the skewness and kurtosis of the distribution are small and statistically insignificant .",
    "the reduction in the dispersion of stellar energies after potential fluctuations , or the `` cooling '' of the cluster , can be explained by the anti - correlation of the initial energy change and the subsequent change due to self - consistent oscillations . in a compressive shock ,",
    "stars that were moving inwards before the shock gain energy and those moving outwards lose energy .",
    "but , after the shock there is a compressive wave moving inwards ( which subsequently reflects and moves outwards ) , so those particles which had gained energy are in phase with the wave and those which had lost energy are out of phase . in an expanding shock ,",
    "all directions are reversed but the relation between the energy gain and the similarity of phase is maintained .",
    "this process induces an anti - correlation between the initial energy change and the subsequent change when the wave reverses .",
    "figure [ fig : devr_delzsg6 ] shows the correlation of the additional energy change following the perturbation ( @xmath114 ) with the radial velocity of stars in the half - mass bin .",
    "figure [ fig : dede_delzsg6 ] demonstrates that this produces an anti - correlation of @xmath113 with the initial kick , @xmath115 .",
    "the phase mixing of stars during potential fluctuations leads to a very smooth final distribution of energies in the bin ( figure [ fig : delz_sg6_d ] ) .",
    "since it fits the expected gaussian function , the distribution can be described by only the first two moments , @xmath0 and @xmath7 .",
    "another point of view has been suggested by the referee , m. weinberg ( also , @xcite ) .",
    "stellar actions , the radial action @xmath116 and the angular momentum @xmath117 , change after the impulsive shock . during a relatively slow virialization process following the shock ,",
    "the actions are conserved and so is the phase space available to stars of the same initial energy .",
    "however , the energy space has decreased after the virialization , causing the corresponding decrease of the energy dispersion , @xmath7 .",
    "we have checked the postshock conservation of the phase space in run b. the angular momentum is virtually conserved , although @xmath118 increases in the cluster core due to numerical relaxation effects .",
    "the radial action grows during the virialization , presumably because of the change of the potential .",
    "the dispersion of the radial action , @xmath119 , increases in the core due to numerical effects but decreases slightly in the middle parts of the cluster .",
    "we find that the value of @xmath119 drops by 9% at the half - mass radius and by 13% at larger radii . at the tidal radius ,",
    "@xmath120 again increases relative to the impulsive value .",
    "although of lower amplitude than the corresponding reduction of the energy dispersion ( 39% and 34% , respectively ) , the _ decrease _ of the dispersion of the radial action during the postshock phase is not a numerical effect .",
    "this must be a contribution of the collective oscillatory effects , in addition to the change of the potential .",
    "having explored the general features of the self - gravitating response of the cluster to the impulsive perturbation , we now turn to modeling the more realistic time - varying shocking . for the disk shocking in the galaxy ,",
    "the vertical gravitational acceleration towards the galactic plane can be approximated by a gaussian function of the height @xmath121 , with the characteristic thickness @xmath31 .",
    "if we assume a constant vertical component of the cluster velocity during the passage through the disk , the tidal force will vary as @xmath122 .",
    "therefore , we apply a shock of the form @xmath123 where @xmath124 to give the same total energy change for @xmath125 as in the impulsive shocking . here",
    "@xmath26 is the effective duration of the shock ( eq . [ [ eq : tau ] ] ) ,",
    "which we have chosen to be equal to the half - mass dynamical time , @xmath126 , for runs c and d. we start the simulation long before the maximum amplitude of the shock occurs at @xmath127 and then follow the evolution for @xmath128 .",
    "figure [ fig : expz_sg6_e ] shows the total energy change for run d. this plot is similar to figure [ fig : delz_sg6_e ] for the impulsive shocking , except that here @xmath129 is reduced because of the conservation of the adiabatic invariants of central stars ( see also  [ sec : detot ] ) .",
    "the distribution of the energy changes for the fixed potential ( figure [ fig : expz_fix6_b ] ) is intermediate of those predicted by spitzer s ( eq . [ [ eq : spcorr ] ] ) and weinberg s ( eq . [ [ eq : wcorr ] ] ) adiabatic corrections .",
    "we find that the results in a new equilibrium can be fitted with a reasonable accuracy by equations ( [ eq : defix ] ) with the adiabatic corrections of the form    @xmath130    [ eq : simcorr ]    with @xmath131 and @xmath132 .",
    "to test the general applicability of these expressions , we have run the simulations varying the duration of the shock from @xmath133 to @xmath134 , and also varying the shock amplitude , @xmath135 .",
    "all of the simulation results scale with @xmath136 , as expected .",
    "we find that for @xmath137 ( on the lower end for the real disk shocking ) , equations ( [ eq : simcorr ] ) describe the results of the simulations very well .",
    "for the more prolongated shocks , the slope of the adiabatic correction becomes shallower .",
    "nevertheless , the results can be fitted by the same functional form , with the exponents given in table [ tab : gamma ] .",
    "note that for the large values of @xmath26 , the overall effect of shocking decreases ( @xmath138 ) and so does the accuracy of the fits .",
    "however , it is likely that the adiabatic corrections are less steep for @xmath139 . in the limit of `` slow shocks '' ,",
    "the asymptotic weinberg s result ( [ eq : wcorr ] ) becomes valid , as expected .",
    "we have also checked whether the adiabatic corrections are dependent upon the structure of the cluster .",
    "we have run the self - consistent simulation for another king model , with the concentration parameter @xmath140 .",
    "the fitting formulae ( eq . [ [ eq : simcorr ] ] ) slightly underestimate the energy change and dispersion in the core and the extreme edge of the cluster , but they hold for most of the intermediate range .",
    "the statistical errors are small and do not affect the comparison .",
    "still , it is possible that our fitting expressions might break for very concentrated clusters and thus should be taken with caution .",
    "finally , figure [ fig : expz_sg6_b ] shows the energy changes at the end of run d , the self - gravitating simulation of disk shocking . as in the impulsive case ,",
    "the stellar energies are enhanced everywhere in the cluster .",
    "our fit to the simulation results has no free parameters : it is a sum of @xmath10 expected for the fixed potential ( eqs . [ [ eq : defix ] ] and [ [ eq : simcorr ] ] ) and the self - similar potential change ( eq . [ [ eq : depot ] ] ) . although not exact , the fits are reasonably good . also , we find no additional contribution to the dispersion of energy due to potential fluctuations .",
    "one of the predictions of weinberg s ( 1994 ) linear theory is that in the limit of large @xmath26 , the change of the total energy of the cluster due to a tidal shock with a fixed amplitude is inversely proportional to its duration . since in our simulations the amplitude of the shock scales as @xmath141 , to conserve the integral of the perturbing force , we expect the total energy change to scale as @xmath142 .",
    "we use the results of the simulations with various parameters @xmath26 and @xmath135 to test that prediction .",
    "figure [ fig : expz_tau ] shows that in the limit @xmath143 , the value of @xmath129 is constant . for the extended shocks ,",
    "the energy change follows a power - law .",
    "the fitting formula that combines both limits and provides a good match in the middle ( figure [ fig : expz_tau ] ) is @xmath144 this assures the validity of the linear theory in predicting the integral characteristics of the system .",
    "the main effects of the evolution of the potential , an additional heating in the core and the decrease of the energy dispersion in the middle of the cluster , are new .",
    "to check that these effects are not restricted only to the one - dimensional disk shocking , we investigate another type of tidal perturbation , _ radial _ shocking , and use a completely independent numerical code to examine this phenomenon .",
    "the instant acceleration is proportional to the radius - vector of the star and is directed towards the center : @xmath145 the symmetry of the perturbation in a spherical cluster allows us to use spitzer s shell method ( @xcite ) to test the scf code .",
    "we will see that the qualitative properties of our solutions survive the change in numerical methods .",
    "the shell method , originated from an early work by @xcite , makes use of the spherical symmetry of the system .",
    "a shell @xmath12 represents an ensemble of stars at the radius @xmath146 with the energy @xmath11 and angular momentum @xmath147 .",
    "the shell moves in radial direction with the velocity @xmath148 and can freely penetrate other shells .",
    "all shells are assumed to have the same mass , @xmath149 . for shells arranged in order of increasing radius @xmath146 ,",
    "the equations of motion are @xmath150 the factor @xmath151 takes into account self - gravity of the shell @xmath12 .",
    "while the equations of motion in the spherical system enjoy the simplicity of newton s theorem ( the force on a shell is determined entirely by the number of enclosed shells ) , the calculation of the potential involves all shells : @xmath152 where @xmath153 is the total number of shells .",
    "therefore , the energy of the shell , @xmath154 , depends not only on its own motion , but also on the position of the shells outside .",
    "this method was successfully applied by spitzer and collaborators at princeton to study the evolution of a spherical star cluster under the influence of the explicitly imposed perturbations imitating two - body encounters between stars ( see @xcite for a detailed reference ) .",
    "a small energy imbalance resulting from the perturbations was corrected for by adjusting the kinetic energy of the shells .    testing the method without external perturbations",
    ", we noticed that the total energy of the system was not conserved .",
    "the energy grew monotonically with time with the rate proportional to the time step .",
    "the reason for the nonconservation of energy is the force discontinuity when two shells cross each other .",
    "accordingly , we introduced a two - step correction procedure .",
    "first , instead of solving the second order differential equation ( [ eq : motion ] ) as a pair of the first order equations , we integrated the equation once to obtain a first integral of motion , @xmath155 : @xmath156 this equation was then solved numerically to advance shells in radial direction .",
    "the advantage of solving this equation is in continuity of the velocity @xmath148 during shell crossing .",
    "the second correction takes care of readjusting @xmath155 after each shell crossing .",
    "this procedure assures conservation of the total energy of the cluster , @xmath157 , which has to be a linear combination of the integrals of motion , @xmath155 . as is easily checked , @xmath158 , with the sum extending over all shells .",
    "our test runs show exact conservation of @xmath157 in the absence of perturbations .",
    "another correction is necessary to solve equation ( [ eq : motion2 ] ) .",
    "when a shell is close to its turnover points , @xmath159 or @xmath160 , in a given time step it may jump over to the region of imaginary velocities @xmath161 .",
    "the positions of such shells are integrated in two steps , first up to the turnover point , and then back with the reversed velocity .",
    "we used the same initial conditions as for the three - dimensional simulations , projected onto the radial direction .",
    "the angular momentum of the shells was calculated from their initial positions and velocities and then kept constant for the rest of the simulation .",
    "we have checked that the initial conditions represent the assumed king model with correct density profile and energy distribution .",
    "the nature of the correction procedure for shell crossing is intrinsically serial , due to the simultaneous adjustment of the constants @xmath155 for both shells involved in the crossing .",
    "the number of crossings in a given volume grows very fast with @xmath153 , inflating the number of required operations .",
    "the largest run reasonable in computational time involves @xmath162 shells .",
    "this disadvantage is compensated for by the high precision of the results .",
    "figure [ fig : delr_sh5_b ] shows the energy changes for the impulsive radial shocking ( run e ) .",
    "this plot is qualitatively similar to the impulsive disk shocking ( see figure [ fig : delz_sg6_b ] ) .",
    "we are again able to fit the results with the sum of the analytical prediction for the fixed potential and the self - similar potential change :    @xmath163    [ eq : deshell ]    this simple fit seems to hold for the radial shocking as well .",
    "however , once again the energy dispersion is decreased by the postshock evolution .",
    "the effect at the end of the simulation is even stronger than it was in the case of disk shocking .",
    "this negative feedback must be due to an even stronger anti - correlation of the effects of the fluctuating potential with the motion of stars at the time of shocking .      for comparison with the shell method",
    ", we have run the three - dimensional scf simulation with the radial perturbation ( eq .",
    "[ [ eq : delrshock ] ] ) .",
    "run f involves the same initial conditions as the disk shocking case .",
    "the results of the 3d simulation and the 1d shell method are very similar ( cf . figures [ fig : delr_sh5_b ] and [ fig : delr_sg6_b ] ) .",
    "the same fit ( eq . [ [ eq : deshell ] ] ) is used for both runs and describes @xmath0 adequately .",
    "the reduction of the dispersion is present in both simulations , constituting a convincing result .",
    "we have also checked that numerical errors do not contribute to our results .",
    "we have explored tidal disk shocking on a star cluster using two independent types of self - consistent n - body simulations .",
    "as expected , the effects in the outer parts of the cluster are well described by the classic impulse approximation , but at the half - mass radius and in the inner parts , the effects are more complex .",
    "one of the main goals of this paper was to investigate the conservation of adiabatic invariants of stellar orbits and to obtain convenient adiabatic corrections that could subsequently be used in the fokker - planck calculations .",
    "solution of the fokker - planck equation is easier and much faster than full n - body simulations ( see , for example , @xcite ) .",
    "the details of our f - p code are given in @xcite .",
    "the fokker - planck code assumes a gaussian distribution of the energy changes of individual stars around the mean value , @xmath10 , in each energy bin .",
    "we have checked that the final distribution in our simulations is very nearly normal ( figure [ fig : delz_sg6_d ] ) , allowing us to use the two variables , @xmath10 and @xmath7 , to describe the effects of shocking .",
    "alternatively , one can use the full formalism of the linear theory of weinberg ( 1994a - c ) and @xcite ( 1997a - c ) .",
    "first , let us address the mean energy change , @xmath10 .",
    "it is given by equation ( [ eq : de_av ] ) , where we find the adiabatic correction @xmath164 given approximately by @xmath165 for shock durations comparable to the half - mass dynamical time , and by @xmath166 for `` slow shocks '' .",
    "these results apply when the postshock evolution of the potential is neglected .",
    "if the latter is included , the net effect is to produce an additional heating due to the self - similar potential readjustment , @xmath167 , where @xmath112 is a fixed normalization constant ( not a free parameter ! ) .",
    "this second change is qualitatively similar to the method used by @xcite ( 1997 ) for correcting the cluster energies to allow for adjustment to a new equilibrium , but different in detail in that the exact treatment allows for the exchange of energy between the stars , which occurs after the shock .",
    "the second order energy changes have similar adiabatic corrections ( cf . table [ tab : gamma ] ) , varying from @xmath168 to @xmath169 as the shock duration increases . in a self - consistent ( time - varying ) potential",
    ", the postshock evolution tends paradoxically to _ decrease _ the energy dispersion because of an anti - correlation between the initial energy change and the subsequent virialization .",
    "finally , we found that the change in the total energy of the cluster as a function of shock duration is in good agreement with the prediction of the linear theory .",
    "when the integral of the perturbing force is kept fixed , @xmath142 for @xmath170 .    a detailed fokker - planck treatment of the cluster evolution will be reported in @xcite .",
    "but we can note here what changes are expected when the postshock oscillations are allowed .",
    "we expect that incorporating the additional first order effect ( @xmath10 ) into the fokker - planck code will increase the rate of cluster evolution , leading to more rapid core collapse .",
    "paradoxically , the second order effect ( @xmath171 ) of postshock oscillations appears to lead to a small reduction in the overall value of the relaxation and a consequent reduction in the rate of the relaxation - driven evolution .",
    "we would like to thank lyman spitzer jr .",
    ", jeremy goodman , douglas heggie , david spergel and scott tremaine for discussions , antonio peimbert for suggesting an efficient implementation of the shell method , and the referee , martin weinberg , for a number of useful comments .",
    "we are especially indebted to kathryn johnston and lars hernquist for their help at the beginning on this project .",
    "finally , we are grateful to lars hernquist for letting us use his original version of the scf code .",
    "this project was supported in part by nsf grant ast 94 - 24416 .",
    "we have implemented the self - consistent field code on two different platforms , the sgi power challenge with shared memory architecture and the ibm sp2 array with distributed memory .",
    "the benchmark tests on r8000 processors of the power challenge show that the computational time scales perfectly linearly with the number of particles , from @xmath172 to @xmath77 .",
    "the speed - up factor per processor is also close to unity , indicating that the code is ideally parallelizible .",
    "figure [ fig : scale_cpu ] illustrates the speed - up gain per time step per particle as a function of the number of cpu .",
    "the gain factor is about 3.8 , 6.6 , and 11.5 for 4 , 8 , and 14 cpu , respectively .",
    "the performance of the scf code on sgi power challenge can be compared to its implementation on a connection machine 5 reported by @xcite .",
    "the number of operations per particle depends on the number of coefficients retained in the expansion of the potential - density pair . for our test simulations ,",
    "we have taken @xmath59 , @xmath60 .",
    "an independent measure of the performance is the computational time , @xmath173 , per time step per particle per number of the expansion coefficients times the number of cpu .",
    "@xcite report @xmath174s for their runs ( their table 1 ) . on the power challenge",
    ", we get a little better speed , @xmath175s .",
    "the average time per time step on a single processor in the run with @xmath77 particles was 120 s.    we have also done a set of runs on sgi origin 2000 machine with r10000 processors . on a single cpu of origin 2000 , the code runs 2.9 times faster than on the corresponding r8000 processor of the power challenge .",
    "however , the speed - up rate with number of cpu was a little lower .",
    "finally , we have implemented the scf code on ibm sp2 at the maui high performance computing center using message passing interface ( mpi ) .",
    "our preliminary tests show similar performance of the code on sp2 and the power challenge .",
    "we calculate here the correlation function of the mean positions and velocities of stars of the same energy , @xmath99 .",
    "this function appears in the analytical expressions for the energy dispersion due to tidal shocks ( eqs . [ [ eq : defix ] ] and [ [ eq : deshell ] ] ) .",
    "consider a spherically - symmetric stellar system .",
    "we seek to establish a relation of the form @xmath176 where the correlation function @xmath177 can depend only on the energy . introducing the integrals @xmath178 where @xmath179 is the delta - function restricting the integration to the stars of energy @xmath99 ,",
    "we can write the phase space averaging as @xmath180 and therefore @xmath181 the integration over the velocity space is straightforward with the aid of the delta - function .",
    "also , the distribution function @xmath182 drops out of integration since the energy is constant . cancelling some constants",
    ", we can redefine the interesting integrals as @xmath183^{1+n \\over 2 } \\",
    ", dr,\\ ] ] where @xmath184 is the maximum radius a star of energy @xmath99 can reach , determined by the following condition : @xmath185 . after a simple dimensionalization of the integrals ,",
    "we finally define @xmath186^{1+n \\over 2 } \\ , dx , \\label{eq : corr_int}\\ ] ] where @xmath187 is an arbitrary constant .",
    "note that the expression for @xmath188 has an equal number of the @xmath189 and @xmath190 indices in the numerator and the denominator , so that we can cancel from the integration factors such as @xmath191 and @xmath192 .",
    "equation ( [ eq : corr_int ] ) can now be solved numerically for any given potential @xmath193 .",
    "it is useful to choose the value of the constant @xmath187 at the center of the cluster .",
    "note , that if the potential obeys a simple power - law , @xmath194 , the integral ( [ eq : corr_int ] ) can be done analytically .",
    "the correlation function assumes a particularly simple form , @xmath195 depending only on the power - law index , @xmath196 . in general , @xmath100 is always negative for self - gravitating systems .",
    "it varies from @xmath197 for the harmonic potential to @xmath198 for the keplerian potential , and lies somewhere inbetween for other systems .",
    "we have calculated the correlation function for a number of king models with various concentrations , @xmath112 , and fitted the results as a function of the normalized stellar energy @xmath199 : @xmath200 the fit is accurate to 2% for the range of concentration parameters @xmath201 to @xmath202 .    by doing the angular integrals , it is straightforward to show that for spherical systems with isotropic velocity distribution any combination of one - dimensional coordinates and velocities has the same correlation function .",
    "for example , @xmath203    lccc a & impulsive & vertical & fixed b & impulsive & vertical & self - consistent c & time - varying & vertical & fixed d & time - varying & vertical & self - consistent e ( shells ) & impulsive & radial & self - consistent f & impulsive & radial & self - consistent"
  ],
  "abstract_text": [
    "<S> we study the reaction of a globular star cluster to a time - varying tidal perturbation ( gravitational shock ) using self - consistent n - body simulations and address two questions . </S>",
    "<S> first , to what extent is the cluster interior protected by adiabatic invariants . </S>",
    "<S> second , how much further energy change does the postshock evolution of the cluster potential produce and how much does it affect the dispersion of stellar energies . </S>",
    "<S> we introduce the _ adiabatic correction _ as ratio of the energy change , @xmath0 , to its value in the impulse approximation . when the potential is kept fixed , the numerical results for the adiabatic correction for stars with orbital frequency @xmath1 can be approximated as @xmath2 . for shocks with the characteristic duration of the order the half - mass dynamical time of the cluster , @xmath3 , the exponent @xmath4 . for more prolonged shocks , @xmath5 , </S>",
    "<S> the adiabatic correction is shallower , @xmath6 . </S>",
    "<S> when we allow for self - gravity and potential oscillations which follow the shock , the energy of stars in the core changes significantly , while the total energy of the system is conserved . paradoxically , the postshock potential fluctuations _ reduce _ the total amount of energy dispersion , @xmath7 . </S>",
    "<S> the effect is small but real and is due to the postshock energy change being statistically anti - correlated with the shock induced heating . </S>",
    "<S> these results are to be applied to fokker - planck models of the evolution of globular clusters . </S>"
  ]
}