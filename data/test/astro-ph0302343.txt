{
  "article_text": [
    "@xmath0-body simulations of structure formation in the early universe , of galaxies and plasmas are limited crucially by noise ( e.g. , dawson 1983 ; birdsall & langdon 1991 ; pfenniger 1993 ; pfenniger & friedli 1993 ; splinter et al .",
    "1998 ; baertschiger & sylos labini 2002 ; hamana , yoshida & suto 2002 ; huber & pfenniger 2002 ; semelin & combes 2002 ) .",
    "the number of particles @xmath0 that can be used is several orders of magnitude smaller than the real number of bodies .",
    "this implies that fluctuations of physical quantities become drastically exaggerated , and that their contribution to the overall dynamics can even become dominant .",
    "one way to reduce noise in simulations is to soften the interaction at short distances .",
    "softening can be optimized so as to suppress small - scale fluctuations while respecting the large - scale dynamical properties ( romeo 1994 , 1997 , 1998a , b ; dehnen 2001 ; see also byrd 1995 and references therein ) . on the other hand",
    ", noise also manifests itself as large - scale fluctuations , and the only known way to reduce them is to increase @xmath0 .",
    "this is very uneconomical because the computational cost scales at best linearly with @xmath0 .",
    "wavelets are a new mathematical tool that has proved to be of great help for noise reduction in digital signal / image processing ( see the beautiful presentation by mackenzie et al .",
    "2001 ; see also bergh , ekstedt & lindberg 1999 ) .",
    "the basic idea behind wavelets is that they provide a multi - resolution view of the signal .",
    "the signal is analysed first at the finest resolution consistent with the data , and then at coarser and coarser resolution levels . doing so , wavelets probe the structure of the signal and the contributions from its various scales .",
    "this is fundamental for noise reduction , since noise is present on all scales in the signal . using wavelets we can thus remove most of the noise without altering the inherent structure of the signal . and we can do this very quickly because the algorithm is even faster than the fast fourier transform .",
    "so why not use wavelets for reducing noise in simulations ?",
    "this is indeed the goal of our paper .",
    "the idea behind such an application is to de - noise simulations at each timestep .",
    "the resulting improvement is of unprecedented level compared with classical techniques : wavelet de - noising makes the simulation equivalent to a simulation with two orders of magnitude more particles .",
    "we provide convincing evidence that our wavelet method works so successfully by making a detailed prediction and carrying out three hard tests .",
    "the prediction is based on the improvement in signal - to - noise ratio for initial models of disc galaxies .",
    "the tests are devoted to probing the effects of both noise and wavelet de - noising on the simulations , with @xmath0 spanning two orders of magnitude . specifically :    1 .",
    "the first test concerns the fragmentation of a cool galactic disc , which is the onset of a gravitational instability ( see , e.g. , binney & tremaine 1987 ) .",
    "we show that the time at which the disc fragments is artificially shortened in simulations with moderate @xmath0 , whereas wavelet de - noising produces an output comparable to simulations with very large @xmath0 , as predicted .",
    "the second and third tests concern the heating and accretion following the fragmentation , respectively .",
    "these are fundamental processes in the dynamical evolution of disc galaxies , which is induced by gravitational instabilities via the outward transport of angular momentum and energy ( see , e.g. , binney & tremaine 1987 ) .",
    "so these tests also have a clear physical motivation .",
    "simulations with moderate @xmath0 show artificially enhanced heating and accretion , whereas wavelet de - noising produces an output consistent with the prediction .",
    "even though the prediction and the tests are specific to disc galaxies , our wavelet method is also expected to work successfully when applied to cosmological and plasma simulations .",
    "this is because the result depends mainly on the intrinsic properties of wavelets and on the type of noise in the simulation , as we explain incisively in the discussion .",
    "the rest of our paper is organized as follows .",
    "the method is presented in sect .  2 , where we give an overview of wavelets and data de - noising using wavelets , and",
    "explain how to use them for de - noising @xmath0-body simulations .",
    "the prediction is made in sect .  3 ,",
    "the three tests are carried out in sect.4 , and further points are discussed in sect .",
    "finally , the conclusion is drawn in sect .",
    "wavelets are a new , very successful , tool for analysing signals , which has exciting applications in physics , apart from engineering and mathematics ( see , e.g. , mallat 1998 ; bergh et al .",
    "in general , real signals are nonstationary , cover a wide range of frequencies , contain transient components ; and the characteristic frequencies of given segments of the signal are correlated with their time durations , in the sense that low / high frequencies imply long / short times .",
    "the standard fourier analysis is inappropriate for such signals because it loses all information about the time localization of a given frequency component , is very uneconomical and highly unstable with respect to perturbations .",
    "so real signals require a simultaneous time - frequency analysis .",
    "in general , a linear time - frequency transform can be written as @xmath1 where @xmath2 is the signal , @xmath3 is the transformed signal at scale @xmath4 ( frequency @xmath5 ) and position @xmath6 , and @xmath7 is the analysing function . in the windowed fourier transform , @xmath8 where the @xmath4-dependence is a modulation ,",
    "the @xmath6-dependence is a translation , and hence the windows @xmath7 have the same width as the basic @xmath9 .",
    "1 ( left ) shows that this transform has a fixed time - frequency resolution . in the wavelet transform , @xmath10 where the @xmath4-dependence is a dilation ( @xmath11 ) or a contraction ( @xmath12 ) ,",
    "the @xmath6-dependence is a translation , and hence the wavelets @xmath7 are self - similar to the basic @xmath9 .",
    "1 ( right ) shows that such a transform has an adaptive time - frequency resolution , which is an important property in favour of its choice .",
    "the inverse wavelet transform is @xmath13 where @xmath14 is a normalization constant ; and , under rather general assumptions , the admissibility condition for its existence is @xmath15 i.e.  wavelets have zero mean .",
    "a more general requirement is @xmath16 i.e.  wavelets have a certain number @xmath17 of vanishing moments .",
    "this and other requirements for the choice of @xmath9 are discussed in sect .",
    "2.2 . summarizing in other words ,",
    "the continuous wavelet transform has the meaning of a local filtering , both in time and in scale , and is non - negligible only when the wavelet matches the signal .",
    "the continuous wavelet transform can be extended to 2-d signals ( images ) by operating not only a scaling and a translation but also a rotation on the basic wavelet . and",
    "it can also be extended to signals defined on more general manifolds via group representation theory .",
    "the wavelet transform can be discretized by setting @xmath18 and @xmath19 ( @xmath20 integers ) , but this condition alone does not guarantee that the set of wavelets is an orthogonal basis .",
    "orthogonality is an important property because it means non - redundancy and thus fast algorithms , and besides it is a physically useful requirement ( see sect.2.2 ) .",
    "orthogonal and bi - orthogonal wavelet bases can be constructed with a mathematical technique known as multi - resolution analysis .",
    "the resulting algorithm is the fast wavelet transform and its complexity is @xmath21 , where @xmath22 is the size of the wavelet and @xmath23 ( @xmath24 positive integer ) is the size of the discrete signal .",
    "this algorithm is faster than the fast fourier transform , whose complexity is @xmath25 , and has a data storage of comparable efficiency .",
    "fig .  2 shows how the fast wavelet transform acts on the signal .",
    "the signal is decomposed into two parts : an approximation and a detail .",
    "the approximation is produced by passing the signal through a low - pass filter and rejecting every other data point .",
    "analogously , the detail is produced by high - pass filtering and down - sampling .",
    "the approximation is then itself decomposed into two parts : a coarser approximation and a coarser detail ; and the decomposition is iterated .",
    "while the wavelet analysis consists of decomposing the signal by filtering and down - sampling , the wavelet synthesis consists of reconstructing the signal by up - sampling and filtering , and the resulting algorithm is the inverse fast wavelet transform .",
    "the fast wavelet transform can be extended to images and @xmath26-d signals .",
    "the discussion basically follows the 1-d case , except that the signal is decomposed into @xmath27 parts : 1 approximation and @xmath28 details , one for each axis and each diagonal ; and so on .",
    "note that in this section ` signal ' , ` time ' and ` frequency ' also mean ` image ' , ` space ' and ` wavevector ' , or higher - dimensional counterparts , respectively .",
    "the adaptive time - frequency resolution and the non - redundancy of the fast wavelet transform have an important practical application : given a noisy signal , the underlying regular part gets mostly concentrated into few large wavelet coefficients , whereas noise is mostly mapped into many small wavelet coefficients .",
    "this means that , if we identify a correct threshold , then we can set all the small coefficients to zero and get back a signal almost decontaminated from noise .",
    "this is the idea behind data de - noising and explains why wavelets serve to filter noise so effectively , independent of general properties of the data such as the number of dimensions or the presence of symmetries ( see , e.g. , mallat 1998 ; bergh et al .",
    "1999 ) .      in the case of gaussian white noise",
    ", a correct threshold can be identified rigorously if the wavelet basis is orthogonal .",
    "the threshold is proportional to the standard deviation of noise , which can be robustly estimated from the smallest - scale detail coefficients , and the proportionality factor depends on the size of the signal .    in the case of poissonian noise , there is a method that produces good results .",
    "the method is to transform the poissonian data @xmath29 into data @xmath30 with ( additive ) gaussian white noise of standard deviation @xmath31 : @xmath32 ( anscombe 1948 ) , which can then be de - noised as discussed above . specifically , the anscombe transformation has the property to help achieving additivity , normalization and variance stabilization ( stuart & ord 1991 ) .",
    "on the other hand , it has a tendency to fail locally where the data have small values or large variations ( e.g. , kolaczyk 1997 ; starck , murtagh & bijaoui 1998 ) .",
    "those features may give rise to negative values in the de - noised data , which can be set to zero .",
    "the anscombe transformation also introduces a bias in the data ( e.g. , kolaczyk 1997 ; starck et al .",
    "the bias is additive and bounded , can be estimated analytically as @xmath33 ( stuart & ord 1991 ) or computed numerically and removed from the de - noised data .      in order to optimize data de - noising",
    ", we should choose a wavelet that satisfies the following requirements : ( 1 ) it has a small compact support and is symmetric , for a good time localization ; ( 2 ) it has a large number of vanishing moments and is regular , for a good frequency localization ; ( 3 ) it is orthogonal , for a correct threshold identification . on the other hand , orthogonal wavelets are not symmetric , with one uninteresting exception .",
    "the best alternative is to choose a symmetric bi - orthogonal wavelet that is also quasi - orthogonal .",
    "these rules select a few wavelets , from the more than a hundred commonly used .",
    "the final choice depends on the resolution required by the data .",
    "@xmath0-body simulations commonly use a grid for tabulating the particle density , and for computing the potential and the field ( see , e.g. , hockney & eastwood 1988 ) .",
    "the number of particles @xmath26 in each cell shows fluctuations @xmath34 with respect to an average @xmath35 .",
    "this means that the particle distribution is corrupted by noise that is basically poissonian , whereas the noise induced in the potential and in the field is of a more complex nature . using wavelets we can thus de - noise the particle distribution at each timestep and",
    "make the simulation equivalent to a simulation with many more particles .",
    "this is how it works .",
    "a very appropriate choice for de - noising of @xmath0-body simulations is the wavelet ` rbio6.8 ' , described in the documentation of the matlab wavelet toolbox ( misiti et al .",
    "this wavelet differs significantly from zero in an interval of approximately three mesh sizes , which is consistent with the effective spatial resolution of the simulations . in simulations dominated by small - scale structures , the",
    "wavelet ` rbio4.4 ' may be a better choice .",
    "in order to make specific predictions , we focus on @xmath0-body simulations of disc galaxies , and adopt a widely used cartesian code ( combes et al .  1990 ) . we choose realistic theoretical models that represent a truncated kuzmin disc of scale length @xmath36 kpc and cut - off radius @xmath37 kpc for various @xmath0 , @xmath38 and @xmath39 , where @xmath0 is the number of particles , @xmath38 is the number of cells in the physical grid and @xmath39 is the cell size ( see , e.g. , binney & tremaine 1987 ) .",
    "we then create noisy simulation models by generating random particle positions and tabulating @xmath26 at this initial time .",
    "we finally de - noise such models using the wavelet ` rbio6.8 ' .",
    "the amount of noise in the models is quantified by the signal - to - noise ratio @xmath40^{1/2}\\,,\\ ] ] where @xmath41 are the theoretical data and @xmath42 are either the noisy data or the wavelet de - noised data . in the de - noised data , @xmath43 means the inverse of an appropriately defined estimation error .",
    "3 illustrates wavelet de - noising in action in a high - resolution case ( fig .",
    "3a ) and in a low - resolution case ( fig .",
    "first of all , note that in the noisy simulation models @xmath44 for a given grid size @xmath45 , where @xmath46 is the average number of particles per cell .",
    "this is consistent with the fact that the noise is basically poissonian .",
    "then it follows that wavelet de - noising can improve the signal - to - noise ratio by one order of magnitude , as if the noisy model had two orders of magnitude more particles ( cf .",
    "3a ) . even in noisy models with low signal - to - noise ratios",
    "the improvement is comparable ( cf .",
    "the natural prediction is that the improvement shown for the initial models implies a comparable improvement in performance for the simulations .",
    "in order to test such a prediction , we explore a hard problem : the fragmentation of a cool galactic disc ( e.g. , semelin & combes 2000 ; huber & pfenniger 2001 ) . a rotating disc with low velocity dispersion is gravitationally unstable and therefore sensitive to perturbations , which are amplified and break the initial axial symmetry of the system .",
    "the time that characterizes symmetry breaking clearly depends on the initial amplitude of the perturbations , for small perturbations need a long time to grow into an observable level .",
    "in particular , this is true for the fluctuations imposed by granular initial conditions .",
    "thus the symmetry - breaking time is a clear diagnostic for quantifying the effect of noise on the simulation .",
    "our initial models are as in fig .",
    "3b , with the following additional specifications ( irrelevant in that context ) : disc mass @xmath47 m@xmath48 , plummer bulge - halo of comparable mass and scale length , plummer softening with softening length @xmath49 kpc , safronov - toomre parameter @xmath50 ( see , e.g. , binney & tremaine 1987 ) .",
    "we vary @xmath0 so as to test in detail the improvements predicted by fig .",
    "3b , and by an analogous examination of the gravitational field of the disc ( a factor of 18 ) .",
    "we run the simulations for 250 myr , a typical dynamical time .",
    "4 illustrates that in the wavelet de - noised simulation the symmetry - breaking time is even longer than in the best noisy simulation , which uses the largest number of particles allowed by computer memory .",
    "this is a strong piece of evidence that wavelet de - noising outperforms the predictions .      as an additional test",
    ", we investigate the heating following the fragmentation of a cool galactic disc .",
    "when spiral gravitational instabilities reach a sufficiently large amplitude , the velocity dispersion of the disc starts to increase by collective relaxation ( e.g. , zhang 1998 ; griv , gedalin & yuan 2002 ) .",
    "the heat produced in a dynamical time is low if the initial amplitude of the instabilities is small .",
    "therefore the increase of velocity dispersion is another diagnostic for quantifying the effect of noise on the simulation .",
    "5 illustrates that , on the whole , in the wavelet de - noised simulation the increase of velocity dispersion is smaller than in the noisy simulation with 42 times more particles .",
    "this is a further piece of evidence that wavelet de - noising outperforms the predictions .      as a further test",
    ", we analyse the accretion following the fragmentation of a cool galactic disc .",
    "the amplification of spiral gravitational instabilities produces not only heating but also re - distribution of matter in the disc , which appears more evidently as accretion near the centre ( e.g. , zhang 1998 ; griv et al .",
    "the mass accreted in a dynamical time is low if the initial amplitude of the instabilities is small .",
    "so the peak of mass density is still another diagnostic for quantifying the effect of noise on the simulation .",
    "6 strengthens our result by confirming , once again , that wavelet de - noising outperforms the predictions .",
    "wavelet de - noising suppresses almost all the noise but introduces slight local biases , which have no significant effect on the conservation of angular momentum and energy .",
    "in fact , the deviations are less than 0.04% and 0.06% per dynamical time , respectively , and compare well with those typical of the code ( combes et al .  1990 ) .",
    "the improvement in performance concerns not only the fidelity of simulations to real systems , shown in figs 36 and discussed above , but also the standard computational issues ( time , memory and storage ) .",
    "this improvement is by one / two orders of magnitude in the low / high - resolution case examined .",
    "note in this context that an important , albeit non - classical , reason for increasing the number of particles is to improve the resolution .",
    "optimal choices of @xmath0 , @xmath39 and @xmath51 are interdependent ( e.g. , hernquist , hut & makino 1993 ; dehnen 2001 ) , and besides they strongly depend on the physical problem under investigation ( romeo 1998a ; dehnen 2001 ) . wavelet de - noising acts so as to increase the equivalent number of particles , therefore analogous considerations apply .",
    "further points are discussed below .",
    "the spatial scales on which noise is ` significant ' depend upon what physical quantity is considered : the particle density , the potential , the field , or other quantities related to the dynamical effect of noise such as the relaxation time ( in this case one often refers to the relative contribution of distant and close encounters ; e.g. , dehnen 2001 ) . in particular , the particle distribution is affected by noise that is basically poissonian and white , and hence significant on all scales . as noted in sect .",
    "2.2 and adapted to the present context , wavelets succeed in suppressing this type of noise not only on small but also on _ large _ scales , _ without _ damping real instabilities .",
    "indeed , this is what makes wavelets so successful in comparison with other methods of noise reduction ( see the literature quoted ) .      the prediction and the tests shown in previous sections concern disc galaxies , whose simulation models are commonly flat and initially axisymmetric .",
    "appropriate 3-d tests regarding this or other types of galaxies would demand an exceedingly large number of particles , @xmath52 , in order to have a satisfactory signal - to - noise ratio in the basic simulation ( an average of a few particles per cell ) and in order to be able to run simulations with two orders of magnitude more particles . on the other hand , as noted in sect .",
    "2.2.1 , the remarkable efficiency of wavelets in suppressing noise is an _ intrinsic _ property of such functions , which has been tested _",
    "extensively _ in the literature .",
    "because of that the initial symmetry is also irrelevant , apart from the fact that it breaks quickly .",
    "if any remark should be made , then note that axisymmetry is an unfavourable initial condition since the fast wavelet transform has privileged directions : the cartesian axes and diagonals ( see sect .",
    "thus the result of our paper is also expected to hold in 3d , with or without initial symmetry .",
    "can our wavelet method be applied to plasma and cosmological simulations ?",
    "the case of plasma simulations is rather clear .",
    "even if the initial models are non - noisy , poissonian noise develops in few dynamical times ( see , e.g. , dawson 1983 ; birdsall & langdon 1991 ) . wavelet de - noising can be applied from the start , since it prevents the onset of noise without affecting the quiet model .",
    "the case of cosmological simulations is more complex but is also quite clear .",
    "the initial conditions consist of setting up a non - noisy uniform particle distribution , and of imposing small random fluctuations with gaussian statistics and a given power spectrum ( e.g. , efstathiou et al.1985 ; sylos labini et al .",
    "poissonian noise develops naturally , as a reaction of the system to the initial order and hence reduced entropy .",
    "the onset of poissonian noise is especially quick in cold - dark - matter simulations , where structures form bottom - up and the first virialized systems contain a small number of particles ( e.g. , binney & knebe 2002 ) .",
    "there is a natural way to apply our wavelet method to cold - dark - matter simulations .",
    "it is to de - noise them only over a range of scales that is adapted to the phase of clustering : from the cell size to the size of the structures that have formed latest .",
    "analogous ideas can be implemented in the context of other cosmological models . in this way",
    "wavelet de - noising prevents the onset of poissonian noise without affecting the imposed fluctuations , or the quiet background .",
    "thus our wavelet method can be applied not only to galaxy but also to cosmological and plasma simulations , with minor adaptions .",
    "the conclusion of this paper is that wavelet de - noising allows us to improve the performance of @xmath0-body simulations up to two orders of magnitude .",
    "this result has been shown for simulations of disc galaxies , and can be generalized to other grid geometries and particle species than those used here .",
    "besides , wavelet de - noising can be adapted for a variety of constraints ( e.g. , partial de - noising at given scales or at a pre - assigned level ) and initial conditions ( e.g. , partially noisy or quiet starts ) , and thus have important applications also in cosmological and plasma simulations .    our wavelet code will be described in a following paper , and will then be available on request .",
    "it is a great pleasure to thank gene byrd , franoise combes , stefan goedecker and daniel pfenniger for strong encouragement , valuable suggestions and discussions .",
    "we are very grateful to john black , alan pedlar and gustaf rydbeck for strong support .",
    "we also acknowledge the financial support of the swedish research council and a grant by the ` solveig och karl g eliassons minnesfond ' .    anscombe f. j. , 1948 , biometrika , 35 , 246 baertschiger t. , sylos labini f. , 2002 , europhys .",
    "lett . , 57 , 322 bergh j. , ekstedt f. , lindberg m. , 1999 , wavelets .",
    "studentlitteratur , lund binney j. , knebe a. , 2002 , mnras , 333 , 378 binney j. , tremaine s. , 1987 , galactic dynamics . princeton university press , princeton ( errata in astro - ph/9304010 ) birdsall c. k. , langdon a. b. , 1991 , plasma physics via computer simulation .",
    "institute of physics publishing , bristol byrd g. , 1995 , in hunter j. h. jr . , wilson r. e. , eds , ann . n. y. acad .",
    "773 , waves in astrophysics .",
    "n. y. acad .",
    "sci . , n. y. , p. 302 combes f. , debbasch f. , friedli d. , pfenniger d. , 1990 , a&a , 233 , 82 dawson j. m. , 1983 , rev",
    ", 55 , 403 dehnen w. , 2001 , mnras , 324 , 273 efstathiou g. , davis m. , frenk c. s. , white s. d. m. , 1985 , apjs , 57 , 241 griv e. , gedalin m. , yuan c. , 2002 , a&a , 383 , 338 hamana t. , yoshida n. , suto y. , 2002 , apj , 568 , 455 hernquist l. , hut p. , makino j. , 1993 , apj , 402 , l85 ( erratum in apj , 411 , l53 ) hockney r. w. , eastwood j. w. , 1988 , computer simulation using particles .",
    "institute of physics publishing , bristol huber d. , pfenniger d. , 2001 , a&a , 374 , 465 huber d. , pfenniger d. , 2002 , a&a , 386 , 359 kolaczyk e. d. , 1997 , apj , 483 , 340 mackenzie d. et al .",
    ", 2001 , in beyond discovery : the path from research to human benefit  wavelets : seeing the forest and the trees . national academy of sciences , washington ( ` http://www.beyonddiscovery.org/ ` ) mallat s. , 1998 , a wavelet tour of signal processing . academic press , san diego misiti m. , misiti y. , oppenheim g. , poggi j .- m . ,",
    "1997 , wavelet toolbox for use with matlab : user s guide .",
    "the mathworks , natick pfenniger d. , 1993 , in combes f. , athanassoula e. , eds , @xmath0-body problems and gravitational dynamics . observatoire de paris , paris , p. 1",
    "pfenniger d. , friedli d. , 1993 , a&a , 270 , 561 romeo a. b. , 1994 , a&a , 286 , 799 romeo a. b. , 1997 , a&a , 324 , 523 romeo a. b. , 1998a , a&a , 335 , 922 romeo a. b. , 1998b , in salucci p. , ed .",
    ", dark matter .",
    "studio editoriale fiorentino , firenze , p. 177 semelin b. , combes f. , 2000 , a&a , 360 , 1096 semelin b. , combes f. , 2002 , a&a , 388 , 826 splinter r. j. , melott a. l. , shandarin s. f. , suto y. , 1998 , apj , 497 , 38 starck j .- l .",
    ", murtagh f. , bijaoui a. , 1998 , image processing and data analysis : the multiscale approach . cambridge university press , cambridge stuart a. , ord j. k. , 1991 , kendall s advanced theory of statistics  vol .",
    "2 : classical inference and relationship . hodder & stoughton  arnold , london sylos labini f. , baertschiger t. , gabrielli a. , joyce m. , 2002 , in press ( astro - ph/0211058 ) zhang x. , 1998 , apj , 499 , 93"
  ],
  "abstract_text": [
    "<S> noise is a problem of major concern for @xmath0-body simulations of structure formation in the early universe , of galaxies and plasmas . here for the first time we use wavelets to remove noise from @xmath0-body simulations of disc galaxies , and show that they become equivalent to simulations with two orders of magnitude more particles . </S>",
    "<S> we expect a comparable improvement in performance for cosmological and plasma simulations . our wavelet code will be described in a following paper , and will then be available on request .    </S>",
    "<S> [ firstpage ]    plasmas  methods : @xmath0-body simulations  methods : numerical  galaxies : general  galaxies : kinematics and dynamics  cosmology : miscellaneous . </S>"
  ]
}