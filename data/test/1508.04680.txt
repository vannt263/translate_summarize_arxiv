{
  "article_text": [
    "quantum monte carlo ( qmc ) methods are a vital tool in the study of many - body systems@xcite , regularly providing the most accurate and reliable results for correlated fermionic systems of interest . while their application to the study of ground - state properties is common , the application of qmc methods to the calculation of excited - state properties is more challenging .",
    "such applications typically require the use of an accurate trial wave function with which to constrain the sampling dynamic of the excited state .",
    "an accurate trial wave function is generally more difficult to devise , while the results can be particularly sensitive to its form@xcite , compared to those generated for equivalent ground - state calculations . yet",
    "calculating accurate excited - state properties is key to understanding and predicting various important phenomena in photochemistry and beyond , and therefore much effort continues in this direction .    in 2009 , booth _ _",
    "et al.__@xcite introduced the full configuration interaction quantum monte carlo ( fciqmc ) method@xcite . in common with approaches such as diffusion monte carlo ( dmc ) and green s function monte carlo",
    ", fciqmc is a projector qmc method where the ground - state wave function is sampled by repeatedly projecting out higher energy states with an appropriate stochastically - sampled operator . while dmc performs sampling in real space , fciqmc samples the wave function in a discrete , antisymmetric space  typically a basis of slater determinants .",
    "furthermore , fciqmc does not require the use of a trial wave function or fixed node approximation to control the fermion sign problem .",
    "rather , the sign problem is controlled by an annihilation step , made efficient by the use of a discrete sampling space .",
    "already , several approaches have been used to adapt fciqmc to the calculation of excited states .",
    "booth and chan@xcite applied a projection operator of the form @xmath0 to converge to the eigenstate of @xmath1 whose energy is closest to @xmath2 .",
    "ten - no@xcite used the lwdin partitioning technique , utilizing an fciqmc - like dynamic to stochastically evolve the contribution outside the model space and diagonalizing the effective hamiltonian to obtain multiple eigenvalue estimates .",
    "humeniuk and mitri@xcite perform an exact diagonalization of the hamiltonian in a small space containing the majority of the wave function amplitude , and explicitly remove the resulting low - energy states from the projection operator in this diagonalized space .",
    "recently , three of us have introduced a scheme to project the hamiltonian into a space of stochastically - sampled krylov vectors , primarily to consider the calculation of spectral and finite - temperature properties , but also allowing the calculation of individual excited states@xcite . unlike many traditional excited - state qmc methods ,",
    "none of these approaches rely on trial wave functions .    in this article",
    "we introduce a new approach , whereby fciqmc wave functions are orthogonalized against each other in order to prevent collapse to the ground state .",
    "multiple fciqmc simulations are performed simultaneously , one for each state being targeted , and simulations for higher energy states are orthogonalized ( by a simple gram - schmidt procedure ) against those for lower states .",
    "this approach is particularly simple , requiring only this single extra step compared to ground - state fciqmc and very little code to implement in an existing fciqmc program@xcite .",
    "we find that , perhaps surprisingly , the approach is not affected by a noticeable systematic bias in any of our investigations thus far , and therefore systematic improvement to exact results for many excited states is possible .    in section  [ sec : fciqmc ] we briefly review fciqmc and its initiator adaptation . in section  [ sec : excited_theory ]",
    "we introduce our approach for obtaining excited states through orthogonalization , including a discussion of the approach s accuracy , and discuss practical details .",
    "results are presented in section  [ sec : results ] .",
    "we study the carbon dimer in cc - pvdz , cc - pvtz and cc - pvqz basis sets , comparing to accurate dmrg results in the quadruple - zeta basis .",
    "we also present initiator error convergence for various excited states .",
    "fciqmc is a projector qmc method whereby the wave function , represented in a sparse form by a list of walkers residing on basis states ( usually slater determinants ) , is projected to the ground state by repeated application of a projection operator . in fciqmc the projection operator used is @xmath3 where @xmath4 is a small time step , @xmath1 is the hamiltonian operator and @xmath2 is a shift parameter , varied slowly to keep the walker population roughly constant",
    ".    therefore , the wave function , @xmath5 ( at imaginary - time @xmath6 ) , obeys @xmath7 |\\psi(\\tau){\\rangle}. \\label{eq : update_eq}\\end{aligned}\\ ] ] fciqmc performs a _",
    "stochastic sampling _ of this projection so that the correct evolution is achieved on average .",
    "the rationale of this approach can be understood by expanding @xmath5 in the eigenbasis of the hamiltonian , @xmath8 , @xmath9 one finds @xmath10 |\\phi_i{\\rangle } , \\\\                        & = \\sum_i c_i(\\tau ) e^{-\\delta\\tau ( e_i - s ) } |\\phi_i{\\rangle}+ \\mathcal{o}((\\delta\\tau)^2 ) .",
    "\\label{eq : energy_decomp}\\end{aligned}\\ ] ] thus , excited - state contributions decay relative to the ground state at an exponential rate , and after sufficient applications of @xmath11 , a stochastic sampling of the ground - state wave function is achieved .    in practice",
    ", the stochastic application of @xmath11 is performed via spawning , death and annihilation steps , which we do not describe here but which have been discussed in detail in previous articles@xcite .    because of the sparse sampling of @xmath5 , this approach has significant memory savings compared to traditional fci .",
    "however , the approach can not use an arbitrarily small amount of memory due to the sign problem .",
    "if one considers the population of positive ( @xmath12 ) and negative ( @xmath13 ) walkers on sites @xmath14 , spencer @xmath15@xcite showed that a sign problem appears in fciqmc because , in the absence of annihilation , the desired out - of - phase combination ( @xmath16 ) always decays relative to the in - phase combination ( @xmath17 ) , and so at constant populations the desired signal decays to zero ( except for rare sign - problem - free systems ) .",
    "this problem is resolved by an annihilation step , whereby two walkers of equal weight and opposite sign on the same determinant cancel out and are removed from the simulation , thus reducing the walker population s growth rate .",
    "however , in order to achieve a sufficient annihilation rate a system - specific minimum walker population must be used , in order to reach the so - called ` plateau ' .",
    "cleland _ et al .",
    "_ introduced the initiator adaptation to fciqmc@xcite in order to remove this minimum population threshold . in the initiator adaptation , all determinants with more than @xmath18 walkers are dubbed ` initiators ' , with @xmath18 typically equal to @xmath19 or @xmath20 .",
    "the spawning rules are then modified so that non - initiators can only spawn to determinants that were occupied in the previous iteration .",
    "initiators can spawn to any determinant as usual .",
    "previous descriptions of the initiator adaptation also define an exception to the above rules , that non - initiators can spawn to an unoccupied determinant if at least one more spawning occurs to the same determinant with the same sign that iteration , but we note that this exception seems to make no difference to results and so is not a key component .",
    "because the initiator adaptation greatly reduces the rate of spawning compared to the rate of annihilation , the desired signal ( @xmath16 ) no longer decays at small walker populations . as a result",
    ", the plateau is removed , and stable simulations ( in which the fluctuations in the energy remain bounded in the long imaginary - time limit ) can be performed with a relatively small number of walkers .",
    "this adaptation introduces an approximation ( and an associated ` initiator error ' ) because non - initiators can no longer perform the correct spawning dynamics dictated by eq .",
    "( [ eq : update_eq ] ) , and much of the hilbert space becomes instantaneously inaccessible .",
    "however , the initiator adaptation becomes exact as the walker population increases and more determinants become either initiators or occupied ( and therefore can be spawned upon by non - initiators ) . in the initiator method , therefore , the number of walkers represents a simulation parameter which can be increased to systematically converge to exact ( fci ) results . in most cases",
    "this limit can be essentially achieved with substantially fewer walkers than the full fciqmc scheme requires to overcome the plateau .",
    "recent work by petruzielo _ _",
    "et al.__@xcite introduced a semi - stochastic adaptation to fciqmc , whereby all projection within a subspace ( spanned by determinants in a set , @xmath21 ) is performed exactly , while the rest of the projection operator is performed stochastically with fciqmc .",
    "this can greatly reduce the stochastic noise associated with the projection , particularly if @xmath21 is chosen to contain the most highly - weighted determinants .",
    "we subsequently performed a detailed investigation of this adaptation in ref .",
    "( ) , and we use the approach introduced in this latter study in the results of this article .",
    "however , this adaptation is not required for the following excited - state approach to work , and the algorithm is unchanged regardless of whether it is in use or not .",
    "in our approach to sample excited states , multiple fciqmc simulations are performed simultaneously , one for each eigenstate to be sampled .",
    "we use @xmath22 and @xmath23 to label fciqmc simulations ( and therefore energy states ) , and @xmath14 and @xmath24 to label slater determinants ( basis states ) . to obtain the evolution equation for state @xmath23 , the ground - state evolution equation , eq .",
    "( [ eq : update_eq ] ) , is simply modified so that the components of lower energy states are removed : @xmath25 |\\psi^{n}(\\tau){\\rangle},\\ ] ] where @xmath26 to perform a stochastic version of this evolution for one iteration , each simulation is first evolved using the standard fciqmc algorithm@xcite . then , at the end of each iteration , after annihilation has been performed , the overlaps between all pairs of fciqmc wave functions are calculated , and the components of lower energy fciqmc states are removed from higher energy ones ( and therefore the ground - state simulation is unaffected by this step ) . thus , this procedure performs orthogonalization at each iteration against the _ instantaneous _ fciqmc wave functions .",
    "the rationale behind this step is clear from eq .",
    "( [ eq : energy_decomp ] ) . by removing accurate estimates of low energy states",
    ", the simulation converges to the next lowest - energy stationary state of @xmath1 instead .",
    "this step can be performed efficiently by storing the walker weights from all simulations together for a given determinant ( i.e. , in the same row or column of the array ) .",
    "some memory wastage is incurred , due to the need to store some zero weights , but this is easily made up for by algorithmic speed and algorithmic simplicity , especially as fciqmc calculations are not generally memory limited .    in practice , performing the orthogonalization step exactly will introduce some walkers with weights much less than one . for efficiency and memory reasons",
    "we stochastically round these small weights to a minimum occupancy threshold , @xmath27 , using an unbiased procedure which has been described elsewhere@xcite . in this article , @xmath28",
    "therefore , fciqmc simulations may not be exactly orthogonal at the start of each iteration .",
    "we note that a similar approach has been used by ohtsuka and nagase@xcite in their pmc - sd method@xcite . in this approach",
    "higher - energy states are orthogonalized against only a single stochastic wave function estimate , rather than simulating all states simultaneously and orthogonalizing against the differing instantaneous wave functions from each iteration .",
    "we expect the approach presented here to be more accurate because we orthogonalize against differing wave functions which will be correct on average , in contrast to orthogonalization against a single approximation to the wave function .",
    ", @xmath29 is enforced ( thus removing all degeneracy ) .",
    "the ground state was also simulated , but is not shown .",
    "@xmath30 walkers were used .",
    "the five simulations were started from single determinants in the five available @xmath31 , @xmath32 and @xmath33 configurations .",
    "exact values are shown with dashed lines .",
    "initiator and semi - stochastic adaptations were not used . ]    as a basic example for demonstration , figure  [ fig : he ] presents results of such a simulation for the he atom in the d - aug - cc - pv5z basis .",
    "energies for the lowest four excited states are shown converging gradually to the exact values .",
    "for this preliminary example , the ground state ( @xmath34 ) simulation starts from the @xmath31 determinant , while @xmath35 and @xmath34 excited simulations start from @xmath32 determinants and @xmath36 and @xmath37 simulations start from @xmath33 determinants .",
    "as described above , the ground state simulation is evolved using the standard fciqmc algorithm .",
    "all other simulations are evolved concurrently using fciqmc and , at the end of each iteration , the first excited state ( @xmath35 ) simulation is orthogonalized against the ground - state simulation , the second excited state ( @xmath34 ) simulation is orthogonalized against the ground and first excited state simulations , and so on , leading to a stable sampling of the appropriate energies .",
    "although the rationale behind this procedure is clear , one might wonder how well it will work in practice .",
    "a key property of the spawning dynamics in fciqmc and similar qmc methods is that they are , to a high degree of accuracy@xcite , unbiased .",
    "that is , the expectation value over the probability distribution associated with the possible fciqmc wave functions at an iteration should obey ( up to some normalization constant ) @xmath38 = \\boldsymbol{\\psi},\\ ] ] where @xmath39 is the stochastic fciqmc sampling of the exact wave function , @xmath40 .",
    "however , functions , @xmath41 , which are nonlinear in @xmath39 should not be estimated by @xmath42 $ ] because @xmath42 \\ne f(e[\\boldsymbol{q}])$ ] for nonlinear f. this was found in ref .",
    "( ) , where a clear bias was present in reduced density matrices obtained with this approach .    a similar concern can then be raised for the approach taken in the projection step above . on average",
    "one wishes to orthogonalize against the _ exact _ wave function , @xmath40 .",
    "however , if @xmath43 = \\boldsymbol{\\psi}$ ] then in general @xmath44 \\ne \\frac{\\boldsymbol{\\psi } \\ ; \\boldsymbol{\\psi}^{\\dagger}}{\\boldsymbol{\\psi}^{\\dagger}\\boldsymbol{\\psi } } , \\label{eq : proj_bias}\\ ] ] and so it seems that the orthogonalization operator is biased , and using it should introduce a bias towards an incorrect state .",
    "given the accuracy of the results to follow , one may wonder if there is in fact equality in eq .",
    "( [ eq : proj_bias ] ) , and may seek a proof of this . however , it is simple to devise probability distributions where this is not the case .",
    "for example , consider a completely delocalized wave function in a hilbert space of dimension @xmath21 , where each amplitude in the exact wave function has equal weight , and so @xmath45 for all @xmath14 .",
    "consider an extreme example where this wave function is sampled in an unbiased manner , by placing a single walker of weight one on a site , chosen uniformly .",
    "it is straightforward to show that in this case the expectation value in eq .",
    "( [ eq : proj_bias ] ) is actually proportional to the _ identity matrix_. thus , attempting to orthogonalize with such a poor sampling of @xmath40 will actually project _ any _ state towards the zero vector .",
    "however , this is clearly an extreme case .",
    "moreover , in the ( admittedly trivial ) limit of an entirely single - reference wave function ( @xmath46 ) the bias in this operator tends to zero ( by assuming that walkers only reside on site @xmath24 in this limit ) . for realistic fciqmc simulations we will demonstrate that any such bias seems to be extremely small . indeed , we have so far been unable to find a clear example of such an error in practice . as the bias decreases with walker number , it will appear as a component of the initiator error , and converge along side it .",
    "we then only require that the prefactor for any such bias is not excessively large . in all cases to date any bias has been substantially smaller than any measurable initiator error .    to demonstrate the level of accuracy possible for a model system , table  [ tab : hubbard ] presents results for a 14-site , 1d periodic hubbard model at @xmath47 .",
    "the sector with total crystal momentum ( @xmath48 ) and @xmath49 spin quantum number equal to zero was used .",
    "the total size of the hilbert space is @xmath50 , and approximately @xmath51 walkers were used per state ( just sufficient to exceed the plateaus ) . high accuracy is obtained for all states , and in the absence of initiator error it is clear that any remaining discrepancies are smaller than the magnitude of the smallest random errors which can be realistically achieved within fciqmc",
    ".    it would be interesting to study sign - problem free systems , such as the heisenberg model on a bipartite lattice , where even smaller walker populations could be used to assess a possible bias , although such systems typically suffer from a severe population control bias@xcite which would need to be removed .",
    "it is hypothesized that this anticipated bias is so small due to the very small contribution of the orthogonalization term each iteration , and the action of the unbiased projection term .",
    "each application of the orthogonalization operator removes all but very small components of the lower - energy states , which already leaves one with accurate estimates . in practice",
    "it is found that the overlap between fciqmc states remains very small throughout the simulations , and therefore the impact of this orthogonalization each iteration is small , and any bias introduced will be small also .",
    "this could become a problem if left to grow over many iterations .",
    "however , the unbiased part of the projection ( as described by eq .",
    "( [ eq : update_eq ] ) ) will systematically reduce this error every iteration by projecting back towards the correct states .",
    ".energy@xmath52 for the lowest - energy eigenstates for the 14-site , 1d periodic hubbard model , at @xmath47 .",
    "only the @xmath53 , @xmath54 sector was used .",
    "the fci values are always within 2 standard errors , which are of size @xmath55 for excited states .",
    "@xmath56 iterations were performed , with approximately @xmath51 walkers used per state .",
    "a cisd space was used to form both the deterministic and trial spaces@xcite .",
    "the initiator adaptation was _ not _ used , in order to remove initiator error to assess other potential biases instead . [ cols=\"^,^\",options=\"header \" , ]     it is interesting to compare the difference in initiator error between cc - pvtz and cc - pvqz .",
    "the cc - pvqz space size is roughly 120 times larger than that for the cc - pvtz case , yet a much smaller increase in walker number is required for similar accuracy with fciqmc .",
    "for example , in the ground state at equilibrium geometry , @xmath57 walkers are needed for @xmath58 accuracy in the cc - pvtz case , compared to @xmath59 walkers for the cc - pvqz case ( to more accurately describe the _ memory _ increase , we note that the number of occupied basis states in these two cases were @xmath60 and @xmath61 , respectively ) .",
    "this is a demonstration of sub - linear scaling of required memory in the fciqmc approach , which has been observed previously@xcite .",
    "table  [ tab : dmrg_comparison ] presents a comparison between fciqmc and recently - published dmrg results@xcite , for the three lowest states in the @xmath62 irrep . by comparing to the accuracy of ground - state dmrg calculations with a larger number of renormalized states ,",
    "the error in the dmrg excited state results was estimated at less than @xmath63 for the entire binding curve , with 4000 spin - adapted renormalized states kept for each excited state .",
    "based on the results of figure  [ fig : init_vqz ] , @xmath64 walkers were used per state for our fciqmc calculations .",
    "fciqmc results agree with the dmrg results to a very high degree of accuracy . for most bond lengths ,",
    "the dmrg results are approximately @xmath63 below the fciqmc values , with the dmrg results being variational .",
    "this remaining small error in the fciqmc results is most likely initiator error , and could be removed by using larger walker populations .",
    "we again note that it is possible that some error is due to the bias described in section  [ sec : excited_theory ] , however , we believe this unlikely because of the similar - sized discrepancy compared to dmrg is also present in the ground - state energy , which can contain no such bias .    at @xmath65 , and for the two excited states presented in table  [ tab : dmrg_comparison ] , the fciqmc energies are slightly ( @xmath66 ) lower than the dmrg values .",
    "this is despite the fact that figure  [ fig : init_vqz ] suggests that even the fciqmc error is larger at this stretched geometry than near equilibrium .",
    "this seems to suggest that the dmrg also has larger errors at stretched geometries , although in any case the errors seem to be very small .",
    "results of table  [ tab : dmrg_comparison ] are plotted in figure  [ fig : c2_vqz ] ( which also includes a quintet state , not studied in the dmrg calculations of ref .",
    "in chemical systems it is quite common for there to be a substantial gap between the ground and first excited states , and so excited - state contributions typically die away quickly in ground - state fciqmc simulations . in contrast , excited states typically populate the energy spectrum much more densely , and near - degeneracies are common . such near - degeneracies lead to very slow convergence and very long autocorrelation lengths , both of which lead to having to perform a large number of iterations .",
    "based on the calculations presented in this paper , we estimate that it is not uncommon to have to perform up to @xmath67 times more iterations to obtain enough independent samples of the energy from which to draw meaningful averages and error bars for all states , compared to a ground - state calculation .",
    "moreover , since excited - state calculations require one fciqmc simulation per state , the time required per iteration to obtain @xmath68 states is approximately @xmath68 times greater than for a ground - state fciqmc calculation",
    ". therefore , excited - state fciqmc calculations are undoubtedly more expensive than ground - state calculations .",
    "however , we believe that the difference is not in general prohibitively large , and is helped by efficient parallelization over processing cores@xcite ( additional parallelization of the algorithm over excited states is likely to be more efficient , but is not explored here ) . we therefore expect that most systems for which ground - state fciqmc is possible will also be suitable for this excited - state extension .",
    "the method is also able to obtain degenerate states with great accuracy .",
    "however , in such cases the issue of long auto - correlation lengths is often exacerbated due to the potential for rotation of the state within the degenerate subspace .",
    "this can be ameliorated by removing the degeneracy , if possible , by enforcing a further symmetry , such as @xmath69 symmetry . in the same manner as for other fciqmc calculations",
    ", it seems advisable to enforce as many symmetries as possible .",
    "this also reduces the possibility of state crossings , as seen in the c@xmath70 results above .",
    "we have introduced a simple approach for obtaining excited states from the fciqmc method , by performing an orthogonalization step between multiple simultaneous fciqmc simulations .",
    "this orthogonalization is performed against instantaneous stochastic snapshots of the true wave functions , yet this does not prevent the method from obtaining highly accurate results .",
    "low - lying states of the c@xmath70 molecule have been studied in cc - pvxz basis sets , for @xmath71 , @xmath20 and @xmath72 . in the quadruple - zeta basis",
    "set results were compared to accurate dmrg benchmarks , which were reproduced with roughly @xmath73 error .",
    "it was shown that the initiator adaptation is also effective for excited - state calculations .",
    "although initiator error does tend to be somewhat larger for excited states than for ground states , the favorable sub - linear scaling of walkers with hilbert space size seems to also hold for the excited states , as well as the ground state , for the c@xmath70 case considered here",
    ".    it should be straightforward to combine this approach with the recent unbiased reduced density matrix calculations within fciqmc@xcite , which will allow investigation of other properties of excited molecules , such as dipole moments , dipole polarizabilities , and nuclear forces@xcite .",
    "we thank alex thom for useful discussions and sandeep sharma for technical assistance .",
    "n.s.b . gratefully acknowledges trinity college , cambridge for funding .",
    "g.h.b . gratefully acknowledges the royal society for funding via a university research fellowship . this work has been supported by the epsrc under grant no .",
    "ep / j003867/1 .",
    "37ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty in  @noop _ _ ,  ( ,  )  pp .",
    "@noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we present a new approach to calculate excited states with the full configuration interaction quantum monte carlo ( fciqmc ) method . </S>",
    "<S> the approach uses a gram - schmidt procedure , instantaneously applied to the stochastically evolving distributions of walkers , to orthogonalize higher energy states against lower energy ones . </S>",
    "<S> it can thus be used to study several of the lowest - energy states of a system within the same symmetry . </S>",
    "<S> this additional step is particularly simple and computationally inexpensive , requiring only a small change to the underlying fciqmc algorithm . </S>",
    "<S> no trial wave functions or partitioning of the space is needed . </S>",
    "<S> the approach should allow excited states to be studied for systems similar to those accessible to the ground - state method , due to a comparable computational cost . </S>",
    "<S> as a first application we consider the carbon dimer in basis sets up to quadruple - zeta quality , and compare to existing results where available . </S>"
  ]
}