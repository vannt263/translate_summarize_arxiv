{
  "article_text": [
    "over the last decades computer processing speed has reached a level where even personal computers are able to solve quantum chemical calculations on moderately sized molecules .",
    "recently , we showed@xcite that molecules with on the order of one hundred atoms can be calculated on the millisecond timescale . as a result , quantum chemical calculations on such molecular structures can be carried out and analyzed instantaneously . in previous work",
    ", we implemented semi - empirical calculations in a real - time quantum chemistry framework.@xcite while such calculations are feasible with methods of density - functional theory,@xcite semi - empirical approaches that qualitatively reproduce all features of a born  oppenheimer potential energy surface are an attractive target for real - time quantum chemistry.@xcite in spite of their inherent approximations , the accuracy of these highly parametrized semi - empirical methods rivals that of standard quantum chemical methods.@xcite    in the real - time quantum chemistry framework@xcite , chemical systems can be interactively explored with a proper hardware device such as a force - feedback ( haptic ) device ( or an ordinary computer mouse)@xcite .",
    "results of the calculations such as the total electronic energy and the forces acting on the atoms are immediately transmitted back to the operator .",
    "this allows for an immersive exploration of the potential energy surface .",
    "other interactive applications of quantum chemistry comprise the real - time optimization of molecular structures@xcite and interactive _ ab initio _ molecular dynamics.@xcite    semi - empirical methods such as dftb2,@xcite dftb3,@xcite and pm6@xcite , which are available in our real - time quantum chemistry framework@xcite ,",
    "implement prototypical orbital models that require iterative self - consistent - field ( scf ) optimizations .",
    "scf methods are not trivial to apply in real time due to their iterative nature , which results in unpredictable calculation times .",
    "another problem is the difficulty of convergence control for molecular structures that are far away from their equilibrium geometry . as these issues do not vanish by application of convergence acceleration techniques , the scf procedure benefits from an initial guess density matrix close to the converged density matrix .    in this work ,",
    "we develop efficient density matrix propagation schemes that can reduce the number of scf iteration steps by extrapolation of converged density matrices obtained for preceding molecular structures of a real - time exploration .",
    "this work is organized as follows . in section [ sct :",
    "rtqc ] , we review the difficulties of the application of scf methods within the real - time quantum chemistry framework .",
    "then , in section [ sct : propagation ] , we discuss different possibilities for their acceleration and introduce two schemes to provide initial density matrices for the scf optimization procedure . in section [ sct : results ] , we then study their application on a set of model reactions .",
    "the real - time quantum chemistry framework@xcite is an immersive tool for the interactive exploration of chemical reactivity . as such",
    ", it contains a component for quantum chemical calculations combined with one or several components for the immersive interaction with the molecular system under consideration .",
    "an operator can create a series of molecular structures through interactive structure manipulation .",
    "there are two aspects of such an emergent structural evolution : ( i ) the structural relaxation by structure optimization and ( ii ) the structural perturbation introduced by the operator with input devices such as a computer mouse or a haptic device . in our current implementation,@xcite relaxation",
    "is handled by a steepest - descent algorithm where the nuclei are moved along their negative gradient .",
    "the quantum chemical calculations run continuously in the background for consecutive structures visited during a reactivity exploration .",
    "when applying scf methods , the execution time of a single - point calculation is unpredictable because of the iterative optimization of the electronic structure for a fixed molecular structure .",
    "this means that a self - consistent density matrix @xmath0 calculated from the molecular orbital coefficients is obtained .",
    "hence , it is necessary to decouple the quantum chemical calculations from the structure evolution in order to preserve the immersion in the reactivity exploration process.@xcite as a consequence , feedback ( for a given molecular structure ) in the form of structural evolution and haptic force rendering is based on the electronic structure of an earlier molecular structure .",
    "an illustration of the procedure is shown in fig .",
    "[ scf_haptic_scheme ] .    .",
    "on the left , each box indicates an scf calculation that iteratively optimizes the density matrix ( @xmath1 in the @xmath2-th iteration step for the @xmath3-th structure ) until it is converged ( @xmath4 ) .",
    "each scf calculation yields orbitals from which the electronic wave function @xmath5 and thus quantum chemical properties are calculated ( middle ) . on the right ,",
    "each @xmath6 symbol represents a molecular structure that is generated for visual representation .",
    "scf calculations are executed for the ones surrounded by a box .",
    "it can be seen that there is a delay between the start of the calculation on a structure and the delivery of the quantum chemical properties for this structure .",
    ", width=264 ]    in a recent work@xcite , we introduced a strategy to ensure reliable reactivity exploration when feedback is provided with an unpredictable time delay . in the present work ,",
    "we introduce schemes to allow for more frequent feedback by reducing the execution time of electronic structure optimizations . to achieve this , we here develop techniques that aim at improved guesses for the initial density matrix @xmath7 to accurately approximate the converged matrix @xmath8 so that the number of scf iteration steps is reduced .",
    "acceleration of scf convergence has been the objective of research efforts for many years .",
    "in addition to reducing the number of scf iterations required for convergence , convergence - acceleration schemes are essential to reach self - consistency at all .",
    "one option to accelerate scf convergence is to exploit , for a molecular structure under consideration , the information produced by successive iterations of the scf procedure to allow for better guesses for the subsequent iterations .",
    "this option is , for example , realized in the level - shifting method@xcite , in the direct inversion of the iterative subspace ( diis ) algorithm@xcite , in energy - diis ( ediis)@xcite , in augmented - diis ( adiis)@xcite , in the augmented roothaan  hall ( arh ) method@xcite and in linear - expansion shooting techniques ( list)@xcite .",
    "another approach is the orbital transformation method@xcite , which performs transformations of the molecular orbitals that avoid the diagonalization of the fock matrix .",
    "when scf calculations must be performed for several similar structures , another option for scf acceleration is to exploit the converged information of related molecular structures .",
    "this is particularly helpful when the electronic structure of several consecutive molecular structures needs to be calculated , as for example in _ ab initio _ molecular dynamics , geometry optimization and , in our case , interactive reactivity explorations . in such cases , two different approaches to scf acceleration",
    "are prevalent . on the one hand ,",
    "optimization - free calculations have been in the focus of research , particularly in the field of molecular dynamics .",
    "this approach is for example applied in car  parrinello molecular dynamics@xcite , in density matrix dynamics@xcite and in approaches related to extended - lagrangian born  oppenheimer molecular dynamics@xcite . on the other hand ,",
    "several strategies aim at a reduction of the number of scf iterations by providing guesses for the first scf iteration relying on the optimized electronic structures of previous molecular structures .",
    "for example , pulay and fogarasi extrapolate the fock matrix@xcite , while atsumi and nakai@xcite extraploate the molecular orbitals , and vandevondele et al .",
    "extrapolate the density matrix in combination with the orbital transformation method mentioned above.@xcite    in our real - time framework , the last converged density matrix was injected as a density matrix guess for the new structure and then optimized by the diis algorithm in the scf optimization procedure . for further acceleration ,",
    "many of the approaches mentioned above are not applicable in real - time quantum chemistry applications .",
    "in fact , most of them rely on successive structures produced in short time or distortion steps , which are not realized in real - time quantum chemistry as the step sizes are defined by the action of the operator . due to its special needs ,",
    "real - time quantum chemistry requires schemes tailored for this special type of configuration - space exploration . unlike in molecular dynamics ,",
    "time reversibility is not a concern in real - time quantum chemistry because excess energy can always be removed by structure optimization .",
    "most importantly , the operator can create structural changes that do not correspond to small coordinate distortions . in the following two sections , we propose two schemes that extrapolate converged density matrices to provide an improved guess for the initial density matrix of the scf procedure .",
    "the scheme we propose in this section is inspired by the least - squared prediction of the molecular orbitals ( lsmo ) technique developed by atsumi and nakai@xcite .",
    "the main idea behind their method is to construct the new guess molecular orbitals as a linear combination from the converged molecular orbitals of previous ( structure ) steps .",
    "the molecular orbital coefficients are obtained by least - squares extrapolation in a procedure analogous to diis with an error vector derived from differences in the coordinates of the molecular structures considered . to account for the crossing and mixing of the molecular orbitals ,",
    "atsumi and nakai multiply the molecular orbital coefficients matrices with auxiliary transform matrices in the linear combination .    in the present work ,",
    "we introduce a modification of lsmo where the density matrix is propagated instead of the molecular orbitals .",
    "the density matrix carries sufficient information for starting the scf procedure and avoids the need and computational cost of auxiliary transform matrices .",
    "the ( @xmath9 + 1)-th molecular structure with coordinates @xmath10 , for which a density matrix guess @xmath11 is to be produced , can be described as the sum of the linear combination of @xmath12 previous structures and a residual error @xmath13 : @xmath14 the coefficients @xmath15 are obtained by minimizing the residual error @xmath13 with a least - squares minimization , as in diis : @xmath16 here , @xmath17 denotes a lagrange multiplicator and @xmath18 is given by @xmath19 where @xmath20 denotes the number of atoms . the new guess density matrix is then calculated from the linear combination of the @xmath12 previously converged density matrices @xmath21 : @xmath22    partly restoring idempotency of the guess density matrix with the mcweeny purification algorithm@xcite turned out to be beneficial . in an orthonormal basis , the mcweeny purification algorithm reads @xmath23 and , in a non - orthonormal basis , @xmath24 where @xmath25 denotes the overlap matrix . in our propagation scheme , the mcweeny purification algorithm can be applied a variable number of times .",
    "this propagation scheme will be abbreviated as ls - r@xmath26 ( east - quares propagation with * * ) with @xmath27 denoting the number of mcweeny purifications applied and @xmath12 being the number of preceding structures and converged density matrices considered for the linear extrapolation .",
    "the second scheme we propose is very similar to the ls - r scheme presented above . instead of employing changes in the nuclear",
    "coordinates for determining the coefficients of the linear combination , this information is obtained from the overlap matrices .",
    "the matrix entries @xmath18 then reads @xmath28 this is the only modification to the ls - r propagation scheme .",
    "we abbreviate this second propagation scheme as ls - s@xmath26 ( east - quares propagation with * * ) with @xmath27 denoting the number of mcweeny purification steps as before . in analogy to ls - r , @xmath12 denotes the number of previous overlap matrices and converged density matrices considered for the linear extrapolation .",
    "we developed a testing environment in order to compare the propagation schemes in a reproducible manner .",
    "this c++ program simulates a real - time reactivity exploration by generating sequences of structures for model reactions and performing quantum chemical calculations for structures along these extrapolation coordinates .    for a given model reaction ,",
    "one first defines one or several atom pairs whose internuclear distance will be changed to construct some path in configuration space from reactant structures to products .",
    "then , the sequence of structures is constructed from the starting structure @xmath29 in a recursive manner .",
    "the structure @xmath10 is obtained from the structure @xmath30 as follows .",
    "first , the internuclear distances of the previously defined atom pairs are modified according to a specified step size .",
    "then , this structure is subjected to several steps of a ( constraint ) steepest descent structure optimization utilizing the gradient of the energy with respect to nuclear coordinates . during this constraint structure relaxation the selected - pair(s )",
    "internuclear distances remain fixed .",
    "this reaction trajectory is then used to analyze the performance of the propagation schemes .",
    "each propagation step is followed by a quantum chemical calculation of the molecular structure relying on the pm6 and dftb3 methods , which were recently implemented in our group as c++ libraries.@xcite although these methods are semi - empirical , similar results are expected for first - principles scf methods such as kohn  sham density functional theory , as they share the same formalism .",
    "for some reactions , dftb3 could not be employed because of the lack of adequate parameters .",
    "in addition to the ls - r and ls - s schemes , the scf convergence was accelerated by the diis algorithm.@xcite for a calculation to be considered converged , the frobenius norm of the difference between two contiguous density matrices @xmath31 and @xmath32 had to be below @xmath33 , with @xmath34 being the total number of atomic orbitals ( basis functions ) ; i.e.  the following condition must be fulfilled : @xmath35      to benchmark the propagation schemes in the testing environment , we chose six model reactions .",
    "they are shown in fig .",
    "[ reactions ] .",
    "the cartesian coordinates for all the sequences of structures can be found in the supporting information .",
    "the reactions * a * , * b * , * c * and * d * were treated in the spin - restricted formalism and the reactions * e * and * f * in the spin - unrestricted formalism .     in the benzoyl radical ( * f * ) .",
    "the atom pairs whose internuclear distance were scanned are marked in red . ]",
    "[ [ a - dielsalder - reaction ] ] a : diels  alder reaction + + + + + + + + + + + + + + + + + + + + + + +    as an example of a concerted pericyclic reaction we chose the diels  alder reaction of ethene and butadiene ( * a * in fig .",
    "[ reactions ] ) .",
    "the step sizes for the scans between the atom pairs c@xmath36c@xmath37 and c@xmath38c@xmath39 were 0.1  and 0.06  , respectively .",
    "cyclohexene was obtained as the product .",
    "[ [ b - nucleophilic - substitution - s_textn2 ] ] b : nucleophilic substitution s@xmath402 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the nucleophilic substitution reaction we chose a nucleophilic attack of a hydroxide anion onto 1-chlorbutane with subsequent ejection of an chloride anion ( * b * in fig .  [ reactions ] ) .",
    "we performed a linear scan on the atom pair c@xmath41o@xmath42 with a step size of 0.1  .",
    "[ [ c - insertion - of - carbon - monoxide - into - a - metal - alkyl - bond ] ] c : insertion of carbon monoxide into a metal - alkyl bond + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the migratory insertion reaction we chose the mn(co)@xmath43me complex .",
    "one of the carbon monoxide ligands is inserted into the manganese - methyl bond ( * c * in fig .",
    "[ reactions ] ) . a linear scan on the atom pair c@xmath36o@xmath44 with a step size of 0.1  was performed .",
    "[ [ d - carbon - carbon - bond - formation - through - reductive - elimination ] ] d : carbon - carbon bond formation through reductive elimination + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a model for a reductive elimination reaction is the nibu(c@xmath45h@xmath46)(pme@xmath47)@xmath48cn complex .",
    "the cyanide and the butyl ligand form 1-cyanobutane via reductive elimination ( * d * in fig .",
    "[ reactions ] ) .",
    "a linear scan was performed on the atom pair c@xmath36c@xmath49 with a step size of 0.1  .",
    "[ [ e - decomposition - of - aibn ] ] e : decomposition of aibn + + + + + + + + + + + + + + + + + + + + + + + +    as an example for a radical reaction , we chose the decomposition of azobisisobutyronitrile ( aibn ) ( * e * in fig .  [ reactions ] ) . starting with aibn , we obtain n@xmath50 and two 2-cyanoprop-2-yl radicals after decomposition . the step size for the scan of the atom pair c@xmath36c@xmath51 was 0.1  .",
    "[ [ f - elimination - of - carbon - dioxide - in - the - benzoyl - radical ] ] f : elimination of carbon dioxide in the benzoyl radical + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    another radical reaction is the elimination of co@xmath50 from the benzoyl radical to generate the phenyl radical .",
    "a linear scan was performed on the atom pair c@xmath44c@xmath51 with a step size of 0.1  .      to compare the different schemes , we define five measures .",
    "they can be evaluated for each single propagation step that delivers a guess density matrix for the molecular structure @xmath9 .",
    "accordingly , they carry a subscript @xmath9 that indicates the corresponding propagation step .",
    "[ [ execution - time ] ] execution time : + + + + + + + + + + + + + + +    the execution time @xmath52 for step @xmath9 is the sum of the time of the propagation of the density matrix , @xmath53 , and the time needed for the subsequent calculation to reach convergence , @xmath54 : @xmath55    [ [ number - of - iterations ] ] number of iterations : + + + + + + + + + + + + + + + + + + + + +    the number of iterations @xmath56 is the number of scf iterations required to reach convergence for the orbitals of molecular structure @xmath9 .    the energy and gradient obtained without scf optimization by evaluating the guess density matrix at the new molecular structure were also monitored because they are good indicators of how close the guess is to the converged density matrix .",
    "[ [ accuracy - of - predicted - energies ] ] accuracy of predicted energies : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to assess the energy accuracy of a propagation step , the indicator @xmath57 evaluates the difference of predicted and converged energies , @xmath58 and @xmath59 , respectively : @xmath60    [ [ accuracy - of - predicted - gradients ] ] accuracy of predicted gradients : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to measure the accuracy of the predicted gradients we introduce two separate measures quantifying the amplitude and the angular errors of the predicted gradient vectors .",
    "the error angle @xmath61 is calculated as the angle between the predicted and the converged gradient vectors for each of the @xmath20 atoms : @xmath62 the amplitude error @xmath63 is calculated as the vector norm deviation of the predicted gradient vector from the converged gradient vector for each of the @xmath20 atoms : @xmath64 this amplitude error is given as a percental deviation .",
    "the measures for the reaction as a whole are given as arithmetic means of the measures for each of the @xmath65 steps : @xmath66",
    "the ls - r and ls - s schemes each have two parameters that need to be optimized for ideal performance : the number of preceding structures to consider and the number of mcweeny purifications applied .",
    "the supporting information contains tables that compare the results obtained with the parameter combinations tested during the parameter optimization .",
    "the results of the ls - r propagation are presented in tables s1s5 of the supporting information .",
    "the highest scf accelerations are observed for ls - r@xmath67 and ls - r@xmath68 . for the studied model reactions , these two propagation schemes are capable of reducing the number of scf iterations by up to 50% and they achieve speedups of approximately 30% . the repeated application of the mcweeny purification results in increasingly better predicted energies and gradients .",
    "the results of the ls - s propagated model reactions are presented in tables s6s10 of the supporting information .",
    "the highest scf accelerations are observed for ls - s@xmath67 and ls - s@xmath68 .",
    "they also reduce the number of scf iterations by up to 50% and achieve speedups of approximately 30% . also , the repeated application of the mcweeny purification results in increasingly better predicted energies and gradients .      when comparing the four propagation schemes ls - r@xmath69 , ls - r@xmath70 , ls - s@xmath69 and ls - s@xmath70 with respect to the number of scf iterations ( table  [ comp - it ] ) and the computational times ( table  [ comp - t ] ) they all provide considerable improvements compared to simply taking the last converged density matrix in combination with the diis algorithm ( denoted by the symbol ``  '' in the tables ) . within our testing environment",
    "these four propagation schemes perform equally well .",
    ".number of iterations @xmath71 of eq .",
    "( [ dr : iterations ] ) for the propagation schemes with optimal parameters .",
    "the values are averages over the different molecular structures along the reaction coordinates . [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> the inherently high computational cost of iterative self - consistent - field ( scf ) methods proves to be a critical issue delaying visual and haptic feedback in real - time quantum chemistry . in this work , </S>",
    "<S> we introduce two schemes for scf acceleration . </S>",
    "<S> they provide a guess for the initial density matrix of the scf procedure generated by extrapolation techniques . </S>",
    "<S> scf optimizations then converge in fewer iterations , which decreases the execution time of the scf optimization procedure . </S>",
    "<S> to benchmark the proposed propagation schemes , we developed a test bed for performing quantum chemical calculations on sequences of molecular structures mimicking real - time quantum chemical explorations . </S>",
    "<S> explorations of a set of six model reactions employing the semi - empirical methods pm6 and dftb3 in this testing environment showed that the proposed propagation schemes achieved speedups of up to thirty percent as a consequence of a reduced number of scf iterations . </S>"
  ]
}