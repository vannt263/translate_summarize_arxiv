{
  "article_text": [
    "finite - temperature green s function calculations have a long history in condensed matter physics  @xcite .",
    "most commonly the finite temperature formalism is employed to study low - energy effective models , such as the hubbard  @xcite model , either by numerical or analytical means  @xcite .",
    "much less is known about employing finite temperature green s functions for realistic systems while maintaining `` chemical accuracy '' of 1 kcal / mol . in quantum chemistry , or in any realistic calculations beyond model systems ,",
    "the eigenvalue spread of realistic hamiltonians is very broad ; thus , the finite temperature green s function formalism , when applied to realistic problems , has to describe energy levels far outside the window described by model hamiltonians .",
    "this makes the realistic calculations much more challenging than the model ones . in practical calculations ,",
    "temperature - dependent green s functions are expressed as functions of imaginary time or imaginary frequency ( matsubara green s function ) that are mutually connected by a fourier transform .",
    "both imaginary time and matsubara green s functions are discretized on imaginary time and imaginary frequency grid , yielding @xmath0 and @xmath1 matrices , where @xmath2 , @xmath3 , and @xmath4 are the number of orbitals , imaginary time , and imaginary frequency grid points , respectively .",
    "the size of these grids depends on the energy spread of a system and the temperature - dependent grid spacing . since realistic hamiltonians have a wide spread of orbital energies , both grids need to contain hundreds of thousands of grid points to reach high numerical accuracy at low temperatures that result in small grid spacing .",
    "even though in a parallel calculation each grid point can be processed independently , computation requirements are still very high and both the time and memory necessary to handle green s function operations grow steeply .",
    "thus , for accurate and affordable realistic calculations , it is highly desirable to find compact representations of both imaginary time and matsubara green s functions .    recently , boehnke et al .",
    "@xcite employed orthogonal polynomial representation of green s functions to compactly express hubbard green s functions . using this approach for realistic systems",
    ", we have shown that very accurate results can be obtained exploiting only a fraction of the original imaginary time grid points necessary to illustrate the energy spread of the realistic hamiltonian .",
    "@xcite in practical calculations , since many green s functions manipulations are easier in frequency space it is important to have a compact representation of the matsubara green s function . in this paper",
    ", we focus on finding a representation that will result in using compact matsubara frequency grids for realistic problems .",
    "the regular imaginary frequency matsubara grid is equidistant and the grid spacing is directly related to the physical temperature .",
    "let us note , however , that while the grid spacing for low frequencies is essential to illustrate the physical temperature , for larger frequencies the green s function is a slowly and smoothly changing function of frequency .",
    "consequently , it should be possible to keep the original spacing for few frequency points near zero and have a prescription to systematically evaluate more points for higher frequencies with larger than the near - zero spacing without any loss of accuracy .",
    "since the matsubara green s function or self - energy is smoothly and slowly changing between grid points , numerical interpolation is especially suitable to accurately describe it .",
    "linear interpolation is the simplest choice but it lacks smoothness . while a polynomial of higher degree may be used to interpolate and ensures smoothness , this type of interpolation may result in large runge oscillations between the data points .",
    "consequently , we decided to employ spline interpolation using cubic polynomials over a polynomial interpolation since it will result in a procedure with much smaller interpolation errors , greater stability and low computational cost .    in chemical physics , cubic spline interpolation has been applied as a basis to solve a complex differential and integral schrdinger  @xcite , dirac  @xcite , and sham ",
    "schlter equations  @xcite , thomas  fermi model  @xcite , in calculations of vibrational and rotational spectra  @xcite and many other cases  @xcite .",
    "since the derivatives of third and higher order polynomials are discontinuous , cubic spline interpolation is limited to applications that are not sensitive to the smoothness of derivatives higher than second order .",
    "applications of cubic spline interpolation algorithm in green s function theory are known in the context of dynamical mean - field theory ( dmft )  @xcite . finally , cubic spline interpolation algorithm is popular because it is very easy to implement and use .",
    "several libraries provide built - in functions for cubic spline interpolation .",
    "for example , fortran provides both procedural and object - oriented interfaces for the fitpack library  @xcite .",
    "this paper is organized as follows . in section",
    "[ theory ] , we shortly review the background necessary to understand finite temperature green s functions and our motivation behind applying them to realistic calculations . additionally , we focus on illustrating the difficulties of extending the green s function approach to large basis sets used in chemistry . in section  [ comp_details ] , we describe the spline interpolation procedure that we use for realistic systems and its implementation in the second - order green s function theory .",
    "we list and discuss the numerical results of our algorithm as applied to realistic atomic and molecular calculations in section  [ results ] . finally , we present conclusions in section  [ conclusions ] .",
    "in this section , we briefly review some aspects of fermionic green s function theory relevant to this work . for a more detailed introduction to green s function theory readers are suggested to consult textbooks on the subject , see e. g. ref  .",
    "first , let us note that green s functions can be expressed in the real or imaginary frequency domain . in general a real time or real frequency",
    "one - body green s function is a function used to describe spectral properties such as ionization potentials , electron affinities , or the single - particle spectral function .",
    "methods such as the random phase approximation ( rpa ) and gw usually express the green s function using real frequencies to obtain spectra at zero temperature  @xcite .",
    "while , in general , the real frequency green s function is an exponentially decaying function of frequency , it is very difficult to employ it in iterative methods such as dmft or other embedding methods such as self - energy embedding theory ( seet )  @xcite since iterating usually requires pole shifting algorithms  @xcite .    the imaginary frequency matsubara green s function @xmath5 is used to describe single - particle properties of a statistical ensemble where many excited states ( besides the ground state ) are potentially accessible at a given finite temperature . while not commonly employed in molecular quantum chemistry calculations , such green s functions are desirable for materials science calculations where a small electronic band gap allows multiple electronic states to be populated even at low temperatures .",
    "the matsubara green s function is expressed on the imaginary grid @xmath6  @xcite , where @xmath7 , @xmath8 is the inverse temperature , and @xmath9 is the boltzmann constant .",
    "note that the @xmath10 spacing of the grid is set by the physical temperature @xmath11 .",
    "using such a grid , the matsubara green s function is then defined as @xmath12^{-1},\\ ] ] where @xmath13 and @xmath14 are the overlap and fock matrices correspondingly , and @xmath15 is the chemical potential chosen such that a proper number of electrons is present in the system .",
    "the self - energy @xmath16 is a correction to the non - interacting green s function @xmath17^{-1}$ ] describing static and dynamical many - body correlation effects at the single - particle level .",
    "both real and imaginary parts of the green s function on a matsubara grid are smooth and converge to zero in the limit of large frequencies . in this high - frequency limit , @xmath18",
    ", the matsubara green s function can be expressed as a series @xmath19 with the expansion coefficients given by @xmath20_{ij } = ( -1)^{(k-1 ) } \\langle \\psi | \\ { \\left [ \\hat{h},\\hat{c}_i   \\right]_{k},\\hat{c}_j^\\dagger \\ } | \\psi \\rangle ,     \\label{hfe2}\\ ] ] where @xmath21 is the full many - body hamiltonian of the system @xmath22 where @xmath23 ( @xmath24 ) is the electron annihilation ( creation ) operator from orbital @xmath25 , @xmath26 is the core - hamiltonian matrix and @xmath27 are two - electron integrals defined as @xmath28 @xmath29 is the heisenberg ground state of the system .",
    "it was shown in ref   that the coefficients of high - frequency expansion in a non - orthogonal orbital basis for hamiltonians with full coulomb interaction are given by @xmath30        in a typical calculation , see fig .",
    "[ fig : gf_flow ] , the self - energy @xmath31 is evaluated either on the matsubara frequency or imaginary time grid by a variety of solvers ranging from quantum monte carlo methods  @xcite to perturbative  @xcite and configuration interaction type of methods  @xcite . in the next step , a green s function is calculated by means of the dyson equation @xmath32    using the correlated green s function and self - energy , one evaluates quantities of interest such as the one - particle density matrix @xmath33 and using it the correlated one - body energy @xmath34 , \\label{eq : e1b}\\ ] ]    different prescriptions can be used to compute the two - body correlation energy @xmath35 . the galitskii  migdal formula  @xcite is used to evaluate the internal energy @xmath36,\\ ] ] where @xmath37 is the total number of imaginary frequencies .",
    "similarly , the luttinger  ward  @xcite functional @xmath38 consisting of irreducible energy diagrams of the self - energy can be used to calculate the grand - canonical potential @xmath39 = { \\mbox{tr}}\\left [ \\ln \\left ( \\mathbf{\\sigma } - \\mathbf{g}_0^{-1 } \\right ) +   \\mathbf{\\sigma } \\mathbf{g } \\right ] - \\phi[\\mathbf{g}],\\ ] ] which at low temperatures reduces to @xmath40 , where @xmath41 is the internal energy and @xmath42 is the total number of electrons in the system .",
    "for higher temperatures , @xmath43 can be used to find the free energy and thermodynamic properties of the system under study . for self - consistent calculations at low temperature",
    "the stationary value of @xmath44 corresponds to the energy obtained from galitskii ",
    "migdal formula up to a shift of @xmath45 .    in practical calculations ,",
    "a finite number of imaginary frequencies @xmath37 is used to span the matsubara green s function .",
    "insufficient size of the matsubara frequency grid leads to errors in the one- and two - body energy as well as the one - particle density matrix .",
    "a practical way to decide how many frequencies have to be used to represent the matsubara green s function before applying the high - frequency expansion can be based on measuring the distance between the inverse of the overlap matrix @xmath46 and the numerically evaluated coefficient of high - frequency expansion of green s function @xmath47 . in the limit of infinite number of matsubara frequencies @xmath48 .",
    "a finite number of matsubara frequencies always results in an error . to illustrate the magnitude of this error , we plot in the left panel of fig .",
    "[ fig : s_norm ] the frobenius norm @xmath49 of @xmath50 as a function of the number of matsubara frequencies @xmath37 for seven realistic atomic and molecular systems . after an initial plateau , where no improvement is seen ,",
    "the frobenius norm starts to decay linearly in the logarithmic plot . consequently , to reduce the error in the frobenius norm by an order of magnitude , an order of magnitude more matsubara frequencies is necessary .",
    "the right panel of fig .",
    "[ fig : s_norm ] shows the convergence of @xmath51 as a function of a basis set for the kr atom .",
    "generally , employing larger basis sets or adding diffuse functions requires an increase of the number of matsubara frequencies .",
    "this is due to the fact that the spread of hamiltonian eigenvalues increases as larger basis sets are used .",
    "thus , the fastest decay of @xmath51 is observed in cc - pvdz  @xcite basis with 27 basis function and the slowest in the aug - cc - pvqz  @xcite with 97 functions . note that even when a basis with a pseudopotential that has only basis functions describing the valence orbitals is employed , to be in the linear regime requires more than 10,000 frequencies .        during a calculation , the matsubara green s function may need to be stored in memory .",
    "storing a single green s function requires @xmath52 complex double precision numbers , where @xmath2 is the number of orbitals in a basis set .",
    "thus , for the large orbital bases and large number of frequencies necessary to reach quantum chemical quantitative accuracy , the required memory becomes a significant bottleneck .",
    "even if the memory bottleneck is avoided and the green s function is evaluated one the fly , when necessary , the computational complexity of all operations involving the green s functions grows rapidly with the number of matsubara frequencies .",
    "examples of such operations include solving the dyson equation  [ eq : dyson ] , which requires @xmath53 evaluations .",
    "even if all these operations can be made parallel over the frequency index , having to take into account this large number of matsubara frequencies can significantly slow down a computation .    to see why the frequency grid requirements are so demanding when chemical accuracy is desired , it is instructive to look at matsubara green s functions evaluated in large basis sets . in the left panel of fig .",
    "[ fig : gf ] , we plotted several of the largest elements of the imaginary part of the matsubara green s function for the h@xmath54co molecule calculated using the second - order green s function theory ( gf2 )  @xcite with tz(dunning ) basis set . in the right panel of fig .",
    "[ fig : gf ] , we plotted several largest matrix elements of the real part of the matsubara green s function for the h@xmath54co molecule .",
    "first , let us note that different elements of @xmath55_{ij}$ ] decay differently .",
    "secondly , as expected ,        the most rapid change in both real and imaginary parts of the green s function occurs in the low - frequency range .",
    "lastly , the slow convergence of the green s function to its high - frequency limit is responsible for the large matsubara grid when low temperatures are used .",
    "similar observations can be made about the convergence of sums involving matsubara frequencies  @xcite .",
    "motivated by these observations , in the next section we will compute the matsubara green s function for only a few low - frequency points to preserve the temperature dependence and have various interpolation techniques to approximate values of the green s function for higher frequencies .",
    "we adopted the commonly used cubic spline interpolation technique and modified it appropriately for the efficient use in green s function calculations .",
    "for the description of a standard cubic spline interpolation , readers are referred to textbooks on numerical methods , e.g. ref  .",
    "we consider a subset of matsubara frequencies @xmath56 \\}$ ] chosen from original equidistant matsubara grid and green s function @xmath57 evaluated on this subset .",
    "we focus on a particular frequency interval @xmath58 , \\omega_l,\\omega_{l+1 } \\in \\mathcal{s}$ ] .",
    "we define a local polynomial between interval endpoints as a modified legendre interpolation formula @xmath59 where @xmath60 $ ] , @xmath61 is the second derivative of green s function at the point @xmath62 , and @xmath63 are interpolation coefficients determined as    @xmath64    polynomials @xmath65 from all intervals @xmath66 \\subset [ i\\pi/\\beta , i\\omega_n]$ ] can be combined and used as an approximation to the green s function @xmath67 .",
    "equation  [ eq : gtilde ] generates continuous second derivatives both within the interval and at its boundaries , thus making a smooth transition between intervals , but approximating the third derivatives by a constant .",
    "note , that a simple linear interpolation is not a good choice here because the second derivative is undefined at the boundaries of the intervals and is zero inside .",
    "a construction of a local polynomial ( eq  [ eq : gtilde ] ) requires the knowledge of second derivatives for every given point @xmath62 .",
    "analytical second derivatives are not available for a correlated matsubara green s function and numerical derivatives must be used .",
    "the second derivatives can be approximated , for example , using central difference formula @xmath68 where @xmath69 is a small increment .",
    "an application of the central difference formula for every interval results in the following @xmath70 equations for second derivatives    @xmath71    since there are only @xmath70 equations for @xmath72 unknowns to find a unique solution two more equations have to be provided . in this work we chose to simply set second derivatives at global boundaries to zero @xmath73 and @xmath74 . in the numerical analysis literature ,",
    "it is known as a natural spline  @xcite .",
    "now , the resulting @xmath72 equations can be written as a matrix equation and finding second derivatives amounts to solving a system of linear equations .",
    "since the coefficient matrix is tridiagonal there is a unique solution that can be obtained in @xmath75 operations using a sparse linear solver .",
    "once the second derivatives are known and coefficients @xmath76 are calculated , the green s function can be reconstructed using eq  [ eq : gtilde ] at any requested frequency point .",
    "our algorithm consists of the following basic steps :    1 .",
    "we begin by choosing a small number of grid points explicitly and forming a small preliminary grid that usually does not exceed a few hundred points .",
    "most of these points are located near zero frequency and preserve the natural matsubara spacing to encode information about the inverse temperature @xmath77 .",
    "it is not particularly important how the points are chosen further away from zero frequency because later , iteratively , more points are added when necessary .",
    "however , to keep the number of operations small it is recommended to take advantage of the shape of green s function and create a denser grid in the low - frequency region and a sparser grid everywhere else .",
    "2 .   at these preliminary grid points",
    "we evaluate the green s function @xmath78 .",
    "[ main ] for every pair of labels @xmath79 of the green s function @xmath80 $ ] , we solve a system of equations  [ eq : sys1 ] for second derivatives in every interval between adjacent grid points and use it to infer the magnitude of change of the green s function .",
    "since we use cubic polynomials the forth derivative @xmath81 must vanish .",
    "we calculate and compare the absolute value of @xmath81 to the predetermined desired threshold value @xmath82 .",
    "if @xmath83 then the green s function does not change on the @xmath84 $ ] interval appreciably and no more frequency points should be added , otherwise a midpoint @xmath85 is inserted .",
    "we evaluate and store the green s function at the midpoint frequency @xmath86 .",
    "we repeat step  [ main ] until @xmath81 indicate that the green s function does not change anymore on every interval for all the @xmath79 labels .",
    "depending on the value of @xmath82 a different number of imaginary frequency points are selected and hence the accuracy of the spline can be systematically improved by decreasing @xmath82 .    since the matsubara green s function is a complex quantity the cubic spline interpolation algorithm can be applied to either real or imaginary part of it .",
    "the real part of the green s function contributes to the density matrix and the one - body energy .",
    "the imaginary part of the green s function influences the two - body energy .",
    "we observed that an insufficient grid causes the largest error in the density matrix and consequently the one - body energy .",
    "for this reason , we decided to apply the cubic spline interpolation algorithm to the real part of green s function to minimize @xmath82 and we use the resulting grid to evaluate both the real and imaginary part of the green s function .",
    "the algorithm for creating a green s function spline introduced above is suitable for calculating green s functions or self - energies in a systematic manner and improving its accuracy as a function of the spline accuracy @xmath82 and the grid size . in this paper",
    ", we tested this algorithm on a series of green s functions coming from gf2 calculations .",
    "gf2 is a perturbative many - body green s function method that has many attractive properties .",
    "it is as accurate as mller - plesset perturbation theory ( mp2 )  @xcite for weakly correlated systems but , unlike many methods suitable for weakly correlated systems such as mp2 or ccsd  @xcite , it is reasonably well behaved for strongly correlated systems  @xcite .",
    "gf2 has both small fractional charge and fractional spin errors  @xcite , affordable computational scaling @xmath87 and can be carried out self - consistently , making it reference independent .",
    "the self - consistency guarantees that the luttinger ",
    "ward functional constructed from the converged gf2 green s function and gf2 self - energy and the total energy is stationary with respect to the green s function .",
    "therefore , at convergence different ways of calculating correlation energy agree within numerical precision .",
    "this is a significant advantage because it means that one is free to choose the simplest way of evaluating the correlation energy e. g. using galitskii ",
    "migdal formula rather than luttinger ",
    "ward functional .    in gf2",
    ", the imaginary time self - energy @xmath88 is calculated using an imaginary time green s function @xmath89 according to @xmath90 gf2 calculations proceed as shown in fig .",
    "[ fig : gf_flow ] and operate in both imaginary time and matsubara domains .",
    "this choice simplifies the numerical evaluation of the self - energy and the solution of the dyson equation , for details see ref  .",
    "a broad variety of complex numerical algorithms and procedures , involved in the gf2 calculation , require handling matsubara grids such as the calculation of the matsubara green s functions , fast fourier transform from the matsubara frequencies to imaginary time and back , solution of the dyson equation and the evaluation of sums over matsubara frequencies in the galitskii ",
    "migdal energy calculation .",
    "this makes gf2 an ideal candidate for testing our algorithm .",
    "the details of the gf2 algorithm can be found in ref  .",
    "to accelerate calculations of the imaginary time self - energy a legendre polynomial basis was used as described in ref  .",
    "the reference data involving full frequency grid was obtained by performing self - consistent gf2 calculations for several atoms and simple molecules with matsubara frequency grids large enough to achieve convergence in total energy to 10 @xmath15e@xmath91 and in the total number of electrons to @xmath92 . from the converged gf2 green s functions and self - energies we calculated the reference one - body density matrix using eq  [ eq : gamma ] , the total number of electrons , the one - body energy using eq  [ eq : e1b ] , and the galitskii  migdal and luttinger  ward energies using eq  [ gm_enrg]-[lw_enrg ] respectively .",
    "in this section , we benchmark realistic atomic and molecular gf2 calculations using the cubic spline interpolation algorithm described above .",
    "our test set is comprised of 3 closed - shell atoms : be , mg , ar , 21 closed - shell molecules : h@xmath54o , ( h@xmath54o)@xmath54 , ( h@xmath54o)@xmath93 , ( h@xmath54o)@xmath94 , hcn , ch@xmath94 , c@xmath54h@xmath94 , co , co@xmath54 , h@xmath54co , nh@xmath93 , bn , h@xmath54o@xmath54 , c@xmath95h@xmath95 , lih , nah , mgh@xmath54 , alh , naoh , mgo , naf , and 4 transition metal atoms and diatomic clusters : cd , pd , cu@xmath54 , ag@xmath54 .",
    "the aug - cc - pvdz  @xcite basis set was used for atoms , the tz(dunning ) basis set was used for molecules except for lih , nah , mgh@xmath54 , alh , naoh , mgo and naf where the aug - cc - pvdz basis set was used . for transition - metal containing compounds , a basis set with pseudopotentials ecp - sdd - dz  @xcite was employed .",
    "we studied systems with pseudopotentials because they are frequently used in solid - state calculations thus giving us an insight into behavior of the realistic green s function in such systems .",
    "moreover , without using pseudoptentials the grid requirements for such electron rich systems are enormous .",
    "all systems studied in this work have a small dependence on temperature due to a large homo - lumo gap and thus variations of inverse temperature @xmath77 do not change results qualitatively .",
    "lowering the temperature ( increasing @xmath77 ) corresponds to decreasing the matsubara spacing , so that correspondingly more frequencies are required to reach the same accuracy for frequency sums and energies .",
    "consequently , to challenge our algorithm we have chosen a relatively large value of inverse temperature @xmath96 [ 1/a .",
    "u. ] . to test the accuracy of our algorithm",
    ", we applied it to converged gf2 green s functions using several values of the threshold @xmath97 . for every value of the threshold",
    ", we used the cubic spline interpolation algorithm to obtain a new small grid  a set of not necessarily equidistant imaginary frequency points satisfying conditions discussed in the previous section .",
    "a spline evaluated using such a small grid was used to calculate the one - body density matrix ( eq  [ eq : gamma ] ) , total number of electrons , one - body energy ( eq  [ eq : e1b ] ) , and galitskii  migdal ( eq  [ gm_enrg ] ) and luttinger  ward ( eq  [ lw_enrg ] ) energies .    first , we consider the size of new smaller grids used to create a spline and their dependence on the value of the threshold @xmath82 .",
    "the interpolation algorithm applied to a smooth function such as matsubara green s function produces sets of points with increasing cardinality as the value of threshold decreases .",
    "this guarantees a monotonic convergence to the original grid ( usually containing thousands of points ) in the limit of @xmath98 , thus making our algorithm controlled and systematically convergent when applied to green s functions .",
    "the numerical manifestation of the statement above is shown in table  [ tab:1 ] , where we summarized results for several atoms and molecules with different basis sets . before a green s function calculation",
    "is started the number of points in the full matsubara grid has to be predetermined .",
    "this number can be determined by converging the hf energy to a predetermined accuracy by using the hf green s function .",
    "the convergence in total hf energy to 10 @xmath15e@xmath91 was used to obtain the maximum number of the grid points listed in the viii column of table  [ tab:1 ] .",
    "alternatively , one can define an accuracy threshold @xmath99 , where @xmath100 , is the maximum matrix element of a difference between the numerical @xmath101 and the analytical @xmath102 high - frequency coefficient and determine how many points are necessary to converge the calculation to match a certain @xmath103 .",
    "[ cols=\"<,^ , > , > , > , > , > , > , > , > , > \" , ]     ^_a_^ experimental geometries were taken from nist computational chemistry comparison and benchmark database .",
    "@xcite + ^_b_^ @xmath104(ag - ag)=5.46 a. u. + ^_c_^ geometry was taken from ref  .",
    "+    it is clear from table  [ tab:1 ] that for most systems to recover either the highly accurate hf energy or @xmath105 to at least @xmath106 accuracy frequently more than 10,000 matsubara frequencies are required .",
    "additionally , we observe that for most systems , besides few atomic examples , the size of the grid requiring an @xmath103 between @xmath107 is enough to converge the hf energy to a high accuracy .",
    "thus , while we can predetermine how large the grid should be , such size of the grids can not be easily explicitly tractable since for small molecules such as those shown in the table  [ tab:1 ] , if larger basis set are employed , the grid can approach a size of 100,000 or more matsubara frequencies .",
    "this is a numerical explanation why finite temperature green s function calculations for realistic systems have not yet become routine . in this light",
    ", our cubic spline interpolation approximation is an important step towards reliable finite temperature green s function calculations .",
    "as table  [ tab:1 ] shows , when using the spline interpolation procedure , the reduction in the size of imaginary frequency grids is approximately two orders of magnitude if @xmath108 is used and by about one order for lower values of delta . for the most demanding system studied in this work ,",
    "we only require fewer than 3,000 frequency points to produce a new green s function using spline which is guaranteed to be in a very good agreement with the reference one since the threshold value is very small @xmath109 .",
    "overall , when @xmath108 is used , the number of frequency points necessary to create a spline grid is around 5% of the original matsubara grid size which is a remarkable reduction .    to put our efforts in reduction of the matsubara frequency grid to several thousands points in perspective ,",
    "it is worth mentioning that grids containing the same order of magnitude of points are used in quantum chemistry , e.g. in the evaluation of the contribution of the exchange - correlation function in dft and other numerical algorithms  @xcite .",
    "next , in fig .  [",
    "fig : cvg ] , we examine the convergence of all quantities considered such as the one - particle density matrix , one - body energy , etc . as a function of threshold @xmath82 .",
    "to illustrate the trend , we selected a few systems from the test set .    in the first panel of fig .",
    "[ fig : cvg ] , we plotted the logarithm of the error in the one - particle density matrix defined as @xmath110_{ij}$ ] as the function of the threshold @xmath82 .",
    "for all systems studied in this work , we observed almost perfect linear convergence .",
    "thus , an order of magnitude improvement in the accuracy of the one - particle density matrix can be achieved by decreasing the threshold by a factor of ten . for small systems such as atoms",
    ", the value of threshold roughly corresponds to the accuracy of the one - particle density matrix . for bigger systems using the smallest threshold yields inaccurate one - body density matrices .",
    "thus at least @xmath111 should be used if quantities that rely on an accurate determination of a one - particle density matrix are of interest .",
    "the one - body energy is calculated using the one - body density matrix .",
    "consequently , we note based on the upper center panel of fig .  [",
    "fig : cvg ] , that the rate of convergence of the one - body energy is that of the one - particle density matrix . the overall accuracy of the one - body energy is worse than that of the one - particle density matrix but insignificantly .",
    "nonetheless for all systems considered here the convergence of about 10 @xmath112 is achieved for @xmath109 .",
    "the total number of electrons is another quantity calculated from the one - particle density matrix .",
    "the @xmath82-dependence of the total number of electrons is shown in the upper right panel of fig .",
    "[ fig : cvg ] . overall convergence of the total number of electrons is fast and the accuracy is generally better than one of the one - particle density matrix . for the majority of systems considered in this work ,",
    "it is enough to set @xmath108 to recover the total number of electrons to @xmath92 accuracy .        the convergence of the galitskii  migdal two - body energy is shown in the bottom left panel of fig .  [ fig : cvg ] .",
    "we observe that the galitskii ",
    "migdal energy is converging the most rapidly and for all the systems studied @xmath111 is enough to achieve a @xmath15e@xmath91 accuracy .",
    "thus , the cubic spline interpolation algorithm is an extremely efficient way to calculate the two - body energy and to replace a simple sum over matsubara frequencies which is known to be numerically challenging .",
    "small fluctuations in the galitskii ",
    "migdal energy observed for @xmath113 and @xmath109 are purely numerical artifacts and only happen after a very good convergence to 0.1 @xmath112 is achieved .",
    "next , we examine the convergence of the luttinger  ward ( @xmath114 ) energy shown in the bottom center panel of fig .",
    "[ fig : cvg ] . the luttinger ",
    "ward energy converges at a slower rate than galitskii ",
    "migdal energy but still an acceptable accuracy of 10 @xmath15e@xmath91 can be achieved with @xmath113 or @xmath109 threshold depending on the system under consideration .",
    "the oscillations in the luttinger ",
    "ward energy , which are numerical artifacts , may also happen but only after initial convergence to less than 10 @xmath112 is achieved .    finally ,",
    "last panel of fig .",
    "[ fig : cvg ] shows the sizes of imaginary frequency grids that correspond to particular value of the threshold @xmath82 .",
    "as expected , simpler atomic systems even with basis sets containing polarization functions generally do not require large grids and changing the threshold @xmath82 does not result in a significant change of the size of the imaginary frequency grid , indicating that a convergence is achieved with relatively low value of @xmath82 .",
    "for bigger systems with lower spatial symmetry , the convergence of the grid size is slower and larger values of the threshold @xmath82 may be necessary .",
    "as the results above indicate , decreasing the threshold @xmath82 indeed results in generating more extensive grids with the increase of 1.5@xmath1152.0 for every order of magnitude decrease of @xmath82 ( see table  [ tab:1 ] ) .",
    "this has an important consequence for the computational complexity of realistic calculations . in order to achieve an order of magnitude improvement in convergence of the green s function using standard equidistant matsubara frequency grid the next successive grid must be at least an order of magnitude larger than previous one ( fig .",
    "[ fig : s_norm ] ) .",
    "it follows from fig .",
    "[ fig : cvg ] that if a cubic spline interpolation algorithm is used , an order of magnitude improvement in the calculated quantity can be achieved if the value of threshold @xmath82 is changed by a factor of ten which results in changing the number of frequencies necessary only by a factor of 1.5@xmath1152 .",
    "this means that upon going to bigger systems one should not expect the spline grid to grow as fast as the standard matsubara frequency grid . finally , since basis set significantly affects the grid requirements , in fig .",
    "[ fig : bar_all ] , we plot the results for all the 28 systems considered here according to the basis set .",
    "we plot 1/log(error ) versus @xmath115log(@xmath82 ) using bars since we attempt to show errors which differ by orders of magnitude on one plot .",
    "these plots should be read as follows .",
    "each bar represents the mean average error in the calculated quantity and longer bars correspond to larger errors .",
    "[ fig : bar_all ] shows the errors in one - particle density matrix , total number of electrons as well as one- and two - body energies for three different basis sets employed in our calculations : tz(dunning ) , aug - cc - pvdz and ecp - sdd - dz . as seen from fig .",
    "[ fig : bar_all ] , changing threshold from loose ( @xmath116 ) to tight ( @xmath117 ) leads to monotonic improvement in the accuracy for all the quantities considered .",
    "for all the basis sets employed , the biggest error is in the one - particle density matrix and consequently the one - body energy .",
    "smaller errors are observed in the luttinger ",
    "ward energy and the total number of electrons .",
    "the error in the two - body energy using the galitskii ",
    "migdal formula is the smallest and it is almost grid size independent .",
    "thus , one can expect that only a small number of grid points can be used to construct a spline that is used to evaluate a product of two frequency dependent quantities ( like two - body energy from eq  [ gm_enrg ] ) , while a larger grid is required when the quantity calculated is directly dependent on the accuracy of the one - body green s function ( like the one - body density matrix which is related to the green s function by a fourier transform ) . by comparing the magnitude of all errors ,",
    "we conclude that they are the largest for the tz(dunning ) basis set .",
    "this is not surprising since we used tz(dunning ) basis set for bigger molecules as opposed to aug - cc - pvdz basis set used for atoms and smaller molecules .",
    "this trend is in agreement with regular matsubara frequency grid requirements shown in table  [ tab:1 ] .",
    "if equidistant numerical grids are used , finite temperature green s function calculations of molecular systems or solids in large basis sets seem hardly possible due to highly inefficient grid spacing .",
    "however , since the matsubara green s function is a smoothly and slowly varying function of frequency even simple cubic spline interpolation algorithm can help reduce the number of grid points at which the green s function is evaluated explicitly , thereby making realistic calculations tractable .",
    "we carefully investigated this idea on a series of atomic and molecular calculations with realistic hamiltonians .",
    "we demonstrated that only around 5% of the original equidistant matsubara frequency grid was necessary to obtain very accurate results for the density matrix or total energy .",
    "our interpolation algorithm introduces a single threshold parameter  the magnitude of the fourth derivative , that systematically controls the spline accuracy . to keep the value of this threshold constant and below a user desired level , our algorithm detects the regions where the matsubara green s function changes rapidly and ensures that more grid points are used in these regions while fewer points are necessary in the regions with a slowly changing green s function .",
    "we established that irrespective of the basis set or the actual system under study , the magnitude of the spline fourth derivative is directly proportional to the accuracy of the results .",
    "thus , in a black box manner , by changing the value of this parameter we can achieve a desirable high accuracy while maintaining a low computational cost .",
    "one of the most important features of our algorithm shown here is that the growth of the spline grid necessary to evaluate the one - body density matrix or energies to a desired accuracy is much slower than that of standard equidistant matsubara frequency grid .",
    "while the matsubara frequency grid grows by an order to magnitude to get an order of magnitude improvement in the accuracy , the spline grid only grows by a factor or 1.5@xmath1152 .",
    "consequently , to achieve a very high @xmath15e@xmath91 convergence of energy with respect to the grid size , the number of points at which the green s function is evaluated explicitly is within only couples of thousands while traditional matsubara frequency grid requires hundreds of thousands of explicit evaluations .",
    "this study , when combined with our recently proposed algorithm for efficient reduction of the size of the imaginary time grid in ref  , is a step towards reliable and computationally affordable green s function calculations in quantum chemistry and materials science .",
    "[ conclusions ]",
    "a. a. k. , t. n. l , and d. z. acknowledge support from the u.s .",
    "department of energy ( doe ) ( no .",
    "er16391 ) .",
    "a. r. w. acknowledges support from mcubed program at university of michigan .",
    "e. g. acknowledges support from the sloan and simons foundation .",
    "83ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( ,  ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) _ _ ,  @noop ph.d .",
    "thesis ,   ( ) @noop * * ,   ( ) @noop _ _ ,  monographs on numerical analysis  ( ,  ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop `` , ''  ,   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> the popular , stable , robust and computationally inexpensive cubic spline interpolation algorithm is adopted and used for finite temperature green s function calculations of realistic systems . we demonstrate that with appropriate modifications the temperature dependence can be preserved while the green s function grid size can be reduced by about two orders of magnitude by replacing the standard matsubara frequency grid with a sparser grid and a set of interpolation coefficients . </S>",
    "<S> we benchmarked the accuracy of our algorithm as a function of a single parameter sensitive to the shape of the green s function . through numerous examples </S>",
    "<S> , we confirmed that our algorithm can be utilized in a systematically improvable , controlled , and black - box manner and highly accurate one- and two - body energies and one - particle density matrices can be obtained using only around 5% of the original grid points . </S>",
    "<S> additionally , we established that to improve accuracy by an order of magnitude , the number of grid points needs to be doubled , whereas for the matsubara frequency grid an order of magnitude more grid points must be used . </S>",
    "<S> this suggests that realistic calculations with large basis sets that were previously out of reach because they required enormous grid sizes may now become feasible . </S>"
  ]
}