{
  "article_text": [
    "photonic crystals ( pcs ) have recently become the object of increased interest as possible hosts for optical functional devices , e.g. , beam splitters , demultiplexers , etc .",
    "@xcite these elements , as well as the basic building blocks of photonic integrated circuits  waveguide bends ,",
    "junctions etc.have often been investigated by methods designed for finite systems , such as the finite - difference time - domain ( fdtd ) method  @xcite and the multiple - scattering ( ms ) method  @xcite .",
    "consequently , the devices in question were considered to be embedded in a finite fragment of a pc .",
    "this , however , involved spurious reflections at the artificial pc boundaries , significantly complicating the analysis of the device behavior .",
    "to remedy this situation , several methods suitable for analyzing systems with semi - infinite waveguides have been developed . in the effective discrete equations method  @xcite and the wannier function method",
    "@xcite , the electric and magnetic fields are represented in a basis of states localized at elementary defects ; various grating - based techniques , like those presented in @xcite , have been developed as well . both approaches , however , impose some restrictions on the problems to which they can be applied : the former is ill - suited to open systems ( i.e. , those with vacuum regions extending to infinity ) , while the latter only applies to systems with unidirectional waveguides .",
    "recently , the multiple multipole method has been extended by moreno _",
    "et al . _",
    "@xcite to systems with semi - infinite waveguides ; here , the fields on a transverse section of each waveguide , sufficiently distant from discontinuities ( junction , bend etc . ) , are matched to a linear combination of the waveguide eigenstates . as demonstrated in  @xcite ,",
    "this technique is very general and applicable also to the problems which can not be dealt by the other above - mentioned methods .",
    "the aim of this paper is to show how to take into account the presence of semi - infinite waveguides in calculations performed on the basis of the ms technique . owing to its particular simplicity and efficiency in dealing with the case of pcs composed of cylindrical rods ,",
    "this technique has gained significant popularity @xcite . although the approach proposed by moreno _ et al . _",
    "@xcite could be straightforwardly carried over to the combination of the ms method and the method of fictitious sources , formulated in  @xcite , this would require significant changes in the computational procedure , as well as availability of externally calculated data describing the fields corresponding to the waveguide eigenstates .",
    "in contrast , the approach outlined below consists solely in postprocessing of the results obtained by the ` pure ' ms method . while admittedly less general than the other technique , it is nevertheless applicable to a number of situations frequently encountered in practice .",
    "two of them are discussed in sections [ sec : onewaveguide ] and  [ sec : twowaveguides ] , in which the proposed procedure is applied to devices linked with one waveguide and two waveguides , respectively .",
    "possible extensions of the method are discussed in section  [ sec : extensions ] .",
    "the first system to be considered is a single waveguide terminated at the surface of a semi - infinite pc [ fig .  [",
    "fig : system1](a ) ] . a frequently discussed problem ( see ,",
    "e.g. , @xcite ) is the design of the precise shape of the waveguide outlet that would allow maximization of the power transmitted into free space . in this case , the main objective is to calculate the reflection coefficient of the outlet ; the intensity of the field produced at some point of the free - space region ( possibly at infinity ) when an eigenmode of unitary power propagates towards the end of the waveguide is sometimes searched for , too . in the following",
    "we will show how both quantities can be found on the basis of calculations done for the finite system shown in fig .",
    "[ fig : system1](b ) , presenting a waveguide that is @xmath0  unit cells long .",
    "unit cells of the waveguide .",
    "smigaj-1.eps[fig:system1 ] ]    the waveguide is assumed to be a single - mode one , and its unit cell to have a mirror - symmetry plane parallel to the @xmath1 plane , so that the propagating bloch states of the waveguide are characterized by wave numbers @xmath2 and @xmath3 .",
    "an arbitrary source  @xmath4 placed near the waveguide inlet excites the right - propagating mode , which then undergoes multiple reflections .",
    "let @xmath5 and @xmath6 ( @xmath7 ) denote the @xmath8 component of the electric ( tm polarization ) or magnetic ( te polarization ) field corresponding to the mode of wave number @xmath2 and @xmath3 , respectively , at point  @xmath9 represented by coordinates @xmath10 in fig .",
    "[ fig : system1](b ) .",
    "the choice of @xmath11 is arbitrary ; the zero value can be assumed unless the waveguide eigenmode is antisymmetric with respect to the @xmath12 plane . from the bloch theorem",
    ", we have    [ eq : abloch ] @xmath13    where @xmath14 is the waveguide transfer matrix ; @xmath15  is the waveguide period and @xmath16 .",
    "the outgoing modes get partly reflected at the waveguide ends ; this can be expressed by the following ` boundary conditions ' :    [ eq : abndconds ] @xmath17    where @xmath18 and @xmath19 are the reflection coefficients at the waveguide outlet and inlet , respectively , and @xmath20 stands for the effective field corresponding to the right - propagating mode excited by the source  @xmath4 , extrapolated to point @xmath21 . by combining eqs. and eliminating the variables @xmath22 , @xmath23 , @xmath24 , and @xmath25",
    ", we get the linear system @xmath26 whose solution reads @xmath27 in cells lying sufficiently far from the waveguide ends for the contribution of the evanescent states to be negligible , the total field  @xmath28 can be expressed only in terms of the propagating modes : @xmath29 we are interested in the reflection coefficient  @xmath18 , as well as in the intensity @xmath30 of the field which would be generated at some point  @xmath31 in the free space if the waveguide were semi - infinite and the incident right - propagating mode carried unitary power .",
    "the reflection coefficient can be found simply by least - squares fitting of the numerically calculated values of @xmath32 to those calculated by the formula resulting from eq .",
    ": @xmath33 in addition to  @xmath18 , this gives also the value of  @xmath34 , which can be used for calculating the wave number  @xmath2 .",
    "let us note by the way that solving eq .   for @xmath35 and @xmath36 , where @xmath37  is some fixed integer , yields    [ eq : astartingpt ] @xmath38    these values , calculated for @xmath39 , i.e. , near the waveguide center , can be used as starting points in the nonlinear least - squares fitting procedure .",
    "the sign of  @xmath2 should correspond to the physics of the problem at hand .",
    "it should be stressed that only cells distant enough from the waveguide ends ( i.e. , those labeled @xmath40 , where the ` margin '  @xmath41 is a sufficiently large integer ) should be taken into account in the above fitting procedure , since eq .   has been derived with the assumption that evanescent states are of negligible amplitude in the cells labeled @xmath9 and @xmath42 .",
    "let us proceed to the determination of @xmath30 .",
    "the intensity @xmath43 of the field generated at point  @xmath31 in the finite system can be written as @xmath44 where the transmission coefficient @xmath45 represents the fraction of the total energy emitted into free space when a waveguide mode reaches the outlet , and the ` transfer coefficient ' @xmath46 , dependent on the position of  @xmath31 and the geometry of the waveguide outlet , but not on the waveguide length , is a measure of the amount of this energy getting to point  @xmath31 . in the ideal case of the semi - infinite waveguide",
    ", @xmath19 would be zero ; thus , @xmath47 with @xmath48 chosen so that the incident mode would carry power @xmath49 .",
    "from eqs. we get @xmath50 since the incident power in each case is proportional to @xmath51 .",
    "as shown in the appendix , the total power flowing through an arbitrary transverse section of the waveguide is equal to @xmath52 this power can be easily calculated by the ms method . by using eq .   for eliminating from eq .",
    "the factor @xmath53 , which contains the unknown coefficient  @xmath19 , we finally get @xmath54    to sum up , the data obtained in a single ms calculation performed for a finite system with an @xmath0-cell - long waveguide suffice for determination of the reflection coefficient of the waveguide outlet , as well as the ` corrected ' field intensity in free space .",
    "when only the former quantity is required , the field excited at @xmath55 sites lying along the waveguide axis is all that needs to be calculated in the simulation ; otherwise , the power flow through an arbitrary transverse section of the finite waveguide must be computed too .      as an example of application of these results ,",
    "let us first consider the system shown in fig .",
    "[ fig : system1](a ) : a w1-type waveguide embedded in a hexagonal lattice of dielectric cylinders with permittivity @xmath56 and radius @xmath57 , where @xmath15  is the lattice constant .",
    "the surface termination creates a slight tapering of the waveguide exit .",
    "figure  [ fig : system1reflcoeff ] presents the frequency dependence of    .",
    "circles : the calculation results of lin and li  @xcite ; line : results of our calculations .",
    "smigaj-2.eps[fig:system1reflcoeff ] ]    the reflection coefficient @xmath58 in this configuration ; the results obtained by the proposed technique are compared to the data reported in  @xcite [ fig .",
    "7(c ) ] , acquired by the plane - wave - based transfer - matrix method .",
    "our calculations were done for waveguide length @xmath59 with margin @xmath60 .",
    "the convergence is very fast : in fact , the data obtained in the @xmath61 , @xmath62 case ( essentially the shortest waveguide for which fitting makes sense ) differ by at most 6% from those plotted in the graph , and for frequency values below @xmath63 the difference does not exceed 1% .",
    "there is a good agreement between our results and those of lin and li  @xcite , except for a small peak at frequency value @xmath64 , present in the @xmath65 plot obtained by these authors , but not reproduced by the curve resulting from our calculations .",
    "since the waveguide is a single - mode one and the mode dispersion curve is smooth around this frequency value , the physical origin of this sharp peak is not clear to us and we believe it might be a numerical artifact .    as a second example ,",
    "let us consider the leaky - wave photonic antenna @xcite shown in fig .",
    "[ fig : antenna](a ) . here , the     and @xmath66 , respectively , @xmath15  being the lattice constant",
    "; all cylinders have permittivity @xmath56 .",
    "every second surface cylinder is shifted by @xmath67 towards the bulk .",
    "the corrugated surface is @xmath68 unit cells long .",
    "( b ) the far - field intensity of the radiation emitted perpendicularly to the surface , calculated for waveguide length @xmath69 , and @xmath70 , as well as for the semi - infinite waveguide on the basis of data obtained for @xmath71 , @xmath72 .",
    "normalization : see text .",
    "smigaj-3.eps[fig:antenna ] ]    surface surrounding the waveguide outlet is corrugated with period @xmath73 and supports leaky surface modes , which are excited by the radiation coming from the waveguide . at a certain frequency value waves scattered at individual perturbed surface cylinders",
    "interfere constructively along the surface normal to produce a collimated beam .",
    "figure  [ fig : antenna](b ) presents the frequency dependence of the far - field intensity of the radiation emitted perpendicularly to the surface ; the outcomes of ` nave ' calculations done for finite - length waveguides are juxtaposed with those obtained by the proposed scheme for the semi - infinite waveguide .",
    "all curves are normalized to their absolute maxima .",
    "evidently , in the finite - waveguide case , the shape of the main peak depends on the precise length of the waveguide ; this dependence is especially pronounced to the right of the maximum , where the intensity values obtained for waveguides 11 and  12 cells long differ by as much as a factor of two . on the other hand ,",
    "the sidelobes in the frequency range @xmath74 are not significantly affected by changes in the waveguide length ; this leads to the conclusion that they result from interference occurring at the crystal surface rather than in the waveguide .",
    "in this section , we will focus on the more complex system with two linked semi - infinite waveguides ; the link can be realized , for instance , by a junction , a bend or a resonant cavity where scattering can occur .",
    "our goal is to calculate the reflection and transmission coefficients of this discontinuity .",
    "the waveguides are again assumed to be single - mode ones and to possess a transverse symmetry plane ; to these assumptions let us add that of their identical geometry .",
    "figure  [ fig : system2 ] depicts the finite system used in numerical calculations , where the left and right waveguide comprise @xmath0 and  @xmath75 unit cells , respectively , and the field is excited by the source  @xmath4 .    ]",
    "let @xmath5 and @xmath6 denote the field ( electric or magnetic , depending on the polarization ) , at point @xmath76 inside the left waveguide in fig .",
    "[ fig : system2 ] , corresponding to the incoming and outgoing guided modes , respectively .",
    "their right - waveguide counterparts at point @xmath77 will be labeled @xmath78 and @xmath79 .",
    "the junction linking the waveguides can be described by its scattering matrix @xmath80 defined by @xmath81 @xmath82 , @xmath83 and @xmath84 , @xmath85 denote the respective reflection and transmission coefficients of the junction .",
    "the ` boundary conditions ' are in this case    [ eq : bbndconds ] @xmath86    where @xmath18 is the reflection coefficient at the waveguide outer ends ( the waveguides having the same geometry , their terminations can be assumed to be identical too ) , and @xmath20 is defined as in section  [ sec : onewaveguide ] .",
    "the bloch theorem gives @xmath87 with the waveguide transfer matrix @xmath88 defined , as before , by eq .  .",
    "by eliminating the variables @xmath22 , @xmath23 , @xmath89 and @xmath90 from eqs .   and  , and the variables @xmath24 , @xmath25 , @xmath91 , and @xmath92 from eqs .   and",
    ", we obtain the linear system    @xmath93    the solution of which yields the expressions for the total fields in the left and the right waveguides :    [ eq : bfsolution ] @xmath94 \\phi^{2n - n } }        { ( 1 - r \\bar\\rho \\phi^{2 m } ) - r          [ \\rho + r(\\tau\\bar\\tau - \\rho\\bar\\rho ) \\phi^{2 m } ] \\phi^{2n } }        u{_{\\text{inc } } } , \\\\",
    "\\bar f_m & \\equiv \\bar u_m + \\bar d_m         = \\frac{\\tau(r\\phi^m + \\phi^{-m})\\phi^{n+m } }         { ( 1 - r \\bar\\rho \\phi^{2 m } ) - r          [ \\rho + r(\\tau\\bar\\tau - \\rho\\bar\\rho ) \\phi^{2 m } ] \\phi^{2n } }        u{_{\\text{inc}}}.      \\end{aligned}\\ ] ]    the above procedure can be repeated for the situation when source @xmath4  is replaced with source  @xmath95 located near the entry of the _ right _ waveguide ; in this case , the fields @xmath96 and  @xmath97 in the left and the right waveguides are given by    [ eq : bgsolution ] @xmath98 \\phi^{2 m } }      \\bar u{_{\\text{inc}}}. \\\\",
    "\\bar g_m & =      \\frac{(1 - r \\rho \\phi^{2n } ) \\phi^m + [ \\bar\\rho + r(\\tau\\bar\\tau -        \\rho\\bar\\rho ) \\phi^{2n } ] \\phi^{2m - m } }      { ( 1 - r \\rho \\phi^{2n } ) - r        [ \\bar\\rho + r(\\tau\\bar\\tau - \\rho\\bar\\rho ) \\phi^{2n } ] \\phi^{2 m } }      \\bar u{_{\\text{inc } } } ,    \\end{aligned}\\ ] ]    @xmath99 being defined analogously to @xmath20 .",
    "it is important to note that the ms method allows very efficient calculation of the fields excited in a single structure by several independent sources ( e.g. , @xmath4 and  @xmath95 ) , since the scattering matrix of the whole system , whose diagonalization is by far the most time - consuming step of the computational algorithm , is independent of the incident field  @xcite . in the following",
    "we show how the values of @xmath28 , @xmath100 , @xmath96 , and @xmath97 , calculated by the ms method , can be used for determination of the junction parameters @xmath82 , @xmath83 , @xmath84 , and @xmath85 . as before , in all these computations only cells sufficiently distant from the waveguide ends should be taken into account .    1",
    ".   we have @xmath101 therefore , as in the one - waveguide case , the parameters @xmath34 and  @xmath18 can be obtained by least - squares fitting of the above formula s right - hand side to simulation results .",
    "good starting points for the fitting procedure are in this case + [ eq : bstartingpt ] @xmath102 + with @xmath103 .",
    "2 .   to shorten the notation",
    ", we introduce the following symbols : @xmath104 consequently , the formulas for @xmath28 , @xmath100 , @xmath96 , and @xmath105 become : + [ eq : bfshort ] @xmath106 + thus , _ linear _ least - squares fitting of the numerically calculated values of @xmath28 to the function @xmath107 allows to find the coefficients + [ eq : bstep2params ] @xmath108 3 .   with definitions   of @xmath109 and  @xmath110 included , the formulas for @xmath111 , @xmath112 , @xmath113 , @xmath114 , @xmath115 , and @xmath116 form a system of six equations with six unknowns : @xmath117 , @xmath118 , @xmath119 , @xmath120 , @xmath20 , and @xmath99 .",
    "its solution reads + [ eq : bstep3solution ] @xmath121 4 .   the reflection and transmission coefficients @xmath82 , @xmath83 , @xmath84 , and @xmath85 can now be calculated from eqs .",
    " , since the values of all the other parameters are already known .      to test the accuracy of our method",
    ", we are going to apply it to the waveguide bend depicted in fig .  [",
    "fig : system2 ] .",
    "a number of numerical studies of this system , using different methods , are available in the literature @xcite , providing a reference for new techniques . the superimposed plot in fig .",
    "[ fig : bend ] shows the frequency dependence of the reflection     calculated by different methods ( see text ) .",
    "the data plotted with circles , crosses , and squares have been taken from @xcite , @xcite and  @xcite , respectively .",
    "smigaj-5.eps[fig:bend ] ]    coefficient @xmath122 ( since the bend is symmetric , @xmath123 ) calculated according to the above - presented scheme against the spectra obtained by the effective discrete equations method  @xcite , the wannier function method  @xcite , and the multiple multipole method  @xcite .",
    "clearly , the overall shape of all four curves is very similar , although the exact values of @xmath122 differ , especially near the boundaries of the bulk crystal gap .",
    "the spectrum resulting from our calculations is almost identical to that calculated by moreno _",
    "et al_.  @xcite this may be partly due to the similarity of the ms and multiple multipole methods ( in both of them the field is expanded in a basis of bessel and hankel functions ) ; however , it must also be noted that these methods are intrinsically ` exact ' in the sense that the maxwell equations are solved rigorously , which makes the calculations accuracy only depend on the maximum order of the basis functions kept , and the results are known to be rapidly convergent with the truncation order  @xcite .",
    "in contrast , the derivation of the effective discrete equations  @xcite involves a number of approximations ( for instance , only the monopole eigenmodes of the elementary defects are taken into account ) .",
    "this may be the reason why the reflection coefficient calculated by mingaleev _",
    "_  takes values @xmath124 larger than those obtained in our approach .",
    "the two device classes discussed above , i.e. , those linked with one or two semi - infinite waveguides , represent a large fraction of commonly investigated photonic building blocks . though the two - waveguide case has been analyzed with the assumption of identical geometry of both waveguides , this condition can be eliminated , with the transmission coefficients renormalized to refer to eigenmodes carrying unitary power , in a way similar to that presented for a single waveguide at the end of section  [ subsec : onewaveguidetheory ] .",
    "our formalism can be extended to systems with more than two waveguides as well .",
    "however , many such systems , including most _ t _ and  _ y _ junctions discussed in the literature , are symmetric with respect to the axis of one or more constituent waveguides . therefore , they can also be analyzed with the simpler two - waveguide formalism presented in this paper . to see this , note that the scattering matrix  @xmath80 of a three - waveguide junction is defined by [ cf.eq .  ]",
    "@xmath125 where @xmath126 and @xmath127 refer to the incoming and outgoing mode , respectively , in the @xmath128th waveguide ( @xmath129 ) . for simplicity reasons ,",
    "all the waveguides are assumed to be of the same length  @xmath0 .",
    "if waveguides 2 and  3 are identical and the axis of waveguide  1 is a symmetry plane of the system , we have @xmath130 , @xmath131 , @xmath132 , and @xmath133 . to these equalities we can add @xmath134 and @xmath135 , provided that the sources are placed symmetrically with respect to that axis . as a result , eq .",
    "simplifies to @xmath136 therefore , the junction can be treated as a two - waveguide system with effective reflection and transmission coefficients given by the above formula .",
    "the values of these parameters can be calculated by the method presented in section  [ sec : twowaveguides ] . evidently , the coefficients @xmath137 and @xmath138 occur only in the form of their sum , and therefore can not be obtained independently . however , normally , the quantities of interest are the coefficients @xmath139 and @xmath140 , which are related to transmission and reflection of the radiation incoming from the first ( ` input ' ) waveguide .",
    "equation   clearly shows that these parameters can be obtained straightforwardly from the two - waveguide formalism .",
    "we have presented a method , based on multiple - scattering numerical simulations performed for finite systems , allowing to find the reflection and transmission coefficients of photonic crystal functional elements linked with ideal semi - infinite waveguides .",
    "as our approach does not involve modification of the existing code implementing the multiple - scattering method , no serious programming and testing effort are necessary for its application .",
    "the proposed formalism allows for dealing with a wide variety of photonic crystal building blocks likely to be encountered in practice , as demonstrated by its successful application to a tapered waveguide outlet , a photonic crystal leaky - wave antenna , and a waveguide bend .",
    "this appendix presents the derivation of formula   for the power flowing through an arbitrary transverse section of the waveguide shown in fig .",
    "[ fig : system1](b ) . only tm polarization will be considered ; the procedure to be followed in the case of te polarization is completely analogous .",
    "the power  @xmath141 flowing to the right through a plane @xmath142 ( perpendicular to the waveguide axis ) per unit length in the @xmath8  direction is given by the integral of the @xmath143  component of the time - averaged poynting vector  @xmath144 : @xmath145 .",
    "\\end{split}\\ ] ] from eq .",
    "we have @xmath146 where @xmath147 denotes the electric field corresponding to the right - propagating waveguide eigenmode of amplitude satisfying the condition @xmath148 .",
    "similarly , for the magnetic field we obtain @xmath149 note the change of sign in the numerator , which results from the magnetic field being a pseudovector . by including these formulas into eq .  ,",
    "after some straightforward algebra , we arrive at @xmath150      \\operatorname{im}j \\bigr\\ } ,    \\end{split}\\ ] ] where @xmath151 from the conservation of energy , @xmath141 must be constant for all  @xmath9 , since the waveguide is not leaky .",
    "we conclude that the second term in braces in eq .",
    ", being @xmath9-dependent , must be identically zero ; this leads to the following condition for the fields corresponding to the waveguide eigenmode : @xmath152 in consequence , eq .   simplifies to @xmath153 where @xmath154 denotes the power carried by the incident mode .",
    "l.  c. botten , t.  p. white , a.  a. asatryan , t.  n. langtry , c.  m. de sterke , and r.  c. mcphedran , `` bloch mode scattering matrix methods for modeling extended photonic crystal structures .",
    "i. theory , '' phys .",
    "e * 70 * , 056606 ( 2004 ) .",
    "white , l.  c. botten , c.  m. de sterke , r.  c. mcphedran , a.  a. asatryan , and t.  n. langtry , `` bloch mode scattering matrix methods for modeling extended photonic crystal structures .",
    "applications , '' phys .",
    "e * 70 * , 056607 ( 2004 ) .",
    "p.  kramper , m.  agio , c.  m. soukoulis , a.  birner , f.  mller , r.  b. wehrspohn , u.  gsele , and v.  sandoghdar , `` highly directional emission from photonic crystal waveguides of subwavelength width , '' phys .",
    "lett . * 92 * , 113903 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> we propose a technique of compensating the spurious reflections implied by the multiple - scattering ( ms ) method , commonly used for analyzing finite photonic crystal ( pc ) systems , to obtain exact values of characteristic parameters , such as reflection and transmission coefficients , of pc functional elements . rather than a modification of the ms computational algorithm , </S>",
    "<S> our approach involves postprocessing of results obtained by the ms method . </S>",
    "<S> we derive analytical formulas for the fields excited in a finite system , taking explicitly into account the spurious reflections occurring at the artificial system boundaries . </S>",
    "<S> the intrinsic parameters of the investigated functional element are found by fitting the results of ms simulations to those obtained from the formulas derived . </S>",
    "<S> devices linked with one and two semi - infinite waveguides are analyzed explicitly ; possible extensions of the formalism to more complex circuits are discussed as well . </S>",
    "<S> the accuracy of the proposed method is tested in a number of systems ; the results of our calculations prove to be in good agreement with those obtained independently by other authors . </S>"
  ]
}