{
  "article_text": [
    "for the hybrid monte carlo algorithm ( hmc)@xcite , often used to study quantum chromodynamics ( qcd ) on the lattice , one is interested in efficient numerical time integration schemes which are optimal in terms of computational costs per trajectory for a given acceptance rate . high order",
    "numerical methods allow the use of larger step sizes , but demand a larger computational effort per step ; low order schemes do not require such large computational costs per step , but need more steps per trajectory .",
    "so there is a need to balance these opposing effects .",
    "omelyan integration schemes @xcite of a force - gradient type have proved to be an efficient choice , since it is easy to obtain higher order schemes that demand a small additional computational effort .",
    "these schemes use higher - order information from force - gradient terms to both increase the convergence of the method and decrease the size of the leading error coefficient . other ideas to achieve better efficiency for numerical time integrators are given by multirate or nested approaches .",
    "these schemes do not increase the order but reduce the computational costs per path by recognizing the different dynamical time - scales generated by different parts of the action .",
    "slow forces , which are usually expensive to evaluate , need only to be sampled at low frequency while fast forces which are usually cheap to evaluate need to be sampled at a high frequency . a natural way to inherit the advantages from both force - gradient type schemes and multirate approaches would be to combine these two ideas .    previously , we studied the behavior of the adapted nested force - gradient scheme for the example of the @xmath0-body problem @xcite and would like to learn more about their usefulness for lattice field theory calculations . due to the huge computational effort required for qcd simulations ,",
    "it is natural to attempt an intermediate step first .",
    "we chose the model problem of quantum electrodynamics ( qed ) in two dimensions , the schwinger model @xcite , since it is well - suited as a test case for new concepts and ideas which can be subsequently applied to more computationally demanding problems @xcite .",
    "as a lattice quantum field theory , it has many of the properties of more sophisticated models such as qcd , for example the numerical cost is still dominated by the fermion part of the action . the fact that this model , with far fewer degrees of freedom , does not require such large computational effort makes it the perfect choice for testing purposes .",
    "we compare the behavior of numerical time integration schemes currently used for hmc @xcite with the nested force - gradient integrator @xcite and the adapted version introduced in @xcite .",
    "we investigate the computational costs needed to perform numerical calculations , as well as the effort required to achieve a satisfactory acceptance rate during the hmc evolution .",
    "our goal is to find a numerical scheme for the hmc algorithm which would provide a sufficiently high acceptance rate while not drastically increasing the simulation time .",
    "the paper is organized as follows . in section 2",
    "we give a short overview of the hmc algorithm and numerical schemes for time integration , which are used in hmc . in section 3",
    "we present the 2-dimensional schwinger model and introduce the idea of the force - gradient approach and the resulting novel class of numerical schemes .",
    "section 4 is devoted to the results of a comparison between widely used algorithms and the new approach and section 5 draws our conclusion .",
    "in this section we provide a general overview of the hmc algorithm @xcite to introduce our novel integrator .",
    "we also present some standard numerical time integrating methods used in hmc , as well state - of - the - art numerical schemes , which we later compare by applying them to the two - dimensional schwinger model .      in the hybrid monte carlo algorithm ,",
    "the quantum lattice field theory is embedded in a higher - dimensional classical system through the introduction of a fictitious ( simulation ) time @xcite .",
    "the gauge field @xmath1 is associated with its ( fictitious ) conjugate momenta @xmath2 , and the classical system is described by the hamiltonian , @xmath3 + { \\mathcal{b}}[u],\\ ] ] where @xmath4 $ ] and @xmath5 $ ] represent the kinetic and potential energy respectively .    for a given configuration @xmath1 ,",
    "a new configuration @xmath6 is generated by performing an hmc update @xmath7 , which consists of two steps :    * * molecular dynamics trajectory : * evolve the gauge fields @xmath1 , elements of a lie group , and the momenta @xmath2 , elements of the corresponding lie algebra , in a fictitious computer time @xmath8 according to hamilton s equations of motions @xmath9 since analytical solutions are not available in general , numerical methods must be used to solve the system of eqn .  .",
    "the discrete updates of @xmath1 and @xmath2 with an integration step @xmath10 are @xmath11 leading to a first - order approximation at time @xmath12 .",
    "since the momenta @xmath2 are elements of lie algebra , we have an additive update of @xmath2 .",
    "on the other hand , the links @xmath1 must be elements of the lie group , therefore an exponential update is used for @xmath1 to preserve the underlying group structure . * * metropolis step : * accept or reject the new configuration @xmath13 with probability @xmath14 where @xmath15 .      in this paper",
    "we are concerned with numerical time integration schemes , which preserve the fundamental properties of geometric integration , time - reversibility and volume - preservation .",
    "all numerical schemes presented below possess these necessary properties .",
    "* basic schemes : * well - known , commonly used integration schemes in molecular dynamics are given by    * the leap - frog method , a 3-stage composition scheme of the discrete updates defined above : @xmath16 * and a 5-stage extension widely used in qcd computations : @xmath17    * force gradient schemes : * force - gradient schemes increase accuracy by using additional information from the force gradient term @xmath18 , with @xmath19 defining lie brackets . the 5-stage force - gradient scheme proposed by omelyan et",
    "al @xcite is the simplest ; @xmath20 here we also test the modification of the force - gradient method proposed in @xcite , where the force - gradient term @xmath21 is approximated via a taylor expansion .",
    "an extension is given by the 11-stage decomposition @xcite , recently implemented as the integrator in the open source code openqcd as one of the standard options @xcite",
    "@xmath22where @xmath23 , @xmath24 , @xmath25 and @xmath26 are parameters from equation ( 71 ) in ref .",
    "@xcite .    *",
    "nested schemes : * qed and qcd problems usually lead to hamiltonians with the following fine structure @xmath27 + { \\mathcal{b}}_{1}[u]+ { \\mathcal{b}}_{2}[u],\\ ] ] where the action of the system can be split into two parts : a fast action @xmath28 such as the gauge action , and a slow part @xmath29 , for example , the fermion action .",
    "this allows us to apply the idea of multirate schemes ( an idea known as nested integration in physics literature)@xcite in order to reduce the computational effort . at",
    "first we consider the nested version of the leap - frog method @xmath30 where the inner cheaper system @xmath31+{\\mathcal{b}}_{1}[u]$ ] is solved by @xmath32 with @xmath33 being a number of iterations for the fast part of the action .",
    "our main goal is to compare the above - mentioned methods with more elaborated nested schemes : in @xcite , a similar 5-stage decomposition scheme has been recently introduced : @xmath34    a nested version of , which has been used in  @xcite reads @xmath35 where @xmath36 with @xmath37 and @xmath38 . in the limit @xmath39",
    "we have @xmath40 .",
    "note that this approach uses force - gradient information at all levels , i.e. , the high computational cost of high order schemes appears at all levels .",
    "one may overcome this problem by using schemes of different order at the different levels without losing the effective high order of the overall multirate scheme .",
    "for the latter , we include appropriate force gradient information as we explain in the following for the case of two time levels , where the gauge action plays the role of the fast and cheap part , and the fermionic action plays the role of the slow and expensive part .",
    "the reasoning is as follows : if one uses the 5-stage sexton - weingarten integrator of second order for the slow action , and approximates the fast action by @xmath41 leap - frog steps of step size @xmath42 , the error of the overall multirate scheme will be of order @xmath43 . with the use of force gradient information only at the slowest level it is possible to cancel the leading error term of order @xmath44 .",
    "as @xmath45 usually holds in the multirate setting , the overall order is then given by the leading error term of order @xmath46 , i.e. , the scheme has an effective order of four .",
    "one example for such a scheme for problems of type is given by the 5-stage nested force - gradient scheme introduced in @xcite @xmath47 to summarize , the adapted scheme   differs from the original one   in two perspectives :    * the force gradient scheme for the fast action is replaced by a leap - frog scheme . *",
    "only the part @xmath48 of the full force gradient @xmath49 is needed to gain the effective order of four .",
    "the numerical schemes - and - are second order convergent schemes . methods - and - have the fourth order of convergence .",
    "we do not consider integrators of higher order than four since the computational costs are too high .",
    "the schemes of the same convergence order differ from each other by the number of stages ( updates of momenta and links per time step ) .",
    "usually methods with more stages have smaller leading error coefficients and therefore have better accuracy , but higher computational costs .",
    "we would like to determine which integrator would represent the best compromise between high accuracy and computational efficiency",
    ".    we will apply all these numerical integration schemes  to the two - dimensional schwinger model .",
    "the most challenging task from the theoretical point of view is to derive the force - gradient term @xmath21 . in the next section",
    "we introduce the schwinger model and explain how to obtain the force - gradient term .",
    "the 2 dimensional schwinger model is defined by the following hamiltonian function @xmath50 = \\frac{1}{2}\\sum_{n=1,\\mu=1}^{v,2 } p_{n,\\mu}^2 + s_g[u ] + s_f[u].}\\ ] ] with @xmath51 the volume of the lattice . unlike qcd , where @xmath52 and @xmath53 , for this qed problem , the links @xmath1 are the elements of the lie group @xmath54 and the momenta @xmath55 belong to @xmath56 , which represents the lie algebra of the group @xmath54 .",
    "this makes this test example very cheap in terms of the computational time .",
    "this together with the fact that the schwinger model also shares many of the features of qcd simulations , makes the schwinger model an excellent test example when considering numerical integrators : a fast dynamics given by the computationally cheap gauge part @xmath57 $ ] of the action demanding small step sizes , and a slow dynamics given by the computationally expensive fermion part @xmath58 $ ] allowing large step sizes .",
    "the pure gauge part of the action @xmath59 sums up over all plaquettes @xmath60 in the two - dimensional lattice with @xmath61 and is given by @xmath62 the links @xmath1 can be written in the form @xmath63 and connect the sites @xmath0 and @xmath64 on the lattice ; @xmath65 $ ] , @xmath66 , @xmath67 @xmath68 are respectively space and time directions and @xmath69 is a coupling constant .",
    "note that from now on we will set the lattice spacing @xmath70 .",
    "the fermion part of the action @xmath71 is given by @xmath72 where @xmath26 is a complex pseudofermion field . here , @xmath73 denotes the wilson  dirac operator given by @xmath74 where @xmath75 are the pauli matrices @xmath76 @xmath77 is the mass parameter and the kronecker delta @xmath78 acts on the pseudofermion field by @xmath79 with @xmath80 the pseudofermion field , a vector in the two - dimensional spinor space taking values at each lattice point @xmath0 . in order to proceed with the numerical integration we need to obtain the force @xmath81 and the force gradient term @xmath21 .",
    "the force term @xmath82 with respect to the link @xmath83 is given by the first derivative of the action @xmath84 and can be written as @xmath85 since the numerical schemes  use the multi - rate approach , the shifts in the momenta updates are split on @xmath86 and @xmath87 and we can consider them separately .",
    "the force terms @xmath86 and @xmath87 are obtained by differentiation over @xmath54 group elements , which for the schwinger model is the standard differentiation .    the force associated with link @xmath88 from the gauge action",
    "is given by @xmath89 the force term of the fermion part is given by @xmath90 \\,\\ ] ] where vectors @xmath91 and @xmath92 are given @xmath93    for the numerical methods and we need to find the force gradient term @xmath94 with respect to the link @xmath83 . in case of the schwinger model this term reads @xmath95    for simplicity we decompose the force gradient term in four parts @xmath96 this decomposition is also useful since the numerical integrator only uses the term @xmath97 by construction .",
    "as shown in @xcite , to obtain the fourth order convergent scheme from the second order convergent method we must eliminate the leading error term , which is exactly represented by @xmath97 . for completeness we discuss all 4 parts below .",
    "the @xmath98 part of the force - gradient term is @xmath99 \\end{aligned}\\ ] ] with the set of plaquettes @xmath100 then by using the vectors @xmath101 defined in we obtain the @xmath102 piece of the force - gradient term given by @xmath103 . }",
    "\\end{aligned}\\ ] ] the second derivative of the fermion action is @xmath104 \\xi + } \\nonumber \\\\ & & { 2 \\operatorname{re } \\chi^\\dagger \\frac{\\partial d}{\\partial q_\\mu(n ) } ( d^\\dagger d)^{-1 } \\frac{\\partial d^\\dagger}{\\partial q_\\nu(m ) } \\chi \\ , , } \\nonumber \\\\ & & { = 2 \\operatorname{re } \\left [ z_{1,m,\\nu}^\\dagger \\frac{\\partial d}{\\partial q_{\\mu}(n ) } \\xi +   \\chi^\\dagger",
    "\\frac{\\partial d}{\\partial q_{\\mu}(n ) } d^{-1 } w_{2,m,\\nu } -   \\chi^\\dagger   \\frac{\\partial^2 d}{\\partial q_{\\nu}(m ) \\partial q_{\\mu}(n ) } \\xi +   \\chi^\\dagger",
    "\\frac{\\partial d}{\\partial q_{\\mu}(n ) } d^{-1 } z_{1,m,\\nu}\\right ] } \\nonumber \\\\ & & { = 2 \\textrm{re } \\left [ z_{1,m,\\nu}^\\dagger w_{2,n,\\mu } +   w_{1,n,\\mu}^\\dagger z_{2,m,\\nu } -   \\chi^\\dagger   \\frac{\\partial^2 d}{\\partial q_{\\nu}(m ) \\partial q_{\\mu}(n ) } \\xi \\right ] } \\end{aligned}\\ ] ] in terms of the vectors @xmath105 and @xmath92 defined in .",
    "now the fields @xmath106 and @xmath107 are given by @xmath108 with @xmath109    in order to calculate @xmath110 and @xmath111 it is possible to perform the summation of @xmath112 before the inversions of @xmath73 and @xmath113 to get @xmath114 and @xmath115 which save @xmath116 additional inversions for the force gradient terms .",
    "it follows for the force gradient term @xmath111 @xmath117\\ ] ] with @xmath118 + z_1 \\right ) \\ , .",
    "\\end{aligned}\\ ] ] the expression for @xmath110 can be obtained from the one for @xmath111 by replacing in and the vector @xmath119 with @xmath120 defined in .",
    "it is important to mention that the computationally most demanding part of the numerical integration of the schwinger model and quantum field theory in general is the inverse of the dirac operator @xmath121 .",
    "every momenta update , which includes fermion action requires 2 inversions of the dirac operator , the addition of the force - gradient term @xmath21 requires 4 more inversions .",
    "therefore leap - frog based methods and need 4 computations of @xmath121 per time step ; schemes and 6 times ; force - gradient based methods 8 for and , 10 for and the 11 stage method has 12 inversions of the dirac operator . since we use the multi - rate approach for schemes , and , which leads generally to fewer macro time steps needed than for the standard schemes we expect the integrator will be the most efficient choice among the methods considered . in the next section we present numerical tests of this prediction .",
    "in this section we apply the numerical integrators  to compute the molecular dynamics step for the schwinger model when studied with the hmc algorithm .",
    "we consider a @xmath122 by @xmath122 lattice with a coupling constant @xmath123 and mass @xmath124 .",
    "the parameters were taken from @xcite and correspond to the scaling variable @xmath125 defined in @xcite.we have chosen them to simulate close to the scaling limit with light fermions and also to increase the impact of the fermion part of the action .",
    "we use one thermalised gauge configuration . for each integrator and value of the step - size",
    "we generate @xmath126 independent sets of momenta and integrate the equations of motion on a trajectory of length @xmath127 .",
    "we compute the absolute error @xmath128 and estimate its statistical error from the standard deviation .",
    "also the parameter @xmath33 is chosen in such a way to make micro step size to be @xmath129 times smaller than the macro step size @xmath10 .",
    "figure [ fig:1 ] presents the comparison between the numerical integrators  .",
    "it shows the absolute error @xmath128 versus the step - size of the numerical scheme . here",
    "the multi - rate schemes , , and outperform their standard versions as expected .",
    "also it is easy to see that the scheme has the best accuracy and the nested force - gradient method just slightly edges the adapted nested force - gradient scheme .",
    "figure [ fig:2 ] presents the cpu time , required for the proposed integrators ",
    ", versus the achieved accuracy .",
    "we can observe that the nested force - gradient method and adapted nested force- gradient method show much better results in terms of a computational efficiency than the integrators and ; and even compared to the 11 stage scheme .",
    "here we can see that the modification of proposed in @xcite also performs better than its original version .",
    "it shows almost similar computational costs as nested versions of the force - gradient approach - , since it has the same number of @xmath121  ( see table [ tab:1 ] ) .",
    "but it is less efficient because the proposed nested approach is more precise .",
    ".step - sizes and number of inversions of @xmath73 per step and per trajectory for acceptance rate of 90% [ cols=\"^,^,^,^,^\",options=\"header \" , ]     table [ tab:1 ] shows the number of inversions of the dirac operator @xmath73 , which is needed to reach 90% acceptance rate of the hmc . since @xmath121 is the most computationally demanding part it is important to see how many of these inversions are required per each trajectory . from table",
    "[ tab:1 ] it easy to see that the adapted nested force - gradient method and nested force - gradient method need the least number of @xmath121 per trajectory to reach the chosen acceptance rate @xmath130 .",
    "we can also claim that methods and have a potential to perform even better with respect to the computational effort in the case of lattice qcd problems , since the impact of the fermion action and the computational time to obtain the inversion of the dirac operator @xmath73 is much more significant .",
    "we presented the nested force - gradient approach and its adapted version applied to a model problem in quantum field theory , the two - dimensional schwinger model .",
    "the derivation of the force - gradient terms was given and the schwinger model was introduced .",
    "nested force - gradient schemes seem to be an optimal choice with relatively high convergence order and low computational effort .",
    "also it would be possible to improve the algorithm by measuring the poisson brackets of the shadow hamiltonian of the proposed integrator and then tuning the set of optimal parameters , e.  g. micro and macro step sizes .",
    "+ in future work we will apply this approach to the hmc algorithm for numerical integration in lattice qcd . here",
    "we expect the adapted nested - force gradient scheme to outperform the original one , if we further partition the action into more than two parts , by using techniques to factorize the fermion determinant : less force - gradient information is needed for the most expensive action , and only leap - frog steps are needed for the high frequency parts of the action .",
    "this work is part of project b5 within the sfb / transregio 55 _ hadronenphysik mit gitter - qcd _ funded by dfg ( deutsche forschungsgemeinschaft ) .",
    "s.  duane , a.d .",
    "kennedy , b.j .",
    "pendleton , d.  roweth , hybrid monte carlo , phys .",
    "b195 ( 1987 ) , pp .",
    "e.  hairer , c.  lubich , g.  wanner , geometric numerical integration : structure - preserving algorithms for ordinary differential equations , springer , berlin , 2002 .",
    "omelyan , i.m .",
    "mryglod , r.  folk , symplectic analytically integrable decomposition algorithms : classification , derivation , and application to molecular dynamics , quantum and celestial mechanics , comput .",
    "151 ( 2003 ) , pp ."
  ],
  "abstract_text": [
    "<S> we study a novel class of numerical integrators , the adapted nested force - gradient schemes , used within the molecular dynamics step of the hybrid monte carlo ( hmc ) algorithm . </S>",
    "<S> we test these methods in the schwinger model on the lattice , a well known benchmark problem . </S>",
    "<S> we derive the analytical basis of nested force - gradient type methods and demonstrate the advantage of the proposed approach , namely reduced computational costs compared with other numerical integration schemes in hmc . </S>"
  ]
}