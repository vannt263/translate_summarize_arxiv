{
  "article_text": [
    "under the influence of gravity , the initially - small fluctuations in the primordial density field grow to become the hierarchical and nonlinear structures observed today . we can study the late - time clustering of matter by evolving a density field described by an initial power spectrum and comparing the simulated structures to observed galaxies in a statistical way .",
    "however , if we were able to undo the smearing effects of nonlinear evolution and reverse the formation of structure , we would be able to reconstruct the primordial power spectrum from an observed distribution of galaxies .",
    "many reconstruction methods have been developed  @xcite , from simple linear reconstruction to more complex methods , with varying degrees of success ( see  @xcite for a comparative review ) .",
    "for example , monge - ampre - kantorovitch ( mak ) reconstruction @xcite was successfully able to reproduce the observed velocity field of the local group  @xcite .",
    "a reconstruction method that uses the linear zeldovich approximation of the lagrangian displacement has also been proposed to enhance the measurement of baryon acoustic oscillations  ( baos ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the displacement field is a crucial quantity in most of these methods , and is of interest in its own right .",
    "there is reason to believe that a logarithmic transformation of the density field may aid estimation of the displacement field .",
    "the mass distribution has been successfully described by a lognormal field that evolved from gaussian initial conditions @xcite , with some evidence for a skewed lognormal field in the nonlinear regime @xcite .",
    "more recently , it has been found that the power spectrum of the log - transformed density field contains more fisher information than the usual power spectrum at small scales by up to a factor of @xmath110 @xcite .",
    "a modified logarithmic transform has also been shown to increase the precision of the power spectrum of the nonlinear weak lensing convergence field @xcite .",
    "the log - transformed density field is also more effective in constraining cosmological parameters than the standard density field when using the power spectrum  @xcite .",
    "this paper investigates the effect of a logarithmic transform of the density field on the relation between the density and displacement fields .",
    "we do this by measuring the divergence of the displacement field , which in linear theory is proportional to the negative density contrast @xmath3 , using both eulerian and lagrangian techniques in a cosmological @xmath0-body simulation .",
    "we compare the linear and logarithmic approaches and evaluate their dependence on redshift and smoothing scale , both of which affect the applicability of linear theory .",
    "the linear and logarithmic approximations for the displacement field are derived in section  [ sec : reconstruction ] , and three methods of measuring the divergence of the displacement field and the density field are presented in section  [ sec : results ] .",
    "concluding remarks are given in section  [ sec : conclusion ] .",
    "in this section , we compare the linear approximation of the continuity equation to a logarithmic approximation .",
    "the large - scale dynamical evolution of structure is described by the zeldovich approximation @xcite , @xmath4 where @xmath5 is the comoving eulerian coordinate , @xmath6 the lagrangian coordinate , @xmath7 the displacement , @xmath8 the linear growth function , and @xmath9 the gravitational potential .",
    "the linear poisson equation relates the density contrast , @xmath10 , to the gravitational potential by @xmath11 , thus the divergence of the linear zeldovich displacement can be related to the density contrast : @xmath12 the time derivative of the zeldovich approximation in expanding coordinates ( @xmath13 , where @xmath14 is the physical coordinate ) allows us to relate this expression to the continuity equation .",
    "we first note that the derivative consists of two components , @xmath15 , where the first component describes the rate of expansion and the second the peculiar velocity of galaxies ( or mass particles ) : @xmath16 . the continuity equation can be written as  ( see , e.g. , * ? ? ?",
    "* p 48 ) @xmath17 = 0.\\ ] ] to first in @xmath3 order this becomes @xmath18 thus we have @xmath19 and have recovered equation  [ eqn : divdel ] .    the continuity equation ( eqn .",
    "[ eqn : continuity ] ) may also be simplified by keeping the @xmath20 together , resulting in a logarithmic derivative of @xmath20 : @xmath21 this gives a logarithmic expression for the divergence of the lagrangian displacement , @xmath22 where the @xmath23 term appears because @xmath24 is not a zero - mean - field , so we must take into account a non - zero integration constant .",
    "we find that this constant is well - approximated by the rather natural value of @xmath25 .",
    "we now may compare the linear relation , given by eqn .",
    "[ eqn : divdel ] , to the logarithmic relation , given by eqn .",
    "[ eqn : divlnd ] .",
    "we measure the density field and @xmath26 in a 200  h@xmath2mpc , @xmath27 particle gadget  @xcite cold dark matter simulation with standard @xmath28cdm cosmology ( @xmath29 ) .",
    "we use three different methods : a grid - based cloud - in - cell ( cic ) smoothing plus a fourier - space estimation of the divergence ( section  [ sec : cic ] ) ; an adaptive smoothing using a smoothed particle hydrodynamics ( sph ) kernel , combined with a fourier - space divergence calculation ( section  [ sec : sph ] ) ; and a geometrical delaunay tessellation estimation of both the density and the divergence ( section  [ sec : dtfe ] ) .",
    "we find that each of these methods achieves differing degrees of success based on the nature of the length - scales involved : the cic method is an eulerian , mass - weighted scheme ; the delaunay tessellation is a lagrangian , volume - weighted scheme ; and the adaptive mesh method is a hybrid , featuring a lagrangian kernel with interpolation onto an eulerian grid .",
    "we discuss each in turn below .",
    "the cic method smooths an arbitrary distribution of particles onto a regularly - spaced grid by placing a `` cloud '' having the volume of a grid cell around each particle , so that a particle contributes to the average of multiple nearby cells based on the fraction of its volume contained in these cells . using this weighting scheme",
    ", we calculate the density and displacement fields in real space for both @xmath30 and @xmath31 cells , where the displacement @xmath7 is the final ( @xmath32 ) minus initial ( @xmath33 ) particle positions . in the case of @xmath31 cells at @xmath32 , there is only one cell containing zero particles ; we set its value to the average value in the surrounding cells . to avoid cells with zero particles ,",
    "this is the finest grid we use , given the resolution of the simulation .",
    "the divergence of the displacement can then easily be calculated in fourier space , where the derivatives become simple multiples of @xmath34 .",
    "we note here that bao reconstruction methods also calculate the linear zeldovich displacement in fourier space , which they multiply by a smoothing function @xmath35 : @xmath36 ; for example , a gaussian smoothing function would take the form @xmath37 .",
    "we do not apply an extra smoothing function in fourier space , but note that the size of the grid cells gives the effective smoothing length of the both the density and displacement fields . in our simulations ,",
    "a @xmath30 cell grid has a length of 3.1  h@xmath2mpc and a @xmath31 cell grid has length 1.6  h@xmath2mpc , while the reconstruction methods have @xmath38 = 5 , 10 , and 20  h@xmath2mpc , with @xmath38=10  h@xmath2mpc performing the best @xcite .    in figure",
    "[ fig : divcic4z ] we show a two - dimensional histogram of @xmath26 versus @xmath3 and @xmath24 at four different redshifts , for a cell size of 1.6 h@xmath2mpc and with a slope of -1 plotted for reference .",
    "the color scale is logarithmic so that the outlying cells can be seen , though the furthest outliers ( especially at low-@xmath39 ) extend beyond the range of the plot . at @xmath40 , the nonlinear clustering of matter",
    "has only begun for the initially highest - density peaks , so both the linear and logarithmic relations have slopes near -1 and are very tight . at @xmath41",
    "there is more scatter , and the linear relation begins to deviate very slightly from a slope of -1 for the majority of cells ( shown in black in the plot ) and to develop a high @xmath3 tail .",
    "this trend continues at @xmath42 , with increased scatter in both the logarithmic and linear relations , and with the linear relation deviating from a slope of -1 .",
    "finally , by @xmath32 the linear relation deviates drastically from a slope of -1 while the logarithmic relation does very well , though with much scatter .",
    "( left ) and @xmath43 ( right ) , calculated using cic smoothing for a cell size of 1.6 h@xmath2mpc at 4 different redshifts .",
    "a slope of -1 through the origin is plotted for reference .",
    "the color scale is logarithmic and gives the number of cic cells in each histogram bin.[fig : divcic4z ] ]    it is not unexpected that the linear relation does not hold , since 1.6  h@xmath2mpc is by no means in the linear regime , but the fact that the logarithmic relation holds so well echoes the results of @xcite and others that the logarithmic transform of the density field increases the information content of the matter power spectrum in the weakly nonlinear regime . when the cic cell size is increased to 12.5  h@xmath2mpc , both the linear and logarithmic relations become very tight , though the logarithmic approximation continues to do slightly better .",
    "figure  [ fig : divz0 ] is the same as figure  [ fig : divcic4z ] but at @xmath32 , showing the cic method for cell sizes of 1.6 h@xmath2mpc and 12.5  h@xmath2mpc , along with the two other methods discussed in the next sections .",
    "( left ) and @xmath43 ( right ) at @xmath32 , calculated using cic smoothing for a cell size of 12.5 h@xmath2mpc ( top ) and 1.6 h@xmath2mpc ( upper middle ) , adaptive sph - like smoothing with a cell size of 1.6  h@xmath2mpc ( lower middle ) , and the delaunay tessellation field estimator ( dtfe ) method ( bottom ) . a slope of -1 through the origin is plotted for reference .",
    "the color scale is logarithmic and gives the number of cells ( cic and sph ) or particles ( dtfe ) in each histogram bin.[fig : divz0 ] ]      we also try an adaptive smoothing technique , described by @xcite , on both the density and the displacement fields .",
    "we assume that each particle @xmath44 traces some physical quantity @xmath45 . for the purpose of this paper , @xmath45 will be either a particle count or the displacement vector @xmath46 between the final and initial particle positions .",
    "we sample the adaptively - smoothed field onto a three - dimensional grid , with grid sites denoted by the integers @xmath47 . at each grid site",
    "we define the smoothing radius @xmath48 which corresponds to half the distance from the grid site to the @xmath49-th particle , where @xmath49 is defined as : @xmath50 and @xmath51 is the number of particles binned on the grid site @xmath47 .",
    "following  @xcite , we conservatively set @xmath52 , corresponding to the typical number of a particle s closest neighbors .",
    "this choice of @xmath53 ensures that we always take into account a sufficient number of particles for making the adaptively - smoothed field on the grid .",
    "the smoothed - interpolated value @xmath54 at the grid site @xmath47 , which corresponds to a smooth - averaging of the quantities @xmath45 carried out by individual particles @xmath44 , is defined as : @xmath55 where @xmath56 are additional weights to be determined for each particle and @xmath57 is the smoothing kernel function .",
    "we determine the weights by enforcing that the sum of @xmath58 over all grid sites must be the same as the sum of @xmath45 over all particles .",
    "this yields , for @xmath0 particles , @xmath59 the last equality is true if @xmath60 finally , we define the smoothing kernel to be the typical sph compact - support spline  @xcite , @xmath61    we now compute both the mass density fluctuation field @xmath62 and the displacement field @xmath63 in eulerian coordinates . in the case of @xmath0-body simulations ,",
    "the mass density fluctuation field is obtained by putting a mass @xmath64 on each particle @xmath44 , thus @xmath65 where we used the conservation of the quantity @xmath66 , and defined @xmath67 the number of grid sites . in the case of observations",
    ", one could in principle use any tracer of the mass that is available , such as the luminosity or the number of galaxies .",
    "the displacement field is obtained by averaging the displacement carried by each of the tracer particles .",
    "we thus obtain @xmath68 where @xmath69 is the result of applying the adaptive filter to compute the number of tracers on the grid site @xmath47 .",
    "we note that even though in @xmath0-body simulations @xmath70 , this is not the case for observations .",
    "we obtain the divergence of the displacement field in fourier space , as with the previous cic method .",
    "figure  [ fig : divz0 ] shows @xmath26 as a function of @xmath3 and @xmath24 using the adaptive sph smoothing method with a cell size of 1.6 h@xmath2mpc ( lower middle plot ) .",
    "we note that both the cic and sph methods produce very similar results .",
    "the additional advantage of the sph method is that grid cells with zero particles are not an issue , as they are for cic , since @xmath52 particles are always included in the binning .",
    "the vertical artifact near @xmath71 marks the transition where @xmath72 becomes important , above which the adaptive method behaves effectively the same as the cic method .",
    "note however that this is a very small feature that is exaggerated by the logarithmic color scaling on the plot .",
    "the voronoi tessellation and its dual , the delaunay tessellation , divide an @xmath0-dimensional space into a fully volume - covering set of cells based on the underlying particle distribution ( see e.g. @xcite ) .",
    "the resulting distribution of cells is such that the volume of the cells is inversely proportional to the density of the particle field at the location of each sampled particle , leading to a natural and adaptive density estimator  ( the delaunay tessellation field estimator , dtfe ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in the case of the delaunay tessellation",
    ", each particle is surrounded by a set of tetrahedra of which it makes up one of the vertices .",
    "the volume of one tetrahedron , @xmath73 , is a function of the positions of the three other vertices for a particle at the origin : @xmath74 the density is then given by the inverse of the volume of the set of tetrahedra surrounding each particle , @xmath75 .",
    "we choose to normalize the inverse volumes by @xmath76 instead of @xmath77 ( which gives a mean - zero density field ) because the dtfe density distribution has a prominent tail at high densities .",
    "this can be seen in figure  [ fig : pdf ] , in which we plot the distribution functions of the cic @xmath78 and the dtfe @xmath79 .",
    "the cic distribution is much more symmetrical than the dtfe , which has a shoulder at high densities .",
    "note that the mean of the dtfe distribution has not been subtracted so that its peak is much closer to zero .",
    "we also plot a transformed dtfe distribution function in which we weight the original distribution function by the volume : @xmath80 ; this effectively transforms the ( mass - weighted ) lagrangian dtfe distribution into a ( volume - weighted ) eulerian distribution that closely resembles the cic distribution .",
    "the delaunay tessellation also allows a calculation of the divergence of @xmath7 at the location of every particle by using gauss s theorem , @xmath81 . replacing the integrals with discrete sums",
    ", we have @xmath82 where we take @xmath83 to be the average of the @xmath7 values of the three particles making the outside face of the tetrahedron , and where the surface element is given by @xmath84 thus for each particle we have a measure of both @xmath26 and @xmath3 .     for the cic method with 1.6 h@xmath2mpc cell sizes , @xmath85 for the dtfe - calculated volume @xmath86 , and the volume - weighted dtfe transformation ( see the text for explanation ) .",
    "the cic and transformed dtfe distributions are shifted to have zero mean , while the dtfe distribution is not .",
    "the good match between the cic and transformed dtfe distribution functions motivate our use of @xmath87 as the dtfe density variable . [",
    "fig : pdf ] ]    figure  [ fig : divz0 ] shows @xmath26 as a function of @xmath3 and @xmath24 at @xmath32 , calculated using the delaunay tessellation ( bottom plot ) and the other methods .",
    "both the divergence of @xmath7 and the density calculated with the delaunay tessellation lead to a large scatter at high densities beyond the range of the plot , with the maximum values of @xmath26 reaching around @xmath88 .",
    "this large scatter is not surprising because neighbors in high - density regions are unlikely to be true lagrangian neighbors , so their displacements should be fairly random ; additionally , the length - scales associated with the highest densities are smaller than the scale over which we would expect the logarithmic approximation to hold .",
    "while the low - density success of the logarithmic approximation is encouraging , it seems that a lagrangian kernel method is not the most appropriate choice for relating the density and displacement fields .",
    "motivated by the success of the logarithmic density field in improving the statistics of large scale structure into the nonlinear regime , we have compared the linear relation between the density and displacement fields to a logarithmic approach .",
    "we have used different methods of measuring the divergence of the displacement field , @xmath89 , and the density field in cosmological @xmath0-body simulations , and have investigated their relation for different redshifts and smoothing scales .",
    "the logarithmic approach fares better even on scales as small as @xmath12 h@xmath2mpc , where the linear approximation is no longer valid .",
    "smoothing over a uniform grid in eulerian coordinates seems to outperform a tessellation - based lagrangian method , though both work well at low to average densities .",
    "because a key advantage of the logarithmic transformation is the ability to use the density field on weakly nonlinear scales , this method would be most effective for a low - redshift galaxy survey ( such that the effect of nonlinear evolution is strongest ) with a high galaxy density ( such that the mean separation of galaxies is small and in the nonlinear regime ) . using a logarithmic transform of the density to reconstruct",
    "the displacement field is simpler than advanced algorithms such as mak reconstruction  @xcite and thus may require only small changes to existing analysis codes , providing an improvement over the linear method while maintaining a high degree of computational efficiency .",
    "our full investigation of a reconstruction algorithm that uses a logarithmic transform of the density field is left to future work and will be applied to a large suite of cosmological simulations .    when applying this method to an observed galaxy distribution , additional considerations must be accounted for , such as discreteness noise , galaxy bias , and redshift - space distortions .",
    "a log - transform can enhance the effective shot noise caused by particle ( or galaxy ) discreteness , but the log - density can still be usefully estimated in the presence of ( low - enough ) shot noise . @xcite",
    "found that even with a rather sparse galaxy sample , added power - spectrum fisher information in the non - linear regime can be tapped with a log ( or similar ) transform , suggesting that shot noise can be overcome in the present case , as well .",
    "however , it is likely that higher sampling for the log - density field than for the overdensity field will be necessary to resolve the fields at a given resolution .",
    "though a full reconstruction algorithm using a log - density field remains to be tested , we doubt that a logarithmic transform of the density would exacerbate problems caused by galaxy bias or redshift - space distortions , and these problems seem to be manageable in the case of bao reconstruction . for example",
    ", it has been shown that linear reconstruction of the bao peak reduces the effect of bias , including the induced shift in the location of the bao peak  @xcite .",
    "additionally ,  @xcite showed that reconstruction of the bao peak is effective in both real- and redshift - space .",
    "however , we anticipate that fingers of god will at some point prevent the push to smaller scales in redshift - space using a logarithmic transform .",
    "we have shown that a simple logarithmic transformation of the density field provides a substantial improvement of the linear theory relation between the density and displacement fields on sub - linear scales .",
    "this improvement is greatest at low redshift and for eulerian smoothing on small ( @xmath12 h@xmath2mpc ) scales .",
    "this result is in line with the finding that the logarithmic density field restores some lost information to the power spectrum of density fluctuations  @xcite , and provides more evidence that a logarithmic transform of the density field is a powerful density variable on weakly nonlinear scales .",
    "the authors would like to thank the anonymous referee for insightful comments .",
    "blf and mcn are grateful for support from the gordon and betty moore foundation .",
    "gl acknowledges financial support from nsf grant ast 07 - 08849 .",
    "brenier , y. , et al .",
    "2003 , mnras , 346 , 501 coles , p. , & jones , b. 1991 , mnras , 248 , 1 colombi , s. 1994 , apj , 435 , 536 colombi , s. , chodorowski , m. j. , & teyssier , r. 2007 , mnras , 375 , 348 eisenstein , d. j. , seo , h .- j .",
    ", sirko , e. , & spergel , d. n. 2007 , apj , 664 , 675 frisch , u. , matarrese , s. , mohayaee , r. , & sobolevski , a. 2002 , nature , 417 , 260 hamilton , a. j. s. , kumar , p. , lu , e. , & matthews , a. 1991 , apj , 374 , l1 lavaux , g. , tully , r. b. , mohayaee , r. , & colombi , s. 2010 , apj , 709 , 483 mehta , k. t. , et al .",
    "2011 , apj , 734 , 94 mohayaee , r. , mathis , h. , colombi , s. , & silk , j. 2006 , mnras , 365 , 939 monaghan , j. j. 1992 , ara&a , 30 , 543 narayanan , v. , k. , & croft , r. a. c. 1999 , apj , 515 , 471 neyrinck , m. c. 2011 , apj , 742 , 91 neyrinck , m. c. , szapudi , i. , & szalay , a. s. 2009 , apj , 698 , l90 neyrinck , m. c. , szapudi , i. , & szalay , a. s. 2011 , apj , 731 , 116 noh , y. , white , m. , & padmanabhan , n. 2009 , phys .",
    "d , 80 , 123501 padmanabhan , n. , white , m. , & cohn , j. d. 2009 , phys .",
    "d , 79 , 063523 peacock , j. a. , & dodds , s. j. 1994 , mnras , 267 , 1020 peacock , j. a. , & dodds , s. j. 1996 , mnras , 280 , l19 peebles , p. j. e. 1980 , the large scale structure of the universe ( princeton , nj : princeton univ .",
    "press ) pelupessy , f. i. , schaap , w. e. , & van de wegaert , r. 2003 , a&a , 403 , 389 schaap , w. e. , & van de weygaert , r. 2000 , a&a , 363 , l29 seo , h .- j .",
    ", sato , m. , dodelson , s. , jain , b. , & takada , m. 2010 , apj , 729 , l11 springel , v. , yoshida , n. , & white , s. d. m. 2001 , new astron .",
    ", 6 , 79 van de weygaert , r. 1994 , a&a , 283 , 361 van de weygaert , r. , & schaap , w. 2009 , data analysis in cosmology , 665 , 291 weinberg , d. h. 1992 , mnras , 254 , 315 white , m. 2010 , arxiv:1004.0250 zeldovich , ya . b. 1970 , a&a , 5 , 84"
  ],
  "abstract_text": [
    "<S> we investigate the use of a logarithmic density variable in estimating the lagrangian displacement field , motivated by the success of a logarithmic transformation in restoring information to the matter power spectrum . </S>",
    "<S> the logarithmic relation is an extension of the linear relation , motivated by the continuity equation , in which the density field is assumed to be proportional to the divergence of the displacement field ; we compare the linear and logarithmic relations by measuring both of these fields directly in a cosmological @xmath0-body simulation . </S>",
    "<S> the relative success of the logarithmic and linear relations depends on the scale at which the density field is smoothed . </S>",
    "<S> thus we explore several ways of measuring the density field , including cloud - in - cell smoothing , adaptive smoothing , and the ( scale - independent ) delaunay tessellation , and we use both a fourier space and a geometrical tessellation approach to measuring the divergence . </S>",
    "<S> we find that the relation between the divergence of the displacement field and the density is significantly tighter with a logarithmic density variable , especially at low redshifts and for very small ( @xmath12 h@xmath2mpc ) smoothing scales . </S>",
    "<S> we find that the grid - based methods are more reliable than the tessellation - based method of calculating both the density and the divergence fields , though in both cases the logarithmic relation works better in the appropriate regime , which corresponds to nonlinear scales for the grid - based methods and low densities for the tessellation - based method . </S>"
  ]
}