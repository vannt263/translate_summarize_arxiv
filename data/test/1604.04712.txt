{
  "article_text": [
    "among _ ab - initio _ molecular dynamics ( aimd ) simulation methods , born ",
    "oppenheimer molecular dynamics ( bomd ) is considered to have good reliability and predictive power , especially for material systems with a small or vanishing band gap @xcite , and thus has been accepted as the default choice in several well - known aimd simulation packages @xcite .",
    "bomd involves solving the quantum equation ( for us , the kohn ",
    "sham equation @xcite ) for each instantaneous atomic configuration to obtain the atomic and cell forces , and propagating the atomic and cell variables according to classical newtonian dynamics @xcite .",
    "the computational cost of this very time - consuming procedure can be strongly reduced by the extrapolation technique @xcite , which combines results from previous md time steps to predict a good initial guess for the self - consistent field ( scf ) solution of the kohn ",
    "sham equation at the current md time step . in the plane - wave method , the kohn  sham hamiltonian matrix is never assembled explicitly and generally diagonalized by iterative schemes  @xcite , so both the extrapolation of electron density and that of the kohn ",
    "sham eigenvalues and wavefunctions / orbitals are necessary . in this work , we discuss only the wavefunction extrapolation because it covers all difficulties in the extrapolation technique .",
    "the existing extrapolation schemes could be classified into two categories @xcite .",
    "the first is the time extrapolation ( tx ) , which directly extrapolates the wavefunctions as functions of time",
    ". it can be implemented either by the lagrange s polynomial extrapolation formula  @xcite , or by the polynomial least - squares fitting proposed by literature on the fock matrix dynamics  @xcite . in the following text",
    ", we refer to the first implementation when we use the terminology `` tx '' .",
    "the second category is the geometric extrapolation ( gx ) , which determines the wavefunction extrapolation coefficients by minimizing the distance between the current atomic coordinates and a linear combination of atomic coordinates from the previous time steps  @xcite .",
    "these schemes have been implemented in several popular aimd simulation packages using the kohn  sham density functional theory and a plane - wave basis set , see tab .",
    "[ tbl : pkginfo ] for an incomplete summary .",
    "it is worth noting that the order of the tx scheme usually refers to the order of the polynomial used to fit the wavefunctions , but the meaning of `` order '' in the context of gx scheme is not very clear .",
    "however , both tx and gx schemes can be uniformly characterized by the number of wavefunctions from previous md time steps used in the extrapolation .",
    "therefore , we accept this convention and denote the number by @xmath0 in the rest of the manuscript .    .wavefunction extrapolation provided in several popular aimd simulation packages using the kohn  sham density functional theory and a plane - wave basis set . tx and gx",
    "refer to time extrapolation with lagrange polynomial and geometric extrapolation , respectively .",
    "@xmath0 is the number of used md time steps in the extrapolation .",
    "apj and mead denotes the wavefunction alignment scheme proposed by arias , payne and joannopoulos , and the scheme from mead , respectively . [",
    "cols=\"<,^,^,^\",options=\"header \" , ]     by far all tests have employed the mead s wavefunction alignment scheme , as a comparison , the averaged numbers of scf iterations using the apj alignment scheme for time step @xmath1 , 1.0 , 2.0 and 4.0  fs and scf convergence criterion @xmath2  ev are presented in tab .  [ tbl : cu64_tp_arias ] . a comparison between tabs .",
    "[ tbl : cu64_tp_ts ] and [ tbl : cu64_tp_arias ] illustrates that switching to apj alignment scheme does not change the optimal value of @xmath0 , which remains as @xmath3 , 3 , 3 , and 4 for time step @xmath1 , 1.0 , 2.0 and 4.0  fs , respectively .",
    "moreover , considering the optimal number of scf iterations , it is observed that none of the two alignment schemes presents a systematic advantage over the other , and the differences between them are in fact always less than one .",
    "we understand these results as a reflection of the theoretical equivalence ( ignoring a unitary transformation ) between the extrapolated wavefunctions by using the two alignment schemes .",
    "in the above we have demonstrated that the value of @xmath0 is most relevant to the number of scf iterations , and the choice between the two wavefunction alignment schemes or between the tx and gx schemes does not result in a significant difference in the effectiveness of wavefunction extrapolation . in practical simulations of equilibrium systems ,",
    "the optimal @xmath0 may be obtained by short testing simulations , because we notice that in all the testing simulations the average number of scf iterations calculated along the md trajectory enters a steady state only after a few tens of time steps . as an example , the case of @xmath4  fs and @xmath2  ev is shown in fig .",
    "[ fig : scfavg ] .",
    "to 5 with time step @xmath5 = 1.0fs .",
    "the value for time step @xmath6 is averaged from the @xmath0-th to the @xmath6-th time steps .",
    "the scf convergence criterion is @xmath2ev , and the mead s alignment and tx scheme are used .",
    ", scaledwidth=48.0% ]",
    "in this work , we investigated both theoretically and numerically the optimal choice of the critical parameter @xmath0 in the wavefunction extrapolation , which denotes the number of previous md time steps used to construct the initial guess for the scf iteration .",
    "we focused on two types of extrapolations schemes , i.e.  time extrapolation ( tx ) and geometric extrapolation ( gx ) that are most frequently implemented in the popular aimd simulation packages using the kohn  sham density functional theory and a plane - wave basis set .",
    "we showed that the extrapolation error is divided into two parts : the first stems from extrapolating the fully converged wavefunctions and decays exponentially with respect to the parameter @xmath0 .",
    "the second is a linear combination of the scf errors and explodes exponentially with respect to the parameter @xmath0 .",
    "therefore , an optimal value of @xmath0 always exists .",
    "since the convergence speed of the first term is governed by the time step and the magnitude of the second term is proportional to the scf error , we qualitatively predicted that the optimal @xmath0 tends to get larger when increasing the md time step size or tightening the scf convergence criterion .",
    "moreover , we theoretically explained the reason why the tx and gx schemes have much similarity , therefore the analysis for the tx scheme can be extended to the gx scheme without substantial difficulty .",
    "a solid copper system with 64 atoms was chosen to test our theoretical statements .",
    "numerical results on the appearance of optimal values of @xmath0 for the tx scheme under a set of different time step sizes and scf convergence criteria well confirmed the trends predicted by the error analysis . also , a comparison between tx and gx validated their similarity .",
    "it was demonstrated that the optimal value of @xmath0 takes 2 in some cases , and takes as large as 5 in other cases , which saves about 39% scf iterations comparing with @xmath7 ( the default setting in most popular aimd packages ) .",
    "therefore , our work suggest the necessity for aimd simulation packages to open the user interface and provide more choices on the parameter @xmath0 . it should be noted that the extrapolation schemes need the storage of the wavefunctions from the previous @xmath0 time steps , so the additional memory cost grows linearly with respect to an increasing @xmath0 .",
    "therefore , in practice , the user should also consider the balance between the computational and memory costs when choosing the value of @xmath0 .",
    "for the prerequisite alignment step , we theoretically proved that the extrapolated wavefunctions by using apj and mead s schemes differ only by a unitary transformation , and illustrated numerically the essential equivalence between them .",
    "the only concern is for the numerical implementation , that a matrix diagonalization of @xmath8 other than a singular value decomposition of @xmath9 is recommended due to the computational efficiency .",
    "although the tx and gx schemes could significantly accelerate scf convergence , it should be noted that neither of them is designed for total energy conservation .",
    "correspondingly , a systematic total energy drift in microcanonical trajectories exists , and increasing @xmath0 or decreasing the time step does not guarantee a smaller drift .",
    "therefore , in the case when the energy conservation is critical , we suggest either a very strict scf convergence criterion , or new techniques like the aspc or xl - bomd method . in the end",
    ", we would like to point out that our work only prove the existence of the optimal value @xmath0 , and do not tell , _ a priori _ , how large @xmath0 is for a specific system and how much the advantage is by using the optimal @xmath0 instead of the widely accepted value of  3 .",
    "we notice that for the tested copper system , @xmath7 is already optimal under the normally used simulation setups : a time step of @xmath10  fs and a scf convergence criterion of @xmath11  ev .",
    "however , this experience can not be directly extended to other systems .",
    "therefore the value of this work is to point out the existence of the optimal @xmath0 , and the possibility of improving the extrapolation quality , marginally or dramatically , by tuning the value of @xmath0 . in the simulations of equilibrium systems ,",
    "the optimal @xmath0 can be estimated by short testing simulations of a few dozen time steps . moreover ,",
    "the direction of changing @xmath0 is also predicted by our theory when using a different time step size or scf convergence criterion . in the simulations of non - equilibrium systems ,",
    "the optimal choice of @xmath0 is still an open question , and will be investigated in the future .",
    "the authors acknowledge the valuable discussions with dr .",
    "deye lin , and gratefully acknowledge the financial support from national high technology research and development program of china under grant 2015aa01a304 .",
    "is supported by the national science foundation of china under grants 91430218 and 61300012 .",
    "h.w . is supported by the national science foundation of china under grants 11501039 and 91530322 .",
    "we need to solve the following constrained minimization problem : @xmath14 where @xmath15 and @xmath16 are unitary transformed functions from two sets of wavefunctions given by successive md time steps , @xmath17 the weight of the @xmath18-th function , and @xmath19 the computational domain .",
    "it is convenient to rewrite objective function @xmath20 in matrix form : @xmath21 = \\mathrm{tr } \\left[w \\left(2i -{u_{\\psi}^{{\\textrm{a}}}}^{\\dagger}\\,s^{(0)}\\,u_{\\phi}^{{\\textrm{a}}}- { u_{\\phi}^{{\\textrm{a}}}}^{\\dagger}\\ , { s^{(0 ) } } ^{\\dagger } u_{\\psi}^{{\\textrm{a}}}\\right ) \\right],\\ ] ] where tr represents the trace of a matrix , @xmath22 , @xmath23 is the identity matrix , and @xmath24 and @xmath25 are overlap matrices before and after the unitary transformations , respectively .",
    "we introduce additional terms @xmath26 $ ] and @xmath27 $ ] to impose the constraints that @xmath12 and @xmath13 are unitary matrices , and obtain lagrange function @xmath28 + \\lambda_{\\phi}({u_{\\phi}^{{\\textrm{a}}}}^{\\dagger}u_{\\phi}^{{\\textrm{a}}}- i ) + \\lambda_{\\psi}({u_{\\psi}^{{\\textrm{a}}}}^{\\dagger}u_{\\psi}^{{\\textrm{a}}}- i)],\\ ] ] where lagrange multiplier matrices @xmath29 and @xmath30 are both hermitian . taking partial derivatives of @xmath31 with respect to real and imaginary parts of matrix elements of @xmath12 and @xmath13",
    ", we get @xmath32    it is easy to see from ( [ eq : aa - eq ] ) that @xmath33 and then @xmath34 which means @xmath29 and @xmath30 are both commutative with @xmath35 .",
    "since this is true for any @xmath36 , we assume that any two matrix elements of @xmath37 are not equal , and conclude that @xmath29 and @xmath30 are diagonal matrices .",
    "thus , the second equation in ( [ eq : aa - eq ] ) implies that @xmath38 i.e. , @xmath12 is determined as the unitary matrix that diagonalizes @xmath39 .",
    "further , according to ( [ eq : aa - eq ] ) we have @xmath40 the remained work is to determine the sign . recalling @xmath41 , the second equation in ( [ eq : aa - eq ] ) is in fact @xmath42 . then the objective function @xmath21 = 2 \\sum_{j=1}^{n_{\\textrm{band } } }",
    "w_j ( 1-s_j).\\ ] ] because @xmath43 , @xmath20 reaches its minimum when @xmath44 .",
    "thus , we get @xmath45      one choice is to carry out singular value decomposition of @xmath9 : @xmath47 where @xmath48 and @xmath49 are both unitary matrices , and @xmath50 is a diagonal matrix with non - negative elements . since @xmath24 is assumed to be non - singular , matrix elements of @xmath50 is in fact positive .",
    "then @xmath51 it is easy to see that @xmath52 , so we have @xmath53    the other choice is matrix diagonalization : @xmath54 where @xmath55 is a unitary matrix and @xmath56 is a diagonal matrix with positive elements .",
    "it is easy to see that @xmath57 the r.h.s . of this equation",
    "can be written as @xmath58 , so @xmath59 and @xmath60    since singular value decomposition is more computationally consuming than diagonalization , we suggest the latter choice in numerical implementation .",
    "in this section we prove eq .  .",
    "we assume that the scf errors @xmath62 are independent random variables that have vanishing mean and identical variance denoted by @xmath63 . as a short - hand notation",
    ", we write @xmath64 . noticing eq .",
    ", it is clear that the mean of @xmath61 vanishes , and the variance of @xmath61 is estimated by @xmath65 ^ 2    \\big\\rangle    \\\\    = & \\ ,    \\big\\langle    e_n^2    + \\big(\\sum_{k=1}^{m-1 } c_k e_{n - k+1}\\big)^2    + \\big(\\sum_{k=1}^{m-1 } c_k e_{n - k}\\big)^2 \\\\     &    + 2 c_1e_n^2    - 2 \\big(\\sum_{k=1}^{m-1 } c_k e_{n - k+1}\\big ) \\big(\\sum_{k=1}^{m-1 } c_k e_{n - k}\\big )    \\big\\rangle \\\\     = & \\ ,    \\big\\langle    e_n^2    + \\sum_{k=1}^{m-1 } c_k^2 e^2_{n - k+1 }    + \\sum_{k=1}^{m-1 } c_k^2 e^2_{n - k }    + 2 c_1e_n^2    - 2 \\sum_{k=1}^{m-2}c_kc_{k+1}e^2_{n - k }    \\big\\rangle\\\\     = & \\ ,    \\sigma_{{\\textrm{scf}}}^2    \\big (    1 + 2 c_1 + 2 \\sum_{k=1}^{m-1 } c_k^2   - 2   \\sum_{k=1}^{m-2}c_kc_{k+1 }    \\big),\\end{aligned}\\ ] ] where we used the fact that @xmath66 and @xmath67 . noticing that @xmath68 , we reach @xmath69    \\\\    = & \\ ,    \\sigma_{{\\textrm{scf}}}^2    \\bigg [    - 1    + 2 \\sum_{k=0}^{m-1}\\frac{m}{k+1 } \\binom{m-1}{k}^2    \\bigg].\\end{aligned}\\ ] ] the magnitude of @xmath70 can be estimated by @xmath71   \\\\    & \\geq    \\sigma_{{\\textrm{scf}}}^2    \\bigg\\ {    - 1    + \\frac{2}{m }    \\bigg [    \\sum_{k=0}^{m-1 } \\binom{m-1}{k }    \\bigg]^2    \\bigg\\ } \\\\    & =    \\sigma_{{\\textrm{scf}}}^2    \\big\\ {    - 1    + \\frac{2^{(2m-1)}}{m }     \\big\\}.   \\end{aligned}\\ ] ] therefore , the growing speed of the standard deviation of the extrapolated scf noise is lower bounded by @xmath72      d.  marx and j.  hutter . _",
    "ab initio _ molecular dynamics : theory and implementation . in j.",
    "grotendorst , editor , _ modern methods and algorithms of quantum chemistry _ , pages 329477 , john von neumann institute for computing , jlich , 2000 .",
    "p.  giannozzi , s.  baroni , n.  bonini , m.  calandra , r.  car , c.  cavazzoni , d.  ceresoli , g.l .",
    "chiarotti , m.  cococcioni , i.  dabo , a.  d. corso , s.  de  gironcoli , s.  fabris , g.  fratesi , r.  gebauer , u.  gerstmann , c.  gougoussis , a.  kokalj , m.  lazzeri , l.  martin - samos , n.  marzari , f.  mauri , r.  mazzarello , s.  paolini , a.  pasquarello , l.  paulatto , c.  sbraccia , s.  scandolo , g.  sclauzero , a.  p. seitsonen , a.  smogunov , p.  umari , and r.  m. wentzcovitch . : a modular and open - source software project for quantum simulations of materials .",
    ", 21:395502 , 2009 .",
    "x.  gonze , b.  amadon , p.  m. anglade , j.  m. beuken , f.  bottin , p.  boulanger , f.  bruneval , d.  caliste , r.  caracas , m.  cote , t.  deutsch , l.  genovese , p.  ghosez , m.  giantomassi , s.  goedecker , d.  r. hamann , p.  hermet , f.  jollet , g.  jomard , s.  leroux , m.  mancini , s.  mazevet , m.  j.  t. oliveira , g.  onida , y.  pouillon , t.  rangel , g.  m. rignanese , d.  sangalli , r.  shaltaf , m.  torrent , m.  j. verstraete , g.  zerah , and j.  w. zwanziger .",
    "abinit : first - principles approach to material and nanosystem properties .",
    ", 180:25822615 , 2009 .",
    "m.  c. payne , m.  p. teter , d.  c. allan , t.  a. arias , and j.  d. joannopoulos .",
    "iterative minimization techniques for _ ab initio _ total - energy calculations : molecular dynamics and conjugate gradients . , 64:10451097 , 1992 .",
    "g.  zheng , a.  m.  n. niklasson , and m.  karplus .",
    "lagrangian formulation with dissipation of born  oppenheimer molecular dynamics using the density - functional tight - binding method . , 135(4):044122104412217 , 2011 .",
    "j.  vandevondele , m.  krack , f.  mohamed , m.  parrinello , t.  chassaing , and j.  hutter .",
    "quickstep : fast and accurate density functional calculations using a mixed gaussian and plane waves approach .",
    ", 167:103128 , 2005 .",
    "a.  m.  n. niklasson , p.  steneteg , a.  odell , n.  bock , m.  challacombe , c.  j. tymczak , e.  holmstrm , g.  zheng , and v.  weber .",
    "extended lagrangian born  oppenheimer molecular dynamics with dissipation .",
    ", 130(21):21410912141097 , 2009 ."
  ],
  "abstract_text": [
    "<S> wavefunction extrapolation greatly reduces the number of self - consistent field ( scf ) iterations and thus the overall computational cost of born - oppenheimer molecular dynamics ( bomd ) that is based on the kohn  sham density functional theory . </S>",
    "<S> going against the intuition that the higher order of extrapolation possesses a better accuracy , we demonstrate , from both theoretical and numerical perspectives , that the extrapolation accuracy firstly increases and then decreases with respect to the order , and an optimal extrapolation order in terms of minimal number of scf iterations always exists . we also prove that the optimal order tends to be larger when using larger md time steps or more strict scf convergence criteria . </S>",
    "<S> by example bomd simulations of a solid copper system , we show that the optimal extrapolation order covers a broad range when varying the md time step or the scf convergence criterion . </S>",
    "<S> therefore , we suggest the necessity for bomd simulation packages to open the user interface and to provide more choices on the extrapolation order . </S>",
    "<S> another factor that may influence the extrapolation accuracy is the alignment scheme that eliminates the discontinuity in the wavefunctions with respect to the atomic or cell variables . </S>",
    "<S> we prove the equivalence between the two existing schemes , thus the implementation of either of them does not lead to essential difference in the extrapolation accuracy . </S>"
  ]
}