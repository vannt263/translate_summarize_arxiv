{
  "article_text": [
    "over the past few years rapid progress has been made in the field of symbolic summation .",
    "the beginning was made by gosper s telescoping algorithm  @xcite for hypergeometric terms and zeilberger s extension of it to creative telescoping  @xcite .",
    "an algebraic clarification of gosper s setting has been carried out by paule  @xcite . meanwhile various important variations or generalizations have been developed , like for @xmath0hypergeometric terms  @xcite , the mixed case  @xcite , or the @xmath1-finite case  @xcite .",
    "in particular , karr s telescoping algorithm  @xcite based on his theory of difference fields provides a fundamental general framework for symbolic summation .",
    "his algorithm is , in a sense , the summation counterpart to risch s algorithm @xcite for indefinite integration .",
    "karr introduced the so - called @xmath2-extensions , in which parameterized first order linear difference equations can be solved in full generality ; see below .",
    "as a consequence , karr s algorithm can not only deal with telescoping and creative telescoping over hypergeometric terms , but also over rational terms consisting of arbitrarily nested sums and products . more generally , it turned out that also parameterized linear difference equations can be solved in such difference fields  @xcite .",
    "this enables to solve recurrence relations with coefficients in terms of indefinite nested sums and products ; it also gives rise to algorithms for rather general classes , for instance , holonomic sequences  @xcite .",
    "an important general aspect of using difference field methods is the following : in order to exploit the full power of the algorithmic machinery , it is necessary to find for a summand , given in terms of indefinite nested sums and products , a `` good '' representation in a suitable @xmath3-field extension @xmath4 of @xmath5 ; note that some similar considerations for indefinite integration appeared in  @xcite .",
    "based on the results of  @xcite karr comes to the following somehow misleading conclusion  @xcite :    _ loosely speaking , if @xmath6 is summable in @xmath4 , then part of it is summable in @xmath5 , and the rest consists of pieces whose formal sums have been adjoined to @xmath5 in the construction of @xmath4 .",
    "this makes the construction of extension fields in which @xmath6 is summable somewhat uninteresting and justifies the tendency to look for sums of @xmath7 only in @xmath5 . _    in other words",
    ", following karr s point of view , one either succeeds to express a given sum of @xmath6 in @xmath5 , or , if one fails , one adjoins the sum formally to @xmath5 which leads to a bigger field @xmath4 .",
    "but , it turns out that karr s theory of difference field extensions can be refined .",
    "namely , as shown below , his strategy in general produces sum representations that are not optimal with respect to simplification ; see , e.g. , examples  [ exp : truncatednaive ] and  [ exp : depthincreaseexp ] .    as a measure of simplification",
    "we introduce the notion of nested depth . and the main part of this article deals with the problem of finding sum representations which are optimal with respect to this property . based on results of  @xcite",
    "we develop a refined version of karr s summation theory , which leads to the definition of the so called depth - optimal @xmath3-extensions .",
    "various important properties hold in such extensions which are relevant in symbolic summation .",
    "moreover , an efficient telescoping algorithm which computes sum representations with optimal nested depth is presented . throughout this article",
    "all these ideas will be illustrated by one guiding example , namely the identity @xmath8 which was needed in  @xcite to generalize identities from statistics .",
    "we stress that our algorithms are of particular importance to simplify dalembertian solutions  @xcite , a subclass of liouvillian solutions  @xcite , of a given recurrence ; for applications see , e.g. ,  @xcite .",
    "furthermore , we obtain a refined version of creative telescoping which can find recurrences with smaller order ; for applications see , e.g. ,  @xcite .",
    "in addition , we show how our algorithms can be used to compute efficiently algebraic relations of nested sums , like harmonic sums  @xcite    @xmath9    @xmath10 .",
    "we illustrate by concrete examples  @xcite from perturbative quantum field theory how our algorithms can evaluate efficiently feynman diagrams .",
    "the general structure of this article is as follows . in section  [ sec : symbsum ] we introduce the basic summation problems in difference fields . in section  [ sec : mainresults ] we present in summarized form our refined summation theory of depth - optimal @xmath3-extensions in which the central results are supplemented by concrete examples .",
    "some first properties of depth - optimal @xmath3-extensions are proven then in section  [ sec : mainrespart ] . after considering a variation of karr s reduction technique in section  [ sec : reduction ]",
    "we are ready to design algorithms to construct depth - optimal @xmath3-extensions in section  [ sec : constructdeltaext ] . as a consequence we can prove the main results , stated in section  [ sec : mainresults ] , in section  [ sec : mainproofs ] . finally , we present applications from particle physics in section  [ sec : application ] .",
    "let @xmath5 be a _ difference field _ with field automorphism @xmath11 .",
    "note that @xmath12 forms a subfield of @xmath5 ; we call @xmath13 the _ constant field _ of the difference field @xmath14 .",
    "subsequently , we consider the following two problems :    1 .",
    "( _ sequence representation _ ) : * given * sequences @xmath15 ; try to * construct * an appropriate difference field @xmath14 with elements @xmath16 where the shift - behavior @xmath17 for @xmath18 is reflected by @xmath19 .",
    "( _ parameterized telescoping _ ) : * given * @xmath14 with @xmath20 and @xmath21 ; * find * all @xmath22 and @xmath23 such that @xmath24    then reinterpreting such a solution @xmath23 with @xmath22 in terms of a sequence @xmath25 gives @xmath26 which then holds in a certain range @xmath27 . hence , summing this equation over @xmath28 gives @xmath29 if we restrict to @xmath30 in   and search for a solution with @xmath31 , we solve the telescoping problem : * given * @xmath7 ; * find * @xmath23 such that @xmath32 moreover , zeilberger s creative telescoping  @xcite can be formulated by translating @xmath33 into @xmath34 for a parameter @xmath35 which occurs in the constant field @xmath36 .",
    "karr s summation theory  @xcite treats these problems in the so - called @xmath2-difference fields . in our work",
    "we restrict to @xmath3-extensions  @xcite being slightly less general but covering all sums and products treated explicitly in karr s work .",
    "those fields are introduced by difference field extensions .",
    "a difference field @xmath37 is a _ difference field extension _ of a difference field @xmath38 if @xmath5 is a subfield of @xmath5 and @xmath39 for all @xmath7 ; since @xmath40 and @xmath41 agree on @xmath5 , we usually do not distinguish between them anymore .",
    "a difference field extension @xmath42 of @xmath14 is a _ @xmath43-extension _ ( resp .  _",
    "@xmath44-extension _ ) , if @xmath45 is transcendental over @xmath5 , @xmath46 ( resp .",
    "@xmath47 ) for some @xmath48 and @xmath49 ; if it is clear from the context , we say that @xmath45 is a @xmath43-extension ( resp .",
    "a @xmath44-extension ) .",
    "@xmath3-extension _ is either a @xmath44-extension or a @xmath43-extension .    a _ @xmath44-extension ( resp .",
    "@xmath43-extension/@xmath3-extension ) _ @xmath50 of @xmath14 is a tower of such @xmath44-extensions ( resp.@xmath43-extensions/@xmath3-extensions ) .",
    "such an extension if defined over @xmath51 if @xmath51 is a subfield of @xmath5 and for all @xmath52 , @xmath53 or @xmath54 is in @xmath55 ; note : @xmath56 , if @xmath57 .",
    "a @xmath3-extension @xmath50 of @xmath14 is called _ generalized dalembertian _ , or in short _ polynomial _ , if @xmath58 $ ] or @xmath59 for all @xmath52 .",
    "@xmath3-field @xmath14 over @xmath36 _ is a @xmath3-extension @xmath14 of @xmath60 with @xmath61 .",
    "karr derived an algorithm  @xcite that solves the following more general problem which under the specialization @xmath62 and @xmath63 gives  .",
    "[ rem : sigmasit ] karr s algorithm or our simplified version  @xcite can be applied if @xmath14 is a @xmath3-extension of @xmath64 where @xmath64 satisfies certain properties ; see  @xcite . as a consequence ,",
    "we obtain algorithms for problem  pfde  if @xmath64 is given as follows :    ( 1 ) : :    @xmath65 : as    worked out in  ( * ? ? ?",
    "3.2,thm .",
    "3.5 ) , we obtain a complete    algorithm , if @xmath36 is as a rational function    field over an algebraic number field .",
    "( 2 ) : :    the free difference field @xmath64    with    @xmath66 ,    @xmath67 for @xmath68 ,    and @xmath36 is as in  * ( 1)*. in this setting generic    sequences can be treated ; see  @xcite .",
    "( 3 ) : :    the radical difference field    @xmath69    with @xmath70 and @xmath67    where @xmath71 ; @xmath36 is given as    in  * ( 1)*. this allows to handle @xmath72 ; see  @xcite .",
    "( 4 ) : :    @xmath64 is a    @xmath3-extension of one of the difference fields    described in * ( 1)**(3)*.      sum - product expressions can be represented in @xmath3-fields with the following result  @xcite .    [ thm : pisigma ] let @xmath42 be a difference field extension of @xmath14 with  @xmath73 .",
    "( 1 ) : :    @xmath45 a @xmath43-extension iff    @xmath74 and there is no @xmath23    s.t .  . ( 2 ) : :    @xmath45 is a @xmath44-extension iff    @xmath75 , @xmath76 and there are no    @xmath77    s.t .  @xmath78 .",
    "consequently , we are allowed to adjoin a sum formally by a @xmath43-extension if and only if there does not exist a solution of the telescoping problem .",
    "the product case works similarly ; for further information and problematic cases we refer to  @xcite .",
    "[ exp : truncatednaive ] we try to simplify the left hand side of   by telescoping , or equivalently , by representing   in a @xmath3-field . for simplicity of representation",
    ", it will be convenient to rewrite this expression as    @xmath79    ( 1 ) : :    we start with the difference field    @xmath80 with    @xmath81 for all @xmath82 ,    i.e. , @xmath83 is the constant    field .",
    "since there is no @xmath84 with    @xmath85 , we can define the    @xmath43-extension    @xmath86 of    @xmath60 with    @xmath70 .",
    "( 2 ) : :    since there are no @xmath87 and    @xmath88 with @xmath89    ( for algorithms see  @xcite ) , we can define the    @xmath44-extension    @xmath90 of    @xmath86 with    @xmath91 .",
    "similarly , we introduce the    @xmath44-extension    @xmath92 of    @xmath90 with    @xmath93 . by construction ,    @xmath40 reflects the shift in @xmath28 with    @xmath94 and    @xmath95 .",
    "( 3 ) : :    next , we try to simplify @xmath96 by telescoping .",
    "since we    fail , i.e. , there is no @xmath97 with    @xmath98 , we add the    @xmath43-extension    @xmath99 of    @xmath92 with    @xmath100 ; note that    @xmath101 .",
    "( 4 ) : :    finally , we look for a @xmath102 such    that    +    @xmath103    +    since there is none , see example  [ exp : truncatednaiverat ] , we adjoin    the sum   in form of the @xmath43-extension    @xmath104 of    @xmath99 with    @xmath105 .    summarizing , using this straight - forward approach the sum   could not be simplified : the two nested sum - quantifier is reflected by the nested definition of @xmath104 .",
    "let @xmath14 be a @xmath3-extension of @xmath64 with @xmath106 where @xmath107 or @xmath108 for @xmath52 .",
    "the _ depth function for elements of @xmath5 over @xmath109 _",
    ", @xmath110 , is defined as follows .    1 .   for any @xmath111 , @xmath112 .",
    "if @xmath113 is defined for @xmath114 with @xmath115 , we define @xmath116 ; for @xmath117 , with @xmath118 $ ] coprime , we define @xmath119    for @xmath120 , @xmath121 .",
    "the _ depth of @xmath14 _ , in short @xmath122 , is given by @xmath123 .",
    "similarly , the _ extension depth _ of a @xmath3-extension @xmath124 of @xmath14 is @xmath125 .",
    "this extension is _ ordered _ if @xmath126 ; if @xmath127 , we call @xmath124 an _ ordered _ @xmath3-field .    in the @xmath3-extension @xmath104 of @xmath60 from example  [ exp :",
    "truncatednaive ] the depth ( function ) is given by @xmath128 , and @xmath129 .    throughout this article",
    "the depth is defined over the ground field @xmath64 ; we set @xmath130 .",
    "we might use the depth function without mentioning @xmath109 .",
    "then we assume that the corresponding difference fields are @xmath3-extensions of @xmath64 .",
    "moreover , note that the definition of @xmath131 depends on the particular way the extension field @xmath5 is build from @xmath109 .",
    "we consider the sum   and take the @xmath3-field @xmath99 with    @xmath132    which we introduced in example  [ exp : truncatednaive ] .",
    "now we proceed differently : we compute the @xmath3-extension @xmath133 of @xmath134 with    @xmath135    in which we find the solution @xmath136 of  ; for details see example  [ exp : constructdepthoptext ] .",
    "note that @xmath137 and @xmath138 , in particular , @xmath139 . reinterpreting @xmath140 as a sequence and checking initial values produces  .",
    "we emphasize that this way we have reduced the depth in   since @xmath140 and the summand @xmath141 in   have the same depth @xmath142 .",
    "this example motivates us to consider the following refined telescoping problem .",
    "[ exp : s12s21 ] our goal is to encode the harmonic sums @xmath143 and @xmath144 in a @xmath3-field .",
    "( 1 ) : :    first we express    @xmath145 with the inner    sum @xmath146 in the    @xmath3-field    @xmath147 with    @xmath70 ,    @xmath148 and    @xmath149 ,    i.e. , @xmath150 and @xmath151 represent    @xmath152 and @xmath143 , respectively ; note    that we failed to express @xmath143 in an extension    with depth @xmath153 . ( 2 ) : :    next , we consider    @xmath154 .",
    "we start with    @xmath155 and construct the    @xmath43-extension    @xmath156 of    @xmath157 with    @xmath158 .",
    "finally , we treat the    sum @xmath144 and look for a @xmath140 such that    @xmath159 .",
    ": :    since there is no    @xmath160 , we take the    @xmath43-extension    @xmath161    of @xmath156 with    @xmath162 . : :    we can compute the @xmath43-extension    @xmath163    of @xmath164    with @xmath165 in which we find    the solution @xmath166 .",
    "note that this    alternative solution has the same depth , namely    @xmath167 , but the underlying    @xmath3-field is simpler .",
    "as result , we obtain    @xmath168    to sum up , the following version of telescoping is relevant .",
    "we shall refine karr s theory such that we can find a common solution to  dot  and  dot@xmath169 .",
    "a difference field extension @xmath170 of @xmath14 with @xmath171 is called _ depth - optimal _ @xmath43-extension , in short @xmath172-extension , if there is no @xmath43-extension @xmath37 of @xmath14 with extension depth @xmath173 and @xmath174 such that  .",
    "a @xmath3-extension @xmath50 of @xmath14 is depth - optimal , in short a @xmath175-extension , if all @xmath43-extensions - extensions are @xmath43-extensions by theorem  [ thm : pisigma].1 .",
    "note also that @xmath44-extensions are not refined here ; this gives room for further investigations ; see , e.g. ,  @xcite .",
    "] are depth - optimal .",
    "a @xmath175-field consists of @xmath44- and @xmath172-extensions .",
    "our main result is that problems  sr , dot  and  dot@xmath169  can be solved algorithmically in @xmath175-extensions .",
    "moreover , we will derive various properties that are of general relevance to the field of symbolic summation and that do not hold for @xmath3-extensions in general .    _ in all our results  19 , stated below and proved in section  [ sec : mainproofs ] , we suppose that @xmath14 is a @xmath175-extension of @xmath64 and @xmath176 . from an algorithmic point of view",
    "we assume that @xmath64 is @xmath40-computable : _    a difference field @xmath64 is _",
    "@xmath40-computable _ , if one can execute the usual polynomial arithmetic of multivariate polynomials over @xmath109 ( including factorization ) , and if one can solve problem  pfde  algorithmically in any @xmath3-extension @xmath14 of @xmath64 .",
    "for instance , @xmath64 can be any of the fields given in remark  [ rem : sigmasit ] . in our examples",
    "we restrict to the case @xmath177 , i.e. , @xmath14 is a @xmath3-field over @xmath109 .",
    "* 1 .  construction .",
    "* problem  sr  can be handled algorithmically in @xmath175-extensions .",
    "[ exp : constructdepthoptext ] the @xmath3-field @xmath99 with   is depth - optimal since dot  with @xmath178 and @xmath179 has no solution .",
    "moreover , @xmath180 is a @xmath172-extension of @xmath99 with  . with the solution @xmath136 of   we represent the sum   in a @xmath175-field ; for algorithmic details",
    "see example  [ exp : truncatedfullrat ] .",
    "* 2 .  reordering .",
    "* let @xmath181 be a @xmath3-extension of @xmath64 with @xmath107 or @xmath108 for @xmath52 .",
    "if there is a permutation @xmath182 with @xmath183 for all @xmath184 , @xmath185 is again a @xmath3-extension of @xmath64 and @xmath186 is isomorphic to @xmath187 as fields . in short ,",
    "we say that @xmath181 can be _ reordered to _ @xmath185 ; on the field level we identify such fields .",
    "clearly , by definition of nested depth there is always a reordering that brings a given field to its ordered form , i.e. , @xmath188 for @xmath52 .",
    "note that reordering of @xmath175-extensions without destroying depth - optimality is not so obvious : putting @xmath43-extensions in front or removing them , might change the situation of problem  dot@xmath169 .",
    "but one of our main results says that reordering indeed does not matter .",
    "[ exp : s12reordered ] let @xmath163 be the @xmath175-field from example  [ exp : s12s21 ] . then , e.g. , the ordered @xmath3-field @xmath189 is depth - optimal .",
    "depth  stability . *",
    "the following example illustrates the importance of result  [ res : depthstable ] .",
    "[ exp : depthincreaseexp ] let @xmath161 be the @xmath3-field from example  [ exp : s12s21 ] which is not depth - optimal .",
    "we find the solution @xmath190 of   with @xmath191 .",
    "hence , @xmath192 . in other words , we obtained the identity @xmath193 where the depth is increased by telescoping ; compare  .",
    "we remark that result  [ res : depthstable ] can be exploited algorithmically : in order to find all solutions of  , one only has to take into account those extensions with depth @xmath194 .    *",
    "extension  stability . *",
    "the most crucial property is the following : suppose we are given a @xmath172-extension @xmath195 of @xmath14",
    ". then we can embed any @xmath43-extension @xmath196 of @xmath14 in a @xmath172-extension @xmath37 of @xmath195 without increasing the depth .",
    "the @xmath3-field @xmath14 from example  [ exp : s12reordered ] with @xmath197 is depth - optimal , and @xmath195 with @xmath198 is a @xmath172-extension of @xmath14 .",
    "now consider in addition the @xmath3-extension @xmath196 of @xmath14 with @xmath199 ; see example  [ exp : s12s21 ] .",
    "then we can take the @xmath172-extension @xmath37 of @xmath195 with @xmath200 , see example  [ exp : s12reordered ] , and we can define the field homomorphism @xmath201 with @xmath202 for all @xmath7 , @xmath203 and @xmath204 . by construction , @xmath205 is injective and @xmath206 for all @xmath207 . in other words , we have embedded @xmath196 in @xmath37 with for all @xmath208 .",
    "more precisely , @xmath209 is called a _",
    "@xmath40-monomorphism/@xmath40-isomorphism _ for @xmath14 and @xmath210 if @xmath205 is a field monomorphism / isomorphism with @xmath211 for all @xmath212 .",
    "+ let @xmath14 and @xmath213 be difference field extensions of @xmath196 .",
    "an _ @xmath51-monomorphism_/_@xmath51-isomorphism _",
    "@xmath209 is a @xmath40-monomorphism/@xmath40-isomorphism with @xmath214 for all @xmath208 .    *",
    "depth  optimal transformation .",
    "* by result  [ res : extensiondepthstable ] any @xmath3-extension of @xmath14 can be transformed to a @xmath175-extension with the same or an improved depth - behavior .",
    "hence the refinement to @xmath175-extensions does not restrict the range of applications ; on the contrary , the refinement to @xmath175-extensions can lead only to better depth behavior .    *",
    "product  freeness .",
    "* @xmath44-extensions are irrelevant for problem  dot .",
    "+    * 7 .",
    "alternative definition .",
    "* thus we obtain the following equivalent definition .",
    "+    * 8 .",
    "a common solution to  dot  and  dot@xmath169 * can be found by result  [ res : depthconstruct ] and +    * 9 .",
    "refined parameterized telescoping . *",
    "+    [ equ : creasol ] for @xmath215 we take the @xmath175-field @xmath216 over @xmath217 with @xmath70 , @xmath218 and @xmath219 ; then @xmath220 and @xmath221 can be represented by @xmath222 , respectively .",
    "we set @xmath223 and @xmath130 , and get @xmath224 .",
    "then we find the @xmath172-extension @xmath37 of @xmath225 with @xmath226 , @xmath227 and @xmath228 which fulfills the properties from result  [ res : paratele ] .",
    "in particular , we get @xmath229 and @xmath230 s.t .  .",
    "hence , for @xmath231 , we get @xmath232 .",
    "summation over @xmath28 from @xmath233 to @xmath234 gives @xmath235 for    @xmath236    together with @xmath237 , we arrive at the recurrence relation    @xmath238    and can read off the closed form @xmath239 note : only a recurrence of order two is produced for @xmath240 by using standard creative telescoping ; see  ( * ? ? ?",
    "* how to proceed .",
    "* we will prove results  19 as follows . in section  [ sec : mainrespart ]",
    "we first show weaker versions of results  [ res : reordering][res : constructsigmaextontop ] ; there we impose that all @xmath175-extensions are ordered .",
    "after general preparation in section  [ sec : reduction ] , these results allow us to produce theorem  [ thm : extendforteleordered ] ( cf .",
    "result  [ res : depthconstruct ] ) in section  [ sec : constructdeltaext ] .",
    "given all these properties , we will show our results  19 in full generality in section  [ sec : mainproofs ] .",
    "let @xmath14 be a difference field with @xmath20 , @xmath120 and @xmath241 .",
    "we write @xmath242 and @xmath243 .",
    "let @xmath244 be a subspace of @xmath5 over @xmath36 .",
    "the _ solution space _ for @xmath245 and @xmath246 in @xmath244 is defined by @xmath247 it forms a subspace of the @xmath36-vector space @xmath248 .",
    "in particular , note that the dimension is at most @xmath249 ; see  @xcite .",
    "if @xmath250 , we write in short @xmath251 thus finding bases of @xmath252 or @xmath253 solves problem  pt  or  pfde , respectively .",
    "let @xmath254 be a rational function field .",
    "for a polynomial @xmath255 $ ] the degree is denoted by @xmath256 ; we set @xmath257 .",
    "we define @xmath258 , \\deg(p)<\\deg(q)\\ } } } ; & { \\mathbb{f}}[t]_k&:={{\\{p\\in{\\mathbb{f}}[t]\\,|\\,\\deg(p)\\leq k\\}}}\\end{aligned}\\ ] ] for @xmath259 .",
    "let @xmath260^n$ ] .",
    "then @xmath261 gives the @xmath262-th coefficient of @xmath263 $ ] .",
    "moreover , we define @xmath264    * extensions and reordering.*[page : ordering ] we will exploit the following fact frequently : if @xmath265 is a @xmath3-extension of @xmath64 and @xmath266 is a @xmath3-extension of @xmath265 over @xmath109 , we can reorder @xmath266 to the @xmath3-extension @xmath267 of @xmath64 . + we call a difference field @xmath268 a @xmath3-extension ( resp .",
    "@xmath43-extension/@xmath44-extension ) of @xmath181 if there is a @xmath3-extension ( resp .",
    "@xmath43-extension/@xmath44-extension ) @xmath269 of @xmath181 over @xmath109 such that we get the difference field @xmath268 by reordering the difference field @xmath269 .",
    "note that here @xmath270 could be @xmath271 , but additional reordering might be possible . in a nutshell , we enlarge the ground field @xmath109 by additional @xmath3-extensions to the field @xmath270 where @xmath268 is still a @xmath3-extension of @xmath181 .",
    "* basic properties . *",
    "the next properties follow from karr s theory  @xcite .",
    "[ lemma : karr ]",
    "let @xmath272 with @xmath273 be a @xmath3-extension of @xmath196 .",
    "let @xmath274 and suppose there is a solution @xmath275 with @xmath276 , but no solution in @xmath51 . if @xmath277 is a @xmath44-extension , then @xmath76 and @xmath278 for some @xmath279 and @xmath280 ; if @xmath277 is a @xmath43-extension , then @xmath281 and @xmath74 .",
    "[ cor : extendpioversigma ] let @xmath195 be a @xmath43-extension of @xmath14 . if @xmath42 is a @xmath44-extension of @xmath14 with @xmath47 , then @xmath282 is a @xmath44-extension of @xmath195 with @xmath47 .",
    "write @xmath283 with the @xmath43-extensions @xmath284 . if @xmath285 , nothing has to be shown .",
    "suppose that @xmath282 is not a @xmath44-extension of @xmath195 .",
    "then we find a @xmath286 with @xmath287 for some @xmath288 by theorem  [ thm : pisigma].2 . by lemma  [ lemma : karr ]",
    "it follows that @xmath23 .",
    "hence @xmath42 is not a @xmath44-extension of @xmath14 by theorem  [ thm : pisigma].2 .",
    "[ prop : propertiesinpisi ] let @xmath37 be a @xmath3-extension of @xmath14 with @xmath13 and @xmath7 .",
    "( 1 ) : :    if there is a @xmath289 such    that  , then there is no @xmath23 such that  .",
    "( 2 ) : :    let @xmath290 with    @xmath291 or    @xmath292 for    @xmath52 .",
    "if @xmath174 s.t .  ,    then @xmath293 where    @xmath294 and @xmath295 ;    moreover , @xmath296 , if    @xmath59 .    * ( 1 ) *  assume there are such @xmath297 and @xmath289",
    ". then @xmath298 , and thus @xmath299 , a contradiction that @xmath37 is a @xmath3-extension of @xmath14 . * ( 2 ) *  is a special case of  ( * ? ? ?",
    "* result , page  314 ) ; see also  ( * ? ? ? * thm .",
    "4.2.1 ) .",
    "[ prop : homproperties ] let @xmath14 , @xmath210 be difference fields with a @xmath40-isomorphism @xmath209 .",
    "( 1 ) : :    let @xmath42 and    @xmath300 be    @xmath43-extensions of    @xmath14 and    @xmath210 , respectively , with    @xmath301 such that    @xmath302 . then there is a    @xmath40-isomorphism    @xmath303 with    @xmath304 and @xmath305 for all    @xmath7 .",
    "( 2 ) : :    let @xmath42 be a    @xmath3-extension of    @xmath14 with    @xmath306 .",
    "then there is a    @xmath3-extension    @xmath307 of    @xmath213 with    @xmath308 . moreover",
    ", there    is the @xmath40-isomorphism    @xmath309 where    @xmath310 and @xmath311 for all    @xmath212 .",
    "( 3 ) : :    let @xmath37 be a    @xmath3-extension of    @xmath14 then there is a    @xmath3-extension    @xmath312 of    @xmath213 with a    @xmath40-isomorphism    @xmath309 where    @xmath311 for all @xmath212 .    * ( 1 ) *  let @xmath313 , and let @xmath301 such that @xmath314 . by proposition",
    "[ prop : propertiesinpisi].2 there are a @xmath315 and a @xmath316 such that @xmath317 . since @xmath318 is transcendental over @xmath319 , also @xmath140 is transcendental over @xmath319 .",
    "therefore we can define the field isomorphism @xmath320 with @xmath304 and @xmath305 for all @xmath7 .",
    "we have @xmath321 and thus @xmath322 is a @xmath40-isomorphism . since @xmath323 , the first part is proven . *",
    "( 2 ) *  let @xmath42 be a @xmath3-extension of @xmath14 with @xmath306 . since @xmath205 is a @xmath40-isomorphism , there is a @xmath3-extension @xmath307 of @xmath210 with @xmath308 by theorem  [ thm : pisigma].1 .",
    "we can construct the field isomorphism @xmath303 with @xmath310 and @xmath311 for all @xmath212 .",
    "since @xmath324 , @xmath322 is a @xmath40-isomorphism . iterative application of  * ( 2 ) * shows  * ( 3)*.",
    "we will show the first properties of depth - optimal @xmath3-extensions ; some of the following results and proofs are simplified and streamlined versions of  @xcite    [ prop : twonestedext ] a @xmath3-extension @xmath181 of @xmath64 with @xmath325 , @xmath326 and @xmath177 is depth - optimal .",
    "@xmath327 is depth - optimal .",
    "suppose that @xmath328 is not depth - optimal with @xmath329 .",
    "set @xmath330 .",
    "then there is a @xmath3-extension @xmath124 of @xmath14 with @xmath331 and @xmath332 such that  . by prop .",
    "[ prop : propertiesinpisi].2 , @xmath333 for some @xmath334 . then @xmath335 ; a contradiction to theorem  [ thm : pisigma].1 .",
    "[ lemma : depthstablesummation ] let @xmath37 with @xmath290 be an ordered @xmath175-extension of @xmath14 with @xmath336 and @xmath337 .",
    "let @xmath7 with @xmath338 .",
    "then for any @xmath174 with  , @xmath339 .",
    "suppose we have   with @xmath174 and @xmath340 .",
    "hence @xmath140 depends on one of the @xmath328 , i.e. , let @xmath341 and @xmath342 such that @xmath343 . by proposition  [ prop : propertiesinpisi].2 , @xmath344 where @xmath207 , @xmath345 and @xmath346 .",
    "since the extension is ordered , @xmath347 . by proposition  [ prop : propertiesinpisi].1",
    "there is no @xmath348 with @xmath349 .",
    "therefore by theorem  [ thm : pisigma].1 one can construct a @xmath43-extension @xmath350 of @xmath196 with @xmath171 where @xmath351 .",
    "note that @xmath352 with @xmath353 . hence @xmath328 is not depth - optimal , a contradiction .",
    "therefore @xmath339 .",
    "[ thm : depthstableordered ] let @xmath14 be an ordered @xmath175-extension of @xmath64 and @xmath354 . if @xmath23 as in  , then  .",
    "since @xmath355 , @xmath356 . if @xmath357 , then @xmath142",
    "otherwise , since @xmath14 is ordered , we can split @xmath5 into the @xmath175-extension @xmath14 of @xmath196 with @xmath358 ( @xmath359 ) and the @xmath175-extension @xmath196 of @xmath64 where @xmath360 for each @xmath52 and @xmath361 . by lemma  [ lemma : depthstablesummation ] , @xmath362 .",
    "[ lemma : shiftsumtoleft ] let @xmath50 be a @xmath175-extension of @xmath14 and @xmath363 be a @xmath43-extension of @xmath50 with @xmath364 for all @xmath52 . by reordering , @xmath365 is a @xmath175-extension of @xmath366 .",
    "we show the lemma by induction . if @xmath285 , nothing has to be shown .",
    "consider @xmath367 as claimed above with @xmath368 .",
    "then by the induction assumption @xmath369 is a @xmath175-extension of @xmath370 .",
    "note that @xmath371 is a @xmath3-extension of @xmath14 .",
    "if @xmath327 is a @xmath44-extension , we are done .",
    "otherwise , suppose that @xmath327 is a @xmath43-extension with @xmath372 which is not depth - optimal .",
    "then there is a @xmath43-extension @xmath196 of @xmath366 with extension depth @xmath373 and @xmath374 such that  .",
    "since @xmath375 , @xmath196 is a @xmath43-extension of @xmath14 with extension depth @xmath373 . a contradiction that @xmath376 is a @xmath172-extension of @xmath14 .",
    "the following two propositions will be heavily used in section  [ sec : constructdeltaext ] .",
    "[ prop : extensionontop ] let @xmath37 with @xmath290 be an ordered @xmath175-extension of @xmath14 where @xmath336 and @xmath377 .",
    "suppose that @xmath124 is a @xmath43-extension of @xmath14 with @xmath378 and @xmath379 for @xmath380",
    ". then the following holds .",
    "( 1 ) : :    there is the @xmath43-extension    @xmath381 of    @xmath37 with    @xmath382 for all @xmath383 with    @xmath380 . ( 2 ) : :    in particular , by reordering , we get the    @xmath3-extension    @xmath384    of @xmath14 ;    @xmath384    is a @xmath175-extension of    @xmath124 .    * ( 1 ) *  let @xmath385 be minimal s.t.@xmath386 is not a @xmath43-extension of @xmath37 . take @xmath387 s.t .",
    "hence @xmath339 , i.e. , @xmath389 by lemma  [ lemma : depthstablesummation ] ; this contradicts thm .",
    "[ thm : pisigma].1 .",
    "iterative application of lemma  [ lemma : shiftsumtoleft ] proves  * ( 2)*.    [ prop : reorderequaldepth ] let @xmath50 be a @xmath175-extension of @xmath14 with @xmath390 for @xmath52 and @xmath391 . for @xmath182 , @xmath392 is a @xmath175-extension of @xmath14 .",
    "let @xmath393 ( @xmath285 is trivial ) ; take @xmath394 with @xmath395 such that @xmath396 is not a @xmath172-extension of @xmath397 with @xmath398 .",
    "choose a @xmath43-extension @xmath399 of @xmath397 with @xmath400 and @xmath401 such that  .",
    "note that @xmath402 is a @xmath43-extension of @xmath14 by reordering ; hence by prop .",
    "[ prop : extensionontop].2 , @xmath403 is a @xmath43-extension of @xmath50 .",
    "let @xmath404 . by prop .",
    "[ prop : propertiesinpisi].2 , @xmath405 where @xmath406 and @xmath407 .",
    "let @xmath408 be maximal such @xmath409 ; if @xmath296 for all @xmath410 , set @xmath411 .",
    "if @xmath412 , @xmath413 for @xmath414 . otherwise , @xmath415 with @xmath416 for @xmath417 . summarizing ,",
    "@xmath418 is not a @xmath172-extension of @xmath419 , a contradiction .",
    "[ thm : constructsigmaextontopordered ] let @xmath14 be a @xmath3-extension of @xmath64 and let @xmath195 be a @xmath43-extension of @xmath14 which can be brought to an ordered @xmath175-extension of @xmath64 . then for any @xmath43-extension @xmath196 of @xmath14 with extension depth @xmath420 there is a @xmath43-extension @xmath37 of @xmath195 with extension depth @xmath421 and an @xmath5-monomorphism @xmath201 s.t .   for @xmath208 .",
    "let @xmath422 be an ordered @xmath175-extension of @xmath14 that we get by reordering the @xmath43-extension @xmath195 of @xmath14 .",
    "moreover , let @xmath196 be a @xmath43-extension of @xmath14 with extension depth @xmath420 , i.e. , @xmath423 .",
    "suppose that @xmath424 , otherwise we can reorder it without loosing any generality .",
    "we show that there is a @xmath43-extension @xmath37 of @xmath422 with extension depth @xmath421 and an @xmath5-monomorphism @xmath201 with @xmath425 for @xmath208 .",
    "then reordering of @xmath422 proves the statement for the extension @xmath195 of @xmath14 .",
    "+ if @xmath285 , i.e. , @xmath426 , the statement is proven by taking @xmath427 with the @xmath5-monomorphism @xmath428 where @xmath214 for all @xmath212 .    otherwise , suppose that @xmath429 with @xmath430 and @xmath431 where @xmath432 and @xmath433 .",
    "moreover , assume that there is a @xmath43-extension @xmath312 of @xmath422 with extension depth @xmath434 together with an @xmath5-monomorphism @xmath435 such that   for all @xmath436 .",
    "now define @xmath437 . by assumption @xmath438 * case  1 : * suppose that there is no @xmath439 as in  .",
    "then we can construct the @xmath43-extension @xmath440 of @xmath312 with @xmath441 by theorem  [ thm : pisigma].1 and can define the @xmath5-monomorphism @xmath442 such that @xmath311 for all @xmath436 and @xmath443 . with   we get @xmath444 . by the induction assumption , @xmath445 for all @xmath446 . clearly , the @xmath43-extension @xmath440 of @xmath422 has extension depth  @xmath421 . +",
    "* case  2 : * suppose there is a @xmath447 with @xmath448 . since @xmath312 is a @xmath43-extension of @xmath422 with extension depth @xmath434 ( @xmath449 ) we can apply lemma  [ lemma : shiftsumtoleft ] and obtain by reordering of @xmath312 an ordered @xmath175-extension @xmath450 of @xmath451 where @xmath452 and @xmath453 for all @xmath454 .",
    "hence with   we can apply lemma  [ lemma : depthstablesummation ] and it follows that @xmath455 , i.e. , @xmath456 since @xmath205 is a monomorphism , there is no @xmath140 in the image @xmath457 such that  . since @xmath458 is a difference field ( it is a sub - difference field of @xmath312 ) , @xmath459 is transcendental over @xmath457 by theorem  [ thm : pisigma].1 . in particular",
    ", we get the @xmath5-monomorphism @xmath460 with @xmath311 for all @xmath436 and @xmath443 . with   and",
    "our induction assumption it follows that @xmath445 for all @xmath446 .",
    "this completes the induction step .",
    "we modify karr s reduction for problem  pt : given a @xmath3-extension @xmath461 of @xmath196 and @xmath462 ; find a basis @xmath463 of @xmath464 , as follows : first split @xmath465 by polynomial division in the form @xmath466 such that @xmath467 and @xmath468^n$ ] ; in short we write @xmath469^n.\\ ] ] then the following lemma , a direct consequence of  ( * ? ? ?",
    "* lemma  3.1 ) , is crucial .",
    "[ lemma : splitproblem ] let @xmath461 be a @xmath3-extension of @xmath196 with @xmath306 and  .",
    "then @xmath470 , @xmath471 $ ] solve   iff @xmath472 and @xmath473 .    note that we get a first strategy : find bases for @xmath474 and @xmath475})}$ ] , and afterwards combine the solutions accordingly to get a basis of @xmath476 . as it will turn out , the following version , presented in figure  [ fig : ratred ] ,",
    "is more appropriate : first solve the rational problem ( rp ) ; if there is no solution , there is no solution for the original problem .",
    "otherwise plug in the rational solutions into our ansatz   and continue to find the polynomial solutions ( problem  pp ) ; for details see remark  [ rem : ratdetails ] .",
    "@xmath477\\txt{task : find a basis of\\\\ $ { \\mathbb{v}}={{\\rm v}({\\boldsymbol{f}},{{\\mathbb{h}}(t)})}$}\\ar[d]\\\\ * + [ f-:<3pt>]{\\txt{set up~\\eqref{equ : splitf } by polynomial division}}\\ar[d]&*+[f-:<3pt>]{\\txt{set up $ { \\boldsymbol{p'}}\\in{\\mathbb{h}}[t]^m$ by~\\eqref{equ : polyf}.}}\\ar[d]\\\\ * + [ f--]{\\txt{{{\\sf rp } } : find a basis $ r$ of $ { { \\rm v}({\\boldsymbol{h}},{{{{\\mathbb{h}}(t)}_{\\text{\\tiny(r)}}}})}$}}\\ar@{.>}|{r}@/_1.8pc/[dr]\\ar[dd]_{r=\\{\\}}\\ar[ru]|<(.3){r\\neq\\{\\}}&*+[f--]{\\txt{{{\\sf pp } } : find a basis $ p$ of $ { { \\rm v}({\\boldsymbol{p'}},{{\\mathbb{h}}[t]})}$. } } \\ar@{.>}_{p}[d]\\\\ & * + [ f.]{\\txt{combine $ r$ and $ p$ to a basis $ b$ of $ { \\mathbb{v}}$}}\\ar[d]\\\\ * + [ f-,]\\txt{return : $ \\{\\}$}&*+[f-,]\\txt{return $ b$ } } \\ ] ]    [ rem : ratdetails ] find a basis @xmath478 of @xmath474 ; note that @xmath479 .",
    "if @xmath480 , then @xmath481 by lemma  [ lemma : splitproblem ] . otherwise , define @xmath482 and @xmath483 .",
    "then we look for all @xmath484 and @xmath485 $ ] such that @xmath486 since @xmath487 and @xmath488 by construction , problem   is equivalent to looking for all @xmath484 and @xmath485 $ ] s.t.@xmath489 hence , set up @xmath490 where @xmath491^m$ ] and find a basis @xmath492 of @xmath493})}$ ] .",
    "note that @xmath494 , since there is the trivial solution @xmath495 ; define @xmath496 and @xmath497 .",
    "then with   it follows that @xmath498 thus , if we define @xmath499 and @xmath500 , we get a set of generators @xmath501 that spans a subspace of @xmath464 . by simple linear algebra arguments it follows that @xmath463 is a basis of @xmath244 .",
    "[ exp : truncatednaiverat ] consider the ordered @xmath175-field @xmath99 over @xmath502 with   and @xmath503 . by",
    "we have @xmath504 and @xmath505 . following the reduction of figure  [ fig : ratred ]",
    ", we need a basis @xmath506 of @xmath507 ; obviously @xmath508 .",
    "thus @xmath509 by  . in example  [ exp : truncatednaivepoly ] we will show that @xmath510 is a basis of @xmath511)})}$ ] . by remark  [ rem : ratdetails ]",
    "a basis of @xmath512 is @xmath513 .",
    "_ in  @xcite the reversed strategy was proposed : first consider the polynomial and afterwards the rational problem .",
    "related to problems  dot  and dot@xmath169 , the following remark is in place . in lemma  [ lemma : ratext ] we will show that the solutions of  rp  are independent of the type of extension that are needed to solve problems  dot , dot@xmath169 .",
    "thus , we will consider problem  rp  first .",
    "if there is no solution , we can stop ; see corollary  [ cor : polyratext ] .",
    "otherwise , we will attack problems  dot , dot  on @xmath514 which is usually simpler ( @xmath515 ) than @xmath516 .    the next lemma will be needed in section  [ sec : depthspeedup ] to solve problems  dot , dot@xmath169  efficiently .",
    "[ lemma : entriesinpolcase ] let @xmath461 be a @xmath3-extension of @xmath196 and @xmath465 .",
    "if @xmath208 occurs in @xmath246 , then the reduction in figure  [ fig : ratred ] can be applied so that @xmath517 occurs in @xmath514 .",
    "let @xmath208 occur in the @xmath383th position of @xmath246 .",
    "write @xmath518^n$ ] .",
    "then the @xmath383th entry in @xmath519 is zero .",
    "hence , we can take a basis @xmath506 for @xmath474 where the @xmath383th unit - vector is in @xmath506 . applying",
    "it follows that @xmath517 occurs in  @xmath514 .",
    "subproblem  rp  has been solved in  ( * ? ? ?",
    "* sections  3.4 , 3.5 ) .",
    "alternatively , this task can be accomplished by computing a basis @xmath520 of @xmath521 by using , e.g. , algorithm  @xcite which is based on results from  @xcite .",
    "namely , by  ( * ? ? ?",
    "1,2 ) it follows that @xmath522 hence a basis @xmath506 for @xmath474 can be derived by simple manipulation of the basis @xmath520 .",
    "+ we remark that both approaches can be solved algorithmically if @xmath196 is @xmath40-computable .      as in karr",
    "s reduction  @xcite we bound the degree of the polynomial solutions .",
    "[ lemma : degbound ] let @xmath461 be a @xmath3-extension of @xmath196 and let @xmath523^m$ ]",
    ". then @xmath524_b})}={{\\rm v}({\\boldsymbol{p'}},{{\\mathbb{h}}[t]})}$ ] for @xmath525    thus we set up @xmath526 and @xmath527^m_{r}$ ] and look for a basis @xmath528 of @xmath529_r})}$ ] .",
    "we will accomplish this task by solving instances of problem  pfdein @xmath196 ; see also  ( * ? ? ?",
    "12 ) or  ( * ? ? ?",
    "note that this is possible if @xmath196 is @xmath40-computable .",
    "if @xmath530 , we are already in the base case .",
    "otherwise , let @xmath531 .",
    "then we try to get all @xmath532_{r}$ ] and @xmath533 such that @xmath534 as follows .",
    "first , we derive the possible leading coefficients @xmath535 in @xmath196 , then we plug in the resulting solutions into @xmath534 and look for the remaining @xmath536 by recursion .",
    "the technical details are given in remark  [ rem : polytechnical ] , and a graphical illustration is presented in figure  [ fig : polyred ] : here the task of finding a basis of @xmath537 is reduced to finding a basis of the `` leading coefficients '' ( problem  cp ) and to finding a basis of the `` remaining coefficients '' @xmath538 .",
    "@xmath539\\txt{return $ b_r$}&*+[f=]{\\txt{task : find a basis $ b_r$ of\\\\ $ { \\mathbb{v}}_r:={{\\rm v}({\\boldsymbol{f_r}},{{\\mathbb{h}}[t]_r})}$.}}\\ar[d]&*+[f-,]\\txt{return\\\\ $ \\{{({0,\\dots,0,1})}\\}$}&*+[f-,]+<-1.3cm,0cm>\\txt{return $ \\tilde{b}_r$}\\\\ * + [ f.]\\txt{combine $ b_{r-1}$ and $ \\tilde{b}_r$\\\\ to get a basis $ b_r$ of $ { \\mathbb{v}}_{r}$.}\\ar@{.>}[u]&*+[f-:<3pt>]\\txt{set up",
    "$ { \\boldsymbol{\\tilde{f}_r}}$ by~\\eqref{equ : defineftilde}}\\ar[r]&*+[f--]\\txt{{{\\sf cp } } : find a basis $ \\tilde{b}_r$\\\\of $ { { \\rm v}({{({\\alpha^r,-1})}},{\\boldsymbol{\\tilde{f}_r}},{{\\mathbb{h}}})}$ } \\ar[ur]_<(0.5){r=0}\\ar@{.>}@/^2pc/[ll]_{\\tilde{b}_r}\\ar[u]^{r>0\\wedge\\tilde{b}_r=\\{\\}}\\ar[d]^{r>0\\wedge\\tilde{b}_r\\neq\\{\\}}\\\\ & * + [ f=]{\\txt{task : find a basis $ b_{r-1}$ of\\\\ $ { \\mathbb{v}}_{r-1}:={{\\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}[t]_{r-1}})}$.}}\\ar@{.>}@/^2pc/[lu]|<(.55){b_{r-1 } } & * + [ f-:<3pt>]\\txt{set up $ { \\boldsymbol{f_{r-1}}}$ by~\\eqref{equ : definefdeltam}}\\ar[l]\\\\ } \\ ] ]    [ rem : polytechnical ] the main task is to find a basis @xmath528 of @xmath540_r})}$ ] .",
    "first , define @xmath541 where @xmath542 . then find a basis @xmath543 of @xmath544 . if @xmath545 , then @xmath546 and @xmath547_{r-1}$ ] are the only choices , i.e. , @xmath548 . otherwise , if @xmath549 , define @xmath550 @xmath551 by construction , @xmath552_{r-1}^{\\lambda}$ ] .",
    "now we proceed as follows .",
    "find all @xmath553_{r-1}$ ] and @xmath554 such that @xmath555 which is equivalent to @xmath556 therefore the subtask is to find a basis @xmath557 of @xmath558_{r-1}})}$ ] ; note that @xmath559 , since @xmath495 .",
    "given @xmath560 and @xmath561 , a basis for @xmath540_{r}})}$ ] can be constructed as follows .",
    "define @xmath562 , @xmath563^{l}_{r-1}$ ] , @xmath564 , and @xmath565_r^l$ ] . then by   the set @xmath566 spans a subspace of @xmath567})}$ ] . by simple linear algebra arguments it follows that @xmath528 is a basis of @xmath537 .",
    "[ exp : truncatednaivepoly ] given the @xmath3-field @xmath350 over @xmath36 with @xmath568 and @xmath569 from example  [ exp : truncatednaiverat ] , we compute a basis of @xmath570})}$ ] as follows .",
    "we start the reduction of figure  [ fig : polyred ] with @xmath571 , see  , and @xmath572 .",
    "@xmath573 : : :    by   we get @xmath574 ; a basis    of @xmath575    is @xmath576 .",
    "@xmath577 : : :    we get    @xmath578    by   and    @xmath579    by  . by another reduction in @xmath51",
    "we compute the    basis @xmath580 of    @xmath581 . @xmath530 : : :    @xmath582 by  .",
    "clearly ,    @xmath583 is a basis of    @xmath584 .",
    "finally , we combine @xmath585 , @xmath586 and @xmath587 and get the basis @xmath588 , @xmath589 of @xmath590_1})}$ ] , @xmath591_2})}$ ] , respectively . thus @xmath592 is a basis of @xmath593})}$ ] .",
    "+ we that the summand @xmath594 of @xmath595 given in   occurs in @xmath596 .",
    "this observation is crucial for our refined summation algorithm ; see example  [ exp : truncatedfullpoly ] .",
    "[ rem : ratpolyred ] if @xmath530 , or if @xmath531 and @xmath45 is a @xmath43-extension ( @xmath597 ) , problem  cp  is nothing else than problem  pt  in the ground field @xmath196 .",
    "hence , we can apply again the reductions presented in the figures  [ fig : ratred ] and  [ fig : polyred ] to the subfield @xmath51 .",
    "more precisely , if @xmath181 is a @xmath3-extension of a @xmath40-computable @xmath64 , we reduce problem  pt  to pt  in the fields below whenever possible , and change to the more general situation  pfde  only when it is necessary .",
    "this strategy will be the basis to construct @xmath172-extensions in section  [ sec : constructdeltaext ] .",
    "the following lemmata are needed for our refined algorithms .",
    "lemma  [ lemma : singeextplde ] is immediate by construction ; it is used to prove corollary  [ cor : incremredref ] .",
    "lemma  [ lemma : entriesingroundfield ] is crucial in section  [ sec : depthspeedup ] .",
    "[ lemma : singeextplde ] let @xmath598 be a @xmath3-extension of @xmath14 with @xmath306 where @xmath599",
    ". set @xmath600 , let @xmath531 , @xmath601^m_r$ ] and @xmath602 with  .",
    "if the coefficients with the monomial @xmath603 in @xmath604_r})}$ ] are free of the @xmath605 , it suffices to take a basis of @xmath606 to get a basis of @xmath244 following the reduction in figure  [ fig : polyred ] .",
    "[ lemma : entriesingroundfield ] let @xmath461 be a @xmath3-extension of @xmath196 with @xmath607 and @xmath491^m$ ] .",
    "suppose we succeed in reducing the problem to the base case @xmath530 with @xmath608 .",
    "( 1 ) : :    the reduction can be applied s.t .",
    "all entries of    @xmath514 which are in    @xmath5 also occur in    @xmath609 .",
    "( 2 ) : :    moreover , if @xmath597 , we can guarantee that    @xmath610 occurs in @xmath609 .    *",
    "( 1 ) *  suppose that @xmath212 occurs in the @xmath383th position of @xmath514 .",
    "define @xmath611 by   and set @xmath612 . if @xmath530 , nothing has to be shown .",
    "otherwise , suppose that @xmath531 .",
    "since @xmath208 , the @xmath383th entry in @xmath613 , defined by  , is zero .",
    "hence we can choose a basis @xmath561 of @xmath614 where the @xmath383th unit - vector is in @xmath561 and all other elements of @xmath561 have zero in the @xmath383th position . with the corresponding @xmath615 and",
    "we get @xmath616 where @xmath517 pops up .",
    "this construction can be done for all such entries of @xmath514 which are in @xmath5 .",
    "if we continue with this refined reduction to the case @xmath609 , all @xmath5-entries of @xmath514 occur in @xmath609 .",
    "+ * ( 2 ) *  assume that @xmath45 is a @xmath43-extension .",
    "hence @xmath617 by  .",
    "suppose we are in the reduction for @xmath577 .",
    "since @xmath581 contains @xmath618 , we can choose a basis @xmath586 with @xmath619 .",
    "by construction of @xmath609 it follows that @xmath620 occurs in @xmath609 .",
    "we focus on the problem when extensions do not contribute to solutions of  pfde .",
    "[ lemma : ratext ] let @xmath461 be a @xmath3-extension of @xmath196 and @xmath621 be a @xmath3-ext .  of @xmath461 over @xmath51 .",
    "for @xmath467 , @xmath622    suppose we find an additional solution in a @xmath3-extension @xmath621 of @xmath461 over @xmath51 , i.e. , there is a @xmath623 such that @xmath140 depends on @xmath624 and @xmath625 for some @xmath470 .",
    "take such a solution and define @xmath626 .",
    "now reorder the extension to the @xmath3-extension @xmath627 of @xmath196 .",
    "with proposition  [ prop : propertiesinpisi].2 it follows that @xmath628 for some @xmath629 and @xmath630 .",
    "write @xmath631 with @xmath632 $ ] ; @xmath633 . then @xmath634 . since @xmath635 and @xmath636 are free of @xmath624 , @xmath637 , i.e. , @xmath638 .",
    "[ cor : polyratext ] let @xmath461 be a @xmath3-extension of @xmath196 and let @xmath621 be a @xmath3-extension of @xmath461 over @xmath51 .",
    "let @xmath639 and take @xmath464 and @xmath640 .",
    "write @xmath466 as in  .",
    "( 1 ) : :    if    @xmath641 ,    then    @xmath642 .",
    "( 2 ) : :    otherwise , define @xmath491^m$ ]    and @xmath643 by   and  .",
    "then    @xmath644 iff    @xmath524_b})}={{\\rm v}({\\boldsymbol{p'}},{{\\mathbb{h}}(x_1)\\dots(x_r)[t]_b})}.$ ]    if @xmath506 , @xmath645 are bases of    @xmath646    and    @xmath647_b})}$ ] ,    respectively , we get a basis of    @xmath648    as given in remark  [ rem : ratdetails ] .    by lemma  [ lemma : ratext ]",
    "we have @xmath649 , i.e. , @xmath506 is also a basis of @xmath650 .",
    "thus , if @xmath480 , then @xmath642 ; see fig .",
    "[ fig : ratred ] .",
    "this proves  * ( 1)*. otherwise , let @xmath514 and @xmath643 be as assumed .",
    "note that @xmath643 bounds the polynomial solutions in @xmath651 $ ] _ and _ @xmath652 $ ] by lemma  [ lemma : degbound ] .",
    "hence , if @xmath524_b})}={{\\rm v}({\\boldsymbol{p'}},{{\\mathbb{h}}(x_1)\\dots(x_e)[t]_b})}$ ] , then by remark  [ rem : ratdetails ] we get @xmath644 .",
    "conversely , if @xmath524_b})}\\subsetneq{{\\rm v}({\\boldsymbol{p'}},{{\\mathbb{h}}(x_1)\\dots(x_e)[t]_b})}$ ] , then @xmath653 by construction .",
    "this proves  * ( 2)*.    consequently , if one wants to find an extension with additional solutions , one has to focus on problem  cp ; see fig .",
    "[ fig : polyred ] . with lemma  [ lemma : noextforpi ]",
    "we can refine this observation in corollary  [ cor : incremredref ] .",
    "[ lemma : noextforpi ] let @xmath461 be a @xmath44-extension of @xmath196 and let @xmath621 be a @xmath3-extension of @xmath461 over @xmath51 . set @xmath654 .",
    "then for @xmath655 and @xmath531 , @xmath656    suppose that @xmath657 .",
    "then there are @xmath470 and @xmath658 for some @xmath659 such that @xmath660 .",
    "note : there is no @xmath661 with @xmath662 .",
    "( otherwise , @xmath663 .",
    "since @xmath664 , we get @xmath665 for @xmath666 .",
    "but , by reordering we get the @xmath44-extension @xmath667 of @xmath668 , a contradiction by theorem  [ thm : pisigma].2 . )",
    "thus we can apply lemma  [ lemma : karr ] : if @xmath334 is a @xmath44-extension with @xmath669 for some @xmath670 , @xmath671 for some @xmath280 and @xmath672 .",
    "hence , @xmath673 with @xmath674 . otherwise , if @xmath334 is a @xmath43-extension , @xmath675 . summarizing , @xmath676 for some @xmath677 .",
    "since @xmath678 is a @xmath44-extension of @xmath679 , this contradicts theorem  [ thm : pisigma].2 .",
    "[ cor : incremredref ] let @xmath461 be a @xmath3-extension of @xmath196 and take a @xmath3-extension @xmath680 of @xmath461 over @xmath51 where for @xmath681 we have @xmath682 or @xmath683 .",
    "let @xmath531 , @xmath684^m_r$ ] , and set @xmath685_r})}$ ] and @xmath686_r})}$ ] .",
    "define @xmath613 and @xmath616 as in   and  .",
    "( 1 ) @xmath687 : : :    if    @xmath688    and +    @xmath689_{r-1}})}={{\\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}[t]_{r-1}})}$ ] ,    then @xmath690 .",
    "+    given the basis @xmath557 of    @xmath689_{r-1}})}$ ]    and the basis @xmath691 of    @xmath692 ,    one gets a basis of @xmath693 as stated in    remark  [ rem : polytechnical ] .",
    "( 2 ) @xmath694 : : :    if    @xmath689_{r-1}})}={{\\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}[t]_{r-1}})}$ ] ,    then @xmath690 .",
    "given the basis    @xmath557 of    @xmath689_{r-1}})}$ ]    and the basis @xmath691 of    @xmath614 ,    one gets a basis of @xmath693 as stated in    remark  [ rem : polytechnical ] .    *",
    "( 1 ) *  @xmath45 is a @xmath43-extension : by prop .",
    "[ prop : propertiesinpisi].2 the leading coefficients with degree @xmath262 in the solutions of @xmath693 are free of @xmath695 .",
    "hence , by lemma  [ lemma : singeextplde ] it suffices to take a basis of @xmath692 to get a basis of @xmath693 following remark  [ rem : polytechnical ] .",
    "thus , if @xmath696_{r-1}})}={{\\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}(x_1)\\dots(x_l)(y_1)\\dots(y_k)[t]_{r-1}})}$ ] and @xmath688 , then @xmath644 by remark  [ rem : polytechnical ] . given @xmath557 , @xmath691 from above one gets a basis of @xmath693 .",
    "+ * ( 2 ) *  if @xmath697 , then @xmath698 by lemma  [ lemma : noextforpi ] .",
    "hence , if @xmath689_{r-1}})}={{\\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}[t]_{r-1}})}$ ] , @xmath644 by remark  [ rem : polytechnical ] . given the bases @xmath557 , @xmath691 as stated above , one gets a basis of @xmath693 .",
    "subsequently , we prove the following theorem which will establish result  [ res : depthconstruct ] in section  [ sec : mainproofs ] .    [ thm : extendforteleordered ]",
    "let @xmath14 be an ordered @xmath175-extension of @xmath64 and @xmath7 .",
    "then there is a @xmath43-extension @xmath37 of @xmath14 such that @xmath37 can be brought to an ordered @xmath175-extension of @xmath64 and such that there is a @xmath174 as in  .",
    "if @xmath64 is @xmath40-computable , such an @xmath37 and @xmath140 can be given explicitly .    in order to accomplish this task , we consider the following more general situation .",
    "[ def : completea ] let @xmath14 be a @xmath3-extension of @xmath64 and @xmath699 . then @xmath14 is _ @xmath700complete _ , if for any @xmath3-extension are @xmath43-extensions . ]",
    "@xmath701 of @xmath14 with extension depth @xmath702 we have @xmath703 .",
    "that is to say , we show the following theorem .    [ thm : algtheorema ] let @xmath14 be an ordered @xmath175-extension of @xmath64 , @xmath704 and @xmath699 . then there is a @xmath43-extension @xmath195 of @xmath14 which is @xmath700complete and which can be brought to an ordered @xmath175-extension of @xmath64 .",
    "if @xmath64 is @xmath40-computable , then such an @xmath195 and a basis of @xmath705 can be given explicitly .",
    "then theorem  [ thm : extendforteleordered ] is implied by the following lemma .",
    "[ lemma : basiccomplete ] let @xmath14 be a @xmath3-extension of @xmath64 and @xmath699 . if @xmath14 is @xmath706complete , then @xmath707 .",
    "suppose @xmath708 , i.e. , there is a @xmath470 such that there is no @xmath23 with @xmath709 .",
    "thus there is the @xmath43-extension @xmath170 of @xmath14 with @xmath171 and @xmath710 . hence @xmath14 is not @xmath706complete .",
    "namely , we conclude by theorem  [ thm : algtheorema ] that there is a @xmath43-extension @xmath195 of @xmath14 which is @xmath711complete and which can be brought to an ordered @xmath175-extension of @xmath64 .",
    "hence by lemma  [ lemma : basiccomplete ] there is a @xmath712 such that  .    in most applications",
    "one works with a @xmath3-field over @xmath109 , with @xmath70 for some @xmath713 . in this case",
    ", the following shortcut can be applied ; the proof is similar to prop .",
    "[ prop : twonestedext ] .",
    "[ lemma : shortcut2 ] let @xmath14 be a @xmath3-field over @xmath109 and @xmath699 .",
    "if @xmath714 for some @xmath23 , then @xmath14 is @xmath715complete .",
    "the proof of theorem  [ thm : algtheorema ] will be obtained by refining the reduction of section  [ sec : reduction ] .",
    "namely , let @xmath716 , let @xmath37 with @xmath290 be an ordered @xmath175-extension of @xmath64 where @xmath285 or @xmath717 , and let @xmath718 .",
    "then loosely speaking , we will obtain an @xmath700complete extension @xmath195 of @xmath37 by constructing step by step a tower of extensions , say @xmath719 , where @xmath720 is a @xmath172-extension of @xmath721 for @xmath722 . within this construction problem",
    "cp  in figure  [ fig : polyred ] will be refined to the following subproblem : we are given a vector @xmath723 with entries from @xmath724 , and we have to enrich @xmath724 by @xmath172-extensions to @xmath725 such that @xmath725 becomes @xmath726-compete . note that during this extension process it is crucial that @xmath727 forms a @xmath175-extension of @xmath720 for each @xmath722 . in order to get a grip on this situation , we introduce the following definition , which reduces to definition  [ def : completeb ] when @xmath285 .",
    "[ def : completeb ] let @xmath37 be a @xmath3-extension of @xmath14 with @xmath290 and @xmath699",
    ". then @xmath37 is _ @xmath728complete _ , if for any @xmath3-extension @xmath729 of @xmath37 over @xmath5 with extension depth @xmath702 we have @xmath703 .",
    "subsequently , we prove the following theorem which implies theorems  [ thm : algtheorema ] and  [ thm : extendforteleordered ] .",
    "[ thm : algtheoremb ] let @xmath704 and let @xmath50 be an ordered @xmath175-extension of @xmath64 ; if @xmath368 , @xmath730 .",
    "let @xmath699 .",
    "then there is a @xmath43-extension @xmath731 of @xmath50 with extension depth @xmath702 such that @xmath731 is @xmath732complete and such that @xmath731 is an ordered @xmath175-extension of @xmath64 .",
    "if @xmath64 is @xmath40-computable , such an @xmath731 and a basis of @xmath733 can be given explicitly .",
    "we will show theorem  [ thm : algtheoremb ] by induction on the depth @xmath734 .",
    "the base case @xmath735 is covered by lemma  [ lemma : shortcut].1 ; the proof of lemma  [ lemma : shortcut ] is immediate with lemma  [ lemma : basiccomplete ] .",
    "[ lemma : shortcut ] let @xmath37 be a @xmath3-extension of @xmath64 , let @xmath699 and set @xmath736 .",
    "then the following holds .",
    "( 1 ) : :    @xmath37 is    @xmath737complete .",
    "( 2 ) : :    if @xmath738 ( or    @xmath739 ,    @xmath37 is    @xmath740complete for all    @xmath741 . ( 3 ) : :    @xmath14 is    @xmath742complete    iff @xmath707 .    in the following",
    "let @xmath716 and let @xmath50 be an ordered @xmath175-extension of @xmath64 ; if @xmath368 , then @xmath730 .",
    "_ simplification i. _ note that it suffices to restrict to the case that @xmath390 for @xmath52 .",
    "otherwise , let @xmath743 be maximal such that @xmath744 .",
    "then we show that there exists such a @xmath43-extension @xmath745 of @xmath746 as required .",
    "finally , by proposition  [ prop : extensionontop ] we get the desired @xmath175-extension @xmath747 of @xmath64 .",
    "the induction step uses another induction on the number of extensions in @xmath5 with depth  @xmath734 .",
    "the base case and the induction step of this `` internal induction '' are considered in sections  [ sec : completephase ] and  [ sec : reductionphase ] , respectively .      the case @xmath748 ( including @xmath749 ) is covered by the following consideration .",
    "_ simplification ii .",
    "_ we can assume that @xmath750 by lemma  [ lemma : shortcut ] : if we find such a @xmath43-extension @xmath751 of @xmath50 which is @xmath752complete , then @xmath753 , and thus @xmath751 is @xmath754complete for any @xmath741 .",
    "with this preparation the following lemma gives the key idea .",
    "[ lemma : depthoptbysubprob ] let @xmath716 and let @xmath37 with @xmath755 be an ordered @xmath175-extension of @xmath14 with @xmath756 and @xmath390 for @xmath52 .",
    "let @xmath120 and suppose that @xmath37 is @xmath757complete .",
    "then any @xmath43-extension @xmath758 of @xmath37 with @xmath759 for @xmath760 is depth - optimal ; in particular , @xmath761 .    let @xmath758 be such a @xmath43-extension of @xmath37 with constant field @xmath36 .",
    "first note that @xmath761 for all @xmath380 : if there is an @xmath762 with @xmath763 and @xmath764 , then by reordering we get the @xmath43-extension @xmath765 of @xmath37 with extension depth @xmath766 ; a contradiction that @xmath37 is @xmath757complete .",
    "now suppose that @xmath767 , @xmath768 , is not depth - optimal with @xmath769 ; set @xmath770 .",
    "then there is a @xmath43-extension @xmath771 of @xmath196 with @xmath772 for @xmath773 such that there is a @xmath774 with @xmath775 .",
    "the @xmath43-extension @xmath776 of @xmath37 is obtained by reordering ( note that @xmath777 ) . by prop .",
    "[ prop : propertiesinpisi].2 , @xmath778 where @xmath294 , @xmath779 .",
    "hence @xmath780 for some @xmath470 , i.e. , @xmath37 is not @xmath757complete , a contradiction .",
    "namely , by our induction assumption we apply theorem  [ thm : algtheoremb ] and take a @xmath43-extension @xmath781 of @xmath50 with extension depth @xmath766 which is an ordered @xmath175-extension @xmath64 and which is @xmath757complete . then we adjoin step by step @xmath43-extensions such that for all @xmath782 there is a @xmath140 with @xmath775 as follows :    1 @xmath783 . for @xmath782",
    "do + 2 if @xmath784 and @xmath785 s.t .",
    "@xmath786 then adjoin the @xmath43-extension + @xmath787 of @xmath788 with @xmath789 ; i:=i+1 . fi + 3 od    finally , we get a @xmath43-extension , say @xmath790 of @xmath50 ; note that this extension process can be constructed explicitly if @xmath64 is @xmath40-computable .",
    "we complete the base case ( of the internal induction ) by the following arguments .",
    "@xmath791 : :    by lemma  [ lemma : depthoptbysubprob ]    @xmath790    is an ordered @xmath175-extension of    @xmath64 . by    prop .  [ prop : reorderequaldepth ] we get the    @xmath172-extension    @xmath792 of    @xmath196 with    @xmath793 .",
    "hence    @xmath792 is an    ordered @xmath175-extension of    @xmath64 .",
    "@xmath791 : :    since    @xmath794 ,    @xmath792 is    @xmath795complete    by lemma  [ lemma : shortcut ] ; if    @xmath64 is    @xmath40-computable , a basis of    @xmath796 can be    given  explicitly .",
    "[ exp : truncatedh ] take the ordered @xmath175-field @xmath797 over @xmath36 with @xmath798 and  ; let @xmath799 . by lemma",
    "[ lemma : shortcut2 ] @xmath797 is @xmath715complete . since there is no @xmath800 with @xmath801 , we get the @xmath172-extension @xmath802 of @xmath797 with @xmath803 by lemma  [ lemma : depthoptbysubprob ] . by proposition",
    "[ prop : reorderequaldepth ] we obtain the ordered @xmath175-field @xmath804 . by construction , @xmath805 , i.e. , @xmath806 .",
    "therefore @xmath804 is @xmath807complete .",
    "note : since @xmath808 with @xmath809 is an ordered @xmath175-field with @xmath810 , we get the ordered @xmath175-field @xmath811 by proposition  [ prop : extensionontop ] .",
    "[ exp : truncatedh ] take the ordered @xmath175-field @xmath170 with @xmath812 from example  [ exp : truncatedh ] ; let @xmath813 .",
    "first note that @xmath170 is @xmath814complete and that there is no @xmath815 with @xmath816 ; see example  [ exp : truncatedhsubcom ] .",
    "hence we can construct the @xmath172-extension @xmath817 of @xmath170 with @xmath818 ; by reordering we get the ordered @xmath175-field @xmath819 .",
    "a basis of @xmath820 is @xmath821 .",
    "clearly , @xmath819 is @xmath822complete .",
    "we suppose that @xmath823 , i.e. , @xmath824 where @xmath461 is a @xmath175-extension of @xmath196 with @xmath825 and @xmath826 . as above",
    ", @xmath827 is a @xmath3-extension of @xmath461 ; in particular with the simplification  i : if @xmath368 , then @xmath828 with the following definition and corollary  [ cor : polyratext ] we obtain corollary  [ cor : completeratcrit ] .",
    "let @xmath37 be a @xmath3-extension of @xmath196 with @xmath829 and @xmath830^n_r$ ]",
    ". then @xmath37 is _ @xmath831_r)$]complete _ , if for any @xmath3-extension @xmath729 of @xmath37 over @xmath5 with extension depth @xmath702 we have @xmath832_r})}={{\\rm v}({\\boldsymbol{f}},{{\\mathbb{h}}[t]_r})}$ ] .",
    "[ cor : completeratcrit ] let @xmath716 and let @xmath827 be a @xmath3-extension of @xmath196 with @xmath833 ; if @xmath368 , then  .",
    "let @xmath465 , and define @xmath519 and @xmath516 by  .",
    "let @xmath506 be a basis of @xmath474 and set @xmath464 .",
    "( 1 ) : :    if @xmath480 ,    @xmath827 is    @xmath834complete ;    @xmath835 . otherwise : ( 2 ) : :    take @xmath491^m , b$ ] by  ,  . if    @xmath836 is a    @xmath3-extension of    @xmath781 that is    @xmath837_b,{\\mathfrak{d}})$]-complete ,    @xmath836 is    @xmath838-complete .",
    "if @xmath645 is a basis of    @xmath839_b})}$ ] , a    basis of @xmath244 can be constructed by    remark  [ rem : ratdetails ] .",
    "[ exp : truncatedfullrat ] consider the ordered @xmath175-field @xmath350 with @xmath840 and  ; let @xmath503 .",
    "as in example  [ exp : truncatednaiverat ] we get @xmath504 , @xmath505 , @xmath841 , @xmath842 and @xmath573 . in examples  [ exp :",
    "truncatedfullpoly ] and  [ exp : truncatedfullpoly2 ] we will construct the @xmath43-extension @xmath843 of @xmath350 with @xmath844 and   where @xmath843 is an ordered @xmath175-field which is @xmath845_2)$]complete ; we obtain the basis @xmath846 of @xmath847_2)})}$ ] .",
    "hence @xmath843 is @xmath848-complete by corollary  [ cor : completeratcrit ] ; a basis of @xmath849 is @xmath645 .",
    "let @xmath617 and set @xmath850 and @xmath527^m_r$ ] . define @xmath613 as in  .",
    "if @xmath45 is a @xmath44-extension , we can apply corollary  [ cor : makecomplete ] ( see below ) and obtain the reduction @xmath851 .",
    "otherwise , if @xmath45 is a @xmath43-extension , the following preprocessing step is necessary . by the induction assumption",
    "we can apply theorem  [ thm : algtheoremb ] and get a @xmath43-extension of @xmath852 with extension depth @xmath766 which can be brought to an ordered @xmath175-extension @xmath853 of @xmath64 and which is @xmath854complete . by proposition  [ prop : extensionontop ]",
    "we can adjoin the extensions @xmath855 on top and get the ordered @xmath175-extension @xmath856 of @xmath64 .",
    "now we are ready apply corollary  [ cor : makecomplete ] ( @xmath857 is replaced by @xmath51 ) and proceed with the reduction @xmath851 .",
    "[ cor : makecomplete ] let @xmath716 and let @xmath827 be a @xmath3-extension of @xmath64 with @xmath833 ; if @xmath368 , then  .",
    "let @xmath836 be a @xmath3-extension of @xmath827 with extension depth @xmath702 .",
    "let @xmath531 and @xmath684^m_r$ ] , and define @xmath613 and @xmath616 as in   and  .",
    "( 1 ) @xmath687 : : :    if @xmath196 is    @xmath858complete    and in addition    @xmath836 is    @xmath859_{r-1},{\\mathfrak{d}})$]complete ,    then @xmath836 is    @xmath860_r,{\\mathfrak{d}})$]complete .",
    "+    if @xmath561 and @xmath557 are bases of    @xmath861 and    @xmath862_{r-1}})}$ ] ,    respectively , we get a basis of    @xmath863_r})}$ ]    following remark  [ rem : polytechnical ] .",
    "( 2 ) @xmath864 : : :    if @xmath836 is    @xmath859_{r-1},{\\mathfrak{d}})$]-complete ,    then it follows that    @xmath836 is    @xmath865_r,{\\mathfrak{d}})$]complete .",
    "if @xmath561 and @xmath557 are bases of    the solution spaces    @xmath614    and    @xmath862_{r-1}})}$ ] ,    respectively , we get a basis of    @xmath863_r})}$ ]    following remark  [ rem : polytechnical ] .",
    "let @xmath37 be a @xmath3-extension of @xmath866 with extension depth @xmath734 .",
    "reorder it to @xmath867 with @xmath868 for @xmath722 and @xmath869 for @xmath681",
    ". then by corollary  [ cor : incremredref ] @xmath870 .    summarizing , we obtain a reduction for @xmath871 , which can be illustrated in figure  [ fig : polydepthred ] .    @xmath872\\txt{return\\\\ $ ( { \\mathbb{h}}'_{r}(t)(t_1,\\dots , t_e),b_r)$}&*+[f=]{\\txt{task : find an $ ( { \\boldsymbol{f_r}},{\\mathfrak{d}},{\\mathbb{h}}'_{r})$--complete { $ \\sigma^*$}-extension\\\\ $ { ( { { \\mathbb{h}}'_r(t)(t_1)\\dots(t_e)},{\\sigma})}$ of $ { ( { { \\mathbb{h}}_{r}(t)(t_1)\\dots(t_e)},{\\sigma})}$ with\\\\ extension depth $ \\leq{\\mathfrak{d}}$ which is an ordered { $ \\pi\\sigma^{\\delta}$}-ex-\\\\ tension of $ { ( { { \\mathbb{g}}},{\\sigma})}$ ; find a basis $ b_r$ of $ { { \\rm v}({\\boldsymbol{f_r}},{{\\mathbb{h}}'_r[t]_r})}$.}}\\ar[d]&*+[f-,]\\txt{return\\\\ $ ( { \\mathbb{h}}_{r}(t)(t_1,\\dots , t_e)$,\\\\ $ \\{{(\\begin{smallmatrix}{0,\\dots,0,1}\\end{smallmatrix})}\\})$}\\\\ * + [ f.]\\txt{combine $ b_{r-1}$ , $ \\tilde{b}_r$\\\\ to a basis $ b_r$ of $ { \\mathbb{v}}_{r}$.}\\ar@{.>}[u]&*+[f-:<3pt>]\\txt{set $ { \\boldsymbol{\\tilde{f}_r}}$ by~\\eqref{equ : defineftilde}}\\ar[r]&*+[f--]\\txt{{\\bf solve problem~{{\\sf ce } } } } \\ar@{.>}@/^1.pc/[ll]|{\\tilde{b}_r}\\ar[u]^<(0.26){\\tilde{b}_r=\\{\\}}\\ar[d]^{\\tilde{b}_r\\neq\\{\\}}\\\\ & * + [ f=]{\\txt{task : find an $ ( { \\boldsymbol{f_{r-1}}},{\\mathfrak{d}},{\\mathbb{h}}'_{r-1})$--complete { $ \\sigma^*$}-extension\\\\ $ { ( { { \\mathbb{h}}'_{r-1}(t)(t_1)\\dots(t_e)},{\\sigma})}$ of $ { ( { { \\mathbb{h}}_{r-1}(t)(t_1)\\dots(t_e)},{\\sigma})}$ with\\\\ extension depth $ \\leq{\\mathfrak{d}}$ which is an ordered { $ \\pi\\sigma^{\\delta}$}-extension\\\\ of $ { ( { { \\mathbb{g}}},{\\sigma})}$ ; find a basis $ b_{r-1}$ of $ { { \\rm v}({\\boldsymbol{f_{r-1}}},{{\\mathbb{h}}'_{r-1}[t]_{r-1}})}$.}}\\ar@{.>}@/^2pc/[lu]|<(.33){b_{r-1 } } & * + [ f-:<3pt>]\\txt{set $ { \\boldsymbol{f_{r-1}}}$ by~\\eqref{equ : definefdeltam}}\\ar[l ] } \\ ] ]    [ exp : truncatedfullpoly ] we continue the reduction from example  [ exp : truncatedfullrat ] with @xmath573 .",
    "@xmath573 : : :    set    @xmath873 .    by   we",
    "get @xmath574 .",
    "clearly ,    @xmath196 is    @xmath874complete with the basis    @xmath576 of    @xmath575 .",
    "@xmath577 : : :    we get    @xmath875    by   and    @xmath579    by",
    ". we can construct the @xmath43-extension    @xmath595 with @xmath137 which gives the    ordered @xmath175-field    @xmath876 and which is    @xmath877complete ; a basis of    @xmath878    is @xmath879 ; see    example  [ exp : truncatedsub ] .",
    "this gives    @xmath880 .",
    "if @xmath530 , we need a @xmath43-extension @xmath881 of @xmath882 with extension depth @xmath702 which is an ordered @xmath175-extension of @xmath64 and which is @xmath883complete .",
    "[ exp : truncatedfullpoly2 ] we continue example  [ exp : truncatedfullpoly ] for the case @xmath530 . by ex .",
    "[ exp : truncatedh ] we get the ordered @xmath175-field @xmath843 with @xmath884 which is @xmath885complete ; a basis of @xmath886 is @xmath887 .",
    "hence we obtain the bases @xmath888 of @xmath889 and @xmath890 of @xmath891 .",
    "note that @xmath609 is a vector in @xmath892 which is a smaller field in the following sense : @xmath893 is a @xmath43-extension of @xmath196 with extension depth @xmath766 , but the extension @xmath45 with @xmath894 is eliminated ( it pops up in the tower @xmath895 above ) .",
    "eventually , all extensions with depth @xmath734 are eliminated , and we get a difference field with depth @xmath896 ; see section  [ sec : completephase ] .    [",
    "exp : truncatedsub ] we are given the ordered @xmath175-field @xmath897 over @xmath36 with @xmath898 and @xmath899 .",
    "following figure  [ fig : ratred ] we get @xmath842 .",
    "the degree bound is  @xmath900 by  .",
    "we start the reduction of figure  [ fig : polydepthred ] with @xmath577 , set @xmath901 , and get @xmath902 by  . a basis of @xmath903 is @xmath904",
    ". hence @xmath905 by  .",
    "now we need an ordered @xmath175-field @xmath906 which is a @xmath43-extension of @xmath897 with extension depth @xmath907 and which is @xmath908complete ; note that @xmath643 is eliminated . by example",
    "[ exp : truncatedh ] we get the @xmath175-field @xmath906 with @xmath909 and the basis @xmath910 of @xmath911 . completing the reduction",
    ", we get the basis @xmath912 of @xmath913 . by construction",
    ", @xmath906 is @xmath814complete .",
    "we sum up the construction from above : the derived @xmath172-extensions are defined by entries of some vectors @xmath723 which occur within the reduction process ; see section  [ sec : completephase ] .",
    "internally , those vectors @xmath723 are determined by the reduction presented in figure  [ fig : ratred ] ( the rational reduction ) and figure  [ fig : polydepthred ] ( the polynomial reduction ) . exploiting additional properties in difference fields , we can predict how the @xmath723 and therefore the derived @xmath172-extensions look like . the first result is needed in lemma  [ lemma : swapxy ] .    [ cor : nopiext ] let @xmath914 be a @xmath3-extension of @xmath64 with @xmath915 such that @xmath914 can be brought to an ordered @xmath175-extension of @xmath64 ; let @xmath699 and @xmath704 .",
    "then there is a @xmath43-extension of @xmath914 over @xmath5 with extension depth @xmath702 which can be brought to an ordered @xmath175-extension of @xmath64 and which is @xmath700complete .",
    "if @xmath916 , the corollary follows by theorem  [ thm : algtheoremb ] and proposition  [ prop : propertiesinpisi].2 .",
    "let @xmath917 .",
    "we refine the inductive proof in section  [ sec : constructdeltaext ] .",
    "suppose that the reduction holds for @xmath896 .",
    "as in section  [ sec : constructdeltaext ] we assume that @xmath50 is a @xmath3-extension of @xmath64 ; if @xmath368 , then  . now reorder @xmath914 to an ordered @xmath175-extension @xmath213 of @xmath64 .",
    "if @xmath918 , we construct a @xmath43-extension over @xmath5 as required ; see section  [ sec : completephase ] . if @xmath919 , set @xmath824 with @xmath825 as in section  [ sec : reductionphase ] with @xmath306 ; note that @xmath920 , since @xmath917 .",
    "then by corollary  [ cor : completeratcrit ] @xmath491^m$ ] .",
    "define @xmath643 by   and set @xmath612 , @xmath850 .",
    "now we apply the reduction as given in figure  [ fig : polydepthred ] .",
    "since @xmath613 is free of @xmath459 , we can apply the induction assumption : we can take as required a @xmath43-extension @xmath853 of @xmath921 where the new @xmath43-extensions do not depend on @xmath459 .",
    "note that @xmath922 is free of @xmath459 by proposition  [ prop : propertiesinpisi].2 ( if @xmath45 is a @xmath43-extension ) or lemma  [ lemma : noextforpi ] ( if @xmath45 is a @xmath44-extension ) . hence @xmath616 is free of @xmath459 .",
    "suppose we reach the base case ( after at most @xmath262 steps ) with @xmath923 , free of @xmath459 , where @xmath924 is a @xmath43-extension of @xmath827 which is free of @xmath459 .",
    "by the reduction of the extensions with depth  @xmath925 , the corollary follows .",
    "corollary  [ cor : polyext ] can be shown completely analogously by using the following lemma  [ lemma : polyclosure ] .",
    "[ lemma : polyclosure ] let @xmath781 be a polynomial @xmath3-extension of @xmath196 .",
    "for all @xmath926 $ ] , @xmath927 $ ] iff @xmath926 $ ] .",
    "[ cor : polyext ] let @xmath781 be an ordered @xmath175-extension of @xmath64 with @xmath928 and @xmath929 such that the @xmath172-extension @xmath781 of @xmath196 is polynomial ; + let @xmath930^n$ ] and @xmath704 .",
    "( 1 ) : :    then there is @xmath43-extension    @xmath931    of @xmath781 with    @xmath932 for @xmath380 and    @xmath933 which can be brought to an    ordered @xmath175-extension of    @xmath64 and which is    @xmath700complete . ( 2 ) : :    in particular , the extension    @xmath931    of @xmath866 is polynomial . ( 3 ) : :    we have    @xmath934[t_1,\\dots , t_e]$ ] . ( 4 ) : :    it can be constructed explicitly , if    @xmath64 is    @xmath40-computable .    consider the polynomial @xmath175-extension @xmath99 of @xmath86 with   and let @xmath935 $ ] . by corollary  [ cor : polyext ] our construction will always yield a @xmath43-extension @xmath37 of @xmath99 with @xmath936 where @xmath37 is a polynomial @xmath3-extension of @xmath86 ; in particular , any solution @xmath140 of   is in @xmath937[s_1,\\dots , s_r]$ ] .",
    "the building blocks from above can be summarized to algorithm  [ alg : multiplesolvesolutionspace ] .",
    "[ alg : multiplesolvesolutionspace ] solving problem  . `",
    "finddepthcompleteext`(@xmath938 ) an ordered @xmath175-extension @xmath50 of a @xmath40-computable @xmath64 , @xmath699 , @xmath704 . a @xmath43-extension @xmath731 of @xmath50 s.t .",
    "@xmath731 is an ordered + @xmath175-extension of @xmath64 and is @xmath732complete ; a basis of @xmath939 .",
    "[ alg : basecase ] if @xmath735 or . ]",
    "( @xmath940 and @xmath177 and @xmath70 for some @xmath713 ) then    compute a basis @xmath463 of @xmath941 ; return @xmath942 . fi    if @xmath393 and @xmath943 then    let @xmath743 be minimal such that @xmath744 .",
    "execute @xmath944=`finddepthcompleteext`(@xmath945 ) .",
    "return @xmath946 fi    if @xmath756 then @xmath947    [ alg : subext ] let . ] @xmath948=`finddepthcompleteext`(@xmath949 )    [ alg : extcommand]construct a @xmath43-extension @xmath792 of @xmath781 and a basis @xmath950 of + @xmath796 as in sec .",
    "[ sec : completephase ] .",
    "return @xmath951 fi    let @xmath952 with @xmath953 ; if @xmath368 , then  .",
    "[ alg : redphasestart ] follow the rational reduction as in figure  [ fig : ratred ] .",
    "let @xmath506 be a basis of @xmath954 .    if @xmath480 , then return @xmath955 fi    [ alg : subext2 ] take @xmath491^m$ ] , @xmath643 by   and  .",
    "apply the polynomial reduction and @xmath531 , ce  is solved by @xmath956:=`finddepthcompleteext`(@xmath957 . ] from figure  [ fig : polydepthred ] for @xmath958 .",
    "if the reduction stops earlier , return the corresponding result . otherwise , take @xmath609 with the computed ordered @xmath175-extension @xmath924 of @xmath64 .",
    "[ alg : keepdepth ] execute @xmath959:=`finddepthcompleteext`(@xmath960 ) .",
    "[ alg : redphaseend ] finish the reductions from figures  [ fig : polydepthred ] and  [ fig : ratred ] ; let @xmath950 be the basis of @xmath961",
    ".    return @xmath962 .",
    "now suppose that we remove lines  [ alg : subext ] and  [ alg : extcommand ] and return instead @xmath963 where @xmath463 is a basis of @xmath941",
    ". then this modified version of algorithm  [ alg : multiplesolvesolutionspace ] boils down to the recursive reduction presented in section  [ sec : reduction ] ; see remark  [ rem : ratpolyred ] . in other words ,",
    "the execution of lines  [ alg : subext ] and  [ alg : extcommand ] is the heart of our new algorithm . in the sequel",
    ", we will optimize this part further .",
    "for this task we will refine the reduction phase ( lines  [ alg : redphasestart][alg : redphaseend ] ) as follows .",
    "let @xmath50 be a @xmath3-extension of @xmath14 over @xmath5 with @xmath964 for @xmath52 and @xmath756 ; moreover let @xmath965 and let @xmath966 .",
    "note : by executing ` finddepthcompleteext`(@xmath967 ) it calls itself with depth @xmath734 in line  [ alg : keepdepth ] ; for all other recursive calls ( in line  [ alg : subext2 ] , see footnote ) we use depth @xmath766 .",
    "finally , if we enter the completion phase ( lines  [ alg : subext ] and  [ alg : extcommand ] ) with depth @xmath734 we can assume that @xmath246 contains all the elements @xmath54 for @xmath968 .",
    "this follows by lemmata  [ lemma : entriesingroundfield ] and  [ lemma : entriesinpolcase ] .",
    "given such a refined reduction , we can simplify the completion phase as follows .",
    "[ lemma : basismani ] let @xmath37 be a @xmath3-extension of @xmath14 over @xmath5 with @xmath290 such that @xmath964 for @xmath52 and @xmath756 ; let @xmath20 and @xmath965 .",
    "let @xmath699 where the the last @xmath969 entries are @xmath291 for @xmath968 .",
    "then :    ( 1 ) : :    if @xmath14 is    @xmath757complete , then    @xmath37 is    @xmath757complete .",
    "( 2 ) : :    if a basis of @xmath941    is given , by row - operations in    @xmath970 over    @xmath36 one can construct a    @xmath43-extension    @xmath758 of    @xmath37 s.t .",
    "@xmath758 is    @xmath971complete ;    a basis of    @xmath972    can be extracted with no extra cost .    * ( 1 ) * suppose that @xmath37 is not @xmath757complete .",
    "then there is a @xmath43-extension @xmath381 of @xmath14 with @xmath973 and @xmath470 such that @xmath974 . by proposition  [ prop : propertiesinpisi ] , @xmath975 for some @xmath976 and @xmath977 .",
    "thus there is @xmath978 such that @xmath979 and therefore @xmath14 is not @xmath757complete . + * ( 2 ) * suppose that the entries @xmath980 with @xmath968 occur in the last @xmath981 entries of @xmath246 ; in particular suppose that they are sorted in the order as the corresponding extensions @xmath855 occur in @xmath4 .",
    "take a basis of @xmath941 and apply row operations such that one gets a basis @xmath982 where @xmath983 is in reduced form . if @xmath615 is the identity matrix , @xmath37 is @xmath984complete by lemma  [ lemma : shortcut].2 and we are done .",
    "+ otherwise , let @xmath985 be the set of all integers @xmath986 such that the @xmath28th column does not have a corner element in @xmath615 .",
    "suppose that @xmath987 with @xmath988 .",
    "now consider the difference field @xmath758 extension of @xmath37 where @xmath989 is a rational function field and for all @xmath990 we have @xmath991 .",
    "we prove that this is a @xmath43-extension which is @xmath984complete .",
    "+ let @xmath992 be minimal such that @xmath993 is not a @xmath43-extension .",
    "then there is a @xmath994 with @xmath995 .",
    "hence , by proposition  [ prop : propertiesinpisi ] , @xmath996 with @xmath295,@xmath997 .",
    "hence @xmath998 for some @xmath999 ; thus @xmath1000 where 1 is at the @xmath1001th position .",
    "since @xmath615 is in row reduced form and the @xmath1001th position has no corner entry , we can not generate @xmath1002 ; a contradiction that @xmath463 is a basis . hence @xmath758 is a @xmath43-extension of @xmath37 .",
    "+ we get besides @xmath463 the solutions @xmath1003 where the @xmath900 is at the @xmath1001th position and @xmath1004 where the @xmath900 is at the @xmath1005th position .",
    "since the @xmath249 elements in @xmath1006 are lin.independent , @xmath758 is @xmath984complete by lemma  [ lemma : shortcut ] .",
    "clearly , @xmath1007 is a basis of @xmath972",
    ".    * crucial improvements . *",
    "the first consequence is that we can replace line  [ alg : subext ] by executing the function call @xmath1008 then by prop .",
    "[ prop : extensionontop ] we get an ordered @xmath175-extension @xmath781 of @xmath64 . moreover , by lemma  [ lemma : basismani].1 @xmath781 is complete , as needed in lemma  [ lemma : depthoptbysubprob ] .",
    "finally , by lemma  [ lemma : basismani].2 we simplify the construction of step  [ alg : extcommand ] as follows : by analyzing the basis @xmath463 of @xmath1009 , that has been computed already in step  [ alg : subext ] , we get a @xmath43-extension of @xmath1010 of @xmath64 which can be brought to an ordered @xmath175-extension @xmath1011 and which is @xmath1012complete ; we extract a basis of @xmath796 .",
    "[ exp : truncatedhsubcom ] in example  [ exp : truncatedh ] we claim that @xmath170 with @xmath812 is @xmath814complete where @xmath813 . note that @xmath1013 . hence by lemma  [ lemma : basismani].1 it suffices to show that @xmath14 is @xmath814complete . with our algorithm",
    "this can be easily checked ; during this check we get the basis @xmath1014 of @xmath941 . following the proof of lemma  [ lemma : basismani].2",
    ", @xmath817 is a @xmath43-extension of @xmath170 with @xmath1015 and we get the basis @xmath1016 of @xmath1017 . by lemma  [ lemma : depthoptbysubprob",
    "] @xmath1018 is depth - optimal .",
    "we emphasize that the modified algorithm differs from the reduction presented in section  [ sec : reduction ] ( which is similar to karr s algorithm ) by just analyzing the sub - results and by inserting extensions if necessary .",
    "_ in a nutshell , running our new algorithm which computes an appropriate @xmath175-extension and which outputs the corresponding solution to problem  pt  is not more expensive than choosing such a @xmath175-extension manually and solving problem  pt  with the recursive algorithm from section  [ sec : reduction ] ( or karr s algorithm ) . on the contrary , adjoining the extensions only when it is required during the reduction keeps the computations as simple and therefore as cheap as possible . _",
    "we need the following preparation to prove result  [ res : reordering ] .",
    "[ lemma : pinotneeded ] let @xmath914 be a @xmath44-extension of @xmath14 which can be brought to an ordered @xmath175-extension of @xmath64 .",
    "let @xmath7 and let @xmath37 be a @xmath43-extension of @xmath14 with extension depth @xmath734 and @xmath174 such that  .",
    "then there is a @xmath43-extension @xmath195 of @xmath14 with extension depth @xmath702 and @xmath1019 such that @xmath349 and @xmath1020 .",
    "write @xmath1021 with @xmath1022 . since we can bring @xmath914 to an ordered @xmath175-extension of @xmath64",
    ", we can apply corollary  [ cor : nopiext ] : there is a @xmath43-extension @xmath195 of @xmath914 over @xmath5 with @xmath1023 which can be brought to an ordered @xmath175-extension of @xmath64 and in which we have @xmath1019 s.t .",
    "@xmath349 ; by proposition  [ prop : propertiesinpisi].2 , @xmath1024 . by theorem  [ thm : constructsigmaextontopordered",
    "] we can take a @xmath43-extension @xmath1025 of @xmath195 and an @xmath1026-monomorphism @xmath1027 s.t .   for all @xmath1028 .",
    "note that @xmath1029 . since @xmath1030 , @xmath1031 for some @xmath1032",
    "therefore , @xmath1033 .",
    "since @xmath1034 for @xmath380 , @xmath1035 . by construction , @xmath1036 is a @xmath43-extension of @xmath14 with extension depth @xmath702 .",
    "[ lemma : swapxy ] let @xmath1037 be a @xmath175-extension of @xmath14 and suppose that @xmath366 and @xmath914 can be brought to ordered @xmath175-extensions of @xmath64 .",
    "then the @xmath3-extension @xmath1038 of  @xmath14 is depth - optimal .",
    "first we show that @xmath914 is a @xmath175-extension of @xmath14 .",
    "if @xmath459 is a @xmath44-extension , we are done .",
    "otherwise , let @xmath459 be a @xmath43-extension with @xmath441 which is not depth - optimal .",
    "hence , we can take a @xmath43-extension @xmath1039 of @xmath14 with extension depth @xmath173 and @xmath286 such that  .",
    "there are two cases .",
    "+ * case  1a : * @xmath277 is a @xmath44-extension . by corollary  [ cor : extendpioversigma ] @xmath1040 is a @xmath44-extension of @xmath1039 . by reordering ,",
    "@xmath1041 is a @xmath43-extension of @xmath366 .",
    "consequently , @xmath1037 is not a @xmath172-extension of @xmath366 , a contradiction .",
    "+ * case  1b : * @xmath277 is a @xmath43-extension .",
    "bring @xmath366 to an ordered @xmath175-extension @xmath195 of @xmath64 .",
    "hence , by thm .",
    "[ thm : constructsigmaextontopordered ] there is a @xmath43-extension @xmath37 of @xmath195 with extension depth @xmath173 and an @xmath5-monomorphism @xmath1042 with @xmath1043 .",
    "since @xmath1044 ( as fields ) , @xmath1037 is not a @xmath172-extension of @xmath366 ; a contradiction .",
    "second , we show that @xmath1038 is a @xmath175-extension of @xmath914 .",
    "if @xmath277 is a @xmath44-extension , we are done .",
    "otherwise , let @xmath277 be a @xmath43-extension .",
    "if @xmath459 is a @xmath43-extension and @xmath1045 , the statement follows by lemma  [ lemma : shiftsumtoleft ] and by proposition  [ prop : reorderequaldepth ] . what remains to consider are the cases that @xmath459 is a @xmath44-extension or that @xmath459 is a @xmath43-extension with @xmath1046 .",
    "now suppose that @xmath1038 is a @xmath43-extension of @xmath914 with @xmath1047 which is not depth - optimal .",
    "hence , we can take a @xmath43-extension @xmath1048 of @xmath914 with extension depth @xmath173 and @xmath1049 such that  . + * case  2a : * @xmath459 is a @xmath44-extension . by lemma  [ lemma : pinotneeded ] ,",
    "there is a @xmath43-extension @xmath195 of @xmath14 with extension depth @xmath173 and @xmath1019 such that @xmath349 ; hence @xmath366 is not a @xmath172-extension of @xmath14 , a contradiction . +",
    "* case  2b : * @xmath459 is a @xmath43-extension with @xmath1050 .",
    "reorder @xmath914 to a @xmath175-extension of @xmath64 . by theorem  [ thm : depthstableordered ] @xmath1051 .",
    "since @xmath1052 , @xmath140 is free of @xmath459 .",
    "hence , @xmath1039 is a @xmath43-extension of @xmath14 with @xmath286 such that  , and therefore @xmath366 is not a @xmath172-extension of @xmath14 ; a contradiction .",
    "@xmath791  * result  [ res : reordering ] . *",
    "if @xmath1053 nothing has to be shown .",
    "let @xmath1054 be a @xmath175-extension of @xmath64 with @xmath393 and suppose the theorem holds for @xmath393 extension .",
    "choose any possible reordering .",
    "if @xmath277 stays on top , by the induction assumption all extensions below are depth - optimal .",
    "@xmath277 remains depth - optimal , since the field below has not changed .",
    "this shows this case .",
    "otherwise , suppose that @xmath855 for some @xmath52 is on top .",
    "then we can reorder our field to the @xmath3-extension @xmath1055 of @xmath64 with @xmath1056 . by the induction assumption we can bring @xmath1057 and @xmath272 to ordered @xmath175-extensions of @xmath64 .",
    "thus , we can apply lemma  [ lemma : swapxy ] and get the @xmath175-extension @xmath1058 of @xmath64 . by the induction assumption",
    "we can bring the extensions in @xmath51 to the desired order without changing the @xmath175-property .",
    "@xmath791  * result  [ res : depthconstruct ] . *",
    "this follows by theorem  [ thm : extendforteleordered ] , corollary  [ cor : polyext ] and result  [ res : reordering ] . in particular , @xmath37 and @xmath174 can be computed as follows .",
    "1reorder @xmath14 to an ordered @xmath3-extension of @xmath64 .",
    "+ 2execute @xmath1059:=`finddepthcompleteext`(@xmath1060 ) and extract @xmath140 from @xmath463 s.t .  .",
    "@xmath791  * result  [ res : depthstable ] . *",
    "this is a direct consequence of theorem  [ thm : depthstableordered ] and result  [ res : reordering ] .    @xmath791  * result  [ res : constructsigmaextontop ] .",
    "* this follows by theorem  [ thm : constructsigmaextontopordered ] and result  [ res : reordering ] .    @xmath791  * result  [ res : extensiondepthstable ] .",
    "* this is implied by the following more general statement : there is a @xmath43-extension @xmath195 of @xmath37 and a @xmath175-extension @xmath422 of @xmath14 with an @xmath5-isomorphism @xmath1061 as in   for all @xmath1028 ; we can assume that @xmath4 is ordered .",
    "+ we prove this result by induction on the number of extensions in @xmath4 . for @xmath1062 , take @xmath1063 and @xmath1064 with @xmath1065 .",
    "now suppose we have shown the result for @xmath1066 with @xmath393 .",
    "i.e. , we are given a @xmath175-extension @xmath422 of @xmath14 , a @xmath43-extension @xmath195 of @xmath37 with @xmath1067 and an @xmath5-isomorphism @xmath1061 as in   for all @xmath1028 .",
    "let @xmath1068 be a @xmath3-extension of @xmath37 with @xmath1069 .",
    "case 1 : * suppose that @xmath45 is a @xmath44-extension with @xmath1070 .",
    "then by corollary  [ cor : extendpioversigma ] we can construct the @xmath44-extension @xmath282 of @xmath195 .",
    "moreover , by proposition  [ prop : homproperties].2 we can construct the @xmath44-extension @xmath1071 of @xmath422 with @xmath1072 and can extend the @xmath5-isomorphism @xmath205 to @xmath1073 with @xmath1074 . by reordering ,",
    "we get the @xmath43-extension @xmath1075 of @xmath1068 with the @xmath5-isomorphism @xmath1076 . as @xmath1077",
    ", it follows that @xmath1078 . hence   for all @xmath1079 . +",
    "* case 2 : * suppose that @xmath45 is a @xmath43-extension with @xmath1080 .",
    "we consider two subcases + * case 2a : * if there is a @xmath712 with @xmath1081 , let @xmath659 be minimal such that @xmath1082 . then by theorem  [ thm : pisigma].1 there is the @xmath43-extension @xmath1083 of @xmath1084 with @xmath1080 .",
    "furthermore , there is an @xmath1085-isomorphism @xmath1086 with @xmath1087 by prop .",
    "[ prop : homproperties].1 . by reordering",
    "we get the @xmath43-extension @xmath1088 of @xmath1068 .",
    "now we can construct a @xmath43-extension @xmath1025 of @xmath1088 with an @xmath1089-isomorphism @xmath1090 by prop .",
    "[ prop : homproperties].3 .",
    "hence we arrive at an @xmath5-isomorphism @xmath1091 with @xmath1092 .",
    "finally , observe that for all @xmath1028 we have @xmath1093 and @xmath1094 .",
    "since @xmath1095 , @xmath1096 by result  [ res : depthstable ] . with @xmath1097",
    "it follows that @xmath1098 . since @xmath1099 for all @xmath1028",
    ", we get @xmath1100 for all @xmath1079 . + * case 2b : * suppose that there is no @xmath712 with @xmath1081 . then there is no @xmath1101 with @xmath1102 . by result  [ res : depthconstruct ]",
    "there is a @xmath172-extension @xmath1103 of @xmath422 such that @xmath1102 for some @xmath1104 .",
    "moreover , by proposition  [ prop : homproperties].3 it follows that there is a @xmath43-extension @xmath1105 of @xmath195 and an @xmath5-isomorphism @xmath1106 where @xmath311 for all @xmath1028 .",
    "furthermore , we can construct the @xmath43-extension @xmath1107 of @xmath1105 with @xmath1080 by proposition  [ prop : propertiesinpisi].1 .",
    "finally , we can construct the @xmath5-isomorphism @xmath1108 with @xmath1109 for all @xmath1110 and @xmath1111 by proposition  [ prop : homproperties].1 . by reordering of @xmath1112",
    "we obtain the @xmath43-extension @xmath1025 of @xmath1068 with @xmath1113 . as above , @xmath1114 . since @xmath1115 for all @xmath1028 , @xmath1116 for all @xmath1028 .",
    "thus @xmath1116 for all @xmath1079 .",
    "+ note that this construction can be given explicitly , if @xmath64 is @xmath40-computable .",
    "@xmath791  * result  [ res : prodfree ] . *",
    "the induction base @xmath285 is obvious .",
    "suppose result  [ res : prodfree ] holds for @xmath359 extensions , and consider a @xmath3-extension @xmath1117 of @xmath14 with @xmath1118 s.t .  .",
    "then by assumption there is a @xmath172-extension @xmath1119 of @xmath376 with @xmath1120 such that @xmath1121 and @xmath349 .",
    "now we apply result  [ res : extensiondepthstable ] ( if @xmath327 is a @xmath43-extension ) and lemma  [ lemma : pinotneeded ] together with result  [ res : extensiondepthstable ] ( if @xmath327 is a @xmath44-extension ) : it follows that there is a @xmath172-extension @xmath195 of @xmath14 with @xmath1122 s.t .",
    "@xmath1123 and @xmath1124 .",
    "since @xmath1125 , we are done .",
    "@xmath791  * result  [ res : prodsumdef ] .",
    "* this is a direct consequence of results  [ res : depthconstruct ] and  [ res : prodfree ] .",
    "@xmath791  * result  [ res : dot ] . *",
    "let @xmath37 be such a @xmath172-extension of @xmath14 with @xmath20 ; take @xmath174 as in  .",
    "* ( 1 ) *  let @xmath196 be a @xmath3-extension of @xmath14 with @xmath348 s.t .  @xmath349 . by result  [ res : prodfree ]",
    "there is a @xmath172-extension @xmath195 of @xmath14 with @xmath1126 and @xmath1127 such that @xmath1128 and @xmath1129 . by result  [ res : constructsigmaextontop ]",
    "we get a @xmath172-extension @xmath312 of @xmath37 and an @xmath5-monomorphism @xmath1130 as in   for all @xmath1131 .",
    "hence @xmath1132 .",
    "since @xmath1133 and @xmath1134 , @xmath1135 for some @xmath1136 .",
    "hence @xmath1137 .",
    "+ * ( 2 ) *  suppose in addition that @xmath1138 and @xmath1139 . by the above considerations , @xmath1140 for @xmath380 and @xmath1135 for some @xmath1136 .",
    "hence there is an @xmath383 with @xmath380 s.t .",
    "@xmath1141 occurs in @xmath1142 .",
    "hence @xmath1143 .    @xmath791  * result  [ res : paratele ] . * by theorem",
    "[ thm : algtheorema ] we can take a @xmath172-extension @xmath37 of @xmath14 which is @xmath700complete .",
    "now let @xmath196 be any @xmath3-extension of @xmath14 with extension depth @xmath702 and @xmath374 , @xmath470 s.t .  .",
    "then by results  [ res : depthconstruct ] and  [ res : dot].1 we take a @xmath172-extension @xmath195 of @xmath14 with @xmath1019 such that @xmath1144 and @xmath1121 .",
    "moreover , by result  [ res : constructsigmaextontop ] we take a @xmath43-extension @xmath312 of @xmath37 with extension depth @xmath702 and an @xmath5-monomorphism @xmath1130 s.t .",
    "@xmath1145 for @xmath1146 . since @xmath1128 and @xmath37 is @xmath700complete , @xmath1147 ; in particular , @xmath1148 .",
    "@xmath37 can be constructed explicitly :    1reorder @xmath14 to an ordered @xmath3-extension of @xmath64 .",
    "+ 2@xmath1059:=`finddepthcompleteext`(@xmath1149 ) .",
    "we conclude our article by non - trivial applications from particle physics  @xcite . for the computations we used the summation package sigma  @xcite which contains in its inner core our new difference field theory .      in massive higher order calculations of feynman diagrams  @xcite the sum @xmath1150 where @xmath1151 denotes the beta function  @xcite , arose .",
    "it turns out that our refined creative telescoping method produces analogous to example  [ equ : creasol] a recurrence with minimal order : @xmath1152 note that standard creative telescoping produces a recurrence of order @xmath1153 only ; see  @xcite .",
    "given this optimal recurrence of order @xmath900 , the closed form denotes the riemann zeta function at @xmath28 ; e.g. , @xmath1154 . ]",
    "@xmath1155\\\\ &         -2\\tfrac{s_3(n)-\\zeta_3}{n+2 }          -\\tfrac{s_2(n)-\\zeta_2}{n+2}s_1(n )        + \\tfrac{2 + 7n+7n^2 + 5n^3+n^4 }                { n^3(n+1)^3(n+2)}s_1(n )            + 2\\tfrac{2 + 7n+9n^2 + 4n^3+n^4 }                { n^4(n+1)^3(n+2 ) } \\end{split}\\ ] ] can be read off immediately .",
    "+ we remark that in this example the algebraic object @xmath1156 occurs which can not be handled in a direct fashion in @xmath3-fields .",
    "as it turns out , our algorithmic framework can be slightly extended such that it works also in this case ; the technical details are omitted here .        as worked out in  @xcite sigma",
    "could reproduce the evaluation of a feynman diagram that occurred in  @xcite during the computation of the third - order qcd corrections to deep - inelastic scattering by photon exchange .",
    "more precisely , in mellin space the related feynman diagram could be expressed in terms of the recurrence        @xmath1160     \\underbrace{-\\frac{1}{n+1}\\sum_{k=4}^n(-1)^k\\underbrace{\\sum_{j=4}^k\\frac{(-1)^j ( 3 j-2)}{(j-2 ) ( j-1 ) j}\\overbrace{\\sum_{i=4}^j\\frac{f(i-3)}{(3 i-5 ) ( 3 i-2)}}^{=a(j)}}_{=b(k)}}_{=c(n)}$$\\end{gathered}\\ ] ]    for constants @xmath1161 .",
    "checking initial values shows that @xmath1162 , @xmath1163 and @xmath1164 .",
    "now the main task is to simplify   further . with , e.g. , karr s algorithm  @xcite the inner sum @xmath1165 can be eliminated and one gets a rather big expression for @xmath1165 in terms of single nested harmonic sums @xmath1166 . in other words ,",
    "we obtain an expression for   where the depth is reduced by one . to get a representation with optimal nested depth ,",
    "we execute our refined algorithm ; the result is an expression for @xmath1167 in terms of two nested sum expressions only : @xmath1168 note that the depth optimality of the sum representation is justified by results from  @xcite .    finally ,",
    "splitting these sums by partial fraction decomposition , we get the solution  @xcite : @xmath1169 & + s_2(n ) \\big(\\frac{4 s_3(n)}{n+1}-\\frac{4    \\zeta_3 } { n+1}\\big)+s_{-3}(n ) \\big(\\frac{8(1+(-1)^n)}{n^2    ( n+1)}-\\frac{4(2+(-1)^n ) s_{-2}(n)}{n+1}\\\\ & -\\frac{4    s_2(n)}{n+1}\\big)+s_{-2}(n ) \\big(\\frac{-12 \\zeta_3   n^3+(-1)^n    ( 8 - 8 n^3 \\zeta_3)+8}{n^3 ( n+1)}-\\frac{(4 + 8    ( -1)^n ) s_3(n)}{n+1}\\big)\\\\[-0.1 cm ] & + \\frac{8 s_{-3,-2}(n)}{n+1}+    \\frac{(4 - 4(-1)^n)s_{-3,2}(n)}{n+1}+\\frac{(4 + 12 ( -1)^n ) s_{-2,3}(n)}{n+1}-\\frac{8s_{2,3}(n)}{n+1}.\\end{aligned}\\ ] ] for further examples how one can simplify dalembertian solutions  @xcite with our algorithms see , e.g. , @xcite .",
    "we note that in the derived result no algebraic relations between the harmonic sums occur . in the next section",
    "we show how sigma  eliminates , or equivalently , finds such algebraic relations explicitly and efficiently .      during the calculation of feynman integrals",
    "harmonic sums arise frequently ; see , for instance , @xcite for further literature . in order to derive compact representations of such computations",
    ", one can use , e.g. , results from  @xcite where all relations of harmonic sums are classified in general and tabulated up to nested depth @xmath1170 .",
    "alternatively , we illustrate how this task can be handled efficiently in the general @xmath175-field setting .",
    "consider , e.g. , the sums @xmath1171 , @xmath1172 , @xmath1173 , @xmath1174 , @xmath1175 , @xmath1176 , @xmath1177 which are algebraically independent  except the last one : here the relation @xmath1178 pops up .",
    "with the naive reduction from section  [ sec : reduction ] , sigma  finds   by representing the sums in a @xmath3-field @xmath1179 where the depths of the @xmath43-extensions @xmath1180 are : @xmath1181 respectively . with a standard notebook ( 2.16 ghz )",
    "we needed @xmath1182 seconds to construct this @xmath3-field in order to get the relation  .    applying our new algorithms",
    ", we can represent the harmonic sums in a @xmath175-field with again @xmath1183 extensions , but this time the depths are @xmath1184 respectively .",
    "e.g. , the extensions correspond to the sum representations   and      note that the representation of @xmath1172 and @xmath1171 in the corresponding @xmath175-field has been carried out in details in example  [ exp : s12s21 ] . in total we needed 37 seconds ( instead of 772 seconds ) to construct the underlying @xmath175-field . based on this optimal @xmath175-field representation , by backwards transformation",
    "the relation   can be found automatically .",
    "p.  paule and a.  riese",
    ". a mathematica q - analogue of zeilberger s algorithm based on an algebraically motivated aproach to @xmath0-hypergeometric telescoping . in m.  ismail and m.  rahman , editors , _ special functions , q - series and related topics _ , volume  14 , pages 179210 .",
    "fields institute toronto , ams , 1997 ."
  ],
  "abstract_text": [
    "<S> in this article we present a refined summation theory based on karr s difference field approach . </S>",
    "<S> the resulting algorithms find sum representations with optimal nested depth . </S>",
    "<S> for instance , the algorithms have been applied successively to evaluate feynman integrals from perturbative quantum field theory .        </S>",
    "<S> symbolic summation , difference fields , nested depth </S>"
  ]
}