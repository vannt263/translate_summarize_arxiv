{
  "article_text": [
    "a key goal in the study of the milky way is mapping the dark matter distribution of the galaxy . locally this is achieved through dynamical measurements of the disc components @xcite , whilst tidal streams present a tantalising prospect for constraining the dark matter distribution on a more global scale . these long , filamentary structures are the remnants of satellites tidally disrupted by the milky way .",
    "the stars in the stream are now essentially orbiting freely in the galactic potential , but importantly they form a dynamically coherent structure , such that their properties are closely linked together . by inspecting the phase - space structure of tidal streams it should be possible to infer properties of the galactic potential , and , in particular , the dark matter distribution .",
    "many methods have been proposed to achieve this .",
    "the simplest , and therefore most fruitful to - date , are orbit - fitting techniques @xcite .",
    "several authors have acknowledged the problems with simply fitting a stream with a single orbit @xcite .",
    "therefore , much work has been done on constructing methods for recovering the potential without assuming the stream delineates an orbit .",
    "one group of methods seeks the potential which minimises the spread in the integrals of motion @xcite .",
    "others allow for the expected range of orbits present in a stream given the progenitor properties @xcite .",
    "the dynamics of tidal streams are very simply expressed in angle - action coordinates @xcite denoted as @xmath0 throughout the paper . in @xcite",
    "we demonstrated the power of using the frequencies and angles of the stream to construct a measure of the goodness of fit of the potential .",
    "the frequencies , @xmath1 , are the derivatives of the hamiltonian , @xmath2 , with respect to the actions i.e. @xmath3 .",
    "the best potential was deemed the one in which the angle and frequency distributions are aligned .",
    "this method suffered several drawbacks : we were doing the inference in model space , not the data space ; it was difficult to assess the errors in the obtained potential parameters ; it was awkward to handle errors in the data , and the method did not behave well for large errors .",
    "data for tidal streams have large errors and are expected to be contaminated with non - stream members .",
    "streams lie at large distances from the sun , far out in the halo . as such",
    ", the distance uncertainties can be significant , and small proper motion errors translate into large transverse velocity errors .",
    "for many streams we do nt have full 6d data . additionally , a stream is identified as a filament in the observable space  often @xmath4 and @xmath5 .",
    "stream members are then extracted by cutting appropriately in these coordinates , and cleaning up by using the additional observables .",
    "this process obviously introduces many outliers to the stream data , which are perhaps just members of a smoother background halo , whilst also potentially throwing out stars which _ are _ members of the stream .",
    "this state of affairs leads us to analyse the data by constructing probabilistic models that correctly handle large errors , missing data , and contaminants .",
    "such an approach is much more robust than previous efforts , and lends itself perfectly to being combined with other independent measurements of the galactic potential .",
    "here we present a probabilistic model for tidal streams that may be used to infer the properties of the galactic potential .",
    "the model is expressed in the space of observables , but relies heavily on the expected structure of streams in angle - action space . in section  [ formalism ]",
    "we motivate our choice of model by considering an idealised case of a gaussian structure in angle - action space evolving in time . in section  [ model ]",
    "we use these insights to write down a practical model for the stream , and discuss how it may be used to infer properties of the galactic potential . in section  [ tests ] we infer the parameters of a simple two - parameter potential from mock stream observations using our model . in section  [ discussion ]",
    "we discuss proposed improvements to the approach taken in this paper .",
    "given a set of observations , @xmath6 , of @xmath7 stars believed to be members of a stream , what can we infer about the galactic potential ? for star @xmath8 we have a 6d set of galactic coordinates @xmath9 with associated errors described by the covariance matrix @xmath10 .",
    "note that we can fit any missing data into this formalism by taking the associated error with the data point to be infinite .",
    "given the data we want to know the posterior distribution of the potential , @xmath11 , given by @xmath12 . from bayes",
    "theorem we have @xmath13 where @xmath14 is the prior on the potential , and the evidence @xmath15 is not important for the present exercise .",
    "we wish to evaluate the likelihood @xmath16 .",
    "the probability of the data given the potential is related to the properties of the stream progenitor , @xmath17 .",
    "@xmath17 contains information about the current phase - space coordinates of the progenitor ( i.e. the progenitor s actions , @xmath18 , frequencies , @xmath19 , and angles , @xmath20 ) , as well as the size ( and internal properties ) of the progenitor .",
    "therefore , we write @xmath21 where @xmath22 the jacobian factor is given by @xmath23 and the ( @xmath24 ) coordinates are related to the galactic coordinates in the usual way .",
    "we want to work with actions , angles and frequencies . throughout the paper",
    "we use the stckel - fitting algorithm presented in @xcite to estimate these quantities .",
    "this algorithm fits a stckel potential to the region of the potential an orbit probes , and estimates the actions , angles and frequencies in the true potential as those in the best - fitting stckel potential .",
    "therefore , we write @xmath25 where the angles and frequencies are related to ( @xmath24 ) via the potential @xmath11 using the stckel - fitting approximation and the jacobian is given by @xmath26 where we have used the fact that ( @xmath27 ) are canonical coordinates , such that the phase - space volume is conserved under the transformation , and introduced the hessian matrix @xmath28 defined as @xmath29 this matrix can be calculated analytically in a stckel potential , so we extend the stckel - fitting algorithm of @xcite to estimate @xmath28 .",
    "we give details of this in the appendix .",
    "we proceed by splitting @xmath30 into two components @xmath31 to proceed further we must consider what we know about stream formation in angle - action space @xcite . assuming the spread in actions in the stream is small @xcite , for each star in the stream we have @xmath32 where @xmath33 is the time since the particle was stripped from the progenitor and @xmath34 is the separation between the @xmath8^th^ particle and the progenitor when the particle is released .",
    "@xmath35 is the hessian from equation   evaluated at the progenitor actions , @xmath18 .    to motivate our choice of model we begin by assuming that @xmath36 follows an isotropic normal distribution such that @xmath37 where @xmath38 gives the spread of the action distribution",
    "this is related to the progenitor mass , @xmath39 , by @xmath40 @xcite .",
    "such a simple model for the action distribution is unrealistic @xcite but our understanding of this simplistic model will aid in the construction of a more realistic model .",
    "similarly we assume that @xmath34 is distributed as an isotropic gaussian such that @xmath41 this gaussian model for a stream in actions and initial angles was studied by @xcite . from equation   the frequency",
    "is linearly related to the actions via the hessian , @xmath35 , so we can write down the distribution for the frequencies as @xmath42 where as the spread in actions is small we have approximated the jacobian by its value at the progenitor actions .",
    "this distribution is a multivariate normal distribution with principal axes along the principal eigenvectors of @xmath35 and with width given by the corresponding eigenvalues .",
    "@xmath35 is a symmetric matrix so has real eigenvalues and orthogonal eigenvectors .",
    "note here that for long thin streams to form @xmath35 has one eigenvalue much greater than the other two . in @xcite",
    "we demonstrated that in a realistic galactic potential this condition was satisfied for a large volume of action space .",
    "therefore we write @xmath43 where @xmath44 and @xmath45 are the eigenvalues and eigenvectors of @xmath46 , and we have @xmath47 .",
    "therefore we find that @xmath48 the distribution of frequencies is 2d gaussian perpendicular to a straight line in frequency space defined by @xmath49 . in the simple model presented here",
    "the distribution along @xmath49 is also gaussian .",
    "however , we will later adopt a superior distribution along @xmath49 which better reflects the stream distribution .",
    "next we address the angle distribution .",
    "the angles depend upon the additional variables , @xmath33 and @xmath34 .",
    "therefore , we write @xmath50 given a time since stripping , a frequency separation , and an initial angle separation , the present angle separation is completely determined by equation   so @xmath51 substituting this and equation   into equation   and performing the integral over @xmath34 using the @xmath52-function we have that @xmath53 now we rearrange the argument of the exponential as @xmath54 and note that",
    "@xmath55 so @xmath56 and @xmath57 therefore , equation   becomes @xmath58 the first part is a 2d gaussian perpendicular to the eigenvector @xmath49 ( as with the frequencies ) whilst the second part depends on when the particles were stripped from the progenitor and only affects the angle distribution along the vector @xmath49 i.e. ( @xmath59 ) . if we assume that @xmath60 is uniform ( see below for discussion ) and @xmath61 ( i.e. the particle was stripped long enough ago that the time part of equation   dominates the initial angle separation from the progenitor  this is an assumption we made in @xcite ) , we may perform the @xmath33 integral to find @xmath62 where the condition ensures that the stripping time for each stream member is positive , and less than some maximum stripping time , @xmath63 .",
    "this expression demonstrates explicitly that the distribution perpendicular to @xmath49 is independent of the distribution along @xmath49 . in conclusion , in this model both the angle and frequency distributions are highly elongated along the vector @xmath49 .",
    "this validates the procedure followed in @xcite .",
    "the assumption of a uniform stripping - time distribution , @xmath60 , does not well model the highly - concentrated stripping events around pericentric passage observed in n - body simulations of clusters on eccentric orbits .",
    "however , as shown in equation   the exact form adopted for @xmath60 only affects the density of particles along the stream i.e. the structure of the angle distribution along @xmath64 . for diagnosis of the galactic potential and mass distribution",
    "we are interested in the shape of the stream , so the real diagnostic power comes from the clumping in frequency space and the alignment of the frequency and angle distributions .",
    "our simple assumption of uniform stripping times should not affect the recovery of the potential parameters significantly .",
    "we will see in ",
    "[ tests ] that @xmath60 for a stream generated from an n - body simulation is not uniform . however , the potential parameters are recovered successfully using this stream data when the assumption of a uniform stripping - time distribution is made .",
    "in the formalism of the previous section we made several assumptions that , while useful for illustrative purposes , we would like to relax . the assumption of isotropic @xmath65 distribution is not valid as evidenced in @xcite . for a general action distribution",
    "we would still expect a highly anisotropic frequency distribution but the principal eigenvector of this distribution will not be that of the hessian matrix @xmath28 , but some other vector @xmath64 , with vectors @xmath66 and @xmath67 perpendicular to this .",
    "the intricacies of the action distribution will be reflected in the frequency distribution along the vector @xmath64 .",
    "additionally the angle distribution will also be highly elongated along this direction @xmath64 .",
    "analogous to a combination of equation   and we write @xmath68 \\\\        & \\times\\frac{k_\\omega(\\boldsymbol{\\omega}_i)}{2\\pi w^2}\\exp\\big[-\\sum_{j=1,2}\\frac{1}{2w^2}(\\boldsymbol{\\omega}_i\\cdot\\hat{\\boldsymbol{d}}_j-\\omega_j)^2\\big ] , \\end{split } \\label{pfreqangfinal}\\ ] ] where the functions @xmath69 define the stream distribution along the vector @xmath64 in the angle or frequency space .",
    "the quantities @xmath70 and @xmath71 are the widths perpendicular to this vector in angle and frequency space , respectively .",
    "note we have assumed the stream is isotropically distributed perpendicular to the vector @xmath64 . @xmath72 and @xmath73 are related to the present frequency and angle coordinates of the progenitor .",
    "we define the angles @xmath74 and @xmath75 such that @xmath76 and we choose @xmath77 note this choice of vectors perpendicular to @xmath64 is arbitrary .",
    "we have set the distribution perpendicular to @xmath64 to be isotropic so our choice of vectors is unimportant .",
    "we now specify the functions @xmath69 defining the stream distribution along the vector @xmath64 . in frequency space",
    "the distribution along @xmath64 consists of two separated peaks corresponding to the leading and trailing tails of the stream ( see next section ) . for simplicity",
    "we assume that each of these peaks is gaussian .",
    "the angle distribution depends upon both the frequency distribution and the distribution of stripping times . as in equation",
    ", we make the simple first - order assumption of a uniform stripping - time distribution such that the distribution in angle space along the stream given a frequency separation is also uniform between @xmath78 and some maximum stripping time , @xmath63 .",
    "therefore , we write @xmath79,\\\\ & k_\\theta(\\boldsymbol{\\theta}_i|\\boldsymbol{\\omega}_i ) =   \\begin{cases } \\frac{1}{|\\boldsymbol{\\omega}_i\\cdot\\hat{\\boldsymbol{n}}-\\omega_0|t_{\\rm max } } , & \\text{if } 0<\\frac{(\\boldsymbol{\\theta}_i\\cdot\\hat{\\boldsymbol{n}}-\\gamma_0)}{(\\boldsymbol{\\omega}_i\\cdot\\hat{\\boldsymbol{n}}-\\omega_0)}<t_{\\rm max } , \\\\      0 ,               & \\text{otherwise}. \\end{cases } \\end{split}\\ ] ] @xmath80 gives the separation between the gaussian peaks along @xmath64 in frequency space .",
    "when equation   is combined with equation   and we have completely specified our model . given a set of 6d stream data with associated errors we can assess the likelihood of a given potential by evaluating the integral of equation  .",
    "it is defined by 13 progenitor parameters given by @xmath81 and @xmath82 potential parameters .",
    "we sample from the posterior using markov chain monte carlo .",
    "we use an affine - invariant sampler implemented in the _ emcee _ package from @xcite .",
    "for each of the following tests we use a group of @xmath83 walkers , and vary the nuisance parameters @xmath17 as well as the potential parameters . for all scale parameters ( i.e. @xmath84 )",
    "we use a logarithmic flat prior , whilst for the other parameters we use uniform flat priors .    to perform the integral over the errors in the calculation of the likelihood we use the vegas monte carlo integration algorithm @xcite implemented in the gnu science library @xcite .",
    "our stream model is typically very narrow whilst the error distribution for each observable coordinate can be very broad .",
    "therefore there is a very small region of the 4d integrand which has any support . using an adaptive integration scheme such as",
    "vegas means we can rapidly focus on this small region .",
    "we test the above procedure using particles taken from a stream simulation .",
    "the potential we work with is the two - parameter ( @xmath85 ) logarithmic potential given by @xmath86 the two parameters of this potential are @xmath87 and @xmath88 .",
    "we set @xmath89 and @xmath90 for the simulation .",
    "we place a cluster at the apocentre of the orbit shown in fig .",
    "[ orbit ] .",
    "this orbit was chosen due to its similarity to the orbit of the gd-1 stream @xcite .",
    "the orbit has initial conditions @xmath91 and @xmath92 where positive @xmath93 is towards the galactic centre and positive @xmath94 is in the direction of the galactic rotation at the sun .",
    "we seed the simulation with @xmath95 particles drawn from a @xmath96 king profile with the ratio of central potential to squared - velocity parameter , @xmath97 , a tidal limiting radius , @xmath98 , and a king core radius of @xmath99 .",
    "we evolve the simulation for @xmath100 ( until just after @xmath101^th^ pericentre passage of the progenitor ) using the code gyrfalcon @xcite .",
    "we take the resulting distribution of particles , remove the progenitor remnant with a spatial cut , and rotate the coordinate frame such that the sun is placed at the same azimuthal angle as the progenitor . from the resulting particles we randomly select @xmath102 particles that lie in the range @xmath103 .",
    "the chosen sample of particles are shown in fig .",
    "[ zoominorbit ] and fig .",
    "[ galcoords ] . for the tests shown below",
    "we include the observational errors by scattering the observed coordinates by the appropriate gaussian errors .",
    "@xmath104{fig1}\\ ] ]    @xmath105{fig2}\\ ] ]    @xmath106{fig3}\\ ] ]    in fig .",
    "[ model ] we plot the angles and frequencies in the correct potential , along with a cross - section through the model specified in equation  .",
    "the parameters of the model were chosen as those that maximised the likelihood in the correct potential .",
    "we see that in the correct potential the angle and frequency structure of the stream takes on a simple linear distribution . in fig .",
    "[ distsperp ] we plot the projections of the frequency histograms along the vectors @xmath64 , @xmath66 and @xmath67 for all particles in the stream from the simulation .",
    "we see that the distribution perpendicular to @xmath64 is approximately gaussian .",
    "the distribution along @xmath64 consists of two peaks consisting of the leading and trailing tail .",
    "each peak is skewed such that there is a longer tail towards larger values of @xmath107 .",
    "the structure of these peaks was discussed by @xcite .",
    "our model assumes a uniform stripping - time distribution . in figure  [ releasetimes ]",
    "we plot the time since release for the particles in the stream estimated as @xmath108 found in the true potential .",
    "we see that the distribution is peaked around pericentric passage with slightly more particles being stripped at later times as the cluster mass decreases .",
    "if the stream has undergone several stripping events then , if we average on a timescale comparable to the radial period , the distribution of stripping times is approximately uniform . as mentioned previously , we expect the assumption of a uniform stripping - time distribution to be appropriate for measuring the galactic potential , but more detailed modelling is required if we wish to reproduce the density distribution along the stream .",
    "by only sampling a portion of the stream track on the sky we have limited the range of available angles of the stream particles , but we expect that the range of frequencies sampled is fair",
    ". we will miss some high frequency separations which are stripped earliest .",
    "in this situation the @xmath63 parameter tells us about the time since the first of the observed particles were stripped ( @xmath109 ) .",
    "@xmath110{fig4}\\ ] ]    @xmath111{fig5}\\ ] ]    @xmath112{fig6}\\ ] ]      we test the above method by considering a dataset where each of our stream particles has full 6d data , @xmath113 .",
    "we first demonstrate that the method works for error - free data . in figure  [ errfree ]",
    "we show the posterior distributions of the potential parameters .",
    "the correct potential is recovered with @xmath114 and @xmath115 errors in @xmath87 and @xmath88 respectively .",
    "next , we consider an _ optimistic _",
    "dataset where we assume each of the stars is an rr lyrae observed by spitzer @xcite .",
    "we assume that the covariance matrix is diagonal and identical for all data such that @xmath116 .",
    "we adopt @xmath117 distance errors ( @xmath118 ) , @xmath119 line - of - sight velocity errors ( @xmath120 ) , and @xmath121 proper motion errors ( @xmath122 ) .",
    "such a dataset is unrealistic for such a low mass stream .",
    "however , it is suitable for demonstrating the method .",
    "we fix the parameters @xmath123 , @xmath124 and @xmath125 , and let the others vary as before .",
    "this prior essentially sets the mass of the cluster .",
    "the posterior distribution of the recovered potential parameters is shown in figure  [ vegas ] .",
    "we recover the correct potential parameters as @xmath126 and @xmath127 approximating the posterior as an uncorrelated gaussian .",
    "@xmath128{fig7}\\ ] ]    @xmath129{fig8}\\ ] ]    @xmath130{fig9}\\ ] ]    @xmath128{fig10}\\ ] ]    @xmath131{fig11}\\ ] ]      stream data are inevitably contaminated with stars that are not associated with the stream .",
    "many authors attempt to remove these outliers by performing cuts in the observable space .",
    "however , it is much better to model the outliers . to include @xmath132 outliers in our test",
    "we randomly select @xmath132 stars from our simulation sample .",
    "we use the @xmath4 and @xmath5 values of these @xmath132 stars for our outlier stars . for each star",
    "we sample a distance , @xmath133 , from a uniform distribution between @xmath134 and @xmath135 .",
    "we convert the tuple @xmath136 to a cartesian position , @xmath137 . at this position",
    "@xmath137 we draw a set of velocities @xmath138 from an isothermal distribution function given by @xmath139 with dispersion @xmath140 .",
    "in our model we assume that the likelihood of a star at angle - frequency coordinates @xmath141 is given by @xmath142 where @xmath143 is the likelihood given it is a member of the stream as outlined above , and @xmath144 is the likelihood given that it is not a member of the stream ( either a member of a smooth background population or another structure ) .",
    "@xmath145 is the probability of being an outlier , which is given a logarithmic uniform prior .",
    "we choose to specify the outlier model in angle - frequency space as it is simpler to normalize in these coordinates , and we are less sensitive to systematics arising from the stckel approximation .",
    "we set @xmath144 to be uniform in both the angle and frequency space , such that @xmath146 with @xmath147 .",
    "this model is clearly simplistic , and we are not correctly accounting for selection effects in the angles due to observing stars in some region of the galaxy .    to our @xmath102-particle stream dataset",
    "we add @xmath148 outliers from our halo model , such that @xmath149 , and consider the simple case where we have an error - free dataset .",
    "the input data - set is shown in fig .",
    "[ galcoords_outlier ] and the resulting posterior distributions for the potential parameters are given in fig .",
    "[ errfreeoutlier ] . in fig .",
    "[ outlier_frac ] we show the posterior distribution for the outlier fraction .",
    "it peaks nicely around the input outlier fraction , but has fairly large scatter around this value .",
    "this is probably due to the simplistic nature of the background model , but also , as we can see in fig .",
    "[ galcoords_outlier ] , there is significant overlap in observable space between the stream and outlier distributions .",
    "further information such as metallicities would potentially provide a simpler way to disentangle the stream from the background .",
    "the formalism presented in this paper provides the first steps towards constraining the potential of the galaxy from a generative stream model expressed in angle - frequency space .",
    "through the course of developing the necessary machinery it has become apparent that many improvements can be made .",
    "these are as follows :    \\(i ) the model for a cold stream is very narrow , whilst the error distribution for the observational quantities is expected to be large .",
    "the convolution of the error and model distributions only has support over a very narrow range in each observable coordinate .",
    "here we have performed the integration using the sophisticated monte - carlo integration method ( vegas ) to concentrate rapidly on this small region . however , a more efficient scheme would be full forward modelling . to do this",
    "we would perform the monte carlo integration by sampling ` true ' coordinates from the stream distribution and sum the appropriate gaussian error distributions for each of the observed coordinates . for this",
    "we need an efficient scheme for going from a frequency - angle sample to observable space .",
    "the torus machine @xcite was developed to convert from angle - actions to @xmath150 efficiently .",
    "such machinery seems ideal for our purpose .",
    "a torus is constructed by finding the coefficients of the generating function from a toy torus .",
    "we can construct a series of nearby tori which cover the small range in action space occupied by the stream particles . for a given set of angles we can find a corresponding @xmath150 on each torus . for any action point which lies between tori we can construct an appropriate torus on - the - fly by interpolating the generating function coefficients of the nearby tori .",
    "a small complication here is that we wish to work with frequencies instead of actions so a scheme for finding @xmath151 is required .",
    "we expect that for the region of interest this function is simple and may be obtained by interpolation between tori . with this function",
    "we may also calculate the hessian as a function of @xmath1 .",
    "\\(ii ) our choice of model parametrisation is perhaps more flexible than it should be .",
    "all the widths ( @xmath152 ) are related to @xmath153 @xcite so there could be a way to link all three parameters into a single mass parameter .",
    "also , we have allowed the stream to be oriented along some random direction , @xmath64 .",
    "the direction depends on the exact structure of the action distribution , and the structure of the hessian matrix .",
    "the first of these can be sensitive to internal structure in the progenitor .",
    "we gain information about @xmath64 through the use of the angle and frequency structure as discussed in @xcite .",
    "however , we could instead choose to make @xmath64 a function of the progenitor actions in the chosen potential .",
    "this would constrain the models in a more physically motivated fashion , and would provide more information when the quality of the data is reduced .",
    "\\(iii ) we have analysed a simulated stream evolved in a near - spherical logarithmic potential .",
    "as discussed in @xcite this does not exhibit substantial offset between the stream and orbit tracks .",
    "such an offset is more apparent in flattened potentials .",
    "therefore , more tests are required with more realistic potentials with disc components to validate the modelling approach presented here .",
    "additionally , our potential has only two parameters , whilst , in a practical application , a more flexible potential model should be adopted .",
    "we have found that the parameters of this two - parameter potential are recovered without significant correlations . from stream data we are measuring the acceleration in some small spatial volume which in the axisymmetric case is given approximately by the gradients @xmath154 and @xmath155 at the progenitor .",
    "these gradients uniquely specify a combination of @xmath87 and @xmath88",
    ". however , with more parameters in our potential model , many combinations of these parameters would give identical accelerations at the progenitor , so strong correlations are to be expected .",
    "more work is required to say exactly what properties of the potential , and hence what potential parameter combinations , a given set of stream data best measures .",
    "\\(iv ) the distributions in frequency and angle , @xmath69 , along the principal stream direction , @xmath64 , were taken in this paper to be simple gaussians and a uniform distribution .",
    "this procedure is adequate for our purposes but more realistic distributions are required to reproduce the peaky distribution from fig .",
    "[ releasetimes ] , and the expected feathering in the stream @xcite .",
    "for instance , a first step would be to adjust the distribution over stripping times to be more concentrated around pericentric passage of the progenitor by modelling @xmath60 as a comb of gaussians separated by the radial period of the progenitor model .",
    "however , for measuring the galactic potential the shape of the stream is far more important than the density along the stream and , as we have shown , the assumption of a uniform stripping - time distribution is sufficient for recovery of the potential parameters .",
    "recently @xcite presented a machinery very similar to that shown here for constructing models of tidal streams .",
    "he exploits the narrow range of frequencies in the stream to construct a simple linear map between @xmath156 and @xmath150 . the gaussian structure in @xmath156-space",
    "can then be simply translated into a gaussian structure in @xmath150 making marginalization over missing data simpler .",
    "@xcite present a similar approach to analysing a stream model consisting of a gaussian structure in action space and initial angle space .",
    "we have presented a probabilistic model for a tidal stream and used this to constrain the potential from a simulation .",
    "the stream model builds on the work of @xcite by constructing a simple model for the stream in frequency and angle space .",
    "the presented formalism naturally accounts for the errors in stream data , and can also incorporate the possibility of stream data being contaminated with stars from a smooth halo population or another tidal structure .",
    "we have successfully recovered the potential parameters used to run an n - body simulation of a gd-1-like stream from error - free data , data with small errors included , and data with outliers included .",
    "as currently formulated the computational cost of implementing our approach increases significantly with the magnitude of the observational errors .",
    "we have described modifications that promise to mitigate this effect , and thus to make the approach a powerful technique for constraining the galaxy s gravitational potential .",
    "jls thanks james binney , hans - walter rix , david hogg , paul mcmillan and the dynamics group in oxford for useful conversations which shaped this work .",
    "jls acknowledges the support of the science and technology facilities council , and the comments from the anonymous referee which improved this work .",
    "as part of our likelihood in section  [ formalism ] we require the hessian matrix , @xmath157 . in a stckel potential this matrix may be found numerically by following the procedure presented in the appendix of @xcite .",
    "this involves finding the second derivatives of the analytic integral expressions for the actions with respect to the integrals of motion : the energy , @xmath158 , the @xmath159-component of the angular momentum , @xmath160 , and the third integral , @xmath161 .",
    "the resulting integrals are performed analytically using gaussian quadrature , but care must be taken due to the divergence of the frequency integrand at the end - points .",
    "these considerations are taken care of by introduction of a dummy variable as described in @xcite .    for our purposes",
    "we are using a stckel approximation to the true potential @xcite so we estimate the true hessian matrix as that calculated in the approximate stckel potential . in the true potential , the error in each component of the hessian matrix is less than @xmath162 .",
    "however , the error in the determinant is larger ( @xmath163 ) . as the potentials considered are near - spherical",
    "the determinant of the hessian is small ( it is zero for the spherical case ) , which arises due to cancelling terms in the calculation .",
    "therefore , small errors in each component can give rise to larger errors in the determinant .",
    "we recover the appropriate trends in the determinant of the hessian matrix with the potential parameters .",
    "there is a slight bias in fig .",
    "[ errfree ] which is probably due to the errors in the hessian matrix . however , it is not significant .",
    "the results shown in this paper demonstrate that the magnitude of the observational errors in the data dominates any systematic errors in estimating the angles , frequencies , or the determinant of the hessian matrix ."
  ],
  "abstract_text": [
    "<S> we present a generative probabilistic model for a tidal stream and demonstrate how this model is used to constrain the galactic potential . </S>",
    "<S> the model takes advantage of the simple structure of a stream in angle and frequency space for the correct potential . </S>",
    "<S> we investigate how the method performs on full 6d mock stream data , and mock data with outliers included . </S>",
    "<S> as currently formulated the technique is computationally costly when applied to data with large observational errors , but we describe several modifications that promise to make the technique computationally tractable .    the galaxy : kinematics and dynamics - the galaxy : structure - galaxies : kinematics and dynamics - methods : numerical </S>"
  ]
}