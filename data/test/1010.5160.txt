{
  "article_text": [
    "* the main objective of the paper * + the immediate objective of the paper is to present partial - realization theory of linear switched systems .",
    "however , the broader goal is to demonstrate that    * it is possible to develop partial - realization theory for hybrid systems , * the theory of rational formal power series can be used to obtain partial - realization theory of hybrid systems .",
    "the results of the paper just serve as evidence for the above claims .",
    "in fact , partial - realization theory can be developed along the same line for other classes of hybrid systems , @xcite .",
    "this paper is intended as the first one in a series of papers dealing with partial - realization theory of hybrid systems .",
    "* the class of linear switched systems * + linear switched systems have been studied for almost two decades , see @xcite for a survey .",
    "their practical and theoretical relevance is widely recognized .",
    "_ linear switched systems ( abbreviated by lss ) _ are hybrid systems with external switching only , whose continuous dynamics in each discrete mode is determined by a linear continuous - time system , and whose discrete dynamics is trivial , i.e. any discrete state transition is allowed . the continuous subsystems are defined on the same state- , input- and output - spaces . a discrete state transition occurs if the environment enforces one , i.e. the switching sequence itself functions as an input .",
    "the time evolution of a linear switched system can be pictured as follows .",
    "a discrete mode is selected and a continuous input is fed into the corresponding linear subsystem . the state and output of the linear switched system is now determined by the time evolution of the chosen linear subsystem . at some point in time , a new discrete mode is selected . then the linear subsystem corresponding to the new discrete mode is launched , using as initial state the state of the previous linear subsystem at the moment when a transition to the new mode occurred . from this point on ,",
    "the state and output evolve according to the newly selected linear subsystem .",
    "* motivation * + we believe that similarly to linear systems , partial - realization theory for lsss   will be useful for systems identification and model reduction of lsss  and even of more general hybrid systems .",
    "we will elaborate on the possible applications in section [ sect : concl ] .",
    "* contribution of the paper * + the paper presents the following results .    *",
    "* partial - realization algorithm and theorem for lsss * + in section [ sect : main_result ] we propose a notion of partial - realization . in theorem",
    "[ part_real_lin : theo1 ] and [ part_real_lin : theo1.1 ] we formulate a sufficient condition for existence and minimality of a partial realization .",
    "we present two algorithms for computing a partial - realization . in one of them ,",
    "algorithm [ alg0 ] , a partial - realization is constructed from the columns of a _",
    "finite _ sub - matrix hankel - matrix , the other one , algorithm [ partreal ] , is based on finding a factorization of a _ finite _ sub - matrix of the hankel - matrix .",
    "the outcomes of both procedures are isomorphic .",
    "the former is potentially useful for theoretical purposes , while the latter one might serve as a basis for subspace identification - like methods .",
    "the factorization algorithm was implemented and the implementation is available from the the first - named author on request . * * realization algorithm for lsss * + in theorem [ part_real_lin : theo1 ] and [ part_real_lin : theo2 ] we show that the above partial - realization algorithms return a complete minimal realization of the input - output behavior , provided the rank of the finite sub - matrix of the hankel - matrix equals the rank of the full hankel - matrix . we show that any finite sub - matrix whose size is above a certain lower bound has this property . * * partial - realization theory for families of formal power series * + both the ( partial- ) realization algorithm and the corresponding theoretical results for lsss   follow quite easily from analogous statements for families of rational formal series . in appendix [",
    "sect : pow : part ] we present what can be termed as partial - realization theory and algorithms for _ families of formal power series_. although partial - realization theory of a single rational formal power series has been known in various forms @xcite , its extension to families of formal power series appears to be new .",
    "as it was already noted , this extension of the classical theory can be then used to develop partial - realization theory for a number of other ( more general ) classes of hybrid systems , @xcite .    * formal power series approach * + our main tool is the theory of rational formal power series .",
    "recall from @xcite that there is a correspondence between lss   realizations and representations of certain rational families of former power series . recall that the hankel - matrix of a family of input - output maps is in fact the hankel - matrix of the corresponding family of formal power series .",
    "hence , by formulating a partial - realization theory and algorithms for rational families of formal power series , we immediately obtain partial - realization theory and algorithms for lsss . *",
    "related work * + to the best of our knowledge , the only results on partial - realization of linear switched systems is the first - named author s thesis @xcite . in @xcite",
    "partial - realization theory of bilinear hybrid and switched systems are announced , but no proofs are provided .",
    "the thesis @xcite contains most of the results of this paper . in addition",
    ", it also covers partial - realization theory of several other classes of hybrid systems .",
    "reference @xcite announces some results on partial - realization theory of stochastic jump - markov systems .    realization theory of rational formal power series is a classical topic , see @xcite .",
    "it is known to be closely related to realization theory of bilinear and state - affine systems @xcite . in turn , results on partial - realization theory for discrete - time bilinear systems and state - affine systems can be found in @xcite . with respect to @xcite ,",
    "the main novelty of the paper is the following .    1 .",
    "in this paper ( in appendix [ sect : pow : part ] ) partial - realization theory is stated directly for rational formal power series representations , without reformulating it in terms of some particular system class such as bilinear or state - affine systems .",
    "2 .   while the classical results @xcite can be thought of as a reformulation of partial - realization theory for a single rational formal power series , here we deal with _ families of formal power series_. 3 .",
    "we apply partial - realization theory of rational formal power series to linear switched systems .",
    "this represents a novel result in the theory of hybrid systems .",
    "we view this as the main contribution of the paper .",
    "the statement of the main results on partial - realization theory for families of formal power series was announced @xcite , but no proof was ever presented .",
    "the thesis @xcite contains the statement and the proof of the main results on formal power series . *",
    "outline of the paper * + the outline of the paper is the following .",
    "section [ sect : info ] presents an informal formulation of the partial - realization problem for lsss .",
    "section [ sect : num ] discusses a numerical example .",
    "it is intended as an accessible explanation of the main results of the paper by means of an example .",
    "section [ sect : switch ] presents the definition and some elementary properties of linear switched systems together with the basic notation and terminology .",
    "section [ sect : lin_sys : real_theo ] provides a brief overview of the realization theory of linear switched systems .",
    "this section is a prerequisite for understanding the main results of the paper .",
    "section [ sect : main_result ] presents the formal statement of the main results of the paper .",
    "section [ sect : lin_alg ] presents the proof of the results stated in section [ sect : main_result ] .",
    "finally , in section [ sect : concl ] we formulate the conclusions of the paper and we discuss potential applications of the presented results .",
    "as it was already remarked , partial - realization theory of lsss  is based on partial - realization theory of rational formal power series .",
    "therefore , in appendix [ sect : pow ] we included a brief overview of the extension of the theory of formal power series to families of formal power series .",
    "more precisely , appendix [ sect : pow ] reviews the relevant concepts and results on formal power series from @xcite . in appendix",
    "[ sect : pow : part ] we present partial - realization theory of families of formal power series . and algorithms for computing a representation for a family of formal power series .",
    "appendix [ sect : pow : part ] is in fact the main technical tool of the paper .",
    "it is a prerequisite for understanding the proof of the main results on partial - realization theory of lsss .",
    "the goal of this section is to state the partial - realization problem for linear switched systems in an informal way .",
    "the next section , section [ sect : num ] , provides a numerical example to illustrate the problem and the solution .",
    "we defer the formal problem statement until section [ sect : main_result ] .    * brief review of linear - partial realization theory * + the partial - realization problem was originally formulated for linear systems . @xcite as follows .",
    "assume that the first @xmath0 markov parameters @xmath1 of an input - output map @xmath2 are specified .",
    "* find conditions for existence of a linear system whose first @xmath3 markov - parameters coincide with @xmath4 .",
    "such a linear system is called a _ partial - realization of @xmath5_. characterize minimal partial - realizations .",
    "find an algorithm for computing a ( minimal ) partial - realization .",
    "* find conditions under which the thus obtained linear system is a minimal realization of the input - output map @xmath2 .",
    "notice that for discrete - time linear systems , the @xmath6th markov parameter coincides with the output of the system at time @xmath6 for a particular input .",
    "hence , the partial - realization problem can be seen as an identification problem .",
    "in fact , partial - realization theory of linear systems can be used for systems identification and model reduction .",
    "* markov - parameters for lsss * + let @xmath7 be a family of input - output map which map continuous - valued inputs and switching sequences to continuous outputs .",
    "that is , the elements of @xmath7 are of the same form as the input - output maps generated by lsss",
    ". below we will define _ generalized markov - parameters _ of a family @xmath7 of input - output maps which could potentially be realized by a lss .",
    "the generalized markov - parameters of @xmath7 are defined as certain high - order derivatives with respect to the switching times of the elements of @xmath7 .",
    "more precisely , the markov - parameters are indexed by triples consisting of the following components    * elements of @xmath7 , or pairs @xmath8 where @xmath9 runs through the set of discrete modes and @xmath10 runs through the set @xmath11 , where @xmath12 denotes the number of continuous - valued input channels , and * sequences of discrete modes , and * discrete modes .    without going into details ,",
    "the intuition behind the presented indexing is the following . a markov - parameter of @xmath7 indexed by @xmath13 , a discrete mode @xmath9 , and a sequence of discrete modes @xmath14 , stands for the partial derivative of @xmath2 with respect to the switching times , evaluated at zero , for the following switching scenario .",
    "the system goes through the modes @xmath15 and then jumps to @xmath9 . here",
    "the continuous input is set to zero .",
    "the intuitive meaning of a markov - parameter indexed by a pair @xmath16 , a discrete mode @xmath9 and a sequence of discrete modes @xmath14 is the following .",
    "each input - output map @xmath13 can be written as a sum @xmath17 of two maps , where @xmath18 is independent of the continuous input and @xmath19 is common for all the elements of @xmath7 and it is linear in continuous inputs . roughly speaking , @xmath18 accounts for the output from a certain initial state under zero input , and @xmath19 represents the input - output map induced by the zero initial state .",
    "the markov - parameter indexed by the pair @xmath16 , discrete mode @xmath9 and sequence @xmath20 is the derivative of @xmath19 with respect to the switching times evaluated at zero , for the switching scenario where the system goes from mode @xmath21 to @xmath22 and ends in @xmath9 , and all the continuous input channels are @xmath23 except the @xmath10th one which is @xmath24 .    *",
    "partial - realization problem for lsss * + we will refer to a markov parameter indexed by a sequence of discrete modes of length @xmath6 as a markov - parameter of _ order @xmath6_. fix a natural number @xmath25 and let @xmath5 be the collection of all markov - parameters of @xmath7 of order at most @xmath3 .",
    "that is , @xmath5 is simply a collection of high - order derivatives of the elements of @xmath7 , such that the degree of derivation is bounded by @xmath3 .",
    "a lss   @xmath26 is said to be a _",
    "@xmath3-partial realization _ of @xmath7 , if certain products of the matrices of @xmath26 are equal to the corresponding elements of @xmath5 .",
    "in other words , @xmath26 is a @xmath3-partial realization of @xmath7 if the input - output maps of @xmath26 and those of @xmath7 have the property that their derivatives corresponding to the markov - parameters of order at most @xmath3 coincide . from realization theory of lsss",
    "@xcite it follows that a lss  is a realization of @xmath7 if and only if it is a @xmath3-partial realization of @xmath7 for all @xmath0 .",
    "the _ partial realization problem _ for lsss   can be now stated as follows .",
    "* find conditions for existence of a @xmath3-partial realization of @xmath7 by lss .",
    "characterize minimal dimensional @xmath3-partial realizations of @xmath7 .",
    "find an algorithm for computing a minimal @xmath3-partial lss   realizations of @xmath7 . * find conditions under which a minimal @xmath3-partial lss  realization of @xmath7 is a complete realization of @xmath7 .",
    "the motivation for studying the partial - realization problem for lsss   is similar to that of for linear systems , i.e. we expect it to be useful for model reduction and systems identification . in section [",
    "sect : concl ] we will present a more detailed description of the motivation and possible applications .",
    "the purpose of this section is to demonstrate the main results of the paper by means of a numerical example . in this section",
    "we will tacitly use the notation and terminology of section [ sect : switch ] and section [ sect : main_result ] . consider the linear switched system of the form @xmath27 where @xmath28 is the discrete mode at time @xmath29",
    ", @xmath30 is the continuous - state at @xmath29 , @xmath31 is the scalar output at @xmath29 , and @xmath32 is the scalar input at @xmath29 .",
    "the system matrices @xmath33 describing the linear control system residing in a state ( mode ) @xmath34 are of the following form . @xmath35",
    "consider the initial states @xmath36 and @xmath37 .",
    "consider the set of input - output maps @xmath38 such that @xmath39 is realized by @xmath26 from the initial state @xmath40 , @xmath41 , i.e. @xmath42 , for @xmath41 , for each continuous - valued input @xmath43 and finite switching sequence @xmath44 .",
    "notice that @xmath7 can be realized by the following minimal linear switched system @xmath45 where for each @xmath46 , the matrices @xmath47 are of the following form @xmath48 more precisely , @xmath49 realizes @xmath39 from the initial states @xmath50 , for @xmath41 . here , @xmath51 and @xmath52 .",
    "since @xmath7 has a realization by a lss , it is clear that it has a generalized kernel representation and hence its markov - parameters can be defined . in order to give a better intuition on markov - parameters of @xmath7 ,",
    "we have listed some of them in table [ table1 ] .",
    ".[table1 ] markov - parameters of @xmath7 [ cols=\"<,^,^,>\",options=\"header \" , ]     consider the upper - left sub - matrix @xmath53 of the hankel - matrix @xmath54 of @xmath7 . recall that @xmath53 is formed by the intersection of the columns of @xmath54 indexed by a sequence of discrete modes of length at most @xmath55 , and by the rows of @xmath54 indexed by a sequence of discrete modes of length at most @xmath56 . from theorem [ part_real_lin : theo1 ]",
    "it follows that @xmath57 for all @xmath58 .",
    "in fact , it turns out that the hankel - matrix @xmath59 for @xmath60 has already rank @xmath61 . by theorem [ part_real_lin : theo1 ]",
    "it means that we can already compute a minimal lss   realization of @xmath7 from the generalized markov parameters of @xmath7 of indexed by sequences of discrete modes of length at most @xmath62 .",
    "applying algorithm [ partreal ] to @xmath63 yields the following minimal lss  realization @xmath64 of @xmath7 .",
    "@xmath65 where the system matrices are of the form @xmath66 the lss   @xmath64 realizes the input - output map @xmath67 from the initial state @xmath68 , and the map @xmath69 from the initial state @xmath70 .    however , it turns out that @xmath71 .",
    "that is , the sequence of markov parameters of @xmath7 indexed by sequences of discrete modes of length at most @xmath24 already satisfies the partial realization theorems theorem [ part_real_lin : theo1 ] and theorem [ part_real_lin : theo2 ] .",
    "hence , we can apply algorithm [ partreal ] to @xmath72 to obtain a minimal lss  @xmath24-partial realization of @xmath7 .",
    "however , it can be checked that the thus obtained lss  _ is not a lss  realization of @xmath7_. indeed , by applying algorithm [ partreal ] to @xmath72 we obtain the following lss   realization of @xmath7 @xmath73 where the system matrices @xmath74 , @xmath34 are as follows @xmath75 the lss  @xmath76 is a _ partial realization _ of the input - output map @xmath67 from the initial state @xmath77 , and of the input - output map @xmath69 from the initial state @xmath78 .",
    "that is , the markov parameters of @xmath38 which are indexed by sequences from the set @xmath79 coincide with those of the input - output maps induced by the initial state @xmath80 , @xmath41 .",
    "it is easy to see that @xmath76 is not a realization of the input - output maps @xmath39 from the respective initial states @xmath81 , @xmath82 .",
    "that is , the input - output maps induced by the respective states @xmath81 , @xmath41 , do not coincide with the maps @xmath39 .",
    "one can either check it by direct calculation , or by using uniqueness of a minimal realization . using the latter approach ,",
    "it is enough to notice that @xmath49 is a minimal realization of @xmath7 and it is of dimension @xmath61 . since @xmath76 of dimension @xmath83 , hence smaller than the dimension of @xmath49 , and all minimal realizations have to be of the same dimension , it follows that @xmath76 can not be a realization of @xmath7 .",
    "in fact , by checking the markov - parameters , one can see that @xmath76 recreates only the markov - parameters indexed by sequences of length at most @xmath24 , but there is a markov - parameter of @xmath7 , indexed by a sequence of length @xmath83 , which is not generated by @xmath76 .",
    "that is , it indeed happens that a family of input - output maps generated by a lss  satisfies the sufficient conditions for existence of a @xmath3-partial realization for some @xmath3 , but the obtained partial realization is not a complete realization of the family of input - output maps .",
    "[ sect : switch ] this section contains the definition of linear switched systems",
    ". we will start with fixing notation and terminology which will be used throughout the paper .",
    "the notation used in this paper is mostly the standard one used in the field of control theory and formal language theory . in order to make the task of the reader easier , below we will list the most important notational conventions , grouped according to the disciplines .",
    "denote by @xmath84 the set @xmath85 of all non - negative reals .",
    "the set @xmath84 will be the time - axis of the systems discussed in this paper . for any @xmath86 , denote by @xmath87 the class of piecewise - continuous maps from @xmath84 to @xmath88 .",
    "that is , @xmath89 , if @xmath2 has finitely many points of discontinuity on each finite interval @xmath90 $ ] , @xmath91 , and at each point of discontinuity the right- and left - hand side limits exist and they are finite .",
    "denote by @xmath92 the set of natural number including @xmath23 . by abuse of notation",
    "we will denote any constant function @xmath93 by its value .",
    "that is , if @xmath94 for all @xmath91 , then @xmath2 will be denoted by @xmath95 . for any function",
    "@xmath96 the range of @xmath96 will be denoted by @xmath97 , i.e. if @xmath98 for some sets @xmath99 and @xmath100 , then @xmath101 . if @xmath102 is a vector space and @xmath103 is a subset of @xmath102 , then @xmath104 denotes the linear span of elements of @xmath103 in @xmath102 .",
    "if @xmath105 are vector spaces over @xmath106 , and @xmath107 , @xmath108 are linear maps , then @xmath109 denotes the composition @xmath110 and @xmath111 .",
    "let @xmath112 be a smooth map . consider a @xmath6 tuple of natural numbers @xmath113 , where @xmath114 .",
    "we will denote @xmath115 the partial derivative of @xmath116 evaluated at zero , such that the order of derivation with respect to the variable @xmath117 is @xmath118 for @xmath119 .",
    "that is , @xmath120 for each @xmath121 , @xmath122 denotes the @xmath10th unit vector of @xmath123 , i.e. @xmath124 , where @xmath125 is the kronecker symbol .",
    "in this paper we will use the notation of @xcite for matrices indexed by sets other than natural numbers .",
    "let @xmath126 and @xmath127 be two arbitrary sets .",
    "a ( real ) matrix @xmath128 whose columns are indexed by the elements of @xmath127 and whose rows are indexed by the elements of @xmath126 is simply a map @xmath129 .",
    "the set of all such matrices is denoted by @xmath130 .",
    "the entry of @xmath128 indexed by the row index @xmath131 and column index @xmath132 is denoted by @xmath133 and it is defined as the value of @xmath128 at @xmath134 , i.e. @xmath135 . the case of usual finite matrices can be recovered by viewing @xmath136 real matrices as matrices from @xmath137 . in the sequel ,",
    "when referring to the index set of a matrix , we will identify any natural number @xmath138 with the set @xmath139 .",
    "in other words , @xmath140 denotes the set of matrices @xmath141 and @xmath142 denotes the set of matrices @xmath143 .    for a matrix @xmath144 ,",
    "the columns of @xmath128 are simply maps of the form @xmath145 and the rows of @xmath128 are maps of the form @xmath146 .",
    "the set of maps of the form @xmath145 and @xmath146 will sometimes be denoted by @xmath147 and @xmath148 respectively .",
    "furthermore , if @xmath149 ( resp .",
    "@xmath150 ) then the value of @xmath96 at @xmath131 ( resp .",
    "@xmath132 ) will be denoted by @xmath151 ( resp .",
    "@xmath152 ) .",
    "the column of @xmath128 indexed by @xmath132 will be denoted by @xmath153 and is defined as @xmath154 , @xmath131 .",
    "similarly , the row if @xmath128 indexed by @xmath131 will be denoted by @xmath155 and is defined as @xmath156 for all @xmath132 .",
    "if @xmath144 and @xmath157 and @xmath127 is finite , then the product of @xmath128 and @xmath5 is the matrix @xmath158 such that @xmath159 for all @xmath160 . in particular , if @xmath161 and @xmath162 for some natural number @xmath163 , then their product @xmath164 is well - defined and it belongs to @xmath165 .",
    "we will identify a map @xmath166 with the matrix @xmath167 defined as @xmath168 for all @xmath132 .",
    "hence , for a matrix @xmath144 , the product @xmath169 is defined as the following matrix in @xmath170 ; @xmath171 . in addition",
    ", we will occasionally identify the rows of a matrix @xmath144 with matrices @xmath172 .",
    "that is , the row @xmath155 of @xmath128 indexed by @xmath173 will be viewed as the matrix @xmath174 . with this identification ,",
    "the product of the row @xmath155 with @xmath2 is a scalar @xmath175 .",
    "notice that here we tacitly assumed that @xmath127 is finite .",
    "notice that the set of all maps @xmath147 forms a vector space with respect to point - wise addition and multiplication by scalar .",
    "that is , if @xmath176 and @xmath177 , then the linear combination @xmath178 is defined by @xmath179 for all @xmath131 .",
    "consider a matrix @xmath144 and recall that its columns are simply elements of @xmath147 .",
    "hence , it makes sense to speak of the linear subspace spanned by the columns of a matrix @xmath144 . in the sequel ,",
    "the _ rank of @xmath128 _ , denoted by @xmath180 will mean the dimension of the linear space spanned by the columns of @xmath128 .",
    "if this dimension is not finite , then the rank is taken to be @xmath181 .",
    "we will denote by @xmath182 the linear space spanned by the columns of @xmath128 .    if @xmath144 and @xmath127 is finite , then @xmath128 can be viewed as a linear map from @xmath148 to @xmath147 , defined by @xmath183 , @xmath131 , for each @xmath166 .",
    "if @xmath157 and @xmath56 is finite , then the product @xmath158 corresponds to the linear map @xmath184 obtained by composing the linear map corresponding to @xmath5 with the linear map corresponding to @xmath128 .",
    "the notation described below is standard in formal languages and automata theory , see @xcite .",
    "consider a finite set @xmath185 which will be called the _",
    "alphabet_. denote by @xmath186 the set of finite sequences of elements of @xmath185 .",
    "finite sequences of elements of @xmath185 will be referred to as _ strings _ or _ words _ over the alphabet @xmath185 . for a word @xmath187 , @xmath188 ,",
    "@xmath189 the length of @xmath190 is denoted by @xmath191 , i.e. @xmath192 .",
    "we will denote by @xmath193 the _ empty sequence ( word)_. the length of the empty sequence @xmath193 is zero : @xmath194 .",
    "we will denote by @xmath195 the set of of non - empty words over @xmath185 .",
    "that is , @xmath196 .",
    "consider two words @xmath197 and @xmath198 of the form @xmath199 , and @xmath200 , @xmath201 .",
    "define the concatenation @xmath202 of the words @xmath203 and @xmath190 as the the word @xmath204 . in particular , if @xmath205 , i.e. if @xmath206 , then @xmath207 .",
    "similarly , if @xmath208 , i.e. @xmath209 , then @xmath210 . if @xmath211 is a word , then @xmath212 denotes the word @xmath213 .",
    "the word @xmath214 is just the empty word @xmath193 .",
    "below we present the formal definition of lsss . for a more detailed exposition ,",
    "see @xcite .",
    "[ lin_switch : def ] a _ linear switched system _ ( abbreviated by lss ) is a control system @xmath26 of the form @xmath215    * @xmath216 is the continuous state at time @xmath91 , * @xmath217 denotes the continuous input at time @xmath91 , * @xmath218 denotes the discrete mode ( state ) at time @xmath29 , * @xmath219 denotes the continuous output at time @xmath91 . *",
    "the state - space is @xmath220 , the input - space is @xmath221 , the output - space is @xmath222 , and @xmath223 is the finite set of discrete modes ( discrete states ) . here",
    "@xmath224 are positive integers . * for each discrete mode @xmath225 , the corresponding matrices are of the form @xmath226 , @xmath227 and @xmath228 .",
    "we will use @xmath229 as a short - hand notation for lsss   of the form ( [ lin_switch0 ] ) .",
    "[ switch_sys : not1 ] in the sequel we denote by @xmath230 the space @xmath88 of continuous - valued input , by @xmath231 the space @xmath232 of continuous - valued outputs , and by @xmath223 the set of discrete modes .    informally , the system ( [ lin_switch0 ] ) evolves as follows . for",
    "a piecewise - constant _ switching signal _ @xmath233 and piecewise - continuous input @xmath234 , the _ state trajectory _ @xmath235 is a continuous piecewise - differentiable function which satisfies the differential equation ( [ lin_switch0 ] ) .",
    "the output at time @xmath91 is obtained by applying to @xmath236 the readout map ( matrix ) @xmath237 .",
    "below we define state- and output- trajectories more rigorously . to this end , we define the notion of switching sequences .    a _ switching sequence _ is a sequence of the form @xmath238 , where @xmath239 are discrete modes and @xmath240 denote the _ switching times _ and @xmath241 .",
    "the set of all switching sequences is denoted by @xmath242 .",
    "if @xmath206 then we say that @xmath190 is the empty switching sequence and we denote it by @xmath193 .",
    "we denote the set of all _ non - empty switching sequences _ by @xmath243 .",
    "the interpretation of the sequence @xmath244 is the following . from time",
    "instance @xmath23 to time instance @xmath245 the active discrete mode is @xmath246 , i.e. the value of the switching signal is @xmath246 , from @xmath245 to @xmath247 the value of the switching signal is @xmath248 , from @xmath247 to @xmath249 the value of the switching signal is @xmath250 , and so on .",
    "that is , the non - negative real @xmath117 indicates the time spent in the discrete mode @xmath251 , for all @xmath252 .",
    "_ in this paper the switching sequences are regarded as inputs and we allow any switching sequence to occur . _    [ def : state_traject ] let @xmath43 be a continuous - valued input and let @xmath253 be a non - empty switching sequence .",
    "the _ state of @xmath26 reached from the initial state @xmath254 with the inputs @xmath255 and @xmath190 _ is denoted by @xmath256 and it is defined recursively on @xmath6 as follows .    * if @xmath257 , then @xmath258 is the solution at time @xmath245 of the differential equation @xmath259 with the initial condition @xmath260 . *",
    "if @xmath261 is already defined , then let @xmath256 be the solution at time @xmath262 of the differential equation @xmath263 with the initial condition @xmath264 .    that is , the states evolves according to the differential equation determined by the discrete mode .",
    "if a switch occurs , then the state at the time of the switch is taken as the initial condition for generating a solution to the differential equation associated with the new discrete mode . as a next step",
    ", we will define the output trajectories of lsss .",
    "consider a continuous - valued input @xmath43 and a non - empty switching sequence @xmath265 .",
    "the _ output generated by the lss  @xmath26 if it is started from initial state @xmath254 and fed with the inputs @xmath255 and @xmath190 _ , denoted by @xmath266 , is defined by @xmath267    that is , the current output is obtained from the current continuous state @xmath256 by the application of the readout map @xmath268 associated with the current discrete mode @xmath269 .",
    "we define the input - output map of a lss   induced by a particular initial state as follows .",
    "consider a state @xmath254 of @xmath26 .",
    "define the _ input - output map of @xmath26 induced by the state @xmath270 _ as the map @xmath271 such that for all continuous - valued input @xmath43 and for all non - empty switching sequence @xmath44 @xmath272 that is , the value of @xmath273 at @xmath274 equals the output generated by @xmath26 if started from the initial states @xmath270 and fed inputs @xmath255 and @xmath190 . by abuse of notation",
    "we will denote @xmath275 by @xmath276 .",
    "the goal of this section is to present a brief overview of realization theory of lsss . in subsection [ lin_sys : io : map ] we recall the definition of input - output maps of lsss  and the notion of a lss  realization . in subsection [ lin_sys : system_theo ] .",
    "we review a number of system - theoretic concepts such as observability , semi - reachability , minimality and lss   morphisms . in subsection",
    "[ lin_sys : real_problem ] the realization problem will be formulated .",
    "subsection [ lin_sys : gen_ker ] recalls the concept of generalized kernel representation of a family of input - output maps .",
    "subsection [ lin_sys : markov ] presents the definition of markov - parameters for lsss .",
    "finally , subsection [ lin_sys : real ] presents the main results on realization theory of lsss . for a more details on the material of this section see @xcite .      in this section",
    "we define the class of maps which represent potential input - output maps of lsss .",
    "in addition , we introduce the notion of a lss  realization .",
    "[ sect : switch_sys : def-1 ] in this paper , unless stated otherwise , an _ input - output map _ will mean a map of the form @xmath277 .",
    "the set of all such maps will be denoted by @xmath278 .",
    "a _ family of input - output maps _ is just a ( possibly infinite ) subset of the set of all input - output maps @xmath278 .",
    "that is , an input - output map maps continuous - valued inputs and non - empty switching sequences to continuous - valued outputs . in order to formalize the notion of a realization by a lss   of a family of input - output maps",
    "we will adopt the following formalism .",
    "[ switch_sys : real : def1 ] consider a set @xmath279 of input - output maps .",
    "the family @xmath7 is said to be _ realized _ by a lss   @xmath26 of the form ( [ lin_switch0 ] ) if there exists a map @xmath280 , which maps each input - output map @xmath2 from @xmath7 to a state @xmath281 of @xmath26 , such that @xmath2 equals the input - output map induced by @xmath282 , i.e. @xmath283    one can think of the map @xmath284 as a way to determine the initial state corresponding to each element of @xmath7 .",
    "[ switch_sys : real : def2 ] let @xmath7 be a family of input - output maps .",
    "we will refer to the pairs @xmath285 , where @xmath26 is a lss   of the form ( [ lin_switch0 ] ) and @xmath280 is a map mapping elements of @xmath7 to the states of @xmath26 , as lss  _ realizations _",
    "( _ realizations _ for short ) .",
    "the realization @xmath285 is said to be a _ realization of @xmath7 _ , if ( [ sect : problem_form : real0 ] ) holds for all @xmath13 .",
    "note that not any realization @xmath285 with @xmath286 is a realization of @xmath7 .",
    "the statement that @xmath285 is a _ realization _ only expresses the fact that we associate a state of @xmath26 with each element of @xmath7 .",
    "however , we do not yet require that the input - output map induced by a designated state equals the corresponding element of @xmath7 .",
    "the latter is required only if we claim that @xmath285 _ is a realization of @xmath7_.      the goal of this section is to define system theoretic concepts such as observability , span - reachability , system morphism , dimension and minimality for lsss   and for lss  realizations . throughout the section",
    "@xmath26 denotes a lss  of the form ( [ lin_switch0 ] ) .",
    "the _ reachable set _ of @xmath26 from a set of initial states @xmath287 is defined as @xmath288 that is , @xmath289 is the set of all those states which are obtained by starting the system from an initial state in @xmath290 , applying some continuous - valued input and some finite switching sequence , and considering the state at the last switching time .",
    "the lss   @xmath26 is said to be _ reachable _ from @xmath290 if @xmath291 holds .",
    "the lss  @xmath26 is _ semi - reachable _ from @xmath290 if @xmath102 is the smallest vector space containing @xmath289 .    in other words",
    ", @xmath26 is semi - reachable   from @xmath290 if the linear span of the elements of the reachable set @xmath289 yields the whole state - space @xmath102 .",
    "we proceed with defining the notion of observability for lsss .",
    "two states @xmath292 of the lss",
    "@xmath26 are _ indistinguishable _ if the input - output maps induced by @xmath293 and @xmath294 coincide , i.e. for all @xmath43 and @xmath44 , @xmath295 .",
    "the lss   @xmath26 is called _ observable _ if it has no pair of distinct indistinguishable states .    in other words",
    ", observability means that if we pick any two states of the system , then we are able to distinguish between them by feeding a suitable continuous - valued input and a suitable switching sequence and then observing the resulting output . below",
    "we will define the notion of dimension for lsss .",
    "[ switch_sys : dim : def ] define the dimension of @xmath26 , denoted by @xmath296 , as the dimension @xmath297 of is state - space .",
    "now we are ready to define the concept of minimality for lsss  .",
    "let @xmath7 be a family of input - output maps and let @xmath285 be a lss   realization of @xmath7 .",
    "@xmath285 is _ a minimal realization of @xmath7 _ , if for any lss   realization @xmath298 of @xmath7 , @xmath299 .    in simple words ,",
    "a lss   realization is a minimal realization of @xmath7 if it has the smallest dimensional state - space among all the linear switched systems which are realizations of @xmath7 .",
    "the notions of observability and semi - reachability can be extended to lss   realizations as follows .",
    "[ switch_sys : real : def3 ] let @xmath7 be a family of input - output maps and let @xmath280 be a map from @xmath7 to the state - space of @xmath26 .",
    "the realization @xmath285 is _ semi - reachable  _ , if @xmath26 is semi - reachable  from the range @xmath300 of @xmath284 .",
    "the realization @xmath285 is _ observable _ , if @xmath26 is observable .    as the next step",
    ", we will define the notion of a lss   morphism .",
    "[ sect : problem_form : lin : morphism ] consider a lss   @xmath301 of the form ( [ lin_switch0 ] ) and a lss   @xmath302 of the form @xmath303 and @xmath302 have the same set of discrete modes . ] .",
    "a linear map @xmath304 is said to be a _",
    "lss   morphism _ from @xmath305 to @xmath306 , and it is denoted by @xmath307 , if for all discrete modes @xmath225 , @xmath308 the map @xmath5 is called surjective ( injective ) if it is surjective ( injective ) as a linear map .",
    "the map @xmath5 is said to be a lss   isomorphism , if it is an isomorphism as a linear map . consider two lss   realizations @xmath309 and @xmath310 such that the domain of definition of both @xmath311 and @xmath312 is a certain family @xmath7 of input - output maps .",
    "a lss   morphism @xmath307 is called a _",
    "lss   morphism _ from realization @xmath309 to @xmath313 , if @xmath314 holds , or , in other words , if for all @xmath13 , @xmath315 .",
    "the fact that @xmath5 is a lss   morphism from @xmath316 to @xmath310 will be denoted by @xmath317 .",
    "the lsss   realizations @xmath309 and @xmath313 are said to be _ algebraically similar _ or _ isomorphic _ if there exists an lss   isomorphism @xmath317 .",
    "the realization problem for lsss   can be formulated as follows .",
    "[ lin_switch : real_problem ] find necessary and sufficient conditions for existence of a lss   realization for a family of input - output maps @xmath7 .",
    "find a characterization of minimal lss   realizations of @xmath7 .",
    "determine if minimal realizations of @xmath7 are unique in any sense .",
    "in this section we will recall the notion of _ generalized kernel representation_. it turns out that a family of input - output maps can be realized by a lss   only if it admits a generalized kernel representation .",
    "informally , a family @xmath7 of input - output maps has a generalized kernel representation if the following hold .    1 .",
    "there exists an input - output map @xmath19 such that for all @xmath13 , @xmath318 for all continuous - valued inputs @xmath255 and switching sequences @xmath190 .",
    "each element @xmath2 of @xmath7 is affine in continuous - valued inputs and analytic in switching times for all constant inputs .",
    "a good intuition for the notion of generalized kernel representation can be derived by analogy with input - output maps of linear systems .",
    "recall from @xcite that an input - output map @xmath319 can be realized by a linear system @xmath320 from the initial state @xmath321 , only if there exist analytic functions @xmath322 and @xmath323 such that @xmath324 more precisely , in this case @xmath325 using the setting above , the maps @xmath326 and @xmath327 to be defined below are analogous to the map @xmath56 and @xmath328 respectively .",
    "the formal definition is as follows .",
    "[ sect : io : def1 ] consider a family of input - output maps @xmath7 , as defined in definition [ sect : switch_sys : def-1 ] .",
    "the family @xmath7 is said to have _ generalized kernel representation _",
    ", if for all input - output maps @xmath13 and for all non - empty sequences of discrete modes @xmath329 , @xmath330 , @xmath189 , there exist functions @xmath331 such that the following holds .    1 .   [ gen_ker/1 ] for each word @xmath332 and for each input - output map @xmath13 , the functions @xmath333 and @xmath334 are analytic .",
    "[ gen_ker/2 ] for each input - output map @xmath13 and for each ( possibly empty ) sequences @xmath335 , and for each discrete mode @xmath225 , it holds that for all @xmath336 , @xmath337 3 .",
    "[ gen_ker/3 ] for each pair of sequences @xmath338 such that and @xmath190 is not the empty word , i.e. @xmath339 , and for each discrete mode @xmath225 , the following holds . for each input - output map",
    "@xmath13 and for each @xmath340 , @xmath341 for each pair of words @xmath338 such that both @xmath203 and @xmath190 are not empty , i.e. @xmath342 , @xmath339 , and for each discrete mode @xmath225 , the following holds . for each @xmath340 ,",
    "@xmath343 4 .",
    "[ gen_ker/4 ] for each input - output map @xmath13 , for each non - empty switching sequence @xmath344 , where @xmath345 and @xmath346 , each piecewise - continuous input @xmath43 , the following holds .",
    "@xmath347    the reader may view the functions @xmath348 as the part of the output which depends on the initial condition and the functions @xmath334 as functions determining the dependence of the output on the continuous inputs .",
    "in fact , let @xmath285 be a lss  realization of @xmath7 and assume that @xmath26 is of the form ( [ lin_switch0 ] ) .",
    "it is easy to see that for all @xmath13 and for any input @xmath43 and switching sequence @xmath349 , @xmath350 from the equation above it is easy to see that @xmath7 admits a hybrid kernel representation of the form @xmath351 for all non - empty sequences of discrete modes @xmath345 , @xmath352 .",
    "next we will define the notion of markov parameters for input - output maps .",
    "markov - parameters play a central role in ( partial ) realization theory of lsss .    before proceeding further ,",
    "recall from classical linear systems theory @xcite the notion of markov parameter .",
    "consider the linear input - output map of the form ( [ gen_ker_int/0 ] ) and define the markov parameters of this map as derivatives of the maps @xmath322 and @xmath323 ; @xmath353 and @xmath354 for all @xmath241 . in turn , the derivatives of @xmath355 and @xmath356 can be expressed as the derivatives of the input - output map as follows . for a constant input @xmath357 define the map @xmath358 that is",
    ", @xmath359 is just the value of the input - output map ( [ gen_ker_int/0 ] ) at time @xmath29 if a constant input @xmath255 is fed in .",
    "then @xmath360 and hence @xmath361 .",
    "similarly , the @xmath10th column of @xmath362 can be written as @xmath363 where @xmath122 , @xmath364 is the @xmath10th unit vector of @xmath221 .",
    "that is , _ the markov - parameters of a linear input - output map are the high - order time derivatives of the output trajectories induced by certain constant inputs , evaluated at zero_. for lsss  the markov - parameters are defined in a similar way . before proceeding to the definition , we need the following notation    [ sect : io : io_der ] consider an input - output map @xmath2 as in definition [ sect : switch_sys : def-1 ] , a non - empty sequence of discrete modes @xmath365 , @xmath345 , @xmath352 and a continuous - valued input @xmath43 . define the map @xmath366 as follows @xmath367    that is , the values of @xmath368 are obtained from the values of @xmath2 by fixing the a piecewise - continuous input @xmath255 and a sequence of discrete modes @xmath190 and varying the switching times only .",
    "[ linswitch_intro : def : markov ] let @xmath7 be a family of input - output maps admitting a generalized kernel representation .",
    "the _ markov parameters _ of @xmath7 are the vectors @xmath369 and @xmath370 , defined for all discrete modes @xmath371 , all the sequences of discrete modes @xmath372 ( including the empty sequence ) , all @xmath364 and @xmath13 as follows . if @xmath373 for @xmath241 , @xmath345 , then @xmath374 here @xmath122 is the @xmath10th unit vector of @xmath221 .",
    "the vectors @xmath375 correspond to the parameters @xmath376 for linear systems , and @xmath377 corresponds to the @xmath10th column of the @xmath378 component of the markov parameters .",
    "as it was shown in @xcite , there is a close relationship between the markov parameters of @xmath7 and products of system matrices .",
    "[ sect : io : prop1 ] let @xmath26 be of the form ( [ lin_switch0 ] ) and let @xmath280 .",
    "the realization @xmath285 is a realization of @xmath7 , if and only if the markov - parameters of @xmath7 are equal to the following products of the system matrices .",
    "@xmath379 for each @xmath380 , for each @xmath345 , @xmath241 , @xmath13 and @xmath364 .    similarly to the linear case",
    ", the markov - parameters of @xmath7 can also be represented as derivatives of the maps @xmath326 and @xmath327 , see @xcite .",
    "the purpose of this section is to present formally the main results on realization theory of lsss  . to this end , the notion of the hankel - matrix @xmath54 of @xmath7 is defined .",
    "similarly to the linear case , the entries of the hankel - matrix will be formed by the markov parameters .",
    "[ main_result : lin : hank : arb : def ] assume that the set of discrete modes @xmath223 has @xmath381 elements and choose an enumeration of @xmath223 @xmath382 recall the notation for infinite matrices presented in section [ sect : prelim : not_matrix ] . define the _ hankel - matrix _ of @xmath7 as the infinite real matrix , columns and rows of which are indexed as follows .",
    "the rows of @xmath54 are indexed by pairs @xmath383 where @xmath384 is a finite sequence of discrete modes and @xmath385 .",
    "the columns of @xmath54 are indexed by pairs @xmath386 , where @xmath372 is a sequence of discrete modes and @xmath10 is either an element of @xmath7 , or @xmath10 is a pair of the form @xmath387 , where @xmath9 is a discrete mode and @xmath388 .",
    "that is , @xmath54 is an infinite real matrix of the form @xmath389 where @xmath390 and @xmath391 .",
    "the entries of @xmath54 are defined as follows .",
    "fix sequences of discrete modes @xmath392 and fix an element @xmath393 . for any @xmath394 of the form @xmath395 where @xmath396 and @xmath397 , the entry @xmath398 is defined as follows @xmath399 here @xmath400 and @xmath401 denote the @xmath402th element of the vectors @xmath403 and @xmath404 respectively .",
    "that is , @xmath54 is constructed from certain high - order derivatives of the input - output maps belonging to @xmath7 . as it was noted in section [ sect : prelim : not_matrix ] ,",
    "the columns of @xmath54 belong to the vector space of all maps @xmath405 .",
    "hence , we can speak of the linear span of the columns of @xmath54 . in addition , according to the convention adopted in section [ sect : prelim : not_matrix ] , the _ rank of @xmath54 _ , denoted by @xmath406 , is the dimension of the linear subspace spanned by the columns of @xmath54 .",
    "now we are ready to state the main theorem on the existence of a lss   realization for arbitrary switching .",
    "[ sect : real : theo2 ] let @xmath7 be a family of input - output maps",
    ". then @xmath7 has a realization by a lss   if and only if @xmath7 has a generalized kernel representation and the rank of the associated hankel - matrix @xmath54 of @xmath7 is finite , i.e , @xmath407 .",
    "next , we state state the main result of on minimality of lsss  .",
    "[ sect : real : theo3 ] if @xmath285 is a lss   realization of @xmath7 , then the following are equivalent .",
    "* @xmath285 is a minimal lss   realization of @xmath7 . *",
    "the realization @xmath285 is semi - reachable   and it is observable . * the state - space dimension of @xmath26 equals the rank of the hankel - matrix of @xmath7 , i.e. @xmath408 .    in addition , all minimal lss   realizations of @xmath7 are isomorphic .",
    "the purpose of this section is to present the main results of the paper formally .",
    "the outline of this section is as follows . in subsection [",
    "sect : main_result : part_real_problem ] we state the partial - realization problem for lsss  formally . in subsection",
    "[ sect : main_result : hank ] we define the notion of hankel sub - matrix , which will be needed for the statement of the main results . in subsection",
    "[ sect : main_result : alg0 ] we present the theorem characterizing the existence and minimality of partial realizations . in addition , we present a simple algorithm for computing a minimal partial realization .",
    "finally , in subsection [ sect : main_result : alg1 ] we present a kalman - ho - like algorithm for computing a minimal partial realization .",
    "let @xmath7 be a family of input - output maps admitting a generalized kernel representation . as we saw earlier ,",
    "the markov - parameters uniquely determine the input - output maps of a linear switched system .",
    "in addition , the realization problem for lss   can be reduced to the problem of finding a suitable representation of the markov - parameters of the input - output maps . however , in practice we can obtain only markov - parameters only up to some finite order . hence , the _ partial - realization problem _ ( with respect to the number of switches ) arises . in order to present a formal problem formulation , the notion of ( minimal ) partial realization has to be introduced .",
    "[ def : part_real ] let @xmath7 be a family of input - output maps admitting a generalized kernel representation .",
    "assume that @xmath26 is a lss   of the form ( [ lin_switch0 ] ) and let @xmath286 .",
    "a realization @xmath285 is said to be an @xmath3-partial realization of @xmath7 , if for all @xmath380 , @xmath13 , @xmath364 , and for all ( possibly empty ) sequences of discrete modes @xmath345 , of length at most @xmath3 , i.e. @xmath409 , the following holds .",
    "@xmath410 the lss   @xmath26 is said to be an @xmath3-partial realization of @xmath7 , if for there exists a map @xmath280 such that the realization @xmath285 is a @xmath3-partial realization of @xmath7 .",
    "the realization @xmath285 is said to be a partial realization of @xmath7 , if it is a @xmath3-partial realization of @xmath7 for some @xmath0 .",
    "from lemma [ sect : io : prop1 ] it follows that @xmath285 is a realization of @xmath7 if and only if @xmath285 is an @xmath3-partial realization of @xmath7 for all @xmath0 .",
    "note that if @xmath7 and @xmath285 is a @xmath3-partial realization of @xmath7 , then ( [ sect : real : prop1:eq1.1 ] ) holds for _ finitely many _",
    "markov - parameters .    in the sequel",
    ", we will often refer to the markov - parameters which are indexed by a sequence of discrete modes of length @xmath3 as _ markov - parameters of order @xmath3_. that is , a markov - parameter of order @xmath3 is either of the form @xmath377 or @xmath375 with @xmath411 .    with this terminology , a lssis a @xmath3-partial realization of @xmath7 , if it recreates the markov - parameters of @xmath7 of order at most @xmath3 .",
    "if @xmath7 is finite , then the set of markov - parameters of @xmath7 of order at most @xmath3 is finite .",
    "a lss  realization @xmath285 is said to be a minimal @xmath3-partial realization of @xmath7 , if @xmath285 is a @xmath3-partial realization of @xmath7 and for any other @xmath3-partial lss  realization @xmath412 of @xmath7 , @xmath413 .    in plain words ,",
    "a minimal @xmath3-partial realization of @xmath7 is a @xmath3-partial realization of @xmath7 with the smallest possible state - space dimension .",
    "[ prob : part : real ] let @xmath7 be a family of input - output maps admitting a generalized kernel representation .",
    "the partial - realization problem entails the following problems .    *",
    "find conditions for existence of a @xmath3-partial realization of @xmath7 .",
    "formulate an algorithm for computing a @xmath3-partial realization from generalized markov - parameters of @xmath7 of some bounded order .",
    "if @xmath7 is finite , this amounts to computing a @xmath3-partial realization from _ finitely many _",
    "markov - parameters .",
    "* characterize minimal @xmath3-partial realizations of @xmath7 , find conditions for their existence and uniqueness .",
    "* find conditions under which a @xmath3-partial realization of @xmath7 is a complete realization of @xmath7 in the sense of definition [ switch_sys : real : def2 ] .",
    "we will devote the remaining part of the section to presenting the solution to the problem formulated above .",
    "we will show that it is possible to compute a minimal @xmath3-partial realization from a suitably chosen sub - matrix of the hankel matrix of @xmath7 .",
    "in fact , this sub - matrix is formed by markov - parameters of bounded order , and hence it is finite , if @xmath7 is finite . if @xmath3 is large enough , the resulting @xmath3-partial realization will be a complete realization of @xmath7 .",
    "in addition , if @xmath7 is finite , then this sub - matrix will be finite as well .      in order to state the main results rigorously , we need to define formally .",
    "certain finite sub - matrices of the hankel - matrix . to this end ,",
    "recall from definition [ main_result : lin : hank : arb : def ] the definition the hankel - matrix of @xmath7 and of the sets @xmath414 , @xmath415 and @xmath391 .",
    "fix natural numbers @xmath416 .",
    "we will use the following notation for sequences of discrete modes of length at most @xmath55 .",
    "we will denote by @xmath417 the set of all sequences of discrete modes of length at most @xmath55 , i.e. @xmath418 .",
    "notice that @xmath419 is a finite set of cardinality @xmath420 .",
    "we will define the sub - matrix of the hankel - matrix @xmath54 indexed by sequences of bounded length as follows .",
    "[ sect : main_result : sub - hank : def1 ] let @xmath421 be the sub - matrix of @xmath54 formed by the intersections of all the rows indexed by an index of the form @xmath383 with @xmath131 and @xmath422 and all the columns indexed by an index of the form @xmath386 with @xmath393 and @xmath423 .",
    "that is , @xmath424 and for each @xmath425 and @xmath426 , @xmath427    notice that the entries of@xmath421 are made up of markov - parameters of order at most @xmath428 .",
    "hence , if @xmath7 is finite , then the set @xmath429 is finite and the matrix @xmath421 is a finite matrix .",
    "since the entries of the hankel - matrix were defined in terms of the generalized markov - parameters of @xmath7 , the same is true for the entries of @xmath430 .",
    "writing out the definition of the entries of @xmath421 and using the enumeration of @xmath223 fixed in ( [ main_result : lin : hank : arb : def_enum ] ) of definition [ main_result : lin : hank : arb : def ] , we get that for any @xmath394 of the form @xmath431 where @xmath396 and @xmath397 , the entry @xmath432 is defined as follows @xmath433 here @xmath400 and @xmath401 denote the @xmath402th element of the vectors @xmath403 and @xmath404 respectively .",
    "that is , if @xmath7 is finite , then @xmath421 represents a finite collection of markov - parameters of @xmath7 . in turn",
    "the markov - parameters of @xmath7 are defined via the high - order derivatives of the elements of @xmath7 with respect to the switching times .",
    "hence , we get that the entries of @xmath421 are just high - order derivatives with respect to the switching times of the elements of @xmath7 , and the order of these derivatives is bounded by @xmath434 .      as we remarked in the introduction , there are essentially two ways to construct a partial lss   realization . in algorithm [ alg0 ]",
    "we present the first one which is conceptually the simplest one .",
    "assume that @xmath435 and let @xmath436 be a linear isomorphism from the column space of @xmath437 to @xmath123 .",
    "for each column index @xmath438 , _ denote by @xmath439 the column of @xmath437 indexed by @xmath386_.    define the lss   realization @xmath440 as follows .",
    "@xmath441 is a lss   of the form ( [ lin_switch0 ] ) such that    * the state - space of @xmath441 is @xmath123 . * for each mode @xmath225 , the matrix @xmath442 satisfies @xmath443 * for each mode @xmath225 , the matrix @xmath228 satisfies @xmath444 for each @xmath445 .",
    "* for each mode @xmath225 , the matrix @xmath226 is the solution of the system of linear equations @xmath446 if the system of equations ( [ alg0:eq1 ] ) does not have a solution , then abort .    for each input - output map",
    "@xmath13 , @xmath447 return @xmath440 , with @xmath448 .",
    "informally , the realization @xmath440 returned by algorithm [ alg0 ] is defined on an isomorphic copy of the column space of @xmath437 .",
    "the @xmath10th column of the matrix @xmath449 is the isomorphic copy of the column of @xmath437 indexed by @xmath8 .",
    "the matrices @xmath450 are such that if they are interpreted as linear maps , then each @xmath450 maps the isomorphic copy of a column of @xmath437 to its first @xmath451 rows , i.e. rows indexed by @xmath452 , where @xmath193 denotes the empty word .",
    "the matrices @xmath453 realize a shift on the columns of @xmath437 ; by interpreting @xmath453 as a map on the columns of @xmath437 , @xmath453 maps the column indexed by an index @xmath454 to the column indexed by @xmath455 . finally , the value @xmath456 of the map @xmath457 for the input - output map @xmath13 equals the column of @xmath437 indexed by @xmath458 .",
    "notice that algorithm [ alg0 ] may fail to return a realization , as ( [ alg0:eq1 ] ) need not always have a solution .",
    "if @xmath7 consists of finitely many input - output maps , then algorithm [ alg0 ] is a indeed an effective procedure and it can be implemented as a numerical algorithm .",
    "we state the partial - realization theorem as a theorem providing sufficient conditions for algorithm [ alg0 ] to yield a @xmath459-partial , semi - reachable  and observable realization of @xmath7 .",
    "[ part_real_lin : theo1 ] let @xmath7 be a family of input - output maps admitting a generalized kernel representation .",
    "* * existence and computability of a partial realization * +   assume that for some @xmath460 , @xmath461 holds .",
    "then algorithm [ alg0 ] returns a realization @xmath462 , and @xmath440 is a semi - reachable   and observable @xmath459-partial realization of @xmath7 . * * existence of a complete realization * +   if @xmath463 , then ( [ part_real_lin : theo1:eq1 ] ) holds and the @xmath459-partial realization @xmath440 is a minimal realization of @xmath7 .",
    "the condition @xmath463 holds for a given @xmath3 , if there exists a lss   realization @xmath285 of @xmath7 such that @xmath464 .",
    "the proof of theorem [ part_real_lin : theo1 ] is presented in section [ sect : lin_alg ] .",
    "theorem [ part_real_lin : theo1 ] implies that if @xmath7 has a realization by a lss  , then the parameters of a minimal lss   realization of @xmath7 are computable from , and hence are determined by , finitely many time derivatives with respect to the switching times .",
    "[ part_real_lin : theo1:remark ] the numerical example in section [ sect : num ] provides an example of a family of input - output maps @xmath7 realizable by a lss , such that @xmath7 has the following property . for some @xmath3 the family @xmath7 satisfies ( [ part_real_lin : theo1:eq1 ] ) but not the condition @xmath463 .",
    "that is , there is an @xmath0 such that theorem [ part_real_lin : theo1 ] yields a partial realization of @xmath7 which is not a complete realization .",
    "that is , the two statements of theorem [ part_real_lin : theo1 ] indeed describe two separate cases .",
    "theorem [ part_real_lin : theo1 ] allows us to formulate the following characterization of minimal partial lss  realizations .",
    "[ part_real_lin : theo1.1 ] with the notation of theorem [ part_real_lin : theo1 ] , if @xmath7 satisfies ( [ part_real_lin : theo1:eq1 ] ) , then the following holds .    1 .",
    "[ part_real_lin : theo1.1:res1 ] a minimal @xmath459 partial realization of @xmath7 exists , in fact , the realization @xmath440 returned by algorithm [ alg0 ] is a minimal @xmath459 partial realization of @xmath7 .",
    "[ part_real_lin : theo1.1:res2 ] any minimal @xmath459 partial realization of @xmath7 is semi - reachable   and observable and it is of dimension @xmath465 .",
    "[ part_real_lin : theo1.1:res3 ] all minimal @xmath459 partial realizations of @xmath7 are isomorphic .",
    "the proof of theorem [ part_real_lin : theo1.1 ] is presented in section [ sect : lin_alg ] .",
    "the reader might wonder why we talk about @xmath459-partial realizations in theorem [ part_real_lin : theo1 ] and [ part_real_lin : theo1.1 ] .",
    "the reason behind it is that the finite hankel - matrix @xmath437 is formed by values of the markov - parameters of order at most @xmath459 .",
    "we would like the lss  realization obtained from @xmath437 to recreate at least those markov - parameters which are the entries of the matrix @xmath437 . but",
    "this means that the lss  realization obtained from @xmath437 must be a @xmath459-partial realization of @xmath7 .      while algorithm [ alg0 ] is theoretically attractive because of its simplicity , it is not necessarily the most suitable one for numerical implementation . in algorithm [ partreal ]",
    "we present an alternative algorithm for computing a semi - reachable  and observable @xmath459-partial realization of @xmath7 .",
    "the algorithm is based on factorization of the hankel - matrix @xmath466 and it is similar to the kalman - ho algorithm .    compute a decomposition of @xmath466 @xmath467 where @xmath468 and @xmath469 are matrices such that @xmath470 .",
    "recall from ( [ main_result : lin : hank : arb : def_enum ] ) the enumeration of @xmath223 .",
    "for each @xmath225 , @xmath471 , for some @xmath472 define the matrix @xmath473 by @xmath474 where @xmath475 denotes the row of @xmath476 indexed by @xmath6 .    for each @xmath225 , define the matrix @xmath477 by @xmath478 where @xmath479 stands for the column of @xmath480 indexed by @xmath481 for @xmath225 and @xmath364 .",
    "define the map @xmath482 as @xmath483 where @xmath484 stands for the column of @xmath480 indexed by @xmath458 for @xmath13 .",
    "for each @xmath225 let the matrix @xmath485 be the solution of equation @xmath486 where @xmath487 are matrices of the form @xmath488 for all @xmath489 .",
    "that is , @xmath490 is obtained from @xmath476 by deleting all the rows indexed by pairs @xmath383 where @xmath203 is a sequence of discrete modes of length @xmath491 .",
    "the matrix @xmath492 is the shifted version of @xmath476 , i.e. its row indexed by @xmath383 is the row of @xmath476 indexed by @xmath493 .",
    "if there no unique solution to ( [ computepartialreal ] ) then return @xmath494 .",
    "otherwise return @xmath495 where @xmath496 is a lss   of the form @xmath497    the result of algorithm [ partreal ] is described in the theorem below .",
    "[ part_real_lin : theo2 ] with the notation above the following holds .    1 .",
    "[ part_real_lin : theo2:res1 ] assume that form some @xmath25 , ( [ part_real_lin : theo1:eq1 ] ) of theorem [ part_real_lin : theo1 ] holds .",
    "then algorithm [ partreal ] always returns a lss   realization @xmath498 and @xmath498 is a minimal @xmath459-realization of @xmath7 .",
    "in fact , @xmath495 is isomorphic to the lss   realization @xmath440 of theorem [ part_real_lin : theo1 ] .",
    "[ part_real_lin : theo2:res2 ] if for some @xmath499 , @xmath500 , then ( [ part_real_lin : theo1:eq1 ] ) holds , and algorithm [ partreal ] returns a minimal realization @xmath495 of @xmath7 . if there exists a lss   realization @xmath285 of @xmath7 , such that @xmath464 , then @xmath463 holds and the realization @xmath498 returned by algorithm [ partreal ] is a minimal realization of @xmath7 .",
    "the proof of theorem [ part_real_lin : theo2 ] is presented in section [ sect : lin_alg ] .",
    "theorem [ part_real_lin : theo2 ] has immediate consequences for systems identification and model reduction of linear switched systems , by guaranteeing correctness of the realization algorithm described in algorithm [ partreal ] . in section [",
    "sect : concl ] we discuss the potential applications of theorem [ part_real_lin : theo1 ] and theorem [ part_real_lin : theo2 ] in more detail .",
    "there are many algorithms to compute a factorization of @xmath466 and algorithm [ partreal ] can work with any of these algorithms .",
    "in particular , the factorization of @xmath466 can be done through singular value decomposition .",
    "more precisely , assume that @xmath7 is finite , and let @xmath501 be the singular value decomposition of @xmath466 .",
    "notice that if @xmath7 is finite , then the index sets of @xmath466 are finite and the singular value decomposition can be computed by enumerating the index sets of @xmath466 and viewing @xmath466 as a usual finite matrix .",
    "the choice @xmath502 and @xmath503 yields a decomposition @xmath504 satisfying the conditions of algorithm [ partreal ] .",
    "algorithm [ partreal ] has been implemented , and the factorization used in the implementation is precisely the singular value decomposition of @xmath466 .",
    "the goal of this section is to present the proof of theorem [ part_real_lin : theo1 ] , [ part_real_lin : theo1.1 ] , and [ part_real_lin : theo2 ] .",
    "both proofs rely heavily on the relationship between rational representations and lsss   described in @xcite .",
    "the outline of the section is the following .",
    "in subsection [ sect : lin : real ] we will present a short overview of the relationship between rational representations and lsss  .",
    "subsection [ sect : lin : part_real ] presents the proof of theorem [ part_real_lin : theo1 ] , [ part_real_lin : theo1.1 ] , and [ part_real_lin : theo2 ] .",
    "the reader is advised to review appendix [ sect : pow ] and appendix [ sect : pow : part ] before reading this section . throughout the section",
    "we will tacitly use the notation and terminology of appendix [ sect : pow ] and appendix [ sect : pow : part ] .",
    "below we will present a brief overview of the relationship between formal power series and their representations and lsss  . for a more detailed presentation",
    "see @xcite .",
    "informally , the relationship is as follows .    *",
    "let @xmath7 be a family of input - output maps and assume that @xmath7 has a generalized kernel representation .",
    "then we can construct a family of formal power series @xmath505 from the generalized markov - parameters of @xmath7 .",
    "the details of the construction will be presented below .",
    "the family @xmath505 will be referred to as _ the family of formal power series associated with @xmath7_. * if @xmath285 is a lss   realization of @xmath7 , then we can construct a rational representation @xmath506 of @xmath505 from the parameters of @xmath285 .",
    "the converse is also true ; if @xmath480 is a representation of @xmath505 , then we can construct a realization @xmath507 of @xmath7 from the parameters of @xmath480 .",
    "the details of the construction will be presented below .",
    "we will call @xmath506 the _ representation associated with @xmath285 _ and we will call @xmath507 the _ realization associated with @xmath480_.    we will start with defining the family of formal power series @xmath505 associated with @xmath7 . to this end ,",
    "recall from definition [ linswitch_intro : def : markov ] the definition of markov - parameters @xmath377 , @xmath375 of @xmath7 , for each pair of discrete modes @xmath380 , input - output map @xmath13 , index @xmath364 , and a word @xmath372 .",
    "it is easy to see that the maps @xmath508 and @xmath509 define formal power series @xmath510 and @xmath511 in @xmath512 .",
    "recall the enumeration of the set of discrete modes @xmath223 defined in ( [ main_result : lin : hank : arb : def_enum ] ) .",
    "that is , @xmath223 assumed to have @xmath381 elements given by the distinct elements @xmath513 .",
    "for each discrete mode @xmath225 , index @xmath514 , and input - output map @xmath13 define the formal power series @xmath515 as follows ; for each word @xmath372 let @xmath516 that is , the values of the formal power series @xmath517 are obtained by stacking up the values of @xmath518 for @xmath519 .",
    "similarly , the values of @xmath520 are obtained by stacking up the values of @xmath521 for @xmath519 .",
    "define the set @xmath522 .",
    "define the _ indexed set of formal power series associated with @xmath7 _ as the following family of formal power series @xmath523    [ sect : real : hank ] it is easy to see that the hankel - matrix @xmath524 of the family of formal power series @xmath505 is identical to the hankel - matrix @xmath54 of @xmath7 as defined in definition [ main_result : lin : hank : arb : def ]    next we define the rational representation @xmath506 associated with a lss  realization @xmath285",
    ". let @xmath26 be a lss   of the form ( [ lin_switch0 ] ) and assume that @xmath280 is a map assigning to each element @xmath13 an initial state of @xmath26 .",
    "[ sect : real : const1 ] define the _ representation associated with @xmath285 _ as the rational @xmath525 representation @xmath526 the various components of @xmath506 are defined as follows .",
    "* * state - space @xmath102 . *",
    "the state - space of the rational representation @xmath506 is the same as the state - space of @xmath26 , i.e. @xmath527 . *",
    "* alphabet . * the representation @xmath506 is defined over the alphabet which equals the set of discrete modes @xmath223 . * * state - transition maps ( matrix ) @xmath528 .",
    "* for each discrete mode @xmath225 , the corresponding state - transition matrix @xmath453 of @xmath506 is identical to the matrix @xmath453 of @xmath26 .",
    "* * readout matrix ( map ) @xmath529 . * the readout matrix @xmath530 is obtained by vertically `` stacking up '' the matrices @xmath531 in this order from top to bottom .",
    "that is , the @xmath532 matrix @xmath530 is of the form @xmath533 * * initial states*. the indexed set of the initial states of @xmath506 is of the form @xmath534 i.e. it is indexed by the elements of the index set @xmath429 .",
    "its elements are defined by @xmath535 if @xmath2 is an element of the family @xmath7 , and @xmath536 , i.e. @xmath537 is the @xmath538th column of @xmath449 , for all @xmath225 and @xmath539 .",
    "conversely , below we will construct a lss  realization @xmath540 from any rational representation @xmath480 satisfying some mild conditions .",
    "we would like to note that these conditions are automatically satisfied by a suitably chosen isomorphic copy of any rational representation of @xmath505 .",
    "the definition goes as follows .",
    "[ sect : real : const2 ]   + consider a @xmath525 representation @xmath480 of the following form @xmath541 and assume that the following holds .    1",
    ".   the state - space is of the form @xmath220 for some @xmath542 .",
    "does not hold , then replace @xmath480 with the isomorphic copy @xmath543 defined in ( [ repr : euclid : eq1 ] ) , remark [ repr : state_space : rem ] whose state - space is @xmath123 . since @xmath543 and @xmath480 are isomorphic , if @xmath480 is a representation of @xmath505 , then @xmath543 will be a representation of @xmath505 as well . ]",
    "the readout map @xmath530 takes its values in @xmath544 .",
    "the set of initial states @xmath545 of @xmath480 is indexed by the index set @xmath546 .",
    "define the _",
    "lss   realization @xmath507 associated with r _ as follows .",
    "let @xmath547 be of the form ( [ lin_switch0 ] ) , where    * * state - space . * the state - space @xmath123 of @xmath547 is the same as that of @xmath480 .",
    "* * system matrices @xmath548 of @xmath547 . * for each discrete mode @xmath225 , the matrix @xmath453 of @xmath547 is identical to the state - transition matrix @xmath453 of @xmath480 . *",
    "* system matrices @xmath549 of @xmath547 .",
    "* for any discrete state @xmath225 of the form @xmath471 for some @xmath472 and for any @xmath550 , the @xmath538th row of @xmath450 equals the @xmath551-th row of @xmath530 , i.e. @xmath552 * * system matrices @xmath553 of @xmath547 . * for each discrete mode @xmath225 the @xmath136 matrix @xmath449 is obtained as follows ; the @xmath538th column of @xmath449 equals the initial state @xmath554 for all @xmath555 .",
    "that is @xmath556    the map @xmath557 assigns to each element @xmath2 of @xmath7 the initial state of @xmath480 indexed by @xmath2 , i.e. @xmath558    the following theorem states the relationship between representations and realizations formally .    if we apply construction [ sect : real : const1 ] to @xmath540 then the resulting representation @xmath559 coincides with @xmath480 , i.e. @xmath560 .",
    "conversely , if we apply construction [ sect : real : const2 ] , to the representation @xmath506 associated with a lss  realization @xmath285 , then we get @xmath285 back , i.e. @xmath561 , @xmath562 .",
    "[ sect : real : theo1 ] let @xmath7 be a family of input - output maps and assume that @xmath7 admits a generalized kernel representation . with the notation and assumptions above",
    "the following holds .    *",
    "the realization @xmath285 is a lss   realization of @xmath7 if and only if @xmath506 is a rational representation of @xmath505 . *",
    "the representation @xmath480 is a representation of @xmath505 if and only if @xmath507 is a realization of @xmath7 . *",
    "the realization @xmath285 is semi - reachable  if and only if @xmath506 is reachable , and @xmath285 is observable if and only if @xmath506 is observable .",
    "similarly , @xmath507 is semi - reachable  if and only if @xmath480 is reachable , and @xmath540 is observable if and only if @xmath480 is observable . *",
    "if @xmath285 is a minimal realization of @xmath7 , then @xmath506 is a minimal representation of @xmath505 .",
    "conversely , if @xmath480 is a minimal representation of @xmath505 , then @xmath507 is a minimal realization of @xmath7 . *",
    "the map @xmath563 is a lss   morphism if and only if @xmath564 is a representation morphism .",
    "coincides with that of @xmath506 and the state - space of @xmath412 coincides with that of @xmath565 .",
    "hence @xmath5 can indeed be viewed as a representation morphism , provided that it commutes with the matrices of the representations involved ] in addition , @xmath5 is a representation isomorphism if and only if @xmath5 is a lss   isomorphism .",
    "conversely , if the representations @xmath480 and @xmath566 satisfy the assumptions of construction [ sect : real : const2 ] , then @xmath567 is a representation morphism if and only if @xmath568 is a lss  morphism .",
    "moreover , in this case @xmath436 is a representation isomorphism if and only if it is a lss  isomorphism .",
    "the goal of this section is to present the proof of theorem [ part_real_lin : theo1 ] , theorem [ part_real_lin : theo1.1 ] and theorem [ part_real_lin : theo2 ] . before proceeding to the proof",
    ", we will need the following result on the relationship between the partial - realization problem for lsss   and the partial - realization problem for rational representations .",
    "[ part_real_lin : theo1/2 ] assume that @xmath7 is a family of input - output maps admitting a generalized kernel representation .",
    "a lss   realization @xmath285 is an @xmath459-partial realization of @xmath7 if and only of the associated representation @xmath506 is a @xmath459-partial representation of the family of formal power series @xmath505 .",
    "conversely , a representation @xmath480 is a @xmath459-partial representation of the family @xmath505 of formal power series associated with @xmath7 , if and only if the lss  realization @xmath507 associated with @xmath480 is a @xmath459-partial realization of @xmath7 .    the second statement of the theorem follows from the first one by noticing that @xmath569 .",
    "hence , it is enough to prove the first statement of the theorem .",
    "it follows easily from definition [ def : part_real ] and the definition of the formal power series @xmath570 , @xmath13 , @xmath571 , @xmath364 , that @xmath285 is an @xmath459-partial realization of @xmath7 , if and only if for all @xmath572 , @xmath571 , @xmath13 , @xmath364 @xmath573 from the definition of @xmath506 it follows directly that ( [ sect : real : pow : eq3 ] ) is equivalent to @xmath506 being an @xmath459-representation of @xmath505 .",
    "now we are ready to present the proof of theorem [ part_real_lin : theo1 ] .",
    "first , recall from definition [ part_real_pow : submatrix ] the definition of the matrix @xmath574 for some @xmath575 .",
    "it is easy to see that the matrix @xmath53 as defined in definition [ sect : main_result : sub - hank : def1 ] and the matrix @xmath574 coincide , in particular @xmath576 .",
    "recall from remark [ sect : real : hank ] that the matrices @xmath54 and @xmath577 coincide and hence their ranks are equal as well .",
    "we will prove the two statements of the theorem separately .",
    "* proof of existence and computability of a partial realization * + we will apply theorem [ part_real_pow : theo ] to @xmath505 . using the remark above",
    ", the condition ( [ part_real_lin : theo1:eq1 ] ) can be rewritten as ( [ part_theo : eq1 ] ) of theorem [ part_real_pow : theo ] .",
    "consider the @xmath525 representation @xmath578 defined in theorem [ part_real_pow : theo ] .",
    "since ( [ part_theo : eq1 ] ) holds , we get that @xmath579 is well - defined and it is a @xmath459-partial representation of @xmath505 , and @xmath579 is reachable and observable",
    ". consider algorithm [ alg0 ] and the isomorphism @xmath436 defined there .",
    "it is clear that @xmath436 maps the column space of @xmath580 to @xmath123 with @xmath435 .",
    "consider the isomorphic copy @xmath581 of @xmath582 via the morphism @xmath436 , i.e. @xmath583 .",
    "obviously , @xmath581 is also a @xmath459-partial representation of @xmath505 , and it is reachable and observable .",
    "consider now the lss   realization @xmath584 associated with @xmath585 , as defined by construction [ sect : real : const2 ] .",
    "notice that if ( [ part_real_lin : theo1:eq1 ] ) holds , then ( [ alg0:eq1 ] ) of algorithm [ alg0 ] has a unique solution . indeed , ( [ alg0:eq1 ] ) can be rewritten as @xmath586 . here @xmath587 and for each @xmath588 , the column of @xmath480 indexed by @xmath386 is the image @xmath589 of the column of @xmath59 indexed by @xmath386 ; the column of @xmath590 indexed by @xmath386 is the image @xmath591 of the column of @xmath437 indexed by @xmath455 .",
    "the column space of @xmath480 is the column space of @xmath59 by @xmath436 , hence if ( [ part_real_lin : theo1:eq1 ] ) holds , then @xmath592 .",
    "that is , the solution of @xmath593 , if it exists , is unique .",
    "hence , if ( [ part_real_lin : theo1:eq1 ] ) holds , then the lss  realization @xmath440 is uniquely defined by ( [ alg0:eq1]),([alg0:eq-1]),([alg0:eq-2 ] ) and ( [ alg0:eq-3 ] ) , if it exists .",
    "it is easy to see that the lss  realization @xmath584 satisfies ( [ alg0:eq1]),([alg0:eq-1]),([alg0:eq-2 ] ) and ( [ alg0:eq-3 ] ) and hence it coincides with @xmath440 . in other words , the lss  realization @xmath440 returned by algorithm [ alg0 ]",
    "equals the lss  realization @xmath594 associated with the isomorphic copy @xmath581 of @xmath582 , i.e. @xmath595 by theorem [ part_real_lin : theo1/2 ] it follows then that @xmath440 is a @xmath459-partial realization of @xmath7 .",
    "in addition , from theorem [ sect : real : theo1 ] it follows that @xmath440 is semi - reachable  and observable .",
    "* proof of existence of a complete realization * + in addition , from theorem [ part_real_pow : theo ] it follows that if @xmath463 , i.e. @xmath596 , then @xmath579 is a minimal representation of @xmath505 , and hence so is @xmath581 .",
    "but then by theorem [ sect : real : theo1 ] , @xmath597 is a minimal realization of @xmath505 .",
    "finally , assume that there exists a realization @xmath285 of @xmath7 , such that @xmath598 .",
    "consider the representation @xmath599 associated with @xmath285 as defined in construction [ sect : real : const1 ] .",
    "notice that @xmath600 .",
    "then by theorem [ sect : real : theo1 ] , @xmath480 is a representation of @xmath505 . applying theorem [ part_real_pow : theo ]",
    "we get that @xmath601 and hence @xmath602 holds , and that @xmath582 , and hence @xmath581 , is a minimal representation of @xmath505 . again , from theorem [ sect : real : theo1 ] it follows then that @xmath603 is a minimal realization of @xmath7 .",
    "next , we will present the proof of theorem [ part_real_lin : theo1.1 ]    we will prove the statements of theorem [ part_real_lin : theo1.1 ] one by one . notice that if @xmath7 satisfies ( [ part_real_lin : theo1:eq1 ] ) , then the associated family of formal power series @xmath505 satisfies ( [ part_theo : eq1 ] ) .",
    "this allows us to use theorem [ part_real_pow : theo2 ] and theorem [ part_real_lin : theo1/2 ] to prove the statements of the theorem .",
    "* proof of part [ part_real_lin : theo1.1:res1 ] * + from the proof of theorem [ part_real_lin : theo1 ] it follows that the lss  realization @xmath440 is the realization associated with an isomorphic copy of the representation @xmath582 . by the remark above the family @xmath505 associated with @xmath7",
    "satisfies the condition of theorem [ part_real_pow : theo2 ] and hence by theorem [ part_real_pow : theo2 ] the representation @xmath582 is a minimal @xmath459-partial representation of @xmath505 .",
    "then theorem [ part_real_lin : theo1/2 ] implies that @xmath440 is a @xmath3-partial realization of @xmath7 and its dimension is @xmath604 .",
    "it is easy to see that @xmath440 is a minimal @xmath459-partial realization of @xmath7 . for assume",
    "that @xmath285 is a @xmath459-partial realization of @xmath7 .",
    "then by theorem [ part_real_lin : theo1/2 ] the associated representation @xmath506 is a @xmath459-partial representation of @xmath505 , and hence , @xmath605 .    *",
    "proof of part [ part_real_lin : theo1.1:res2 ] * + if @xmath285 is a minimal @xmath459-partial realization of @xmath7 , then from theorem [ part_real_lin : theo1/2 ] it follows that @xmath506 is a minimal @xmath459-partial representation of @xmath505 .",
    "indeed , consider a @xmath459-partial representation @xmath480 of @xmath505 .",
    "using remark [ repr : state_space : rem ] , we can replace @xmath480 by a suitable isomorphic copy , state - space of which is @xmath123 with @xmath606 .",
    "this isomorphic copy will also be a @xmath459-partial representation of @xmath505 .",
    "hence , without loss of generality we can assume that the state - space of @xmath480 is @xmath123 for @xmath606 and hence construction [ sect : real : const2 ] can be applied .",
    "then it follows from theorem [ part_real_lin : theo1/2 ] that @xmath507 is a @xmath459-partial realization of @xmath7 .",
    "hence , @xmath607 by minimality of @xmath285 .",
    "but then by theorem [ part_real_pow : theo2 ] the representation @xmath506 has to be reachable , observable , and of dimension @xmath608 . by theorem [ sect : real : theo1 ] , the latter means that @xmath285 is semi - reachable , observable , and of dimension @xmath465 .",
    "* proof of part [ part_real_lin : theo1.1:res3 ] * + let @xmath285 and @xmath298 be two minimal @xmath459-partial realizations of @xmath7 . using an argument analogous to the one presented in the proof of part [ part_real_lin : theo1.1:res2 ] , one can show that the associated representations @xmath506 and @xmath609 are minimal @xmath459-partial representations of the family @xmath505 of formal power series associated with @xmath7 . from theorem [ part_real_pow : theo2 ]",
    "it follows that @xmath506 and @xmath609 are isomorphic . from theorem [",
    "sect : real : theo1 ] it then follows that @xmath285 and @xmath298 are isomorphic",
    ".    we will continue with the proof of theorem [ part_real_lin : theo2 ]    the proof of the theorem relies on the following observation .",
    "assume that algorithm [ partrepr ] is applied to @xmath505 .",
    "if we use the same factorization algorithm for factorizing the matrix @xmath610 in both algorithm [ partreal ] and algorithm [ partrepr ] , then the following holds .",
    "the equation ( [ computepartialreal ] ) has a unique solution if and only if ( [ computepartialrepr ] ) has a unique solution .",
    "in addition , algorithm [ partreal ] returns a lss   realization if and only if algorithm [ partrepr ] applied to @xmath610 returns a rational representation @xmath611 , and the realization @xmath612 returned by algorithm [ partreal ] is the lss   realization associated with the representation @xmath611 , as defined in construction [ sect : real : const2 ] .",
    "that is , @xmath613 .",
    "* proof of part [ part_real_lin : theo2:res1 ] * + recall that for all @xmath614 , the matrix @xmath421 is identical to @xmath615 , and that the hankel - matrix @xmath54 is identical to @xmath524 .",
    "hence , by applying theorem [ sect : svd : theo1 ] to @xmath616 we get that if ( [ part_real_lin : theo1:eq1 ] ) holds , then algorithm [ partrepr ] returns a @xmath459-partial representation @xmath611 of @xmath505 . then from the discussion above it follows that algorithm [ partreal ] returns a realization @xmath495 and @xmath617 .",
    "then from theorem [ part_real_lin : theo1/2 ] it follows that @xmath495 is a @xmath459-partial realization of @xmath7 .",
    "moreover , theorem [ sect : svd : theo1 ] implies that in this case @xmath611 is isomorphic to the representation @xmath579 from theorem [ part_real_pow : theo ] .",
    "recall from the proof of theorem [ part_real_lin : theo1 ] that the realization @xmath440 from theorem [ part_real_lin : theo1 ] is the realization associated with the isomorphic copy @xmath581 of the representation @xmath579 , as defined in construction [ sect : real : const2 ] .",
    "since @xmath582 and @xmath611 are isomorphic , the representations @xmath581 and @xmath611 are isomorphic as well .",
    "then by theorem [ sect : real : theo1 ] the realizations @xmath612 and @xmath440 are isomorphic as well .",
    "* proof of part [ part_real_lin : theo2:res2 ] * + if @xmath602 , then by theorem [ part_real_lin : theo1 ] , ( [ part_real_lin : theo1:eq1 ] ) holds and @xmath440 is a minimal realization of @xmath7 .",
    "similarly , if there exists a lss   realization @xmath285 of @xmath7 such that @xmath598 , then by theorem [ part_real_lin : theo1 ] , @xmath602 , and ( [ part_real_lin : theo1:eq1 ] ) holds , and @xmath440 is a minimal realization of @xmath7 . by the preceding argument , in both cases algorithm [ partreal ] returns a realization @xmath618 and @xmath618 is isomorphic to @xmath440 .",
    "hence , in both cases the realization @xmath618 returned by algorithm [ partreal ] is a minimal realization of @xmath7 .",
    "in this paper we presented basic results on partial - realization theory lsss .",
    "we also discussed the algorithmic aspects of the theory and presented two algorithms for computing a partial lss  realization .",
    "we have also shown that under suitable conditions , the obtained partial realizations are in fact ( complete ) minimal realizations of the input - output maps at hand .",
    "the paper represents only the first steps towards partial - realization theory of hybrid systems .",
    "a number of problems remains open .",
    "in particular , we would like to extend the results of the current paper to other classes of hybrid systems .",
    "another important research direction is the improvement of the computational complexity of the presented algorithms .    as we mentioned it earlier",
    ", the results of the paper can potentially be useful for the solution of a number of problems , namely , for system identification , model reduction and possibly fault detection and computer vision .",
    "below we will discuss these potential application domains in more detail .    *",
    "systems identification algorithms * + as the history of development of system identification demonstrates , partial - realization theory can be used to design algorithms for system identification . in particular , the famous subspace identification algorithms @xcite rely heavily on partial - realization theory .",
    "in fact , based on the results of the paper one can derive the following crude identification algorithm .",
    "consider a finite family @xmath619 of input - output maps .",
    "we would like to find a lss   realization of @xmath7 .",
    "fix a natural number @xmath3 .",
    "the number @xmath3 may be chosen either based on our belief on the dimension of a potential lss   realization of @xmath7 , or our ability / willingness to make measurements of the system responses for switching sequences up to length @xmath459 .    for each @xmath13 , estimate the first - order time derivatives of @xmath620 and @xmath621 for all sequences of discrete modes @xmath190 of length at most @xmath459 and all discrete modes @xmath371 .",
    "use these estimates to construct the markov - parameters of order up to @xmath459 .",
    "subsequently , use the thus obtained markov - parameters to construct the hankel - matrices @xmath59 , @xmath466 and @xmath437 .",
    "if @xmath622 , then compute the @xmath459 partial realization @xmath623 either by algorithm [ alg0 ] or algorithm [ partreal ] .",
    "it follows immediately from theorem [ part_real_lin : theo1 ] and theorem [ part_real_lin : theo2 ] that if @xmath7 can indeed be realized by a lss  , then for large enough @xmath3 the procedure above will return a minimal lss   realization of @xmath7 .",
    "in fact , if @xmath491 is the dimension of a potential lss  realization of @xmath7 , then the algorithm above always returns a minimal lss  realization of @xmath7 .",
    "the algorithm described above has several drawbacks .",
    "for example , it is unclear how to obtain in practice the derivatives needed to compute the generalized markov - parameters .",
    "another problem that the algorithm does not take into account measurement noise .",
    "the authors are hopeful that these shortcoming can be overcome , as similar problems were successfully dealt with in the case of linear systems .",
    "however , we would like to remark that turning partial - realization theory to practically usable identification algorithms might take considerable amount of time ; in case of linear systems it took several decades .",
    "* spaces of lsss  * + partial realization theory can potentially be useful for studying the geometry and topology of the space of lsss . in turn , the latter is useful for parametric system identification , as it helps to formalize the well - known paradigm of system identification : `` find a model of a certain class which matches the measured data best '' .",
    "in addition , the geometric insights and the resulting notions of distance between systems can be useful for fault detection and computer vision @xcite .",
    "for bilinear systems , the first steps were made in @xcite . for linear systems ,",
    "the topology and geometry of hankel - matrices were investigated in @xcite .",
    "note that spaces of linear systems were also studied using a different approach , namely , by looking at equivalence classes of minimal linear systems under algebraic similarity .",
    "this approach resulted in deep results and insights in the geometry of spaces of systems and important algorithms for parametric identification , see @xcite .",
    "* model reduction * + the presented results on partial - realization theory can also be used for model reduction .",
    "recall from @xcite the moment matching approach to model reduction of linear systems .",
    "the core of this approach is to approximate a high - order to system with a lower order one , such that the lower order system is a a partial realization of a finite number of markov - parameter of the original system . for lsss",
    "the role of markov - parameters ( or moments ) is played by the generalized markov - parameters .",
    "hence , one could try to extend the moment matching approach to lsss   and replace a high - order system with a lower order one which is a partial - realization of a finite sequence of generalized markov - parameters .",
    "of course , a great number of issues needs to be solved .",
    "in particular , obtaining good numerical algorithms will be a challenge .",
    "* extension to more general classes of hybrid systems * + we believe that partial - realization theory for lsss   can be useful for obtaining realization theory , system identification and model reduction for piecewise - affine hybrid systems with guards .",
    "one reason for this is that a piecewise - affine hybrid system with guards can be viewed as a feedback interconnection of a lss   with an event generator .",
    "the former is just the collection of the continuous subsystems of the piecewise - affine hybrid system , the latter is constructed from the guards of the piecewise - affine hybrid system .",
    "understanding the realization theory of one of the components of this feedback loop should help to understand the realization theory of piecewise - affine hybrid systems .",
    "the second reason is that lsss   form a subclass of piecewise - affine hybrid systems . by identifying each lsss   with a piecewise - affine hybrid system whose guards depend only on the choice of inputs .",
    "hence , any result on ( partial- ) realization theory of piecewise - affine hybrid systems should be consistent with the corresponding results for lsss . * acknowledgment * the authors thank pieter collins and luc habets for useful discussions and suggestions .",
    "10    athanasios  c. antoulas and dan  c. sorensen .",
    "approximation of large - scale dynamical systems : an overview .",
    "11(5):10931121 , 2001 . numerical analysis and systems theory ( perpignan , 2000 ) .",
    "j.  berstel and c.  reutenauer . .",
    "springer - verlag , 1984 .",
    "roger  w. brockett .",
    "the geometry of the partial realization problem .",
    ", 17:10481052 , jan . 1978 .",
    "christopher  i. byrnes and norman  e. hurt . on the moduli of linear dynamical systems .",
    "4:83122 , 1979 .",
    "christopher  i. byrnes and anders lindquist . the stability and instability of partial realizations . , 2(2):99105 , 1982/83 .",
    "frank  m. callier and charles  a. desoer . .",
    "springer - verlag , 1991 .",
    "h.  chen and j.m .",
    "new subspace identification method for bilinea systems . technical report cued / finfeng / tr.337 , department of engineering , university of cambridge , 2000 .",
    "k.  de  cock and b.  de  moor .",
    "subspace angles and distances between arma models . in _ proc . of the int .",
    "symposium of math .",
    "theory of networks and systems _ , 2000 .",
    "gianfranco doretto , alessandro chiuso , ying  nian wu , and stefano soatto .",
    "dynamic textures . , 51(2):91109 , 2003 .",
    "samuel eilenberg . . academic press , new york , london , 1974 .",
    "w.  favoreel , b.  de  moor , and p.  van  overschee .",
    "subspace identification of bilinear systems subject to white inputs .",
    "technical report tr 1996 - 531 , esat , katholieke univesiteit leuven , 1996 .",
    "m.  fliess .",
    "matrices de hankel . , ( 23):197  224 , 1973 .",
    "m.  fliess .",
    "functionnelles causales non linaires et indtermines non commutatives . , ( 109):2  40 , 1981 .",
    "f.  gcseg and i  pek . .",
    "akadmiai kiad , budapest , 1972 .",
    "dieter gollmann .",
    "partial realization by discrete - time internally bilinear systems : an algorithm . in _ mathematical theory of networks and systems , proc .",
    ", beer sheva / isr .",
    "1983 _ , 1983 .",
    "william  b. gragg and anders lindquist .",
    "on the partial realization problem . , 50:277319 , 1983 .",
    "e.  j. grimme . .",
    "phd thesis , univ .",
    "illinois , urbana champaign , 1997 .",
    "e.  j. grimme , d.  c. sorensen , and p.  van  dooren . model reduction of state space systems via an implicitly restarted lanczos method .",
    ", 12(1 - 2):131 , 1996 .",
    "b.  hanzon .",
    "riemannian geometry on families of linear systems , the deterministic case .",
    "technical report 88 - 62 , delft university of technology , faculty of mathematics and informatics , 1988 .",
    "b.  hanzon . , volume  63 of _ cwi",
    "tract_. cwi , amsterdam , 1989 .",
    "b.  hanzon . on the differentiable manifold of fixed order stable linear systems .",
    ", 13:345  352 , 1989 .",
    "m.  hazewinkel .",
    "moduli and canonical forms for linear dynamical systems iii : the algebraic - geometric case . in c.",
    "martin and r.  hermann , editors , _ the 1976 ames research center ( nasa ) conference on geometric control theory _ , pages 229276 .",
    "brookline , mass . : math sci press 1977 .",
    "m.  hazewinkel .",
    "moduli and canonical forms for linear dynamical systems ii : the topological case .",
    ", 10:363385 , 1977 .",
    "u.  helmke and d.  hinrichsen .",
    "canonical forms and orbit spaces of linear systems . , 3:167  184 , 1986 .",
    "u.  helmke , d.  hinrichsen , and w.  manthey . a cell decomposition of the space of real hankel matrices of rank @xmath624 and some applications .",
    ", 122/123/124:331355 , 1989 .",
    "d.  hinrichsen , w.  manthey , and d.  prtzel - wolters .",
    "the bruhat decomposition of finite hankel matrices .",
    ", 7(3):173182 , 1986 .",
    "diederich hinrichsen and wilfried manthey .",
    "on a cell decomposition for hankel matrices and rational functions .",
    ", 451:1550 , 1994 .",
    "b.  l. ho and r.  e. kalman .",
    "effective construction of linear state - variable models from input / output data . in _ proc .",
    "third annual allerton conf . on circuit and system theory _ , pages 449459 .",
    "illinois , urbana , ill . , 1965 .",
    "a.  isidori .",
    "direct construction of minimal bilinear realizations from nonlinear input - output maps . , pages 626631 , 1973 .",
    "alberto isidori . .",
    "springer verlag , 1989 .",
    "alberto isidori , paolo dalessandro , and antonio ruberti .",
    "realization and structure theory of bilinear dynamical systems .",
    ", 12(3 ) , 1974 .",
    "nathan jacobson .",
    ", volume ii : linear algebra .",
    "d. van nostrand company , inc .",
    "new york , 1953 .",
    "r.  e. kalman , p.  l. falb , and m.  a. arbib . .",
    "mcgraw - hill book co. , new york , 1969 .",
    "w.  kuich and a.  salomaa . .",
    "springer - verlag , 1986 .",
    "daniel liberzon . .",
    "birkhuser , boston , 2003 .    wilfried manthey and uwe helmke .",
    "bruhat canonical form for linear systems . , 425(2 - 3):261282 , 2007 .",
    "r.  martin .",
    "a metric for arma processes .",
    ", 48(4):11641170 , 2000 .",
    "ralf peeters . .",
    "phd thesis , free university , amsterdam , 1994 .",
    "mihaly petreczky .",
    "realization theory for bilinear hybrid systems . in _ in proceedings 11th ieee international conference on methods and models in automation and robotics _ ,",
    "mihaly petreczky .",
    "realization theory for bilinear switched systems . in _ proc .",
    "of 44th ieee conference on decision and control _ , 2005 .",
    "mihaly petreczky .",
    "realization theory for linear and bilinear hybrid systems .",
    "technical report mas - r0502 , cwi , 2005 .",
    "mihaly petreczky .",
    "realization theory of linear and bilinear switched systems : a formal power series approach .",
    "technical report mas - r0403 , cwi , 2005 . to appear in esaim control , optimization and calculus of variations , doi 10.1051/cocv/2010014 and doi 10.1051/cocv/2010015 .",
    "mihly petreczky .",
    "hybrid formal power series and their application to realization theory of hybrid systems . in _",
    "proceedings 17th international symposium on mathematical theory of networks and systems _ , 2006 .",
    "mihaly petreczky . .",
    "phd thesis , vrije universiteit , amsterdam , 2006 .",
    "available at ` http://www.cwi.nl/~mpetrec ` .",
    "mihaly petreczky .",
    "realization theory for linear switched systems : formal power series approach .",
    ", 56(9  10):588595 , 2007 .",
    "mihly petreczky and ren vidal .",
    "metrics and topology for nonlinear and hybrid systems . in _ hybrid systems : computation and control _",
    ", pages 459472 , 2007 .",
    "mihaly petreczky and rene vidal .",
    "realization theory of stochastic jump - markov linear systems . in _",
    "proceedings 46th ieee conference on decision and control _ , 2007 .",
    "d.  eduardo sontag . a remark on bilinear systems and moduli spaces of instantons .",
    ", 9(5):361367 , 1987 .",
    "eduardo  d. sontag .",
    ", volume  13 of _ lecture notes in control and information sciences_. springer verlag , 1979 .",
    "eduardo  d. sontag .",
    "realization theory of discrete - time nonlinear systems : part i  the bounded case . ,",
    "cas-26(4 ) , april 1979 .",
    "zhendong sun and shuzhi  s. ge . .",
    "springer , london , 2005 .",
    "a.  tether .",
    "construction of minimal linear state - variable models from finite input - output data .",
    ", 15(4):427 436 , 1970 .",
    "van overschee and b.  de moor . .",
    "kluwer academic publishers , 1996 .",
    "s.  v.  n. vishwanathan , alexander  j. smola , and ren vidal .",
    "binet - cauchy kernels on dynamical systems and its application to the analysis of dynamic scenes .",
    ", 73(1):95119 , 2007 .",
    "the section recalls basic results on formal power series .",
    "the material of this section is based on the classical theory of formal power series , see @xcite",
    ". however , a number of concepts and results are extensions of the standard ones to families of formal power series .",
    "the outline of the section is the following .",
    "in subsection [ sect : pow : def ] we present the basic concepts for formal power series . in subsection",
    "[ sect : pow : rat_repr ] we present the notion of a rational representation of a family of formal power series . in subsection",
    "[ sect : pow : main ] we state the main result on existence and minimality of a rational representation of a family of formal power series .",
    "let @xmath185 be a finite set , which we will refer to as the alphabet .",
    "recall from section [ sect : prelim : lang ] the notion of a finite word over an alphabet and the related notation .",
    "a _ formal power series _",
    "@xmath5 with coefficients in @xmath232 is a map @xmath625 there are many ways to give an intuition for the definition of a formal power series . for the purposes of this paper ,",
    "the most suitable one is to think of a formal power series as an output of a machine defined as follows .",
    "the machine reads symbols belonging to @xmath185 from its input tape and writes elements of @xmath232 onto its output tape .",
    "we denote by @xmath626 the set of all formal power series with coefficients in @xmath232 .",
    "the set of all formal power series over @xmath185 with coefficients in @xmath232 forms a vector space with respect to point - wise addition and multiplication .",
    "that is , if @xmath627 are two scalars and @xmath628 are two formal power series , then the linear combination @xmath629 is defined as the formal power series assigning each word @xmath197 the value @xmath630 . in the sequel we will mostly be interested in _ families of formal power series_.    let @xmath127 be an arbitrary ( possibly infinite ) set .",
    "family of formal power series in @xmath631 indexed by @xmath127 _ is simply a collection @xmath632 of formal power series from @xmath633 indexed by elements of @xmath127 .",
    "notice that the definition above does not require @xmath634 , @xmath132 to be all distinct formal power series , i.e. @xmath635 for some indices @xmath636 , @xmath637 is allowed .",
    "one can think of a family of formal power series as a family of input - output maps of the machine ( discrete - time system ) described above , realized from a set of initial states indexed by elements of @xmath127 .",
    "we would like to point out that the notion of ( family of ) formal power series is a purely formal one , the interpretation of them as input - output maps is just one of the many possible interpretations .",
    "above we have defined the notion of a formal power series and a family of formal power series and we have related these notions to input - output maps of some systems . below we will recall the notion of a _ rational representation _ , which can be thought of as a special subclass of these systems .",
    "we will also define morphisms between rational representations along with a notion of observability and reachability .",
    "[ sect : pow : rat_rep : def0 ] let @xmath127 be an arbitrary set and let @xmath638 .",
    "a _ rational representation of type @xmath451-@xmath127 over the alphabet @xmath185 _ is a tuple @xmath639 where    * the space @xmath102 is a finite dimensional vector space over @xmath106 , called _ state - space _ of @xmath480 , * for each letter @xmath640 , @xmath641 is a linear map , referred to as the _ state - transition map _ * the map @xmath642 is a linear map , referred to as the _ readout map _ , * the family @xmath643 is a collection of ( not necessarily distinct ) elements of @xmath102 indexed by @xmath127 .",
    "if @xmath451 and @xmath127 are clear from the context , then we will refer to @xmath480 simply as a _",
    "rational representation_.    the dimension @xmath644 of the state - space is called the _ dimension _ of the representation @xmath480 and it is denoted by @xmath645 .",
    "notice that if a basis of @xmath102 is fixed and @xmath646 , then the state - transition maps @xmath647 , @xmath640 and the readout map @xmath648 can be identified with their matrix representations in this basis , and for each @xmath132 , @xmath649 can be identified with the @xmath123 column vector of its coordinates .",
    "if @xmath220 , then we will identify the linear maps @xmath647 , @xmath640 and @xmath648 with their matrix representations in the standard orthogonal basis of @xmath123 . in this case",
    "we will call them the _ state - transition matrices _ and the _ readout matrix _ respectively .    [ sect : pow : rat_rep : def-1 ] let @xmath650 be a family of formal power series indexed by @xmath127 . the representation @xmath480 from ( [ repr : def0 ] ) is said to be a _ representation of @xmath651 _ , if for each index @xmath132 , for all sequences @xmath652 , @xmath241 , @xmath653 we will say that a family of formal power series @xmath632 is _ rational _ , if there exists a representation @xmath480 such that @xmath480 is a representation of @xmath651 .    [",
    "repr : not1 ] the following notation will greatly simplify the expressions used for rational representations . let @xmath654 be linear maps and let @xmath655 , @xmath656 , @xmath241 , be a word over @xmath185 . then @xmath657 denotes the composition of the linear maps @xmath658 in that order , that is @xmath659 if @xmath208 is the empty words , then @xmath660 is taken to be the identity map .    with the notation above , ( [ repr : def1 ] ) can be rewritten as @xmath661 for all @xmath197 , @xmath132 .",
    "notice that if @xmath220 for some @xmath662 , and hence the state - transition maps @xmath647 can be viewed as matrices , then ( [ repr : eq2 ] ) defines a notation for products of the state - transition matrices taken along the word @xmath190 .",
    "a representation @xmath663 of @xmath651 is called _ minimal _ , if for each representation @xmath480 of @xmath651 , @xmath664 , i.e. @xmath663 is a rational representation of @xmath651 with the smallest possible state - space dimension",
    ".    we will continue with presenting the notions of _ observability _ and _ reachability _ for rational representations .",
    "define the subspaces @xmath665 and @xmath666 of @xmath102 by @xmath667 that is , the subspace @xmath665 is the linear span of the elements of the state - space of the form @xmath668 , where @xmath190 runs through all words over @xmath185 and @xmath10 runs through all the indices in @xmath127 .",
    "the space @xmath666 is the intersection of the null - spaces ( kernels ) of all the linear maps @xmath669 , where @xmath190 runs through the set of all words @xmath186 .",
    "[ reach : rep : def ] we will say that the representation @xmath480 is _ reachable _ if @xmath670 . the subspace @xmath665 will be referred to as the _ reachability subspace of @xmath480_.    [ obs : rep : def ] we will say that @xmath480 is _ observable _ if @xmath671 , i.e. @xmath666 consists of the zero element only . the subspace @xmath666 will be referred to as the _ observability subspace of @xmath480_.    next , we define the notion of morphism between rational representations .",
    "let @xmath672 , @xmath673 be two @xmath451-@xmath127 rational representations .",
    "a linear map @xmath674 is called a _ representation morphism _ from @xmath480 to @xmath675 and is denoted by @xmath676 if @xmath436 commutes with @xmath647 , @xmath649 and @xmath648 for all @xmath132 , @xmath640 , that is , if the following equalities hold @xmath677 the representation morphism @xmath436 is called _ surjective , injective , isomorphism _ if @xmath436 is a surjective , injective or isomorphism respectively if viewed as a linear map .",
    "[ repr : state_space : rem ] if @xmath678 is a representation of @xmath651 , then for any vector space isomorphism @xmath679 , @xmath606 , the tuple @xmath680 where @xmath681 is also a representation of @xmath651 .",
    "moreover , for all @xmath640 , @xmath682 can be naturally viewed as a matrix by taking its matrix representation with respect to the natural basis of @xmath123 .",
    "similarly , by taking matrix and vector representations of @xmath683 and @xmath684 , @xmath132 in the natural basis of @xmath123 , we can view @xmath683 and @xmath684 , @xmath132 as a @xmath685 matrix and @xmath686 vector respectively .",
    "moreover , @xmath687 is a representation isomorphism .",
    "that is , we can always replace a representation of @xmath651 with an isomorphic representation , state - space of which is @xmath123 for some @xmath138 , and the parameters of which are matrices and real vectors , as opposed to linear maps and elements of abstract vector spaces .",
    "moreover , isomorphisms clearly preserve such properties as observability , reachability , and minimality .",
    "the purpose of the section is to state the main results on existence and minimality of representations of families of rational formal power series .",
    "we will start by stating the main result on the existence of a rational representation .",
    "however , in order to state the main theorem , we need to define the concept of the _ hankel matrix _ of a family of formal power series .",
    "let @xmath632 be a family of formal power series .",
    "recall the notation of section [ sect : prelim : not_matrix ] .",
    "[ sect : pow : hank : def0 ] define the _ hankel - matrix _ of @xmath651 as the following infinite matrix @xmath688 .",
    "the rows of @xmath688 are indexed by pairs @xmath383 where @xmath198 is an arbitrary word and @xmath689 .",
    "the columns of @xmath688 are indexed by pairs @xmath386 where @xmath197 is a word over @xmath185 and @xmath132 runs through the elements of @xmath127 .",
    "the set of all real infinite matrices with the indexing the rows and columns described above will be denoted by @xmath690 where @xmath691 .",
    "hence , we can write @xmath692 . the entry of @xmath688 lying on the intersection of the row indexed by @xmath383 and the column indexed by @xmath386",
    "is defined as @xmath693 where @xmath694 denotes the @xmath695 entry of the column vector @xmath696 .    according to the convention adopted in section [ sect : prelim : not_matrix ] , we define the _ rank of @xmath688 , denoted by @xmath697 _ , as the dimension of the vector space spanned by the columns of @xmath688 . with the notation above the following theorem holds .",
    "[ sect : form : theo1 ] the family @xmath651 is rational , i.e. admits a rational representation , if and only if @xmath698 , i.e. the rank of the hankel - matrix @xmath688 is finite .",
    "the proof of the above theorem can be found in @xcite . as the next step we will present below the main result on minimality of rational representations .    [",
    "sect : form : theo3 ] let @xmath699 be a family of formal power series .",
    "the following are equivalent .    *",
    "@xmath663 is a minimal representation of @xmath651 .",
    "* @xmath663 is reachable and observable . *",
    "if @xmath480 is a reachable representation of @xmath651 , then there exists a surjective representation morphism @xmath700 . *",
    "@xmath701 .",
    "in addition , all minimal representations of @xmath651 are isomorphic .",
    "the proof of the above theorem can be found in @xcite .",
    "the counterpart of the above two theorems , i.e. theorem [ sect : form : theo1 ] and [ sect : form : theo3 ] , for a single formal power series is a classical result , see @xcite .",
    "below we will formulate and solve the counterpart of the partial realization problem for families of formal power series .",
    "we use the obtained result to derive a solution to the partial realization problem for linear switched systems formulated in problem [ prob : part : real ] .",
    "we start with defining the notion of a @xmath3-partial representation .",
    "let @xmath632 be a family of formal power series indexed by @xmath127 . a @xmath127-@xmath451 representation @xmath702 , with @xmath643 is said to be an _ @xmath3-partial representation of @xmath651 _",
    "if for each index @xmath132 and each word @xmath197 of length at most @xmath3 , i.e. @xmath703 , @xmath704    that is , if @xmath480 is a @xmath3-partial representation of @xmath651 , then @xmath480 recreates the values of the elements of @xmath651 for all the words of length at most @xmath3 .",
    "now we are ready to formulate the partial - realization problem for formal power series .",
    "* find conditions for existence of a @xmath3-partial representation of @xmath651 .",
    "formulate an algorithm for computing a @xmath3-partial representation of @xmath651 . *",
    "characterize minimal @xmath3-partial representations of @xmath651 , their existence and uniqueness .",
    "* find conditions under which the @xmath3-partial representation above becomes a rational representation of @xmath651 in the sense of definition [ sect : pow : rat_rep : def0 ] .",
    "we will devote the rest of the section to solving the problem described above .",
    "the outline of the section is the following .",
    "subsection [ part : form : main_results ] presents the main results on partial - realization theory of families of formal power series , along with a kalman - ho - like algorithm for computing a minimal partial representation .",
    "subsection [ app : proof ] presents the proof of the results presented in subsection [ part : form : main_results ] . throughout the section",
    ", @xmath651 will denote the family of formal power series @xmath705 .",
    "the goal of the section is to present the main results on partial - realization theory of families of formal power series .",
    "note that partial - realization theory of a single formal power series is more or less equivalent to partial - realization theory of bilinear and state - affine systems .",
    "the latter was already investigated in @xcite .",
    "the results to be presented below represent an extension of the results of @xcite .",
    "in addition , here we state partial - realization theory directly for formal power series .",
    "this is in contrast to @xcite , where the partial - realization problem and solution were stated in terms of state - affine or bilinear systems .",
    "the outline of the section is the following .",
    "subsection [ part : form : theo ] presents the statement of the main results on partial realization theory for formal power series .",
    "subsection [ part : form : svd ] presents an algorithm for computing a partial representation , which is similar to the well - known kalman - ho algorithm for the linear systems .",
    "we will start with defining the upper - left block matrix of @xmath688 which is indexed by words over @xmath185 of finite length .",
    "more precisely , fix natural numbers @xmath706 and define the following sets @xmath707 intuitively , @xmath708 is a subset of the row indices of the hankel - matrix @xmath688 , made up of indices of the form @xmath383 , where @xmath203 runs through all the words of length at most @xmath128 .",
    "similarly , the set @xmath709 is a subset of column indices of @xmath688 , made up of column indices @xmath386 where @xmath190 runs through all the words of length at most @xmath56 .",
    "the set @xmath709 is the set of columns indices of the matrix to be defined , and @xmath710 is the set of row indices of this matrix .        it turns out that under certain circumstances partial representations not only exist but they also yield a minimal representation of the whole family of formal power series .",
    "moreover , such partial representations can be constructed from finite data .      1 .",
    "[ part_theo : part1 ] if for some @xmath718 , @xmath719 then there exists a @xmath459-partial representation @xmath579 of @xmath651 , of the form @xmath720 where the parameters of @xmath579 are defined as follows . for each word @xmath197 , @xmath721 , and each index @xmath132 denote by @xmath722 the column of @xmath723 indexed by @xmath386 . with this notation ,",
    "* @xmath724 denotes the linear space spanned by the columns of @xmath723 . * for each @xmath640 , the linear map @xmath725 has the property that for each word @xmath197 , @xmath703 and each index @xmath132 @xmath726 i.e. @xmath647 maps the column indexed by @xmath727 to the column indexed by @xmath728 .",
    "* for each @xmath197 , @xmath721 and @xmath132 , the linear map @xmath729 satisfies , @xmath730 that is , @xmath648 maps each column to the vector in @xmath232 formed by the first @xmath451 entries associated with @xmath205 of the column indexed by @xmath386 . * the set @xmath731 is defined by @xmath732 i.e. @xmath649 is simply the column of @xmath723 indexed by @xmath733 . + in addition , the representation @xmath579 is reachable and observable .",
    "[ part_theo : part2 ] if for some @xmath499 @xmath734 then ( [ part_theo : eq1 ] ) holds and the representation @xmath579 from ( [ part_theo : eq3 ] ) is a minimal representation of @xmath651 .",
    "[ part_theo : part3 ] if @xmath480 is a representation of @xmath651 , @xmath735 , then ( [ part_theo : eq2 ] ) holds for @xmath3 and the representation @xmath579 from ( [ part_theo : eq3 ] ) exists and it is a minimal representation of @xmath651 .",
    "the proof of theorem [ part_real_pow : theo ] is presented in appendix [ app : proof ] .",
    "using the results of theorem [ part_real_pow : theo ] we can state the following characterization of minimal partial representations of @xmath651 .      1 .",
    "[ part_real_pow : theo2:res1 ] a minimal @xmath459 partial representation of @xmath651 exists , in fact , the representation @xmath582 of theorem [ part_real_pow : theo ] is a minimal @xmath459 partial representation of @xmath651 .",
    "[ part_real_pow : theo2:res2 ] any minimal @xmath459 partial representation of @xmath651 is reachable and observable and it is of dimension @xmath736 .",
    "[ part_real_pow : theo2:res3 ] all minimal @xmath459 partial representations of @xmath651 are isomorphic .      the reader might wonder why we speak of @xmath459-partial representations in theorem [ part_real_pow : theo ] and [ part_real_pow : theo2 ] .",
    "the reason behind it is that the finite hankel - matrix @xmath723 is formed by values of the formal power series from @xmath651 for words of length at most @xmath459 .",
    "we would like the representation obtained from @xmath723 to recreate at least the entries of the matrix @xmath723 . but this means precisely that the representation obtained from @xmath723 should be a @xmath459-partial representation of @xmath651 .      in this section we present an algorithm , described in algorithm [ partrepr ] , which computes a partial representation by factorizing the hankel - matrix .",
    "the technique of hankel - matrix factorization has been used in realization theory and systems identification for several decades .",
    "it forms the theoretical basis of algorithms for subspace identification , see for example @xcite . throughout the section",
    ", @xmath651 stands for the family of formal power series @xmath705 .",
    "define the family of vectors @xmath745 , where for each @xmath132 , @xmath746 where @xmath747 stands for the column of @xmath480 indexed by @xmath733 .",
    "for each @xmath640 let @xmath748 be the solution of @xmath749 where @xmath750 are matrices of the form @xmath751 for all @xmath752 .",
    "if there no unique solution to ( [ computepartialrepr ] ) then return @xmath753 .",
    "otherwise return @xmath754    algorithm [ partrepr ] represents an algorithm based on matrix factorization of @xmath737 .",
    "in addition , if @xmath3 is large enough , algorithm [ partrepr ] in fact yields a minimal representation of @xmath651 . algorithm [ partrepr ] above may return two different types of data .",
    "it returns a rational representation if ( [ computepartialrepr ] ) has a unique solution , and the symbol @xmath753 otherwise .    in step",
    "[ alg : svd : step1 ] of algorithm [ partrepr ] above one can use any algorithm for computing a factorization .",
    "for example , one could use svd decomposition , in which case @xmath755 , and @xmath756 , @xmath757 is a valid choice for decomposition .        1 .",
    "[ sect : svd : theo1:part1 ] assume that form some @xmath25 @xmath759 then algorithm [ partrepr ] always returns a formal power series representation @xmath611 and @xmath611 is an @xmath459-partial representation of @xmath651 .",
    "in fact , the representation @xmath579 from theorem [ part_real_pow : theo ] and @xmath611 are isomorphic .",
    "hence , @xmath760 is a minimal @xmath459-partial representation of @xmath651 , it is reachable and observable .",
    "[ sect : svd : theo1:part2 ] if for some @xmath499 , @xmath761 then ( [ sect : svd : theo1:eq1 ] ) holds , and algorithm [ partrepr ] returns a minimal representation @xmath611 of @xmath651 .",
    "[ sect : svd : theo1:part3 ] assume @xmath762 , or , equivalently , there exists a representation @xmath480 of @xmath651 , such that @xmath735 .",
    "then ( [ sect : svd : theo1:eq2 ] ) holds and the representation @xmath611 returned by algorithm [ partrepr ] is a minimal representation of @xmath651 .    although solution to ( [ computepartialrepr ] ) need not always exist , one can always take a matrix @xmath763 , @xmath640 as a solution to the minimization problem @xmath764 .",
    "then @xmath763 can be obtained using standard numerical techniques for solving approximation problems . with this modification",
    ", the algorithm can be applied even if ( [ sect : svd : theo1:eq1 ] ) fails .",
    "however , the representation returned by the modified algorithm need not be a @xmath459-partial representation in this case .",
    "the goal of the section is to present the proof of theorem [ part_real_pow : theo ] , [ part_real_pow : theo2 ] and [ sect : svd : theo1 ] . in subsection [ part_pow_pf : prelim ]",
    "we will introduce some notation and state some preliminary results , which will be needed for the proof of the theorems . in subsection",
    "[ part_pow_pf : pf ] we will present the proof of theorem [ part_real_pow : theo][sect : svd : theo1 ] . finally , in subsection [ part_pow_pf : aux ] we will present the proof of the technical results which are used for the proof of the theorems [ part_real_pow : theo][sect : svd : theo1 ] .      to begin with , for the purposes of partial realization theory , we need to recall some basic steps of the proof of theorem [ sect : form : theo1 ] . to this end",
    ", we have to introduce additional notation and terminology .",
    "let @xmath197 be a word over @xmath186 and let @xmath765 be a formal power series . define the formal power series @xmath766 , called the _ left shift of @xmath5 by @xmath190 _ , as follows ; we require that for all @xmath198 the value of @xmath767 at @xmath203 is as follows @xmath768 i.e. the value of @xmath767 at @xmath203 equals the value of @xmath5 at @xmath769 .",
    "notice that for any word @xmath197 of the form @xmath770 , @xmath771 and for any formal power series @xmath772 , the following equality holds @xmath773 moreover , notice that the shift operation is linear , that is , for any @xmath774 , and for any scalars @xmath177 , and for any word @xmath197 , @xmath775 .",
    "[ sect : form : def1 ] let @xmath632 be a family of formal power series .",
    "define the _ the smallest shift invariant linear space containing all the elements of @xmath651 _ , denoted by @xmath776 , as the following subspace of @xmath633 , @xmath777 that is , @xmath776 is composed of the linear combinations of all formal power series of the form @xmath778 for some @xmath132 and @xmath197 .    [ sect : form : def1:rem1 ] it is easy to see that there is one - to - one correspondence between the formal power series @xmath778 and the column of @xmath688 indexed by @xmath386 for any word @xmath197 and index @xmath132 . in particular , it follows that @xmath776 is isomorphic to the span of columns of @xmath688 and hence @xmath779      [ sect : form : theo1:lemma1 ] assume that @xmath780 holds .",
    "then a representation @xmath781 of @xmath651 is given by @xmath782 where for each letter @xmath640 , the map @xmath783 is defined as the shift by @xmath784 , i.e. for each @xmath785 , @xmath786 ; the collection @xmath787 is formed by the elements of @xmath651 , that is @xmath788 for each @xmath132 ; the linear map @xmath789 is defined as the evaluation at the empty word , i.e. @xmath790 for all @xmath785 .",
    "using the lemmas above the proof of theorem [ sect : form : theo1 ] becomes trivial .",
    "for the sake of completeness we present it below . from remark",
    "[ sect : form : def1:rem1 ] it follows that @xmath792 .",
    "if @xmath793 , then lemma [ sect : form : theo1:lemma1 ] implies that @xmath781 is a well - defined representation of @xmath651 , hence @xmath651 is rational .",
    "conversely , if @xmath651 is rational then lemma [ sect : form : theo1:lemma2 ] implies that @xmath794 .          we will start with defining the space @xmath797 of formal power series which corresponds to the subset of columns of @xmath688 indexed by indices of the form @xmath386 with @xmath132 and @xmath798",
    "define the vector space @xmath797 as the sub - space of @xmath776 spanned by all formal power series of the form @xmath778 with @xmath132 and @xmath798 , i.e. @xmath799 _ notice that if @xmath127 is finite , then @xmath797 is generated by finitely many elements_. the motivation for considering the space @xmath797 is revealed by the following lemma and its corollary .",
    "[ part_pow : lemma1 ] assume that @xmath800 . for any formal power series @xmath785 and any word @xmath197",
    ", there exists scalars @xmath801 , and words @xmath802 such that @xmath803 that is , the shift of @xmath84 by @xmath190 is a linear combination of the shifts of @xmath84 by words of the length at most @xmath804 .",
    "the proof of corollary [ part_pow : pf1:col1 ] will be presented in subsection [ part_pow_pf : aux ] . in other words ,",
    "if @xmath3 is big enough , then @xmath806 generates the whole space @xmath776 .",
    "alternatively , stated in the language of hankel - matrices , the columns of @xmath688 indexed by words of length at most @xmath3 span the whole image of @xmath688 .",
    "although @xmath797 is generated by finitely many elements , if @xmath127 is finite , its elements are formal power series which contain infinite amount of data . in order to replace @xmath797 by a space generated by finite vectors , we proceed as follows .",
    "we will define a linear space @xmath807 which plays a similar role for @xmath808 as @xmath776 does for @xmath688 . similarly to @xmath776 , the elements of @xmath807 are maps mapping words over @xmath185 to vectors in @xmath232 .",
    "however , in contrast to @xmath776 , the elements of @xmath807 will be defined only on the words of length at most @xmath128 . similarly to @xmath776 , the space @xmath807 will allow us to prove our main results for the finite hankel sub - matrices @xmath808 in a more intuitive way .          as the next step ,",
    "define the map @xmath812 projecting any formal power series to its restriction to @xmath813 , i.e. for each formal power series @xmath772 , @xmath814 it is easy to see that @xmath815 is a surjective linear map .",
    "define the vector space @xmath816 by @xmath817 it is easy to see that @xmath807 is the image of @xmath797 by @xmath815 .",
    "the relationship between @xmath807 and @xmath808 can be best described as follows ; the generator set of @xmath807 is formed by the columns of @xmath808 .",
    "more precisely , recall from subsection [ sect : prelim : not_matrix ] that @xmath818 denotes the vector space of all maps from @xmath710 to @xmath106 .",
    "define the map @xmath819 by @xmath820 where @xmath821 stands for the @xmath394th entry of the vector @xmath822 .",
    "it is easy to see that @xmath823 is a linear isomorphism .",
    "moreover , @xmath824 .",
    "in particular ,      finally , we will show that if @xmath651 is rational and @xmath128 is big enough , then the restriction of @xmath826 to @xmath776 is injective .",
    "it means then that @xmath807 and @xmath797 are isomorphic for all @xmath3 , if @xmath128 is large enough .",
    "* proof of part [ part_theo : part1 ] * we will define a @xmath459 partial representation @xmath828 of @xmath651 on the linear space @xmath829 .",
    "the representation @xmath828 will be reachable and observable and will satisfy a number of properties .    to this end , define the map @xmath830 by requiring that for all @xmath831 and for each word @xmath798 , @xmath832 it is easy to see @xmath833 is a surjective linear map .",
    "moreover , @xmath833 maps the sub - space @xmath834 onto @xmath829 . using corollary [ part_pow : pf3:col3 ] , ( [ part_theo : eq1 ] )",
    "can be rewritten as @xmath835 but ( [ part_pow : pf4 ] ) implies that @xmath836 and that the restriction of @xmath833 to @xmath829 is injective .",
    "the latter means that the inverse map @xmath837 exists .",
    "* for each letter @xmath640 , the linear map @xmath839 is defined as follows .",
    "consider the map @xmath840 defined by @xmath841 , for all @xmath842 and @xmath843 .",
    "it is easy to see that @xmath844 is a linear map .",
    "in addition , if @xmath845 for some @xmath798 , @xmath132 , then @xmath846 .",
    "indeed , for any @xmath842 , @xmath847 . hence , because of linearity of @xmath844 , the range of @xmath844 is @xmath848 and thus @xmath844 can be viewed as a map @xmath849 . +",
    "then for all @xmath850 , define @xmath851 it is easy to see that @xmath852 is a well - defined linear map and it has the property that it commutes with the shift by @xmath784 of a formal power series in @xmath797 , i.e. for all @xmath853 , @xmath854 here , we used the notation of ( [ part_pow : pf1 ] ) . indeed ,",
    "notice that @xmath855 .",
    "in addition , from the discussion above it follows that @xmath856 . combining this with the definition of @xmath647 yields ( [ part_pow : pf10 ] ) .",
    "+ in addition , for all @xmath857 , and for all @xmath802 and @xmath640 , @xmath858 * the family @xmath859 is defined as @xmath860 i.e. @xmath861 is just the restriction of @xmath862 to @xmath795 . *",
    "the map @xmath863 is defined as @xmath864 i.e. @xmath863 is just the evaluation of the elements of @xmath834 at the empty word @xmath193 .",
    "it is easy to see that @xmath828 is a well - defined rational representation .",
    "next , we will show that @xmath828 is an @xmath459-partial representation of @xmath651 . to this end , by repeated application of ( [ part_pow : pf10 ] ) and using the equality @xmath865 we get that for any word @xmath866 it holds that @xmath867 using ( [ part_pow : pf8 ] ) and repeatedly applying ( [ part_pow : pf10.1 ] ) yields that for each @xmath842 , @xmath868 by noticing that @xmath869 and that any word @xmath870 in @xmath871 can be represented as the concatenation @xmath872 of a word @xmath866 with a word @xmath842 , we get that for all @xmath873 , @xmath874 that is , @xmath828 is an @xmath459-partial representation of @xmath651 .",
    "from ( [ part_pow : pf8 ] ) it is easy to deduce that @xmath828 is reachable .",
    "observability of @xmath828 can be derived as follows . from ( [ part_pow : pf10.1 ] ) it follows that for any @xmath875 , @xmath876 for all words @xmath798 .",
    "hence , if @xmath877 for all @xmath197 , then for all @xmath798 , @xmath878 , i.e. @xmath879 .",
    "that is , @xmath880 .",
    "define now the representation @xmath579 as the isomorphic copy of @xmath828 with the isomorphism @xmath881 defined in ( [ part_pow : pf3.1 ] ) .",
    "that is , using the notation of the theorem , define the parameters @xmath647 , @xmath640 , @xmath648 and @xmath882 of @xmath579 as follows .",
    "@xmath883 since @xmath881 defines a representation isomorphism @xmath884 , it follows that @xmath579 is a @xmath459-rational representation of @xmath651 as well , and it is reachable and observable .",
    "in addition , combining ( [ part_pow : pf14 ] ) with ( [ part_pow : pf10],[part_pow : pf11],[part_pow : pf12 ] ) yields ( [ part_theo : eq4],[part_theo : eq5],[part_theo : eq6 ] ) .",
    "* proof of part [ part_theo : part2 ] * + recall that @xmath885 for all @xmath886 and @xmath887 .",
    "it is easy to see that @xmath888 hence , ( [ part_theo : eq2 ] ) implies that @xmath889 hence , ( [ part_theo : eq1 ] ) holds and by part [ part_theo : part1 ] the representation @xmath582 is well - defined and it is a @xmath459-partial representation of @xmath651 .",
    "recall that ( [ part_theo : eq1 ] ) implies that @xmath890 .",
    "it is left to show that @xmath579 is a representation of @xmath651 . to this end ,",
    "recall from ( [ project : def ] ) the definition of the map @xmath891 and recall from ( [ part_pow : pf1 ] ) the definition of the set @xmath797 .",
    "since @xmath892 , we get that @xmath893 hence @xmath894 .",
    "notice that @xmath891 maps @xmath895 onto @xmath896 for @xmath897 .",
    "hence , the map @xmath891 maps @xmath776 onto @xmath865 .",
    "that is , the restriction @xmath891 to @xmath776 yields a linear isomorphism @xmath898 .",
    "recall from lemma [ sect : form : theo1:lemma1 ] the definition of the free representation @xmath781 of @xmath651 , defined on the space @xmath776 . using ( [ part_pow : pf10]),([part_pow : pf11 ] ) and ( [ part_pow : pf12 ] ) , it is easy to see that the restriction of @xmath891 to @xmath776 in fact yields a representation isomorphism @xmath899 , where @xmath828 is as defined in ( [ part_pow : pf5 ] ) . since , @xmath781 is a minimal representation of @xmath651 , then so is its isomorphic copy @xmath828 .",
    "since @xmath579 is merely an isomorphic copy of @xmath828 , the same conclusion holds for @xmath579 .",
    "* proof of part [ part_theo : part3 ] * + recall from ( [ part_pow : pf1 ] ) and ( [ part_pow : def2 ] ) the definition of the spaces @xmath797 and @xmath807 for @xmath900 , @xmath901 . from lemma [",
    "sect : form : theo1:lemma2 ] it follows that if @xmath735 , then @xmath902 .",
    "then by corollary [ part_pow : pf1:col1 ] , @xmath903 for @xmath904 .",
    "moreover , notice that the image of @xmath797 by @xmath815 equals @xmath807 . applying the above observations for @xmath905 and using lemma [ part_pow : lemma3 ] we get that @xmath891 and @xmath906 are injective and",
    "hence @xmath907 combining ( [ part_pow : pf2 ] ) with corollary [ part_pow : pf3:col3 ] and remark [ sect : form : def1:rem1 ] we get that ( [ part_theo : eq2 ] ) holds . combining this and part [ part_theo : part2 ]",
    "we get that the statement of part [ part_theo : part3 ] holds .",
    "we will prove the statements of the theorem one by one .",
    "however , before proceeding to the actual proof , we need to introduce some notation .",
    "let @xmath480 be @xmath451-@xmath127 rational representation , i.e. @xmath480 is of the form ( [ repr : def0 ] ) .",
    "define the family of formal power series _ @xmath908 associated with the representation @xmath480 _ as follows .",
    "the family @xmath908 is indexed by elements of @xmath127 , i.e. it can be written as @xmath909 . for each index @xmath132 , and for each word @xmath197 , the value of the formal power series @xmath910 at @xmath190 is defined as @xmath911 .",
    "it is easy to see that the rational representation @xmath480 is a representation of @xmath908 , i.e. @xmath908 is rational .",
    "in fact , @xmath480 is a representation of the family of formal power series @xmath651 , if and only if @xmath912 , i.e. @xmath913 for all @xmath132 .",
    "furthermore , @xmath480 is a @xmath459-partial representation of @xmath651 , if and only if @xmath914 for all @xmath132 and @xmath915 .",
    "in addition , if @xmath480 is a @xmath459-partial representation of @xmath651 , then @xmath916 in particular , @xmath917 .",
    "now we are ready to proceed to the actual proof of the theorem .",
    "* proof of part [ part_real_pow : theo2:res1 ] * + assume that @xmath480 is a @xmath459-partial representation of @xmath651 .",
    "from the discussion above it follows that @xmath918 .",
    "it is easy to see that @xmath919 .",
    "moreover , from theorem [ sect : form : theo3 ] it follows that @xmath920 .",
    "that is , the rank of @xmath921 is not greater than the dimension of the representation @xmath480 .",
    "but from theorem [ part_real_pow : theo ] it follows the the dimension of the representation @xmath582 is precisely @xmath736 and that @xmath582 is an @xmath459-partial representation of @xmath651 .",
    "hence , we get that @xmath922 . in other words",
    ", @xmath582 is a minimal @xmath459 representation of @xmath651 .",
    "* proof of part [ part_real_pow : theo2:res2 ] * + we have just shown that the rational representation @xmath582 of theorem [ part_real_pow : theo ] is a minimal @xmath459-partial representation of @xmath651 . if @xmath480 is another minimal @xmath459-partial representation of @xmath651 , then the dimension of @xmath480 must be equal to that of @xmath582 , which in turn equals @xmath736 . hence , the second part of the statement is proved .",
    "assume now that @xmath480 is a minimal @xmath459-partial representation of @xmath651 .",
    "then it means that @xmath923 for each @xmath132 and @xmath915 , where @xmath910 denotes the element of @xmath908 indexed by the index @xmath132 .",
    "if @xmath480 is not reachable and observable , then it is not a minimal representation of @xmath908 .",
    "from theorem [ sect : form : theo3 ] it follows then that there exists a reachable and observable representation @xmath924 of @xmath925 such that @xmath926 .",
    "but if @xmath927 is a representation of @xmath925 , then it is a @xmath459-partial representation of @xmath651 , since , @xmath928 for all @xmath132 and @xmath915 .",
    "hence , @xmath480 is not a minimal @xmath459-partial representation of @xmath651 , which is a contradiction .",
    "* proof of part [ part_real_pow : theo2:res3 ] * + suppose @xmath480 and @xmath929 are two minimal @xmath459-partial representations of @xmath651 .",
    "recall the definition of the families of formal power series @xmath908 and @xmath930 associated with @xmath480 . since @xmath480 and @xmath929 have to be reachable and observable by part [ part_real_pow : theo2:res2 ] of the current theorem , by theorem [ sect : form : theo3 ] the",
    "representation @xmath480 ( respectively @xmath929 ) is a minimal representation of @xmath925 ( respectively @xmath930 ) .",
    "we will show that @xmath925 and @xmath930 are equal , i.e. @xmath931 for all @xmath132 .",
    "this in turn implies that @xmath480 and @xmath929 are both minimal representations of the same family of formal power series , and hence by theorem [ sect : form : theo3 ] they are isomorphic .    the proof that @xmath925 and @xmath930 are identical proceeds as follows .",
    "recall that @xmath480 and @xmath929 are both of dimension @xmath736 , and recall ( [ part_real_pow : theo2:pfeq1 ] ) . hence , it follows that @xmath932 and @xmath933 .",
    "it also follows that @xmath925 and @xmath930 satisfy ( [ part_theo : eq2 ] ) with @xmath651 replaced by @xmath925 and @xmath930 respectively .",
    "denote by @xmath934 and @xmath935 the minimal @xmath459-partial representations of @xmath925 and respectively @xmath930 , obtained by applying part [ part_theo : part1 ] of theorem [ part_real_pow : theo ] to @xmath908 and @xmath930 respectively . by part [ part_theo : part2 ] of theorem [ part_real_pow : theo ] the representations @xmath934 and @xmath936 are minimal representations of @xmath925 and @xmath930 respectively .",
    "however the construction of @xmath934 and @xmath936 depends only on @xmath937 and @xmath938 .",
    "the latter two matrices both coincide with @xmath723 .",
    "hence , @xmath934 and @xmath936 are both equal to the partial representation @xmath582 obtained by applying part [ part_theo : part1 ] of theorem [ part_real_pow : theo ] to @xmath651 .",
    "that is , rational representation @xmath579 , obtained by applying part [ part_theo : part1 ] of theorem [ part_real_pow : theo ] to @xmath651 , is a minimal representation of both @xmath925 and @xmath930 .",
    "this implies that @xmath925 and @xmath930 coincide .",
    "* proof of part [ sect : svd : theo1:part1 ] * + we have to show that algorithm [ partrepr ] returns a representation @xmath611 , and @xmath611 is isomorphic to @xmath579 . by theorem [ part_real_pow : theo ] ,",
    "if ( [ sect : svd : theo1:eq1 ] ) holds then @xmath579 is an @xmath459-representation of @xmath651 . from theorem [ part_real_pow : theo2 ] it then follows that @xmath582 is a minimal @xmath459-partial representation . hence , if @xmath611 is an isomorphic copy of @xmath582 , then we get that @xmath611 is a minimal @xmath459-partial representation of @xmath651 .",
    "recall from ( [ part_pow : pf5 ] ) in the proof of theorem [ part_real_pow : theo ] the definition of the representation @xmath828 . using the remark in subsection [ sect : prelim : not_matrix ]",
    ", we will interpret the matrix @xmath739 as a linear map @xmath939 defined by @xmath940 for all @xmath941 .",
    "using this interpretation , we define the map @xmath942 since @xmath881 defines a representation isomorphism @xmath884 it is enough to show that @xmath943 defines a representation isomorphism @xmath944 and that algorithm [ partrepr ] returns a rational representation if ( [ sect : svd : theo1:eq1 ] ) holds .",
    "indeed , in this case @xmath945 defines a representation isomorphism @xmath946 .",
    "it is clear that @xmath943 is well defined . indeed , @xmath947 by definition of matrix factorization .",
    "moreover , @xmath948 is an injective linear map and @xmath949 is a linear isomorphism .",
    "furthermore , since @xmath950 we get that @xmath951 is a linear isomorphism .",
    "thus , @xmath952 is a well defined linear isomorphism .",
    "it is left to show that @xmath943 is a representation morphism from @xmath611 to @xmath828 .",
    "it is easy to see that for all @xmath798 , and @xmath941 . @xmath953",
    "recall from subsection [ sect : prelim : not_matrix ] that @xmath954 stands for the value ( entry ) of @xmath955 corresponding to the index @xmath956 . in particular , for any @xmath957 , @xmath958 where @xmath959 stands for the column of @xmath480 indexed by @xmath960 .",
    "indeed , using ( [ sect : svd : theo1:pf : eq2 ] ) we get that for all @xmath798 , @xmath961 but @xmath962 , and hence the right - hand side of ( [ sect : svd : theo1:eq2.0.0 ] ) equals the vector formed by the entries @xmath963 for @xmath964 .",
    "but the entry @xmath963 equals the @xmath394th entry of @xmath965 , hence @xmath966 from ( [ sect : svd : theo1:pf : eq2 ] ) it follows that @xmath967 from ( [ sect : svd : theo1:eq2.0 ] ) , it follows that @xmath968 it is left to show that a unique solution to equation ( [ computepartialrepr ] ) exists and @xmath969 for all @xmath640 .",
    "first , notice that @xmath970 .",
    "thus , @xmath971 , i.e. @xmath972 . hence , if a solution solution ( [ computepartialrepr ] ) exists , then this solution is unique . therefore , if we show that @xmath973 is a solution to ( [ computepartialrepr ] ) then ( [ sect : svd : theo1:eq5 ] ) automatically holds .",
    "notice that @xmath974 is a linear map from @xmath975 to @xmath975 and hence it can be identified with its matrix representation . by identifying @xmath974 with its matrix , and using ( [ sect : svd : theo1:eq2.0 ] ) and ( [ part_pow : pf10 ] ) , it follows that for any @xmath957 and @xmath976 , @xmath977 here we used the notation of subsection [ sect : prelim : not_matrix ] to denote rows and columns of matrices .",
    "in particular , @xmath978 denotes the column of a matrix @xmath128 indexed by @xmath960 and @xmath979 denotes the row of a matrix @xmath128 indexed by @xmath980 .",
    "notice that if @xmath798 , then the row of @xmath490 indexed by @xmath980 equals the row of @xmath476 indexed by @xmath980 .",
    "moreover , if @xmath981 , then from ( [ sect : svd : theo1:pf : eq2 ] ) it follows that the row of @xmath982 indexed by @xmath980 equals the @xmath394th entry of @xmath983 .",
    "hence , the last expression of ( [ sect : svd : theo1:eq6 ] ) can be rewritten as @xmath984 where @xmath985 denotes the @xmath394th entry of @xmath986 . on the other hand ,",
    "the row of @xmath987 indexed by @xmath980 equals the row of @xmath476 indexed by @xmath988 , if @xmath798 .",
    "hence , @xmath989 combining ( [ sect : svd : theo1:eq6 ] ) , ( [ sect : svd : theo1:eq6.1 ] ) and ( [ sect : svd : theo1:eq7 ] ) we get that @xmath990 . since @xmath991 , i.e the columns of @xmath480 span the whole space @xmath975 , the last equality implies that @xmath974 is a solution to ( [ computepartialrepr ] ) . * proof of part [ sect : svd : theo1:part2 ] * + from theorem [ part_real_pow : theo ] it follows that if ( [ sect : svd : theo1:eq2 ] ) holds , then ( [ sect : svd : theo1:eq1 ] ) holds and @xmath579 is a minimal representation of @xmath651 . by part [ sect : svd : theo1:part1 ] of this theorem , if ( [ sect : svd : theo1:eq1 ] ) holds , then algorithm [ partrepr ] returns a representation @xmath611 and @xmath611 is isomorphic to @xmath579 . hence @xmath611 is a minimal representation too .",
    "* proof of part [ sect : svd : theo1:part3 ] * + again , from theorem [ part_real_pow : theo ] it follows that ( [ sect : svd : theo1:eq2 ] ) holds in this case .",
    "the statement follows now from ( [ sect : svd : theo1:eq2 ] ) and part [ sect : svd : theo1:part2 ] of this theorem .",
    "we conclude the section with presenting the proof of lemma [ part_pow : lemma1 ] and lemma [ part_pow : lemma3 ] used in the proof of theorem [ part_real_pow : theo ] .",
    "the proof relies on the following chain of results , which are interesting on their own right .",
    "[ part_pow : lemma4 ] let @xmath102 be finite - dimensional vector space , @xmath992 . let @xmath993 , @xmath640 be a family of linear maps . then for each @xmath994 , for each @xmath197 , the vector @xmath995 is a linear combination of the vectors @xmath996 , for finitely many words @xmath802 .",
    "if @xmath997 , then the statement of the lemma is trivially true .",
    "first we prove the lemma for @xmath411 .",
    "assume that @xmath998 , @xmath999 .",
    "consider the elements @xmath1000 , @xmath1001 .",
    "since every @xmath491 elements of @xmath102 are linearly dependent , we get that there exist @xmath1002 such that @xmath1003 is a linear combination of @xmath1004 , @xmath1005 .",
    "then we get that @xmath1006 is a linear combination of vectors of the form @xmath1007 , @xmath1008 .",
    "notice that each word @xmath1009 is of length at most @xmath804 . to prove the lemma for arbitrary @xmath1010 we proceed by induction on @xmath1011 .",
    "the case of @xmath411 we proved above .",
    "assume that the statement of the lemma holds for @xmath1012 .",
    "assume now that @xmath190 is of the form @xmath1013 , where @xmath1014 , @xmath1015 and @xmath640 is the last letter of @xmath190 .",
    "from the induction hypothesis it follows that @xmath1016 is a linear combination of vectors of the form @xmath996 , @xmath802 .",
    "but then @xmath1017 is a linear combination of vectors of the form @xmath1018 . for each @xmath802 , either @xmath1019 or @xmath1020 . in the latter case , by induction hypothesis @xmath1021",
    "is again a linear combination of vectors of the form @xmath1022 , @xmath1023 .",
    "altogether , we get that @xmath995 is a linear combination of the vectors @xmath996 , @xmath802 .        if @xmath220 and @xmath127 is finite , then the above corollary states that the observability subspace @xmath1028 is the kernel of a finite matrix , and the reachability subspace @xmath1029 is the image of a finite matrix .",
    "it is clear that @xmath1030 .",
    "we will show that the reverse inclusion holds as well .",
    "assume that @xmath1031 is such that @xmath1032 for all @xmath802 .",
    "by lemma [ part_pow : lemma4 ] , for each @xmath197 , @xmath1033 is a linear combination of @xmath1034 for @xmath802 .",
    "hence , @xmath1035 is a linear combination of @xmath1036 , @xmath802 and the latter implies that @xmath1037 .",
    "that is , @xmath1038 .",
    "similarly , it is clear from the definition that @xmath1039 .",
    "the reverse inclusion follows from lemma [ part_pow : lemma4 ] , according to which for each word @xmath197 , @xmath668 is a linear combination of the vectors @xmath1040 , @xmath802 .",
    "hence , we get that @xmath1041 .",
    "we will use the fact that @xmath1042 . consider the free representation @xmath1043 of @xmath651 defined in theorem [ sect : form : theo1 ] . notice that for any word @xmath186 , @xmath1044 .",
    "apply lemma [ part_pow : lemma4 ] to @xmath776 , @xmath1045 , @xmath640 and @xmath1046 .",
    "then we get that for any word @xmath197 , the formal power series @xmath1047 is a linear combination of the formal power series @xmath1048 with @xmath842 .",
    "it is easy to see that @xmath815 is a surjective linear map .",
    "consider the free realization @xmath1049 of @xmath651 . from theorem [",
    "sect : form : theo3 ] we know that @xmath781 is minimal and therefore it is reachable and observable , i.e. @xmath1050 . from corollary [ part_pow : col1 ] we also know that if @xmath1051 , then @xmath1052 .",
    "consider the kernel of @xmath815 .",
    "for any formal power series @xmath1053 , @xmath1054 if and only if @xmath1055 for all @xmath1056 .",
    "hence , @xmath1057 for each @xmath1056 , i.e. @xmath1058 .",
    "thus , @xmath815 is injective ."
  ],
  "abstract_text": [
    "<S> the paper presents partial - realization theory and realization algorithms for linear switched systems . </S>",
    "<S> linear switched systems are a particular subclass of hybrid systems . </S>",
    "<S> we formulate a notion of a partial realization and we present conditions for existence of a minimal partial realization . </S>",
    "<S> we propose two partial - realization algorithms and we show that under certain conditions they yield a complete realization . </S>",
    "<S> our main tool is the theory of rational formal power series .    </S>",
    "<S> hybrid systems , linear switched systems , , partial - realization theory , realization algorithm , formal power series 93b15 , 93b20 , 93b25 , 93c99 </S>"
  ]
}