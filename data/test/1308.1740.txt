{
  "article_text": [
    "star formation histories ( sfhs ) of nearby galaxies can be estimated by analysis of their resolved stellar content , as many features present in a color - magnitude diagram ( cmd ) provide evidence of star formation at specific ages .",
    "for example , blue or red supergiants provide evidence of recent star formation , while blue horizontal branch stars indicate the presence of ancient populations .",
    "relative strengths of age - related cmd features can be used to estimate the star formation rates ( sfrs ) at those ages , leading to an overall estimate of the sfh @xcite .",
    "more quantitative methods for the measurement of sfhs have been introduced ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and despite differences in implementation share a common overall approach .",
    "first , synthetic cmds are generated for a variety of potential sfhs through application of stellar evolution models , an observational error model ( typically utilizing artificial star tests ) , and other parameters ( e.g. , distance , extinction , imf , and unresolved binaries ) .",
    "second , the level of agreement between observed and synthetic cmds is quantified using some goodness - of - fit metric , which is used to measure the sfh .    while significant work has been dedicated to the derivation and implementation of sfh measurement techniques ,",
    "estimation of uncertainties in sfh measurements has been given considerably less attention .",
    "on the topic of systematic uncertainties due to isochrone physics , @xcite proposed a technique for estimating the size of these uncertainties .",
    "however , an understanding of random uncertainties is equally critical , especially when analyzing less - populated cmds where random uncertainties are likely to dominate . examples of this include small regions within galaxies used to estimate ages of specific young populations such as those near a supernova @xcite or uv - bright regions @xcite .",
    "likewise , analysis of stars in individual clusters can be studied ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "finally , when making a comparative analysis of two systems ( e.g. , * ? ? ?",
    "* ) , the relative uncertainties are dominated by random errors .",
    "the present study evaluates the common approach used for this problem and several alternatives .",
    "the bootstrap monte carlo technique is the standard method used in the estimation of random uncertainties in sfh measurements .",
    "the approach involves three steps .",
    "first , one generates an adequate number of resampled cmds . assuming that the cmd has been binned into a hess diagram , these can be easily generated by using values in the hess diagram of either the original photometry or the best - fitting model as the means of poisson distributions in each hess diagram bin , and generating random deviates to create resampled photometry .",
    "the sfh is then measured for each of the resampled cmds .",
    "finally , the variation of recovered sfhs is calculated .",
    "provided a sufficiently large number of resamplings , that variation is assumed to equal the uncertainty of the original solution due to random errors .    to illustrate this approach , figure [ fig - sample1 ] shows a synthetic population generated with constant sfr and constant metallicity , and the best - fit sfh as determined by match @xcite .",
    "two sets of bootstrap monte carlo runs were made , one by resampling the original photometry and the other by resampling the best fitting synthetic cmd .",
    "uncertainties estimated with the two variants are shown in figure [ fig - bootstrap ] .    in both versions of the bootstrap monte carlo , time bins",
    "for which zero star formation was detected in the original solution showed zero star formation in most or all of the monte carlo runs .",
    "the reason for this is due to stochastic sampling of age - specific indicators . if no core helium - burning stars corresponding to 10 - 40 myr old populations are present ( as was the case in this example ) , those populations are unlikely to be measured in the resulting sfh .",
    "consequently , data created by resampling either the observed or model cmd will also fail to have those stars indicating a 10 - 40 myr population , causing the monte carlo runs to return zero star formation in that age range .    this example illustrates a significant limitation of bootstrap monte carlo techniques .",
    "given that the cmd in figure [ fig - sample1 ] was generated using a constant sfr and that no other errors were introduced ( e.g. , isochrone sets , photometric error model , etc . ) , any differences between the input and measured sfhs is due solely to random errors created by stochastic sampling of the cmd .",
    "therefore , any estimate of those random errors must show that the measured sfh is consistent with a constant sfr .",
    "since the bootstrap monte carlo results violate this requirement , the assumption that best - fit sfhs of resampled cmds represent the confidence limits on the original solution to the observed data is invalid .",
    "instead , one needs to measure confidence intervals in that original solution .",
    "the direct approach for determining a confidence interval for a quantity of interest is to calculate the probability density as a function of that quantity , and determine a probability density threshold above which the desired percent of the probability lies .",
    "the confidence interval is the region with probability density above that threshold .",
    "for example , the @xmath0 confidence interval of a normal distribution defined by a mean @xmath1 and standard deviation @xmath2 is bounded by @xmath3 and @xmath4 .    applying the above approach to the measurement of sfhs , the probability density must be written a function of the sfh .",
    "assuming that the cmd is converted into a hess diagram by binning , the probability of a model with a predicted @xmath5 stars producing an observed @xmath6 stars in the @xmath7 hess diagram bin is given by @xmath8 the predicted number of stars in that bin is determined by the star formation history .",
    "@xmath9 where @xmath10 is the sfr in time bin @xmath11 , and @xmath12 is the number of stars that would be expected to fall within the @xmath7 hess diagram bin , given that @xmath13 and all other times have zero star formation .    since equations [ eq - logp ] and [ eq - lambda ]",
    "calculate the probability of randomly creating an observed hess diagram given a sfh , bayes theorem allows the determination of the probability of the sfh given the observed hess diagram : @xmath14 where @xmath15 is the prior on the sfr in time bin @xmath11 .",
    "unless there are external constraints on the sfh , the priors should be non - informative .",
    "a uniform prior @xmath16 is adopted here .    once the probability density has been measured over an evenly spaced and well sampled grid of the sfhs of interest , the probability density for the sfr in time bin @xmath11 is calculated by marginalizing over all other variables , and the confidence limits",
    "can be computed .",
    "the above approach works well for small numbers of dimensions , such as star clusters that can be treated as single stellar populations ( ssps ) . in the ssp case",
    ", there is only a single sfr being measured , plus possibly a foreground / background star model scale factor .",
    "it is thus feasible to measure the probability density as a function of several input parameters , such as age , metallicity , distance , extinction , imf slope , and/or unresolved binary fraction @xcite .    for the case of galaxy sfhs , however , a typical solution has dozens of time bins .",
    "( the examples presented in section [ sec - bootstrap ] were solved with 20 time bins . )",
    "worse , if the entire population box is being measured directly , this is multiplied by dozens of metallicity bins and the space of all possible sfhs can easily exceed a thousand dimensions .",
    "even the case of a star cluster with prolonged star formation is likely to have of order ten age and/or metallicity bins , making direct sampling of the full pdf problematic .",
    "so , while the measurement of the probability density over a several - dimensional space is possible and has been demonstrated effective for single stellar populations , a different approach is required if one wishes to estimate random errors of sfh measurements of mixed populations .",
    "an alternative to numerical integration of the pdf is markov chain monte carlo ( mcmc ) , a process designed to generate a set of samples whose density is proportional to the probability density .",
    "the advantage of this approach is its efficiency : if implemented well , one can avoid computationally expensive measurement of the pdf in regions of zero probability .",
    "this is especially helpful in a correlated space such as that seen in sfh solutions , where similarities between models corresponding to adjacent age or metallicity bins can create near degeneracies in their respective sfrs .",
    "several techniques for generating the mcmc samples exist , but share two important similarities .",
    "first is that the samples are computed by use of a markov chain , a random process in which calculation of the next sample requires knowledge only of the current sample ( i.e. , no information of past samples is used ) .",
    "the second is that transitions must obey the principle of detailed balance . denoting @xmath17 as the probability for transitioning from state @xmath18 to @xmath19 , and @xmath20 as the probability density at state @xmath18",
    ", detailed balance requires that @xmath21    once the mcmc samples have been created , it can be used to identify confidence intervals .",
    "a simple solution is to adopt the mean and standard deviation , but this will only identify the region of highest probability if the probability density function is symmetric about its maximum . a better approach is to identify the confidence limit bounding the region of highest probability , making use of the fact that the density of mcmc samples is proportional to the probability density .",
    "it follows that the confidence interval is the narrowest interval containing the desired fraction of the samples .",
    "for example , to compute the @xmath0 confidence interval , one could determine the interval bounded by the @xmath22 and @xmath23 percentiles , the @xmath24 and @xmath25 , and so on and select the narrowest of those .",
    "the most common algorithm used to create mcmc samples is the metropolis - hastings algorithm @xcite or various adaptations of that algorithm .",
    "the algorithm uses a two - step process to determine the next sample .",
    "the first step is the calculation of a proposed new state @xmath19 based on the current state @xmath18 .",
    "the proposal function must be symmetric , in that the probability of proposing a transition from @xmath18 to @xmath19 must equal the probability of proposing the reverse transition .",
    "this is commonly accomplished by setting @xmath19 equal to @xmath18 plus a random number drawn from a zero - mean multivariate normal distribution .",
    "the second step is determining the probability of acceptance of the new state .",
    "if the probability density at the new state equals or exceeds that of the old state , the probability of acceptance is 1 .",
    "if not , it equals the ratio of the probability densities , @xmath26 .    the challenge in implementing an efficient metropolis - hastings algorithm in a space with large dimensions is to create a function that can generate proposals reasonably far from the current state while also having a reasonably high acceptance rate . for the case of sfh measurement , a solution to this",
    "was not found .",
    "either the step size was too small so that the entire probability space was not sampled , or the acceptance rate was too low to generate an acceptable number of independent samples .",
    "other common algorithms , such as slice sampling @xcite or gibbs sampling @xcite , also proved unsuitable for this application .    the hybrid monte carlo ( hmc ) algorithm @xcite solves the problem of creating proposals with large step size and high acceptance rate by using hamiltonian evolution between states .",
    "if the potential is set equal to @xmath27 ; the initial velocity is randomly generated using a zero - mean , unity sigma normal distribution ( in each dimension ) ; and the numerical propagation uses an exactly reversible process , the acceptance probability equals the ratio of the final to initial hamiltonian .",
    "since the hamiltonian is conserved unless large step sizes cause truncation error , acceptance probability of near one can be achieved .",
    "one challenge of adapting the hmc algorithm to the sfh problem is that the acceleration is equal to the gradient of the logarithm of the probability density , so any discontinuity is likely to cause truncation error in the propagation and reduce the acceptance rate .",
    "the requirement that sfrs be non - negative sets up a potential discontinuity ; the recommended solution is to reparameterize the sfr as the square of the parameter being propagated . due to sampling a space that is not linear in sfh , this implicitly introduces a prior of @xmath28 on the sampled distribution that must be eliminated by weighting the samples by @xmath29 when processing the samples .",
    "an alternative approach that preserves the uniform prior is to set the sfr equal to the absolute value of the parameter being propagated .",
    "this removes the possibility of negative sfrs , but leaves a discontinuity in the gradient s derivative and significantly reduces the acceptance rate .",
    "the uncertainties computed from the hmc routine are shown in figure [ fig - hmc ] .",
    "for age bins in which the measured sfr was non - zero in the original solution , the uncertainties are very similar between the hmc and bootstrap mc .",
    "however , the hmc technique is able to successfully measure uncertainties in the two bins with zero measured sfr .",
    "a figure of merit is that the input ( truth ) sfr should be outside of the plotted 68% confidence limits for about 32% ( 6 ) of the twenty sfr measurements in figure [ fig - hmc ] .",
    "this example had four points exceeding the limit , which is slightly lower but not a statistically significant discrepancy .",
    "the preceding discussion has assumed that the parameters being sampled in the hmc process are the parameters one wishes to constrain ( sfr vs. time ) .",
    "however , sfh measurements from photometry deeper than the main sequence turnoff frequently measure the full population box of sfr vs. time and metallicity ( e.g. , * ? ? ?",
    "in this case , sfr as a function of time is calculated by summing across the metallicities .",
    "the effect of summing @xmath30 values , each of which has a @xmath31 prior , is to create a prior of @xmath32 on the total sfr .",
    "a direct solution is to parameterize the sfrs so that the prior of the sum of @xmath30 independent values is uniform .",
    "this can be achieved by defining the sfr as @xmath33 .",
    "if @xmath30 is small , this approach can be effective .",
    "as it becomes larger ( examples shown in this paper have 24 metallicity bins ) , the derivative of the probability with respect to @xmath34 can become very large , requiring exceedingly small propagation step sizes and thus long execution times .",
    "an alternative solution is to use a nested hmc approach .",
    "the main loop executes normally , using the same @xmath35 parameterization recommended in the previous section . each sample from this hmc",
    "is then used to determine the metallicity distribution as a function of age and as the initial solution for an hmc solution in which only the sfr vs. time is varied .",
    "given adequate burn - in ( which , given the efficiency of the hmc approach , can be of order 10 samples ) , a sample can be obtained that has the desired prior on the total sfr at each time . for @xmath36 ,",
    "this approach is an order of magnitude faster than that from the previous paragraph and produces equivalent error estimates .",
    "in addition to effects of poisson noise , uncertainties on key assumed parameters ( e.g. , distance , extinction , imf , and unresolved binaries ) can introduce uncertainty in the sfh .",
    "ideally , these dependencies would be measured during the hmc process described in the previous section . however , while the gradient of the probability as a function of sfr can be trivially calculated from a single set of basis functions , these parameters affect the basis functions themselves , making analytical evaluation of the gradients challenging .    instead , a process similar to that outlined in section [ sec - pdf ] is recommended .",
    "assuming that the maximum likelihood is proportional to the probability marginalized over sfrs , each point in the distance / extinction / etc .",
    "space can be assigned a probability density proportional to the maximum likelihood of the sfh solution at that point .",
    "any external constraints on the parameters can be used as a prior .",
    "the effects on the sfh uncertainties can be quantified precisely by executing an hmc test at each of these points , producing a number of samples proportional to the posterior probability density .",
    "the final mcmc sample is then the combination of each of these .",
    "a faster alternative is to compute statistics separately on the maximum likelihood solutions at each point , then add the uncertainties in quadrature to those from a single hmc run with the parameters corresponding to the maximum likelihood .",
    "figure [ fig - distance ] shows total uncertainties ( random plus those from distance and extinction uncertainty ) calculated both ways ; the two approaches produce equivalent uncertainties .",
    "combined with the technique for estimation of uncertainties due to isochrone uncertainties @xcite , the technique presented in this study allow one to robustly and accurately estimate the complete uncertainty of sfh measurements . to help understand the relative impacts of the different sources of uncertainty",
    ", four simulated populations are analyzed covering the combinations of shallow and deep photometry , and few vs. many stars .",
    "as before , all were generated with a constant sfr and metallicity .",
    "figure [ fig - deep1 ] shows contributions to the error budget for each of the three sources of uncertainty for a system with deep photometry but only @xmath37 observed stars . for the populations with deep photometry ,",
    "the sfh was solved as a function of both age and metallicity as a several hundred parameter problem and the hmc algorithm was executed as described in section [ subsec - mcmc - nozinc ] . in this example , a comparison of panels ( a ) and ( d ) shows that the total uncertainty is dominated by random errors .",
    "figure [ fig - deep2 ] shows equivalent results for a system with the same photometry depth but 20 times more stars . here",
    ", random errors dominate at young ages ( @xmath38 yr ) , systematics dominate at older ages .    figures [ fig - shallow1 ] and [ fig - shallow2 ] show equivalent analysis for the case of photometry reaching only @xmath39 ( i.e. , not reaching the horizontal branch or red clump ) . for this ,",
    "mean metallicity vs. time was assumed to follow one of three potential functional forms and was constrained to prevent metallicity from decreasing with time .",
    "( as implemented in match , the three forms are linearly decreasing @xmath40}$ ] with age , linearly decreasing z with age , and a form in which most enrichment happens at high age . ) solutions and hmc runs with many potential chemical enrichment histories were made to determine the best solution and quantify the uncertainties . in the case with few stars ( figure [ fig - shallow1 ] ) ,",
    "both random and systematic error sources provide significant contributions , but uncertainties given a shallow , well - populated cmd ( figure [ fig - shallow2 ] ) are dominated by systematic uncertainties throughout .",
    "it is worth noting that in no case is uncertainty due to distance or extinction significant ; this is due to the fact that the absolute magnitude and effective temperature shifts used to quantify systematic uncertainties greatly exceed the distance or extinction uncertainties .",
    "this paper examines the problem of estimating random uncertainties of sfhs . under inspection ,",
    "the traditional process for this estimation ( bootstrap monte carlo ) is shown to significantly underestimate uncertainties in populations for which the measured sfh was zero .",
    "the effect is also observed , but less dramatic , in populations for which the measured sfh was non - zero but significantly underestimated .",
    "this is seen to be a result of particular indicator populations ( e.g. , blue helium burning stars for young populations ) not being present in the photometry and thus not being created in the resampled photometry either .",
    "the cause of this is that the set of best - fitting solutions to resampled photometry does not trace the probability density of solutions to the original photometry .",
    "while marginalization of the probability density to determine confidence intervals would be a direct approach to solving this problem , the large number of dimensions and highly correlated space makes such an approach intractable for something beyond a single stellar population . instead , markov chain monte carlo ( mcmc ) techniques can be used to create a set of samples whose density is proportional to the probability density function .    of the various mcmc algorithms ,",
    "the hybrid monte carlo ( hmc ) algorithm works extremely efficiently in the high - dimensional space of sfh solutions , given a well - behaved gradient of the logarithm of the likelihood .",
    "an effective parameterization that ensures the well - behaved gradient defines the sfr as the square of the parameter being solved ; this eliminates both the boundary at zero sfr and discontinuity in the gradient at that location .",
    "the only drawback is that weighting of the mcmc sample by @xmath41 is required to eliminate the implicit prior created by that parameterization .",
    "the case of measuring the population box directly ( solving for the sfr across a two - dimensional grid of age and metallicity ) is discussed . here , when marginalizing the samples over metallicity to estimate the sfr vs. time only , the prior is significantly affected .",
    "an approach for resolving this problem is suggested , in which mcmc samples from the full solution are used to seed sfr - only hmc runs .",
    "incorporation of uncertainties in other fitting parameters , such as distance , extinction , imf slope , or unresolved binary populations , is also discussed .",
    "because these are generally insignificant when compared with random and isochrone systematic uncertainties , a shortcut of treating the maximum likelihood solutions at each value as a weighted sample can be adopted without degrading the accuracy of the final solution .",
    "finally , random uncertainties estimated using the mcmc process are compared with isochrone systematic uncertainties estimated using the process developed by @xcite .",
    "random uncertainties are more significant for younger populations , deeper photometry , and cmds with fewer stars .",
    "this comparison also illustrates how uncertainties from all three error sources ( random , isochrone systematic , and distance / extinction uncertainty ) can be combined to determine the full uncertainty of the sfh .",
    "support for program number hst - go-12055.15 was provided by nasa through a grant from the space telescope science institute , which is operated by the association of universities for research in astronomy , incorporated , under nasa contract nas5 - 26555 .",
    "dolphin , a. 1997 , new a , 2 , 397 dolphin , a. e. 2002 , , 332 , 91 dolphin , a. e. 2012 , , 751 , 60 duane , s. , kennedy , a. d. , pendleton , b. j. , & roweth , d. 1987 , phlb , 195 , 216 gallart , c. , aparicio , a. , bertelli , g. , & chiosi , c. 1996 , , 112 , 1950 geman , s. & geman , d. 1984 itpam , 6 , 721 hamren , k. , smith , g. h. , guhathakurta , p. , et al .",
    "2013 , , submitted harris , j. & zaritsky , d. 2001 , , 136 , 25 hastings , w. k. 1970 , biometrika , 57 , 97 hernandez , x. , valls - gabaud , d. , & gilmore , g. 1999 , , 304 , 705 hodge , p. 1989",
    ", , 27 , 139 holtzman , j. a. , gallagher , j. s. , cole , a. a. , et al . 1999 , , 118 , 2262 johnson , l. c. , seth , a. c. , dalcanton , j. j. , et al . 2012 , , 752 , 95 metropolis , n. , rosenbluth , a. w. , rosenbluth , m. n. , teller , a. h. , & teller , e. 1953 , , 21 , 1087 murphy , j. w. , jennings , z. g. , williams , b. , et al .",
    "2011 , , 742 , 4 neal , r. m. 2003 , ansta , 31 , 705 simones , j. e. , weisz , d. r. , skillman , e. d. , et al . 2013 , , submitted tolstoy , e. & saha , a. 1996 , , 462 , 672 weisz , d. r. , dolphin , a. e. , skillman , e. d. , et al .",
    "2013 , , 431 , 364"
  ],
  "abstract_text": [
    "<S> the standard technique for measurement of random uncertainties of star formation histories ( sfhs ) is the bootstrap monte carlo , in which the color - magnitude diagram ( cmd ) is repeatedly resampled . </S>",
    "<S> the variation in sfhs measured from the resampled cmds is assumed to represent the random uncertainty in the sfh measured from the original data . </S>",
    "<S> however , this technique systematically and significantly underestimates the uncertainties for times in which the measured star formation rate is low or zero , leading to overly ( and incorrectly ) high confidence in that measurement . </S>",
    "<S> this study proposes an alternative technique , the markov chain monte carlo ( mcmc ) , which samples the probability distribution of the parameters used in the original solution to directly estimate confidence intervals . while the most commonly used mcmc algorithms are incapable of adequately sampling a probability distribution that can involve thousands of highly correlated dimensions , the hybrid monte carlo algorithm is shown to be extremely effective and efficient for this particular task . </S>",
    "<S> several implementation details , such as the handling of implicit priors created by parameterization of the sfh , are discussed in detail . </S>"
  ]
}