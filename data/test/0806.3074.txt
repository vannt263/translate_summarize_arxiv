{
  "article_text": [
    "during the last few decades cosmology has evolved from a data starved branch of astrophysics , into a data driven high - precision science in which theories may be subjected to stringent observational tests .",
    "this revolution has to a large extent been driven by steadily improving observations of the cosmic microwave background ( cmb ) , allowing cosmologists to have a close - up look at the very young universe .",
    "two leading experiments were the cobe - dmr @xcite and wmap @xcite satellite missions , while the third generation experiment , planck , will be launched late this year .    as observations continue to improve ,",
    "increasingly demanding requirements are imposed on the data analysis . while rather crude approximations may be acceptable when interpreting low signal - to - noise data , the situation is very different in the mid and high signal - to - noise regime . here ,",
    "even `` small '' effects become clearly visible , and may potentially compromise any cosmological conclusion . using accurate methods in this regime",
    "is critical .",
    "some real - world issues relevant to the cmb problem are non - cosmological foregrounds , improper noise and/or beam characterization , and sub - optimal likelihood approximations .    in 2004 , a new approach to cmb analysis was proposed and implemented by @xcite , @xcite and @xcite . rather than taking the traditional approximate monte carlo approach ( e.g. , * ? ? ?",
    "* ) , this new method employs the gibbs sampling algorithm to facilitate exact ( in the maximum - likelihood sense ) , global and efficient analysis of even high - resolution data sets .",
    "equally important , the gibbs sampling framework has unique capabilities for error propagation , as it allows for easy marginalization over virtually any auxiliary stochastic field .",
    "one important example is that of non - cosmological foregrounds .",
    "since then , the method has been generalized to handle polarized cmb data @xcite and joint foreground and cmb analysis @xcite , and has been applied most successfully to the wmap data @xcite .",
    "some useful examples of issues correctly identified by the gibbs sampler , but missed by other techniques , are 1 ) the first - year wmap likelihood bias at @xmath3 @xcite , 2 ) foreground residuals in the 3-year wmap polarization sky maps @xcite , and 3 ) residual monopole and dipole components in the 3-year temperature sky maps @xcite .",
    "following up on these methodological advances , the wmap team adopted the gibbs sampler as a central component in their analysis of the 5-year data , and , in fact , their default low-@xmath4 temperature likelihood module is precisely the gibbs - based blackwell - rao code written and published by @xcite .",
    "while wmap has done an excellent job on characterizing the large - scale cmb temperature fluctuations , the current frontier in cmb science is polarization . in just a few years",
    ", full - sky high - sensitivity data will be available from planck .",
    "and then , very likely , the situation will be quite analogous to the one wmap experienced in the temperature case : having robust , exact methods that allows for proper characterization and propagation of systematics will be essential in the mid to high signal - to - noise regime .",
    "the gibbs sampler is among the leading candidates to serve such a purpose .",
    "unfortunately , the gibbs sampler , as currently described in the literature , has two major limitations that needs to be resolved before this promise can be fulfilled .",
    "first , the direct gibbs sampler is inherently inefficient in the low signal - to - noise regime , because the step size between two consecutive samples is determined by cosmic variance alone , whereas the full posterior width is determined by noise .",
    "second , it is non - trivial to establish a full likelihood approximation from the samples produced by the gibbs sampler , because of the dimensionality of the underlying space . both of these issues are currently under development , and reports are expected in the near future ( jewell et al .",
    "2008 ; rudjord et al . and eriksen et al .",
    ", in preparation ) .    in the present paper ,",
    "we take a small but important first step towards resolving these issues , by considering the marginal and conditional densities of the probability distribution @xmath0 , where @xmath5 is the ensemble averaged cmb power spectrum , and @xmath6 is the observed power spectrum of one given cmb realization .",
    "this distribution plays a crucial role within the cmb gibbs sampling framework . on the one hand",
    ", it forms one of the two conditionals in the main sampling scheme . on the other ,",
    "it is the kernel of the blackwell - rao estimator .",
    "being able to describe this analytically in different forms is therefore very useful .",
    "two specific applications are demonstrated in this paper , namely 1 ) a @xmath5 sampling algorithm that allows for different binning schemes in each of the polarization components , and 2 ) blackwell - rao estimators for each of @xmath7 , @xmath8 , and @xmath9 .",
    "further applications will be demonstrated in the papers mentioned above .",
    "we also note that these expressions are completely general , and may prove useful for any other method that considers both @xmath5 and the cmb sky signal @xmath10 as free variables .",
    "one such example is the cmb hamiltonian sampler recently developed by @xcite .",
    "we now introduce a statistical model for the cmb observations , and define our notation .",
    "first , we assume that the data may be modelled by a signal and a noise term , @xmath11 here , @xmath12 is a 3-component @xmath13 stokes parameter vector observed in direction @xmath14 .",
    "@xmath10 and @xmath15 denote similar vectors , describing the cmb field and instrumental noise , respectively .",
    "both the signal and the noise are assumed to be gaussian distributed with zero mean and covariances @xmath16 and @xmath17 , respectively .",
    "( note that we , for notational simplicity , neglect real - world complications such as instrumental beams , frequency dependent observations or foreground components in this expression ; the topic of this paper is the probability distribution @xmath18 , and for this , all such issues are irrelevant . )",
    "next , we additionally assume the cmb field to be statistically isotropic .",
    "it is therefore useful to decompose the @xmath13 field into spin - weighted spherical harmonics ( see , e.g. , zaldarriaga and seljak 1997 for full details ) , with coefficients @xmath19 .",
    "because the spherical harmonics are orthogonal on the full sky , and @xmath20 has opposite parity of @xmath21 and @xmath22 , the harmonic space cmb covariance matrix is given by @xmath23 in this expression , brackets denote ensemble averages , and the power spectrum @xmath5 therefore corresponds to a theory spectrum , similar to that produced by a boltzmann code such as cmbfast @xcite .",
    "note that @xmath5 denotes the matrix of all power spectra , while a single component is indicated by subscripts ( e.g. , @xmath24 ) .",
    "one can also define the realization specific power spectrum , @xmath6 , which is simply the averaged power in each multipole for one given realization , @xmath25 explicitly , @xmath5 is the power spectrum corresponding to some cosmological model , and @xmath6 is the power spectrum of one realization drawn from that model",
    ". it may therefore be useful to imagine that observations of the cmb sky provide us with @xmath6 , and from this we seek to constrain the underlying cosmological theory , parametrized by @xmath5 and summarized by the conditional distribution @xmath0 . with this notation ,",
    "it is straightforward to write down the joint probability distribution for the cmb sky signal , @xmath10 , the cmb power spectrum , @xmath5 and the data , @xmath12 , @xmath26 and the cmb posterior distribution , @xmath27 these expressions involve two factors , namely the @xmath28 and the cmb probability distribution @xmath29 .",
    "since we assume that the cmb field is isotropic and gaussian , as discussed above , the latter may be written as ( e.g. , larson et al .",
    "2007 ) @xmath30 where @xmath31 is a prior on @xmath5 .",
    "@xmath32 is recognized as an inverse wishart distribution when interpreted as a function of @xmath5 .    before turning to the main topic of this paper",
    ", we recall that , for a probability distribution @xmath33 , the marginal distribution is defined by @xmath34 , and the conditional by @xmath35 . from these",
    ", one may also trivially derive bayes theorem , @xmath36 .",
    "therefore , for uniform priors on both @xmath5 and @xmath10 , which we assume in this paper , @xmath37 .",
    "lcl @xmath38 & @xmath39 & @xmath40 + @xmath41 & @xmath39 & @xmath42 + @xmath43 & @xmath39 & @xmath44 + @xmath45 & @xmath39 & @xmath46 + @xmath47 & @xmath39 & @xmath48 + @xmath49 & @xmath39 & @xmath50 + @xmath51 & @xmath39 & @xmath52 + @xmath53 & @xmath39 & @xmath54 +    @xmath55 & @xmath39 & @xmath56 + @xmath57 & @xmath39 & @xmath58 + @xmath59 & @xmath39 & @xmath60 + @xmath61 & @xmath39 & @xmath62 + @xmath63 & @xmath39 & @xmath64 + @xmath65 & @xmath39 & @xmath66    the main goal of this paper is to derive explicit expressions for the marginals , and thereby the conditionals , of @xmath0 .",
    "these are summarized in table [ tab : distributions ] .",
    "as seen above , @xmath0 is given by the inverse wishart distribution , which , in @xmath67 dimensions and including the full normalization factor @xcite , reads @xmath68 here @xmath69 is the multivariate gamma function .",
    "however , as discussed in section [ sec : notation ] , we are in this paper interested in the special case for which @xmath70 . in this case",
    ", the trace in equation [ eq : joint_distribution ] expands into a sum of two terms , and the @xmath5 determinant factorizes into the product of a two - dimensional @xmath71 determinant and @xmath72 .",
    "thus , the joint distribution factorizes as @xmath73 that is , @xmath72 is independent of @xmath74 , and follows a one - dimensional inverse wishart ( or inverse gamma ) distribution .",
    "we will therefore not consider the @xmath75 component further in this paper .",
    "however , we note that if one is interested in exotic models for which @xmath76 , the expressions derived in this paper will have to be revised accordingly .",
    "we start by considering the two - dimensional marginal distribution @xmath79 , which is obtained by integrating @xmath80 over @xmath24 , @xmath81 note that the lower limit in this integral is defined by @xmath82 , since the power spectrum covariance matrix in equation [ eq : cl_covar ] must be positive definite .",
    "if we now define @xmath83 and make the change of variable @xmath84 this expression is transformed into @xmath85 the integral in this expression is simply the gamma function , @xmath86 and , for our purposes , an irrelevant numerical normalization factor .",
    "thus , the final distribution reads @xmath87 note that because @xmath88 and @xmath89 occur symmetrically in equation [ eq : joint_distribution ] , the corresponding expression for @xmath90 is obtained simply by interchanging @xmath89 and @xmath88 in equation [ eq : te_ee ] .",
    "next , we consider @xmath93 , which is obtained by integrating @xmath80 over @xmath94 . unfortunately , this distribution does not have a closed expression , but can instead be written on the form @xmath95 here @xmath96 denotes the integral @xmath97 and we have defined the two dimensionless auxiliary parameters @xmath98 however , the fact that @xmath96 depends only on two dimensionless parameters and @xmath4 , implies that it can easily be tabulated ( and optionally splined for higher accuracy ) for each @xmath4 , and thus computationally efficient lookup - tables may be constructed . in most practical applications , which typically require repeated evaluations of @xmath99 , equation [ eq : tt , ee ] is therefore as useful for @xmath100 as equation [ eq : ee ] is for @xmath101 , although implementationally a little more complicated .",
    "we now compute the corresponding one - dimensional marginals , and begin with @xmath102 , by integrating equation [ eq : te_ee ] over @xmath103 .",
    "this is simplified by introducing the new variable @xmath104",
    "the distribution then reads @xmath105 the integral in this expression is , for @xmath106 , @xmath107 which is a simple numerical constant .",
    "the desired marginal distribution therefore reads @xmath108 again , we note that the corresponding expression for @xmath109 is obtained simply be replacing @xmath89 with @xmath88 .",
    "finally , we consider @xmath111 . as was the case for @xmath112",
    ", this distribution does not have a closed form , but may instead be written on a computationally convenient form , @xmath113 where @xmath114 denotes the integral @xmath115 the two dimensionless auxiliary parameters in this integral are @xmath116 thus , as was the case for @xmath117 , also @xmath118 may be tabulated over a two - dimensional grid for each multipole .",
    "it is therefore computationally straightforward to evaluate @xmath119 at a given value of @xmath103 , even if it does not have a closed analytic expression .      from the above expressions",
    ", we may also derive all possible conditional distribution , since @xmath121 . here",
    "we will only explicitly consider the conditional @xmath110 distribution , @xmath122 which is relevant to several important applications ( see , e.g. , section [ sec : applications ] ) .",
    "if we make the same linear transformation of @xmath94 as in section [ sec : ee ] , but including an additional @xmath123 factor , @xmath124 this we see that this may be rewritten into a familiar form , @xmath125 we recognize this as the student s t distribution with @xmath126 degrees of freedom .    since one of our goals is to sample from this distribution ,",
    "it is useful to have its cumulative distribution , @xmath127 , on a closed form , @xmath128 here @xmath129 denotes the hypergeometric function ( e.g. , abramowitz & stegun 1972 ) .",
    "the analytic expressions derived in section [ sec : distributions ] are the main results of this paper .",
    "being completely general , these may in principle be applied to a wide range of practical cmb applications .",
    "however , they are particularly useful for methods that consider both the sky signal @xmath10 and the power spectrum @xmath5 as free variables , such as the cmb gibbs sampler . in this section ,",
    "we demonstrate two specific gibbs - based applications , namely 1 ) a new @xmath5 sampling algorithm that supports general binning schemes , and 2 ) new blackwell - rao estimators for marginal and conditional distributions .",
    "the cmb gibbs sampler draws samples from the joint posterior , @xmath130 , by alternately sampling from the two corresponding conditionals ( e.g. , jewell et al .",
    ", wandelt et al . , eriksen et al .  2004 ) , @xmath131 ( in this expressions , the arrow indicates sampling from the distribution on the right hand side . ) the former of these distributions is a high - dimensional gaussian distribution , while the latter , which is the topic of the present paper , is a product of independent inverse wishart distributions .",
    "there is already a well known and simple algorithm available in the literature to sample from the inverse wishart distribution ( e.g. , larson et al .",
    "2007 or gupta & nagar 2000 ) : let @xmath132 be the dimension of the target matrix ( e.g. , @xmath133 for @xmath134 ) , and @xmath135 .",
    "then the algorithms goes as follows : 1 ) draw @xmath136 vectors from a gaussian distribution with covariance matrix @xmath137 ; 2 ) compute the sum of outer products of these vectors ; 3 ) invert this matrix .",
    "this algorithm produce samples for a given multipole @xmath4 . however , in low signal - to - noise applications it is often desirable to bin many multipoles together , in order to increase the effective signal - to - noise of each variable . because the cmb power spectrum essentially scales as @xmath138",
    ", it is customary to bin in units of @xmath139 . with this convention",
    ", the above algorithm may be generalized to include binning by redefining the covariance matrix as follows , @xmath140 here @xmath141 $ ] indicates the multipole range of the bin under consideration .",
    "note that the total number of modes is now @xmath142 , and therefore @xmath143 gaussian vectors must be drawn from @xmath137 .",
    "unfortunately , this method has the serious drawback that the binning scheme must be identical for @xmath24 , @xmath94 and @xmath144 .",
    "this is a problem because the signal - to - noise ratio of most experiments is very different for @xmath88 than for @xmath89 , and one would lose much spectral resolution if one were to bin @xmath24 with a bin size such that the signal - to - noise ratio for the corresponding @xmath144 bin is unity .",
    "the new analytical expressions derived in section [ sec : distributions ] allows us to resolve this problem .",
    "first , we use the definition of a conditional distribution , and write @xmath145 the algorithm may now be written symbolically as follows , @xmath146 then @xmath147 will be a sample drawn from the joint distribution @xmath148 .",
    "note that each of these conditional distributions is a one - dimensional distribution , and the correlation with other polarization components comes into play only conditionally , not jointly .",
    "one is therefore completely free to specify the binning schemes for each component independently of the others .",
    "we still need to write down a sampling algorithm for each of these conditionals . however , since these are all one - dimensional , this is a trivial task .",
    "the simplest approach , and the one currently implemented in our codes , is to take advantage of the cumulative distribution : suppose we want to draw a sample from a univariate distribution , @xmath149 , and have access to the corresponding cumulative distribution , @xmath150",
    ". then we can draw a uniform variate @xmath151 $ ] , and solve for @xmath152 .",
    "the sample @xmath153 will then be drawn from @xmath149",
    ".    however , a computational issue with this approach is the evaluation of the cumulative distribution . with the notable exception of @xmath154 for a single multiple",
    ", we do not have explicit analytic expressions for the cumulative distributions . therefore , in these cases we instead have to map out the analytic probability densities over a grid , and do the integration numerically .",
    "fortunately , this requires only @xmath155 function evaluations , and is therefore computationally quite fast .",
    "the cost of the full gibbs sampler is anyway hugely dominated by sampling from the sky signal distribution @xmath156 .",
    "nevertheless , one might want to consider alternative approaches for applications in which this sampling step may be dominating .",
    "in such cases , the rejection sampler ( e.g. , liu 2001 ) appears as a promising candidate . in this approach , one samples from an auxiliary distribution that preferably should approximate the target distribution quite well .",
    "since our distributions are all one dimensional , and strongly single - peaked , it should not be difficult to establish such auxiliary functions .",
    "indeed , the student s t distribution itself is a typical candidate for such purposes , since it has a quite heavy tail .    in figure",
    "[ fig : samplers ] we compare the marginal distributions obtained by the direct inverse wishart distribution and by the new sampler presented here , for @xmath157 only . as expected , they agree perfectly .",
    "next , in figure [ fig : binning ] we show a single sample from the joint all-@xmath4 distribution @xmath0 , with appropriate binning schemes for each of @xmath158 , @xmath103 and @xmath159 . again , producing a similar sample with the direct inverse wishart sampler is not possible , as discussed above .      next",
    ", we consider blackwell - rao estimators for marginal and conditional distributions , and focus for now on the factorization of @xmath0 given in equation [ eq : factorization ] .",
    "however , we note that any one of the distributions in table [ tab : distributions ] gives rise to a separate estimator .",
    "recall first the derivation of the blackwell - rao estimator @xcite , @xmath160 thus , the full blackwell - rao estimator for @xmath161 is nothing but the sum ( or average ) of @xmath0 over gibbs samples , @xmath6 .",
    "this estimator , as written here , has notoriously poor convergence properties as the dimension of the parameter volume increases @xcite : it requires an exponential number of samples in order to converge .",
    "the reason is simply that the volume of a single gibbs sample is given by cosmic variance alone , whereas the volume of the full distribution is determined also by noise and sky cut .",
    "therefore , even if the width of @xmath0 for a single multipole is as much as , say , 90% of the width of @xmath161 , the relative volume fraction in @xmath162 dimensions is @xmath163 . for @xmath164 ,",
    "this number is @xmath165 , and for @xmath166 it is @xmath167 . clearly , a brute - force blackwell - rao approach will not work for high - dimensional spaces unless the volume ratio per multipole is unrealistically large .",
    "however , the same problem does not affect the marginal distributions described above , because the number of dimensions is low , and typically just one , by construction .",
    "let us consider the blackwell - rao estimator for @xmath168 for a single multipole , @xmath4 .",
    "first , marginalization over other multipoles consists , as usual for mcmc algorithms , simply of disregarding the sample values of all other @xmath4 s . second , marginalization over @xmath158 and @xmath103 is done using the expressions derived in section [ sec : distributions ] , @xmath169    similarly , the blackwell - rao estimator for @xmath170 reads @xmath171 first , note that because @xmath159 is a constant in this expression , @xmath168 is also a constant , and can be disregarded after equation [ eq : te_conditional ] .",
    "second , we emphasize that it is crucial to use the full joint expression for @xmath172 in this estimator , and not the naive `` alternative '' @xmath173 ; the latter approach would require the underlying gibbs samples , @xmath174 , to be drawn conditionally on @xmath159 in original gibbs analysis , and this is usually not the case .",
    "finally , we consider the expression for @xmath175 for a single multipole . however , there is little simplification involved in this expression , as it simply reads @xmath176 where @xmath177 and @xmath5 indicate 2-dimensional @xmath134 matrices .    as a simple illustration , we plot the three blackwell - rao estimators given above for @xmath157 in figure [ fig : br ] , as computed from a low - resolution simulation ( @xmath178 , @xmath179 , gaussian beam of @xmath180 fwhm , and white noise of @xmath181 and @xmath182 for temperature and polarization , respectively ) drawn from a standard @xmath183cdm spectrum .",
    "as expected , the agreement with direct histograms is excellent , but the smoothness and faster convergence of the blackwell - rao estimator make it the preferred choice for most applications .    while these expressions are useful in their own right , for example for plotting marginal or joint power spectra and corresponding confidence regions from a set of gibbs samples ( say , by maximizing and/or integrating the blackwell - rao estimator for each @xmath4 individually ) , their main application lies in providing robust estimates of @xmath184 in terms of univariates .",
    "this may open up for some very interesting possibilities for stabilizing the exponential behaviour of the full multivariate estimator .",
    "this topic will be explored further in a future publication .",
    "we have derived computationally convenient expressions for all marginals of @xmath0 . these expressions may be useful to any cmb analysis method that considers both the cmb sky signal @xmath10 and the power spectrum @xmath5 as unknown parameters .",
    "one prominent example is the cmb gibbs sampler .",
    "we have also presented two specific applications of these expressions .",
    "first , we demonstrated a new sampling algorithm for @xmath0 that supports different binning schemes for each polarization component .",
    "this is useful because most experiments have very different signal - to - noise ratio to temperature and polarization .",
    "second , we have provided explicit expressions for the blackwell - rao estimators for @xmath175 , @xmath170 and @xmath168 .",
    "together , these three can be used to map out the joint distribution @xmath161 for a single multipole in terms of univariate distributions alone .",
    "further , we note that any of the distributions listed in table [ tab : distributions ] give rise a separate , and potentially useful , blackwell - rao estimator .",
    "we thank jeff jewell , greg huey , kris grski and graca rocha for useful and interesting discussions .",
    "we acknowledge use of the healpix software @xcite and analysis package for deriving the results in this paper .",
    "we acknowledge use of the legacy archive for microwave background data analysis ( lambda ) .",
    "the authors acknowledge financial support from the research council of norway ."
  ],
  "abstract_text": [
    "<S> we provide computationally convenient expressions for all marginal distributions of the polarization cmb power spectrum distribution @xmath0 , where @xmath1 denotes the set of ensemble averaged polarization cmb power spectra , and @xmath2 the set of the realization specific polarization cmb power spectra . </S>",
    "<S> this distribution describes the cmb power spectrum posterior for cosmic variance limited data . </S>",
    "<S> the expressions derived here are general , and may be useful in a wide range of applications . </S>",
    "<S> two specific applications are described in this paper . </S>",
    "<S> first , we employ the derived distributions within the cmb gibbs sampling framework , and demonstrate a new conditional cmb power spectrum sampling algorithm that allows for different binning schemes for each power spectrum . </S>",
    "<S> this is useful because most cmb experiments have very different signal - to - noise ratios for temperature and polarization . </S>",
    "<S> second , we provide new blackwell - rao estimators for each of the marginal polarization distributions , which are relevant to power spectrum and likelihood estimation . </S>",
    "<S> because these estimators represent marginals , they are not affected by the exponential behaviour of the corresponding joint expression , but converge quickly . </S>"
  ]
}