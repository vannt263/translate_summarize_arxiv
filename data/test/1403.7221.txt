{
  "article_text": [
    "the large area telescope ( lat ) is the primary instrument on the _ fermi gamma - ray space telescope _",
    "mission , launched on june 11 , 2008 .",
    "it is the product of an international collaboration between doe , nasa and academic us institutions as well as international partners in france , italy , japan and sweden .",
    "the lat is a pair - conversion detector of high - energy gamma rays covering the energy range from 20 mev to more than 300 gev @xcite .",
    "it has been designed to detect gamma rays in a broad energy range , with good position resolution ( @xmath010 arcmin ) and an energy resolution of @xmath110% .",
    "the lat has been routinely monitoring the gamma - ray sky and has shed light on the extreme , non - thermal universe .",
    "a brief and recent review of _ fermi_-lat discoveries can be found in @xcite .",
    "the lat response to gamma rays is parametrized by the so - called `` instrument response functions '' ( irfs ) , which together with the data from the instrument are provided to the scientific community .",
    "as described in @xcite , irfs are derived using monte - carlo ( mc ) simulations and also corrected for discrepancies observed between flight and simulated data , as the lat team gains insight into the in - flight performance of the instrument . in the near future",
    ", major improvements are expected from the new `` pass 8 '' data , such as an increased effective area with respect to the current `` pass 7 '' public data @xcite .",
    "these improvements correspond to a radical revision of the lat event - level analysis .",
    "the optimization of the event reconstruction and of the background rejection , and the full characterization of the new irfs , require the production of large simulated data sets including gamma rays and charged cosmic backgrounds ( protons , heavy ions , electrons ) .",
    "these simulations are also fundamental for high - level analyses which will require a proper evaluation of the residual backgrounds ( e.g. , the extragalactic diffuse emission @xcite or the cosmic electron - positron spectra @xcite )",
    ". + the cherenkov telescope array ( cta ) project @xcite is the next generation of imaging atmospheric cherenkov telescopes ( iacts ) , operating in the high- and very high - energy gamma - ray domain ( between a few tens of gev and 200 tev ) .",
    "it will consist of two arrays of 50 - 100 telescopes of different sizes , located in each hemisphere .",
    "the cta consortium gathers more than 1000 scientists and engineers from more than a hundred institutions world - wide .",
    "the project is currently in its preparatory phase .",
    "the construction is planned to be completed around 2018 - 2020 . during the current cta preparatory phase , large computing and storage resources",
    "are needed mostly for mc studies .",
    "in particular , the selection of the cta sites ( north and south ) has a significant impact on the final sensitivity of the instrument .",
    "the cta mc working group is studying the impact of these various parameters by means of detailed mc simulations of the detector response to extensive air showers .",
    "large sets of simulated events are generated for different primary particles .",
    "moreover , once cta sites have been selected and the construction phase has started , more detailed simulations will be produced in order to test analysis algorithms and to determine the final performance of the instrument .",
    "+ in order to fulfill present and future requirements for mc massive production and data analysis of _ fermi_-lat and cta , we have proposed the use of the egi grid infrastructure and of the dirac ( distributed infrastructure with remote agent control ) @xcite framework for both current and future experiments . the dirac system , originally developed to support production activities of the lhcb experiment , today serves several communities .",
    "compared to lhcb dirac installation , expanding over half a dozen powerful servers , the cta installation is still rather modest , and it is currently being upgraded .",
    "the work presented in this paper was served by a dirac installation running on two virtual servers having , in total , 6 cores , 6 gb of ram and 1.5 tb of local disk , plus a third machine hosting the web portal .",
    "_ fermi_-lat is using the french ngi multi - community dirac installation running on five servers @xcite . in section [ fermi ]",
    "we describe the developments that have been necessary to extend the _",
    "fermi_-lat pipeline to the grid through the dirac system .",
    "the context for cta is quite different , since the project is in its preparatory phase and no existing production system was available for the management of the different computing activities . in section [ cta ]",
    "we present the work done to migrate both the cta mc production and its analysis by the cta physicists on the grid within the dirac framework .",
    "the first results from the mc campaigns in 2013 , in terms of resource usage , are also presented .",
    "section [ conclusions ] is devoted to conclusions and perspectives for future work .",
    "the data acquired by the _ fermi_-lat in orbit is transferred via satellite downlink several times per day , and then sent to an offline processing system , which is hosted by the lat isoc ( instrument science operations centers ) based at the slac national accelerator laboratory in california .",
    "the _ fermi_-lat data processing pipeline ( see , e.g. , @xcite for a detailed technical description ) was designed with the focus on allowing the management of arbitrarily complex workflows and handling multiple tasks simultaneously ( e.g. , prompt data processing , data reprocessings and science analysis ) .",
    "we briefly recall its basic functionalities in section [ lat_pipeline ] .",
    "then we describe its interface to dirac ( section [ lat_dirac ] ) and we present the results of the first mc simulations which we performed on the grid during summer 2013 ( section [ lat_results ] ) .",
    "each pipeline task defines a workflow , specifying a sequence of procedures .",
    "these procedures are then either executed directly on the workflow system or are delegated to job control daemons . from the beginning ,",
    "the system was tailored to be interfaced to local computing resources such as the batch farms at slac and the cnrs / in2p3 computing center ( cc - in2p3 hereafter ) . to that extent",
    ", each job control service has to run as a daemon on a host at the relevant site .",
    "information is exchanged via remote method invocation between the job control service and the pipeline server .",
    "each task may contain an arbitrary number of streams or sub - streams , i.e. instances of a process . in the simplistic case of a mc production ,",
    "each stream creates a run containing a pre - defined number of simulated events . in case of a gamma - ray simulation ,",
    "each stream simulates 5k events in @xmath190 minutes typically , and produces a small volume of data ( @xmath12.3 mb ) when the full details on the event reconstruction are not saved .",
    "[ fermi ] the dirac interface to the data processing pipeline was designed to delegate computationally intense mc production to other sites .",
    "it has been implemented using french ngi dirac servers at cc - in2p3 ( see fig .",
    "[ lategi ] ) , which run all dirac components , workload management system ( wms ) , data management system ( dms ) , agents and web portal , and host the mysql databases .",
    "in addition , a _",
    "fermi_-specific dirac extension was developed through a dedicated package which provides basic api functionality in accordance with the one used in the remaining pipeline system ( see @xcite for a detailed description ) .",
    "in particular , the extension provides wrappers to status query and job submission .",
    "the trigger to submit new jobs is done via the pipeline and its associated user interfaces .",
    "thus , re - running failed jobs is done via the pipeline interface , which in turn results in a fresh re - submission of a dirac job with the exact same properties as the initial ( failed ) job . as a consequence",
    ", our current setup can not fully utilize the possibilities to re - run failed jobs from within dirac . at present , the dirac system employed by _",
    "fermi_-lat does not support the means to request specific resources . as a consequence",
    ", jobs may be sent off to sites where the software is either not available or faulty . instead of relying on discovery services such as those provided by the berkeley database information index ( bdii ) , the _",
    "fermi_-dirac setup makes use of a custom software tag resource database .",
    "this is a separate service which relates a given site in dirac with the available software along with its current status .",
    "statuses are queried automatically through an agent and jobs are matched to sites according to their requirements . even if the matching becomes trivial for mc production ,",
    "since the software releases are installed at all sites , this service is particularly useful during the setup of a production .",
    "furthermore this system provides us with additional steering handles without the need to modify parts of the dirac configuration and or of the pipeline setup .",
    "schematic view of the _ fermi_-lat pipeline extension to the grid through the dirac system .",
    "red arrows indicate the execution sequence of the mc simulation .",
    "data and log file transfers are shown with magenta and orange arrows , respectively .",
    "the blue arrow indicates the registration of data in the _ fermi_data catalog .",
    "the lat software installation on the grid sites is indicated by the green arrow . ]",
    "the worker node that performs the actual computing step communicates with the pipeline through a series of emails , which in the case of local batch systems provides a robust interface . in order to emulate this behaviour ,",
    "the _ fermi_-dirac setup utilizes the dirac notification layer that enables every grid worker node to either send the required email directly or to communicate with the dirac server that then sends the relevant information on behalf of the workers .",
    "output data are stored on regular grid storage elements ( storm , etc . ) but picked up within the pipeline workflow system to be transferred to xrootd at slac ( see fig .",
    "[ lategi ] ) .",
    "once transferred , the data on grid storage elements are scheduled for removal .",
    "a first working prototype of the grid / pipeline interface with dirac was completed in summer 2013 .",
    "the first mc production on the grid consisted of 4000 streams , each one simulating 5k gamma - ray events . this first test",
    "was limited to four egi grid sites supporting the glast virtual organization ( vo ) : cnaf , msfg , obspm and bari ( sorted by resource usage ) .",
    "they represent about one third of the glast vo resources .",
    "the production used between 100 and 300 cores simultaneously , and it ran smoothly with a 97% success rate .",
    "the few failed jobs exhibited communication issues between the grid sites and the pipeline , which need to be further investigated .",
    "the use of the egi grid infrastructure for the mc production was introduced in cta for the first time in 2008 with the creation of the cta vo .",
    "the motivations which led to this choice were the following : large computing and storage requirements for the mc production ( see section [ mc_computing_needs ] ) ; the possibility of generating the required event statistics by splitting the production into independent jobs and the software portability to the grid environment .",
    "today , the cta vo is supported by 21 egi grid sites spread over 7 countries , with resources of the order of several thousands of available logical cores and more than 650 tb of dedicated storage . during the first years",
    ", the grid infrastructure has been exploited exclusively for the mc production activity . however , typical user analysis require the processing of about 30 tb , so that the retrieval of a given dataset for further local processing is quite inefficient . in order to deploy the user analysis to the grid , thus reducing latencies due to the data transfers , and in order to have an optimized usage of the grid resources",
    ", we started the migration of both the mc production and the user analysis into the dirac system in 2011 @xcite ( section [ cta_dirac ] ) .",
    "finally the computing model applied to both these activities is described in section [ cta_cm ] .      in order to estimate the computing and storage requirements for mc studies , we split the simulation chain into three main steps : _ 1 ) _ shower generation and propagation in the atmosphere ; _ 2 ) _ simulation of the telescope array response and _ 3 ) _ reconstruction and analysis .",
    "these steps are executed sequentially and the output of each of them serves as input for the subsequent one .",
    "the first two steps , in which the simulated data are produced , can be executed separately or within the same execution unit .",
    "this ` production ' activity is centralized and performed by a team of managers , in charge of providing the cta consortium with the products of step 2 . in step 3 ,",
    "the ` analysis ' activity is performed by cta users and consists of several tasks .",
    "the products of step 1 , which represent 95% of the overall data volume , are stored and conserved over periods of several months in view of possible re - processing , i.e. the repetition of step 2 with different telescope configurations .",
    "the products of step 2 should be conserved over longer periods of 1 - 2 years .",
    "the necessary statistics for mc studies amounts to @xmath1@xmath2 simulated events for different primary particles . in order to collect such a statistics , each mc campaign",
    "is made of @xmath1200k jobs , each one producing 50k events .",
    "the cpu time needed by a production is @xmath18 m hs06 hours @xcite , 70% of which is consumed by step 1 .",
    "storage also represents a major challenge , since each mc campaign produces @xmath1550 tb of simulated data , including @xmath130 tb to be analyzed by cta users in step 3 .",
    "the dirac functionalities which motivated the migration of both mc computing activities ( production and analysis ) within this framework are the following : optimization of the resource usage thanks to the implementation of the ` pilot job ' mechanism @xcite ; easy customization for the specific needs of a user community ; central management of the different grid activities and of the vo policies ; easy integration of heterogenous resources ; rich user interface ( python api , command line and web portal ) .",
    "moreover , dirac includes its own ` native ' catalog , the dirac file catalog ( dfc ) , which covers all the functionalities of the lhc file catalog ( lfc ) , i.e. the ` replica catalog ' functionalities , offering at the same time the support for user - defined meta - data .",
    "this last feature is particularly desirable in the context of the mc massive production .",
    "indeed , each mc campaign produces about 1 m files which must be organized in a logical structure and whose provenance must be tracked .",
    "additionally , scientists should be able to easily select a given dataset according to some criteria relevant for their analysis .",
    "the dfc has a hierarchical structure where the meta - data key - value pairs are either affected to directories , or to files .",
    "each sub - directory inherits the meta - data of its parent directory , while files inherit the meta - data of their containing directory . finally , it is possible to declare some of the meta - data as ` searchable ' , so that they are exposed for data searches .",
    "the migration of the mc computing activities has been realized in two phases .",
    "the first phase consisted of the deployment of a dirac instance dedicated to cta , which is composed of 4 servers hosted at pic and cc - in2p3 computing centers .",
    "the second phase consisted of the development of a cta - specific dirac extension , called ` cta - dirac ' , which includes the following modules : cta software deployment on the grid ; cta workflow submission ( production and analysis ) and interface of the production workflows to the dfc .",
    "all these modules make use of the dirac api to wrap the cta applications and to manage the output data . in order to interface the production workflows with the dfc",
    ", we have first identified the meta - data that are relevant for searches ( mc software version , particle flavour , cta site altitude , telescope array configuration , etc . ) , as well as non - searchable ones ( application exit status , dirac job identifier , etc . ) .",
    "secondly , we have established a directory structure for the mc products , on the basis of the inheritance rules of the dfc .",
    "finally , the dfc was interfaced with the production workflows , which extract the meta - data values , either from their input configuration parameters , or from run - time informations , to then fill the dfc .",
    "the cta - dirac setup has been successfully exploited during the mc campaigns and analysis in 2013 .",
    "the computing model currently used distinguishes two types of sites , i.e. tier 1 ( t1 ) and tier 2 ( t2 ) , each having a particular role .",
    "the main difference between them is that while t2s provide only cpu , t1s are also providing support for long term storage of the data . with this difference in mind ,",
    "t1s are employed for both mc production and analysis , while t2s are only used for mc production . concerning the mc production , both t1s and t2s participate in terms of cpu , according to their capacity , but",
    "mc products are stored exclusively at t1s . for data",
    "access efficiency reasons , in our model jobs are input - data driven , so that only t1s are used for re - processing and for user analysis , thus acting as ` analysis centres ' . taking into account the storage and cpu requirements for mc production and analysis , t1 must satisfy the following criteria : large storage capacity ( at least 15 - 20% of the total ) ; cpu capacity proportional to the storage capacity and a good cpu - storage connectivity .",
    "also , since t1s are directly exposed to users , they should satisfy high reliability requirements .",
    "t2 requirements are less stringent , and thus they are only required to provide a minimal cpu power and a sufficient connectivity to t1 s storage elements to upload the simulation products . given these requirements , the current cta t1s are : cyfronet , desy and cc - in2p3 , while all other sites supporting cta are considered as t2s .",
    "the overall storage capacity at t1s is of about 650 tb , which allows the storage of only one distributed replica of the mc products .",
    "the computing model just described is flexible , however ; for example , in some cases t2s can be enabled to host a fraction of mc products , thus increasing the overall storage available .    cumulative cpu consumption in the period from january until september 2013 .",
    "the different colors refer to the grid sites where the jobs were executed . ]",
    "cumulative cpu consumption in the period from january until september 2013 .",
    "the different colors refer to the grid sites where the jobs were executed . ]    in the following , we report about the resource usage in the first 9 months of 2013 . in fig .",
    "[ jobs ] , we show the number of concurrent running jobs in the considered period , where we distinguish the mc production in blue and the users analysis in green .",
    "the peaks of activities correspond to the different mc campaigns , during which we were able to achieve stable regimes of 4000 - 5000 jobs .",
    "this value is in good agreement with the resources expected to be available , confirming the efficiency of the dirac wms .",
    "the overall consumed cpu is about 30 m hs06 hours , with the site sharing shown in fig .",
    "[ pie_cpu_used ] .",
    "the main contributor is the cyfronet t1 , while the remaining 50% of the consumed cpu is shared among ten other sites .",
    "the overall volume of the data produced is about 600 tb , with a corresponding number of registered replicas in the dfc of about 3.3 m. the dataset selection , based on dfc meta - data queries , can be done either through the dirac web portal , or through a cta - dirac command line tool .",
    "the dfc response time of the cta - dirac instance is also adequate to the cta usage , since typical user queries return a few tens of thousands of replicas and the average response time is @xmath18 sec per 10k replicas .",
    "finally , it might be noted that about 13% of the cpu time consumed is due to user analysis , with a corresponding number of executed jobs of about 1 m.",
    "in order to exploit the grid resources for the massive mc simulations and analysis of _ fermi_-lat and cta , in both cases we have deployed a prototype setup , based on the dirac framework .",
    "the whole production chain of the _ fermi_-dirac setup has been extensively tested , confirming that the dirac solution fulfils all the requirements imposed by the _",
    "fermi_-lat pipeline . in the medium - term",
    ", we also plan to learn how the overall system behaves under stress through scalability tests , and to optimize the resource usage before entering production mode in view of the massive simulations of `` pass 8 '' backgrounds in fall 2013 . as for cta ,",
    "the dirac setup has been intensively exploited during the mc campaigns in 2013 and the subsequent performance studies for site candidate evaluation .",
    "the perfomance obtained shows that dirac is well adapted to both cta production and analysis activities .",
    "future developments will aim to further automate the management of the mc production , implementing automatic job and data operations according to predefined scenarios .",
    "99 atwood w b et al . 2009 _ the astrophysical journal _ * 697 * 1071 thompson d j 2013 arxiv:1308.1870 ackermann m et al . 2012",
    "_ the astrophysical journal supplement serie _ * 203 * 4 atwood w b et al .",
    "2013 _ 2012 fermi symposium : econf proceedings c121028 _ arxiv:1303.3514 abdo a a et al .",
    "2010 _ physical review letters _ * 104 * 101101 ackermann m et al .",
    "2012 _ physical review letters _ * 108 * 011103 actis m et al .",
    "( cta consortium ) 2011 _ experimental astronomy _ * 32 * 193 tsaregorodtsev a et al .",
    "2008 _ journal of physics : conference series _ * 119 * 062048 arrabito l et al .",
    "dubois r 2009 _ asp conference series _ * 411 * 189 zimmer s et al .",
    "2012 _ journal of physics : conference series _ * 396 * 032121 arrabito l et al .",
    "2012 _ journal of physics : conference series _ * 396 * 032007 http://hepix.caspur.it/benchmarks/doku.php ( last access date : @xmath3 oct ."
  ],
  "abstract_text": [
    "<S> dirac ( distributed infrastructure with remote agent control ) is a general framework for the management of tasks over distributed heterogeneous computing environments . </S>",
    "<S> it has been originally developed to support the production activities of the lhcb ( large hadron collider beauty ) experiment and today is extensively used by several particle physics and biology communities . </S>",
    "<S> current ( _ fermi_large area telescope  lat ) and planned ( cherenkov telescope array  </S>",
    "<S> cta ) new generation astrophysical / cosmological experiments , with very large processing and storage needs , are currently investigating the usability of dirac in this context . </S>",
    "<S> each of these use cases has some peculiarities : _ </S>",
    "<S> fermi_-lat will interface dirac to its own workflow system to allow the access to the grid resources , while cta is using dirac as workflow management system for monte carlo production and analysis on the grid . </S>",
    "<S> we describe the prototype effort that we lead toward deploying a dirac solution for some aspects of _ fermi_-lat and cta needs . </S>"
  ]
}