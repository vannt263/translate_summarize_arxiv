{
  "article_text": [
    "gamma - ray bursts ( grbs ) with high quality afterglow data sometimes exhibit features ( such as bumps and wiggles , e.g. , grb 021004 , 030329 , * ? ? ?",
    "* ; * ? ? ?",
    "* ) that deviate from the simple power law decay expected in the standard afterglow model @xcite .",
    "one of the most popular and appealing scenarios to account for these features is to invoke a sudden density change in the circumburst medium , e.g. , a density bump or void .",
    "indeed , a density bump has been invoked to interpret some re - brightening features observed in some afterglow light curves ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and density fluctuation has been invoked to interpret wiggles in some light curves ( e.g. * ? ? ?",
    "however , more detailed numerical investigations have shown that the forward shock ( fs ) wave encountering a bumpy structure does not produce a prominent re - brightening signature in the light curves @xcite .",
    "in addition to the fs , a reverse shock ( rs ) is expected to propagate through the burst ejecta .",
    "the rs can be long - lived if there is a stratification in the ejecta s lorentz factor @xmath0 ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , or if the central engine is long - lived ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "an arising question here is then what should happen to the rs if it is present when the blast wave encounters an ambient density structure .",
    "this problem was first studied in @xcite for the density bump case , briefly with a numerical example .",
    "@xcite showed that when a blast wave with a long - lived rs meets bumps , the rs light curves exhibit prominent signatures while the fs light curves show no significant feature as mentioned above .    in this paper",
    ", we investigate this problem in detail - stratification long - lived rs in this paper .",
    "the investigation may also be generalized to the long - lived rs scenario invoking a long - lasting central engine . ] .",
    "we consider various shapes of density bumps in the ambient medium and extend the study to also include different shapes of density voids and step - like density structures .    as a blast wave propagates , the volume of shocked gas in the blast region increases .",
    "this implies that there is adiabatic conversion of the internal ( thermal ) energy of shocked gas into the kinetic bulk motion of the blast through @xmath1 work on itself , which we call `` adiabatic cooling '' of the blast wave .",
    "we prepare our numerical examples in such a way that comparisons among those can help us to demonstrate the role of adiabatic cooling and to propose a number of `` consistency tests '' that correct modeling of blast waves with a long / short - lived rs needs to satisfy .",
    "in order to find the blast wave dynamics of those problems described in section   [ section : introduction ] with the density structures in the ambient medium , we make use of the semi - analytic formulation of relativistic blast wave , presented in @xcite ( hereafter u11 ) . instead of using a pressure balance across the blast wave , u11 applies the conservation laws of energy - momentum tensor and mass flux to the blast region between the fs and the rs , so that the two shock waves are `` connected '' through the blast via the relevant physics laws .",
    "the simple prescription of pressure balance does not provide an accurate solution for the blast wave dynamics , as shown in u11 .",
    "u11 solves a continuity equation for the evolving ejecta flow to deal with its spherical expansion and radial spread - out and then determines which ejecta shell gets shocked by the rs at a certain radius .",
    "u11 also takes into account a variable adiabatic index @xmath2 for shocked gas in the fs and rs regions .",
    "this is particularly important in describing the rs shocked gas since the rs strength evolves from the non - relativistic regime to mildly relativistic or even relativistic regime as the blast wave propagates ( in a constant density medium ) , or vice versa ( in a wind medium ) .",
    "the formulation presented in u11 is applicable to a general class of grb problems with a long - lived rs or with a short - lived rs , admitting an arbitrary radial stratification of the ejecta flow and the ambient medium . for this general kind of grb blast waves , for which the fs dynamics should deviate from the self - similar solution of @xcite",
    ", u11 provides an accurate numerical solution for both the fs and rs dynamics .",
    "this formulation also enables us to find a correct solution of the blast wave continuously from the initial coasting phase through the deceleration stage .    on the side of afterglow calculation , we make use of the lagrangian description of the blast wave , described in @xcite ( hereafter u12 ) .",
    "this description views the blast as being made of many different lagrangian shells , piling up from the fs and rs fronts .",
    "each shell in u12 has it own radius , pressure , energy density , adiabatic index , magnetic field , and electron energy distribution .",
    "this description is therefore significantly more sophisticated than the simple analytical afterglow model @xcite which assumes that the entire postshock region forms a single zone with the same radius , energy density and magnetic field , endowed with a single broken power - law distribution of electron energies .    as the blast wave propagates",
    ", u12 keeps track of the adiabatic evolution of each shell and finds its current energy density , adiabatic index , and magnetic field . as for the electron energy spectrum , a minimum lorentz factor @xmath3 and a cooling lorentz factor @xmath4",
    "are numerically calculated for each shell at every calculation step by solving the full differential equation , equation ( 17 ) in u12 , which describes radiative and adiabatic cooling of electrons .",
    "in u12 was solved only for adiabatic loss that dominates over radiative loss for low energies . in this paper",
    ", we use the same full equation ( including both cooling terms ) to calculate both @xmath3 and @xmath4 , for completeness . ]",
    "u12 fully takes into account the curvature effect of every shell ( the doppler boosting of radial bulk motion and the spherical curvature of the shell ) , considering the fact that each shell has its own radius .",
    "the afterglow light curves are found by integrating over all lagrangian shells , collecting photons emitted from each shell for every equal - arrival observer time @xmath5 .",
    "the importance of these detailed calculations is demonstrated , for instance , in our recent paper regarding on the shape of afterglow spectra where we show that a cooling break is very smooth and occurs gradually over several orders of magnitude in frequency and in observer time @xcite .",
    "we present 9 different numerical examples ( named as 1a , 1b , 1c , 1d , 1e , 1f , 1 g , 1h , 1i ) with a long - lived rs and 5 different examples ( named as 2a , 2c , 2d , 2f , 2 g ) with a short - lived rs .",
    "for all 14 examples , we keep the followings to be the same : ( 1 ) the burst is assumed to be located at a cosmological distance with redshift @xmath6 . as in u12 , we adopt a flat @xmath7cdm universe to calculate the luminosity distance , with the parameters @xmath8 km @xmath9 @xmath10 , @xmath11 , and @xmath12 .",
    "( 2 ) the microphysics parameters are @xmath13 ( power law index of injected electrons ) , @xmath14 ( fraction of internal energy for accelerated electrons ) , and @xmath15 ( fraction of internal energy in magnetic fields ) for the rs light curves , and @xmath13 , @xmath16 , and @xmath17 for the fs light curves . and/or @xmath18 , we can further enhance or suppress the fs or the rs light curves .",
    "however , we fix the microphysics parameters for these 14 examples in order to focus our study on the response to density structures of the ambient medium . ]",
    "( 3 ) the ejecta has a constant kinetic luminosity @xmath19 for a duration of @xmath20 , so that the total isotropic energy of the burst is @xmath21 .    for all 5 examples with a short - lived rs",
    ", the ejecta is assumed to emerge with a constant lorentz factor @xmath22 .",
    "for all 9 examples with a long - lived rs , we assume a simple and monotonic stratification on the ejecta lorentz factors @xmath23 , which decreases exponentially from 500 to 5 for a duration of @xmath20 ; see figure  [ fig : gej1 ] . a detailed investigation invoking various shapes of ejecta stratifications",
    "is presented in u12 , where we explain how a density structure in the evolving ejecta affects the fs and rs dynamics and leaves its signature on the fs and rs light curves .",
    "for the present study , we keep one simple ejecta stratification and then examine what kind of imprints a density structure in the ambient medium leaves on the dynamics and afterglow light curves .",
    "the difference among our examples goes on the radial profile of the ambient medium density .",
    "a constant density is assumed for the example 1a .",
    "the examples 1b , 1c , and 1d have a density bump in the ambient medium while the examples 1e , 1f , and 1 g have a void in the medium .",
    "the example 1h has an increasing step in the density profile whereas the example 1i has a decreasing step in the profile .",
    "a detailed shape of these density structures is given below .",
    "the example names with the same alphabet but different numbers ( 1a vs. 2a , 1c vs. 2c , etc . )",
    "share the same density profile . in order to provide an efficient comparison among examples , we form groups of examples below .",
    "the example 1a has a constant density @xmath24 in the ambient medium . here , @xmath25 is the proton mass .",
    "we denote this density by @xmath26 and use it as our fiducial base to place other density structures on . for comparison , we place all the structures at a same radius @xmath27 .",
    "the example 1b has a density bump of gaussian shape on top of the base , i.e. , @xmath28 , where @xmath29 is the amplitude of the bump such that the peak density is 5 times the base density . as for the spatial spread of the bump",
    ", we use a 10 % of its location ; @xmath30",
    ". this value will serve as our fiducial size @xmath31 .",
    "the example 1c has the same density profile as in the example 1b , except that the amplitude of the bump is @xmath32 , so that the peak density is 10 times the base density .",
    "the density profiles of the examples 1a , 1b , and 1c are shown together in the panel ( a ) of figure  [ fig : alldyn_1a1b1c ] ; three different line ( color ) types are used to denote for each example , respectively .",
    "the panel ( a ) also shows the density @xmath33 of the ejecta shell that gets shocked by the rs when the rs is located at radius @xmath34 . for a non - stratified ejecta",
    ", a simple spherical expansion leads to an @xmath35 decrease in the ejecta density .",
    "however , for a stratified ejecta , the ejecta density decreases faster than @xmath35 due to a radial spread - out of the evolving ejecta flow with a non - vanishing gradient @xmath36 . in the case of an exponential stratification of @xmath37 , u12 ( section 4.1 )",
    "shows that @xmath38^{-1}$ ] has a constant value , and as a result , @xmath39 is satisfied for @xmath40 .",
    "this behavior is shown in the panel ( a ) . in the panel ( b ) , the three curves labeled by @xmath41 show the lorentz factor of the ejecta shell that passes through the rs when the rs is at @xmath34 .",
    "the three curves labeled by @xmath42 show the lorentz factor of the blast wave as a function of the rs radius @xmath34 .",
    "the relative lorentz factor @xmath43 between @xmath42 and @xmath41 is shown in the panel ( c ) .",
    "the @xmath43 curve is a measure of the rs strength .",
    "panel ( d ) shows the evolution of the rs pressure @xmath44 and fs pressure @xmath45 as a function of @xmath34 .",
    "the ejecta shells with low lorentz factors run after the blast wave and gradually `` catch up '' with it at late times , adding their energy to the blast .",
    "thus , the blast wave is continuously pushed , and its deceleration deviates from the self - similar solution of @xcite ; the @xmath42 curve of the example 1a shows that its blast wave decelerates slower than the bm solution @xmath46 . for the examples 1b and 1c , while encountering a density bump , the @xmath45 curve rises and as a consequence the @xmath42 curve decreases strongly .",
    "then , the shell catching - up speeds up ( as indicated by a strong rise in @xmath43 curve ) and quickly occurs for a wide range of ejecta shells ( as shown by a fast decrease in @xmath41 curve ) .",
    "the rise in @xmath43 curve gives the rise in the @xmath44 curve .",
    "now climbing down the density bump , the @xmath45 curve decreases rapidly .",
    "the @xmath45 curve goes even below the solid ( black ) curve of the example 1a since its blast wave has been decelerated significantly due to the bump encountering .",
    "the rapid decline in @xmath45 curve , together with adiabatic cooling of the blast wave , makes the @xmath42 curve start to recover from a fast decline phase ; the @xmath41 curve also starts to flatten , changing its shape to a concave curve .",
    "consequently , the shell catching - up slows down and the @xmath43 curve decreases , so does the @xmath44 curve .",
    "moving away from the bump region , the @xmath45 curve is still well below the solid ( black ) curve of the example 1a , retaining in memory the previous deceleration history due to the bump .",
    "the low fs pressure , combined with ongoing adiabatic cooling of the blast wave , makes the @xmath42 curve continue to recover ; note that the @xmath42 curve of the example 1c exhibits a period of an actual acceleration of the blast wave .",
    "this continuing recovery in @xmath42 curve further slows down the shell catching - up and makes the @xmath43 curve continue to decrease below the solid ( black ) curve . accordingly",
    ", the @xmath44 curve also goes below the solid ( black ) curve .",
    "as the @xmath45 curve approaches back to the solid ( black ) curve , the recovery tendency in @xmath42 curve weakens and the @xmath43 curve begins to rise again . since the examples 1a , 1b , and 1c are given the same burst energy and ejecta stratification , the three @xmath42 curves , after all , should agree with one another , if the adiabatic conversion of internal energy has been properly taken care of . an important consistency test of whether the modeling is correct would be whether different models converge after the bump phase . an excellent agreement in @xmath42 curves as well as in other curves ( i.e. , @xmath41 , @xmath43 , @xmath45 , and @xmath44 curves ) is seen in figure  [ fig : alldyn_1a1b1c ] , suggesting the correctness of the modeling .",
    "also , as described by the example 1c and other examples below , correct modeling should be able to capture an acceleration phase of the blast wave when the ambient medium density drops rapidly .",
    "@xcite also considered the role of adiabatic cooling and reproduced an acceleration phase of the blast wave .",
    "the afterglow light curves of the examples 1a , 1b , and 1c are shown in figure  [ fig : crx_1a1b1c ] . in panel",
    "( a ) , we show the rs emission in x - ray ( 1 kev ) and _ r _ band as a function of the observer time @xmath5 . in panel",
    "( b ) , we show the fs emission in x - ray ( 1 kev ) and _ r _ band .",
    "the example 1a shows that , during the deceleration phase , the fs and rs light curves decline with a very similar value of decay indices ; a detailed explanation regarding this point is given in u12 . for the examples 1b and 1c , while encountering a density bump , a signature corresponding to the bump is visible on both the fs and the rs light curves , but with a stronger re - brightening feature imprinted on the rs light curves .",
    "the feature is stronger for the example 1c than for the example 1b , since the bump is bigger in the example 1c than in the example 1b . after exhibiting the re - brightening feature ,",
    "the rs light curves go even below the solid ( black ) curve of the example 1a and then approach back to the solid ( black ) curve ( just as the @xmath43 curve behaves ) .",
    "this interesting behavior is not clearly present in the fs light curves .",
    "this group includes a new example 1d , whose density profile @xmath47 in the ambient medium also has a gaussian bump on top of the base density @xmath26 at the same location @xmath27 .",
    "the amplitude of the bump is @xmath48 so that the peak density is 20 times the base density .",
    "as for the spatial spread of the bump , we choose @xmath49 such that the bump of the examples 1c and 1d contains a same amount of mass , @xmath50 4\\pi r^2\\,{\\rm d}r$ ] .",
    "recalling that the example 1c has @xmath32 and @xmath51 , we obtain @xmath49 for the example 1d , which is about @xmath52 .    the blast wave dynamics of the examples 1a , 1c , and 1d are shown together in figure  [ fig : alldyn_1a1c1d ] ; all 4 panels have the same notations as in the previous group ( 1a/1b/1c ) .",
    "one can read through the panels and understand the fs and rs dynamics , in the same way as we did above .",
    "in particular , we point out that since the examples 1c and 1d have the same mass contained in the bump , their dynamical evolution ( i.e. , @xmath42 , @xmath41 , @xmath43 , @xmath45 , and @xmath44 curves ) agrees with each other as soon as their blast wave goes beyond the bump region ( even before converging with the solid ( black ) curves of the example 1a ) .",
    "this agreement among examples with an equal bump mass serves as another consistency test .",
    "the afterglow light curves of the examples 1a , 1c , and 1d are shown together in figure  [ fig : crx_1a1c1d ] .",
    "although the examples 1c and 1d have the same bump mass , the bump in the example 1d is narrower than in the example 1c .",
    "accordingly , the rs light curves show a more concentrated re - brightening feature in the example 1d than in the example 1c . for the fs light curves , the difference between the two examples appears to be very small .",
    "the new examples 1e and 1f here have a density void in the ambient medium , located at radius @xmath53 .",
    "a gaussian shape is removed from our base density @xmath54 and thus the density profile is given by @xmath55 .",
    "for both examples 1e and 1f , we use a void amplitude @xmath56 so that the minimum density is 1/10 of the base density . as for the spatial spread of the void",
    ", the example 1e has @xmath57 while the example 1f has @xmath58 .",
    "the blast wave dynamics of the examples 1a , 1e , and 1f are shown together in figure  [ fig : alldyn_1a1e1f ] .",
    "when the blast wave of the examples 1e and 1f encounters a density void shown in panel ( a ) , its @xmath45 curve declines rapidly .",
    "this @xmath45 decline then , together with adiabatic cooling of the blast wave , makes the blast wave decelerate slowly , resulting in a flattening in the @xmath42 curve . as a result",
    ", the shell catching - up occurs slowly ( as indicated by a flattening in the @xmath41 curve and also by a decline in the @xmath43 curve ) .",
    "the decline in the @xmath43 curve gives the decline in the @xmath44 curve .",
    "now climbing up the void hill ( the outer side of void ) , the @xmath45 curve rises rapidly .",
    "the @xmath45 curve goes even above the solid ( black ) curve of the example 1a since its @xmath42 curve is above the solid ( black ) curve ( due to the void encountering ) .",
    "the rapid rise in @xmath45 curve makes the @xmath42 curve start to turn into a fast decline phase ; the @xmath41 curve also changes its shape to a convex curve .",
    "consequently , the shell catching - up speeds up and the @xmath43 curve resumes rising .",
    "the @xmath44 curve also rises back as the @xmath43 curve resumes rising .",
    "escaping from the void region , the @xmath45 curve is still above the solid ( black ) curve of the example 1a , retaining the memory of the previous history of void encountering .",
    "the high fs pressure makes the @xmath42 curve continue to decline fast and thus makes the @xmath43 curve continue to rise above the solid ( black ) curve .",
    "hence , the @xmath44 curve also goes above the solid ( black ) curve .",
    "as the @xmath45 curve gradually approaches back to the solid ( black ) curve , the fast - decline tendency in @xmath42 curve weakens and therefore the @xmath43 curve begins to decrease again . for the same reason we discussed above for bumps , the blast wave evolution ( i.e. , @xmath42 , @xmath41 , @xmath43 , @xmath45 , and @xmath44 curves ) of these three examples 1a , 1e , and 1f should agree with one another , after all . the agreement shown in figure  [ fig : alldyn_1a1e1f ] , while invoking for density voids , also serves as a consistency test for the correctness of modeling .",
    "the afterglow light curves of the examples 1a , 1e , and 1f are shown in figure  [ fig : crx_1a1e1f ] .",
    "for the examples 1e and 1f , while encountering a density void , a dip signature corresponding to the void is visible on both the fs and the rs light curves , but with a stronger feature imprinted on the rs light curves . the feature is stronger for the example 1f than for the example 1e , since the void is bigger in the example 1f than in the example 1e . after exhibiting the dip feature , the rs light curves go even above the solid ( black ) curve of the example 1a and then approach back to the solid ( black ) curve , just as the @xmath43 curve behaves .",
    "this behavior is not present in the fs light curves .",
    "the new example 1 g here has a density void in the ambient medium at the same location @xmath53 .",
    "its density profile is given by @xmath59 , with the void amplitude @xmath60 so that the minimum density is 1/20 of the base density @xmath54 .",
    "we choose @xmath49 such that the examples 1f and 1 g have a same value for the integration @xmath50",
    "4\\pi r^2\\,{\\rm d}r$ ] , to ensure that an equal amount of mass is reduced by the void in the examples 1f and 1 g .",
    "note that we use a boxier shape of functional form for the void of the example 1 g , so that an equality of the integration above gives a narrower void for the example 1 g .",
    "the blast wave dynamics of the examples 1a , 1f , and 1 g are shown together in figure  [ fig : alldyn_1a1f1 g ] .",
    "again , one can read through the panels and understand the fs and rs dynamics .",
    "note that the @xmath42 curve of the example 1 g shows a period of an actual acceleration of the blast wave .",
    "since the void of the examples 1f and 1 g reduces an equal amount of mass from the base , the blast wave evolution of these two examples agrees with each other as soon as their blast wave goes beyond the void region , even before converging with the solid ( black ) curves of the example 1a .",
    "this serves as another consistency test .",
    "the afterglow light curves of the examples 1a , 1f , and 1 g are shown together in figure  [ fig : crx_1a1f1 g ] .",
    "the examples 1f and 1 g show a small difference on the rs light curves , while almost no difference on the fs light curves is observed between these two examples .",
    "the new examples 1h and 1i invoke a step - like density structure .",
    "the example 1h has a density profile @xmath61^{-1}$ ] , with an amplitude @xmath29 .",
    "the density increases from the base @xmath54 by a factor of 5 , through the step that is located at a radius @xmath53 in a length scale @xmath62 .",
    "the example 1i has the same density profile except that @xmath63 .",
    "then , the density decreases from the base by a factor of 5 .",
    "see panel ( a ) in figure  [ fig : alldyn_1a1h1i ] .",
    "the blast wave dynamics of the examples 1a , 1h , and 1i are shown together in figure  [ fig : alldyn_1a1h1i ] .",
    "for the example 1h , while encountering the rising step , the blast wave shows the same behavior as in the rising phase of the bumps .",
    "however , after that there is no rapid decline in the density and thus no rapid decline in the @xmath45 curve .",
    "therefore , the @xmath42 curve does not recover from the fast decline and stay well below the solid ( black ) curve .",
    "propagating further on a constant density medium lifted up from the base , the blast wave gradually stabilizes and the @xmath43 curve returns back to the solid ( black ) curve , so does the @xmath44 curve .",
    "the @xmath45 curve also approaches back to the solid ( black ) curve ( propagating with lower @xmath42 at higher @xmath64 region ) , but does not agree with the solid ( black ) curve .",
    "similarly , for the example 1i , while encountering the descending step , the blast wave shows the same behavior as in the descending phase of the voids .",
    "again , after that there is no rapid rise in density and thus no rapid rise in the @xmath45 curve .",
    "hence , the @xmath42 curve does not turn into a rapid decline phase and stay well above the solid ( black ) curve . moving further on a constant density medium",
    "shifted down from the base , the blast wave gradually adjusts to the lower step and the @xmath43 curve returns to the solid ( black ) curve , so does the @xmath44 curve .",
    "the @xmath45 curve also approaches back to the solid ( black ) curve ( propagating with higher @xmath42 at lower @xmath64 region ) , but does not completely agree with the solid ( black ) curve .    the afterglow light curves of the examples 1a , 1h , and 1i are shown together in figure  [ fig : crx_1a1h1i ] . for the example 1h , the rs light curves show a mild re - brightening and then approach back to the solid ( black ) curve .",
    "the fs light curves also respond to the rising phase of the step structure , but do not approach back to the solid ( black ) curve . for the example 1i , the rs light curves decline initially , responding to the descending phase of the step structure , and then go back to the solid ( black ) curve . note that this kind of behavior in light curves has often been interpreted as an fs wave exhibiting a jet break ( for the initial steepening ) , followed by a late - time energy injection ( for the flattening ) . here",
    "we present a simple way to reproduce such a behavior , i.e. , an rs wave responding to a descending step structure .",
    "the fs light curves of the example 1i also respond to the step , but again do not approach back to the solid ( black ) curve .",
    "as mentioned above , the examples with the number 2 in their names have a short - lived rs , with a constant ejecta lorentz factor @xmath22 . for the external ambient medium , three examples 2a , 2c , and 2d here",
    "share the same density profile with the examples 1a , 1c , and 1d , respectively .",
    "recall that the example 1a has a constant density @xmath54 ( our base ) , and the examples 1c and 1d have a density bump on top of the base .    in figure",
    "[ fig : dyn_2a2c2d ] , we show the blast wave dynamics of the examples 2a , 2c , and 2d together .",
    "the notations are the same as in the previous groups of examples with a long - lived rs .",
    "we show the @xmath42 and @xmath41 curves in the panel ( a ) and the @xmath45 and @xmath44 curves in the panel ( b ) .",
    "the @xmath41 and @xmath44 curves exhibit an early end when the rs crosses the end of the ejecta .",
    "after that , there is no more ejecta shells catching up with the blast wave .",
    "hence , the @xmath42 curve of the example 2a transitions to and then agrees with the blandford - mckee deceleration . for the examples 2c and 2d",
    ", the fs dynamics ( i.e. , @xmath42 and @xmath45 curves ) responding to the density bump can be understood in the same way as in the group ( 1a/1c/1d ) .",
    "an early agreement between 2c and 2d curves beyond the bump region is observed again since the bump in those two examples contains a same amount of mass .",
    "it is also observed that all three examples 2a , 2c , and 2d agree with one another in the fs curves as their blast wave propagates further away from the bump region , suggesting the correctness of our modeling .",
    "these agreements serve as a consistency test here .    in figure",
    "[ fig : crx_fs_2a2c2d ] , we show the fs light curves of the examples 2a , 2c , and 2d together . for the examples 2c and 2d , the fs light curves responding to the density bump exhibit the same behavior as in the group ( 1a/1c/1d ) .      the new examples 2f and 2 g share the same density profile with the examples 1f and 1 g , respectively .",
    "recall that the examples 1f and 1 g have a density void in the ambient medium . in figure",
    "[ fig : dyn_2a2f2 g ] , we show the blast wave dynamics of the examples 2a , 2f , and 2 g together . for the examples 2f and 2",
    "g , the fs dynamics ( i.e. , @xmath42 and @xmath45 curves ) responding to the density void can be understood in the same way as in the group ( 1a/1f/1 g ) .",
    "an early agreement between 2f and 2 g curves beyond the void region is observed since the void in those two examples reduces a same amount of mass from the base .",
    "also , all three examples 2a , 2f , and 2 g agree with one another in the fs curves as their blast wave propagates further away from the void region , suggesting the correctness of the modeling .    in figure",
    "[ fig : crx_fs_2a2f2 g ] , we show the fs light curves of the examples 2a , 2f , and 2 g together . for the examples 2f and 2 g , the fs light curves responding to the density void exhibit the same behavior as in the group ( 1a/1f/1 g ) .",
    "in this paper , we have investigated the blast wave dynamics and afterglow light curves of a grb blast wave encountering various density structures in the surrounding ambient medium .",
    "we use the semi - analytic formulation of relativistic blast waves ( presented in u11 ) to find an accurate numerical solution for both the fs and rs dynamics and employ the lagrangian description of the blast waves ( presented in u12 ) to perform a sophisticated calculation of afterglow emission .",
    "in particular , we consider numerical examples with density bumps , voids , or steps in the ambient medium and present their fs and rs dynamics and light curves .",
    "we form groups of examples in order to provide an efficient comparison among them and to help readers understand how the fs and rs dynamics should behave when the blast waves encounter those density structures . giving a detailed explanation on their dynamics , we stress on the important role of adiabatic cooling of blast waves and then propose a number of consistency tests that correct modeling of blast waves needs to satisfy .",
    "we also present examples with a short - lived rs and show that the same consistency tests need to be satisfied for the fs dynamics .",
    "all these tests should serve as an accuracy indicator for any future ( analytical , numerical , or hydrodynamical ) modeling of blast waves with a long / short - lived rs .",
    "we point out that the rs dynamics responding to density structures in the ambient medium is studied extensively for the first time here .",
    "also , the fs dynamics responding to density voids is presented here for the first time . as a summary , in figure  [ fig : dyn_1ato1 g ] , we show together the blast wave dynamics of examples with a long - lived rs for bumps ( i.e. , 1b , 1c , and 1d ) and voids ( i.e. , 1e , 1f , and 1 g ) ; the example 1a with our constant base density is also shown together . the fs and rs dynamics exhibit again an excellent agreement among examples beyond the bump / void region . in figure",
    "[ fig : crx_1ato1 g ] , we show together the fs and rs light curves of these 7 examples .",
    "it appears that the rs light curves can produce some interesting observed features such as re - brightenings , dips , and slow wiggles , while the fs light curves in general produce weaker and smoother features , which may not be able to interpret significant bumps and wiggles observed in some afterglows .",
    "why does the bump / void leave such a different imprint on the fs and rs light curves ?",
    "the question is intriguing since the @xmath45 and @xmath44 curves exhibit a similar degree of response signature for bumps or voids ( as one can see from figure  [ fig : dyn_1ato1 g ] ) .",
    "we first recall that different microphysics parameters are adopted for the fs and rs ; @xmath14 and @xmath15 for the rs light curves and @xmath16 and @xmath17 for the fs light curves , so that the fs and rs spectral density fluxes become comparable to each other . as a first step , we examine the effect of microphysics parameters on the response feature . in general , a higher value of @xmath18 or @xmath65 gives a weaker response signature on both the fs and the rs light curves .",
    "if we increase @xmath18 , the compton parameter @xmath66 increases , which makes the electrons cool faster . if we increase @xmath65 , the magnetic field strength @xmath67 increases , which also makes the electrons cool faster . in either case , the cooling lorentz factor of our lagrangian shells decreases faster . as a result ,",
    "a smaller number of recently shocked shells have the electrons that can contribute to the x - ray or _",
    "r _ band emission .",
    "in other words , for a higher @xmath18 or @xmath65 value , a smaller region of the blast wave responds to bumps or voids , leaving a weaker signature on the light curves .",
    "conversely , a lower value of @xmath18 or @xmath65 gives a stronger response signature on both the fs and the rs light curves .",
    "for the same parameters @xmath14 and @xmath68 adopted for both shocked regions , the rs light curves show a stronger signature than in figure  [ fig : crx_1ato1 g ] whereas the fs light curves show an even weaker ( nearly negligible ) signature than in figure  [ fig : crx_1ato1 g ] .",
    "therefore , the different microphysics parameters that we adopted for the fs and rs regions do not provide an explanation for the question . in fact , the microphysics parameters are chosen in such a way that the bump / void signature becomes enhanced on the fs light curves as compared to the rs light curves .",
    "the different signatures imprinted on the fs and rs light curves can be mainly understood by considering the influence of injection lorentz factor of electrons .",
    "as the blast wave encounters density bumps , the @xmath45 curve rises , but the @xmath42 curve declines , which decreases the injection lorentz factors in the fs fresh shells .",
    "hence , there is competition between the rising energy density of shocked gas and the declining injection energy of electrons in the fs region .",
    "on the other hand , while encountering density bumps , the @xmath44 and @xmath43 curves rise together .",
    "thus , there is synergy between the rising energy density of shocked gas and the rising injection energy of electrons in the rs region .",
    "similarly , as the blast wave encounters density voids , the fs region has competition between the decreasing energy density of shocked gas and the flattening ( or increasing ) injection energy of electrons .",
    "the rs region has again synergy between the declining energy density of shocked gas and the decreasing injection energy of electrons .",
    "this is the main source of the fs / rs asymmetry in response to the bump / void structures in the ambient medium .",
    "another ( secondary ) reason for different imprints on the fs and rs comes from the intrinsic difference of the fs and rs propagation direction in the co - moving fluid frame .",
    "the fs propagates forward in the co - moving frame , so that the photons emitted from fresh shells are `` mixed '' together with the photons coming from old shells inside the shocked region .",
    "this photon mixing among the fresh and old shells tends to smooth out the bump / void signature in the fs light curves . on the other hand ,",
    "the rs propagates backward in the co - moving frame , so that the photons emitted from fresh shells should arrive later than the photons coming from old shells inside the shocked region .",
    "thus , there is no photon mixing among the fresh and old shells , which helps the rs light curves keep the bump / void signature .",
    "the fs / rs asymmetry presented in this paper provides an important insight on the origin of afterglow emission . in reality",
    ", the observed light curves do not distinguish the contribution of the rs from the fs . in the standard framework of afterglow production by a blast wave with a short - lived rs , the contribution from the rs region after the rs crossing the end of the ejecta has a distinguishable temporal index ( @xmath69 ) in the observed light curves .",
    "however , when a blast wave with a long - lived rs is considered , the contribution from the rs region can not be easily distinguished from the fs contribution by simply looking at the temporal index of the observed light curves . under these circumstances ,",
    "one possible way to distinguish one from the other would be to investigate in detail their response features due to the inhomogenities in the ambient medium ( as we do here in this paper ) or in the ejecta stratification ( as presented in u12 ) . as we showed in this paper and u12",
    ", these inhomogenities generally leave a lot stronger signatures in the rs light curves than in the fs light curves . therefore , these results suggest that the observed light curves with strong features favor toward the rs origin .",
    "one may think that the fs emission could account for some weak features .",
    "we believe that the spectral evolution of the fs and rs emission during the bump / void encounters may help further distinguish one from the other in the future , which will be investigated elsewhere . for the observed light curves without any noticeable feature ,",
    "we believe that the future measurements of `` polarization degree curves '' for a longer time scale , say , up to hours or days , would hold a key to distinguish the contribution of the rs from the fs .    we also add another important remark regarding the possibility to differentiate between the two popular scenarios to account for the observed light curve features , i.e. , the inhomogenities in the ambient medium ( the current paper ) or in the ejecta structure ( u12 ) .",
    "these two popular scenarios in fact give rise to different signatures .",
    "it appears that , for the rs emission , the inhomogenities in the ambient medium leave a stronger feature in the optical light curves than in the x - ray light curves , whereas the inhomogenities in the ejecta structure leave a stronger feature in the x - ray light curves than in the optical light curves .",
    "this tendency is shown in the current paper and u12 , but requires a more detailed investigation to enable a better understanding on the underlying physics . if this is indeed the case , and if the observed emission is dominated by the rs emission , then the multi - wavelength afterglow observations will be able to differentiate the two scenarios",
    ".    the bump / void structures presented in our models are essentially concentric shells of high or low density medium stacked upon each other . however , in reality , these structures should be three dimensional in nature , surrounded by an inter - clump medium ( icm ) .",
    "this 3-d aspect of the structures would then significantly alter the dynamics of the blast wave .",
    "it can be expected that the blast wave dynamics can be dominated by the uniform icm rather than the bump / void structures if the clumps of these structures are sufficiently small . in this case , however , those small clumps would not leave significant features anyway , and the observed light curves would be dominated by the uniform icm . for large clumps that could considerably affect the blast wave dynamics",
    ", we believe that our models can still reasonably apply when the clumps along the line of sight are as big as the visible area with an angular size @xmath70 .",
    "we also studied the step - like density structures in the paper .",
    "these structures may exist as a consequence of pre - ejection history from the central engine .",
    "when the relativistic blast wave encounters previously - ejected slowly moving denser shells , these shells could act as an ascending step - like structure .",
    "when the blast wave exits these denser shells , it experiences a descending step structure . in the case of a wind environment , a rapid change in the mass - loss rate in the past could create a step - like density structure .",
    "note that these situations would probably create a relatively spherical density structure when viewed from the jetted blast wave .",
    "we stress that a descending step structure is proposed here to give a natural explanation for a dip feature  a steepening followed by a flattening  in grb light curves .",
    "we thank the anonymous referee for many helpful comments and suggestions , which allowed us to improve the presentation of the paper .",
    "this work is supported by the china postdoctoral science foundation through grant no .",
    "2013m540813 , and national basic research program ( `` 973 '' program ) of china under grant no . 2014cb845800 .                                                     of each example",
    "is shown in panel ( a ) in different line ( color ) types .",
    "panel ( a ) also shows the density @xmath72 of the ejecta shell that gets shocked by the rs when the rs is located at radius @xmath34 . in panel",
    "( b ) , three curves labeled by @xmath41 show the lorentz factor of the ejecta shell that passes through the rs when the rs is at @xmath34 .",
    "three curves labeled by @xmath42 show the lorentz factor of the blast wave as a function of the rs radius @xmath34 .",
    "the relative lorentz factor @xmath43 between @xmath42 and @xmath41 is shown in panel ( c ) .",
    "panel ( d ) shows the evolution of the rs pressure @xmath44 and fs pressure @xmath45 as a function of @xmath34 .",
    ", width=642 ]                              .",
    "panel ( a ) shows the @xmath42 curves , and the panel ( b ) shows the @xmath45 and @xmath44 curves .",
    "the @xmath44 curves are multiplied by a factor of 0.1 , in order to avoid an overlap with the @xmath45 curves .",
    ", width=377 ]"
  ],
  "abstract_text": [
    "<S> we investigate the dynamics and afterglow light curves of gamma - ray burst ( grb ) blast waves that encounter various density structures ( such as bumps , voids , or steps ) in the surrounding ambient medium . </S>",
    "<S> we present and explain the characteristic response features that each type of density structures in the medium leaves on the forward shock ( fs ) and reverse shock ( rs ) dynamics , for blast waves with either a long - lived or short - lived rs . </S>",
    "<S> we show that , when the ambient medium density drops , the blast waves exhibit in some cases a period of an actual acceleration ( even during their deceleration stage ) , due to adiabatic cooling of blast waves . comparing numerical examples that have different shapes of bumps or voids , </S>",
    "<S> we propose a number of consistency tests that correct modeling of blast waves needs to satisfy . </S>",
    "<S> our model results successfully pass these tests . employing a lagrangian description of blast waves </S>",
    "<S> , we perform a sophisticated calculation of afterglow emission . </S>",
    "<S> we show that , as a response to density structures in the ambient medium , the rs light curves produce more significant variations than the fs light curves . some observed features ( such as re - brightenings , dips , or slow wiggles ) </S>",
    "<S> can be more easily explained within the rs model . </S>",
    "<S> we also discuss on the origin of these different features imprinted on the fs and rs light curves . </S>"
  ]
}