{
  "article_text": [
    "at large scale facilities for neutron and x - ray scattering , large quantities of experimental data are produced . for complex , nanoscale systems , understanding this data",
    "requires computer models . in the case of inelastic scattering , molecular dynamics ( md ) simulations",
    "@xcite are widely used to equilibrate structures and explore dynamics as a function of temperature and other experimental parameters .",
    "however md only gives a partial description of vibrational modes through the partial density of states and when knowledge about specific vibrational modes is required , normal mode analysis ( nma ) @xcite has to be performed . for physics and materials science problems",
    ", nma gives a description of the lattice dynamics via the dispersion ( k - vector dependence ) of the mode frequencies @xcite .",
    "for small systems ( @xmath0 200 atoms in the simulation box ) very accurate results can be obtained using density functional theory ( dft ) methods to determine interatomic force constants @xcite . by combining dft and software that constructs and diagonalises the dynamical matrix and calculates the experimental observables",
    ", experimentalists now have sophisticated tools to analyse their data .",
    "the phonon @xcite package is one of the best examples .",
    "phonon codes are traditionally limited to small systems for a number of reasons .",
    "for example , for small unit cells , the reciprocal lattice is big and stronger effects of dispersion are expected .",
    "if dft methods are used to determine force constants then these methods are themselves restricted to a few hundred atoms",
    ". however the development of nanoscale structures of ( partially ) crystalline materials stimulates a need for phonon codes to be extended to much larger systems .",
    "parameterised force fields @xcite can be used to determine the inter - atomic force constants and , as will be seen in the example presented here , strong dispersion effects are observed inspite of the small reciprocal lattice .    in biomolecular systems ,",
    "the need for nma has long been recognised and codes like charmm @xcite allow the gamma point normal modes to be calculated for moderately big systems .",
    "in addition , the neutron scattering quantities can be directly calculated from the simulations using the time - correlation function formalism @xcite , as implemented in the nmoldyn program @xcite .",
    "a combination of neuton scattering experiments and atomic detail computer simulations has proven to be a powerful technique for studying internal molecular vibrations @xcite . in this approach",
    "one can validate the applied numerical models , i.e. force field parametrizations , depending on the agreement between the experimental and calculated spectra .",
    "in this paper we present a software package that extends the functionality of codes like phonon @xcite and climax @xcite to arbitrarily large systems and extends the gamma point only analysis already available for larger systems to include k - vector dependence .",
    "the software reads a hessian matrix of force constants , constructs and diagonalises the dynamical matrix for any k - vector and calculates neutron and x - ray scattering observables .",
    "the computational bottleneck remains the diagonalisation of correspondingly large dynamical matrices and we comment on approximations that have to be used when the brillouin zone can not be sampled at a large number of points . in large systems ,",
    "atomistic detail in the displacement vectors can be difficult to interpret due to the large number of degrees of freedom and we present two methods for simplifying this information .",
    "the first entails summing displacement vectors over atoms in user - defined beads , while the second involves a reduction of the degrees of freedom in the dynamical matrix by summing over force constants , which has the advantage of reducing the number of modes to be examined .",
    "the standard approach , also called a direct method @xcite , to the lattice vibration problem of crystals is based on the explicit knowledge of the interaction between all atom - pairs in the system . subsequently , one deduces the corresponding force constants , and constructs and diagonalizes the dynamical matrix for any k - vector in order to obtain the frequencies of the normal modes . a reasonable atomic detail description of interactions within large biomolecular systems",
    "are provided using empirical force fields .    in the following",
    "we will briefly summarize the aspects of the classical theory of lattice vibrations @xcite and proceed to the description of the explicit phonon calculations .",
    "the individual atomic positions in the crystal can be assigned as @xmath1 where @xmath2 is unit cell lattice vector and @xmath3 is displacement of atom @xmath4 from its equilibrium positions @xmath5 . within the harmonic approximation we concentrate on expansion of the small differences of potential energy @xmath6 due to the small changes in atom positions : @xmath7 where the second derivative defines the force constant between the atoms @xmath4 and @xmath8 : @xmath9 as each unit cell is identical to every other unit cell in the crystal , the displacement pattern of a normal mode has to be identical to that in any other cell to within a phase difference @xmath10 .",
    "the representation of the atom displacement is chosen to be a plain wave ansatz of the form : @xmath11 ) , \\label{le2}\\ ] ] where @xmath12 is the polarization vector and @xmath13 is the mass of the atom @xmath4 .",
    "we omit writing cartesian component subscripts .",
    "solving the equation of motion with ansatz ( [ le2 ] ) is equivalent to the eigen - value problem @xmath14 where @xmath15 \\label{le4}\\ ] ] is the so called dynamical matrix .",
    "the form of the dynamical matrix ( [ le4 ] ) requires the atom pairs for which one atom belongs to a different unit cell , _",
    "i.e. _ @xmath16 , to be identified .",
    "these terms contribute to the so called bloch - factor @xmath17 $ ] and make the dynamical matrix complex .",
    "but in case of applying periodic boundary conditions ( pbc ) as implemented in computer simulation programs , the potential energy of a crystal is given as an explicit function of only the atom positions in the primary unit cell .",
    "as a consequence , we obtain the second derivative matrix @xmath18 in which the contributions from the inter - cell atomic pairs are mapped and added to the corresponding image atom pairs in the primary unit cell : @xmath19\\to{\\bf h}_{\\mu,\\nu}= \\frac{\\partial^2 v^{pbc}}{\\partial    u_{\\mu}\\partial u_{\\nu } } \\label{le5}\\ ] ] one can directly obtain @xmath20 by increasing the size of the unit cell by one or more layers of periodically arranged image cells and calculate force constants in the extended supercell . however , this approach is unfavourable when dealing with very large systems .",
    "a similar approach is to decompose the potential energy @xmath21 in equation ( [ le5 ] ) into individual contributions from the image cells , @xmath22 and evaluate the second derivative matrix for each term upon the same minimized structure .",
    "the situation is simpler if the interaction is truncated at some cutoff distance @xmath23 so that the `` minimum image convention '' ( mic ) is obeyed .",
    "the mic states that each atom interacts at most with one image of every other atom in the system ( which is repeated to fully enclose the primary unit cell with the periodic boundary conditions ) .",
    "this has the effect of limiting the interaction cutoff , for example , to no more than half the length of the minimum side when simulating the orthorhombic cell , @xmath24 .",
    "it should be noted that the size of nanoscale crystals usually far exceeds the spatial range of forces between atoms ( @xmath25 @xmath012  ) allowing physically reasonable cutoff radii to be introduced .",
    "( hollow blue circle ) and @xmath4 ( full black circle ) is larger than the cut - off distance ( red circle around the atom @xmath4 ) , and if the force constant @xmath26 turns out to be nonzero , it means that the value of @xmath26 has to be related to the atom @xmath8 in the image cell @xmath27 ( full blue circle ) , with the position vector @xmath28 ( @xmath29 ) , instead of to the atom @xmath30 in the primary cell @xmath31 .",
    "the corresponding lattice translation vector @xmath32 is thus determined for the element @xmath33.,scaledwidth=50.0% ]    according to the mic we can conclude that there is always only one translation @xmath34 per atom pair @xmath35 giving rise to the minimum distance @xmath36 : @xmath37 where @xmath38 are lattice translation vectors , c.f .",
    "[ fg1 ] . in the case of a nonvanishing @xmath39",
    "we get the following expression for a dynamical matrix element    @xmath40    according to equation ( [ le3 ] ) the diagonalization of matrix @xmath41 yields the phonon frequencies @xmath42 and corresponding polarization vectors @xmath43 for a given phonon wave vector @xmath44 .",
    "a complete solution leads to the phonon dispersion relations .",
    "the subscript @xmath45 denotes a branch in the phonon dispersion . in a crystal of @xmath46 atoms , there are @xmath47 branches .",
    "0.2 cm * inelastic scattering * 0.2 cm    the dynamic structure factor @xmath48 contains information about the structure and dynamics of the sample .",
    "it can be split into a coherent part arising from the cross - correlations of atomic motions and an incoherent part describing self - correlations of single atom motions .",
    "according to the standard theory @xcite , which is based on the harmonic approximation , we obtain the following expressions for the coherent and incoherent dynamical structure factors : @xmath49 and @xmath50\\delta(\\omega-\\omega_{\\vec kj}),\\end{aligned}\\ ] ] where @xmath51 is the scattering vector , @xmath52 is the corresponding atomic scattering length , @xmath53 refers to the phonon creation process ( absorption spectrum ) and @xmath54 is the mean number of phonons of frequency @xmath55 at temperature @xmath56 according to the bose - einstein statistics @xmath57 the factor @xmath58 $ ] is called the debye - waller factor : @xmath59 where @xmath60 is a @xmath61 symmetric tensor representing the thermodynamic mean square displacement of an atom @xmath4 , which can be expressed by the partial atomic phonon density of states @xmath62 : @xmath63 the partial atomic density of states is a weighted distribution of normal modes @xmath64 where @xmath31 is the number of sampling @xmath44-points in the first brillouin zone .    the evaluation of the debye - waller @xmath65 factors using equation ( [ le6 ] ) requires extra attention due to the `` zero - phonon '' term resulting from the singularity caused by phonon ( acoustic ) branches where @xmath66 .",
    "the contributions of the 3 acoustic modes is treated separately by using the debye approximation for the density of states , _",
    "i.e. _ @xmath67 , and normalization @xmath68 , where @xmath69 is the maximum frequency up to which the acoustic dispersion curve is linear @xmath70.\\end{aligned}\\ ] ] a new variable @xmath71 was introduced in the last equation .",
    "for systems containing thousands of atoms ( n ) the displacement vectors obtained by diagonalising the dynamical matrix can be difficult to understand , especially for low frequency modes which involve the displacement of many ( or all ) atoms .",
    "one simple solution to this problem is to sum over the displacements of atoms within beads , which represent logical coarse grains of the system , for example base molecules in the dna example below .",
    "this treatment allows different bead definitions to be applied to the calculated displacement vectors but has the disadvantage of not reducing the number of displacement vectors from 3n .",
    "a related approach is to reduce the atomic level hessian matrix to lower dimension by mapping the inter - atomic force constants on to inter - bead force constants @xcite . for n beads ,",
    "the resulting dynamical matrices have dimension 3n and therefore result in 3n displacement vectors for any k - vector .",
    "we note that any reduction in the dimensionality of the system causes a loss in information , which is the rotational degrees of freedom of the beads ( rigid bodies ) .",
    "to verify the implemented formalism we have simulated a b - form dna molecule ( right - handed , 10 base - pairs per turn , pitch 33.6 ) using charmm @xcite .",
    "the full crystal environment was generated using periodic boundary conditions for an orthorhombic unit cell containing one helix of dna .",
    "the dimension of the unit cell is @xmath72 , @xmath73   and @xmath74 , with @xmath75 parallel to the helical axis .",
    "the starting configuration was obtained by minimization of the potential energy of the crystal structure obtained as the time average over a 1ns md simulation at 100k .",
    "the hessian matrix of force constants was generated by displacing each atom in turn from equilibrium and calculating the forces induced on all other atoms .",
    "diagonalisation of the resulting dynamical matrices was performed using the the routine ` zcheev ` from the lapack library @xcite .",
    "is varied along the helical axis ( 0,0,1 ) . shown",
    "are @xmath76@xmath77.,scaledwidth=80.0% ]    the typical coherent spectrum of dna , figure [ fg2 ] , obtained from equation [ eqn_coh ] , shows a well - defined brillouin peak at small @xmath55 which moves along the frequency dimension upon varying momentum transfer @xmath51 .",
    "fitting the spectral profile with a gaussian as a function of wave - vector gives the dispersion curve shown in figure [ fg3 ] , which compares well with the recent experimental results @xcite .",
    "figure [ fg3 ] also shows the result of the equivalent analysis of a 300k md simulation on the same model of b - dna using nmoldyn .    in order to gain insight into the nature of low frequency dynamics we can analyse the displacement vectors at an atomic level ( see figure [ fg5](a ) for an acoustic mode ) . by summing over the displacement vectors in terms of beads , where base molecules , sugar molecules and phosphate groups are treated as single units , a simplified picture of the normal modes is obtained .",
    "figure [ fg5](b ) shows a high frequency mode which has a pronounced contribution from the phosphate groups .",
    "the new , user - friendly computational package ` nmscatt ` presented here enable an efficient atomic detail analysis of different types of inelastic scattering applied to arbitrarily large nanoscale systems . the ability to perform molecular dynamics and phonon calculations on large nano and bio - molecular materials means that one can efficiently pursue the investigation of some poorly understood structural and dynamical features of these systems .",
    "the authors are grateful to dr .",
    "stephane rols for helpful discussions at the start of this project .",
    "mj acknowledges a long - standing collaboration with prof .",
    "krzysztof parlinski .",
    "fm acknowledges a financial support from ill during his stay in grenoble and support from the ministry of higher education , science and technology of republic of slovenia under grant nos .",
    "p1 - 0002 , j1 - 6331 and j1 - 5115 .",
    "there are four main modules in the ` nmscatt ` program package _ phonon , coh , incoh _ and _ bead _ , and the overall ` nmscatt ` structure is given in figure [ fg6 ] .",
    "below are described the corresponding modules .    *",
    "_ phonon _ : providing the full hessian matrix for a given energy - minimized atomic structure within the specified crystallographic unit cell this module constructs dynamical matrix and calculates its eigenvalues and eigenvectors at given wave vector @xmath44 . at input",
    "this module requires to specify the bravais lattice vectors that were previously used in the molecular mechanics / dynamics simulation package to satisfy the periodic boundary conditions while generating the minimized structure",
    ". the cut - off radius must be given at which the long range interactions are truncated while calculating the hessian matrix in the simulation .",
    "at output two separate files ` eig_val_`@xmath31 and ` eig_vec_`@xmath31 are written containing eigenvalues and eigenvectors , respectively , where @xmath31 assigns a consecutive number of the sampling @xmath78-point in the first brillouin zone .",
    "these files serve as an imput for other modules of ` nmscatt ` .",
    "the choice @xmath79 is assumed to be reserved for the @xmath80-point , @xmath81 .",
    "the lowest @xmath31 should sample the vicinity of the @xmath80-point .",
    "the @xmath78-points are to be specified in the fractional coordinates with respect to the reciprocal lattice vectors .",
    "the elements of the upper triangle of the hessian matrix should be provided in the binary ( default ) ` hessian_uf ` or alternatively in the ascii file ` hessian_f ` and the atomic coordinates in the file ` coord ` writen in the charmm coordinate format . * _ incoh _ : this module allows to calculate atomic debye - waller factors representing the mean square displacements and dynamical structure factor of incoherent one - phonon neutron scattering on monocrystals and from orientationally averaged powder . in the latter case we need to specify an absolute value of momentum transfer @xmath82 , range of the @xmath78-point index @xmath31 : @xmath83 for picking up the corresponding @xmath78-point eigenvalues- and eigenvectors - files generated by _ phonon _",
    ", number of random orientations of @xmath82 vector to provide spherical averaging and absolute temperature . also , one has to define the @xmath78-point index @xmath84 , for which the @xmath78-point range @xmath85 corresponds to the linear regime of the acoustic - mode - dispersion curves .",
    "this is needed for the proper derivation of debye - waller factors using debye approximation . as a result ,",
    "the function @xmath86 is given in the file ` s_q_w ` .",
    "optionally , one can also obtain density of states ( dos ) in this module . * _ coh _ : this module calculates dynamical structure factor of coherent one - phonon neutron or x - ray scattering on monocrystals .",
    "in addition to the input data required by _ incoh _ ( except for the spherical averaging ) , we need to define for module _ coh _ also the type of scattering neutron / x - ray , the number of higher brillouin zones included for sampling momentum transfer vector , and the range of the @xmath78-point index @xmath87 evaluated by module _ phonon _ and assigning the @xmath78-points in the first brillouin zone , which lie along the selected direction of the momentum transfer vector @xmath51 . as a result , the function @xmath86 is given in the file ` s_qw_coh ` . * _ bead _ : this module is used to enable visualization of selected vibrational modes obtained by running _",
    "phonon _ for the @xmath80-point , such that atomic displacement vectors are projected on to the beads , which are defined as the center of mass of larger atomic groups of the system , for example residues .",
    "the output files are readable by the program ` xmakemol`@xcite which enables direct visualisation of the mode .          to compile the program package makefile is provided .",
    "it is important to note that 64-bits processors are prerequisite for applying the ` nmscatt ` to analysis of the large systems ( containing more than 2000 atoms ) .",
    "one needs to install the lapack library on the computer beforehand , prior to ` nmscatt ` .",
    "the fortran compiling switches ` g77 -mcmodel = medium -funroll - all - loops -fno - f2c -o3 ` are recomended when installed on 64-bits processors running linux ."
  ],
  "abstract_text": [
    "<S> computational tools for normal mode analysis , which are widely used in physics and materials science problems , are designed here in a single package called ` nmscatt ` ( normal modes & scattering ) that allows arbitrarily large systems to be handled . </S>",
    "<S> the package allows inelastic neutron and x - ray scattering observables to be calculated , allowing comparison with experimental data produced at large scale facilities . </S>",
    "<S> various simplification schemes are presented for analysing displacement vectors , which are otherwise too complicated to understand in very large systems .    ,    and    vibrational analysis , phonons , atomic force - field simulations , inelastic neutron / x - ray scattering , dynamical structure factor    87.15.-v,87.15.aa,63.20.dj,61.10.dp </S>"
  ]
}