{
  "article_text": [
    "it is now widely believed that solar flares are powered by magnetic energy which had been stored in the corona through slow stressing applied from the photospheric boundary . in an idealized model the energy builds up as the coronal magnetic field responds without resistance ( every field line line  tied and unbroken ) .",
    "the flare then occurs as coronal reconnection exchanges those field line footpoints to achieve a lower energy state . in this process",
    ", the footpoints are changed by the reconnection , but the vertical photospheric field in which the field lines are anchored is not .",
    "the potential field from this fixed photospheric field has the minimum magnetic energy possible .",
    "the maximum energy available for release is the amount by which the initial field exceeds this potential field energy , called the _",
    "free energy_.    quantitative simulation of the above scenario has proven to be extremely challenging owing to the vast range of scales involved .",
    "magnetic fields of even modest complexity develop , when stressed , current structures many orders of magnitude thinner than the global length scale @xcite .",
    "a numerical solution therefore requires additional magnetic diffusion to prevent the development of unresolvable current structures .",
    "the corresponding diffusive time is necessarily much shorter than actual diffusive times and generally shorter than the multi - day times governing the stressing phase . as a consequence , direct simulation , for example by time ",
    "dependent mhd solution , includes artificial ( diffusive ) energy losses competing with the energy build - up .",
    "few such computations have been capable of demonstrating pre  flare energies comparble to those released by the ensuing flare@xcite .",
    "an alternative means of estimating pre  flare energy storage is offered by the minimum current corona model ( mcc : * ? ? ?",
    "* ; * ? ? ?",
    "this is a quasi - static technique using equilibira , called flux constrained equilibria ( fce ) , minimizing magnetic energy subject to a set topological constraints composing a subset of all line - tying constraints . rather than constraining every pair of footpoints , the mcc groups footpoints into unipolar photopsheric regions and constrains the net coronal flux connecting each pair of regions , called _",
    "domain fluxes_. since it uses only a subset of the actual constraints , its fields provide a lower bound on the actual free energy .",
    "as the photospheric regions move relative to one another the potential field above changes as do the fluxes by which it would link region pairs ( potential domain fluxes ) . since the actual field is constrained from changing these fluxes , it becomes increasingly different from the potential field and thus gains free energy .",
    "significantly , this energy is available for release by the violation of topological constraints , a process which can occur on very small spatial scales .",
    "the mcc has been used to estimate pre  flare energy storage in a number of flares @xcite .",
    "a partitioning algorithm was developed to automatically group photospheric flux into distinct regions @xcite .",
    "provided it is permissible to neglect submergence or emergence of flux , the regions can be taken to move relative to one another but with constant flux .",
    "this simplified scenario was deemed adequate to model pre ",
    "flare evolution in several cases @xcite , including the landmark halloween event @xcite .",
    "when footpoints within a given region move internally , such as during sunspot rotation , additional constraints must be introduced involving the arrangement of footpoints within regions @xcite .",
    "flux emergence is a well  known precursor for flares and cmes @xcite and is thus likely to play a role in energy storage for many flares .",
    "it has not yet been accounted for in a complete mcc energy estimate owing cheifly to technical hurdles .",
    "doing so would require the constraints to be somehow modified to account for flux emergence .",
    "two prototypical cases were treated by ignoring all but one constraint to which emergence makes an obvious modification @xcite .",
    "a step toward a more general application was made by @xcite , who accounted for emergence and submergence in a computation of coronal reconnection times in the quiet sun .",
    "changes in the fluxes of photopsheric regions were used to generate a list of flux changes due to emerging and submerging domains . the algorithm used had several drawbacks , including a tendancy to assign both emerging and submerging domains to the same photopsheric region .",
    "the present work introduces a new algorithm by which emerging flux regions may be automatically accommodated in the mcc constraints leading to a pre  flare energy estimate .",
    "flux changes in photospheric regions are used to generate a list of domain flux changes due to emergence and submergence , as in @xcite . in this case , however , a single region is linked to only emerging or submerging domains according to the sense of its own change",
    ". the possibility of artificial photospheric flux changes due to variations in sequential partitioning can be accomodated at the same time using a closely related algorithm .",
    "( this step is independent of the partitioning algorithm . )",
    "we also present a new algorithm for automatically associating domains with separators , a crucial step in the generation of an energy estimate .",
    "the new methodology is illustrated by applying it to a flare which occured on 16 oct .",
    "2010 and was observed by instruments on the solar dynamics observatory ( sdo ) spacecraft .",
    "new flux emerges into an existing active ( noaa ar 11112 ) for two days prior to the flare ( goes class m3 ) .",
    "we derive photopsheric magnetic fluxes from a series of 123 line  of  sight magnetograms from the hmi instrument @xcite at cadences of @xmath2 minutes , as discussed in the next section . in section [ sec :",
    "photosphere ] , we detail our algorithms for partitioning the set of magnetograms into unipolar regions . the flux variations in these regions are used to define a set of emerging and submerging domains which are automatically generated by an algorithm explained in section [ sec : change ] .",
    "the emerging domains largely resemble those we would have expected based on inspection of the time series , but still contain some physically dubious assignments that must be fixed by hand . in the future , we would like to completely automate each of these algorithms .",
    "in section [ sec : erg ] , we use the magnetograms to derive a coronal topology for the post  flare potential magnetic field and use this to place a bound on the free energy of the pre  flare field .",
    "the post  flare potential field includes a coronal null point whose fan surface encloses one of the newly emerged polarities .",
    "this is a novel feature in the mcc and requires the development of one additional method .",
    "we apply our energy estimate to noaa ar 11112 in section [ sec : ergapp ] , which reveals that most of the pre ",
    "flare energy is due to currents passing through the coronal null point .",
    "though the methods presented here are of general utility , we apply them , for concreteness , to noaa active region 11112 .",
    "we base our calculations on magnetograms taken by the helioseismic and magnetic imager ( hmi ) on board the sdo spacecraft .",
    "figure [ fig : oldflux ] shows an example line  of  sight ( los ) magnetogram from oct .",
    "13th , prior to flux emergence .",
    "lighter pixels show positive flux , dark pixels negative flux , and gray pixels zero flux ; the grayscale saturates at @xmath3 g .",
    "the active region originally contains only previously emerged flux as it crosses the eastern limb in the southern hemisphere on october 9th , 2010 .",
    "new flux begins emerging around 08:00 ut on the 14th , and is associated with a goes m2.9 flare several days later , at 19:07 ut on the oct .  16 .",
    "the region shows little activity in the 6 days before the flare .",
    "our dataset consists of 123 line  of  sight magnetograms , each consisting of @xmath4 pixels with 1.0 arcsecond resolution and approximately 0.5 arcsecond / pixel@xcite .",
    "they have a cadence of @xmath5 2 hours for the first 21 timesteps , from 2010 - 10 - 13 00:04 ut to 2010 - 10 - 14 18:20 ut , and @xmath5 half hour timesteps thereafter , from 2010 - 10 - 14 18:20 ut to 2010 - 10 - 16 23:37 ut . flux emergence begins around timestep 21 .",
    "as shown by the supplementary media , a movie of the los magnetograms , the photospheric changes are well characterized by these two cadences .",
    "our data window has flux imbalance @xmath6 over the three days leading up to the october @xmath7 flare .",
    "hmi los magnetogram of noaa ar 11112 prior to new flux emergence .",
    "the grayscale saturates at @xmath8 g , and the axes are in arcseconds from disk center .",
    "the boxed area encloses the region of flux emergence , which begins @xmath9 hours after this magnetogram .",
    "]    the old flux region has a polarity inversion line , running from southeast to northwest , which coincides with a filament as seen in data from the global high  resolution h@xmath10 network , as well as sdo euv images at 94 , 131 , 171 , 193 , 211 , 304 , and 335  .",
    "this filament appears unaffected by the 19:07 ut flare . to the north of the filament ,",
    "the diffuse , old  flux , negative polarity field includes a curious ring of flux surrounding a strong core , boxed in figure [ fig : oldflux ] .",
    "the new flux of both polarities emerges completely within this ring , sweeping the old negative flux out of its way as it carves out a space for itself .",
    "this results in the ( zoomed in ) field shown in figure [ fig : newflux ] , roughly 10 minutes before the flare .     a zoomed view of los magnetogram of the emerging flux region , boxed in figure [ fig : oldflux ] , on oct 16th , 2010 , 18:53ut , @xmath11 10 minutes prior to the m2.9 flare .",
    "the grayscale saturates at @xmath12 g , and axes are in arcseconds from disk center.,scaledwidth=70.0% ]    as the new flux emerges it snow  plows the old flux in front of it , the old flux concentrates and a strong horizontal gradient in the los field develops between old and new flux , as seen near s 400  ,",
    "w 410  in figure [ fig : newflux ] .",
    "the flare is centered on this strong polarity inversion line .",
    "flare loops connect the newly emerged negative flux ( n55 , n58 , n87 ) within the ring to the diffuse , positive flux to the west ( p4 , p15 , p19 ) .",
    "we therefore believe that any analysis of this flare s energetics must explicitly account for flux emergence .",
    "our analysis naturally splits into two parts .",
    "the first parts works directly with the photospheric magnetic field measurements .",
    "we first partition the magnetic field at all times into unique , unipolar regions .",
    "second , we track these regions and enforce a consistent labeling scheme as they change geometry over time .",
    "geometric changes include changes in size , shape , orientation , and total flux ; merging and splitting of regions ; and the complete emergence or submergence of regions .",
    "the final step quantifies flux emergence and submergence between pairs of photospheric sources using a novel algorithm .    in the second part of our analysis",
    ", we use our characterization of the photospheric field as a set of unique unipolar sources to describe the topology of the coronal field .",
    "each distinct photospheric region is replaced by a point source of the same flux located at the region s flux  weighted centroid .",
    "we then find the flux within each potential field domain , and the null points and separators of the potential field .",
    "changes in the potential field s domain flux relative to the actual domain fluxes , assumed fixed , indicates the storage of magnetic energy in excess of the potential field . in an energy  minimized field , the free energy stored by the field is manifest by current ribbons that develop along separator field lines . for brevity , we will use the phrase `` energy stored in the separator '' as a shorthand for `` free energy stored in the magnetic field which manifests itself as a a current ribbon at the location of a separator . ''",
    "the amount of current flowing along these ribbons places a bound on the free magnetic energy of the system .",
    "we begin work on the photospheric data by partitioning the magnetogram using the gradient  based tessellation algorithm described by @xcite .",
    "the initial los magnetograms are converted to a vertical field by assuming a radial field at each pixel , which amounts to dividing by @xmath13 , where @xmath14 is the polar angle from disc center . when determining the flux in each region , we must also account for foreshortening within each pixel , dividing by a second factor of @xmath13 .",
    "we then convolve all vertical field , @xmath15 , with the green s function for a potential extrapolation up to a height @xmath16 from an unbounded plane : @xmath17 to reduce the effects of noise , we neglect all the convolved field below a threshold of @xmath18 g . using the smoothed field ,",
    "we assign a unique label to all local maxima and every pixel strictly downhill with respect to @xmath19 from each maxima .",
    "internal boundaries in unipolar regions are eliminated  multiple regions are merged into a single region  when the saddle point @xmath20 .",
    "@xmath21 is the greatest vertical field strength of the saddle s surrounding peaks , and @xmath22 is a threshold value . at the end of this process",
    ", each data pixel has an associated label .",
    "we call the set of all labels at a given time a mask , and the set of masks at all times a mask array .",
    "our goal in this section is to make the mask array consistent from timestep to timestep . in particular",
    ", we wish to determine how the newly emerged flux interacts with the old flux , and how that process affects the energetics of the active region .",
    "our primary concern is therefore to distinguish between new and old flux , which is a marked departure from previous , similar investigations@xcite .",
    "figure [ fig : newflux ] shows an example where the boundary of each unique mask region and its label ( p1 , n1 , p2 ,  ) have been plotted over the line of sight magnetogram data .",
    "all pixels and regions containing flux below our thresholds are given a label of 0 .",
    "this figure covers the ring feature of old flux  concentrated in regions n1 , n6 , n38 , n49 , n55 , and n67and the newly emerged flux in regions p22 , p29 , p48 , n58 and n87 .",
    "the supplimentary material shows that these definitions are not necessarily strict .",
    "for instance , n58 , n67 , and n87 initially all break off of n49 .",
    "both n58 and n87 are quickly dominated by newly emerged flux , while n67 remains primarily distinct .",
    "we refer to `` new flux '' or `` old flux '' regions based on the dominant type of flux determined by inspection of the timeseries ( see supporting media ) .    for the present analysis ,",
    "we have set @xmath23 mm , @xmath24 , and @xmath25 .",
    "we also established a minimum flux of @xmath26mx @xmath27 gauss px@xmath28 , after accounting for pixel foreshortening ) for a solitary region .",
    "our field of view contains unsigned flux of order @xmath29mx above the 50 gauss threshold , so , a region must contain at least 0.2% of the total unsigned flux before inclusion in our algorithms . for a discussion of how the parameters @xmath16 , @xmath30 , and @xmath22 effect the final partitioning , see @xcite .    after partitioning each magnetogram , we attempt to associate the partitions at one timestep to those in the next . to begin with , each region is characterized by its net signed flux and centroid location : @xmath31 for short , we call a region s total flux at the flux  weighted centroid the region s associated _",
    "pole_.    as a first pass at creating consistently identified regions , we calculate the distance between each pair of centroids at two consecutive timesteps .",
    "if centroid a at time @xmath32 , @xmath33 , is closest to centroid b at time @xmath34 , @xmath35 , and b has a as its closest neighbor , and that distance is less than a threshold ( 10 mm ) , then we conclude that region b is region a.    both this simple method of association , and exploration of the partitioning parameter space , result in mask arrays that are not to the quality required for mct analysis of an emerging flux region .",
    "we therefore developed two more sophisticated automatic procedures .",
    "and , described below , provide refinements to the minimum  distance identifications .",
    "both were heuristically developed to address a prevalent type of inconsistent region labeling .",
    "the first algorithm deals with a region that exists for just a single timestep , but is clearly part of another region .",
    "the second deals with regions that change labels from one timestep to the next .",
    "these problems arise , for instance , when the choice of parameters poorly represents a subset of the timeseries , or when two regions merge or split , and their centroid locations between two timesteps are very different .    for clarity , our examples in the following subsections do not directly use masks from our time series , and are only meant to illustrate the action of each algorithm .",
    "both algorithms operate directly on pixels in the mask structure , so that there are no physical scales involved .",
    "the algorithms only relabel nonzero elements of the mask , so that no external mask boundaries are modified .",
    "the first column demonstrates the problem of `` flickering . ''",
    "the middle timestep contains a new created region , @xmath36 , inside of the area controlled by region @xmath37 in the surrounding timesteps .",
    "@xmath36 only exists for that single timestep , its area reverting back to @xmath37 in the third timestep .",
    "the right column shows the effect of running on this region : in the middle timestep , @xmath37 has been completely restored in place of @xmath36.,scaledwidth=50.0% ]    attempts to smooth the temporal structure of our mask arrays by better associating regions that last for just a single timestep .",
    "this happens when the saddle points in the tessellation algorithm slosh back and forth over the threshold value .",
    "figure [ fig : rmvf ] shows an example of this problem .",
    "region n2 pops into existence in the middle timestep , occupying some of the territory ascribed to region n1 in the first and third timestep .",
    "we see that this is not a `` real '' new region , but should instead be considered part of n1 for the entire time .",
    "figure [ fig : rmvf ] column two shows the result of running on this data .",
    "the algorithm works on a sliding , three timestep window ( initial , middle , and final timestep ) , and in two steps . in the first step",
    ", we find all regions @xmath38 that have nonzero flux only in the middle timestep , and find all mask pixels in the initial and final timestep which overlap @xmath38 . we take each overlapping region @xmath39 and relabel those pixels of @xmath38 which are overlapped by @xmath39 in the initial and final timesteps as @xmath39 .",
    "because our source regions change shape and size ( pixel count ) over time , we will usually have leftover pixels after performing the above bulk relabeling . while leftover pixels remain",
    ", we relabel the pixel of @xmath38 that currently borders the greatest number of pixels of a single neighbor to that neighbor s label .",
    "we have found that , when multiple regions overlap a flickering region , this method divides those pixels between the overlapping regions in decent proportion to their past and future `` control '' of flickering territory .",
    "the left column demonstrates the problem of `` vanishing , '' in which a single region ",
    "n5 in the top left panel ",
    "cycles through series of different labels .",
    "the right column shows the effect of running on this data .",
    "the @xmath40 and @xmath41 axes are in arcseconds from disk center , though the physical scale is irrelevant to the algorithm s operation.,scaledwidth=50.0% ]    with we dealt with regions that existed for just a single timestep .",
    "we now deal with the conceptual inverse problem , where a region exists for some time and then suddenly changes names in the next timestep .",
    "figure [ fig : rmvv ] demonstrates the problem , as the region labeled n5 in the top left panel ( and previous , undepicted times ) cycles through a series of names and partitions within a few timesteps .",
    "we again begin by considering the mask array in a sliding , three timestep window .",
    "we find all non  zero flux regions within the window and determine which regions exist in which timesteps . for every region that disappears in the middle timestep , we project its area from the first timestep into the middle and last timesteps .",
    "we then find all new regions , in both the middle and final times , that overlap with that projected area . finally , we relabel any new region whose centroid lays within this projected area .",
    "figure [ fig : rmvv ] , right column shows the effect of running on data .      and each use a sliding , three timestep window , so that it takes many repetitions of each for updated information propagate from the beginning to the end of the mask array .",
    "we must therefore repeat each of the algorithms many times . at the same time , acts upon labels that last for just a single timestep ; eventually , all such problems will be fixed .",
    "taking these processes into account , we find that the mask arrays best approximate the photospheric field evolution when we switch back and forth between the two algorithms at the beginning of the process , and run just many times at the end of the process . for our noaa ar 11112 data , we ran a total of 35 repetitions , and a total of 1058 repetitions .    together , these two algorithms accomplish about nine  tenths of the work in creating a consistent set of tessellated masks .",
    "part of the remaining tenth may be accounted for by a boundary  shift algorithm , described below , between abutting regions of the same polarity .",
    "even this does not accurately represent to data , and the final changes to the mask array required for a consistent time series must be done by hand .",
    "these changes again mostly involve the placement of the boundary between abutting regions of the same polarity , caused by a failure to distinguish between old flux and actively emerging flux .",
    "these boundaries are adjusted manually until each region s flux evolves smoothly .",
    "figure [ fig : fluxplot ] top shows the vertical flux in each ( high  flux ) region .",
    "this includes editing of the masks by both the automatic algorithms and by hand .",
    "note that , even after a set of consistent masks have been created , the flux within each region is still rather noisy . to counteract this , we smooth our data with a 7 hour ( 13 timestep ) boxcar function .",
    "the result is shown in figure [ fig : fluxplot ] bottom .",
    "( a ) flux in regions with more than @xmath42mx .",
    "large , opposing spikes between pairs of curves , for instance between p15 and p19 , show boundary shifts between adjacent regions .",
    "( b ) result of smoothing the data by convolution with a 7 hour boxcar function.,scaledwidth=80.0% ]",
    "at this point , we transition from a mostly qualitative treatment of the photospheric field s geometry to a quantitative , topological analysis of a model coronal field : the minimum current corona ( mcc ) model developed in @xcite .",
    "we begin by replacing every region in the photospheric field with a magnetic pole defined by the region s total flux and centroid location , as in . with one exception ,",
    "the rest of this work deals only with the poles and connections between them .",
    "the total flux in each pole must be connected to some number of other poles of opposite polarity .",
    "this defines the system s connectivity : the undirected , weighted graph , where each vertex of the graph is a pole , and the weight of each edge defines the connectivity between the two vertices .",
    "it happens that the graph of noaa ar 11112 is _ simple _ on the eve of the m3 flare , so that each pair of vertices has no more than one associated edge .",
    "we refer to edges of the graph as domains .",
    "we may additionally define a connectivity graph for the flux _",
    "change _ between two timesteps : if a pole s flux increases , that increase must be distributed among its domains with opposite polarity poles .",
    "this is the topological entity we now quantify .",
    "the flux in a single photospheric region , and hence that region s associated pole , may vary in two ways .",
    "the change is either a true evolution of the field by submergence or emergence through the photosphere , or it is a transfer of flux to / from another like  signed region via a shift in the boundary between the regions .",
    "that this latter type still exists in our `` consistent '' data can be seen in regions p4 , p15 , and p19 in the smoothed data of figure [ fig : fluxplot ] .",
    "these three regions compose the large , diffuse positive region to solar west , as seen in figure [ fig : oldflux ] .",
    "if we focus on each of these regions individually , the red , green , and purple lines in figure [ fig : bndry ] , we see several rapid changes in the flux of each . however , if we look at the total flux in these three regions  the black line in figure [ fig : bndry]it steadily decreases : the rapid increases and decreases in figure [ fig : fluxplot]b are almost solely due to shifting boundaries between the three .",
    "further , the steady decrease shown in the black line is matched by decreases in the old  flux part of the flux ring , regions n1 , n6 , n38 , n49 , n55 , and n67 in figure [ fig : newflux ] : the old positive flux is `` submerging '' with the old negative flux .",
    "the blue line is a demonstration of the effectiveness of the forthcoming algorithms , and we will revisit it shortly .",
    "the submergence of regions p4 , p15 , and p19 ( red , green , purple ) , shown in the total flux of the regions ( black ) .",
    "blue shows the calculated submergence by removing flux change due to boundary shifts from the total flux change . ]      in order to isolate the different varieties of flux change , we have developed an algorithm which estimates the change in each region s flux due only to boundary displacements between adjacent , like ",
    "signed regions .",
    "these changes necessarily come in pairs : what one region loses in a boundary shift , another gains .",
    "our algorithm works as follows .",
    "consider a set of like  signed poles @xmath43 , and split @xmath43 into submerging and emerging sets , @xmath44 and @xmath45 respectively .",
    "each pole has an associated flux change , @xmath46 , with @xmath47 the flux at time @xmath32 given by .",
    "we iteratively find the pole with smallest unsigned flux change , @xmath48 , and the pole with closest centroid @xmath49 and opposite sense flux change , @xmath50 .",
    "the flux change between these two poles is canceled , @xmath51 and @xmath52 , and the cancellation is recorded in a change  in  connectivity matrix : @xmath53 .",
    "this process is repeated until no more connections can be made .",
    "@xmath54 is antisymmetric , and the @xmath55@xmath56 element is the flux ",
    "change of the edge joining @xmath57 and @xmath58 .",
    "each row @xmath57 describes the flux change for a given pole , and each column @xmath58 in a row records how much of pole @xmath57 s total flux change is in partnership with @xmath58 . if all of pole @xmath57 s flux change is due to boundary shifts , then @xmath57 s total flux change is given by summation along the @xmath57@xmath56 row of @xmath54 : @xmath59 in this way , we have paired as much shrinking flux with like  signed increasing flux as possible , but have only used the total flux and centroid location of each region .",
    "we now refer back to the photospheric mask for the last time . for each region in the mask array we find every like  signed region with which it shares a border : call this subset of poles @xmath60 .",
    "to allow for regions separated by a few pixels to share a boundary and supporting media : at various timesteps , n38 and n49 are separated by several pixels of low field , yet there is a clear transfer of flux across their shared boundary . ]",
    ", we pad each region by 5 pixels and look for overlap with other regions .",
    "the value of @xmath54 for each pair of such regions is then the amount of flux they exchanged through a shift in the mask boundary .",
    "we have chosen to distribute the flux  change and then restict to the subset @xmath60 , rather than the reverse , in order to avoid the ill  defined problem of assigning shifts when one region shares boundaries with multiple other regions , which in turn share boundaries with multiple other regions , and so on .",
    "we see this , for instance , in the triple boundary between regions p4 , p15 , and p19 .",
    "qualitatively , any discrepancy is small given that we connect regions in a nearest  to  farthest order , and nearby regions tend to share boundaries .",
    "the sum of all such changes for a given pole gives that pole s total flux change due to boundary shifts .",
    "all other change must be ascribed to submergence or emergence through the photosphere .",
    "we may describe this mathematically as @xmath61 the middle term on the rhs is the pole s boundary change , determined in this section ; the final term quantifies the pole s flux change due to submergence and emergence through the photosphere , which we now quantify .      our algorithm for determining the flux change due to submergence and emergence rests on two assumptions .",
    "first , pairs of poles submerge and emerge together , and second , a single region can either consist of submerging or emerging flux , but not both .",
    "these assumptions naturally break our connectivity  change graph into two disconnected subgraphs : one consisting of submerging vertices , the other emerging .",
    "each subgraph is composed of both positive and negative polarity poles , as flux connects only regions of opposite polarity .",
    "in determining the flux change in each domain , we use the same algorithm as for boundary shifts , only with the roles of polarity and sense of change reversed : these domains connect opposite polarity poles with same sense flux change , and represent pairs of poles submerging or emerging together .",
    "the graph generated in this manner reflects our physical intuition about how these systems should interact .",
    "namely , we expect poles to be more connected to those poles closest to them , rather than those further away .",
    "we also expect that poles with little flux change should not have that small change spread between a large number of partners .",
    "example map of sub / emerging flux , as generated by the algorithm of  [ sec : qsef ] .",
    "black lines show submerging regions , white lines emerging .",
    "labels mark the centroid locations of the high  flux regions of figure [ fig : fluxplot ] , which also contribute to the topological analysis of  [ sec : ergapp ] . ]",
    "we begin by finding the flux difference for each pole between times @xmath32 and @xmath34 , from which we subtract the change due to boundary shifts , found previously .",
    "the remainder is each pole s flux change budget , which must be paired with other poles . to accomplish this , we again iteratively find the least changing pole and cancel its flux change with its closest appropriately signed and sensed neighbor .",
    "this cancellation is the weight of each edge and is recorded in the source  change matrix , @xmath62 . just like the boundary shift matrix",
    ", @xmath62 is defined such that , if all of a pole @xmath63 s flux  change between times @xmath32 and @xmath34 is due to real photospheric changes , then @xmath64 ; that is , summation over all columns of a given row returns the total flux  change for that row s pole .",
    "while the combination of our algorithms dealing with boundary shifts and emergence do quite well in most circumstances , occasionally they produce unphysical connections .",
    "consider the timestep shown in figure [ fig : smat ] . here",
    ", the emerging positive regions ( p22 , p29 , p48 ) each have some flux change , and our knowledge of the location of emergence says that this change is most likely a combination of boundary shifts and emergence for p48 and p29 , as both n87 and n58 are also actively emerging , and primarily boundary shifts for p22 . however , if the boundary shift between p22 and p29 is larger than the emergence of p48 , then our boundary algorithm ascribes the boundary shift to p29p48 , leaving the emergence mostly between p22 and n87 , which is clearly unphysical .",
    "for this reason , we allow for `` preferred connections '' , which accounts for emergence between a subset of poles first , and then proceeds to calculate boundary shifts and submergence and emergence for all poles . for this region , we first pair emergence between regions p22 ,",
    "n55 , n58 , and n87 for the first 3 days ( 77 timesteps ) , and then between regions p48 , n55 , n58 , and n87 during the remaining time . as with the generation of consistent mask structures in the previous section , we ultimately wish to automate this entire process .",
    "however , until we develop algorithms that accurately capture the physical evolution of emerging regions , we will rely on a combination of automatic proceedures and ad hoc prescriptions to most accurately model these systems .",
    "figure [ fig : smat ] shows a graphical representation of the changing domain fluxes due to submergence and emergence between 12:04 and 12:35 ut on oct 16th , 7 hours before the flare .",
    "black lines show submerging domains , white lines emerging .",
    "table [ tab : smat ] shows the flux change in each domain .",
    "regions p4 , p15 , p22 , p29 , and n55 have flux change ( for these timesteps ) due solely to boundary displacements with neighboring regions .",
    "as discussed above , we begin pairing p48 , which increased by @xmath65mx .",
    "the closest ( and only ) negative pole with the correct sense of flux change is n87 , which increased by @xmath66mx .",
    "these two poles are paired , the domain flux ",
    "change is set to @xmath66mx , and p48 s flux budget is reduced to @xmath67mx .",
    "there are no more available connections between our preferred poles , so we next account for boundary shifts . after doing so",
    ", the least changing region is n38 , which loses @xmath68mx . the closest positive pole with the correct sense of flux change is p19 , which lost @xmath69mx .",
    "these two poles are paired , the domain flux ",
    "change is set to @xmath68mx , and p19 s flux budget is reduced to @xmath70mx .",
    "we again select the least changing region ( n49 ) , and the process continues until no more pairings can be made .",
    "the final results for this timestep are shown in table [ tab : smat ] .",
    "lcr domain & sense & @xmath71mx ) + p19n1 & submerge & 245.764 + p19n38 & submerge & 30.6279 + p19n49 & submerge & 145.569 + p19n58 & submerge & 257.030 + p48n87 & emerge & 849.874 +    the pairings represent a compromise between reasonable inference and mathematical necessity . due to their proximity , and common increase , it is reasonable to assume p48n87 are feet of the same emerging flux tubes .",
    "p19 , on the other hand , is relatively isolated but has steadily decreasing flux .",
    "it is necessary to pair it with decreasing negative poles , which turn out to be arranged along the periphery of the old polarity .",
    "being separated by @xmath72 , these regions can not be `` submerging '' in any real sense .",
    "however , we believe this decrease represents steady cancellation with the small scale field surrounding these old  flux regions . this process should be studied in detail in another investigation , but for the moment we note that it is well represented by a reduction in , for instance , the p19n49 domain flux .",
    "we repeat this process for each pair of consecutive timesteps .",
    "figure [ fig : p29dom ] provides a representative example , showing the cumulative domain flux changes ( designated by the symbol @xmath73 ) due to the emergence , and slight amount of submergence near the end of our analysis , of p29 , one element of the newly emerging flux .",
    "we see here that it emerges primarily with region n58 , part of the newly emerging flux .",
    "cumulative changes in each of p29 s domain fluxes , as calculated with the algorithm of  [ sec : qsef ] .",
    "we find that p29 primarily emerges with n58 and n38 .",
    "]    the effectiveness of the combined algorithms can be appreciated in figure [ fig : bndry ] , showing the three componenets of the diffuse western region .",
    "the blue line illustrates the effectiveness of our algorithms at capturing the system s behavior due to submergence and emergence . as the field shears , the boundaries between the three subregions have a tendency to discontinuously jump , resulting in large variations in the flux in each region , accounted for by the boundary algorithm .",
    "however , the combined flux of the three subregions , shown in black , instead displays a fairly steady decrease : this whole region is submerging .",
    "the blue line shows our reconstruction of this submergence using the source  change matrix at each time .",
    "each pole has an initial flux value , to which we add the elements of @xmath62 , so that each pole s flux at time @xmath32 is given by @xmath74 .",
    "this measure completely discounts the ( artificial ) boundary shifts between photospherically adjacent regions .",
    "we then sum the flux in each pole thus reconstructed , and this is our estimate for the submergence of diffuse western region .",
    "we note that the blue and black lines follow each other reasonably well , indicating that our algorithms accurately capture the submerging trend of this region .",
    "in the second section of our analysis , we employ the minimum current corona ( mcc ) model @xcite to use the amount of flux change in each domain to calculate the amount of free magnetic energy stored in our system as it evolves away from a potential configuration . to that end",
    ", we must define a set of topological elements .",
    "these definitions , briefly summarized below , are described more fully in @xcite and references therein .",
    "the general idea is to model distributed photospheric sources as point sources .",
    "the potential field generated by these sources will have null points , @xmath75 , where the magnetic vector field vanishes : @xmath76 .",
    "we may perform a linear expansion of the field about these points @xcite @xmath77 where the jacobian matrix @xmath78 is both symmetric and traceless because @xmath79 . as such , @xmath80 has three orthogonal eigenvectors with three real eigenvalues : the eigenvectors of the two like  signed eigenvalues define a plane ( the fan ) ; the eigenvector of the opposite  signed eigenvalue defines a line orthogonal to this plane ( the spine ) . from this foundation",
    "the rest of the topological description follows .",
    "we define a _ pole _ , the photospheric point source , located at the flux  weighted centroid of a mask .",
    "_ nulls _ are the zeros of the potential magnetic field , and _ spines _ , the fieldlines connecting a pole to a null along the single eigenvector .",
    "a _ fan _ ( synonym _ separatrix _ ) is the set of fieldlines ending in a null s like  signed eigenvector plane .",
    "domain _ is a simply connected space filled with field lines connecting a given pair of poles .",
    "finally , a _",
    "separator _ is the field line connecting two nulls , formed at the intersection of their respective fan surfaces . in a nonpotential field ,",
    "the separator may broaden into a two dimensional ribbon .",
    "coronal current sheets form along the separators of the field .",
    "we determine the locations of all nulls in two steps .",
    "first , we find those laying in the photospheric plane via the newton ",
    "raphson method of @xcite .",
    "second , we check the euler characteristics given in @xcite , which provide both 2d and 3d relations between the number of nulls of each type and the number of sources of each polarity . when the 3d characteristic is not satisfied , at least one coronal null is missing .",
    "when then supply a `` by ",
    "eye '' list of initial @xmath81 guesses to the same newton ",
    "raphson root finding method until coronal nulls have been found and the euler characteristics are satisfied .",
    "other more automated coronal null detection methods have been developed @xcite , but the ad  hoc method described here has worked well in this case .    after determining the location of all nulls ,",
    "we located separators via the method of @xcite , with one modification .",
    "those authors only treat photospheric nulls , whose separators lay within separatrices above the photosphere . for coronal nulls , we search for separators in all @xmath82 directions within the null s fan surface .",
    "our model photosphere consists of a plane @xmath83 of isolated sources surround by regions where the normal component of the magnetic field is zero .",
    "this boundary condition may be satisfied using the method of images , as in @xcite6 . with the normal field",
    "reflectionally symmetric in @xmath84 , we have that @xmath85 . whenever we introduce current in the corona along a separator , we must introduce its reflection in the mirror corona to maintain this symmetry . in this way",
    ", our separators form closed current loops .",
    "topology of noaa ar 11112 on the eve of the flare , depicted in a local tangent plane with coordinates .",
    "the point of tangency is taken as the center of charge in the initial magnetogram , translated through solar rotation to the present time , and the axes are in mm .",
    "pluses and crosses are positive and negative poles , respectively ; triangles are positive ( @xmath86 ) and negative ( @xmath87 ) nulls ; solid black lines depict spines , dashed lines the trace of fans within the photosphere , and the dotted line is a coronal spine , attached to the coronal null b15 .",
    "blue and red lines are projections of separators into the photosphere , with red lines those separators connected to the coronal null.,scaledwidth=75.0% ]      once we have created the set of matrices describing domain flux changes due to submergence or emergence , we can create similar matrices describing the flux change due to a changing potential field .",
    "we calculate the potential field connectivity at each timestep via the monte carlo method of @xcite .",
    "this produces a set of connectivity matrices @xmath88 , where @xmath89 is the flux connecting sources @xmath57 and @xmath58 at time @xmath32 . from these matrices",
    "we calculate the change in connectivity due to the changing potential field : @xmath90 summation along rows of the connectivity matrix returns the total flux of the corresponding pole ; eg .",
    "we define @xmath92 to be antisymmetric , as with the matrices @xmath62 and @xmath54 before .",
    "the mcc model derives an energy from the discrepency between the actual domain fluxes @xmath93 at time @xmath94 and the potential fluxes then , @xmath95 . in the absence of flux emergence or submergence ,",
    "the actual fluxes are fixed using the potential field domain fluxes at some initial time : @xmath96 , as in @xcite . any flux emergence or submergence through the photosphere , quantified as @xmath62 in the previous section , modifies these actual domain fluxes , so that @xmath97    because we assume a field , initially potential , whose fluxes are fixed under future evolution , we determine how far removed the field is from a potential field configuration by answering the question , `` what flux must be added to a potential field domain @xmath98 at time @xmath99 to get a potential field domain at time @xmath32 ? '' this question is answered by @xmath100 on the right hand side , the first term is the potential field at the initial time .",
    "the second is the total flux change through the photosphere .",
    "the final term is flux change due to coronal redistribution , which must be achieved by modifying the connectivity matrix .",
    "together , the first two terms give the actual domain flux @xmath101 at time @xmath32 .",
    "all flux changes from coronal reshuffling are then given by @xmath102 equation holds for all domains , of course , and we represent this as a matrix equation by dropping the domain subscript @xmath98 .",
    "@xmath92 is antisymmetric , and we have defined @xmath62 to be antisymmetric , so @xmath103 is also antisymmetric . while antisymmetry of these matrices carries no physical information , we will later show that it does endow @xmath103 with a nice mathematical property .",
    "note that the difference in between the actual domain fluxes and the potential field fluxes depends on the choice of the inital time @xmath104 .",
    "when dealing with actual data , we must pick an initial time to apply the mcc flux constraint when we believe the field is in a potential configuration in order to find a meaningful difference relative to a later potential configuration .",
    "ideally , we would track a single region from its inception up to an event which redistributes the coronal flux , as in a flare .",
    "while noaa ar 11112 does not fit this criteria , it likely matters little in this case . as is apparent from our supporting media , and also as we will show below , noaa ar 11112 has a very stable flux configuration for @xmath105hours prior to flux emergence .",
    "this newly emerged flux , fixed in set domains as the photospheric field continues to evolve , rapidly diverges from a potential field configuration at later times .",
    "so far this discussion only involves the sources themselves and their interconnections .",
    "let us now introduce a set of separators @xmath106 .",
    "separators are field lines that run from a null point of one type to a null of the opposite type . in the mcc model",
    ", they are the sites of current sheets within the corona@xcite .",
    "because current may only flow in loops , the separators themselves must close along some path in the mirror corona .",
    "we can then speak of separator fluxes : the flux of domains linked by some separator @xmath107 with its closure . we will discuss closures and explain the concept of linking in detail below , but the general idea is that field lines in a linked domain can not reconnect to another domain except by passing through the separator .",
    "let @xmath108 be the flux linked by @xmath107 at time @xmath32 in the actual field , and @xmath109 be flux in the potential field domains @xmath110 linked by @xmath107 .",
    "for a given closure , a separator always links the same set of domains throughout time .",
    "the fluxes in those domains will generally change over time , however . when a domain s flux goes to zero , the domain no longer exists .",
    "the flux  constrained  equilibrium ( fce ) assumption of the mcc model states that domain fluxes are fixed as the field evolves .",
    "minimization of the field s energy subject to these constraints shows that the coronal field will be current  free except along the separator , where a current ribbon forms @xcite .",
    "this occurs whenever @xmath111 .",
    "we therefore define @xmath112 the double sum over elements of the redistribution matrix @xmath113 is the difference between the flux linked by the separator in the actual and potential fields at time @xmath32 .",
    "it is also the self  flux generated by current flowing along the separator , and therefore , the flux that must be added to the real field to relax the fce constraint of mcc : @xmath114 .",
    "our method for calculating energies therefore rests on two assumptions .",
    "the first is that at some initial time @xmath115 we assume that the domain fluxes are given by the potential field s domain fluxes , @xmath116 , so that all the separator fluxes @xmath117 .",
    "the second assumption is that the evolution of the current ribbon s self  flux depends on the evolution of the both the actual and potential field configurations : @xmath118 summed over time , this is just the restatement of itself , namely that the current ribbon s flux at some time @xmath32 is the sum of all changes in each linked domain s flux over the life of the separator .    when @xmath119 is small we can estimate the properties of the current ribbon , as in @xcite . for a separator of length @xmath120 carrying current @xmath121",
    ", they determine the self  flux to be @xmath122 where @xmath123 is a measure of magnetic shear in the separator s vicinity . from this the excess energy of the mcc field relative to the potential field , i.e. the free energy , is@xcite @xmath124 note that and only take into account energy due to the self inductance of each current loop . in general , we must include the effect of mutual inductance , though for physically separated loops we expect self inductance to dominate the total energy .",
    "the fce assumption requires that @xmath125 , which allows us to solve for the current in the current ribbon as a function of @xmath126 : @xmath127 where @xmath128 is the inverse of the function @xmath129 . equation provides a method for determining the current residing in , and hence the energy stored by , each separator : it tells us the current required to change the domain flux enclosed by a separator from that of a potential field to some other value . in the present case that value is given by the non ",
    "zero elements of @xmath103 .",
    "a reverse , cumulative sum over the time index @xmath32 for a given flux domain @xmath63@xmath130 gives the time  history of departure from a potential field configuration .      as is implicit in",
    ", each separator may link more than one domain : the appropriate @xmath119 for a separator is the sum of all changes in domain fluxes for each domain linked by that separator . since all field lines in a given domain are topologically equivalent , we may establish separator linkage using a single representative fieldline and the separator itself . after each of these open curves",
    "is closed , their linkage is found using the gauss linking number@xcite , @xmath131 , for each field line ",
    "separator pair : @xmath132 the linking number not only determines whether a separator links a field line ( @xmath133 ) , but also the sense in which it does so ( @xmath134 an integer ) : to calculate the correct @xmath135 , you must sum over all linked domains , multiplied by their respective linking numbers .    in order to use gauss linking formula , we must have two closed curves , whereas our curves ( usually ) begin and end at two separate sources ( nulls for separators ) in the photosphere , never penetrating beneath .",
    "so , in order to apply the linking formula in this case we must add to each coronal curve some curve in the mirror corona to form a complete loop .",
    "there are , in general , many ways to form the closure for each curve , and not all of them will lead to the same linking number .",
    "one requirement is that the separator be closed _ above _ the field line s closure : any closure below the field line will always give a linking number of zero .",
    "therefore , we have chosen to close the separator with a straight line between the footpoints in the photosphere , and the field lines with a rectangular path formed by following the footpoints down and connecting them with a straight line in the @xmath136 mm plane .",
    "another method would be to close the separator , say , with its projection into the @xmath137 ( photospheric ) plane .",
    "either method is valid , so long as the same method is used for all field lines and separators .",
    "another requirement for using the linking number to find linked domains is that we follow field lines and separators in a consistent direction . in general , changing the direction of _ one _ of the integrals takes @xmath138 . for definiteness",
    ", we always trace separators from negative ( a  type ) nulls to positive ( b  type ) nulls above the photosphere , and thus close separators from b@xmath139a in the photosphere .",
    "because the reconnection matrix @xmath103 is antisymmetric , this same care is unnecessary when tracing the field lines , at least for the purpose of the @xmath135 calculation .",
    "let us designate by @xmath140 the difference in flux ",
    "change for the real versus potential field between times @xmath32 and @xmath34 ( as in ) , when we trace a field line from p1 to n2 in the corona , and close the field line from n2@xmath139p1 below the photosphere .",
    "then , @xmath141 we have therefore been justified in simply writing @xmath142 , with no designation of tracing a field line from positive to negative or negative to positive in the corona , because @xmath142 is just a summation of multiple such domains .",
    "this holds provided we always trace the separator in the same direction .",
    "once determined , the linking number for each separator / field line pair provides the correct method for calculating each separator s total @xmath135 , including all linked domains , and hence the energy stored by each separator .",
    "we must account for instances where two photospheric regions merge together or split apart , as illustrated in figure [ fig : constrict ] .",
    "therein , we focus on 4 poles@xmath143with four flux domains@xmath144and two separators , @xmath145 and @xmath146 , which link the domains in some fashion .",
    "suppose two of the poles are each connected to the same null via its spines . if the flux of one pole is zero before(after ) a split(merger ) , then the null between them does not exist at that time , and the flux in the domains linking the sources goes to zero .",
    "now , if either @xmath145 or @xmath146 is attached to that null , then the separator will arise or cease to exist with that null , and the flux linked by it is appropriate .",
    "then again , if these separators are attached to some other set of nulls and happen to link these flux domains , our calculated linked flux is still appropriate .",
    "say flux domain @xmath147 , for instance , either folds into or breaks out from domain @xmath148 .",
    "the actual break or merger constitutes a boundary shift ( with @xmath149 having zero flux either before or after the event ) and so does not contribute to the flux linked by either separator .",
    "any additional flux change on top of this is either appropriately picked up by @xmath145 or @xmath146 , but not both .",
    "topological depiction of two poles either splitting or merging : @xmath150 .",
    "dots depict the sources , lines the domains , and red arcs the separators . ]",
    "a second complication arises when we encounter a coronal null , as we see in the topology of noaa ar 11112 in figure [ fig : topo ] near local tangent plane coordinates ( 20,30)mm . if a coronal null has any separators connected to it then it must have at least two : one carrying current up , the other down .",
    "if many separators connect to the coronal null , then some must carry current up , and others down , but all balanced according to kirchhoff s rules . in order to calculate the flux within a separator  induced domain , we must close the separator somehow .",
    "above , we addressed this by prescribing a photospheric closure for separators .",
    "now , however , we must first stitch pairs of separators together in order to get back to the photosphere . if we have @xmath151 separators connected to the coronal null , we require @xmath152 separator pairs , or `` isolating loops '' in the terminology of @xcite .",
    "we might assume that the currents flowing along the @xmath152 loops would distribute to minimize the energy due to self and mutual inductances .",
    "this problem remains to be solved , and for the moment we simply designate one separator linked to a coronal null as the `` shared '' separator .",
    "we have found that the energies we calculate do not depend heavily on the choice of common leg , laying within @xmath153 of each other .",
    "as shown in figure [ fig : topo ] , we have a single coronal null , b15 , with spine lines leading to @xmath154 and @xmath155 .",
    "four separators ( in red ) connect to the coronal null : from null a09 between @xmath156 and @xmath157 , a05 between @xmath157 and @xmath158 , a08 between @xmath158 and @xmath159 , and a07 between @xmath159 and @xmath37 . again , because all current flowing from the photospheric nulls up to the coronal null must be balanced by current flowing back down to the photosphere , we mush combine these four separators into three , all of which share one leg ; it does not matter which one .",
    "we have chosen a05b15 leg to be common to all three separators . as we will see below",
    ", the a05b15a08 separator generates the greatest amount of energy in this system .",
    "this is expected , given the high horizontal shear in the photospheric field between @xmath154 and @xmath158 , and the greatly flux ",
    "deficient domain between these two poles , relative to the potential field configuration at the time of the flare .",
    "we may summarize the previous several sections in the following way . in order to perform an energy calculation",
    ", we need a set of poles @xmath160 at a given time final time @xmath161 ; a set of nulls at the same time @xmath162 ; a set of separators at the same time @xmath163 ; a time  history of the reconnective changes in domain fluxes from the final time , backwards to a previous time @xmath94 where we may assume the field was potential , @xmath164 ; and a set of domains @xmath165 linked by each separator .    having all these pieces",
    ", we then calculate the total domain flux difference in each domain at time @xmath161 relative to the initial presumed potential field . for each separator",
    ", we find all domains linked by that separator .",
    "next , each linked separator s time  history of reconnective flux changes is summed . this total flux ",
    "change for each linked domain is then multiplied by the gauss linking number for that domain / separator pair .",
    "finally , the total domain changes are summed for each linked domain to fix the total flux difference of the separator at the final time @xmath161 , relative to the potential field at the initial time @xmath94 .",
    "mathematically , this is given by , reproduced here : @xmath166 this flux is generated by the current along the separator , , which may be found by the inversion , and plugged into the energy equation to find the energy in excess of the potential field energy at time @xmath161 in the minimum current corona model with the fce constraint applied at time @xmath94 .",
    "this energy is a lower bound for any coronal energy model .",
    "by time of the flare ( figure [ fig : newflux ] ) the new flux in noaa ar 11112 has bubbled up and expanded within the interior of the old  flux ring .",
    "the effect is especially pronounced between regions p22 and n49 , the boundary of which has a very strong horizontal gradient in the vertical field . because this gradient is between old and new flux , prior to reconnection during the flare there is little flux in the domain connecting these two regions , and certainly far less than there would be in the potential configuration at that time .",
    "we expect one action of the flare will be to increase the flux within the p22n49 domain . because its flux is conserved , any flux p22 adds to its n49 domain must come at the expense of its other domains .",
    "the poles with which p22 shares these other domains  primarily n58 , n55 , and n87 with which p22 emerged  must in turn shuffle their flux into different domains . in this way , a flare originating in one place propagates its effects throughout the entire magnetic structure until it establishes a new , lower energy equilibrium .",
    "cumulative domain flux changes for various p22 domains , relative to the potential field at t=0 .",
    "arrows indicate the onset of flux emergence and the ut 19:07 m2.9 flare .",
    "there is some `` pre  emergence '' flux due to our 13 timestep smoothing function . ]",
    "we can get a picture of this process by looking at the cumulative domain flux changes for various p22 domains , shown in figure [ fig : p22rmat ] . here , the flux at each timestep is given by the cumulative sum of all flux changes up to that time , @xmath167 .",
    "this figure shows by how much flux a domain must be changed to match the potential field configuration of the initial field , plus the contribution due to emergence .",
    "p22 emerges in conjuction with n55 , n58 , and n87 , thus all flux is assigned to domains p22n55 , p22-n58 , and p22-n87 .",
    "the potential field , however , assigns less flux to these domains and more ( i.e. some ) to domains such as p22n1 and p22n49 .",
    "these latter domains are flux ",
    "deficient relative to the potential field , and appear above the zero line in figure [ fig : p22rmat ] .",
    "the former are flux  excessive , as a result of emergence , and appear below .",
    "note that the potential field distributes the flux among domains differently at different times , and our analysis captures these changes . in particular , p22 emerges to the east of n1 , then migrates westward . as p22 moves past n1 ,",
    "the p22n1 domain first becomes deficient , then more sufficient as the p22n38 and p22n67 domains become increasingly deficient . the total flux in p22 only slowly increases throughout much this time ( it is mostly emerged by 50hrs , as shown in figure [ fig : fluxplot ] ) , so these later changes in the potential configuration are largely due to shear motion in the photosphere , rather than the initial emergence .",
    "aia 171  images during the flare reveal how reconnection works to restore a flux balance closer to potential . at successive times , we see brightenings of small loops progressing west to east within the newly emerged regions .",
    "after this we see a series of loop brightenings connecting the new negative regions within the ring to the old diffuse positive region to the west .",
    "we believe that this series of loop brightenings is a direct result of domain restructuring due to the emergence of the new flux and its highly nonpotential original field configuration .",
    "two cumulative time ",
    "sums over @xmath168 .",
    "the solid line sums from the initial time , 0 , to time @xmath32 and is the flux required to change the domain at time @xmath32 to an assumed potential field at the initial time .",
    "the dotted line sums from time @xmath32 to the final time , @xmath169 , and is the flux required to change the final potential field configuration to a flux configuration fixed at time @xmath32 .",
    "the difference between the initial and final values is the same for both sums , and they are mirrors of each other about the average of this difference . ]    the fluxes shown in figure [ fig : p22rmat ] provide a good description for understanding the evolution of each domain , and directly follow the calculation outlined in   [ sec : seps ] . in this paper , however , we are interested in calculating the free energy due to a difference between domain fluxes fixed at some initial time and potential fluxes at the time of the flare . for a completely new active region , we would assume all domain fluxes are zero except those which emerge together ; in this case , our emergence occurs in a region of substantial old flux . as such",
    ", our final time is fixed by the flare , and we must choose an appropriate time of initial constraint .",
    "combining equations and , we find that @xmath170 , so that@xmath171 is the flux that must be added to domain @xmath98 to account for change in addition to submergence and emergence , which is accounted for within @xmath172 .",
    "figure [ fig : p22rmat ] shows the cumulative flux @xmath173 . wishing to vary the time of constraint",
    ", we calculate the reverse of this : @xmath174 .",
    "this is the amount of flux that must be added to the domain constrained at time @xmath32 , @xmath175 , to match the potential field domain at time @xmath176 . as we will show below",
    ", this summation is basically constant prior to emergence : the old flux region is initially stable , and flux emergence drives a departure from this stable configuration .",
    "figure [ fig : twosums ] gives an example of both the forward and reverse summations for domain p22n49 .",
    "we set the fluxes for the energy calculation in this way because the assumption of the mcc model is that , barring reconnection , the domain fluxes are fixed , and prior to the flare there is no reconnection . in order to compare with a potential field at the time of a flare , we determine our topology immediately before the flare .",
    "this fixes all of the poles , nulls , and separators , and the domains linked by each separator .",
    "the energy calculation then answers the question , `` _ _ supposing the domain fluxes are fixed at time @xmath32 , by how much must they be changed to match the potential field at the final time ? _ _ '' this difference for each domain linked by a separator then determines the amount of current along that separator , and hence the amount of energy stored by that separator .",
    "a reverse  cumulative sum of the total domain fluxes linked by each separator relative to the potential field configuration just prior to the flare , identified by nulls to which they attach .",
    "separators with three listed nulls are those which pass through the coronal null , b15 . ]",
    "as mentioned previously , a single separator will generally link multiple domains .",
    "for instance , one of the separators passing through the coronal null b15 in figure [ fig : topo ] , connecting nulls a05b15a07 , links three domains , n58p22 , n67p22 , and n38p29 , with gauss linking numbers -1 , -1 , and + 1 , respectively .",
    "the residual fluxes for two of these domains , n58p22 and n67p22 , are shown in green and purple in figure [ fig : p22rmat ] ; the n38p29 domain residual fluxes is similar , peaking at @xmath177mx around 90 hours .",
    "this separator @xmath107 s flux , including all three domains @xmath178 with linking numbers @xmath179 , is then given at each time @xmath32 by @xmath180 the sum for this separator is plotted in red in figure [ fig : sepflux ] .",
    "the curve shows that , as we look further back in time , the flux linked by this domain increasingly departs from the final potential field configuration , until around @xmath181 hours when all changes level off .",
    "this is when region p22 first emerges .",
    "note that every separator shows relatively little change in the linked flux before this time .",
    "based on figure [ fig : sepflux ] , we might expect the a11/b03 separator to store the most energy , as it has the most linked flux .",
    "however , the amount of current flowing in this separator is 12 orders of magnitude less than in the three separators connected to the coronal null : the longer a separator , the less current necessary to generate the required self  flux .",
    "figure [ fig : energy ] plots the magnetic free energy when applying the fce assumption at varying timesteps .",
    "we see that the energy of the three separators connected to the coronal null , shown in magenta , red , and dark green , completely dominate the magnetic free energy buildup .",
    "the blue line shows the total for all separators .",
    "we also see that , constraining the domain fluxes at any time before the onset of flux emergence , @xmath182 hours , effects little change in the total energy buildup .",
    "essentially all of the flux difference relative to the final potential field configuration is due to the emergence itself .",
    "the mcc yields a lower bound on the magnetic free energy of a system . after accounting for all flux linked by all separators , and",
    "hence the energy stored in each separator , we conclude that noaa ar 11112 stores a minimum of @xmath183 ergs of free magnetic energy over the 23 days leading up to the october 16@xmath56 , 2010 goes m2.9 flare .",
    "free magnetic energy relative to a potential field at the final time , and applying the fce assumption at successively earlier timesteps for each separator , and for the total ( blue ) .",
    "our energy estimate is then the value of the initial timestep , @xmath184ergs .",
    "arrows indicates the onset of emergence and the time of the m2.9 flare .",
    "note that there is some `` pre  emergence '' due to our boxcar smoothing function . ]",
    "in this work we have extended the application of the minimum current corona model to the estimation of energy stored along separators in the coronal field in active regions where flux submergence and emergence plays a significant role in the photospheric field s evolution .",
    "this estimation operates in two distinct parts . in the first , we track the evolution of the photospheric line  of  sight magnetic field using sdo / hmi magnetograms .",
    "we found that the higher cadence and greater resolution of hmi , compared to previous analysis using full disk mdi data at a 96minute cadence , greatly improved this portion of the analysis .",
    "we found that a half hour cadence was sufficient to capture the evolution of this active region .",
    "analysis of this region began before the hmi 720 second averaged data were available .",
    "future investigations will use the high quality averaged dataset .",
    "the tracking information is stored in a mask array , which assigns unique labels to contiguous groups of data pixels , and matches these labels across all timesteps .",
    "this framework accounts for all processes we see in the data : submergence and emergence , merging , splitting , braiding , and spinning . in the present work we focus on submergence and emergence of magnetic flux .",
    "all other processes are implicitly addressed in our work except for spinning .",
    "@xcite have accounted for spinning explicitly in their work and found that its importance is case dependent .",
    "we do not believe spinning plays a significant role in noaa ar 11112 .    in the second part of our analysis we use the tracking information in the mask array to characterize the system wholly in terms of its topology .",
    "each region s total flux , together with its flux  weighted centroid , defines a magnetic pole .",
    "a potential field extrapolation using the poles as sources , together with a mirror corona where @xmath185 yields all null points of the system .",
    "the potential field extrapolation determines the locations of separators , which are where current sheets form due to free magnetic energy in the coronal field in the mcc model .",
    "the amount of current flowing in each separator , and the amount of free energy in the field , is due directly to the nonpotentiality of each flux domain .",
    "a lower bound on the free magnetic energy is calculated from the separators and domain fluxes using the method of @xcite , who found that the mcc estimate may be less than other mhd free energy estimates by a factor of ten or more . for noaa",
    "ar 11112 we found a lower bound of @xmath186 ergs .",
    "this method requires that all domains linked by each separator are known .",
    "this has been done by inspection in the past @xcite , but in the present work we have proposed an efficient automatic method using the gauss linking number .",
    "provided the specification of some closure for both field lines and separators , and because domains are simply connected spaces , calculating the linking number for each separator and a single field line from each domain will find all linked domains for each separator , and the sense in which they are linked @xmath187",
    ". it must be noted , however , that domains are not equivalent to connections : a single pair of positive and negatives poles may be multiply connected , with different domains in a single connection distinguished by one or more separators .",
    "we found no such instances of this in the case of noaa ar 11112 , but this scenario may be simply dealt with by tracing a large number of random field lines between each pair of multiply connected poles .",
    "one may then calculate the gauss linking number of each separator with the suite of field lines , and determine the proportion of field lines linked by each separator .",
    "the linked flux may then be divided among the separators , accordingly .",
    "our free energy estimation does have some limitations .",
    "most important , we can only calculate energy storage , not energy release , for instance , in a flare .",
    "this is because we fix the domain fluxes at some point in the past and compare them to the potential field domain fluxes at some given time ; however the flare is a coronal phenomenon , while the potential field configuration is derived purely from photospheric data . using coronal data to quantify how domain fluxes change during a flare",
    "would allow for an energy estimation before and after a flare , though we are aware of no method for doing so .",
    "second , our energy calculation only takes into account the self  inductance of each current ribbon .",
    "for a set of currents loops , the total energy is given by both self and mutual inductance terms .",
    "when the loops are physically separated , the self inductance terms should dominate .",
    "however , if some subset of loops share a common leg ( as is the case when multiple separators are connected to a coronal null point ) , then mutual inductance will significantly contribute to the total energy and must be accounted for .",
    "this work remains to be done .",
    "graham barnes graciously provided code for producing the potential field connectivity matrices using a monte carlo algorithm with bayesian estimates , as described in @xcite .",
    "development of the code was supported by the air force office of scientific research under contract fa9550 - 06-c-0019 .",
    "we thank the referee for his / her thorough reading and insightful comments which helped improve the manuscript .",
    "we also thank our summer 2010 reu student johanna bridge for her work in assessing the performance of the automatic tracking algorithms .",
    "this work was supported by nasa lws ."
  ],
  "abstract_text": [
    "<S> the minimum current corona ( mcc ) model provides a way to estimate stored coronal energy using the number of field lines connecting regions of positive and negative photospheric flux . </S>",
    "<S> this information is quantified by the net flux connecting pairs of opposing regions in a connectivity matrix . </S>",
    "<S> changes in the coronal magnetic field , due to processes such as magnetic reconnection , manifest themselves as changes in the connectivity matrix . </S>",
    "<S> however , the connectivity matrix will also change when flux sources emerge or submerge through the photosphere , as often happens in active regions . </S>",
    "<S> we have developed an algorithm to estimate the changes in flux due to emergence and submergence of magnetic flux sources . </S>",
    "<S> these estimated changes must be accounted for in order to quantify storage and release of magnetic energy in the corona . to perform this calculation over extended periods of time </S>",
    "<S> , we must additionally have a consistently labeled connectivity matrix over the entire observational time span . </S>",
    "<S> we have therefore developed an automated tracking algorithm to generate a consistent connectivity matrix as the photospheric source regions evolve over time . </S>",
    "<S> we have applied this method to noaa active region 11112 , which underwent a goes m2.9 class flare around 19:00 on oct.@xmath0 , 2010 , and calculated a lower bound on the free magnetic energy buildup of @xmath1ergs over 3 days . </S>"
  ]
}