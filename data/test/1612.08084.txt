{
  "article_text": [
    "biological networks transform multiple input signals into outputs that have functional significance for the organism .",
    "one path to understanding these transformations is to `` read out , '' or decode this relevant information directly from the network activity . in neural networks ,",
    "for example , features of the organism s sensory inputs and motor outputs have been decoded from observed action potential sequences , sometimes with very high accuracy  @xcite .",
    "decoding provides an explicit test for hypotheses about how biologically meaningful information is represented in the network and which computations are needed to recover it .",
    "here we address these questions in a small genetic network , taking advantage of experimental methods that allow us to measure , quantitatively , the simultaneous expression levels of multiple genes .",
    "the gap genes involved in patterning the early fruit fly embryo provide a particularly accessible example of the decoding problem @xcite .",
    "as schematized in fig [ f1]a , the gap genes form an interconnected layer in an otherwise feed - forward network that takes inputs from the primary maternal morphogens to drive the expression of the pair - rule genes .",
    "pair - rule expression occurs in stripes that are precisely and reproducibly positioned within the embryo , forming an outline for the segmented body plan of the fully developed organism . in this system ,",
    "states of the network are the expression levels of the gap genes , and the functional information being encoded is the position of cells along the anterior  posterior axis ( fig [ f1]b )",
    ".    we will use the gap gene network to distinguish between two very different views of network function . in one view",
    ", the control of gene expression is noisy , network interactions are essential to achieve robustness against uncontrolled variations in the input signals , and many layers are needed to funnel the states of cells toward reliable choices among discrete fates ( canalization ) . in this view , information available to individual cells from gap gene expression levels should be very limited , and the accuracy associated with a reproducible body plan should emerge only in subsequent layers of processing . in another view ,",
    "noise levels are as low as possible given the limited number of molecules involved @xcite , the reproducibility of developmental patterning can be traced back to reproducible maternal inputs @xcite , and network interactions are selected to extract the maximum amount of information from these inputs @xcite . in support of this latter , precisionist view , we have shown that the expression levels of the four gap genes , taken together at one moment in time , provide enough information to specify the location of each cell along the anterior  posterior axis of the embryo with @xmath0 precision @xcite , comparable to the precision with which pair - rule stripes and other morphological markers are specified .",
    "showing that precise information is available is not enough : to say that the system operates in a precisionist mode we must show that this information is used by the embryo to guide subsequent developmental events . to do this",
    ", we will decode the information carried by gap gene expression levels , and manipulate these signals through mutations in the maternal inputs to the network .",
    "if the organism really uses the information that we have found encoded in the gap gene network , then our decoding of this information should make quantitative predictions for the functional consequences of mutations at the input .    in the fly embryo ,",
    "information encoded in the levels of gap gene expression is decoded by the complex regulatory logic of the pair rule gene enhancers @xcite , and one might think that decoding requires us to make a model of these molecular events .",
    "but if the embryo makes optimal use of the available information @xcite , then the algorithm for decoding positional information is determined , mathematically , by the pattern of gene expression as a function of position and by the distribution of fluctuations around this mean . exploiting our ability to make precise , quantitative measurements on the expression of all four gap genes simultaneously @xcite , we can characterize these fluctuations and construct the optimal decoder with no free parameters ; this is not a model of the decoder , but rather a theoretical prediction of what the decoder should be if the embryo performs optimally . applied to gap gene expression levels in wild - type embryos , this optimal decoder generates unambiguous estimates of position , which fluctuate only slightly from the true position . in mutant embryos",
    "deficient for various primary maternal inputs , gap gene expression changes at each point in the embryo , and the decoder generates distorted `` maps '' of implied vs true position ; these maps in turn can be used to predict the locations of pair - rule stripes .",
    "we find that these predictions are in detailed , quantitative agreement with experiment , again with no adjustable parameters .",
    "these results strongly support the idea that biologically relevant information is carried by precisely controlled gene expression levels , so that the function of this genetic network is fundamentally quantitative , down to @xmath0 accuracy in the encoded variable .",
    "the expression levels of the gap genes vary with position , but even at a single position there are variations around the mean expression level .",
    "thus , at each point @xmath1 along the anterior  posterior axis of the embryo , there is a probability distribution , @xmath2 , where @xmath3 are the expression levels of the genes , in our case the gap genes _",
    "hunchback , _ _ krppel , _ _ knirps , _ and _ giant_. the problem facing a cell , however , is not to predict the expression level given knowledge of its position . on the contrary",
    ", the cell must respond to the expression level by taking actions appropriate to its position .",
    "mathematically , the possible positions of the cell are drawn out of the conditional distribution @xmath4 which we construct using bayes rule ; we use @xmath5 to remind us that this is the position _ implied _ by the expression levels , rather than the actual position of the cell .",
    "@xmath6 is the probability that a cell will be at position @xmath5 , independent of gene expression level , and in the simplest case the cells are uniformly distributed along the axis @xmath7 , so that @xmath8 .",
    "@xmath9 is the probability that we will find a cell with expression levels @xmath10 , independent of its position , @xmath11 .",
    "the probability distribution @xmath12 contains everything that a cell could `` know '' about its position based on the expression levels @xmath10 .",
    "if the cell responds to the expression levels in a way that matches the structure of this distribution , then that response is part of an optimal decoding . to be more precise ,",
    "if the probability distribution @xmath12 has a single , reasonably sharp peak at @xmath13 , then we can translate expression levels back into positions , unambiguously , using a dictionary @xmath14 , and the width of the distribution @xmath12 tells us how much error or uncertainty there will be in this estimate of position .",
    "we could formalize this by asking for the value of @xmath5 that maximizes @xmath12 , which is called the maximum a posteriori estimator , or for the value of @xmath5 such that we make smallest mean - square error relative to the true position , and these are essentially the same if there is a single sharp peak in the distribution .",
    "but it also is possible that @xmath12 has multiple peaks , in which case there are genuine ambiguities in decoding , and hence the gene expression levels we are analyzing in fact are not sufficient to determine the position and hence the fate of the cell .",
    "since we do nt know in advance that decoding will be successful , it is useful to keep track of the entire distribution . indeed , since the information that we are discussing is information about position , it is useful to express the results of decoding as a _ map_.    consider a particular embryo @xmath15 , in which we find expression levels @xmath16 in the cell at actual position @xmath17 . instead of thinking of the distribution of possible positions in eq ( [ decode1gene ] ) as depending on all of the gene expression levels , we can think of it as depending on the actual position of the cell , forming a map of possible or inferred positions vs actual positions , @xmath18 if the genes we are considering provide enough information to specify position accurately and unambiguously , then @xmath19 will be a narrow ridge of density surrounding the line such that the implied position is equal to the true position , @xmath20 .    to implement these ideas ,",
    "we begin by measuring expression of all four gap genes , simultaneously , as described in detail in appendix [ app_exp ] .",
    "we sort the emrbyos by time , and focus on a window 38@xmath2148 min into nuclear cycle fourteen , during which gap gene expression provides the most information about position @xcite .",
    "we approximate the distribution @xmath2 as being gaussian @xcite , which means that we are estimating the mean expression level at each position , across the ensemble of embryos , and the covariance matrix ( fig [ sf12 ] ) that describes fluctuations around this mean . given these features of the data , the construction of the decoding map proceeds with no adjustable parameters",
    "; for details see appendix [ methods+thy ] and figs [ sf0 ] through [ sf4 ] .    in figure [ f2 ]",
    "we show the decoding maps based on the information carried by one , two , three , or all four gap genes . for most locations in the embryo",
    ", decoding based on a single gene provides little information , as for kr in fig [ f2]a and [ sf0 ] ; other examples are in fig [ sf2 ] . in small regions of the embryo ,",
    "decoding can be more precise , but substantial ambiguities remain , where one expression level is equally consistent with two different implied positions . decoding based on two ( figs [ f2]b and [ sf3 ] ) or three ( figs [ f2]c and [ sf4 ] ) genes results in less ambiguity and more precision ; we can follow this sharpening of the distribution by the increasing height of its peak , since narrower distributions have higher peaks to maintain normalization , or by estimating the median width of the distribution @xmath22 ( fig [ sf11]d ) . finally , with all four genes , the distribution @xmath22 is approximately gaussian , with a width @xmath23 , for nearly all points @xmath1 .",
    "it has been conventional to think about a single morphogen gradient coding for position @xcite , or about `` expression domains '' of single gap genes pointing to large regions of the embryo .",
    "figure [ f2 ] shows how multiple expression levels combine , quantitatively , to synthesize an unambiguous code for position that reaches extraordinary precision .",
    "this one percent precision in the encoding of position is also the precision with which subsequent developmental markers , including the pair - rule gene stripes and the cephalic furrow , are generated @xcite .",
    "the fact that the four gap genes carry precise , unambiguous information about position does not mean that the embryo uses this information . to test whether this is the case",
    ", we perturbed the maternal signals bicoid ( _ bcd _ ) , nanos ( _ nos _ ) , and torso - like ( _ tsl _ ) , which strongly affect the output of the gap gene network ( fig [ sf1 ] ) .",
    "if our optimal decoding strategy is used by the embryo , our decoder should generate meaningful position estimates in the mutants .",
    "in particular , we will use the stripes of pair - rule gene expression as a measure of the embryo s readout of positional information , and compare this with our own .",
    "we have analyzed embryos from lines in which we delete _ bcd _ , _ tsl _ , and _ osk _ ( which controls the localization of the _ nos _ signal ) , singly and in pairs .",
    "for each of these six possibilities , we have measured expression levels for all four gap genes simultaneously , in samples that also include wild - type embryos ; results are summarized in fig [ sf1 ] . in every case",
    ", we construct the dictionary for decoding gap gene expression levels from the wild - type embryos , and then apply this dictionary to the mutants measured in the same batch , avoiding any concerns about systematic variations in staining , imaging , etc . across batches .",
    "the results of these analyses are a series of decoding maps , shown in fig [ f3 ] , which should be compared to the map for wild - type embryos in fig [ f2]d .",
    "many features of the decoding maps in fig [ f3 ] are expected from previous , qualitative characterizations of these mutants .",
    "thus , when we delete _ tsl _ the distortions are largely at the two ends of the embryo ( fig [ f3]a ) , since expression of _ tsl _ is confined to the poles ; when we delete _ bcd _ there are major distortions in the anterior portion of the map ( fig [ f3]b ) , where the concentration of bcd protein is highest ; and when we delete _ osk _ ( fig [ f3]c ) , we see major distortions in the posterior , consistent with _",
    "nos _ being a posterior determinant .",
    "more striking are the quantitative predictions that we obtain by decoding .",
    "when we delete _ bcd _ , quantitative distortions of the map extend into the posterior half of the embryo , so that , for example , the expression levels found at @xmath24 generate a distribution @xmath25 in which the most likely value is @xmath26 , and at @xmath27 the most likely estimate is @xmath28 .",
    "thus , even in the posterior half of the embryo , the map is shifted , and the plot of @xmath5 vs @xmath1 ( following the ridge of high probability in the map ) does not have unit slope .",
    "but in the wild - type embryo , the positions @xmath29 and @xmath30 are associated with peaks in the stripes of expression for the pair - rule gene _",
    ", as shown at left in fig [ f3 ] .",
    "if the machinery for interpreting gap gene expression is using the same dictionary that we have constructed here , then we predict that the _ bcd _ deletion mutants should shift these _ eve _ stripes to @xmath31 and @xmath32 , and this is what we see ( fig [ f3]b )",
    ". even more dramatically , expression levels at @xmath33 in the _ bcd _ mutant are decoded as @xmath26 with high probability , and correspondingly there is an _ eve _ expression stripe at this anomalously anterior location .",
    "this is predicted to be not a displacement of the first ( nearest ) _ eve _ stripe , but rather a duplication of the seventh stripe , which is consistent with classical observations on cuticle morphology in these mutants @xcite , and with recent rnai / reporter experiments @xcite .    the quantitative agreement between the decoding maps and the locations of the _ eve _ stripes extends to all six examples of single and double maternal mutants shown in fig [ f3 ] .",
    "notably , there is good agreement both when the shifts are small , as with the deletion of _ tsl _ ( fig [ f3]a ) , and when the shifts are much larger , resulting in the deletion of several stripes , as with the _ bcd osk _ and _ osk tsl _",
    "double mutants ( figs [ f3]d and e ) . in cases where the implied position of a stripe crosses a diffuse band of probability density in the map , as with _ eve _ stripe iii in the _ osk tsl _ mutant ( fig [ f3]e ) , we might expect that there would be expression of _ eve _ but not a sharp stripe , and this is what we see ; similar effects occur in the anterior of the _ bcd tsl _ mutant ( fig [ f3]f )",
    ".    for simplicity fig [ f3 ] shows decoding maps that are averaged over all embryos for each mutant line .",
    "if we focus on decoding maps for individual embryos instead , their variability predicts the embryo - to - embryo variability in pair - rule gene expression .",
    "in particular , for _ bcd tsl _ mutants the positions that map to the wild - type locations of _ eve _ stripes four and five ( @xmath34 and @xmath35 ) vary substantially in the window @xmath36 .",
    "if we look at the _ eve _ expression patterns in individual embryos ( thin lines at bottom of fig [ f3]f ; for detailed analysis see fig [ sf14 ] ) , we see two peaks with variable positions , as predicted . for the _ bcd _ mutant , the average decoding map again has density at @xmath34 and @xmath35 ( fig [ f3]b and fig [ sf13 ] ) , but when we decode the gap gene expression patterns from individual mutant embryos we find that these features vary not only in their position but even in their presence or absence , so that individual embryos are predicted to have a variable number of _ eve _ stripes , and this is what we see .",
    "we have repeated the analysis of fig [ f3 ] , comparing our decoding maps with the expression profiles of the pair - rule genes _ paired _ ( _ prd _ ) and _ runt _ ( _ run _ ) , as summarized in figs [ sf6 ] and [ sf7 ] . in most cases",
    "we see relatively few stripes , which agrees with the theory since there are few intersections between expected stripe positions and the ridge of maximal probability . in the case of the _ tsl",
    "_ mutant , however , the three different pair - rule stripes provide a rather dense collection of markers through the range @xmath37 , as shown in detail in fig [ f3]a . these markers",
    "trace the predicted ridge of maximal probability with very high accuracy .    the results for all the _ eve _ , _ run _ , and _ prd _ stripes in all six mutants are summarized in fig [ summary ] .",
    "for almost all the 57 stripe positions shown , the predicted position agrees with the measured position within the error bar defined by the standard deviation of these positions across embryos in our sample .",
    "more subtly , when we decode the positional signals from multiple embryos , we find variations in the resulting maps , as noted above , and the standard deviation of predicted stripe positions are in most cases close to the observed variations ( vertical and horizontal error bars , respectively ) .",
    "we do note a small number of errors in our predictions . in the _ osk _ mutants we observe a posterior eve stripe where none is predicted ( fig [ f3]c ) , and in _ bcd osk _ mutants , a variable number of prd stripes ( fig [ sf6]d ) .",
    "we predict a run stripe at @xmath38 where none is observed ( fig [ sf7]c ) ; we have no prediction for the very blurred band of run expression at @xmath39 ( fig [ sf7]c ) .",
    "in addition , in the _ bcd , tsl _ mutant we predict a run stripe at @xmath40 where none is observed ( fig [ sf7]f ) .",
    "this last failure occurs at a rare point where the combinations of gap gene expression are outside the range that we have sampled in the wild - type embryos ( fig [ sf5 ] ) , and thus we may be simply extrapolating the probability distributions too far . the errors in the _ osk _ mutants cluster around a point where the predicted maps have a discontinuity , and thus are especially sensitive to our assumption that decoding is done in a purely local fashion .",
    "a small amount of spatial averaging , perhaps to reduce noise introduced in the expression of the pair - rule genes , would result in very different predictions .",
    "the expression levels of genes carry information about signals that matter in the life of the organism .",
    "we have tried to answer several questions : how much information is available @xcite ?",
    "what features of the expression pattern are crucial in conveying this information ?",
    "how can the organism `` read out ''",
    "what is relevant ?    in the developing embryo , one biologically relevant signal is position . in trying to understand how positional information is represented ,",
    "we have focused on gene expression levels at a single moment in time , and on the levels observable by a single cell .",
    "it is possible that the cells could extract more reliable information by averaging expression levels over time , although since protein concentrations accumulate the snapshot that we consider already reflects some degree of temporal averaging , and further averaging may be of limited impact .",
    "similarly , individual cells might be able to extract more information by communicating with their neighbors @xcite , but we know that fluctuations in gap gene expression are correlated over substantial distances @xcite , limiting the benefits of such spatial averaging .",
    "importantly , once we focus on the information available locally in space and time , our experimental tools make it possible to give an essentially complete characterization of the available information and the nature of its encoding , as summarized by the probability distributions @xmath2 .",
    "positional information encoded by the gap gene expression levels is effectively decoded by a broad array of molecular mechanisms , in particular the complex rules for activation of the multiple enhancers that control the expression of pair - rule genes @xcite .",
    "one might think that connecting the patterns of gap expression to the positioning of pair - rule stripes would require us to make a model of these mechanisms .",
    "we have taken an alternative view , in which we assume that the embryo makes optimal use of the available information .",
    "once we make this hypothesis , decoding becomes a well defined mathematical problem , with no free parameters .",
    "the result is a dictionary that translates the expression levels of gap genes into inferred positions , and applying this dictionary to the expression profiles from a single embryo generates a map of inferred position vs actual position . for wild - type embryos ,",
    "once we include all four gap genes this map is precise and nearly unambiguous , indicating positions along the anterior  posterior axis with an accuracy of @xmath0 , sufficient to distinguish each cell from its neighbors @xcite . for mutant embryos , we find maps that are distorted , imprecise , and in some cases ambiguous . using these maps to predict the position of pair - rule expression stripes gives results that are in excellent agreement with experiment , both qualitatively and quantitatively .",
    "the strongly supports the hypothesis of optimality on which our decoding scheme is based .",
    "we draw attention to several aspects of the connection between theory and experiment . first , we decode positions based on graded expression levels of the gap genes @xcite . if we think of the gap genes as forming expression domains that are on or off , then maps are ambiguous even in wild - type embryos ( fig  [ sf11 ] ) , and we certainly could not make meaningful predictions for stripe positions in the mutants .",
    "second , we analyze gene expression in absolute units ; the only normalization is global , which is equivalent to choosing units in which to measure concentration .",
    "contrary to this approach , it often is thought that biological functions must be robust against presumably uncontrollable variations in absolute concentration .",
    "in fact we find that significant components of the difference , for example , between the wild - type embryo and the _ tsl _ mutant are @xmath41 differences in the absolute concentrations of gap gene products ( fig [ sf10 ] ) , and these differences propagate through our decoding to generate distorted maps that correctly predict the shifts in pair - rule stripes : quantitative variations in absolute expression have precise functional consequences .",
    "third , we find that maps in the mutants are sufficiently variable that they predict variability in the _ number _ of pair - rule gene stripes , not just their locations ; such stripe number variations essentially never occur in wild - type embryos .",
    "one might have thought that reproducibility of stripe numbers emerges only as a property of the network of interactions among the different pair - rule genes , and even among neighboring cells .",
    "instead , we see that stripe numbers can be reproducible in wild - type embryos because the positional signal carried by gap gene expression levels is extremely precise , with so little noise that a direct local readout of these signals generates near zero probability of dropping or adding a stripe .",
    "deleting one or two of the maternal inputs to the gap gene network pushes the system into a regime where noise levels are higher , and applying our dictionary to these noisier expression profiles correctly predicts the occurrence of stripe variability .",
    "this is consistent with the idea that the naturally occurring inputs are matched to the signal and noise characteristics of the network @xcite .    in many ways",
    "our maps of implied position as a function of actual position provide a quantitative , probabilistic version of the older idea that one can plot cell fate vs position  a fate map  even in mutants ; see , for example , ref @xcite . in its original form , this notion of a map depends on the fact that what we see in the mutant are rearrangements , deletions , and duplications , but no new pattern elements .",
    "it usually is assumed that this arises from canalization @xcite : although the early stages of pattern formation must generate new and different signals in response to the mutation , subsequent stages of processing force these signals back into a limited set of possibilities set .",
    "what we see here is that even rather early signals , those which are responding immediately to the primary maternal inputs , can be decoded to recapitulate the patterns seen in the wild - type .",
    "there is no need for subsequent steps to drive the pattern back to something built from wild - type elements , since it already is in this form .",
    "the theoretical framework we have developed here makes additional , testable predictions",
    ". simultaneous measurements of pair - rule expression with all of the gap genes would allow us to test directly whether , for example , the predicted variations in stripe number are correct , embryo by embryo , rather than just in aggregate .",
    "more subtly , since there are spatial correlations in the fluctuations of gap gene expression levels @xcite , our decoding predicts that there should be correlations in the small positional errors that occur even in wild - type embryos , and hence the fluctuations in position of the pair - rule stripes must also be correlated .",
    "these correlations should be different in the mutants , in ways that can be predicted quantitatively .",
    "most fundamentally , the molecular mechanisms that lead from gap gene product concentrations to pair - rule expression must , effectively , implement the dictionary that we have developed .",
    "thus , we should be able to predict the functional logic of these developmental enhancers by asking that they provide an optimal decoding of positional information , rather than fitting to data .",
    "perhaps the most important qualitative conclusion from our results is that precision matters .",
    "we are struck by the ability of embryo to generate a body plan that is reproducible on the scale of single cells , corresponding to positional variations @xmath0 of the length of the egg .",
    "as with other examples of extreme precision in biological function , from molecule counting in bacterial chemotaxis to photon counting in human vision , we suspect that this developmental precision is a fundamental observation , and to the extent that precision approaches basic physical limits it can even provide the starting point for a theory of how the system works @xcite .",
    "but precision in the final result of development could arise from many paths .",
    "we have a theoretical framework that suggests how such precision could arise from the very earliest stages in the control of gene expression , if this control itself is very precise , and this has motivated experiments to measure gene expression levels with correspondingly high experimental precision .",
    "what we have done here is to bring theory and experiment together , providing a parameter - free prediction of how quantitative variations in gap gene expression levels should influence the developmental process on the hypothesis that the embryo makes optimal use of the available information , in effect maximizing precision at every step .",
    "genetics then gives us a powerful tool to test these predictions , manipulating maternal inputs and observing pair - rule outputs .",
    "these rich data are in detailed agreement with theory , providing strong support for the precisionist view .",
    "we thank jo dubuis and r samanta for help with the experiments , and m biggin and n patel for sharing antibodies used in the pair - rule gene measurements .",
    "this work was supported , in part , by us national science foundation grants phy1305525 and ccf0939370 ; by national institutes of health grants p50gm071508 , r01gm077599 , and r01gm097275 , by austrian science fund grant fwf p28844 , and by hhmi ( to efw and through an international fellowship to mdp ) .",
    "99 f rieke , d warland , r de ruyter van steveninck , and w bialek , _ spikes : exploring the neural code . _",
    "( mit press , cambridge , 1997 ) .",
    "ng hatsopolous and jp donoghue , the science of neural interface systems .",
    "_ annu rev neurosci _ * 32 , * 249266 ( 2009 ) .",
    "o marre , v botella  soler , kd simmons , t mora , g tkaik , and mj berry ii , high accuracy decoding of dynamical motion from a large retinal population .",
    "_ plos comput biol _ * 11 , * e1004304 ( 2015 ) .",
    "c nsslein  vollhard and ef wieschaus , mutations affecting segment number and polarity in _ drosophila_. _ nature _ * 287 , * 795801 ( 1980 ) .",
    "jp gergen , d coulter , and ef wieschaus , segmental pattern and blastoderm cell identities . in _ gametogenesis and the early embryo _",
    ", jg gall , ed , pp 195220 ( liss , new york , 1986 ) .",
    "pa lawrence , _ the making of a fly : the genetics of animal design _ ( blackwell scientific , oxford , 1992 ) .",
    "j jaeger , the gap gene network .",
    "_ cell mol life sci _ * 68 , * 243274 ( 2011 ) . j briscoe and s small , morphogen rules : design principles of gradient - mediated embryo patterning . _",
    "development _ * 142 , * 39964009 ( 2015 ) .",
    "t gregor , dw tank , ef wieschaus , and w bialek , probing the limits to positional information . _ cell _ * 130 , * 153164 ( 2007 ) .",
    "md petkova , sc little , f liu , and t gregor , maternal origins of developmental reproducibility .",
    "_ curr biol _ * 24 , * 12831288 ( 2014 ) .",
    "g tkaik , cg callan jr , and w bialek , information flow and optimization in transcriptional regulation .",
    "_ proc natl acad sci ( usa ) _ * 105 , * 1226512270 ( 2008 ) .",
    "g tkaik , am walczak , and w bialek , optimizing information flow in small genetic networks .",
    "_ phys rev e _ * 80 , * 031920 ( 2009 ) .",
    "am walczak , g tkaik , and w bialek , optimizing information flow in small genetic networks .",
    "ii : feed  forward interaction . _ phys rev e _ * 81 , * 041905 ( 2010 ) .",
    "g tkaik , am walczak , and w bialek , optimizing information flow in small genetic networks .",
    "iii . a self  interacting gene . _ phys rev e _ * 85 , * 041903 ( 2012 ) . tr sokolowski and g tkaik , optimizing information flow in small genetic networks .",
    "iv . spatial coupling",
    ". _ phys rev e _ * 91 , * 062710 ( 2015 ) .",
    "tr sokolowski , am walczak , w bialek , and g tkaik , extending the dynamic range of transcription factor action by translational regulation",
    ". _ phys rev e _ * 93 , * 022404 ( 2016 ) .",
    "jo dubuis , g tkaik , ef wieschaus , t gregor , and w bialek , positional information , in bits .",
    "_ proc natl acad sci ( usa ) _ * 110 , * 1630116308 ( 2013 ) .",
    "g tkaik , jo dubuis , md petkova , and t gregor , positional information , positional error , and read  out precision in morphogenesis : a mathematical framework .",
    "_ genetics _ * 199 , * 3959 ( 2015 ) . s small , r kraut , t hoey , r warrior , and m levine , transcriptional regulation of a pair - rule stripe in _ drosophila_. _ genes dev _ * 5 , * 827839 ( 1991 ) .",
    "m levine , transcriptional enhancers in animal development and evolution .",
    "_ curr biol _ * 20 , * r754r763 ( 2010 ) .",
    "g tkaik , cg callan jr , and w bialek , information flow and optimization in transcriptional regulation .",
    "_ proc natl acad sci ( usa ) _ * 105 , * 1226512270 ( 2008 ) .",
    "jo dubuis , r samanta , and t gregor , accurate measurements of dynamics and reproducibility in small genetic networks .",
    "_ mol sys biol _ * 9 , * 639 ( 2013 ) .",
    "l wolpert , positional information and the spatial pattern of cellular differentiation .",
    "_ j theor biol _ * 25 , * 147 ( 1969 ) .",
    "w driever and c nsslein - volhard , the bicoid protein determines position in the _ drosophila _ embryo in a concentration - dependent manner .",
    "_ cell _ * 54 , * 95104 ( 1988 ) .",
    "mv staller , cc fowlkes , mdj bragdon , z wunderlich , j estrada , and ah depace , a gene expression atlas of a _",
    "bicoid_depleted _ drosophila _ embryo reveals early canalization of cell fate . _",
    "development _ * 142 , * 587596 ( 2015 ) .",
    "t erdmann , m howard , and pr ten wolde , role of spatial averaging in the precision of gene expression patterns .",
    "_ phys rev lett _ * 103 , * 258101 ( 2009 ) .",
    "d krotov , jo dubuis , t gregor , and w bialek , morphogenesis at criticality ? _ proc natl acad sci ( usa ) _ * 111 , * 36833688 ( 2014 )",
    ". u gaul and h jackle , analysis of maternal effect mutant combinations elucidates regulation and function of the overlap of _ hunchback _ and _ krppel _ gene expression in the _ drosophila _ blastoderm embryo .",
    "_ development _ * 107 , * 651662 ( 1989 ) .",
    "t schpbach and e wieschaus , maternal - effect mutations altering the anterior - posterior pattern of the _ drosophila _ embryo .",
    "_ roux s arch dev biol _ * 195 , * 302317 ( 1986 ) .",
    "ch waddington , canalization of development and the inheritance of acquired characters",
    ". _ nature _ * 150 , * 563565 ( 1942 ) .",
    "ch waddington , canalization of development and genetic assimilation of acquired characters .",
    "_ nature _ * 183 , * 16541655 ( 1959 ) .",
    "w bialek , _ biophysics : searching for principles _ ( princeton university press , princeton nj , 2012 ) .",
    "c wang , lk dickinson , and r lehmann , genetics of nanos localization in _ drosophila_. _ dev dyn _ * 199*(2 ) , 103115 ( 1994 ) .",
    "embryos lacking single maternal patterning systems were obtained from females homozygous for @xmath42 , @xmath43 or @xmath44 . for embryos with positional information only from the osk patterning system ,",
    "we used females homozygous for @xmath42 @xmath44 . for embryos with only information from bcd , we used _",
    "p[_w+ bcd - gfp _ ] ; @xmath45 @xmath43 @xmath44 females .",
    "p[_w+ bcd - gfp _ ] encodes a fully rescuing gfp tagged bcd protein  @xcite . to obtain embryos with input only from the torso patterning system , we used @xmath45 @xmath43 females for gap gene measurements and @xmath42 @xmath46 females for pair - rule embryos .",
    "the segmentation phenotypes of @xmath47and @xmath46 are equivalent  @xcite .",
    "embryos lacking all maternal patterning systems were obtained from triply mutant @xmath42 @xmath46 @xmath44 females .",
    "all stocks were balanced with tm3 , sb .",
    "gap protein levels were measured as described by dubuis et al .",
    "@xcite . to quantify mutant gap protein levels in units of wild - type protein levels , mutants and wild - type embryos were stained together , and imaged alongside on the same microscope slide in a single acquisition cycle .",
    "we draw attention to the discussion of experimental errors in ref  @xcite , because this is especially important for our analysis . as described there , we focus on a narrow time window , 38@xmath2148 min into nuclear cycle 14 .",
    "expression levels were normalized such that the mean expression levels of wild - type embryos ranged between 0 ( assigned to the minimal value across the ap axis of the mean spatial profile , separately for each gap gene ) and 1 ( similarly assigned to the maximal value across the ap axis ) . in detail , gene expression profile @xmath48 of any embryo @xmath15 was calculated as : @xmath49 where @xmath50 and @xmath51 are the lowest and highest raw fluorescence intensity values of the mean wild - type embryo fluorescence profiles ; @xmath52 is the raw fluorescence profile of the particular embryo , which can be either mutant or wild - type .",
    "note that this normalization simply assigns a conventional unit of measurement to gap gene concentrations ; no per - embryo profile `` alignment '' is used to reduce embryo - to - embryo variance . furthermore , mutant embryos were normalized to their wild - type reference for each gap gene , so absolute changes in gap gene concentrations  not only changes in the shape of the gap gene spatial profiles  were retained in all analyses .",
    "a summary of results on the mutant gap gene expression profiles ( mean @xmath53 sd across embryos ) is given in fig  [ sf1 ] .    to image pair - rule proteins , we used guinea pig anti - runt , and rabbit anti - eve ( gift from mark biggin ) polyclonal antibodies , and monoclonal mouse anti - pax3/7(dp312 ) antibody ( gift from nipam patel ) .",
    "secondary antibodies are , respectively , conjugated with alexa-594 ( guinea pig ) , alexa-568 ( rabbit ) , and alexa-647 ( mouse ) from invitrogen , grand island , ny . embryo fixation , antibody staining , imaging and profile extraction were performed as described by dubuis et al .",
    "@xcite .",
    "our goal was to predict features of pair - rule protein concentration profiles , such as the locations of expression peaks , for which comparisons between wild - type and mutant expression levels of pair - rule genes were not essential .",
    "pair - rule protein profiles were measured in mutant embryos in time widows of 45- to 55-min into nuclear cycle 14 ; for consistency with gap gene analyses and convenience we normalized such that the mean expression levels for each gene in each batch of embryos ranged between 0 and 1 ; individual profiles were scaled to minimize @xmath54 , as in refs  @xcite . as an exception ,",
    "we report pair - rule expression levels in triple maternal mutants ( _ bcd nos tsl _ ) in wild - type units , because the pair - rule genes are expressed uniformly and therefore lack positional features .",
    "to construct decoding maps and subsequently predict pair - rule expression stripes , eqs ( [ decode1gene ] ) and ( [ map1 ] ) require us to estimate the distribution of gap gene expression levels at each position , @xmath2 , from data .",
    "direct sampling is unfeasible even for just a single gene .",
    "instead , we approximated the embryo - to - embryo fluctuations in gene expression as gaussian with mean and ( co)variance that vary with position . in previous work we tested this approximation ; while we can see deviations from gaussianity @xcite , the gaussian approximation gives very accurate estimates of the positional information carried by the expression levels of individual genes @xcite , which is most relevant for the decoding that we attempt here .",
    "the gaussian approximation for a single gene corresponds to @xmath55 where @xmath56 measures the similarity of the gene expression level to the mean , @xmath57 , at position @xmath1 , @xmath58 and @xmath59 is the standard deviation in expression levels at point @xmath1 ( e.g. , shown by the shading in fig [ sf1 ] ) . given measurements of gene expression vs position in a large set of embryos , we can compute the mean and variance in the standard way , so that eqs  ( [ s1gauss]-[s2gauss ] ) can be applied directly to the data .",
    "the generalization of the gaussian approximation to the case where coding and decoding are based on a combination of @xmath60 genes simultaneously is given by @xmath61}}e^{- \\chi_k^2\\left ( \\{g_{\\rm i } \\ } , x \\right)/2 } \\label{mapk}\\ ] ] where @xmath62 measures the similarity of the gene expression pattern to the mean _ pattern _ expected at @xmath1 , @xmath63 and @xmath64 is the covariance matrix of fluctuations in the expression of the different genes at point @xmath1 .",
    "figures [ sf12]a - f shows the estimation of @xmath65 covariance matrix of gap gene fluctuations across embryos , @xmath66 ( where @xmath67 denotes averaging over embryos @xmath15 ) . note that the covariance matrix , as well as the mean profiles themselves , are a function of position along the ap axis .",
    "comparing the covariance matrix estimates across replicates of wild - type datasets , fig  [ sf12]g shows that our data are sufficient for us to have control over estimation errors , so that eqs  ( [ mapk]-[chisq ] ) can likewise be applied directly to the data .",
    "figure  [ sf0 ] shows a step - by - step procedure for constructing a  decoding dictionary \" based on a single gap gene , kr , from measured data , and a  decoding map \" for a single wild - type embryo ; the decoding map in fig  [ f2]a is an average over 38 such individual decoding maps .",
    "similarly , top panels of fig [ sf2]a - d show the profiles of all four individual gap genes in the wild - type embryos , while the bottom panels show the corresponding decoding maps . as with the case of krppel in fig [ sf0 ] ,",
    "all of these maps show substantial ambiguities , where the signal at one point in the embryo is consistent with a wide range of possible positions .",
    "ambiguity arises whenever a vertical slice through these density plots encounters multiple peaks , but in the case of decoding based on single genes these ambiguities are so common that they result in either vast swaths of grey or in intricate folded patterns .",
    "in particular locations  specifically , at the flanks of mean expression profiles where the slope of the profile is high  the distributions @xmath68 become highly concentrated , indicating that the quantitative expression levels of individual genes provide the ingredients for precise inferences of position , as suggested in refs  @xcite .",
    "figure  [ sf2 ] shows that combining two genes always reduces ambiguity relative to the single gene case , but does not eliminate it entirely , and a similar trend is observed in fig [ sf3 ] with triplets of gap genes .",
    "the four - gene case shown in fig  [ f2]c sharpens the decoding maps further ( cf . the scale of distributions @xmath68 ) , achieving a low positional error of @xmath69 across the majority of locations along the ap axis .",
    "we can quantify this sharpening by computing the standard deviation of the distribution @xmath68 , and then finding the median over @xmath1 ; a summary of these results is given in fig [ sf11]d .",
    "figure  [ sf11 ] further shows that the traditional interpretation of gap genes as generating binary domains of expression separated by sharp boundaries significantly blurs the decoding map , irrespective of whether the gap gene thresholds are selected simply at the midpoint of the expression range ( at @xmath70 ) or are adjusted separately for each gap gene to optimize the decoding map .",
    "this shows that quantitative , graded levels of gap gene expression are essential for the precise specification of position .",
    "it is worth emphasizing that the notion of a threshold that determines gene expression ( or cell fate ) boundaries , which is well defined for a single signal being thresholded , is more ambiguous in the case of multiple concurrent signals that drive patterning , as is the case here with gap genes .",
    "the idea of putting independent , and possibly different , thresholds on each of the inputs separately may appear as a natural extension of a single - gene case , but it is important to realize that this idea already entails a drastic ( and untested ) independence assumption",
    ". it would be equally possible that the relevant patterning thresholds act on some unknown , even nonlinear , combination of the four gap gene signals .",
    "in particular , in biophysical models of enhancer function where the gene expression is controlled by the concentrations of multiple inputs ( and where the threshold is determined by the sigmoid activation function of the enhancer ) , the interpretation of thresholds applying to nonlinear combinations of inputs is more realistic than the interpretation of different thresholds independently applying to each of the inputs .",
    "furthermore , the picture of independent thresholds acting on individual gap genes leaves completely unanswered the question of how binarized gap gene profiles can be read out in a biophysically realistic fashion to combinatorially drive the expression of their target genes .",
    "we analyzed patterns of gap gene expression in six mutant lines of flies , deficient in one or two of the three maternal inputs to the gap gene network , as summarized in fig  [ sf1 ] . to construct decoding maps for the mutants , as in fig  [ f3 ] , we first computed posterior distributions @xmath71 as prescribed by eq  ( [ decode1gene ] ) from wild - type embryo data , and evaluated these distributions at gap gene expression levels measured in mutant embryos .",
    "but the wild - type expression levels fill only a very small region of the full four dimensional space of possibilities ; if the expression levels in mutant embryos fell largely outside this region , then we would be extrapolating too far from the wild - type measurements and could not make reliable inferences . to test whether this could be the case",
    ", we computed @xmath54 [ eq ( [ chisq ] ) ] between the observed combinations of expression levels and the mean expression levels expected at each position in the wild - type , and compared that to the @xmath54 values for mutant embryos .",
    "figure  [ sf5 ] shows the cumulative distribution of @xmath54 across the entire population of wild - type embryos , from all six experiments .",
    "normalized per gene , the mean of @xmath54 is one , but the distribution has a tail extending to @xmath72 this value . to construct a comparable distribution for the mutants",
    ", we first note that the gene expression values at one point @xmath1 in the embryo can be decoded to a position @xmath73 that is very far from @xmath1 , as shown by fig  [ f3 ] and explained in the corresponding discussion in the main text .",
    "consequently , in the mutants we looked for the point @xmath73 in the wild - type that achieved the minimum of @xmath74 over all possible @xmath73 ( which is the location that the mutant gap gene profiles decode to ) and then look at the cumulative distribution of @xmath54 at these decoded locations .",
    "as expected , @xmath54 values in the mutant are larger than in the wild - type , but there is a surprising degree of overlap between the two distributions : the largest value of @xmath54 that we observe in the wild - type embryos is larger than @xmath75 of the values that we see in the mutants .",
    "although mutant background induces huge changes in the inputs of the gap gene network and in the gap gene profiles themselves , the gap gene network responds in a way that is not so far outside the distribution of possible responses under natural conditions .",
    "this fact is what makes decoding positional information in the mutants feasible .",
    "decoding maps make parameter  free predictions for the locations of positional markers in mutant embryos .",
    "to test these predictions , we compare to the locations of expression peaks for the pair - rule genes.if a cell at position @xmath1 in the mutant embryo has expression levels for the gap genes that lead to a high probability of inferring a position @xmath76 , where @xmath77 is the position of a pair - rule stripe in the wild - type , then we expect that there will be a peak in pair - rule gene expression at the point @xmath1 in the mutant .",
    "mathematically , this process ( shown graphically in fig [ f3 ] ) proceeds as follows : we construct @xmath78 and look at the line @xmath76 ; this gives us a ( non  normalized ) density @xmath79 , and there should be pair - rule stripes at the local maxima of this density . because stripes in the wild - type are driven by different enhancers and are thus not identical , it is important that our calculation should predict the occurrence of a particular identified stripe @xmath80 at @xmath1 .    the construction of the density @xmath81 is shown in fig  [ sf15 ] for each stripe of eve , prd , and run , and for each individual wild - type embryo .",
    "there is an excellent correspondence between the average pair - rule gene expression profile and the set of individual embryo densities for all stripes ; the sole discrepancy appears to be a small ambiguity in the decoding map that hints at two weak `` echoes '' of pair - rule stripes 1 and 2 in the far anterior ( for @xmath82 ) , which we did not detect in the data .",
    "these may be missing because of influences from other gap genes that are active in the far anterior .",
    "for ease of visualization , we often look just at the _ average _ decoding map , as in fig  [ f3 ] as well as figs  [ sf6 ] and [ sf7 ] , below .",
    "this average , @xmath83 , which can be easily plotted as a single map , and then decoded analogously to the procedure outlined above : we looked for the position @xmath1 where the decoding map peaks if the inferred position @xmath5 were equal to a known pair - rule stripe location in the wild - type .",
    "decoding the `` mean pair - rule stripe position '' in this manner does not differ from decoding single embryos to predict the pair - rule stripe positions individually , and then taking the average prediction , but now we can also predict fluctuations in stripe locations , a fact we used in making fig  [ f4 ] .    decoding in individual embryos",
    "permits us to compare not only the predicted mean stripe locations to the measurements , but also to compare the variability in stripe position , shape , and in the total number of observed stripes .",
    "figures  [ sf14 ] and [ sf13 ] show examples of individual eve profiles where some of the eve stripes 3 , 4 , 5 were either missing or had a broad , poorly localized `` diffuse '' profile in mutant backgrounds .",
    "we predicted these phenomena for exactly the same mutant backgrounds and the same stripes from individual embryo decoding maps .    a detailed description of individual embryo pair - rule stripe predictions in mutant backgrounds , analogous to fig  [ sf15 ] for the wild - type , is shown in fig  [ sf16eve ] . in these panels ,",
    "we denote separately diffuse stripes , as well as a small number of observed - but - not - predicted and predicted - but - unobserved stripes . all non - diffuse predictions across the three pair - rule genes and all mutants",
    "are shown in the summary fig  [ f4 ] in the main text .",
    "we invested substantial experimental effort to measure gap gene expression levels in mutant embryos side - by - side with the wild - type controls , so that absolute concentrations can contribute to the decoding . but",
    "do they ? in fig  [ sf10 ] we show the effect of the absolute level on the decoding map , and consequently on the pair - rule stripe prediction performance . in the _ bcd _ mutant background ( fig  [ sf10]a , b )",
    ", gap gene expression levels are strongly perturbed in shape but also suppressed in magnitude by @xmath84 .",
    "decoding these profiles gives predictions of pair - rule stripes that agree very closely with data ( fig  [ sf10]c , black symbols ) .",
    "in contrast , when mutant profiles are individually normalized so that they span the range of expressions between 0 and 1in essence , keeping the profile shape but undoing the magnitude effect  leads to much worse predictions of pair - rule stripes ( fig  [ sf10]c , red ) .    in the _ tsl _ mutant background ,",
    "the effect of absolute concentrations is more subtle . in these mutants , kr and kni",
    "are overexpressed by @xmath85 relative to the wild - type , which leads to a slight deformation in the decoding map in the posterior ( @xmath86 ) , and this effect disappears if we normalize to keep only relative expression levels . while the effect is smaller than in the _ bcd _ background , pair - rule stripes at @xmath87",
    "are consistently predicted better using absolute gap gene concentrations . in sum , both for large scale and precision effects on our pair - rule predictions , being able to measure gap gene concentrations relative to the wild - type is crucial .",
    "this suggests as well that the embryo itself responds to precisely determined , absolute concentrations of signaling molecules .",
    "when we delete all three of the maternal inputs , positional information is abolished ( fig [ flatline ] ) .",
    "there is a low uniform expression of eve in mutant embryos , consistent with the predictions from our decoding map ."
  ],
  "abstract_text": [
    "<S> gene expression levels carry information about signals that have functional significance for the organism . using the gap gene network in the fruit fly embryo as an example , </S>",
    "<S> we show how this information can be decoded , building a dictionary that translates expression levels into a map of implied positions . </S>",
    "<S> the optimal decoder makes use of graded variations in absolute expression level , resulting in positional estimates that are precise to @xmath0 of the embryo s length . </S>",
    "<S> we test this optimal decoder by analyzing gap gene expression in embryos lacking some of the primary maternal inputs to the network . </S>",
    "<S> the resulting maps are distorted , and these distortions predict , with no free parameters , the positions of expression stripes for the pair - rule genes in the mutant embryos . </S>"
  ]
}