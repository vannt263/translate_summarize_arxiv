{
  "article_text": [
    "photonic states are suitable to carrying quantum information for their flexibility and robustness against decoherence effects .",
    "the flying qubits in various quantum computing schemes are encoded in photonic states @xcite , and many tasks in quantum cryptography and quantum communications are performed with the aid of photonic states as well @xcite . in most of protocols , an optical system should process the input of multi - photon state , which is often a tensor product of the signal plus the ancilla . in the scheme of unknown quantum state discrimination @xcite , for example , the inputs should be prepared as the tensor product of the program and the data state , @xmath0 , where the qubit @xmath1 ( @xmath2 for the program and @xmath3 for the data ) could be an unknown linear combination of the polarization modes @xmath4 and @xmath5 ( @xmath6 represents horizontal and @xmath7 vertical polarization ) of a single photon .",
    "when a multi - photon input state is processed by a linear optical device together with the post - selection through measurement on part of the output , there will be an upperbound for the success probability to obtain the desired target state @xcite . non - deterministic operations are inevitable in such systems , so it demands more resources to realize a processing task definitely",
    ".    the situation will be different when we deal with single photon states .",
    "quantum information can be encoded in spatial degree of freedom ( different spatial paths ) and internal degree of freedom ( polarization , etc . ) of a single photon .",
    "a significant advantage in using single photon states of multiple spatial modes is that arbitrary unitary operation on such states can be deterministically realized with a linear optical device @xcite .",
    "this result can be generalized to realize arbitrary positive - operator - valued - measurement ( povm ) on multiple path - mode single photon states @xcite .",
    "for instance , it will be possible to perform the above - mentioned unknown qubits discrimination , if one could realize a map @xmath8 to a corresponding multi - mode single photon inheriting the coefficients @xmath9 of the input multi - photon state ( @xmath10 , @xmath11 , @xmath12 are the spatial modes here ) .",
    "in particular , the unambiguous discrimination of any pair of multi - mode single photon states and of even more such states can be simply realized by linear optics @xcite .    in this paper",
    "we discuss the methods to realize such transformations and some of their useful applications .",
    "it has been proposed that the transformation in eq .",
    "( [ 1 ] ) could be realized by teleportation @xcite .",
    "however , the method can be simplified much further if we improve on the necessary circuits .",
    "here we also present a purely circuit - based approach without teleportation to realize the transformations in the form @xmath13 in which the third photon inheriting the coefficients @xmath9 of the input multi - photon state will be in tensor product with two other photons of the state @xmath14 .",
    "this kind of transformations can be realized without ancilla and with a quantity of circuit resources scaling linearly to the photon number in input states .",
    "an important application of these transformations is the construction of quantum networks or quantum logic gates . as there is no direct interaction between photonic states , the nonlinear media of strong intensity",
    "seem necessary to realize photonic logic gates . however , the best cross - kerr nonlinearity created by electromagnetically induced transparency ( eit ) techniques @xcite thus far is still in the range of weak nonlinearity .",
    "the development of photonic logic gates is therefore mainly along the line of the knill - laflmme - milburn ( klm ) protocol @xcite , which applies linear optical circuit , entangled ancilla state and photon number resolving detection to realize a two - qibit gate probabilistically .",
    "the klm protocol and its improvements within linear optics are all probabilistic , if the realistic resources are available @xcite . since the input states for many key logic gates or quantum networks can be simply encoded as the initial states in eq .",
    "( [ 1 ] ) and ( [ 20 ] ) , it is reasonable to first convert them to the corresponding single photon states and then use a linear optical circuit to deterministically implement the unitary operations for the gates",
    ". the remaining work will be converting the processed states in multiple path modes back to polarization space . the transformations to single photon states and their inverse processes are realizable using weak nonlinearity , linear optics , as well as photon number resolving detection which could be performed by various methods .",
    "this idea of realizing a quantum network is different from the conventional method of decomposing it into the product of two - qubit and one - qubit gates @xcite .",
    "feasible though the realization of all kinds of deterministic two - qubit , triple - qubit gates , etc , in the approach is , it is impractical to implement a quantum network involving large number of input qubits this way , as the number of the spatial modes carried by the transformed single photon is exponentially large ( @xmath15 for @xmath16 input qubits ) . for a special type of multi - qubit gates ,",
    "however , the necessary resources could be much fewer than those required by the conventional decomposition method into two - qubit gates , if we modify an element gate used for the previously mentioned transformations to single photon states a bit .",
    "this type of multi - qubit gates include toffoli gate @xcite , a gate key to many quantum information processing tasks .",
    "we will discuss the building of these gates in detail .",
    "the rest of the paper is organized as follows . in sec .",
    "[ sec2 ] , we discuss the designs of the gates which are related to the teleportation of multi - photon states to the corresponding single photon states . the improvement on the teleportation strategy in @xcite is given in [ tele ] .",
    "the purely circuit - base approach to realizing the map in eq .",
    "( [ 20 ] ) is presented in sec .",
    "[ sec3 ] , where the steps to transform input two - photon and triple - photon states are respectively illustrated in details .",
    "the application of the transformation methods in constructing quantum networks is discussed in sec .",
    "[ sec4 ] ; in this section we discuss the realization of general two - qubit gate , general multi - qubit gate and especially multi - control gates including toffoli gate , respectively .",
    "finally a few remarks conclude the paper in the last section .",
    "firstly , we discuss the approach to transform multi - photon states to the corresponding single photon states through teleportation . the designs of the necessary gates for the purpose are given in detail as follows .",
    "the target is to map the state of many photons to a genuine single photon state as in eq .",
    "( [ 1 ] ) .      in ref .",
    "@xcite some of us propose an optical realization of unknown quantum state discrimination scheme in @xcite .",
    "a crucial element there is a parity gate that sends the bi - photon components of different parity to the different paths .",
    "however , that gate actually selects out either even parity component ( the linear combinations of @xmath17 and @xmath18 ) or odd parity component ( the linear combinations of @xmath19 and @xmath20 ) through homodyne detection .",
    "we here present a correct design for such deterministic parity gate . on the other hand",
    ", parity gate is an important tool in quantum information processing .",
    "the wide usages of the gate with abstract quantum systems are discussed in @xcite , and various optical realizations can be found in , for example , @xcite .",
    "we enrich the methods to realize parity gate with a special feature that the different parity components will be obtained simultaneously on different paths .     to interact with the indicated photonic modes .",
    "each coupling gives rise to a phase shift @xmath21 .",
    "two phase shifters @xmath22 are applied to two qubus beams , respectively .",
    "the setup of the qnd module is shown in dash - dotted line , where one of the beams @xmath23 is coupled to the first qubus beam after a 50:50 bs between two phase shifter @xmath22 and the qnd module .",
    "one output beam in the qnd module is measured by a number - non - resolving detector .",
    "the phase shift @xmath24 on @xmath25 and the switch of the path mode 2 and 3 are conditional on the classically feed - forwarded measurement results.,width=226 ]    the gate deals with an input state @xmath26 of two photons running on track 1 and 2 .",
    "we apply a 50:50 beam splitter ( bs ) to divide the second photon into two spatial modes 2 and 3 : @xmath27 two qubus or communication beams @xmath28 are then introduced , and are coupled to the corresponding photonic modes through the cross - phase modulation ( xpm ) processes described by the hamiltonian @xmath29 , where @xmath30 is the nonlinear intensity and @xmath31 ( @xmath32 ) the number operator of the coupling modes . the interaction pattern in fig .",
    "[ parity - p ] is summarized in tab .",
    "[ tb1 ] .    .@xmath33 and",
    "@xmath34 represent the coupling to the first and the second qubus beam , respectively . the xpm pattern in fig .",
    "1 is read as the first beam being coupled to @xmath35 of the first photon and @xmath36 of the second photon , while the second beam to @xmath25 of the first photon and @xmath37 of the second . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     the phase shifters of @xmath22 follow up to change the phases of the coherent - state components to the following @xmath38 finally , one more 50:50 bs converts the coherent - state components to @xmath39 where @xmath40 .",
    "then , we could use the qnd module in fig .",
    "[ parity - p ] to perform the projection @xmath41 for achieving the desired output state @xmath42 deterministically .    as we will discuss in what follows , this c - path gate works as a building block for constructing various logic gates .",
    "next , we will apply it in a teleportation scheme to transform a multi - photon state to the corresponding single photon state .",
    "now , we present an improved teleportation scheme on that in @xcite , which transforms a multi - photon state to the corresponding single photon state .",
    "we illustrate the procedure first with the simplest example of a two - photon input state , @xmath43 , where @xmath44 , and the coefficients @xmath9 and @xmath45 could be unknown . using the same ancilla resources , a single photon state @xmath46 and a photon pair in bell state @xmath47 , as in @xcite , we process them with a first c - path gate as follows : @xmath48 where the @xmath49 and @xmath50 of the control single photon control the first photon in the bell pair to different paths 3 and 4 .",
    "the state @xmath51 can be rewritten as @xmath52 a product of two bell states @xmath53 . in the first effective bell state",
    "we adopt the notation in @xcite to define the switch state @xmath54 , which sends the modes on path 1 to path 3 , and @xmath55 , which sends the modes on path 1 to path 4 at the same time .",
    "the effect of the c - path gate is to create an effective bell state @xmath56 .",
    "suppose two single photons in the state @xmath1 are placed on track a and b , respectively . then we will have the following total state @xcite : @xmath57 performing the bell - state measurements on the modes @xmath58 and @xmath59 and classically - feedforwarding the results for the post operations , we will finally obtain the state @xmath60 which is a single photon qudit inheriting the coefficients of the input bi - photon state @xmath43 .",
    "to teleport a triple - photon state @xmath0 to the corresponding single photon qudit , we will use an extra ancilla photon in the state @xmath61 .",
    "we let it control the paths of the first photon of the bell pair , which runs on path 3 and 4 after the first c - path gate .",
    "this control should be performed on path 3 and 4 together , so we modify the standard c - path gate to a c - path-2 gate shown in fig .",
    "[ c - path-2 ] . in this gate",
    "a 50:50 bs splits the modes on path 3 to path 5 and 6 , while it devides the modes on path 4 to path 7 and 8 ( the global coefficient is neglected ) : @xmath62 the interaction pattern for the qubus beams with the above state is given in tab .",
    "[ tb3 ] .",
    "[ c]|c|c|c|c|c| & @xmath63 & @xmath64 & @xmath65 & @xmath66 + @xmath67 & & @xmath34 & & @xmath34 + @xmath68 & @xmath33 & & @xmath33 & +    through the similar post - selection to that in a standard c - path gate , the ancilla photon on track d will control the paths of the first photon of the bell pair to path 5 , 6 , 7 and 8 with its polarization mode @xmath69 .",
    "this process is equivalent to adding another effective bell state as in the first c - path gate .",
    "after the corresponding operations according to the bell state measurements , any povm can be performed by linear optical circuits on the single photon running on path 5 , 6 , 7 and 8 , which inherits the structure of the input @xmath0 @xcite .",
    "the c - path gate teleportation method thus greatly simplfies the optical realization of unknown qubit discrimination in @xcite .    .",
    "here the polarizations of photon @xmath70 simultaneously control the path 3 and path 4 mode of the first photon of an entangled pair .",
    "then the modes on path 3 and 4 will be converted to the modes on path 5 , 6 , 7 and 8 .",
    ", width=264 ]",
    "in teleporting an n - photon state to the corresponding single photon state , @xmath71 ancilla photons are necessary as in the above - discussed scheme for unknown state discrimination .",
    "these ancilla resources can be saved by the approach discussed in this section . here",
    "we illustrate the method with the examples of transforming two - photon and triple - photon states to the corresponding single photon states , which can be processed by linear optics .      the schematic setup for two - photon transformation is shown in fig .",
    "[ two - photon ] . after a c - path gate , a two - photon input state @xmath72 in the form of that in eq .",
    "( [ in ] ) is transformed to @xmath73 with the first photon expressed in the basis @xmath74",
    ". then we process it with the circuit part called disentangler shown in dotted line in fig .",
    "[ two - photon ] .",
    "disentangler includes a balanced mach - zehnder ( mz ) interferometer formed with two polarizing beam splitters ( pbs@xmath75 ) , which transmit @xmath76 and reflect @xmath77 , and two qnd modules in each arms , respectively .",
    "if the component @xmath78 is detected by a qnd module , the following state , @xmath79 will be projected out .",
    "on the other hand , if @xmath80 is detected , a phase shift @xmath24 will be performed on path @xmath81 of the second photon to get the same final state .",
    "now , the state of the second photon inherits the coefficients of the initial two - photon state @xmath82 .",
    "since we apply the detections with qnd modules , the other photon is also preserved as @xmath83 in eq .",
    "( [ 2-trans ] ) .    ) to that in eq .",
    "( [ 2-trans ] ) . after a c - path gate ,",
    "the modes @xmath84 of the first photon are detected by the qnd modules .",
    "the measurement results are forwarded to transform the output to the form in eq .",
    "( [ 2-trans ] ) by an operation @xmath85 on the first photon and a phase shift @xmath24 on the second .",
    "the part in dashed line is called disentangler because it transforms arbitary input two - photon state to a tensor product.,width=264 ]      this method can be generalized to multi - photon state as shown in fig .",
    "[ multi - photon ] . for simplicity",
    ", we only give the detail of the triple - photon transformation .",
    "the input triple - photon state is given as @xmath86 where @xmath87 @xmath88 , and @xmath89 .",
    "firstly , similar to the case of two - photon state , we implement a c - path gate and a disentangler to the second and third photon , to project out the following state,@xmath90   .\\ ] ] second , we use a c - path-2 gate in fig .",
    "[ multi - photon ] for further processing .",
    "the xpm pattern in this c - path-2 gate is that the first qubus beam is coupled to @xmath91 of the first photon and all modes of the third photon on path @xmath92 after bs , while the second beam to @xmath93 of the first photon and those on path @xmath94 from the third photon . in the c - path-2 gate",
    ", one 50:50 bs implements the maps @xmath95 and @xmath96 of the two spatial modes of the third photon .",
    "then two qubus beams @xmath97 are used to interact with the corresponding photonic modes as indicated in fig .",
    "[ multi - photon ] .",
    "the phase shifters of @xmath22 continue to shift the phases of the coherent - state components to those in the following : @xmath98   .\\end{aligned}\\ ] ] next , a 50:50 bs transforms two qubus beams , and a qnd module performs @xmath41 on one the beams after that .",
    "the following state , @xmath99,\\ ] ] will be thus obtained with a conditioned switch and a phase shift @xmath24 on the modes @xmath100 and @xmath81 together accroding to the measured @xmath16 by the qnd module . like in the process in two - photon transformation",
    ", we will then use disentangler on the first and third photon to realize the following state @xmath101 now , the third photon is in the desired single photon state carrying multiple spatial modes , and it inherits the information from the polarizations of two other photons .",
    "single photon qubits to that in eq .",
    "( [ m - out ] ) . the first c - path-2 gate from the left",
    "is illustrated in dotted line , and the coupling pattern of the qubus beams in all other c - path-2 gates is similar .",
    "the disentanglers are similar to that in fig .",
    "[ two - photon ] .",
    "the polarizations of the @xmath102-th photon controls the paths of the @xmath16-th photon through a c - path gate , and the polarizations of the @xmath103-th photon continues to control the @xmath16-th photon to doubled number of paths through a c - path-2 gate , and so forth to the control by the first photon . through such iterative operations ,",
    "the output state of the @xmath16-th photon will inherit the coefficients of the input multi - photon state .",
    "the total number of c - path gates ( including c - path-2 ) , as well as that of the disentanglers , after @xmath104 times of control is @xmath104.,width=294 ]    it is straightforward to generalize to the transformation for a general multi - photon state @xmath105 in which the n - th photon is the superposition of @xmath106 pieces .",
    "the process starts with a triple - photon transformation applied to the ( n-2)-th , the ( n-1)-th and the n - th photons , and repeatedly apply the c - path-2 gates to the other photons and the n - th photon , with all spatial modes of the n - th photon split by 50:50 bs in each c - path-2 gates .",
    "the target state , @xmath107 will be obtained , with the path modes of the n - th photon inheriting the coefficients from other photons modes .    in this transformation for @xmath16-photon state ,",
    "@xmath104 c - path gates ( one standard c - path gate , @xmath108 c - path-2 gates ) and @xmath104 disentangles are used , so the circuit resources are linearly dependent on the photon number of the input state .",
    "another significant advantage of the transformation is that no ancilla is necessary .",
    "such transformation can be applied to realize unambiguous discrimination of multi - photon states including the unknown state discrimination schemes in @xcite .",
    "one important application of the transformation methods discussed in the previous sections is the realization of quantum logic gates . in what follows",
    ", we will illustrate how to construct various logic gates that are key to quantum computation .      in the realization of logic gates",
    ", we should apply another building block  merging gate .",
    "the qubits we use are encoded as the superposition of @xmath4 and @xmath5 , and they will be in extra spatial modes after a c - path gate .",
    "a merging gate can be be viewed as performing the inverse process of a c - path gate to merge a single photon in multiple patial modes back to only one spatial mode without changing anything else . specifically , the schematic setup to deterministically realize the gate in fig . [ merge ] implements the transformation @xmath109 i.e. , the merging of the second photon modes on path 2 and 3 to path 4",
    ". here an extra single photon in the state @xmath110 should be used .    ) to the standard form .",
    "the effect of the gate is realizing the merge of the single photon modes on path 2 and 3 to the same path .",
    "the gate also outputs a single photon in the state @xmath84 after the qnd detections , and this photon can be used in the next merging gate.,width=302 ]    suppose the initial state is @xmath111 .",
    "it is first processed by the part called entangler in fig [ merge ] .",
    "there two input photons will interact with two qubus beams @xmath112 as shown in the dashed line of fig .",
    "[ merge ] ) .",
    "the interaction pattern is summarized in tab .",
    "[ tb4 ] .",
    "[ c]|c|c|c|c|c| & @xmath113 & @xmath114 & @xmath115 & @xmath116 + @xmath117 & & @xmath33 & & @xmath33 + @xmath118 & @xmath34 & & @xmath34 & +    the total state , @xmath119 , will be transformed to @xmath120 by the entangler . a bit flip @xmath121 and a phase shifter @xmath24 conditioned on the number - resolving detection results by a qnd module",
    "will yield the following state @xmath122 this entangled state of three photons can be rewritten as @xmath123 after the interference of the single photon modes on path 2 and 3 @xmath124 through a 50:50 bs , two pbs@xmath75 send the single photon to four different paths numbered from @xmath125 to @xmath126 , giving the state @xmath127 at this step , we can use a qnd module on each path to project out the target state . in these qnd modules",
    "the photon number non - resolving detectors can be simple apds which output the same signal without telling the difference of the input states . finally , the classically feed - forwarded qnd detection results control the operation @xmath128 on path 1 and 4 to tailor the phases of the projected - out double photon state .",
    "the detected photon ( in the state @xmath84 ) on one of the paths can be used again in the next merging gate .      with a pair of c - path and merging gate ,",
    "it is very convenient to realize the two - qubit gate operations in the form @xmath129 .",
    "if @xmath130 and @xmath131 , for instance , this gate will be a cnot gate . here",
    "we directly apply @xmath132 and @xmath133 on path 1 and 2 for the state @xmath134 in eq .",
    "( [ c - path ] ) , and then the merging of the modes on path 1 and 2 will finish the transformation .",
    "the main point in this subsection is the realization for a general two - qubit gate @xmath135 . as has been proved early , three cnot gates ( together with the proper one - qubit operations )",
    "should be necessary in constructing a general two - qubit gate @xcite .",
    "it looks that three pairs of c - path and merging involving six number - resolving detections should be used to realize such two - qubit gate .",
    "however , fewer resources would be necessary if we work with the design in fig .",
    "[ two - qubit - gate ] .     and an disentangler in fig .",
    "[ two - photon ] , the input two - photon states are transformed to the products single photon states , with the second photon on path @xmath136 and @xmath137 inheriting the structures of the input bi - photon states . then the second photon becomes a qudit in four spatial modes under two pbss .",
    "two @xmath138 operations on path 2 and 4 make the same polarization for all spatial modes .",
    "an lomi in the dashed line follows up to implement the gate operation @xmath139 on the single photon qudit .",
    "the inverse inverse transformation for the second photon back to polarization space relies on entangler-2 in the dash - dotted line , where the qubus beams interact with the photonic modes in the way slightly different from that in entangler of fig .",
    "[ merge ] .",
    "finally , a merging gate merges the spatial modes of the second photon , finishing a general two - qubit operation @xmath139.,width=325 ]    in fig .",
    "[ two - qubit - gate ] , we first use a two - photon transformation to convert an initial state @xmath140 in eq .",
    "( [ in ] ) to the form in eq .",
    "( [ 2-trans ] ) .",
    "then , two pbs on the path @xmath100 and @xmath81 followed by two @xmath121 operations on path 2 and 4 achieve the state @xmath141 where @xmath142 denote the spatial modes for the single photon .",
    "now the second photon is a qudit with 4 spatial modes .",
    "any operation @xmath135 can be implemented on this single photon qudit by a linear optical multi - port interferometer ( lomi ) in the dashed line of fig .",
    "[ two - qubit - gate ] @xcite .",
    "the lomi transforms the qudit to @xmath143    next , we should transform the single photon qudit back to polarization space . by the inverse operations of @xmath121 and two pbs",
    ", we have the following state @xmath144 the conversion follows with a setup called entangler-2 in the dash - dotted line of fig .",
    "[ two - qubit - gate ] .",
    "entangler-2 is a little bit different from an entangler in fig .",
    "[ merge ] , with the first ( second ) qubus beam coupled to @xmath145 and @xmath146 ( @xmath147 and @xmath148 ) . through such xpm processes in the entangler-2 , the following state can be obtained : @xmath149 then the photon number resolving detection by a qnd module controls the indicated operations on the photonic modes to achieve the state @xmath150 it is then easy to obtain the final state , @xmath151 by merging the modes on path @xmath100 and @xmath81 with a merging gate , realizing a general two - qubit operation @xmath135 .    in this proposal , we first transform the two - photon state to a single photon qudit inheriting the coefficients of it , and then perform the general operation @xmath135 on this single photon qudit by a linear optical circuit .",
    "finally the tensor product of the qudit and the other single photon qubit will be transformed back to the target two - photon state by a modified entangler and a merging gate .",
    "compared with all other approaches thus far , this design uses less resources to realize a general two - qubit gate in deterministic way .      in what follows , we will generalize the design of two - qubit gate to multi - qubit gate @xmath152 .",
    "firstly , we use a multi - photon transformation to obtain a corresponding single photon qudit for the n - th photon as in eq .",
    "( [ m - out ] ) , and then perform the operation @xmath153 on this single photon qudit by an lomi with @xmath154 input and output ports . because the last single photon and the other @xmath104 photons will be in a tensor product state from eq .",
    "( [ m - out ] ) , the remaining work is to entangle them to the proper output state of @xmath153 .",
    "however , the last single photon has @xmath106 different spatial modes , so we should modify the entangler in fig . [",
    "merge ] to suit the case .    in triple - qubit gates , for example",
    ", the four spatial modes after the transformation for the third photon to different spatial modes will be sent to a modified entangler called entangler-3 ( fig .",
    "[ entangler-3 ] ) , where they are divided into two parts ( @xmath155 ) and ( @xmath156 ) , having each part treated as one spatial mode like in an entangler-2 . in this gate , the first ( second ) qubus beam is coupled to both @xmath145 and @xmath157 ( @xmath147 and @xmath158 ) .",
    "after that , the triple - photon state in eq .",
    "( [ triple ] ) will be first transformed to @xmath159 together with two qubus beams , and then to @xmath160 by post - selection with photon number resolving detection as in parity , c - path and merging gate .",
    "next , the spatial modes of the third photon will be regrouped as in the lower part of fig .",
    "[ entangler-3]it is to divide the four spatial modes into two parts ( @xmath161 ) and ( @xmath162 ) , and send the above state to the second entangler-3 . the following process in the second entangler-3 , @xmath163 can be realized too . for a general multi - photon state",
    ", we will just apply this procedure to the spatial modes of the @xmath16-th photon iteratively . the multi - photon state in eq .",
    "( [ m - out ] ) will be transformed correspondingly to @xmath164 an entangled state of @xmath16 photons .    ) to eq .",
    "( [ e3 ] ) .",
    "the spatial modes of the third photon on path @xmath136 , @xmath137 , @xmath165 and @xmath166 are coupled to photon @xmath167 and photon @xmath168 in two entangler-3 illustrated in the dashed line .",
    "the setup outputs an entangled triple - photon state in eq .",
    "( [ e3]).,width=245 ]    then , similar to a two - qubit gate , we should merge the n - th photon in multiple spatial modes to only one spatial mode without changing anything else .",
    "however , the standard merging gate is not suitable to do the work as there are more than two spatial modes , so we should generalize it to the one called merging - n gate shown in fig .",
    "[ merge - n ] . in this gate ,",
    "an ancilla single photon @xmath169 is used , and the last photon and the ancilla in the state @xmath170  are processed by a setup called entangler-4 , where the first ( second ) qubus beam is coupled to @xmath171 and @xmath172 ( @xmath173 and @xmath174 ) simultaneously .",
    "the entangler-4 outputs the following state ( @xmath175 denotes the ancilla ) : @xmath176 where @xmath177 , for @xmath178 . the difference in the next step from a standard merging gate is that a circuit performing quantum fourier transform ( qft ) @xcite ( @xmath179 denote the spatial modes , and @xmath180 ) , @xmath181 instead of only one 50:50 bs in a standard merging gate should be used for the interference of the spatial modes of the n - th photon .",
    "the qft for each of @xmath106 modes of the n - th photon in eq .",
    "( [ out - m ] ) is @xmath182 by a pbs@xmath75 on each output spatial mode and the corresponding conditional operations involving @xmath128 and phase shifts @xmath183 , the desired output state will be projected out from eq .",
    "( [ out - m ] ) . of course",
    ", simpler circuits could be found to replace the qft circuits .",
    "for example , in the case of three - photon gates , @xmath184{cccc}% 1 & 1 & 1 & 1\\\\ 1 & 1 & -1 & -1\\\\ 1 & -1 & -1 & 1\\\\ 1 & -1 & 1 & -1 \\end{array } \\right ) , \\ ] ] would perform the interference of the spatial modes of the last photon as well as a qft circuit . then",
    ", the remaining conditional operations are just @xmath128 without any phase shift .     or other possible multi - rail transformations , which are followed by the detections d in the dash - dotted line .",
    "their detection results will be classically feed - forwarded to redress the phases of the involved photonic modes . the input states with the n - th photon in multiple spatial modes",
    "will then be merged to the spatial modes of the other @xmath104 photons and the ancilla photon a.,width=291 ]    merging - n gate will reduce to a standard merging gate if @xmath185 . with the gate , an arbitrary multi - qubit gate @xmath152 could be realized deterministically . here @xmath104 c - path gates ( one c - path and @xmath108 modified c - path gates ) , @xmath16 entanglers ( @xmath104 entangler-3 and one entangler-4 ) , one ancilla single photon and plus two lomi ( a @xmath154-dimensional one for the gate unitary operation and a @xmath106-dimensional one for qft ) are the resources to realize the gate .",
    "a significant advantage of this proposal is that it works for any circuit in principle even if we do not know its decomposition into two - qubit gates .",
    "although it is possible to realize an n - qubit gate @xmath152 with the current technology as we apply the above - discussed transformations approaches , the necessary resources ( bs and phase shifters ) for the lomis in the setups will exponentially grow with @xmath16 .",
    "the number of the modes to be coupled to the qubus beams in a c - path-2 and an entangler-4 is also exponentially large with @xmath16 .",
    "it is therefore not realistic to apply the method to build a gate of large @xmath16 .",
    "however , the resources for constructing a special class of gates  multi - control gates  can be greatly reduced if we apply c - path and merging gates .",
    "the operation of this type of gates is given as @xmath186 it effects the action of @xmath132 on the last photon under the control of @xmath5 component of the remaining @xmath104 photons .",
    "the gate is a key multi - qubit gate called toffoli gate @xcite for @xmath187 .",
    "[ c]|c|c|c| & @xmath188 & @xmath63 + @xmath113 & & @xmath34 + @xmath189 & & @xmath34 + @xmath115 & & @xmath34 + @xmath116 & @xmath33 & +     for convenience",
    ". the target photon will be on path 5 conditioned on @xmath5 of both two control photons . here",
    "two @xmath138 are performed on path @xmath137 in order to arrange the photonic modes as in c - path-3 gate . a @xmath138 operation on path 5 and two following merging gates",
    "will then complete the toffoli gate operation .",
    "all bit flip @xmath138 here can be performed by @xmath190 wave plate.,width=226 ]    a toffoli gate is a universal element in quantum computation , i. e. , any quantum network can be constructed with this multi - qubit gate and the proper single - qubit gates .",
    "the gate is useful in implementing shor s algorithm @xcite and quantum error correction @xcite .",
    "several recent works have been attempted to optical realization of this gate @xcite . in most of previous approaches ,",
    "toffoli gate is constructed by means of decomposing the gate into two - qubit gates .",
    "there should be at least five two - qubit gates in constructing a triple - qubit toffoli gate @xcite , and a general toffoli gate of @xmath16 qubits requires @xmath191 @xmath192 two - qubit gates @xcite .",
    "it was proved that the resources could be reduced with part of input state encoded as a qudit in operation @xcite . here",
    "we show in what follows that a deterministic optical toffoli gate , which uses the resources increasing linearly with the size of an input , is possible even if the input is simply encoded as a multi - qubit product state in eqs .",
    "( [ 1 ] ) and ( [ 20 ] ) .    in fig .",
    "[ toffoli ] and [ toffoli-2 ] , we outline the designs to realize such gate with weak nonlinearity and linear optics . like a general multi - qubit gate in [ m2 ] , these designs do not rely on the decomposition into two - qubit gates .",
    "their difference from a general multi - qubit gate is no transformation of one input photon to @xmath15 spatial modes .",
    "the idea is that the first control photon sends the second photon to two different paths conditioned on its polarizations , and the modes on the second path of the second photon continue to control that of the third photon , and so forth to the last photon .",
    "this is what happens to an @xmath16-control toffoli gate realizing eq .",
    "( [ control ] ) .",
    "the number of the spatial modes for each photon , including the target photon , will be two after such operations , so @xmath132 could be performed on one spatial mode of the target to realize the gate .",
    "we illustrate the realization of toffoli gate with the design in fig .",
    "[ toffoli ] .",
    "the gate processes any input like the following with each qubit encoded in the respective polarization space : @xmath193 firstly , the polarizations of the photon @xmath194 control the second photon to two different paths @xmath168 and @xmath195 through a c - path gate , giving the state @xmath196 at this time , if the modes of the second photon on path 3 are to control the paths of the target photon through a standard c - path gate , there will be a problem of how to arrange the coupling of the qubus beams with all terms in eq .",
    "( [ tf-1 ] ) .",
    "the qubus beams are in tensor product state with all single photon modes , but the modes @xmath197 on path 3 are only part of the superposition .",
    "we should consider the coupling of two qubus beams with the other modes in the superposition of eq .",
    "( [ tf-1 ] ) .",
    "therefore , we should modify the standard c - path gate to that in dashed line of fig .",
    "[ toffoli ] .",
    "we call it c - path-3 gate to distinguish it from the prevously discussed c - path and c - path-2 gate .",
    "a 50:50 bs divides the target photon into two paths @xmath198 and @xmath125 in fig .",
    "[ toffoli ] , and then two qubus beams interact with the corresponding photonic modes as summarized in tab .",
    "[ tb5 ] , realizing the following transformation    @xmath199    together with the phase shift @xmath22 on two qubus beams . here",
    "the modes of the second photon on path 2 are divided into @xmath200 and @xmath189 by a pbs .",
    "a triple - phootn state @xmath201 will be post - selected out by a similar procedure to that in a standard c - path gate . here",
    "the target photon passes through path 5 only if both control photons are in the state @xmath202 .",
    "a bit flip @xmath121 on path @xmath125 alone will then finish the target operation .",
    "the remaning steps are the merging of the modes on path 4 , 5 and on path 2 , 3 , respectively .",
    "they are easy to perform with two standard merging gates . a triple - photon toffoli gate implementing the map , @xmath203 will be thus realized .",
    "is the different coupling pattern in c - path-3 gate .",
    "this design saves one mode to be coupled to a qubus beam.,width=207 ]    the design for the toffoli gate in this approach is not unique .",
    "the other layout in fig .",
    "[ toffoli-2 ] realizes an optical toffoli gate as well , but the interaction pattern for the qubus beams in c - path-3 gate is different from that in fig . [ toffoli] the second beam interacts with the modes of both first and second photon to save one mode for coupling .    to construct a general toffoli gate with @xmath16 control photons",
    ", we should apply @xmath104 c - path-3 gates , togther with one standard c - path gate . the interaction pattern in tab .",
    "[ tb5 ] for the @xmath204-th c - path-3 gate ( where the modes of the @xmath205-th photon on the second spatial path control the paths of the @xmath206-th photon ) will be simply generalized with the second beam coupled the second spatial mode of the @xmath206-th photon as well as with the @xmath4 mode of the @xmath205-th photon on the second path and both @xmath4 and @xmath5 mode of the @xmath205-th photon on the first path .",
    "meanwhile , the first qubus beam should be coupled to the first spatial mode of the @xmath206-th photon as well as the @xmath5 mode of the @xmath205-th photon on the second spatial path . in fig .",
    "[ toffoli-4 ] , we give the schematic setup of triple - control toffoli gate , for example .",
    "the circuit resources for an @xmath16-control toffoli gate are only @xmath16 pairs of c - path ( c - path-3 ) and merging gates .",
    "the design of an @xmath16-qubit toffoli gate can be regarded as a simple generalization of that for cnot gate ( single - qubit control ) mentioned at the beginning of [ 2-qubit ] .    .",
    "since the ancilla photon for the merging gates can be recycled , a general toffoli gate only needs one ancilla photon in principle.,width=302 ]    in addition , more general multi - control gate called @xmath207 gate @xcite , which performs the multi - qubit @xmath208 operation on @xmath205 target photons controlled by @xmath16  control photons , i.e. , @xmath209 can be realized in a similar way .",
    "we could combine the multi - control gate idea discussed here with the multi - photon transformation and its inverse in [ m1 ] and [ m2 ] .",
    "the circuit resources are @xmath210 c - path gates ( one c - path gate for the first two control photons , @xmath104 c - path-3 gates for the next @xmath104  control photons , @xmath205 c - path-3 gates for the final control photon and @xmath205 target photons ) , the gates to transform k - photon state to a corresponding single photon and their inverse , the lomi for @xmath208 on single photon , and @xmath210 merging gates .",
    "all these element gates together could realize a @xmath207 gate deterministically .",
    "we present the methods of transforming a class of multi - photon states to the corresponding single photon states which inherit the structures of the initial multi - photon states .",
    "these transformations make the deterministic unitary operations and povms on the multi - photon states in the form of tensor products of multiple single photon qubits possible .",
    "since the input states of various quantum information processing tasks can be encoded in such form , these transformations and their inverses , which are implemented by a finite number of element gates , would be found applications in the related fields . in this paper",
    "we have discussed the realization of multi - photon state discrimination and the construction of quantum logic gates in the transformation approach .",
    "we especially discuss the realization of parity gate and toffoli gate , which have wide applications in quantum information technology .",
    "the technical ingredients for this circuit or network based approach are linear optics and weak non - linearity , which are within the current technology .",
    "the circuits used for the transformations may add to the tool kits to process photonic states ."
  ],
  "abstract_text": [
    "<S> multi - photon states are widely applied in quantum information technology . by the methods presented in this paper , the structure of a multi - photon state in the form of multiple single photon qubit product </S>",
    "<S> can be mapped to a single photon qudit , which could also be in separable product with other photons . </S>",
    "<S> this makes the possible manipulation of such multi - photon states in the way of processing single photon states . </S>",
    "<S> the optical realization of unknown qubit discrimination [ b. he , j. a. bergou , and y .- h . </S>",
    "<S> ren , phys . </S>",
    "<S> rev . </S>",
    "<S> a 76 , 032301 ( 2007 ) ] is simplified with the transformation methods . </S>",
    "<S> another application is the construction of quantum logic gates , where the inverse transformations back to the input state spaces are also necessary . </S>",
    "<S> we especially show that the modified setups to implement the transformations can realize the deterministic multi - control gates ( including toffoli gate ) operating directly on the products of single photon qubits . </S>"
  ]
}