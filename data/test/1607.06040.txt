{
  "article_text": [
    "the rise of renewable energy has tremendous impact on the redesign of electricity transmission and distribution networks .",
    "renewable energy sources are significantly more variable than traditional energy sources , and are already responsible for 80 percent of the bottlenecks in the european transmission grid  @xcite . on the other hand ,",
    "the availability of new technologies creates new opportunities .",
    "in particular , the incorporation of storage devices in the network has been suggested to mitigate variability , both from the supply and demand side .",
    "the motivation of this work comes from the observation that energy networks , unlike communication and road traffic networks , lose a nonnegligable amount of the entity they are trying to transport , namely energy .",
    "one reason , which is the focal point of this paper , is heat loss .",
    "the central question we aim to address in this paper is the following : what is the impact of renewable energy on the amount of heat loss in an energy network , and how can storage devices such as batteries help mitigate this loss ?",
    "we pursue these questions also in view of the fact that the total heat loss is a good candidate as a global performance metric of the efficiency of transport in a power network .    in a smart - grids context",
    ", storage devices have been analyzed in a variety of settings . in a macroscopic",
    "setting , storage models have been suggested to deal with uncertainties in wind generation that play a role on longer time scales ; in these models the physical network is not modeled explicitly , see for example  @xcite .",
    "storage can also be used as tactical tool , exploiting temporal price differences  @xcite .",
    "the effect of storage and the optimal storage placement has been studied in the framework of optimal power flows , see e.g. ,  @xcite , but mostly assuming non - stochastic generation and demand . in @xcite , it is illustrated by simulation techniques how optimal storage placement can increase network reliability .",
    "several papers in the literature also investigate optimal policies for storage management , both at grid operator level  @xcite as well as at consumer level  @xcite .",
    "other recent papers on control problems in energy systems focus on demand - side management , see e.g. @xcite .",
    "related papers on storage modeling in energy systems are  @xcite .    the above - mentioned papers do not model the transport network explicitly , are restricted to simulations , or focus on deterministic scenarios .",
    "our paper proposes a probabilistic analysis that takes the network structure into account . for reasons of mathematical tractability",
    ", we model our energy network as dc network , whose underlying equations are the same as in the widely used linear approximation for ac networks , see e.g. ,  @xcite . in a resistive network",
    "the total amount of heat loss can be described through thompsons principle  @xcite , and follows from the analysis of a weighted graph with random sources and sinks .    in general",
    ", storage devices can fill up or empty . in this work ,",
    "we focus on short time scales in the network , up to a few minutes , and make the assumption that such boundary effects do not play a role .",
    "the time - scale assumption also allows us to model the input flows as ornstein - uhlenbeck processes ; for a physical motivation we refer to  @xcite .    in the case of a single battery ,",
    "these assumptions reduce the problem to the total heat loss in a dc network having random sources and sinks with a single slack node .",
    "we derive an explicit expression for the expected total heat loss that gives insight in how the optimal location of such a battery depends on the network properties as well as on the mean and variance of the external currents . for several reasons",
    ", it makes sense to use multiple batteries in a network , the most obvious one is , as we show here , that the total amount of heat loss can be reduced significantly . considering the prototypical case of two batteries , we show in a static setting how the expected heat loss crucially depends on the way the batteries share the load .",
    "we then investigate a control problem in which we allow batteries to share the load dynamically , minimizing the total expected heat loss , subject to a constraint which makes sure that the load does not oscillate from one battery to the other .",
    "the sharing between batteries is a deterministic control problem , and as we show , leads to an explicit solution if the input is stationary .",
    "our paper is organized as follows .",
    "the model is described in section  [ sec2 ] .",
    "sections  [ sec3 ] and  [ sec4 ] describe the cases of one and two batteries , respectively , in a static context .",
    "we examine a dynamic load sharing problem for two batteries in section  [ sec5 ] and present our conclusion in section  [ sec6 ] .",
    "in this paper we model an energy network as a weighted graph @xmath0 , where the graph @xmath1 is a simple undirected graph @xmath2 with @xmath3 nodes and @xmath4 edges and @xmath5 is the collection of edge weights .    in the energy network terminology , @xmath0 is a _ resistive electrical network _ with @xmath6 _ buses _ and @xmath7 _ transmission lines _ and the quantity @xmath8 is the _ conductance _ of the transmission line connecting buses @xmath9 and @xmath10 .    without loss of generality",
    ", we will henceforth assume that @xmath1 is a connected graph .",
    "the _ weighted laplacian matrix _ of the graph @xmath1 is the @xmath11 matrix @xmath12 defined as @xmath13 the matrix @xmath12 satisfies the following identity @xmath14 where @xmath15 is _ oriented edge - vertex incidence matrix _ ( after having chosen any orientation for the edges ) , namely @xmath16 and @xmath17 is the diagonal matrix with the edge conductances as diagonal elements , i.e. ,  @xmath18 , if @xmath19 is the index corresponding to the edge @xmath20 .",
    "let @xmath21 be the _ moore - penrose pseudoinverse _ of the weighted laplacian matrix @xmath12 .",
    "it is well - known that both @xmath12 and @xmath22 are real , symmetric , positive semi - definite matrices .",
    "denote by @xmath23 the vector of current flows across the network edges and by @xmath24 the vector of the potentials in the network nodes .",
    "the currents flow in the network @xmath0 according to ohm s law , which can be written in matrix form as @xmath25    let @xmath26 be the vector describing the external currents : for every @xmath27 , @xmath28 represents the current generated ( if @xmath29 ) or consumed ( if @xmath30 ) at node @xmath9 .",
    "we assume that the energy network is balanced , which means that the total power generation equals the total power demand : @xmath31 such a zero - sum external current vector @xmath32 induces potentials @xmath33 in the network nodes given by @xmath34 and , in view of  , a current vector @xmath35 in this paper , we will be mostly interested in the scenarios where @xmath32 is a random vector ( or a multi - dimensional stochastic process ) , which is useful to model energy networks where both the power demand and generation are stochastic in nature .",
    "it is well know that when a current @xmath36 is flowing in a line with conductance @xmath37 dissipates some power is dissipated as heat at rate @xmath38 .",
    "let @xmath39 be the total heat loss on the energy network @xmath1 corresponding to the external current vector @xmath32 , that is @xmath40 where the vectors @xmath41 and @xmath33 depend on the external current vector @xmath32 as illustrated in   and  , respectively .",
    "this identity in matrix form reads @xmath42    for our analysis , it is convenient to make explicit the dependence of the total heat loss on the external current vector @xmath32 .",
    "the next proposition shows how @xmath43 can be written as a quadratic form of the external current vector @xmath32 .    in particular , if @xmath32 is a random vector ( or a stochastic process ) , then the total heat loss also becomes a random variable ( or a stochastic process , respectively ) and we show how to compute the expected total heat loss @xmath44 dissipated by an energy network knowing the network structure and the first two moments of the distribution of the external currents .    [",
    "prop : qf ] consider the network @xmath0 and let @xmath22 be the associated laplacian pseudo - inverse . given an external current vector @xmath32 , the total heat loss in the network is @xmath45 if the external current vector @xmath32 is a random vector with mean @xmath46 and covariance matrix @xmath47 , then the expected total heat loss in the network @xmath0 is @xmath48    combining identities  ,  , and  , the total heat loss given an external current vector @xmath32 rewrites as @xmath49 where in the last step of the latter equation we used the well - known identity @xmath50 . if @xmath32 is a random vector , then @xmath43 becomes a random variable and its expected value can be computed using  ( * ? ? ?",
    "* corollary 3.2b.1 ) , obtaining  .",
    "the _ effective resistance _ @xmath51 between a pair of nodes @xmath9 and @xmath10 is the potential difference that appears across nodes @xmath9 and @xmath10 when a unit current source is applied between them : @xmath52 or , equivalently , @xmath53 as shown in  @xcite the effective resistance defines a distance on the set of nodes . indeed ,",
    "* @xmath54 for every @xmath55 and @xmath56 if @xmath57 ; * @xmath58 for every @xmath57 ; * for @xmath59 the triangle inequality holds : @xmath60    for this reason , the effective resistance @xmath51 is also known in the literature as the _ resistance distance _ between the nodes @xmath9 and @xmath10 .",
    "let @xmath61 be the _ resistance matrix _ of the network @xmath0 , that is the @xmath11 matrix whose @xmath20 entry is @xmath51 . from the properties of the effective resistance",
    ", it immediately follows that @xmath61 is a symmetric matrix with all diagonal entries equal to zero .",
    "consider the network @xmath62 , in which all the conductances are set equal to @xmath63 .",
    "the _ kirchhoff index _ or _ total effective resistance _ of a graph @xmath1 is then defined using the resistance matrix @xmath61 as @xmath64 the kirchhoff index was introduced in  @xcite and in the same paper the authors showed that @xmath65 from this identity and   it immediately follows that if the random external currents @xmath32 in the network @xmath62 are independent with zero mean and unit variance , then @xmath66 such an index has been extensively studied in the chemistry literature and it has been calculated for many graphs of interest  @xcite .",
    "the kirchhoff index has also been proposed in  @xcite as a measure of graph robustness and in  @xcite the authors consider the problem of how to minimize such a quantity in a given graph .    in this work",
    ", we need to go beyond the notion of the kirchhoff index for several reasons .",
    "firstly , the quantity @xmath67 describes the expected total heat loss in a energy network where the current injections are _ not _ independent , since they need to satisfy the identity @xmath68 .",
    "furthermore , we are interested in the study of energy networks with heterogeneous conductances and where the external current injections could possibly have heterogeneous means and variances .",
    "consider an energy network with a single battery , which we assume to be placed at node @xmath6 , without loss of generality .",
    "for every @xmath69 we define @xmath70 as the random external current at node @xmath9 at time @xmath71 .",
    "let @xmath72 be the random vector describing the external currents at time @xmath71 in the whole network and denote by @xmath73 its average and by @xmath74 its covariance matrix at time @xmath71 .",
    "we will henceforth assume that the external currents in all @xmath75 nodes are independent , so that at time @xmath71 the covariance matrix @xmath76 is a diagonal matrix with diagonal entries that we denote as @xmath77 .",
    "we model the battery as a _ slack node _ ,",
    "i.e. ,  we assume that the battery compensates for the total power generation - demand mismatch @xmath78 , either by charging using the current in excess when @xmath79 or discharging to meet the demand when @xmath80 .",
    "this means that the actual external current vector at time @xmath71 is the @xmath6-dimensional random vector @xmath81 defined as @xmath82 note that the relation between the vectors @xmath81 and @xmath83 can be rewritten in matrix form as @xmath84 where @xmath85 is the @xmath86 matrix defined as @xmath87 with @xmath88 being the identity matrix of order @xmath75 and @xmath89 the vector with all entries equal to @xmath63 .    the total heat loss at time @xmath71 for this energy network with one battery , which we denote by @xmath90 , is given by @xmath91 where the matrix @xmath92 is defined as @xmath93 the matrix @xmath94 contains all the relevant information about the network structure and conductances as well as the battery location .",
    "in view of   and proposition  [ prop : qf ] , the expected total heat loss @xmath95 at time @xmath71 is @xmath96 the next theorem , which is proved in the appendix , illustrates how the expected total heat loss @xmath97 at time @xmath71 depends on the network structure , on the battery location , and on the first two moments of the external current distribution .",
    "[ thm : onebattery ] consider a network @xmath0 with associated resistance matrix @xmath61 .",
    "if a battery is placed at node @xmath6 , the expected total heat loss @xmath97 at time @xmath71 is equal to @xmath98    a special case of interest is the situation where the expected generation - demand mismatch is equal to zero , i.e. ,  @xmath99 in this scenario the energy network is on average self - balanced , hence the main role of the battery is to shove peaks in generation or demand , as well as to compensate for spatial imbalances in the network in the current production or consumption . in this case",
    ", the expected total heat loss simplifies to @xmath100 both this formula and   can be used to determine the optimal placement of a battery in a network .",
    "we shall apply this in the next section to a line network , investigating the difference between one and two optimally located batteries .",
    "we now consider the scenario where in the energy network there are multiple batteries that can coordinate their operations .",
    "we focus here the case of two batteries , which we assume to be placed in nodes @xmath75 and @xmath6 , without loss of generality .",
    "the remaining @xmath101 nodes of the network have a stochastic current injections or consumptions . similarly to the previous section ,",
    "we denote by @xmath83 , @xmath102 , and @xmath76 the random external current vector at time @xmath71 , its mean and its covariance matrix , respectively .",
    "furthermore , also here we assume that the @xmath101 external currents are independent , which means that @xmath76 is a diagonal matrix with entries @xmath103 .",
    "the two batteries compensate for the total power generation - demand mismatch @xmath104 according to the weights @xmath105 and @xmath106 , respectively , for some @xmath107 to which we will refer as _ load sharing coefficient_. this means that the external currents in the whole network at time @xmath71 are described by the @xmath6-dimensional vector @xmath81 defined as @xmath108 note that when @xmath109 $ ] , both batteries simultaneously charge or discharge ( since the weights @xmath105 and @xmath106 have the same sign ) , while they have a specular behavior when @xmath110 .",
    "note that the relation between the vectors @xmath81 and @xmath83 can be rewritten in matrix form as @xmath111 where @xmath112 be the @xmath113 matrix defined as @xmath114 let @xmath115 be the total heat loss in the network at time @xmath71 that corresponds to the external current vector @xmath83 when the load sharing coefficient of the two batteries is @xmath105 . using   and  , we can write @xmath116 where @xmath117 is an @xmath118 matrix that encodes all the crucial information about the two batteries , their location , and the network properties .    from   and proposition  [ prop : qf ]",
    "it follows that when the two batteries use a load sharing coefficient @xmath105 , the expected total heat loss @xmath119 at time @xmath71 is equal to @xmath120 the next theorem shows how such a quantity depends on the network structure , on the first two moments of the external current distribution and on the load sharing coefficient @xmath105 .",
    "[ thm : heat2batteries ] consider a network @xmath0 with associated resistance matrix @xmath61 . if two batteries are placed at nodes @xmath75 and @xmath6 and use a load sharing coefficient @xmath105 , the expected total heat loss @xmath121 at time @xmath71 is equal to @xmath122 where @xmath123 , for @xmath124",
    "the proof of this theorem is presented in the appendix .    in view of",
    ", @xmath121 is a second - degree convex polynomial in @xmath105 and it is easy to show that @xmath125 for any @xmath105 and any choice for the external current parameters .",
    "furthermore , @xmath121 has a unique minimum as a function of @xmath105 , which we denote by @xmath126 and refer to as the optimal load sharing coefficient at time @xmath71 .",
    "one can derive that @xmath127 such an optimal load sharing coefficient depends on the means and variances of the external currents , as well as on the network structure via the effective resistance @xmath128 between the two batteries and the quantities @xmath129 , @xmath124 .",
    "in the scenario where the network is on average self - balanced , i.e. ,  @xmath130 , the optimal load sharing coefficient reads @xmath131 it is easy to prove using   and the definition of @xmath129 that in this special case the load sharing coefficient @xmath126 lies in @xmath132 $ ] , so that at any time @xmath71 the two batteries either both charge or both discharge ; note that this is not necessarily the case in the general case described above .      in this subsection",
    "we illustrate the performance gain that can be obtained by using two batteries instead of one . in order to obtain a more transparent result we consider a simple network topology , namely a line network of @xmath6 nodes with unit conductance edges , and i.i.d .  external currents with zero mean and variance @xmath133 .    one can show that the optimal location for a single battery is the central node @xmath134 , while the optimal displacement of two batteries with load sharing coefficient @xmath135 is @xmath136 the corresponding expected total heat losses are @xmath137 hence , by adding a battery we reduce the expected total heat loss by @xmath138 asymptotically in the number of nodes , since @xmath139",
    "in the previous section we derived the optimal control for two batteries as function of the network structure and external current parameters . however , in order to compute the optimal load sharing coefficient @xmath126 at time @xmath71 one would need to know all these data in real - time , which is not realistic .",
    "furthermore , the time evolution of @xmath126 could be quite irregular , if the external current parameters changes too rapidly .    to tackle both these issues , we investigate how to obtain a smoother control on a finite time interval @xmath140 $ ] .",
    "the time - scale assumption discussed in section  [ sec1 ] allows us to take a stationary external current processes @xmath83 , so that the expected external current vector does not depend on time , i.e. ,  @xmath141 , and the covariance matrix is a diagonal matrix @xmath47 and does not depend on the time either",
    ".    in view of theorem  [ thm : heat2batteries ] , the expected total heat loss @xmath97 using a load sharing coefficient @xmath142 at time @xmath71 rewrites as @xmath143 where @xmath144 , @xmath145 , and @xmath146 are three time - independent coefficients that depend on the network structure and on the mean and variances of the external current processes , see  .",
    "let @xmath147 be a positive real constant and assume that the load sharing coefficient @xmath148 \\to { \\mathbb r}$ ] is two times differentiable on @xmath140 $ ] . consider the variational problem @xmath149 in other words , we would like to find the optimal dynamical load sharing coefficient that minimizes the expected total heat loss , knowing that at time @xmath150 the load sharing coefficient is @xmath151 .",
    "the penalty term @xmath152 has been added to the variational problem to obtain an load sharing coefficient @xmath142 that evolves smoothly over time , without abrupt changes .",
    "[ thm : control ] the solution of the variational problem   is @xmath153    the euler - lagrange equation of problem   reads @xmath154 a general solution of this non - homogeneous second - order linear ordinary differential equation reads @xmath155 assume that the derivative at zero is equal to @xmath156 .",
    "this , together with the initial conditions @xmath157 , yields @xmath158 we now minimize over the value of @xmath159 .",
    "define @xmath160 from   and   it follows that the function @xmath161 is a second degree convex polynomial in @xmath162 and attains its minimum at @xmath163 combining  ,   and  , we obtain that the solution of the variational problem is  .      in this subsection",
    "we will briefly illustrate the scenario where the external currents are modeled by independent stationary ornstein - ulhenbeck processes .",
    "more specifically , we assume that for every @xmath164 the external current at node @xmath9 is a ornstein  uhlenbeck process , with mean @xmath165 , variance @xmath166 and mean - reversion rate @xmath167 , i.e. ,  @xmath168 where @xmath169 are independent standard brownian motions .",
    "as illustrated in   the expected total heat loss @xmath97 in the network when the two batteries use a load sharing coefficient @xmath142 at time @xmath71 can be written as @xmath170 where , in view of the assumption for the external currents to evolve as ornstein  uhlenbeck processes , the coefficients @xmath171 can be calculated as @xmath172 as an example , we consider a network @xmath62 where the graph @xmath1 , illustrated in figure  [ fig : network ] , is the ieee 14-bus network , which has @xmath173 nodes and @xmath174 edges .",
    "the two batteries have been placed in the positions highlighted in black ( first battery ) and white ( second battery ) .     describing the ieee 14-bus network topology ]    we simulate the external currents as independent ornstein ",
    "uhlenbeck processes with heterogeneous parameters to have qualitative insight of the performance of the optimal smooth control for the load sharing coefficient derived in theorem  [ thm : control ] .",
    "figure  [ fig : controls ] shows the evolution over time of @xmath175 and that of the pathwise omniscient optimal control @xmath176 , i.e. ,  the one obtained by minimizing the total heat loss at every time _",
    "conditionally on the realized external currents_.    despite knowing only the mean , variance and mean - reversion rate of the external current processes , the smooth control @xmath175 performs quite well and indeed the total heat loss tracks quite closely the minimum total heat loss , achievable with the omniscient control , as illustrated in figure  [ fig : heatpath ] .",
    "( in green ) vs. the path - wise omniscent optimal control @xmath176 ( in blue ) ]    ]",
    "in this paper we consider a stochastic model for energy networks , which we model as weighted graphs with random sources and sinks .",
    "we analyzed the impact of storage devices using the total heat loss as performance metric and explicit results have been obtained in the case of one and two batteries , this latter also in a dynamic context .",
    "we leave the extension to scenarios with an arbitrary number of batteries for future work .",
    "[ lem : lp ] @xmath177      denote by @xmath179 the a matrix with all entries equal to @xmath63 and by @xmath180 that with all entries equal to @xmath181 .",
    "since every column of @xmath85 has zero sum , it follows that @xmath182 thus , if we denote @xmath183 , then @xmath184 is a symmetric matrix and @xmath185 furthermore , in view of  , @xmath186 and thus @xmath187    for notational compactness , we suppress in this proof the dependence on @xmath71 of the various parameters . from lemma  [ lem : l1 ]",
    ", it immediately follows that @xmath188 , that , together with the assumption that @xmath189 , yields@xmath190 thanks to lemma  [ lem : l1 ] and the properties of the matrix @xmath61 @xmath191 where the second last passage follows from the identity @xmath192 valid for any @xmath193 and @xmath194 in @xmath195 .      for every @xmath107 , @xmath197 and , hence , @xmath198 hence , we can argue like in the proof of lemma  [ lem : l1 ] and consider the symmetric matrix @xmath183 , which is such that @xmath199 from   it follows that @xmath200 using the auxiliary matrix @xmath184 , we can write @xmath201 denote @xmath202 and @xmath203 . consider first the terms in   that do not depend on @xmath9 and @xmath10 : using identity   we get @xmath204 consider now the terms in   that depend on @xmath9 and @xmath10 . by virtue of",
    ", we derive @xmath205 the proof is completed by combining  - .    also in this proof",
    ", we suppress the dependence on @xmath71 for notational compactness .",
    "since @xmath206 , using lemma  [ lem : l2 ] and the properties of matrix @xmath61 we get that @xmath207 with @xmath208 for @xmath124 .",
    "moreover , again by virtue of lemma  [ lem : l2 ] , @xmath209 where in the last step we used identity  .",
    "d.  bhaumik , d.  crommelin , and b.  zwart , `` a computational method for optimizing storage placement to maximize power network reliability , '' to appear in _ 2016 winter simulation conference proceedings _ , 2016 .",
    "i.  koutsopoulos , v.  hatzi , and l.  tassiulas , `` optimal energy storage control policies for the smart power grid , '' in _ smart grid communications 2011 ieee international conference on _ , 2011 , pp .",
    "475480 .",
    "s.  meyn , p.  barooah , a.  busic , y.  chen , and j.  ehren , `` ancillary service to the grid using intelligent deferrable loads , '' _ ieee transactions on automatic control _ , vol .",
    "60 , no .  11 ,",
    "pp . 28472862 , 2015 .",
    "y.  kanoria , a.  montanari , d.  tse , and b.  zhang , `` distributed storage for intermittent energy sources : control design and performance limits , '' in _",
    "49th annual allerton conference on communication , control , and computing _ , pp . 13101317 , 2011 .",
    "su and a.  el gamal , `` modeling and analysis of the role of fast - response energy storage in the smart grid , '' _ 49th annual allerton conference on communication , control , and computing _ , pp . 719726 , 2011 .            d.  bienstock , m.  chertkov , and s.  harnett , `` chance constrained optimal power flow : risk - aware network control under uncertainty , '' _ proceedings of the national academy of sciences _ , vol .  56 , no .  3 , pp .",
    "461495 , 2014 .",
    "a.  ghosh , s.  boyd , and a.  saberi , `` minimizing effective resistance of a graph , '' _ siam review _ , vol .",
    "50 , no .  1 ,",
    "pp . 3766 , 2008 .",
    "e.  bendito , a.  carmona , a.  encinas , and j.  gesto , `` characterization of symmetric m - matrices as resistive inverses , '' _ linear algebra and its applications _ , vol .",
    "430 , no .  4 , pp .",
    "13361349 , 2009 ."
  ],
  "abstract_text": [
    "<S> electricity transmission networks dissipate a non - negligible fraction of the power they transport due to the heat loss in the transmission lines . in this work </S>",
    "<S> we explore how the transport of energy can be more efficient by adding to the network multiple batteries that can coordinate their operations . </S>",
    "<S> such batteries can both charge using the current excess in the network or discharge to meet the network current demand . </S>",
    "<S> either way , the presence of batteries in the network can be leveraged to mitigate the intrinsic uncertainty in the power generation and demand and , hence , transport the energy more efficiently through the network . </S>",
    "<S> we consider a resistive dc network with stochastic external current injections or consumptions and show how the expected total heat loss depends on the network structure and on the batteries operations . </S>",
    "<S> furthermore , in the case where the external currents are modeled by ornstein - uhlenbeck processes , we derive the dynamical optimal control for the batteries over a finite time interval .    </S>",
    "<S> = 1 </S>"
  ]
}