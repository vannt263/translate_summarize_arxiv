{
  "article_text": [
    "it is now possible to realize ideal quantum measurements on individual quantum objects , for instance atoms , ions and photons . beyond being a tool to monitor the system s evolution ,",
    "projective quantum measurements can be used to prepare it in specific quantum states .",
    "for instance , an ideal quantum non - demolition ( qnd ) measurement of a field s photon number projects it onto a photon - number ( fock ) state @xcite .",
    "however , due to the basic quantum indetermination of the measurement outcome , measurement - induced state generation is not deterministic .",
    "quantum feedback control techniques @xcite make it possible to overcome this limitation and to produce quantum states on demand .",
    "these techniques generally combine weak quantum measurements with a real - time correction of the system s state depending on the classical information extracted from the measurements . beyond preparation of specific states",
    ", these feedback schemes can also protect them from decoherence , resulting from the coupling of the system with its environment .    in this paper",
    ", we propose a quantum feedback scheme for the on - demand preparation of fock states stored in a high - quality superconducting microwave cavity and for their protection against decoherence .",
    "this scheme is designed to operate with an existing cavity - qed set - up @xcite .",
    "the feedback loop uses three steps .",
    "we first extract information on the photon number distribution with a single circular rydberg atom by a qnd process .",
    "this atom interacts dispersively with the cavity field and does not exchange energy with it , but experiences a light shift proportional to the photon number .",
    "the measurement of this shift , with the help of a ramsey interferometer , provides information on the field intensity .",
    "it modifies the field state accordingly through the quantum projection .",
    "this information is , in the second step , used to estimate the new cavity field state through a quantum filtering process @xcite . in the third step",
    ", we correct the field state , using a coherent field pulse injected in the cavity .",
    "the feedback law used to calculate the amplitude of this pulse is chosen by adapting to this discrete situation the lyapunov - based techniques proposed in ref .",
    "these three steps represent the three basic components of any feedback loop : a sensor , a controller and an actuator .",
    "in contrast to classical closed - loop systems , we use here a quantum sensor .",
    "however , both controller and actuator remain classical . by iterating the feedback loop",
    ", we steer the cavity towards any target fock state .",
    "we also efficiently stabilize it against cavity decay .",
    "recently , a similar feedback scheme to generate fock states of light in an optical cavity has been proposed @xcite .",
    "it is based on a continuous monitoring of the mean number of photons .",
    "instead , we propose here to use a discrete qnd measurement followed by a quantum filtering process providing complete information on the field s density matrix .",
    "this precise knowledge of the field s state gives us a much better insight into the feedback action .",
    "it could also be an asset in other feedback schemes requiring , for instance , information on the field s phase in addition to its intensity .",
    "the paper is organized as follows . in sec .",
    "[ sec : setup ] , we describe the elements of the set - up and give realistic experimental parameters .",
    "we present the quantum - mechanical operators describing the evolution of the cavity state under measurement , decoherence and pulse injection .",
    "section  [ sec : ideal ] is devoted to a detailed analysis of the quantum filter and of the feedback law in an ideal situation .",
    "we first present the main elements of the feedback loop and describe the tuning of the controller gain .",
    "we give qualitative arguments showing that the proposed strategy is stable .",
    "the detailed mathematical proof of convergence and stability , relying on stochastic lyapunov techniques will be published elsewhere @xcite .",
    "we finally present quantum monte carlo simulations of closed - loop trajectories of the cavity field exhibiting the feedback performances . in section  [ sec : real ] , we take into account the known experimental imperfections of the existing set - up .",
    "we modify accordingly the feedback algorithm and present extensive simulations of its operation .",
    "we conclude in sec .  [",
    "sec : conclusion ] .",
    ":  high-@xmath0 microwave cavity , @xmath1 :  box producing rydberg atoms , @xmath2 and @xmath3 : low-@xmath0 ramsey cavities , @xmath4 : atomic field - ionization detector , @xmath5 and @xmath6 : microwave sources coupled to @xmath7 and @xmath8 s , respectively . in a quantum filtering process , a real - time control system analyzes the results of qnd measurements of the cavity field and computes the amplitude of a control injection pulse.,scaledwidth=48.0% ]    our quantum feedback algorithm is designed for the ens microwave cavity qed set - up  @xcite .",
    "its components are depicted in fig .",
    "[ fig : setup ] .",
    "the microwave field to be controlled is confined in an ultra - high @xmath0 superconducting cavity @xmath7 ( damping time @xmath9",
    "rydberg atoms , flying one by one at 250 m / s across the cavity mode and dispersively interacting with its field , are used as qnd probes of light  @xcite .",
    "they are prepared in a superposition of two circular rydberg states @xmath10 and @xmath11 ( principal quantum numbers 51 and 50 , respectively ) in the low-@xmath0 cavity @xmath2 , driven by the source @xmath6 , in which they experience a resonant @xmath12-pulse . in the bloch sphere representation",
    ", the spin corresponding to the two - level atomic system then points along the @xmath13 direction in the equatorial plane ( states @xmath10 and @xmath11 correspond to north and south poles of the sphere , respectively ; we use a frame rotating at the atomic frequency ) .    the light shifts experienced by the non - resonant @xmath14 atomic transition in the cavity field result in a phase shift for the atomic state superposition .",
    "at the cavity exit , the atomic spin points along a direction in the equatorial plane at an angle @xmath15 with the @xmath13 axis , correlated to the photon number @xmath16 .",
    "the dephasing angle @xmath15 can be controlled by adjusting the atom - cavity detuning @xmath17 and the interaction time . in the large atom - cavity detuning regime",
    ", it is a linear function of @xmath16 : @xmath18 , where @xmath19  khz is the vacuum rabi frequency . for the intermediate detuning values used in the experiments , it is a more complex , albeit perfectly known growing function of @xmath16 .",
    "a second @xmath12 ramsey pulse in @xmath3 ( phase @xmath20 with respect to that of the pulse in @xmath2 ) followed by the atomic detection ( in the @xmath21 basis ) by the detector @xmath4 amounts to a detection of the atomic spin along an axis at an angle @xmath20 with @xmath13 .",
    "it provides information on the cavity field intensity .",
    "atoms are sent in the set - up at typical 250 @xmath22s time interval , much shorter than the cavity damping time .",
    "note that such a macroscopic time interval is well adapted to elaborate feedback strategies since we have ample time to compute the state estimator and the feedback law between two atomic detections . when no feedback action is performed , the information provided by a few tens of atoms results in a measurement of the dephasing angle @xmath15 and , hence , in a projective qnd measurement of the photon number @xmath16 @xcite .",
    "we are interested here instead in the ambiguous information provided by a single atomic detection .",
    "detection of the atomic state in @xmath4 projects the field , described initially by the density matrix @xmath23 , onto a new state @xmath24 . depending on the detected atomic state ,",
    "@xmath25 or @xmath11 , the back - action of the quantum measurement on the field is described by @xmath26 where the operators @xmath27 are given by    [ eq : mgme ] @xmath28 @xmath29    here , @xmath30 is the photon number operator with @xmath31 and @xmath32 the photon annihilation and creation operators , respectively .",
    "the measurement operators @xmath27 are diagonal in a photon - number basis ( as is @xmath33 ) .",
    "they thus preserve fock states , illustrating the qnd nature of the measurement . the projected state is normalized by the probability @xmath34 of detecting the atom in state @xmath35 .    the cavity field",
    "can also be manipulated by injecting into the mode a coherent field pulse generated by the resonant microwave source @xmath5 .",
    "its action is described by the displacement operator @xmath36 , where @xmath37 is the complex amplitude of the injected field .",
    "the cavity field after displacement thus reads @xmath38    a proper analysis of the feedback scheme requires to take into account all known imperfections of the experimental set - up . besides projective measurement and coherent evolution",
    ", the cavity state also evolves due to decoherence .",
    "the field is coupled to a reservoir at non - zero temperature ( @xmath39  k ) , and its dynamics is described by the master equation @xcite @xmath40 where @xmath41 is the cavity decay rate and @xmath42 the equilibrium thermal photon number .    moreover , the circular rydberg state preparation is a non - deterministic poisson process .",
    "we perform a pulsed excitation from a continuous thermal beam of rubidium atoms , preparing atomic samples at a @xmath43s time interval .",
    "the mean number of circular atoms per sample is @xmath44 ( leading to an average time between atoms of 250 @xmath22s ) .",
    "the atomic time of flight between @xmath7 and @xmath4 is 350  @xmath22s , corresponding to a delay of @xmath45 atomic samples .",
    "the probability for detecting an atom present in a sample is @xmath46 due to finite detection efficiency in @xmath4 . finally , non - ideal atomic state resolution of the field - ionization detector and finite contrast of the ramsey interferometer introduce a probability of erroneous state assignation of @xmath47 .",
    "in order to describe the essential elements of the feedback scheme in a simple context , we first consider in this section an idealized experiment with no cavity decay ( @xmath48 ) , a deterministic atomic preparation ( @xmath49 ) , no detection delay ( @xmath50 ) , and a perfect atomic detection ( @xmath51 and @xmath52 ) .      the quantum filtering procedure @xcite provides us with an estimate of the field state by using all available information . right after detection of atom number @xmath53 and before injection of the corresponding control , it includes the initial state of the field @xmath54 , information obtained from all @xmath53 atoms detected so far ( labelled @xmath55 ) and all coherent field injections performed in the former feedback loops ( 1 to @xmath56 ) .",
    "each of the elementary processes ( atomic detections and displacements ) can be represented by super - operators acting on the field s density matrix .",
    "let us note @xmath57 that associated to the detection of atom @xmath58 and @xmath59 that corresponding to the displacement performed in the @xmath60 iteration of the feedback loop .",
    "therefore , after detecting atom @xmath53 , the state of the field  is @xmath61 here and in the following , all super - operator products are ordered by decreasing indices .",
    "note that the expression can be computed iteratively from the recurrence @xmath62 setting @xmath63 . by applying this filter recursively at each cycle",
    ", we get a reliable real - time estimate of the field state .    based on eqs .   and",
    ", the super - operators are defined as @xmath64 here , @xmath65 or @xmath66 depending on the outcome of the @xmath60 atomic measurement .",
    "the control amplitude @xmath67 is adjusted after each atom detection according to the feedback law described in the next subsection .",
    "we choose to prepare initially the cavity in a coherent state with a mean photon number equal to the target value @xmath68 .",
    "the phase of this field is used as a reference . as a consequence ,",
    "its amplitude @xmath69 is real .",
    "the phase @xmath20 and the operator @xmath70 , defining the measurement super - operators @xmath71 through , should be adjusted to optimize the quantum filter  .",
    "on the one hand , the mean dephasing angle per photon @xmath72 ( estimated in the useful range of @xmath16 values ) should be large in order to resolve adjacent photon numbers .",
    "on the other hand , the measurement should lift the ambiguity between a large range of possible photon numbers from @xmath73 to some @xmath74 , determined by the spread of the initial coherent field . due to the oscillating nature of the measurement operators",
    "@xmath27 , this sets a maximum value of @xmath72 of the order of @xmath75 .",
    "finally , we need to optimally distinguish @xmath68 from @xmath76 .",
    "this is achieved by setting the ramsey phase @xmath20 so that @xmath77 .",
    "this setting corresponds to a maximal variation of the atomic state detection probabilities around @xmath68 . in other words , we set the atomic ramsey interferometer at mid - fringe when the cavity contains @xmath68 photons",
    ".      the distance between @xmath78 and the target fock state described by a density operator @xmath79 can be conveniently defined  as @xmath80 where @xmath81 is the fidelity of a state @xmath82 with respect to the target state @xmath83 .",
    "the function @xmath84 represents a natural choice for the lyapunov function @xcite used to study the stability properties of the quantum controller .",
    "this study is presented in more detail in ref .",
    "@xcite .",
    "let us denote the cavity state after the control displacement in the @xmath85 iteration of the feedback loop as @xmath86 .",
    "the optimal convergence of the feedback procedure is obtained by finding at each cycle the injection amplitude @xmath87 which maximizes the fidelity @xmath88 .",
    "this search can be performed in a straightforward way by numerical optimization . however , this approach is time - consuming and could not be realistically implemented with existing real - time data analysis systems in the few tens of microseconds time interval between two atomic detections .",
    "we overcome this difficulty by developing a faster , analytical calculation of a locally optimal displacement @xmath87 .",
    "since the measurement operators , the initial density matrix and the projector on the target fock state are all real operators , we can reasonably choose @xmath87 to be real .",
    "the field density matrix then remains always real .    in the limit of small @xmath37",
    ", the baker - campbell - hausdorff formula @xcite yields the following approximation for a displaced state : @xmath89\\notag\\\\ & +          \\frac{\\alpha^2}{2}[[\\rho , a^\\dag - a],a^\\dag - a ] .",
    "\\end{aligned}\\ ] ] using  , we therefore get for small @xmath87 @xmath90{\\rho_{\\text{\\tiny tag}}}\\right ) } \\\\",
    "+ \\frac{\\alpha_k^2}{2}{\\text{tr}\\left([[{\\rho_{k}},a^\\dag\\!-\\!a],a^\\dag\\!-\\!a]{\\rho_{\\text{\\tiny tag}}}\\right)}\\ , .",
    "\\end{gathered}\\ ] ] choosing the feedback amplitude as @xmath91{\\rho_{\\text{\\tiny tag}}}\\right)},\\ ] ] with a gain @xmath92 small enough ensures that @xmath93 as soon as the trace in is strictly positive .",
    "furthermore , since @xmath94=[{\\rho_{\\text{\\tiny tag } } } , m_e]=0 $ ] and @xmath95 , the conditional expectation of @xmath96 knowing @xmath97 is given by @xmath98 therefore @xmath99 and , as a result , the expectation value of @xmath100 is a non - decreasing function of @xmath53 : @xmath101    we have only shown so far that @xmath100 is increasing on the average .",
    "it does not mean that , for _ all _ individual realizations of the loop sequence , @xmath100 converges to 1 , its maximum value reached when @xmath82 is equal to @xmath83 .",
    "indeed , the feedback law does not prevent the convergence towards other fock states , since @xmath102 whenever @xmath78 is the projector on any photon number state .",
    "a careful analysis shows that , in each realization , @xmath100 converges either to 1 or , with some small probability , to zero . to overcome this spurious attraction towards wrong photon number states , we propose , as in @xcite , to modify the feedback law   by applying a constant injection",
    " kick \" as soon as the cavity state significantly deviates from the target : @xmath103{\\rho_{k}}\\right ) }      & \\mbox { if } f(\\rho_{k } ) \\geq \\varepsilon,\\\\          \\\\",
    "c_2\\ , \\text{sign}\\left ( { n_{\\text{\\tiny tag}}}\\!- n_{k}\\right ) & \\mbox { if } f(\\rho_{k } ) <     \\varepsilon .",
    "\\\\          \\end{array }          \\right.\\ ] ] here , @xmath104 is the mean photon number in the current state @xmath78 , @xmath105 is a constant kick amplitude .",
    "the kick condition is set by @xmath106 with @xmath107 . in this way , by breaking attraction towards other fock states , we make sure that the cavity state converges towards the target one .",
    "the controller gain @xmath108 in must be tuned to maximize fidelity @xmath88 at each sampling time @xmath53 . up to third - order terms in @xmath109 , eq .",
    "yields @xmath110{\\rho_{k}}\\right)}\\!\\big)^2 \\left ( c_1\\ ! -\\ ! \\frac{c_1",
    "^ 2}{2 }              { \\text{tr}\\left([{\\rho_{\\text{\\tiny tag}}},a^\\dag\\!-\\!a]^2\\right)}\\!\\right)\\!.      \\end{gathered}\\ ] ] by maximizing this expression , we find that the gain @xmath111 ^ 2\\right)}^{-1}\\ ! = ( 4{n_{\\text{\\tiny tag}}}\\!+2)^{-1}\\ ] ] provides the fastest convergence speed in the vicinity of @xmath83 . a detailed mathematical analysis and a convergence proof of this feedback - scheme",
    "will be given in @xcite .      .",
    "( a ) atomic states detected at each feedback cycle .",
    "( b ) control injections @xmath87 .",
    "( c ) evolution of photon number probabilities @xmath112 , @xmath113 and @xmath114 shown as dashed - dot blue , solid green and dashed red curve , respectively .",
    "( d ) average over @xmath115 closed - loop quantum trajectories.,scaledwidth=47.0% ]    [ fig : meanideal ]    to assess the performance of the proposed feedback scheme , we have performed quantum monte - carlo numerical simulations .",
    "figure  [ fig : trajideal](a)-(c ) presents a single quantum closed - loop trajectory in the ideal measurement setting , with a target fock state @xmath116 .",
    "the hilbert space is limited to @xmath117 photons .",
    "the atom - cavity detuning is set to @xmath118  khz .",
    "the mean dephasing angle per photon around @xmath68 is then about @xmath119 .",
    "intuitively , the ramsey phase @xmath20 should be set at the mid - fringe setting for @xmath68 photons , i.e. , @xmath120 .",
    "we have numerically observed that the convergence of the process is faster when the ramsey phase alternates between four values in successive feedback cycles : @xmath121 , @xmath122 , @xmath121 and @xmath123 .",
    "the phase excursion @xmath124 is set at @xmath125  rad .",
    "the kick amplitude @xmath126 is 0.1 with a kick zone defined by @xmath127 .",
    "the initial cavity field @xmath128 is the coherent state with 3 photons on the average , @xmath129 .",
    "the upper trace in fig .  [ fig : trajideal ] shows a sequence of detected atomic state .",
    "the corresponding control inputs @xmath87 are plotted in the next panel .",
    "large at the beginning , @xmath87 rapidly converges towards zero .",
    "figure  [ fig : trajideal](c ) shows the probability for the number of photons in the cavity field to be smaller , equal or larger than @xmath68 ( dashed - dot blue , solid green and dashed red curve , respectively ) . for this particular quantum trajectory , we observe that @xmath82 converges to @xmath83 in less than @xmath130 feedback cycles .",
    "figure  [ fig : meanideal](d ) presents an ensemble average over @xmath115 realizations of the same numerical feedback experiment .",
    "the fidelity @xmath100 reaches values above @xmath131 after @xmath132 cycles .",
    "after 20 cycles only , about @xmath133 of the trajectories have converged to the target state , illustrating the efficiency of the feedback method .",
    "so far , we have neglected experimental imperfections . in this section ,",
    "we take into account all known imperfections of the present experimental set - up : finite cavity lifetime , poisson distribution of the atom number in atomic samples , non - ideal efficiency and state - selectivity of the detector and , finally , the finite delay between atom - cavity interaction and atomic detection .",
    "below , we introduce modifications of the quantum filter  , which make the process efficient in spite of these imperfections .",
    "the quantum filtering process must provide us with a density matrix describing all our knowledge of the cavity field at a given time .",
    "we chose here this time to be right before the injection of the actuator pulse in the @xmath85 iteration of the loop , after detection of the @xmath85 atom . at this time",
    ", our knowledge includes all atomic measurements so far ( from 1 to @xmath53 ) , all displacements performed and the known relaxation of the cavity field in between these events .",
    "it must also include the influence of the @xmath134 atomic samples which have interacted with the cavity , but are still flying towards the detector when we record atomic sample @xmath53 .",
    "all this information can , as above , be represented by super - operators acting on the field s density matrix .",
    "let us note @xmath135 the super - operator describing the detection of an atomic sample .",
    "each detection has three possible outcomes , labelled @xmath136 , @xmath137 or @xmath138 ( atom detected in @xmath66 , @xmath137 or no detected atom at all ) .",
    "the super - operator @xmath139 describes the action of one of the @xmath134 atomic samples flying from @xmath7 to @xmath4 .",
    "the displacement super - operator @xmath140 is given by and the field relaxation during the time interval between atomic samples is described by @xmath141 .",
    "the exact expressions of all these super - operators will be given later .",
    "therefore , the state of the cavity field before injection  is @xmath142 where @xmath143 includes the information gathered by the first @xmath53 sample detections and @xmath144 includes the influence of the @xmath134 in - flight samples .",
    "note that due to the atomic propagation delay between @xmath7 and @xmath4 , the displacement amplitude injected in @xmath7 right after atomic sample @xmath58 has interacted with it is @xmath145 , computed in the @xmath146-th iteration of the loop .",
    "hence , the first @xmath134 atomic samples cross the cavity before any displacement .",
    "this is formally taken into account by setting @xmath147 to unity for non - positive indices . if @xmath50 , i.e.  for no delay in the detection process , the empty product in equals by convention the identity operator .",
    "consequently , in the case of the ideal experimental parameters , the expression naturally reduces to .",
    "the density operator @xmath148 is used in the feedback law to calculate the control injection @xmath149 .",
    "the product @xmath150 can be easily computed recursively , as in the ideal case .",
    "however , we must recalculate @xmath151 at each feedback cycle .",
    "we now give the explicit expression of all super - operators considered so far .",
    "the measurement process @xmath135 takes into account detector s imperfections and non - ideal atomic source .",
    "if the detector clicks and indicates state @xmath152 or @xmath153 , the new quantum state is a statistical weighted mixture of two projected states .",
    "the strongest weight corresponds to the projection according to the recorded outcome . with a smaller probability",
    ", the atomic detection has been erroneous .",
    "the atom was , at detection time , in the state @xmath154 , opposite to @xmath35 , and the field has been projected accordingly .",
    "thus , due to the imperfections of state discrimination alone , we get @xmath155 the weights of the two projected states are given by the conditional probability of a wrong detection knowing that the detector has clicked in @xmath156 : @xmath157 with @xmath158 .",
    "if the detector does not click ( outcome @xmath159 ) , either there was no atom in the sample or an atom was present but has not been detected .",
    "therefore , the estimated state is a mixture of the unperturbed cavity field and of the two projected states corresponding to the two possible states of the undetected atom ( we assume here that these two states are equiprobable ) .",
    "we thus get @xmath160 the weights in this mixture are set by the conditional probability to have an undetected atom in a sample : @xmath161 .",
    "the interaction with a not - yet - detected sample is described by the super - operator @xmath139 .",
    "it is given by with the conditional probability @xmath162 replaced by the atomic sample occupation probability @xmath163 , since the measurement has not been performed yet , resulting in @xmath164    the super - operator @xmath141 describes the evolution due to the cavity field relaxation during the time interval @xmath165 between two atomic samples . using in the approximation of small time interval , @xmath166",
    ", we get @xmath167      .",
    "( a ) sequence of detected atomic states .",
    "( b ) control injections @xmath87 .",
    "( c ) evolution of the photon number probabilities @xmath112 , @xmath113 and @xmath114 ( dashed - dot blue , solid green and dashed red curve , respectively ) of the field state @xmath168 deduced from the monte - carlo simulation . the thin black line gives the estimated state fidelity @xmath169 .",
    "( d ) photon number probabilities for @xmath170 to @xmath171 in @xmath168 . for better clarity",
    ", results of only one out of each 10 feedback cycles are shown .",
    "( e ) average over @xmath115 closed - loop quantum trajectories .",
    "if the number of quantum trajectories is large enough ( as is the case here ) , the averaged photon number probabilities calculated from the real field states @xmath168 coincide with those averaged over the estimated states . , scaledwidth=45.0% ]    [ fig : meanreal ]    we have performed extensive simulations , similar to those of the idealized measurement in fig .",
    "[ fig : trajideal ] , with the feedback algorithm adapted to the realistic experimental parameters , given in sec .",
    "we use monte - carlo simulations to follow the state of the cavity along individual realizations of the experiment .",
    "the field relaxation is taken into account by simulating random quantum jumps , whose average effect is described by eq .",
    "@xcite . for each atomic sample , we choose randomly the number of atoms ( @xmath73 or @xmath172 ) and the real atomic state ( @xmath10 or @xmath11 ) which would be detected by the ideal detector .",
    "these results determine uniquely the subsequent field state @xmath173 .",
    "we then take into account the detection imperfections to simulate the outcomes of the realistic measurement , which are used in the feedback loop for computing @xmath148 .",
    "note that @xmath168 is not accessible in the experiment .",
    "here , we use it to simulate the evolution of the field and , by comparing it with the state estimated in the quantum filtering process , to characterize the feedback performance . in the ideal case , considered in sec .",
    "[ sec : ideal ] , the estimated state @xmath148 always coincide with the real state of the field @xmath173 .",
    "figure  [ fig : trajreal](a)-(d ) shows a typical quantum trajectory , illustrating the robustness of our feedback scheme at the present level of imperfections .",
    "the first difference with the ideal case is the presence of many feedback cycles with no detected atoms .",
    "nevertheless , after about @xmath174 feedback cycles ( each of @xmath175s duration ) , corresponding to approximatively @xmath176 atoms and @xmath177 detector clicks , the cavity state successfully converges to the target fock state  @xmath178 .",
    "the other striking feature is the presence of sudden photon jumps due to the limited cavity lifetime . in this particular trajectory ,",
    "a photon loss occurred at feedback cycle number @xmath179 ( at about 37  ms ) .",
    "one sees that about 60 cycles ( about 5  ms ) are required to detect the jump before applying a large control displacement and about 60 more cycles to restore the target photon number in the cavity field .",
    "( blue solid curve ) and of the state estimated by the quantum filtering process @xmath148 ( red dashed curve ) are defined with respect to the target fock state and are obtained by averaging over @xmath115 quantum trajectories . in each trajectory ,",
    "the time origin is shifted to the time of a quantum jump.,scaledwidth=48.0% ]    figure  [ fig : meanreal](e ) shows the same type of ensemble average as presented in fig .",
    "[ fig : meanideal](d ) .",
    "we observe a convergence towards a fidelity of @xmath180 after several hundred cycles resulting in about 100 detector clicks .",
    "this convergence , given as the number of actually detected atoms , is similar to that observed in the ideal case .",
    "the main difference between the two traces is the reduced asymptotic value of the fidelity of the prepared state : @xmath181 instead of @xmath182 in the ideal case .",
    "this reduction is mainly due to the cavity decay , which results in uncontrolled jumps of the photon number .",
    "the observed fidelity indicates that for a typical closed - loop trajectory the field stays in the state @xmath183 about @xmath184 of time .",
    "since the lifetime of @xmath185 is given by @xmath186  ms @xcite , we estimate that it takes on the average 26  ms to restore the initial fock state after a sudden jump .    in order to observe in more detail the recovery of the system after a sudden photon jump",
    ", we recorded @xmath115 quantum trajectories showing sudden photon losses at different times . before averaging the trajectories , we shift their individual time origins to the time of a jump .",
    "figure  [ fig : fidelityafterjump ] shows the evolution of the fidelity of the actual ( solid curve ) and estimated ( dashed curve ) cavity states with respect to @xmath83 . as calculated before , it takes about @xmath187  ms to restore the initial photon number state after a sudden photon loss .",
    "the maximum fidelity of the quantum feedback , seen in figs .",
    "[ fig : meanreal]-[fig : fidelityafterjump ] and corresponding to the ensemble of many realizations , shows how well a chosen photon number state can be preserved on average from its unavoidable decay .",
    "however , since in each feedback cycle we acquire actual information on the field , the fidelity of the deterministic generation of fock states in a single realization can be much higher . to reliably produce the target state @xmath83 we keep the feedback process running until we detect its successful convergence to @xmath83 with an estimated fidelity better than @xmath188 .",
    "figure [ fig : success](a ) shows a histogram of convergence times for @xmath189 obtained from @xmath115 quantum trajectories .",
    "the cumulative distribution , presented by a solid line , shows that after 20  ms the probability of a successful feedback outcome reaches @xmath190 and that it exceeds @xmath191 after 85  ms of the feedback operation .",
    "the inset in fig .",
    "[ fig : success](a ) shows the average density matrix of converged states with the population in @xmath185 of about @xmath192 .    .",
    "the solid line gives the probability of the feedback convergence after a given time .",
    "the inset shows the average density matrix of the converged states .",
    "( b ) convergence for several different fock states .",
    "these curves result from an average over @xmath115 quantum trajectories.,scaledwidth=48.0% ]    our feedback scheme can be tuned to generate any small photon number states .",
    "figure [ fig : success](b ) illustrates the convergence for several fock states from latexmath:[$|{n_{\\text{\\tiny tag}}}\\rangle =    @xmath68 , the initial photon number distribution gets broader as the photon number lifetime gets shorter .",
    "therefore , the feedback performance slowly degrades , resulting in the increased convergence time for the same required fidelity  @xmath188 .",
    "implementation of this quantum feedback scheme into a real experiment requires fast real - time analysis of the measured data , faster than duration @xmath165 of one feedback cycle .",
    "we have tested a real - time processing system @xmath194 ( jger messtechnik ) allowing for fast data acquisition and analysis in combination with complex experiment control . after careful optimization of all feedback computations",
    ", the execution of one typical feedback cycle of the proposed scheme requires about 4000 floating - point operations .",
    "our preliminary tests have revealed that the adwin system needs for this task about @xmath195s .",
    "we are now working on the integration of this control system into our cavity qed set - up .",
    "we have presented a quantum feedback protocol designed to deterministically generate small photon number states of a trapped microwave field .",
    "the reliable estimation of the cavity state at each feedback cycle allows us to follow in real time the quantum jumps of the photon number and then to efficiently compensate them , thus protecting fock states against decoherence .",
    "the two main components of the feedback algorithm are the quantum filter , which estimates the actual state of the field based on the outcomes of qnd measurements , and the feedback law computing the amplitude of a correction microwave pulse whose injection into the cavity mode maximizes the field fidelity with respect to a desired fock state .",
    "quantum monte - carlo simulations of the qnd measurements and the quantum feedback response demonstrate the high reliability of our closed - loop scheme even in the presence of realistic experimental imperfections .",
    "this scheme is also robust with respect to an imprecise knowledge of the initial state , since the repeated measurements of the state corrects initial wrong or incomplete information .",
    "convergence and stability proofs of these feedback schemes will be given elsewhere .",
    "for a first set of mathematical results , see ref .",
    "@xcite .",
    "the presented scheme can be extended to include the ramsey phase @xmath20 and the spin dephasing @xmath70 as additional control parameters of the feedback loop .",
    "this should help to optimize the qnd measurement according to our estimate of the actual field state and thus to acquire more information on its dynamics .",
    "these studies are under the way .",
    "+ * acknowledgements * work supported partially by agence nationale de la recherche ( projet anr-05-blan-0200 - 01 and projet blanc cquid 06 - 3 - 13957 ) , japan science and technology agency ( jst ) and eu ( ip project scala ) ."
  ],
  "abstract_text": [
    "<S> we propose a quantum feedback scheme for the preparation and protection of photon number states of light trapped in a high-@xmath0 microwave cavity . </S>",
    "<S> a quantum non - demolition measurement of the cavity field provides information on the photon number distribution . </S>",
    "<S> the feedback loop is closed by injecting into the cavity a coherent pulse adjusted to increase the probability of the target photon number . </S>",
    "<S> the efficiency and reliability of the closed - loop state stabilization is assessed by quantum monte - carlo simulations . </S>",
    "<S> we show that , in realistic experimental conditions , fock states are efficiently produced and protected against decoherence . </S>"
  ]
}