{
  "article_text": [
    "the generation of pure nonclassical states of light is one of the most important goals of optical quantum information science @xcite .",
    "a popular and versatile source of nonclassical light is spontaneous parametric down - conversion ( spdc ) @xcite  a nonlinear process that converts high - energy photons into pairs of lower energy photons .",
    "spdc has been employed in the generation of squeezed light @xcite , schrdinger kitten states @xcite and entangled photons @xcite , and is the most widely used technique for generating single photons @xcite .",
    "sources based on spdc have widespread application in quantum computation @xcite , quantum communication @xcite , and quantum metrology @xcite , as well as in more specialized areas such as quantum imaging @xcite , quantum lithography @xcite , or optical coherence tomography @xcite .",
    "the ability to control the characteristics of quantum states of light becomes increasingly important as these applications mature .",
    "in general , photon pairs generated via spdc are correlated in frequency and are described by a _ joint spectral amplitude _",
    "( jsa ) , which is determined by the properties of the incident pump field and the material properties of the nonlinear crystal used to mediate the down - conversion process . in this paper",
    ", we focus on controlling the _ spectral _ properties of down - conversion sources .",
    "one particularly challenging but important application of spectral shaping is in the production of single photons , which are generated from spdc photon - pair sources through a heralding process , whereby the detection of one photon heralds the presence of the other .",
    "spectral correlations between the photons degrade the spectral purity of heralded photons and are therefore undesirable .    the simplest method for modifying the jsa s shape is filtering , which can reduce spectral correlations .",
    "but because it introduces a spectrally dependent loss which acts on the individual photons independently , spectral filtering can degrade the quantum state s photon - number purity @xcite .",
    "more sophisticated methods involve shaping the spectrum at the source using techniques such as quasi - phasematching ( qpm ) @xcite . because such methods act on both photons in a pair simultaneously",
    ", they do not affect the quantum state s photon - number purity .",
    "qpm can be achieved through a technique known as periodic poling , where the nonlinear medium is constructed from individual domains of birefringent material with alternating orientation , see fig . 1",
    ". chirped gratings have been employed for pulse compression in second - harmonic generation , as well as the generation of ultrabroad - spectrum , top - hat shaped photons for optical coherence tomography @xcite .",
    "correlations in the jsa can be reduced by using periodic poling in conjunction with group - velocity matching @xcite , however , the extent to which spectral separability can be achieved is limited by the crystal s inherent sinc - type phasematching function , which manifests itself in the jsa as undesirable diagonal side - lobes , see fig 2 a ) .    , has units of rad / m . ]",
    "[ fig : schematic ]    a technique for shaping the phasematching function using nontrivial qpm was proposed by braczyk _",
    "@xcite , who showed that modulation of the nonlinearity profile of a down - conversion crystal can drastically reduce side lobes in the jsa . in this method ,",
    "a discretized approximation to the desired nonlinearity profile was achieved using higher - order poling .",
    "@xcite proposed an alternative method for spectral decorrelation , in which the crystal s duty - cycle pattern is customized while the grating period is fixed .",
    "in this paper , we introduce a method in which we directly manipulate the domain orientations while keeping their widths fixed ( fig .",
    "1 , bottom ) . in contrast with the methods proposed in @xcite ,",
    "our method allows almost arbitrary shaping of the phase - matching function , which provides flexibility in designing the maximum nonlinearity for a given phase - matching function width .",
    "furthermore , in contrast with the method in @xcite , we fix the width of each domain in the grating , which preserves the phase - matching properties of the crystal  a stringent requirement in many experiments .",
    "while we focus on correlations in the spectral domain , spatial correlations also exist and similar concepts have been discussed in @xcite .",
    "the spdc process mediates the conversion of high - energy pump photons in mode @xmath0 into pairs of lower energy photons in modes @xmath1 and @xmath2 .",
    "this process satisfies energy and momentum conservation according to : @xmath3 and @xmath4 , where @xmath5 is the frequency in mode @xmath6 , and @xmath7 is the wave vector associated with the polarization of mode @xmath6 , evaluated at frequency @xmath8 .    theoretically , the two - photon state generated via spdc can be described by @xcite @xmath9 where @xmath10 is a one - photon fock state of frequency @xmath11 prepared in mode @xmath6 .",
    "the jsa , @xmath12 , characterizes the joint spectrum of the two photons .",
    "the spectral properties of downconverted photons can be manipulated via the pump beam spectral amplitude function @xmath13 and the phase - matching function @xmath14 .",
    "the jsa _ can not _ , in general , be factorized into a product of separable single - photon spectral amplitudes , @xmath15 , however , it can always be decomposed into a weighted sum of separable single - photon spectral amplitudes , @xmath16 , known as the schmidt decomposition .",
    "the functions @xmath17 and @xmath18 each form a discrete basis of complex orthonormal functions and the schmidt coefficients @xmath19 are real and satisfy @xmath20 if @xmath21 is normalized .    in terms of the schmidt decomposition",
    ", the downconverted state can be written as @xmath22 where @xmath23 and @xmath24 .",
    "the degree of correlation of a pure bipartite state , i.e. , entanglement , can then be characterized by the entropy of entanglement @xcite . in terms of the schmidt coefficients ,",
    "this is given as @xmath25 .",
    "for a completely decorrelated jsa , the schmidt decomposition contains only one term , i.e. , @xmath26 , and the entropy of entanglement is @xmath27 .",
    "consider any pure entangled bipartite state",
    ". the reduced density matrix of either subsystem will necessarily be mixed .",
    "the archetypical example of this is the bell state  a bell state is maximally entangled , and thus , the subsystems are maximally mixed .    similarly , spectral correlations in the bi - photon spectral amplitude will necessarily reduce the spectral purity of the individual photons . consider the state in eq ( [ eq : schmidt ] ) . given detection of a single photon in mode @xmath2 by a detector that does not provide any spectral information , the single - photon state in mode @xmath1",
    "can be written as @xmath28 .",
    "the purity of the reduced density matrix is given by @xmath29=\\sum_{k}{b}_{k}^4 $ ] .",
    "if the schmidt decomposition has only one non - zero schmidt coefficient , @xmath30 is a pure state and @xmath31 . to increase the purity of the heralded photon",
    ", one should therefore aim to reduce correlations such that the schmidt decomposition has only one non - zero schmidt coefficient .",
    "group - velocity - matching reduces jsa correlations by orienting the functions @xmath14 and @xmath32 perpendicular to each other and matching their widths as closely as possible .",
    "this occurs when the group velocities satisfy @xmath33 , where @xmath34 and @xmath35 are the central frequencies @xcite .",
    "experiments in this regime typically employ a periodically - poled crystal which leads to a sinc - type phase - matching function that manifests itself in the jsa as undesirable diagonal side - lobes . in this paper , we focus on directly shaping the phase - matching function to remove the side lobes , thus increasing the separability of the joint spectral amplitude .",
    "the phase - matching function is related to the nonlinearity profile of the crystal via the fourier transform @xcite @xmath36 where @xmath37 is the crystal length , @xmath38 represents the nonlinear optical coupling , and where phase matching within the crystal can be described by the phase - mismatch @xmath39 .",
    "we will use @xmath40 as shorthand for @xmath41 .    in principle",
    ", an arbitrary @xmath14 could be realized with appropriate design of the crystal s nonlinearity profile such that it corresponds to the fourier transform of the desired phase - matching function .",
    "unfortunately , it is non - trivial to directly change the material properties of a nonlinear crystal , and different methods must be used .    consider a nonlinear medium composed of @xmath42 domains of birefringent material of length @xmath43 , where each domain can be oriented either _ up _ or _",
    "down_. a flip in the orientation of the domain introduces a phase shift of @xmath44 .",
    "the nonlinearity profile @xmath38 in such a crystal is a discontinuous function that only takes on values of @xmath45 .",
    "the phase - matching function for the entire crystal is a linear superposition of phase - matching functions for individual crystal domains : @xmath46 where @xmath47 accounts for the phase shift due to the orientation of the domain and @xmath48 specifies the origin of the @xmath49th domain .",
    "the special case , where @xmath50 , corresponds to a periodically poled crystal . in this case , constructive interference near the point @xmath51 , where @xmath52 is the poling period , produces a phase - matching function that approximates @xmath53    since , in principle , the domains can take on other configurations , a natural question to consider is whether the phase - matching function can be tailored by manipulating the relative orientations of the individual domains in a non - trivial way .",
    "this was demonstrated by braczyk _",
    "@xcite , where the authors designed and experimentally verified a gaussian phase - matching function for a 1 cm potassium titanyl phosphate ( ktp ) crystal with . but the design in @xcite was specific to a particular set of parameters , and can not easily be generalized .    in this paper , we introduce a _ general _",
    "technique for optimizing the domain orientations in order to achieve a desired phase - matching function .",
    "since periodically poled crystals are optimized for source brightness ( around a specific centre frequency ) , a custom poled crystal will necessarily generate fewer pairs compared to a periodically poled crystal of the same length pumped with the same pump .    in the next section ,",
    "we describe the algorithm used for this optimization .",
    "the task of finding an optimal domain configuration is formulated in terms of discrete optimization .",
    "the variables are the @xmath42 possible domain orientations @xmath54 , constrained as @xmath55 and the solution space consists of @xmath56 possible crystal configurations .",
    "neighbour configurations are defined as those which differ by exactly one domain orientation .",
    "since there are @xmath42 domains which could be flipped , any particular configuration has @xmath42 neighbours .",
    "each domain configuration @xmath57 has a corresponding nonlinearity profile , with a phase - matching function @xmath58 given by the fourier transform of this nonlinearity profile .",
    "the task is to find the crystal alignment @xmath59 which yields a @xmath60 closest to some target function , @xmath61 , on a specified range @xmath62 $ ] .",
    "we define a cost function @xmath63 as a measure of the distance between @xmath58 and @xmath61 .",
    "this distance is measured by selecting sufficiently many , say @xmath64 , points @xmath65 in the range @xmath62 $ ] . the objective is to minimize @xmath66 .",
    "because @xmath42 will typically range from approximately one hundred to a few thousand , the solution space is too large to check each possible configuration with currently available computing resources .",
    "it is also not convex , meaning that there exist configurations which are locally optimal  that is , each neighbour is a worse configuration  but not globally optimal ; one can not simply move from neighbour to neighbour , always selecting the better configuration .",
    "we solve this problem by using simulated annealing @xcite , a method which accepts worse configurations with a decaying probability @xmath0 , and better configurations with some probability @xmath67 that is close to @xmath68 .",
    "starting with either a random or preselected domain configuration , the algorithm iterates through randomly - chosen neighbour configurations , deciding whether to flip a given domain or not .",
    "if @xmath69 is the current configuration , and @xmath70 is a neighbour configuration being considered , then when @xmath71 , the algorithm moves to ( worse ) @xmath70 with probability @xmath72 at iteration @xmath73 ; however , when @xmath74 , the algorithm moves to ( better ) @xmath70 with probability @xmath67 .",
    "the probability of accepting a worse configuration at iteration @xmath73 is given by @xmath75 , where @xmath76 is a decaying function known as the ` heat function ' ( in analogy with physical annealing ) , and @xmath77 is roughly the number of domains explored before the algorithm would hit a local minimum if @xmath72 were set to zero .",
    "the heat function is chosen to be @xmath78 , where @xmath79 is the total number of iterations .    finally , we use @xmath80 , determined heuristically .",
    "any number close , but not equal to @xmath68 tends to give good results .",
    "parameters @xmath67 and @xmath77 can be adjusted further to improve performance of the algorithm .",
    "after @xmath79 iterations , the algorithm performs an additional optimization by systematically sweeping through the crystal ( say , from left to right ) , flipping each domain and only keeping the new configuration if @xmath74 .",
    "the algorithm stops when an entire sweep does not reduce the cost function .",
    "the algorithm is probabilistic , and may therefore occasionally yield an unsatisfactory solution .",
    "this can be ruled out by running the algorithm several times and comparing the results .",
    "the solutions are not unique , in that different configurations can yield the same value of the cost function .      here , we provide some rules of thumb for selecting input parameters .",
    "we imagine a situation where the experimenter knows the desired target function @xmath61 and wants to choose the crystal parameters @xmath43 and @xmath37 appropriately for best performance of the algorithm .",
    "if these parameters are chosen arbitrarily , the algorithm will still find an optimized solution , however , this solution may not be sufficiently close to the desired function .    a good value for the parameter @xmath43 can be determined by identifying the peak of the desired phase - matching function , let s call it @xmath81 , and setting @xmath82 ( if there is no identifiable peak , @xmath83 can be chosen to be a point in the range @xmath62 $ ] ) .",
    "the parameter @xmath42 should be chosen large enough , such that the fourier transform of @xmath61 has strong support in the range @xmath84 $ ] , but not much larger .",
    "when inputting the phase - matching function into the algorithm , the height of @xmath61 should be between 0 and @xmath85 . the ideal height  that is , the height for which the algorithm performs best  seems to have a non - trivial dependence on @xmath42 and @xmath43 , as well as the form of the target function .",
    "however , the dependence is nt overly sensitive : a deviation of @xmath86 from the ideal height still works very well .",
    "it is relatively simple to identify the ideal height through trial and error .",
    "in this section , we primarily consider the task of engineering a gaussian phase - matching function for the purpose of generating pure heralded single photons , and compare our method to existing methods .",
    "we also demonstrate that the algorithm can be used to approximate other phase - matching functions of interest .",
    "recall that spectral correlations between two down - converted photons necessarily reduce the spectral purity of the individual photons . here",
    ", we show how to dramatically reduce jsa correlations by designing a crystal with a gaussian phase - matching function .    for a poled ktp crystal in the type - ii configuration",
    ", group - velocity matching can be achieved for a crystal with @xmath87 , pumped with a @xmath88 laser . in our example",
    ", we will work with a pump laser of bandwidth @xmath89 .",
    "we first consider a standard periodically poled crystal . for maximal decorrelation",
    ", the width of the phase - matching function should match the width of the pump function , which can be achieved with a periodically poled crystal with @xmath90 domains .",
    "figure 2 a ) shows this crystal s phase - matching function , corresponding joint spectral amplitude , and schmidt coefficients .",
    "notice that the side lobes that arise from the sinc profile of the phase - matching function admit some correlations between the two photons , resulting in a heralded photon purity of @xmath91 .",
    "next , we consider a crystal with a customized duty cycle . choosing the duty cycle",
    "appropriately can drastically reduce the side lobes , as demonstrated by dixon _",
    "@xcite , see figure 2 b ) .",
    "since modifying the duty cycle broadens the phasematching function , we reduce broadening by increasing the number of domains to @xmath92 to ensure that the widths of the phase - matching and pump functions match . modifying",
    "the duty cycle also shifts the phasematching function , which can be offset by decreasing @xmath93 , but since this has no effect on the spectral purity , we do not compensate for this .",
    "customizing the crystal s duty cycle increases the heralded photon s purity to @xmath94 .    finally , we consider the technique proposed in this paper in which the domain configuration is customized .",
    "the technique relies on nontrivial interference between the fields in the crystal to generate a customized phase matching function . in section [ sec : app ] , we described how to choose an appropriate @xmath42 for a given phase matching function .",
    "the phase matching function that matches the width of the @xmath95 pump calls for @xmath96 domains .",
    "note that this @xmath42 is optimized and increasing the number of domains does not increase the performance of the algorithm , but rather degrades it . in figure 2 c ) , we see that for the optimized custom - poled crystal , the side lobes are almost entirely absent and the purity of the heralded photons is increased to @xmath97 .",
    "the algorithm optimizes the phase - matching function within the range @xmath62 $ ] , which may result in a non - zero joint - spectral amplitude immediately outside the corresponding frequency range .",
    "since photon - number impurities are only introduced when the filter has non - zero or non - unit transmission in a region of non - zero amplitude , these frequencies can be safely filtered out without compromising the photon - number purity , provided they are sufficiently far from the central peak .    the technique introduced by braczyk _",
    "@xcite , which showed that a purity of up to @xmath98 can be achieved by modulating the crystal nonlinearity using higher - order poling , was demonstrated for specific @xmath99 , @xmath93 , and @xmath42 , and is not readily adaptable to other regimes for direct comparison .      .",
    "we note that sharp edges make the top - hat function very difficult to approximate with a decomposition of smooth functions . for comparison with other methods , see @xcite . ]    [ fig:3 ]    the simulated annealing technique can also be used to approximate other phase - matching functions of interest . here",
    ", we demonstrate this for phase - matching functions with triangular and rectangular profiles .",
    "figure 3 a ) shows a triangular phase - matching function , generated with an initial configuration of @xmath100 randomly oriented domains .",
    "the algorithm used @xmath101 iterations , with @xmath80 and @xmath102 , and samples to compute the objective function @xmath66 , over the range @xmath62=[2\\pi(1 - 0.005)\\lambda,2\\pi(1 + 0.005)\\lambda]$ ] .",
    "the height of the target function was @xmath103 .    due to the sharp edges of a rectangular function , the number of domains needed to produce a reasonable approximation was higher . to generate the phase - matching function shown in figure 3 b ) , we increased the number of domains to @xmath104 .",
    "we then ran the algorithm with @xmath105 iterations , using @xmath106 .",
    "the height of the target function was @xmath107 .",
    "all other parameters were the same as for the triangle .",
    "we proposed a technique for shaping the phase - matching profile of a pair of downconverted photons by exploiting non trivial interference inside a custom poled crystal .",
    "our method can be used to approximate profiles of interest , e.g. those with gaussian , triangular and rectangular profiles . in particular ,",
    "gaussian phase matching functions are desirable as they can decorrelate the jsa of downconverted photons .",
    "because it eliminates the need for spectral filtering , which reduces the purity of a downconverted squeezed state as a function of the pump power @xcite , our technique may facilitate the creation of purer multi - photon states for quantum information processing , e.g. heralded fock states with high photon number .",
    "recent work by quesada and sipe @xcite shows that the joint spectrum for higher fock states can differ from that of single - photon pairs",
    ". it would be interesting to apply our technique in this regime .",
    "it might also be possible to apply our technique to the optimization of the entire joint spectral amplitude , rather than just the phase - matching function , as was shown by phillips _",
    "while simulated annealing was sufficient for solving the present problem , more sophisticated algorithms , such as genetic algorithms , might be necessary for further extensions .",
    "we also expect our technique to have applications in classical nonlinear optics , such as second harmonic generation , where similar spectral shaping techniques have been demonstrated @xcite .",
    "amb thanks alessandro fedrizzi , michele mosca , thomas stace and phillip vetter for interesting discussions .",
    "we thank ben dixon for providing thoughtful comments on our manuscript .",
    "we also thank marc burns for suggesting ways to optimize our code .",
    "ad acknowledges financial support from the institute for quantum computing undergraduate research program . this research was supported in part by perimeter institute for theoretical physics .",
    "research at perimeter institute is supported by the government of canada through industry canada and by the province of ontario through the ministry of research and innovation .",
    "lc acknowledges support from the john templeton foundation .",
    "a ` c`++ implementation of the algorithm described in this paper is available in the ancillary files to this submission .",
    "the folder contains a `` readme.rtf ` ' file which details how to compile and run the code .",
    "the zipped package can also be downloaded from www.agatabranczyk.com/dosseva2015code.zip ."
  ],
  "abstract_text": [
    "<S> we present a scheme for engineering the joint spectrum of photon pairs created via spontaneous parametric down conversion . </S>",
    "<S> our method relies on customizing the poling configuration of a quasi - phase - matched crystal . </S>",
    "<S> we use simulated annealing to find an optimized poling configuration which allows almost arbitrary shaping of the crystal s phase - matching function . </S>",
    "<S> this has direct application in the creation of pure single photons  currently one of the most important goals of single - photon quantum optics . </S>",
    "<S> we describe the general algorithm and provide code , written in ` c`++ , that outputs an optimized poling configuration given specific experimental parameters . </S>"
  ]
}