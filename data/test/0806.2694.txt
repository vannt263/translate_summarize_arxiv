{
  "article_text": [
    "from the familiar faces of our friends and family to objects of almost every size in environments of every type , the world that we see is full of structure .",
    "although this structure seems obvious when we look at the world , providing a precise mathematical description has proven more difficult .",
    "one way to formulate this problem is to ask for a probability distribution of images such that , if we draw at random out of this distribution , the resulting images resemble those that we see in the natural environment",
    ". such a probabilistic or generative model would provide a rigorous basis for practical algorithms in image coding , processing and recognition @xcite .",
    "it is also reasonable to hypothesize that our brains have learned at least an approximation to this probabilistic model , allowing us to form more efficient representations of the visual world and to find efficient solutions of many seemingly difficult computational problems . in this view",
    ", aspects of vision ranging from the responses of individual neurons to gestalt perceptual rules would be seen not as artifacts of the brain s circuitry but rather as matched to the statistical structure of the physical world @xcite .",
    "one statistical feature of natural images that provides a clue about the nature of the underlying probability distribution is scale invariance . in particular , field observed that the spatial patterns of image intensity from reasonably natural environments have power spectra that approximate @xmath0 , which is what one would expect from the hypothesis of scale invariance and simple dimensional analysis , and he suggested that this scaling behavior may have a direct connection to the distribution of receptive field parameters across neurons in visual cortex @xcite .",
    "the intuition that scale invariance is a strong constraint on the form of the probability distribution comes from statistical mechanics .",
    "we recall that for systems in thermal equilibrium , the probability that we observe the system in state @xmath1 is given by the boltzmann distribution , @xmath2 , where @xmath3 is the energy of the state and @xmath4 is the absolute temperature @xcite . for most physical systems at generic values of the temperature and other parameters , correlations and power spectra",
    "are _ not _ scale invariant ; rather there is some characteristic length @xmath5 that determines the distance beyond which structures approach statistical independence .",
    "scale invariance emerges only when we tune the temperature to a special value @xmath6 , the critical point which marks a second order phase transition between two different phases ( liquid and gas , ferromagnet and paramagnet , ... ) @xcite .",
    "the modern theory of critical phenomena teaches us that such scale invariance can occur while violating the naive expectations of dimensional analysis , so that power spectra can acquire `` anomalous dimensions , ''",
    "further , scaling extends beyond low order statistics , so that the full probability distributions are predicted to be invariant ( but non  gaussian ) under appropriate scaling transformations . both anomalous scaling and invariant non  gaussian distributions for local features",
    "have been observed in an ensemble of natural scenes .    the analogy between scaling in natural images and the behavior of physical systems at their critical point point raises the question of whether there are analogs to the _ thermodynamic _ features of a critical point .",
    "can we , for example , generalize a given natural image ensemble to a family of ensembles indexed by a `` temperature , '' and show that there is something special ( i.e. , critical ) about the temperature of the real ensemble ? if there is an analog of the diverging specific heat at @xmath6 , what does this say about the nature of images ?",
    "what are the order parameters that characterize the underlying phase transition ? here",
    "we report some preliminary results on these and related questions .",
    "as an initial data set we returned to the image ensemble of ref .",
    "we focus here on the 45 images taken at lower spatial resolution , corresponding to @xmath8 pixel regions covering @xmath9 scenes in the woods of hacklebarney state park in new jersey ; an example is shown in fig 1a .",
    "our path to the construction of a thermodynamics involves sampling the distribution of images in small patches . to make this problem manageable ,",
    "we quantize the grey scale images into just two levels , with the quantization threshold chosen so that the numbers of black and white pixels are exactly equal over the ensemble .",
    "it is important to verify that the rather harshly quantized images preserve interesting structures of the original scenes .",
    "first , by inspection of fig 1b we see that objects and even parts of objects ( branches and leaves on the trees ) are recognizable .",
    "more quantitatively , if the original image is @xmath10 , then we have constructed a discrete image @xmath11 $ ] , with @xmath12 chosen so that @xmath13 , where @xmath14 represents an average over the image ensemble .",
    "power spectra are defined by @xmath15 and similarly for @xmath16 . in fig 1c",
    "we show the spectra @xmath17 and @xmath16 , averaged over the orientation of the ` momentum ' vector @xmath18 and normalized by the total variance .",
    "we see that both spectra exhibit scaling , with very similar exponents . as discussed in ref , there is excess power at high frequencies because of aliasing , and more compelling evidence for scaling is obtained by combining these data with an ensemble of images from the same environment at higher angular resolution , so that the full range of @xmath19 spans 2.5 decades .    in the quantized images ,",
    "an @xmath20 pixel region can take on @xmath21 possible states , and our data set provides @xmath22 samples of these states , although these are not independent .",
    "thus we can expect to provide a good sampling of the distribution of discretized image patches for @xmath23 or even @xmath24 , since @xmath25 , but @xmath26 is out of reach with this data set .",
    "a direct estimate of the entropy shows that @xmath27 , much less than the 16 bits we would obtained from random pixels ; similarly , we find @xmath28 .",
    "this quantifies our impression that a substantial amount of local structure is preserved in the discretized images .",
    "we can also test for scaling more generally by asking how distribution of image states in @xmath20 patches evolves when we coarse  grain the images , and we can do this in two ways .",
    "first , we can take the original grey scale images @xmath29 and create a new image such that the value of @xmath30 in each pixel of the new image is the average over a @xmath31 block of pixels in the original image , and then we can quantize these images .",
    "when we look at @xmath32 patches in these filtered and quantized images , we again have @xmath33 possible states , and we call the distribution over these states @xmath34 , where @xmath35 is the distribution obtained from the original images without any blocking . in the same spirit ( and following the original approach in ref @xcite ) , we can take the quantized image @xmath36 and directly create new quantized images by applying majority rule to the pixels in @xmath32 blocks , and this can be iterated ; we ll call the resulting distributions of states in images patches @xmath37 , where again @xmath38 is what we obtain without blocking .",
    "scale invariance is the claim that all the @xmath34 and @xmath37 will be the same , independent of @xmath39 , because the distribution of states is at a fixed point of this `` renormalization '' transformation @xcite . in fig 1d",
    "we test this prediction , showing that it is obeyed with good accuracy over four decades in probability .",
    "there are more significant deviations in the first step of coarse  graining ( @xmath40 , at left in the figure ) , presumably because of the effects of aliasing noted above .",
    "we emphasize that this test of scale invariance involves the full , joint distribution of image intensities in @xmath32 patches , and thus goes beyond checking the power law behavior of the spectrum ( a second order moment ) or the invariance of distributions of features ( e.g. , the outputs of local filters ) evaluated at a single point .",
    "similar results are obtained for @xmath41 patches .",
    "small patches of our discrete images are described by a set @xmath42 of binary variables .",
    "let us imagine that the distribution of these image patches is really the boltzmann distribution for some physical system at temperature @xmath43 , with some `` energy '' function @xmath44 describing each possible patch , @xmath45 then , following the methods used in the analysis of dynamical systems , we can define the distribution at any temperature @xmath4 , since @xmath46^{1/t}\\\\ { \\cal z}(t ) & = & \\sum_{\\vec\\sigma } [ p(\\vec \\sigma ) ] ^{1/t } .\\end{aligned}\\ ] ] we can define an entropy at each value of the temperature , @xmath47 , and then the usual thermodynamic relations tell us that the heat capacity is @xmath48 .",
    "it is also useful to note that the heat capacity is proportional to the variance in energy or log probability , @xmath49 ^ 2 \\rangle_t/ t^2 $ ] , where @xmath50 denotes an average in the distribution @xmath51 .        in a system with a critical point ,",
    "the specific heat should diverge at @xmath52 .",
    "of course this is true only in the thermodynamic limit of large systems , corresponding here to image patches containing many pixels .",
    "can we see precursors of this divergence in the small patches that we can actually sample ?",
    "figure 2a shows the specific heat for @xmath53 , @xmath32 and @xmath41 patches in our image ensemble , calculated directly from our sampling of the distributions @xmath54 .",
    "we see that , even when we normalize by the number of pixels @xmath55 in each patch ( since we expect that the heat capacity is extensive ) , looking at larger patches reveals a larger specific heat with a clear peak as a function of temperature , and this peak is shifting toward @xmath43 .    to calibrate our intuition about the specific heat estimated from small patches , we have done precisely analogous computations on the nearest neighbor ferromagnetic ising model in two dimensions , defined by @xmath56 , where @xmath57 denotes a sum over neighboring pairs of pixels .",
    "monte carlo simulations of this model generate binary `` images , '' and so many of the practical sampling questions are very similar to those in our problem .",
    "we see in fig 2b that the specific heat again shows a peak which grows and moves toward the true critical temperature @xmath58 as we look at larger patches .",
    "quantitatively the behavior is actually less dramatic than in the images , perhaps because the divergence of the specific heat in the thermodynamic limit is very gentle ( logarithmic ) .",
    "although this ising spin system certainly is much simpler than the ensemble of images , comparison of fig 2a and 2b supports the idea that we what we see in the images is consistent with an underlying divergence of the specific heat at a critical temperature close the to real temperature @xmath43 .",
    "a complementary perspective on thermodynamics is the microcanonical ensemble , corresponding to fixed energy rather than fixed temperature .",
    "the end result of the discussion will be an attempt to measure , for our image ensemble , the entropy as a function of energy .",
    "we begin with some standard results on how thermodynamic quantities are encoded in the plot of entropy vs. energy and on how we can identify a critical point in this plot .",
    "all thermodynamic quantities can be recovered from the partition function , @xmath59 we can rewrite this sum by grouping together all states that have the same energy ,    @xmath60 e^{-e / t } = \\int de\\,\\rho(e ) e^{-e / t } , \\ ] ]    which defines the density of states @xmath61 . for a large system ( patches with many pixels ) , the density of states becomes a smooth function , and we can define an entropy @xmath62 at fixed energy as the log of the number of states in a narrow range of energies , so that @xmath63",
    ". then the partition function is @xmath64 further , both the energy and entropy are extensive variables which should be proportional to the size of the system , @xmath65 ; here @xmath65 will be the number of pixels in a patch",
    ". then we define @xmath66 and @xmath67 , and the partition function becomes @xmath68 } .\\ ] ] now it is clear that , as @xmath65 becomes large , the integral will be dominated by the point where exponent is maximal , that is an energy such that @xmath69 .",
    "this connects the ( microcanonical ) description at fixed energy with the ( canonical ) description at fixed temperature .",
    "in addition , one can show that the specific heat is ( inversely ) related to the second derivative of the entropy , @xmath70^{-1 } .\\ ] ] in this language , the divergence of the specific heat occurs where the second derivative of the entropy vs. energy vanishes .",
    "this is the hallmark of a second order phase transition .",
    "it is important to note that we can define @xmath71 for every state that we observe simply as the log of the probability , from eq ( [ basic ] ) , @xmath72 , where @xmath73 defines the ( arbitrary ) zero of energy , which we choose so that the most probable state has zero energy . while it is tricky to measure the density of states or distribution of energies , it is easy to define the cumulative distribution , @xmath74 which just counts the number of possible image patches for which the observed log probability is greater than @xmath75 .",
    "if @xmath62 is increasing , then this integral is dominated by the behavior near its upper limit , so that @xmath76^{-1 } e^{ns(\\epsilon = e / n)}\\\\ \\rightarrow s(\\epsilon ) & = & { 1\\over n } \\ln { \\cal n}(e = n\\epsilon ) + { { \\ln(t/\\delta ) } \\over",
    "n } .\\end{aligned}\\ ] ] notice that the second term in this equation vanishes for large @xmath65 , and so we approximate the entropy per pixel as a function of energy per pixel by the first term .",
    "the results of the previous paragraph imply that if we just count the number of possible image patches with probability greater than a certain level , then we can construct the entropy vs. energy and hence derive all other thermodynamic functions .",
    "this is what we do in fig .",
    "3a for our image ensemble , using rectangular @xmath77 patches of size from 8 pixels up to 50 pixels ; in fig 3b we do the same thing for our monte carlo simulations of the ising model . as a practical matter",
    "it is important to note that sampling problems are less serious at low energies ( states with high probability ) , so we expect that even if we look at regions where we ca nt sample the whole distribution we will get the correct low energy behavior .",
    "we first note that the results on image patches of different sizes are remarkably consistent with one another , suggesting that we are seeing signs of the thermodynamic limit despite the small size of the regions that we can explore fully .",
    "next , since the real image ensemble is at @xmath43 , we want to pick out the energy at which @xmath78 ; this seems very difficult , since the plot is very nearly a straight line with unit slope .",
    "but we know what this means : if the point where @xmath78 is also a place where @xmath79 , then @xmath43 is a critical point .",
    "thus , _ the fact that @xmath80 vs. @xmath81 is very nearly a straight line of unit slope is direct evidence that the ensemble of natural images is at criticality . _",
    "it is interesting that this approach to the thermodynamics of images is connected to zipf s law @xcite .",
    "we recall that zipf estimated the probability distribution from which words are drawn in an english text , and argued that if we put the words in rank order ( @xmath82 is the most common word ) , then @xmath83 up to some maximum rank @xmath84 corresponding to the number of different words @xmath85 used in the text .",
    "subsequently , other authors have considered generalized zipf  like distributions @xcite , @xmath86 , and there has been much discussion about the meaning of these relationships .",
    "suppose we identify the zipf  like distribution @xmath87 with a boltzmann distribution at @xmath43 , @xmath88",
    ". then the energy of the state at rank @xmath89 is @xmath90 . in the limit of a large system with many possible states ,",
    "we can approximate the density of states by realizing the variable @xmath89 has a uniform distribution , and hence @xmath91 ; this gives @xmath92 .",
    "but we also have @xmath93 , so we find @xmath94 thus a generalized zipf s law is equivalent to an entropy that is ( exactly ! ) linear in the energy .",
    "the original zipf s law ( @xmath95 ) corresponds to a unit slope , as we have found for image patches .",
    "further , we have seen that this simple linear relation corresponds exactly to what we find for a thermodynamic system at a critical point @xcite .",
    "why does it matter that the ensemble of natural images is at a critical point ?",
    "the signature of criticality is the divergence of the specific heat , and the specific heat is the variance in the energy , which is the log probability .",
    "thus , being at a critical point means that the log probability has an enormously broad distribution , with a formally divergent second moment even once we normalize by the number of pixels .",
    "one consequence is that the approach toward typicality in the sense of information theory @xcite will be much slower than one would find away from the critical point , which may be related to difficulties in compressing large natural images , or even in estimating their entropy ( see , for example , ref ) .",
    "the large variance in log probability also means that there are large fluctuations in how surprised we should be by any given scene or segment of a scene , which perhaps quantifies our common experience .",
    "critical points mark the transition between phases characterized by different forms of order : liquid vs. gas , ferromagnet vs. paramagnet , and so on . what is the ordering that would emerge if somehow the distribution of natural images could be `` cooled '' from @xmath43 down toward @xmath96 ? this ultimately is a question about the nature of the image patches that correspond to the low energy states .",
    "certainly the lowest energy states of small patches are solid black or white blocks , as in a ferromagnet where all the spins can align up or down , and these states will dominate at @xmath96 .",
    "but , searching through all @xmath41 patches , we find @xmath97 states that are local minima of the energy , in the sense that flipping any single pixel from black to white ( or vice versa ) results in increased energy or reduced probability . in figure 4a",
    "we show 49 of these states , ordered in decreasing probability .",
    "we see that many of these states are interpretable , for example as edges between dark and light regions , and that much of the multiplicity arises from the different ways of realizing these patterns ( e.g. , the six possible cases of a single vertical edge ) .",
    "we can think of these local minima in the energy landscape @xcite as being like the attractors in the hopfield model of neural networks @xcite , or like the code words in statistical mechanics approaches to error  correcting codes @xcite .",
    "usually we think of error  correcting coding as a construct , but here it seems that the signals which the world presents to us have some intrinsic error  correcting properties .",
    "although there are many reasons why edges may be important for vision , it is interesting to take seriously the idea that such image features acquire their importance because of their intrinsic properties of error correction , as if these are the signals that the world is `` trying '' to send us in the most fault tolerant fashion .",
    "if this is the case , then the visual system might build feature detecting neurons which serve to identify the basins of attraction defined by these local minima in energy .",
    "if such cells respond only when the original grey scale image corresponds to a discrete image within a particular basin of attraction , then it is easy to compute the response  triggered average within our natural image ensemble , with the results shown in fig 4b .",
    "these results have a strong resemblance to the spike  triggered average responses of neurons in visual cortex to natural scenes @xcite .",
    "interestingly , if we look more closely at the problem of identifying the basin of attraction , we find that perceptron  like models based on filtering through a single receptive field do rather poorly .",
    "thus , if visual cortex really builds a representation of the world based on the identification of these local minima in the energy landscape , the computations involved necessarily involve nonlinear combinations of multiple filters , as observed @xcite .",
    "much remains to be done to see if this really is a path to a theory of these more complex neural responses .",
    "we thank d chigirev , se palmer & e schneidman for helpful discussions , and dl ruderman for recovering the original data from ref .",
    "this work was supported in part by national science foundation grants iis0613435 , ibn0344678 , and phy0650617 , by national institutes of health grant t32 mh065214 , by the human frontier science program , and by the swartz foundation .",
    "w bialek , thinking about the brain . in _ physics of biomolecules and cells : les houches session lxxv , _ h flyvbjerg , f jlicher , p ormos & f david , eds , pp 485577 ( edp sciences , les ulis ; springer ",
    "verlag , berlin , 2002 ) ; arxiv : physics/0205030 .                mj feigenbaum , mh jensen & i procaccia , time ordering and the thermodynamics of strange sets : theory and experimental tests .",
    "_ phys rev lett _ * 57 , * 15031506 ( 1986 ) .",
    "mj feigenbaum , some characterizations of strange sets .",
    "_ j stat phys _ * 46 , * 919924 ( 1987 ) .                        d smyth , b willmore , ge baker , i d thompson & dj tolhurst , the receptive  field organization of simple cells in primary visual cortex of ferrets under natural scene stimulation . _ j neurosci _ * 23 , * 47464759 ( 2003 ) .",
    "fe theunissen , sv david , nc singh , a hsu , we vinje & jl gallant , estimating spatio  temporal receptive fields of auditory and visual neurons from their responses to natural stimuli .",
    "_ network _ * 12 , * 289316 ( 2001 ) ."
  ],
  "abstract_text": [
    "<S> the scale invariance of natural images suggests an analogy to the statistical mechanics of physical systems at a critical point . </S>",
    "<S> here we examine the distribution of pixels in small image patches and show how to construct the corresponding thermodynamics . </S>",
    "<S> we find evidence for criticality in a diverging specific heat , which corresponds to large fluctuations in how ` surprising ' we find individual images , and in the quantitative form of the entropy vs.  energy . </S>",
    "<S> the energy landscape derived from our thermodynamic framework identifies special image configurations that have intrinsic error correcting properties , and neurons which could detect these features have a strong resemblance to the cells found in primary visual cortex . </S>"
  ]
}