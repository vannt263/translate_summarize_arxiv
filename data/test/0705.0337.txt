{
  "article_text": [
    "in the hot field of computer simulation of biological macromolecules , available potential energy functions are often not accurate enough to properly describe complex processes such as the folding of proteins @xcite . in order to improve the situation ,",
    "it is convenient to extract ab initio information from quantum mechanical calculations with the hope of being able to devise less computationally demanding methods that can be used to tackle large systems . in this spirit ,",
    "the effective potential for the nuclei calculated in the non - relativistic born - oppenheimer approximation is typically considered as a good reference to assess the accuracy of cheaper potentials @xcite . the study of molecules at this level of theoretical detail and the design of computationally efficient approximations for solving the demanding equations that appear constitute the major part of the field called _ quantum chemistry _",
    "@xcite . in this work ,",
    "we voluntarily circumscribe ourselves to the basic formalism needed for the ground - state quantum chemical calculations that are typically performed in this context . for more general expositions ,",
    "we refer the reader to any of the thorough accounts in refs .",
    "@xcite .    in sec .",
    "[ sec : qc_molecular_h ] , we introduce the molecular hamiltonian and a special set of units ( the atomic ones ) that are convenient to simplify the equations . in sec .",
    "[ sec : qc_born - oppenheimer ] , we present in an axiomatic way the concepts and expressions related to the separation of the electronic and nuclear problems in the born - oppenheimer scheme . in sec .",
    "[ sec : qc_variational ] , we introduce the variational method that underlies the derivation of the basic equations of the hartree and hartree - fock approximations , discussed in sec .",
    "[ sec : qc_hartree ] and  [ sec : qc_hartree - fock ] respectively .",
    "the computational implementation of the hartree - fock approximation is tackled in sec .  [",
    "sec : qc_roothaan ] , where the celebrated roothaan - hall equations are derived . in sec .",
    "[ sec : qc_basis_sets ] , the main issues related to the construction and selection of gaussian basis sets are discussed , and , finally , in sec .",
    "[ sec : qc_modern_developments ] , the hottest areas of modern research are briefly reviewed and linked to the issues in the rest of the work , with a special emphasis in the development of linear - scaling methods .",
    "since 1960 , the international scientific community has agreed on an ` official ' set of basic units for measurements : _ le ystme nternational dunits _ , or si for short ( see ` http://www.bipm.org/en/si/ ` and ref .",
    "@xcite ) . the meter ( m ) , the kilogram ( kg ) , the second  ( s )",
    ", the ampere ( a ) , the kelvin ( k ) , the mole ( mol ) , the joule ( j ) and the pascal  ( pa ) are examples of si units .",
    "sticking to the si scheme , the non - relativistic quantum mechanical hamiltonian operator of a molecule consisting of @xmath0 nuclei ( with atomic numbers @xmath1 and masses @xmath2 , @xmath3 ) and @xmath4 electrons ( i.e. , the _ molecular hamiltonian _ ) is expressed as note that the non - relativistic molecular hamiltonian does not depend on spin - like variables . ] :    @xmath5    where @xmath6 stands for @xmath7 , being @xmath8 planck s constant , @xmath9 denotes the electron mass , @xmath10  the proton charge , @xmath11 the position of the @xmath12-th electron , @xmath13 that of the @xmath14-th nucleus , @xmath15 the vacuum permittivity and @xmath16 the laplacian operator with respect to the coordinates of the @xmath12-th particle .",
    "although using a common set of units presents obvious communicative advantages , when circumscribed to a particular field of science , it is common to appeal to non - si units in order to simplify the most frequently used equations by getting rid of some constant factors that always appear grouped in the same ways and , thus , make the numerical values in any calculation of the order of unity . in the field of quantum chemistry , _ atomic units _ ( see table  [ tab : atomic_units ] ) , proposed in ref .",
    "@xcite and named in ref .",
    "@xcite , are typically used . in these units ,",
    "( [ eq : chqc_ham_tot_si ] ) is substantially simplified to    @xmath17    [ tab : atomic_units ]    since all the relevant expressions in quantum chemistry are derived in one way or another from the molecular hamiltonian , the simplification brought up by the use of atomic units propagates to the whole formalism .",
    "consequently , they shall be the choice all throughout this work .",
    "[ tab : unit_conversion ]    apart from the atomic units and the si ones , there are some other miscellaneous units that are often used in the literature : the _ ngstrm _ , which is a unit of length defined as , and the units of energy _ _ cm__@xmath18 ( which reminds about the spectroscopic origins of quantum chemistry and , even , quantum mechanics ) , _ electronvolt _ ( ev ) , _ kilocalorie per mole _ ( kcal / mol ) and _ kilojoule per mole _ ( kj / mol ) .",
    "the last two are specially used in the field of macromolecular simulations and quantify the energy of a mole of entities ; for example , if one asserts that the torsional barrier height for @xmath19 is @xmath20 kcal / mol , one is really saying that , in order to make a mole of @xmath19 ( i.e. , @xmath21 molecules ) rotate @xmath22 around the o  o bond , one must spend @xmath20 kcal . for the conversion factors between the different energy units ,",
    "see table  [ tab : unit_conversion ] .    finally , to close this section , we rewrite eq .",
    "( [ eq : chqc_ham_tot_au ] ) introducing some self - explanatory notation that will be used in the subsequent discussion :    [ eq : chqc_ham_tot_op ] @xmath23",
    "to think of a macromolecule as a set of quantum objects described by a _ wavefunction _ @xmath24",
    "dependent on the spatial and [ page : foot : spin_convenient ] spin one convenient way of thinking about functions that depend on spin - like variables is as an @xmath25-tuple of ordinary @xmath26 functions , where @xmath25 is the finite number of possible values of the spin . in the case of a one - particular wavefunction describing an electron ,",
    "for example , @xmath27 can take two values ( say , @xmath28 and @xmath29 ) in such a way that one may picture any general _ spin - orbital _ @xmath30 as a 2-tuple @xmath31 . of course",
    ", another valid way of imagining @xmath30 is simply as a function of four variables , three real and one discrete .",
    "] degrees of freedom , , of the electrons and on those of the nuclei , @xmath32 , would be too much for the imagination of physicists and chemists . all the language of chemistry would have to be remade and simple sentences in textbooks , such as `` rotation about this single bond allows the molecule to avoid steric clashes between atoms '' or even `` a polymer is a long chain - like molecule composed of repeating monomer units '' , would have to be translated into long and counter - intuitive statements involving probability and ` quantum jargon ' .",
    "conscious or not , we think of molecules as classical objects .    more precisely , we are ready to accept that electrons are quantum ( we know of the interference experiments , electrons are light , we are accustomed to draw atomic ` orbitals ' , etc . ) , however , we are reluctant to concede the same status to nuclei .",
    "nuclei are heavier than electrons ( at least @xmath33 times heavier , in the case of the single proton nucleus of hydrogen ) and we picture them in our imagination as ` classical things ' that move , bond to each other , rotate around bonds and are at precise points at precise times .",
    "we imagine nuclei ` slowly moving ' in the field of the electrons , which , for each position of the first , immediately ` adjust their quantum state ' .",
    "the formalization of these ideas is called _ orn - ppenheimer _ ( bo ) _ approximation _ @xcite and the confirmation of its being good for many relevant problems is a fact that supports our intuitions about the topic and that lies at the foundations of the vast majority of the images , the concepts and the research in quantum chemistry there are many phenomena , however , in which the born - oppenheimer approximation is broken .",
    "for example , in striking a flint to create a spark , mechanical motion of the nuclei excites electrons into a plasma that then emits light @xcite . ] .    like any approximation , the born - oppenheimer",
    "one may be either _ derived _ from the exact problem ( in this case , the entangled behaviour of electrons and nuclei as the same quantum object ) or simply _ proposed _ on the basis of physical intuition , and later confirmed to be good enough ( or not ) by comparison with the exact theory or with the experiment .",
    "of course , if it is possible , the first way should be preferred , since it allows to develop a deeper insight about the terms we are neglecting and the specific details that we will miss .",
    "however , although in virtually every quantum chemistry book @xcite hand - waving derivations up to different levels of detail are performed and the born - oppenheimer approximation is typically presented as unproblematic , it seems that the fine mathematical details on which these ` standard ' approaches are based are far from clear @xcite .",
    "this state of affairs does not imply that the final equations that will need to be solved are ill - defined or that the numerical methods based on the theory are unstable ; in fact , it is just the contrary ( see the discussion below ) , because the problems are related only to the precise relation between the concepts in the whole theory and those in its simplified version .",
    "nevertheless , the many subtleties involved in a _ derivation _ of the born - oppenheimer approximation scheme from the exact equations suggest that the second way , that of _ proposing _ the approximation , be taken . hence , in the following paragraphs , an _ axiomatic _ presentation of the main expressions , aimed mostly to fix the notation and to introduce the language , will be performed .",
    "first of all , if we examine the hamiltonian operator in eq .",
    "( [ eq : chqc_ham_tot_au ] ) , we see that the term  @xmath34 prevents the problem from being separable in the nuclear and electronic coordinates , i.e. , if we define @xmath35 as the set of all electronic coordinates ( spatial and spin - like ) and do likewise with the nuclear coordinates @xmath36 , the term @xmath34 prevents any wavefunction @xmath37 solution of the _ time - independent schrdinger equation _",
    ",    @xmath38    from being written as a product , @xmath39 , of an electronic wavefunction and a nuclear one .",
    "if this were the case , the problem would still be difficult ( because of the coulomb terms @xmath40 and @xmath41 ) , but we would be able to focus on the electrons and on the nuclei separately .    the starting point for the born - oppenheimer approximation",
    "consists in assuming that a less strict separability is achieved , in such a way that , for a pair of suitably chosen @xmath42 and @xmath43 , any wavefunction solution of eq .",
    "( [ eq : chqc_schrodinger ] ) ( or at least those in which we are interested ; for example , the eigenstates corresponding to the lowest lying eigenvalues ) can be expressed as    @xmath44    where we have used a ` ; ' to separate the two sets of variables in the electronic part of the wavefunction in order to indicate that , in what follows , it is convenient to use the image that ` from the point of view of the electrons , the nuclear degrees of freedom are fixed ' , so that the electronic wavefunction depends ` parametrically ' on them . in other words , that the @xmath36 are not quantum variables in eq .  ( [ eq : chqc_clamped ] ) below .",
    "of course , it is just a ` semantic ' semicolon ; if anyone feels uncomfortable about it , she may drop it and write a normal comma .",
    "notably , in ref .",
    "@xcite , hunter showed that any solution of the schrdinger equation can in fact be written exactly in the form of eq .",
    "( [ eq : chqc_bo_wf ] ) , and that the two functions , @xmath42 and @xmath43 , into which @xmath37 is split may be interpreted as marginal and conditional probability amplitudes respectively .",
    "however , despite the insight that is gained from this treatment , it is of no practical value , since the knowledge of the exact solution @xmath37 is required in order to compute @xmath42 and @xmath43 in hunter s approach .    in the born - oppenheimer scheme ,",
    "an additional assumption is made in order to avoid this drawback : _ the equations obeyed by the electronic and nuclear parts of the wavefunction are supposed to be known_. hence , @xmath43 is assumed to be a solution of the time - independent _ clamped nuclei schrdinger equation _ ,    @xmath45    where the _ electronic hamiltonian operator _ @xmath46 and the _ electronic energy _",
    "@xmath47 ( both dependent on the nuclei positions ) have been defined , and , since the nuclear spins do not enter the expression , we have explicitly indicated that @xmath48 depends parametrically on  @xmath49 and not on @xmath36 .",
    "the common interpretation of the clamped nuclei equation is , as we have advanced at the beginning of the section , that the nuclei are much ` slower ' than the electrons and , therefore , the latter can automatically adjust their quantum state to the instantaneous positions of the former .",
    "physically , eq .  ( [ eq : chqc_clamped ] ) is just the time - independent schrdinger equation of @xmath4 particles ( the electrons ) of mass @xmath9 and charge @xmath50 in the _ external electric field _ of @xmath0  _ point charges _ ( the nuclei ) of size @xmath51 at locations @xmath13 .",
    "mathematically , it is an eigenvalue problem that has been thoroughly studied in the literature and whose properties are well - known @xcite .",
    "in particular , it can be shown that , in the case of neutral or positively charged molecules ( i.e. , with @xmath52 ) , the clamped nuclei equation has an infinite number of normalizable solutions in the discrete spectrum of @xmath46 ( _ bound - states _ ) for every value of @xmath49 @xcite .",
    "these solutions must be regarded as the different _ electronic energy levels _ , and a further approximation that is typically made consists in , not only accepting that the electrons immediately ` follow ' nuclear motion , but also that , for each value of the nuclear positions  @xmath49 , they are in the electronic ground - state this is customarily assumed in the literature and it is supported by the general fact that electronic degrees of freedom are typically more difficult to excite than nuclear ones .",
    "hence , in the vast majority of the numerical implementations of the theory , only the electronic ground - state is sought .",
    "we will see this in the forecoming sections . ] , i.e. , the one with the lower @xmath47 .",
    "consequently , we define    @xmath53    to be the _ effective electronic field _ in which the nuclei move , in such a way that , once we have solved the problem in eq .",
    "( [ eq : chqc_clamped ] ) and know @xmath54 , the time - independent _ nuclear schrdinger equation _ obeyed by @xmath42 is :    @xmath55    where the _ effective nuclear hamiltonian _",
    "@xmath56 has been implicitly defined .",
    "now , to close the section , we put together the main expressions of the born - oppenheimer approximation for quick reference and we discuss them in some more detail :    [ eq : chqc_bo_summary ] @xmath57    to start , note that the above equations are written in the logical order in which they are imagined and used in any numerical calculation .",
    "first , we assume the nuclei fixed at @xmath49 and we ( hopefully ) solve the clamped nuclei electronic schrdinger equation ( eq .  ( [ eq : chqc_bo_summary_a ] ) ) , obtaining the electronic ground - state @xmath58 with its corresponding energy @xmath59 .",
    "next , we repeat this procedure for all possible values of course , this can not be done in practice . due to the finite character of available computational resources ,",
    "what is customarily done is to define a ` grid ' in @xmath49-space and compute @xmath54 in a finite number of points . ]",
    "of @xmath49 and end up with an hyper - surface @xmath54 in @xmath49-space .",
    "finally , we add this function to the analytical and easily computable @xmath60 and find the _ effective potential _ that determines the nuclear motion :    @xmath61    it is , precisely , this effective potential that is called _ otential nergy urface _ ( pes ) ( or , more generally , _",
    "otential nergy yper - urface _",
    "( pehs ) ) in quantum chemistry and that is the central object through which scientists picture chemical reactions or conformational changes of macromolecules @xcite .",
    "in fact , the concept is so appealing and the classical image so strong that , after ` going quantum ' , we can ` go classical ' back again and think of nuclei as perfectly classical particles that move in the classical potential @xmath62 . in such a case",
    ", we would not have to solve eq .",
    "( [ eq : chqc_bo_summary_c ] ) but , instead , integrate the newtonian equations of motion .",
    "this is the basic assumption of every typical force field used for classical ground - state _ molecular dynamics _",
    ", such as the ones in the popular charmm @xcite , amber @xcite or opls @xcite packages .",
    "finally , we would like to remind the reader that , despite the hand - waving character of the arguments presented , up to this point , every computational step has a clear description and eqs .",
    "( [ eq : chqc_bo_summary_a ] ) through  ( [ eq : chqc_bo_summary_c ] ) could be considered as _ definitions _ involving a certain degree of notational abuse . to assume that the quantities obtained through this process are close to those that proceed from a rigorous solution of the time independent schrdinger equation ( eq .  ( [ eq : chqc_schrodinger ] ) )",
    "is where the approximation really lies .",
    "hence , the more accurate eqs .",
    "( [ eq : chqc_bo_summary_d ] ) are , the better the born - oppenheimer guess is , and , like any other one , if one does not trust in the heuristic grounds on which the final equations stand , they may be taken as axiomatic and judged a posteriori according to their results in particular cases until now , two approximations have been done : the non - relativistic character of the objects studied and the born - oppenheimer approximation . in the forecoming ,",
    "many more will be done .",
    "the a priori quantification of their goodness in large molecules is a formidable task and , despite the efforts in this direction , in the end , the comparison with experimental data is the only sound method for validation . ] .    in quantum chemistry",
    ", the born - oppenheimer approximation is assumed in a great fraction of the studies and it allows the central concept of potential energy surface to be well - defined , apart from considerably simplifying the calculations .",
    "the same decision is taken in this work .",
    "there exists a mathematically appealing way of deriving the time independent schrdinger equation ( eq .  ( [ eq : chqc_schrodinger ] ) ) from an extremal principle . to this end",
    ", we first define the functional ( see appendix  a ) that corresponds to the expected value of the energy ,    @xmath63 : = \\langle\\psi|\\,\\hat{h}\\,|\\psi\\rangle \\ , \\ ] ]    where the traditional _ bra _ and _ ket _ notation is read as    @xmath64    @xmath65 being any operator in the space of wavefunctions and @xmath66 a dummy variable representing all possible coordinates on which @xmath67 depends . the norm of @xmath67 , in this notation is expressed as @xmath68 , and we shall say that @xmath67 is _ normalized _ if @xmath69 .",
    "if we want to optimize the energy functional above restricting the search space to the normalized wavefunctions , the constrained - extremals problem that results can be solved via the _ lagrange multipliers method _ ( see appendix  b ) by constructing the _ associated functional _ @xmath70 $ ] , where we introduce a _ lagrange multiplier _",
    "@xmath71 to force normalization :    @xmath72 : = \\mathcal{f}[\\psi ] +    \\lambda \\,\\big ( \\langle \\psi|\\psi\\rangle - 1 \\big ) \\ .\\ ] ]    if we now ask that the functional derivative of @xmath70 $ ] with respect to the complex conjugate @xmath73 of the wave [ page : foot : deriving_conjugate ] function a function of a complex variable @xmath74 ( or , analogously , a functional on a space of complex functions ) may be regarded as depending on two different sets of independent variables : either @xmath75 and @xmath76 or @xmath74 and @xmath77 . the choice frequently depending on technical issues .",
    "] be zero , i.e. , we look for the stationary points of @xmath78 $ ] conditioned by , we obtain the eigenvalues equation for @xmath79 , i.e. , the time - independent schrdinger equation .",
    "additionally , it can be shown , first , that , due to the self - adjointedness of @xmath79 , the equation obtained from the stationarity condition with respect to @xmath67 ( not @xmath73 ) is just the complex conjugate and adds no new information .",
    "moreover , one can see that the reverse implication is also true @xcite , so that , if a given normalized wavefunction  @xmath67 is a solution of the eigenvalue problem and belongs to the discrete spectrum of @xmath79 , then the functional in eq .",
    "( [ eq : chqc_functional_ftilde ] ) is stationary with respect to @xmath73 :    @xmath80}{\\delta\\psi^ { * } } = 0 \\quad   \\longleftrightarrow \\quad   \\hat{h}\\,\\psi=-\\lambda\\,\\psi:=e\\,\\psi \\quad \\mathrm{and }   \\quad \\langle\\psi|\\psi\\rangle = 1 \\ .\\ ] ]    this result , despite its conceptual interest , is of little practical use , because it does not indicate an operative way to solve the schrdinger equation different from the ones that we already knew .",
    "the equivalence above simply illustrates that mathematical variational principles are over - arching theoretical statements from which the differential equations that actually contain the details of physical systems can be extracted . nevertheless , using similar ideas",
    ", we will derive another simple theorem which is indeed powerfully practical : the _ variational theorem_.    let @xmath81 be a basis of eigenstates of the hamiltonian operator @xmath79 and @xmath82 their corresponding eigenvalues . since  @xmath79 is self - adjoint , the eigenstates @xmath83 can be chosen to be orthonormal ( i.e. , @xmath84 ) and any normalized wavefunction @xmath67 in the hilbert space can be written as a linear combination of them we assume here , for the sake of simplicity and in order to highlight the relevant concepts , that @xmath79 has only discrete spectrum .",
    "the ideas involved in a general derivation are the same , but the technical details and the notation are more complicated @xcite . ] :    @xmath85    if we now denote by @xmath86 the lowest @xmath87 ( i.e. , the energy of the ground - state ) its existence is not guaranteed : it depends on the particular potential in @xmath79 .",
    "however , for the physically relevant cases , there is indeed a minimum energy in the set @xmath82 . ] and calculate the expected value of the energy on an arbitrary state @xmath67 such as the one in eq .",
    "( [ eq : chqc_decomposition ] ) , we obtain    @xmath88    this simple relation is the _ variational theorem _ and it states that any wavefunction of the hilbert space has an energy larger than the one of the ground - state ( the equality can only be achieved if @xmath89 ) .",
    "however trivial this fact may appear , it allows a very fruitful ` everything - goes ' strategy when trying to approximate the ground - state in a difficult problem . if one has a procedure for finding a promising guess wavefunction ( called _ variational ansatz _ ) , no matter how heuristic , semi - empirical or intuitive it may be , one may expect that the lower the corresponding energy , the closer to the ground - state it is of course , this not necessarily so ( and , in any case , it depends on the definition of ` closer ' ) , since it could happen that the @xmath90 landscape in the constrained subset of the hilbert space in which the search is performed be ` rugged ' .",
    "in such a case , we may have very different wavefunctions ( say , in the sense of the @xmath91-norm ) with similar energies @xmath90 .",
    "the only ` direction ' in which one can be sure that the situation improves when using the variational procedure is the ( very important ) energetic one . that one is also moving towards better values of any other observable is , in general , no more than a _ bona fide _ assumption . ]",
    "this provides a systematic strategy for improving the test wavefunction which may take a number of particular forms .",
    "one example of the application of the variational theorem is to propose a family of normalized wavefunctions @xmath92 parametrically dependent on a number @xmath93 and calculate the @xmath93-dependent expected value of the energy note that , if the functions @xmath92 were not normalized , then we should deal with the constrained problem as in  ( [ eq : chqc_functional_ftilde ] ) , or , equivalently , we could include a dividing _ overlap term _ @xmath94 in  ( [ eq : chqc_e_theta ] ) . ] :    @xmath95    then , one may use the typical tools of one - variable calculus to find the minimum of  @xmath96 and thus make the best guess of the energy @xmath86 constrained to the family @xmath92 . if the ansatz is cleverly chosen , this estimate could be rather accurate , however , for large systems that lack symmetry , it is very difficult to write a good enough form for @xmath92 .",
    "when dealing with a large number of particles , there exists another protocol based on the variational theorem that will permit us to derive the hartree and hartree - fock equations for the electronic wavefunction @xmath48 ( see secs .",
    "[ sec : qc_hartree ] and  [ sec : qc_hartree - fock ] , respectively ) .",
    "the first step is to devise a restricted way ( a function @xmath97 with no free parameters ) to express @xmath48 in terms of _ one - electron wavefunctions _ , also called _ orbitals _ and denoted in principle , there could be more orbitals than electrons , however , in both the hartree and hartree - fock applications of this formalism , the index @xmath98 runs , just like @xmath12 , from 1 to @xmath4 . ] by @xmath99 , thus reducing the search space to a ( typically small ) subset of the whole hilbert space :    @xmath100    the second step consists in establishing a ( possibly infinite ) number of constraints on the one - electron functions actually , both restrictions ( the one at the level of the total wavefunction in eq .",
    "( [ eq : chqc_constraint_total ] ) and the one involving the one - particle ones in eq .",
    "( [ eq : chqc_constraint_mono ] ) ) are simply constraints ( see appendix  b ) .",
    "the distinction is not fundamental but operative , and it also helps us to devise variational ansatzs separating the two conceptual playgrounds .",
    "] ,    @xmath101    with these two ingredients , we can now write the lagrange functional that describes the constrained problem in terms of the orbitals @xmath102 ( see eq .",
    "( [ eq : chqc_functional_ftilde ] ) ) :    @xmath103 =     \\big\\langle f\\big(\\{\\psi_{a}(x_{i})\\}\\big ) \\,\\big|\\ , \\hat{h}\\ , \\big|\\ ,     f\\big(\\{\\psi_{a}(x_{i})\\}\\big ) \\big\\rangle + \\sum_{k } \\lambda_{k }     l_{k}\\big(\\{\\psi_{a}(x_{i})\\}\\big ) \\ .\\ ] ]    finally , we take the derivatives of @xmath104 $ ] with respect to every @xmath105 ( normally , with respect to the complex conjugate @xmath106 , see footnote  [ foot : deriving_conjugate ] in page  ) and we ask each one to be zero ( see appendix  a ) .",
    "this produces the final equations that must be solved in order to find the stationary one - electron orbitals .",
    "of course , these final equations may have multiple solutions .",
    "in the cases discussed in this work , there exist procedures to check that a particular solution ( found computationally ) is , not only stationary , but also minimal @xcite .",
    "however , to assure that it is , not only locally minimal , but also globally ( i.e. , that is _ optimal _ ) , could be , in general , as difficult as for any other multi - dimensional optimization problem @xcite . in the hartree and hartree - fock cases , discussed in secs .",
    "[ sec : qc_hartree ] and  [ sec : qc_hartree - fock ] respectively , the aufbau principle and a clever choice of the starting guess constitute particular techniques intended to alleviate this problem .",
    "assuming the born - oppenheimer approximation ( see sec .  [",
    "sec : qc_born - oppenheimer ] and eqs .",
    "( [ eq : chqc_bo_summary ] ) ) , the central problem that one must solve in quantum chemistry is _ to find the ground - state of the electronic hamiltonian for a fixed position _",
    "@xmath49 _ _ of the nuclei _ _",
    "since , from now on , we will only be dealing with the ` electronic problem ' , the notation has been made simpler by dropping superfluous subindices @xmath10 where there is no possible ambiguity . as a consequence , for example , the electronic hamiltonian is now denoted by @xmath79 , the electronic kinetic energy by @xmath107 and the electronic wavefunction by @xmath108 ( dropping the parametric dependence on @xmath49 in the same spirit ) . ] :    @xmath109    as already remarked in sec .",
    "[ sec : qc_born - oppenheimer ] , this problem is well posed for neutral and positively charged molecules , and , in the same way in which the term @xmath34 prevented the total wavefunction to be a product of an electronic and a nuclear part , the term @xmath41 in the expression above breaks the separability in the one - electron variables @xmath110 of the electronic time - independent schrdinger equation associated to @xmath79 .",
    "hence , a general solution @xmath108 can not be a product of orbitals and the search must be a priori performed in the whole hilbert space .",
    "however , this is a much too big place to look for @xmath108 , since the computational requirements to solve the schrdinger equation grow exponentially on the number of electrons .",
    "partially recognizing this situation , in the first days of quantum mechanics , dirac wrote that ,    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the underlying physical laws necessary for the mathematical theory of a large part of physics and the whole of chemistry are thus completely known , and the difficulty is only that the exact application of these equations leads to equations much too complicated to be soluble . it therefore becomes desirable that approximate practical methods of applying quantum mechanics should be developed , which can lead to an explanation of the main features of complex atomic systems without too much computation @xcite .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    the description of the most popular approximate methods , which the great physicist envisaged to be necessary , will be the objective of the following sections .",
    "two basic points responsible of the relative success of such an enterprise are the severe reduction of the space in where the ground - state is sought ( which , of course , leads to only an approximation of it ) and the availability of computers unimaginably faster than anything that could be foreseen in times of dirac .",
    "one of the first and most simple approximations aimed to solve the problem posed in the previous section is due to hartree in 1927 @xcite ( although the way in which the hartree equations will be derived here , using the variational theorem , is due to slater @xcite ) . in this approximation",
    ", the total wavefunction is constrained to be a product ( typically referred to as _ hartree product _ ) of @xmath4 one - electron orbitals ( see eq .",
    "( [ eq : chqc_constraint_total ] ) ) , where the spin of the electrons and the antisymmetry ( i.e. , the pauli exclusion principle ) are not taken into account we shall denote with capital greek letters the wavefunctions depending on all the electronic variables , and with lowercase greek letters the one - electron orbitals . in addition , by @xmath67 ( or @xmath111 ) , we shall indicate wavefunctions containing spin part ( called _ spin - orbitals _ ) and , by @xmath112 ( or @xmath113 ) , those that depend only on spatial variables . ] :    @xmath114    where the @xmath98 index in the orbitals has been substituted by @xmath12 due to the fact that each function is paired to a specific set of electron coordinates , consequently being the same number of both of them .",
    "also , the additional requirement that the one - particle wavefunctions be normalized is imposed ( see eq .",
    "( [ eq : chqc_constraint_mono ] ) ) :    @xmath115    with these two ingredients , we can construct the auxiliary functional whose zero - derivative condition produces the solution of the constrained stationary points problem ( see eq .",
    "( [ eq : chqc_constrained_functional ] ) ) . to this effect",
    ", we introduce @xmath4 lagrange multipliers @xmath116 that force the normalization constraints note that the normalization of the total wavefunction is a consequence of the normalization of the one - electron ones and needs not to be explicitly asked . ] :    @xmath117 =     \\left \\langle \\prod_{i=1}^{n}\\phi_{i}({\\bm r}_{i } ) \\right | \\hat{h }     \\left | \\prod_{i=1}^{n}\\phi_{i}({\\bm r}_{i } ) \\right \\rangle -     \\sum_{i=1}^{n } \\varepsilon_{i }     \\big ( \\langle\\phi_{i}|\\phi_{i}\\rangle-1 \\big ) \\ , \\ ] ]    where the minus sign in the lagrange multipliers term is chosen in order to get to the most common form of the final equations without having to define new quantities    this functional may be considered to depend on @xmath118 independent functions : the @xmath4 one - electron  @xmath119 and their @xmath4 complex conjugates ( see footnote  [ foot : deriving_conjugate ] in page  ) .",
    "the _ hartree equations _ are then obtained by imposing that the functional derivative of @xmath120 with respect to @xmath121 be zero for @xmath122 . in order to obtain them and as an appetizer for the slightly more complicated process in the more used hartree - fock approximation ,",
    "the functional derivative will be here computed in detail following the steps indicated in appendix  a.    first , we write out the limits in sums and products are dropped if there is no possible ambiguity . ] the first term in the right - hand side of eq .",
    "( [ eq : chqc_constrained_functional_h ] ) :    @xmath123    where @xmath124 denotes the euclidean @xmath125 volume element @xmath126 .",
    "now , we realize that the products outside the integrals can be dropped using the constraints in eq .",
    "( [ eq : chqc_constraint_mono_h ] ) ( see the last paragraphs of appendix  b for a justification that this can be done before taking the derivative ) . then , using the previous expression and conveniently rearranging the order of the integrals and sums , we write out the first term in the numerator of the left - hand side of eq .",
    "( [ eq : def_funct_der ] ) that corresponds to an infinitesimal variation of the function @xmath121 :    @xmath127:= } \\nonumber \\\\ \\lefteqn {     \\widetilde{\\mathcal{f}}\\,\\big[\\phi_{1},\\phi_{1}^{*},\\ldots ,          \\phi_{k},\\phi_{k}^{*}+          \\epsilon \\delta \\phi_{k}^{*},\\ldots ,          \\phi_{n},\\phi_{n}^{*}\\big ] = } \\nonumber \\\\ & & \\mbox { }     -\\frac{1}{2}\\sum_{i }     \\int\\phi_{i}^{*}({\\bm r})\\nabla^{2}\\phi_{i}({\\bm r})\\,\\mathrm{d}{\\bm r }     - \\sum_{i }     \\int\\big|\\phi_{i}({\\bm r})\\big|^{2 }     \\left ( \\sum_{a=1}^{n_{n}}\\frac{z_{a}}{|{\\bm r}-{\\bm r}_{a}| } \\right )     \\mathrm{d}{\\bm r } \\nonumber \\\\ & & \\mbox { }      + \\frac{1}{2}\\sum_{i}\\int\\big|\\phi_{i}({\\bm r})\\big|^{2 }     \\left ( \\int\\frac{\\sum_{j \\ne i}\\big|\\phi_{j}({\\bm r}\\ , ' ) \\big|^{2 } }       { |{\\bm r}-{\\bm r}\\ , ' |}\\,\\mathrm{d}{\\bm r}\\ , ' \\right )     \\mathrm{d}{\\bm r }      - \\sum_{i}\\varepsilon_{i } \\left ( \\int\\big|\\phi_{i}({\\bm r})\\big|^{2 }     \\mathrm{d}{\\bm r } - 1 \\right ) \\nonumber \\\\ & & \\mbox { }      -\\frac{1}{2}\\epsilon\\int\\delta\\phi_{k}^{*}({\\bm r})\\nabla^{2 }      \\phi_{k}({\\bm r})\\,\\mathrm{d}{\\bm r } -      \\epsilon\\int\\delta\\phi_{k}^{*}({\\bm r})\\,\\phi_{k}({\\bm r } )     \\left ( \\sum_{a=1}^{n_{n}}\\frac{z_{a}}{|{\\bm r}-{\\bm r}_{a}| } \\right )     \\mathrm{d}{\\bm r } \\nonumber \\\\ & & \\mbox { }     + \\epsilon\\int\\delta\\phi_{k}^{*}({\\bm r})\\,\\phi_{k}({\\bm r } )     \\left ( \\int\\frac{\\sum_{i \\ne k}\\big|\\phi_{i}({\\bm r}\\ , ' ) \\big|^{2 } }       { |{\\bm r}-{\\bm r}\\ , ' |}\\mathrm{d}{\\bm r}\\ , ' \\right )     \\mathrm{d}{\\bm r }     -\\epsilon\\,\\varepsilon_{k}\\int\\delta\\phi_{k}^{*}({\\bm r})\\,\\phi_{k}({\\bm r } )     \\,\\mathrm{d}{\\bm r } \\ .\\end{aligned}\\ ] ]    we subtract from this expression the quantity @xmath128 $ ] , so that the first four terms cancel , and we can write    @xmath129 -          \\widetilde{\\mathcal{f}}\\,\\big[\\phi_{k}^{*}\\big]}{\\epsilon } =         } \\nonumber \\\\ & & \\int \\bigg { [ } -\\frac{1}{2 } \\nabla^{2 } \\phi_{k}({\\bm r } ) -       \\left ( \\sum_{a=1}^{n_{n}}\\frac{z_{a } }               { |{\\bm r}-{\\bm r}_{a}| } \\right ) \\phi_{k}({\\bm r } ) \\nonumber \\\\ & & \\mbox { }    + \\left ( \\int\\frac{\\sum_{i \\ne k}|\\phi_{i}({\\bm r}\\ , ' ) |^{2 } }           { |{\\bm r}-{\\bm r}\\ , ' |}\\,\\mathrm{d}{\\bm r}\\ , ' \\right )              \\phi_{k}({\\bm r } ) - \\varepsilon_{k}\\phi_{k}({\\bm r } ) \\bigg { ] }        \\,\\delta\\phi_{k}^{*}({\\bm r } ) \\,\\mathrm{d}{\\bm r } \\ .\\end{aligned}\\ ] ]    now , by simple inspection of the right - hand side , we see that the functional derivative ( see eq .",
    "( [ eq : def_funct_der ] ) ) is the part enclosed by square brackets :    @xmath130 }       { \\delta \\phi_{k}^{*}}=   \\left ( - \\frac{1}{2}\\nabla^{2 } + \\hat{v}_{e}({\\bm r } ) +           \\hat{v}_{e}^{k}({\\bm r } ) - \\varepsilon_{k } \\right )         \\phi_{k}({\\bm r } ) \\ , \\ ] ]    where the _ nuclear potential energy _ and the _ electronic potential energy _ have been respectively defined as compare the notation with the one in eqs .",
    "( [ eq : chqc_ham_tot_op ] ) , here a subindex @xmath10 has been dropped to distinguish the new objects defined . ]",
    "[ eq : chqc_potentials_h ] @xmath131    finally , if we ask the functional derivative to be zero for @xmath122 , we arrive to the equations that the stationary points must satisfy , the",
    "_ hartree equations _ :    @xmath132 \\ , \\phi_{k}({\\bm r } ) : = \\left ( - \\frac{1}{2}\\nabla^{2 } + \\hat{v}_{n}({\\bm r } ) +            \\hat{v}_{e}^{k}({\\bm r } ) \\right ) \\phi_{k}({\\bm r } ) =             \\varepsilon_{k}\\,\\phi_{k}({\\bm r})\\ , \\ ] ]    for all @xmath122 .",
    "let us note that , despite the fact that the object @xmath133 $ ] defined above is not a operator strictly speaking , since , as the notation emphasizes , it depends on the orbitals @xmath134 , we will stick to the name _ hartree operator _ for it , in order to be consistent with most of the literature .",
    "now , some remarks related to the hartree equations are worth making .",
    "first , it can be shown that , if the variational ansatz in eq .",
    "( [ eq : chqc_constraint_total_h ] ) included the spin degrees of freedom of the electrons , all the expressions above would be kept , simply changing the orbitals @xmath135 by the spin - orbitals @xmath136 .",
    "secondly , and moving into more conceptual playgrounds , we note that the special structure of @xmath137 in eq .",
    "( [ eq : chqc_potentials_h_b ] ) makes it mandatory to interpret the hartree scheme as one in which each electron ` feels ' only the average effect of the rest .",
    "in fact , if the _ quantum charge density _",
    "@xmath138 is regarded for a moment as a classical continuum distribution , then the potential produced by all the electrons but the @xmath139-th is precisely the one in eq .",
    "( [ eq : chqc_potentials_h_b ] ) . supporting this image , note also",
    "the fact that , if we write the joint probability density of electron 1 being at the point @xmath140 , electron @xmath141 being at the point @xmath142 and so on ( simply squaring eq .",
    "( [ eq : chqc_constraint_total_h ] ) ) ,    @xmath143    we see that , _ in a probabilistic sense _ , the electrons are independent ( they could not be independent in a physical , complete sense , since we have already said that they ` see ' each other in an average way ) .    anyway , despite these appealing images and also despite the fact that , disguised under the misleading ( albeit common ) notation , these equations seem ` one - particle ' , they are rather complicated from a mathematical point of view . on the one hand , it is true that , whereas the original electronic schrdinger equation in  ( [ eq : chqc_bo_summary_a ] ) depended on @xmath144 spatial variables , the expressions above only depend on 3 .",
    "this is what we have gained from drastically reducing the search space to the set of hartree products in eq .",
    "( [ eq : chqc_constraint_total_h ] ) and what renders the approximation tractable . on the other hand , however , we have paid the price of greatly increasing the mathematical complexity of the expressions , so that , while the electronic schrdinger equation was one linear differential equation , the hartree ones in  ( [ eq : chqc_hartree_eqs ] ) are @xmath4 coupled non - linear integro - differential equations @xcite .",
    "this complexity precludes any analytical approach to the problem and forces us to look for the solutions using less reliable iterative methods .",
    "typically , in computational studies , one proposes a _ starting guess _ for the set of @xmath4 orbitals @xmath145 ; with them , the hartree operator @xmath146 $ ] in the left - hand side of eq .",
    "( [ eq : chqc_hartree_eqs ] ) is constructed for every @xmath139 and the @xmath4 equations are solved as simple eigenvalue problems . for each @xmath139 , the @xmath147 that corresponds to the lowest @xmath148 is selected and a new hartree operator @xmath149 $ ] is constructed with the  @xmath150 . the process is iterated until ( hopefully ) the @xmath151-th set of solutions @xmath152 differ from the one @xmath153 less than a reasonably small amount .",
    "many technical issues exist that raise doubts about the possible success of such an approach . the most important ones being related to the fact that a proper definition of the _ hartree problem _ should be : _ find the global minimum of the energy functional @xmath154 under the constraint that the wavefunction @xmath112 be a hartree product _ and not : _ solve the hartree equations _  ( [ eq : chqc_hartree_eqs ] ) , whose solutions indeed include the global minimum sought but also all the rest of stationary points .    while the possibility that a found solution be a maximum or a saddle point can be typically ruled out @xcite , as we remarked in sec .  [ sec : qc_variational ] and due to the fact that there are an infinite number of solutions to the hartree equations @xcite , to be sure that any found minimum is the global one is impossible in a general case",
    ". there exists , however , one way , related to a theorem by simon and lieb @xcite , of hopefully biasing a particular found solution of the hartree equations to be the global minimum that we are looking for .",
    "they showed that , first , for neutral or positively charged molecules ( @xmath155 ) , the hartree global minimization problem has a solution ( its uniqueness is not established yet @xcite ) and , second , that the minimizing orbitals @xmath156 correspond to the lowest eigenvalues of the  @xmath133 $ ] operators self - consistently constructed with them in quantum chemistry , where the number of electrons considered is typically small , the version of the hartree equations that is used is the one derived here , with the hartree operators depending on the index  @xmath139 in a non - trivial way .",
    "however , if the number of electrons is large enough ( such as in condensed matter applications ) , is customary to add to the effective electronic repulsion in eq .",
    "( [ eq : chqc_potentials_h_b ] ) the self - interaction of electron @xmath139 with himself .",
    "in such a case , the hartree operator is independent of @xmath139 so that , after having achieved self - consistency , the orbitals @xmath157 turn out to be eigenstates corresponding to different eigenvalues of the same hermitian operator , @xmath158 $ ] , and , therefore , mutually orthogonal . ] . now , although _ the reverse of the second part of the theorem is not true in general _",
    "( i.e. , from the fact that a particular set of orbitals are the eigenstates corresponding to the lowest eigenvalues of the associated hartree operators , does not necessarily follow that they are the ones that minimize the energy ) @xcite , in practice , the insight provided by lieb and simon s result is invoked to build each successive state in the iterative procedure described above , choosing the lowest lying eigenstates each time . in this way , although one can not be sure that the global minimum has been reached , the fact that the found one has a property that the former also presents is regarded as a strong hint that it must be so ( see also the discussion for the hartree - fock case in the next section ) .",
    "this drawback and all the problems arising from the fact that an iterative procedure such as the one described above could converge to a fixed point , oscillate eternally or even diverge , are circumvented in practice by a clever choice of the starting guess orbitals  @xmath145 .",
    "if they are extracted , for example , from a slightly less accurate theory , one may expect that they could be ` in the basin of attraction ' of the true hartree minimum ( so that the stationary point found will be the correct one ) and close to it ( so that the iterative procedure will converge ) .",
    "this kind of wishful thinking combined with large amounts of heuristic protocols born from many decades of trial - and - error - derived knowledge pervade and make possible the whole quantum chemistry discipline .",
    "the hartree theory discussed in the previous section is not much used in quantum chemistry and many textbooks on the subject do not even mention it .",
    "although it contains the seed of almost every concept underlying the _ hartree - fock approximation _ discussed in this section , it lacks an ingredient that turns out to be essential to correctly describe the behaviour of molecular species : _ the indistinguishability of the electrons_. this was noticed independently by fock @xcite and slater @xcite in 1930 , and it was corrected by proposing a variational ansatz for the total wavefunction that takes the form of a so - called _",
    "slater determinant _ ( see eq .  ( [ eq : chqc_constraint_total_sd_ghf ] ) below ) .",
    "the most important mathematical consequence of the indistinguishability among a set of @xmath4 quantum objects of the same type is the requirement that the total @xmath4-particle wavefunction must either remain unchanged ( _ symmetric _ ) or change sign ( _ antisymmetric _ ) when any pair of coordinates , @xmath110 and @xmath159 , are swapped . in the first case ,",
    "the particles are called _ bosons _ and must have integer spin , while in the second case , they are called _ fermions _ and have semi - integer spin .",
    "electrons are fermions , so the total wavefunction must be antisymmetric under the exchange of any pair of one - electron coordinates .",
    "this is a property that is certainly not met by the single hartree product in eq .",
    "( [ eq : chqc_constraint_total_h ] ) but that can be easily implemented by forming linear combinations of many of them . the trick is to add all the possible hartree products that are obtained from eq .",
    "( [ eq : chqc_constraint_total_h ] ) changing the order of the orbitals labels while keeping the order of the coordinates ones it is immaterial whether the orbitals labels are kept and the coordinates ones changed or vice versa . ] , and assigning to each term the sign of the permutation @xmath160 needed to go from the natural order @xmath161 to the corresponding one @xmath162 . the sign of a permutation @xmath160 is 1 if @xmath160 can be written as a composition of an even number of two - element transpositions , and it is @xmath163 if the number of transpositions needed is odd .",
    "therefore , we define @xmath164 as the minimum number it can be shown that the parity of all decompositions of @xmath160 into products of elementary transpositions is the same . we have chosen the minimum only for @xmath164 to be well defined . ] of transpositions needed to perform the permutation @xmath160 , and we write the sign of  @xmath160 as @xmath165 .    using this ,",
    "an antisymmetric wavefunction constructed from hartree products of @xmath4 different orbitals may be written as    @xmath166    where the factor @xmath167 enforces normalization of the total wavefunction @xmath67 ( if we use the constraints in eq .",
    "( [ eq : chqc_constraint_mono_ghf ] ) ) and @xmath168 denotes the _ symmetric group _ of order @xmath4 , i.e. , the set of all permutations of @xmath4 elements ( with a certain multiplication rule ) .",
    "the above expression is more convenient to perform the calculations that lead to the hartree - fock equations , however , there is also a compact way of rewriting eq .",
    "( [ eq : chqc_constraint_total_ghf ] ) which is commonly found in the literature and that is useful to illustrate some particular properties of the problem .",
    "it is the _ slater determinant _ :",
    "@xmath169    now , having established the constraints on the form of the total wavefunction , we ask the hartree - fock one - electron orbitals to be , not only normalized , like we did in the hartree case , but also mutually orthogonal :    @xmath170    additionally note that , contrarily to what we did in the previous section , we have now used one - electron wavefunctions @xmath171 dependent also on the spin @xmath27 ( i.e. , spin - orbitals ) to construct the variational ansatz .",
    "general _ spin - orbital note that , if we had not included the spin degrees of freedom , the search space would have been half as large , since , where we now have @xmath118 functions of @xmath172 ( i.e. , @xmath173 and @xmath174 , with @xmath175 ) , we would have had just @xmath4 ( the @xmath176 ) . ] may be written as ( see also footnote  [ foot : spin_convenient ] in page  )    @xmath177    where the functions @xmath14 and @xmath178 correspond to the _ spin - up _ and _ spin - down _ eigenstates of the operator associated to the @xmath74-component of the one - electron spin .",
    "they are defined as    @xmath179    the formalism obtained when these general spin - orbitals are used is accordingly called _ eneral artree - ock _  ( ghf ) .",
    "the first part of the mathematical treatment in the following paragraphs shall be performed assuming this situation .",
    "the advantage of such a choice is that , later on , by imposing additional constraints to the spin part of the one - electron orbitals , we will be able to derive the basic equations for some other flavours of the hartree - fock theory , such as uhf , rhf and rohf , in a very direct way .",
    "now , to calculate the expected value of the energy in a state such as the one in eqs .",
    "( [ eq : chqc_constraint_total_ghf ] ) and  ( [ eq : chqc_constraint_total_sd_ghf ] ) , let us denote the one - particle part ( that operates on the @xmath12-th coordinates ) of the total electronic hamiltonian @xmath79 in eq .",
    "( [ eq : chqc_el_ham_1 ] ) by    @xmath180    in such a way that ,    @xmath181    where @xmath182 .",
    "[ page : one_e_calculation ]    we shall compute separately each one of the sums in the expression above . let us start now with the first one : for a given @xmath12 in the sum , and due to the structure of the electronic wavefunction in  ( [ eq : chqc_constraint_total_ghf ] ) , the expected value @xmath183 is a sum of @xmath184 terms of the form    @xmath185    but , since @xmath186 operates only on @xmath187 and due to the orthogonality of the spin - orbitals with different indices , we have that the only non - zero terms are those with @xmath188 . taking this into account ,",
    "all permutations @xmath160 appear still as terms of the sum , and we see that every orbital @xmath189 occurs depending on every coordinate @xmath187 . given a particular pair @xmath12 and @xmath190 , this happens in the terms for which @xmath191 and one of such terms may be expressed as    @xmath192    where we have used that @xmath193 , and we have dropped the index @xmath12 from @xmath186 noticing that the integration variables in @xmath194 are actually dummy .",
    "next , we use again the one - electron wavefunctions constraints in eq .",
    "( [ eq : chqc_constraint_mono_ghf ] ) to remove the product of norms in brackets , and we realize that , for each @xmath190 , there are as many terms like the one in the expression above as permutations of the remaining @xmath195 orbital indices ( i.e. , @xmath196 ) . in addition , we recall that every @xmath190 must appear and perform the first sum in eq .",
    "( [ eq : chqc_expected_h_ghf ] ) , yielding    @xmath197    where all factorial terms have canceled out .",
    "the next step is to calculate the second sum in eq .",
    "( [ eq : chqc_expected_h_ghf ] ) .",
    "again , we have that , for each pair  @xmath198 , @xmath199 is a sum of @xmath184 terms like    @xmath200    [ page : two_e_calculation ]    for this expected value , contrarily to the case of @xmath186 and due to the two - body nature of the operator @xmath201 , not only do the terms with @xmath188 survive , but also those in which @xmath160 and @xmath202 differ over only a pair of values @xmath12 and @xmath190 , i.e. , those for which @xmath203 , @xmath204 and @xmath205 .",
    "the reason for this is that , even if @xmath206 and @xmath207 , the integral @xmath208 does not vanish .    now , using that @xmath201 operates only on @xmath187 and @xmath209 , the orthonormality conditions in eq .",
    "( [ eq : chqc_constraint_mono_ghf ] ) and the fact that @xmath193 , we have that , when @xmath210 depends on @xmath187 and @xmath211 depends on  @xmath209 , the @xmath188 part of the corresponding terms in eq .",
    "( [ eq : chqc_calculation_rij_1 ] ) reads    @xmath212    where we have defined    @xmath213    next , we see that , for each pair @xmath214 , and keeping @xmath215 , we can make @xmath216 permutations among the @xmath217 indices of the orbitals on which @xmath201 does not operate and still find the same expression  ( [ eq : chqc_calculation_rij_2 ] ) . therefore , for each pair @xmath214 , we have a sum of @xmath216 identical terms .",
    "in addition , if we perform the sum on @xmath12 and @xmath190 in eq .",
    "( [ eq : chqc_expected_h_ghf ] ) and remark that the term in eq .",
    "( [ eq : chqc_calculation_rij_2 ] ) does not depend on the pair @xmath198 ( which is obvious from the suggestive notation above ) , we have that the @xmath188 part of the second sum in eq .",
    "( [ eq : chqc_expected_h_ghf ] ) , which is typically called _ coulomb energy _ , reads    @xmath218    where we have used that the sum @xmath219 is performed on @xmath220 identical terms which do not depend neither on @xmath12 nor on @xmath190 .    on the other hand , in the case in which @xmath160 and @xmath202 only differ in that the indices of the orbitals that depend on @xmath110 and @xmath159 are swapped ,",
    "all the derivation above applies except for the facts that , first , @xmath221 and , second , the indices @xmath139 and @xmath222 must be _ exchanged _ in eq .",
    "( [ eq : chqc_calculation_rij_3 ] ) ( it is immaterial if they are exchanged in the bra or in the ket , since the indices are summed over and are dummy ) . henceforth , the remaining part of the second sum in eq .",
    "( [ eq : chqc_expected_h_ghf ] ) , typically termed _ exchange energy _ , may be written as    @xmath223    finally , the expected value of the energy in the ghf variational state @xmath67 turns out to be    @xmath224    where the _ one - electron integrals _ @xmath225 have been defined together with the _ two - electron integrals _ , @xmath226 and @xmath227 , and the fact that @xmath228 has been used to include the diagonal terms in the second sum .",
    "now , the energy functional above is the quantity that we want to minimize under the orthonormality constraints in eq .",
    "( [ eq : chqc_constraint_mono_ghf ] ) .",
    "so we are prepared to write the auxiliary functional @xmath120 , introducing @xmath229 lagrange multipliers @xmath230 ( see eq .",
    "( [ eq : chqc_constrained_functional ] ) and compare with the hartree example in the previous section ) :    @xmath231 =    \\sum_i h_i + \\frac{1}{2 } \\sum_{i , j } ( j_{ij}-k_{ij } ) -   \\sum_{i , j } \\lambda_{ij}\\ ,     \\big ( \\langle\\psi_{i}|\\psi_{j}\\rangle-\\delta_{ij } \\big ) \\ .\\ ] ]    in order to get to the _ hartree - fock equations _ that the stationary orbitals @xmath210 must satisfy , we impose that the functional derivative of @xmath232 $ ] with respect to @xmath233 be zero . to calculate @xmath234 , we follow the procedure described in appendix  a , using the same notation as in eq .",
    "( [ eq : chqc_h_step_2 ] ) .",
    "the variation with respect to each @xmath233 shall yield the hartree - fock equations for the unconjugated @xmath171 .",
    "the equations for the @xmath235 are obtained either by differentiating @xmath232 $ ] with respect to each @xmath210 or , if the @xmath230 matrix is hermitian ( which will turn out to be the case ) , by simply taking the complex conjugate of both sides of the final equations in  ( [ eq : chqc_hf_eqs_v1_ghf ] ) .",
    "now ,    @xmath236 -          \\widetilde{\\mathcal{f}}\\,\\big[\\psi_{k}^{*}\\big]}{\\epsilon } =         } \\nonumber \\\\ & & \\langle\\delta\\psi_{k}|\\,\\hat{h}\\,|\\psi_{k}\\rangle +        \\sum_j\\bigg(\\langle\\delta\\psi_k\\psi_j|\\,\\frac{1}{r}\\,|\\psi_k\\psi_j\\rangle    -   \\langle\\delta\\psi_k\\psi_j|\\,\\frac{1}{r}\\,|\\psi_j\\psi_k\\rangle\\bigg )    -   \\sum_j \\lambda_{kj } \\langle\\delta\\psi_{k}|\\psi_{j}\\rangle =     \\nonumber \\\\ & & \\int \\bigg { [ } \\hat{h}\\,\\psi_{k}(x )    + \\sum_j \\left ( \\psi_k(x ) \\!\\ !",
    "\\int      \\frac{|\\psi_{j}(x^{\\prime})|^{2 } }       { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime }    - \\psi_j(x ) \\!\\ !",
    "\\int      \\frac{\\psi^{*}_{j}(x^{\\prime})\\,\\psi_{k}(x^{\\prime } ) }       { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\right )   \\nonumber \\\\ & & \\mbox { }    - \\sum_j \\lambda_{kj}\\,\\psi_{j}(x ) \\bigg { ] }        \\,\\delta\\psi_{k}^{*}(x ) \\,\\mathrm{d}x \\ , \\end{aligned}\\ ] ]    where we have used the more compact notation @xmath237 instead of @xmath238 .    then , like in the previous section , by simple inspection of the right - hand side , we see that the functional derivative is the part enclosed by square brackets ( see eq .",
    "( [ eq : def_funct_der ] ) ) :    @xmath239 }       { \\delta \\psi_{k}^{*}}=   \\left[\\hat{h } + \\sum_j \\big(\\hat{j}_{j}[\\psi]-          \\hat{k}_{j}[\\psi]\\big)\\right]\\psi_{k}(x)-          \\sum_j\\lambda_{kj}\\psi_{j}(x ) \\ , \\ ] ]    where the _ coulomb _ and _ exchange operators _ are respectively defined by their action on an arbitrary function @xmath240 as follows like in the hartree case in the previous section , the word _",
    "operator _ is a common notational abuse if they act upon the very @xmath171 on which they depend .",
    "this is again made explicit in the notation . ] :    [ eq : chqc_operators_ghf ] @xmath241\\,\\varphi(x):=\\left(\\int\\frac{|\\psi_{j}(x^{\\prime})|^{2 } }           { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\right )               \\varphi(x)\\ , \\label{eq : chqc_operators_ghf_a } \\\\ & \\hat{k}_{j}[\\psi]\\,\\varphi(x):= \\left (               \\int\\frac{\\psi^{*}_{j}(x^{\\prime})\\,\\varphi(x^{\\prime } ) }           { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\right )               \\psi_{j}(x)\\ .",
    "\\label{eq : chqc_operators_ghf_b } \\end{aligned}\\ ] ]    therefore , if we define the ghf _ fock operator",
    "_ as    @xmath242:= \\hat{h}+\\sum_j \\big(\\hat{j}_{j}[\\psi]-\\hat{k}_{j}[\\psi]\\big ) \\ , \\ ] ]    we arrive to a first version of the _ hartree - fock equations _ by asking that the functional derivative in eq .",
    "( [ eq : chqc_funct_der_ghf ] ) be zero :    @xmath243\\,\\psi_{i}(x)=\\sum_j\\lambda_{ij}\\psi_{j}(x)\\ ,   \\qquad i=1,\\ldots , n\\ .\\ ] ]    now , in order to obtain a simpler version of them , we shall take profit from the fact that the whole problem is invariant under a unitary transformation among the one - electron orbitals .    if we repeat the calculation in eq .",
    "( [ eq : chqc_limit_ghf ] ) but varying @xmath210 this time , instead of @xmath244 , and use the following relation :    @xmath245\\psi_j(x)\\mathrm{d}x    \\ , \\ ] ]    we arrive to the ghf equations for the conjugated spin - orbitals :    @xmath246\\,\\psi^*_{i}(x)=\\sum_j\\lambda_{ji}\\psi^*_{j}(x)\\ .",
    "\\qquad i=1,\\ldots , n\\ .\\ ] ]    then , we may subtract the complex conjugate of eq .",
    "( [ eq : chqc_hf_eqs_v1_ghf_conj ] ) from eq .",
    "( [ eq : chqc_hf_eqs_v1_ghf ] ) yielding    @xmath247    therefore , since the set of the @xmath189 is orthogonal and hence linearly independent , we have that the @xmath248 matrix @xmath249 of lagrange multipliers is hermitian :",
    "@xmath250    this actually means that we have a set of three equations that the stationary spin - orbitals satisfy , but only two of them are independent .",
    "these equations are the ghf equations for the @xmath171 and @xmath235 , in  ( [ eq : chqc_hf_eqs_v1_ghf ] ) and  ( [ eq : chqc_hf_eqs_v1_ghf_conj ] ) , respectively , and  ( [ eq : chqc_lambdakjjk_ghf_herm ] )",
    ". any pair of them could be in principle be chosen as the basic equations , however , in common practice the first and the last one of them are typically picked .",
    "in any case , due to  ( [ eq : chqc_lambdakjjk_ghf_herm ] ) , a unitary matrix @xmath251 exists that _ diagonalizes _",
    "@xmath252 ; in the sense that @xmath253 is a diagonal matrix , i.e. , @xmath254 . using this unitary matrix @xmath251",
    ", we can transform the set of orbitals @xmath255 into a new one @xmath256 :    @xmath257    this transformation is physically legitimate since it only changes the @xmath4-electron wavefunction  @xmath67 in an unmeasurable phase @xmath258 . to see this ,",
    "let us denote by @xmath259 the @xmath260-element of the matrix inside the slater determinant in eq .",
    "( [ eq : chqc_constraint_total_sd_ghf ] ) , i.e. , @xmath261 .",
    "then , after using the expression above , the @xmath260-element of the new matrix @xmath262 can be related to the old ones via @xmath263 , in such a way that @xmath264 and the desired result follows :    @xmath265    now , we insert eq .",
    "( [ eq : chqc_transformation_phi_ghf ] ) into the first version of the hartree - fock equations in  ( [ eq : chqc_hf_eqs_v1_ghf ] ) :    @xmath266\\,\\left(\\sum_j     u_{ij}\\psi^{\\prime}_{j}(x)\\right)=   \\sum_{j , k}\\lambda_{ij}u_{jk}\\psi^{\\prime}_{k}(x)\\ ,   \\qquad i=1,\\ldots , n\\ .\\ ] ]    next , we multiply by @xmath267 each one of the @xmath4 expressions and sum in @xmath12 :    @xmath268\\,\\left(\\sum_{i , j } \\underbrace{u^{-1}_{li}u_{ij}}_{\\displaystyle \\delta_{lj } }                                  \\psi^{\\prime}_{j}(x)\\right)=   \\sum_{i , j , k}\\underbrace{u^{-1}_{li}\\lambda_{ij}u_{jk }      } _ { \\displaystyle \\varepsilon_{lk}=\\delta_{lk}\\varepsilon_{l } }   \\psi^{\\prime}_{k}(x ) } \\nonumber \\\\[6pt ] & & \\longrightarrow\\quad \\hat{f}^\\mathrm{ghf}[u\\psi^{\\prime}]\\,\\psi^{\\prime}_{l}(x)=   \\varepsilon_{l}\\psi^{\\prime}_{l}(x)\\ ,   \\qquad l=1,\\ldots , n\\ .\\end{aligned}\\ ] ]    although this new version of the hartree - fock equations can be readily seen as a _ pseudo - eigenvalue problem _ and solved by the customary iterative methods , we can go a step further and show that , like the @xmath4-particle wavefunction @xmath67 ( see eq .",
    "( [ eq : chqc_phi_invariant_ghf ] ) ) , the fock operator @xmath269 $ ] , as a function of the one - electron orbitals , is invariant under a unitary transformation such as the one in eq .",
    "( [ eq : chqc_transformation_phi_ghf ] ) .",
    "in fact , this is true for each one of the sums of coulomb and exchange operators in eq .",
    "( [ eq : chqc_fock_op_ghf ] ) separately :    @xmath270\\,\\varphi(x)= \\sum_j \\bigg(\\int\\frac { \\left |\\sum_k u_{jk }             \\,\\psi^{\\prime}_{k}(x^{\\prime } ) \\right|^{2 } } { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\bigg)\\,\\varphi(x ) = } \\nonumber \\\\ & & \\sum_j \\bigg(\\int\\frac { \\sum_{k , l }   u^{*}_{jk}u_{jl }             \\,\\psi^{\\prime * } _ { k}(x^{\\prime } )             \\,\\psi^{\\prime}_{l}(x^{\\prime } ) } { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\bigg )               \\,\\varphi(x)= \\nonumber \\\\ & & \\bigg(\\int\\frac { \\sum_{j , k , l } u^{-1}_{kj}u_{jl }             \\,\\psi^{\\prime * } _ { k}(x^{\\prime } )             \\,\\psi^{\\prime}_{l}(x^{\\prime } ) } { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\bigg)\\,\\varphi(x)= \\nonumber \\\\ & & \\sum_k \\bigg(\\int\\frac { |\\psi^{\\prime}_{k}(x^{\\prime})|^{2 } }   { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}x^{\\prime } \\bigg)\\,\\varphi(x)=   \\sum_j \\hat{j}_{j}[\\psi^{\\prime}]\\,\\varphi(x ) \\ , \\qquad   \\forall \\varphi(x ) \\ , \\end{aligned}\\ ] ]    where , in the step before the last , we have summed on @xmath190 and @xmath222 , using that .    performing very similar calculations , one can show that    @xmath271\\,\\varphi(x ) = \\sum_j \\hat{k}_{j}[\\psi^{\\prime}]\\,\\varphi(x)\\ , \\qquad \\forall \\varphi(x ) \\ , \\ ] ]    and therefore , that @xmath272=f^\\mathrm{ghf}[\\psi^{\\prime}]$ ] .",
    "in such a way that any unitary transformation on a set of orbitals that constitute a solution of the hartree - fock equations in  ( [ eq : chqc_hf_eqs_v1_ghf ] ) yields a different set that is also a solution of _ the same _ equations . for computational and conceptual reasons ( see , for example , koopmans theorem below ) , it turns out to be convenient to use this freedom and choose the matrix  @xmath251 in such a way that the lagrange multipliers matrix is diagonalized ( see eq .",
    "( [ eq : chqc_lambdakjjk_ghf ] ) and the paragraph below it ) . the particular set of one - electron orbitals @xmath256 obtained with this  @xmath251 are called _ canonical orbitals _ and their use is so prevalent that we will circumscribe the forecoming discussion to them and drop the prime from the notation .",
    "using the canonical orbitals , the _ hartree - fock equations _ can be written as    @xmath273\\,\\psi_{i}(x)=\\varepsilon_{i}\\psi_{i}(x)\\ ,   \\qquad i=1,\\ldots , n\\ .\\ ] ]    many of the remarks related to these equations are similar to those made about the hartree ones in  ( [ eq : chqc_hartree_eqs ] ) , although there exist important differences due to the inclusion of the indistinguishability of the electrons in the variational ansatz .",
    "this is clearly illustrated if we calculate the joint probability density , associated to a wavefunction like the one in eq .",
    "( [ eq : chqc_constraint_total_ghf ] ) , of the coordinates with label 1 taking the value @xmath274 , the coordinates with label @xmath141 taking the value @xmath275 , and so on :    @xmath276    if we compare this expression with eq .",
    "( [ eq : chqc_hartree_rho ] ) , we see that the antisymmetry of @xmath67 has completely spoiled the statistical independence among the one - electron coordinates .",
    "however , there is a weaker quasi - independence that may be recovered : if , using the same reasoning about permutations that took us to the one - electron part @xmath277 of the energy functional in page  , we calculate the marginal probability density of the @xmath12-th coordinates taking the value @xmath187 , we find    @xmath278    now , since the coordinates indices are just immaterial labels , the actual probability density of finding _ any _ electron with coordinates @xmath66 is given by    @xmath279    which can be interpreted as a _ charge density _ ( except for the sign ) , as , in atomic units , the charge of the electron is @xmath280 .",
    "the picture being consistent with the fact that @xmath281 is normalized to the number of electrons",
    "@xmath4 :    @xmath282    additionally , if we perform the same type of calculations that allowed to calculate the two - electron part of the energy functional in page  , we have that the two - body probability density of the @xmath12-th coordinates taking the value  @xmath187 and of the @xmath190-th coordinates taking the value @xmath209 reads    @xmath283    and , if we reason in the same way as in the case of @xmath284 , in order to get to the probability density of finding _ any _ electron with coordinates @xmath66 at the same time that _ any other _ electron has coordinates @xmath285 , we must multiply the function above by @xmath286 , which is the number of immaterial @xmath198-labelings , taking into account that the distinction between @xmath66 and @xmath285 is also irrelevant :    @xmath287    finally , taking eq .",
    "( [ eq : chqc_qrhoi_ghf ] ) to this one , we have    @xmath288    where the first term corresponds to independent electrons and the second one , called the _ interference term _",
    ", could be interpreted as an exchange correction .    although , in general , this is the furthest one may go , when additional constraints are imposed on the spin part of the one - electron wavefunctions ( see the discussion about restricted hartree - fock in the following pages , for example ) , the exchange correction in eq .",
    "( [ eq : chqc_qrhoij_qrhoi_ghf ] ) above vanishes for electrons of opposite spin , i.e. , electrons of opposite spin turn out to be pairwise independent . however , whereas it is true that more correlation could be added to the hartree - fock results by going to higher levels of the theory and , in this sense , hartree - fock could be considered the first step in the ` correlation ladder ' , one should not regard it as an ` uncorrelated ' approximation , since , even in the simplest case of rhf ( see below ) , hartree - fock electrons ( of the same spin ) are statistically correlated .",
    "all of this has its roots in the _ pauli principle _ , which states that no pair of electrons can share all the quantum numbers .",
    "let us now point out that , like in the hartree case , the left - hand side of the hartree - fock equations in  ( [ eq : chqc_hf_eqs_vfinal_ghf ] ) is a complicated , non - linear function of the orbitals  @xmath255 and the notation chosen is intended only to emphasize the nature of the iterative protocol that is typically used to solve the problem .",
    "however , note that , while the hartree operator @xmath133 $ ] depended on the index of the orbital @xmath157 on which it acted , the fock operator in eq .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) is the same for all the spin - orbitals @xmath171 .",
    "this is due to the inclusion of the @xmath289 terms in the sum of the coulomb and exchange two - electron integrals in eq .",
    "( [ eq : chqc_expected_h_2_ghf ] ) and it allows to perform the iterative procedure solving only one eigenvalue problem at each step , instead of @xmath4 of them like in the hartree case ( see however the uhf and rohf versions of the hartree - fock problem in what follows ) .    the one - particle appearance of eqs .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) is again strong and , whereas the ` eigenvalues ' @xmath116 are not the energies of the individual electrons , they are called _",
    "orbital energies _ due to the physical meaning they receive via the well - known _ koopmans theorem _ @xcite .    to get to this result ,",
    "let us multiply eq .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) from the left by @xmath290 , for a given @xmath12 , and then integrate over @xmath66 . using the definition of the fock operator in eq .",
    "( [ eq : chqc_fock_op_ghf ] ) together with the coulomb and exchange ones in eqs .",
    "( [ eq : chqc_operators_ghf ] ) , we obtain    @xmath291    where we have used the same notation as in eq .",
    "( [ eq : chqc_expected_h_2_ghf ] ) and the fact that the one - electron orbitals are normalized .    if we next sum on @xmath12 and compare the result with the expression in eq .",
    "( [ eq : chqc_expected_h_2_ghf ] ) , we found that the relation of the eigenvalues @xmath116 with the actual hartree - fock energy is given by    @xmath292    [ page : koopman ]    finally , if we assume that upon ` removal of an electron from the @xmath139-th orbital ' the rest of the orbitals will remain unmodified , we can calculate the _ ionization energy _ using the expression in  ( [ eq : chqc_expected_h_2_ghf ] ) together with the equations above :    @xmath293    and this is koopmans theorem , namely , that _ the @xmath139-th ionization energy in the frozen - orbitals approximation is @xmath294_.    moving now to the issue about the solution of the hartree - fock equations in  ( [ eq : chqc_hf_eqs_vfinal_ghf ] ) , we must remark that the necessity of using the relatively unreliable iterative approach to tackle them stems again from their complicated mathematical form .",
    "like in the hartree case , we have managed to largely reduce the dimension of the space on which the basic equations are defined : from @xmath144 in the electronic schrdinger equation in  ( [ eq : chqc_bo_summary_a ] ) to 3 in the hartree - fock ones .",
    "however , to have this , we have payed the price of dramatically increasing their complexity @xcite , since , while the electronic schrdinger equation was one linear differential equation , the hartree - fock ones in  ( [ eq : chqc_hf_eqs_vfinal_ghf ] ) are @xmath4 coupled non - linear integro - differential equations , thus precluding any analytical approach to their solution .",
    "a typical iterative procedure the process described in this paragraph must be taken only as an outline of the one that is performed in practice .",
    "it is impossible to deal in a computer with a general function as it is ( a non - countable infinite set of numbers ) , and the problem must be discretized in some way .",
    "the truncation of the one - electron hilbert space using a finite basis set , described in secs .",
    "[ sec : qc_roothaan ] and  [ sec : qc_basis_sets ] , is the most common way of doing this .",
    "moreover , the iterative procedure is normally performed using not the spin - orbitals but the spatial ones . in this sense , the restricted versions of the hartree - fock problem , discussed below , are closer to the actual implementation of the theory in computer applications . ]",
    "begins by proposing a _ starting guess _ for the set of @xmath4 spin - orbitals @xmath295 . with them ,",
    "the fock operator @xmath296 $ ] in the left - hand side of eq .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) is constructed and the set of @xmath4 equations is solved as one simple eigenvalue problem . then , the @xmath297 that correspond to the @xmath4 lowest eigenvalues @xmath298 are selected ( see the discussion of the aufbau principle below ) and a new fock operator @xmath299 $ ] is constructed with them .",
    "the process is iterated until ( hopefully ) the @xmath151-th set of solutions @xmath300 differs from the @xmath301-th one @xmath302 less than a reasonably small amount ( defining the distance among solutions in some suitable way typically combined with a convergence criterium related to the associated energy change ) .",
    "when this occurs , the procedure is said to have converged and the solution orbitals are called _ self - consistent _ ; also , a calculation of this kind is commonly termed _ elf - onsistent ield _ ( scf ) .    again , like in the hartree case , many issues exist that raise doubts about the possible success of such an approach .",
    "the most important ones are related to the fact that a proper definition of the _ hartree - fock problem _ should be : _ find the global minimum of the energy functional @xmath303 under the constraint that the wavefunction @xmath67 be a slater determinant of one - electron spin - orbitals _ , and not : _ solve the hartree - fock equations _  ( [ eq : chqc_hf_eqs_vfinal_ghf ] ) .",
    "the solutions of the latter are all the stationary points of the constrained energy functional , while we are interested only in the particular one that is the global minimum . even ruling out the possibility that a found solution may be a maximum or a saddle point ( which can be done @xcite )",
    ", one can never be sure that it is the global minimum and not a local one .",
    "there exists , however , one way , related to the hartree - fock version of the theorem by simon and lieb @xcite mentioned in the previous section , of hopefully biasing a particular found solution of eqs .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) to be the global minimum that we are looking for .",
    "they showed , first , that for neutral or positively charged molecules ( @xmath304 ) , the hartree - fock global minimization problem has a solution ( its uniqueness is not established yet @xcite ) and , second , that the minimizing orbitals @xmath255 correspond to the @xmath4 lowest eigenvalues of the fock operator @xmath269 $ ] that is self - consistently constructed with them .",
    "therefore , although _ the reverse is not true in general _",
    "@xcite ( i.e. , from the fact that a particular set of orbitals are the eigenstates corresponding to the lowest eigenvalues of the associated fock operator , does not necessarily follow that they are the optimal ones ) , the information contained in simon and lieb s result is typically invoked to build each successive state in the iterative procedure described above by keeping only the @xmath4 orbitals that correspond to the @xmath4 lowest eigenvalues @xmath116 . indeed , by doing that",
    ", one is effectively constraining the solutions to have a property that the true solution does have , so that , in the worst case , the space in which one is searching is of the same size as the original one , and , in the best case ( even playing with the possibility that the reverse of simon and lieb s theorem be true , though not proved ) , the space of solutions is reduced to the correct global minimum alone .",
    "this wishful - thinking way of proceeding is termed the _ aufbau principle _",
    "@xcite , and , together with a clever choice of the starting - guess set of orbitals @xcite ( typically extracted from a slightly less accurate theory , so that one may expect that it could be ` in the basin of attraction ' of the true hartree - fock minimum ) , constitute one of the many heuristic strategies that make possible that the aforementioned drawbacks ( and also those related to the convergence of iterative procedures ) be circumvented in real cases , so that , in practice , most of scf calculations performed in the field of quantum chemistry do converge to the true solution of eqs .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) in spite of the theoretical notes of caution .",
    "now , to close this ghf part , let us discuss some points regarding the imposition of constraints as a justification for subsequently introducing three commonly used forms of the hartree - fock theory that involve additional restrictions on the variational ansatz ( apart from those in eqs .",
    "( [ eq : chqc_constraint_total_ghf ] ) and ( [ eq : chqc_constraint_mono_ghf ] ) ) .    in principle",
    ", the target systems in which we are interested in our group and to which the theory developed in this work is meant to be applied are rather complex ( short peptides , small ligands , etc . ) .",
    "they have many degrees of freedom and the different interactions that drive their behaviour typically compete with one another , thus producing complicated , ` frustrated ' energy landscapes ( see refs .",
    "@xcite , but note , however , that we do not need to think about macromolecules ; a small molecule like co@xmath305 already has 22 electrons ) .",
    "this state of affairs renders the a priori assessment of the accuracy of any approximation to the exact equations an impossible task . as researchers calculate more and more properties of molecular species using quantum chemistry and the results",
    "are compared to higher - level theories or to experimental data , much empirical knowledge about ` how good is theory  a for calculating property  x ' is being gathered . however",
    ", if the characterization of a completely new molecule that is not closely related to any one that has been previously studied is tackled with , say , the hartree - fock approximation , it would be very unwise not to ` ask for a second opinion ' .",
    "all of this also applies , word by word , to the choice of the constraints on the wavefunction in variational approaches like the one discussed in this section : for example , it is impossible to know a priori what will be the loss of accuracy due to the requirement that the @xmath4-particle wavefunction @xmath67 be a slater determinant as in eq .",
    "( [ eq : chqc_constraint_total_ghf ] )",
    ". however , in the context of the hartree - fock approximation , there exists a way of proceeding , again , partly based on wishful thinking and partly confirmed by actual calculations in particular cases , that is almost unanimously used to choose additional constraints which are expected to yield more _ efficient _ theories .",
    "it consists of imposing constraints to the variational wavefunction that are _ properties that the exact solution to the problem does have_. in such a way that the obvious loss of accuracy due to the reduction of the search space is expected to be minimized , while the decrease in computational cost could be considerable .    this way of thinking is clearly illustrated by the question of whether or not one should allow that the one - electron spin - orbitals @xmath171 ( and therefore the total wavefunction @xmath67 ) be complex valued . indeed , due to the fact that the electronic hamiltonian in eq",
    "( [ eq : chqc_el_ham_1 ] ) is self - adjoint , the real and imaginary parts of any complex eigenfunction solution of the time independent schrdinger equation in  ( [ eq : chqc_bo_summary_a ] ) are also solutions of it @xcite .",
    "therefore , the ground - tate , which is the exact solution of the problem that we are trying to solve , may be chosen to be real valued .",
    "nevertheless , the exact minimum will not be achieved , in general , in the smaller space defined by the hartree - fock constraints in eqs .",
    "( [ eq : chqc_constraint_total_ghf ] ) and ( [ eq : chqc_constraint_mono_ghf ] ) , so that there is no a priori reason to believe that allowing the hartree - fock wavefunction to take complex values would not improve the results by finding a lower minimum .",
    "in fact , in some cases , this happens @xcite .",
    "nevertheless , if one constrains the search to real orbitals , the computational cost is reduced by a factor two , and , after all , the whole formalism discussed in this work profits from the imposition of constraints ( starting by the consideration of only one slater determinant ) , all of which save some computational effort at the expense of a reduction in the accuracy .",
    "the search for the most efficient of these approximations constitutes the main part of the quantum chemistry field .",
    "apart from these ` complex vs. real ' considerations , there exist three further restrictions that are commonly found in the literature and that affect the spin part of the one - electron orbitals @xmath171 .",
    "the @xmath4-electron wavefunction @xmath67 of the ghf approximation ( which is the one discussed up to now ) is not an eigenstate of the total - spin operator , @xmath306 , nor of the @xmath74-component of it , @xmath307 @xcite .",
    "however , since both of them commute with the electronic hamiltonian in eq .",
    "( [ eq : chqc_el_ham_1 ] ) , the true ground - state of the exact problem can be chosen to be an eigenstate of both operators simultaneously .",
    "therefore three additional types of constraints on the spin part of the ghf wavefunction in  ( [ eq : chqc_constraint_total_ghf ] ) are typically made that force the variational ansatz to satisfy these ground - state properties and that should be seen in the light of the above discussion , i.e. , as reducing the search space , thus yielding an intrinsically less accurate theory , but also as being good candidates to hope that the computational savings will pay for this .",
    "the first approximation to ghf ( in a logical sense ) is called _ nrestricted artree - ock _ ( uhf ) and it consists of asking the orbitals @xmath171 to be a product of a part @xmath308 depending on the positions @xmath172 times a spin eigenstate of the one - electron @xmath309 operator , i.e. , either @xmath310 or @xmath311 ( see eq .",
    "( [ eq : chqc_alpha_beta ] ) ) .",
    "this is denoted by @xmath312 , where @xmath313 is either the @xmath14 or the @xmath178 function .",
    "now , if we call @xmath314 and @xmath315 the number of spin - orbitals of each type , we have that , differently from the ghf one , the uhf wavefunction  @xmath67 is an eigenstate of the @xmath307 operator with eigenvalue @xmath316 ( in atomic units , see sec .  [",
    "sec : qc_molecular_h ] ) .",
    "however , it is not an eigenstate of @xmath317 and , when this deviation results into a poor description of the observables in which we are interested , we talk about _ spin contamination _",
    "although the uhf wavefunction can be projected into pure @xmath317-states , the result is multideterminantal @xcite and will not be considered here since it spoils many of the properties that render hartree - fock methods a low - cost choice .",
    "regarding the computational cost of the uhf approximation , it is certainly lower than that of ghf , since the search space is half as large : in the latter case , we had to consider @xmath118 ( complex or real ) functions of @xmath125 ( the @xmath318 and the  @xmath319 , see eq .",
    "( [ eq : chqc_general_so ] ) ) , while in uhf we only have to deal with @xmath4 of them : the @xmath320 .    now",
    ", if we introduce into the expression for the ghf constrained functional in  ( [ eq : chqc_constrained_functional_ghf ] ) the following relations that hold for the uhf spin- and spatial orbitals of course , the average values at both sides of the expressions are taken over different variables : over @xmath66 and @xmath321 on the left - hand side , and over @xmath172 and @xmath322 on the right - hand side .",
    "also , let us remark that , although placing _ functions _ as arguments of the kronecker s delta @xmath323 is a bit unorthodox mathematically , it constitutes an intuitive ( and common ) notation . ]",
    "[ eq : chqc_help_relations_uhf ] @xmath324    we may perform a derivation analogous to the one performed for the ghf case , and get to a first version of the _ uhf equations _    [ eq : chqc_hf_eqs_vfinal_uhf ]",
    "@xmath325\\,\\phi_{i}({\\bm r}):= \\left(\\hat{h}+\\sum^n_j \\hat{j}_j[\\phi ] - \\sum^n_{j}\\delta_{\\gamma_i \\gamma_j }        \\hat{k}_j[\\phi ] \\right)\\,\\phi_{i}({\\bm r})= \\sum_j \\lambda_{ij}\\phi_{j}({\\bm r})\\ , \\label{eq : chqc_hf_eqs_vfinal_uhf_a}\\\\ & \\hat{f}^{\\mathrm{uhf}}_{i}[\\phi]\\,\\phi^*_{i}({\\bm r})= \\sum_j \\lambda_{ji}\\phi^*_{j}({\\bm r})\\ , \\label{eq : chqc_hf_eqs_vfinal_uhf_b}\\end{aligned}\\ ] ]    for all @xmath175 and where the coulomb and exchange operators dependent on the spatial orbitals @xmath326 are defined by their action on an arbitrary function @xmath327 as follows :    [ eq : chqc_operators_uhf ] @xmath328\\,\\varphi({\\bm r}):=               \\left ( \\int\\frac{|\\phi_{j}({\\bm r}^{\\prime})|^{2 } }         { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}{\\bm r}^{\\prime } \\right )               \\varphi({\\bm r})\\ , \\label{eq : chqc_operators_uhf_a } \\\\ & \\hat{k}_{j}[\\phi]\\,\\varphi({\\bm r}):= \\left (        \\int\\frac{\\phi^{*}_{j}({\\bm r}^{\\prime})\\,\\varphi({\\bm r}^{\\prime } ) }      { |{\\bm r}-{\\bm r}^{\\prime}|}\\,\\mathrm{d}{\\bm r}^{\\prime } \\right )               \\phi_{j}({\\bm r})\\ .",
    "\\label{eq : chqc_operators_uhf_b } \\end{aligned}\\ ] ]    now , one must note that , differently from the ghf case , due to the fact that the exchange interaction only takes place between orbitals ` of the same spin ' , the _ uhf fock operator _",
    "$ ] depends on the index @xmath12 .",
    "this precludes the solution of uhf as a _",
    "pseudoeigenvalue problem ( c.f .",
    "( [ eq : chqc_hf_eqs_vfinal_ghf ] ) ) and makes necessary some further considerations in order to arrive to a more directly applicable form of the expressions :    first , although the equations for @xmath326 and @xmath330 in  ( [ eq : chqc_hf_eqs_vfinal_uhf ] ) can be combined in the same way as in the ghf case to yield the hermiticity conditions @xmath331 , there are fewer lagrange multipliers in the uhf scheme than in the previous derivation . to see this",
    ", one must notice that the orthogonality constraints must be imposed _ on the spin - orbitals , not on the spatial orbitals _",
    "( see eq .",
    "( [ eq : chqc_constraint_mono_ghf ] ) ) . therefore , since two uhf spin - orbitals @xmath332 and @xmath333 are orthogonal no matter the value of @xmath334 due to the different spin parts , the corresponding lagrange multiplier @xmath230 needs not to be included in the constrained functional from which the uhf equations come .",
    "this may be incorporated into the formalism by simply using that the matrix @xmath249 in eqs .",
    "( [ eq : chqc_hf_eqs_vfinal_uhf ] ) presents the following block - diagonal form :    @xmath335 0 & \\lambda^\\beta \\end{array } \\right ) \\ , \\ ] ]    where we have assumed ( without loss of generality ) that the uhf spin - orbitals are ordered in such a way that the @xmath14 ones occur first , and @xmath336 indicates a block of zeros of the appropriate size .",
    "( of course , redundant constraints may be imposed on the orbitals by , for example in this case , including matrix terms in @xmath252 that connect the @xmath14 and @xmath178 spaces . however , in order to know the exact freedom we have in the choice of the constraints , it is convenient to use the minimal number of lagrange multipliers .",
    "if this approach were not followed , for example , the discussion below about the diagonalization of @xmath337 and @xmath338 would become much less direct . )    the next step consists in noticing that , despite the dependence of @xmath339 on the orbital index @xmath12 in eqs .",
    "( [ eq : chqc_hf_eqs_vfinal_uhf ] ) , there are actually only _ two _ different fock operators : one for the @xmath14 orbitals and one for the @xmath178 ones . defining the sets of indices @xmath340 and @xmath341 , we can write these two @xmath14 and @xmath178 operators :    [ eq : chqc_alpha_beta_f_uhf ] @xmath342=\\hat{h}+\\sum^{n}_{j=1 }        \\hat{j}_j[\\phi ] - \\sum_{j \\in a }        \\hat{k}_j[\\phi ] \\ , \\label{eq : chqc_alpha_beta_f_uhf_a } \\\\ &   \\hat{f}^{\\mathrm{uhf}}_\\beta[\\phi]=\\hat{h}+\\sum^{n}_{j=1 }        \\hat{j}_j[\\phi ] - \\sum_{j \\in b }        \\hat{k}_j[\\phi ] \\ . \\label{eq : chqc_alpha_beta_f_uhf_b } \\end{aligned}\\ ] ]    with them , and using the particular structure of the matrix @xmath343 in  ( [ eq : chqc_lambda_uhf ] ) , the original uhf equations in  ( [ eq : chqc_hf_eqs_vfinal_uhf ] ) are split into two disjoint sets of expressions that are only coupled through the fock operators on the left hand sides , plus the hermiticity condition :    [ eq : chqc_hf_eqs_vfinal_1_uhf ] @xmath342\\phi_i({\\bm r } ) =     \\sum_{j \\in a } \\lambda_{ij}^\\alpha \\phi_j({\\bm r } ) \\ , \\quad     \\mathrm{if } \\",
    "i \\in a \\ , \\label{eq : chqc_hf_eqs_vfinal_1_uhf_a } \\\\ &   \\hat{f}^{\\mathrm{uhf}}_\\beta[\\phi]\\phi_i({\\bm r } ) =     \\sum_{j \\in b } \\lambda_{ij}^\\beta \\phi_j({\\bm r } ) \\ , \\quad     \\mathrm{if } \\",
    "i \\in b \\ , \\label{eq : chqc_hf_eqs_vfinal_1_uhf_b } \\\\ &   \\lambda_{ij } = \\lambda_{ji}^ * \\ .",
    "\\label{eq : chqc_hf_eqs_vfinal_1_uhf_c}\\end{aligned}\\ ] ]    the last step needed to arrive to the final form of the uhf equations ( found by pople and nesbet @xcite and named after them ) is the diagonalization of both the @xmath344 and @xmath338 hermitian matrices above . in order to achieve this , the orbitals @xmath326 must be transformed similarly to the ghf case . however",
    ", this is trickier than it was then , since not only the @xmath4-electron wavefunction @xmath67 and the fock operators must remain invariant under the sought transformation , but also the uhf constraints must be kept .    as we saw before , any unitary transformation @xmath251 in the set of spin - orbitals @xmath171 like the one in eq .",
    "( [ eq : chqc_transformation_phi_ghf ] ) is physically legitimate , since it changes the slater determinant by only an unmeasurable phase and leave the fock operators invariant . then",
    ", if we write each spin - orbital as in  ( [ eq : chqc_general_so ] ) :    @xmath345    we can make use of  ( [ eq : chqc_transformation_phi_ghf ] ) , to obtain    @xmath346 \\ .\\ ] ]    by setting @xmath347 and @xmath348 in this expression , we see that any transformation @xmath251 in the spin - orbitals @xmath171 induces exactly the same transformation in their spatial components @xmath349 and @xmath350 ,    @xmath351    now , if we order the sets of spin and spatial orbitals : @xmath352 and @xmath353 , with @xmath354 , we can express the _ uhf constraints _ by saying that the @xmath355 must have the form    [ eq : chqc_constraints_uhf ] @xmath356    then , since the fact that the @xmath14 orbitals appear first constitutes no loss of generality , we must ask the transformed @xmath357 , with @xmath354 , to have also the structure in  ( [ eq : chqc_constraints_uhf ] ) if we want to remain inside the uhf scheme . as a consequence , and due to the linear independence among the orbitals , not every unitary matrix @xmath251 is allowed , but only those of the form    @xmath358 0 & u^\\beta \\end{array } \\right ) \\ , \\ ] ]    using the same notation as in eq .",
    "( [ eq : chqc_lambda_uhf ] ) .",
    "[ eq : qc_rohf_argument ] this can be easily proved by focusing on a particular value for @xmath12 and @xmath359 in eq .",
    "( [ eq : chqc_transformation_phi_i ] ) , say , @xmath360 and @xmath361 . due to the uhf constraints in  ( [ eq : chqc_constraints_uhf ] ) , we know that the left - hand side of such an expression is zero and that only spatial orbitals with @xmath362 appear in the sum on the right - hand side , yielding the relation @xmath363",
    ". but the @xmath364 , with @xmath365 , form an orthonormal , and therefore linearly independent set , so that the only possibility that such a relation can hold is that all coefficients @xmath366 be zero . by repeating this for all @xmath360 and , then , for @xmath367 , the result follows .",
    "fortunately , this limited freedom in the choice of @xmath251 is still enough to independently diagonalize @xmath344 and @xmath338 in eq .",
    "( [ eq : chqc_hf_eqs_vfinal_1_uhf ] ) ( which are both hermitian ) by suitably choosing the unitary submatrices @xmath368 and @xmath369 respectively .",
    "this takes us to the final , diagonal form of the uhf equations , the _ pople - nesbet equations _",
    "@xcite :    [ eq : chqc_hf_eqs_vfinal_2_uhf ] @xmath342\\phi_i({\\bm r } ) =     \\varepsilon_{i}^\\alpha \\phi_i({\\bm r } ) \\ , \\quad     \\mathrm{if } \\",
    "i \\in a \\ , \\label{eq : chqc_hf_eqs_vfinal_2_uhf_a } \\\\ &   \\hat{f}^{\\mathrm{uhf}}_\\beta[\\phi]\\phi_i({\\bm r } ) =     \\varepsilon_{i}^\\beta \\phi_i({\\bm r } ) \\ , \\quad     \\mathrm{if } \\",
    "i \\in b \\ .",
    "\\label{eq : chqc_hf_eqs_vfinal_2_uhf_b}\\end{aligned}\\ ] ]    although these equations are coupled through the coulomb term in the fock operators on the left - hand side , at each step of the iterative scf procedure , they can be solved as two independent eigenvalue problems . this has allowed to implement them in most quantum chemical packages and it has made uhf calculations now routine .    to close the uhf discussion , we shall now study the statistical properties of the probability densities appearing in this model . if we introduce the special form of the uhf orbitals in  ( [ eq : chqc_constraints_uhf ] ) into the general expression in  ( [ eq : chqc_qrhoij_ghf ] ) , we can calculate the two - body probability density of finding _ any _ electron with coordinates @xmath66 at the same time that _ any other _ electron has coordinates @xmath285 :    @xmath370    if we compute this probability density for ` electrons of the same spin ' , i.e. , for @xmath371 , we obtain placing _ a function and a coordinate _ as arguments of the kronecker s delta @xmath372 is even more unorthodox mathematically than placing two functions ( in fact , @xmath372 is exactly the same as @xmath373 ) , however , the intuitive character of the notation compensates again for this . ]",
    "@xmath374 & & \\frac{1}{2 } \\sum_{k , l \\in i_\\sigma } \\left (          \\big|\\phi_k({\\bm r})\\big|^{2}\\big|\\phi_l({\\bm r}^{\\prime})\\big|^{2 } - \\phi^{*}_k({\\bm r})\\,\\phi^{*}_l({\\bm r}^{\\prime})\\,\\phi_l({\\bm r})\\ ,    \\phi_k({\\bm r}^{\\prime } ) \\right ) = \\nonumber \\\\ & & \\frac{1}{2}\\left(\\rho^{\\mathrm{uhf}}({\\bm r},\\sigma)\\,\\rho^{\\mathrm{uhf}}({\\bm r}^{\\prime},\\sigma )   - \\sum_{k , l }    \\delta_{\\gamma_k \\sigma}\\delta_{\\gamma_l \\sigma }    \\phi^{*}_k({\\bm r})\\ ,    \\phi^{*}_l({\\bm r}^{\\prime})\\,\\phi_l({\\bm r})\\ ,    \\phi_k({\\bm r}^{\\prime})\\right ) \\ , \\end{aligned}\\ ] ]    where the following expression for the one - electron charge density has been used :    @xmath375    at this point , note that eq .",
    "( [ eq : chqc_qrhoij_samespins_uhf ] ) contains , like in the ghf case , the exchange correction to the first ( independent electrons ) term .",
    "nevertheless , as we advanced , if we calculate the two - body @xmath376 for ` electrons of opposite spin ' , i.e. , for @xmath377 , we have that    @xmath378    i.e. , that _ uhf electrons of opposite spin are statistically pairwise independent_.    there is another common approximation to ghf that is more restrictive than uhf and is accordingly called _ estricted artree - ock _ ( rhf ) .",
    "apart from asking the orbitals @xmath171 to be a product of a spatial part times a spin eigenstate of the one - electron @xmath309 operator ( like in the uhf case ) , in rhf , the number of ` spin - up ' and ` spin - down ' orbitals is the same , @xmath379 ( note that this means that rhf may only be used with molecules containing an even number of electrons ) , and each spatial wavefunction occurs twice : once multiplied by @xmath310 and the other time by @xmath311 .",
    "this is typically referred to as a _ closed - shell _ situation and we shall denote it by writing @xmath380 if @xmath381 , and @xmath382 if @xmath383 ; in such a way that there are @xmath384 different spatial orbitals denoted by @xmath385 , with , @xmath386 . using the same notation as in  ( [ eq : chqc_constraints_uhf ] ) , the _ rhf constraints _ on the spin - orbitals are    [ eq : chqc_constraints_rhf ] @xmath387    due to these additional restrictions , we have that , differently from the ghf and uhf ones , the rhf wavefunction  @xmath67 is an eigenstate of both the @xmath306 and the @xmath307 operators , with zero eigenvalue in both cases @xcite , just like the ground - state of the exact problem .",
    "i.e. , _ there is no spin - contamination in rhf_.    regarding the computational cost of the rhf approximation , it is even lower than that of uhf , since the size of the search space has been reduced to one quarter that of ghf : in the latter case , we had to consider @xmath118 ( complex or real ) functions of @xmath125 ( the @xmath318 and the  @xmath319 , see eq .",
    "( [ eq : chqc_general_so ] ) ) , while in rhf we only have to deal with @xmath384 of them : the @xmath388 ( see fig .  [",
    "fig : hf_computational_cost ] ) .",
    "now , using again the relations in  ( [ eq : chqc_help_relations_uhf ] ) , we can derive a first version of the _ rhf equations _ :    @xmath389\\,\\phi_{i}({\\bm r}):= \\left [ \\hat{h}+\\sum^{n/2}_j \\bigg ( 2\\hat{j}_j[\\phi ] -         \\hat{k}_j[\\phi ] \\bigg ) \\right]\\phi_{i}({\\bm r})= \\sum_{j}^{n/2}\\lambda_{ij}\\phi_{j}({\\bm r})\\ , \\ ] ]    for all @xmath386 , where we have used that the _ rhf fock operator _ @xmath390 $ ] , differently from the uhf case , does not depend on the index @xmath391 of the orbital on which it operates , and following the same steps as before , the minimal lagrange multipliers matrix needed to enforce the orthogonality constraints among the _ _ spin__orbitals in the rhf case is    @xmath392 0 & \\lambda^{(n/2)}/2 \\end{array } \\right ) \\ , \\ ] ]    where , this time , @xmath393 is an arbitrary @xmath394 hermitian matrix , and the @xmath29 has been included in order to get to the classical rhf equations in  ( [ eq : chqc_hf_eqs_vfinal_1_rhf ] ) without irrelevant numerical factors .    using the same arguments as for uhf ,",
    "it is clear that , in order to ` remain inside rhf ' upon an unitary transformation of the spin - orbitals @xmath171 , not every unitary matrix @xmath251 is allowed , but only those of the form    @xmath395 0   & u^{(n/2 ) } \\end{array } \\right ) \\ .\\ ] ]    finally , by suitable choosing the @xmath394 unitary block @xmath396 , the hermitian matrix @xmath397 can be diagonalized and the final , diagonal form of the _ rhf equations _ can be written :    @xmath398\\,\\phi_{i}({\\bm r}):= \\left",
    "[ \\hat{h}+\\sum^{n/2}_j \\bigg ( 2\\hat{j}_j[\\phi ] -         \\hat{k}_j[\\phi ] \\bigg ) \\right]\\phi_{i}({\\bm r})= \\varepsilon_{i}\\phi_{i}({\\bm r})\\ , \\ ] ]    with @xmath386 .",
    "as we can see , this version of the hartree - fock theory can be numerically solved as a _ single _ pseudoeigenvalue problem .",
    "this , together with the aforementioned small size of the rhf space , has made the rhf approximation ( in its real - valued version ) the first one cast into a computationally manageable form @xcite and the most used one in recent literature @xcite ( for molecules with an even number of electrons ) .",
    "now , in order to investigate the statistical features of rhf , if we introduce the special form of the orbitals in  ( [ eq : chqc_constraints_rhf ] ) into the general expression in  ( [ eq : chqc_qrhoij_ghf ] ) , we can calculate the rhf two - body probability density of finding _ any _ electron with coordinates @xmath66 at the same time that _ any other _ electron has coordinates @xmath285 :    @xmath399    where the following expression for the rhf one - electron charge density has been used :    @xmath400    we notice that the situation is the same as in the uhf case : for rhf electrons with equal spin , there exists an exchange term in @xmath401 that corrects the ` independent ' part , whereas _ rhf electrons of opposite spin are statistically pairwise independent_.    finally , if we follow the same steps as for ghf , in page  , we can relate the _ rhf energy _ to the eigenvalues @xmath402 and the two - electron spatial integrals :    @xmath403    to close this section , we shall discuss a fourth flavour of hartree - fock which is called _ estricted pen - shell artree - ock _ ( rohf ) .",
    "compared to the rest of variants , rohf is the most difficult to derive theoretically and it shall be described here only in an introductory manner .",
    "the rohf wavefunction is somewhat between the rhf and the uhf ones , and both of them can be obtained as particular cases of the rohf scheme ( the rhf one provided that the molecule has an even number of electrons ) . in the ( monodeterminantal )",
    "rohf case , the one - electron spin orbitals @xmath171 are constrained to be of two different types : @xmath404 of them are _ doubly occupied _ , like in the rhf case , in such a way that they are formed by only @xmath405 spatial orbitals @xmath406 , each one of them appearing once multiplied by @xmath310 and once by @xmath311 .",
    "the associated @xmath404 spin - orbitals are said to belong to the _ closed shell _",
    "part of the wavefunction .",
    "the remaining @xmath407 ones are _ singly occupied _ , like in the uhf case , and are said to belong to the _",
    "open shell_. among them , @xmath314 are multiplied by an @xmath310 spin part , and @xmath315 by @xmath311 .    if we number the whole set of rohf spatial orbitals @xmath406 , with @xmath408 , in such a way that the doubly occupied ones occur first , with @xmath409 , then the alpha ones , with @xmath410 , and finally the beta ones , with @xmath411 , we can express the _ rohf constraints _ on the spin - orbitals using the same notation as in  ( [ eq : chqc_constraints_uhf ] ) and  ( [ eq : chqc_constraints_rhf ] ) :    [ eq : chqc_constraints_rohf ] @xmath412    where the particular ordering has been chosen in order to facilitate the forecoming calculations .",
    "the general monodeterminantal rohf wavefunction considered here and constructed using the above constraints has the same spin properties as the uhf one , i.e. , it is an eigenstate of the the @xmath307 operator with eigenvalue @xmath316 , but it is not an eigenstate of @xmath317 .",
    "however , in the particular ( and common ) case in which all the @xmath413 open shell orbitals are constrained to present parallel spin parts ( either all @xmath14 or all @xmath178 ) , the rohf wavefunction becomes an eigenstate of the @xmath317 operator too , with eigenvalue @xmath414 , thus avoiding the problem of spin contamination @xcite . in order to construct wavefunctions with the same @xmath415 but lower @xmath416 , several rohf",
    "slater determinants must be linearly combined .",
    "the subtleties arising from such a procedure are beyond the scope of this review ; the interested reader may want to check references @xcite , which discuss this topic .",
    "regarding the size of the variational space in rohf , it is somewhere between uhf and rhf , depending on the @xmath417 ratio .    now , if the rohf constraints in  ( [ eq : chqc_constraints_rohf ] ) are imposed on the ghf energy in eq .",
    "( [ eq : chqc_expected_h_2_ghf ] ) , the rohf analogue in terms of the spatial orbitals @xmath406 can be calculated :    @xmath418=     \\sum_{a}f_a\\langle\\phi_{a}|\\hat{h}|\\phi_{a}\\rangle } \\nonumber \\\\ & & \\mbox { } + \\frac{1}{2 } \\sum_{a , b } \\bigg(f_a f_b   \\langle\\phi_a\\phi_b|\\frac{1}{r}|\\phi_a\\phi_b\\rangle   -   g_{ab}\\langle\\phi_a\\phi_b|\\frac{1}{r}|\\phi_b\\phi_a\\rangle      \\bigg ) \\ , \\end{aligned}\\ ] ]    where the @xmath419 are a sort of ` occupation numbers ' that take the value @xmath420 when @xmath421 ( i.e. , when it corresponds to a closed shell orbital ) and @xmath422 otherwise .",
    "the matrix @xmath423 is defined as    @xmath424 \\hline\\\\[-8pt ] 1 &   \\begin{array}{c@{\\hspace{5pt}}c } 1^\\alpha & 0 \\\\[5pt ] 0 & 1^\\beta \\end{array } \\end{array } \\right ) \\ , \\ ] ]    being @xmath425 a @xmath426 box of 2 s , @xmath427 and @xmath428 , @xmath429 and @xmath430 boxes of 1 s respectively .",
    "the off - diagonal blocks contain in all elements the number indicated and are of the appropriate size .",
    "then , as we did for ghf , in order to derive the rohf equations , we construct the functional for the conditioned stationary values problem , adding to the energy in  ( [ eq : chqc_energy_rohf ] ) the lagrange multipliers terms needed to enforce the orthonormality constraints :    @xmath431 =     e^{\\mathrm{rohf}}\\big[\\{\\phi_a\\}\\big ] -   \\sum_{a , b } \\lambda_{ab}\\ ,     \\big ( \\langle\\phi_a|\\phi_b\\rangle-\\delta_{ab } \\big ) \\ .\\ ] ]    now , like in all restricted hf cases , special attention must be payed to the structure of the matrix @xmath432 , since the requirement is that all _ spin - orbitals _ be orthogonal , not the spatial orbitals . in the rohf case , this leads to explicitly impose the orthonormality conditions ( of course ) inside the three sets of @xmath406 : the doubly occupied , the alpha and the beta ones ; but also between the doubly occupied and the alpha ones , and between the doubly occupied and the beta ones .",
    "the orthormality between the alpha and beta sets , however , needs not to be enforced , since the associated spin - orbitals are already orthogonal due to the different spin parts .",
    "these considerations lead to the following form for the minimal lagrange multipliers matrix :    @xmath433 ( \\lambda^{d\\alpha})^+ & \\lambda^\\alpha & 0 \\\\[5pt ] ( \\lambda^{d\\beta})^+ & 0 & \\lambda^\\beta \\end{array } \\right ) \\ , \\ ] ]    where the notation used for the different blocks connecting the doubly occupied , alpha and beta shells is self - explanatory , and the fact that @xmath434 is hermitian after reaching stationarity has been advanced .",
    "next , we impose the condition of zero functional derivative on the functional in  ( [ eq : chqc_constrained_functional_rohf ] ) , and obtain a first version of the _ rohf equations _ :    [ eq : chqc_hf_eqs_v1_rohf ]",
    "@xmath435\\phi_{a}({\\bm r})=     \\sum_{b}\\lambda_{ab}\\phi_{b}({\\bm r})\\ , \\qquad     a = 1,\\ldots , n_d+n_\\alpha+n_\\beta \\ , \\label{eq : chqc_hf_eqs_v1_rohf_a } \\\\ & \\hat{f}_a^{\\mathrm{rohf}}[\\phi]\\,\\phi^*_{a}({\\bm r})=     \\sum_{b}\\lambda_{ba}\\phi^*_{b}({\\bm r})\\ , \\qquad     a = 1,\\ldots , n_d+n_\\alpha+n_\\beta \\ , \\label{eq : chqc_hf_eqs_v1_rohf_b}\\end{aligned}\\ ] ]    where the _ rohf operator _ @xmath436 $ ] is defined as    @xmath437:=   f_a \\hat{h}+ \\sum_b \\bigg ( f_a f_b \\hat{j}_b[\\phi ] -         g_{ab}\\hat{k}_b[\\phi ]",
    "\\bigg ) \\ , \\ ] ]    and the hermiticity property of the lagrange multipliers matrix @xmath438 follows from conjugation and subtraction in eqs .",
    "( [ eq : chqc_hf_eqs_v1_rohf ] ) .    again , although the fock operator depends on the index @xmath98 of the orbital upon which it operates , this dependence presents a very particular structure , yielding _ only three _ different types of operators :    [ eq : chqc_rohf_ops ] @xmath439:=   2 \\hat{h}+ \\sum_b \\bigg ( 2 f_b \\hat{j}_b[\\phi ] -         f_{b}\\hat{k}_b[\\phi ] \\bigg ) \\ , \\qquad     a \\in d \\ , \\label{eq : chqc_hf_rohf_ops_a } \\\\ & \\hat{f}_\\alpha^{\\mathrm{rohf}}[\\phi]:=   \\hat{h}+ \\sum_{b \\in ( d \\cup a ) } \\bigg(\\hat{j}_b[\\phi ] -         \\hat{k}_b[\\phi ] \\bigg ) \\ , \\qquad     a \\in a \\ , \\label{eq : chqc_hf_rohf_ops_b } \\\\ & \\hat{f}_\\beta^{\\mathrm{rohf}}[\\phi]:=   \\hat{h}+ \\sum_{b \\in ( d \\cup b ) } \\bigg ( \\hat{j}_b[\\phi ] -         \\hat{k}_b[\\phi ] \\bigg ) \\ , \\qquad     a \\in b \\ .",
    "\\label{eq : chqc_hf_rohf_ops_c}\\end{aligned}\\ ] ]    note that , in the particular case that we had no open - shell orbitals , the operator for the doubly occupied ones does not reduce ( as it should ) to the rhf one in  ( [ eq : chqc_hf_eqs_vfinal_1_rhf ] ) .",
    "this is because we hid a factor 2 in the definition of the lagrange multipliers in the rhf derivation .    at this point",
    ", it would be desirable to continue with the same program that we followed in the uhf and rhf cases and diagonalize the matrix @xmath438 in order to arrive to a system of three pseudoeigenvalue equations , coupled only via the fock operators .",
    "nevertheless , this is not possible in rohf , as we shall show in the following lines , and it is the root of rohf being the most tricky flavour in the hartree - fock family . the obstruction to achieve this diagonalization comes from the fact , already used in the uhf case , that not every unitary transformation of the _ spin - orbitals _ is allowed if we want to remain inside the rohf scheme , i.e. , if we want that the transformed spin - orbitals satisfy the same rohf constraints in  ( [ eq : chqc_constraints_rohf ] ) that the untransformed ones did .    to begin with ,",
    "if we recall that the doubly occupied spatial orbitals must be orthogonal to both the alpha and the beta ones , we can use the same reasoning as in page   to show that the alpha - beta connecting parts of the allowed unitary matrix in this case must be zero .",
    "hence , we can write    @xmath440 u^{\\prime d\\alpha } & u^\\alpha \\end{array } & 0 \\\\[5pt ] \\hline\\\\[-8pt ] 0 & \\begin{array}{c@{\\hspace{5pt}}c } u^{\\prime d } & u^{d\\beta } \\\\[5pt ] u^{\\prime d\\beta } & u^\\beta \\end{array } \\end{array } \\right ) \\ , \\ ] ]    where the size of each block may be easily found from  ( [ eq : chqc_constraints_rohf ] ) and the notation is again self - explanatory .",
    "now , in order to obtain further restrictions to the form of @xmath441 , we write the transformation of the _ two _ spin - orbitals in the closed shell that correspond to _ the same _ spatial orbital @xmath406 , with @xmath442 .",
    "to this end , we use  ( [ eq : chqc_u_rohf ] ) , ( [ eq : chqc_constraints_rohf ] ) , and the appropriate lines in the first and third lines of blocks in  ( [ eq : chqc_u_rohf ] ) :    @xmath443    using the orthogonality relations inside and among the three sets of spatial orbitals , we multiply the above expression by any @xmath444 , with @xmath445 and integrate on @xmath172 . from this , the equality of @xmath446 and @xmath447 follows , and the corresponding sums in  ( [ eq : chqc_rohf_proof1 ] ) subtract to zero , yielding    @xmath448    which equates one vector in the linear space spanned by the alpha orbitals to another in the linear space spanned by the beta ones .",
    "however , only the zero vector can belong to both spaces if we want the rohf assumptions regarding the spin - orbitals to hold . to see this",
    ", we can use a _ reductio ad absurdum _ type of argument : assume that both sides of  ( [ eq : chqc_rohf_proof2 ] ) are different from zero .",
    "then , we may perform a unitary transformation changing only the alpha and beta spaces , and with no elements connecting the two .",
    "this is allowed , since it does not change neither the @xmath4-electron wavefunction , nor the fock operators , nor the rohf constraints .",
    "now , if we select the partial unitary transformations in the alpha and beta sets so that they turn the vectors at both sides of  ( [ eq : chqc_rohf_proof2 ] ) into single elements in the bases of their respective spaces , we have that a single alpha orbital _ equals _ a beta one .",
    "although this can happen in particular cases , we can not ask it or we would be changing the fundamental assumptions made in  ( [ eq : chqc_constraints_rohf ] ) . therefore , both sides of  ( [ eq : chqc_rohf_proof2 ] ) must be zero , and ,",
    "since the alpha and beta sets are linearly independent , all coefficients must be zero too .",
    "the proof that @xmath449 and @xmath450 are also zero is performed using similar arguments , and the final form of @xmath451 satisfying all the restrictions reads    @xmath452 0 & u^\\alpha \\end{array } & 0 \\\\[5pt ] \\hline\\\\[-8pt ] 0 & \\begin{array}{c@{\\hspace{5pt}}c } u^d & 0 \\\\[5pt ] 0 & u^\\beta \\end{array } \\end{array } \\right ) \\ .\\ ] ]    finally , if we write the associated matrix using the @xmath98 indices , i.e. , operating on the set of spatial orbitals with the doubly occupied ones _ unrepeated _ :",
    "@xmath453   & u^\\alpha & \\\\[5pt ] 0 & & u^\\beta \\end{array } \\right ) \\ , \\ ] ]    then , the transformed @xmath454 is related to the original one in  ( [ eq : chqc_lambda_rohf ] ) through simple matrix multiplication : @xmath455 ( dropping the rohf superindices ) .",
    "it is clear that such a restricted @xmath456 does not operate on the off - diagonal blocks of @xmath438 in  ( [ eq : chqc_lambda_rohf ] ) and , therefore , _ the sought diagonalization is not possible_.    using the fact that , however , the @xmath457 , @xmath344 and @xmath338 do allow to be diagonalized , we can write the final , simplest possible form of the _ rohf equations _ ( forgetting their complex conjugate counterparts ) :    [ eq : chqc_hf_eqs_vfinal_rohf ] @xmath439\\phi_{a}({\\bm r})=     \\varepsilon^d_a \\phi_{a}({\\bm r } ) +     \\sum_{b \\in a}\\lambda^{d\\alpha}_{ab}\\phi_{b}({\\bm r } ) +     \\sum_{b \\in b}\\lambda^{d\\beta}_{ab}\\phi_{b}({\\bm r})\\ , \\quad     a \\in d \\ , \\label{eq : chqc_hf_eqs_vfinal_rohf_a } \\\\ & \\hat{f}_\\alpha^{\\mathrm{rohf}}[\\phi]\\phi_{a}({\\bm r})=     \\varepsilon^\\alpha_a \\phi_{a}({\\bm r } ) +     \\sum_{b \\in d}(\\lambda^{d\\alpha}_{ba})^*\\phi_{b}({\\bm r})\\ , \\quad     a \\in a \\ , \\label{eq : chqc_hf_eqs_vfinal_rohf_b } \\\\ & \\hat{f}_\\beta^{\\mathrm{rohf}}[\\phi]\\phi_{a}({\\bm r})=     \\varepsilon^\\beta_a \\phi_{a}({\\bm r } ) +     \\sum_{b \\in d}(\\lambda^{d\\beta}_{ba})^*\\phi_{b}({\\bm r})\\ , \\quad     a \\in b \\",
    ", \\label{eq : chqc_hf_eqs_vfinal_rohf_c}\\end{aligned}\\ ] ]    where the superindices in the matrix elements are only written for visual convenience when comparing with  ( [ eq : chqc_lambda_rohf ] ) .    in this final form ,",
    "it is evident that the off - diagonal elements of the lagrange multipliers matrix , i.e. , those related to the orthogonality constraints between the closed and open shells , introduce a coupling in the right - hand side of the rohf equations that completely spoils the possibility of casting them into pseudoeigenvalue ones . in the previous uhf and rhf versions ,",
    "_ all _ orthogonality constraints were handled by simply choosing a special basis in the space spanned by the spatial orbitals in which the lagrange multipliers matrix was diagonal .",
    "however , in the rohf scheme , there is no such basis and we must deal with the problem in a different way , resulting into higher computational and theoretical difficulty .    since the pioneering work by roothaan @xcite",
    ", the solution of the rohf problem has been attempted by distinct means , ranging from directly tackling the rohf equations in  ( [ eq : chqc_hf_eqs_vfinal_rohf ] ) explicitly forcing the orthogonality constraints @xcite , to the construction of a so - called _ unified coupling operator _",
    "@xcite , which allows to turn the rohf scheme into a single pseudoeigenvalue problem at the price of introducing certain ambiguities in the one - electron orbital energies @xcite .",
    "the details and subtleties involved in these issues are beyond the scope of a review of the fundamental topics such as this one .",
    "the interested reader may want to check the more specialized accounts in @xcite .",
    "the hartree - fock equations in the rhf form in expression  ( [ eq : chqc_hf_eqs_vfinal_rhf ] ) are a set of @xmath384 coupled integro - differential equations . as such",
    ", they can be tackled by finite - differences methods and solved on a discrete grid ; this is known as _ numerical hartree - fock _ @xcite , and , given the present power of computers , it is only applicable to very small molecules .    in order to deal with larger systems , such as biological macromolecules , independently proposed by roothaan",
    "@xcite and hall @xcite in 1951 , a different kind of discretization must be performed , not in @xmath458 but in the hilbert space @xmath459 of the one - electron orbitals . hence , although the actual dimension of @xmath459 is infinite , we shall approximate any function in it by a finite linear combination of @xmath460 different functions @xmath461 in all this section and the next one , the indices belonging to the first letters of the alphabet , @xmath462 , etc . ,",
    "run from  1 to @xmath460 ( the number of functions in the finite basis set ) ; whereas those named with capital letters from @xmath391 towards the end of the alphabet , @xmath463 , etc .",
    ", run from 1 to @xmath384 ( the number of spatial wavefunctions @xmath464 , also termed the number of _ occupied orbitals _ ) . ] .",
    "in particular , the one - electron orbitals that make up the rhf wavefunction , shall be approximated by    @xmath465    in both cases , numerical hartree - fock and discretization of the function space , the correct result can be only be reached asymptotically ; when the grid is very fine , for the former , and when @xmath466 , for the latter .",
    "this exact result , which , in the case of small systems , can be calculated up to several significant digits , is known as the _ hartree - fock limit _ @xcite .    in practical cases , however , @xmath460 is finite ( often , only about an order of magnitude larger than @xmath384 ) and the set @xmath467 in the expression above is called the _ basis set_. we shall devote the next section to discuss its special characteristics , but , for now , it suffices to say that , in typical applications , the functions @xmath461 are _ atom - centred _ , i.e. , each one of them has non - negligible value only in the vicinity of a particular nucleus .",
    "therefore , like all the electronic wavefunctions we have dealt with in the last sections , they parametrically depend on the positions @xmath49 of the nuclei ( see sec .  [",
    "sec : qc_born - oppenheimer ] ) .",
    "this is why , sometimes , the functions @xmath461 are called _ _ tomic rbitals _ _",
    "some authors @xcite suggest that , being strict , the term _ atomic orbitals _ should be reserved for the one - electron wavefunctions @xmath464 that are the solution of the hartree - fock problem ( or even to the exact schrdinger equation of the isolated atom ) , and that the elements @xmath461 in the basis set should be termed simply _",
    "localized functions_. however , it is very common in the literature not to follow this recommendation and choose the designation that appear in the text @xcite .",
    "we shall do the same for simplicity . ]",
    "( ao ) ( since they are localized at individual atoms ) , the @xmath464 are referred to as _ olecular rbitals _  ( mo ) ( since they typically have non - negligible value in the whole space occupied by the molecule ) , and the approximation in eq .",
    "( [ eq : chqc_lcao ] ) is called _ inear ombination of tomic rbitals _  ( lcao ) .",
    "in addition , since we voluntarily circumscribe to real - rhf , we assume that both the coefficients @xmath468 and the functions @xmath461 in the above expression are real .",
    "now , if we introduce the linear combination in eq .",
    "( [ eq : chqc_lcao ] ) into the hartree - fock equations in  ( [ eq : chqc_hf_eqs_vfinal_rhf ] ) , multiply the result from the left by @xmath469 ( for a general value of @xmath470 ) and integrate on @xmath471 , we obtain    @xmath472    where we denote by @xmath473 the @xmath474-element of the _ _ fock matrix _ _ note that the rhf superindex has been dropped from @xmath475 . ] , and by @xmath476 the one of the _ overlap matrix _ , defined as    @xmath477 \\ , | \\chi_a \\rangle \\qquad \\mathrm{and } \\qquad s_{ba}:=\\langle \\chi_b | \\chi_a \\rangle \\ , \\ ] ]    respectively .    note that we do not ask the @xmath461 in the basis set to be mutually orthogonal , so that the overlap matrix is not diagonal in general .",
    "next , if we define the @xmath478 matrices @xmath479:=(f_{ab})$ ] and @xmath480 , together with the ( column ) @xmath460-vector @xmath481 , we can write eq .",
    "( [ eq : chqc_rh_1 ] ) in matricial form :    @xmath482 c_i=\\varepsilon_i\\,sc_{i}\\ .\\ ] ]    hence , using the lcao approximation , we have traded the @xmath384 coupled integro - differential hartree - fock equations in  ( [ eq : chqc_hf_eqs_vfinal_rhf ] ) for this system of @xmath384 algebraic equations for the @xmath384 orbital energies @xmath402 and the @xmath483 coefficients  @xmath468 , which are called _ roothaan - hall equations _ @xcite and which are manageable in a computer .",
    "now , if we forget for a moment that the fock matrix depends on the coefficients @xmath468 ( as stressed by the notation  @xmath479 $ ] ) and also that we are only looking for @xmath384 vectors @xmath484 while the matrices @xmath475 and @xmath485 are @xmath486 , we may regard the above expression as a @xmath460-dimensional _ generalized eigenvalue problem_. many properties are shared between this kind of problem and a classical eigenvalue problem ( i.e. , one in which @xmath487 ) @xcite , being the most important one that , due to the hermiticity of @xmath479 $ ] , one can find an orthonormal set of @xmath460 vectors @xmath488 corresponding to real eigenvalues @xmath489 ( where , of course , some eigenvalue could be repeated ) .",
    "in fact , it is using this formalism how most of actual hartree - fock computations are performed , although the reader must also note that other approaches , in which the orthonormality constraints are automatically satisfied due to the choice of variables also exist in the literature @xcite .",
    "the general outline of the iterative procedure is essentially the same as the one discussed in sec .",
    "[ sec : qc_hartree - fock ] : choose a _ starting - guess _ for the coefficients @xmath468 ( let us denote it by  @xmath490 ) , construct the corresponding fock matrix @xmath491 $ ] note ( in eq .",
    "( [ eq : chqc_matrices_2 ] ) , for example ) that the fock matrix only depends on the vectors @xmath488 with @xmath492 . ] and solve the generalized eigenvalue problem in eq .",
    "( [ eq : chqc_rh_2 ] ) . by virtue of the aufbau principle discussed in the previous section , from the @xmath460 eigenvectors @xmath488 , keep the @xmath384 ones @xmath493 that correspond to the @xmath384 lowest eigenvalues  @xmath494 , construct the new fock matrix @xmath495 $ ] and iterate ( by convention , the eigenvalues @xmath496 , for all @xmath151 , are ordered from the lowest to the largest as @xmath98 runs from 1 to @xmath460 ) .",
    "this procedure ends when the @xmath151-th solution is close enough ( in a suitable defined way ) to the @xmath301-th one .",
    "also , note that , after convergence has been achieved , we end up with @xmath460 orthogonal vectors @xmath497 .",
    "only the @xmath384 ones that correspond to the lowest eigenvalues represent real one - electron solutions and they are called _ occupied orbitals _ ; the @xmath498 remaining ones do not enter in the @xmath4-electron wavefunction ( although they are relevant for calculating corrections to the hartree - fock results ) and they are called _",
    "virtual orbitals_.    regarding the mathematical foundations of this procedure , let us stress , however , that , whereas in the finite - dimensional ghf and uhf cases it has been proved that the analogous of lieb and simon s theorem ( see the previous section ) is satisfied , i.e. , that the global minimum of the original optimization problem corresponds to the lowest eigenvalues of the self - consistent fock operator , in the rhf and rohf cases , contrarily , no proof seems to exist @xcite .",
    "of course , in practical applications , the positive result is assumed to hold .    finally , if we expand @xmath499 in eq .",
    "( [ eq : chqc_matrices_1 ] ) , using the shorthand @xmath500 for @xmath501 , we have    @xmath502 }   \\underbrace{\\left ( 2 \\langle ac|\\,\\frac{1}{r}\\,|bd\\rangle -                      \\langle ac|\\,\\frac{1}{r}\\,|db\\rangle\\right ) } _ {                      \\displaystyle g^{cd}_{ab } }   \\ , \\ ] ]    where we have introduced the _ density matrix _",
    "@xmath503 $ ] , and also the matrix @xmath504 , made up by the _ two - electron four - centre integrals _ @xmath505 ( also called _",
    "lectron epulsion ntegrals _ ( eris ) ) defined by    @xmath506    it is also convenient to introduce the _ coulomb _",
    "( @xmath507 $ ] ) and _ exchange _",
    "( @xmath508 $ ] ) _ matrices _    [ eq : chqc_coulomb_exchange ] @xmath509 : = \\sum_{c , d}d_{cd}[c]\\langle ac|\\,\\frac{1}{r}\\,|bd\\rangle    \\ , \\label{eq : chqc_coulomb_exchange_a } \\\\ & k_{ab}[c ] : = \\sum_{c , d}d_{cd}[c]\\langle ac|\\,\\frac{1}{r}\\,|db\\rangle    \\ , \\label{eq : chqc_coulomb_exchange_b } \\end{aligned}\\ ] ]    in terms of which , the fock operator in eq .",
    "( [ eq : chqc_matrices_2 ] ) may be expressed as    @xmath510 - k_{ab}[c ] \\ .\\ ] ]    after scf convergence has been achieved , the _ rhf energy _ in the finite - dimensional case can be computed using the discretized version of eq .",
    "( [ eq : chqc_energy_rhf ] ) :    @xmath511d_{bd}[c]\\langle ab|\\,\\frac{1}{r}\\,|cd\\rangle\\ , \\end{aligned}\\ ] ]    where a convenient rearrangement of the indices in the two sums has been performed from the first to the second line .",
    "in principle , arbitrary functions may be chosen as the @xmath461 to solve the roothaan - hall equations in the previous section , however , in eq .",
    "( [ eq : chqc_matrices_2 ] ) , we see that one of the main numerical bottlenecks in scf calculations arises from the necessity of calculating the @xmath512 four - centre integrals if the symmetry properties of the integrals are used , the precise number of eris is found to be @xmath513 @xcite . ]",
    "@xmath514 , since the solution of the generalized eigenvalue problem in eq .",
    "( [ eq : chqc_rh_2 ] ) typically scales only like @xmath515 , and there are two - centre @xmath516 integrals ( see however the next section ) .",
    "either if these integrals are calculated at each iterative step and directly taken from ram memory ( _ direct scf _ ) or if they are calculated at the first step , written to disk , and then read from there when needed ( _ conventional scf _ ) , an appropriate choice of the functions  @xmath461 in the finite basis set is essential if accurate results are sought , @xmath460 is intended to be kept as small as possible and the integrals are wanted to be computed rapidly .",
    "when one moves into higher - level theoretical descriptions and the numerical complexity scales with @xmath460 even more unpleasantly , the importance of this choice greatly increases .    in this section , in order to support that study , we shall introduce some of the concepts involved in the interesting field of basis - set design . for further details",
    "not covered here , the reader may want to check refs .",
    "@xcite .",
    "the only analytically solvable molecular problem in non - relativistic quantum mechanics is the _ hydrogen - like atom _ ,",
    "i.e. , the system formed by a nucleus of charge @xmath517 and only one electron ( h , he@xmath518 , li@xmath519 , etc . ) .",
    "therefore , it is not strange that all the thinking about atomic - centred basis sets in quantum chemistry is much influenced by the particular solution to this problem .",
    "the spatial eigenfunctions of the hamiltonian operator of an hydrogen - like atom , in atomic units and spherical coordinates , read for consistency with the rest of the text , the born - oppenheimer approximation has been also assumed here .",
    "so that the _ reduced mass _ @xmath520 that should enter the expression is considered to be the mass of the electron @xmath521 ( recall that , in atomic units , @xmath522 and @xmath523 ) . ]",
    "@xmath524 ^ 3 } }   \\left ( \\frac{2z}{n } r \\right)^l",
    "l^{2l+1}_{n - l-1}\\left ( \\frac{2z}{n } r \\right )",
    "e^{-zr / n } y_{lm}(\\theta,\\varphi ) \\ , \\ ] ]    where @xmath151 , @xmath222 and @xmath25 are the energy , total angular momentum and @xmath74-angular momentum quantum numbers , respectively .",
    "their ranges of variation are coupled : all being integers , @xmath151 runs from 1 to @xmath525 , @xmath222 from 0 to @xmath526 and @xmath25 from @xmath527 to @xmath222 .",
    "the function @xmath528 is a _",
    "generalized laguerre polynomial _",
    "@xcite , for which it suffices to say here that it is of order @xmath529 ( thus having , in general , @xmath529 zeros ) , and the function @xmath530 is a _ spherical harmonic _ , which is a simultaneous eigenfunction of the total angular momentum operator @xmath531 ( with eigenvalue @xmath532 ) and of its @xmath74-component @xmath533 ( with eigenvalue @xmath25 ) .    the hope that the one - electron orbitals that are the solutions of the hartree - fock problem in many - electron atoms could not be very different from the @xmath534 [ page : foot : orbitals_only_in_hf ] above note that the @xmath4-electron wavefunction of the exact ground - state of a non - hydrogen - like atom depends on 3@xmath4 spatial variables in a way that can not be written , in general , as a slater determinant of one - electron functions .",
    "the image of single electrons occupying definite orbitals , together with the possibility of comparing them with the one - particle eigenfunctions of the hamiltonian of hydrogen - like atoms , vanishes completely outside the hartree - fock formalism . ] , together with the powerful chemical intuition that states that ` atoms - in - molecules are not very different from atoms - alone ' , is what mainly drives the choice of the functions @xmath461 in the basis set , and , in the end , the variational procedure that will be followed is expected to fix the largest failures coming from these too - simplistic assumptions .",
    "hence , it is customary to choose functions that are centred at atomic nuclei and that partially resemble the exact solutions for hydrogen - like atoms . in this spirit , the first type of aos to be tried @xcite were the _ later - ype rbitals _ ( stos ) , proposed by slater @xcite and zener @xcite in 1930 :    @xmath535    where @xmath536 is a normalization constant and @xmath537 is an adjustable parameter .",
    "the index  @xmath538 is that of the nucleus at which the function is centred , and , of course , in the majority of cases , there will be several @xmath539 corresponding to different values of @xmath98 centred at the same nucleus .",
    "the integers @xmath540 and @xmath541 can be considered quantum numbers , since , due to the fact that the only angular dependence is in @xmath542 ( see below for a definition ) , the sto defined above is still a simultaneous eigenstate of the one - electron angular momentum operators @xmath531 and  @xmath533 ( with the origin placed at @xmath543 ) .",
    "the parameter @xmath544 , however , should be regarded as a ` principal ( or energy ) quantum number ' only by analogy , since , on the one hand , it does not exist a ` one - atom hamiltonian ' whose exact eigenfunctions it could label and , on the other hand , only the leading term of the laguerre polynomial in eq .",
    "( [ eq : chqc_hydrogen - like ] ) has been kept in the sto if we notice that , within the set of all possible stos ( as defined in eq .",
    "( [ eq : chqc_sto ] ) ) , every hydrogen - like energy eigenfunction ( see eq .",
    "( [ eq : chqc_hydrogen - like ] ) ) can be formed as a linear combination , we easily see that the stos constitute a complete basis set .",
    "this is important to ensure that the hartree - fock limit could be actually approached by increasing @xmath460 . ] .    additionally , in the above notation",
    ", the fact that @xmath539 parametrically depends on the position of a certain @xmath538-th nucleus has been stressed , and the functions @xmath542 , which are called _ real spherical harmonics",
    "_ @xcite ( remember that we want to do real rhf ) , are defined in terms of the classical _ spherical harmonics _ @xmath545 by    [ eq : chqc_real_spherical_harmonics ] @xmath546    where @xmath547 stands for _ cosine _ , @xmath548 for _ sine _ , the functions @xmath549 are the _ associated legendre polynomials _",
    "@xcite , and the spherical coordinates @xmath550 and @xmath551 also carry the @xmath538-label to remind that the origin of coordinates in terms of which they are defined is located at @xmath543 . also note that , using that @xmath552 , there is the same number of real spherical harmonics as of classical ones .",
    "these @xmath539 have some good physical properties . among them",
    ", we shall mention that , for @xmath553 , they present a _ cusp _ ( a discontinuity in the radial derivative ) , as required by kato s theorem @xcite ; and also that they decay at an exponential rate when @xmath554 , which is consistent with the image that , an electron that is taken apart from the vicinity of the nucleus must ` see ' , at large distances , an unstructured point - like charge ( see , for example , the sto in fig .",
    "[ fig : contraction ] ) . finally , the fact that they do not present radial nodes ( due to the aforementioned absence of the non - leading terms of the laguerre polynomial in eq .",
    "( [ eq : chqc_hydrogen - like ] ) ) can be solved by making linear combinations of functions with different values [ page : foot : r_exponent_idontcare ] of @xmath537 this way of proceeding renders the choice of the exponent carried by the @xmath555 part ( @xmath556 in the case of the sto in eq .  ( [ eq : chqc_sto ] ) ) a rather arbitrary one . as a consequence",
    ", different definitions may be found in the literature and the particular exponent chosen in actual calculations turns out to be mostly a matter of computational convenience . ] .",
    "now , despite their being good theoretical candidates to expand the mo @xmath464 that make up the @xmath4-particle solution of the hartree - fock problem , these stos have serious computational drawbacks : whereas the two - centre integrals ( such as @xmath516 in eq .",
    "( [ eq : chqc_matrices_2 ] ) ) can be calculated analytically , the four - centre eris @xmath505 can not @xcite if functions like the ones in eq .",
    "( [ eq : chqc_sto ] ) are used .",
    "this fact , which was known as `` the nightmare of the integrals '' in the first days of computational quantum chemistry @xcite , precludes the use of stos in practical ab initio calculations of large molecules .",
    "a major step to overcome these difficulties that has revolutioned the whole field of quantum chemistry @xcite was the introduction of _ artesian aussian - ype rbitals _",
    "( cgto ) :",
    "@xmath557    where the @xmath558 and the @xmath559 , with @xmath560 , are the euclidean coordinates of the electron and the @xmath538-th nucleus respectively , and the integers @xmath561 , @xmath562 and @xmath563 , which take values from 0 to @xmath525 , are called _ _ orbital quantum numbers _ _ since the harmonic - oscillator energy eigenfunctions can be constructed as linear combinations of cartesian gtos , we have that the latter constitute a complete basis set and , like in the case of the stos , we may expect that the hartree - fock limit is approached as @xmath460 is increased . ] .",
    "although these gtos do not have the good physical properties of the stos ( compare , for example , the sto and the gto in fig .",
    "[ fig : contraction ] ) , in 1950 , boys @xcite showed that all the integrals appearing in scf theory could be calculated analytically if the @xmath461 had the form in eq .",
    "( [ eq : chqc_gto ] ) . the enormous computational advantage that this entails makes possible to use a much larger number of functions to expand the one - electron orbitals @xmath326 if gtos are used , partially overcoming their bad short- and long - range behaviour and making the gaussian - type orbitals the universally preferred choice in scf calculations @xcite .    to remedy the fact that the angular behaviour of the cartesian gtos in eq .",
    "( [ eq : chqc_gto ] ) is somewhat hidden , they may be linearly combined to form _ pherical aussian - ype rbitals _",
    "( sgto ) :",
    "@xmath564    which are proportional to the real spherical harmonic @xmath565 , and to which the same remarks made in footnote  [ foot : r_exponent_idontcare ] in page   for the stos , regarding the exponent in the @xmath555 part , may be applied .",
    "the fine mathematical details about the linear combination that relates the cartesian gtos to the spherical ones are beyond the scope of this introduction .",
    "we refer the reader to refs .",
    "@xcite and  @xcite for further information and remark here some points that will have interest in the subsequent discussion .",
    "first , the cgtos that are combined to make up a sgto must have all the same value of @xmath566 and , consequently , this sum of the three orbital quantum numbers @xmath561 , @xmath562 and @xmath563 in a particular cartesian gto is typically ( albeit dangerously ) referred to as the _ angular momentum _ of the function .",
    "in addition , apart from the numerical value of @xmath540 , the spectroscopic notation is commonly used in the literature , so that cgtos with @xmath567 are called _ s _ , _ p _ , _ d _ , _ f _ , _ g _ , _ h _ ,  , respectively . where the first four come from the archaic words _ harp _ , _ rincipal _ , _ iffuse _ and _ undamental _ , while the subsequent ones proceed in alphabetical order .    second , for a given @xmath568",
    ", there are more cartesian gtos ( @xmath569 ) than spherical ones ( @xmath570 ) , in such a way that , from the @xmath569 functionally independent linear combinations that can be formed using the cgtos of angular momentum  @xmath540 , only the angular part of @xmath570 of them turns out to be proportional to a real spherical harmonic @xmath571 ; the rest of them are proportional to real spherical harmonic functions with a different value of the angular momentum quantum number . for example , from the six different d - cartesian gtos , whose polynomial parts are @xmath572 , @xmath573 , @xmath574 , @xmath575 , @xmath576 and @xmath577 ( using an evident , compact notation ) , only five different spherical gtos can be constructed : the ones with polynomial parts proportional to @xmath578 , @xmath576 , @xmath577 , @xmath579 and @xmath575 @xcite . among these new sgtos ,",
    "which , in turn , are proportional ( neglecting also powers of @xmath580 , see footnote  [ foot : r_exponent_idontcare ] in page  ) to the real spherical harmonics @xmath581 , @xmath582 , @xmath583 , @xmath584 and @xmath585 , the linear combination @xmath586 is missing , since it presents the angular behaviour of an s - orbital ( proportional to @xmath587 ) .",
    "finally , let us remark that , whereas cartesian gtos in eq .",
    "( [ eq : chqc_gto ] ) are easier to be coded in computer applications than sgtos@xcite , it is commonly accepted that these spurious spherical orbitals of lower angular momentum that appear when cgtos are used do not constitute efficient choices to be included in a basis set @xcite ( after all , if we wanted an additional s - function , why include it in such an indirect and clumsy way instead of just designing a specific one that suits our particular needs ? ) .",
    "consequently , the most common practice in the field is to use cartesian gtos removing from the basis sets the linear combinations such as the @xmath586 above .",
    "now , even if the integrals involving cgtos can be computed analytically , there are still @xmath512 of them in a scf calculation .",
    "for example , in the model dipeptide hco - l - ala - nh@xmath305 , which is commonly used to mimic an alanine residue in a protein @xcite , there are 62 electrons and henceforth 31 rhf spatial orbitals @xmath464 . if a basis set with only 31 functions is used ( this is a lower bound that will be rarely reached in practical calculations due to symmetry issues , see below ) , near a million of four - centre @xmath588 integrals must be computed .",
    "this is why , one must use the freedom that remains once the decision of sticking to cgtos has been taken ( namely , the choice of the _ exponents _ @xmath537 and the _ angular momentum _",
    "@xmath540 ) to design basis sets that account for the relevant behaviour of the systems studied while keeping @xmath460 below the ` pain threshold ' .",
    "the work by nobel prize john pople s group has been a major reference in this discipline , and their sto-@xmath151 g family @xcite , together with the split - valence gaussian basis sets , 3 - 21 g , 4 - 31 g , 6 - 31 g , etc . @xcite , shall be used here to exemplify some relevant issues .",
    "however , note that most of the concepts introduced are also applicable to more modern basis sets , such as those by dunning @xcite .    to begin with ,",
    "let us recall that the short- and long - range behaviour of the slater - type orbitals in eq .",
    "( [ eq : chqc_sto ] ) is better than that of the more computationally efficient gtos . in order to improve the physical properties of the latter ,",
    "it is customary to linearly combine @xmath589 cartesian gtos , denoted now by @xmath590 ( @xmath591 ) , and termed _ rimitive aussian - ype rbitals _ ( pgto ) , having the same atomic centre @xmath543 , the same set of orbital quantum numbers , @xmath561 , @xmath562 and @xmath563 , but different exponents @xmath592 , to make up a _ ontracted aussian - ype rbitals _ ( cgto ) , defined by    @xmath593    where the normalization constants @xmath594 have been kept inside the sum because they typically depend on @xmath595 .",
    "also , we denote now by @xmath596 the number of contracted gtos and , by @xmath597 , the number of primitive ones .    in the sto-@xmath151 g family of basis sets , for example ,",
    "@xmath151 primitive gtos are used for each contracted one , fitting the coefficients @xmath598 and the exponents @xmath592 to resemble the radial behavior of slater - type orbitals @xcite . in fig .",
    "[ fig : contraction ] , the 1s - contracted gto ( see the discussion below ) of the hydrogen atom in the sto-3 g basis set is depicted , together with the three primitive gtos that form it and the sto that is meant to [ page : foot : basisform ] be approximated basis sets were obtained from the extensible computational chemistry environment basis set database at ` http://www.emsl.pnl.gov/forms/basisform.html ` , version 02/25/04 , as developed and distributed by the molecular science computing facility , environmental and molecular sciences laboratory which is part of the pacific northwest laboratory , p.o . box 999 , richland , washington 99352 , usa , and funded by the u.s .",
    "department of energy .",
    "the pacific northwest laboratory is a multi - program laboratory operated by battelle memorial institute for the u.s .",
    "department of energy under contract de - ac06 - 76rlo 1830 .",
    "contact karen schuchardt for further information . ] .",
    "we can see that the contracted gto has a very similar behavior to the sto in a wide range of distances , while the single gto that is also shown in the figure ( with the same norm and exponent as the sto ) has not .",
    "typically , the fitting procedure that leads to contracted gtos is performed on isolated atoms and , then , the already mentioned chemical intuition that states that ` atoms - in - molecules are not very different from atoms - alone ' is invoked to keep the linear combinations fixed from there on .",
    "obviously , better results would be obtained if the contraction coefficients were allowed to vary .",
    "moreover , the number of four - centre integrals that need to be calculated depends on the number of _ primitive _ gtos ( like @xmath599 ) , so that we have not gained anything on this point by contracting .",
    "however , the size of the variational space is @xmath596 ( i.e. , the number of _ contracted _ gtos ) , in such a way that , once the integrals @xmath588 are calculated ( for non - direct scf ) , all subsequent steps in the iterative self - consistent procedure scale as powers of @xmath596 . also , the disk storage ( again , for non - direct schemes )",
    "depends on the number of _ contracted _ gtos and , frequently , it is the disk storage and not the cpu time the limiting factor of a calculation .",
    "an additional chemical concept that is usually defined in this context and that is needed to continue with the discussion is that of _ shell _ : atomic shells in quantum chemistry are defined analogously to those of the hydrogen atom , so that each electron is regarded as ` filling ' the multi - electron atom ` orbitals ' according to hund s rules @xcite .",
    "hence , the _ occupied shells _ of carbon , for example , are defined to be 1s , 2s and 2p , whereas those of , say , silicon , would be 1s , 2s , 2p , 3s an 3p . each shell may contain @xmath600 electrons if complete , where @xmath601 accounts for the orbital angular momentum multiplicity and the 2 factor for that of electron spin .    [",
    "tab : contraction ]    thus , using these definitions , all the basis sets in the aforementioned sto-@xmath151 g family are _ minimal _ ; in the sense that they are made up of only @xmath601 contracted gtos for each completely or partially occupied shell , so that the sto-@xmath151 g basis sets for carbon , for example , contain two s - type contracted gtos ( one for the 1s- and the other for the 2s - shell ) and three p - type ones ( belonging to the 2p - shell ) .",
    "moreover , due to rotational - symmetry arguments in the isolated atoms , all the @xmath601 functions in a given shell are chosen to have the same exponents and the same contraction coefficients , differing only on the polynomial that multiplies the gaussian part .",
    "such @xmath601 cgtos shall be said to constitute a _",
    "aussian hell _",
    "( gs ) , and we shall also distinguish between the _ rimitive _ ( pgs ) and _ ontracted _ ( cgs ) versions .    in table",
    "[ tab : contraction ] , the exponents @xmath595 and the contraction coefficients @xmath598 of the primitive gtos that make up the three different shells in the sto-3 g basis set for carbon are presented ( see ref .",
    "@xcite and footnote  [ foot : basisform ] in page  ) .",
    "the fact that the exponents @xmath595 in the 2s- and 2p - shells are constrained to be the same is a particularity of some basis sets ( like this one ) which saves some computational effort and deserves no further attention .",
    "next , let us introduce a common notation that is used to describe the contraction scheme : it reads ( _ primitive shells _ ) / [ _ contracted shells _ ] , or alternatively ( _ primitive shells _ ) @xmath602 [ _ contracted shells _ ] . according to it , the sto-3 g basis set for carbon , for example ,",
    "is denoted as ( 6s,3p ) @xmath602 [ 2s,1p ] , or ( 6,3 ) @xmath602 [ 2,1 ] . moreover , since for organic molecules it is frequent to have only hydrogens and the 1st - row atoms c , n and o ( whose occupied shells are identical ) in proteins , one may also have sulphur in cysteine and methionine residues . ] , the notation is typically extended and the two groups of shells are separated by a slash ; as in ( 6s,3p/3s ) @xmath602 [ 2s,1p/1s ] for sto-3 g .    [",
    "tab : contraction2 ]    the first improvement that can be implemented on a minimal basis set such as the ones in the sto-@xmath151 g is the _ splitting _ , which consists in including more than one gaussian shell for each occupied one .",
    "if the splitting is evenly performed , i.e. , each shell has the same number of gss , then the basis set is called _ ouble eta _ ( dz ) , _ riple eta _ ( tz ) , _ uadruple eta _ ( qz ) , _ uintuple eta _ ( 5z ) , _ extuple eta _ ( 6z ) , and so on ; where the word _ zeta",
    "_ comes from the greek letter @xmath603 used for the exponents .",
    "a hypothetical tz basis set in which each cgto is made by , say , four primitive gtos , would read ( 24s,12p/12s ) @xmath602 [ 6s,3p/3s ] in the aforementioned notation .    at this point ,",
    "the already familiar intuition that says that ` atoms - in - molecules are not very different from atoms - alone ' must be refined with another bit of chemical experience and qualified by noticing that ` core electrons are less affected by the molecular environment and the formation of bonds than valence electrons ' recall that , for the very concept of ` core ' or ` valence electrons ' ( actually for any label applied to a single electron ) to have any sense , we must be in the hartree - fock formalism ( see footnote  [ foot : orbitals_only_in_hf ] in page  ) . ] . in this spirit , the above evenness among different shells is typically broken , and distinct basis elements are used for the energetically lowest lying ( _ core _ ) shells than for the highest lying ( _ valence _ ) ones .",
    "on one side , the contraction scheme may be different .",
    "in which case , the notation used up to now becomes ambiguous , since , for example , the designation ( 6s,3p/3s ) @xmath602 [ 2s,1p/1s ] , that was said to correspond to sto-3 g , would be identical for a _ different _ basis set in which the 1s - gaussian shell of heavy atoms be formed by 4 pgss and the 2s - gaussian shell by 2  pgss ( in 1st - row atoms , the 2s- and 2p - shells are defined as valence and the 1s - one as core , while in hydrogen atoms , the 1s - shell is a valence one ) .",
    "this problem can be solved by explicitly indicating how many primitive gss form each contracted one , so that , for example , the sto-3 g basis set is denoted by ( 33,3/3 ) @xmath602 [ 2,1/1 ] , while the other one mentioned would be ( 42,3/3 ) @xmath602 [ 2,1/1 ] ( we have chosen to omit the angular momentum labels this time ) .",
    "the other point at which the core and valence gaussian shells may differ is in their respective ` zeta quality ' , i.e. , the basis set may contain a different number of contracted gaussian shells in each case . for example , it is very common to use a single cgs for the core shells and a multiple splitting for the valence ones .",
    "these type of basis sets are called _ split - valence _ and the way of naming their quality is the same as before , except for the fact that a capital v , standing for _ alence _ , is added either at the beginning or at the end of the acronyms dz , tz , qz , etc . , thus becoming vdz , vtz , vqz , etc . or dzv , tzv , qzv , etc .",
    "pople s 3 - 21 g @xcite , 4 - 31 g @xcite , 6 - 31 g @xcite and 6 - 311 g @xcite are well - known examples of split - valence basis sets that are commonly used for scf calculations in organic molecules and that present the two characteristics discussed above .",
    "their names indicate the contraction scheme , in such a way that the number before the dash represents how many primitive gss form the single contracted gss that is used for core shells , and the numbers after the dash how the valence shells are contracted , in much the same way as the notation in the previous paragraphs .",
    "for example , the 6 - 31 g basis set ( see table  [ tab : contraction2 ] ) , contains one cgs made up of six primitive gss in the 1s - core shell of heavy atoms ( the 6 before the dash ) and two cgs , formed by three and one pgss respectively , in the 2s- and 2p - valence shells of heavy atoms and in the 1s - shell of hydrogens ( the 31 after the dash ) .",
    "the 6 - 311 g basis set , in turn , is just the same but with an additional single - primitive gaussian shell of functions in the valence region .",
    "finally , to fix the concepts discussed , let us mention that , using the notation introduced above , these two basis sets may be written as ( 631,31/31 ) @xmath602 [ 3,2/2 ] and ( 6311,311/311 ) @xmath602 [ 4,3/3 ] , respectively .",
    "two further improvements that are typically used and that may also be incorporated to pople s split - valence basis sets are the addition of _ polarization _ @xcite or _ diffuse functions _ @xcite .",
    "we shall discuss them both to close both this section and the work .    up to now , neither the contraction nor the splitting involved gtos of larger angular momentum than the largest one among the occupied shells .",
    "however , the molecular environment is highly anisotropic and , for most practical applications , it turns out to be convenient to add these _ polarization _",
    "( large angular momentum ) gaussian shells to the basis set , since they present lower symmetry than the gss discussed in the preceding paragraphs .",
    "typically , the polarization shells are single - primitive gss and they are denoted by adding a capital p to the end of the previous acronyms , resulting into , for example , dzp , tzp , vqzp , etc . , or , say , dz2p , tz3p , vqz4p if more than one polarization shell is added . in the case of pople s basis sets @xcite , these improvements are denoted by specifying , in brackets and after the letter g , the number and type of the polarization shells separating heavy atoms and hydrogens by a comma there also exists an old notation for the addition of a single polarization shell per atom that reads 6 - 31 g * * and that is equivalent to 6 - 31g(d , p ) . ] . for example",
    ", the basis set 6 - 31g(2df , p ) contains the same gaussian shells as the original 6 - 31 g plus two d - type shells and one f - type shell centred at the heavy atoms , as well as one p - type shell centred at the hydrogens .",
    "finally , for calculations in charged species ( specially anions ) , where the charge density extends further in space and the tails of the distribution are more important to account for the relevant behaviour of the system , it is common to augment the basis sets with _ diffuse functions _ , i.e. , single - primitive gaussian shells of the same angular momentum as some preexisting one but with a smaller exponent @xmath603 than the smallest one in the shell .",
    "in general , this improvement is commonly denoted by adding the prefix _",
    "aug_- to the name of the basis set . in the case of pople s basis sets , on the other hand",
    ", the insertion of a plus sign ` + ' between the contraction scheme and the letter g denotes that the set contains one diffuse function in the 2s- and 2p - valence shells of heavy atoms . a second",
    "+ indicates that there is another one in the 1s - shell of hydrogens .",
    "for example , one may have the doubly augmented ( and doubly polarized ) 6 - 31++g(2d,2p ) basis set .",
    "the ground - breaking advances reviewed in the previous sections allow to routinely calculate , using hartree - fock scf methods , physical properties of molecules of tens of atoms in present day computers . however , the simplest algorithms that can be devised to perform the limiting steps in such calculations are far from optimal .",
    "this large room for improvement , which may be enough to accommodate the exciting possibility of linearly scaling approaches that could open the door to thousands atoms computations , has been steering many innovative lines of research in the last years    to close this review , we shall briefly outline here some of the hottest areas of modern development related to the topics discussed , specially those aimed to the reduction of the in principle @xmath512 complexity associated to the calculation of the @xmath588 eris in eq .",
    "( [ eq : chqc_twoe_integrals ] ) , as well as the @xmath515 cost of the diagonalization of the fock operator in eq .",
    "( [ eq : chqc_rh_2 ] ) in principle , careful distinction must be made between the number of primitive gtos @xmath604 and the number of contracted ones @xmath596 ( see the previous section ) . however , since in this section we will be dealing only with approximate scalings without worrying much about the prefactor , the ` neutral ' notation @xmath460 has been chosen to denote a quantity which is linear on both @xmath604 and @xmath596 . ] . for wider reviews on these topics ,",
    "we recommend to the interested reader the accounts in refs .",
    "@xcite .    the first class of attempts to reduce the cost associated to the calculation of the @xmath512 eris @xmath505 are those aimed to the improvement of the algorithms for analytically calculating them _ without approximations_. there are basically two issues that render the construction of these algorithms a non trivial task : first , the fact that the only four - center eris that can be straightforwardly computed are the ones corresponding to a product of four s - type gtos , while higher angular momentum eris may obtained from them in a non unique way .    after using the _ gaussian product rule _",
    "@xcite ( see the previous section for the notation used )    @xmath605    which allows the four - centre integral to be turned into a two - center one , and whose absence for the case of stos is the essential reason for their being non practical , we can turn the 6-dimensional eri into a simple one - dimensional integral that can be readily calculated by different means @xcite :    @xmath606    with    [ eq : chqc_fund_expl ] @xmath607    such an integral is called a _ fundamental _ eri and , as we said , eris involving gtos with higher angular momentum than @xmath608 are obtained from this fundamental one through iterative differentiations of eq .",
    "( [ eq : chqc_fund ] ) with respect to the nuclear positions , leading to recurrence relations expressing eris of a given angular momentum as a function of the lower angular momentum ones",
    ". the particular flavour of these recurrence relations that is used is one of the matters in which the algorithms for calculating eris differ .    the second issue that renders the construction of algorithms for computing eris non - trivial is related to how the contraction of primitive gtos is handled .",
    "in the geminal paper by boys @xcite , the most naive procedure was suggested , namely , the conversion of each eri of contracted gtos into a quadruple sum of eris of primitive gtos .",
    "however , this does not take profit , for example , from the fact , mentioned in the previous section , that all cgtos in the same contracted gaussian shell are formed by pgtos with the same set of exponents @xmath609",
    ". much profit can be taken from this and other constraints and , in fact , the cost - scaling profile of each algorithm with the contraction degree @xmath589 of the cgtos is strongly correlated to the moment at which the transformation between cgtos and pgtos is performed @xcite .    among the most used of these analytical algorithms",
    ", we can mention the pople - hehre ( ph ) one @xcite , which additionally exploits the fact that for each four - center eri of low angular momentum there is a privileged cartesian axis system in which many primitive integrals vanish by symmetry ; the _ cmurchie - avidson _ ( md ) approach @xcite , which avoids the rotation in ph thus being more efficient for high angular momentum eris ; the _ bara - aika - chlegel _ ( oss ) algorithm @xcite ; and a better defined and improved version of it : the _ ead - ordon - ople _ ( hgp ) algorithm @xcite . finally , if the moment at which the contraction is handled is chosen dynamically depending on the type of gto appearing in the eri , we have the prism modifications of md and hgp : the md - prism @xcite and hgp - prism @xcite algorithms , as well as a generalization of all the previous methods , called cold prism @xcite .",
    "now , even if we implement any of these efficient methods for calculating the eris , there is still @xmath512 of them .",
    "this scaling is simply too harsh for a too large class of applications .",
    "therefore , the next natural step is to try to devise approximate methods that minimize the necessary decrease in accuracy at the same time that maximize the savings in computer time .",
    "thanks to the particular characteristics of the eris , the gaussian basis functions and the concrete physical problem intended to solve the locality of many - electron quantum mechanics @xcite , which is related to the _ nearsightedness _ concept introduced by kohn @xcite , is the main property that allows to finally achieve linearity . ] , this endeavour has been successfully pursued by many researchers and the ` holy grail ' @xcite of linear scaling with @xmath460 is asymptotically approaching current calculations in large systems . here , we shall discuss the basic issues that make this possible .",
    "for more in depth reviews , we point the readers to the accounts in references @xcite .    the first point to consider in order to reduce",
    "the @xmath512 scaling attains the so - called _",
    "radial overlap_. if we take a look at eq .",
    "( [ eq : chqc_contracted_gto ] ) , we can see that , irrespective of the polynomial prefactor which contains all the angular dependence of the gto , every function @xmath610 contains a radial exponential part ( actually , a sum of exponentials ) .",
    "therefore , if we consider any product @xmath611 of two gtos , we will always find a multiplying sum of terms such as those depicted in the expression for the gaussian product rule in  ( [ eq : chqc_gpr ] ) .",
    "the exponential decay of all quantities @xmath612 in those terms with the distance @xmath613 between the nuclei on which the gtos are centred indicates that , among the @xmath614 possible pair products @xmath615 , only @xmath616 of them will be non - negligible . to see this , note that if we fix ( say ) @xmath98 , the only values of @xmath470 that will yield a non - negligible product @xmath611 are those for which @xmath613 is ` small '",
    ". since atoms do not interpenetrate in most of the conformations that shall be studied , this can only happen for a number of different @xmath470 s which is not @xmath616 but a constant independent of the size of the molecule .",
    "there are @xmath460 different possible values of @xmath98 for which the above reasoning can be repeated , and the result follows .    as a consequence ,",
    "if only @xmath616 pairs @xmath617 are non - negligible , then only @xmath618 eris @xmath588 may in principle contribute in a significant way to the fock operator in eq .",
    "( [ eq : chqc_matrices_2 ] ) and not @xmath512 .",
    "( for similar estimations based on slightly different hypotheses , see @xcite . )",
    "one must also note that the discussion is complicated by the fact that the eris do not appear alone , but contracted with the density matrix elements @xmath619 .",
    "this allows for further improvements of the scaling beyond @xmath618 which are discussed later in this section .",
    "now , knowing that most of the eris are too small to be relevant , _ we do not know which ones _ and , if we calculated the @xmath512 of them in order to spot the little ones , then we would have not gained anything .",
    "this simple argument shows the necessity of finding a set of _ estimators _ that allow us to selectively drop eris _ without calculating them_. of course , the number of estimators must also scale at worst like @xmath618 in order for the scheme to be useful .",
    "one of the first and simplest such estimators , was introduced by almlf et al . at the same time that they proposed the direct scf method @xcite . in their scheme ,",
    "each eri @xmath588 was approximated by the corresponding radial overlap factor @xmath620 ( note that there are only @xmath618 numbers @xmath612 ) .",
    "although this estimator was relatively successful , it presented the important drawback of not being an upper - bound for the eris , thus rendering the control of errors an a priori impossible task . in order to overcome this problem , hser and",
    "ahlrichs @xcite later proposed a different estimator which can be assured to be always greater than the associated eri .",
    "following them , after the proof of positive definiteness by roothaan @xcite , the electrostatic interaction energy between two continuous charge distributions ,    @xmath621    can be easily shown to satisfy the properties of an inner product . hence ,",
    "if we choose @xmath622 , and @xmath623 , we can use the well - known schwarz inequality to show that    @xmath624    in such a way that , by calculating only the @xmath614 different two - index eris in the last term , we can safely bound from above the whole set containing @xmath512 of them .",
    "after these seminal works , more sophisticated and tighter bounds have been developed through the years @xcite , their application being nowadays routine in quantum chemistry packages .    in a second generation of methods ,",
    "the @xmath618 formal scaling achieved in practical calculations @xcite by using the above ideas has been recently attacked . to this end ,",
    "more specifically physical properties of the problem are exploited ( see footnote  [ locality ] in page  ) , and different strategies are used to deal with the coulomb and exchange parts of the fock operator in  ( [ eq : chqc_matrices_2 ] ) .",
    "the main difference between the behaviours of these two contributions lies in the way in which the eris are contracted with the density matrix @xmath619 : in the ` classical ' coulomb part , the relative sizes of the eris @xmath588 are largely correlated with the relative sizes of the associated elements @xmath619 @xcite , so that no decrease in the @xmath625 scaling is expected from density matrix considerations .",
    "differently , in the exchange terms , the fact that the elements @xmath619 couple ` exchanged ' indices in the @xmath626 eris produces cancellations which make this type of ` quantum ' contributions rather short - range ( for non - metallic species ) @xcite .",
    "hence , as for every short - range interaction , a number of terms scaling _ linearly _ with the system size is expected .",
    "apart from the different treatment that this difference suggests , note that the separation of the coulomb and exchange tasks allows for improved parallelization the computer codes @xcite .",
    "for the exchange part , the aforementioned short - range behaviour allows to devise @xmath616 algorithms just by intelligently ordering the loops in which the eris are calculated .",
    "the fine details of these methods are rather technical and they are beyond the scope of this review .",
    "we point the reader to @xcite and references therein for further information .    in the coulomb case ,",
    "on the other hand , @xmath618 terms still enter the sum in  ( [ eq : chqc_matrices_2 ] ) , and more physically - based approximations must be used .",
    "the _ ontinuous ast ultipole ethod _ ( cfmm ) by white et al .",
    "@xcite , for example , is probably one of the most celebrated algorithms for calculating the coulomb part of the fock operator .",
    "it is a generalization for continuous charge distributions of the _ ast ultipole ethod _ ( fmm ) , introduced by greengard and rokhlin @xcite in a ground - breaking paper and aimed for point - like charges . in both  fmm and  cfmm ,",
    "a clever hierarchical tree - like division of the space into cells is performed , and the far away regions are approximated via truncated multipole expansions .",
    "these two ingredients , which allow to calculate the coulomb contribution in @xmath616 steps for large systems , are common to most of the fast coulomb algorithms . despite this similarity",
    ", the room for improvement seems still large enough to accommodate a vigorous field with many publications appearing each year .",
    "let us mention here , for example , the _ eneralized ell ultipole ethod _",
    "( gcmm ) by kutteh et al . ,",
    "which can use moments higher than monopole @xcite ; the _ uantum hemical ree ode _ ( qctc ) by challacombe et al .",
    "@xcite , which independently thresholds ` bra ' and ` ket ' distributions ; and the _ aussian ery ast ultipole ethod _ ( gvfmm ) by strain et al .",
    "@xcite , which benefits from the idea , introduced in  @xcite for point - like charges , of using a dynamical maximum angular momentum to further speed up the calculations    note however , that the near - field contributions in these methods are still calculated without approximations and represent a great portion of the computer time . in this line ,",
    "some modern algorithms are appearing to alleviate this part of the work , such as , for example , the _ j matrix engine _ by white and head - gordon @xcite , which uses and improves the ideas discussed in the first part of this section about analytically calculating the eris ; or the method by izmaylov et al .",
    "@xcite , which implements a hierarchy of screening levels to eliminate negligible integrals .",
    "according to recent reports @xcite , the combination of cfmm , with the j matrix engine technique and with the _ ourier ransform oulomb _ ( ftc ) method by fsti - molnr and pulay @xcite is nowadays probably the fastest way for assembling the coulomb matrix .",
    "now , once the construction process of the whole fock matrix @xmath499 ( via its coulomb and exchange parts ) has been cast into the form of an @xmath616 algorithm , the importance of the second rate - limiting step in scf procedures , the diagonalization of @xmath499 , comes into focus .",
    "although the prefactor of the ( in principle ) @xmath515 diagonalization step is very small and , for systems of less than a few thousands of atoms , the absolute time spent on it is smaller than the one needed for the formation of the fock matrix @xcite , it is clear that , in the long run , it will dominate the calculations in larger systems and will become the relevant bottleneck @xcite .",
    "we shall point out the essentials regarding the methods aimed to reduce the scaling the diagonalization step . for more in depth reviews on the topic ,",
    "we suggest to the reader the accounts in  @xcite .    the @xmath515 complexity of classical diagonalization methods ( such as the givens - householder one @xcite ) can be easily understood if we think that the core of the algorithm is just the multiplication of @xmath486 matrices",
    ". nevertheless , if the matrices multiplied are _ sparse _ , i.e. , they have a number of non - negligible elements that scale not as @xmath618 but as @xmath616 , then the product can be obtained in @xmath616 steps . as a result of the already mentioned locality properties of many - body quantum mechanics ( see footnote  [ locality ] in page  ) , some matrices appearing in the scf methods discussed in this review , namely , the density matrix @xmath627 and the fock operator @xmath499 , are indeed sparse if the system is non - metallic , i.e. , if it has a non - vanishing homo - lumo gap @xcite .",
    "the idea behind most of the modern algorithms for achieving ( or avoiding ) diagonalization with @xmath616 effort consists essentially in performing all operations using only these ( local ) sparse matrices , and avoiding ( non - local ) dense ones , such as the mo coefficients matrix @xmath628 .",
    "the attempts to improve the scaling of the diagonalization steps fall basically in two groups @xcite . in the first one ,",
    "profit is taken from the use of mos which , instead of being extended over the whole molecule , such as the canonical orbitals used in the previous sections , are _ localized _ in a small region of space . in these class of methods , diagonalization @xcite or pseudo - diagonalization ( annihilation of the occupied - virtual blocks of the fock matrix ) @xcite is still performed , and the @xmath616 scaling is achieved because the representation of all operators in the basis of localized mos is sparse .",
    "the second group of algorithms do not use the mos as variables but the density matrix itself . among them , two subfamilies of methods may be found : in the first one , the search for the optimal density matrix is simply treated as a standard optimization problem , being the score function the hf energy , and the variables the density matrix elements or a set of parameters of some suitable truncated expansion of it @xcite .",
    "see , for example , the approaches by ochsenfeld and head - gordon @xcite , by salek et al .",
    "@xcite , by millam and scuseria @xcite , or by ordejn et al .",
    "the other subfamily of density matrix - based methods use iterative procedures , in such a way that , at each step , the fock operator is considered fixed and the equations are solved for the density matrix ( much in the spirit of the mos - based algorithms discussed in the previous sections ) . in this group , we can find , for example , the approach in @xcite using the lanczos algorithm @xcite , or the method by helgaker et al .",
    "@xcite .",
    "these algorithms , combined with new strategies that also avoid diagonalization and improve scf convergence properties , such as the one described in  @xcite , represent the final step towards linear hartree - fock methods in quantum chemistry .    to close this section , although we have been concerned , up to now , with the calculation of the electronic ground - state given a fixed position of the nuclei , let us stress that it is also very common to use quantum chemical methods for finding the local energy minima of molecules .",
    "to this end , geometry optimizations must be performed and not only must we be able to compute the energy of the molecule , but also their derivatives with respect to the nuclear coordinates .",
    "additionally , these derivatives are also needed to do ab initio molecular dynamics in the ground - state born - oppenheimer pes @xcite .    the most naive approach , namely , the computation of the gradient of the energy @xmath629 ( using a simpler notation for it than @xmath630 in  ( [ eq : chqc_v_eff ] ) ) by finite differences , is very inefficient for anything but the smallest molecules . to see this , one just need to notice that the gradient has as many components as the system degrees of freedom @xmath151",
    "hence , in order to obtain it , say , at a point @xmath631 , we would have to compute @xmath632 times a single point energy , in order to know @xmath633 and @xmath634 , being @xmath635 , with @xmath636 , a small displacement in each of the nuclear degrees of freedom .",
    "this drawback was overcome in the late 60s by pulay and others ( see @xcite and references therein ) with the introduction of the so - called _ analytical derivatives _ , in which the gradient ( and higher - order derivatives ) are expressed , like the energy itself , just as a function of eris involving the wavefunction at the point @xmath631 .",
    "this marked an inflexion point in the development of optimization and molecular dynamics algorithms that continues nowadays , as analytical derivatives are routinely introduced together with almost any new method for calculating the energy . in relation to the improvements reviewed in this work , for example ,",
    "let us note that , in @xcite , the extension of the j matrix engine method to calculate the derivatives of the coulomb part with respect of the nuclei coordinates is introduced ; in @xcite , linear scaling exchange gradients are developed ; analytic derivatives for the gvfmm are provided in @xcite ; the hgp algorithm for calculating the eris is extended to the computation of derivatives of the eris as well in @xcite ; and we may find similar developments for the ftc method @xcite or for algorithms that achieve diagonalization with linear effort @xcite .",
    "this work has been supported by the research projects e24/3 and pm048 ( aragn government ) , mec ( spain ) and mcyt ( spain ) .",
    "p. echenique has been supported by a bifi research contract and by a mec ( spain ) postdoctoral grant .",
    "a _ functional _ @xmath78 $ ] is a mapping that takes functions to numbers ( in this work , only functionals in the real numbers are considered ) :    @xmath637 \\end{array}\\ ] ]    for example , if the function space @xmath638 is the hilbert space of square - integrable functions @xmath91 ( the space of states of quantum mechanics ) , the objects in the domain of @xmath639 ( i.e. , the functions in @xmath91 ) can be described by infinite - tuples @xmath640 of complex numbers and  @xmath639 may be pictured as a function of infinite variables .",
    "when dealing with function spaces @xmath638 that meet certain requirements we will not discuss the issue further but let it suffice to say that @xmath91 does satisfy these requirements . ] , the limit on the left - hand side of the following equation can be written as the integral on the right - hand side :    @xmath641 - \\mathcal{f}[\\psi_{0}]}{\\varepsilon } : =   \\int \\frac{\\delta \\mathcal{f}[\\psi_{0}]}{\\delta\\psi}(x ) \\delta\\psi(x )   \\mathrm{d}x\\   , \\ ] ]    where @xmath66 denotes a point in the domain of the functions in @xmath638 , and the the object @xmath642 / \\delta\\psi)(x)$ ] ( which is a function of @xmath66 not necessarily belonging to @xmath638 ) is called the _ functional derivative _ of @xmath78 $ ] in the in the _ point _ @xmath643 .",
    "one common use of this functional derivative is to find stationary points of functionals .",
    "a function @xmath643 is said to be an _ stationary point _ of @xmath78 $ ] if :    @xmath644}{\\delta\\psi}(x ) = 0 \\   .\\ ] ]    in order to render this definition operative , one must have a method for computing @xmath645 / \\delta\\psi)(x)$ ] .",
    "interestingly , it is possible , in many useful cases ( and in all the applications of the formalism in this work ) , to calculate the sought derivative directly from the left - hand side of eq .",
    "( [ eq : def_funct_der ] ) .",
    "the procedure , in such a situation , begins by writing out @xmath646 $ ] and clearly separating the different orders in @xmath647 .",
    "secondly , one drops the terms of zero order ( by virtue of the subtraction of the quantity @xmath648 $ ] ) and those of second order or higher ( because they vanish when divided by @xmath647 and the limit @xmath649 is taken ) .",
    "the remaining terms , all of order one , are divided by @xmath647 and , finally , @xmath645 / \\delta\\psi)(x)$ ] is identified out of the resulting expression ( which must written in the form of the right - hand side of eq .",
    "( [ eq : def_funct_der ] ) . for",
    "a practical example of this process , see secs .",
    "[ sec : qc_hartree ] and [ sec : qc_hartree - fock ] .",
    "very often , when looking for the stationary points of a function ( or a functional ) , the search space is not the whole one , in which the derivatives are taken , but a certain subset of it defined by a number of constraints .",
    "an elegant and useful method for solving the constrained problem is that of the _ lagrange multipliers_.    although it can be formally generalized to infinite dimensions ( i.e. , to functionals , see appendix  a ) , here we will introduce the method in @xmath650 in order to gain some geometrical insight and intuition .",
    "the general framework may be described as follows : we have a differentiable function @xmath651 that takes points in @xmath650 to real numbers and we want to find the stationary points of @xmath97 restricted to a certain subspace @xmath652 of @xmath650 , which is defined by @xmath653 _ constraints _ if the constraints are functionally independent , one must also ask that @xmath654 . if not , @xmath652 will be either a point ( if @xmath655 ) or empty ( if @xmath656 ) . ] :      the points that are the solution of the constrained problem are those @xmath658 belonging to  @xmath652 where the first order variation of @xmath97 would be zero if the derivatives were taken ` along '  @xmath652 . in other words , the points @xmath658 where the gradient @xmath659 has only components ( if any ) in directions that ` leave ' @xmath652 ( see below for a rigorous formalization of these intuitive ideas ) . thus , when comparing the solutions of the unconstrained problem to the ones of the constrained problem , three distinct situations arise ( see fig .  [ fig : lagrange ] ) :    1 .   a point @xmath658 is a solution of the unconstrained problem ( i.e. it satisfies @xmath660 ) but it does not belong to @xmath652 .",
    "hence , it is not a solution of the constrained problem .",
    "this type of point is depicted as a white - filled circle in fig .",
    "[ fig : lagrange ] .",
    "a point @xmath658 is a solution of the unconstrained problem ( i.e. it satisfies @xmath660 ) and it belongs to @xmath652 .",
    "hence , it is also a solution of the constrained problem , since , in particular , the components of the gradient in directions that do not leave @xmath652 are zero .",
    "this type of point is depicted as a gray - filled circle inside a white - filled circle in fig .",
    "[ fig : lagrange ] .",
    "3 .   a point @xmath658 is not a solution of the unconstrained problem ( i.e. , one has ) but it belongs to @xmath652 and the only non - zero components of the gradient are in directions that leave @xmath652 .",
    "hence , it is a solution of the constrained problem .",
    "this type of point is depicted as a gray - filled circle in fig .",
    "[ fig : lagrange ] .    from this discussion , it can be seen that , in principle , no conclusions about the number ( or existence ) of solutions of the constrained problem may be drawn only from the number of solutions of the unconstrained one .",
    "this must be investigated for each particular situation .    in fig .",
    "[ fig : lagrange ] , an schematic example in @xmath125 is depicted .",
    "the constrained search space @xmath652 is a 2-dimensional surface and the direction note that , only if @xmath661 , i.e. , if the dimension of @xmath652 is @xmath195 , there will be a vector perpendicular to the constrained space . for @xmath662 , the dimensionality of the vector space of the directions in which one ` leaves '  @xmath652 will be also larger than 1 . ]",
    "in which one leaves @xmath652 is shown at several points as a perpendicular vector @xmath663 .",
    "in such a case , the criterium that @xmath659 has only components in the direction of leaving @xmath652 may be rephrased by asking @xmath659 to be parallel to @xmath663 , i.e. , by requiring that there exists a number @xmath71 such that @xmath664 .",
    "the case @xmath665 is also admitted and the explanation of the minus sign will be given in the following .",
    "it is clear that , requiring the gradient of @xmath667 to be zero , one recovers the condition @xmath669 , which is satisfied by the points solution of the constrained stationary points problem .",
    "if one also asks that the derivative of @xmath667 with respect to @xmath71 be zero , the constraint @xmath670 that defines @xmath652 is obtained as well .",
    "this process illustrates the _ lagrange multipliers _ method in this particular example . in the general case , described by eq .",
    "( [ eq : constraints ] ) and the paragraph above it , it can be proved that the points @xmath658 which are stationary subject to the constraints imposed satisfy            also , it is worth remarking here that any two pair of functions , @xmath674 and @xmath675 , of @xmath650 whose restrictions to @xmath652 are equal ( i.e. , that satisfy @xmath676 ) obviously represent the same constrained problem and they may be used indistinctly to construct the auxiliary function @xmath667 .",
    "this fact allows us , after having constructed @xmath667 from a particular @xmath97 , to use the equations of the constraints to change @xmath97 by another simpler function which is equal to @xmath97 when restricted to  @xmath652 .",
    "this freedom is used to derive the hartree and hartree - fock equations , in secs .",
    "[ sec : qc_hartree ] and  [ sec : qc_hartree - fock ] , respectively .    the formal generalization of these ideas to functionals ( see appendix  a ) is straightforward if the space @xmath650 is substituted by a functions space @xmath639 , the points @xmath658 by functions , the functions @xmath97 , @xmath677 and @xmath667 by functionals and the requirement that the gradient of a function be zero by the requirement that the functional derivative of the analogous functional be zero .",
    "finally , let us stress something that is rarely mentioned in the literature : _ there is another ( older ) method , apart from the lagrange multipliers one , for solving a constrained optimization problem : simple substitution .",
    "i.e. , if we can find a set of @xmath678 independent _ adapted coordinates _ that parameterize @xmath652 and we can write the score function @xmath97 in terms of them , we would be automatically satisfying the constraints .",
    "actually , in practical cases , the method chosen is a suitable combination of the two ; in such a way that , if substituting the constraints in @xmath97 is difficult , the necessary lagrange multipliers are introduced to force them , and vice versa .    as a good example of this",
    ", the reader may want to check the derivation of the hartree equations in sec .",
    "[ sec : qc_hartree ] ( or the hartree - fock ones in sec .",
    "[ sec : qc_hartree - fock ] ) .",
    "there , we start by proposing a particular form for the total wavefunction @xmath112 in terms of the one - electron orbitals @xmath326 ( see eq .",
    "( [ eq : chqc_constraint_total_h ] ) ) and we write the functional @xmath639 ( which is the expected value of the energy ) in terms of that special @xmath112 ( see eq .",
    "( [ eq : chqc_constrained_functional_h ] ) ) . in a second step ,",
    "we impose the constraints that the one - particle orbitals be normalized ( @xmath679 ) and force them by means of @xmath4 lagrange multipliers @xmath680 . despite the different treatments , both conditions are constraints standing on the same footing .",
    "the only difference is not conceptual , but operative : for the first condition , it would be difficult to write it as a constraint ; while , for the second one , it would be difficult to define adapted coordinates in the subspace of normalized orbitals .",
    "so , in both cases , the easiest way for dealing with them is chosen .",
    "mackerell  jr . , a.  d. , brooks , b. , brooks  iii , c.  l. , nilsson , l. , roux , b. , won , y. , and karplus , m. in _ the encyclopedia of computational chemistry _ , p.  v.  r. schleyer , p.  r. schreiner , n.  l. allinger , t. clark , j. gasteiger , p. kollman and h.  f. schaefer iii ( eds ) , pp . 217277 ,",
    "john wiley & sons , chichester ( 1998 ) .",
    "cancs , e. , defranceschi , m. , kutzelnigg , w. , le  bris , c. , and maday , y. in _ handbook of numerical analysis .",
    "volume x : special volume : computational chemistry _ , p.  ciarlet and c.  le  bris ( eds ) , pp .",
    "3270 , elsevier ( 2003 ) .",
    "schlegel , h.  b. and mcdouall , j. j.  w. in _ computational advances in organic chemistry : molecular structure and reactivity _ , c.  gretir and i.  g. csizmadia ( eds ) , pp .",
    "167185 , kluwer academic , the netherlands ( 1991 ) .",
    "rodrguez , a.  m. , baldoni , h.  a. , suvire , f. , nieto  vzquez , r. , zamarbide , g. , enriz , r.  d. , farkas , . , perczel , a. , mcallister , m.  a. , torday , l.  l. , papp , j.  g. , and csizmadia , i.  g. , * 455 * , 275301 ( 1998 ) .",
    "garca de  la vega , j.  m. and miguel , b. in _ introduction to advanced topics of computational chemistry _ , l.  a. montero , l.  a. daz and r.  bader ( eds ) , chapt .  3 , pp .",
    "4180 , editorial de la universidad de la habana ( 2003 ) .",
    "shao , y. , molnar l. f. , jung , y. , kussmann , j. , ochsenfeld , c. , brown , s. t. , gilbert , a. t. b. , slipchenko , l. v. , levchenko , s. v. , oneill , d. p. , distasio , r. a. , lochan , r. c. , wang , t. , beran , g. j. o. , besley , n. a. , herbert , j. m. , lin , c. y. , van voorhis , t. , chien , s. h. , sodt , a , steele , r. p. , rassolov , v. a. , maslen , p. e. , korambath , p. p. , adamson , r. d. , austin , b. , baker , j. , byrd , e. f. c. , dachsel , h. , doerksen , r. j. , dreuw , a , dunietz , b. d. , dutoi , a. d. , furlani , t. r. , gwaltney , s. r. , heyden , a. , hirata , s. , hsu , c. p. , kedziora , g. , khalliulin , r. z. , klunzinger , p. , lee , a. m. , lee , m. s. , liang , w. , lotan , i. , nair , n. , peters , b. , proynov , e. i. , pieniazek , p. a. , rhee , y. m. , ritchie , j. , rosta , e. , sherrill , c. d. , simmonett , a. c. , subotnik , j. e. , woodcock , h. l. , zhang , w. , bell , a. t. , chakraborty , a. k. , chipman , d. m. , keil , f. j. , warshel , a. , hehre , w. j. , schaefer , h. f. , kong , j. , krylov , a. i. , gill , p. m. w. , head - gordon , m. , * 8 * , 31723191 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> we present here a review of the fundamental topics of hartree - fock theory in quantum chemistry . from the molecular hamiltonian , using and discussing the born - oppenheimer approximation , we arrive to the hartree and hartree - fock equations for the electronic problem . </S>",
    "<S> special emphasis is placed in the most relevant mathematical aspects of the theoretical derivation of the final equations , as well as in the results regarding the existence and uniqueness of their solutions . </S>",
    "<S> all hartree - fock versions with different spin restrictions are systematically extracted from the general case , thus providing a unifying framework . </S>",
    "<S> then , the discretization of the one - electron orbitals space is reviewed and the roothaan - hall formalism introduced . </S>",
    "<S> this leads to a exposition of the basic underlying concepts related to the construction and selection of gaussian basis sets , focusing in algorithmic efficiency issues . </S>",
    "<S> finally , we close the review with a section in which the most relevant modern developments ( specially those related to the design of linear - scaling methods ) are commented and linked to the issues discussed . </S>",
    "<S> the whole work is intentionally introductory and rather self - contained , so that it may be useful for non experts that aim to use quantum chemical methods in interdisciplinary applications . </S>",
    "<S> moreover , much material that is found scattered in the literature has been put together here to facilitate comprehension and to serve as a handy reference .    quantum chemistry </S>",
    "<S> ; introduction ; hartree - fock ; basis sets ; scf    * table of contents *    to </S>"
  ]
}