{
  "article_text": [
    "scanning tunneling microscopy ( stm ) has been considered the most important technique to image , control and monitorize molecular systems with atomic resolution under a wide range of experimental conditions that enable molecule visualization .",
    "typically , the stm image is composed of a bidimensional array of current values obtained when a metallic tip is very close to a conductive substrate creating a tunnel effect by applying a voltage between both conductive media or electrodes .",
    "the image resolution depends on several factors , such as the nature of electrodes , conductivity of the molecular system , packing order of molecules , and temperature .",
    "the quality of stm images is , however , limited by various degradation mechanisms including noise ( thermal and poissonian due to the electronic counting process ) , drifts , and dropouts .",
    "these degradation mechanisms reduce considerably the interpretability of stm images , calling for image denoising and restoration techniques to mitigate the effect of those degradations mechanisms .",
    "there are several software suites that perform image denoise of stm images  @xcite .",
    "most techniques implement denoising in the two - dimensional frequency domain by exploiting the fact that the stm images are quasi - periodicity and thus have quasi - discrete and quasi - periodic patterns in the frequency domain . however , the degradation mechanisms mentioned above defocus the frequency patterns , compromising the success of the frequency based denoising techniques .",
    "image denoising is one of the oldest image restoration problems , which continues to be object of intense research . as in many signal and image areas ,",
    "the success of image denoising depends crucially on the existence of a good model to represent the original image . in this paper , we attack stm denoising by reformulating the true estimation problem as a sparse regression , often termed sparse coding . following the standard procedure in patch - based image restoration , the image is partitioned into small overlapping square patches and the vector corresponding to each patch is modeled as a sparse linear combination of vectors , termed atoms , taken from a set called dictionary .",
    "aiming at optimal sparse representations , and thus at optimal noise removing capabilities , the dictionary is learned from the data it represents via matrix factorization with sparsity constraints on the code ( i.e. , the regression coefficients ) enforced by the @xmath0 norm  @xcite .",
    "the sparsity of a representation on a dictionary is strongly linked with the level of self - similarity of the images under study .",
    "it happens that stm images have a high level of self - similarity and , therefore , they are natural candidates to be denoised via sparse regression on learned dictionaries . compared with the standard approaches , stm images pose an additional challenge : they have plenty of artifacts , mainly dropouts , which appear in a structured way as consecutive line segments on the scanning direction .",
    "to cope we these artifacts , we modify the algorithm introduced in @xcite ; the modifications consists in treating the artifacts as missing data in both the dictionary learning and denoising ( i.e. , coding ) phases .    to assess the quality of the proposed approach",
    ", we applied the algorithm to stm images of porphyrins and bipyridines adsorbed on highly oriented pirolitic graphite .",
    "the matlab code of the algorithm and a gwyddion module can be obtained from http://www.lx.it.pt/~jpaos/stm/[http://www.lx.it.pt/@xmath1jpaos/stm/ ] .",
    "signals and images can be represented in different ways .",
    "several methods include fourier transform methods  @xcite , wavelets methods  @xcite , curvelets methods  @xcite , just to mention a few . despite the underlying differences , each representation has its own advantages when used in some of the classical , and still challenging , image restoration problems  @xcite .    recently , sparse linear decomposition of signals in learned dictionaries led to state - of - the - art methods .",
    "the idea is to represent a signal , or fragments of the signal denoted patches , as a linear combination of vectors , termed atoms , taken from a set called dictionary .",
    "the dictionary can be fixed , for example based on wavelets  @xcite , or can be learned  @xcite .    the topic of sparse and redundant representations of real world images is currently one of the most active research fields .",
    "recently , there has been an increased interest due to the fact that dictionaries yielding sparse representations may be learned directly from the data they represent  @xcite .",
    "the fact that the real world images ( and signals ) admit sparse representations in suitable dictionaries is a consequence of the high level of self - similarity of real world images ( and signals ) , i.e. , given an image patch , there is a high likelihood of finding similar patches at different locations and scales .",
    "this is also true in the case of stm images : by nature , an stm image is almost a periodic image , and thus there exist similar patches with high probability .",
    "the proposed algorithm works as follows : ( i ) the noisy stm image is decomposed in smaller patches ; ( ii ) a dictionary is learned from the data ; ( iii ) the patches are sparsely coding using just a few atoms from the learned dictionary ; and ( iv ) the denoised / restored image is obtained by composition of the coded patches . in the following sections we introduce notation and describe in detail the constituent parts of the proposed _ sparseland _ framework to restore stm images .",
    "sensor measurements are usually corrupted by noise .",
    "stm images are not an exception , and the observation mechanism is well approximated by the additive model @xmath2 where @xmath3 is the noisy image , @xmath4 the true image , and @xmath5 models noise and model errors .",
    "the noise is originated by different sources , such as the tip movements , thermal noise , poissonian couting noise , or even from the fact that different molecules have different conductivities . given the relatively number of independent causes , we assume that the noise is zero - mean independent gaussian with an unknown variance @xmath6 .",
    "the goal is to obtain an estimate of @xmath4 given @xmath3 .    unlike other denoise algorithms",
    ", the proposed _ sparseland _ framework processes the image in small patches rather than the whole image .",
    "consider the noisy image @xmath7 , where @xmath8 is the image size , and the patch @xmath9 containing the pixels located inside a square window of size @xmath10 centered at the @xmath11-th pixel .",
    "the total number of overlapping patches that exist in image @xmath3 is @xmath12 .",
    "let @xmath13 and @xmath14 denote two vectors holding , respectively , the elements @xmath4 and of @xmath5 corresponding to the @xmath11-th patch .",
    "we have then @xmath15 in the _ sparseland _ framework , patches are processed individually , and thus for each @xmath16 we obtain an estimate @xmath17 . given that the reconstruction is not exact , we can write @xmath18 where @xmath19 is the estimation error for the @xmath11-th patch . to produce the overall estimate of @xmath4 from the estimates @xmath16 , for @xmath20 , we combine the information of several patches as follows .",
    "we introduce selection matrices @xmath21 such that @xmath22 .",
    "note that each row of @xmath21 contains just one non - null element of value 1 .",
    "consider also the following matrix and vectors : @xmath23^t\\\\ \\widehat{\\mathbf{x}}_p & : = & [ \\widehat{\\mathbf{x}}_1^t , \\ldots , \\widehat{\\mathbf{x}}_{n_p}^t]^t\\\\ \\varepsilon_p & : = & [ \\varepsilon_1^t , \\ldots , \\varepsilon_{n_p}^t]^t.\\end{aligned}\\ ] ] with the above notation , the estimate of each patch is given by @xmath24 and the overall estimate @xmath25 can be obtained by @xmath26 where @xmath27 .",
    "noting that @xmath28 places the path number @xmath11 at its position in the image and that @xmath29 is a diagonal matrix whose @xmath11-th diagonal element holds the number of times pixel @xmath11 appears in any patch , the estimate for the @xmath11-th pixel is the average of all its estimates , one per patch containing thereof .",
    "this condition implies that @xmath29 is invertible as far as any pixel belongs at least to one patch .    the estimate given by  ( [ eq : estimate_x_from_xp ] ) is the best linear unbiased estimator for @xmath4  @xcite , as long as we assume that @xmath30 is zero - mean and independent and identicaly distributed ( iid ) , and thus having a covariance matrix proportional to the identity matrix , i.e. , @xmath31 .",
    "however , due to the overlapping structure of the patches it is very difficult to accurately compute @xmath32 .",
    "we opted to use the suboptimal estimate  ( [ eq : estimate_x_from_xp ] ) that , nevertheless , produces state - of - the - art results .",
    "given the periodic characteristic of a stm image , it is very likely that it admits a sparse representation in fixed existing dictionaries ( i.e. , representations )",
    ". wavelets and fourier bases are two paradigmatic examples . however , the use of learned dictionaries from the data they represent holds systematically the state - of - the - art  @xcite .",
    "the goal of dictionary learning is to find a dictionary such that the patches can be accurately represented with just a few number of elements .",
    "one way to formulate this idea is solving the following optimization problem : @xmath33 where @xmath34 \\in \\mathbb{c}^{m\\times k}$ ] , @xmath35 .",
    "the quadratic terms account for the representation errors and the @xmath36 norm is used to promote sparse codes .",
    "the relative weight between the two terms is established by the regularization parameter @xmath37 .",
    "the constraint @xmath38 is just a technical condition to prevent @xmath39 from being arbitrarily large .",
    "although the focus of this paper is not on the optimization of ( [ eq : diclearning ] ) , it is worth mentioning just a few words about it .",
    "a common approach to handle these problems  @xcite is to alternate the optimization with respect to @xmath39 and @xmath40 .",
    "the optimization with respect to @xmath39 is a quadratic problem with convex constraints and optimization with respect to @xmath40 is also convex and decoupled ( we can solve individually for each @xmath41 variable ) .",
    "however , the optimization with respect to all variables is non - convex .",
    "although we are not guaranteed to converge to the global minimum , the obtained stationary points have shown to produce state - of - the - art results .    in a typical stm image , we have @xmath42 , @xmath43 , and @xmath44 .",
    "these numbers mean that the computational burden necessary to compute ( [ eq : diclearning ] ) is heavy .",
    "to cope with this shortcoming , we adopt the online learning approach introduced in  @xcite , which largely reduces that computational complexity . for more details",
    "see in  @xcite .",
    "once we have learned a dictionary @xmath39 with respect to which the patches of @xmath4 admit a sparse representation , we proceed and compute the estimate of a given patch @xmath45 , for @xmath46 .",
    "following the standard formulation in synthesis based approaches to sparse regression , the patch estimate @xmath47 is the solution of the constrained optimization @xmath48 where @xmath49 is the observed patch corresponding to the true patch @xmath16 , @xmath50 and @xmath51 is the number of nonzero elements of vector @xmath52 , and @xmath53 is a parameter controlling the reconstruction error .    when @xmath54 and the dictionary is full column range , the solution of the optimization problem  ( [ eq : sparsedenoise ] ) , if it exists , is easy to compute .",
    "however , in the majority of the situations , this is not the case because the dictionaries are often overcomplete and , due to noise , @xmath55 . under these circumstances ,",
    "the problem is np - hard  @xcite .",
    "two different approaches have been followed .",
    "one consists in replacing @xmath56 by the @xmath36 norm , which results in the so - called least absolute shrinkage and selection operator ( lasso )  @xcite , which is equivalent to the basis pursuit denoising ( bpdn )  @xcite .",
    "the other consists in attacking directly the original problem using greedy algorithms such as the orthogonal basis pursuit ( omp )  @xcite , iterative hard thresholding ( iht )  @xcite , hard thresholding pursuit  @xcite , or approximate message passing ( mp )  @xcite .    in this work",
    "we follow the same approach as in  @xcite , and choose the omp  @xcite algorithm because of its lower computational complexity compared with the others .",
    "the details can be found in  @xcite .",
    "assuming that the noise of each patch is zero - mean and has covariance @xmath57 , it is possible to show  @xcite that the relative attenuation of noise is given by @xmath58}{\\mathbb{e}[\\|n_i \\|^2_2 ] } = \\frac{p}{m}.\\ ] ] this means that the estimation error is proportional to the sparsity level of the signal .",
    "however , in practice , the ratio  ( [ eq : noisereduction ] ) is hardly achieved .",
    "one can also understand the noise reduction from a geometric point of view .",
    "the sparse coding of the patches , given by optimization problem ( [ eq : sparsedenoise ] ) , can be viewed as a projection of the noisy patch @xmath59 onto the subspace spanned by the active columns of @xmath60 in that patch , corresponding to the non - zero components of @xmath52 . given that the number of active actoms is much samller than the @xmath61 , the noise is largely reduced .",
    "the _ sparseland _ framework works well for stm images because the images are almost periodic .",
    "this makes it easier to learn the dictionary directly from the data . besides the presence of noise , stm images usually have plenty of artifacts .",
    "however , they do not appear isolated , such as impulsive noise , but rather in a structured way . typically , several consecutive pixels along a scanning line may be corrupted .",
    "figure  [ fig : artifacts ] shows an example of a stm image with artifacts that hampers the observation of darker spots .",
    "the image represents a polymorphic monolayer with zinc(ii)octaethylporphyrin ( znoep ) molecules organized as dimer - like units with different brightness aligned along parallel rows and absorbed on highly oriented pyrolitic graphite ( hopg ) by @xmath62 stacking interaction  @xcite .",
    "the difference in brightness of the two znoep units is due to their different coupling to the hopg where the darker molecules have lower signal and for this reason is hard to distinguish with high detail the central part of porphyrines and their axial groups .",
    "30 nm , v=570mv , i=28pa ) of a polymorphic phase of a znoep monolayer absorbed on hopg where the znoep are organized as dimers with different brightness .",
    "the image has important artifacts that make it hard to interpret.[fig : artifacts],width=264 ]    in order to proceed , special care must be taken to eliminate these artifacts , otherwise the learned dictionary ends up with patches that can represent well these outliers . to overcome these problems",
    ", we change the algorithm by introducing an extra vector that masks out these pixels .",
    "this approach has several advantages .",
    "it makes it easy to iteratively improve on current results , either by adding or removing pixels from the mask ( considered outliers ) .",
    "it also allows us to easily fill in the outliers pixels ( inpainting ) with new values . as opposed to a classical local filtering method",
    ", the new inpainting values can take into account the full image statistics , and thus attain superior reconstruction quality .",
    "the proposed algorithm changes the previously introduced _ sparseland _ framework to accomplish two objectives : ( i ) deal with the structured outliers ; and ( ii ) do inpainting of those pixels .",
    "we start by defining a binary vector @xmath63 of size @xmath64 , where 0 indicates that the corresponding pixel in @xmath4 is considered an outlier .",
    "the purpose of this vector is to mask out the outliers .",
    "let @xmath65 for @xmath46 denote a patch of @xmath66 .",
    "note that @xmath67 indicate the outlier s positions in the patches @xmath16 .",
    "figure  [ fig : mask ] shows the stm image of figure  [ fig : artifacts ] with the mask over - imposed .",
    "the pixels considered outliers are represented in red .     with masked outliers represented in red.[fig : mask],width=264 ]",
    "the dictionary learning algorithm is the same as described in section  [ sec : diclearning ] . to avoid learning the outliers structures , instead of considering all the patches",
    ", we use @xmath67 to discard those that contain outliers .",
    "the sparse coding algorithm is also the same as described in section  [ sec : sparsecoding ] .",
    "however , in this case , we do not discard any patch ; we code the patches ignoring only the pixels that are considered outliers by solving the optimization @xmath68 where the symbol @xmath69 represents elementwise multiplication .",
    "note that the effect of @xmath70 and @xmath71 is to project the columns of @xmath60 and @xmath72 onto a lower dimension subspace .",
    "the corresponding change in the omp algorithm is simply an element - wise multiplication by  @xmath67 .",
    "finally , once we have a sparse representation for all the patches , the image composition is the pixel - wise average of all the patches covering a pixel , marked or not as an outlier .",
    "the inpainting values obtained outperform those that result from substituting the outliers by a local filtering . in section  [ sec : results ] we compare both approaches . a matlab version and a gwyddion@xcite module of the code",
    "are available at http://www.lx.it.pt/~jpaos/stm/[http://www.lx.it.pt/@xmath1jpaos/stm/ ] .",
    "before we apply the proposed algorithm , raw stm images are pre - processed and artifacts are identified , i.e. , matrix @xmath73 is defined .",
    "we start by applying the following pre - processing steps :    1 .",
    "mean level subtraction : a plane is adjusted to all the data points and subtracted from the data ; 2 .",
    "outlier removal : pixel data that is below 1% or above 99% of the quantile are removed ; 3 .",
    "leveling by median subtraction : lines are adjusted to match height median .    following this",
    "pre - processing steps , artifacts are identified by inspection and marked in matrix @xmath73 .",
    "remark that common image processing software suites have tools designed to obtain @xmath73 automatically . as an example ,",
    "gwyddion  @xcite implements an algorithm denoted _ mark scars _ , where several parameters for outlier detection can be specified such as minimum / maximum length and width .    for better results",
    ", the process can be iterated : start with an initial mask , apply the algorithm , improve on the mask from restored image and repeat the process .    [ cols=\"^,^,^,^,^ \" , ]     in figure  [ fig : results2c ]  ( c ) , the restored image ( denoised ) shows clearly the details of darker znoep where it is possible to observe the znoep central part surrounded by 4 protrusions that we attribute to the ethyl groups that are oriented towards the hopg as is represented by molecular schema of figure  [ fig : results2d ] .",
    "when the proposed algorithm is used without a mask , figure  [ fig : results2c ]  ( d ) , the structured outliers are only partially removed .",
    "this happens because the dictionary learning algorithm actually learns these structures .",
    "thus , there will be atoms available in @xmath39 such that a patch with outliers still admits a sparse representation .",
    "however , when a mask is used , the algorithm removes these outliers and fill in the pixels with new values . instead of a local median or a more sophisticated interpolation algorithm , by relying on the learned dictionary , the filled in values",
    "are in accordance to the global image statistics .",
    "we presented a denoising algorithm , formulated as sparse regression problem , to mitigate the effect of the degradation mechanisms observed in stm images .",
    "the proposed formulation was introduced based on the fact that stm images present a high level of self - similarity , so that a suitable dictionary could be learned from the noisy image .",
    "the algorithm also cope with the existence of artifacts , mainly dropouts , by treating them as missing data .",
    "the results obtained outperform those algorithms that substitute the outliers by a local filtering , as the filled in values are now in accordance to the global image statistics .",
    "the authors thank fct  portugal for financial support under the project pest ",
    "oe / eei / la0008/2013 and post - doc grant to qf .",
    "m.  aharon , m.  elad , and a.  bruckstein , `` k - svd : an algorithm for designing overcomplete dictionaries for sparse representation , '' _ signal processing , ieee transactions on _ , vol .  54 , no .  11 , pp . 43114322 , 2006 .",
    "q.  ferreira , a.  bragana , l.  alccer , and j.  morgado , `` conductance of well - defined porphyrin self - assembled molecular wires up to 14 nm in length , '' _ journal of physical chemistry c _ , vol .",
    "118 , no .  3 , pp .",
    "72297234 , march 2014 .",
    "q.  ferreira , a.  bragana , o.  n.  o. oliveira , n.  m. moura , m.  faustino , l.  alccer , and j.  morgado , `` dynamics of porphyrin adsorption on highly oriented pyrolytic graphite monitored by scanning tunnelling microscopy at the liquid / solid interface , '' _ applied surface science _",
    ". 220225 , may 2013 .",
    "i.  horcas , r.  fernndez , j.  m. gmez - rodrguez , j.  colchero , j.  gmez - herrero , and a.  m. baro , `` wsxm : a software for scanning probe microscopy and a tool for nanotechnology , '' _ review of scientific instruments _ , vol .",
    "78 , no .  1 ,",
    "[ online ] .",
    "available : http://scitation.aip.org/content/aip/journal/rsi/78/1/10.1063/1.2432410                      y.  c. pati , r.  rezaiifar , and p.  s. krishnaprasad , `` orthogonal matching pursuit : recursive function approximation with applications to wavelet decomposition , '' in _ in conference record of the twenty - seventh asilomar conference on signals , systems and computers _ , 1993 ,",
    "a.  rakotomamonjy , `` applying alternating direction method of multipliers for constrained dictionary learning , '' _ neurocomputing _ , vol .",
    "106 , no .  0 , pp . 126  136 , 2013 .",
    "[ online ] .",
    "available : http://www.sciencedirect.com/science/article/pii/s0925231212008612"
  ],
  "abstract_text": [
    "<S> in this article , we present a denoising algorithm to improve the interpretation and quality of scanning tunneling microscopy ( stm ) images . given the high level of self - similarity of stm images , we propose a denoising algorithm by reformulating the true estimation problem as a sparse regression , often termed sparse coding . </S>",
    "<S> we introduce modifications to the algorithm to cope with the existence of artifacts , mainly dropouts , which appear in a structured way as consecutive line segments on the scanning direction . </S>",
    "<S> the resulting algorithm treats the artifacts as missing data , and the estimated values outperform those algorithms that substitute the outliers by a local filtering . </S>",
    "<S> we provide code implementations for both matlab and gwyddion  @xcite . </S>"
  ]
}