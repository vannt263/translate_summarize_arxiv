{
  "article_text": [
    "smoothing of two - dimensional event distributions is a procedure routinely used in many fields of data analysis . in practice",
    ", smoothing means the convolution @xmath0 of the measured data @xmath1 with a kernel function @xmath2 ( often also called ` filter ' or ` window function ' ) .",
    "although the raw data may be an image in the term s common meaning [ i.e. the data set can be represented as a function @xmath3 where @xmath4 is some intensity , and @xmath5 and @xmath6 are spatial coordinates ] , the two coordinates @xmath5 and @xmath6 can , in principle , describe any two - dimensional parameter space .",
    "the coordinates @xmath5 and @xmath6 are assumed to take only discrete values , i.e.  the events are binned into @xmath7 intervals .",
    "the only requirement on @xmath4 that we shall assume in all of the following is that @xmath4 is the result of a counting process in some detector , such that @xmath8 .",
    "an image , as defined above , is a two - dimensional histogram and is thus often a coarse representation of the underlying probability density distribution ( e.g.  merrit & tremblay 1994 , vio et al .",
    ". however , for certain experiments , an unbinned event distribution may not even exist  for instance if the @xmath5 and @xmath6 values correspond to discrete pha ( spectral energy ) channels . also ,",
    "_ some _ binning can be desirable , for instance , in cases where the dynamic range of the data under consideration is large .",
    "if the bin size is sufficiently small , the unavoidable loss of spatial resolution introduced by binning the raw event distribution may be a small price to be paid for a data array of manageable size .    smoothing of high - resolution data is of interest whenever the signal ( defined as the number of counts per pixel above the expected background ) in the region of interest in @xmath9 space is low , i.e.  is less than or of the order of 10 , after the raw event distribution has been sorted into intervals whose size matches approximately or exceeds the instrumental resolution .",
    "it is crucial in this context that the observed count statistics are not taken at face value but are corrected for background , which may be internal , i.e.  originating from the detector ( more general : the instrumental setup ) , or external .",
    "if this correction is not applied , the observed intensity ( counts ) distribution @xmath3 may be high across the region of interest , suggesting good count statistics , even if the signal above the background that we are interested in is actually low and poorly sampled .",
    "the statistics of the observed counts alone can thus be a poor indicator of the need for image smoothing .",
    "rebinning the data set into larger , and thus fewer , intervals improves the count statistics per pixel and reduces the need for smoothing .",
    "this is also the basic idea behind smoothing with a kernel of the form @xmath10 ( circular ` top - hat ' or ` box - car ' filter of radial size @xmath11 ) , the only difference being that smoothing occurs semi - continuously ( the step size being given by the bin size of the original data ) whereas rebinning requires an additional phase information [ the offset of the boundaries of the first bin with respect to some point of reference such as the origin of the @xmath7 coordinate system ] .",
    "however , when starting from an image binned at about the instrumental resolution , both rebinning and conventional smoothing share a well known drawback , namely that any improvement in the count statistics occurs at the expense of spatial resolution .",
    "although conventional smoothing algorithms usually employ more sophisticated functional forms for the kernel than the above ` top - hat ' filter ( the most popular probably being a gaussian ) , the problem remains that a kernel of fixed size is ill - suited for images that feature real structure on various scales , some of which may be much smaller or much larger than the kernel size .",
    "in such a situation , small - scale features tend to get over - smoothed while large - scale structure remains under - smoothed .",
    "_ adaptive - kernel smoothing _ ( aks ) is the generic term for an approach developed to overcome this intrinsic limitation by allowing the kernel to vary over the image and adopt a position - dependent ` natural ' size .",
    "aks is closely related to the problem of finding the optimal adaptive kernel estimator of the probability density distribution underlying a measured , unbinned event distribution .",
    "the advantages of adaptive kernel estimators for the analysis of discrete , and in particular one - dimensional , astronomical data have been discussed by various authors ( e.g.  thompson 1990 ; pisani 1993 , 1996 ; merritt and tremblay 1994 ; vio et al .",
    "an overview of adaptive filtering techniques in two dimensions is given by lorenz et al .",
    "( 1993 ) .",
    "a common feature of all non - parametric adaptive kernel algorithms is that the ` natural ' smoothing scale for any given position is determined from the number of counts accumulated in its immediate environment . following the aforementioned principle ,",
    "smoothing occurs over a large scale where few counts have been recorded , and over a small scale where count statistics are good .",
    "aks algorithms differ , however , in the prescription that defines how the amplitude of the local signal is to be translated into a smoothing scale .",
    "a criterion widely used for discrete data is that of silverman ( 1986 ) .",
    "it determines the size , @xmath11 , of the local kernels relative to that of some global ( i.e.  non - adaptive , fixed ) kernel ( @xmath12 ) by introducing a scaling factor which is the inverse square root of the ratio of the globally smoothed data to their logarithmic mean . for images , and using the same notation as before , this means @xmath13 where @xmath14 , and @xmath15 represents the convolution of the measured data with a kernel of fixed size @xmath12 . however , whether or not this approach yields satisfactory results depends strongly on the choice of the global smoothing scale @xmath12 ( vio et al .",
    "1994 ) . in the context of discrete data sets , pisani ( 1993 ) suggested a least - squares cross - validation procedure to determine an optimal global kernel size in an iterative loop .",
    "however , for binned data covering a large dynamical range ( see section  [ example ] for an example ) , the dependence of the result on the size of the global kernel becomes very sensitive indeed , and the iteration becomes very time - consuming .",
    "also the dependence on the somewhat arbitrary scaling law ( eq .  [ sman ] ) remains .",
    "other adaptive filtering techniques discussed recently in the literature include the hfilter algorithm for square images ( richter et al .",
    "1991 , see also lorenz et al .",
    "1993 ) and the akis algorithm of huang & sarazin ( 1996 ) .",
    "closely related are image decomposition techniques including wavelet - based algorithms ( starck & pierre 1998 , and references therein ) and adaptive binning ( e.g. , sanders & fabian 2001 , cappellari & copin 2003 , diehl & statler 2005 ) .    in the following , we present asmooth , an aks algorithm for images , i.e.  binned , two - dimensional datasets of any size , which determines the local smoothing scale from the requirement that the _ above the background - corrected _ signal - ro - noise ratio ( s.n.r . ) of any signal enclosed by the kernel must exceed a certain , preset value .",
    "the algorithm is similar to akis ( huang & sarazin 1996 ) in that it employs a signal - to - noise ratio ( s.n.r . )",
    "criterion to determine the smoothing scale .",
    "however , other than akis , asmooth does not require any initial fixed - kernel smoothing but determines the size of the adaptive kernel directly and unambiguously from the unsmoothed input data .",
    "asmooth also goes beyond existing aks algorithms in that its s.n.r .",
    "criterion takes the background ( instrumental or other ) of the raw image into account .",
    "this leads to significantly improved noise suppression in the case of large - scale features embedded in high background .",
    "our approach yields smoothed images which feature a near - constant ( or , alternatively , minimal ) signal - to - noise ratio above the background in all pixels containing a sufficient number of counts .",
    "in contrast to most other algorithms which require threshold values to be set ( e.g. , for the h coefficients in the case of the hfilter technique ) , asmooth is intrinsically non - parametric .",
    "the only external parameters that need to be specified are the minimal and , optionally , maximal signal - to - noise ratios ( above the background ) required under the kernel .",
    "the simplicity of the determination of the local smoothing scale from the counts under the kernel and an estimate of the local background greatly facilitates the translation of the smoothing prescription into a simple and robust computer algorithm , and also allows a straightforward interpretation of the resulting smoothed image .",
    "asmooth adjusts the smoothing scale ( i.e.  the size of the smoothing kernel ) such that , at every position in the image , the resulting smoothed data values share the same signal - to - noise ratio with respect to the background ; one may call this the ` uniform significance ' approach .",
    "the only external parameter required by asmooth is the desired minimal s.n.r .",
    ", @xmath16 .    in order to ensure that statistically significant structure is not over - smoothed to an s.n.r .",
    "level much higher than @xmath16 , an s.n.r .",
    "range can be specified as a pair of @xmath16 , @xmath17 values .",
    "note , however , that the maximal s.n.r .",
    "criterion is a soft one and , also , is applied only at scales larger than the instrumental resolution ( which is assumed to be similar to , or larger than , the pixel scale ) ; under no circumstances will asmooth blur significant pointlike features ( pixels whose s.n.r .  in the unsmoothed image exceeds @xmath16 ) in order to bring their s.n.r .  value down below the @xmath17 threshold .",
    "the background - corrected s.n.r .  of any features",
    "is computed according to one of two definitions .",
    "the weaker requirement is given by the definition of the `` significance of detection '' above the background , @xmath18 where @xmath19 and @xmath20 are the number of counts under the smoothing kernel and the background kernel , respectively , and @xmath21 is the @xmath22 uncertainty of the background counts . alternatively , and by default",
    ", the more stringent definition of the `` significance of the source strength measurement '' can be used , @xmath23 with @xmath24 being the @xmath22 uncertainty of the source counts accumulated under the smoothing kernel .",
    "either of these definitions assume gaussian statistics by implying that the @xmath25 error of a measurement is equal to @xmath26 times the @xmath22 error .",
    "in addition to the desired s.n.r .  limits @xmath27 , estimates of the background @xmath28 and the associated background error @xmath29 are optional additional parameter . to allow background variations across the image to be taken into account ,",
    "@xmath28 and @xmath29 can be supplied as images of the same dimensions as the raw image ; in the case of a flat background @xmath28 and @xmath30 reduce to global estimates of the background and background error per pixel , i.e. , single numbers .",
    "note that , more often than not , @xmath31 as the background estimate will originate from model predictions rather than being the result of another counting experiment . if no background information is supplied , asmooth determines a local background from an annular region around the adaptive smoothing kernel , extending from 3 - 4@xmath11 for a gaussian kernel , and from 1 - 4/3@xmath11 for a top - hat kernel .",
    "internally , the threshold s.n.r .",
    "values @xmath16 , @xmath17 are translated into a minimal and a maximal integral number of counts , @xmath32 , @xmath33 , to be covered by the kernel . more precisely , the criterion is that @xmath34 where @xmath35 is the characteristic , position - dependent scale of the respective kernel .",
    "@xmath36 in eq .",
    "[ mc_crit ] are determined from the definition of the minimal and maximal s.n.r .",
    "value @xmath37 , @xmath38 where , in analogy to the definition of @xmath36 ( cf . eqs",
    ".  [ convol],[mc_crit ] ) , @xmath39 and @xmath40 are the integral number of background counts under the respective kernel and the associated error . from eq .",
    "[ taudef ] follows @xmath41 for an adaptive circular top - hat kernel of size @xmath35 ( cf .",
    "eq .  [ tophat ] ) , eq .",
    "[ mc_crit ] translates into @xmath42 , and the interpretation is straightforward : at least @xmath32 , but no more than @xmath43 , counts are required to lie within the area @xmath44 that the smoothing occurs over . in the case of a uniform background , the value of @xmath45 in eq .  [ n_min ] is simply given by @xmath46 where @xmath47 is the global background level per pixel in the input image .    for",
    "any given pair of @xmath48 values , a gaussian kernel @xmath49 will yield considerably larger effective smoothing scales than a top - hat , as , in two dimensions , more than 60 per cent of the integral weight fall outside a @xmath50 radius , whereas , in the case of a circular top - hat kernel , all of @xmath32 needs to be accumulated within a @xmath51 radius .",
    "( note that , according to eq .",
    "[ gaussian ] , it is the weights _ per unit area _ that follow a gaussian distribution .",
    "the weights per radial annulus _ do not _ , which is why , for the kernel defined in eq .",
    "[ gaussian ] , the fraction of the integral weight that falls outside the @xmath51 radius is much larger than the 32 per cent found for a one - dimensional gaussian . )",
    "which kernel to use is up to the user : asmooth offers a choice of gaussian ( default ) and circular top - hat .",
    "the algorithm is coded such that the adaptively smoothed image is accumulated in discrete steps as the smoothing scale increases gradually , i.e. @xmath52 where @xmath53 starts from an initial value @xmath54 which is matched to the intrinsic resolution of the raw image ( i.e. , the pixel size ) , and @xmath55 is given by @xmath56 the adaptively smoothed image is thus accumulated in a `` top - down '' fashion with respect to the observed intensities as asmooth starts at small kernel sizes to smooth the vicinity of the brightest pixels , and then increases the kernel size until , eventually , only background pixels contribute .",
    "note that condition [ maskcrit ] ensures that pixels found to contain sufficient signal at a scale @xmath53 will not contribute to the image layers @xmath57 subsequently produced with smoothing scales @xmath58 .",
    "consequently , each feature is smoothed at the smallest scale at which it reaches the required background - corrected s.n.r .",
    "( see eq .",
    "[ mc_crit ] ) , and low - s.n.r .",
    "regions are smoothed at an appropriately large scale even in the immediate vicinity of image areas with very high s.n.r .    in order to take full advantage of the resolution of the unbinned image , the size @xmath54 of the smallest kernel",
    "is chosen such that the area enclosed by @xmath59 is about one pixel .",
    "for the circular top - hat filter of eq .",
    "[ tophat ] this means @xmath60 ; for the gaussian kernel of eq .",
    "[ gaussian ] we have @xmath61 .",
    "subsequent values of @xmath62 are determined from the requirement that eq .",
    "[ mc_crit ] be true . if a near - constant s.n.r . value is aimed at with high accuracy , i.e. , if a @xmath17 value very close to @xmath16 is chosen , the smoothing scale @xmath53 will grow in very small increments , and the smoothing will proceed only slowly . in all our applications we found values of @xmath63 to yield a good compromise between cpu time considerations and a sufficiently constant signal - to - noise ratio of the smoothed image .",
    "if no value for the optional input parameter @xmath16 is supplied by the user , the code therefore assumes a default value of @xmath64 which meets the above requirement for all reasonable values of @xmath16 .    while the intrinsic resolution of the raw image ( i.e. the pixel size ) determines the smallest kernel size @xmath54 , the size of the image as a whole represents an upper limit to the size of the kernel .",
    "although the convolution can be carried out until the numerical array representing the kernel is as large as the image itself , this process becomes very cpu time intensive as @xmath53 increases .",
    "once the smoothing scale has exceeded that of the largest structure in the image , the criterion of eq .",
    "[ mc_crit ] can never be met as only background pixels contribute .",
    "since the only features left unsmoothed at this stage are insignificant background fluctuations , the algorithm then smoothes the remaining pixels with the largest possible kernel .",
    "unavoidably , the signal - to - noise ratio of these last background pixels to be smoothed does not meet the condition of eq .",
    "[ mc_crit ] .",
    "note that in the case of the background being determined locally from the data themselves ( the default ) , it is the size of the background kernel ( an annulus around the smoothing kernel ) that reaches the limit first .",
    "hence , for a gaussian , the largest smoothing scale ( 1@xmath11 size of the kernel ) is 1/8 of the image size , for a top - hat it is 3/8 of the image size .",
    "since the algorithm uses fast - fourier transformation ( fft ) to compute the many convolutions required , the overall performance of the code is significantly improved if the image size in pixels is an integer power of two . the smoothed image obtained from the above procedure strictly conserves total counts ( within the limitations set by the computational accuracy ) and provides a fair representation of the original data at all positions .",
    "we first demonstrate the performance of our algorithm by applying it to an image of x - ray emission from a massive cluster of galaxies taken with the acis - s detector on board the chandra x - ray observatory .",
    "then we use simulated data to test how faithfully asmooth reproduces the true count distribution of the input image .",
    "because of the large range of scales at which features are detected in the selected chandra observation , this x - ray image is ideally suited for a demonstration of the advantages of aks . if photon noise is to be suppressed efficiently , the very extended emission from the gaseous intracluster medium needs to be smoothed at a rather large scale . at the same time , a small smoothing scale , or no smoothing at all , is required in high - s.n.r .",
    "regions in order to retain the spatial resolution in the vicinity of bright point - like sources ( stars , qsos , agn ) superimposed on the diffuse cluster emission .",
    "fixed - kernel smoothing can meet , at most , one of these requirements at a time .",
    "our choice of data set has the additional advantage that the selected image was taken with an x - ray detector that is also very sensitive to charged particles which makes the image particularly well suited to emphasize the importance of a proper treatment of the background .",
    "+   +   +    fig .",
    "[ ms1054 ] ( top left panel ) shows the raw counts detected with acis - s in the 0.5 to 7 kev energy band in an 89 ks observation of the galaxy cluster ms1054.4@xmath650321 .",
    "the diffuse emission originates from an electron - ion plasma trapped in the gravitational potential well of the cluster and heated to temperatures of typically @xmath66 k ( corresponding to @xmath67 kev ) .",
    "a detailed analysis of this observation is given by jeltema et al .",
    "the image shown here ( @xmath68 pixel@xmath69 ) covers a subsection of the detector spanning a @xmath70 arcmin@xmath69 region ; the pixel size of 0.492 arcsec corresponds roughly to one on - axis resolution element of the telescope - detector configuration .",
    "note the high background throughout the image , caused by high - energy cosmic rays .",
    "[ ms1054 ] summarizes asmooth results obtained with a gaussian kernel , and for s.n.r .",
    "target values of @xmath71 and @xmath72 , in a three - by - three array of plots below the image of the raw data .",
    "the left - most column of fig .  [ ms1054 ] shows the adaptively smoothed images for the three different @xmath16 values .",
    "asmooth fully preserves the high information content of the raw data in the high - s.n.r .",
    "regions corresponding to bright , small - scale features , while at the same time heavily smoothing the low - s.n.r .",
    "regions of the image where the signal approaches the background value .",
    "note , however , that for small values of @xmath16 ( top row ) the goodness of the local estimation of the signal above the background is relatively low and noise is not removed efficiently on all scales .",
    "figure  [ plotlog ] illustrates the gradual assembly of the adaptively smoothed image by showing the change in various asmooth parameters as a function of smoothing step .    at the highest pixel intensities above the s.n.r .",
    "threshold , asmooth occasionally returns smoothed count values that _ exceed _ the counts in the unsmoothed . since the final image is accumulated from the partial images resulting from the successive convolution with the whole set of differently sized kernels ( cf .",
    ".  [ aks_acc ] ) , the total smoothed intensity can become larger than the actually observed counts at pixel positions where @xmath73 .",
    "this artifact is caused by the limited resolution of the images and can be noticeable when a large bin size is chosen for the original data .",
    "the integral number of counts in the image is always conserved .",
    "= 0.5      as illustrated in fig .",
    "[ plotlog ] asmooth applies a wide range of smoothing scales to the input data as the algorithm attempts to fulfill the requirement given by eq .",
    "[ mc_crit ] throughout the image .",
    "in addition to the adaptively smoothed image , asmooth also returns , in an idl data structure , maps of the background - corrected s.n.r .  of the pixel values in the smoothed image and the kernel size used in the smoothing process , respectively ,    the second and third columns of the three - py - three panel in fig .",
    "[ ms1054 ] show both of these maps for the asmooth images shown in the first , left - most column of plots .",
    "the maps of asmooth kernel sizes as well as fig  [ plotlog ] demonstrate how very small kernel sizes of less than or about one pixel ( @xmath22 radius ) are assigned to very few bright pixels ; accordingly , these pixels remain essentially unsmoothed . for @xmath74 ( middle row )",
    ", for instance , some 27 per cent of the image pixels are found to satisfy the criterion of eq .",
    "[ mc_crit ] at smoothing scales between one and 62 pixels ( radius ) , while the majority of the remaining pixels ( more than 72 per cent ) do not contain enough signal to reach the required s.n.r .  even at the largest permissible smoothing scale .",
    "the majority of the image is smoothed at the largest possible scale of 63.8 pixels at which the dimensions of the background kernel array ( a 1@xmath11 wide annulus surrounding the two - dimensional gaussian smoothing kernel computed out to @xmath75 radius ) equals that of the image itself .",
    "the s.n.r .",
    "maps ( fig .",
    "[ ms1054 ] , right - most column ) , finally , give evidence of the near - constant s.n.r .  of all regions smoothed with kernels other than the largest one .",
    "= 0.53    the qualitative demonstration of the performance of asmooth shown in fig .",
    "[ ms1054 ] can be made more quantitative by comparing it with the results obtained with fixed - kernel smoothing . to this end",
    "we examine the properties of the residual images obtained by subtracting the respective smoothed image from the observed raw image .",
    "following pia & puetter ( 1992 ) who introduced this criterion in the context of bayesian image reconstruction , we state that , for an ideal smoothing algorithm , this residual image should contain only uncorrelated poissonian noise around a zero mean .",
    "a _ global _",
    "mean of zero is guaranteed  within the numerical accuracy of the convolution code  by the requirement that any smoothing algorithm conserve counts .",
    "the requirements that the mean also be zero _ locally _ , that the residual signal have poissonian variance , and that the residual signal be uncorrelated across the image are much harder to meet . in the following",
    "we shall examine how well adaptive and fixed kernel smoothing fulfill these requirements .",
    "_ is the residual signal consistent with poissonian noise shifted to zero mean as expected if shot noise dominates ? _",
    "if so , the square of the noise ( given by the residual signal ) , @xmath76 , should equal the mean ( given by the smoothed signal @xmath77 ) .",
    "since the smoothed image contains a wide range of mean values , we can test for this condition only within bins of similar mean .",
    "figure  [ asm_csm2 ] shows the ratio @xmath78 as a function of @xmath77 for both asmooth and a number of fixed kernels of various sizes .",
    "note how the residual signal obtained with asmooth exhibits a near - poissonian variance over a larger range of mean values than does the residual produced by smoothing with a fixed kernel of essentially any size . only the smallest fixed kernel size tested here , @xmath79 pixels , yields comparable results  a kernel of such small size",
    ", however , also provides essentially no smoothing .",
    "= 0.53    _ is the signal in the residual image spatially uncorrelated ? _",
    "figure  [ asm_csm1 ] shows the autocorrelation function of the residual images obtained with asmooth and fixed kernels of various sizes . here",
    "we use the standard definition of the autocorrelation @xmath80 as a function of radial lag @xmath81 : @xmath82 where the angular brackets signify averaging over the position @xmath83 within the image ( e.g.  peebles 1980 ) . in the normalized representation of @xmath84 shown in fig .",
    "[ asm_csm1 ] an ideal smoothing algorithm would produce zero signal at all lags except for a singular value of unity at @xmath85 .",
    "asmooth comes close to this ideal : the signal in the residual images generated with asmooth is essentially uncorrelated at all scales except for a weak ( @xmath86 ) positive signal at scales smaller than about the maximum adaptive kernel size .",
    "note the very different result when fixed gaussian kernels of size @xmath12 are used : strong spatial correlations are observed in the residual images at all scales smaller than about the kernel size .",
    "only for very small kernel sizes does non - adaptive smoothing come close to meeting the requirement that any residual signal after smoothing be spatially uncorrelated . however , such small kernel sizes perform very poorly in the presence of significant structure on a large range of scales ( cf .",
    "[ ms1054 ] , center column ) .",
    "the example shown in the previous section has the advantage of using real data but , for this very reason , does not allow the user to assess quantitatively how the asmoothed image compares to the true counts distribution underlying the noisy input image .",
    "we therefore present in this section results obtained for a simulated data set that contains multiple extended and point - like features , as well as a constant background component .",
    "figure  [ simplot ] summarizes the characteristics of the model used for our simulation ( top row ) .",
    "the same figure shows , in the bottom row , results obtained with asmooth for @xmath87 , and with the adaptive _ binning _ algorithm wvt ( diehl & statler 2005 ) for a target s.n.r .",
    "value of 5 .",
    "note how the requirement of a minimal s.n.r .",
    "_ above the local background _",
    ".  4 and 5 ) causes asmooth to reduce noise much more aggressively than wvt in spite of a nominally lower s.n.r .  target value . as demonstrated by the error distribution depicted in the final panel of fig .",
    "[ simplot ] the asmooth residual image exhibits a near gaussian error distribution around zero mean , in addition to featuring poissonian variance and being spatially uncorrelated ( section  [ ms1054 ] ) .",
    "asmoothed images can thus be considered to be fair representations of the ` true ' input image .",
    "we describe asmooth , an efficient algorithm for adaptive kernel smoothing of two - dimensional image data .",
    "asmooth determines the local size of the kernel from the requirement that , at each position within the image , the signal - to - noise ratio of the counts under the kernel , and above the background , must reach ( but not exceed greatly ) a certain preset minimum .",
    "qualitatively , this could be called the ` uniform significance approach ' . as a consequence of this criterion",
    ", noise is heavily suppressed and real structure is enhanced without loss of spatial resolution . due to the choice of boundary conditions",
    ", the algorithm preserves the total number of counts in the raw data .",
    "the asmoothed image is a fair representation of the input data in the sense that the residual image is consistent with pure noise , i.e. , it the residual possesses poissonian variance and is spatially uncorrelated . as demonstrated by the results obtained for simulated input , the adaptively smoothed images created by asmooth are fair representations of the true counts distribution underlying the noisy input data .    since the background is accounted for in the assessment of any structure s s.n.r .",
    ", a feature that distinguishes asmooth from most other adaptive smoothing or adaptive binning algorithms , the interpretation of the adaptively smoothed image is straightforward : all features in the asmoothed image are equally significant at the scale of the kernel used in the smoothing .",
    "a map of these smoothing scales is returned by asmooth together with the smoothed image .",
    "note that these are the _ smallest _ scales at which real features reach the selected s.n.r .",
    "consequently , background regions never meet the s.n.r .",
    "criterion and are smoothed at the largest possible scale for which the kernel size equals the size of the image .",
    "such regions of insufficient signal are easily flagged using an s.n.r .",
    "map which is also provided by our algorithm .",
    "we emphasize that our definition of `` signal '' as meaning `` signal _ above the ( local ) background _ ''",
    "was chosen because many , if not most , real - life appplications do not provide the user with a priori knowledge of the intensity of the background or any spatial background variations .",
    "also , superpositions of features ( such as the point sources on top of diffuse emission in our chandra acis - s example ) require a _ local _ background estimate if the intrinsic signal of features on very different scales is to be assessed reliably .",
    "the approach taken by asmooth is thus intrinsically very different from the one implemented in , for instance , the adaptive binning algorithm wvt ( diehl & statler 2005 ) and the difference in the resulting output is accordingly dramatic ( see section  [ simsec ] ) .",
    "asmooth is being used extensively in the analysis of astronomical x - ray imaging data gathered in a wide range of missions from rosat to xmm - newton , and has become the analysis tool of choice for the display of high - resolution images obtained with the chandra x - ray observatory .",
    "recent examples illustrating asmooth s performance can be found in ebeling , mendes de oliveira & white ( 1995 ) , brandt , halpern & iwasawa ( 1996 ) , hamana et al .",
    "( 1997 ) , ebeling et al .",
    "( 2000 ) , fabbiano , zezas & murray ( 2001 ) , krishnamurthi et al .",
    "( 2001 ) , karovska et al .",
    "( 2002 ) , bauer et al .",
    "( 2002 ) , gil - merino & schindler ( 2003 ) , heike et al .",
    "( 2003 ) , rasmussen , stevens & ponman ( 2004 ) , clarke , blanton & sarazin ( 2004 ) , ebeling , barrett & donovan ( 2004 ) , or pratt & arnaud ( 2005 ) , as well as in many chandra press releases ( ) .    under development is an improved version of the algorithm which accounts for poisson statistics using the analytic approximations of ebeling ( 2003 ) to allow proper treatment of significant negative features , such as absorbed regions , detector chip gaps , or instrument elements ( e.g. , the window support structure of the rosat pspc ) obscuring part of the image .    asmooth is written in the idl programming language .",
    "the source code is available on request from ebeling@ifa.hawaii.edu .",
    "a @xmath88 version of an early version of the code , called csmooth , is part of ciao , the official suite of data analysis tools for the chandra x - ray observatory , and is not identical to the algorithm described here .",
    "we thank all asmooth users in the community who took the time to provide comments and criticism that have resulted in a dramatic improvement of the algorithm and its implementation since its original inception in 1995 .",
    "discussions with barry labonte about the statistical properties of residual shot noise .",
    "thanks also to our referee , herv bourdin , for constructive criticism and many useful suggestions that helped to improve this paper significantly .",
    "he gratefully acknowledges partial financial support from many sources over the years during which asmooth was developed and improved , among them a european union eara fellowship , sao contract sv4 - 64008 , as well as nasa grants nag 5 - 8253 and nag 5 - 9238 .",
    "daw acknowledges support from pparc .",
    "9 bauer f.e .",
    "2002 , aj , 123 , 1163 brandt w.n .",
    ", halpern j.p .  & iwasawa k. 1996 , mnras , 281 , 687 ebeling h. , mendes de oliveira c.  & white d.a .",
    "1995 , mnras , 277 , 1006 cappellari m.  & copin y. 2003 , mnras , 342 , 345 clarke t.e .",
    ", blanton e.l .  &",
    "sarazin c.l .",
    "2004 , 616 , 178 diehl s.  & statler t.s .",
    "2005 , mnras , submitted ebeling h.  et al .",
    "2000 , apj , 534 , 133 ebeling h.  2003 , mnras , 340 , 1269 ebeling h. , barrett e.  & donovan , d. 2004 , apj , 609 , l49 fabbiano g. , zezas a.  & murray s.s .",
    "2001 , apj , 554 , 1035 gil - merino r.  & schindler s. 2003 , a&a , 408 , 51 hamana t. , hattori m. , ebeling h. , henry j.p .",
    ", futamase t. , shioya y. 1997 , apj , 484 , 574 heike k. , awaki h. , misao y. , hayashida k. , weaver k.a .",
    "2003 apj , 591 , 99l huang z.  & sarazin c. 1996 , apj , 461 , 622 jeltema t.e .",
    ", canizares c.r . ,",
    "bautz m.w . ,",
    "malm m.r . , donahue m. , garmire g.p . 2001 , apj , 562 , 124 karovska m. , fabbiano g. , nicastro f. , elvis m. , kraft r.p .",
    ", murray s.s .",
    "2002 , apj , 2002 , 577 , 114 krishnamurthi a. , reynolds c.s .",
    ", linsky j.l . , martin e. , gagn m. 2001 , aj , 121 , 337 lorenz h. , richter g.m . , capaccioli m. , longo g. 1993 , a&a , 277 , 321 merritt d.  & tremblay b. 1994 , aj , 108 , 514 peebles p.j.e .",
    "1980 , _ the large - scale structure of the universe _ , princeton , princeton university press pia r.k .  & puetter r.c .",
    "1992 , pasp , 104 , 1096 pisani a. 1993 , mnras , 265 , 706 pisani a. 1996 , mnras , 278 , 697 pratt g.w .",
    "& arnaud m. 2005 , a&a , 429 , 791 rasmussen j. , stevens i.r .  &",
    "ponman t.j .",
    "2004 , mnras , 354 , 259 richter g.m .",
    ", bohm p. , lorenz h. , priebe a. 1991 , astron .",
    "nachr . , 312 , 346 sanders j.s .  & fabian a.c .",
    "2001 , mnras , 325 , 178 silverman b.w .",
    "1986 , density estimation for statistics and data analysis , chapman & hall , london starck j .- l .  &",
    "pierre m. 1998 , a&as , 128 , 397 thompson a.m. 1990 , a&a , 240 , 209 vio r. , fasano , g. , lazzarin m. , lessi , o. 1994 , a&a , 289 , 640"
  ],
  "abstract_text": [
    "<S> an efficient algorithm for adaptive kernel smoothing ( aks ) of two - dimensional imaging data has been developed and implemented using the interactive data language ( idl ) . </S>",
    "<S> the functional form of the kernel can be varied ( top - hat , gaussian etc . ) to allow different weighting of the event counts registered within the smoothing region . </S>",
    "<S> for each individual pixel the algorithm increases the smoothing scale until the signal - to - noise ratio ( s.n.r . ) within the kernel reaches a preset value . </S>",
    "<S> thus , noise is suppressed very efficiently , while at the same time real structure , i.e.  signal that is locally significant at the selected s.n.r </S>",
    "<S> .  level , is preserved on all scales . </S>",
    "<S> in particular , extended features in noise - dominated regions are visually enhanced . </S>",
    "<S> the asmooth algorithm differs from other aks routines in that it allows a quantitative assessment of the goodness of the local signal estimation by producing adaptively smoothed images in which all pixel values share the same signal - to - noise ratio _ above the background_.    we apply asmooth to both real observational data ( an x - ray image of clusters of galaxies obtained with the chandra x - ray observatory ) and to a simulated data set . </S>",
    "<S> we find the asmoothed images to be fair representations of the input data in the sense that the residuals are consistent with pure noise , i.e.  they possess poissonian variance and a near - gaussian distribution around a mean of zero , and are spatially uncorrelated .    </S>",
    "<S> techniques : image processing  methods : data analysis  methods : statistical </S>"
  ]
}