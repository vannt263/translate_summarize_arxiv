{
  "article_text": [
    "many quantum algorithms have been developed under the presumption that the hardware upon which they will run is effectively error - free : the error rate is so low the entire algorithm can be executed successfully without a single error .",
    "it is now known that such hardware can , in principle , be created using components that have far higher error rates .",
    "_ fault - tolerant _ quantum computing can be achieved by encoding qubits in non - abelian anyons in topological materials  @xcite or using the quantum error correction codes  @xcite . while the former is still in the early stages of its development , for the latter approach sub - threshold quantum operations",
    "have been demonstrated in ion - trap and superconducting systems  @xcite .",
    "however , quantum error correction involves a substantial multiplication of resources ; the number of physical qubits required may be orders of magnitude greater than the number error - free logical qubits seen by the algorithm .",
    "a recent study audited the cost of implementing shor s algorithm to solve a classically - infeasible task , and found that even with state - of - the - art techniques for magic state distillation the machine would need over six million of today s highest quality qubits  @xcite .",
    "the need for millions of qubits contrasts starkly with the fact that only fifty qubits are needed to achieve so - called ` quantum supremacy ' , i.e. to create a quantum processor that is so complex that conventional supercomputers  @xcite can not predict its behaviour .",
    "machines involving this many qubits , under good but imperfect control , are expected to emerge in the next few years .",
    "the challenge for researchers is to identify useful functions for such devices , in order to motivate further investment and continue the evolution toward the longer - term goal of fully fault tolerant systems .",
    "recently some hybrid quantum / classical algorithms have been developed which are promising for near future quantum applications  @xcite .",
    "a common feature of these algorithms is that the quantum computer is only in charge of carrying out a subroutine , acting as a ` coprocessor ' while the larger scale algorithm is governed by a classical computer .",
    "the task of the quantum computer is thus simplified and may be accomplished with relatively few quantum operations",
    ". a higher error rate per operation is therefore tolerable ; in a fault - tolerant machine this would imply a more modest resource overhead for the code , but it may even be possible to implement such quantum algorithms without quantum error correction .",
    "hybrid approaches are very relevant to quantum simulation , i.e. feynman s vision  @xcite of using a controlled quantum processor to model another quantum system .",
    "such a technology would be highly advantageous for the investigation of various large quantum systems , e.g.  simulating quantum chemistry systems  @xcite , or novel materials and other condensed - matter systems  @xcite .",
    "a powerful tool that has been exploited in several hybrid protocols is the variational method  @xcite .",
    "typically the state of the target system is to be found by writing a trial quantum state with a large but tractable number of real parameters , and then discovering the optimal value of these parameters .",
    "implicitly this requires the scientist to use their understanding of the target system ( the novel molecule , or material ) to select a set of parameters that , while large , is far smaller than the total number of parameters needed to specify an arbitrary quantum state .",
    "the latter is of course exponential in the number of particles composing the target system .    .",
    "variational parameters are determined by the classical computer according to the schrdinger equation .",
    "the quantum computer is used to implement a subroutine : inputs are parameters @xmath0 , and outputs are values of certain derivatives required by the main program in the classical computer .",
    "( b ) variational parameters are determined iteratively given their initial values .",
    "parameters at the time @xmath1 are sent to the quantum computer , which evaluates the quantities required by the classical computer .",
    "then , the classical computer can work out parameters at the time @xmath2 , where @xmath3 is a short time .",
    "note that the curves here represent the actual evolution of parameters in the example described in appendix  [ sec : model ] . ]    in this paper , we propose a hybrid quantum algorithm for simulating the dynamics of a quantum system .",
    "the conventional approach for simulating quantum dynamics employs trotterisation  @xcite , which usually requires many quantum operations therefore seems likely to necessitate the full machinery of fault - tolerant quantum computing  @xcite .",
    "our approach is based on the variational method and our hope is that it could be implemented using small - size quantum circuits , i.e.  quantum circuits with a small number of quantum operations and suffering significant noise compared with fault - tolerant quantum computers .",
    "a novel feature of our algorithm is that it compensates for errors through classical inference and without encoding : if the noise in the quantum computer mainly results in stochastic errors and the rate of errors can be amplified in a controllable way , then we find that errors can be approximately corrected .",
    "the condition that noise is stochastic can be met by engineering for many systems : if , for example , single qubit gates have relatively high fidelity  @xcite and their noise is statistical , then arbitrary two - qubit gate errors can be made statistical though a twirling - like technique which we presently discuss .",
    "moreover , the severity of the such errors can be deliberately _ increased _ artificially , allowing one to create curves which the classical algorithm can extrapolate to estimate the zero - error limit .",
    "we performed numerical emulations of the process on small systems , finding that this technique does indeed lead to robustness : the impact of physical errors on the simulator s performance far lower than in an ( optimised ) trotterisation protocol , and moreover this impact does not worsen with the duration of the simulation .",
    "the remainder of this paper is organised as the following . in sec .",
    "[ sec : review ] , we review the trotterisation algorithm and variational methods . in sec .  [",
    "sec : algorithm ] , our hybrid algorithm is introduced . in sec .",
    "[ sec : principle ] , the variational theory is discussed . in sec .",
    "[ sec : hybrid ] , the task for the quantum computer and the overall program are described in detail .",
    "errors in our algorithm are analysed in sec .",
    "[ sec : analysis ] . the method for reducing errors",
    "is given in sec .",
    "[ sec : noise ] , in which we also discuss how to convert non - stochastic errors into stochastic errors and how to tune the rate of errors .",
    "numerical results are presented in sec .",
    "[ sec : numerics ] .",
    "a summary is given in sec .",
    "[ sec : summary ] .",
    "the trotterisation approach to simulation , which we will use as a basis for comparison with our protocol , exploits the fact that time evolution under a general hamiltonian @xmath4 can be approximated according to the trotter - suzuki decomposition  @xcite @xmath5 here , each term @xmath6 corresponds to the evolution driven by the term @xmath7 for a short time @xmath8 , which can be realised by a quantum gate or a combination of quantum gates .",
    "usually , the short time is taken uniformly as @xmath9 , where @xmath10 is the time of the simulated evolution . when @xmath11 is larger , the approximation is better , and errors in the approximation scales with the simulated time and the number of quantum gates as @xmath12  @xcite .",
    "our approach is based on a variational approach .",
    "variational methods have numerous applications in the numerical study of many - body quantum systems , for examples , density functional theory  @xcite , the matrix product state method  @xcite , and simulating molecular dynamics using the variational principle  @xcite . in these methods ,",
    "typically a trial sate is used to approximate the true state of the system .",
    "the trial state must of course be specified by some tractable number of parameters .",
    "but since existing realisations are entirely classical , there is a stronger condition on the trial function : it must be possible to efficiently evaluate its fit to the true quantum state using only a classical algorithm .",
    "this requirement limits the application of variational methods .",
    "sometimes it may be impossible to evaluate a trial state that provides a good approximation to the true state in a classical computer .",
    "in such a case , a quantum computer could be helpful , because we may be able to complete tasks difficult for a classical computer using a quantum computer .",
    "an example is the unitary coupled cluster method  @xcite , in which the energy of the trial state can be evaluated using a quantum computer when it is hard for a classical computer .",
    "the protocol we describe here is another example .",
    "the purpose of our hybrid algorithm is to solve the schrdinger equation @xmath13 ( @xmath14 ) , assuming that the state @xmath15 can be approximated by a trial state @xmath16 , where @xmath0 are variational parameters . as shown in fig .",
    "[ fig : hybrid](a ) , the hybrid algorithm is implemented on both of a quantum computer and a classical computer .",
    "the task of the classical computer is to determine variational parameters according to the schrdinger equation , and this proceed requires as input certain derivatives associated with the state @xmath17 which the quantum computer provides .",
    "the hybrid algorithm works out variational parameters iteratively as shown in fig .",
    "[ fig : hybrid](b ) .",
    "parameters at the time @xmath1 ( @xmath0 ) are sent to the quantum computer , with which the quantum computer finds the values required by the classical computer .",
    "based on results from the quantum computer , the classical computer can determine parameters at the time @xmath2 ( @xmath18 ) , where @xmath3 is a short time .",
    "then , these new parameters are sent back to the quantum computer . in this way ,",
    "given parameters of the initial state ( @xmath19 ) , parameters at the time @xmath10 ( @xmath20 ) are systematically inferred by iterating the process carried out by two computers .",
    "the simulation is successful if the state @xmath21 is a good approximation of the state @xmath22 .    using the variational method ,",
    "the degrees of freedom provided by variational parameters allow us to use quantum circuits with a size much smaller than the circuit of the trotterisation algorithm to simulate the time evolution of a quantum system .",
    "note that this is an ` apples to oranges ' comparison because our algorithm only simulates the time evolution of a given initial state while the trotterisation algorithm simulates the time evolution of arbitrary initial states , i.e.  the time evolution operator .",
    "thus our algorithm aims at an easier problem than the trotterisation algorithm .",
    "tracking the evolution from a specific initial state is the main goal in many simulations , and other more general tasks can also be reexpressed this way .",
    "for example the determination of the fixed ground state of a quantum system can made via an adiabatic time evolution  @xcite , thus our algorithm is relevant to that task . in other hybrid algorithms for determining the ground state of a quantum system  @xcite , one may need to find the global minimum of the energy in the parameter space to maximise the fidelity . however , finding the global minimum in a high - dimensional parameter space is usually a non - trivial computing task . in our algorithm ,",
    "parameters are worked out iteratively , therefore the global minimisation is not required .",
    "we remark that trotterisation is used in some hybrid algorithms  @xcite . in principle",
    "our algorithm can be used to replace the trotterisation method in these instances , to further simplify the task of the quantum computer .",
    "the time - dependent variational principle corresponding to the schrdinger equation reads @xmath23 , where the lagrangian  @xcite @xmath24 assuming that the state @xmath17 is determined by a set of real parameters @xmath25 , i.e.  @xmath16 , the lagrangian can be rewritten as @xmath26 which is a function of @xmath27 and their time derivatives @xmath28 . according to @xmath29 , the euler - lagrange equation describing the evolution of parameters ( hence the state @xmath30 ) is @xmath31 where @xmath32 here , @xmath33 ,",
    "both @xmath34 and @xmath35 are real , and @xmath34 is antisymmetric .",
    "there are other variational principles for the quantum time evolution  @xcite .",
    "for example , mclachlan s variational principle reads @xmath36  @xcite , which leads to the same equation as eq .",
    "( [ eq : difeq ] ) but @xmath37 . here , the norm @xmath38 . in the following ,",
    "we will focus on the time - dependent variational principle , but the hybrid algorithm can be adapted to mclachlan s variational principle .",
    "recall that we can always express a state as @xmath39 , where @xmath40 and @xmath41 are real , and @xmath42 are orthonormal basis states .",
    "taking parameters @xmath43 , eq .  ( [ eq : difeq ] ) leads to the schrdinger equation ; but of course we will require a parameterisation such that the number of parameters remains tractable for the sizes of target system that we are interested in .",
    "thus our variational approach , in common with others , is relevant when the scientist can make an educated guess as to the general form of the quantum state  there can be a large number of free parameters @xmath44 , but typically far fewer than would be needed to specify an arbitrary state .",
    "we consider trial states that can be directly prepared in the quantum computer , i.e.  states can be expressed as @xmath45 , where @xmath46 is an initial state of the quantum computer , and @xmath47 is a sequence of quantum gates determined by parameters @xmath27 , i.e.   @xmath48 here , @xmath49 is a unitary operator describing a quantum gate , and the total number of gates ( i.e.  parameters ) is @xmath50 .",
    "if @xmath50 is smaller than the dimension of the hilbert space ( @xmath51 to be exact ) , @xmath30 only spans a subset of the hilbert space . in this restricted trial - state space ,",
    "( [ eq : difeq ] ) approximates the exact evolution if the exact state is close to the trial - state space .    in the following analysis",
    ", we describe each @xmath49 gate as dependent on only one parameter @xmath52 .",
    "however it is worth noting that the trial state can be generalised to the case where each gate @xmath49 depends on multiple parameters , including parameters that vary in a pre - defined way with time , and that both the trotter - suzuki decomposition  @xcite and the unitary coupled cluster ansatz  @xcite can be expressed in this form .",
    "indeed , one can even vary the number of gates @xmath50 depending on the simulated time , providing that we understand how to re - express the trial state using the new gates ( adding gates to the set is of course trivially possible ) .",
    "our point is that the set of gates with which we create our trial state , can itself evolve over the simulated time .",
    "we are interested in the case that evaluating coefficients @xmath34 and @xmath35 in eq .",
    "( [ eq : difeq ] ) is intractable in a classical computer , therefore these coefficients are obtained using the quantum computer .",
    "each parameter is determined in turn , by appropriately configuring a quantum circuit involving @xmath53 gates and a single measurement outcome ; this fixed circuit is run repeatedly until the expected measurement outcome is known to a given precision .",
    "note that this implies the overall protocol is trivially parallelisable over a large number of quantum processors with no quantum link between them .",
    "we express the hamiltonian in the form @xmath54 where @xmath55 are unitary operators . in many quantum systems ,",
    "the number of terms in this expression scales with the size of the system polynomially .",
    "similarly , we write @xmath56 where @xmath57 are also unitary operators . for many frequently used single - qubit gates and two - qubit gates ( @xmath58 ) , there is only one term in this expression , and @xmath57 is also a one - qubit or two - qubit gate . because any operator can be expressed using pauli operators , we can choose unitary operators @xmath55 and @xmath57 as ( single - qubit and multi - qubit ) pauli operators .    using the expression ( [ eq : drk ] ) , we rewrite the derivative of the state as @xmath59 where @xmath60 then , differential equation coefficients can be expressed as @xmath61 and @xmath62 where we have used the expression ( [ eq : ham ] ) .    in eqs .",
    "( [ eq : m ] )  and  ( [ eq : v ] ) , each term is in the from @xmath63 where the amplitude @xmath64 and phase @xmath65 are determined by either @xmath66 or @xmath67  @xcite , and @xmath68 is a unitary operator either @xmath69 or @xmath70 .",
    "such a term can be evaluated using the quantum circuit shown in fig .",
    "[ fig : circuit ] .",
    "this circuit needs an ancillary qubit initialised in the state @xmath71 and a register initialised in the state @xmath46 .",
    "the ancillary qubit is measured in the @xmath72 basis after a sequence of quantum gates on the register and two controlled gates , in which the ancillary qubit is the control qubit .",
    "the value of each term is given by @xmath73 , where @xmath74 is the final state of the quantum computer , and @xmath75 is the x - direction pauli operator of the ancillary qubit .",
    "the overall flow of the algorithm is as follows : firstly , we select initial parameters @xmath76 .",
    "secondly , we solve the differential equation  ( [ eq : difeq ] ) numerically using the classical computer , in which process the matrix @xmath34 and the vector @xmath35 in the equation are evaluated using the quantum coprocessor .",
    "the solution permits us to project our parameters forward by a small time increment , and repeat the second step .",
    "eventually we reach the parameters @xmath77 which allow us to prepare the final state in the quantum computer .",
    "there are many different numerical methods for solving a differential equation , and the choice of specific numerical method determines the details of the information exchange loop between quantum and classical processors . in the following ,",
    "we take the euler method as an example , but the algorithm can be adapted to other numerical methods , e.g.  runge - kutta methods  @xcite .",
    "time is discretised as @xmath78 , where @xmath79 is the initial time , and @xmath80 is the simulated evolution time .",
    "firstly , @xmath34 and @xmath35 corresponding to parameters @xmath81 are evaluated using the quantum computer .",
    "then , the following process is repeated .",
    "given @xmath34 and @xmath35 corresponding to the time @xmath82 , eq .",
    "( [ eq : difeq ] ) is solved numerically on the classical computer to obtain values of @xmath83 . as parameters",
    "@xmath84 have been obtained from previous calculations , one can approximately calculate parameters of the time @xmath85 using @xmath86 . repeating the process until @xmath87 , we can work out parameters @xmath77 of the final state .",
    ", respectively . @xmath88 denotes the exact time evolution during the time from @xmath89 to @xmath82 .",
    "gray circles denote trial wavefunctions , and each empty circle with a dashed edge is the wavefunction at the time @xmath90 given by the exact time evolution @xmath88 and taking the trial wavefunction at the time @xmath89 as the initial state .",
    "distances are marked by red double lines .",
    "@xmath91 and @xmath92 .",
    "the distance between @xmath93 and @xmath94 is not larger than the sum of all these red double lines in the main figure . ]",
    "there are four types of errors that can result in infidelity in the variational quantum simulation ; they are i ) errors due to limited generality of the trial wavefunction , which may be only able to describe the simulated system approximately ; ii ) errors in the numerical integration obtained by solving equation  ( [ eq : difeq ] ) , which is always approximate due to the finite discretisation of time ; iii ) shot noise in measuring equation coefficients @xmath34 and @xmath35 ; and iv ) errors due to noise in the quantum machine , e.g.  decoherence , quantum gate infidelity .",
    "a good trial wavefunction allows us to not only reduce trial - wavefunction errors but also minimise the difficulty of implementing the algorithm , e.g.  only use small - size quantum circuits . whether a good trial wavefunction can be found depends on the simulated system and our understanding of the physics in that system .",
    "however , a trial wavefunction that contains a polynomial number of parameters and is a high - fidelity approximation to the true wavefunction always exists",
    ". one can set the trial wavefunction as a wavefunction in the trotter - suzuki form , i.e.  take the sequence of gate operations @xmath47 in the form of eq .",
    "( [ eq : decomposition ] ) , and choose the evolution time of each term as a parameter ( @xmath95 )  @xcite . using the trotter - suzuki - form trial wavefunction , we know that the probability of trial - wavefunction errors decreases with the number of trotterisation slices @xmath11 as ` @xmath96 '  @xcite in the worst case .",
    "integration errors depend on the numerical method for solving the differential equation  ( [ eq : difeq ] ) .",
    "we take the euler method as an example . in the euler method ,",
    "the probability of error is proportional to the size of each step @xmath3  @xcite .",
    "therefore , by choosing a small step size , integration errors can be suppressed .",
    "shot noise and machine noise occur in the implementation of the algorithm while trial - wavefunction errors and integration errors are due to the imperfection of the algorithm itself .",
    "the effect of implementation errors in the integration process is that coefficients @xmath34 and @xmath35 evaluated using the quantum computer are inaccurate , i.e.  their values are different from their true values @xmath97 and @xmath98 given by eqs .",
    "( [ eq : m ] )  and  ( [ eq : v ] ) ( that is , the values given by a quantum computer without shot noise and machine noise ) . if coefficients @xmath34 and @xmath35 are inaccurate , time derivatives @xmath99 obtained from @xmath34 and @xmath35 [ see eq .",
    "( [ eq : difeq ] ) ] are different from their true values @xmath100 obtained from @xmath97 and @xmath98 . using @xmath101 , @xmath102 and @xmath103 to denote deviations from true values and using @xmath104 to denote the solution of eq .",
    "( [ eq : difeq ] ) , we have @xmath105 . when the matrix is invertible in the vicinity of @xmath97 , @xmath106 .",
    "to analyse errors in the hybrid algorithm , we use the trace distance @xmath107  @xcite as the measure of error severity .",
    "the degree of error in the overall process is given by @xmath108 .",
    "here , @xmath109 denotes the true wavefunction , @xmath110 denotes the trial wavefunction , and @xmath94 is the state prepared in the quantum computer according to the state @xmath111 .",
    "these two states @xmath94 and @xmath111 are different because of the machine noise .",
    "the triangle inequality holds for the trace distance , i.e.  @xmath112 .",
    "therefore , an upper bound of @xmath113 is given by ( see fig .  [",
    "fig : distance ] ) @xmath114 here , @xmath88 is the exact evolution during the time from @xmath89 to @xmath82 ( @xmath115 if the hamiltonian is time - independent ) , therefore @xmath116 . to obtain the upper bound ,",
    "we have used @xmath117 .    to distinguish algorithm errors and implementation errors",
    ", we use the inequality @xmath118 . here",
    ", the state @xmath119 is a trial state corresponding to parameters @xmath120 , i.e.  assuming that the quantum computer reports accurate values of @xmath34 and @xmath35 at the time @xmath89 .",
    "then , the upper bound can be rewritten as @xmath121 where @xmath122 here , @xmath123 corresponds to algorithm errors , and @xmath124 corresponds to implementation errors .",
    "algorithm errors in each time step can be expressed as @xmath125 where @xmath126 @xmath127 and @xmath128 here , we have used taylor expansions of @xmath129 and @xmath119 , i.e.  @xmath130 and @xmath131 , where @xmath132 .",
    "the matrix norm is induced by the vector norm , therefore @xmath133 .",
    "implementation errors in each time step are due to the difference between time derivatives obtained from the real quantum computer and their true values , i.e.  @xmath134 , which can be expressed as @xmath135 where @xmath136 is a positive semi - definite matrix and @xmath137 here , we have used the taylor expansion of @xmath138 , which is the same as @xmath119 but @xmath100 are replaced by @xmath99 .      using @xmath139 to denote the maximum value of the quantity @xmath140 for all @xmath82",
    ", we have @xmath141 the first term of @xmath123 and the second term of @xmath124 are due to imperfections in approximating the initial state using the trial wavefunction and preparing the final state in the quantum computer with machine noise , respectively .",
    "note that these two terms are not @xmath10 dependent ; for simulations over a substantial time @xmath10 we may expect them to make relatively small contributions . in the following , we analyse the other three terms one by one .",
    "the second term of @xmath123 is the accumulation of trial - wavefunction imperfections in each time step . using the circuit in fig .",
    "[ fig : circuit ] , every term in @xmath142 can be measured by a method analogous to that used for obtaining @xmath34 and @xmath35 .",
    "the accuracy is again limited by the shot noise and machine noise .",
    "therefore , algorithm errors due to the trial wavefunction can be continually estimated during the execution of the the hybrid quantum computation .",
    "the third term of @xmath123 is caused by the finite integration step size , which can be reduced by decreasing @xmath3 . in order to limit this term to be @xmath143",
    ", we need to choose a step size @xmath144 , i.e.  the number of time steps @xmath145 .",
    "when the trial wavefunction is a good approximation to the exact state , we can expect that @xmath146 , which implies @xmath147 in the subspace of the problem , and in this case @xmath148 .",
    "the first term of @xmath124 is due to the difference between @xmath99 and their true values @xmath100 .",
    "the difference @xmath149 .",
    "@xmath34 and @xmath35 are evaluated as required by the algorithm .",
    "similar to @xmath142 , each element of @xmath136 can also be measured using the circuit in fig .",
    "[ fig : circuit ] . therefore ,",
    "the susceptibility to shot noise and machine noise in the integration process can be estimated during the execution of the hybrid quantum computation .",
    "the algorithm is susceptible to implementation errors when @xmath97 is singular , which should be avoided when choosing the trial wavefunction . as a worst case ,",
    "implementation errors accumulate linearly with the simulated time",
    ". however , it can be far less severe : in sec .",
    "[ sec : numerics ] , we will explore an example in which the accumulation of errors due to the machine noise is almost negligible compared with errors in a quantum simulation based on the conventional trotter - suzuki decomposition .    shot noise can be suppressed by repeating quantum circuits for measuring @xmath34 and @xmath35 for many times . to measure the quantity @xmath150 , the deviation due to the shot noise decreases with the the number of repetitions @xmath151 as @xmath152 .",
    "therefore , if there is only short noise , @xmath153 , where @xmath154 , where @xmath155^{1/2}$ ] and @xmath156^{1/2}$ ] . in order to limit the overall effect of shot noise to be @xmath157 , we need to choose @xmath158 .    the number of distinct circuits @xmath159 required for finding the @xmath34 and @xmath35 parameters depends on the number @xmath160 of terms in the hamiltonian @xmath161 [ see eq .",
    "( [ eq : ham ] ) ] , the number @xmath162 of terms in each time derivative of @xmath49 [ see eq .",
    "( [ eq : drk ] ) ] , and @xmath50 .",
    "@xmath163 , where the first term corresponds to @xmath34 , and the second term corresponds to @xmath35 .",
    "if each @xmath49 is realised by @xmath164 gates , and each term @xmath165 or @xmath57 in the hamilton or the time derivative of @xmath49 is a pauli operator of less than @xmath166 qubits , each circuit includes at most @xmath167 gates .",
    "here , we have assumed that each controlled-@xmath68 gate in the circuit ( fig .",
    "[ fig : circuit ] ) is realised by @xmath166 two - qubit controlled-@xmath168 gates , where @xmath168 is a single - qubit pauli operator . to complete the circuit ,",
    "other operations include preparing initial states of the ancillary qubit and the register and measuring the ancillary qubit .",
    "the overall computation includes @xmath169 times steps , in each time step , @xmath159 circuits are implemented , each circuit contains @xmath170 gates and is repeated for @xmath151 times .",
    "therefore , the overall number of gates is @xmath171.\\end{aligned}\\ ] ] from this expression , we see that the cost is a polynomial function with respect to the integration error @xmath143 , the shot - noise error @xmath157 and the simulated time @xmath10 .",
    "factors @xmath172 , @xmath173 and @xmath174 depend on the form of the trial wavefunction .",
    "however , during the actual execution of the hybrid computation , it will be possible to estimate @xmath172 and @xmath173 .",
    "moreover @xmath148 when the trial wavefunction is a good approximation to the true state .",
    "it is important to remember that while the overall gate count will be a large ( albeit polynomially - scaling ) total , the complete calculation is formed of many small quantum calculations of depth @xmath170 .",
    "each small computation is isolated from the others , i.e. there is no shared or persistent quantum resource , and indeed @xmath175 such circuits could be performed in parallel using that many separate small quantum computers .",
    "is inferred by measuring @xmath150 for a set of error factors @xmath176 and fitting data using the function @xmath177 .",
    "( b ) error twirling and simulation .",
    "non - stochastic errors in a controlled - phase gate can be converted into stochastic errors by performing pauli gates before and after the gate , and error probabilities can be tuned by applying pauli gates after the gate . ]    of the implementation errors , machine noise is the more problematic .",
    "shot noise can be suppressed merely by repeating each quantum circuit for many times , and the repeating number scales polynomially with the accuracy .",
    "machine noise is less easily dismissed , and we focus on it in this section .",
    "machine noise need not necessarily result in computing errors .",
    "the task of the quantum computer is to work out coefficients @xmath34 and @xmath35 , so that the classical computer can work out time derivatives @xmath99 according to eq .",
    "( [ eq : difeq ] ) . machine noise ( as well as shot noise )",
    "can potentially cause computing errors by changing these time derivatives from their true values @xmath100 .",
    "however , sometimes machine noise does not change values of @xmath99 . for example , consider the case that the effect of machine noise is to depolarise the ancillary qubit at a fixed level , i.e.  the output of the quantum computer becomes @xmath178 , where @xmath179 is a constant independent of the quantum circuit . in this case , all equation coefficients are scaled as @xmath180 and @xmath181 . as long as @xmath179 is non - zero , the solution @xmath99 of eq .",
    "( [ eq : difeq ] ) is the same for any value of @xmath179 .",
    "therefore , only an inhomogeneous scaling of quantum outputs @xmath150 results in computing errors .",
    "an example of the homogeneous scaling is the case of balanced measurement errors .",
    "errors in the measurement on the ancillary qubit ( see fig .  [",
    "fig : circuit ] ) can be modelled as the following : if the state of the qubit is @xmath182 ( @xmath183 ) , the measurement outcome is correct , i.e.  @xmath184 ( @xmath185 ) , with the probability @xmath186 ( @xmath187 ) , and the outcome is incorrect , i.e.  @xmath185 ( @xmath184 ) , with the probability @xmath188 ( @xmath189 ) .",
    "if there are no other implementation errors , quantum outputs are changed from @xmath190 to @xmath191 . if measurement errors are balanced , i.e.  @xmath192 , the effect of measurement errors is a fixed scaling factor @xmath193 , which does not result in computing errors .",
    "therefore , our hybrid algorithm is inherently insensitive to measurement errors on the ancillary qubit if these errors are balanced .",
    "we remark that if single - qubit gates are reliable , one can flip the qubit before the measurement , so that measurement errors are effectively balanced .",
    "measurement errors can be corrected even if they are not balanced .",
    "if @xmath194 and @xmath195 can be evaluated by benchmarking measurement operations , one can easily work out the true value @xmath190 using the value obtained from the real machine : @xmath196 / ( 1-p_0-p_1)$ ] .",
    "next , we will show that a similar procedure can be applied to any machine noise if errors due to the machine noise are stochastic with tunable probabilities .",
    "we will also show how to convert errors in two - qubit entangling gates , which are expected to be the main sources of errors , into stochastic errors if they are not stochastic , and how to simulate stochastic errors to tune error probabilities .",
    "errors in an operation are stochastic if the operation is described by a superoperator @xmath197 and @xmath198 has the form @xmath199 . here",
    ", @xmath200 is the ideal operation without errors , @xmath198 is the superoperator describing the effect of the noise , @xmath201 is an identity operation , and errors @xmath202 occurs with the probability @xmath203 .",
    "@xmath202 is a valid quantum operation , i.e.  trace - preserving completely positive map .",
    "given an initial state @xmath46 , after a sequence of operations , the final state of the quantum computer is @xmath204 where @xmath205 denotes the @xmath206th operation . taking account that errors are stochastic , the quantum outcome can be rewritten in the form @xmath207 here , @xmath208 , @xmath209 is the value without errors , @xmath210 @xmath211 , and @xmath212 the @xmath213 term of @xmath214 corresponds to the case that only the @xmath213 operation causes errors and all other operations are ideal .",
    "note that in these equations we have replaced error probabilities @xmath215 with @xmath216 , where @xmath176 is a convenient scale factor allowing us to write @xmath217 as a function of @xmath176 , and @xmath218 .",
    "if probabilities of errors are tunable , we can infer the value of @xmath219 by measuring values of @xmath217 of a set of different factors @xmath176 [ see fig .  [",
    "fig : error](a ) ] .",
    "clearly @xmath176 can never be zero for our machine , as this would imply that we have the ability to fully switch off the machine noise , making it perfect .",
    "if @xmath220 are the minimum error probabilities allowed by the machine , the minimum value of @xmath176 achievable by the machine is @xmath185 . to infer the value of @xmath219 , firstly",
    ", we take @xmath221 values of @xmath176 as @xmath222 and measure @xmath223 using the quantum computer , where we can take @xmath224 ; secondly , we fit quantum outputs using the function @xmath225 , where @xmath226 . in this way , the first - order contribution of machine noise can be corrected .",
    "similarly , considering second - order terms in the expansion  ( [ eq : expansion ] ) , one can fit data using a function with second - order terms ( i.e.  @xmath227 terms ) to correct the second - order contribution of machine noise .",
    "the error reduction protocol only works for small - size circuits , which are used in the hybrid algorithm while the trotterisation algorithm usually needs large - size circuits .",
    "the true value @xmath190 can be inferred because the contribution of high - order terms is much smaller than the contribution of lower - order terms , i.e.  @xmath228 .",
    "the total rate of errors in the quantum circuit with @xmath170 gates is @xmath229 .",
    "the first term in the expansion corresponds to the first order contribution @xmath230 , and so on .",
    "therefore , high - order terms can not be neglected if @xmath231 .",
    "when there are too many gates in the circuit or the error rate is too high , the quantum state will be populated with errors and one can not retrieve the true value @xmath190 even if we consider high - order terms in the interpolation . the best experiments to date  @xcite have reduced two - qubit gate infidelity to the range @xmath232 to @xmath233 .",
    "with hardware of that kind , our protocol could support hundreds of gates .",
    "thus a simulation of a quantum system with a @xmath234 dimensional hilbert space , using a trial wavefunction with hundred(s ) of parameters , may be feasible .",
    "implementing the error reduction protocol requires knowledge of the inherent machine noise .",
    "therefore , quantum operations need to be benchmarked , e.g.  using quantum process tomography  @xcite , before the quantum coprocessor is used , and the nature of the machine noise should not vary significantly during the simulation .",
    "alternatively , one can monitor the machine noise in the process by stopping the protocol and benchmarking operations , because in the hybrid algorithm the quantum computer only performs small - size circuits and can be stopped at any stage .",
    "non - stochastic errors can be converted into stochastic pauli errors using some redundant pauli gates  @xcite .",
    "it has been seen as a common feature of quantum computing systems that two - qubit gates are the main sources of errors , i.e.  probabilities of errors in two - qubit gates are much higher than probabilities of errors in single - qubit gates  @xcite . in this case ,",
    "arbitrary errors in two - qubit gates can be converted into stochastic errors though the use of redundant pauli gates , without introducing significant additional noise .",
    "we consider the controlled - phase gate @xmath235 as an example , and it is similar for other two - qubit gates , e.g.  the controlled - not gate . here",
    "c and t denote the control qubit and the target qubit , respectively .",
    "the controlled - phase gate with noise is @xmath236 , where @xmath237 .",
    "the noise may not be in the stochastic - error form , so that we express the noise operation in the kraus form , i.e.  @xmath238 , where @xmath239 , and each two - qubit matrix can be written as @xmath240  @xcite . here",
    "@xmath241 correspond to pauli operators @xmath242 , @xmath243 , @xmath244 and @xmath245 , respectively .    in order to convert errors , pauli gates @xmath246 are randomly chosen and applied on each qubit before and after the controlled - phase gate . if the gate before the controlled - phase gate is @xmath68 , the gate after the controlled - phase gate is restricted to be @xmath247 to let random pauli gates cancel with each other",
    ". here , @xmath68 and @xmath247 are both two - qubit pauli gates . the circuit is shown in fig .",
    "[ fig : error](b ) , in which we take @xmath248 and @xmath249 , so that @xmath250 up to a phase factor . as a result ,",
    "the overall operation is @xmath251 , where @xmath252 is the superoperator describing the effective noise after applying random pauli gates .",
    "the effective noise superoperator is in the stochastic form  @xcite ( see appendix  [ sec : twirling ] ) , i.e. @xmath253 + \\sum _ { ( a , b ) \\neq ( 0,0 ) } \\epsilon_{a , b } [ { \\sigma^{a}_{\\rm c } } { \\sigma^{b}_{\\rm t } } ] , \\label{eq : effective}\\end{aligned}\\ ] ] where the fidelity is @xmath254 , and error probabilities are @xmath255 .",
    "@xmath256 $ ] is a superoperator , and @xmath256\\rho = u\\rho u^\\dag$ ] .",
    "we have assumed that pauli gates are ideal for simplification . in the case",
    "that errors in pauli gates are much less than errors in the controlled - phase gate , noise of pauli gates will be a perturbation to the effective noise of the controlled - phase gate .",
    "error severity in the controlled - phase gate will effectively increase by four units of the single - qubit pauli gate error rate , and the effective noise of the controlled - phase gate may not be fully stochastic if pauli - gate errors are non - stochastic .    to tune probabilities of errors , we can randomly perform pauli gates after the controlled - phase gate according to desired error probabilities [ see fig .  [",
    "fig : error](b ) ] .",
    "assuming that we want to tune error probabilities from @xmath257 to @xmath258 , we can perform the pauli gate @xmath259 [ @xmath260 with the probability @xmath261 . because we are only interested in the case that @xmath262 , overall error probabilities are approximately @xmath263 where the first term is due to the raw controlled - phase gate ( with noise ) , and the second term is due to simulated errors using single - qubit pauli gates .",
    "to demonstrate the hybrid algorithm , we numerically simulate a small quantum computer using classical computers .",
    "we take the quantum ising model  @xcite as an example .",
    "the hamiltonian of the model reads @xmath264 , where @xmath265 and @xmath266 . here , @xmath267 is the number of spins , and @xmath268 . in our numerical simulations ,",
    "we take @xmath269 and @xmath270 , therefore we need at least four qubits in the quantum computer to implement the hybrid algorithm .",
    "the trial state is chosen to be @xmath271 where the initial state @xmath272 is a one - dimensional cluster state . in the cluster state , qubits are in the eigenstate state of stabilisers @xmath273 ( @xmath274 ) with the same eigenvalue @xmath275 , which is prepared by performing the controlled - phase gate on each pair of nearest neighbouring qubits initialised in the state @xmath276  @xcite .",
    "the evolution of the true state is @xmath277 . in this example",
    ", the trial state is capable of exactly matching the true state given the correct values of the parameters .",
    "we consider a quantum computer that can initialise qubits in the state @xmath182 , measure a qubit in the @xmath278 basis , and perform single - qubit and two - qubit quantum gates .",
    "quantum gates include the hadamard gate , pauli gates , phase gates @xmath279 , flip gates @xmath280 , two - qubit gates @xmath281 , the controlled - phase gate and the controlled - not gate . with one of three types of two - qubit gates ,",
    "the other two can be efficient realised , e.g.  the gate @xmath282 can be realised using two controlled - phase gates and three single - qubit gates . here , @xmath283 is the hadamard gate on qubit-1 .",
    "we assume all three types of two - qubit gates can be directly implemented for simplification .",
    "the state @xmath276 is prepared by initialising the qubit in the state @xmath182 and performing a hadamard gate ; the measurement in the @xmath72 basis is done by performing a hadamard gate before measuring the qubit in the @xmath278 basis .",
    "we model the machine noise in the quantum computer as depolarising errors .",
    "a qubit may be initialised in the incorrect state ( @xmath183 ) with the probability @xmath284 .",
    "the measurement outcome is incorrect with the probability @xmath285 . for single - qubit gates , the noise superoperator is @xmath286 + \\frac{\\epsilon^{(1)}}{3}\\sum_{a=0}^{3}[{\\sigma^{(a)}_{}}].\\ ] ] for two - qubit gates , the noise superoperator is @xmath287 + \\frac{\\epsilon^{(2)}}{15}\\sum_{a=0}^{3}\\sum_{b=0}^{3}[{\\sigma^{(a)}_{1}}{\\sigma^{(b)}_{2}}].\\ ] ] here , @xmath288 and @xmath289 are rates of errors per gate .",
    "we assume that error rates of all single - qubit gates are the same , error rates of all two - qubit gates are the same , and error rates of single - qubit operations are only one tenth of error rates of two - qubit gates , i.e.  @xmath290 . because the size of quantum circuits for implementing the hybrid algorithm is small , we neglect memory errors . in this model of the machine noise , errors in quantum operations are all stochastic , and error rates can be tuned by simulating errors using single - qubit pauli gates .",
    "numerical simulations are performed to find the trace distance @xmath291 between the true state @xmath15 and the state @xmath292 prepared in the quantum computer according to the trial state @xmath17 [ see fig .  [",
    "fig : plot](a ) ] .",
    "because of the machine noise , @xmath292 is different from @xmath17 . the average values of stabilisers can be used to describe the quality of a cluster state . the performance of quantum algorithms in estimating the average values of stabilisers is shown in fig .  [ fig : plot](b ) . in our numerical simulations , we have taken @xmath293 , which is the state - of - the - art error rate  @xcite . see appendix  [ sec : detnum ] for some details of our numerical simulations .",
    "we observe that in this simulation the hybrid algorithm proves to be far more reliable than the trotterisation algorithm .",
    "the distance in the hybrid algorithm is about ten times lower than the distance in the trotterisation algorithm , and moreover the increase of the distance as a function of time can be largely suppressed in the hybrid algorithm by using the error reduction scheme [ fig .",
    "[ fig : plot](a ) ] . as a result , the hybrid algorithm can provide a much better estimation of the average values of stabilisers [ fig .",
    "[ fig : plot](b ) ] .",
    "we would like to stress that in order to make the comparison fair , the time interval selected for the trotterisation algorithm has been optimised to minimise errors ( in practice",
    "this would be possibly only if the distance from the true state can be measured in the quantum computer , an ability that would probably negate the need for simulation ! ) . in the hybrid algorithm , we have used the fourth - order runge - kutta method and taken @xmath294 to eliminate errors due to the numerical integration ; and we have neglected the effect of shot noise , therefore all errors are due to machine noise .    given a finite time cost of implementing the hybrid algorithm , we need to consider the effect of errors in the numerical integration and shot noise .",
    "taking into account the effect of these two types of imperfections , we find that the distance in the hybrid algorithm may be increased but still much lower than the distance in the trotterisation algorithm [ blue and red bands in fig .  [",
    "fig : plot](a ) ] : we take @xmath295 and assume that each circuit is repeated for @xmath296 ( @xmath297 ) times to measure @xmath150 in the hybrid algorithm ( with the error reduction ) .",
    "the increasing of the distance only slightly changes the estimation of average values of stabilisers [ fig .",
    "[ fig : plot](b ) ] .",
    "we have proposed a quantum algorithm for simulating the time evolution of a quantum system . in this algorithm , both a classical processor and a quantum coprocessor are tightly integrated .",
    "because of the assistance of the classical computer , the algorithm can be implemented with quantum circuits of much less depth ( i.e. fewer quantum operations ) compared with the canonical trotterisation algorithm .",
    "we discussed the robustness of the algorithm to noise , and we found that the algorithm can automatically correct some errors induced by the noise in the quantum computer .",
    "moreover , by deliberately amplifying stochastic noise in a controllable way , the zero - error limit can be estimated ; consequently , the effect of errors can be significantly suppressed without the need for code - based quantum error correction and its concomitant resource overheads .",
    "this quantum algorithm can also be parallelised easily .",
    "the task of the quantum coprocessor is to repeatedly implement a set of small - size quantum circuits , therefore the computing speed can be accelerated by using a cluster of quantum coprocessors , in which each works independently and there are not quantum channels linking them .    in view of these various merits , we believe that our algorithm provides a promising candidate application of early - stage non - fault - tolerant quantum computers .    this work was supported by the epsrc national quantum technology hub in networked quantum information technology .",
    "the authors would like to acknowledge the use of the university of oxford advanced research computing ( arc ) facility in carrying out this work .",
    "http://dx.doi.org/10.5281/zenodo.22558 .",
    "* note added for second arxiv submission : * shortly after we posted the first version of this paper , a highly relevant paper was also posted by authors temme , bravyi , and gambetta ( arxiv:1612.02058 ) , which we commend to the reader s attention .",
    "in fig .  [ fig : hybrid](b ) , the time evolution of a qubit is simulated .",
    "the time evolution is driven by the hamiltonian @xmath298 .",
    "the trial state is in the form @xmath299 .",
    "the initial state is given by @xmath300 and @xmath301 , and @xmath302 .",
    "demonstrating this example needs a quantum computer of two qubits .",
    "the twirled controlled - phase gate on a state @xmath74 reads @xmath303 \\mathcal{n}_\\lambda \\mathcal{u}_\\lambda [ { \\sigma^{a}_{\\rm c } } { \\sigma^{b}_{\\rm t } } ] \\rho = \\bar{\\mathcal{n}}_\\lambda \\mathcal{u}_\\lambda \\rho\\end{aligned}\\ ] ] the effective noise superoperator is @xmath304 \\mathcal{n}_\\lambda [ { \\sigma^{a}_{\\rm c } } { \\sigma^{b}_{\\rm t}}].\\end{aligned}\\ ] ] using @xmath305{\\sigma^{b}_{}}$ ] , we can find that the effective noise is in the stochastic form of eq .",
    "( [ eq : effective ] ) .",
    "in the hybrid algorithm with the error reduction , we take @xmath224 and @xmath306 and fit the function @xmath177 to infer the value of @xmath190 . to simulate shot noise",
    ", we use the normal distribution to approximate the binomial distribution , i.e.  the value of @xmath150 taking into account the shot noise is given by @xmath307 , where @xmath308 is given by a normal distribution with the mean @xmath309 and the standard deviation @xmath310 .    in the trotterisation algorithm ,",
    "the time evolution is simulated using eq .",
    "( [ eq : decomposition ] ) . for the quantum ising model , the hamiltonian is decomposed into two terms @xmath311 and @xmath312 . in our numerical simulations ,",
    "we take @xmath313 , @xmath314 if @xmath315 , and @xmath316 .",
    "such a method of determining trotterisation parameters coincides with the optimal choice of the number @xmath11 to minimise errors  @xcite .",
    "the state @xmath292 is given by replacing @xmath10 with @xmath1 and determining @xmath11 and @xmath8 using the method we just described .    to find the optimal @xmath3 , we consider the average trace distance @xmath317 , where @xmath318 is the true state , and @xmath74 is the state prepared in the quantum computer according to the trotterisation algorithm . the average trace distance is plotted in fig .",
    "[ fig : plot](a ) , taking @xmath319 in the average . to obtain other results in fig .",
    "[ fig : plot ] , we take @xmath320 in the trotterisation algorithm , which minimises the average distance .",
    "r. barends , j. kelly , a. megrant , a. veitia , d. sank , e. jeffrey , t. c. white , j. mutus , a. g. fowler , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , c. neill , p. omalley , p. roushan , a. vainsencher , j. wenner , a. n. korotkov , a. n. cleland , and j. m. martinis , _ superconducting quantum circuits at the surface code threshold for fault tolerance _ , nature * 508 * , 500 ( 2014 ) .",
    "t. p. harty , d. t. c. allcock , c. j. ballance , l. guidoni , h. a. janacek , n. m. linke , d. n. stacey , and d. m. lucas , _ high - fidelity preparation , gates , memory and readout of a trapped - ion quantum bit _",
    "lett . * 113 * , 220501 ( 2014 ) .",
    "j. p. gaebler , t. r. tan , y. lin , y. wan , r. bowler , a. c. keith , s. glancy , k. coakley , e. knill , d. leibfried , and d. j. wineland , _ high - fidelity universal gate set for @xmath321be@xmath322 ion qubits _ , phys .",
    "lett . * 117 * , 060505 ( 2016 ) .",
    "a. peruzzo , j. mcclean , p. shadbolt , m .- h .",
    "yung , x .- q .",
    "zhou , p. j. love , a. aspuru - guzik , and j. l. obrien , _ a variational eigenvalue solver on a photonic quantum processor _ , nat .",
    "commun . * 5 * , 4213 ( 2014 ) .",
    "j. m. kreula , l. garca - lvarez , l. lamata , s. r. clark , e. solano , and d. jaksch , _ few - qubit quantum - classical simulation of strongly correlated lattice fermions _ , epj quantum technology * 3 * , 11 ( 2016 ) .      p. j. j. omalley , r. babbush , i. d. kivlichan , j. romero , j. r. mcclean , r. barends , j. kelly , p. roushan , a. tranter , n. ding , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , a. g. fowler , e. jeffrey , e. lucero , a. megrant , j. y. mutus , m. neeley , c. neill , c. quintana , d. sank , a. vainsencher , j. wenner , t. c. white , p. v. coveney , p. j. love , h. neven , a. aspuru - guzik , and j. m. martinis , _ scalable quantum simulation of molecular energies _ , phys .",
    "x * 6 * , 031007 ( 2016 ) .",
    "b. p. lanyon , c. hempel , d. nigg , m. mller , r. gerritsma , f. zhringer , p. schindler , j. t. barreiro , m. rambach , g. kirchmair , m. hennrich , p. zoller , r. blatt , and c. f. roos , _ universal digital quantum simulation with trapped ions _ , science * 334 * , 57 ( 2011 ) .",
    "r. barends , l. lamata , j. kelly , l. garca - lvarez , a. g. fowler , a. megrant , e. jeffrey , t. c. white , d. sank , j. y. mutus , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , i .-",
    "c . hoi , c. neill , p. j. j. omalley , c. quintana , p. roushan , a. vainsencher , j. wenner , e. solano , and j. m. martinis , _ digital quantum simulation of fermionic models with a superconducting circuit _ , nat",
    "* 6 * , 7654 ( 2015 ) .",
    "r. c. bialczak , m. ansmann , m. hofheinz , e. lucero , m. neeley , a. d. oconnell , d. sank , h. wang , j. wenner , m. steffen , a. n. cleland , and j. m. martinis , _ quantum process tomography of a universal entangling gate implemented with josephson phase qubits _",
    ", nat . phys .",
    "* 6 * , 409 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> one of the key applications for quantum computers will be the simulation of other quantum systems that arise in chemistry , materials science , etc , in order to accelerate the process of discovery . </S>",
    "<S> it is important to ask : can this be achieved using near future quantum processors , of modest size and under imperfect control , or must it await the more distant era of large - scale fault - tolerant quantum computing ? here </S>",
    "<S> we propose a variational method involving closely integrated classical and quantum coprocessors . </S>",
    "<S> we presume that all operations in the quantum coprocessor are prone to error . </S>",
    "<S> the impact of such errors is minimised by _ boosting _ them artificially and then extrapolating to the zero - error case . in comparison to a more conventional optimised trotterisation technique </S>",
    "<S> , we find that our protocol is efficient and appears to be fundamentally more robust against error accumulation . </S>"
  ]
}