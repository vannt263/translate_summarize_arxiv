{
  "article_text": [
    "continuous measurement of quantum systems @xcite , the study of quantum systems states under the influence of observation prolonged in time , has been a topic of considerable activity in recent years .",
    "particularly , for the measurement of an individual microscopic system that is weakly coupled to measurement apparatus , the system s state and its conditioned evolution in time , the so - called diffusive - type quantum state trajectory @xcite , have been intensively explored for applications in quantum information and quantum control .",
    "some of the active fields are quantum state estimation ( i.e. , estimating the pre - measurement state of an ensemble of identically prepared systems @xcite ) , conditional reversal of measurement @xcite , and the preparation of entangled states @xcite .",
    "the ability to continuously measure quantum systems also opens the possibility of feedback control @xcite , which has also been investigated for topics such as the stabilization of coherent oscillations @xcite and rapid state purification @xcite .",
    "this growing interest in the quantum systems under weak continuous measurement has motivated a thorough analysis of quantum trajectory statistics .",
    "of notable importance are advances in experiments , such as the measurement of superconducting qubits @xcite , which has allowed the tracking of the trajectories of the quantum state with high fidelity in a single measurement run , allowing the statistics of selected subensembles of trajectories to be explored .",
    "the authors recently developed an action principle @xcite over a doubled quantum state space , based on a path integral representation of probability distributions of quantum trajectories .",
    "the action principle , implemented by extremizing of the stochastic path integral s action , was used to investigate the optimal behaviour of the trajectories with arbitrary constraints , such as fixing the final boundary condition @xcite .",
    "the stochastic path integral and the optimum likelihood approach provide a convenient way to investigate statistical distributions and globally optimal dynamics of quantum state evolution , in addition to the stochastic master equations describing the quantum trajectories and the lindblad master equations describing their average evolution @xcite .    in this paper",
    ", we continue the development of the stochastic path integral formalism @xcite , to further explore advantages of having the full joint probability distribution of quantum trajectories .",
    "this includes computing statistical averages or expectation values with the ability to condition on definite quantum states at particular times .",
    "we present several examples of the formalism including a qubit system under the influence of measurement alone , measurement with concurrent unitary dynamics , and qubit measurement with feedback control . in these examples ,",
    "the statistics of qubit trajectories are computed using developed techniques for the path integral , such as multi - dimensional gaussian integrals and diagrammatic expansion theory .",
    "moreover , in an example of qubit measurement with linear feedback , we utilize a phase portrait analysis to investigate the most likely behaviour of the system dynamics , revealing a simple and practical approach for qubit state stabilization .",
    "there have been past works on continuous quantum measurements with path integrals , so we wish to discuss how our approach bears both similarities and differences to them .",
    "an early approach suggested by feynman @xcite and later independently developed by mensky @xcite is a restricted path integral : a modified version of the feynman path integral to only sum over paths that contribute to a measurement record .",
    "caves , and also barchielli @xcite , constructed similar path integrals by adding coarse - graining ( resolution ) functions describing the effect of the measurement . in these path integral approaches , one considers the distribution of the measurement records ( it can be derived from the probability amplitude , see appendix  [ app - otherpathint ] ) , whereas in our approach , we formulate a path integral in quantum state space to represent a joint probability distribution of the measurement readouts as well as quantum state trajectories . wei and nazarov discussed a different approach to continuous measurements using the keldysh path integral technique @xcite . in breuer and petruccione s path integral @xcite , the notion of the sum over pure state paths in hilbert space is applied , resulting in a different type of doubled state space that does not yield an action functional .",
    "the stochastic path integral formalism and the analysis of its action are also applied in classical stochastic processes .",
    "for instance , the formalism is used in studying the dynamics and distribution of transmitted electronic charge @xcite , the neural network @xcite , and the large deviations from typical behaviours ( rare events ) @xcite .",
    "our approach is similar to the martin - siggia - rose formalism @xcite , which involves adding conjugate fields through the fourier integral form of delta functionals enforcing diffusive dynamics .",
    "notably , one can think of the quantum trajectories on a finite dimensional state space as analogous to classical random processes in configuration space of that dimension .",
    "this paper is organized as follows . in section  [ sec - mainspi ] ,",
    "we review the stochastic path integral formalism and its extremized action equations , for a general finite - dimensional system with a markovian setup for weak continuous measurement . in section",
    "[ sec - qubit ] , a specific measurement setup for a qubit is presented , which is used throughout this paper . in section  [ sec - qnd ] , we show that , in the case without qubit hamiltonian , we can perform the full path integration directly to get the multi - time correlation functions for the preselected and postselected qubit state . in section  [ sec - purbexpand ] ,",
    "the diagrammatic expansion theory is presented as an alternative approximation method for computing multi - time correlation functions , with examples for qubit measurement with rabi oscillation . in section",
    "[ sec - feedback ] , qubit measurement with feedback control and its optimal dynamics are investigated using the path integral and the action principle approaches .",
    "the conclusion can be found in section  [ sec - conclusion ] .",
    "a series of supplementary discussions and some detailed calculations that are not included in the main text are presented in the appendixes .",
    "we consider the distribution of quantum state trajectories for continuous quantum measurement .",
    "a quantum state trajectory , or simply a quantum trajectory , is an evolution of a quantum state in time , conditioned on a detector readout realization .",
    "this conditional state trajectory is also known as a solution of stochastic master equations , unravelling master equations in lindblad form .",
    "let us discretize the measurement readout into @xmath0 time points and denote @xmath1 as a measurement realization .",
    "each @xmath2 is a readout obtained between time @xmath3 and @xmath4 , and is assumed dependent only on a quantum state right before its measurement ( markov assumption ) .",
    "we define a series of quantum states @xmath5 , written as a @xmath6-dimensional parametrized vector @xmath7 , where the components are the expansion coefficients of the density operator @xmath8 written in some orthogonal operator basis , such as the @xmath9 generalized gell - mann matrices @xmath10 of a @xmath11-state system @xcite . for a two - state system , the matrices @xmath10 for @xmath12",
    "are the pauli matrices , and @xmath13 is a vector in bloch sphere coordinates .",
    "the quantum state trajectory can be computed with an update equation of the form , @xmath14 $ ] , taking into account the measurement back - action from the measurement readout @xmath2 , and also considering the unitary evolution from the measured system s hamiltonian .    since the distribution of the measurement readout only depends on the quantum state right before the measurement in this markovian approach ,",
    "we can then write the joint probability density function ( pdf ) of all measurement outcomes and state trajectories @xmath15 given an initial state @xmath16 and a set of other constraints @xmath17 as , @xmath18 this is a time step product of @xmath19 , the conditional probability distribution for the measurement outcome @xmath2 given the system state before the measurement @xmath20 , and @xmath21)$ ] , the ( deterministic ) conditional probability distribution for the quantum state after the measurement , given the state at the previous time step and the measurement readout .",
    "the prefactor @xmath22 $ ] in eq .",
    "is a function of quantum states and readouts at any times , accounting for constraints used in selecting a sub - ensemble of the quantum trajectories , such as initial - state and final - state conditions .    the benefit of having the joint pdf eq .",
    "is that it contains all the statistical information about the system s evolution under measurement , and it allows us to selectively work with sub - ensembles of quantum trajectories simply by adding constraints ( or conditions ) to the joint distribution .",
    "statistical moments can be computed from this joint pdf by integrating over its variables .",
    "for example , an expected value of an arbitrary functional @xmath23 $ ] is given by @xmath24_1^n { \\mathrm{d}}[r_k]_0^{n-1 } { \\cal p}_{\\zeta } { \\cal a}$ ] , where we define a notation for the multiple integral , @xmath25_{1}^{n } \\equiv \\int\\!\\ !",
    "{ \\mathrm{d}}{{\\bm q}}_{1 } \\cdots { \\mathrm{d}}{{\\bm q}}_{n}$ ] .",
    "direct integration of these quantities using the joint pdf as in eq .",
    ", however , can be a challenging task even for a simple qubit measurement problem .",
    "as such , we are motivated to write the joint pdf in a path integral form with an action ( or exponent ) , so we can perform the integration using techniques developed in quantum theory such as a diagrammatic perturbation theory .",
    "the path integral representation of the joint pdf in eq .   can be attained by writing the delta functions for the state update @xmath26)$ ] for @xmath27 to @xmath28 in the fourier integral form , i.e. , @xmath29 for each @xmath30 and each component of the vector @xmath7 , and then rewrite other terms in exponential forms . the conjugate variables for those delta functions",
    "are denoted by @xmath31 for @xmath27 to @xmath28 .",
    "we refer to ref .",
    "@xcite and its appendixes for a thorough discussion about this transformation and the construction of the path integral . as a result",
    ", the joint pdf is then given in a path integral form , @xmath32_{0}^{n-1 } \\exp({\\cal s}),\\end{aligned}\\ ] ] where the integrals are over all possible paths of @xmath33 and the action @xmath34 is defined as , @xmath35 ) + \\ln p(r_k | \\bm{q}_k ) \\bigg\\}.\\end{aligned}\\ ] ] we note that @xmath36 is an additional term determined by the formation of @xmath37 in eq .  , and @xmath38 is a prefactor absorbing normalization constants .    for an example",
    ", we consider a sub - ensemble of trajectories that obey conditions on the initial and final states .",
    "the theoretical analysis of this kind of constraint is presented in ref .",
    "the initial state is fixed at @xmath39 and the final state is at @xmath40 .",
    "this leads to the constraint term @xmath41 in eq .   and",
    "the preselected and postselected joint pdf , @xmath42 , which is written in a path integral form as , @xmath43_{-1}^{n } \\exp({\\cal s}_{{{\\bm q}}_i , { { \\bm q}}_f}),\\end{aligned}\\ ] ] where the path integral s action is , @xmath44 ) + \\ln p(r_k | \\bm{q}_k ) \\bigg\\}.\\end{aligned}\\ ] ] we note that , in eq .   and ,",
    "two additional conjugate variables , @xmath45 and @xmath46 , are introduced , because we have written the delta functions in @xmath47 , one for the initial state and another for the final state , in the fourier integral form .",
    "we can investigate the path integral s largest contribution by solving for its action s extrema .",
    "taking the variation of the action eq .",
    "over all the variables and setting it to zero , we obtain a set of difference equations ,    [ eq - diffeqs ] @xmath48&=0,\\\\   \\label{eq - backwardp } -\\bm{p}_{k-1 } + \\frac{\\partial}{\\partial \\bm{q}_k}\\big\\{\\bm{p}_k\\cdot \\bm{\\mathcal{e}}[\\bm{q}_k , r_k ] + \\ln p(r_k | \\bm{q}_k)\\big\\}&=0 , \\\\",
    "\\frac{\\partial}{\\partial r_k}\\big\\ { \\bm{p}_k \\cdot \\bm{\\mathcal{e}}[\\bm{q}_k , r_k ] + \\ln p(r_k | \\bm{q}_k)\\big\\}&=0.\\end{aligned}\\ ] ]    the first , second and third equations are from taking derivatives over the conjugate variables @xmath31 from @xmath49 to @xmath28 , over the state variables @xmath20 from @xmath50 to @xmath28 , and over the measurement readout variables @xmath2 from @xmath27 to @xmath28 , respectively .",
    "the derivative over the final state variable @xmath51 gives a trivial equation @xmath52 , whereas the derivatives of the action over @xmath45 and @xmath46 force the boundary conditions @xmath39 and @xmath40 on the solutions of eqs .  .",
    "we note that , in the case of no final boundary condition on the quantum state ( i.e. , @xmath53 or @xmath54 ) , the derivative of the action over @xmath51 instead gives @xmath55 , a final value of the conjugate variable .    interestingly , this extremization of the action in eqs .",
    "reproduces the lagrange multiplier method , an optimization strategy that accommodates constraints . in our case ,",
    "the optimized function is the last term of eq .  , @xmath56 , subject to the constraints @xmath57 $ ] for @xmath58 ( enforcing the deterministic state update ) with the lagrange multipliers @xmath59 , and the boundary constraints @xmath39 and @xmath40 with the lagrange multipliers @xmath45 and @xmath46",
    "therefore , a solution of the difference equations eqs .   is a path that optimizes the log - likelihood of a quantum trajectory , @xmath56 , subject to the indicated constraints .",
    "the optimal path can be a local maximum , a local minimum , or a saddle point in the constrained probability space .",
    "for the optimal path that represents the local maximum , we call it the most likely path or the most probable path",
    ".    the optimal path , a solution of the difference equations eq .   and",
    "their boundary conditions , can be approximated by taking a time - continuous limit @xmath60 , changing the difference equations to a set of ordinary differential equations , which can then be solved analytically or numerically .",
    "this approximation is applicable because its solutions , the optimal readouts and the optimal quantum paths , are smooth functions of time . in the case of the optimal paths that maximize the log - likelihood of preselected and postselected quantum trajectories ( the most likely paths between two quantum states ) ,",
    "these solutions have been experimentally verified with a superconducting transmon qubit @xcite .",
    "so far , we have presented the joint pdf and the path integrals in the time - discrete form . for a more compact representation ,",
    "we introduce a time - continuous version of the discrete stochastic path integral , assuming that the system is not intrinsically discrete and a well - defined diffusive limit exists .",
    "the joint pdf , for example in eq .  , is written as , @xmath61 \\ , \\exp({\\cal s } ) \\overset{\\delta t \\rightarrow 0}{= } { \\cal n}\\!\\ ! \\int \\!\\!\\ ! { \\cal d}{{\\bm p}}\\ , \\exp({\\cal s}),\\end{aligned}\\ ] ] where we have defined a notation for functional integrals , e.g. , @xmath62 $ ] . the action in eq .",
    "is given by , @xmath63 ) + { \\cal f}[{{\\bm q}},r]\\big\\},\\end{aligned}\\ ] ] where we have introduced @xmath64{\\mathrm{d}}t$ ] as the time - continuous version of the state update equation @xmath65 $ ] , and defined @xmath66 $ ] as the linear - order expansion in time of the log - probability , i.e. , @xmath67+o(\\delta t^2)\\}$ ] .",
    "a proportionality factor of the latter is absorbed into the normalization factor @xmath38 .",
    "the time dependence of the variables in eq .   and is suppressed for simplicity ( e.g. , @xmath68 ) .    in the continuous version of the action",
    ", the state update equation @xmath69 $ ] can be derived from the first order expansion in @xmath70 of its discrete form @xmath65 $ ] using the exact readout probability distribution @xmath19 . as an alternative",
    ", one can consider using a stochastic master equation of the quantum state , where an ideal white noise @xmath71 is introduced with its single gaussian probability distribution .",
    "the latter substitution is valid in an idealized noise limit , which we discuss in more detail in section [ subsec - nonqnd ] ( where it stochastic equations are chosen in the diagrammatic perturbation approach ) and in appendix  [ app - whitenoise ] .",
    "the choice of the stochastic state equations needs to be consistent with the readout ( or noise ) probability distribution used in obtaining the functional @xmath66 $ ] in eq .  .",
    "a careful analysis is needed when considering the extremization of the action as described in eqs .  , which , in the continuum limit , changes to a set of ordinary differential equations .",
    "we note that one can derive this same set of differential equations directly from extremizing the continuous - version action in eq .  , if the state update equation @xmath69 $ ] is obtained from the first order expansion in @xmath70 of its discrete form ( this approach to the derivation is presented in ref .",
    "@xcite ) . for the action constructed using the it stochastic equations",
    ", its extremization does not give a correct set of differential equations describing the optimal paths .",
    "however , a stochastic path integral formulated using the it equations is more advantageous when computing functional integrals , which is presented in section  [ sec - purbexpand ] .",
    "so far we have presented the formalism in the general context , the quantum measurement with measurement readouts @xmath72 and corresponding quantum states @xmath73 . in order to show examples and demonstrate how to compute interesting quantities using the path integral formalism , we choose a particular theoretical model , a qubit continuously measured by an apparatus assuming a weakly responding ( or coupled ) detector .",
    "this theoretical setup has long been a subject of interest in theories and experiments .",
    "some of the physical realizations of this system available with current technology are as follows : a single electron in a double quantum dot capacitively coupled to a quantum point contact detector @xcite , a superconducting qubit dispersively coupled to a microwave waveguide cavity @xcite , and quantum optics experiments such as a two - level atom monitored with homodyne optical measurement @xcite .    in most of these experimental setups",
    ", one can characterize the qubit evolution as governed by the measurement back - action , the qubit unitary evolution , and extra dephasing due to loss of information or added noise .",
    "we write a time - discrete change for a qubit density matrix @xmath8 as @xmath74 $ ] , where we define a measurement operation @xmath75 = { { \\hat { m}}}_{r_k } \\rho { { \\hat { m}}}_{r_k}^{\\dagger}/{\\text{tr}({{\\hat { m}}}_{r_k } \\rho { { \\hat { m}}}_{r_k}^{\\dagger})}$ ] , a unitary operation @xmath76 = e^{-i { { \\hat { h } } } \\delta t } \\rho e^{i { { \\hat { h } } } \\delta t}$ ] , and an extra dephasing operation @xmath77 $ ] ( we set @xmath78 ) .    the measurement back - action on a qubit state , considering the diffusive measurement as in refs .",
    "@xcite , is described by a measurement operator @xmath79 $ ] , where @xmath80 is a characteristic measurement time taken to separate the two gaussian distributions by two standard deviations .",
    "the measurement readout distribution is computed from the trace of the measurement operator and the qubit state , @xmath81 with the bloch sphere coordinates of the qubit state given by @xmath82 .",
    "we denote a qubit hamiltonian by @xmath83 characterizing the unitary evolution during the measurement , and we define the dephasing operation @xmath77 $ ] accounting for additional dephasing on the system , such as detection inefficiency and dephasing due to the environment .",
    "we model the dephasing operation as an extra dephasing rate @xmath84 on the off - diagonal elements of the qubit density matrix @xmath8 . by expanding the state update equation",
    "@xmath74 $ ] to first order in @xmath70 , and taking a continuum limit @xmath60 , we obtain a set of differential equations ,    [ eq - contstate ] @xmath85    which turns out to be analogous to the stochastic master equation in stratonovich interpretation as mentioned in ref .",
    "@xcite .    using the state update equations in eqs .   and the readout distribution in eq .",
    ", we have the qubit action in continuous form ( as in eq .  ) , @xmath86 where we have approximated the logarithm of the readout distribution as @xmath87 , omitting the second term and its higher order expansion because they can be absorbed into the prefactor @xmath38 .",
    "we note that the extremization of this action and its most likely paths with fixed initial and final states are presented in more detail in ref .",
    "@xcite .    in the remainder of this paper",
    ", we will focus on applying the path integral formalism to this particular qubit measurement system , though in different regimes of the hamiltonian parameters . for example , in the next section , we study the `` plain '' qubit measurement where we assume that there is no qubit hamiltonian , i.e. , @xmath88 , and the qubit s evolution comes only from the measurement and the dephasing mechanism .",
    "in this section , we present examples as to how we can use the path integral and its optimal path to compute statistical moments of the measured qubit trajectories . as it turns out",
    ", analytic solutions are possible for the case of quantum non - demolition measurement ( @xmath89 , where the system hamiltonian commutes with total system - detector hamiltonian ) with a constraint on the initial and final states of the quantum trajectories . in this case",
    ", the path integral can be written only in the @xmath90-coordinate , i.e. , @xmath91 , because the evolution of @xmath90 is independent of the other two coordinates , @xmath92 and @xmath93 .",
    "the @xmath92 and @xmath93 degrees of freedom can be found directly from @xmath94 and @xmath90 , so they will be dropped from the discussion until section  [ sec - purbexpand ] .    in the following subsections , we consider the plain measurement case when @xmath88 for simplicity .",
    "we show how to compute the path integral using the preselected and postselected joint pdf , @xmath95 .",
    "we first integrate this joint pdf over all intermediate variables to get the probability density function @xmath96 of arriving at the final state @xmath97 after time @xmath98 , given the initial state @xmath99 .",
    "then , we show how to generalize the integration procedures to compute statistical quantities such as averages , variances , and correlation functions of the qubit trajectories in this simplified case .",
    "we note here that even though we present the derivation in the plain measurement case , the result should still be valid for the case when @xmath100 . in the latter case",
    ", the evolution of the @xmath92 and @xmath93 coordinates of the qubit will be deterministically oscillating with the frequency @xmath101 , without affecting the evolution of the @xmath90 coordinate .      in order to compute the probability distribution of the final qubit state given the initial state separated by time @xmath98 , we start with the joint pdf @xmath102 of the qubit trajectories @xmath103 and measurement outcomes @xmath104 with fixed boundary states , and then integrate over all variables except the final state @xmath97 , @xmath105_0^{n}{\\mathrm{d}}[r_k]_0^{n-1 } { \\cal p}_{z_i , z_f},\\end{aligned}\\ ] ] where , as before , we have defined the multi - variable integral , e.g. , @xmath106_{0}^{n } = \\int\\!\\ ! { \\mathrm{d}}z_{0 } \\cdots { \\mathrm{d}}z_{n}$ ] .    from the discussion in section  [ sec - mainspi ] ,",
    "the joint pdf is given by a product over the sliced time variables , @xmath107 .",
    "the term describing the state update equation is a delta function , @xmath108 with its argument derived from the @xmath90-coordinate of the density matrix equation @xmath109 $ ] , whereas , the probability distribution for the readout eq .",
    "is expressed in this form , @xmath110 neglecting higher orders in @xmath70 . substituting these two expressions , eqs .   and , into the joint pdf",
    ", we get @xmath111 where we have used @xmath112 to represent the delta function in eq .  .",
    "we then integrate out the measurement readouts by transforming the delta function of @xmath90 into a delta function in the readout variable , @xmath113 , using the transformation relation @xmath114 = \\sum_i \\delta[y - y_i]/|\\partial_y f(y)|_{y_i = f^{-1}(x)}$ ] , where the sum extends over all solutions of @xmath115 . after integrating over the measurement readout and also over the boundary state @xmath116 , and @xmath117 , the joint pdf",
    "is transformed to a new joint pdf , a function of only the intermediate @xmath90-variables , @xmath118 where the action @xmath34 is , @xmath119 we note that we have simplified the above equation by defining a new variable @xmath120 to write the joint pdf in a compact form .",
    "this joint pdf of the @xmath90-variable is one of the main results shown in this paper .",
    "it is also important to point out that since we have already integrated over the boundary state variable @xmath116 and @xmath117 , the delta functions for the boundary states have applied to the states @xmath121 and @xmath122 in eqs .   and .",
    "the next step is to perform the integration over the intermediate variables @xmath123 for @xmath124 .",
    "these integrals can be done easily by expanding @xmath123 around the optimal solution denoted by @xmath125 .",
    "we substitute @xmath126 for all @xmath30 s in the action , and perform integration by parts with the vanishing boundaries , @xmath127 .",
    "this substitution exactly simplifies to @xmath128 = { \\cal s}[{\\bar u } ] - \\frac{\\tau_m}{2 \\delta t } \\sum_{k=0}^{n-1}(\\eta_{k+1}-\\eta_k)^2 $ ] ( see appendix  [ app - actionpure ] for more detail ) .",
    "we then change the integral measures to @xmath129 for @xmath130 and write the probability distribution in eq .   in terms of @xmath131-variables , @xmath132)}{1-z_{f}^2 } \\\\ & \\times   \\exp\\left\\{-   \\frac { \\tau_m}{2 \\delta t}\\sum_{k=0}^{n-1}(\\eta_{k+1}-\\eta_k)^2\\right\\},\\end{aligned}\\ ] ] where the optimal path @xmath125 is a solution of the extremization of the action , which gives @xmath133 .",
    "the solution is @xmath134 with the two constants of integration @xmath135 and @xmath136 .",
    "the optimal solution ( the most likely path ) is given by , @xmath137 where we wrote @xmath138 .",
    "we note that in the time - continuum limit , this extremization is equivalent to the vanishing functional derivative of the action , @xmath139/\\delta u(t ) = \\tau_m \\ddot{u } = 0 $ ] , which is similar to the euler - lagrange equation for the classical trajectory of a free particle in the @xmath140 coordinate transformation .",
    "the integrals in eq .  , with the probability distribution in @xmath131-variable eq .  , is now in this form , @xmath141_1^{n-1 } p ( \\ { \\eta_k \\}_1^{n-1 } , z_f | z_i).\\end{aligned}\\ ] ] fortunately , they are gaussian integrals in multiple dimensions which can be calculated from the matrix integral , @xmath142 , where , in our case , @xmath143_1^{n-1}= \\int \\!\\ !",
    "{ \\mathrm{d}}\\eta_1\\cdots { \\mathrm{d}}\\eta_{n-1}$ ] , and the matrix @xmath144 and the vector @xmath145 are given by , @xmath146 noting that @xmath147 .",
    "after substituting the optimal solution @xmath125 into @xmath148 $ ] and performing the integrals over @xmath149 in eq .",
    ", we obtain the distribution of the final state fixing the initial state and the duration of time @xmath150 , @xmath151 where we have defined @xmath152 as the optimal measurement readout .",
    "this solution is exactly the same as what we would get from the change of variables of the probability distribution , @xmath153 , where @xmath154 is a time - average measurement readout .",
    "the derivation of the latter distribution is presented in the methods section of ref .",
    "@xcite .",
    "we have derived the probability distribution for the measured qubit given the fixed initial and final states , as shown in eq .   and . in this subsection , we consider computing the qubit trajectory s statistical quantities that can be written in this expectation form , @xmath155_1^{n-1}{\\cal a}\\,\\ , \\frac{p ( \\ { z_k \\}_1^{n-1},z_f | z_i)}{p(z_f|z_i)},\\\\ = & \\frac{\\sqrt{\\text{det}{\\bm m}}}{(2 \\pi)^{\\frac{n-1}{2 } } } \\int { \\rm d}[\\eta_k]_1^{n-1}{\\cal a}\\,\\ , e^{-\\frac{1}{2}{\\bm \\eta}^t\\cdot { \\bm m } \\cdot { \\bm \\eta}},\\end{aligned}\\ ] ] where @xmath156 is an arbitrary functional of @xmath157 at any time @xmath158 for @xmath159 and the matrix @xmath144 is the same as defined in eq .  .",
    "note that we have used the notation @xmath160 for a statistical average conditioned on fixed initial and final states , @xmath99 and @xmath97 .",
    "since the probability distribution in the @xmath131-variables is gaussian , it is preferable to write @xmath90 in terms of @xmath131 , replacing @xmath90 with @xmath161 , and then perform the integration .",
    "for example , a conditional average of @xmath157 at time @xmath158 is given by , @xmath162 expanding to second order in @xmath131 , where the primes indicate derivatives over the @xmath140-variable . in the second line",
    ", we still use the bracket @xmath160 for the conditional average of the variable @xmath131 , even if its boundary values are shifted to @xmath163 .",
    "the expectation values in terms of @xmath131 can be computed using the definition of moments in the second line of eq .  .",
    "because it is a multi - dimensional gaussian integral , we find the result from wick s theorem , @xmath164 where the left hand side is an expectation value of even numbers of @xmath131 at times @xmath165 , and the right hand side is a product of @xmath166 elements of the inverse matrix @xmath167 , summing over all possible pairings between the @xmath131 s on the left side .",
    "any other statistical averages with odd numbers of @xmath131 will vanish . as an example , pairing four @xmath131-variables , @xmath168 , yields the sum , @xmath169 .",
    "standard deviation ) of the measured qubit trajectories .",
    "the preselected state ( initial state ) and the postselected state ( final state ) are @xmath170 and @xmath171 , respectively .",
    "the total time is @xmath172 .",
    "the numerical data , plotted as gray dots , are analyzed from @xmath173 trajectories computed with time steps of the size @xmath174 , zero qubit hamiltonian , and the final selection tolerance @xmath175 .",
    "the numerical data shows excellent agreement with the theoretical solutions .",
    "the three fluctuating curves are randomly chosen individual trajectories .",
    "the inset shows the average ( dashed green ) and the most likely path ( magenta ) on a bloch sphere plotted in the @xmath92-@xmath90 plane.,width=321 ]    the elements of the inverse matrix @xmath167 are of a simple form , @xmath176 for @xmath177 ( the full matrix is presented in appendix  [ app - invmatrix ] ) . knowing these matrix elements",
    ", we can then compute any expectation values of the type shown in eq .",
    ", such as a two - time correlation , @xmath178 for @xmath179 , and statistical moments of even orders of @xmath131 , @xmath180 where we have used the discrete time notation @xmath181 and @xmath182 , and the double factorial prefactor @xmath183 for a positive integer @xmath184 .",
    "this double factorial comes from the number of ways of pairing @xmath185 identical variables .    substituting these quantities into the expectation value eq .",
    ", we then obtain the preselected and postselected average of @xmath157 , @xmath186 keeping terms up to first order of @xmath187 , which is equivalent to second order of @xmath131 because the conditional average of the second order of @xmath131 scales as @xmath187 , i.e. , @xmath188 . this solution eq .",
    "is justified in a weak - coupling limit ( @xmath189 ) , however , the full solution to all orders can be computed and is presented in appendix  [ app - fullqnd ] . using the same approximation , we can also compute another interesting quantity , the variance , keeping terms up to first order of @xmath187 , @xmath190 where its full solution to all orders in @xmath187 is also presented in appendix  [ app - fullqnd ] .",
    "finally , we compute a two - time correlation in @xmath90-coordinate , keeping up to first order in @xmath187 , @xmath191 for @xmath192 , which decreases linearly in @xmath3 for a fixed @xmath158 .",
    "we show in figure  [ fig - qnd ] , the average @xmath193 , its variance , and the optimal path ( the most likely path ) @xmath194 , for the preselected and postselected trajectories , compared with data from a numerical simulation using the monte carlo method ( see appendix  [ app - numer ] for more detail ) .",
    "we generate @xmath173 trajectories with a postselection time @xmath172 , showing an excellent agreement with the analytical solutions .",
    "we have shown in the previous section that the preselected and postselected moments ( or expected values ) for quantum trajectory variables , in the plain measurement case , can be computed by expanding the path integral around its optimal path . since the action is gaussian , however , the path integral",
    "approach can be useful in other cases as well , such as to compute the moments and expectation values of qubit trajectories when there is no final state condition ( state postselection ) , or with non - zero qubit hamiltonian . in this section",
    ", we present an alternative method using a diagrammatic perturbation expansion of the action , similar to how feynman diagrams are used in computing path integrals in quantum field theory .    in the following ,",
    "we start with a brief introduction to the perturbation method ( a standard method used in quantum field theory ) and show how one can compute expectation values of system variables from moment generating functionals .",
    "we will then go on to the examples , for the case of qubit trajectories with non - zero hamiltonian and no state postselection .",
    "we note that even though most of the derivations are shown in time - continuous form for simplicity , the most straightforward derivations are in time - discretized version , and some of these are shown in appendixes  [ app - sourceterm ] and [ app - heaviside ] .",
    "let us suppose that a quantity of interest is an expectation value given in a path integral form , @xmath195 where the quantity @xmath156 is a functional of a system variable @xmath196 , the integral s action @xmath34 is a functional of the system variable @xmath196 and its conjugate variable @xmath197 , and @xmath38 is a constant normalized factor .",
    "although we are writing @xmath196 and @xmath197 as one - dimensional variables here , a generalization to arbitrary dimensional vectors is straightforward .    to compute the integral above",
    ", we write the action as a sum of two parts , @xmath198 , one being terms in the action that have bilinear forms , ( e.g. , @xmath199 ) , which we call the _ free action _ ,",
    "@xmath200 and call the rest of terms in the action the _ interaction action _ @xmath201 .",
    "we then define a free generating functional @xmath202 $ ] , a path integral of the free action adding extra source terms with functions @xmath203 and @xmath204 , @xmath205 = & \\,\\,{\\cal n}\\!\\!\\int\\!\\ ! \\mathcal{d } { x}\\mathcal{d } { \\tilde{x}}e^{{\\cal s}_f + \\int\\!\\ ! { \\mathrm{d}}t { \\tilde{x}}(t ) { \\tilde{j}}(t ) + \\int \\!\\!{\\mathrm{d}}t { j}(t ) { x}(t )   } \\\\   = & \\,\\,\\exp\\left\\{\\int \\!\\!{\\mathrm{d}}t { \\mathrm{d}}t ' { j}(t ) { g}(t , t'){\\tilde{j}}(t ' )    \\right\\},\\end{aligned}\\ ] ] where @xmath206 is an inverse of @xmath207 in eq .   satisfying @xmath208 , and we assume that the gaussian integrals in the first line produce a factor @xmath209 that leaves no prefactor in the second line .",
    "note that these integrals converge when @xmath197 is purely imaginary .",
    "moreover , if the bilinear terms are instead quadratic terms ( e.g. , @xmath210 ) , the free action will be of the form @xmath211 , and there will be only one source term @xmath212 leading to a different generating functional @xmath213 = \\exp\\left\\{\\frac{1}{2}\\int\\!\\!{\\mathrm{d}}t{\\mathrm{d}}t ' { j}(t ) g(t , t ' ) { j}(t')\\right\\}$ ] .",
    "the generating functional eq .",
    "is then used to compute a _",
    "free moment _ defined as @xmath214 .",
    "the free moment of the variable @xmath215 ( or @xmath216 ) at time @xmath217 is simply a functional derivative of the generating functional over the variable @xmath218 ( or @xmath219 ) , taking both variables @xmath220 and @xmath204 to be zero at the end . by looking at the second line of eq .",
    "( [ eq - genfunz ] ) , one can see that the simplest non - vanishing free moment is a two - point correlation function @xmath221\\big|_{{j}= { \\tilde{j}}= 0 } = g(t , t')$ ] .",
    "generalizing this to moments of multiple time points , we get @xmath222\\bigg|_{{j}={\\tilde{j}}=0},\\\\ { \\nonumber}=&\\sum_{\\substack{\\text{all pairings between}\\\\ \\text{variables $ { \\tilde x}$ and $ x$ } } } g(t_{j_{k_1 } } , t_{j_{k_2}})\\ , \\cdots \\,g(t_{j_{k_{2m-1 } } } , t_{j_{k_{2m}}}),\\end{aligned}\\ ] ] where the summation is for all possible pairings between the variables @xmath196 s and their conjugate @xmath197 s .",
    "the number of propagators in the summation on the right is equal to the number of pairs presented in the expectation bracket on the left . from this",
    ", one can see that if there is at least one unpaired variable , the moment will vanish",
    ".    using these definitions of the free moments , one can then compute a path integral as in eq .   where @xmath198 and the arbitrary functional @xmath156 is a function of the physical variable @xmath196 , @xmath223 \\rangle \\equiv & \\,\\,{\\cal n}\\!\\ !",
    "\\int   \\!\\!{\\cal d}{x}{\\cal d}{\\tilde{x}}e^{{\\cal s}_f+{\\cal s}_i[{x},{\\tilde{x}}]}{\\cal a}[{x}],\\\\ { \\nonumber}=&{\\cal a}\\left[\\frac{\\hat \\delta}{\\delta { j}}\\right]e^{{\\cal s}_i[\\frac{\\hat\\delta}{\\delta { j}},\\frac{\\hat\\delta}{\\delta { \\tilde{j}}}]}{\\cal z}_f[{j},{\\tilde{j}}]\\bigg|_{{j}={\\tilde{j}}=0},\\\\ = & \\langle { \\cal a}[{x}]e^{{\\cal s}_i[{x},{\\tilde{x}}]}\\rangle_f , \\label{eq - expa}\\end{aligned}\\ ] ] where in the second line we wrote the interaction action @xmath201 and the arbitrary functional @xmath156 as operators acting on the free generating functional @xmath224 $ ] .",
    "the perturbation expansion refers to the series expansion of the term @xmath225\\}$ ] in eq .  .",
    "in some cases , infinite series can be summed over , giving an exact analytic result , although in many others , an approximation is needed in order to truncate the series .",
    "an approximation can be made when there is a small parameter appearing in any ( or all ) of the terms in the interaction action @xmath201 , where the expansion is straightforward , keeping terms up to any desired order of the small parameter .",
    "another type of approximation , which we present here in more detail , is similar to a semiclassical expansion in quantum mechanics , keeping terms up to any order of a small parameter @xmath226 that appears as an inverse in front of the action , for example , @xmath227 \\right\\},\\end{aligned}\\ ] ] where we explicitly write the the free action in a bilinear form . to compute an expectation value of a functional @xmath156 using this action",
    ", one needs to expand the exponential of the interaction action and then evaluate the free moments in terms of the propagators .",
    "the order of expansion is controlled by the parameter @xmath226 .",
    "there is a factor of @xmath228 for every single term in the expansion of @xmath201 , and a factor of @xmath226 for every propagator that emerges .",
    "this is the basic idea behind the loop expansion in quantum theory , where @xmath226 plays the role of the @xmath229 in the feynman path integral .",
    "we will discuss more about the loop expansion in section  [ sec - smallnoiseapprox ] .",
    "this loop expansion based on the small parameter @xmath226 , in our quantum measurement case , can be considered as a small noise expansion around a saddle point solution ( a solution that extremizes the action ) . moreover , as in the feynman path integral , under the approximation of the small parameter @xmath226 , a saddle point approximation can also be applied to estimate a path integral , using an expansion of the action around the saddle point solution . for our stochastic path",
    "integral , the saddle point approximation gives an estimation of total probability density for the joint probability distribution that the path integral represents .",
    "now we can apply the perturbation approach to our quantum measurement problem .",
    "we use the joint probability density function introduced in section  [ sec - mainspi ] in its generalized form @xmath230 , a joint pdf of the measurement outcomes and the quantum states given an arbitrary set of constraints @xmath17 . statistical averages or expectation values using the joint pdf",
    "are then given in this form , @xmath231{\\mathrm{d}}[r_k ] { \\cal p}_{\\zeta}\\ , { \\cal a},\\\\ \\overset{\\delta t \\rightarrow 0}{\\approx}&{\\cal n}\\!\\!\\!\\int\\!\\!\\!{\\cal d}{\\bm q}{\\cal d } r { \\cal d}{\\bm p } \\,\\exp({\\cal s}){\\cal   a},\\end{aligned}\\ ] ] where , in the second line , we have taken the time - continuous limit and written the joint pdf in the path integral form as @xmath232 , noting that the time - continuous action is given by eq .  .",
    "in the following examples , we present the perturbative expansion approach in computing the statistical moments of qubit trajectories .",
    "we focus on the case when the qubit hamiltonian does not commute with the measurement operators ( @xmath233 ) and without a final state constraint .",
    "the theoretical setup for the qubit with rabi oscillation is analogous to the one used in ref .",
    "@xcite , where the qubit hamiltonian is @xmath234 .",
    "here we can calculate important quantities such as average trajectories and correlation functions , for the case when there is only an initial state fixed and not the final state . for simplicity of the diagrammatic expansions",
    ", we make a white noise approximation and variable transformations to the qubit system .     |",
    "cm | > m3.8cm| > m2.5 cm | type & labels of vertices & full forms & diagrams + type 1 ( initial ) & @xmath235 & @xmath236 &    ( b2 ) ; ( bp ) ; ( b2 )  ( bp ) ; ( bp ) circle ( .06 cm ) ;     + type 2 & @xmath237 , @xmath238 , @xmath239 , @xmath240 , @xmath241 , @xmath242 & @xmath243 &    ( b2 ) ; ( bp ) ; ( bpp ) ; ( c0 ) ; ( c1 ) ; ( c2 ) ; ( b2 ) ",
    "( bp ) ; ( bp)(bpp ) ; ( bp ) circle ( .06 cm ) ; ( bp ) sin ( c1 ) ; ( bp ) sin ( c2 ) ;     + type 3 & @xmath244 , @xmath245 , @xmath246 & @xmath247 &    ( b2 ) ; ( bp ) ; ( bpp ) ; ( b2 )  ( bp ) ; ( bp)(bpp ) ; ( bp ) circle ( .06 cm ) ;     +    we make an idealized white noise limit on the qubit measurement .",
    "the variance of the measurement readout distribution @xmath248 is assumed to be very broad , which in this case means @xmath249 , justifying an approximation of the two gaussian distribution in eq .   to a single gaussian distribution , @xmath250 ( see appendix  [ app - whitenoise ] for more detail ) .",
    "the measurement readout is then approximated to be its mean plus a noise , @xmath251 , where @xmath71 is the gaussian noise with variance @xmath252 , independent of the qubit state @xmath90 . because the nature of this noise is highly fluctuating , in the derivation of the state update equations , we need to keep an expansion up to a second order in @xmath70 , replacing @xmath253 @xcite .",
    "this leads to the it stochastic differential equations @xcite ,    [ eq - itoform ] @xmath254    where @xmath255 are bloch sphere coordinates for the qubit and a dephasing rate @xmath256 is now a total dephasing rate @xmath257 .",
    "the white noise @xmath71 has a gaussian probability distribution @xmath258 .    before substituting the state update above into the action of the path integral",
    ", we can make changes in the variables of the system in order to simplify the later perturbation process .",
    "this is to avoid infinite series related to the linear terms in eqs .  .",
    "we define a new set of variables @xmath259 where @xmath260 and @xmath261 is a matrix that diagonalizes the linear terms of eqs .",
    ", @xmath262 the eigenvalues are @xmath263 , @xmath264 and @xmath265 , where we define @xmath266 .",
    "the diagonalizing matrix @xmath261 and the transformation of the system variables @xmath255 are described in the matrix equation , @xmath267 which gives the following transformation : @xmath268 , @xmath269 , and @xmath270 , and the inverse transformation : @xmath271 , @xmath272 , and @xmath273 .",
    "the stochastic differential equations with this new set of variables are ,    [ eq - transformsde ] @xmath274    where we have defined @xmath275 and @xmath276 , @xmath277 , @xmath278 .",
    "now we are ready to construct the action of the path integral , substituting the update equations and the log - likelihood function @xmath279 = - \\frac{1}{2}\\xi^2 $ ] into the action eq .  .",
    "we write the action in two separated terms , @xmath198 , where    [ eq - actions ] @xmath280    are the free and interaction actions , respectively .",
    "we note that the additional term @xmath281 is not merely a time - continuous form of the first term in eq .",
    "( we only consider the initial condition ) .",
    "this is because the actual initial condition term @xmath282 can be removed simply by integrating over the initial variable @xmath16 , forcing the condition @xmath283 to the variables at time @xmath284 . in place of the initial term , when we write the free action eq .   in this form , @xmath285",
    ", there will be leftover terms which contribute to the term @xmath281 , resulting in , @xmath286 this can be easily shown with a discretized version of the path integral , which is presented in more detail in appendix  [ app - sourceterm ] .",
    "we note also that , in the rest of the paper , the time integral is always from @xmath287 to @xmath288 , unless stated otherwise .    the propagators ( or green s functions ) are computed from the inverse green s functions , which in this particular case are @xmath289 , where @xmath290 ( or @xmath291 ) for the first three terms in eq .  , and @xmath292 for the noise term .",
    "with an identity relation , @xmath293 , the propagators ( green s functions , or two - point correlation functions ) are given by ,    [ eq - propagators ] @xmath294    where @xmath295 for the first three lines .",
    "it is important to note that @xmath296 is a left continuous heaviside step function , i.e. , @xmath297 and @xmath298 , causing the two - point correlation functions for @xmath291 to vanish when @xmath299 .",
    "this is a result of the it interpretation we chose in writing the state update equation in eq .  .",
    "this can also be verified with the discretized version of the path integral and is presented in appendix  [ app - heaviside ] .",
    "to compute quantities such as an expectation value @xmath300 where @xmath156 is an arbitrary function written in the form of eq .  , one needs to expand the exponential @xmath301 in a power series of @xmath201 , and looks for terms that contribute to its result .",
    "fortunately , from the two - point correlation functions eq .",
    ", we know that system variables @xmath291 can only connect with the their conjugate variables at earlier times , e.g. , @xmath302 can only connect with @xmath303 if @xmath304 . knowing this helps predict which terms will contribute to the sum of the expansion .",
    "for example , to show that @xmath305 , we look at terms in the interaction action eq .   and see that all of them contain exactly one conjugate variable in each . looking at the propagators in eqs .  , we know that it is impossible for any higher order terms in the expansion of @xmath301 to have all conjugate variables matched with system variables at their later times . this is because every time we want to find terms with system variables at later times , there will be at least one more unmatched conjugate variable appearing .",
    "therefore , there are no other contributions apart from 1 , resulting in @xmath306 .    in order to make the calculation of moments",
    "@xmath307 more systematic , we develop diagrammatic rules to ease the process of keeping track of the perturbative expansion . each term in the expansion of @xmath301",
    "is a combination of 12 additive terms shown in the interaction action eq .  , with repeated appearance also possible .",
    "the 12 interaction terms ( _ interaction vertices _ ) are shown in table  [ tb - vertices ] with their labeling names and examples of their full integral forms , where we use the latter to characterize the vertices into three types shown as the three rows . at the end ,",
    "all combinations of the interaction vertices ( all additive terms in the expansion of @xmath301 ) are then multiplied with the function of interest @xmath156 before taking the free expectation @xmath308 .",
    "the functional @xmath156 is a function of system variables and noise variables ( i.e. , @xmath309 ) at all times .",
    "these variables are called _ ending _ vertices .",
    "let us use the word _",
    "combination _ for an individual term combining interaction vertices ( from additive terms in the expansion @xmath301 ) and the ending vertices ( from the function @xmath156 )",
    ". one can determine which combinations are non - vanishing and compute their values by following these diagrammatic rules :    * a non - vanishing combination of vertices should contain equal number of each of the system variables ( @xmath291 ) and their conjugates ( @xmath310 ) , and there should be even number of the noise variables ( @xmath71 ) . * the system variable can only be connected to its conjugate at earlier time , while the noise variable @xmath71 connects to another noise variable at the same time .",
    "the connections are presented as ` edges ' , or lines joining vertices .",
    "the number of edges for each vertex is equal to the number of variables it contains ( graphical representations are shown in table  [ tb - vertices ] , in the column of ` diagrams ' ) .",
    "a non - vanishing combination can have any number of vertices , but edges have to all be connected . *",
    "a non - vanishing combination is presented by connected diagrams with the ending vertices ( variables with their time arguments being in the range of @xmath311 $ ] ) on the most left and their time arguments clearly stated .",
    "the time ordering decreases from left to right , with variables at the same time lining up in the same vertical line , and the vertices with initial conditions ( @xmath287 ) on the most right . * a result of the free expectation value ( @xmath312 ) for each combination is computed by taking into account the constants ( i.e. , @xmath313 ) and integrals attached to each of the interaction vertices , the propagators ( the green s function ) , and the numbers of possible ways to connect diagrams . from the point of view of graphical diagrams , edges represent propagators , and points common to more than one edge correspond to integrals over time .",
    "moreover , if there are @xmath166 repeated vertices in a combination , it needs to be multiplied by a factor @xmath314 ( resulting from coefficients in the expansion of @xmath301 ) .",
    "however , these factors usually cancel with the number of possible ways to connect the repeated vertices .    )",
    "( a ) an ending vertex connects with an initial vertex ( @xmath315 ) .",
    "( b ) two ending vertices connect with two interaction vertices ( @xmath316 and @xmath317 ) .",
    "( c ) two ending vertices connect with six interaction vertices ( from left - right , top - bottom order : @xmath318 , @xmath317 , @xmath317 , @xmath319 , @xmath320 and @xmath320 ) .",
    "the unequal length of horizontal edges following the ending vertices @xmath321 and @xmath322 indicate that @xmath323.,width=219 ]    in figure  [ fig - exdiagram ] , we show examples of non - vanishing diagrams showing connections of one and two ending vertices . for each of the diagrams",
    ", we can determine its contribution by explicitly writing out its full form and computing its integrals . in the following subsections ,",
    "we present some of the calculations using these diagrams and rules to estimate statistical averages of the qubit trajectories .",
    "we note that it is also possible to construct different diagrammatic rules based on different formations of the path integrals .",
    "for example , one can perform integrals over the readout noise ( e.g. , the noise @xmath71 ) , transforming the action in eq .",
    "and to a new action that contains only the system variables @xmath324 . in this case",
    ", the diagrams will be completely different from the one we presented above , but still giving exactly the same results for the statistical quantities related to the system variables . here",
    ", we choose to present the diagrammatic rules with explicit noise variables because of the ability to compute correlation functions between the noise and the system states , as shown in section  [ sec - noisesyscorr ] .",
    "the diagrammatic rules help in determining non - vanishing terms , but we need a systematic approach to keep track of the order of expansion , especially when there are infinitely many ways to construct diagrams .",
    "we consider the small noise approximation around the saddle point solution mentioned in section  [ sec - briefintro ] . to obtain the action of the form in eq .",
    ", we introduce a small parameter denoted by @xmath226 to the noise term of eqs .  , controlling the noise variance in the qubit dynamics , leading to a modified action , @xmath325 leaving all terms in the interaction action intact .",
    "we then rescale the conjugate variables by replacing @xmath326 , @xmath327 and @xmath328 ( as well as changing variables in the source term , e.g. , @xmath329 ) , noting that the rescaling of the auxiliary variables does not affect the qubit dynamics . since all terms in the action eq .",
    ", except for the noise term , have exactly one conjugate variable ( see eqs .  ) , the resulting action is then in the desired form , @xmath330,\\end{aligned}\\ ] ] where @xmath331 are the rescaled conjugate variables .",
    "following the discussion in section  [ sec - briefintro ] and the diagrammatic rules presented in the previous section , the order of expansion can be determined by counting the number of edges and vertices of a diagram .",
    "each vertex in a diagram contributes a factor of @xmath228 to its result , while each edge ( which represents a propagator ) contributes a factor of @xmath226 .",
    "therefore , each term ( diagram ) in the expansion carries a factor of @xmath332 , where @xmath333 , @xmath334 , and @xmath335 are numbers of its external edges ( edges that connect with ending vertices ) , internal edges , and vertices , respectively .",
    "this corresponds to the loop expansion where one instead counts the number of loops from @xmath336 , which leads to another way of writing the order of the expansion @xmath337 , noting that the number of external edges @xmath333 is fixed for each set of ending vertices .",
    "we show how to count the power of @xmath226 of the diagrams shown in figure  [ fig - exdiagram ] .",
    "the numbers of edges , vertices , and loops are as follows : ( a ) @xmath338 , @xmath339 , @xmath340 , @xmath341 , ( b ) @xmath342 , @xmath343 , @xmath344 , @xmath341 , ( c ) @xmath342 , @xmath345 , @xmath346 , @xmath347 , giving the zeroth(zeroth ) , zeroth(first ) , and first(second ) orders of loop(@xmath226 ) , respectively .      as an example of how to use the diagrammatic rules to compute statistical expectation values",
    ", we show a derivation of @xmath348 , an average of the @xmath90-coordinate of the quantum trajectories . from the variable transformation in eq .",
    ", we know that @xmath349 , therefore we can write the expectation value in terms of the free moments and then compute the diagrams from the vertices in table  [ tb - vertices ] , @xmath350 \\coordinate[label = below:$v_t$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$p_{v0}$ ] ( bp ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw ( bp ) circle ( .06 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\end{tikzpicture}\\ , + \\,\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate[label = below:$w_t$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$p_{w0}$ ] ( bp ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw ( bp ) circle ( .06 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\end{tikzpicture},\\\\ { \\nonumber}=&\\left\\langle { v}(t)\\,{v}_i \\!\\!\\!\\int \\!\\!\\!{\\mathrm{d}}t'\\ , { p_v}(t')\\delta ( t ' ) \\right\\rangle_f \\\\ & { \\nonumber}+ \\left\\langle { w}(t)\\,{w}_i \\!\\!\\!\\int \\!\\!\\!{\\mathrm{d}}t'\\ , { p_w}(t')\\delta ( t ' ) \\right\\rangle_f,\\\\ { \\nonumber}= & \\,{v}_i \\!\\!\\ ! \\int \\!\\!{\\mathrm{d}}t ' g_{{v}}(t ,",
    "t')\\delta(t')+{w}_i \\!\\!\\!\\int\\!\\ ! { \\mathrm{d}}t ' g_{{w}}(t , t')\\delta(t ' ) , \\\\",
    "= & \\ , { v}_i e^{{\\lambda}_2 t } + { w}_i e^{{\\lambda}_3 t } , \\quad \\text{where   $ t \\ge 0$},\\end{aligned}\\ ] ] where the green s functions are from eqs .  .",
    "from the types of vertices in table  [ tb - vertices ] , there is only one possibility connecting the ending vertices @xmath351 and @xmath352 with @xmath315 and @xmath320 , respectively .",
    "this is because choosing other vertices will lead to at least one unmatched noise variable @xmath71 , which , when trying to pair it with another vertex containing @xmath71 , will result in more unmatched conjugate variables .    as a result , the expectation value eq .",
    "is explicitly found by transforming back to the system variables @xmath255 , @xmath353 which is exactly the same as the solution we would get from averaging over all possible noise realizations in the it stochastic master equations in eqs .   and solving for an average of @xmath354 .",
    "the averages of @xmath92 and @xmath93 can be computed in the similar way .",
    "we note that the exact solution for the average trajectory involves only the diagrams with zeroth order of the small parameter @xmath226 ( @xmath355 ) .",
    "particularly , one can show that the average trajectory coincides with a saddle point solution of the action eq .   when @xmath356 .",
    "the vanishing functional derivatives of the action over the variables @xmath331 gives the exact same equations eqs .",
    "( though , the noise variable @xmath71 is no longer a stochastic function ) , while the vanishing functional derivatives over @xmath357 leads to the differential equations for conjugate variables ,    [ eq - saddlepointp ] @xmath358    where the noise variable is now a solution of extremizing the action over @xmath71 giving , @xmath359 as the noise parameter @xmath226 decreases to zero , as does the noise term @xmath71 , the ordinary differential equations of @xmath357 are uncoupled from eqs .   and their solution ( a saddle point solution ) is then the same as the average trajectory , the solution of eqs .   when @xmath360 .",
    "another example is a correlation function between the system variable @xmath90 and the noise variable @xmath71 , given by @xmath361 .",
    "since there are now two ending vertices , the situation is more complicated and there are infinitely many ways to connect the diagrams .",
    "however , we can compute terms to the lowest order of the loop expansion , which in this case is the zeroth loop ( tree - level diagrams )",
    ". there are in total six contributions to the correlation function , as shown in the following , @xmath362 \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of b2,label = above:$v_{t_1}$](a1 ) ; \\coordinate[above = of bp , label = above:$p_{v}$](ap ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+ \\!\\!\\!\\!\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$v$ ] ( ap ) ; \\coordinate[left = of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture}+ \\!\\!\\!\\!\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$w$,label = above:$v$ ] ( ap ) ; \\coordinate[left = of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$w_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture}\\\\ { \\nonumber}&+\\!\\!\\!\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of b2,label = above:$w_{t_1}$](a1 ) ; \\coordinate[above = of bp , label = above:$p_{w}$](ap ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+\\!\\!\\!\\ !",
    "\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$w$,label = above:$w$ ] ( ap ) ; \\coordinate[left = of ap , label = above:$w_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$w_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$w_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture}+",
    "\\!\\!\\!\\!\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate [ ] ( b2 ) ; \\coordinate[right = of b2,label = left:$\\xi_{t_2}$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$w$ ] ( ap ) ; \\coordinate[left = of ap , label = above:$w_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$w_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( bp ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture},\\\\ { \\nonumber}= & \\,\\kappa_2 \\!\\!\\int \\!\\!{\\mathrm{d}}t ' g_{{v}}(t_1,t ' ) g_{\\xi}(t',t_2)\\\\ { \\nonumber}&+\\alpha { v}_i^2\\!\\ ! \\int\\!\\ ! { \\mathrm{d}}t ' g_{{v}}(t_1 , t')g_{\\xi}(t',t_2)g_{{v}}(t ' , 0)^2 + \\cdots,\\\\ { \\nonumber}=&\\ , e^{{\\lambda}_2 t_1}\\left(\\kappa_2 e^{-{\\lambda}_2 t_2}+\\alpha { v}_i^2 e^{{\\lambda}_2 t_2}+\\alpha { v}_i { w}_i e^{{\\lambda}_3 t_2}\\right)\\\\ & + e^{{\\lambda}_3 t_1}\\left(\\kappa_3 e^{-{\\lambda}_3 t_2}+\\alpha { w}_i^2 e^{{\\lambda}_3 t_2}+\\alpha { v}_i { w}_i e^ { { \\lambda}_2 t_2}\\right),\\end{aligned}\\ ] ] where the superscript @xmath363 in the first line indicates the number of loops in the expansion , and , in the third line , we show only the integral form of the first two diagrams .",
    "this result involves diagrams with first order of the small noise parameter @xmath226 .",
    "the definitions of the parameters such as @xmath364 are defined in the discussion of eqs .  - .",
    "we note that this result eq .",
    "is valid for @xmath304 and it is zero otherwise , because of the special properties of the left continuous heaviside step function @xmath296 .",
    "this can be interpreted as the noise being correlated with the qubit state at later times but not with the state at earlier times .",
    "this property of the system variable and noise the correlation function is also mentioned in ref .",
    "@xcite .",
    "let us next consider correlation functions between system variables at two points in time , such as @xmath365 and @xmath366 . both of them can be written in terms of correlation functions between the transformed system variables @xmath367 , for example , the @xmath90-@xmath90-correlation is , @xmath368 . as in the previous example ,",
    "we keep terms up to the lowest order of loops , which is the zeroth order .",
    "each term of the correlation functions , for example @xmath369 , involves 10 different diagrams , thus there are in total @xmath370 diagrams for computing the @xmath90-@xmath90 correlation function .",
    "we present in the following three samples of diagrams and their integral forms for the correlation function @xmath371 , @xmath372 \\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$p_{v0}$ ] ( bp ) ; \\coordinate[above = of b2,label = above:$v_{t_1}$](a1 ) ; \\coordinate[above = of bp , label = above:$p_{v0}$](ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw ( bp ) circle ( .06 cm ) ; \\draw ( ap ) circle ( .06 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$p_v$ ] ( bp ) ; \\coordinate[above = of bp , label = above:$p_v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+",
    "\\,\\,\\begin{tikzpicture}[node distance=0.6 cm and 0.8 cm ] \\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$p_v$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture}\\\\ { \\nonumber } & + \\text{(7 more similar diagrams)},\\\\ { \\nonumber}= & \\,\\la { v}(t_1 ) \\ra \\la { v}(t_2 ) \\ra \\\\ { \\nonumber}&+\\kappa_2 ^ 2\\!\\ ! \\int\\!\\ ! { \\mathrm{d}}t ' { \\mathrm{d}}t '' g_{{v}}(t_1 , t')g_{{v}}(t_2 , t'')g_{\\xi}(t ' , t'')\\\\ { \\nonumber}&+\\alpha \\kappa_2 { v}_i^2 \\!\\!\\int\\!\\ ! { \\mathrm{d}}t ' { \\mathrm{d}}t''\\big\\{g_{{v}}(t_1,t')g_{{v}}(t_2,t'')\\\\ & \\qquad \\quad g_{\\xi}(t ' , t'')g_{{v}}(t',0)g_{{v}}(t',0)\\big\\ } + \\cdots,\\end{aligned}\\ ] ] where , apart from the first trivial diagram , each initial vertex ( @xmath373 or @xmath374 ) can connect to three possible interaction vertices ( @xmath245 , @xmath239 , or @xmath240 ) . as a result , there are total of @xmath375 possible ways , and they are presented in appendix  [ app - fullform ] ( all diagrams except the first one are of the first order of @xmath226 ) . the similar kind of calculation is applied to the other correlation functions @xmath376 , @xmath377 and @xmath378 .",
    "the correlation function between @xmath93 and @xmath90 can be calculated in a similar way , with the same types of diagrams , but with extra prefactors @xmath379 and @xmath380 , @xmath381 where the coefficients @xmath382 and @xmath383 come from the transformation of variables shown in eq .  .",
    "we compare the theoretical results , specifically the @xmath90-@xmath90 correlation computed in the previous section , with numerically simulated quantum trajectories .",
    "although , the solution of @xmath365 is not explicitly presented here in this paper , as it is too lengthy , it can be computed in a similar way as shown in eq .   and also",
    "in appendix  [ app - fullform ] .",
    "we show in figure  [ fig - corrlimit](a ) and [ fig - corrlimit](d ) sampled individual trajectories generated from the monte carlo method ( appendix  [ app - numer ] ) , in the regime where @xmath384 .",
    "the theoretical variances are computed from the @xmath90-@xmath90 correlation function , and they are shown in panels ( b ) and ( e ) along with the variances from the numerical trajectories . in the top panel , for efficient detection @xmath385 , the numerical variance increases in time and gets saturated ( not shown ) at around a value of @xmath386 for a long enough time , indicating that the qubit states at the later times are distributed throughout the perimeter of the @xmath93-@xmath90 plane of the bloch sphere .",
    "the variance from the tree - level diagram approximation fails to exactly capture the long - time behaviour , as we can see that the discrepancy in the panel ( b ) starts to grow as time increases .",
    "however , for the inefficient detection case , @xmath387 in figure  [ fig - corrlimit](e ) , we can see that the theoretical approximation can explain the behaviour quite well , predicting the saturated variance at a value of @xmath388 . to compute this quantity theoretically ,",
    "one takes a limit @xmath389 of the calculated variance @xmath390 .    for the correlation function at two different times ,",
    "we define a covariance as @xmath391 \\equiv \\langle z(t_1)z(t_2 ) \\rangle - \\langle z(t_1 ) \\rangle \\langle z(t_2 ) \\rangle$ ] , and show in figure  [ fig - corrlimit](c ) and [ fig - corrlimit](f ) its numerical and theoretical comparisons .",
    "we plot the covariance for @xmath392 and @xmath393 where @xmath394 has its value ranged from @xmath395 to @xmath396 . for the efficient detection case , shown in the panel ( c ) ,",
    "the agreement between the theory and the simulation is better for the short time case , @xmath397 . for the inefficient detection case , panel ( f ) ,",
    "the agreement is excellent for both @xmath398 and @xmath399 .",
    "since our theoretical results are derived with the small noise expansion around the saddle point solution ( or the average solution , see section  [ sec - averagesol ] ) using @xmath226 as an expansion tracking parameter , the diagrammatic approximation method works well whenever the qubit trajectories are narrowly distributed around its average .",
    "this happens in the short - time regime when the diffusion is still small from the initial state , as well as in the regime when the dynamics is strongly suppressed by the dephasing mechanism ( when the detection efficiency is low ) .",
    "we note that for the long - time limit , one needs to compute higher order terms which contain more complex diagrams .",
    "however , there are other approaches , such as using the qubit master equation to approximate the correlation functions in the stationary limit and calculate spectral densities of the measurement readouts .",
    "these can be found in the works on continuous measurement of mesoscopic electronics such as in refs .",
    "@xcite . comparing to these approaches ,",
    "our results give much more accurate correlation functions at short times .",
    "we can extend the discussion of the stochastic path integral formalism to its application to the system under continuous measurement with feedback control .",
    "the feedback loop consists of getting information about the system state via the measurement , and feeding back a control signal to the system in order to alter the state as desired .",
    "one of the most intuitive models of the feedback loop is that the system hamiltonian changes as a function of the system state , which then can be written as a function of the most recent measurement readout .",
    "for example , in our qubit measurement case , taking into account additional time delay @xmath400 , the hamiltonian at any time @xmath217 can be written as a function of the measurement readout in the past , @xmath401 , where the parameters @xmath101 and @xmath402 , as defined in section  [ sec - qubit ] , are now functions of the measurement readout @xmath403 at time @xmath404 .",
    "we consider an ideal case with instantaneous feedback @xmath405 , i.e. , the measurement readout at time @xmath217 immediately changes the system parameters which are used in computing the state update at the time .",
    "this way , the formulation of the stochastic path integral as time - local , its action s extremization equations , and the diagrammatic expansion we presented so far are perfectly applicable .",
    "the only modification needed is to treat the readout - dependent hamiltonian parameters as functions of @xmath406 such as @xmath407 and @xmath408 ( or as functions of the quantum state at the time ) . in this section",
    ", we present a few examples of the continuous measurement of a qubit with feedback , one with a linear feedback in the form @xmath409 , and another with a state - dependent linear feedback to stabilize a qubit s oscillation .",
    "let us consider an instantaneous feedback loop in a qubit measurement introduced in section  [ sec - qubit ] , with @xmath410 and the qubit rabi frequency being a function of the measurement readout .",
    "we assume a linear form of the rabi frequency as @xmath411 where @xmath406 is the readout as a function of time and @xmath412 are constant parameters characterizing the bare rabi oscillation and the linear feedback , respectively .",
    "we will see later in this subsection that this type of feedback can stabilize pre - determined ( arbitrary ) quantum states .",
    "this feedback loop in eq .   has the advantage of fast processing because the qubit hamiltonian depends directly on the value of the measurement readout , requiring no knowledge of the qubit state .",
    "for simplicity , we limit our discussion to an ideal case in which the qubit is measured with an efficient detector and no extra environment dephasing . in this regime , we can re - parametrize the qubit bloch vector into a single state parameter @xmath413 where @xmath414 and @xmath415 ( we set @xmath416 in this case ) .",
    "we note that , with this linear feedback eq .  , a typical step size for the qubit state defined as @xmath417 has average drift @xmath418 and diffusion @xmath419 of the first order of the time step .",
    "thus , the step size is still small .",
    "the statistics of quantum trajectories with this instantaneous feedback can be investigated following the same procedure presented in previous sections for the no - feedback qubit measurement .",
    "we start with writing the joint probability distribution of the trajectories , and then transform it into a path integral form .",
    "the action of the stochastic path integral with the feedback rabi frequency @xmath420 is given by , @xmath421 where @xmath422 , @xmath413 , and @xmath94 are functions of time , omitting the time argument .",
    "this is a generalization of the action given in ref .",
    "@xcite where the quantum jump in qubit measurement is analyzed .",
    "we note here that in eq .  , we have chosen to use the @xmath70-expansion in both the state update and the readout probability distribution , because we are interested in investigating the action - extremized solutions , the optimal paths of the system .",
    "the optimal paths of the action in eq .   are obtained by extremizing the action over all variables @xmath422 , @xmath413 , and @xmath94 , leading to two ordinary differential equations and one constraint ,    [ eq - fbodes ] @xmath423    with arbitrary boundary conditions on the variable @xmath413 and @xmath422 .",
    "the solutions of these equations are the most likely paths of the system . by writing the action in the form @xmath424)$ ] , where @xmath425 is a _",
    "stochastic hamiltonian _",
    ", we can examine the most likely paths by using phase space analysis  @xcite , motivated by the phase space concept in classical mechanics . substituting the @xmath94 constraint in eqs .   into the action ( equivalent to integrating the path integral over the variable @xmath426 )",
    ", we obtain the action and the stochastic hamiltonian in terms of only the system variable @xmath413 and its conjugate @xmath422 , @xmath427 this quantity is explicitly time - independent and so it is a constant of motion for the most likely path , a solution of the ordinary differential equations in eqs .",
    "let us define the stochastic energy @xmath428 , and then solve for the conjugate variable @xmath429 as a function of @xmath413 and @xmath333 from eq .  .",
    "each value of @xmath333 will then correspond to a curve in the phase space portrait , describing dynamics of the most likely paths , the same way the individual classical trajectories are depicted as constant - energy curves on a phase space plot .    as an example , we show in figure  [ fig - phasespace](a ) the phase space portrait for the pure linear feedback case ( i.e. , @xmath430 ) , where we plot the conjugate variable @xmath422 as a function of @xmath413 , @xmath431 for different values of @xmath333 .",
    "this is an interesting case .",
    "we can see from the phase space plot in figure  [ fig - phasespace](a ) that there exists some attractors to which all states eventually limit to .",
    "these attractors coincide with the divergence of the conjugate variable @xmath429 in eq .  , and also appear as stationary points where @xmath432 in eqs .  .",
    "solving these equations , we obtain the attractors are located at @xmath433 and @xmath434 where @xmath435 is an even integer .",
    "these attractors may be interpreted as stabilized states achieved by turning on a linear feedback @xmath436 and turning off the bare qubit frequency @xmath437 .",
    "they are effectively the new collapse points , rather than at the poles of the bloch sphere , i.e. , @xmath438 ( @xmath439 ) . considering only angles between @xmath395 and @xmath440 , for the positive feedback @xmath441 , as @xmath442 increases from zero , the stabilized states @xmath443 move from @xmath395 and @xmath444 toward each other and coalesce at @xmath445 when @xmath446 ; whereas in the negative feedback @xmath447 , as @xmath442 grows , the stabilized states move toward each other in the region of @xmath444 and @xmath448 and coalesce at @xmath449 when @xmath450 .",
    "we simulate numerical qubit trajectories using the monte carlo method ( appendix  [ app - numer ] ) , showing that individual trajectories initialized at different states are eventually pinned to the stabilized states as predicted from the most likely path phase space .",
    "this is shown in figure  [ fig - phasespace](b ) for three different initial conditions , along with their most likely paths .      in this subsection , we show an example using the path integral to compute a correlation function for a system with linear feedback loop . the feedback loop of this example resembles the one used in the solid - state qubit measurement in ref .",
    "@xcite which has been adapted and realized in the transmon qubit experiment  @xcite .",
    "the theoretical setup is an oscillating qubit ( a double quantum dot ) continuously monitored by a near quantum - limited detector ( a quantum point contact ) , of which the hamiltonian and the measurement operator are in the same form as presented in section  [ sec - qubit ] .",
    "we as before consider the ideal symmetric qubit case where @xmath410 , and the qubit is measured with an efficient detector with no extra environment dephasing .",
    "the qubit state is represented by a single parameter @xmath413 where @xmath451 and @xmath452 . the stochastic master equation for the qubit state , in the @xmath70-expansion similar to eqs .",
    "( stratonovich form , as discussed in ref .",
    "@xcite ) , is given by , @xmath453 where @xmath413 and @xmath71 are functions of time and @xmath454 is the feedback rabi frequency , which is assumed to be a function of the qubit state @xmath413 .",
    "we later neglect the second term on the right side of eq .   because we consider a diffusive rabi limit @xmath455 .",
    "the feedback protocol considered in this subsection ( and also in ref  @xcite ) is a linear feedback designed to stabilize the quantum oscillation of the qubit state , against the random phase kicks due to the measurement .",
    "the desired qubit evolution is described by @xmath456 and @xmath457 where we define @xmath458 as the target oscillation frequency .",
    "the difference between the actual phase @xmath413 and the target phase @xmath459 , denoted as @xmath460 , is used to control the oscillating part of the qubit hamiltonian .",
    "therefore , we write the feedback rabi frequency as , @xmath461 , where @xmath462 is the dimensionless feedback factor .",
    "this feedback loop continuously corrects the random changes of the state made by the measurement so that the outcome trajectory closely follows the desired qubit oscillation .",
    "let us assume that the phase difference @xmath463 is a slowly changing variable as compared to the oscillation with the desired frequency @xmath458 .",
    "therefore , we can average the fluctuating process described in eq .   over the oscillation period @xmath464 , taking @xmath463 to be constant during this period",
    ". the period @xmath465 will eventually be our new time scale .",
    "we define a new noise @xmath466 as a time - average of the last term of eq .   over the oscillation period , @xmath467 with its zero ensemble average @xmath468 and its variance being @xmath469 .",
    "we then can simplify the differential equation eq .   to one in terms of the phase difference @xmath463 , @xmath470 with the new time scale @xmath465 .    here",
    "we will use the above differential equation eq .   to compute a correlation function @xmath471 using the path integral approach .",
    "following the derivation of the action in eq .   and where @xmath472 and @xmath473 are now our new system variable and a noise probability density function , we obtain the action in this form , @xmath474 omitting the boundary terms .",
    "note that we have written the pure imaginary conjugate variable ( @xmath475 ) explicitly with @xmath476 .",
    "as before , we can compute an average quantity by integrating the paths @xmath477 .",
    "so , we first write the correlation function @xmath478 in terms of the phase difference @xmath463 , then average over the oscillation period @xmath465 , getting rid of the fast fluctuating parts , and we are left with @xmath479\\ra \\cos ( \\delta_d \\tau)/2 + \\sin[\\delta \\theta(t)-\\delta \\theta(t+\\tau)]\\ra \\sin ( \\delta_d \\tau)/2 $ ] . the correlation function apparently can be written in terms of the real part and imaginary part of the following quantity , @xmath480 where we have used the same notations , such as @xmath481 for the integral over all possible paths @xmath482 , and @xmath38 for a normalized factor .    the gaussian integral over @xmath466 in eq",
    "is quite straightforward resulting in a bilinear term in @xmath483 , which then leads to another gaussian integral of @xmath483 .",
    "as one would expect , these integrals generate another prefactor that cancels the normalized factor @xmath38 .",
    "consequently , the last integral over @xmath463 is left as @xmath484 where the exponent @xmath485 is given by , @xmath486 this effective action can be transformed further using the integration by parts , for example , @xmath487 , assuming that the boundary conditions for @xmath463 at both end points vanish .",
    "we then write the action in terms of the inverse green s function and the source term as discussed in section  [ sec - briefintro ] , @xmath488 where the inverse green s function , the green s function , and a particular form of the source term are given by , @xmath489    performing the last gaussian functional integral over @xmath463 gives , @xmath490 for the positive value of the time difference @xmath394 .",
    "this quantity is a real number , therefore we obtain the correlation function , @xmath491 assuming that @xmath492 .",
    "this result agrees with the solution found in ref .",
    "@xcite which is presented in different notation .",
    "we have developed and extended the stochastic path integral technique to study statistical behaviour of a quantum system under weak continuous measurement , as well as measurement with feedback , presented with several qubit examples .",
    "the path integral approach is constructed based on the joint probability distribution of the measurement records , which is then extended to the distribution of quantum states , describing all possible quantum trajectories .",
    "we have shown that with this path integral and its action formalism , the optimal dynamics , such as the most likely paths , can be obtained naturally from the extremization of the action , whereas other statistical quantities can be achieved from direct integration or perturbation theory . in the case of plain measurement of a qubit",
    ", we have derived analytic solutions for the average trajectory , the variance , and the correlation functions conditioning on the fixed initial and final states , which show an excellent agreement with the numerically simulated data .",
    "we have also presented a diagrammatic perturbation method used in computing expectation values and correlation functions of quantum trajectories , and elaborated it with examples of the qubit with rabi oscillation case .",
    "the variances and multi - time correlation functions of qubit trajectories in the short - time regime have been revealed using this method given initial conditions , and the results are in good agreement with the numerical simulation .",
    "moreover , we have considered quantum measurement with feedback control , using the action principle to investigate the dynamics of the most likely paths of a qubit with linear feedback on its oscillating frequency .",
    "we have discovered that the direct linear feedback , manipulating the qubit hamiltonian instantly using the measurement readout , can stabilize the qubit state to arbitrarily chosen pure states .",
    "we have also considered the example of the feedback loop stabilizing the qubit rabi frequency introduced in ref .",
    "@xcite , and we have computed the correlation function for the qubit trajectory using the path integration method .",
    "so far , the stochastic path integral formalism in the context of continuous quantum measurement has been proven to be useful in studying the statistics of quantum trajectories ; however , there are some unsolved issues that need to be further explored .",
    "one is the limitation of the statistical average solutions derived from the perturbation expansion theory .",
    "only the first few orders of the expansion have been computed , resulting in the solutions that are valid only in the certain parameter regimes .",
    "we hope to find solutions in an arbitrary regime , possibly with some modifications of our approach .",
    "another issue is the assumption of the instantaneous feedback , which can be difficult to realize in experiments .",
    "feedback loops modelled with time delays will be taken into account in future work .",
    "we thank j. dressel for discussions , helpful comments on the manuscript , and for collaborating in our first paper on this subject @xcite .",
    "we thank i. siddiqi and s. g. rajeev for discussions .",
    "this work was supported by us army research office grants no .",
    "w911nf-09 - 0 - 01417 and no .",
    "w911nf-15 - 1 - 0496 , by national science foundation grant dmr-1506081 , by john templeton foundation grant i d 58558 , and by development and promotion of science and technology talents project thailand .",
    "there are interesting comparisons between the path integral formalism we introduced in the main text and other path integral approaches built upon feynman path integral in quantum mechanics @xcite .",
    "as we have shown , our formalism is aimed at describing the probability distribution of quantum trajectories , paths of state of a system under continuous measurement , on its quantum state space ( such as hilbert space for pure states ) .",
    "each individual quantum trajectory in the path integral is realizable and tractable , as demonstrated experimentally , such as , in solid - state systems @xcite .",
    "however , for other path integral formalisms developed from the feynman path integral to investigate quantum systems under measurement @xcite , the evolution of the quantum state ( or wavefunction ) is based on interference of all possible classical paths in measurable configuration space ( such as the system s positions or spin states ) .",
    "thus , in this latter case , the integrations are over configuration coordinates of the measured system .    despite the differences in forms , the two approaches mentioned above can be related .",
    "the path integral via feynman s concept can be used to compute the probability distribution of the measurement results , which is then , as shown in the main text , one of the most important ingredients in constructing our stochastic paths in quantum state space . to elaborate this connection in more detail",
    ", we consider the path integral method presented by caves @xcite , for measurements providing information about the position @xmath493 of a nonrelativistic , one - dimensional quantum system , evolved in time . in that approach ,",
    "the effect of measurements is to restrict the sum over paths by weighting each path differently depending on the measurement results .",
    "these weights appear in the path integral in ref .",
    "@xcite as the ` resolution amplitude ' , @xmath494 , which also accounts for the imprecision of the measurements .",
    "let us assume instantaneous position measurements that are equally distributed in times , at @xmath495 where @xmath496 , giving measurement readouts denoted by @xmath497 . the joint probability amplitude @xmath498 of the measurement records , and",
    "that the system is at @xmath499 at time @xmath500 , given an initial wavefunction @xmath501 , is in this form , @xmath502 where the position coordinates are denoted by @xmath503 at time @xmath504 , and the integral measure is defined as @xmath505 .",
    "we note here that we have modified the ordering of the measurements from the original version by caves , in which he assumed that the measurements start only after the initial state has evolved for time @xmath70 .",
    "we assume that this change has an infinitesimal effect on the probability amplitude as @xmath60 .",
    "the first bracketed term on the right hand side of eq .   describes the influence of the measurement . without it , the path integral will be the usual feynman path integral , exactly equal to @xmath506 or the wave function at the final time @xmath150 .    from eq .",
    ", the joint probability distribution function ( pdf ) of the sequence of measurement readouts can be obtained by integrating the square of the probability amplitude over the final coordinate @xmath499 , @xmath507 given the initial wavefunction @xmath501 .    in order to see that this joint pdf in eq .",
    "is the same as what we have earlier in the main text ( in this special case ) , we first rewrite this term @xmath508 as a probability amplitude right after one measurement ( @xmath509 ) and one unitary transformation ( @xmath510 ) .",
    "then , we obtain a probability density function for the first measurement outcome as @xmath511 .",
    "we further introduce an updated wavefunction @xmath512 , a result of a state @xmath513 that has gone through one measurement @xmath514 and one unitary transformation @xmath510 , @xmath515 where the denominator assures the correct norm of the wavefunction .",
    "then , the joint distribution of the measurement readouts of the first two times is given by @xmath516 .",
    "repeating this procedure further to the next measurement readouts @xmath517 , at the end , we obtain the full joint pdf , @xmath518 as a product of the conditional probability density functions , defined in a general form as @xmath519 .",
    "this is the joint pdf of the measurement readouts , the main component of the joint pdf in eq .  .",
    "to obtain an analogous form of the joint pdf in eq .  , we add probability density functions of the quantum state ( or wavefunction ) as delta functions to every single time step .",
    "we obtain the full joint pdf , @xmath520 where the update state in this case is written as @xmath521 as in eq .  .",
    "the integer @xmath6 is the dimension of the vector @xmath522 ( which maybe generalized to infinite dimension via a functional form of the @xmath523-function ) , and @xmath524 is called a joint probability density function of the measurement outcomes @xmath525 and the wavefunctions @xmath526 of the measured system .",
    "we note that our path integral presented in the main text deals with mixed states instead of pure states , and the system we consider is the qubit ( or spin ) system with the discrete basis , i.e. , @xmath527 . therefore , the operator @xmath514 in the discussion above is equivalent to what we have as the measurement operator @xmath528 , defined in section  [ sec - qubit ] , and the resolution function is a gaussian function , @xmath529 for @xmath530 and @xmath531 .",
    "it is also worth mentioning that in our approach , the stochastic trajectories in quantum state spaces can be thought of as classical trajectories in configuration space , such as trajectories on the bloch sphere can be considered as three - dimensional random walks in a unit - radius sphere .",
    "then , one could find connections between our path integral and the formalism in classical stochastic processes , such as the pilgram - sukhorukov - jordan - bttiker path integral @xcite , the martin - siggia - rose formalism , the wiener integral , or feynman - kac path integral ( see eqs .",
    ", , and ) , however , we do not cover the discussion in this paper .",
    "we show the derivation here , how the action in eq .   can be written in this form , @xmath532 = { \\cal s}[\\bar{u } ] - \\frac{\\tau_m}{2 \\delta t } \\sum_{k=0}^{n-1}(\\eta_{k+1}-\\eta_k)^2,\\end{aligned}\\ ] ] where @xmath533 is the optimal path , extremizing the action @xmath128 $ ] .    to see this",
    ", one can taylor expand the action eq .   in discrete forms , such as @xmath128 = { \\cal s}[\\bar{u } + \\eta ]",
    "= { \\cal s}[\\bar{u } ] + { \\cal s}'[{\\bar u}]\\eta + \\frac{1}{2}{\\cal s}'[{\\bar u}]\\eta^2 + o(\\eta^3)$ ] , and show that higher order terms vanish ( @xmath534 ) .",
    "however , there is a simpler way to see this , using the action in a continuous form , @xmath535 which is the same action as in eq .  , with definitions of the time integral , @xmath536 , and the derivative , @xmath537 . in this form",
    ", one can see that the last two terms in the action can be integrated easily .",
    "the second term can be written in this general form , @xmath538 where @xmath539 . the contribution of this term to the action is only dependent on the boundary terms .",
    "therefore , we can write the last two terms in eq .   as equivalent to @xmath540 .    after this simplification , the first term in eq .",
    "can be written as @xmath541 , performing the integration by parts giving @xmath542 .",
    "the action is then given by , @xmath532 = { \\cal s}[{\\bar u } ] - \\frac{\\tau_m}{2}\\!\\!\\ ! \\int \\!\\!\\ !",
    "{ \\mathrm{d}}t \\,{\\dot \\eta}(t)^2,\\end{aligned}\\ ] ] where , @xmath543 = -   \\int_0^t \\!\\!\\!{\\mathrm{d}}t \\left\\ { \\frac{\\tau_m}{2 } { \\dot { \\bar u}}(t)^2 -   \\tanh { \\bar u}(t ) { \\dot { \\bar u}}(t ) + \\frac{1}{2 \\tau_m } \\right\\},\\end{aligned}\\ ] ] is the action in terms of the optimal solution @xmath544 .",
    "we show here the inverse of the matrix @xmath144 in eq .  , assuming that it is a square matrix with @xmath6 dimensions .",
    "the inverse matrix @xmath167 is given by , @xmath545 where the diagonal elements are of the form @xmath546 , where @xmath547 , and the other off - diagonal elements are @xmath176 for @xmath177 as verified by direct calculation .",
    "the solutions of the preselected and postselected average and variance in @xmath90 to infinite order are shown here .",
    "the average is given in terms of the infinite summation as , @xmath548 where the differentials in the bracket are evaluated at the optimal path @xmath533 .",
    "similarly , the variance is given by , @xmath549 the average @xmath550 are given explicitly in eq .",
    "in the main text .",
    "the numerical data presented in figure  [ fig - qnd ] , [ fig - corrlimit ] and [ fig - phasespace ] are from the simulation of quantum trajectories using monte carlo method . the numerical trajectories are generated in @xmath0-discrete steps of @xmath70 .",
    "starting from an initial state @xmath16 , each step , we randomly generate a measurement readout from a distribution , for example , @xmath551 , and compute a quantum state from the update equation @xmath552 $ ] ( or @xmath109 $ ] ) , repeating the procedures from @xmath553 to @xmath28 to get a full trajectory @xmath554 .    in figure  [ fig - qnd ]",
    ", we simulate the data using @xmath555 time steps , with the step size @xmath556 and @xmath557 . in figure",
    "[ fig - corrlimit ] , we use @xmath558 , @xmath559 , and @xmath560 , where the rabi frequency @xmath402 is set to @xmath448 .",
    "we note that in the main text we present these numbers in the unit of @xmath80 .    for the data presented in figure  [ fig - phasespace ] , where the rabi oscillation is linearly dependent on the highly fluctuating measurement readouts , the state update equation needs to be modified to minimize numerical errors in each time step of the calculation .",
    "the update state is then computed from @xmath561 $ ] , where the measurement operator @xmath562 and unitary operator @xmath563 are each divided into 10 pieces and are operated onto the qubit state @xmath564 alternately .",
    "we simulate the data using @xmath565 time steps , with the step size @xmath559 and @xmath557 .",
    "the feedback rabi oscillation is @xmath566 , where @xmath2 is a generated measurement readout at time @xmath3 .",
    "in the main text , the state updating procedure is based on the assumption that a measurement outcome is randomly generated from a readout distribution @xmath19 , which is a function of a state right before the measurement .",
    "however , in the limit when the measurement readout is highly fluctuating , for example , the standard deviation of the readout distribution is much larger than the measurement response , @xmath567 , we can approximate the readout as a sum of two parts , one being its average ( which is related to the measured system state ) and another being a zero - mean independent fluctuating noise . following the readout distribution in eq .  , the average of the readout at a time @xmath3 is exactly @xmath568 , therefore , we write @xmath569 where @xmath570 is a zero - mean gaussian white noise .",
    "the next step is to find a probability distribution for the independent noise @xmath570 , which we then approximate as having the same variance as the original distribution , which in this case the variance is @xmath571 .",
    "this approximation is valid as long as the variance is much larger than the separation between two outcomes @xmath572 and @xmath573 . a more rigorous proof can be done by writing @xmath574 where @xmath71 is a gaussian white noise with variance @xmath252 .",
    "note that @xmath71 is the time - derivative of the wiener increment , scaling as @xmath575 ( it calculus ) @xcite , therefore , in any expansion , we need to keep terms containing @xmath576 . using these rules",
    ", we can write , @xmath577 where these two equations are exactly equal in the expansion up to the first order of @xmath70 .",
    "the second line confirms that the distribution of @xmath570 is gaussian with the same variance @xmath571 and the mean @xmath123 .",
    "let us assume that @xmath92 is the only system variable we consider , where an update equation is written as @xmath578 and the probability density function for a measurement readout is proportional to @xmath579 .",
    "we then write the action for this system as , @xmath580 where @xmath184 is the conjugate variable . in this case",
    ", we could write the first term , @xmath581 , where @xmath582 , however , the matrix @xmath583 would not be a square matrix , and its inverse is not simply defined .",
    "therefore , we separate out one term , @xmath584 , from the sum , which symmetrizes the double sum , @xmath585 resulting in a square matrix @xmath586 , @xmath587 with the row index , @xmath588 to @xmath28 , and the column index , @xmath589 to @xmath0 . for the measurement readout term , we define its square matrix , @xmath590 with the row and column index being @xmath591 to @xmath28 .    as a result",
    ", we can rewrite the action @xmath34 into two separated terms , a free action @xmath592 and an interaction action @xmath201 , where @xmath593 the appearance of the first term in the interaction action , @xmath594 , is the reason we have the extra terms ( we represented them as @xmath281 ) in eq .  .",
    "we now show why the two - point correlation functions derived from our path integrals , such as the one derived from the free action in eq .  , that is @xmath595 consist of a left continuous heaviside step functions @xmath296 that behaves differently from the usual heaviside step function .",
    "this left continuous heaviside step function has the properties , @xmath297 and @xmath596 , while the usual heaviside step function has properties , @xmath597 , @xmath596 , and @xmath598 .",
    "this is true from a point of view of the discrete form of a correlation function , @xmath599 , that the propagator has this property @xmath600 when @xmath601 and it vanishes otherwise .",
    "let us start from writing a free generating function in a discrete form , @xmath602 $ ]    @xmath603= & \\frac{\\left(\\frac{\\delta t}{2 \\pi}\\right)^{\\frac{n}{2}}}{(2 \\pi i)^{n}}\\int \\!\\!{\\mathrm{d}}[x_k]_1^n \\int \\!\\!{\\mathrm{d}}[p_k]_0^{n-1 } \\exp\\left\\{-\\sum_{i=0}^{n-1}\\sum_{j=1}^{n }   p_{i}(g^{-1}_x)_{i , j } x_j + \\sum_{k=0}^{n-1 } p_k ( j_p)_k \\delta t + \\sum_{k=1}^{n } ( j_x)_k x_k \\delta t\\right\\}\\\\ & \\times \\int { \\mathrm{d}}[\\xi_k]_0^{n-1 } \\exp\\left\\{- \\frac{1}{2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}\\xi_i ( g^{-1}_\\xi)_{i , j } \\xi_j    + \\sum_{k=0}^{n-1 } \\xi_k ( j_\\xi)_k \\delta t \\right\\}.\\end{aligned}\\ ] ]    these matrix integrals can be carried out using multi - dimensional gaussian integrals .",
    "the first one is , @xmath604},\\end{aligned}\\ ] ] where @xmath184 is a pure imaginary @xmath6-dimensional vector , @xmath605 , are real vectors , and @xmath606 is a real and invertible matrix .",
    "another is , @xmath607)^{1/2}},\\end{aligned}\\ ] ] where @xmath71 is a real @xmath6-dimensional vector and @xmath281 is a real and symmetric matrix . after integrating over all variables ,",
    "the free generating function is given by , @xmath608    we note that the integrals generate a prefactor @xmath609 , knowing that @xmath610 , and another prefactor @xmath611 , which both are then canceled with the prefactor in eq .  .",
    "also , from eqs .  - , we can compute the inverses of them as , @xmath612 with the row index , @xmath613 to @xmath0 , and the column index , @xmath614 to @xmath28 , and @xmath615 with the row and column indices , @xmath591 to @xmath28 .",
    "now , let us compute the two - point correlation function @xmath616 ,    @xmath617_1^n \\,{\\mathrm{d}}[p_k]_0^{n-1 } { \\mathrm{d}}[\\xi_k]_0^{n-1 } ( x_a p_b ) \\exp\\left\\{-\\sum_{i=0}^{n-1}\\sum_{j=1}^{n } p_{i}(g^{-1}_x)_{i , j } x_j - \\frac{1}{2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}\\xi_i   ( g^{-1}_\\xi)_{i , j } \\xi_j   \\right\\ } \\\\",
    "\\nonumber = & \\frac{1}{\\delta t}\\frac{\\partial}{\\partial ( j_x)_a}\\frac{1}{\\delta t } \\frac{\\partial}{\\partial ( j_p)_b } z_f[j_x , j_p , j_\\xi ] \\bigg |_{j_x , j_p , j_\\xi=0 } \\\\ \\nonumber = &   \\frac{1}{\\delta t}\\frac{\\partial}{\\partial ( j_x)_a } \\frac{1}{\\delta t } \\frac{\\partial}{\\partial ( j_p)_b}\\exp\\left[\\sum_{i=1}^{n } \\sum_{j=0}^{n-1 } ( j_x)_i ( g_x)_{i , j } ( j_p)_j \\delta t^2\\right ] \\bigg |_{j_x , j_p=0}\\\\   = & ( g_x)_{a , b } =   \\begin{cases } 1 & \\text { , if , } a \\ge b+1 \\text { , or , } a > b , \\\\ 0 & \\text { , otherwise . } \\end{cases}\\end{aligned}\\ ] ]    where @xmath618 .",
    "the conclusion in the last line comes from the fact that the square matrix , @xmath619 , has the row and column indices different by one time step ( see eq .  ) , which actually originates from the indices of , @xmath620 , and @xmath621 .",
    "continued from eq .  , we presented all 10 diagrams here ,    @xmath623\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v_0 $ ] ( bp ) ; \\coordinate[above = of b2,label = above:$v_{t_1}$](a1 ) ; \\coordinate[above = of bp , label = above:$v_0$](ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw ( bp ) circle ( .06 cm ) ; \\draw ( ap ) circle ( .06 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+ \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2 ] ( bp ) ; \\coordinate[above = of bp ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\end{tikzpicture}\\,+",
    "\\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2 ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture } +   \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2 ] ( bp ) ; \\coordinate[above = of bp , label = below right:$w$,label = above:$v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of ap](cc ) ; \\coordinate[above=0.3 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.1 cm of cc , label = right:$w_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( ap ) sin   ( dp ) ; \\draw[particle ] ( ap ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture } + \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$v$ ] ( bp ) ; \\coordinate[above = of bp ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0.1 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.3 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture } \\,+ \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$w$ ] ( bp ) ; \\coordinate[above = of bp ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0.1 cm of cc , label = right:$w_0$](cp ) ; \\coordinate[below=0.3 cm of cc , label = right:$v_0$](dp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle2 ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\end{tikzpicture}\\\\   { \\nonumber}&+\\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$v$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.4 cm of cc , label = right:$v_0$](dp ) ; \\coordinate[right = of ap](dd ) ; \\coordinate[above=0.4 cm of dd , label = right:$v_0$](ep ) ; \\coordinate[below=0 cm of dd , label = right:$v_0$](fp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\draw[particle ] ( ap ) sin   ( ep ) ; \\draw[particle ] ( ap ) sin   ( fp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\draw ( ep ) circle ( .06 cm ) ; \\draw ( fp ) circle ( .06 cm ) ; \\end{tikzpicture}\\ ,   + \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$w$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$v$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0 cm of cc , label = right:$w_0$](cp ) ; \\coordinate[below=0.4 cm of cc , label = right:$v_0$](dp ) ; \\coordinate[right = of ap](dd ) ; \\coordinate[above=0.4 cm of dd , label = right:$v_0$](ep ) ; \\coordinate[below=0 cm of dd , label = right:$v_0$](fp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\draw[particle ] ( ap ) sin   ( ep ) ; \\draw[particle ] ( ap ) sin   ( fp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\draw ( ep ) circle ( .06 cm ) ; \\draw ( fp ) circle ( .06 cm ) ; \\end{tikzpicture}\\ , + \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$v$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$w$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0 cm of cc , label = right:$v_0$](cp ) ; \\coordinate[below=0.4 cm of cc , label = right:$v_0$](dp ) ; \\coordinate[right = of ap](dd ) ; \\coordinate[above=0.4 cm of dd , label = right:$w_0$](ep ) ; \\coordinate[below=0 cm of dd , label = right:$v_0$](fp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\draw[particle ] ( ap ) sin   ( ep ) ; \\draw[particle ] ( ap ) sin   ( fp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\draw ( ep ) circle ( .06 cm ) ; \\draw ( fp ) circle ( .06 cm ) ; \\end{tikzpicture}\\,+ \\begin{tikzpicture}[node distance=0.6 cm and 0.8cm]\\coordinate[label = below:$v_{t_2}$ ] ( b2 ) ; \\coordinate[right = of b2,label = below:$v$,label = above right:$w$ ] ( bp ) ; \\coordinate[above = of bp , label = below right:$v$,label = above:$w$ ] ( ap ) ; \\coordinate[left=1.1 cm of ap , label = above:$v_{t_1}$ ] ( a1 ) ; \\coordinate[right = of bp](cc ) ; \\coordinate[above=0 cm of cc , label = right:$w_0$](cp ) ; \\coordinate[below=0.4 cm of cc , label = right:$v_0$](dp ) ; \\coordinate[right = of ap](dd ) ; \\coordinate[above=0.4 cm of dd , label = right:$w_0$](ep ) ; \\coordinate[below=0 cm of dd , label = right:$v_0$](fp ) ; \\draw[particle ] ( a1 ) -- ( ap ) ; \\draw[particle ] ( b2 ) -- ( bp ) ; \\draw[gluon ] ( ap ) --   ( bp ) ; \\draw[particle ] ( bp ) sin   ( dp ) ; \\draw[particle ] ( bp ) sin   ( cp ) ; \\draw[particle ] ( ap ) sin   ( ep ) ; \\draw[particle ] ( ap ) sin   ( fp ) ; \\fill[black ] ( a1 ) circle ( .05 cm ) ; \\fill[black ] ( b2 ) circle ( .05 cm ) ; \\draw ( cp ) circle ( .06 cm ) ; \\draw ( dp ) circle ( .06 cm ) ; \\draw ( ep ) circle ( .06 cm ) ; \\draw ( fp ) circle ( .06 cm ) ; \\end{tikzpicture},\\\\ { \\nonumber}= & { v}_i^2",
    "\\,g_{{v}}(t_1,0 ) g_{{v}}(t_2,0 ) + \\int { \\mathrm{d}}t ' \\left[g_{{v}}(t_1,t ' ) g_{{v}}(t_2,t')\\left\\{\\kappa_2+\\alpha { v}_i^2 g_{{v}}(t',0)^2 + \\alpha { v}_i { w}_i g_{{v}}(t',0)g_{{w}}(t',0 ) \\right\\}^2\\right],\\\\ = & { v}_i^2 e^{{\\lambda}_2 t_1}e^ { { \\lambda}_2 t_2}+ \\int { \\mathrm{d}}t ' \\left [ e^{{\\lambda}_2(t_1-t')}e^{{\\lambda}_2(t_2-t')}\\left\\{\\kappa_2 + \\alpha { v}_i^2 \\left(e^{{\\lambda}_2 t'}\\right)^2 + \\alpha { v}_i { w}_i e^{{\\lambda}_2 t ' } e^{{\\lambda}_3 t ' } \\right\\}^2         \\right],\\end{aligned}\\ ] ]      70ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( , ) @noop _ _  ( , ) @noop _ _  ( , ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.87.032115 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.97.166805 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.101.200401 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.112.080501 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.67.241305 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.112.170501 [ * * ,   ( ) ] @noop * * , ( ) link:\\doibase 10.1103/physreva.49.2133 [ * * , ( ) ] link:\\doibase    10.1103/physreva.62.012105 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevx.3.021008 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.66.041401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.72.245322 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.71.201305 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreva.67.030301 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.100.160503 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevd.33.1643 [ * * , ( ) ] link:\\doibase 10.1103/physrevd.35.1815 [ * * , ( ) ] link:\\doibase 10.1103/physreva.36.5543 [ * * , ( ) ] link:\\doibase 10.1007/bf02894935 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.93.260604 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreve.75.051919 [ * * , ( ) ] link:\\doibase 10.1186/s13408 - 015 - 0018 - 5 [ * * , ( ) , 10.1186/s13408 - 015 - 0018 - 5 ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.8.423 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.107.240501 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.47.1652 [ * * , ( ) ] @noop _ _  ( , ) link:\\doibase 10.1103/physrevb.63.085312 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.67.075303 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ) \\doibase http://dx.doi.org/10.1006/aphy.1996.0052 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we generalize and extend the stochastic path integral formalism and action principle for continuous quantum measurement introduced in [ a. chantasri , j. dressel and a. n. jordan , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 88 * , 042110 ( 2013 ) ] , where the optimal dynamics , such as the most likely paths , is obtained by extremizing the action of the stochastic path integral . in this work , we apply exact functional methods as well as develop a perturbative approach to investigate the statistical behaviour of continuous quantum measurement . </S>",
    "<S> examples are given for the qubit case . </S>",
    "<S> for qubit measurement with zero qubit hamiltonian , we find analytic solutions for average trajectories and their variances while conditioning on fixed initial and final states . for qubit measurement with unitary evolution </S>",
    "<S> , we use the perturbation method to compute expectation values , variances , and multi - time correlation functions of qubit trajectories in the short - time regime . </S>",
    "<S> moreover , we consider continuous qubit measurement with feedback control , using the action principle to investigate the global dynamics of its most likely paths , and finding that in an ideal case , qubit state stabilization at any desired pure state is possible with linear feedback . </S>",
    "<S> we also illustrate the power of the functional method by computing correlation functions for the qubit trajectories with a feedback loop to stabilize the qubit rabi frequency . </S>"
  ]
}