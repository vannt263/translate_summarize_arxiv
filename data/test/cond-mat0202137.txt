{
  "article_text": [
    "an accurate description of electron correlation is one of the central issues in modern electronic structure theory . in principle",
    ", this involves solving the many - electron schrdinger equation , which for a system of @xmath0 interacting electrons is an inseparable @xmath1-dimensional problem .",
    "methods based on mean - field approximations of the electron interaction , such as hartree - fock ( hf ) or density - functional theory ,  @xcite ( dft ) reduce this to @xmath0 independent problems , which we may solve to approximate many physical properties with reasonable accuracy .",
    "however , a more complete description of electron correlation is often required to study delicate phenomena such as long - range electron correlation and van der waals interactions .",
    "quantum monte carlo ( qmc ) methods provide an important approach for solving the full @xmath1 dimensional problem .",
    "@xcite one such method , variational monte carlo ( vmc ) , allows us to estimate expectation values for a given trial wave function .",
    "ideally , this wave function is an eigenstate of the many - body hamiltonian . in practice ,",
    "a parameterized form is used , which approximates the exact eigenstate .",
    "the accuracy of these calculations is entirely dependent on the trial wave function , however , and so the development of accurate wave functions is vital both in the accurate estimation of physical properties and in understanding how certain physical phenomena may be simply represented in the wave function .",
    "a widely used trial correlated wave function is the jastrow - slater  @xcite or feenberg  @xcite form , @xmath2 d~.    \\label{eq : jastrowpsi}\\end{aligned}\\ ] ] here @xmath3 is a slater determinant of single - particle orbitals and interparticle correlation is introduced with the two - body term @xmath4 in the jastrow factor .",
    "the one - body term @xmath5 could in principle be absorbed into the single - particle orbitals of the determinant , but it may be convenient to retain it explicitly in the jastrow factor . in practice ,",
    "the orbitals in the slater determinant are often determined from a hf or dft calculation .",
    "@xcite    in this paper , we will focus on the optimization of jastrow - slater wave functions in the context of the electronic structure of periodic solids",
    ". we will apply wave function optimization to examine some consequences which emerge from a complete treatment of inhomogeneity in the two - body correlation term for diamond and rhombohedral graphite .",
    "the general form of wave function in eq .",
    "[ eq : jastrowpsi ] has been used as the starting point of several methods , including fermi hypernetted chain  @xcite ( fhnc ) and vmc  @xcite calculations .",
    "the traditional approach is to use a variational principle on the energy ( or , in the `` variance minimization '' method ,  @xcite on the fluctuations of the energy ) to define a best approximation to the true eigenstate within the variational freedom allowed by the wave function ansatz .",
    "expectation values of the energy and other quantities are calculated from the trial wave function , approximately in the fhnc approach , exactly in vmc ( within statistical error of the sampling ) .",
    "while the vmc method has been used in calculations of periodic solids , in practice most calculations have included only homogeneous two - body terms in the jastrow factor  @xcite and the optimization of wavefunctions with very large numbers of parameters has remained problematical . to our knowledge , the fhnc approach has not been applied in fully three - dimensional electronic structure calculations .",
    "wave functions determined by the vmc approach are often used as guiding , trial functions for the diffusion monte carlo ( dmc ) method .",
    "@xcite in the dmc context , the accuracy of the wavefunction affects the numerical efficiency of energy calculations and the accuracy of other physical quantities . when dmc is used in conjunction with non - local pseudopotentials ,  @xcite as is commonly the case in chemical applications , an accurate trial wavefunction is essential for an accurate calculation of the ground state energy .",
    "we present here , for the first time , a numerically robust , rapidly convergent iterative method which minimizes the variational energy with respect to a very general inhomogeneous form of the jastrow factor , including all one- and two - body terms compatible with crystal symmetry . the method remains numerically well - conditioned , even for large systems ( of the order of several hundred electrons ) , where there are more than 3000 independent variational parameters in the jastrow factor . within acceptable computational demands on the monte carlo sampling ,",
    "the optimal values of parameters in the wave function are found to be well determined , even when their contribution to the total energy is extremely small .",
    "the method places no restrictions on the functional form of the anti - symmetric ( determinantal ) part of the many - body wave function and can be used in conjunction with related methods recently developed for energy minimization with respect to all orbitals in the determinant  @xcite or with respect to configuration weights in a multi - determinant function .",
    "@xcite taken in conjunction with these methods , the approach presented here completes the solution to the problem of energy minimization with respect to the most general variational terms in wavefunctions of the jastrow - slater type , as well as in wave functions where the jastrow factor multiplies a multi - determinant function .",
    "although many specific details of the work here refer to periodic systems , the basic method for jastrow factor optimization could also be used in similar calculations of molecular , atomic , or nuclear structure .",
    "other general methods exist to achieve energy minimization with respect to parameters in many - body wave functions .",
    "when only one or two parameters are optimized , it is possible to perform a systematic search of parameter space , as mcmillan did in his pioneering vmc study of the properties of liquid he .  @xcite the stochastic gradient approximation ( sga ) used by harju _",
    "et al . _",
    "@xcite applies control theory to determine iterative corrections to the wave function parameters .",
    "et al . _",
    "@xcite explicitly computed analytical derivatives of the energy with respect to variational parameters and used these to optimize their wave function with a newton - style method .",
    "however , none of these methods have as yet been applied in systems where a very large number of parameters are to be optimized .    in recent years ,",
    "the variance minimization method of umrigar _ et al .",
    "_ ,  @xcite which optimizes the wave function by reducing the magnitude of the variance of the local energy , has been used much more widely than energy minimization in determining optimal parameters for variational wave functions .",
    "although not strictly equivalent to energy minimization for a non - exact wave function , in practice this method has been very successful in improving total energies , providing extremely accurate wave functions in certain atomic systems .",
    "@xcite unfortunately , variance minimization is often subject to confinement to local minima and requires much human interaction and experience for successful implementation when large numbers of parameters are to be optimized .",
    "variance minimization may be thought of as fitting energy fluctuations to a constant , and attempting to reduce the cost function involved in this fit by direct variation of the wave function parameters .",
    "the standard approach is to use a least - squares fit of these energy fluctuations .",
    "our method of energy minimization involves the fitting of energy fluctuations to a given ( non - constant ) functional form , which is a linear combination of operators associated with variations of the wave function parameters ( see sec .  [ sec.enermin ] ) .",
    "this fitting allows us to determine a `` predictor '' , which links changes in the wave function to changes in the fitted energy fluctuations .",
    "this predictor iteratively guides our method to a self - consistent solution , where the fitted energy fluctuations are zero .",
    "the derivatives of the true many - body energy with respect to all the parameters in the wave function are then also zero ( within statistical sampling error ) for this final solution .",
    "our predictor is closely related to the random phase approximation ( rpa ) , introduced by bohm and pines  @xcite and recently discussed in the context of inhomogeneous systems .",
    "@xcite however , as long as the predictor is sufficiently accurate to ensure stable convergence of the iterations to the self - consistent solution , its exact form does not affect the final solution .",
    "our method allows us to surpass the approximations of the rpa and produce explicit trial wave functions of unprecedented accuracy for electrons in periodic solids .",
    "we will use the optimized wave functions to study the effects of charge inhomogeneity on the correlation factors in diamond , as a prototype of strongly bonded insulating systems , and rhombohedral graphite , as a prototype of highly anisotropic , inhomogeneous solids .",
    "although earlier studies  @xcite of these and related systems would indicate that homogeneous two - body correlation factors gain a large fraction of the correlation energy in solids and that inhomogeneous correlation factors are unlikely to lower the total variational energy greatly , substantial differences in correlation factors often give rise to relatively little change in energy .",
    "this is particularly true when one is interested in long - range correlation , which is energetically very delicate .",
    "the rest of this paper is organized as follows : in sec .",
    "[ sec.wavefn ] , we present the detailed numerical form of variational wave functions to be used in these calculations . the approach of fitting energy fluctuations and its use in guiding the iterative solution of the energy minimization problem is discussed in sec .  [ sec.enermin ] .",
    "in sec .  [ sec.results ] , we present some results on the application of the method to the periodic solids , diamond and rhombohedral graphite , and examine the effects of charge density inhomogeneity on the correlation factors of these systems . in sec .",
    "[ sec.discussion ] we discuss the results and some computational details of the method , illustrating the justification for certain aspects of our approach with some tests .",
    "finally , in sec .",
    "[ sec.conclusion ] , we present the overall conclusions of this study .",
    "the jastrow two - body correlation factor @xmath6 in eq .",
    "[ eq : jastrowpsi ] can in principle always be expressed as : @xmath7 where @xmath8 form a complete set of functions and @xmath9 are expansion coefficients .",
    "( we use @xmath10 to indicate complex conjugation throughout this paper ) .",
    "similarly , the one - body function @xmath11 may also be expanded in a basis set of complete functions @xmath12 , as : @xmath13    apart from an additional term to handle the electron - electron cusp ,  @xcite we will express the jastrow factor in the general form given by eqs .",
    "[ eq:2bodyexpansion ] and  [ eq:1bodyexpansion ] .",
    "values of the parameters @xmath14 will then be determined so that the energy of the system is stationary with respect to all variations @xmath15 .      due to the divergence of the coulomb interaction between two electrons ,",
    "the correct two - body correlation term @xmath6 has a cusp where @xmath16 , leading to slow convergence of any expansion in smooth functions of the form in eq .",
    "[ eq:2bodyexpansion ] .",
    "@xcite for this reason , it is numerically convenient to re - write the two - body function @xmath4 in the form : @xmath17 where @xmath18 is a short - ranged ( homogeneous ) function which has the correct electron - electron cusp as @xmath19 and @xmath6 is now a smooth , cuspless function .",
    "we use a form of the short - ranged function @xmath20 which is generated from a numerical solution of the electron - electron scattering problem .",
    "a discussion of the generation of @xmath20 is provided in appendices a and c of ref .  .",
    "we define @xmath21 , where @xmath22 is defined within appendix c of ref .  .",
    "the expansion of the remaining function @xmath6 in the form given in eq .",
    "[ eq:2bodyexpansion ] then converges much more rapidly than that of the original function , for any set of smooth functions @xmath8 .    in this paper",
    ", we generate the short - range function @xmath20 in a spin - dependent form , to maintain the cusp conditions .",
    "@xcite the cuspless function @xmath6 used in our work is independent of electron spin , although we expect that a spin - dependent form is as easily optimized .",
    "summing @xmath6 over all electron pairs in the basis @xmath8 leads to @xmath23 this may be thought of as a two - body expansion of the correlation term .",
    "however , it is important to realize that any separation of `` one - body '' and `` two - body '' terms in the jastrow factor is somewhat arbitrary .",
    "removal of terms where @xmath24 , as in eq .",
    "[ eq:2bodycorrelation ] , is not sufficient to decouple one- and two - body terms completely . to see this ,",
    "consider the transformation of each of the basis functions obtained by subtracting a constant , @xmath25 .",
    "the set remains complete and the function @xmath26 u_{\\alpha \\beta }      [ f_{\\beta}({\\bf r ' } ) - c_{\\beta } ]   ~ ,    \\label{eq : arbconstexpansion}\\end{aligned}\\ ] ] may be interpreted as a `` two - body '' function in the basis set @xmath27 .",
    "however , expanding this correlation factor over all electron pairs , we find that , in terms of the original basis @xmath8 , an additional one - body contribution appears : @xmath28         \\label{eq:12bodyseparation }   \\\\    & + & ~{\\rm constant } ~. \\nonumber\\end{aligned}\\ ] ] we may regard this as a transformation of the one - body function in eq .",
    "[ eq : jastrowpsi ] : @xmath29 , where the additional term comes from the second line of eq .",
    "[ eq:12bodyseparation ] : @xmath30           f_{\\alpha}({\\bf r})^ *        +   \\left [ \\sum_{\\beta } u_{\\beta \\alpha } c_{\\beta}^ * \\right ]          f_{\\alpha}({\\bf r } ) \\right\\ } \\nonumber \\end{aligned}\\ ] ]    to make a definite numerical separation of our one- and two - body expansions , we need to consider an appropriate choice of the arbitrary constants @xmath31 , noting that @xmath32 is intended primarily to affect correlation properties ( i.e. , two - body properties ) of the system , leaving single - particle properties unchanged .",
    "for example , the mean - field methods that produce @xmath3 [ hf , dft under the local density approximation  @xcite ( lda ) , etc .",
    "] normally give very accurate single - particle densities , which can be altered substantially by inclusion of an arbitrary function @xmath6 , in @xmath33 ( eq .  [ eq : jastrowpsi ] ) .",
    "any substantial change in the density from the hf solution is likely to be energetically very costly , so that ideally we would like to decouple changes in @xmath6 from changes in the density .",
    "necessary changes in the density may be allowed for by optimization of the explicit one - body term @xmath5 in the jastrow factor ( eq .  [ eq:1bodyexpansion ] ) or by the methods of ref .  .    therefore , we would like to choose the constants @xmath31 such that the average of any one - body operator ( such as the density ) for @xmath33 remains stationary with respect to variations in the coefficients @xmath9 , at least in the absence of interparticle correlation .",
    "if we define the one - body operator @xmath34 for the many - body configuration @xmath35 , then its expectation value is @xmath36 where @xmath37 is the single particle density .",
    "since the @xmath38 are fixed functions , variations in the expectation values @xmath39 correspond to variations in @xmath37 .",
    "the derivative of @xmath39 with respect to variations of the @xmath9 in eq .",
    "[ eq : arbconstexpansion ] is ( see appendix  [ app.deriv ] ) @xmath40      \\sum_{i \\neq j}[f_{\\alpha}({\\bf r}_i)^ * - c_{\\alpha}^ * ]                      [ f_{\\beta}({\\bf r}_j ) - c_{\\beta } ]      \\rangle \\\\",
    "= \\sum_k \\sum_{i \\neq j } \\langle       [ f_{\\gamma}({\\bf r}_k)^ * - \\langle f_{\\gamma } \\rangle^ * ]      [ f_{\\alpha}({\\bf r}_i)^ * - c_{\\alpha}^ * ]      [ f_{\\beta}({\\bf r}_j ) - c_{\\beta } ]      \\rangle ~ .\\end{aligned}\\ ] ]    in the absence of interparticle correlation , @xmath41 the second summation excludes @xmath24 , so averages of triple products never arise .",
    "thus , in the absence of correlation , the derivative becomes @xmath42                 [ f_{\\alpha}({\\bf r}_i)^ * - c_{\\alpha}^ * ] \\rangle         \\langle    f_{\\beta}({\\bf r}_j ) - c_{\\beta }   \\rangle    \\nonumber \\\\    & + &          \\langle [ f_{\\gamma}({\\bf r}_j)^ * - \\langle f_{\\gamma } \\rangle^ * ]                 [ f_{\\beta}({\\bf r}_j ) - c_{\\beta } ] \\rangle         \\langle    f_{\\alpha}({\\bf r}_i)^ * - c_{\\alpha}^ *   \\rangle ~.    \\nonumber\\end{aligned}\\ ] ] we can guarantee that the right hand side of eq .",
    "[ eq : approxderiv ] is zero if @xmath43 , for all @xmath44 . in other words ,",
    "one - body expectation values remain approximately unaffected by the presence of the correlation factor @xmath32 , provided we expand @xmath32 in a basis of `` fluctuation functions '' , @xmath45 .",
    "equivalently , we may retain the original basis @xmath8 and form a one - body term @xmath46 from eq .",
    "[ eq : natural1body ] with @xmath43 .",
    "this may then be inserted into the wave function of eq .",
    "[ eq : jastrowpsi ] and varied as the parameters @xmath9 are varied .",
    "correlation effects are of course present in the actual wave function used .",
    "however , we find that eq .",
    "[ eq : approxderiv ] remains approximately true , as previously observed .",
    "@xcite for the energy minimization problem , we find that mixed derivatives of the energy @xmath47 are approximately zero when @xmath43 .",
    "this gives the numerical advantage that minimization of the energy with respect to @xmath9 approximately decouples from minimization with respect to @xmath48 .",
    "we note that this approximate decoupling holds , even if the relation @xmath43 is not exactly true .",
    "thus we may use @xmath49 , ( i.e. , lda or hf averages of @xmath8 ) , in place of @xmath50 , while still maintaining the numerical advantages of approximately satisfying @xmath51 .      in the context of periodic systems , it is natural to expand the correlation function @xmath32 as a fourier series , where the basis functions are @xmath52 $ ] , for each wave vector @xmath53 .",
    "we note that @xmath54                          = \\sum_i f_{\\bf q}({\\bf r}_i)^ *     \\label{eq : fouriercharge}\\end{aligned}\\ ] ] is the fourier coefficient of the instantaneous charge density , given the electron configuration @xmath55 .",
    "( in atomic units the electronic charge @xmath56 ) .",
    "also , summing over pairs leads to a quadratic product of fourier coefficients , with some modification to remove terms with @xmath57 : @xmath58}.    \\label{eq:1bodyremoved}\\end{aligned}\\ ] ]    in order to approximately remove the effect of the two - body terms on the single - particle density , following sec .",
    "[ sec.sep12 ] , we subtract appropriate constants from each basis function to produce a new basis , the collective `` charge fluctuation '' coordinates , @xmath59 these provide a suitable expansion of the two - body correlation factor that approximately preserves single - particle densities .",
    "a correlation factor using such coordinates was first suggested by bohm and pines  @xcite for the homogeneous electron gas , and has recently been discussed by malatesta _",
    "et al . _",
    "@xcite and gaudoin _ et al . _",
    "@xcite in the context of inhomogeneous systems . in homogeneous systems",
    "the expectation value @xmath60 of each charge density fourier coefficient is zero , and so charge density fluctuations are simply @xmath61 . for inhomogeneous systems , in general @xmath62",
    "when @xmath63 , a reciprocal lattice vector .",
    "the alternative to using fluctuation coordinates @xmath64 is to incorporate the equivalent one - body term in the jastrow factor , which in periodic systems is of the form @xmath65 with the coefficients coming from the two - body term @xmath66 as discussed by malatesta _",
    "et al . _",
    "@xcite and gaudoin _ et al . _",
    "@xcite    the properties of the fourier basis @xmath67 and the correlation factor @xmath4 lead to some convenient symmetry properties for the coefficients @xmath68 .",
    "the complex conjugate @xmath69 , just as @xmath70 .",
    "the exchange symmetry of u , i.e. , @xmath71 implies that @xmath72 . and , if u possesses inversion symmetry , i.e. @xmath73",
    ", then each @xmath68 is a real number . in periodic systems , @xmath74 for any bravais lattice vector @xmath75",
    "this implies that all fourier coefficients @xmath68 are zero unless @xmath76 , a reciprocal lattice vector .",
    "thus , translation symmetry greatly reduces the number of variational parameters in the two - body terms .",
    "we arrange the wave function in the form @xmath77 isolating the short range component of the jastrow factor as @xmath78 ~.\\end{aligned}\\ ] ] the one - body term here is derived from the short range correlation factor @xmath20 of eq .",
    "[ eq : shortlongu ] , as @xmath79 , where @xmath80 is the fourier transform of @xmath20 for the reciprocal lattice vector @xmath81 .",
    "the prefactor of @xmath82 , which should be present from eq .",
    "[ eq:1bodycoeffs ] , approaches unity for large systems and so is neglected .",
    "for computational efficiency we leave this one - body term in its fourier space representation and @xmath83 is a cut - off chosen for the fourier sum such that it is converged within a required accuracy .",
    "the remaining inhomogeneous part of the two - body jastrow factor is expanded using charge density fluctuation coordinates : @xmath84~,\\end{aligned}\\ ] ] where @xmath85}$ ] , using the notation @xmath86}$ ] , as defined in eq .",
    "[ eq:1bodyremoved ] and the definition of @xmath87 in eq .",
    "[ eq : deltarho ] . in practice",
    ", this double sum is truncated by using vectors @xmath88 of magnitude less than a suitably chosen cut - off @xmath89 .",
    "we also allow for one - body optimization through the use of the explicit one - body jastrow factor .",
    "this one - body jastrow factor is also expanded in fluctuation coordinates , @xmath90,\\end{aligned}\\ ] ] since including the constant average values @xmath91 merely adjusts the normalization of the wave function .",
    "the coefficients @xmath92 and @xmath93 , defined in eqs .",
    "[ eq : inhomjast ] and  [ eq:1bjast ] , are the final variational parameters of our wave function .",
    "the remaining sections of this paper describe the method we use to optimize these parameters such that the total energy of a particular electronic system is stationary .",
    "a typical calculation presented below involves the simultaneous optimization of over 3000 parameters .",
    "we wish to optimize the wave function @xmath94 where @xmath95 a vector of parameters , by solving the euler - lagrange equations , @xmath96 we note that the hamiltonian for the system is @xmath97 where each sum is over the electrons in the system .    solving eq .",
    "[ eq : eleqns ] is equivalent ( see appendix  [ app.deriv ] ) to solving the following system of equations @xmath98 where , given a many - body configuration @xmath99 , we define : @xmath100 , for any operator @xmath101 ; and the local values of the operators @xmath102 as , @xmath103 we shall refer to the local value of the hamiltonian operator as the `` local energy '' , @xmath104    we approach the problem of solving the euler - lagrange equations ( eq .",
    "[ eq : eleqns ] ) indirectly , by considering systematic fluctuations of the energy for a given trial wave function @xmath105 .",
    "consider fitting the local energy @xmath106 to the functional form @xmath107 in the least - squares sense , where @xmath108 is the set of functions with which we fit the energy , and @xmath109 is the vector of fitting coefficients .",
    "the least - squares problem reduces to minimizing the integral @xmath110 which is equivalent ( see appendix  [ app.leastsq ] ) to solving the linear system @xmath111    we recognize immediately that if the functions @xmath102 are those functions associated with variations of the wave function parameters @xmath112 ( eq .  [ eq : operdefn ] ) , then the right - hand side of eq .",
    "[ eq : lstsqsys ] _ is _ the vector of euler - lagrange derivatives in eq .",
    "[ eq : elsystem ] .",
    "therefore , the euler - lagrange equations ( eq .",
    "[ eq : eleqns ] ) are solved if all the fitted coefficients @xmath113 are zero .",
    "is singular , or at least numerically so ( i.e. , has a very small eigenvalue ) , singular value decomposition is recommended to set the appropriate fitting coefficients @xmath114 to zero .",
    "such problems do not render the wave function parameters @xmath115 ill - conditioned , as the small size of the corresponding expectation values @xmath116 implies that changes in @xmath115 have little effect on the total energy . ]    as an illustrative example , consider @xmath117 , an eigenstate of @xmath118 .",
    "indeed , the local energy is a constant , independent of @xmath55 , and so we would find that each of the fitted coefficients @xmath113 is zero .",
    "therefore , the euler - lagrange derivatives @xmath119 are all zero , and so the energy must be stationary with respect to variations in @xmath117 , as we would expect for an eigenstate .    for the trial wave function @xmath105 , no choice of @xmath120 gives an _ exact _ eigenstate of the hamiltonian .",
    "however , for a particular choice of parameters , the absence of _ systematic _ variations of the energy ( i.e. , variations correlated with the variations of the functions @xmath102 ) ensures that the fitting coefficients @xmath113 are all zero and that the average energy is stationary with respect to all variations of the parameters @xmath120 . within the parametric freedom of the trial wave function @xmath33 , this is our best approximation to an eigenstate .",
    "we now describe a procedure which aims , by appropriate choice of the parameters @xmath120 , to set the fitted coefficients @xmath113 of the total energy @xmath121 to zero . as defined in eq .",
    "[ eq : lstsqsys ] , these @xmath113 depend on the wave function @xmath105 and so are functions of the parameters @xmath120 .",
    "however , the functional dependence of @xmath113 on @xmath120 is not available in its exact analytic form and we are unable to solve directly the system @xmath122 , i.e. , to find the root @xmath120 which will guarantee the solution to the corresponding euler - lagrange equations .    instead , using the wave function @xmath123 , for a particular choice of the parameters @xmath124 , we construct a predictor function @xmath125 , which approximates the unknown function @xmath126 for general values of @xmath120 .",
    "more precisely , we construct @xmath125 so that @xmath127 ( i.e. , @xmath128 is exact when @xmath129 ) and , @xmath130 for all relevant values of @xmath120 .    to determine this predictor",
    ", we use the specific form of the hamiltonian ( eq .  [ eq : hamiltonian ] ) and trial wave function @xmath33 ( sec .  [ sec.wavefn ] ) , and we partition the local energy @xmath106 into a sum of contributions , @xmath131 where the @xmath132 come from various terms in the kinetic and potential energy ( see below ) . each contribution @xmath133 is approximated with the functional form @xmath134 for some terms , using the specific form of the local energy for @xmath105 , we can expand @xmath132 analytically as in eq .",
    "[ eq : enerfuncform ] , enabling us to determine , exactly or approximately , the function @xmath135 . in this analytic form",
    ", @xmath135 is independent of the choice of @xmath124 and so remains equally valid for all @xmath120 .    where analytic expressions are too complex to derive",
    ", we may approximate @xmath135 by fitting @xmath132 to eq .",
    "[ eq : enerfuncform ] .",
    "the fitting coefficients for @xmath132 , are found by solving the analogue of eq .",
    "[ eq : lstsqsys ] , @xmath136 where @xmath137 is determined by using @xmath123 to evaluate the required expectation values .",
    "this produces the value of each coefficient at @xmath124 .",
    "we may also fit the derivatives of @xmath132 with respect to @xmath120 , to determine the linear dependence of each @xmath135 .",
    "we may then approximate the function @xmath138 where the values of the derivatives are found by fitting @xmath139 to eq .",
    "[ eq : enerfuncform ] using @xmath123 . in evaluating the term @xmath140",
    ", we consider only the explicit variation of the term @xmath141 with @xmath115 .",
    "we do not include the implicit variation due to the dependence of the probability distribution @xmath142 on @xmath143 . in practice ,",
    "the only term for which we need to fit @xmath139 is explicitly linear in the parameters @xmath143 and so the linear expansion in eq .",
    "[ eq : taylorexp ] is valid over a wide range of values of @xmath120 .",
    "just as the energy contributions @xmath133 partition the local energy , we may regard the analytic and fitted coefficients @xmath144 as an approximate partition of the local energy coefficients @xmath113 .",
    "we define this partition as follows : @xmath145 where the sum of analytically derived coefficients is @xmath146 and the sum of numerically determined coefficients , evaluated using @xmath123 and eq .",
    "[ eq : contributionlstsqsys ] , is @xmath147 we construct the predictor @xmath125 such that it satisfies eq .",
    "[ eq : predictordefn ] , i.e. , @xmath148 where @xmath149 are found by solving eq .",
    "[ eq : lstsqsys ] .",
    "we define our iterative approach to determining the parameters @xmath120 , for which the coefficients @xmath126 are zero , as follows :    1",
    ".   given the set of parameters @xmath150 , construct the wave function @xmath151 .",
    "[ iter : constrwavefn ] 2 .",
    "evaluate the required expectation values in eqs .",
    "[ eq : lstsqsys ] and  [ eq : contributionlstsqsys ] , using @xmath151 , to find the fitting coefficients @xmath152 and numerical functions @xmath153 .",
    "[ iter : fitting ] 3 .",
    "if _ the total energy fitting coefficients are zero , i.e. , @xmath154 , _ then _ we are done , _ otherwise _ continue .",
    "[ iter : donecheck ] 4 .",
    "construct the predictor function @xmath155 in eq .",
    "[ eq : predictor ] using the fitted terms from step .",
    "[ iter : fitting ] , and find the solution @xmath156 to the system @xmath157 using the newton - raphson method  @xcite ( see appendix  [ app.newtonraphson ] ) . use this set of parameters @xmath156 in step  [ iter : constrwavefn ] .",
    "[ iter : findroot ]    iterations continue until the total energy coefficients @xmath152 tend to zero , and the values of the parameters @xmath150 converge .",
    "note that even though the predictor @xmath155 is only an approximation to the exact function @xmath126 , eq .",
    "[ eq : predictordefn ] guarantees that at the converged solution @xmath158 in other words , the parameter set @xmath120 solves the euler - lagrange equations for @xmath159 exactly . clearly , the larger the neighbourhood within which the approximate relation in eq .",
    "[ eq : predictorapprox ] holds , the faster this iterative procedure will converge . in the trivial case , if the exact analytic form of @xmath126 were known _ a priori _ , then we could just solve the euler - lagrange equations in one step using a suitable root - finding method .    rather than starting the procedure from an initial guess @xmath160 , we may begin at step  [ iter : findroot ] using only the analytic terms in the predictor , since these are independent of the wave function and so do not require fitting .",
    "that is , we solve the system @xmath161 the solution set @xmath162 is then used in step  [ iter : constrwavefn ] .",
    "we note that the potential energy operators @xmath163 and @xmath164 in the hamiltonian @xmath118 , defined in eq .",
    "[ eq : hamiltonian ] , are multiplicative , and therefore their contributions to @xmath106 are constant with respect to variations of the wave function parameters @xmath120 .",
    "variations of @xmath120 affect only the contributions of the differential kinetic energy operator .",
    "thus , solving the euler - lagrange equations for @xmath159 ( eq .  [ eq : eleqns ] ) amounts to adjusting the systematic fluctuations of the kinetic energy to cancel those in the potential energy exactly .    if we extract a variational part @xmath165 of @xmath33 , such that @xmath166 , where @xmath167 is dependent on the set of parameters @xmath120 , and @xmath168 is independent of them",
    ". then we may partition @xmath106 as follows : @xmath169 where we define @xmath170 clearly , @xmath171 is constant with respect to variations of @xmath120 . further analysis of each of @xmath172 and @xmath173 is necessary to determine how each depends on @xmath120 .",
    "however , for @xmath167 expressible in the form of the jastrow factors in sec .",
    "[ sec.wavefn ] , i.e. , @xmath174~,\\end{aligned}\\ ] ] where @xmath175 are defined in eq .",
    "[ eq : operdefn ] , we see that : ( i ) @xmath173 is at most linear in @xmath120 , but involves terms coming from @xmath168 , so that it may be impossible to determine analytic expressions for the coefficients @xmath176 ; ( ii ) @xmath172 is at most quadratic in @xmath120 , and involves only @xmath167 , for which we have an analytic expression , and therefore may derive analytic approximations to the coefficients @xmath177 ( see sec .",
    "[ sec.predictoranalapprox ] ) .",
    "the initial predictor @xmath178 used in the iterative method involves only analytic terms .",
    "we determine these by direct expansion of particular local energy contributions , given the analytic form of the wave function .",
    "we now consider the contributions of the one- and two - body terms individually .",
    "replacing @xmath179 in sec .",
    "[ sec.energypartition ] with @xmath180 , we derive an analytic expression for the energy contribution @xmath172 ( see appendix  [ app.1benercon ] ) . from this",
    "we may extract those coefficients @xmath181 of the functions",
    "@xmath182 : @xmath183 by assumption , the one - body contribution of @xmath171 is zero .",
    "that is , the mean field methods used to calculate the determinant @xmath3 should remove ( approximately ) all systematic one - body fluctuations in the local energy , and the use of `` fluctuation functions '' @xmath184 in the two - body jastrow factor approximately removes its effect on one - body operators .",
    "therefore , we assume initially that the coefficients @xmath185 .",
    "we are unable to derive an analytic expression for the coefficients @xmath186 of the energy contribution @xmath173 and",
    "so , for the moment , we leave these aside .    constructing the full analytic approximation",
    "@xmath187 we see that the roots of @xmath188 are trivially @xmath189 , as we would expect .      according to sec .",
    "[ sec.wavefn ] , the two - body jastrow correlation factor is divided into a short - range term @xmath22 and an inhomogeneous term @xmath190 .",
    "we optimize the variational parameters @xmath191 in @xmath190 . as for the one - body jastrow",
    ", we expand the corresponding energy contribution @xmath172 which depends on @xmath190 alone ( see appendix  [ app.2benercon ] ) .",
    "this leads us to an approximation to the coefficients of the functions @xmath192 in @xmath172 : @xmath193    again , we are unable to derive expressions for the coefficients corresponding to @xmath173 .",
    "we extract a two - body contribution from the constant contribution @xmath171 ( see appendix  [ app.2benercon ] ) , as @xmath194 , for the electron interaction @xmath164 .",
    "we replace the true interaction in this expression with a pseudointeraction @xmath195 , which is generated for a given cut - off radius @xmath196 and reference eigenvalue @xmath197 , as explained in ref .  .",
    "@xmath195 is used to generate the short - range two - body function @xmath20 ( eq .",
    "[ eq : shortlongu ] ) , used in @xmath22 .",
    "the purpose of this modification of @xmath198 is to account for the presence of @xmath22 in @xmath33 and is explained in appendix  [ app.shortjconseq ] .    from these contributions we construct the analytic predictor @xmath199",
    "we notice that for periodic systems , this function is separable in the points @xmath53 of the first brillouin zone ( bz ) . for each @xmath53 in bz",
    ", we may expand @xmath200 as a function of @xmath201 , with no coupling to parameters @xmath202 for @xmath203 .",
    "this block diagonal form of the analytic predictor allows us to find the roots @xmath204 by solving for each block ( i.e. , each @xmath53 ) individually .",
    "we do this using the newton - raphson method .    a reliable initial guess for the newton - raphson method , rather than using @xmath205 ,",
    "is the homogeneous solution of @xmath206 .",
    "if we regard the system as homogeneous , i.e. , @xmath207 for @xmath208 , then the solution is @xmath209 ~.    \\label{eq : homosoln}\\end{aligned}\\ ] ] this @xmath68 is used as the starting point for the newton - raphson iterations , and for all systems studied , this initial guess produced convergent roots of @xmath206 .      to complete the construction of the predictor @xmath210 defined in eq .",
    "[ eq : predictor ] , for a given set of variational parameters @xmath124 , we must determine some terms numerically by fitting fluctuations in the energy of the system .",
    "we calculate @xmath149 in eq .",
    "[ eq : predictor ] by fitting the entire local energy , using eq .",
    "[ eq : lstsqsys ] .",
    "also , we use the fitting method to numerically determine the functions @xmath211 given in eq .",
    "[ eq : taylorexp ] , by fitting the energy contribution @xmath173 and each of its derivatives with respect to the parameters to be optimized .",
    "again , we note that @xmath173 is explicitly linear in the parameters @xmath120 and the approximation in eq .",
    "[ eq : taylorexp ] is exact in this case .    to do all this numerical work we use monte carlo sampling to determine the required expectation values : @xmath212 for @xmath213 ranging over the number of parameters @xmath214 in the set @xmath120 .",
    "however , for simultaneous optimization of one- and two - body terms , we make some simplifications to reduce the computational workload . if we assume that the parameter @xmath112 can be varied independently of @xmath215 , this corresponds to assuming that @xmath216 .    in the expansion of the analytic local energy terms coming from @xmath190 , outlined in appendix  [ app.2benercon ]",
    ", we saw that these consisted of one- and two - body terms .",
    "however , the one - body terms contained fourier coefficients of the average charge density @xmath60 , which are zero for @xmath217 , a reciprocal lattice vector .",
    "also , the analytic form of the predictor ( sec .  [ sec.predictoranalapprox ] ) is separable in the k - points of the first brillouin zone .",
    "therefore , we make the following approximations to the covariance matrix @xmath218 : @xmath219 for reciprocal lattice vectors @xmath220 .    we regard one- and two - body optimization as independent for non - zero k - points in the first brillouin zone . if we also exclude the covariance terms between one- and two - body operators for @xmath221 , we find that this slows the convergence of the method for smaller systems . for larger systems",
    ", this exclusion prevents the convergence of the newton - raphson method at the first iteration of our method , thus halting the optimization process .",
    "however , we are not , in any way , confined to using the newton - raphson method to find the roots of the predictor , and other , more robust , root - finding methods might overcome this problem .",
    "note that @xmath173 depends on the variational part @xmath167 of the wave function which is being optimized .",
    "the variational components are @xmath222 and @xmath223 for each @xmath53 in bz , where we define @xmath224~,\\end{aligned}\\ ] ] so that @xmath225 .",
    "this greatly reduces the complexity of the predictor , without sacrificing convergence of the method for the systems studied here .",
    "ultimately , the predictor @xmath210 is itself only an approximation of the true function @xmath126 , but by definition matches this function at the current values of the parameters being optimized .",
    "therefore , approximations in the predictor affect only the rate of convergence of the method .",
    "the expressions for @xmath173 and its derivatives @xmath226 for the one - body jastrow factor @xmath222 are given in appendix  [ app.1benercon ] . upon fitting these terms to the operators @xmath182",
    ", we may construct the function @xmath211 .",
    "this defines the fitted terms @xmath227 in the predictor ( sec .",
    "[ sec.iterproc ] ) .    for a given @xmath53 in bz",
    ", we use the expressions for @xmath173 and the derivatives @xmath228 , given in appendix  [ app.2benercon ] , corresponding to the two - body jastrow factor @xmath223 defined above .",
    "we construct the function @xmath229 , where @xmath230 , and define the numerical predictor terms @xmath231 , which contribute to the linear dependence of the predictor on @xmath232 .",
    "we now apply this optimization method to diamond and rhombohedral graphite .",
    "we shall compare the correlation factors determined in both these systems , given the inhomogeneity and anisotropy of the electron charge density in graphite , relative to diamond .",
    "the convergence criterion of our iterative optimization : @xmath233 , requires the examination of possibly thousands of parameters , and it is difficult to visualize the overall convergence of the method . for illustrative purposes , we use the coefficients @xmath152 to construct a single function @xmath234 . in the chosen fourier basis",
    ", this amounts to reconstructing the real - space function @xmath234 from its fourier coefficients . for one - body optimizations @xmath235 and for two - body optimizations @xmath236    two - body functions , such as @xmath237 and the jastrow correlation function @xmath6 , are functions of six variables and so , extracting useful information from them is difficult . for illustrative purposes , we indicate in fig .",
    "[ fig : superlattice ] two points , @xmath101 and @xmath238 , in both the diamond and rhombohedral graphite structures , corresponding to high and low electron charge density regions , respectively .",
    "@xmath101 lies midway between two bonded carbon atoms and @xmath238 lies midway between two layers of carbon atoms .",
    "we shall position the first electron at either @xmath101 or @xmath238 .",
    "the second electron shall be moved away from this position along one of the following line segments ( indicated by heavy black lines in fig .",
    "[ fig : superlattice ] ) : @xmath239 lying within a layer of carbon atoms ; @xmath240 perpendicular to the layers ; @xmath241 lying between two layers ; and @xmath242 perpendicular to the layers",
    ".     lies at the midpoint of a carbon - carbon bond , with the lines @xmath239 and @xmath240 extending within a layer and perpendicular to the layers , respectively .",
    "the point @xmath238 lies midway between two layers ( at a hexagonal interstitial point in diamond ) and the lines @xmath241 and @xmath242 extend between the layers and perpendicular to the layers , respectively .",
    ", width=143 ]     lies at the midpoint of a carbon - carbon bond , with the lines @xmath239 and @xmath240 extending within a layer and perpendicular to the layers , respectively .",
    "the point @xmath238 lies midway between two layers ( at a hexagonal interstitial point in diamond ) and the lines @xmath241 and @xmath242 extend between the layers and perpendicular to the layers , respectively .",
    ", width=158 ]    \\(a ) diamond    \\(b ) graphite    by this means we may plot inhomogeneous two - body functions in terms of the relative separation of the electrons in the system . in particular , we may draw some conclusions about electron correlation in the system by examination of @xmath4 .",
    "we may determine the isotropy of @xmath4 by comparing plots of @xmath4 with the first electron kept at the same point but the second electron moved in perpendicular directions , e.g. , by comparing plots designated by @xmath239 and @xmath240 .",
    "the homogeneity of @xmath4 may be seen by comparing plots of @xmath4 with the second electron moving in parallel directions from different positions of the first electron , e.g. , by comparing @xmath239 and @xmath241 .",
    "any differences between these plots of @xmath4 are attributable to the inhomogeneity and anisotropy of the electron correlation factors in the systems studied .",
    "we use periodic boundary conditions ( pbc ) to approximate the infinite crystal .",
    "@xcite the simulation cells consist of an @xmath243 unit cell arrangement .",
    "the unit cells in each system are defined by the bravais lattice basis vectors . for diamond",
    ", we use the basis : @xmath244 , where @xmath245 a.u . , corresponding to a carbon bond - length of @xmath246 a.u . for rhombohedral graphite",
    "we use the basis : @xmath247 , where @xmath248 a.u .",
    "is the bond - length within the layers , and @xmath249 a.u . is the layer separation .",
    "we construct the slater determinant @xmath3 for both systems using dft calculations in the local density approximation ( lda ) .",
    "@xcite the lda orbitals were expanded using a linear combination of atomic orbitals comprising gaussians centred on each of the two carbon atoms in the unit cell .",
    "@xcite      in sec .",
    "[ sec.eleccusp ] , we discussed the advantages of removing the short - range cusp from the function @xmath4 in order to improve its representability as a linear combination of smooth functions .",
    "figure  [ fig : pseudousr](a ) compares the pseudointeraction @xmath195 , generated using a cut - off radius of @xmath250 a.u . and energy eigenvalue @xmath251 hartree ( as discussed in ref .  ) , with the coulomb interaction @xmath252 .",
    "( in atomic units @xmath253 ) .",
    "the pseudointeraction is used to generate a short - range jastrow funtion @xmath20 , which is shown in fig .",
    "[ fig : pseudousr](b ) for the relative angular momenta @xmath254 and @xmath255 corresponding to parallel spin and anti - parallel spin correlation , respectively .",
    "the short range jastrow factor used in all subsequent calculations is that generated with these particular values of @xmath196 and @xmath197 .",
    "subsequent figures in this paper , which involve @xmath20 , represent anti - parallel spin correlation only .",
    "the cut - off required for a convergent fourier expansion of a smooth cuspless function should be much less than that required for a function with a short - range cusp .",
    "therefore , using a cuspless form greatly reduces the number of terms required to represent the inhomogeneous form of the jastrow factor accurately in fourier space .",
    "we illustrate this point using a simple example . in fig .",
    "[ fig : cuspremove ] we plot @xmath256 times the fourier transform , for wave vector @xmath257 , of the yukawa - style homogeneous correlation factor , @xmath258 which has been used by many authors to approximate electron correlation in a variety of systems .",
    "@xcite we set @xmath259 a.u . , ( @xmath260 is determined from @xmath101 to satisfy the cusp conditions  @xcite and depends on the relative spin of the electrons ) . also shown in fig .",
    "[ fig : cuspremove ] is @xmath256 times the fourier transform of the cuspless difference @xmath261 .",
    "we assume that , for large electron separations , electron correlation is approximately spin - independent .",
    "therefore , for each @xmath257 , we plot the mean of the parallel spin and anti - parallel spin values of the functions .    in practice",
    ", we use the first zero of the fourier transform of @xmath195 as the fourier space cut - off @xmath89 used in the definition of @xmath190 in eq .",
    "[ eq : inhomjast ] . for @xmath262",
    "we use the cut - off @xmath263 , beyond which the fourier transform of the cuspless @xmath4 function is approximately zero ( fig .",
    "[ fig : cuspremove ] ) . combining both the short - range and inhomogeneous forms of the jastrow factor using this scheme produces a form that is approximately independent of the cut - off , since decreasing @xmath196 increases the reciprocal space cut - off @xmath89 .      for comparison with the inhomogeneous @xmath4 functions determined in the following sections we use the yukawa - style homogeneous function @xmath264 of eq .",
    "[ eq : yukawa ] and construct a homogeneous trial wave function of the form @xmath265 .",
    "as with the inhomogeneous trial wave function , we represent short - range correlation ( i.e. , the cusp ) using @xmath22 and represent the remaining correlation using a homogeneous jastrow factor @xmath266~,\\end{aligned}\\ ] ] where we define @xmath267                              e^{-i{\\bf q \\cdot r } } d{\\bf r}~.\\end{aligned}\\ ] ]    for the uniform electron gas , bohm and pines  @xcite predicted that the true function @xmath4 should decay as @xmath268 , at large separation @xmath269 , where @xmath270 is the plasma frequency .",
    "rather than use this limiting value @xmath271 in eq .",
    "[ eq : yukawa ] , it is common to treat @xmath101 as a free parameter such that the energy is minimized . using variational calculations we can determine the optimal value of @xmath101 .",
    "@xcite we optimize the one - body jastrow factor @xmath222 in eq .",
    "[ eq:1bjast ] , using our iterative method .",
    "the jastrow factor @xmath272 , combined with the slater determinant @xmath3 , is our best approximation of the true many - body eigenstate using a homogeneous two - body jastrow factor and is comparable with similar wave functions optimized using variance minimization .",
    "@xcite    in fig .",
    "[ fig : uhom ] we plot @xmath264 and compare it with the reconstructed function @xmath273 for @xmath274 unit cell simulations of diamond and rhombohedral graphite .",
    "periodic boundary conditions and the anisotropy of the unit cell make this reconstructed form appear quite different to the original isotropic function @xmath264 .",
    "in particular , for rhombohedral graphite the unit cell used is quite anisotropic , leading to marked differences in the reconstructed function along the perpendicular line segments @xmath239 and @xmath240 .",
    "( the homogeneity of @xmath264 is preserved and so we only plot the function for point @xmath101 , since all other points are equivalent . )",
    "note that the jastrow @xmath4 function is defined up to an arbitrary constant , much like a potential , since this constant affects only the wave function normalization and contributes nothing to the description of correlation .",
    "therefore , it is of no consequence that the functional form of @xmath264 in eq .",
    "[ eq : yukawa ] appears shifted above the reconstructed forms compatible with pbc .",
    "this is due to the removal of the constant fourier coefficient of the correlation function @xmath275 from the expansion of the reconstructed function in eq .",
    "[ eq : yukawarecon ] .",
    "we note that the cusp conditions  @xcite are maintained by all forms .",
    "we optimize the one - body jastrow @xmath222 using the method described in sec .",
    "[ sec.enermin ] . for the diamond simulations we used a fourier space cut - off @xmath276 , giving 84 variational one - body parameters .",
    "this is more than enough for an accurate representation of one - body terms in the wave function ( see sec .  [ sec.energycorrections ] ) . for graphite simulations we used @xmath277 , giving 30 variational one - body parameters .",
    "the values of the electronic energy per atom for various optimizations of this homogeneous trial wave function are shown in figs .",
    "[ fig : diamondener ] and  [ fig : graphiteener ] .",
    "each iteration involved averaging over @xmath278 monte carlo samples . however , this amount of averaging was more than enough for an accurate implementation of the method .",
    "the optimization of the one - body terms in the @xmath274 simulation of graphite ( fig .",
    "[ fig : graphiteener ] ) involved only @xmath279 samples per iteration and is well converged . on average , the gain in energy following one - body optimization is approximately @xmath280 mhartree / atom for diamond and @xmath281 mhartree / atom for graphite .",
    "we note that the necessity for a one - body correction is a consequence of the inhomogeneity of the electronic charge density in the system ,  @xcite and it is not surprising that the gain in energy is larger for the more inhomogeneous system , graphite , than for diamond .",
    "the slater determinant used in the diamond calculations of fig .",
    "[ fig : diamondener ] is composed of single - particle orbitals generated from an lda calculation .",
    "the lda orbitals are linear combinations of gaussian basis functions of @xmath282 , @xmath283 and @xmath284 symmetry , using three decays of 0.24 , 0.797 , and 2.65 .",
    "the exchange - correlation functional used was of the ceperley - alder  @xcite form .",
    "the cut - off of the fourier space expansion of the charge density  @xcite in the lda calculation was 64 rydberg .",
    "the graphite calculations shown in fig .",
    "[ fig : graphiteener ] use a slater determinant generated using a gaussian basis - set with @xmath282 and @xmath283 symmetry only .",
    "four decays were used : 0.19 , 0.474 , 1.183 , and 2.95 .",
    "the orbitals were generated from lda calculations incorporating the hedin - lundqvist  @xcite exchange - correlation functional , and a cut - off of 36 rydberg for the fourier space expansion of the charge density .",
    "( see sec .",
    "[ sec.energycorrections ] for a discussion of basis - set convergence of the total energy in graphite . )",
    "figure  [ fig:1boptchi ] illustrates the convergence during optimization of the one - body function @xmath285 in eq .",
    "[ eq : jastrowpsi ] ( where @xmath5 is the accumulation of all one - body terms from each of the jastrow factors ) for the @xmath286 diamond calculation .",
    "the optimized function is statistically well - determined , and the change from the initial one - body function , @xmath287 of eq .",
    "[ eq : natural1body ] ( as defined in refs .   and  ) , is well - defined .",
    "this alteration of the one - body function may be compared to similar calculations performed using variance minimization .  @xcite    the number of parameters for optimization could be greatly reduced through exploitation of the crystal point - group symmetry of the structures involved .",
    "however , it is worth noting that the optimization process preserves the natural symmetry of the system ( within statistical error ) without such measures , illustrating that for non - symmetric systems with large numbers of parameters , this optimization process should be quite robust .    the one - body function @xmath288 , reconstructed from the coefficients associated with the local energy @xmath289 at iteration @xmath290 according to eq .",
    "[ eq:1bodyv ] , is shown in fig .",
    "[ fig:1boptel ] .",
    "clearly , this function decreases in magnitude , indicating a decrease in the magnitudes of the euler - lagrange derivatives . beyond the first iteration",
    ", @xmath288 is of the same order of magnitude as its associated standard error , and so is statistically insignificant .",
    "therefore , the method has essentially converged after only one iteration .",
    "the noisiest regions of @xmath288 correspond to regions of low density where the monte carlo sampling is less frequent .",
    "the analytic guess for the two - body predictor functions @xmath291 , outlined in sec .",
    "[ sec.predictoranalapprox.j2b ] , leads to an inhomogeneous generalization of the rpa equations .",
    "the solution to these equations is the function @xmath292 , shown in fig .",
    "[ fig : urpa ] for the @xmath274 graphite simulation .",
    "we notice some inhomogeneity in @xmath293 at intermediate- and long - range electron separations .",
    "a more homogeneous and isotropic @xmath293 was found for diamond , as we would expect since diamond possesses a more uniform electron density than graphite .    in figs .",
    "[ fig : diamondener ] and  [ fig : graphiteener ] , the first point on all solid curves indicates the total energy per atom in each simulation calculated using @xmath293 . in comparison with",
    "the energy calculated using the homogeneous jastrow function @xmath264 , we see that the inhomogeneous rpa trial wave function is at best comparable in accuracy with the optimized trial wave function with homogeneous two - body jastrow factor , and often less accurate .",
    "these results are different from those of gaudoin _ et al . _",
    "@xcite for model systems : they find that their inhomogeneous generalization of the rpa produces wave functions that yield lower energies than the homogeneous form .",
    "we simultaneously optimized the parameters in both the one - body jastrow factor @xmath222 and the fully inhomogeneous form of the two - body jastrow factor @xmath190 , using our iterative method .",
    "the convergence of the total energy per atom for various simulations of diamond and rhombohedral graphite are shown in figs .",
    "[ fig : diamondener ] and  [ fig : graphiteener ] .",
    "( the slater determinants used in combination with the homogeneous jastrow factor @xmath294 in sec .  [ sec.homoj ] are also used here . )",
    "convergence of the total energy is achieved in approximately three iterations in all cases and is stable .",
    "this is remarkable given that the system sizes range from 8 electrons and 140 independent parameters to 216 electrons and 3136 independent parameters .",
    "also , we used the same amount of monte carlo sampling , viz . , @xmath278 samples per iteration , to determine the required expectation values for all simulations . in all cases",
    "the fully inhomogeneous form of @xmath4 allows us to determine more accurate trial wave functions with substantially lower energies than the homogeneous trial functions .",
    "in general , the gain in energy through using an inhomogeneous rather than a homogeneous wave function is of the order of @xmath295 mhartree / atom for both diamond and rhombohedral graphite .    figure  [ fig : graphuconv ] illustrates the rapid convergence of the two - body wave function parameters @xmath191 to their optimal values during the largest graphite optimization ( @xmath274 ) and is typical of all the optimizations performed in both diamond and graphite . beyond the third iteration , no clear distinction exists between subsequent sets of parameters .",
    "the optimal jastrow function @xmath4 is significantly different from both the rpa function @xmath296 and the homogeneous form @xmath297 of eq .",
    "[ eq : yukawa ] . the proof that this optimization succeeds in minimizing the energy expectation value",
    "may be seen in fig .",
    "[ fig : graphvconv ] ( which comes from the same graphite calculation as fig .",
    "[ fig : graphuconv ] ) . here , we plot the iterative decay of the two - body function @xmath237 reconstructed from the total energy coefficients determined at each iteration , according to eq .",
    "[ eq:2bodyv ] .",
    "this clearly indicates the reduction to zero ( within statistical noise ) of the derivatives in the euler - lagrange equations , thus solving the energy minimization problem .",
    "[ fig : graphuconv ]    for the largest simulation cells studied ( @xmath274 unit cell arrangement containing 216 electrons ) , we compare the optimal jastrow correlation functions @xmath4 of diamond and rhombohedral graphite . figures  [ fig : diamuopt ] and  [ fig : graphuopt ] show the function @xmath4 plotted with respect to electron separation on various line segments in the corresponding crystal structures , as already explained .",
    "[ fig : diamuopt ]",
    "for a direct comparison of the calculated energies of diamond and rhombohedral graphite , we should ( a ) make some corrections based on the trial wave functions used and ( b ) include finite size and zero - point phonon energy corrections for the expected energy of the real infinite solid .",
    "the corrected energies for diamond and graphite are listed in table  [ tab : enercorr ] .    .",
    "energies and energy corrections of diamond and rhombohedral graphite ( in hartree / atom ) .",
    "( a ) total energy , determined by vmc and our optimization method , for a @xmath274 unit cell simulation region , using wave functions of similar variational freedom ( see text ) .",
    "( b ) finite size correction equal to the energy difference between an lda calculation for the @xmath274 simulation region and an lda calculation using a fully - converged k - point set ( see text ) .",
    "( c ) correction for the zero - point phonon energy .",
    "@xcite ( d ) total energy including the corrections .",
    "the numbers in parentheses indicate the statistical error in the last digits of the corresponding energy . [",
    "tab : enercorr ] [ cols= \" < , > , < , > , < \" , ]     the jastrow factors used in both solids are comparable in their variational freedom , the only significant difference being the size of the cut - off used for @xmath298 .",
    "however , a vmc calculation for diamond , using the same cut - off as in graphite ( @xmath299 ( a.u.)@xmath300 , corresponding to 25 variational parameters ) , resulted in an increase in energy of only @xmath301 mhartree / atom for diamond .",
    "therefore , the high fourier coefficients of @xmath298 contribute little to the total energy of the system .",
    "the diamond vmc energy for the @xmath274 simulation quoted in table  [ tab : enercorr ] was determined using @xmath299 ( a.u.)@xmath300 as the cut - off for one - body terms .    in graphite ,",
    "the exclusion of @xmath284 symmetry from the basis set used to construct the lda orbitals in the slater determinant is energetically more important .",
    "in addition to the calculations described in secs .  [ sec.homoj ] and  [ sec.inhomjopt ] , we also performed calculations for graphite using a gaussian basis set with @xmath282 , @xmath283 and @xmath284 symmetry , and three gaussian decays : 0.22 , 0.766 , 2.67 . for the @xmath274 simulation , including @xmath284 symmetry reduces the total vmc energy by @xmath302 mhartree / atom and also reduces the variance in the total energy by 16% .",
    "use of the ceperley - alder exchange correlation functional to generate the single - particle orbitals in graphite , rather than the hedin - lundqvist form , made no difference ( within statistical error ) to the vmc energies , and neither did an increase in the cut - off for the fourier space expansion of the lda charge density from 36 to 64 rydberg .",
    "the graphite vmc energy for the @xmath274 simulation listed in table  [ tab : enercorr ] was calculated using a trial wave function very similar to that used for the calculation of the corresponding diamond vmc energy .",
    "the cut - off for the one - body jastrow factor was @xmath299 ( a.u.)@xmath300 and the slater determinant comprised lda orbitals obtained using : ( i ) a basis set with @xmath284 symmetry ( as outlined above ) ; ( ii ) the ceperley - alder exchange correlation functional ; and ( iii ) a 64 rydberg cut - off for the lda charge density expansion .",
    "we generate finite size corrections for the @xmath274 unit cell simulations of diamond and graphite , by calculating the difference in energy between an lda calculation which uses k - points compatible with periodic boundary conditions of a @xmath274 simulation region and an lda calculation using a fully converged k - point set .",
    "@xcite comparing the change in energy between a @xmath303 calculation and a @xmath274 calculation in both diamond and graphite , using lda and vmc , we see that the change in vmc energy is about 80% of the lda energy change in diamond , and 70% in rhombohedral graphite .",
    "perhaps more accurate estimates of the energy of the infinite solid may be obtained by implementation of a model periodic coulomb interaction developed recently .",
    "tests of this approach have dramatically reduced finite - size effects in the interaction energy .",
    "@xcite    for diamond , we estimated the finite size correction to be @xmath304 mhartree / atom , using a converged lda calculation with 220 k - points in the irreducible brillouin zone .",
    "for rhombohedral graphite , incorporating @xmath284 symmetry in the basis set ( as described above ) , and using 189 k - points in the lda calculation , we found the finite size correction to be @xmath305 mhartree / atom .",
    "we also include the calculated zero - point phonon energies of diamond and graphite , which are @xmath306 and @xmath307 mhartree / atom , respectively .",
    "@xcite    adding all these corrections to the calculated vmc energies ( table  [ tab : enercorr ] ) , we estimate the energies of the infinite solids to be @xmath308 hartree / atom for diamond and @xmath309 hartree / atom for rhombohedral graphite .",
    "this appears to indicate that rhombohedral graphite is less stable than diamond .",
    "however , given the approximation of using lda finite size corrections , we might expect a systematic error of the order of 2 mhartree / atom in each of these results .",
    "this indicates that at the vmc level , the solids diamond and rhombohedral graphite have very similar total energies .",
    "we note that in the atomic pseudopotential used in the calculations presented here @xmath283 and higher angular momentum scattering are all included in the local potential .",
    "it is possible that the use of a separate @xmath284 pseudopotential might slightly affect the relative energies in both systems .    in order to determine the cohesive energy of a solid",
    ", we should subtract the energy per atom of the solid from the energy of the isolated atom , @xmath310 .",
    "however , when using approximate eigenfunctions , a reasonable estimate of the cohesive energy is obtainable only by subtracting the energies estimated using similar trial wave functions .",
    "vmc energies are available for the carbon atom where the trial wave function is of the jastrow - slater form .",
    "@xcite the orbitals of the slater determinant are optimized using energy minimization and a sophisticated jastrow factor is optimized using variance minimization , yielding a vmc energy for the atom of @xmath311 mhartree . using this energy",
    ", we find the cohesive energies to be @xmath312 hartree / atom for diamond and @xmath313 hartree / atom for graphite .",
    "we regard this atomic trial wave function to be close in form and accuracy to our solid trial wave function .",
    "however , to remain consistent with the inclusion of @xmath284 symmetry in the basis set of our lda calculations , we could also refer to a multiconfiguration trial wave function for the carbon atom which includes @xmath284 excitations .",
    "the vmc energy of the atom , using this wave function , is @xmath314 hartree ,  @xcite leading to estimates of the cohesive energies of diamond and rhombohedral graphite of @xmath315 hartree / atom and @xmath316 hartree / atom , respectively .",
    "the experimental values are 0.271 hartree / atom for diamond , and 0.272 hartree / atom for graphite .",
    "@xcite    considering the significant gain in energy obtained using an inhomogeneous jastrow factor rather than a homogeneous form , one might wonder how much the difference between vmc and dmc energies has been reduced . using jastrow correlation factors which include one - body terms and homogeneous two - body terms , similar in form to that used in sec .",
    "[ sec.homoj ] , for bulk carbon  @xcite and silicon ,  @xcite typically leads to vmc correlation energies that are approximately 90% of the corresponding dmc correlation energies , i.e. , @xmath317 where @xmath318 is the energy calculated using vmc , @xmath319 is the energy calculated using dmc , and @xmath320 is the hartree - fock energy .",
    "( @xmath320 has been estimated using just the lda slater determinant as trial wave function .",
    "@xcite ) we have observed that including inhomogeneity in the correlation factor leads to a gain in energy of approximately 10 mhartree / atom in the largest simulations of both diamond and graphite .",
    "if we estimate that the vmc correlation energy , determined using our optimized wave function with homogeneous correlation terms , obtains 90% of @xmath321 , then using the optimized wave function with inhomogeneous correlation terms obtains 96% of the dmc correlation energy .",
    "this would indicate that the energy difference between vmc and dmc for these solids has been decreased by 60% .",
    "it is important to emphasize that , whatever physical conclusions we would like to draw from these calculations , our principal aim has been to optimize the trial wave function for a given hamiltonian , such that the expectation value of the total energy is minimized .",
    "this aim has been achieved for all the systems studied .",
    "diamond , with a relatively homogeneous and isotropic electron charge density , exhibits an approximately homogeneous , isotropic jastrow correlation function @xmath4 ( fig .",
    "[ fig : diamuopt ] ) . at large electron separations",
    "( beyond 6 a.u . ) we see that the electron correlation factor @xmath4 in diamond is well approximated by homogeneous and isotropic functions , as all the curves plotted are quite similar .",
    "only slight deviations from homogeneity exist at short and intermediate electron separations .",
    "this inhomogeneity may be seen by comparing @xmath4 plotted with its fixed coordinate at different points : @xmath239 and @xmath240 are quite similar at short range , but clearly distinct from @xmath241 and @xmath242 in the same region .",
    "this inhomogeneity may have significant effects on the short - range pair - correlation functions calculated for diamond - like systems using vmc methods .",
    "@xcite    graphite , with clear regions of high electron charge density and well - defined regions of very low electron charge density between its layers , is a highly inhomogeneous and anisotropic structure .",
    "this is borne out in fig .",
    "[ fig : graphuopt ] , where the function @xmath4 differs considerably in various regions and in various directions . at short - range",
    ", @xmath4 is surprisingly homogeneous in comparison with diamond . at intermediate separations",
    "the function displays both inhomogeneous and anisotropic behaviour .",
    "given that the layer separation in these simulations is 6.33 a.u .",
    ", this indicates that inhomogeneous correlation between adjacent layers in the system is not insignificant .",
    "this may prove important for van der waals interactions between the layers in graphite .",
    "at long range , the anisotropy of the graphite correlation factor is clearly shown in fig .",
    "13 , where the correlation factors for electron separation vectors @xmath322 lying parallel to the graphite planes ( @xmath239 and @xmath241 ) are distinctly different from those with the separation vector perpendicular to the planes ( @xmath240 and @xmath242 ) .",
    "inhomogeneity ( i.e. an explicit dependence on the position @xmath323 of the first electron ) is displayed at long range in the differences between the function along @xmath239 and @xmath241 .",
    "we might expect this , given that the line aa lies within the graphite planes , where the charge density is concentrated , whereas @xmath241 lies in the very low charge density region between the planes [ see fig .",
    "[ fig : superlattice](b ) ] . on the other hand , when the separation vector is oriented perpendicular to the graphite planes ( @xmath240 and @xmath242 ) , inhomogeneous effects are substantially smaller at long range",
    "in order to reduce the complexity of the physical results in sec .",
    "[ sec.results ] , some computational details of the method were not discussed .",
    "we present and discuss some of these details in this section .",
    "\\(1 ) this iterative method is trivially parallelizable . to determine the expectation values required to construct the predictor ,",
    "monte carlo sampling may be performed independently on many workstations and the results combined . to obtain total energies of the accuracy presented in this paper",
    "requires @xmath324 monte carlo samples .",
    "however , for optimization of the wave function using our method , this amount of sampling is also sufficient for accurate estimations of the expectation values required to construct the predictor ( sec .",
    "[ sec.predictornumer ] ) .    the extra time required to accumulate the various contributions to the predictor represents less than @xmath325 of the computational time needed to calculate each energy sample .",
    "there are two reasons for this : firstly , because we have expressed the variational components of the jastrow factor as linear combinations of the operators @xmath102 of sec .",
    "[ sec.enermin ] .",
    "these @xmath102 need only be evaluated once , for each electron configuration , in order to construct both the jastrow factor and the predictor . secondly , and more importantly , since we must calculate the total energy as a sum of various contributions defined by the hamiltonian of the system , all the energy contributions needed to construct the predictor are already available , either directly or by some simple manipulation .",
    "it is also important to note that , despite the complex form of the jastrow factor outlined in sec .",
    "[ sec.wavefn ] , the amount of computational time spent evaluating it is still less than or equal to that spent evaluating the slater determinant , for a given electron configuration .",
    "the largest calculations presented in this paper were performed on a beowulf cluster of fifteen 500 mhz dual - processor workstations . for a 5 iteration optimization using @xmath278 samples per iteration",
    ", these calculations took about 50 hours on this cluster .",
    "however , perhaps half this amount of sampling would have produced comparable results [ see ( 3 ) below ] .",
    "the required memory for storing all the expectation values necessary for this calculation was approximately 20 mb .",
    "\\(2 ) the newton - raphson method ( see appendix  [ app.newtonraphson ] ) , while quadratically convergent near a root of a multidimensional system , does possess some convergence problems far from the root . in the calculations presented in this paper",
    ", we found that below a certain minimum amount of sampling , the noise in the estimated expectation values used to construct the predictor caused divergence of the solution to eq .",
    "[ eq : generateparam ] using the newton - raphson method .",
    "this problem might be solved through the use of a more robust root - finding method for the predictor function .",
    "\\(3 ) from the analysis in appendix  [ app.convmeth ] , we see that noise in the iterative method comes from the finite sampling used to estimate those expectation values ( listed in sec .",
    "[ sec.predictornumer ] ) required to construct the predictor .",
    "the effect of this noise on the wave function accuracy is not clear .",
    "to reduce the computational cost of these calculations we would prefer to do the least amount of sampling necessary to produce the required results .    figure  [ fig : esamp ] illustrates the effect of various amounts of sampling on the convergence of the total energy in the optimization of the @xmath303 simulation of rhombohedral graphite . at @xmath326 samples per iteration ,",
    "the estimation of the required expectation values , during the first iteration of our method , is too crude to produce a convergent root of the predictor using the newton - raphson method .",
    "this leads to a wave function , used in the second iteration , with many noisy parameters which are more difficult to optimize , as the convergence of the energy shows . however , for sampling involving @xmath327 samples per iteration , or more , we see that the convergence of the total energy is identical ( within statistical accuracy ) .",
    "comparison of the optimized wave function parameters also reveals only small differences , indicating that the only means of determining the true benefits of more sampling is by examination of the fitted coefficients @xmath152 at each iteration @xmath290 .    in fig .",
    "[ fig : vsamp ] we see , from the reconstruction @xmath328 of the fitted coefficients for two - body optimization at the fifth and final iteration of the method , that the most sampling ( @xmath329 samples per iteration ) reduces the magnitude of the euler - lagrange derivatives the most , indicating that these wave function parameters are the most accurate .",
    "however , for practical purposes , there is little distinction between the accuracy of the wave function once we increase the sampling beyond @xmath327 samples per iteration .",
    "thus , the optimizations presented in sec .  [ sec.results ] may have used more computational time than was strictly necessary . however ,",
    "more testing is required to determine the minimum amount of sampling as a function of system size .",
    "we have developed a generalized form of electron correlation factor for trial many - body wave functions of electrons in periodic solids .",
    "this form allows us to represent fully inhomogeneous electron correlation in real physical periodic systems .",
    "it is computationally efficient to evaluate , since the electron cusp , which we express as a homogeneous correlation factor , is separated from the fully inhomogeneous form .",
    "we have also developed a rapidly convergent iterative method for the optimization of all variational parameters in these wave functions , minimizing the total energy of the given system .",
    "it uses the accurate techniques of quantum monte carlo sampling to achieve this optimization and has allowed new insights into the form of many - electron correlation in systems with highly inhomogeneous charge densities .",
    "we estimate the difference in energies calculated using the optimal inhomogeneous two - body correlation factor and the optimal homogeneous correlation factor to be approximately 60% of the difference between the dmc and vmc energies obtained with homogeneous 2-body correlation terms .    in diamond ,",
    "the optimal correlation factor is approximately homogeneous and isotropic , with some inhomogeneity at short- and intermediate - range electron separations .",
    "this is consistent with its comparatively homogeneous and isotropic electron charge density .",
    "graphite has an optimal correlation factor which is quite homogeneous at short - range electron separation , but is significantly inhomogeneous and anisotropic at intermediate- and long - range electron separations , as one might expect from its highly inhomogeneous and anisotropic electron charge density .",
    "nevertheless , it is remarkable that despite very large inhomogeneity in the electron pair - correlation function , found by previous authors ,  @xcite the ideal inhomogeneous jastrow two - body term , calculated for the first time here for diamond and graphite , displays relatively small inhomogeneity . whether this conclusion can be extended to other systems ( e.g. involving strongly correlated @xmath284-electrons )",
    "remains an open question .",
    "this work has been supported by enterprise ireland grant number sc/98/748 and by the irish higher education authority .",
    "the work of s.f . at the national microelectronics research centre is supported by science foundation ireland .",
    "the derivative of the expectation value of an observable @xmath101 , with respect to a parameter @xmath330 of the parameterized wave function @xmath105 , may be written as @xmath331 we assume that @xmath101 is independent of the parameters @xmath120 .",
    "also , for a time independent system , we may in general express @xmath33 as a real function .",
    "differentiating , we find that @xmath332 where we define the operator associated with variations of @xmath112 as @xmath333 , with local value @xmath334 for the many - body configuration @xmath55 .    therefore , we may express the derivative of @xmath335 as @xmath336 where @xmath337 and @xmath338 .",
    "our task is to minimize the integral @xmath339 by choosing the appropriate parameters @xmath340 and @xmath341 .",
    "we note first that , at the minimum , @xmath342 where @xmath343 is the expectation value of the total energy and @xmath344 is the expectation value of the operator @xmath345 . to fulfill the minimization , we must set all the remaining first derivatives of @xmath346 to zero , i.e. , @xmath347 for each @xmath348 . upon substitution of the minimum value of @xmath340 ,",
    "this leads to @xmath349 \\ .\\end{aligned}\\ ] ] since , for any operators @xmath350 , @xmath351 we may say that @xmath352 where @xmath353 , then we are lead to the conclusion that the least squares fitting is equivalent to solving the linear system @xmath354 for each @xmath348 .",
    "an integral part of the iterative procedure outlined in sec .  [ sec.iterproc ] is the determination of the parameters @xmath120 that solve the system in eq .",
    "[ eq : generateparam ] .",
    "the determination of the roots of any multidimensional function can be troublesome .",
    "in all the optimizations presented in this paper , the predictor function @xmath210 is a quadratic function of @xmath120 , whose coefficients are determined analytically , or by numerical fitting at the point @xmath124 .",
    "we ignore the implicit dependence of @xmath128 on @xmath124 for the purpose of finding a root , and solve the system @xmath355 for all @xmath356 .",
    "we use the newton - raphson method  @xcite to determine the roots .",
    "this is an iterative method of improving successive guesses for a root of a function .",
    "it involves the computation of the function @xmath128 and its jacobian matrix of derivatives with respect to @xmath120 , at each guess .",
    "the iterations continue until convergence of the solution is achieved within a predefined tolerance .",
    "the success of the newton - raphson method for multi - dimensional systems relies heavily on the proximity of the initial guess to the root we seek . for this reason ,",
    "the initial guess chosen is normally the parameter set of the previous iteration of the procedure outlined in sec .",
    "[ sec.iterproc ] . to find the first set of parameters , by finding the roots of the analytic predictor @xmath357",
    ", we require a good initial guess of the root .",
    "since the one - body parameters @xmath93 are expected to be small by construction , an initial guess of zero for all @xmath81 was found to be sufficient to produce a convergent solution to the first application of the newton - raphson method .",
    "for the two - body problem , we rescale the variables @xmath68 to improve the convergence of the root - finding method .",
    "according to the rpa ,  @xcite the long - range behaviour of the @xmath4 function should take the form @xmath358 , where the plasma frequency for a homogeneous system with electron charge density @xmath290 is @xmath359 .",
    "the charge density @xmath290 is determined in the simulation region to be @xmath360 , for @xmath0 the number of electrons in the simulation volume @xmath361 .",
    "therefore , for small @xmath53 in fourier space , @xmath4 behaves like @xmath362 this indicates large relative differences between values of @xmath363 for small @xmath53 .",
    "therefore , in inhomogeneous systems , it would be appropriate to rescale the parameters @xmath68 by multiplying by @xmath364 , thus rendering all the variables of the same order of magnitude as the plasma frequency .",
    "this leads to a less pathological numerical problem for the newton - raphson method .",
    "appropriate scaling must also be applied to the predictor function @xmath365 in sec .",
    "[ sec.enermin ] . for the initial analytic guess of the roots of @xmath366 we use the homogeneous solution for @xmath68 outlined in eq .",
    "[ eq : homosoln ] .",
    "the variational part of @xmath33 associated with one - body terms is the jastrow factor @xmath222 ( eq .  [ eq:1bjast ] ) with parameters @xmath367 .",
    "we expand the energy contributions @xmath172 and @xmath173 defined in sec .",
    "[ sec.energypartition ] . for @xmath222",
    ", we have that @xmath368 the constant terms are not required , so we ignore them .",
    "the energy contribution @xmath173 can not be expanded analytically as a linear combination of the functions @xmath369 since @xmath370 is not explicitly a function of these coordinates .",
    "however , @xmath173 is explicitly linear in the parameters @xmath372 , with derivatives @xmath373 which are independent of @xmath372 .",
    "the variational part of @xmath33 associated with two - body energy contributions is the inhomogeneous jastrow factor @xmath190 of eq .",
    "[ eq : inhomjast ] , with parameters @xmath374 .",
    "( for periodic systems we use only @xmath375 . )",
    "the energy contributions @xmath132 of sec .",
    "[ sec.energypartition ] are expanded here .",
    "the contribution @xmath172 is dependent only on the form of @xmath190 and is expanded as @xmath376 we find that @xmath377                              \\delta \\rho_{\\bf q}^ *        + \\mbox{constant}~. \\end{aligned}\\ ] ] we retain only the linear combination of the functions @xmath378 .",
    "the constant terms we may ignore , and the one - body terms ( linear combinations of @xmath379 ) we assume are compensated by terms in the one - body jastrow @xmath222 .    if we ignore the removal of one - body terms from the function @xmath380}$ ] and consider using the function @xmath381 instead , then we find that @xmath382 where we have ignored constant and one - body terms in the expansion .",
    "the product @xmath383 contains both two- and three - body terms , since we may rewrite @xmath384 as @xmath385 .",
    "we intend here to remove two - body fluctuations and regard three - body fluctuations as much less significant , so we retain only the two - body term   @xmath386 from the charge fluctuation products in eq .",
    "[ eq : fullquad ] , i.e. , @xmath387 now we make the assumption that removing one - body terms from this expression , i.e. , replacing @xmath381 with @xmath378 is a good approximation , and obtain the expression for @xmath388 given in sec .",
    "[ sec.predictoranalapprox.j2b ] .    the contribution @xmath173 can not be expanded analytically in the basis of fluctuation functions @xmath378 , however , it is clear that @xmath173 is linear in @xmath191 , since , for @xmath389 , @xmath390 and has first derivatives @xmath391 which are independent of the parameters @xmath191 .    the final energy contribution @xmath171 we attempt to express analytically in terms of the two - body fluctuation functions @xmath378 .",
    "if @xmath392 , the lda slater determinant , then the sum of contributions from the external potential and the kinetic energy term @xmath393 is a one - body contribution defined by the kohn - sham hamiltonian ,  @xcite since @xmath394    = \\sum_i [ \\epsilon^{\\rm ks}_i                - v_{\\rm h}({\\bf r}_i ) - v_{\\rm xc}({\\bf r}_i ) ] ~,\\end{aligned}\\ ] ] where @xmath395 are the kohn - sham eigenvalues , @xmath396 is the hartree potential and @xmath397 is the exchange and correlation potential .",
    "therefore , the two - body contribution of these terms is approximately zero .",
    "we are left with the contribution of the electron - electron interaction @xmath164 .",
    "for a two - body potential @xmath398 , we may expand the sum over electron pairs as @xmath399}~,\\end{aligned}\\ ] ] for fourier coefficients @xmath400 . in terms of the fluctuation functions",
    "@xmath378 , this may be rewritten as @xmath401      \\delta \\rho_{\\bf q}^ *    + ~\\mbox{constant}~.\\end{aligned}\\ ] ] ( we assume that @xmath398 possesses exchange symmetry , so that @xmath402 . )",
    "therefore , both one- and two - body fluctuations arise from a two - body potential in the `` charge fluctuation '' coordinate system .",
    "note that the one - body fluctuations are expressible in terms of the hartree potential , since @xmath403    if the two - body potential is homogeneous , i.e. @xmath404 , then we may simplify the fluctuations since @xmath405 , where the fourier transform of the homogeneous function @xmath406 is @xmath407 for a system volume @xmath361 .",
    "if @xmath408 then @xmath409 . therefore , @xmath410 again we ignore the one - body and constant terms in this context .",
    "the short range jastrow factor @xmath22 is constructed from the pseudointeraction @xmath195 in the following way . for the isolated two - electron scattering problem , we may find an eigenstate @xmath411 of the true two - electron hamilatonian @xmath412 for a given energy eigenvalue @xmath197 . upon replacing the true coulomb interaction @xmath164 with a generated pseudointeraction @xmath195 , we construct the modified hamiltonian @xmath413 with eigenstate @xmath414 corresponding to @xmath197 .",
    "we construct @xmath22 such that @xmath415    now , in a many - electron environment , we know that using @xmath22 allows for good approximation of short - range correlations .  @xcite we might imagine that for a many - electron system with hamiltonian @xmath118 and many - electron trial wave function @xmath416 , the true energy eigenvalue may be well approximated by @xmath417 where @xmath418 $ ] .",
    "now , disguising the true interaction @xmath164 with @xmath419 , and given the transferability of @xmath195 over a wide range of energies , we see that @xmath420    dividing two - body correlation into short - range and inhomogeneous terms , we use a jastrow factor of the form @xmath421 .",
    "the local energy determined using the trial wave function @xmath422 , where @xmath423 , may be expanded as @xmath424 for this reason , we use @xmath195 in the expansion of the local energy for @xmath190 to implicitly include the short - range jastrow factor @xmath22 .",
    "the convergence criterion @xmath122 , is numerically never exactly achieved . given that the predictor @xmath425 contains some terms determined by statistical fitting , finite sampling errors exist , and this noise is passed on to the fitted parameters in @xmath425 from eqs .",
    "[ eq : lstsqsys ] and  [ eq : contributionlstsqsys ] .",
    "we consider @xmath426 , the fitted coefficients of the local energy at the @xmath427 iteration of the method .",
    "the method may be regarded as an iterative map @xmath428 , such that the coefficients are determined via @xmath429 .",
    "there are two sources of noise in @xmath430 : ( i ) noise inherited from @xmath431 , which produced the parameters @xmath156 , which were used to construct the wave function @xmath432 , with which we evaluated the expectation values used to calculate @xmath430 ; and ( ii ) finite sampling noise in the evaluation of the expectation values in eqs .",
    "[ eq : lstsqsys ] and  [ eq : contributionlstsqsys ] via monte carlo sampling . therefore",
    ", we associate a set of variances @xmath433 , arising from these two sources of noise , to the coefficients @xmath434 .",
    "the variance due to finite sampling alone , at each step @xmath290 , is @xmath435 and we use the initial condition @xmath436 .",
    "this implies that the variance obeys the following iterative map : @xmath437 where @xmath438 . for a convergent map @xmath428",
    ", we are guaranteed that @xmath439 at convergence .",
    "@xmath440 is a measure of the convergence rate of the map @xmath428 , with @xmath441 implying fast convergence and @xmath442 implying slow convergence .",
    "note that if @xmath443 the map is divergent .",
    "we conclude that , given a convergent method @xmath428 , the presence of statistical noise does not lead to successively more ill - determined parameters @xmath120 , since their variance is also convergent .",
    "note that eq .",
    "[ eq : convvar ] indicates that the variance in the fitted coefficients @xmath126 is always greater than or equal to the variance estimated using finite sampling .",
    "however , our implementation of the method represented by the map @xmath428 indicates that @xmath449 , since we find that the majority of the coefficients @xmath126 ultimately end up with magnitudes approximately equal to their finite sampling errors , signifying that statistically they are zero .",
    "therefore , the final conclusion to be drawn from eq .",
    "[ eq : convvar ] is that the accuracy of our optimization method depends ultimately on the finite sampling error .",
    "therefore , increasing the computational workload , by increasing the amount of sampling , will result in more accurate optimizations of the wave function .",
    "this is demonstrated by the results in sec .",
    "[ sec.discussion ] ."
  ],
  "abstract_text": [
    "<S> a method is presented for the optimization of one - body and inhomogeneous two - body terms in correlated electronic wave functions of jastrow - slater type . </S>",
    "<S> the most general form of inhomogeneous correlation term which is compatible with crystal symmetry is used and the energy is minimized with respect to all parameters using a rapidly convergent iterative approach , based on monte carlo sampling of the energy and fitting of energy fluctuations . </S>",
    "<S> the energy minimization is performed exactly within statistical sampling error for the energy derivatives and the resulting one- and two - body terms of the wave function are found to be well - determined . </S>",
    "<S> the largest calculations performed require the optimization of over 3000 parameters . </S>",
    "<S> the inhomogeneous two - electron correlation terms are calculated for diamond and rhombohedral graphite . </S>",
    "<S> the optimal terms in diamond are found to be approximately homogeneous and isotropic over all ranges of electron separation , but exhibit some inhomogeneity at short- and intermediate - range , whereas those in graphite are found to be homogeneous at short - range , but inhomogeneous and anisotropic at intermediate- and long - range electron separation . </S>"
  ]
}