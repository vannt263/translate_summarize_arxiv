{
  "article_text": [
    "hamilton cycles occupy a position of central importance in graph theory , and are the subject of countless results .",
    "the most famous is of course dirac s theorem @xcite , which states that a hamilton cycle can always be found in any @xmath1-vertex graph with all degrees at least @xmath7 .",
    "much more work has been done to determine conditions for hamiltonicity in graphs , digraphs , hypergraphs , and random and pseudo - random instances of these objects .",
    "see , e.g. , any of @xcite .",
    "there has also been a long history of research concerning conditions for the existence of multiple edge - disjoint hamilton cycles .",
    "indeed , nash - williams discovered that the dirac condition already guarantees not just one , but at least @xmath8 edge - disjoint hamilton cycles .",
    "his questions in @xcite started a line of investigation , leading to recent work by christofides , khn , and osthus @xcite , who answered one of his conjectures asymptotically by proving that minimum degree @xmath9 is already enough to guarantee @xmath10 edge - disjoint hamilton cycles .",
    "for random graphs , these `` packings '' with hamilton cycles are even more complete .",
    "bollobs and frieze @xcite showed that for every fixed @xmath11 , one can typically find @xmath11 edge - disjoint hamilton cycles in the random graph process as soon as the minimum degree reaches @xmath12 .",
    "kim and wormald @xcite established a similar result for random @xmath11-regular graphs , proving that such graphs typically contain @xmath13 edge - disjoint hamilton cycles .",
    "the previous statements are of course best possible , but invite the natural question of what happens when @xmath11 is allowed to grow . along these lines ,",
    "frieze and krivelevich showed in @xcite that one can pack @xmath14 hamilton cycles in @xmath15 , up to @xmath16 , where @xmath17 is the minimum degree of the graph . for large @xmath6 , they discovered in @xcite that one can pack almost all edges into hamilton cycles .",
    "this was later improved to essentially the full range of @xmath6 by knox , khn , and osthus @xcite . in the hypergraph",
    "setting , the study of this hamilton cycle packing problem was initiated by frieze and krivelevich in @xcite .",
    "although the notion of a hamilton cycle in an ordinary graph is clear , there are several ways to generalize the notion to hypergraphs . indeed , for any @xmath18",
    ", we may define a @xmath19-uniform hypergraph @xmath5 to be a _",
    "hamilton cycle of type @xmath20 _ if there is a cyclic ordering of the vertices of @xmath5 so that every edge consists of @xmath19 consecutive vertices , and every pair of consecutive edges @xmath21 in @xmath5 ( according to the natural ordering of the edges ) has @xmath22 .",
    "the extreme cases @xmath23 and @xmath24 are the most obvious generalizations of graph hamiltonicity , and cycles of those types are often called _ tight _ and _ loose _ , respectively . in @xcite",
    ", the first two authors studied the problem of covering almost all the edges of a given @xmath19-uniform hypergraph with disjoint hamilton cycles of a fixed type @xmath20 .",
    "they considered @xmath20 on the looser end of the spectrum , determining sufficient conditions for the cases @xmath25 .",
    "however , their methods did not extend to the regime @xmath26 , which seems more difficult .      in this paper",
    ", we introduce several new techniques which enable us to prove the first results for packing _ tight _",
    "hamilton cycles , i.e. , with @xmath27 . to give the clearest presentation of the new methods involved , we concentrate on the concrete case of 3-uniform hypergraphs , which we refer to as _ 3-graphs _ from now on .",
    "our approach can be naturally extended to the general @xmath19-uniform case , but the explanations necessarily become more involved .",
    "we focus on 3-graphs with certain pseudo - random properties .",
    "consequently , our results will yield corollaries in the standard random 3-graph model , denoted @xmath28 , in which each of the @xmath29 possible edges independently appears with probability @xmath6 .",
    "recall that there are several essentially equivalent notions of pseudo - randomness in graphs , most notably the ones involving uniformity of edge distribution , the second eigenvalue , or the global count of 4-cycles .",
    "( see , e.g. , the survey @xcite . ) however , even in ordinary graphs , these global conditions are insufficient for hamilton cycle packing , because hamilton cycles visit every vertex . therefore , even a single non - conforming vertex can doom the entire packing process .",
    "this situation can be prevented by localizing the specification of the pseudo - random criteria .",
    "importantly , the resulting stronger conditions are still satisfied by the random objects in question .",
    "for example , in the graph case , this can be done by controlling the degrees and codegrees ( see , e.g. , @xcite ) .",
    "note that this is a special case of the more general notion of controlling the numbers of _ extensions _ to certain specific subgraphs , uniformly over all base sites , instead of just the global number of copies of a certain graph ( @xmath30 , say ) .",
    "the following definition generalizes that concept to 3-graphs .",
    "[ def:3graph - ext ] let @xmath31 be distinct vertices of a 3-graph @xmath0 , and let @xmath32 be a graph on vertex set @xmath33 $ ] .",
    "then , we define @xmath34 to be the number of vertices @xmath35 such that @xmath36 for every edge @xmath37 .",
    "* example 1 . *",
    "if @xmath38 and @xmath32 is a single edge , then @xmath39 is the number of edges which contain the pair @xmath40 .",
    "this can be interpreted as a generalized notion of degree .",
    "* example 2 . * in general ,",
    "if @xmath32 is the complete graph on @xmath41 vertices , then @xmath42 is the number of @xmath43 which simultaneously form edges with all pairs @xmath44 .",
    "this can be interpreted as a generalized notion of codegree .",
    "we can now state our localized version of pseudo - randomness , which we will later show is satisfied by the random 3-graph @xmath28 * whp * is said to occur _ with high probability _",
    "( abbreviated * whp * ) , if @xmath45 .",
    "] when @xmath6 is not too small .",
    "since we need to control many quantities within certain ranges , we will employ the notation @xmath46 as a shorthand for the pair of inequalities @xmath47 .",
    "[ def:3graph - props ] we say that an @xmath1-vertex 3-graph @xmath0 is * @xmath48-uniform * if for every auxiliary graph @xmath32 on @xmath49 vertices and @xmath50 edges , and every choice of distinct vertices @xmath51 , we have @xmath52    * remark . * we do not actually need the full strength of this definition , as will be clear in the proof of lemma [ lem : d ] in section [ sec:3graph ] .",
    "indeed , there are only 5 specific graphs @xmath32 with respect to which we require control ( depicted in figure [ fig : gamma ] of section [ sec:3graph ] ) .",
    "however , we feel that the description is more succinctly captured in the above statement .",
    "the main result of this paper establishes the first known packing result for tight hamilton cycles in pseudo - random hypergraphs . here , and",
    "in the rest of this paper , we write @xmath53 if @xmath54 as @xmath55 .",
    "[ thm:3graph ] suppose that @xmath1 is a sufficiently large multiple of four , and @xmath56 .",
    "then every @xmath57-uniform 3-graph with @xmath1 vertices can have all but at most @xmath58-fraction of its edges covered by a disjoint union of tight hamilton cycles .",
    "note that in @xmath28 , for each graph @xmath32 with @xmath50 edges on a set of @xmath59 vertices , the value of @xmath60 has distribution @xmath61}$ ] .",
    "so , the chernoff bound in section [ sec : tools ] ( fact [ fact : chernoff ] ) shows that as long as @xmath62 , we have @xmath63 }    =    o(n^7 ) \\cdot    \\sum_{s=1}^6 { \\mathbb{p}\\left[{\\text{\\rm bin}\\left[n , p^s\\right ] } \\neq ( 1 \\pm \\e ) np^s\\right ] }    =    o(1),\\ ] ] giving the following immediate corollary .",
    "[ cor:3graph ] suppose that @xmath64 satisfy @xmath65 .",
    "then whenever @xmath1 is a multiple of four , @xmath28 can have all but at most @xmath58-fraction of its edges covered by a disjoint union of tight hamilton cycles * whp*.    * remark . *",
    "although both results are stated for @xmath1 divisible by 4 , we expect that they are true in general .",
    "note , however , that a divisibility condition is unavoidable in the general case of packing hamilton cycles of type @xmath20 in @xmath19-uniform hypergraphs , since @xmath20 must divide @xmath1 .    along the way",
    ", we also prove a new result about packing hamilton cycles in pseudo - random digraphs .",
    "the result differs from that in @xcite as our definition of pseudo - randomness is local instead of global , and therefore may be easier to apply in some situations .",
    "indeed , the previous result required a minimum degree condition , together with bounds on the edge distributions across almost all cuts . we can now replace the latter conditions with two more local statements",
    "the specific conditions that we impose below have been tailored for the task of producing hamilton cycles in digraphs .",
    "[ def : digraph - props ] we say that an @xmath1-vertex digraph is * @xmath48-uniform * if it satisfies the following properties :    ( i ) : :    every vertex @xmath66 has out - degree    @xmath67 and in - degree @xmath68 .",
    "( ii ) : :    for every pair of distinct vertices @xmath69 , all three of    the following quantities are @xmath70 : the    number of common out - neighbors @xmath71 , the number of    common in - neighbors @xmath72 , and the number of    out - neighbors of @xmath66 which are also in - neighbors of    @xmath73 .",
    "( iii ) : :    given any four vertices @xmath74 , which are all    distinct except for the possibility @xmath75 , there are    @xmath76 vertices @xmath43 such that    @xmath77 ,    @xmath78 ,    @xmath79 ,    @xmath80 are all directed edges",
    ".    * remark .",
    "* it is not clear that this is the minimal set of pseudo - random conditions which enable hamilton cycle packing in directed graphs .",
    "we choose the above statements because they naturally arise from our analysis , and are therefore the most convenient for our purposes .",
    "importantly , one can easily see that they are satisfied by random digraphs * whp * , as long as the edge probability is not too small .    under these easily - verifiable conditions , we are able to prove the following packing result for digraphs , which has the obvious corollary for random digraphs which are not too sparse .",
    "[ thm : digraph ] suppose that @xmath81 , and @xmath1 is a sufficiently large even integer .",
    "then every @xmath82-uniform digraph can have its edges partitioned into a disjoint union of directed hamilton cycles , except for a set of at most @xmath83-fraction of its edges .",
    "although we originally developed this result only as a building block for our 3-graph analysis in section [ sec:3graph ] , we feel it is worth bringing attention to , as it may be of independent interest .",
    "in particular , it is easier to apply than its counterpart in @xcite , because our pseudo - randomness conditions are easier to verify .",
    "the key insight in the proof of theorem [ thm:3graph ] is the following connection between tight hamilton cycles in @xmath0 and hamilton cycles in an associated digraph .",
    "for a random permutation @xmath84 of the vertices of @xmath0 , define an @xmath85-vertex digraph @xmath86 with vertex set @xmath87 .",
    "note that each vertex of @xmath86 corresponds to an ordered pair of vertices of @xmath0 , so @xmath86 will have an even number of vertices , since the number of vertices of @xmath0 is a multiple of 4 .",
    "place a directed edge from @xmath88 to @xmath89 if and only if both hyperedges @xmath90 and @xmath91 are present in @xmath0 . in this construction ,",
    "hamilton cycles in @xmath86 give rise to tight hamilton cycles in @xmath0 .",
    "to extract edge disjoint hamilton cycles from a digraph @xmath86 with an even number of vertices , we use an approach similar to that taken in @xcite .",
    "let @xmath92 be a random permutation of the vertices of @xmath86 with @xmath93 , and define @xmath94 and @xmath95 .",
    "define a bipartite graph @xmath96 with bipartition @xmath97 , and place an edge between @xmath98 and @xmath99 whenever @xmath100 and @xmath101 are both edges of @xmath86 .",
    "now perfect matchings in @xmath32 give rise to hamilton cycles in @xmath86 , and previous approaches in @xcite show how to pack perfect matchings in pseudo - random bipartite graphs .",
    "however , not all hamilton cycles in @xmath86 arise from perfect matchings in one particular @xmath32 . similarly ,",
    "not all hamilton cycles in @xmath0 arise from hamilton cycles in a single @xmath86 .",
    "we overcome both obstacles with the same iterative approach , which we illustrate for the hypergraph packing . roughly speaking , instead of stopping after generating a single @xmath86",
    ", we sequentially generate digraphs @xmath102 in the above manner , extracting a large set of edge disjoint directed hamilton cycles from each , and deleting the corresponding edge - disjoint hamilton cycles from @xmath0 . at each step",
    ", we verify that the pseudo - random properties are maintained .",
    "we repeat the process until we have packed the required number of cycles .",
    "since the digraph packing and hypergraph packing proofs are essentially independent ( though similar ) , we separate them into sections [ sec : digraph ] and [ sec:3graph ] , respectively .",
    "all required concentration inequalities are collected in section [ sec : tools ] for the reader s convenience .",
    "the final section contains some concluding remarks and open problems .",
    "we will implicitly assume throughout that @xmath103 are small , e.g. , less than @xmath104 .",
    "our results have them tending to zero . the following ( standard ) asymptotic notation will be utilized extensively . for two functions @xmath105 and @xmath106 , we write @xmath107 or @xmath108 if @xmath109 , and @xmath110 or @xmath111 if there exists a constant @xmath112 such that @xmath113 for all sufficiently large @xmath1",
    ". we also write @xmath114 if both @xmath115 and @xmath116 are satisfied .",
    "all logarithms will be in base @xmath117 .",
    "we recall the chernoff bound for exponential concentration of the binomial distribution .",
    "the following formulation appears in , e.g. , @xcite .",
    "[ fact : chernoff ] for any @xmath118 , there exists @xmath119 such that any binomial random variable @xmath120 with mean @xmath121 satisfies @xmath122 } < e^{-c_\\epsilon \\mu},\\ ] ] where @xmath123 is a constant determined by @xmath124 .",
    "when @xmath125 , we may take @xmath126 .",
    "a binomial random variable is the sum of independent indicator variables .",
    "we also need concentration in settings which are still product spaces , but are somewhat more complicated than simple binomials . a random variable @xmath127 defined over an @xmath1-dimensional product space @xmath128",
    "is called @xmath5-lipschitz if changing @xmath129 in any single coordinate affects the value of @xmath127 by at most @xmath5 .",
    "the hoeffding - azuma inequality ( see , e.g. , @xcite ) provides concentration for these distributions .",
    "[ fact : azuma ] let @xmath120 be a @xmath5-lipschitz random variable on an @xmath1-dimensional product space .",
    "then for any @xmath130 , @xmath131 } | > t \\right ] }      \\leq      2 \\exp\\left\\ {        -\\frac{t^2}{2 c^2 n }      \\right\\}.\\ ] ]    we also need concentration in settings where the probability space is not a simple @xmath1-dimensional product space , but rather the set of permutations on @xmath1 elements .",
    "the following concentration inequality can be found in , e.g. , section 3.2 of @xcite or lemma 11 of @xcite .",
    "[ fact : conc - perm ] let @xmath120 be a random variable on the uniformly distributed probability space of permutations on @xmath1 elements , and let @xmath5 be a real number . suppose that whenever @xmath132 differ by a single transposition , @xmath133 .",
    "then , @xmath134 } \\right| \\geq t\\right ] }       \\leq       2\\exp\\left\\ {          -\\frac{2t^2}{c^2 n }      \\right\\}.\\ ] ]",
    "in this section , we show how to complete the outline in section [ sec : overview ] for hamilton cycle packing in digraphs .",
    "recall that the main idea in this part is to reduce the problem to packing perfect matchings in bipartite graphs .",
    "we begin by showing how to achieve the final step .      here , we will show that we can efficiently decompose a suitably uniform bipartite graph into perfect matchings .",
    "this is contained in the following proposition , whose statement is very similar to lemma 6 of @xcite . for completeness",
    ", we provide a slightly different proof here .    [",
    "prop : graph ] let @xmath135 be a bipartite graph with parts @xmath136 and @xmath137 , each of size @xmath138 .",
    "suppose that @xmath139 are given such that every vertex has degree @xmath140 , and every pair of distinct vertices has codegree at most @xmath141 .",
    "also assume that @xmath142 .",
    "then the edges of @xmath135 can be partitioned into the disjoint union @xmath143 , where @xmath144 and each @xmath145 with @xmath146 is a perfect matching .",
    "we mentioned in the introduction that although pseudo - randomness can be deduced from the global 4-cycle count , local conditions are required to pack spanning objects such as hamilton cycles or perfect matchings .",
    "for bipartite graphs , the above proposition s conditions on codegrees and degrees provide this localized property . indeed , the concentrated codegree condition implies the global bound on the number of 4-cycles , simply by summing over all vertex pairs .",
    "the following lemma converts this into a suitable bound on the uniformity of edge distribution  another pseudo - random property , which we actually need to complete this proof .",
    "[ lem : flow - prelim ] let @xmath135 be a bipartite graph with parts @xmath136 and @xmath137 , each of size @xmath138 .",
    "let @xmath120 and @xmath147 be subsets of @xmath136 and @xmath137 , respectively , with @xmath148 and @xmath149 .",
    "suppose that @xmath103 are given such that every vertex in @xmath120 has degree @xmath140 , and every pair of distinct vertices in @xmath120 has codegree at most @xmath141 .",
    "then @xmath150 .    *",
    "* let @xmath151 and @xmath152 . for each vertex @xmath153 , let @xmath154 denote the number of neighbors @xmath155 has in @xmath120 . define the random variable @xmath156 by sampling a uniformly random vertex @xmath153 , and setting @xmath157 . since every vertex in @xmath120 has degree at least @xmath158 , we have @xmath159 , and so @xmath160 } \\geq ( 1-\\epsilon ) xp$ ] .    from the codegree condition ,",
    "the number of labeled paths of length 2 from @xmath120 to @xmath120 is at most @xmath161 .",
    "this quantity is also equal to @xmath162 so @xmath163 .",
    "therefore , @xmath164 } \\leq ( 1+\\epsilon ) ( x^2 p^2 + xp)$ ] , which is at most @xmath165 since we assumed @xmath166 .",
    "this implies that @xmath167 } = { \\mathbb{e}\\left[z^2\\right ] } - { \\mathbb{e}\\left[z\\right]}^2 \\leq 5\\epsilon(xp)^2 $ ] , and this low variance will allow us to conclude that vertices in @xmath147 can not have an average @xmath168 which is too low .",
    "formally , if we assume for contradiction that @xmath169 , then jensen s inequality gives ( here , @xmath170 is a shorthand for @xmath160}$ ] ) : @xmath171 }    & \\geq &     \\left ( { \\mathbb{e}\\left[z-\\overline{z } \\mid v \\in y\\right ] } \\right)^2 \\\\    & = &    \\left ( \\frac{e(x , y)}{|y| } - \\frac{e(x , b)}{|b| } \\right)^2 \\\\    & \\geq &    \\left ( ( 3\\epsilon^{1/3 } - \\epsilon)(xp ) \\right)^2 \\\\    & > & 5 \\epsilon^{2/3 } ( xp)^2.\\end{aligned}\\ ] ] yet a uniformly random vertex in @xmath137 lies in @xmath147 with probability at least @xmath172 , so @xmath173 }     \\geq     { \\mathbb{e}\\left[(z-\\overline{z})^2 \\mid v \\in y\\right ] } \\cdot { \\mathbb{p}\\left[v \\in y\\right ] }     >     5\\epsilon ( xp)^2,\\ ] ] contradiction .",
    "@xmath174    now that we know the edges are distributed fairly uniformly , we can prove the packing result using the maxflow - mincut theorem .    *",
    "proof of proposition [ prop : graph ] . * first , observe that if we can pack @xmath175 edge - disjoint perfect matchings into @xmath135 , then the proportion of unused edges is at most @xmath176 we will use the maxflow - mincut theorem to show that we can indeed pack @xmath19 matchings . observe that one can pack @xmath19 edge - disjoint perfect matchings in @xmath135 if and only if the following network has an integer flow of size exactly @xmath177 .",
    "give each edge in @xmath135 a capacity of 1 , and direct it from @xmath136 to @xmath137 .",
    "add a source vertex @xmath178 , with an edge of capacity @xmath19 to each vertex in @xmath136 , and add a sink vertex @xmath179 , with an edge of capacity @xmath19 from each vertex in @xmath137 .",
    "clearly , an integer flow of size @xmath177 is achieved if and only if the subset of used edges between @xmath136 and @xmath137 forms a @xmath19-regular graph .",
    "since every @xmath19-regular bipartite graph can be decomposed into @xmath19 edge - disjoint perfect matchings , this completes the argument .",
    "all capacities are integers , so there is an integer flow which achieves the maximum size .",
    "therefore , by the maxflow - mincut theorem , it remains to show that every cut has size at least @xmath177 .",
    "consider an arbitrary cut .",
    "let @xmath180 be those vertices of @xmath136 which are on the same side as @xmath178 , and let @xmath181 be those vertices of @xmath137 which are on the same side as @xmath179 .",
    "let @xmath151 and @xmath182 .",
    "therefore , it suffices to establish the following inequality for all choices of @xmath180 and @xmath181 : @xmath183 this is purely an inequality about the original graph @xmath135 .",
    "since it is symmetric in @xmath120 and @xmath147 , assume without loss of generality that @xmath184 .",
    "we will use lemma [ lem : flow - prelim ] to estimate @xmath185 , but first , we will need to dispose of the boundary cases @xmath186 and @xmath187 , in which it does not apply . in the first case , observe that we automatically have @xmath188 as well , so @xmath189 is already at least @xmath177 .",
    "( we may assume @xmath190 . ) in the second case , note that if @xmath191 , then @xmath189 is already at least @xmath177 .",
    "so , we may assume that @xmath192 .",
    "yet every vertex in @xmath120 has at least @xmath158 neighbors in @xmath137 , and only at most @xmath193 of them can be outside @xmath147 . therefore , @xmath194    \\geq     x \\cdot \\left [ ( 1-\\epsilon)mp - \\frac{1}{\\epsilon p } \\right ]    \\geq    x \\cdot ( 1 - 2\\epsilon^{1/3})mp,\\ ] ] since we assumed that @xmath195 . yet",
    "the final quantity exceeds @xmath196 , so we also have inequality in this case .    in all remaining cases",
    ", we see that lemma [ lem : flow - prelim ] applies , so @xmath197 the right - hand side is bilinear in @xmath43 and @xmath198 , so it is minimized when @xmath199 .",
    "if either of @xmath43 or @xmath198 are 0 , then one of the first two terms is already @xmath177 . on the other hand ,",
    "if @xmath200 , then the expression is precisely @xmath201 as well .",
    "therefore , all cuts in the network have size at least @xmath177 , so by the maxflow - mincut theorem , there is a flow of size @xmath177 , completing the proof .",
    "@xmath174      now that proposition [ prop : graph ] allows us to efficiently pack perfect matchings , we can use it as the base to which we reduce the problem of packing hamilton cycles in directed graphs . throughout this section ,",
    "all directed graphs have no loops , and no repeated edges in the same direction .",
    "however , they may have edges in both directions between pairs of vertices .",
    "the main objective of this section is to prove theorem [ thm : digraph ] , which allows us to efficiently pack hamilton cycles in digraphs that have the pseudo - random properties specified in definition [ def : digraph - props ] . as mentioned in the proof overview in section [ sec : overview ] , we extract hamilton cycles from digraphs by connecting them to perfect matchings in ordinary graphs .",
    "consider the following random procedure , which constructs an undirected bipartite graph @xmath32 from a digraph @xmath86 with an even number of vertices .",
    "* procedure 1 .",
    "* this takes as input a digraph @xmath86 with an even number of vertices .    1 .",
    "generate a random permutation @xmath202 of the vertices of @xmath86 .",
    "consider this sequence as two consecutive segments of length @xmath85 , and let @xmath203 and @xmath204 .",
    "the graph @xmath32 will be a bipartite graph with parts @xmath136 and @xmath137 .",
    "2 .   define _ the successor of @xmath205 _ to be @xmath206 , unless @xmath207 ( in which case the successor is @xmath208 ) or @xmath209 ( in which case it is @xmath210 ) .",
    "similarly , define _ the predecessor of @xmath205 _ to be @xmath211 , unless @xmath212 ( in which case it is @xmath213 ) , or @xmath214 ( in which case it is @xmath215 ) .",
    "3 .   for @xmath216 and @xmath217 , place the edge @xmath218 in @xmath32 if and only if @xmath86 contains both directed edges @xmath219 and @xmath220 , where @xmath221 is the successor of @xmath205 as defined in the previous step .",
    "since an edge in @xmath32 corresponds to two edges in @xmath86 , we account for this by defining @xmath222 to be the digraph containing all @xmath223 , for each @xmath224 with @xmath216 .",
    "the key observation is that perfect matchings in @xmath32 cleanly correspond to hamilton cycles in @xmath225 .",
    "specifically , given a perfect matching @xmath112 in @xmath32 , one can recover a hamilton cycle in @xmath225 .",
    "indeed , for each @xmath216 , @xmath112 matches @xmath205 to a distinct @xmath226 .",
    "so , @xmath227 is a directed hamilton cycle in @xmath225 ; call this the hamilton cycle _ associated with",
    "_ @xmath112 .",
    "[ lem : hamilton - matching ] let @xmath228 be edge - disjoint perfect matchings in @xmath32",
    ". then their associated hamilton cycles @xmath229 are also edge - disjoint in @xmath225 .",
    "* proof . *",
    "since @xmath230 and @xmath231 are disjoint , it is clear that @xmath232 and @xmath233 can not overlap on any edges directed from @xmath136 to @xmath137 . on the other hand , if both @xmath234 contain the same edge @xmath235 , where @xmath217 and @xmath236 , then they also both contain @xmath237 , by definition of @xmath234 .",
    "then both @xmath238 contain the edge @xmath239 , contradiction .",
    "@xmath174    the next step , as we mentioned in the proof overview in the introduction , is to show that the randomly constructed bipartite graph inherits the pseudo - random properties of the initial digraph .",
    "[ lem : gamma ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath240 .",
    "let @xmath86 be an @xmath82-uniform digraph on @xmath1 vertices ( @xmath1 even ) , and randomly construct the undirected bipartite graph @xmath32 according to procedure 1 .",
    "then , with probability @xmath241 , @xmath32 satisfies all of the following properties :    ( i ) : :    all degrees are @xmath242 .",
    "( ii ) : :    all codegrees between pairs of vertices on the same side of the    bipartition are @xmath243",
    ".    * proof .",
    "* by construction , @xmath32 is a bipartite graph with parts @xmath244 and @xmath245 .",
    "there are essentially four claims to prove , as the parts @xmath136 and @xmath137 are not constructed symmetrically .",
    "* claim 1 : degrees in @xmath246 are correct .",
    "* to show this , for an arbitrary vertex @xmath66 , define a random variable @xmath247 as follows .",
    "let @xmath73 be the successor of @xmath66 , as defined in step 2 of procedure 1 .",
    "@xmath247 is of no interest when @xmath248 but allowing @xmath248 makes the proof a trifle simpler . by definition , @xmath66 and @xmath73",
    "are either both in @xmath136 or both in @xmath137 ; let @xmath247 be the number of vertices @xmath43 in the other part such that both @xmath77 and @xmath78 are edges of @xmath86 .",
    "note that @xmath247 is actually the degree of @xmath66 in @xmath32 if @xmath66 happens to end up in @xmath136 .",
    "therefore , it suffices to show that @xmath249 with probability @xmath250 .",
    "note that the random variable @xmath247 is completely determined by the permutation @xmath178 .",
    "expose @xmath178 in stages .",
    "first , expose which index @xmath251 has @xmath252 .",
    "next , expose the identity of the vertex @xmath73 which is the successor of @xmath66 .",
    "this determines @xmath205 and @xmath221 , where @xmath253 is either @xmath254 , @xmath255 , or @xmath256 .",
    "conditioned on these , the associations to the remaining vertices @xmath257 are a uniform permutation over the remaining @xmath258 vertices .",
    "yet the last part of property ( ii ) for @xmath82-uniformity shows that in @xmath86 , the number of vertices @xmath43 with @xmath77 and @xmath78 in @xmath86 is @xmath259 . as each @xmath43 will land in the part",
    "opposite @xmath260 with probability exactly @xmath261 , we immediately have @xmath262 } = ( 1 \\pm 2\\epsilon)\\frac{np^2}{2}$ ] .    for concentration",
    ", we use fact [ fact : conc - perm ] .",
    "we already conditioned on @xmath66 and @xmath73 , so the remaining randomness is from a uniformly random permutation of @xmath258 elements .",
    "transposing two of those elements can only change @xmath247 by at most 1 , so by fact [ fact : conc - perm ] , @xmath247 deviates from its expectation by @xmath263 with probability at most @xmath264 therefore , @xmath247 is indeed @xmath265 with probability @xmath266 , as desired .    *",
    "claim 2 : degrees in @xmath267 are correct . *",
    "consider an arbitrary vertex @xmath73 .",
    "let @xmath268 be the set of ordered pairs of distinct vertices @xmath269 with @xmath270 . by property ( i ) of @xmath271-uniformity ,",
    "@xmath73 has @xmath272 in - neighbors , and @xmath273 out - neighbors . since @xmath274",
    ", this implies that @xmath275 .",
    "let @xmath276 be the number of these pairs that , after the permutation @xmath178 , have the additional properties that * ( i ) * both @xmath43 and @xmath198 are on the opposite side of the bipartition to @xmath73 , and * ( ii ) * @xmath198 is the successor of @xmath43 .",
    "it suffices to show that @xmath276 is @xmath277 with probability @xmath266 , because @xmath276 is precisely the degree of @xmath73 whenever @xmath73 happens to end up in @xmath137 .",
    "for this , we employ the same strategy as used in the previous claim .",
    "first expose the index @xmath251 for which @xmath278 .",
    "then , the locations of the remaining vertices are uniformly permuted amongst the remaining @xmath279 positions . for",
    "a given ordered pair @xmath280 , the probability that @xmath43 lands on the opposite side of @xmath73 is precisely @xmath281 .",
    "then , conditioned on this , the probability that @xmath198 is the successor of @xmath43 is precisely @xmath282 .",
    "therefore , @xmath283 }     =     |s_b| \\cdot \\frac{n/2}{n-1 } \\cdot \\frac{1}{n-2 }    =    ( 1 \\pm 4\\epsilon ) \\frac{np^2}{2}.\\ ] ] for concentration , we again expose @xmath73 first , and then consider the resulting @xmath284-permutation . consider two such permutations @xmath178 and @xmath285 differing only on a single transposition .",
    "transposing two of those elements can only change @xmath276 by at most 4 , so by fact [ fact : conc - perm ] , the probability that @xmath276 deviates by over @xmath286 from its expectation is at most @xmath287 as before .",
    "hence @xmath276 is indeed @xmath242 with the desired probability @xmath266 .",
    "* claim 3 : co - degrees in @xmath246 are correct . *",
    "this is similar to claim 1 .",
    "fix any two distinct vertices @xmath66 and @xmath73 , and let @xmath288 and @xmath289 be their respective successors as defined in step 1 of procedure 1 .",
    "note that we may have @xmath75 or @xmath290 , but not both .",
    "let @xmath291 be the number of vertices @xmath43 such that @xmath43 is on the opposite side of @xmath66 , and @xmath292 .",
    "expose the indices @xmath293 for which @xmath252 and @xmath294 , and expose their successors @xmath288 and @xmath289 .",
    "the remaining vertices are uniformly permuted over the remaining @xmath295 positions ( or @xmath296 positions if @xmath297 or @xmath298 , although the argument will be the same ) . by property ( iii ) of @xmath82-uniformity , there are @xmath299 candidates for @xmath43 . as each @xmath43 will land in the part opposite @xmath66 with probability either @xmath300 ( if @xmath73 is on the same side as @xmath66 ) or @xmath301 ( if @xmath73 is opposite @xmath66 ) , it follows that @xmath302 } = ( 1 \\pm 2\\epsilon ) \\frac{np^4}{2}$ ] .",
    "a transposition in the @xmath303-permutation can only affect @xmath291 by at most 1 , so the probability that @xmath291 deviates from its expectation by over @xmath304 is at most @xmath305 taking a union bound over all pairs @xmath306 yields the desired result .",
    "* claim 4 : co - degrees in @xmath267 are correct .",
    "* this is similar to claim 2 .",
    "fix any two distinct vertices @xmath66 and @xmath73 , and let @xmath307 be the set of ordered pairs of distinct vertices @xmath269 with @xmath308 . by property ( ii ) of @xmath82-uniformity , @xmath66 and @xmath73 have @xmath70 common in - neighbors , and @xmath309 common out - neighbors . since @xmath310 , this implies that @xmath311 .",
    "let @xmath291 be the number of these pairs that , after the permutation @xmath178 , have the additional properties that * ( i ) * both @xmath43 and @xmath198 are on the opposite side of the bipartition from @xmath66 , and * ( ii ) * @xmath198 is the successor of @xmath43 .",
    "expose the indices @xmath293 for which @xmath252 and @xmath294 ; the remainder is then an @xmath312-permutation over the leftover positions .",
    "a similar calculation to claim 2 shows that @xmath302 } = ( 1 \\pm 4\\epsilon ) \\frac{np^4}{2}$ ] , and a similar concentration argument shows that @xmath291 is within @xmath304 of its mean with probability @xmath313 .",
    "therefore , a union bound over all @xmath314 completes the proof of this final claim , and the proof of lemma [ lem : gamma ] @xmath174    at this point , we could immediately apply the results of section [ sec : graph ] to pack @xmath32 with perfect matchings , which then correspond to hamilton cycles in @xmath86 .",
    "however , it is unfortunate that this would miss most of the edges of @xmath86 , since not all edges of @xmath86 are in correspondence with edges of @xmath32 .",
    "the solution is to iterate procedure 1 several times .",
    "some care must be taken because the edges of @xmath86 will be covered many times by different @xmath32 .",
    "we will specify how to deal with this in procedure 2 below , but first we collect two intermediate results which control this multiplicity over several iterations of procedure 1 .    [",
    "lem : gamma - cover ] suppose @xmath1 and @xmath124 satisfy @xmath315 .",
    "let @xmath86 be an @xmath82-uniform digraph on @xmath1 vertices ( @xmath1 even ) , and randomly and independently construct @xmath316 graphs @xmath317 according to procedure 1 .",
    "let @xmath318 be their corresponding digraphs .",
    "then , with probability @xmath319 , every edge of @xmath86 is covered @xmath320 times by the @xmath318 .",
    "* fix an arbitrary edge @xmath321 , and let @xmath322 be the probability that it appears in @xmath225 if @xmath32 is constructed according to procedure 1 .",
    "since the @xmath318 are independent , the number of times @xmath321 is covered will then be @xmath323}$ ] , and we will use the chernoff bounds to prove concentration .",
    "so , let @xmath324 be the permutation which produces @xmath32 , and let @xmath136 and @xmath137 be the two sides of the bipartition as defined in procedure 1 .",
    "there are two ways that @xmath321 can appear in @xmath225 : either @xmath325 and @xmath153 and @xmath326 for the successor @xmath327 of @xmath328 , or @xmath329 and @xmath330 and @xmath331 for the predecessor @xmath332 of @xmath155 .",
    "these two cases are clearly disjoint , so @xmath333 , where @xmath334 and @xmath335 are the respective probabilities in these two cases . to calculate @xmath334 , the probability that @xmath336 is precisely @xmath337 . conditioned on this , the probability that @xmath153 is precisely @xmath281 . by property ( i ) of @xmath271-uniformity , @xmath338 , so the probability that some out - neighbor of @xmath155 becomes the successor of @xmath328 is @xmath339 .",
    "therefore , @xmath340 since @xmath341 .",
    "an analogous calculation shows that @xmath342 as well .",
    "hence @xmath343 .    now , the number of times that @xmath321 is covered by the @xmath318 is precisely @xmath323}$ ] . since @xmath344",
    ", the chernoff bound implies that the probability that the binomial deviates from its mean by more than a factor of @xmath345 is at most @xmath346 taking a union bound over all @xmath347 edges @xmath321 , we obtain the desired result .",
    "[ lem : gamma - rare - consec ] suppose @xmath348 .",
    "construct @xmath11 independent @xmath349 according to procedure 1 . then with probability @xmath319 , every pair of distinct vertices @xmath350 has the property that @xmath73 is the successor of @xmath66 in at most 5 of the permutations for @xmath349 .",
    "* for a fixed pair @xmath306 , the probability that @xmath73 is the successor of @xmath66 in a single run of procedure 1 is exactly @xmath351 .",
    "therefore , the probability of this occurring more than 5 times in @xmath11 independent runs is at most @xmath352 . taking a union bound over all pairs @xmath306",
    ", we obtain the result .",
    "@xmath174    since a single run of procedure 1 packs very few edges into hamilton cycles , we must repeat the procedure multiple times , deleting the packed edges from @xmath86 after each round .",
    "however , it is important to maintain the pseudo - random properties through the iterations , and the set of removed edges after a single run of procedure 1 would be too sparse to control the changes in the pseudo - random counts .",
    "the following extension provides one way to achieve this , by repeating procedure 1 enough times to uniformly involve all edges of @xmath86 .",
    "* procedure 2 .",
    "* this takes as input a digraph @xmath86 with an even number of vertices , and an integer parameter @xmath11 .    1 .",
    "independently generate the random undirected bipartite graphs @xmath353 , ",
    ", @xmath354 according to procedure 1 , and let @xmath355 , @xmath318 , @xmath356 , and @xmath357 be their corresponding permutations , digraphs , and bipartitions , respectively .",
    "2 .   for each edge",
    "@xmath358 , let @xmath359 . if @xmath360 , then independently select a uniformly random index in @xmath361 to label @xmath321 with .",
    "3 .   for each @xmath349 , define a subgraph @xmath362 by keeping each edge @xmath363 ( @xmath364 and @xmath365 ) if and only if both @xmath366 and @xmath367 are labeled by @xmath251 , where @xmath368 is the successor of @xmath66 according to @xmath355 .",
    "4 .   for each @xmath251 , let @xmath369 be the digraph containing all @xmath370 , for each @xmath371 , with @xmath372 , where @xmath368 is the successor of @xmath66 according to @xmath355 .",
    "observe that the final step ensures that the @xmath369 are all disjoint .",
    "so , lemma [ lem : hamilton - matching ] shows that we can work independently on each @xmath369 , packing hamilton cycles by packing perfect matchings in @xmath362 with proposition [ prop : graph ] .",
    "after this , we will remove all @xmath369 from @xmath86 , and show that their distribution is sufficiently uniform for us to maintain the necessary pseudo - random properties .",
    "the following lemma shows that the @xmath362 themselves are sufficiently pseudo - random for us to apply proposition [ prop : graph ] .",
    "[ lem : gamma - prime ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath373 .",
    "let @xmath86 be an @xmath82-uniform digraph on @xmath1 vertices ( @xmath1 even ) , and conduct procedure 2 with @xmath316 .",
    "let @xmath374 .",
    "then , with probability @xmath319 , every @xmath362 satisfies the following properties :    ( i ) : :    all degrees are @xmath375 .",
    "( ii ) : :    all codegrees between pairs of vertices on the same side of the    bipartition are @xmath376 .    *",
    "proof . * our restrictions on @xmath64 allow us to apply lemmas [ lem : gamma ] and [ lem : gamma - cover ] , so we have that with probability @xmath319 , after step 1 of procedure 2 :    ( a ) : :    every @xmath349 has all degrees    @xmath377 and all same - side codegrees    @xmath378 .",
    "( b ) : :    every edge in @xmath86 is covered    @xmath379 times by the    @xmath318 .",
    "condition on the above outcome of step 1 , and consider an arbitrary @xmath362 , which is derived from @xmath349 with bipartition @xmath380 .",
    "it suffices to show that in the randomness of step 2 , with probability @xmath266 each individual @xmath362 has the desired properties , since @xmath381 by the given restrictions on @xmath64 .",
    "there are four cases to consider : degrees in @xmath356 , degrees in @xmath357 , codegrees in @xmath356 , and codegrees in @xmath357 .",
    "fortunately , they will all follow by essentially the same argument .",
    "we begin with the degree of an arbitrary vertex @xmath382 . by",
    "( a ) above , the degree of @xmath328 in @xmath349 is @xmath383 .",
    "note that this actually corresponds to exactly @xmath384 pairs of directed edges in @xmath86 , of the form @xmath385 , and all @xmath386 directed edges involved are distinct .",
    "step 2 of procedure 2 assigns labels to all directed edges , and the degree of @xmath328 in @xmath362 is precisely the number of the above pairs of directed edges for which both edges are labeled @xmath251 . since every directed edge is covered @xmath379 times by ( b ) and the edges are labeled independently , the probability that both of a given pair above receive label @xmath251 is @xmath387^{-2}$ ] . therefore , the expected degree of @xmath328 in @xmath362 is @xmath388 .",
    "furthermore , since all directed edges involved are distinct , the chernoff bound shows that the probability of the degree deviating from its mean by more than a factor of @xmath389 is at most @xmath390 because @xmath391 .",
    "therefore , with probability @xmath313 , the degree of @xmath328 in @xmath362 is @xmath392 . taking a union bound over all",
    "@xmath382 establishes part ( i ) for those degrees .",
    "the arguments for the other three parts of the lemma are similar . for a vertex @xmath393 ,",
    "its incident edges in @xmath349 correspond to @xmath394 disjoint pairs of directed edges , so the exact same argument as above produces the bound for these degrees .",
    "the codegree of a given pair of vertices @xmath395 corresponds to disjoint quadruples of distinct directed edges . from (",
    "a ) , there are @xmath243 such quadruples .",
    "the probability that a given quadruple is completely labeled by @xmath251 is @xmath396^{-4}$ ] by ( b ) , so the expected codegree in @xmath362 is @xmath397 . by the chernoff bound , the probability that the codegree deviates from its expectation by a factor of more than @xmath398 is at most @xmath399 since @xmath400 .",
    "taking a union bound over all pairs of vertices @xmath395 produces the desired bound for their codegrees .",
    "the argument for codegrees in @xmath357 is similar . @xmath174",
    "the next few lemmas build up to a result which controls how @xmath86 is affected by the deletion of all edges in the @xmath369 .",
    "the first one controls the `` first - order '' effect of the deletion process .",
    "[ lem : d - delete - out - nbrs ] condition on the first step of procedure 2 covering every edge of @xmath86 @xmath379 times by the @xmath318 . fix any vertex @xmath401 and any set @xmath402 of edges incident to @xmath66 ( all oriented in the same way with respect to @xmath66 ) .",
    "suppose that @xmath403 . then with probability @xmath404 , the number of edges of @xmath402 which are covered by the @xmath369 is @xmath405 ,    * proof .",
    "* we start with the case when all edges in @xmath402 are directed out of @xmath66 .",
    "let the random variable @xmath406 be the number of these edges which are covered by the @xmath369 .",
    "since we conditioned on the first step of procedure 2 , the only remaining randomness is in the independent assignments of the edge labels .",
    "we expose these labels in three stages .",
    "first , expose the labels of @xmath402 .",
    "now each edge @xmath407 has its label @xmath408 , so we can identify its partner edge in @xmath409 which must also receive @xmath408 in order for both to remain in @xmath410 ; let @xmath411 be the set of all partner edges found in this way .",
    "next , expose all labels outside @xmath412 .",
    "finally , expose the labels of @xmath411 .",
    "it is clear that the second stage does not affect @xmath406 at all .",
    "thus , after conditioning on the result of the second stage , we are at the following situation : every edge @xmath413 has a label @xmath408 , and it will only still be covered by the @xmath369 if its partner in @xmath409 also receives the label @xmath408 . since its partner is in @xmath379 different @xmath318 , the probability that @xmath414 is covered by @xmath369 is the inverse of this multiplicity ; linearity of expectation then gives @xmath415 } = ( 1 \\pm 1.04\\epsilon ) \\frac{|e|}{\\kappa}$ ] .",
    "we will use the hoeffding - azuma inequality to show the concentration of @xmath406 .",
    "indeed , the third stage exposure is a product space of dimension @xmath416 .",
    "consider the effect of changing the label of a single edge @xmath417 . by the definition of @xmath411 ,",
    "the edge @xmath418 is either some @xmath419 directed into @xmath66 , or some @xmath78 not incident to @xmath66 with @xmath420 . in the latter case",
    ", @xmath77 is the only edge of @xmath402 which can be affected by the label of @xmath418 , so @xmath406 can change by at most 1 . for the remaining case",
    "@xmath421 , suppose that the label of @xmath418 was changed from @xmath422 to @xmath19 . by construction , only the ( single ) partner edge of @xmath418 in @xmath423 could suffer from changing @xmath418 s label away from @xmath422 ; this could decrease @xmath406 by at most 1 .",
    "similarly , only the partner edge of @xmath418 in @xmath424 could benefit from changing @xmath418 s label to @xmath19 , and this would only increase @xmath406 by at most 1 .",
    "we conclude that @xmath406 is 1-lipschitz , so the hoeffding - azuma inequality implies that the probability @xmath406 deviates from its expectation by over @xmath425 is at most @xmath426 therefore , with probability @xmath404 , we have @xmath427 , in the case when all edges of @xmath402 are directed out of @xmath66 .",
    "the case when all edges are directed into @xmath66 follows by essentially the same argument .",
    "@xmath174    the next lemma controls the `` second - order '' effect of the deletion process .",
    "[ lem : d - delete - co - out ] fix any distinct vertices @xmath350 and any set @xmath120 of vertices such that either    ( i ) : :    for all @xmath428 ,    @xmath429 are edges    of @xmath86 ; or ( ii ) : :    for all @xmath428 ,    @xmath430 are edges    of @xmath86 ; or ( iii ) : :    for all @xmath428 ,    @xmath431 are edges    of @xmath86",
    ".    condition on the first step of procedure 2 covering every edge of @xmath86 at least @xmath432 times by the @xmath318 , and on the fact that @xmath73 is the successor of @xmath66 in at most 5 of the permutations .",
    "suppose that @xmath433 .",
    "then with probability @xmath434 , the number @xmath406 of vertices in @xmath120 which still have both of their designated edges above still covered by the @xmath369 is at most @xmath435 .",
    "* proof in situations ( i ) and ( ii ) .",
    "* these two cases follow by very similar arguments ; for concreteness , let us begin with ( i ) .",
    "let @xmath402 be the set of @xmath436 edges specified in ( i ) .",
    "since we conditioned on the first step of procedure 2 , the only remaining randomness is in the independent assignments of the edge labels .",
    "we expose these labels in three stages .",
    "first , expose the labels of @xmath402 .",
    "now each edge @xmath407 has its label @xmath408 , so we can identify its partner edge in @xmath409 ; denote the partner by @xmath437 , and let @xmath411 be the set of all partner edges found in this way .",
    "next , expose all labels outside @xmath412 . finally , expose the labels of @xmath411 .",
    "it is clear that the second stage does not affect @xmath406 at all .",
    "thus , after conditioning on the result of the second stage , we are at the following situation : every edge @xmath407 has a label @xmath408 , and @xmath414 will only still be covered by the @xmath369 if its partner @xmath437 also receives the label @xmath408 .",
    "the random variable @xmath406 counts the number of vertices @xmath43 for which both @xmath77 and @xmath438 are still covered by the @xmath369 .",
    "note that their partner edges @xmath439 and @xmath440 are distinct unless they both coincide as some @xmath441 .",
    "if they are distinct , then clearly the probability of having both receive their correct labels is at most @xmath442 .",
    "on the other hand , if they coincide , then we must have that in both permutations @xmath443 and @xmath444 , the vertex @xmath288 is the successor of @xmath66 and @xmath73 .",
    "yet @xmath288 has a unique predecessor , so @xmath445 .",
    "therefore , it is actually impossible for the ( coincident ) partner edge to receive a label which suits both @xmath77 and @xmath438 , so the probability is 0 . in all cases",
    ", we have an upper bound of @xmath442 , so @xmath415 } \\leq \\frac{|x|}{\\kappa^2}$ ] .",
    "we use the hoeffding - azuma inequality to probabilistically bound @xmath406 , since the third exposure stage is a product space . consider the effect of changing the label of a single edge @xmath417 . by the definition of @xmath411 ,",
    "the edge @xmath418 is either some @xmath419 or @xmath78 , or some @xmath441 with @xmath77 and @xmath438 both in @xmath86 . in the latter case",
    ", @xmath43 is the only vertex which may have its count in @xmath406 affected , so @xmath406 changes by at most 1 under this perturbation . by symmetry , it remains to consider the case when @xmath421 changes its label from @xmath422 to @xmath19 . by construction ,",
    "only the partner edge @xmath446 of @xmath418 in @xmath423 could suffer from changing @xmath418 s label away from @xmath422 ; this could potentially lose only @xmath198 in the count of @xmath406 , so @xmath406 would decrease by at most 1 . similarly ,",
    "only the partner edge of @xmath418 in @xmath424 could benefit from changing @xmath418 s label to @xmath19 , and this could only increase @xmath406 by at most 1 .",
    "we conclude that @xmath406 is 1-lipschitz over its product space of dimension @xmath447 , so the azuma - hoeffding inequality implies that the probability that @xmath406 exceeds its expectation by more than @xmath448 is at most @xmath449 this finishes the case when ( i ) holds .",
    "the case when ( ii ) holds follows from a directly analogous argument .",
    "* proof in situation ( iii ) .",
    "* let @xmath402 be the set of @xmath436 edges specified in ( iii ) .",
    "we expose the labels in the same three stages as before : first @xmath402 , then the other non - partner edges , and finally the partner edges @xmath411 .",
    "again , after the second stage we would be at the following situation : every edge @xmath407 has a label @xmath408 , and a vertex @xmath43 will only be counted toward @xmath406 if the partner edge @xmath439 receives the label @xmath443 , and @xmath450 also receives @xmath451 .",
    "however , this time there is an additional complication , because it can happen that one or both of these partner edges have already had their labels exposed . the only way this could happen is if either @xmath452 or @xmath453 .",
    "fortunately , we are only seeking an upper bound on @xmath406 , so we only need to determine when this first round exposure already forces a vertex @xmath43 to contribute to @xmath406 .",
    "a moment s thought reveals that the only way this can happen is if the first round gave both @xmath77 and @xmath78 the same label @xmath454 , and furthermore , the permutation @xmath455 has @xmath73 as the successor of @xmath66 .",
    "now we use the assumption that at most 5 of the permutations @xmath455 satisfy this property .",
    "let @xmath456 be the set of the corresponding indices @xmath454 .    we can circumvent this issue , by observing that in the first exposure , the number of @xmath43 for which both @xmath77 and @xmath78 receive the same label @xmath457 is stochastically dominated by @xmath458}$ ] . since @xmath459",
    ", the chernoff bound then implies that with probability @xmath404 , the first round has at most @xmath460 `` bad '' @xmath43 which have the potential of being automatically included in the count for @xmath406 .",
    "the second round exposure is essentially irrelevant , so we may now condition on the result of the second round satisfying the property in the previous paragraph .",
    "as we only need to upper bound @xmath406 , it remains to consider only the `` good '' @xmath43 . from our previous discussion , if a good @xmath43 has , say , the label of @xmath439 already exposed to be @xmath454 then @xmath73 is not the successor of @xmath66 in permutation @xmath454 and so this @xmath43 can not contribute to @xmath406 .    also note that the only way for @xmath439 to equal @xmath450 is if both are @xmath461 . if @xmath462 then @xmath248 and if @xmath463 then @xmath464 and so we must have @xmath465 .",
    "hence it is not possible for @xmath461 to simultaneously match both labels , and @xmath43 can not contribute to @xmath406 .",
    "so , if we let let @xmath147 be the subset of good vertices @xmath428 for which @xmath466 , and neither label has yet been exposed , it remains to control the number @xmath112 of vertices in @xmath147 which contribute to @xmath406 .",
    "since each @xmath467 has @xmath468 and their labels are independent , we immediately have @xmath469 } \\leq |y| / \\kappa^2 $ ] .",
    "we show that @xmath112 is concentrated by using the hoeffding - azuma inequality on the third round exposure product space of dimension @xmath470 .",
    "consider the effect of changing the label of an edge @xmath471 from @xmath422 to @xmath19 .",
    "there are three types of edges in @xmath411 :    case 1 : @xmath472 . : :    these @xmath418 can only arise as partner edges of some    @xmath77 ( possibly several )",
    ". however ,    @xmath418 has a unique partner edge    @xmath77 in    @xmath423 , so changing its label    away from @xmath422 can only reduce @xmath112 at    @xmath43 . similarly , changing it to @xmath19 can only    grow @xmath112 at @xmath198 , where    @xmath446 is the unique partner edge of    @xmath418 in @xmath424 .",
    "therefore , @xmath112 can only change by at most 1 .",
    "case 2 : @xmath473 .",
    ": :    by the same argument as case 1 , this can only change @xmath112    by at most 1 .",
    "case 3 : @xmath474 .",
    ": :    these @xmath418 can only arise as partners of either    @xmath77 or    @xmath475 .",
    "clearly , changing    @xmath476 can only affect whether @xmath43 or    @xmath198 are counted in @xmath112 , so it has an effect of    at most 2 .",
    "thus @xmath112 is 2-lipschitz , and the hoeffding - azuma inequality shows that the probability it exceeds its expectation by @xmath477 is at most @xmath478    since we conditioned on there being at most @xmath460 bad vertices , we have @xmath479 . putting everything together ,",
    "we conclude that with probability @xmath480 , @xmath481 , completing the proof . @xmath174    the previous two lemmas now enable us to prove that the pseudo - random properties of the digraph are still maintained after deleting the @xmath369 .",
    "[ lem : digraph - delete ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath482 .",
    "let @xmath483 and @xmath484 .",
    "let @xmath86 be an @xmath57-uniform digraph on @xmath1 vertices ( @xmath1 even ) , and conduct procedure 2 .",
    "let @xmath485 be the subgraph of @xmath86 obtained by deleting all edges covered by any @xmath369 . then , with probability @xmath486",
    ", @xmath485 is an @xmath487-uniform digraph with @xmath488 and @xmath489 .",
    "* by applying lemmas [ lem : gamma - cover ] and [ lem : gamma - rare - consec ] , the outcome of step 1 of procedure 2 will satisfy the following two properties with probability @xmath490 .",
    "( the second follows since @xmath491 , and so @xmath348 . )    * every edge of @xmath86 covered @xmath379 times by the @xmath318 . * for any @xmath314 , the vertex @xmath73 is the successor of @xmath66 in at most 5 of the permutations for the @xmath349",
    ".    condition on this outcome .",
    "we will now show that in the remaining randomness of step 2 , the properties of @xmath487-uniformity are satisfied with probability @xmath319 .",
    "we establish them one at a time .",
    "* property ( i ) . *",
    "consider an arbitrary vertex @xmath66 . by @xmath82-uniformity ,",
    "it has @xmath272 out - edges in @xmath86 , and @xmath492 .",
    "so , we may apply lemma [ lem : d - delete - out - nbrs ] to the set of out - edges of @xmath66 .",
    "this shows that with probability @xmath404 , the new out - degree of @xmath66 in @xmath485 , in terms of its original out - degree @xmath493 in @xmath86 , is @xmath494 \\\\    & = &    ( 1 \\pm \\epsilon ) np \\cdot \\left (      1 \\pm \\frac{1.06\\epsilon}{\\kappa }    \\right )    \\left (      1 - \\frac{1}{\\kappa }    \\right ) \\\\    & = & ( 1 \\pm \\epsilon ' ) np'.\\end{aligned}\\ ] ] here , we used @xmath495 by @xmath271-uniformity .",
    "taking a union bound over all @xmath401 , we obtain the desired result on out - degrees with probability @xmath496 .",
    "a similar argument controls all in - degrees . @xmath174    * property ( ii ) . *",
    "consider an arbitrary pair of distinct vertices @xmath69 , and let @xmath120 be the set of their common out - neighbors .",
    "let @xmath497 be the number of vertices in @xmath428 such that @xmath77 is covered by the @xmath369 , let @xmath498 be the number of @xmath428 such that @xmath438 is covered by the @xmath369 , and let @xmath499 be the number of @xmath428 such that both @xmath77 and @xmath438 are covered by the @xmath369 .",
    "clearly , the number of common out - neighbors of @xmath66 and @xmath73 in @xmath485 is exactly @xmath500 , where @xmath71 was the number of their common out - neighbors in @xmath86 .",
    "note that @xmath501 by @xmath271-regularity , and @xmath502 .",
    "so , lemma [ lem : d - delete - out - nbrs ] implies that with probability @xmath404 , both @xmath497 and @xmath498 are @xmath503 . on the other hand",
    ", we also have @xmath504 , so lemma [ lem : d - delete - co - out ] bounds @xmath499 by @xmath505 with probability @xmath480 .",
    "therefore , @xmath499 is within @xmath506 additive error of @xmath507 because @xmath508 .    putting these bounds together",
    ", we have that the new number of common out - neighbors is @xmath509 \\\\    & = &    ( 1 \\pm \\epsilon ) np^2     \\cdot    \\left (      1 \\pm \\frac{2.12\\epsilon}{\\kappa }    \\right )    \\left (      1 - \\frac{1}{\\kappa }    \\right)^2 \\\\    & = &    ( 1 \\pm \\epsilon ' ) n(p')^2,\\end{aligned}\\ ] ] here , @xmath501 by @xmath271-uniformity . taking a union bound over all @xmath350",
    ", we obtain the desired result on the new @xmath71 with probability @xmath510 .",
    "similar arguments control the other two parts of property ( ii ) of @xmath487-uniformity .",
    "@xmath174    * property ( iii ) .",
    "* this is a slight extension of the previous argument .",
    "consider any four vertices @xmath74 , which are all distinct except for the possibility @xmath75 .",
    "let @xmath120 and @xmath511 be the sets of vertices @xmath43 such that @xmath77 , @xmath78 , @xmath79 , @xmath80 are all in @xmath86 or @xmath485 , respectively .",
    "let @xmath497 , @xmath498 , @xmath512 , and @xmath513 be the sets of vertices @xmath428 such that @xmath77 , @xmath78 , @xmath79 , or @xmath80 are still covered by the @xmath514 . define the pairwise intersections @xmath515 . by inclusion - exclusion",
    ", we have @xmath516 as in ( ii ) , since @xmath517 ( to apply lemma [ lem : d - delete - out - nbrs ] ) and @xmath518 ( for lemma [ lem : d - delete - co - out ] ) , we have that with probability @xmath480 , each @xmath519 , and each @xmath520 . thus @xmath521    =     ( 1 \\pm \\epsilon ) np^4 \\left (       1 - \\frac{4}{\\kappa } \\pm \\frac{4.21\\epsilon}{\\kappa }     \\right).\\ ] ] here , we used @xmath522 by @xmath271-uniformity .",
    "now observe that @xmath523 however , since @xmath508 , the error term is @xmath524 .",
    "therefore , we have @xmath525 taking a union bound over all choices of @xmath74 , we obtain the desired result on the new @xmath71 with probability @xmath490 .",
    "@xmath174    now we have established control over the pseudo - random properties of the digraph after deletion , as well as over the individual bipartite graphs @xmath362 at each stage .",
    "we finally combine all of our lemmas to prove the main result of this section , that pseudo - random digraphs can be efficiently packed with hamilton cycles .",
    "* proof of theorem [ thm : digraph ] .",
    "* we will iterate procedure 2 , packing all intermediate @xmath369 at each iteration and deleting them from the digraph , until very few edges remain .",
    "the total number of iterations will be @xmath526 , so since our previous lemmas hold with probability @xmath319 , a final union bound will show that we achieve the desired packing * whp*.    let @xmath527 , @xmath528 , and @xmath529 .",
    "define the sequences @xmath530 , @xmath531 via the following recursion : @xmath532 let @xmath533 be the smallest index such that @xmath534 .",
    "note that @xmath535 only increases , so @xmath536 also note that since @xmath537 we have in general that @xmath538 .",
    "therefore , @xmath539    we now iteratively construct @xmath540 , such that each @xmath541 is @xmath542-uniform . indeed , consider the ( random ) procedure 2 applied to @xmath541 with respect to @xmath543 .",
    "let @xmath544 .",
    "this produces bipartite graphs @xmath545 and directed graphs @xmath546 with all @xmath546 disjoint .",
    "let @xmath547 be the result of deleting all @xmath546 from @xmath541 . to apply lemmas [ lem : gamma - prime ] and [ lem : digraph - delete ]",
    ", we must check that @xmath548 .",
    "but this follows from our initial assumption that @xmath549 since @xmath550 and @xmath551 .",
    "therefore , as the individual failure probabilities of lemmas [ lem : gamma - prime ] and [ lem : digraph - delete ] are @xmath552 and @xmath553 , we may assume that the outcome of procedure 2 satisfies the following properties :    ( i ) : :    all degrees in each @xmath545 are    @xmath554 .",
    "( ii ) : :    all codegrees between pairs of vertices on the same side of the    bipartition of each @xmath545 are    @xmath555 .",
    "( iii ) : :    @xmath547 is    @xmath556-uniform .",
    "fix this outcome",
    ". we may apply proposition [ prop : graph ] to each @xmath545 because @xmath557 where we used @xmath558 , @xmath559 , and our initial assumption that @xmath560 .",
    "so , every @xmath545 can be packed with edge - disjoint perfect matchings , missing only a @xmath561-fraction of the edges . by lemma [ lem : hamilton - matching ]",
    ", these edge - disjoint perfect matchings in @xmath545 correspond to edge - disjoint hamilton cycles in @xmath546 , missing the same fraction of edges since there is a 2-to-1 correspondence between edges in @xmath546 and @xmath545 .",
    "we carry on the above procedure until we create @xmath562 .",
    "then , we will have packed hamilton cycles in @xmath563 , up to a fractional error of @xmath564 . since @xmath562 is @xmath565-uniform , it has at most @xmath566 edges . as @xmath86 was @xmath271-uniform , it had at least @xmath567 edges .",
    "thus @xmath562 itself has at most @xmath568-fraction of the total number of edges .",
    "therefore , the fraction of edges of @xmath86 that have not been covered is at most @xmath569 since @xmath570 by inequality .",
    "this completes the proof .",
    "* the above proof showed that we can pack the edges of @xmath86 with hamilton cycles , up to a fractional error of at most @xmath571 , where @xmath572 .",
    "in fact , one can prove the same result for any @xmath573 , and all of the calculations can be recovered by following our proof .",
    "indeed , we intentionally introduced a very high level of precision in lemma [ lem : gamma - cover ] .",
    "it is clear that the same argument can replace the @xmath574 with @xmath575 , etc .",
    "these smaller order errors are what accumulate into the decimal places in the final @xmath576 which appears in lemma [ lem : digraph - delete ] , and which later determines the value of @xmath288 .",
    "when @xmath576 is replaced by a constant arbitrarily close to 4 , the above argument produces a result with @xmath288 approaching @xmath577 .",
    "this section is organized so that its structure is parallel to the previous section . indeed , their themes are similar , as the objective of this section is to establish another reduction , this time from the hypergraph setting to the digraph setting .",
    "the fundamental building block is now the following procedure , which should be compared with procedure 1 .",
    "* procedure 3 .",
    "* this takes as input a 3-graph @xmath0 with an even number of vertices .    1 .",
    "generate a random permutation @xmath202 of the vertices of @xmath0 .",
    "split it into @xmath7 successive pairs @xmath578 , @xmath579 , ",
    ", @xmath580 .",
    "2 .   construct a directed graph @xmath86 with @xmath7 vertices , one corresponding to each of the pairs above .",
    "place a directed edge from @xmath88 to @xmath89 if and only if both hyperedges @xmath581 and @xmath582 are present in @xmath0 .",
    "consider @xmath414 and @xmath418 to be _ partners _ , and introduce the notation @xmath583 and @xmath584 .",
    "since a directed edge in @xmath86 corresponds to two hyperedges in @xmath0 , we account for this by defining @xmath585 to be the hypergraph containing all @xmath90 , @xmath586 , for each directed edge from @xmath88 to @xmath587 in @xmath86 .",
    "as already noted , hamilton cycles in @xmath86 correspond precisely to tight hamilton cycles in @xmath0 .",
    "indeed , the hyperedges corresponding to the directed edges of a hamilton cycle are precisely those which are needed for a tight hamilton cycle in the hypergraph .",
    "[ lem : hamilton - di - hyp ] let @xmath588 be edge - disjoint hamilton cycles in @xmath86",
    ". then their associated hamilton cycles @xmath589 in @xmath0 are also edge - disjoint .",
    "* proof . *",
    "it suffices to show that given a fixed pairing @xmath590 ,  ,",
    "@xmath580 from step 1 , any given hyperedge @xmath591 can be associated with at most one directed edge in step 3 .",
    "indeed , by construction , some pair of vertices in the hyperedge , say @xmath306 , must be a pair above .",
    "if the pair containing @xmath288 is @xmath592 , then the directed edge must be from @xmath306 to @xmath593 , hence unique .",
    "similarly , if the pair containing @xmath288 is @xmath594 , then the only possibility is that the directed edge is from @xmath594 to @xmath306 .",
    "@xmath174    as in the previous section , our next goal is to show that the result of procedure 3 ( a digraph ) is pseudo - random .",
    "the following lemma will be a useful component of the proof .",
    "[ lem : pairs - kept ] let @xmath595 be a given set of ordered pairs of distinct vertices @xmath306 , with @xmath596 .",
    "then with probability @xmath597 , the number @xmath406 of ordered pairs in @xmath595 which appear in the list of @xmath7 ordered pairs from step 1 of procedure 3 , satisfies @xmath598 .",
    "* proof . *",
    "the probability that any given @xmath599 appears as an ordered pair in step 1 is precisely @xmath600 .",
    "this is because @xmath43 must land in one of the @xmath7 positions of the permutation which correspond to first - vertices of ordered pairs , and then @xmath198 must land in the position immediately following @xmath43 . since @xmath601 , linearity of expectation gives @xmath415 }",
    "= \\big ( 1 \\pm \\frac{\\epsilon}{2 } \\big ) \\frac{|s|}{2n}$ ] .    for concentration , we apply fact [ fact : conc - perm ] .",
    "suppose the permutation @xmath178 is converted to @xmath285 via the single transposition of the positions of the vertices @xmath43 and @xmath198 .",
    "let @xmath602 and @xmath603 be the other vertices in their respective ordered pairs ( according to @xmath178 ) .",
    "then , the only changes in the set of ordered pairs produced by step 1 is that the ordered pairs @xmath604 and @xmath605 change to @xmath606 and @xmath607 .",
    "all other ordered pairs remain the same , so their inclusion or exclusion in @xmath406 remains invariant .",
    "therefore , the value of @xmath406 can only change by at most 2 .",
    "fact [ fact : conc - perm ] then implies that the probability that @xmath406 deviates from its mean by more than @xmath608 is at most @xmath609 completing the proof . @xmath174 .",
    "now we show that the result of procedure 3 is a pseudo - random digraph .",
    "[ lem : d ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath610 .",
    "let @xmath0 be an @xmath82-uniform 3-graph on @xmath1 vertices ( @xmath1 even ) , and randomly construct the @xmath85-vertex directed graph @xmath86 according to procedure 3 . then",
    ", with probability @xmath241 , @xmath86 is @xmath611-uniform .    * proof .",
    "* we verify the properties of @xmath86 one at a time , starting with out - degrees .",
    "fix any two distinct vertices @xmath612 , and let @xmath291 be the number of ordered pairs @xmath269 produced by step 1 such that @xmath613 .",
    "it suffices to show that with probability @xmath313 , @xmath614 .",
    "( note the factor of 2 because @xmath86 has @xmath7 vertices . ) for this , first let @xmath307 be the set of ordered pairs @xmath269 , not necessarily produced by step 1 , such that @xmath615 .",
    "this is a deterministic set , from the hypergraph @xmath0 , whose size we can estimate by applying @xmath271-uniformity to @xmath0 with various auxiliary graphs @xmath32 . indeed , by applying the property with @xmath353 ( in figure [ fig : gamma ] ) and @xmath306 , the number of choices for @xmath43 such that @xmath616 is @xmath272 .",
    "then , given such a choice for @xmath43 , applying uniformity with @xmath353 and @xmath617 shows that there are @xmath272 choices for @xmath198 such that @xmath618 is also an edge . putting these estimates together ,",
    "we conclude that @xmath619 .",
    "since @xmath620 , lemma [ lem : pairs - kept ] gives @xmath621 with the desired probability .",
    "[ cols=\"^,^,^,^,^ \" , ]     the arguments for the other properties are very similar . for in - degrees , we fix a pair of distinct vertices @xmath306 , and apply uniformity with @xmath353 to show there are @xmath272 choices for @xmath198 such that @xmath622 .",
    "applying again on @xmath623 , we find a further @xmath272 choices for @xmath43 such that @xmath624 .",
    "this is exactly the same estimate as we had in the out - degree case above , so the same argument completes it .    to control the common out - degrees of pairs of vertices in @xmath86 , we fix 4 distinct vertices of @xmath0 , arranged in two pairs @xmath306 and @xmath625 . applying uniformity with @xmath626 ( see figure [ fig : gamma ] ) , there are @xmath627 choices for @xmath43 such that @xmath628 .",
    "after fixing such a choice for @xmath43 , another application of uniformity with @xmath629 ( see figure [ fig : gamma ] ) shows that there are @xmath630 choices for @xmath198 such that @xmath631 .",
    "therefore , there are @xmath632 pairs @xmath269 which could serve as the terminal vertex of both directed edges from @xmath306 and @xmath625 , if only @xmath269 appeared as a pair in step 1 . since @xmath633 , we may apply lemma [ lem : pairs - kept ] , and finish as before .",
    "a similar argument controls @xmath72 in @xmath86 . to establish the last part of property ( ii ) of @xmath611-regularity for @xmath86 , fix any 4 distinct vertices in @xmath0 arranged in two pairs @xmath306 and @xmath634 .",
    "applying uniformity with @xmath353 ( see figure [ fig : gamma ] ) , there are @xmath272 choices for @xmath43 such that @xmath635 .",
    "fix such an @xmath43 .",
    "applying uniformity again with @xmath636 ( see figure [ fig : gamma ] ) , with @xmath637 corresponding to the labels in figure [ fig : gamma ] , we see that there are @xmath638 choices for @xmath198 such that all of @xmath639 .",
    "hence there are @xmath640 choices for a pair @xmath269 which would be both an in - neighbor of @xmath641 and an out - neighbor of @xmath642 , if only @xmath269 appeared as a pair in step 1 .",
    "thus lemma [ lem : pairs - kept ] finishes this case as before .    for property ( iii ) of @xmath611-regularity for @xmath86 ,",
    "fix any 8 distinct vertices in @xmath0 , arranged in 4 pairs @xmath306 , @xmath625 , @xmath643 , and @xmath644 . applying uniformity with @xmath626 shows that there are @xmath70 choices for @xmath43 such that both @xmath645 .",
    "then , after fixing such an @xmath43 , applying uniformity with @xmath646 ( see figure [ fig : gamma ] ) shows that there are @xmath647 choices for @xmath198 such that all @xmath648 .",
    "hence there are @xmath649 choices for a pair @xmath269 which would out - neighbors of both @xmath650 and in - neighbors of @xmath651 , if only @xmath269 appeared as a pair in step 1 .",
    "since @xmath652 , we may apply lemma [ lem : pairs - kept ] , and finish as before .",
    "@xmath174    next we prove the analogue of lemma [ lem : gamma - cover ] , establishing that repeated runs of procedure 3 will cover the edges of @xmath0 fairly uniformly .",
    "[ lem : d - cover ] suppose @xmath1 and @xmath124 satisfy @xmath315 .",
    "let @xmath0 be an @xmath82-uniform 3-graph on @xmath1 vertices ( @xmath1 even ) , and randomly and independently construct @xmath653 digraphs @xmath654 according to procedure 3 .",
    "let @xmath655 be their corresponding 3-graphs . then , with probability @xmath319 , every edge of @xmath0 is covered @xmath656 times by the @xmath655",
    ".    * proof .",
    "* fix an edge @xmath591 of @xmath0 , and let @xmath322 be the probability that it is covered by @xmath657 .",
    "there are several ways in which this can happen .",
    "first , it could be that @xmath306 is a pair from the permutation @xmath658 for @xmath657 , and @xmath592 is another pair , with @xmath659 also an edge of @xmath0 .",
    "let us bound the probability @xmath334 of this particular event happening .",
    "let @xmath41 be the number of choices for @xmath43 such that @xmath660 . in terms of @xmath41",
    ", we have @xmath661 . to see this ,",
    "first expose the position of @xmath66 ; it is in the first half of an ordered pair with probability @xmath337 .",
    "next , @xmath73 must be occupy the second position in that ordered pair , and then @xmath288 must select a first half spot in one of the remaining ordered pairs .",
    "finally , there are @xmath41 valid choices for @xmath288 s partner .",
    "but by @xmath82-uniformity applied with @xmath353 ( figure [ fig : gamma ] ) , @xmath662 .",
    "so ( using @xmath341 ) , @xmath663 .",
    "the above argument can be run with any permutation of @xmath664 .",
    "also , it could be that @xmath288 occupied the second position in its ordered pair , e.g. , if @xmath665 and @xmath666 were the pairs involved .",
    "therefore , @xmath667 . since the @xmath11 random constructions are independent , the number of times @xmath591 is covered is @xmath323}$ ] , which has expectation @xmath668 .",
    "the chernoff bound implies that the probability that the binomial deviates from its mean by more than a factor of @xmath345 is at most @xmath669 taking a union bound over all @xmath670 edges @xmath591 , we obtain the desired result .",
    "@xmath174    next , we prove a result which will serve the same purpose as lemma [ lem : gamma - rare - consec ] of the previous section .",
    "procedure 3 constructs a digraph @xmath86 on half as many vertices by pairing up the vertices of @xmath0 .",
    "let us say that a set @xmath595 of 4 vertices of @xmath0 is _ condensed _ in @xmath86 if two of those pairs above contain all 4 vertices in @xmath595 .",
    "for example , if @xmath671 , and two vertices of @xmath86 are the ordered pairs @xmath672 and @xmath673 , then @xmath595 is condensed in @xmath86 .",
    "[ lem : d - rare - close ] suppose @xmath674 .",
    "construct @xmath11 independent @xmath675 according to procedure 3 .",
    "then with probability @xmath319 , every set @xmath595 of 4 vertices in @xmath0 is condensed in at most 9 of the @xmath675",
    ".    * proof .",
    "* for a fixed set of 4 vertices @xmath676 , the probability that it is condensed in @xmath677 is precisely @xmath678 . to see this , first expose the position of @xmath66 in the permutation @xmath658 which defines @xmath677",
    "this identifies the position which contains the other vertex in @xmath66 s pair ; expose the vertex in that spot .",
    "the probability that it is @xmath73 , @xmath288 , or @xmath289 is precisely @xmath679 .",
    "assuming this is the case , there are still two vertices of interest left , say @xmath288 and @xmath289 .",
    "then expose the position of @xmath288 .",
    "this identifies the position which contains the other vertex in @xmath288 s pair ; expose the vertex in that spot .",
    "the probability that it is @xmath289 is precisely @xmath680 .    since the @xmath675 are independent , the number of them which have the above property with respect to @xmath681 is stochastically dominated by @xmath682}$ ] .",
    "since we assumed @xmath683 , the probability that this exceeds 9 is at most @xmath684 so a union bound over all @xmath685 choices for @xmath681 completes the proof .",
    "we now formulate the analogue of procedure 2 for the hypergraph setting .",
    "* procedure 4 .",
    "* this takes as input a 3-graph @xmath0 with an even number of vertices , and an integer parameter @xmath11 .    1 .",
    "independently generate the random digraphs @xmath654 according to procedure 3 , and let @xmath655 be their corresponding 3-graphs .",
    "2 .   for each edge",
    "@xmath686 let @xmath687 . if @xmath688 , independently select a uniformly random index in @xmath689 to label @xmath414 with .",
    "3 .   for each @xmath675 , define the subgraph @xmath690 by keeping each edge @xmath321 if and only if both of its corresponding 3-graph edges are labeled by @xmath251 .",
    "4 .   for each @xmath251 , let @xmath691 be the 3-graph containing all hyperedges which correspond to the directed edges left in @xmath690 .",
    "note that @xmath692 .",
    "as in procedure 2 , the final step ensures that the @xmath691 are all disjoint , so lemma [ lem : hamilton - di - hyp ] shows that we can work on each @xmath690 independently , packing hamilton cycles with theorem [ thm : digraph ] .",
    "then , we will remove all @xmath691 from @xmath0 , and repeat .",
    "the next result establishes the necessary pseudo - random properties of the @xmath690 .",
    "[ lem : d - prime ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath693 .",
    "let @xmath0 be an @xmath82-uniform 3-graph on @xmath1 vertices ( @xmath1 even ) , and conduct procedure 4 with @xmath694 .",
    "let @xmath695 .",
    "then , with probability @xmath319 , every @xmath690 is @xmath696-uniform",
    ".    * proof . * our restrictions on @xmath64 allow us to apply lemma [ lem : d ] ( @xmath697 ) and lemma [ lem : d - cover ] @xmath698 , so we have that with probability @xmath319 , after step 1 of procedure 4 :    ( a ) : :    every @xmath675 is @xmath611-uniform .",
    "( b ) : :    every edge in @xmath0 is covered    @xmath379 times by the    @xmath655 .",
    "condition on the above outcome of step 1 , and consider an arbitrary @xmath690 .",
    "it suffices to show that in the randomness of step 2 , with probability @xmath313 each individual @xmath690 has the desired properties , since @xmath699 by the given restrictions on @xmath700 .",
    "we start by verifying out - degrees .",
    "a vertex @xmath701 corresponds to a pair of vertices @xmath306 from @xmath0 . for each edge of @xmath675 which is directed away from @xmath155",
    ", there is a distinct pair of vertices @xmath269 from @xmath0 . that directed edge remains in @xmath690 if and only if both of its associated hyperedges @xmath702 receive label @xmath251 .",
    "this happens with probability @xmath703^{-2}$ ] by property ( b ) above .",
    "yet property ( a ) ensures that the number @xmath41 of such directed edges in @xmath675 is @xmath704 , so the expected out - degree of @xmath155 in @xmath690 is @xmath705 .    for concentration , note that all of the @xmath706 hyperedges associated with the @xmath41 directed edges are distinct , so their labels are generated independently .",
    "therefore , by the chernoff inequality , the probability that the out - degree of @xmath155 in @xmath690 deviates from its expectation by more than a factor of @xmath389 is at most @xmath707 because @xmath708 .",
    "therefore , with probability @xmath496 , the degree of @xmath155 in @xmath690 is @xmath709 . taking a union bound over all @xmath710 establishes uniformity for out - degrees .",
    "all other properties of @xmath711-uniformity follow by a similar argument .",
    "importantly , in each case , all directed edges correspond to disjoint pairs of hyperedges , so we can always use the chernoff inequality to establish concentration .",
    "the smallest mean we ever deal with is @xmath712 , from property ( iii ) of uniformity for @xmath690 , so the largest error in concentration is at most @xmath713 where we use @xmath714 .",
    "@xmath174    we now move to show how the hypergraph @xmath0 is affected by the deletion of all hypergraphs @xmath691 . as before , we use inclusion / exclusion to sandwich the quantities in question , using an accurate `` first - order '' estimate , together with a rough `` second - order '' upper bound .    [",
    "lem : h - delete-1 ] condition on the first step of procedure 4 covering every edge of @xmath0 @xmath379 times by the @xmath655 .",
    "fix any two distinct vertices @xmath715 , and a set @xmath595 of vertices such that @xmath635 for all @xmath716 .",
    "suppose that @xmath717 .",
    "then with probability @xmath718 , the number @xmath406 of vertices @xmath716 such that @xmath719 is covered by the @xmath691 is @xmath720 ,    * proof .",
    "* let @xmath721 .",
    "since we are conditioning on the result of step 1 , the only randomness left is in the independent exposure of all hyperedge labels , most of which are irrelevant for @xmath406 .",
    "we define @xmath411 , the set of relevant edges , as follows . for each @xmath722 which covers some @xmath723 ,",
    "there is a partner edge @xmath724 such that @xmath414 remains in @xmath725 if and only if @xmath414 and @xmath418 receive the label @xmath422 .",
    "let @xmath411 be the collection of all partner edges obtained in this way , together with all @xmath726 .",
    "since we assume every @xmath727 is covered at most @xmath728 times by the @xmath722 , we always have @xmath729 .",
    "observe that all labels outside @xmath411 have no effect on @xmath406 at all , so we may condition on an arbitrary setting of those labels , leaving only @xmath730 independent labels to be exposed .",
    "next , we show that the probability that a particular edge @xmath731 is covered by the @xmath725 is @xmath732^{-1}$ ] . to see this , note that after revealing the label @xmath422 of @xmath414 , there is a single partner edge @xmath724 , whose label must match that of @xmath414 . since @xmath418 is covered @xmath379 times by the @xmath655 , it has probability @xmath732^{-1}$ ] of receiving that label @xmath422 .",
    "therefore by linearity of expectation , @xmath415 } = ( 1 \\pm 1.04\\epsilon ) \\frac{|s|}{\\kappa}$ ] .",
    "we use the hoeffding - azuma inequality to establish the concentration of @xmath406 , as the remaining randomness is a product space of dimension @xmath733 . consider the effect of changing the label of a hyperedge @xmath734 from @xmath251 to @xmath422 .",
    "note that its old partner edge @xmath735 overlapped with @xmath414 in two vertices , but also included a new vertex , say @xmath736 . changing the label of @xmath414 away from @xmath251",
    "could potentially remove any or all of @xmath737 from the count for @xmath406 ( if @xmath735 had received label @xmath251 ) , so this could potentially reduce @xmath406 by up to 4 . similarly , setting the label of @xmath414 to @xmath422 can potentially increase @xmath406 by up to 4 .",
    "therefore , @xmath406 is 4-lipschitz , so the hoeffding - azuma inequality implies that the probability that @xmath406 deviates from its expectation by more than @xmath738 is at most @xmath739 where we used @xmath740 .",
    "therefore , with probability @xmath718 , we have @xmath741 , as desired .",
    "@xmath174    having proved an accurate `` first - order '' estimate , we move to the `` second - order '' upper bound ( analogous to lemma [ lem : d - delete - co - out ] ) . in the 3-graph setting",
    ", this breaks into two cases , which we treat in the following two lemmas .",
    "[ lem : h - delete-2-disjoint ] condition on the first step of procedure 4 covering every edge of @xmath0 @xmath742 times by the @xmath655 .",
    "fix any distinct vertices @xmath743 and any set of vertices @xmath595 such that both @xmath628 for all @xmath716 .",
    "suppose that @xmath744 .",
    "then with probability @xmath745 , the number @xmath406 of vertices @xmath716 which still have both @xmath719 and @xmath746 covered by the @xmath691 is at most @xmath747",
    ".    * proof . *",
    "again , the only remaining randomness is in the labeling of the hyperedges in step 2 . also , since each edge is covered by at most @xmath748 of the @xmath722 , less than @xmath749 of them are relevant for @xmath406 , for the same reason as in the previous proof .",
    "so , we may condition on all labels for irrelevant edges , and focus on the remaining product space over the relevant edges @xmath411 .",
    "let us bound the probability that a particular @xmath716 remains in the count for @xmath406 .",
    "first , expose the labels for @xmath750 and @xmath751 , and suppose they are @xmath19 and @xmath454 .",
    "let their partner edges be @xmath752 and @xmath753 .",
    "importantly , @xmath754 can not equal @xmath418 , because @xmath754 must overlap with @xmath414 in two vertices .",
    "hence the label of @xmath754 has not yet been exposed .",
    "similarly , the label of @xmath755 has not yet been exposed .",
    "however , note that it may happen that @xmath756 .    in order for @xmath43 to remain in the count for @xmath406",
    ", @xmath754 must receive label @xmath19 and @xmath755 must receive label @xmath454 . first we show that if @xmath757 , then the probability of this occurring is 0 .",
    "indeed , if @xmath758 , it clearly can not happen .",
    "but otherwise , if @xmath759 , it is impossible for @xmath756 in the first place , because in @xmath760 , each edge has a distinct partner edge , so @xmath754 and @xmath755 should be distinct .    on the other hand , if @xmath761 , the probability that these independent labels equal @xmath19 and @xmath454 is at most @xmath762^{-2}$ ] , because each edge is covered by at least @xmath763 of the @xmath722 .",
    "therefore , we conclude that in all cases , the probability of a certain @xmath764 remaining in the count for @xmath406 is at most @xmath765 , so @xmath415 } \\leq \\frac{2}{\\kappa^2 } |s|$ ] .",
    "finally , the same argument that we used in the proof of lemma [ lem : h - delete-1 ] shows that @xmath406 is 4-lipschitz over the product space of dimension @xmath766 .",
    "hence the probability that @xmath406 exceeds its expectation by more than @xmath767 is at most @xmath768 since we assumed @xmath744 .",
    "therefore , with probability @xmath718 , we have @xmath769 , as desired",
    ". @xmath174",
    "[ lem : h - delete-2-incident ] condition on the first step of procedure 4 covering every edge of @xmath0 @xmath742 times by the @xmath655 , and on the property that every set of 4 vertices of @xmath0 is condensed in at most 9 of the @xmath675 . fix any distinct vertices @xmath770 and any set of vertices @xmath595 such that both @xmath771 for all @xmath716 .",
    "suppose that @xmath744 .",
    "then with probability @xmath718 , the number @xmath406 of vertices @xmath772 which still have both @xmath719 and @xmath659 covered by the @xmath691 is at most @xmath773",
    ".    * proof . *",
    "again , the only remaining randomness is in the labeling of the hyperedges in step 2 , so we may concentrate on the product space of dimension @xmath774 , where @xmath411 is the set of all edges @xmath775 and their possible partners .    to bound the probability that a particular @xmath716 remains in the count for @xmath406 , expose the labels for @xmath750 and @xmath776 , and suppose they are @xmath19 and @xmath454 .",
    "let their partner edges be @xmath752 and @xmath753 .",
    "this time , it is possible for @xmath777 or @xmath778 , but that can only happen if the 4 vertices @xmath779 are condensed in @xmath780 .",
    "furthermore , if @xmath781 , then @xmath43 is automatically excluded from the count for @xmath406 , which is not a problem because we only seek an upper bound",
    ".    therefore , the probability that @xmath43 contributes to @xmath406 is at most @xmath782 , where @xmath334 is the probability that @xmath414 and @xmath418 both receive the same label @xmath19 , with @xmath783 condensed in @xmath780 , and @xmath335 is the conditional probability that @xmath754 and @xmath755 receive labels @xmath19 and @xmath454 , given the exposure of the labels of @xmath414 and @xmath418 , and @xmath784 , @xmath785 .",
    "we assumed that @xmath783 were only condensed in at most 9 of the @xmath786 , so @xmath787 .",
    "as for @xmath335 , the same argument that we used in the previous lemma shows that if @xmath756 , then we must have had @xmath781 , so it is impossible for @xmath754 to receive @xmath19 and @xmath755 to receive @xmath454 , hence @xmath43 can not contribute to @xmath406 .",
    "the only remaining case is @xmath761 , and the probability that both receive the correct label is at most @xmath788^{-2}$ ] . putting everything together ,",
    "we conclude that the probability that @xmath43 contributes to @xmath406 is at most @xmath789 , so @xmath415 } \\leq \\frac{12}{\\kappa^2 } |s|$ ] .",
    "finally , the same argument that we used in the previous proof again establishes the lipschitz constant of 4 for @xmath406 in the product space of dimension @xmath766 .",
    "hence the probability that @xmath406 exceeds its expectation by more than @xmath767 is at most @xmath768 since we assumed @xmath744 .",
    "therefore , with probability @xmath718 , we have @xmath790 , as desired .",
    "@xmath174    now we combine our first - order and second - order bounds , and show that the pseudo - random properties of @xmath0 are maintained after deleting all @xmath691 .",
    "[ lem : h - delete ] suppose @xmath1 , @xmath6 , and @xmath124 satisfy @xmath791 .",
    "let @xmath792 and @xmath695 .",
    "let @xmath0 be an @xmath82-uniform 3-graph on @xmath1 vertices ( @xmath1 even ) , and conduct procedure 4 .",
    "let @xmath793 be the subgraph of @xmath0 obtained by deleting all edges covered by any @xmath691 . then , with probability @xmath794",
    ", @xmath793 is an @xmath487-uniform 3-graph with @xmath795 and @xmath489 .",
    "* by applying lemmas [ lem : d - cover ] and [ lem : d - rare - close ] , the outcome of step 1 of procedure 4 will satisfy the following two properties with probability @xmath319 .",
    "( the second follows since @xmath796 , and so @xmath683 . )    * every edge of @xmath0 is covered @xmath379 times by the @xmath655 . * every set of 4 vertices of @xmath0 is condensed in at most 9 of the @xmath675 .",
    "condition on this outcome .",
    "we will now show that in the remaining randomness of step 2 , the properties of @xmath487-uniformity are satisfied with probability @xmath319 . for this ,",
    "fix a set of @xmath49 vertices @xmath797 , and let @xmath32 be an arbitrary @xmath41-vertex graph with @xmath50 edges .",
    "it suffices to show that in @xmath793 , the random variable @xmath798 is @xmath799 with probability @xmath718 , because we can then take a union bound over all @xmath800 choices for the @xmath205 , and all @xmath801 possibilities for @xmath32 .",
    "let @xmath595 be the set of all @xmath43 such that @xmath36 for every edge @xmath37 .",
    "our assumed @xmath82-uniformity gives @xmath802 .",
    "we will use a similar inclusion / exclusion argument as in the proof of lemma [ lem : digraph - delete ] to estimate @xmath120 in terms of @xmath803 .",
    "let @xmath804 be the edges of @xmath32 .",
    "for each @xmath805 , define the random variable @xmath806 as follows .",
    "let @xmath293 be the endpoints of edge @xmath807 .",
    "then let @xmath806 be the number of vertices @xmath808 such that @xmath809 is covered by some @xmath810 .",
    "also , for every two distinct @xmath811 , let the random variable @xmath812 count the number of vertices @xmath716 such that both @xmath813 and @xmath814 are covered by some @xmath810 , where @xmath815 and @xmath816 are the respective endpoints of @xmath817 and @xmath818 . in terms of these random variables ,",
    "the principle of inclusion / exclusion always gives @xmath819 since we noted above that @xmath820 , we have @xmath821 , so lemma [ lem : h - delete-1 ] controls all @xmath822 with probability @xmath718 .",
    "also , since @xmath823 , lemmas [ lem : h - delete-2-disjoint ] and [ lem : h - delete-2-incident ] show that every @xmath824 with probability @xmath718 .    putting everything together , and using @xmath50 and @xmath825 , we have @xmath826 now observe that @xmath827 again using @xmath825 , we bound the error term by @xmath524 . therefore , we have @xmath828    =    ( 1 \\pm \\epsilon ' ) n ( p')^s,\\ ] ] as desired",
    ". @xmath174",
    "we finally finish the proof of theorem [ thm:3graph ] .",
    "the method is essentially the same as that used to prove theorem [ thm : digraph ] in the previous section .",
    "* proof of theorem [ thm:3graph ] .",
    "* let @xmath829 , @xmath528 , and @xmath529 .",
    "define the sequences @xmath530 , @xmath531 via the following recursion : @xmath830 let @xmath533 be the smallest index such that @xmath831 .",
    "note that @xmath535 only increases , so @xmath832 also note that since @xmath833 we have in general that @xmath834 .",
    "therefore , @xmath835    we now iteratively construct @xmath836 , such that each @xmath837 is @xmath542-uniform . indeed , consider the ( random ) procedure 4 applied to @xmath837 with respect to @xmath838 .",
    "let @xmath839 .",
    "this produces digraphs @xmath840 and 3-graphs @xmath841 with all @xmath841 disjoint .",
    "let @xmath842 be the result of deleting all @xmath841 from @xmath837 . to apply lemmas [ lem : d - prime ] and [ lem :",
    "h - delete ] , we must check that @xmath843 .",
    "but this follows from our initial assumption that @xmath844 since @xmath550 and @xmath845 .",
    "therefore , the two lemmas show that with probability @xmath490 , procedure 4 results in the following properties :    ( i ) : :    every @xmath840 is @xmath846-uniform .",
    "( ii ) : :    @xmath842 is    @xmath556-uniform .",
    "we may assume this outcome , since we will only iterate @xmath553 times . in order to apply theorem [ thm : digraph ] to each @xmath840",
    ", we must verify that @xmath847 .",
    "indeed , this is the case : @xmath848 by our initial assumption that @xmath849 .",
    "so , every @xmath840 can be packed with hamilton cycles , missing only an @xmath850-fraction of the edges . by lemma [ lem : hamilton - di - hyp ]",
    ", these edge - disjoint hamilton cycles in @xmath840 correspond to edge - disjoint hamilton cycles in @xmath841 , missing the same fraction of edges since there is a 2-to-1 correspondence between edges in @xmath841 and @xmath840 .",
    "we carry on the above procedure until we create @xmath851 .",
    "then , we will have packed hamilton cycles in @xmath852 , up to error of @xmath853-fraction .",
    "it remains to estimate the numbers of edges in @xmath851 and @xmath0 .",
    "note that in general , by applying @xmath82-uniformity to every pair of vertices ( using @xmath353 in figure [ fig : gamma ] ) , we can estimate the number of edges in any @xmath82-uniform 3-graph to be @xmath854 , because this counts every hyperedge @xmath855 times .",
    "thus @xmath0 has at least @xmath856 edges , and @xmath851 has at most @xmath857 edges .",
    "thus @xmath851 itself has at most @xmath858-fraction of the total number of edges .",
    "therefore , the fraction of edges of @xmath0 that have not been covered is at most @xmath859 since @xmath860 by inequality .",
    "this completes the proof . @xmath174",
    "* the above proof showed that we can pack the edges of @xmath0 with hamilton cycles , up to a fractional error of at most @xmath571 , where @xmath861 .",
    "in fact , one can prove the same result for any @xmath862 , and all of the calculations can be recovered by following our proof .",
    "just as in section [ sec : digraph ] , we intentionally introduced a very high level of precision in lemma [ lem : d - cover ] .",
    "it is clear that the same argument can replace the @xmath574 with @xmath575 , etc .",
    "these smaller order errors are what accumulate into the decimal places in the final @xmath863 which appears in lemma [ lem : h - delete ] , and which later determines the value of @xmath288 .",
    "when @xmath863 is replaced by a constant arbitrarily close to 6 , the above argument produces a result with @xmath288 approaching @xmath864 .",
    "our proof of theorem [ thm:3graph ] is only valid when @xmath1 is divisible by four , because we required a factor of 2 in each reduction step ( from hypergraphs to digraphs , and then to bipartite graphs ) .",
    "although we do not expect this condition to be necessary , removing this restriction is open .",
    "we also leave open the question of packing hamilton cycles of type @xmath20 in @xmath19-uniform hypergraphs when @xmath865 and @xmath866 .",
    "finally , another interesting direction is to streamline the sets of pseudo - random properties which appear in the statements of our packing results ( both for digraphs and for 3-graphs ) ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a 3-uniform hypergraph with @xmath1 vertices . a tight hamilton cycle @xmath2 is a collection of @xmath1 edges for which there is an ordering of the vertices @xmath3 such that every triple of consecutive vertices @xmath4 is an edge of @xmath5 ( indices are considered modulo @xmath1 ) . </S>",
    "<S> we develop new techniques which enable us to prove that under certain natural pseudo - random conditions , almost all edges of @xmath0 can be covered by edge - disjoint tight hamilton cycles , for @xmath1 divisible by 4 . </S>",
    "<S> consequently , we derive the corollary that random 3-uniform hypergraphs can be almost completely packed with tight hamilton cycles * whp * , for @xmath1 divisible by 4 and @xmath6 not too small . along the way , we develop a similar result for packing hamilton cycles in pseudo - random digraphs with even numbers of vertices . </S>"
  ]
}