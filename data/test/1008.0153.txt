{
  "article_text": [
    "phylogenetics is a study of how species are related to each other .",
    "evolutionary relationships are most conveniently represented by rooted leaf - labelled trees , where the leaves represent extant species and the root represents their most recent common ancestral species .",
    "similarly other internal vertices of evolutionary trees correspond to extinct ancestral species .",
    "the arrival of dna and protein sequence data in the last forty years led to explosive growth of phylogenetics .",
    "many of the modern phylogenetic methods consider sequence data under probabilistic models of sequence evolution .",
    "for such models to be useful for phylogenetic inference , it is important to establish their _ identifiability _",
    "( i.e. , to show that nonisomorphic trees or different model parameters can not induce the same distribution on the sequences at the leaves under a given model of sequence evolution )",
    ". mathematical theory of phylogenetic trees , especially probabilistic models of sequence evolution , the associated questions of identifiability and statistical consistency ( especially of the maximum likelihood methods ) have been extensively studied @xcite , giving a firm statistical foundation to the study of phylogenetic trees .",
    "while phylogenetic trees represent relationships between species , population pedigrees represent how individuals within a population are related to each other .",
    "communities all over the world have long been curious about knowing their ancestral histories , and have often kept detailed records of their family trees . in fact",
    "this curiosity goes back much further in the past than the interest in constructing evolutionary relationships between species .",
    "an example of a fairly detailed record of family histories is the icelandic database slendingab ( the book of icelanders http://www.islendingabok.is ) of genealogical records that covers almost the whole icelandic population and goes back to nearly 1200 years .",
    "such ancestral histories are often compiled from a variety of sources such as church records , birth and death records , obituaries etc . that are prone to ambiguities or missing data beyond a few generations in the past .",
    "in the last several years large amounts of data on intra - population genetic variation have been recorded .",
    "for example , the icelandic biomedical company decode genetics has compiled genomic , genealogical and health data of more than 100000 individuals ( which is a significant proportion of the current icelandic population ) .",
    "such data offer promising opportunity to cross check and resolve ambiguities in historic genealogical records besides being useful for other studies such as , for example , genetic factors associated with medical conditions . therefore , there is a renewed interest in accurately inferring pedigrees from genomic data .",
    "the statistical and combinatorial foundation for studying reconstruction problems for pedigrees has not been as developed as in phylogenetics .",
    "a purpose of this paper is to continue our earlier attempts to develop such a foundation for the problem of reconstructing pedigrees from observations ( sequences ) on extant individuals .",
    "to develop such a foundation , we need to establish results along the following lines : developing a biologically realistic model for sequences undergoing mutations and recombinations , and identifiability results for such a model ; statistical consistency results ; and finally results that give estimates for the amount of genomic data necessary to reliably construct pedigrees . this paper is mainly about identifiability questions .    in the rest of this section",
    ", we discuss the above theoretical motivation in more detail .",
    "we begin by informally sketching some well known reconstruction and identifiability results for phylogenetic trees that not only motivate the work in this paper but also are crucially useful in the proof of the main identifiability result of this paper .",
    "_ results of zarecki and buneman .",
    "_ it was shown in @xcite that a leaf - labelled tree can be uniquely constructed from the pairwise distances between its leaves .",
    "the result was strengthened slightly as follows @xcite .",
    "suppose that @xmath0 is an _ additive function _ on the family of subsets of cardinality 2 of the vertex set of a leaf - labelled tree . here",
    "_ additive _ means that for any two vertices @xmath1 and @xmath2 , we have @xmath3 , where the summation is over all edges @xmath4 on the ( unique ) path from @xmath1 to @xmath2 .",
    "buneman showed that knowing @xmath0 on all pairs of leaves of a leaf - labelled tree without vertices of degree 2 is sufficient to uniquely construct the tree and the function .",
    "it is not surprising that these results are quite useful in phylogenetics , where observations on extant species ( leaves of an evolutionary tree ) are used to infer a suitably defined distance ( or an additive function ) between pairs of species , and then their phylogenetic tree is constructed uniquely .    _ results of steel and chang .",
    "_ now suppose the evolutionary process on a ( rooted ) tree is modelled as follows : first the root is assigned a random state from a finite alphabet @xmath5 ( e.g. , @xmath5 may be \\{a , t , g , c } in the case of dna sequences ) . each state is assumed to have a nonzero probability of being assigned to the root . each edge of the tree has associated with it a @xmath6 matrix of substitution probabilities .",
    "these substitution probabilities determine how the vertex - states evolve away from the root , and induce a distribution of states at the leaves of the tree .",
    "the model was formulated in @xcite as described above , while a slightly more general formulation in terms of markov random fields on unrooted trees was given in @xcite .",
    "it was independently shown by chang and steel that when the matrices defining the substitution probabilities satisfy certain mild conditions , the ( unrooted ) tree can be uniquely recovered from the joint distribution of states at the leaves of the tree .",
    "in particular they showed that the negative logarithm of the determinant of the matrix of substitution probabilities between pairs of vertices is an additive function on the pairs of vertices , and can be computed from the probability distribution on extant sequences .",
    "it was further proved in @xcite that the substitution matrices are also identifiable from the marginal distributions on triples of leaves of the tree .",
    "special cases of these results for models more commonly used in phylogenetics were known in the phylogenetics literature earlier .",
    "how far can we generalise such results if the underlying structure is more general than a tree ?",
    "a recent result in this direction is due to @xcite where it is shown that under some mild non - degeneracy conditions the dependency structure of a markov random field can be obtained from sufficiently many independent samples .    in this paper",
    "we present simple models for recombinations and mutations for population pedigrees , and generalise phylogenetic identifiability results for them .",
    "one difference between reconstructing markov random fields and reconstructing pedigrees is that for pedigrees we have observations only on the extant individuals ( e.g. , dna sequences derived from living individuals ) .",
    "moreover , in the problem of reconstructing pedigrees , the samples of data ( e.g. , columns in a sequence alignment ) are not _ i.i.d .",
    "_ ( independent and identically distributed ) as a result of recombinations .",
    "in @xcite , we studied some purely combinatorial reconstruction problems motivated by zarecki s result , for example , the problem of reconstructing a pedigree from the pairwise distances between its extant individuals or from its subpedigrees ( pedigrees of subsets of the extant population ) . in @xcite , we showed that a pedigree can not in general be reconstructed from the collection of its proper subpedigrees .",
    "such a result implies that knowing pairwise distances between extant vertices is in general not enough to reconstruct pedigrees .    in @xcite , we considered models for sequences evolving on pedigrees , and showed that for certain simple markov models , pedigrees are not identifiable from the distribution of observed states at extant vertices .",
    "we did construct examples of processes for which pedigrees could be proved to be identifiable , but the processes lacked the markovian property , which informally states that the state observed at a vertex depends only on the states of its parents .",
    "moreover , it seems that pedigrees that are difficult to reconstruct in a purely combinatorial framework ( e.g. , from pairwise distances between extant vertices or from subpedigrees ) are also likely to be difficult to reconstruct in a stochastic framework . for example",
    ", if a pedigree can not be reconstructed from its proper subpedigrees , then the marginal distributions of extant sequences on proper subsets of the extant population might be insufficient to uniquely recover the pedigree .",
    "on the other hand , negative results in a combinatorial setting may not imply non - identifiability in a stochastic framework .",
    "it is therefore important to study combinatorial reconstruction problems ( e.g. , classification of pedigrees that may be difficult to reconstruct combinatorially ) , stochastic identifiability problems for idealised markov models of recombination and mutation , and relationships between these problems .",
    "reconstruction problems of purely combinatorial nature are well known to combinatorialists , the foremost among such problems being the vertex reconstruction conjecture @xcite .",
    "the conjecture states that all simple undirected unlabelled graphs can be constructed from their collection of unlabelled induced subgraphs .",
    "combinatorial reconstruction problems have also been studied in phylogenetics , for example , problems of reconstructing phylogenetic trees from subtrees @xcite .",
    "steel and chang proved their phylogenetic identifiability results in two parts : computation of the additive ` log determinant ' function on pairs of leaves from the joint probability distribution on leaf states , and the combinatorial problem of reconstructing a tree from the additive function , which had been solved by buneman and zarecki .",
    "similarly the problem of reconstructing pedigrees under a recombination - mutation model may be solved in two parts : in the first part , we would like to reduce the identifiability question to an appropriate combinatorial reconstruction problem , and then in the second part we would like to show that the combinatorial reconstruction problem has a unique solution . to ensure the uniqueness of reconstruction , we will have to compute sufficiently strong combinatorial invariants of the pedigree from the joint distribution of extant sequences .",
    "although we noted that distances between extant vertices in a pedigree are not sufficient to reconstruct a pedigree , we sketch a heuristic argument given in @xcite that shows how the distances between extant vertices in a discrete generation pedigree may be obtained from sequence data .",
    "suppose @xmath7 and @xmath8 are two extant individuals in a pedigree .",
    "suppose further that in the pedigree there are @xmath9 pairs of paths such that one of the paths in each pair ends on @xmath7 and the other ends on @xmath8 , and the two paths in each pair start at a common ancestor of @xmath7 and @xmath8 in the @xmath10-th generation , and the two paths in a pair do not share any other vertex .",
    "now if sufficiently many short recombination - free homologous segments of dna of @xmath7 and @xmath8 are compared , then we would expect about @xmath11 of them to have a common ancestor in the @xmath10-th generation .",
    "thus it may be possible to estimate @xmath12 .",
    "such calculations are theoretically possible for small values of @xmath10 assuming the population is large and the sequences are long .",
    "they then tried to use the numbers @xmath12 for all pairs @xmath13 for all @xmath10 to construct the pedigree .",
    "they computationally found many pairs of non - isomorphic pedigrees that have the same number of pairs of paths of each length .",
    "one such example is the pair of pedigrees shown in figure  [ fig - hap ] , which was also mentioned in @xcite .",
    "but a more detailed analysis of sequence similarities ( between multiple sequences , if required ) under simple recombination and mutation models may give us more information than just pairwise distances between living individuals .",
    "in the main theorem of this paper ( theorem  [ thm - paths ] ) , we show that the joint distribution on extant sequences determines a class of combinatorial invariants ( e.g. , certain types of subgraph sequences ) that supersedes pairwise distances between extant sequences and subtrees ( genealogical trees ) in a pedigree .",
    "we then show that pedigrees , such as the ones in figure  [ fig - hap ] , that earlier seemed difficult to distinguish due to their combinatorial similarities ( including the non - reconstructible pedigrees constructed in @xcite ) are distinguished by the class of invariants .",
    "this paper is organised as follows . in section  [ sec - prelim ] , we define pedigrees , alignments and subgraph sequences . in section  [ sec - models ] , we give a schematic description of the recombination process , and formalise three models for sequences : model r ( a model in which there are recombinations but no mutations ) , model rm ( a model in which there are recombinations and mutations ) , and model m ( a model of mutations for sequences evolving on trees ) .",
    "we then formulate identifiability problems for these models . in section  [ sec - model - r ] , we analyse pedigrees with two generations under model r. in section  [ sec - model - rm ] , we prove the main theorem ( theorem  [ thm - paths ] ) and demonstrate its applications . in the last section ,",
    "we discuss a few open questions .",
    "a section on nomenclature follows the references where all symbols appearing in the paper and the number of the page on which they appear first are listed .",
    "we use the following notation for number systems and their subsets : @xmath14 for the set of integers , @xmath15 for the set of positive integers , @xmath16 for natural numbers , @xmath17 $ ] for the set @xmath18 . depending on the context",
    ", we write @xmath19 $ ] for the set of integers @xmath20 or real numbers @xmath21 ( and similarly @xmath22 , @xmath23 and @xmath24 $ ] for open or half - open intervals in integers and reals ) .",
    "the set of all @xmath10-tuples of elements of a set @xmath25 is written as @xmath26\\}$ ] .",
    "the set of all functions from @xmath27 to @xmath25 is written as @xmath28 .",
    "next we introduce some graph theoretic notation . the vertex set and the edge set of a graph @xmath29",
    "are denoted by @xmath30 and @xmath31 , respectively , and their cardinalities by @xmath32 and @xmath33 , respectively .",
    "the in - degree and the out - degree of a vertex @xmath34 in a directed graph are denoted by @xmath35 and @xmath36 , respectively .",
    "the degree of a vertex @xmath34 in an undirected graph ( or the total degree in a directed graph ) is denoted by @xmath37 .",
    "an arc from @xmath34 to @xmath38 in a directed graph and also an edge between @xmath34 and @xmath38 in an undirected graph is written as @xmath39 , and it will be understood from the context whether @xmath39 is meant to be a ( directed ) arc or an ( undirected ) edge . when any two objects @xmath40 and @xmath41 are isomorphic , we write @xmath42 .",
    "the isomorphism class of an object @xmath29 is written as @xmath43 . for a collection @xmath44 of labelled objects , we write @xmath45 for the set of isomorphism classes of objects in @xmath44 .",
    "let @xmath29 and @xmath46 be two directed or undirected graphs .",
    "we write @xmath47 ( or @xmath48 ) if @xmath29 is isomorphic to a subgraph of @xmath46 , and this notation may be used when @xmath29 or @xmath46 is unlabelled ( i.e. , they are just isomorphism classes ) .",
    "we write @xmath49 ( or @xmath50 ) when a labelled graph @xmath29 is a subgraph ( or a supergraph ) of a labelled graph @xmath46 .",
    "[ defn - general ] a _ general pedigree _ @xmath51 of a set @xmath27 is a directed acyclic graph on a vertex set @xmath52 and a set of arcs @xmath53 such that each vertex has in - degree 0 or 2 .",
    "the set @xmath27 is the set of vertices with out - degree 0 .",
    "the set @xmath54 is the set of vertices with in - degree 0 .",
    "the vertices in @xmath27 are called the _ extant vertices _ ( or the extant individuals in the population ) .",
    "the vertices in @xmath54 are called the _ founder vertices _ ( or the founders of the population ) .",
    "the _ order _ of the pedigree is @xmath55 .",
    "the _ depth _ of a pedigree is the length of ( i.e. , the number of arcs in ) a longest path in the pedigree .",
    "two pedigrees @xmath51 and @xmath56 are said to be _ isomorphic _ if there is a one - one map @xmath57 such that @xmath39 is an arc in @xmath58 if and only if @xmath59 is an arc in @xmath60 , and @xmath61 for all @xmath62 .",
    "we denote the natural partial order on @xmath63 by @xmath64 , i.e. , @xmath65 if there is a directed path from @xmath34 to @xmath38 ( or @xmath66 ) .",
    "we define isomorphism only between pedigrees of the same set of extant individuals and require that it fixes all extant vertices because ( informally speaking ) we would like to treat extant vertices to be labelled and other vertices to be unlabelled . throughout this paper",
    ", we will assume that all pedigrees have @xmath27 as their set of extant vertices .",
    "[ defn - diploid ] let @xmath51 be a pedigree .",
    "suppose that @xmath63 can be partitioned into unordered pairs of vertices such that the following conditions hold : the extant vertices are paired with extant vertices and the founder vertices are paired with founder vertices ; two non - extant vertices @xmath38 and @xmath67 are paired if and only if there are arcs @xmath68 and @xmath69 in @xmath53 ; no two paired vertices have a common parent .",
    "then @xmath58 together with one such pairing is called a _",
    "diploid pedigree_.    thus any general pedigree is a _ haploid pedigree _ ; a diploid pedigree is a haploid pedigree with a pairing of its vertices ( although not all pedigrees admit such a pairing ) .",
    "the pairing in a diploid pedigree is completely determined by the pairing of its extant vertices since all other pairs are determined by the definition .",
    "an advantage of a purely combinatorial definition of a diploid pedigree is that we can now assign just one sequence to each vertex . from this point of view , haploid pedigrees are pedigrees of sequences , not of individuals",
    ". pedigrees of individuals are diploid pedigrees obtained by pairing sequences in a haploid pedigree .",
    "figure  [ fig - d2h ] illustrates this point of view .",
    "when vertices ( sequences ) @xmath70 and @xmath71 are paired , @xmath72 and @xmath73 must be paired , since they are parents of @xmath70 ; similarly , @xmath74 and @xmath75 must be paired .",
    "[ defn - char ] let @xmath76 be a finite set ( called an _ alphabet _ ) and @xmath63 a finite set .",
    "a _ character _ on @xmath63 is a map @xmath77 . for @xmath78 , an _ alignment _ of length @xmath79 on @xmath63",
    "is a map @xmath80 .",
    "equivalently , an alignment is an @xmath79-tuple @xmath81 of characters on @xmath63 , or a two dimensional array of symbols from @xmath5 , with @xmath82 rows and @xmath79 columns .",
    "the rows of the array are called _ sequences _ , and are written as @xmath83 , @xmath84 to @xmath82 .",
    "individual entries in the array are written as @xmath85 , where @xmath84 to @xmath82 and @xmath86 to @xmath79 .",
    "the columns of an alignment are called _",
    "usually @xmath63 will be the set of vertices of a pedigree , and we will be interested in alignments restricted to the set @xmath27 of extant vertices of the pedigree .",
    "the space of characters on @xmath27 is @xmath87 , which is also referred to as the space of _ site patterns_. the set of alignments of length @xmath79 on a set @xmath27 is @xmath88 , which we write as @xmath89 .    let @xmath51 be a pedigree and let @xmath90 be an alignment on @xmath58 . if the sequences in @xmath91 have evolved under some process of recombination or mutation , then ( regardless of the details of the model of recombination or mutation ) we may suppose that each site in each sequence is inherited only from one of the two parent sequences .",
    "therefore , for each @xmath92 and each @xmath93 $ ] , there is a unique directed path @xmath94 from some founder vertex @xmath95 to @xmath34 that defines the genetic ancestry of @xmath96 .",
    "therefore , each site @xmath97 has associated with it a spanning forest @xmath98 , and each alignment of length @xmath79 has an underlying ( usually unknown ) sequence @xmath99 of spanning forests .",
    "similarly , each site @xmath97 has associated with it a _ directed subforest _",
    "defined by @xmath100 , and we have a _ directed subforest sequence _ @xmath101 of the alignment . here",
    "we define these notions purely graph theoretically ( without reference to alignments or models ) .",
    "[ defn - xtree ] let @xmath27 be a finite set . a _ directed @xmath27-forest _",
    "@xmath102 is a directed forest that satisfies the following conditions : the set of vertices with out - degree 0 is @xmath27 , and is called the _ leaf set _ of @xmath102 ; each component has a single vertex of in - degree 0 , called the _",
    "root vertex _ of the component , and all other vertices have in - degree 1 ; all arcs are directed away from the root vertices .",
    "undirected @xmath27-forest _ is an unrooted forest with leaf set @xmath27 .",
    "suppose @xmath102 is a directed @xmath27-forest .",
    "it induces a natural partition of @xmath27 into _ maximal clusters _",
    "@xmath103 such that vertices in cluster @xmath104 have a unique most recent common ancestor ( mrca ) @xmath105 in @xmath102 .",
    "we construct a subgraph of @xmath102 induced by @xmath106 $ ] and their descendants in @xmath102 , and then replace its ( directed ) arcs by ( undirected ) edges .",
    "the resulting undirected unrooted graph is called the _",
    "undirected @xmath27-forest _ of @xmath102 , written as @xmath107 .",
    "it is the maximal undirected @xmath27-forest contained in @xmath102 .    in the above definition , the term _",
    "@xmath27-forest _ is meant to be analogous to the term _",
    "@xmath27-tree _ that is commonly used in phylogenetics @xcite . in this paper",
    "we will adapt some of the phylogenetic identifiability results for undirected @xmath27-forests that appear as undirected graphs underlying subgraphs of pedigrees .",
    "therefore , in the following definition , we specialise the terms for pedigrees .",
    "[ defn - subtree ] let @xmath58 be a pedigree .",
    "a _ spanning forest _ of @xmath58 is a spanning subgraph @xmath29 of @xmath58 such that the in - degree of each vertex in @xmath29 is 1 unless it is a founder vertex in @xmath58 .",
    "a _ directed @xmath27-forest _ of @xmath58 is a subgraph @xmath102 of @xmath58 such that @xmath102 is a directed @xmath27-forest and the root vertex of each component of @xmath102 is a founder vertex in @xmath58 .",
    "each spanning forest @xmath29 in @xmath58 contains a unique directed @xmath27-forest of @xmath58 , and we denote it by @xmath108 . an _",
    "undirected @xmath27-forest _ in @xmath58 is the unique undirected @xmath27-forest in any directed @xmath27-forest in @xmath58 .",
    "each spanning forest @xmath29 in @xmath58 contains a unique undirected @xmath27-forest of @xmath58 , and we denote it by @xmath109 .    note that we use the term _ spanning forest _ in a specific sense : a spanning forest is not any spanning forest in the graph theoretic sense .",
    "we illustrate these terms in figure  [ fig - subtrees ] , which shows a pedigree and a spanning forest @xmath29 with @xmath110 ( shown by bold arcs ) . in this example , the unique directed @xmath27-forest @xmath108 in @xmath29 has the arc set @xmath111 ; its clusters are @xmath112 and @xmath113 , and the root vertices of its components are @xmath114 and @xmath4 .",
    "the unique undirected @xmath27-forest @xmath109 in @xmath29 consists of vertex set @xmath115 and edge set @xmath116 .",
    "note that vertex 3 is isolated in @xmath109 since it is the mrca of its cluster , but we need it in our analysis",
    ".        two ( directed or undirected ) @xmath27-forests @xmath102 and @xmath117 are said to be _ isomorphic _ ( written @xmath118 ) if there is a graph theoretic isomorphism @xmath119 from @xmath102 to @xmath117 such that @xmath61 for all @xmath120 in @xmath27 . the isomorphism class of a directed or an undirected @xmath27-forest @xmath102 , denoted by @xmath121 , is the set of all @xmath27-forests @xmath117 that are isomorphic to @xmath102 .",
    "the set of all directed @xmath27-forests of @xmath58 is denoted by @xmath122 .",
    "the set of isomorphism classes of directed @xmath27-forests of @xmath58 ( or the set of _ distinct _ directed @xmath27-forests in @xmath58 ) is denoted by @xmath123 .",
    "the set of spanning forests of a pedigree @xmath58 is denoted by @xmath124 .",
    "the set of undirected @xmath27-forests of @xmath58 is denoted by @xmath125 .",
    "the set of isomorphism classes of undirected @xmath27-forests of @xmath58 ( or the set of _ distinct _ undirected @xmath27-forests in @xmath58 ) is denoted by @xmath126 .",
    "[ prop - spanning - forests ] each spanning forest of a pedigree @xmath58 has @xmath127 arcs and contains exactly one directed @xmath27-forest . there are @xmath128 spanning forests .",
    "each directed @xmath27-forest @xmath102 is contained in @xmath129 spanning forests .",
    "each spanning forest of @xmath58 is obtained by selecting one of the two arcs that point to each non - founder vertex .",
    "the unique directed @xmath27-forest @xmath102 in a spanning forest @xmath29 is the subgraph of @xmath29 spanned by vertices in @xmath29 that are ancestral in @xmath29 to the extant vertices .",
    "finally , @xmath130 is the number of arcs not pointing to vertices in @xmath102 , therefore , @xmath131 is the number of non - founder vertices outside @xmath102 , at each of which we can choose one of the two incoming arcs to construct a spanning forest containing @xmath102 .    in any model of recombination , the number of recombination events is determined by the spanning forest sequence underlying an alignment , but we define it for all spanning forest sequences without reference to alignments or models .",
    "[ def - rg - sg ] let @xmath58 be a pedigree and let @xmath132 be a spanning forest sequence in @xmath58 .",
    "if @xmath68 and @xmath69 are distinct arcs in @xmath58 such that @xmath68 is in @xmath133 and @xmath69 is in @xmath134 , then we say that a recombination has occurred at site @xmath135 at vertex @xmath34 or that @xmath135 is a recombining site .",
    "if @xmath68 is an arc in @xmath133 and @xmath134 then we say that there is no recombination at @xmath34 at site @xmath135 .",
    "we define the number of recombinations in @xmath136 to be @xmath137 where @xmath138 is the number of recombinations separating @xmath133 and @xmath134 .",
    "the number of points of no recombination is @xmath139 the directed @xmath27-forest sequence of @xmath136 is the sequence @xmath140 , and the undirected @xmath27-forest sequence of @xmath136 is the sequence @xmath141 .",
    "we assume that in any reasonable model of sequence evolution , sequences are first assigned to the founder vertices , and then subsequent generations of individuals inherit their sequences from their parents sequences subject to recombinations and mutations .",
    "we are then interested in the following types of _ identifiability _ questions .",
    "[ problem - main ] suppose sequences of equal length over a finite alphabet are assigned to the founder vertices of a pedigree .",
    "the sequences then evolve on the pedigree undergoing recombinations and mutations , giving a probability distribution on the space of alignments on the set of extant vertices .",
    "can we determine the pedigree uniquely ( i.e. , up to isomorphism ) - with or without the knowledge of the size or the depth of the pedigree or the various probability parameters defining the recombination and mutation processes , with or without restrictions such as discrete generations or constant population , and so on ?",
    "in the case of diploid pedigrees , we will be given the distribution on alignments on the set of extant vertices along with a pairing of extant vertices .",
    "in this paper , we study the above types of questions under two simple models of recombination and mutation . in _",
    ", we assume that sequences evolve on a pedigrees under a process of recombinations without mutations . in _ model rm _ , we assume that sequences evolving on a pedigree undergo recombinations and mutations . for convenience",
    ", we also formalise the mutation part of model rm for the spanning forests of pedigrees and in general for directed @xmath27-forests , and call it _",
    "model m_.    in all these models , we assume that first all the founder vertices of a pedigree ( or the root vertices of a spanning forest or a directed @xmath27-forest ) are assigned sequences . these sequences are independently selected from a uniform distribution on @xmath142 , where @xmath76 is a known finite alphabet .",
    "then the sequences evolve on the pedigree ( or a spanning forest or a directed @xmath27-forest ) in a top - down manner , i.e. , a vertex is assigned a sequence only after its parents have been assigned sequences .",
    "we begin with a schematic description of the recombination process .",
    "our description is largely based on chapter 12 of @xcite .",
    "figure  [ fig - meio ] schematically shows the process of gamete ( sperm or egg ) formation in eukaryotes . initially there is a parent cell with one pair of homologous non - sex chromosomes . each chromosome",
    "is then duplicated with the identical sister _",
    "chromatids _ joined together at the _ centromere _ , forming a _ four - strand bundle_. then the two duplicated chromosomes exchange material between _ chiasmata _ ( _ recombination points _ ) . in the diagram",
    ", there are three recombination events .",
    "the first recombination is between strands 1 and 3 ( counted from top to bottom ) , the second is between strands 2 and 4 , and the third is between strands 2 and 3 .",
    "the four chromatids after the exchange of material are shown next .",
    "then the cell undergoes two cell divisions to create four haploid gametes , each receiving one of the four chromosomes .",
    "as shown in the diagram , at each recombination point a crossover occurs between one strand from the first pair and one strand from the second pair . at each crossover , a strand from the first pair and a strand from the second pair are chosen randomly with equal probability ( independent of other chiasma ) .",
    "this independence property is known as the lack of _ chromatid interference_.    suppose that the locations of recombinations are modelled as a poisson point process along the sequence ( or on @xmath143 ) with the rate @xmath144 or a bernoulli process with probability @xmath145 ( so that a crossover occurs after a site on a sequence with probability @xmath145 independently of other sites or sequences ) . since exactly two of the four gametes - one from the first pair and one from the second pair - inherit any recombination , any given gamete inherits a recombination with probability @xmath146 .",
    "therefore , for the sequence of any fixed gamete , the locations of recombinations are still modelled by a poisson process , but with the rate @xmath147 , ( or bernoulli process with probability @xmath148 ) . therefore",
    ", a model may be formalised with just two parent sequences instead of four .",
    "a poisson process for the locations of chiasmata was first proposed in @xcite .",
    "based on the above description , we formalise models r and rm , in which we assume that crossovers in a finite sequence occur according to a bernoulli process .        _",
    "model r : _ consider three sequences @xmath83 of length @xmath79 over alphabet @xmath5 , where @xmath149 and @xmath38 and @xmath67 are parents of @xmath34 . the sequence @xmath150 is obtained by recombining sequences @xmath151 and @xmath152 as follows .",
    "let @xmath153 be a markov chain on the state space @xmath154 with transition probabilities @xmath155 if @xmath156 for @xmath157 , and @xmath158 .",
    "then , for @xmath159 , @xmath160 if @xmath161",
    ". thus @xmath162 indicates a crossover from one sequence to the other .",
    "we refer to this model as _ model r_.    _ model rm : _ consider three sequences @xmath83 of length @xmath79 over alphabet @xmath5 , where @xmath149 and @xmath38 and @xmath67 are parents of @xmath34 . the sequence @xmath150 is obtained from the sequences @xmath151 and @xmath152 by a process of recombinations and mutations as follows .",
    "let @xmath153 be a markov chain on the state space @xmath154 with transition probabilities @xmath155 if @xmath156 for @xmath157 , and @xmath163",
    ". then if @xmath164 and @xmath165 , then @xmath166 is assigned @xmath1 with probability @xmath167 , and @xmath166 is assigned a state different from @xmath1 with probability @xmath168 .",
    "when a state different from @xmath1 is assigned to @xmath166 , each state in @xmath169 has equal probability @xmath170 of being assigned to @xmath166 .",
    "we refer to this process as _ model rm_.    _ model m : _ this process is defined for spanning forests of a pedigree and directed @xmath27-forests .",
    "first each founder or the root vertex in each component of a directed @xmath27-forest is assigned independently and uniformly randomly a state from @xmath5 .",
    "suppose @xmath97 is the parent vertex of @xmath135 in a spanning forest of a pedigree or in a directed @xmath27-forest .",
    "let @xmath83 and @xmath171 be the sequences of @xmath135 and @xmath97 , respectively , both of equal length @xmath79 over alphabet @xmath5 .",
    "then for each @xmath172 $ ] , @xmath173 is assigned the same state as @xmath174 with probability @xmath167 , and @xmath173 is assigned a state different from @xmath174 with probability @xmath168 .",
    "when a state different from @xmath174 is assigned to @xmath173 , each state in @xmath175 has equal probability @xmath170 of being assigned to @xmath173 .",
    "we refer to this process as _ model m_.    model m on a directed @xmath27-forest @xmath102 is equivalent to a similarly formulated model on the undirected @xmath27-forest of @xmath102 .",
    "we root each component of the undirected @xmath27-forest arbitrarily , and assign to it a state from @xmath5 uniformly randomly , independent of the roots of other components .",
    "the state then evolves away from the root in each component .",
    "if a component itself is an isolated vertex , it is simply assigned a state from @xmath5 uniformly randomly .",
    "since the mutation model described here is reversible , the same distribution on the site patterns is observed on @xmath27 in the undirected @xmath27-forest as in a directed @xmath27-forest for a given @xmath170 .",
    "therefore , when we try to construct a tree from the character distribution on its leaves , we can not construct the directed @xmath27-forest , but we can at best construct the undirected @xmath27-forest in it .",
    "therefore , we will consider model m only on undirected @xmath27-forests .    thus model rm may be thought of as a synthesis of models r and m so that the recombination - free segments of sequences evolving on a pedigree may be examined under model m with phylogenetic methods .",
    "let @xmath58 be a pedigree on @xmath27 .",
    "for an alignment @xmath176 , we denote by @xmath177 the probability that sequences of length @xmath79 evolving on the pedigree @xmath58 under model @xmath178 give an alignment @xmath91 on @xmath27 .",
    "we use analogous notation when the model @xmath178 is replaced by the model @xmath179 , or when the pedigree @xmath58 is replaced by a directed or an undirected @xmath27-forest @xmath102 and the model under consideration is the mutation model @xmath180 .",
    "we denote the various probability spaces by @xmath181 , @xmath182 , @xmath183 , @xmath184 , and so on . for pedigrees @xmath58 and @xmath60 , we will write @xmath185 when @xmath186 for all @xmath187 , and analogously for other models .    as in the case of alignments ,",
    "we treat the spaces of spanning forest sequences , directed @xmath27-forest sequences , and undirected @xmath27-forest sequences as probability spaces , and denote them by @xmath188 , @xmath189 , and @xmath190 , respectively .",
    "the spanning forest sequences , and directed and undirected @xmath27-forest sequences , ( and the corresponding sequences of isomorphism classes of spanning forests and directed and undirected @xmath27-forests ) are defined by only the recombination events , therefore , the probability spaces are unchanged if @xmath179 is replaced by @xmath178 .",
    "for a spanning forest sequence @xmath191 , we will write @xmath192 for the probability of @xmath193 in the probability space @xmath194",
    ". we will use analogous notation for other sequences and probability spaces . unless stated otherwise , when we will refer to alignments or sequences of spanning forests or other objects , we will mean alignments or sequences of spanning forests or other objects , respectively , from the appropriate probability spaces that are clear in the context .",
    "[ def - identifiability ] nonisomorphic pedigrees @xmath58 and",
    "@xmath60 in a class @xmath195 are said to be distinguished from each other under model @xmath178 if @xmath196 for some @xmath79 , ( i.e. , for some @xmath79 , there exists @xmath197 such that @xmath198 ) .",
    "a pedigree @xmath58 in a class @xmath195 is said to be identifiable under model @xmath178 if it is distinguished from every other pedigree @xmath60 in @xmath195 , ( i.e. , if there is a pedigree @xmath60 in @xmath195 such that @xmath199 for all @xmath200 , then @xmath60 is isomorphic to @xmath58 ) .",
    "pedigrees in a class @xmath195 are said to be identifiable under model @xmath178 if all pairs of pedigrees in @xmath195 are distinguished from each other under model @xmath178 .",
    "similar terminology will be used for other models and for undirected @xmath27-forests .",
    "stronger notions of identifiability may be defined , and correspondingly stronger variants of identifiability questions may be asked .",
    "the above definitions assume the model parameters to be fixed .",
    "but we may ask if there are nonisomorphic pedigrees @xmath58 and @xmath60 and model parameters @xmath201 such that @xmath202 for all @xmath203 .",
    "given the probability distribution a pedigree induces on the space of alignments , we may ask if the pedigree can be recognised to be in a class @xmath195 .",
    "we assume in all results in this paper that the model parameters and the class @xmath195 ( typically defined by the size of a pedigree ) to be fixed ( but possibly unknown ) .",
    "pedigrees of order 1 are in general not identifiable since for all pedigrees of order 1 , the extant sequence will be uniformly distributed .",
    "in fact for all pedigrees , all extant sequences will be uniformly distributed .",
    "but when there are more than one extant vertices , the joint distribution of extant sequences will contain some information about the pedigree on which they have evolved , because , for example , some vertices may have common ancestors , so their sequences will be correlated .",
    "we will therefore consider identifiability questions for pedigrees of order more than 1 .",
    "the models r and rm on a pedigree @xmath58 with @xmath204 arcs may be interpreted as hidden markov models with the set of hidden states @xmath124 and the set of observed states @xmath87 .",
    "this is illustrated in figure  [ fig - chains ] .",
    "the initial probability for each hidden state is @xmath205 .",
    "the probability of an observed state conditional on a given hidden state @xmath206 can be easily computed ( and actually depends only on @xmath109 and @xmath170 ) .",
    "the probability of transition from state @xmath133 to @xmath207 is given by @xmath208    in most contexts in which hmms are used , one assumes that the set of hidden states in known , but here we do not know the set @xmath124 .",
    "we also note that the sequence of @xmath27-forests is not a markov chain .",
    "consider directed @xmath27-forests @xmath209 and @xmath210 at sites @xmath97 and @xmath211 , respectively .",
    "suppose a vertex @xmath34 in @xmath212 has parents @xmath38 and @xmath67 in the pedigree .",
    "the probability that the arc @xmath68 is in @xmath210 depends on the history before the @xmath97-th site .",
    "for example , if @xmath68 was in @xmath213 then the probability that it would also be in @xmath210 is @xmath214 .",
    "but if @xmath68 was not in @xmath213 the probability that it would be in @xmath210 is @xmath215 .",
    "therefore , @xmath216 is not a markov chain , i.e. , @xmath217 may not be the same as @xmath218 if the sequences @xmath219 and @xmath220 are different .",
    "therefore , we can not interpret the models as hmms with directed or undirected @xmath27-forests as hidden states .     of characters at the extant vertices of a pedigree @xmath58 .",
    "among the intermediate chains , only @xmath221 is a markov chain.,width=445 ]",
    "in this section , we analyse diploid pedigrees and certain haploid pedigrees that obey many properties of diploid pedigrees under model @xmath222 .",
    "we show that , with some exceptions and mild conditions on @xmath145 and @xmath223 , diploid pedigrees of depth 2 are reconstructible from the probability distribution on the alignments on extant vertices .",
    "we use very basic techniques such as pairwise comparisons between extant sequences to exploit the correlation between them to reconstruct their pedigree .",
    "let @xmath58 be a pedigree and let @xmath102 be an undirected @xmath27-forest .",
    "we define @xmath224 .",
    "[ prop - ngt ] let @xmath58 be a pedigree with @xmath204 arcs .",
    "let @xmath225 be any character .",
    "then the probability that the @xmath10-th character in an alignment is @xmath226 is given by @xmath227 in particular , it does not depend on @xmath10 .",
    "let @xmath228 be a spanning forest sequence .",
    "it is a time - homogeneous markov chain on @xmath124 , with transition probabilities given by    @xmath229    it follows that @xmath230 for all @xmath231 .",
    "let @xmath232 be a sequence of characters .",
    "then , under model rm , @xmath233 & = & \\sum_{g \\in { \\mathcal{g}}_p }      { \\mathtt{pr}}\\{c_k = c\\mid g_k = g\\ } { \\mathtt{pr}}\\{g_k = g { \\mid}p , rm(p,\\mu)\\ } \\nonumber      \\\\[2 mm ] & = & \\frac{1}{2^e}\\sum_{g \\in { \\mathcal{g}}_p } { \\mathtt{pr}}\\{c_k = c\\mid g_k =      g\\ } \\nonumber \\\\[2 mm ] & = & \\sum_{t \\in \\lvert { \\mathcal{u}}_p \\rvert }      \\frac{n(g > t : p)}{2^e } { \\mathtt{pr}}\\{c\\mid t , m(\\mu)\\}.   \\nonumber    \\end{aligned}\\ ] ] a similar result holds when model rm is replaced by model r.    the above proposition implies that if two pedigrees have the same number of undirected @xmath27-forests of each type and the same number of arcs , then the character frequencies in alignments alone are not sufficient to distinguish the two pedigrees .",
    "for example , pedigrees in figure  [ fig - hap ] can not be easily distinguished .",
    "but it turns out that , under model r , most diploid pedigrees of depth 2 are easily distinguished by making pairwise comparisons between extant sequences and computing the probability that they agree at a site .",
    "the above proposition implies that the probability that two sequences in an alignment agree at a site @xmath10 does not depend on @xmath10 in models r and rm .",
    "moreover , such a probability can be computed easily under model r. any given undirected @xmath27-forest @xmath102 of a pedigree induces a partition of its leaves so that the leaves within a component are in the same part . under model r ,",
    "the probability that the sequences at two leaves @xmath135 and @xmath97 are in the same state at a site is 1 if they are in the same component of @xmath102 .",
    "otherwise , the probability is @xmath234 . under model rm ,",
    "the probability depends on @xmath170 if they are in the same component , and is @xmath234 otherwise .",
    "[ prop-2seq ] let @xmath58 be a diploid pedigree of depth 2 .",
    "let @xmath235 .",
    "then the subpedigree of @xmath135 and @xmath97 is determined by the probability distribution induced on @xmath236 under model r.    there are four possible ways in which any two vertices @xmath135 and @xmath97 are related in a diploid pedigree , which are shown in figure  [ fig - grand ] . for each of them",
    ", we give the probability that the sequences @xmath70 and @xmath72 match at any site @xmath10 . in the following , we set @xmath237 .     and @xmath97 may be related , width=445 ]    _ case 1 : _ if @xmath135 and @xmath97 have the same parents , then @xmath238 .",
    "_ case 2 : _ if @xmath135 and @xmath97 have distinct pairs of parents but the same grand parents , then @xmath239 .",
    "_ case 3 : _ if @xmath135 and @xmath97 have distinct pairs of parents but exactly one pair of grand parents in common , then @xmath240 .",
    "_ case 4 : _ if @xmath135 and @xmath97 have no common parents or grand parents , then @xmath241 .    therefore , unless @xmath242 , the above cases are distinguished by the marginal joint distribution on @xmath236 under model r.    the assumption that @xmath58 is a diploid pedigree is essential .",
    "it implies that @xmath135 and @xmath97 are not related as in the haploid pedigree @xmath243 shown in figure  [ fig - hap ] .",
    "we can verify that @xmath244 for both @xmath245 and @xmath243 , so they are indistinguishable by the above method , which was also pointed out as a consequence of proposition  [ prop - ngt ] .",
    "the above probabilities do not depend on @xmath145 , therefore , we have a slightly stronger identifiability statement : if diploid pedigrees @xmath58 and @xmath60 of depth 2 and crossover probabilities @xmath145 and @xmath246 are such that @xmath247 then their subpedigrees of order 2 are correspondingly isomorphic .    [ prop - n2 - 1 ] when @xmath248 , pedigrees of depth 2 in which no two vertices have exactly one common parent are identifiable under model r. in particular , when @xmath248 , diploid pedigrees of depth 2 are identifiable under model r.    there are only 4 ways in which any two extant vertices @xmath135 and @xmath97 are related .",
    "they are illustrated in figure  [ fig - grand ] .",
    "each of the possible relationships is recognised by proposition  [ prop-2seq ] .",
    "we denote the 3rd and the 4th types of relationships by @xmath249 and @xmath250 , respectively .",
    "suppose that no two extant vertices @xmath251 in a pedigree are related to each other as @xmath249 or @xmath250 .",
    "then the pedigree is constructed by adding extant vertices one by one . on each step",
    "we add one extant vertex and join to previously added extant vertices as in figure  [ fig - grand ] - ( i ) or ( ii ) , whichever is appropriate .",
    "therefore , we assume that at least two extant vertices @xmath252 are related as @xmath249 or @xmath250 .",
    "let @xmath253 be a ( nonempty ) maximal subset of @xmath27 such that for any two distinct extant vertices @xmath135 and @xmath97 in @xmath253 , either @xmath249 or @xmath254 .",
    "every other extant vertex @xmath10 not in @xmath253 is related to some vertex in @xmath253 as in figure  [ fig - grand ] - ( i ) or ( ii ) .",
    "therefore , once the subpedigree of @xmath253 is constructed , there is only one way to extend it to the whole pedigree .",
    "to construct the subpedigree of @xmath253 , we first construct an edge labelled graph with edge set @xmath253 in which edges @xmath135 and @xmath97 are incident if and only if @xmath249 .",
    "this is a known problem in graph theory , namely , the problem of constructing an edge labelled graph from its line graph .",
    "it was proved @xcite that there are only 4 pairs @xmath255 of connected nonisomorphic edge labelled graphs that have the same line graphs .",
    "edge labelled graphs that can not be uniquely constructed from their line graphs must contain components isomorphic to @xmath133 or @xmath256 .",
    "we refer to @xcite ( in particular , chapter 15 , problem 1 ) for discussion about reconstructing graphs from their line graphs , in particular , for the complete list of pairs @xmath255 .",
    "the first pair is @xmath257 ( with edges of each of them labelled @xmath258 ) .",
    "based on the example @xmath257 , we construct pedigrees shown in figure  [ fig - k3 ] , in which all pairs of extant vertices are similarly related .",
    "we distinguish the two pedigrees in figure  [ fig - k3 ] by comparing the probabilities @xmath259 and @xmath260 for any site @xmath2 .    in @xmath261 , there are 512 spanning forests . among them",
    "there are 192 spanning forests in which two extant vertices have a common grandparent , giving the first term on the rhs below . in the remaining 320 spanning forests ,",
    "no two extant vertices have a common grandparent , which explains the second term on the rhs below .",
    "therefore , @xmath262    in @xmath263 , there are 512 spanning forests . among them",
    "there are 16 spanning forests in which @xmath258 have a common grandparent ( giving the first term on the rhs below ) , 144 spanning forests in which two extant vertices have a common grandparent at site @xmath2 ( giving the second term ) , and 352 spanning forests in which @xmath258 have distinct grandparents at site @xmath2 ( giving the third term ) .",
    "therefore ,    @xmath264 whenever @xmath248 , @xmath265 , therefore , @xmath261 and @xmath263 can be distinguished .",
    "the two expressions are equal when @xmath266 .",
    "similarly , other pedigrees constructed from @xmath267 are distinguished when @xmath248 .",
    "since there are only two types of site patterns for three sequences when @xmath266 ( either the three sequences agree at a site or exactly two of them agree ) , the two cases can not be distinguished by considering other site pattern probabilities .    in diploid pedigrees ,",
    "no two vertices have exactly one common parent , therefore , when @xmath248 , they are identifiable under model r.    we used only site pattern probabilities in the above proofs . but because of recombinations , consecutive sites in an alignment are not independent .",
    "we use the dependence between sites to eliminate the restriction @xmath248 when the crossover probability @xmath145 is sufficiently small .",
    "[ prop - n2 - 2 ] when @xmath266 and @xmath145 is sufficiently small , haploid pedigrees @xmath261 and @xmath263 ( shown in figure  [ fig - k3 ] ) are distinguished under model @xmath179 .",
    "we compute the probability that , in an alignment @xmath91 , there are long runs of sites at which all the three sequences @xmath70 , @xmath72 and @xmath74 are equal .",
    "in particular , we compute bounds on @xmath268\\}$ ] on the two pedigrees .    for @xmath261 , for any fixed @xmath269 , if any two of the three sites @xmath270 are inherited from the same grand parent , then @xmath271 , and if all of them are inherited from distinct grandparents , then @xmath272 is 1/4 .",
    "therefore , @xmath273 { \\mid}p_2,r(p ) \\ }    \\leq ( 1/2)^{t+1}.\\ ] ]    for @xmath263 , the probability that the first site of all sequences is inherited from a common grand parent is 1/32 .",
    "the probability that at each successive site the three sequences have a common grand parent is @xmath274 .",
    "therefore , @xmath275 { \\mid}q_2,r(p ) \\ } \\nonumber \\\\[2 mm ] & \\geq &      \\frac{\\left((1-p)^6+p^3(1-p)^3\\right)^t}{32}.    \\end{aligned}\\ ] ] when @xmath145 is sufficiently small and @xmath276 is sufficiently large , the above probability for @xmath263 is more than that for @xmath261 .",
    "we do not analyse other examples of pedigrees based on graphs that are not reconstructible from their line graphs ( graphs @xmath277 mentioned in proposition  [ prop - n2 - 1 ] ) , but they may be analysed similarly .",
    "in this section we develop ideas from section  [ sec - model - r ] ( especially proposition  [ prop - n2 - 2 ] ) in much more generality .",
    "earlier we observed that parts of alignments that are free of recombination may be analysed with phylogenetic methods . since we do not know where the recombinations have occurred in an alignment , we choose long segments of carefully chosen alignments ( or sets of alignments ) and show that they have higher probability of having evolved on one particular @xmath27-forest ( or a sequence of @xmath27-forests ) than any other @xmath27-forest ( or a sequence of @xmath27-forests ) .",
    "for example , the method of proposition  [ prop - n2 - 2 ] works because @xmath263 contains a tree in which @xmath258 have a common ancestor and @xmath261 does not contain such a tree .",
    "therefore , a sufficiently long sequence of characters in which sequences @xmath278 and @xmath279 are in the same state will more likely have evolved on a pedigree such as @xmath263 than on a pedigree that does not contain such a tree .",
    "this argument may be generalised to count the number of @xmath27-forests of each type from the distribution of extant sequences .",
    "such a generalisation requires identifiability results for phylogenetic trees , which we state in a form suitable for our application .      in this section , we state known results on identifiability and statistical consistency of maximum likelihood reconstruction of phylogenetic trees .",
    "we need to adapt them slightly since the @xmath27-forests in a pedigree differ from phylogenetic trees in three respects - they may have vertices of degree 2 , they may be unresolved ( i.e. , they may have vertices of degree more than 3 ) , and they may be disconnected ( two extant vertices may not have a common ancestor in a given directed @xmath27-forest in a pedigree ) . we address them in the following identifiability result , which was originally proved for phylogenetic trees in @xcite in the @xmath266 case .",
    "identifiability and statistical consistency of maximum likelihood reconstruction of phylogenetic trees were independently proved in full generality for all @xmath280 in @xcite .",
    "[ thm - identifiability ] for all @xmath281 and any two undirected @xmath27-forests @xmath282 and @xmath283 with bounded number of edges , if @xmath284 for all characters @xmath285 then @xmath286 .",
    "the result follows from the analogous results in @xcite for phylogenetic @xmath27-trees , but we have to clarify three issues : unlike the phylogenetic @xmath27-trees , the @xmath27-forests as defined in this paper may be disconnected , unresolved , and may have vertices of degree 2 .    _",
    "connectivity : _ any two extant vertices @xmath287 and @xmath288 are in different components of @xmath282 and @xmath283 if and only if @xmath289 for all @xmath290 , where @xmath291 is the state at the extant vertex @xmath135 in a character @xmath226 .",
    "if @xmath135 and @xmath97 are in the same component , then @xmath292 can not be arbitrarily close to @xmath234 if the number of edges ( and hence the distance between @xmath135 and @xmath97 ) is bounded .",
    "therefore , we can consider the identifiability question for each component separately .",
    "_ unresolved @xmath27-forests : _ given an unresolved phylogenetic tree , there are resolved phylogenetic trees with site pattern probabilities arbitrarily close to the site pattern probabilities for the unresolved tree .",
    "therefore , even though unresolved phylogenetic @xmath27-trees are identifiable , statistical consistency of maximum likelihood methods requires that the substitution probabilities on the edges of a phylogenetic tree are bounded below by a positive real number . in our model ,",
    "corollary  [ cor - consistency ] below is possible because the substitution probability @xmath170 is fixed on each edge .",
    "_ vertices of degree 2 : _ let @xmath34 and @xmath38 be any two vertices of an @xmath27-forest .",
    "suppose that @xmath34 and @xmath38 are of degree 1 or more than 2 .",
    "suppose all internal vertices on the path between @xmath34 and @xmath38 have degree 2 .",
    "since @xmath170 is fixed for all arcs , the distance between @xmath34 and @xmath38 on a tree is determined by the substitution probability on the @xmath39 path .",
    "the substitution probability on the @xmath39 path is determined by the distribution on the space of characters .    in the above result ,",
    "if @xmath282 and @xmath283 were directed @xmath27-forests , then we would be able to conclude that @xmath293 .",
    "let @xmath294 .",
    "suppose that @xmath295 .",
    "we associate with each undirected @xmath27-forest @xmath102 a vector @xmath296 in @xmath297 , where @xmath298 .",
    "therefore , the condition @xmath299 for all characters @xmath225 may be equivalently written as @xmath300 .",
    "given @xmath301 and a point @xmath302 , let the open ball of radius @xmath1 centred at @xmath303 be denoted by @xmath304 . here",
    "the radius may be taken to be in the 1-norm ( i.e. , the distance between points @xmath305 and @xmath306 is defined by @xmath307 ) .",
    "let @xmath91 be an alignment on @xmath27 .",
    "we define a vector @xmath308 , where @xmath309 are the _ fractional site pattern frequencies _ , i.e. , @xmath309 is the fraction of columns of @xmath91 of type @xmath310 .",
    "then the above identifiability result implies a statistical consistency result for maximum likelihood .",
    "it informally says that as the length of a random alignment @xmath91 goes to infinity , we expect @xmath311 to be arbitrarily close to @xmath312 with probability approaching 1 if @xmath102 is the true @xmath27-forest , and that the probability that @xmath311 is arbitrarily close to @xmath312 approaches 0 if @xmath102 is not the true @xmath27-forest .",
    "[ cor - consistency ] for all @xmath313 , @xmath314 and @xmath315 , there exists @xmath316 such that for any two undirected @xmath27-forests @xmath102 and @xmath117 such that @xmath317 , and an alignment @xmath318 , @xmath319 and @xmath320    we give bounds on the above probabilities in terms of @xmath79 , which we prove using bernstein s inequality .    [ lem - bernstein1 ] let @xmath321 be i.i.d . bernoulli random variables with @xmath322 .",
    "then for all @xmath323 and @xmath324 , @xmath325 and ( equivalently ) @xmath326    [ lem - eps - l1 ] let @xmath313 and @xmath281 .",
    "let @xmath327 .",
    "let @xmath102 be an undirected @xmath27-forest .",
    "then @xmath328    there are @xmath329 distinct characters , with probabilities @xmath330 , @xmath331 . if @xmath332 , then @xmath333 for some @xmath135",
    "therefore , we apply bernstein s inequality to each distinct character , and write the probability that @xmath334 .",
    "we then apply the union bound to get the result .",
    "if we set @xmath335 it will ensure that the @xmath27-forests are _ separated _ by open balls of radius @xmath336 in the space of site pattern probability vectors , i.e. , the open balls @xmath337 and @xmath338 are non - intersecting whenever @xmath339 and @xmath209 are non - isomorphic .",
    "we will use this value of @xmath336 unless specified otherwise .",
    "now for an undirected @xmath27-forest @xmath339 , we define @xmath340 and @xmath341 by selecting a sufficiently large value of @xmath79 we can make @xmath342 arbitrarily small as in lemma  [ lem - eps - l1 ] . moreover , if @xmath343 , then @xmath344 hence @xmath345 can be made arbitrarily small as per lemma  [ lem - eps - l1 ] .",
    "we set @xmath346 , which depends on @xmath79 and @xmath336 .    in theorem  [ thm - paths ] ( particularly in the proof of inequality  [ eq - term1a ] )",
    "we require a concentration inequality similar to the inequality in lemma  [ lem - eps - l1 ] for the situation in which @xmath79 sites of an alignment have evolved on an @xmath27-forest @xmath339 and @xmath347 sites ( for a small @xmath348 ) have evolved on another @xmath27-forest @xmath209 .",
    "( we will keep the notation simple by assuming that @xmath347 is an integer . ) therefore , we give the following variants of lemmas  [ lem - bernstein1 ] and  [ lem - eps - l1 ] .",
    "[ lem - bernstein2 ] let @xmath349 be i.i.d .",
    "bernoulli random variables with @xmath350 .",
    "let @xmath351 be bernoulli random variables .",
    "let @xmath352 , where @xmath353 is a positive constant .",
    "let @xmath354 and @xmath355 and @xmath356 . if @xmath357 and @xmath358 , then @xmath359    since @xmath360 , we have @xmath361      & \\implies & \\left(\\frac{s_n}{n(1+c ) } - p \\leq",
    "-r\\right )      \\;\\text{or}\\ ; \\left(\\frac{s_n}{n(1+c ) } - p \\geq r\\right )      \\\\[1 mm ]      & \\implies & \\left(\\frac{\\sum_{i=1}^n x_i}{n(1+c ) } - p \\leq",
    "-r\\right )      \\;\\text{or}\\ ; \\left(\\frac{cn + \\sum_{i=1}^n x_i}{n(1+c ) } - p \\geq",
    "r\\right ) \\\\[1 mm ]      & \\implies & \\left(\\frac{\\sum_{i=1}^n x_i}{n(1+c ) } \\leq p - r \\leq m \\right )      \\;\\text{or}\\ ; \\left(\\frac{cn + \\sum_{i=1}^n x_i}{n(1+c ) } \\geq p+r \\geq m      \\right ) \\\\[1 mm ]      & \\implies & \\left(\\frac{\\sum_{i=1}^n x_i}{n(1+c)}-\\frac{p}{1+c } \\leq        m-\\frac{p}{1+c}\\right )      \\text{or}\\ ; \\left(\\frac{cn + \\sum_{i=1}^n x_i}{n(1+c ) } -        \\frac{p+c}{1+c } \\geq   m-\\frac{p+c}{1+c } \\right ) \\\\[1 mm ]      & \\implies & \\left(\\frac{\\sum_{i=1}^n x_i}{n}-p \\leq -r^\\prime \\right )      \\;\\text{or}\\ ;       \\left(\\frac{\\sum_{i=1}^n x_i}{n}-p \\geq r^{\\prime\\prime}\\right ) .",
    "\\end{aligned}\\ ] ] now we apply bernstein s inequality ( lemma  [ lem - bernstein2 ] ) to each term and obtain the desired bound .",
    "let @xmath91 be an alignment of length @xmath362 .",
    "suppose that @xmath79 characters of @xmath91 evolved on an undirected @xmath27-forest @xmath102 and the remaining characters evolved on undirected @xmath27-forests @xmath363 .",
    "the following lemma states that if @xmath353 is sufficiently small , then @xmath311 is concentrated near @xmath364 for large @xmath79 .",
    "moreover , as in lemma  [ lem - eps - l1 ] , if we require @xmath311 to be sufficiently near @xmath364 with probability at least @xmath365 , then the length of the alignment @xmath362 must be @xmath366 . in the following lemma , we do not specify the constants @xmath367 and @xmath368 precisely , but they can be chosen depending on @xmath336 .",
    "[ lem - eps - l2 ] let @xmath313 and @xmath281 .",
    "let @xmath369 for a suitably chosen positive constant @xmath353 .",
    "let @xmath370 be undirected @xmath27-forest .",
    "then @xmath371      & \\leq &      \\sum_i^{|\\sigma|^{|x|}}\\left(\\exp \\left\\{\\frac{-l(r_i^\\prime)^2}{2p_i(1-p_i )            + 2r_i^\\prime/3}\\right\\ } + \\exp        \\left\\{\\frac{-l(r_i^{\\prime\\prime})^2 }           { 2p_i(1-p_i ) + 2r_i^{\\prime\\prime}/3}\\right\\}\\right ) ,    \\end{aligned}\\ ] ] where @xmath372 and @xmath368 are positive constants as in lemma  [ lem - bernstein2 ] .",
    "we apply lemma  [ lem - bernstein2 ] for each component of @xmath311 and use the union bound as in the proof of lemma  [ lem - eps - l1 ] . for each component",
    ", we use @xmath373 as before .",
    "constants @xmath372 and @xmath368 ( and @xmath374 , which are implicit ) depend on @xmath336 and the probabilities @xmath330 , @xmath375 .",
    "the constant @xmath353 may be taken to be the smallest among @xmath376 .",
    "a hidden markov model ( hmm ) is defined by two sequences @xmath377 and @xmath378 of random variables .",
    "the sequence @xmath379 takes values in @xmath380 $ ] and is a stationary markov chain with transition matrix @xmath91 and initial distribution @xmath381 to @xmath1 , which is also the stationary distribution of the markov chain .",
    "the random variables @xmath378 take values in @xmath382 $ ] , and are independent and identically distributed conditional on @xmath379 .",
    "the distribution of @xmath383 depends only on @xmath384 .",
    "let @xmath385 be the @xmath386 matrix of conditional probabilities @xmath387 , where @xmath388 $ ] and @xmath389 $ ] .",
    "the sequence @xmath378 are the _",
    "observations_. identifiable hidden markov models were characterised in @xcite , where a precise description of conditions on @xmath91 and @xmath385 for which the probability distribution on observed sequences determines @xmath91 and @xmath385 ( up to re - labelling of hidden states ) was given . here _ identifiability up to a re - labelling of hidden states _ means the following : if @xmath25 is an @xmath390 permutation matrix , then the hmm with parameters @xmath391 ( where @xmath119 is treated as a column vector of length @xmath1 ) is equivalent to ( induces the same distribution on the space sequences of observed states as ) the hmm with parameters @xmath392 .",
    "therefore , identifiability only means computing the matrices and the initial distribution up to equivalence .",
    "we denote the class of models equivalent to @xmath391 by @xmath393 .",
    "earlier we noted that models r and rm for sequences evolving on a pedigree @xmath394 define a hidden markov model with the spanning forests in @xmath58 as hidden states and characters from @xmath87 as observed states .",
    "we call it @xmath395 and denote its matrices by @xmath396 and @xmath397 . the initial distribution on hidden states is uniform : each spanning forest has the probability @xmath398 if the pedigree has @xmath399 arcs .",
    "we informally look at some of the issues about its identifiability .",
    "the transition matrix @xmath396 is defined by transition probabilities given in equation  ( [ eq - gi - gj ] ) . therefore , @xmath396 will be identical ( up to a permutation of rows and columns ) for all pedigrees with the same number of arcs , for a fixed @xmath145 .",
    "but the set of spanning forests ( hidden states ) is unknown .",
    "we now describe at a high level how we compute the rows of @xmath397 .",
    "suppose the pedigree contains an undirected @xmath27-forest @xmath339 .",
    "there are @xmath400 spanning forests @xmath29 of @xmath58 that contain @xmath339 as the unique undirected @xmath27-forest , and corresponding to each of them we have a row of @xmath397 that is equal to @xmath401 .",
    "now consider a set @xmath402 of sufficiently long alignments as defined in equation  [ eq - mcai ] .",
    "we compute the probability of @xmath403 ( i.e. , the probability that a random alignment is in @xmath403 ) .",
    "suppose that @xmath404 is the probability that there are no recombination events .",
    "thus @xmath404 approaches 1 as @xmath145 approaches 0 .",
    "then one of the terms in the expression for the probability of @xmath403 will be @xmath405 , where @xmath406 is the probability that the first site evolved on a spanning forest @xmath29 that contained @xmath339 as the undirected @xmath27-forest .",
    "there will be terms for contributions from other undirected @xmath27-forests @xmath407 , but they will be much smaller than the above term because they will contain factors @xmath408 ( as in equation  [ eq - p - mcai ] ) .",
    "there will also be terms to account for recombinations among the first @xmath79 sites , but they will be small as well since they will contain @xmath145 as a factor ( in contrast to @xmath404 , which is a power of @xmath409 ) .",
    "so let us say @xmath410 is @xmath411 .",
    "therefore if @xmath145 is sufficiently small and @xmath79 is sufficiently large , then @xmath412 will be roughly equal to the dominating term @xmath413 , which will uniquely determine @xmath414 . in other words , if @xmath60 is another pedigree such that @xmath415 , then @xmath410 and @xmath416 will differ roughly by a multiple of @xmath417 .    in the proof of proposition  [ prop - n2 - 2 ]",
    ", we used a similar idea :",
    "the pedigree @xmath263 contains a certain subtree @xmath102 in which @xmath258 have a common ancestor , while the pedigree @xmath261 does not such a subtree . as a result ,",
    "the alignments that are close to @xmath364 are more likely to have evolved on @xmath263 than on @xmath261 .",
    "suppose now that @xmath397 is identified and each of its rows is labelled by the corresponding unlabelled undirected @xmath27-forest .",
    "that is , the matrices @xmath397 that appear among the triples in the equivalence class @xmath393 of hmms are constructed .",
    "as pointed out above , the matrix @xmath396 and the initial distribution are also known up to relabelling of hidden states .",
    "but the equivalence class @xmath418 is not known unless we are able to label the rows and the columns of @xmath396 by unlabelled undirected @xmath27-forests in a manner consistent with the labelling of rows of @xmath397 .",
    "in other words , for full identifiability of @xmath395 , we would like to construct an automaton with transition probabilities given by @xmath396 and with its states labelled by unlabelled undirected @xmath27-forests . identifying the pedigree from the _ labelled automaton _",
    "will then be a purely combinatorial problem .",
    "in this paper we do not succeed in constructing matrix @xmath396 with rows and columns labelled by undirected @xmath27-forests , but we are able to count certain types of _ walks _ ( to be described next ) on the automaton with vertices labelled by undirected @xmath27-forests .",
    "suppose that @xmath419 is a sequence of undirected @xmath27-forests such that no two consecutive ones are isomorphic .",
    "analogous to @xmath420 , we define @xmath421 as the number of sequences @xmath422 of spanning forests in @xmath58 such that @xmath423 , where consecutive @xmath133 are separated by just one recombination .",
    "( a single recombination at a site is more likely than multiple recombinations .",
    "moreover , if there is a recombination at a site @xmath135 , but the two spanning forests @xmath133 and @xmath134 contain isomorphic undirected @xmath27-forests , then such a recombination has no effect on the emitted characters .",
    "these are the reasons why we consider the sequences @xmath339 and @xmath133 as above . )",
    "we then consider a set @xmath424 of alignments of length @xmath425 ( for a suitably large @xmath79 ) obtained by concatenating alignments from @xmath403 for @xmath84 to @xmath269 .",
    "we compute the probability of @xmath424 ( as we described for @xmath426 above ) , and show that the dominating term is proportional to @xmath427 , and other terms are of smaller order of magnitude for small @xmath145 .",
    "this allows us to compute @xmath428 .",
    "a more visual description of the walks may be given as follows .",
    "suppose the pedigree has @xmath399 arcs .",
    "we define a graph on the vertex set consisting of the spanning forests of the pedigree , with two spanning forests @xmath133 and @xmath207 being adjacent if there is exactly one recombination separating them ( i.e. , @xmath429 ) .",
    "the graph is a hypercube .",
    "the hidden markov chain on the set of spanning forests jumps on the vertices of the cube .",
    "if there is at most one recombination at any site ( which is more likely than more than 1 recombinations at a site ) , then we have a walk on the edges of the cube .",
    "we label each vertex @xmath133 of the cube by the undirected @xmath27-forests @xmath430 .",
    "our interest is to construct this object for a more complete understanding of the hmm .",
    "but problem is made difficult by the fact that the emission probabilities associated with @xmath133 and @xmath207 are identical if @xmath431 .",
    "therefore , we construct a weaker object , namely the number of walks of each length on the cube such that consecutive vertices have distinct labels .",
    "let @xmath58 be a pedigree . for @xmath432",
    ", we define @xmath433    & : = & n(g_1 > t_1 , g_2 > t_2 , \\ldots , g_m > t_m : p ) \\\\[2 mm ]    & : = & |\\{\\mathbf{g } \\in { \\mathcal{g}}_p^m : t_u(g_i ) \\cong t_i \\forall    i \\in [ m ] \\wedge |e(g_{i+1})\\bigtriangleup e(g_{i})| = 2 \\ ; \\forall\\ ;    i \\in [ m-1]\\}|,\\end{aligned}\\ ] ] where the second condition in the last line says that there is exactly one recombination event between consecutive @xmath133 .",
    "in the rest of this section , we show how invariants @xmath434 may be computed from the probability distribution on the space of alignments under model rm . in the end",
    ", we demonstrate an application to pedigrees @xmath245 and @xmath243 shown in figure  [ fig - hap ] .",
    "lem - pg ] let @xmath58 be a pedigree with @xmath204 arcs .",
    "let @xmath435 be a sequence of spanning forests in @xmath58 . then under model @xmath179 , the probability that @xmath136 is a sequence of site - specific spanning forests is given by @xmath436 where @xmath437 and @xmath438 are as in definition  [ def - rg - sg ] .",
    "we have a factor @xmath145 for each recombination event and @xmath409 whenever there is no recombination ( i.e. , an arc is contained in two consecutive spanning forests in the sequence ) .",
    "the probability that the first spanning forest is @xmath40 is @xmath398 .",
    "let @xmath318 be an alignment of length @xmath79 .",
    "for an interval @xmath439 \\subseteq [ l]$ ] , we write @xmath440 $ ] for the part of the alignment between columns @xmath441 and @xmath442 ( inclusive of columns @xmath441 and @xmath442 ) . for a sequence of alignments",
    "@xmath443 $ ] , let @xmath444 denote the alignment obtained by concatenating alignments @xmath445 ( in that order ) .",
    "let @xmath446 $ ] be sets of alignments .",
    "we define @xmath447\\}.\\ ] ]    [ lem - pa ] let @xmath58 be a pedigree with @xmath204 arcs .",
    "the probability of an alignment @xmath318 on @xmath58 is given by @xmath448      & = & \\sum_{k=1}^{l}\\ ; \\sum_{\\mathbf{g } \\in { \\mathcal{g}}_p^k }      \\frac{(1-p)^{e(l - k)+s(\\mathbf{g})}p^{r(\\mathbf{g})}}{2^{e } }       \\sum_{\\substack{\\mathbf{l } \\in { \\mathbb{z}}_+^k : \\\\          \\sum\\limits_{i=1}^kl_i = l}}\\ ;      \\prod_{i=1}^k{\\mathtt{pr}}\\{a[l_{i-1}+1,l_i ] { \\mid}t_u(g_i),m(\\mu ) \\ } ,    \\nonumber \\\\      & &    \\end{aligned}\\ ] ] where @xmath449 , @xmath450 and @xmath451 , and the second summation is over @xmath136 such that consecutive spanning forests @xmath452 and @xmath134 are unequal for @xmath453 $ ] .    the probability of an alignment of length @xmath79 is obtained by summing its probability over all spanning subgraph sequences of length @xmath79 .",
    "suppose that the recombinations in a spanning subgraph sequence occur only at sites @xmath454 , for @xmath455 , where @xmath456 .",
    "we write the spanning forest sequence of length @xmath79 as @xmath457 .",
    "then the probability of the alignment is written as a product of probabilities of its segments that have evolved on spanning forests @xmath133 ( i.e. , effectively on @xmath430 ) .",
    "this probability is summed over @xmath458 ( with the constraint @xmath459 ) , @xmath460 $ ] and @xmath461 . for a fixed @xmath462 , the probability of @xmath457",
    "is given by lemma  [ lem - pg ] .",
    "for @xmath463 , we will compute @xmath464 by summing ( [ eq - pa ] ) over @xmath465 .",
    "in such a calculation , we will sometimes use the following upper bound in evaluating the last summation in ( [ eq - pa ] ) for fixed values of @xmath10 , and fixed @xmath466 and @xmath136 .",
    "[ lem - pa - ub2 ] let @xmath463 .",
    "let @xmath467 .",
    "let @xmath468 : a \\in { \\mathcal{a}}\\ } , i \\in [ k]$ ] .",
    "then for any fixed @xmath469 @xmath470 we have equality if @xmath471 .",
    "the claim follows from the observation that @xmath472 .",
    "the following lemma is used in the proof of equation  ( [ eq-3b ] ) , and the reader may skip it until then .",
    "[ lem - seq ] let @xmath473 be a finite set .",
    "let @xmath474 and @xmath475 be two sequences in @xmath473 , each of length @xmath476 , defined by @xmath477 where @xmath478 and @xmath479 $ ] , and @xmath480 where @xmath481 and @xmath482 $ ] .",
    "suppose that @xmath474 and @xmath475 satisfy the constraints : @xmath483 $ ] ; @xmath484 $ ] ; @xmath485 ; if @xmath486 , then @xmath487 for some @xmath135 .",
    "then there is at least one block @xmath488 of @xmath474 over which @xmath474 and @xmath475 mismatch everywhere ; hence there are at least @xmath489\\}$ ] mismatches between the two sequences .",
    "suppose that the claim is false ; so in each block @xmath488 of @xmath474 , there is a matching symbol in @xmath475 .",
    "therefore , @xmath419 is a subsequence of @xmath475 and @xmath490 .",
    "this , together with @xmath483 $ ] and @xmath491 , implies that @xmath486 and @xmath492 $ ] , which contradicts the assumption that when @xmath486 , there is some @xmath135 for which @xmath487 .",
    "[ thm - paths ] let @xmath58 and @xmath60 be any two pedigrees with @xmath493 arcs .",
    "let @xmath494 be any sequence of undirected @xmath27-forests in which consecutive @xmath27-forests are non - isomorphic .",
    "then for all @xmath281 , there exists @xmath495 such that for all @xmath496 , the following statement is true : if @xmath497 , then @xmath498 .",
    "let @xmath499 , where @xmath500 and @xmath336 are as defined in equations  ( [ eq - eps0 ] ) and  ( [ eq - mcai ] ) , respectively",
    ". we will choose @xmath501 ( defined at the end of section  [ sec - consistency ] ) and @xmath79 ( that depends on @xmath501 ) suitably later .",
    "the probability of @xmath424 on @xmath58 and @xmath60 is written by summing ( [ eq - pa ] ) over all @xmath465 . but based on theorem  [ thm - identifiability ] , corollary  [ cor - consistency ] and lemma  [ lem - eps - l2 ] , we can make the following qualitative and somewhat informal statement : if @xmath79 is large enough , then @xmath502 will get significantly higher contribution from spanning forest sequences @xmath503 of length @xmath504 such that @xmath505 for all @xmath506 $ ] and @xmath507 are all close to @xmath79 , than from spanning forest sequences @xmath508 for which there are many mismatches ( in terms of isomorphism ) between sequences @xmath509 and @xmath510 or if they require more than @xmath511 recombinations",
    ".    let @xmath512 , where @xmath513 is the joint probability of @xmath424 and the event that there are exactly @xmath10 recombinations .",
    "furthermore , we write @xmath514 , where @xmath515 is the contribution from spanning forest sequences @xmath516 of length @xmath517 such that @xmath505 for all @xmath506 $ ] , and @xmath518 is the remaining contribution to @xmath519 , i.e. , from spanning forest sequences @xmath520 of length @xmath517 such that either @xmath521 ( i.e. , the @xmath511 recombinations occur at fewer than @xmath511 sites ) , or @xmath522 and @xmath523 for some @xmath506 $ ] .    we will show that only @xmath515 makes a significant contribution to @xmath524 .",
    "in particular , we will show that the various contributions to @xmath525 take the following form :    @xmath526       \\sum_{k <",
    "m-1}p_k(p ) + p_{(m-1)b}(p ) & < & \\delta_1 \\\\[1 mm ]      \\sum_{k \\geq m } p_k(p ) & < & \\delta_2 ,    \\end{aligned}\\ ] ]    where @xmath527 does not depend on the pedigree ( but depends on the undirected @xmath27-forest sequence @xmath474 ) .",
    "moreover , @xmath527 , @xmath528 and @xmath529 depend on @xmath530 and @xmath501 .",
    "we will show that when @xmath145 and @xmath501 are sufficiently small and @xmath79 is sufficiently large , @xmath528 and @xmath529 are very small compared to @xmath527 .",
    "it will imply that for @xmath502 and @xmath531 to be equal , @xmath532 and @xmath533 must be equal .",
    "( otherwise , there would be a difference between @xmath502 and @xmath531 that is of the order of a multiple of @xmath527 . )    _ a lower bound on @xmath515 . _",
    "since the consecutive @xmath27-forests in @xmath474 are nonisomorphic and @xmath505 for all @xmath506 $ ] , there is at least one recombination between consecutive spanning forests @xmath133 . and",
    "since there are exactly @xmath511 recombinations , there must be exactly one recombination between consecutive spanning forests .",
    "therefore , @xmath534      & & \\times \\left ( \\sum_{a \\in { \\mathcal{a } } } \\sum_{\\substack{\\mathbf{l }             \\in { \\mathbb{z}}_+^m : \\\\            \\sum\\limits_{i=1}^ml_i = m^2l}}\\ ;        \\prod_{i=1}^m{\\mathtt{pr}}\\{a[l_{i-1}+1,l_i ] { \\mid}t_u(g_i),m(\\mu )",
    "\\}\\right ) \\nonumber \\\\      & : = & n(\\mathbf{g } \\geq",
    "\\mathbf{t}:p ) \\delta(\\mathbf{t } ) ,    \\end{aligned}\\ ] ] where @xmath449 , @xmath450 .",
    "the inner summation is evaluated for any fixed choice of @xmath535 such that @xmath505 for all @xmath506 $ ] , because for any fixed @xmath536 $ ] , and spanning forest sequences @xmath537 and @xmath538 , if @xmath539 for all @xmath506 $ ] , then for each alignment @xmath91 , we have @xmath540 { \\mid}g_i^{l_i},m(\\mu )    \\ } = { \\mathtt{pr}}\\{a[l_{i-1}+1,l_i ] { \\mid}(g_i^{\\prime})^{l_i},m(\\mu ) \\ } =    { \\mathtt{pr}}\\{a[l_{i-1}+1,l_i ] { \\mid}t_u(g_i),m(\\mu ) \\}$ ] . therefore , the rhs is a product of @xmath532 and a factor that does not explicitly depend on the pedigree , but only on @xmath474 .",
    "we have @xmath541 to prove the lower bound , we sum ( [ eq - pa ] ) over spanning forest sequences of the type @xmath503 where @xmath505 for all @xmath506 $ ] and @xmath507 are such that the @xmath511 recombinations occur at sites @xmath542 , for a small positive constant @xmath353 , ( i.e. , we ignore contributions from the spanning forest sequences in which some of the recombinations are not near the boundaries of the blocks @xmath543 of @xmath424 )",
    ". we can choose the recombination sites in @xmath544 ways . since @xmath545 and @xmath546 , the probability of @xmath136 is @xmath547 .",
    "we write @xmath548 , where @xmath549 are blocks of @xmath136 of length @xmath425 each",
    ". then we have @xmath550 for each @xmath136 and for all @xmath135 , provided we choose @xmath551 and @xmath501 appropriately according to lemma  [ lem - eps - l2 ] .    _",
    "an upper bound on @xmath552 .",
    "_    we have @xmath553      & \\leq & \\sum_{k=0}^{m-1 } \\frac{1}{2^e }      \\left(\\sum_{l=0}^{k}n_{kl}\\binom{m^2 l -1}{l }        ( \\epsilon_{max})^{m - l}\\right ) p^k(1-p)^{e(m^2l-1)-k } \\nonumber \\\\[2 mm ]      & \\leq & c_2 l^{m-1 } \\epsilon_{max } : = \\delta_1 ,    \\end{aligned}\\ ] ] where @xmath554 is the number of spanning forest sequences @xmath555 in which @xmath10 recombinations occur at @xmath476 sites , and @xmath556 is a constant that depends on @xmath4 and @xmath269 .",
    "we explain below how the bound is obtained .",
    "we fix @xmath557 such that @xmath558 . for @xmath559 , since we are only interested in the contribution @xmath560 , we fix @xmath136 with the additional restrictions in the definition of @xmath560 .",
    "suppose that the @xmath10 recombinations occur at @xmath476 distinct sites @xmath561 , where @xmath562 .",
    "so we write @xmath563 .",
    "there are @xmath554 choices for @xmath564 . for each choice of @xmath565 , there are @xmath566 choices for the recombining sites @xmath567 .",
    "each @xmath136 has a probability @xmath568 , where @xmath569 and @xmath570 .",
    "we show that @xmath571 is bounded above by @xmath572 for each @xmath136 with @xmath476 recombining sites that satisfies the above constraints .",
    "let @xmath573 be a spanning forest sequence of length @xmath504 . for @xmath506 , j \\in [ m]$ ]",
    ", we refer to the subsequences @xmath574)$ ] as _ blocks _ of @xmath136 , and subsequences @xmath575)$ ] as _ subblocks _ of @xmath136 .",
    "we say that subblock @xmath576 is _ recombination - free _ if there are no recombinations between any two sites of the subblock .",
    "( the subblock may have recombinations at its boundaries . )    by lemma  [ lem - seq ] , there is at least one block , say the @xmath135-th block , over which the sequences @xmath474 and @xmath577 mismatch everywhere .",
    "since there are @xmath269 subblocks in each block and @xmath578 , there are at least @xmath579 recombination - free subblocks in the @xmath135-th block of @xmath136 .",
    "let these subblocks be denoted by @xmath580 .",
    "we have @xmath581 for each of them .",
    "therefore , @xmath582    _ an upper bound on @xmath583 .",
    "_    we use the following fact about binomially distributed random variables : if @xmath584 , then @xmath585 .",
    "( this result is a consequence of the union bound . )",
    "since there are @xmath586 points at which a recombination can possibly occur , we have @xmath587 where @xmath588 is a constant that depends on @xmath4 and @xmath269 .",
    "we write similar bounds for @xmath60 .",
    "now suppose that @xmath589 but @xmath590 .",
    "therefore , equations  [ eq - term1a ] and [ eq - term1b ] imply that @xmath591      & = & |n(\\mathbf{g } \\geq \\mathbf{t}:p ) - n(\\mathbf{g } \\geq      \\mathbf{t}:q)|\\delta(\\mathbf{t } ) \\nonumber \\\\[2 mm ]      & \\geq & \\frac{(2cl)^{m-1}(1-p)^{(em^2 l - m - e+1)}p^{(m-1 ) }        ( 1-\\epsilon_{max})^{(m^2)}}{2^{e}}.    \\end{aligned}\\ ] ] but that is impossible if we can choose @xmath501 , @xmath79 , and @xmath145 so that @xmath592 , or @xmath593 in other words , the discrepancy @xmath594 can not be compensated for by the remaining terms in @xmath595 and @xmath596 .",
    "such a choice is possible .",
    "for example , we first choose @xmath597 , let us say , @xmath598 , where @xmath599 .",
    "we then set @xmath600 and @xmath601 so that @xmath602    the choice of @xmath79 must guarantee phylogenetic consistency as in corollary  [ cor - consistency ] .",
    "moreover , we must set @xmath79 as small as possible so as to get a better bound on @xmath145 . by lemma  [ lem - eps - l2 ]",
    ", @xmath79 is required to grow only logarithmically in @xmath603 , so let @xmath604 for a suitable choice of @xmath605",
    ". now conditions ( [ eq - cond ] ) are satisfied for @xmath606 for @xmath607 .",
    "then ( [ eq - final ] ) is satisfied for sufficiently large @xmath608 .      in the following ,",
    "we illustrate theorem  [ thm - paths ] with a general result on counting @xmath27-forests and a couple of specific examples .",
    "if the conditions of theorem  [ thm - paths ] are satisfied , then @xmath58 and @xmath60 have the same number of undirected @xmath27-forests of each type .",
    "we apply theorem  [ thm - paths ] for @xmath609 .",
    "suppose that @xmath58 is a pedigree with @xmath204 arcs .",
    "let @xmath102 be an undirected @xmath27-forest .",
    "suppose that we want to count the number of copies @xmath610 of @xmath102 in p. let @xmath611 be the distinct copies of @xmath102 in @xmath58 . for each @xmath339 ,",
    "let @xmath612 be the undirected @xmath27-forests in @xmath58 that contain @xmath339 .",
    "( to be precise , we have subgraphs @xmath613 and @xmath614 in @xmath58 such that when the ( directed ) arcs of @xmath613 and @xmath614 are replaced by ( undirected ) edges , we get the undirected @xmath27-forests @xmath339 and @xmath615 .",
    "but we do not make this distinction in the following . )",
    "note that @xmath615 are all distinct @xmath27-forests .",
    "there are @xmath616 non - founder vertices in @xmath58 at which we can choose one of the two incoming arcs to construct a spanning forest @xmath29 that contains @xmath339 .",
    "therefore , for each @xmath339 there are @xmath617 spanning forests that contain @xmath339 .",
    "therefore ,    @xmath618    now by grouping terms on the rhs by isomorphism classes of @xmath615 , we obtain @xmath619 since @xmath620 for all undirected @xmath27-forests @xmath621 , we also have @xmath622 for all undirected @xmath27-forests @xmath102 .    the examples of non - reconstructible pedigrees given in @xcite can be distinguished from the probability distribution on the space of alignments under model rm .",
    "pedigrees in these examples do not have the same number of @xmath27-forests of each type .",
    "for example , one pedigree in each pair contains a common ancestor of all extant vertices while the other does not .",
    "this may also be observed in the examples in figure  [ fig - k3 ] .    but knowing the number of @xmath27-forests of each type is not always enough to distinguish pedigrees , as verified by pedigrees @xmath245 and @xmath243 shown in figure  [ fig - hap ] .",
    "they both have the same number of directed ( therefore , also undirected ) @xmath27-forests of each type : they have 4 directed @xmath27-forests in which 1 and 2 have a common ancestor .",
    "we denote their undirected @xmath27-forest by @xmath282 , which is a path of length 4 with end vertices 1 and 2 .",
    "there are 12 directed @xmath27-forests in which 1 and 2 do not have a common ancestor .",
    "we denote their undirected @xmath27-forest by @xmath283 , which consists of two isolated vertices 1 and 2 .",
    "moreover , @xmath623 and @xmath624 . also , for @xmath625 ( and for @xmath626 ) , we check by direct counting that @xmath627 . but @xmath245 and @xmath243 can nevertheless be distinguished as shown below .",
    "[ cor - pq ] pedigrees @xmath245 and @xmath243 in figure  [ fig - hap ] are distinguished from the probability distribution on the space of alignments under model rm provided the crossover probability is sufficiently small .",
    "let @xmath282 and @xmath283 be the @xmath27-forests as described above .",
    "we apply theorem  [ thm - paths ] for @xmath628 with @xmath629 .",
    "we can verify that @xmath630 and @xmath631 .",
    "therefore , @xmath245 and @xmath243 give different distributions on the space of alignments . in the following , we describe how @xmath632 and @xmath633 are counted .",
    "let @xmath634 denote the directed @xmath27-forests in @xmath245 and @xmath243 consisting of paths @xmath635 and @xmath636 .",
    "similarly , we write @xmath637 for other directed @xmath27-forests in @xmath245 and @xmath243 , rooted at @xmath8 , @xmath353 and @xmath114 , respectively .",
    "these are the 4 directed @xmath27-forests that have @xmath282 as their undirected @xmath27-forest .",
    "all other directed @xmath27-forests have @xmath283 as their undirected @xmath27-forest .    _ counting _ @xmath638 :",
    "since @xmath639 , we count 16 different contributions to @xmath638 depending on the choices for @xmath640 and @xmath641 in @xmath642 .",
    "please refer to figure  [ fig - p ] .     when @xmath643 and @xmath644 ( left ) , and when @xmath643 and @xmath645 ( right),width=445 ]    when @xmath643 and @xmath646 : this is possible only if @xmath647 .",
    "there are 4 choices of @xmath40 , and for each of them there are 4 choices for @xmath41 depending on which arc of @xmath634 is replaced to obtain @xmath41 .",
    "thus we have 16 sequences @xmath136 for which @xmath648 and @xmath646 .    when @xmath643 and @xmath644 : the dashed arcs @xmath649 and @xmath650 in figure  [ fig - p ] on the left must be obtained by replacing @xmath651 and @xmath652 , and there are two sequences @xmath136 that achieve this : either @xmath653 or @xmath654 .",
    "also , there are 4 possible ways to include arcs pointing to @xmath0 and @xmath655 in @xmath40",
    ". therefore , there are 8 sequences @xmath136 such that @xmath643 and @xmath644 .    when @xmath643 and @xmath645 : there are only 2 sequences @xmath136 for which this is possible , since the arcs @xmath656 and @xmath657 ( shown in bold in figure  [ fig - p ] on the right ) must already be in @xmath40 .",
    "when @xmath643 and @xmath658 : this case is similar to the case @xmath645 .",
    "thus there are 28 choices of @xmath136 such that @xmath643 , and similarly 28 choices each for @xmath659 , @xmath660 , and @xmath661 .",
    "therefore , there are 112 sequences @xmath136 such that @xmath662",
    ".    _ counting _ @xmath633 : again we count 16 different contributions to @xmath633 depending on the choices for @xmath640 and @xmath641 in @xmath663 .",
    "please refer to figure  [ fig - q ] .     when @xmath664 and @xmath644 ( left ) , and when @xmath643 and @xmath658 ( right),width=445 ]    when @xmath643 and @xmath646 : as in case of @xmath245 , we have 16 sequences @xmath136 for which @xmath643 and @xmath646 .",
    "when @xmath643 and @xmath644 : the dashed arcs @xmath650 and @xmath665 in figure  [ fig - q ] on the left must be obtained by replacing @xmath652 and @xmath666 , and arc @xmath667 must already be in @xmath40 .",
    "there are two sequences @xmath136 that achieve this : either @xmath653 or @xmath668 . also , there are 2 choices for arcs pointing to @xmath0 , therefore , there are 2 choices for @xmath40",
    ". therefore , there are 4 sequences @xmath136 such that @xmath643 and @xmath669 .    when @xmath643 and @xmath645 : this case is similar to the case in which @xmath644 , therefore , there are 4 sequences such that @xmath643 and @xmath645 .    when @xmath643 and @xmath658 : in this case , the arcs @xmath670 and @xmath671 must already be in @xmath40 .",
    "thus there are only two sequences @xmath136 that are counted depending on whether @xmath672 or @xmath668 .",
    "thus there are 26 choices of @xmath136 such that @xmath643 , and similarly 26 choices each for @xmath659 , @xmath660 , and @xmath661 .",
    "therefore , there are 104 sequences @xmath136 such that @xmath662 .",
    "thus we have verified that @xmath638 and @xmath633 are unequal for @xmath673 , implying that @xmath245 and @xmath243 are distinguished by the probability distribution they induce on the extant sequences under model rm .",
    "in this paper we have presented a rigorous mathematical framework for studying pedigree reconstruction problems under probabilistic models .",
    "we extended phylogenetic identifiability results to reconstruct pedigrees under an idealised model of recombination and mutation .",
    "the main result of this paper is the computation of a class of combinatorial invariants from the joint distribution of extant sequences . as a corollary",
    ", we were able to show that certain known examples of pedigrees that could not be distinguished from path lengths alone , could be distinguished by a more detailed analysis of subgraph sequences .",
    "here we identify a few open problems and directions for future investigation .",
    "_ identifiability of computationally tractable invariants : _ the invariants of a pedigree @xmath58 defined by @xmath434 may be quite difficult to apply in general . theorem  [ thm - paths ] may be difficult to use computationally for bigger pedigrees .",
    "even for other reconstruction problems in graph theory , computational verifications are difficult .",
    "for example , ulam s reconstruction conjecture has been computationally verified to be true only for graphs on at most 11 vertices @xcite . even on restricted classes of graphs ,",
    "computational reconstruction experiments are difficult to perform",
    ". it will be useful to derive from @xmath674 ( or independently ) other identifiable invariants that may be easier to use in computational experiments .",
    "theorem  [ thm - paths ] only states that if two pedigrees induce the same joint distribution on extant sequences under model rm , then they agree on the invariants @xmath675 .",
    "but it will be important to prove a converse or a result of the type : two pedigrees induce the same distribution on extant sequences under model rm if and only if they take the same value for a class of combinatorial invariants .",
    "such a result would reduce the identifiability problem to a purely combinatorial problem of proving or disproving that the class of invariants is complete .",
    "such a class of invariants may be @xmath676 or it may be somewhat stronger than @xmath677",
    ". it may be possible to compute , by the methods of theorem  [ thm - paths ] , other invariants , for example , spanning forest sequences in which consecutive spanning forests are not necessarily separated by just one recombination .",
    "_ improving the bound on @xmath145 : _ in the lower bound on @xmath527 in equation  ( [ eq - term1b ] ) , we have @xmath398 in the denominator , while @xmath678 is roughly @xmath679 , where @xmath4 is the number of arcs in a pedigree .",
    "therefore , it is possible to obtain better bounds on @xmath145 for the applicability of the main theorem for pedigrees with fewer arcs .",
    "therefore , we would significantly improve the upper bound on @xmath145 if we showed that a pedigree can be reconstructed from the collection of its subpedigrees ( pedigrees of subsets of the extant population ) of order @xmath10 for some small @xmath10 .",
    "in @xcite we made a conjecture about how small @xmath10 may be for pedigrees of order @xmath680 in which the population remains constant over generations . thus solving the purely combinatorial problem of reconstructing pedigrees from their subpedigrees , while important in its own right , will be useful for improving bounds on @xmath145 in theorem  [ thm - paths ] .",
    "on the other hand it is also likely ( although we do not conjecture ) that theorem  [ thm - paths ] is valid without restrictions on @xmath145 , or for all but finitely many values of @xmath145 , or for all @xmath145 except when @xmath223 takes small values .",
    "but we do not have good intuition as to why proposition  [ prop - n2 - 2 ] ( with @xmath266 ) requires a more complicated argument and an upper bound on @xmath145 .",
    "_ maximum likelihood computation of the invariants @xmath681 _ : it will be of interest to derive statistical consistency results and bounds on sequence lengths , analogous to corollary  [ cor - consistency ] and lemma  [ lem - eps - l1 ] , for computing the invariants @xmath675 .",
    "for example , we would like to make the following qualitative statement precise .",
    "suppose @xmath58 is a pedigree with @xmath4 arcs .",
    "let @xmath607 be given .",
    "suppose @xmath474 is an undirected @xmath27-forest sequence of length @xmath269 with no two consecutive @xmath27-forests isomorphic . then there is a sufficiently large @xmath682 such that if a collection of sequences of length @xmath683 evolved on @xmath58 giving an alignment @xmath91 , then the likelihood ratio @xmath684 is large for all pedigrees @xmath60 such that @xmath685 .",
    "we expect that @xmath682 would be of the order of @xmath686 .",
    "i would like to thank jotun hein and mike steel for many valuable comments and for pointing me to many useful references relevant to this work .",
    "in particular , mike s comments on and references to the literature on phylogenetic identifiability results and results on the consistency of ml were very useful .",
    "this project was funded by the grant `` from complete genomes to global pedigrees '' from epsrc ( engineering and physical sciences research council ) , u.k .",
    "i would like to thank jotun hein and epsrc for supporting my postdoctoral stay at the university of oxford under this grant .",
    "i am currently working on the project `` tree - graphs and incidence matrices : theory and applications '' funded by cnpq , brasil ( processo : 151782/2010 - 5 ) at the instituto de matemtica e estatstica , universidade de so paulo , where i completed a significant revision of this paper and improvements on the bounds in the main theorem .",
    "i would also like to thank yoshiharu kohayakawa with whom i had very useful conversations during the revision of this paper .",
    "guy bresler , elchanan mossel , and allan sly .",
    "reconstruction of markov random fields from samples : some observations and algorithms . in a.",
    "goel _ et al .",
    "_ , editor , _ 11th international workshop , approx 2008 , and 12th international workshop , random 2008 , lncs 5171 _ , pages 343356 , berlin heidelberg , 2008 .",
    "springer - verlag ."
  ],
  "abstract_text": [
    "<S> pedigrees are directed acyclic graphs that represent ancestral relationships between individuals in a population . based on a schematic recombination process , we describe two simple markov models for sequences evolving on pedigrees - model r ( recombinations without mutations ) and model rm ( recombinations with mutations ) . for these models , </S>",
    "<S> we ask an identifiability question : is it possible to construct a pedigree from the joint probability distribution of extant sequences ? </S>",
    "<S> we present partial identifiability results for general pedigrees : we show that when the crossover probabilities are sufficiently small , certain spanning subgraph sequences can be counted from the joint distribution of extant sequences . </S>",
    "<S> we demonstrate how pedigrees that earlier seemed difficult to distinguish are distinguished by counting their spanning subgraph sequences .    </S>",
    "<S> mathematics subject classifications : primary : 60 , 05 , secondary : 05c60,92d    keywords : reconstructing pedigrees , identifiability , recombinations , mutations </S>"
  ]
}