{
  "article_text": [
    "the field of ultracold atoms in optical lattices has been a promising new opportunity for studying many - body effects which are important for condensed - matter physics in controlled environments @xcite . in particular",
    ", fermionic atoms such as @xmath2k may provide a direct path towards a `` quantum simulation '' of the hubbard model which itself has a paradigmatic role in condensed matter physics and is a key in understanding phenomena such as high - temperature superconductivity and strongly correlated magnetism . in these experiments ,",
    "some novel possibilities to study physical correlations between constituents of the model are being explored .    in many cases ,",
    "such experiments@xcite drive the systems substantially beyond thermal equilibrium , so that they are inaccessible to methods of conventional equilibrium or linear - response theory . usually , one also encounters spatially inhomogeneous situations , since the atoms in the optical lattice are being held in a trap potential which co - exists with the lattice potential . in one - dimensional systems , many opportunities to provide computational benchmarks for such experiments exist , such as via the density - matrix renormalization group @xcite . however , it is a challenging problem to describe two- and three - dimensional systems out of thermal equilibrium , especially when they are also inhomogeneous .    in this paper",
    "we present a nonequilibrium strong - coupling approach to inhomogeneous systems of ultracold atoms in optical lattices .",
    "the paper is structured as follows .",
    "section [ sec : model ] discusses the hubbard model for an optical lattice in a trap . in section [ sec : formalism ] , we outline the strong - coupling approach which enables us to simulate inhomogeneous higher - dimensional hubbard systems out of equilibrium . in section [ sec : algo ] , we develop the massively parallel algorithm which is used to solve the resulting equations on a supercomputer .",
    "section [ sec : results ] presents results of the algorithm for the example of a modulated lattice depth and validates them by comparing to the previously introduced strong - coupling method for homogeneous systems@xcite within the local - density approximation ( lda ) .",
    "conclusions are given in section [ sec : conclusion ] .",
    "we consider a fermi hubbard model in the presence of a trap potential , i.e. @xmath3 with @xmath4 where the on - site single - particle energy levels @xmath5 are determined by the trap potential @xmath6 and a global chemical potential @xmath7 which characterizes the initial equilibrium state at time @xmath8 . the initial state is assumed to have a temperature @xmath9 .",
    "the time - dependent interaction @xmath10 and the time - dependent hopping @xmath11 are chosen to be results of a tight - binding calculation for maximally localized wannier functions computed from the translationally invariant case . in the future",
    ", we plan to include corrections to the tight - binding parameters which result from generalized wannier functions for the inhomogeneous problem .",
    "we assume the system to be in thermal equilibrium at time @xmath8 and to be driven out of equilibrium subsequently by the time - dependence of the model parameters .",
    "we employ a second - order self - consistent expression for the self - energy @xcite around the atomic limit which is described by @xmath12 .",
    "the self - consistency takes advantage of a resummation of diagrams which yields a better approximation .     for the simulation time .",
    "between the dashed blue lines , the system is driven out of equilibrium by a time - dependent hamiltonian . in the numerical part of the paper",
    ", we refer to the two points in time as @xmath8 and @xmath13 for simplicity .",
    "the real times between the matsubara branch and the point at which the system is driven out of equilibrium can be used to check for numerical convergence , since expectation values of observables have to be constant here .",
    "the time discretization is shown in red  in the implementation itself , the point @xmath8 is identical to the point to which the matsubara branch of the contour is attached .",
    "the total number of time slices is @xmath14 . ]",
    "it can be extended to an inhomogeneous system in the following way : @xmath15 here , @xmath16 is the contour - ordered on - site no - hopping green s function at site @xmath17 with spin @xmath18 ( in the paramagnetic phase , the green s function is independent of the spin @xmath18 ) .",
    "times @xmath19 and @xmath20 are located on the kadanoff - baym - keldysh contour @xmath21 depicted in fig .",
    "[ fig : keldysh ] .",
    "@xmath22 is the second - order cumulant for the on - site no - hopping two - particle propagator @xmath23 at site @xmath24 . in a typical numerical implementation",
    ", one can not store this tensor for a reasonable grid of time slices .",
    "however , it is easy to compute it on the fly in the particle - number basis @xmath25 by inserting the time evolutions @xmath26 for each possible @xmath27 time ordering of the creation and annihilation operators .",
    "note that it is crucial to the applicability of the approach that the expression in eq",
    ".   does not involve any time - ordered products , because @xmath28=0 $ ] for any combination of @xmath29 .",
    "the on - the - fly evaluation of the action of the operators in the basis can be realized by a fast multiplication with and division by tabulated @xmath30 values .",
    "for example , when @xmath31 , @xmath32 with @xmath33 in the calculation , one requires the expressions for all possible time orderings . the relation in eq .",
    "is solved iteratively . at a given step of this procedure ,",
    "the self - energy at site @xmath34 is given by @xmath35 where @xmath36 the local green s function at site @xmath37 , @xmath38 is given by the @xmath37-th block - diagonal element of the lattice green s function @xmath39^{-1}(\\vec r_i , t;\\vec r_{i'},t ' ) , \\end{split } \\label{eq : glatt}\\ ] ] i.e.   @xmath40 here , the hatted quantities @xmath41 , @xmath42 , and @xmath43 denote the non - interacting green s function , the hopping , and the self - energy as operators acting on both , time and space coordinates .",
    "we comment now on the measurement of some important physical observables within our method .",
    "spin-@xmath18 occupancy _ of site @xmath34 may be evaluated by @xmath44 from the local green s function .",
    "the _ kinetic energy contribution of spin @xmath18 at lattice site @xmath34 _ can be deduced from the lattice green s function @xmath45 it is thus required to measure the equal - time hopping green s functions from site @xmath34 to its nearest neighbors @xmath46 .",
    "a quantity of particular interest is the _",
    "double occupancy @xmath47 _ as a function of time @xmath19 and lattice site @xmath34",
    ". we can derive it from some elements of the lattice green s function and its equal - time derivative , using the following relation ( see appendix [ app : doccformula ] ) : @xmath48",
    "in this section , we outline the massively parallel algorithm required to solve eqs .  , , and iteratively on a supercomputer .     and",
    "@xmath49 are introduced in sec .",
    "[ sec : algo ] and correspond to evaluating eqs .   and",
    "( both @xmath50 ) , and eq .   ( @xmath49 ) . ]",
    "in order to represent the contour - ordered green s function on a computer , the kadanoff - baym - keldysh contour is discretized to @xmath51 time slices , as shown in fig .  [",
    "fig : keldysh ] . in the implementation used here , we chose @xmath14 , where @xmath52 . here , @xmath53 is the number of time steps on each real branch of the kadanoff - baym - keldysh contour and @xmath54 the number of time steps on the imaginary time axis .",
    "furthermore , the system consists of a finite number @xmath55 of lattice sites . assuming that spatial symmetries such as reflection and rotation symmetries are given for not only the hamiltonian but also the quantum - statistical states",
    ", we can reduce the actual number of lattice sites @xmath55 within the algorithm by symmetry maps to the number @xmath56 which is the number of sites in the irreducible wedge of the lattice .",
    "many sites can then be represented by the equivalence class with respect to the symmetry .",
    "note that the full number of lattice sites still plays a role in computational complexity when the propagation of excitations is considered .",
    "since dyson s equation performs an infinite resummation of such processes , it is relevant for the calculation of the green s function .",
    "appendix [ app : symmetries ] describes the exploitation of symmetries in more detail .",
    "computationally , the self - consistency condition in eq .",
    "is solved iteratively using an alternating sequence of self - energy and green s function evaluations .",
    "the self - energy evaluations are performed via eqs .   and and",
    "will be described in detail in sec .",
    "[ subsec : selfenergyeval ] .",
    "the green s functions required for self - consistency and measurements of observables are evaluated via eq .   which will be described in sec .",
    "[ subsec : greensfunctionevaluation ] .    due to the structure of eq .",
    ", the computation of @xmath57 at lattice site @xmath34 requires only the green s functions of neighboring lattice sites .",
    "however , the second step , i.e. the dyson s equation evaluation in eq .   of the lattice green",
    "s requires self - energy information from all lattice sites . from a computational perspective , these demands are quite different in terms of optimal memory arrangement and distribution of tasks over a large set of compute nodes . as a consequence ,",
    "we define two different configurations of the simulation .        the green s function evaluation in eq .",
    "is performed in what we call the @xmath49 configuration of the simulation .",
    "the self - energy computation is done in the @xmath50 configuration .",
    "[ fig : algorithm ] shows a schematic flowchart for the computation .",
    "the two different global machine states are sketched in fig .",
    "[ fig : processorgroups ] .",
    "all processors are thought to be arranged along the direction of the abscissa in fig .",
    "[ fig : processorgroups ] .",
    "each configuration defines groups of processors which share tasks , we call them self - energy units @xmath58 and green s function units @xmath59 . the self - energy unit @xmath58 evaluates self - energies for the @xmath34-th range of representative sites .",
    "the green s function units evaluate relevant information for the @xmath34-th range of symmetry - representative site indices for blocked rows of the lattice green s function .",
    "there is an optimal value for the size of the units which is usually different for @xmath58 and @xmath59 .",
    "the determining factors for the optimal size will be elaborated below .      by a given self - energy unit @xmath58 , the self - energy @xmath60 is computed for a certain range of ( representatives of ) sites",
    "@xmath61 for all @xmath29 using eqs .   and .",
    "the expressions involve an on - the - fly evaluation of the cumulant @xmath62 using the tabulated values of eq .  , as well as local green s functions which do not require any permanent storage on @xmath58 .",
    "memory - wise , the unit is required to have access to the local green s functions of neighboring sites , as well as to the value of the self - energy from the previous iteration .",
    "the latter is necessary , because in our implementation , eq .",
    "is regularized as follows : @xmath63 where @xmath64 is a linear mixing parameter which stabilizes the convergence by averaging between the current and the previous iteration .",
    "convergence is reached once @xmath65 where @xmath66 is the frobenius norm of the self - energy matrix with @xmath67 entries on the block diagonal , and @xmath68 is element - wise maximum norm of the matrix .",
    "a reasonable value for the accuracy of the self - consistency condition is @xmath69 where @xmath70 is some typical value of the interaction strength ( which often serves as the energy unit ) .",
    "convergence is usually reached after approximately ten iterations .    in all relevant cases",
    "we have encountered so far , the self - energy evaluation step is computationally more costly than the green s function evaluation , if the latter has been optimized appropriately .",
    "this is due to the fact , that the contraction of cumulant indices in eq .",
    "scales with the fourth power of @xmath51 .",
    "the evaluation of the cumulant contraction is however massively parallelizable , i.e. no significant communication even within the @xmath58 is required during the computation .",
    "thus , the size of the cumulant units can be chosen rather freely regarding the aspect of communication between cpus within the unit .",
    "a small size is preferable , due to the typically small memory consumption . for convenience ,",
    "when switching between configurations @xmath50 and @xmath49 , the self - energies just remain within the compute nodes of the respective processors of the self - energy units .",
    "however , it is better to ensure that each self - energy unit deals with more than one lattice site , because we encounter the situation that the time to evaluate the self - energy varies substantially from lattice site to lattice site .",
    "if the site indices are assigned randomly , this effect averages out for a sufficient number of sites . as a rule of thumb",
    ", it is reasonable to assign self - energies for sixteen random lattice sites to each @xmath58 .",
    "let us have a closer look at the dyson s equation in eq .  .",
    "it contains a block - diagonal part @xmath71 and a sparse off - diagonal part given by the hopping matrix @xmath42 .",
    "the latter is composed of a contour-@xmath72-function in time and a tight - binding structure in real space . in particular",
    ", @xmath42 is a small quantity , due to the very nature of the strong - coupling expansion .",
    "this fact is exploited algorithmically .",
    "it is insightful to change notation in eq .  .",
    "we can write the lattice green s function in a dirac type notation , as a matrix element @xmath73 where @xmath74 is an orthonormal basis associated with space and time variables .",
    "each @xmath59 computes @xmath75 at the sites @xmath76 assigned to it for all @xmath77 and stores the local and hopping green s functions as required .",
    "determining the lattice green s function corresponds to solving @xmath78 linear equations in @xmath78 variables .",
    "that is , the @xmath79 matrix elements of the green s function are determined by solving such linear equations @xmath80 times . typically , in our application",
    ", @xmath51 is at least 512 or 1024 and @xmath55 is around 10000 .",
    "note that since the simulation discretizes the points on the kadanoff - baym - keldysh contour with @xmath51 time slices , there is a finite size of time slices @xmath81 .",
    "the effect of a finite @xmath81 usually affects the accuracy of the calculations , and thus we perform a quadratic extrapolation of the simulation results from three finite values of @xmath81 to @xmath82 .",
    "cross - checks with linear extrapolations show the quadratic extrapolation is superior in most instances .",
    "the matrix to be inverted in eq .",
    ", @xmath83 , is typically around @xmath84 dimensional .",
    "its block structure can be written as @xmath85 where each block represents an @xmath86 matrix and @xmath87 as given in eq .  .",
    "each row and each column in eq .",
    "contains at most 4 hopping matrices @xmath88 to the nearest neighbors @xmath89 , @xmath90 ( in two dimensions ) .",
    "the hopping matrices @xmath88 are essentially diagonal matrices whose diagonal elements are the time - dependent hopping amplitudes . the matrix in eq .",
    "is extremely sparse , while its inverse @xmath91 is dense .",
    "however , due to the small numerical value of the hopping in the strong - coupling expansion , matrix elements of @xmath91 fall off as a function of spatial distance and eventually become irrelevant ; in other words , the lattice green s function is typically block diagonal dominant .",
    "this fact can be exploited in a numerically controlled way by utilizing an iterative procedure .",
    "we choose the generalized minimal residue ( gmres ) method as a solver @xcite .",
    "the gmres method considers an equation system @xmath92 as well as an `` almost '' correct solution @xmath93 where @xmath94 is the so - called _",
    "preconditioner_. @xmath94 is an arbitrary operator whose action on @xmath95 is cheap to compute but is a good approximation to @xmath96 . in our case ,",
    "due to the small numerical value of the hopping , a natural choice for the preconditioner is the inverse block diagonal matrix @xmath97 where @xmath98 as defined earlier in eqs .   and .",
    "further details of the gmres method as applied to the dyson s equation in the inhomogeneous strong - coupling expansion are discussed in appendix [ app : gmres ] .",
    "we distribute the task of applying gmres to each unit vector @xmath99 of the vector space @xmath100 within the set of green s function units @xmath101 .",
    "each green s function unit must store all blocks of the block diagonal @xmath102 .",
    "memory allocated to each cpu within a unit thus defines a lower bound to the size of a green s function unit through this requirement in the following way : @xmath103 assuming a double precision representation of complex numbers . if one also decides to store the preconditioner , this value doubles .     of the block - diagonal matrix @xmath102 within each unit @xmath59 ( darkly shaded area ) .",
    "if symmetries apply , only the blocks associated with representatives of lattice sites need to be stored , and @xmath55 is then taken as @xmath56 . ]",
    "we store the blocks of @xmath102 as depicted in fig .",
    "[ fig : storageb ] .",
    "practically , within each @xmath59 , an efficient application of @xmath102 and @xmath104 to a given vector @xmath105 has to be achieved .",
    "the performance of these operations crucially relies on the small size of @xmath59 and on a good load - balancing within @xmath59 .",
    "the former is due to an increased number of communication events through relatively slow connections between cpus and also due to its role in the latter . in order to avoid an unnecessarily large number of cpus in @xmath59 , a minimization of memory consumption",
    "plays a key role .",
    "we construct the representation of @xmath102 within a green s function unit by distributing respective self - energies to the cpus dealing with specific parts of @xmath102 .",
    "a practical example is shown in table [ tab : para ] .",
    ".table of typical parallelization parameters on a cray xe6 ( 2 gb memory per cpu ) for the application presented in sec .",
    "[ subsec : numresults ] .",
    "the number @xmath106 denotes the block size in the parallel gmres implementation . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     a further important optimization when applying gmres takes advantage of both cache optimizations in basic linear algebra subprograms ( blas)@xcite level 3 routines and a reduction of network latency effects  rather than letting @xmath59 apply gmres individually to each unit vector @xmath99 of its concern serially , we choose a parallel implementation .",
    "it applies the algorithm to blocks rather than vectors .",
    "thus , highly optimized blas level 3 rather than multiple calls of blas level 2 are used .",
    "in addition , less communication processes between cpus occur .",
    "more specifically , we can write this blockwise procedure as solving the blocked equation system @xmath107 where @xmath108 with appropriately defined unit vectors @xmath99 which belong to a single lattice site in the notation introduced above with eq .",
    ". the blocks @xmath109 are the respective blocks of @xmath110 .",
    "typical block sizes are listed in table [ tab : para ] .    in the gmres procedure , this definition of blocked equations which are solved one after another has the following advantage .",
    "the method operates iteratively , where the start value is the preconditioner solution , which is still localized at some lattice site : @xmath111 ( or @xmath112 ) .",
    "the computation of @xmath104 is done with lapack calls@xcite for the diagonal blocks by the cpus assigned to them according to fig .",
    "[ fig : storageb ] . by means of the spatial structure of this",
    "then iteratively refined approximation to the solution , only the application of @xmath113 introduces further lattice sites to the problem . as a consequence ,",
    "if gmres converges quickly for a given numerical accuracy of the gmres method , non - zero elements only occur within the spatial vicinity associated to the considered @xmath114 block in the blocked representation of the converging gmres solution @xmath115 ( see app .",
    "[ app : gmres ] for details ) .",
    "indeed , the gmres procedure converges very rapidly , because the hopping @xmath42 between adjacent lattice sites is required to be small in the strong - coupling expansion .    for the block representations @xmath116 of iteratively refined gmres solutions , we thus choose to only store non - zero subblocks and distribute them within the @xmath59 units using the storage scheme for @xmath102 ( see above and fig .",
    "[ fig : storageb ] ) . in the case",
    "that @xmath116 contains non - zero contributions for reducible lattice sites ( this happens when @xmath114 is located near the boundary of the range of site representatives , see appendix [ app : symmetries ] ) , the respective block is handled by the cpu associated to its equivalence class .",
    "this minimizes both communication and memory consumption .",
    "the former is because applying the preconditioner is only a local operation and applying @xmath117 requires only communications with units storing neighbors of the respective lattice sites .",
    "the size of the blocks in @xmath116 is to be chosen as large as possible .",
    "however , memory in @xmath59 is usually very limited , so a tradeoff in unit size and block length has to be made .",
    "let us also comment on reasonable values for the gmres convergence parameter .",
    "the gmres method for our matrix inversion runs until a certain accuracy for the result is achieved , i.e. @xmath118 where @xmath119 is the desired numerical precision and @xmath66 is the euclidian norm . for all practical purposes we encountered so far ,",
    "a value @xmath120 has been sufficient .",
    "this surprisingly large value was verified by comparing to simulations with higher accuracy , that is @xmath121 , for the physical systems studied in this paper at several parameter values .",
    "the plots of numerical results of interest are identical to the eye .",
    "similar tests were done for completely homogeneous systems by comparing to a numerically exact implementation in momentum space .",
    "it may be that for different applications than the one presented here a smaller value of @xmath119 is required . in order to understand the meaning of @xmath119 better it may be useful to compare it to the dimension of the vector it constrains . in our case ,",
    "the dimension of @xmath122 is @xmath123 .",
    "thus , if one chooses to normalize the convergence criterion in eqs .",
    "and by the dimension , the constraint reads @xmath124 . in this context",
    "it may also be worthwhile to consider the fact that the gmres procedure only involves transformations with @xmath104 , @xmath102 , and @xmath42 .",
    "that is , it applies only transformations which comply with the causal structure of the green s function and do not introduce artificial discontinuities with respect to the time variables in the end result for the green s function which are in principle part of the vector space which is being searched by the algorithm .",
    "in other words , the physical choice of the preconditioner already constrains the solution space so drastically that even a relatively large value of @xmath119 might be sufficient .    with all these optimizations , the green s function evaluation typically consumes no more than five to ten percent of the time required for the self - energy evaluation on a cray xe6 machine in the application to lattice depth modulation spectroscopy described below .",
    "the optimizations are necessary to speed up the green s function evaluation appropriately , because we encountered increases in speed by a factor of at least 10 and up to 1000 , for each blockwise application of gmres , distributed storage of the gmres vector blocks , and random assignment of site indices . in other applications than lattice depth modulation , with a large value of the hopping applied for a longer period of time , the requirement of computer time for the green s function evaluation may still exceed the time to evaluate the self - energy . however , we find these requirements to be within reasonable bounds .",
    "the only time when global communication and synchronization across all processors is required is when either the self - energy or the green s function evaluations are finished .",
    "then , convergence has to be checked , and the global configurations @xmath50 and @xmath49 have to be replaced by each other .",
    "this requires point - to - point communications of individual processors across the machine and broadcasts within smaller groups of processors which all require the same data .",
    "+    the occuring communication events are displayed in fig .",
    "[ fig : globalconfigswitches ] . during the switch @xmath125 ( fig .",
    "[ subfig : cgtocs ] ) , the green s function contents on the nearest neighbors of the sites assigned to a given @xmath58 have to be sent from the green s function unit which computed them . due to",
    "the possibly random assignment of site indices @xmath24 to spatial coordinates @xmath126 , the input to @xmath58 is collected from various @xmath127 .",
    "the storage scheme used for the results within @xmath127 determines the actual processors which send the data .    when switching from @xmath50 to @xmath49 , spatial ranges tasked to specific parts of each green s function unit have to be sent from the self - energy units which contain this information ( fig .",
    "[ subfig : cstocg ] ) .",
    "the storage pattern for @xmath59 is already the one specified for the block diagonal matrix denominator of the dyson s equation ( fig .",
    "[ fig : storageb ] ) .",
    "to finish the change of configurations , an in - place substitution of the self - energies by the respective blocks @xmath128 is performed by computing the respective atomic green s functions and inserting @xmath129 , as defined in eq .  .",
    "the process @xmath130 is typically more time - consuming than @xmath125 .",
    "however , it can be optimized by using broadcasts between groups of processors with the same data requirements : each @xmath46-th cpu in @xmath59 requires the same data set to operate .",
    "the switching processes cost no more than five percent of the total computation time and are thus negligible .",
    "however , the implementation involves a considerable amount of book - keeping .",
    "let us summarize the algorithm and also provide some implementation details on the way . as the method implements the self - consistent solution of eq .",
    ", the algorithm is split in two steps : the self - energy evaluation ( eqs .   and ) and the green s function evaluation ( eq .  ) . since the computation of the self - energy and the evaluation of the green s function",
    "have different requirements in terms of computational resources on the supercomputer , they use different data structures and collaboration patterns amongst the cpus .",
    "we refer to the data structures of the algorithm in the self - energy evaluation state as the configuration @xmath50 and to the data structures of the algorithm in the green s function evaluation state as the configuration @xmath49 .",
    "the respective configurations are subdivided into mutually independent units @xmath58 and @xmath59 spanning several cpus and the memory associated with them , respectively .",
    "this approach is tailored to a cluster , rather than a shared - memory architecture .",
    "if one chooses to employ the message passing interface ( mpi ) standard in order to implement the algorithm , it is advantageous to use the ` mpi_group ` feature to ensure an efficient communication within the units @xcite .",
    "it turns out to be useful to define internal communicators for the @xmath59 and @xmath58 , respectively , as well as for sets of processors with shared requirements , such as the @xmath61-th processor of each @xmath59 , since they all require the same self - energies . within these shared - interest communicators",
    ", data can be broadcasted efficiently .",
    "it may also be reasonable to use advanced mpi features to perform an optimization with respect to the network topology of the supercomputer , such that communication within the @xmath59 units is optimal and equally fast for all @xmath34 .",
    "in contrast , the communication within @xmath58 is not time - critical , because the main effort , computing the integrals in eq .  ,",
    "is done by each processor in @xmath58 independently .",
    "let us now comment on the implementation of eq .  .",
    "each @xmath58 computes @xmath131 for a certain range of sites . here , the main effort is the contraction of the time indices .",
    "the atomic - limit cumulant green s function @xmath132 is computed on the fly using tabulated values of the exponentials in eq .  .",
    "the computational effort of eq .",
    "scales with @xmath133 and is the computationally most costly operation .",
    "however , it may also be implemented on gpus , due to little memory and bandwidth requirements . after having evaluated eq .",
    ", the units @xmath58 compute the updated self - energy using eqs .   and . then , as described in section [ subsec : confswitch ] , the resulting local self - energies are sent to the @xmath59 units which may or may not overlap with the respective @xmath58 . within each @xmath59 ,",
    "the self - energy for all sites has to be available and is thus equally distributed over the cpus according to the storage pattern depicted in fig .",
    "[ fig : storageb ] .",
    "it is advised to keep the self - energy results in @xmath58 for the next update as described by eq .",
    ", even though the machine changes to configuration @xmath49 in the meantime .",
    "this is because the @xmath134 in eq .",
    "has to be available in the self - energy computation of the next iteration of the self - consistency loop . in order to minimize the memory consumption of the relevant range of @xmath134",
    ", it can be distributed equally within each @xmath58 .    in order to establish the configuration @xmath49 to compute eq .  , the self - energies in @xmath59 are then replaced by the blocks of the matrix @xmath102 according to eq .  .",
    "optionally , the elements of the preconditioner @xmath104 can also be computed and stored at this point in time , also using the previous storage pattern . however , this competes with the requirement to keep @xmath59 small , because the action of the preconditioner can also be computed on the fly from @xmath102 with a smaller memory requirement .",
    "having fully set up the @xmath49 configuration , eq .",
    "is written as the vectorized linear eq .   as described in section [ subsec : greensfunctionevaluation ] .",
    "the key variable is the bundle of gmres vectors @xmath116 whose initial value @xmath135 is the preconditioner @xmath136 applied to a bundle of unit vectors , as in eq .  .",
    "@xmath135 has only non - zero entries at a single site index .",
    "@xmath116 is also stored according to the scheme in fig .",
    "[ fig : storageb ] .",
    "a good optimization here is to store only nonzero components of @xmath116 emerging from @xmath135 due to the application of the hopping matrix . for this purpose ,",
    "each processor in @xmath59 can keep track of the sites with non - zero elements in @xmath116 based on the site index of @xmath135 and the number of hopping events applied to @xmath116 during the gmres procedure elaborated in app .",
    "[ app : gmres ] .",
    "once a hopping occurs due to the application of @xmath137 , a given processor may have contributions to be stored and/or added to a value assigned to another processor within the storage scheme ( compare to the block structure of @xmath138 in eq .  ) .",
    "such transmissions are the major communication events within @xmath59 .",
    "the required communication bandwidth within @xmath59 can only be minimized by assigning connected spatial domains with a minimal surface to single processors within @xmath59 . however , doing so is strongly disadvantageous in the case that the gmres is converging very rapidly , i.e.  if the hopping is small and @xmath139 is small . in this case , all but one of the cpus in @xmath59 will remain idle , because the non - zero elements in @xmath116 do not leave the cpu storing the non - zero elements of @xmath135 .",
    "thus , for a rapidly converging gmres , a random assignment of the site leading to largely scattered domains is more appropriate .",
    "once each @xmath59 has computed the green s functions on the spatial range assigned to it , the different spatial components of @xmath140 are distributed to the @xmath58 units which require them for evaluating the green s function sum in eq .   in order to start the next iteration .",
    "in this section , we present results of the algorithm for trapped atoms in a two - dimensional optical lattice which is subject to a periodic modulation of the lattice depth .",
    "we compare this method to a homogeneous version of the algorithm which was previously successfully applied to a lattice depth modulation experiment within the lda @xcite .",
    "the lda is generally expected to yield good results for systems without mass transport .",
    "this is a well - established observation in equilibrium @xcite .",
    "we show that also in a nonequilibrium scenario without mass transport , the high accuracy of the lda can be explicitly demonstrated . at the same time we validate our direct computational approach .      in lattice - depth",
    "modulation spectroscopy , the atoms are subject to a time - dependent optical lattice potential @xmath141 the trap potential does not depend on time and has the parabolic shape @xmath142 the lattice potential satisfies @xmath143 which contains the time - dependent lattice depth @xmath144 } ( t ) \\cdot \\delta v \\sin \\omega t.\\ ] ] we assume that the lattice is modulated over a finite time interval @xmath145 $ ] and that the system is in an initial thermal state at time @xmath8 .",
    "numerically , we start the simulation at an earlier point in time , in order to be able to check for convergence , as discussed in fig .  [",
    "fig : keldysh ] . the lattice constant @xmath146 is defined by the laser wavelength @xmath147 .",
    "the single - particle hamiltonian @xmath148 yields the recoil energy @xmath149 as a natural choice for an energy unit . in order to compute the coefficients of the many - body hamiltonian in eq .   from the single - particle hamiltonian",
    ", we insert the constant hoppings @xmath150 and interactions @xmath151 of a translationally invariant lattice .",
    "these can be computed easily with maximally localized wannier functions @xcite .    due to the time - dependence of the lattice depth @xmath152",
    ", we also obtain a time - dependent interaction @xmath153 and hopping @xmath154 .",
    "we write the initial values of the interaction and the hopping as @xmath70 and @xmath155 , respectively . in these units ,",
    "the trap potential can be written as @xmath156 hence , @xmath157 can be interpreted as the length scale on which the trap potential reaches the strength of the initial hopping amplitude .",
    "it is important to keep @xmath157 larger than a couple of lattice spacings , since otherwise the trap potential interferes drastically with the hopping between neighboring sites and the density changes too fast for the lda to be accurate .",
    "+   +   +    as a test system , we set the lattice depth to @xmath158 and modulate it with an amplitude @xmath159 at the resonant frequency @xmath160 . the interaction strength is chosen to be @xmath161 , and we assume an initial temperature @xmath162 .",
    "we choose to study two cycles of the modulation , that is @xmath163 .",
    "for the simulations , we use up to 1024 time slices and a lattice with up to 1024 symmetry - irreducible lattice sites , that is up to 7844 actual lattice sites . the computational effort for a system with 512 symmetry - irreducible sites and",
    "a maximum of 1024 time slices is approximately @xmath164 cpu - hours on a cray xe6 .",
    "for instance , this involves 32768 cpus for approximately 12 hours by the main simulation and some further cpu time for the cheaper simulations at larger @xmath81 which are required for the extrapolation @xmath165 .",
    "figure [ fig : trapresults ] shows simulation results for distribution of the double occupancy in a trapped system with @xmath166 and the global chemical potential @xmath167 . each subfigure displays the distribution at a different point in time . due to the lattice depth modulation , the hopping in units of the interaction @xmath168 drives the system .",
    "the increases in the double occupancy occur as @xmath168 is decreasing .    to provide a better picture of the time dependence , fig .",
    "[ fig : integrateddocc ] shows the fraction of atoms on doubly occupied sites , @xmath169 where @xmath170 as a function of time for several values of the trap curvature . in the cases @xmath166 and @xmath171 , the results lie on top of each other , whereas for @xmath172 a slight deviation occurs .",
    "this agrees with the results found in our previous publication ref .",
    "@xcite for homogeneous systems .          in order to perform the comparison to the lda",
    ", we solve numerous mutually independent homogeneous versions of the problem at several chemical potentials @xmath173 and compare to local observables obtained from the full trap simulation at a position @xmath76 .",
    "we consider a set of test systems with three different trap curvatures , that is different values of the characteristic length @xmath157 of the trap potential , namely @xmath174sites , @xmath175sites , and @xmath176sites . in the simulations ,",
    "the real part of the kadanoff - baym - keldysh contour extends over an interval @xmath177=[-2\\hbar / u_0 , 14 \\hbar / u_0]$ ] , whereas the modulation acts over the interval @xmath178 $ ] .",
    "figure [ fig : ldacompadocc ] shows a comparison of the double occupancy @xmath179 as a function of the initial chemical potential @xmath7 at times before ( @xmath180 ) and after ( @xmath181 ) it has been driven out of equilibrium by the lattice depth modulation . as we see for both , the equilibrium ( @xmath180 ) and nonequilibrium ( @xmath181 ) situations , the numerical results for the inhomogeneous system agree well with the lda , even for the rather steep trap potential with @xmath174sites .",
    "the slight deviation of the solution for @xmath182sites from the other nonequilibrium curves may still be due to numerical imperfections .",
    "the agreement with the lda indicates that the creation of doubly occupied sites in a mott insulator subject to a modulated lattice depth is caused by strongly local excitation processes .",
    "we presented a computational approach to an inhomogeneous mott - insulating system of ultracold atoms .",
    "a major challenge is to compute a large matrix inverse in the dyson equation .",
    "we show that a gmres - based inversion approach exploiting the small numerical value of the hopping as compared to the many - body interaction yields a feasible implementation on supercomputers .",
    "a comparison to the lda shows that both methods are well - suited for the problem of lattice - depth modulation spectroscopy .",
    "this hints towards mainly local processes being involved in the coherent excitations between lower and upper hubbard bands in this particular setting , as might have been anticipated . in the future",
    ", we will apply the inhomogeneous method to problems with mass transport where the lda is expected to fail .    at present , the computational complexity of the algorithm is proportional to @xmath133 .",
    "it may be worthwhile to investigate the possibility to extend the time range by truncating certain parts of the self - energy at a given threshold for @xmath183 .",
    "this measure could increase the applicability of the algorithm greatly but requires further efforts .",
    "this work was supported by a muri grant from the air force office of scientific research numbered fa9559 - 09 - 1 - 0617 .",
    "supercomputing resources came from a challenge grant of the dod at the engineering research and development center and the air force research and development center .",
    "the collaboration was supported by the indo - us science and technology forum under the joint center numbered jc-18 - 2009 ( ultracold atoms ) .",
    "jkf also acknowledges the mcdevitt bequest at georgetown .",
    "hrk acknowledges support of the department of science and technology in india .",
    "point - group symmetry imposed by the circular trap potential on the 2d lattice .",
    "the circles denote lattice sites .",
    "solid circles are representatives of an equivalence class of lattice sites with respect to the symmetry .",
    "the symmetry partners of the red / gray solid circle are displayed in red / gray . ]",
    "we illustrate the exploitation of symmetries for the example of spherical symmetry on a two - dimensional square lattice with an @xmath184-orbital basis . in this case , a @xmath185 point group symmetry @xcite is imposed on the lattice .",
    "[ fig : symmetry ] displays the lattice sites of a lattice . for the @xmath185 symmetry , all sites",
    "can be represented by the sites in the irreducible wedge @xmath186 .",
    "these representatives of the equivalence classes are denoted by solid black circles . if the green s function and self - energy transform as the identity representation of the point group , the computations only need to be performed for those representatives .",
    "the representative of a given site can be retrieved by reflections with respect to the coordinate axes and the diagonals which are shown as dashed lines in fig .",
    "[ fig : symmetry ] .",
    "we provide a brief derivation of eq .  .",
    "let us start by assuming an equidistant discretization @xmath187 ( @xmath188 ) of the forward part of the kadanoff - baym - keldysh contour .",
    "we obtain @xmath189 with @xmath190.\\ ] ] the operator @xmath191 simplifies as follows : @xmath192   + \\mathcal{o}(\\delta t^2 ) \\\\   = & -{\\ensuremath{\\mathrm{i}}}\\delta t \\cdot \\bigg ( \\sum_j j_{lj } c^\\dagger_{l\\sigma}c_{j\\sigma } - { \\varepsilon}_{l\\sigma}(t ) n_{l\\sigma } - \\\\     & \\qquad\\quad - u_l(t ) n_{l\\uparrow } n_{l\\downarrow}\\bigg ) + \\mathcal{o}(\\delta t^2 ) .",
    "\\end{split}\\ ] ] taking the limit @xmath82 results in eq .  .",
    "numerically , this limit must be performed via linear and/or quadratic extrapolation of multiple simulations for different @xmath81 values .",
    "the generalized minimal residue method was introduced by saad and schultz @xcite to solve a linear equation @xmath193 a good introduction to the method can be found in ref .",
    "@xcite , and a useful c++ implementation is provided by the nist iml++ template library @xcite . in order to solve the equation , gmres operates in @xmath194-dimensional krylov subspaces @xmath195 which are successively built up , starting with @xmath196 .",
    "@xmath197 is the residue of the initial guess @xmath198 for the solution .",
    "the gmres method forms a refined approximate solution @xmath199 defined by the minimization requirement @xmath200 where the expression `` @xmath201 '' demands @xmath202 to be minimal .",
    "the krylov space dimension @xmath194 is increased until the convergence criterion is reached or @xmath194 approaches the threshold @xmath203 at which the minimization is considered too expensive . if @xmath204 , gmres is restarted with a krylov space size @xmath196 , where the initial guess @xmath198 is taken to be @xmath205 from the previous gmres iteration before restarting . with a preconditioner @xmath94 ,",
    "one applies gmres to the system @xmath206 rather than eq .  .",
    "if @xmath207 this system is better conditioned than eq .  .",
    "in the case that @xmath117 is a sparse matrix with large entries on the diagonal and some randomly occuring off - diagonal entries , the diagonal matrix @xmath102 defined by the diagonal entries of @xmath117 yields a good preconditioner @xmath104 , because the condition number @xmath208 is not as close to @xmath209 as the regularized @xmath210 here , @xmath211 and @xmath212 represent the respective maximal and minimal singular values . also , the application of the diagonal matrix @xmath102 to a vector is a cheap operation .",
    "the same argument can be made in the case that @xmath117 has large entries on the block diagonal @xmath102 , as it is the case in the nonequilibrium inhomogeneous strong - coupling expansion , where @xmath213 .",
    "the block diagonal @xmath102 is defined in eq .  ,",
    "and the hopping matrix @xmath42 is a sparse matrix with small numerical values ( see also eq .  ) . due to the latter , in fact @xmath214 ,",
    "so the equation system is well - conditioned .      1 .   for the initial",
    "guess @xmath215 compute the preconditioned residue @xmath216 , as well as @xmath217 .",
    "initialize the hessenberg matrix @xmath218 2 .   for @xmath219 do * @xmath220 * for @xmath221 do * * * @xmath222 * * @xmath223",
    "* @xmath224 * if @xmath225 then proceed with step 3 to compute the result .",
    "* otherwise use step 3 to check for convergence , eq .  .",
    "continue if not converged .",
    "* @xmath226 3 .",
    "solve the @xmath194-dimensional linear minimization problem @xmath227 where @xmath228 is the upper left @xmath194-dimensional square of @xmath229 , to obtain the result @xmath230 .",
    "+ then set @xmath231 , with @xmath232 . +    practically , the gmres with preconditioner scans for solutions in the modified affine krylov spaces @xmath233 here , the basis vectors are @xmath234 in the case of the inhomogeneous nonequilibrium strong - coupling expansion , @xmath235 is a unit vector localized at a given lattice site .",
    "the @xmath61-th basis vector @xmath236 of the krylov space @xmath237 corresponds to @xmath61 hopping processes , because @xmath238 , and in @xmath236 , @xmath117 is applied @xmath61 times to @xmath235 .",
    "that is , the gmres method includes exactly @xmath194 iterated hopping processes in iteration @xmath194 until convergence is reached .",
    "if gmres is restarted , the @xmath194th iteration includes @xmath239 iterated hopping processes , where @xmath24 is the number of restarts .",
    "this is crucial for the computational optimizations used in the implementation .",
    "the procedure can be seen as a numerically controlled analogue to a partial summation of the dyson series @xmath240    99 i. bloch , j. dalibard , and w. zwerger , rev .",
    "phys . * 80 * , 885 ( 2008 ) t. esslinger , ann .",
    "rev . condens . mat .",
    "* 1 * , 129 ( 2010 ) th .",
    "stferle , h. moritz , c. schori , m. khl , and t. esslinger , phys .",
    "* 92 * , 130403 ( 2004 ) r. jrdens , n. strohmaier , k. gnter , h. moritz , and t. esslinger , nature * 455 * , 204 ( 2008 ) d. greif , l. tarruell , th .",
    "uehlinger , r. jrdens , and t. esslinger , phys .",
    "lett . * 106 * , 145302 ( 2011 ) s.r .",
    "clark and d. jaksch , phys .",
    "a * 70 * , 043612 ( 2004 ) c.  kollath , u.  schollwck , w.  zwerger , phys .",
    "* 95 * , 176401 ( 2005 ) c.  kollath , a.  iucci , t.  giamarchi , w.  hofstetter , and u.  schollwck , phys .",
    "lett . * 97 * , 050402 ( 2006 ) ; c. kollath , a. iucci , i.p .",
    "mcculloch , and t. giamarchi , phys .",
    "a * 74 * , 041604(r ) ( 2006 ) k.  winkler , g.  thalhammer , f.  lang , r.  grimm , j.  hecker denschlag , a.  j.  daley , a.  kantian , h.  p.bchler , p.  zoller , nature * 441 * , 853 ( 2006 ) a. j. daley , p. zoller , and b. trauzettel , phys .",
    "lett . * 100 * , 110404 ( 2008 ) a. j. daley , j. m. taylor , s. diehl , m. baranov , and p. zoller , phys .",
    "lett . * 102 * , 040402 ( 2009 ) k. mikelsons , j. freericks , and h. r. krishnamurthy , phys .",
    "* 109 * , 260402 ( 2012 ) a. dirks , k. mikelsons , h. r. krishnamurthy , and j. freericks , arxiv:1304.7802 w.  kohn , phys",
    ". rev . * 115 * , 809 ( 1959 ) y. saad and m.h .",
    "schultz , siam j. sci .",
    ". comput . * 7 * , 856 ( 1986 ) e. anderson , z. bai , c. bischof , s. blackford , j. demmel , j. dongarra , j. du croz , a. greenbaum , s. hammarling , a. mckenney , and d. sorensen , _ lapack users guide _ ( society for industrial and applied mathematics , philadelphia 1999 ) e.  assmann , s.  chiesa , g.  g.  batrouni , h.  g.  evertz , and r.  t.  scalettar , phys . rev .",
    "b * 85 * , 014509 ( 2012 ) w. gropp , e. lusk , and a. skjellum , _ using mpi",
    "_ , mpi press , 1999 , isbn 9780262571326 f.a .",
    "cotton , _ chemical applications of group theory _ , wiley and sons ltd . , 1990 ,",
    "isbn 997151267x https://lp.uni-goettingen.de/get/text/2024 and https://lp.uni-goettingen.de/get/text/2025 ( in german , opened on sept .  10 , 2013 )",
    "( sept .  10 , 2013 )"
  ],
  "abstract_text": [
    "<S> we present a nonequilibrium strong - coupling approach to inhomogeneous systems of ultracold atoms in optical lattices . </S>",
    "<S> we demonstrate its application to the mott - insulating phase of a two - dimensional fermi - hubbard model in the presence of a trap potential . </S>",
    "<S> since the theory is formulated self - consistently , the numerical implementation relies on a massively parallel evaluation of the self - energy and the green s function at each lattice site , employing thousands of cpus . while the computation of the self - energy is straightforward to parallelize , the evaluation of the green s function requires the inversion of a large sparse @xmath0 matrix , with @xmath1 . as a crucial ingredient , </S>",
    "<S> our solution heavily relies on the smallness of the hopping as compared to the interaction strength and yields a widely scalable realization of a rapidly converging iterative algorithm which evaluates all elements of the green s function . </S>",
    "<S> results are validated by comparing with the homogeneous case via the local - density approximation . </S>",
    "<S> these calculations also show that the local - density approximation is valid in non - equilibrium setups without mass transport . </S>"
  ]
}