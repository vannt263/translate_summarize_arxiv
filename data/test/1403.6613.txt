{
  "article_text": [
    "extreme ultraviolet ( euv ) observations currently provide the most important source of information on the low solar corona . as new euv instruments",
    "are developed , the temporal , spatial and spectral resolution becomes ever finer , giving new insight on the coronal and chromospheric structure and dynamics .",
    "the _ atmospheric imaging assembly _ ( aia : ) aboard the _ solar dynamics observatory _ ( sdo : ) provides very fine temporal and spatial resolution of the sun at multiple wavelengths , and is having a large impact on the field .",
    "even as the community develop methods to digest the huge volume of data from aia / sdo , new instruments are planned and tested with even finer resolution ( e.g. _ high - resolution coronal imager _ ( hi - c ) , see ) .    despite the development of automated detection tools for euv observations ( e.g. ) , most scientific works begin from visual inspection of images . in particular , the volume of data provided by aia / sdo is so high that low - resolution images are often used as a starting point to find features of interest .",
    "the higher - resolution data are then used for further analysis .",
    "image processing is therefore an important step in analysing the data .",
    "the scientific return can be improved by the application of processing which better reveals features in the data , particularly in the early stages of analysis where visual inspection is most important .",
    "a common approach to process euv images is simply to display the square root ( or a gamma curve transformation ) , or alternatively the logarithm , of the original pixel values .",
    "this is a quick and easy way of reducing the dominance of the image contrast range by a few small bright regions . to reveal dynamic features ,",
    "time - differencing is used , where a previous image is subtracted from the current image .",
    "such simple processes are commonly used not due to the quality of the output , but due to their simplicity .",
    "more advanced image processing methods are not so commonly used due to their complexity and computational expense .",
    "wavelet - based techniques have been used by and to greatly improve the visual information available from the _ extreme ultraviolet imaging telescope _ ( eit : ) aboard the _ solar and heliospheric observatory _ ( soho ) and the _ extreme ultraviolet imagers _ ( euvi : ) aboard the _ solar terrestial relations observatory _ ( stereo : ) .",
    "the technique involves the decomposition of images into different spatial scales , and the filtering / enhancements of features at the multiple resolutions .",
    "the technique is computationally expensive yet gives very good results .",
    "a less sophisticated yet very efficient technique to reveal features above the limb is based on techniques originally developed for coronagraphs @xcite .",
    "most relevant to this work is the recently - developed noise adaptive fuzzy equalization ( nafe ) method @xcite .",
    "the method is inspired by adaptive histogram equalization , where local statistics govern the output value of a pixel .",
    "the method uses a fuzzy membership function of a gaussian - weighted local set to enhance structural detail , preserve contextual detail , and to reduce noise .",
    "the nafe method results in very clear images without artifacts and with excellent noise reduction .",
    "its one downside is computational expense .",
    "this work summarizes the problems in visualising features in euv images ( section [ observation ] ) , introduces the new method ( section [ method ] ) , applies the method to several images from various instruments ( section [ results ] ) and closes with a brief summary ( section [ summary ] ) .",
    "an observation from 04 may 2005 00:00 ut by the 171   channel of aia is used as a working example throughout this section .",
    "the data is first pre - processed using the standard sdo solarsoft software ` aia_prep ' .",
    "this observation is shown without further image processing in the left panel of figure [ fig1 ] .",
    "the 171   channel of aia has a narrow bandwidth which is dominated by emission from highly - ionised iron which has a formation temperature which peaks at @xmath00.8 mk .",
    "the intensity of this image is therefore a function of the emitting plasma temperature and density .",
    "the line - of - sight and optical thickness of the plasma also has an effect on the measured intensity , as well as small contributions from other weaker spectral lines which share the same bandpass .",
    "the left panel of figure [ fig1 ] illustrates the main challenge of revealing information in euv images . for various physical reasons ( mostly due to density ) ,",
    "the display range is dominated by the large difference between dark regions and the small bright regions near , or at , the base of active regions .",
    "most of the structural detail appears dark and is hidden .",
    "a quick and easy way of revealing some of this structure is by taking the square root of the image ( processing of this type is generally known as a gamma transformation ) .",
    "this is shown in the right panel of figure [ fig1 ] .",
    "although a large improvement on the unprocessed image , there is still much hidden structure , and bright areas become ` washed out ' .",
    "in particular , there is very little visible structure off the limb .",
    "the same is true of applying a logarithmic transformation , or any one - to - one mapping between input and output .",
    "the dominance of the image contrast range by small bright regions can be shown quantitatively by selecting regions and plotting histograms of pixel values .",
    "this is shown in figure [ fig2 ] for four areas - quiet sun , active region base , active region , and off - limb .",
    "note that these are pixel values normalized by the exposure time .",
    "the top @xmath075% of brightness values is taken by the small very brightest region of the active region ( cyan colour ) .",
    "this leaves the information from all other regions in the lower 25% .",
    "in fact , the off - limb and quiet sun regions have pixel values restricted to below @xmath0300 .",
    "furthermore , the bright active regions contain a large number of pixels which share the low values of the quiet sun .",
    "there are sharp boundaries between very dark and very bright regions .",
    "these characteristics become more extreme when flares occur .",
    "any image processing which attempts to reveal the information hidden in euv images must deal with the large range of brightness values , preserve the large spatial gradients in brightness and respect the fact that even the brightest regions contain dark patches .",
    "another challenge is the existence of structures at many spatial scales .",
    "we can not apply edge - detection or enhancement exclusively at small scales since this will enhance some features whilst other structures and the larger - scale context is lost .",
    "furthermore , with full resolution aia images of @xmath1 pixels taken every 11s ( and the anticipation of the resolution of future instruments ) , computational efficiency is very important .",
    "barring spurious calibration errors , the brightness values in the original euv image will be positive .",
    "let @xmath2 be the original image normalised by exposure time .",
    "@xmath3 is a 2d gaussian kernel of width @xmath4 pixels in the @xmath5 and @xmath6 image dimensions . throughout this work",
    ", @xmath4 denotes the one - sigma width of the gaussian .",
    "a normalized image @xmath7 can be computed by @xmath8    where    @xmath9\\otimes k_w}.\\ ] ]    for a given pixel , the numerator of equation ( [ eqn1 ] ) effectively subtracts the local ` mean ' ( weighted by the gaussian function centered on the pixel ) , and the denominator @xmath10 is the local ` standard deviation ' , also weighted by the gaussian kernel .",
    "thus , simply speaking , @xmath7 is locally normalized to a standard deviation of one and a mean of zero .",
    "an example of @xmath7 , computed with @xmath11 is shown in the left image of figure [ fig3 ] .",
    "this process of local normalisation is in essence similar to adaptive histogram equalization , where each pixel is scaled according to the statistics of the local group of pixels .",
    "the main difference is that histogram equalization enables precise control of the output pixel value range , whereas gaussian normalisation does not .",
    "this problem is solved by means of a further transformation applied to image @xmath7 :    @xmath12    since c is distributed across both negative and positive values , the @xmath13 function in formula ( 3 ) serves a purpose similar to a gamma transformation i.e. pixel values near the zero are amplified and extreme values far from zero are attenuated .",
    "this transform ensures the control over the output pixel value range and prevents saturation of output pixel values .",
    "an example of @xmath14 is shown in the right image of figure [ fig3 ] .",
    "the parameter @xmath15 controls the severity of the transformation .",
    "a default value of 0.7 gives good results for all the data shown in the results section .",
    "the pixel values of image @xmath7 have a standard deviation @xmath01 , and a value for @xmath15 of @xmath00.7 gives sensible results .",
    "a set of @xmath16 locally - normalized and @xmath13-transformed images , @xmath17 , is created for @xmath16 values of @xmath18 .",
    "values used throughout this work are @xmath19 . a global gamma - transformed image ,",
    "@xmath20 is also created by    @xmath21    @xmath22 can be set at values of 2.5 to 4 . throughout this work ,",
    "we use @xmath23 , and this gives good results for all instruments and bandpasses we have processed . @xmath24 and",
    "@xmath25 set the minimum and maximum input values respectively . for processing single images ,",
    "they can be set to the minimum and maximum image values . for batch processing of a large number of observation",
    ", they can be set as the minimum and maximum values of the whole set of observations . for aia",
    "/ sdo observations , these values can be easily found at the start of a batch process by reading the appropriate values stored in the data headers ( that is , without having to read in the full images ) .",
    "the final processed image , @xmath26 is calculated by a weighted average of the @xmath17 using weights @xmath27 , and addition of @xmath20 weighted by a global weight @xmath28 :    @xmath29    the @xmath27 can be calculated by a study of images consisting of only normally - distributed random noise . for narrow gaussian kernels ,",
    "the mean of the local standard deviations across the whole image @xmath30 is an underestimate of the global standard deviation , and there is a larger variation in the local standard deviation .",
    "this is intuitive - the ratio of the mean of the local standard deviation to the global standard deviation approaches unity with a wider kernel , and there is less variation in the local standard deviation .",
    "this is shown in figure [ fig4 ] .",
    "therefore the weights @xmath27 are set at smaller values for small @xmath4 , and approach values near one as @xmath31 , as listed in figure [ fig4 ] . as described in equation ( [ eqn3 ] ) , the original ( normalized ) image @xmath20 is included to give contextual information of the largest scale structure .",
    "we use @xmath32 in this work . in practice",
    ", the weights @xmath27 and @xmath28 may be adjusted according to the desired output , and also according to the type of input image ( e.g. wavelength or channel ) . for most purposes ,",
    "the @xmath27 can be set equal for all scales so that a straightforward mean of the locally - normalized @xmath17 is made .      1 .",
    "replace spurious negative pixels with zero or local mean / median .",
    "2 .   create gaussian kernel of width @xmath18 .",
    "kernel elements should sum to unity .",
    "3 .   convolve image with kernel to create local mean image @xmath33 .",
    "4 .   calculate difference between image and the local mean image , square the difference , and convolve with kernel .",
    "square root the resulting image to give ` local standard deviation ' image @xmath10 ( equation ( [ eqn2 ] ) ) .",
    "calculate normalized image @xmath34 by subtracting the local mean image and dividing by the local standard deviation image ( equation ( [ eqn1 ] ) ) .",
    "store the result . 6 .",
    "apply @xmath13 transformation on @xmath34 to give @xmath17 .",
    "repeat 2 - 6 with the different kernel widths @xmath18 .",
    "take mean , or weighted mean if preferred , of the @xmath17 to give a weighted mean locally - normalised image .",
    "calculate a global gamma - transformed image @xmath20 by applying equation ( [ eqn2b ] ) .",
    "sum the weighted mean locally - normalised image with the global normalized image @xmath20 , with appropriate weight @xmath28 ( as equation ( [ eqn3 ] ) ) .    note that considerable efficiency is gained by creating a one - dimensional gaussian kernel for convolving first along the @xmath5-direction , then convolving the resulting image along the @xmath6-direction with a transposed kernel .",
    "this is far more efficient than convolving directly with a two - dimensional kernel .",
    "compared to the nafe @xcite , or wavelet - based routines , the mgn method is a simple one , and as gaussian smoothing is a standard practice employed by most programming languages , can readily be programmed in a few lines of code . without great rigour , we test the efficiency of the processing using the interactive data language ( idl ) on a macbook pro laptop with 8 gb ram and a 2.6ghz intel core i7 processor .",
    "the computing time increases approximately linearly from @xmath01s for a 500@xmath35500 image to 10s for a 2k@xmath352k image . a full aia / sdo 4096@xmath354096 image takes 40s .",
    "this is extremely fast compared to other methods such as the nafe ( at least an order of magnitude faster ) , and does not require a high - performance computer .",
    "figure [ fig5 ] shows the result of applying mgn to the example aia image of the previous sections .",
    "structure is enhanced down to fine spatial scales , although large - scale context is preserved ( that is , bright regions are still brighter than dark regions ) .",
    "off - limb structure , where present , is enhanced without being swamped by noise .",
    "structure is enhanced in the extremely bright region at the base of an active region ( the cyan - bordered region in figure [ fig2 ] ) , which originally appeared saturated .",
    "structure can also be seen in dark regions immediately neighbouring the bright region .",
    "it is also very useful to be able to trace structure from origins on the disk to off - limb heights . in this example",
    ", there are loops and fan - like bright features which extend from the disk and past the limb .",
    "movies created using the processing reveal dynamic features at very small scales such as flows within filament channels , flows along large coronal loops , small - scale activity within active regions , and movement in extended off - limb structures in response to dynamic events .",
    "an example aia movie is available online ( aia_movie.gif - an animated gif which can be viewed with a web browser ) which shows a large portion of the west disk and off - limb region observed in the 171   channel during 18 january 2013 .",
    "activity and small - scale flows are clearly seen , alongside larger - scale eruptions , and the movement / expansion of loops off the limb out to the edge of the field of view .    another online movie ( comparison_movie.gif ) compares the appearance of a sequence of aia observations processed by the mgn ( left panel ) , and by a simple gamma transformation ( right panel ) .",
    "this sequence shows a flaring active region and the eruption of a cme observed in the 171   channel during 08 march 2011 in the south - west .",
    "the disk and off - limb structure is seen far more clearly in the mgn images .",
    "individual loops are resolved , even in the complicated off - limb region to the north of the active region . in the original data ,",
    "the sequence is dominated by the bright core of the active region , and when the flare peaks , by the small saturated regions centered on the flare .",
    "the mgn images show this activity clearly , and also succeed in maintaining a clear and stable view of surrounding structure throughout the movie , including the ` wobble ' of the active region loops in response to flaring activity .",
    "this enables a more comprehensive analysis of the event , showing connections between activity and movement of structure which can be hidden without mgn processing .",
    "figure [ fig6 ] shows a hi - c image processed with mgn .",
    "a movie showing the northernmost portion of this image is available online ( hic_movie.gif ) .",
    "various features such as magnetic braiding @xcite are clearly seen , as are plasma streams along the dark filament channels , and small - scale movement within the magnetic ` moss ' .",
    "such features can not be seen without appropriate processing .",
    "figure [ fig7 ] shows the application of mgn to an observation by the _ sun watcher using aps _ ( swap ) instrument aboard the _ project for onboard autonomy 2 _ ( proba2 ) satellite @xcite .",
    "this instrument has a coarser resolution than aia , but has an extended field of view .",
    "figure [ fig7 ] reveals an erupting filament out to the extremity of the field of view , and other quiescent structures to @xmath01.5@xmath36 .",
    "again , even low - signal structures are enhanced without too much amplification of noise .",
    "the mgn processing is not limited to euv observations .",
    "figure [ fig8 ] shows its application to a white light coronagraph image of the extended inner corona by the _ large - angle and spectrometric coronagraph _ ( lasco ) aboard soho .",
    "the left image shows an observation of 14 january 2011 , with a long - term background subtracted to remove instrumental stray light and f - corona .",
    "a point filter has also been applied to reduce spurious bright pixels .",
    "the right image shows a mgn - processed image , with parameters @xmath37 and @xmath38 .",
    "smaller - scale features are enhanced , in particular faint plumes over the poles which are difficult to see in the original image . in this respect ,",
    "the mgn is an improvement over the nrgf @xcite , although the nrgf provides structural context closer to the true k - corona .",
    "it is difficult to make a qualitative comparison of images created using different processing .",
    "different processes may serve different analysis purposes - the important function for the process described here is to reveal information hidden in the original images .",
    "a non - rigorous comparison ` by eye ' of the same images processed using the mgn and of the nafe @xcite suggests that the results are similar , with the nafe giving slightly better clarity overall , and improved noise suppression - most obvious at large heights off the limb . for the mgn ,",
    "noise reduction arises naturally from taking the ( weighted ) mean across many spatial scales .",
    "the noise suppression is not as effective as the nafe , and the mgn method lacks control over the degree of noise suppression .",
    "the nafe method is also better suited to reveal contrast in very bright regions .",
    "the mgn method normalizes an image by using the local mean and standard deviation calculated using a gaussian - weighted sample of local pixels .",
    "this normalised image is transformed by the @xmath13 function ( similar to a gamma transformation ) .",
    "this is applied over several spatial scales , and the final image is a weighted combination of the normalized components .",
    "the results compare well with multiresolution wavelet enhancement or the nafe procedure , but is far more computationally efficient .",
    "we hope that the mgn will become an established tool for researchers , offering a good compromise between computational time and clarity of the final images .",
    "the method is simple to implement , and the author is happy to provide the idl code by email request .",
    "we are grateful for comments by the anonymous referee which improved this work .",
    "huw morgan is grateful for funding from the coleg cymraeg cenedlaethol to prifysgol aberystwyth and support of shine grant 0962716 and nasa grant nnx08aj07 g to the institute for astronomy , university of hawaii .",
    "the work of miloslav druckmller was supported by grant agency of brno university of technology , project fsi - s-11 - 3 .",
    "we acknowledge the high resolution coronal imager instrument team for making the flight data publicly available .",
    "msfc / nasa led the mission and partners include the smithsonian astrophysical observatory in cambridge , mass . ; lockheed martin s solar astrophysical laboratory in palo alto , calif . ; the university of central lancashire in lancashire , england ; and the lebedev physical institute of the russian academy of sciences in moscow .                    , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , : 2011 , the atmospheric imaging assembly ( aia ) on the solar dynamics observatory ( sdo ) . _",
    "_ solar phys . _ _ , 172 ."
  ],
  "abstract_text": [
    "<S> extreme ultraviolet images of the corona contain information over a large range of spatial scales , and different structures such as active regions , quiet sun and filament channels contain information at very different brightness regimes . </S>",
    "<S> processing of these images is important to reveal information , often hidden within the data , without introducing artifacts or bias . </S>",
    "<S> it is also important that any process be computationally efficient , particularly given the fine spatial and temporal resolution of _ atmospheric imaging assembly _ on the _ solar dynamics observatory _ </S>",
    "<S> ( aia / sdo ) , and consideration of future higher - resolution observations . </S>",
    "<S> a very efficient process is described here which is based on localized normalizing of the data at many different spatial scales . </S>",
    "<S> the method reveals information at the finest scales , whilst maintaining enough of the larger - scale information to provide context . </S>",
    "<S> it also intrinsically flattens noisy regions and can reveal structure in off - limb regions out to the edge of the field of view . </S>",
    "<S> the method is also successfully applied to a white light coronagraph observation . </S>"
  ]
}