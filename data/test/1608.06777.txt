{
  "article_text": [
    "fourier spectroscopies concept revolutionized many analytical techniques in the second half of the @xmath0 century : nuclear magnetic resonance ( nmr ) , infrared spectroscopy ( ir ) , raman spectroscopy , and mass spectrometry ( ms ) with fourier transform ion cyclotronic resonance ( fticr - ms)@xcite and more recently orbitrap@xcite .",
    "the use of fast fourier transform gives access to fellgett advantage@xcite and permits higher sensitivity and faster acquisitions .",
    "as these analytical techniques share the same processing procedures it is possible to devise common tools .",
    "however , generally each domain usually comes with specific methods for display as well as specific file formats , limiting the sharing of tools and leading to redundant developments .",
    "every experimental study is the result of a three steps procedure .",
    "data are first acquired , then processed and finally analyzed . depending on the domain , processing is a more or less neglected task .",
    "for example , in mass spectrometry , analysis is a very important part of the work for the exploitation of the data and many commercial and open - source softwares have been developed for this purpose during the last decades and are now available@xcite .",
    "but very few tools are proposed for processing the data before analysis .",
    "most of the time , this step is abandoned to manufacturers and considered as black boxes full of obscure procedures , whereas processing is a crucial step for providing a more precise and complete information for analysis .",
    "in contrast , processing is a dominant part of the nmr spectroscopist culture with a very large wealth of existing softwares @xcite .",
    "in addition new processing techniques are profundly modifying data processing and there is a need of incorporating them in the toolbox of the practitioners .",
    "recent computer capabilities have indeed given the possibility to store very large amount of data at each experimental run .",
    "the rising usage of high - throughput@xcite acquisition in mass spectrometry has rapidly taken advantage of those progresses .",
    "but in spite of hardware enhancements , the classical processing techniques at disposal ( such as denoising , deconvolution , etc .. ) are facing both the huge volume of data and the limited time available for computations .",
    "this phenomenon , known as the _ big data bottleneck _ , raises the need of newer algorithms , adapted to big data by being faster and with less memory footprint .    as a first answer to these two major concerns : generic processing tools for ft spectroscopies and big data challenge",
    ", we propose here a framework able to handle general processing and which can currently be used for ft mass spectrometry ( fticr and orbitrap ) as well as for nmr processing .",
    "we called it spike ( spectrometry processing innovative kernel ) , as it is developed as a kernel , extensible to any ft spectroscopies beyond the ones already implemented .",
    "this approach should help for a _ cross - fertilization _ in the target spectroscopic domains , by a wider use of some sophisticated techniques which are currently confined to a specialized domain .",
    "spike was developed from the difficulties observed when using the npk package@xcite on large nmr and ft - icr data - sets ( and was even called npkv2 in the beginning of the project ) .",
    "it was conceived as a complete rewrite , with a totally new organization while retaining some of its modularity and data concepts .",
    "the choice of the computer language was considered with an emphasis on robustness , flexibility and evolvability , with some consideration on the inherent speed .",
    "scientific python@xcite was thus chosen as a development platform since it comes with all the benefits of a clear syntax , easy maintainability , simple and fast extensibility .",
    "processing speed is insured by the scientific modules numpy@xcite and scipy@xcite which have been developed on the top of performant standard libraries developed in low level languages .",
    "all the processing in spike relies on a chained syntax in which each element performs an elementary processing task .",
    "this gives the possibility to write code easily without any programming expertise .",
    "the language can be used for writing scripts or in an interactive programming context such as the ipython notebook@xcite web interface .",
    "spike comes also with a plugin mechanism which is practical for adding in a flexible manner new functionalities to the native library , without modifying the internal code .",
    "the elementary basic block routines in spike are apodisation , zero - filling and a full set of fourier transforms .",
    "1d and 2d spectra are handled , and the processing of higher dimension spectra is in development .",
    "the handling of hypercomplex numbers originally incorporated for multidimensional nmr @xcite is available and used for the processing of 2d - nmr as well as 2d - fticr - ms data - sets .",
    "baseline correction can be done using classical savitzky - golay@xcite filter or with a specific algorithm using @xmath1 norm optimization .",
    "elementary peak - picking with centroid correction can be performed both on 1d and 2d spectra .",
    "several advanced processing methods are also proposed in the spike program .",
    "it contains specific algorithms such as the burg algorithm for linear prediction@xcite which can be useful in many situations such as missing points reconstruction or spectral analysis .",
    "denoising is a major concern in data processing .",
    "statistical methods such as cadzow@xcite or wavelet denoising@xcite are very efficient for coping with noise in different kind of signals and are provided here@xcite .",
    "spike also incorporates the recently proposed algorithm urqrd@xcite which relies on low rank matrix approximation performed with random projections .",
    "this algorithm provides a more robust noise filtering as well as a much faster speed than algorithms of the same kind .",
    "its much reduced memory footprint permits to handle very large data - sets .",
    "it is used for example on the 2d - fticr - ms data - set for removing the strong scintillation noise from the 2d - ms data - sets .      whenever practical spike performs its data processing in memory .",
    "this is done with the numpy library which allows vectorized computations of large binary arrays . in the case of operations too large to fit into memory , the processing is performed _ onfile _",
    "thanks to the hierarchical data format file format hdf5@xcite .",
    "data stored in this format are accessible transparently as numpy arrays thanks to the pytable@xcite python module .",
    "this feature allows to efficiently cope with the with ram bottleneck for memory greedy application such as 2d - fticr - ms processing and visualization .",
    "the hdf5 format was chosen as the default file format for storing spike data .",
    "its hierarchical structure allows an easy storage of complex data and structured metadata , and the internal compression capabilities insure an optimal file size .",
    "each manufacturer data - set comes with its own specific importer integrated via a plugin mechanism .",
    "the importers encapsulate the data and metadata in a unique corresponding python object which can then be easily manipulated through pipe commands .",
    "the metadata are interpreted from the parameter files provided by the instrument , and give information about characteristic acquisition parameters .",
    "importers are provided for thermofisher _ .dat _ files , bruker _ apex _ and _ solarix _ files , as well as _ mzxml _",
    "generic format ; and for bruker _ fid _ , _ ser _ and processed nmr files .",
    "data can also be easily imported from and exported to the gifa and npk software@xcite file formats as well as csv text files .      with the emphasis on big data processing approach relies on fast algorithms but also on parallel calculations .",
    "this is done transparently using either the multiprocessing python module for a simple parallelism on multicore machines , or the mpi tool@xcite which permits a deployment on a large scale clusters .",
    "a generic interface to mpi was developed inside spike , allowing a very efficient parallelism .",
    "figure [ fig : parallel ] presents the processing of a large 2d - fticr - ms experiment , parallelized on up to 64 processors on a large linux beowulf cluster .",
    "line , corresponding to a perfect speed - up .",
    "top ) processing of a 2k@xmath264k data - set , ( fft and rank 20 urqrd ) to produce a 4k@xmath2128k output spectrum , on a dual xeon machine with a total of 12 cores , using the python multiprocessing module ; bottom ) processing of a 4k@xmath2256k data - set , ( fft and rank 200 urqrd ) to produce a 8k@xmath2512k output spectrum , performed on the strasbourg university hpc using mpi ; the limiting burden here is the file access time.,title=\"fig:\",scaledwidth=40.0% ]   line , corresponding to a perfect speed - up .",
    "top ) processing of a 2k@xmath264k data - set , ( fft and rank 20 urqrd ) to produce a 4k@xmath2128k output spectrum , on a dual xeon machine with a total of 12 cores , using the python multiprocessing module ; bottom ) processing of a 4k@xmath2256k data - set , ( fft and rank 200 urqrd ) to produce a 8k@xmath2512k output spectrum , performed on the strasbourg university hpc using mpi ; the limiting burden here is the file access time.,title=\"fig:\",scaledwidth=40.0% ]      recently the equivalent of two - dimensional nmr applied to fticr - ms , namely 2d - fticr - ms@xcite was revived@xcite .",
    "this is a new exciting but challenging tool for the analysis of very complex mixtures . in comparison",
    "to tandem mass spectrometry , no chromatographic separation nor ion isolation are required , acquisition is greatly simplified and the technique is much more flexible .",
    "even though it was proposed in the mid eighties , it was not usable in practice until very recently principally because of the limitations on processing and of the huge memory consumption .",
    "indeed , the latest examples of 2d - fticr - ms applied to proteomics studies@xcite would not have been possible without the development of the project presented here .",
    "a special independent module is provided which performs the complete processing of 2d - fticr - ms experiment using spike s library .",
    "this module makes an optimal use of all capabilities of the program , in particular the parallel processing .",
    "the processing of this large data - sets is not interactive , so a batch processing mode was chosen and the user has to set - up a configuration file for the parameters for the processing .",
    "this configuration file , as well as the log of the process , is stored as metadata into the final hdf5 file .",
    "all data - sets can be displayed interactively using the python matplotlib library@xcite in a transparent manner , it comes with all the standard tools for manipulating the graph ( zoom , drag , saving etc ... ) .",
    "axes representation is handled according to data type and in their own natural unit ( _ second _ , _ hz _ , _ ppm _ , _ m / z _ , etc ... ) on multidimensional data the axes can be set independently .",
    "spike proposes also a specific graphic interface developed using the qt library@xcite dedicated to the display and analysis of the 2f - fticr - ms spectra ( cf figure [ visu2d ] ) .",
    "this module comprises tools for fluid navigation in the large spectral matrix .",
    "several resolution of the same 2d spectrum are stored in the hierarchical multiresolution hdf5 file structure .",
    "this allows rapid zooming and the extration of ms subspectra profiles with the highest possible precision without requiring excessive amount of memory despite the huge size of the data matrix .",
    "using spike it is easy to devise the analysis of a spectroscopic data - set , in few lines of python using the pipe syntax . as a first example ,",
    "figure [ orbi_fid ] presents the standard processing of an orbitrap ft - ms data - set , and the few commands that were issued to produce the spectrum .              in the nmr spectroscopy studies of protein ligand interactions , a common procedure consists in monitoring the displacement of spectral lines upon some variation of an experimental parameter .",
    "in such an example , it is important to process the spectra in the same condition , to monitor automatically parameters such peak position or width , and finally to report in a graphical manner the evolution of the system .",
    "figure [ fig : hsqc ] presents a set of @xmath3n - hsqc 2d spectra of the interaction between the third sh3 domain of vinexin@xmath4 and varying concentration of a polyproline peptide from the n - terminal domain of the rar@xmath5@xcite .",
    "the data - sets here are processed and peak - picked automatically .          in the recent period ,",
    "the 2d - fticr - ms method@xcite , has been shown to be a valuable analytical technique for proteomics studies@xcite",
    ". however , these analyses require the acquisition of very large data - sets , and set high constraint on the analysis software .",
    "spike has been design to handle this kind of large data - sets , and is capable of processing and analyzing 2d - fticr - ms spectra .",
    "in contrast with the previous examples , the processing is too large to be performed interactively , and specific modules have been developed for the processing and the display of these spectra .",
    "figure [ visu2d ] shows the user interface of the program which permits to interactively display 2d - fticr - msand extract 1d sub - spectra .",
    "the tool provides rapid zooming and panning , easy extraction of parents and fragments spectra , but also of diagonal spectra ( for instance for neutral loss analysis@xcite ) .",
    "we have presented spike , a python package meant for processing and visualizing data - sets for fourier spectroscopies with a capacity to easily process large data - sets .",
    "this software aims at giving an easy access to processing in the domain of ft techniques .",
    "the program is an ongoing development , and while only nmr and ft mass spectrometry are currently available , the code is meant to be extensible to any other ft techniques .",
    "the program spike is entirely written in python , and relies on the standard scientific python libraries .",
    "it is released in open - source under the cecill 2.1 license , and available for download at https://bitbucket.org/delsuc/spike .",
    "the authors thank c.khler and b.kieffer for the set of nmr hsqc data - sets and j.chamot-rooke for the orbitrap data - set ; the cnrs , for the dfi instrumention aux limites and the mastodons-2013 grant , the agence nationale pour la recherche ( grant ft - icr2d ( 2010 ) and grant one_shot_ft - icr_ms_2d ( 2014 ) ) for funding .",
    "the authors acknowledge the high performance computing center of the university of strasbourg for scientific support and access to computing resources .",
    "we also thank all the many colleagues , interns , students , and program users that helped in the development by using the program , and eventually correcting bugs or adding features ."
  ],
  "abstract_text": [
    "<S> we present spike ( spectrometry processing innovative kernel ) , an open - source python package dedicated to fourier spectroscopies . </S>",
    "<S> it provides basic functionalities such as apodisation , a complete set of fourier transforms , phasing ( for nmr ) , peak - picking , baseline correction and also tools such as linear prediction . beside its versatility , </S>",
    "<S> the most prominent novelty of this package is to incorporate new tools for big data processing . </S>",
    "<S> this is exemplified by its ability to handle the processing and visualization of very large data - sets , with multiprocessor capabilities and a low memory footprint . </S>",
    "<S> the software contains also all the tools necessary for the specific fast processing and visualization of 2d - fticr - ms data - sets . </S>"
  ]
}