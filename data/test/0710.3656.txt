{
  "article_text": [
    "having in mind the geometric interpretation of the group structure on a cubic ( see figure [ fig : kubika ] ) ,        [ fig : kubika ]    the question of finding an analogous construction of the group structure in higher genera arises . in this paper",
    ", we show that such a geometric construction exists in the case of hyperelliptic jacobians .",
    "our ideas are continuation of those of reid , donagi and knrrer , see @xcite , @xcite , @xcite and also @xcite , @xcite . further development , realization , simplification and visualization of their constructions is obtained by using the ideas of billiard dynamics on pencils of quadrics developed in @xcite .",
    "the key projective - geometric feature of that billiard dynamics is the double reflection theorem , see theorem [ th : drt ] below .",
    "there are four lines belonging to a certain linear space and forming _ the double reflection configuration _ : these four lines reflect to each other according to * the billiard law at some confocal quadrics*. this billiard configuration appears to be the exact genus two generalization of three points belonging to a line in the elliptic case .    in higher genera",
    ", we construct the corresponding more general billiard configuration , again by using double reflection theorem .",
    "this configuration , which we call _ @xmath3-brush _",
    ", is in one of the equivalent formulations , a certain billiard trajectory of length @xmath6 and the sum of @xmath3 elements in the brush is , roughly speaking , the final segment of that billiard trajectory .",
    "the milestones of this paper are @xcite and @xcite and the key observation giving a link between them is _ that the correspondence @xmath7 in lemma 4.1 and corollary 4.2 from @xcite is _ * the billiard map at the quadric * @xmath8 .    thus , after observing and understanding the billiard nature behind the constructions of @xcite , @xcite , @xcite , we become able to use the billiard tools to construct and study hyperelliptic jacobians , and particularly their real part .",
    "any real hyperelliptic jacobian may be realized as a set @xmath0 of lines simultaneously tangent to given @xmath1 quadrics @xmath9 , ... , @xmath10 of some confocal family in the @xmath2-dimensional euclidean space .",
    "it is well known that such a set @xmath0 is invariant under the billiard dynamics determined by quadrics from the confocal family . by using double reflection theorem and some other billiard constructions",
    "we construct a group structure on @xmath0 , _ a billiard algebra_. the usage of billiard dynamics in algebro - geometric considerations appears to be , as usually in such a situation , of a two - way benefit . we derive a fundamental property of @xmath0 : _ any two lines in @xmath0 can be obtained from each other by at most @xmath1 billiard reflections at some quadrics from the confocal family_. the last fact opens a possibility to introduce new hierarchies of notions : of _ @xmath3-skew lines in @xmath0 , @xmath11 _ and of _ @xmath3-weak poncelet trajectories of length @xmath12_. the last are natural quasi - periodic generalizations of poncelet polygons . by using billiard algebra ,",
    "we obtain complete analytical description for them .",
    "these results are further generalizations of our recent description of cayley s type of poncelet polygons in arbitrary dimension , see @xcite .",
    "let us emphasize that the method used here , based on billiard algebra differs from the methods exposed in @xcite .",
    "the interrelations between billiard dynamics , subspaces of intersections of quadrics and hyperelliptic jacobians developed in this paper , enable us to obtain higher dimensional generalizations of several classical results . to demonstrate the power of our method , we present here generalizations of weyr s poncelet theorem ( see @xcite ) and also griffiths - harris space poncelet theorem ( see @xcite ) in arbitrary dimension are derived and presented here .",
    "we also give an arbitrary - dimensional generalization of the darboux theorem @xcite .",
    "let us mention that one of the plane versions of darboux theorem has been recently rediscovered , with some improvements , in @xcite . in that paper , the obtained configuration",
    "is called _ poncelet grid _ , while we name it here _ poncelet - darboux grid _ , which is , by our opinion , more historically justified .",
    "the paper is organized as follows .",
    "section [ sec : preliminaries ] consists of preliminaries .",
    "it starts with a review of confocal families of quadrics and their most important properties , in the @xmath2-dimensional euclidean and projective space .",
    "the poncelet theorem in the three - dimensional projective space over an arbitrary field is proved , giving accent on projective definitions and methods .",
    "we review the one reflection theorem and the double reflection theorem ( drt ) .",
    "the latter appears to be one of the main projective tools used in the paper .",
    "the notions of virtual reflections and virtual reflection configuration are recalled and some of their basic properties from @xcite are reviewed .",
    "we recall the definition of the generalized cayley s curve from @xcite , and discuss its form in the real case .",
    "section [ sekcija : bilijarskaalgebra ] is the kernel of the paper . in section [ sekcija : morfizam ] , relying on the simple lemma [ lema : veza ] , we begin to build a bridge between knrrer s constructions from @xcite and the billiard notions from our previous article @xcite and this paper .",
    "then , we construct a birational morphism between the generalized cayley s curve and the reid - donagi - knrrer curve ( see @xcite,@xcite,@xcite ) . in section [ sec : genus2 ] , we construct a group structure on the set of lines in @xmath13 that are simultaneously tangent to two given confocal quadrics . this group structure",
    "is naturally connected with the billiard law .",
    "using its properties , some beautiful properties of confocal families are derived , e.g.  theorem [ th : zvezda ] . in section [ sec : general ] , set @xmath0 of lines simultaneously tangent to given @xmath1 quadrics @xmath9 , ... ,",
    "@xmath14 of some confocal family in @xmath15 is in several steps endowed with a group structure called _",
    "billiard algebra_. in this construction , we first define the addition operation on the set of all finite billiard trajectories with the same initial line .",
    "then , observing equivalence relations @xmath16 and @xmath17 in the set of finite billiard trajectories , we prove that the addition operation is compatible with them , and that the operation on the equivalence classes has additional algebraic properties . at the end",
    ", we are ready to use these constructions in order to obtain the billiard algebra on the set of lines .    section [ sec : algebra ] is aimed to illustrate the billiard algebra introduced in section [ sekcija : bilijarskaalgebra ] .",
    "section [ sec : weak ] starts with introduction of the notions of _ @xmath3-skew lines _ and _ @xmath3-weak poncelet trajectories_. we prove the poncelet type theorem for such trajectories and deduce the corresponding analytic condition of cayley s type . in section [ sekcija : wgh ] , higher - dimensional generalizations of some classical results connected to poncelet s porism are stated and proved .",
    "we introduce _ generalized weyr chains _ and show their correspondence with poncelet polygons ( theorem [ th : gen.weyr ] and proposition [ propozicija : weyr.poncelet ] ) .",
    "this correspondence is then used to demonstrate the generalization to higher dimensions of the griffiths - harris space version of poncelet theorem ( theorem [ teorema : uopstena.grifits.haris ] ) .",
    "section [ sec : grid ] starts with recalling and a few comments on darboux s theorem on grids of conics associated to a poncelet polygon on an arbitrary liouville surface .",
    "then , for the case when the surface is the eucledean plane , we prove in theorems [ th : gen.grida ] and [ th : grida ] a generalization of the darboux s theorem . the essential generalization to higher dimensions",
    "is demonstrated in theorem [ th : gen.grida.d ] .",
    "section [ sec : conclusion ] contains concluding remarks .",
    "in this section , we are going to define families of confocal quadrics in the @xmath2-dimensional euclidean space @xmath15 and summarize their basic properties connected with the billiard reflection law .",
    "[ def : e.confocal ] _ a family of confocal quadrics _ in the @xmath2-dimensional euclidean space @xmath15 is a family of the form : @xmath18 where @xmath19 ,  , @xmath20 are real constants .",
    "let us notice that a family of confocal quadrics in the euclidean space is determined by only one quadric .",
    "from now on , we are going to consider the non - degenerate case when @xmath19, ",
    ",@xmath20 are all distinct .",
    "[ th : jacobi ] any point of the @xmath2-dimensional euclidean space is the intersection of exactly @xmath2 quadrics of the confocal family ( [ eq : confocal.family ] ) .",
    "the quadrics are perpendicular to each other at the intersecting points .",
    "( see figure [ fig:3konf ] ) .",
    ", width=226,height=226 ]    from here , it follows that to every point @xmath21 we may associate a @xmath2-tuple of distinct parameters @xmath22 , such that @xmath23 belongs to quadrics @xmath24 ,  , @xmath25 .",
    "additionally , if we order @xmath26 and @xmath27 , then : @xmath28",
    "_ jacobi elliptic coordinates _ of point @xmath29 are values @xmath22 that satisfy : @xmath30    [ th : chasles ] any line in @xmath15 is tangent to exactly @xmath1 quadrics from a given confocal family .",
    "tangent hyper - planes to these quadrics , constructed at the points of tangency with the line , are orthogonal to each other .",
    "we say that two lines @xmath31 , @xmath32 intersecting in point @xmath33 _ satisfy the billiard reflection law _ on quadric @xmath34 if they are coplanar with the line normal to @xmath34 at @xmath35 , determine the congruent angles with this line .",
    "_ a billiard trajectory within @xmath34 _ is a polygonal line with vertices on @xmath34 , such that each pair of its consecutive segments satisfies the billiard reflection law on @xmath34 and lies on the same side of the tangent hyper - plane to @xmath34 at their common endpoint .",
    "the billiard reflection on a quadric is tightly connected with the corresponding confocal family .",
    "two lines that satisfy the reflection law on a quadric @xmath34 in @xmath15 are tangent to the same @xmath1 quadrics confocal with @xmath34 .    from the previous theorem",
    ", it follows that all segment of a billiard trajectory within @xmath34 are tangent to the same @xmath1 quadrics confocal with @xmath34 .",
    "we call these @xmath1 quadrics _ caustics _ of the given trajectory .",
    "[ generalized poncelet theorem ] consider a closed billiard trajectory within quadric @xmath34 in @xmath15 .",
    "then all other billiard trajectories within @xmath36 , that share the same @xmath1 caustics , are also closed . moreover , all these closed trajectories have the same number of vertices .",
    "this theorem , concerning the plane case ( @xmath37 ) , is due to jean - victor poncelet and dates from the beginning of the xixth century @xcite .",
    "its generalization to the three - dimensional case is proved by darboux @xcite at the end of the same century .",
    "the generalization to an arbitrary dimension is obtained in @xcite at the end of xxth century .",
    "having the generalized poncelet theorem in mind , it is natural to ask about an explicit condition on a quadric and a set of confocal caustics , such that the corresponding billiard trajectories are closed .",
    "this condition , for @xmath37 , was given by cayley @xcite .",
    "the condition for an arbitrary @xmath2 is obtained by the authors of this paper in @xcite .",
    "[ generalized cayley condition ] the condition on a billiard trajectory inside ellipsoid @xmath38 in @xmath15 , with nondegenerate caustics @xmath39 , ",
    ", @xmath40 from the family ( [ eq : confocal.family ] ) , to be perodic with period @xmath41 is : @xmath42 where @xmath43 and all @xmath44 are distinct and positive .      in this section",
    ", we are going to present the generalization of notions of confocal families of quadrics and related billiard trajectories to the projective space over an arbitrary field of characteristic not equal to @xmath45 .",
    "also , we give a proof of the full poncelet theorem in the three - dimensional projective space , based on @xcite .",
    "we begin with the definition of confocal family of quadrics in the projective space , as it was done in @xcite .    [",
    "def : p.confocal ] a family of quadrics in the projective space is _ confocal _ if for any hyper - plane the set of poles with respect to these quadrics is a line .    it can be shown that the dual to a confocal family is a pencil of quadrics .",
    "in contrast to the euclidean case , notice that it follows from there that a confocal family in the projective space is determined by two quadrics .",
    "on the other hand , if we introduce the metrics in a convenient manner in the real projective space @xmath46 , the affine part of a given confocal family in @xmath46 will satisfy definition [ def : e.confocal ] . in this sense , definitions [ def : e.confocal ] and [ def : p.confocal ] are equivalent .    as well as in the euclidean case ,",
    "any line in @xmath47 is also tangent to @xmath1 quadrics from a given confocal family .",
    "we will refer this statement by _",
    "chasles theorem _ , similarly as in the euclidean case , although the second part of theorem [ th : chasles ] has no sense without metrics .",
    "now , we are able to define the billiard reflection in a pure projective manner , without metrics .",
    "let @xmath9 and @xmath48 be two quadrics that meet transversely .",
    "denote by @xmath49 the tangent plane to @xmath9 at point @xmath23 and by @xmath50 the pole of @xmath49 with respect to @xmath48 .",
    "suppose lines @xmath31 and @xmath32 intersect at @xmath23 , and the plane containing these two lines meet @xmath49 along @xmath51 .",
    "if lines @xmath52 are coplanar and harmonically conjugated , we say that rays @xmath31 and @xmath32 _ obey the reflection law _ at the point @xmath23 of the quadric @xmath9 with respect to the confocal family which contains @xmath9 and @xmath48 .",
    "if we introduce a coordinate system in which quadrics @xmath9 and @xmath48 are confocal in the euclidean sense , reflection defined in this way is same as the standard one .",
    "suppose rays @xmath31 and @xmath32 obey the reflection law at @xmath23 of @xmath9 with respect to the confocal system determined by quadrics @xmath9 and @xmath48 .",
    "let @xmath31 intersects @xmath48 at @xmath53 and @xmath54 , @xmath49 is a tangent plane to @xmath9 at @xmath23 , and @xmath50 its pole with respect to @xmath55 .",
    "then lines @xmath56 and @xmath57 respectively contain intersecting points @xmath58 and @xmath59 of ray @xmath32 with @xmath55 .",
    "converse is also true .",
    "let rays @xmath31 and @xmath32 obey the reflection law of @xmath9 with respect to the confocal system determined by quadrics @xmath9 and @xmath48 .",
    "then @xmath31 is tangent to @xmath48 if and only if is tangent @xmath32 to @xmath48 ; @xmath31 intersects @xmath55 at two points if and only if @xmath32 intersects @xmath55 at two points .",
    "next assertion is crucial for proof of the poncelet theorem .",
    "[ double reflection theorem ] [ th : drt ] suppose that @xmath9 , @xmath48 are given quadrics and @xmath31 line intersecting @xmath9 at the point @xmath60 and @xmath48 at @xmath54 .",
    "let @xmath61 , @xmath62 be tangent planes to @xmath9 , @xmath48 at points @xmath60 , @xmath54 respectively , and @xmath63 , @xmath64 their poles with respect to @xmath48 and @xmath9 .",
    "denote by @xmath65 second intersecting point of the line @xmath66 with @xmath9 , by @xmath59 intersection of @xmath67 with @xmath48 and by @xmath32 , @xmath68 , @xmath69 lines @xmath70 , @xmath71 , @xmath72 . then pairs @xmath73 ; @xmath74 ; @xmath75 ; @xmath76 obey the reflection law at points @xmath60 ( of @xmath9 ) , @xmath54 ( of @xmath48 ) , @xmath59 ( of @xmath48 ) , @xmath65 ( of @xmath77 ) respectively .",
    "if the line @xmath31 is tangent to a quadric @xmath34 confocal with @xmath9 and @xmath48 , then rays @xmath32 , @xmath68 , @xmath69 also touch @xmath34 .    using double reflection theorem",
    ", we can prove the full poncelet theorem in the three - dimensional space .",
    "let @xmath78 be confocal quadrics and @xmath79 , ( @xmath80 ) lines such that pairs @xmath81 obey the reflection law at point @xmath82 of @xmath83 .",
    "let @xmath84 be a plane tangent to @xmath85 at @xmath82 , @xmath86 its pole with respect to @xmath34 and @xmath87 . if line @xmath31 intersects @xmath34 at @xmath88 , then , by one reflection theorem , the second intersection point @xmath59 of line @xmath67 with quadrics",
    "@xmath34 belongs to @xmath32 .",
    "similarly , having point @xmath89 , we construct the point @xmath90 .",
    "it follows that @xmath91 or @xmath92 .",
    "suppose @xmath91 .",
    "it can be proved that , if , for a given polygon @xmath93 and quadric @xmath34 , @xmath94 holds , then @xmath94 for any surface @xmath34 from the confocal family .",
    "suppose @xmath95 are rays @xmath96 reflected of @xmath34 at points @xmath89 . by double reflection theorem , @xmath95 and",
    "@xmath97 meet at point @xmath98 and obey the reflection law . in this way , we obtained a new polygon @xmath99 .",
    "if @xmath31 touches quadrics @xmath100 confocal with @xmath101 , then all sides of both polygons touch them . in this way , a two - parameter family of poncelet polygons is obtained .",
    "apart from the real motion of the billiard particle in @xmath102 , it is of interest to consider _ virtual reflections_. these reflections were discussed by darboux in @xcite ( see chapter xiv of book iv in volume 2 ) . in this section , we review some recent results from @xcite .    formally , in the euclidean space",
    ", we can define the _ virtual reflection _ at the quadric @xmath34 as a map of a ray @xmath51 with the endpoint @xmath103 ( @xmath104 ) to the ray complementary to the one obtained from @xmath51 by the real reflection from @xmath34 at the point @xmath103 . on figure [ fig : virtual.real.reflection ]",
    ", ray @xmath105 is obtained from @xmath51 by the real reflection on the quadric surface @xmath34 at point @xmath103 .",
    "ray @xmath106 is obtained from @xmath51 by the virtual reflection .",
    "line @xmath12 is the normal to @xmath34 at @xmath103 .",
    "let us remark that , in the case of real reflections , exactly one elliptic coordinate , the one corresponding to the quadric @xmath36 , has a local extreme value at the point of reflection .",
    "on the other hand , on a virtual reflected ray , this coordinate is the only one not having a local extreme value at the point of reflection . in the @xmath45-dimensional case",
    ", the virtual reflection can easily be described as the real reflection from the other confocal conic passing through the point @xmath103 . in higher dimensional cases ,",
    "the virtual reflection can be regarded as the real reflection from the line normal to @xmath34 at @xmath103 ( see figure [ fig : virtual.real.reflection ] ) .",
    "the notions of real and virtual reflection can not be straightforwardly extended to the projective space , since there we essentially use that the field of real numbers is naturally ordered .",
    "nevertheless , it turns out that it is possible to define a certain configuration connected with real and virtual reflection , such that its properties remain in the projective case , too .",
    "let points @xmath107 ; @xmath108 belong to quadrics @xmath77 , @xmath48 in @xmath47 .",
    "[ def : vrc ] we will say that the quadruple of points @xmath109 constitutes a _ virtual reflection configuration ( vrc ) _ if pairs of lines @xmath110 , @xmath111 ; @xmath112 , @xmath113 ; @xmath110 , @xmath114 ; @xmath111 , @xmath113 satisfy the reflection law at points @xmath115 , @xmath116 of @xmath9 and @xmath117 , @xmath118 of @xmath48 respectively , with respect to the confocal system determined by @xmath9 and @xmath48 .",
    "if , additionally , the tangent planes to @xmath119 at @xmath107 ; @xmath108 belong to a pencil , we say that these points constitute a _",
    "double reflection configuration ( drc ) _",
    "( see figure [ fig : virtual_reflection ] ) .",
    "[ fig : virtual_reflection ]    now , the darboux s statement can be generalized and proved as follows :    [ th : virt.refl ] let @xmath9 , @xmath48 be two quadrics in the projective space @xmath47 , @xmath115 , @xmath116 points on @xmath9 and @xmath117 , @xmath118 on @xmath48",
    ". if the tangent hyperplanes at these points to the quadrics belong to a pencil , then @xmath109 constitute a virtual reflection configuration .",
    "furthermore , suppose that the projective space is defined over the field of reals .",
    "introduce a coordinate system , such that @xmath77 , @xmath48 become confocal ellipsoids in the euclidean space . if @xmath9 is placed inside @xmath48 , then the sides of the quadrilateral @xmath120 obey the real reflection from @xmath48 and the virtual reflection from @xmath48 .",
    "we are going to conclude this section with the statement converse to the previous theorem .",
    "let pairs of points @xmath115 , @xmath116 and @xmath117 , @xmath118 belong to confocal ellipsoids @xmath9 and @xmath48 in euclidean space @xmath15 , and let @xmath121 , @xmath122 , @xmath123 , @xmath124 be the corresponding tangent planes . if a quadruple @xmath125 is a virtual reflection configuration , then planes @xmath121 , @xmath122 , @xmath123 , @xmath124 belong to a pencil .",
    "[ def : gen.cayley ] let @xmath51 be a line not contained in any quadric of the given confocal family in the projective space @xmath47 .",
    "the _ generalized cayley curve _",
    "@xmath126 is the variety of hyperplanes tangent to quadrics of the confocal family at the points of @xmath51 .",
    "this curve is naturally embedded in the dual space @xmath127 .",
    "on figure [ fig : gen.cayley.curve ] , we see the planes which correspond to one point of the line @xmath51 in the @xmath128-dimensional space .        the generalized cayley curve is a hyperelliptic curve of genus @xmath129 , for @xmath130 .",
    "its natural realization in @xmath131 is of degree @xmath132 .",
    "the natural involution @xmath133 on the generalized cayley s curve @xmath126 maps to each other the tangent planes at the points of intersection of @xmath51 with any quadric of the confocal family .",
    "it is easy to see that the fixed points of this involution are hyperplanes corresponding to the @xmath1 quadrics that are touching @xmath51 and to @xmath134 degenerate quadrics of the confocal family .",
    "now , let us make a few remarks on the real case .",
    "[ lema : polinom ] suppose a line @xmath51 is tangent to quadrics @xmath135 from the family ( [ eq : confocal.family ] ) .",
    "then jacobian coordinates @xmath136 of any point on @xmath51 satisfy the inequalities @xmath137 , @xmath138 , where @xmath139    let @xmath23 be a point of @xmath51 , @xmath22 its jacobian coordinates , and @xmath140 a vector parallel to @xmath51 .",
    "the equation @xmath141 is quadratic with respect to @xmath142 .",
    "its discriminant is : @xmath143 where @xmath144 by @xcite , @xmath145 for each of the coordinates @xmath146 , ( @xmath147 ) , the quadratic equation has a solution @xmath148 ; thus , the corresponding discriminants are non - negative .",
    "this is obviously equivalent to @xmath149 .",
    "the equation of the generalized cayley curve corresponding to a confocal family of the form ( [ eq : confocal.family ] ) can be written as : @xmath150 it is important to note that the constants @xmath121 ,  , @xmath151 , corresponding to the quadrics that are touching @xmath51 can not take arbitrary values .",
    "more precisely , following @xcite , we can state :    there exists a line in @xmath15 that is tangent to @xmath1 distinct non - degenerate quadrics @xmath152 ,  , @xmath40 from the family ( [ eq : confocal.family ] ) if and only if the set @xmath153 can be ordered as @xmath154 , such that @xmath155 @xmath156 .",
    "it was observed in @xcite that the generalized cayley curve is isomorphic to the veselov - moser isospectral curve .",
    "this curve is also naturally isomorphic to the curves studied by knrrer , donagi and reid ( rdk curves ) .",
    "we begin next section with the construction of this isomorphism , in order to establish the relationship between billiard law and algebraic structure on the jacobian @xmath157 .",
    "the aim of this section is to construct in @xmath159 an algebraic structure that is naturally connected with the billiard motion . in section [ sekcija : morfizam ] , we show that the generalized cayley s curve is isomorphic to the rdk curve .",
    "then , in order to get better understanding and intuition , we are going first , in section [ sec : genus2 ] to describe in detail the billiard algebra , and prove some of its nice geometrical properties , for the case of dimension @xmath128 , i.e.  when the corresponding curve is of genus @xmath45 .",
    "the general construction is given in the section [ sec : general ] .",
    "now we are going to establish the connection between generalized cayley s curve defined above and the curves studied by knrrer , donagi , reid and to trace out the relationship between billiard constructions and the algebraic structure of the corresponding abelian varieties .",
    "suppose a line @xmath51 in @xmath15 is tangent to quadrics @xmath135 from the confocal family ( [ eq : confocal.family ] ) .",
    "denote by @xmath159 the family of all lines which are tangent to the same @xmath1 quadrics .",
    "note that according to the corollary of the one reflection theorem , the set @xmath159 is invariant to the billiard reflection on any of the confocal quadrics .",
    "we begin with the next simple observation .",
    "[ lema : veza ] let the lines @xmath51 and @xmath160 obey the reflection law at the point @xmath50 of a quadric @xmath34 and suppose they are tangent to a confocal quadric @xmath9 at the points @xmath63 and @xmath161 .",
    "then the intersection of the tangent spaces @xmath162 is contained in the tangent space @xmath163 .",
    "it follows from the one reflection theorem : since the poles @xmath63 , @xmath161 and @xmath164 of the planes @xmath165 , @xmath166 and @xmath167 with respect to the quadric @xmath9 are colinear , the planes belong to a pencil .    following @xcite , together with @xmath1 affine confocal quadrics @xmath135",
    ", one can consider their projective closures @xmath168 and the intersection @xmath169 of two quadrics in @xmath170 : @xmath171 @xmath172    denote by @xmath173 the set of all @xmath174-dimensional linear subspaces of @xmath169 .",
    "for a given @xmath175 , denote by @xmath176 the closure in @xmath177 of the set @xmath178 .",
    "it was shown in @xcite that @xmath176 is a nonsingular hyperelliptic curve of genus @xmath1 .",
    "note that for @xmath179 , i.e.  when the curve @xmath126 is of the genus @xmath45 , an isomorphism between @xmath180 and the jacobian of the hyperelliptic curve was established in @xcite .",
    "the projection @xmath181 maps @xmath182 to a subspace @xmath183 of the codimension @xmath45 .",
    "@xmath184 is tangent to the quadrics @xmath185 that are dual to @xmath186 .",
    "thus , the space dual to @xmath184 , denoted by @xmath187 , is a line tangent to the quadrics @xmath188 .",
    "we can reinterpret the generalized cayley s curve @xmath189 , which is a family of tangent hyperplanes , as a set of lines from @xmath159 which intersect @xmath51 .",
    "namely , for almost every tangent hyperplane there is a unique line @xmath160 , obtained from @xmath51 by the billiard reflection . having this identification in mind , it is easy to prove the following    there is a birational morphism between the generalized cayley s curve @xmath126 and reid - donagi - knrrer s curve @xmath176 , with @xmath190 , defined by @xmath191 where @xmath160 is a line obtained from @xmath51 by the billiard reflection on a confocal quadric .",
    "it follows from the previous lemmata and lemma 4.1 and corollary 4.2 from @xcite .",
    "thus , lemma [ lema : veza ] gives a link between the dynamics of ellipsoidal billiards and algebraic structure of certain abelian varieties .",
    "this link provides a two way interaction : to apply algebraic methods in the study of the billiard motion , but also vice versa , to use billiard constructions in order to get more effective , more constructive and more observable understanding of the algebraic structure .    in the following section",
    ", we are going to use this link in constructing _ the billiard algebra _ , which is a group structure in @xmath159 .",
    "before we proceed in general case , we want to emphasize the billiard constructions involved in the first nontrivial case , of genus two .",
    "we formulate _ the leading principle _ :    _ the sum of the lines in any virtual reflection configuration is equal to zero if the four tangent planes at the points of reflection belong to a pencil . _    recall that , by definition [ def : vrc ] , such a configuration of four lines in a vrc , with tangent planes in a pencil , we are going to call _ a double reflection configuration ( drc)_.    * neutral element *    let us fix a line @xmath192 .",
    "* opposite element *    first , we define @xmath193 .    for a given line @xmath194 ,",
    "define @xmath195 where @xmath196 is the hyperelliptic involution of the curve @xmath197 .",
    "[ prop : saglasnost- ] for any @xmath194 , both lines @xmath23 and @xmath198 are obtained from @xmath199 by the reflection on the same quadric @xmath200 from the confocal family .",
    "moreover , let @xmath201 be the unique plane orthogonal to @xmath199 from the pencil determined by the tangent planes to @xmath200 at the intersection points with @xmath199 , and @xmath202 the unique quadric from the confocal family such that @xmath201 is tangent to it .",
    "then the intersection point of @xmath201 with @xmath199 belongs to @xmath203",
    ".    follows from the degenerate case of double reflection theorem applied on quadrics @xmath200 and @xmath203 with @xmath204 .",
    "see figure [ fig : saglasnost- ] .",
    ", width=226,height=151 ]    plane @xmath201 and quadric @xmath203 do not depend on @xmath23 .",
    "line @xmath199 reflects to itself on @xmath205 .",
    "suppose now that @xmath206 , but @xmath23 does nt belong to @xmath197 . thus @xmath23 does not intersect @xmath199 and the two lines generate a linear projective space .",
    "this space intersects @xmath159 along the divisor @xmath207 ( see , for example , @xcite , @xcite . )    according to the double reflection theorem , one can see that the lines @xmath199 , @xmath23 , @xmath208 , @xmath209 form a double reflection configuration .",
    "we define @xmath198 such that it forms a double reflection configuration with @xmath199 , @xmath210 , @xmath211 .    from the definition",
    ", it is immediately seen that @xmath212 for every @xmath213 .",
    "the following property is a consequence of proposition [ prop : saglasnost- ] and the double reflection theorem .",
    "[ prop : x .- x ] lines @xmath23 and @xmath198 intersect each other and they satisfy the reflection law on @xmath203 .",
    "the following example is an illustration for the construction we have just made .",
    "take the line @xmath199 to be orthogonal to one of the coordinate hyperplanes .",
    "then @xmath214 coincide with this hyperplane and , additionally , among caustics @xmath9 , ",
    ", @xmath14 there can not be two quadrics of the same type .    according to @xcite ,",
    "exactly the case of all quadrics of different type corresponds to the case where @xmath159 consists of only one real connected component , isomorphic to the connected component of zero of @xmath215 .    in this case , for any line @xmath213 , the opposite element @xmath198 may be defined as the line symmetric to @xmath23 with respect to plane @xmath203 .",
    "* addition *    we are going to define operation @xmath216    define @xmath217 , for all @xmath218 .    for @xmath219 ,",
    "define @xmath220 as the line that forms a double reflection configuration with @xmath221 .",
    "obviously , @xmath222 .",
    "notice that @xmath223 are unique lines from @xmath159 that intersect both @xmath220 and @xmath199 ( see @xcite ) .",
    "thus , we have :    [ lema : rastavljanje ] each line @xmath224 can be in the unique way represented as the sum of two lines that intersect @xmath199 .    now , suppose @xmath225 , @xmath226 ( see figure [ fig : partial1 ] ) .",
    "as already explained , take lines @xmath227 such that @xmath228 .",
    "construct @xmath229 as above , since both pairs @xmath230 and @xmath231 intersect @xmath199 .",
    "now both @xmath232 and @xmath233 intersect @xmath3 .",
    "thus , the three lines belong to a drc with the fourth line @xmath50 .",
    "we put by definition @xmath234    the following lemma gives a very important property of the operation .",
    "[ lema : saglasnost ] let @xmath235 be lines in @xmath197 , @xmath159 respectively and @xmath236 the quadric from the confocal family such that @xmath3 and @xmath199 reflect to each other on it . then the lines @xmath237 and @xmath198 intersect each other , their intersection point belongs to quadric @xmath236 , and these two lines satisfy the billiard reflection law on @xmath236 .",
    ", width=226,height=170 ]    follows from @xcite , @xcite and lemma [ lema : veza ] .",
    "lemma [ lema : saglasnost ] is going to play an important role in proving basic properties of the operation :    [ lema : asoc ] for all @xmath238 , the associative law holds : @xmath239 .",
    "denoting , like on figure [ fig : saglasnost ] , by @xmath198 , @xmath232 , @xmath233 lines forming drcs with triplets @xmath240 , @xmath241 , @xmath242 , and applying lemma [ lema : saglasnost ] , we see that @xmath243 is the unique line forming a drc with triplets @xmath244 , @xmath245 , @xmath246 . the same holds for line @xmath247 , thus the two lines coincide .",
    "[ lema:-(p+q+s)=(-p)+(-q)+(-s ) ] let @xmath238",
    ". then @xmath248 .",
    "it is straightforward to prove that @xmath249 if and only if two of the lines @xmath250 are inverse to each other . in this case , the equality we need to prove immediately follows .",
    "thus , suppose @xmath251 does not intersect @xmath199 and that @xmath252 are lines forming a drc with @xmath253 .",
    "by lemma [ lema : saglasnost ] , we have that @xmath251 is the unique line intersecting @xmath254 , @xmath255 and @xmath256 . reflecting @xmath257 on @xmath203 and applying the double reflection theorem",
    ", we get that @xmath258 intersects lines @xmath259 , @xmath260 , @xmath261 .",
    "thus , it is equal to @xmath262 , by lemma [ lema : saglasnost ] .",
    "suppose now two lines @xmath263 are given , none of which is intersecting @xmath199 .",
    "we define their sum as follows .",
    "first , we represent @xmath23 as a sum of two lines intersecting @xmath264 : @xmath265 , @xmath219 .",
    "then , we define : @xmath266    we need to show that this definition is correct .",
    "[ lema : dobrodef ] let @xmath219 , and @xmath267 .",
    "then @xmath268    if @xmath269 , it is enough to apply lemma [ lema : asoc ] and the commutativity property for the addition in @xmath197 .",
    "if @xmath270 , then the lines @xmath271 and @xmath140 intersect with billiard reflection , as well as lines @xmath272 and @xmath140 do . thus , there is a unique , fourth line in the intersection of the space generated by @xmath273 $ ] and @xmath159 . at one hand",
    ", this line is equal to @xmath274 , at the other it is equal to @xmath275 .",
    "now , from lemmata [ lema : asoc][lema : dobrodef ] , it follows that we have constructed on @xmath159 a commutative group structure that is naturally connected with the billiard law .",
    "we started this section with the leading principle , and used it as a natural motivation for the construction of the algebra .",
    "now , we are going to show that this is justified , i.e.  that the statement formulated as the leading principle really holds in the group structure .    [",
    "th : leading ] the sum of the lines in any double reflection configuration is equal to zero .",
    "let @xmath276 be the lines of a drc .",
    "take that pairs @xmath252 and @xmath277 satisfy the reflection law on @xmath9 , and pairs @xmath278 , @xmath279 on @xmath48 .",
    "then , by lemma [ lema : saglasnost ] , we have : @xmath280 where @xmath281 , @xmath282 are obtained from @xmath199 by the billiard reflection on @xmath85 , @xmath283 .",
    "obviously , @xmath284 .    from ( [ eq : drc ] ) , we get : @xmath285 thus , we only need to check the case when @xmath286 and @xmath287 .",
    "then we have : @xmath288 and , from the definition of the addition operation , it follows that lines @xmath289 constitute a closed billiard trajectory with consecutive reflections on @xmath290 . on the other hand",
    ", @xmath291 is the unique line in @xmath158 that , besides @xmath199 , intersects both @xmath292 and @xmath293 .",
    "thus , @xmath294 this means that the double reflection configuration @xmath276 is degenerated , i.e.  two of the lines in the configuration coincide .",
    "say @xmath295 , then both @xmath296 and @xmath2 are obtained from @xmath297 by the billiard reflection on @xmath9 .",
    "so , @xmath298 , @xmath299 and the theorem follows .",
    "let us consider a billiard trajectory @xmath300 with the initial line @xmath301 and the reflections on quadrics @xmath302 from the confocal family .",
    "applying double reflection theorem to @xmath303 , we obtain different trajectories with sharing initial segment @xmath199 and final segment @xmath304 . the reflections on each such a trajectory are also on the same set of quadrics @xmath305 , but their order may be changed .",
    "let us denote by @xmath306 , ",
    ", @xmath307 all possible lines obtained after the first reflection on all these trajectories .",
    "then , in our algebra , the final segment @xmath304 can be calculated from these ones :    [ prop : elln ] @xmath308    follows from theorem [ th : leading ] .",
    "the following interesting property also may be proved from lemmata [ lema : asoc][lema : dobrodef ] .",
    "let line @xmath309 be obtained from @xmath199 by consecutive reflections on three quadrics @xmath9 , @xmath55 , @xmath310",
    ". then the @xmath311 lines obtained from @xmath199 by reflections of the these quadrics may be divided into @xmath45 groups such that :     for each @xmath312 , the lines obtained from @xmath199 by the reflections on @xmath85 are in different groups ;     all trajectories with three reflections on @xmath9 , @xmath48 , @xmath310 starting with @xmath199 and ending with @xmath23 contain lines only from one of the groups .",
    "we will finish this subsection with a very beautiful and non - trivial theorem on confocal families of quadrics .",
    "[ th : zvezda ] let @xmath313 be a family of confocal quadrics in @xmath314 . there exist configurations consisting of @xmath315 planes in @xmath316 with the following properties :    * the planes may be organized in @xmath317 triplets , such that each plane in a triplet is tangent to a different quadric from @xmath313 and the three touching points are collinear .",
    "every plane in the configuration is a member of two triplets . *",
    "the planes may be organized in @xmath311 quadruplets , such that the planes in each quadruplet belong to a pencil and they are tangent to two different quadrics from @xmath313 . every plane in the configuration is a member of two quadruplets .",
    "moreover , such a configuration is determined by three planes tangent to three different quadrics from @xmath313 , with collinear touching points .",
    "denote by @xmath199 the line containing the three touching points and @xmath250 the lines obtained from @xmath199 by the billiard reflection on the given quadrics from @xmath313 .",
    "we construct lines @xmath318 as explained before lemma [ lema : saglasnost ] ( see figure [ fig : saglasnost ] ) .",
    "the planes of the configuration are tangent to corresponding quadrics at points of the intersection of the lines .",
    "the configuration of the planes in the dual space @xmath319 is shown on figure [ fig : zvezda ] .        here ,",
    "each plane is denoted by two lines that reflect to each other on .",
    "it would be interesting to describe the variety of such configurations as a moduli - space .",
    "the genus two case we have just considered in detail gives us the necessary experience of using the billiard constructions to build a group structure .",
    "moreover , it provides us with the case @xmath320 in the general construction we are going to present now .",
    "proposition [ prop : elln ] is going to serve as the motivation for defining the operation in the set @xmath159 for higher - dimensional .",
    "thus , let us now describe in detail the construction that preceded this proposition in section [ sec : genus2 ] .",
    "suppose that quadrics @xmath9 ,  , @xmath321 from the confocal family in @xmath15 are given .",
    "let @xmath322 , @xmath31 , ",
    ", @xmath304 be lines in @xmath159 such that each pair of successive lines @xmath96 , @xmath323 satisfies the billiard reflection law at the quadric @xmath324 ( @xmath325 ) ; thus the lines form billiard trajectory @xmath326 .",
    "let us , for @xmath327 , define lines @xmath307 , @xmath328 , ",
    ", @xmath329 by the procedure , as follows :    \\1 .",
    "set @xmath330 .",
    "@xmath331 , for @xmath332 is the unique line that constitutes a drc with @xmath333 , @xmath334 and @xmath335 .",
    "let us note that , in this way , each line in the sequence @xmath336 is obtained from the previous one by the reflection from @xmath337 respectively .",
    "considering only the initial subsequences @xmath338 ,  , @xmath339 @xmath340 , we may in the same way define lines @xmath341 , ",
    ", @xmath342 .",
    "notice that , for each @xmath343 , @xmath341 intersects @xmath338 , and these two lines obey the reflection law on @xmath344 .    thus , we have constructed a mapping @xmath345 from the set @xmath346 of billiard trajectories with the fixed initial line @xmath301 to the ordered sets of lines from @xmath159 which intersect @xmath199 : @xmath347 where line @xmath341 intersects @xmath199 according to the billiard law on the quadric @xmath344 .    doing the opposite procedure , we define morphism @xmath348 , the inverse of @xmath345 , which assigns to an @xmath12-tuple of lines intersecting @xmath199 the unique billiard trajectory of length @xmath12 with @xmath301 as the initial line : @xmath349 hence , the mapping @xmath348 gives _ the billiard representation _ of an ordered set of lines intersecting @xmath264 .    in order to consider just divisors of the curve @xmath350 , instead of",
    "ordered @xmath12-tuples of lines , we need to introduce the following relation @xmath16 between billiard trajectories : we say that two billiard trajectories are _ @xmath16-equivalent _ if one can be obtained from the other by a finite set of _",
    "double reflection moves_. the double reflection move transforms a trajectory @xmath351 into trajectory @xmath352 if the lines @xmath353 form a double reflection configuration .",
    "it follows directly from the double reflection theorem that two trajectories @xmath354 with the same initial segment @xmath322 are @xmath16-equivalent if and only the @xmath12-tuples @xmath355 and @xmath356 may be obtained from each other by a permutation .",
    "thus , the mapping @xmath345 may be considered as a mapping from @xmath357 to the set of positive divisors on @xmath197 and it represents _ the divisor representation _ of billiard trajectories .",
    "the following lemma , which follows from @xcite , is a sort of riemann - roch theorem in this approach .",
    "[ lema : dijagonala ] a minimal billiard trajectory of length @xmath3 from @xmath23 to @xmath140 is unique , up the relation @xmath16 .",
    "if there are two non @xmath16-equivalent trajectories of the same length @xmath358 from @xmath23 to @xmath140 , then there is a trajectory from @xmath23 to @xmath140 of length @xmath359 .",
    "now , we are able to introduce an operation , _ summation _ , in the set @xmath360 . given two billiard trajectories @xmath361 , we define their sum by the equation : @xmath362 this operation is associative and commutative , according to the double reflection theorem .",
    "the set @xmath363 with the summation operation is a commutative semigroup .",
    "this semigroup is isomorphic to the semigroup of all effective divisors on the curve @xmath197 that do not contain the points corresponding to the caustics .",
    "note that in @xmath360 , the trajectory consisting only of the single line @xmath199 is a neutral element .",
    "define now the following equivalence relation in the set of all finite billiard trajectories .",
    "two billiard trajectories are _ @xmath17-equivalent _ if they have common initial and final segments , and they are of the same length .",
    "the set of all classes of @xmath17-equivalent billiard trajectories of length @xmath12 , with the fixed initial segment @xmath199 , we denote by @xmath364 , and @xmath365    [ prop : beta+ ] the relation @xmath17 is compatible with the addition of billiard trajectories .    to prove this",
    ", we will need the following important lemma :    [ lema : par.nepar ] let @xmath366 be a closed billiard trajectory , and @xmath367 a line that intersects @xmath31 .",
    "construct iteratively lines @xmath368 such that quadruples @xmath369 @xmath370 form double reflection configurations . then @xmath371 .",
    "we are going to proceed with the induction . for @xmath372 , the lines lines",
    "@xmath373 form a double reflection configuration , and the statement follows by the double reflection theorem .    now , suppose @xmath374 .",
    "@xmath375 and @xmath376 are two billiard trajectories of the same length from @xmath31 to @xmath339 .",
    "if they are @xmath16-equivalent , then the claim follows by the double reflection theorem .",
    "if they are not @xmath16-equivalent , then , by lemma [ lema : dijagonala ] , there is a billiard trajectory @xmath377 .",
    "the statement now follows from the inductive hypothesis applied to trajectories @xmath378 and @xmath379    _ proof of proposition [ prop : beta+]_. we need to prove the following : @xmath380 clearly , it is enough to prove this relation for the case when @xmath381 and the length of @xmath382 is equal to @xmath45 .",
    "suppose that @xmath383 , where @xmath208 is obtained from @xmath199 by the reflection on quadric @xmath384 .",
    "then trajectories @xmath385 , @xmath386 are obtained by adding one segment to @xmath387 , @xmath388 respectively .",
    "these segments satisfy the reflection law on @xmath389 with the final segments of @xmath387 , @xmath388 . since @xmath390 ,",
    "their final segments coincide and the statement follows from lemma [ lema : par.nepar ] applied to the trajectory @xmath391 where @xmath392 , @xmath393 .",
    "@xmath394      we wish to use the constructed algebra on the set of billiard trajectories , in order to obtain an algebraic structure on @xmath158 , such that the operation is naturally connected with the billiard reflection law .    from @xcite we get    [ teorema : dostiznost ] for any two given lines @xmath23 and @xmath140 from @xmath159 , there is a system of at most @xmath1 quadrics from the confocal family , such that the line @xmath140 is obtained from @xmath23 by consecutive reflections on these quadrics .",
    "the divisor representation of the corresponding billiard trajectory of length @xmath395 will be called _",
    "the @xmath3-brush of @xmath140 related to @xmath23_.    now , we can define a group structure in @xmath159 associated with a fixed line in this set .",
    "_ neutral element _",
    "let us fix a line @xmath396    _ inverse element _",
    "let @xmath23 be an arbitrary line in @xmath159 , and @xmath397 the divisor representation of the minimal billiard trajectory connecting @xmath199 with @xmath23 .",
    "define @xmath198 as the final segment of the billiard trajectory @xmath398 , where @xmath399 is the hyperelliptic involution of @xmath197 .",
    "_ addition _    for two lines @xmath23 and @xmath140 from @xmath159 , denote their brushes related to @xmath199 as @xmath400 and @xmath401 .",
    "define @xmath402 where @xmath403 is the final segment of the billiard trajectory @xmath404 .",
    "from all above , similarly as in the genus @xmath45 case , we get    the set @xmath159 with the operation defined above is an abelian group .",
    "let us observe that another kind of divisor representation of billiard trajectories may be introduced , that associates a divisor of degree @xmath405 to a given trajectory .",
    "such a representation was used in @xcite and explicitly described in @xcite .",
    "the positive part of this representation coincide with the divisor obtained by @xmath348 , and the negative part is invariant for the hyperelliptic involution .",
    "moreover , as it follows from @xcite , two trajectories with the initial segment @xmath199 will have the same final segments if and only if their representations are equivalent divisors .",
    "thus , it follows that the group structure on @xmath159 is isomorphic to the quotient of the jacobian of the curve @xmath197 by a finite subgroup which is generated by the points corresponding to the caustic quadrics .",
    "now , as a consequence of theorem [ teorema : dostiznost ] we are able to introduce the following hierarchies of notions .",
    "[ definicija : s - mimoilaznost ] for two given lines @xmath23 and @xmath140 from @xmath159 we say that they are _",
    "@xmath3-skew _ if @xmath3 is the smallest number such that there exist a system of @xmath406 quadrics @xmath344 , @xmath407 from the confocal family , such that the line @xmath140 is obtained from @xmath23 by consecutive reflections on @xmath344 . if the lines @xmath23 and @xmath140 intersect , they are _",
    "@xmath405-skew_. they are _",
    "@xmath408-skew _ if they coincide .",
    "[ definicija : s - poncelet ] suppose that a system @xmath409 of @xmath12 quadrics @xmath9 , ",
    ", @xmath321 from the confocal family is given .",
    "for a system of lines @xmath410 , @xmath411 ,  , @xmath412 in @xmath159 such that each pair of successive lines @xmath413 , @xmath414 satisfies the billiard reflection law at @xmath324 @xmath415 , we say that it forms an _",
    "@xmath3-weak poncelet trajectory of length @xmath12 associated to the system @xmath409 _ if the lines @xmath410 and @xmath412 are @xmath3-skew .    for @xmath3-weak poncelet trajectories we will also sometimes say _",
    "@xmath416-resonant billiard trajectories_. periodic trajectories or generalized classical poncelet polygons are @xmath408-weak poncelet trajectories or , in other words , @xmath417-resonant billiard trajectories , and they are described analytically in @xcite , @xcite .    our next goal is to get complete analytical description of @xmath3-weak poncelet trajectories of length @xmath418 , generalizing in such a way the results from @xcite . here , we are going to use fully the tools and the power of billiard algebra .",
    "to fix the idea , let us consider first the system @xmath409 consisting on @xmath418 equal quadrics @xmath419 from the confocal family .",
    "suppose a system of lines @xmath410 , @xmath420 , ",
    ", @xmath421 in @xmath159 forms an @xmath3-weak poncelet trajectory of length @xmath418 associated to the system @xmath409 .",
    "then @xmath422 with some line @xmath423 which intersects @xmath410 .",
    "again , from the condition that @xmath421 and @xmath410 are @xmath3-skew we get @xmath424 with some lines @xmath425 which intersect @xmath410 . from the last two equations we come to the conclusion    [ propozicija : kejli1 ] the existence of an @xmath3-weak poncelet trajectory of length @xmath418 is equivalent to existence of a meromorphic function @xmath426 on the hyperelliptic curve @xmath126 such that @xmath426 has a zero of order @xmath418 at @xmath427 , a unique pole at  infinity \" @xmath428 , and the order of the pole is equal to @xmath429 .",
    "now , we are going to derive explicit analytical condition of cayley s type . as in @xcite",
    "we consider the space @xmath430 of all meromorphic functions on @xmath126 with the unique pole at the infinity point @xmath428 of the order not exceeding @xmath12 .",
    "let @xmath431 be one of the bases of this space , @xmath432 .",
    "consider the vectors @xmath433 where @xmath434 and vectors @xmath435 with @xmath436 . from the condition ( see @xcite ) @xmath437<n - g+1\\ ] ] we get the condition @xmath438<r+s - g+2=r+s - d+3.\\ ] ]    now , we can rewrite it in the form usual for the cayley s type conditions .",
    "[ teorema : kejlijevi.uslovi ] the existence of an @xmath3-weak poncelet trajectory of length @xmath418 is equivalent to : @xmath439 when @xmath440 , and @xmath441 when @xmath442 .    with @xmath443 , we denoted the coefficients in the taylor expansion of function @xmath444 in a neighbourhood of @xmath35 , where @xmath445 is the equation of the generalized cayley curve , with the polynomial @xmath446 given by ( [ eq : polinom ] ) .",
    "denote by @xmath447 the linear space of all meromorphic functions on @xmath126 , having a unique pole at the infinity point @xmath428 , with the order not exceeding @xmath448 . by the riemann - roch theorem :    * @xmath449 + 1 $ ] if @xmath450 , * @xmath451 if @xmath448 is even and greater than @xmath452 , * @xmath453 if @xmath448 is even and greater than @xmath452 .",
    "we may choose the following bases in each of the three cases :    * @xmath454 , where @xmath455\\le d$ ] ; * @xmath456 , for @xmath457 ; * @xmath458 , for @xmath459 .",
    "now , the statement follows from the considerations preceding the theorem .    for @xmath460 , the inequalities in theorem [ teorema : kejlijevi.uslovi ] become the conditions for periodic billiard trajectories ( see @xcite ) .",
    "the condition for existence of a @xmath461-weak poncelet trajectory of length @xmath418 is equivalent to : @xmath462 @xmath463    if @xmath464 , then , as it follows from the proof of theorem [ teorema : kejlijevi.uslovi ] , an @xmath3-weak poncelet trajectory of length @xmath418 may exist only if the hyper - elliptic curve @xmath189 is singular .      in this section",
    "we obtain higher dimensional generalizations of the results of @xcite , @xcite , @xcite",
    ". nice exposition of those classical results one can find in @xcite . the dual version of @xcite is given in @xcite .",
    "each quadric @xmath34 in @xmath170 contains at most two unirational families of @xmath417-dimensional linear subspaces .",
    "such unirational families are usually called _",
    "rulings of the quadric_.    [ th : gen.weyr ] let @xmath9 , @xmath48 be two general quadrics in @xmath170 with the smooth intersection @xmath169 and @xmath465 , @xmath466 their rulings . if there exists a closed chain @xmath467 of distinct @xmath417-dimensional linear subspaces , such that @xmath468 , @xmath469 @xmath470 and @xmath471 @xmath472 , then there are such closed chains of subspaces of length @xmath473 through any point of @xmath180 .",
    "each of the unirational families @xmath474 determines an involution @xmath475 on abelian variety @xmath180 .",
    "such an involution interchanges two @xmath174-intersections of an element of @xmath476 with @xmath169 .",
    "denote by @xmath477 their composition and by @xmath478 .",
    "since @xmath479 is a translation on @xmath180 satisfying @xmath480 we see that @xmath479 is of order @xmath12 and the theorem follows .",
    "we will call the chains considered in theorem [ th : gen.weyr ] _ generalized weyr s chains_.    the theorem can be adjusted for nonsmooth intersections , but we are not going into details . instead , we consider the case of two quadrics ( [ eq : kvadrika1 ] ) and ( [ eq : kvadrika2 ] ) as in section [ sekcija : morfizam ] . by using the projection @xmath481 we get :    [ propozicija : weyr.poncelet ] a generalized weyr chain of length @xmath473 projects into a poncelet polygon of length @xmath473 circumscribing the quadrics @xmath168 and alternately inscribed into two fixed confocal quadrics ( projections of @xmath482 ) .",
    "conversely , any such a poncelet polygon of the length @xmath473 circumscribing the quadrics @xmath168 and alternately inscribed into two fixed confocal quadrics can be lifted to a generalized weyr chain of length @xmath473 .",
    "it follows from lemma 4.1 and corollary 4.2 of @xcite and lemma [ lema : veza ] .",
    "thus , we obtained in a correspondence between generalized weyr chains and poncelet polygons subscribed in @xmath1 given quadrics and alternately inscribed in two quadrics from some confocal family .",
    "such poncelet polygons have been completely analytically described , among others , in @xcite ( see example 4 from there ) .",
    "let us note that correspondence between classical weyr s theorem in @xmath314 and classical poncelet theorem about two conics in a plane was observed by hurwitz in @xcite .",
    "nevertheless the projection we used here is not a straightforward generalization of the one used by hurwitz .",
    "polygonal lines , circumscribed about one conic and alternately inscribed in two conics , appear as an example in @xcite .",
    "our result , applied to the lowest dimension , gives the condition for the closeness of such a polygonal line , see corollary 1 from @xcite .",
    "let us also mention that if rulings @xmath483 and @xmath484 are connected by a generalized weyr s chain of length @xmath473 , then the same is true for @xmath466 , @xmath483 and also for the pair @xmath485 , @xmath486 of the complementary rulings of @xmath9 and @xmath48 .",
    "now we are able to present a new higher - dimensional generalization of the griffiths - harris space poncelet theorem from @xcite .",
    "[ teorema : uopstena.grifits.haris ] let @xmath487 and @xmath488 be the duals of two general quadrics in @xmath170 with the smooth intersection @xmath169",
    ". denote by @xmath489 pairs of unirational families of @xmath417-dimensional subspaces of @xmath490 .",
    "suppose there are generalized weyr s chains between @xmath483 and @xmath466 and between @xmath483 and @xmath486 .",
    "then there is a finite polyhedron inscribed and subscribed in both quadrics @xmath9 and @xmath48 .",
    "there are infinitely many such polyhedra .",
    "the polyhedra from the previous theorem can be described in more details as arrangements of @xmath2-dimensional  faces \" which are bitangents of the quadrics @xmath9 and @xmath48 .",
    "their intersections are @xmath417-dimensional  edges \" which alternately belong to the rulings of @xmath487 and @xmath488 . the intersections of  edges \" are @xmath174-dimensional  vertices \" which belong to @xmath180 .",
    "the proof of the last theorem is based on the following lemma from @xcite .",
    "[ lema : odredjenost ] let @xmath491 be a quadric of the rank not less than @xmath132 and @xmath492 a linear subspace of the dimension @xmath493 .",
    "if @xmath34 is singular , suppose additionally that @xmath23 does not contain the vertex .",
    "then , for each ruling @xmath494 of @xmath34 , there is a unique @xmath417-dimensional linear subspace @xmath495 such that @xmath496 and @xmath497 .        in @xcite ( volume 3 , book vi , chapter i ) ,",
    "darboux proved that liouville surfaces are exactly these having an orthogonal system of curves that can be regarded in two or , equivalently , infinitely many different ways , as geodesic conics .",
    "these coordinate curves are analogues of systems of confocal conics in the euclidian plane . knowing this , essential properties of conics may be generalized to all liouville surfaces ( see @xcite , and also @xcite for a review and clarifications ) .",
    "here is the citation of one of these properties :    _ `` considerons un polygone variable do nt tous les cts sont des lignes godsiques tangentes a une mme courbe coordonne .",
    "le dernier sommet de ce polygone dcrira aussi une des courbes coordonnes et il en sera de mme de points dintersection de deux cts quelconques de ce polygone . '' _",
    "this statement is not only the generalization of poncelet theorem to liouville surfaces .",
    "additionally , for a poncelet polygon circumscribed about a fixed coordinate curve , with each vertex moving along one of the coordinate curves , darboux stated here that the intersection point of two arbitrary sides of the polygon is also going to describe a coordinate curve .",
    "let us note that a weaker version of this claim , although with some improvements , has been recently rediscovered in @xcite , and a more elementary proof of the result from @xcite has been published in @xcite .",
    "the main theorem of @xcite corresponds only to a fixed poncelet polygon associated to a pair of ellipses in the euclidean plane . in a sense",
    ", this gives a new argument in favour of our observation in @xcite and @xcite , that the work of darboux connected with billiards and poncelet theorem seems to be unknown to nowadays mathematicians .",
    "this section is devoted to a multi - dimensional generalization of the darboux theorem , related to billiard trajectories within an ellipsoid in the @xmath2-dimensional euclidean space .      before starting with higher - dimensional generalizations ,",
    "let us give some improvements together with a simpler proof of the statement corresponding to the plane case .",
    "[ th : gen.grida ] let @xmath498 be an ellipse in @xmath499 and @xmath500 , @xmath501 be two sequences of the segments of billiard trajectories @xmath498 , sharing the same caustic . then all the points @xmath502 @xmath503 belong to one conic @xmath504 , confocal with @xmath498 .",
    "moreover , under the additional assumption that the caustic is an ellipse , we have : if both trajectories are winding in the same direction about the caustic , then @xmath504 is also an ellipse ; if the trajectories are winding in opposite directions , then @xmath504 is a hyperbola .",
    "( see figure [ fig : grida_elipsa ] . )            for a hyperbola as a caustic , it holds : if segments @xmath505 , @xmath506 intersect the long axis of @xmath498 in the same direction , then @xmath504 is a hyperbola , otherwise it is an ellipse .",
    "( see figure [ fig : grida_hip ] . )",
    "the statement follows by application of the double reflection theorem .",
    "namely , the lines @xmath507 and @xmath508 intersect at a point that belongs to one ellipse and one hyperbola from the confocal family .",
    "they satisfy the reflection law on exactly one of these two curves , depending on the orientation of the billiard motion along the lines .",
    "now , by the double reflection theorem , @xmath19 and @xmath509 satisfy the reflection law on the same conic .",
    "the same is true , for any pair @xmath505 , @xmath506 , by the induction .",
    "for the second part of the theorem , it is sufficient to observe that the winding direction about an ellipse is changed by the reflections on the hyperbolae , and preserved by the reflections on the ellipses from the confocal family .",
    "if an oriented line is placed between the foci , then the direction it is intersecting the axis containing the foci is changed by the reflections of the ellipses and preserved by the reflections on the hyperbolae .",
    "let @xmath500 , @xmath510 be two sequences of the segments of billiard trajectories within the ellipse @xmath498 , sharing the same caustic .",
    "if the caustic is an ellipse and the trajectories are winding in the opposite directions about it , then all the points @xmath502 @xmath511 are placed on two centrally symmetric half - branches of a hyperbola confocal with @xmath498 .",
    "denote by @xmath512 the ellipse which is the common caustic of the given billiard trajectories .",
    "it is possible to introduce a metric @xmath513 on @xmath512 , such that @xmath514 if and only if the tangent lines at @xmath515 and at @xmath516 intersect on the same ellipse of the confocal family . in particular , this means that the points where two consecutive billiard segments touch the caustic @xmath517 are always at the fixed distance from each other .",
    "take that @xmath507 and @xmath508 intersect on the upper left half - branch of the hyperbola @xmath504 ( see figure [ fig : grida_elipsa ] ) .",
    "then it may be proved from the double reflection theorem , that each touching points of these two segments with caustic @xmath517 are at equal @xmath513-distances from the upper left intersection point of @xmath504 and @xmath512 . since @xmath513 is symmetric with respect to the coordinate centre",
    ", they are also equally distanced from the lower right intersection point , but not from the other two intersection points .",
    "the same holds for any pair @xmath518 .",
    "thus , their intersections lies on two centrally symmetric half - branches of the hyperbola .",
    "now , the generalized claim about poncelet - darboux grids is immediately following from theorem [ th : gen.grida ] .",
    "[ th : grida ] let @xmath519 be the sequence of segments of a billiard trajectory within the ellipse @xmath498 .",
    "then each of the sets @xmath520 , @xmath521 , @xmath522 belongs to a single conic confocal to @xmath498 .",
    "if the caustic of the trajectory @xmath523 is an ellipse , then the sets @xmath524 are placed on ellipses and @xmath525 on hyperbolae .",
    "if the caustic is a hyperbola , then the sets @xmath526 , @xmath525 are placed on ellipses for @xmath343 even and on hyperbolae for @xmath343 odd .    to show the statement for @xmath524 ,",
    "take @xmath527 , @xmath528 and apply theorem [ th : gen.grida ] . for @xmath529 ,",
    "take @xmath527 , @xmath530 .",
    "notice that theorem [ th : grida ] is more general then the one given in @xcite , since we do not suppose that the billiard trajectory is closed .",
    "also , the statement can be formulated for an arbitrary conic , not only for an ellipse .",
    "the main statement proved in @xcite and @xcite is a special case consequence of theorem [ th : grida ] :    let @xmath523 be a closed billiard trajectory within an ellipse , with the elliptical caustic .",
    "each set @xmath524 lie on an ellipse confocal to @xmath498 , and @xmath525 on a confocal hyperbola .",
    "_ ( see figure [ fig : grida_elipsa ] ) .",
    "_    let us show one interesting property of poncelet - darboux grids .",
    "let @xmath523 be a billiard trajectory within ellipse @xmath498 , with the elliptical caustic @xmath512 .",
    "then the ellipse containing the set @xmath524 depends only on @xmath343 , @xmath498 and @xmath512 . in other words",
    ", this ellipse will remain the same for any choice of billiard trajectory within @xmath498 with the caustic @xmath512 .",
    "this claim may be proved by the use of the double reflection theorem , similarly as in theorem [ th : gen.grida ] .",
    "nevertheless , we are going to show it in another way , that gives a possibility of explicit calculation of the ellipse containing @xmath524 .    to the billiard within @xmath498 with the fixed caustic @xmath531 , we may associate an elliptic curve ( see @xcite ) .",
    "each point of the curve corresponds to a conic from the confocal family . on the other hand",
    ", the billiard motion may be viewed as the linear motion on the jacobian of the curve ( i.e.  on the curve itself , since this is the elliptic case ) , with translation jumps corresponding to reflections .",
    "more precisely , the translation is exactly by this value on the elliptic curve , which is associated to the ellipse that a segment is reflected on .",
    "thus , if the point @xmath532 on the elliptic curve is associated to the ellipse @xmath498 , then the set @xmath524 is placed on the ellipse corresponding to @xmath533 .",
    "although theorem [ th : gen.grida ] gives certain progress in understanding of poncelet - darboux grids , the essential breakthrough in this matter represents , in our opinion , the study of the higher - dimensional situation .",
    "this analysis is based on introduction of higher - dimensional analogues of grids and our notion of @xmath3-skew lines .",
    "[ th : gen.grida.d ] let @xmath500 , @xmath501 be two sequences of the segments of billiard trajectories within the ellipsoid @xmath498 in @xmath15 , sharing the same @xmath1 caustics .",
    "suppose the pair @xmath534 is @xmath3-skew , and that by the sequence of reflections on quadrics @xmath535 the minimal billiard trajectory connecting @xmath507 to @xmath508 is realized .",
    "then , each pair @xmath536 is @xmath3-skew , and the minimal billiard trajectory connecting these two lines is determined by the sequence of reflections on the same quadrics @xmath535 .",
    "this may be proved by the use of the double reflection theorem , similarly as in theorem [ th : gen.grida ] .",
    "this theorem also can be stated for an arbitrary quadric , not only for ellipsoids .",
    "let @xmath498 be an ellipsoid in @xmath15 , @xmath537 quadrics confocal to @xmath498 , and @xmath343 an integer .",
    "suppose that there exists a trajectory @xmath523 of the billiard within @xmath498 , having the caustics @xmath537 , such that the pair @xmath538 is @xmath3-skew and that the minimal billiard trajectory connecting @xmath338 to @xmath339 is realized by the sequence of reflections on quadrics @xmath539 confocal to @xmath498 .",
    "then , for any billiard trajectory @xmath540 within @xmath498 with the caustics @xmath9 ,",
    " , @xmath14 , the pairs of lines @xmath541 are @xmath3-skew and the minimal billiard trajectory between @xmath542 and @xmath543 is realized by the sequence of reflections on @xmath539 .",
    "_ `` one of the most important and also most beautiful theorems in classical geometry is that of poncelet ( ... ) his proof was synthetic and somewhat elaborate in what was to become the predominant style in projective geometry of last century .",
    "slightly thereafter , jacobi gave another argument based on the additional theorem for elliptic functions .",
    "in fact , as will be seen below , the poncelet theorem and additional theorem are essentially equivalent , so that at least in principle poncelet gave a synthetic derivation of the group law on an elliptic curve . because of the appeal of the poncelet theorem it seems reasonable to look for higher - dimenisonal analogues",
    "... although this has not yet turned out to be the case in the poncelet - type problems ... '' _      usually , the poncelet theorem is associated with the points of finite order on an elliptic curve . however",
    ", our analysis from the section [ sekcija : bilijarskaalgebra ] shows that a poncelet polygon should be understood as a pair of equivalent divisors and through a billiard analogue of the abel theorem it can further be associated to a meromorphic function of a hyperelliptic curve . on the other hand , the billiard analogue of the riemann - roch theorem gives uniqueness of the billiard trajectory with minimal number of lines connecting two given lines in @xmath159 .",
    "thus , the poncelet story in higher dimensions is at least as rich as a story of meromorphic functions on hyperelliptic curves .",
    "such a deep relationship between hyperelliptic jacobians and pencils of quadrics through integrable billiard systems opens a new view to the well - known , but still amazing role of elliptic coordinates in the theory of integrable systems and in the separation of variables in hamilton - jacobi method .",
    "the question of synthetic approach to the addition law on nonhyperelliptic jacobians remains open and could lead to new methods of separation of variables .",
    "* the family of all lines in @xmath15 which are tangent to given @xmath1 confocal quadrics ( see section [ sekcija : morfizam ] ) * the generalized cayley curve ( see definition [ def : gen.cayley ] in section [ gen.lebeg ] ) * the @xmath2-dimensional euclidean space * the set of all @xmath174-dimensional linear subspaces of the intersection @xmath169 of two quadrics in @xmath170 ( see lemma [ lema : veza ] in section [ sekcija : morfizam ] ) * the @xmath2-dimensional projective space * the dual @xmath2-dimensional projective space * a quadric * the quadric dual to @xmath34 * a quadric from the family ( [ eq : confocal.family ] ) of confocal quadrics in @xmath15 ( see definition [ def : e.confocal ] from section [ sec : confocal.e ] )      the research was partially supported by the serbian ministry of science and technology , project _ geometry and topology of manifolds and integrable dynamical systems_. one of the authors ( m.r . )",
    "acknowledges her gratitude to prof .",
    "v.  rom - kedar and the weizmann institute of science for the kind hospitality and support during the work on this paper .",
    "the authors would like to thank the referee for the valuable remarks and suggestions , which improved the manuscript .",
    "v. m. buchhstaber , v. z. enolskii , d. v. leykin _ hyperelliptic kleinian functions and applications _ ,",
    "10 , part 2 , pp . 1 - 125 , ed . i. m. krichever , s. p. novikov , gordon and breach , 1997                    v. dragovi , m. radnovi , _ cayley - type conditions for billiards within @xmath343 quadrics in @xmath544 _ , j. of phys",
    ". a : math . gen .",
    "* 37 * ( 2004 ) , 1269 - 1276 . v. dragovi , m. radnovi , _ corrigendum : cayley - type conditions for billiards within @xmath343 quadrics in @xmath544 _ , j. of phys .",
    "a : math . gen .",
    "* 38 * ( 2005 ) , 7927 .",
    "arxiv : math - ph/0503053"
  ],
  "abstract_text": [
    "<S> the thirty years old programme of griffiths and harris of understanding higher - dimensional analogues of poncelet - type problems and synthetic approach to higher genera addition theorems has been settled and completed in this paper . starting with the observation of the billiard nature of some classical constructions and configurations , we construct _ the billiard algebra _ , that is a group structure on the set @xmath0 of lines simultaneously tangent to @xmath1 quadrics from a given confocal family in the @xmath2-dimensional euclidean space . using this tool , </S>",
    "<S> the related results of reid , donagi and knrrer are further developed , realized and simplified . </S>",
    "<S> we derive a fundamental property of @xmath0 : any two lines from this set can be obtained from each other by at most @xmath1 billiard reflections at some quadrics from the confocal family . </S>",
    "<S> we introduce two hierarchies of notions : _ </S>",
    "<S> @xmath3-skew lines _ in @xmath0 and _ @xmath3-weak poncelet trajectories _ , @xmath4 . </S>",
    "<S> the interrelations between billiard dynamics , linear subspaces of intersections of quadrics and hyperelliptic jacobians developed in this paper enabled us to obtain higher - dimensional and higher - genera generalizations of several classical genus @xmath5 results : cayley s theorem , weyr s theorem , griffiths - harris theorem and darboux theorem .    </S>",
    "<S> mathematical institute sanu    kneza mihaila 36 , 11000 belgrade , serbia    e - mail : vladad@mi.sanu.ac.yu , milena@mi.sanu.ac.yu    the corresponding author :    vladimir dragovi    mathematical institute sanu    kneza mihaila 36 , 11000 belgrade , serbia    e - mail : vladad@mi.sanu.ac.yu    phone : + 381 11 2630170    fax : + 381 11 2186105 </S>"
  ]
}