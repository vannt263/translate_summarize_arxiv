{
  "article_text": [
    "photoacoustic tomography is an emerging imaging technique that combines the good contrast of optical absorption with the resolution of ultrasound images ( see for instance @xcite ) . in experiments",
    "an object is irradiated by a short - pulsed laser beam .",
    "depending on the absorption properties of the material , some light energy is absorbed and converted into heat .",
    "this leads to a thermoelastic expansion , which causes a pressure rise , resulting in an ultrasonic wave , called photoacoustic signal .",
    "the signal is detected by an array of ultrasound transducers outside the object . using this signal the pressure distribution at the time of the laser excitation",
    "is reconstructed , offering a 3d image proportional to the amount of absorbed energy at each position .",
    "this is the imaging parameter of photoacoustics .",
    "common measurement setups rely on small ultrasound sensors , which are arranged _ uniformly _ along simple geometries , such as planes , spheres , or cylinders covering the specimen of interest ( see for instance @xcite below ) .    for the planar arrangement of point - like",
    "detectors there exist several approaches for reconstruction , including numerical algorithms based on filtered backprojection formulas and time - reversal algorithms ( see for instance @xcite ) .",
    "the suggested algorithm in the present work realizes a fourier inversion formula ( see below ) using the _ non - uniform fast fourier transform _ ( nufft ) .",
    "this method has been designed for evaluation of fourier transforms at non - equispaced points in frequency domain , or non - equispaced data points in spatial , respectively temporal domain .",
    "the prior is called ner - nufft ( non - equispaced range - non uniform fft ) , whereas the latter is called ned - nufft ( non - equispaced data - non uniform fft ) .",
    "both algorithms have been introduced in @xcite .",
    "both nufft methods haven proven to achieve high accuracy and simultaneously reach the computational efficiency of conventional fft computations on regular grids @xcite . this work investigates photoacoustic reconstructions from ultrasound signals recorded at _ non - equispaced _ positions on a planar surface .",
    "to the best of our knowledge , this is a novel research question in photoacoustics , where the use of regular grids is the common choice . for the reconstruction",
    "we propose a novel combination of ned- and ner - nufft , which we call nedner - nufft , based on the following considerations :    1 .",
    "the discretization of the analytic inversion formulas ( see ) contains evaluation at non - equidistant sample points in frequency domain .",
    "2 .   in addition , and this comes from the motivation of this paper , we consider evaluation at non - uniform sampling points .",
    "the first issue can be solved by a ner - nufft implementation : for * 2d * photoacoustic inversion with * uniformly * placed sensors on a measurement * line * such an implementation has been considered in @xcite .",
    "this method was used for biological photoacoustic imaging in @xcite . in both papers the imaging could be realized in 2d because integrating line detectors @xcite have been used for data recording . in this paper , however , the focus is on 3d imaging , because measurements are taken with point sensors .",
    "experimentally , we show the applicability and superiority of the ( ned)ner - nufft reconstruction formula in three spatial dimensions , compared with standard interpolation fft reconstruction .",
    "to be precise , in this paper we conduct _ three dimensional _ imaging implemented using nedner - nufft , with ultrasound detectors aligned _ non - uniformly _ on a measurement plane . to easily assess the effect of a given arrangement ,",
    "also 2d numerical simulations have been conducted , to support the argumentation .",
    "we quantitatively compare the results with other computational imaging methods : as a reference we use the @xmath0-wave toolbox @xcite with a standard fft implementation of the inversion algorithm .",
    "the nedner - nufft yields an improvement of the lateral and axial resolution ( the latter even by a factor two ) .",
    "the outline of this work is as follows :    in section [ sec : reconst ] we outline the basics of the fourier reconstruction approach by presenting the underlying photoacoustic model .",
    "we state the fourier domain reconstruction formula in a continuous setting .",
    "moreover , we figure out two options for its discretization .",
    "we point out the necessity of a fast and accurate algorithm for computing the occurring discrete fourier transforms with non - uniform sampling points .    in section [ sec : nufft ]",
    "we briefly explain the idea behind the nufft .",
    "we state the ner - nufft ( subsection [ subsec : ner_nufft ] ) and ned - nufft ( subsection [ subsec : ned_nufft ] ) formulas in the form we need it to realize the reconstruction on a non - equispaced grid .    in section",
    "[ sec : comp1_ner_nufft ] we discuss the 3d experimental setup .",
    "the ner - nufft is compared with conventional fft reconstruction .",
    "a test chart is used to quantify resolution improvements in comparison to the _ k - wave _ fft reconstruction with linear interpolation . in axial direction",
    "this improvement was about 170% while reducing the reconstruction time by roughly 35% .    in section [ sec : comp2_ned_nufft ]",
    "we then turn to the nedner - nufft in 2d with simulated data , in order to test different sensor arrangements in an easily controllable environment .",
    "an equiangular arrangement turns out to yield an improvement of over 40% compared to the best choice of equispaced sensor arrangement .",
    "furthermore , we use the insights gained from the 2d simulations to develop an equi - steradian sensor arrangement for our 3d measurements .",
    "we apply our nedner - nufft approach on these data and quantitatively compare the outcomes with reconstructions from equispaced data obtained by the ner - nufft approach .",
    "our results show a significant improvement of the already superior ner - nufft .",
    "let @xmath1 be an open domain in @xmath2 , and @xmath3 a @xmath4 dimensional hyperplane not intersecting @xmath5 .",
    "mathematically , photoacoustic imaging consists in solving the operator equation @xmath6=p|_{\\gamma\\times(0,\\infty)}\\,,\\ ] ] where @xmath7 is a function with compact support in @xmath5 and @xmath8 $ ] is the trace on @xmath9 of the solution of the equation    @xmath10    in other words , the photoacoustic imaging problem consists in identifying the initial source @xmath7 from measurement data @xmath11 .",
    "an explicit inversion formula for @xmath12 in terms of the fourier transforms of @xmath7 and @xmath13 $ ] has been found in @xcite .",
    "let @xmath14 .",
    "assume without loss of generality ( by choice of proper basis ) that @xmath3 is the hyperplane described by @xmath15 .",
    "then the reconstruction reads as follows : @xmath16\\left(\\bm{k}\\right)= \\frac{2k_{y}}{\\kappa\\left(\\bm{k}\\right)}\\mathbf{f}[\\mathbf{q}f]\\left(\\bm k_{\\bm x},\\kappa\\left(\\bm{k}\\right)\\right).\\end{aligned}\\ ] ] where @xmath17 denotes the @xmath18-dimensional fourier transform : @xmath19\\left(\\bm{k}\\right):=\\frac1{(2\\pi)^{n/2}}\\int\\limits_{\\mathbb{r}^{d}}{{\\mathrm{e}}}^{-{{\\mathrm{i}}}\\bm{k}\\cdot(\\bm{x},y)}f(\\bm{x})\\mathrm{d}\\bm{x}\\,,\\end{aligned}\\ ] ] and @xmath20 here , the variables @xmath21 are in @xmath22 , whereas @xmath23 .    for the numerical realization these three steps have to be realized in discrete form",
    ": we denote evaluations of a function @xmath24 at sampling points @xmath25 by @xmath26 for convenience , we will modify this notation in case of evaluations on an equispaced cartesian grid .",
    "we define the @xmath18-dimensional grid @xmath27 and assume our sampling points to be located on @xmath28 , where @xmath29 and write @xmath30 where @xmath31 resp .",
    "@xmath32 are the occurring step sizes .    in frequency domain , we have to sample symmetrically with respect to @xmath33 .",
    "therefore , we also introduce the interval @xmath34 since we will have to deal with evaluations that are partially in - grid , partially not necessarily in - grid , we will also use combinations of and . in this paper , we will make use of discretizations of the source function @xmath7 , the data function @xmath35 and their fourier transforms @xmath36 resp .",
    "@xmath37 .",
    "let in the following @xmath38 denote the @xmath18-dimensional discrete fourier transform with respect to space and time",
    ". by discretizing formula via riemann sums it follows @xmath39 where @xmath40 this is the formula from @xcite .",
    "note that we use the interval notation for the integer multi - indices for notational convenience .",
    "moreover , we also choose the length of the fourier transforms to be equal to @xmath41 in the first @xmath4 dimensions , respectively .",
    "this could be generalised without changes in practice .",
    "now , we assume to sample @xmath35 at @xmath42 , not necessarily uniform , points @xmath43 : then , @xmath44 the term @xmath45 represents the area of the detector surface around @xmath46 and has to fulfil @xmath47 .",
    "note that the original formula can be received from by choosing @xmath48 to contain all points on the grid @xmath49 .",
    "formula can be interpreted as follows : once we have computed the fourier transform of the data and evaluated the fourier transform at non - equidistant points with respect to the third coordinate , we obtain the ( standard , equispaced ) fourier coefficients of @xmath7 .",
    "the image can then be obtained by applying standard fft techniques .",
    "the straightforward evaluation of the sums on the right hand side of would lead to a computational complexity of order @xmath50 .",
    "usually this is improved by the use of fft methods , which have the drawback that they need both the data and evaluation grid to be equispaced in each coordinate .",
    "this means that if we want to compute efficiently , we have to interpolate both in domain- and frequency space . a simple way of doing that is by using polynomial interpolation .",
    "it is used for photoacoustic reconstruction purposes for instance in the _ k - wave _ toolbox for matlab @xcite .",
    "unfortunately , this kind of interpolation seems to be sub - optimal for fourier - interpolation with respect to both accuracy and computational costs @xcite    a regularized inverse k - space interpolation has already been shown to yield better reconstruction results @xcite .",
    "the superiority of applying the nufft , compared to linear interpolation , has been shown theoretically and computationally by @xcite .",
    "this section is devoted to the brief explanation of the theory and the applicability of the non - uniform fourier transform , where we explain both the ner - nufft ( subsection [ subsec : ner_nufft ] ) and the ned - nufft ( subsection [ subsec : ned_nufft ] ) in the form ( and spatial dimensions ) we utilise them afterwards .    the nedner - nufft algorithm used for implementing essentially ( up to scaling factors ) consists of the following steps :    1 .",
    "compute a @xmath4 dimensional ned - nufft in the @xmath51-coordinates due to our detector placement .",
    "2 .   compute a one - dimensional ner - nufft in the @xmath33-coordinate as indicated by the reconstruction formula .",
    "3 .   compute an equispaced @xmath18-dim inverse fft to obtain a @xmath18 dimensional picture of the initial pressure distribution .      with the ner - nufft ( non equispaced range  non - uniform fft ) it is possible to efficiently evaluate the discrete fourier transform at non - equispaced positions in frequency domain .",
    "to this end , we introduce the one dimensional discrete fourier transform , evaluated at non - equispaced grid points @xmath52 : @xmath53 in order to find an efficient algorithm for evaluation of , we use a window function @xmath54 , an oversampling factor @xmath55 and a parameter @xmath56 that satisfy : [ en : psi ]    1 .   @xmath54 is continuous inside some finite interval @xmath57 $ ] and has its support in this interval and 2 .",
    "@xmath54 is positive in the interval @xmath58 $ ] .",
    "then ( see @xcite ) we have the following representation for the fourier modes occurring in ( [ eq : nudft1 ] ) : @xmath59 by assumption , both @xmath54 and @xmath60 are concentrated around @xmath61 .",
    "so we approximate the sum over all @xmath62 by the sum over the @xmath63 integers @xmath0 that are closest to @xmath64 . by choosing @xmath65 and inserting in ,",
    "we obtain @xmath66 here @xmath67 denotes the interpolation length and @xmath68 where @xmath69 is the nearest integer ( i.e. the nearest equispaced grid point ) to @xmath70 .    the choice of @xmath54 is made in accordance with the assumptions above , so we need @xmath54 to have compact support . furthermore , to make the approximation in ( [ eq : ner_nufft ] ) reasonable ,",
    "its fourier transform @xmath71 needs to be concentrated as much as possible in @xmath72 $ ] . in practice",
    ", a common choice for @xmath54 is the kaiser - bessel function , which fulfils the needed conditions , and its fourier transform is analytically computable .",
    "a second major aim of the present work is to handle data measured at non - equispaced acquisition points @xmath73 in an efficient and accurate way .",
    "therefore we introduce the non - equispaced data , @xmath4 dimensional dft @xmath74 the theory for the ned - nufft is largely analogous to the ner - nufft @xcite as described in subsection [ subsec : ner_nufft ] .",
    "the representation is here used for each entry of @xmath75 and inserted ( with now setting @xmath76 ) into formula , which leads to @xmath77 where the entries in @xmath78 are the nearest integers to @xmath79 .",
    "here we have used the abbreviations @xmath80 for the needed evaluations of @xmath54 and @xmath71 .",
    "further remarks on the implementation of the ned- and ner - nufft , as well as a summery about the properties of the kaiser - bessel function and its fourier transform can be found in @xcite .",
    "before we turn to the evaluation of the algorithm we describe the photoacoustic setup .",
    "our device consists of a fp ( fabry prot ) polymer film sensor for interrogation @xcite . a @xmath81 pulsed laser source and a subsequent optical parametric oscillator ( opo )",
    "provide optical pulses .",
    "these pulses have a very narrow bandwidth and can be tuned within the visible and near infrared spectrum .",
    "the optical pulses are then transmitted via an optical fibre .",
    "when the light is emitted it diverges and impinges upon a sample with homogeneous fluence , thus generating a photoacoustic signal .",
    "this signal is then recorded via the fp - sensor head .",
    "the sensor head consists of an approximately @xmath82 thick polymer ( parylene c ) which is sandwiched between two dichroic dielectric coatings .",
    "these dichroic mirrors have a noteworthy transmission characteristic .",
    "light from @xmath83 to @xmath84 can pass the mirrors largely unabated , whereas the reflectivity from @xmath85 to @xmath86 ( sensor interrogation band ) is about 95% @xcite .",
    "the incident photoacoustic wave produces a linear change in the optical thickness of the polymer film . a focused continuous wave laser , operating within the interrogation band ,",
    "can now determine the change of thickness at the interrogation point via fp - interferometry .",
    "we choose two 2d targets for comparison , a star and a usaf ( us air force ) resolution test chart .",
    "both targets are made of glass with a vacuum - deposited durable chromium coating .",
    "the star target has 72 sectors on a pattern diameter of 5 mm , with an unresolved core diameter of @xmath87 .",
    "the targets are positioned in parallel to the sensor surface at a distance of about @xmath88 , and water is used as coupling medium between the target and the sensor .",
    "the interpolation length for the ner - nufft reconstruction is @xmath89 .",
    "the computational times are shown in tab . [",
    "tab : ner - nufft comparison ] showing that the linearly interpolated fft is about 30 % slower than the ner - nufft .",
    "-axis of a star sample , reconstructed using fft and linear interpolation ( top left ) and using the nufft ( top right ) with a square plotted around the center .",
    "the intensity of the reconstructed image along the sidelines of the square is plotted , for both reconstructions .",
    "the purple line indicates the frequency of the star sample.[fig : starphantomreconstruction ] ]    a segment of the reconstructed star target is shown in fig . [",
    "fig : starphantomreconstruction ] .",
    "the intensity is plotted against the sides of an imaginary square ( @xmath90 ) placed around the center of the star phantom .",
    "it is clearly visible , that the fft reconstruction is not able to represent the line pairs , when the density exceeds @xmath91 , corresponding to a resolution of @xmath87 , whereas they are still largely visible for the ner - nufft reconstruction .    [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     for a quantitative comparison of the resolution we use the usaf chart .",
    "it is recorded on an area of @xmath92 sensor points corresponding to @xmath93 with a grid spacing of @xmath94 and a time resolution of @xmath95 . as",
    "yet there is no standardized procedure to measure the resolution of a photoacoustic imaging system .",
    "we proceed similar to @xcite , by fitting a _ line spread function _",
    "( lsf ) and an _ edge spread function _ ( esf ) to the intensities of our reconstructed data . for",
    "the lsf to be meaningful , its source has to approximate a spatial delta function .",
    "this is the case in the @xmath96-axis , since the chrome coating of the usaf target is just about @xmath97 thick .",
    "-mip of an usaf chart reconstruction conducted with fft ( left ) and ner - nufft ( right ) . on the bottom",
    "images the data - sets used for the quantitative resolution are marked .",
    "the black square depicts the 49 @xmath98-coordinates used for the lsf fit along the @xmath96-axis for the axial resolution .",
    "the data for a single point is shown in the bottom right inlay .",
    "the white lines show the intensity fit for the lateral resolution .",
    "the bottom left inlay shows the data for a single white line .",
    "[ fig : usaf - chart ] ]    we fit a cauchy - lorentz distribution to the @xmath96-axis of our reconstructed data for 49 adjacent @xmath98-coordinates . their positions are marked as a black square within the white square , depicted in the bottom images of fig .",
    "[ fig : usaf - chart ] . the reconstruction in the @xmath96-axis for a single point is shown in the bottom right inlay of fig .",
    "[ fig : usaf - chart ] , for 8 points , covering a distance of @xmath99 in the @xmath96-direction , around the maximum intensity .",
    "a fit of the lorentz distribution is shown for both reconstruction methods .",
    "the fwhm ( _ full width , have maximum _ ) of the lorentz distribution , @xmath100 is the parameter @xmath101 .",
    "the output @xmath102 is the intensity in dependence from the @xmath96-axis , and @xmath103 and @xmath104 are fitting parameters .",
    "the average and standard deviation of @xmath101 for both of the 49 datasets are shown in table [ tab : ner - nufft comparison ] .",
    "the line spread function fwhm of the fft - reconstruction turns out to be more than twice as big as the one of the ner - nufft reconstruction .    for the lateral resolution",
    ", there is no target approximating a delta function , so we have to use the esf instead : @xmath105 the @xmath101 here is the fwhm of the associated lsf , and @xmath106 , @xmath107 and @xmath104 are fitting parameters .",
    "the esf requires a step function as source , of which our target provides plenty .",
    "we choose the long side of 12 bars , marked by white lines in the bottom images of fig .",
    "[ fig : usaf - chart ] , for this fit .",
    "the data for a particular line is shown in the bottom left inlay .",
    "we omitted all datasets , where only one point marked the transition from low to high intensity , rendering the edge fit unreliable and resulting in unrealistic improvements of our new method well over 100% .",
    "finally we averaged over 15 edges .",
    "the results are shown in table [ tab : ner - nufft comparison ] . while the deviation between different edges is quite high , the improvement of our ner - nufft reconstruction for the 15 evaluated edges ranged from @xmath108 to @xmath109 .",
    "the current setups allow data acquisition at just one single sensor point for each laser pulse excitation .",
    "since our laser is operating at @xmath81 data recording of a typical sample requires several minutes .",
    "reducing this acquisition time is a crucial step in advancing photoacoustics towards clinical and preclinical application .",
    "therefore , in this work we try to maximize the image quality for a given number of acquisition points .",
    "we are able to do this , because our newly implemented nedner - nufft is ideal for dealing with non - equispaced positioned sensors .",
    "this newly gained flexibility of sensor positioning offers many possibilities to enhance the image quality , compared against a rectangular grid .",
    "for instance a hexagonal grid was found to yield an efficiency of @xmath110 compared with @xmath111 for an exact reconstruction of a wave - number limited function @xcite .",
    "also any non - equispaced grids that may arrive from a specific experimental setup can be efficiently computed via the nedner - nufft approach .    here",
    ", we will use it to tackle the limited view problem .",
    "many papers deal with the limited view problem , when reconstructing images @xcite .",
    "our approach to deal with this problem is different .",
    "it takes into account that in many cases the limiting factor is the number of sensor points and the limited view largely a consequence of this limitation .    in our approach",
    "we therefore use a grid arrangement that is dense close to a center of interest and becomes sparser the further away the sampling points are located .",
    "we realize this by means of an equiangular , or equi - steradian sensor arrangement , where for a given point of interest each unit angle or steradian gets assigned one sensor point .    ]    to understand the limited view problem , it is helpful to define a detection region . according to @xcite , this is the region which is enclosed by the normal lines from the edges of the sensor .",
    "pressure waves always travel in the direction of the normal vector of the boundary of the expanding object .",
    "therefore certain boundaries are invisible to the detector as depicted in fig .",
    "[ fig : fieldofview ] .      for the equiangular sensor arrangement a point of interest is chosen .",
    "each line , connecting a sensor point with the point of interest , encloses a fixed angle to its adjacent line . in that sense",
    "we mimic a circular sensor array on a straight line .",
    "the position of the sensor points can be seen on top of the third image in fig .",
    "[ fig : tree ] .",
    "the obvious expansion of an equiangular projection to 3d is an equi - steradian projection .",
    "this problem is analogous to the problem of placing equispaced points on a 3d sphere and then projecting the points , from the center of the sphere , through the points , onto a 2d plane outside the sphere .",
    "we developed an algorithm for this problem , which is explained in detail in appendix [ app : equi - ster ] .",
    "our input variables are the grid size , the distance of the center of interest from the sensor plane and the desired number of acquisition points , which will be rounded to the next convenient value .",
    "a sensor arrangement with 1625 points on a @xmath112 grid is shown in the top left image in fig .",
    "[ fig : sensor_masks ] .      to determine the weighting term @xmath45 in eq .",
    "[ eq : disc_rec ] for 3d we introduce a function that describes the density of equidistant points per unit area @xmath113 . in our specific case",
    ", @xmath113 describes the density on a sphere around a center of interest .",
    "further we assume that @xmath113 is spherically symmetric and decreases quadratically with the distance from the center of interest @xmath114 : @xmath115 .",
    "we now define @xmath116 for a plane positioned at distance @xmath117 from the center of interest . in this case",
    "@xmath118 attenuates by a factor of @xmath119 , where @xmath120 is the angle of incidence . hence @xmath121 . by applying the spacing of the regular grid .",
    "this yields a weighting term of : @xmath122    analogously we can derive @xmath45 for 2d :    @xmath123    we applied a normalization after the reconstruction to all measurements .    for the application of this method to the fp setup it is noteworthy that there is a frequency dependency on sensitivity which itself depends on the angle of incidence , which has been extensively discussed in @xcite .",
    "the angle of incidence for our specific setup is @xmath124 . at this angle ,",
    "the frequency components around @xmath125 get attenuated by more than @xmath126 .",
    "below @xmath127 the frequency response remains quite stable ( attenuation below @xmath128 for the measurement angles occurring in our setup .",
    ") equispaced sensor arrangement , with a distance of 13 points between each sensor .",
    "the third image shows the nedner - nufft reconstruction with equiangular arranged sensor positions .",
    "the bottom image shows the same sensor arrangement , but all omitted sensor points are linearly interpolated and afterwards a ner - nufft reconstruction was conducted .",
    "[ fig : tree ] ]    a tree phantom , designed by brian hurshman and licensed under cc by 3.0 , is chosen for the 2 dimensional computational experiments on a grid with @xmath129 @xmath130 points .",
    "a forward simulation is conducted via _ k - wave _ @xcite .",
    "the forward simulation of the k - wave toolbox is based on a first order k - space model .",
    "a pml ( perfectly matched layer ) of 64 gridpoints is added , as well as @xmath131 of noise .    in fig .",
    "[ fig : tree ] our computational phantom is shown at the top .",
    "for each reconstruction a subset of 32 out of the 1024 possible sensor positions was chosen . in fig .",
    "[ fig : tree ] their positions are marked at the top of each reconstructed image .",
    "for the equispaced sensor arrangements , we let the distance between two adjacent sensor points sweep from 1 to 32 .",
    "the sensor points where always centered in the @xmath132-axis .    to compare the different reconstruction methods we used the correlation coefficient and the tenenbaum sharpness .",
    "these quality measures are explained in appendix [ app : qualitmeas ] .",
    "we applied the correlation coefficient only within the region of interest marked by the white circle in fig .",
    "[ fig : tree ] .",
    "the tenenbaum sharpness was calculated on the smallest rectangle , containing all pixels within the circle .",
    "the results are shown in fig .",
    "[ fig : tree_cc ] .    .",
    "the straight lines indicate the results for the equiangular projection.[fig : tree_cc ] ]    the tenenbaum sharpness for the equiangular sensor placement was 23001 , which is above all values for the equispaced arrangements .",
    "the correlation coefficient was 0.913 compared to 0.849 , for the best equispaced arrangement .",
    "in other words , the equiangular arrangement is 42.3 % closer to a full correlation , than any equispaced grid .    in fig .",
    "[ fig : tree ] the competing reconstructions are compared . while the crown of the tree is depicted quite well for the equispaced reconstruction ,",
    "the trunk of the tree is barely visible .",
    "this is due to the limited view problem . when the equispaced interval increases , the tree becomes visible , but at the cost of the crown s quality . in the equiangular arrangement a trade off between these two effects is achieved .",
    "additionally the weighting term for the outmost sensors is 17 times the weighting term for the sensor point closest to the middle .",
    "this amplifies the occurrence of artefacts , particularly outside of our region of interest .    the bottom image in fig .",
    "[ fig : tree ] shows the equiangular sensor arrangement , reconstructed in a conventional manner .",
    "the missing sensor points are interpolated to an equispaced grid , and a ner - nufft reconstruction is applied afterwards .",
    "we conducted a linear interpolation from our subset to all 1024 sensor points .",
    "the correlation coefficient for this outcome was 0.7348 while the sharpness measure was 21474 .",
    "this outcome exemplifies the clear superiority of the nufft to conventional fft reconstruction when dealing with non - equispaced grids .",
    "]    for a qualitative assessment of our new sensor arrangement we need a 3d phantom .",
    "we choose a yarn which we record on a rectangular grid with @xmath133 sensor points , with a grid spacing of @xmath134 and time sampling of @xmath135 hence an area of @xmath136 is covered . as coupling medium water",
    "is used , in which the yarn is fully immersed .    to determine the utility of non - equispaced grid sampling , we follow a certain routine .",
    "first we acquire a densely sampled dataset",
    ". then we use a very small subset of the initially collected sensor data , to test different sensor arrangements .",
    "therefore we can always use the complete reconstruction as our model standard together with the quality measurements explained in appendix [ app : qualitmeas ] .",
    "an upsampling factor of 2 was used for all reconstructions , hence the reconstructed image of the mip for the @xmath98 plane consists of @xmath137 pixels .",
    "the complete reconstruction with the ner - nufft took 154 seconds .",
    "maximum intensity projections ( mip ) of this full reconstruction for all axis are shown in fig .",
    "[ fig : golden - standard ] .",
    "the mip in the @xmath98 plane is our model standard , for comparison with the other reconstructions .",
    "sensor points is displayed .",
    "the intervall between two adjacent sensor points is @xmath138 for this configuration .",
    "the bottom images show mips of the ned - ner - nufft reconstruction only using the sensor points shown above . [",
    "fig : sensor_masks ] ]    for the equi - steradian sensor mask we choose our center of interest right in the center of the @xmath98-mip where the little knot can be seen , @xmath139 off the sensor surface",
    ". the resulting sensor mask , including the reconstruction is shown in fig .",
    "[ fig : sensor_masks ] , it consists of @xmath140 sensor points ( or 3.18 % of the initial number of sensor points ) .",
    "the weighting term , accounting for sensor sparsity is 9.7 times higher for the outermost sensor point , than for centermost sensor points in the @xmath98-plane .",
    "the reconstruction for this arrangement took 134 seconds .",
    "we compared this arrangement to rectangular grids , which all had @xmath141 sensor points ( or 3.29 % of the initial number of sensor points ) but varying distances between two adjacent points .",
    "the grid with an interval between sensor points of 5 is shown on the top left in fig .",
    "[ fig : sensor_masks ] .    ) . in the inlay",
    "the correlation coefficient mask is shown for 20087 points which corresponds to all pixels with at least 4% of the maximum value of the model standard and is the value used in fig .",
    "[ fig : correlation - coefficient - maskdiameter ] .",
    "[ fig : correlation_coefficient_mask ] ]    in fig .",
    "[ fig : correlation_coefficient_mask ] the equi - steradian grid is compared with 2 equispaced grids . to get a more precise measure of the correlation between the reconstructed images and the model standard , we calculated the correlation coefficient only within a region of interest .",
    "the region of interest is firstly confined by a centered disc , whose boundary is shown as a dotted circle in the inlay in fig . [",
    "fig : correlation_coefficient_mask ] .",
    "the @xmath132-axis shows the number of pixels of interest used to calculate the correlation coefficient within this disc .",
    "these pixels are increased according to the intensity of the corresponding pixels of the model s standard mip .",
    "[ fig : correlation_coefficient_mask ] demonstrates that the correlation coefficient for the equi - steradian arrangement , always remains better , within the depicted disc , when competing against the two strongest equispaced grids .",
    "corresponds to the straight line in fig .",
    "[ fig : correlation_coefficient_mask ] .",
    "the other straight lines indicate the side length of the square of a particular equispaced sensor point arrangement .",
    "[ fig : correlation - coefficient - maskdiameter ] ]    in fig .",
    "[ fig : correlation - coefficient - maskdiameter ] the 4 equispaced arrangements , with intervals reaching from 2 to 5 are compared to the equi - steradian grid . here",
    "the pixels of interest are set to a threshold of at least 4% of the maximum value , while the diameter is increased .",
    "the dotted straight lines indicate the side length of the square of a particular equispaced sensor point arrangement .",
    "as expected the correlation coefficient for this equispaced sensor arrangement starts to decline around that threshold .",
    "the correlation coefficient for the equi - steradian grid starts to fall behind the equispaced grid of interval 5 towards the end .",
    "this is expected , since the equi - steradian grid is only meant to give better results for a region of interest around the center .",
    "this is very clearly the case . between a diameter of 2 to 8 mm",
    "the correlation coefficient is on average 25.14 % closer to a value of @xmath142 than its strongest equispaced contender of interval 4 , and 30.87 % better than the interval 5 grid . at a diameter of @xmath143",
    "the correlation coefficient for the equi - steradian grid was 0.960 compared to 0.947 for the interval 4 grid and 0.944 for the interval 5 grid .",
    "this is 24.8 % and 28.6% closer to full correlation .    ]",
    "[ fig : tenenbaum - sharpness ] shows the normalized tenenbaum sharpness .",
    "the tenenbaum sharpness , unlike the correlation coefficient , can not be calculated on non - adjacent grid points , therefore it has been calculated on the smallest rectangle , that contains all pixels of interest .",
    "the equi - steradian has the highest sharpness for most values , with the interval 4 grid being very slightly better around a diameter of 3 - 4 mm .",
    "there is a drop of the tenenbaum sharpness towards the end .",
    "we computationally implemented a 3d non - uniform fft photoacoustic image reconstruction , called ner - nufft ( non equispaced range - non uniform fft ) to efficiently deal with the non - equispaced fourier transform evaluations arising in the reconstruction formula .",
    "this method was compared with the _ k - wave _ implemented fft reconstruction , which uses a polynomial interpolation .",
    "the two reconstruction methods where compared using 2d targets .",
    "the lateral resolution showed an improvement of @xmath144 which is in good agreement with the illustrative results for the star target .",
    "the axial resolution showed an improvement of @xmath145 .",
    "the computation time was about @xmath146 less , for the ner - nufft than the linearly interpolated fft reconstruction . in conclusion the ner - nufft reconstruction proved to be unequivocally superior to conventional linear interpolation fft reconstruction methods .",
    "we further implemented the ned - ner - nufft ( non equispaced data - ner - nufft ) , which allowed us to efficiently reconstruct from data recorded at non - equispaced placed sensor points .",
    "this newly gained flexibility was used to tackle the limited view problem , by placing sensors more sparsely further away from the center of interest .",
    "we developed an equiangular sensor placement for 2d and an equi - steradian placement in 3d , which assigns one sensor point to each angle / steradian for a given center of interest . in the 2d computational simulations we showed that this arrangement significantly enhances image quality in comparison to regular grids .",
    "in 3d we conducted experiments , where a yarn phantom was recorded . the maximum intensity projection ( mip ) of the full reconstruction",
    "was compared to mips of reconstructions that only used about 3% of the original data . within our region of interest ,",
    "the correlation of our image was 0.96 , which is 24.8% closer to full correlation than the best equispaced arrangement , reconstructed from slightly more sensor points .",
    "the sensor placement to tackle the limited view problem , combined with the ned - ner - nufft gives significantly better results for an object located at the center of a bigger sensor surface .",
    "this result was confirmed in the 2d simulation as well as for real data in 3d .",
    "this work is supported by the medical university of vienna , the european projects famos ( fp7 ict 317744 ) and fun oct ( fp7 health 201880 ) , macular vision research foundation ( mvrf , usa ) , austrian science fund ( fwf ) , project p26687-n25 ( interdisciplinary coupled physics imaging ) , and the christian doppler society ( christian doppler laboratory `` laser development and their application in medicine '' ) .",
    "[ 1]#10=0=0 0 by1pt#1    10 [ 1]#1 urlstyle [ 1]doi  # 1    p.  beard .",
    "biomedical photoacoustic imaging .",
    ", 1:602631 , 2011 .",
    "p.c . beard .",
    "two - dimensional ultrasound receive array using an angle - tuned fabry - perot polymer film sensor for transducer field characterization and transmission ultrasound imaging .",
    ", 52(6):10021012 , june 2005 .",
    "beard , f.  perennes , and t.n .",
    "transduction mechanisms of the fabry - perot polymer film sensing concept for wideband ultrasound detection . , 46(6):15751582 ,",
    "november 1999 .",
    "p.  burgholzer , c.  hofer , g.  paltauf , m.  haltmeier , and o.  scherzer .",
    "thermoacoustic tomography with integrating area and line detectors .",
    ", 52(9):15771583 , september 2005 .",
    "cox and p.c .",
    "the frequency - dependent directivity of a planar fabry - perot polymer film ultrasound sensor . , 54(2):394404 , 2007 .",
    "w.  dan , c.  tao , x .- j .",
    "liu , and x .- d .",
    "influence of limited - view scanning on depth imaging of photoacoustic tomography .",
    ", 21(1):014301 , 2012 .",
    "k.  fourmont .",
    "non - equispaced fast fourier transforms with applications to tomography . , 9(5):431450 , 2003 .    f.  c.  a. groen , i.  t. young , and g.  ligthart .",
    "a comparison of different focus functions for use in autofocus algorithms .",
    ", 6(2):8191 , 1985 .",
    "m.  haltmeier , o.  scherzer , and g.  zangerl . a reconstruction algorithm for photoacoustic imaging based on the nonuniform fft .",
    ", 28(11):17271735 , november 2009 .",
    "m.  jaeger , s.  schpbach , a.  gertsch , m.  kitz , and m.  frenz .",
    "fourier reconstruction in optoacoustic imaging using truncated regularized inverse k - space interpolation .",
    ", 23:s51s63 , 2007 .",
    "p.  kuchment and l.  kunyansky .",
    "mathematics of thermoacoustic tomography . , 19:191224 , 2008 .",
    "g.  paltauf , r.  nuster , m.  haltmeier , and p.  burgholzer .",
    "photoacoustic tomography with integrating area and line detectors . in l.  v. wang , editor , _ photoacoustic imaging and spectroscopy _ , optical science and engineering , pages 251263 .",
    "crc press , boca raton , fl , 2009 .",
    "d.  p. petersen and d.  middleton .",
    "sampling and reconstruction of wave - number - limited functions in @xmath147-dimensional euclidean spaces .",
    ", 5:279323 , 1962 .",
    "o.  scherzer , editor . .",
    "springer , new york , 2011 .",
    "r.  schulze , g.  zangerl , m.  holotta , d.  meyer , f.  handle , r.  nuster , g.  paltauf , and o.  scherzer . on the use of frequency - domain reconstruction algorithms for photoacoustic imaging .",
    ", 16(8):086002 , 2011 . funded by the austrian science fund ( fwf ) within the fsp s105 - `` photoacoustic imaging '' .    c.  tao and x.  liu",
    ". reconstruction of high quality photoacoustic tomography with a limited - view scanning .",
    ", 18(3):27602766 , feb 2010 .",
    "b.  e. treeby and b.  t. cox .",
    "-wave : matlab toolbox for the simulation and reconstruction of photoacoustic wace fields .",
    ", 15:021314 , 2010 .",
    "b.  e. treeby , t.  k. varslot , e.  z. zhang , j.  g. laufer , and p.  c. beard .",
    "automatic sound speed selection in photoacoustic image reconstruction using an autofocus approach .",
    ", 16(9):0905010905013 , 2011 .",
    "l.  v. wang , editor . . optical science and engineering .",
    "crc press , boca raton , 2009 .",
    "m.  xu and l.  v. wang .",
    "exact frequency - domain reconstruction for thermoacoustic tomography ",
    "i : planar geometry . , 21:823828 , 2002 .",
    "m.  xu and l.  v. wang .",
    "time - domain reconstruction for thermoacoustic tomography in a spherical geometry .",
    ", 21(7):814822 , 2002 .",
    "m.  xu and l.  v. wang . analytic explanation of spatial resolution related to bandwidth and detector aperture size in thermoacoustic or photoacoustic reconstruction .",
    ", 67(5):056605105660515 , 2003 .",
    "m.  xu and l.  v. wang .",
    "universal back - projection algorithm for photoacoustic computed tomography . , 71(1 ) , 2005 .",
    "m.  xu and l.  v. wang .",
    "photoacoustic imaging in biomedicine .",
    ", 77(4 ) , 2006 .",
    "y.  xu , d.  feng , and l.  v. wang .",
    "exact frequency - domain reconstrcution for thermoacoustic tomography  i : planar geometry . , 21(7):823828 , 2002 .",
    "y.  xu , l.  v. wang , g.  ambartsoumian , and p.  kuchment .",
    "reconstructions in limited - view thermoacoustic tomography .",
    ", 31(4):724733 , 2004 .",
    "e.  zhang , j.  laufer , and p.  beard .",
    "backward - mode multiwavelength photoacoustic scanner using a planar fabry - perot polymer film ultrasound sensor for high - resolution three - dimensional imaging of biological tissues .",
    ", 47:561577 , 2008 .",
    "in our algorithm , the grid size and the distance of the center of interest from the sensor plane is defined .",
    "the number of sensor points @xmath147 will be rounded to the next convenient value .",
    "our point of interest is placed at @xmath148 , centered at a square @xmath98 grid .",
    "the point of interest is the center of a spherical coordinate system , with the polar angle @xmath149 at the @xmath96-axis towards the @xmath98-grid .",
    "first we determine the steradian @xmath150 of the spherical cap from the point of interest , that projects onto the acquistion point plane via @xmath151 this leads to a unit steradian @xmath152 with @xmath147 being the number of sensors one would like to record the signal with .",
    "the sphere cap is then subdivided into slices @xmath0 which satisfy the condition @xmath153 where @xmath154 encloses exactly one unit steradian @xmath155 and @xmath156 has to be a power of two , in order to guarantee some symmetry . the value of @xmath156 doubles , when @xmath157 , where @xmath158 is the chord length between two points on @xmath0 and @xmath159 is the distance to the closest point on @xmath160 .",
    "these values are chosen in order to guarantee we apply some restrictions to approximate equidistance between acquisition points on the sensor surface .",
    "the azimuthal angles for a slice @xmath0 are calulated according to : @xmath161 with @xmath162 , where @xmath163 stems from the former slice @xmath160 .",
    "the sensor points are now placed on the @xmath98-plane at the position indicated by the spherical angular coordinates : @xmath164",
    "the correlation coefficient @xmath165 is a measure of the linear dependence between two images @xmath166 and @xmath167 .",
    "its range is @xmath168 $ ] and a correlation coefficient close to 1 indicates linear dependence @xcite .",
    "it is defined via the variance , @xmath169 of each image and the covariance , @xmath170 of the two images : @xmath171    we did not choose the widely used @xmath172 distance measure because it is a morphological distance measure , meaning it defines the distance between two images by the distance between their level sets . therefore two identical linearly dependent images can have a correlation coefficient of @xmath142 and still a huge @xmath172 distance .",
    "normalizing the images only mitigates this problem , because single , high intensity artifacts or a varying intensity over the whole image can greatly alter the @xmath172 distance .    while the correlation coefficient is a good measure for the overall similarity between two images it does not include any sharpness measure .",
    "hence blurred edges are punished very little , in comparison to slight variations of homogeneous areas . to address this shortcoming we chose a sharpness measure or focus function as a second quality criterion .",
    "sharpness measures are obtained from some measure of the high frequency content of an image @xcite .",
    "they have also been used to select the best sound speed in photoacoustic image reconstruction @xcite . out of the plethora of published focus functions we select the tenenbaum function , because of its robustness to noise :        like the @xmath175 norm and unlike the correlation coefficient the tenenbaum function is an extensive measure , meaning it increases with image dimensions .",
    "therefore we normalized it to @xmath176 , where @xmath147 is the number of elements in @xmath5 ."
  ],
  "abstract_text": [
    "<S> to obtain the initial pressure from the collected data on a planar sensor arrangement in photoacoustic tomography , there exists an exact analytic frequency domain reconstruction formula . </S>",
    "<S> an efficient realization of this formula needs to cope with the evaluation of the data s fourier transform on a non - equispaced mesh . in this paper </S>",
    "<S> , we use the non - uniform fast fourier transform to handle this issue and show its feasibility in 3d experiments . </S>",
    "<S> this is done in comparison to the standard approach that uses polynomial interpolation . </S>",
    "<S> moreover , we investigate the effect and the utility of flexible sensor location on the quality of photoacoustic image reconstruction . </S>",
    "<S> the computational realization is accomplished by the use of a multi - dimensional non - uniform fast fourier algorithm , where non - uniform data sampling is performed both in frequency and spatial domain . </S>",
    "<S> we show that with appropriate sampling the imaging quality can be significantly improved . </S>",
    "<S> reconstructions with synthetic and real data show the superiority of this method . </S>",
    "<S> * keywords : * image reconstruction , photoacoustics , non - uniform fft </S>"
  ]
}