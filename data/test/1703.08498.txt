{
  "article_text": [
    "generating spatially correlated gaussian random fields with specific statistical properties is an important component and active topic of research in a diverse array of application areas such as ecology , meteorology and geology @xcite .",
    "gaussian random fields are collections of random variables indexed by elements from a multidimensional space with the property that their joint distribution is gaussian .",
    "these types of fields are specified by expectations and positive semi - definite covariance functions and are generally good models for many phenomena ; see , e.g. , @xcite .",
    "in this paper we focus on geophysics applications where the spatially correlated random field represents the permeability of a porous medium .",
    "specifically , we consider subsurface flow in a specified domain , @xmath0 , governed by darcy s law , @xmath1 where @xmath2 is the fluid velocity , @xmath3 is the fluid pressure and @xmath4 the hydraulic conductivity , measuring the transmissibility of the fluid through the porous medium .    in practice , only small portions of the hydraulic conductivity",
    "are known via noisy data measurements and this contributes a large source of uncertainty into the darcy model .",
    "understanding the effects that such uncertainties introduce into the model , or forward propagation uncertainty quantification ( uq ) @xcite , is quite important . to quantify this uncertainty we consider monte carlo methods , in particular multilevel monte carlo methods ( mlmc ) , where equations - are solved repeatedly using different realizations of the hydraulic conductivity field .",
    "in multilevel monte carlo methods , more accurate ( and expensive ) simulations are run with fewer samples , while less accurate ( and inexpensive ) simulations are run with a larger number of samples . at the end of these simulations ,",
    "quantities of interest depending on the velocity and/or pressure , such as the effective permeability , can be computed . since a large number of monte carlo simulations are needed to produce accurate quantities of interest , it is essential to have efficient algorithms to rapidly generate these different realizations .    a standard way of modeling the hydraulic conductivity is as a log - normal field , @xmath5 , where @xmath6 is a random field with a specified covariance structure @xcite .",
    "a classical , and well - studied approach for generating these samples with the desired statistical properties is the karhunen - love  decomposition .",
    "this sampling technique amounts to solving an eigenvalue problem with the dense covariance matrix .",
    "the samples are then different ( random ) linear combinations of the eigenvectors . however",
    ", sampling in this manner suffers from a significant computational cost and high memory requirement .",
    "in fact , the computational complexity for solving a dense eigenvalue problem grows cubically with the size of the covariance matrix and the memory necessary to store all the eigenvectors in the karhunen - love  decomposition scales quadratically , making such methods prohibitively expensive for large - scale problems of interest .",
    "new approaches based on randomized methods and hierarchical semi - separable matrices can drastically reduce the cost of solving the eigenvalue problem ( see e.g. @xcite ) , however they allow to compute only the dominant eigenmodes of the karhunen - love  expansion and , therefore , introduce bias in the sampling .",
    "a different approach for generating random field samples is by solving a stochastic partial differential equation ( spde ) with a white noise source function  @xcite . to use the inverse of an elliptic differential operator as covariance function",
    "is a common approach for the solution of large - scale bayesian inverse problem governed by pde forward models , see e.g. @xcite , as it allows for efficient evaluation of the covariance operator using a fast and scalable multigrid solver .",
    "the authors in @xcite provide a link between karhunen - love  sampling from a matrn distribution and spde sampling , further motivating the spde approach .",
    "for example , one can solve the following reaction - diffusion equation @xmath7 where @xmath6 is the logarithm of the hydraulic conductivity , @xmath8 is a constant depending on the correlation length , and @xmath9 is a white noise function .",
    "this sampling approach has two significant benefits : the first is avoiding the computational cost incurred by solving a dense eigenvalue problem and the second is that optimal solution methods for solving sparse linear systems arising from the finite element discretization of can be applied . despite the benefits of this approach , it is not without imperfections as generated samples contain artificial boundary effects .    compared to the work in @xcite , three new ideas are introduced in this paper : _ i _ ) a mixed discretization of the spde , _ ii _ ) a hierarchical version of the sampler , and _",
    "iii _ ) mitigation of boundary artifacts using embedded domains .",
    "specifically , given a general unstructured fine grid , we construct a hierarchy of algebraically coarsened grids and finite element spaces using the element - based algebraic multigrid techniques ( amge ) presented in @xcite , which provide coarse spaces with improved approximation properties than the ones from the original work @xcite .",
    "then we generate random field samples at each level of the hierarchy by solving linear systems arising from the mixed discretization of .",
    "this allows us to compute our ( piecewise constant ) samples in a hierarchical fashion ( as needed in mlmc simulations ) , while leveraging existing scalable methods and software for solving deterministic pdes .",
    "we remark that while a hierarchical sampler can be constructed in a similar way for the primal formulation of the spde using geometric multigrid hierarchies , our framework offers more flexibility with respect to the geometry of the physical domain ( since it does not require a sequence of nested grids ) .",
    "in addition , the computational advantages of resorting to the mixed formulation are twofold .",
    "first , the finite element discretization of the spde requires the assembly of the square root of a mass matrix . in @xcite",
    ", the use of a continuous galerkin ( cg ) finite element space in the discretization of the primal formulation leads to a non - diagonal mass matrix and mass lumping is used to make computation of the square - root tractable at the cost of accuracy . on the contrary",
    ", the finite element pair of lowest raviart - thomas and piecewise constant functions in the mixed formulation leads to a diagonal mass matrix for the variable @xmath10 .",
    "second , in the amge framework , the construction of @xmath11 and @xmath12-conforming spaces ( required in the mixed formulation ) on agglomerated meshes is simpler than the one of @xmath13-conforming spaces ( required by the primal formulation ) , and also leads to sparser , i.e. faster to apply , grid transfer operators .",
    "finally , we can not stress enough that performing realistic simulations with mlmc requires a considerable computational cost . to make the method more feasible in practice",
    ", parallelism must be fully exploited .",
    "our work focuses solely on parallelism across the spatial domain in computing realizations of the input random field , then performing the subsequent solve of the model of interest .",
    "further parallelism could be added using the scheduling approaches suggested in @xcite , where the authors investigate the complex task of scheduling parallel tasks within and across levels of mlmc .",
    "the paper is structured as follows . in section [ sec : gaussian - sampling ] we give an overview of both the classical kl expansion and the spde sampling approach .",
    "the hierarchical spde sampling procedure is introduced and examined in section [ sec : ml - sampling ] .",
    "section [ sec : mlmc ] contains a brief review of the multilevel monte carlo method ( mlmc ) , a scalable alternative to standard monte carlo methods that uses the solution of the pde on a hierarchy of grid to effectively reduce the variance of the estimator . here",
    ", we also present our numerical results when our proposed sampling technique is used inside the mlmc method .",
    "lastly , section [ sec : conclusions ] contains our concluding remarks .",
    "in this section we review two ways of generating samples of a log - normal random field . these are collections of random variables , @xmath14 , where @xmath15 is the sample space for the probability space @xmath16 . for a fixed point ,",
    "@xmath17 , @xmath18 is a random variable . for a fixed @xmath19",
    ", @xmath20 is a deterministic function called a realization or sample of the random field .",
    "random fields with a particular covariance functions are used to model the correlation between points in spatial data . in geostatistical applications ,",
    "the logarithm of the hydraulic conductivity , is modeled as a random field with a specific class of covariance function .",
    "in particular , we consider a stationary isotropic gaussian field with the widely used class of matrn covariance functions  @xcite , given by @xmath21 where @xmath22 is the marginal variance , @xmath23 determines the mean - square differentiability of the underlying process , @xmath24 is a scaling factor inversely proportional to the correlation length , @xmath25 is the gamma function , and @xmath26 is the modified bessel function of the second kind . when @xmath27 reduces to the common exponential covariance function , given by @xmath28 in this section we consider two ways for generating such realizations or samples of random fields .",
    "the first method we consider is the classical karhunen - love  expansion .",
    "the second is based on solving a particular stochastic reaction - diffusion equation with a white - noise source function .",
    "the karhunen - love  ( kl ) expansion of a second - order random field is _ second - order _ if for each @xmath29 the random variable @xmath30 has finite variance . ]",
    "provides a series representation using the orthonormal basis provided by the eigenfunctions of the underlying covariance operator  @xcite . for a bounded regular domain @xmath31",
    "we define the convolution operator @xmath32 since @xmath33 is a compact operator , the eigenvalue problem @xmath34 admits a countable sequence of eigenpairs @xmath35 where @xmath36 a gaussian random field can be expanded as @xmath37    in practice , a discrete version of the eigenvalue problem is computed .",
    "a triangulation of the domain @xmath38 is generated with the discrete function space @xmath39 of piecewise constant functions .",
    "then , we can compute realizations of the gaussian field with a karhunen - love  expansion truncated after @xmath40 terms as @xmath41 where the pairs @xmath35 solve the generalized eigenvalue problem : @xmath42 with inner product defined as @xmath43 for @xmath44    one of the main reasons for sampling using this approach is that any truncation of the kl expansion gives a sample with the minimal mean square error , see e.g. @xcite . however , this method is not computationally feasible due to the high computational cost for solving a dense eigenvalue problem . on a mesh with @xmath45 degrees of freedom , the cost",
    "to factor a dense covariance matrix is @xmath46 .",
    "this makes generating samples in this manner impractical for finely resolved meshes where the number of degrees of freedom could be of the order of millions .",
    "this motivates other sampling methods that do not suffer from such a complexity cost .",
    "an important link between gaussian fields and gaussian markov random fields is established in @xcite , where a random process on @xmath47 with a matrn covariance function can be obtained as the solution of a particular stochastic partial differential equation ( spde ) .",
    "this provides an alternative method for computing the desired samples of a gaussian random field via a spde , as opposed to the computationally intensive kl expansion .",
    "realizations of a gaussian random field with an underlying matrn covariance , @xmath6 , solve the following linear stochastic pde : @xmath48 for some other realization of the standard gaussian white noise function @xmath49 with scaling factor @xmath50 , @xcite . the scaling factor is chosen to be @xmath51 to impose unit marginal variance of @xmath52  @xcite .",
    "it is worth noting that if @xmath53 in two dimensions , and @xmath27 in three dimensions , then reduces to the following standard reaction - diffusion equation ,    @xmath54    additionally in three dimensions , realizations of a gaussian random field with exponential covariance are solutions of .",
    "thus a scalable sampling alternative is equivalent to efficiently solving the stochastic reaction - diffusion equation given by where we are able to leverage existing scalable solution strategies .",
    "we remark that , as explained in @xcite , samples from matrn distributions with @xmath55 ( in two spatial dimensions ) and from matrn distributions with @xmath56 ( in three spatial dimensions ) , can be obtained by recursively solving @xmath57 for @xmath58 , where @xmath59 is the solution of .",
    "equation is discretized using a mixed finite element method , @xcite .",
    "following standard notation , for scalar functions @xmath60 and vector functions @xmath61^d$ ] , we define the inner products : @xmath62 we also define the functional spaces @xmath63 and @xmath64 as @xmath65 finally , we introduce the bilinear forms @xmath66 and the linear form @xmath67    following standard finite element techniques , let @xmath68 denote the lowest order raviart - thomas finite element space and @xmath69 denote the finite element space of piecewise constant functions .",
    "then , a mixed finite element discretization of reads    find @xmath70 such that @xmath71 with essential boundary conditions @xmath72 .",
    "[ prob : spde_weak ]    the choice of a low order finite element discretization is optimal with respect to the regularity of the solution . for example , in 3d space and for @xmath73 the realizations of a gaussian random field with matrn covariance are only _ almost surely _ hlder continuous with any exponent @xmath74 , see e.g. @xcite .    in the following ,",
    "we denote the discrete linear algebra representations of the bilinear forms @xmath75 , @xmath76 , and @xmath77 with the matrices @xmath40 , @xmath78 , and @xmath79 where @xmath40 is the mass matrix for the space @xmath80 , @xmath78 is the mass matrix for the space @xmath81 , and @xmath79 stems from the divergence operator .",
    "particular care must be taken for the linear algebra representation of the stochastic right hand side @xmath82 .",
    "this requires recalling the following two properties of gaussian white noise defined on a domain @xmath31 . for any set of test functions @xmath83",
    "the expectation and covariance measures are given by @xmath84 & = 0 , \\\\",
    "\\operatorname{cov}\\left ( ( q_{i},\\mathcal{w } ) , ( q_{j } , \\mathcal{w})\\right )      & = ( q_{i},q_{j}).\\end{aligned}\\ ] ] by taking @xmath85 as piecewise constants so that @xmath86 , the second equation implies that the covariance measure over a region of the domain is equal to the area of that region @xcite .    as a result of these properties , the computation of the discrete stochastic linear functional amounts to computing @xmath87",
    "where the coefficients of @xmath88 in the finite element expansion form a random vector drawn from @xmath89 .",
    "it should be noted that the mass matrix @xmath78 for the space @xmath81 is diagonal , hence its square root can be computed cheaply .",
    "this is not the case in the original primal formulation presented in @xcite since they employ piecewise linear continuous elements .",
    "the authors suggest then using mass lumping to make computation feasible at the cost of accuracy .",
    "then the discrete mixed finite element problem can be written as the linear system , @xmath90 where @xmath91 an efficient iterative solution method of , required to scalably generate the desired gaussian field realizations , is described in the following section .",
    "it is worth noticing that the lowest order raviart - thomas spaces allow us to define a discrete gradient @xmath92 such that the identity @xmath93 holds for all @xmath94 and all @xmath95 with zero normal trace on @xmath96 .",
    "specifically , we define @xmath97 .",
    "then , the schur complement of with respect to @xmath98 can be viewed as a non - local _ discontinuous _ galerkin ( interior penalty ) discretization of the original pde , cf . , @xcite .",
    "namely , we have @xmath99 the above formulation allows us to apply the theory in @xcite to show convergence of @xmath98 to @xmath10 , however a detailed analysis of the convergence of the mixed system is outside the scope of this work .",
    "the sparse large matrix @xmath100 admits the following block ul decomposition @xmath101 where the blocks @xmath102 and @xmath103 are both sparse since @xmath78 is diagonal .",
    "then solving the large sparse linear system   amounts to first finding @xmath104 such that @xmath105 and then to set @xmath106 it is worth noting that @xmath107 in is symmetric positive definite and stems from the matrix representation of the weighted @xmath12 inner product , @xmath108 thanks to the particular choice of the spaces @xmath80 and @xmath81 , see e.g. @xcite .",
    "then to solve the linear system , we use the conjugate gradient ( cg ) method preconditioned by the auxiliary space amg preconditioner for @xmath109 problems in  @xcite , which ensures a mesh independent convergence and robustness with respect to the choice of the correlation length @xmath110 .",
    "in particular , for our numerical results , we use hypre s hypreads preconditioner  @xcite .",
    "this approach allows for scalable sampling , but the parametrization of @xmath111 is mesh - dependent .",
    "this is not suitable for mlmc where the same realization of the gaussian field needs to be computed at a fine and a coarse spatial resolution . in section [ sec : ml - sampling ] , we detail our proposed method that allows for hierarchical sampling based on a multilevel decomposition of the stochastic field .",
    "as noted in @xcite , the spde sampling method introduces errors on the boundary resulting in a larger marginal variance of the random field close to the boundary of the domain .",
    "these errors are due to the introduction of artificial boundary conditions where the spde is defined globally , yet must be discretized on a finite domain . to mitigate this issue",
    "we embed the original mesh into a larger mesh .",
    "equation is discretized on the larger domain @xmath112 where a corresponding linear system of the form is solved and the corresponding random field realization is restricted to the original domain @xmath31 .",
    "a rule of thumb proposed in @xcite suggests the boundary effect is negligible at a distance equal to the correlation length from the boundary .",
    "figure [ fig : mar_var ] shows the sample marginal variance of 2000 gaussian field samples with correlation length @xmath113 , marginal variance @xmath114 generated by the spde sampler . in figure  [ subfig : orig ] , the samples were computed using the original circular mesh with diameter equal @xmath115 , whereas in figure  [ subfig : embed ] the spde given by is solved on the original mesh embedded in a larger square domain with sides of length @xmath116 shown in figure  [ subfig : embed_mesh ] .",
    "thus , mesh embedding alleviates the issue of the error on the boundary .    [ cols=\"^,^,^,^ \" , ]     we solve with the following boundary conditions :    @xmath117    the quantity of interest we use is the expected value of the effective permeability , that is the ( horizontal ) flux through the `` outflow '' part of the boundary , defined as @xmath118    figure [ fig : spe10_ml ] contains four subplots relating to the multilevel estimator and performance of the multilevel monte carlo method with hierarchical , spde sampling . the target mean square error is @xmath119 - 5 for figures [ subfig : spe10_mean]-[subfig : spe_solve ] . the first figure , figure [ subfig : spe10_mean ] , displays the multilevel estimator where the blue line with circles represents the expectation at each level @xmath120 $ ] and the green dashed line represents the expectation of the difference in levels , @xmath121 $ ] . figure [ subfig : spe10_var ] illustrates the multilevel variance reduction .",
    "this plot contains two lines , the blue line represents the variance of the particular level , whereas the green dashed line represents the variance of the difference in levels .",
    "the plot shows the effectiveness of the mlmc method at reducing the variance as the number of unknowns increases . the average sampling time to generate the required gaussian field realizations and solve the forward model for each level",
    "is shown in figure [ subfig : spe_solve ] .",
    "this plot indicates near optimal scaling of the mlmc method with the proposed hierarchical sampler .",
    "figure [ subfig : dofsvsamps ] shows the number of samples required at each level of the mlmc method for different prescribed mean square error tolerances .",
    "the plot clearly shows that more samples are generated on the coarse levels ( fewer degrees of freedom ) than on the finest levels ( many degrees of freedom ) .",
    "this merely confirms the mlmc theory with our proposed hierarchical sampling technique .      in this section we present similar experiments for estimating the expectation of the effective permeability , but for the unit cube domain @xmath122 .",
    "we solve with the following boundary conditions :    @xmath123    the quantity of interest is the expected value of the effective permeability defined in .",
    "the original mesh consists of 64 hexahedral elements and is uniformly refined several times to build the hierarchy of levels .",
    "we examine the performance of the multilevel estimator for the unit cube in figure [ fig : cube_ml ] which contains four subplots .",
    "the first figure , figure [ subfig : cube_mean ] , displays the multilevel estimator where the blue line with circles represents the expectation at each level @xmath120 $ ] and the green dashed line represents the expectation of the difference in levels , @xmath121 $ ] .",
    "figure [ subfig : cube_var ] illustrates the multilevel variance reduction of the method , while figure [ subfig : cube_solve ] shows the average sampling time required to generate the gaussian random field realizations and solve the forward model problem for each level .",
    "the method with hierarchical , spde sampling exhibits near optimal scaling for the 3d problem formulation .",
    "the number of samples required at each level of the mlmc method for different prescribed mean square error tolerances is shown in [ subfig : cube_nsamples ] .",
    "for both of the examined computational domains , the hierarchical , spde sampler yields the expected results for mlmc variance reduction and displays the desired scaling properties for the possibility of large - scale mlmc simulations .",
    "multilevel monte carlos simulations for pdes with uncertain input coefficients employ a hierarchy of spatial resolutions as a variance reduction technique for the approximation of expected quantities of interest .",
    "a key component in the multilevel monte carlo method is the ability to generate samples of a random field at different spatial resolutions .",
    "the karhunen - love  expansion provides a parametrization independent of the spatial discretization .",
    "however , both the computation and the memory requirements become infeasible at large - scale as the expansion requires the ability to compute and store eigenpairs of a large , dense covariance matrix .",
    "we suggest a sampling method based on the solution of a particular stochastic pde .",
    "this method is highly scalable , but the parametrization is mesh dependent .",
    "we have proposed a multilevel decomposition of the stochastic field to allow for scalable , hierarchical stochastic pdes samplers .",
    "numerical results are provided that suggest the method possesses the desired scalability as the method leverages existing scalable solvers .",
    "we also have applied the new sampling technique to mlmc simulations of subsurface flow problems with over 10 million parameters in the stochastic dimension .              , _ finite element exterior calculus , homological techniques , and applications _ , acta numerica , 15 ( 2006 ) , pp .",
    "1155 , https://doi.org/10.1017/s0962492906210018 , http://dx.doi.org/10.1017/s0962492906210018 , https://arxiv.org/abs/http://journals.cambridge.org/article_s0962492906210018 .            , _ a computational framework for infinite - dimensional bayesian inverse problems part i : the linearized case , with application to global seismic inversion _ , siam journal on scientific computing , 35 ( 2013 ) , pp .",
    "a2494a2523 , https://doi.org/10.1137/12089586x .                  , _ multilevel monte carlo path simulation _ , operations research , 56 ( 2008 ) , pp .",
    "607617 . , _ scheduling massively parallel multigrid for multilevel monte carlo methods _ , corr , abs/1607.03252 ( 2016 ) , http://arxiv.org/abs/1607.03252 .                    , _ an explicit link between gaussian fields and gaussian markov random fields : the stochastic differential equation approach _ , journal of the royal statistical society : series b ( statistical methodology ) , 73 ( 2011 ) , pp .  423498 .",
    ", _ probability theory , vol .",
    "ii _ , graduate texts in mathematics , 46 ( 1978 ) , pp .",
    ", _ preconditioning discretizations of systems of partial differential equations _ , numerical linear algebra with applications , 18 ( 2011 ) , pp .",
    "140 , https://doi.org/10.1002/nla.716 , http://dx.doi.org/10.1002/nla.716 .            , _ randomized algorithms for generalized hermitian eigenvalue problems with application to computing karhunen - love expansion _ , numerical linear algebra with applications , 23 ( 2016 ) , pp .",
    "314339 , https://doi.org/10.1002/nla.2026 , http://dx.doi.org/10.1002/nla.2026 . nla.2026 .        , _ on stationary processes in the plane _ , biometrika , 41 ( 1954 ) , pp",
    "434449 . , _",
    "stochastic processes in several dimensions _",
    ", bulletin of the international statistical institute , 40 ( 1963 ) , pp ."
  ],
  "abstract_text": [
    "<S> we propose an alternative method to generate samples of a spatially correlated random field with applications to large - scale problems for forward propagation of uncertainty . a classical approach for generating these samples </S>",
    "<S> is the karhunen - love  ( kl ) decomposition . </S>",
    "<S> however , the kl expansion requires solving a dense eigenvalue problem and is therefore computationally infeasible for large - scale problems . </S>",
    "<S> sampling methods based on stochastic partial differential equations provide a highly scalable way to sample gaussian fields , but the resulting parametrization is mesh dependent . </S>",
    "<S> we propose a multilevel decomposition of the stochastic field to allow for scalable , hierarchical sampling based on solving a mixed finite element formulation of a stochastic reaction - diffusion equation with a random , white noise source function . </S>",
    "<S> numerical experiments are presented to demonstrate the scalability of the sampling method as well as numerical results of multilevel monte carlo simulations for a subsurface porous media flow application using the proposed sampling method .    </S>",
    "<S> multilevel methods , pdes with random input data , mixed finite elements , uncertainty quantification , multilevel monte carlo    65c05 , 60h15 , 35r60 , 65n30 , 65m75 , 65c30 </S>"
  ]
}