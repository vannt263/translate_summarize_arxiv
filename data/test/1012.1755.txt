{
  "article_text": [
    "the h.e.s.s . ( high energy stereoscopic system ) instrument is an array of four imaging atmospheric cherenkov telescopes working in stereoscopic mode .",
    "it is located in namibia , in the khomas highland and has started its operations in 2004 .",
    "each of the present `` small '' cherenkov telescopes ( sct ) has a 12-meter diameter mirror and is equipped with a 960-pixel ( photomultiplier ) camera at its focal plane .",
    "it detects photons in the 100 gev-50 tev energy range . * * in addition to photons showers , the combinatorial background from diffuse sky photons and charged cosmic showers can trigger the telescopes .",
    "stereoscopy allows one to achieve a large rejection of the single muon triggers .",
    "these single muons come from very distant hadronic showers and dominate the single - telescope * * particle triggers @xcite . * * the single muon trigger rate is discussed in section [ sect : part_trig_rates ] .",
    "the h.e.s.s .",
    "collaboration has started to build a fifth , 28-meter - diameter large cherenkov telescope ( lct ) .",
    "the lct will be equipped with a 2048-pixel camera at its focal plane .",
    "the lct will be sensitive to photons down to 10  gev . in normal operation , the scts are triggered only in case of a coincidence with another telescope ( lct or sct ) .",
    "however , the energy threshold of scts is too high to efficiently detect low energy ( @xmath1 gev ) @xmath0 rays . to increase its acceptance at low photon energies",
    ", the hess instrument will have to accept standalone lct triggers . * * assuming similar first level trigger conditions on the scts and the lct , these standalone lct triggers would have a rate which is typically a factor of five larger than h.e.s.s stereoscopic triggers . as shown later in section [ sect : part_trig_rates ] , these triggers are mostly background triggers .",
    "the h.e.s.s .",
    "collaboration has decided to build a second level ( l2 ) trigger board in the camera of the lct to improve the rejection of accidental night - sky background triggers and single muon triggers .",
    "the l2 trigger board is programmable , which gives flexibility in the choice of the trigger algorithms .",
    "for instance , low energy selection algorithms similar to the trigger used by the magic collaboration to detect the pulsed emission from the crab pulsar @xcite can be implemented .",
    "these low energy selection algorithms allow to lower the energy threshold on the lct . alternatively , at constant energy threshold , the gain in bandwidth obtained by rejecting the background events can be used to transfer timing informations on fired pixels to the acquisition farm , in addition to the total charge .",
    "the timing information may be useful for analyzing * * single telescope events , as has also been shown by the magic collaboration @xcite .",
    "topological triggers have been previously used on other cherenkov instruments .",
    "for example , the magic collaboration @xcite * * uses a n - next - neighbor logic in its first level trigger and has designed a second - level trigger which can perform a rough event analysis and * * can apply topological cuts to the images .    in the first part of this paper ,",
    "the various contributions to the lct instrument trigger rate are listed and evaluated .",
    "the next section is devoted to the l2 concept and an example l2 trigger algorithm is given .",
    "the actual l2 trigger board is described in section [ sect : hardware ] .",
    "finally , the on - board implementation of the l2 algorithm is discussed in section [ sect : firmware ] .",
    "the triggering of the h.e.s.s . phase 1 ( hess-1 ) instrument has been described in details in reference @xcite .",
    "it operates in a two - step process . the first step ( hereafter called `` l1 trigger '' ) is a local camera trigger .",
    "it is a multiplicity trigger in overlapping sectors of 64 pixels .",
    "a camera trigger occurs if the signals in m pixels within a sector ( multiplicity threshold ) exceed a threshold of n photoelectrons ( pixel threshold ) .",
    "the effective time window for pixel coincidence is 1.3 ns .",
    "the second step is the so - called `` central trigger '' .",
    "the central trigger system looks for coincidences of telescope triggers inside a 40 ns time window ( `` stereoscopic '' events ) .",
    "the hess-1 array is operated in stereoscopic mode .",
    "a coincidence of at least 2 telescopes is required in the central trigger time window .",
    "data acquisition from the large telescope in the phase 2 of h.e.s.s .",
    "( hess-2 ) will be triggered in three steps .",
    "the first step is a camera - level trigger similar to the l1 trigger of hess-1 .",
    "the camera of the lct has 96 overlapping trigger sectors .",
    "in addition to time coincidences between sct l1 triggers , the central trigger system will check for time coincidences of lct and sct triggers .",
    "the result of the latter coincidence test ( monoscopic or stereoscopic event ) will be sent back to the lct trigger management . as in hess-1 , stereoscopic events will always be accepted . in a third step ,",
    "the lct monoscopic events are accepted or rejected depending on the result of the l2 trigger system computations .",
    "the largest contributions to the trigger rate of single telescopes in @xmath0-ray astronomy are background events . * * an important source of background events comes from the coincidental quasi - simultaneous firing of pixels by diffuse photons , the so - called night sky background ( nsb ) .",
    "the nsb originates in diffuse sources , such as the zodiacal light or unresolved light from the galactic plane , and light from bright stars .",
    "the nsb has been measured at the h.e.s.s .",
    "site and nsb photoelectron rates were derived for the sct @xcite .",
    "the expected nsb photoelectron rate is @xmath2 mhz per pixel at zenith in extragalactic fields . in galactic fields ,",
    "the single pixel rate is higher and reaches 200 - 300 mhz per pixel .",
    "the lct has a larger collection area ( 596 m@xmath3 compared to 108 m@xmath3 ) , but more pixels ( 2048 instead of 960 ) and a smaller angular acceptance ( 3",
    ".  10@xmath4  sr instead of 6 .",
    "10@xmath4  sr ) .",
    "the expected nsb rate per pixel of the lct is thus expected to be larger by a factor 1.3 .",
    "the other source of background is cosmic - ray showers .",
    "these showers are induced by interactions of cosmic hadrons ( proton , helium ) or electrons / positrons in the atmosphere .",
    "the typical proton flux above 3 gev is 600 m@xmath5 sr@xmath6s@xmath6 .",
    "isolated muons from distant hadron showers also trigger single cherenkov telescopes .",
    "these muon triggers dominate the single telescope particle triggers @xcite and are easily rejected by stereoscopic triggers .      the outputs from the electronics channels of h.e.s.s .",
    "were simulated with realistic photomultiplier signal shapes and electronics readout @xcite .",
    "the nsb l1 trigger rate was simulated by adding random photoelectrons to every readout channel .",
    "trigger rates caused by nsb single pixel photo - electron rates of 100 , 200 and 300 mhz have been calculated .",
    "the corresponding lct l1 trigger rates are given in table [ tab : nsb ] for several l1 trigger conditions .",
    "depending on conditions , the estimated rates range from several mhz to less than a few tens of hz .",
    "since the dead time per event of the lct acquisition is of the order of a few microseconds , the acquisition rate should be no more than @xmath7 100 khz .",
    "table [ tab : nsb ] shows that some l1 trigger conditions ( e.g. a pixel multiplicity of 3 with a pixel threshold of 3 and a nsb pixel photo - electron rate of 200 and 300 mhz ) lead to unmanageably high trigger rates .    the * * proton , muon , photon and electron showers were simulated with the kaskade @xcite program , using parameterizations given in reference * * @xcite .",
    "these parametrisations are compared to cosmic ray measurements in reference @xcite .",
    "the proton trigger rate is shown in figure [ fig : protonm4 ] a ) as a function of the pixel threshold in photoelectrons .",
    "as stated in section [ sect : l1trig_general ] , a large fraction of the l1 trigger rate is due to single distant muons .",
    "this can be seen by comparing figures [ fig : protonm4 ] a ) and b ) , the latter giving the total l1 rate contributed by isolated muons .",
    "cosmic ray electrons give a cherenkov signal very similar to the signal of high energy gamma rays .",
    "it is thus not possible to eliminate the electron signal .",
    "further , the electron contribution becomes more important at low energy , since cosmic electrons have a very soft spectrum ( with index @xmath8 ) .",
    "however , the electron background , which is a diffuse source , can be somewhat reduced in point source studies .",
    "the electron l1 trigger rate is plotted in figure [ fig : electronm4 ] .",
    "an electron rigidity cut - off of 7 gv was assumed @xcite .",
    "the electron trigger rate is a few hundred hz for typical l1 trigger conditions .    [",
    "cols=\"^,^ \" , ]      a purely sequential software implementation of the clustering and denoising operators in steps 1 and 3 is clearly time - consuming and sub - optimal .",
    "we thus turned to a parallel hardware implementation  : considering the binary nature of @xmath9 , the non - linear filters involved are easily built using logic and and or gates .",
    "for instance , denoising is achieved by convolving @xmath10 with a simple _ filter _ such that  : @xmath11 where @xmath12 is used to index the 6 nearest neighbors of pixel @xmath13 . a wider _ filter _ with a support extending to second neighbors",
    "is used to detect clusters of at least three pixels as shown in figure  [ fig : neighbors ] . in order to process 32 pixels from 4 adjacent fe boards in parallel",
    ", one needs the values of 58 first and second neighbor pixels from 12 neighboring fe boards as shown in figure  [ fig : neighbors ] . on the edges of the camera , one or more bytes are set to zero .",
    "+ we note here that filtering @xmath9 is a local operation . for this reason ,",
    "the l2 data pipeline reorganizes the input @xmath14 binary data matrix to provide local access to @xmath9 and @xmath15 .",
    "this way , each 32-bit word read by the ppc gives the binary values of 32 pixels from one of the 64 groups of 4 adjacent fe boards of the lct camera and each byte maps to one fe board , as shown in figure  [ fig : neighbors ] .",
    "+ in practice , there are different possibilities for connecting the proposed logic filter to the ppc .",
    "the best timing results were obtained using the apu  @xcite  : experimentally , denoising and 3 pixel cluster detection take @xmath16 ppc clock cycles with using a custom peripheral on the plb while it takes only @xmath17 cycles using the apu .",
    "computing the first and second order moments of the denoised combined map is a common preliminary for the estimation of hillas statistics and other parameters of interest  @xcite .",
    "let us define  : @xmath20 where @xmath13 indexes the 2048 pixels in the processed data maps , and @xmath21 is the weight assigned to pixel @xmath13 .",
    "again , a fully sequential algorithm to compute these quantities is excluded .",
    "fortunately , a faster computation is possible thanks to the structure of the @xmath14 binary data matrix described in the previous section and to the linearity of the above quantities with respect to the pixel weights .",
    "hence the binary maps @xmath22 and @xmath15 can be processed separately and the sums are profitably rearranged for an efficient hierarchical computation of the moments .",
    "first a byte - addressable _ look - up table _ ( lut ) is used to compute the desired statistics on each fe board in a local coordinate frame attached to the 8 pixels on a single fe board as shown in figure  [ fig : neighbors ] .",
    "the lut outputs are then combined locally to compute these statistics for the four fe boards in each of the 64 pairs of drawers .",
    "this local summation requires the lut outputs to be properly _ translated _ depending on the position of a given fe board in the current pair of drawers .",
    "as shown in figure  [ fig : neighbors ] , a different coordinate frame is used when handling the 32 pixels in a pair of drawers . finally , summation over the 64 pairs of drawers requires an additional transformation of these partial statistics to account for the translation and scaling of the local frame required to move a pair of drawer to its correct position within the global coordinate frame of the camera . in the end ,",
    "the contributions of the two binary maps are linearly combined with weights @xmath23 and @xmath24 providing final 32 bit integer statistics @xmath25 , @xmath26 , @xmath27 , @xmath28 , @xmath29 and @xmath30 for the combined map . with this fast implementation",
    ", the ppc computes the first and second order moments of the input data in a maximum of 18000 clock cycles . for a faster execution time , given that these statistics will most often be estimated for low energy events when only very few pixels are high in @xmath22 and even less in @xmath15 , it is worth checking if a byte is zero prior to computing its contribution to the statistics .",
    "as a result the computation time will vary almost linearly with the number of _ active _ bytes in the data .",
    "+ the algorithm proposed in section  [ sec : algosoft ] uses only the first - order statistics to compute the nominal distance obviously in finite precision  : @xmath31 where the factor @xmath32 is due to the equilateral triangular grid and the accompanying @xmath33 left out in the moment computation for simplicity .",
    "the specified precision on the target coordinates is @xmath34 of the unit length , motivating the precision to which the center of gravity ( @xmath35 ) coordinates have to be computed .",
    "finally , thresholding the squared nominal distance avoids the costly computation of a square root .",
    "the accelerated blocks described above ( leaving out second order moments ) were readily integrated into a fully functional l2 trigger system running on the specifically designed hardware . in practice ,",
    "two simple architectures were tested for preliminary timing experiments in order to benchmark the performance of the l2 trigger system .",
    "the first design implements the full default algorithm inside a single fpga .",
    "the second design uses the five virtex4-fx fpgas available on one l2 trigger board . in this case",
    ", the virtex4 on the eb receives the data from the fe , forwards it to the mms and reads back their decisions .",
    "events are assigned to mms in a simple _ round robin _ procedure .",
    "each mm is in charge of executing the complete decision algorithm . in this simple design ,",
    "there is no pipelining of events in the mms . for these experiments ,",
    "an additional evaluation board is used to emulate the l2 trigger s environment .",
    "this testbench is capable of generating l1 trigger events periodically at a specified rate , as well as bursts of specified lengths .    *",
    "* consider first the unrealistic worst case scenario where all events are monoscopic with all pixels high above the higher threshold @xmath36 resulting in the longest processing time . with this setup a stable behavior of the first * *",
    "single fpga system was observed up to a maximum l1 rate slightly above 10  khz .",
    "the second multi - fpga system could sustain a maximum mean rate close to 30  khz .",
    "in fact , the additional communication tasks between the eb and mms in the multi - fpga system are in part responsible for the less than four - fold gain . adding more mms to the system",
    "will only increase the maximum acceptable l1 rate to the point where the slowest concurrent process in the pipeline can handle it , which is @xmath37  khz in the current multi - fpga design .",
    "+ the above estimates are clearly highly pessimistic as they are based on unrealistic data .",
    "a more realistic estimation of the ppc occupancy is plotted in figure  [ fig : maxmeanrate ] for the first implementation of the l2 trigger system .",
    "this estimate is based on the simulated statistical distribution of input events reported in section  [ sec : l1trig ] and on time measurements of the different elementary steps in the l2 trigger pipeline . for typical l1 trigger conditions - multiplicity set to 3 or 4 and pixel threshold between 3 and",
    "7- the estimated average processing time is @xmath7 37  @xmath38s which corresponds to a maximum mean l1 rate of 27  khz .",
    "actually , for these trigger conditions , the system occupancy is estimated @xmath39 % as shown in figure  [ fig : maxmeanrate ] . * * the mean latency of the l2 trigger in its single fpga implementation is the average time spent by an event inside the l2 pipeline .",
    "this includes steps before ( _ i.e. _ data reception and data matrix transposition ) the sequential processing by the ppc and after ( _ i.e. _ transmission of l2 decision ) . experimentally , we measured the average l2 latency to be @xmath40",
    ". the proposed multi - fpga system will obviously provide a larger safety margin in terms of ppc occupancy as well as a shorter latency . in all cases",
    "the definite real l1 rate will have to be determined on site .",
    "this paper describes the design and implementation of the l2 trigger system for the second phase of the h.e.s.s . experiment . the l2 trigger will be used to reject night sky background related and isolated muon events and thus reduce the trigger rate .",
    "the principle of the trigger is to build a 2-bit ( `` combined '' ) map of the camera pixels at the time of trigger .",
    "the night sky background events can then be rejected by demanding clusters of pixels on the combined map .",
    "further rejection of the hadronic background can be obtained by using quantities such as the center of gravity of the triggered pixels . a possible ,",
    "illustrative , algorithm for the l2 trigger system has been given in section [ section2:algorithms ] .",
    "this example algorithm shows that the required rejection of night sky background and isolated muon triggers is achievable .",
    "the hardware and software integration into the lct camera of the previously described system based on a single virtex-4fx12 fpga has been achieved .",
    "the l2 system still needs to be fully integrated in the h.e.s.s .",
    "acquisition and tested with real data .",
    "this will be achieved at the beginning of the hess-2 phase .",
    "the authors are grateful to d.  besin and h.  zaghia for the layout of the cpci board , to p.  nayman for providing the firmware for the pci bridge and to the anonymous reviewers for their valuable comments and suggestions .",
    "99 e.aliu et al , science , 322,1221 ( 2008 ) e.aliu et al , astropart phys .",
    "30 , 293 ( 2009 ) d.bastieri et al , nucl .",
    "instrum . meth .",
    "a461 , 521 ( 2001 ) j. cortina , j.c.gonzalez , astropart .",
    "15 , 203 ( 2001 ) s.funk et al , astropart.phys .",
    "22 , 285 ( 2004 ) j.guy , p.vincent , j - p .",
    "tavernet & m.rivoal , astropart .",
    "phys.17 , 409 ( 2002 ) j.guy , phd .",
    "thesis , universit pierre et marie curie , ( 2003 ) m.p .",
    "kertzman & g.h sembroski , nucl .",
    "a343 , 629 ( 1994 ) s.preuss et al , nucl.instrum.meth.a481,229 ( 2002 ) compactpci specification - picmg 2.0 r3.0 ( 1999 ) a.m.hillas , space science reviews , 75 , 17 ( 1996 ) h.h.ng and l.pillai , xilinx application notes , 717 ( 2005 )"
  ],
  "abstract_text": [
    "<S> h.e.s.s is an array of atmospheric cherenkov telescopes dedicated to gev - tev @xmath0-ray astronomy . </S>",
    "<S> the original array has been in operation since the beginning of 2004 . </S>",
    "<S> it is composed of four 12-meter diameter telescopes . </S>",
    "<S> the installation of a fifth 28-meter diameter telescope is being completed . </S>",
    "<S> this telescope will operate both in stereoscopic mode and in monoscopic mode _ </S>",
    "<S> i.e. _ without a coincident detection on the smaller telescopes . </S>",
    "<S> a second - level trigger system is needed to supress spurious triggers of the 28-meter telescope when operated in monoscopic mode . </S>",
    "<S> this paper gives the motivation and principle of the second - level trigger . </S>",
    "<S> the principle of operation is illustrated by an example algorithm . </S>",
    "<S> the hardware implementation of the second level trigger system of h.e.s.s . </S>",
    "<S> phase 2 is described and its expected performances are then evaluated . </S>"
  ]
}