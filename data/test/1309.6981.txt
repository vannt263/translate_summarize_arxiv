{
  "article_text": [
    "organic / inorganic interfaces are ubiquitous in many different mesoscopic composites of importance in materials science and nanotechnology .",
    "it is well - known that the performances of organic - based devices , organic or dye sensitized solar cells and molecular diodes / transistors only to name a few , depend strongly on the details of the metal / molecule interface @xcite .",
    "for instance , in organic solar cells the position of the frontier molecular orbitals of the organic light harvesting material with respect to the electrode bands is a key design quantity for engineering materials combinations with enhanced light - to - current conversion .",
    "it is then of great importance to have at hand computational tools capable of accurate predictions of levels alignment .",
    "this is however a tough theoretical problem .",
    "it has been demonstrated experimentally @xcite that the quasi - particle energy gap ( @xmath0 ) of a molecule , defined as the difference between its ionization potential ( ip ) and electron affinity ( ea ) , gets reduced with respect to that of the gas phase by adsorbing the molecule on a polarizable substrate . in a quasi - particle picture",
    "the ip is the negative of the homo energy ( homo , highest occupied molecular orbital ) , while the ea corresponds to the energy of the lumo ( lumo , lowest unoccupied molecular orbital ) .",
    "the reduction of the ip and ea of a molecule adsorbed on a metallic surface is mainly due to the coulomb interaction between the added charge on the molecule and the screening electrons in the substrate .",
    "this interaction leads to a polarization of the surface , so that a surface charge with opposite sign with respect to the charge state of the molecule is formed .",
    "this non - local feature , called image - charge effect , becomes more relevant as the molecule gets closer to the metallic surface . as a consequence",
    "the reduction of the ip and the ea , hence of the homo - lumo gap , becomes more prominent with the molecule approaching the surface , as schematically illustrated in fig .",
    "[ energy - distance](a ) .",
    "in general , conventional electronic structure theory struggles when predicting the levels alignment at a metal / molecule interface , since only rarely non - local correlation effects are explicitly included .",
    "this is for instance the case of density functional theory ( dft )  @xcite , today the most widely used method for computing the electronic structure of materials .",
    "in particular there are two important issues related to dft and the problem of levels alignment . on the one hand ,",
    "the kohn - sham eigenvalues can not be rigorously interpreted as removal energies , koopman s theorem in general does not apply , so that the kohn - sham spectrum can not be taken as a quasi - particle spectrum .",
    "the only exception is the homo ( but not any of the homo-@xmath1 levels ) , which can be associated to the negative of the ip  @xcite . even leaving interpretative issues aside in practice",
    "the kohn - sham energy levels often are not a good representation of the true excitation spectrum of a material , namely they are not found at the correct energy position . on the other hand , in static dft the standard approximations to the exchange and correlation functional , including the local density approximation ( lda )  @xcite , hybrid functionals @xcite or explicitly self - interaction corrected ones @xcite , do not include or they do but just poorly , non - local correlation effects .",
    "this means that , although some of the functionals can predict with satisfactory accuracy the energy levels of the molecule in the gas phase , they all fail in describing properly the level renormalization as the molecule approaches the surface .",
    "for instance in the lda there is no change in the homo - lumo gap as a molecule gets closer to a metallic surface  @xcite .    a conceptually straightforward way to include such non - local correlation effects in the description",
    "is that of using many - body perturbation theory , namely the gw approximation constructed on top of dft  @xcite .",
    "this approach has been used in the last few years for predicting levels alignment  @xcite , in general with a good success .",
    "the drawback of the gw scheme stays with its computational overheads , which limit the system size that can be tackled .",
    "this is particularly critical for the problem at hand since the typical simulation cells for a molecule on a surface are in general rather large .",
    "furthermore , as the image charge may spread well beyond the size of the molecule investigated , one may even require cells significantly larger than those needed to physically contain the molecule .",
    "alternatives to the gw approach , which to some degree also go beyond taking the simple dft kohn - sham spectrum , include scissor operators ( the dft+@xmath2 approach ) @xcite , where the homo and lumo eigenvalues are shifted to match values obtained either from experimental data or from separate total energy difference calculations ( @xmath3scf ) plus classical image charge models , and modified @xmath3scf schemes @xcite .    among the various possibilities constrained dft ( cdft ) represents a conceptually different approach to the problem .",
    "the idea behind cdft is that one can always define an appropriate density functional , implementing a given desired constraint on the charge density  @xcite ( e.g. one can demand that an electron is localized on a particular group in a molecule ) .",
    "this is obtained by introducing an appropriate external potential in the kohn - sham equations .",
    "the crucial point is that the approach is fully variational , meaning that the energy minimum of the constrained functional represents the ground state of the system under that particular constraint  @xcite .",
    "the method allows , for example , to access energies and electron density distributions of charge transfer states of a given system , and has been successfully applied to the study of long - range charge transfer excitations between molecules @xcite . in the present study",
    "we apply cdft to the investigation of the energy level alignment of metal / molecule interfaces . in relation to this problem cdft",
    "has two main advantages .",
    "firstly , since cdft is based on total energy differences it does not present the conceptual problems of interpreting the kohn - sham eigenvalues as a true quasi - particle spectrum . secondly , one has to note that the total energy , even in the case of local functionals , is a rather accurate quantity , in contrast to the charge density that local functionals usually tend to over - delocalize .",
    "this means that a theory that improves the charge density but that relies on the total energy is expected to be accurate .",
    "the present paper is organized as follows .",
    "firstly we provide a description of the cdft method used with details on how the constrained is imposed",
    ". then results for a specific system consisting of a benzene molecule deposited on a li(100 ) surface are presented , focusing on charge transfer energies , and hence level alignment . in particular",
    "we evaluate the quantitative accuracy of the results as a function of the distance between the molecule and the surface , and its dependence on a set of parameters such as the system size and the boundary conditions ( periodic versus finite ) . towards the end",
    "we evaluate the changes in the electron density caused by the net charge on the molecule , and in particular we determine the position of the image charge plane as function of molecule - surface distance .",
    "we then use the calculated image charge plane position in a classical model for the energy level shifts and compare our _ ab initio _ energies to available gw results .    , due to polarization of the metal .",
    "( b ) top - view ball - stick representation of a benzene molecule at a li(001 ) surface for a li(001 ) 12@xmath412 supercell .",
    "the dashed rectangles show the 3@xmath43 ( purple ) and 6@xmath46 ( green ) supercells .",
    "the inset in panel ( b ) is the side view of the benzene lying flat at a distance @xmath5 from the surface.,scaledwidth=48.0% ]",
    "in the kohn - sham ( ks ) framework@xcite the total energy ( in atomic units ) is given by @xmath6=\\sum^{\\alpha,\\beta}_{\\sigma}\\sum_i^{n_{\\sigma}}{\\color{black}\\left<\\left.\\phi_{i\\sigma}\\right|\\right.\\color{black}}-\\frac{1}{2}\\nabla^2{\\color{black}\\left|\\left.\\phi_{i\\sigma}\\right>\\right.\\color{black}}+ \\\\+\\int d\\bf{r}\\ , \\textit{v}_{\\textit{n}}(\\bf{r})\\rho(\\bf{r})+{\\textit j}[\\rho]+{\\textit e}_{\\text{xc}}[\\rho^{\\alpha},\\rho^{\\beta}]\\ : , \\label{ks - energy } \\end{split}\\ ] ] where @xmath7 is the hartree energy , @xmath8 is the exchange - correlation energy , @xmath9 is the external potential , @xmath10 is the electronic density for spin @xmath11 of @xmath12 electrons ( @xmath13 ) and the set @xmath14 contains the ks wavefunctions that minimize the energy .",
    "a generic constraint on the charge density is that there is a specified number of electrons for each spin , @xmath15 , within a certain region of space .",
    "this can be written as @xmath16 where @xmath17 is a weighting function that describes the spatial extension of the constraining region . in the simplest case @xmath17",
    "can be chosen to be equal to 1 within a certain volume and 0 elsewhere . in order to minimize the ks total energy of eq .",
    "[ ks - energy ] subject to the constraint of eq .",
    "[ constr ] , an additional spin - dependent term , proportional to the lagrange multiplier @xmath18 , is added to the energy . a new functional",
    "is thus defined to be @xmath19=e[\\rho]+\\sum_{\\sigma}v_\\mathrm{c}^\\sigma\\left(\\int w^{\\sigma}_{\\mathrm{c}}(\\bf{r})\\rho^{\\sigma}(\\bf{r})\\textit{d}\\bf{r}- \\textit{n}_\\text{c}^\\sigma\\right)\\ : .",
    "\\label{new - functional}\\ ] ] + when @xmath20 satisfies the constraint in eq .",
    "[ constr ] then @xmath21=w[\\rho , v_\\mathrm{c}]$ ] by construction .",
    "up to the @xmath20 independent term @xmath22 , @xmath23 $ ] is the ground state energy of a system with an additional spin - dependent external potential @xmath24 . the ks equations with this extra potential",
    "are then given by @xmath25\\phi_i^\\sigma(\\bf{r})=\\epsilon_i\\phi_i^\\sigma(\\bf{r})\\ : ,   \\label{ks - equations } \\end{split}\\ ] ] where @xmath26 is the exchange and correlation potential .",
    "as in standard kohn - sham dft the electron density is constructed from the occupied kohn - sham eigenvectors , @xmath27 , until self - consistency is achieved . in this particular case the self - consistency has also to guarantee that the constraint set by eq .",
    "( [ constr ] ) is satisfied .",
    "the minimization then proceeds as follows .",
    "firstly , as in the standard kohn - sham scheme , an initial charge density is defined and then updated until the kohn - sham equations are satisfied self - consistently .",
    "secondly , at every self - consistent step in this update of the charge density a second self - consistent loop is performed , where for a given input density , @xmath28 , the value of @xmath18 is updated until the output charge density obtained via solution of eq .",
    "( [ ks - equations ] ) satisfies the constraint of eq .",
    "( [ constr ] ) .",
    "this second step is performed following an optimization scheme suggested in ref .",
    "updating @xmath18 in this way ensures that at each self - consistent step and therefore also at convergence the constraint is fulfilled .",
    "this methodology was implemented in the dft package siesta  @xcite .",
    "siesta uses a linear combination of atomic orbitals ( lcao ) basis set , so that , instead of defining the constraining region in real space via the function @xmath29 , we define it over the lcao space .",
    "this means requiring that the total charge projected onto a given set of basis orbitals is equal to @xmath30 . for this aim",
    "we have implemented both the lwdin  @xcite and the mlliken  @xcite projection schemes .",
    "a detailed description of the implementation is given in the appendix .",
    "at the quantitative level our results depend somewhat on the projection method employed , and it has been shown that usually the lwdin scheme gives the most accurate results @xcite .",
    "using such a cdft approach we can evaluate the charge transfer energy between the molecules and the metal surface , and hence the position of the frontier energy levels with respect to the fermi energy of the metal .",
    "for a given substrate size and perpendicular distance , @xmath5 , between the molecule and the surface atoms , first a standard dft calculation without constraints is performed .",
    "this determines the total ground state energy of the combined molecule+substrate system , @xmath31 , and the amount of charge present on each fragment , one fragment being the molecule and the other the substrate . in our calculations",
    "we consider @xmath5 ranging from 4  to 14 , where the molecule is only weakly coupled to the substrate , so that the amount of charge on each fragment is a well defined quantity .",
    "although cdft is designed for arbitrary geometries and constraints , in the case of overlapping fragments the amount of charge localized on each fragment becomes ill defined and the results have to be taken with care  @xcite .",
    "the next step consists in performing a new dft calculation , where the constraint is set in such a way that one electron is removed from the molecule and one electron is added to the substrate .",
    "the total energy of such charge transfer state is @xmath32 .",
    "hence the charge transfer energy needed to transfer one electron from the molecule to the substrate , @xmath33 , is given by @xmath34 in an analogous way we obtain the charge transfer energy gained by moving one electron from the surface to the molecule , @xmath35 , as @xmath36 where @xmath37 is the cdft ground state energy of the configuration where one electron is moved from the metal surface to the molecule .",
    "we note that such procedure always deals with globally charge neutral simulation cells , so that no monopole energy corrections are necessary under periodic boundary conditions .",
    "moreover for practical calculations the charge - transfer approach can be expected to be more accurate than a calculation using non - neutral cells , where the metal is kept neutral but the molecule is charged . for such non - neutral calculations the image charge is formed on the metal surface in an analogous way to the charge - transfer setup .",
    "however , in order for the metal cluster to be charge neutral a charge with opposite sign will also form on the surface of the metallic cluster .",
    "given the finite size of the cluster this will lead to additional inaccuracies due to the interaction between the image charge and such spuriously - confined additional surface charge .    within the charge transfer procedure we can directly determine the energy level alignment at the interface , since -@xmath38 ( -@xmath39 ) corresponds to the energy of the homo ( lumo ) with respect to the substrate fermi energy . in a similar constrained - dft approach",
    "@xcite sau and co - workers calculated the charging energy associated to transferring small amounts of charge from the substrate to a specific molecular orbital .",
    "the charge transfer energy was then obtained by extrapolation to integer charge . in order to avoid the use of such extrapolation here we always transfer an entire electron between the molecule and the substrate .",
    "since a cdft calculation has a computational cost only marginally more expensive than that of a standard dft ground - state one ( the cpu time increases by about a factor two over the entire self - consistent cycle ) , cdft allows us the study of large organic molecules on surfaces .",
    "this is a prohibitive task for many - body - corrected quasi - particle schemes , such as the gw method .",
    "we apply our cdft method to compute the energy level alignment of a benzene molecule as a function of its distance , @xmath5 , from a li(100 ) surface .",
    "the calculations are performed using norm - conserving relativistic pseudopotentials  @xcite , and the lda  @xcite for the exchange - correlation potential .",
    "the real space grid is set by an equivalent mesh - cutoff of 300 ry and the charge density and all the operators are expanded over a double-@xmath40 polarized basis set with an energy - shift of 0.03  ev  @xcite .",
    "the li metallic surface is modeled by a 6 atomic layer thick slab .",
    "the _ bcc _ primitive unit cell lattice constant is set to 3.51   .",
    "we consider two types of boundary conditions in the plane of the li substrate surface , namely periodic boundary conditions ( pbc ) and non - periodic boundary conditions ( non - pbc ) .",
    "furthermore , in order to investigate the finite size effects originating from the size of the li surface , we consider three different cell sizes ( for both pbc and non - pbc ) , namely small ( 3@xmath43 atoms per layer ) , intermediate ( 6@xmath46 ) and large ( 12@xmath412 ) ( see fig .",
    "[ energy - distance ] ) . in the case of non - pbc the real - space box containing the li slab supercell has dimensions 55@xmath455@xmath455  @xmath41 .",
    "this is chosen in such a way that even for the 12@xmath412 slab there is at least 15    of vacuum between the li slab and the boundaries of the simulation box . by using a cubic box",
    "one can apply madelung corrections in siesta .",
    "these are necessary since the electrostatic potential is calculated by using periodic boundary conditions  @xcite . in the case of pbc the in - plane dimensions are set by the li supercell size and thus are 10.56@xmath410.56  @xmath42 , 21.09@xmath421.09  @xmath42 and 42.12@xmath442.12  @xmath42 , respectively for the 3@xmath43 , 6@xmath46 and 12@xmath412 cell .",
    "the cell dimension in the direction perpendicular to the surface plane is the same as for the case of non - pbc , namely 55   .",
    "we use two different boundary conditions for the li surface in order to investigate the effects arising from the spurious dipole - dipole interaction between image supercells .",
    "the size of this spurious interactions can be reduced by increasing the size of the unit cell . for the pbc setup the dimensions in the plane",
    "are set by the li cluster size , while for non - pbc calculations we use a large simulation cell which minimizes the dipole - dipole interaction between periodic images . in this way we can disentangle the effects of changing the extension of the li surface in plane from those associated with the size of the simulation box .",
    "furthermore , in the case of non - pbc , edge effects may arise and our aim is to find the required cluster and cell size that gives quantitatively accurate charge transfer energies .",
    "in order to determine the energy level alignment between the molecule and the surface , we first need to determine the li workfunction ( wf ) .",
    "this is calculated by performing a simulation for the li slab with pbc and no benzene adsorbed and by taking the difference between the vacuum potential and the slab fermi energy .",
    "the so obtained value for the li(001 ) wf is 2.91  ev .",
    "this is in fair agreement with previous calculations ( 3.03 ev )  @xcite , which have also shown that the li wf can vary by about 0.5  ev depending on the crystallographic orientation of the surface .",
    "the experimental values reported for polycrystalline li vary considerably ( 2.3 - 3.1  ev ) , as discussed in ref . @xcite and references therein .    in the case of non - pbc",
    "the li substrate is essentially a giant molecule and we can calculate the ip and the ea by means of the @xmath3scf method , where @xmath43 and @xmath44 ( @xmath45 is the number of electrons in the neutral system ) .",
    "the results are listed in tab .",
    "[ ip - ea ] for the different li cluster sizes .",
    "we note that there is a substantial difference between the ip and the ea , resulting in a quasi - particle energy gap of the order of 1 ev for the li clusters .",
    "such a gap arises because of the charge confinement in the finite cluster . in this case electron - electron repulsion energy leads to a decrease of the ea and an increase of the ip as compared to the wf calculated with pbc .",
    "if instead of adding a full electron we add / remove a small fractional charge ( 0.1 of an electron ) , electron - electron repulsion energy becomes negligible , the gap disappears , and we obtain ip=3.1  ev and ea=3.0  ev .",
    "likewise , the gap is reduced for larger clusters , in which the electron density of the additional electron / hole can delocalize more . before investigating the combined molecule /",
    "li system we calculate also the ip and the ea for the isolated benzene molecule , and our results are shown in tab .",
    "[ ip - ea ] .",
    "we find the energy gap for the molecule in the gas phase , @xmath46 , to be in good agreement with experiments @xcite , with other works using the @xmath3scf @xcite approach and with gw calculations @xcite .",
    "cccccccc & & & & & + & 3@xmath43 & 6@xmath46 & 12@xmath412 & + & & & @xmath3scf & @xmath47 & exp . +    ip & 3.46 & 3.44 & 3.55 & & 9.56 & 9.23@xmath48/9.05@xmath49/7.9@xmath50 & 9.24@xmath51 + ea & 1.57 & 2.18 & 2.63 & & -1.45 & -0.80@xmath48/-1.51@xmath49/-2.7@xmath50 & -1.14@xmath52 + @xmath0 & 1.89 & 1.26 & 0.92 & & 11.01 & 10.51@xmath53/10.55@xmath49/10.6@xmath50 & 10.38 +    [ ip - ea ]    @xmath48ref .",
    "[ ] ; @xmath53ref .",
    "[ ] ; @xmath51ref .",
    "[ ] ; @xmath52ref .",
    "[ ] ; @xmath50ref .",
    "[ ] ; @xmath49ref .",
    "[ ] +    the benzene / li interface [ see fig . [ energy - distance](b ) ] consists of a benzene molecule , in its gas phase geometry , positioned parallel to the li surface at a distance @xmath5 .",
    "we now evaluate the dependence of the various charge transfer energies ( positions of the homo and lumo ) on @xmath5 for all the different li supercells as well as for both non - pbc and pbc .    , and removal energy , @xmath54 , as a function of the molecule - surface distance , @xmath5 , for the three clusters considered .",
    "panels ( a ) and ( b ) are for non - pbc and pbc calculations , respectively .",
    "the green dashed - lines represent the negative of the @xmath55 and @xmath56 of the isolated molecule ( @xmath3scf calculations ) shifted by the calculated li wf of 2.91  ev.,scaledwidth=48.0% ]    we start by presenting our results for calculations performed with non - pbc . in fig .",
    "[ gap - distance](a ) we plot @xmath57 and @xmath58 as a function of @xmath5 for all the three li clusters considered . as expected , due to the electron - hole attraction , the absolute value of the charge transfer energy decreases as @xmath5 gets smaller .",
    "this in itself shows that cdft can capture non - local coulomb contributions to the energy .",
    "while for small @xmath5 the energies of the three different clusters are approximately equal to each other , for large distances they differ significantly . in order to determine the origin of such deviations we evaluate the same energies in the limit of very large distances ( @xmath59 ) , where they become @xmath60 and @xmath61 since the interaction energy between the charge on the li slab and that on the molecule vanishes for @xmath59 .",
    "the charge transfer energy gap is then given by @xmath62 while @xmath55 and @xmath56 are independent of the cluster size , this is not the case for @xmath63 and @xmath64 ( see table  [ ip - ea ] ) .",
    "this reflects in the fact that the charge transfer energies at large molecule - surface separation varies with the cluster size ( see table  [ charge - transfer ] ) .",
    ".charge transfer energies ( in ev ) in the limit of large distances ( @xmath59 ) for the three molecule / li cluster cells investigated .",
    "values are obtained by evaluating eqs .",
    "[ ip - ct]-[gap - ct ] with the @xmath65 and the @xmath66 taken from tab .",
    "[ ip - ea ] . [ cols=\"<,^,^,^ \" , ]     [ charge - transfer ]    at large distances the variation of @xmath67 with the li cluster sizes is mainly caused by significant changes in @xmath64 .",
    "interestingly this is not the case for @xmath35 , since @xmath63 is approximately the same for all the li clusters considered . as @xmath5 gets smaller the extension of the image charge on the li slab",
    "is reduced , so that even small clusters are large enough to contain most of the image charge .",
    "therefore the energy differences depend less on the cluster size . for @xmath5",
    "up to about 6   , fig .",
    "[ gap - distance](a ) shows that @xmath67 and @xmath35 are converged even for the small 3@xmath43 supercell . since in organic - based devices",
    "the first molecular layer deposited on top of the metallic substrate is typically rather close to the surface , we expect that in these situations a rather small cluster size will be already sufficient for our cdft scheme to yield accurately converged levels alignment .",
    "this means that the cdft approach is a valuable tool for an accurate evaluation of the electronic structure of molecules on surfaces in realistic conditions . finally , when one looks at larger @xmath5 , it is immediately clear that larger cluster sizes must be considered . the green dashed lines in fig .",
    "[ gap - distance ] correspond to the infinite cluster size limit , for which we have @xmath63=@xmath64=wf@xmath68  2.9 ev .",
    "it can then be seen that even up to the largest considered @xmath5 of 14   results obtained for the 12@xmath412 cluster are within the infinite cluster limit ( set in the figure by the two green dashed lines ) , so that they can be considered converged .    .",
    "note the formation and the spatial distribution of the image charge .",
    "different panels correspond to different molecule / surface distances , @xmath5 .",
    "the isosurfaces are taken at 10@xmath69e / @xmath41 .",
    "red isosurfaces denote negative @xmath70 ( electrons depletion ) , while blue are for positive @xmath70 ( electrons excess ) .",
    "( b ) position of the charge image plane taken from the surface atoms [ see eq .",
    "( [ image - charge - plane ] ] , respectively when one electron , @xmath71 , or one hole , @xmath72 , is transferred from the molecule to the li substrate for the 12@xmath412 pbc calculations as a function of @xmath5 .",
    "( c ) , ( d ) and ( e ) are @xmath73 , @xmath74 and @xmath75 , respectively , as a function of @xmath5 and compared with the classical model of eq .",
    "( [ classical - model ] ) . the dashed - green lines are -@xmath55 and -@xmath56 calculated with @xmath3scf.,scaledwidth=45.0% ]    we now move to the case of pbc , in which there are no edge effects due to the finite size of the cell .",
    "results for the charge transfer energies are presented in fig .",
    "[ gap - distance](b ) .",
    "although the general trends are analogous to the ones found for the case of non - pbc , we note that for the 3@xmath43 supercell the changes in the charge transfer energy as a function of @xmath5 are largely overestimated .",
    "this is due to the use of pbc , in which the lateral dimensions of the supercell box coincide to those of the li slab ( i.e. there is no vacuum ) . because of the pbc one effectively simulates a layer of charged molecules and not a single molecule on the surface",
    "thus , when the molecules are closely spaced , the charge transfer energy is that of two opposite charged surfaces facing each other ( the molecular layer and the li slab ) .",
    "this is significantly larger than that of a single molecule ( note that we always compare the charge transfer energy per cell , i.e. per molecule ) . when one increases the size of the supercell and arrives to 12@xmath412 ,",
    "both pbc and non - pbc calculations produce the same results .",
    "this confirms the observation that the 12@xmath412 supercell is large enough to contain a substantial part of the image charge as well as to minimize the coulomb interaction between repeated supercell images up to @xmath76  14   .    from the charge transfer energies we can now obtain an approximate value of the energies of the homo and lumo orbitals , by offsetting them with the metal wf , so that @xmath77 and @xmath78 .",
    "note that if the metal substrate is semi - infinite in size , then these relations become exact , since by definition the energy required to remove an electron from the metal and that gained by adding it are equal to the workfunction .",
    "however , in a practical calculation a finite size slab is used , and therefore the relations are only approximately valid due to the inaccuracies in the calculated wf for finite systems . as shown above , the wf becomes more accurate as the cluster size is increased .    in the figures [ image - charge - iso](d ) and",
    "[ image - charge - iso](e ) we show the calculated values for the 12@xmath412 supercell and pbc obtained by using the li wf of the infinite slab of 2.91  ev , and in fig .",
    "[ image - charge - iso](c ) we present @xmath79 .",
    "in order to quantify how the image charge changes the charge transfer energies as a function of @xmath5 , we can write @xmath80 , where the new quantity @xmath81 corresponds to the energy lowering due to the distance dependent electron - hole attraction .",
    "it was demonstrated a long time ago  @xcite , by using self - consistent dft calculations , that for flat surfaces @xmath81 can be accurately approximated by the classical image charge energy gain @xmath82 where @xmath83 is the charge on the molecule , and @xmath84 is the height of the image charge plane with respect to the topmost surface atomic layer @xmath85 in other words @xmath84 can be interpreted as the center of gravity of the screening charge density localized on the metal surface , and in general it depends on @xmath5 . here",
    "@xmath86 and @xmath87 is the difference between the charge densities of the dft ( ground state ) and the cdft ( charge transfer state ) solutions for a fixed @xmath5 .",
    "note that the charge transfer between the surface and the molecule leads to the formation of a spurious charge layer on the back side of the li slab ( i.e. opposite to the surface where the molecule is placed ) , which is due to the finite number of atomic layers used to simulate the metal surface . in order not to consider such spurious charge while evaluating the integral in eq .",
    "[ image - charge - plane ] , the two integration limits , @xmath88 and @xmath89 , are chosen in the following way : 1 ) @xmath88 is taken after the first two @xmath90 charge oscillations on the back of the cluster , and 2 ) @xmath89 is the distance at which @xmath90 changes sign between the top li layer and the molecule ( i.e. it is in the vacuum ) .",
    "[ image - charge - iso](a ) provides a visual representation of the image charge formation as the molecule approaches the surface and shows isosurface plots of @xmath91 for different distances @xmath5 .",
    "here we present the case in which one electron is removed from the molecule and added to the li surface .",
    "as one would expect , the further away the molecule is from the surface the more delocalized the image charge becomes  @xcite .",
    "note that the isosurface value is kept constant for all @xmath5 ( @xmath92e / @xmath41 ) , so that the apparent shrinking of the image charge for @xmath76  11    simply reflects the fact that most of the image charge is now spread at an average density smaller than 10@xmath69e / @xmath41 .",
    "likewise , no isosurface contour appears on the li slab for @xmath76  14   , since now the image charge is rather uniformly spread at low density .",
    "in contrast at small @xmath5 the oscillations of the charge density between the atomic layers of the metallic surface can also be seen .",
    "it can also be seen that at 4   the charges on the molecule and the image charge on the li surface start to overlap .",
    "note that for even shorter distances , when the overlap becomes very large , the cdft approach presented here becomes ill defined , since the charge on each fragment is not well defined anymore .    by evaluating eq .",
    "[ image - charge - plane ] we now determine @xmath93 and the results obtained for the 12@xmath412 pbc calculations are shown in fig .",
    "[ image - charge - iso](b ) for both electron ( @xmath71 ) and hole ( @xmath72 ) transfer from the molecule to the surface .",
    "the average @xmath84 values are 1.81    and 1.72    for @xmath71 and @xmath72 , respectively .",
    "although the two values are similar , they are not identical .",
    "this is consistent with the small band - gap of the li slab , which indicates that holes and electrons behave differently .",
    "the average values of @xmath71 and @xmath72 can now be used to evaluate eq .",
    "[ classical - model ] for the classical model .",
    "the results are shown in the figures [ image - charge - iso](c ) through [ image - charge - iso](e ) and demonstrate that the classical model works remarkably well for this system ( the calculated slope of both @xmath94 and @xmath94 matches almost perfectly that obtained by cdft ) .",
    "it also shows once again that the results for our 12@xmath412 pbc cell are indeed well converged with respect to the slab and cell size .",
    "finally we make a comparison between our results and those available in the literature for many - body based calculations .",
    "we find an overall reduction of @xmath95 of 2.5  ev , when the benzene moves from infinity to @xmath96   .",
    "garcia - lastra _",
    "_ et al.__@xcite studied the dependence of the frontier quasi - particle energy levels of a benzene molecule as a function of the distance to a li substrate by means of gw calculations .",
    "they found an overall reduction in @xmath0 of @xmath973.2  ev as compared to the benzene homo - lumo gap in the gas phase , as one can extract from fig .",
    "1(c ) of ref .",
    "the authors also fit their gw results to the classical model , finding the best match fitting for @xmath98   , in very good agreement with our calculated value .",
    "there is a small discrepancy in the results of ref .",
    "[ ] , since if one uses the classical model of eq .",
    "( [ classical - model ] ) with @xmath98   , then the homo - lumo gap reduction should be smaller than 3.2 ev , namely 2.6  ev at @xmath96   . note that the gw results are obtained for cells much smaller than the converged 12@xmath412 used here .",
    "if we now force the classical model to fit our results for the 3@xmath43 and 6@xmath46 supercells , we will obtain respectively @xmath99    and @xmath100 , for a corresponding gap reduction of 3.27  ev and 3.0  ev . in these two cases",
    "however the fit is good at all @xmath5 only for the 6@xmath46 supercell , while it brakes down for the 3@xmath43 one for @xmath5 beyond 8   .",
    "this is somehow expected since for large molecular coverages ( the 3@xmath43 cell ) the point - like classical approximation is no longer valid .",
    "in summary , we have implemented and applied cdft to determine the energy levels alignment of metal / organic interfaces in the weak electron coupling regime , i.e. for molecules physisorbed on surfaces . in particular",
    "we have demonstrated how the frontier energy levels of a benzene molecule change , leading to a homo - lumo gap reduction , when the molecule is brought close to a li(100 ) surface .",
    "this effect is due to the screening charge formed on the metal surface .",
    "we have then shown that , in order to obtain quantitatively converged results , rather large metal cluster sizes are needed for large distances , whereas at small molecule - metal separations smaller clusters can also give quantitatively accurate results .",
    "our calculated value for the image charge plane is 1.72   and 1.80   for ea and ip , respectively , in good agreement with the values fitted from gw calculations . using these distances for the image charge plane height",
    "we have compared our _ ab initio _ results with a classical electrostatic model and found good agreement .",
    "the approach presented here offers several advantages over many - body quasi - particles schemes , namely : ( i ) rather large systems can be calculated , since the computational costs are similar to those of standard dft calculations ; ( ii ) surfaces with arbitrary shapes and reconstruction can be studied , including defective and contaminated surfaces ; ( iii ) it gives a direct way of determining the position of the image charge for such interfaces .",
    "overall cdft applied to the levels alignment problem appears as a promising tool for characterizing theoretically organic / inorganic interfaces , so that it has a broad appeal in fields such as organic electronics , solar energy devices and spintronics .",
    "the authors are thankful to the king abdullah university of science and technology ( kingdom of saudi arabia ) for the financial support through the acrab project and to the trinity college high - performance computer center for computational resources .",
    "our implementation of the constrained dft approach within siesta follows the prescription of wu _ et al . _",
    "described in ref . .",
    "accordingly , we begin by defining a set of constraints on the electronic spin density of the form @xmath101 wherein @xmath102 represents the spin index , @xmath103 is a weight function corresponding to the constraint k , defining the property being constrained and @xmath104 is the constraint value .",
    "the total electron density is given by @xmath105 where @xmath106 is the number of occupied kohn - sham orbitals @xmath107 .",
    "a lagrange multiplier , @xmath108 , is associated to each constraint specified in eq .",
    "( [ cons ] ) .",
    "this allows the following modified energy functional to be defined @xmath109=e[\\rho]+\\sum_{\\mathrm{k } } v_{\\mathrm{k } } \\bigg [ \\sum_\\sigma \\int w_{\\mathrm{k}}^\\sigma({\\mathbf{r}})\\rho^\\sigma({\\mathbf{r}})d{\\mathbf{r}}-n_{\\mathrm{k } } \\bigg]\\:,\\ ] ] with @xmath21 $ ] being the standard kohn - sham ( ks ) energy functional given by @xmath110=\\sum_\\sigma \\sum_i^{n_\\sigma } \\langle \\phi_i^\\sigma|-\\frac{1}{2}\\nabla^2|\\phi_i^\\sigma\\rangle & +   \\int v_{ext}({\\mathbf{r}})\\rho({\\mathbf{r } } ) + \\\\ & + j[\\rho]+e_{\\mathrm{xc}}[\\rho^\\uparrow,\\rho^\\downarrow]\\:.\\nonumber\\end{aligned}\\ ] ] in eq.([ksenergy ] ) the first term is the kinetic energy , @xmath111 is the external potential , @xmath112 $ ] is the classical coulomb energy and @xmath113 $ ] is the exchange - correlation energy .",
    "the variational principle yields the stationary condition for the functional @xmath114 with respect to the normalized orbitals @xmath115 , which leads to the following modified kohn - sham equations @xmath116\\phi_i^\\sigma({\\mathbf{r } } ) =   \\epsilon_i^\\sigma \\phi_i^\\sigma({\\mathbf{r}})\\:.\\nonumber\\end{aligned}\\ ] ] thus the constraints enter the effective ks hamiltonian in the form of an additional external potential @xmath117 .",
    "the ground - state of the constrained ks system is obtained by solving eq .",
    "( [ kseq ] ) in conjunction with eq .",
    "( [ cons ] ) .",
    "_  have shown @xcite that the functional @xmath114 is concave with respect to the parameters @xmath108 and that by optimizing @xmath114 through varying @xmath118 , one can find the constraint potential that yields the ground - state of the constrained system . in order to optimize @xmath114 ,",
    "we utilize its first derivate with respect to @xmath118 given by @xmath119 where the stationary condition @xmath120 implied by eq .",
    "( [ kseq ] ) is used .",
    "thus we see that the derivative @xmath121 vanishes automatically when eq .",
    "( [ cons ] ) is satisfied .",
    "we now outline the implementation of this formalism for the simulation of electron transfer processes within siesta . in a typical electron transfer problem",
    "one has to partition the system into a donor region ( d ) and an acceptor region ( a ) . within siesta ,",
    "this is done by specifying a certain group of atoms as belonging to d and a second group of atoms as belonging to a. the constrained calculation then involves the transfer of a specified amount of charge from d to a. in order to partition the continuous electron density in real space between the a and d regions , we choose an appropriate population analysis scheme , which in turn determines the form of the weight function  @xmath122 in eq .",
    "( [ cons ] ) .",
    "the localized numerical orbital basis set within siesta is particularly suitable for atomic orbital based population analysis schemes such as the ones due to lowdin @xcite and mulliken @xcite .",
    "we have implemented weight functions corresponding to both the lowdin and mulliken schemes within siesta . for lwdin populations , the number of electrons on a group of atoms _ c",
    "_ is given by @xmath123 where @xmath124 and @xmath125 are the density and overlap matrices respectively and @xmath126 defines the lwdin weight matrix .",
    "similarly , with a mulliken population analysis , the number of electrons on a group of atoms _ c _ is @xmath127 with the corresponding weight matrix given by + @xmath128 for charge transfer problems , wu _ et al . _",
    "recommend a partitioning of the charge density based on the lwdin scheme .",
    "the self consistent field ( scf ) procedure for obtaining the constrained dft ground - state within the current implementation consists of an inner and outer loop .",
    "the outer loop is similar to a conventional scf cycle wherein the orbitals obtained by solving the ks equations and the associated self - consistent density are updated .",
    "the inner loop consists of optimizing the @xmath108 multipliers to ensure that the constraint condition given in eq .",
    "( [ cons ] ) is satisfied at each step of the outer loop . by eq .",
    "( [ grad ] ) , this is equivalent to find the extremes of @xmath114 .",
    "since the derivative of @xmath114 with respect to the @xmath108 is readily available from eq .",
    "( [ grad ] ) , we employ a conjugate gradients ( cg ) optimization procedure to ensure that eq .",
    "( [ cons ] ) is satisfied .",
    "subsequently , the ks equations are solved and the resulting orbitals are used to update the ks density and hamiltonian in the outer loop .",
    "we note that wu  _ et al . _",
    "also calculate the second derivative ( hessian matrix ) of @xmath114 with respect to the @xmath108 parameters and employ the newton s method to optimize @xmath118 .",
    "however , the expression for the second derivatives @xmath129 depends explicitly on the ks orbitals , whereas the first derivative [ eq .  ( [ grad ] ) ] involves only the density @xcite .",
    "we therefore prefer to work with the gradient alone and employ a cg optimization scheme for the @xmath118 .",
    "thus the overall scf procedure consists of the following sequence of steps : ( i ) construct the standard ks hamiltonian @xmath130 for the current guess density .",
    "( ii ) obtain the constrained ks hamiltonian @xmath131 by adding the constraint potential @xmath117 from the previous iteration .",
    "( iii ) using the pulay scheme , mix @xmath132 with hamiltonians from previous iterations to obtain @xmath133 .",
    "( iv ) by keeping @xmath133 fixed , optimize @xmath118 so that the constraints in eq .",
    "( [ cons ] ) are satisfied .",
    "( v ) solve the ks equations for the hamiltonian combining @xmath133 and the optimized @xmath118 .",
    "the new density matrix @xmath124 thus obtained and the optimized @xmath118 are used in the next iteration .",
    "( vi ) repeat steps ( i ) through ( v ) until self - consistency is achieved ."
  ],
  "abstract_text": [
    "<S> we present a computational scheme for extracting the energy level alignment of a metal / molecule interface , based on constrained density functional theory and local exchange and correlation functionals . </S>",
    "<S> the method , applied here to benzene on li(100 ) , allows us to evaluate charge transfer energies , as well as the spatial distribution of the image charge induced on the metal surface . </S>",
    "<S> we systematically study the energies for charge transfer from the molecule to the substrate as function of the molecule - substrate distance , and investigate the effects arising from image charge confinement and local charge neutrality violation . for benzene on li(100 ) we find that the image charge plane is located at about 1.8    above the li surface , and that our calculated charge transfer energies compare perfectly with those obtained with a classical electrostatic model having the image plane located at the same position . </S>",
    "<S> the methodology outlined here can be applied to study any metal / organic interface in the weak coupling limit at the computational cost of a total energy calculation . </S>",
    "<S> most importantly , as the scheme is based on total energies and not on correcting the kohn - sham quasi - particle spectrum , accurate results can be obtained with local / semi - local exchange and correlation functionals . </S>",
    "<S> this enables a systematic approach to convergence . </S>"
  ]
}