{
  "article_text": [
    "cluster or domain size distributions are commonly used in statistical mechanics to unveil geometric properties and characterize both the equilibrium  @xcite critical behavior and the out of equilibrium dynamics  @xcite of several models .",
    "if the system is finite , not all possible domain sizes are present on a single configuration .",
    "these sample - to - sample fluctuations disappear and the distributions become dense in the infinite size limit or after ensemble averages are taken . in order to characterize these fluctuations ,",
    "a quantity associated with how heterogeneously sized the equilibrium domains are , @xmath0 , was recently proposed in the context of explosive percolation  @xcite and then applied to ordinary percolation  @xcite and to the ising  @xcite and potts models  @xcite . differently from the cluster size distribution , the heterogeneity @xmath0 only takes into account whether a given size is present in each configuration and gives the number of such distinct sizes .",
    "although the number of equal - sized clusters and their actual size do not enter in the measure of @xmath0 , both entropic and thermal effects are relevant . at high temperatures , thermal noise breaks large clusters and the fragments",
    "are small , and so is the diversity and @xmath0 . on the other hand , for low temperature , the presence of a very large , perhaps percolating",
    ", cluster leaves small room to the other clusters , also decreasing the diversity .",
    "we here revisit the original formulation for the equilibrium scaling behavior of @xmath0 for the ising model and present new results for both geometric and physical clusters  @xcite .",
    "while the former considers all nearest neighbor parallel spins belonging to the same domain , the latter only takes the fraction of spins effectively correlated . this difference , although important for systems of interacting spins under thermal noise , obviously does not exist for percolation models . for random percolation  @xcite",
    ", @xmath0 has a clear peak and an excellent data collapse is obtained . for the ising model ,",
    "no peak has been observed for the system sizes considered in ref .",
    "although in 2d both kinds of spin domains percolate at the same temperature , only the physical ones encode the critical properties ( exponents ) .",
    "it is thus interesting to see how their heterogeneity , @xmath2 , differs from @xmath3 measured with the geometric domains .",
    "as we show below , even for small sizes , @xmath2 presents a clear peak and an excellent collapse is obtained . for the geometric domains , on the other hand ,",
    "we observe two peaks for sufficiently large systems , none of which were observed in ref .",
    "@xcite , where only an abrupt change in the derivative was present at the critical temperature @xmath4 .",
    "the first peak is small , very close to @xmath4 , while the second one is large , broad and appears far above the critical temperature .",
    "although the very existence of such double peak is interesting enough , there are several questions that must be answered .",
    "what is the origin of such peaks ?",
    "do they merge , leaving a single peak , as the system size diverges ?",
    "do they share the same exponents or the percolation exponents play a role ?",
    "what happens in 3d where the critical temperature does not coincide with the percolation threshold of geometric domains ? in order to try to answer these questions , we studied the equilibrium ising model on square and cubic lattices with linear sizes up to 2560 and 250 , respectively",
    ". averages up to 200 samples were performed for the smaller systems while larger sizes required fewer samples .",
    "all measures were obtained after equilibrating the system through 500 swendsen - wang steps  @xcite .",
    "the paper is organized as follows .",
    "we start sec .",
    "[ section.h ] by reviewing the definition of @xmath0 and its scaling behavior in the context of a thermal system .",
    "then , in secs",
    ".  [ section.2d ] and [ section.3d ] we present the results of extensive simulations for the 2d and 3d ising model , in which we measure @xmath0 for both geometric and physical clusters .",
    "we finally discuss , in sec .",
    "[ section.conclusions ] , our results and conclude .",
    "differently from the susceptibility that corresponds , in percolation terms , to the mean cluster size  @xcite , and thus correlates with both the size and frequency of fluctuations , for the measure of @xmath0 it is only the presence of a given cluster size that is relevant .",
    "both at too low and too high temperatures , the distribution of cluster sizes is concentrated at small domains , the latter because the large noise dissolves the clusters and the former because a giant cluster dominates the system leaving almost no room for the others . in both cases",
    "the size distribution has a small tail , domains are rather homogeneous and @xmath0 is not large .",
    "we thus expect a maximum of @xmath0 between these two limits , close to the critical temperature because the fragmentation of the infinite cluster creates several small domains and the size distribution per site , @xmath5 , being broad ( power law ) , will increase the probability of these clusters having different sizes and thus contribute to @xmath0 . moreover , as the linear size @xmath6 increases , more and larger clusters are allowed when the average distribution is broad enough and @xmath0 must also increase with system size .",
    "notice , however , that having a broad distribution does not necessarily imply a large value of @xmath0 : it depends on how many of these different sizes are present on a given state or , equivalently , the amount of vacancies in the distribution for a particular configuration of a finite size system ( the average cluster size distribution , on the other hand , being an ensemble average , is dense ) .",
    "the precise dependence of @xmath0 on the linear size @xmath6 can be understood with a scaling argument  @xcite .",
    "let us start with the height of the peak close to the critical temperature .",
    "small clusters are present with a high probability in a finite size system and we define @xmath7 , which is a function of the temperature , as the ( average ) smallest size not present in a configuration .",
    "below @xmath7 the distribution is dense , that is , the expected number of clusters whose sizes are smaller than @xmath7 , @xmath8 , is larger than one .",
    "on the other hand , above @xmath7 there are some sizes without a realization , @xmath9 and vacancies appear in the distribution .",
    "thus , by definition , @xmath10 .",
    "as we will see , the contributions to @xmath0 from clusters in these two regions are of the same order  @xcite .",
    "close to the transition , we write  @xcite @xmath11 where @xmath12 and @xmath13 is the reduced temperature .",
    "two critical exponents are introduced .",
    "the first one , @xmath14 , is associated with the extension of the power - law tail as the criticality is approached while the fisher exponent @xmath15 is the exponent of such power - law . for the 2d cases considered here , we have @xmath16 for geometric domains  @xcite , @xmath17 for physical clusters and @xmath18 for random percolation . the scaling function @xmath19 approaches a constant for @xmath20 and has a fast decay for @xmath21 .",
    "close to the transition , @xmath22 , and thus @xmath7 scales as @xmath23  @xcite .",
    "the remaining contribution to @xmath0 comes from the clusters with @xmath24 .",
    "these clusters may be ranked by size , starting from the largest  @xcite . at the criticality ,",
    "the largest cluster size lies in the interval @xmath25 such that the expected number of clusters in this interval is unity .",
    "that is , the integral of @xmath5 from @xmath26 to @xmath27 , multiplied by the size of the system is 1 .",
    "analogously , the second largest cluster lies in the interval @xmath28 such that the integral of @xmath5 from @xmath29 to @xmath27 , multiplied by the size of the system , is now 2 . repeating the process , for the @xmath30-th cluster in the rank , at the critical temperature",
    ", we get @xmath31 in the appendix we present a more detailed discussion of the convergence of this integral .",
    "we get that @xmath32 and the fractal dimension of these large clusters is @xmath33  @xcite , larger than @xmath34 of @xmath7 . as @xmath30 increases , remembering that we are ranking the sizes in reverse order , @xmath35 . since @xmath23 , for very large @xmath36 one has @xmath37 ,",
    "hence @xmath38 . thus , the two contributions to @xmath0 , @xmath39 , scale in the same way and @xmath40  @xcite .",
    "since @xmath0 and @xmath7 share the same scaling behavior , measuring the first missing cluster size @xmath7 is enough to obtain the critical scaling behavior of @xmath0 .",
    "the point at which the distribution deviates from the power law grows as @xmath41 , what defines the exponent @xmath14 . as pointed out in ref .",
    "@xcite , the competing scales in this problem can be considered @xmath7 and @xmath42 instead of the usual @xmath6 and @xmath43 .",
    "when @xmath44 , the power law is well developed and the distribution for a single configuration has many holes ( in the opposite limit , @xmath45 , such distribution is dense and the system behaves as if its size was infinite ) . in this case ,",
    "away from the transition , @xmath42 decreases and the critical region extends up to the point in which @xmath47 .",
    "thus , @xmath48 and , using the above definition , the size of the critical region is @xmath49 , where @xmath50 or , equivalently , @xmath51 . consistently with this , lee _ et al _",
    "@xcite considered that the scaling behavior of @xmath0 was given by @xmath52 .",
    "while close to the transition the scaling function @xmath53 is a constant , away from @xmath4 the behavior is @xmath54 .",
    "[ [ section.2d ] ] 2d ~~    the definition of @xmath0 and its scaling were proposed and verified in ref .",
    "@xcite for explosive percolation and , later on , also in ordinary percolation  @xcite and some 2d spin models  @xcite for which there are several possible definitions of domains . for the ising model , on which we focus here , a ( geometric ) domain is defined as a connected group of nearest neighbors aligned spins ( we do not distinguish , as in ref .",
    "@xcite , between up and down spins clusters ) .",
    "we show , in fig .  [ fig.h.eq.ising ] ,",
    "the geometric domains heterogeneity @xmath3 as a function of the temperature for several system sizes near the 2d ising critical point . for the small sizes considered in ref .",
    "@xcite , only a change in the derivative of @xmath3 , very close to @xmath4 , was observed . by considering larger sizes , interestingly ,",
    "two well separated peaks develop . the first , small one ( fig .",
    "[ fig.h.eq.ising]a ) , is very close to @xmath4 and , as shown by the collapse in fig .",
    "[ fig.h.eq.ising]d , grows as @xmath55 .",
    "a good collapse was obtained with @xmath56 ( keeping @xmath57 ) and , accordingly , @xmath58 .",
    "these values are close to the exponents for the geometric domains in the ising model  @xcite , @xmath59 and @xmath60 . on a broader range of temperatures ( notice the logarithmic scale in fig .",
    "[ fig.h.eq.ising]b ) , there is a second peak that , together with the first one , was not previously reported . in the large temperature limit , @xmath61 and @xmath62",
    "can be independently measured on a random configuration with , on average , half of the spins up and the other half down .",
    "they are shown as horizontal lines whose height slowly increase with @xmath6 , @xmath63  @xcite , and are approached as @xmath64 .",
    "this excess heterogeneity at large temperatures for the geometric domains is due to the entropic contribution of uncorrelated spins . because of this size dependence , that persists even at very high temperatures where @xmath65 , the scaling of this second peak turns to be rather complicated",
    "indeed , it does not collapse well with exponents obtained for the first peak and , instead , a satisfactory collapse was obtained with @xmath66 and @xmath67 .",
    "these values are close to the random site percolation exponents , @xmath18 and @xmath68 ( thus , @xmath69 ) , but this may be just a crossover because of the large separation between the two peaks for finite systems ( see the 3d case below ) .",
    "it seems that even larger systems would be necessary to clarify the nature of the critical exponents in this problem . both peaks , besides increasing in height , move towards @xmath4 in the thermodynamic limit .",
    "indeed , both horizontal scalings in figs .  [ fig.h.eq.ising]d and [ fig.h.eq.ising]e considered the known value of @xmath4 in @xmath1 .",
    "this is a consequence of the fact that , in @xmath1 , the geometric clusters percolative and the thermal transitions occur at the same temperature .",
    "since @xmath0 obviously depends on the nature of the clusters , further insight is gained by comparing with the behavior of physical clusters .",
    "if we remove from the geometric clusters the fraction of spins that , albeit parallel , are not effectively correlated , we obtain the so - called coniglio - klein droplets  @xcite whose physical properties are also related with the random cluster model  @xcite .",
    "[ fig.h.eq.ising]c shows @xmath2 as a function of the temperature for several sizes and presents a clear peak close to the transition that gets larger as the size of the system increases .",
    "notice that the temperatures of all the three peaks discussed here are well separated for the system sizes considered . differently from @xmath70 , that is an increasing function of @xmath6 , @xmath71 when @xmath72 since all spins become uncorrelated and form clusters of unit size .",
    "the scaling proposed in ref .",
    "@xcite works very well also for @xmath2 , fig .",
    "[ fig.h.eq.ising]f , with the ising thermal exponents ( @xmath57 , @xmath17 and @xmath73 ) .",
    "there is , however , another possible point of view for the scaling in this problem .",
    "obviously , if @xmath74 is a scaling variable , so is @xmath75 . indeed , using @xmath76 , collapses equivalent to those in fig .",
    "[ fig.h.eq.ising ] are obtained ( an example is shown in fig .",
    "[ fig.h.eq.ising.col.pmco ] ) , with no need to resort to a new exponent @xmath77 . in order to collapse the data for @xmath0 , besides understanding how its peak scales with @xmath6 , one must also know how the width of the critical region depends on the system size .",
    "standard finite size scaling considers the region around @xmath4 in which the measured correlation length @xmath43 will differ from its infinite size limit behavior . in a finite system ,",
    "the divergence of @xmath43 as @xmath78 , @xmath79 , is constrained by the linear size @xmath6 , and the width of the critical region is thus @xmath80 .",
    "this interval is , in principle , different for other divergent quantities at @xmath4 .",
    "if we consider @xmath0 instead of @xmath43 , since @xmath81 , the divergence of @xmath0 , @xmath40 , is weaker and the critical region , wider . indeed , as discussed in section  [ section.h ] , @xmath82 .",
    "for @xmath1 , analogous to fig .",
    "[ fig.h.eq.ising]f , but using the alternative scaling with @xmath57.,width=302 ]    , as a function of temperature for @xmath83 .",
    "a cluster is considered percolating when it touches all sides of the square lattice . below @xmath4 ,",
    "indicated by a vertical dashed line , there is almost always a large , percolating cluster and the available space for the second largest cluster is small . for large temperatures , it is almost certain that there is no percolating cluster and both curves coincide .",
    "the insets show snapshots for @xmath84 with the largest non - percolating geometric cluster in gray at two different temperatures ( that roughly correspond to the local maxima of the bottom curve ) . at the critical temperature ,",
    "left snapshot , there is a percolating cluster ( not shown ) and the second largest is compact . in red",
    "we show , among the several physical subclusters in which it divides , the largest one .",
    "the right snapshot shows that , at higher temperature ( second maximum ) , although the largest non - percolating geometric cluster has almost the same average size as at @xmath4 , the physical subclusters are much smaller.,width=302 ]    fig .",
    "[ fig.largest ] shows the fraction of the whole system occupied by the largest cluster as a function of the temperature , distinguishing whether the largest cluster does or does not percolate . at very high temperatures",
    "both measures coincide since the noise is too high to allow a percolating cluster .",
    "as the temperature decreases , spins become more correlated , the clusters larger and these measures , still coinciding , steadily increase .",
    "they become different when some samples percolate at temperatures roughly below the second peak of @xmath3 .",
    "the average fraction size of the largest component ( top curve ) increases almost linearly from this point , as @xmath85 decreases , up to @xmath4 where there is an abrupt jump and it approaches unity below @xmath4 .",
    "it is , on the other hand , the other measure , the fraction of the largest non - percolating cluster that seems to encode the relevant information for @xmath0 and presents a similar double peak structure . when some samples start to percolate , the largest non - percolating cluster is actually the second largest in these samples .",
    "as a consequence , its measure starts decreasing , both measures diverge , leaving a peak close to the temperature of the second peak of @xmath0 .",
    "the insets of fig .",
    "[ fig.largest ] show , in light gray , one example of the largest non - percolating cluster at the temperatures indicated , one close to @xmath4 and the other at the point of separation of the two measures discussed above .",
    "these are geometric clusters formed by parallel spins .",
    "each one is a collection of physical clusters , the largest one is shown in red ( dark gray ) . obviously , as the temperature decreases and the spins are more correlated , these clusters increase .",
    "[ [ section.3d ] ] 3d ~~    the heterogeneities can also be measured in the 3d case , where the percolative transition of the geometric domains does not coincide with the thermal transition , @xmath86 . in 3d ,",
    "the random site percolation threshold for a cubic lattice is 0.312 .",
    "for all temperatures above @xmath4 ( even in the @xmath72 limit ) , the fraction of each spin is 0.5 , on average , and since both spins densities are above the threshold , both percolate . for temperatures below @xmath4 ,",
    "the system is magnetized and the majority spin obviously percolates .",
    "the percolation transition occurs when , coming from low temperature , the minority spin ( the one opposite to the system magnetization ) whose domains are small and isolate , first percolate .",
    "we obtain , from the best collapse of @xmath0 ( see below ) , @xmath87 , slightly larger than the estimate in ref .",
    "@xcite , @xmath88 .",
    "[ fig.h_3d ] ( left ) shows both @xmath3 and @xmath2 as a function of temperature .",
    "again , @xmath2 shows a single peak slightly above @xmath89 . on the other hand , as in the 2d case",
    ", @xmath3 is sensitive to both transitions . while there is a large peak very close to @xmath90 , at @xmath4",
    "there is a crossover to a different declivity , as shown in the inset of fig .",
    "[ fig.h_3d ] . while in the 2d case two peaks with the same infinite size limit were present , in 3d there is a single peak and a crossover , each one located in a different temperature for @xmath91 .",
    "the high temperature limit of @xmath3 seems to increase even slower than in the 2d case , and is barely visible in the figure .",
    "the data collapses in 3d are shown in fig .",
    "[ fig.h_3d ] ( right ) . in the bottom part ,",
    "the results for @xmath2 are very well collapsed , as in the 2d case , with the thermal exponents of the 3d ising model and @xmath89 : @xmath92 and @xmath93 . in the top figure , for @xmath3 ,",
    "the best collapse was obtained with @xmath87 , @xmath94 and @xmath95 .",
    "one would expect  @xcite , in this specific case , the exponents of the 3d random site percolation problem , @xmath96 and @xmath97 .",
    "the reason for this  @xcite is that @xmath90 being smaller than @xmath4 , the correlation length is finite at that temperature and clusters at distances larger than this length are uncorrelated .",
    "the small difference between this set of exponents and those that give the best collapse may be due to finite size effects  @xcite .",
    "the cluster size heterogeneity @xmath0 is the number of distinct cluster sizes in a given sample configuration  @xcite .",
    "we presented here extensive simulations for the ising model for both geometric ( @xmath3 ) and physical ( @xmath2 ) clusters in two and three dimensions . while for the latter",
    ", @xmath0 has a single peak that diverges at the critical temperature of the ising model , in the former case @xmath0 presents a signature for both the percolative and the thermal transition . indeed , finite 2d systems present two quite distinct peaks for @xmath3 when the size is sufficiently large , but they merge as @xmath91 .",
    "on the other hand , in 3d there is a peak at @xmath90 and a sudden change in the declivity at @xmath98 .",
    "moreover , since the peaks of @xmath3 and @xmath2 do not occur at the same temperature in 3d , in the region @xmath99 , while @xmath2 increases , @xmath3 decreases ( a similar effect occurs in 2d , but it disappears in the limit @xmath91 ) .",
    "we also discussed the scaling of @xmath0 and how its behavior correlates with the large clusters in the system .",
    "interestingly , although the physical clusters collapse is clearly related to the ising thermal exponents , the behavior of the largest peak of @xmath3 is more subtle . in both 2d and",
    "3d the best collapse was obtained with exponents that are close , albeit different , from those of the respective random site percolation .",
    "although in 3d this is expected ( since @xmath100 , the correlation length is finite and distant clusters become uncorrelated  @xcite ) , in 2d both transitions coincide and the reason for the similarity with the random site exponents is still an open question .",
    "we conjecture that it may be just a crossover : for large systems the two peaks get closer to each other and converge to @xmath4 , the correlation length diverges and even clusters far apart are correlated . in this way , the exponents should converge to those of the first peak .",
    "both in two and three dimensions the heterogeneity measured for geometric domains , @xmath3 , is very sensitive to the thermodynamical transition , even if the critical properties are actually encoded in the physical domains .",
    "the small peak and the declivity change present in 2d and 3d , respectively are very close to @xmath4 even for very modest sizes , and its location does not suffer from strong finite size effects . if proven general , @xmath3 may provide a quite precise method to obtain a preliminary estimate for the thermal transition .",
    "there are , nonetheless , several remaining questions .",
    "for example , how heterogeneous are the slices of a 3d system  @xcite ?",
    "differently from the whole volume behavior , the percolation threshold for the slice again coincides with @xmath4 .",
    "another question is whether the above behavior of @xmath3 occurs in other models as well .",
    "we are presently studying the potts model , both for continuous and discontinuous transitions , in order to better understand which are the conditions for having a double peak .",
    "finally , it is important to perform other geometric measures in order to better understand the underlying mechanism responsible for the behavior of @xmath0 .",
    "when listing the domain sizes present on a particular configuration , we notice that all sizes up to a specific size appear , while above it several holes are present . after averaging over several configurations ,",
    "we call this size @xmath7 .    the ranking @xmath36 of the cluster size @xmath7 is @xmath101 not necessarily at the critical point . near it and using the scaling relation @xmath102 where @xmath103 , one could try to transform this discrete sum into an integral @xmath104 . unfortunately , this integral does not converge inside the critical region @xmath105 .",
    "however , one can write the @xmath106-th derivative of the quoted sum @xmath107 now , inside the critical region the bottom limit @xmath108 vanishes , and the resulting integral converges to a finite ( not @xmath109-dependent ) constant for some high enough integer @xmath106 . therefore , besides additional non - singular terms ( proportional to @xmath110 , @xmath111 @xmath112 @xmath113 ) , the leading singular form for @xmath36 reads @xmath114 notice that the particular mathematical form of the scaling function @xmath19 does not enter in the argument .",
    "the above scaling relations are valid anyway , only the proportionality prefactors being dependent on @xmath19 . in ref .",
    "@xcite , the authors assume @xmath19 to be an exponential function and explicitly use this form to derive the above scaling relations .",
    "however , in 3 dimensions for instance , @xmath19 is very well fitted to a ( non centered ) gaussian function  @xcite . in short ,",
    "the nice and surprising theory introduced in ref .",
    "@xcite is correct , but the particular assumption adopted by the authors , in order to justify it , is unnecessary .",
    "jja deeply thanks antonio coniglio for very interesting discussions .",
    "jja and pmco are partially supported by the inct - sistemas complexos and the brazilian agencies cnpq and capes .",
    "jja has also partial support from fapergs ."
  ],
  "abstract_text": [
    "<S> a measure of cluster size heterogeneity ( @xmath0 ) , introduced by lee et al [ phys . </S>",
    "<S> rev . </S>",
    "<S> e * 84 * , 020101 ( 2011 ) ] in the context of explosive percolation , was recently applied to random percolation and to domains of parallel spins in the ising and potts models . </S>",
    "<S> it is defined as the average number of different domain sizes in a given configuration and a new exponent was introduced to explain its scaling with the size of the system . in thermal spin models , however , physical clusters take into account the temperature - dependent correlation between neighboring spins and encode the critical properties of the phase transition . </S>",
    "<S> we here extend the measure of @xmath0 to these clusters and , moreover , present new results for the geometric domains for both @xmath1 and 3 . </S>",
    "<S> we show that the heterogeneity associated with geometric domains has a previously unnoticed double peak , thus being able to detect both the thermal and percolative transition . </S>",
    "<S> an alternative interpretation for the scaling of @xmath0 that does not introduce a new exponent is also proposed . </S>"
  ]
}