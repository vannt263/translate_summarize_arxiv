{
  "article_text": [
    "since the first detection of cosmic microwave background ( cmb ) polarization ( dasi ; kovac et al .  2002 , leitch et al .  2002 ) and subsequent measurement of the temperature - gradient ( te ) cross - power spectrum by the wilkinson microwave anisotropy probe ( wmap ; kogut et al .",
    "2003 ) , emphasis has shifted to the measurement and analysis of the full polarization angular power spectra . many experiments @xcite have improved on those early findings , producing measurements with a considerable gain in raw sensitivity . however , an important concern with all such measurements is systematic errors , including not only instrumental effects , observing strategy effects , and astrophysical contaminants , but also statistical issues .",
    "it is essential to develop powerful and flexible data analysis tools to extract the desired information from the raw data reliably . in this paper",
    "we progress towards this goal by extending the previously introduced gibbs sampling framework @xcite to polarization .",
    "the scientific importance of cmb polarization power spectra is high .",
    "for example , our current understanding of the optical depth , amplitude , and scalar spectral index hinges on what we know about the magnitude of the the low-@xmath0 temperature and polarization spectra from the wmap 3-year data @xcite .",
    "also , a detection of large scale b  modes would give a very exciting insight into primordial gravitational waves .",
    "earlier gibbs analyses of unpolarized cmb data were described by @xcite .",
    "these efforts demonstrated that exact analyses are indeed feasible even for such large data sets as the wmap data , which comprise several million pixels .",
    "this is possible due to the very favorable scaling of the gibbs sampling algorithm . while brute - force likelihood evaluations scale as @xmath1 , @xmath2 being the number of pixels in the data set , the gibbs sampler scales identically to the map making operation .",
    "for the special case of uncorrelated noise and symmetric beams , this reduces further to @xmath3 .",
    "thus , even planck - sized data may be analyzed using these tools , as will be demonstrated in the present paper .",
    "gibbs sampling thus provides an efficient route to the exact posterior ( or likelihood ) .",
    "moreover , it does not rely on any ad - hoc approximations . even for the analysis of temperature data , this proved to be both an important and subtle issue @xcite . however , it is critical for polarization measurements , because well - known approximate methods such as the pseudo-@xmath4 methods ( e.g. , chon et al .",
    "2004 ) can lead to aliasing of e - mode power into the much smaller b - mode power spectrum .",
    "although it is possible to construct ways around this problem @xcite , exact methods such as full likelihood evaluations or gibbs sampling are clearly preferable solutions .",
    "we start by discussing the algorithms used for polarized gibbs sampling , extending the signal and power spectrum sampling steps from temperature to polarization .",
    "then we analyze simulated data to verify that the algorithm works and to determine the computational efficiency of the method .",
    "gibbs sampling in the polarization case is essentially the same as in the temperature case , with objects involved in the sampling re - defined to account for the additional information . for full details on the methodology of gibbs sampling as applied to cmb analysis , see @xcite ; @xcite ; and @xcite .",
    "specifically , the cmb signal is generalized to a vector of harmonics coefficients @xmath5 for each @xmath0 and @xmath6 , where the letters @xmath7 , @xmath8 , and @xmath9 stand for temperature , electric / gradient , and magnetic / curl respectively .",
    "the covariance matrix @xmath10 of the cmb signal then becomes block - diagonal , with an identical @xmath11 sub - matrix for each @xmath6 value at a given @xmath0 : @xmath12 the data are pixelized maps @xmath13 of the stoke s parameters @xmath14 of the form @xmath15 where @xmath16 is a linear operator that includes convolution with an instrument beam and the transformation of the @xmath17 components of the signal @xmath18 into the stokes parameters .",
    "note that for the rest of this paper , we will assume both the instrumental beam to be symmetric and the noise @xmath19 to be uncorrelated , having a diagonal covariance matrix @xmath20 .",
    "these are the reasons we can work with maps instead of time - ordered data . however , to simplify the notation we disregard in the following all issues concerning data format , beam convolutions , multi - frequency observations etc . , and model our data as a simple sum of a signal term and a noise term",
    ". for the full expressions , see appendix  [ app : signal_sampling ] .",
    "application of a galactic mask is implemented by increasing the noise variance to infinity for masked pixels , or rather , by setting the inverse noise covariance to zero . for full details",
    ", we refer the interested reader to @xcite .    as in the temperature - only case discussed in @xcite and @xcite",
    ", we wish to sample from the @xmath21 posterior .",
    "it is typically not easy to evaluate @xmath21 directly , because of a large and dense @xmath22 covariance matrix , nor is it easy to sample from it directly .",
    "this is precisely the motivation for gibbs sampling , which allows sampling from a joint density through the corresponding conditional densities . for the case of cmb power spectrum estimation",
    ", this is done by first sampling from @xmath23 using @xmath24 and @xmath25 , ( neither of which requires inversion of dense @xmath22 matrices ) , and then marginalizing over @xmath18 .",
    "using the fact that , given a full - sky signal map the conditional density for the signal matrix is independent of the data @xmath26 , the basic gibbs sampling scheme may be written in the following form , @xmath27 here the symbol @xmath28 indicates sampling from the distribution on the right hand side .",
    "the only remaining problem is to establish the correct sampling algorithms for each of the two conditional distributions for polarized data , and this is the topic of the following sections .",
    "note that if a continuous distribution for @xmath29 is desired , as opposed to a set of individual samples , one may take advantage of the known analytical form of the distribution @xmath30 by applying the blackwell - rao estimator .",
    "this procedure was discussed in detail by @xcite and @xcite for the temperature - only case , and the generalization to polarization is once again straightforward .",
    "the required modifications are written out in section  [ sec : blackwell_rao ] .",
    "the signal sampling equations for polarization are identical to those for temperature - only data , taking into account the generalizations mentioned above .",
    "specifically , the sky signal ( @xmath31 ) is sampled ( given the current covariance matrix @xmath10 ) by solving for the mean field , @xmath32 , and fluctuation , @xmath33 , maps @xmath34 { \\mathbf{s}}^{-1/2 } { \\mathbf{x } } &    = & s^{1/2}{\\mathbf{n}}^{-1}{\\mathbf{m } } ,      \\\\    \\label{samplefluctuation }    \\left[{\\mathbf{1}}+ { \\mathbf{s}}^{1/2}{\\mathbf{n}}^{-1}{\\mathbf{s}}^{1/2}\\right ] { \\mathbf{s}}^{-1/2 } { \\mathbf{y } } &     = & \\mathbf{\\xi } + { \\mathbf{s}}^{1/2 } { \\mathbf{n}}^{-1/2}\\mathbf{\\chi},\\end{aligned}\\ ] ] where @xmath35 and @xmath36 are random maps containing gaussian unit variates ( zero mean and unit variance ) in each pixel for each of the @xmath37 , @xmath38 , and @xmath39 components and @xmath40 must be symmetric for these equations to be valid . on the other hand",
    ", @xmath41 only has to satisfy @xmath42 , and may be chosen to be the cholesky decomposition . ] .",
    "note that the symbols in these equations may be interpreted either in terms of pixel space or spherical harmonic space objects . in practice , this is implemented in terms of conversions between pixel and harmonic space with standard spherical harmonics transforms .",
    "for example , the inverse noise covariance matrix is given by @xmath43 in pixel space and @xmath44 in harmonic space , where @xmath45 and @xmath46 are the inverse and standard spherical harmonics transforms , respectively .",
    "for explicit details on such computations , see @xcite .",
    "the signal sampling operation is by far the most demanding step of the gibbs sampler , because it requires the solution of a very large linear system . formally speaking",
    ", this corresponds to inverting a @xmath47 matrix , which clearly is not computationally feasible through brute - force methods .",
    "as described in detail by , e.g. , @xcite , the systems in equations [ samplemean ] and [ samplefluctuation ] may be solved by means of conjugate gradients ( cg ) .",
    "the computational scaling is thus reduced to the most expensive step for applying the operator on the left hand side of the equations , which for symmetric beams and uncorrelated noise is a standard spherical harmonic transform .",
    "the efficiency of the cg technique depends critically on the condition number of the matrix under consideration . for our case",
    ", this is simply the highest signal - to - noise ratio of any mode in the system . as an example , for a fixed pre - conditioner it takes about 60  iterations to solve for the first - year wmap data , about 120  iterations to solve for the three - year wmap data , and about 300  iterations to solve for the planck 100ghz data .",
    "this is a particularly serious issue for cmb polarization measurements .",
    "while these signatures by themselves have a very low signal - to - noise ratio , and therefore should be easy to determine on their own , the corresponding signal - to - noise ratio for temperature is tremendous .",
    "consequently , if a main goal is to estimate the te cross - spectrum , by far most of the cpu time is spent on temperature map convergence . on the other hand ,",
    "if all interest lies in e- and b - modes , the temperature data may be disregarded completely ( or alternatively conditioned on by sampling from @xmath48 ) , and convergence is then achieved rapidly even for cmbpol type missions .",
    "this will be explicitly demonstrated in section  [ sec : cmbpol ] .",
    "it is possible to reduce the computational expense of a cg search significantly by pre - conditioning .",
    "one approach that has proved successful so far is to pre - compute a subset of the coefficient matrix in equations [ samplemean ] and [ samplefluctuation ] , and multiply both sides of the equations by the inverted sub - matrix .",
    "thus , by inverting the most problematic parts of the matrix by hand , the effective condition number is greatly reduced , and significant speed - up may be achieved .",
    "currently , our pre - conditioner is constructed independently for the temperature and polarization states . for the polarization components ,",
    "it is a diagonal matrix in ee and bb independently , while for the tt correlations , it consists of a low-@xmath0 matrix that includes all coefficients up to some @xmath49 , and then the diagonal elements at higher @xmath0 s @xcite . for wmap - type applications",
    ", we typically used @xmath50 , which requires 52 mb of memory and about 1  minute of cpu time for inversion .",
    "for upcoming planck data , it will be desirable to use a significantly larger pre - conditioner , and more realistic numbers are @xmath51 or 200 .",
    "this will require extensive parallelization , and has not yet been implemented in our codes .",
    "we therefore still use a serial pre - conditioner up to @xmath52 in this paper , and pay the extra cost in cg iterations .      given the ( full sky ) signal polarization map sampled from @xmath53 as described above , we must sample the signal covariance matrix from @xmath54 , which is explicitly given by @xmath55 here we have assumed a prior of the form @xmath56 for a jeffreys prior ) , and we have defined @xmath57 each @xmath58 represents the signal in harmonic space , and is a three dimensional complex - valued column vector containing the coefficients for the t- , e- , and b - modes at that @xmath0 and @xmath6 .",
    "this distribution is known as the inverse wishart distribution @xcite .",
    "sampling from this conditional density can be done with a vector generalization of the sampling algorithm described in @xcite .",
    "if @xmath59 is the size of the matrix being sampled ( typically @xmath60 for polarization ) , then the required steps for sampling are : 1 ) sample @xmath61 vectors from a gaussian with covariance matrix @xmath62 ; 2 ) compute the sum of outer products of these independently sampled vectors ; and 3 ) invert this matrix . for full details on both the inverse wishart distribution and the sampling algorithm",
    ", we refer the interested reader to chapter 3 of @xcite .",
    "there is a caveat for @xmath63 .",
    "the wishart distribution , from which we derive our sampling algorithm , is defined only if @xmath64 ; if not , the sampled matrix is singular . this is a problem for @xmath63 and a flat prior , since we would only sample one vector to form a @xmath65 matrix .",
    "thus , the algorithm breaks down for this particular case .",
    "fortunately , this is not a major problem in practice .",
    "three straightforward solutions are : 1 ) sample the @xmath66 te block and the b block of the matrix separately , assuming no tb or eb correlations ; 2 ) use a jeffrey s prior ( @xmath67 ) ; or 3 ) bin the quadrupole and octopole together .",
    "note that all other multipoles may be sampled individually by the above algorithm without modifications .",
    "[ [ sec : binning ] ] binning + + + + + + +    as discussed by @xcite , it is highly desirable for the gibbs sampler to be able to bin several power spectrum multipoles together .",
    "the main advantage of this is improved sampling efficiency : as currently implemented , the step size taken between two consecutive gibbs samples is given by cosmic variance alone .",
    "the full posterior , however , is given by both cosmic variance and noise .",
    "therefore , in the low signal - to - noise regime , one must take a larger number of steps to obtain two independent samples .",
    "the easiest way of improving on this is simply to bin many multipoles together , and thereby increase the signal - to - noise ratio of the power spectrum coefficient .",
    "in practice , we choose bins such that the signal - to - noise ratio is always larger than some limit , say 3 .",
    "since the cmb power spectrum is roughly proportional to @xmath68 , it is convenient to define uniform bins in @xmath69 .",
    "we therefore redefine @xmath70 for bin @xmath71 $ ] as @xmath72    note that there are now @xmath73 independent spherical harmonic modes contributing to this power spectrum coefficient .",
    "thus , the inverse wishart distribution has @xmath74 degrees of freedom rather than @xmath61 . with this modification ,",
    "the basic sampling algorithm remains unchanged , but since we have sampled @xmath75 and not @xmath76 , the actual power spectrum coefficients are given by @xmath77 for each @xmath0 in bin @xmath78 .",
    "we now make a brief comment on the so - called e - b coupling problem that plagues most approximate methods , such as the pseudo-@xmath4 methods ( see , e.g. , smith 2005 ) .",
    "briefly put , the problem lies in the fact that the spherical harmonics are not orthogonal on a cut sky , and this may result in leakage from the ( much larger ) e - mode power into the b - mode power spectrum .",
    "exact methods such as exact likelihood analyses or gibbs sampling do not have this problem .",
    "this may be understood intuitively in terms of the signal sampling process illustrated in figures [ fig : maps ] and [ fig : alice ] . obtaining a complete sky sample for the gibbs sampler",
    "is a two step process .",
    "first , one filters out as much information as possible from the observed data using a wiener filter .",
    "second , one replaces the lost power due to noise and partial sky coverage by a random fluctuation term .",
    "the sum of the two is a _ full - sky _ , noiseless sample that is consistent with the data . because it is a full - sky sample , no e - b coupling arises .",
    "the gibbs sampler provides a set of samples of the signal covariance matrix @xmath10 . in practice ,",
    "it is often preferable to have a smooth description of the probability density of @xmath10 . in such cases",
    ", one can use the blackwell - rao estimator , which takes advantage of the known analytical form of the probability distribution @xmath30 and uses the set of signal samples @xmath79 to approximate @xmath29 .",
    "an intuitive understanding of the blackwell - rao estimator may be found in terms of the usual gibbs sampling algorithm . within the theory of gibbs sampling ( or more generally markov chain monte carlo ) , it is perfectly valid to sample one parameter more often than others , so long as the sampling scheme is independent of the current `` state '' of the markov chain .",
    "in particular , one may choose to sample @xmath10 one thousand times for each time one samples @xmath18 , and thereby obtain more power spectrum samples ( although not sky signal samples ) with negligible cost .",
    "the result is a smooth power spectrum histogram .",
    "the blackwell - rao estimator takes this idea to the extreme , and replaces the power spectrum sampling step by the corresponding analytical distribution .",
    "the result is a highly accurate and smooth description of @xmath29 that is very useful for , say , estimation of cosmological parameters @xcite .    for full details on this estimator for the temperature - only case",
    ", we refer the interested reader to @xcite . but",
    "again , the generalization to polarization is indeed straightforward , and the generalized estimator reads @xmath80 where @xmath81 is the @xmath65 sub - matrix of @xmath10 for a given @xmath0 , and @xmath82 is the index over gibbs samples .",
    "we now apply the methodology described in section  [ sec : algorithms ] to simulated data .",
    "two different cases are considered to highlight different features . in the first",
    ", we consider a low - resolution , high signal - to - noise ratio experiment aimed at detecting primordial b  modes .",
    "the main goal of this exercise is to demonstrate the fact that the so - called e / b coupling problem that plagues approximate methods is not an issue for exact methods .",
    "second , we consider a high - resolution simulation based on the planck 100ghz channel to demonstrate that gibbs sampling is feasible even for very large cmb data sets .",
    "our first case corresponds to a possible future mission targeting the primordial b - modes that arise during the inflationary period .",
    "such modes are expected to have a very low amplitude and to be limited to large angular scales .",
    "some case studies for a b - mode mission therefore emphasize extreme sensitivity over angular resolution , and we adopt similar characteristics for this exercise .    as discussed in section  [ sec : signal_sampling ] , the convergence ratio for the conjugate gradient search depends critically on the signal - to - noise ratio of the data . in order to achieve acceptable performance when analyzing temperature observations with the sensitivity required for detecting b - modes , a much better pre - conditioner than what we have currently implemented is required .",
    "we therefore only consider the e- and b - mode spectra here , and not the temperature spectrum .    the simulated data set consists of the sum of a cmb component and a white noise component . the cmb realization was drawn in harmonic space from a gaussian distribution with a @xmath83cdm spectrum ( downloaded from the wmap3 parameter table at lambda ) having a tensor contribution of @xmath84 .",
    "multipoles up to @xmath85 were included .",
    "this realization was then convolved with a @xmath86 fwhm gaussian beam and @xmath87 pixel window , and projected onto a healpix grid .",
    "next , uniform ( and uncorrelated between @xmath38 and @xmath39 ) noise of @xmath88 rms was added to each pixel .",
    "finally , the wmap3 polarization mask @xcite was applied , removing 26.5% of the sky from the analysis .",
    "we adopted a binning scheme logarithmic in @xmath0 , such that @xmath89 $ ] .",
    "note that this is not directly connected to the signal - to - noise ratio of the data themselves , and this will have consequences for the convergence properties of the high-@xmath0 b - mode bins .",
    "however , our main focus in this paper is the method itself , and this scheme is chosen to illustrate the effect of both high and low signal - to - noise binning , not to obtain an optimal power spectrum .",
    "the simulation was then analyzed with the gibbs sampler described earlier , producing 1000  sky samples in each of five independent markov chains .",
    "the cpu cost for producing one sample was 10  minutes , or a wall clock time of 2.5  minutes when parallelized over four processors .",
    "the total running time was thus 42  hours using 20  processors . for each sky sample ,",
    "20  independent power spectrum samples were drawn in order to obtain smoother @xmath4 confidence regions .",
    "( see the discussion of the blackwell - rao estimator in section  [ sec : blackwell_rao ] for more details . )",
    "we first consider the reconstructed auto - spectra , which are shown in the top panel of figure  [ fig : lowl_spectra ] .",
    "the input ( unbinned ) spectra are given by dashed and dotted lines for e- and b - modes , respectively , and the reconstructed ( binned ) posterior maximum spectra are shown by solid black lines .",
    "one and two sigma confidence regions are marked by gray regions . finally , the beam deconvolved noise spectrum is indicated by a thin dashed line .    in the bottom panel ,",
    "we show the gelman - rubin convergence statistic @xcite as computed from the @xmath62 sky signal power spectra for each @xmath0 .",
    "this is much more conservative than computing the same statistic from the @xmath4 samples , for two reasons .",
    "first , convergence in the binned power spectrum is achieved faster than convergence in each sky mode .",
    "second , cosmic variance only contributes to the power spectrum and not the signal on the sky .",
    "therefore , this may be accounted for either analytically through the blackwell - rao estimator or by re - sampling the @xmath4 spectra given the @xmath62 s .",
    "in other words , a small error in the sky signal variance does not affect the full posterior significantly if the desired distribution is anyway dominated by cosmic variance .",
    "a general recommendation is that the gelman - rubin statistic , @xmath90 , should be less than 1.1 or 1.2 to claim convergence , although the value depends on the particular application and initialization procedure , and should be compared against other methods such as jack - knife tests .",
    "however , for the particular case shown in figure  [ fig : lowl_spectra ] , it is clear that the e - mode spectrum has converged very well everywhere , while the b - mode spectrum only has converged up to @xmath91 .",
    "as discussed in section  [ sec : binning ] , this behavior can be understood intuitively in terms of signal - to - noise ratio . since the step size between two signal samples",
    "is given by cosmic variance alone , while the full posterior distribution is given by both cosmic variance and noise , it takes a large number of gibbs steps to diffuse efficiently in the very low signal - to - noise regime .",
    "further , the noise spectrum is about three orders of magnitude larger than the b - mode spectrum at @xmath92 , and the gibbs sampler is therefore unable to probe the full distribution with a reasonable number of samples .    to resolve this issue , we bin the power spectrum .",
    "however , the binning scheme was not tuned to obtain constant signal - to - noise in each bin , but was rather arbitrary .",
    "the result is clearly seen in the gelman - rubin statistic : for @xmath93 the signal - to - noise per bin is high , and convergence is excellent . at @xmath94 , it is low , and the convergence is very poor . the way to resolve this",
    "would have been to choose larger bins at higher @xmath0 s .    in figure",
    "[ fig : exb_spectrum ] , we show the e@xmath95b cross - spectrum .",
    "as expected , this is nicely centered on zero .",
    "we end this section by commenting on the applicability of this formalism to a possible future cmbpol type mission .",
    "as is well known , the main problems for such a mission will not be primarily statistical issues of the type discussed above , but rather systematics in various forms .",
    "two important examples are correlated noise and asymmetric beams . however , if it is possible to pre - compute the complete @xmath96 matrix for the data set under consideration , then these two important effects may be fully accounted for using the methods described here . and",
    "for a low - resolution cmbpol mission this may be possible .",
    "for an upper multipole limit of , say , @xmath97 there is a total of 2@xmath9590000 = 180000 polarized spherical modes to account for .",
    "in other words , one has to store and invert a @xmath98 matrix in order to analyze such an experiment exactly .",
    "although this is a considerable computational problem , it is quite tractable already with current computers .",
    "thus , if it is possible to compute this matrix in the first place for a given experiment , an exact and complete analysis is feasible using the methods described in this paper .      in order to demonstrate the feasibility of this method for analyzing even the largest planned data set , we now consider a simulation with properties similar to those of the planck 100ghz instrument .",
    "specifically , the grid resolution is chosen to be @xmath99 ( corresponding to a @xmath100 pixel size ) , the maximum multipole moment is @xmath101 , the beam size is @xmath102 , and the noise level is @xmath103 rms per pixel for temperature and @xmath104 per q / u pixel .",
    "these noise levels are a factor of two higher than the goal levels for the 100ghz channel , given in the planck bluebookwww.rssd.esa.int@xmath105sa@xmath105planck@xmath105docs@xmath105bluebook-esa-sci(2005)1@xmath106v2.pdf ] .",
    "no noise correlations between @xmath7 , @xmath38 and @xmath39 were included , the b - mode spectrum was set to zero , and the sky cut was chosen to be the wmap kp2 mask .",
    "such large data sets are certainly a challenge for the gibbs sampling algorithm , and the computational requirements are considerable .",
    "specifically , the cpu time for generating one sample ( requiring @xmath107300 cg iterations ) is about 16cpu hours when using the low-@xmath0 preconditioner described by @xcite up to @xmath108 .",
    "better preconditioners will of course reduce this cost significantly .",
    "however , it is important to note that even though this is an expensive operation , it is by no means prohibitive . to obtain a reasonably well converged posterior distribution ,",
    "one requires on the order of @xmath109 independent samples , and this would then require @xmath110 cpu hours .",
    "of course , this number must be multiplied with a significant factor for an actual production analysis ( e.g , number of frequency bands or data combinations ) , but considering the tremendous efforts spent on obtaining the planck data in the first place , this amount of cpu time is a most reasonable cost for analyzing them .    for the high - resolution analysis presented in this paper , we produced a total of 800  sky samples , divided over eight independent chains .",
    "again , 20  independent power spectrum samples were then drawn from each of these for visualization purposes .",
    "the results from these computations are summarized in figure  [ fig : highres_spectra ] , showing both the reconstructed power spectra and the corresponding convergence statistics .    with the chosen binning scheme and number of samples , we see that the tt spectrum has converged well everywhere , while the te spectrum has some small problems at the end of the second bin .",
    "the ee spectrum would clearly have benefited from more samples , and even more importantly , slightly larger bins ; increasing the bin size by , say , 20% would have resolved both the te and ee issues .",
    "however , as far as computational feasibility goes , the important part is the signal sampling step , and not binning or re - sampling issues ; these can always be adjusted given some crude knowledge of the data set under consideration .",
    "therefore , the fact that already this first implementation of the polarized gibbs sampler is able to produce hundreds of sky samples with only a few days on a standard computer cluster , is a direct demonstration of computational feasibility for even planck - sized data sets .",
    "this paper extends the gibbs sampling technique to polarized power spectrum estimation .",
    "we have detailed the necessary generalization steps relative to the original temperature - only descriptions given by @xcite , @xcite and @xcite , and have considered computational aspects of polarized analysis .",
    "the algorithm was demonstrated with two specific examples .",
    "first , considering a possible cmbpol type mission , we showed that the gibbs sampler cleanly separates e- and b - modes , and no special care is required .",
    "this is in sharp contrast to approximate methods such as so - called the pseudo-@xmath4 , for which great care must be taken in order for the larger e - modes not to compromise the minute b - modes .",
    "second , we analyzed a planck - sized data set , demonstrating that the algorithm is useful for analyzing the quantity of data which will come from near - future cmb experiments .",
    "the gibbs sampling results presented here use symmetric beams and noise which is uncorrelated between pixels . however , the gibbs sampling algorithm has potential to analyze considerably more complicated data sets than these . for planck ,",
    "the solution lies in exploiting the very regular scanning strategy , which reduces the computational burden of a time - ordered data analysis . for a future cmbpol mission ,",
    "the solution lies in the relatively large angular scales required .",
    "since it is possible to invert the noise covariance matrix for multipoles up to several hundreds , one may pre - compute the all - important @xmath111 matrix . after paying this high one - time cost",
    ", efficient and exact analysis is feasible using the methods described in this paper .",
    "finally , we re - emphasize that the gibbs sampler provides a direct route to the exact likelihood ( and to the bayesian posterior ) , and it is much more reliable than approximate methods .",
    "this issue has been demonstrated explicitly through the analysis of the three - year wmap data , where an approximate likelihood between @xmath112 and 30 caused a non - negligible bias in the spectral index @xmath113 @xcite .",
    "using gibbs sampling , such worries are greatly reduced .",
    "further , this paper demonstrates that the method is in fact capable of analyzing the amount of data that will come from the planck mission with reasonable computational resources .",
    "it therefore seems very likely that this method will play a significant role in the analysis of future planck data .",
    "we thank kendrick smith , graca rocha and charles lawrence for useful and interesting discussions .",
    "we acknowledge use of the healpix software @xcite and analysis package for deriving the results in this paper .",
    "we acknowledge use of the legacy archive for microwave background data analysis ( lambda ) .",
    "this work was partially performed at the jet propulsion laboratory , california institute of technology , under a contract with the national aeronautics and space administration .",
    "hke acknowledges financial support from the research council of norway .",
    "bdw and dll acknowledge support through nsf grant ast-0507676 and nasa jpl subcontract 1236748 .",
    "equations [ samplemean ] and [ samplefluctuation ] have been written as simply as possible , for clarity when describing the extension of our gibbs sampling algorithm to polarization .",
    "a more realistic treatment will involve multiple channels , symmetric beams , the pixel window function , and a cutoff at some value of @xmath0 . in this appendix",
    "we write out , for reference , the log likelihood for @xmath18 and the sampling equations that one derives from this .",
    "let the index @xmath114 run over channels .",
    "let @xmath115 be the beam smoothing function , and @xmath116 be the healpix pixel window smoothing function .",
    "if all channels are at the same resolution , then there is only one pixel window function ; otherwise @xmath116 will need an @xmath114 index as well .",
    "let @xmath117 be a projection operator that removes all modes with @xmath0 above some cutoff .",
    "note that @xmath117 , @xmath116 , and @xmath115 all commute , and @xmath117 commutes with @xmath10 .",
    "as before , @xmath118 are the maps and @xmath18 is the signal . for generality , we also include a foreground component @xmath119 , which is not otherwise discussed in this paper .",
    "@xmath120 from the above equation , it is clear that @xmath116 can be absorbed into @xmath115 , so we do this and drop @xmath116 from the equations .",
    "the equations for sampling @xmath121 become : @xmath122 { \\mathbf{s}}^{-1/2 } { \\mathbf{p}}{\\mathbf{x } } &    = & { \\mathbf{p}}{\\mathbf{s}}^{1/2}\\sum_i { \\mathbf{b}}_i { \\mathbf{p}}{\\mathbf{n}}_i^{-1}{\\mathbf{p}}({\\mathbf{m}}_i - { \\mathbf{b}}_i { \\mathbf{f}}_i)\\\\    \\left[{\\mathbf{p}}+{\\mathbf{p}}{\\mathbf{s}}^{1/2}\\sum_i({\\mathbf{b}}_i{\\mathbf{p}}{\\mathbf{n}}^{-1}{\\mathbf{p}}{\\mathbf{b}}_i){\\mathbf{s}}^{1/2}{\\mathbf{p}}\\right ] { \\mathbf{s}}^{-1/2 } { \\mathbf{p}}{\\mathbf{y } } &    = & { \\mathbf{p}}\\mathbf{\\xi } + { \\mathbf{p}}{\\mathbf{s}}^{1/2 } \\sum_i",
    "{ \\mathbf{b}}_i { \\mathbf{p}}{\\mathbf{n}}_i^{-1/2}\\mathbf{\\chi}_i,\\end{aligned}\\ ] ] where now we have several maps @xmath123 of gaussian unit variates . recall that these equations require the square root of @xmath10 to be symmetric ."
  ],
  "abstract_text": [
    "<S> earlier papers introduced a method of accurately estimating the angular cosmic microwave background ( cmb ) temperature power spectrum based on gibbs sampling . here </S>",
    "<S> we extend this framework to polarized data . </S>",
    "<S> all advantages of the gibbs sampler still apply , and exact analysis of mega - pixel polarized data sets is thus feasible . </S>",
    "<S> these advantages may be even more important for polarization measurements than for temperature measurements . </S>",
    "<S> while approximate methods can alias power from the larger e - mode spectrum into the weaker b - mode spectrum , the gibbs sampler ( or equivalently , exact likelihood evaluations ) allows for a statistically optimal separation of these modes in terms of power spectra . to demonstrate the method , we analyze two simulated data sets : 1 )  a hypothetical future cmbpol mission , with the focus on b - mode estimation ; and 2 )  a planck - like mission , to highlight the computational feasibility of the method </S>"
  ]
}