{
  "article_text": [
    "complex networks  @xcite have been conjectured to be embedded in hidden metric spaces , in which distances among nodes encode their similarity and , thus , their likelihood of being connected  @xcite .",
    "this hypothesis , combined with a suitable underlying space , has offered a geometric interpretation of the complex topologies observed in real networks , including scale - free degree distributions , the small - world effect , strong clustering as a reflection of the triangle inequality , and self - similarity .",
    "it has also explained their efficient inter - node communication without a knowledge of the complete structure  @xcite .",
    "moreover , it has been shown that for networks whose degree distribution is scale - free , the natural geometry of their underlying metric space is hyperbolic  @xcite .",
    "all these results have then been used to propose geometric models for real growing networks that reproduce their evolution and in which preferential attachment emerges from local optimization principles  @xcite . finally , mapping real complex networks into a hidden metric space has yielded a sustainable solution to the scaling limitations of the internet  @xcite , and has shed light on the hierarchical organization of biochemical pathways in cells @xcite .",
    "these achievements have been accomplished while considering a _ binary _ network representation in which links either exist or are absent",
    ". there exists , however , a class of complex networks for which the magnitude of the interactions between nodes ( i.e. , the weights ) plays a central role in their structural organization and dynamics  @xcite .",
    "for instance , the quantification of the rich - club effect in real weighted networks , in sharp contrast to results in unweighted representations , unveils the formation of alliances in multipolarized environments or the lack of cohesion even in the presence of rich - club ordering  @xcite .",
    "similarly , the propagation of emergent diseases in the international airports network is intimately linked to the number of passengers flying from one airport to the other  @xcite .",
    "a shift towards a paradigm of weighted networks is therefore in order to fully understand the interplay between their structural organization and their function .",
    "while several models have been proposed to address this matter @xcite , none of them , except to some extent the maximum - entropy class of models @xcite , is general enough to reproduce the topology and weighted structure of real weighted complex networks .    in this paper",
    ", we present a general and versatile class of weighted networks embedded in hidden metric spaces . built upon the so - called _ newtonian _ class of binary networks in hidden metric spaces @xcite , our framework preserves all the qualities of complex topologies embedded in underlying metric spaces and , in addition , it allows to enforce explicitly the strength ( sum of weights of a node ) distribution and the correlation between the strength and the degree of nodes .",
    "moreover , the level of coupling between the weights and the underlying metric space enables to control the local disparity of the weights associated to the nodes  @xcite as well as the shape of the weight distribution .",
    "our model lends itself to analytical treatment and includes an approach to estimate whether an underlying metric space is needed to explain the weighted features of real networks .",
    "one of the most remarkable aspects of the proposed class of models is the fact that the degree and strength distributions can be adjusted independently of the coupling with the underlying metric space .",
    "this critical property opens the path towards the uncovering of the natural geometry or real weighted complex networks . indeed , using our model",
    ", we find strong empirical evidence of metric properties in real networks , not only at the level of their topology but also in their weighted structure .",
    "our model is a nontrivial generalization to weighted networks of a class of random networks with hidden variables embedded in a metric space  @xcite . in this model , @xmath0 nodes",
    "are uniformly distributed with density @xmath1 in a @xmath2-dimensional homogeneous and isotropic metric space  -dimensional spheres of radius @xmath3 .",
    "however , the constraint of having constant density implies that the radius diverges in the thermodynamic limit and , thus , the metric space is equivalent to a @xmath2-dimensional euclidean space . ] , and are assigned a hidden variable @xmath4 according to the probability density function ( pdf ) @xmath5 .",
    "two nodes with hidden variables @xmath4 and @xmath6 separated by a metric distance @xmath7 are connected with a probability @xmath8 where @xmath9 is a free parameter and @xmath10 is an arbitrary positive function taking values within the interval @xmath11 .",
    "whenever the integral @xmath12 is bounded , the free parameter @xmath13 can be chosen such that @xmath14 .",
    "hence , @xmath4 corresponds to the expected degree of nodes , so the degree distribution can be specified through the pdf @xmath5 @xmath15 regardless of the specific form of @xmath10 ( see apps .",
    "[ sec : app_average_degree_of_nodes ] and [ sec : app_degree_distribution ] for details ) .",
    "the freedom in the choice of @xmath16 allows us to tune the level of coupling between the topology of the networks and the metric space , which in turn allows us to control many properties such as the clustering coefficient and the navigability @xcite .",
    "moreover , the form of the connection probability in eq .   implies that networks generated with this model are small worlds for any heterogeneous pdf @xmath5 since high degree nodes are then likely to be connected regardless of the metric distance between them @xcite .    to generalize this model to weighted networks",
    ", a second hidden variable @xmath17 is associated to each node .",
    "this new hidden variable can be correlated with @xmath4 so , hereafter , we assume that the pair of hidden variables @xmath18 associated with the same node are drawn from the joint pdf @xmath19 .",
    "the weight of an _ existing _ link between two nodes with hidden variables @xmath4 , @xmath17 , @xmath6 and @xmath20 , respectively , and at a metric distance @xmath7 is distributed according to the pdf @xmath21 where @xmath22 is any probability density function in the domain @xmath23 with @xmath24 , and where @xmath25 with @xmath26 and @xmath27 .",
    "the particular form of the distribution of weights eq .",
    "implies that the weight between nodes @xmath28 and @xmath29 can be written as @xmath30 where @xmath31 is a random variable drawn from the pdf function @xmath32 .",
    "equations   and constitute the keystone of our model . indeed , as shown in app .",
    "[ sec : app_average_strength_of_nodes ] , the form of eq .   is the only ensuring that @xmath33 , provided that the integral @xmath34 converges .",
    "the new hidden variable @xmath17 can therefore be interpreted as the expected strength of a node , and the joint pdf @xmath35 controls the correlation between degrees and strengths in the network . indeed , as shown in app .",
    "[ sec : app_average_strength_of_nodes_given_degree ] , the average strength of nodes with a given degree , @xmath36 , relates to the first moment of the conditional pdf @xmath37 , @xmath38 , through the relation @xmath39 therefore , when @xmath40 then @xmath41 .",
    "this limit stands as a good approximation for the behaviour of high degree nodes in real weighted networks .    remarkably , these relations hold independently of the specific form of the connection probability @xmath10 and of the distribution of weights @xmath22 , thus conferring great versatility to our model .",
    "even more remarkable , the shape of the connection probability @xmath10 and the value of the parameter @xmath42coupling topology and weights to the metric space  do not affect the relations @xmath43 and @xmath44 and , therefore , the join degree - strength distribution @xmath45 .",
    "this property conveys a degree of control over the weight distribution as well as over the disparity of nodes which is independent of the specification of degrees and strengths and , more importantly , opens the possibility to measure the metric properties of complex weighted networks .",
    "all results presented in the previous section hold in arbitrary dimension and for any form of the connection probability @xmath10 and weight probability density @xmath22 in eqs .   and  .",
    "to apply the formalism to real weighted networks , we particularize to the @xmath46 model as generator of the topology  @xcite . in that model",
    ", we choose the circle @xmath46 of radius @xmath48 to be the underlying geometry over which nodes are uniformly distributed with density @xmath49 .",
    "distances among nodes are measured in terms of arc lengths , that is , two nodes with angular positions @xmath50 and @xmath51 are therefore at a distance @xmath52 where @xmath53 .",
    "the connection probability is set to @xmath54 where @xmath55 is a free parameter that can be used to tune the clustering .",
    "equation   casts the ensemble of networks generated by the model into exponential random networks @xcite ,",
    "i.e. , networks that are maximally random given the constraints imposed by the free parameters ( that is , @xmath5 and @xmath56 ) . to obtain a scale - free degree distribution , hidden variables",
    "@xmath4 are distributed according to @xmath57 with @xmath58 and @xmath59 .",
    "notice that by keeping the explicit dependence in the upper cutoff it is possible to model networks with @xmath60 and a hard cutoff , as found for instance in airport networks  @xcite .",
    "moreover , since it is generally more convenient to fix the average degree @xmath61 explicitly , we choose @xmath62 such that @xmath63 and fix the remaining free parameters @xmath64 and @xmath65 externally . ,",
    "i.e. , the _ natural _ cut - off of a scale - free distribution @xcite .",
    "however , in general @xmath64 can take any value in response to particular mechanisms at play , like the limited capacity to handle more than a given number of connections in the airport network . ] from eq .",
    ", we expect @xmath66 where @xmath67 is the generalized incomplete gamma function .",
    "( the regular complete and incomplete gamma functions can be retrieved by setting the bounds @xmath68 and @xmath69 to the appropriate values ) . whenever @xmath70 , a condition holding for most realistic degree distributions , the double incomplete gamma function scales as @xmath71 with @xmath72 and @xmath73 @xcite . ]    to assign weights on top of the topology generated by the model , the noise distribution in eq .",
    "is chosen to be a gamma distribution of average @xmath24 , that is , @xmath74 this particular choice allows us to interpolate with a single parameter between a zero noise limit when @xmath75 , exponential noise when @xmath76 , and strongly heterogeneous noise when @xmath77 .",
    "finally , to control the correlation between strength and degree and , therefore , to tune the strength distribution , we assume a deterministic relation between hidden variables @xmath17 and @xmath4 of the form @xmath78 , as observed in real complex networks @xcite . from eq .",
    ", we thus expect @xmath79 notice that the relation between average strength and degree in the previous expression is totally independent of the underlying metric space .",
    "it implies that the strength distribution scales as @xmath80 for @xmath81 with @xmath82 .",
    "figure  [ fig : illustration ] shows the basic topological and weighted properties of a network generated using eqs .   and compares them to the theoretical predictions presented in this section .",
    "apart from some expected fluctuations due to finite size , the agreement between the two is excellent .",
    "geometry has a strong effect on the strength and weight distributions , which depend on the coupling parameter @xmath42 .",
    "in fact , as shown in appendix  [ sec : app_theoretical_calculations ] , the second moment of the strength distribution @xmath83 is proportional to the integral @xmath84 , which diverges whenever @xmath85 .",
    "the origin of these fluctuations is rooted in the strong constraints that geometry imposes on the weights of individual links . in the absence of coupling (",
    "i.e. , @xmath86 ) the metric distance between nodes does not influence the magnitudes of the weights .",
    "consequently , the distribution of weights generated by the model is the original pdf in eqs .   and   convoluted with the distribution of values of the ratio @xmath87 .",
    "conversely , in the case of strong coupling ( i.e. , @xmath88 ) , short range links are constrained to have larger weights whereas long range ones have small weights .",
    "this effect increases the heterogeneity in the weight distribution and causes the divergence of @xmath83 when @xmath85 .",
    "figure  [ fig : coupling]*a * shows this effect on synthetic networks generated with the model with identical parameters except for the value of @xmath42 .",
    "the same effect is visible in the local heterogeneity of the weights attached to a given node . to characterize such heterogeneity",
    ", we use the disparity measure defined as @xmath89 where @xmath90 is the weight of the link between nodes @xmath28 and @xmath29 ( @xmath91 if there is no link ) and @xmath92 @xcite . in fig .",
    "[ fig : coupling]*b * , we see that in the absence of coupling ( i.e. , @xmath86 ) the disparity scales as @xmath93 corresponding to the situation in which weights are roughly homogeneously distributed among the links  @xcite . on the other side of the spectrum , we see that under maximal coupling ( i.e. , @xmath88 ) , the disparity decreases slower than @xmath94 meaning that weights are heterogeneous and that the large strength of nodes is due to a handful of links with large weights .",
    "as already discussed , our class of models has the critical ability to fix the local properties of the network , namely the joint degree - strength distribution , while changing the level of coupling with the metric space , quantified by parameter @xmath42 .",
    "this allows us to discern whether a metric space is needed to explain the observed topological and weighted properties of real complex networks and to compare them with synthetic networks generated with the model .",
    "given a real weighted complex network , how can we determine whether its weighted organization is influenced by any means by the properties of an underlying metric space ?",
    "an answer to this question must necessarily go through a test of the triangle inequality .",
    "the triangle inequality is one of the fundamental properties of any metric space . in simple words ,",
    "it states that whenever point a is close to point b and point b is close to point c , then points a and c must also be close . in the case of networks embedded in metric spaces ,",
    "the triangle inequality induces the existence of a large number of triangles in the graph and so a high clustering coefficient that remains finite even for model networks in the thermodynamic limit . considering the topology of the network without an explicit embedding of the network ,",
    "a direct check of the triangle inequality is not possible as the binary structure of the graph does not contain information about distances between nodes . an indirect empirical evidence of the connection between complex networks and hidden metric spaces can nevertheless be found by analyzing the self - similarity properties of the degree - dependent clustering coefficient  @xcite .    in contrast , weights associated to connections among nodes in weighted networks do contain information about their distances in the metric space so that , in principle , a direct check of the triangle inequality should be possible . in order to ensure that the metric properties of triples in the graph are in correspondence to the metric properties of the corresponding triangles in the underlying space , only triples of nodes forming triangles in the graph",
    "are taken into account to evaluate the triangle inequality .",
    "there are however two main problems when one tries to apply this program .",
    "the first problem is related to the fact that connections in the @xmath47 model depend not only on angular distances but also on hidden degrees such that we need first a purely geometrical formulation of the weighted hidden metric space network model .",
    "the second issue is related to the intrinsic noise present in the system due to the stochastic nature of the processes conforming it .",
    "below , we propose a way to overcome these two limitations .",
    "notice that , as shown in  @xcite , the model described by eq .",
    "is equivalent , in the one dimensional case , to a purely geometric model where nodes are embedded within a disk of radius @xmath3 in the hyperbolic plane of constant curvature @xmath96 .",
    "indeed , by mapping the hidden variable @xmath4 to a radial coordinate @xmath97 as follows @xmath98 } \\ ; \\;\\mbox { with } \\ ; \\ ; r=2\\ln{\\left [ \\frac{n}{\\mu \\pi \\kappa_0 ^ 2}\\right]}\\ ] ] and keeping the same angular coordinates , the connection probability eq .   can be written as @xmath99 where @xmath100 is a very good approximation of the hyperbolic distance between two points at radial coordinates @xmath97 and @xmath101 and angular separation @xmath102 . under this framework ,",
    "graphs generated with our model are geometric random graphs in the hyperbolic plane and , consequently , the triangle inequality must hold in hyperbolic geometry . to check the triangle inequality , we can then select as triples of points the vertices of topological triangles in the graph , with the condition that distances between these nodes are the hyperbolic ones .    by using the mapping eq .  , the weight between nodes @xmath28 and @xmath29 in eq",
    ".   transforms into @xmath103 from where it is possible to get an estimate of the hyperbolic distance @xmath104 between the two nodes . by using this method , the triangle inequality @xmath105 becomes @xmath106}+\\ln{\\left[\\frac{\\mu^{\\alpha}}{\\nu } \\right]}-\\frac{1}{2}\\alpha r \\le \\ln{\\left [ \\frac{\\epsilon_{ij } \\epsilon_{jk}}{\\epsilon_{ik } } \\right]}.\\ ] ] the first term in the left hand side of this inequality is a function of the actual weights and network topology and , thus , can be empirically measured in any network .",
    "the next two terms on the left hand side have an explicit dependence on the parameter @xmath42   also depends on @xmath42 ] , which tunes the coupling between the intensity of weights and the underlying metric space .",
    "the term in the right hand side is a noise term whose mean value is close to zero .",
    "let us first assume that this noise term is zero .",
    "in this case , the inequality should hold approximately for any value of @xmath42 equal to or larger than the value of @xmath108 used to generate the graph .",
    "the inequality does not hold exactly because some of the triangles in the graph may have been generated by chance and , thus , they are unrelated to the metric distances among their vertices",
    ". we then propose to measure , for a fixed topology and different values of @xmath42 , the triangle inequality violation spectrum @xmath109 defined as the ratio between the number of times the triangle inequality is violated ( left hand side of eq .",
    "is positive ) and the number of triangles in the graph . in the absence of noise",
    ", @xmath109 should take a very small value when @xmath110 if the weighted structure of the network is congruent with the existence of an underlying metric space .",
    "in fig .  [",
    "fig : tiv]*a * , we show @xmath109 for synthetic networks generated with the model with different values of @xmath42 .",
    "as predicted , the curves fall rapidly precisely at the real values of @xmath42 , as indicated by the dashed vertical lines .    in real situations ,",
    "however , noise is typically present and has an impact on function @xmath109 . indeed ,",
    "[ fig : tiv]*b * shows its behavior for a fixed value of @xmath42 and different values of the noise @xmath111 .",
    "this implies that , to obtain the value of @xmath108 from the spectrum @xmath109 , we need an independent measure of the noise . for this purpose",
    ", we use the square of the coefficient of variation of the strength evaluated in appendix  [ sec : app_theoretical_calculations ] , which reads @xmath112 the left hand side in this equation can be directly measured from the network .",
    "the right hand side depends linearly on the noise @xmath111 whereas its pre - factor depends both on the topology and on @xmath108 through the integrals @xmath113 and @xmath114 ( see appendix  [ sec : app_theoretical_calculations ] for technical details ) . with all these results at hand",
    ", we can define a procedure to test the triangle inequality in any real complex network and , from it , to infer the value of @xmath108 that best matches the empirical observations .",
    "the test is fully described in appendix  [ appendix : tiv ] . very briefly",
    ", we estimate the values of parameter @xmath42 and @xmath111 which best reproduce simultaneously the coefficient of variation of the strength in eq .   and the spectrum @xmath109 of the real network . in fig .",
    "[ fig : alpharealvsinferred ] , we show the result of this program in the case of synthetic networks with different values of @xmath108 and of noise levels .",
    "as it can be seen , the inferred values of @xmath42 match the true values in most of the cases .",
    "our method also allows us to find lower bounds on the inferred values , as shown by the gray areas in fig .",
    "[ fig : alpharealvsinferred ] .",
    "the most remarkable aspect of the test is that it can be performed without any explicit embedding of the network and , thus , it can be readily applied to real networks for which an embedding is not available . in the next section ,",
    "we analyze three different real weighted complex networks and show that not only the topology can be nicely reproduced by our model but also that the architecture of weights can be fully explained by the existence of a metric space .      .model",
    "parameters used to reproduce real networks .",
    "note that the value of @xmath0 is not the measured value in the real network because the model generates nodes with zero degree .",
    "similarly , the value of @xmath61 is higher than the measured one to account for finite size effects . with these parameters ,",
    "generated synthetic networks end up having the same number of non - zero degree nodes and average degree .",
    "[ cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ table:1 ]    next , we study three real - world weighted complex networks from different domains : version ijo1366 of the metabolic network of the bacteria _ escherichia coli ( e. coli ) _",
    "k-12 mg1655  @xcite , the us airport network in 2013  , and the world trade web ( wtw )  @xcite .",
    "we reconstruct a metabolic network representation in which two metabolites are connected by a weighted link accounting for the number of different metabolic reactions in which both participate .",
    "in the us airport network , two airports are connected by a weighted link measuring the total number of passengers traveling between them during the year 2013 . finally , weights in the wtw measure the total trade between pairs of countries in the world during the year 2013 . due to their high average degree",
    ", the us airport network and the wtw are filtered by the disparity filter defined in  @xcite to preserve the most statistically significant interactions . in the us airport network ,",
    "the filtered network coincides with the network defined by regular commercial flights . in the wtw",
    ", the filter is able to recover the correlation between degrees of countries and economic indicators , in particular their gross domestic products  @xcite .",
    "we applied the method described in appendix  [ appendix : tiv ] to infer @xmath42 and @xmath111 for the three real networks finding strong evidence of metric properties , both at the topological and weighted levels . indeed , in fig .",
    "[ fig:5 ] , we show the triangle inequality violation curves for the three real networks studied and the same curves for synthetic networks generated by the model with values of the coupling parameter @xmath42 and noise level @xmath111 inferred by our method from the real data . in the three cases , the agreement is excellent , suggesting that the coupling with a metric space is a most plausible explanation of the observed weighted architecture . in table",
    "[ table:1 ] , we show the optimal parameters for the three networks . using these parameters , we generate synthetic networks and confront their topological and weighted properties against the _ e. coli _ metabolic network in fig .  [ fig:6 ] .",
    "the agreement between the model and the real network is excellent in all measured properties .",
    "the analyses of the us airport network and the wtw is shown in fig .",
    "[ fig:7 ] and fig .",
    "[ fig:8 ] , respectively .",
    "in this work , we have presented a new class of weighted networks embedded in ( hidden ) metric spaces .",
    "this versatile class of networks explicitly prescribes the degree and strength distributions , as well as the correlation between them , independently of the coupling with the metric space .",
    "this allows us to reproduce the supra - linear relationship between strength and degree observed in real weighted complex networks and , at the same time , other relevant properties such as the weight distribution , disparity measure , and triangle inequality , which are strongly affected by the coupling with the metric space .",
    "the assessment of the triangle inequality allowed us to find strong empirical evidence of metric properties in the weighted architecture of three real complex networks from very different domains .",
    "two of them  the us airport network and wtw  are naturally embedded on the surface of the earth and , therefore , it would not be totally surprising to find a metric dependence at the weighted level .",
    "it is however important to notice that the distance in our model is not the geodesic distance on the earth but an effective ( hyperbolic ) distance encoding all the particularities of the system . in any case",
    ", the test of the triangle inequality that we have devised does not make use of any explicit embedding but only of the network topology and the corresponding weights and , consequently , can be applied to any weighted network . in particular , the ijo1366 metabolic network of the bacteria _",
    "e. coli _ is not embedded in any obvious metric space .",
    "the high value of @xmath42 inferred by our method for this network , together with the high levels of clustering and the quality of the previous embedding of its topology  @xcite , provides yet another empirical evidence towards the existence of hidden metric spaces shaping the architecture of this system and , more generally , of real complex networks  @xcite .",
    "the class of binary networks embedded in hidden metric spaces that our new model builds upon has a purely geometrical equivalent whose natural geometry is hyperbolic  @xcite . using this class of models , it has been possible to map real complex networks into the hyperbolic plane with an excellent congruency  @xcite . in the case of the internet , for instance , such mapping offers a sustainable and realistic solution to the scaling limitations of the internet routing architecture .",
    "similarly , the work presented in this paper paves the way towards the unveiling of the natural geometry of weighted complex networks .",
    "this will lead to a deeper understanding of their structural organization , which will in turn offer insights on their dynamics and on the impact they have on the dynamical processes they support .",
    "we acknowledge support from the james s. mcdonnell foundation scholar award in complex systems ; the fonds de recherche du qubec  nature et technologies ; the icrea academia prize , funded by the generalitat de catalunya ; the mineco project no.fis2013-47282-c2-1-p ; the generalitat de catalunya grant no.2014sgr608 ; and apvv ( project apvv-0760 - 11 ) .",
    "most of the theoretical calculations for the model presented in sec .",
    "[ sec : the_model ] are carried out using the probability density function ( pdf ) @xmath115 corresponding to the probability that a node with hidden variables @xmath4 and @xmath17 has a degree equal to @xmath116 and a strength in the interval @xmath117 . to compute this pdf ,",
    "we first consider a pair of nodes whose positions in space are @xmath118 and @xmath119 and whose hidden variables are @xmath120 , @xmath121 and @xmath122 , @xmath123 , respectively .",
    "the pdf for the weight @xmath90 between these two nodes ( @xmath91 means that there is no link ) is    @xmath124 \\delta(w_{ij } )                                                         + p(\\kappa_i,\\kappa_j , d_{ij } ) \\phi(w_{ij}|\\kappa_i,\\sigma_i,\\kappa_j,\\sigma_j , d_{ij } ) \\theta(w_{ij } ) \\ , \\end{aligned}\\ ] ]    where @xmath125 is the dirac delta function and @xmath126 is the left - continuous heaviside step function ( i.e. , @xmath127 ) . without loss of generality",
    ", we take the perspective of node @xmath28 , place it at the origin of the coordinate system , and integrate over the possible values of the hidden variables of node @xmath29 @xmath128 in this last equation , @xmath129 is the ( uniform ) pdf for the position of nodes in the metric space .",
    "this last expression does not depend on the position of node @xmath28 due to the isotropy , homogeneity and large size ( @xmath130 ) of the metric space . because the weights @xmath131 are assigned independently in the model , the probability that a node has a degree @xmath132 and a strength @xmath133 is equal to the product of the contribution of each potential @xmath134 links , given that the number of existing links is equal to @xmath132 and that their weights sum up to @xmath133 @xmath135                              \\delta\\bigg(k_i - \\sum_{l } \\theta(w_{il } ) \\bigg ) \\delta\\bigg(s_i - \\sum_{l } w_{il }",
    "\\bigg )   \\ .\\end{aligned}\\ ] ] although it is not possible to further the calculation and obtain a closed form the the pdf @xmath115 , many useful results can be obtained using its generating function defined as @xmath136 which , dropping the subscripts @xmath28 and @xmath29 , can be written as @xmath137 + p(\\kappa,\\kappa^\\prime , d ) x \\int \\phi(w|\\kappa,\\sigma,\\kappa^\\prime,\\sigma^\\prime , d ) \\mathrm{e}^{-wy } dw \\bigg\\ } d\\bm{x^\\prime } d\\sigma^\\prime d\\kappa^\\prime \\bigg]^{n-1 } \\ .\\end{aligned}\\ ] ]      from eq .",
    ", we can readily see that the average degree of nodes with hidden variables @xmath4 and @xmath17 only depends on @xmath4 @xcite @xmath138 where @xmath5 is the marginal pdf of @xmath19 , and where @xmath139 is the density of nodes in the metric space ( we consider here that @xmath130 )",
    ". using the definition of @xmath16 given in sec .",
    "[ sec : the_model ] and switching to @xmath2-dimensional spherical coordinates ( @xmath140 is the solid angle subtended by a @xmath2-dimensional object ) , this last equation becomes @xmath141 where we have noted @xmath142 and @xmath143 .",
    "the average degree for the whole network is @xmath144 consequently , we see that the free parameter @xmath13 can be chosen such that @xmath14 and @xmath145 .",
    "the degree distribution of the networks generated by the model can therefore be controlled through the pdf @xmath5 .",
    "following similar steps , we also find that @xmath146 = \\bar{k}(\\kappa ) \\ ,    \\end{aligned}\\ ] ] which implies that @xmath147}}{\\bar{k}(\\kappa ) } = \\frac{1}{\\sqrt{\\kappa } } \\ .\\end{aligned}\\ ] ] in other words , nodes with a same high value of their hidden variable @xmath4 tend to all have a degree close to the expected value @xmath14 .      by definition ,",
    "evaluating eq .   at @xmath148",
    "yields the generating function for the degree distribution of nodes with hidden variable @xmath4 @xmath149 assuming @xmath150 and using eq .",
    ", we obtain @xmath151^{n-1 }                                 = \\mathrm{exp}\\left\\ { ( x-1 ) \\bar{k}(\\kappa ) \\right\\ }                                 = \\sum_{k } \\frac{\\mathrm{e}^{-\\bar{k}(\\kappa ) } \\bar{k}(\\kappa)^k}{k ! } x^k \\ .\\end{aligned}\\ ] ] in other words , the degrees of nodes with hidden variable @xmath4 follow a poisson distribution with mean @xmath152 @xcite . using @xmath14 ,",
    "the degree distribution of the whole network is therefore @xmath153 thus unveiling the precise link between @xmath5 and @xmath154 .",
    "following similar steps as in sec .",
    "[ sec : app_average_degree_of_nodes ] , we can compute the average strength of nodes with hidden variables @xmath4 and @xmath17 @xmath155                          & = \\frac{2\\pi^{d/2}\\delta \\mu^{1-\\alpha / d } \\nu i_2}{\\gamma(d/2 ) } \\sigma \\int \\sigma^\\prime \\rho(\\sigma^\\prime ) d\\sigma^\\prime \\int \\chi^{d-\\alpha-1 } p(\\chi ) d\\chi                           \\frac{2\\pi^{d/2}\\delta \\mu^{1-\\alpha / d } \\nu i_2 \\langle \\sigma \\rangle i_3}{\\gamma(d/2 ) } \\sigma \\ , \\end{aligned}\\ ] ] where @xmath156 is the other marginal pdf of @xmath19 , and where we have noted @xmath157 , @xmath158 , and @xmath159 .",
    "we therefore conclude that the strength of nodes only depends on @xmath17 , hence @xmath160 .",
    "the average strength for the whole network is @xmath161 as for the average degree , we see that we can set the free parameter @xmath162 such that @xmath33 and @xmath163 .",
    "the strength distribution of the networks generated by the model can therefore be controlled through the pdf @xmath156 .",
    "following similar steps , we find that @xmath164   = \\delta \\iiint \\rho(\\kappa^\\prime,\\sigma^\\prime ) p(\\kappa,\\kappa^\\prime , d )                                      \\int w^2 \\phi(w|\\sigma,\\sigma^\\prime , d ) dw d\\bm{x^\\prime } d\\sigma^\\prime d\\kappa^\\prime                                     = \\frac{2\\pi^{d/2}\\delta \\mu^{1 - 2\\alpha / d } \\nu^2 i_4 \\langle",
    "\\sigma^2/\\kappa \\rangle i_5 } { \\gamma(d/2 ) } \\frac{\\sigma^2}{\\kappa } \\ , % \\iint \\kappa^\\prime { \\sigma^\\prime}^2 \\rho(\\kappa^\\prime,\\sigma^\\prime ) d\\sigma^\\prime d\\kappa^\\prime \\int \\chi^{d-2\\alpha-1 } p(\\chi ) d\\chi \\nonumber \\\\\\end{aligned}\\ ] ] where we have noted @xmath165 , @xmath166 and @xmath167 . setting @xmath13 such that @xmath168 [ see eq .  ] , we find that @xmath169}}{\\bar{s}(\\sigma ) } = \\frac{\\sqrt{\\bar{\\kappa}\\langle \\sigma^2/\\kappa \\rangle i_1 i_4 i_5}}{\\langle \\sigma \\rangle i_2 i_3 } \\frac{1}{\\sqrt{\\kappa } } \\ , \\end{aligned}\\ ] ] i.e. , the strength of high - degree nodes is close to its expected value given by eq .  .",
    "unfortunately , it is not possible to obtain a general closed form of the pdf @xmath170 , similar to eq .  , from eq .",
    "we can however characterize the strengths of nodes through the average strength of nodes with a given degree , @xmath36 .",
    "let us first explicit its calculation @xmath171 \\rho(\\kappa,\\sigma ) d\\sigma d\\kappa \\ .\\end{aligned}\\ ] ] from eq .",
    ", we see that the integral in brackets can be obtained from eq .",
    "@xmath172 x^k \\ .\\end{aligned}\\ ] ] assuming @xmath130 and using eqs .   and",
    ", we find @xmath173^{n-2 }                                                                         = x \\bar{s}(\\sigma ) \\mathrm{exp}\\left\\ { ( x-1 )",
    "\\bar{k}(\\kappa ) \\right\\ }                                                                         = \\sum_{k>0 } \\left [ \\frac{\\bar{s}(\\sigma ) \\mathrm{e}^{-\\bar{k}(\\kappa ) } \\bar{k}(\\kappa)^{k-1}}{(k-1 ) ! } \\right ] x^{k } \\ .\\end{aligned}\\ ] ] excluding the case @xmath174 in this last expression is not problematic since @xmath175 , by definition , and therefore the coefficient in front of @xmath176 must be zero [ see eq .  ] .",
    "combining eqs .   , @xmath14 and @xmath33",
    ", we obtain @xmath177 thus further clarifying how the joint pdf @xmath19 controls the correlation between the degree and the strength of nodes .",
    "in fact , assuming no correlation , i.e. , @xmath178 , yields @xmath179 , which is independent of the degree , as expected .",
    "to test the triangle inequality in a given weighted complex network , we first find the parameters @xmath180 and @xmath65 that best match the empirical topology . to achieve the optimal matching , we first use the empiric sequence of degrees as input for the sequence of @xmath4 s so that the fluctuations in the tail of the degree distribution of the input network are preserved .",
    "subsequently , the sequence of @xmath4 s is slightly modified to maximize the similarity between the degree distribution and clustering coefficient of synthetic networks and the real one . after this process , the sequence of @xmath4 s is kept fixed during the rest of the process .    the sequence is then used to generate different weighted networks as follows . from the empiric relation strength - degree , we measure the exponent @xmath181 , as well as the first and second moments of the strength distribution @xmath83 and @xmath182 . for fixed values of @xmath42 and @xmath111",
    ", we generate a large number of synthetic weighted networks and measure the average value of @xmath183 and its ensemble fluctuations . in fig .",
    "[ fig : testtiv]*a * , we show @xmath183 as a function of @xmath111 and different values of @xmath42 for one of the synthetic networks used in fig .",
    "[ fig : alpharealvsinferred ] with @xmath184 and noise @xmath185 .",
    "the intersection of these curves with the empirical value of @xmath183 defines a collection of @xmath42 s as a function of the noise , @xmath186 , which become the potential candidates to be the estimate of @xmath108 , see fig .",
    "[ fig : testtiv]*b*. finally , for each pair @xmath187 in fig .",
    "[ fig : testtiv]*b * we measure the function @xmath109 and compare it with the same function measured in the input network , see fig .",
    "[ fig : testtiv]*c*. the comparison is performed by measuring the standard @xmath188 statistics .",
    "the inferred value of @xmath108 corresponds to the value of @xmath189 minimizing the value of @xmath188 , see fig .",
    "[ fig : testtiv]*d*. to find a lower bound of the inferred value of @xmath108 , we use the ensemble fluctuations of @xmath183 . for any fixed value of @xmath111 ,",
    "the lower bound of @xmath190 is the value of @xmath42 that is still able to reproduce the empirical value of @xmath183 ( see fig .",
    "[ fig : testtiv]*b * ) .",
    "the lower bound for the inferred value of @xmath108 is the lower bound of @xmath190 that corresponds to the optimal value of the noise @xmath111 in fig .",
    "[ fig : testtiv]*d*.    46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _ _  ( , ,  ) @noop _ _  ( ,  ) link:\\doibase 10.1103/physrevlett.100.078701 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.102.058701 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys1130 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.82.036106 [ * * ,   ( ) ] in  link:\\doibase    10.1007/978 - 3 - 642 - 31585 - 5_51 [ _ _ ] ,  , vol .  ,  ( ,  )  pp .   in  link:\\doibase    10.1007/978 - 88 - 7642 - 475 - 5_68 [ _ _ ] , , vol .  ,  ( ,  )  pp .",
    "in  link:\\doibase    10.1007/978 - 3 - 319 - 13123 - 8_1 [ _ _ ] ,  , vol .  ,",
    "( ,  ) pp .   in  link:\\doibase    10.1007/978 - 3 - 662 - 47666 - 6_49 [ _ _ ] ,  , vol .  ,",
    "( ,  )  pp .",
    "link:\\doibase    10.1038/nature11459 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms8651 [ * * ,   ( ) ] link:\\doibase    10.1038/ncomms1063 [ * * ,   ( ) ] link:\\doibase    10.1039/c2mb05306c [ * * ,   ( ) ] link:\\doibase    10.1073/pnas.0400087101 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1126/science.1245200 [ * * ,   ( ) ] link:\\doibase 10.1209/epl / i2005 - 10167 - 2 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.92.228701 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.86.5835 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.99.228701 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.71.026103 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.67.040102 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.72.046140 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/8/5/072 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/16/4/043022 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/11/7/073005 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.102.038701 [ * * , ( ) ] link:\\doibase    10.1103/physreve.88.062806 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.92.052816 [ * * ,   ( ) ] link:\\doibase    10.1016/j.physa.2004.08.047 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.74.055101 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1073/pnas.0808904106 [ * * ,   ( ) ] @noop ( ) link:\\doibase    10.1103/physreve.80.035101 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.68.036112 [ * * ,   ( ) ] link:\\doibase 10.1080/00018730110112519 [ * * ,   ( ) ] link:\\doibase    10.1140/epjb / e2004 - 00038 - 8 [ * * ,   ( ) ] @noop _ _  ( ,  ,  )"
  ],
  "abstract_text": [
    "<S> we present a general and powerful , yet simple , class of weighted networks embedded in hidden metric spaces . </S>",
    "<S> this class of weighted networks allows an explicit prescription of the joint degree and strength distributions , and the control of the weight distribution and the local disparity of weights by tuning their coupling with the underlying metric space . </S>",
    "<S> we present an approach to estimate whether an underlying metric space is needed to explain the weighted features of real networks and show that the model generates networks that reproduce these properties advantageously . </S>",
    "<S> the results suggest that the nontrivial weighted structure of real networks could be explained by the coupling between the weights and an underlying metric space , and open the way to the embedding of real weighted networks and to unveiling their natural hidden geometry . </S>"
  ]
}