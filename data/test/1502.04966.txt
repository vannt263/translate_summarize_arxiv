{
  "article_text": [
    "the development of multi - functional codes capable of predicting quantum transport properties of complex systems is an increasingly active field of research@xcite .",
    "this is driven in part by the top - down scaling of the active elements within cmos devices , for which quantum effects are becoming important .",
    "it is also driven by the bottom - up demands of communities working on single - molecule electronics and low - dimensional systems , where structures and molecules of increasing size and complexity are of interest .",
    "in particular , multi - functional codes are needed to describe the fundamental properties of quasi - two - dimensional materials such as graphene , silicene , germanene and their integration into workable devices . the need to understand the interplay between all of the above structures and their surrounding environments creates further demands for such codes . at a more fundamental level , over the past forty years",
    ", a standard model of electron transport has been developed , based on computing the scattering matrix of quantum systems connected to external sources and there is a need for a universal code which describes the many realizations of such systems under a common umbrella .",
    "a key task of any quantum transport code is to start from the hamiltonian describing a system and calculate the quantum - mechanical scattering matrix @xmath0 , from which a wide range of measurable quantities can be predicted .",
    "unfortunately for most nanoscale systems of interest , the full many - body atomistic hamiltonian is too complex to allow this task to be completed and therefore one usually resorts to a description based on a mean - field hamiltonian . the system of interest is then composed of a scattering region , connected to external crystalline leads , which are in turn connected to external reservoirs .",
    "the problem of computing the scattering matrix for such a system described by an arbitrary mean - field hamiltonian is solved in reference @xcite .",
    "the main question therefore is how to obtain the correct mean - field hamiltonian .",
    "the simplest mean - field approach to describing quantum transport through nanostructures is to build a tight - binding hamiltonian , which reproduces key electronic properties near the fermi energy .",
    "this approach has been available for more than half a century and is still popular today when describing generic properties of materials such as graphene@xcite .",
    "tight binding parameters can be obtained by fitting to known band structures and then varied spatially to describe external fields and other perturbations .",
    "however such an approach does not easily capture the effects of interfaces between different materials or edge terminations of finite - size systems , whose properties are distinct from those of bulk materials . nor does it easily describe finite - voltage effects . to capture these additional features of inhomogeneous systems ,",
    "a more material - specific approach is needed .",
    "this problem was solved in part by the non - equilibrium green s function technique@xcite , that combines with density functional theory ( dft)@xcite to obtain the self - consistent mean - field hamiltonian of the system subject to a finite bias voltage and from it , the lesser green s functions providing the non - equilibrium electronic density and current .",
    "this approach is utilized within the smeagol code@xcite , which was the first to describe spin - dependent and finite - voltage transport properties of systems with inhomogeneous magnetic moments and in the presence of spin - orbit scattering .",
    "it is almost 10 years since the release of smeagol and during this period , we have developed a new code with increased speed , versatility and functionality , which is particularly suited to the modeling of larger - scale nanostructures , interacting with their environments .",
    "this new code is called gollum and will be freely available from _ http://www.physics.lancs.ac.uk/gollum _ within the coming weeks .",
    "our previous experience in the development of smeagol@xcite allowed us to understand that non - equilibrium transport codes are quite difficult to handle , in part because of their complex input data structures , which can create a steep learning curve , and also because they carry very heavy computational demands .",
    "as a consequence , we have devised the new code gollum to be more user friendly , with simple and easy to understand input and output structures , and having no accuracy parameters to tune .",
    "we present now a short summary of the features and functionalities of the two programs to better appreciate its differences .",
    "smeagol is a negf program that computes the charge and spin transport properties of two - terminal junctions subject to a finite voltage bias .",
    "smeagol can not read a user - defined tight - binding hamiltonian .",
    "instead , it reads the mean - field hamiltonian from the program siesta@xcite and is tightly bound to the old versions of it .",
    "smeagol can read from siesta hamiltonians carrying non - collinear spin arrangements as well as the spin - orbit interaction .",
    "siesta and smeagol have indeed been used successfully to simulate the magnetic anisotropies of atomic clusters@xcite and the spin transport functionalities of several atomic chains and molecular junctions subjected to strong spin - orbit interaction@xcite . however , smeagol does not profit from other recent density functionals .",
    "examples are the van der waals family of functionals or those based on the lda+u approach .",
    "gollum is a program that computes the charge and spin , and the electronic contribution to the thermal transport properties of multi - terminal junctions .",
    "in contrast to negf codes , gollum is based on equilibrium transport theory , which means that it has a simpler structure , it is faster and consumes less memory .",
    "the program has been designed for user - friendliness and takes a considerable leap towards the realization of ab initio multi - scale simulations of conventional and more sophisticated transport functionalities .",
    "the simpler interface of gollum allows it to read model tight - binding hamiltonians .",
    "furthermore , gollum has been designed to interface easily with any dft code that uses a localized basis set .",
    "it currently reads information from all the latest public flavors of the codes siesta@xcite and fireball@xcite .",
    "these include functionals that handle the spin - orbit or the van der waals interactions , or that include strong correlations in the spirit of the lda+u approach .",
    "plans to generate interfaces to other codes are underway .",
    "two- and three - dimensional topological materials display fascinating spin transport properties .",
    "gollum can simulate junctions made of these materials either using parametrized tight - binding hamiltonians@xcite , or dft@xcite .",
    "dft does not handle correctly strong electronic correlation effects , that are inherent many nano - scale electrical junctions .",
    "as a consequence , a number of negf programs like smeagol underestimate such effects .",
    "gollum includes several tools to handle strong correlations .",
    "these include the above - mentioned interface to the versions of siesta containing the lda+u functional .",
    "a second tool uses a phenomenological but effective approach called the scissors correction scheme .",
    "a third tool maps the dft hamiltonian into an anderson - like hamiltonian that is handled with an impurity solver in the spirit of dynamical mean field theory .",
    "the lighter computational demands required by gollum make it possible to construct conductance statistics relevant to break - junction and stm measurements of single - molecule conductances , therefore making closer contact with experiments .",
    "gollum also incorporates an interface with some classical molecular dynamics programs , which enables it to handle interactions with the environment .",
    "gollum makes use of the concept of _ virtual leads _ , that allows it to integrate easily a wide range of phenomena by the use of tight - binding hamiltonians .",
    "these include spintronics , superconductivity , kondo physics and topological phases .",
    "in contrast with smeagol , which only computes the magnitudes of transmission coefficients of two - terminal junctions , gollum has access to the full scattering matrix of a multi - terminal junction , enabling it to compute scattering amplitudes , phases and wigner delay times and thereby describe the properties of quantum pumps .",
    "even though gollum is based on equilibrium transport theory , our experience with the use of the negf code smeagol has enabled us to incorporate non - equilibrium physics into the mean - field hamiltonian .",
    "gollum has therefore the ability to compute non - equilibrium current - voltage curves .    in this article ,",
    "our aim is to describe the structure of the code and then present a set of demonstrator calculations .",
    "the latter will illustrate the additional functionality and versatility of gollum and at the same time constitute a set of new results for the transport properties of selected structures .",
    "all of the functionalities that will be discussed below are available either in the current public version of the code , or in the current development version , that will be made public in the autumn of 2014 .",
    "the layout of this article is as follows . in section",
    "ii , we describe the theoretical approach behind the program and outline the theoretical and practical details of the current implementation .",
    "the section starts with a detailed description of the generic two - probe and multi - probe junction setups available within gollum and introduces the terminology that will be used throughout the article .",
    "this is followed by subsections describing the determination of the surface green s function of each current - carrying lead and the full scattering matrix .",
    "we then introduce a convenient method that allows us to describe finite - voltage non - equilibrium effects .",
    "a subsection explaining the concept of virtual leads enables us to describe hybrid structures containing non - collinear magnetism or superconductivity within the scattering region .",
    "two additional subsections explain two facilities included in gollum that enable us to describe electronic correlation effects beyond dft , including coulomb blockade and kondo physics .",
    "we then show how to include a gauge field in the gollum hamiltonian .",
    "a final subsection explains the multi - scale methodology used to describe large - scale junctions and environmental effects , using a combination of classical molecular dynamics for the environment and quantum transport for the central scattering region .    in section iii , we present the details and results of the simulations of a series of sixteen different demonstrator systems .",
    "the purpose of each demonstrator is to present one or more of the functionalities of gollum .",
    "we start with a few model junctions , described by tight - binding hamiltonians , which show basic capabilities and demonstrate how easily and flexibly the program can analyze non - trivial physical effects .",
    "these include two and four - terminal normal - metal junctions , a two - dimensional system showing the quantum hall effect , and two hybrid structures , the first containing two superconducting islands sandwiched by two normal metal electrodes , and the second containing a non - collinear spin structure . there",
    "follow a series of dft - based calculations , that describe spin - active junctions ; graphene junctions , where the use of van der waals functionals is crucial and junctions enclosing metallo - organic molecules , where a treatment of strong - correlations beyond dft is mandatory .",
    "these are handled using three different approaches . in the first",
    ", the properties of metalloporphyrin junctions are described using the lda+u methodology ; in the second , the lda spectrum of an ope derivative is adjusted to improve the agreement with experimental data ; in the third , we describe coulomb blockade and kondo features of model or simple gold junctions .",
    "the next demonstrator shows how gollum can compute the thermoelectric transport properties of a junction.this is followed by a discussion of the transport properties of a carbon - nanotube - based four - probe junction .",
    "the next three examples require the use of multi - scale techniques , where we use a three - step methodology described later in the article .",
    "the first demonstrator describes how liquid environmental effects modify the transport properties of a single - molecule junction .",
    "the second example demonstrates that single strands of dna can be trans - located though graphene nanopores , where the strands effectively gate the nanopore structure yielding a highly sensitive dna sensor based on field - effect - transistor concepts .",
    "a final demonstrator shows how gollum can compute full sequences of pulling and pushing cycles in single - molecule junctions resembling the opening and closing cycles of mechanically controllable break junction ( mcbj ) experiments , enabling the construction of theoretical conductance histograms .",
    "the final demonstrator shows how gollum has access to the phase of the full scattering matrix , and describes non - trivial quantum pumping effects related to the phase evolution of the scattered wave function .",
    "a concluding section summarizes the features delivered by the program and an appendix illustrates our method to decimate hamiltonians and overlap matrices .",
    "gollum describes open systems comprising an extended scattering region ( colored dark blue in figs .",
    "1 and 2 ) connected to external crystalline leads ( colored light blue in figs . 1 and 2 ) .",
    "depending on the problem of interest and the language used to describe the system , the material ( m ) of interest forming the central part of the scattering region could comprise a single molecule , a quantum dot , a mesoscopic cavity , a carbon nanotube , a two - dimensional mono- or multi - layered material , a magneto - resistive element or a region containing one or more superconductors .",
    "figure 1 shows an example of a 4-lead system whose central scattering region ( generically labelled m throughout the paper ) is a molecule .",
    "it is important to note that in an accurate ab initio description of such a structure , the properties of the leads closest to the molecule ( or more generally the central scattering material ) will be modified by the presence of the central scattering region ( m ) and by the fact that the leads terminate . in what follows",
    ", we refer to those affected portions of the leads closest to the central scatterer as branches and include them as part of the extended scatterer ( denoted em throughout this article ) .",
    "consequently within gollum , a typical structure consists of an extended scatterer ( em ) , formed from both the central scatterer ( m ) and the branches .",
    "the extended scattering region is connected to crystalline current - carrying leads of constant cross - section , shown in light blue in the figs . 1 and 2 .",
    "for an accurate description of a given system , the branches are chosen to be long enough such that they join smoothly with the ( light blue ) crystalline leads .",
    "crucially , the properties of this interface region between the central scatterer m and the leads are determined by their mutual interaction and are not properties of either m or the electrodes alone .    , where @xmath1 is an applied bias .",
    "( bottom ) each lead is composed of an infinite chain of identical pl with hamiltonian @xmath2 coupled with each other via coupling hamiltonians @xmath3 .",
    "the extended scattering region comprises the actual central scattering region and several pl in each branch up to the tpl .",
    "the tpl connect the em region to the leads .",
    "the central scattering region consists in this example of the electrodes surfaces and a molecule . ]",
    "2 shows a two - terminal device in more detail and introduces further terminology to be used throughout the paper .",
    "the regions in light blue are called electrodes or leads and are described by perfect periodic hamiltonians subject to chosen chemical potentials .",
    "each lead @xmath4 is formed by a semi - infinite series of identical layers of constant cross section , which we refer to as principal layers ( pls ) .",
    "2 shows only two pls per lead ( colored white ) , although an infinite number is implied .",
    "furthermore in the figure , the leads are identical and therefore the lead index @xmath4 has been dropped .",
    "these pls are described mathematically by intra - layer hamiltonians @xmath5 .",
    "pls must be chosen so that they are coupled only to their nearest neighbors by the hamiltonians @xmath6 , which means that in the presence of long - range couplings , a pl may contain more than one longitudinal unit cell of the lead .",
    "then , if each pl contains @xmath7 orbitals , then @xmath5 and @xmath6 are square @xmath8 matrices",
    ". the extended scatterer ( em ) in dark blue is composed of a central scattering region ( m ) and branches .",
    "each branch contain several pls .",
    "these pls have an identical atomic arrangement as the pls in the leads .",
    "however , their hamiltonians differ from @xmath5 and @xmath6 due to the presence of the central scattering region .",
    "pl numbering at each branch starts at the pl beside the central scattering region .",
    "the outermost pl at each branch of the em region is called the terminating principal layer ( tpl ) and must be described by hamiltonians @xmath9 and @xmath10 which are close enough to @xmath5 and @xmath6 , to match smoothly with the corresponding lead hamiltonian . for this reason , gollum requires that the em contain at the very least one pl . the central scatterer ( m ) itself",
    "is described by an intra - scatterer hamiltonian @xmath11 and coupling matrices to the closest pls of the branches . in the example in fig .",
    "2 , the central scattering region m comprises a molecule and the atoms forming the electrode surfaces .",
    "the surfaces in gollum include all atoms belonging to the electrodes whose atomic arrangements can not be cast exactly as a pl , due to surface reconstructions , etc . for simplicity , fig .",
    "2 shows the case of a symmetric system , although no such symmetries are imposed by gollum .",
    "all hamiltonians are spin- dependent , but again for notational simplicity , the spin index @xmath12 will not be written explicitly here .",
    "this means that the hamiltonian @xmath13 for a given lead @xmath4 can be written as the semi - infinite matrix : @xmath14 when using a non - orthogonal basis set , overlap matrices must be defined with the same structure as the hamiltonian matrices : @xmath15 and @xmath16 .",
    "it is convenient to introduce the notation @xmath17 for notational simplicity , from now we will consider the case where all leads are equal so that the super - index @xmath4 can be omitted , although gollum imposes no such restrictions .",
    "the program can assume either open or periodic boundary conditions in the plane perpendicular to the transport direction .",
    "in this last case , unit cells are chosen in the plane perpendicular to the transport direction and the hamiltonians and overlap matrices acquire a specific dependence on the transverse k - vector , @xmath18 , @xmath19 where @xmath20 and @xmath21 label the @xmath22 orbitals in the unit cell ( ie pl ) at the origin of @xmath23 , while @xmath24 denote orbitals equivalent to @xmath21 , but placed in adjacent unit cells located at transverse positions @xmath23 . for @xmath25 , @xmath20 and @xmath21 must belong to the same pl @xmath26 , while for @xmath27",
    ", @xmath24 must belong to the pl @xmath28 .",
    "finally @xmath23 are vectors in the two - dimensional bravais lattice , joining the unit cell taken as origin with its neighboring unit cells .    to illustrate how an em is connected to leads",
    ", we now consider the 4-lead example of fig.1 , where we assume that the tpl is the third pl in each branch . to describe such a multi - terminal setup ,",
    "the hamiltonian matrix @xmath29 of the em is arranged in a non - conventional way .",
    "the first matrix block corresponds to the central scattering region @xmath30 , the second matrix block corresponds to the pls in the em branch connecting to lead 1 , the third matrix block to the pls in the em branch connecting to lead 2 , and so on .",
    "@xmath31    finally , the em described by @xmath29 and the leads described by @xmath32 are coupled via matrices @xmath33 to yield a four - terminal junction described by the infinite matrix : @xmath34    where , @xmath35 couple @xmath29 and for example , @xmath36 this arrangement of the hamiltonian enables the straightforward generalization of the approach to an arbitrary number of leads .",
    "the transport properties of the junction are encapsulated in its scattering matrix @xmath37 , which can be obtained by computing the green s function of the whole junction @xmath38 by solving the infinite system of equations @xmath39 this equation can be simplified by replacing the semi - infinite lead greens functions @xmath40 by their surface green s functions @xmath41 , whose dimensions are @xmath42 .",
    "the remaining system of equations takes the form    @xmath43    where the coupling hamiltonians are now @xmath44 and the surface green s functions of the isolated leads @xmath45 can be obtained as described in section ii.a.3 below .",
    "the equation for the full green s function can be written in a more compact form as    @xmath46    the scattering matrix can be computed using the green s functions matrix elements @xmath47 connecting the different leads , which can be obtained by inverting only the upper matrix box in eq .",
    "( [ gf ] ) @xmath48 in contrast , access to the local electronic and current densities at the em region is obtained from @xmath49    the above expressions for the hamiltonians are very general .",
    "any appropriate tight - binding hamiltonian could be introduced by hand to allow computation of the transport properties of a parametrized model .",
    "alternatively , any dft code using localized basis sets can provide them .",
    "in this case the dft program produces the hamiltonians and fermi energy of the em region @xmath50 , @xmath51 and @xmath52 , and of each lead @xmath53 , @xmath15 and @xmath54 in separate runs .",
    "gollum has an interface to the latest versions of the dft program siesta ( siesta 3.1 , siesta vdw and siesta lda+u ) and of fireball and more interfaces will be developed in the future .",
    "spin degrees of freedom in spin - active systems are handled as follows : if the spins are all collinear , then we compute separate hamiltonians and perform separate transport calculations for the spin - up and -down degrees of freedom .",
    "however , if the junction has non - collinear spins or is subject to spin - orbit interactions@xcite , then the spin - up and down - degrees of freedom are regarded as two distinct sets of orbitals in the hamiltonian , whose distinct labels allow the computation of spin - currents or magneto - resistive behaviors .",
    "( color online ) infinite system used to generate the leads hamiltonians @xmath55 and @xmath56 .",
    "a positive direction is defined to be towards the scatterer . ]",
    "each of the lead green s functions @xmath45 is determined following the procedures described in refs .",
    "[ ] with some minor modifications . to do so , we start by associating to each semi - infinite lead @xmath4 a periodic infinite system , whose unit cell contains a single pl , as sketched in fig .",
    "( [ fig : lead - generation ] ) . @xmath55 and @xmath56",
    "can then be created for this infinite system by hand as model hamiltonians , or can be generated by a dft program in a dedicated simulation .",
    "notice that we will drop the @xmath4 super - index until the end of the section for simplicity .    by expanding the bloch eigenstates of the infinite system in a localized basis set @xmath57 where @xmath26 , @xmath20 are indices for its unit cells and the orbitals within them , and",
    "@xmath58 is a dimensionless , longitudinal bloch wave - vector , the following secular @xmath42 equation can be deduced @xmath59 where the column vector @xmath60 contains the wave - function coefficients @xmath61 .",
    "the above equation is usually solved by choosing a wave vector @xmath58 and solving for the eigen - energies and the corresponding eigenvectors . however , in the present transport problem , we do the opposite : we choose the energy @xmath62 and solve for the allowed wave vectors and corresponding eigenstates . for a given energy @xmath62 ,",
    "the above equation has @xmath63 solutions with either real or complex wave vectors @xmath64 , @xmath65 . to obtain the latter",
    ", the equation can be recast as @xmath66 where @xmath67 and @xmath68 are the @xmath42 identity and zero matrices , @xmath69 and @xmath70 is a n - component column vector .",
    "gollum solves equation ( [ gep ] ) as it is superior in numerical terms to equation ( [ gep1 ] ) .",
    "we compute the group velocities of the states corresponding to real wave vectors as @xmath71 note that @xmath72 has units of energy and therefore the real , fully - dimensioned group velocity is @xmath73 , where @xmath74 is the spacing between neighboring pls in a given lead .",
    "we now divide the @xmath63 wave vectors obtained from eq .",
    "( [ gep ] ) into two sets , each containing n values.the first set denoted \\{@xmath64 } are real ( complex ) wave vectors that have @xmath75 ( @xmath76 ) and therefore propagate propagate ( decay ) to the right of the figure .",
    "they are consequently called positive open ( closed ) channels .",
    "the second set denoted \\{@xmath77 } are real ( complex ) wave - vectors that have @xmath78 ( @xmath79 ) propagate ( decay ) to the left of the figure .",
    "they are called negative open ( closed ) channels .",
    "we introduce the dual vectors @xmath80 , @xmath81 , which satisfy @xmath82 and @xmath83 .",
    "these can be found by inverting the @xmath42 matrices @xmath84 the above eigenvectors can be used to construct the following transfer matrices @xmath85 these transfer matrices allow us to build the coupling matrix @xmath1 , the self - energies @xmath86 , and the surface green s functions @xmath45 : @xmath87    the procedure described above to compute the lead green s functions can fail , because of the singular behavior of the hamiltonians matrices @xmath27 , which lead to numerical inaccuracies in the solution of eq .",
    "( [ gep ] ) , and is usually manifested in the program producing a number of positive and negative channels different from @xmath22 . notice that if the number of positive and negative channels is different from @xmath22 , then the dual vectors can not be found by inverting @xmath88 and @xmath89 .",
    "there exist several schemes to regularize @xmath27 , based on decimating out the offending degrees of freedom .",
    "these procedures are explained in detail in refs . [ ] .",
    "gollum uses a suitable adaptation of these methods , which is described in the appendix .",
    "( color online ) infinite system whose unit cell is the em region .",
    "this is linked to neighboring em cells by periodic boundary conditions . ]",
    "( color online ) super cell containing the extended scattering region em .",
    "the em region is surrounded by buffer vacuum regions to its left and right . ]",
    "as noted above , @xmath90 can be provided as a model hamiltonian , or generated by a dft or other material - specific program .",
    "one of the strengths of gollum is an ability to treat interfaces with high accuracy . in a tight - binding description ,",
    "tight - binding parameters of a particular material are often chosen by fitting to a band structure .",
    "however this does not solve the problem of choosing parameters to describe the interface between two materials .",
    "often this problem is finessed by choosing interface parameters to be a combination of pure - material parameters such as an arithmetic or geometric mean , but there is no fundamental justification for such approximations .",
    "therefore we describe here methods to generate @xmath90 using a dft program , where the inclusion of branches as part of the extended scatterer occurs naturally .",
    "( [ fig : em1 ] ) shows an example of a junction where the electrodes are identical .",
    "the system is composed of super cells formed from a central scatterer and pls .",
    "there are periodic boundary conditions in the longitudinal direction , such that the tpl of one branch of a super - cell is linked smoothly to the tpl of a neighboring super - cell . running",
    "a dft program for such a super - cell then automatically generates @xmath90 .",
    "provided the super cells contain sufficient pls , the hamiltonians @xmath91 and @xmath92 associated with the tpls will be almost identical to those generated from a calculation involving an infinite periodic lead .",
    "if the hamiltonians @xmath25 and @xmath27 associated with the pls are generated from a calculation involving an infinite periodic lead , then provided the super cells contain sufficient pls , these will be almost identical to @xmath91 and @xmath92 respectively . in this case",
    "then there will be minimal scattering caused by the junction between the tpl and the lead .",
    "clearly there is a trade - off between accuracy and cpu time , because inserting more pls increases the size and cost of the calculation . in practice",
    ", the number of pls retained in such a super - cell is increased in stages until the results do not change significantly as the number of pls is increased further .",
    "there exist situations where the electrodes are dissimilar , either chemically , or because of their different crystalline structure , or because their magnetic moments are not aligned . in these cases",
    ", there can not be a smooth matching between tpls of neighboring super cells in fig .",
    "4 . to address this situation",
    ", we use a setup similar to that displayed in fig .",
    "( [ fig : em2 ] ) , where additional pls are appended to the branches in the em region .",
    "these additional pls are terminated by artificial surfaces and surrounded by vacuum .",
    "the tpls are then chosen to be one of the pls near the middle of each branch and should be surrounded by enough pls both towards its artificial surface and towards the central scattering region . then the pls placed between the tpl and the artificial surface are discarded .",
    "these sacrificial pls ensure that the chosen tpl is unaffected by the presence of the artificial vacuum boundary .",
    "clearly , calculations of this sort are more expensive in numerical terms than those performed with super cells generated as in fig .",
    "( [ fig : em1 ] ) , because they contain many more atoms .      in an ab initio calculation of the transport properties of a junction",
    ", the dft program produces the hamiltonians and fermi energy of the em region @xmath50 , @xmath51 and @xmath93 , and of each lead @xmath53 , @xmath15 and @xmath54 in separate runs . notice that the hartree potential is defined up to a constant , which is usually different for the em and for each lead",
    "this usually means that the energy origin of the em and of the corresponding lead pls , as well as their fermi energies do not agree with each other , so eq . ( 2 ) must be rewritten as follows : @xmath94 where we have referred the energy of each lead to its own fermi energy . to fix the hamiltonian mismatch we define a realignment variable for each lead as follows : @xmath95 where @xmath20 indicates a relevant orbital or group of orbitals .",
    "then , the hamiltonian of each lead is realigned with that of the em @xmath96 it turns out that the renormalized @xmath97 and bare @xmath54 fermi energies of each lead do not match perfectly with each other if the number of pls in the em region is not sufficiently large .",
    "this is the case when for efficiency reasons , it is desirable to artificially minimize the size of the em . sometimes it is advisable to choose the fermi energy of one of the leads @xmath98 as the reference energy . in this case , a second overall shift can be performed using either @xmath99 or the quantity @xmath100 .",
    "we note that the most general scattering state in a given lead @xmath4 at a given energy @xmath62 can be written as a linear combination of open and closed channels as follows @xmath101 where @xmath102 and @xmath103 denote here open positive and negative channels and @xmath104 and @xmath105 are their normalized kets . here",
    ", the contribution of all the closed channels in lead @xmath4 is described by the ket @xmath106 .",
    "consequently , the number of electrons per unit time flowing between two adjacent pls within the lead is @xmath107 we pick in this section the convention that positive direction in the lead means flow towards the em region and vice versa .",
    "so positive ( negative ) open channels are also called incoming ( outgoing ) channels of lead @xmath4 . with this notation .",
    "the wave - function coefficients of the incoming open channels of a given lead are determined by the properties of the reservoir connected to the lead .",
    "the wave function coefficients of the open outgoing channels of lead @xmath4 are obtained from the amplitudes of all incoming channels by @xmath108 where @xmath103 ( @xmath109 ) is an outgoing ( incoming ) dimensionless wave - vector of lead @xmath4  ( @xmath110 ) .",
    "it is therefore convenient to assemble the wave - functions of the @xmath111 outgoing and @xmath111 incoming open channels of a given lead @xmath4 in the column vectors @xmath112 , @xmath113 , and all the scattering matrix elements connecting leads @xmath4 and @xmath110 into the matrix block @xmath114 .",
    "notice that the dimensions of @xmath114 are @xmath115 .",
    "then the above equation can be written more compactly as @xmath116    by normalizing the bloch eigenvectors @xmath60 , @xmath117 and their duals to unit flux , @xmath118 the matrix elements of the scattering matrix block connecting leads @xmath4 and @xmath110 can be written as .",
    "@xmath119 here @xmath120 is the off - diagonal block of the surface green s function defined in eqs . ( 11 ) and ( 12 ) , that connects leads @xmath4 and @xmath110 and @xmath121 is the matrix defined in eq . (",
    "20 ) .    with the above notation , if the incoming channel @xmath102 of lead @xmath4 is occupied with probability @xmath122 ( ie if in eq .",
    "( [ ok ] ) , @xmath123 with probability @xmath122 ) then the number of electrons per unit time , entering the scattering region from reservoir @xmath4 along channel @xmath102 with energy between @xmath62 and @xmath124 is @xmath125 and the number per unit time , per unit energy leaving the scatterer and entering reservoir @xmath4 along channel @xmath126 with energy between @xmath62 and @xmath124 is @xmath127    in many cases , the incoming and outgoing channels of each lead @xmath4 can be grouped into channels possessing particular attributes ( ie quantum numbers ) labeled @xmath128 etc .",
    "this occurs when all incoming channels of a particular type @xmath129 in lead @xmath4 possess the same occupation probability @xmath130 .",
    "for example , all quasi - particles of type @xmath129 in reservoir @xmath4 may possess a common chemical potential @xmath131 and @xmath132 may take the form @xmath133 , where @xmath134 is the fermi function . in this case , if the incoming and outgoing channels of type @xmath129 belonging to lead @xmath4 possess wave - vectors @xmath135 , @xmath136 , then the number of quasi - particles per unit time of type @xmath129 leaving reservoir @xmath4 with energy between @xmath62 and @xmath124 is    @xmath137    where @xmath138 and @xmath139 is the number of open incoming channels of type @xmath140 , energy @xmath62 in lead @xmath4 . note that in the above summation , @xmath141 runs over all outgoing wave - vectors of energy @xmath62 and type @xmath129 of lead @xmath4 and @xmath142 runs over all incoming wave - vectors of energy @xmath62 and type @xmath143 in lead @xmath110 .",
    "if @xmath4 and @xmath110 are different leads , then @xmath144 is often called the transmission amplitude and denoted @xmath145 , while if they are the same lead , then @xmath146 is called the reflection amplitude @xmath147 .",
    "similarly , for @xmath148 , it is common to define the transmission coefficient @xmath149 as @xmath150 and for @xmath151 , we define the reflection coefficient as @xmath152 so that @xmath153f^i_{\\beta_i}(e ) \\nonumber \\\\ & - & \\sum _ { { j\\ne i},{\\beta_j}}t^{i , j}_{\\alpha_i,\\beta_j } f^j_{\\beta_j}(e)\\}\\label{x1}\\end{aligned}\\ ] ]    note that unitarity of the scattering matrix requires @xmath154    hence the sum of the elements of each row and column of the matrix @xmath155 is zero : @xmath156 or equivalently , @xmath157 and @xmath158    from eqs .",
    "( [ x1 ] ) and ( [ x3 ] ) , if @xmath159 is independent of @xmath110 and @xmath143 then @xmath160 for all @xmath4 and @xmath129 , as expected . for this reason , in the above equations , @xmath159 can be replaced by @xmath161 , where @xmath134 is an arbitrary function of energy , which in practice is usually chosen to be a fermi function , evaluated at a convenient reference temperature and chemical potential .",
    "when comparing theory with experiment , we are usually interested in computing the flux of some quantity @xmath88 from a particular reservoir . from eq .",
    "( [ xxx ] ) , if the amount of @xmath88 carried by quasi - particles of type @xmath129 is @xmath162 , then the flux of @xmath88 from reservoir @xmath4 is @xmath163 in the simplest case of a normal conductor , choosing @xmath164 , independent of @xmath129 , the above equation yields the electrical current from lead @xmath4 . within gollum @xmath129 may represent spin and in the presence of superconductivity may represent hole ( @xmath165 ) or particle ( @xmath166 ) degrees of freedom . in the latter case ,",
    "the charge @xmath167 carried by particles is -e , whereas the charge @xmath168 carried by holes is + e.      gollum starts from a mean - field hamiltonian provided either by the user or by an outside material - specific dft code .",
    "it then computes the scattering matrix and its related transport properties .",
    "when finite voltages are applied to the electrodes , they change the distribution of incoming and outgoing electrons and therefore the underlying hamiltonian .",
    "for example , a finite voltage in a two - terminal device may introduce an electrostatic potential , which should be included in the hamiltonian .",
    "a key feature of many negf codes including smeagol is that such effects can be treated self - consistently , albeit at the cost of a greatly increased computing overhead . to avoid this overhead",
    ", gollum assumes that the user is able to provide a modified hamiltonian at finite voltages .    based on our experience on the development and usage of negf programs and",
    "as demonstrated in in section iii.j below , we have found that in many cases , the following intuitive modification of the initial zero - voltage hamiltonian yields reasonable - accurate voltage - dependent transmission coefficients @xmath169 connecting leads @xmath4 and @xmath110 . the scheme enables the simulation of non - trivial @xmath170 curves which compare favorably to those obtained using negf techniques and enables the modeling of generic non - equilibrium transport phenomena such as negative differential resistance ( ndr ) and current rectification in close agreement with negf codes@xcite .",
    "consider the case where each lead has a different voltage @xmath121 .",
    "then the finite - voltage hamiltonian takes the form    @xmath171    we find that @xmath29 needs only be computed at zero voltage in most cases ; the effect of a finite bias can be accounted for by a suitable re - alignment of the energies of the orbitals in the em region with the shifted energy levels of the electrodes .",
    "mathematically , we apply a simple shift to the hamiltonian matrix elements at each orbital @xmath26 in the em region @xmath172 where these local shifts @xmath173 depend on the junction electrostatics , which in many cases are known . for example , in the case of a highly - transparent junction , the shifts can be modeled by a linear voltage ramp connecting the matrix elements of the orbitals at the tpls of the em region . in contrast , when the central scattering region hamiltonian @xmath174 is connected to the pl hamiltonians @xmath175 in each branch of the em region by weaker links @xmath176 , the voltage drop and therefore the resistance is concentrated at these spots . in this case , we take @xmath177 for all orbitals in branch @xmath4 , starting at the tpl and up to the linker atoms , and @xmath178 for all the orbitals inside the m region itself .",
    "this scheme performs specially well for systems where the states around the fermi level ( homo or lumo ) are localized at or close to the contact atoms .",
    "it enables us to mimic accurately junctions displaying non - trivial negative differential resistance , as well as rectification effects for asymmetric molecules@xcite .      what is the difference between a lead and a channel ? from a mathematical viewpoint",
    ", channels connect an extended scattering region to a reservoir and the role of lead @xmath4 is simply to label those channels @xmath179 , which connect to a particular reservoir @xmath4 .",
    "conceptually , this means that from the point of view of solving a scattering problem at energy @xmath62 , a single lead with @xmath180 incoming channels can be regarded as @xmath180 virtual leads , each with a single channel .",
    "gollum takes advantage of this equivalence by regarding the above groups of channels with wave - vectors @xmath181 as virtual leads and treating them on the same footing as physical leads . from this viewpoint ,",
    "( [ xxx ] ) and ( [ x1 ] ) yield the number of quasi - particles per unit time `` from virtual lead @xmath129 '' entering the scattering region with energy between @xmath62 and @xmath124 .",
    "this viewpoint is particularly useful when the hamiltonians @xmath182 , @xmath183 describing the pls of the physical lead @xmath4 are block diagonal with respect to the quantum numbers associated with @xmath181 .",
    "for example , this occurs when the leads possess a uniform magnetization , in which case the lead hamiltonian is block diagonal with respect to the local magnetization axis of the lead and @xmath140 represents the spin degree of freedom @xmath12 .",
    "this occurs also when the leads are normal metals , but the scattering region contains one or more superconductors , in which case the lead hamiltonian is block diagonal with respect to particle and hole degrees of freedom and @xmath140 represents either particles @xmath184 or holes @xmath185 . more generally , in the presence of both magnetism and superconductivity , or combinations of singlet and triplet superconductivity , @xmath140 would represent combinations of spin and particles and holes degrees of freedom .    in all of these cases , @xmath182 , @xmath183",
    "are block diagonal and it is convenient to identify virtual leads @xmath129 with each block , because gollum will compute the channels @xmath181 belonging to each block in separate calculations and therefore guarantees that all such channels can be separately identified .",
    "this is advantageous , because if all channels of @xmath182 , @xmath183 were calculated simultaneously , then in the case of degeneracies , arbitrary superpositions of channels with different quantum numbers could result and therefore it would be necessary to implement a separate unitary transformation to sort channels into the chosen quantum numbers . by treating each block as a virtual lead ,",
    "this problem is avoided .",
    "examples of this approach are presented below , when describing the scattering properties of magnetic or normal - superconducting - normal systems .      in the presence of non - collinear magnetic moments , provided the lead hamiltonians are block diagonal in spin indices ( in general relative to lead - dependent magnetization axes ) choosing @xmath186 and @xmath164 in eq .",
    "( [ xxxx ] ) yields for the total electrical current @xmath187 note that in general it is necessary to retain the subscripts @xmath188 associated with @xmath189 or @xmath190 , because the leads may possess different magnetic axes .",
    "similarly the thermal energy from reservoir @xmath4 per unit time is @xmath191    for the special case of a normal multi - terminal junction having collinear magnetic moments , @xmath192 for all @xmath4 and since there is no spin - flip scattering , @xmath193 . in this case , the total hamiltonian of the whole system is block diagonal in spin indices and the scattering matrix can be obtained from separate calculations for each spin .",
    "we assume that initially the junction is in thermodynamic equilibrium , so that all reservoirs possess the same chemical potential @xmath194 . subsequently .",
    "we apply to each reservoir @xmath4 a different voltage @xmath195 , so that its chemical potential is @xmath196 .",
    "then from equation ( [ xxx ] ) , the charge per unit time per spin entering the scatterer from each lead can be written as @xmath197 and the thermal energy per spin per unit time is @xmath198 where @xmath199 and @xmath200 is the deviation in fermi distribution of lead @xmath4 from the reference distribution @xmath201 .    in the limit of small potential differences or small differences in reservoir temperatures ,",
    "the deviations in the distributions from the reference distribution @xmath202 can be approximated by differentials and therefore to evaluate currents , in the presence of collinear magnetism , gollum provides the following spin - dependent integrals @xmath203    in the presence of two leads labeled @xmath204 , the spin - dependent low - voltage electrical conductance @xmath205 , the thermopower ( seebeck coefficient ) @xmath206 , the peltier coefficient @xmath207 and the thermal conductance @xmath208 can be obtained as @xmath209 so that the equivalent spin - summed magnitudes are @xmath210    note that the thermal conductance is guaranteed to be positive , because the expectation value of the square of a variable is greater than or equal to the square of the expectation value . for a two - terminal system ,",
    "the above expressions allow us to obtain the electronic contribution to the thermoelectric figure of merit@xcite : @xmath211        a phenomenological scheme that improves the agreement between theoretical simulations and experiments in , for example , single - molecule electronics consists of shifting the occupied and unoccupied levels of the m region downwards and upwards respectively to increase the energy gap@xcite of the m region .",
    "the procedure is conveniently called spectral adjustment in nanoscale transport ( saint ) . at the request of a user , gollum modifies the hamiltonian operator of the m region as follows : @xmath212 where @xmath213 are energy shifts and ( @xmath214 , @xmath215 ) denote the occupied and unoccupied states , respectively . by using the definition of the density matrix operator of the m region @xmath216 the above hamiltonian can be rewritten as @xmath217 the equation can also be written in matrix form as @xmath218 to find the density matrix , we first solve the generalized eigenvalue problem : @xmath219 where @xmath220 is the @xmath221 identity matrix , and we have arranged the eigen - energies @xmath222 into a diagonal matrix @xmath223 .",
    "then @xmath224 in the simplest case , for a single - molecule junction , the shifts @xmath225 are chosen to align the highest occupied and lowest unoccupied molecular orbitals ( ie the homo and lumo ) with ( minus ) the ionization potential ( ip ) and electron affinity ( ea ) of the isolated molecule @xmath226 however the coulomb interactions in the isolated molecule are screened if the molecule is placed in close proximity to the metallic electrodes .",
    "currently , gollum takes this effect by using a simple image charge model@xcite , where the molecule is replaced by a point charge located at the middle point of the molecule and where the image planes are placed 1  above the electrodes surfaces .",
    "then the shifts are corrected by screening effects as follows : @xmath227 where @xmath74 is the distance between the image plane and the point image charge .",
    "many nanoscale - scale junctions are expected to show coulomb blockade behavior , and in specific situations also kondo features @xcite .",
    "these features can be demonstrated by gating the junction , and should appear as coulomb and kondo diamond lines in contour density plots of the low - voltage conductance as a function of bias and gate voltages .",
    "these strong correlation effects are completely missing in conventional dft .",
    "accurate parametrizations of the ground - state energy density functional of the single - channel anderson model exist that allow a correct description of those phenomena@xcite",
    ". however , most nanojunctions are better modeled in terms of a multi - channel anderson model as we have chosen to do in gollum .",
    "this model is described by the hamiltonian @xmath228 where the hamiltonian at the central scattering region is given by @xmath229 here the @xmath230-sum runs over the @xmath231 correlated degrees of freedom and includes the spin index , @xmath232 denote the on - site energies and @xmath233 is the electronic coulomb repulsion , that is assumed to be the same for all degrees of freedom .",
    "we map the central scattering region hamiltonian @xmath30 in eq .",
    "( 4 ) into @xmath234 to extract the self - energies @xmath235 of the correlated degrees of freedom , in the spirit of dynamical mean field theory@xcite .",
    "following ref .",
    "( ) , our correlated degrees of freedom are a subset of the eigenstates of @xmath30 , that we will call here molecular orbitals .",
    "this contrast with the approach followed in ref .",
    "( ) where the correlated degrees of freedom where taken to be atomic orbitals of transition metal atoms .",
    "for a four - lead device , the details of our implementation are as follows .",
    "we take the em hamiltonian @xmath236 where @xmath174 has dimensions @xmath237 and therefore describes @xmath155 molecular orbitals .",
    "we first solve the generalized eigenvalue problem at the m region as in eqs .",
    "( 54 - 57 ) in the previous section to find the rotation matrix @xmath238 that diagonalizes @xmath174 : @xmath239 where @xmath240 is the @xmath221 identity matrix .",
    "we then perform the direct product @xmath241 to enlarge the size of the matrix @xmath238 to the dimensions of the em hamiltonian matrix .",
    "we then rotate the em hamiltonian and compute the green s function of the em region @xmath242 we now choose which molecular orbitals @xmath243 with associated on - site energies @xmath244 are the correlated degrees of freedom , and use the projectors @xmath245 to find their projected green s functions and occupancies @xmath246\\,f(e_f)\\end{aligned}\\ ] ] where @xmath247 is the em fermi level .",
    "we then shift the on - site energy of the correlated orbitals by the conventional double counting term@xcite @xmath248    as a consequence , we have to recompute again the green s functions @xmath249 this is cast in the form @xmath250 which allows us to extract the hybridization function @xmath251 .",
    "the initial ingredients in the solution of the multichannel anderson model are the set @xmath252 .",
    "they allow us to extract the self - energies @xmath253 using a impurity solver .",
    "these are added again to the on - site energies @xmath254 leading to a new em hamiltonian @xmath29 and associated green s function @xmath255 .",
    "from here we compute a new hybridization function @xmath256 with which new self - energies @xmath257 are determined .",
    "the cycle is repeated until self - consistency in @xmath258 and @xmath257 is achieved .",
    "the resulting @xmath29 is inserted back into eq .",
    "( 12 ) and the surface green - function matrix @xmath259 is computed to extract the transport properties of the correlated junction .    we have decided to include in gollum a finite-@xmath233 impurity solver . this way",
    ", we can subtract the double - counting terms and place the molecular orbitals at their correct bare energy positions by using eq .",
    "( [ eq : double_counting ] ) .",
    "there exist a variety of finite-@xmath233 impurity solvers based on perturbation expansions on the coulomb interaction @xmath233 , on the hybridization function @xmath251 , on interpolative approaches , on monte - carlo algorithms ( see ref .",
    "( ) for a detailed account of some of these solvers ) , or on numerical renormalization group techniques@xcite ( nrg ) .",
    "nrg techniques have superior accuracy , but they bring high computational demands .",
    "slave - boson - based expansions on @xmath251 like the oca@xcite are rather accurate and less expensive numerically .    the impurity solver used in gollum is based on the interpolative perturbation theory approach@xcite , where the second - order in @xmath233 expression for the electron self - energy is interpolated to match the atomic self - energy , and adjusted to satisfy consistency equations for the high - energy moments together with luttinger s theorem .",
    "this approach is computationally very simple , but has been proven to provide reasonable results for the multi - channel finite-@xmath233 anderson model@xcite .",
    "its main shortcoming is that it overestimates the kondo temperature , as we discuss in section ( [ section_kondo ] ) .",
    "specifically , the impurity solver that we have implemented to handle the multi - channel hamiltonian ( [ eq : anderson - hamiltonian ] ) is described in ref .",
    "( ) , although we have corrected errors in some of the equations in that reference .",
    "we note that this impurity solver handles @xmath260 spin - degenerate correlated degrees of freedom , so that @xmath231 must be an even number . in other words",
    ", these channels must come as kramers pairs .",
    "we stress that other impurity solvers can be implemented straightforwardly , due to the modular nature of gollum .",
    "to compute transport properties in the presence of a magnetic field gollum allows the user to introduce a peierls substitution by changing the phase factors of the coupling elements@xcite between atomic orbitals .",
    "for example in the case of a nearest - neighbor tight - binding hamiltonian , the inter- site matrix element @xmath261 between site i and site j is replaced with the modified element , @xmath262 where @xmath263 and @xmath264 are the positions of site i and j and @xmath265 is the vector potential .",
    "the gauge is chosen such that the principal layers of the leads remain translational invariant after the substitution .",
    "as an example , below we demonstrate how gollum describes the quantum hall effect in a disordered square lattice , with a perpendicular uniform magnetic field .",
    "and @xmath266 connected to a superconductor ]    figure [ fig : superconductor](a ) shows a two - probe normal - superconductor - normal (",
    "n - s - n ) device with left and right normal reservoirs connected to a scattering region containing one or more superconductors . if the complete hamiltonian describing a normal system of the type shown in fig .",
    "2 is @xmath267 , then in the presence of superconductivity within the extended scattering region , the new system is described by the bogoliubov - de gennes hamiltonian @xmath268 where the elements of the matrix @xmath269 are non - zero only in the region occupied by a superconductor , as indicated in figure [ fig : superconductor](b ) .",
    "physically , @xmath267 describes particle degrees of freedom , @xmath270 describes hole degrees of freedom and @xmath269 is the superconducting order parameter .",
    "the multi - channel scattering theory for such a normal - superconducting - normal ( n - s - n ) structure was first derived by lambert in ref . [ ] , where the following current - voltage relation was presented : @xmath271 where @xmath272 ( @xmath273 ) is the current from the left ( right ) reservoir , @xmath274 ( @xmath275 ) is the difference between the chemical potential of the left ( right ) reservoir and the chemical potential @xmath20 of the superconducting condensate and the voltage difference between the left and right reservoirs is @xmath276 .",
    "this expression is the low - voltage limit of more general current - voltage relations discussed in [ ] .",
    "the generalization to multi - probe structures is described in refs .",
    ", to thermoelectric properties of superconducting nanostructures in refs .",
    "[ ] and to ferromagnetic - superconducting structures in refs .",
    "[ ] . in this equation ,",
    "@xmath277 where @xmath278 ( @xmath279 ) is the number of open channels in the left ( right ) lead , @xmath280 ( @xmath281 ) are normal ( andreev ) reflection and transmission coefficients for quasi - particles emitted from the right lead , @xmath282 ( @xmath283 ) are normal ( andreev ) reflection and transmission coefficients from the left lead and all quantities are evaluated at the fermi energy @xmath284 . as a consequence of unitarity of the scattering matrix , these satisfy @xmath285 and @xmath286 .",
    "the current - voltage relation of equ .",
    "( [ x7 ] ) is fundamentally different from that encountered for normal systems , because unitarity of the s - matrix does not imply that the sum of each row or column of the matrix @xmath74 is zero .",
    "consequently , the currents do not automatically depend solely of the applied voltage difference @xmath276 ( or more generally on the differences between incoming quasi - article distributions ) . in practice",
    "such a dependence arises only after the chemical potential of the superconductor adjusts itself self - consistently to ensure that the current from the left reservoir is equal to the current entering the right reservoir . insisting that @xmath287 , then yields @xmath288 and therefore the two - probe conductance @xmath289 takes the form of @xmath290    the above equation demonstrates why a superconductor possesses zero resistivity , because if the superconductor is disordered , then as the length @xmath291 of the superconductor increases , all transmission coefficients will vanish . in this limit",
    ", the above equation reduces to @xmath292 .",
    "in contrast with a normal scatterer , this shows that in the presence of andreev scattering , as @xmath291 tends to infinity , the resistance ( = 1/conductance ) remains finite and therefore the resistivity ( ie resistance per unit length ) vanishes .    in the notation of eqs .",
    "( [ xxx ] ) and ( [ x1 ] ) , the above current - voltage relations and their finite - temperature , finite voltage generalizations can be obtained from eq .",
    "( [ xxxx ] ) by writing @xmath293 or @xmath294 to yield @xmath295 since @xmath296 and @xmath297 , this becomes @xmath298   \\bar f^j_{\\beta_j}(e )   \\label{x6}\\ ] ] since , in the low - bias limit , @xmath299 , where @xmath134 is the fermi distribution with chemical potential @xmath20 , this simplifies to @xmath300 where @xmath301 \\label{x77}\\ ] ] the total current is obtained by multiplying eq .",
    "( [ x6 ] ) by a factor of 2 to account for spin . on the other hand , in the limit of zero temperature , @xmath302",
    "hence in this limit , the current - voltage relation ( [ x6 ] ) reduces to eq .",
    "( [ x7 ] ) .",
    "simulation of the transport properties of a nanoscale - scale junction involves three distinct tasks .",
    "first , model geometries must be generated .",
    "secondly , the hamiltonian for each geometry must be constructed .",
    "thirdly , the s - matrix can be calculated and transport properties of the junction calculated .",
    "gollum separates these three tasks into three different processes .",
    "an overview of the work - flow of a generic gollum calculation is shown in figure [ multiscale ] .",
    "the three consecutive stages of the work process are denoted by the three dotted rectangular boxes .",
    "the initial step consists usually of modeling the atomistic arrangement of the junction .",
    "an initial structure is usually guessed , followed by geometry optimization or molecular dynamics simulations to obtain a more realistic atomic arrangement .",
    "this task can be performed by either ab - initio or classical molecular - dynamics methods . for systems containing a few hundred atoms ,",
    "a quantum - mechanical dft - based simulation is usually the method of choice .",
    "however , experiments are often performed under ambient conditions or in a liquid environment . in these cases",
    "that the microscopic model should include the atomic structure of the environment , as we show below in section iii.gollum addresses this task by using classical molecular dynamics to model the environment and in the spirit of the born - oppenheimer approximation , feeding snapshots of the associated electrostatic field into the the dft - based mean - field hamiltonian .",
    "a similar approach is used to model the evolution of mechanically - controlled break junctions upon stretching , where the atomistic arrangement of the junction evolves slowly in time . in this case , if the same experiment is repeated a number of times , the junction geometry will be slightly different each time .",
    "therefore , a proper statistical analysis of the junction geometries is mandatory and calculations of the associated distribution of transmission coefficients is required .",
    "the task of generating junction geometries is also better suited for classical molecular dynamics situations .",
    "gollum also facilitates the use of combined dft and classical molecular dynamics approaches to gain accurate , yet quicker simulation results@xcite .",
    "a non - comprehensive set of software tools is listed in figure [ multiscale ] .",
    "once the atomic arrangements are generated , these are fed into the second stage , where the hamiltonian matrix is generated .",
    "this stage is in practice independent of the previous geometry construction and can be run separately , taking only the output geometries of the first stage .",
    "the junction hamiltonian can be generated using a variety of tools , some of which are listed in box ii in figure [ multiscale ] .",
    "a popular approach is the use of dft codes that are able to write the hamiltonian in a tight - binding language . in this way",
    ", model tight - binding hamiltonians can also be easily generated .",
    "other approaches involve the use of slater - booster or semi - empirical methods .",
    "in addition , gollum has the ability to modify suitably these hamiltonian matrices as discussed above .",
    "for example , the hamiltonian matrix can be modified to include scissor corrections , coulomb - blockade physics , a gate or bias voltage , a magnetic phase factor or a superconducting order parameter .",
    "finally , stage iii is the actual quantum transport calculation .",
    "this takes the hamiltonian matrix as an input and calculates the s - matrix and associated physical quantities , such the electrical or spin current , the conductance , or the thermopower .",
    "in this section , we present a diversity of calculations , which demonstrate the broad capabilities of gollum . for simplicity , we begin with a set of calculations on model hamiltonians , which demonstrate that gollum can easily handle tight - binding models for a range of physical systems .",
    "we then move on to more material - specific calculations , in which the hamiltonian is obtained from dft .",
    "these include examples exhibiting kondo physics , coulomb blockade and non - linear , finite - voltage effects .",
    "next we present more computationally challenging calculations involving van der waals interactions , environmental effects and series of geometries associated with break - junction measurements .",
    "finally an example of a quantum pump is presented , which requires access to the phase of scattering amplitudes .",
    "we define the conductance quantum @xmath303 , that will be used frequently below .      , @xmath304 , @xmath305 and @xmath306 ( taken in arbitrary units ) .",
    "]    ( a ) as a function of the energy .",
    "energies are referred to the fermi energy @xmath247 and are given in units of @xmath307 . ]",
    "( b ) that has four one - dimensional chain leads . as a function of the energy",
    "energies are referred to the fermi energy @xmath247 and are given in units of @xmath307 . ]    as a first example , we consider a simple one - dimensional tight - binding chain containing a single orbital per pl and a single impurity orbital in the em region , as shown in fig [ fig:2 - 4probetb](a ) .",
    "we take the following parameters , that are given in arbitrary units . within the leads ,",
    "the site energies are @xmath308 , and the nearest neighbor couplings are @xmath309 .",
    "the impurity has a site energy @xmath304 and is coupled to the leads by a hopping element @xmath310 .",
    "results are shown for @xmath305 and @xmath306 . the transmission coefficient for this chain",
    "is shown in figure [ fig:2probetb ] .    as a second example",
    ", we consider the four - probe structure of fig .",
    "[ fig:2 - 4probetb](b ) , that shares the same set of parameters as the two - probe model above .",
    "the various transmission coefficients for this structure are shown in figure [ fig:2probetb4 ] . by symmetry , these are all identical .",
    "as an example of a quantum transport calculation with a magnetic field , we demonstrate the quantum hall effect within the simple tight - binding square lattice shown in the inset of fig .",
    "[ quantumhall ] .",
    "the lattice constant is set to @xmath311  .",
    "the onsite energies of the perfect lattice are @xmath312 ev , the hopping integrals at zero magnetic field are @xmath305 ev and the fermi energy is set at zero .",
    "the red area in the figure denotes a disordered portion of the lattice . in this disordered area ,",
    "the onsite energies are randomly varied as @xmath313 , where @xmath314 is a random number distributed with uniform probability in the range @xmath315 , @xmath316 and @xmath317 ev ( red , green and blue dashed curves , respectively ) .",
    "the transport direction is chosen to be the @xmath318 axis ( e.g. : from bottom to top ) while the @xmath319 axis goes along the horizontal direction . to demonstrate the quantum hall effect we introduce a homogeneous magnetic field perpendicular to the square lattice , pointing out of the paper , which is expressed in units of @xmath320 tesla . with this setup the vector potential is chosen so that the lead remains translationally invariant along the @xmath318 direction .",
    "this means that we implement a peierls substitution of the form @xmath321 where @xmath322 and @xmath323 are the coordinates of the site i. with this modified hamiltonian the conductance calculated by gollum is shown in fig .",
    "( [ quantumhall ] ) .",
    "this clearly shows the presence of quantum hall plateaus , which are resilient to the presence of disorder .",
    "conductance @xmath324 in units of @xmath325 as a function of inverse magnetic field with various level of disorder .",
    "the magnetic field unit is set to @xmath326 tesla .",
    "the inset shows the square lattice used for the calculation .",
    "the black area denotes a perfect square lattice .",
    "the red area denotes a disordered portion of the lattice , where the inter - site distances are slight modified from @xmath327 to perturb the phase contribution .",
    "the onsite energy for the regular lattice is @xmath312 ev , the coupling with zero magnetic field is @xmath305 ev and the fermi energy is chosen as zero . in the disordered area",
    "the onsite energy is randomly varied as @xmath313 , where @xmath314 is a random number distributed with uniform probability in the range @xmath315 , @xmath316 and @xmath317 ev ( red , green and blue dashed curves , respectively ) . ]       and @xmath328 . the left ( right ) physical lead consists of two virtual leads @xmath329 and @xmath330 ( @xmath331 and @xmath332 ) carrying particle and hole channels respectively . ]    as an example of scattering in the presence of superconductivity , we now compute the electrical conductance of the n - s - n structure shown in fig .",
    "( [ fig : sup-1 ] ) , which contains two superconducting regions with order parameters @xmath333 and @xmath334 .",
    "such a structure is known as an andreev interferometer and was first analyzed in refs .",
    "[ ] , where it was predicted that the electrical conductance is a periodic function of the order - parameter phase difference @xmath335 , with period @xmath336 . at that time , this effect was completely missing from the more traditional quasi - classical description of superconductivity .",
    "when the missing terms were restored , good agreement between quasi - classical theory and scattering theory was obtained @xcite .    in the following calculation , the hamiltonian @xmath267 of eq .",
    "( [ super ] ) is simply a nearest neighbor tight - binding hamiltonian on a square lattice , with diagonal elements @xmath308 and nearest - neighbor couplings with @xmath305 ( in arbitrary units ) . within the regions occupied by superconductor @xmath110 , ( where @xmath337 or @xmath338 ) the top ( particle ) sites are coupled to the bottom ( hole ) sites by @xmath339 , with @xmath340 given in units of @xmath307 . for @xmath341 , figure ( [ fig : sup-2 ] )",
    "shows the energy dependence of the andreev refection coefficient @xmath342 and the normal and andreev transmission coefficients @xmath343 and @xmath344 respectively . the green line in figure ( [ fig : sup-2 ] ) represents the number of open channels in electron ( hole ) conducting leads .",
    "as expected , the andreev reflection coefficient is large for small energies and decreases for energies above @xmath345 . substituting the values of these coefficients at @xmath346 into eq .",
    "( [ eq : gsup ] ) and evaluating them for all @xmath335 yields the conductance versus @xmath335 plot shown in figure [ fig : sup-3 ] .",
    "as expected , the conductance is an oscillatory function of the order - parameter phase difference @xmath335 with period @xmath336 .",
    "( dot dashed line line ) , @xmath347 ( solid blue line ) , @xmath348 ( dashed line ) and the number of open channels in the left lead for the device shown in fig .",
    "( [ fig : sup-1 ] ) , as a function of the energy . as a function of the energy .",
    "energies are referred to the fermi energy @xmath247 and are given in units of @xmath307 . ]     in units of @xmath325 , for a n - s - n structure shown in fig .",
    "( [ fig : sup-1 ] ) as a function of the phase difference @xmath335 between the two order parameters . ]       and @xmath349 the left ( right ) physical lead consists of two virtual leads @xmath350 and @xmath351 ( @xmath352 and @xmath353 ) carrying up - spin and down - spin channels respectively . ]    in this section , we compute the electrical conductance of the structure shown in figure ( [ fig : mag1 ] ) , which we again describe using a simple tight - binding model of the form @xmath354 the hamiltonian @xmath267 is simply a nearest neighbor hamiltonian on a square lattice , with diagonal elements @xmath308 and nearest - neighbor couplings with @xmath305 ( in arbitrary units ) and for simplicity we choose @xmath355 everywhere .",
    "the systems consists of two magnetic islands with magnetic moments @xmath356 and @xmath349 , connected to non - magnetic leads . choosing the fermi energy to be @xmath357 , and evaluating eq .",
    "( [ xxxx1 ] ) at zero temperature , figure ( [ fig : mag2 ] ) shows the resulting electrical conductance as a function of the angle @xmath335 between the two magnetic moments .",
    "as expected , the conductance is an oscillatory function of the magnetic angle @xmath335 .     in units of @xmath325 , for the structure shown in shown in fig .",
    "( [ fig : mag1 ] ) as a function of the angle @xmath335 between the two magnetic moments . ]    having discussed model systems described by simple tight - binding hamiltonians , we now turn to more material - specific descriptions based on dft .",
    "we will use the program siesta in most of the calculations below , and will provide many of the simulation parameters to help people to reproduce our calculations .",
    "( color online ) spin - resolved transmission coefficients as a function of energy for nickel - chain junctions .",
    "the different curves correspond to simulation with different levels of accuracy in the @xmath358 summations : ( a ) , ( b ) , ( c ) and ( d ) correspond to 1 , 4 , 16 and 64 @xmath58-points , respectively .",
    "( 1 ) and ( 2 ) correspond to parallel and anti - parallel configurations , respectively . ]",
    "gollum can describe voltage - dependent spin - polarized transport in spin - active junctions , made from a variety of metals , including iron @xcite , platinum or palladium @xcite . to demonstrate this , we describe here",
    "the voltage - dependent spin - filtering and magneto - resistive behavior of a two - terminal junction where ( 001 ) fcc nickel electrodes with parallel ( p ) or anti - parallel ( ap ) spin orientations are connected by a nickel atomic chain@xcite .",
    "notice that because we may have electrodes with ap spin orientations , we are forced to use em setups such as those shown in fig .",
    "we sketch in fig .",
    "( [ em_victor1 ] ) the scattering region used in the present calculation .",
    "it comprises a 6-atom - long nickel chain , the electrodes surfaces and the two branches .",
    "the electrodes surfaces contain 2/3 atomic layers with 4 atoms each .",
    "the left and right branches contain two pls that have 4 atoms each .",
    "the second pl is followed by vacuum .",
    "we have checked that the transport results in this example are reasonably converged if we choose pl1 as the tpl , which means that pl2 is sacrificial .    to find the junction hamiltonian",
    ", we use the program siesta .",
    "we use the generalized gradient approximation ( gga ) functional@xcite and take the theoretical gga lattice constant of 3.45    for the pls as well as inter - atomic distances of 2.27    along the chain .",
    "we have employed a single-@xmath359 ( sz ) basis set to span the valence states and a mesh cutoff of 400 ry to define the real - space grid where the density , potential and matrix elements are calculated .    ) in the ( a ) p and ( b ) ap spin configurations as a function of the bias voltage applied to the junction .",
    "the different curves correspond to different numbers of @xmath18-points . ]    to understand the spin - polarized transport properties of the junction , we will analise below the spin - dependent transmission coefficients @xmath360 , together with the spin - dependent charge currents .",
    "these are computed using the approximate expression @xmath361 the above approximation is quantitatively accurate for small enough bias voltages ( @xmath362 v ) and also shows the expected qualitative behavior at larger voltages .",
    "we have found that the transmission coefficients and currents depend sensitively on the number of transverse @xmath18-points taken along the plane perpendicular to the transport direction .",
    "as we will show below , we need to use at least 16 @xmath18-points to achieve convergence . in other words",
    ", a @xmath363-point calculation provides a poor estimate of the transport properties of these junctions .",
    "we plot @xmath360 as a function of the energy referred to the fermi energy of the scattering region for p and ap spin orientations in fig .",
    "( [ fig : victor2 ] ) .",
    "the upper panel of the figure shows that the transmission coefficients for the p configuration are strongly spin - polarized .",
    "this polarization remains at the fermi level , which suggests that these junctions could act as spin filters .",
    "the bottom panel of the figure shows the transmission coefficients for the ap configuration .",
    "the fact that these are different from those of the p spin orientation hints that these junctions could show significant gmr ratios . to quantify these statements ,",
    "we compute the charge current of the junction in the p and ap configurations @xmath220 and @xmath364 and plot them in fig .",
    "( [ fig : victor3 ] ) .",
    "the figure shows that indeed these junctions show magnetorresistive properties .",
    "the figure also demonstrates that the currents depend on the number of @xmath18-points . to further give quantitative estimates of the spin activity of the junctions",
    ", we define the spin polarization in the p arrangement and the gmr ratio as @xmath365 where @xmath366 are the spin - dependent currents for the p orientation .",
    "we show in fig .",
    "( [ fig : victor4 ] ) these two magnitudes as a functions of the bias voltage applied to the junction .",
    "we indeed find large spin signals for these devices .",
    "furthermore , the figure demonstrates that at least 16 @xmath18-points are needed to achieve converged results .     and",
    "( b ) gmr ratio plotted as a function of the bias voltage applied to the junction shown in fig .",
    "( [ em_victor1 ] ) .",
    "the different curves correspond to different numbers of @xmath18-points . ]",
    "gollum can profit from the improved chemical accuracy delivered by the most advanced density functionals . as an example",
    ", we discuss here the transport properties of the junction shown in fig .",
    "( [ fig : graphene - junction ] ) , where a single phthalocyanine trimer molecule bridges two graphene electrodes separated by a physical gap of length 17.265  .",
    "these graphene sheets are armchair - terminated and passivated by hydrogen atoms .",
    "periodic boundary conditions are applied in the two directions across the graphene plane .",
    "the phthalocyanine units are linked by butadiyne chains .",
    "the planar anchors couple to the graphene via interaction of the @xmath367-clouds and therefore an accurate description of the chemical bonding and transport properties can only be achieved by the use of a van der waals density functional .",
    "we use here the implementation of dion et al . in the siesta program @xcite .",
    "we have computed the hamiltonian and overlap matrix elements using a double - zeta basis set for all the elements in the simulation , together with a grid fineness of 200 rydberg . by minimizing the energy ,",
    "we find that the molecule sits at a height of 3.4  above the sheets .",
    "we have studied the impact of the length of the electrode gap on the transport properties of the junction by attaching additional armchair layers to the edges of both sheets ; these layers are made of two carbon rows , and have a width of 2.502  .",
    "the transmission coefficients for several gap widths are shown in fig .",
    "( [ fig : graphene - gap ] ) .",
    "we find several breit - wigner resonances associated with molecular levels of the trimer .",
    "remarkably , these do not shift in energy as the gap width varies@xcite .",
    "however , deep dips appear for several gap widths .",
    "these are associated with interference among the different paths whereby electrons can propagate between the molecule and the electrodes .",
    "we have also studied the change in the transmission curves as the molecule is displaced laterally and longitudinally across the physical gap .",
    "we show representative examples of the transmission curves for longitudinal displacements in fig .",
    "( [ fig : graphene - y ] ) .",
    "the figures show that the energy positions of the molecular breit - wigner resonances remain almost constant .",
    "we have found the same behavior for other graphene - based junctions : the energy position of the breit - wigner resonances for a given graphene - based junction does not depend on the molecule position relative to the physical gap , provided that the bonding mechanism is by physisorption .",
    "this universality arises because physisorption carries no charge transfer between the molecule and the sheets .",
    "furthermore the electrodes are made from the same material and therefore there is no dipole moment associated with the contacts . finally ,",
    "the @xmath368 hybridization between molecular orbitals and the electrode states is weaker than for the bonds present in most noble - metal / single - atom contacts , and does not have a large impact on the nature of the molecular orbitals .      as an example of a gollum calculation using a lda+u density functional@xcite , we describe in this section a case where strong electronic correlations may affect the transport properties of a nanoscale - scale junction .",
    "we discuss the junction shown in fig .",
    "( [ fig : ldau - geometry ] ) . here",
    "gold ( 001 ) electrodes bridge either a porphyrin ( p ) or a metallo - porphyrin molecule ( cup or cop ) .",
    "electron flow through any of these three porphyrin molecules is carried by molecular orbitals that hybridize strongly with the gold s - orbitals .",
    "this gives rise to broad breit - wigner resonances in the transmission coefficients that are identical for the three molecules .",
    "however , for the cup and cop junctions , additional electron paths are created whereby electrons hop into and off the localized d - orbitals of the transition metal atom .",
    "the interference between direct and d - orbital - mediated paths creates sharp fano resonances that can however be masked by the much wider breit - wigner resonances@xcite .",
    "we see below how including strong correlations in the d - orbitals of the co and cu atoms in terms of a lda+u approach produces strong shifts in the energy dependence of those resonances .",
    "we have computed the hamiltonian using the siesta code , where we have picked a single zeta basis for the gold atoms at the electrodes , a double - zeta - polarized basis set for all the atoms in the molecule and a gga functional .",
    "we have included a @xmath233 correction term for the d - orbitals of the cu and co atoms in a mean - field fashion , in the spirit of the lda+u approach@xcite .",
    "we present here our results for values of @xmath233 equal to 0 , 2.5 and 4.5 ev .     of the junction shown in fig .",
    "( [ fig : ldau - geometry ] ) , where the central molecule is cup .",
    "@xmath369 is plotted as a function of the energy @xmath62 referred to the fermi energy @xmath247 of the scattering region .",
    "the different panels correspond to the different @xmath233 corrections added to the dft hamiltonian ( see text ) .",
    "the green and gold ellipses encircle masked fano resonances .",
    "they are originated by paths hopping onto the cu 3d@xmath370 or d@xmath371 orbitals .",
    "the red ellipse circles a sharp breit - wigner resonance coming from c and n atoms . ]",
    "we find that the transmission coefficients of the three molecules display the same wide breit - wigner resonances , that correspond to molecular orbitals hybridizing strongly with the electrodes .",
    "these are shown in figs .",
    "( [ fig : ldau - cup ] ) and ( [ fig : ldau - cop ] ) for cup and cop respectively .",
    "in addition , the three molecules show a sharp breit - wigner resonance that is marked by a red ellipse in the figures .",
    "this resonance corresponds to a molecular orbital encompassing c and n atoms that is weakly bonded to the electrodes .",
    "interestingly , this sharp breit - wigner resonance shifts in energy if we change the value of the coulomb interaction @xmath233 for the cup and cop junctions . to understand this phenomenon ,",
    "we have looked at the density of states of the junction projected onto each atomic orbital , and the local density of states integrated in a narrow energy window around the red resonance . we have found that the n- and c - based molecular orbital hybridizes with the d@xmath372 orbital of the copper or cobalt atoms and is therefore affected by the @xmath233-term .",
    "we have found additional sharp peaks appearing in @xmath373 for the cup and cop junction that do not show up for the simple porphyrin junction .",
    "these are marked by green , blue and gold circles in figs .",
    "( [ fig : ldau - cup ] ) and ( [ fig : ldau - cop ] ) .",
    "these seem to be sharp breit - wigner resonances also .",
    "however , we have demonstrated@xcite that they are actually fano resonances , where the fano dip is masked by the transmission of the neighboring wide breit - wigner resonances . by plotting the density of states of the junction projected in each orbital",
    ", we indeed find that they correspond to the copper d@xmath370 or d@xmath371 orbitals .",
    "because these fano resonances are associated with atomic d - orbitals strongly localized in the transition metal atom , we expect that adding a @xmath233-term will have a strong impact on their energy position .",
    "( [ fig : ldau - cup ] ) shows how these resonances indeed shift in energy as @xmath233 is increased .",
    "note that one of the fano resonances coming from the d@xmath370 copper orbital is strongly pinned to the fermi energy , while other resonances rapidly move down in energy .",
    "we analyze in this section the transport properties of a series ( 111 ) gold junctions that are bridged by ope derivatives .",
    "the backbone of these molecules has a varying number of rings ranging from one to three .",
    "the molecules may be oriented fully perpendicular to the electrodes surfaces , or making a tilting angle , as we show in fig .",
    "( [ tricene45 ] ) it is well established by now @xcite that gold junctions that contain conjugated thiol - terminated molecules like opes have a larger conductance when the molecule is tilted .",
    "this is due to the increased overlap of the @xmath374 states of the sulfur atoms when the angle between the molecule and the normal to the surface increases .",
    "we show in this section that a plain dft - based calculation predicts that the largest conductance occurs when the molecule is oriented perpendicular to the electrodes .",
    "this deficiency is remedied by the use of the saint method .",
    "this method is an efficient semi - empirical correction that allows us to obtain quantitative agreement between dft calculations and experiments@xcite , as we have already stressed in section ii .",
    "( color online ) a ( 111 ) gold junction sandwiching a tricene - dithiol molecule .",
    "the molecule is coupled to one ad - atom on one side and to a hollow gold site at the other end , and its orientation is titled with respect to the electrodes normal line . ]",
    "the hamiltonian of the junction has been obtained with the code siesta and a local density approximation ( lda ) functional@xcite .",
    "we have picked a single - zeta basis for the gold atoms of the electrodes , and a double - zeta - polarized basis for the atoms in the molecule .",
    "the pls of the electrodes contain three atomic layers , each having @xmath375 atoms .",
    "we have chosen junction geometries where the molecular derivatives are oriented either perpendicularly to the gold surfaces or making a 45 degrees angle , as shown in fig .",
    "( [ tricene45 ] ) . due to this tilting angle",
    ", we had to use a non - periodic scattering region , as in fig .",
    "the scattering regions consisted therefore of the molecule , the two surfaces containing two atomic layers each and 3 pls on each branch followed by vacuum .",
    "we chose pl2 as the tpl , so all hamiltonian matrix elements of pl3 were chopped off .",
    "( color online ) transmission of the junction shown in fig .",
    "( [ tricene45 ] ) , containing an ope molecule with 3 rings .",
    "@xmath373 has been calculated ( a ) without and ( b ) with saint corrections .",
    "continuous and dashed lines correspond to perpendicular and tilted ( 45 degrees ) molecules , respectively . ]",
    "we have computed the transmission curves @xmath373 for the referred ope derivatives using conventional dft , and have found for all of them that the conductance ( computed from @xmath376 ) is larger if the molecule is oriented perpendicular to the electrodes .",
    "the upper panel in fig .",
    "( [ t_saint_1 ] ) demonstrates this behavior for an ope containing three rings .",
    "the figure shows that the higher conductance is originated by the position of the homo level of the molecule , that is placed only slightly below the fermi energy of the scattering region .",
    "in contrast , the homo level of the tilted molecule is shifted farther away from @xmath247 .",
    "this situation demands for the use of the saint correction scheme , that will reposition the molecular orbital levels at their correct energies .",
    "we show in the bottom panel of the figure that this is indeed the case , and that by the use of the saint scheme , the correct experimental trend is recovered , where tilted molecules show larger conductances .",
    "we have verified that the same change happens for ope molecules containing one and two rings . finally , we plot in fig .",
    "( [ t_saint_2 ] ) @xmath373 for the three molecules ( containing one , two and three rings ) for perpendicular and tilted orientations .",
    "( [ g.saint ] ) we show the transmission of the ope derivatives with a number of rings between 1 and 3 and two tilting angles , 0 and 45 degrees .",
    "the figures show that all those junctions where the derivative is oriented perpendicularly to the gold surface ( defined here to be 0 degrees ) show a larger transmission at the fermi level than the tilted cases in contrast with our expectations discussed above @xcite .",
    "( color online ) transmission of the junction shown in fig .",
    "( [ tricene45 ] ) , containing an ope molecule with ( a ) 1 , ( b ) 2 and ( c ) 3 rings .",
    "@xmath373 has been calculated with saint corrections .",
    "continuous and dashed lines correspond to perpendicular and tilted ( 45 degrees ) molecules , respectively . ]",
    ".[tabsaint.2 ] corrections entering the saint scheme for occupied and unoccupied levels given in ev . [ cols=\"^,^,^\",options=\"header \" , ]     the physical mechanism whereby the conductance of the tilted configuration is higher , is due to the higher hybridization between the molecular orbitals and the electrodes in the tilted configuration .",
    "this increases the width of the transmission resonances and therefore decreases the effect of opening the gap with the saint correction . on the other hand ,",
    "the image charge correction is also larger in the tilted configuration , since the molecule is closer to the surfaces , and therefore the reduction in the opening of the gap is also larger , which means the final gap ends up smaller in the tilted configuration .",
    "the conductance of each case is summarized in fig .",
    "( [ g.saint ] ) .",
    "notice that the saint correction scheme changes qualitatively the physical picture in this junction .",
    "our procedure for the saint correction scheme is as follows .",
    "we first calculate the ionization potential ( ip ) and electron affinity ( ea ) of the molecules in the gas phase .",
    "these gas phase corrections open the dft homo - lumo gap .",
    "however , these bare shifts need to be corrected because of image charge effects .",
    "the final values for the correction shifts are summarized in table ( [ tabsaint.2 ] ) .",
    "notice that the corrections are very similar in magnitude and have opposite signs@xcite .",
    "as noted above , gollum has a simple and flexible input data structure so that model hamiltonians can be utilized easily . as a simple example of a simulation exhibiting kondo and coulomb blockade behavior , we show here results obtained from gollum for a tight - binding single - level anderson model coupled to two semi - infinite chains , that corresponds to taking @xmath377 in eq .",
    "( [ eq : anderson - hamiltonian ] ) . due to the coupling to the two leads",
    ", the correlated level acquires a finite bandwidth @xmath378 where @xmath379 is the density of states in the leads . for vanishing @xmath363",
    "the model is in the so - called atomic limit which is characterized by sharp peaks in the @xmath380-level density of states @xmath381 at @xmath382 and @xmath383 .",
    "this limit corresponds to the coulomb blockade regime in an actual junction where the conductance is strongly suppressed except at the charge degeneracy points .",
    "however , when the coupling to the leads increases ( @xmath363 becomes larger than the temperature @xmath369 , but is still smaller than @xmath233 ) , virtual processes allow the charge and spin in the molecule to fluctuate and a resonance close to the fermi energy appears due to the kondo effect .",
    "this simple model therefore captures relevant physics of molecular junctions such as the appearance of the coulomb blockade effect , and the crossover from the coulomb blockade to the kondo regime as the temperature is lowered below the kondo temperature @xmath384 where the last expression holds in the so - called symmetric limit @xmath385 .",
    "the interpolative impurity solver implemented in gollum provides a good quantitative description of the above phenomena in the weak coupling regime and is also qualitatively correct in the intermediate and strong coupling regimes .",
    "it however overestimates the width of the kondo resonance .",
    "we show in fig .",
    "[ fig : anderson - t ] ( a ) the zero - voltage transmission curve @xmath373 computed with gollum , and using the single - level anderson hamiltonian ( [ eq : anderson - hamiltonian ] ) in the symmetric limit .",
    "we take the following parameters : @xmath386 ev , @xmath387 and @xmath388 so that @xmath389 and @xmath390 , placing the junction in the strong correlation regime .",
    "these parameters yield a kondo temperature @xmath391 .",
    "the figure shows that the interpolative solution provides a transmission curve featuring the lower and upper hubbard bands placed at their correct position and having the right width , together with a sharp kondo resonance at low temperatures which progressively smoothens and eventually disappears as the temperature is raised .",
    "however , the interpolative solution provides a kondo temperature @xmath392 , e.g. : two orders of magnitude larger than the exact one .",
    "we now show the results obtained from gollum for a similar junction , shown in fig .",
    "( [ fig : anderson - molecule ] ) , where a hydrogen atom bridges two gold ( 001 ) electrodes . in this case , the input hamiltonian is generated by the dft code siesta and the leads are repeated periodically in the plane perpendicular to the transport direction , using pl unit cells in ab stacking and @xmath393 atoms in each atomic layer .",
    "we have used a single - zeta basis set and a generalized gradient approximation functional .",
    "we have adjusted the distance @xmath380 between the hydrogen atom and the leads to reproduce a coupling similar to that set for the above anderson model which is achieved with @xmath394  .",
    "the generated transmission curve is shown in fig .",
    "[ fig : anderson - t ] ( b ) for the same three temperatures used for the anderson hamiltonian .",
    "we find that the shape of the transmission curves remains qualitatively the same .",
    "however , both the lower and upper hubbard bands and the kondo resonance are now sharper at their tips .",
    "using gollum , we subsequently apply a gate voltage @xmath395 to the gold - hydrogen - gold junction and compute the low - voltage conductance @xmath324 as a function of @xmath395 to compare the results using plain dft versus dft in combination with the interpolative method .",
    "the results are shown in fig .",
    "( [ fig : anderson - gate ] ) . we have not included the double - counting term to make the comparison between both approaches more explicit .",
    "the figure nicely shows how the interpolative method splits the single dft peak into two coulomb blockade peaks and also a kondo peak .",
    "the figure also shows how the kondo peak disappears at temperatures above @xmath396 leaving only the coulomb blockage features .",
    "finally , we subject the gold - hydrogen - gold junction to the combined effect of finite bias @xmath1 and gate @xmath395 voltages . fig .",
    "( [ fig : anderson - diamond ] ) shows density - contour plots of the low - voltage conductance as a function of @xmath1 and @xmath395 .",
    "this figure demonstrates that gollum can nicely reproduce coulomb blockade diamonds , as well as the kondo line , that disappears as the temperature is raised above @xmath396 .",
    "we demonstrate with two examples how gollum incorporates finite - voltage effects . in the first ,",
    "we have computed the current - voltage characteristics of a gold ( 001 ) junction sandwiching an alkane molecule , that we show in fig .",
    "( [ alkane4 ] ) .",
    "we have computed the zero - bias hamiltonian of the junction using the siesta code , with a double - zeta - polarized basis for all the atoms , and a gga functional .",
    "the pls contain two atomic layers , with @xmath393 atoms each .",
    "we have applied periodic boundary conditions across the plane perpendicular to the transport direction and have computed @xmath397 at the @xmath363 point .    for every given voltage @xmath1 , we modify the em hamiltonian as described in eq .",
    "( [ voltage ] ) .",
    "all the orbitals @xmath26 at the left branch in the em region in fig .",
    "( [ alkane4 ] ) are shifted by @xmath398 , starting at the tpl and stopping at the linking sulfur atom .",
    "similarly , the orbitals at the right branch in the em region are shifted by @xmath399 all , starting at the linking sulfur atom and including those at the tpl .",
    "the current @xmath400 is then computed from the modified hamiltonian @xmath401 .",
    "the resulting @xmath170 curve is shown as a red dashed line in fig .",
    "( [ alkane5 ] ) . for comparison ,",
    "the black line in the same figure shows the @xmath170 curves obtained with a full negf simulation using the code smeagol .",
    "finally , the dot - dashed green line shows the current - voltage curve obtained from gollum by integrating the zero - voltage transmissions obtained from @xmath402 .",
    "the figure demonstrates that our proposed method reproduces rather accurately the features found in the full negf calculation , including the ndr feature at @xmath403 volt , while the plain equilibrium calculation fails to reproduce the gross features of the current - voltage characteristics .",
    "it underestimates the low - voltage conductance by a factor of two .    as a second example",
    ", we have calculated the current - voltage characteristics of a ( 111 ) gold junction sandwiching a porphyrin molecule .",
    "the junction geometry is similar to that shown in fig .",
    "( [ fig : ldau - geometry ] ) .",
    "the sulfur atoms attach to the electrodes at a hollow site .",
    "the porphyrin molecule does not have in the present case a metallic atom at the center , but has two saturating hydrogen atoms instead .",
    "we have performed two series of calculations . in the first",
    ", the geometry and physical gap distance has been relaxed and the calculations have been done at the most stable configuration . in the second , we have pulled the electrodes and sulfur atoms away .",
    "to do so , we have increased the sulfur - molecule distance by 0.3  .",
    "the current - voltage curves are shown in fig .",
    "( [ porphirin ] ) .",
    "these characteristics do not show non - trivial features .",
    "we note again that the plain calculation using zero - voltage transmissions fails to reproduce the negf curve , underestimating the conductance by a factor close to 2 .",
    "in contrast , our prescription provides characteristics that reproduce accurately the negf results .    to understand the difference between the dot - dashed green lines and the finite - voltage results of figs .",
    "( [ alkane5 ] ) and ( [ porphirin ] ) , we have analyzed the evolution of the transmission coefficients @xmath404 as the voltage bias @xmath1 is ramped .",
    "we have found running negf simulations that the main non - equilibrium effect that affects the current for the two junctions above is an energy shift of the molecular homo resonance , that moves up as the voltage is increased .",
    "our prescription not only captures the effect , but also follows accurately the evolution of the resonance shifts dictated by the negf calculation , at least at low voltages . by shifting the homo resonance upwards in energy , a larger weight of",
    "the resonance enters into the energy integration window used to compute the current integral , hence increasing the current .",
    "in contrast , this effect can not be captured at all if one uses the plain @xmath405 transmission coefficients .",
    "( color online ) a junction where a butane - dithiol molecule is sandwiched by ( 001 ) gold electrodes and subjected to a finite bias potential . ]      in this section , we show how gollum can compute the thermoelectric properties of complex junctions formed by trapping a c@xmath406 molecule between gold electrodes . in a previous paper @xcite we have demonstrated both experimentally and theoretically that @xmath407-based nanojunctions show promisingly - high values for the thermopower and figure of merit .",
    "however the temperature dependence of these values and the fluctuations caused by the exact geometrical details have not been thoroughly investigated , partly due to the computationally - expensive nature of the calculations . here",
    "we show that the fast and efficient implementation of gollum allows us to undertake a more complete exploration of the transport properties of these c@xmath406-based junctions .    the systems of interest consist of two ( 111 ) gold leads that can be tilted an angle @xmath21 relative to each other .",
    "each lead is terminated using either a flat surface or a pyramid , as shown in fig .",
    "( [ fig : c60 ] ) .",
    "we have performed dft calculations using the code siesta , with a double - zeta - polarized basis set , and the lda functional@xcite .",
    "we have relaxed the molecular geometries using a force tolerance of 0.02 ev /  and have found the equilibrium distance between the leads and the c@xmath406 molecule to be of about 0.22 nm , depending on the exact orientation of the molecule .",
    "this result is in good agreement with other previously reported distances @xcite .",
    "we have kept this distance fixed in all subsequent transport calculations .",
    "however , we have taken for completeness five possible orientations of the @xmath407 molecule relative to the electrodes .",
    "these are : ( a ) a c - c bond between a hexagon and a pentagon facing the au surface ; ( b ) a hexagon facing the au surface ; ( c ) a pentagon facing the au surface ; ( d ) a bond between two hexagons facing the au surface ; and ( e ) a single atom facing the au surface .",
    "we have also tilted one of the electrodes in steps of 15 degrees between 0 and 60 degrees to see the interference effects caused by the exact position of the tip on the surface of the fullerene , recalculating the thermoelectric properties at each step . the starting position ( for @xmath408 ) for the c@xmath406 against the electrodes is such that one of its pentagons is facing the au surfaces",
    ".     molecule .",
    "the electrodes are terminated as either a flat surface ( upper panel ) or a pyramid ( lower panel ) , and can be tilted an angle @xmath21 relative to each other . ]    ) having flat or pyramid - terminated electrodes ; @xmath21 is the rotation angle . figs .",
    "( a)-(b)-(c)-(d ) show two - dimensional contour plots of the conductance @xmath324 ( measured in units of @xmath325 ) , the thermopower @xmath409 ( measured in @xmath410 ) , the thermal conductance @xmath411 ( measured in nw / k ) , and the figure of merit @xmath412 ( dimensionless ) .",
    "the vertical and horizontal axes are the temperature t measured in kelvin and the tilting angle @xmath21 for flat - electrode junctions",
    "( e)-(f)-(g)-(h ) show the same magnitudes for pyramid - terminated electrodes .",
    "note that the color code is different for each figure . ]",
    "the results of our calculations are shown in figure ( [ fig : c60 - 1 ] ) . by taking horizontal cuts through these surfaces",
    ", we can see clear evidence of quantum interference as the angle changes and the tip is repositioned around the fullerene surface . for the conductance @xmath324 , these oscillations are almost temperature independent , whereas in the case of the thermopower @xmath409 , the thermal conductance @xmath411 and the electronic figure of merit zt , these oscillations are almost negligible at low temperatures and then grow with @xmath369 . comparing the conductance obtained with flat electrodes against that with pyramid - terminated electrodes , we can clearly see that @xmath324 decreases substantially when using the pyramid - like electrodes , in agreement with ref .",
    "furthermore in the case of flat electrodes the conductance fluctuates with the angle @xmath21 by about half an order of magnitude , whereas for the pyramid - terminated electrodes we find a larger change of almost one order of magnitude .",
    "this again demonstrates that the pyramid - terminated electrode scans the molecular surface like an stm tip , with improved detail , while part of these features are blurred when using a flat electrode .",
    "the flat - electrode junctions possess conductances values of about 0.6 - 1.2 @xmath413 , while junctions with pyramid tips have conductances of order 0.015 - 0.15 @xmath413 .",
    "we overestimate the experimental values for @xmath324 @xcite , by about one order of magnitude , a known problem associated with the underestimation of the homo - lumo gap inherent to the plain dft approach . as expected , the thermopower @xmath409 is more sensitive to the angle @xmath21 when using pyramid - terminated junctions compared with the case of flat - surfaced junctions .",
    "interestingly , @xmath409 is quite high especially at the higher temperatures , achieving values of of about @xmath414 to @xmath415 .      ab - initio force - relaxation simulations show that it is possible to sculpt complex three - dimensional structures of nanoscale - scale dimensions by cutting shapes into a graphene bilayer @xcite .",
    "we find that the edges of the two graphene sheets coalesce in order to saturate dangling bonds and to maximize the degree of @xmath416 hybridization .",
    "for example , by cutting a cross shape in a bilayer graphene sheet , the resulting sculpturene is the three - dimensional crossbar carbon nanotube ( cnt ) shown in fig .",
    "( [ fig : four - probe - cnt ] ) , which is an example of a four - terminal electronic device .",
    "this four - terminal device is composed of two armchair and two zigzag cnt electrodes .",
    "these become perfectly periodic cnt leads ( shown with blue ) far enough from the junction . to perform a gollum - based four - terminal calculation , we obtain the mean - field hamiltonian of this structure using the siesta code , with a double - zeta - polarized basis set and a gga functional@xcite .",
    "we start with the referred cross - shaped bilayer graphene sheet and after relaxing the inter - atomic forces to tolerances below 0.02 ev /  , we find the crossbar shaped device shown in figure ( [ fig : four - probe - cnt ] ) .",
    "we feed the resulting ab - initio hamiltonian into gollum , and compute the transmission coefficients @xmath417 between every possible combination of pairs of leads .",
    "notice that the armchair cnt leads are semiconducting , while the zigzag cnts are metallic .",
    "we therefore expect different qualitative behaviors for the transmission properties among the different arms .",
    "this is shown in fig .",
    "( [ fig : t-12 - 34 ] ) , where the transmission coefficients between the two armchair arms @xmath418 are much smaller than those connecting the zigzag arms @xmath419 .",
    "in addition , the figure indicates that the central cross area , where the two arms join together is not transparent , but introduces strong scattering .",
    "similarly , the transmission from lead 1 to lead 3 also shows a reduced transmission at low energies due to the semiconducting behavior of the armchair lead 1 , see fig ( [ fig : t-12 - 34 ] ) .",
    "this figure shows that @xmath420 due to the junction symmetry .",
    "and leads 3 and 4 @xmath419 ( solid black and dashed red lines respectively ) .",
    "energies are measured in ev and referred to the fermi energy of the scattering region . ]    , solid black line ) and between lead 1 and lead 3 ( @xmath421 , dashed red line ) .",
    "energies are measured in ev and referred to the fermi energy of the scattering region . ]      in the literature , most theoretical analyses of phase - coherent transport properties assume that the junction is immersed in vacuum and therefore ignore the effects of the surrounding environment .",
    "in contrast , many experiments are carried out under ambient conditions , which can have a marked effect on transport properties@xcite .",
    "if surrounding environmental molecules possess a dipole moment , then the scattering region will be subject to a fluctuating electrostatic field .",
    "previous work to investigate the impact of environmental water on the transport properties of a a single - molecule junction@xcite also took into account the effect of a solvation shell of water molecules surrounding the junction .",
    "gollum describes these effects systematically , by noting that for nanostructures such as single - molecule junctions , the timescale for such fluctuations is typically longer than the time taken for an electron to pass through the device and therefore one can adopt the born - oppenheimer approximation and freeze the environment during each electron transit . however , successive electrons experience different environmental snapshots and therefore are subjected to different instantaneous mean field hamiltonians leading to different instantaneous conductances",
    ". the measured ( time - averaged ) electrical conductance will hence be an ensemble average over these snapshots . to obtain a series of environmental snapshots",
    ", gollum uses classical molecular dynamics to describe the environmental molecules and for each snapshot , feeds the resulting geometries into a dft code to compute the corresponding self - consistent hamiltonian .",
    "the resulting mean field hamiltonian is then used to compute the scattering matrix and related transport properties .        ) for 100 snapshots . ]    to illustrate this approach , we compute here the ensemble averaged conductance of the junction shown in fig .",
    "( [ fig : solvent - molecule ] ) , where two pi - stacked monothiol terminated oligophenyleneethynylenes form a bridge between two gold ( 001 ) electrodes .",
    "the bridging molecule is surrounded by two different solvents : decane and 1,4-dioxane,1,2,4-trichlorobenzene ( tcb ) .",
    "an example of a junction surrounded by a shell of tcb molecules is shown in the lower panel of fig .",
    "( [ fig : solvent - molecule ] ) .",
    "we have tested here the classical molecular dynamics packages lammps@xcite and dlpoly@xcite , but gollum is flexible enough to accept coordinates from other classical molecular dynamics packages . in what follows ,",
    "we show results obtained with lammps , where we have used the dreiding force field to describe the intra- and inter - molecular interactions and have employed the reaxff forcefield to obtain the initial charges .",
    "to create the environment , we place two hundred solvent molecules surrounding the backbone molecule .",
    "we perform the simulations using a constant temperature and volume ( nvt ) ensemble and subsequently a constant temperature and pressure ( npt ) thermostat .",
    "we equilibrate the junction for 150 ps with 0.1 fs time steps continuously raising the temperature to 290 k. we do not include the gold electrodes in the molecular dynamics simulation , so to simulate the binding of the anchor groups , we hold the positions of the two terminating atoms which connect to the electrodes fixed .",
    "we record between 350 and 500 snapshots of the junction , that have been taken every 2ps . for each snapshot",
    ", we feed the atomic coordinates into the dft code siesta and generate the dft hamiltonian .",
    "we then feed the hamiltonians into the transport code to compute the electrical conductance .",
    "some example transmission curves for 100 snapshots of the junction with a tcb solvent are shown in the right panel in fig .",
    "( [ fig : solvent - molecule ] ) .",
    "we note that the the room - temperature dynamics of the atoms at the junction lead to a large spread in the transmission curves , and therefore to many different values of the low - voltage conductance .",
    "we therefore assemble conductance histograms to help identify the most probable conductance values .",
    "the resulting histograms in the presence of decane and tcb solvents are shown in fig .",
    "( [ fig : solvent - histogram ] ) .",
    "the fact that the most probable conductance values are different shows that ambient - conditions or liquid - immersed molecular electronics experiments are affected by the surrounding solvent .",
    "notice that in these simulations we kept fixed the molecule - electrode geometry , so the spread in @xmath324 is due entirely to environmental effects .    ) for two different solvents : decane ( left ) and tcb ( right ) . ]",
    "the fact that the transport properties of nanoscale junctions depends on the surrounding environment leads to a wide range of possible sensing applications . in this section ,",
    "we demonstrate the versatility of gollum by showing how it can be used to predict the change in conductance of a nanopore , when a single dna strand is trans - located through it .",
    "deoxyribonucleic acid ( dna ) is a molecule that encodes the genetic instructions used in the development and functioning of all known living organisms and many viruses .",
    "dna molecules are double - stranded helices , consisting of two long biopolymers composed of simpler units called nucleotides .",
    "each nucleotide is composed of one of the four nucleobases guanine ( g ) , adenine ( a ) , thymine ( t ) and cytosine ( c ) , which are attached to a backbone made of alternating sugar and phosphate groups .",
    "the two polymer strands are bound together by non - covalent bonds that link base pairs and are easily separated to form two single - stranded dna molecules ( ssdna ) molecules .",
    "dna sequencing aims at identifying the sequence of the dna bases in a sample of ssdna .",
    "many researchers are actively seeking new methods to sequence dna with improved reliability and scalability and that are economically viable .",
    "biological nanopores made from protein such as a - hemolysin have been shown experimentally to sense the presence of dna @xcite , but are also very sensitive to temperature and ph , and can only be used within a limited voltage bias window@xcite . as an alternative , solid state devices which can be integrated into existing semiconducting circuitry technology and",
    "that are robust to the chemical environment have been proposed as sensors @xcite .            to demonstrate the versatility of gollum",
    ", we examine here the potential for dna nucleobase sensing of the sculpturene device shown in fig .",
    "( [ fig : ttht ] ) , which comprises a torus - like nanopore connected to two cnt electrodes@xcite .",
    "the torus in the figure has an inner pore with a diameter of 1.6 nm , whereas the leads are two ( 6,6 ) armchair nanotubes having a diameter of about 5  .",
    "we have selected for our study six short strands of ssdna containing three bases , that are shown in fig .",
    "( [ fig : base - sequences ] ) .",
    "we have first relaxed the coordinates of the nucleotides that are threading the pore , using the dft code siesta with a double - zeta basis set and a lda functional@xcite .",
    "since the pore diameter is slightly larger than the strand width , the strand and its nucleotides can adopt different conformations and orientations inside the pore .",
    "we accumulate snapshots of these different conformations and orientations for each of the six ssdna strands as they trans - locate the pore . for each snapshot , we compute the current - voltage curve and subtract the current for the empty pore @xmath422 .",
    "the current averaged over snapshots @xmath423 for each ssdna strand is plotted in fig .",
    "( [ fig : ivcurves - sequences ] ) .",
    "the sizable height of the curves demonstrate that the conductance of the pore is sensitive to the gating effect produced by the presence of ssdna strands inside the pore .",
    "furthermore , the different behavior of the curves means that , armed with a proper statistical analysis , the sculpturene device can distinguish different nucleotide sequences , so that this kind of device could be utilized potentially as a discriminating dna sensor .",
    "curves for each of the six sequences shown in fig .",
    "( [ fig : base - sequences ] ) , where the current has been averaged over different pore - nucleotide relative angles and the current of the empty pore has been subtracted . ]      a large body of experiments in single - molecule electronics is performed using the mechanically - controlled break junction ( mcbj ) technique , in which a metallic strip is pulled slowly until it breaks into two separate pieces .",
    "this process enables the formation of electrodes with molecular - scale gaps , which can be bridged by a single molecule .",
    "experimentally , these two electrodes are repeatedly pulled away or pushed towards each other . by applying a small bias voltage and recording the current passing through the junction",
    ", the low - voltage conductance can be measured as a function of the distance between the electrodes . when the distance is small enough",
    ", a single molecule can bridge the gap between the electrodes and its conductance can be measured . in the literature ,",
    "most theoretical studies are confined to small numbers of ideal geometries and binding configurations . in this section ,",
    "our aim is to demonstrate that the versatility of gollum allows us to compute whole pulling curves of conductance versus electrode separation .        the single - molecule junction that we discuss here",
    "is shown in fig .",
    "( [ fig : pulling - example ] ) and consists of gold ( 111 ) electrodes . the electrodes in the simulation are terminated by pyramids and bridged by a bipyridine molecule .",
    "to simulate a stretching process we have created one hundred geometries of the junction , each with a different distance @xmath380 between the center of the end atoms of the two leads . to optimize the atomic arrangement of each of the hundred geometries",
    ", we start from an idealized setup consisting of the two pyramids surrounded by vacuum ( e.g. : not attached to the gold leads ) .",
    "we place the molecule slightly shifted to one side to break the symmetry and keep an au - n bond - length of about 2  .",
    "we then relax the inter - atomic forces with the siesta code using a gga functional@xcite and a double - zeta - polarized basis set until each individual force is smaller than 0.02 ev /  .",
    "we keep fixed the atomic positions of the bottom two layers of the pyramids during this geometry optimization .",
    "( [ fig : pulling - geometries ] ) shows four of the hundred relaxed configurations achieved .    ) for four different distances @xmath380 . ]",
    "we then reattach the crystalline gold leads , and impose periodic boundary conditions along the plane perpendicular to the transport direction .",
    "we use a sz basis for the gold atoms of the leads , together with a simplified pseudo - potential , where only the 6s channel is included to speed up the simulations .",
    "however , we use a double - zeta - polarized basis set for the atoms at the gold pyramids and in the molecule .",
    "siesta then creates the hamiltonian of each of the hundred junctions that we feed into gollum .",
    "figure ( [ fig : pulling - curve ] ) shows the low - voltage conductance @xmath324 versus the electrode separation @xmath380 .",
    "this pulling curve shows that during the pulling process the conductance possesses a plateau , in agreement with many experiments using mcbjs .",
    "this simulation also reveals that the aromatic rings contact directly the gold surface , therefore increasing the molecule - gold coupling and the molecular conductance .    ) .",
    "@xmath324 is measured in units of @xmath325 and plotted as a function of the distance @xmath380 .",
    "each of the conductance points displayed correspond to one of the hundred relaxed configurations of the mcbj simulation .",
    "the figure also shows the four different distances @xmath380 corresponding to the relaxed geometries displayed in fig .",
    "( [ fig : pulling - geometries ] ) . ]",
    "so far , all calculated quantities have been obtained from the modulus squared of the scattering matrix elements . to demonstrate that gollum also provides information about transport properties associated with the phases of the scattering matrix",
    ", we now examine an example of a quantum pump .",
    "quantum pumps are time - dependent electron scatterers , which are able to transport electrons between two external reservoirs subjected to the same chemical potential .",
    "the pump process is adiabatic if the frequency of the pump cycle is smaller than the inverse of the characteristic timescale of the scatterer , the wigner delay time@xcite .",
    "experimental @xcite and theoretical @xcite studies of adiabatic quantum pumps have examined the conditions for optimal pumping and the effects of noise and dissipation .",
    "adiabatic pumping can be understood in terms of the parametric derivative of the full scattering matrix @xmath409 at fixed chemical potential @xcite .",
    "an adiabatically - slowly time - varying scatterer connected by ideal channels to external reservoirs , produces a current @xmath424 pumped into the @xmath110th channel , where @xmath425 is the energy shift matrix defined by @xmath426 with @xmath409 being the full scattering matrix and @xmath427 the fermi energy .",
    "pumping can occur if the @xmath428-matrix depends on time through a parameter @xmath429 .",
    "hence currents can be expressed in terms of parametric derivatives @xmath430 where @xmath431 is the parametric current entering channel @xmath110 .",
    "since gollum gives us access to the full scattering matrix @xmath432 , it offers the possibility of investigating adiabatic pumping in nanostructures .",
    "we demonstrate this capability by calculating the charge pumped in a double - walled carbon nanotube nano - electromechanical device shown in fig .",
    "( [ fig : shuttle ] ) @xcite , that mimics the experimental setup of ref .",
    "( ) . since an electron current travelling along the inner tube can cause a chiral outer tube to rotate @xcite , the quantum pump shown in fig .",
    "( [ fig : shuttle ] ) represents the inverse effect , in which rotation of the outer tube causes a current to flow along the inner tube .",
    "the position and orientation of the inner tube is kept fixed , while the shorter outer tube rotates slowly .",
    "the angle @xmath433 describes the real space rotation angle of the outer tube and also plays the role of the pumping parameter in this system .",
    " surrounds concentrically an inner tube , with an inter - layer spacing @xmath434   corresponding to the van der waals distance . the inner wall remains fixed , while the outer tube is rotated about the tube axis by the angle @xmath433 . a slow variation of @xmath433 results in a parametric current @xmath435 .",
    "finite charge can be pumped in one rotational cycle depending on the chiralities of the constituent tubes . ]    to reveal the rich behavior of this family of quantum pumps , fig .",
    "( [ fig : paremplot ] ) shows the parametric current , as a function of the rotational angle @xmath433 for a typical device .",
    "depending on the particular angle , charge may be pumped either from left to right or vice versa .",
    "the integral of this parametric emissivity within a full parametric cycle of @xmath436 is the number of electrons pumped per cycle .     for a device consisting of a ( 5,5 )",
    "carbon nanotube surrounded by a ( 14,6 ) outer nanotube .",
    "the outer tube rotates slowly around the inner one .",
    "the contour plot shows the current as a function of the rotational angle @xmath433 measured in degrees and the fermi energy @xmath427 measured in units of the hopping integral @xmath307 between carbon atoms .",
    "the orange color indicates charge being pumped from left to right and vice versa . ]    in fig .",
    "( [ fig:14 - 6plot ] ) we show the charge pumped in a ( 5,5 ) carbon nanotube with a ( 14,6 ) outer nanotube rotating slowly about it .",
    "the average pumped charge clearly drops by several orders of magnitude as the fermi energy is increased from zero .",
    "therefore for a most efficient pumping , the fermi energy should be close to the dirac point .",
    "note however , that the pumped charge could again increase if the fermi level is large enough to open another channel . beyond this average behavior",
    ", there exist numerous sharp peaks in the pumped charge .",
    "the location of these peaks correlates with fabry - perot resonances in the reflection coefficient .",
    "this suggests that the largest pumping occurs at those resonances . in other words ,",
    "when the transmission is high , pumping is low , and vice versa .     through the device discussed in fig .",
    "( [ fig : paremplot ] ) as a function of the fermi energy measured in units of the hopping integral @xmath307 between carbon atoms at the cnts .",
    "the green solid line shows the charge pumped towards the left ; the red solid line shown the charge pumped towards the right . at certain energies ,",
    "the pumped charge is very high .",
    "these peaks correlate with the fabry - perot resonances in the reflection coefficient @xmath238 .",
    "@xmath238 is shown as a solid blue line . ]      finally , to demonstrate that gollum can handle the disordered systems , we calculate the ensemble - averaged conductivity @xmath12 of a two - terminal system on a square lattice , with leads attached to a disordered scattering region as shown in fig .",
    "( [ fig : bd1 ] ) .",
    "the width of the system is @xmath437 unit cells and the length is varied between @xmath438 to @xmath439 unit cells .",
    "the conductivity is defined as @xmath440 , where @xmath441 is the transmission from the left lead to right lead evaluated at the fermi energy , @xmath442 ev .",
    "the tight - binding hamiltonian of the system has a single orbital per site , with nearest neighbour couplings . @xmath443",
    "the site energies within the leads are @xmath444 ev , while the random site energies within the scattering region are uniformly distributed over the interval @xmath445 $ ] ev .        figure ( [ fig : bd2 ] ) shows the the ensemble - averaged conductivity ( @xmath12 ) and transmission coefficient ( @xmath376 ) for the system shown in fig .",
    "( [ fig : bd1 ] ) .",
    "it contains three regions . within the ballistic regime between @xmath446 and approximately @xmath447 ,",
    "the conductivity increases linearly with length . in the diffusive region ( @xmath448 )",
    ", the conductivity exhibits ohmic behavior and is almost independent of length . finally for @xmath291",
    "greater than 100 , there is a cross over to the anderson localized regime .",
    "and transmission coefficient @xmath376 as a function of the number @xmath291 of unit cells in the transport direction , for the two probe square lattice shown in the previous figure .",
    "]      we end this article by showing how the spin - orbit interaction induces gaps at certain band crossings in the one - dimensional electronic structure of infinite nickel chains .",
    "these gaps may appear or not depending on the orientation of the atomic spins relative to the axis of the chain .",
    "they lead to dips in the transmission coefficient @xmath373 of the chain at the gap energies .",
    "we have simulated linear nickel chains using the dft program siesta .",
    "the chains have a single atom per unit cell and are oriented along the z - axis .",
    "we have used a standard set of pseudopotential parameters , a double - zeta basis set and simple lda for the exchange - correlation potential .",
    "we have checked that the electronic structure and @xmath373 are the same for any spin orientation if the spin - orbit interaction is set to zero , as is should due rotational invariance . however",
    ", if the spin - orbit interaction is switched on , then a finite yet small magnetic anisotropy barrier appears .",
    "we have found that if we choose the atomic spins to lie along the chain axis , then there are no spin - orbit gaps close to the fermi energy . as a consequence ,",
    "the transmission coefficients with and without the spin - orbit interaction are indistinguishable from each other ( as shown in fig .",
    "( [ fig : ni - chain - so ] ) ) .",
    "in contrast , when the atomic spins are oriented in a plane perpendicular to the chain axis , then several small gaps open around the fermi energy . these gaps are seen as dips in fig .",
    "( [ fig : ni - chain - so ] ) .",
    "we have developed a new quantum transport code , which is fast , easy to use and versatile .",
    "this flexibility has been demonstrated by presenting a wide range of example calculations , encompassing charge , spin and thermal transport , corrections to density functional theory such as lda+u and spectral adjustments , transport in the presence of non - collinear magnetism , the quantum - hall effect , kondo and coulomb blockade effects , finite - voltage transport , multi - terminal transport , quantum pumps , superconducting nanostructures , environmental effects and pulling curves and conductance histograms for mechanically - controlled - break - junction experiments .",
    "further developments are in the pipeline , including the incorporation of phonon transport .",
    "gollum will soon be freely available from the following web site _",
    "http://www.physics.lancs.ac.uk/gollum _ and the authors of this article are available to help potential users access the code .",
    "the research presented here was funded by the spanish ministerio de economa y competitividad through the grant fis2012 - 34858 , by the uk epsrc and by the european commission fp7 itn `` molesco '' project no .",
    "606728 vmgs thanks the spanish ministerio de economa y competitividad for a ramn y cajal fellowship ( ryc-2010 - 06053 ) .",
    "lo has been supported by the hungarian scientic research fund no .",
    "jf wishes to thank useful discussions with n. lorente and a. kormanyos .",
    "we have described in section ii.a.2 the method employed by gollum to find the surface green s function @xmath259 of each lead . however , the solution of eq .",
    "( [ gep ] ) gives with some frequency numerical inaccuracies which render the method useless as it stands .",
    "these inaccuracies are caused by the highly non - singular behavior of the hamiltonian matrix @xmath27 connecting adjacent pls .",
    "we discuss here the adaptation of the method described in refs .",
    "( ) that gollum uses to regularize @xmath27 . mathematically , we perform an svd decomposition of this @xmath42 matrix , @xmath449 where @xmath233 and @xmath1 are unitary matrix and @xmath409 is a diagonal matrix containing the eigenvalues @xmath450 of @xmath27 . numerical algorithms usually arrange them in descending order .",
    "the condition number of @xmath27 is defined as the ratio @xmath451 between the maximum and minimum eigenvalues of @xmath27 .",
    "@xmath411 determines how singular is @xmath452 and therefore the propensity to suffer inaccuracies when handling @xmath27 .",
    "small eigenvalues @xmath450 appear whenever @xmath27 is very sparse .",
    "physically , this is originated for example if the pl are very long so that a large fraction of hopping integrals ( matrix elements of @xmath27 ) is zero . our first procedure to regularize @xmath27 consists in adding a real or complex random matrix to @xmath27 .",
    "we have found that this is frequently enough to render a regular @xmath27 matrix .",
    "if this first procedure fails this is because the orbitals involved do not play a role in the transport properties of the lead and should be decimated out , so that the dimensions of the @xmath453 matrix are reduced .",
    "notice that reducing the dimensions of @xmath27 has the advantage that the computation of the surface green s function @xmath259 is much lighter .",
    "however , the procedure must be performed with some care as finally @xmath259 must connect with the corresponding tpl of the em branch , whose matrices have dimensions @xmath42 . explicitly , we write the schroedinger equation of the infinite chain of the corresponding lead : @xmath454 where @xmath455 , @xmath26 labels the pl and runs from @xmath456 to @xmath457 and we assume that the chain will be chopped off at the @xmath458 pl and then connected to the tpl of the em .",
    "we first perform the svd decomposition of @xmath27 described in eq .",
    "( [ svd ] ) .",
    "we then set to zero all eigenvalues smaller than a given tolerance @xmath459 .",
    "we have checked that setting @xmath460 provides unproblematic @xmath27 and @xmath461 .",
    "let us assume that we set to zero @xmath462 eigenvalues of @xmath27 , so that @xmath463 remain non - zero .",
    "we now construct the matrices @xmath464 we transform eq .",
    "( [ lead - equation ] ) for all sites up to site @xmath465 as follows :          this set of equations generates the new hamiltonians of each lead , and connects it with the extended molecule .",
    "overlap matrices must also be decimated as they enter into the expression for the group velocity , eq .",
    "( [ group - velocity ] ) .",
    "the denominator in this equation looks like @xmath471 where we have applied the svd transformation to the overlap matrices @xmath472"
  ],
  "abstract_text": [
    "<S> we have developed an efficient simulation tool gollum for the computation of electrical , spin and thermal transport characteristics of complex nanostructures . the new multi - scale , multi - terminal tool addresses a number of new challenges and functionalities that have emerged in nanoscale - scale transport over the past few years . to illustrate the flexibility and functionality of gollum , we present a range of demonstrator calculations encompassing charge , spin and thermal transport , corrections to density functional theory such as lda+u and spectral adjustments , transport in the presence of non - collinear magnetism , the quantum - hall effect , kondo and coulomb blockade effects , finite - voltage transport , multi - terminal transport , quantum pumps , superconducting nanostructures , environmental effects and pulling curves and conductance histograms for mechanically - controlled - break - junction experiments .    </S>",
    "<S> = 1 </S>"
  ]
}