{
  "article_text": [
    "the ability to perform quantum error correction ( qec ) by feedback is a crucial step towards fault - tolerant quantum computation @xcite .",
    "an open challenge , that has drawn considerable interest recently@xcite , is to find the best strategy for this task .",
    "two nominally distinct feedback strategies for qec are the measurement - based and driven - dissipative approaches .",
    "the former has been more well - understood@xcite , owing to an existing foundation in classical control and feedback in engineering . in the measurement - based ( mb ) approach ,",
    "a classical controller performs projective measurements of a set of multi - qubit stabilizer operators that encode the logical qubit@xcite in order to track errors and/or perform any necessary correction .",
    "thus for good performance , this approach requires both high - fidelity projective measurements and low - latency control electronics to process the measurement result within the relevant coherence times of the quantum system .",
    "the elements required for this mb strategy have been demonstrated for small quantum systems on various physical platforms such as rydberg atoms@xcite , trapped ions@xcite , photons@xcite , spin@xcite and superconducting qubits@xcite . however , a steady - state multi - qubit qec capability has yet to be achieved and one of the key questions for this development is whether the mb strategy is scalable to larger systems or whether an alternative approach is more optimal .",
    "one such alternative , driven - dissipative ( dd ) schemes@xcite , also called reservoir / bath engineering or coherent feedback ( as discussed below ) , utilizes coupling between the quantum system of interest and a dissipative environment to transfer the entropy caused by decoherence - induced errors out of the quantum system .",
    "they have been demonstrated on a variety of physical systems including atomic ensembles@xcite , trapped ions@xcite , mechanical resonators@xcite and superconducting qubits@xcite .",
    "moreover , experiments with trapped ions@xcite and superconducting qubits@xcite have demonstrated some of the basic elements of autonomous qec .",
    "these schemes do not require high - fidelity projective measurements , external control and its associated latency .",
    "they can also be described as autonomous or coherent feedback@xcite , where the reservoir coupled to the target quantum system can be considered as an effective `` quantum controller '' that reacts with quantum degrees of freedom@xcite . adjusting the feedback by changing the `` quantum controller '' , however , can be more challenging than re - programming a classical controller , built with conventional electronics .",
    "thus , a further question is whether one can combine this dd approach and the conventional mb approach with minimal negative consequences from their respective drawbacks .",
    "here we report an experiment in which we built a feedback platform utilizing a nearly quantum - limited measurement chain and a customized field - programmable gate array ( fpga ) system to perform mb and dd schemes within the same setup .",
    "the task of this platform was to stabilize an entangled bell state of two superconducting transmon qubits@xcite .",
    "this particular task of stabilizing a single state is a proxy for more general qec experiments where a manifold of states is protected .",
    "we realize , for the first time , an mb _ stabilization _ of a bell state by repeated active correction through conditional parity measurements@xcite .",
    "we compare this scheme to a dd entanglement stabilization scheme@xcite in which the conditional parity switch is autonomous . by performing both schemes on the same hardware setup and circuit qed ( cqed ) system@xcite",
    ", we shed light on their close connection and compare them on a level playing field .",
    "previous theoretical works have compared dd ( under the name of `` coherent feedback '' ) and mb for linear quantum control problems@xcite , such as for minimizing the time required for qubit state purification@xcite or for cooling a quantum oscillator@xcite .",
    "these comparisons showed coherent feedback to be significantly superior . in our particular setup , we find that distinguishing the superior approach among dd and mb is a more subtle task .",
    "the subtlety is two - fold .",
    "first , the performance difference depends on which process can be better optimized : the design of the cqed hamiltonian or the efficiency of quantum measurement and classical control . in the current experiment , we show that dd has better steady - state performance as the cqed hamiltonian parameters are engineered such that dd has a shorter feedback latency .",
    "but dd s advantage over mb is not immutable . as certain experimental parameters",
    "are improved , such as coherence times and measurement efficiency , mb s performance can catch up with dd .",
    "secondly , in the current situation in which neither the cqed hamiltonian parameters nor the measurement and control parameters are ideal , we can obtain a boosted performance by combining dd and mb to get the best of both worlds .",
    "we explored this by devising a heralding method to improve the performance of both stabilization approaches .",
    "this protocol exploits the high - fidelity measurement capability and the programmability of the feedback platform .",
    "the protocol is termed `` nested feedback '' since it has an inner feedback loop based on either the dd or mb scheme , and an outer loop that heralds the presence of a high - fidelity entangled state in real - time .",
    "previously , heralding schemes have been demonstrated for state preparation to combat photon loss or decoherence@xcite . extending such heralding capability to state stabilization will be a valuable addition to the qec toolbox .",
    "furthermore , the ability to herald in real time as opposed to post - selection is important for on - demand and deterministic quantum information processing since only successful events lead to subsequent processing .",
    "real - time heralding for entanglement stabilization is particularly challenging for superconducting qubits due to their shorter coherence times compared to other systems . in this article , we implement this real - time heralding capability on a time scale faster than the few microsecond coherence time of our qubit - cavity system . by extending the feedback platform developed primary for the mb approach to the dd approach ,",
    "our results bring to light a new application of mb . adding a level of mb feedback can significantly improve performance beyond what a single layer of feedback , whether dd or mb , can achieve .",
    "the simplified schematic of our experimental setup is shown in fig .  [",
    "fig : schematic]a .",
    "two transmon qubits@xcite , alice and bob , are dispersively coupled to a three - dimensional aluminum cavity @xcite , with linewidth @xmath0  mhz ( see supp",
    "i , for other parameters ) .",
    "the qubit - cavity dispersive shifts are nearly equal and in the strong dispersive regime ( @xmath1  mhz , @xmath2  mhz ) with photon - number resolved qubit transition frequencies@xcite .",
    "the cavity output is amplified by a josephson parametric converter ( jpc ) operated as a nearly quantum - limited phase - preserving amplifier @xcite enabling rapid , single - shot readout@xcite and thus real - time feedback .",
    "the key component of the experiment is a controller realized with two fpga boards that both measure and actively control the cavity - qubit system .",
    "an essential operation for our experiment is a two - qubit joint quasi - parity measurement using the common readout cavity @xcite . as shown in fig .",
    "[ fig : schematic]b , the cavity is driven at @xmath3 ( both qubits in ground state ) and at @xmath4 ( both in the excited state ) at the same time .",
    "the output at @xmath3 and @xmath4 together distinguishes the even parity manifold @xmath5 from the odd parity manifold @xmath6 .",
    "when the two cavity output responses _ both _ have an amplitude below a certain threshold , the qubits are declared to be in odd parity ; when either one has amplitude above the threshold , the qubits are declared to be in even parity .",
    "we note that , unlike a true parity measurement , this readout actually distinguishes the two even parity states @xmath7 and @xmath8 , hence we refer to it as a `` quasi '' parity measurement .",
    "however , the feedback schemes described below apply the same operation on both even states , and thus we need only record the parity of the measured state .",
    "the choice of driving at the `` even '' cavity resonances rather than between the `` odd '' resonances ( @xmath9 and @xmath10 ) mitigates the effect of the @xmath11 mismatch , reducing associated measurement - induced dephasing of the odd manifold@xcite .",
    "the controller fpga a ( b ) modulates the @xmath3 ( @xmath4 ) drive to the cavity and also demodulates the response .",
    "the two fpgas share their measurements of the cavity response to jointly determine the parity .",
    "in addition , fpga a and b generate the qubit pulses to alice and bob , respectively , which are conditioned on the joint state estimation during real - time feedback .",
    "we first briefly outline the dd stabilization of entanglement , described in detail in ref .   and .",
    "this stabilization targets the two - qubit bell state @xmath12 .",
    "figure  [ fig : comparison]a displays the states coupled by the autonomous feedback loop .",
    "two rabi drives on alice and bob at their zero - photon qubit frequencies ( @xmath13 and @xmath14 , see supp . mat . sec .",
    "i ) couple the wrong bell state @xmath15 to the even states , @xmath7 , @xmath8 , in the energy manifold with zero cavity photons . a second pair of rabi drives at the @xmath16-photon qubit frequencies ( @xmath17 and @xmath18 , @xmath19 ) , with their relative phase opposite to the first pair , couple @xmath20 , @xmath21 to the bell state @xmath22 .",
    "the two cavity drives , at @xmath3 and @xmath4 connect the two manifolds and hence the combined action of the six drives transfers the population from @xmath7 , @xmath8 and @xmath23 to @xmath22 .",
    "finally , cavity photon decay brings @xmath22 back to @xmath24 . in effect",
    ", the cavity drives separate qubit states based on their parity , allowing one pair of rabi drives to move the erroneous odd population to the even states while the other pair transfers the even states population to @xmath25 .",
    "counterparts to these elements of the dd feedback loop can be found in the corresponding mb feedback scheme .",
    "the action of our mb algorithm is shown as a state machine in fig .",
    "[ fig : comparison ] .",
    "we describe the quasi - parity measurement @xmath26 by the projectors @xmath27 , @xmath28 and @xmath29 . we assign the outcomes @xmath30 to the even projectors , @xmath31 and @xmath32 and @xmath33 to @xmath34 .",
    "the mb algorithm is built with a sequence of correction steps , each of which consists of a conditional unitary and a quasi - parity measurement .",
    "the two possible states of the state machine correspond to whether we apply the unitary @xmath35 or @xmath36 , followed by the quasi - parity measurement .",
    "specifically , @xmath37 where a ( b ) denotes alice ( bob ) , and @xmath38 . in a correction step @xmath39 ,",
    "the qubits are initially in either @xmath7 , @xmath8 or in the odd manifold , due to the projective quasi - parity measurement in step @xmath40 ; the controller then applies @xmath35 ( @xmath36 ) if @xmath41 in previous step reported @xmath42 ( @xmath43 ) .",
    "the effect of the state machine on the two - qubit states is shown in tab .",
    "[ tabu : mb ] , where the action of the controller during one correction step is described in terms of the four basis states , @xmath25 , @xmath15 , @xmath7 and @xmath8 ( the latter two are grouped in the `` even '' column ) .",
    "the quasi - parity measurement infidelity , labeled by @xmath44 ( @xmath45 ) , gives the error probability of obtaining an even ( odd ) parity outcome after generating an odd ( even ) state . because these measurement infidelities are small",
    ", the dominant events are those that occur without measurement errors . at each step ,",
    "@xmath35 on either @xmath7 or @xmath8 followed by the quasi - parity measurement @xmath26 transfers the states to @xmath46 with 50% probability . since @xmath25 is an eigenstate of @xmath36 and @xmath26 ( modulo a deterministic phase shift that can be undone , see later discussion )",
    ", these operations leave it unaffected . on the other hand , @xmath36 and @xmath26",
    "transform @xmath47 into @xmath5 ; more generally , they take population in any other odd state ( i.e. , a superposition of @xmath25 and @xmath47 ) into @xmath25 and the even states .    l4 cm | p1.8 cm | p1.8 cm | p1.8 cm | p1.8cm| p0.9 cm | p0.9 cm | p0.9 cm | p0.9 cm previous state & & & + @xmath48 & @xmath49 & @xmath50 & @xmath49 & @xmath50 & & + outcome probability & @xmath44 & @xmath51 & @xmath44 & @xmath51 & & + unitary & @xmath35 & @xmath36 & @xmath35 & @xmath36 & & + next state & even & @xmath52 & @xmath47 & even & & +    by repeating a sufficient number of these correction steps in sequence , the controller stabilizes the target bell state irrespective of the initial two - qubit state .",
    "the similarity between this active feedback and dd is that mb also transfers population between different parity states by conditional rabi drives .",
    "however , while the rabi drives in dd are conditioned autonomously by the photon number in the cavity , the unitary rabi pulses in mb are conditioned by real - time parity measurement performed by active monitoring of cavity outputs .",
    "the pulse sequences for dd and mb are shown in fig .",
    "[ fig : comparison]b and e. in dd , a set of continuous - wave drives are applied for a fixed time @xmath53 and after some delay @xmath54 to allow remaining cavity photons to decay , a two - qubit state tomography is performed @xcite .",
    "the cavity and rabi drive amplitudes and phases were tuned for maximum entanglement fidelity , following the procedure described in ref .  .",
    "in particular , the optimal cavity drive amplitudes were found to be @xmath55 . for mb ,",
    "the continuous drives are replaced by a pre - defined number of correction steps @xmath56 , resulting in a stabilization duration of @xmath57 where @xmath58  @xmath59s .",
    "there is no extra delay before tomography since each correction step already contains a delay after the quasi - parity measurement due to feedback decision latency .",
    "the strength and duration of the quasi - parity measurement @xmath26 were optimized as discussed in supp .  mat .",
    "the optimization achieved low parity measurement infidelities @xmath44 and @xmath45 while keeping the measurement - induced dephasing arising from the @xmath11 mismatch@xcite small compared to the natural decoherence in the same duration .",
    "we experimentally determined the infidelity of the quasi - parity measurement to be @xmath44 and @xmath45 of @xmath60 and @xmath61 , respectively .",
    "the quasi - parity measurement also causes a deterministic qubit rotation about the respective @xmath62 axis due to an ac stark shift  @xcite ; this rotation was corrected within the unitary gate @xmath36 as discussed in supp .",
    "[ fig : comparison]c , f show the fidelity to the target bell state @xmath25 as a function of stabilization time for dd and mb , respectively .",
    "the fidelity rises exponentially with a characteristic time constant of @xmath63  @xmath59s ( @xmath64  @xmath59s ) and a steady - state fidelity of @xmath65 ( @xmath66 ) for dd ( mb ) .",
    "both fidelity values agree with numerical modeling based on master equation simulation , which gives @xmath65 and @xmath67 for dd and mb , respectively ( see supp .  mat .",
    "iv ) . the exponential dependence is a signature of feedback and arises from the characteristic loop time .",
    "the experimentally determined time constants are in reasonable agreement with their simulated values of @xmath68  @xmath59s ( @xmath64  @xmath59s ) for dd ( mb ) . in mb , this loop time is related to the step length ( @xmath69  @xmath59s ) , which is given by the sum of the quasi - parity measurement duration ( @xmath70  @xmath59s ) , the cable , instrument and fpga latencies ( @xmath71  @xmath59s ) , and the duration of unitary pulses ( @xmath72  @xmath59s ) . on the other hand for dd ,",
    "the measured loop time is close to @xmath73 cavity lifetimes , the expected time as shown in ref .  .",
    "the superior performance of dd over mb for the steady - state fidelity is due to the difference in correction loop time , which needs to be shorter than the coherence times of the two qubits for high fidelity entanglement . for the current experimental setup , the latency of the controller and quantum efficiency of the measurement chain , which affects the fidelity of the single - shot readout , result in a longer loop time in mb .",
    "a source of the longer feedback loop time is the quasi - parity measurement duration .",
    "this measurement duration , which was optimized as discussed in supp .",
    "ii , is limited by dephasing induced by the mismatch in @xmath11 ( @xmath74 ) and the measurement efficiency of the output chain ( @xmath75 ) , which can both be improved in future experiments .",
    "our simulations ( see supp .  mat",
    ".  sec .",
    "iv ) suggest that with current state - of - the - art measurement efficiency value and optimization of the fpga / cable latency , the mb steady state fidelity can be improved to @xmath76 .",
    "the limited measurement efficiency does not affect the performance of dd because the parity measurement and correction take place autonomously within the qubit - cavity system , indicative of its robustness against this hardware limitation .",
    "on the other hand , both dd and mb schemes benefit from longer intrinsic coherence times and reduction of the @xmath11 mismatch . for example",
    ", simulations show that if the coherence times are improved to one hundred microseconds ( achieved in other state - of - the - art cqed setups ) , both dd and mb fidelities can increase to above 85% . for the rest of the article , however , we consider boosting the fidelity in a different manner , without making any physical changes to the qubit - cavity system .",
    "the dd and mb schemes described so far are synchronous in the sense that the stabilization always ends after a pre - determined duration and the tomography follows .",
    "decoherence causes the qubits to have a finite probability of jumping out of the target state immediately before the stabilization terminates .",
    "hence , this `` fixed time '' protocol does not always output the target state with maximum fidelity .",
    "an optimum protocol would rather utilize all available information .",
    "for both dd and mb , we can measure the cavity output at the end of the stabilization period .",
    "the outcomes of these measurements , @xmath77 and @xmath78 , give real - time information on the state of the two qubits , and thus can herald a successful stabilization sequence .    in fig .",
    "[ fig : thresh_sweep ] , we describe how monitoring the cavity outputs improves target state fidelity .",
    "we introduce two thresholds @xmath79 ( see supplementary material for details ) to post - select the measurement outcomes of @xmath77 and @xmath78 respectively , and identify successful stabilization runs @xcite .",
    "the results of varying @xmath79 are shown in fig .",
    "[ fig : thresh_sweep]b , d for dd and mb , respectively .",
    "the color plots show fidelity improving as the thresholds become more stringent .",
    "the success probability defined as the percentage of stabilization runs kept for tomography given a set of thresholds , is also plotted as contours for both dd and mb .",
    "there is a clear trade - off between success probability and fidelity . to reach the maximum fidelity in dd of 82% ,",
    "at least 75% of experiment runs need to be discarded .",
    "the trade - off is less severe in mb , where only 50% of runs need to be discarded to reach the maximum fidelity of 75% .",
    "however we aim to eliminate this trade - off all together , i.e. , to improve the fidelity while maintaining a high success probability .",
    "this goal is achieved by introducing a nested feedback protocol ( nfp ) , in which the stabilization feedback loop enters into a higher layer of feedback for `` fidelity boosting '' instead of proceeding to state tomography directly .",
    "in contrast to the `` fixed time '' protocol , nfp conditions the termination of stabilization on the quality of the entanglement , i.e. , it heralds a successful stabilization run in real - time , as illustrated by the state machine diagram in fig .",
    "[ fig : real_time]a .",
    "the control variable @xmath80 is given by @xmath81 , where @xmath79 are determined by the same post - selection experiment discussed previously to optimize the fidelity ( black square in fig .",
    "3b and d ) .",
    "if the controller determines that the entanglement quality is not sufficient ( @xmath82 ) , a boost phase is attempted which comprises exactly one correction step for mb or a stabilization period of similar duration for dd ( @xmath64  @xmath59s ) . during the boost phase , the cavity outputs are integrated to give @xmath83 which enables the next real - time assessment of @xmath80 . in dd ,",
    "the parity measurement and first layer of feedback is accomplished autonomously , therefore the fpga only needs to check @xmath80 .",
    "however in the mb scheme both layers of feedback are performed solely by the fpga .",
    "it therefore checks if @xmath84 to herald that the entanglement meets the desired quality .",
    "if not , it uses the quasi - parity thresholds ( grey circles in fig .",
    "3d ) to decide whether the qubits are in even or odd state in order to continue stabilization .",
    "this asynchronous pulse sequencing and conditioning by multiple thresholds exploit the programmable nature of the fpga - based platform .    the asynchronous behavior of nfp is displayed in fig .  [ fig : real_time]b(e ) for dd ( mb ) , which demonstrates 200 single - shot runs .",
    "the dd ( mb ) fidelity boosting sequence continues until either success or a maximum limit on boost attempts ( set to 11 in the experiment ) is reached . for the mb protocol",
    ", the trajectory of the qubits parity can be tracked by the conditioning outcomes of the inner - loop control variable @xmath41 and the outer - loop control variable @xmath80 , which are independent . through repeated boost attempts until success",
    ", nfp significantly improves the overall success probability . within 11 attempts , 95% ( 99.8% ) of dd ( mb ) runs satisfy the success condition compared to just 25% ( 50% ) with simple post - selection .",
    "this is assessed by the cumulative probability , the integral of the probability of having completed a certain number of boost attempts before tomography , as plotted in fig .",
    "[ fig : real_time]c , f .",
    "since mb requires a less stringent threshold than dd to gain fidelity improvement , the mb success probability converges to unity much faster than that of dd .",
    "finally , we show that the high success probability does not come at the cost of reduced fidelity .",
    "the fidelity to @xmath25 for dd improves from an unconditioned value of 76% to 82% ( averaged over all successful attempts ) . for mb ,",
    "the improvement is more pronounced : fidelity rises from an unconditioned value of 57% to 74% .",
    "thus for both dd and mb , nfp attain close to the fidelity achieved via stringent post - selection .",
    "these results for nfp also agree well with a numerical simulation ( see supp .  mat .  sec .",
    "one will note , however , a continuous downward trend of the fidelity in both dd and mb schemes as the number of attempts increases .",
    "this is due to the non - negligible population in the @xmath85 states of the two qubits in the experiment , which escape correction by the stabilization feedback loops .",
    "after each further boost attempt of stabilization , the probability of the population escaping outside the correction space thus increases , diminishing the fidelity ( see supp .  mat .",
    "vii ) . also note that the error bars on the fidelity of mb are bigger than those in dd for large attempt numbers simply because the probability of needing many attempts is lower in mb than in dd .",
    "while real - time heralding by nfp removes the trade - off between fidelity and success probability , it does so by introducing a different trade - off  high fidelity and success probability are achieved but the protocol length now varies from run to run . if nfp is a module within a larger quantum information processing ( qip ) algorithm , then this asynchronous nature must be accommodated by the controller . for our fpga - based control ,",
    "nfp is easily accommodated because it is a natural extension to `` fixed - time '' or synchronous operation . in `` fixed time '' operation , the controller conditions its state by the protocol length which is pre - determined and stored in an internal counter by the experimenter . on the other hand in nfp , the controller conditions its state on a pre - determined logical function of its real - time inputs .",
    "in conclusion , we have implemented a new mb stabilization of an entangled state of two qubits , which parallels a previous dd stabilization scheme . instead of coherent feedback by reservoir engineering ,",
    "mb relies on actively controlled feedback by classical high - speed electronics external to the quantum system .",
    "when comparing both schemes in the `` fixed - time '' protocol , we observe that dd gives a higher fidelity to the target state due to lower feedback latency .",
    "furthermore , we have improved the fidelity of both schemes by a nested feedback protocol which heralds stabilization runs with high - quality entanglement in real time .",
    "the real time heralding brings about the fidelity improvement without a common trade - off in qip : it does not sacrifice the experiment success probability .",
    "it eliminates this trade - off by allowing asynchronicity in the experiment .",
    "our experiment shows some of the key advantages of mb platforms that have not been previously explored .",
    "typically , the performance of mb feedback has not been at par with methods based on post - selection , due to the latency of the controller .",
    "however it is widely recognized that the trade - off of success probability for fidelity in the case of post - selection is untenable for large scale systems .",
    "therefore , existing digital feedback@xcite have focused on achieving nearly perfect success probability . here",
    ", we are exploring another direction of feedback which achieves high fidelity with high success probability .",
    "our nested feedback strategy maximizes the use of the information coming out of the qubit - cavity system in order to make the correction process as efficient as possible .",
    "we find that our feedback platform , comprised of a nearly - quantum - limited measurement chain and a real - time classical controller , provides the necessary tool - set to implement such a strategy .",
    "we show that this technology can be extended to improve the performance of dd approaches as well as single - layer mb approaches themselves .",
    "this strategy could be carried out further in the future .",
    "for example , the fpga state estimator could perform a more sophisticated quantum filter of the microwave output of the dd stabilization to herald successful events with better accuracy , significantly improving the success probability convergence rate .",
    "similar ideas can be applied in the future towards other forms of stabilization , such as for stabilizing schrdinger cat states of a cavity mode@xcite , a proposed logical qubit .",
    "initial experiments on such logical qubits with high fidelity - measurement@xcite or dissipation engineering@xcite have been performed and could now be combined .",
    "likewise , future logical qubits based on the surface code@xcite could also be stabilized by either active stabilizer measurements@xcite or as recently proposed by dissipation engineering@xcite .",
    "our experiment demonstrates that measurement - based and driven - dissipative approaches , far from being antagonistic , can be merged to perform better than either approach on its own .",
    "we thank zaki leghtas , mazyar mirrahimi , matti silveri and shantanu mundhada for helpful discussions .",
    "this research was supported by the u.s . army research office ( w911nf-14 - 1 - 0011 and w911nf-14 - 1 - 0563 ) .",
    "facilities use was supported by the yale institute for nanoscience and quantum engineering and nsf mrsec dmr 1119826 .",
    "all statements of fact , opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of the u.s .",
    "government .",
    "62ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "_  ( , ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.105.040502 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.032324 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevx.4.041039 [ * * ,   ( ) ] @noop _ _  ( ,  ) http://dx.doi.org/10.1038/nature10376 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.109.240502 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature11505 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevx.3.021008 [ * * ,   ( ) ] @noop * * , ( ) http://dx.doi.org/10.1038/nature12422 [ * * , ( ) ] http://dx.doi.org/10.1038/nature13171 [ * * ,   ( ) ] http://dx.doi.org/10.1038/ncomms5015 [ * * ( ) ] http://arxiv.org/abs/1411.5542 [ * * ( ) ] @noop * * ,   ( ) @noop * * ( ) link:\\doibase 10.1103/physrevlett.77.4728 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.107.080503 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevx.3.021013 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.109.183602 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.110.120501 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.88.023849 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature12802 [ * * ,   ( ) ] @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) http://dx.doi.org/10.1038/nature10786 [ * * ,   ( ) ] @noop * * ,   ( ) \\doibase http://dx.doi.org/10.1016/j.automatica.2009.04.018 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.180502 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.81.040301 [ * * , ( ) ] link:\\doibase 10.1103/physreva.82.012329 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.69.062320 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.109.050506 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.050507 [ * * ,   ( ) ] @noop * * , ( ) link:\\doibase 10.1103/physrevlett.107.240501 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature05461 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature09035 [ * * ,   ( ) ] http://dx.doi.org/10.1126/science.1226897 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.102.200402 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.81.062325 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/16/i=4/a=045014 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature13436 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.062324 [ * * ,   ( ) ]    ( a ) schematic of the experimental set - up .",
    "two independently addressable transmon qubits , alice and bob , are dispersively coupled to a three - dimensional microwave cavity .",
    "the cavity output is directed to a nearly quantum - limited measurement chain consisting of a josephson amplifier ( jpc ) followed by a semiconductor amplifier ( hemt ) . a pair of custom field - programmable gate array boards ( fpga a , b ) monitor the amplified output and generate real - time modulated microwave drives to control the cavity - qubit system .",
    "( b ) transmission spectra of the cavity .",
    "cavity outputs at @xmath3 and @xmath4 are fed to fpga a and b , respectively . ]     ]    fig .",
    "comparison between the driven - dissipative ( dd ) and the measurement - based ( mb ) entanglement stabilization , shown in the left ( dd ) and right ( mb ) panels .",
    "( a ) diagram of qubit / cavity state evolution in the dd feedback loop .",
    "two - qubit state manifolds are laddered for different photon numbers in the cavity ( labeled by @xmath86 ) .",
    "the green and pink sinusoidal double arrows represent cavity drives , while the straight double red / blue and cyan / yellow arrows are rabi drives on the qubits .",
    "these six drives and the cavity dissipation ( black decaying arrow ) couple the different states of the system such that the target state @xmath25 is stabilized .",
    "( b ) functional pulse sequence for dd .",
    "the duration needed to empty the cavity of residual photons ( see text ) before tomography is indicated by @xmath54 .",
    "( c ) fidelity to the target as a function of stabilization duration ( @xmath53 ) .",
    "dashed line at @xmath87 denotes the threshold for entanglement .",
    "the time given in the white box , @xmath88 , is the characteristic time constant of the exponential rise of fidelity .",
    "( d ) state machine representation of the mb feedback loop .",
    "the quasi - parity measurement reports @xmath7 , @xmath8 as @xmath89 ( even ) and @xmath25 , @xmath15 as @xmath90 ( odd ) . for odd ( even ) parity , two @xmath91 pulses , with identical ( opposite ) phases , are applied to alice and bob , respectively .",
    "( e ) sequence of correction steps conditioned by the quasi - parity measurement and leading into tomography .",
    "counter @xmath39 limits the number of steps to @xmath56 .",
    "( f ) fidelity to the target bell state as a function of stabilization duration ( @xmath92 ) or number of correction steps ( @xmath56 ) .",
    "trade - off between success probability and fidelity for both dd and mb schemes .",
    "( a ) pulse sequence for heralding dd stabilization by post - selection . at the end of the stabilization period ,",
    "the cavity outputs , @xmath77 and @xmath78 are measured at their respective frequencies .",
    "( b ) color plot of fidelity to the target state for dd as a function of thresholds chosen for @xmath77 and @xmath78 ( see supplementary material for details of the thresholds ) . also plotted as white dashes are contour lines of the success probability associated with each choice .",
    "solid black square indicates the thresholds chosen for the condition @xmath80 in the nested feedback protocol described in fig .",
    "( c ) and ( d ) same as above for mb , including the corresponding thresholds for @xmath80 .",
    "gray circle indicates the thresholds chosen for the quasi - parity measurement @xmath41 used to condition mb correction steps . ]",
    "nested feedback protocol for boosting fidelity and heralding successful stabilization run in real - time .",
    "( a ) state machine representation",
    ". the control variable @xmath80 ( see main text and fig .  3 ) determines the repetition of a boost cycle or the heralding of a successful run .",
    "the maximum number of boost attempts allowed is set to 11 in the experiment .",
    "( b ) , ( e ) 200 single - shot sequence trajectories of nested feedback for dd and mb , respectively .",
    "the trajectories are colored yellow during boost attempts and black after @xmath80 is satisfied .",
    "trajectories that are entirely black satisfied the success criterion without the need for boost .",
    "the inset in ( e ) shows an example of an mb trajectory consisting of both @xmath41 and @xmath80 outcomes .",
    "( c),(f ) cumulative success probability ( gray shade ) of having completed at most a given number of boost attempts before tomography for dd and mb , respectively .",
    "yellow bars indicate differential success probability .",
    "( d),(g ) fidelity to target bell state for dd and mb , respectively .",
    "green squares show the corresponding fidelity as a function of the number of boost attempts .",
    "the blue dashed line denotes fidelity without any boosting ( i.e.  unconditioned by @xmath80 ) .",
    "blue arrows denote the improvement in fidelity due to nested feedback .",
    "while the absolute fidelity of mb is worse than dd due to latency , the fidelity boost is higher . ]    * supplementary materials *",
    "the cavity - qubit system was housed in an oxford triton 200 dilution refrigerator , at a base temperature below 20 mk .",
    "the setup of the experiment is described in detail in fig .",
    "[ fig : exp_setup ] .",
    "the key feature is that both data acquisition and arbitrary waveform / digital marker generation were accomplished by two fpga boards programmed with a customized logic .",
    "the cavity frequency is @xmath93  ghz when both qubits are in the ground state and its linewidth @xmath94 is @xmath95  mhz .",
    "the qubit frequencies with no cavity photons are @xmath96  ghz and @xmath97  ghz , for alice and bob respectively .",
    "the two dispersive shifts are @xmath1  mhz , @xmath2  mhz .",
    "the anharmonicity for the two qubits are @xmath98  mhz , @xmath99  mhz .",
    "alice ( bob ) has a @xmath100 of @xmath101  @xmath59s ( @xmath102  @xmath59s ) , @xmath103 of @xmath104  @xmath59s ( @xmath73  @xmath59s ) and",
    "excited state population in @xmath105 and @xmath106 of 5% each .    as mentioned in the main text , the fast dispersive single - shot readout used in the experiment",
    "is made possible by a nearly quantum - limited phase - preserving measurement chain based on the josephson parametric converter(jpc ) .",
    "the jpc was operated with a gain of @xmath107  db and bandwidth of 6.2 mhz , with the frequency for maximum gain centered between the two readout frequencies , @xmath3 and @xmath4 .",
    "the gain and noise visibility ratio at both @xmath3 and @xmath4 were about 17 db and 6 db , respectively .",
    "[ sec : msmt time ] the quasi - parity measurement strength and duration were optimized in order to maximize the fidelity of mb .",
    "this optimization was done by maximizing the fidelity of the bell state created in a calibration experiment , similar to ref .  .",
    "the qubits are prepared in ground states ( by post - selection ) and then two @xmath108 pulses , are applied to alice and bob , producing the state @xmath109 . the quasi - parity measurement , consisting of the two cavity drives on @xmath4 and @xmath3 respectively , projects the qubits into one of the two even states or entangles the qubits into a bell state with odd parity .",
    "we varied the duration of this parity measurement and its strength in terms of photon number ( set to be identical ) for each readout frequency to find the parameters that maximize the fidelity of the entangled state to the closest bell state ( fig .",
    "[ fig : measurement_calibration ] ) .",
    "the bell state fidelity would ideally increase and asymptotically approach one with increasing measurement time as the parity measurement better distinguishes the odd bell state from the even states . on the other hand , at long measurement duration , the coherence of the entangled state decreases due to both natural and measurement - induced dephasing , the latter of which is caused by the @xmath11 mismatch between the qubits and is proportional to the average number of photons used for the measurement @xcite .",
    "therefore , there is an optimal measurement strength and duration . for our experiment , @xmath110 for each readout frequency and a measurement duration of @xmath111  ns",
    "are found to be close to the optimal values and are chosen to attain a bell state fidelity of @xmath112% .    the value of @xmath112% sets the upper bound on the fidelity that we should expect for heralding mb . in the actual mb experiment ,",
    "an extra @xmath113  ns delay was introduced after the quasi - parity measurement in a correction step , which does not occur in the sequence described in this section for optimizing the parity measurement parameters .",
    "this extra delay was required to accommodate the feedback latency in mb .",
    "the conditioned fidelity we obtained for heralded mb is about 6% lower .",
    "[ sec : thresholds ] the cavity outputs at @xmath3 and @xmath4 for both dd and mb can be used to monitor the state of the qubits during stabilization ( fig .",
    "[ fig : thresh_hist]a ) .",
    "histograms of the measurement outcomes @xmath77 and @xmath78 , recorded by integrating the cavity output at @xmath3 and @xmath4 , respectively , are shown in fig .",
    "[ fig : thresh_hist]b , c , d , e for dd and mb respectively . in dd ,",
    "the cavity output signals are captured while all the cw drives are still on , i.e. , the qubits are being driven while their states are being monitored , whereas in mb the outputs are a result of the quasi - parity measurements which occur after the qubit pulses and thus when the qubits are not driven .",
    "we observe that the measurement outcome distribution of dd lacks the separation seen in mb which has a clear parity separatrix @xmath114 .",
    "this feature also appears in numerical simulations of dd by the stochastic master equation @xcite .",
    "the state estimation used in both dd and mb uses the `` box car '' filtering @xcite which simply sums up the recorded cavity output signals over time to obtain the measurement outcomes .",
    "this method , while appropriate for mb , is not suited for dd since in the latter , the qubits are undergoing actively - driven dynamics when the measurement is taking place . a more advanced filter , such as a non - linear quantum filter can be designed from either first - principles or machine learning @xcite in the future to improve the state discrimination accuracy in dd .",
    "the measurement outcomes to the left of both the @xmath115 ( shown in figure ) and @xmath116 thresholds are much less likely to come from even states than those to the right .",
    "therefore the experiment runs with these outcomes are selected for state tomography , giving the results plotted as a color map in fig .",
    "3 ( main text ) . moving the threshold further to the left increases the stringency of the threshold as fewer measurement outcomes are included .",
    "the success probability for each threshold choice ( plotted as contours in fig .",
    "3 ) is calculated by the ratio of included outcomes to the total number of experiment runs .",
    "[ sec : supp model ]    the steady state behavior of both dd and mb is simulated by a lindblad master equation , given by @xmath117+\\kappa d[a]\\rho(t)+\\sum\\limits_{j = a , b}\\left(\\frac{1}{t_{\\downarrow}^j}d[\\sigma_-^j]\\rho(t)+\\frac{1}{t_{\\uparrow}^j}d[\\sigma_+^j]\\rho(t)+\\frac{1}{2t_{\\phi}^j}d[\\sigma_z^j]\\rho(t)\\right)\\ ] ] @xmath118 is the lindblad super - operator , defined for an operator @xmath119 as @xmath120\\rho = o\\rho o^{\\dagger}-(1/2)o^{\\dagger}o\\rho-(1/2)\\rho o^{\\dagger}o$ ] . the pure dephasing rate for alice and bob , respectively , is given by @xmath121 , where @xmath122 .",
    "the hamiltonian @xmath123 is treated differently in dd and mb . for dd",
    ", the hamiltonian is described in detail in the theory proposal @xcite and parameters in the hamiltonian , such as the cavity and qubit drive amplitudes , are swept in simulation to find the optimal values .",
    "the optimal value for the cavity drive amplitude is found to be @xmath124 with @xmath125 , and @xmath126 for the qubit drive amplitudes at both zero - photon and n - photon qubit frequencies .",
    "the dd simulation predicts a characteristic time constant of 1 @xmath59s and a steady state fidelity of 76% ( accounting for the delay between stabilization and state tomography to allow remaining cavity photons to decay ) .    for mb ,",
    "a correction step is broken into four segments for effectively piecewise master equation simulation .",
    "the first part contains the conditional rabi pulses which are simulated as perfect instantaneous unitary operations on the qubits .",
    "the second part is the decay during the pulses ( 154 ns total ) .",
    "the hamiltonian during this part is just the the dispersive interaction between the qubits and the cavity , @xmath127 , in the rotating frame of the two qubits ( @xmath128 , @xmath129 ) and the cavity mode ( @xmath130 ) .",
    "the third part is the quasi - parity measurement during which the cavity drives at the @xmath3 and @xmath4 resonances are on and the hamiltonian is given by @xmath131 , where @xmath132 is the amplitude of the cavity drive ( 660 ns total ) .",
    "the last part is the remainder of the correction step , incurred by the latency of the feedback during which all drives are off and the qubit - cavity system is in free - decay .",
    "the dynamics in this part is again simulated by the dispersive interaction , @xmath133 ( 686 ns total ) . for the piecewise master equation simulation of a complete correction step as four segments ,",
    "the density matrix at the end of a segment is used as the initial density matrix for the next segment .    since in mb ,",
    "the state at the end of a correction step depends only on the initial state at the beginning of the step , we can model the mb scheme as a markov chain ( fig .  [",
    "fig : mb_markov ] ) . in the rest of this section ,",
    "we show how we derive the transition matrix that describes this markov chain .",
    "as discussed in the main text , we can describe the qubits by the density matrix @xmath134 .",
    "therefore , in terms of probability distributions in the four basis states , the qubits s state , @xmath135 , can be represented by a vector , @xmath136 if the qubits are prepared in @xmath25 , that is @xmath137 , we can calculate @xmath138 after a correction step by applying the master equation simulation method described above .",
    "we need to consider the two possible cases where the conditional unitary applied is @xmath36 or @xmath35 , respectively .",
    "the @xmath138 is a weighted average of the two cases .",
    "@xmath139 @xmath44 and @xmath45 are the quasi - parity measurement infidelities due to limited measurement efficiency , introduced in the main text . in a similar manner ,",
    "we can obtain @xmath140 . in the case of an even initial state , for example , @xmath141",
    ", we have @xmath142 and similarly for @xmath143 .    given @xmath138 , @xmath140 , @xmath144 and @xmath143 , we can construct the transition matrix @xmath145 of a correction step , @xmath146 where the @xmath147 s are the columns of the 4 by 4 matrix . now applying this transition matrix on any arbitrary initial state gives the final state after a correction step , @xmath148",
    "the transition matrix @xmath145 is also called the stochastic matrix , with the property that each column sums to 1 .",
    "one of @xmath145 s eigenvalues is guaranteed to be 1 and the corresponding eigenvector , @xmath149 , is the steady state of the markov chain . it can easily be shown that for any arbitrary initial state , @xmath150 @xmath151 for the given experimental parameters in mb , the @xmath145 matrix is displayed in fig .",
    "[ fig : mb_markov ] and we find the steady state eigenvector to be @xmath152 thus , the markov model predicts a steady state fidelity of 58% to @xmath25 .",
    "taking into account of the duration of a correction step ( 1.5 @xmath59s ) , we can also calculate the characteristic time constant of the mb scheme from the model , which gives 1.4 @xmath59s .",
    "both values agree very well with experimental results .",
    "we can calculate the expected fidelity when some of the experimental parameters are improved in the near future . if the measurement efficiency is improved from 30% to the current state - of - the - art value of 60% , the measurement duration can be reduced by half while maintaining the quasi - parity measurement infidelities@xcite .",
    "the instrument and fpga latencies incurred in the experiment can also be reduced by 100 ns , in the latest hardware setup and fpga logic design in operation while this article was being prepared .",
    "the measurement duration and control latency reduction can shorten the correction step length to 1 @xmath59s , which can improve the steady state fidelity to 66% .",
    "furthermore , if the coherence times are also improved to the state - of - the - art values in the hundred of microseconds for superconducting qubits , both dd and mb fidelities in the `` fixed time '' protocol can be above 85% , limited by the @xmath11 mismatch ( assumed to be 10% , as in the current experiment ) .",
    "the prospects of both dd and mb schemes are summarized in tab .",
    "[ tab : fidelity_prospects ]    l | l p2 cm p2 cm & + & dd & mb + experiment & current parameters & 76% & 57% + & @xmath153 , latency@xmath154  ns & 76% & 66% + & @xmath100,@xmath155  @xmath59s & 86% & 86% +",
    "[ sec : nfp_simulation ] the markov chain model introduced in sec .",
    "[ sec : supp model ] can be extended to simulate nfp ( nested feedback protocol ) .",
    "we can construct a `` nested '' markov chain ( fig .",
    "[ fig : nfp_markov ] ) for each boost attempt of nfp . at the outer - most level , there are two nodes .",
    "one node denotes the trajectories that have just been heralded as successful ; the other node denotes the trajectories that require at least another boost attempt . building on the vector description established in the previous section , we represent the heralding of trajectories before a boost attempt by a diagonal matrix @xmath156 ,    @xmath157    after stabilization of some pre - determined duration , if the qubits are ( on average ) in state @xmath158 , then the average state of the qubits that are heralded is then given by ,    @xmath159    where @xmath160 is the @xmath161 norm of the vector ( the sum of the entries in the vector ) .",
    "the normalization is required since heralding selects only a subset of the trajectories , i.e. , the matrix , @xmath156 , does not preserve the norm of @xmath135 .",
    "each entry on the diagonal of @xmath156 gives the fraction of trajectories that get heralded ( selected ) from a particular state .",
    "their values depend on the particular heralding thresholds used , @xmath115 and @xmath116 ( supp .",
    "[ sec : thresholds ] ) .",
    "this matrix can be determined phenomenologically by the post - selection experiment shown in fig .",
    "3 ( main text ) . from the experiment",
    ", we can find the average state without any conditioning ( no heralding ) , @xmath162 and the average state of the heralded trajectories , @xmath163 .",
    "given the success probability @xmath164 of using the thresholds ( the white dashed contour line of fig .",
    "3b , d in the main text ) , the diagonal elements can be calculated as ,    @xmath165    for the specific heralding thresholds used in the experiment ( represented by the black squares in fig .",
    "3b , d in the main text ) , @xmath166 and @xmath167 are explicitly given by ,    @xmath168    ideally for @xmath156 , only @xmath169 should be non - zero .",
    "but in practice , since we can not distinguish @xmath46 and @xmath47 , @xmath170 is comparable to @xmath169 .",
    "furthermore , for both dd and mb , @xmath171 and @xmath172 are also non - neglibile . in dd , this is predominantly due to the lack of separation between the even and odd measurement outcomes as discussed in supp .  sec .  [",
    "sec : thresholds ] . in mb ,",
    "the qubits can jump during the delay between the completion of the quasi - parity measurement and the end of a correction step due to @xmath100 events .",
    "thus for mb , trajectories that are heralded by very stringent thresholds still have a non - zero probability of being in the even parity states .    given the heralding matrices @xmath166 and @xmath167 , we can now calculate the average state of the trajectories that are not heralded and thus require a boost attempt as    @xmath173    where we introduce the lowercase @xmath174 as the unnormalized population distribution vector .",
    "@xmath160 denotes the @xmath161 norm of the numerator .",
    "after this boost attempt , the qubits are in state @xmath175 ,    @xmath176    where @xmath145 is the stochastic transition matrix that models the stabilization during a boosting attempt . in supp .",
    "[ sec : supp model ] , we have already found @xmath145 for mb . by the same method , we can also derive the effective transition matrix of a boost attempt for dd .",
    "the calculation of @xmath145 for dd is an approximation : due to the continuous cavity drives , the state of the qubits at the beginning of a boost attempt is entangled with a qubit - state dependent cavity state , which we approximate unconditionally by the average steady - state cavity state in dd .",
    "nonetheless , as we shall show , the model still produces a quantitative behavior that agrees very well with the experimental results . from the above equations , it is easy to show that the average qubits state of the heralded trajectories after @xmath39 boost attempts is given by    @xmath177    in the case of a pre - stabilization of sufficient number of correction steps ( or duration ) , @xmath158 is given by the steady - state , @xmath149 , introduced in supp .",
    "[ sec : supp model ] .",
    "for each of the @xmath39 boost attempts , the first entry in the vector @xmath178 , i.e. , @xmath179 , gives the fidelity to @xmath180 .",
    "the @xmath161 norm of the numerator in the expression for @xmath178 gives the percentage of trajectories that have completed @xmath39 boost attempts .",
    "summing the percentages over all values of @xmath39 from 0 to the maximum limit gives the overall success probability .",
    "[ fig : nfp_sim_results ] , we show the results of the simulation using the model described here and compare them to the experimental results presented in fig .  4 of the main text .",
    "furthermore , from the simulation , we find that with the realistic system parameter improvement as specified in supp .",
    "[ sec : supp model ] , the fidelity of heralded trajectories can be 90% and 95% for dd and mb , respectively , with order unity success probability .",
    "[ sec : ac stark shift ] the quasi - parity measurement induces a deterministic phase shift between the two qubits due to measurement - induced ac stark shift @xcite .",
    "this is evidenced by examining the phase of the bell state created in the measurement optimization experiment described in supp .",
    "[ sec : msmt time ] , in which we varied the measurement duration . as the measurement duration",
    "is increased , the bell angle of the final bell state changes linearly ( fig .",
    "[ fig : measurement_dephasing]a ) . in order for mb to work",
    ", we need to account for the deterministic phase shift induced by the measurement .",
    "this correction is accomplished by a `` _ _ z _ _ '' rotation on bob before the unitary @xmath36 .",
    "[ fig : measurement_dephasing]b gives one example of a sequence trajectory to illustrate how the correction works . with no loss of generality ( and the reason will become clear soon in the discussion that follows ) , we construct @xmath181 and @xmath182 ( where @xmath183 = 0 corresponds to the x axis ) such that @xmath184 is the eigenstate of @xmath36 and applying @xmath35 on the even states results in @xmath185 with 50% probability after the quasi - parity measurement .",
    "suppose that the qubits are in the ground states , @xmath35 is applied and the subsequent quasi - parity measurement gives @xmath33 . during the quasi - parity measurement , a deterministic phase shift of @xmath186",
    "since the measurement reports odd , the next conditional unitary is @xmath36 .",
    "the _ z _ gate before @xmath36 undoes the phase shift and recovers the eigenstate which @xmath36 leaves unchanged .",
    "after another parity measurement , the qubits are in the state @xmath187 , with the phase shift added again .",
    "consequently , we can see that the mb sequence actually stabilizes @xmath187 state . in practice , for our experiment , the _ z _ rotation for bob is constructed from a composite of _ x _ and _ y _ rotations , such that @xmath188 , and the effective correction angle @xmath189 is swept ( fig .",
    "[ fig : measurement_dephasing]c ) to find the optimal value that cancels the deterministic phase shift and thus maximizes the fidelity .",
    "furthermore , to make the target state of the stabilization @xmath180 , the rotation axis of the pulses on bob in @xmath36 and @xmath35 is chosen such that @xmath190 .",
    "this correction for measurement - induced ac stark shift is also done in the simulation for mb .",
    "[ sec : f state ] while we have been treating our two qubits as purely two - level systems , in reality there are higher energy levels , in particular the second excited level is expected to play a non - negligible role in the dynamics .",
    "we find that the equilibrium qubit population not in the @xmath7 state was about @xmath191% , and the @xmath192 state was also populated .",
    "to investigate whether the decrease of the fidelity in nfp as a function of boost attempts number is due to the role played by the @xmath192-state population , we measured the populations in @xmath193 , @xmath194 , @xmath195 , @xmath196 , @xmath197 after a given number of boost attempts in dd .",
    "the population in @xmath193 was measured by applying a @xmath198 pulse on alice s _ e - f _ transition , then a @xmath198 pulse on its _ e - g _ transition , followed by a measurement of the population in @xmath7 .",
    "the other @xmath192-state populations are similarly obtained .",
    "the sum of these 5 populations gives the total @xmath192-state population plotted in fig .",
    "[ fig : f_pop ] , which indeed increases as a function of boost attempt number .",
    "it is therefore plausible that the decrease in fidelity with respect to number of boost attempts is due to the system being trapped in other levels outside the correction space .",
    "this problem , which is common in similar atomic physics experiments , could be addressed by additional drives .",
    "7ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * , ( ) link:\\doibase 10.1103/physreva.82.012329 [ * * ,   ( ) ] @noop ( ) link:\\doibase 10.1103/physreva.76.012325 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.114.200501 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.88.023849 [ * * ,   ( ) ] http://dx.doi.org/10.1126/science.1226897 [ * * ,   ( ) ]      fig .  s.1 .",
    "setup of the experiment .",
    "the qubit - cavity system was placed at the base stage of a dilution refrigerator ( oxford triton200 ) below 20 mk . on the input side : two fpgas ( innovative integration x6 - 1000 m ) generated the pulse envelopes in i and q quadratures to modulate the qubit drives at @xmath199 and @xmath200 frequencies ( vaunix labbrick lms-802 ) for alice and bob , respectively .",
    "the i / q modulations were output by the fpgas with one and two single - sideband modulations in mb and dd ( so that both zero - photon and n - photon qubit frequencies were addressed ) , respectively .",
    "the microwave frequency drives and i / q modulation were mixed by iq mixers .",
    "two agilent n5183 microwave generators produced the cavity drives at @xmath4 and @xmath3 respectively .",
    "the cavity drives were also pulsed by the fpgas . on the output side : the transmitted signal through the cavity was directed by two circulators to the jpc for nearly quantum - limited amplification .",
    "it was further amplified at the 3 k stage by a cryogenic hemt amplifier .",
    "after additional room temperature amplification , the signal was split into two interferometric setups for readouts at the @xmath3 and @xmath4 frequencies , respectively . in each of the interferometers , the signal arriving from the fridge was mixed with a local oscillator set @xmath201 mhz away to produce a down - converted signal at 50 mhz .",
    "a copy of the cavity drive that did not go through the fridge was also down - converted in the same manner to produce a reference .",
    "finally , the two signals with their respective references were sent to the analog - to - digital - converters on the fpga boards for digitization and further demodulated inside the fpgas .",
    "the two fpgas jointly estimate the qubits state by communicating their results with each other . along the input and output lines , attenuators , low pass filters and homemade eccosorb filters",
    "were placed at various stages to protect the qubits from thermal noise and undesired microwave and optical frequency radiation . moreover , the cavity and jpc were shielded from stray magnetic fields by aluminum and cryogenic @xmath59-metal ( amumetal a4k ) shields .     experimental calibration of measurement strength and duration for mb .",
    "fidelity to the state @xmath202 after preparing the qubits in a maximally superposed state followed by a quasi - parity measurement with post - selection .",
    "the fidelity is plotted as a function of measurement duration and shown for a set of measurement strengths .",
    "the optimal values chosen for the experiment are 660 ns and @xmath110 . ]",
    "( a ) the cavity outputs at @xmath3 and @xmath4 are integrated to obtain measurement outcomes @xmath77 and @xmath78 , respectively .",
    "( b),(c ) , ( d ) , ( e ) histograms of the measurement outcomes @xmath77 and @xmath78 for dd and mb , respectively .",
    "the leftmost dashed line ( labeled @xmath115 and @xmath116 ) indicates a particular choice of threshold for heralding the measurement outcomes .",
    "counts to the left of both thresholds are declared success . the right dashed line ( @xmath203 and @xmath204 ) indicates the threshold for quasi - parity measurement in mb . ]",
    "markov model of a correction step in mb .",
    "transition between any two nodes is possible and is represented as a directional edge .",
    "the 16 possible transitions make up the 16 matrix elements in the stochastic transition matrix , @xmath145 , corresponding to a correction step in mb .",
    "numbers next to the edges represent the elements of @xmath145 calculated for the current experiment parameters by a master equation simulation . ]     markov model of the nfp ( nested feedback protocol ) for real - time heralding .",
    "this model is an extension of the model introduced for mb . during a boost attempt",
    ", transitions occur inside the `` boosting '' node for further stabilization . the edge leading from the `` boosting '' to the `` heralded '' node represents the real - time heralding that selects some fraction of trajectories by the threshold - dependent matrix @xmath156 ( see text ) at the end of a boost attempt .",
    "those that are not selected ( @xmath205 ) enter into another boost attempt . ]     simulation of real - time heralding by nfp .",
    "the left ( right ) panel presents the results for dd ( mb ) .",
    "( a ) , ( c ) cumulative success probability of having completed at most a given number of boost attempts before tomography for dd and mb , respectively .",
    "green curve shows the experimental result as presented in the main text .",
    "blue curve is the simulation result using the same experimental parameters .",
    "( b ) , ( d ) fidelity to @xmath46 for dd and mb , respectively .",
    "cyan dashed line denotes the unconditioned steady state fidelity obtained in the experiment .",
    "green squares ( blue circles ) show the corresponding fidelity as a function of the number of boost attempts during nfp obtained in the experiment ( simulation ) . ]     correcting for deterministic measurement - induced ac stark shift ( a ) deterministic phase shift induced by measurement as a function of measurement duration .",
    "( b ) one example of a sequence trajectory illustrating the phase correction @xmath206 at work .",
    "see detailed explanation in accompanying text .",
    "( c ) fidelity of the steady state to the target bell state as a function of the correction angle of the effective _ z _ gate on bob . ]"
  ],
  "abstract_text": [
    "<S> we demonstrate and contrast two approaches to the stabilization of qubit entanglement by feedback . </S>",
    "<S> our demonstration is built on a feedback platform consisting of two superconducting qubits coupled to a cavity which are measured by a nearly - quantum - limited measurement chain and controlled by high - speed classical logic circuits . </S>",
    "<S> this platform is used to stabilize entanglement by two nominally distinct schemes : a `` passive '' reservoir engineering method and an `` active '' correction based on conditional parity measurements . in view of the instrumental roles that these two feedback paradigms play in quantum error - correction and quantum control , we directly compare them on the same experimental setup . </S>",
    "<S> further , we show that a second layer of feedback can be added to each of these schemes , which heralds the presence of a high - fidelity entangled state in real - time . </S>",
    "<S> this `` nested '' feedback brings about a marked entanglement fidelity improvement without sacrificing success probability . </S>"
  ]
}