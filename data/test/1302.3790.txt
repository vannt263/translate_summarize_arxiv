{
  "article_text": [
    "in the field of microarrays it has traditionally been difficult to compare new methods to methods in published papers as the many methods available for pre - processing , summarizing and filtering make it almost impossible to work with the exact same data , even when the raw data is made available .",
    "that is why we consider reproducible research fundamental as it will facilitate easy 1 ) revision of papers , 2 ) access to data and results , 3 ) communication to other researchers and 4 ) comparison between different methods .",
    "reproducible research is gaining relevance among the scientific community as shown by the number of papers published on the subject during the last years @xcite .",
    "_ showed that the results of only 2 out of 18 published microarray gene - expression analyses were completely reproducible @xcite .",
    "this is why some authors demand that documentation and annotation , database accessions and url links and even scripts with instructions are made publicly available @xcite .",
    "journals like biostatistics have even appointed an associate editor for reproducible research , but still treat it as a  desirable goal \" rather than a requirement @xcite . setting up",
    "a framework for reproducible research necessarily implies working with free and open - source software as for example r / bioconductor @xcite .",
    "additionally , using sweave @xcite ( a tool for embedding ` r ` code in latexdocuments @xcite ) , enables automatic reports that can be updated with output from the analysis",
    ".    the main tool in this paper will be the bioconductor package ` aroma.affymetrix ` @xcite that can analyse all affymetrix chip types with a ( .cdf ) chip definition file .",
    "the number of arrays ( samples ) that can be simultaneously analysed by ` aroma.affymetrix ` is virtually unlimited as the system requirements are just 1 gb ram , for any operating system @xcite .",
    "this package is freely available and can easily be installed into ` r ` .",
    "the aroma.affymetrix website www.aroma-project.org is conceived as reference for all the possible microarrays that can be analysed with ` aroma.affymetrix ` , and does not focus specifically on the analysis of the genechip  human exon 1.0 st array ( or exon array in short ) .",
    "portable scripts for a fast and basic analysis can be obtained on request to ` aroma.affymetrix ` s authors .",
    "the analysis of exon array data in ` r`/bioconductor is not yet standard .",
    "there are several packages available , and it can be a tremendous effort for a newcomer to maneuver between them , and to overcome the numerous challenges associated with these packages .",
    "this paper aims to make this task easier and to provide a quick reference guide to ` aroma.affymetrix ` s documentation .",
    "we also explain how to extract data for different statistical analyses and propose a method for gene annotation and for gene profile visualization . for this last step ,",
    "we use the packages ` biomart ` and ` genomegraphs ` to annotate and visualize the transcripts in a genomic context .",
    "the analysis workflow presented in this paper is carried out solely in ` r`/bioconductor , and the paper is available as a sweave ( .snw ) document that will allow the reader to reproduce our exact results .",
    "the .snw document can also be converted into an ` r ` script and executed .",
    "the workflow starts by reading in the data , followed by background correction and quantile normalization .",
    "we then explain how to obtain transcript cluster - , probeset - , and probe - level estimates . afterwards",
    ", different methods for the statistical analysis of differential splicing or differential gene expression are reviewed .",
    "finally , we make a suggestion on how to annotate transcript clusters to genes in the lists obtained from the statistical analyses , and how to plot the data including genomic information . to exemplify the use of the workflow , an example dataset @xcite is analysed along the way .",
    "splicing is the post - transcriptional process that generates mature eukaryotic mrnas from pre - mrnas by removing the non - coding intronic regions and joining together the exonic coding regions . for many genes ,",
    "two or more splicing events take place during maturation of mrna molecules resulting in a corresponding number of alternatively spliced mrnas .",
    "these mature mrnas translate into protein isoforms differing in their amino acid sequence and ultimately in their biochemical and biological properties @xcite .",
    "alternative splicing is one of the main tools for generating rna diversity , contributing to the diverse repertoire of transcripts and proteins @xcite .",
    "it is known that 92 - 94% of multi - exon human genes are alternatively spliced and that 85% of those have a minor isoform frequency of at least 15% @xcite . in our case",
    "we will focus on the detection of differential splicing between groups , as for instance tissue types , or healthy vs. diseased samples .",
    "the exon array was presented in october 2005 as a tool for the analysis and profiling of whole - transcriptome expression @xcite . to interrogate each potential exon with at least one probeset",
    ", the exon array contains about 5.6 million probes grouped into more than 1.4 million probesets ( most probesets consisting of 4 probes ) , which are further grouped into 1.1 million exon clusters , or collections of overlapping exons .",
    "finally , exon clusters are grouped into over 300.000 transcript clusters to describe their relationship , as for example shared splice sites or overlapping exonic sequences .",
    "each gene is covered , on average , by 40 probes interrogating regions located along the entire gene @xcite .",
    "this probe positioning aims at providing better estimates of gene expression levels than previous arrays , and allows for the study of differential splicing @xcite and differential gene expression based on summarized exon expression .",
    "the exon array has three levels of annotation for the interrogated transcript clusters : _ core , extended _ and _ full _ @xcite .",
    "core transcript clusters are supported by the most reliable evidence such as refseq transcripts and full - length mrnas @xcite and a core transcript cluster is roughly a gene @xcite ; the extended level contains the core transcript clusters plus cdna - based annotations @xcite and the full level contains the two previous levels plus _ ab - initio _ , or algorithmic , gene predictions @xcite .",
    "it is worth noting that ` aroma.affymetrix ` enables the analysis at the three levels of annotation mentioned above , and also that it provides intensity estimates for probes , probesets and transcript clusters , allowing for a variety of options for the analysis .",
    "our workflow for the analysis of exon array data starts setting up the required folder structure for ` aroma.affymetrix ` .",
    "the data is then preprocessed and summarised at transcript cluster and/or probeset level .",
    "next , transcript clusters are analysed with several statistical models to detect differential expression or splicing and the transcripts of interest are annotated and visualised at the end , see figure [ fig : flowchart ] . in the code , places where user input is needed are marked by ",
    "* * * \" , and places where the user can choose whether to modify parameters are marked by  * * \" .    to exemplify the use of the tutorial we have used affymetrix s colon cancer data set @xcite , consisting of a collection of paired samples of colon tumour tissue and adjacent normal tissue from 10 patients and available at http://www.affymetrix.com/support/technical/sample_data/exon_array_data.affx . according to affymetrix s website , the rna samples are from a commercial source .",
    "this dataset has been used in a number of papers to evaluate the performance of different analysis methods @xcite and a number of genes have been validated to present differential splicing or not @xcite .",
    "the analysis was done in ` r ` version 2.15.1 ( 32 bit ) .",
    "start by installing and loading ` aroma.affymetrix ` in ` r ` and loading the other libraries required :    .... > source(\"http://aroma - project.org / hblite.r \" ) > hbinstall(\"aroma.affymetrix \" ) >",
    "require(aroma.affymetrix ) >",
    "require(biomart ) >",
    "require(genomegraphs ) ....      this section corresponds to steps 1 . and 2 .",
    "in figure [ fig : flowchart ] .",
    "the first step is to create the folder structure : under a main folder of our choice -  ` myworkingdirectory ` \" - we will create the  ` rawdata ` \" and  ` annotationdata ` \" folders , which will be common to all ` aroma.affymetrix ` projects . inside  ` annotationdata ` \" , the subfolder  ` chiptypes ` \" will contain one subfolder per chip type , with the exact name of the .cdf file provided by affymetrix ,  ` huex-1_0-st - v2 ` \" in our case . inside this folder we will save any library and annotation files that might be needed . besides , the  ` mydataset ` \" folder will be created under  ` rawdata ` \" to store .cel files .",
    "these files are the output of a microarray experiment and contain the result of the intensity calculations per probe or pixel .",
    "note that the microarray experiment produces one .cel file per array and that one array analyses one sample .",
    "affymetrix sometimes refer to their microarrays as  chips \" .",
    "note also that we need one  ` mydataset ` \" folder per experiment and that  ` mydataset ` \" will be added as a tag at the end of the ` aroma.affymetrix ` output .    ....",
    "> # * * * user - defined working directory > wd < - \" myworkingdirectory \" > # * * * user - defined data set name > ds < - \" mydataset \" ....    in the second step we save our library ( chip definition file ( .cdf ) in our case ) and .cel files in the corresponding folders .",
    "affymetrix s unsupported .cdf files can be downloaded from    http://www.affymetrix.com/auth/support/downloads/library_files/huex-1_0-st-v2.cdf.zip    , note that registration is needed . for the exon array , elizabeth",
    "purdom has created a number of binary .cdf files based on affymetrix s text .cdf file @xcite that are faster to query and more memory efficient .",
    "such binary .cdf files for core , extended and full sets of probesets can be downloaded from http://aroma-project.org/node/122 . in the example below we use",
    "the custom aroma file for core transcript clusters , which might be updated in the future .",
    "our original .cel files will be copied from the user - specified  ` mycelfiledirectory ` \" into the exon  ` rawdata ` \" subfolder ( the code is part of the .snw version of this paper ) . the desired output folder specified in  ` output.folder ` \" should exist in advance .    ....",
    "> # * * download user - defined library file > library.file < -   +    paste(annotation.data.exon ,   +          \" huex-1_0-st - v2,corer3,a20071112,ep.cdf \" , +          sep = \" / \" ) > download.address",
    "< -   +       \" http://bcgc.lbl.gov/cdffiles/ \" > file < - paste(\"huex-1_0-st - v2,a20071112,ep \" ,   +              \" huex-1_0-st - v2,corer3,a20071112,ep.cdf \" , +              sep = \" / \" ) > custom.cdf < -   +       paste(download.address , file , sep = \" \")",
    "> download.file(url = custom.cdf ,   +                destfile = library.file ,   +                mode = \" wb \" , quiet = false ) > # * * * user - defined directory containing .cel files > cel.directory   < - \" mycelfiledirectory \"   > # * * * user - defined output folder > output.folder < - \" output.folder \" ....    besides , the sample information should be saved in a tab separated file with column names ` celfile ` , ` replicate ` , and ` treatment ` containing .cel file name ( without .cel ) , replicate identifier and treatment name , respectively .",
    "this file should be called `` sampleinformation.txt '' and it will be copied from the user - specified directory into the ` \\rawdata\\mydataset \\huex-1_0-st - v2 ` folder ( which will also contain the .cel files ) after it has been created . the sample information file for the colon cancer example is attached as an additional file .    ....",
    "< -   +      read.table(file = paste(raw.data.exon ,   +                 \" sampleinformation.txt \" , sep = \" / \" ) , +                 sep = \" \\t \" , header = true ) ....    finally , netaffx transcript clusters and probesets annotation files should be saved in `` ` annotationdata / chiptypes/ ` '' `` ` huex-1_0-st - v2 ` '' .",
    "we have used release 32 , which was most up to date at the time of writing and we downloaded files `` huex-1_0-st - v2.na32.hg19.transcript.csv.zip '' and `` huex-1_0-st - v2.na32.hg19.probeset.csv.zip '' from    http://www.affymetrix.com/estore/browse/products.jsp?productid=131452&categoryid=35676&productname=genechip-human-exon-st-array#1_3    , _ technical documentation _ tab , under _ netaffx annotation files_. the extracted .csv files should be converted into .rdata files for querying them faster in the future . note that the number of lines to skip might differ for future annotation files .    ....",
    "transcript.clusters.netaffx.32 < -   +      read.csv(file = paste(annotation.data.exon , +          \" huex-1_0-st - v2.na32.hg19.transcript.csv \" ,   +          sep = \" / \" ) , skip=24 ) > probesets.netaffx.32 < -   + read.csv(file = paste(annotation.data.exon , +           \" huex-1_0-st - v2.na32.hg19.probeset.csv \" ,   +           sep = \" / \" ) , skip=23 )   ....      after defining chip type and dataset , background correction and quantile normalization are carried out as shown in figure [ fig : flowchart ] , step 3 . in these pre - processing steps ,",
    "it is possible to use either affymetrix s original .cdf file , the .cdf files provided by the aroma project ( the file for core transcript clusters in our example ) , or a .cdf file created by the user .",
    "the summarization step , however , must be done using one of the custom .cdf",
    "files available at the ` aroma.affymetrix ` project website .",
    "background correction as defined by irizarry @xcite and quantile normalization are performed by the ` rmabackgroundcorrection ( ) ` and ` quantilenormalization ( ) ` functions , respectively . the raw , background corrected and quantile",
    "normalized probe intensities can be visualized using the ` plotdensity ( ) ` function applied to the corresponding object .",
    "summarization is done with the ` exonrmaplm ` function @xcite .",
    "the parameter ` mergegroups ` determines whether to summarize at transcript level ( ` true ` ) or probeset level ( ` false ` ) .",
    "all the functions described automatically create subfolders such as  plmdata \" or ",
    "probedata \" inside  ` myworkingdirectory ` \" .",
    "a more detailed version of this code with interesting comments about the choice of .cdf and possibilities for quality control is available at http://www.aroma-project.org/vignettes/firma-humanexonarrayanalysis .    ....",
    "> chiptype < - \" huex-1_0-st - v2 \"   > # * * user - defined .cdf file : change tags parameter > cdf < - affymetrixcdffile$bychiptype(chiptype ,   +                     tags = \" corer3,a20071112,ep \" ) > cs < - affymetrixcelset$byname(ds , cdf = cdf )   >   > # background correction > bc < - rmabackgroundcorrection(cs )   > csbc < - process(bc , verbose = verbose )   >   > # quantile normalization > qn < - quantilenormalization(csbc ,   +                 typestoupdate = \" pm \" ) > csn < - process(qn , verbose = verbose ) >   > # summarization > # transcript cluster level > plmtr   < - exonrmaplm(csn , mergegroups = true ,   +                 tag = \" coreprobesetsgeneexpression \" ) > # probeset / exon level > plmex   < - exonrmaplm(csn , mergegroups = false ,   +                 tag = \" coreprobesetsexonexpression \" )             ....      the ` aroma.affymetrix ` documentation focuses on analyses at the probeset and transcript cluster levels .",
    "the respective intensities are obtained by applying the function ` getchipeffectset ( ) ` to the transcript or probeset ` plm ` objects ( ` plmtr ` and ` plmex ` , respectively ) and then extracting the corresponding dataframes .",
    "however , it is also possible to extract the background corrected and quantile normalized intensities of all probes using the function ` getunitintensities ` . while ` plmtr ` is suitable for the firma analysis ( [ subsec : statistics ] ) , ` plmex ` is well suited for probeset - level analysis . for the linear model analysis described in section [ subsec : statistics ] we have created one list of dataframes containing probe intensities per transcript cluster , and another list of dataframes containing probeset intensities per cluster ( code included in .snw ) .    .... > # extract a matrix of gene intensities > cestr < - getchipeffectset(plmtr ) > trfit < - extractdataframe(cestr , addnames = true )   > # extract a matrix of probeset intensities > cesex < - getchipeffectset(plmex ) > exfit < - extractdataframe(cesex , addnames = true )   > # extract a list of probe intensities per gene > unitintensities",
    "< -                readunits(csn , verbose = verbose )   ....    the high number of transcript clusters analysed in combination with the usually small number of chips tends to cause a high number of false positives @xcite . in order to reduce the number of false positives",
    ", affymetrix recommends to perform detection above background ( dabg ) @xcite on the dataset prior to the analysis @xcite .",
    "the dabg procedure is not implemented in ` aroma.affymetrix ` , so we decided to follow the procedure described in @xcite and use 3 as a threshold for the probeset intensity , so that probesets with a @xmath0 intensity below 3 will be marked as absent . except for this change , we followed the guidelines proposed in @xcite to remove absent transcript clusters and probesets , where neither probesets that are absent in more than half of the samples of a group nor transcript clusters with more than half of the probesets absent are analysed .    besides this filtering based on expression levels ,",
    "another filtering that removes probesets presenting cross - hybridization is also advisable @xcite .",
    "cross - hybridising probesets are identified in file `` huex-1_0-st - v2.na32.hg19.probeset.csv '' and removed .",
    "affymetrix recommends to filter them out after the analysis , but we have decided not to include them in the analysis in order to narrow down the number of probesets / transcript clusters to investigate .    the filtering procedure is part of the .snw file . in our example , where we analysed only core probesets , 136233 probesets out of 284258 were deemed present by our filter , and the number of transcript clusters to analyse ( present in both samples ) was reduced from 18708 to 8401 .      in this section",
    "we give an overview of model - based statistical methods available for the analysis of differential splicing and suggest a method for the analysis of differential gene expression .",
    "the analyses carried out in this paper are model - based approaches , and the analysis of differential splicing is done genewise .",
    "the models we use are extensions of the linear model by li and wong @xcite @xmath1 where @xmath2 is the intensity measure of probe @xmath3 for treatment @xmath4 , @xmath5 is a probe affinity term , @xmath6 is the gene - level estimate for treatment @xmath4 , and @xmath7 is the error term .    *",
    "anosva * ( analysis of splicing variation ) was presented by cline _",
    "_ @xcite and is a two - way anova model with probeset and treatment as factors :    @xmath8    where @xmath9 is the intensity measure of probe @xmath3 in probeset @xmath10 and treatment @xmath4 , the overall mean @xmath11 is the baseline level of all probes in all experiments , and @xmath12 and @xmath6 are the probeset and treatment effects .",
    "the interaction term @xmath13 tells whether the effect of the probeset depends on the treatment and is therefore key to the detection of differential splicing .    the model in",
    "can be extended to include random effects associated to replications from the same individual , @xmath14 : @xmath15 where @xmath16 is the random effect of each individual @xmath14 and @xmath17 is the random chip effect .",
    "the error terms @xmath18 are i.i.d",
    ". @xmath19-distributed .    under the null - hypothesis of no differential splicing",
    ", the @xmath13 s will all be zero , therefore we consider the test statistic @xmath20 where @xmath21 is the estimate for @xmath13 , and @xmath22 is the standard error of @xmath21 .",
    "large values will be critical for the null hypothesis . under the model assumptions",
    ", @xmath4 will follow a @xmath23 distribution ( * ? ? ?",
    "5 ) , with @xmath24 the total number of observations per transcript cluster , @xmath25 the number of treatments , @xmath26 the number of probesets in the transcript cluster and @xmath27 the number of individuals . for each gene , the smallest @xmath3-value from the above @xmath4-tests",
    "is regarded as a measure of confidence that the gene is differentially spliced across the experimental conditions @xcite .",
    "the interaction estimates and variances and thus the test statistics are contrast - dependent , so choosing a different contrast will alter the gene lists . in our analysis , we have used the ` sum ` contrast available in ` r ` , where parameter estimates are centred around zero .    a package in `",
    "r ` for fitting linear and generalized linear mixed - effects models is ` lme4 ` @xcite .",
    "linear mixed - effects models can also be analysed using ` lm ` , which is faster but requires a balanced design . in our example",
    "dataset we use ` lm ` to fit the model in equation ( [ eq : meanosva ] ) to the probe level estimates obtained using ` unitintensities ( ) ` from ` aroma.affymetrix ` to 8075 multiexonic transcript clusters . here , we only show the code corresponding to equation , the rest of the code is part of the .snw file .    ....",
    "> # * * user - defined parameters for linear model >",
    "lm < -   +      lm(intensity ~ probeset + treatment +   +                   c(probeset : treatment , contr.sum ) +   +                   replicate / treatment ) > n.probesets < - length(unique(dataframe$probeset ) ) > main.effects < -   +             1 + ( n.probesets - 1 ) +   +             ( length(unique(dataframe$treatment ) )",
    "- 1 )   > ds.parameters < - ( n.probesets - 1 ) * +            ( length(unique(dataframe$treatment ) ) - 1 ) > p.t < -   +      min(summary(lm)$coefficients[(main.effects+1 ) : +        ( main.effects + ds.parameters),\"pr(>|t| ) \" ] ) ....    although the vast majority of probesets contain 4 probes , transcript clusters containing probesets with less than 4 probes will give rise to an unbalanced design .",
    "nevertheless , the @xmath4-distribution is almost a normal distribution for long transcript clusters so the unbalanced design does not have any practical implications . for shorter transcript clusters ,",
    "however , an unbalanced design might be a problem .",
    "the top 10 most differentially spliced genes , sorted by the minimum @xmath3-value of their @xmath4-tests , appear in table [ tab : anosvaprobe ] .",
    "zak _ was validated as differentially spliced in @xcite .",
    "see figure [ fig : anosvaprobe ] for the profile plot of _ klk10 _",
    ", where the thick lines representing the mean intensity in each group have been plotted for easing the interpretation . note that there is one measurement per probe in each probeset , typically 4 probes per probeset .",
    "how to obtain such plots is described in section [ subsec : annotationandvisualization ] below .",
    "the genes in figures [ fig : anosvaprobe ] , [ fig : anosvaprobeset ] , [ fig : firma ] and [ fig : deprobe ] were chosen because they span over a shorter genomic region and show a more clear picture of the relationship between probesets and exons than the other genes in the lists of top 10 genes .",
    "a slight variation of anosva is the probeset - model as implemented in partek @xcite ( note that the probe subscript @xmath3 has been removed ) : @xmath28    for the probeset - level anosva we used the probeset level estimates obtained by ` affyplm ( ... , mergegroups = false ) ` . after filtering for non - present or cross - hybridising probesets , and absent transcript clusters ,",
    "we were left with 9494 transcript clusters to study .",
    "these clusters are sorted according to the minimum @xmath3-value of the individual @xmath4-test scores for differential splicing , and the top 10 genes obtained appear in table [ tab : anosvaprobeset ] . the genes _",
    "mmp11 , zak _ and _ comp _ are in the top 10 genes for both the anosva probe and the anosva probeset models . gene _",
    "tgfbi _ appears in figure [ fig : anosvaprobeset ] .",
    "* firma * ( finding isoforms using robust multichip analysis ) was first introduced by purdom _",
    "@xcite for the exon array . in presence of differential splicing the model in will not fit and this will show up in the residuals .",
    "the linear model used is the following : @xmath29 with @xmath5 the probe affinity , @xmath30 the gene - level effect for chip @xmath31 and the error terms @xmath18 are i.i.d",
    ". @xmath19-distributed .",
    "note that in contrast to the model in we do not compute an overall gene - level estimate , but a gene - level estimate per chip .    as in model",
    ", there is no treatment / probeset interaction term , so differential splicing is analysed probesetwise , using the residuals per probeset @xmath10 : @xmath32 where @xmath33 and @xmath34 are the estimates of @xmath5 and @xmath30 .",
    "the median of the standardized residuals per probeset per chip is chosen as score statistic : @xmath35 the standardization with the median absolute deviation ( mad ) of the residuals per gene makes the scores comparable across transcript clusters .",
    "the firma scores are extracted from the ` plmtr ` object obtained in section [ subsec : pre - processing ] .",
    "all probesets and transcript clusters were analysed by firma , since it is part of the default ` aroma.affymetrix ` workflow .    ....",
    "> firma < - firmamodel(plmtr ) >",
    "fit(firma , verbose = verbose ) > fs < - getfirmascores(firma ) > firma.scores < - extractdataframe(fs ) ....    after obtaining the firma scores per probeset per sample , we proceeded as described in @xcite : 1 ) for each probeset we took the difference of firma scores for each of the 10 pairs of normal / cancer samples and 2 ) calculated the mean of the 10 differences per probeset .",
    "then 3 ) we ranked the probesets according to their absolute mean difference : as the scores are comparable across transcript clusters , larger average differences between the normal and cancer samples will point at exons more differentially spliced between the two conditions .",
    "the resulting list was filtered to keep only probesets and transcript clusters that has passed the filter described in [ subsec : extractingintensities ] above , the code is part of the .snw file . in order to get a gene list instead of a probeset list as in @xcite we mapped probesets to transcript clusters and then selected the top 10 genes on the list , see table [ tab : firma ] .",
    "the profile plot of gene _",
    "lgals4 _ appears in figure [ fig : firma ] .",
    "the very high average difference for this gene is due to a firma score of 830030.8 at probeset _",
    "3861578 _ corresponding to the tumour sample of replicate 7 .    out of 14 genes investigated for differential splicing in (",
    "* table 1 ) , 10 passed our filtering procedure and were analysed for differential splicing : _",
    "actn1 , vcl , cald1 , slc3a2 , col6a3 , cttn , fn1 , mast2 , zak _ and _ fxyd6_. the gene _",
    "zak _ appears in the top 10 genes from anosva probe and anosva probeset , but a plot is not produced automatically by the code because _ zak _ is not recognised by biomart .",
    "instead , we looked the gene up in pubmed obtaining the ensembl i d : ensg00000091436 , and used this to plot the gene , see figure [ fig : zak ] .",
    "the gene _ col6a3",
    "_ appears among the top 100 genes for the anosva probe and the anosva probeset methods . gene _",
    "actn1 _ is among the top 100 genes for anosva probeset and it is also the first of gardina s genes to appear in the filtered firma list , at position 154 .",
    "+      in this section we analyse differential gene expression using probe level data .",
    "we study two types of transcript clusters : 1 ) the ones not included in the anosva probe analysis above ( with only one probeset or not present in both normal and cancer groups ) and 2 ) the ones not showing differential splicing ( anosva probe @xmath3-value above 0.1 ) . the analysis of group 2 )",
    "is based on the hierarchical principle : only look for significant main effects ( differential expression in this case ) among those transcript clusters with no significant interaction terms ( differential splicing ) @xcite . in total",
    ", we analysed 16231 transcript clusters .",
    "we fit the following linear model to those transcript clusters : @xmath36 where @xmath6 is the gene level treatment effect , @xmath12 is a parameter that captures probesets expressed above or below the overall transcript cluster level and @xmath16 and @xmath17 are random effects for patient and chip , respectively .    ....",
    "> aov < -   +     aov(intensity ~ probeset + treatment +   +             error(replicate + replicate : treatment ) ) >",
    "p.f < -   +    summary(aov)$\"error : within\"[[1]][\"treatment \" ,   +                                         \" pr(>f ) \" ] ....    the null hypothesis is that the gene expression is the same in all groups .",
    "the top 10 genes , with adjusted @xmath3-values appear in table [ tab : de ] .",
    "the method used for adjusting the @xmath3-values was benjamini - hochberg s correction @xcite using the function ` p.adjust ( ... , method = bh ) ` .",
    "only 80 out of 159 genes appearing in gardina s list of genes up- and down - regulated in tumour ( * ? ? ?",
    "* additional file 1 ) passed our filters and were analysed for differential gene expression . among those analysed , the genes _",
    "cldn1 , sst , musk , kiaa1199 _ and _ slc30a10 _ were in the top 100 .",
    "best4 _ is shown in figure [ fig : deprobe ] .",
    "this gene is down - regulated in tumour ( blue ) compared to normal ( red ) samples .",
    "the thicker lines represent the mean expression levels in the two groups .",
    ".top 10 differentially expressed genes from with corrected @xmath3-values .",
    "best4 _ , highlighted in gray , appears in figure [ fig : deprobe ] .",
    "[ tab : de ] [ cols=\"<,>\",options=\"header \" , ]      we chose to annotate transcript clusters to genes using the netaffx transcript cluster annotation release 32 specified in section [ subsec : folderandfiles ] using the ` annotategenes ( ) ` function . some transcript clusters present unspecific annotation and have several possible associated gene names .",
    "we have decided to remove such clusters from our output as we can not map them uniquely to a gene and afterwards interpret the result according to the gene structure .",
    "after gene annotation , the user can select genes for visual inspection .",
    "visual inspection of candidates for differential splicing is recommended by affymetrix as a way to identify possible false positives @xcite .",
    "plots of gene profiles with integrated genomic information are obtained using the ` biomart ` @xcite and ` genomegraphs ` @xcite packages in bioconductor .",
    "we use ` biomart ` to connect to the latest version of the homo sapiens dataset in ensembl @xcite ( ensembl genes 68 , grch37.p8 at the time of writing ) and retrieve genes by their hgnc symbol @xcite .",
    "gene and exon structures are imported from ensembl . `",
    "gene ` and ` exon ` objects are created by ` makegene ( ) ` and ` maketranscript ( ) ` from ` genomegraphs ` .",
    "we store expression data and probeset start and stop positions in an ` exonarray ` object by ` makeexonarray ( ) ` .",
    "the final plot is created passing a list with the objects created to the ` gdplot(list(exon , gene , transcript , ... ) ) ` function .",
    "our plots show on top the gene hgnc symbol followed by ( + ) for genes on the forward strand and by ( - ) for those on the reverse strand .",
    "below , the plot of probeset intensities appears with vertical lines delimiting probesets . note that for models based on probe - level data ( anosva probe , firma and differential expression ) , the intensities of all probes in the probeset ( 1 to 4 ) are shown .",
    "samples from the same treatment group appear in the same colour , red for normal samples and in blue for tumour samples in this case . immediately after the profile plot , the gene model retrieved from ensembl is shown in orange , followed by the possible transcript model(s ) in blue .",
    "the gene model consists of the exons that appear in all possible transcript models .",
    "exons ( boxes ) in the gene model are linked by blue lines to the probesets above , indicating which probeset(s ) interrogate which exon .",
    "see figures [ fig : anosvaprobe ] to [ fig : deprobe ] .",
    "the aim of this paper was to give a tutorial on how to perform a complete and reproducible analysis of exon array data in ` r`/bioconductor .",
    "we have worked with three packages : ` aroma.affymetrix ` , ` biomart ` and ` genomegraphs ` to go from .cel files to intensity data , statistical analysis , annotation and visualization .",
    "the packages were chosen for their flexibility and easy of integration .",
    "we believe that our workflow covers a number of analysis variants for the exon array , including differential splicing analysis at probe and probeset - level and differential expression analysis at probe level , and gives the user the opportunity to focus on all or only some of the aspects of the data analysis .",
    "we make our entire code available so that other researchers can use it as it is or adapt it to their needs .",
    "different bioconductor packages could have been used in some of the analysis steps .",
    "for example , ` xmapcore ` @xcite provides annotation data and cross - mappings between genetic features as transcript clusters or exons and affymetrix probesets .",
    "this package , however , requires the separate installation of a mysql database , which makes this a more complex alternative than the one we have chosen .",
    "the ` xps ` package @xcite could have been used for data pre - processing and summarization , but it requires the installation of the ` root ` framework @xcite , and a certain level of understanding of root files and root trees is recommended .",
    "our workflow does not require any prior knowledge beyond ` r`/bioconductor .",
    "other free software includes brb - array tools @xcite , based on ` r ` , c , fortran and java , with an excel front end , and dchip @xcite , which is written in visual c`++ ` and developed for windows - though some users have been able to run it on mac and unix computers .",
    "a previous paper on exon arrays @xcite suggests a pragmatic approach and does the analysis piecewise starting with affymetrix power tools ( apt ) and then exporting the data to ` r ` .",
    "we recognise this is a fix for the lack of straightforward packages for dealing with the exon array in bioconductor . however , it implies working with several pieces of software so we do not find it fit for reproducible research .",
    "licensed software , like partek @xcite or genespring gx @xcite , has been used in other studies @xcite .",
    "in contrast to licensed software , ` r`/bioconductor is free and available for anyone , it allows the user to control most analysis options and it enables customizable and reproducible analyses that are more easily reviewed .",
    "still , the ` aroma.affymetrix ` package does not provide the speed of affymetrix power tools or the licensed software , and it requires more user input .",
    "nevertheless , with this code and minimal user input , any dataset can be analysed regarding differential expression at probe level and differential splicing using the anosva model .",
    "differential gene expression could have been analysed using the gene level estimates obtained from the ` plmtr ` object in other ` r ` packages such as ` limma ` @xcite .",
    "another extension of the workflow could include a general analysis strategy of the firma scores , which in this study was tailor - made for a two - treatment scenario .",
    "besides , the profile plots we obtained with ` genomegraphs ` , though highly informative , are difficult to interpret for genes spanning over a long genomic region , as for example _ tgfbi _ in figure [ fig : anosvaprobeset ] and _ zak _ in figure [ fig : zak ] . in the future , it would be interesting to study the flexibility of the output imported from ensembl and , for example , remove the intronic regions from the gene and transcript models .",
    "the authors would like to thank henrik bengtsson for helpful answers and comments regarding ` aroma.affymetrix ` .",
    "the authors would also like to thank hang phan and anders ellern bilgrau for helpful discussions and ideas about code implementation and data plotting .",
    "mrd designed and implemented the workflow , analysed data and drafted the manuscript .",
    "rw assisted in paper drafting and statistical modelling and interpretation .",
    "jsb , sf and mkk tested the workflow .",
    "jsb , mkk , hej and kds assisted with data interpretation and participated in paper drafting .",
    "mb conceived and tested the workflow , assisted in manuscript drafting and coordinated the work .",
    "all authors read and approved the final manuscript .",
    "bengtsson h , simpson k , bullard j , et  al .",
    ": a generic framework in r for analyzing small to very large affymetrix data sets in bounded memory . technical report 745 , department of statistics , university of california , berkeley , 2008 ."
  ],
  "abstract_text": [
    "<S> alternative splicing is the post - transcriptional process by which a single gene can produce multiple transcripts and thereby protein isoforms . </S>",
    "<S> the presence of different transcripts of a gene across samples can be analysed by whole - transcriptome microarrays . reproducing results from published microarray data </S>",
    "<S> represents a challenge due to the vast amounts of data and the large variety of pre - processing and filtering steps employed before the actual analysis is carried out . to ensure a firm basis for methodological development where results with new methods are compared with previous results </S>",
    "<S> it is crucial to ensure that all analyses are completely reproducible for other researchers .    </S>",
    "<S> we here give a detailed workflow on how to perform reproducible analysis of the genechip  human exon 1.0 st array at probe and probeset level solely in ` r`/bioconductor , choosing packages based on their simplicity of use . to exemplify the use of the proposed workflow we analyse differential splicing and differential gene expression in a publicly available dataset using various statistical methods .    </S>",
    "<S> we believe this study will provide other researchers with an easy way of accessing gene expression data at different annotation levels and with the sufficient details needed for developing their own tools for reproducible analysis of the genechip  human exon 1.0 st array . + * contact : * maria@math.aau.dk </S>"
  ]
}