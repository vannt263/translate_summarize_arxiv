{
  "article_text": [
    "as molecular dynamics ( md ) is limited to microscopic systems and time scales , most chemical or biological reactions can not be simulated using straightforward md .",
    "one can literally wait ages before detecting a single event in a typical computer simulation . in the early 1930s ,",
    "wigner and eyring made the first attempts to overcome this problem by introducing the concept of the transition state ( ts ) and the so - called ts theory ( tst ) approximation  @xcite .",
    "later on , keck @xcite demonstrated how to calculate the dynamical correction , the transmission coefficient .",
    "this work has later been extended by bennett  @xcite , chandler  @xcite and others  @xcite , resulting in a two - step approach .",
    "first the free energy as function of a reaction coordinate ( rc ) is determined .",
    "this can be done by e.g. umbrella sampling ( us ) @xcite or thermodynamic integration ( ti )  @xcite .",
    "then , the maximum of this free energy profile defines the approximate ts dividing surface and the transmission coefficient can be calculated by releasing dynamical trajectories from the top .",
    "this approach is , in principle , exact and independent of the choice of rc .",
    "however , the method becomes inefficient when the transmission coefficient is small .",
    "a proper choice of the rc can maximize the transmission coefficient and is hence crucial for the efficiency of the method .",
    "there exist different formalisms for the transmission coefficient formula which differ in the way trajectories are counted .",
    "we discuss the standard bennett - chandler ( bc )  @xcite , the history dependent bc ( bc2 )  @xcite , and the effective positive flux ( epf )  @xcite formalism .",
    "we show that the latter should always be preferred due to a lower average pathlength and a faster convergence .",
    "however , whenever a lot of correlated recrossings occur , the transmission coefficient will be very low and all these methods become inefficient .",
    "in high dimensional complex systems it can be a very difficult task to find a proper rc . moreover , whenever the dynamics is diffusive , even an optimal rc can result in a very low transmission and hence a poor efficiency .",
    "a new approach came with transition path sampling ( tps )  @xcite that is not based on the free energy barrier as starting point .",
    "tps is rather an importance sampling of dynamical trajectories .",
    "hence , it is a monte carlo ( mc ) sampling in path space rather than phase space .",
    "the tps method has been advocated as a method that does not need a rc and is akin to throwing ropes in the dark  @xcite .",
    "this might be true if one wants to sample a set of reactive trajectories , but it is not for the calculation of reaction rates .",
    "in fact , the original approach to calculate reaction rates within the framework of tps required the definition of an order parameter and the calculation of the reversible work when the endpoint of the path is dragged along this parameter . for the sampling of reactive pathways ,",
    "the order parameter needs only to distinguish between the two stable states .",
    "however , in the algorithmic procedure to calculate reaction rates with tps , the order parameter becomes very similar to a rc .",
    "still , it has been speculated that this approach is less sensitive to the problems related to an improper rc ( or order parameter ) .",
    "indeed , in this article we prove for the first time that this is true using the approach of transition interface sampling ( tis )  @xcite .",
    "tis increases the efficiency of the original tps rate calculation considerably by allowing the pathlength to vary and by counting only positive effective crossings .",
    "the overall reaction rate in tis is obtained from an importance sampling technique that uses a discrete set of interfaces between the stable states .",
    "hence , tis could be considered a dynamical analogue of us in path space . for diffusive systems the partial path tis ( pptis )",
    "was invented that uses the assumption of memory loss  @xcite . in this article",
    "we discuss the case of sharp barriers . here",
    "recrossings occur mainly due to the wrong choice of rc . in a follow - up article",
    "we will treat the diffusive case .    up to now , it is not clear how these methods compare in efficiency and the need for benchmark systems has been put forward several times .",
    "it is not always easy to perform comparative calculations since it is not simple to know if each method is equally optimized for a specific system .",
    "therefore , in this paper we analyze a system for which the efficiency of the methods can be calculated analytically with only a few approximations .",
    "this does not only give a transparent comparison of the efficiency of the different methods , but also allows to obtain scaling laws for how this efficiency changes as function of the barrier height and width .",
    "moreover , we give some rules for how the methods can be optimized , for instance , by choosing the proper width of the us windows and the position of interfaces in tis .",
    "these rules are important for the simulation community , as they can be used as a rule of thumb in daily practice , when any method needs to be optimized",
    ".    the principal component to measure the efficiency of the methods will be the _ cpu efficiency time _",
    "@xmath0 which is the lowest computational cost needed to obtain an overall statistical error equal to one .",
    "we give a detailed analysis of how @xmath0 can be calculated for some very general cases in the appendix sections  [ sgn ] and  [ secect ] .",
    "it also gives the important result of how one should divide a total fixed simulation time over a set of different simulations to obtain the best overall efficiency . in sec .",
    "[ secmet1 ] , we outline the first class of methods , the reactive flux ( rf ) methods , and present their principal formulas . in sec .",
    "[ secmet2 ] , we do the same for the second class of methods , the path sampling methods .",
    "[ secsys ] introduces the 2d benchmark system where the angle @xmath1 indicates how far the chosen rc is deviated from the optimal one .",
    "[ secres ] is the main section of our paper in which we apply the different methods of sec .",
    "[ secmet1 ] and [ secmet2 ] to the analytical benchmark system of sec .",
    "[ secsys ] . finally , we discuss the important point of hysteresis for the two types of methods and show that this is less likely to occur for the path sampling methods .",
    "we summarize the results in sec .",
    "[ seccon ] .",
    "moreover , to support the readability of this paper we have added a list of symbols and abbreviations in app .",
    "[ alos ] and [ aloa ] .",
    "in all combined free energy and transmission coefficient based methods , the rate equation follows from @xmath2 where the reaction rate @xmath3 is expressed as a quasi - plateau value at a time @xmath4 of a time dependent reaction rate function @xmath5 .",
    "this function is given by the corrected flux through an hypersurface @xmath6 , that is is a collection of phase points @xmath7 , defined by the reaction coordinate @xmath8 and transition state ( ts ) value @xmath9 . the ts value @xmath9 is standardly taken as the maximum in the free energy profile along @xmath10 .",
    "both tst , bc , bc2 and epf can be expressed as @xmath11 { \\rangle}}{{\\langle}\\theta(\\lambda^*-\\lambda(x_0 ) ) { \\rangle } } , \\label{kgen}\\end{aligned}\\ ] ] where @xmath12 is the dirac delta function , @xmath13 the heaviside step function , @xmath14 is the phase point at a time @xmath15 , and @xmath16 is a trajectory that includes @xmath17 .",
    "ensemble averages @xmath18 in phase and path space are defined in app .",
    "[ subsensem ] .",
    "( [ kgen ] ) measures the flux contributed by pathways leaving the surface @xmath9 at @xmath19 under the influence of a correction functional @xmath20 $ ] .",
    "the functional @xmath21 has different forms for tst , bc , bc2 , and epf .",
    "the rate equation  ( [ kgen ] ) can be rewritten as a product of two factors : the probability to be on top of the barrier times the transmission function @xmath22 : @xmath23 with @xmath24 and @xmath25 { \\rangle}_{\\delta(\\lambda(x_0)-\\lambda^*)}.   \\label{defr}\\end{aligned}\\ ] ] here , @xmath26 implies that the ensemble @xmath27 is constrained at the surface @xmath28 .",
    "substitution of eqs .",
    "( [ defr],[defrp ] ) in eq .",
    "( [ kpk ] ) using eq .",
    "( [ wens ] ) gives back eq .",
    "( [ kgen ] ) .    eqs .",
    "( [ kpk]-[defrp ] ) show the two - step procedure .",
    "the probability @xmath29 and the time dependent transmission function @xmath22 are calculated in two separate simulations .",
    "as for the rate @xmath3 , the unnormalized transmission coefficient @xmath30 follows from a plateau in this time dependent function : @xmath31 .",
    "this factor corrects for the correlated recrossings . in  [ subsfe ] , we discuss the methods to compute @xmath29 or , equivalently , the free energy barrier @xmath32 .",
    "then , in  [ sectrans ] we discuss the methods to determine the transmission coefficient @xmath30 .",
    "define the following @xmath33 box functions : @xmath34           \\theta[\\lambda_r+i\\gamma+\\gamma-\\lambda(x ) ] , \\nonumber \\\\ w_m(x)&=\\theta[\\lambda(x)+d\\lambda-\\lambda^ * ]          \\theta[\\lambda^*-\\lambda(x ) ] ,   \\nonumber \\\\",
    "w_0(x)&=\\theta[\\lambda^*-\\lambda(x ) ] , \\label{windows1 } \\\\",
    "w_j(x)&= \\theta[\\lambda(x)-\\lambda_r-(j-1 ) \\gamma ] \\theta[\\lambda_r+j \\gamma+\\gamma   - \\lambda(x ) ] , \\nonumber \\end{aligned}\\ ] ] with @xmath35 and @xmath36 . here",
    "@xmath9 is the ts , @xmath37 is a value in the reactant well and @xmath38 is a small length scale . @xmath39 and @xmath40 represent the dimensions of the us windows ; @xmath41 is the width of the window and @xmath39 is the overlap such that @xmath42 ( see fig .  [ umbrel ] ) .    neglecting higher orders terms in @xmath38 , we can write @xmath43 to calculate eq .",
    "( [ freeensam ] ) , we can simply run an md simulation and count the number of times that the transition state region interval is visited .",
    "the weight function @xmath44 in the ensemble acts like an infinite wall at @xmath45 and prevents the unnecessary exploration of the product region .",
    "however , as @xmath46 is vanishingly small for high barriers , this straight - forward method will usually fail .",
    "using eq .",
    "( [ wens ] ) and the relations @xmath47 , @xmath48 for all @xmath49 we can rewrite eq .",
    "( [ freeensam ] ) as @xmath50 the final property is now calculated from a series of simulations in which each pair @xmath51 so that they can be determined accurately .",
    "the implementation of us using rectangular windows via mc is straightforward . the standard mc sampling is performed starting from a point inside the window .",
    "as soon as the mc procedure generates a point outside this window , this point is automatically rejected and the old point is kept .",
    "if the procedure is performed by means of md , the window boundaries simply act as infinitely hard walls .",
    "however , due to practical problems related to a discontinuous force profile , md simulations are usually performed with parabolic windows instead of rectangular ones .      instead of performing several simulations using rectangular windows , one can also use a single biasing function @xmath52 : @xmath53 again , the equivalence between eq .",
    "( [ freeensam ] ) and eq .",
    "( [ ussb ] ) is easy to prove via eq .",
    "( [ wens ] ) . the advantage of eq .",
    "( [ ussb ] ) is that the error does not propagate as in the case of several windows . on the other hand",
    ", one needs to have already a good idea about the shape of the barrier to construct a good bias @xmath54 .",
    "the series of rectangular windows is a more robust way to explore the barrier region when no knowledge is available .",
    "the algorithmic procedure to sample points in the biased ensemble @xmath55 is explained in sec .",
    "[ subsensem ] .",
    "many other methods exist for the calculation of free energy surfaces .",
    "ti is of equally importance and is based on the constrained sampling at surfaces from which the free energy s derivative can be obtained at a given value of @xmath10 .",
    "integration of these derivatives results in the requested free energy profile .",
    "in addition , many variations of us have been devised , such as wang - landau sampling  @xcite , meta dynamics  @xcite , and flooding  @xcite , where the optimal biasing potential is created on the fly .        in tst ,",
    "all pathways leading towards the product site @xmath56 are assumed to stay in @xmath56 for a very long time .",
    "the tst approximation uses eq .",
    "( [ defr ] ) with @xmath57=   \\theta(\\dot{\\lambda}(x_0 ) ) .",
    "\\label{chitst}\\end{aligned}\\ ] ] if the barrier is sharp and a proper rc is taken , tst is a very good approximation or can even be exact .",
    "the calculation of @xmath30 , in tst , requires a simple numerical or analytical calculation .",
    "for instance , suppose that @xmath10 is a simple cartesian coordinate with mass @xmath58 , then @xmath59 and @xmath60 therefore , the free energy profile is sufficient to obtain @xmath3 whenever tst is valid .",
    "the bc equation is obtained using @xmath61 = \\theta[\\lambda(x_t)-\\lambda^ * ]   \\label{chibc}\\end{aligned}\\ ] ] in eq .",
    "( [ defr ] ) .",
    "the evaluation of @xmath22 in eq .",
    "( [ defr ] ) consists of releasing many trajectories that start from the top of the barrier .",
    "these trajectories only make a contribution different from zero if they end up at the product side of the barrier .",
    "it is important to note that a trajectory with @xmath62 that leaves the surface heading to the reactant state @xmath63 but finally ends up at the product state @xmath56 at a time @xmath15 , gives a negative contribution . the final value , which has to be positive per definition , results from a cancellation of positive and negative terms .      the bc2 equation uses @xmath64 & = \\theta[\\lambda(x_t)-\\lambda^ * ]   \\theta[\\lambda^*-\\lambda(x_{-t } ) ] .",
    "\\label{chibc2}\\end{aligned}\\ ] ] here , besides ending in the product state , the trajectories integrated backward in time also have to end in the reactant state to give a nonzero contribution to eq .",
    "( [ defr ] ) .",
    "however , here as well , the contribution of some trajectories are negative .",
    "this happens when the systems starts with a negative @xmath65 , but the forward and backward trajectories end up in the product @xmath56 and reactant state @xmath63 , respectively .",
    "these so - called s - curves ( trajectories that cross the ts surface more than 2 times within a short time ) are less likely to occur for sharp barriers .",
    "the epf equation arises when we take @xmath20=\\chi^{\\rm epf}[x , t]$ ] in eq .",
    "( [ defr ] ) with @xmath66 & = \\begin{cases } 0 , & \\textrm{if } \\dot{\\lambda}(x_0 ) < 0,\\\\   & \\textrm{or if } \\lambda_{t ' } >   \\lambda^ * \\textrm { for any } t ' \\in [ -t:0],\\\\   & \\textrm{or if } \\lambda(x_t ) < \\lambda^ * , \\\\ 1 , & \\textrm{otherwise . } \\end{cases } \\label{chiepf}\\end{aligned}\\ ] ] despite the apparent mathematical more complicated form of eq .",
    "( [ chiepf ] ) compared to eqs .",
    "( [ chibc ] ) and ( [ chibc2 ] ) , the relation is quite is natural .",
    "the approach counts only the first crossings and only when they are in the positive direction ( see fig .",
    "[ figepf ] ) .    in the effective flux formalism ( [ chiepf ] ) , all contributions are either zero or positive . in ref .",
    "[ ] , we presented a similar transmission coefficient formula .",
    "in this approach the pathway was stopped whenever the stable state regions @xmath63 and @xmath56 were reached . for a formal mathematical proof of the equivalence between bc- and epf - type equations see ref .",
    "[ ] .      some other relations for the transmission different from eq .",
    "( [ chibc]-[chiepf ] ) have been proposed .",
    "for instance , hummer  @xcite proposed a relation that uses all the crossing velocities , in case of correlated recrossings , instead of just @xmath65 .",
    "ruiz - montero _ et al . _",
    "@xcite devised a transition zone method for diffusive barrier crossings .",
    "this will be treated in more detail in the follow up article that will discuss the diffusive barrier case .",
    "suppose @xmath67 and @xmath68 are such that any @xmath7 with @xmath69 is at the reactant side @xmath63 and any @xmath7 with @xmath70 is at the product side @xmath56 of the unknown optimal ts dividing surface .",
    "it is important to note that @xmath8 does not have to be a proper rc to fulfill this criterion , but only has to distinguish between the two stable states .",
    "the tis expression is now given by @xmath71 here @xmath72 gives the flux through interface @xmath67 and @xmath73 is a history dependent function describing whether the system was more recently in @xmath63 or in @xmath56 : @xmath74 , for a phase point @xmath7 and its corresponding trajectory , if the system was more recently in @xmath63 than in @xmath56 and @xmath75 otherwise . in practice , the whole factor @xmath76 is calculated by counting the number of crossings in a straight - forward md simulation , divided by the number of cycles with @xmath74 , divided by the time step @xmath77 .",
    "the calculation of this factor is very cheap as interface @xmath67 is very close to the basin of attraction of state @xmath63 . on the other hand ,",
    "the crossing probability @xmath78 is a very small number and can not be accurately determined by straightforward md .",
    "this is the probability that whenever the system crosses interface @xmath67 , it will cross interface @xmath79 before crossing interface @xmath67 again . as interface",
    "@xmath79 is an interface at the other side of the barrier , this probability is very small .",
    "the tis method overcomes this by defining @xmath80 interfaces between @xmath81 and @xmath82 .",
    "then , the total crossing probability can be expressed in a formula that contains conditional short - distance crossing probabilities  @xcite @xmath83 here , @xmath84 is a generalization of the previously described overall crossing probability and denotes the conditional probability that , whenever the system leaves state @xmath63 by crossing @xmath67 and crosses @xmath85 in turn , it will also cross @xmath86 before returning to @xmath63 .",
    "if the distances @xmath87 are sufficiently small , the probabilities @xmath84 will be large enough so that they can be computed using a shooting algorithm  @xcite .",
    "the shooting algorithm takes a random time slice from the old existing path and makes a slight randomized modification of this phase point ( usually only the momenta are changed ) .",
    "then , this new phase point is used to propagate forward and backward in time yielding a new trajectory . in tis , this propagation of the trajectory is stopped whenever the system enters @xmath63 or @xmath56 or , equivalently , whenever @xmath88 or @xmath89 are crossed .",
    "the pathway is accepted only if the backward trajectory ends in @xmath63 _ and _ the total trajectory has at least one crossing with @xmath85 .",
    "the fraction of these paths that cross @xmath86 as well , determines @xmath84 . although the form of eq .",
    "( [ tiseq ] ) deceptively resembles a markovian factorization , no assumption has been made .",
    "as @xmath84 are not simple hopping probabilities , but incorporate the full history - dependence from @xmath67 to @xmath85 , the relation is actually non - markovian and exact  @xcite .      in analogy with us , instead of using a discrete set of interfaces , we could also bias the trajectory in a continuous way using a bias on @xmath90  @xcite .",
    "first we can write @xmath91-\\lambda_b ) { \\rangle}. \\label{plm}\\end{aligned}\\ ] ] here @xmath92 where the path @xmath16 is terminated when it leaves @xmath63 and enters region @xmath63 or @xmath56 . then , as in eq .",
    "( [ ussb ] ) we can write @xmath93-\\lambda_b ) \\omega^{-1}(\\lambda_{\\max } ) { \\rangle}_{\\omega } } { { \\langle}\\omega^{-1}(\\lambda_{\\max } ) { \\rangle}_{\\omega } } .\\end{aligned}\\ ] ] the algorithmic procedure would be the same as tis without the interface crossing constraint . instead , the acceptance - rejection criterion is adjusted as explained in sec .",
    "[ subsensem ] .",
    "a continuous bias has been applied within the original tps scheme . in ref .  [ ] a bias on the end point of the path was used .",
    "alternatively , one can also bias the direction of the momenta change at the shooting point as was done in ref .",
    "the original tps rate calculation algorithm was introduced in refs .",
    "it first creates ensemble of reactive trajectories of a fixed length .",
    "these trajectories should constitute a time interval that is longer than @xmath4 where @xmath5 reach its plateau .",
    "then , a second series of simulations is required that combines the mc of pathways with a us technique .",
    "also these simulations use a fixed pathlength , but these can be shorter using a rescaling approach  @xcite . in the end ,",
    "the final rate constant can be constructed from the results of these two types of simulations .",
    "moroni showed that this algorithm is always less efficient than the tis technique and that the computational advancement of tis is at least a factor two  @xcite .",
    "the tis improvement is partly due to the flexible pathlength so that each individual path can be limited to its strictly necessary minimum .",
    "moreover , tis has abandoned the shifting moves and has a stronger convergence ( no cancellation positive and negative terms ) .",
    "depending on the system and the required accuracy , the tis approach can easily become more than an order of magnitude faster than the original approach .",
    "the pptis method reduces the average pathlength even further as compared to tis using the assumption of memory - loss  @xcite . in this method ,",
    "the trajectories do not have to start at @xmath67 . instead",
    ", an ensemble of trajectories is generated that start and end at either @xmath86 or @xmath94 , but must have at least one crossing with the middle interface @xmath85 . from this , four crossing probabilities can be constructed that still inhibit some history dependence . once these are known for each @xmath49 , the final overall crossing probability can be constructed via a recursive relation  @xcite .",
    "the milestoning method  @xcite is very similar to pptis , but relies on a stronger markovian assumption that the system remains in an equilibrium distribution at each interface .",
    "on the other hand , milestoning uses time - dependent hopping probabilities which supplies a very general way to coarse - grain a dynamical system .",
    "the two aspects of pptis and milestoning could be combined as was suggested in ref .",
    "[ ] .    finally , we mention forward flux sampling ( ffs )  @xcite .",
    "ffs uses the same rate equation  ( [ tiseq ] ) as tis , but the sampling is different . in ffs",
    "@xcite , the crossing points at the next interface of the successful pathways are stored .",
    "the next simulation uses this set of points to initiate new pathways .",
    "the advantage is that ffs does not require any knowledge on the distribution @xmath95 .",
    "this allows to treat non - equilibrium systems as well .",
    "moreover , ffs creates effectively more pathways than tis with the same amount of md steps and does not rely on a markovian assumption as in pptis .",
    "however , the correlation between the different pathways is much stronger than in tis or pptis . therefore , ffs can only be applied when the process is sufficiently stochastic .",
    "we consider the following 2d potential : @xmath96 with @xmath97 and @xmath98 here , @xmath99 is the height of our barrier , @xmath100 is the barrier width and @xmath101 are the dimensions of the reactant region ( see fig .",
    "[ f2d ] ) .    ) . @xmath99 and @xmath100 are the barrier height and width . @xmath102 and @xmath103 are the dimensions of the reactant ( and product ) well .",
    "@xmath104 is the assumed rc , while @xmath105 is another important degree of freedom . @xmath106 and @xmath107 are the maxima of the free energy functions for these coordinates .",
    "@xmath1 is the angle between the chosen reaction coordinate @xmath104 and the optimal one @xmath108 of eq .",
    "( [ lamortho ] ) .",
    "[ f2d],width=302 ]    the chosen rc is @xmath104 , while @xmath105 represents another important degrees of freedom .",
    "@xmath108 is the unknown optimal rc as its direction is orthogonal to the barrier ridge , the exact ts dividing surface .",
    "the angle @xmath1 is , hence , a measure of the quality of the chosen rc .    to facilitate the analytics we assume a simplified dynamics :",
    "the particles propagate without dissipation and move only along the @xmath104 direction .",
    "once they collide with the walls , they obtain a new random @xmath105 coordinate @xmath109 $ ] and velocities @xmath110 taken from a maxwellian distribution .",
    "this type of dynamics satisfies ergodicity and ensures that the reaction rate is well defined for high barriers .",
    "although the low dimensionality and this dynamics might seem artificial , this minimalistic model already illustrates clearly the problems that occur in complex systems when no adequate rc can be found as we will see in the forth - coming sections .",
    "moreover , the potential can be viewed as a projection of a high - dimensional complex system . in that case , eq .",
    "( [ v2d ] ) represents a free energy in which @xmath104 and ( the unknown but important coordinate ) @xmath105 can be any non - linear function of all cartesian coordinates . for instance",
    ", @xmath104 could be the simple distance between two atoms to describe the formation or breaking of a bond , while @xmath105 represents a complex solvent rearrangement .",
    "the surface potential energy at the barrier @xmath111 equals @xmath112 and , hence , @xmath113 here , we assumed that @xmath114 .",
    "the transmission coefficient can be obtained using eq .",
    "( [ defr ] ) and @xmath115 of eqs .",
    "( [ chibc2],[chiepf ] ) .",
    "the two equations are identical since there are no trajectories that can cross the surface @xmath116 more than two times before colliding with the outer walls . eqs .",
    "( [ chibc2],[chiepf ] ) have only non - zero contributions whenever the backward and forward trajectory end , respectively , at the left and right side of the barrier after a short time @xmath4 , which is deterministically determined by @xmath117 .",
    "hence , @xmath118=\\chi(\\dot{\\lambda}_x , \\lambda_y)|_{t=0}=   \\theta[\\dot{\\lambda}_x-\\sqrt{2(h - v(\\lambda_x^*,\\lambda_y))/m}]$ ] , which gives @xmath119 with @xmath120 hence , @xmath121 which yields by eq .",
    "( [ kpk ] ) @xmath122 the reaction rate is , thus , independent of the angle @xmath1 .",
    "to quantify the efficiency of the different methods , we will calculate the cpu efficiency time , @xmath0 , that is defined as the minimal computational cost to obtain an overall relative error equal to one .",
    "efficiency _ is sometimes defined as the inverse @xmath123 of this quantity  @xcite . in app .",
    "[ secect ] , we show how this quantity can be computed for some very generic cases . as the force calculations are the predominant steps in any ab initio or large scale classical simulations , all cpu values will be expressed as an integer representing the number of required md steps . in this way",
    ", we obtain a measure that is independent of the computational resources .    in the following ,",
    "we make two assumptions :    * the correlation number is assumed to be the same for each simulation @xmath49 in the simulation series : @xmath124 * the mean cycle length @xmath125 of the path - simulations and transmission coefficient calculations are proportional to the average pathlength @xmath126 of the accepted paths : @xmath127    where @xmath128 are given in app .",
    "[ sgn ] and [ secect ] and @xmath129 is the average number of md steps of the accepted trajectories .",
    "hence , we neglect the fact that @xmath130 and @xmath131 can differ for each simulation @xmath49 in a simulation series . in fact , the equations that we will derive for tis are true even if a softer assumption is valid , i.e. that @xmath132 is constant for each @xmath49 . in general , @xmath133 is smaller than 1 as rejected pathways are usually shorter than the accepted ones .",
    "some rejections are even immediate  @xcite and do not require any force calculations .",
    "the transmission coefficient calculation has @xmath134 as each point on the ts , obtained from the first free energy calculation , with randomized maxwellian distributed velocities is automatically accepted .",
    "still , the pathlengths @xmath129 can differ .      as explained in sec .",
    "[ secmet1 ] , the rf methods consist of two independent types of calculations : the free energy and the transmission coefficient calculation .",
    "moreover , there exist several techniques to determine these two quantities . as the tst approximation  ( [ rtst ] )",
    "is exact for the @xmath135 case ( which basically reduces the problem to one - dimension ) , the only computational cost follows from the free energy calculation .",
    "contrary , when @xmath1 is significantly larger than zero we can expect that the transmission coefficient calculation is the dominant computational factor even though the free energy calculation becomes problematic as well ( see sec .",
    "[ susechys ] ) . focusing on the most dominant contributions we will therefore assume @xmath135 for the free energy and @xmath136 for the transmission coefficient calculations .      first , to compare the enhanced efficiency of us techniques we need to know the cpu efficiency time @xmath0 of straightforward md .",
    "examination of eq .",
    "( [ freeensam ] ) reveals that it simply corresponds to the calculation of the ensemble average of a binary function as in eq .",
    "( [ taubin ] ) with @xmath137 .",
    "henceforth , using our assumptions  ( [ assum],[asstaucyc ] ) we have @xmath138 .",
    "it is clear that the exponentially dependence on @xmath139 make straightforward",
    "md prohibitive for any high barrier or low temperature system .    to obtain the overall efficiency for us using rectangular windows as expressed in eq .",
    "( [ usrw ] ) , we first need the efficiency time @xmath140 for a single window .",
    "the principal result of this simulation @xmath49 equals @xmath141 . the general approach to calculate the efficiency time for a composite of two averages that are obtained simultaneously within the same simulation is explained in sec .",
    "[ subscq ] . in the app .",
    "[ uscpu ] , eqs .",
    "( [ covij]-[partcov ] ) , we derive that the efficiency time for this single window is given by @xmath142 where @xmath143 . here",
    ", @xmath144 is a system - specific parameter , @xmath145 is an intrinsic of the simulation , and @xmath39 and @xmath40 have to be optimized .",
    "if we assume that @xmath146 is very large , we can neglect the difference of the first @xmath44 and last @xmath147 windows .",
    "following eq .",
    "( [ effconst ] ) , the overall efficiency time is given by @xmath148 and as @xmath149 is not dependent on @xmath39 , we can minimize @xmath140 as function of @xmath39 to obtain also the lowest overall efficiency time .",
    "this optimum is achieved for half infinite windows @xmath150 where @xmath151 for all @xmath49 . as a result",
    ", the overall efficiency time equals @xmath152 eq .",
    "( [ tefftot ] ) has a minimum for @xmath153 which gives @xmath154 the efficiency time is quadratically dependent on the barrier height @xmath99 and the inverse temperature @xmath155 .",
    "compared to straightforward md this is an enormous improvement .",
    "the optimal window boundaries imply that the fraction of phase points that is sampled in the right part of the window is given by @xmath156 .",
    "hence , @xmath40 should be adjusted to have approximately one fifth of the sampled points in the most right up - hill part of the window .      in appendix",
    "[ uscpu ] , eqs .",
    "( [ sigmacovw],[teffbcw ] ) , we derive the efficiency time for an ensemble average @xmath157 when it is obtained via a different ensemble using a weight function @xmath54 : @xmath158 .",
    "then , @xmath0 is given by : @xmath159 \\nonumber \\\\ & + \\big({\\langle}\\omega^{-1}{\\rangle}{\\langle}\\omega { \\rangle}-1 \\big ) \\big [ 1 + 2 n_c^{cc } \\big ] \\nonumber \\\\ & - 2 \\big ( \\frac{{\\langle}\\hat{a } \\omega^{-1}{\\rangle}{\\langle}\\omega { \\rangle}}{a } -1 \\big ) \\big [ 1 + n_c^{bc } + n_c^{cb } \\big ] \\big\\ } \\tau_{\\rm cyc } \\label{teffbias}\\end{aligned}\\ ] ] with @xmath160 and @xmath161 .",
    "note that the correlation functions @xmath162 ( and @xmath163 for path sampling ) can depend in principle on @xmath54 as well . as eq .",
    "( [ teffbias ] ) does not change whenever @xmath54 is multiplied by a single factor , we apply the normalization @xmath164 . assuming that eqs .",
    "( [ assum],[asstaucyc ] ) are also valid in the biased ensemble , we write @xmath165 if we assume that @xmath145 has only a weak dependency on @xmath54 , we can minimize eq .",
    "( [ teffbias2 ] ) by taking the functional derivative @xmath166 which gives ( see eqs .",
    "( [ taueffbiasl]-[w2 ] ) ) @xmath167 as optimal weight function .",
    "coming back to eq .",
    "( [ ussb ] ) using @xmath168 , the optimal bias follows directly from eq .",
    "( [ optw ] ) and is given by @xmath169 where we used eq .",
    "( [ freeensam ] ) and @xmath170 . substitution of eq .",
    "( [ bias ] ) and @xmath171 in eq .",
    "( [ teffbias2 ] ) and using that @xmath172 ^ 2 $ ] and @xmath173 gives @xmath174 hence , a scaling behavior independent of the barrier height or system size can be achieved .",
    "we have assumed here that @xmath145 is independent of the biasing function @xmath54 which is only true for certain types of mc such as those in which each cycle can be generated really independently ( hence @xmath175 ) . in general , mc sampling is a diffusive type of motion and the bias  ( [ optw],[bias ] ) should also aid the exploration from the top to the reactant well and back .",
    "therefore optimal bias function should result in a more or less uniform sampling distribution , which is achieved when @xmath176 .",
    "taking this into account , the efficiency time is a bit larger @xmath177 , but still independent of @xmath139 .      for the reasons explained in sec .",
    "[ eff1d ] , here we will study the case @xmath178 and , in particular , we assume that @xmath179 . substituting @xmath180=\\chi[x]$ ] in eq .",
    "( [ taueff ] ) and using eqs .",
    "( [ std],[defr],[r2d],[assum],[asstaucyc ] ) , we can write a general formula for the cpu efficiency time @xmath0 for the rf method : @xmath181 where we used @xmath182 . we remind you that @xmath134 for the transmission algorithm as all generated phase points on the surface @xmath106 are accepted and used to generate trajectories . in [ bc2d ] and [ bc22d ] , we will use formula ( [ teffr2d ] ) to calculate the efficiency of the bc , bc2 and epf method .",
    "[ [ bc2d ] ] bc ^^    in the bc algorithm the pathways are propagated only forward in time .",
    "say @xmath183 is the longest time that the system takes to leave the barrier when released somewhere at the surface @xmath106 . hence , to have a guaranteed plateau in the @xmath184 and @xmath5 functions we simply have to integrate @xmath185 timesteps so that @xmath186 . the second unknown factor in eq .",
    "( [ teffr2d ] ) is @xmath187 . for the simplified dynamics we are considering eq .",
    "( [ chibc ] ) can be reduced to @xmath188 with @xmath189 and @xmath190 . following the same lines as in eqs .",
    "( [ r2d0]-[r2d ] ) gives @xmath191 with @xmath192}{\\int { { \\mathrm d}}v e^{-\\beta \\frac{1}{2 } m v^2}}. \\label{fbc}\\end{aligned}\\ ] ] in eqs .",
    "( [ v2chibc],[fbc ] ) we made use of the mirror symmetry along @xmath107 .",
    "as the gaussian integral  ( [ fbc ] ) has a symmetry as well along the @xmath193 axis , we can rewrite eq .",
    "( [ fbc ] ) as follows @xmath194 substitution of eq .",
    "( [ fbc2 ] ) in eq .",
    "( [ v2chibc ] ) reduces eq .",
    "( [ teffr2d ] ) to @xmath195 for large barriers , the exponential dependence on @xmath196 makes the method already prohibitive for relatively small angles @xmath1 .",
    "in bc2 the trajectories have to be followed until both forward and backward trajectories are no longer on the barrier . in epf ,",
    "the generated point on the surface heading toward reactant state are accepted , but assigned zero without further integration .",
    "points on the surface with a positive velocity are first integrated backward and , then , integrated forward in time .",
    "this gives the advantage that whenever the backward trajectory recrosses the surface @xmath106 within a short period , this trajectory s contribution is assigned zero as well and the forward trajectory can be omitted .",
    "hence , we have @xmath197 and @xmath198    moreover , as s - curves are absent in this system the two path - functionals are identical : @xmath199=\\chi^{\\rm epf}[x]$ ] for all @xmath16 .",
    "a non - zero contribution of @xmath21 occurs only when both the backward trajectory ends in the reactant state and the forward trajectory ends in the product state .",
    "this implies that the velocity @xmath200 should be positive with kinetic energy higher than @xmath201 .",
    "hence , @xmath202 therefore , we can write the same equations as ( [ v2chibc],[fbc ] ) with @xmath203 instead of @xmath204 in eq .",
    "( [ fbc ] ) , which gives @xmath205\\end{aligned}\\ ] ] we can neglect the @xmath206-term by invoking  eq .  ( [ erfc ] ) and omitting the terms of order @xmath207^{-1/2})$ ] .",
    "substitution of this in eq .",
    "( [ v2chibc ] ) gives @xmath208 and , hence , eq .",
    "( [ teffr2d ] ) yields @xmath209 although , the efficiency of eq .",
    "( [ tbc2epf ] ) has been quadratically improved compared to eq .",
    "( [ tbc2d ] ) , the exponential dependence of @xmath210 makes this method prohibitive as well when @xmath1 is significantly different from zero .",
    "as for the rf methods , the tis methods consist also of two types of simulations : the initial flux through @xmath88 and the crossing probability . however , contrary to the rf methods , in tis we might expect that the crossing probability is always the computational bottleneck . as @xmath88 is placed in the low potential energy region at the foot of the barrier , this flux is easy to compute for all values of @xmath1 .",
    "we will henceforth concentrate on the crossing probability for the two cases @xmath135 and @xmath211 .",
    "say @xmath212 , @xmath213 , and @xmath214 .",
    "for the pathlength we write @xmath215 where the constants @xmath216 and @xmath217 will be determined later on .",
    "as @xmath218 is basically an average of a binary function , that is 1 for the successful trajectories and 0 otherwise , we can invoke eq .",
    "( [ taubin ] ) and use eqs .",
    "( [ assum],[asstaucyc ] ) : @xmath219 @xmath84 is the flux through @xmath85 that reaches @xmath86 divided by the total flux through @xmath85  @xcite for trajectories that come from @xmath88 .",
    "hence , @xmath220 where @xmath221 equals 1 only if the backward ( forward ) trajectory crosses @xmath222 before @xmath223  @xcite .",
    "otherwise it is 0 . for the case @xmath224",
    ", we can write @xmath225 and @xmath226 with @xmath227 the difference in potential energy of the two surfaces .",
    "hence , @xmath228 we take an equidistant interface separation such that @xmath229 and @xmath230",
    ". moreover , @xmath231^m={\\mathcal p}_a(\\lambda_{m}|\\lambda_0)=e^{- \\beta h}$ ] or , equivalently , @xmath232 .",
    "this allows to rewrite eq .",
    "( [ tefftisas ] ) as @xmath233 since we know the efficiency times for each simulation @xmath49 , we can calculate the total efficiency time of the whole simulation series .",
    "it is , however , important to note that @xmath140 is not a constant as in eq .",
    "( [ taueffas],[tinf ] ) , but depends on @xmath49 .",
    "this raises an additional question of how one should divide a given total simulation time among the different simulations .",
    "a logical choice would be to use the same simulation time for each @xmath49 or to adjust the simulation times to obtain the same relative error in each part .",
    "we denote the total efficiency times using these two strategies @xmath234 and @xmath235 .",
    "surprisingly , for this case the two approaches are equally efficient and given by @xmath236 where we used eqs .",
    "( [ effprod12],[effprod ] ) and @xmath237 . as we show in app .",
    "[ subsser ] , these two approaches do not yield the optimum efficiency , this would be attained when we assign each part @xmath49 a simulation time proportional to @xmath238 which yields @xmath239 minimizing eqs .",
    "( [ efftistot ] ) with respect to @xmath218 shows that @xmath0 reaches a minimum for @xmath240 .",
    "hence , the tis procedure is optimized when approximately one out of five trajectories are successful .",
    "see the correspondence with us sampling  [ usrec ] where one fifth was also the optimum for fraction of sampling point in the right uphill part of the window .",
    "using @xmath241 in eq .",
    "( [ efftistot ] ) gives @xmath242 and @xmath243 . in practice ,",
    "we have found a linear dependence ( @xmath244 ) of the pathlength on a steep barrier@xcite and quadratically dependence ( @xmath245 ) on a diffusive barrier  @xcite .",
    "hence , @xmath0 is about 12 % and 33  % lower than @xmath234 and @xmath235 .",
    "note that eq .",
    "( [ efftis ] ) has the same quadratically dependence on @xmath139 as us  ( [ tauusrw ] ) .",
    "one should realize that normally @xmath246 and that @xmath247 usually has a strong @xmath100 dependence except for exceptional cases where mc cycles can be generated really independently .",
    "hence , the efficiency scaling of tis is comparable with that of us sampling using rectangular windows .",
    "as us has more flexibility to reduce @xmath145 than tis to reduce @xmath129 , us is probably a bit more efficient than tis by a single prefactor .    in this specific system ,",
    "the @xmath99 dependence of the tis efficiency is even a bit favorable than @xmath244 . in the app .",
    "[ app_efftis ] , eqs .",
    "( [ tispath]-[erfc ] ) we derive that @xmath248 yielding @xmath249 due to a decreasing average pathlength , tis seems to have a slightly better scaling as function of @xmath99 than us using rectangular windows  ( [ tauusrw ] ) . assuming a lower prefactor for us , this will imply that the tis efficiency approaches the us efficiency eq .",
    "( [ tauusrw ] ) at increasing barrier heights",
    ". however , eqs .",
    "( [ ggtis],[tefftisgg ] ) break down for very high barriers as the average tis pathlength @xmath129 can , of course , in practice never decrease below one md step .",
    "we can exactly follow the same lines as eqs .",
    "( [ teffbias],[effussw ] ) which gives for the ideal biasing function [ biasmax ] @xmath250 and the overall efficiency @xmath251 hence , the ideal bias function ( [ tisbias ] ) allows to obtain a scaling independent of @xmath139 as in eq .",
    "( [ effussw ] ) .",
    "note once more that generally @xmath252 .",
    "as for us , if we take into account the diffusive behavior of the sampling , @xmath145 is likely very large when the bias  ( [ tisbias ] ) is used .",
    "this bias favors only trajectories that reach state @xmath56 , but does not aid the system to climb the barrier in successive cycles .",
    "therefore , a bias that generates a more uniform distribution is more advantageous than eq .",
    "( [ tisbias ] ) .",
    "however , this does not affect the scaling dependency on @xmath139 .",
    "the estimation of the optimal interface separation on a straight slope is a bit difficult for path sampling methods like pptis , milestoning , and ffs ( note that the pptis memory - loss assumption is satisfied on the strictly increasing barrier even if the system is not diffusive  @xcite ) .",
    "an efficiency analysis of ffs  @xcite using the approximation  ( [ assum_unc ] ) revealed that @xmath0 is constantly decreasing as function of the number of interfaces .",
    "the same result would be valid for pptis .",
    "however , as correctly stated in ref .",
    "[ ] , the apparent conclusion , that the computational cost can be made vanishingly small using an infinite set of infinitesimal spaced interfaces , is purely artifical .",
    "if one takes into account that there is a minimum path length ( of at least 1 md step ) , also the pptis and ffs show a quadratic dependence on @xmath139 . considering the lower path length ,",
    "the efficiency is likely to be very close to us using rectangular windows .",
    "we take @xmath253 and @xmath254 ( see fig .",
    "[ top2d ] ) .    , and @xmath89 .",
    ", width=302 ]    with these outer - interface @xmath255 ensures that the system is at the flat left side of the barrier and @xmath256 ensures that the system has crossed the barrier ridge . as in eq .",
    "( [ r2d ] ) we can write @xmath257 with @xmath258 the crossing probability along the line @xmath105 .",
    "now , the optimization of the full tis algorithm would yield an extended and tedious calculation .",
    "therefore , we derive an upper bound of the cpu efficiency time instead which is relatively easy . as in eq .",
    "( [ patis ] ) , we can write for @xmath258 : @xmath259}].\\end{aligned}\\ ] ] the additional @xmath260-term compared to eq .",
    "( [ patis ] ) is because the potential energy can decrease from @xmath85 to @xmath86 along some coordinate @xmath105 . using equidistant interfaces with spacing @xmath261",
    ", we have @xmath262 .",
    "hence , @xmath263 and @xmath264 we remind you that the higher @xmath265 the lower @xmath140 due to eq .",
    "( [ taubin ] ) .",
    "the equal sign in eq .",
    "( [ pg ] ) for all @xmath49 , would correspond to the @xmath135 case with barrier height @xmath266 and barrier width @xmath267 .",
    "therefore , we can simply invoke eq .",
    "( [ efftis ] ) and write @xmath268 which has only a quadratic dependence on @xmath269 .",
    "this is far superior to exponential scaling of eqs .",
    "( [ tbc2d],[tbc2epf ] ) . as a result , for high barriers and non - vanishing angles @xmath1",
    ", the tis method becomes orders of magnitude more efficient than the reactive flux methods .",
    "of course , one might object that the reactive flux methods for this 2d system improve dramatically if we would chose @xmath270 instead of @xmath104 as rc .",
    "the reactive flux efficiency is then again identical to the @xmath135 case .",
    "however , this is exactly the crucial point .",
    "it is quite simple to find a proper rc in a low dimensional system , but in high dimensional complex systems this is certainly not the case .",
    "some methods have been devised that systematically search for rcs , but they have their limitations .",
    "the optimal hyperplane method  @xcite and the string method  @xcite rely on harmonic approximations and on the assumptions that these hyperplanes can be described as a linear combination of cartesian coordinates .",
    "complex reaction mechanism , notably chemical reactions in solution , require a highly nonlinear function as rc .",
    "the inclusion of important solvent degrees of freedom is not an easy task .",
    "some success has been made using the coordination number as rc  @xcite .",
    "however , the influence of the solvent can be more subtle . in ref .",
    "[ ] , we found that electric contributions due to nearby spontaneous formations of tetrahedral ordered water molecules can be crucial to give a last push over the potential energy barrier .",
    "to incorporate such an effect in a one - dimensional rc would be an enormous task and can not be made without a priori insight in the mechanism .",
    "automated multidimensional us sampling approaches  @xcite allow to explore the free energy surface efficiently in a predetermined set of order parameters .",
    "from the reduced free energy potential the most optimal one - dimensional rc could be estimated  @xcite . however , as the predetermined order - parameter space is still limited to e.g. 6 coordinates , it is still likely that important coordinates such as solvent degrees of freedom can be missed .",
    "up to now , we have given expressions for the efficiency times while treating the effective correlation @xmath145 as a simple constant factor .",
    "the calculation of this factor is difficult as it depend on the intrinsic diffusive behavior of the mc / md sampling itself .",
    "fact is that @xmath145 can be significant larger 1 and usually has a scaling dependence on some system parameters ( like @xmath101 , @xmath100 , and @xmath1 ) .",
    "especially , the @xmath1-dependence can be severe and will be discussed in this section .",
    "us sampling and ti constrain the system in a small window or on a surface that drags the system over the barrier .",
    "we have assumed that the time consuming step in the rate calculation for the 2d barrier is the transmission coefficient calculation .",
    "in fact , the calculation of the free energy barrier can also be very hard due to an improper rc .",
    "this problem is known as the hysteresis problem which basically results in a diverging @xmath145 .",
    "evidently , one could ask whether this problem occurs in tis as well . if this would be the case",
    ", the tis efficiency would be much less advantageous as suggested by eq .",
    "( [ efftis2d ] ) .",
    "we will show that sampling of paths instead of phase points alleviates or even eliminates the hysteresis problem entirely .",
    "the hysteresis problem does not occur in the 2d system we are considering , but can still persist , although still less than in free energy methods , for systems that have multiple reaction channels .",
    "consider the potential defined by eq .",
    "( [ v2d ] ) and the hypersurfaces @xmath271 and @xmath89 as depicted in fig .",
    "[ top2d ] .",
    "suppose that we apply ti or us using small windows located at these surfaces .",
    "the distribution at these surfaces along the @xmath105 direction is then given by @xmath272 where @xmath85 can be either @xmath271 and @xmath89 . in tis , we could look at the distribution of first crossing points with the @xmath85 interface .",
    "this distribution is given by ( @xmath189 ) @xmath273 the additional @xmath200-term in the nominator and denominator of eq .",
    "( [ disttis ] ) compared to eq .",
    "( [ distrf ] ) is due to the fact that tis looks at crossing points while the free energy distribution looks at points on the surface .",
    "a crossing point is a point that can cross the surface in a single timestep and because @xmath274  @xcite the additional @xmath200-term appears .",
    "the other term @xmath275 in eq .",
    "( [ disttis ] ) that is missing in eq .",
    "( [ distrf ] ) ensures that not all velocities are considered .",
    "starting from @xmath7 going backward in time , @xmath88 should be hit before @xmath85 .",
    "this implies that we can write @xmath276 if @xmath277 and @xmath278 for @xmath279 . substituting this in eq .",
    "( [ disttis ] ) yields @xmath280 with @xmath281 .",
    "[ disttitis ] shows the distributions of eqs .",
    "( [ titis ] ) for three interfaces for the case @xmath282 , @xmath283 and @xmath284 .",
    "coordinate for three surfaces and the ti / us and tis methods .",
    ", width=226 ]    at the first interface in fig .",
    "[ disttitis ] , the two sampling distributions of eqs .",
    "( [ titis ] ) are exactly the same .",
    "the distribution is maximized at the left side of @xmath107 . however , at the interface @xmath111 the two distributions are very different .",
    "the ti / us distribution has now two maxima at either side of @xmath107 . as md and",
    "most mc schemes generate a new phase points by making small displacements from the previous point , the low probability region in the middle needs to be crossed to sample the distribution at either side .",
    "however , as crossing this low probability region is a rare event on itself , the system might not cross this region during whole simulation period . on the other hand , once the ti surface or us window is dragged over the barrier , the distribution is peaked at the right side of @xmath107 as can been seen from the shape of the distribution at @xmath89 .",
    "if we move the surface back from @xmath89 to @xmath106 , the system would be stuck again , but now at the right side of @xmath107 , which illustrates the hysteresis problem . only when the sampling is done extensively long , both maxima at the surface @xmath106 can be sampled in a single simulation . however , all measurements between two crossing events are correlated and basically contribute as a single uncorrelated measurement .",
    "hence , @xmath285 becomes exceedingly large .",
    "tis does not have this problem .",
    "the distribution at @xmath106 has still only one maxima .",
    "the distribution becomes uniform at @xmath89 .",
    "the divergence of @xmath286 is , hence , not to be expected .",
    "only when there are distinctive different reaction channels , ergodic sampling becomes difficult as for any method .",
    "still the sampling of multiple reaction channels is likely more effective using path sampling than ti or us due to the non - locality of the shooting move  @xcite .",
    "these findings and the results of  [ tis2d ] actually prove the relative insensitivity of tis to the rc as compared to the rf methods .",
    "this quality has been assigned to path sampling methods before , but to our knowledge , this is the first time that this is rigorously proven for reaction rate calculation methods .",
    "this points out a significant advantage of tis for systems for which a proper rc can not easily be derived .",
    "it is important to note that other path sampling approaches such as pptis ( or milestoning ) and ffs do not have this advantage .",
    "the pptis approximation fails for @xmath211 except when the interfaces are very far apart .",
    "for instance , consider the interfaces @xmath287 with @xmath288 .",
    "the pptis memory - loss assumption reveals that the trajectories that start at @xmath94 and cross @xmath289 have on average the same probability to reach @xmath86 as the trajectories that start at @xmath290 and cross @xmath289 .",
    "this can only be valid if @xmath291 ( see fig .  [ top2d ] ) .",
    "if @xmath94 is set closer to @xmath85 , many trajectories that cross @xmath94 along a lines @xmath292 will not come from @xmath88 if they are followed backward in time and the pptis approximation results in an overestimation of the reaction rate . in turn , the large interface distances results that some of the pptis crossing probabilities are very small and can only be determined efficiently using tis .",
    "ffs , although in principle exact , also has a problem for non - zero angles @xmath1 . as ffs only propagates forward in time using the successful paths from the previous simulation , all the simulations become correlated .",
    "this implies that whenever the simulation at the first interface is in error , all other simulation results will be erroneous as well even if these simulations are performed infinitely long .",
    "this is a direct effect of the non - validity of eq .",
    "( [ assum_unc ] ) for ffs . coming back to fig .",
    "[ disttitis ] , the flat distribution at @xmath89 can only be reproduced using ffs when at the previous interfaces ( as @xmath106 and @xmath293 ) a significant number of pathways is sampled in low - populated right tail of the path distribution which requires the sampling of an extremely large number of pathways .",
    "we have derived analytical expressions to determine the efficiency of different computational methods for the calculation of reaction rates .",
    "the efficiency has been expressed as the computational cost to obtain an overall relative error of 1 when all algorithmic parameters are optimized .",
    "we have called this property the cpu efficiency time @xmath0 . in app .",
    "[ secect ] , we have derived the cpu efficiency for very general cases .",
    "this also reveals an important generic result of how one should divide a fixed total simulation time among a set of independent simulations to get the lowest overall error .",
    "after a first round of simulations , reasonable estimates of @xmath140 can be obtained .",
    "then , the minimal additional simulation time , needed in each simulation , to obtain the overall best performance can be calculated and used for a second round of simulations .",
    "this approach can be very profitable and it is not restricted to rate calculations .    we have applied these rules to determine the efficiency of a simple 2d benchmark system that allows an analytical approach . this offers a way to compare the efficiency of the different methods in a very transparent way .",
    "the two classes of methods that we compared are the rf methods and the path sampling methods .",
    "the rf methods consists of the calculation of the free energy barrier and the calculation of the transmission coefficient . both for the free energy as for the transmission coefficient calculation different methods exist .",
    "for the free energy calculation we compared two approaches of us .",
    "one using a series of rectangular windows and one using a single optimal biasing potential . for the path sampling methods",
    ", we have concentrated on the tis technique which is an improvement upon the original tps algorithm to calculate rates .",
    "the pptis approach reduces the computational cost even more but relies on the approximation of memory loss. as for us , we suggest that a single bias potential based on @xmath294 $ ] could replace the discrete set of interfaces .",
    "the @xmath135 case corresponds to the situation where the chosen rc is optimal .",
    "the tst approximation is then exact so that the free energy calculation is sufficient for the rf methods .",
    "we found an efficiency scaling equal to @xmath295 for us using rectangular windows .",
    "we obtained the same scaling rules for standard tis . using a single continuous bias potential , the us and tis efficiency can , in the optimal case , become independent of the barrier height and temperature .",
    "however , knowing the optimal bias basically implies that one already knows the answer .",
    "us using several windows and standard tis are more robust approaches if no a - priori knowledge of the system is available .",
    "this shows that tis and us compare very well in efficiency for all barrier heights and temperatures and that the difference can only rely in a single prefactor .",
    "it is likely that us is a bit better than tis that has to be faithful to the natural dynamics of the system .",
    "us has more flexibility to optimize the method such as choosing the best mc moves that minimizes the number of correlations .    when @xmath211 , the chosen rc , @xmath104 , is no longer optimal .",
    "in contrast to the @xmath135 case , the principal computational effort of the rf method lies in the calculation of the dynamical correction .",
    "we showed that the bc method scales as @xmath296 , while the bc2 and epf methods are quadratically more efficient .",
    "the epf method is , however , a bit more than a factor 2 more faster than the bc2 method .",
    "the exponential dependence on @xmath297 indicates that a small deviation from the optimal rc can have dramatic consequences for the efficiency of the rf methods if they are applied to high barrier or low temperature systems .",
    "in contrast , the tis efficiency scaling is only @xmath298 .",
    "we also discuss the potential problem of hysteresis in us and ti when a non - optimal rc is chosen and why this problem does not occur for tis for the 2d barrier .",
    "this gives another evidence that the tis method is less sensitive the choice of rc .",
    "the advantage that path sampling does not require a rc has been advocated many times .",
    "however , although this statement is quite evident if the main object is to sample a representative set of reactive trajectories , it is not so evident for the calculation of reaction rates .",
    "the calculation of the reaction rate still requires a rc ( the only exception we know of is the method proposed in ref .",
    "[ ] using the pathlength as transition parameter ) .",
    "however , we are now the first to prove that a path sampling - based reaction rate calculation method , using tis , is potentially orders of magnitude faster than the rf - based methods whenever the right rc can not be determined .",
    "the reason is because tis uses an importance sampling technique to calculate the dynamical factor .",
    "the importance sampling of the rf methods only concentrates on the free energy .",
    "therefore , whenever the dynamical factor is low ( e.g. due to a wrong choice of rc ) , these methods automatically run into problems .",
    "the main question remains whether it is more profitable to search for a good rc and use the rf methods , or take a simple order parameter ( non - optimal rc ) and use the tis method .",
    "this question has not an easy answer and depends on the complexity of the system .",
    "i would like to thank daniele moroni for fruitful discussions and carefully reading this paper .",
    "i am also grateful to rosalind allen who made useful suggestions to improve the first version of this paper .",
    "this work was support by a marie curie intra - european fellowships ( meif - ct-2003 - 501976 ) within the 6th european community framework programme .",
    "we denote with @xmath7 a phase space point @xmath299 where @xmath300 are the cartesian coordinates and @xmath301 the momenta .",
    "the examples presented here consider only 1 particle in a two - dimensional potential , but @xmath302 are in general multidimensional vectors .",
    "the distribution of @xmath7 is given by the probability density @xmath95 . in case of boltzmann statistics",
    "@xmath303 with @xmath304 the total energy at phase point @xmath7 and @xmath305 with @xmath306 the temperature and @xmath307 the boltzmann constant .",
    "suppose @xmath308 is the value of a quantity we want to compute .",
    "in many cases such a quantity equals the expectation value of a certain observable .",
    "we denote this observable with @xmath309 which is a function of @xmath7 .",
    "then the expectation value or population mean @xmath310 is given by @xmath311 and @xmath312 for this specific case .",
    "path sampling simulations require a more extensive formulation especially when stochastic dynamics is applied .",
    "the discrete representation of a path is the most convenient , where a path @xmath16 is defined as a set of @xmath313 successive phase points that determine the system at intervals of @xmath77 along a certain trajectory : @xmath314 . in tis , the backward @xmath315 and",
    "forward @xmath316 time indices are not fixed , but depend on when a certain interface is crossed .",
    "the weight of the path is given by the initial distribution at time @xmath19 and the probability densities corresponding to the history and future of the path : @xmath317=\\rho(x_0 ) & \\prod_{i=1}^{\\tau^b } p_{\\rm n}(x_{(1-i)\\delta t } \\leftarrow x_{-i \\delta t})\\nonumber \\\\ \\times & \\prod_{i=1}^{\\tau^f } p_{\\rm n}(x_{(i-1)\\delta t}\\rightarrow x_{i \\delta t } ) \\label{pathweight1 } \\end{aligned}\\ ] ] where @xmath318 is the probability that the natural dynamics of the system brings you from @xmath7 to @xmath319 given you are in @xmath7 , and @xmath320 is the probability that if you are in @xmath7 you came from @xmath319 in the past . as shown in ref .",
    "[ ] , whenever the system is in a steady state , eq .",
    "( [ pathweight1 ] ) is identical to @xmath317=\\rho(x_{-\\tau^b \\delta t})\\prod_{i=1}^{\\tau^b+\\tau^f } &",
    "p_{\\rm n}(x_{(i-\\tau^b-1)\\delta t } \\rightarrow   x_{(i-\\tau^b)\\delta t } ) \\label{pathweight2 } \\end{aligned}\\ ] ] which corresponds to the path weight as expressed in the original tps papers  @xcite with the only difference that the starting index is @xmath321 instead of 0 .",
    "now , if @xmath180 $ ] is a function defined in path space , the population mean is given by @xmath322 { \\rangle}=\\frac{\\int { \\mathcal d}x \\ , \\hat{a}[x ] p[x ] } { \\int { \\mathcal d}x \\ , p[x ] } , \\label{pathav}\\end{aligned}\\ ] ] with @xmath323 and @xmath324 $ ] given by  eq.([pathweight1 ] ) .    in the following , we use @xmath325 as a point that is defined in either phase or path space ,",
    "i.e. @xmath325 can either represent @xmath7 or @xmath16 .",
    "besides the simple ensemble averages ( [ phaseav ] ) and ( [ pathav ] ) , we can also define the biased ensemble average @xmath326 using a weight function @xmath327 .",
    "this biased ensemble is defined as @xmath328 in practice , sampling the biased ensemble @xmath329 by means of md simply requires the addition of a term @xmath330 to the potential of the system . in mc , this is achieved by a change of the acceptance - rejection criterion from @xmath331 $ ] to @xmath332 $ ] with @xmath333 and @xmath334 the new and old generated mc points  @xcite .",
    "ensemble averages in path space @xmath335 { \\rangle}$ ] can depend on the type of dynamics ( hence , on the hopping probabilities @xmath336 ) . to specify this dependency , explicitly , we use @xmath337 , which allows to generalize these path ensemble averages to arbitrary dynamics .",
    "the hopping probabilities of a simulation method @xmath338 can be of any type , for instance monte carlo , and do not need to be related to the natural dynamics of the system .",
    "therefore , these ensemble averages are annotated by @xmath339 . when @xmath340 is not specified , we assume that the natural dynamics is applied or that the property is independent of the hopping probability @xmath301 .",
    "hence , in our notation @xmath335 { \\rangle}={\\langle}a[x ] { \\rangle}_1={\\langle}a[x ] { \\rangle}_{;p_{\\rm n}}= { \\langle}a[x ] { \\rangle}_{1;p_{\\rm n}}$ ]",
    ".      the standard deviation of @xmath341 is defined as @xmath342 related to the standard deviation is the variance of @xmath341 @xmath343 and the covariance of two functions @xmath341 and @xmath344 @xmath345 with @xmath346 .",
    "a simulation @xmath49 , which can either be mc , md , or tps / tis generates a set of points @xmath347 in either phase or path space .",
    "each point @xmath348 is simulated with a certain probability @xmath349 and the chance that after @xmath348 another point @xmath350 is sampled is given by @xmath351 .",
    "we denote @xmath352 .",
    "now , the sample mean @xmath353 for a simulation of length @xmath354 is given by @xmath355 eq .",
    "( [ sammean ] ) converges to the exact value , @xmath356 , in the limit @xmath357 . the standard deviation in the mean @xmath358 is defined as the standard deviation in the set of points @xmath359 that is obtained after performing a large number of independent simulations , @xmath360 , each of length @xmath354 and with result @xmath361 .",
    "hence , we can write @xmath362 using time translation invariance , we can show that @xmath363 and @xmath364 .",
    "now , we assume an exponentially decay in correlation for large @xmath365 which yields for large @xmath354 : @xmath366 \\big\\ } \\label{stdm2}\\end{aligned}\\ ] ] which gives @xmath367 in eq .",
    "( [ stdm ] ) , @xmath368 is the correlation number or the integrated auto - correlation function , which is a special case of @xmath369 , defined as @xmath370 with @xmath371 if two functions @xmath341 and @xmath344 are uncorrelated , @xmath372 .",
    "hence , if the simulation data are not correlated @xmath373 and @xmath374 and @xmath375 .",
    "let @xmath376 be the absolute error of a quantity @xmath308 and let @xmath377 be the relative error . for a sequence of measurements @xmath378 , the absolute error in the average @xmath353 is defined as the standard deviation in the mean : @xmath379 using eq .",
    "( [ stdm ] ) , the absolute and relative errors are @xmath380 this shows that it is of eminent importance for the efficiency of the method that the trajectories generated by the computer algorithm minimize the correlation number @xmath162 as much as possible . in mc , this gives rise to conflicting strategies . in",
    "general mc algorithms select a new phase point by making a random displacement from a previous point , which is then accepted or rejected .",
    "when the displacement is small , the new point resembles strongly to the old one which can be a source of correlations . on the other hand ,",
    "if the randomized displacement is too large , it is likely rejected after which the old phase point is counted again .",
    "therefore , a high rejection probability also introduces correlations .",
    "the optimum maximum displacement is a compromise between these two effects .",
    "the creation of a single step in path sampling is much more expensive than standard mc or md , but , on the other hand , the correlation number @xmath162 is usually much lower .",
    "suppose a quantity @xmath308 is not equal to the expectation value of a single operator , but , for instance , depends on two other quantities @xmath381 and @xmath382 via a function @xmath383 : @xmath384 .",
    "the error in @xmath308 can then be determined using the error propagation rules .",
    "say @xmath385 and @xmath386 are the approximations of @xmath381 and @xmath382 after @xmath58 and @xmath354 simulation cycles respectively .",
    "the resulting error @xmath387 can then be derived as follows . as @xmath388 and @xmath389",
    "are small for large values of @xmath58 and @xmath354 , we can invoke following taylor expansion : @xmath390 as in eq .",
    "( [ deferr ] ) the error @xmath387 equals the standard deviation of the mean @xmath391 .",
    "hence , @xmath392 substitution of eq .",
    "( [ defcov ] ) , ( [ deferr ] ) and ( [ stdm ] ) yields @xmath393 then , from @xmath394 , @xmath395 , @xmath396 we get the propagation rule for the relative error @xmath397 ^ 2 \\delta b^2(m)+    \\big[c \\frac{\\partial f}{\\partial c}/f \\big]^2 \\delta c^2(n )   \\nonumber \\\\    & + 2 \\big [ \\frac{\\partial f}{\\partial b}\\frac{\\partial f}{\\partial c}/f^2 \\big ] { \\rm cov}(\\bar{b}(m),\\bar{c}(n ) ) .",
    "\\label{da2}\\end{aligned}\\ ] ] eqs .",
    "( [ damn ] ) and ( [ da2 ] ) are the most general rules for the propagation of errors when @xmath308 depends on two quantities @xmath381 and @xmath382 .",
    "it can straightforwardly be generalized to more arguments such that @xmath398 .",
    "let us define @xmath163 as the average cpu time to perform a single mc , md or path sampling cycle .",
    "moreover , we denote @xmath399 as the total cpu simulation time after @xmath354 cycles .",
    "we introduce now the cpu efficiency time @xmath400 to obtain a relative error @xmath401 equal to one .",
    "putting @xmath402 in eq .",
    "( [ errs ] ) and using @xmath403 gives @xmath404 this is the general cpu efficiency time to obtain a relative error of 1 in a single simulation average .",
    "this cpu efficiency time is a characteristic property of the quantity @xmath308 ( actually of the whole function @xmath341 ) and the simulation method ( via the @xmath405 hopping probabilities and @xmath163 ) .",
    "whenever @xmath400 is known the absolute and relative errors after a simulation period @xmath406 are directly given by : @xmath407 if @xmath341 is a binary operator such that @xmath408 is either 1 or 0 , then @xmath409 in eq .",
    "( [ std ] ) and eq .",
    "( [ taueff ] ) equals @xmath410 therefore , the @xmath400 becomes very large for small values of @xmath308 and , hence , an accurate evaluation becomes problematic .",
    "the cpu efficiency time for a composite value @xmath384 , where @xmath411 and @xmath412 are determined simultaneously in a single simulation , can be derived following the the same lines as in eq .",
    "( [ stdm2 ] ) for the covariance @xmath413 \\big\\ } \\nonumber \\\\   & \\approx \\frac{1}{n } \\big\\ { { \\langle}(\\hat{b}-b)(\\hat{c}-c ) { \\rangle}\\times    \\big [   1 +    \\nonumber \\\\     & \\sum_{l=1}^\\infty \\frac { { \\langle}(b_0-b)(c_l - c ) { \\rangle}_{;p_{\\rm s } } + { \\langle}(c_0-c)(b_l - b ) { \\rangle}_{;p_{\\rm s } } } { { \\langle}(\\hat{b}-b)(\\hat{c}-c ) { \\rangle } } \\big ] \\big\\ } \\nonumber \\\\ & = \\frac{1}{n } { \\rm cov}(\\hat{b},\\hat{c } ) \\big [ 1 + n_c^{bc}+n_c^{cb } \\big ] \\label{cov2}.\\end{aligned}\\ ] ] here , we inserted eq .",
    "( [ defcov ] ) and ( [ corfun ] ) in the last line .",
    "substitution of eqs.([erreff ] ) and ( [ cov2 ] ) into eq .",
    "( [ da2 ] ) and using @xmath414 gives @xmath415 ^ 2 \\frac{\\tau_{\\rm eff}(b)}{\\tau_{\\rm sim}}+    \\big[c \\frac{\\partial f}{\\partial c}/f \\big]^2 \\frac{\\tau_{\\rm eff}(c)}{\\tau_{\\rm sim } } \\label{da3 } \\nonumber \\\\    & + 2 \\big [ \\frac{\\partial f}{\\partial b}\\frac{\\partial f}{\\partial c}/f^2 \\big ] { \\rm cov}(\\hat{b},\\hat{c } ) \\big\\{1 + n_c^{bc}+n_c^{cb } \\big\\ } \\frac{\\tau_{\\rm cyc}}{\\tau_{\\rm sim}}.\\end{aligned}\\ ] ] taking @xmath416 and @xmath417 directly results in @xmath418 ^ 2 \\tau_{\\rm eff}(b)+    \\big[c \\frac{\\partial f}{\\partial c}/f \\big]^2 \\tau_{\\rm eff}(c )   \\label{cpucomp } \\\\    & + 2 \\big [ \\frac{\\partial f}{\\partial b}\\frac{\\partial f}{\\partial c}/f^2 \\big ] { \\rm cov}(\\hat{b},\\hat{c } )    \\big\\ { 1 + n_c^{bc}+n_c^{cb } \\big\\ } \\tau_{\\rm cyc } \\nonumber   \\end{aligned}\\ ] ] where @xmath419 and @xmath420 are given by eq .",
    "( [ taueff ] ) .",
    "for example , if @xmath421 , the efficiency time of @xmath308 equals @xmath422      suppose @xmath384 and @xmath385 and @xmath386 are obtained via two different simulations .",
    "hence , @xmath354 and @xmath58 are not necessarily the same . in the following",
    "we assume that the different simulations are uncorrelated .",
    "thus , we assume that for two different simulations ( 1 ) and ( 2 ) the following holds @xmath423 here , the subscript @xmath424 indicates that the ensemble average can depend on how the two simulations are connected .",
    "assumption  ( [ assum_unc ] ) is , for instance , true for us when two independent simulations are performed using two overlapping windows .",
    "it also holds for tis where the outcome of an interface sampling simulation at a certain interface is independent of the result of the previous interface simulation results .",
    "( [ assum_unc ] ) does not hold for the most common implementation of the reactive flux method . in this approach , the importance sampling to determine the free energy barrier is simultaneously used to obtain a representative set of configuration points at the ts dividing surface .",
    "these configurations with randomized gaussian distributed velocities initiate the dynamical trajectories that determine the transmission coefficient  @xcite . moreover , at variance with tis , eq .",
    "( [ assum_unc ] ) is not true for the forward flux sampling ( ffs ) method , that was devised by allen _",
    "et al . _",
    "@xcite . here",
    ", the result of the interface sampling at one interface depends on the results of all the previous interfaces .",
    "the importance of eq .",
    "( [ assum_unc ] ) is further discussed in sec .",
    "[ susechys ] .",
    "if the total simulation time @xmath425 is fixed , we still have some freedom in choosing @xmath354 and @xmath58 or , equivalently , choosing @xmath426 and @xmath427 . first , by substitution of eqs .",
    "( [ erreff ] ) and ( [ assum_unc ] ) into eq .",
    "( [ da2 ] ) we obtain @xmath428 ^ 2   \\frac{\\tau_{\\rm eff}(b)}{\\tau_{\\rm sim}(b ) } + \\big [ c \\frac{\\partial f}{\\partial c}/f \\big]^2   \\frac{\\tau_{\\rm eff}(c)}{\\tau_{\\rm sim}(c)}. \\label{d2a}\\end{aligned}\\ ] ] a logical approach , although not the optimum , is to give each simulation the same simulation time .",
    "we will denote the efficiency time that results from this strategy @xmath429 .",
    "taking @xmath430 for @xmath431 and @xmath416 gives @xmath432 ^ 2   \\tau_{\\rm eff}(b ) + \\big [ c \\frac{\\partial f}{\\partial c}/f \\big]^2   \\tau_{\\rm eff}(c ) \\big ] .",
    "\\label{teffa1}\\end{aligned}\\ ] ] alternatively , we could try to obtain the same error in each simulation .",
    "the corresponding efficiency time will be annotated as @xmath235 .",
    "then , we need to use simulation times proportional to @xmath433 .",
    "hence , we take @xmath434 $ ] and @xmath435 $ ] in eq .",
    "( [ d2a ] ) which results in @xmath436 ^ 2 + \\big [ c \\frac{\\partial f}{\\partial c}/f \\big]^2 \\big ] .",
    "\\label{teffa2}\\end{aligned}\\ ] ] in order to determine the lowest @xmath0 , we add lagrange - multipliers constrains to eq .",
    "( [ d2a ] ) in order to fix the total simulation time @xmath437 @xmath438 \\equiv   \\big [ b \\frac{\\partial f}{\\partial b}/f \\big]^2   \\frac{\\tau_{\\rm eff}(b)}{\\tau_{\\rm sim}(b ) } \\nonumber \\\\ & +   \\big [ c \\frac{\\partial f}{\\partial c}/f \\big]^2   \\frac{\\tau_{\\rm eff}(c)}{\\tau_{\\rm sim}(c ) } -\\eta^2 \\big\\ { \\tau_{\\rm sim}(a ) - \\tau_{\\rm sim}(b)-\\tau_{\\rm sim}(c ) \\big\\ } \\label{lagrange}\\end{aligned}\\ ] ] and minimize eq .",
    "( [ lagrange ] ) with respect to all its arguments . taking the derivative to @xmath426",
    "gives @xmath439 ^ 2 \\frac{\\tau_{\\rm eff}(b)}{\\big ( \\tau_{\\rm sim}(b ) \\big)^2 }   + \\eta^2 = 0.\\end{aligned}\\ ] ] therefore , @xmath440 \\frac{\\sqrt {    \\tau_{\\rm eff}(b )   } } { \\eta } \\big| .",
    "\\label{tsimb}\\end{aligned}\\ ] ] we have put the absolute signs @xmath441 as the simulation times needs to be positive . the same relation holds for @xmath427 .",
    "@xmath442 \\frac{\\sqrt {    \\tau_{\\rm eff}(c )   } } { \\eta } \\big| .",
    "\\label{tsimc}\\end{aligned}\\ ] ] we can sum up eqs .",
    "( [ tsimb ] ) and ( [ tsimc ] ) and use @xmath443 which gives the solution for @xmath444 @xmath445 \\sqrt {    \\tau_{\\rm eff}(b )   } \\big| +   \\big|   \\big",
    "[ c \\frac{\\partial f}{\\partial c}/f \\big ] \\sqrt {    \\tau_{\\rm eff}(c )   } \\big|   \\big ) .",
    "\\label{relq}\\end{aligned}\\ ] ] then , substitution of eq .",
    "( [ relq ] ) in eqs .",
    "( [ tsimb],[tsimc ] ) completes the equations for @xmath426 and @xmath427 .",
    "substitution of these two equations in eq .",
    "( [ d2a ] ) results in @xmath446 \\big| \\sqrt { \\tau_{\\rm eff}(b )   } + \\big|   \\big [ c \\frac{\\partial f}{\\partial c}/f \\big ] \\big| \\sqrt { \\tau_{\\rm eff}(c )   }   \\big)^2 .",
    "\\label{ect2sim}\\end{aligned}\\ ] ] the efficiency time @xmath400 of eq  ( [ ect2sim ] ) is always strictly less than or equal to @xmath447 and @xmath448 of eqs .",
    "( [ teffa1],[teffa2 ] ) .",
    "these cpu efficiency times are straightforwardly generalized to simulation series of any number .",
    "suppose that the final desired value @xmath308 is obtained by @xmath449 , where @xmath218 refers to the exact value that should be produced by simulation @xmath49 and @xmath146 is the total number of independent simulations that are needed to determine @xmath308 .",
    "then , the cpu efficiency times eqs  ( [ teffa1]-[ect2sim ] ) yield @xmath450 ^ 2   \\tau_{\\rm eff}^{(s ) }    \\big ] , \\nonumber \\\\",
    "\\tau_{\\rm eff}''(a ) & =   \\big ( \\sum_{s=1}^m \\tau_{\\rm",
    "eff}^{(s ) } \\big ) \\big [ \\sum_{s=1}^m \\big [ a^{(s ) } \\frac{\\partial f}{\\partial a^{(s)}}/f \\big]^2   \\big ] , \\nonumber \\\\ \\tau_{\\rm eff}(a)&=\\big (   \\sum_{s=1}^m \\big|   \\big [ a^{(s ) } \\frac{\\partial f}{\\partial a^{(s)}}/f \\big ] \\big| \\sqrt { \\tau_{\\rm eff}^{(s ) }   } \\big)^2 , \\label{teffa12m}\\end{aligned}\\ ] ] where @xmath451 is the efficiency time of simulation @xmath49 .",
    "for example , in many methods , the final value @xmath308 is given by a product of simulation results : @xmath452 .",
    "then , @xmath453|=1 $ ] for any @xmath49 after which eqs .",
    "( [ teffa12 m ] ) become    @xmath454    and @xmath455 the same eqs .",
    "( [ effprod12],[effprod ] ) are valid for the case @xmath456 with any @xmath457 $ ] .    whenever @xmath140 is the same for all @xmath49 , eq .",
    "( [ effprod12 ] ) and ( [ effprod ] ) become identical and equal to @xmath458",
    "we will derive the efficiency time @xmath140 of a single window in us as depicted in fig .",
    "[ umbrel ] .",
    "the factor that needs to be computed in simulation @xmath49 is @xmath459 . here , @xmath460 , @xmath461 , @xmath462 , and @xmath463 .",
    "then , we can use eq .",
    "( [ taucomij ] ) with @xmath464 and @xmath465 @xmath466 and applying the assumptions eqs .",
    "( [ assum],[asstaucyc ] ) gives @xmath467 via eq .",
    "( [ defcov ] ) , eq .",
    "( [ taubin ] ) , and eqs .",
    "( [ assum],[asstaucyc ] ) we get @xmath468 then using eq .",
    "( [ windows1 ] ) and  ( [ v2d ] ) and writing @xmath469 and @xmath470 we arrive at @xmath471 moreover , @xmath472 is only nonzero in case @xmath473 .",
    "hence , @xmath474 substitution of eqs  ( [ bcus],[partcov ] ) in eqs .",
    "( [ teffcov ] ) and , after that , substitution of eqs .",
    "( [ teffcov ] ) in eq .",
    "( [ covij2 ] ) yields eq .",
    "( [ taueffas ] ) . + in order to derive the efficiency time for an ensemble average @xmath157 when it is obtained by a weighted ensemble via @xmath158 , we write again @xmath475 with @xmath476 , @xmath160 , @xmath477 , and @xmath161 . applying eq .",
    "( [ wens ] ) gives @xmath478 and @xmath479 .",
    "then applying eqs .",
    "( [ std ] ) , ( [ defcov ] ) using the ensemble @xmath329 gives : @xmath480 substitution of eqs .",
    "( [ sigmacovw ] ) in eq .",
    "( [ taueff ] ) yields @xmath481 \\tau_{\\rm cyc } , \\nonumber \\\\",
    "\\tau_{\\rm eff}(c)&=\\big ( { \\langle}\\omega^{-1 } { \\rangle}{\\langle}\\omega   { \\rangle}-1 \\big )   \\big[1 + 2 n_c^{cc}\\big ] \\tau_{\\rm cyc}. \\label{teffbcw}\\end{aligned}\\ ] ] substitution of eqs .  ( [ sigmacovw],[teffbcw ] ) in eq .",
    "( [ covij ] ) yields eq .",
    "( [ teffbias ] ) .    to obtain the optimal biasing function",
    ", we add a lagrange multiplier to eq .",
    "( [ teffbias2 ] ) to fulfill the normalization constraint @xmath482 the functional derivative of @xmath483 to @xmath54 for any operator @xmath341 and function @xmath383 is given by @xmath484 with @xmath485 .",
    "hence taking @xmath486 in eq .",
    "( [ taueffbiasl ] ) results in @xmath487   { \\mathcal n_c}+\\eta^2 \\big\\}p(x)=0\\end{aligned}\\ ] ] which has as solution @xmath488=\\frac{{\\mathcal n_c}}{\\eta^2 } \\big ( 1 -   \\frac{\\hat{a}(x)}{a } \\big)^2 .",
    "\\label{w2}\\end{aligned}\\ ] ] @xmath489 can be obtained , if necessary , via the normalization requirement @xmath164 . moreover , from eq .",
    "( [ w2 ] ) follows directly eq .",
    "( [ optw ] ) as @xmath54 should also obey @xmath490 for each @xmath7 .",
    "the tis pathlength  ( [ ggtis ] ) can be obtained as follows .",
    "say @xmath200 is the velocity at the foot of the barrier ( @xmath88 ) at a time @xmath19 .",
    "the returning time is obtained by solving following equation @xmath491 , which has a solution for @xmath492 . within the path ensemble",
    "@xmath49 all trajectories should cross @xmath85 .",
    "hence , at the foot of the barrier the kinetic energy @xmath493 must be larger than @xmath494 . therefore , for the average pathlength we can write @xmath495 with @xmath77 the md timestep that is required to express @xmath129 as an integer representing the average number of discrete timesteps . in eq .",
    "( [ tispath ] ) , we have first used the approximation  @xcite @xmath496 and , then , neglected the @xmath497 terms . using @xmath498 and @xmath499 results in eq .",
    "( [ ggtis ] ) .",
    "[ cols= \" < , < \" , ]"
  ],
  "abstract_text": [
    "<S> we analyze the efficiency of different methods for the calculation of reaction rates in the case of a simple 2d analytical benchmark system . </S>",
    "<S> two classes of methods are considered : the first are based on the free energy calculation along a reaction coordinate and the calculation of the transmission coefficient , the second on the sampling of dynamical pathways . </S>",
    "<S> we give scaling rules for how this efficiency depends on barrier height and width , and we hand out simple optimization rules for the method - specific parameters . </S>",
    "<S> we show that the path sampling methods , using the transition interface sampling technique , become exceedingly more efficient than the others when the reaction coordinate is not the optimal one . </S>"
  ]
}