{
  "article_text": [
    "in recent years the wang - landau sampling ( wls ) @xcite has been applied to many systems and has become a well established monte carlo algorithm . like the metropolis algorithm ,",
    "it is applicable to almost all stochastic simulations .",
    "in particular the method has been used in studies of polymers @xcite and proteins @xcite .",
    "one of the important features of the wls is that in general one can simulate larger systems than with conventional monte carlo algorithms . to do this",
    "one splits the total energy range into slightly overlapping subintervals , so called windows , and simulates each separately .",
    "the density of states @xmath2 for the whole energy space is then obtained by multiplying the density of states in each window by an appropriate factor which assures continuity of the function .",
    "such a result is sufficient to calculate canonical averages .",
    "nevertheless some distortions arise at the borders of the energy windows . limiting the energy space causes some distortions in the estimation of the density of states . recently a way of circumventing this problem , using adaptive windows @xcite in wls",
    "was developed .",
    "the method consists in dividing the parameter space into intervals during the simulation .",
    "the segments are created using a mobile edge where the border position depends on the portion of the histogram that has already become flat . as a result the density of states , the probability distribution and the thermodynamic properties do not suffer from the distortions that arise using conventional wls with fixed windows .    the remainder of the paper is organized as follows . in section 2 ,",
    "we briefly present the model and the evolution protocol . in section 3",
    ", we discuss some anomalies in the probability distribution and critical temperature ( obtained from the maximum of the specific heat ) that arise using fixed windows . in section 4",
    "we describe the adaptive windows ( aw ) algorithm , and in section 5 present results of aw simulations including the _ entire _ range of energies for chains up to 300 monomers on the square lattice .",
    "we simulate a lattice polymer consisting of @xmath3 monomers ; the polymer may assume any self - avoiding walk ( saw ) configuration on a two - dimensional lattice .",
    "in addition to the saw condition , which represents excluded volume , we include a monomer - monomer attraction @xcite : each pair of nonbonded nearest - neighbor monomers contributes the amount @xmath4 to the energy . due to this attractive potential , the typical configuration changes from an open `` coil '' to a dense `` globule '' at the collapse temperature @xmath5 .",
    "the hamiltonian of the system can be written as    @xmath6    where @xmath7 @xmath8 if the site @xmath9 is occupied ( vacant ) , and the sum is over nearest - neighbor pairs .",
    "we sample the configuration space using reptation dynamics @xcite , which consists in randomly selecting one of the ends of the chain and transferring a monomer from one end to the other end at random .",
    "in order to simulate larger systems using wls , the authors of the method suggest splitting the total energy range into slightly overlapping subintervals and simulating each separately .",
    "the density of states @xmath2 for the whole energy range is then obtained by multiplying the density of states in each window by an appropriate factor , to impose continuity of the function .",
    "nevertheless some distortions arise at the borders of the energy intervals suggesting systematic errors .",
    "schulz _ _ et al.__@xcite introduced a new rule aimed at correcting this problem : update the current energy value in @xmath2 and the energy histogram whenever a move is rejected because its energy is greater than the maximum allowed for the window .",
    "the procedure partially corrects the density of states , but some distortions remain in its derivatives .",
    "these difficulties can easily be seen in the energy probability distribution @xmath10 $ ] . in fig.([fig : prob_1seed ] ) we show results for the distribution of probabilities at temperatures @xmath11 and @xmath12 for a chain of @xmath13 units .",
    "the simulation was performed using four windows , spanning the range from @xmath14 to @xmath15 .",
    "errors in the probability distribution naturally induce errors in the specific heat ( see ref .",
    "@xcite ) . in order to characterize these errors we carried out wls simulations using two windows and estimated the specific heat ( obtained as usual from the variance of the energy ) as we vary the position of the border , for a chain of @xmath16 monomers ( see fig.([fig : tceb ] ) ) .",
    "( the simulations were performed using a flatness criterion of @xmath17% , that is , @xmath18 for all energies in the window of interest , where the overline denotes an average over energies .",
    "simulations were halted when @xmath19 .",
    "uncertainties were estimated using ten independent runs . )",
    "we tried to circumvent this problem using multiple `` random walkers '' to construct the density of states .",
    "we simulated ten polymers in two different situations : ( i ) all the chains running through the whole energy space and ( ii ) the chains restricted to different energy intervals with large overlaps . in case ( i )",
    "good results where obtained for small chains , but for larger polymers the simulation does not converge .",
    "the motivation behind procedure ( ii ) is that the deficiencies associated with a walker close to the border might be corrected by another walker in a different interval , but this evidently did not occur ; the resulting density of states includes small discontinuities at the borders .    we therefore conclude that wls with fixed windows leads to distorted results for the density of states @xmath2 , when applied to lattice polymers .",
    "similar distortions were observed in studies of the potts @xcite and blume - capel @xcite models using wls with fixed windows for the estimation of the joint density of states .",
    "the idea of the adaptive windows algorithm derives from the observation that during the wls of a given system the histogram becomes flat gradually , proceeding from higher energy levels to lower ones .",
    "it is therefore possible in the course of the simulation to identify an interval of the energy space where the histogram is already flat according to the usual criterion , and so to set the window on this interval .",
    "simulation of this interval can then be suspended , while the rest of the spectrum is sampled , allowing a small overlap with the already defined window .",
    "subsequently new windows can be defined and closed following the same procedure until one containing the ground state energy is created . before moving to the next stage , with a new modification factor @xmath1",
    ", we impose continuity on the current density of states @xmath2 following the procedure described above .",
    "the simulation with the new factor @xmath1 again runs through the entire spectrum , providing the correction of possible defects arising from the borders .",
    "the procedure described above again generates a sequence of windows . here",
    "an important restriction must be imposed : do not permit a border to be defined at ( or very near ) the position of a boundary formed at the previous stage . without this rule ,",
    "the method would suffer from the same deficiencies as fixed window wls .    in brief",
    ", we begin a wls as usual setting the initial values of the density of states ( histogram ) as 1 ( 0 ) for all levels of energy .",
    "the random walk in the energy space runs through all energy levels from @xmath20 to @xmath21 with a probability @xmath22 , where @xmath23 and @xmath24 are the energies of the current and the new possible configurations .",
    "whenever a configuration is accepted we update @xmath25 and @xmath26 , where @xmath27 and @xmath28 .",
    "after @xmath29 monte carlo steps ( in practice we use @xmath30 ) we check the histogram for the flatness criterion on a minimal window , of width @xmath31 , in the upper portion of the spectrum .",
    "if it is not flat , we perform an additional @xmath29 monte carlo steps , and check again , repeating until the histogram is flat on the minimal window . once this condition is satisfied , we check whether the histogram is in fact flat on a larger interval .",
    "this is done by adding , one by one , the levels below the minimal window , calculating @xmath32 , and checking for flatness . as a result",
    "we identify the largest window over which flatness is satisfied from @xmath33 , the last level for which the histogram was still flat , to @xmath21 .",
    "let @xmath34 be the overlap between two adjacent windows ( usually @xmath35 for lattice polymers ) .",
    "then the matching level between the first and the second window will be @xmath36 and the random walk in the next stage of the simulation will be restricted to energies @xmath37 .",
    "again we run the simulation until the flatness criterion is satisfied in a minimal window and identify the largest window over which flatness is still satisfied from a new @xmath33 to @xmath38 , define the new matching level @xmath39 between the second and the third window and proceed as above , until all possible energies have been included in a window with a flat histogram , with the precaution that the final window with lower limit @xmath20 always has a width @xmath40 .",
    "fig.([fig : scheme ] ) is an illustration of how the windows are formed .",
    "@xmath41 and @xmath42 are the matching levels of two already established windows and @xmath43 is the limit of the third window being closed .",
    "depends on the model , while @xmath43 and @xmath41 , @xmath42 , etc . , are determined during the simulation not fixed beforehand . ]",
    "once all windows have been formed with the last one beginning from the ground state @xmath20 , we impose continuity to the current density of states by equalizing @xmath2 of contiguous windows at the matching levels @xmath44 .",
    "the modification factor is then updated @xmath45 and the random walk is restarted with the system free to visit all energy levels from @xmath20 to @xmath21 .",
    "it is important to stress at this point that if a new window ends very close to the limit of a window of the former modification factor , we avoid this vicinity by reducing its size by , say , @xmath46 levels . this way we avoid the systematic errors observed in wls with fixed windows .",
    "the simulation continues until @xmath1 is very close to unity , e.g. , @xmath47 .",
    "the method can be easily generalized to systems with a multiparametric density of states @xmath48 .",
    "simulations of the potts and blume - capel models @xcite yielded excellent results with random walks in a two - dimensional parameter space . in both cases one parameter is maintained unrestricted and the windows are formed in the other variable .",
    "improving wls with adaptive windows , we can simulate larger system sizes without border effects . in fig.([fig : lng ] ) we show the density of states of chains of up to n=300 monomers including the entire range of energies .",
    "( as is known , some low - energy configurations are inaccessible to reptation ; we believe that the error incurred is far bellow the precision of our simulation . )",
    "it is important to point out that wls of polymers of such sizes does not converge without the use of windows . in fig.([fig : prob_1seed ] ) we show results for the probability distribution obtained from wls with fixed and with adaptive windows .",
    "discontinuities like these affect the thermodynamic quantities such as the specific heat , yielding unreliable results .",
    "solid line : results using wls with fixed windows .",
    "the spectrum was split into four windows with borders at @xmath49 . dashed line :",
    "results using adaptive windows .",
    "only a few typical error bars are shown for ten independent runs . _ _ ]    in fig .",
    "( [ fig : cv ] ) we show the results for the specific heat as a function of temperature .",
    "the inset shows the internal energy versus temperature .",
    "we believe that the maxima in specific heat at low temperatures represent a surface effect that will disappear as n @xmath50 , as observed in studies of lattice animals @xcite .     and",
    "@xmath51 . in the inset",
    "we show the internal energy versus temperature . ]",
    "average values are calculated using ten independent runs ; error bars are smaller than the symbols .",
    "we study polymers on a square lattice using wang - landau sampling with adaptive windows . in this case , splitting the energy spectrum and simulating each window separately , as in conventional wls , does not yield reliable results . using the adaptive windows scheme we eliminate this problem by forcing the window positions to shift during the simulation .",
    "we determine the density of states , probability distribution , internal energy and specific heat for chains of up to @xmath0 monomers , over the entire range of energies .",
    "the authors would like to acknowledge s .- ho tsai and d. p. landau for many interesting discussions and several helpful suggestions .",
    "we are grateful to brazilian science agencies capes , cnpq , funape - ufg and fapemig for financial support ."
  ],
  "abstract_text": [
    "<S> we report a numerical study of self - avoiding polymers on the square lattice , including an attractive potential between nonconsecutive monomers . using wang - landau sampling ( wls ) with adaptive windows , </S>",
    "<S> we obtain the density of states for chains of up to @xmath0 monomers and associated thermodynamic quantities . </S>",
    "<S> the method enables one to simulate accurately the low - temperature regime , which is virtually inaccessible using traditional methods . </S>",
    "<S> instead of defining fixed energy windows , as in usual wls , this method uses windows with boundaries that depend on the set of energy values on which the histogram is flat at a given stage of the simulation . shifting the windows each time the modification factor @xmath1 is reduced , we eliminate border effects that arise in simulations using fixed windows .    </S>",
    "<S> lattice polymers , adaptive windows wang - landau sampling </S>"
  ]
}