{
  "article_text": [
    "serial section microscopy has been used to study the anatomy of biological specimens for over 130 years @xcite . today , neuroscientists use serial section microscopy to reconstruct the microcircuitry of animal nervous systems in their entirety .",
    "electron microscopy ( em ) offers the necessary resolution to resolve individual neuronal processes and synapses @xcite .",
    "however , both serial section transmission electron microscopy ( sstem ) , and block - face scanning electron microscopy ( bf - sem ) generate section series with significant thickness variance . in a situation where the size of relevant structures is close to the resolution - limit imposed by section thickness",
    ", such variance can render accurate reconstruction impossible .",
    "top row shows an example of this thickness variance in a virtual @xmath1-cross - section through a section series acquired with a focused ion beam milling scanning electron microscope ( fib - sem ) .",
    "-slice through the volume ,",
    "( b ) shows the corresponding pairwise similarity matrix ( psm ) with intensity - encoded normalized cross - correlation ( ncc ) values in the same @xmath0-coordinate frame .",
    "arrows mark a section range that appears highly compressed in the original acquisition and biologically plausible after correction . ]    in order to rectify these distortions , we have developed an image based method that estimates the position of each individual section along the @xmath0-axis of the volume . using this information ,",
    "a corrected volume can be rendered , greatly facilitating manual and automatic reconstruction efforts .",
    "the underlying observation of our method is that the biological tissue is a signal whose changing speed varies slowly across the section series .",
    "sections that are closer to each other generally look more similar than those farther apart .",
    "in addition , individual sections vary in image quality and may contain preparation artifacts which contributes uncorrelated noise to the pairwise similarity estimate .",
    "we therefore simultaneously estimate the decay of simple pairwise similarity measures as a function of the distance between two sections , the quality of each individual section , and the optimal position of each section within the series such that the updated pairwise similarity measure is smooth .",
    "the result is a unique for each section , compensating for differences in thickness ( see  bottom row ) .",
    "this estimate can be executed locally , accounting for varying section thickness across the section plane .",
    "we make our method available as plugins for the trakem2 software @xcite , and the imagej distribution fiji  @xcite , and have published the source code on github .",
    "the problem of varying thickness in microscopy section series has been observed and addressed in previous work .",
    "de groot @xcite reviews four different methods to estimate section thickness : ( i )  measuring tissue folds that are twice as thick as the section , ( ii )  comparing electron scattering in the section with a standard test curve , ( iii )  estimating section thickness from interference patterns that occur when splitting a light beam and placing the transparent refractile epon - section in one of the otherwise identical beam paths , and ( iv )  re - embedding the sections , re - sectioning them perpendicularly to the @xmath2-plane , and then measuring the section thickness within these sections from subsequent em .",
    "method ( i ) depends on an artifact that compromises image quality , options ( ii , iii ) require specialized instruments , and option ( iv ) is not only laborious but requires that sections can be re - embedded and re - imaged which is not possible in destructive imaging modalities such as bf - sem .",
    "berlanga et  al .",
    "@xcite manually annotate the top and bottom surface areas of small image stacks and describe these surfaces by polynomial functions .",
    "they then transform the image density ( rgb - channel values ) such that both surface areas are flat and perpendicular to @xmath0 .",
    "this method requires that individual sections are acquired as volumes correctly reproducing their physical thickness .",
    "it is not possible to compensate for thickness variation that is the result of physical compression that differs between adjacent sections .",
    "boergens and denk  @xcite developed an augmentation of the fib - sem to correct for section thickness variation during image acquisition .",
    "later , they ascertain structural isotropy of the sample and transform @xmath0-coordinates such that the peak of the curve of autocorrelations of several @xmath1-cross - sections of the data has the same half width in both dimensions . finally , the @xmath0-coordinate of each section is determined by the average over all @xmath1-cross - sections .",
    "this method enables automatic estimation of a scaling factor for sufficiently large section ranges that guarantees isotropy of the contained data assuming that local section thickness is constant .",
    "sporring et  al .",
    "@xcite operate on image data directly .",
    "similar to our method , the position of sections is estimated by comparing a reference similarity decay curve with pairwise similarity estimates between sections .",
    "in contrast with our method , the reference curve is generated from in - section pixel intensities assuming strictly isotropic specimen .",
    "the context with which a decision is made is limited , since only the previous section in the series is taken into account for @xmath0-position updates .",
    "noise in individual sections is not considered .",
    "our method is unique among previous approaches in that it calculates an accurate globally consistent @xmath0-position for each individual section directly from noisy post - acquisition image data without further demands on instrument design or imaging modality .",
    "it has the potential to calculate section thickness varying in @xmath3 and @xmath4 in a straight forward manner and does not require manual annotations or processing of section images . as a result",
    ", our method readily scales to large em data sets being routinely collected .",
    "we start with the assumption that the spatial frequencies of tissue change slowly across the series of sections . as a result ,",
    "the similarities between tissue sections shifted in space should decay with the magnitude of the shift .",
    "since these tissue properties give rise to the image contrast in microscopy , we expect similarities between images of the tissue to reflect those properties .",
    "our method corrects section spacing by estimating @xmath0-shifts that match a locally smooth tissue similarity decay curve . in our experiments ,",
    "we have used normalized cross correlation ( ncc ) as a measure for similarity .",
    "in addition , we are experimenting with other metrics that are less sensitive to correct section alignment such as the inverse false positive rate of invariant feature matches or the average correlation coefficient of local blockmatches .",
    "however , regardless of which similarity metric is employed , the inherent similarity decay curve is generally unknown .",
    "it therefore needs to be estimated from the data while simultaneously correcting @xmath0-coordinates .",
    "furthermore , each section is compromised by preparation artifacts ( varying imaging conditions , differences in staining , etc . ) . assuming that these quality differences apply to each section individually , the `` quality '' of a section affects all pairwise comparisons equally .    in , we combine these assumptions into an optimization problem that jointly solves for    1 .   a `` tissue inherent '' similarity decay curve , 2 .   a quality measure for each section , and 3 .",
    "@xmath0-shifts for each section such that observed similarity curves are best explained by the tissue inherent curve    @xmath5    in our notation , @xmath0 , @xmath6 and @xmath7 are indices for sections , @xmath8 is the value of the fit of the similarity localized at @xmath0 and evaluated at @xmath9 .",
    "@xmath10 and @xmath11 denote window functions that account for local smoothness , @xmath12 is a vector of quality measures for each section , @xmath13 holds the actual coordinates for each section , and @xmath14 holds the shifts with respect to the original ( grid ) positions . finally , @xmath15 is the measured value of the similarity for reference @xmath0 at a distance @xmath16 .",
    "this optimization problem has trivial solutions for all @xmath17 and can arbitrarily stretch and compress the series , both potentially leading to further trivial solutions .",
    "we therefore apply two bounding conditions :    1 .",
    "@xmath18 , 2 .",
    "the minimum and maximum coordinates of the series remain unchanged , _ i.e. _  the series neither shifts nor scales globally .    as there is no closed - form solution to this non - convex optimization problem , we approximate by splitting it into three separate terms that we solve iteratively in alternating sequence until convergence is reached . furthermore , an iterative approach gives us maximum flexibility to test a variety of further regularizing constraints .",
    "first , we estimate the similarity curve inherent to the tissue from the data ( ) .",
    "second , we estimate the quality of each section ( ) and , third , we calculate and apply the shift for each section ( ) .",
    "we repeat these steps until a specified number of iterations is reached .",
    "0.48    ;    0.48    ;",
    "we applied our method to two different data sets : ( i )  fib - sem , dimensions 20481281000px , voxel - size 882 nm , and ( ii )  sstem , dimensions 2580324463px , voxel - size 4440 nm .",
    "the voxel depth of 2 nm and 40 nm , respectively , is the reported nominal section thickness . as we will see later",
    ", the actual thickness of individual sections varies greatly .",
    "the section thickness variation in the fib - sem image data is apparent from the @xmath1-cross - section shown in .",
    "tissue appearance changes abruptly from fast to slow at the indicated section .",
    "this indicates a sequence of thicker and thinner sections , respectively .",
    "our method greatly reduces the severity of this artifact , as evidenced by the `` squeezed '' and `` stretched '' cross - sections through neuronal processes in the original image that appear round as expected after correction .",
    "we estimated a min and max section spacing of @xmath19 and @xmath20px ( 0.28 nm and 20.4 nm ) respectively .      in the sstem data set ,",
    "the variances in section thickness are not as dramatic as in the fib - sem data .",
    "therefore , we corrected thickness in the original data set and used the result as the basis for two revealing simulated data sets : ( i ) we removed sections from the original series to artificially create gaps within the series , and ( ii ) we randomly reordered sections in the series .",
    "all results are visualized in .",
    "we downsampled the data set by a factor of @xmath21 both in @xmath3 and @xmath4 for isotropic data .    as a numeric measure of quality",
    ", we calculate mean and max absolute difference between estimated @xmath0-positions for the original stack and each modified stack . any sections that have been removed during stack modification",
    "are ignored for this evaluation .",
    "original : : :     the section thicknesses in the sstem data do not vary as much as in    the fib - sem example . we estimated a min and max section spacing of    @xmath22 and @xmath23px ( 24 nm and 64 nm )    respectively . as a result , the corrected sstem    @xmath1-cross - sections do not appear dramatically different    than the originals as is the case for fib - sem .",
    "[ sssec : exp - ds3-missing ] missing sections : : :    we removed sections @xmath24 . as a result ,",
    "this    stack contains five fewer sections than the original and structures    are shifted compared to their original position ( _ cf . _   ) .",
    "our method    correctly estimates a large distance between those sections adjacent    to those that were removed . due to the applied floor interpolation in",
    ", they are rendered as thick sections ( see arrows ) .",
    "the estimated    @xmath0-positions of sections deviate from the corresponding    @xmath0-positions in the original reference series by 0.13px    ( 5.2 nm ) on average , and 0.28px ( 11.2 nm ) at most .",
    "[ sssec : exp - ds3-random ] random order : : :    we randomly reposition each section within in a range of    @xmath25 and then apply our algorithm , allowing for the    order of the sections to be changed whenever indicated by the    respective @xmath0-coordinates .",
    "our method correctly recovers    the initial order of the sections ( ) .",
    "the estimated    @xmath0-positions of sections deviate from the corresponding    @xmath0-positions in the original reference series by 0.044px    ( 1.76 nm ) on average , and 0.13px ( 5.2 nm ) at most .",
    "we executed our experiments on a dell precision t7610 workstation and measured runtimes for our procedure .",
    "similarity matrix estimation took @xmath26s and inference took @xmath27s for the fib - sem experiment with 1000  sections and 150  iterations .",
    "these steps took @xmath22s and @xmath28s respectively , for the tem - experiments with 63  sections and 100  iterations .",
    "we developed an efficient image based method to estimate accurate @xmath0-positions of all images in microscopy image stacks with unknown varying @xmath0-spacing .",
    "our method can be used to estimate section thickness in complete section series .",
    "in addition , it can detect missing sections , however , it requires further inspection to distinguish gaps due to section loss from thick sections as the method reports only the position of individual sections .",
    "finally , we demonstrated , that the method recovers the original section order in moderately randomized series which is particularly interesting for sstem where correct section order can not be guaranteed .    in our experiments , we estimated a single @xmath0-position for each section , however , we are planning to extend the method to estimate thickness variation within sections , employing a hierarchical coarse - to - fine approach .    in this paper",
    ", we tested our method on series of up to 1000 sections with substantial variance in section spacing and demonstrated its efficacy . depending solely on one - time estimation of pairwise similarity between sections which can be achieved by sampling and in parallel , our method",
    "is not limited by the size of individual section images . in practice",
    ", we observed that sections that are 1000 or more pixels apart have very little impact on each other .",
    "therefore , larger series can be split into independent overlapping batches that are processed in parallel and merged later .",
    "we believe that the correction of section position will improve the performance of both manual and automated segmentation methods by providing more consistent data across sections in @xmath0 , and will test this hypothesis in future work .",
    "our method is open source , publicly available in the imagej distribution fiji @xcite , and integrated in trakem2  @xcite .",
    "this work was supported by hhmi .",
    "we thank davi bock , ken hayworth , harald hess , rick fetter , shan xu , and zhihao zheng for data collection and valuable discussion ."
  ],
  "abstract_text": [
    "<S> serial section microscopy is an established method for volumetric anatomy reconstruction . </S>",
    "<S> section series imaged with electron microscopy are currently vital for the reconstruction of the synaptic connectivity of entire animal brains such as that of _ drosophila melanogaster_. the process of removing ultrathin layers from a solid block containing the specimen , however , is a fragile procedure and has limited precision with respect to section thickness . we have developed a method to estimate the relative @xmath0-position of each individual section as a function of signal change across the section series . </S>",
    "<S> first experiments show promising results on both serial section transmission electron microscopy ( sstem ) data and focused ion beam scanning electron microscopy ( fib - sem ) series . </S>",
    "<S> we made our solution available as open source plugins for the trakem2 software and the imagej distribution fiji .    </S>",
    "<S> serial section microscopy , section thickness , optimization , fiji </S>"
  ]
}