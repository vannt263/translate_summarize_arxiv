{
  "article_text": [
    "topological data analysis assigns homological invariants to data presented as a finite metric space ( a `` point cloud '' ) .",
    "if we imagine this data as measurements sampled from some abstract universal space @xmath0 , the structure of that space is a metric measure space , having a notion both of distance between points and a notion of probability for the sampling . a standard homological approach to studying the samples is to assign a simplicial complex and compute its homology .",
    "the construction of the associated simplicial complex for a point cloud depends on a choice of scale parameter .",
    "the insight of `` persistence '' is that one should study homological invariants that encode change across scales ; the correct scale parameter is a priori unknown . as such , a first approach to studying the homology of @xmath0 from the samples is to simply compute the persistent homology @xmath1 of simplicial complexes associated to the sampled point cloud @xmath2 .",
    "we can gain some perspective from imagining that we could make measurements on @xmath0 directly and interpret these measurements in terms of random sample points . with this in mind",
    ", we immediately notice some defects with homology and persistent homology as invariants of @xmath0 . while the homology of @xmath0 captures information about the global topology of the metric space , the probability space structure plays no role .",
    "this has bearing even if we assume @xmath0 is a compact riemannian manifold and the probability measure is the volume measure for the metric : handles which are small represent subsets of low probability but contribute to the homology in the same way as large handles . in this particular kind of example",
    ", persistent homology can identify this type of phenomenon ( by encoding the scales at which homological features exist ) ; however , in a practical context , the metric on the sample may be ad hoc ( e.g. , @xcite ) and less closely related to the probability measure . in this case",
    ", we could have handles that are medium size with respect to the metric but still low probability with respect to the measure .",
    "homology and persistent homology have no mechanism for distinguishing low probability features from high probability features .",
    "a closely related issue is the effect of small amounts of noise ( e.g. , a situation in which a fraction of the samples are corrupted ) .",
    "a small proportion of bad samples can arbitrarily change the persistent homology .",
    "these two kinds of phenomena are linked , insofar as decisions about whether low probability features are noise or not is part of data analysis .",
    "the disconnect with the underlying probability measure presents a significant problem when trying to adapt persistent homology to the setting of _ hypothesis testing _ and",
    "_ confidence intervals_. hypothesis testing involves making quantitative statements about the probability that the persistent homology computed from a sampling from a metric measure space is consistent with ( or refutes ) a hypothesis about the actual persistent homology .",
    "confidence intervals provide a language to understand the variability in estimates introduced by the process of sampling .",
    "because low probability features and a small proportion of bad samples can have a large effect on persistent homology computations , the persistent homology groups make poor test statistics for hypothesis testing and confidence intervals . to obtain useable test statistics ,",
    "we need to develop invariants that better reflect the underlying measure and are less sensitive to large perturbation . to be precise about this",
    ", we use the statistical notion of robustness .",
    "a statistical estimator is _ robust _ when its value can not be arbitrarily perturbed by a constant proportion of bad samples .",
    "for instance , the sample mean is not robust , as a single extremely large sample value can dominate the result . on the other hand ,",
    "the sample median is robust . as we discuss in section  [ sec : notrobust ] , persistent homology is not robust",
    ". a small number of bad samples can cause large changes in the persistent homology , essentially as a reflection of the phenomenon of large metric low probability handles ( including spurious ones ) .    in order to handle this ,",
    "we adopt a standard statistical perspective , namely that the distribution of an estimator on some fixed finite number of samples is an appropriate way to grapple with such behavior .",
    "to make this precise , we need to be able to talk about probability distributions on homological invariants .    using the idea of an underlying metric measure space @xmath0 , formally the process of sampling amounts to considering random variables on the probability space @xmath3 equipped with the product probability measure .",
    "the @xmath4-th persistent homology of a size @xmath5 sample is a random variable on @xmath6 taking values in the set @xmath7 of finite _ barcodes _",
    "@xcite , where a barcode is essentially a multiset of intervals of the form @xmath8 .",
    "the set @xmath7 of barcodes is equipped with a metric @xmath9 , the bottleneck metric @xcite , and we show in section  [ sec : polish ] that it is separable and that its completion @xmath10 is also a space of barcodes .",
    "then @xmath10 is polish , i.e. , complete and separable , which makes it amenable to probability theory ( see also  @xcite for similar results ) . in particular , various metrics on the set of distributions on @xmath10",
    "metrize weak convergence , including the prohorov metric @xmath11 and the wasserstein metric @xmath12 .",
    "we consider the following probability distribution on barcode space @xmath10 ( restated in section  [ sec : distinv ] as definition  [ defn : phd ] ) .",
    "[ defn : ph ] for a metric measure space @xmath13 and fixed @xmath14 , define @xmath15 to be the empirical measure induced by the @xmath4th @xmath5-sample persistent homology , i.e. , @xmath16 the probability distribution on the set of barcodes @xmath10 induced by pushforward along @xmath17 from the product measure @xmath18 on @xmath19 .    in other words",
    ", @xmath20 is the probability measure on the space of barcodes where the probability of a subset @xmath21 is the probability that a size @xmath5 sample from @xmath0 has @xmath4-th persistent homology landing in @xmath21 .",
    "note that the pushforward makes sense since @xmath17 is a continuous and hence borel measurable function ; see section  [ sec : distinv ] for a discussion .    although complicated , @xmath22 is a continuous invariant of @xmath0 in the following sense .",
    "the moduli space of metric measure spaces admits a metric ( in fact several ) that combine the ideas of the gromov - hausdorff distance on compact metric spaces and weak convergence of probability measures @xcite .",
    "we follow @xcite , and use the _ gromov - prohorov metric _ , @xmath23 .",
    "we prove the following theorem in section  [ sec : distinv ] ( where it is restated as theorem  [ thm : main ] ) .",
    "[ thm : stability ] let @xmath13 and @xmath24 be compact metric measure spaces .",
    "then we have the following inequality relating the prohorov and gromov - prohorov metrics : @xmath25    this inequality becomes increasingly tight as the right - hand side approaches @xmath26 ; we discuss precise estimates in section  [ sec : distinv ] .",
    "as we explain there , the fact that the bound increases with @xmath5 is expected behavior : @xmath5 should be thought of as a scale parameter , and increasing @xmath5 yields a more sensitive invariant .",
    "the main import of theorem  [ thm : stability ] is that for fixed @xmath5 , empirical approximations to @xmath27 computed from subsets @xmath28 are asymptotically convergent as the number of samples increase .",
    "theorem  [ thm : stability ] therefore validates computing @xmath20 in practice using empirical approximations , where we are given a large finite sample @xmath29 which we regard as drawn from @xmath0 . making @xmath29 a metric measure space via the subspace metric from @xmath0 and the empirical measure",
    ", we can compute @xmath30 as an approximation to @xmath22 .",
    "this procedure is justified by the fact that as the sample size increases , the empirical metric converges ( in @xmath23 ) to @xmath0 ; see corollary  [ cor : largenum ] . in particular , this justifies a resampling procedure to approximate @xmath15 by subsampling from a large sample of size @xmath31 .",
    "( we can also approximate using more sophisticated resampling methodology , a topic we study in future work . )    moreover , as a consequence of the continuity implied by the previous theorem , we can use @xmath20 to develop robust statistics : if we change @xmath0 by adjusting the metric arbitrarily on @xmath32 probability mass to produce @xmath33 , then the gromov - prohorov distance satisfies @xmath34 .",
    "a difficulty with applying @xmath20 is that it can be hard to interpret or summarize the information contained in a distribution of barcodes , unlike distributions of numbers for which there are various moments ( e.g. , the mean and the variance ) which provide concise summaries of the distribution .",
    "one approach is to develop `` topological summarizations '' of distributions of barcodes ; a version of this using frechet means is explored in  @xcite .",
    "another possibility is to embed the space of barcodes in a more tractable function space  @xcite . in this paper , we instead consider cruder invariants which take values in @xmath35 .",
    "one such invariant is the distance with respect to a reference distribution on barcodes @xmath36 , chosen to represent a hypothesis about the persistent homology of @xmath0 .",
    "[ defn : hd ]",
    "let @xmath13 be a compact metric measure space and let @xmath36 be a fixed reference distribution on @xmath10 .",
    "fix @xmath37 .",
    "define the homological distance on @xmath0 relative to @xmath36 to be @xmath38    we also consider a robust statistic @xmath39 related to @xmath40 without first computing the distribution @xmath20 . to construct @xmath39 ,",
    "we start with a reference barcode and compute the median distance to the barcodes of subsamples .",
    "[ defn : mhd ] let @xmath13 be a compact metric measure space and fix a reference barcode @xmath41 .",
    "fix @xmath42 .",
    "let @xmath43 denote the distribution on @xmath35 induced by applying @xmath44 to the barcode distribution @xmath45 .",
    "define the median homological distance relative to @xmath46 to be @xmath47    the appearance of reference barcodes and distributions in the invariants above raises the question of where one obtains these quantities . as we illustrate below in section  [ sec : examples ] , a common source of reference point is simply an a priori hypothesis about the data that we wish to test .",
    "the frechet mean  @xcite of a collection of samples provides a more principled approach to producing such reference points .",
    "the use of the median rather than the mean in the preceding definition ensures that we compute a robust statistic , in the following sense .",
    "[ defn : robust ] let @xmath48 be a function from finite metric spaces to a metric space @xmath49 .",
    "we say that @xmath48 is robust with robustness coefficient @xmath50 if for any non - empty finite metric space @xmath51 , there exists a bound @xmath52 such that for any isometric embedding of @xmath0 into a finite metric space @xmath53 , @xmath54 implies @xmath55 , where @xmath56 denotes the number of elements of @xmath0 .",
    "for example , under the analogous definition on finite multi - subsets of @xmath35 ( in place of finite metric spaces ) , median defines a function to @xmath35 that is robust with robustness coefficient @xmath57 for any @xmath32 since expanding a multi - subset @xmath0 to a larger one @xmath33 with fewer than twice as many elements will not change the median by more than the diameter of @xmath0 .",
    "similarly , for a finite metric space @xmath0 , expanding @xmath0 to @xmath33 , the proportion of @xmath5-element samples of @xmath33 which are samples of @xmath0 is @xmath58 ; when this number is more than @xmath59 , the median value of any function @xmath48 on the set of @xmath5-element samples of @xmath33 is then bounded by the values of @xmath48 on @xmath5-element samples of @xmath0 . since @xmath60 for @xmath61 ,",
    "any such function @xmath48 will be robust with robustness coefficient @xmath62 satisfying this bound , and in particular for @xmath63 .",
    "[ thm : ahdrobust ] for any @xmath64 , the function @xmath65 from finite metric spaces ( with the uniform probability measure ) to @xmath35 is robust with robustness coefficient @xmath66 .",
    "the function @xmath20 from finite metric spaces to distributions on @xmath10 and the function @xmath67 from finite metric spaces to @xmath35 are robust for any robustness coefficient for trivial reasons since the gromov - prohorov metric is bounded . however , for these functions we can give explicit uniform estimates for how much these functions change when expanding @xmath0 to @xmath33 just based on @xmath68 .",
    "we introduce the following notion of uniform robustness which is strictly stronger than the notion of robustness .",
    "[ defn : uniformrobust ] let @xmath48 be a function from finite metric spaces to a metric space @xmath49 .",
    "we say that @xmath48 is uniformly robust with robustness coefficient @xmath50 and estimate bound @xmath52 if for any non - empty finite metric space @xmath51 and any isometric embedding of @xmath51 into a finite metric space @xmath53 , @xmath54 implies @xmath55 .",
    "uniform robustness gives a uniform estimate on the change in the function from expanding the finite metric space .",
    "for example , the median function does not satisfy the analogous notion of uniform robustness for functions on finite multi - subsets of @xmath35 .",
    "we show in section  [ sec : distinv ] that @xmath20 and @xmath67 satisfy this stronger notion of uniform robustness .",
    "[ thm : hdunifrob ] for fixed @xmath69 , @xmath20 is uniformly robust with robustness coefficient @xmath62 and estimate bound @xmath70 for any @xmath62 . for fixed @xmath64",
    ", @xmath71 is uniformly robust with robustness coefficient @xmath62 and estimate bound @xmath70 for any @xmath62 .    as with @xmath20 itself",
    ", the law of large numbers and the convergence implied by theorem  [ thm : stability ] tells us that given a sufficiently large finite sample @xmath72 , we can approximate @xmath73 and @xmath74 of the metric measure space @xmath75 in a robust fashion from the persistent homology computations on @xmath29 .",
    "( see corollaries  [ cor : largenum ] ,  [ lem : largenumhd ] , and  [ lem : largenumahd ] below . )    in light of the results on robustness and asymptotic convergence , @xmath73 , @xmath74 , and @xmath15 ( as well as various distributional invariants associated to @xmath15 ) provide good test statistics for hypothesis testing . furthermore , one of the benefits of the numerical statistics @xmath73 and @xmath74 is that we can use standard techniques to obtain confidence intervals , which provide a means for understanding the reliability of analyses of data sets .",
    "we discuss hypothesis testing and the construction of confidence intervals in section  [ sec : intervals ] , and explore examples in sections  [ sec : examples ] and  [ sec : notklein ] . in this paper",
    "we primarily focus on analytic methods and monte carlo simulation for obtaining confidence intervals ; however , these statistics are well - suited for the construction of resampling confidence intervals . in a follow - up paper",
    "@xcite we establish the asymptotic consistency of the bootstrap for @xmath73 and @xmath74 .",
    "we regard this paper as a step towards providing a foundation for the integration of standard statistical methodology into computational algebraic topology .",
    "our goal is to provide tools for practical use in topological data analysis .",
    "we have developed an approach to using statistical tools to study persistent homological invariants for metric measure spaces accessed through finite samples .",
    "there are a number of related approaches to studying the statistical properties of persistent homological estimators ; we quickly survey this work .",
    "bubenik  @xcite develops statistical inference via an embedding into function spaces called `` persistence landscapes '' , and with various co - authors in  @xcite studies an approach using morse theory ( and hence taking advantage of the ambient metric space for smoothing ) .",
    "the work of harer , mileyko , and mukerjee in  @xcite parallels the development in section  [ sec : polish ] and introduces probability measures on barcode space , and these ideas are developed further ( with turner ) in the context of frechet means as ways of summarizing barcode distributions in  @xcite .    in another direction ,",
    "there has been a fair amount of work on the topological features of random simplicial complexes and noise due to kahle  @xcite as well as adler , bobrowski , borman , subag , and weinberger  @xcite .",
    "this work is essential for understanding what persistent homological `` null hypotheses '' look like , and adapted to our setting should inform our statistical inference procedures .    finally , there has also been a lot of excellent work arising on studying robustness in the context of understanding distances to measures for point clouds .",
    "this approach was introduced by chazal , cohen - steiner , and merigot in  @xcite , and was further developed by caillerie , chazal , dedecker , and michel in  @xcite .",
    "the basic idea is that the distribution of distances to a point cloud is a robust invariant of the point cloud ; indeed , this is closely related to the @xmath76 case of our central invariant .",
    "since preservation of explicit distances is a goal of this approach , it is more closely related to rigid geometric inference ( and manifold learning ) than purely topological inference , as in our homological approach .",
    "the authors would like to thank gunnar carlsson and michael lesnick for useful comments , rachel ward for comments on a prior draft , and olena blumberg for help with background and for assistance with the analysis of the tightness of the main theorem .",
    "we would also like to thank the institute for mathematics and its applications for hospitality while revising this paper .",
    "the paper is organized as follows . in section  [ sec : background ] , we provide a rapid review of the necessary background on simplicial complexes , persistent homology , and metric measure spaces . in section  [ sec :",
    "polish ] , we study the space of barcodes , establishing foundations needed to work with distributions of barcodes . in section  [ sec : notrobust ] , we discuss the robustness of persistent homology . in section  [ sec : distinv ] , we study the properties of @xmath20 , @xmath74 , and @xmath73 and prove theorem  [ thm : stability ] .",
    "we discuss hypothesis testing and confidence intervals in section  [ sec : intervals ] , which we illustrate with synthetic examples in section  [ sec : examples ] .",
    "section  [ sec : notklein ] applies these ideas to the analysis of the natural images data in @xcite .",
    "in this section we provide background for the framework for topological data analysis we study in this paper .",
    "we focus on an approach which accesses the ambient metric measure space @xmath13 only through finite samples , i.e. , point clouds .",
    "( we do not review other interesting approaches , for example , that use the ambient metric space for smoothing the data or for producing a variant simplicial complex  @xcite . )      a standard approach in computational algebraic topology proceeds by assigning a simplicial complex ( which usually also depends on a scale parameter @xmath32 ) to a finite metric space @xmath77 .",
    "recall that a simplicial complex is a combinatorial model of a topological space , defined as a collection of nonempty finite sets @xmath78 such that for any set @xmath79 , every nonempty subset of @xmath80 is also in @xmath78 .",
    "associated to such a simplicial complex is the `` geometric realization '' , which is formed by gluing standard simplices of dimension @xmath81 via the subset relations . ( the standard @xmath5-simplex has @xmath82 vertexes . )",
    "the most basic and widely used construction of a simplicial complex associated to a point cloud is the vietoris - rips complex :    for @xmath83 , @xmath84 , the vietoris - rips complex @xmath85 is the simplicial complex with vertex set @xmath0 such that @xmath86 $ ] is an @xmath5-simplex when for each pair @xmath87 , the distance @xmath88 .",
    "the vietoris - rips complex is determined by its @xmath89-skeleton .",
    "the construction is functorial in the sense that for a continuous map @xmath90 with lipshitz constant @xmath91 and for @xmath92 , there is a commutative diagram @xmath93 \\ar[d ] & \\vr_{\\kappa \\epsilon}(y ) \\ar[d ] \\\\",
    "\\vr_{\\epsilon'}(x ) \\ar[r ] & \\vr_{\\kappa \\epsilon'}(y ) .",
    "\\\\ } \\end{gathered}\\ ] ]    the vietoris - rips complex is easy to compute , in the sense that is straightforward to determine when a simplex is in the complex .",
    "more closely related to classical constructions in algebraic topology is the cech complex .    for @xmath83 , @xmath84",
    ", the cech complex @xmath94 is the simplicial complex with vertex set @xmath0 such that @xmath86 $ ] is an @xmath5-simplex when the intersection @xmath95 is non - empty , where here @xmath96 denotes the @xmath62-ball around @xmath97 .",
    "the cech complex has analogous functoriality properties to the vietoris - rips complex .",
    "the cech complex associated to a cover of a paracompact topological space satisfies the nerve lemma : if the cover consists of contractible spaces such all finite intersections are contractible or empty , the resulting simplicial complex is homotopy equivalent to the original space .",
    "[ rem : witness ] both the vietoris - rips complex and the cech complex can be unmanageably large ; e.g. , for a set of points @xmath98 such that @xmath99 , every subset of @xmath100 specifies a simplex of the vietoris - rips complex . as a consequence ,",
    "it is often very useful to define complexes with the vertices restricted to a small set of landmark points ; the weak witness complex is perhaps the best example of such a simplicial complex @xcite .",
    "we discuss this construction further in section  [ sec : notklein ] , as it is important in the applications .",
    "the theory we develop in this paper is relatively insensitive to the specific details of the construction of a simplicial complex associated to a finite metric space ( and scale parameter ) . for reasons that will become evident when we discuss persistence in subsection  [ sec : pers ] below",
    ", the main thing we require is a procedure for assigning a complex to @xmath101 that is functorial in the vertical maps of diagram   for @xmath102 .      in light of the previous subsection ,",
    "given a metric space @xmath51 , one defines the homology at the feature scale @xmath32 to be the homology of a simplicial complex associated to @xmath51 ; e.g. , @xmath103 or @xmath104 .",
    "this latter definition is supported by the following essential consistency result , which is in line with the general philosophy that we are studying an underlying continuous geometric object via finite sets of samples .",
    "let @xmath105 be a compact riemannian manifold equipped with an isometric embedding @xmath106 , and let @xmath107 be a finite independent identically - distributed sample drawn according to the volume measure on @xmath75 .",
    "then for any @xmath108 , there are constants @xmath52 ( which depends on the curvature of @xmath75 and the embedding @xmath109 ) and @xmath110 such that if @xmath111 and @xmath112 then the probability that @xmath113 is an isomorphism is @xmath114 .",
    "in fact , niyogi , smale , and weinberger prove an effective version of the previous result , in the sense that there are explicit numerical bounds dependent on @xmath115 and a `` condition number '' which incorporates data about the curvature of @xmath75 and the twisting of the embedding @xmath109 .",
    "work by latschev provides an equivalent result for @xmath116 , with somewhat worse bounds , defined in terms of the injectivity radius of @xmath75 @xcite .",
    "alternatively , one can show that in the limit @xmath116 captures the homotopy type of the underlying manifold using the fact that there are inclusions @xmath117    while reassuring , an unsatisfactory aspect of the preceding results is the dependence on a priori knowledge of the feature scale @xmath32 and the details of the intrinsic curvature of @xmath75 and the nature of the embedding . a convenient way to handle the fact that it is often hard to know a good choice of @xmath32 at the outset is to consider multi - scale homological invariants that encode the way homology changes as @xmath32 varies .",
    "this leads us to the notion of persistent homology .",
    "persistent homology arose more or less simultaneously and independently in work of robins  @xcite , frosini and ferri and collaborators  @xcite , and edelsbrunner and collaborators  @xcite .",
    "see the excellent survey of edelsbrunner and harer  @xcite for a more expansive discussion of the history and development of these ideas .",
    "the efficient algorithms and the algebraic presentation we apply herein is due to  @xcite and  @xcite .    given a diagram of simplicial complexes indexed on @xmath35 , i.e. , a complex @xmath118 for each @xmath119 and maps @xmath120 for @xmath121 , there are natural maps @xmath122 induced by functoriality .",
    "we say that a class @xmath123 is _ born _ at time @xmath124 if it is not in the image of @xmath125 for @xmath126 , and we say a class @xmath127 _ dies _ at time @xmath124 if the image of @xmath128 is 0 in @xmath125 for @xmath129 .",
    "this information about the homology can be packaged up into an algebraic object :    let @xmath130 be a diagram of simplicial complexes indexed on @xmath35 .",
    "the @xmath115th persistent @xmath4th homology group of @xmath131 is defined to be @xmath132 where @xmath80 and @xmath46 denote the cycle and boundary groups respectively .",
    "alternatively , @xmath133 is the image of the natural map @xmath134    barcodes provide a convenient reformulation of information from persistent homology .",
    "although we will work over a field and in the presence of suitable finiteness hypotheses which are satisfied in our motivating examples , recent work makes it clear that this restriction could be weakened  @xcite .",
    "we assume that the values @xmath135 change only at a countable discrete subset of @xmath35 , so that by reindexing we have a direct system @xmath136 the direct system of simplicial complexes stabilizes at a finite stage and all homology groups are finitely - generated .",
    "then a basic classification result of zomorodian - carlsson  @xcite describes the persistent homology in terms of a barcode , a multiset of non - empty intervals of the form @xmath137 .",
    "an interval in the barcode indicates the birth and death of a specific homological feature . for reasons we explain below",
    ", the barcodes appearing in our context will always have finite length intervals .",
    "the vietoris - rips ( or cech ) complexes associated to a point cloud @xmath138 fit into this context by looking at a sequence of varying values of @xmath32 : @xmath139 we can do this in several ways , for example , using the fact that the vietoris - rips complex changes only at discrete points @xmath140 and stabilizes for sufficiently large @xmath32 , or just choosing and fixing a finite sequence @xmath141 independently of @xmath0 .",
    "the theory we present below makes sense for either of these choices , and we use the following notation .",
    "let @xmath142 be a finite metric space",
    ". for @xmath143 , denote the persistent homology of @xmath0 as @xmath144 for some chosen sequence @xmath145 and @xmath146 .",
    "more generally , we can make analogous definitions for any functor @xmath147 where @xmath148 is the category of finite metric spaces and metric maps and @xmath149 denotes the category of simplicial complexes .",
    "we will call such a @xmath150 `` good '' when the homology changes for only finitely values in @xmath35 . in this case",
    ", we can choose the directed system of values of @xmath141 to contain these transition values .",
    "we note that for large values of the parameter @xmath32 , @xmath151 will be contractible .",
    "therefore , if we use the reduced homology group in dimension 0 , we get @xmath152 for all @xmath4 for large @xmath32 .",
    "the barcodes associated to these persistent homologies therefore have only finite length bars . for convenience in computation",
    ", we typically cut off @xmath32 at a moderately high value before this breakdown occurs .",
    "the result is a truncation of the barcode to the cut - off point .      by work of gromov ,",
    "the set of isometry classes of compact metric spaces admits a useful metric structure , the gromov - hausdorff metric . for a pair of finite metric spaces",
    "@xmath153 and @xmath154 , the gromov - hausdorff distance is defined as follows : for a compact metric space @xmath155 and closed subsets @xmath156 , the hausdorff distance is defined to be @xmath157 one then defines the gromov - hausdorff distance between @xmath158 and @xmath159 to be @xmath160 where here @xmath161 and @xmath162 are isometric embeddings .",
    "since the topological invariants we are studying ultimately arise from finite metric spaces , a natural question to consider is the degree to which point clouds that are close in the gromov - hausdorff metric have similar homological invariants .",
    "this question does not in general have a good answer in the setting of the homology of the point cloud , but in the context of persistent homology , chazal , et al .",
    "@xcite provide a seminal theorem in this direction that we review as theorem  [ thm : ghcompare ] below .",
    "the statement of theorem  [ thm : ghcompare ] involves a metric on the set of barcodes called the bottleneck distance and defined as follows .",
    "recall that a barcode @xmath163 is a multiset of non - empty intervals . given two non - empty intervals @xmath164 and @xmath165 , define the distance between them to be @xmath166 we also make the convention @xmath167 for @xmath168 and @xmath169 . for the purposes of the following definition , we define a matching between two barcodes @xmath170 and @xmath171 to be a multi - subset @xmath172 of the underlying set of @xmath173 such that @xmath172 does not contain @xmath174 and each element @xmath175 of @xmath176 occurs as the first coordinate of an element of @xmath172 exactly the number of times ( counted with multiplicity ) of its multiplicity in @xmath176 , and likewise for every element of @xmath177 .",
    "we get a more intuitive but less convenient description of a matching using the decomposition of @xmath178 into its evident four pieces : the basic data of @xmath172 consists of multi - subsets @xmath179 and @xmath180 together with a bijection ( properly accounting for multiplicities ) @xmath181 ; @xmath172 is then the ( disjoint ) union of the graph of @xmath109 viewed as a multi - subset of @xmath182 , the multi - subset @xmath183 of @xmath184 , and the multi - subset @xmath185 of @xmath186 . with this terminology",
    ", we can define the bottleneck distance .",
    "the bottleneck distance between barcodes @xmath187 and @xmath171 is @xmath188 where @xmath172 varies over all matchings between @xmath176 and @xmath177 .",
    "although expressed slightly differently , this agrees with the bottleneck metric as defined in @xcite and @xcite . on the set of barcodes @xmath7 with finitely many finite length intervals , @xmath9 is obviously a metric .",
    "more generally , for any @xmath189 , one can consider the @xmath190 version of this metric , @xmath191 for simplicity , we focus on @xmath9 in this paper , but analogues of our main theorems apply to these variant metrics as well .",
    "we have the following essential stability theorem :    [ thm : ghcompare ] for each @xmath4 , we have the bound @xmath192    note that truncating barcodes ( i.e. , truncating each persistent interval ) is a lipshitz map @xmath193 with lipshitz constant @xmath89 , so the bound above still holds when we use a large parameter cut - off in defining @xmath194 .    the space of barcodes admits other metrics that are finer than the bottleneck metric for which versions of the stability theorem also hold ; these can be useful in practical situations .",
    "notably , the papers  @xcite study and apply a family of wasserstein ( mass transportation ) metrics on barcode space .",
    "we believe that our results can be extended to this setting .",
    "to establish more robust convergence results , we work with suitable metrics on the set of compact metric measure spaces .",
    "specifically , following @xcite we use the idea of the gromov - hausdorff metric to extend certain standard metrics on distributions ( on a fixed metric measure space ) to a metric on the set of all compact metric measure spaces .",
    "a basic metric of this kind is the gromov - prohorov metric @xcite .",
    "( for the following formulas , see section  5 of @xcite and its references . )",
    "this metric is defined in terms of the standard prohorov metric @xmath11 ( metrizing weak convergence of probability distributions on separable metric spaces ) .",
    "first , recall that for measures @xmath195 and @xmath196 on a metric space @xmath80 , the prohorov metric is defined as @xmath197 where @xmath198 varies over all closed sets and @xmath199 is the set of points @xmath200 such that @xmath201 for some @xmath202 .",
    "then the gromov - prohorov metric is defined as @xmath203 where the @xmath204 is computed over all isometric embeddings @xmath205 and @xmath206 into a target metric space @xmath207 .",
    "it is very convenient to reformulate both the gromov - hausdorff and gromov - prohorov distances in terms of relations . for sets @xmath0 and @xmath100 ,",
    "a relation @xmath208 is a correspondence if for each @xmath209 there exists at least one @xmath210 such that @xmath211 and for each @xmath212 there exists at least one @xmath213 such that @xmath214 . for a relation @xmath215 on metric spaces",
    "@xmath138 and @xmath216 , we define the distortion as @xmath217    the gromov - hausdorff distance can be expressed as @xmath218 where we are taking the infimum over all correspondences @xmath219 .",
    "similarly , we can reformulate the prohorov metric as follows .",
    "given two measures @xmath195 and @xmath196 on a metric space @xmath0 , let a coupling of @xmath195 and @xmath196 be a measure @xmath220 on @xmath221 ( with the product metric ) such that @xmath222 and @xmath223 .",
    "then we have @xmath224 then there exists a metric space @xmath80 and embeddings @xmath225 and @xmath226 such that @xmath227 .",
    "this section introduces the spaces of barcodes @xmath228 and @xmath10 used in the distributional invariants @xmath20 of definition  [ defn : ph ] . these spaces are complete and separable under the bottleneck metric .",
    "this implies in particular that the prohorov metric on the set of probability measures in @xmath228 or @xmath10 metrizes convergence in probability , which justifies the perspective in the stability theorem  [ thm : stability ] and the definition of the invariants @xmath71 in definition  [ defn : hd ] .",
    "a barcode is by definition a multi - set of intervals , in our case of the form @xmath8 for @xmath229 .",
    "the set @xmath230 of all intervals of this form is of course in bijective correspondence with a subset of @xmath231 .",
    "a multi - set @xmath21 of intervals is a multi - subset of @xmath230 , which concretely is a function from @xmath230 to the natural numbers @xmath232 which counts the number of multiples of each interval in @xmath21 .",
    "we denote by @xmath233 the cardinality of @xmath21 , which we define as the sum of the values of the function @xmath234 specified by @xmath21 ( if finite , or countably or uncountably infinite , if not ) .",
    "the space @xmath7 of barcodes of the introduction is the set of multi - sets of intervals @xmath21 such that @xmath235 .",
    "we have the following important subsets of @xmath7 .",
    "[ defn : abn ] for @xmath236 , let @xmath228 denote the set of multi - sets of intervals ( in @xmath230 ) @xmath21 with @xmath237 .    the main result on @xmath228 is the following theorem , proved below .",
    "( similar results can also be found in  @xcite . )",
    "[ thm : abn ] for each @xmath236 , @xmath228 is complete and separable under the bottleneck metric .",
    "since the homology @xmath238 ( with any coefficients ) of any complex with @xmath5 vertices can have rank at most @xmath239 , our persistent homology barcodes will always land in one of the @xmath228 , with @xmath31 depending just on the size of the samples . as we let the size of the samples increase , @xmath31 may increase , and",
    "so it is convenient to have a target independent of the number of samples .",
    "the space @xmath240 is clearly not complete under the bottleneck metric ( consider a sequence of barcodes @xmath241 such that @xmath242 is produced from @xmath243 by adding a bar @xmath244 ) , so we introduce the following space of barcodes @xmath10 .    [ defn : abc ] let @xmath10 be the space of multi - sets @xmath21 of intervals ( in @xmath230 ) with the property that for every @xmath245 , the multi - subset of @xmath21 of those intervals of length more than @xmath32 has finite cardinality .",
    "clearly barcodes in @xmath10 have at most countable cardinality , and the bottleneck metric extends to a pseudo - metric @xmath246 .",
    "the following lemma shows it is a metric .",
    "[ lem : zeromet ] for @xmath247 , @xmath248 only if @xmath249 .",
    "let @xmath247 with @xmath248 and assume without loss of generality that @xmath0 is not in @xmath228 for any @xmath31 .",
    "then the possible distinct lengths of intervals in @xmath0 or @xmath100 form a countable set @xmath250 .",
    "let @xmath251 and @xmath252 denote the multisubsets of @xmath0 and @xmath100 consisting of the intervals of length exactly @xmath253 .",
    "let @xmath254 and in general let @xmath255 ( with each @xmath256 ) . for any @xmath5 and any @xmath257 , any matching @xmath172 of @xmath0 and @xmath100 with @xmath258 must induce a bijection between @xmath251 and @xmath252 for all @xmath259 ; moreover , if @xmath260 denotes the restriction of @xmath172 to a matching of @xmath251 and @xmath252 , @xmath261 . letting @xmath32 go to zero , we see that @xmath262 for all @xmath124 and that @xmath249 .",
    "lemma  [ lem : zeromet ] implies that @xmath9 extends to a metric on @xmath10 .",
    "we prove the following theorem .",
    "[ thm : abc ] @xmath10 is the completion of @xmath263 in the bottleneck metric . in particular",
    "@xmath10 is complete and separable in the bottleneck metric .",
    "the multi - sets of intervals with rational endpoints provides a countable dense subset for @xmath228 . to see that @xmath7 is dense in @xmath10 , given @xmath21 in @xmath10 and @xmath264 , let @xmath265 be the multi - subset of @xmath21 of those intervals of length @xmath266 . then by definition of @xmath10",
    ", @xmath265 is in @xmath7 , and by definition of the bottleneck metric , using the matching coming from the inclusion of @xmath265 in @xmath21 , we have that @xmath267 it just remains to prove completeness of @xmath228 and @xmath10 . for this , given a cauchy sequence @xmath268 in @xmath7 it suffices to show that @xmath269 converges to an element @xmath0 in @xmath10 and that @xmath0 is in @xmath228 if all the @xmath269 are in @xmath228 .",
    "let @xmath268 be a cauchy sequence in @xmath7 . by passing to a subsequence if necessary ,",
    "we can assume without loss of generality that for @xmath270 , @xmath271 .",
    "for each @xmath5 , we have @xmath272 ; choose a matching @xmath273 such that @xmath274 for all @xmath275 .",
    "for each @xmath5 , define a finite sequence of intervals @xmath276 , ",
    ", @xmath277 inductively as follows .",
    "let @xmath278 .",
    "let @xmath279 be the cardinality of the multi - subset of @xmath158 consisting of those intervals of length @xmath280 , and let @xmath281 , ",
    ", @xmath282 be an enumeration of those intervals . by induction , @xmath276 , ",
    ", @xmath277 is an enumeration of the intervals in @xmath269 of length @xmath283 such that for @xmath284 , the intervals @xmath285 and @xmath286 correspond under the matching @xmath287 .",
    "for the inductive step , we note that if @xmath286 corresponds to @xmath288 under @xmath273 , then @xmath289 , so the length @xmath290 of @xmath288 is bigger than @xmath291 , and @xmath292 thus , we can choose @xmath293 to be the corresponding interval @xmath288 for @xmath294 , and we can choose the remaining intervals of length @xmath295 in an arbitrary order .",
    "write @xmath296 and let @xmath297 since @xmath298 and @xmath299 , we have @xmath300 let @xmath0 be the multi - subset of @xmath230 consisting of the intervals @xmath301 for all @xmath124 ( or for all @xmath302 if @xmath303 is bounded ) .",
    "first , we claim that @xmath0 is in @xmath10 .",
    "given @xmath264 , choose @xmath31 large enough that @xmath304 . then for @xmath305 , the interval @xmath306 first appears in @xmath307 for some @xmath308 . looking at the matchings @xmath309 ,  ,",
    "@xmath310 , we get a composite matching @xmath311 between @xmath312 and @xmath307 .",
    "since each @xmath273 satisfied the bound @xmath313 , the matching @xmath311 must satisfy the bound @xmath314 since all intervals of length @xmath315 in @xmath312 appear as an @xmath316 , we must have that the length of @xmath317 in @xmath307 must be less than @xmath318 since each endpoint in @xmath306 differs from the endpoint of @xmath317 by at most @xmath319 , the length of @xmath306 can be at most @xmath320 thus , the cardinality of the multi - subset of @xmath0 of those intervals of length @xmath266 is at most @xmath321 .",
    "next we claim that @xmath268 converges to @xmath0 .",
    "we have a matching of @xmath269 with @xmath0 given by matching the intervals @xmath276 ,  , @xmath277 in @xmath269 with the corresponding intervals @xmath322 ,  , @xmath323 in @xmath0 .",
    "our estimates above for @xmath324 and @xmath325 show that @xmath326 . by construction ,",
    "each leftover interval in @xmath269 has length @xmath327 and the previous paragraph shows that each leftover interval in @xmath0 has length @xmath328 .",
    "thus , @xmath329",
    ".    finally we note that if each @xmath269 is in @xmath228 for fixed @xmath31 , then each @xmath330 and so @xmath0 is in @xmath228 .",
    "inevitably physical measurements will result in bad samples . as a consequence , we are interested in invariants which have limited sensitivity to a small proportion of arbitrarily bad samples .",
    "many standard invariants not only have high sensitivity to a small proportion of bad samples , but in fact have high sensitivity to a small number of bad samples .",
    "we do not claim particular novelty for the general nature of the results of this section , as these issues have been folklore for some time .",
    "however , we do not know any place in the literature where precise statements are written down .",
    "we use the following terminology to describe the instability of these invariants .",
    "[ defn : unrobust ] a function @xmath48 from the set of finite metric spaces to @xmath35 is _ fragile _ if it not robust ( in the sense of definition  [ defn : robust ] ) for any robustness coefficient @xmath331 .    in some cases , an even stronger kind of sensitivity holds .",
    "[ defn : notrobust ] a function @xmath48 from the set of finite metric spaces to @xmath35 is _ extremely fragile _ if there exists a constant @xmath4 such that for every non - empty finite metric space @xmath0 and constant @xmath31 there exists a metric space @xmath33 and an isometry @xmath332 such that @xmath333 and @xmath334 .",
    "informally , extremely fragile in definition  [ defn : notrobust ] means that adding a small constant number of points to any metric space can arbitrarily change the value of the invariant .",
    "in particular , an extremely fragile function is fragile , but extremely fragile is much more unstable than just failing to be robust ( note the quantifier on the space @xmath0 ) . as we indicated in the introduction , gromov - hausdorff distance is fragile ; here we show it is extremely fragile .",
    "let @xmath335 be a non - empty finite metric space .",
    "the function @xmath336 is extremely fragile .",
    "given @xmath337 , consider the space @xmath33 which is defined as a set to be the disjoint union of @xmath0 with a new point @xmath338 , and made a metric space by setting @xmath339 where @xmath340 .",
    "we claim @xmath341 given any metric space @xmath342 and isometries @xmath343 , @xmath344 , we need to show that @xmath345 .",
    "we have two cases .",
    "first , if no point @xmath200 of @xmath80 has @xmath346 , then we have @xmath345 . on the other hand ,",
    "if some point @xmath200 of @xmath80 has @xmath347 , then every point @xmath200 in @xmath80 satisfies @xmath348 . choosing some @xmath97 in @xmath0 , we see that for every @xmath200 in @xmath80 , @xmath349 .",
    "it follows that @xmath350    the homology and persistent homology of a point cloud turns out to be a somewhat less sensitive invariant .",
    "nonetheless , a similar kind of problem can occur .",
    "it is instructive to consider the case of @xmath351 or @xmath352 . by adding @xmath353 points far from the original metric space @xmath0 ,",
    "one can change either @xmath351 or @xmath352 by rank @xmath353 .",
    "the further the distance of the points , the longer the additional bars in the barcode and we see for example that the distance @xmath44 in the bottleneck metric from any fixed barcode @xmath46 is a extremely fragile function .",
    "( if we are truncating the barcodes , @xmath9 is bounded by the length of the interval we are considering , so technically is robust , but not in a meaningful way . )",
    "we can also consider the rank of @xmath354 or of @xmath355 in a range ; here the distortion of the function depends on the number of points , but we see that the function is fragile .    for @xmath356 and @xmath17 , @xmath357 ,",
    "the same basic idea obtains : we add small spheres sufficiently far from the core of the points in order to adjust the required homology .",
    "we work this out explicitly for @xmath358 .    for each integer @xmath359 and real @xmath360 ,",
    "let the metric circle @xmath361 denote the metric space with @xmath4 points @xmath362 such that @xmath363    for @xmath364 , the vietoris - rips complex associated to @xmath361 is just a collection of disconnected points .",
    "it is clear that as long as @xmath365 , when @xmath366 , @xmath367 has the homotopy type of ( and is in fact homeomorphic to ) a circle .",
    "in fact , we can say something more precise :    for @xmath368 the rank of @xmath369 is at least @xmath89 .",
    "consider the map @xmath48 from @xmath370 to the unit disk @xmath371 in @xmath231 that sends @xmath372 to @xmath373 and is linear on each simplex .",
    "the condition @xmath374 precisely ensures that whenever @xmath375 forms a simplex @xmath376 in the vietoris - rips complex , the image vertices @xmath377 lie on an arc of angle @xmath378 on the unit circle , and so @xmath379 in particular lies in an open half plane through the origin .",
    "it follows that the origin @xmath380 is not in the image of any simplex , and @xmath48 defines a map from @xmath370 to the punctured disk @xmath381 .",
    "since @xmath382 , we have the @xmath89-cycle @xmath383+\\dotsb + [ x_{k-1},x_{k}]+[x_{k},x_{1}]\\ ] ] of @xmath370 which maps to a @xmath89-cycle in @xmath384 representing the generator of @xmath385 .",
    "the length @xmath353 and number @xmath386 is arbitrary , so again , we conclude that functions like @xmath387 are extremely fragile .",
    "results for higher dimensions ( using similar standard equidistributed models of @xmath5-spheres ) are completely analogous .",
    "let @xmath46 be a barcode .",
    "the functions @xmath388 from finite metric spaces to @xmath35 are extremely fragile .",
    "in terms of rank , the lemma shows that we can increase the rank of first persistent homology group of a metric space @xmath0 on an interval @xmath389 $ ] by @xmath390 simply by adding extra points .",
    "one can also typically reduce persistent homology intervals by adding points `` in the center '' of the representing cycle .",
    "it is somewhat more complicated to precisely analyze the situation , so we give a representative example : suppose the cycle is represented by a collection of points @xmath362 such that the maximum distance @xmath391 .",
    "then adding a point which is a distance @xmath52 from each of the other points reduces the lifetime of that cycle to @xmath52 .",
    "in any case , the results of the lemma are sufficient to prove the following proposition .",
    "the function that takes a finite metric space to the rank of @xmath194 on a fixed interval @xmath389 $ ] is fragile .",
    "these computations suggest a problem with the stability of the usual invariants of computational topology .",
    "a small number of bad samples can lead to arbitrary changes in these invariants .",
    "fix a good functorial assignment of a simplicial complex to a finite metric space and a scale parameter @xmath32 . recall that we write @xmath17 of a finite metric space to denote the persistent homology of the associated direct system of complexes .",
    "motivated by the concerns of the preceding section , we define @xmath15 as the distribution of barcodes induced by samples of size @xmath5 .",
    "the basic idea motivating @xmath15 is that in order to obtain robust invariants , given a sample budget of @xmath31 samples from @xmath13 , instead of computing a single estimator from the @xmath31 samples it is preferable to look at _ the distribution _ of estimators produced by blocks of samples of size @xmath392 .",
    "note that this is closely related to the idea behind bootstrap resampling .",
    "it is also a more sophisticated version of computing a trimmed mean ( i.e. , a mean in which extremal samples are thrown out )  rather than removing extremal samples , we simply subsample at a rate such that the likelihood of seeing a bad sample is low .",
    "ideally , this approach retains the information contained in those samples while also estimating the `` true '' value .",
    "[ defn : phd ] for a metric measure space @xmath13 and fixed @xmath14 , define the @xmath4th @xmath5-sample persistent homology as @xmath16 the probability distribution on @xmath10 induced by pushforward along @xmath17 from the product measure @xmath18 on @xmath19 .",
    "this definition makes sense because @xmath17 is a continuous function and the measures on the domain and codomain are both borel .",
    "indeed , the stability theorem of chazal , et .",
    "@xcite ( theorem  [ thm : ghcompare ] above ) and the fact that the gromov hausdorff metric is less than or equal to the product metric in @xmath6 implies that @xmath17 is lipschitz with lipschitz constant at most 1 .    in order to apply @xmath15",
    ", we need to know two things .",
    "first , that for fixed @xmath5 and @xmath4 the approximation to @xmath15 computed by choosing samples from the empirical measure on a large sample space @xmath29 drawn from @xmath13 converges in probability to the actual value ( as @xmath393 goes to infinity ) .",
    "second , that for fixed @xmath5 and @xmath4 the approximation to @xmath15 obtained by computing the empirical measure from @xmath353 blocks of @xmath5 samples converges in probability to the actual value ( as @xmath353 goes to infinity ) . the latter follows from the weak law of large numbers for the empirical process .",
    "the goal of this section is to prove the following theorem , which establishes the former asymptotic consistency .",
    "for this ( and in the remainder of the section ) , we assume that we are computing @xmath394 using the vietoris - rips complex .",
    "[ thm : main ] let @xmath13 and @xmath395 be compact metric measure spaces",
    ". then we have the following inequality : @xmath396    assume that @xmath397 .",
    "then we know that there exist embeddings @xmath398 and @xmath399 into a metric space @xmath80 and a coupling @xmath400 between @xmath401 and @xmath402 such that the probability mass of the set of pairs @xmath403 under @xmath400 such that @xmath404 is less than @xmath32 .",
    "we can regard the restriction of @xmath405 to the full measure subspace @xmath406 of @xmath407 as a probability measure on @xmath408 .",
    "this then induces a coupling between @xmath409 and @xmath410 on @xmath10 , which we now study .",
    "consider @xmath5 samples @xmath411 from @xmath412 drawn according to the product distribution @xmath405 . now consider the probability that @xmath413 the triangle inequality implies that @xmath414 therefore , the union bound implies that the probability that @xmath415 is bounded by @xmath416 next , define a relation @xmath215 that matches @xmath417 and @xmath418 . by definition ,",
    "the distortion of this relation is @xmath419 , and so @xmath420 by the stability theorem of chazal , et .",
    "@xcite ( theorem  [ thm : ghcompare ] above ) , this implies that the probability that @xmath421 is bounded by @xmath422 .",
    "this further implies that the probability that @xmath423 is also bounded by @xmath424 .",
    "therefore , we can conclude that @xmath425    we note the dependence on @xmath5 in the statement of the bound in theorem  [ thm : main ] .",
    "as @xmath5 increases , the quantity @xmath15 becomes a finer approximation of the persistent homology of the support of @xmath0 .",
    "specifically , more points per sample means that @xmath15 is increasingly sensitive to small features of @xmath0 . in this light , it is not surprising that the bound becomes weaker for larger @xmath5 .",
    "next we discuss the tightness of the bound in theorem  [ thm : main ] .",
    "clearly , this bound is vacuous when @xmath426 since the prohorov metric is bounded by @xmath89 , but we show that it becomes tight as @xmath427 approaches zero . reviewing the argument , starting from the hypothesis that@xmath428 , we used the union bound to obtain a bound of @xmath424 .",
    "the exact bound in question is @xmath429 .",
    "the leading term in the expansion of this quantity is @xmath424 , and so as @xmath430 the bound in the theorem becomes increasingly tight .",
    "when @xmath32 is close to @xmath431 , using more terms in the expansion yields better bounds ( for example , when @xmath432 , @xmath433 and tends to @xmath434 for large @xmath5 ) .",
    "the exact bound @xmath435 yields a tight estimate on @xmath436 ( using the @xmath437 product metric ) , as we can see by the following example .",
    "consider the case of two finite metric spaces @xmath438 and @xmath439 , where @xmath440 and @xmath441 .",
    "define @xmath442 via @xmath443 for @xmath444 , @xmath445 for @xmath446 , and @xmath447 for @xmath448 and @xmath449 . here",
    "@xmath109 should be substantially larger than @xmath128 and @xmath450 .",
    "we define @xmath451 analogously , using the same @xmath128 and @xmath450 but with @xmath452 distinct from @xmath109 ( and without loss of generality assume that @xmath453 ) .",
    "consider the metric space @xmath80 formed from the disjoint union of @xmath454 , @xmath455 , and @xmath456 , and with the metric induced from @xmath442 and @xmath451 except that @xmath457 .",
    "there are evident isometries @xmath458 and @xmath459 ; it is easy to see that @xmath460 for @xmath461 and moreover that this pair of embeddings minimizes the prohorov distance , so @xmath462 .",
    "the induced embeddings @xmath463 , @xmath464 satisfy @xmath465 and a straight - forward combinatorics argument shows that this embedding also minimizes the prohorov distance , so @xmath466 .",
    "( we thank olena blumberg for help with this example . )    by varying the parameters in the previous example , it is now clear that the bound on @xmath467 is tight and we can achieve the upper bound with a variety of barcode lengths . tightness for @xmath468 for @xmath469 is harder to analyze .",
    "theorem  [ thm : ghcompare ] is expected to be tight for all @xmath4 but nothing has yet appeared in the literature for @xmath469 .",
    "if the bound in theorem  [ thm : ghcompare ] is tight , it is reasonable to expect the bound in theorem  [ thm : main ] also to be tight ; however , we do not know a rigorous argument .    for a related discussion involving finite distance matrices , see  ( * ? ? ?",
    "* ,  7 ) .",
    "there the constant @xmath31 ( size of the matrix ) is analogous to the parameter @xmath5 above and enters into their formulas through the distance @xmath470 , which depends on @xmath31 .",
    "we regard the bound as most useful for fixed @xmath5",
    ". then a basic consequence of theorem  [ thm : main ] is that consideration of large finite samples will suffice for computing @xmath15 . for a finite metric space @xmath138 , let @xmath471 and @xmath472 denote two measures on @xmath0 .",
    "then we have the following inequality  @xcite @xmath473 which follows by choosing a coupling that has measure at least the minimum of the two measures on each point .",
    "[ cor : largenum ] let @xmath474 be a sequence of randomly drawn samples from @xmath13 .",
    "we regard @xmath475 as a metric measure space using the subspace metric and the empirical measure .",
    "then @xmath476 converges in probability to @xmath477 .",
    "this result is a consequence of the fact that @xmath478 converges in probability to @xmath13 in the gromov - prohorov metric ( which can be checked directly using equation  , as in  @xcite , or can be deduced from the analogous convergence result for the gromov - wasserstein distance  ( * ? ? ? * ( iii ) ) and the comparison between the gromov - prohorov distance and the gromov - wasserstein distance  @xcite ) .",
    "another consequence of theorem  [ thm : main ] is that @xmath20 provide robust descriptors for metric measure spaces @xmath13 .",
    "specifically , observe that if we have finite metric spaces @xmath479 and a probability measure @xmath480 on @xmath33 that restricts to @xmath481 on @xmath0 ( i.e. , for @xmath482 , @xmath483 ) , then equation   implies that @xmath484 thus , when @xmath485 has probability @xmath486 , @xmath487 in particular , when @xmath0 and @xmath33 are finite metric spaces with the uniform measure , we get @xmath488 as an immediate consequence we obtain the following result .",
    "[ thm : mainunifrob ] for fixed @xmath69 , @xmath20 is uniformly robust with robustness coefficient @xmath62 and estimate bound @xmath70 for any @xmath62",
    ".    it would be useful to prove analogues of the main theorem for other methods of assigning complexes ; e.g. , the witness complex ( see remark  [ rem : witness ] and section  [ sec : notklein ] ) .",
    "we expect that the recent stability results of  @xcite will be useful in this connection .",
    "in this section , we describe various ways to use @xmath15 to perform statistical inference about the homological invariants of a point cloud .",
    "the basic goal is to provide quantitative ways of saying what observed barcodes or empirical barcode distributions `` mean '' .",
    "we are predominantly interested in addressing two kinds of questions :    1 .",
    "are two given empirical barcode distributions coming from the same underlying distribution ?",
    "2 .   is a particular empirical barcode distribution consistent with the hypothesis that the underlying distribution has @xmath4 `` long bars '' ?",
    "we approach both of these questions from the perspective of classical hypothesis testing , likelihood scores , and confidence intervals ; for example , see  @xcite for a review .",
    "we discuss a variety of test statistics derived from @xmath15 ; thus , the use of these procedures are justified in practice by theorem  [ thm : main ] ( and specifically corollary  [ cor : largenum ] ) .",
    "moreover , we are able to use theorem  [ thm : main ] to show that many of the test statistics we describe are robust .",
    "we begin by explaining the basic procedure for computing approximations to @xmath15 .",
    "corollary  [ cor : largenum ] justifies the treatment of @xmath15 of the empirical measure on a sufficiently large sample @xmath489 of size @xmath31 as a good approximation for @xmath490 .",
    "( note that the dependence on @xmath5 in the bound in theorem  [ thm : main ] implies that we will have to choose @xmath392 in order to expect reasonable results ; see the discussion in the next section for some examples of how to choose @xmath5 . )",
    "next , we can estimate @xmath15 on @xmath29 empirically via monte carlo simulation , i.e. , simply sampling blocks of @xmath5 samples from @xmath29 over and over again .",
    "the weak law of large numbers for empirical distributions guarantees that this estimate converges in probability as the number of such samples increases .",
    "therefore , we have an asymptotically convergent scheme for numerically approximating @xmath15 ( and hence quantities derived from it ) .",
    "we now turn to questions of statistical inference .",
    "the most basic question we can pose is whether a given observed barcode @xmath46 is more consistent with an underlying metric measure space @xmath491 or an alternate metric measure space @xmath492 .",
    "a likelihood ratio provides a good test statistic to determine an answer to this question .",
    "specifically , we can evaluate the likelihood of the hypotheses @xmath493 and @xmath494 that @xmath46 is within @xmath32 of a barcode drawn from @xmath491 and @xmath24 respectively .    given an observed barcode @xmath46 ( e.g. , obtained by sampling @xmath5 points from an unknown metric measure space @xmath495 )",
    ", we can compute the likelihood score @xmath496 for each hypothesis space @xmath13 and @xmath24 . the ratio @xmath497 then provides a test statistic for comparing the two hypotheses . to determine how to interpret the test statistics ( e.g. , to compute @xmath115-values ) ,",
    "we require knowledge of the distribution of the test statistic induced by assuming that @xmath46 was drawn from @xmath477 and @xmath498 respectively . these distributions can be approximated by monte carlo simulation , i.e. , repeated sampling from the two distributions and computation of histograms .    more generally , for a metric measure space @xmath499 and a particular subset @xmath29 of @xmath10 , we can test the hypothesis that the distribution @xmath22 has mass @xmath500 on @xmath29 as follows . for any hypothetical distribution on @xmath10 with mass @xmath500 on @xmath29 , the probability of an empirical sample of size @xmath31",
    "having @xmath501 or fewer elements in @xmath29 is bounded above by the binomial cumulative distribution function @xmath502 then given an empirical approximation @xmath503 to @xmath20 obtained from @xmath31 samples , we can test the hypothesis that @xmath20 has mass @xmath500 in @xmath29 , by taking @xmath501 to be the number of such elements in @xmath503 .",
    "when @xmath504 , we can reject this hypothesis at the @xmath505 level .",
    "another kind of question we might ask is to determine whether to reject the hypothesis that two empirical distributions on barcode space ( i.e. , @xmath15 computed based on two different large samples @xmath29 and @xmath506 ) came from the same underlying distribution . in our setting",
    "we can not assume very much about the class of possible distributions and so we are forced to rely on non - parametric methods .",
    "this imposes significant constraints  most asymptotic results on non - parametric tests for distribution comparison work only for distributions on @xmath35 .",
    "thus , the first step is to project the data from barcode space into @xmath35 .",
    "the following definition is the first of several kinds of projections we discuss .",
    "[ defn : distdistr ]",
    "let @xmath13 be a compact metric measure space .",
    "fix @xmath37 .    1 .",
    "define the distance distribution @xmath507 on @xmath35 to be the distribution on @xmath35 induced by applying @xmath508 to pairs @xmath509 drawn from @xmath510 .",
    "2 .   let @xmath46 be a fixed barcode in @xmath10 , and define @xmath511 to be the distribution induced by applying @xmath44 .",
    "since both @xmath512 and @xmath513 are continuous with respect to the gromov - prohorov metric  @xcite , corollary  [ cor : largenum ] justifies working with empirical approximations to @xmath507 and @xmath511 .",
    "one application of these projections is simply a direct use of the two - sample kolmogorov - smirnov statistic  @xcite .",
    "this test statistic gives a way to determine whether two observed empirical distributions were obtained from the same underlying distribution ; the salient feature about this statistic is that for distributions on @xmath35 the @xmath115-values of the test statistic are asymptotically independent of the underlying distribution as long as the samples are identically independently drawn .    to compute the kolmogorov - smirnov test statistic for two sets of samples @xmath514 and @xmath515 , we first compute the empirical approximations @xmath516 and @xmath517 to the cumulative density functions , @xmath518 and use the test statistic @xmath519 . in practice , since @xmath520 is large we approximate @xmath521 using monte carlo simulation .",
    "the distribution - independence of the statistic now implies that standard tables ( e.g. , in the appendix to  @xcite ) or the built - in matlab functions can then be used to compute @xmath115-values for deciding if the statistic allows us to reject the hypothesis that the distributions are the same .",
    "one might similary consider the mann - whitney test or various other nonparametric techniques for testing the same hypotheses  @xcite .",
    "for example , another way to handle this problem is to use a @xmath522 test for discrete distributions .",
    "there are many ways to construct suitable distributions for this test ; we present two natural choices here .    1 .",
    "take histograms from @xmath523 and @xmath524 with identical fixed numbers of bins and bin widths .",
    "2 .   fix a finite set @xmath525 of reference barcodes , where @xmath526 .",
    "these reference barcodes should be chosen without reference to the observed data .",
    "next , for each barcode with nonzero probability measure in ( the given empirical approximation to ) @xmath20 , assign the count to the nearest reference barcode .",
    "the second method makes sense if we have a priori information about the expected shape of the barcode distributions .",
    "let @xmath527 denote the count either for bin @xmath528 or for reference barcode @xmath529 in sample @xmath124 ( for @xmath530 ) .",
    "the test statistic in the @xmath531 test for comparing @xmath532 and @xmath533 is then defined to be @xmath534 as the notation suggest , asymptotically this has a @xmath522 distribution with @xmath535 degrees of freedom ( where @xmath536 is the number of reference barcodes with nonzero counts )  @xcite . as such , we can again look up the @xmath115-values for this distribution in standard tables when performing hypothesis testing .",
    "natural test statistics for studying hypotheses about empirical barcode distributions come from numerical summaries associated to @xmath15 .",
    "for instance , a natural test statistic measures the distance to a fixed hypothesis distribution .",
    "[ defn : hdd ] let @xmath13 be a compact metric measure space and let @xmath36 be a fixed reference distribution on @xmath10 . fix @xmath37 .",
    "define the homological distance on @xmath0 relative to @xmath36 to be @xmath38    corollary  [ cor : largenum ] again applies to show that large finite samples @xmath489 suffice to approximate @xmath73 .",
    "in fact , the convergence is better since we are working over @xmath35 and the glivenko - cantelli theorem applies .",
    "[ lem : largenumhd ] let @xmath474 be a sequence of randomly drawn samples from @xmath13 .",
    "we regard @xmath475 as a metric measure space using the subspace metric and the empirical measure .",
    "then for @xmath36 a fixed reference distribution on @xmath10 , @xmath537 converges almost surely to @xmath538 .",
    "an immediate consequence of theorem  [ thm : main ] is the following robustness result ( paralleling theorem  [ thm : mainunifrob ] ) .",
    "[ thm : mainunifrob2 ] for fixed @xmath64 , @xmath71 is uniformly robust with robustness coefficient @xmath62 and estimate bound @xmath70 for any @xmath62 .",
    "another source of tractable test statistics is the moments of the distributions introduced in definition  [ defn : distdistr ] .",
    "a virtue of distributions on @xmath35 is that they can be naturally summarized by moments ; in contrast , moments for distributions on barcode space are hard to compute ( for instance , see  @xcite ) .",
    "even simply constructing meaningful centroids for a set of points in barcode space is challenging ; for example , geodesics between close points are not unique , although the barcode metric space is a length space ( it is straightforward to construct midpoints between any pair of barcodes ) . because we have emphasized robust statistics , we work with the median or a trimmed mean and introduce the following test statistics :    [ defn : ahdbody ]",
    "let @xmath13 be a compact metric measure space and fix a reference barcode @xmath539 .",
    "fix @xmath37 .",
    "define the median homological distance relative to @xmath46 to be @xmath540 for @xmath541 , define the @xmath128-trimmed mean homological distance to be @xmath542 where @xmath501 denotes the quantile function .",
    "( roughly speaking , we discard the fraction @xmath128 of the highest and lowest values and take the mean of the remainder . )    again , corollary  [ cor : largenum ] implies that consideration of large finite samples @xmath489 suffices to approximate these test statistics .",
    "[ lem : largenumahd ] let @xmath474 be a sequence of randomly drawn samples from @xmath13 .",
    "we regard @xmath475 as a metric measure space using the subspace metric and the empirical measure .",
    "let @xmath539 be a fixed reference barcode .    1 .",
    "assume that @xmath543 has a distribution function with a positive derivative at the median .",
    "then @xmath544 almost surely converges to @xmath545 .",
    "@xmath546 almost surely converges to @xmath547 .    as in the proof of corollary  [ cor : largenum ]",
    ", the fact that @xmath478 converges to @xmath13 in the gromov - prohorov metric implies that @xmath548 weakly converges to @xmath43 .",
    "now the central limit theorem for the sample median ( see for instance ( * ? ? ? * iii.4.24 ) ) and the hypothesis about the derivative at the median implies the convergence of medians .",
    "analogously , the central limit theorem for the trimmed mean  @xcite ( which holds without further assumption provided that @xmath549 ) gives the second part of the result .    the hypothesis on the median is the standard hypothesis for consistency of the central limit theorem ( and the bootstrap estimator for ) the sample median ; it is known that this hypothesis is required  @xcite .",
    "although it is our experience that this hypothesis holds in practice , it can be difficult to rigorously verify for an unknown underlying distribution . for this reason , the use of the trimmed mean may be preferable in cases where constraint on the possible hypotheses is unavailable .",
    "as @xmath128 approaches @xmath550 , the trimmed mean converges to the median , and so choosing @xmath551 for small @xmath32 yields a reasonable alternative to the median .    as discussed in the introduction , a counting argument yields the following robustness result .",
    "[ thm : ahdrobustbody ] for any @xmath552 , the function @xmath553 from finite metric spaces ( with the uniform probability measure ) to @xmath35 is robust with robustness coefficient @xmath66 .    for a finite metric space @xmath0 , expanding @xmath0 to @xmath33 , the proportion of @xmath5-element samples of @xmath33 which are samples of @xmath0 is @xmath58 ; when this number is more than @xmath59 , the median value of any function @xmath48 on the set of @xmath5-element samples of @xmath33 is then bounded by the values of @xmath48 on @xmath5-element samples of @xmath0 . since @xmath60 for @xmath61 ,",
    "any such function @xmath48 will be robust with robustness coefficient @xmath62 satisfying this bound , and in particular for @xmath63 .    in order to obtain the @xmath115-value cutoffs for performing hypothesis testing",
    ", we can again use monte carlo simulation to estimate the distribution of these estimators under different hypotheses .",
    "another possibility is to use asymptotic estimates , which we discuss below in the context of confidence intervals .",
    "we close the section by remarking that there are many other possible numerical invariants one might associate to @xmath15 ( and apply as test statistics ) .",
    "for instance , we define for a barcode @xmath46 the quantity @xmath554 where @xmath555 denotes the @xmath124th largest interval in @xmath46 . then the quantity @xmath556 and the related quantity @xmath557 are useful test statistics for determining if there is a group of `` long bars '' in the underlying distribution by checking for which ( if any @xmath390 ) has a large value of @xmath558 . for instance ,",
    "when @xmath559 is small this suggests that the underlying metric measure space is generated by a topological space with no homology in dimension @xmath4 .",
    "and large values of @xmath560 suggest that the underlying space has rank @xmath390 homology in dimension @xmath4 .",
    "of course , in order to make precise statistical statements to replace `` suggests '' , we have to use monte carlo simulation in order to compute @xmath115-values and confidence intervals .      for @xmath73 ,",
    "the only way to produce @xmath115-values and confidence intervals is to use monte carlo simulation ( to estimate the distribution of @xmath73 on finite approximations to @xmath561 ) .",
    "a particular advantage of @xmath74 is that we can define confidence intervals using the standard non - parametric techniques for determining confidence intervals for the median and trimmed mean  @xcite . for the median ,",
    "we use appropriate sample quantiles ( order statistics ) to determine the bounds for an interval which contains the actual median with confidence @xmath562 .",
    "these confidence intervals then immediately yield cutoffs for @xmath115-values for hypothesis testing .",
    "for example , a simple approximation can be obtained from the fact that order statistics asymptotically obey binomial distributions , which lead to the following definition using the normal approximation to the binomial distribution .",
    "[ defn : confint ] let @xmath491 be a metric measure space and @xmath46 a fixed barcode .",
    "fix @xmath563 and @xmath69 .",
    "given @xmath390 samples from @xmath511 , let @xmath564 denote the samples sorted from smallest to largest .",
    "let @xmath565 denote the @xmath566 significance threshold for a standard normal distribution .",
    "the @xmath567 confidence interval for the sample median ( i.e. , @xmath74 ) is given by the interval @xmath568.\\ ] ]    for the trimmed mean , the situation is similar : asymptotic confidence intervals can be obtained from the sample standard deviation and an explicit formula  @xcite . since we find that the median converges in practice , we do not write out the formula here ( as it involves a number of complicated auxiliary quantities ) and refer the interested reader to the cited reference .      in the preceding discussion , the @xmath115-values and confidence intervals for our tests are always computed either via monte carlo simulation ( i.e. , sampling to estimate the distribution of the test statistic ) or using formulas derived from asymptotic results .",
    "the latter are substantially easier and less computationally intensive to apply .",
    "however , we may be concerned about whether sample sizes are large enough for the asymptotic @xmath115-value to be good approximations of the exact @xmath115-value  this issue is a pervasive problem when applying such non - parametric tests based on asymptotic results ( e.g. , see  @xcite ) .",
    "a standard approach to mitigating such concerns is to perform monte carlo simulation of the distribution of these test statistics computed from representative models for @xmath15 ( e.g. , synthetic distributions generated by various standard manifolds ) ; this provides heuristic guidance about suitable sample sizes .",
    "we provide some example calculations of this form in section  [ sec : examples ] below .",
    "however , the careful analyst with access to adequate samples and computer resources may simply choose to rely on monte carlo simulation methods .",
    "when adequate samples are lacking , resampling methods also often provide a more reliable means to compute cutoffs than asymptotic results .",
    "for instance , standard results about the consistency of the bootstrap for the sample median and sample trimmed mean  @xcite allow us to compute @xmath115-value thresholds and cofidence intervals for @xmath74 via bootstrap resampling .",
    "in this section , we provide numerical experiments on synthetic data sets to demonstrate the statistical inference procedures and robustness results described in the previous section .",
    "we study a pair of examples embedded in @xmath569 ( an annulus and a pair of nested circles ) and three families of examples in @xmath570 ( spheres , tori , and uniform noise in a box ) .",
    "although the examples embedded in @xmath569 are essentially trivial , the simplicity of the expected results allows us to focus on the methodology .",
    "the examples in @xmath570 are more realistic but correspondingly are more complicated to interpret .",
    "all of our experiments rely on the following procedures for producing empirical approximations to @xmath15 .",
    "we fix a monte carlo parameter @xmath571 which is large ( we discuss estimates of how large @xmath571 needs to be below ) .",
    "we then have the following basic algorithm :    [ alg : absolute ] for a fixed metric measure space @xmath13 .    1 .",
    "uniformly select @xmath571 subsamples of size @xmath5 from @xmath572 .",
    "2 .   compute the empirical approximation to @xmath15 from the @xmath571 subsamples .",
    "to better represent the use of these procedures in practice , we have the following variant algorithm .",
    "fix a subsample size @xmath31 .",
    "[ alg : relative ] for a fixed metric measure space @xmath13 .    1 .   uniformly sample @xmath31 points from @xmath572 .",
    "2 .   uniformly select @xmath571 subsamples of size @xmath5 from the empirical measure on the @xmath31 samples .",
    "compute the empirical approximation to @xmath15 from the @xmath571 subsamples .    to actually carry out these algorithms",
    ", we used the perseus codebase  @xcite to compute persistent homology from a finite metric space , executed from within a series of python and cython scripts that ran our various experimental setups . in order to avoid combinatorial explosion in the number of simplices when the scale parameter results in complete graphs , we typically capped the maximum scale parameter ( i.e. , truncated each of the bars in the barcodes )",
    "the experiments were run on various stock linux machines ; no individual experiment took more than a few minutes to complete .",
    "our random number generation was done using the gsl library  @xcite to produce uniform and gaussian samples , and rejection sampling to simulate all other distributions ( as described below ) .",
    "we first consider a simple example which illustrates the robustness of the distributional invariants .",
    "the underlying metric measure space @xmath21 is an annulus of inner radius @xmath573 and outer radius of @xmath574 in @xmath575 ( see figure  [ fig : ann ] ) , equipped with the subspace metric and the area measure .",
    "the underlying manifold of @xmath21 is clearly homotopy equivalent to a circle .",
    "we sample from the annulus via rejection sampling ; we sample uniformly from the bounding box @xmath576 \\times [ -1.2 , 1.2]$ ] and only keep points @xmath577 such that @xmath578",
    ".    we began by examining the rate of convergence in corollary  [ cor : largenum ] .",
    "specifically , for @xmath579 and various @xmath5 , we consider subsamples @xmath475 in the annulus of increasing cardinality and study the convergence of various distributions derived from @xmath580 , using algorithms  [ alg : absolute ] and  [ alg : relative ] as a base .",
    "we compute the distance distribution @xmath512 from @xmath580 and @xmath581 as the cardinality @xmath582 of @xmath475 increases and @xmath5 varies , using a barcode cutoff of @xmath583 .",
    "we then used both the kolmogorov - smirnov test and the @xmath531 test on histograms to repeatedly compare the estimates computed from samples of cardinality @xmath582 to each other and to the reference distribution from @xmath21 .",
    "fixing @xmath584 , our results indicated that @xmath585 sufficed to approximate the distribution for @xmath586 ; with these parameters , we were essentially never able to reject the null hypothesis that the two distributions were drawn from the same underlying distribution .    [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "one of the most prominent applications of persistent homology in topological data analysis is the study of the natural images dataset described in  @xcite .",
    "this data consists of @xmath587 patches sampled from still photographs of `` natural '' scenes ( i.e. , pictures of rural areas without human artifacts ) .",
    "the results of carlsson , ishkhanov , de silva , and zomorodian  @xcite extract topological signals from this data set which can be interpreted in terms of collections of patches which are known to be meaningful based on the neurophysiology of the eye .",
    "the goal of this section is to apply our statistical methodology to validate the conclusions of their work .",
    "we compute the confidence intervals based on @xmath74 for a subset of patches from the natural images dataset as described in  @xcite .",
    "we briefly review the setup .",
    "the dataset consists of 15000 points in @xmath588 , generated as follows .",
    "from the natural images , @xmath587 patches ( dimensions given in pixels ) were sampled and the top @xmath589 with the highest contrast were retained .",
    "these patches were then normalized twice , first by subtracting the mean intensity and then scaling so that the euclidean norm is @xmath89 .",
    "the resulting dataset can be regarded as living on the surface of an @xmath590 embedded in @xmath588 . after performing density filtering ( with a parameter value of @xmath591 ; refer to @xcite for details ) and randomly selecting @xmath592 points , we are left with the dataset @xmath593 . at this density , one tends to see a barcode corresponding to 5 cycles in the @xmath594 . in the klein bottle model ,",
    "these cycles are generated by three circles , intersecting pairwise at two points ( which can be visualized as unit circles lying on the @xmath595-plane , the @xmath596-plane , and the @xmath597-plane ) .",
    "we computed empirical approximations to @xmath598 using algorithm  [ alg : absolute ] , with @xmath584 and using a barcode cutoff of @xmath599 ( we used the value reported in  @xcite as the maximal filtration value ) .",
    "we found that ( after applying @xmath4-means clustering , as above ) the weight was distributed as 0.1% with one long bar , 1.1% with two long bars , 7.4% with three long bars , 34.2% with four long bars , and 57.2% with five long bars .",
    "( here the threshold for a long bar was @xmath89 . ) analyzing likelihood test statistics as in section  [ sec : like ] , we find that the underlying distribution has at least 95% of its mass on two , three , or four bars at the the 99.7% confidence level .",
    "we also analyze the results using @xmath600 .",
    "we use as the hypothesis barcode the multi - set @xmath601 .",
    "we find using the nonparametric estimate from definition  [ defn : confint ] that the 95% confidence interval for @xmath602 is @xmath603 $ ] .",
    "the 99% confidence interval for @xmath604 is @xmath605 $ ] .",
    "these results represents high confidence for the data to be further than @xmath606 but closer than @xmath607 to the reference barcode . on the other hand ,",
    "when we compute the confidence intervals using the reference barcode the empty set , we find that both endpoints for the 95% and 99% confidence intervals are the cutoff value of @xmath599 .",
    "we find the same results for hypothesis barcodes with @xmath353 bars @xmath608 for @xmath609 .",
    "in particular , this means that the differences between the distance to the @xmath610 bar hypothesis and any other is statistically significant at the 99% level .",
    "we interpret these results to suggest that the hypothesis barcode is consistent with the underlying distribution amongst barcode distributions that put all of their mass on a single barcode .",
    "of course , these results also suggest that when sampling at 500 points , we simply do not expect to see a distribution that is heavily concentrated around a single barcode . in the next subsection",
    ", we discuss the use of the witness complex , which does result in such a narrow distribution .",
    "to validate the non - parametric estimate of the confidence interval , we also used bootstrap resampling to compute bootstrap confidence intervals .",
    "although we do not justify or discuss further this procedure herein , we note that we observed the reassuring phenomenon that the bootstrap confidence intervals agreed closely with the non - parametric estimates for both the 95% confidence intervals and the 99% confidence intervals in each instance .      because of the size of the datasets involved , the analysis performed in  @xcite used the weak witness complex @xmath611 rather than the vietoris - rips complex @xmath612 .",
    "the weak witness complex for a metric space @xmath77 depends on a subset @xmath613 of witnesses ; the size of the complexes is controlled by @xmath614 and not @xmath56 .    for @xmath83 , @xmath84 and witness set @xmath615",
    ", the weak witness complex @xmath616 is the simplicial complex with vertex set @xmath617 such that @xmath86 $ ] is an @xmath5-simplex when for each pair @xmath87 , there exists a point @xmath618 ( a witness ) such that the distances @xmath619 .",
    "when working with the witness complex , we adapt our basic approach to study the induced distribution on barcodes which comes from fixing the point cloud and repeatedly sampling a fixed number of witnesses .",
    "the theoretical guarantees we obtained for the vietoris - rips complex in this paper do not apply directly ; we intend to study the robustness and asymptotic behavior of this process in future work . here , we report preliminary numerical results .",
    "specifically , we again computed empirical approximations to @xmath620 using algorithm  [ alg : absolute ] , with @xmath621 and using a barcode cutoff of @xmath599 .",
    "however , to produce the underlying complex , we use the @xmath5 points for each subsample as the landmark points @xmath617 in the construction of the witness complex rather than as the vertices for the vietoris - rips complex .",
    "we use as the hypothesis barcode the multi - set @xmath622 as above .",
    "we found using the non - parametric estimate of definition  [ defn : confint ] that the 95% confidence interval for @xmath623 , is @xmath624 $ ] . the 99% confidence interval for @xmath623 was also",
    "@xmath625 $ ] . when we computed the 95% confidence interval for @xmath626 we obtained @xmath627 $ ] .",
    "the 99% confidence interval for @xmath628 was @xmath629 $ ] .",
    "this represents high confidence for the data to be further than @xmath630 ( for @xmath631 ) and @xmath632 ( for @xmath633 ) but closer than @xmath632 ( for @xmath631 ) and @xmath634 ( for @xmath633 ) to the reference barcode .",
    "we obtained essentially the same results @xmath635 as for @xmath636 . on the other hand , when using hypothesis barcodes with @xmath353 bars @xmath608 for @xmath609 , the confidence intervals start and end at @xmath599 .",
    "again , this means that the difference between the distances to the 5-bar hypothesis and the other hypotheses is statistically significant at the 99% level .",
    "we interpret these results to mean that the underlying distribution is essentially concentrated around the hypothesis barcode ; the distance of @xmath637 is essentially a consequence of noise .",
    "in contrast , when we compute @xmath638 ( using the same experimental procedure as above ) , we find the confidence interval is @xmath639 $ ] .",
    "when we compute @xmath640 , we find that the confidence interval is @xmath641 $ ] .",
    "this represents high confidence that @xmath642 and @xmath643 are far from this reference barcode , which in light of the confidence intervals above for @xmath636 and @xmath635 appear to indicate that samples sizes 25 and 75 are too small .",
    "p.  bubenik , g.  carlsson , p.  t.  kim , and z .- m .",
    "statistical topology via morse theory persistence and nonparametric estimation . in _ algebraic methods in statistics and probability",
    "math . , 516:7592 .",
    "soc . , providence , ri , 2010 .",
    "m.  k.  chung , p.  bubenik , and p.  t.  kim .",
    "persistence diagrams in cortical surface data . in _ information processing in medical imaging ( ipmi ) 2009",
    "_ , 5636:386397 , lecture notes in computer science , 2009 ."
  ],
  "abstract_text": [
    "<S> we study distributions of persistent homology barcodes associated to taking subsamples of a fixed size from metric measure spaces . </S>",
    "<S> we show that such distributions provide robust invariants of metric measure spaces , and illustrate their use in hypothesis testing and providing confidence intervals for topological data analysis . </S>"
  ]
}