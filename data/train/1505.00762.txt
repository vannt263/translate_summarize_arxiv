{
  "article_text": [
    "in the classification of unstable first - order theories , the dividing lines given by @xmath7 and @xmath4 have consistently thwarted progress in understanding general structural behavior for theories without the strict order property ( i.e. @xmath8 theories ) . on the other hand , all of the known examples of @xmath8 theories are either simple or have @xmath7 ; and many ( if not most ) non - simple examples have @xmath4 as well .",
    "whether these observations will lead to general theorems remains an intriguing open question .",
    "the goal of this paper is to develop structural results for a general subclass of @xmath8 theories , called _ free amalgamation theories _ , which are defined by the existence of an abstract ternary notion of independence resembling free amalgamation in relational structures .",
    "this subclass will include many well - established examples of theories which are either simple or have @xmath4 and @xmath7 .",
    "the canonical examples are frass  limits , closed under free amalgamation , such as the random graph ( or _ rado graph _ ) and generic @xmath3-free graphs ( or _ henson graphs _ ) . other examples , in which free amalgamation is more restricted , include the generic @xmath9-free graphs constructed by komjth @xcite and cherlin , shelah , and shi @xcite , as well as a small class of well - behaved hrushovski constructions .",
    "the reason for focusing on free amalgamation theories is that a significant majority of the known examples of non - simple @xmath8 theories are  generic \" structures with a high level of homogeneity . at present , it is still unclear how to precisely distill the nature of @xmath8 homogeneous structures .",
    "however , our results will show that homogeneity arising from _ free _ amalgamation has significant consequences for the model theory of the structure .",
    "moreover , the essential features of free amalgamation can be described by a model theoretic axiomatic framework , which allows cumbersome syntactic analysis to be replaced by smoother  geometric \" arguments .",
    "there is currently only one other axiomatic framework which includes examples of @xmath8 theories with @xmath7 and @xmath4 , namely , thorn - forking in rosy theories .",
    "however , the class of rosy theories is quite broad , and rosiness alone does not imply the specific instances of good model theoretic behavior that we will obtain here for free amalgamation theories .",
    "the main results are as follows .",
    "we first verify that free amalgamation theories are indeed a subclass of @xmath8 theories .",
    "in particular , using a similar argument as in unpublished work of patel @xcite , we give a short proof that any free amalgamation theory is @xmath10 ( see theorem [ thm : nsop4 ] ) .",
    "this generalizes patel s methods to the axiomatic framework , and crystallizes the frequently observed connection between free amalgamation and @xmath10 .",
    "this result also overlaps with work of evans & wong @xcite on certain hrushovski constructions , and work of shelah and usvyatsov @xcite on groups .",
    "we then show that any free amalgamation theory has elimination of hyperimaginaries and weak elimination of imaginaries ( see theorem [ thm : wei ] ) . using this",
    ", we provide new examples of rosy theories , including the class of frass  limits closed under free amalgamation , which are superrosy of @xmath11-rank @xmath2 .",
    "we also show that the generic @xmath9-free graphs are superrosy of @xmath11-rank @xmath12 ( see theorem [ thm : bowtie ] ) .",
    "finally , we analyze the role of simplicity in free amalgamation theories .",
    "we show that simplicity coincides with @xmath0 and also with the equivalence of nonforking and algebraic independence ( see theorem [ thm : simp ] ) . as a corollary",
    ", it follows that any simple free amalgamation theory is modular ( in the sense of @xcite ) . using the results above on ( hyper)imaginaries ,",
    "we then show that any simple free amalgamation theory is @xmath2-based ( see corollary [ cor:1b ] ) .",
    "we also prove that , for modular free amalgamation theories , simplicity coincides with @xmath1 ( see theorem [ thm : nsop3 ] ) . in particular , modular free amalgamation theories",
    "form the first example of a general , axiomatically defined class of first - order theories , in which we ( nontrivially ) obtain the equivalence of simplicity , @xmath0 , and @xmath1 ( which , as previously noted , seems to be a much broader phenomenon ) .    for our main class of motivating examples , this results in the following fairly complete analysis of model theoretic behavior .",
    "suppose @xmath13 is a countable ultrahomogeneous structure , in a finite relational language , whose age is closed under free amalgamation of @xmath14-structures .",
    "let @xmath15 .    1 .",
    "@xmath16 has elimination of hyperimaginaries and weak elimination of imaginaries , and is rosy with @xmath17 .",
    "@xmath16 is @xmath10 .",
    "moreover , the following are equivalent . 1 .",
    "@xmath16 is simple .",
    "@xmath16 is @xmath0 .",
    "@xmath16 is @xmath1 .",
    "if @xmath16 is simple then it is supersimple , of @xmath18-rank @xmath2 , and @xmath2-based .",
    "the statements in this theorem are consequences of the various main results in this paper , which are shown for the more general class of free amalgamation theories ( definition [ def : fat ] ) . given @xmath13 as in the theorem",
    ", the justification that @xmath19 is a free amalgamation theory is done in proposition [ prop : ex ] .",
    "several parts of the theorem also require the observation that @xmath19 is modular , which follows from the fact that algebraic closure in @xmath13 is trivial ( see proposition [ prop : alg]@xmath20 ) .",
    "part @xmath21 , which answers questions posed to us by cameron hill and vera koponen , combines theorem [ thm : wei ] , corollary [ cor : farosy ] , and proposition [ prop : triv ] .",
    "part @xmath22 combines theorems [ thm : nsop4 ] , [ thm : simp ] , and [ thm : nsop3 ] .",
    "part @xmath23 uses corollary [ cor:1b ] to conclude @xmath16 is @xmath2-based , and uses the description of forking given by theorem [ thm : simp ] to conclude @xmath16 is supersimple su - rank @xmath2 ( it is also a general fact that @xmath24-rank and @xmath25-rank coincide for supersimple theories",
    "* theorem 5.1.4 ) ) .",
    "part @xmath23 also provides progress toward a question of koponen @xcite on whether _ any _ countable , simple , ultrahomogeneous structure , in a finite relational language , is @xmath2-based .",
    "we again emphasize that @xmath10 in part @xmath22 was first proved by patel @xcite . after obtaining our results",
    ", we later found that weak elimination of imaginaries in part @xmath21 also follows from ( * ? ? ?",
    "* lemma 2.7 ) .    the final result of the paper , theorem [ thm : irred ] , is a combinatorial characterization of simplicity for @xmath19 , given in terms of _ irreducibility _ of forbidden substructures , for certain @xmath13 as in the theorem above .",
    "the proof uses a generalization of a result of hrushovski @xcite on the generic @xmath5-free @xmath6-hypergraphs ( with @xmath26 ) .",
    "i would like to thank david evans , vera koponen , alex kruckman , maryanthe malliaris , and rehana patel for many fruitful conversations .",
    "i also thank the referee for several improvements to the exposition , and vera koponen for pointing out an error in an earlier version .",
    "fix a complete first - order theory @xmath16 and a @xmath27-saturated monster model @xmath28 of @xmath16 , for @xmath27 sufficiently large .",
    "we write @xmath29 to mean @xmath30 and @xmath31 . given @xmath32 , we let @xmath33 denote @xmath34 .",
    "we use singletons @xmath35 to denote tuples of length @xmath36 . given a tuple @xmath37 , we let @xmath38 denote the length ( or domain ) of @xmath37 and , abusing notation , we identify @xmath37 with the subset of @xmath28 given by the range of @xmath37 . we write",
    "@xmath39 to mean @xmath37 is a tuple of elements from @xmath28 .",
    "when the domain of the tuple is important , we may emphasize this by writing @xmath40 .",
    "given an automorphism @xmath41 and a tuple @xmath42 , we let @xmath43 denote the tuple @xmath44 . given tuples @xmath45 , and @xmath46 , we write @xmath47 if @xmath48 , for some common domain @xmath49 , and @xmath50 for some @xmath51 .    in many cases ,",
    "we index _ sequences _ of tuples with subscripts ( e.g. @xmath52 , where each @xmath53 is a tuple ) .",
    "therefore , in situations where we also want to reference the specific coordinates of the tuples in such a sequence , we will use superscripts to index tuples and subscripts to index coordinates ( e.g. @xmath54 with @xmath55 ) .",
    "suppose @xmath40 is a tuple with domain @xmath49 .",
    "a _ subtuple _ of @xmath37 is a tuple of the form @xmath56 , where @xmath57 is a subset of @xmath49 .",
    "we write @xmath58 to denote that @xmath59 is a subtuple of @xmath37 .",
    "given an indiscernible sequence @xmath60 , we define the _ common intersection _ of @xmath61 to be the ( possibly empty ) subtuple @xmath62 , where @xmath63 .",
    "let @xmath64 denote algebraic closure in @xmath28 ; @xmath29 is _ closed _ if @xmath65 .",
    "we say :    1 .",
    "@xmath64 is _ locally finite _ if @xmath66 is finite for all finite @xmath29 ; 2 .",
    "@xmath64 is _ disintegrated _ if , for all @xmath29 , @xmath67 ; 3 .",
    "@xmath64 is _ trivial _ if @xmath65 for all @xmath29 .",
    "we now define axioms of abstract ternary relations on ( small subsets of ) @xmath28 .",
    "some axioms have been slightly adjusted from their standard formulations , and incorporate algebraic closure of the small subsets in question .",
    "[ axioms ] given a ternary relation @xmath68 on @xmath28 , define the following axioms .    1 .   _",
    "( invariance ) _ for all @xmath69 , if @xmath70 and @xmath41 then @xmath71 .",
    "( monotonicity ) _ for all @xmath69 , if @xmath70 , @xmath72 , and @xmath73 , then @xmath74 .",
    "( symmetry ) _ for all @xmath69 , if @xmath70 then @xmath75 .",
    "( full transitivity ) _ for all @xmath76 and @xmath77 , @xmath78 if and only if @xmath70 and @xmath79 .",
    "( full existence ) _ for all @xmath80 and tuples @xmath39 , if @xmath81 is closed then there is @xmath82 such that @xmath83",
    "( stationarity ) _ for all closed @xmath46 and closed tuples @xmath84 , with @xmath85 , if @xmath86 , @xmath87 , and @xmath82 , then @xmath88 . 7 .   _",
    "( freedom ) _ for all @xmath89 , if @xmath70 and @xmath90 , then @xmath78 . 8 .   _",
    "( closure ) _ for all closed @xmath69 , if @xmath91 and @xmath70 then @xmath33 is closed .",
    "there is a significant body of literature concerning axioms of ternary notions of independence .",
    "an excellent introduction can be found in @xcite .",
    "the choice of axioms in definition [ axioms ] also borrows heavily from tent and ziegler s work with _ stationary independence relations _",
    "@xcite , and so we give the following adaptation of their definition to the present context .",
    "[ def : sir ] a ternary relation @xmath68 is a * stationary independence relation * for @xmath16 if it satisfies invariance , monotonicity , symmetry , full transitivity , full existence , and stationarity .",
    "several comments are warranted at this point .",
    "first , tent and ziegler s definition in @xcite is formulated for finite subsets of a countable structure , and does not include any closure assumptions in the full existence or stationarity axioms .",
    "moreover , the clause  @xmath85 \" is not present in their formulation of stationarity .",
    "the main examples in @xcite have trivial algebraic closure and , in such cases , one may show that the two notions of a stationary independence relation are the same . in @xcite , evans ,",
    "ghadernezhad , and tent also consider axioms of ternary relations , which have been relativized to the lattice of algebraically closed sets .    the clause",
    " @xmath85 \" in the stationarity axiom will be necessary in the subsequent work .",
    "on the other hand , one may easily show that , if @xmath68 is a ternary relation satisfying monotonicity , then the full existence axiom is equivalent to the version obtained by adding  @xmath92 \" to the assumptions .",
    "we will tacitly use this observation when discussing examples in the next section .    finally , we point out that tent and ziegler @xcite do formulate the freedom axiom ( although they do not give it a name ) .",
    "this axiom is also very close to hrushovski s notion of cm - triviality @xcite .",
    "we now define the central notion of this paper .",
    "[ def : fat ] a ternary relation is a * free amalgamation relation * if it satisfies invariance , monotonicity , symmetry , full transitivity , full existence , stationarity , freedom , and closure .",
    "@xmath16 is a * free amalgamation theory * if it has a free amalgamation relation .",
    "the main results of this paper concern properties of free amalgamation theories .",
    "the reader will notice that some results do not , in and of themselves , require all parts of the previous definition .",
    "therefore , to obtain the conclusion of a particular result , it may not be necessary for @xmath16 to have a ternary relation satisfying every ingredient of definition [ def : fat ] .",
    "in order to state the motivating examples of free amalgamation theories , we must first define the notion of free amalgamation of relational structures , which gives rise to the canonical example of a ternary relation satisfying the freedom axiom . given a relational language @xmath14 and @xmath14-structures @xmath69",
    ", we write @xmath93 if there is an @xmath14-isomorphism from @xmath94 to @xmath95 , which fixes @xmath81 pointwise .",
    "[ def : fa ] assume @xmath14 is relational .",
    "given an @xmath14-structure @xmath13 and @xmath96 , we set @xmath97 ( in @xmath13 ) if @xmath98 and , for all @xmath99 and @xmath100 ( of length the arity of @xmath101 ) , if @xmath102 holds then @xmath103 or @xmath104 .    to mitigate possible confusion",
    ", we emphasize that we are now using the phrase  free amalgamation \" in two different ways . in particular , when we say @xmath68 is a ",
    "free amalgamation relation \" , or @xmath16 is a ",
    "free amalgamation theory \" , we mean with respect to the definition involving abstract axioms of ternary relations .",
    "when considering structures in a relational language , we will use  free amalgamation of relational structures \" ( or  free amalgamation of @xmath14-structures \" ) when referring to the notion of freely amalgamating such structures as in the previous definition .",
    "[ ex]@xmath105    1 .",
    "[ ex1]*frass  limits with free amalgamation .",
    "* let @xmath14 be a finite relational language and let @xmath13 be the frass  limit of a frass  class @xmath106 of finite @xmath14-structures , which is _ closed under free amalgamation of @xmath14-structures _",
    ", i.e. , for all @xmath107 , with @xmath91 , there is @xmath108 such that @xmath109 , @xmath110 , and @xmath111 ( in @xmath112 ) . in this case",
    ", @xmath19 is @xmath113-categorical and @xmath64 is trivial ( see ( * ? ? ?",
    "* chapter 7 ) ) .",
    "we give a few examples .",
    "1 .   if @xmath106 is the class of graphs , then @xmath13 is the _ random graph _ or _",
    "rado graph_. 2 .   given",
    "fixed @xmath114 , let @xmath106 be the class of @xmath5-free @xmath6-hypergraphs , where @xmath5 is the complete @xmath6-hypergraph on @xmath115 vertices , considered in the @xmath6-hypergraph language containing an @xmath6-ary relation symbol",
    ". then @xmath13 is the _",
    "generic @xmath5-free @xmath6-hypergraph_. when @xmath116 , we also refer to @xmath13 as the _ generic @xmath3-free graph _ or _",
    "henson graph_. 3 .",
    "let @xmath106 be the class of finite metric spaces , with distances in @xmath117 , in the language @xmath118 where , for @xmath119 , @xmath120 is a binary relation interpreted as @xmath121 . if @xmath122 , with @xmath91 and @xmath123 , then @xmath97 ( in @xmath112 ) if and only if @xmath124 for all @xmath125 and @xmath126 . by the triangle inequality",
    ", @xmath106 is closed under free amalgamation of @xmath14-structures .",
    "the frass  limit @xmath13 is the _ urysohn space with spectrum @xmath117_. this structure is also called the _ free third root of the complete graph _ by casanovas and wagner in @xcite .",
    "note that @xmath127 is _ not _ the usual free amalgamation of metric spaces , which is the stationary independence relation used by tent and ziegler @xcite in their analysis of the rational urysohn space . in general ,",
    "free amalgamation of metric spaces fails the freedom axiom .",
    "2 .   [ ex2]*generic @xmath9-free graph . * fix @xmath128 and let @xmath129 be the graph obtained by freely amalgamating @xmath3 and @xmath130 over a single vertex",
    ". in @xcite , cherlin , shelah , and shi construct the unique countable , universal , existentially closed @xmath9-free graph , which we denote @xmath131 ( @xmath132 was originally constructed by komjth @xcite ) .",
    "for any @xmath128 , @xmath133 is @xmath113-categorical and @xmath64 is disintegrated ( see @xcite ) .",
    "however , the age of @xmath131 is _ not _ closed under free amalgamation of arbitrary relational structures ( e.g. @xmath129 itself is obtained as the free amalgamation of two @xmath9-free graphs ) .",
    "accordingly , the age of @xmath131 is not a frass  class in the graph language .",
    "however , it is shown in @xcite that this class is closed under free amalgamation of relational structures over _ algebraically closed _ base structures .",
    "3 .   [ ex3]*freely disintegrated \" hrushovski constructions .",
    "* let @xmath14 be a finite relational language , and let @xmath134 be the hrushovski generic produced from a class @xmath135 of finite structures closed under free amalgamation of strong substructures , where @xmath136 is a  good \" control function ( see @xcite , @xcite for details ) . in this case , @xmath137 is @xmath113-categorical , but @xmath127 does not necessarily satisfy the closure axiom , and so we must separately impose this assumption .",
    "note that , if @xmath64 is disintegrated and @xmath138 are closed , then @xmath33 is closed as well .",
    "therefore , the closure axiom for @xmath127 is asserting that @xmath64 is  freely disintegrated \" .",
    "it will follow from results in section [ sec : simple ] that any simple hrushovski construction satisfying these assumptions is modular , and so this framework is not suitable for the well - known non - modular hrushovski counterexamples .",
    "we will show that if @xmath13 is one of the countable structures defined in example [ ex ] , then @xmath19 is a free amalgamation theory .",
    "first , we note that in any relational structure , the ternary relation @xmath127 always satisfies several of our axioms ( most importantly , @xmath127 satisfies freedom ) .",
    "[ isf ] assume @xmath14 is relational and @xmath13 is an @xmath14-structure .",
    "then @xmath127 satisfies invariance , monotonicity , symmetry , full transitivity , and freedom ( in @xmath13 ) .",
    "the proof is straightforward , and left to the reader . with this result",
    ", we see that in order to use @xmath127 to obtain a free amalgamation relation for the previous examples , the key axioms to verify are _ full existence _",
    ", _ stationarity _ , and _",
    "closure_.    [ prop : ex ] suppose @xmath13 is one of the countable structures described in example [ ex ] . then @xmath127 is a free amalgamation relation for @xmath19 .    we need to verify that @xmath127 satisfies existence , stationarity , and closure . by @xmath113-categoricity",
    ", it suffices to work with finite subsets of @xmath13 . in each example",
    ", the closure axiom is either by assumption or follows from the fact that @xmath64 is disintegrated , and so the the union of two closed sets is closed .",
    "the existence axiom for [ ex].[ex1 ] and [ ex].[ex3 ] is by assumption , and is shown for [ ex].[ex2 ] in @xcite .",
    "for stationarity , fix finite , closed @xmath139 and @xmath140 such that @xmath85 , @xmath141 , @xmath142 and @xmath143 .",
    "we want to show @xmath144 . from @xmath82 , @xmath141 , and @xmath142",
    ", it follows that @xmath145 .",
    "moreover , @xmath146 and @xmath147 are closed since @xmath127 satisfies closure .",
    "therefore , @xmath144 follows from the fact that any @xmath14-isomorphism between finite closed subsets of @xmath13 extends to an automorphism of @xmath13 ( see @xcite , @xcite , @xcite for , respectively , [ ex].[ex1 ] , [ ex].[ex2 ] , [ ex].[ex3 ] ) .    the interested reader should consult the sources mentioned in the previous proof to find explicit descriptions of algebraic closure in the three families of examples .",
    "we also remark that the assumption of a finite language in examples [ ex].[ex1 ] and [ ex].[ex3 ] is there to ensure @xmath113-categoricity and the appropriate level of quantifier elimination . this assumption can be weakened slightly to encompass countable relational languages with only finitely many relations of any given arity , provided that we restrict to structures in which the interpretation of any relation is irreflexive .    in the proof of proposition [",
    "prop : ex ] , we used the closure axiom to prove stationarity .",
    "we will not explicitly use the closure axiom again until section [ sec : simple ] .",
    "in this section , we show that free amalgamation theories form a subclass of first - order theories without the strict order property .",
    "in fact , we prove these theories are @xmath10 . this has been shown for each of the examples in the previous section by collective work of several authors including shelah @xcite , hrushovski @xcite , evans & wong @xcite , patel @xcite , and joint work with terry @xcite . the most general argument in this direction can be found in unpublished work of patel @xcite , which proves @xmath10 for example [ ex].[ex1 ] and example [ ex].[ex2 ] . our argument for @xmath10 , while slightly simpler and more general , is very close to patel s work .",
    "we continue to fix a first - order theory @xmath16 and a monster model @xmath28 .",
    "we begin with the definition of @xmath149 .",
    "[ sopn ] given @xmath128 , @xmath16 has the * @xmath115-strong order property * , @xmath149 , if there is an indiscernible sequence @xmath52 such that , if @xmath150 , then @xmath151 is inconsistent .",
    "we say @xmath16 is @xmath152 if it does not have the @xmath115-strong order property .",
    "these properties were originally defined in @xcite to enrich the classification of unstable theories .",
    "it is fairly straightforward to show that if @xmath16 has the strict order property , then it has @xmath149 for all @xmath128 . given @xmath128 , if @xmath16 has @xmath153 then it has @xmath149 . moreover , if @xmath16 has @xmath4 then it is unstable . indeed ,",
    "if one were to interpret definition [ sopn ] with @xmath154 then , as a property of @xmath16 , the result would be equivalent to the order property .",
    "is _ not _ defined this way , but rather as a variant of the tree property . ]",
    "see @xcite , @xcite .",
    "we now return to free amalgamation theories",
    ". the following easy observation will be very useful .",
    "[ switch ] suppose @xmath68 satisfies invariance , symmetry , and stationarity .",
    "suppose @xmath46 is closed and @xmath45 are closed tuples , with @xmath85 , @xmath47 , and @xmath86",
    ". then @xmath155 .    since @xmath47 , there is @xmath156 such that @xmath157 . by invariance and symmetry",
    "we have @xmath87",
    ". then @xmath158 by stationarity .",
    "[ thm : nsop4 ] if @xmath16 is a free amalgamation theory then @xmath16 is @xmath10 .",
    "fix an indiscernible sequence @xmath52 and let @xmath150 .",
    "we want to show @xmath159    let @xmath160 be such that @xmath161 . given @xmath162 there is @xmath163 such that @xmath164 .",
    "let @xmath165 . then @xmath166 .",
    "note that , for any @xmath167 , if @xmath168 then @xmath169 . therefore , we may replace @xmath170 by an indiscernible realization of its @xmath171-type and maintain this feature ( see , e.g. , ( * ? ? ?",
    "* lemma 7.1.1)-type of a sequence @xmath170 , over parameters @xmath76 , is the collection of formulas @xmath172 over @xmath76 , for any @xmath173 , such that @xmath174 holds for all @xmath175 . ] ) .",
    "set @xmath176 .",
    "to show @xmath177 , we set @xmath178 and show @xmath179    let @xmath180 be the common intersection of @xmath170 , which is closed .",
    "let @xmath68 be a free amalgamation relation for @xmath16 . by full existence",
    "there is @xmath181 such that @xmath182 .",
    "then @xmath183 , and so @xmath184 by freedom .",
    "moreover , @xmath185 , and so @xmath186 by lemma [ switch ] .",
    "let @xmath187 be such that @xmath188 .",
    "we have :    1 .   @xmath189 , and so @xmath190 , 2 .",
    "@xmath191 , 3 .",
    "@xmath192 , and so @xmath193 , 4 .",
    "@xmath194 , and so @xmath195 .",
    "this proves @xmath196 , as desired .",
    "note that @xmath10 is optimal , as many examples in section [ sec : ex ] have @xmath4 ( e.g. the generic @xmath3-free graph ) .",
    "moreover , the freedom axiom is necessary to conclude @xmath10 .",
    "for example , the theory of the rational urysohn space has a stationary independence relation satisfying closure ( see @xcite ) , but is @xmath149 for all @xmath128 ( see @xcite , @xcite ) .",
    "we also observe that , in the proof of @xmath10 , algebraic closure could be replaced by any invariant closure operator .    in @xcite ,",
    "shelah and usvyatsov consider groups as a universal class .",
    "using amalgamated free products , they prove that if @xmath197 is a sufficiently large universal group , then @xmath197 is @xmath10 with respect to quantifier - free types .",
    "in particular , given @xmath198 , set @xmath70 if @xmath199 is isomorphic to @xmath200 via the natural map .",
    "then @xmath68 satisfies all axioms of a free amalgamation relation except closure ( where  closed \" sets are subgroups and , in the stationarity and full existence axioms , elementary equivalence is replaced by group isomorphism ) .",
    "altogether , the proof of theorem [ thm : nsop4 ] recovers this result in @xcite .",
    "the main result of this section is that any free amalgamation theory has elimination of hyperimaginaries and weak elimination of imaginaries .",
    "we first recall basic notation and definitions ( see also @xcite , @xcite ) . given a @xmath201-type - definable equivalence relation @xmath202 and a tuple @xmath39 , with @xmath203",
    ", @xmath204 denotes the _ hyperimaginary _ determined by @xmath205_e$ ] ( the equivalence class of @xmath37 modulo @xmath206 ) .",
    "if @xmath202 is @xmath201-definable and @xmath207 is finite , then @xmath204 is an _",
    "imaginary_. given @xmath208 and @xmath209 , we let @xmath210 denote the orbit of @xmath211 under @xmath212",
    ". then @xmath213 and @xmath214 ( where @xmath27 is the saturation cardinal of @xmath28 ) .",
    "for @xmath215 , let @xmath216 and @xmath217 .",
    "a theory @xmath16 has _ elimination of hyperimaginaries _ if every @xmath209 is interdefinable with a sequence in @xmath218 .",
    "given @xmath219 , a _ geometric canonical parameter _",
    "for @xmath211 is a finite tuple @xmath220 such that @xmath221 and @xmath222 . if @xmath221 and @xmath223 then @xmath59 is a _ weak canonical parameter _ for @xmath211 . if @xmath224 and @xmath223 then @xmath59 is a",
    "_ canonical parameter _ for @xmath211 .",
    "@xmath16 has ( _ geometric _ , _ weak _ ) _ elimination of imaginaries _ if every imaginary has a ( geometric , weak ) canonical parameter .",
    "suppose @xmath202 is a @xmath201-type - definable equivalence relation on @xmath225 .    1 .",
    "a sequence @xmath52 in @xmath225 is * @xmath206-related * if @xmath226 holds for all @xmath227 .",
    "2 .   given @xmath40 , define @xmath228 to be the set of subtuples @xmath58 such that there is an @xmath206-related indiscernible sequence @xmath52 in @xmath225 , with common intersection @xmath59 and @xmath229 .",
    "suppose @xmath202 is a @xmath201-type - definable equivalence relation on @xmath225 and @xmath40 .",
    "then @xmath228 contains a minimal element under inclusion of tuples .",
    "we use zorn s lemma .",
    "note that @xmath230 ( witnessed by the constant sequence @xmath231 for all @xmath162 ) , and so @xmath228 is nonempty .",
    "suppose @xmath232 is an ordinal and @xmath233 is a sequence of elements of @xmath228 such that @xmath234 implies @xmath235 .",
    "let @xmath236 be the domain of @xmath237 , and note that @xmath234 implies @xmath238 .",
    "set @xmath239 and @xmath240 .",
    "then @xmath241 for all @xmath242 , and we show @xmath243 .",
    "consider variables @xmath244 , where @xmath245 , and define the type @xmath246 where @xmath247 expresses that @xmath244 is an indiscernible @xmath206-related sequence with @xmath248 . a finite subset of @xmath249 is contained in a type of the form @xmath250 where @xmath251 is a finite subset of @xmath252 . given @xmath253 ,",
    "fix @xmath254 such that @xmath255 . by assumption",
    ", there is an @xmath206-related indiscernible sequence @xmath256 , with common intersection @xmath257 and @xmath258 .",
    "this sequence realizes @xmath253 . by compactness , @xmath249 is consistent , and so @xmath243 .",
    "suppose @xmath202 is a @xmath201-type - definable equivalence relation on @xmath225 , and @xmath259 .",
    "an * indiscernible parameter for @xmath204 * is a minimal element ( under @xmath260 ) of @xmath228 .",
    "[ phplem ] suppose @xmath202 is a @xmath201-type - definable equivalence relation on @xmath225 .",
    "fix @xmath40 and let @xmath58 be an indiscernible parameter for @xmath204 . then @xmath261 .",
    "we may clearly assume @xmath59 is nonempty .",
    "let @xmath262 be the domain of @xmath59 .",
    "let @xmath54 be an @xmath206-related indiscernible sequence , with common intersection @xmath59 , such that @xmath258 .",
    "suppose , toward a contradiction , that @xmath263 , and so we may find @xmath264 in @xmath265 , with @xmath266 and @xmath232 arbitrarily large . choosing @xmath232 large enough , we may assume @xmath264 is indiscernible . for later purposes ,",
    "we also want @xmath267 . by compactness",
    ", we may stretch @xmath54 so that it is indexed @xmath268 ( and still indiscernible , @xmath206-related , with common intersection @xmath59 ) .",
    "let @xmath269 be the domain of the common intersection @xmath270 of @xmath264 .",
    "since @xmath264 is not a constant sequence , we must have @xmath271 , and so @xmath270 is a proper subtuple of @xmath59 .",
    "we will build an indiscernible @xmath206-related sequence @xmath272 , with @xmath273 , such that the common intersection of @xmath272 is a subtuple of @xmath270 .",
    "this will contradict the minimality of @xmath59 .",
    "given @xmath274 , define a binary relation @xmath275 on @xmath225 such that @xmath276 holds if and only if , for all @xmath277 , if @xmath278 then @xmath279 .",
    "given @xmath280 , fix @xmath281 such that @xmath282 ( we assume @xmath283 is the identity ) .",
    "we inductively construct a sequence @xmath272 and an injective function @xmath284 such that    1 .",
    "@xmath273 ; 2 .   for all @xmath285",
    "there is @xmath286 such that @xmath287 ; 3 .",
    "@xmath288 holds for all @xmath289 .",
    "we first argue why this construction finishes the proof .",
    "suppose we have @xmath272 as described .",
    "to show @xmath272 is @xmath206-related , we fix @xmath285 and show @xmath290 holds . by @xmath291 , we have some @xmath286 such that @xmath292",
    ". note that @xmath293 holds since @xmath54 is @xmath206-related .",
    "since @xmath294 , we then have @xmath295 .",
    "next , we fix @xmath289 and show that @xmath296 holds . indeed ,",
    "if @xmath277 and @xmath297 , then we have @xmath298 by @xmath299 .",
    "it follows from @xmath291 that @xmath300 and @xmath301 ( recall @xmath302 for all @xmath286 )",
    ". then @xmath303 implies @xmath304 .",
    "finally , if we replace @xmath272 by an indiscernible realization of its @xmath171-type , and conjugate to maintain @xmath273 , then @xmath272 is the desired @xmath206-related indiscernible sequence , whose common intersection is a subtuple of @xmath270 .    we now proceed with the construction of @xmath272 .",
    "let @xmath273 and @xmath305 .",
    "for the induction hypothesis , fix @xmath306 , and suppose we have constructed @xmath307 and @xmath308 satisfying properties @xmath309 , @xmath291 , and @xmath299 above ( relativized to @xmath115 ) .",
    "_ claim _ : there are @xmath310 such that , for all @xmath311 , @xmath312 and @xmath313 .",
    "note that , given the claim , if we set @xmath314 and @xmath315 , then @xmath316 and @xmath317 are as desired .",
    "therefore the claim finishes the inductive step in the construction of @xmath272 .",
    "_ proof of the claim _ : suppose the claim fails . then , for all @xmath318 and @xmath286 , there are @xmath311 and @xmath277 such that @xmath319 and @xmath320 .",
    "we first find an integer @xmath311 , indices @xmath277 with @xmath319 , and @xmath12-element sets @xmath321 such that @xmath320 for all @xmath322 . to do this , set @xmath323{and}}y=\\{(m , s , t):m < n,~s , t\\in i\\},\\ ] ] and consider the map @xmath324 obtained above from the assumption that the claim fails .",
    "let @xmath325 .",
    "we have @xmath326 by assumption , and so @xmath327 by the erds - rado theorem ( see , e.g. , ( * ? ? ?",
    "* theorem c.3.2 ) ) . applied to the map @xmath328",
    ", we obtain an infinite ; however we only need @xmath329 for the proof . ]",
    "set @xmath330 , an integer @xmath311 , and @xmath277 such that @xmath319 and @xmath320 for all @xmath331 .",
    "now let @xmath332 be disjoint @xmath12-element sets with @xmath333",
    ".    now fix some @xmath334 and distinct @xmath335 .",
    "then @xmath336 , and so @xmath337 . in particular , we must have @xmath338 , and so @xmath339 . moreover , for any @xmath286 , we have @xmath340 . therefore , given @xmath334 , we have @xmath341 .",
    "fix distinct @xmath342 . since @xmath338",
    ", we altogether have @xmath343 , and so @xmath344 .",
    "therefore @xmath345 and so @xmath346 for all @xmath334 .",
    "in particular , we have @xmath347 , and so @xmath348 fails .",
    "if @xmath349 then we obtain a contradiction to property @xmath299 in the induction hypothesis .",
    "therefore @xmath350 , and so @xmath351 .",
    "by indiscernibility of @xmath268 , and since @xmath338 , we have @xmath352 , which contradicts @xmath339 .    [ dcllem ]",
    "suppose @xmath68 is a ternary relation on @xmath28 satisfying invariance , monotonicity , full existence , stationarity , and freedom .",
    "let @xmath202 be a @xmath201-type - definable equivalence relation on @xmath225 , and suppose @xmath40 is closed .",
    "then @xmath353 for any @xmath354 .",
    "fix @xmath354 , and let @xmath52 be an @xmath206-related indiscernible sequence , with common intersection @xmath59 , such that @xmath229 . note that @xmath52 is @xmath59-indiscernible and @xmath59 is closed .",
    "to show @xmath353 , we fix @xmath355 and show @xmath356 .    by full existence",
    ", there is @xmath357 such that @xmath358 .",
    "then @xmath359 , and so @xmath360",
    ". therefore @xmath361 by freedom .",
    "note also that , since @xmath362 holds , we have @xmath363 , and so , combined with @xmath364 , we obtain @xmath365 .    by full existence , there is @xmath366 such that @xmath367 . since @xmath368 , we may fix @xmath369 such that @xmath370",
    ". then @xmath371 and , by monotonicity and invariance , @xmath372 .",
    "therefore , by stationarity , @xmath373 . in particular , we have @xmath374 .    similarly , since @xmath375 , we may fix @xmath376 such that @xmath377 .",
    "then @xmath378 and , by monotonicity and invariance , @xmath379 .",
    "therefore , by stationarity , @xmath380 .",
    "in particular , we have @xmath381 . altogether",
    ", we have @xmath374 and @xmath381 , and so @xmath356 holds , as desired .",
    "[ thm : wei ] if @xmath16 is a free amalgamation theory then @xmath16 has elimination of hyperimaginaries and weak elimination of imaginaries .",
    "both results rely on the following claim .",
    "_ claim _ : suppose @xmath202 is a @xmath201-type - definable equivalence relation on @xmath225 , and @xmath40 .",
    "then there is a real tuple @xmath220 such that @xmath261 and @xmath353 .",
    "_ proof _ : let @xmath382 be a tuple , with domain @xmath383 , such that @xmath384 and @xmath385 . consider the equivalence relation @xmath386 on @xmath387 given by @xmath388 if and only if @xmath389 .",
    "then @xmath386 is @xmath201-type - definable , and so , if @xmath59 is an indiscernible parameter for @xmath390 , then @xmath391 and @xmath392 by lemmas [ phplem ] and [ dcllem ] .",
    "note that @xmath393 , and so @xmath394 , which is bounded by assumption .",
    ". moreover , if @xmath355 then @xmath395 , which means @xmath396 holds , and so @xmath356 holds by definition .",
    "therefore @xmath397 , and so @xmath353 .",
    "@xmath398    by the claim , and ( * ? ? ?",
    "* lemma 18.6 ) , we immediately obtain elimination of hyperimaginaries . for weak elimination of imaginaries ,",
    "fix a @xmath201-definable equivalence relation on @xmath399 , and @xmath400 .",
    "let @xmath220 be as in the claim .",
    "then @xmath401 ( with @xmath59 considered as a small subset of @xmath28 ) .",
    "let @xmath402 be a finite subtuple of @xmath59 such that @xmath403",
    ". then @xmath261 implies @xmath404 , and so @xmath402 is a weak canonical parameter for @xmath204 .",
    "note that , in the proof of the claim , we replaced @xmath37 with @xmath405 only so that we could apply lemma [ dcllem ] . in these steps",
    ", algebraic closure could be substituted by some other invariant closure operator .",
    "we also remark that theorem [ thm : wei ] can not be strengthened to full elimination of imaginaries .",
    "indeed , one often has that finite imaginaries in theories of homogeneous structures , in symmetric relational languages , do not have canonical parameters .",
    "for example , this is the case for the random graph , generic @xmath3-free graph , and even just the infinite set .",
    "it is also worth observing that the freedom axiom is necessary in theorem [ thm : wei ] .",
    "for example , any generic theory of infinitely refining equivalence relations fails weak elimination of imaginaries , but does have a stationary independence relation satisfying closure , namely , nonforking independence .",
    "moreover , the theory of the rational urysohn space does not eliminate hyperimaginaries ( see @xcite , @xcite ) but , as previously remarked , has a stationary independence relation satisfying closure .",
    "in this section , we use weak elimination of imaginaries to establish rosiness for many of the examples in section [ sec : ex ] .",
    "this subject has been previously investigated in some cases .",
    "in particular , rosiness for the random graph and generic @xmath5-free hypergraphs ( for @xmath26 ) follows from the fact that these theories are simple .",
    "other examples are known to be rosy due to previous proofs of weak elimination of imaginaries . in particular , weak elimination of imaginaries",
    "is shown for @xmath406 by casanovas and wagner @xcite , and for the hrushovski generics @xmath134 by wong @xcite .",
    "on the other hand , rosiness for the general class of frass  limits in example [ ex].[ex1 ] , does not appear in previous literature .",
    "this includes even the specific case of the generic @xmath3-free graphs .",
    "rosiness for the generic @xmath9-free graphs of example [ ex].[ex2 ] is also a new result .",
    "we first state the definition of thorn - forking , which follows @xcite .",
    "suppose @xmath16 is a complete theory and @xmath28 is a monster model of @xmath16 .    1 .",
    "a ternary relation @xmath68 satisfies * local character * if , for all @xmath29 , there is a cardinal @xmath407 such that , for all @xmath408 , there is @xmath409 such that @xmath410 and @xmath70 .",
    "2 .   define * algebraic independence * @xmath411 : @xmath412{$\\leftrightarrow$}}\\acl(ac)\\cap\\acl(bc)=\\acl(c).\\ ] ] 3 .",
    "define * @xmath413-independence * @xmath414 by  forcing base monotonicity \" on @xmath411 : @xmath415{$\\leftrightarrow$}}a\\ind^a_d b\\text { for all $ c{\\subseteq}d{\\subseteq}\\acl(bc)$}.\\ ] ] 4 .",
    "define * thorn independence * @xmath416 by  forcing extension \" on @xmath414 : @xmath417{$\\leftrightarrow$}}\\text{for all $ \\hat{b}\\supseteq b$ there is $ a'\\equiv_{bc } a$ such that $ \\textstyle a'\\ind^m_c \\hat{b}$}.\\ ] ]    @xmath16 is * rosy * ( resp . * real rosy * ) if @xmath418 satisfies local character in @xmath218 ( resp . in @xmath28 ) .",
    "thorn - forking was developed in order to define the weakest ternary relation satisfying enough basic axioms to be considered a reasonable notion of independence . in many ways ,",
    "rosy theories are to thorn - forking as simple theories are to forking .",
    "however , the region of rosy theories properly extends the simple theories ( e.g. o - minimal theories are rosy ) .",
    "see @xcite , @xcite for further details .    since rosiness is defined as a property of @xmath419 , an understanding of imaginaries greatly simplifies the work required to determine if a theory is rosy .",
    "in particular , if @xmath16 has weak elimination of imaginaries , then it suffices to check that @xmath16 is real rosy . this fact is shown explicitly in @xcite , implicitly in @xcite , and is also an informative exercise in forking calculus .",
    "[ fact : rrosy ] any real rosy theory , with weak elimination of imaginaries , is rosy .    any real rosy free amalgamation theory is rosy .    in checking real rosiness for our specific examples ,",
    "the following facts from @xcite will be useful . recall that a ternary relation @xmath68 satisfies _ base monotonicity _ if , for all @xmath420 , with @xmath77 , if @xmath78 then @xmath70 .",
    "[ def : mod ] a theory @xmath16 is * modular * if @xmath411 satisfies base monotonicity in @xmath28 .",
    "recall that if @xmath64 satisfies steinitz exchange in @xmath16 , then the resulting dimension function is used to define a notion of  modularity \" for @xmath16 .",
    "one may show that , in this case , the two notions are equivalent ( see @xcite , @xcite for details ) .",
    "[ prop : alg ] suppose @xmath16 is a complete theory and @xmath28 is a monster model of @xmath16 .    1 .",
    "@xmath16 is modular if and only if , for all algebraically closed sets @xmath421 , with @xmath409 , we have @xmath422 .",
    "2 .   suppose @xmath16 is modular .",
    "then , for any @xmath32 , there is @xmath409 , with @xmath423 , such that @xmath424 .",
    "if @xmath16 is modular then @xmath425 in @xmath28 ; so @xmath418 satisfies local character in @xmath28 .",
    "if algebraic closure in @xmath16 is disintegrated then @xmath16 is modular .",
    "part @xmath20 follows easily from part @xmath21 .",
    "parts @xmath21 and @xmath23 can be found in ( * ? ? ?",
    "* proposition 1.5 ) , which , moreover , includes a general argument that @xmath411 satisfies local character , even without the modularity assumption .",
    "however , our formulation of part @xmath22 uses modularity to conclude a stronger bound on the cardinal @xmath407 in the local character axiom , and so we detail the argument .    part @xmath22 .",
    "let @xmath426 .",
    "for any singleton @xmath427 , we may fix a finite subset @xmath428 such that @xmath429 .",
    "let @xmath430 . then @xmath431 and @xmath423 .",
    "let @xmath432 , @xmath433 and @xmath434 .",
    "then @xmath435 and so , using part @xmath21 , we have @xmath436 therefore @xmath424 , as desired .    altogether ,",
    "if @xmath16 is modular with weak elimination of imaginaries , then @xmath16 is rosy and @xmath425 in @xmath28 ( and also in @xmath218 ; see lemma [ gei ] ) .",
    "therefore , we have following conclusion .",
    "[ cor : farosy ] if @xmath16 is a modular free amalgamation theory then @xmath16 is rosy .",
    "recall that @xmath64 is disintegrated in examples [ ex].[ex1 ] and [ ex].[ex2 ] , and so these theories are modular by proposition [ prop : alg]@xmath20 . combined with the fact that @xmath64 is locally finite",
    ", we can use proposition [ prop : alg ] to conclude that the structures in these examples yield _ superrosy _ theories ( i.e. in @xmath218 , @xmath416 satisfies the strengthening of local character obtained by demanding @xmath437 for all finite @xmath76 ) . note that superrosiness is also a property of @xmath419 and so , to justify the previous remark , one must verify that fact [ fact : rrosy ] still holds when  rosy \" is replaced by  superrosy \" .",
    "we again leave this to the reader , and instead turn our attention to calculating the @xmath11-rank of these examples .",
    "suppose @xmath16 is a complete theory and @xmath28 is a monster model of @xmath16 .",
    "given @xmath173 , @xmath438 if there is a singleton @xmath39 and subsets @xmath439 such that @xmath440 for all @xmath441 .",
    "similar to before , if @xmath16 has weak elimination of imaginaries , then the subsets @xmath442 in the previous definition may be taken from @xmath28 .",
    "we can now calculate the @xmath25-rank of the structures in examples [ ex].[ex1 ] and [ ex].[ex2 ] .",
    "for example [ ex].[ex1 ] , the following observation implies that the @xmath25-rank is @xmath2 .",
    "[ prop : triv ] suppose @xmath16 is modular with weak elimination of imaginaries .",
    "then @xmath17 if and only if algebraic closure in @xmath28 satisfies steinitz exchange .",
    "the reverse direction is left to the reader , and in fact holds just under the assumption of geometric elimination of imaginaries ( see ( * ? ? ?",
    "* theorem 4.12 ) ) .",
    "for the forward direction , if @xmath64 fails exchange then we may fix some @xmath45 , and @xmath46 such that @xmath443 and @xmath444 .",
    "in other words , @xmath445 and @xmath446 . since @xmath16 is modular with weak elimination of imaginaries , this gives @xmath447 .",
    "for example [ ex].[ex2 ] , we first set some notation ( taken from @xcite ) . given @xmath128 , let @xmath448 denote the theory of the generic @xmath9-free graph .",
    "a singleton @xmath449 is _ type i _ if it lies on exactly one @xmath3 in @xmath28 , and on no @xmath130 other than those occurring as subgraphs of this @xmath3 .",
    "it is easy to see that type i vertices exist in @xmath28 .",
    "for example , consider the graph obtained by freely amalgamating two copies of @xmath3 over @xmath450 .",
    "this graph is @xmath9-free and so we may assume it is a subgraph of @xmath28 .",
    "moreover , the two vertices not on the common @xmath450 are each type i. one may also show that if @xmath37 is type i then @xmath405 is precisely the unique @xmath3 on which @xmath37 lies .",
    "the following technical observations follow from the analysis of algebraic closure found in @xcite or @xcite .",
    "[ lem : aclbow ] fix @xmath128 and let @xmath451 . if @xmath45 are singletons such that @xmath452 and @xmath453 , then @xmath37 is type i and @xmath454 .",
    "conversely , if @xmath37 is type i then @xmath455 is nonempty and @xmath453 for any @xmath456 .",
    "[ thm : bowtie ] for all @xmath128 , @xmath457 .",
    "we have @xmath458 by proposition [ prop : triv ] , lemma [ lem : aclbow ] , and the fact that @xmath459 . for the other direction ,",
    "recall that by weak elimination of imaginaries and modularity , we may work in @xmath28 with @xmath460 .",
    "suppose , toward a contradiction , there is a singleton @xmath39 and @xmath461 such that @xmath462 for all @xmath463 .",
    "given @xmath463 , fix a singleton @xmath464 .",
    "since @xmath64 is disintegrated , we must have @xmath465 for all @xmath463 .    since @xmath466 and @xmath467 , we have @xmath468 . by lemma [ lem : aclbow ] ,",
    "@xmath37 is type i and @xmath469 .",
    "then @xmath470 , which contradicts @xmath471 and @xmath472 .    finally , for the sake of completeness",
    ", we summarize the previously known result that the hrushovski constructions in example [ ex].[ex3 ] are rosy .",
    "this argument works in general , and does not require the assumptions we have imposed in order to obtain free amalgamation theories . let @xmath473 be a monster model of @xmath137 . consider the relation @xmath474 if and only if @xmath424 and , for all finite @xmath475 , @xmath476 ( see @xcite , @xcite ) .. we use @xmath477 to avoid confusion with nondividing .",
    "however , if @xmath137 is simple then it follows from work in @xcite that @xmath477 coincides with nonforking ( and thus also nondividing ) .",
    "] by results in @xcite , @xmath477 satisfies the axioms of a _ strict independence relation _ ( see @xcite ) , and",
    "so , by ( * ? ? ?",
    "* theorem 4.3 ) , @xmath418 satisfies local character in @xmath473 ( this fact is observed by wong in @xcite ) . using weak elimination of imaginaries ( shown in @xcite ) , it follows that @xmath137 is rosy . as noted in @xcite ,",
    "if the predimension @xmath270 is discrete then @xmath477 satisfies the strengthening of local character required to conclude that @xmath137 is superrosy .",
    "many free amalgamation theories are known to be much more well - behaved than what we have shown so far , in particular because they are simple ( and therefore @xmath1 ) .",
    "for example , this is true for the random graph and generic @xmath5-free hypergraphs ( with @xmath26 ) .",
    "moreover , simplicity of hrushovski constructions is a well - studied topic ( see @xcite ) .",
    "on the other hand , the documented examples of non - simple free amalgamation theories all exhibit a gap in complexity , in the sense that they have both @xmath4 and @xmath7 . in this section ,",
    "we investigate the persistence of this behavior .        1 .   for all @xmath285 and @xmath480 , there does not exist a tuple @xmath382 such that @xmath481 for all @xmath482 ; 2 .   for all @xmath483",
    "there is a tuple @xmath382 such that @xmath484 for all @xmath285 .",
    "we prove the reverse implication ( which is the only direction we will use ) , and leave the forward implication to the reader .",
    "suppose we have @xmath52 , @xmath170 , @xmath485 , and @xmath486 as described .",
    "we may assume @xmath493 is indiscernible .",
    "let @xmath494 .",
    "if @xmath495 then we have @xmath496 and @xmath497 , which is a contradiction .",
    "therefore @xmath498 witnesses @xmath4 .        1 .",
    "let @xmath499 be tuples in @xmath28 and @xmath46 .",
    "then @xmath500 * does not divide over @xmath81 * , written @xmath501 , if , for every @xmath81-indiscernible sequence @xmath170 with @xmath502 , there is @xmath503 such that @xmath504 for all @xmath162 .",
    "@xmath16 is * simple * if @xmath505 is symmetric in @xmath28 .",
    "let @xmath68 be a ternary relation on @xmath28 .",
    "suppose @xmath512 is an ordinal , @xmath508 is a sequence of tuples , and @xmath513 .",
    "then @xmath508 is * @xmath68-independent over @xmath81 * if , for all @xmath509 , @xmath514 and @xmath515 .",
    "note that if @xmath508 is @xmath68-independent over a closed set @xmath81 , @xmath516 is closed , and @xmath68 satisfies closure , then @xmath517 is closed for all @xmath509 .",
    "we will tacitly use this observation throughout the section .",
    "the next result is a key lemma , which says that if @xmath68 is a free amalgamation relation then @xmath68-independent sequences can only witness dividing exemplified by a failure of @xmath411 .",
    "[ amalgind ] suppose @xmath68 is a free amalgamation relation for @xmath16 .",
    "fix closed tuples @xmath37 and @xmath518 and let @xmath519 ( so @xmath520 ) .",
    "suppose @xmath508 is @xmath68-independent over @xmath81 , with @xmath502 .",
    "then there is @xmath382 such that @xmath521 for all @xmath509 .    by compactness",
    ", it suffices to assume @xmath522 . by induction on @xmath523",
    ", we will find tuples @xmath524 such that @xmath525 for all @xmath526 .",
    "for the base case , set @xmath229 .",
    "assume we have constructed @xmath527 as required . by full existence , there is @xmath528 such that @xmath529 .",
    "note that @xmath530 .",
    "by the claim and freedom , we have @xmath537 . we also have @xmath538 and @xmath539 .",
    "therefore @xmath540 by stationarity .",
    "let @xmath541 be such that @xmath542 .",
    "if @xmath441 then , by induction , @xmath543 .",
    "we also have @xmath544 .",
    "therefore @xmath524 is as desired .",
    "@xmath546 : suppose @xmath299 fails .",
    "recall that , in general , @xmath505 implies @xmath411 and so , using fact [ divacl ] , we may fix a closed set @xmath81 and closed tuples @xmath499 such that @xmath547 and @xmath548 .",
    "let @xmath170 be a @xmath81-indiscernible sequence such that @xmath502 and , for some @xmath479 , there is no tuple @xmath382 such that @xmath521 for all @xmath549 .    fix a free amalgamation relation @xmath68 , and let",
    "@xmath550 . using the full existence axiom ,",
    "we inductively construct sequences @xmath551 , for @xmath173 , such that @xmath552 and @xmath553 .",
    "we show that @xmath37 , @xmath518 , and @xmath554 together witness @xmath7 for @xmath16 .",
    "fix @xmath173 .",
    "since @xmath552 , it follows that there is no tuple @xmath382 such that @xmath555 for all @xmath549 .",
    "next , fix a function @xmath483 . by construction and monotonicity , @xmath556 is @xmath68-independent over @xmath81 .",
    "let @xmath557 be such that @xmath558 .",
    "then @xmath559 , and so , by lemma [ amalgind ] , there is some @xmath382 such that @xmath560 for all @xmath173 .",
    "recall that @xmath505 satisfies base monotonicity in any theory , and so @xmath16 is modular by theorem [ thm : simp ] . if @xmath16 has locally finite algebraic closure then , combining proposition [ prop : alg]@xmath22 with condition @xmath299 of theorem [ thm : simp ] , we obtain supersimplicity .",
    "we can use the results of section [ sec : wei ] to refine these conclusions .",
    "recall that the ternary relation of _ nonforking independence _",
    "@xmath561 is defined by  forcing extension \" on @xmath505 ; precisely , @xmath562 if and only if , for all @xmath563 , there is @xmath564 such that @xmath565 .",
    "recall also that , for simple theories , @xmath505 and @xmath561 coincide ( see e.g. @xcite , @xcite ) . in generalizing important concepts concerning forking in stable theories , hart , kim , and pillay @xcite introduced hyperimaginaries to define canonical bases and the notion of a @xmath2-based simple theory .",
    "this is essentially identical to exercise 3.29 of adler s thesis @xcite , and we sketch the proof .",
    "first , the equivalence of @xmath309 and @xmath291 follows from elimination of hyperimaginaries and fact [ divacl ] .",
    "since @xmath561 satisfies base monotonicity in any theory , @xmath546 is trivial . finally , if @xmath299 holds then , by proposition [ prop : alg]@xmath23 , @xmath418 coincides with @xmath411 in @xmath218 , and so @xmath291 follows from the fact that if @xmath16 is simple with elimination of hyperimaginaries then @xmath561 and @xmath418 coincide in @xmath218 ( see ( * ?",
    "* theorem 2.8 ) ) .",
    "altogether , for simple theories with elimination of hyperimaginaries , @xmath2-basedness expresses that forking in @xmath419 is as trivial as possible .",
    "unsurprisingly , this has strong consequences for the theory .",
    "for example , kim @xcite shows that any simple @xmath2-based theory , with elimination of hyperimaginaries , satisfies the stable forking conjecture .",
    "we will use fact [ thm:1beq ] to conclude that simple free amalgamation theories are @xmath2-based .",
    "first , we show that under the additional assumption of geometric elimination of imaginaries , conditions @xmath291 and @xmath299 of fact [ thm:1beq ] may be checked in @xmath28 rather than @xmath218 .",
    "the proof of this only requires the following lemma , which is similar to the techniques in @xcite .",
    "we could not find a reference for this exact result , and so we outline the proof .",
    "[ gei ] suppose @xmath16 is a complete theory with geometric elimination of imaginaries . given @xmath219 ,",
    "let @xmath569 be a geometric canonical parameter for @xmath211 ( for @xmath39 , assume @xmath570 ) .",
    "given @xmath215 , let @xmath571 .",
    "part @xmath21 .",
    "first , note that @xmath574 for any @xmath215 .",
    "note also that , for any @xmath566 , we have @xmath575 and , if @xmath576 , then @xmath577 . using these observations",
    ", we see that @xmath424 in @xmath218 if and only if @xmath578 in @xmath218 .",
    "so it remains to show @xmath573 in @xmath218 if and only if @xmath573 in @xmath28 .",
    "the forward direction is trivial , so suppose @xmath573 in @xmath28 , and @xmath579 .",
    "since @xmath580 and @xmath569 , @xmath581 , @xmath582 , and @xmath583 are all subsets of @xmath28 , it follows that @xmath584 . since @xmath585",
    ", we have @xmath586 , as desired .",
    "the equivalence of @xmath309 and @xmath299 is immediate from fact [ thm:1beq ] and lemma [ gei]@xmath22 .",
    "since @xmath561 satisfies base monotonicity ( in @xmath28 ) , @xmath291 implies @xmath299 is trivial .",
    "for @xmath309 to @xmath291 , assume @xmath16 is @xmath2-based .",
    "fix @xmath421 such that @xmath424 in @xmath28 .",
    "then @xmath424 in @xmath218 by lemma [ gei]@xmath21 , and so @xmath588 in @xmath218 by fact [ thm:1beq ] .",
    "therefore @xmath588 in @xmath28 .",
    "[ cor : fa1b ] if @xmath13 is a countable , simple , ultrahomogeneous structure in a finite relational language @xmath14 , whose age is closed under free amalgamation of @xmath14-structures , then @xmath19 is @xmath2-based .",
    "in particular , this gives an alternate proof of a recent result of koponen @xcite showing that the generic tetrahedron - free @xmath589-hypergraph is @xmath2-based .",
    "we also give this as a partial response to the observation , made in @xcite , that all known examples of countable , simple , ultrahomogeneous structures , in finite relational languages , have @xmath2-based theories .",
    "has also been independently obtained in recent work of palacn @xcite . ]",
    "returning to the initial motivations for this section , we have shown that simplicity and @xmath0 coincide for free amalgamation theories .",
    "we previously observed that all documented non - simple examples have @xmath4 , and so a reasonable conjecture is that simplicity and @xmath1 also coincide for free amalgamation theories .",
    "we will prove this for the class of _ modular _ free amalgamation theories .",
    "recall that all of our concrete examples of free amalgamation theories are modular , and so it seems quite possible that the modularity assumption is redundant .",
    "[ lem : inddiv ] suppose @xmath68 satisfies invariance , monotonicity , full existence and stationarity .",
    "then , for any closed tuples @xmath499 and closed sets @xmath81 , with @xmath85 , if @xmath86 then @xmath501 ( and hence @xmath520 ) .",
    "let @xmath170 be a @xmath81-indiscernible sequence , with @xmath502 . by full existence",
    ", there is @xmath82 such that @xmath590 . given @xmath162 ,",
    "let @xmath53 be such that @xmath591 . for all @xmath162 , we have @xmath592 and @xmath593 by invariance and monotonicity . since @xmath594",
    ", we apply stationarity to obtain @xmath595 , as desired .",
    "the reader may have noticed that , so far , none of our results has required transitivity . in fact , we will not use transitivity in any part of this paper .",
    "it is included in definition [ def : fat ] in anticipation of its usefulness in future work .",
    "for example , one may show that if @xmath68 satisfies invariance , transitivity , and full existence , then @xmath68 satisfies _ extension _ : for all @xmath596 , with @xmath597 closed , @xmath598 , and @xmath92 , if @xmath599 then there is @xmath600 such that @xmath601 . using this , one may prove the version of lemma [ lem : inddiv ] obtained by adding transitivity to the assumptions and demanding @xmath562 in the conclusion ( see ( * ? ? ? * theorem 4.1 ) ) .",
    "first , recall that any simple theory is @xmath1 ( see , e.g. , ( * ? ? ?",
    "* claim 2.7 ) ) .",
    "conversely , if @xmath16 is not simple then , in particular , @xmath505 does not coincide with @xmath411 ( this is true for any theory since @xmath411 is symmetric ) .",
    "using fact [ divacl ] , we may fix a closed set @xmath46 and closed tuples @xmath499 such that @xmath547 and @xmath548 .",
    "let @xmath170 be a @xmath81-indiscernible sequence such that @xmath502 and , for some @xmath479 , there is no tuple @xmath503 such that @xmath504 for all @xmath549 .",
    "_ proof _ : first , assume @xmath603 is minimal such that there is no tuple @xmath503 with @xmath504 for all @xmath549 .",
    "let @xmath382 be such that @xmath521 for all @xmath604 .",
    "for @xmath162 , let @xmath605 .",
    "let @xmath606 and @xmath607 , and note that @xmath608 .",
    "suppose , toward a contradiction , that for some @xmath234 , there is a tuple @xmath503 with @xmath609 .",
    "then , for all @xmath610 and @xmath611 , we have @xmath612 . since @xmath613 ( recall @xmath234 )",
    ", it follows by indiscernibility that there is a tuple @xmath614 such that @xmath615 for all @xmath616 , which contradicts the choice of @xmath617 .",
    "now replace @xmath618 with a @xmath619-indiscernible realization of its em - type over @xmath619 , while still assuming @xmath620 .",
    "then @xmath621 , and there is no @xmath503 such that @xmath622 for all @xmath623.@xmath398      _ proof _ : let @xmath625 and @xmath626 . note that @xmath608 and @xmath170 is @xmath619-indiscernible .",
    "moreover , there is clearly no @xmath503 such that @xmath627 for all @xmath623 . finally ,",
    "since @xmath16 is modular , we have @xmath628 by proposition [ prop : alg]@xmath21.@xmath398    fix a free amalgamation relation @xmath68 . by full existence , there is @xmath629 such that @xmath630 . by freedom , and since @xmath631 , we have @xmath632",
    ". then @xmath633 by lemma [ switch ] .",
    "by lemma [ lem : inddiv ] , we have @xmath634 which implies @xmath635 ( recall @xmath636 since @xmath637 and @xmath629 ) .",
    "we inductively construct a sequence @xmath638 such that :      let @xmath644 .",
    "suppose we have constructed @xmath645 as above .",
    "by full existence , we may find @xmath646 such that @xmath647 .",
    "then @xmath291 is immediate . for @xmath309 ,",
    "we want to show @xmath648 for all @xmath441 and @xmath649 .",
    "if @xmath650 then we have @xmath651 , @xmath652 , and @xmath653 . by stationarity and induction , @xmath654",
    "now suppose @xmath655 , and let @xmath656 .",
    "then @xmath657 , @xmath658 ( by induction and possibly symmetry ) , and @xmath659 . by stationarity and induction , we have @xmath660 .",
    "next , we must construct @xmath661 .",
    "first , note that @xmath662 is @xmath68-independent over @xmath81 and @xmath663 . by lemma [ amalgind ] ,",
    "there is @xmath664 such that @xmath665 for all @xmath441 .",
    "let @xmath666 , which is closed by the closure axiom for @xmath68 .",
    "by full existence , there is @xmath667 such that @xmath668 .",
    "_ proof _ : fix @xmath441 .",
    "then @xmath670 and @xmath671 .",
    "it remains to show that , for all @xmath672 , @xmath673 .",
    "if @xmath674 then this follows by induction and property @xmath309 . for @xmath675 , we have @xmath676 , and so @xmath677.@xmath398    by the claim , and freedom , we have @xmath643 , which gives property @xmath299 .",
    "it remains to verify the pertinent parts of property @xmath309 .",
    "first , we have @xmath678 , @xmath679 , and @xmath680 . by stationarity and choice of @xmath681",
    ", we have @xmath682 .",
    "next , if @xmath441 then we have @xmath683 , @xmath684 , and @xmath685 . by stationarity and choice of @xmath681 , we have @xmath686 ( recall @xmath633 ) . finally , for @xmath441 , we have @xmath676 .",
    "this finishes the construction of the sequence @xmath638 .",
    "fix @xmath173 .",
    "define the sequence @xmath687 where , if @xmath526 then @xmath688 , and , if @xmath689 then @xmath690 .",
    "by @xmath291 , @xmath299 , and monotonicity , @xmath687 is @xmath68-independent over @xmath81 .",
    "we also have @xmath691 and so @xmath692 . by lemma [ amalgind ] ,",
    "there is @xmath524 such that @xmath693 for all @xmath162 .",
    "let @xmath694 .",
    "recall that , by assumption , @xmath695 is inconsistent .",
    "for @xmath162 , set @xmath696 .",
    "fix variables @xmath697 , and define the types @xmath698 and @xmath699 .",
    "we use @xmath52 , @xmath700 , @xmath701 , @xmath702 , and proposition [ sop3 ] to show that @xmath16 has @xmath4 .      by work of evans and wong @xcite ,",
    "simplicity coincides with @xmath1 in the full class of hrushovski generics @xmath134 .",
    "however , the interesting counterexamples produced by such constructions are often simple and non - modular , and therefore do not fall into our framework .",
    "consists of one ternary relation then , with appropriate choice of predimension and control function @xmath136 , @xmath137 is supersimple and non - modular .",
    "see , e.g. , ( * ? ? ?",
    "* section 6.2 ) . ]        for a final application , we take a closer look at simplicity for @xmath19 , where @xmath13 is countable and ultrahomogeneous , in a finite relational language .",
    "our motivation is the well - known fact that the ( binary ) generic @xmath3-free graphs are not simple ( due to shelah @xcite ) , while their higher arity analogs , the generic @xmath5-free @xmath6-hypergraphs for @xmath26 , are simple ( due to hrushovski @xcite ) .    for the rest of the section",
    ", we fix a finite relational language @xmath14 .",
    "given @xmath710-structures @xmath76 and @xmath711 we say @xmath76 is a _ weak substructure _ of @xmath711 if there is an injective map from @xmath76 to @xmath711 which preserves the relations in @xmath710 .",
    "suppose @xmath76 is an @xmath14-structure .",
    "we say that singletons @xmath712 are * related in @xmath76 * if there is a tuple @xmath713 such that each @xmath53 is a coordinate of @xmath714 and @xmath715 for some relation @xmath99 . given @xmath716 ,",
    "@xmath76 is * @xmath617-irreducible * if any @xmath617 distinct elements of @xmath76 are related in @xmath76 . and , in this case , @xmath12 is omitted . ]        1 .",
    "an @xmath14-structure @xmath76 is * @xmath717-free * if no weak substructure of @xmath76 is in @xmath717 .",
    "let @xmath718 denote the class of finite @xmath717-free @xmath14-structures .",
    "@xmath717 is * minimal * if , for any @xmath719 , no proper weak substructure of @xmath76 is in @xmath717 .",
    "suppose now that @xmath720 is a class of finite @xmath14-structures such that @xmath721 for some class @xmath722 .",
    "let @xmath723 be the class of finite @xmath14-structures @xmath76 such that @xmath76 is not in @xmath106 , but every proper weak substructure of @xmath76 is in @xmath106 .",
    "then @xmath717 is minimal , and it is straightforward to show that @xmath724 .",
    "we call @xmath723 the _ minimal forbidden class _ for @xmath720 . the reader may very that , if @xmath106 is a frass  class , then @xmath720 is closed under free amalgamation if and only if every structure in @xmath723 is @xmath12-irreducible .",
    "[ thm : irred ] suppose @xmath13 is a countable ultrahomogeneous @xmath14-structure .",
    "let @xmath106 be the age of @xmath13 , assume @xmath725 for some class @xmath726 , and let @xmath723 be the minimal forbidden class for @xmath720 .    1 .",
    "if every structure in @xmath717 is @xmath589-irreducible then @xmath19 is simple .",
    "assume @xmath106 is closed under free amalgamation of @xmath14-structures .",
    "then @xmath19 is simple if and only if every structure in @xmath717 is @xmath589-irreducible .",
    "part @xmath21 . using a straightforward generalization of hrushovski s proof @xcite of simplicity of the generic @xmath5-free @xmath6-hypergraphs for @xmath26 ,",
    "we show @xmath505 coincides with @xmath411 in @xmath28 ( which , since @xmath411 is symmetric , gives the simplicity of @xmath19 ) .",
    "first , we show that if @xmath69 are pairwise disjoint subsets of @xmath28 , then @xmath727 .",
    "let @xmath728 and @xmath729 be disjoint tuples from @xmath28 and fix @xmath46 disjoint from both @xmath37 and @xmath518 .",
    "fix an infinite @xmath81-indiscernible sequence @xmath730 , with @xmath731 .",
    "we want to find @xmath732 such that @xmath733 for all @xmath734 . by passing elements from @xmath518 to @xmath81",
    ", we may assume @xmath735 .",
    "let @xmath736 .",
    "define an @xmath14-structure @xmath112 with universe @xmath737 where @xmath732 is a tuple disjoint from @xmath206 .",
    "define relations on @xmath112 so that @xmath206 is a substructure of @xmath112 and , for each @xmath734 , @xmath738 .",
    "no other relations hold in @xmath112 ; in particular , if @xmath739 , @xmath740 , and @xmath741 , with @xmath742 , then @xmath743 are not related in @xmath112 .",
    "note that , if @xmath112 is @xmath717-free , then we may embed @xmath112 in @xmath28 over @xmath206 , and the image of @xmath503 in @xmath13 is as desired .",
    "therefore it suffices to show that @xmath112 is @xmath717-free .",
    "suppose , toward a contradiction , that some @xmath719 is a weak substructure of @xmath112 .",
    "since @xmath206 is @xmath717-free , we must have some @xmath744 . moreover , for any fixed @xmath734 , we have @xmath745 , and so , since @xmath746 is @xmath717-free , it follows that @xmath76 is not entirely contained in any single @xmath747 .",
    "therefore , we may fix @xmath289 , and elements @xmath748 and @xmath749 , such that @xmath750 . since @xmath76 is @xmath589-irreducible",
    ", it follows that @xmath751 are related in @xmath112 , which is a contradiction .",
    "part @xmath22 .",
    "assume @xmath13 is closed under free amalgamation of @xmath14-structures , and suppose @xmath719 is not @xmath589-irreducible .",
    "we show that @xmath411 does not coincide with @xmath505 in @xmath28 , which , by theorem [ thm : simp ] , suffices to show that @xmath19 is not simple .",
    "suppose , toward a contradiction , that some @xmath765 is a weak substructure of @xmath206 .",
    "recall that every element of @xmath717 is @xmath12-irreducible . by construction of @xmath206",
    ", it follows that @xmath766 is a substructure of @xmath767 for some @xmath289 . but",
    "@xmath767 is isomorphic to a proper substructure of @xmath76 by definition , which contradicts that @xmath717 is minimal .",
    "therefore @xmath206 is @xmath717-free and so we may assume @xmath768 . note that @xmath769 is @xmath770-indiscernible .",
    "let @xmath771 and @xmath772 . since @xmath717 is minimal , we may use similar arguments to find @xmath773 such that @xmath774 , for @xmath763 .",
    "we use @xmath769 to show @xmath775 ( since algebraic closure is trivial , we have @xmath776 , and so this suffices to finish the proof ) .",
    "suppose , toward a contradiction , there is @xmath777 such that @xmath778 for all @xmath734 .",
    "then , by construction , @xmath779 , @xmath780 , and @xmath781 .",
    "since @xmath758 are not related in @xmath76 , it follows that @xmath76 is a weak substructure of @xmath782 , which contradicts that @xmath28 is @xmath717-free ."
  ],
  "abstract_text": [
    "<S> we use axioms of abstract ternary relations to define the notion of a _ </S>",
    "<S> free amalgamation theory_. these form a subclass of first - order theories , without the strict order property , encompassing many prominent examples of countable structures in relational languages , in which the class of algebraically closed substructures is closed under free amalgamation . </S>",
    "<S> we show that any free amalgamation theory has elimination of hyperimaginaries and weak elimination of imaginaries . with this result </S>",
    "<S> , we use several families of well - known homogeneous structures to give new examples of rosy theories . </S>",
    "<S> we then prove that , for free amalgamation theories , simplicity coincides with @xmath0 and , assuming modularity , with @xmath1 as well . we also show that any simple free amalgamation theory is @xmath2-based . </S>",
    "<S> finally , we prove a combinatorial characterization of simplicity for frass  limits with free amalgamation , which provides new context for the fact that the generic @xmath3-free graphs are @xmath4 , while the higher arity generic @xmath5-free @xmath6-hypergraphs are simple . </S>"
  ]
}