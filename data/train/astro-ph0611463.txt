{
  "article_text": [
    "as a rule astrophysical fluids are turbulent and the turbulence is magnetized . this ubiquitous turbulence determines the transport properties of interstellar medium ( see @xcite , @xcite , @xcite ) and intracluster medium ( see @xcite , @xcite , @xcite ) , many properties of solar and stellar winds ( see @xcite ) etc .",
    "one may say that to understand heat conduction , propagation of cosmic rays and electromagnetic radiation in different astrophysical environments it is absolutely essential to understand the properties of underlying magnetized turbulence .",
    "the fascinating processes of star formation ( see @xcite , @xcite , @xcite ) and interstellar chemistry ( see @xcite and references therein ) are also intimately related to properties of magnetized compressible turbulence ( see reviews by @xcite ) .",
    "we should stress that while the density fluctuations are an indirect way of testing turbulence , the most valuable information is given by the velocity field statistics , encoded in spectrometric observations . to recover it we need to account for mapping of a velocity field in real space to position - position - velocity ( ppv ) observational data cubes .",
    "we have several options here .",
    "for subsonic or slow supersonic turbulence we can use techniques of velocity centroids , which allows us recovering of velocity spectrum ( @xcite ) . as it was shown there , this technique does not work for turbulence with high mach number .",
    "for such turbulence velocity channel analysis ( vca ) ( see @xcite ) , which deals with 2-d slices of ppv , and velocity coordinate spectrum ( vcs ) ( see @xcite , @xcite , @xcite ) should be used .",
    "vca has been already used with both atomic hydrogen and molecular line data to recover the underlying turbulence spectra ( see review by @xcite ) . the technique has been tested with numerics for optically thin case in @xcite and @xcite and also with absorption effects in @xcite . however , rather strong shot - noise was observed in the synthetic channel maps .",
    "for instance , numerical simulations for vca in @xcite show that discretization over line of sight may distort substantially the spectrum at high wavenumbers .",
    "it was also shown , that its impact can be minimized , when velocity slice is made thickest possible for the thin ( velocity - dominated ) regime .",
    "the shot - noise was also observed to decrease with the increase of the cube size used for analysis .",
    "nevertheless , the exact origin of it was somewhat unclear .",
    "this effect seemed to confuse other researchers who started to wonder about the practical utility of the technique with the real spectroscopic data @xcite .",
    "the vcs is a more recent development .",
    "although the formulae for it were obtained in @xcite , the actual application of it has just started @xcite .",
    "no extensive testing of the technique has been performed before this work , as far as we know .    in this paper",
    "we deal with the numerical testing for both vca and vcs techniques . in particular , we subject the origin of shot noise to scrutiny in this paper .    in what follows",
    "we provide some facts about the vca and vcs in sect .",
    "[ sect : bf ] , analyze shot - noise in sect .",
    "[ sect : sn ] , describe the results of numerical testing in sect .",
    "[ sect : res ] and provide the summary in sect . [ sect : sum ] .",
    "we show in fig . [",
    "fig : vca_res ] the essence of the practical data handling with the vca . the data in the ppv data cube",
    "is being analyzed in the slices of @xmath0 thickness .",
    "the images of the eddies can have an extend both larger and smaller than @xmath0 .",
    "the former case is termed by @xcite `` thin slice '' , the latter is termed `` thick slice '' .    in fig .",
    "[ fig : vcs_res ] we illustrate the essence of the vcs technique . depending on the resolution one may or not resolve the spatial extent of the eddies under study .",
    "below we briefly overview the main analytical results , obtained in @xcite , @xcite , @xcite and @xcite , which are relevant for this paper .",
    "our calculations are based on the following expression for a spectral line signal , measured at velocity @xmath1 and given beam position : @xmath2 where @xmath3 is normalized emissivity , @xmath4 is convolution between channel sensitivity function and maxwellian distribution , defined by temperature of emitting medium , and @xmath5 is a window function defined as follows : @xmath6 where @xmath7 is an instrument beam , @xmath8 is a window function defining the extend of the observed object .    if we take a fourier transform of @xmath9 and correlate this quantity taken in two directions @xmath10 and @xmath11 , we have the following measure , which can be used as a starting point for the mathematical formulation of both vca and vcs ( see @xcite for details ) : @xmath12 where @xmath13 and @xmath14 is a velocity structure tensor projection : @xmath15    expression [ [ eq : k12 ] ] is true provided that the following conditions are satisfied : 1 .",
    "fields involved are homogeneous , 2 .",
    "velocity is gaussian , 3 .",
    "absorption effects are negligible , 4 .",
    "beam separation as well as beam width are small enough to neglect the difference between @xmath16 and @xmath17 ( we consider @xmath18-axis to be a bisector of the angle between beams ) .",
    "we also assume that 5 .",
    "@xmath19 depends only on @xmath18 and admits a linear approximation with angular coefficient @xmath20 .",
    "the relative importance of these conditions and the way to avoid some of them within the vca and the vcs framework are discussed in @xcite and @xcite . however , for the sake of simplicity , we do not discuss the most general case here .",
    "if we set @xmath21 ( @xmath22 is a beam separation in picture plane , @xmath23 and @xmath24 are auto - convolutions of @xmath7 and @xmath8 ) , which corresponds to the case of remote emitting object , and take fourier transform over @xmath22 , we have a power spectrum , designated in vca as @xmath25 ( @xcite ) : @xmath26    it is convenient to introduce @xmath27 as a 3d power spectrum of a _ ppv data cube _ with assumption of infinite resolution over @xmath28 and @xmath29 , which , for instance , corresponds to the conditions for the unprocessed synthetic ppv cubes : @xmath30 in this case @xmath31 .",
    "the vca predicts the behavior of the quantity @xmath32 which can be easily determined from observations . for the channel which effective width , where @xmath33 is channel width and @xmath34 is thermal velocity of emitting atoms . ]",
    "is small enough ( see fig .",
    "[ fig : vca_res ] ) @xmath35 is _ velocity dominated _ regime with the slope slope @xmath36 , provided that the density has a steep spectrum , i.e. @xmath37 .",
    "the later can be established from column density measured with infinitely wide slices .",
    "then the spectum is _ density dominated _ , and the slope is @xmath38 .",
    "here @xmath39 and @xmath38 are the slopes of velocity and density power spectra . for a more detailed analysis",
    "see @xcite , while the predictions for different variants of velocity - dominated regime are summarized in tab .",
    "[ tab : p2_slopes ] .",
    "the one - dimensional spectrum @xmath40 is the subject of the vcs studies .",
    "it corresponds to the case when the two beams , involved in @xmath41 , coincide , i.e. @xmath42    in terms of @xmath27 the one - dimensional spectrum can be written as follows : @xmath43 as it was shown in @xcite and @xcite , here we also have two regimes of spectum .",
    "they depend on beamwidth , see fig .",
    "[ fig : vcs_res ] for illustration . for _ high resolution mode _ ( @xmath44 is less than velocity variance on the beam scale )",
    "the slope of @xmath40 is @xmath45 , otherwise , in _ low resolution mode _ it is @xmath46 ( steep density spectrum is assumed for the both cases ) .",
    "more complete list of the predictions for @xmath40 is presented in tab .",
    "[ tab : p1_slopes ] .",
    "if we compare eqs .",
    "[ [ eq : p2 ] ] and [ [ eq : p1 ] ] , we see that the vca and the vcs provide complimentary approaches and are related to the same quantity , @xmath27 .",
    "their properties must be closely related therefore .",
    "in @xcite it was shown , that the quality of the vca simulations strongly depends on the number of points along the line of sight .",
    "the underlying interference was termed _",
    "shot - noise _ to reflect is stochastic nature : insufficient statistics for the signal in spectrometer channels .",
    "we revealed the same type of noise for vcs . in this case , @xmath40 saturates to a constant level , which decreases an available interval of power law ( see fig .",
    "[ fig : vca_vcs_3_67_unfilt ] , right ) .",
    "below we address the condition needed to avoid it .    to have a realistic spectral line we need a velocity field to be resolved over line of sight well enough ( see also @xcite ) .",
    "this means , that the typical scale over @xmath18 , for which velocity stays within a single channel near its extremum , should have enough discretization points , because such extrema give the dominant contribution to the spectrometer signal .",
    "below we estimate the required resolution . to do so",
    ", we need to bind the correspondent typical scale over line of sight with the channel width .",
    "the natural choice is calculating velocity dispersion ( which itself can be associated with the channel width ) for the wavelengths shorter than this scale .",
    "as mentioned above , the contribution of the velocity profile shapes other than extrema , provided by the remaining harmonics , can be neglected .",
    "therefore , the scale found by reverting of this expression is what we need .    in other words ,",
    "we divide the 1-d velocity spectrum domain into the intervals separated by the scale in question @xmath47 , and , as spoken , assume that the harmonics in its low - wavenumber part provide an extremum of velocity . for the higher harmonics , in order to place the bulk of the signal inside one channel , we should demand , that the correspondent variance @xmath48 is about half a channel width : @xmath49 where @xmath47 is a scale , at which velocity stays within a single channel near its extremum , @xmath50 is a number of channels per velocity variance , and @xmath51 is a velocity variance for scales smaller than @xmath52 , expressed through 1-d power spectrum , that refers to the ppv space ] @xmath53 : @xmath54    if a 3-d power spectrum has a cutoff at @xmath55 , where @xmath52 is an injection scale , @xmath53 has the following form for the isotropic 3-d spectrum of @xmath17 @xmath56    then , having solved eq . [",
    "[ eq : sigmabalance ] ] for @xmath47 we get @xmath57    if @xmath58 is a number of points per @xmath47 , then the total number of points along @xmath18 is as follows : @xmath59 where @xmath60 is the size of emitting structure , @xmath58 is determined from simulations and is experimentally found to be around 6 .    the requirements for @xmath61 are rather demanding .",
    "if we have taken our typical settings : 128 channels per triple line width and @xmath62 , then for @xmath63 @xmath61 there should be at least @xmath64 points , for @xmath65 the corresponding number is @xmath66 , while for @xmath67 the number is as big as @xmath68 .",
    "therefore it is not surprising that without this knowledge some researchers could get puzzled by their results ( e.g. @xcite ) .",
    "condition [ [ eq : nz ] ] guarantees , that the spectrum is clear from shot - noise for all available @xmath44 s , i.e. up to @xmath69 , where @xmath70 is the channel width . this estimation refers to the case without smoothing along angular coordinates , i.e. for the high - resolution regime .",
    "low - resolution vcs spectrum drops faster and therefore the requirements are even more restrictive .",
    "vcs spectra , illustrating condition [ [ eq : nz ] ] are presented in fig .",
    "[ fig : nz_req ] .",
    "the velocity spectral index @xmath39 decreases from the top to the bottom ( the values are 4 , 3.78 and 3.56 ) . according to our estimates above , this requires a drastic increase of number of points .",
    "indeed , @xmath61 is , respectively , @xmath71 , @xmath72 and @xmath73 . in the left column with the shot - noise",
    "clearly present @xmath61 is 4 times undervalued , in the right one it is increased by factor two .",
    "examples of restoration of the velocity spectral indices from simulations are presented in tab .",
    "[ tab : alpha_v_re ] .",
    "they show good agreement , with the exception of somewhat outfalling value for @xmath74 .",
    "values of @xmath61 have been chosen regarding eq .",
    "[ [ eq : nz ] ] .",
    "knowing the requirements on @xmath61 , we generate the vcs and vca spectra ( see fig . [",
    "fig : vca_vcs_4_00 ] , with @xmath74 ) .",
    "but for shallower velocity spectrum satisfying such conditions for vca may be difficult , even if we use 2-d data instead of 3-d data cube .",
    "for example , the condition [ [ eq : nz ] ] for the vca simulations at @xmath75 implies a square array with the side @xmath76 , which is difficult to implement at the moment . if we decrease this size , the vca spectrum gets completely distorted , see fig . [",
    "fig : vca_vcs_3_67_unfilt ] , left .",
    "therefore we have to seek alternative approaches .    in @xcite",
    "it was shown , that if we use the thickest possible velocity slice , we get a correct spectrum .",
    "let us consider , why this can happen .",
    "looking at the right panel on fig .",
    "[ fig : vca_vcs_3_67_unfilt ] , we see , that at higher wavenumbers @xmath44 s the vcs spectrum is affected by shot - noise . as both the vca and the vcs spectra are just different projections of the same 3-d power spectrum in the ppv space ( see eqs . [ [ eq : p2 ] ] and [ [ eq : p1 ] ] ) , the noisy harmonics seen in the @xmath40 plot are most likely to affect the @xmath35 spectrum . if we use only @xmath44 s , which correspond to the intact part of @xmath40 , the picture improves significantly , as it can be seen in fig .",
    "[ fig : vca_vcs_3_67_filt ] , left .",
    "such truncation of the @xmath44-domain is equivalent to taking a thicker velocity slice in @xcite .",
    "it is also important to test the vcs prediction of steepening of @xmath40 when the beam is made wide enough to emulate the low resolution regime .",
    "to do so we used steeper velocity spectrum , with slope @xmath77 , which is less demanding in terms of the number of points along line of sight .",
    "if we meet condition [ [ eq : nz ] ] we have a good agreement with the predictions for both high- and low - resolution regime , see fig .",
    "[ fig : vcs_4_00_2d ] .    besides of testing of analytical results",
    ", synthetic data calculations could be helpful when pure analytical approach is difficult or impossible .",
    "for instance , we have tested if vcs technique is applicable in two - phase medium such as interstellar hi .",
    "it was speculated in lp00 that the fluctuations in the channel maps are dominated by cold ( 100  k ) component of hi , while the warm ( 6000  k ) component is subdominant for the vca studies .",
    "this corresponds to the decrease of @xmath78 in eq .",
    "[ [ eq : p1 ] ] .    in our simulations",
    "the phases separation was set by a threshold , applied to the density field .",
    "we assumed that the cold phase corresponds to the density larger than the threshold .",
    "we have also assumed that turbulence is the same for both phases , which can be justified from physical arguments ( see @xcite ) .    in fig .",
    "[ fig : p1_slopes ] the slope of @xmath40 is plotted against the volume fraction of emitting medium for different spectral indices of velocity .",
    "as one can see , with our assumptions there is no visible influence of the fraction of the cold phase .",
    "we argue that the points for the shallow velocity spectrum have rather lower quality , because the condition of the shot - noise elimination [ [ eq : nz ] ] is not met in our simulations .",
    "we must stress , that although fields of applicability of discussed techniques intersect , they do not coincide .",
    "it is quite evident , that vca requires less resolution over velocity coordinate , and it can be used with lesser mach number than the one needed for vcs . on the other hand ,",
    "even if we have very poor statistics over angular coordinates and vca does nt work , vcs still can be used .",
    "it allows , for instance , working with absorption lines from distant sources , observed through the same turbulent medium , like shown on fig .",
    "[ fig : abs ] .",
    "the limiting case is using only one spectral line , but this requires significant regular velocity shear ( it `` unfolds '' velocity fluctuations to wider spectral line and leads to better statistics , which we can utilize by averaging of adjacent @xmath44-harmonics , see fig . [ fig : shear ] ) . without the shear ,",
    "our simulations show , that only @xmath79 independent measurements are needed to gain required statistics for @xmath80 .",
    "we provided numerical testing of the predictions for the vca and the vcs techniques , identified the source of shot noise reported in earlier testings , provided an analytical estimate of the resolution required to eliminate the noise and checked successfully this requirement .",
    "as the vca and vcs techniques are closely related ( cf .",
    "[ [ eq : p2 ] ] and [ [ eq : p1 ] ] ) , the presence of shot - noise in vcs inevitably affects the quality of vca spectrum .",
    "one has to meet a rather demanding requirement given by eq .",
    "[ [ eq : nz ] ] to eliminate the noise .",
    "shot - noise appears in real observations when the number of received photons is low enough .",
    "such could be x - ray or optical observations .",
    "condition [ [ eq : nz ] ] gives in this case the required number of photons and can be used for estimation of observation time .",
    "we found , that if we accurately deal with shot - noise , we get spectra , which are in agreement with predictions of vca / vcs techniques . however the condition for shot - noise elimination can be very demanding for shallower velocity spectra ( @xmath81 exponentially when @xmath82 ) .",
    "this can make the 3-d and even 2-d simulations testing for the vcs and the vca rather difficult .",
    "we observed , that fragmentation of emitting medium due to presence of warm phase does not change the slope of @xmath40 , predicted in vcs , which allows using this technique for neutral hydrogen in milky way in which both cold and warm gas are present .",
    "having numerical tools to test vca / vcs techniques in various physical environments , we enhanced the reliability of the results obtained from observational data .",
    "* acknowledgments * authors thank dmitry pogosyan for his input .",
    "ac and al acknowledge the nsf grant ast-0307869 and al thanks for the support from the center for magnetic self - organization in laboratory and astrophysical plasmas .",
    "the simulation programs were written in c++ .",
    "there are many reasons for using this language .",
    "one of them is that we have a convenient infrastructure for managing of input data and initializing of an object hierarchy , provided by class ` data ` .",
    "it gives us an easy way of setting up the input parameters without a necessity to recompile before each run .",
    "it also allows us to easily configure a batch job and hide details of mpi initialization , if the latter is used .",
    "the input for the class ` data ` is a set of text files with a usual `` id = value '' syntax , linked to each other in a tree .",
    "when we call the ` data ` constructor with a name of a root file , this tree is mapped to a tree of objects of the type ` data ` , each representing one input file .",
    "the object structure of a simulation program is also a tree .",
    "therefore it is convenient to map it to some subtree in the ` data ` hierarchy .",
    "if we do this , constructor signatures rarely become more complex than ` myclass::myclass(data * ) ` and all data initialization is done by instantiating of a root object :      data files allow references defined by a path with respect to a root node .",
    "this allows us , for example , to avoid duplicating of identical data , or to put frequently changed data in one file .",
    "such reorganizations do not require any changes in a program because references are transparent for client code .",
    "this mechanism is also used for running a program in batch mode . in this case one",
    "file ( `` plugin '' ) contains all the information to be changed at each run and is re - generated by a controlling program before restarting of simulation .",
    "a separate node is created for defining this information , a `` parameter space '' .",
    "practically it means that we specify parameters to be scanned in a ` parspace.df ` file and run our ` runtask ` command , which takes care of ` plugin.df ` , controls the execution and stores results of each simulation in a dynamically created directory tree .",
    "class diagram for our programs , shown in fig .",
    "[ fig : classd ] , is approximately the same regardless of vca or vcs version , number of dimensions , or presence of parallelization .",
    "generation of random field is implemented in an abstract class ` rfield ` , from which classes ` velocity ` and ` density ` are derived .",
    "the function ` rfield::powerspectrum(vector k ) ` is clean and needs definition in subclasses .",
    "this allows us to have different power spectra with the same random field generation code .",
    "class ` emissivity ` implements emissivity law ( linear or quadratic ) and applies a spatial window function .",
    "class ` instrument ` generates spectral data of required dimension and applies an instrument beam ( in 2-d and 3-d vcs programs ) .",
    "these data are processed in class ` p1 ` ( vcs ) or in class ` p2 ` ( vca ) .",
    "class ` dprocessor ` controls generation and processing of realizations and accumulation of spectra .",
    "the source of simulation programs is available at ` www.astro.wisc.edu/\\!\\!\\simlazarian/simulations ` , see tab . [ tab : progs ] for the complete list .",
    "we also provide a utility for running simulations in batch mode , ` runtask ` .",
    "the programs need installed idl to produce graphics .",
    "chepurnov , a. , lazarian , a. , submitted to apj ( 2006 ) chepurnov , a. , lazarian , a. , stanimirovic , s. , peek , j. e. g. , heiles , c. , submitted to apj ( 2007 ) cho , j. , lazarian , a. , & vishniac , e. t. , apj , in press ( 2003 )                                                                      llll spect1d & 1 & vcs & single processor + spect2d & 2 & vcs & single processor + spect3d & 3 & vcs & single processor + p_spect2d & 2 & vcs & mpi + p_spect3d & 3 & vcs & mpi + vca3d & 3 & vca & single processor + p_vca2d & 2 & vca & mpi + p_vca3d & 3 & vca & mpi +"
  ],
  "abstract_text": [
    "<S> turbulence is a key element of the dynamics of astrophysical fluids , including those of interstellar medium , clusters of galaxies and circumstellar regions . </S>",
    "<S> turbulent motions induce doppler shifts of observable emission and absorption lines and this motivates studies of turbulence using precision spectroscopy . </S>",
    "<S> we provide high resolution numerical testing of the two promising techniques , namely , velocity channel analysis and velocity coordinate spectrum . </S>",
    "<S> we obtain an expression for the shot noise that the discretization of the numerical data entails and successfully test it . we show that numerical resolution required for recovering the underlying turbulent spectrum from observations depend on the spectral index of velocity fluctuations . thus the low resolution testing may be misleading . </S>"
  ]
}