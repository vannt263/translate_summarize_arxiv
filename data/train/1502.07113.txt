{
  "article_text": [
    "in this article we introduce foundations of functional time series and the frequency  domain analysis in this context .",
    "we address the article to larger audience , assuming only elementary knowledge of probability theory and algebra .",
    "although , we try to keep the text accurate , in some fragments we sacrifice detailed investigation for intuitive argumentation , referring advanced readers to appropriate sources .",
    "the manuscript is divided into two parts . in the first part",
    ", we introduce concepts from statistics and functional data analysis ( fda ) .",
    "we built upon basic ideas about continuous functions and probability . in the second part",
    ", we present some state - of - the - art results in linear models for functional objects .",
    "the main concern of statistics is to obtain essential information from a sample of observations @xmath0 from some space of objects .",
    "we are given a finite sample of size @xmath1 , where @xmath2 can be scalars ( like heights of a sample of students in a school ) , vectors ( like points on a target after throwing several darts ) or more complex objects , like genotypes , fmri scans , images or frames of a video .",
    "functional data analysis deals with observations which can be naturally expressed as functions .",
    "figures [ fig : example1 ] , [ fig : example2 ] and [ fig : example3 ] present several cases , from various areas of science , which fit into the framework of functional data analysis .",
    "when we deal with a physical process it is often natural to assume that it behaves in a continues manner and that the observations do not oscillate significantly between the measurements .",
    "although , in the digital age , we rarely record analog processes continuously , we often have enough datapoints , so that interpolation does nt cause a significant measurement error .",
    "models incorporating this additional structure can lead to more precise and meaningful foundings . in this context",
    ", fda can be seen as a tool which embeds the continuity feature into the model .    except for good approximation of a continuous process",
    ", fda can also prove to be useful in a noisy , discontinuous case .",
    "then , fda can serve as a tool for denoising and smoothing the data and is beneficial whenever the underlying process is the main concern , like , for example , in finance .    from a pragmatic perspective , functional data can be seen simply as infinitely dimensional vectors , with extended notion of variance and mean , and thus we may be tempted to employ classical multivariate techniques . however , there are many practical and theoretical problems that need to be addressed and this approach is not advised , as we will see later .",
    "the fda approach is also useful in a parsimonious representation of the data by taking advantage of their smoothness . instead of looking at a function as a dense vector of values ,",
    "we can often represent it in an linear combination of a handful of ( well  chosen ) basis functions .",
    "practical applications of functional data analysis are spread across many areas of science and engineering .",
    "panaretos et al .",
    "@xcite use @xmath3 \\rightarrow { \\boldsymbol r}^3 $ ] closed curves to analyze the behavior of dna microcircles , providing the testing methodology for the comparison of two classes of curves .",
    "aston and kirch  @xcite analyze the stationarity and change point detection for functional time series , with applications to fmri data .",
    "hadjipantelis et al .",
    "@xcite analyze mandarin language using functional principal components .",
    "functional time series also naturally emerge in financial applications ",
    "kokoszka and reimherr  @xcite analyze predictability of the shape of intraday price curves .",
    "these works are only a fraction of the ongoing research and for a more accurate survey on applications and theory we refer to books @xcite , @xcite , @xcite and @xcite .      for most of the results presented in this work we only require a _",
    "separable hilbert space _",
    ", a linear metric space with the norm function induced by the inner product and with a countable basis .",
    "it makes the setup very general , but for simplicity , and in order to give an intuitive example to each of the results , in most cases we will assume a concrete space of square - integrable functions on a bounded interval @xmath3 $ ] , to which we will refer to as @xmath4 .",
    "a function @xmath5 belongs to @xmath4 if and only if @xmath6 in this section we present elementary properties of hilbert spaces .    with a space @xmath4 , we associate an _ inner product _ , a bilinear operator @xmath7 . for two functions @xmath8 , we define the _ inner product _ as @xmath9 we define the norm of the element @xmath10 as @xmath11 . since @xmath4 is a space of square - integrable functions , each element @xmath10 has a finite norm .",
    "we say that @xmath12 and @xmath13 are _ orthogonal _ if @xmath14 .",
    "if , additionally , @xmath15 , we say that @xmath12 and @xmath13 are _",
    "orthonormal_. both definitions are related to vector spaces : a norm corresponds to the `` distance '' from @xmath16 function , whereas orthonormal elements behave as perpendicular vectors .",
    "hilbert space is called _ separable _ if we can find a series of pairwise orthonormal elements @xmath17 such that each element in @xmath18 can be expressed as a weighted sum of elements @xmath17 .",
    "this series @xmath19 is called _ a basis _ , and each @xmath20 is _ a basis function_.    one can show , that given the basis @xmath19 , the representation of @xmath10 is uniquely given by @xmath21 where scalars @xmath22 are called _ coefficients in the basis @xmath19_.    we may find infinitely many basis of @xmath4 . as an example ,",
    "often used in practice , consider the fourier series , defined as @xmath23 where @xmath24 and @xmath25 .",
    "several first elements are presented in figure [ fig : fourier - basis ] . a proof that elements are orthonormal is a simple exercise .",
    "the proof that each element in @xmath12 can be uniquely expressed as a linear combination is more complicated and an interested reader is referred to @xcite .     and",
    "@xmath26 basis functions ( right).,title=\"fig:\",height=264 ]    and @xmath26 basis functions ( right).,title=\"fig:\",height=264 ]    we will use , one of the fundamental equations in separable hilbert spaces , a parseval s identity .",
    "let @xmath10 and let @xmath19 be an orthonormal basis in @xmath4 .",
    "then @xmath27    it follows from the definition of the norm @xmath28 because @xmath29 if @xmath30 and @xmath16 otherwise , due to orthonormality of the series @xmath19 .",
    "we will also use the notion of _ linear operators _ and _ hilbert ",
    "schmidt operators_. a _ linear operator _",
    "@xmath31 is a function such that for any pair of scalars @xmath32 and elements @xmath33 , @xmath34 .",
    "hilbert schmidt ",
    "@xmath35 is a linear operator , such that @xmath36 where @xmath37 is an orthonormal basis of @xmath4 .",
    "an operator is _ symmetric _ if @xmath38 for each @xmath39 .      in practice",
    "we are often given just a sample of observations from a curve and we need to interpolate , i.e. draw a curve between these points which is most likely to be close to the underlying process .    in this work ,",
    "we follow the ideas popularized by ramsey and silverman @xcite , based on a basis function expansion .",
    "note that , given the representation [ basis : representation ] , by the parseval s identity , for any @xmath40 , there exists @xmath41 , such that @xmath42 we can therefore approximate the function with arbitrary precision @xmath40 using only the first @xmath41 basis elements .    in practice , inner products , which are typically obtained by integration , will be themselves approximated by corresponding sums .",
    "then , a discretized sample curve @xmath43 can be transformed into a ( finite dimensional ) curve @xmath44 through @xmath45 for some grid @xmath46 , where the expression in brackets accounts for the approximation of the inner product between @xmath12 and @xmath20 .",
    "fitting and representation of functional data is an important and intensively studied topic on its own , however , in this article we assume that datapoints are _ fully observed _",
    ", i.e. we observe the whole curves , instead of just a sample of points . for more information on fitting",
    "we refer to @xcite .      random function is the key concept used in the sequel .",
    "we can think of it as an extension of a random value or a random vector from @xmath47 .",
    "instead of drawing a random point from a plane , we draw a whole function from all functions in @xmath4 . in this section",
    "we introduce a mean function and a covariance operator .",
    "we will extend the concept of expected value of a scalar variable to vectors and functions .    in the space @xmath47",
    ", we refer to a mean as an expected value on each coefficient , for example , having a random vector @xmath48 , we define a mean of this variable as @xmath49",
    ".    similarly we can look at a random function @xmath50 .",
    "we can define it s mean as a mean on each coefficient .",
    "let s take a fixed basis @xmath51 and an expansion of @xmath50 , given by @xmath52 then , random variables @xmath53 correspond to coefficients , so a mean function can be defined as @xmath54 where we defined the expectation of random function as a sum of scalar expectations @xmath55 . note that , as in scalar case @xmath55 may not be finite and then also @xmath56 will not exist .",
    "moreover , in order to have @xmath57 , we need the series @xmath58 to be square summable .",
    "defining covariance in functional space is more complicated and , in order to show a direct relation , we will recall a non - standard representation of a covariance in multidimensional space .",
    "one of the ways to look at a covariance of a random vector @xmath59 in @xmath47 , is to see it as a linear function @xmath60 , defined as @xmath61 where @xmath62 .",
    "we have @xmath63 ( and we refer to the variance as @xmath64 ) .",
    "note , that since @xmath65 is a scalar , @xmath66 is a random vector and therefore we just use the definition of the mean vector .    in the functional space , we will define a covariance operator as an operator @xmath67 . for a random element @xmath50 in @xmath4 , similarly to the vector case",
    ", we take the expectation of @xmath66 , i.e. @xmath68 we call @xmath69 , an outer product and write @xmath70 . again",
    ", we consider only such random functions @xmath50 that @xmath71 exists .",
    "one can show that the operator @xmath71 is a positively definite , symmetric hilbert ",
    "schmidt operator and therefore it can be inversed .",
    "in many practical situations functions are naturally ordered in time . for example , when we deal with daily observations of the stock market or with sequences of tumor scans . then , we are in the context of so  called functional time series ( fts ) .        as a motivating example consider figure [ fig : honolulu ] . here",
    ", the assumption of independence can be too strong  values at the beginning of each day are highly correlated with those at the end of the preceding day .",
    "moreover , we see that big jumps are often followed by significant drops .",
    "these , and similar features , may indicate significant temporal dependence not just within a subject , but also between different subjects ( e.g.  days ) . in this section",
    "we discuss possible frameworks which allow to quantify , and use this additional information .",
    "many physical processes are known to have time - invariant distribution .",
    "this motivates the frequentist approach to time series , where we assume that the structure does not change in time and we interfere from estimated covariances .",
    "let @xmath72 be a series of random functions .",
    "we say that @xmath72 is _ stationary _ in the _ strong  sense _ if for any @xmath73 and any sequence of indices @xmath74 vectors @xmath75 and @xmath76 are identically distributed .",
    "additionally , we will assume that a series in the sequel are _ weakly dependent _ , which intuitively means that observations from the _ far past _ have little to no effect on the present .",
    "many frameworks were suggested to quantify this behavior , for a survey on most popular ones refer to @xcite . for simplicity in this work",
    "we just assume a very strong condition , of a weakly dependent series as a stationary series for which @xmath82 meaning that the covariance between far elements decays very fast .",
    "one of the most popular frameworks in classical statistics is the linear regression , where we try to quantify the linear dependence between two ( possibly multivariate ) variables @xmath50 and @xmath83 .",
    "the problem of finding the relation of this type can be also addressed in fda . as an illustrative example we can think of the relation between some farm s income during the year ( a function of time defined on a yearly interval ) and precipitation over a year .        as we are concerned with functional time series",
    ", we will assume that @xmath88 are weakly stationary and weakly dependent .",
    "classical case of iid @xmath89 is of great scientific interest and the interested reader is referred to @xcite and @xcite .    although the functional linear regression shares many properties with its multivariate equivalent , there are important theoretical difficulties , which preclude direct extension of the results from the simpler setup .",
    "especially , we note that the linear operator @xmath90 is infinitely dimensional , which considerably complicates the estimation . if we approach the problem in the classical way by multiplying both sides of by @xmath89 and taking the expectation , for @xmath91 we have @xmath92 by independence of @xmath89 and @xmath86 .",
    "now , for convenience , let s denote this by @xmath93 where @xmath94 is the cross - covariance operator of @xmath50 and @xmath83 and @xmath95 is the covariance of @xmath50 .",
    "now , the natural way to obtain @xmath85 is to apply the inverse of @xmath95 to both sides of the equation , which yields @xmath96 the main problem is that the operator @xmath97 is no longer bounded .",
    "indeed , the domain of @xmath95 is only a subset @xmath98 , say , of @xmath4 . to see this , note that formally , as the inverse of @xmath95 is a linear operator , we may express @xmath99 , where @xmath100 and @xmath101 are the eigenvalues ( tending to zero ) and eigenfunctions of @xmath95",
    "hence , @xmath102 .",
    "the problem can be approached by some regularization .",
    "e.g.  one may replace @xmath97 by a finite dimensional approximation of the form @xmath103 , where @xmath104 is a tuning parameter .",
    "this is still quite delicate , when applied to the sample version .",
    "then for large values of @xmath104 , if we underestimate one of the small eigenvalues , its reciprocal explodes and will lead to very instable estimators .",
    "on the other hand , for small @xmath104 we may get a very poor approximation of @xmath85 .",
    "this difficulty was addressed by bosq @xcite , who gives an extensive survey on the problem . however , proposed results are based on strong assumptions on the rate of convergence of eigenvalues , which are impossible to check in practice .",
    "alternative , elementary data  driven approach , was suggested in @xcite .",
    "finally , note that exactly the same technique can be used for lagged linear regression , i.e. where the response @xmath105 depends linearly not only on the current observation @xmath89 but also on the whole series @xmath89 .",
    "consider @xmath106 where @xmath107 .",
    "again , as an example , we can think of it as an income during a given year based on precipitation in last 3 years .",
    "let @xmath108 be the largest lag that we want to take into account and let us introduce @xmath109 .",
    "one can easily show that the space @xmath110 is a hilbert space .",
    "then , the model can be written as @xmath111 where @xmath112 is a linear operator such that @xmath113 .",
    "now , for estimating @xmath114 in , we can apply the same estimation procedures as in .",
    "this method of estimation in lagged regression models is efficient only for small dimensions and small @xmath108 , as opposed to the technique briefly introduced in the following section .",
    "the lagged linear model can be linked with the concept of linear filtering , popular in multivariate time series as well as in signal processing .",
    "for the theory and survey on applications in this context we refer to the classical book of oppenheim and schafer @xcite .",
    "the fourier transform has two important properties which simplify analysis of the process .",
    "first , multiplication in the frequency domain is equivalent to convolution in the time domain .",
    "second , the fourier transform is a bijection , so results in frequency domain are equivalent to these in the time domain .    to illustrate the usage of these features",
    "let us multiply equation by @xmath119 for some @xmath120 and take the expectation .",
    "by linearity we have @xmath121 and by stationarity @xmath122 where @xmath123 .",
    "now , noting that on left we have @xmath124 and on right we have the convolution of @xmath125 and @xmath126 , the fourier transform of both sides yields the so  called cross - spectral operator between @xmath127 and @xmath72 and can be obtained as @xmath128 where @xmath129 is the _ frequency response function _ of the series @xmath130 , @xmath131 is the _ spectral density operator _ of @xmath127 and @xmath72 and @xmath132 is the spectral density operator of @xmath72 .    having relation , again we can invert @xmath132 and obtain a closed  form expression for @xmath133 .",
    "now , the inverse fourier transform gives us coefficients of the model . note",
    "that , although we employ more sophisticated tools than in linear regression , symbolically approach presented here is analogical , but developed in the frequency domain .",
    "z. hadjipantelis , j.  a.  d. aston , and j.  p. evans . characterizing fundamental frequency in mandarin : a functional principal component approach utilizing mixed effect models .",
    ", 131(6):46514664 , 2012 ."
  ],
  "abstract_text": [
    "<S> the continuous advances in data collection and storage techniques allow us to observe and record real - life processes in great detail . </S>",
    "<S> examples include financial transaction data , fmri images , satellite photos , earths pollution distribution in time etc . due to the high dimensionality of such data , </S>",
    "<S> classical statistical tools become inadequate and inefficient . </S>",
    "<S> the need for new methods emerges and one of the most prominent techniques in this context is functional data analysis ( fda ) .    </S>",
    "<S> the main objective of this article is to present techniques of the analysis of temporal dependence in fda . </S>",
    "<S> such dependence occurs , for example , if the data consist of a continuous time process which has been cut into segments , days for instance . </S>",
    "<S> we are then in the context of so - called functional time series . </S>"
  ]
}