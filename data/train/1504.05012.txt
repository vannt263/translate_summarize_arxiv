{
  "article_text": [
    "in 2000 , elekes and rnyai @xcite proved the following result . given a constant - degree real polynomial @xmath8 , and finite sets @xmath9 of size @xmath2 , we have @xmath10 unless @xmath11 has one of the forms @xmath12 or @xmath13 , with univariate real polynomials @xmath14 .",
    "recently , raz , sharir , and solymosi @xcite extended an argument introduced in @xcite to improve the upper bound to @xmath4 ( when @xmath11 does not have one of the special forms ) .",
    "elekes and szab @xcite generalized the result of @xcite to any complex algebraic surface of the form @xmath15 where @xmath3 is an irreducible polynomial in @xmath16 $ ] .",
    "they showed that if @xmath1 are finite sets of size @xmath2 , then @xmath17 is subquadratic in @xmath2 , unless @xmath3 has a certain exceptional form .",
    "the exceptional form of @xmath3 in this statement is harder to describe ( see @xmath18 in theorem [ thm : main1 ] below ) , but is related to an underlying group structure that describes the dependencies of @xmath3 on each of the variables ( similar to the addition or multiplication that appear in the exceptional forms of @xmath19 in @xcite ) .",
    "the upper bound that elekes and szab obtained , when @xmath3 is not exceptional , was @xmath20 , for an undetermined constant @xmath21 that depends on the degree of @xmath3 .",
    "[ [ our - results . ] ] our results .",
    "+ + + + + + + + + + + +    in this paper , we show that the theorem of elekes and szab holds for @xmath22 , thereby extending the strengthened result of @xcite to the generalized setup in @xcite . more precisely , our main result is the following theorem .",
    "[ thm : main1 ] let @xmath23 $ ] be an irreducible polynomial of degree @xmath24 , and assume that none of the derivatives @xmath25 , @xmath26 , @xmath27 is identically zero .",
    "then one of the following two statements holds .",
    "+ @xmath28 for all @xmath29 with @xmath30 we have @xmath31 @xmath18 there exists a one - dimensional subvariety @xmath32 , such that for all @xmath33 , there exist open sets @xmath34 and one - to - one analytic functions @xmath35 with analytic inverses , for @xmath36 , such that @xmath37 and for all @xmath38 , @xmath39    note that for an arbitrary nonzero polynomial @xmath23 $ ] of degree @xmath24 and @xmath29 with @xmath30 , the schwartz - zippel lemma ( stated as lemma [ lem : schwartzzippel ] in the appendix ) gives the bound @xmath40 .",
    "thus , for polynomials that do not satisfy property @xmath18 , the bound in property @xmath28 gives an improvement when @xmath24 is not too large ( to be precise , for @xmath41 ) .",
    "when property @xmath18 holds , property @xmath28 fails .",
    "indeed , consider any @xmath42 and @xmath43 as in property @xmath18 .",
    "if we set @xmath44 , @xmath45 , and @xmath46 , then we have @xmath47 .",
    "now choose @xmath48 , @xmath49 , and @xmath50 so that we have @xmath51 , @xmath52 , and @xmath53 ; this is clearly possible for @xmath54 with a sufficiently small absolute value . then @xmath55 .",
    "the theorem can easily be extended to polynomials @xmath3 that are not irreducible .",
    "indeed , we can factor @xmath3 into irreducible factors and apply the theorem to each factor .",
    "then we can conclude that either @xmath28 holds for @xmath3 , or @xmath18 holds for one of the factors of @xmath3 , or one of the factors of @xmath3 has an identically zero partial derivative , i.e. , does not depend on one of the variables .",
    "our proof also works when the sets @xmath56 do not have the same size .",
    "such an `` unbalanced '' form was not considered in @xcite or @xcite , but similar unbalanced bounds were obtained in @xcite , and they are useful in applications where the roles of @xmath56 are not symmetric ( see for instance corollary [ cor : directions ] ) .",
    "we obtain the following result , which subsumes theorem [ thm : main1 ] ( as will be argued later ) ; we have stated both for clarity .",
    "[ thm : main2 ] in theorem [ thm : main1 ] , property @xmath28 can be replaced by : + @xmath57 for all triples @xmath29 of finite sets , we have @xmath58    we also have the following specialization of theorem [ thm : main2 ] when @xmath3 is a real polynomial .",
    "of course , theorems [ thm : main1 ] and [ thm : main2 ] also hold when @xmath3 is real , but it does not immediately follow that , in property @xmath18 of these theorems , the functions @xmath59 can be chosen so that they map @xmath6 to @xmath6 .",
    "the following theorem shows that this is indeed the case .",
    "we write @xmath60 for the real zero set of a real polynomial , and we refer to @xcite for the definition of the dimension of a real zero set . note that if @xmath60 has dimension less than 2 , then it is not hard to obtain a better bound than in @xmath28 .",
    "[ thm : main3 ] let @xmath61 $ ] be a polynomial of degree @xmath24 that is irreducible over @xmath6 , such that @xmath60 has dimension 2 .",
    "then property @xmath18 in both theorems [ thm : main1 ] and [ thm : main2 ] can be replaced by : + @xmath62 there is a one - dimensional subvariety @xmath63 such that for all @xmath64 , there are open intervals @xmath65 and one - to - one real - analytic functions on an interval @xmath66 is _ real - analytic _ if it has a power series expansion at each point of @xmath66 . ]",
    "@xmath67 with real - analytic inverses , for @xmath36 , such that @xmath68 and for all @xmath69 , @xmath39    [ [ discussion . ] ] discussion .",
    "+ + + + + + + + + + +    our proof follows the setup of sharir , sheffer , and solymosi @xcite .",
    "we convert the problem at hand into an incidence problem for points and curves , and then apply a szemer ' edi - trotter - like incidence theorem ( in our case a variant due to solymosi and de zeeuw @xcite ) to obtain the bound in @xmath28 .",
    "this theorem does not apply when the constructed curves have many common components , and in this case the special form in @xmath18 is deduced . in the various instances of this setup , including raz , sharir , and solymosi @xcite , it is this second part of the analysis that is the most difficult , and the same is true for our proof .    although the results in this paper generalize those of @xcite , our analysis of the case where the curves have many common components uses entirely different machinery . instead of the purely algebraic study of properties of polynomials that was used in @xcite , the approach here",
    "requires more advanced tools from algebraic geometry , and applies them in a considerably more involved style .",
    "this part of our proof was inspired by a technique used by tao @xcite for a variant of the elekes - rnyai problem over finite fields .",
    "that the current problem is considerably more difficult than the elekes - rnyai problem ( in spite of the similarities ) can also be seen by comparing the original respective studies in @xcite and in @xcite .",
    "we regard the considerable simplification ( on top of the improvement of the bound ) of the analysis of elekes and szab in @xcite as a major outcome of this paper .",
    "we note that the polynomial dependence of our bound on the degree of @xmath3 is also a significant feature , because it allows us to obtain non - trivial bounds for polynomials of non - constant ( but not too large ) degree . in some of the applications mentioned below , an improved dependence on @xmath24 could have interesting consequences . in the proof of @xcite , determining this dependence was out of the question , since their exponent depended on the degree of the polynomial .",
    "another feature is that we work over @xmath70 instead of @xmath6 , as was partially done in @xcite , but not in @xcite .    in order to apply our results to a specific problem , like those mentioned below",
    ", one needs to verify that the polynomial @xmath3 that arises does not have the special form in property @xmath18 .",
    "this step is far from being straightforward .",
    "the problem can be reduced to verifying a certain identity in the partial derivatives of @xmath3 ( see ( * ? ? ?",
    "* lemma 33 ) ) , but even for polynomials of fairly low degree , this can be computationally forbidding . in other cases , one may not have an explicit form for @xmath3 , and then a deeper analyis of the specific problem is required .",
    "[ [ applications . ] ] applications .",
    "+ + + + + + + + + + + + +    besides being an interesting problem in itself , the elekes - szab setup arises in many problems in combinatorial geometry . to demonstrate this , we describe how the setup can be applied to the following problem , which was studied in @xcite : given three _",
    "non - collinear _",
    "points @xmath71 and a point set @xmath72 in @xmath73 , obtain a lower bound for the number of distinct distances between @xmath71 and the points of @xmath72 .",
    "let @xmath74 denote the set of squared distances between @xmath71 and the points in @xmath72 .",
    "a point @xmath75 determines three squared distances to @xmath76 , @xmath77 , @xmath78 , given by @xmath79 the variables @xmath80 and @xmath81 can be eliminated from these equations to yield a quadratic equation @xmath82 ( with coefficients depending on @xmath76 , @xmath77 , @xmath78 ) . by construction , for each point @xmath75 , the corresponding squared distances @xmath83 , @xmath84 , @xmath85 belong to @xmath74 .",
    "the resulting triples @xmath86 are all distinct , so @xmath3 vanishes at @xmath87 triples of @xmath88 . moreover , using the fact that @xmath76 , @xmath77 , @xmath78 are non - collinear , one can show that @xmath3 does not have the special form in property @xmath62 of theorem  [ thm : main3 ] .",
    "then property @xmath28 gives @xmath89 , or @xmath90 , which is the same lower bound that was obtained in @xcite using an ad hoc analysis .",
    "when @xmath76 , @xmath77 , and @xmath78 are collinear , @xmath3 becomes a linear polynomial , in which case it certainly satisfies property @xmath62 , and the above bound on @xmath91 does not hold ; in this case the minimum is @xmath92 ( see @xcite ) .",
    "many other combinatorial questions involving geometric notions such as distances , slopes , or collinearity lead to polynomial relations of the form @xmath93 , and often they can be reduced to studying the number of zeros that such polynomials attain on a cartesian product .",
    "several examples where @xmath3 has the form @xmath94 are given in @xcite .",
    "the following is a sample of other problems that fit into the current framework , but that do not have the explicit form @xmath95 required in @xcite .",
    "@xmath96 bounding from below the number of distinct distances determined by a point set contained in an algebraic curve  @xcite .",
    "@xmath97 bounding from above the number of triple intersection points of three families of unit circles , where the circles in each family pass through a fixed point @xcite .",
    "@xmath98 bounding from above the number of collinear triples among @xmath2 points on an algebraic curve @xcite .",
    "each of these problems can be seen to fit the current framework , and property @xmath28 of theorem [ thm : main1 ] would give an interesting bound , if one can show that property @xmath18 does not hold . for problems @xmath96 and @xmath97 , the bound that one would obtain in this way was already achieved in the respective references  @xcite , using an ad hoc analysis .",
    "that leaves problem @xmath98 , for which so far no direct approach has succeeded . in section [ sec : collinear ] , we show how this problem can be attacked with our theorem , using ideas based on those of elekes and szab @xcite .",
    "we state one of the resulting theorems here , but several variants can be found in section [ sec : collinear ] .",
    "we say that a triple is _ proper _ if its entries are distinct .",
    "any @xmath2 points on a constant - degree irreducible algebraic curve in @xmath99 determine @xmath4 proper collinear triples , unless the curve is a line or a cubic .",
    "[ [ organization . ] ] organization .",
    "+ + + + + + + + + + + + +    the paper is organized as follows .",
    "the proof of theorem  [ thm : main2 ] is given in section  [ sec : proofofmain ] , except for the key proposition  [ prop : keyprop ] , which is proved in section  [ sec : proofofkey ] , and the incidence bound , which is presented in section  [ sec : incgeom ] .",
    "theorem  [ thm : main1 ] is deduced from theorem  [ thm : main2 ] at the end of section  [ sec : proofofmain ] .",
    "section  [ sec : real ] shows how to deduce the real case , theorem  [ thm : main3 ] , from the proof of the complex case .",
    "the applications of our theorem to collinear triples on curves are given in section  [ sec : collinear ] .",
    "the appendix presents some algebraic geometry infrastructure that is heavily used in the proof .",
    "[ [ acknowledgments . ] ] acknowledgments .",
    "+ + + + + + + + + + + + + + + +    part of this research was performed while the authors were visiting the institute for pure and applied mathematics ( ipam ) , which is supported by the national science foundation .",
    "the authors deeply appreciate the stimulating environment and facilities provided by ipam , which have facilitated the intensive and productive collaboration that have lead to this paper .",
    "some of the insights in our analysis were inspired by talks given by terry tao at ipam about his work @xcite .",
    "the authors would also like to thank kaloyan slavov , jzsef solymosi , and hong wang for several helpful discussions .",
    "in this section we prove theorem [ thm : main2 ] , except that the proof of the crucial proposition [ prop : keyprop ] is deferred to section [ sec : proofofkey ] , and the incidence bound that we use is established in section [ sec : incgeom ] .",
    "as noted above , the basic tools that we require for the analysis are given in the appendix , where they are stated , referenced , and in some cases also proved .",
    "let @xmath0 $ ] be as in the statement of the theorem , and let @xmath1 be finite sets .",
    "the quantity we wish to bound is @xmath100 the strategy of the proof is to transform the problem of bounding @xmath101 into an incidence problem for points and curves in @xmath99 .",
    "the latter problem can then be tackled using the machinery that we establish in section  [ sec : incgeom ] , _ provided _ that the resulting curves have well - behaved intersections , in a sense that we will make precise in definition [ def : boundedmult ] . a major component of the proof is to show that if the points and curves that we are about to define do not have well - behaved intersections in this sense , then @xmath102 must have the special form described in property @xmath18 of the theorem .",
    "define the set of quadruples @xmath103 we show , in lemma  [ lem : mtoq ] below , that @xmath101 can be bounded in terms of @xmath104 .",
    "the proof requires the following lemma , which says that a surface can contain only a bounded number of vertical lines , unless it is a cylindrical surface ( i.e. , it consists of all vertical lines through a curve @xmath105 in the @xmath106-plane ) .",
    "[ lem : excepa ] let @xmath107 $ ] be an irreducible polynomial of degree @xmath24 with @xmath108 not identically zero . then @xmath109    write @xmath110 with suitable polynomials @xmath111 . for @xmath112",
    "we have @xmath113 if and only if @xmath114 for all @xmath115 .",
    "observe that @xmath116 would contradict the irreducibility of @xmath117 , and @xmath118 would contradict @xmath108 not being identically zero .",
    "in addition , the polynomials @xmath119 can not have a common factor , since this would again contradict the irreducibility of @xmath117 .",
    "so there exists an index @xmath120 such that @xmath121 and @xmath122 do not have a common factor .",
    "therefore , by bzout s inequality ( theorem [ thm : bezout ] ) , we have @xmath123 .",
    "it follows that there are at most @xmath124 points @xmath125 such that @xmath113 .",
    "this proves the lemma .",
    "[ lem : mtoq ] we have @xmath126    define @xmath127 and consider the standard projection @xmath128 ( in which the first coordinate is discarded ) .",
    "we have @xmath129 . for each @xmath130",
    ", we write @xmath131 so that @xmath132 using the cauchy - schwarz inequality , we have @xmath133 . to prove this ,",
    "let @xmath134 a double application of lemma [ lem : excepa ] gives @xmath135 .",
    "observe that for @xmath136 we have @xmath137 , while for @xmath138 we have @xmath139 .",
    "thus @xmath140 which proves the claim and the lemma .    in what follows",
    ", we derive an upper bound on @xmath104 .",
    "it will turn out that , when we fail to obtain the bound we are after , @xmath3 must have the special form in property @xmath18 .",
    "[ [ primal - curves . ] ] primal curves .",
    "+ + + + + + + + + + + + + +    for every point @xmath141 , we define @xmath142 where @xmath143 stands for the _ zariski closure _ of @xmath144 ( see section [ sec : projclos ] ) .. since we work in affine space , the projection of an algebraic variety need not be a variety , and this is why we need to take the zariski closure in the definition of @xmath145 .",
    "we could instead have worked with constructible sets in affine space , or with projective varieties in projective space , and then the closure would not have been needed , but this does not seem to simplify the proof in any significant way . ]",
    "it is not always true that the set @xmath145 is a curve ; it can turn out to be zero - dimensional or two - dimensional .",
    "the following lemma quantifies the exceptional cases , allowing us to exclude them in what follows .",
    "[ lem : quantelim ] let @xmath23 $ ] be an irreducible polynomial of degree @xmath24 such that none of @xmath146 is identically zero . then there is a finite set @xmath147 with @xmath148 such that , for all @xmath149 , the set @xmath150 , as defined in , is an algebraic curve of degree at most @xmath124 , or the empty set .    define @xmath151 then @xmath152 by lemma [ lem : excepa ] .",
    "we will show that if @xmath150 is not an algebraic curve or an empty set , then @xmath153 .",
    "consider @xmath154 with the coordinates @xmath155 , and let @xmath156 be the projection @xmath157 .",
    "then @xmath158 , where @xmath159 and both @xmath160 , @xmath161 are considered as polynomials in @xmath162 .",
    "suppose that @xmath150 has a zero - dimensional component @xmath163 ( i.e. , an isolated point ) .",
    "every component of @xmath144 is at least one - dimensional , as follows from lemma [ lem : dimension ] in the appendix , so @xmath144 must contain the line @xmath164 , because that is the only one - dimensional variety that is mapped to @xmath163 by @xmath165 . thus @xmath166 and @xmath167 , which means that @xmath153 .",
    "now suppose that @xmath150 has a two - dimensional component ( i.e. , @xmath168 ) .",
    "then , by lemma [ lem : projectionpreserves ] , either @xmath144 has a two - dimensional component , or @xmath169 . the latter would imply that @xmath170 ( as a polynomial in @xmath171 ) , so @xmath172 would divide @xmath3 , contradicting the irreducibility of @xmath3 . if @xmath144 has a two - dimensional component , then @xmath160 and @xmath161 ( regarded as polynomials in @xmath162 ) have a common factor , and this factor must be a univariate polynomial in @xmath173 . in particular , they have a common factor of the form @xmath174 , so that @xmath175 and @xmath176 , which means that @xmath153 .",
    "put @xmath177 .",
    "we have shown that , when @xmath149 , @xmath144 and @xmath150 are both purely one - dimensional or both empty . in the former case , since @xmath144 is defined by two polynomials of degree at most @xmath24 , it has degree at most @xmath124 , by lemma [ lem : degreebound ] .",
    "since @xmath150 is the closure of the image of @xmath144 under a projection , it also has degree at most @xmath124 , by lemma [ lem : projectionpreserves ] .",
    "let @xmath147 be the set given by lemma  [ lem : quantelim ] for our @xmath3 .",
    "that is , @xmath148 and , for every @xmath178 , the set @xmath145 is an algebraic curve of degree at most @xmath124 , or the empty set ( a possibility we can safely ignore ) .",
    "[ [ dual - curves . ] ] dual curves .",
    "+ + + + + + + + + + + +    we define , in an analogous manner , a dual system of curves by switching the roles of the @xmath179- and @xmath180-coordinates , as follows . for every point @xmath181",
    ", we define @xmath182 as above , lemma [ lem : quantelim ] implies that there exists an exceptional set @xmath183 of size @xmath184 , such that for every @xmath185 the set @xmath186 is an algebraic curve of degree at most @xmath124 ( or empty ) .",
    "we would like to say that `` @xmath187 if and only if @xmath188 '' , but this is not quite true because of the closure operation . by a basic observation from algebraic geometry",
    "( see lemma  [ lem : projectionclosure ] ) , the closures in the definitions of @xmath145 and @xmath189 add only finitely many points to either curve .",
    "it follows that for all but finitely many points @xmath187 we have @xmath188 , and for all but finitely many @xmath188 we have @xmath187 .",
    "we will analyze what happens when many of these curves have a large common intersection .",
    "the following definition introduces terminology for this , which we will use throughout .",
    "[ def : popcurves ] we say that an irreducible algebraic curve @xmath190 is a _ popular curve _ if there exist at least @xmath191 distinct points @xmath192 such that @xmath193 .",
    "we denote by @xmath194 the set of all popular curves .",
    "+ similarly , we say that an irreducible algebraic curve @xmath195 is _ a popular dual curve _ if there exist at least @xmath191 distinct points @xmath196 such that @xmath197 .",
    "we denote by @xmath198 the set of all popular dual curves .",
    "the main step in our proof is the following key proposition , which shows that we can exclude the popular curves and popular dual curves .",
    "its proof is quite involved and takes up section [ sec : proofofkey ] .",
    "note that the statement is only about @xmath3 and does not involve the specific sets @xmath56 .",
    "[ prop : keyprop ] either @xmath3 satisfies property @xmath18 of theorem [ thm : main2 ] , or both of the following properties hold .",
    "+ @xmath199 there exists a one - dimensional variety @xmath200 of degree @xmath201 containing @xmath202 , such that for every @xmath203 , the curve @xmath145 does not contain a popular curve .",
    "+ @xmath204 there exists a one - dimensional variety @xmath205 of degree @xmath201 containing @xmath183 , such that for every @xmath206 , the dual curve @xmath186 does not contain a popular dual curve .",
    "we continue with the analysis , assuming the truth of proposition  [ prop : keyprop ] .",
    "we introduce the following set of points and _ multiset _ of curves ( some of the curves may coincide as point sets ) : @xmath207 by definition , for every @xmath208 , we have @xmath209 and @xmath210 ( albeit not necessarily vice versa , because the definition of the curves involves a closure , and does not require the qualifying point @xmath173 to be in @xmath211 ) .",
    "this lets us relate @xmath104 to @xmath212 , the number of incidences between these points and curves ; since @xmath213 is a multiset , these incidences are counted with the multiplicity of the relevant curves .",
    "[ lem : qtoincs ] we have @xmath214    any @xmath215 in @xmath216 that is not counted in @xmath212 must have @xmath217 or @xmath218 .",
    "we have @xmath219 and @xmath220 by the schwartz - zippel lemma ( lemma [ lem : schwartzzippel ] ) .",
    "to the purely one - dimensional component of @xmath221 , which actually has degree @xmath222 ( see lemma [ lem : x2 ] ) , and add the number of zero - dimensional components of @xmath221 , which is @xmath201 .",
    "the overestimate in the weaker argument given above does not affect the subsequent bounds .",
    "we do the same for @xmath223 . ] for any @xmath224 , we have @xmath225 , and for any @xmath226 we have @xmath227 , by the schwartz - zippel lemma again . thus the contribution from these excluded pairs",
    "is @xmath228 .    for @xmath229 , @xmath230 , the sets @xmath231 and @xmath232",
    "could in fact be all of @xmath99 , so we only have the trivial bounds @xmath233 and @xmath234 .",
    "fortunately , we have @xmath235 and @xmath236 , so the contribution from these pairs is only @xmath237 .",
    "we now define exactly in what sense we require the curves to have well - behaved intersections .",
    "[ def : boundedmult ] let @xmath238 be a finite set of distinct points in @xmath99 , and let @xmath213 be a finite multiset of curves in @xmath99 .",
    "we say that the system @xmath239 has _",
    "@xmath240-bounded multiplicity _ if + @xmath199 for any curve @xmath241 , there are at most @xmath242 curves @xmath243 such that there are more than @xmath244 points contained in both @xmath245 and @xmath246 ; and + @xmath204 for any point @xmath247 , there are at most @xmath242 points @xmath248 such that there are more than @xmath244 curves that contain both @xmath249 and @xmath250 .",
    "we claim that the system @xmath239 has @xmath251-bounded multiplicity . indeed , by proposition [ prop : keyprop](a ) and",
    "the fact that we have avoided @xmath221 when defining @xmath213 , any component of a curve @xmath252 is not a popular curve , and is thus shared with at most @xmath253 other curves .",
    "the curve @xmath245 has at most @xmath124 irreducible components ( see lemma [ lem : degreebound ] ) , so there are at most @xmath254 curves @xmath243 such that @xmath245 and @xmath246 have a common component .",
    "curves @xmath246 that do not have a common component with @xmath245 intersect it in at most @xmath253 points by bzout s inequality ( theorem [ thm : bezout ] ) ; thus condition ( a ) in the definition of @xmath251-bounded multiplicity is satisfied .",
    "the argument for condition ( b ) is fully symmetric .    in section  [ sec : incgeom ]",
    "we derive an incidence bound , theorem  [ cor : multcor ] , resembling the classical szemerdi - trotter point - line incidence bound @xcite .",
    "it applies to a set @xmath238 of points and a multiset @xmath213 of curves in @xmath99 of degree at most @xmath255 , under the conditions that @xmath239 has @xmath240-bounded multiplicity and that @xmath238 is a subset of a cartesian product .",
    "the theorem asserts that @xmath256 applying this bound with @xmath257 and @xmath258 , and with @xmath259 , @xmath260 , and @xmath261 , we get @xmath262 which , together with lemma [ lem : qtoincs ] , gives @xmath263 then , from lemma [ lem : mtoq ] , we get @xmath264 which gives the first of the three bounds in theorem [ thm : main2]@xmath28 ( with some overestimate , or rather `` rounding up '' , in the exponents of @xmath24 in the third and fourth terms ) .",
    "the other two follow by symmetric arguments .",
    "this completes the proof of theorem [ thm : main2 ] .    to deduce theorem [ thm : main1 ] from theorem [ thm : main2 ]",
    ", we set @xmath30 and observe that for @xmath265 the first term of dominates , which gives the bound @xmath266 in property @xmath28 of theorem [ thm : main1 ] . on the other hand , when @xmath267 , then the bound @xmath266 is implied by the schwartz - zippel lemma ( lemma [ lem : schwartzzippel ] ) , which gives the upper bound @xmath268 .",
    "we adapt an idea used by tao @xcite to study the expansion of a polynomial @xmath269 over finite fields . as part of his analysis he considered the map @xmath270 defined by @xmath271 where @xmath72 is a polynomial in @xmath272 $ ] .",
    "tao showed that if the image @xmath273 is four - dimensional , then lower bounds on the expansion of @xmath72 can be derived . on the other hand ,",
    "if the image has dimension at most 3 , then @xmath72 must have one of the special forms @xmath274 or @xmath275 ( as in @xcite ) , for suitable polynomials @xmath276 .",
    "tao proved this by observing that in this case the determinant of the jacobian matrix of @xmath277 must vanish identically , leading to an identity for the partial derivatives of @xmath72 , from which the special forms of @xmath72 can be deduced .",
    "following tao s general scheme , albeit in a different context , we define a variety @xmath278 note that if @xmath279 , then @xmath280 is the _ graph _ of the map @xmath277 above . also observe that if we fix @xmath281 in @xmath280 and eliminate @xmath282 , the range of the last four coordinates of @xmath280 is @xmath283 ( up to the closure operation ) . for a general polynomial @xmath3 , near most points @xmath284",
    ", we use the implicit function theorem to represent @xmath280 as the graph of a locally defined analytic function @xmath285 this function serves as a local analogue of the map @xmath277 above . if the determinant of the jacobian matrix of @xmath286 vanishes on @xmath280 in some neighborhood of @xmath287 , then we obtain the special form of @xmath3 .",
    "this derivation is similar to that of tao , although our special form requires a somewhat different treatment .",
    "the other side of our argument , when the determinant of the jacobian is not identically zero , is very different from that of tao .",
    "( we will gloss over many details in the rest of this outline . )",
    "we want to show that there are only finitely many popular curves .",
    "we show that if @xmath245 is a popular curve ( i.e. , there are more than @xmath253 curves @xmath288 that contain @xmath245 ) , then it is _ infinitely _ popular , in the sense that there is a one - dimensional curve @xmath289 of pairs @xmath141 for which @xmath145 contains @xmath245 . for @xmath280",
    ", this implies that if we restrict @xmath290 to @xmath289 and project to the last four coordinates , then the image is contained in @xmath291 . in other words , the local map @xmath286 sends an open subset of the three - dimensional variety @xmath292 to an open subset of the two - dimensional variety @xmath291 .",
    "the inverse mapping theorem now tells us that the determinant of the jacobian of @xmath286 vanishes on the three - dimensional variety @xmath292 .",
    "given that by assumption this determinant is not identically zero , its zero set is three - dimensional , so @xmath292 must be one of its @xmath293 irreducible components .",
    "it follows that there are only @xmath293 popular dual curves , which in turn implies , with some additional reasoning , that there are only @xmath293 popular curves .",
    "this , together with the first part of the argument , essentially establishes proposition  [ prop : keyprop ] .      throughout section  [ sec : proofofkey ]",
    "we write @xmath294 and @xmath295 for the standard projections onto the first and the last four coordinates , respectively .",
    "we define ( as already mentioned above ) the variety @xmath296 we first prove that @xmath280 has the dimension that one expects from a variety defined by four equations in @xmath297 .",
    "[ lem : vdim4 ] the variety @xmath280 has dimension @xmath298 .",
    "the variety @xmath280 is not empty , since it contains the point @xmath299 for any point @xmath300 .",
    "thus , by lemma [ lem : dimension ] , @xmath280 has dimension at least 4 .    with a suitable permutation of the coordinates ,",
    "we can write the set @xmath280 as a disjoint union @xmath301 where @xmath302 note that , if we project @xmath303 to the last two coordinates and take the closure , we get the set @xmath145 . in the proof of lemma [ lem : quantelim ]",
    ", we saw that @xmath303 is one - dimensional for all but @xmath184 points @xmath141 .",
    "it follows that , excluding finitely many @xmath290 , the union in is four - dimensional .",
    "consider one of the excluded points @xmath304 .",
    "if @xmath305 were identically zero as a polynomial in @xmath171 , then @xmath306 would have a factor @xmath307 , contradicting the irreducibility of @xmath3 .",
    "thus @xmath305 is not identically zero , which implies that @xmath308 is at most two - dimensional .",
    "hence each of the finitely many excluded sets @xmath309 is at most four - dimensional .",
    "this finishes the proof .",
    "our analysis also requires that the projection @xmath310 of @xmath280 to the first four coordinates be four - dimensional .",
    "this fact , which does not follow directly from @xmath280 being four - dimensional , is established in lemma  [ lem : piv=4 ] below .",
    "the proof requires the following technical lemma .",
    "( the lemma and its proof should be compared to lemma  [ lem : excepa ] . )",
    "[ lem : excepb ] let @xmath107 $ ] be an irreducible polynomial of degree @xmath24 with @xmath108 not identically zero . then @xmath311    the case @xmath312 is easy , so we may assume that @xmath313 .",
    "write @xmath110 with suitable polynomials @xmath111 .",
    "observe that there exists some @xmath120 such that @xmath122 is not identically zero , for otherwise @xmath108 would be identically zero , contrary to assumption . if @xmath314 for some @xmath315 , then @xmath316 for @xmath317 , and in particular @xmath318 .",
    "hence the variety in the statement of the lemma is contained in @xmath319 , which implies that it has dimension at most @xmath320 .",
    "[ lem : piv=4 ] we have @xmath321 .",
    ". there exist @xmath323 such that @xmath324 unless @xmath325 for some nonzero @xmath326 , or a similar identity holds for one of the other pairs @xmath327 , @xmath328 , @xmath329 .",
    "in other words , we have @xmath330 unless one of these exceptions holds .",
    "let @xmath331 ( note that here we include the case @xmath332 ) . by lemma  [ lem : excepb ] we have @xmath333 ,",
    "so the set @xmath334 has dimension at most @xmath335 .",
    "it follows that @xmath336 ( see lemma  [ lem : dense ] ) .",
    "as observed above , we have @xmath337 , so we conclude that @xmath321 .",
    "we will use the implicit function theorem ( spelled out in lemma  [ lem : ift2 ] ) to locally express each of the variables @xmath338 in terms of the corresponding pair of the first four variables @xmath339 . to facilitate this",
    "we first exclude the subvariety of @xmath280 defined by @xmath340 where @xmath341 and @xmath342 stands for the derivative of @xmath3 with respect to its @xmath115th variable , for @xmath36 . ; we exclude @xmath343 and @xmath344 for technical reasons that arise in the proofs of lemmas [ lem : vgcont ] and [ lem : special ] below . ]",
    "let @xmath345 be the ( permuted ) projection @xmath346 we now show that @xmath347 is at most three - dimensional , from which it follows that @xmath348 is also at most three - dimensional , which will allow us to exclude it in most of our analysis .",
    "[ lem : vzero ] the variety @xmath347 has dimension at most 3 .",
    "it suffices to show that , for @xmath349 @xmath350 is at most three - dimensional , for each @xmath36 ; the other nine cases can be treated symmetrically .",
    "so let @xmath115 be fixed .",
    "then @xmath351 is the common zero set of the five polynomials @xmath352 the polynomial @xmath353 is assumed to be irreducible , and @xmath354 has lower degree and is not identically zero by assumption .",
    "it follows that @xmath353 and @xmath354 are coprime polynomials , so the equations @xmath355 define a one - dimensional variety in @xmath356 ( with coordinates @xmath357 ) .",
    "clearly , @xmath358 defines a two - dimensional variety in a complementary copy of @xmath356 ( with coordinates @xmath359 ) .",
    "thus @xmath360 viewed as a variety in @xmath361 , with coordinates @xmath362 , is three - dimensional . since @xmath363 , and",
    "since the closure operation does not increase the dimension ( lemma [ lem : projectionpreserves ] ) , the lemma follows .    as explained in the overview in section  [ sec : overview ] , we want to view @xmath280 , around most of its points , as the graph of a locally defined mapping .",
    "we now define this mapping .",
    "[ lem : locallygraph ] for each point @xmath364 , there is an open neighborhood @xmath365 of @xmath287 , disjoint from @xmath366 , and an analytic mapping @xmath367 such that @xmath368    let @xmath369 be an arbitrary point .",
    "we apply the implicit function theorem in @xmath356 ( lemma [ lem : ift2 ] ) to the equation @xmath370 at the point @xmath371 .",
    "since @xmath372 , we have @xmath373 .",
    "we thus obtain neighborhoods @xmath374 of @xmath375 in @xmath99 and @xmath376 of @xmath377 in @xmath70 , and an analytic mapping @xmath378 such that @xmath379    we can do the same at each of the points @xmath380 , leading to analogous mappings @xmath381 .",
    "it follows that we can find neighborhoods @xmath382 of @xmath83 , @xmath383 of @xmath384 , @xmath385 of @xmath84 , and @xmath386 of @xmath387 , and @xmath388 , @xmath389 , @xmath390 , @xmath391 of @xmath377 , @xmath392 , @xmath393 @xmath394 , respectively , such that @xmath395 defines an analytic map from @xmath396 to @xmath397 .",
    "then @xmath398 is a neighborhood of @xmath287 in @xmath297 satisfying the conclusion of the lemma .",
    "if needed , we can shrink it to be disjoint from @xmath366 .",
    "let @xmath399 be the polynomial in @xmath400 $ ] given by @xmath401 consider the subvariety @xmath402 of @xmath280 .",
    "the significance of @xmath403 ( and of @xmath399 ) lies in the following lemma ; it says that @xmath403 is the subvariety of points @xmath284 such that the determinant of the jacobian of the local map @xmath286 vanishes at @xmath287 .",
    "see section [ sec : analysis ] for the definition of the jacobian matrix @xmath404 of a map @xmath405 .",
    "[ lem : locallysingular ] for @xmath364 we have @xmath406 if and only if @xmath407 .",
    "we write @xmath408 for the derivative of the function @xmath409 ( from the proof of lemma [ lem : locallygraph ] ) with respect to its @xmath410th variable , for @xmath411 and @xmath412 .",
    "the jacobian matrix of @xmath286 , evaluated at @xmath413 , where @xmath414 is the neighborhood of @xmath287 given in lemma [ lem : locallygraph ] , equals @xmath415 or , by implicit differentiation , @xmath416 for @xmath417 , @xmath418 , @xmath419 , and @xmath420 . since @xmath421 ,",
    "all the denominators are non - zero ( and , for that matter , so are all the numerators ) .",
    "write @xmath422 and observe that , by construction , @xmath423 , @xmath424 , @xmath425 , and @xmath426 .",
    "computing the determinant explicitly at the point @xmath427 and clearing denominators gives exactly @xmath428 , where @xmath399 is the polynomial defining @xmath403 .",
    "thus , @xmath429 if and only if @xmath430 .",
    "we now make precise what it means for a popular curve to be infinitely popular .",
    "let @xmath190 be a popular curve .",
    "an irreducible curve @xmath431 is an _ associated curve _ of @xmath245 if for all but finitely many @xmath432 we have @xmath433 .",
    "the notation is meant to suggest that an associated curve @xmath289 resembles a dual curve ; however , like a popular curve @xmath245 , an associated curve may be a component of a dual curve , so strictly speaking the notions are separate .    throughout this section ,",
    "we let @xmath245 be a popular curve and @xmath289 an associated curve of @xmath245 . in section  [ sec : associatedcurves ] , we will show that every popular curve has at least one associated curve . as described in section [ sec : overview ] , we wish to show that if @xmath245 is a popular curve and @xmath289 is an associated curve , then locally @xmath286 maps the three - dimensional set @xmath292 into the two - dimensional set @xmath434 .",
    "we will do this by showing that the intersection of @xmath280 and @xmath435 is contained in @xmath403 .    with each @xmath436 and associated curve @xmath289 , we associate the variety @xmath437 note that @xmath438 also depends on the choice of @xmath289 ( which is not necessarily unique ) , but we have suppressed this in the notation , sticking in what follows to some fixed @xmath289 .",
    "[ lem : vgcont ] for all @xmath436 we have @xmath439 ( for any choice of @xmath289 ) .",
    "let @xmath440 , @xmath441 denote the subsets of regular points of @xmath289 , @xmath245 , respectively , and define @xmath442 it is sufficient to show that @xmath443 .",
    "indeed , since @xmath403 and @xmath366 are varieties , it follows that the closure of @xmath444 is contained in @xmath445 .",
    "this closure equals @xmath438 , since the removed points form a lower - dimensional subset .",
    "let @xmath446 and assume , for contradiction , that @xmath447 .",
    "lemma [ lem : locallygraph ] gives an open neighborhood @xmath414 of @xmath287 , disjoint from @xmath366 , so that @xmath448 is the graph of an analytic map @xmath449 , where @xmath450 and @xmath451 .",
    "by lemma [ lem : locallysingular ] , @xmath452 . by the inverse mapping theorem ( lemma [ lem : imt ] ) ,",
    "@xmath286 is bianalytic on a sufficiently small neighborhood of @xmath453 , which , by shrinking @xmath414 if needed , we may assume to be @xmath454 .",
    "consider the mapping @xmath455 restricted to @xmath448 .",
    "note that @xmath456 is bianalytic .",
    "indeed , @xmath457 restricted to @xmath448 is clearly bianalytic ( its inverse is @xmath458 ) , so @xmath456 is the composition of two bianalytic functions , hence itself bianalytic . by definition of @xmath438",
    "we have @xmath459 write @xmath422 , and note that , by definition of @xmath460 , @xmath461 are regular points of @xmath245 and @xmath462 is a regular point of @xmath289 .",
    "we claim that there exists an open set @xmath463 such that @xmath464 is locally three - dimensional .",
    "indeed , we may assume , without loss of generality , that none of the tangents to @xmath245 at @xmath465 , @xmath466 , and to @xmath289 at @xmath462 are vertical in the respective planes ( otherwise , we simply switch the roles of the first and the second coordinate in the relevant copy of @xmath99 ) . applying the implicit function theorem ( lemma [ lem : ift1 ] ) to @xmath245 and @xmath289 at these regular points , we may therefore write @xmath467 , @xmath468 , and @xmath469 in sufficiently small neighborhoods of @xmath465 , @xmath466 , @xmath462 along the respective curves , for suitable analytic functions @xmath470 .",
    "similarly , applying the implicit function theorem to @xmath102 in sufficiently small neighborhoods of @xmath371 , @xmath471 ( which we may , since we are away from @xmath366 ) , we may write @xmath472 , @xmath473 , for analytic functions @xmath474 . combining the functions above , we obtain an open neighborhood @xmath475 of @xmath287 such that the map @xmath476 is bianalytic from an open neighborhood of @xmath477 to @xmath464 .",
    "this implies that @xmath464 is locally three - dimensional .",
    "since @xmath291 has local dimension @xmath478 at every pair of regular points , and @xmath456 preserves local dimension , since it is bianalytic , this yields a contradiction , which completes the proof of the lemma .",
    "next we show that the projection of @xmath438 to the first four coordinates is three - dimensional .",
    "[ lem : projvg ] let @xmath436 and assume that @xmath245 is not an axis - parallel line .",
    "then @xmath479    we clearly have @xmath480 so , since @xmath292 is a variety , we get @xmath481    by definition ( and lemma  [ lem : quantelim ] ) , there is a finite subset @xmath482 such that , for all @xmath483 , @xmath231 is a curve and @xmath484 .",
    "it follows from the definitions of @xmath438 and @xmath280 that @xmath485 where @xmath486    we claim that @xmath487 .",
    "for this , it is sufficient to show that @xmath488 is infinite .",
    "assume to the contrary that it is finite .",
    "in this case @xmath245 is contained in the closure of the finite union @xmath489 since @xmath245 is infinite , one of the sets in the union must be infinite",
    ". then @xmath245 must be a line parallel to one of the axes in @xmath99 , contradicting the assumption of the lemma .",
    "hence @xmath490 using that the closure of an infinite union _ contains _ the union of the closures , and that the closure of a product is the product of the closures .",
    "together with this gives @xmath491 completing the proof of the lemma .",
    "in this section we show that if a curve @xmath245 is popular , then it must be _ infinitely _ popular .",
    "first we need the following sharpened form of bzout s inequality for many curves .",
    "our proof is adapted from tao @xcite .",
    "see appendix [ sec : degree ] for the definition of degree .",
    "note that for a reducible variety , its degree is the sum of the degrees of its irreducible components ; in particular , if a one - dimensional variety contains zero - dimensional components ( isolated points ) , then the degree is the sum of the degrees of the purely one - dimensional irreducible components , plus the number of zero - dimensional components .",
    "[ lem : bezoutmany ] if @xmath492 is a ( possibly infinite ) family of algebraic curves in @xmath99 , each of degree at most @xmath255 , then @xmath493 in other words , either @xmath494 is zero - dimensional and has cardinality at most @xmath495 , or it has dimension 1 and degree at most @xmath495 .",
    "the variety @xmath496 has dimension either @xmath497 or @xmath320 . if @xmath144 is zero - dimensional , then it is a finite set of points . by the noetherian property",
    "( see harris  @xcite ) , there is a finite subset of curves @xmath498 such that @xmath499 .",
    "we must have @xmath500 .",
    "each irreducible component of @xmath501 either has finite intersection with @xmath502 , or it is also a component of @xmath502 .",
    "thus we can write @xmath503 , with curves ( or empty sets ) @xmath504 and @xmath505 , such that @xmath506 is finite and @xmath505 is the union of some irreducible components of @xmath502 . for @xmath507 , we inductively partition @xmath508 , which is a subset of @xmath509 , as @xmath510 ,",
    "such that @xmath511 is finite and @xmath512 is the union of some irreducible components of @xmath513",
    ". then @xmath514 must be empty ( or else @xmath144 would be one - dimensional ) , so @xmath515 and @xmath516 , since each @xmath517 is contained in @xmath501 , so in some @xmath518 , and also in @xmath513 .",
    "therefore , @xmath144 is finite and , using the standard bezout s inequality ( theorem [ thm : bezout ] ) , @xmath519 here we have @xmath520 because the @xmath518 are distinct subcurves of @xmath501 .",
    "now suppose that @xmath144 is one - dimensional .",
    "let @xmath521 be the maximal purely one - dimensional subvariety , and let @xmath522 the remainder , which must be zero - dimensional .",
    "set @xmath523 ; since @xmath521 is a subset of any curve of @xmath524 , we have @xmath525 .",
    "remove @xmath521 from every curve in @xmath524 , take the closure of each curve again , and let @xmath526 be the set of the resulting curves , each of which has degree at most @xmath527 . by the choice of @xmath521 , we have that @xmath528 is zero - dimensional . by applying the argument above to @xmath526",
    ", we get that @xmath529 , and thus @xmath530 .",
    "recall that @xmath531 is the set of popular curves , i.e. , irreducible curves @xmath245 that are contained in @xmath145 for more than @xmath253 points @xmath532 ( where @xmath533 is the set constructed in section  [ sec : proofofmain ] ) .",
    "lemma  [ lem : associated ] shows that if @xmath245 is popular , then there is a one - dimensional set of curves @xmath145 that contain @xmath245 .",
    "[ lem : associated ] every @xmath534 has at least one associated curve .",
    "more precisely , for every @xmath436 there exists an irreducible algebraic curve @xmath195 of degree at most @xmath124 such that for all but finitely many @xmath432 we have @xmath433 .    by definition of @xmath531 , if @xmath535 , then there exists a set @xmath536 of size @xmath537 such that @xmath433 for all @xmath538 .",
    "this means that for all @xmath538 and for all but finitely many @xmath539 , there is an @xmath540 such that @xmath541 , which implies that @xmath542 .",
    "thus we have @xmath543 for all but finitely many @xmath539 .",
    "let @xmath524 be the infinite family of curves @xmath189 with @xmath539 and @xmath543 , and define @xmath544 then we have @xmath545 .",
    "since all the curves in @xmath524 have degree at most @xmath124 , lemma [ lem : bezoutmany ] implies that @xmath546 has degree at most @xmath253 . since @xmath547 , @xmath546 must have dimension 1 .",
    "let @xmath289 be any irreducible one - dimensional component of @xmath546 .",
    "if @xmath432 , then for all but finitely many @xmath539 we have @xmath542 .",
    "it follows that for all but finitely many @xmath432 , and for all but finitely many @xmath539 ( where the excluded points @xmath548 depend on the choice of @xmath290 ) , we have @xmath549 .",
    "since both @xmath245 and @xmath145 are algebraic curves , and @xmath245 is irreducible , it follows that @xmath433 for all but finitely many @xmath432 .",
    "this means that @xmath289 is an associated curve of @xmath245 .    in the next two sections we separate our analysis into two cases ,",
    "according to the dimension of @xmath550 .      throughout this subsection",
    "we assume that @xmath551 . in this case",
    "we establish the existence of the set @xmath221 in proposition  [ prop : keyprop](a ) ( and similarly the set @xmath223 in proposition  [ prop : keyprop](b ) ) .",
    "as the statement of lemma [ lem : projvg ] suggests , popular curves that are axis - parallel lines require a different treatment , provided by the following simple lemma .",
    "[ lem : axisparallel ] there is a one - dimensional variety @xmath552 with @xmath553 , containing @xmath202 , such that for every @xmath554 the curve @xmath150 contains no axis - parallel line .    as in the proof of lemma [ lem : quantelim ] , define @xmath555 assume that @xmath149 , and suppose that the curve @xmath150 ( where we equip the plane in which it is defined with coordinates @xmath180 , @xmath556 ) contains a horizontal line @xmath557 .",
    "then for each @xmath558 there is an @xmath559 such that @xmath560 and @xmath561 . if @xmath562 is identically zero as a polynomial in @xmath173 , then @xmath563 . if @xmath562 is not identically zero , there are only finitely many @xmath559 such that @xmath564 . since we assumed that @xmath149 , @xmath150 is one - dimensional , hence infinite , and thus for at least one @xmath559 satisfying @xmath564 there must be infinitely many @xmath565 such that @xmath566 .",
    "this implies that @xmath175 ( as a polynomial in @xmath180 ) , and thus @xmath567 . by symmetry ,",
    "if @xmath150 contains a vertical line , then in this case too we have either @xmath567 or @xmath563 .",
    "thus , if we set @xmath568 then @xmath150 does not contain a horizontal or vertical line when @xmath569 . by construction , @xmath570 , because @xmath571 , and we also have @xmath572 .",
    "we also need the following observation .",
    "[ lem : associatedmult ] an irreducible curve @xmath289 is associated to at most @xmath124 curves @xmath573 .",
    "suppose there is a set @xmath574 of @xmath575 distinct curves @xmath573 that @xmath289 is associated to .",
    "for each @xmath576 , we have that , for all but finitely many @xmath432 , @xmath245 is contained in @xmath145 .",
    "it follows that there is a point @xmath432 such that @xmath433 for all @xmath576 .",
    "this is a contradiction , because @xmath145 has at most @xmath124 irreducible components by lemma [ lem : degreebound ] .",
    "we are now ready to prove the key fact that the number of popular curves is bounded .",
    "[ lem : fewpopular ] there are at most @xmath222 distinct popular curves @xmath534 that are not axis - parallel lines .",
    "let @xmath436 , assume that it is not an axis - parallel line , and let @xmath289 be an associated curve of @xmath245 . since @xmath289 is irreducible , @xmath577 is an irreducible variety . using lemma [ lem : projvg ] and lemma [ lem : vgcont ]",
    ", we have @xmath578 for @xmath579 and @xmath580 .",
    "we have @xmath581 by the assumption in this subsection , and @xmath582 by lemma [ lem : vzero ] .",
    "we also have @xmath583 and @xmath584 by lemma [ lem : degreebound ] and lemma [ lem : projectionpreserves ] from the appendix , since both are closures of projections of varieties defined by five polynomials , each of degree at most , except for @xmath399 , which is of degree @xmath585 . ] @xmath586 .",
    "since @xmath587 is at most three - dimensional , and each @xmath577 is an irreducible three - dimensional subvariety of @xmath587 , it follows that @xmath292 is one of the finitely many irreducible components of @xmath587 .",
    "let @xmath588 be the set of all associated curves of all curves @xmath534 ( excluding those @xmath245 that are axis - parallel lines ) .",
    "the preceding argument shows that @xmath588 is a finite set .",
    "moreover , we have @xmath589 this implies that the total number of distinct associated curves is @xmath590 .",
    "since by lemma [ lem : associated ] each popular curve has at least one associated curve , and by lemma [ lem : associatedmult ] each associated curve is associated to at most @xmath124 popular curves , it follows that the number of popular curves is bounded by @xmath222 .",
    "finally , we show that the union of all the associated curves ( which are not axis - parallel lines ) has bounded degree .",
    "[ lem : x2 ] let @xmath591 then @xmath592 is one - dimensional ; its purely one - dimensional portion has degree @xmath222 , and the number of zero - dimensional components is @xmath201 .    by construction , any one - dimensional irreducible component of @xmath592 is an associated curve . in the proof of lemma [ lem",
    ": fewpopular ] it was shown that there are at most @xmath590 associated curves . since each associated curve has degree @xmath593 , the purely one - dimensional portion of @xmath592 has degree @xmath222 .",
    "we next bound the number of zero - dimensional components of @xmath592 , which we refer to as _ associated points _ ; such a point can not have been added by the closure , so it must be associated to some popular curve . by lemma [ lem : fewpopular ] ,",
    "the number of popular curves @xmath534 is @xmath222 .",
    "we show that each of these has at most @xmath253 associated points .",
    "let @xmath535 and suppose that @xmath245 has @xmath191 associated points that do not lie on associated curves .",
    "that is , these points form a set @xmath536 of size @xmath537 , such that @xmath433 for all @xmath538 .",
    "exactly as in the proof of lemma [ lem : associated ] , there is a curve @xmath546 , which is the intersection of an infinite family of curves @xmath189 containing @xmath66 .",
    "thus we have @xmath545 .",
    "as shown in that proof , each one - dimensional irreducible component of @xmath546 is an associated curve , so does not cover any point of @xmath66 . by lemma [ lem : bezoutmany ] , @xmath546 has degree at most @xmath253 , and therefore contains at most @xmath253 isolated points .",
    "this contradicts the fact that @xmath547 .",
    "we put @xmath594 . combining lemma [ lem : axisparallel ] and lemma [ lem : x2 ] , we get @xmath595 and @xmath596 . from the definitions of @xmath597 and @xmath592",
    "it is clear that for @xmath598 , the curve @xmath145 does not contain any popular curve .",
    "this completes the proof of proposition [ prop : keyprop](a ) in case 1 .",
    "proposition [ prop : keyprop](b ) is proved in a fully symmetric manner .      throughout this subsection",
    "we assume that @xmath599 . since @xmath403 is a subvariety of @xmath280 , which is four - dimensional by lemma [ lem : vdim4 ] , @xmath403",
    "must also be four - dimensional .",
    "this implies that there exists an irreducible component @xmath600 of @xmath403 ( and of @xmath280 ) such that @xmath601 and @xmath602 .",
    "we will work only with @xmath600 in the rest of this subsection .",
    "we first show that most points of @xmath102 , excluding only a lower - dimensional subset , can be extended to points of @xmath600 , in the following sense .",
    "[ lem : extend ] there exists a one - dimensional subvariety @xmath32 such that , for every @xmath603 , there exist @xmath604 such that @xmath605 is a regular point of @xmath600 which is not in @xmath366 .",
    "recall the definition of the ( permuted ) projection @xmath345 @xmath606 we claim that @xmath607 .",
    "since @xmath608 is four - dimensional and irreducible , and since , by definition of @xmath280 , @xmath609 , it suffices to prove that @xmath610 is ( at least ) four - dimensional .",
    "we observe that @xmath611 , where @xmath612 since the projection @xmath613 does not increase the dimension ( see lemma [ lem : projectionpreserves ] ) , we have @xmath614 proving our claim .",
    "using lemma  [ lem : projectionclosure ] , it follows that @xmath615 is at most three - dimensional , and , in view of lemma  [ lem : vzero ] , @xmath616 is also at most three - dimensional .",
    "since @xmath600 has dimension @xmath298 , the subvariety @xmath617 of singular points of @xmath600 is at most three - dimensional , so @xmath618 is also at most three - dimensional .",
    "hence , @xmath619 is a variety in @xmath620 of dimension at most 3 .",
    "we set @xmath621 in other words ( using the fact that @xmath622 is irreducible and two - dimensional ) , @xmath623 if and only if @xmath624 , so @xmath625 .",
    "since @xmath626 is a variety , we have @xmath627 set @xmath628 .",
    "since @xmath626 is at most three - dimensional and @xmath102 is two - dimensional , we must have @xmath629 .",
    "finally , let @xmath603 . by definition of @xmath630",
    ", we have @xmath631 thus there exists a point @xmath632 such that @xmath633 . by definition of @xmath626",
    ", this implies that @xmath634 , which in turn means that there exist @xmath635 such that @xmath636 , and is a regular point of @xmath600 , as asserted .",
    "let @xmath630 be the variety given by lemma  [ lem : extend ] .",
    "[ lem : special ] let @xmath637 .",
    "then there exist open sets @xmath638 and analytic functions @xmath639 with analytic inverses , for @xmath36 , such that @xmath640 and @xmath641 for every @xmath38 .    by applying lemma [ lem :",
    "extend ] to @xmath642 , we obtain @xmath643 , such that the point @xmath644 belongs to @xmath645 and is regular in @xmath600 . by lemma [",
    "lem : locallygraph ] , there exist neighborhoods @xmath74 of @xmath83 , @xmath646 of @xmath384 , @xmath647 of @xmath84 , and @xmath648 of @xmath387 , and a mapping @xmath649 analytic on @xmath650 , such that its graph is the intersection @xmath448 for some open neighborhood @xmath414 of @xmath287 in @xmath297 . shrinking the sets @xmath74 , @xmath646 , @xmath647 , @xmath648",
    "as needed , the image of @xmath414 under the projection @xmath457 can be assumed to be @xmath650 .",
    "note that , since @xmath287 is a regular point of @xmath600 , @xmath651 is necessarily four - dimensional , so it must coincide with @xmath448 , if we take @xmath414 to be sufficiently small .",
    "thus , restricting the analysis to the neighborhood @xmath414 , we may use @xmath280 and @xmath600 interchangeably in what follows .",
    "since @xmath652 , we have ( recall that @xmath653 ) @xmath654 for every @xmath655 . by the implicit function theorem ( lemma [ lem : ift2 ] ) , the functions @xmath656 satisfy , in a suitable neighborhood of @xmath287 , @xmath657 for @xmath658 and @xmath412 . by the definition of @xmath399 ,",
    "this is easily seen to imply that @xmath659 for every @xmath660 .",
    "in particular , fixing @xmath661 and @xmath662 , there exists an open neighborhood @xmath663 of @xmath664 , such that @xmath665 for every @xmath666 .    because @xmath372 , we have @xmath667 similarly , @xmath668 , @xmath669 , @xmath670 , @xmath671 , @xmath672 , @xmath673 , and @xmath674 are all nonzero .",
    "the continuity of all the relevant functions implies that , by shrinking @xmath663 if needed , we may assume that , for all @xmath666 , neither side of is zero .",
    "thus we can rewrite as @xmath675 where @xmath676 are analytic and nonzero on @xmath74 and @xmath647 , respectively . by lang ( * ? ? ?",
    "* theorem iii.6.1 ) , there exist analytic primitives @xmath677 so that @xmath678 on @xmath74 and @xmath679 on @xmath647 . since , by construction , @xmath680 are nonzero , and using the inverse mapping theorem , each of @xmath677 has an analytic inverse on its domain , possibly after shrinking @xmath74 and @xmath647 further .",
    "we express the function @xmath681 in terms of new coordinates @xmath682 , given by @xmath683 since @xmath684 , @xmath685 are injections in suitable respective neighborhoods of @xmath83 , @xmath84 , we may assume that the system ( [ sys ] ) is invertible in @xmath663 .",
    "returning to the standard notation , denoting partial derivatives by variable subscripts , we have @xmath686 using the chain rule , we obtain @xmath687 @xmath688 which gives @xmath689 on @xmath663 .",
    "combining this with ( [ ratio1 ] ) , we get @xmath690 this means that @xmath691 depends only on the variable @xmath692 , so it has the form @xmath693 for a suitable analytic function @xmath694 .",
    "the analyticity of @xmath694 is an easy consequence of the analyticity of @xmath695 , and @xmath691 , and the fact that @xmath696 and @xmath697 are nonzero , combined with repeated applications of the chain rule .",
    "let @xmath698 we observe that @xmath699 as argued above , we have @xmath700 for all @xmath666 , implying that @xmath701 is nonzero for @xmath666 .",
    "therefore , by the inverse mapping theorem ( lemma [ lem : imt ] ) , @xmath702 is invertible , possibly after shrinking @xmath703 and @xmath588 .",
    "letting @xmath704 , we get , for @xmath705 , that @xmath706 if and only if @xmath707 .",
    "this completes the proof of the lemma .",
    "finally , lemma [ lem : special ] has established that @xmath3 satisfies property @xmath18 of theorem [ thm : main1 ] , which completes the proof of proposition [ prop : keyprop ] .",
    "for any finite set @xmath708 of distinct points and a finite set @xmath213 of curves in @xmath99 , define @xmath709 to be the number of _ incidences _ between the points and the curves .",
    "if @xmath213 is a multiset , we count each incidence @xmath710 with the multiplicity of @xmath245 .",
    "a key tool in our proof is the following incidence bound , recently proved by solymosi and de zeeuw @xcite .",
    "[ thm : incprod ] let @xmath711 be finite and let @xmath712 .",
    "let @xmath213 be a finite set of algebraic curves of degree at most @xmath255 in @xmath99 , without common components , such that any pair of points of @xmath713 are both contained in at most @xmath244 curves of @xmath213 .",
    "then @xmath714    theorem [ thm : incprod ] is a special instance of the szemerdi ",
    "trotter bound ( originally proved for points and lines in the real plane in @xcite ) for complex `` pseudo - lines with bounded multiplicity '' , under the strong assumption that the point set is ( a subset of ) a cartesian product . this assumption leads to a relatively simple proof , which also allows the dependence of @xmath715 on the parameters @xmath716 to be determined in the fairly sharp explicit form that we stated above . for an arbitrary point",
    "set , the bound has been proved for complex lines by tth @xcite and by zahl @xcite , while for complex curves it was obtained by solymosi and tao @xcite and by zahl @xcite , but only with an extra factor of the form @xmath717 , under additional and fairly strong conditions , and without explicit dependence on the parameters @xmath255 , @xmath244 .",
    "recently , sheffer and zahl @xcite removed these conditions , but not the extra factor @xmath717 .",
    "the reason for stating theorem [ thm : incprod ] in terms of a subset @xmath718 is that this is the type of set we get in the proof of theorem  [ thm : main2 ] .",
    "one can not simply replace @xmath713 by @xmath238 , because the condition concerning the number of curves passing through a pair of points depends on the specific choice of @xmath713 .",
    "fortunately , the result in @xcite holds equally well for subsets ( see ( * ? ? ?",
    "* remark 15 ) ) , albeit resulting in an upper bound in terms of the size of the entire cartesian product @xmath238 , as stated above .",
    "theorem  [ cor : multcor ] is a generalization of theorem  [ thm : incprod ] to systems of points and curves that do not quite meet the conditions of the theorem , but that do satisfy them after appropriate decompositions of the sets of points and curves .",
    "we repeat definition  [ def : boundedmult ] here for the convenience of the reader .",
    "let @xmath238 be a finite set of distinct points in @xmath99 , and let @xmath213 be a finite multiset of curves in @xmath99 .",
    "we say that the system @xmath239 has _",
    "@xmath240-bounded multiplicity _ if + @xmath199 for any curve @xmath241 , there are at most @xmath242 curves @xmath243 such that there are more than @xmath244 points contained in both @xmath245 and @xmath246 ; and + @xmath204 for any point @xmath247 , there are at most @xmath242 points @xmath248 such that there are more than @xmath244 curves that contain both @xmath249 and @xmath250 .",
    "+ ( in both @xmath199 and @xmath204 the curves should be counted with multiplicity . )",
    "we now state and prove the incidence bound that we use in the proof of our main theorem .",
    "[ cor : multcor ] let @xmath719 be finite subsets of @xmath70 and @xmath720 , and let @xmath213 be a finite multiset of algebraic curves of degree at most @xmath255 , such that the system @xmath239 has @xmath240-bounded multiplicity .",
    "then @xmath256    we partition @xmath713 into subsets @xmath721 and @xmath213 into subsets @xmath722 , so that for each pair @xmath723 , we can apply theorem [ thm : incprod ] to the system @xmath724 .",
    "each of the subsets @xmath722 will consist of distinct elements , so we bypass the issue that @xmath213 might be a multiset .    construct a graph @xmath399 with the curves in @xmath213 as vertices ( where a curve that occurs @xmath725 times in the multiset corresponds to @xmath725 distinct vertices ) , and with an edge between any pair of curves that have intersection size larger than @xmath244 ( thus all vertices representing the same curve form a clique ) . by definition of @xmath240-bounded multiplicity",
    ", @xmath399 has maximum vertex degree at most @xmath242 , so we can color the graph with @xmath726 colors . in other words",
    ", we can partition the curves into @xmath726 sets @xmath722 , so that any pair of curves within the same @xmath722 have at most @xmath244 points of @xmath713 in common . in particular , any pair of coinciding curves , or of curves that share some irreducible component ,",
    "are placed in different color classes .",
    "we do the same for the points .",
    "we construct a graph with the points of @xmath713 as vertices , and with an edge between any pair of points for which there are more than @xmath244 curves from @xmath213 containing both points . again the definition of @xmath240-bounded multiplicity lets us color this graph with @xmath726 colors .",
    "we get subsets @xmath721 of @xmath713 , such that for any two points in the same @xmath721 , there are at most @xmath244 curves @xmath252 that pass through both of them",
    ". thus we can apply theorem [ thm : incprod ] for every pair @xmath727 ( making use of the fact that @xmath728 and @xmath238 is a cartesian product ) to obtain @xmath729 summing over all @xmath730 pairs @xmath727 and using hlder s inequality gives the asserted bound .",
    "in this section we prove theorem [ thm : main3 ] . to avoid confusion , given a real polynomial @xmath3 , in this section we write @xmath60 for its _ real _ zero set , and @xmath731 for its _ complex _ zero set .",
    "we refer to basu et al .",
    "@xcite for the relevant definitions .",
    "any regular point of a real zero set has a neighborhood where the zero set is a real manifold , and the dimension of the zero set is the maximum over all regular points of the dimension of that manifold .",
    "we recall that a real function @xmath732 on an interval @xmath66 is _ real - analytic _ if it has a power series expansion at each point of @xmath66 .",
    "we want to prove that if @xmath61 $ ] is irreducible over @xmath6 and does not satisfy the unbalanced property @xmath57 of theorem [ thm : main2 ] ( over @xmath6 , and thus also over @xmath70 ) , then it satisfies property @xmath62 of theorem [ thm : main3 ] .",
    "we first treat the case where @xmath3 is irreducible over @xmath70 , and then the case where @xmath3 is reducible over @xmath70 , which requires some extra care .",
    "the two respective lemmas that establish these properties give us theorem [ thm : main3 ] .",
    "[ lem : realirred ] let @xmath61 $ ] be irreducible over @xmath70 and assume that @xmath60 has dimension 2 . if @xmath3 does not satisfy @xmath57 , then it satisfies @xmath62 .    by theorem [ thm : main2 ] ,",
    "property @xmath18 holds ( over @xmath70 ) , with an excluded one - dimensional subvariety @xmath733 .",
    "let @xmath630 be the union of @xmath734 with the set of singular points of @xmath60 ; it is a variety of dimension at most 1 .",
    "since property @xmath18 holds over @xmath70 , for each @xmath735 , there exist open sets @xmath736 and analytic injections @xmath737 , such that @xmath738 , and , for every @xmath38 , we have @xmath739 by shrinking @xmath740 , @xmath504 , @xmath741 , if needed , we may assume that the sets @xmath742 are nonempty open intervals , containing , respectively , the points @xmath743 .",
    "then we have @xmath744 .",
    "write @xmath745 , for @xmath746 .",
    "each of the six functions @xmath747 , @xmath748 , for @xmath746 , is a real - analytic function , since the real ( or imaginary ) part of a power series expansion for @xmath749 is a real power series expansion for @xmath747 ( or @xmath748 ) . by , for every real point @xmath750",
    ", we have @xmath751 if and only if @xmath752 thus at least one of the two sets @xmath753 does not equal @xmath754 ; say it is @xmath755 . by what has just been shown",
    ", @xmath755 contains @xmath756 .",
    "since the point @xmath86 is not in @xmath630 , it is regular , so we can assume without loss of generality that @xmath757 .",
    "it follows , by the real version of the implicit function theorem , that there is an open subset of @xmath754 in which @xmath60 is the graph of a real - analytic function in @xmath758 .",
    "since @xmath755 is also the graph of a real - analytic function , it follows that @xmath755 and @xmath60 coincide in this open subset . by shrinking this open subset",
    "we can assume that it is of the form @xmath759 for intervals @xmath760 .",
    "in other words , we have shown that , for every real point @xmath69 , @xmath761 thereby showing that property @xmath62 holds .",
    "let @xmath61 $ ] be irreducible over @xmath6 but reducible over @xmath70 , and assume that @xmath60 has dimension 2 .",
    "if @xmath3 does not satisfy @xmath57 , then it satisfies @xmath62 .    in this case",
    ", @xmath3 must be of the form @xmath762 , with @xmath117 an irreducible complex polynomial .",
    "this is because for every complex factor @xmath117 of @xmath3 , @xmath763 is also a factor , which follows from the unique factorization property and the fact that @xmath764 .",
    "if we had a nontrivial factorization of the form @xmath765 , then @xmath766 would be a factorization over @xmath6 , contradicting the assumption that @xmath3 is irreducible over @xmath6 .",
    "if property @xmath57 holds for either of the polynomials @xmath117 , @xmath763 , then it holds for both , since @xmath767 since @xmath768 , it follows that if @xmath3 does not satisfy property @xmath57 , then at least one of @xmath117 or @xmath763 does not satisfy it either , and thus neither of them does .",
    "applying theorem  [ thm : main2 ] to both @xmath117 and @xmath763 gives that property @xmath18 holds ( over @xmath70 ) for both .",
    "let @xmath769 , @xmath770 be the respective one - dimensional excluded subvarieties of @xmath771 , @xmath772 in the statement of property @xmath18 .",
    "we put @xmath773 and claim that @xmath774 is also at most one - dimensional .",
    "indeed , @xmath775 is equivalent to @xmath776 , which is the common zero set of two coprime polynomials ( that @xmath777 and @xmath778 are coprime follows from the irreducibility of @xmath117 ) .",
    "we thus conclude that , also in this case , property @xmath18 holds for @xmath3 ( over @xmath70 ) , with the excluded subvariety @xmath779 .",
    "we can now complete the proof of this lemma exactly as in the proof of lemma [ lem : realirred ] , using this excluded subvariety @xmath779 .",
    "in this section we use our main theorem to derive improvements of the results of elekes and szab @xcite on collinear triples determined by a set of points on an algebraic curve .",
    "we obtain stronger bounds that also hold in an unbalanced setting , and we extend them to the complex plane .",
    "our proof is similar to that of @xcite , in that it reduces the statements to theorem [ thm : main2 ] in the same way that elekes and szab reduced their statements in @xcite to the main theorem of @xcite .",
    "but our proof is considerably simpler , partly because in @xcite the authors established a more general statement about real continuous curves , which they then applied to real algebraic curves , while we focus entirely on complex algebraic curves .",
    "the corresponding statements over @xmath6 then follow directly .",
    "the main result is the following theorem , from which the other results will be deduced .",
    "of course , just as in theorem [ thm : main2 ] , an analogous bound holds for any permutation of @xmath780 .",
    "the explicit dependence of the constant of proportionality on the degree @xmath24 of the curves can easily be deduced from that in theorem [ thm : main2 ] .",
    "we call a triple @xmath781 of points _ proper _ if no two of the points @xmath782 are the same , and we call it _ improper _ otherwise .",
    "[ thm : threecurves ] let @xmath783 be three ( not necessarily distinct ) irreducible algebraic curves of degree at most @xmath24 in @xmath99 , and let @xmath784 be finite subsets .",
    "then the number of proper collinear triples in @xmath785 is @xmath786 unless @xmath787 is a line or a cubic curve .",
    "following @xcite , we say that _ collinearity is group - related _ around a proper collinear triple @xmath788 , if for each @xmath36 there is an open subset @xmath789 of @xmath513 containing @xmath782 , together with a one - to - one analytic map @xmath790 , such that a triple @xmath791 is collinear if and only if @xmath792 this situation is depicted in figure [ fig : collinearity ] .",
    "we define a polynomial @xmath793 by @xmath794 and a variety @xmath795 , equipped with coordinates @xmath796 , by @xmath797 which is the set of all collinear triples in @xmath798 . since @xmath798 is an irreducible three - dimensional variety , @xmath144 is purely two - dimensional by lemma [ lem : dimension ] , unless @xmath793 vanishes on all of @xmath798 .",
    "this exception only occurs if all triples in @xmath798 are collinear , which would imply that the three curves are the same line ; this is excluded in the theorem .    by applying a generic rotation in @xmath99 at the start of the proof , we can assume that no two points of @xmath799 , @xmath800 , or @xmath801 have the same @xmath173-coordinate . then the projection @xmath802 defined by @xmath803 is injective on the cartesian product @xmath785 .",
    "moreover , the image of @xmath785 is a cartesian product @xmath804 , with @xmath805 of size @xmath806 for @xmath36 . because of the generic rotation , @xmath807 is also a purely two - dimensional variety .    the variety @xmath144 contains all collinear triples in @xmath798 , but it also contains all improper triples .",
    "these are mapped onto the union of three planes ( namely those defined by @xmath808 , @xmath809 , and @xmath810 ) .",
    "we remove these planes from @xmath807 , and we denote the closure of the remainder by @xmath779 . if we write @xmath101 for the number of proper collinear triples in @xmath785 , then these @xmath101 triples are mapped to @xmath101 points in the intersection of @xmath779 with the cartesian product @xmath804",
    ".    thus we can apply theorem [ thm : main2 ] on each irreducible component of @xmath779 to bound @xmath101 , noting that each such component is the zero set of some irreducible trivariate polynomial ( whose degree depends on @xmath24 ) .",
    "this gives the bound in the statement of theorem [ thm : threecurves ] , unless condition @xmath18 of theorem [ thm : main2 ] holds on some irreducible component of @xmath779 .",
    "suppose @xmath811 is such a component , so condition @xmath18 gives , for @xmath36 , a number @xmath812 , a neighborhood @xmath518 of @xmath812 , and a one - to - one analytic map @xmath813 , such that , for each @xmath814 , @xmath815 if and only if @xmath816 .",
    "we can assume that @xmath817 does not contain any points that were added to @xmath818 when taking the closure .",
    "write @xmath819 for the projection @xmath820 .",
    "we choose @xmath821 so that @xmath822 .",
    "we also pick an open neighborhood @xmath789 of @xmath782 in @xmath513 so that @xmath823 , and we define the analytic map @xmath824 . by shrinking @xmath789",
    ", we can assume that @xmath59 is one - to - one . by shifting the triple @xmath781 slightly within @xmath825",
    ", we can assume that the triple is proper , since improper triples lie in a lower - dimensional subset of @xmath811 .",
    "finally , we can assume that @xmath826 are regular points of their respective curves , since the sets of singular points are discrete . with these definitions , collinearity is group - related around some proper collinear triple @xmath788 , with @xmath826 regular .",
    "we pick a point @xmath827 on @xmath828 , close to @xmath77 , and start to build a  cantilever \" from @xmath76 , @xmath78 , and @xmath827 as in figure [ fig : cantilever1 ] .",
    "more precisely , we proceed as follows . throughout , we assume that @xmath827 is chosen close enough to @xmath77 for each of the steps to work . for convenience , we modify the functions @xmath59 so that @xmath829 and @xmath830 ( the integer labels in figure [ fig : cantilever1 ] show these values ) .",
    "the line through @xmath76 and @xmath827 intersects @xmath831 in a point @xmath832 close to @xmath78 , and since collinearity is group - related , we must have @xmath833 .",
    "similarly , the line @xmath834 intersects @xmath501 in a point @xmath835 close to @xmath76 , with @xmath836 .",
    "next , the line @xmath837 must intersect @xmath502 in a point @xmath838 close to @xmath77 , with @xmath839 .",
    "we can continue adding points this way as long as the @xmath789 s allow , and by choosing @xmath827 closer to @xmath77 , we can continue for arbitrarily many steps .",
    "the key observation is that , given the first nine points as depicted in figure [ fig : cantilever1 ] ( not counting @xmath77 ) , the cantilever can be continued _ without using the curves _",
    "( see figure [ fig : cantilever2 ] ) .",
    "specifically , given the points in figure [ fig : cantilever1 ] , the point on @xmath840 with value @xmath335 is determined as the intersection point of two lines ( which is not the case for the point with value @xmath298 ) .",
    "next , the points on @xmath841 and @xmath840 with value @xmath842 are determined , after which the point on @xmath828 with value @xmath843 is determined , etc",
    ".    given the curves @xmath783 , the collinear triple @xmath781 , and a choice of @xmath827 ( close enough to @xmath77 ) , we get a configuration of nine points on @xmath844 as in figure [ fig : cantilever1 ] .",
    "an easy and well - known fact is that there exists a cubic curve through any nine given points ; let @xmath74 be a cubic through our configuration of nine points . as shown in elekes and szab  (",
    "* proposition 3.2 ) , collinearity is group - related on any cubic curve , around any proper collinear triple of regular points ( the proof consists of choosing a convenient representative of each type of cubic , with a coordinate system in which the group relation becomes apparent ) . therefore , any cantilever obtained by extending the cantilever of nine points on the cubic @xmath74 lies entirely in @xmath74 .",
    "now choose @xmath827 so close to @xmath77 that we can build a cantilever that has at least @xmath845 points in each @xmath789 .",
    "for each @xmath36 , these @xmath845 points lie in the intersection @xmath846 .",
    "since their number is larger than @xmath847 , bzout s inequality ( theorem [ thm : bezout ] ) implies that @xmath513 and @xmath74 have a common factor .",
    "if @xmath74 is irreducible then , since each @xmath513 is also irreducible , we conclude that @xmath848 for each @xmath115 .",
    "hence @xmath844 is a cubic in this case , and we are done .",
    "suppose then that @xmath74 is the union of a conic @xmath216 and a line @xmath849 .",
    "if all the @xmath513 s are equal to @xmath849 , we get that @xmath844 is a line .",
    "if all the @xmath513 s are equal to @xmath216 , then @xmath850 is a conic , in which case @xmath799 , @xmath800 , @xmath801 can not determine any proper collinearity .",
    "we are thus left with the case where at least one @xmath513 is equal to @xmath849 and at least one is equal to @xmath216 , so in this case too @xmath844 is a cubic , and the proof is complete .",
    "[ cor : baltrips ] any @xmath2 points on an irreducible algebraic curve of degree @xmath24 in @xmath99 determine @xmath851 proper collinear triples , unless the curve is a line or a cubic",
    ".    apply theorem [ thm : threecurves ] with @xmath852 equal to the given set of @xmath2 points , and @xmath853 equal to the given curve .",
    "elekes and szab @xcite showed that when @xmath854 is any cubic curve , there are constructions that give @xmath855 proper collinear triples .",
    "when @xmath854 is a line , there are of course @xmath856 proper collinear triples . thus excluding these curves",
    "is necessary in corollary [ cor : baltrips ] .",
    "the same can be said for theorem [ thm : threecurves ] and the two corollaries below .",
    "any @xmath2 points on an algebraic curve of degree @xmath24 in @xmath99 determine @xmath851 proper collinear quadruples , unless the curve contains a line .",
    "suppose the curve determines @xmath475 proper collinear quadruples .",
    "the curve has at most @xmath24 irreducible components , so by the pigeonhole principle , there must be four components ( not necessarily distinct ) that span @xmath857 proper collinear quadruples ( with one point of the quadruple from each component ) .",
    "then every three among these span @xmath857 collinear triples , and thus , by theorem [ thm : threecurves ] , either @xmath858 , or the union of these three components is a line or a cubic . in the first case ,",
    "we are done . in the second case ,",
    "we are also done , unless all three components are the same irreducible cubic . if we have this for every three of the four components , then all four would be the same irreducible cubic , and they could not span any proper collinear quadruple at all , a contradiction .",
    "[ cor : directions ] any @xmath2 points on an irreducible algebraic curve of degree @xmath24 in @xmath99 determine @xmath859 distinct directions , unless the curve is a conic .",
    "let @xmath502 and @xmath831 be two copies of this curve , and let @xmath501 be the line at infinity in the projective plane .",
    "we take both @xmath800 and @xmath801 to be the given set of @xmath2 points , and we let @xmath799 be the set of all points where a line through a pair of points from @xmath860 intersects @xmath501 . in other words ,",
    "the points of @xmath799 correspond exactly to the directions determined by the given @xmath2 points .",
    "furthermore , the three curves @xmath783 determine @xmath861 proper collinear triples , one for each pair of distinct points from @xmath860 .",
    "combining this lower bound with theorem [ thm : threecurves ] gives that either @xmath862 or @xmath844 is a line or cubic .",
    "the former implies that the number of directions is @xmath863 . in the latter case",
    ", the fact that @xmath501 is a line distinct from @xmath864 implies that @xmath864 is a conic .",
    "finally , we note that the statements above also hold over @xmath6 .",
    "indeed , an irreducible algebraic curve in @xmath73 is contained ( under the standard embedding of @xmath73 in @xmath99 ) in an irreducible algebraic curve in @xmath99 , which has the same degree . a real line containing three points of the real curve",
    "is contained in a complex line , which contains at least three points of the complex curve .",
    "thus an upper bound on the number of proper collinear triples on a complex curve implies an upper bound on the number of proper collinear triples on a real curve .",
    "10    s. basu , r. pollack , and m .- f .",
    "roy , _ algorithms in real algebraic geometry _ , springer - verlag , berlin , 2003 .",
    "m. charalambides , distinct distances on curves via rigidity , _ discrete comput",
    "_ 51 ( 2014 ) , 666701 .",
    "g. elekes and l. rnyai , a combinatorial problem on polynomials and rational functions , _ j. combinat",
    ". theory ser .",
    "a _ 89 ( 2000 ) , 120 .",
    "g. elekes and e. szab , how to find groups ?",
    "( and how to use them in erds geometry ? ) , _ combinatorica _ 32 ( 2012 ) , 537571 .",
    "g. elekes and e. szab , on triple lines and cubic curves : the orchard problem revisited , in arxiv:1302.5777 ( 2013 ) .",
    "g. elekes , m. simonovits , and e. szab , a combinatorial distinction between unit circles and straight lines : how many coincidences can they have ?",
    ", _ combinat .",
    "_ 18 ( 2009 ) , 691705 .",
    "k. fritzsche and h. grauert , _ from holomorphic functions to complex manifolds _ , springer - verlag , new york , 2002 .",
    "j. harris , _ algebraic geometry : a first course _ , springer - verlag , new york , 1992 .",
    "r. hartshorne , _ algebraic geometry _ , springer - verlag , new york , 1977 .",
    "j. heintz , definability and fast quantifier elimination in algebraically closed fields , _ theoret .",
    "_ 24 ( 1983 ) , 239277 .",
    "s. lang , _ complex analysis _ , springer - verlag , new york , 1999 .",
    "j. pach and f. de zeeuw , distinct distances on algebraic curves in the plane , _ proc .",
    "30th annu .",
    "_ , 2014 , 549557 . also in http://arxiv.org/abs/1308.0177[arxiv:1308.0177 ]",
    "( 2013 ) .",
    "o. e. raz , m. sharir , and j. solymosi , polynomials vanishing on grids : the elekes - rnyai problem revisited , _ amer . j. math .",
    "_ , to appear . also in _ proc",
    "30th annu .",
    "geom . _ , 2014 , 251260 , and in http://arxiv.org/abs/1401.7419[arxiv:1401.7419 ] ( 2014 ) ..    o. e. raz , m. sharir , and j. solymosi , on triple intersections of three families of unit circles , _ discrete comput .",
    "_ , to appear . also in _ proc",
    "30th annu .",
    "geom . _ , 2014 , 198205 , and in http://arxiv.org/abs/1407.6625[arxiv:1407.6625 ] ( 2014 ) .",
    "j.  schwartz , fast probabilistic algorithms for verification of polynomial identities , _",
    "j. acm _ 27 ( 1980 ) , 701717 .",
    "m. sharir , a. sheffer , and j. solymosi , distinct distances on two lines , _ j. combinat",
    ". theory ser . a _ 120 ( 2013 ) , 17321736 .",
    "m. sharir and j. solymosi , distinct distances from three points , _ combinat .",
    "_ , to appear . also in http://arxiv.org/abs/1308.0814[arxiv:1308.0814 ]",
    "( 2013 ) .",
    "j. solymosi and t. tao , an incidence theorem in higher dimensions , _ discrete comput .",
    "_ 48 ( 2012 ) , 255280 .    e. szemerdi and w. t. trotter , extremal problems in discrete geometry , _ combinatorica _ 3 ( 1983 ) , 381392 .",
    "a. sheffer and j. zahl , point - curve incidences in the complex plane , in arxiv:1502.07003 ( 2015 ) .",
    "j. solymosi and f. de zeeuw , incidence bounds for complex algebraic curves on cartesian products , in http://arxiv.org/abs/1502.05304[arxiv:1502.05304 ] ( 2015 ) .",
    "t. tao , expanding polynomials over finite fields of large characteristic , and a regularity lemma for definable sets , in http://arxiv.org/abs/1211.2894[arxiv:1211.2894 ] ( 2012 ) .",
    "t. tao , _ bzout s inequality _ , blog post , available at http://terrytao.wordpress.com/2011/03/23/bezouts-inequality .",
    "c.  d. tth , the szemerdi - trotter theorem in the complex plane , _ combinatorica _ , to appear . also in http://arxiv.org/abs/math/0305283[arxiv:math/0305283 ] ( 2003 ) .",
    "j. zahl , a szemerdi - trotter type theorem in @xmath865 , in http://arxiv.org/abs/1203.4600[arxiv:1203.4600 ] ( 2012 ) .",
    "r. zippel , an explicit separation of relativised random polynomial time and relativised deterministic polynomial time , _ inform . process .",
    "_ 33 ( 1989 ) , 207212 .",
    "in this section we review some basic notions and facts from algebraic geometry , and establish various properties that we need in our proof .",
    "although the material reviewed here is fairly standard , we include it to make the paper more self - contained , and to aid readers whose background is mostly in combinatorial geometry .",
    "a _ variety _ in @xmath866 is a set of the form @xmath867 for polynomials @xmath868 $ ] .",
    "such sets are normally called _ affine _ varieties , but since this is the only type of variety that we consider , we refer to them simply as varieties .",
    "if @xmath869 are varieties , then @xmath587 , @xmath870 and @xmath871 are also varieties .",
    "a _ subvariety _ of a variety @xmath144 is a subset of @xmath144 that is a variety .",
    "a _ proper subvariety _ of @xmath144 is a subvariety which is neither @xmath144 nor the empty set .",
    "a variety is _ irreducible _ if it is not the union of two proper subvarieties .",
    "if @xmath144 and @xmath779 are irreducible varieties , then the cartesian product @xmath871 is also irreducible ( harris ( * ? ?",
    "* exercise 5.9 ) ) .",
    "an _ irreducible component _ of a variety @xmath144 is an irreducible subvariety that is not a proper subvariety of any irreducible proper subvariety of @xmath144 .",
    "every variety has a decomposition into finitely many irreducible components ( see ( * ? ? ?",
    "* theorem 5.7 ) ) .",
    "this decomposition is unique ( up to permutations ) , and any irreducible component of the variety must occur in it .",
    "we are particularly interested in curves in @xmath99",
    ". an _ ( algebraic ) curve _ in @xmath99 is any set of the form @xmath872 for @xmath873\\minus\\c$ ] .",
    "the _ degree _ of a curve @xmath245 is the degree of a squarefree polynomial @xmath11 such that @xmath874 .",
    "an irreducible component of a curve is a curve .",
    "note that by our definition , not every one - dimensional variety in @xmath99 ( see below ) is a curve ; for instance , @xmath875 , i.e. , the union of the @xmath173-axis and the point @xmath876 , is a one - dimensional variety that can not be described as the zero set of one polynomial .      for a variety @xmath877",
    ", we say that @xmath878 is _ regular _ if there exists a neighborhood @xmath475 of @xmath879 such that @xmath880 is a complex manifold ( see ( * ? ? ?",
    "* exercise 14.1 ) ) ; we then say that the _ local dimension _ of @xmath144 at @xmath879 is the dimension of that manifold ( see ( * ? ? ?",
    "* exercise 14.3 ) ) .",
    "otherwise we say @xmath879 is _",
    "singular_.    the _ dimension _ @xmath881 of an irreducible variety @xmath144 is the maximum of the local dimensions at its regular points . for a general variety @xmath144 , @xmath881 is the maximum of the dimensions of the irreducible components of @xmath144 .",
    "we refer to ( * ? ? ?",
    "* lecture 11 ) for several equivalent definitions of dimension , but we note that we only use the simple properties stated below .    for varieties",
    "@xmath882 , we have @xmath883 , and @xmath884 .",
    "we have @xmath885 . if @xmath877 is a variety and @xmath886 , then @xmath887 .",
    "if @xmath888\\minus \\c$ ] , then @xmath889 . if @xmath890 $ ] are coprime polynomials , and @xmath891 is nonempty , then @xmath892 .",
    "we say that a variety is _ pure - dimensional _ if it has the same local dimension at all of its regular points . by our definition , curves are always pure - dimensional .",
    "an irreducible variety is pure - dimensional ( this is clear from the equivalent definitions in ( * ? ? ?",
    "* lecture 11 ) ) , so a variety is pure - dimensional if and only if each of its irreducible components has the same dimension .",
    "if @xmath779 is an irreducible subvariety of @xmath144 and @xmath893 , then @xmath779 is one of the irreducible components of @xmath144 .",
    "a point on a variety in @xmath866 is _ singular _ if it is not regular .",
    "the subset of singular points of an irreducible variety is a proper subvariety ( see ( * ? ? ?",
    "* exercise 14.3 ) or hartshorne ( * ? ? ?",
    "* theorem i.5.3 ) ) , and therefore lower - dimensional .",
    "the same follows for reducible varieties : the set of singular points is the union of the sets of singular points of the irreducible components , and the set of intersection points of the various irreducible components ; both sets have dimension lower than that of the component of highest dimension .",
    "we define the _ degree _ @xmath898 of an irreducible variety @xmath144 of dimension @xmath725 in @xmath866 as in heintz @xcite , by @xmath899 for a reducible variety @xmath144 , we define @xmath898 to be the sum of the degrees of its irreducible components . for curves ,",
    "this definition coincides with our earlier definition .",
    "we have @xmath900 and @xmath901 if @xmath11 is a square - free polynomial . if @xmath703 is a finite set , then @xmath902 .",
    "if @xmath144 and @xmath779 are varieties , then @xmath903 . if @xmath904 are pure - dimensional varieties of the same dimension , then @xmath905 .",
    "note that theorem [ thm : bezout ] implies bzout s inequality for curves @xmath907 in the plane , which is usually stated in the following form : either @xmath908 is finite , and then @xmath909 , or else @xmath908 is one - dimensional , which means that @xmath501 and @xmath502 have a common component .",
    "the following bound is an immediate consequence . since the degree of a reducible variety is the sum of the degrees of its irreducible components , this lemma also gives a bound on the number of irreducible components of a variety .",
    "[ lem : degreebound ] if a variety @xmath144 in @xmath866 is defined by @xmath910 polynomials of degree @xmath911 , then @xmath912 in particular , the number of irreducible components of @xmath144 is at most @xmath913 .",
    "we will frequently use standard projections , i.e. , projections that send a point of @xmath866 to a point of @xmath917 , for @xmath918 , by omitting some of its coordinates .",
    "we will use the word _",
    "projection _ to refer to any such map , although most of the properties we state below are true for more general projections .",
    "the image @xmath818 of a variety @xmath144 under a projection @xmath919 does _ not _ have to be a variety ; if we for instance apply @xmath920 to @xmath921 , the image is @xmath922 .",
    "therefore , we will have to enlarge the image of a projection to make it a variety .",
    "for any set @xmath923 , we define its _ ( zariski ) closure _ to be the intersection of all varieties containing @xmath703 , and denote it by @xmath924 .",
    "this is the closure in the `` zariski topology '' ( see ( * ? ? ?",
    "* lecture 2 ) ) ; because we also deal with the standard topology of @xmath866 , we avoid the zariski terminology , but we make an exception for `` closure '' .",
    "we need the following facts .",
    "the closure of the union of finitely many sets equals the union of the closures , while the union of infinitely many sets _ contains _ the union of the closure .",
    "the closure of a finite product of sets is the product of the closures .",
    "if @xmath915 is infinite , then @xmath925 .",
    "the following lemma gives another useful fact .",
    "consider first the case where @xmath144 is irreducible .",
    "if @xmath927 the assertion clearly holds , so we can assume this is not the case .",
    "since @xmath928 , we have that @xmath929 is nonempty , and @xmath870 is a proper subvariety of @xmath144 .",
    "suppose @xmath930 , for some proper subvariety @xmath931 of @xmath144 .",
    "then @xmath932 , a union of two proper subvarieties , contradicting the assumption that @xmath144 is irreducible .",
    "we frequently combine a projection @xmath919 with the closure operation , giving us a variety @xmath807 , and we need the fact that this only requires adding a lower - dimensional set to @xmath818 . we deduce this from the following theorem , a proof of which can be found in basu , pollack , and roy ( * ? ? ?",
    "* theorem 1.22 ) , ( * ? ? ?",
    "* theorem 3.16 ) , or ( * ? ? ?",
    "* exercise ii.3.18 ) .",
    "constructible _ set in @xmath866 is one that can be defined using any boolean combination of polynomial equations , or , in an equivalent form that is more convenient to us , any set of the form @xmath938 for varieties @xmath939 in @xmath866 .",
    "the following lemma states that when taking the closure of the image of a projection , the set of added points is lower - dimensional .",
    "for instance , when projecting a curve , the image is a curve with only finitely many points removed .      by theorem [ thm : chevalley ]",
    ", @xmath818 is a constructible set , so we can write @xmath942 with varieties @xmath939 in @xmath917 . more precisely , we can write @xmath943 , assume that each @xmath944 is irreducible , and assume that @xmath945 is a proper subvariety of @xmath944 for each @xmath115 . by lemma [ lem : dense ] , we have @xmath946 , and thus @xmath947 since @xmath945 is a proper subvariety of @xmath944 , there must be some polynomial that vanishes on @xmath948 but not on @xmath944 . lemma [ lem : dimension ] then implies that @xmath945 is lower - dimensional , which proves the lemma .",
    "the first inequality follows from ( * ? ? ?",
    "* theorem 11.12 ) .",
    "the second inequality is implied by the following facts . by theorem [ thm : chevalley ]",
    ", @xmath818 is constructible . by heintz ( * ? ? ? * remark 2 ) , the degree of a constructible set equals the degree of its closure . by (",
    "* ? ? ? * lemma 2 ) , @xmath951 for any linear map @xmath952 .",
    "we require several concepts and facts from complex analysis in several variables .",
    "precise definitions related to _ analytic _ ( or equivalently , _ holomorphic _ ) maps from @xmath953 to @xmath954 can be found in fritzsche and grauert @xcite . in brief , a function @xmath11 from an open set in @xmath953 to @xmath70 is analytic if it is locally represented by a power series in the @xmath910 coordinate variables , and a map @xmath955 from an open set in @xmath953 to @xmath954 is analytic if each @xmath956 is analytic .",
    "polynomial maps are of course analytic .",
    "a map @xmath11 between two open sets in @xmath953 is _ bianalytic _ if it is analytic and bijective , and @xmath957 is analytic .    for an analytic map @xmath958 from an open set @xmath959 to @xmath953 , with @xmath960 , we define the _ jacobian matrix _ of @xmath405 at @xmath961 to be @xmath962 given a representation @xmath963 , we write @xmath964 for the rightmost square submatrix of @xmath965 .      [ lem : ift1 ] let @xmath966 be an open set , @xmath967 an analytic map , and @xmath968 a point with @xmath969 and @xmath970 .",
    "then there are open sets @xmath971 such that @xmath972 , and an analytic map @xmath973 such that @xmath974      [ lem : ift2 ] let @xmath975 be an open set , @xmath976\\backslash\\{0\\}$ ] a polynomial , and @xmath977 a point with @xmath978 and @xmath979",
    ". then there are open sets @xmath980 such that @xmath981 , and an analytic map @xmath982 such that @xmath983    in certain parts of our proof we use the following equivalent formulation of the implicit function theorem ( see @xcite ) .",
    "we write @xmath984 for the restriction of the function @xmath405 to a subset @xmath626 of its domain ."
  ],
  "abstract_text": [
    "<S> let @xmath0 $ ] be a constant - degree polynomial , and let @xmath1 be finite sets of size @xmath2 . </S>",
    "<S> we show that @xmath3 vanishes on at most @xmath4 points of the cartesian product @xmath5 , unless @xmath3 has a special group - related form . </S>",
    "<S> this improves a theorem of elekes and szab @xcite , and generalizes a result of raz , sharir , and solymosi @xcite . </S>",
    "<S> the same statement holds over @xmath6 , and a similar statement holds when @xmath7 have different sizes ( with a more involved bound replacing @xmath4 ) .    </S>",
    "<S> this result provides a unified tool for improving bounds in various erds - type problems in combinatorial geometry , and we discuss several applications of this kind . </S>"
  ]
}