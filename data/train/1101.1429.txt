{
  "article_text": [
    "quantum control  @xcite is concerned with the detailed manipulation of systems in the microscopic world .",
    "its most common application is the design of laser fields capable of triggering a given response of some target system . under this umbrella name of quantum control",
    "we may include both experimental techniques , the theoretical description of those , and the mathematical techniques used to predict the controlling external fields .",
    "experimentally , the field has advanced very rapidly in the last years due to the convergence of several important paths : most notably , the development of ultra - fast and ultra - intense laser sources , the appearance of pulse shapers  @xcite , and the invention of the adaptive feedback technique  @xcite .    theoretically , the most general framework used to address quantum control problems is quantum optimal control theory ( qoct )  @xcite .",
    "it is formulated as the problem of maximizing a functional that quantifies to what extent the given objective is met by a certain laser field .",
    "the result is typically an algorithm that requires , as main steps , the propagation of the time dependent schrdinger equation that describes the evolution of the system ( and , usually , of a similar equation that is propagated backwards ) .",
    "the ab initio solution of these equations is , unfortunately , prohibitively expensive for most systems due to the complexity of their wavefunctions .",
    "time - dependent density - functional theory ( tddft )  @xcite provides in many cases a viable solution for this problem .",
    "recently , the merger of qoct and tddft has been proposed and numerically demonstrated  @xcite . within tddft",
    "the electron density , that can be obtained from the solution of the so - called time dependent kohn - sham ( ks ) equations , substitutes the many - electron wavefunction as the main object to be manipulated .",
    "the targets of qoct are usually defined as functionals of many - electron wavefunctions .",
    "for example , if one wishes to increase the population of a given excited state , the target is defined in terms of the projector onto that particular excited state wave function . however , these wavefunctions are in principle unavailable within the tddft framework that provides the electron density only  . therefore ,",
    "if one is to use qoct with tddft consistently , the targets should be defined as functionals of this electron density alone .    yet , to construct better target functionals ( whether or not tddft is used ) , it may be useful to add an extra ingredient to the electron density , namely the electron current density .",
    "note that the longitudinal component of this current vector field is linked directly to the density through the continuity equation , and can therefore be obtained with tddft ( the perpendicular component of the ks current density is also conjectured to coincide with the many - electron one ) .",
    "for example , it is easy to think of a density - functional target constructed to maximize charge transfer between two regions of a system .",
    "however , once the controlling field is switched off , even if the charge has been effectively transferred , the final state may not be stable .",
    "the inclusion of the current in the definition of the target functional can be used , as will be demonstrated below , to stabilize the final state of the propagation : if the current ( or its divergence ) is small , the continuity equation ensures that the time - variation of the density is also small .    in order to demonstrate the usefulness and feasibility of including the electron current density in the definition of target functionals",
    ", we studied several model one - electron systems in one and two dimensions .",
    "the point is to show that with this combined target one can obtain solutions that ( i ) are stabler if the current is minimized and that ( ii ) resemble results as if the target was formulated in terms of the wavefunction  @xcite .",
    "finally , we also note that we do not put forward the use of current tddft  @xcite , but rather the inclusion of the current density in the definition of the control targets .",
    "the proposed equations have been implemented into the octopus code  @xcite .",
    "the paper is organized as follows : in section  [ sec : theory ] we briefly outline the optimization scheme , and introduce the new control functionals defined in terms of the electron density and its current . in section  [ sec : applications ] we present numerical examples that serve as a proof of principle .",
    "the conclusions are given in section  [ sec : conclusion ] .",
    "atomic units ( a.u . ) are used throughout .",
    "we consider a one - electron system governed at rest by the hamiltonian @xmath0 that interacts with a time - dependent control field @xmath1 in the time span @xmath2 $ ] , such that the total hamiltonian is given by : @xmath3 where @xmath4 is the dipole operator that couples with the electric field @xmath1 . without loss of generality , we will think of @xmath1 as the electric field of a laser pulse",
    ".    in qoct one tries to find the control field that best realizes an objective that in general is mathematically encoded into a functional of the field @xmath5 $ ] .",
    "this is defined in the following way : the field determines the evolution of the system , @xmath6 $ ] , and this in turn determines @xmath7 through an intermediate functional @xmath8 : @xmath9 = f[\\psi[\\epsilon],\\epsilon]\\,.\\ ] ] the functional @xmath8 must be carefully defined in order to ensure the fulfillment of the objective .",
    "typically , it is split into two pieces : @xmath10 = \\mathcal{o}[\\psi ] + \\mathcal{f}[\\epsilon]\\,,\\ ] ] where @xmath11 $ ] is the quantity that we really want to optimize , whereas @xmath12 imposes a penalty on undesired features of the controlling fields : _",
    "e.g. _ high frequency components , unrealistically high intensities , etc . in our case",
    "we have used the following expression : @xmath13= - \\int_0^t dt \\ , \\alpha ( t ) \\epsilon^2(t).\\end{aligned}\\ ] ] if @xmath14 , @xmath12 would be minus the _ fluence _ , or integrated energy of the laser pulse",
    ". therefore , this term penalizes pulses with too high intensities .",
    "the function @xmath15 may then be chosen to ensure that the laser pulse is smoothly switched on and off , by penalizing non - zero field values near the beginning and the end of the pulse : @xmath16- { \\rm erf } \\bigg[t - t+\\frac{t}{20}\\bigg]\\right\\}^{-1}\\,,\\end{aligned}\\ ] ] where @xmath17 is the error function .    the search for the maxima of @xmath7 is substituted by the search for the maxima of @xmath8 , which however can not be unconstrained , since the evolution of the system must obey schrdinger s equation .",
    "the formalism takes care of this by introducing a lagrange functional : @xmath18=- 2 { \\ensuremath{\\mathfrak{re}}}\\bigg [ \\int_0^t { \\ensuremath{\\langle \\chi(t)| } } \\frac{\\partial } { \\partial t } + i h_0 -i \\mu \\epsilon(t ) { \\ensuremath{|\\psi(t)\\rangle } } \\bigg],\\end{aligned}\\ ] ] where the auxiliary state @xmath19 is introduced as a lagrange multiplier .",
    "the functional whose critical points are to be found is : @xmath20= \\mathcal{o}[\\psi ] + \\mathcal{f}[\\epsilon ] + \\mathcal{l}[\\psi , \\chi , \\epsilon].\\end{aligned}\\ ] ] the corresponding euler - lagrange equations are :    @xmath21 \\psi(t)\\ , , \\\\ \\label{eq : schrodinger_psi_0 } \\psi(0 ) & = \\psi_0 , \\\\ \\label{eq : schrodinger_chi } i \\frac{\\partial}{\\partial t } \\chi(t ) & = \\left [ h_0 - \\mu\\epsilon(t)\\right ] \\chi(t)\\ , ,   \\\\ \\label{eq : schrodinger_chi_0 } \\chi(\\bm{r},t ) & = \\frac{\\delta\\mathcal{o}}{\\delta \\psi^*(\\bm{r},t)}\\ , , \\\\ \\label{eq : control_field }   \\alpha(t ) \\epsilon(t ) & = -{\\ensuremath{\\mathfrak{im}}}\\ , { \\ensuremath{\\langle \\chi(t)|}}\\mu { \\ensuremath{|\\psi(t)\\rangle}}.\\end{aligned}\\ ] ]    equation   is merely schrdinger s equation for the system @xmath22 under the influence of the controlling laser @xmath23",
    ". it must be solved by _ forward _ propagation , since it is an initial value problem with boundary condition given by eq .  .",
    "equation   is also a schrdinger - like equation for the lagrange multiplier state @xmath19 .",
    "however , in this case it must be propagated _ backwards _ since the boundary condition is given at the final propagation time @xmath24 .",
    "finally , eq .   couples both @xmath22 and @xmath19 , and permits to obtain the solution laser field @xmath1 ( the dipole matrix element between states @xmath19 and @xmath22 is the principal ingredient ) .",
    "these equations are coupled , and their self - consistent solution provides the critical points of the functional @xmath7 . in order to find one solution that corresponds to a maximum , we have in this work utilized the monotonic algorithm described in ref .  .",
    "it consists of a series of back- and forward propagations . for other possible",
    "algorithms to solve eqs .",
    "- we refer the reader , for example , to refs .  .",
    "now we focus our attention to the precise form of the functional @xmath11 $ ] ( generally speaking , it is a functional of the full evolution of the wave function @xmath22 ; however in the previous equations we have assumed it depends only on the final state @xmath25 ) .",
    "as discussed in the introduction above , we will assume that it is a functional of the density @xmath26 and of the current density @xmath27 : @xmath28 = o[n[\\psi(t)],\\bm{j}[\\psi(t)]]\\,,\\ ] ] where @xmath26 and @xmath27 , for the one - electron case , read :    @xmath29(\\bm{r } ) & = \\psi^*(\\bm{r})\\psi(\\bm{r})\\ , , \\\\",
    "\\bm{j}[\\psi](\\bm{r } ) & = { \\ensuremath{\\mathfrak{im}}}\\ , [ \\psi^*(\\bm{r } ) \\bm{\\nabla } \\psi \\ , ( \\bm{r})]\\,.\\end{aligned}\\ ] ]    the particular form for @xmath30 given in eq",
    ".   leads to the following expression for the final - value condition for the auxiliary wave function @xmath19 [ eq .  ] : @xmath31\\cdot \\frac{\\delta o}{\\delta \\bm{j}(\\bm{r},t ) } \\,,\\end{gathered}\\ ] ]    this expression is valid for any target functional defined in terms of the density and its current .",
    "let us narrow it down for a particular case : we wish to maximize the overlap of the density @xmath26 with a target density @xmath32 ( at the end of the propagation ) .",
    "we may define for that purpose a first functional @xmath33 : @xmath34 = - \\int\\!\\ !",
    "d^3r \\,\\left [ \\sqrt{n(\\bm{r } ) \\vphantom { n_{\\text{tg } } } } -\\smash { \\sqrt{n_{\\text{tg}}(\\bm{r } ) } } \\right]^2 .",
    "\\end{aligned}\\ ] ] it ranges in the interval @xmath35 $ ] with its maximum at complete overlap . however , if we only use this functional , the resulting density at the end of the propagation will not be stable and change rapidly after the controlling field is switched off . in order to stabilize the achieved state , we may add a current dependent functional , making use of the fact that the temporal behavior of the density is connected with the current @xmath36 by the continuity equation : @xmath37 for any eigenstate of @xmath0 the divergence of the current vanishes , and the density remains constant .",
    "suppressing the current will assure a stationary density , at least right after the controlling pulse is switched off , and perhaps will ensure small variations thereafter .",
    "therefore we implemented an objective functional whose maximum is at zero current , namely : @xmath38=-w_c \\int\\!\\ !",
    "d^3r \\ , |\\bm{j}(\\bm{r})|^2.\\end{aligned}\\ ] ] here , @xmath39 is weighting the importance of the current suppression , which is useful if one combines the objectives in eqs . and : @xmath40 & = o[n[\\psi(t)],\\bm{j}[\\psi(t ) ] ]   \\\\ & =   o_1[n[\\psi(t ) ] ] + o_2[\\bm{j}[\\psi(t)]]\\,.\\end{aligned}\\ ] ] in this case @xmath41 should also homogenize the dimensions of the functionals .",
    "it only remains to rewrite eq .",
    "for this particular case : @xmath42 two remarks are in order before moving on to applications : first , instead of minimizing the current , we also applied this scheme to minimizing the divergence of the current , since this is the quantity to which the temporal behavior of @xmath26 is directly related by eq .",
    "however , the more stringent minimization of the total current turned out to be numerically preferable .",
    "finally , note that in the one - particle case , the wave function @xmath22 can be written as @xmath43 , and then the current density is given by @xmath44 . hence controlling the density and the current density amounts to controlling the full wave function directly , since both objects contain the same information .",
    "in the following , we present three illustrative examples of the method described above : electron transfer in both a 1d and a 2d asymmetric double well , and the @xmath45 transition in a 2d model of the hydrogen atom . in all calculations , there are a few parameters and settings whose values have an influence in the final outcome , most notably the value of the weight @xmath41 and the initial guess for the laser field . regarding the former , we observed that a value of around @xmath46 led to reasonable convergence and stable results . regarding the initial guess",
    ", we found it advisable to do several calculations with different starting points , since the search space contains many local minima .",
    "( color online ) 1d qw .",
    "the overlap between the controlled density @xmath26 and the target density @xmath32 is shown in the top panel . for minimized current ( @xmath46 ) the overlap with the target ( found in the inset ) at terminal time @xmath47",
    "is better .",
    "additionally , density @xmath26 is significantly more stable than without current control ( @xmath48 ) .",
    "the respective laser pulses are reported in the lower panel . ]",
    "we consider a 1d asymmetric double well , defined by the following potential function : @xmath49 which is sometimes used in quantum chemistry to model isomerisation processes  @xcite .",
    "note that even if we are usually referring to electronic processes and electronic densities and currents , it need not be the case , and the wave function may be that of a nuclear wave packet .",
    "the goal is to guide a transition from the ground state ( gs ) to a state whose density is equal to that of a superposition of the gs and the first excited state ( es ) , within a total time of @xmath47 a.u .",
    "we choose the superposition , @xmath50 whose corresponding density @xmath51 is illustrated in the inset of the top panel of fig .",
    "[ fig:1d_dens_diff ] .    as the target density @xmath52",
    "does not correspond to that of a stationary state , it is crucial not only to maximize the overlap according to eq .  , but also to minimize the current by setting @xmath46 in eq .  .",
    "the top panel of fig .",
    "[ fig:1d_dens_diff ] shows for the cases of @xmath46 and @xmath48 that a very good overlap is found at final time @xmath47  a.u .",
    "in fact , mapping the target functional values on the interval @xmath53 $ ] , we obtain @xmath54 for the first and @xmath55 for the second case . however , minimizing the current guarantees a significantly longer lifetime of the density in its target shape .",
    "the two respective laser fields are found in the bottom panel .",
    "a 2d asymmetric double quantum well can be realized by adding a parabola in the @xmath56-direction to the previous 1d potential : @xmath57 the top panel of fig .",
    "[ fig:2d_quwell_final_position ] displays the densities of the gs and the first es ( indicated as @xmath32 ) , both as 1d plots along the @xmath58-axis ( @xmath59 ) and as density plots in the @xmath60-plane ( in the insets ) .",
    "the objective of this example is to perform a density transfer from the gs to the es with and without suppressing the current , _",
    "i.e. _ with @xmath61 and @xmath48 , respectively .    as can be see in the top panel of fig .",
    "[ fig:2d_quwell_final_position ] both optimizations lead to a very good overlap with the target density @xmath32 at @xmath47  a.u .",
    "however , the intensities of the optimizing laser fields were rather different : in the case where the minimization of the current was enforced , the electric field was roughly half the size of its counterpart without current control .",
    "also , the behavior of the respective densities diverges considerably once the laser is switched off .",
    "this is illustrated in fig .",
    "[ fig:2d_quwell_differences ] where we show the difference between the target @xmath32 and the controlled density @xmath26 at two crucial points along the @xmath58-axis . while the top panel does so for the node of @xmath32 at @xmath62  a.u .",
    ", the bottom panel refers to its maximum at @xmath63  a.u .",
    "the requisite of current suppression induces much smaller oscillations of the controlled density around a value closer to the target .     along the @xmath58-axis ( @xmath59  a.u . ) .",
    "both optimizations achieve an excellent target density overlap .",
    "the insets show the respective 2d plots of the gs and es density .",
    "the bottom panel shows the optimal lasers . ]     and the target density @xmath32 as a function of time at the node ( @xmath62  a.u . , top panel ) and at the maximum ( @xmath63  a.u . , bottom panel ) of the target .",
    "the colored background marks the time @xmath64",
    "a.u . without laser .",
    "the insets in both panels are guides to the eye .",
    "they show the target density with a mark on the node and on the maximum , respectively . ]",
    "let us now consider a soft - coulomb 2d model of the hydrogen atom . in this case",
    "the objective is a stable density after a transfer from the @xmath66 gs to the @xmath67 es .",
    "the respective soft - coulomb potential reads : @xmath68 and is shown in the bottom panel of fig .",
    "[ fig:2d_h_stats ] .",
    "such soft potentials are used to model wannier excitons  @xcite , to describe multi - photon processes  @xcite and to understand strong laser fields better  @xcite .",
    "the densities of the initial and target state @xmath32 are shown in the top panel of fig .",
    "[ fig:2d_h_stats ] .    at final time @xmath69  a.u .",
    "the overlap of the controlled density @xmath26 with the target density @xmath52 is similar between the optimization with current suppression ( @xmath70 ) and without ( @xmath48 ) as shown in the top panel of fig .",
    "[ fig:2d_h_final_position ] .",
    "it is good for @xmath71  a.u .",
    "( especially if current suppression enforces a solution with a node at @xmath72  a.u . ) , while it remains unsatisfactory for @xmath73  a.u .",
    "we underline that this asymmetry in attaining the target is a consequence of persisting density oscillations as explained below .",
    "accordingly , the region of good overlap is periodically changing from on side of the @xmath58-axis to the other .",
    "nonetheless , this asymmetry is influenced by the initial guess laser field .",
    "in fact , conserving the frequency of the guess field , but changing the sign of its amplitude leads to the optimal laser with inverted sign .",
    "this `` negative '' optimal laser causes in turn exactly the opposite terminal configuration : with a good overlap for @xmath74  a.u . and poor overlap otherwise ( not shown ) .",
    "note that in terms of the objective functional the final density configuration and its `` mirrored '' counterpart are equally valid .",
    "the respective optimal lasers for @xmath70 and @xmath48 are plotted in the bottom panel .",
    "however , a substantial difference between the two optimal solutions can be seen in their behavior once the control is switched off .",
    "although we observe an oscillation of density between the two lobes in both cases , the minimization of the current leads to a significantly smaller rate of fluctuation .",
    "figure  [ fig:2d_h_cw40_vs_cw0 ] illustrates the difference between the controlled and target density at one maximum ( at @xmath75  a.u . , top panel ) and at the node ( at @xmath72  a.u . , bottom panel ) of @xmath32",
    "the difference between the target and the controlled density at the node is reduced by a factor of five in the case of minimized current .",
    "this means that this point of zero density is well represented if the current is held small .",
    "consequently , only a small portion of density can pass from one side to the other .",
    "indeed , oscillations of the difference at the maximum are halved if the current is suppressed .    a ( soft-)coulomb potential implies the presence of degeneracies and close - lying states , _",
    "e.g. _ the target state @xmath67 is degenerate in energy with @xmath76 , and a large number of energetically close states is available . therefore it is impossible to totally exclude a quantum mechanical superposition of states ( since the target is not a given state , but merely a given density ) , and this is the origin of the persisting oscillations in the optimal density . it is interesting to note that even our additional calculations that involved a target in terms of the wavefunction  @xcite lead to similar optimal solutions with the same problem .",
    "finally , we also stress that this kind of potential is fundamentally different from the potentials used in the quantum well examples , since it vanishes asymptotically ( and does not grow to infinity ) at large distances .",
    "numerically , this fact may imply the appearance of undesired border effects , and therefore we had to use a much larger radius for the simulation box ( @xmath77  a.u . ) .",
    "gs and the @xmath67 es along the @xmath58-axis ( @xmath59  a.u . ) , their 2d plots are shown in the inset .",
    "the target state has a node at @xmath72  a.u .",
    "the bottom panel shows the soft - coulomb potential @xmath78 along the @xmath58-axis ( @xmath59 ) . ]",
    "a.u . after an optimization with a control on the current ( @xmath70 ) and without ( @xmath48 )",
    "are reported in the top panel .",
    "only the @xmath70 case displays a good agreement with the target at the node .",
    "the bottom panel shows the respective optimal lasers . ]     and the target density @xmath32 as a function of time at a maximum ( @xmath75  a.u .",
    ", top panel ) and at the node ( @xmath72  a.u .",
    ", bottom panel ) of the target .",
    "current control with @xmath70 is important because it significantly reduces the oscillations and decreases the difference at the node by a factor of 5 .",
    "the left inset of the bottom panel shows the difference at the node for all times .",
    "the right insets in both panels are guides to the eye .",
    "they show the target density with a mark on the maximum and on the node , respectively . ]",
    "we have proposed the use of target functionals defined in terms of both the one - particle density and the current density for qoct calculations . in particular , we have shown the use of functionals that maximize the overlap of the controlled density with a given target density , and simultaneously minimizes the current , in order to stabilize the final state at the end of the action of the controlling laser pulse .",
    "such an objective fits very well into a tddft description of the system .",
    "a proof of concept was offered with three prototypical 1d and 2d systems . in these cases",
    ", we observed how the suppression of the current reduced quantum oscillations of the final state .",
    "d.  k. wants to thank lauri lehtovaara for useful discussions and enthusiastic suggestions .",
    "a.  c. acknowledges support from the research grant fis2009 - 13364-c02 - 01 ( micinn , spain ) .",
    "d.  k. and m.  a.  l.  m. acknowledge support from the french anr ( anr-08-cexc8 - 008 - 01 ) .",
    "calculations were performed at genci ( project x2011096017 ) .",
    "31ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) , , , , ,  and  ,  eds .",
    ",  @noop _ _  ( ,  ,  ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> quantum optimal control theory is a powerful tool for engineering quantum systems subject to external fields such as the ones created by intense lasers . </S>",
    "<S> the formulation relies on a suitable definition for a target functional , that translates the intended physical objective to a mathematical form . </S>",
    "<S> we propose the use of target functionals defined in terms of the one - particle density and its current . </S>",
    "<S> a strong motivation for this is the possibility of using time - dependent density - functional theory for the description of the system dynamics . </S>",
    "<S> we exemplify this idea by defining an objective functional that on one hand attempts a large overlap with a target density and on the other hand minimizes the current . </S>",
    "<S> the latter requirement leads to optimized states with increased stability , which we prove with a few examples of one- and two - dimensional one - electron systems . </S>"
  ]
}