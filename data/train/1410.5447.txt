{
  "article_text": [
    "modern chemistry can be regarded as the ( very successful ) effort of rationalizing the stability and reactivity of compounds in terms of chemical bonding.@xcite a theory that aims at predicting the structure and formation of chemical bonds from first principles can not disregard a more or less explicit quantum mechanical description of electrons . however , from a purely heuristic point of view , one could also interpret the recurrence of structural patterns , in terms of distances and angles between atomic nuclei , as a sign of the underlying chemical bond .",
    "in fact , chemical intuition builds on the possibility of recognizing these patterns and predicting whether and how they can be modified during a chemical reaction .",
    "electronic structure methods  from density - functional theory ( dft ) and hartree - fock to more accurate and demanding quantum chemistry approaches  make it possible to predict with great accuracy the structure and the stability of a molecule or a material from first principles,@xcite and empirical force fields have been parametrized to reproduce these results at a fraction of the cost.@xcite a computer simulation based on these techniques makes it possible to observe atomic configurations that are consistent with their energetic stability and the thermodynamic conditions , so in many cases the problem one faces in computational modeling is not so much to _ predict _ recurring structural patterns , as to _ recognize _ them in a clear , unbiased way .",
    "an excellent example of this kind of scenario is that of recognizing hydrogen bonds . since it was made popular by pauling,@xcite the concept of hydrogen bond has been a cornerstone in our understanding of water , biological systems and supramolecular aggregates.@xcite spanning a range of bond energies going from almost covalent bonds to van der waals interactions , hydrogen bonds can form and break easily at room temperature , explaining their importance for biological processes.@xcite while in most cases the hydrogen bond can be understood as an electrostatic effect  and simple empirical models based on point charges are capable of qualitatively reproducing the structure and energetics obtained with electronic structure methods  there are also examples in which one can recognize a strongly covalent character , which is often associated with quantum delocalization of the proton along the bond.@xcite because of their flexibility , hydrogen bonds escape an obvious , universal description , and several definitions exist based on somewhat arbitrary ranges of structural parameters@xcite and/or decompositions of the total energy obtained from electronic structure calculations.@xcite    this paper aims at introducing a general protocol to automatically analyze the outcome of an atomistic simulation , in order to recognize recurring structural patterns in a quantitative , deterministic and unbiased way . starting from a ( possibly ) high - dimensional description of groups of atoms , for instance the set of inter - atomic distances , we propose to infer a gaussian mixture model for the probability distribution of these initial coordinates . in order to obtain a deterministic , parameter - less partitioning of the probability density it is best to first apply a mode - seeking algorithm@xcite to perform a non - parametric clustering , and",
    "then to find the best gaussian fit to each mode of the distribution .",
    "one ( or more ) of the clusters can then be traced to the structural pattern(s ) of interest .",
    "what is more , this approach gives a natural out - of - sample probabilistic definition of a structural pattern , that can be used to identify the same patterns in new configurations of the system .",
    "we dub this algorithm pamm ( probabilistic analysis of molecular motifs ) , and describe in detail its rationale , functioning and implementation in section  [ sec : methods ] .",
    "we will then focus on the hydrogen bond as an instructive and challenging benchmark of our procedure , present several different examples in section  [ sec : results ] , and finally give our conclusions .",
    "the approach we introduce aims at using machine - learning algorithms to assist the interpretation of a computer experiment , and its rationalization in terms of recurring structural patterns and different forms of chemical bonding , automatically extracting information from the large data sets that are produced by atomistic simulations .",
    "we focus on using exclusively structural information to guide the analysis , partly because this is just more convenient than performing an energy decomposition analysis on top of an electronic structure calculation , partly because the ( free ) energetic stability of different molecular patterns is implicit in the frequency with which they appear in the simulation .",
    "we will formulate the discussion of the algorithm in very general terms , but use as a concrete example the case of the hydrogen bond in water , that we will discuss in more detail in section  [ sec : results ] .",
    "the analysis we propose is based on a preliminary atomistic simulation that produces configurations consistent with the energetics of the system of interest , and consists in three consecutive steps :    1 .   _ definition of the training set _ : after having performed a reference simulation , one has to introduce a ( possibly high - dimensional ) description of the groups of atoms that might be involved in recurring molecular patterns .",
    "this step yields a set @xmath0 that contains @xmath1 vectors of dimensionality @xmath2 , that represent molecular configurations observed in the simulation .",
    "a kernel density estimation is then used to evaluate the probability density that underlies the distribution of @xmath3 .",
    "determination of the mixture model _ : the probability density of @xmath3 is analyzed to recognize the different modes of the distribution , and to partition @xmath3 in @xmath4 disjoint clusters using the quick - shift algorithm  @xcite .",
    "these clusters are then used to build a gaussian mixture model , giving a probabilistic framework to associate regions of the @xmath2-dimensional space to one or more recurring patterns .",
    "analysis of the simulation _ : the mixture model can then be used to give qualitative and quantitative insight on the system being studied , and possibly as the basis for defining more complex orders parameters to describe and bias collective rearrangements of the various molecular patterns .",
    "a simple library to apply pamm to an arbitrary data set , and in the specific case of hydrogen - bond recognition is briefly discussed in appendix  [ app : pamm ] , and provided as open - source code in the supplementary materials ( sm)@xcite .",
    "simplified representation of the application of pamm to a simple two - dimensional dataset .",
    "( a ) a series of data points giving a ( possibly high - dimensional ) description of molecular patterns is taken as the input .",
    "( b ) a sparse grid of points is selected by a _ minmax _ algorithm , and a kernel - density estimation of the probability distribution is evaluated at each point .",
    "( c ) a _ quick - shift _ procedure is performed to assign each of the grid points to one of the modes of the probability distribution .",
    "( d ) clusters are determined based on the assignment to probability maxima .",
    "( e ) a gaussian mixture model is built by fitting separately a gaussian to each cluster .",
    "( f ) the posterior probabilities of the gaussian mixture model provide a natural , fuzzy definition of regions of parameter space that define recurring molecular patterns .",
    ", title=\"fig : \" ]      the analysis we propose starts by introducing descriptors of the relative arrangement of groups of atoms , for which one wishes to identify recurring patterns .",
    "if one wanted to recognize the existence of a bond between two atomic species , for instance , one could process the configurations from an atomistic simulation to output the list of distances between the pairs of atoms of the two species . for more complex structural patterns",
    ", one could pick all the possible tuples of atoms of a few selected species , and describe them in terms of all the pair - wise distances among them , possibly sorting groups of distances to account for the permutation of identical atoms  @xcite . in general , one would obtain a list of @xmath1 , @xmath2-dimensional vectors @xmath0 ( figure  [ fig : pamm](a ) ) that contains the descriptors for all of the tuples of selected atom kinds that are found in the simulation .",
    "for example , a putative hydrogen bond in water involves one hydrogen atom h and a donor oxygen atom o and an acceptor o@xmath5 .",
    "the three distances between these atoms suffice to determine completely the geometry of the group .",
    "the training data set @xmath3 could then be composed of 3-dimensional vectors",
    "@xmath6 @xmath7 @xmath8 , each describing the configuration of a triplet of atoms that could possibly form a hydrogen bond .",
    "one can then use the data set @xmath3 to evaluate an estimate of the underlying probability distribution @xmath9 . since the @xmath1 points are distributed irregularly , and the possibly very high dimensionality of the data set makes it impractical to define the probability density on a regular grid , we used kernel density estimation ( kde ) @xcite to compute an estimate of @xmath9 .    for computational efficiency , we first selected a sub - set of the data samples @xmath10 using a _ minmax _",
    "criterion.@xcite we chose a first point @xmath11 at random , and then iterated @xmath12.\\ ] ] each new point is the sample with the maximal minimum distance to the points that had already been selected .",
    "the procedure was repeated until @xmath13 points had been chosen , forming a sparse grid on which the probability is to be estimated ( figure  [ fig : pamm](b ) ) .",
    "we found that @xmath14 gives a good compromise between the density of the @xmath15 grid and the computational cost of the procedure ( see the supplementary information for a discussion of the sensitivity of the method to this and other parameters ) .    the kernel density estimate on each grid point",
    "is defined as @xmath16 where we used a gaussian kernel @xmath17 and we introduced for each sample a weight @xmath18 and an adaptive kernel width @xmath19 .",
    "the weights can be for instance defined to compensate for the trivial dependence of the probability density on the phase space volume due to the definition of the tuples , i.e. @xmath20 , where the weight function is defined so that a random distribution of atoms would give a constant @xmath21 normalization that is used to define the radial distribution function between a pair of atoms based on the histogram of the pairwise distances @xmath22 . ] .",
    "the method does not depend dramatically on the choice of the kernel width , but we found it convenient to define automatically an adaptive width as follows .",
    "for each of the grid points we evaluated the minimum distance of the surrounding grid points , @xmath23 .",
    "we then associated each of the sample points @xmath24 to the nearest grid point @xmath25 , and set @xmath26 . associating each sample point to the nearest grid point",
    "is also useful to speed up the evaluation of eq .",
    ", as one can restrict the evaluation of the density kernel to points that are associated with the grid sites within a reasonable cut - off distance .",
    "having computed the kernel density estimation of @xmath27 , we could then proceed to subdivide it in distinct clusters , that will be associated to one or more recurring molecular patterns .    in order to fulfill our goal of having a univocal , deterministic pattern recognition ,",
    "we opted for a non - parametric clustering of @xmath21 based on mean shift  @xcite , a method that identifies the modes of the probability distribution and subdivides sample points by following steepest ascent paths starting from each point and clustering together the paths that converge onto the same local probability maximum .",
    "this approach has a profound physical interpretation : each probability maximum corresponds to a minimum in the free energy associated with the @xmath2-dimensional description of the group of atoms .",
    "each of the clusters then corresponds to a meta - stable configuration .    for this application",
    ", we found that the most efficient and stable variant of the mean shift idea was the _ quick shift _ algorithm  @xcite .",
    "given a set of data points and an estimate of the density at each point ( @xmath25 and @xmath27 in our case ) , quick shift builds a tree in which each data point is a node , and the root is the point with the highest density . starting from each point ,",
    "one connects it to the nearest point that has larger probability density , i.e. @xmath25 is connected with the @xmath28 such that @xmath29 the procedure defined by eq",
    ".   will always end at the grid point with the highest associated probability density . in order to obtain individual modes of @xmath21",
    ", one can introduce a length scale @xmath30 , and stop moving to points with higher @xmath31 whenever one can not find one within @xmath30 of the current point .",
    "we found it convenient to set @xmath32 , where the @xmath33 are the kernel widths associated with the grid points .",
    "the sm  @xcite . ] . by setting a cutoff for the step length ,",
    "quick shift identifies a set of @xmath4 local maxima @xmath34 , and partitions @xmath15 into @xmath4 disjoint sets @xmath35 based on the maximum to which a quick shift procedure started at each @xmath25 converges to ( figure  [ fig : pamm](c ) and ( d ) ) .",
    "one could then use the sets @xmath35 to define a non - parametric estimate of the cluster probabilities .",
    "we decided however to use them to define a gaussian mixture model in which each cluster corresponds to one of the sets . using mean shift . ]",
    "gaussian mixture models@xcite are a particularly convenient approach to parametrically fit the probability distribution as a sum of @xmath4 multivariate gaussians , @xmath36 where @xmath37 is the fraction of density belonging to the @xmath38-th gaussian ( the relative weight of the cluster ) , @xmath39 is its covariance matrix and @xmath40 the mean : @xmath41    fitting a parametric model such as   to the probability density lends itself quite naturally to a probabilistic interpretation in which each gaussian function corresponds to a cluster , so that one can evaluate the probability that a point @xmath42 belongs to the @xmath38-th cluster as @xmath43 in the context of the present work , if we associate one of the gaussian clusters of the density of sample points with the configuration pattern that we are trying to recognize , this cluster probability provides a very natural , fuzzy definition of the region of parameter space associated with the recurring pattern .",
    "@xmath44 varies smoothly between zero ( configurations that clearly differ from the tagged cluster ) to one ( configurations that are undoubtedly to be assigned to the cluster ) , with intermediate values representing the `` gray zone '' at the margins of the cluster .",
    "for instance , as we shall see in section  [ sec : results ] , if one can assign the @xmath38-th mode of @xmath45 to hydrogen - bonded configurations , @xmath46 would give a data - driven hydrogen - bond count function , that would have a smooth transition between a value of 0 for non - hydrogen - bond configurations to 1 for configurations that clearly belong to the hb region of parameter space .",
    "it is customary to train gaussian mixture models by fitting the parameters @xmath47 , @xmath40 , @xmath39 so as to maximize the log - likelihood of the model given the underlying density @xmath27 , @xmath48 this idea has been exploited before in the context of atomistic simulations , see e.g. refs .",
    "we found however this procedure to be unreliable for our purposes : the optimized parameters depend dramatically on the number of clusters included in the model and on the initial values assigned to the parameters .",
    "furthermore , if the modes of the probability distribution are not well described by gaussians , it is often the case that more than one gaussian is needed to describe each cluster , requiring further fine - tuning of the model .    to avoid this ambiguity ,",
    "we did not obtain the gaussian parameters by optimizing the log - likelihood of the model , but rather took one gaussian for each of the clusters identified by quick shift , setting its mean at the maximum of the probability distribution and its covariance based on the distribution of the cluster members @xmath35 ( figure  [ fig : pamm](e ) ) : @xmath49 this choice combines the simplicity of a gaussian mixture model , the fuzzy , smooth nature of the cluster probabilities  , and the robust , deterministic partitioning of the probability density obtained with quick shift .",
    "a critical analysis of the outcome of the quick shift partitioning of the probability density makes it possible to associate each cluster with a structural pattern , as described by the @xmath2 dimensional vector introduced in the first phase of our procedure . in many cases  such as the example of the hydrogen bond that we will discuss further below ",
    "one cluster stands out clearly as the distinct structural feature one is interested in , and one can focus further analysis on a single mode using the associated conditional probability function  . for simplicity",
    "we will consider the selected cluster to be the one labeled by @xmath50 .",
    "the most direct application of the definition embodied by @xmath51 is to use it to test whether tuples of atoms @xmath52 match the definition of the structural pattern by computing @xmath53 if the components of @xmath42 are continuous functions of the atomic coordinates , @xmath54 is a smooth continuous function too , that takes a value close to 1 whenever a group of atoms matches the target pattern ( figure  [ fig : pamm](f ) ) .",
    "this makes our definition of a pattern recognition function well - suited for use as a collective variable in accelerated sampling methods,@xcite possibly in conjunction with other machine learning techniques to characterize the overall connectivity induced by the selected molecular pattern  @xcite , or similar fingerprint metrics that are guaranteed to distinguish dissimilar structures  @xcite .",
    "the pamm variables corresponding to different structural descriptor can also be analyzed to yield a coarse - grained , low - dimensional map  @xcite .",
    "if necessary , one can artificially `` soften '' the transition between clusters , by dividing _",
    "all _ the covariance matrices @xmath55 in the gaussian model by a scaling factor @xmath56 .",
    "since the @xmath57 s effectively count the instances of the structural pattern that are present at any given time in the trajectory , one can also combine several of these indicators together to count the number of patterns that involve a tagged atom @xmath58 , or pair of atoms @xmath59 : @xmath60 depending on the application being considered , @xmath61 can be taken to represent the total coordination of the atom @xmath58 , @xmath62 the overall bonding between atoms @xmath58 and an atom @xmath63 , and so on .",
    "for instance , by summing over all the possible acceptor atoms o@xmath5 and hydrogen atoms h , one can get a smooth count of the total number of hbs donated by a selected oxygen o.",
    "the pamm framework we have introduced in the previous section is very abstract , and can be applied to any situation in which one wishes to recognize recurring motifs in an atomistic simulation . to demonstrate its application in a practical case , we chose to focus on recognizing the hydrogen bond ( hb ) in a number of different contexts .",
    "the term `` hydrogen bond '' refers to a highly directional three - centers interaction between two polar atoms and a hydrogen.@xcite the hydrogen atom h is covalently bound to one of the polar atoms , which is designated as the donor d , and points towards the second polar atom which is designated as the hb acceptor a. despite the apparent simplicity of the concept , it is not easy to develop an universal definition of the hb , mostly because this entity has been used in many different contexts .",
    "the term has been associated to near - covalent interactions with an energy in excess of 30 kcal / mol , as well as to exceedingly weak ones with an energy of less than one kcal / mol .",
    "typically hydrogen bonds are understood to have a predominantly electrostatic nature , with strongly electronegative donors and acceptors such as f , o or n. however , the observation of recurring c ",
    "h@xmath64o units in the secondary structure of polypeptides have also been interpreted in terms of weak hbs , that have been suggested to play a significant role in stabilizing proteins.@xcite    adding to the complexity of the broad energy scale covered by hbs is the fact that in most situations of interest thermal fluctuations and the environment modulate their stability , and that they are formed and destroyed on a relatively short time scale .",
    "one sees the difficulty in giving a clear - cut definition of a chemical entity which exhibits such a variability .",
    "the most generally applicable definitions rely on performing an electronic structure calculation , and on decomposing the energy of the systems in a sum of terms that can be interpreted as the binding energy of putative hbs.@xcite definitions that are based solely on structural information are much more practical , in that they do not require a supporting electronic structure calculation and can be applied to experimental structural data or to atomistic simulations based on empirical forcefields .",
    "the downside is that these structural definitions invariably contain a degree of arbitrariness , as they are based on the heuristic introduction of ranges of structural parameters that are deemed to represent a hydrogen bond in a given context.@xcite kumar _ et al .",
    "_ carried out a systematic comparison of many of these structural definitions in the case of liquid water,@xcite and recognized that the best way to assess whether a given definition makes physical sense is to compare the probability distribution of the structural parameters with the range of values associated with the hydrogen bond .",
    "the pamm algorithm we have introduced in section  [ sec : methods ] makes this probabilistic analysis the very basis of the construction , automatically determining the range of structural parameters that corresponds to one of the modes of the distribution .",
    "the data itself informs the definition of a range of parameters that identify unambiguously hydrogen - bonded configurations , and naturally describes smoothly the transition between this region and configurations that are clearly not hydrogen bonded . even though this definition is by construction system - specific , the protocol to obtain it is univocal and unbiased , as it does not rely on choosing manually threshold values for the structural parameters .",
    "the first steps in the application of pamm are the identification of groups of atoms that should be tested for recurring patterns and the choice of structural parameters that describe the arrangement of atoms within each group . in the case of the hb , these choices are fairly obvious",
    ". one should select an atomic species that should be considered as the putative hb donor d , one that should be considered as the acceptor a and ( a subset of ) the hydrogen atoms that complete the hb triplet .",
    "the geometry of each of these groups is completely determined by the three distances @xmath65 , @xmath66 and @xmath67 . to simplify comparison with other definitions , and to highlight the symmetries inherent in the problem",
    ", we decided to use combinations of these distances , namely the proton - transfer coordinate @xmath68 , the symmetric stretch coordinate @xmath69 and the acceptor - donor distance @xmath70 as the group descriptors .",
    "we computed these @xmath71 triplets for each d - h - a group present in each snapshot extracted from the simulations , thereby obtaining the training data set @xmath3 that we used to run pamm . in building the probability distribution ,",
    "each point was weighed by a factor @xmath72^{-1}$ ] , that accounts for the trivial phase space volume so that a uniform distribution of atoms would yield a constant probability density in @xmath71 .",
    "let us begin our analysis by considering the case of an empirical forcefield model of alanine dipeptide ( n - acetylalanine - n-methylamide )  one of the simplest examples of peptide bonding , displaying many of the essential features that are present in proteins . in our case , it is an ideal test case , as it allows us to demonstrate the functioning of pamm for different kinds of hydrogen bonds .",
    "we will consider hbs donated by water molecules to the carbonyl of alanine o@xmath73 , hbs donated by the peptide nitrogen to the oxygens in water o@xmath74 , and investigate the significance of a more exotic , weak hb donated by the peptide c@xmath75 to the o@xmath74 atoms .",
    "we used the charmm27 forcefield@xcite to describe interactions within the polypeptide and a tip3p model for the water molecules,@xcite with flexible bonds modelled as harmonic stretches , as implemented in lammps.@xcite we equilibrated a supercell containing 128 water molecules in the _ npt _ ensemble , and ran subsequently 600  ns of _ nvt _ molecular dynamics using a langevin thermostat with a time constant of 10  ps.@xcite the configurations were saved every 1  ps .",
    "an example input file is provided in the sm@xcite .",
    "( upper panel ) distribution of @xmath71 configurations for o@xmath74h@xmath64o@xmath73 in a simulation of alanine dipeptide in water .",
    "size and opacity of points correspond to the kde of @xmath76 , and colors indicate the cluster each grid point has been assigned to .",
    "( lower panel ) free energy ( kcal / mol ) computed from the distribution of number of accepted hydrogen bonds @xmath77 for the oxygen atom in the carbonyl group in solvated alanine dipeptide .",
    "the histogram was smoothed with a triangular kernel of width 0.025 .",
    "we also report the integrated probabilities for for having @xmath78 , @xmath79 and so on .",
    "the average number of accepted hbs is @xmath80 and the standard deviation is 0.6 . ]    the first kind of hb we considered is o@xmath74h@xmath64o@xmath73 . to accelerate the analysis we only included configurations with @xmath81 .",
    "figure  [ fig : ala - oho ] shows the distribution of the values of @xmath71 , colored according to the partitioning of the density obtained by running pamm on the data set .",
    "several clusters are recognized , which means that besides hbs there are other recurring patterns that can be distinguished by this analysis .",
    "one of these clusters  represented with an orange hue  can be seen by direct inspection of configurations ( or by comparison with other structural definitions ) to correspond clearly to hydrogen - bonded configurations . as discussed in section  [ sec : methods ] we used the gaussian - mixture model built based on the clustering to define the degree of confidence @xmath82 by which we classify a certain configuration of a d donor , h hydrogen and a acceptor as a hydrogen bond , and then introduce a count of the total hbs that involve a given acceptor oxygen @xmath83 .",
    "the free energy built from the histogram of @xmath77 is represented in the lower panel of figure  [ fig : ala - oho ] .",
    "the free energy is strongly peaked at integer values of @xmath77 , because the transition between 0 and 1 is very sharp when a hydrogen bond is formed or broken .",
    "this plot shows clearly that most of the time the carbonyl is involved in receiving two hydrogen bonds , but there is also a fairly large probability of accepting one or three bonds",
    ". it would be interesting to compare these results with first - principles simulations of solvated alanine dipeptide , to verify whether the possibility of forming over and under - coordinated configurations is a consequence of the simplified modelling of the interactions between water molecules and the carbonyl .",
    "( upper panel ) distribution of @xmath71 configurations for n  h@xmath64o@xmath74 in a simulation of alanine dipeptide in water .",
    "size and opacity of points correspond to the kde of @xmath76 , and colors indicate the cluster each grid point has been assigned to .",
    "( lower panel ) free energy ( kcal / mol ) computed from the distribution of number of donated hydrogen bonds @xmath84 for the amide nitrogen atom in solvated alanine dipeptide .",
    "see fig .",
    "[ fig : ala - oho ] for details .",
    "the average number of donated hbs is @xmath85 and the standard deviation is 0.5 . ]",
    "we then moved on to look into the hydrogen bond donated by the amide group n  h@xmath64o@xmath74 . since the chemical identity of atoms",
    "is fixed in an empirical force field calculation , we specifically restricted the search to include only the amide h atom and oxygen atoms from the water molecules .",
    "we used a cut off of @xmath86 to disregard configurations that are clearly irrelevant to the hb search .",
    "we report the distribution of configurations and the pamm clustering in figure  [ fig : ala - nho ] .",
    "perhaps unsurprisingly , the distribution of @xmath71 associated with this set of atoms differs considerably from that in figure  [ fig : ala - oho ]  this is a somewhat weaker bond , which results in a less structured @xmath45 . still , one can recognize a cluster that is clearly associated with hb configurations , that we can use to define a bond counting order parameter , that in turns can be used to compute the total number of hydrogen bonds donated by the n atom , @xmath87 . while the most likely value of @xmath84 is one",
    ", there is a high probability of observing a n  h group donatinhg two hbs .",
    "given the geometry of the amide group , this actually means that based on our unbiased , self - consistent definition , hbs donated by the amide group as described by the empirical forcefield we used have a large probability of being bifurcated , binding simultaneously to two different water molecules .",
    "( upper panel ) distribution of @xmath71 configurations for c@xmath75h@xmath64o@xmath74 in a simulation of alanine dipeptide in water . size and opacity of points correspond to the kde of the @xmath76 , and colors indicate the cluster each grid point has been assigned to .",
    "( lower panel ) free energy computed from the distribution of number of donated hydrogen bonds @xmath84 for the amide carbon atom in solvated alanine dipeptide .",
    "see fig .",
    "[ fig : ala - oho ] for details .",
    "the average number of donated hbs is @xmath88 and the standard deviation is 1.1 . ]    finally , to verify how the pamm algorithm behaves when applied to a selection of atoms that does not exemplify a typical hydrogen bond , we considered atom triplets that would correspond to a c@xmath75h group donating a hb to water .",
    "figure  [ fig : ala - cho ] shows the partitioning of the probability density for this choice of atoms , which has some features that are reminiscent of those seen for conventional hbs , albeit with a much longer @xmath89",
    ". a more careful inspection of configurations that belong to the lobe of the probability density with the lowest @xmath90 , however , shows that these can hardly be described as hbs : in many cases the hydrogen atoms of water molecules are oriented _ towards _ the c@xmath75h group , and the distribution of @xmath91 shows very little structure .",
    "this example demonstrates that the presence of a recurring structural motif with a signature in terms of the probability distribution in configuration space does not necessarily imply that the atoms that compose the motif are involved in some sort of chemical bonding . here , the non - uniform structure of oxygen atoms in the vicinity of the c@xmath75h group is probably an indirect consequence of the hydrogen - bond interaction of water molecules with nearby carbonyl groups , and of the stiffness of the backbone of the dipeptide .",
    "distribution of @xmath71 configurations for o  h@xmath64o@xmath5 in a simulation of neat tip4p water .",
    "size and opacity of points correspond to the kde of @xmath76 , and colors indicate the cluster each grid point has been assigned to .",
    "clusters with @xmath92 have not been colored , but have been correctly identified by pamm . ]    simulations of alanine dipeptide contain different kinds of hydrogen bonds , and allowed us to demonstrate the adaptive nature of pamm to derive a different , data - driven definition of the range of structural parameters that can be associated with a hb for each set of constituent atoms . in a simulation of neat water , instead , there is only one type of o ",
    "h@xmath64o@xmath5 , the slight complication being that each oxygen atom can simultaneously act as a donor and an acceptor of hydrogen bonds .",
    "[ [ tip4p - water . ] ] tip4p water .",
    "+ + + + + + + + + + + +    we began by analyzing a simulation of a flexible tip4p/2005f@xcite model .",
    "a box containing 128 water molecules was first equilibrated for 2  ns at constant pressure ( 1 atm ) , constant temperature ( 298 k ) _ npt _ dynamics . a subsequent 500  ns _ nvt",
    "_ run was performed using a langevin thermostat with relaxation time @xmath93=5  ps . the configurations were saved every 1  ps . in the spirit of a fully automated analysis of the trajectory , we did not exploit knowledge of the chemical identity of water molecules , which is fixed in a simulation with a non dissociable model .",
    "the distribution of @xmath71 shows clearly the dual role played by the o atoms ( see figure  [ fig : h2o-3d ] ) , which is apparent in the symmetry of the probability density across the @xmath94 plane .",
    "both the cluster highlighted in orange and its mirror image correspond to legitimate hb configurations , but only the former corresponds to structures in which the first oxygen is acting as the donor and the second as the acceptor .",
    "hydrogen - bond counts statistics for a classical simulation of tip4p water at room temperature .",
    "all the probability distributions have been smoothed with a triangular kernel of width 0.025 , and are represented in terms of the associated free energies @xmath95 , that are expressed in kcal / mol throughout .",
    "we also report integrated probabilities ( in percent ) to have a configuration in the vicinity of the different integer numbers of hbs . below the values of the joint probabilities of @xmath77 and @xmath84 the product of marginal probabilities are indicated , in italics . ]",
    "once @xmath82 has been defined based on the analysis of the simulation data , it can be used to characterize in great detail how a given model of water describes hydrogen bonding .",
    "figure  [ fig : h2o - tip4p - cls ] summarizes some of the information that can be obtained from this analysis .",
    "one can compute free energies for the number of hydrogen bonds donated ( @xmath84 ) or accepted ( @xmath77 ) by each oxygen atom , as well as for the total ( @xmath96 ) and for the number of hbs that are formed by each hydrogen .",
    "a large fraction of tip4p water molecules are tetracoordinated , with nearly 65% of oxygen atoms receiving and donating two hbs .",
    "there is a small but significant asymmetry between the distribution of @xmath84 and that of @xmath77 , the former being more strongly peaked at @xmath97 , while there is somewhat more flexibility in the count of accepted bonds .",
    "given the rigid constraints on the covalent o ",
    "h bond , any oxygen in the simulation can donate two bonds at most , except for the case of bifurcated hbs where a single o ",
    "h moiety is involved with bonds to two different o@xmath5 atoms .",
    "the distribution of @xmath98 shows that there is just about 2% probability of observing such bifurcated bonds .",
    "more detailed information on the topology of the hb network can be obtained by observing the joint probability distribution of @xmath84 and @xmath77 .",
    "while the order of magnitude of the probability of each joint configuration is determined by the product of @xmath84 and @xmath77 , there are significant deviations that are indicative of the correlations between defects in the network .",
    "for instance , the probability of having a `` linear '' water that donates and accepts a single hb is almost twice the value that would be expected based on the product of the marginal distributions .",
    "note that this analysis focuses on the connectivity of the network rather than on the geometry of the environment of each water molecule .",
    "an interesting way to extend this analysis could consider the correlation between the hb counts and the degree of tetraedrality , with the electronic structure , or with quantities that can be directly related to experimental observables .",
    "( upper panel ) time correlation functions of the hydrogen - bond counts for a tagged oxygen in a simulation of tip4p/2005f water .",
    "( lower panel ) rate function for the hydrogen - bond formation / break - up , computed as the derivative of the correlation function @xmath99 ]    [ [ dynamics - of - the - hb - network . ] ] dynamics of the hb network .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    the asymmetry between @xmath77 and @xmath84 is also apparent when one considers the dynamical behavior of the two quantities .",
    "the upper panel of figure  [ fig : h2o - nhb - acfs - tip4p ] shows the correlation functions for the counts of acceptor and donor hbs for a tagged oxygen , as well as the total .",
    "they were computed analyzing several short _ nve _ simulations started from independently equilibrated configurations .",
    "the correlation time of @xmath84 is very short , because configurations where a water molecule donates less or more than two hbs are very short - lived .",
    "configurations that are distorted from the point of view of accepted hbs are less unstable , and therefore the correlation function of @xmath77 decays more slowly .",
    "the correlation function of the total is dominated by the slow decay of @xmath77 , and is compatible with the results reported in ref.@xcite for traditional structural definitions of the hydrogen bond .",
    "the hydrogen - bond count functions we have used this far do not consider the identity of individual bonds , so that a quick fluctuation that momentarily breaks a hb that is immediately re - formed is indistinguishable from a fluctuations that breaks a hb and leads immediately to the formation of a new hb with a _ different _ acceptor oxygen .",
    "a correlation function that is sensitive to the identity of the hb triplet , which is more easily interpreted in terms of physical observables,@xcite can be readily computed by considering all the @xmath100 pairs , computing for each pair @xmath101 .",
    "one can then compute the rate function as the time derivative of the autocorrelation of @xmath102 , computed for each pair separately : @xmath103 the decay takes place on a similar time scale than observed in ref .",
    "@xcite , and exhibits similar features , including the presence of multiple time scales in the decay of the rate function .",
    "hydrogen - bond counts statistics for a classical simulation of blyp water at room temperature .",
    "see the caption of figure  [ fig : h2o - tip4p - cls ] for a detailed explanation of the plots . ]",
    "[ [ hydrogen - bonding - defects - in - ice - ih ] ] hydrogen - bonding defects in ice ih + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the consistency of the results obtained with pamm descriptors of the hydrogen bond and those obtained with more conventional descriptors is reassuring .",
    "it is however useful to verify the behavior of indicators such as @xmath77 and @xmath84 in a more ordered environment such as the tetrahedral hydrogen - bond network of ice ih , in which one should be able to identify clearly coordination defects .",
    "a ) schematic representation of how a pair of bjerrum defects are generated by flipping the orientation of a water molecule in a lattice that satisfies the ice rules . by flipping other molecules ,",
    "the l and d defects can be separated .",
    "b ) and c ) configurations of equilibrated l and d defects in ice ih .",
    "oxygen atoms with @xmath104 are colored in red , atoms with @xmath105 are colored in blue , while atoms with @xmath106 are in white , or hidden for clarity .",
    ", title=\"fig : \" ]     to this aim , we have performed a pamm analysis of a simulation of ice ih , using the same flexible tip4p model discussed above , and a proton - disordered unit cell with 768 molecules  @xcite .",
    "we have then created a pair of bjerrum coordination defects  @xcite , and separated them by the maximum distance allowed by the simulation cell , by repeatedly flipping water molecules in the lattice ( figure  [ fig : bjerrum](a ) ) .",
    "we have then equilibrated the simulation for a few tens of ps , collected some snapshots of the configurations and evaluated @xmath77 and @xmath84 for each oxygen .",
    "the vast majority of the o atoms have @xmath106 , as one would expect in a perfect tetrahedral arrangement consistent with the ice rules .",
    "we could however identify clearly a pair of oxygen atoms with @xmath104 ( a l defect ) , and a pair with @xmath105 ( a relaxed d defect ) .",
    "snapshots of these defective environments are represented in figure  [ fig : bjerrum ] .    [",
    "[ classical - ab - initio - water . ] ] classical _ ab initio _ water .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    we then moved on to perform our analysis on a first - principles simulation of liquid water .",
    "the trajectory is the classical simulation from ref .",
    "@xcite , which was performed using the cp2k software package,@xcite with a blyp exchange - correlation functional@xcite and a dzvp basis set .",
    "the simulation box contained 64 water molecules at the experimental density , and 100  ps of _ nvt _ dynamics were performed , with the first 5  ps discarded for equilibration .",
    "a pamm analysis of the simulation yielded very similar clusters to those obtained from tip4p water .",
    "the analysis of hb counts , in figure  [ fig : h2o - blyp - cls ] , shows that blyp water has a very regular structure , with a higher count of tetracoordinated oxygen atoms , and a very low count of defective structures .",
    "this is consistent with the well - known observation that generalized - gradient approximation models of water are overstructured compared to experiment and to empirical water models .",
    "note that correlations in the hb network are stronger in this case than for tip4p water , with one - donor / one - acceptor oxygen atoms being four times more likely than one would expect given the separate probabilities of @xmath107 and @xmath108 .",
    "hydrogen - bond counts statistics for a piglet simulation of blyp water at room temperature .",
    "see the caption of figure  [ fig : h2o - tip4p - cls ] for a detailed explanation of the plots . ]",
    "[ [ quantum - ab - initio - water . ] ] quantum _ ab initio _ water .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    finally , we considered a simulation that used the piglet technique to introduce nuclear quantum effects@xcite on top of a first - principles description of the electronic structure , analogous to the one used for the classical trajectory described above . to achieve convergence of quantum properties",
    ", 6 beads were used together with a custom - tailored generalized langevin equation thermostat,@xcite as implemented in the i - pi python interface.@xcite the overall statistics of the hb network ( figure  [ fig : h2o - blyp - nqe ] ) are not dramatically changed by nuclear quantum effects , that only enhance marginally the probability of distorted configurations , with a decrease of ideal @xmath109 configurations and an increase of bifurcated hydrogen bonds .",
    "these are not however substantial changes , and are in part due to the fact that quantum fluctuations make the pamm definition of @xmath82 less clear - cut than in the classical case .    defining hbs with a method such as pamm ,",
    "that does not make any assumption on the covalent bonds present in the system , is particularly convenient in a context such as the present one .",
    "extreme quantum fluctuations of protons along the hydrogen bond lead to transient formal autolysis events , where the hydrogen atom detaches from the donor atom and reaches out to be closer to the acceptor oxygen.@xcite from a structural standpoint , pamm does not recognize a distinct cluster corresponding to these distorted configurations , but rather a continuum of structures .",
    "starting from a o@xmath110h@xmath64o@xmath111 bond where the hydrogen atom is covalently bound to o@xmath110 , one goes smoothly through distorted donated hydrogen bond to a configuration that is formally classified as a distorted bond _ accepted _ by o@xmath110 and _ donated _ by o@xmath111 .",
    "these fluctuations conserve the total number of hbs between the two oxygen atoms , and only change their character from donated to accepted .",
    "these excursions are apparent in the joint probability distribution of @xmath84 and @xmath77 , where they show up as regions with higher probability extending diagonally between two near - integer @xmath112 regions .      as a final example , we considered liquid ammonia at 180k and ambient pressure .",
    "configurations were kindly provided by joshua more and david manolopoulos.@xcite simulations were performed including nuclear quantum effects by path integral molecular dynamics , using 12 beads and piglet@xcite as implemented in i - pi.@xcite quantum espresso@xcite was used as the force back - end , with a pbe exchange - correlation functional@xcite and ultra - soft pseudo - potentials.@xcite the simulation box contained 32 molecules , and trajectories were performed for 10ps at constant , experimental density , with the first 2  ps discarded for equilibration .",
    "distribution of @xmath71 configurations for o  h@xmath64o@xmath5 in a simulation of liquid blyp ammonia at 180k .",
    "size and opacity of points correspond to the kde of @xmath76 , and colors indicate the cluster each grid point has been assigned to .",
    "clusters with @xmath92 have not been colored , but have been correctly identified by pamm . ]",
    "ammonia is a less - structured liquid than water , with weaker hydrogen bonds , as it is already apparent from the probability density shown in figure  [ fig : ammonia-3d ] .",
    "clusters are barely recognizable when using a two - dimensional @xmath113 representation , which was instead capable of characterizing the hb in all the other cases we considered . clustering is much more evident using the three - dimensional @xmath71 description , and pamm identifies clearly a range of values that can be ascribed to hydrogen - bonded configurations .",
    "we expect the observation that higher - dimensional descriptors offer increased discriminating power to be general , and provide a strategy to resolve weakly structured systems . however , as the dimensionality is increased it becomes more difficult to converge the probability distribution , so longer simulations are needed and pamm becomes more sensitive to the parameters of the procedure . as it is the case for oxygen in h@xmath111o ,",
    "nitrogen atoms act both as donors and acceptors , leading to a symmetric structure for @xmath45 .",
    "hydrogen - bond counts statistics for a piglet simulation of blyp liquid ammonia at 180k .",
    "see the caption of figure  [ fig : h2o - tip4p - cls ] for a detailed explanation of the plots . ]",
    "figure  [ fig : ammonia ] shows the analysis of the distribution of @xmath84 , @xmath77 and @xmath98 . despite the low temperature , the weaker and less directional hbs result in a less clear - cut distribution of hb environments .",
    "a little more than 50% of the nitrogen atoms receive and donate 3 hbs  the ideal hb pattern that is observed in the solid phases of ammonia .",
    "even though the simulation included nuclear quantum effects , there is no trace of the diagonal patterns that are a manifestation of extreme proton excursions along the hydrogen bond .",
    "molecules maintain strictly their chemical integrity , and from a structural standpoint these weak hbs appear to have a purely electrostatic character .",
    "the probabilistic analysis of molecular motifs algorithm we have introduced attempts to reproduce in an automatic , data - driven manner the process of recognizing recurring structural patterns that is behind our intuitive understanding of chemical bonding .",
    "it first performs a non - parametric partitioning of the probability distribution that characterizes the arrangement of a selected group of atoms in an atomistic simulation of a material or a compound .",
    "it then proceeds to model the clusters with a gaussian mixture model that provides a natural , fuzzy definition of a chemical entity in terms of a smoothly varying posterior probability .",
    "we demonstrate the effectiveness of this approach by applying pamm to recognize an ubiquitous but hard to define entity as the hydrogen bond in a variety of different contexts . for each d",
    " h@xmath64a triplet of atoms , pamm automatically identifies an appropriate range of structural parameters that provides an unbiased , agnostic definition of what constitutes a hydrogen bond for a given set of atoms and a particular atomistic model . in the case of an empirical forcefield model of solvated alanine dipeptide",
    "it identifies three ( very different ) ranges of configurations that qualify as a distinct , recurring patterns for the carbonyl oxygen accepting a hb from water , for the ammide nitrogen donating a hb to water , and for a hypothetical weak hb involving c@xmath75 atoms and water oxygens . in the latter case ,",
    "the presence of a distinct feature in the probability distribution is probably an indirect effect of the structural correlations in the water hb network , of the hbs between water and the electro - negative atoms in alanine dipeptide and of the rigidity of the molecular backbone .",
    "we then assessed the behavior of pamm when performing a more detailed analysis of hydrogen bonding in water , comparing an empirical water model and a first - principles , density functional model of water with and without a description of the quantum nature of nuclei .",
    "we introduced a compact representation of the hydrogen - bonding properties of water molecules in terms of the total number of accepted and donated hbs , that arises naturally because pamm identifies hydrogen - bonded configurations in terms of a smoothly varying hb count function .",
    "we demonstrated that these hydrogen bond counts can be used to study the dynamics of the hydrogen bond network , giving results that are fully compatible with well - established definitions of the hydrogen bond , and to identify coordination defects in the otherwise ideal hb network of ice ih .",
    "this analysis also highlights the presence of characteristic features that are a signature of extreme excursions of protons along the hydrogen bond observed with a quantum description of nuclei . finally , we discussed liquid ammonia as an example of a weakly hydrogen - bonded system , that shows a much less clear - cut partitioning of the probability distribution and a more varied ensemble of hydrogen - bonding molecular environments .",
    "in all of these cases our algorithm provides an adaptive approach to define the hydrogen bond in a unique and unbiased way , that uses only structural information and that can be easily exploited to recognize correlation between the hb patterns involving a given molecule . even though we have used hydrogen bonding as a representative benchmark , application of the pamm algorithm",
    "is by no means limited to this example .",
    "it could be used to recognize complex structural patterns in a variety of materials and compounds , and be easily applied to bias molecular simulations to accelerate the interconversion between different ( meta)stable atomic configurations .",
    "the authors would like to thank gareth tribello , federico giberti and fabio pietrucci for a careful reading of the manuscript and useful discussion .",
    "joshua more and david manolopoulos are thanked for sharing the ammonia configurations with us .",
    "funding from the national center for computational design and discovery of novel materials marvel is gratefully acknowledged , as well as computer time from the swiss national supercomputing center ( project s466 ) .",
    "in the supplementary material we provide the source code of a simple fortran90 library to perform pamm analysis , and a tool to apply it to the case of the hydrogen bond  @xcite .",
    "updated versions of the package will be made available on http://epfl-cosmo.github.io .",
    "the workflow for using this software follows closely the procedure introduced in section  [ sec : methods ] . starting from a preliminary simulation",
    ", one should first extract representative descriptors for the atom groups that are being studied .",
    "here , one can use the _ hbpamm _ utility to process a set of atomic configurations in _ xyz _ format , to generate a list of @xmath71 triplets .",
    "then , the _ pamm _ tool can use this data to generate a probabilistic model that describes the range of structural parameters associated with the hydrogen bond .",
    "this piece of code is completely general , and can be used to process any sort of structural data .",
    "finally , one should use once more _ hbpamm _ ( or an analogous utility adapted to a different kind of structure ) to post - process the trajectory , extracting @xmath77 , @xmath84 , @xmath98 for the different atoms considered .",
    "67ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _ _ ,",
    "( ,  ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop _ _ ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3674992 [ * * ,   ( ) ] link:\\doibase 10.1039/c4rp00030 g [ ( ) ,  10.1039/c4rp00030 g ] @noop * * ,   ( ) in  http://link.springer.com/chapter/10.1007/978-3-540-88693-8_52[__ ]  ( ,  )  pp .   @noop @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop * * ,   ( ) @noop * * , ( ) @noop _ _  ( ,  ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3663219 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop `` , '' ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop `` , '' @noop ,  * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> the concept of chemical bonding can ultimately be seen as a rationalization of the recurring structural patterns observed in molecules and solids . </S>",
    "<S> chemical intuition is nothing but the ability to recognize and predict such patterns , and how they transform into one another . </S>",
    "<S> here we discuss how to use a computer to identify atomic patterns automatically , so as to provide an algorithmic definition of a bond based solely on structural information . </S>",
    "<S> we concentrate in particular on hydrogen bonding  a central concept to our understanding of the physical chemistry of water , biological systems and many technologically important materials . </S>",
    "<S> since the hydrogen bond is a somewhat fuzzy entity that covers a broad range of energies and distances , many different criteria have been proposed and used over the years , based either on sophisticate electronic structure calculations followed by an energy decomposition analysis , or on somewhat arbitrary choices of a range of structural parameters that is deemed to correspond to a hydrogen - bonded configuration . </S>",
    "<S> we introduce here a definition that is univocal , unbiased , and adaptive , based on our machine - learning analysis of an atomistic simulation . </S>",
    "<S> the strategy we propose could be easily adapted to similar scenarios , where one has to recognize or classify structural patterns in a material or chemical compound . </S>"
  ]
}