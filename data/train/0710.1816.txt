{
  "article_text": [
    "in a recent paper @xcite , klazar studied distributions of the numbers of crossings and nestings of two edges in ( perfect ) matchings . all matchings",
    "form an infinite tree @xmath18 rooted at the empty matching @xmath19 , in which the children of a matching @xmath20 are the matchings obtained from @xmath20 by adding to @xmath20 in all possible ways a new first edge . given two matchings @xmath20 and @xmath21 on @xmath22 $ ] , klazar decided when the number of crossings ( nestings ) have identical distribution on the levels of the two subtrees of @xmath18 rooted at @xmath20 and @xmath21 .",
    "in the last section of @xcite klazar raised the question as to apply the method to other structures besides matchings . in the present paper we consider set partitions , which have a natural graphic representation by a set of arcs .",
    "we establish the klazar - type results to the distribution of crossings and nestings of two edges in set partitions .",
    "our approach follows that of klazar for matchings @xcite , but is not a straightforward generalization . the structure of set partitions is more complicated than that of matchings .",
    "for example , partitions of @xmath2 $ ] may have different number of blocks , while every matching of @xmath22 $ ] has exactly @xmath6 blocks . to get the results we first defined an infinite tree @xmath23 on the set of all set partitions , which , when restricted to matchings , is different than the one introduced by klazar .",
    "we state our main result in theorem 1.1 , whose proof and applications are given in sections 2 and 3 .",
    "section 4 is devoted to the enumeration of the crossing / nesting similarity classes .",
    "though the ideas of the proofs are similar to those in @xcite , in many places we have to supply our own argument to fit in the different structure , and use a variety of combinatorial structures , in particular , motzkin paths , charlier diagrams , and binary sequences .",
    "we also analyze the joint generating function of the statistics @xmath12 and @xmath13 over partitions rooted at @xmath0 , and derive a continued fraction expansion for general @xmath0 .",
    "we begin by introducing necessary notations .",
    "a ( set ) partition of @xmath2=\\{1 , 2 , \\dots , n\\}$ ] is a collection of disjoint nonempty subsets of @xmath2 $ ] , called blocks , whose union is @xmath2 $ ] .",
    "a matching of @xmath22 $ ] is a partition of @xmath22 $ ] in @xmath6 two - element blocks , which we also call _",
    "edges_. if a partition @xmath0 has @xmath24 blocks , we write @xmath25 .",
    "a partition @xmath0 is often represented as a graph on the vertex set @xmath2 $ ] , drawn on a horizontal line in the increasing order from left to right , whose edge set consists of arcs connecting the elements of each block in numerical order .",
    "we write an arc @xmath26 as a pair @xmath27 with @xmath28 .    for a partition @xmath0 of @xmath2 $ ] , we say that the arcs @xmath29 and @xmath30 form a crossing if @xmath31 , and they form a nesting if @xmath32 .",
    "by @xmath33 ( resp .",
    "@xmath34 ) , we denote the number of crossings ( resp .",
    "nestings ) of @xmath0 .",
    "the distribution of the statistics @xmath12 and @xmath13 on matchings has been studied in a number of articles , including @xcite , to list a few .",
    "the symmetry of @xmath12 and @xmath13 for set partitions was established in @xcite . in this paper",
    "we investigate the distribution of the statistics @xmath33 and @xmath34 over the partitions of @xmath2 $ ] with a prefixed restriction to the last @xmath24 elements .",
    "denote by @xmath35 the set of all partitions of @xmath2 $ ] , and by @xmath36 the set of partitions of @xmath2 $ ] with @xmath24 blocks . for @xmath37",
    ", @xmath38 contains the empty partition .",
    "let @xmath39 .",
    "we define _ the tree @xmath23 of partitions _ as a rooted tree whose nodes are partitions such that :    1 .   the root is the empty partition ; 2 .",
    "the partition @xmath40 of @xmath41 $ ] is a child of @xmath1 , a partition of [ n ] , if and only if the restriction of @xmath0 on @xmath42 is order - isomorphic to @xmath1",
    ".    see figure [ tree_of_partitions ] for an illustration of @xmath23 .",
    ", width=415 ]    observe that if @xmath1 is a partition of @xmath2 $ ] with @xmath43 , then @xmath1 has @xmath44 children in @xmath23 .",
    "let @xmath45 be the blocks of @xmath1 ordered in increasing order with respect to their minimal elements .",
    "for a set @xmath46 , let @xmath47 .",
    "we denote the children of @xmath1 by @xmath48 as follows : @xmath49 is a partition of @xmath41 $ ] with @xmath44 blocks , @xmath50 for @xmath51 , @xmath52 is a partition of @xmath41 $ ] with @xmath24 blocks , @xmath53    for a partition @xmath1 , let @xmath54 denote the subtree of @xmath23 rooted at @xmath1 , and let @xmath55 be the set of all partitions at the @xmath56-th level of @xmath54 .",
    "@xmath57 is the set of all partitions on the @xmath56-th level of @xmath54 with @xmath9 blocks .",
    "note that @xmath58 if and only if @xmath59 .",
    "let @xmath60 be an abelian group and @xmath61 , @xmath62 two elements in @xmath60 .",
    "consider the statistics @xmath63 given by @xmath64 . in @xcite , klazar defines a tree of matchings and shows that for two matchings @xmath20 and @xmath21 , if the statistic @xmath65 coincides at the first two levels of @xmath66 and @xmath67 then it coincides at all levels , and similarly for the pair of statistics @xmath68 . in this article",
    "we prove that in the tree of partitions defined above , the same results hold . precisely ,    [ t : main ] let @xmath69 be two non - empty partitions , and @xmath70 be the multiset containing @xmath71 .",
    "we have    1 .   if @xmath72 for @xmath73 then + @xmath74 for all @xmath3 .",
    "2 .   if @xmath75 for @xmath73 then + @xmath76 for all @xmath77 .    in other words ,",
    "if the statistic @xmath65 coincides on the first two levels of the trees @xmath54 and @xmath78 then it coincides on @xmath57 and @xmath79 on all levels , and similarly for the pair of statistics @xmath68 .",
    "note that the conditions of theorem 1.1 imply that @xmath1 and @xmath0 have the same number of blocks .",
    "but they are not necessarily partitions of the same @xmath2 $ ] .    at the end of the introduction we would like to point out the major differences between the structure of crossing and nesting of set partitions and that of matchings .    1 .",
    "the tree of partitions @xmath23 and the tree of matchings are different . in @xmath23 , children of a partition @xmath0 is obtained by adding a new vertex , instead of adding a first edge .",
    "hence klazar s tree of matchings is not a sub - poset of @xmath23 .",
    "the definition of @xmath23 allows us to define the analogous operators @xmath80 , as in @xcite .",
    "since some descendants of @xmath0 are obtained by adding isolated points , we need to introduce an extra operator @xmath20 , ( see definition 2.2 ) , and supply some new arguments to work with our structure and @xmath20 .",
    "the type of a matching is encoded by a dyck path , while for set partitions , the corresponding structure is restricted bicolored motzkin paths(rbm ) , ( c.f .",
    "section 3 ) .",
    "the enumeration of crossing / nesting similarity classes is different .",
    "a crossing - similarity class is determined by a value @xmath81 ( @xmath33 ) and a composition @xmath82 of @xmath6 . for matchings",
    "@xmath81 can be any integer between @xmath83 and @xmath84 .",
    "but for partitions the possible value of @xmath33 depends only on @xmath9 , but not @xmath85 s . + in matchings",
    "there is a bijection between the set of nesting sequences of matchings of @xmath22 $ ] and the set of dyck paths @xmath86 .",
    "there is no analogous result between set partitions and restricted bicolored motzkin paths .",
    "4 .   for matchings",
    "every nesting - similarity class is a subset of a crossing - similarity class .",
    "this is not true for set partitions .",
    "throughout this article we will generally adapt klazar s notation on multisets .",
    "formally a multiset is a pair @xmath87 , where @xmath88 is a set , called the underlying set , and @xmath89 is a mapping that determines the multiplicities of the elements of @xmath88 .",
    "we often write multisets by repeating the elements according to their multiplicities .    for a map @xmath90 and",
    "@xmath91 , let @xmath92 denote the multiset whose underlying set is @xmath93 and in which each element @xmath94 appears with multiplicity equal to the cardinality of the set @xmath95 .",
    "@xmath96 denotes the set of all finite multisets with elements in the set @xmath97 .",
    "any function @xmath98 naturally extends to @xmath99 by @xmath100 , where @xmath101 is union of multisets ( the multiplicities of elements are added ) .    for each @xmath102 of @xmath1 define @xmath103 to be the number of edges @xmath104 such that @xmath105 and @xmath106 to be the number of edges @xmath104 such that @xmath107 .",
    "they satisfy the obvious recursive relations @xmath108 for @xmath109 , where @xmath110 . for the statistics @xmath111 defined by @xmath64 , we have that @xmath112 for simplicity , we will write @xmath113 for @xmath114 .",
    "[ l : salbe ] for @xmath115 , @xmath116 and for @xmath117 , @xmath118    we first show . the first line in follows directly from .",
    "for the other two , @xmath119 the first and third equality follow from and the second one follows from and",
    ". similarly , follows from , , , and .    to each partition @xmath1 with @xmath24 blocks , ( @xmath120 ) , we associate a sequence @xmath121 the sequence @xmath122 encodes the information about the distribution of @xmath65 on the children of @xmath1 in @xmath23 , in which @xmath123 plays a special role when we analyze the change of @xmath122 below .",
    "this is due to the fact that @xmath123 carries information about @xmath1 and two children of @xmath1 , namely , @xmath124 and @xmath125 .    for an abelian group @xmath60 , let @xmath126 denote the set of finite sequences of length @xmath56 over @xmath60 , and @xmath127 .",
    "if @xmath128 and @xmath129 , then we use the convention that the sequence @xmath130 is denoted by @xmath131 .    for @xmath132 and @xmath117 ,",
    "define @xmath133 , ( @xmath134 ) by setting @xmath135 and @xmath136 by setting @xmath137 in addition , define @xmath138 by setting @xmath139    lemma  [ l : salbe ] immediately implies that @xmath140 for @xmath141 , let @xmath142 , the multiset of sequences @xmath143 associated to partitions @xmath144 .",
    "then for @xmath145 , @xmath146 next , we define an auxiliary function @xmath147 which reflects the change of the statistic @xmath65 along @xmath23 .",
    "then we prove two general properties of @xmath147 and use these properties to prove theorem  [ t : main ] . for an integer @xmath148 and @xmath149 , the function @xmath150 is defined by @xmath151 in particular , @xmath152    [ l : big ]    let @xmath153 be two multisets such that @xmath154 for every @xmath148 and @xmath149",
    ". then    * @xmath155 , * @xmath156 , * @xmath157 ,    for every @xmath148 and @xmath149 .",
    "\\(a ) the elements in @xmath158 have the form @xmath159 for some @xmath160 , where @xmath161 for some @xmath162 . for @xmath163 , @xmath164 hence @xmath165 implies @xmath166 .    for @xmath167 ,",
    "divide the multiset @xmath158 into two disjoint multisets , @xmath168 and @xmath169 the elements of @xmath88 can be written as @xmath170 since @xmath171 , the multiset @xmath88 is equal to @xmath172 .",
    "the elements in @xmath173 can be written as @xmath174 since @xmath175 , the indices on the right - hand side run through all the increasing @xmath176-tuples @xmath177 .",
    "therefore , @xmath173 is equal to @xmath178 .",
    "so , @xmath179 by assumption we have @xmath180 ( c ) we will prove only ( c ) because the proof of ( b ) is similar and easier . since @xmath178 is a translation of @xmath181 by @xmath182 ,",
    "it is enough to prove the result for @xmath183 only .",
    "the elements of @xmath184 have the form @xmath185 , where @xmath186 is equal to @xmath187 for some @xmath188 and @xmath189 $ ] .    for @xmath190 ,",
    "let @xmath191\\}.\\end{gathered}\\ ] ] an element @xmath192 is equal to @xmath193 again , we consider two cases , according to the value of @xmath194 . by  , the submultiset of @xmath195 for @xmath196 is equal to @xmath197 , and for @xmath198 the corresponding submultiset is equal to @xmath199 .",
    "therefore , @xmath200 similarly , @xmath201 so , @xmath202 the second and fifth equality follow from and respectively .",
    "the third equality follows from the assumption of the lemma , while the fourth equality is just a reordering of the unions .",
    "[ l : small ]    if @xmath153 are one - element sets such that @xmath203 and @xmath204 , then @xmath154 for every @xmath148 and @xmath149 .",
    "we need to prove that if @xmath205 are two sequences beginning with the same term and having equal numbers of occurrences of each @xmath206 , then @xmath207 for every @xmath148 and @xmath149 .",
    "it suffices to prove the statement for @xmath208 , because @xmath209 is a translation of @xmath210 by @xmath182 .",
    "let @xmath211 and @xmath212 .",
    "since @xmath213 , it suffices to prove that the multisets @xmath214 and @xmath215 are equal .",
    "that is clear because @xmath216 and @xmath217 are equal as multisets .",
    "we prove ( b ) , the proof of ( a ) is similar .",
    "first , we prove by induction on @xmath56 that @xmath218 before we proceed with the induction , it is useful to observe that the assumption @xmath219 of theorem  ( [ t : main ] ) ( b ) is equivalent to @xmath220 where @xmath221 .",
    "one direction is clear , the other one follows from the following equations .",
    "@xmath222 where @xmath223 is the difference of multisets .",
    "for the same reason the assumption of part ( a ) is equivalent to @xmath224    now we show . for @xmath225 we need to show @xmath226 . by lemma",
    "[ l : small ] we only need to check that @xmath203 and @xmath204 for @xmath227 and @xmath228 .",
    "this follows from , because @xmath229 and @xmath230 .",
    "suppose @xmath231 for all @xmath232 and all @xmath9 . then using  , the induction hypothesis , and lemma  [ l : big ] we have @xmath233 and",
    "the induction is completed .",
    "this proves .",
    "as a direct corollary , we obtain a result of kasraoui and zeng ( * ? ? ?",
    "* eq.(1.6 ) ) .",
    "the joint distribution of crossings and nestings of partitions is symmetric i.e. @xmath235    let @xmath236 and @xmath237 .",
    "the result follows from the second part of theorem  [ t : main ] for @xmath238 .    for a partition @xmath1",
    "we say that two edges form an alignment if they neither form a crossing nor a nesting .",
    "the total number of alignments in @xmath1 is denoted by @xmath239 . a stronger result of kasraoui and zeng ( * ? ? ? * eq .",
    "( 1.4 ) ) can also be derived from theorem  [ t : main ] .",
    "@xmath240    again we use @xmath241 , @xmath242 , @xmath243 , and @xmath238 . any partition @xmath244 with @xmath24 blocks",
    "has @xmath245 edges .",
    "hence @xmath246 .",
    "the result follows from the second part of theorem  [ t : main ] .",
    "let @xmath1 and @xmath0 be two partitions of @xmath2 $ ] with same number of blocks @xmath24 .",
    "if the statistic @xmath247 is equidistributed on the first two levels of @xmath54 and @xmath78 , it is equidistributed on @xmath57 and @xmath79 for all @xmath248 .",
    "again we use the identity @xmath249 , which holds for any partition @xmath244 with @xmath24 blocks .",
    "moreover , @xmath250 .",
    "therefore the condition that the statistic @xmath247 is equidistributed on the first two levels of @xmath54 and @xmath78 implies that the statistic @xmath251 is equidistributed on @xmath57 and @xmath79 for all @xmath73 and all @xmath9 .",
    "in other words , if we set @xmath252 and @xmath253 then the the assumption of theorem  [ t : main ] is satisfied , and hence @xmath251 is equidistributed on @xmath57 and @xmath79 for all @xmath77 .",
    "this , in return , implies that @xmath247 is equidistributed on @xmath57 and @xmath79 for all @xmath77 .",
    "let @xmath254 and @xmath255 .",
    "there are as many partitions on @xmath2 $ ] with @xmath9 crossings and @xmath56 nestings which restricted to the last five points form a partition isomorphic to @xmath1 as there are partitions of @xmath2 $ ] with @xmath56 crossings and @xmath9 nestings which restricted to the last five points form a partition isomorphic to @xmath0 .",
    "set @xmath236 and @xmath237 , @xmath256 .",
    "the claim follows from part ( b ) of theorem  [ t : main ] since @xmath257 and @xmath258    let @xmath259 and @xmath260 .",
    "there are as many partitions on @xmath2 $ ] with @xmath9 crossings and @xmath56 nestings which restricted to the last eight points form a partition isomorphic to @xmath1 as there are ones which restricted to the last eight points form a partition isomorphic to @xmath0 .",
    "again set @xmath236 and @xmath243 .",
    "then @xmath256 .",
    "the claim follows from part ( a ) of theorem  [ t : main ] since @xmath261 and @xmath262",
    "in this section we consider equivalence relations @xmath263 and @xmath264 on set partitions in the same way klazar defines them on matchings @xcite .",
    "we determine the number of crossing - similarity classes in @xmath36 . for @xmath264",
    ", we find a recurrence relation for the number of nesting - similarity classes in @xmath36 , and compute the total number of such classes in @xmath35 .",
    "define an equivalence relation @xmath263 on @xmath35 : @xmath265 if and only if @xmath266 for all @xmath77 .",
    "the relation @xmath263 partitions @xmath36 into equivalence classes .",
    "theorem  [ t : main ] implies that @xmath267 if and only if @xmath268 and @xmath269 .",
    "define @xmath270 . for the upcoming computations it is useful to observe that @xmath267 if and only if @xmath268 and @xmath271 , i.e. , @xmath1 and @xmath0 are equivalent if and only if they have the same number of crossings and their sequences @xmath272 and @xmath273 are equal as multisets",
    ". denote the multiset consisting of the elements of @xmath272 by @xmath274 .    similarly , define @xmath275 if and only if @xmath276 for all @xmath77 .",
    "again , from theorem  [ t : main ] we have that @xmath275 if and only if @xmath277 and @xmath278 . since the sequence @xmath279 is nondecreasing , @xmath280 if and only if @xmath277 and @xmath281 . with the notation at the beginning of section  [ s : main ] , @xmath282 .",
    "denote this sequence by @xmath283 .",
    "a motzkin path @xmath284 is a path from @xmath285 to @xmath286 consisting of steps @xmath287 which does not go below the @xmath288-axis .",
    "we say that the step @xmath289 is of height @xmath56 if its left endpoint is at the line @xmath290 .",
    "a restricted bicolored motzkin path is a motzkin path with each horizontal step colored red or blue which does not have a blue horizontal step of height 0 .",
    "we will denote the steps @xmath291 , @xmath292 , red @xmath293 , and blue @xmath293 by ne ( northeast ) , se ( southeast ) , re ( red east ) , and be ( blue east ) respectively .",
    "the set of all restricted bicolored motzkin paths of length @xmath6 is denoted by @xmath294 .",
    "a charlier diagram of length @xmath6 is a pair @xmath295 where @xmath296 and @xmath297 is a sequence of integers such that @xmath298 if @xmath289 is a ne or re step , and @xmath299 if @xmath289 is a se or be step of height @xmath56 .",
    "@xmath300 will denote the set of charlier diagrams of length @xmath6 .",
    "it is well known that partitions are in one - to - one correspondence with charlier diagrams . here",
    "we use two maps described in  @xcite , which are based on similar constructions in  @xcite . for our purpose , we reformulate the maps @xmath301 as follows . given @xmath302 , construct @xmath303 step by step . the path @xmath284 determines the type of @xmath1 : @xmath304 $ ] is    * a minimal but not a maximal element of a block of @xmath1 ( opener ) if and only if @xmath289 is a ne step ; * a maximal but not a minimal element of a block of @xmath1 ( closer ) if and only if @xmath289 is a se step ; * both a minimal and a maximal element of a bock of @xmath1 ( singleton ) if and only if @xmath289 is a re step ; * neither a minimal nor a maximal element of a block of @xmath1 ( transient ) if and only if @xmath289 is a be step .    to draw the edges in @xmath305 , we process the closers and transients one by one from left to right . each time we connect the vertex @xmath306 that we are processing to the @xmath307-th available opener or transient to the left of @xmath306 , where the openers and transients are ranked from right to left .",
    "if we rank the openers and transients from left to right , we get @xmath308",
    ". it can be readily checked that @xmath309 and @xmath310 are well defined .",
    "moreover :    the maps @xmath311 are bijections .",
    "the proof can be found in @xcite and their references .",
    "if @xmath312 is the charlier diagram in figure  [ fig : charlier ] , then @xmath313        for @xmath314 let @xmath315 be the number of ne and re steps that start at height @xmath306 , @xmath316 .",
    "the _ profile _ of @xmath20 is the sequence @xmath317 , where @xmath318 .",
    "note that this implies that @xmath319 for each @xmath320 , and that the path @xmath20 is of height @xmath56 or @xmath321 .",
    "the _ semi - type _ of @xmath322 is the sequence @xmath323 where @xmath324 if @xmath289 is a ne or re step , and @xmath325 if @xmath289 is a se or be step .",
    "for example , if @xmath20 is the path in figure [ fig : charlier ] , then @xmath326 , and @xmath327 .",
    "let @xmath328 and @xmath329 , @xmath330 .",
    "define @xmath331 .",
    "note that for a given @xmath1 , @xmath332 can be easily constructed using the four steps above .",
    "the next lemma gives the relation between a partition and its corresponding restricted bicolored motzkin path and charlier diagram .",
    "[ l : properties ] let @xmath309 , @xmath310 and @xmath333 be the maps defined above and @xmath329 , @xmath330 .    *",
    "the number of blocks of @xmath1 is equal to the total number of ne and re steps of @xmath20 . *",
    "@xmath334 , @xmath335 * @xmath336 if and only if @xmath337 * @xmath338 if and only if the zeros in @xmath339 are in the positions @xmath340 .",
    "\\(a ) the result follows from the fact that the number of blocks of @xmath1 is equal to the total number of openers and singletons .",
    "\\(b ) denote by @xmath341 be the set of arcs of @xmath1 .",
    "for @xmath342 let @xmath343",
    ". then @xmath344 . similarly ,",
    "if @xmath345 , then @xmath346 . from the definitions of @xmath309 and @xmath310 it follows that @xmath347 and @xmath348 .",
    "hence the claim .",
    "\\(c ) using the notation at the beginning of section  [ s : main ] , we have @xmath349 , where @xmath350 is the number of edges @xmath104 such that @xmath351 . here",
    "@xmath352 , that is , @xmath353 is the @xmath306-th opener or singleton from left to right .",
    "but the step in @xmath20 which corresponds to @xmath353 is of height @xmath354 if and only if @xmath355 .",
    "\\(d ) it follows directly from the definitions of @xmath283 and @xmath356 .",
    "a composition of @xmath24 is an ordered tuple @xmath357 of positive integers whose sum is @xmath24 .",
    "[ l : cross ] let @xmath358 , and @xmath359 .    * if @xmath360 and @xmath361 , then @xmath357 is a composition of @xmath24 into @xmath362 parts , where @xmath363 , and @xmath364 . * given a composition @xmath357 of @xmath24 into @xmath365 parts and an integer @xmath366 such that @xmath367 , there exists @xmath360 with @xmath361 and @xmath368 .",
    "\\(a ) it is clear that @xmath369 .",
    "it follows that all the @xmath315 s are positive from part ( c ) of lemma  [ l : properties ] .",
    "moreover , @xmath1 has at least @xmath56 openers and , therefore , at least @xmath56 closers .",
    "so , @xmath370 , i.e. , @xmath365 .",
    "let @xmath371 ( respectively @xmath372 ) be the number of se ( respectively be ) steps at level @xmath306 , @xmath373",
    ". then @xmath374 and @xmath375 , @xmath376 .",
    "using part ( b ) of lemma  [ l : properties ] , we have @xmath377 .",
    "\\(b ) suppose first that @xmath378 .",
    "let @xmath314 consist of @xmath379 re steps followed by a ne step , then @xmath380 re steps followed by one ne step , etc .",
    ", @xmath381 re steps followed by a ne step , then @xmath382 be steps , and @xmath321 se steps .",
    "it is not hard to see that indeed @xmath314 .",
    "the path never crosses the @xmath288-axis and all the be steps , if any , are at hight @xmath383 .",
    "also @xmath336 .",
    "consider all the sequences @xmath297 such that @xmath312 is a charlier diagram .",
    "then    @xmath384    hence @xmath385 in the case @xmath386 , construct @xmath314 similarly : @xmath379 re steps followed by a ne step , then @xmath380 re steps followed by one ne step , etc .",
    ", @xmath387 re steps , followed by @xmath56 se steps .",
    "( note that , unlike in the case @xmath388 , the path @xmath20 is of height @xmath56 ) all the sequences @xmath297 such that @xmath312 is a charlier diagram satisfy the following properties : @xmath389 hence @xmath390 because of   ( respectively  ) , for any integer @xmath366 between @xmath83 and @xmath391 , @xmath392 can be chosen to satisfy the conditions   ( respectively  ) and such that @xmath393 . since @xmath394 is a bijection , there is @xmath360 such that @xmath395 and , by part ( b ) and ( c ) of lemma  [ l : properties ] , @xmath368 and @xmath396 .",
    "let @xmath397 and @xmath398 then @xmath399 , @xmath400    recall that @xmath267 if and only if @xmath268 and @xmath401 .",
    "therefore , @xmath402 . using lemma  [ l : cross ] and the fact that the number of compositions of @xmath24 into @xmath321 parts , @xmath403 , is @xmath404",
    ", we derive  .",
    "in particular , when @xmath405 , @xmath406}.\\ ] ] but @xmath407 and   follows .",
    "theorem 4.5 implies that there are many more examples of different partitions @xmath1 and @xmath0 for which the statistic @xmath12 has same distribution on the the levels of @xmath54 and @xmath78 .",
    "for example , @xmath408 while @xmath409",
    ".    next we analyze the number of nesting - similarity classes .",
    "first we derive a recurrence for the numbers @xmath410 .",
    "let @xmath397 .",
    "then @xmath411    equation is clear since @xmath412 .",
    "recall that @xmath275 if and only if @xmath277 and @xmath413 . by lemma  [ l : properties ] , @xmath414 is equal to the number of pairs @xmath415 such that there exists @xmath416 with @xmath417 and @xmath418 .",
    "it is not hard to see that for a given a sequence @xmath419 , there exists @xmath360 such that @xmath418 if and only if @xmath420 has @xmath24 zeros and @xmath421 . denote the set of all such sequences by @xmath422 and denote the set of all @xmath423 with @xmath24 zeros by @xmath424 .    for a sequence @xmath425 define a bicolored motzkin path @xmath426 as follows . for @xmath306 from @xmath6 to @xmath427",
    "do :    1 .",
    "if @xmath324 and @xmath289 is not defined yet , then set @xmath289 to be a re step ; 2 .   if @xmath325 and there is @xmath428 such that @xmath429 and @xmath430 is not defined yet , then set @xmath289 to be a se step and @xmath431 to be a ne step , where @xmath432 ; 3 .",
    "if @xmath325 and there is no @xmath428 such that @xmath429 and @xmath430 has not been defined yet , set @xmath289 to be a be step .",
    "note that we build @xmath20 backwards , from @xmath286 to @xmath285 .",
    "let @xmath433 be the height of @xmath289 and @xmath434 , where the sum is over all the indices @xmath306 such that @xmath325 .",
    "for example , if @xmath435 , then @xmath436 the sequence of the heights of all the steps of @xmath20 is @xmath437 and @xmath438 .",
    "although clearly @xmath439 stays above the @xmath288-axis , it is not necessarily a restricted bicolored motzkin path .",
    "the reason is that any @xmath427 in @xmath420 before the first zero would produce a be step on the @xmath288-axis .",
    "hence , @xmath440 if and only if @xmath421 , or equivalently , @xmath441 .",
    "we claim that for a fixed @xmath441 , there is @xmath360 such that @xmath418 and @xmath417 if and only if @xmath442 . to show the if part , one can choose a sequence @xmath443 with @xmath444 if @xmath325 , @xmath298 if @xmath324 , and @xmath445",
    ". then lemma  [ l : properties ] implies that @xmath308 satisfies the requirements .",
    "conversely , suppose @xmath360 is such that @xmath418 .",
    "let @xmath446 .",
    "then the height @xmath447 of each be and se step of @xmath448 satisfies @xmath449",
    "now , by lemma  [ l : properties ] , @xmath450 the claim is proved . back to the proof of theorem 4.6 , we have @xmath451 set @xmath452 where the inner sums are taken over all the indices @xmath306 such that @xmath325 . with this notation , @xmath453 the sequences @xmath454 and @xmath455 satisfy the following recurrence relations : @xmath456 to see  , note that if @xmath457 then @xmath458 and @xmath439 is @xmath459 with one re step appended , and if @xmath460 then @xmath461 and @xmath462 is obtained from @xmath439 by deleting the first ne and the last se step .",
    "for  , if @xmath463 and @xmath464 , then @xmath465 is obtained from @xmath439 by deleting the first @xmath466 be steps at level 0 .",
    "substituting   into   gives @xmath467 finally , by substituting @xmath454 from   into   and simplifying , we obtain  .",
    "@xmath468 by @xmath469 .",
    "using @xmath470 ,  , and  , we get @xmath471 this yields the recurrence relation @xmath472 with initial values @xmath473 and @xmath474 , which has the solution @xmath475    the following tables give the number of crossing / nesting - similarity classes on @xmath36 for small @xmath6 and @xmath24 .    the two equivalence relations @xmath263 and @xmath264 on set partitions are not compatible . from the tables",
    "it is clear that @xmath263 is not a refinement of @xmath264 . on the other hand ,",
    "let @xmath476 and @xmath477 .",
    "it is easy to check that @xmath478 , but @xmath479 , as @xmath480 and @xmath481",
    "in this section we analyze the generating function @xmath482 for a given partition @xmath0 , and derive a continued fraction expansion for @xmath483 . for this",
    "we work with the group @xmath484 and @xmath485 .",
    "fix a partition @xmath0 with @xmath24 blocks .",
    "define @xmath486 , i.e. , @xmath487 is the multiset of sequences @xmath488 associated to the partitions @xmath489 .",
    "a recurrence analogous to   holds .",
    "namely , for @xmath145 @xmath490 for simplicity we write @xmath491 instead of @xmath487 when there is no confusion .",
    "define @xmath492 to be the generating function of the multiset @xmath493 , i.e. , @xmath494 where @xmath495 contributes to the sum above according to its multiplicity in @xmath493 . by convention ,",
    "let @xmath496 if @xmath497 , or , one of @xmath498 is negative . for simplicity",
    "we write @xmath492 for @xmath499 .",
    "note that @xmath500 and hence @xmath501 by the formulas  ,  , and the proof of part ( c ) of lemma  [ l : big ] , we get @xmath502 which leads to a recurrent relation for @xmath492 : @xmath503 using the standard notation @xmath504_{q , p}:=\\frac{q^r - p^r}{q - p}$ ] , we can write this as        given @xmath56 and @xmath511 , nonnegative integers , consider the paths from @xmath512 to @xmath513 using steps @xmath514 , @xmath515 , and @xmath516 which do not go below the @xmath288-axis . each step @xmath514 ( @xmath515 , @xmath516 respectively ) starting at the line @xmath517 has weight @xmath518_{q , p}$ ] ( @xmath519_{q , p}$ ] , @xmath520 .",
    "the weight @xmath521 of such a path @xmath20 is defined to be the product of the weights of its steps .",
    "let @xmath522 , where the sum is over all the paths @xmath20 described above . then from proposition",
    "[ l : rec ] one has @xmath523 set @xmath524_{q , p}$ ] and @xmath525_{q , p}+1 $ ] . by the well - known theory of continued fractions ( see  @xcite ) , @xmath526 is equal to the coefficient in front of @xmath527 in @xmath528 where @xmath529 and @xmath530 is the @xmath24-th convergent of @xmath531 .",
    "hence    [ gf : cf ] let @xmath0 be a partition with @xmath24 blocks whose associated sequence is @xmath532 , where @xmath533 for @xmath534 .",
    "then @xmath535 where @xmath536 is given by the formula , and @xmath537 is given by .",
    "corollary  [ t : sec ] leads to a continued fraction expansion for the generating function of crossings and nestings over @xmath543 : just taking @xmath0 to be the partition of @xmath544 , and bearing in mind that we are counting the empty partition as well , we get @xmath545_{q , p}+1)z-\\cfrac{[1]_{q , p}z^2}{1-([2]_{q , p}+1)z-\\cfrac{[2]_{q , p}z^{2}}{\\ddots}}}.\\end{aligned}\\ ] ] a different expansion was given in  @xcite , as @xmath546_{q , p}+1)z-\\cfrac{[2]_{q , p}z^2}{1-([2]_{q , p}+1)z-\\cfrac{[3]_{q , p}z^2}{\\ddots}}}}.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> let @xmath0 and @xmath1 be two set partitions with the same number of blocks . </S>",
    "<S> assume @xmath0 is a partition of @xmath2 $ ] . </S>",
    "<S> for any integer @xmath3 , let @xmath4 be the set of partitions of @xmath5 $ ] whose restrictions to the last @xmath6 elements are isomorphic to @xmath0 , and @xmath7 the subset of @xmath8 consisting of those partitions with exactly @xmath9 blocks . </S>",
    "<S> similarly define @xmath10 and @xmath11 . </S>",
    "<S> we prove that if the statistic @xmath12 ( @xmath13 ) , the number of crossings ( nestings ) of two edges , coincides on the sets @xmath4 and @xmath14 for @xmath15 , then it coincides on @xmath16 and @xmath11 for all @xmath17 . </S>",
    "<S> these results extend the ones obtained by klazar on the distribution of crossings and nestings for matchings .    </S>",
    "<S> * key words : * set partitions , crossings , nestings    * ams subject classifications . </S>",
    "<S> * 05a18 , 05a15 </S>"
  ]
}