{
  "article_text": [
    "due to numerous perturbations and errors , one can not expect a spacecraft steered by the precomputed optimal control to exactly move on the correspondingly precomputed optimal trajectory .",
    "the precomputed optimal trajectory and control are generally referred to as the nominal trajectory and control , respectively .",
    "once a deviation from the nominal trajectory is measured by navigational systems , a guidance strategy is usually required to calculate a new ( or corrected ) control in each guidance cycle such that the spacecraft can be steered by the new control to track the nominal trajectory or to move on a new optimal trajectory @xcite . since the 1960s , various guidance schemes have been developed @xcite , among of which there are two main categories : implicit one and explicit one . while the implicit guidance strategy generally compares the measured state with the nominal one to generate control corrections ; the explicit guidance strategy recomputes a flight trajectory by onboard computers during its motion . to implement an explicit guidance strategy , numerical integrations and iterations are usually required to solve a highly nonlinear two - point boundary - value problem ( tpbvp ) and",
    "the time required for convergence heavily depends on the merits of initial guesses as well as on the integration time of each iteration . in recent years , through employing a multiple shooting method and the analytical property arizing from the assumption that the gravity field is linear  @xcite , an explicit closed - loop guidance is well developed by lu _",
    "et al . _ for exo - atmospheric ascent flights  @xcite and for deorbit problems  @xcite .",
    "this explicit type of guidance for endo - atmospheric ascent flights were studied as well in refs .  @xcite . whereas , the duration of a low - thrust orbtial transfer is so exponentially long that the onboard computer can merely afford the large amount of computational time for integrations and iterations once a shooting method is employed , which makes the explicit guidance strategy unattractive to low - thrust orbital transfer problems .",
    "the nog is an implicit and less demanding guidance scheme , which not only allows the onboard computer to realize an online computation once the gain matrices associated with the nominal extremal are computed offline and stored in the onboard computer but also handles disturbances well @xcite . assuming the optimal control function is totally continuous , the linear feedback of control was proposed independently by breakwell _",
    "@xcite , kelley @xcite , lee @xcite , speyer _ et al . _",
    "@xcite , bryson _",
    "et al_. @xcite , and hull @xcite through minimizing the second variation of the cost functional ",
    "subject to the variational state and adjoint equations . based on this method , an increasing number of literatures , including refs .",
    "@xcite and the references therein , on the topic of the nog for orbital transfer problems have been published .",
    "more recently , a variable - time - domain nog was proposed by pontani _",
    "@xcite to avoid the numerical difficulties arising from the singularity of the gain matrices while approaching the final time and it was then applied to a continuous thrust space trajectories @xcite .",
    "however , difficulties arize when we consider to minimize the fuel consumption for a low - thrust orbital transfer because the corresponding optimal control function exhibits a bang - bang behavior if the prescribed transfer time is bigger than the minimum transfer time for the same boundary conditions  @xcite . considering the control function as a discontinuous scalar",
    ", the corresponding neighboring optimal feedback control law was studied by mcintyre @xcite and mcneal @xcite .",
    "then , foerster _",
    "_ @xcite extended the work of mcintyre and mcneal to problems with discontinuous vector control functions . using a multiple shooting technique ,",
    "the algorithm for computing the nog of general optimal control problems with discontinuous control and state constraints was developed in ref .",
    "@xcite , which was then applied to a space shuttle guidance in ref .",
    "as far as the author knows , a few scholars , including chuang _ et al . _ @xcite and kornhauser _ et al . _",
    "@xcite , have made efforts on developing the nog for low - thrust multi - burn orbital transfer problems . in the work @xcite by chuang _",
    "et al . _ , without taking into account the feedback on thrust - on times , the second variation on each burn arc was minimized such that the neighboring optimal feedbacks on thrust direction and thrust off - times were obtained . considering both endpoints",
    "are fixed , kornhauser and lion @xcite developed an amp for bounded - thrust optimal orbital transfer problems .",
    "then , through minimizing this amp , the linear feedback forms of thrust direction and switching times were derived . as is well known",
    ", it is impossible to construct the nog unless the jc holds along the nominal extremal @xcite since the gain matrices are unbounded if the jc is violated .",
    "this result was actually obtained by kelley @xcite , kornhauser _",
    "@xcite , chuang _",
    "@xcite , pontani _ et al . _",
    "@xcite , and many others who minimize the amp to construct the nog . as a matter of fact ,",
    "given every infinitesimal deviation from the nominal state , the jc , once satisfied , guarantees that there exists a neighboring extremal trajectory passing through the deviated state .",
    "therefore , the existence of neighboring extremals is a prerequisite to establish the nog .",
    "once the optimal control function exhibits a bang - bang behavior , it is however not clear what conditions have to be satisfied in order to guarantee the existence of neighboring extremals @xcite .",
    "to construct the conditions that , once satisfied , guarantee that for every state in an infinitesimal neighborhood of the nominal one there exists a neighboring extremal passing through it , this paper presents a novel neighboring extremal approach to establish the nog .",
    "the crucial idea is to construct a parameterized family of neighboring extremals around the nominal one .",
    "then , as a result of a geometric study on the projection of the parameterized family from tangent bundle onto state space , it is presented in this paper that the conditions sufficient for the existence of neighboring extremals around a bang - bang extremal consist of not only the jc between switching times but also a tc @xcite at each switching time .",
    "according to recent advances in geometric optimal control  @xcite , the jc and the tc , once satisfied , are also sufficient to guarantee the nominal extremal to be locally optimal provided some regularity assumptions are satisfied .",
    "given these two existence conditions , the neighboring optimal feedbacks on thrust direction and switching times are established in this paper through deriving the first - order taylor expansion of the parameterized neighboring extremals .    the present paper is organized as follows : in sect .",
    "[ se : problem_formulation ] , the fixed - time low - thrust fuel - optimal orbital transfer problem is formulated and the first - order necessary conditions are presented by applying the pontryagin maximum principle ( pmp ) . in sect .",
    "[ se : sufficient ] , a parameterized family of neighbouring extremals around a nominal one is first constructed . through analyzing the projection behavior of the parameterized family from tangent bundle onto state space ,",
    "two conditions sufficient for the existence of neighboring extremals are constructed .",
    "then , the neighboring optimal feedbacks on thrust direction and switching times are derived . in sect .",
    "[ se : implementation ] , the numerical implementation for the nog scheme is presented . in sect .",
    "[ se : numerical ] , a fixed - time low - thrust fuel - optimal orbital transfer problem is computed to verify the development of this paper . finally , a conclusion is given in sect .",
    "[ se : conclusion ] .",
    "throughout the paper , we denote the space of @xmath0-dimensional column vectors by @xmath1 and the space of @xmath0-dimensional row vectors by @xmath2 .",
    "consider the spacecraft is controlled by a low - thrust propulsion system , the state @xmath3^t\\in\\mathbb{r}^n$ ] ( @xmath4 ) for its translational motion in an earth - centred inertial cartesian coordinate frame ( notated as @xmath5 ) consists of the position vector @xmath6 , the velocity vector @xmath7 , and the mass @xmath8 .",
    "then , denote by @xmath9 the time , the set of differential equations for low - thrust orbital transfer problems can be written as @xmath10 where @xmath11 is the earth gravitational constant , the notation ``  @xmath12  '' denotes the euclidean norm , @xmath13 is a scalar constant determined by the specific impulse of the low - thrust engine equipped on the spacecraft , and @xmath14 is the thrust ( or control ) vector , taking values in the admissible set @xmath15 where the constant @xmath16 denotes the maximum magnitude of the thrust .",
    "denote by @xmath17 $ ] the normalized mass flow rate of the engine , i.e. , @xmath18 , and let @xmath19 be the unit vector of the thrust direction , one immediately gets @xmath20 .",
    "accordingly , @xmath21 and @xmath22 can be considered as control variables .",
    "set @xmath23\\times\\mathbb{s}^2 $ ] , we say @xmath24 is the admissible set for the control @xmath25 .",
    "denote by the constants @xmath26 and @xmath27 the mass of the spacecraft without any fuel and the radius of the earth , respectively , we define by @xmath28 the admissible set for the state @xmath29 .",
    "for the sake of notational clarity , let us define a controlled vector field @xmath30 on @xmath31 as @xmath32 where @xmath33 then , the dynamics in eq .",
    "( [ eq : sigma ] ) can be rewritten as @xmath34 note that many mechanical systems can be represented as this control - affine form of dynamics .",
    "thus , the nog scheme established later can be directly applied to some other mechanical systems .",
    "let @xmath35 be a finite positive integer such that @xmath36 , we define the @xmath37-codimensional submanifold @xmath38 as the constraint submanifold for final states , where @xmath39 is a twice continuously differentiable function and its expression depends on specific mission requirements",
    ".    given a fixed final time @xmath40 and a fixed initial point @xmath41 , the fuel - optimal orbital transfer problem consists of steering the system @xmath42 in @xmath43 by a measurable control @xmath44\\rightarrow\\mathcal{t}$ ] from the fixed initial point @xmath45 to a final point @xmath46 such that the fuel consumption is minimized , i.e. , @xmath47    for every @xmath48 , if @xmath49 is small enough , the controllability of the system @xmath42 holds in the admissible set @xmath43 @xcite .",
    "let @xmath50 be the minimum transfer time of the system @xmath42 for the same boundary conditions as the _ fop _ , if @xmath51 , there exists at least one fuel - optimal solution in @xmath43 @xcite .",
    "thanks to the controllability and the existence results , the pmp is applicable to formulate the following necessary conditions .",
    "hereafter , we define by the column vector @xmath52 the costate of @xmath29 . then , according to the pmp in ref .",
    "@xcite , if an admissible controlled trajectory @xmath53\\rightarrow \\mathcal{x}$ ] associated with a measurable control @xmath54\\rightarrow\\mathcal{t}$ ] is an optimal one of the _ fop _ , there exists a nonpositive real number @xmath55 and an absolutely continuous mapping @xmath56 on @xmath57 $ ] , satisfying @xmath58 for @xmath59 $ ] , such that the 5-tuple @xmath60 on @xmath57 $ ] is a solution of the canonical differential equations @xmath61 with the maximum condition @xmath62 and the transversality condition @xmath63 being satisfied , where @xmath64 + { p}^0{\\rho } \\label{eq : hamiltonian_h}\\end{aligned}\\ ] ] is the hamiltonian . note that the transversality condition asserts @xmath65 where @xmath66 is a constant vector , whose elements are lagrangian multipliers .    every 5-tuple @xmath67 on @xmath57 $ ] , if satisfying eqs .",
    "( [ eq : canonical][eq : hamiltonian_h ] ) , is called an extremal .",
    "furthermore , an extremal is called a normal one if @xmath68 and it is called an abnormal one if @xmath69 .",
    "the abnormal extremals were readily ruled out by gergaud and haberkorn @xcite .",
    "thus , only normal extremals are considered and @xmath70 is normalized in such a way that @xmath71 in this paper . according to the maximum condition in eq .",
    "( [ eq : maximum_condition ] ) , the extremal control @xmath72 is a function of @xmath73 on @xmath57 $ ] .",
    "thus , with some abuses of notations , we denote by @xmath73 on @xmath57 $ ] in tangent bundle @xmath74 the extremal and by @xmath75 on @xmath57 $ ] the corresponding maximized hamiltonian .",
    "then , @xmath76 can be written as @xmath77 where @xmath78 is the non - thrust hamiltonian and @xmath79 is the switching function .",
    "let us define by @xmath80 , @xmath81 , and @xmath82 the costates of @xmath83 , @xmath84 , and @xmath85 , respectively , such that @xmath86^t$ ] .",
    "then , the maximum condition in eq .",
    "( [ eq : maximum_condition ] ) implies @xmath87 and @xmath88 thus , the optimal direction of the thrust vector @xmath89 is collinear to @xmath81 , well known as the primer vector  @xcite .",
    "an extremal @xmath90 on @xmath57 $ ] is called a singular one if @xmath91 on a finite interval @xmath92\\subseteq[0,t_f]$ ] with @xmath93 , and the singular value of @xmath21 can be obtained by repeatedly differentiating the identity @xmath94 until @xmath21 explicitly appears @xcite .",
    "it is called a nonsingular one if the switching function @xmath95 on @xmath57 $ ] has either no or only isolated zeros .",
    "the nog for a totally singular extremal was studied by breakwell and dixon @xcite .",
    "if the thrust is continuous along a nonsingular extremal , the classical variational method @xcite can be directly employed to design the nog . in next section",
    ", the nog for bang - bang extremals will be established through constructing a parameterized family of extremals .",
    "hereafter , we always denote by @xmath96\\rightarrow t\\mathcal{x}$ ] and @xmath54\\rightarrow \\mathcal{t}$ ] the nominal extremal and the associated nominal control , respectively , and we assume the nominal extremal is readily computed .",
    "let @xmath97 be a small tubular neighbourhood of the nominal extremal @xmath98 on @xmath57 $ ] , we say every time solution trajectory @xmath99\\rightarrow t\\mathcal{x}$ ] of eqs .",
    "( [ eq : canonical][eq : transversality ] ) is a neighboring extremal of the nominal one if @xmath73 on @xmath57 $ ] lies in @xmath100 .",
    "[ de : reference ]    in next paragraph , the neighboring extremals will be parameterized .",
    "let us define a submanifold @xmath101 as @xmath102 then , according to definition [ de : reference ] , for every neighbouring extremal @xmath103 on @xmath57 $ ] , there holds @xmath104 .",
    "note that the submanifold @xmath105 is of dimension @xmath0 once the matrix @xmath106 is of full rank .",
    "the matrix @xmath106 is of full rank .",
    "[ as : full_rank ]    as a result of this assumption , let @xmath107 be a sufficiently small open neighbourhood of @xmath108 , there exists an invertible function @xmath109 such that both the function and its inverse @xmath110 are smooth .",
    "then , for every @xmath111 , there exists one and only one @xmath112 such that @xmath113 .",
    "let us define by @xmath114\\times\\f(\\mathcal{n})\\rightarrow t\\mathcal{x } , \\",
    "\\gamma(t,\\q ) = ( \\x(t),\\p(t))\\nonumber\\end{aligned}\\ ] ] the time solution trajectory of eqs .  ( [ eq : canonical][eq : transversality ] ) such that @xmath115 i.e. , there holds @xmath116 for every @xmath117 .",
    "then , let @xmath118 , we have @xmath119 on @xmath57 $ ] .    given the nominal extremal @xmath119 on @xmath57 $ ] , we denote by @xmath120,\\ \\q \\in\\boldsymbol{f}(\\mathcal{n})\\big\\}\\nonumber\\end{aligned}\\ ] ] the @xmath121-parameterized family of neighbouring extremals around the nominal extremal @xmath122 on @xmath57 $ ] .",
    "[ de : parameterized ]    for the sake of notational clarity , let us define a mapping @xmath123 that projects a submanifold from the tangent bundle @xmath74 onto the state space @xmath43",
    ".    given the nominal extremal @xmath119 on @xmath57 $ ] , we say that there exist neighboring extremals around this nominal extremal if , for every @xmath124 and every @xmath125 in an infinitesimal neighborhood of @xmath126 , there exists a small subset @xmath127 and @xmath128 such that @xmath129 . [ de : existence ]    note that the nog is constructed by using the taylor expansion of the neighboring extremal to approximate the corresponding neighboring optimal control .",
    "thus , the existence of neighboring extremals around the nominal extremal @xmath130 on @xmath57 $ ] is a prerequisite to construct the nog @xcite . in next subsection , through analyzing the projection behavior of the family @xmath131 at each time @xmath124 from @xmath74 onto @xmath43 , the conditions for the existence of neighboring extremals around a nominal one with a bang - bang control will be established .",
    "hereafter , we denote by @xmath132 the current time and let @xmath125 be the measured ( or actual ) state of the spacecraft at @xmath133 . generally speaking , there holds @xmath134 let @xmath135 be the minimum time to steer the system @xmath42 by measurable controls @xmath136\\rightarrow\\mathcal{t}$ ] from the actual state @xmath125 to a point @xmath46 , if @xmath137 for every @xmath46 , there is even not an admissible controlled trajectory on the time interval @xmath138 $ ] connecting @xmath139 and @xmath140",
    ".    there exists at least one point @xmath46 such that @xmath141 .",
    "[ as : tm ]    according to the controllability results in ref .",
    "@xcite , this assumption implies that there exists at least one fuel - optimal trajectory @xmath142 on @xmath138 $ ] such that @xmath143 and @xmath144 @xcite .",
    "however , one can not use the technique of taylor expansion to design the nog unless the fuel - optimal trajectory @xmath145 is a neighboring extremal such that the higher order terms are negligible . in this subsection ,",
    "provided that assumption [ as : tm ] is satisfied , we will establish some conditions which , once satisfied , guarantee the existence of neighboring extremals ( cf . definition [ de : existence ] ) such that the nog can be constructed .",
    "given the nominal extremal @xmath146 on @xmath57 $ ] , let assumption [ as : tm ] be satisfied for every @xmath132 and denote by @xmath147 an infinitesimal open neighborhood of the point @xmath148 .",
    "then , if the point @xmath148 lies on the boundary of the domain @xmath149 for a subset @xmath150 , no matter how small the neighborhood @xmath151 is , there are some @xmath152 such that @xmath153 , i.e , no neighboring extremals in the family @xmath131 restricted to the subset @xmath127 can pass through the point @xmath139 at @xmath133 .",
    "[ pr : diffeomorphism1 ]    if the point @xmath148 lies on the boundary of the domain @xmath149 , for every open neighborhood @xmath147 of @xmath148 , the set @xmath154 is not empty .",
    "thus , for every @xmath155 , there holds @xmath156 , which proves the proposition .",
    "if the projection @xmath157 of @xmath131 at @xmath133 is a fold singularity @xcite , the trajectories @xmath158 around @xmath133 intersect with each other as is shown by the typical picture in figure [ fig : smooth_fold ] .",
    "@xcite.,width=288 ]    as is illustrated by the right plot in figure [ fig : smooth_fold1 ] , the point @xmath159 lies on the boundary of the domian @xmath149 for every sufficiently small subset @xmath150 if the projection @xmath157 of @xmath131 at @xmath133 is a fold singularity .",
    "consequently , proposition [ pr : diffeomorphism1 ] indicates that for some sufficiently small deviation @xmath160 there holds @xmath161 for every @xmath162 once the projection @xmath157 of @xmath131 at @xmath124 is a fold singularity .",
    "given the nominal extremal @xmath146 on @xmath57 $ ] , let assumption [ as : tm ] be satisfied for every @xmath132 and denote by @xmath147 an infinitesimal open neighborhood of the point @xmath148 .",
    "then , for every @xmath163 , there exists a @xmath128 such that @xmath164 if the projection @xmath157 of @xmath131 at @xmath133 is a diffeomorphism .",
    "[ pr : diffeomorphism ]    if the projection @xmath157 of @xmath131 at @xmath133 is a diffeomorphsim as is shown by the left plot in figure [ fig : smooth_fold1 ] , the mapping @xmath165 from the domain @xmath166 onto its image is a homeomorphism .",
    "note that the subset @xmath166 is an open neighborhood of @xmath167 .",
    "thus , under the hypotheses of this proposition , the image @xmath149 is an open neighborhood of @xmath159 according to the _ inverse function theorem_. then , there exists a sufficiently small neighborhood @xmath147 of @xmath148 such that @xmath168 . referring to the _ inverse function theorem",
    "again , for every @xmath163 , there exists one and only one @xmath128 such that @xmath164 , which proves the proposition .",
    "note that the projection @xmath157 of @xmath131 loses its local diffeomorphism if it is a fold singularity .",
    "thus , as a combination of definition [ de : existence ] and propositions [ pr : diffeomorphism1 ] and [ pr : diffeomorphism ] , to formulate the conditions for the existence of neighboring extremals around @xmath98 on @xmath138 $ ] , it is enough to establish the conditions that guarantee the projection @xmath157 of the family @xmath131 at each time @xmath169 is a diffeomorphism . in next paragraph",
    ", the conditions related to the projection properties of @xmath131 at each time @xmath124 will be established .    without loss of generality , we assume that , from the current time @xmath133 on , there exist @xmath170 switching times @xmath171 ( @xmath172 ) such that @xmath173 along the nominal extremal @xmath98 on @xmath138 $ ] .    along the nominal extremal @xmath98 on @xmath138 $",
    "] , each switching point @xmath174 is assumed to be a regular one , i.e. , @xmath175 and @xmath176 for @xmath172 .",
    "[ as : regular_switching ]    as a result of this assumption , if the subset @xmath127 is small enough , the @xmath177-th switching time of the extremals @xmath178 in @xmath131 is a smooth function of @xmath121 .",
    "thus , we are able to define @xmath179 as the @xmath177-th switching time of the extremal @xmath178 on @xmath138 $ ] for @xmath117 @xcite .    set @xmath180\\times\\f(\\mathcal{n}).\\ ] ] if the matrix @xmath181 is singular at a time @xmath182 , the projection @xmath157 of the family @xmath131 at @xmath183 is a fold singularity @xcite .",
    "the matrix @xmath184 is invertible on @xmath185 , i.e. , @xmath186 \\neq 0 $ ] on @xmath185 .",
    "[ con : disconjugacy_bang ]    this condition is equivalent with the jc @xcite .",
    "if the subset @xmath127 is small enough , this condition guarantees that projection @xmath157 of the family @xmath131 on each subinterval @xmath187 for @xmath188 with @xmath189 is a diffeomorphism , see refs .",
    "@xcite . however , this condition is not sufficient to guarantee the projection @xmath157 of the family @xmath131 on the whole semi - open interval @xmath185 is a diffeomorphism because there exists another type of fold singularity near each switching time @xmath190 , as is illustrated by figure [ fig : trans ] that the trajectories @xmath191 around the switching time @xmath192 may intersect with each other @xcite .",
    "let @xmath193 and @xmath194 denote the instants a priori to and after the switching time @xmath192 , respectively . if condition [ con : disconjugacy_bang ] is satisfied , according to refs .",
    "@xcite , there exists an inverse function @xmath195 such that @xmath196 then , the set @xmath197 is the switching surface in @xmath198-space .",
    "obviously , the projection @xmath157 of @xmath131 at the switching time @xmath190 is a diffeomorphism if the flows @xmath199 on the sufficiently short interval @xmath200 $ ] with @xmath201 cross the switching surface @xmath202 transversally  @xcite . as is shown by the left plot in figure [ fig : trans ] , this transversally crossing means that , for every @xmath117 , the tangent vectors @xmath203 of the flows @xmath204 , i.e. , @xmath205 point to the same side of the switching surface @xmath202 , i.e. , @xmath206\\left[\\boldsymbol{t}_i^{-}(\\q)\\boldsymbol{n}_i(\\q)\\right]>0 , \\label{eq : tc}\\end{aligned}\\ ] ] where the vector @xmath207 denotes the normal vector of the switching surface @xmath202 at @xmath208 . in refs .",
    "@xcite , eq .",
    "( [ eq : tc ] ) is called as the tc . in contrast , the projection @xmath157 of @xmath131 at the switching time @xmath190 is a fold singularity if the tangent vectors @xmath209 point to the two different sides of the switching surface @xmath202 , i.e. , @xmath206\\left[\\boldsymbol{t}_i^{-}(\\q)\\boldsymbol{n}_i(\\q)\\right]<0 .",
    "\\label{eq : fc}\\end{aligned}\\ ] ] according to theorem 2 in ref .",
    "@xcite , the computation of eq .",
    "( [ eq : tc ] ) and eq .",
    "( [ eq : fc ] ) can be reduced to testing the sign property of @xmath210 $ ] , as is presented by the following remark .",
    "assume the subset @xmath127 is small enough and that assumption [ as : regular_switching ] is satisfied .",
    "then , for every @xmath211 , eq .",
    "( [ eq : tc ] ) is satisfied if and only if @xmath212\\text{det}\\left[\\frac{\\partial \\x}{\\partial \\q}(t_{i}^-({\\q}),{\\q})\\right ] > 0.\\nonumber\\end{aligned}\\ ] ] and , eq .",
    "( [ eq : fc ] ) is satisfied if and only if @xmath213\\text{det}\\left[\\frac{\\partial \\x}{\\partial \\q}(t_{i}^-(\\q),{\\q})\\right ] < 0",
    ". \\label{eq : fc1}\\end{aligned}\\ ] ]    let the strict inequality @xmath214\\text{det}\\left[\\frac{\\partial \\x}{\\partial \\q}(t_{i}^-(\\bar{\\q}),\\bar{\\q})\\right ] > 0 $ ] be satisfied at each switching time @xmath171 ( @xmath172 ) of the nominal extremal @xmath98 on @xmath138 $ ] . [ as : transversal ]    according to previous analysis , if assumption [ as : regular_switching ] is satisfied and the subset @xmath127 is small enough , conditions [ con : disconjugacy_bang ] and [ as : transversal ] are sufficient to guarantee the projection @xmath157 of @xmath131 at each time @xmath169 is a diffeomorphism .",
    "then , according to proposition [ pr : diffeomorphism ] , one obtains the following result .    given the nominal extremal @xmath98 on @xmath138 $ ] such that each switching point is regular ( cf .",
    "assumption [ as : regular_switching ] ) , let _ assumption _ [ as : tm ] be satisfied for every @xmath132 .",
    "then , for every measured state @xmath125 in an infinitesimal neighborhood of @xmath126 , there exists a @xmath128 such that @xmath215 if _ conditions _ [ con : disconjugacy_bang ] and [ as : transversal ] are satisfied .",
    "[ co : existence ]    therefore , the conditions sufficient for the existence of neighboring extremals consist of not only the jc ( or condition [ con : disconjugacy_bang ] ) between switching times but also the tc ( or condition [ as : transversal ] ) at each switching time once the nominal control is discontinuous .    by applying _ theorem 17.2 _ in ref .",
    "@xcite or the _ shadow - price lemma _ in refs .",
    "@xcite , one can directly obtain the following result for optimality .    given the nominal extremal @xmath98 on @xmath138 $ ] such that each switching point is regular ( cf .",
    "assumption [ as : regular_switching ] ) , if conditions [ con : disconjugacy_bang ] and [ as : transversal ] are satisfied , the nominal trajectory @xmath216 on @xmath138 $ ] realizes a minimum cost of eq .",
    "( [ eq : cost_functional ] ) with respect to every admissible controlled trajectory @xmath217 on @xmath138 $ ] in @xmath218 associated with the measurable control @xmath219\\rightarrow \\mathcal{t}$ ] with the same endpoints @xmath220 and @xmath221 , i.e. , there holds @xmath222 where the equality holds if and only if @xmath223 on @xmath138 $ ] .",
    "[ th : optimality ]    consequentely , _ conditions _ [ con : disconjugacy_bang ] and [ as : transversal ] are also sufficient to guarantee the local optimizer or the absence of conjugate points on the nominal extremal @xmath98 on @xmath138 $ ] .",
    "note that a conjugate point , beyond which the reference extremal loses its local optimality , occurs at the switching time @xmath192 of the extremal @xmath178 on @xmath185 if eq .",
    "( [ eq : fc1 ] ) is satisfied  @xcite .",
    "notice that the matrix @xmath224\\left[{\\partial \\x(t_i^{\\pm},\\bar{\\q})}/{\\partial \\q}\\right]^{-1}$ ] can keep bounded even though eq .",
    "( [ eq : fc1 ] ) is satisfied .",
    "hence , the classical variational method @xcite , which detects conjugate points through testing the unbounded time of the matrix @xmath225\\left[{\\partial \\x(t,\\bar{\\q})}/{\\partial \\q}\\right]^{-1}$ ] , fails to detect the occurrence of conjugate points at switching times .",
    "one has to test eq .",
    "( [ eq : fc1 ] ) at each switching time to see if a conjugate point occurs at the switching time .      as is explained in sect .",
    "[ se : introduction ] , a spacecraft can not exactly move on the nominal trajectory @xmath226 on @xmath57 $ ] .",
    "according to corollary [ co : existence ] , if conditions [ con : disconjugacy_bang ] and [ as : transversal ] are satisfied and the deviation @xmath160 is small enough , there then exists a @xmath128 such that @xmath227 .",
    "obviously , once the new extremal @xmath228 on the interval @xmath138 $ ] is computed , if no further perturbations occur for @xmath229 , the spacecraft can be steered by the associated new optimal control function @xmath230 on @xmath138 $ ] to fly to @xmath140 .",
    "though various numerical methods , e.g. , direct ones , indirect ones , and hybrid ones , are available in the literature to compute @xmath228 on @xmath138 $ ] , the onboard computer can merely afford this computation in each guidance cycle , especially for the low - thrust orbital transfer problem with a long duration .",
    "next , the neighboring optimal feedback control strategy , which is the first - order taylor expansion of the optimal control @xmath230 on @xmath138 $ ] , will be derived such that the spacecraft can be controlled to move closely enough along the extremal trajectory @xmath231 on @xmath138 $ ] if the deviation @xmath160 is small enough .",
    "note that @xmath232 is exactly the @xmath177-th switching time of the new extremal @xmath228 on @xmath138 $ ] .",
    "set @xmath233 , the first - order taylor expansion of @xmath232 is @xmath234 where @xmath235 is the sum of second and higher order terms .",
    "note that there holds @xmath236 for every @xmath117 .",
    "differentiating the identity @xmath237 with respect to @xmath121 yields @xmath238 note that @xmath239 by assumption [ as : regular_switching ] , one obtains @xmath240/\\dot{h}_1(\\bar{\\x}(t_i),\\bar{\\p}(t_i ) ) , \\label{eq : variation_switching_time}\\end{aligned}\\ ] ] where two vectors @xmath241 @xmath242 can be directly computed once the nominal extremal @xmath119 on @xmath138 $ ] is given . according to corollary [ co : existence ] , for every sufficiently small @xmath160 and every time @xmath132 , one has the following first - order taylor expansion @xmath243^{-1}\\delta",
    "\\x+ o_{\\q}({\\left \\| \\delta \\x\\right \\|}^2 ) , \\label{eq : delta_q}\\end{aligned}\\ ] ] where @xmath244 denotes the sum of second and higher order terms . for notational clarity ,",
    "let us define a matrix - valued function @xmath245\\rightarrow \\mathbb{r}^{n\\times n}$ ] as @xmath246^{-1}. \\label{eq : s}\\end{aligned}\\ ] ] set @xmath247^{-1}\\delta \\x,\\end{aligned}\\ ] ] it is clear that @xmath248 is the first - order term of the deviation @xmath249 .",
    "substituting eq .",
    "( [ eq : delta_q ] ) and eq .",
    "( [ eq : variation_switching_time ] ) into eq .",
    "( [ eq : delta_ti ] ) , one gets @xmath250",
    "\\delta \\x_i /\\dot{h}_1(\\bar{\\x}(t_i),\\bar{\\p}(t_i))\\nonumber\\\\ & + & \\frac{d t_i(\\bar{\\q})}{d\\q } o_{\\q}({\\left \\| \\delta",
    "\\x\\right \\|}^2 )    + o_{t_i}({\\left \\|",
    "\\delta \\q\\right \\|}^2 ) .\\nonumber \\ ] ] let @xmath251 \\delta \\x_i /\\dot{h}_1(\\bar{\\x}(t_i),\\bar{\\p}(t_i ) ) , \\label{eq : delta_ti}\\end{aligned}\\ ] ] be the first - order term of @xmath252 . then , if @xmath160 is infinitesimal , it suffices to use @xmath253 as the neighboring optimal feedback on switching times .",
    "note that there may exist some profiles of the switching function @xmath254 as is shown by the solid line in figure [ fig : h1_time ] .",
    "then , a small perturbation may result in the change on the number of switching times , as is illustrated by the two dashed lines in figure [ fig : h1_time ] .    however , eq .  ( [ eq : delta_ti ] ) is unable to provide the feedback on switching times if the number of switching times on the neighboring extremal is different from that of the nominal one",
    ". set @xmath255^t:=\\delta \\p = \\p(t_0,\\q _ * ) - \\p(t_0,\\bar{\\q})$ ] and @xmath256^t : = \\delta \\x$ ] . according to eq .",
    "( [ eq : max_condition1 ] ) , the switching function @xmath257 gives a natural feedback on the optimal thrust magnitude of the new extremal @xmath228 at @xmath133 , i.e. , @xmath258/2 \\nonumber\\\\ & = & \\big[1 + \\mathrm{sgn}\\big(\\frac{\\|\\bar{\\p}_v(t_0 ) + \\delta \\p_v\\|}{\\bar{m}(t_0 ) + \\delta m } u_{max}- \\beta ( \\bar{p}_m(t_0 ) + \\delta p_m ) u_{max } - 1\\big)\\big]/2,\\nonumber\\end{aligned}\\ ] ] where @xmath259 is the typical sign function .",
    "thus , instead of using the first order term @xmath260 in eq .",
    "( [ eq : delta_ti ] ) to approximate switching times , one can directly check the sign of the switching function @xmath261 to generate the optimal thrust magnitude once @xmath262 and @xmath263 are computed .",
    "the first - order taylor expansion of @xmath264 around @xmath167 is @xmath265 where @xmath266 is the sum of second and higher order terms . substituting eq .",
    "( [ eq : delta_q ] ) into eq .",
    "( [ eq : delta_p0 ] ) leads to @xmath267 denote by @xmath268 the first three rows , @xmath269 the forth to sixth rows , and @xmath270 the last row of the gain matrix @xmath271 such that @xmath272 it is clear that @xmath273 and @xmath274 are the first order terms of @xmath262 and @xmath263 , respectively .",
    "thus , if @xmath160 is small enough , it is sufficient to use @xmath275/2 , \\label{eq : thrust_magnitude}\\end{aligned}\\ ] ] as the neighboring optimal feedback on thrust magnitude .      according to eq .",
    "( [ eq : max_condition2 ] ) , if @xmath276 , the optimal thrust direction on the new extremal @xmath228 at @xmath133 is @xmath277 analogously , assume @xmath160 is infinitesimal , if @xmath278 , we can use @xmath279 as the neighboring optimal feedback on the thrust direction .    one advantage of using eq .",
    "( [ eq : thrust_magnitude ] ) and eq .",
    "( [ eq : thrust_direction ] ) to generate neighboring optimal feedbacks is that only @xmath280 instead of the whole block of the time - varying gain matrix @xmath281 on @xmath282 is required to store in the onboard computer .",
    "[ re : remark2 ]",
    "once the perturbation @xmath160 is measured at @xmath132 , it amounts to compute the two matrices @xmath283 and @xmath284 in order to compute the neighbouring optimal feedbacks in eq .",
    "( [ eq : thrust_magnitude ] ) and eq .",
    "( [ eq : thrust_direction ] ) .",
    "it follows from the classical results about solutions to ordinary differential equations that the trajectory @xmath286 and its time derivative @xmath287 on @xmath138 $ ] are continuously differentiable with respect to @xmath121 .",
    "thus , taking derivative of eq .",
    "( [ eq : canonical ] ) with respect to @xmath121 on each subinterval @xmath187 yields the homogeneous linear matrix differential equations @xmath288 = \\left [ \\begin{array}{cc } h_{\\p\\x}(\\bar{\\x}(t),\\bar{\\p}(t ) ) & h_{\\p\\p}(\\bar{\\x}(t),\\bar{\\p}(t ) )     \\\\",
    "-h_{\\x\\x}(\\bar{\\x}(t),\\bar{\\p}(t ) )   & -h_{\\x\\p}(\\bar{\\x}(t),\\bar{\\p}(t ) )   \\end{array } \\right ] \\left[\\begin{array}{c } \\frac{\\partial \\x}{\\partial\\q}(t,\\bar{\\q})\\\\ \\frac{\\partial \\p}{\\partial \\q}(t,\\bar{\\q } ) \\end{array } \\label{eq : homogeneous_matrix } \\right].\\end{aligned}\\ ] ] substituting the maximum condition in eq .  ( [ eq : max_condition2 ] ) and the system dynamics in eq .  ( [ eq : sigma ] ) into the maximized hamiltonian @xmath289 , a direct derivation yeilds @xmath290,\\nonumber\\end{aligned}\\ ] ] @xmath291,\\ \\text{and}\\nonumber\\end{aligned}\\ ] ] @xmath292,\\nonumber\\end{aligned}\\ ] ] where @xmath293 and @xmath294 denote the zero and the identity matrices of @xmath295 , respectilvey , and @xmath296 denotes the zero matrix of @xmath297 .",
    "the two matrices @xmath181 and @xmath298 are discontinuous at each switching time @xmath190 ( @xmath172 ) . by virtue of lemma 2.6 in ref .",
    "@xcite , the updating formulas for the two matrices at each switching time @xmath190 are @xmath299 where @xmath300 , @xmath301,\\ ] ] and @xmath302 can be computed by using eq .",
    "( [ eq : variation_switching_time ] ) .    once the initial values @xmath303 and",
    "@xmath304 are given , the two matrices @xmath181 and @xmath298 for @xmath305 $ ] can be computed by integrating the differential equations in eq .",
    "( [ eq : homogeneous_matrix ] ) between switching times and by using the updating formulas in eq .",
    "( [ eq : update_formula ] ) at each switching time .",
    "typically , the sweep variables are used to compute the initial values @xmath303 and @xmath304  @xcite .",
    "note that the matrix @xmath306 = \\frac{d\\f^{-1}(\\bar{\\q})}{d\\q}\\nonumber\\end{aligned}\\ ] ] is a set of basis vectors of the tangent space @xmath307 at @xmath308 .",
    "thus , to compute the initial values @xmath303 and @xmath304 , it amounts to compute a basis of the tangent space @xmath307 at @xmath308 .",
    "if @xmath309 , the final state is fixed since the submanifold @xmath140 reduces to a singleton .",
    "thus , in the case of @xmath309 , one can simply set @xmath310 , which indicates @xmath311      note that @xmath313 and @xmath314 .",
    "thus , the subset @xmath315 is diffeomorphic to @xmath316 if the subset @xmath127 is small enough . in analogy with parameterizing neighbouring extremals ,",
    "if the subset @xmath127 is small enough and @xmath317 , there exists an invertible function @xmath318 such that both the function and its inverse @xmath319 are smooth .",
    "then , for every @xmath320 , there exists one and only one @xmath321 such that @xmath322 . according to the transversality condition in eq .",
    "( [ eq : transversality ] ) , for every @xmath112 , there exists a @xmath323 such that @xmath324 let us define a function @xmath325 as @xmath326^{-1},\\nonumber\\end{aligned}\\ ] ] such that @xmath327 . by assumption",
    "[ as : full_rank ] , if the subset @xmath127 is small enough , the function @xmath328 is a diffeomorphism from the domain @xmath127 onto its image .",
    "thus , it is enough to set @xmath329 $ ] such that @xmath330 $ ] .",
    "let @xmath331 , we have @xmath332 where @xmath333 denotes the vector of the lagrangian multipliers for the nominal extremal @xmath130 on @xmath57 $ ] .",
    "a direct calculation leads to @xmath334,\\label{eq : initial_matrix3x}\\\\ \\frac{\\partial \\p}{\\partial \\q}(t_f,\\bar{\\q } ) & = & \\left[\\frac{\\partial \\p(t_f,\\bar{\\q})}{\\partial \\q_1},\\ \\frac{\\partial \\p(t_f,\\bar{\\q})}{\\partial \\boldsymbol{\\nu}}\\right]\\nonumber\\\\ & = & \\left[\\sum_{i=1}^{l}{\\bar{{\\nu}}_i   \\nabla^2 \\phi_i}({\\x}(t_f,\\bar{\\q}))\\frac{\\partial   \\x(t_f,\\bar{\\q})}{\\partial \\q_1},\\ { \\nabla \\phi^t(\\x(t_f,\\bar{\\q } ) ) } \\right ] , \\label{eq : initial_matrix3}\\end{aligned}\\ ] ] where @xmath335 and @xmath336 for @xmath337 are the elements of the vector - valued function @xmath338 and the vector @xmath339 , respectively .",
    "since @xmath340 is not a function of @xmath341 , there holds @xmath342 note that , except the matrix @xmath343 , all the quantities for computing the initial conditions in eq .",
    "( [ eq : initial_matrix3x ] ) and eq .",
    "( [ eq : initial_matrix3 ] ) are available .",
    "let us take the differentiation of @xmath344 with respect to @xmath345 , we get @xmath346 note that all the column vectors of the matrix @xmath347 constitute a basis of the tangent space @xmath348 .",
    "once the matrix @xmath349 is given , one can compute the full - rank matrix @xmath343 by a gram - schmidt orthogonalization , which can be numerically done by employing the _ gram _ function of matlab .",
    "up to now , all the quantities for computing the initial conditions @xmath303 in eq .",
    "( [ eq : initial_matrix3x ] ) and @xmath304 in eq .",
    "( [ eq : initial_matrix3 ] ) are available for @xmath317 .",
    "note that one has to solve a @xmath350 order of differential equations in order to compute the matrix @xmath351 if using eq .",
    "( [ eq : homogeneous_matrix ] ) and eq .",
    "( [ eq : update_formula ] ) . in this subsection",
    ", the differential equations of the gain matrix @xmath351 will be derived such that only @xmath352 order of differential equations are required to solve .    according to eq .",
    "( [ eq : s ] ) , we have @xmath353 on @xmath57 $ ] . differentiating this equation with respect to time yields @xmath354 on @xmath57",
    "$ ] . substituting eq .",
    "( [ eq : homogeneous_matrix ] ) into this equation , we hence obtain @xmath355 on @xmath57 $ ] , which is exactly the riccati - type differential equation in refs .",
    "@xcite . according to eq .",
    "( [ eq : update_formula ] ) , the gain matrix @xmath281 is discontinuous at each switching time @xmath190 .",
    "assume the matrix @xmath356 is nonsingular , multiplying @xmath357 by @xmath358^{-1}$ ] and taking into account eq .",
    "( [ eq : update_formula ] ) , one obtains @xmath359^{-1}\\nonumber\\\\ & = & \\left [ \\frac{\\partial \\p}{\\partial \\q}(t_i^+,\\bar{\\q } ) -",
    "\\delta \\rho_i \\frac{\\partial   \\f_1}{\\partial \\x}(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i))\\bar{\\p}(t_i)\\frac{\\partial t_i(\\bar{\\q})}{\\partial \\q}\\right]\\nonumber\\\\ & \\times&\\left [ \\frac{\\partial \\x}{\\partial \\q}(t_i^+,\\bar{\\q } )   + \\delta \\rho_i \\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i))\\frac{\\partial t_i(\\bar{\\q})}{\\partial \\q}\\right]^{-1}\\nonumber\\\\ & = & \\left\\ { s(t_i^+ ) - \\delta \\rho_i \\frac{\\partial   \\f_1}{\\partial \\x}(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i))\\bar{\\p}(t_i)\\frac{\\partial t_i(\\bar{\\q})}{\\partial \\q}\\left[\\frac{\\partial \\x}{\\partial \\q}(t_i^+,\\bar{\\q})\\right]^{-1}\\right\\}\\nonumber\\\\ & \\times&\\frac{\\partial \\x}{\\partial \\q}(t_i^+,\\bar{\\q})\\left [ \\frac{\\partial \\x}{\\partial \\q}(t_i^+,\\bar{\\q } )   +",
    "\\delta \\rho_i \\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i))\\frac{\\partial t_i(\\bar{\\q})}{\\partial \\q}\\right]^{-1}. \\label{eq : s_long}\\end{aligned}\\ ] ] let us define a vector - valued function @xmath360 as @xmath361^{-1}.\\nonumber\\end{aligned}\\ ] ] substituting this equation into eq .",
    "( [ eq : variation_switching_time ] ) yields @xmath362/\\dot{h}_1(\\bar{\\x}(t_i),\\bar{\\p}(t_i)).\\nonumber\\end{aligned}\\ ] ] given a nonsingular matrix @xmath363 and two vectors @xmath364 and @xmath365 , if the matrix @xmath366 is nonsingular , the equation @xmath367 is satisfied ( cf .",
    "lemma 6.1.4 in ref .",
    "thus , if the matrix @xmath368 is nonsingular , taking into account eq .",
    "( [ eq : lemma_equation ] ) , one gets @xmath369^{-1}\\nonumber\\\\   & = & i_n - \\delta \\rho_i \\frac { \\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i ) ) r(t_i ) } { 1 + \\delta \\rho_i r(t_i)\\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i ) ) } .\\nonumber\\end{aligned}\\ ] ] substituting this equation into eq .",
    "( [ eq : s_long ] ) , we eventually obtain the result @xmath370\\nonumber\\\\ & & \\times \\left[i_n -\\delta \\rho_i \\frac{\\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i ) ) r(t_i)}{1 + \\delta \\rho_i r(t_i)\\f_1(\\bar{\\x}(t_i),\\bar{\\boldsymbol{\\tau}}(t_i))}\\right ] .",
    "\\label{eq : update_riccati}\\end{aligned}\\ ] ] this formula provides the required initial condition for eq .",
    "( [ eq : riccati_equation ] ) on the interval @xmath371 .",
    "then , the gain matrix @xmath281 can be propagated further backward by integrating the ricatti differential equation in eq .",
    "( [ eq : riccati_equation ] ) .",
    "note that @xmath372 since the matrix @xmath303 is singular .",
    "one can use eq .",
    "( [ eq : homogeneous_matrix ] ) to integrate backward from @xmath373 on a short interval @xmath374 $ ] with @xmath375 to get the matrices @xmath376 and @xmath377 . then , substituting the matrices @xmath376 and @xmath377 into the matrix @xmath378 , one can use eq .",
    "( [ eq : riccati_equation ] ) and eq .",
    "( [ eq : update_riccati ] ) to get @xmath281 on @xmath379 $ ] .",
    "once the matrix @xmath281 on @xmath282 is computed offline , the matrices @xmath380 and @xmath381 on @xmath282 can be stored in the onboard computer such that the online computation is just to solve eq .",
    "( [ eq : thrust_magnitude ] ) and eq .",
    "( [ eq : thrust_direction ] ) .    if the sweep variables ( cf . chapter 6 in ref .",
    "@xcite , chapter 5 in ref .",
    "@xcite , or chapter 11 in ref .",
    "@xcite ) are employed to calculate the initial values @xmath303 and @xmath304 , to compute the neighboring optimal feedbacks in eq .",
    "( [ eq : thrust_magnitude ] ) and eq .",
    "( [ eq : thrust_direction ] ) , not only the gain matrix @xmath351 but also two other time - varying matrices of @xmath382 and @xmath383 have to be computed offline .",
    "thus , the method of this paper not only demands less storage capacity ( cf .",
    "remark [ re : remark2 ] ) but also requires less offline computational time .",
    "in this section , we consider to control a spacecraft from an inclined elliptic orbit to the earth geostationary orbit .",
    "denote by @xmath384 , @xmath385 , @xmath177 , @xmath386 , @xmath387 , @xmath388 the semi - major axis , the eccentricity , the inclination , the argument of periapsis , the argument of ascending node , and the true anomaly of the classical orbital elements ( coe ) .",
    "the conditions for initial and final orbits are presented in table [ tab : parameters ] in terms of the coe .",
    ".the initial and final conditions in terms of the coe . [ cols=\"^,^,^\",options=\"header \" , ]     [ tab : parameters ]    the earth gravitational constant @xmath389 in eq .",
    "( [ eq : system ] ) equals @xmath390 km@xmath391@xmath392 .",
    "the maximum thrust of the engine is @xmath393 n and the specific impulse of the engine is @xmath394 s. let @xmath395 m / s@xmath396 be the standard gravity at the surface of the earth , we have @xmath397 m@xmath398 .",
    "the initial mass @xmath399 of the spacecraft is @xmath400 kg . we specify the final time as @xmath401 hours .    in order to achieve a stable numerical computation @xcite , we use the _ modified elementary orbital elements _ ( meoe ) , @xmath402 to compute optimal trajectories .",
    "note that the initial true longitude is @xmath403 , see table [ tab : parameters ] . in order to realize a multi - burn trajectory ,",
    "we specify the final true longitude as @xmath404 such that the spacecraft flies 9 revolutions around the earth to get to the final orbit .      one can combine the final boundary condition in table [ tab : parameters ] and the transversality condition in eq .",
    "( [ eq : transversality ] ) to formulate a tpbvp  @xcite .",
    "then , it is enough to find the zero of this tpbvp in order to get the optimal solution .",
    "a simple shooting method is not stable to solve the tpbvp because one usually does not know a priori the structure of the optimal control function .",
    "thus , we use a regularization procedure developed in ref .",
    "@xcite to first get an energy - optimal trajectory with the same boundary conditions .",
    "then , a homotopy method is employed to get the low - thrust fuel - optimal trajectory with a bang - bang control .",
    "the 3-dimensional position vector @xmath405 on @xmath57 $ ] is plotted in figure [ fig : transferring_orbit3 ] ,     on @xmath57 $ ] for the low - thrust multi - burn fuel - optimal orbital transfer problem in a cartesian coordinate system .",
    "the red arrows denote the thrust direction on burn arcs.,scaledwidth=80.0% ]    which shows that all the burn arcs occur around the apogees and perigees . to see the regularity conditions , figure [ fig : transferring_orbit4 ] plots the profiles of @xmath406 , @xmath407 , and @xmath408 with respect to time on @xmath57 $ ] .",
    "it is seen from this figure that the number of burn arcs along the low - thrust fuel - optimal trajectory is 13 with 24 switching points and that each switching point is regular , i.e. , assumption [ as : regular_switching ] holds along the computed extremal .",
    "the profiles of semi - major axis @xmath384 , eccentricity @xmath385 , and inclination @xmath177 along the low - thrust fuel - optimal trajectory are plotted in figure [ fig : a_e_i ] .",
    "note that , except the final mass @xmath409 , all other final states are fixed if we use the _ meoe _ as states such that @xmath410 and @xmath411 thus , applying eqs .",
    "( [ eq : initial_matrix2][eq : initial_matrix3 ] ) , we get the initial condition as @xmath412 then , starting from this initial condition , we propogate eq .",
    "( [ eq : homogeneous_matrix ] ) backward from the final time @xmath373 and use the updating formulas in eq .",
    "( [ eq : update_formula ] ) at each switching time to compute the matrices @xmath413 and @xmath414 on @xmath57 $ ] .    for notational simplicity ,",
    "let @xmath415 $ ] on @xmath57 $ ] . to have a clear view",
    ", the profile of @xmath416 instead of @xmath417 on @xmath57 $ ] is ploted in the top subplot of figure [ fig : det_4xtf ] .",
    "note that @xmath418 on @xmath57 $ ] can capture the sign property of @xmath417 on @xmath57 $ ] .",
    "we can clearly see from this figure that conditions [ con : disconjugacy_bang ] and [ as : transversal ] are satisfied on @xmath282 . according to theorem [ th : optimality ] ,",
    "the low - thrust multi - burn fuel - optimal trajectory on @xmath57 $ ] realizes a local optimum .",
    "in addition , according to corollary [ co : existence ] , for every sufficiently small deviation @xmath160 from the nominal trajectory @xmath216 at every time @xmath132 , there exists a neighbouring extremal @xmath73 on @xmath57 $ ] in @xmath131 such that @xmath419 .",
    "thus , the nog can be constructed along the computed extremal trajectory .    in order to see the occurrence of focal points or to see the sign changes of @xmath420 , the profile of @xmath421 on the extended time interval @xmath422 $ ]",
    "is plotted in the bottom subplot of figure [ fig : det_4xtf ] .",
    "note that there exists a sign change of @xmath420 at the switching time @xmath423 h. thus , condition [ as : transversal ] is violated at @xmath424 , i.e. , a focal point occurs at @xmath425 , which implies that the nominal extremal @xmath98 on @xmath138 $ ] is not optimal any more if @xmath426 @xcite .",
    "in addition , as is shown by corollary [ co : existence ] , no matter how small the absolute value @xmath427 is , there exist some unit vectors @xmath428 such that @xmath429 for every @xmath117 . hence , though the jc of refs .",
    "@xcite is satisfied , it is impossible to construct the nog along the computed extremal on @xmath138 $ ] with @xmath426 since none of neighboring extremals can pass through the point @xmath430 ( cf . proposition [ pr : diffeomorphism1 ] ) .",
    "let @xmath431 and @xmath432^t$ ] .",
    "a series of deviations @xmath433 for @xmath434 $ ] are considered as the disturbances on the initial state @xmath45 .",
    "then , assuming no further perturbations occur for @xmath229 , for every @xmath434 $ ] , the trajectories starting from the point @xmath435 associated with the neighbouring optimal feedback control in eq .",
    "( [ eq : thrust_magnitude ] ) and eq .  ( [ eq : thrust_direction ] ) as well as the nominal control are computed .",
    "hereafter , we say the trajectories associated with the neighboring optimal feedback control as the neighboring optimal ones , and we say the trajectories associated with the nominal control as the perturbed ones .",
    "the final values of @xmath384 , @xmath436 , and @xmath437 with respect to @xmath434 $ ] for the neighboring optimal trajectories and for the perturbed trajectories are plotted in figure [ fig : error_a_ex_ey ] .    besides , the final values of @xmath438 , @xmath439 , and @xmath37 with respect to @xmath434 $ ] for the neighboring optimal trajectories and the perturbed trajectory are plotted in figure [ fig : error_hx_hy_l ] .    as is seen from figure [ fig : error_a_ex_ey ] , when @xmath440 increases up to @xmath441 , while the error of the final semi - major axis @xmath384 for the neighboring optimal trajectory remains small , that for the perturbed trajectory increases up to approximately @xmath442 km .",
    "we can also see from figures [ fig : error_a_ex_ey ] and [ fig : error_hx_hy_l ] that the final values of @xmath436 , @xmath437 , @xmath438 , @xmath439 , and @xmath37 for the neighboring optimal trajectories keep almost unchanged for @xmath443 $ ] . however , the final values of @xmath436 , @xmath437 , @xmath438 , @xmath439 , and @xmath37 for the perturbed trajectories increase rapidly with the increase of @xmath440 on @xmath444 $ ] . therefore , the neighboring optimal feedback control in eq .  ( [ eq : thrust_magnitude ] ) and eq .",
    "( [ eq : thrust_direction ] ) greatly reduce the errors of final conditions .    to see the advantage of using eq .",
    "( [ eq : thrust_magnitude ] ) rather than eq .",
    "( [ eq : delta_ti ] ) to provide the neighboring optimal feedback on thrust magnitude , the profiles of switching function @xmath445 on the time interval @xmath446 $ ] along the neighboring extremals with respect to @xmath447 $ ] are plotted in figure [ fig : variaion_h1 ] .",
    "we can clearly see from this figure that some switching times disappear around @xmath448 and @xmath449 with the increase of @xmath440 . in this case",
    ", while eq .",
    "( [ eq : delta_ti ] ) can not capture the variations of switching times , one can still compute the thrust magnitude of neighboring optimal trajectories by using eq .",
    "( [ eq : thrust_magnitude ] ) .",
    "though the disturbances are relativly big as @xmath440 takes values up to @xmath450 , figure [ fig : variaion_h1 ] shows the potential failure of using eq .",
    "( [ eq : delta_ti ] ) .",
    "the neighbouring optimal feedback control strategy for fixed - time low - thrust multi - burn orbital transfer problems is established in this paper through constructing a parameterized family of neighboring extremals around the nominal one .",
    "two conditions , including the jc and the tc , sufficient for the existence of neighbouring extremals in an infinitesimal neighborhood of a bang - bang extremal are formulated . as a byproduct ,",
    "the sufficient conditions for the local optimality of bang - bang extremals are obtained .",
    "then , through deriving the first - order taylor expansion of the paramterised neighboring extremals , the neighboring optimal feedbacks on thrust direction as well as on thrust magnitude are presented .",
    "the formulas of the neighboring optimal feedbacks show that to store only @xmath280 rather than the whole block of a gain matrix of @xmath451 in the onboard computer is sufficient to realize the online computation .",
    "finally , a fixed - time low - thrust orbital transfer from an inclined elliptic orbit to the earth geostationary orbit is computed , and various initial perturbations are tested to show that the nog developed in this paper significantly reduces the errors of final conditions .",
    "the nog for open - time multi - burn orbital transfers will be studied in the subsequent research .",
    "chuang , c .- h . , goodson , t. d. , ledsinger , l. a. , and hanson , j. , `` optimality and guidance for plannar multiple - burn orbital transfers , '' _ journal of guidance , control , and dynamics _",
    "23 , no . 2 , 1996 , pp .",
    "241 - 250 .",
    "calise , a. j. , melamed , n. , and lee , s. , `` design and evaluation of a three - dimensional optimal ascent guidance algorithm , '' _ journal of guidance , control , and dynamics _ , vol .",
    "6 , 1998 , pp . 867875 .                        noble , j. and schttler , h. , `` sufficient conditions for relative minima of broken extremals in optimal control theory , '' _ journal of mathematical analysis and applications _",
    ", vol . 269 , 2002 , pp.98 - 128 .",
    "agrachev , a. a. and sachkov , y. l. , `` control theory from the geometric viewpoint , '' _ encyclopedia of mathematical sciences _ ,",
    "87 , control theory and optimization , ii .",
    "springer - verlag , berlin , 2004 .",
    "kugelmann , b. , and pesch , h. j. , `` new general guidance method in constrained optimal control , part 1 : numerical method , '' journal of optimization theory and applications , vol .",
    "67 , no . 3 , 1990 , pp",
    ". 421436 .",
    "kugelmann , b. , and pesch , h. j. , `` new general guidance method in constrained optimal control , part 2 : application to space shuttle guidance , '' journal of optimization theory and applications , vol .",
    "67 , no . 3 , 1990 , pp .",
    "437446 .",
    "pontani , m. , cecchetti , g. , and teofilatto , p. , `` variable - time - domain neighboring optimal guidance , part 1 : algorithm structure , '' _ journal of optimization theory and applications _ ,",
    "vol . 166 , 2015 , pp .",
    "pontani , m. , cecchetti , g. , and teofilatto , p. , `` variable - time - domain neighboring optimal guidance , part 2 : application to lunar descent and soft landing , '' _ journal of optimization theory and applications _ , vol . 166 , 2015 , pp . 93114 .",
    "afshari , h. h. , novinzadeh , a. b. , and roshanian , j. , `` determination of nonlinear optimal feedback law for satellite injection problem using neighboring optimal control , '' _ american journal of applied sciences _ , vol . 6 , no . 3 , 2009 , pp .",
    "430438 .",
    "shafieenejad , i. , novinzade , a. b. , and shisheie , r. , `` analytical mathematical feedback guidance scheme for low - thrust orbital plane change manoeuvres , '' _ mathematical and computer modelling _ , vol .",
    "58 , no . 1112 , 2013 , pp .",
    "17141726 .",
    "naidu , d. s. , hibey , j. l. , and charalambous , c. d. , `` neighboring optimal guidance for aeroassisted orbital transfers , '' _ in aerospace and electronic systems , ieee transaction on _ , vol , 29 , no . 3 , 1993 , pp .",
    "656665 .",
    "foerster , r. e. , and flgge - lotz , i. , `` a neighboring optimal feedback control scheme for systems using discontinuous control , '' _ journal of optimization theory and applications _ , vol .",
    "8 , no . 5 , 1971 , pp . 367395 .",
    "caillau , j .- b . ,",
    "gergaud , j. , and noailles , j. , `` 3d geosynchronous transfer of a satellite : continuation on the thrust , '' _ journal of optimization theory and applications _ , vol .",
    "118 , no . 3 , 2003 , pp .",
    "541 - 565 ."
  ],
  "abstract_text": [
    "<S> this paper presents a novel neighboring extremal approach to establish the neighboring optimal guidance ( nog ) strategy for fixed - time low - thrust multi - burn orbital transfer problems . unlike the classical variational methods which define and </S>",
    "<S> solve an accessory minimum problem ( amp ) to design the nog , the core of the proposed method is to construct a parameterized family of neighboring extremals around a nominal one . </S>",
    "<S> a geometric analysis on the projection behavior of the parameterized neighboring extremals shows that it is impossible to establish the nog unless not only the typical jacobi condition ( jc ) between switching times but also a transversal condition ( tc ) at each switching time is satisfied . </S>",
    "<S> according to the theory of field of extremals , the jc and the tc , once satisfied , are also sufficient to ensure a multi - burn extremal trajectory to be locally optimal . </S>",
    "<S> then , through deriving the first - order taylor expansion of the parameterized neighboring extremals , the neighboring optimal feedbacks on thrust direction and switching times are obtained . finally , to verify the development of this paper , a fixed - time low - thrust fuel - optimal orbital transfer problem is calculated . </S>"
  ]
}