{
  "article_text": [
    "the scenario we treat in this work is the following  @xcite : two parties , alice and bob , are located in distant laboratories and receive a bipartite system from a source .",
    "one of the two parties , say alice , does not trust her measuring devices , which are treated as `` black boxes '' .",
    "she can , nevertheless , choose which measurement to perform , which she labels by @xmath1 , each of which provides an outcomes , which she labels @xmath2 .",
    "the other party , bob , has complete knowledge of his device , which allows him to perform quantum state tomography on his part of the system , and thus to obtain a complete description of his subsystem ( see fig .  [",
    "fig : setup ] ( a ) ) .",
    "the states reconstructed by bob will usually depend on alice s input and output as @xmath3/p(a|x)$ ] , where @xmath4 is the unknown state shared with alice , @xmath5 is the probability that alice observes outcome @xmath6 given she chose @xmath7 , and @xmath8 is the corresponding ( unknown ) element of alice s measurement .",
    "the set of unnormalized states @xmath9=\\rho_{a|x}p(a|x)$ ] is called an _ assemblage _ and can be completely determined by bob through tomographic measurements .    as noticed in @xcite",
    ", bob can determine if @xmath10 is entangled by looking at the form of the assemblage @xmath11 .",
    "this is because separable states can only lead to assemblages with the specific form @xmath12 where @xmath13 is a hidden variable distributed according to @xmath14 , which determines both alice s response @xmath15 , and the states sent to bob , @xmath16 .",
    "assemblages of this form are said to have a local hidden state ( lhs ) model .",
    "any assemblage which does not have this form can be detected through the violation of a steering inequality @xcite ( similar to a bell inequality or an entanglement witness ) or a simple semi - definite program @xcite .",
    "it turns out that the confirmation of steering not only guarantees that the shared state is entangled , but also that alice is performing incompatible measurements @xcite .",
    "it is thus very intuitive to expect a relation between steering and randomness : first , the correlations ( entanglement ) shared between alice and bob allows bob to certify steering , and consequently the incompatibility of alice s measurements .",
    "second , since alice s measurements are incompatible not all the outcomes she receives are predictable , and thus random .",
    "in order to certify the local randomness of alice s outcomes we work in the adversarial scenario , where a potential eavesdropper , eve , wants to predict them . this framework is relevant for cryptographic tasks , namely 1sdiqkd .",
    "and outputs @xmath17 and bob performs tomography on his subsystem .",
    "( b ) prepare - and - measure scenario : similar to the previous scenario , but now bob holds the source and then knows the bipartite state @xmath10 . ]    in the most general case , we do not make any assumption on alice s measurement device , so that it could even have been provided by eve .",
    "we also consider that the state @xmath10 is the reduced state of a tripartite entangled state @xmath18 shared by alice , bob and eve , _",
    "i.e.  _ @xmath19 $ ] . hence , by applying measurements to her subsystem eve can in principle obtain information about alice s outcome .    in this section",
    "we will focus on the case where alice and bob want to extract randomness from the outcomes of a single given measurement of alice , let us say @xmath20 .",
    "the motivation for considering this case is that it is the relevant one from the perspective of 1sdiqkd .",
    "we assume that the runs of the experiment are independent and identically distributed with respect to eve s strategy .",
    "we consider the case where eve also knows from which measurement @xmath21 alice is going to extract randomness , so she can optimise her attack to obtain information about this measurement setting .",
    "the figure of merit we use to evaluate the amount of randomness in alice s outcomes is the probability that eve can correctly guess the outcome @xmath6 of the measurement @xmath21 of alice .",
    "this quantity , denoted by @xmath22 , is given by the probability that eve s guess @xmath23 is equal to the outcome @xmath6 that alice obtained , whenever alice performs the specific measurement @xmath24 : @xmath25 applying bayes theorem , this is equivalent to @xmath26 , i.e. equal to the joint probability that alice and eve give the same outcome whenever alice measures @xmath24 .",
    "randomness is certified whenever the guessing probability is strictly less than 1 , in which case eve can not predict alice s outcome with certainty .",
    "after alice and eve have applied their measurements the assemblage prepared will be @xmath27,\\ ] ] where @xmath28 is the element of eve s ( optimal ) measurement which yields outcome @xmath29 .",
    "however , since alice and bob do not have access to eve s outcomes the assemblage they will reconstruct will be given by @xmath30    in order to compute the optimal strategy for eve we need to maximise her guessing probability ( for a given input @xmath21 of alice ) , over all strategies . naively , this would appear to constitute optimising the triple @xmath31 , of state , measurements for alice , and measurement for eve , a non - linear optimisation problem .",
    "however , just as in the device - independent case @xcite , we can instead replace this by an equivalent linear optimisation over all physical assemblages @xmath32 that are compatible with the no - signalling principle and the observed assemblage @xmath33 .",
    "more precisely , the maximisation problem can be formulated as the following semidefinite programme ( sdp ) @xcite : @xmath34 \\\\ \\mathrm{s.t . }",
    "\\quad & \\sum_e \\sigma_{a|x}^e = \\sigma_{a|x}^{\\mathrm{obs}}&\\forall \\ , a , x \\nonumber \\\\ & \\sum_a \\sigma_{a|x}^e = \\sum_a \\sigma_{a|x'}^e & \\forall \\ , e , \\ , x \\neq x ' \\nonumber \\\\ & \\sigma_{a|x}^e \\succeq 0 & \\forall a , x , e .",
    "\\nonumber\\end{aligned}\\ ] ] in the objective function we used @xmath35 $ ] to re - express @xmath22 .",
    "the first constraint assures that the decomposition for eve is compatible with the assemblage alice and bob observe .",
    "the second constraint is the non - signalling condition ",
    "i.e. alice can not signal to bob and to eve .",
    "the last one is the requirement for every @xmath36 to be a valid ( unnormalized ) quantum state .",
    "we defer to the appendix the full proof that this optimisation problem is equivalent to optimising over states and measurements , which follows from the gisin - hughston - jozsa - wootters ( ghjw ) theorem @xcite ( which shows that all bipartite no - signalling assemblages have quantum realisations ) , combined with the fact that eve , making only one measurement , also can not signal .",
    "notice that the sdp ( [ eq : sdp ] ) can be seen as the steering analogue of the sdp provided in @xcite which bounds the amount of randomness given an observed nonlocal probability distribution @xmath37 .",
    "as mentioned before , the sdp ( [ eq : sdp ] ) provides an upper bound on the amount of randomness ( _ i.e .  _ a lower bound on the @xmath38 ) that can be found using the sdp of @xcite .",
    "this follows because ( [ eq : sdp ] ) does not allow eve to attack the measurements of bob .",
    "thus , our sdp bounds the maximal amount of randomness that could be obtained if bob were to perform any number of measurements ( that eve can attack ) and compute the randomness based on the obtained probability distribution . the number of random bits is quantified by the min - entropy @xmath39 , where @xmath40 is the result of the maximization ( [ eq : sdp ] ) .",
    "random bits certified @xmath41 versus the detection efficiency @xmath42 for the two - qubit werner state .",
    "black lines : @xmath43 ; red lines : @xmath44 .",
    "solid lines : our steering method ; dot - dashed lines : di method in the case where bob s detection efficiency is 1 ; dashed lines : di method where both alice and bob s detectors have efficiency @xmath42 . ]",
    "random bits certified @xmath41 versus the detection efficiency @xmath42 for the two - qubit werner state .",
    "black lines : @xmath43 ; red lines : @xmath44 .",
    "solid lines : our steering method ; dot - dashed lines : di method in the case where bob s detection efficiency is 1 ; dashed lines : di method where both alice and bob s detectors have efficiency @xmath42 . ]    in fig .",
    "[ fig : plot r vs v ] we plot the amount of randomness certified in the case that alice applies two mutually unbiased pauli spin measurements on a two - qubit werner state @xmath45 , where @xmath46 , and compare it with the amount of randomness obtained in the case bob also treats his measuring device as a black box ( i.e. the fully device - independent case ) . in both cases randomness",
    "can be certified as long as @xmath47 , which is the critical amount of noise for demonstrating either steering or nonlocality with only two measurements @xcite .",
    "all numerical sdp calculations were performed using the cvx package for matlab @xcite , along with the library qetlab @xcite .    in fig .",
    "[ fig : hminvsetav1 ] we also compute the amount of randomness that can be obtained by measuring the same spin measurements with detection efficiency @xmath42 ( for visibility @xmath43 and @xmath44 ) , again comparing to the case where bob treats his measuring device as a black box .",
    "that is , ( for steering ) instead of ideal measurements , with elements @xmath8 , we consider inefficient measurements @xmath48 , with one additional outcome @xmath49 , given by @xmath50 ( the measurements of bob are similarly made inefficient in the nonlocality scenario ) .    in this case ,",
    "two comparisons are made : ( i ) the case where bob s detection efficiency is 1 ; and ( ii ) where bob also has detection efficiency @xmath42 .",
    "as one can see , for @xmath43 in the steering scenario randomness can be certified whenever the detection efficiency is higher than @xmath0 , matching the threshold below which no randomness can be obtained @xcite .",
    "moreover , we see that due to the much larger detection efficiencies needed to violate the chsh inequality ( @xmath51 ) and for the di case where bob s measuring device is perfectly efficient ( @xmath52 ) , the steering scenario offers a significant advantage when using the maximally entangled state over the nonlocality scenario , for the entire range of visibility which is experimentally significant ( i.e. for @xmath53 and above ) .",
    "random bits certified @xmath41 versus the detection efficiency @xmath42 for the two - qutrit maximally entangled state @xmath54 . ]    finally , in fig .",
    "[ fig : r vs eta qutrit ] we plot the number of random bits certified in the case that alice performs measurements in four mutually unbiased bases on her half of the entangled two - qutrit state @xmath55 in the presence of losses .",
    "again , we see that whenever the detection efficiency is above @xmath0 alice is able to certify local randomness",
    ". moreover , for efficiency @xmath56 she certifies @xmath57 bits of randomness .",
    "in the steering scenario one can also consider global randomness extraction from both the untrusted and trusted devices . indeed , even though bob trusts his devices , and knows which measurement he performs , there is still an optimal state that eve can distribute which allows her to predict the outcome of bob s measurement .",
    "this is because although eve is not able to change the measurements performed by bob , nor his reduced state , she still has additional classical side information that she can use to help her in guessing the result of bob ( since she holds the source ) .    ) , with @xmath58 and @xmath59 measurements for alice , and @xmath58 measurement for bob , computed using eq .",
    "( [ e : global sdp ] ) ( solid curve ) . as a matter of comparison",
    "we also plot the amount of global randomness obtained in the device - independent scenario , using the methods of refs .",
    "@xcite ( dashed curve ) . ]",
    "consider that , additionally to alice s measurement @xmath24 , eve wants to guess the outcomes of a measurement @xmath60 performed by bob .",
    "eve now has a pair of guesses @xmath61 , which will be her guess for the pair @xmath62 .",
    "she will thus perform a measurement with elements @xmath63 on her share of the state , which after alice also measures will lead to the assemblage for bob @xmath64 $ ] . similarly to the case of local randomness , the global guessing probability @xmath65 can straightforwardly be shown to be the solution to the following sdp @xmath66    \\\\    \\mathrm{s.t . } & \\sum_{ee ' } \\sigma_{a|x}^{ee ' } = \\sigma_{a|x}^\\mathrm{obs } , & \\forall a , x \\nonumber   \\\\   & \\sum_a \\sigma_{a|x}^{ee ' } = \\sum_a \\sigma_{a|x'}^{ee ' } , & \\forall x\\neq x ' , a , e , e ' \\nonumber \\\\   & \\sigma_{a|x}^{ee ' } \\succeq 0 , & \\forall a , x , e , e ' \\nonumber\\end{aligned}\\ ] ] we again require consistency with the observed assemblage @xmath67 , and demand positivity and no - signalling .",
    "we computed the global randomness which can be certified without losses assuming @xmath58 and @xmath59 measurements for alice , and an @xmath58 measurement for bob , on two - qubit werner states .",
    "the results can be seen in fig .",
    "[ fig : global ] , alongside the corresponding curve calculated using the method of refs .",
    "@xcite for the nonlocality scenario . as a result",
    ", we observe that the lower bound on the amount of global randomness that can be extracted in the steering scenario presented in ref .",
    "@xcite is tight .",
    "up to now we have considered the steering scenario , where alice and bob receive an unknown state @xmath10 from an untrusted source .",
    "it turns out that the results on local randomness straightforwardly apply to the case where bob prepares a known state and sends half of it to alice ( see fig .  [",
    "fig : setup ] ( b ) ) . in this case , since the global state @xmath10 is known , the assemblages reconstructed by bob have to come from unknown measurements on this state , _ i.e.  _ @xmath68 $ ] .",
    "thus the sdp ( [ eq : sdp ] ) can be replaced by @xmath69 \\\\ \\mathrm{s.t . } & \\sum_e { \\mathrm{tr}}_{\\mathrm{a}}[(m^e_{a|x}\\otimes\\openone_{\\mathrm{b } } ) \\rho_{{\\mathrm{a}}{\\mathrm{b } } } ] = \\sigma_{a|x}^{\\mathrm{obs } } , \\,\\,\\,\\forall \\ , a , x \\nonumber \\\\ & \\sum_a m_{a|x}^e = \\sum_a m_{a|x'}^e \\qquad\\qquad \\forall x'\\neq x , e   \\nonumber \\\\ & \\sum_{a , e } m_{a|x}^e = \\openone \\,\\,\\qquad\\qquad\\qquad\\qquad\\qquad\\forall x   \\nonumber \\\\ & m_{a|x}^e \\succeq 0 \\,\\,\\qquad\\qquad\\qquad\\qquad\\qquad\\forall a , x , e \\nonumber\\end{aligned}\\ ] ] this sdp can be understood as the maximisation of eve s guessing probability over all possible povm measurements ( where the outcome @xmath23 goes to eve and the outcome @xmath6 goes to alice ) , with eve oblivious of @xmath7 , that can be applied to the state @xmath10 , given the observation of the assemblage @xmath33",
    ". a derivation of this sdp can be found in [ a : pm sdp ] .",
    "we note that this scenario can also be thought of as the ` time - like steering ' scenario introduced in ref .",
    "@xcite .",
    "we used the above program to calculate the amount of randomness that can be obtained from the two qubit werner state , and from the isotropic two - qutrit state @xmath70 , where @xmath71 . in both cases",
    "we consider that alice performs two mutually unbiased measurements ( pauli @xmath58 and @xmath59 for qubits , and their generalisation for qutrits ) .    for the case of no - losses ,",
    "we observe that the amount of randomness that can be extracted is _ independent of the visibility @xmath72 _ , and equal to 1 bit and 1 trit = @xmath73 bits respectively we observed numerically that @xmath74 . ]",
    "this coincides with the amount which is obtained in the steering scenario for @xmath43 , i.e. the ideal case .",
    "this demonstrates that if knowledge of the state is assumed , then the lack of visibility can not be used by eve to guess the outcomes of alice s measurements .",
    "turning to the case of losses , consistent with the above , we observe that , independent of the visibility , the dependence of the randomness on the loss coincides with that found in the steering scenario for perfect visibility .",
    "that is , the solid black curves in figs .",
    "[ fig : hminvsetav1 ] and [ fig : r vs eta qutrit ] are obtained , for any fixed value of the visibility @xmath72 .",
    "this shows that the prepare - and - measure scenario greatly improves over the steering scenario when considering lack of visibility ( i.e. noise ) on the state .",
    "plot of the random bits certified versus the number of steps of the see - saw iteration for a two - qubit partially entangled state @xmath75 with @xmath76 and starting with random measurements with @xmath56 ( black curve ) and @xmath77 ( red curve ) . ]    the sdp ( [ eq : sdp ] ) provides a way of quantifying the randomness in alice s outcomes given the observation of a given assemblage .",
    "a natural question is , given a fixed state distributed between alice and bob and a fixed number of measurements for alice , what is the best scheme they can implement ( i.e. the best choice of measurements ) which allows for the certification of the most randomness .",
    "here we propose a numerical see - saw method that , starting from an initial amount of certified randomness , seeks for measurement schemes that lead to higher randomness certification .",
    "we focus on the case of local randomness .",
    "a similar scheme can also be implemented for global randomness .",
    "every sdp has a dual program , also an sdp , that can be obtained through the theory of lagrange multipliers @xcite .",
    "the dual of ( [ eq : sdp ] ) is equivalent to @xmath78 \\\\    \\mathrm{s.t . } \\quad&{\\mathrm{tr}}[\\sigma_{a'|x^ * } ] \\leq \\sum_{a , x } { \\mathrm{tr}}[f_{a|x } \\sigma_{a|x } ]   \\qquad \\forall \\ , a ' , \\sigma_{a|x } \\nonumber\\end{aligned}\\ ] ] where in the constraint , @xmath79 should be understood as for all non - signalling assemblages , i.e. those satisfying @xmath80 for all @xmath81 .",
    "we derive the dual sdp and show its equivalence to ( [ eq : dual ] ) , which is easier to interpret . ] since strong duality holds , the optimal value of this optimisation problem is equal to the optimal value of ( [ eq : sdp ] ) , i.e. @xmath82 . moreover , it outputs the coefficients @xmath83 of the optimal steering inequality that gives the tight upper bound on @xmath40 .",
    "once we have solved the dual problem ( [ eq : dual ] ) we can run a second sdp that optimizes the violation of the steering inequality @xmath84 over alice s measurements @xmath85 : @xmath86   \\\\ \\mathrm{s.t . }",
    "\\quad & \\sum_a m_{a|x } = \\openone   & \\forall \\ , x \\nonumber \\\\ & m_{a|x } \\succeq 0 & \\forall a , x\\nonumber\\end{aligned}\\ ] ] the solution of this optimisation problem provides the measurements for alice that allow for the certification of the most randomness using the steering inequality provided by the first sdp .    at this point",
    ", one can perform a see - saw iteration of the two sdps in order to obtain the maximal randomness that can be certified from a given state , along with the optimal steering inequality and measurements @xmath8 . for every given initial state ,",
    "the sdp ( [ eq : sdp ] ) ( and its dual ( [ eq : dual ] ) ) gives the best inequality to certify randomness from an assemblage , while the sdp ( [ eq : sdp - meas ] ) gives the best set of measurements  and therefore the best assemblage  for a given steering inequality .    in fig .",
    "[ fig : plot r vs steps ] we plot the result of this see - saw iteration , starting from two randomly chosen projective measurements , for @xmath56 and @xmath87 , for the two - qubit partially entangled state @xmath75 .",
    "when there are no losses , one bit of randomness is already known to be possible from any partially entangled state in the fully device - independent scenario @xcite .",
    "since this scenario is more demanding , it implies one bit can also be obtained from any partially entangled state of two qubits in the steering scenario .",
    "if the method works it should be able to reproduce this result .",
    "as can be seen , 1 bit of randomness is indeed found , thus demonstrating the utility of the method .",
    "further exploration showed numerically that the measurements which achieve 1 bit of randomness from any partially entangled state can always be taken to be @xmath58 and @xmath59 measurements for alice ( with the randomness obtained from the @xmath58 measurement ) .    in the appendix",
    "we show that this numerical evidence can be turned into an analytic construction , which proves that 1 bit can be obtained from any partially entangled state of two qubits ( which is notably completely different to the approach used in @xcite for nonlocality )",
    ". moreover , the construction generalises to qudits in a straightforward manner , showing that 1 dit of randomness can be obtained by performing two generalised pauli measurements on any schmidt - rank @xmath88 state .",
    "this is contrary to the fully device - independent case , where it is only known how to extract 1 bit from pure partially entangled states .",
    "we have presented a method that certifies the optimal amount of local or global randomness that can be extracted in a steering experiment .",
    "we also considered the case where the source is trusted ( prepare - and - measure scenario ) .",
    "our method relies on optimisation techniques that quantify the amount of certified randomness and provide the optimal steering inequality for randomness certification . applying this method to realistic implementations - _",
    "i.e.  _ in presence of noise and losses - we have shown that a detection efficiency above @xmath0 is sufficient to have reliable local randomness certification in the steering scenario .",
    "this result is also valid for device - independent ( di ) randomness certification and , in general , in scenarios with lower levels of trust .",
    "finally , we have introduced a method which produces , for any given initial state , the optimal measurements which in turn give the optimal assemblage from which maximal randomness can be certified . using this method as a starting point ,",
    "we have shown analytically that 1 dit of randomness can be obtained from any pure entangled schmidt - rank @xmath88 state .",
    "since local randomness certification is of fundamental importance for 1sdiqkd and diqkd , the results presented here have natural applications in cryptographic protocols .",
    "we thank r. rabelo for discussions on randomness in an early stage of this project . this work was supported by the beatriu de pins fellowship ( bp - dgr 2013),the marie curie cofund action through the icfonest program , the erc cog qitbox , the erc adg nlst , the eu project siqs , the spanish project foqus , the generalitat de catalunya ( sgr875 ) and the john templeton foundation .",
    "e.  p. acknowledges the max planck institute for quantum optics for hospitality .",
    "j. g. rarity , p. c. m. owens , p. r. tapster , j. mod .",
    "optic , * 41*(12 ) , 2435 ( 1994 ) .",
    "v. scarani , h. bechmann - pasquinucci , n. j. cerf , m. dusek , n. lutkenhaus , m. peev , rev .",
    "* 81 * , 1301 ( 2009 ) .",
    "j. s. bell , physics ( college . park .",
    "* 1 * , 195 ( 1964 ) .",
    "n. brunner , d. cavalcanti , s. pironio , v. scarani and s. wehner , rev .",
    "phys . * 86 * , 419 ( 2014 ) .",
    "r. colbeck , phd thesis , university of cambridge ( 2006 ) , arxiv:0911.3814 ( 2009 ) .",
    "s. pironio _",
    "et al . _ ,",
    "nature * 464 * , 1021 ( 2010 ) .",
    "l. lydersen et al . , nat .",
    "phot . * 4 * , 686 ( 2010 ) .",
    "i. gerhardt et al . , nature comm . * 2 * , 349 ( 2011 ) .",
    "i. gerhardt , q. liu , a. lamas - linares , j. skaar , v. scarani , v. makarov , c. kurtsiefer , phys .",
    "* 107 * , 170404 ( 2011 ) .",
    "e. schrodinger , proc .",
    ". soc . * 31 * , 555 ( 1935 ) .",
    "h. m. wiseman , s. j. jones , and a. c. doherty , phys .",
    "98 * , 140402 ( 2007 ) .",
    "m. t. quintino , t. vrtesi , d. cavalcanti , r. augusiak , m. demianowicz , a. acn , n. brunner , phys .",
    "a * 92 * , 032107 ( 2015 ) . c. branciard , e. g. cavalcanti , s. p. walborn , v. scarani , h. m. wiseman , phys .",
    "a * 85 * , 010301(r ) ( 2012 ) .",
    "y. z. law , l. p. thinh , j. d. bancal , v. scarani , j. phys .",
    "a : math . theor . * 47 * , 424028 ( 2014 ) . z. y. ou , s. f. pereira , h. j. kimble , and k. c. peng , phys .",
    "lett . * 68 * , 3663 ( 1992 ) .",
    "w. p. bowen , r. schnabel , p. k. lam , and t. c. ralph , phys .",
    "lett . * 90 * , 043601 ( 2003 ) .",
    "d. j. saunders , s. j. jones , h. m. wiseman and g. j. pryde , nat .",
    "* 6 * , 845 ( 2010 ) .",
    ". commun . * 3 * , 625 ( 2012 ) .",
    "a.  j. bennet _",
    "et al . _ ,",
    "x * 2 * , 031003 ( 2012 ) .",
    "b. wittmann _",
    "et al . _ , new j. phys . * 14 * , 053030 ( 2012 ) . v. hndchen _",
    "* 6 * , 598 ( 2012 ) .",
    "s. armstrong , m. wang , r. y. teh , q. gong , q. he , j. janousek , h .- a .",
    "bachor , m. d. reid , and p. k. lam , nat .",
    "11 * , 167 - 172 ( 2015 ) .",
    "d. cavalcanti , p. skrzypczyk , g. h. aguilar , r. v. nery , p. h. souto ribeiro , s. p. walborn , nat .",
    "* 6 * , 7941 ( 2015 ) .",
    "li , k. chen , y .- n . chen , q. zhang , y .- a .",
    "chen , j .- w .",
    "pan , phys .",
    "lett . * 115 * , 010402 ( 2015 ) . o. nieto - silleras , s. pironio , j. silman , new j. phys . * 16 * , 013035 ( 2014 ) . j. d. bancal , l. sheridan , v. scarani , new j. phys .",
    "* 16 * , 033011 ( 2014 ) .",
    "j. bowles , m. t. quintino , and n. brunner , phys .",
    "lett . * 112 * , 140407 ( 2014 ) .",
    "li , m. pawlowski , z .- q .",
    "yin , g .- c .",
    "guo , z .- f .",
    "han , phys .",
    "a * 85 * , 052308 2012 .",
    "e. g. cavalcanti , s. j. jones , h. m. wiseman , and m. d. reid , phys . rev .",
    "a * 80 * , 032112 ( 2009 ) .",
    "m. f. pusey , phys .",
    "a * 88 * , 032313 ( 2013 ) .",
    "m. t. quintino , t. vrtesi , and n. brunner , phys .",
    "lett . * 113 * , 160402 ( 2014 ) .",
    "r. uola , t. moroder , and o. ghne , phys .",
    "lett . * 113 * , 160403 ( 2014 ) .",
    "s. boyd and l. vandenberghe , convex optimization , cambridge university press ( 2004 ) .",
    "n. gisin , helv .",
    "acta , * 62 * , 363371 ( 1989 ) ; p. l. hughston , r. jozsa , w. k. wootters , phys .",
    "a , * 183 * , 14 ( 1993 ) . e. g. cavalcanti , s. jones , h. m. wiseman and m. reid , phys . rev .",
    "a * 80 * 032112 ( 2009 ) .",
    "m. grant and s. boyd .",
    "_ cvx : matlab software for disciplined convex programming _ ,",
    "version 2.0 beta .",
    "[ ] , september 2013 ; _ graph implementations for nonsmooth convex programs _ , recent advances in learning and control ( a tribute to m. vidyasagar ) , v. blondel , s. boyd , and h. kimura , editors , pages 95 - 110 , lecture notes in control and information sciences , springer , 2008 . n. johnston .",
    "_ qetlab : a matlab toolbox for quantum entanglement _ , version 0.8 .",
    "http://www.qetlab.com [ ] , april 13 , 2015 .",
    "a. acn , d. cavalcanti , e. passaro , s. pironio and p. skrzypczyk , arxiv:1505.00053 ( 2015 ) .",
    "m. f. pusey , j. opt .",
    "b * 32 * , a56 ( 2015 ) .",
    "a. acn , , s. massar and s. pironio , phys .",
    "108 * , 100402 ( 2012 ) .",
    "in this appendix we will show how to arrive at the sdp ( [ eq : sdp ] ) for eve s guessing probability .",
    "the most general attack that eve can implement in the case that she is interested in guessing the result of a single measurement ( @xmath89 ) of alice , is to distribute a state @xmath18 to alice and bob ( keeping a part for herself ) on which she will perform a measurement with povm elements @xmath28 , for @xmath90 , and distribute to alice a set of measuring devices which implement the povms with elements @xmath8 , for @xmath91 and @xmath92 .",
    "when eve obtains outcome @xmath23 from her measurement she will give this as her guess for the outcome of alice .",
    "thus , the guessing probability of eve is given by @xmath93\\ ] ] alice and bob can however determine the assemblage @xmath94 that they hold , ( i.e. the set of conditional states prepared for bob , along with the corresponding probabilities ) .",
    "thus the optimisation problem we need to solve is given by @xmath95 \\\\ \\mathrm{s.t.}\\quad & { \\mathrm{tr}}_{{\\mathrm{a}}}[(m_{a|x } \\otimes \\openone_{{\\mathrm{b } } } ) \\",
    ", \\rho_{{\\mathrm{a}}{\\mathrm{b } } } ] = \\sigma_{a|x}^{\\mathrm{obs } } , & \\forall a , x\\nonumber \\\\   & \\rho_{{\\mathrm{a}}{\\mathrm{b}}{\\mathrm{e } } }   \\succeq 0 , \\quad { \\mathrm{tr}}[\\rho_{{\\mathrm{a}}{\\mathrm{b}}{\\mathrm{e } } } ] = 1 \\nonumber \\\\   & m_{a|x } \\succeq 0 ,   \\forall a , x , \\quad \\sum_a m_{a|x } = \\openone , \\forall x \\nonumber \\\\   & m_{e } \\succeq 0 ,   \\forall e \\quad \\sum_e m_{e } = \\openone . \\nonumber\\end{aligned}\\ ] ] here , the first constraint is the consistency with the observed assemblage , the second constraints demand that @xmath18 is a valid quantum state and the third and fourth constraints that the measurements @xmath8 and @xmath28 are valid povms .",
    "defining now the joint assemblage for alice , bob and eve , @xmath96,\\ ] ] it is straightforward to see that all of the constraints appearing in ( [ eq : sdp ] ) are satisfied whenever the constraints in ( [ e : raw sdp ] ) are satisfied , and that the objective functions match .",
    "thus it is straightforward to see that the optimisation problem ( [ eq : sdp ] ) is at least a relaxation of ( [ e : raw sdp ] ) .",
    "what we will show now is that they are in fact equivalent optimisation problems by showing that any solution to ( [ eq : sdp ] ) also implies a solution to ( [ e : raw sdp ] ) .",
    "first of all , consider an assemblage @xmath36 satisfying all of the constraints in ( [ eq : sdp ] ) .",
    "for a fixed @xmath23 , we can define @xmath97 is indeed independent of @xmath7 , due to no - signalling , since @xmath98 is independent of @xmath7 .",
    "] , and @xmath99 .",
    "this has the following properties @xmath100 which show that for each @xmath23 , @xmath101 is a valid assemblage @xcite . from the ghjw theorem @xcite",
    "it therefore follows that there is a quantum state @xmath102 and povm elements @xmath103 such that @xmath104 = \\tilde{\\sigma}_{a|x}^e\\ ] ] now , we finally consider that eve also sends an additional degree of freedom which is read by the measuring device of alice  an auxiliary classical ` flag ' system , which we label @xmath105 .",
    "this system has orthogonal states @xmath106 , for @xmath90 .",
    "this system will be read by alice s measuring device , and , conditioned on the flag , the appropriate measurement will be made .",
    "we can thus now construct the complete strategy of eve @xmath107 clearly this defines a valid state and valid measurements , hence they satisfy the latter constraints of ( [ e : raw sdp ] ) .",
    "furthermore , by construction it also satisfies the first consistency constraint , which is straightforwardly verified .    in total",
    ", we thus conclude that the two optimisation problems are equivalent , since the solution to either one implies a solution to the other , obtaining the same @xmath108 .",
    "we thus focus on the problem ( [ eq : sdp ] ) which is easier to solve , being an sdp optimisation , linear in the optimisation variables @xmath36 .",
    "in this appendix we will show that the amount of randomness that can be certified in the prepare - and - measure scenario when alice receives her share of the state through an untrusted channel , and does not trust her measuring device , is given by the sdp ( 6 ) in the main text .",
    "bob prepares a known bipartite state @xmath10 half of which is sent to alice through the insecure quantum communication channel .",
    "eve can intercept the state , and the most general operation she can perform ( in the case that she is guessing only the outcome of a single measurement @xmath89 ) is a measurement with kraus operators @xmath109 , i.e. the povm elements are @xmath110 , and the state prepared by eve after obtaining outcome @xmath23 is @xmath111}\\ ] ] which occurs with probability @xmath112 $ ] .",
    "eve will guess that the outcome of alice s measurement is @xmath23 .",
    "eve now forwards the state onto alice , and since she controls completely alice s device , she will allow the device to perform the measurement @xmath113 when her outcome was @xmath23 , and when alice chooses to make measurement @xmath7 ( that is , eve sends the classical information of which outcome she obtained along with the quantum state ) .",
    "thus , the probability for alice to obtain outcome @xmath6 , given that she made measurement @xmath7 and eve obtained outcome @xmath23 is given by @xmath114}{{\\mathrm{tr}}[k_e \\rho_{\\mathrm{a}}k_e^\\dagger]}.\\ ] ] putting everything together , we see therefore that the guessing probability is given by allowing eve to optimise over all available strategies , and is given by @xmath115 \\\\ \\mathrm{s.t.}&\\sum_e { \\mathrm{tr}}_{\\mathrm{a}}[(k_e^\\dagger n_{a|x}^ek_e\\otimes \\openone)\\rho_{{\\mathrm{a}}{\\mathrm{b } } } ] = \\sigma_{a|x}^{\\mathrm{obs}}\\nonumber \\\\ & \\sum_a n_{a|x}^e = \\openone \\quad\\qquad\\qquad\\qquad\\qquad\\forall \\ , e , x \\nonumber \\\\ & \\sum_e k_e^\\dagger k_e = \\openone   \\nonumber \\\\ & n_{a|x}^e \\succeq 0 \\qquad\\qquad\\qquad\\qquad\\qquad\\forall \\ , a , e , x \\nonumber\\end{aligned}\\ ] ] currently , this optimisation is not in the form of an sdp , due to the nonlinear nature of the objective function and the constraints .",
    "however , it can easily be written in the form of an sdp by introducing the new variable @xmath116 .",
    "the three final constraints on @xmath113 and @xmath109 imply the following constraints on @xmath103 , @xmath117 however , we can see that whenever we have a set of @xmath103 satisfying the above constraints , it implies that there exist @xmath113 and @xmath109 satisfying the original constraints  i.e. the two sets are equivalent . to see this , we denote first @xmath118 ( which is independent of @xmath7 ) , and therefore we can write @xmath110 , for some @xmath109 , which is always possible for a positive semi - definite operator . moreover , since @xmath119 , the second constraint is satisfied .",
    "finally , defining @xmath120 ( using the pseudo - inverse when necessary ) , we also have that @xmath121 thus , we can re - express the optimisation problem ( [ eq : pm raw ] ) in the form of the following sdp @xmath122 \\\\ \\mathrm{s.t . }",
    "& \\sum_e { \\mathrm{tr}}_{\\mathrm{a}}[(m_{a|x}^e\\otimes \\openone)\\rho_{{\\mathrm{a}}{\\mathrm{b } } } ] = \\sigma_{a|x}^{\\mathrm{obs}}\\quad\\forall \\ , a , x\\nonumber \\\\ & \\sum_a m_{a|x}^e = \\sum_a m_{a|x'}^e \\qquad\\quad\\,\\,\\forall \\ , e , x\\neq x ' \\nonumber \\\\ & \\sum_{ae } m_{a|x}^e = \\openone   \\qquad\\qquad\\qquad\\qquad\\quad\\,\\,\\,\\,\\forall \\ , x \\nonumber \\\\ & m_{a|x}^e \\succeq 0 \\qquad\\qquad\\qquad\\qquad\\qquad\\forall \\ , a , e , x \\nonumber\\end{aligned}\\ ] ] which is exactly the optimisation problem given in the main text .",
    "in this appendix we show the explicit form of the dual of the sdp ( [ eq : sdp ] ) , and explain why eq .",
    "( [ eq : dual ] ) is an equivalent form , which is easier to interpret .    as a reminder ,",
    "the primal problem is given by @xmath123   \\\\",
    "\\mathrm{s.t.}&\\sum_e \\sigma_{a|x}^e = \\sigma_{a|x}^{\\mathrm{obs}}&\\forall \\ , a , x \\nonumber \\\\ & \\sum_a \\sigma_{a|x}^e = \\sum_a \\sigma_{a|x^*}^e & \\forall \\ , e , \\ , x \\neq x^ * \\nonumber \\\\ & \\sigma_{a|x}^e \\succeq 0 & \\forall a , x , e.\\nonumber\\end{aligned}\\ ] ] let us introduce dual variables @xmath124 , @xmath125 and @xmath126 , with respect to the first , second and third set of constraints respectively , and form the lagrangian for this problem , @xmath127 + \\sum_{ax } { \\mathrm{tr}}[f_{a|x}(\\sigma_{a|x}^{\\mathrm{obs}}- \\sum_e \\sigma_{a|x}^e ) ] \\\\",
    "+ \\sum_{aex } { \\mathrm{tr}}[g_x^e ( \\sigma_{a|x}^e - \\sigma_{a|x^*}^e ) ] + \\sum_{aex}{\\mathrm{tr}}[h_{a|x}^e \\sigma_{a|x}^e]\\end{gathered}\\ ] ] after re - arranging , and grouping terms , this is equivalent to @xmath128   + \\sum_{aex } { \\mathrm{tr}}[(\\delta_{a , e}\\delta_{x , x^*}\\openone - f_{a|x } \\\\+ g_x^e - \\delta_{x , x^*}\\sum_{x ' } g_{x'}^e + h_{a|x}^e ) \\sigma_{a|x}^e ] \\end{gathered}\\ ] ] this lagrangian provides an upper bound on the primal objective as long as @xmath129 .",
    "moreover , it provides a non - trivial upper bound only when the inner bracket in the second line identically vanishes for each value of @xmath130 .",
    "thus , we arrive at the dual problem @xmath131 \\\\ \\mathrm{s.t.}\\,&\\delta_{a , e}\\delta_{x , x^*}\\openone - f_{a|x } + g_x^e \\nonumber \\\\ & - \\delta_{x , x^*}\\sum_{x ' } g_{x'}^e + h_{a|x}^e = 0   & \\quad\\forall \\ , a , e , x \\nonumber \\\\ & h_{a|x}^e \\succeq 0 & \\quad\\forall \\ , a , e , x \\nonumber\\end{aligned}\\ ] ] however , @xmath126 is playing the role of a slack variable , since it does nt appear in the objective function , so we can finally simplify the dual to arrive at @xmath132 \\\\ \\mathrm{s.t.}\\quad & f_{a|x } - \\delta_{a , e}\\delta_{x , x^*}\\openone - g_x^e \\nonumber \\\\ & + \\delta_{x , x^*}\\sum_{x ' } g_{x'}^e \\succeq 0   & \\quad\\forall \\ , a , e , x \\nonumber\\end{aligned}\\ ] ] the dual is easily seen to be strictly feasible , for example by taking @xmath133 and @xmath134 for @xmath135 .",
    "thus strong duality holds , and the optimal value of the dual is equal to the optimal value of the primal . in the form ( [ e : dual sdp ] ) , the dual is seen manifestly to be an sdp , as expected . finally , to understand the meaning of the constraint , we multiply by an arbitrary valid assemblage @xmath136 , and take the sum in @xmath6 and @xmath7 and the trace .",
    "we find @xmath137 \\geq { \\mathrm{tr}}[\\sigma_{e|x^ * } ] = p(e|x^*)\\ ] ] must hold for all @xmath23 .",
    "since this condition also holds for all valid assemblages , we see that the second constraint enforces that the value of the inequality is a uniform upper bound on the probability that any individual outcome occurs for the measurement @xmath21 , independent of the assemblage .",
    "hence , one sees immediately why this bounds the guessing probability .",
    "in this section we will show analytically that appropriate measurements on all partially entangled qudit states necessarily lead to 1 dit of randomness .",
    "consider first the partially entangled two qubit state in schmidt form , @xmath138 , for @xmath139 $ ] , and that alice s two measurements are @xmath58 and @xmath59 measurements respectively .",
    "the assemblage created for bob is then @xmath140 where @xmath141 .",
    "crucially , each element of the assemblage is pure , i.e. each element is of the form @xmath142 , where @xmath143 is a one - dimensional projector .",
    "the purity of bob s assemblage substantially constrains eve s possible strategies , such that @xmath144 where each @xmath145 .",
    "this says that eve must prepare the same pure state for bob in each instance , all she can vary is the probability of the two outcomes ( which must still be positive ) . to be consistent with the observed assemblage",
    ", we must have that @xmath146 the guessing probability also now becomes @xmath147 = q(00|0 ) + q(11|0).\\ ] ]    now , the no - signalling constraint says that @xmath148 for all @xmath23 . specifically , in the case at hand @xmath149 which must be true for all matrix elements . while the projectors on the right - hand - side , corresponding to measurements of @xmath59 , are diagonal , the left - hand - side , corresponding to @xmath58 , are in general not diagonal .",
    "thus , taking the trace with @xmath150 , we arrive at the condition @xmath151 since @xmath152 for @xmath139 $ ] , this implies that @xmath153 .",
    "in particular , this says that @xmath154 .",
    "however , to be consistent @xmath155 , and thus we arrive at @xmath156 thus , analytically it must be the case that @xmath157 , and hence 1 bit of randomness is obtained by measuring @xmath58 and @xmath59 on any partially entangled state of two qubits .",
    "the above also extends to qudits ; assuming that the state has schmidt - rank @xmath88 then 1 dit of randomness can always be obtained .",
    "let us now write the state as @xmath158 where @xmath159 , and @xmath160 .",
    "alice s first measurement will now be in the fourier transform basis , with eigenstates @xmath161 and @xmath162 the corresponding root of unity .",
    "her second measurement will be in the @xmath59 basis with eigenstates @xmath163 .",
    "for alice s first measurement she obtains each outcome with equal probability @xmath164 , and prepares the pure states for bob @xmath165 , given by @xmath166 for alice s second measurement , she obtains outcome @xmath6 with probability @xmath167 , and prepares the state @xmath168 .",
    "as above , the purity of bob s assemblage means that eve is again forced to use strategies of the form @xmath169 .",
    "for consistency we still have @xmath170 , for the guessing probability @xmath171 , and from no - signalling @xmath172 . once again , the right - hand - side is diagonal , and hence by looking at the off - diagonal matrix elements , i.e. by taking the trace with @xmath173 , we find that @xmath174 since , by assumption of being schmidt - rank @xmath88 , none of the schmidt coefficients vanish , we therefore must have that @xmath175",
    "considering only the elements with @xmath176 ( and @xmath177 ) , along with the equation @xmath178 , which says that eve s probability to output @xmath23 is just the marginal distribution , we notice that this set of equations , when combined , has the familiar form of a discrete fourier transform ( up to normalisation ) : @xmath179 \\left [ \\begin{array}{c } q(0e|0 ) \\\\",
    "q(1e|0 ) \\\\ \\vdots \\\\",
    "q(d-1,e|0 ) \\end{array}\\right ] =   \\left [ \\begin{array}{c } p(e ) \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{array}\\right]\\ ] ] thus , this equation is readily inverted , and we obtain as solution @xmath180 for all @xmath181 . in particular , this implies that eve s guess is completely uncorrelated from alice s , and her guessing probability is @xmath182 .",
    "thus 1 dit of randomness is obtained from alice s measurement ."
  ],
  "abstract_text": [
    "<S> quantum mechanics predicts the existence of intrinsically random processes . contrary to classical randomness </S>",
    "<S> , this lack of predictability can not be attributed to ignorance or lack of control . here </S>",
    "<S> we find the optimal method to quantify the amount of local or global randomness that can be extracted in two scenarios : ( i ) the quantum steering scenario , where two parties measure a bipartite system in an unknown state but one of them does not trust his measurement apparatus , and ( ii ) the prepare - and - measure scenario , where additionally the quantum state is known . </S>",
    "<S> we use our methods to compute the maximal amount of local and global randomness that can be certified by measuring systems subject to noise and losses and show that local randomness can be certified from a single measurement if and only if the detectors used in the test have detection efficiency higher than @xmath0 .    </S>",
    "<S> one of the most distinct features of quantum mechanics is its intrinsically random character . while in classical mechanics </S>",
    "<S> lack of predictability can always be associated to ignorance or lack of control of the probed systems , the rules of quantum physics say that one can not predict the outcome of a measurement even if all the variables of a system are known . </S>",
    "<S> this inherent unpredictability has been exploited in different applications such as quantum random number generation @xcite and quantum key distribution @xcite .    </S>",
    "<S> recent results have shown that the randomness observed in quantum mechanics can be certified even without relying on any modelling of the quantum devices used for the generation of the random data . </S>",
    "<S> in fact , by analysing the data obtained in experiments involving local measurements on bipartite entangled systems one can prove that no one could have predicted this data in advance whenever a bell inequality violation is observed  @xcite . this is called device - independent randomness certification @xcite . </S>",
    "<S> the device - independent approach has the practical advantage that it does not rely on the exact description of the experimental set - up . </S>",
    "<S> this is crucial when implementing cryptographic protocols as an adversary can use a mismatch between the theoretical description and the actual implementation of the set - up to fake its performance @xcite . </S>",
    "<S> however , device - independent protocols require low levels of noise @xcite , which make them very demanding experimentally .    </S>",
    "<S> an intermediate scenario is that of quantum steering @xcite . </S>",
    "<S> it refers to the case where two parties , say alice and bob , apply local measurements on an unknown bipartite system . while one of them , bob , </S>",
    "<S> has complete knowledge of his measurement apparatuses , alice does not , and treats her measuring device as a black box with classical inputs and outputs . </S>",
    "<S> quantum steering has been receiving lot of attention recently due to the fact that it allows for entanglement detection which is more robust to noise and experimental imperfections than bell nonlocality @xcite . </S>",
    "<S> moreover , quantum steering was shown to be useful for one - sided device independent quantum key distribution @xcite and randomness certification @xcite . </S>",
    "<S> several experimental groups have recently observed steering , including in continuous - variable systems @xcite , using bell local states @xcite , using inefficient detectors @xcite , asymmetric states @xcite , and multipartite systems @xcite .    </S>",
    "<S> the main result of our paper is a general and optimal method to quantify the amount of local or global randomness that can be certified from a single measurement in a steering experiment . </S>",
    "<S> we use this method to show that local randomness can be certified provided that the detectors used have efficiency higher than @xmath0 . </S>",
    "<S> our method can be seen as the analogue of the approach of @xcite from the fully - device - independent scenario applied to the steering scenario . </S>",
    "<S> we compare the results obtained there to those obtained here , in terms of the amount of randomness that can be obtained by measuring systems subjected to white noise , and find substantial benefits can be obtained in the present setting . as a by - product , we also show that the amount of randomness certified in ref . </S>",
    "<S> @xcite from the two - qubit werner state is optimal .    </S>",
    "<S> we furthermore show that the results can be easily extended beyond the steering scenario , to the prepare - and - measure scenario , where the state is also trusted , so that only alice s measuring device is untrusted . in this case </S>",
    "<S> we show that even noisy states can perform very well for randomness certification .    </S>",
    "<S> finally , we give a method to find the best measurements which obtain the most randomness from any fixed state . using insight from this method </S>",
    "<S> , we show analytically that all pure partially entangled states lead to maximal randomness certification using only two fixed measurements .    </S>",
    "<S> there are several motivations to quantify the amount of randomness in the steering scenario . from a fundamental point of view </S>",
    "<S> , it is important to understand how much randomness can be maintained if we give up partial information about the specific description of the systems @xcite . from a practical point of view , the amount of randomness obtained in the steering scenario gives an upper bound to what alice and bob would obtain in a fully device - independent setting , regardless of the number of measurements bob would apply . </S>",
    "<S> furthermore , it is a scenario that appears naturally in some asymmetric applications . </S>",
    "<S> for instance the present results give a way of quantifying the amount of randomness in remote untrusted stations . </S>",
    "<S> this is relevant , for instance , when the provider of a quantum - random - number generator wants to remotely check if the devices they provided are still functioning properly . </S>"
  ]
}