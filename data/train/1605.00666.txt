{
  "article_text": [
    "there are a number of observational and theoretical indications that the inner engine of core collapse supernovae ( ccsne ) is highly non - spherical .",
    "recent observational developments include three - dimensional direct mapping of @xmath0 by nustar , which reveals that the inner parts of the ejecta of sn  1987a and cas  a have experienced large - scale mixing and convection @xcite .",
    "this is consistent with the earlier evidence from polarimetric observations that the explosion is not spherical in general and becomes more so as ones sees deeper inside ( see e.g. , and references therein ) .",
    "high spatial velocities of pulsars are suggested to result from the recoil in asymmetric explosions .    on the theoretical side ,",
    "there have been various mechanisms proposed as the cause for these multi - dimensional features , which may be important also for the explosion mechanism itself .",
    "the stellar rotation may be the simplest .",
    "unsteady accretions of turbulent matter due to strong convection in the last stage of stellar evolution could be the seed perturbations for the asymmetry of ccsne , which would set off different kinds of hydrodynamical instabilities during the stalled - shock phase and enhance neutrino heating and increase turbulent energies in the post - shock flow @xcite .",
    "the nascent field of gravitational wave astronomy will be capable of directly investigating such asymmetric dynamics in the vicinity of proto - neutron star ( pns ) .",
    "the multi - dimensional modelling of ccsne is hence indispensable to unveil the mechanism of ccsne .",
    "the neutrino radiation - hydrodynamic simulations of ccsne have made a remarkable progress with ever increasing computational resources in the last few decades ( for the current status , see e.g. , @xcite ) .",
    "although the present interest of supernova society is directed mainly to 3d hydrodynamical aspects , neutrino transfer is certainly one of the most important ingredients in realistic modelling of ccsne .",
    "since neutrinos are not in thermal equilibrium with matter in general , the time evolution of the neutrino distribution function at each spatial location should be determined in principle by solving the boltzmann equation in six - dimensional phase space with both special and general relativistic effects taken into account properly .",
    "both high numerical cost and technical difficulties have prevented us from conducting the ab - initio simulations , however . as a matter of fact",
    ", various approximations have been employed even in the most sophisticated multi - dimensional simulations , which include the multi - group flux - limited diffusion ( mgfld ) @xcite , isotropic diffusion source approximation ( idsa ) @xcite , two - moment method @xcite , fast - multi - group transport ( fmt ) method @xcite , variable eddington tensor method @xcite and 2d boltzmann transport method without @xmath1 corrections @xcite ; some of them @xcite employ the ray - by - ray plus approximation further .",
    "it should be stressed that some of these approximations have been validated only under spherical symmetry and their performance in non - spherical situations , which no doubt prevail in the post - bounce supernova core , are still uncertain ( see some also for the validation of the ray - by - ray approximation ) .",
    "in fact , some recent simulations have yielded outcomes , that seem at odds with each other , the reason for which may be the different approximations they adopted for neutrino transfer @xcite . multi - dimensional simulations with a boltzmann solver , to which we refer in the following as boltzmann - hydro simulations , are hence indispensable to validate these approximations .",
    "they are obviously crucial to address the ccsne mechanism .    motivated by these facts ,",
    "we have tackled the development of a boltzmann - hydro solver for the last few years .",
    "@xcite constructed a three dimensional newtonian boltzmann solver , which was latter coupled to a hydrodynamics solver with self - gravity and , more importantly , was extended to fully accommodate special relativity @xcite .",
    "the latter paper demonstrated in 1d simulations of ccsne the capability of our new code based on two different energy grids : lagrangian - remapping grid and laboratory - fixed grid .",
    "having been fine - tuned for massive parallel supercomputers , this code in the 2d version is currently being run on the k supercomputer for axisymmetric simulations of ccsne .",
    "this paper is based on our solution to the problem we encountered in these computations .",
    "the problem is the following : the nascent pns starts to receive random kicks shortly after core bounce when the matter that has experienced prompt convection falls onto the pns .",
    "it is further kicked around later by the matter that has undergone hydrodynamical instabilities such as the standing accretion shock instability ( sasi ) or neutrino - driven convection ( see also ) .",
    "the pns then moves at velocities of the order of @xmath2km / s and is temporarily dislocated by several kilometers from the coordinate center ( see also @xcite ) .",
    "it is also important to remember that if the shock wave is successfully revived , asymmetric ejecta will certainly produce pns kicks .",
    "the fixed polar coordinates are not appropriate to follow these proper motions of pns , since dislocated spheres can not be reproduced very well on this grid .",
    "indeed , we found that the simulation without any special treatment either crashed or resulted in unphysical outcomes once the pns moves a few km away from the mesh center .",
    "the previous studies treated this problem rather pragmatically .",
    "for example , @xcite ) restricted the motion of pns by artificially imposing spherical symmetry in the pns .",
    "although no numerical problem may have occured in these methods , it might have discarded some potentially important physics along .",
    "on the other hand , mpa group employed a moving - mesh technique , adding an extra velocity to the advection terms in the equations of motion that compensates the pns motion . in their experimental simulations",
    "@xcite also used a similar moving - mesh method to track the pns motion , remapping the grid .",
    "it is stressed , however , that the latter two groups completely ignored the effects of the moving - mesh on neutrino transfer .    in this paper",
    ", we propose an entirely new method to precisely treat this issue not only for hydrodynamics but also for neutrino transfer .",
    "the basic idea is like in the previous papers to globally translate the coordinates so that the mass center of pns should stay always very close to the mesh center .",
    "it should work , since the pns remains almost spherical even when it oscillates or runs away .",
    "the important thing is that the basic equations both on neutrino transfer and hydrodynamics should be modified on this moving grid , since it is not an inertial system .",
    "hydrodynamics equations are easy to extend ( see e.g. , ) , while the modification of boltzmann equation is more complicated because the coordinate acceleration affects the neutrino transport in non - trivial ways in the six - dimensional phase space .",
    "then the general relativistic description is a natural and probably the unique choice for handling various effects correctly .",
    "we deal with this within the 3 + 1 formulation of gr , using the conservation form of the general relativistic boltzmann equation @xcite .",
    "this means that the current upgrade of the neutrino transport module in our code is equivalent to a gr extension , which was actually planned as the next improvement to our boltzmann solver .",
    "it should be mentioned , however , that in this paper the gr transport code is applied only to the flat minknowski spacetime , since the treatment of gravity in our code is still newtonian ; the newtonian version of the hydrodynamics code is employed in this work for the same reason ( see also section  [ sec : feedback ] ) .",
    "the gr capability of the code will be demonstrated elsewhere @xcite .",
    "this paper is organized as follows . in section  [ sec : baseeq ] , we reformulate the boltzmann equation on the moving - mesh with the language of the 3 + 1 formalism of gr .",
    "we also explain the numerical implementation of this gr extension to our previous special relativistic ( sr ) code in section  [ sec : extension ] .",
    "then , the feedbacks to hydrodynamics are described in section  [ sec : feedback ] .",
    "we validate our new method with two tests : pns oscillations around and runaways from its original position .",
    "the results are presented in section  [ sec : twodsim ] .",
    "finally we conclude this paper with a summary in section  [ sec : summary ] . throughout this paper ,",
    "greek and latin subscripts denote space - time and space components , respectively .",
    "we use the metric signature of @xmath3 .",
    "unless otherwise stated , we work in units with @xmath4 , where @xmath5 and @xmath6 are the light speed and gravitational constant , respectively .",
    "following @xcite , we start with the conservation form of the boltzmann equation in general relativity : @xmath7 \\nonumber \\\\ & & - \\frac{1}{\\nu^2 } \\frac{\\partial}{\\partial \\nu } ( \\nu^3 f \\omega_{(0 ) }   ) + \\frac{1}{{\\rm sin}\\bar{\\theta } } \\frac{\\partial}{\\partial \\bar{\\theta } }   ( { \\rm sin}\\bar{\\theta } f \\omega_{(\\bar{\\theta } ) } ) \\nonumber \\\\ & & + \\frac{1 } { { \\rm sin}^2 \\bar{\\theta } } \\frac{\\partial}{\\partial \\bar{\\phi } } ( f \\omega_{(\\bar{\\phi } ) } ) = s_{\\rm{rad } } , \\label{eq : basicboltz}\\end{aligned}\\ ] ] where @xmath8 are the determinant of the metric , coordinates of spacetime , respectively , and @xmath9 is the neutrino distribution function ; @xmath10 denote a set of the tetrad bases for a local orthonormal frame ; @xmath11 are directional cosines for the direction of neutrino propagation with respect to @xmath12 ( see fig . 1 in @xcite ) .",
    "the three components of @xmath11 can be written as @xmath13 where @xmath14 and @xmath15 stand for the polar and azimuthal angles @xcite .",
    "we further define coordinates @xmath16 in momentum space- @xmath17 and @xmath18 with @xmath19 being the neutrino energy in this local orthonormal frame and also expressed as @xmath20 with the four momentum of neutrino , @xmath21 . in this paper neutrinos",
    "are assumed to be massless .",
    "@xmath22 are given as @xmath23 as shown in @xcite , these @xmath24 s can be expressed with the ricci rotation coefficients .",
    "@xmath25 on the right hand side of eq .",
    "( [ eq : basicboltz ] ) originates from the collision term for neutrino - matter interactions .    in the 3 + 1 formulation of gr ,",
    "the line element is expressed as @xmath26 where @xmath27 and @xmath28 denote the lapse function , shift vector and spatial 3-metric , respectively . in our extended boltzmann code ,",
    "the time - like basis @xmath29 is chosen so that it should coincide with the unit vector @xmath30 normal to the spatial hypersurface with @xmath31 .",
    "this choice is a natural extension from our previous sr boltzmann solver ( see section  [ sec : extension ] for more details ) .",
    "then three other spatial tetrad bases are taken so that they should be tangential to the spatial hypersurface . in this paper",
    "we assume that the spacetime is flat and is foliated with flat spatial hypersurfaces , on which we deploy the polar coordinates ( @xmath32 )",
    ". then non - vanishing components of the 3 metric are @xmath33 and @xmath34 .",
    "the spatial tetrad bases are chosen so that the @xmath35 be parallel to the radial coordinate , and @xmath36 be tangential to the surface spanned by @xmath37 and @xmath38 , and @xmath39 be orthogonal to the other two : @xmath40 we refer to this orthonormal frame as the o - frame in the following . in accord with the above foliation of spacetime we set @xmath41 .",
    "we utilize the shift vector to deal with the motion of the spatial coordinates ( see figure  [ fig : shift ] ) .",
    "in fact , we set @xmath42 , where @xmath43 is approximately the velocity of pns measured in the o - frame ( see the next section for details ) .",
    "note that the employment of the globally uniform shift vector in this paper should be compatible with the use of other gauge conditions for the shift vector in possible applications of the current formulation to ( dynamical ) curved spacetimes .",
    "this completes the description of eq .",
    "( [ eq : basicboltz ] ) .",
    "we now turn to its numerical implementations .",
    "let us suppose that the basic equations are somehow finite - differenced and all hydrodynamics and space - time quantities are obtained up to the @xmath44-th time step .",
    "the average velocity of pns at this time step ( @xmath45 ) is then given via the linear momentum ( p ) and mass of pns ( m ) as @xmath46 where @xmath47 , @xmath48 and @xmath49 denote the density , 3-velocity of matter ( measured in the o - frame ) and volume element in pns , respectively .",
    "the pns is defined to be the region , where the angle - averaged density ( @xmath50 ) is larger than @xmath51 .",
    "the time derivative of the velocity , or the acceleration of pns , at the same time step is given by the following relation : @xmath52 where @xmath53 is the interval between the @xmath54-th and @xmath44-th time steps .",
    "note that we do not use these @xmath55 and @xmath56 as they are for the following reasons .",
    "first , @xmath57 obtained in this way shows glitches from time to time when the pns surface traverses an interface of the radial mesh points .",
    "second , if the tracking of pns motions were to be perfect , the acceleration of pns should be determined iteratively , since the velocity of pns at the next time step should be consistent with this acceleration but is obtained only after the advancement of the step . such iterative process would be very time - consuming .",
    "fortunately , however , it is unnecessary to exactly trace the motion of pns and it turns out that the following approximate treatment suffices to deal with the proper motion of pns .",
    "we define the approximate pns velocity @xmath58 as follows : @xmath59 with @xmath60 @xmath61 is given by eq .",
    "( [ eq : accelpns ] ) ( but the backward difference ) ; @xmath62 and @xmath63 are the terms that allow some deviations of the coordinate velocity and/or origin ( denoted here by @xmath64 ) from those of pns and thus avoid the glitch ; @xmath65 is the recovering time and is taken to be @xmath66ms in this paper . @xmath62 and",
    "@xmath63 also prevent secular drifts of pns .",
    "in fact @xmath67 works as a damper to prohibit large differences between two velocities , whereas @xmath68 serves as an attractor to ensure that the coordinate origin tends to the mass center of the pns . as an additional measure to ensure smooth coordinate motions , we do not update the value of @xmath69 when the pns surface trespasses an interface of radial mesh points . as demonstrated later , we find that employing @xmath70 as the shift vector in combination with the evaluation of @xmath69 given above is indeed sufficient to solve the problems with the proper motion of pns .",
    "although the shift vector field thus obtained is spatially uniform , its derivatives with respect to @xmath71 and @xmath72 are non - vanishing , since the coordinates are curvilinear .",
    "the explicit form of the ricci rotation coefficients are rather involved ( although calculations are straightforwardly ) numerically in the code .",
    "this will be useful indeed , since we are required to evaluate ricci rotation coefficients for numerically obtained metrices in truly gr simulations .      although the gr boltzmann equation , eq .",
    "( [ eq : basicboltz ] ) , has a simple form , the consistent treatment of the advection and collision terms is complicated even for the flat spacetime . in @xcite",
    ", we surmounted the difficulties by introducing two energy grids : _ lagrangian remapped grid _",
    "( lrg ) and _ laboratory fixed grid _ ( lfg ) .",
    "we also devised for the sr code some other numerical techniques ( e.g. , a semi - implicit method for temporal sweep ) .",
    "it is therefore desirable in the gr extension to the current sr code that we should retain these features as much as possible . in the following ,",
    "we describe how we achieved it .",
    "we first consider the boltzmann equation ( [ eq : basicboltz ] ) in flat spacetime .",
    "the tetrad bases , eqs .",
    "( [ eq : polartetrad ] ) , are reduced in this case to @xmath73 where the subscripts `` f '' hereafter implies quantities in the flat spacetime .",
    "then we can evaluate the @xmath24 variables in eq .",
    "( [ eq : omega ] ) as : @xmath74 substituting these results into eq .",
    "( [ eq : basicboltz ] ) and using the determinant of the metric for the fixed polar coordinates in the flat spacetime ( @xmath75 ) , we reproduce the sr boltzmann equation we employed in @xcite .",
    "as we mentioned earlier , in the gr extension we want to retain the various features already implemented in our sr boltzmann - hydro code .",
    "this is most easily achieved by casting eq .",
    "( [ eq : basicboltz ] ) into the following form : @xmath76 \\nonumber \\\\ & & - \\frac{1}{\\nu^2 } \\frac{\\partial}{\\partial \\nu } ( \\nu^3 f \\omega_{(0 ) }   ) + \\frac{1}{{\\rm sin}\\bar{\\theta } } \\frac{\\partial}{\\partial \\bar{\\theta } }   (    { \\rm sin}\\bar{\\theta } f \\omega_{(\\bar{\\theta})}^{(f ) }    +   { \\rm sin}\\bar{\\theta } f \\delta \\omega_{(\\bar{\\theta } ) }     ) \\nonumber \\\\ & & + \\frac{1 } { { \\rm sin}^2 \\bar{\\theta } } \\frac{\\partial}{\\partial \\bar{\\phi } } ( f \\omega_{(\\bar{\\phi})}^{(f ) }   +   f \\delta \\omega_{(\\bar{\\phi } ) }   ) = s_{\\rm{rad } } , \\label{eq : basicboltz_nume}\\end{aligned}\\ ] ] with @xmath77 it should be apparent that these four variables in eq .",
    "( [ eq : correcterms ] ) can be regarded as the gr corrections to the sr equation .",
    "this allows us to directly utilize our sr boltzmann code in the gr extension .",
    "although we employ the moving spherical coordinates in the minkowski spacetime in this paper , the gr - extended code can accommodate any metric and gauge conditions , evaluating various gr terms numerically .",
    "note also that , unlike other advection terms , the energy - derivative term represents gravitational redshift , a purely gr effect , which we calculate on the lrg @xcite becomes trivially zero . ] .",
    "the treatment of the collision terms is also similar to that in the flat spacetime .",
    "since the collision terms can be most easily calculated in the fluid - rest frame , we first evaluate them in this frame and then lorentz - transform them to the laboratory frame , which is identical to the o - frame in the current formulation .",
    "this is done with the tetrads corresponding to these frames .",
    "we denote the tetrad bases of the fluid - rest frame as @xmath78 , which is expressed with @xmath79 as @xmath80 where @xmath81 stands for the lorentz boost transformation .",
    "the components of @xmath81 are given as @xmath82 where @xmath83 denotes the @xmath84 identity matrix , @xmath85 and @xmath86 are defined with the tetrad bases of the laboratory frame and the fluid 4-velocity @xmath87 as @xmath88 where @xmath89 denotes the minkowski metric .",
    "the 4-momentum of neutrino is also projected on @xmath90 . then the energy shift and aberration",
    "are determined by the doppler factor given above and our sr formulation can be directly passed over to the gr - extended code ( see section 4 in @xcite ) .",
    "in this section , we describe the feedback from neutrino interactions to hydrodynamics in detail .",
    "we first present the fully gr formulation , and then take the newtonian limit .",
    "it is noted that the hydrodynamics part of our code is also fully gr but its newtonian version is employed in this paper , since the self - gravity part of the code is still newtonian .",
    "the basic equations for matter dynamics consist of the conservation laws of baryon number , energy - momentum and electron number , which are written as , respectively , @xmath91 where @xmath92 , @xmath93 and @xmath94 denote the rest - mass density of baryons , energy - momentum tensor of matter and the electron number 4-current , respectively .",
    "the right - hand sides of the latter two equations represent the feedback , which are related to the collision term of boltzmann equation , eqs  ( [ eq : basicboltz ] ) or ( [ eq : basicboltz_nume ] ) , as follows : @xmath95 in these expressions , @xmath96 denotes the invariant volume in the momentum space .",
    "the subscript `` @xmath97 '' indicates the neutrino species , which we omit hereafter for simplicity .    in actual simulations",
    ", we first evaluate the tetrad components of @xmath98 in the fluid - rest frame as @xmath99 where the hat indicates variables in the fluid - rest frame , i.e. , @xmath100 etc .. then , the coordinate components of @xmath98 can be expressed via @xmath101 and @xmath102 as : @xmath103 where @xmath104 denotes the coordinate components of @xmath102 .    in the 3 + 1 formalism",
    "the basic equations for matter dynamics can be expressed as @xmath105 where various variables are defined as follows : @xmath106 ( see also eq .",
    "a2 in @xcite ) . in the above equations , @xmath107 , @xmath108 , @xmath109 , @xmath110 @xmath86 , @xmath111 are electron fraction , pressure and specific enthalpy of matter , 4-dimensional metric of spacetime , the determinant of 3-dimensional metric of space and extrinsic curvature , respectively .    in this paper , instead of employing these fully gr equations",
    ", we adopt their newtonian approximations , which can be derived by taking the weak gravitational field limit , ignoring the time derivative of gravitational potential and the space derivatives of 3-dimensional space metric ( see @xcite ) .",
    "then basic equations can be reduced the spherical coordinates to @xmath112 where each term is given as @xmath113 @xmath114 @xmath115 @xmath116    @xmath117    ( see also eqs.(12)-(16 ) in @xcite ) . in the above expressions , @xmath118 , @xmath119 and",
    "@xmath120 denote the volume factor for the spherical coordinates , the newtonian gravitational potential , and the time derivative of shift vector , respectively .",
    "note that @xmath121 represents the acceleration of the coordinates .",
    "in this section , we validate our new formulation of the moving - mesh technique by performing 2d axisymmetric boltzmann - hydro simulations for the toy model of pns oscillations and runaways from the original position .",
    "a thorough investigation of the code performance , including the gr capability , will be reported in the forthcoming paper @xcite . as the initial conditions of these tests , we employ a configuration of a supernova core at 100ms after core bounce , which is obtained by a 1d spherically symmetric simulation of core - collapse , bounce and stagnation of shock wave with the same code .",
    "we map the resultant 1d configuration onto the 2d grid .",
    "we use a 11.2@xmath122 progenitor @xcite . for the 1d simulation ,",
    "a non - uniform grid of @xmath123 points in the radial direction covers the region of @xmath124 km , while the momentum space is discritized with a grid of @xmath125 points in the energy region of @xmath126 mev and @xmath127 points covering the polar angle from 0 to @xmath128 . for the 2d simulations , on the other hand , we deploy @xmath129 radial grid points and uniformly distributed @xmath130 angular grid points in the entire meridian section",
    "; for the momentum space we use @xmath125 energy grid points and @xmath131 angular grid points .",
    "although this is admittedly a rather coarse mesh both in space and momentum space , it is not a serious issue for the current purpose : a proof - of - principle kind of code tests .",
    "we take into account three species of neutrinos : @xmath132 , and @xmath133 , which are electron - type neutrinos , electron - type anti - neutrinos and heavy - lepton neutrinos ( @xmath134 and @xmath135 neutrinos and their anti - particles collectively ) , respectively .    as for the input physics",
    ", our current boltzmann - hydro code has updated some treatments of microphysics from @xcite .",
    "one of them is an incorporation of the multi - nuclear species equation of state ( eos ) by @xcite .",
    "this tabulated eos provides us with not only thermodynamics quantities but also abundances of nuclei with mass numbers up to @xmath136 in nuclear statistical equilibrium or nse , which are then employed to obtain the rate of electron captures by heavy nuclei ( see below ) .",
    "incidentally the eos includes also the information on the abundances of light elements .",
    "we are currently studying possible roles of their interactions with neutrinos in the post - bounce phase of ccsne .",
    "neutrino - matter interactions have been also improved from @xcite .",
    "one of the upgrades is the full account of non - isoenergetic scatterings between neutrinos and electrons and positrons . unlike the spherically symmetric case , the interaction rate depends on @xmath15 , the fact which prevents a direct application of the method used in @xcite .",
    "we hence obtain the interaction rate by direct numerical integrations combined with the chebychev expansions of polylogarithms @xcite .",
    "it is important to note that an implicit treatment of non - isoenergetic scatterings is highly expensive both in computational time and memory .",
    "we hence handle the neutrino scatterings on electrons and positrons explicitly .",
    "since they are rather minor , having smaller reaction rates , compared with other reactions such as emissions , absorptions and scatterings on nucleons , this poses no problem",
    ".    another important upgrade is the treatment of electron captures by nuclei as mentioned earlier .",
    "we tabulate the reaction rates based on the results by @xcite and the approximation formula of @xcite and @xcite with the mass fractions of heavy nuclei being taken from the furusawa s eos .",
    "as shown in @xcite , these two updates are critically important for ccsne . as a matter of fact",
    ", the deleptonization would be erroneously suppressed during the infall phase if they were neglected , which would then result in a larger mass of the inner core and a stronger shock wave ( see below and also @xcite ) .",
    "figures  [ fig:1dpreb][fig : variousradi ] display the result of the 1d simulation . figure  [ fig:1dpreb ] plots the distributions of density , radial velocity , electron fraction , lepton fraction , entropy per baryon and temperature at different times in the pre - bounce phase .",
    "we find that the mass of the inner core is somewhat less than 0.6 @xmath122 due to the unsuppressed deleptonization , which is consistent with other 1d computations ( see , e.g. , @xcite ) .",
    "the post - bounce counter parts are shown in figure  [ fig:1dpostb ] for different times , where @xmath137 denotes the time after bounce in this figure .",
    "figure  [ fig : lightcurve ] presents the energy fluxes measured in the laboratory frame ( i.e. , neutrino luminosities ) at @xmath138  km .",
    "note that the well - known bounce feature , i.e. , a slight decrease followed by a quick rise in the luminosity of electron - type neutrino reaches this radius at @xmath139ms .",
    "the prominent neutronization burst of electron - type neutrinos can be clear seen in the upper panel , while the luminosities of other neutrinos start to rise somewhat later .",
    "note that the production of electron - type anti - neutrinos is initially suppressed by high electron fractions around the neutrino sphere ( @xmath140 ) .",
    "in fact , the luminosity of heavy - lepton neutrino goes up in @xmath141ms , while that of electron - type anti - neutrinos increases gradually for @xmath142ms .",
    "figure  [ fig : aveene ] shows the time evolution of the mean energy for each neutrino species at @xmath138  km .",
    "the mean energy is defined as @xmath143    we also show the trajectories of some important radii for the post - bounce phase in figure  [ fig : variousradi ] .",
    "the shock expands initially but is stagnated around @xmath144 km at @xmath145ms , while the gain radius starts to deviate from the shock radius at @xmath146ms .",
    "the trajectories of the points that have the densities of @xmath147 and @xmath148 are also shown in this figure .",
    "they will serve as a rough guide to the size of pns as a function of time .",
    "all of these features are in qualitative agreement with those observed in previous studies ( see e.g. , @xcite ) .",
    "the data at @xmath149ms are used as the initial condition for the subsequent 2d simulations .    as a quick validation of the core part of our code",
    ", we show in figure  [ fig : comparisumi ] some results of the comparison with another code , in which we ran 1d simulations twice for the @xmath150 progenitor model by @xcite , using the current code and another 1d but fully gr boltzmann - hydro code developed by @xcite .",
    "all input physics are identical between the two computations but the latter is fully general relativistic and employs the lagrangian formulation . in the figure",
    ", we show some key quantities at core bounce . in each panel ,",
    "the red ( green ) line gives the result of our new ( @xcite ) code .",
    "considering the differences just mentioned , we think the two results agree with each other reasonably well .",
    "it is known that the center of pns oscillates with velocities of the order of 100 km / s and periods of several tens of milliseconds ( see e.g. , @xcite ) .",
    "mimicking such a situation , we start a 2d simulation by adding a velocity in the z - direction as @xmath151km / s in the region of @xmath152 km .",
    "this simulation is carried out for 100ms , which is long enough for the purpose of this study .",
    "figure  [ fig : oscivelo ] shows the time evolution of pns velocity ( upper panel ) , trajectory of the origin of moving - mesh ( middle panel ) , and the z - coordinate of the mass center of pns on this moving - mesh ( lower panel ) .",
    "one can see from the middle panel that the pns moves in the positive z direction initially owing to the velocity added at the beginning .",
    "it is also clear from the upper panel that the pns is decelerated and the direction of motion is reversed after a few ms .",
    "it is noted the pns moves from the original position by @xmath153 km by the time of @xmath154ms as shown in the middle panel .",
    "this is not a small distance and the subsequent evolution can not be calculated without the moving - mesh technique . as a matter of fact",
    ", we conducted the same simulation on the ordinary non - moving grid , and found that it ended up with a numerical crash with unphysical matter distributions around the coordinate origin .    at @xmath155ms the pns again changes the direction of motion and returns to the origin . although the period is variable in time , the pns experiences two cycles of oscillations in this simulation .",
    "it is also important to note that the moving - mesh nicely traces the motion of pns ( see the lower panel ) .",
    "this leads to the successful boltzmann - hydro simulation on the spherical polar grid .",
    "we confirmed indeed that all the unphysical features observed in the simulation on the fixed mesh have gone with the moving - mesh technique .",
    "in realistic simulations the shock wave expands asymmetrically after successful shock revival and expels the envelope anisotropically .",
    "the pns then undergoes a recoil . in this section ,",
    "we mimic such runaways of pns very crudely .",
    "the initial configurations of matter and neutrinos are the same as those used in the previous section . in this case , however , we do not add velocity perturbations . instead , we continuously add by hand the external acceleration of @xmath156 in the positive z - direction within the region of @xmath152 km on the moving grid .",
    "the simulation was carried out for @xmath157ms .",
    "figure  [ fig : kickvelo ] is the counter part of figure  [ fig : oscivelo ] for the present case . as expected , the pns moves continuously in the positive z - direction .",
    "it is seen in the top panel that the pns velocity reaches @xmath158km / s at the end of the simulation , which is much larger than the realistic kick velocity of a few hundred km / s . in spite of this rather extreme runaway of pns , the moving - mesh tracks it very well , as shown in the lower panel of the figure .",
    "in fact , the distance between the mass center of pns and the origin of the moving - mesh remains less than @xmath159 km , which is close enough to avoid numerical problems .",
    "incidentally , oscillations that are evident after @xmath160ms in the lower panel are ascribed to the deformations of pns .",
    "a series of snapshots of the entropy distribution in the meridian plane are shown in figure  [ fig : entrocontkick ] .",
    "the low entropy region with deep blue colors in this figure corresponds to the central un - shocked part of pns .",
    "it is apparent that the pns moves upward with time .",
    "note that this figure is drawn on the fixed coordinates , which coincide with the moving coordinates initially . in each panel of the same figure , we put two concentric circles , which represent the moving - mesh .",
    "it is confirmed again that they trace the pns closely . in figure",
    "[ fig : nuenumcontkick ] , on the other hand , the ( number ) density contour is drawn in color for electron - type neutrinos .",
    "one can see that the neutrino density is slightly non - spherical owing to the deformation of pns .",
    "it is more important , however , that the neutrinos are comoving with pns .",
    "this is of course a consequence of the neutrino trapping , which occurs in the optically thick region . in the boltzmann - hydro simulation ,",
    "however , it is highly non - trivial and is in fact ensured by the combination of the following two conditions : ( 1 ) neutrinos are isotropically distributed in the fluid - rest frame ; ( 2 ) the neutrino distribution in the o - frame is related accurately with that in the fluid - rest frame by a lorentz transformation .",
    "the result we have just presented is yet another demonstration that our code is working properly .",
    "last but not least , we mention the conservation of linear momentum in our code . it is a well known fact that it is difficult in general for hydrodynamics codes like ours that adopt curvilinear coordinates to enforce the conservation of linear momentum .",
    "it is evident indeed in eqs  ( [ eq : mon3pra1 ] ) or ( [ eq : wh ] ) that these equations can not be written in the conserved form even in the absence of gravity and neutrino interactions .",
    "not to mention , the gravity term written not in the conservation form also attributes to the violation of momentum ( and energy ) conservation ( see also @xcite ) .",
    "note , however , that as formulated in section  [ subsec : shiftvector ] , we do not use the conservation law to evaluate the pns velocity and its acceleration .",
    "regardless , we checked quantitatively the violation of linear momentum in our code by conducting another 2d purely hydrodynamical simulation ( same initial conditions as previous tests but adding 1@xmath161 random density perturbation ) for 100ms .",
    "we found that the numerical error is equivalent to @xmath162km / s of the pns s kick velocity , which is not negligibly small but still much smaller than the typical velocity of @xmath163km / s .",
    "considering the rather coarse grid employed in this paper and the purpose of this paper , we may conclude that our code performed well .",
    "in this paper , we have presented a novel method to deal with motions of pns on spherical polar coordinates .",
    "it is based on a moving - mesh technique , as far as the neutrino transport part is concerined , it is essentially equivalent to the general relativistic extension of the special relativistic boltzmann solver we developed earlier . in fact , the boltzmann equation is reformulated in the 3 + 1 formalism of gr although the gr code thus obtained is applied only to the flat spacetime coupled with the newtonian hydrodynamics code and self - gravity module in this paper . the shift vector is utilized to specify the movement of spatial coordinates so that they could track the pns motion approximately . as a matter of fact , without such a technique we encountered a numerical crash with unphysical features emerging at the coordinate origin , as the pns is dislocated from the original position . since the coordinate origin stays very close to the mass center of pns with the moving - mesh technique , we expect that in more realistic simulations the extended boltzmann - hydro code will be able to treat the violent oscillations and ultimate runaway of pns in the post - bounce phases of ccsne on spherical polar coordinates .",
    "we have also described in detail the numerical implementations of the gr extensions to our sr boltzmann code , which was constructed on two energy grids so that it could deal with both the advection and collision terms correctly .",
    "it turns out that the extension is rather straightforward thanks to the use of appropriate tetrads .",
    "the two energy grids and the transformations between them , which are employed in the sr boltzmann code , are nicely identified with these tetrads and their lorentz transformations , respectively .    in section  [ sec : twodsim ] , we have validated our method by applying it to two test problems : toy models of pns oscillations and a runaway , which mimic very crudely more realistic post - bounce simulations .",
    "we have demonstrated that the code has nice tracking capabilities and can follow the evolutions without any problems such as those we encountered when the fixed spatial grid was deployed .",
    "incidentally , the extended code is currently being applied to realistic 2d simulations of ccsne and the results and a thorough code validation will be reported elsewhere soon .",
    "we are also planning to conduct truly gr boltzmann simulations of neutrino transport in a black hole spacetime .",
    "it should be apparent that any ( local ) gauge conditions can be imposed in addition to the uniform shift we employed in this paper .",
    "the next step is to couple the gr neutrino transport code with a solver of the einstein equations .",
    "note that the hydrodynamics code is already gr ( see @xcite ) although the newtonian version was used in this paper .",
    "such an integrated code , once completed , will certainly broaden the scope of application much beyond ccsne .",
    "we are grateful to a. juodagalvis for providing the data of electron capture rates on heavy nuclei . h.n . acknowledges to m. shibata , y. sekiguchi and h. okawa for valuable comments and discussions . h.n .",
    "also thanks werner marcus for proofreadings .",
    "the numerical computations were performed on the supercomputers at k , at aics , fx10 at information technology center of tokyo university , sr16000 at yitp of kyoto university , and sr16000 at kek under the support of its large scale simulation program ( 14/15 - 17 , 15/16 - 08 ) , research center for nuclear physics ( rcnp ) at osaka university .",
    "large - scale storage of numerical data is supported by jldg constructed over sinet4 of nii .",
    "was supported in part by jsps postdoctoral fellowships for research abroad no .",
    "this work was also supported by grant - in - aid for the scientific research from the ministry of education , culture , sports , science and technology ( mext ) , japan ( 15k05093 , 24103006 , 24740165 , 24244036 , 25870099 ) and hpci strategic program of japanese mext and k computer at the riken",
    "( project i d : hpci 130025 , 140211 , and 150225 ) ."
  ],
  "abstract_text": [
    "<S> we present a newly developed moving - mesh technique for the multi - dimensional boltzmann - hydro code for the simulation of core - collapse supernovae ( ccsne ) . </S>",
    "<S> what makes this technique different from others is the fact that it treats not only hydrodynamics but also neutrino transfer in the language of the 3 + 1 formalism of general relativity ( gr ) , making use of the shift vector to specify the time evolution of the coordinate system . </S>",
    "<S> this means that the transport part of our code is essentially general relativistic although in this paper it is applied only to the moving curvilinear coordinates in the flat minknowski spacetime , since the gravity part is still newtonian . </S>",
    "<S> the numerical aspect of the implementation is also described in detail . employing the axisymmetric two - dimensional version of the code , we conduct two test computations : oscillations and runaways of proto - neutron star ( pns ) . </S>",
    "<S> we show that our new method works fine , tracking the motions of pns correctly . </S>",
    "<S> we believe that this is a major advancement toward the realistic simulation of ccsne . </S>"
  ]
}