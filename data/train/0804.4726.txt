{
  "article_text": [
    "a ferromagnetic _ ising model on the finite graph @xmath0 _ ( with vertex set @xmath1 , and edge set @xmath2 ) is defined by the following boltzmann distributions over @xmath3 , with @xmath4 : @xmath5 these distributions are parametrized by the `` magnetic field '' @xmath6 and `` inverse temperature '' @xmath7 , where the partition function @xmath8 is fixed by the normalization condition @xmath9 . throughout the paper",
    ", we will be interested in sequences of graphs=\\{1,2,\\dots , i\\}$ ] for the set of first @xmath10 integers . ]",
    "@xmath11,e_n)$ ] of diverging size @xmath12 .",
    "nonrigorous statistical mechanics techniques , such as the `` replica '' and `` cavity methods , '' allow to make a number of predictions on the model ( [ eq : isingmodel ] ) , when the graph @xmath0 `` lacks any finite - dimensional structure . ''",
    "the most basic quantity in this context is the asymptotic _",
    "free entropy density _",
    "@xmath13 ( this quantity is also sometimes called in the literature also free energy or pressure ) . the limit free entropy density and the large deviation properties of boltzmann distribution were characterized in great detail @xcite in the case of a complete graph @xmath14 ( the inverse temperature must then be scaled by @xmath15 to get a nontrivial limit ) . statistical physics predictions",
    "exist , however , for a much wider class of graphs , including most notably sparse random graphs with bounded average degree ; see , for instance , @xcite .",
    "this is a direction of interest for at least two reasons :    sparse graphical structures arise in a number of problems from combinatorics and theoretical computer science .",
    "examples include random satisfiability , coloring of random graphs and graph partitioning @xcite . in all of these cases ,",
    "the uniform measure over solutions can be regarded as the boltzmann distribution for a modified spin glass with multispin interactions .",
    "such problems have been successfully attacked using nonrigorous statistical mechanics techniques .",
    "a mathematical foundation of this approach is still lacking , and would be extremely useful .",
    "sparse graphs allow to introduce a nontrivial notion of distance between vertices , namely the length of the shortest path connecting them .",
    "this geometrical structure allows for new characterizations of the measure ( [ eq : isingmodel ] ) in terms of correlation decay .",
    "this type of characterization is in turn related to the theory of gibbs measures on infinite trees @xcite .    the asymptotic free entropy density ( [ eq : freeenergy ] )",
    "was determined rigorously only in a few cases for sparse graphs . in @xcite ,",
    "this task was accomplished for random regular graphs .",
    "de sanctis and guerra @xcite developed interpolation techniques for random graphs with independent edges ( erds  renyi type ) but only determined the free entropy density at high temperature and at zero temperature ( in both cases with vanishing magnetic field ) .",
    "the latter is in fact equivalent to counting the number of connected components of a random graph .",
    "interestingly , the partition function @xmath16 can be approximated in polynomial time for @xmath7 , using an appropriate markov chain monte carlo algorithm @xcite .",
    "it is intriguing that no general approximation algorithms exists in the case @xmath17 ( the `` antiferromagnetic '' ising model ) .",
    "correspondingly , the statistical physics conjecture for the free entropy density @xcite becomes significantly more intricate ( presenting the so - called `` replica symmetry breaking '' phenomenon ) .    in this paper",
    "we generalize the previous results by rigorously verifying the validity of the bethe free entropy prediction for the value of the limit in ( [ eq : freeenergy ] ) for generic graph sequences that converge locally to trees .",
    "indeed , we control the free entropy density by proving that the boltzmann measure ( [ eq : isingmodel ] ) converges locally to the boltzmann measure of a model on a tree . the philosophy is related to the local weak convergence method of @xcite .",
    "finally , several of the proofs have an algorithmic interpretation , providing an efficient procedure for approximating the local marginals of the boltzmann measure .",
    "the essence of this procedure consists in solving by iteration certain mean field ( cavity ) equations .",
    "such an algorithm is known in artificial intelligence and computer science under the name of _ belief propagation_. despite its success and wide applicability , only weak performance guarantees have been proved so far .",
    "typically , it is possible to prove its correctness in the high temperature regime , as a consequence of a uniform decay of correlations holding there ( spatial mixing ) @xcite . the behavior of iterative inference algorithms on ising models was recently considered in @xcite .",
    "the emphasis of the present paper is on the low - temperature regime in which uniform decorrelation does not hold .",
    "we are able to prove that belief propagation converges exponentially fast on any graph , and that the resulting estimates are asymptotically exact for large locally tree - like graphs .",
    "the main idea is to introduce a magnetic field to break explicitly the @xmath18 symmetry , and to carefully exploit the monotonicity properties of the model .",
    "a key step consists of estimating the correlation between the root spin of an ising model on a tree and positive boudary conditions .",
    "ising models on trees are interesting per se , and have been the object of significant mathematical work ; see , for instance , @xcite .",
    "the question considered here appears , however , to be novel .",
    "the next section provides the basic technical definitions ( in particular concerning graphs and local convergence to trees ) , and the formal statement of our main results .",
    "notation and certain key tools are described in section [ sec : notations ] with section [ sec : treeproofs ] devoted to proofs of the relevant properties of ising models on trees ( which are of independent interest ) .",
    "the latter are used in sections [ sec : algo ] and [ sec : graphs ] to derive our main results concerning models on tree - like graphs . a companion paper @xcite deals with the related challenging problem of spin glass models on sparse graphs .",
    "the next subsections contain some basic definitions on graph sequences and the notion of local convergence to random trees .",
    "sections [ sec : freeentropy ] and [ sec : algoimpl ] present our results on the free entropy density and the algorithmic implications of our analysis .",
    "let @xmath19 a probability distribution over the nonnegative integers , with finite , positive first moment , and denote by @xmath20 its size - biased version .",
    "for any @xmath21 , we let @xmath22 denote the random rooted tree generated as follows . first draw an integer @xmath23 with distribution @xmath24 , and connect the root to @xmath23 offspring . then recursively , for each node in the last generation , generate an integer @xmath23 independently with distribution @xmath25 , and connect the node to @xmath26 new nodes .",
    "this is repeated until the tree has @xmath27 generations .",
    "sometimes it will be useful to consider the ensemble @xmath28 whereby the root node has degree @xmath26 with probability @xmath25 .",
    "we will drop the degree distribution arguments from @xmath22 or @xmath28 and write @xmath29 whenever clear from the context .",
    "notice that the infinite trees @xmath30 and @xmath31 are well defined .",
    "the average branching factor of trees will be denoted by @xmath32 , and the average root degree by @xmath33 . in formulae",
    "@xmath34    we denote by @xmath35 a graph with vertex set @xmath36=\\{1,\\dots , n\\}$ ] .",
    "the distance @xmath37 between @xmath38 is the length of the shortest path from @xmath10 to @xmath39 in  @xmath40 .",
    "given a vertex @xmath41 , we let @xmath42 be the set of vertices whose distance from  @xmath10 is at most @xmath27 . with a slight abuse of notation , @xmath42 will also denote the subgraph induced by those vertices . for @xmath41 ,",
    "we let @xmath43 denote the set of its neighbors @xmath44 , and @xmath45 its size ( i.e. the degree of @xmath10 ) .",
    "this paper is concerned by sequence of graphs @xmath46 of diverging size , that converge locally to trees .",
    "consider two trees @xmath47 and @xmath48 with vertices labeled arbitrarily",
    ". we shall write @xmath49 if the two trees become identical when vertices are relabeled from @xmath50 to @xmath51 , in a breadth first fashion , and following lexicographic order among siblings .    considering a sequence of graphs @xmath46 ,",
    "let @xmath52 denote the law induced on the ball @xmath42 in @xmath40 centered at a uniformly chosen random vertex @xmath53 $ ] .",
    "we say that @xmath54 _ converges locally _ to the random tree @xmath30 if , for any @xmath27 , and any rooted tree @xmath55 with @xmath27 generations @xmath56    we say that a sequence of graphs @xmath46 is _ uniformly sparse _ if @xmath57      according to the statistical physics derivation @xcite , the model ( [ eq : isingmodel ] ) has a line of first - order phase transitions for @xmath58 and @xmath59 [ i.e. , where the continuous function @xmath60 exhibits a discontinuous derivative ] .",
    "the critical temperature depends on the graph only through the average branching factor and is determined by the condition @xmath61 notice that @xmath62 for large degrees .",
    "the asymptotic free - entropy density is given in terms of the fixed point of a distributional recursion .",
    "one characterization of this fixed point is as follows .",
    "[ lemma : recursive ] consider the sequence of random variables @xmath63 defined by @xmath64 identically and , for @xmath21 , @xmath65 where @xmath66 is an integer valued random variable of distribution @xmath67 , @xmath68 , \\ ] ] and the @xmath69s are i.i.d .",
    "copies of @xmath70 that are independent of @xmath66 .",
    "if @xmath71 and @xmath67 has finite first moment , then the distributions of @xmath70 are stochastically monotone and @xmath70 converges in distribution to the unique fixed point @xmath72 of the recursion ( [ eqn : h_recursion ] ) that is supported on @xmath73 .    our next result confirms the statistical physics prediction for the free - entropy density .    [",
    "theorem : free_energy ] let @xmath46 be a sequence of uniformly sparse graphs that converges locally to @xmath30 . if @xmath67 has finite first moment ( that is if @xmath74 has finite second moment ) , then for any @xmath75 and @xmath7 the following limit exists : @xmath76 moreover , for @xmath71 the limit is given by @xmath77 \\nonumber \\\\ & & { } + \\mathbb{e } \\log\\biggl\\ { e^b \\prod_{i=1}^{l } [ 1 + \\tanh(\\beta ) \\tanh(h_i ) ] \\\\ & & { } \\qquad\\hspace{18pt } + e^{-b } \\prod_{i=1}^{l } [ 1 - \\tanh(\\beta ) \\tanh(h_i ) ] \\biggr\\ }   , \\nonumber\\end{aligned}\\ ] ] where @xmath78 has distribution @xmath79 and is independent of the cavity fields @xmath80 that are i.i.d .",
    "copies of the fixed point @xmath72 of lemma [ lemma : recursive ] . also , @xmath81 and @xmath82 is the limit of @xmath83 as @xmath84 .",
    "the proof of theorem [ theorem : free_energy ] is based on two steps :    reduce the computation of @xmath85 to computing expectations of local ( in @xmath40 ) quantities with respect to the boltzmann measure ( [ eq : isingmodel ] ) .",
    "this is achieved by noticing that the derivative of @xmath86 with respect to @xmath87 is a sum of such expectations .",
    "show that expectations of local quantities on @xmath40 are well approximated by the same expectations with respect to an ising model on the associated tree @xmath22 ( for @xmath27 and @xmath12 large ) .",
    "this is proved by showing that , on such a tree , local expectations are insensitive to boundary conditions that dominate stochastically free boundaries .",
    "the theorem then follows by monotonicity arguments .",
    "the key step is of course the last one .",
    "a stronger requirement would be that these expectation values are insensitive to any boundary condition , which would coincide with uniqueness of the gibbs measure on @xmath30 .",
    "such a requirement would allow for an elementary proof , but holds only at `` high '' temperature , @xmath88 .",
    "indeed , insensitivity to positive boundary conditions is proved in section [ sec : treeproofs ] for the following collection of trees of conditionally independent ( and of bounded average ) offspring numbers .",
    "[ def - cit ] an infinite tree @xmath89 rooted at the vertex @xmath90 is called _ conditionally independent _ if for each integer @xmath91 , conditional on the subtree @xmath92 of the first @xmath23 generations of @xmath89 , the number of offspring @xmath93 for @xmath94 are independent of each other , where @xmath95 denotes the set of vertices at generation @xmath23 .",
    "we further assume that the [ conditional on @xmath92 ] first moments of @xmath93 are uniformly bounded by a given nonrandom finite constant @xmath97 .    beyond the random tree @xmath30 ,",
    "these include deterministic trees with bounded degrees and certain multi - type branching processes ( such as random bipartite trees and percolation clusters on deterministic trees of bounded degree ) .",
    "consequently , theorem [ theorem : free_energy ] extends to any uniformly sparse graph sequence that converge locally to a random tree @xmath89 of the form of definition [ def - cit ] except that the formula @xmath83 is in general more involved than the one given in ( [ eqn : phi ] ) .",
    "for example , such an extension allows one to handle uniformly random bipartite graphs with different degree distributions @xmath24 and @xmath98 for the two types of vertices .    while we refrain from formalizing and proving such generalizations , we note in passing that our derivation of the formula ( [ eqn : phi ] ) implicitly uses the fact that @xmath30 possesses the involution invariance of @xcite . as pointed out in @xcite , every local limit of finite graphs must have the involution invariance property ( which clearly not every conditionally independent tree has ) .",
    "the free entropy density is not the only quantity that can be characterized for ising models on locally tree - like graphs .",
    "indeed local marginals can be efficiently computed with good accuracy .",
    "the basic idea is to solve a set of mean field equations iteratively .",
    "these are known as bethe  peierls or cavity equations and the corresponding algorithm is referred to as `` belief propagation '' ( bp ) .",
    "more precisely , associate to each directed edge in the graph @xmath99 , with @xmath100 , a distribution @xmath101 over @xmath102 . in the computer science literature",
    "these distributions are referred to as `` messages . ''",
    "they are updated as follows : @xmath103 the initial conditions @xmath104 may be taken to be uniform or chosen according to some heuristic .",
    "we will say that the initial condition is _ positive _ if @xmath105 for each of these messages .",
    "our next result concerns the uniform exponential convergence of the bp iteration to the same fixed point of ( [ eq : bpiteration ] ) , irrespective of its positive initial condition . here and below , we denote by @xmath106 the total variation distance between distributions @xmath107 and @xmath108 .    [ theorem : bpconvergence ] assume @xmath7 , @xmath71 and @xmath0 is a graph of finite maximal degree  @xmath97",
    ". then , there exists @xmath109 finite , @xmath110 and a fixed point @xmath111 of the bp iteration ( [ eq : bpiteration ] ) such that for any positive initial condition @xmath112 and all @xmath113 , @xmath114    for @xmath115 let @xmath116 be the ball of radius @xmath117 around @xmath118 in @xmath0 , denoting by @xmath119 its edge set , by @xmath120 its border ( i.e. , the set of its vertices at distance @xmath117 from @xmath118 ) , and for each @xmath121 let @xmath122 denote any one fixed neighbor of @xmath10 in @xmath123 .",
    "our next result shows that the probability distribution @xmath124 with @xmath125 the fixed point of the bp iteration per theorem [ theorem : bpconvergence ] , is a good approximation for the marginal @xmath126 of variables @xmath127 under the ising model ( [ eq : isingmodel ] ) .",
    "[ theorem : bpcorrectness ] assume @xmath7 , @xmath71 and @xmath0 is a graph of finite maximal degree  @xmath97 . then",
    ", there exist finite @xmath128 and @xmath129 such that for any @xmath130 and @xmath131 , if @xmath132 is a tree then @xmath133      many common random graph ensembles @xcite naturally fit our framework .",
    "let @xmath40 be a uniformly random graph with degree @xmath23 .",
    "as @xmath134 , the sequence @xmath54 is obviously uniformly sparse , and converges locally almost surely to the rooted infinite tree of degree @xmath23 at every vertex .",
    "therefore , in this case theorem [ theorem : free_energy ] applies with @xmath135 and @xmath136 for @xmath137 .",
    "the distributional recursion ( [ eqn : h_recursion ] ) then evolves with a deterministic sequence @xmath70 recovering the result of @xcite .",
    "let @xmath40 be a uniformly random graph with @xmath138 edges over @xmath12 vertices .",
    "the sequence @xmath54 converges locally almost surely to a galton  watson tree with poisson offspring distribution of mean @xmath139 .",
    "this corresponds to taking @xmath140 .",
    "the same happens to classical variants of this ensemble .",
    "for instance , one can add an edge independently for each pair @xmath141 with probability @xmath142 , or consider a multi - graph with @xmath143 edges between each pair @xmath141 .",
    "the sequence @xmath54 is with probability one uniformly sparse in each of these cases .",
    "thus , theorem [ theorem : free_energy ] extends the results of @xcite to arbitrary nonzero temperature and magnetic field .",
    "let @xmath74 be a distribution with finite second moment and @xmath40 a uniformly random graph with degree distribution @xmath74 ( more precisely , we set the number of vertices of degree @xmath144 to @xmath145 , adding one for @xmath146 if needed for an even sum of degrees ) .",
    "then , @xmath54 is uniformly sparse and with probability one it converges locally to @xmath30 .",
    "the same happens if @xmath40 is drawn according to the so - called configuration model ( cf .",
    "we review here the notations and a couple of classical tools we use throughout this paper . to this end ,",
    "when proving our results it is useful to allow for vertex - dependent magnetic fields @xmath147 , that is , to replace the basic model ( [ eq : isingmodel ] ) by @xmath148 given @xmath149 , we denote by @xmath150 [ respectively , @xmath151 the vector @xmath152 , @xmath153 [ respectively , @xmath154 , dropping the subscript @xmath123 whenever clear from the context .",
    "further , we use @xmath155 when two real - valued vectors @xmath156 and @xmath157 are such that @xmath158 for all @xmath159 and say that a distribution @xmath160 over @xmath161 is dominated by a distribution @xmath162 over this set ( denoted @xmath163 ) , if the two distributions can be coupled so that @xmath164 for any pair @xmath165 drawn from this coupling",
    ". finally , we use throughout the shorthand @xmath166 for a distribution @xmath167 and function @xmath168 on the same finite set , or @xmath169 when @xmath167 is clear from the context .",
    "the first classical result we need is griffiths inequality ( see @xcite , theorem  iv.1.21 ) .",
    "[ theorem : monotonicity ] consider two ising models @xmath170 and @xmath171 on graphs @xmath172 and @xmath173 , inverse temperatures @xmath87 and @xmath174 , and magnetic fields @xmath175 and @xmath176 , respectively . if @xmath177 , @xmath178 and @xmath179 for all @xmath180 , then @xmath181 for any @xmath182 .",
    "the second classical result we use is the ghs inequality ( see @xcite ) about the effect of the magnetic field @xmath183 on the local magnetizations at various vertices .",
    "[ theorem : ghs ] let @xmath7 and for @xmath184 , denote by @xmath185 the local magnetization at vertex @xmath39 in the ising model ( [ eq : isingmodelgen ] ) . if @xmath186 for all @xmath180 , then for any three vertices @xmath187 ( not necessarily distinct ) , @xmath188    finally , we need the following elementary inequality :    [ lemma : simpleineq ] for any function @xmath189 $ ] and distributions @xmath167 , @xmath190 on the finite set @xmath191 such that @xmath192 and @xmath193 , @xmath194 in particular , if @xmath195 , then the right - hand side is bounded by @xmath196 .    assuming without loss of generality that @xmath197 , the left - hand side of ( [ eq : simpleineq ] ) can be bounded as @xmath198 this implies the lemma .",
    "we prove in this section certain facts about ising models on trees which are of independent interest and as a byproduct we deduce lemma [ lemma : recursive ] and the theorems of section [ sec : algoimpl ] . in doing so , recall that for each @xmath199 the ising models on @xmath200 with free and plus boundary conditions are @xmath201\\\\[-8pt ] & & { } \\times \\mathbb{i}\\bigl(\\underline{x}_{\\partial\\mathsf{t}(\\ell ) } = ( + ) _ { \\partial \\mathsf{t}(\\ell)}\\bigr )   .\\nonumber\\end{aligned}\\ ] ] equivalently @xmath202 is the ising model ( [ eq : isingmodelgen ] ) on @xmath200 with magnetic fields @xmath203 and @xmath204 is the modified ising model corresponding to the limit @xmath205 for all @xmath206 . to simplify our notation",
    "we denote such limits hereafter simply by setting @xmath207 and use @xmath208 for statements that apply to both free and plus boundary conditions .",
    "we start with the following simple but useful observation .",
    "[ lemma - observation ] for a subtree @xmath123 of a finite tree @xmath55 let @xmath209 denote the subset of vertices of @xmath123 connected by an edge to @xmath210 and for each @xmath211 let @xmath212 denote the root magnetization of the ising model on the maximal subtree @xmath213 of @xmath214 rooted at @xmath215 .",
    "the marginal on @xmath123 of the ising measure on @xmath55 , denoted @xmath216 is then an ising measure on @xmath123 with magnetic field @xmath217 for @xmath211 and @xmath218 for @xmath219 .    since @xmath123 is a subtree of the tree @xmath55 , the subtrees @xmath213 for @xmath211 are disjoint .",
    "therefore , with @xmath220 denoting the ising model distribution for @xmath213 we have that @xmath221 for the boltzmann weight @xmath222 further , @xmath223 so for each @xmath211 and some constants @xmath224 , @xmath225 embedding the normalization constants @xmath224 within @xmath226 we thus conclude that @xmath216 is an ising measure on @xmath123 with the stated magnetic field @xmath227 . finally , comparing the root magnetization for @xmath213 with that for @xmath228 we have by griffiths inequality that @xmath229 , as claimed .    [ theorem : treedecay ] suppose @xmath89 is a conditionally independent infinite tree of average offspring numbers bounded by @xmath97 , as in definition [ def - cit ] . for @xmath230 , @xmath231 and @xmath97",
    "finite , there exist @xmath232 and @xmath233 finite such that if @xmath234 for all @xmath235 and @xmath236 for all @xmath237 , @xmath238 , then @xmath239 for @xmath240 , all @xmath241 and @xmath242 .",
    "fixing @xmath238 it suffices to consider @xmath243 [ for which the side of ( [ eq : bd - influence ] ) is maximal ] . for this @xmath123 and @xmath244",
    "we have that @xmath245 and @xmath246 , where in this case the boltzmann weight @xmath247 in ( [ eq : boltz ] ) is bounded above by @xmath248 and below by @xmath249 for @xmath250 .",
    "further , the plus and free boundary conditions then differ in ( [ eq : boltz ] ) by having the corresponding boundary conditions at generation @xmath251 of each subtree @xmath213 , which we distinguish by using @xmath252 instead of @xmath253 .",
    "since the total variation distance between two product measures is at most the sum of the distance between their marginals , upon applying lemma [ lemma : simpleineq ] we deduce from ( [ eq : boltz ] ) that @xmath254 by our assumptions , conditional on @xmath243 , the subtrees @xmath255 of @xmath244 denoted hereafter also by @xmath256 are for @xmath257 independent of each other .",
    "further , @xmath258 is precisely the magnetization of their root vertex under plus / free boundary conditions at generation @xmath251 .",
    "thus , taking @xmath259 ( and using the inequality @xmath260 ) , it suffices to show that the magnetizations @xmath261 at the root of any such conditionally independent infinite tree @xmath89 satisfy @xmath262 , for some @xmath232 finite , all @xmath263 and @xmath199 , where we have removed the absolute value since @xmath264 by griffiths inequality . for greater convenience of the reader ,",
    "this fact is proved in the next lemma .",
    "[ lemma : mg - root ] suppose @xmath89 is a conditionally independent infinite tree of average offspring numbers bounded by @xmath97 . for @xmath230 , @xmath231 and @xmath97",
    "finite , there exist @xmath232 such that @xmath265 where @xmath261 are the root magnetizations under @xmath266 and free boundary condition on @xmath89 .",
    "note that ( [ eq : mg - root ] ) trivially holds for @xmath267 [ in which case @xmath268 .",
    "assuming hereafter that @xmath269 we proceed to prove ( [ eq : mg - root ] ) when each vertex of @xmath270 has a nonzero offspring number . to this end , for @xmath271 let @xmath272 and denote by @xmath273 the corresponding root magnetization . writing @xmath274 instead of @xmath275 for constant magnetic field on the leave nodes , that is , when @xmath276 for each @xmath277 , we note that @xmath278 and @xmath279 .",
    "further , applying lemma [ lemma - observation ] for the subtree @xmath280 of @xmath92 we represent @xmath281 as the root magnetization @xmath282 on @xmath280 where @xmath283 for @xmath284 and @xmath285 for all other @xmath10 .",
    "consequently , @xmath286 recall that if @xmath287 for @xmath288 , then applying jensen s inequality one variable at a time we have that @xmath289 for any independent random variables @xmath290 . by the ghs inequality , this is the case for @xmath291 , hence with @xmath292 denoting the conditional on @xmath92 expectation over the independent offspring numbers @xmath293 for @xmath294 , we deduce that @xmath295 where the last inequality is a consequence of griffiths inequality and our assumption that @xmath296 for any @xmath297 and all @xmath113 .",
    "since each @xmath298 has at least one offspring whose magnetic field is at least @xmath299 , it follows by griffiths inequality that @xmath300 is bounded below by the magnetization at the root of the subtree @xmath55 of @xmath92 where @xmath301 for all @xmath298 and @xmath302 for all @xmath294 . applying lemma [ lemma - observation ] for @xmath55 and @xmath303",
    ", the root magnetization for the ising distribution on @xmath55 turns out to be precisely @xmath304 for @xmath305 of ( [ eq : xidef ] ) .",
    "thus , one more application of griffiths inequality yields that @xmath306 next note that @xmath307 and by ghs inequality @xmath308 is concave .",
    "hence , @xmath309\\end{aligned}\\ ] ] for the finite constant @xmath310 and all @xmath263 . combining ( [ eq : bdp ] ) , ( [ eq : bd0 ] ) and ( [ eq : bd1 ] ) we obtain that @xmath311 \\\\ & \\le & m [ m^{k}(\\underline{b},0)- m^{k-1}(\\underline{b},0 ) ]    .\\end{aligned}\\ ] ] we have seen in ( [ eq : bd0 ] ) that @xmath312 is nondecreasing whereas from ( [ eq : bdpp ] ) and griffiths inequality we have that @xmath313 is nonincreasing . with magnetization bounded above by one , we thus get upon summing the preceding inequalities for @xmath314 that @xmath315\\le \\sum_{k=1}^{\\ell } \\mathbb{e}_{k-1 } [ m^{k,+}(\\underline { b})-m^{k,0}(\\underline{b } ) ] \\le m    , \\end{aligned}\\ ] ] from which we deduce ( [ eq : mg - root ] ) .",
    "considering now the general case where the infinite tree @xmath89 has vertices ( other than the root ) of degree one , let @xmath316 denote the `` backbone '' of @xmath200 , that is , the subtree induced by vertices along self - avoiding paths between @xmath90 and @xmath317 . taking @xmath318 as the subtree of @xmath244 in lemma [ lemma - observation ] , note that for each @xmath211 the subtree @xmath213 contains no vertex from @xmath317 .",
    "consequently , the marginal measures @xmath319 are ising measures on @xmath123 with the same magnetic fields @xmath320 outside @xmath317 .",
    "thus , with @xmath321 denoting the corresponding magnetizations at the root for @xmath316 , we deduce that @xmath322 where @xmath323 for all @xmath10 . by definition",
    "every vertex of @xmath324 has a nonzero offspring number and with @xmath325 , the required bound @xmath326 follows by the preceding argument , since @xmath316 is a conditionally independent tree whose offspring numbers @xmath327 do not exceed those of @xmath200 .",
    "indeed , for @xmath328 , given @xmath329 the offspring numbers at @xmath330 are independent of each other [ with probability of @xmath331 proportional to the sum over @xmath113 of the product of the probability of @xmath332 and that of precisely @xmath333 out of the @xmath334 offspring of @xmath10 in @xmath200 having a line of descendants that survives additional @xmath335 generations , for @xmath336 .",
    "simon s inequality ( see @xcite , theorem 2.1 ) allows one to bound the ( centered ) two point correlation functions in ferromagnetic ising models with zero magnetic field .",
    "we provide next its generalization to arbitrary magnetic field , in the case of ising models on trees .",
    "[ eq : lemmapatch ] if edge @xmath141 is on the unique path from @xmath90 to @xmath337 , with @xmath39 a descendant of @xmath297 , @xmath113 , then @xmath338 where @xmath339 denotes the expectation with respect to the ising distribution @xmath340 on the subtree @xmath256 of @xmath10 and all its descendants in @xmath341 and @xmath342 denotes the centered two point correlation function .",
    "it is not hard to check that if @xmath343 are @xmath344-valued random variables with @xmath345 and @xmath346 conditionally independent given @xmath347 , then @xmath348 in particular , under @xmath202 the random variables @xmath349 and @xmath350 are conditionally independent given @xmath351 with @xmath352 hence , if @xmath39 is the unique descendant of @xmath10 then @xmath353 and we get from ( [ eq : identity ] ) that @xmath354 for @xmath355 . next note that @xmath356 for any two @xmath344-valued random variables , and since @xmath357 and @xmath350 are conditionally independent given @xmath358 it follows from ( [ eq : identity ] ) that @xmath359 .",
    "further , if @xmath360 is the expectation with respect to an ising measure for some ( finite ) graph @xmath0 then for any @xmath361 @xmath362 from lemma [ lemma - observation ] we know that computing the marginal of the ising distribution for @xmath244 on a smaller subtree @xmath363 of interest has the effect of increasing its magnetic field .",
    "thus , combining the identity ( [ eq : ident - corr ] ) with ghs inequality , we see that reducing this field ( i.e. , restricting to @xmath123 the original ising distribution ) , increases the centered two point correlation function .",
    "that is , @xmath364 .",
    "similarly , considering lemma [ lemma - observation ] for @xmath365 we also have that @xmath366 which completes our thesis in case @xmath39 is the unique descendant of @xmath10 .",
    "turning to the general case , we compare the thesis of the lemma for @xmath200 and the subtree @xmath367 obtained upon deleting the subtrees rooted at descendants of @xmath10 ( and the corresponding edges to @xmath10 ) except for @xmath368 .",
    "while @xmath369 and @xmath370 are unchanged by this modification of the underlying tree ( as the relevant subgraphs are not modified ) , we have from lemma [ lemma - observation ] that @xmath371 is an ising measure on @xmath123 identical to the original but for an increase in the magnetic field at @xmath10 . in view of ( [ eq : ident - corr ] ) and the ghs inequality",
    ", we thus deduce that the value of @xmath372 is smaller for the ising model on @xmath200 than for the one on @xmath373 and since in @xmath373 the vertex @xmath39 is the unique descendant of @xmath10 , we are done .",
    "equipped with the preceding lemma we next establish the exponential decay of correlations and of the effect of boundary conditions in theorem [ theorem : treedecay ] .",
    "[ coro : susc ] there exist @xmath374 finite and @xmath375 positive , depending only on @xmath231 , @xmath299 , @xmath376 and @xmath97 such that @xmath377 for any @xmath378 and if @xmath234 for all @xmath379 then theorem [ theorem : treedecay ] holds for @xmath380 .",
    "taking @xmath205 for @xmath381 , note that ( [ eq : exponentialdecay ] ) applies when @xmath382 is with respect to @xmath383 .",
    "proof of corollary [ coro : susc ] starting with the proof of ( [ eq : exponentialdecay ] ) take @xmath384 for which the left - hand side is maximal ( as we have seen while proving lemma [ eq : lemmapatch ] ) .",
    "then , denoting by @xmath385 the expectation under the ising measure on @xmath341 with a magnetic field @xmath386 added to @xmath183 at all vertices @xmath257 , it follows from ( [ eq : ident - corr ] ) that @xmath387 by ghs inequality the latter derivative is nonincreasing in @xmath386 , whence @xmath388   .\\end{aligned}\\ ] ] let @xmath389 if @xmath257 and @xmath390 otherwise , so @xmath391 .",
    "further , from griffiths inequality also @xmath392 and it follows that @xmath393 in particular , setting @xmath394 , in view of lemma [ lemma : mg - root ] we find that @xmath395 for @xmath396 .",
    "further , since @xmath89 is conditionally independent , the same proof shows that if @xmath397 and @xmath368 is the subtree of @xmath341 of depth @xmath398 rooted at @xmath399 then @xmath400 considering inequality ( [ ineq - simon ] ) of lemma [ eq : lemmapatch ] for @xmath401 and all @xmath402 we find that @xmath403 \\biggr\\ } \\\\ & \\le & \\frac{1}{e \\delta } \\mathbb{e}\\biggl\\ { \\sum_{i\\in\\partial\\mathsf{t}(t ) } \\delta_i \\langle x_{\\o};x_{i}\\rangle^{(t)}_{\\o } \\biggr\\ } \\le e^{-1 } \\gamma_{r_1 }   .\\end{aligned}\\ ] ] iterating the preceding bound at @xmath404 , for @xmath405 and noting that by ( [ eq : bd - corr ] ) we have the bound @xmath406 at the last step , we get the uniform in @xmath263 exponential decay of ( [ eq : exponentialdecay ] ) .",
    "next , recall that the rate @xmath407 in theorem [ theorem : treedecay ] is merely the rate in the bound ( [ eq : mg - root ] ) . for @xmath408 we choose uniformly and independently of everything else a one to one mapping @xmath409 , and let @xmath410 for @xmath411 denote the magnetic field configuration obtained when taking @xmath412 for all @xmath413 ( with @xmath414 ) . since @xmath415   , \\ ] ] we get the rate @xmath416 from ( [ eq : exponentialdecay ] ) as soon as we show that for @xmath417 and @xmath418 , @xmath419 to this end , let @xmath420 denote the expectation under @xmath202 with magnetic field @xmath410 so @xmath421 .",
    "further , fixing @xmath417 @xmath422 [ since @xmath423 . since @xmath424 by griffiths inequality , it follows that @xmath425 which by ghs inequality is maximal at @xmath426 , yielding ( [ eq : magnvssusc ] ) and completing the proof .",
    "as promised , lemma [ lemma : recursive ] follows from the preceding results .",
    "proof of lemma [ lemma : recursive ] consider the galton ",
    "watson tree @xmath31 of section  [ sec : local ] and the corresponding ising models @xmath427 of constant magnetic field @xmath428 on the subtrees @xmath28 .",
    "it is easy to check that the random variables @xmath429 satisfy the distributional recursion ( [ eqn : h_recursion ] ) starting at @xmath64 . by griffiths inequality @xmath430 , hence @xmath70 ,",
    "is nondecreasing in @xmath27 , and so converges almost surely as @xmath431 to a limiting random variable @xmath72 .",
    "further , the bounds @xmath432 hold for all @xmath27 and hence also for @xmath72 .",
    "we thus deduce that the distributions @xmath433 of @xmath70 as determined by ( [ eqn : h_recursion ] ) are stochastically monotone ( in  @xmath27 ) and converge weakly to some law @xmath434 of @xmath72 that is supported on @xmath73 .",
    "next , recall that for any fixed @xmath23 and @xmath435 continuous and bounded on @xmath436 , the functional @xmath437 is continuous with respect to weak convergence of probability measures on @xmath73 ( e.g. , see @xcite , lemma  7.3.12 )",
    ". fixing @xmath438 $ ] continuous , clearly @xmath439 are continuous and bounded .",
    "further , it follows from ( [ eqn : h_recursion ] ) that for all @xmath27 @xmath440 taking @xmath431 followed by @xmath441 , we deduce by the preceding arguments [ and the uniform boundedness @xmath442 for all @xmath39 ] , that @xmath444 as this applies for every bounded continuous function @xmath445 , we conclude that @xmath72 and its law @xmath434 are a fixed point of the distributional recursion ( [ eqn : h_recursion ] ) .",
    "next note that the random variables @xmath446 $ ] form a non - increasing sequence that satisfies the same distributional recursion , but with the initial condition @xmath447 . consequently , by the same arguments we have used before , the laws @xmath448 of @xmath449 converge weakly to some fixed point @xmath450 of ( [ eqn : h_recursion ] ) that is also supported on @xmath73 .",
    "further , @xmath451 for @xmath452 and any ( other ) possible law @xmath453 of a fixed point @xmath454 of ( [ eqn : h_recursion ] ) that is supported on @xmath73 .",
    "coupling so as to have the same value of @xmath66 , evidently the recursion ( [ eqn : h_recursion ] ) preserves this stochastic order , which thus applies for all @xmath27 . in the limit @xmath431",
    "we thus deduce that @xmath455 . since @xmath67 has finite first moment , by ( [ eq : mg - root ] ) of theorem [ theorem : treedecay ] , @xmath456 as @xmath431 .",
    "thus , the expectation of the monotone increasing continuous and bounded function @xmath457 is the same under both @xmath458 and @xmath459 .",
    "necessarily this is also the expectation of @xmath457 under @xmath453 and the uniqueness of the nonnegative fixed point of ( [ eqn : h_recursion ] ) follows .",
    "we next control the dependence on @xmath87 of the distribution of the fixed point @xmath72 from lemma [ lemma : recursive ] .",
    "[ lemma : beta ] let @xmath460 denote the monge ",
    "wasserstein distance between given laws of random variables @xmath461 and @xmath462 ( that is , the infimum of @xmath463 over all couplings of @xmath461 and @xmath462 ) . for any @xmath71 and @xmath231 finite there exists a constant @xmath464 such that if @xmath465 , @xmath466 are the fixed points of the recursion ( [ eqn : h_recursion ] ) for @xmath467 , then @xmath468    fixing a random tree @xmath469 of degree distribution @xmath67 , recall that while proving lemma [ lemma : recursive ] we provided a coupling of the random variables @xmath470 and the ising root magnetizations @xmath471 at @xmath87 such that @xmath472 for each @xmath87 and all @xmath27 . by griffiths inequality",
    "the magnetizations at the root are nondecreasing in @xmath87 so from the bound ( [ eq : mg - root ] ) we get that for @xmath473 and any @xmath474 , @xmath475 where the expectations are over the random tree @xmath31 . considering @xmath431",
    "it thus suffices to show that @xmath476 $ ] is bounded , uniformly in @xmath477 and @xmath263 . to this end ,",
    "a straightforward calculation yields @xmath478 with @xmath479 denoting the expectation with respect to the ising measure @xmath202 .",
    "if @xmath10 is on the path in @xmath200 between the root and @xmath39 , then under the measure @xmath202 the variables @xmath349 and @xmath480 are conditionally independent given @xmath357 .",
    "further , as @xmath481 it is easy to check that in this case @xmath482 where @xmath483 is the arithmetic mean of the conditional expected value of @xmath480 for @xmath484 and the conditional expected value of @xmath480 for @xmath485 .",
    "thus , @xmath486 and recalling ( [ eq : ident - corr ] ) that @xmath487 is nonnegative by griffiths inequality , we deduce that @xmath488 where @xmath293 denotes the offspring number at @xmath489 and by ( [ eq : ident - corr ] ) @xmath490 [ with @xmath491 the root magnetization for the measure @xmath492 of ( [ eq : mubh ] ) ] . in view of lemma",
    "[ lemma - observation ] we have that @xmath493 for some nonnegative vector @xmath275 . by ghs inequality",
    "we deduce that for any @xmath494 @xmath495 consequently , @xmath496 is nonincreasing in @xmath477 and @xmath497 \\le\\sum_{r=0}^{\\ell-1 } \\mathbb{e}v_{r,\\ell } \\leq\\sum_{r=0}^{\\ell-1 } \\mathbb{e}v_{r , r } \\leq\\sum_{r=0}^{\\infty } \\mathbb{e}v_{r , r }   .\\ ] ] further , @xmath498 is independent of the offspring numbers at @xmath499 whose expectation with respect to the random tree @xmath500 is @xmath501 .",
    "thus , applying ( [ eq : exponentialdecay ] ) of corollary [ coro : susc ] for @xmath502 , @xmath503 and constant magnetic field , we find that for some @xmath374 finite , @xmath504 , any @xmath505 and all @xmath263 @xmath506 = \\overline{\\rho }   \\mathbb{e}\\biggl [ \\sum_{i \\in\\partial\\mathsf{t}(r ) } \\langle x_{\\o};x_i\\rangle \\biggr ] \\le\\overline{\\rho }   a e^{-\\lambda r }   .\\ ] ] summing over @xmath117 gives us the required uniform boundedness of @xmath476 $ ] in @xmath477 and @xmath263 .",
    "the theorems stated in section [ sec : algoimpl ] are in fact consequences of corollary [ coro : susc ] .",
    "proof of theorem [ theorem : bpconvergence ] the proof is based on the well - known representation of the iteration ( [ eq : bpiteration ] ) in terms of `` computation tree '' @xcite . namely , @xmath507 coincides with the marginal at the root of the ising model ( [ eq : isingmodel ] ) on a properly constructed , deterministic tree @xmath508 of @xmath27 generations . while we refer to the literature for the precise definition of @xmath508 , here are some immediate properties :    one can construct an infinite tree @xmath509 such that , for any @xmath27 , @xmath508 is the subtree formed by the first @xmath27 generations of @xmath509 .    the maximal degree of @xmath509 is bounded by the maximal degree of @xmath0 ( and equal to the latter when @xmath0 is connected ) .",
    "a positive initialization corresponds to adding @xmath510 nonnegative to the field @xmath6 on the @xmath27th generation vertices of @xmath508 .",
    "denote by @xmath511 , @xmath512 the messages obtained under initializations@xmath513 and @xmath514 , respectively . by griffiths inequality ,",
    "@xmath515 is nonincreasing in @xmath27 , @xmath516 is nondecreasing in @xmath27 and any positive initialization results with @xmath517 such that @xmath518 by corollary [ coro : susc ] we have that @xmath519 for all @xmath113 .",
    "since @xmath520 and @xmath504 depend only on @xmath87 , @xmath6 and the maximal degree of @xmath0 , this immediately yields our thesis .",
    "proof of theorem [ theorem : bpcorrectness ] we use an additional property of the computation tree :    if @xmath521 is a tree then @xmath522 is a tree rooted at @xmath523 whose vertices are the directed edges on the maximal subtree of @xmath521 rooted at @xmath10 that does not include  @xmath39 .    without loss of generality we may and",
    "shall assume that @xmath524 .",
    "for @xmath131 consider the local marginal approximations @xmath525 , @xmath526 defined as in ( [ eq : localmarg ] ) except that the fixed point messages @xmath527 at @xmath528 are replaced by those obtained after @xmath529 iterations starting at @xmath513 and @xmath514 , respectively . since @xmath132 is a tree , here @xmath122 is necessarily the neighbor of @xmath10 on the path from @xmath118 to @xmath528 and from the preceding property ( d ) we see that @xmath530 corresponds to the subtree of @xmath10 and its lines of descendant in @xmath132 . by property ( c )",
    "we thus have that @xmath531 and @xmath532 are the marginals on @xmath123 of the ising model @xmath533 on @xmath0 with @xmath534 at all @xmath535 and the ising model @xmath536 on the vertices of @xmath0 and the edges within the tree @xmath132 .",
    "such reasoning also shows that the probability measure @xmath537 of ( [ eq : localmarg ] ) is the marginal on @xmath123 of the ising model @xmath167 on vertices of @xmath0 and edges of @xmath132 with an additional nonnegative magnetic field @xmath538 at @xmath539 .",
    "consequently , with @xmath540 we have by griffiths inequality that for any @xmath541 @xmath542 and we deduce that for any @xmath541 , @xmath543 recall that since @xmath544 , for any possible value @xmath545 of @xmath546 , @xmath547 and with @xmath548 it follows that @xmath549 this applies for any of the @xmath550 possible values of @xmath551 , so @xmath552 applying corollary [ coro : susc ] for the deterministic tree @xmath132 rooted at @xmath118 , we get the bound ( [ eq : bd - influence ] ) on the right side of the preceding inequality with @xmath553 , some finite @xmath374 and @xmath504 that depend only on @xmath87 , @xmath6 and @xmath97 .",
    "thus , noting that @xmath554 we establish our thesis upon choosing @xmath555 large enough .",
    "we start with the following technical lemma .    [ lemma : expansion ] consider a convex set @xmath556 and symmetric twice differentiable functions @xmath557 with @xmath558 constant , such that for some finite constant  @xmath559 , @xmath560 suppose i.i.d .",
    "@xmath561 are such that @xmath562 is bounded uniformly in @xmath477 and @xmath563 and the independent , square - integrable , nonnegative integer valued random variable @xmath78 satisfies @xmath564 = 0 \\qquad \\forall x\\in\\mathcal{k } .\\end{aligned}\\ ] ] then , for any i.i.d .",
    "@xmath565 also independent of @xmath78 , @xmath566|\\nonumber \\\\[-8pt]\\\\[-8pt ] & & \\qquad\\le c \\mathbb{e}[l ( l-1 ) ] \\|x - y\\|^2_{\\mathrm{mk } }   .\\nonumber\\end{aligned}\\ ] ]    our thesis trivially holds if either @xmath567 or @xmath568 , so without loss of generality , fixing @xmath569 we assume hereafter that @xmath570 are i.i.d . pairs , independent on @xmath78 and coupled in such a way that @xmath571 is finite .",
    "it is easy to check that almost surely , @xmath572\\\\[-8pt ] & & \\qquad = \\sum _ { i=1}^\\ell\\delta_i f_\\ell+ \\sum_{i\\neq j}^\\ell f_{ij}^{(\\ell ) } ( y_i - x_i ) ( y_j - x_j )   , \\nonumber\\end{aligned}\\ ] ] where @xmath573 and each of the terms @xmath574 is bounded by @xmath559 . for i.i.d .",
    "@xmath570 , by the symmetry of the functions @xmath575 with respect to their arguments , the assumed boundedness of @xmath576 implies integrability of @xmath577 with @xmath578 independent of @xmath10 and @xmath579 uniformly bounded .",
    "this in turn implies the integrability of @xmath580 for any @xmath78 square integrable and independent of @xmath570 , so by fubini s theorem and our assumption ( [ eq : vanish - first - der ] ) , @xmath581 \\\\ & & \\qquad = \\mathbb{e } [ l \\delta_1 f_l ] \\\\ & & \\qquad= \\mathbb{e}\\biggl [ ( y_1-x_1 ) \\\\ & & { } \\qquad\\qquad \\times\\int_0 ^ 1\\mathbb{e}\\bigl[l \\partial_{x_1 } f_l   \\bigl(ty_1+(1-t)x_1,x_2 , \\dots , x_l\\bigr )    | x_1,y_1 \\bigr]\\ , \\mathrm{d}t \\biggr ] = 0   .\\end{aligned}\\ ] ] thus , considering the expectation of ( [ eq : taylor ] ) , by the uniform boundedness of @xmath582 and the independence of @xmath78 on the i.i.d .",
    "pairs @xmath570 , we deduce that @xmath583 | & \\le & c \\mathbb{e}\\sum_{i\\neq j}^l |y_i - x_i| |y_j - x_j| \\\\ & \\le & \\gamma^2 c \\mathbb{e}[l ( l-1 ) ]    \\|x - y\\|^2_{\\mathrm{mk } }   .\\end{aligned}\\ ] ] finally , taking @xmath584 yields the bound ( [ eq : claim ] ) .",
    "[ rem - mod ] it is not hard to adapt the proof of the lemma so as to replace @xmath585 by @xmath586 for a twice differentiable symmetric function @xmath587 .",
    "taking @xmath588 the contribution of @xmath589 to the left - hand side of ( [ eq : vanish - first - der ] ) is then @xmath590 $ ] and the bound ( [ eq : claim ] ) is modified to @xmath591\\nonumber \\\\ & & { } \\quad + \\sum_{\\ell\\ge2 } p_\\ell \\mathbb{e } [ f_\\ell(y_1,\\dots , y_\\ell)- f_\\ell(x_1,\\dots , x_\\ell ) ] \\biggr| \\\\ & & \\qquad\\le c \\mathbb{e}[l^2 ] % can use here -- e[l^2 ] - e[l ] + \\prob(l=1 ) instead of the larger % e[l^2 ]    \\|x - y\\|^2_{\\mathrm{mk } }   .\\nonumber\\end{aligned}\\ ] ]    consider the functional @xmath592 that , given a random variable @xmath593 , evaluates the right - hand side of equation  ( [ eqn : phi ] ) .",
    "it is not hard to check that @xmath594 is well defined and finite for every random variable @xmath593 .",
    "the following corollary of lemma [ lemma : expansion ] plays an important role in the proof of theorem [ theorem : free_energy ] .",
    "[ lemma : stationarity ] there exist nondecreasing finite @xmath595 such that if @xmath596 and @xmath72 is a fixed point of the distributional identity ( [ eqn : h_recursion ] ) for some @xmath597 then @xmath598    setting @xmath599 so @xmath600 , we verify the conditions oflemma  [ lemma : expansion ] when @xmath601 are i.i.d",
    ". copies of @xmath602 and @xmath603 i.i.d .",
    "copies of @xmath604 , all of whom take values in @xmath605 $ ] and are independent of the random variable @xmath78 .",
    "we apply the lemma in this setting for the symmetric , twice differentiable functions @xmath606 for @xmath607 , and as in remark [ rem - mod ] , @xmath608 indeed , setting @xmath609 and for each @xmath199 @xmath610 [ so @xmath611 , it is not hard to verify that @xmath612 while for @xmath607 @xmath613 in particular , @xmath614 are differentiable functions from @xmath615 to @xmath616 , such that @xmath617 are uniformly bounded [ by @xmath618 and @xmath619 is uniformly bounded on @xmath620 [ by @xmath621 .",
    "consequently , @xmath622 and @xmath623 are also uniformly bounded [ by @xmath624 and @xmath625 , respectively ] .",
    "further , @xmath72 is a fixed point of ( [ eqn : h_recursion ] ) , hence @xmath626 . with",
    "@xmath601 identically distributed and @xmath627 we thus find as required in ( [ eq : vanish - first - der ] ) that @xmath628   + \\sum _ { k \\ge2 } k p_k \\mathbb{e } [ \\partial_{x_1 } f_k ( x , x_2,\\ldots , x_k ) ] \\nonumber \\\\[-8pt]\\\\[-8pt ] & & \\qquad = \\overline{p }   \\biggl\\ {    \\sum_{k=1}^\\infty\\rho_k \\mathbb{e } [ \\psi ( x , g_k(x_2,\\dots , x_k ) ) ] - \\mathbb{e}\\psi(x , x_1 )    \\biggr\\ } = 0   .\\nonumber\\end{aligned}\\ ] ] noting that @xmath629 = \\overline{p }   \\overline{\\rho } $ ] our thesis is merely the bound ( [ eq : claim - mod ] ) upon confirming that @xmath630 for some constant @xmath558 and that both series are absolutely summable .",
    "let @xmath631 denote the infinite random tree obtained by `` gluing '' two independent trees from the ensemble @xmath31 through an extra edge @xmath632 between their roots and considering  @xmath632 as the root of @xmath631 denote by @xmath633 the subtree formed by its first @xmath27 generations [ i.e. , consisting of @xmath632 and the corresponding two independent copies from @xmath28 ] .",
    "an alternative way to sample from @xmath635 is to have independent offspring number @xmath26 with probability @xmath25 at each end of the root edge  @xmath632 and thereafter independently sample from this offspring distribution at each revealed new node of the tree .",
    "equipped with these notations we have the following consequence of the local convergence of the graph sequence @xmath54 .    [ lemma : edgetree ] suppose a uniformly sparse graph sequence @xmath54 converges locally to the random tree @xmath30 .",
    "fixing a nonnegative integer @xmath27 , for each @xmath636 denote the subgraph of @xmath40 induced by vertices at distance at most @xmath27 from @xmath141 by @xmath637 .",
    "let @xmath435 be a fixed , bounded function on the collection of all possible subgraphs that may occur as @xmath637 , such that @xmath638 whenever @xmath639 .",
    "then , @xmath640    denoting by @xmath641 the expectation with respect to auniformly chosen edge @xmath141 in @xmath642 , the left - hand side of ( [ eq : edge - conv ] ) is merely @xmath643 .",
    "a  uniformly chosen edge can be sampled by first selecting a vertex @xmath10 with probability proportional to its degree @xmath45 and then picking one of its neighbors @xmath644 uniformly .",
    "thus , denoting by @xmath645 the expectation with respect to a uniformly chosen random vertex @xmath646 $ ] , we have that @xmath647 marking uniformly at random one offspring of @xmath90 in @xmath648 [ as corresponding to @xmath122 ] , let @xmath650 denote the subtree induced by vertices whose distance from either @xmath90 or its marked offspring is at most @xmath27 . since @xmath651 and with probability @xmath652 as @xmath441 the random tree @xmath648 belongs to the finite collection of trees with @xmath653 generations and maximal degree at most @xmath23 , it follows by dominated convergence and the local convergence of @xmath54 that for any fixed @xmath654 , @xmath655 \\\\ & & \\qquad = \\mathbb{e}_\\rho \\bigl\\{\\delta_{\\o } \\mathbb{i}(\\delta_{\\o } \\le l ) f\\bigl(\\mathsf{t } _ * ( t+1)\\bigr)\\bigr\\ }   , \\end{aligned}\\ ] ] where @xmath656 and @xmath657 denote expectations and the degree of the root , respectively , in @xmath30 .",
    "similarly , @xmath658 further , by the uniform sparsity of @xmath54 , @xmath659 \\bigr| \\\\ & & \\qquad \\le\\|f\\|_\\infty \\limsup_{n \\to\\infty } \\mathbb{e}_n [   |{\\partial i}|   \\mathbb{i}(|{\\partial i}| > l ) ] \\end{aligned}\\ ] ] goes to zero as @xmath660 .",
    "since @xmath74 has a finite first moment , @xmath657 is integrable , so by the preceding , upon taking @xmath660 we deduce by dominated convergence that @xmath661 to complete the proof note that the right - hand side of the last expression is precisely @xmath662 and we have also shown that @xmath663 .",
    "proof of theorem [ theorem : free_energy ] since @xmath664 is invariant under @xmath665 and is uniformly ( in @xmath12 ) lipschitz continuous in @xmath6 with lipschitz constant one , it suffices to fix @xmath71 and show that @xmath86 converges as @xmath666 to the predicted @xmath667 of ( [ eqn : phi ] ) , whereby @xmath668 is the unique fixed point of the recursion ( [ eqn : h_recursion ] ) that is supported on @xmath73 ( see lemma [ lemma : recursive ] ) .",
    "this is obviously true for @xmath267 since @xmath669 .",
    "next , denoting by @xmath670 the expectation with respect to the ising measure on @xmath40 ( at parameters @xmath87 and @xmath6 ) , it is easy to see that @xmath671 clearly @xmath672 is bounded by the uniform sparsity of @xmath54 so it is enough to show that the expression in ( [ eq : derivativegraph ] ) converges to the partial derivative of @xmath673 with respect to @xmath87 . turning to compute the latter derivative , by lemma  [ lemma : beta ] and corollary [ lemma : stationarity ] we can ignore the dependence of @xmath674 on @xmath87 .",
    "that is , we simply compute the partial derivative in @xmath87 of the expression ( [ eqn : phi ] ) while considering ( the law of ) @xmath80 to be fixed .",
    "indeed , with notation @xmath599 and @xmath675 as in the derivation of corollary [ lemma : stationarity ] , a direct computation leads by the exchangeability of @xmath601 to @xmath676 \\\\ & & { } + ( 1-u^2 ) \\mathbb{e } [ l \\psi(x_1,g_l(x_2,\\ldots , x_l))]\\end{aligned}\\ ] ] for @xmath677 and @xmath678 of ( [ eq : gdef ] ) .",
    "further , the fixed point property ( [ eq : fixpt ] ) applies for any bounded measurable @xmath679 , so we deduce that @xmath680 & = & \\overline{p }   \\mathbb{e}[\\psi(x_1,g_k(x_2,\\ldots , x_k ) ) ] \\\\ & = & \\overline{p }   \\mathbb{e } [ \\psi(x_1,x_2 ) ]   .\\end{aligned}\\ ] ] consequently , it is not hard to verify that @xmath681 = \\frac{\\overline{p}}{2 } \\mathbb{e}\\biggl\\{\\frac{u + x_1 x_2}{1 + u x_1 x_2 } \\biggr\\ } = \\frac{\\overline{p}}{2 } \\mathbb{e } [ \\langle x_i x_j\\rangle _ { \\overline{\\mathsf{t } } } ]    , \\end{aligned}\\ ] ] where @xmath682 denotes the expectation with respect to the ising model @xmath683 on one edge @xmath684 and random magnetic fields @xmath685 and @xmath686 that are independent copies of @xmath674 .    in comparison , fixing a positive integer @xmath27 , by griffiths inequality the correlation @xmath687 lies between the correlations @xmath688 and @xmath689 for the ising model on the subgraph @xmath637 with free and plus , respectively , boundary conditions at @xmath690 .",
    "thus , in view of ( [ eq : derivativegraph ] ) @xmath691 and taking @xmath134 we get by lemma [ lemma : edgetree ] that @xmath692 & \\le & \\liminf_{n\\to\\infty } \\partial_\\beta   \\phi_n(\\beta , b ) \\\\ & \\le&\\limsup_{n\\to\\infty } \\partial_\\beta   \\phi_n(\\beta , b ) \\le \\frac{\\overline{p}}{2 } \\mathbb{e } [ f_+ ( \\overline{\\mathsf{t}}(\\rho , t ) ) ]   .\\end{aligned}\\ ] ] to compute @xmath693 we first sum over the values of @xmath350 for @xmath694 .",
    "this has the effect of reducing @xmath693 to a form of @xmath695 .",
    "further , as shown in the proof of lemma [ lemma : recursive ] , we get @xmath693 by setting for @xmath685 and @xmath686 two independent copies of the variables @xmath70 and @xmath696 , respectively , which converge in law to @xmath697 when @xmath431 .",
    "we also saw there that the functional @xmath698 $ ] [ for continuous and bounded @xmath699 , is continuous with respect to the weak convergence of the law @xmath167 of @xmath685 .",
    "consequently , by ( [ eq : freeder ] ) @xmath700 = \\partial_\\beta \\varphi(\\beta , b )   , \\ ] ] which completes the proof of the theorem ."
  ],
  "abstract_text": [
    "<S> we consider ferromagnetic ising models on graphs that converge locally to trees . </S>",
    "<S> examples include random regular graphs with bounded degree and uniformly random graphs with bounded average degree . </S>",
    "<S> we prove that the `` cavity '' prediction for the limiting free energy per spin is correct for _ any positive temperature and external field_. further , local marginals can be approximated by iterating a set of mean field ( cavity ) equations . </S>",
    "<S> both results are achieved by proving the local convergence of the boltzmann distribution on the original graph to the boltzmann distribution on the appropriate infinite random tree .    .    . </S>"
  ]
}