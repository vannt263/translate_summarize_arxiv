{
  "article_text": [
    "let @xmath0 be i.i.d . with mean zero and unit variance ; take @xmath1 , @xmath2 , with @xmath3 ; and let @xmath4 , @xmath5 , be standard brownian motion . by donsker s theorem , if @xmath6 is continuous and piecewise linear with @xmath7 then @xmath8 in @xmath9 as @xmath10 .",
    "let @xmath11 be a smooth function on @xmath12 with @xmath13 , such that @xmath14 is finite almost surely , and define @xmath15 defining boundary levels @xmath16 this stopping time can be written as @xmath17 as the form suggests , @xmath18 as @xmath10 .",
    "this can be established by introducing @xmath19 , arguing that @xmath20 , and using the continuous mapping theorem , theorem  5.1 of billingsley  @xcite , to show that @xmath21 .",
    "note that the brownian path @xmath22 will be a continuity point for the transformation @xmath23 whenever @xmath24 , and this holds with probability one by the strong markov property .",
    "we also have @xmath25 , and so @xmath26 as @xmath10 .",
    "thus if @xmath27 is a bounded continuous function , @xmath28 for large @xmath29 , the limit here provides a natural approximation for the expectation on the left - hand side .",
    "the main result of this paper provides correction terms of order @xmath30 , improving this approximation .",
    "the excess over the boundary , @xmath31,\\ ] ] plays an important role in this analysis .",
    "the excess over the boundary also plays a central role in nonlinear renewal theory , where the law of large numbers drives the leading order approximation .",
    "see woodroofe  @xcite or siegmund  @xcite for a discussion and applications to sequential analysis .",
    "with the brownian motion scaling considered in this paper , results on improved approximations and the excess over the boundary are given by siegmund  @xcite , siegmund and yuh  @xcite , yuh  @xcite and hogan  @xcite .",
    "siegmund  @xcite suggests various applications of this theory to sequential analysis ; broadie _ et  al . _",
    "@xcite , broadie _",
    "et  al . _",
    "@xcite and kou  @xcite use it to study options pricing ; and glasserman and liu  @xcite consider its use for inventory control . with the exception of hogan  @xcite , stopping boundaries in these papers are linear .    to appreciate the role of the excess @xmath32 in improving ( [ thelimit ] ) , note that if @xmath33 $ ] , then @xmath34 .",
    "hogan  @xcite derives the limiting joint distribution for @xmath32 and @xmath35 ; they are asymptotically independent , and the limiting distribution for @xmath32 has mean @xmath36 where @xmath37 is the ladder time @xmath38 hogan s argument is quite delicate .",
    "it is based on conditioning on a stopping time with a boundary just slightly less than the boundary for @xmath35 . by contrast , the approach pursued here is more global and analytic in character , but relies on smoothness of @xmath27 and @xmath11 to a greater extent .",
    "formulas to calculate @xmath39 numerically are given by siegmund  @xcite and keener  @xcite .",
    "an important special case of ( [ thelimit ] ) would be first passage probabilities , @xmath40 .",
    "the regularity conditions here require differentiable @xmath27 , so this case is formally excluded ( although our result would suggest an approximation ) .",
    "refined approximations for these probabilities are also suggested by hogan  @xcite , but his derivation is heuristic and assumes @xmath41",
    ".    the limit in ( [ thelimit ] ) can be found by solving the heat equation . to describe its relevance ,",
    "let @xmath42 be a process starting at time @xmath43 and position @xmath44 given by @xmath45 let @xmath46 be stopping times given by @xmath47 and define @xmath48 noting that @xmath49 and @xmath50 , the limit @xmath51 in ( [ thelimit ] ) is @xmath52 . by the feynman ",
    "kac formula ( kac  @xcite ) , @xmath53 satisfies the heat equation @xmath54 in the region @xmath55 , with boundary condition @xmath56 .",
    "furthermore , @xmath53 is the unique solution in a suitable class of functions ; see krylov  @xcite or bass  @xcite . in practice ,",
    "@xmath52 can be computed by numerical solution of the heat equation . in the sequel , continuity and differentiability of @xmath53",
    "will play an important role .",
    "boundary effects associated with the excess @xmath32 only arise ( to order @xmath57 ) when @xmath58 and @xmath59 disagree along the boundary .",
    "let @xmath60 denote the difference @xmath61 and decompose @xmath27 as the sum @xmath62 with @xmath63 and @xmath64 since @xmath53 and @xmath59 agree with @xmath65 and @xmath66 along the boundary , it seems appropriate to view @xmath52 as an approximation for @xmath67 .",
    "it is then natural and convenient to extend @xmath53 above the boundary , defining @xmath68 with this convention , @xmath69 and @xmath70 are both continuous at the boundary . note also that @xmath71    [ thm : main ] assume :    1 .",
    "the distribution of @xmath72 is strongly non - lattice ( or satisfies cramer s condition c ) , @xmath73 and @xmath74 , @xmath75 and @xmath76 .",
    "the stopping times @xmath35 , @xmath77 , are uniformly integrable .",
    "the boundary function @xmath11 has a bounded first derivative and @xmath13 .",
    "the function @xmath27 and its first and second order partial derivatives are bounded and continuous . 5 .",
    "the functions @xmath53 , @xmath59 , @xmath78 , @xmath79 , @xmath80 , @xmath81 and @xmath82 are bounded and continuous .",
    "then @xmath83 as @xmath10",
    ".    the second assumption will hold if @xmath84 for some @xmath85 .",
    "if @xmath11 and @xmath27 are sufficiently smooth , then the final assumption follows from standard hlder estimates for solutions of parabolic differential equations ; see , for instance , problem  4.5 of lieberman  @xcite .",
    "the heat equation for @xmath53 can be derived , at least informally , by conditioning a short time interval into the future .",
    "there is an analogous equation in discrete time .",
    "define @xmath86 and @xmath87 conditioning on @xmath88 , @xmath89 unfortunately , with integration against the distribution of @xmath72 , this convolution - type equation is usually less tractable numerically than the heat equation .",
    "theorem  [ thm : main ] evolved from my attempts to improve @xmath69 as an approximation for @xmath90 by imitating the matched asymptotic expansions used to study boundary effects in partial differential equations .",
    "the method might also be viewed as martingale approximation , with bounds for potential or renewal measures playing a central role in the proofs .    to study the error of @xmath91 as an approximation for @xmath67 , define functions @xmath92",
    "writing @xmath93\\\\ & = & { \\bar u}(0,0)+e\\sum_{k=0}^{n\\tau_n-1}e_n\\bigl(k / n , s_k/\\sqrt n\\bigr),\\nonumber\\end{aligned}\\ ] ] a correction term for the approximation @xmath94 will be sought by approximating the expected sum in this equation .",
    "details for this calculation are given in section  [ sec : approxf0 ] .",
    "the approximation for @xmath95 is derived in section  [ sec : approxf1 ] .",
    "[ lem : approxe ] under the assumptions of theorem  [ thm : main ] , @xmath96 \\\\[-8pt ] \\nonumber & & { } + \\mathrm{o}(1/n^2)+\\mathrm{o}\\biggl(\\frac{1/n}{1+n[b(t)-x]^2}\\biggr)\\end{aligned}\\ ] ] as @xmath10 , uniformly for @xmath5 , @xmath97 . from this , @xmath98 ^ 2}\\biggr)\\ ] ] as @xmath10 , uniformly for @xmath5 , @xmath97 .    by taylor expansion of @xmath53 , on @xmath99 we have @xmath100 \\\\[-8pt ] \\nonumber & & { } + \\frac{x^3{\\bar u}_{xxx}(t , x)}{6n\\sqrt n}+\\mathrm{o}(x^4/n^2).\\end{aligned}\\ ] ] lagrange s formula for the remainder will involve @xmath101 at an intermediate value @xmath102 between @xmath44 and @xmath103 , and from this",
    "it is clear that this equation holds uniformly for @xmath5 , @xmath97 . since @xmath104 exists unless @xmath105 and is bounded , on @xmath106 , @xmath107 as @xmath10 .",
    "again , this will hold uniformly for @xmath5 , @xmath97 . noting that @xmath108 we can combine ( [ below ] ) and ( [ above ] ) to obtain @xmath109 the first assertion ( [ firstline ] ) follows by integrating against the distribution of @xmath72 , noting that @xmath110 & \\le&\\min\\biggl\\{\\frac{ex^4}{n[b(t)-x]^2},ex^2\\biggr\\}\\\\ & \\le&\\frac{1+ex^4}{1+n[b(t)-x]^2}.\\end{aligned}\\ ] ] here and in the sequel , @xmath111{\\stackrel{\\mathrm{def}}=}e(y1_b)$ ] .    if @xmath97 and @xmath112 , then , by ( [ edef ] ) and ( [ firstline ] ) , @xmath113 ^ 2}\\biggr).\\end{aligned}\\ ] ] in this case , the second assertion follows by the taylor expansion @xmath114 and because @xmath115 ^ 2}{1+n[b(t+1/n)-x]^2}\\ ] ] is uniformly bounded as @xmath116 is bounded .",
    "if , instead , @xmath117 , but @xmath97 , then @xmath118 ^ 2\\to0 $ ] and @xmath119 ^ 2\\to0 $ ] , and the asymptotic bound holds because @xmath120 .    define @xmath121 the number of times the walk is within distance @xmath122 of the boundary before stopping .",
    "the following result is essentially due to hogan  @xcite .",
    "it slightly improves a bound given in the proof for lemma  1.1 in his paper .",
    "[ lem : edge ] with the assumptions of theorem  [ thm : main ] , there exists a finite constant @xmath123 such that @xmath124 for all @xmath77 and @xmath125 .",
    "also , if @xmath126 then there exists a finite constant @xmath127 such that @xmath128 for all @xmath77 , all @xmath129 and all @xmath130 .    without loss of generality ,",
    "let @xmath122 be a positive integer . by the central limit theorem , @xmath131 for all",
    "@xmath29 sufficiently large , say @xmath132 .",
    "since the @xmath35 are uniformly integrable ( by the second assumption of theorem  [ thm : main ] ) and @xmath133 , we can assume that @xmath134 .",
    "define @xmath135 and let @xmath136 so the @xmath137th time the walk is within @xmath122 of the boundary happens on step @xmath138 .",
    "note that @xmath139 implies the walk is below the boundary at time @xmath140 , that is , @xmath141 which , in turn , implies @xmath142 but @xmath143 is independent of @xmath144 .",
    "so using this bound and ( [ geobound ] ) , @xmath145 iterating this , @xmath146 hence @xmath147\\\\ & = & p(n_d\\ge1)\\biggl[1+\\frac{n_0d^2}{\\gamma}\\biggr].\\end{aligned}\\ ] ] the proof of the bound for @xmath148 is the same .",
    "[ cor : sumbounds ] let @xmath149 , @xmath150 , @xmath77 be constants .",
    "define @xmath151 and let @xmath152 be a non - negative function on @xmath153 $ ] .",
    "if @xmath154 , @xmath155 , and @xmath156 as @xmath157 , @xmath158 as @xmath10 .",
    "if , in addition , @xmath152 is non - decreasing , @xmath159,\\ ] ] where @xmath160 is the constant in lemma  [ lem : edge ] .",
    "when this corollary is used later , @xmath161 will be either @xmath162 or @xmath163 .",
    "when @xmath164 , @xmath165 is zero , and when @xmath166 , @xmath167 .",
    "proof of corollary [ cor : sumbounds ] for the first assertion , for any @xmath125 , @xmath168}g(x).\\ ] ] summing over @xmath169 and bounding the expectation using lemma  [ lem : edge ] , @xmath170}g(x)e\\tau_n,\\ ] ] and the result follows because @xmath122 can be arbitrarily large .    in the second assertion",
    ", we can assume without loss of generality that @xmath152 is right continuous and write @xmath171 by fubini s theorem and lemma  [ lem : edge ] , @xmath172 \\,\\mathrm{d}g(x)\\\\ & = & k\\biggl[g(\\lambda)+2\\int_{-\\infty}^0|x|g(x+\\lambda ) \\,\\mathrm{d}x\\biggr].\\end{aligned}\\ ] ]    the second assertion in corollary  [ cor : sumbounds ] is useless when the integral in the bound diverges , but , in certain cases , it gives sharper results than the first assertion .",
    "the next corollary considers a specific function of interest later .",
    "[ cor : edge ] with the assumptions of theorem  [ thm : main ] , @xmath173 ^ 2 } = \\mathrm{o}(\\log n)\\ ] ] as @xmath10 .",
    "if @xmath174 , @xmath175 ^ 2 } = \\frac{1}{1+n}+\\int\\frac{i\\{b_k - s_k < x<\\sqrt n\\}2x}{(1+x^2)^2 } \\,\\mathrm{d}x,\\ ] ] and so @xmath176 ^ 2 } \\le\\tau_n+\\int_0^{\\sqrt n}\\frac{2xn_x}{(1+x^2)^2 } \\,\\mathrm{d}x.\\ ] ] using lemma  [ lem : edge ] , @xmath173 ^ 2 } = e\\tau_n+\\mathrm{o}(1)\\int_0^{\\sqrt n}\\frac{2x}{1+x^2 } \\,\\mathrm{d}x=\\mathrm{o}(\\log n).\\ ] ]    the final corollary gives uniform integrability for moments of @xmath32 .",
    "[ cor : unifint ] with the assumptions of theorem  [ thm : main ] , if @xmath177 , @xmath178 , @xmath77 , are uniformly integrable .",
    "conditioning on @xmath179 , if @xmath180 , @xmath181 & = & \\sum_{k\\ge0}e[(s_k+x_{k+1}-b_{k+1})^p;k < n\\tau_n , s_k+x_{k+1}-b_{k+1}\\ge",
    "c]\\\\ & = & e\\sum_{k < n\\tau_n}g(s_k - b_{k+1}),\\end{aligned}\\ ] ] where @xmath182.\\ ] ] this function is increasing and right continuous . taking @xmath183 , by fubini s theorem , @xmath184.\\end{aligned}\\ ] ] this expectation tends to zero as @xmath185 by dominated convergence , as does @xmath186 , and uniform integrability follows from the bound in corollary  [ cor : sumbounds ] .    [ thm : f0approx ] under the assumptions of theorem  [ thm : main ] , @xmath187    because @xmath188 by dominated convergence , since @xmath189 almost surely .",
    "so , by donsker s theorem , @xmath190 then , since @xmath79 is uniformly bounded and @xmath35 , @xmath77 are uniformly integrable , @xmath191 the theorem now follows from ( [ telescope ] ) using the formula for @xmath192 in lemma  [ lem : approxe ] and the asymptotic bound in corollary  [ cor : edge ] .",
    "[ thm : r ] under the assumptions of theorem  [ thm : main ] , @xmath193 where @xmath39 is the limiting mean excess defined in ( [ rhodef ] ) .",
    "the proof of this result , like that for theorem  [ thm : f0approx ] , is based on a telescoping sum argument , but now the summands involve functions related to fluctuation theory for random walks . for @xmath194 , define stopping times @xmath195 and define @xmath196-\\rho;&\\quad $ x<0.$ } \\ ] ] conditioning on @xmath88 , for @xmath197 @xmath198 in particular , on @xmath199 , @xmath200=h(s_k - b_k).\\ ] ] now @xmath201,\\ ] ] and by a telescoping sum argument , @xmath202 -\\delta(0)h\\bigl[-\\sqrt nb(0)\\bigr]\\\\ & & \\quad = e\\sum_{k=0}^{n\\tau_n-1}\\biggl[\\delta\\biggl(\\frac{k+1}{n}\\biggr ) h(s_{k+1}-b_{k+1})-\\delta\\biggl(\\frac{k}{n}\\biggr ) h(s_k - b_k)\\biggr]\\\\ & & \\quad = e\\sum_{k=0}^{n\\tau_n-1}\\biggl[\\delta\\biggl(\\frac{k+1}{n}\\biggr ) h(s_{k+1}-b_{k+1})-\\delta\\biggl(\\frac{k}{n}\\biggr ) h(s_{k+1}-b_k)\\biggr],\\end{aligned}\\ ] ] with the last equality from ( [ heqn ] ) , since @xmath203",
    ". the magnitude of the final expectation here is bounded by the sum of @xmath204 and @xmath205 and  [ cor : unifint ] , it is easy to show that  ( [ excessterm1 ] ) tends to zero as @xmath10 . to show that  ( [ excessterm2 ] ) also tends to zero , we need a few results from renewal theory and the fluctuation theory for random walk .",
    "let @xmath206 be i.i.d .",
    "with @xmath207 , the first ascending ladder height for @xmath208 , @xmath2 , and let @xmath209 with @xmath210 .",
    "then @xmath211 and the characteristic function for @xmath212 satisfies cramer s condition .",
    "define @xmath213 so @xmath214 is the renewal measure for the random walk @xmath215 , @xmath150 . by wald s identity , for @xmath197 , @xmath216 so , for @xmath85 and @xmath217 , @xmath218 the following lemma follows immediately from these equations and theorem  3 of stone  @xcite .",
    "[ lem : stone ] as @xmath157 , @xmath219 also , @xmath220 as @xmath157 , uniformly for @xmath85 in any bounded set .    to show that ( [ excessterm2 ] ) is small",
    "we will need the following lemma , similar to lemma  [ lem : edge ] , but bounding the expected number of visits to smaller sets .",
    "[ lem : smallsets ] let @xmath221 be intervals with @xmath222 and @xmath223 for some @xmath224 .",
    "if @xmath225 then @xmath226 as @xmath10 .    for @xmath129 ,",
    "let @xmath227 the contribution to the count in @xmath228 from indices @xmath229 .",
    "then @xmath230}(3\\alpha)$ ] .",
    "by donsker s theorem , @xmath231}(3\\alpha)\\ge1\\bigr ) & \\le&\\limsup_{n\\to\\infty } p\\bigl(w_n(t)\\ge b(t)-k/\\sqrt n,\\mbox { for some } t\\le3\\alpha\\bigr)\\\\ & = & p\\bigl(w(t)\\ge b(t),\\mbox { for some } t\\le3\\alpha\\bigr),\\end{aligned}\\ ] ] which tends to @xmath232 as @xmath233 .",
    "so by lemma  [ lem : edge ] , @xmath234 will be arbitrarily small if @xmath235 is chosen suitably small .",
    "thus this lemma will hold if @xmath236 as @xmath10 for any fixed @xmath129 .",
    "let @xmath237 . by the local limit theorem of stone  @xcite ( or edgeworth expansion ) , for some  @xmath238 , @xmath239 for all @xmath240 , @xmath77 and @xmath2 . if @xmath241 , @xmath242 , @xmath243 and @xmath244 , then @xmath245 together , these imply @xmath246 thus , if @xmath29 is large enough that @xmath247 and if @xmath248 , @xmath249 \\\\[-8pt ] \\nonumber & & \\quad\\le p\\bigl(b_k - s_k\\in i_k , n\\tau_n\\ge k/3 , s_k - s_j>-k-\\vert b'\\vert_\\infty,0<k - j<\\sqrt n\\bigr).\\end{aligned}\\ ] ] to use this bound , let @xmath250 writing @xmath251 since @xmath252 is @xmath253 measurable and @xmath254 by ( [ local ] ) , @xmath255 since events @xmath256 and @xmath257 are independent and both lie in @xmath253 , using ( [ smallsetbound ] ) and conditioning on @xmath253 , @xmath258 the second probability in this bound tends to zero , and so @xmath259 proving the lemma .",
    "proof of theorem  [ thm : r ] from the discussion and bounds above , the desired result will hold if  ( [ excessterm2 ] ) tends to zero , or if @xmath260 the expectation of the final term in the sum tends to zero , for if @xmath261 , the summand is @xmath262 ; and if @xmath263 , @xmath264 is within some multiple of @xmath30 of zero and the expectation will tend to zero by lemma  [ lem : smallsets ] .",
    "so if @xmath265 and @xmath266 , we need to show that @xmath267 using lemma  [ lem : stone ] , for some constant @xmath238 , @xmath268 for all @xmath197 and all @xmath269 $ ] , where @xmath270 . using this , @xmath271 by corollary  [ cor : sumbounds ] , @xmath272\\\\ & = & k\\biggl[\\frac{e(y+\\lambda)_+}{ey}+\\frac{e(y+\\lambda)^3}{3ey}\\biggr],\\end{aligned}\\ ] ] which is finite since @xmath211 .",
    "and by the same corollary , @xmath273\\\\ & = & k\\biggl[k_1^{-1/2}+\\frac43k_1^{-3/2}+k_1^{-5/2}\\biggr].\\end{aligned}\\ ] ] since this bound tends to zero as @xmath274 , the theorem will hold if @xmath275 converges to zero for any fixed @xmath276 .",
    "also , using lemma  [ lem : smallsets ] , we can include the restriction @xmath277 in the indicator . using ( [ hdiff ] )",
    ", it will then be sufficient to show @xmath278 and @xmath279)i\\biggl\\{\\frac{\\vert b'\\vert_\\infty}{\\sqrt n } < b_k - s_k < k_1\\biggr\\}\\to0.\\ ] ] the first of these follows immediately from lemma  [ lem : edge ] .",
    "using fubini s theorem , the second expression equals @xmath280 by lemma  [ lem : smallsets ] , the integrand here tends to zero , uniformly in @xmath44 .",
    "since the range of integration remains bounded , the integral must tend to zero , proving the theorem .",
    "i would like to thank the referee for a careful reading of this paper and several useful suggestions . supported in part by nsa grant f012499 and nsf grant 0706771 ."
  ],
  "abstract_text": [
    "<S> donsker s theorem shows that random walks behave like brownian motion in an asymptotic sense . </S>",
    "<S> this result can be used to approximate expectations associated with the time and location of a random walk when it first crosses a nonlinear boundary . in this </S>",
    "<S> paper , correction terms are derived to improve the accuracy of these approximations . </S>"
  ]
}