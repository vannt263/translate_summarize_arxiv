{
  "article_text": [
    "the discovery of extrasolar planets is at the origin of a renewed interest in stellar coronagraphy . considering the ambition of the targeted objectives ,",
    "many authors have pointed out the necessity for a very accurate analysis of the system in order to study various undesired effects .",
    "for example , the specific properties of the light intensity measured by a system based on an extreme adaptive optics system and a coronagraph are the result that neither the residuals of the turbulence , nor the ideal coronagraphed point - spread function can be neglected with respect to the faint object ( planet ) .",
    "@xcite analyzed the fact that the wavefront amplitudes associated to these two contributions will interfere leading to the so - called `` pinned '' speckles .",
    "another example is given by @xcite which pointed out that a small misalignment of the star with the center of the stop can result in a fake source .",
    "a related problem is also present in @xcite wich derives the optimal apodization for an arbitrary shaped aperture using an algorithm proposed independently in @xcite which relies on iterated simulations of the coronagraph response .",
    "more generally , an intense activity aims to optimize the different coronagraph parameters ( mask size , apodization shape , ... ) for a number of projects dedicated to devise high - dynamic range imaging on the vlt ( sphere ) , gemini ( gpi ) or the subaru telescope ( hiciao ) , see for example @xcite .",
    "the input / output relation of a coronagraph is in this case simulated by numerical computations based on discrete fourier transforms .",
    "however , such a numerical technique suffers from the well - known problems related to the choice of the extent of the sampled surface and the sampling frequency which both define the sampling in the transformed domain .",
    "note that this compromise is coupled with the difficulty to evaluate numerically the simulation errors .",
    "this work focuses on the analytical characterization of the response of a lyot coronagraph .",
    "the objective is obviously also to gain deeper insight in the behaviour of the system .",
    "this problem has already been studied in the literature and analytical results were obtained under various assumptions . in the one - dimensional case , @xcite assume that the lyot stop is band limited and the phase on the telescope aperture is small .",
    "this last hypothesis is removed in @xcite where the computation is carried for a rectangular pupil assuming again that the lyot stop is band - limited .",
    "the development presented herein for a circular pupil differs from these approaches substituting these simplifying assumptions by an expansion of the complex amplitude on an orthogonal basis .",
    "section 1 recalls the general formalism of lyot coronagraphy and justifies the choice of an expansion of the complex amplitude on a zernike base .",
    "section 2 contains the main results of the paper ; the response of the coronagraph to a zernike polynomial is computed .",
    "the result involving an infinite sum , a bound on the truncation error is then derived .",
    "section 3 presents two simulations .",
    "first the response of the coronagraph to the 6 first zernike functions is computed .",
    "then the formalism derived in this paper is used to illustrate the effect of a tip - tilt error in a coronagraph . a short appendix containing the material required for the mathematical derivations of section 2 is included at the end of the paper .",
    "we follow the notations of @xcite and @xcite .",
    "the successive planes of the coronagraph are denoted by @xmath0 , @xmath1 , @xmath2 and @xmath3 .",
    "@xmath0 is the entrance aperture , @xmath1 denotes the focal plane with the mask ( without loss of generality we assume that the amplitude of the mask is @xmath4 where @xmath5 corresponds to the classical lyot coronagraph and @xmath6 to the roddier coronagraph ) , @xmath2 is the image of the aperture with the lyot stop and @xmath3 is the image in the focal plane after the coronagraph .",
    "the aperture transmission function is @xmath7 and the wavefront complex amplitude in @xmath0 is @xmath8 . in the case of an apodized pupil , we assume that the apodization function is included in @xmath8 . in order to simplify the notations , the mask function in @xmath1",
    "is defined with coordinates proportional to @xmath9 and decomposed as : @xmath10 where function @xmath11 equals to 1 inside the coronagraphic mask and 0 outside .",
    "we will make in the sequel the usual approximations of paraxial optics .",
    "moreover we neglect the quadratic phase terms associated with the propagation of the waves or assume that the optical layout is properly designed to cancel it @xcite .",
    "the expression in cartesian coordinates of the complex amplitude in the successive planes are : @xmath12 \\left(x , y\\right ) \\right)p(-x ,- y )   \\label{geneplanc}\\\\ \\psi_d(x , y ) & = & \\frac{-1}{\\jmath \\lambda f }     \\widehat{\\psi_a}\\left(\\frac{- x}{\\lambda f},\\frac{- y}{\\lambda f}\\right ) \\nonumber\\\\   & & \\qquad   + \\epsilon   \\frac{1}{\\jmath \\lambda f }     \\left (   \\widehat{\\psi_a}(-x ,- y)m(-x ,- y )   \\ast    \\widehat{p}(-x ,- y )",
    "\\right )   \\left(\\frac",
    "{ x}{\\lambda f},\\frac { y}{\\lambda f}\\right ) \\label{genepland }   \\end{aligned}\\ ] ] where @xmath13 is the fourier transform of @xmath14 and @xmath15 denotes convolution . eqs .",
    "( [ geneplanc],[genepland ] ) assume that the lyot stop is the same as the pupil .",
    "however for classical `` unapodized '' lyot coronagraph the residual intensity in plane @xmath2 is concentrated at the edges of the pupil and a reduction of the lyot stop size is needed in order to improve the rejection .",
    "the case of a reduced lyot stop , which consists in convolving eq .",
    "( [ genepland ] ) by the appropriate function , has not been considered in eqs .",
    "( [ geneplanc],[genepland ] ) to alleviate the notations but will be discussed in section 3 .",
    "it is important to note that the reduction of the lyot stop can be avoided using a prolate apodized entrance pupil which will optimally concentrate the residual amplitude in @xmath2 , see for example @xcite .    the coronagraph response being derived herein for a circular pupil , the use of polar coordinates will be preferred .",
    "transcription of previous equations to polar coordinates is straightforward .",
    "moreover , as long as the aperture transmission function and the stop have a circular symmetry , their fourier transform will verify the same symmetry , as proved by eq .",
    "( [ hankelgeneral ] ) with @xmath16 , i.e. the hankel transform .",
    "this leads to the following expression of the complex amplitude in  @xmath3 : @xmath17 where the convolution of the two functions is still computed with respect to to the cartesian coordinates @xmath18 .",
    "as mentioned in the introduction , the analytical computation of the coronagraph response proposed herein relies on the expansion of the complex amplitude in @xmath0 on an orthogonal basis .",
    "( [ ampcompd ] ) shows that the coronagraph _ acts linearly _ on the complex amplitude , consequently the problems simplifies to the computation of the response of each basis function .",
    "the retained solution consists in the expansion of the complex amplitude in @xmath0 on zernike polynomials .",
    "basic properties of the zernike polynomials required in the paper are recalled in appendix [ appenda ] .    adopting the usual ordering of the zernike circle polynomial @xcite we can write : @xmath19 where @xmath20 is the radius of the aperture .",
    "this expansion is rather unusual , the zernike polynomials being generally used for the expansion of the wavefront .",
    "however it is worthy to note that , as eq .",
    "( [ geneplanc ] ) shows , a coronagraphic system will always introduce amplitude aberration .",
    "hence , even in the case of a perfect wave with no aberration in @xmath0 , an expansion of only the phase in @xmath2 will not be appropriate .",
    "finally , eq .  ( [ expana ] ) can also be justified by the fact that it coincides ( up to a linear transform ) with the classical approximation of the complex amplitude in the case of sufficiently small phase errors assuming a first order development of the exponential function .",
    "we will illustrate the expansion ( [ expana ] ) in the case of tip - tilt error with an apodized pupil : @xmath21 where @xmath22 denotes the pupil apodization and @xmath23 for @xmath24 and @xmath25 if @xmath26 . computation of the projection of @xmath27 on @xmath28 is straightforward using the definition of the bessel functions of integer order @xcite : @xmath29 the projection of @xmath27 on @xmath30 equals 0 .    * in the unapodized case , @xmath31 , integral in eq .",
    "( [ apotilt ] ) can be computed using eq .",
    "( [ intbesselradial ] ) : @xmath32 the coefficient @xmath33 is then obtained dividing this quantity by the @xmath34 norm of the zernike polynomials @xcite , leading to : @xmath35 * a particularly important case is that where @xmath22 is proportional to the circular prolate function @xmath36 , @xcite . in this case",
    "the integral in eq .",
    "( [ apotilt ] ) can be computed using the expansion of @xmath37 derived in @xcite : @xmath38 the function @xmath39 defined in eq .",
    "( [ hyperg ] ) reduces to a polynomial of order @xmath40 which , as mentioned in @xcite `` is closely related to the zernike polynomials '' . indeed using eq .",
    "( [ zernger ] ) and the results below it can be easily checked that : @xmath41 . inserting this expansion in eq .",
    "( [ apotilt ] ) and integrating terms by terms leads to integrals which generalize eq .",
    "( [ intbesselradial ] ) .",
    "these integrals can be computed for example using of integrals of the type @xmath42 @xcite .",
    "this derivation will not be presented herein for sake of brevity .    finally , for more complicated complex amplitudes , the @xmath43 can be of course computed numerically .",
    "this problem as been addressed in @xcite using a piecewise approximation of @xmath44 over a lattice of squares with size @xmath45 and centered on point @xmath46 . in this case",
    "the estimation of @xmath47 is given by : @xmath48 where @xmath49 is the integral of the zernike polynomial @xmath50 over the square centered on @xmath46 .",
    "@xcite gives bound for the mean integrated squared error on the reconstruction of @xmath44 when the coefficients are given by eq .",
    "( [ eqpawl ] ) .",
    "this analysis is particularly important in our case because it quantifies the dependence of the error on the smoothness of @xmath44 , the sampling rate @xmath51 and the geometrical error due to the circular geometry of the pupil .",
    "the purpose of this section is to compute the complex amplitude in @xmath3 when the complex amplitude in @xmath0 is the zernike polynomial with radial degree @xmath52 and azimuthal frequency @xmath53 . in this case",
    "the complex amplitude @xmath54 will be denoted as @xmath55 . according to eq .",
    "( [ ampcompd ] ) , the difficulty in the computation of @xmath55 lies in the evaluation of the convolution : @xmath56 in this expression @xmath57 is an `` annular '' mask of radius @xmath58 which , with the definition adopted in eq .",
    "( [ planccart ] ) is defined as : @xmath59    the computation of the convolution in @xmath60 is sketched in fig .",
    "[ compconv ] . using eq .",
    "( [ themask ] ) , @xmath60 simplifies to : @xmath61 the next step consists in substituting in this equation :    * @xmath62 by the fourier transform of @xmath63 : @xmath64 * @xmath65 by @xmath50 and consequently @xmath66 by @xmath67 where @xmath68 is given in eq .",
    "( [ fourier1zern ] ) .    in order to simplify the notations we define the new `` standardized '' integral @xmath69 by : @xmath70 it can be easily checked in this case that : @xmath71    analytical computation of @xmath69 relies on the properties of the gegenbauer polynomials defined in appendix [ appenda ] . substituting eq .",
    "( [ eqgegen ] ) for @xmath72 in eq .",
    "( [ convol2 ] ) allows indeed to separate the integrations with respect to @xmath73 and @xmath74 : @xmath75    * computation of the integral on @xmath74 is straightforward using ( [ cheby ] ) : @xmath76 * computation of the integral on @xmath73 relies on recursion formulas on indefinite integrals of products of bessel functions , @xcite : @xmath77    after computation of the integral of eq .",
    "( [ convol3 ] ) , substitution of eq .",
    "( [ xixitild ] ) in eq .",
    "( [ ampcompd ] ) gives the complex amplitude in @xmath3 for a single basis function @xmath78 : @xmath79 with @xmath80 and : @xmath81    the corresponding complex amplitude in @xmath2 for @xmath82 can be directly computed from eq .",
    "( [ leresultat ] ) using the inverse fourier transform of @xmath83 obtained in eq .",
    "( [ zernger ] ) : @xmath84    eqs .",
    "( [ leresultat],[leresultat2 ] ) give an analytical expression of the complex amplitude in @xmath2 for @xmath82 and in @xmath3 when a single basis function is applied in @xmath0 and when the size of the lyot stop equals the size of the entrance pupil . in the general where the amplitude in @xmath0 is given by eqs .",
    "( [ expana0],[expana ] ) , the complex amplitudes in @xmath2 and @xmath3 become : @xmath85    as mentioned in section 2.1 , if the entrance pupil is not apodized a reduction of the lyot stop must be considered .",
    "this is achieved replacing @xmath86 by @xmath87 with @xmath88 .",
    "the expression of the complex amplitude in @xmath2 is of course straightforward and for example eq .  ( [ leresultat2 ] ) becomes @xmath89 .",
    "this result allows numerical computation of the complex amplitude in @xmath3 using a single fourier transform .",
    "unfortunately it is much more complicated to obtain an analytical expression of the complex amplitude in @xmath3 .",
    "the derivation presented above can be of course redeveloped replacing @xmath90 by @xmath91 and straightforward computation shows that :    1 .",
    "similarly to eq .",
    "( [ leresultat ] ) , the convolution ( [ convol1 ] ) will expand in an infinite sum of functions @xmath92 .",
    "however , the `` radial contribution '' to the coefficients weighting these functions , see eq .",
    "( [ defeta ] ) , becomes : @xmath93 which can not be computed straightforwardly as in eqs .",
    "( [ int1],[int2 ] ) .",
    "2 .   the first term in eq .  ( [ ampcompd ] )",
    "is now replaced by the fourier transform of @xmath94 which can not be anymore calculated using eq .",
    "( [ intbesselradial ] ) .",
    "as we are interested in the computation of @xmath95 or @xmath55 from the implementation of formula ( [ leresultat ] ) , the errors produced when the infinite sum is truncated must be studied . in order to reduce mathematical developments we only present herein the results for @xmath55 when the size of the lyot stop equals the size of the pupil .",
    "we define the truncation error on @xmath55 : @xmath96    computation of a bound on the truncation error relies on the classical upper bound for the bessel functions of integer order @xcite : @xmath97 substitution of this result in eq .",
    "( [ defeta ] ) gives : @xmath98 which leads to the following bound for the truncation error : @xmath99    the above serie is absolutely convergent for @xmath100 . as a consequence the expansion in eq .",
    "( [ leresultat ] ) converges uniformly for @xmath101 .",
    "finally , it is worthy to note that the computation of the infinite sum in the upper bound ( [ laborne ] ) can be avoided using the equality : @xmath102 where @xmath103 is the modified bessel function .",
    "figures [ figresu1 ] and [ figresu2 ] give the intensity in the @xmath3 plane of the coronagraph when the complex amplitude in the @xmath0 plane is one of the first six zernike polynomials .",
    "the complex amplitudes have been computed using eq .",
    "( [ leresultat ] ) .",
    "each raw contains @xmath104 and @xmath55 for a given couple @xmath105 .",
    "these plots have been obtained truncating the infinite summation of eq .",
    "( [ leresultat ] ) to the first 40 terms .",
    "the relevance of the truncation error bound is verified in fig .",
    "[ plotbound ] .",
    "this plot shows the error bound ( [ laborne ] ) as a function of @xmath106 for the parameters used in figs .",
    "[ figresu1 ] and [ figresu2 ] .",
    "the increase of the bound with @xmath106 is simply due to the fact that the majoration of @xmath107 given by eq .",
    "( [ majorbess ] ) is only relevant for small values of @xmath106 as long as @xmath107 is bounded on @xmath108 .",
    "it is important to note that this plot justifies , at least for this configuration , the validity of a truncation to @xmath109 for the computation of @xmath55 . in this case",
    "the truncation error is in fact always less than @xmath110 .",
    "the effects of a tip - tilt error in lyot coronagraphs has been extensively studied by @xcite and @xcite .",
    "the scope of the simulation presented here is only to validate the results derived in section 2 simulating the particular case where there is a misalignment of the star with the center of the stop .",
    "according to the previous notations the complex amplitude in @xmath3 decomposes as eq .",
    "( [ repcomplete ] ) . in the case of a tip - tilt error in @xmath0 ,",
    "the values of the coefficients @xmath111 are given by eq .",
    "( [ amntilt ] ) .",
    "[ plottilt ] shows @xmath112 for different values of @xmath113 ( the case @xmath114 is given in the first row of fig .",
    "[ figresu1 ] ) .",
    "the truncation in the summation ( [ repcomplete ] ) has been chosen taking into account that eq .",
    "( [ amntilt ] ) implies : @xmath115 note that according to the notations of eq .",
    "( [ expana ] ) , @xmath116 equals eq .",
    "( [ airy ] ) shifted of @xmath117 on axis @xmath118 .",
    "consequently , the star is behind the focal stop in the first two images and outside in the last one .",
    "in this paper we have presented a theoretical formalism for the analytical study of the lyot coronagraph response .",
    "the main purposes of this work are of course to assist coronagraph design but also to improve data processing performances for the detection and characterization of extrasolar planets .    *",
    "the first application is the computation of the response of the coronagraph to a planet at a given position .",
    "this is achieved for example in the case of a classical lyot coronagraph using eqs .",
    "( [ repcomplete],[amntilt ] ) .",
    "this point is essential for the derivation of an optimal decision scheme to test the presence of a planet at a given location .",
    "* this formalism can also be applied to fully characterize the statistical properties of the complex amplitude in the @xmath3 plane . for a given spatial covariance in @xmath0 which is fixed through the covariance of coefficients @xmath43 , the spatial covariance in @xmath3",
    "becomes : @xmath119 =    \\sum_{k , l } \\mathsf{cov}[a_k , a_l ]   \\mathcal{d}_k(r,\\theta )   \\mathcal{d}_l(r',\\theta')\\ ] ] + although detection algorithms based solely on the marginal distribution of the complex amplitude can be developed as in @xcite , the use of an accurate model for the spatial correlation of the complex amplitude is essential in order to derive detection algorithms with optimal performances , as demonstrated in @xcite .",
    "the author thanks the anonymous referee who helped improve the paper .",
    "the author is also grateful to claude aime and rmi soummer for helpful discussions and insightful comments .",
    "this section presents some facts about fourier transform in polar coordinates , zernike and gegenbauer polynomials .    among the various available possibilities to define an orthogonal set of functions on the unit radius disk a central position is hold by the zernike polynomials ,",
    "see for example @xcite and included references .",
    "they are defined for @xmath120 by : @xmath121 when @xmath52 et @xmath53 share the same parity .",
    "the @xmath122 are the radial polynomials .",
    "different normalizations exist for @xmath122 , we retain herein the definition of @xcite : @xmath123 . among many properties verified by these polynomials , we focus on : @xmath124 see (",
    "* appendix vii ) for the proof .",
    "this equality allows straightforward computation of the fourier transform of the zernike polynomials .",
    "in fact recall first that when @xmath125 , @xmath126 , a simple change of variables in the fourier transform integral leads to : @xmath127 an analog result for the inverse fourier transform of @xmath128 is : @xmath129      the previous equation gives the inverse fourier transform of @xmath131 when @xmath132 and @xmath52 et @xmath53 share the same parity . in the general case where @xmath133 and @xmath134 this inverse fourier transform , denoted as @xmath135 must be computed independently .",
    "if we subsitute @xmath136 by @xmath137 in eq .",
    "( [ hankelinvgeneral ] ) the resulting integral is a weber - schafheitlin type integral @xcite .",
    "this results in @xmath138 where : @xmath139 @xmath140 is the gauss hypergeometric function , see @xcite : @xmath141 it is interesting to note from eqs .",
    "( [ zernger ] ) and ( [ hyperg ] ) that if @xmath142 the sum in eq .",
    "( @xmath143 ) reduces to a polynom in @xmath144 of order @xmath145 .",
    "consequently @xmath146 reduces to a polynom with degree @xmath52 which of course coincides up to @xmath147 with @xmath122 for @xmath148 . for this reason",
    "@xmath146 can be considered as a natural generalization of the zernike polynomials .",
    "note that , contrarily to the generalization proposed in @xcite or @xcite , this generalization is not a polynomial .    we now briefly give the principal results related to the gegenbauer polynomials .",
    "see for example @xcite or @xcite for detailed properties .",
    "the gegenbauer ( or ultraspherical ) polynomials , noted as @xmath149 are defined as the coefficients of the power series expansion of @xmath150 : @xmath151 for example @xmath152 gives the chebyshev polynomial of the second kind @xmath153 : @xmath154                                                 and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu1],title=\"fig : \" ] +   and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu1],title=\"fig : \" ] +   and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu1],title=\"fig : \" ] +     and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu2],title=\"fig : \" ] +   and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu2],title=\"fig : \" ] +   and squared root of the amplitude in @xmath3 , i.e. @xmath157 . the parameters used in the simulation are : @xmath158 , @xmath159 , @xmath160 , @xmath161 ( lyot coronagraph ) .",
    "[ figresu2],title=\"fig : \" ] +       for different values of @xmath163 .",
    "the parameters are the same as the parameters used for figs .",
    "[ figresu1 ] and [ figresu2 ] .",
    "[ plottilt],title=\"fig : \" ] for different values of @xmath163 .",
    "the parameters are the same as the parameters used for figs .",
    "[ figresu1 ] and [ figresu2 ] .",
    "[ plottilt],title=\"fig : \" ] +   for different values of @xmath163 .",
    "the parameters are the same as the parameters used for figs .",
    "[ figresu1 ] and [ figresu2 ] .",
    "[ plottilt],title=\"fig : \" ] for different values of @xmath163 .",
    "the parameters are the same as the parameters used for figs .",
    "[ figresu1 ] and [ figresu2 ] .",
    "[ plottilt],title=\"fig : \" ]"
  ],
  "abstract_text": [
    "<S> we derive an analytical solution to the computation of the output of a lyot coronagraph for a given complex amplitude on the pupil plane . </S>",
    "<S> this solution , which does not require any simplifying assumption , relies on an expansion of the entrance complex amplitude on a zernike base . according to this framework , </S>",
    "<S> the main contribution of the paper is the expression of the response of the coronagraph to a single base function . </S>",
    "<S> this result is illustrated by a computer simulation which describes the classical effect of propagation of a tip - tilt error in a coronagraph . </S>"
  ]
}