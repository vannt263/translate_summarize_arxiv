{
  "article_text": [
    "_ medical image registration _ is an active area in the field of image processing with applications ranging from image mosaicing in retinal images @xcite to slice interpolation @xcite etc .",
    "image registration problems can be categorized into four major categories : _ multi - view analysis , multi - temporal analysis , multi - modal analysis _ and _ scene to model registration _ @xcite . generally speaking , having two images , _ reference _ ( re ) and _ template _ ( te ) , the image registration problem is to find a _ valid _ and _ optimal _ spatial or geometrical transformation between the two input images . in the process ,",
    "the pixel values of template image wo nt change and only the locations will be altered .",
    "being more focused on the implementation aspects of image registration , two major classes of methods can be considered : _ parametric _ and _ non - parametric _ image registration methods @xcite .",
    "parametric registration methods are based on a finite set of parameters or image features .",
    "these methods include rigid registration , affine registration , land - mark based registration , principal axes - based registration , fft - based registration , optimal linear registration and spline registration .",
    "unlike parametric registration methods , the non - parametric methods are not limited to a finite set of parameters .",
    "diffusion registration , fluid registration , curvature registration and elastic registration @xcite are a few examples of this class of methods .    in general , image registration is considered as an _ ill - posed inverse problem_. therefore the process of solving this problem consists of three component @xcite : 1 ) a deformation model , 2 ) an objective function to be optimized and 3 ) an optimization method .",
    "a general objective function can be defined as : @xmath0=d[re , te \\circ u]+\\alpha s[u]\\ ] ] the left hand side of the equation is the energy or objective function which needs to be optimized ; @xmath1 is the displacement field . on the right",
    ", we have two terms : @xmath2 and @xmath3 .",
    "the first term is called _",
    "( dis)similarity measure _ or _ distance measure _ which acts as the matching criterion between the reference image and the deformed template image , @xmath1 being the displacement field . depending on the choice of this term , the objective function needs to be either minimized or maximized .",
    "some common examples of the distance or similarity measure are mutual information ( mi ) , normalized mi ( nmi ) , cross - correlation ( cc ) , normalized cc , sum of squared differences ( ssd ) etc . which are widely used in the literature in this area @xcite . the second term",
    ", @xmath3 is the _ regularization term _ which imposes additional constraints on the deformation . due to ill - posedness of image registration",
    ", this term is needed to be able to have reasonable transformations .",
    "this term dictates the validness of transformation .",
    "the parameter @xmath4 is a weight which indicates the amount of regularization .",
    "other than the obvious way of assessing an image registration method which is the similarity of the final deformed template image to the reference image , the computational complexity of the method is also a major factor .",
    "this becomes more important in case of non - rigid image deformation methods in which the deformation is local rather than global .",
    "the main reason for this is due to the size of the images , which results in a very big number of degrees of freedom in the optimization process .",
    "this is more obvious in case of non - parametric image registration techniques .",
    "one obvious solution to remedy this problem is using computers with higher computational power . using parallel processors such as graphics processing units ( gpus )",
    "is an example which has been widely considered in the past few years @xcite .    from an algorithmic point of view , using multi - resolution techniques can also be considered @xcite which start from a very coarse grid to capture the larger deformations in the images to be registered and then move to much finer grids to capture the smaller deformations .",
    "usually , this is done on a uniform square grid which means that the sampling will take place uniformly . in other words , even though the objects and image features are scattered randomly in the images to be registered , multi - resolution based methods do not take this fact into consideration .",
    "adaptive griding using octrees has been used to address this issue @xcite .",
    "however , square grids can not accurately match feature boundaries that are typically curvilinear .",
    "using triangular meshes enables better representation of curvilinear image feature boundaries .",
    "this representation also allows for easy reconstruction of final results as well as the computation of the final optimized displacement .",
    "furthermore , content - based adaptive meshing greatly reduces the computational complexity of the registration process .",
    "of course , this will have its own implications for optimizing the energy functional of the method which will be discussed more in later sections .",
    "there have been a few previous works in this area , usually considering the problem of image registration as a _ finite element method _ ( fem ) problem @xcite .",
    "but they usually need additional information about the physical properties of the underlying structure .",
    "also the process is not completely mesh based . in @xcite",
    "each update of the displacement field in each iteration is followed by a re - sampling to the regular image grid , computational procedures to find the update terms for the next update and then re - sampling again to the mesh triangular grid .    in this paper ,",
    "a new mesh based image registration technique will be introduced which takes advantage of mesh - based operators without the need to switch between regular image grid and triangular mesh grid . taking the reference and template images as the inputs and some needed parameters",
    ", the proposed method can achieve excellent accuracy and higher speed compared to regular pixel - based registration methods .",
    "even though a uniform initial mesh can be considered , an initial mesh is created for the template image using a content adaptive mesh generation method which perfectly matches the image s edges and features .",
    "the energy functional is minimized next and the final displacement field is reconstructed .",
    "finally , msd will be used in order to assess the performance of our registration technique .",
    "the paper is organized as follows : section 2 contains comprehensive details about the proposed method .",
    "results and discussions are provided in section 3 .",
    "section 4 concludes the paper .",
    "taking the general notation as most of the papers in this field , assuming _ template _ ( _ te _ ) and _ reference _ ( _ re _ ) images as inputs , the goal of image registration is to find a valid and optimal geometrical transformation to be applied on _ te _ to become more similar to _ re _ according to some similarity measure .",
    "therefore , the process can be formulated as an optimization problem which tries to optimize some energy functional that can be defined as in ( 1 ) . due to the random distribution of image features",
    ", we propose to use a sparser representation of both input images using a content adaptive mesh generator such as the one described in @xcite .",
    "assume @xmath5 and @xmath6 as input images with the same size , and a set of triangles defined on the template image represented by @xmath7 , where @xmath8 is a @xmath9 matrix containing the coordinates of @xmath10 mesh nodes or vertices and @xmath11 is a @xmath12 matrix , each line containing the indexes of nodes creating each one of the @xmath13 triangles .",
    "note that @xmath14 represents a vector with constant values which only the locations of its values change in the process of optimization .",
    "@xmath6 represents a continuous domain of @xmath15 , hence @xmath16 .",
    "also , it should be mentioned that the set of triangles covers the template image domain @xmath17 . here",
    "a slightly different approach will be considered in which instead of applying the smoothing at the same time as update of the displacement filed , this will be done after each iteration using a diffusion process which will be described later in more details .",
    "the energy functional is therefore define as follows : @xmath18=d[re(x)|_{x = v+u } , te(v)\\circ u(v)]\\ ] ] where @xmath19 and @xmath2 represent the energy functional and the distance measure respectively .",
    "also , the @xmath20 operator is defined as : @xmath21    for simplicity of representation , and since it is obvious that the method is applied to mesh nodes , from now on , the notation of a function @xmath22 of variable @xmath8 which has a general form of @xmath23 will be reduced to just @xmath22 . as mentioned before",
    ", several distance or similarity measures can be found in the literature , each having its pros and cons and being suitable for different problems encountered in the image registration . here",
    ", the sum of squared differences ( ssd ) is used which can be defined as follows : @xmath24 where the last summation is computed over all of the mesh nodes . minimizing the energy functional and updation of the displacement field",
    "can be done considering a gradient descent approach : @xmath25\\ ] ] where @xmath26 is the step size ( here 0.005 ) and @xmath27 is the gradient operator with respect to variable @xmath28 .",
    "the gradient of the energy functional is computed by taking the gateaux derivative of the distance measure which results in : @xmath29=\\bigtriangledown _ { u_1^k } d \\hspace{50 mm } \\\\=(te(v+u_1^k)-re(x)|_{x = v+u}).\\bigtriangledown _ { u_1^k } te(v+u_1^k ) \\end{split}\\ ] ] where @xmath30 needs to be computed on mesh nodes .",
    "further explanation will be given in section 2.1 .",
    "the reason behind using two different subscripts ( 0 an 1 ) in ( 5 ) is because of the fact that this displacement function needs to be smoothed to ensure regularized displacements in the image domain .",
    "for smoothing the displacements on the mesh , a diffusion process needs to be solved on the mesh nodes .",
    "this diffusion process can be modeled as follows : @xmath31 where @xmath32 represents the laplacian operator on mesh nodes .",
    "this diffusion process is solved using a forward difference time - stepping approach . without loss of generality and to reduce the confusion with the gradient descent method s step size , here the time step will be considered as 1 .",
    "hence from ( 7 ) : @xmath33 where @xmath34 is the smoothing parameter defined by the user ( here 0.8 ) . further simplification will be done in section 2.3 .",
    "consider node @xmath35 and its 1-ring ( @xmath36 ) neighbor nodes .",
    "approximation of the gradient of a function @xmath22 on the location of node @xmath35 can be achieved using linear interpolation of the function @xmath22 over the surface created by this region .",
    "assuming triangle @xmath37 created by nodes @xmath38 $ ] as one of the triangles surrounding @xmath35 , the approximation of the gradient on @xmath37 will be : @xmath39\\\\ + f_j [ ( \\overrightarrow{v_{ji } } , \\overrightarrow{v_{ik}})(v_k - v_j ) + ( \\overrightarrow{v_{jk } } , \\overrightarrow{v_{ki}})(v_i - v_j)]\\\\ + f_k [ ( \\overrightarrow{v_{kj } } , \\overrightarrow{v_{ji}})(v_i - v_k ) + ( \\overrightarrow{v_{ki } } , \\overrightarrow{v_{ij}})(v_j - v_k ) ] \\bigg ) \\end{split}\\ ] ] where @xmath40 is the function value on node @xmath35 , @xmath41 is the area of the triangle @xmath37 , @xmath42 is the vector connecting nodes @xmath43 and @xmath44 and @xmath45 gives the _ dot _ product of vectors @xmath46 and @xmath47 .",
    "having the approximation of the gradient on surrounding triangles , the approximate gradient for node @xmath35 can be computed as follows : @xmath48 where @xmath49 . for a complete analysis on the approximation error the reader",
    "is referred to @xcite .",
    "the areas of triangles should be computed at the beginning of each iteration .",
    "taking the same approach as @xcite , the laplacian operator on a mesh can be approximated by the so - called _ umbrella _ operator on each node as follows : @xmath50 where @xmath51 is the valence ( number of 1-ring neighbors ) of node @xmath35 .",
    "this operator can be defined in a matrix form as follows : @xmath52 where @xmath53 is the identity matrix and @xmath54 is a sparse @xmath55 matrix which its non - zero elements are defined as follows : @xmath56    considering ( 8) and ( 13 ) together with a few manipulations , the diffusion process can be simplified as a weighted average of the displacements of the 1-ring neighborhood of each node : @xmath57    the above equation can be applied iteratively for further smoothness of the displacement field on the mesh nodes . here , only one iteration of smoothing is applied . the overall algorithm for mesh - based registration",
    "is illustrated in algorithm 1 .",
    "* inputs * : @xmath6 , @xmath5 , @xmath7 defined on the template image , @xmath58 , @xmath59 ; + * pre - computation * : @xmath36 and neighbor triangles for each mesh node , @xmath54 ; +   + for @xmath60 +    \\ {    * _ update _ : * * @xmath61=d(re(x)|_{x = v+u } , te\\circ u ) $ ] * * @xmath62 $ ] * * @xmath63 $ ] * _ smoothing _ : * * @xmath64    }",
    "for generating the content adaptive mesh needed for our algorithm , the method proposed by ming et al .",
    "@xcite is used .",
    "based on the discussion given in this paper , the main difference between various mesh generating methods rises from different methods used for node placement . in some ,",
    "the nodes are placed based on feature points in images , while in others , this process is done iteratively , either starting from a coarse mesh and adding new nodes or starting from a dense mesh and removing redundant nodes .",
    "the method consists of several steps as follows :    1 .",
    "node generation : * canny sample points ; * halftoning sample points ; * uniform sample points . 2 .",
    "mesh generation via delaunay triangulation ; 3 .",
    "image - based mesh smoothing : * image - based centroid voronoi tessellations ( cvt ) mesh smoothing ; * image - based optimal delaunay triangulations ( odt ) mesh smoothing ; * edge flipping .",
    "the result of this method is a high quality content adapted triangular mesh which is matched accurately with image features and edges .",
    "1 displays an example of content adapted mesh generated for a brain cross - section .",
    "image registration results using the proposed method is given in the following sections .",
    "[ b]0.35     [ b]0.35       for the first example , a pair of brain images are considered which are displayed in fig .",
    "comparing the reference and template images reveals a rigid transformation as well as a non - rigid transformation in the center between the two . using a content adapted mesh with 5406 nodes and 10744 triangles ,",
    "the registration is done .",
    "the average time for each iteration is about 156 ms for these images .",
    "the computed displacement fields as well as the registered image and the difference image after registration can be seen in fig .",
    "3 . the msds before and after registration are 271.8 and 77.3 respectively .",
    "[ b]0.3     [ b]0.3     [ b]0.3       in this section , a complete database of brain ct images are considered .",
    "the database contains 80 images , each of the size of @xmath65 pixels . using the content adaptive mesh generation method , a mesh generated for each image in the database and then used for registration of consecutive slices in the database .",
    "each mesh contains approximately 3300 nodes and 6700 triangles . for better comparison of the speed of the proposed method with pixel - based registration ,",
    "an implementation of the curvature - based registration method @xcite has been used .",
    "this implementation takes advantage of a fast discrete cosine transform ( dct ) solver .",
    "both of the methods are implemented and tested on matlab without any specific optimization and the process of optimization is terminated after 100 iterations . for the pixel - based curvature registration method",
    ", the dct solver is implemented using the embedded dct function in matlab which uses a c implementation , therefore is very fast and optimized while in the implementation of our method , the solver is implemented using in matlab scripts by the authors .",
    "however , the proposed method performs faster . using a mex or c implementation of the proposed method ,",
    "higher speeds can be achieved .",
    "table 1 summarizes the computational time of these two methods , implemented on a desktop computer with an intel core i7 3.5 ghz cpu and 6 gb of ram , as well as the mean msd error of the methds .",
    ".computational time and mean msd error for pixel - based and mesh - based registration methods [ cols=\"^,^,^ \" , ]     [ b].69      +    [ b]0.3     [ b]0.3",
    "in this paper , a new efficient triangular mesh - based image registration technique is introduced .",
    "table 1 concludes the results of comparison between pixel - based curvature registration method with dct solver @xcite with the proposed mesh - based method .",
    "even though matlab is used for both of the methods , one needs to consider that the pixel - based approach is using the internal optimized dct function ( written in c ) to solve the linear system at each iteration , unlike the mesh - based technique which uses not - optimized matlab functions written by the authors .",
    "however the mesh - based technique outperforms the pixel - based method both in accuracy and speed .",
    "higher speeds can be achieved with c implementations of the proposed method .",
    "usually image registration techniques , specially the non - parametric ones , work on the pixel level .",
    "multi - resolution techniques do not distinguish between regions that have significant feature content and regions that are featureless / uniform .",
    "octrees are a way of to adaptively sub - divide images based on feature content . however , the rectangular boundaries in octrees do no suit feature boundaries that tend to be curvilinear . on the other hand triangle",
    "meshes can accurately follow curvilinear feature boundaries . however using triangular mesh",
    "has its own implications regarding defining the problem of image registration and optimization of the geometric transformation needed to be applied to template image to match the reference image . here a new technique for fast mesh - based image registration is proposed which can take into account these implications and achieve high accuracy .",
    "this method has the dual advantage of a compact representation and fast computation .",
    "furthermore , images at any desired resolution can be considered for registration since we only need to deal with the mesh nodes and not image pixels .",
    "5 patton , n. , aslam , t.m . ,",
    "macgillivray , t. , deary , i.j . ,",
    "dhillon , b. , eikelboom , r.h .",
    "yogesan , k. , constable , i.j . : retinal image analysis : concepts , applications and potential .",
    "prog retin eye res 25 , no . 1 , 99 - 127 ( 2006 )              penney , g.p . ,",
    "weese , j. , little , j.a . , desmedt , p. , hill , d.l.g . ,",
    "hawkes , d.j . : a comparison of similarity measures for use in 2-d-3-d medical image registration .",
    "ieee t med imaging 17.4 , 586 - 595 ( 1998 )                desbrun , m. , meyer , m. , schrder , p. , barr , a.h . :",
    "implicit fairing of irregular meshes using diffusion and curvature flow . in proceedings of the 26th annual conference on computer graphics and interactive techniques , pp .",
    "317 - 324 .",
    "acm press / addison - wesley publishing co. , ( 1999 )"
  ],
  "abstract_text": [
    "<S> in this paper a fast triangular mesh based registration method is proposed . having _ template _ and </S>",
    "<S> _ reference _ images as inputs , the template image is triangulated using a content adaptive mesh generation algorithm . considering the pixel values at mesh nodes , interpolated using spline interpolation method for both of the images , the energy functional needed for image registration </S>",
    "<S> is minimized . </S>",
    "<S> the minimization process was achieved using a mesh based discretization of the distance measure and regularization term which resulted in a sparse system of linear equations , which due to the smaller size in comparison to the pixel - wise registration method , can be solved directly . </S>",
    "<S> mean squared difference ( msd ) is used as a metric for evaluating the results . using the mesh based technique , </S>",
    "<S> higher speed was achieved compared to pixel - based curvature registration technique with fast dct solver . </S>",
    "<S> the implementation was done in matlab without any specific optimization . </S>",
    "<S> higher speeds can be achieved using c / c++ implementations .    * keywords : * medical image registration , triangular mesh generation , content adaptive mesh generation , diffusion process </S>"
  ]
}