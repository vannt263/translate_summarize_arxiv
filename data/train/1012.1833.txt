{
  "article_text": [
    "over the past decade the cosmic microwave background ( cmb ) has emerged as a fundamental probe of cosmology and astrophysics .",
    "in addition to the primary fluctuations of the early universe , the cmb contains signatures of the gravitational bending of cmb photon trajectories due to matter , called gravitational lensing . mapping this gravitational lensing is important for a number of reasons including , but not limited to , understanding cosmic structure , constraining cosmological parameters @xcite and detecting gravity waves @xcite . in this paper",
    "we present a local bayesian estimate that can accurately map the gravitational lens in high resolution , low noise measurements of the cmb temperature and polarization fields .",
    "there is extensive literature on estimating the lensing of the cmb ( classic references include @xcite ) and some recent observational detections @xcite .",
    "the current estimators in the literature can be loosely characterized into two types .",
    "the first type was initiated in @xcite ( see also @xcite ) and utilizes quadratic combinations of the cmb and its gradient to infer lens structure .",
    "the optimal quadratic combinations were then discovered by @xcite and are generally referred to as the quadratic estimator. this is arguably the most popular estimate of the gravitational potential and uses a first order taylor approximation to establish mode coupling in the fourier domain which can be estimated to recover the gravitational potential ( real space analogs to these estimators can be found in @xcite ) .",
    "the second type is an approximate global maximum likelihood estimate and was developed in @xcite .",
    "our method , in contrast , locally approximates a quadratic form for the gravitational potential and estimates the coefficients locally using bayesian methods .",
    "the locally estimated coefficients are then globally _ stitched together _ to construct an estimate of a low pass filter of the gravitational potential .",
    "the local analysis allows us to avoid using the typical first order taylor expansion for the quadratic estimator and avoids the likelihood approximations used in global estimates .",
    "moreover , we are able to easily handle missing pixels , problems with partial sky observations ( e and b mode mixing , for example ) , and spatially varying or asymmetric beams .",
    "the motivation for developing this estimate stems , in part , from current speculation that likelihood methods will allow superior mapping of the lensing structure ( compared to the quadratic estimator ) under low noise levels , and that global likelihood methods can be prohibitively computational intensive  indeed intractable  without significant approximation .",
    "we illustrate our mapping methodology on a high resolution , low noise simulation of the cmb temperature and polarization field on a @xmath4 patch of the flat sky . this simulation is used throughout the paper to demonstrate findings and techniques .",
    "to get an overview of the performance of our method , fig .",
    "[ fig1 ] shows the estimated potential ( left ) from the simulated lensed cmb temperature and polarization field ( observational noise levels are set at @xmath0 @xmath1-arcmin for the temperature field , @xmath2 @xmath1-arcmin for the polarization fields , with a beam fwhm of @xmath3 arcmin ) .",
    "the input gravitational potential is shown in the right diagram in fig .",
    "the details of the simulation procedure can be found in appendix [ simdets ] .",
    "it is clear from fig .",
    "[ fig1 ] that the mapping accurately traces the true , unknown gravitational potential .",
    "to get an idea of the noise of this reconstruction for different realizations of the cmb @xmath5 noise we present fig .",
    "[ sect ] which shows the different estimates of the projected matter power spectrum using the estimated projected mass  with the local likelihood approach  for 10 different cmb @xmath5 noise realizations ( dashed lines ) while keeping the gravitational potential in fig .",
    "[ fig1 ] fixed .",
    "the blue curve shows the estimated projected mass power spectrum if one had access to the true gravitational potential used in our simulations .",
    "finally we plot the theoretical ensemble average projected mass power spectrum in red to get an idea of the magnitude of the errors in the mass reconstruction .     and appendix [ simdets ] for the simulation details .",
    "[ sect ] , height=260 ]",
    "the cmb radiation in the flat sky limit can be expressed in term of the stokes parameters @xmath6 which measure total intensity @xmath7 , and linear polarization @xmath8 and @xmath9 with respect to some coordinate frame @xmath10 . instead of directly observing @xmath6",
    "we observe a remapping of the cmb due to the gravitational effect of intervening matter .",
    "this lensed cmb can be written @xmath11 and @xmath12 where @xmath13 denotes the gravitational potential ( see @xcite , for example ) .    to describe our estimate of the gravitational potential , @xmath13 ,",
    "first consider a small circular observation patch with diameter @xmath14 in the flat sky centered at some point @xmath15 , denoted @xmath16 . over this small region",
    "we decompose @xmath13 into an overall local quadratic fit and error term @xmath17 where @xmath18 is a local quadratic approximation of the potential @xmath13 with error term @xmath19 . in what follows we estimate @xmath18 , denoted @xmath20 , and associate this estimate with the neighborhood midpoint @xmath15 .",
    "then we repeat this procedure for other local midpoints @xmath15 throughout the observation window . after a shrinkage adjustment is made to the local estimates we show , in section [ rec ] , how to _ stitch _ the estimates together to produce the final estimated potential @xmath21 shown in fig .",
    "[ fig1 ] .",
    "notice that as @xmath22 the expected magnitude of the error @xmath23 approaches zero .",
    "this has the effect of improving the following taylor approximation @xmath24 for @xmath25 , where we use the notation @xmath26 ( with a similar taylor expansion for both @xmath27 and @xmath28 ) .",
    "notice that @xmath29 depends not only on @xmath30 but also the unknown coefficients of the quadratic term @xmath18 .",
    "we briefly mention that these are related to the convergence @xmath31 and shear @xmath32 of the gravitational lens by @xmath33 using the shear notation given in @xcite .",
    "now when @xmath14 is sufficiently small we can truncate the expansion in ( [ number2 ] ) to get @xmath34     \\approx     \\left[\\begin{array}{c } t({\\boldsymbol}x+\\nabla q^\\phi({\\boldsymbol}x))\\\\    q({\\boldsymbol}x+\\nabla q^\\phi({\\boldsymbol}x ) ) \\\\     u({\\boldsymbol}x+\\nabla q^\\phi({\\boldsymbol}x ) )    \\end{array }   \\right]\\ ] ] on the local neighborhood @xmath35 . by regarding @xmath18 as unknown we can use the right hand side of ( [ approx1 ] ) to develop a likelihood for estimating the coefficients of @xmath18 .",
    "nominally @xmath18 has @xmath36 unknown coefficients for which to estimate . however , we can ignore the linear terms in @xmath18 since the cmb temperature and the polarization are statistically invariant under the resulting translation in @xmath37 .",
    "therefore , one can write @xmath18 as @xmath38 for unknown coefficients @xmath39 . an important probe of gravitational lensing from the cmb polarization is the creation of a curl - like b mode from the lensing @xcite .",
    "we remark that a local quadratic approximation in ( [ approx1 ] ) still has the power to detect this b mode power so that the local procedure is not blind to this information source . to see this notice that a quadratic lensing potential remaps the coordinates by @xmath40 ( { \\boldsymbol}x -{\\boldsymbol}x_0).\\ ] ] if we assume the original polarization @xmath41 is curl free then the lensed polarization has curl given by @xmath42 .",
    "\\end{aligned}\\ ] ] therefore the shear parameter @xmath43 , and not the convergence @xmath31 , is what creates local b - mode power .",
    "the dominant source of information for b - mode power is in the cross correlation between the lensed stokes parameters @xmath44 and @xmath45 .",
    "this agrees with @xcite that the e - b cross estimator provides optimal signal to noise under nearly ideal experimental conditions .",
    "we finish this section with a remark on the accuracy of the taylor approximation ( [ number2 ] ) . as the the signal to noise ratio increases and the pixel resolution improves one can shrink the local neighborhood @xmath35",
    "so the term @xmath23 becomes smaller ( which improves the taylor approximation ) .",
    "however , as @xmath22 , the fields @xmath46 and @xmath47 become nearly linear and one may expect some loss of information from the shrinking power in @xmath46 and @xmath47 at frequencies with wavelengths smaller than the neighborhood @xmath35 .",
    "it therefore may be statistically advantageous to artificially increase the neighborhood size while simultaneously increasing the order of the local polynomial fit @xmath18 .",
    "then , instead of recording the full polynomial fit at each midpoint @xmath15 , one can retain the second order derivatives @xmath48 for estimates of @xmath31 and @xmath43 .",
    "it is yet to be seen , however , what @xmath14 and what polynomial order will be optimal for a given noise and resolution level . in section [ infor ]",
    "we present an information metric for choosing the neighborhood size @xmath14 for the simulation specifics and for a quadratic polynomial @xmath18 .      using the gaussian approximation of the cmb along with the quadratic potential approximation given by ( [ approx1 ] )",
    "we describe how to construct the likelihood as a function of the unknown quadratic coefficients in @xmath18 .",
    "let @xmath49 denote the observation locations of the cmb within the local neighborhood @xmath50 centered at @xmath15 . using approximation ( [ approx1 ] ) , the cmb observables in this local neighborhood are well modeled by white noise corruption of a convolved ( by the beam ) lensed intensity and polarization field .",
    "let @xmath51 denote @xmath52-vectors of observed cmb values at the corresponding pixel locations in @xmath35 for the intensity @xmath53 and stokes parameters @xmath54 , respectively . using gaussianity of the full vector of cmb observables , @xmath55 , the log likelihood ( up to a constant ) as a function of the quadratic fit @xmath18 can be written @xmath56 where @xmath57 is the covariance matrix of the observation vector @xmath58 ( we use the subscript to emphasize the dependence on the unknown quadratic @xmath18 ) , @xmath59 is the noise covariance structure and @xmath60 is the @xmath61 identity matrix .",
    "notice that the noise structure does not depend on the unknown quadratic @xmath18 . in the next section",
    "we will derive the exact form of the prior distribution on @xmath18 , denoted @xmath62 , but briefly mention that the posterior distribution on @xmath18 , which we maximize to estimate @xmath18 , is @xmath63    the entries of @xmath57 contain the covariances @xmath64 , @xmath65 , @xmath66 and all cross covariances among @xmath67 ( we use @xmath68 to denote the @xmath69 entry of @xmath70 , for example ) .",
    "let @xmath71 denote the instrumental beam and @xmath72 denote the noise standard deviations of @xmath6 so that , for example , the @xmath69 entry of @xmath70 is modeled as @xmath73 where the @xmath74 s are independent standard gaussian random variables , @xmath75 and @xmath76 .",
    "note that this is an approximate model for @xmath68 based on ( [ approx1 ] ) .",
    "in actuality , the @xmath69 temperature measurement is @xmath77 , but the linearity of @xmath37 allows us to write @xmath78 on the small neighborhood @xmath35 . under the assumption of zero @xmath79 mode , the spectral densities associated with @xmath54 can be written @xmath80 where @xmath81 and @xmath82 . since one can write @xmath83 where the @xmath84 is a @xmath85 real matrix , the sheared stokes parameters @xmath86 and @xmath45 are stationary random fields with spectral densities given by @xmath87 and @xmath88 , respectively . after adjusting for the beam ( which is applied after lensing ) the covariance between the observations in @xmath70",
    "can be written @xmath89 the computations are similar to complete the entries of covariance matrix @xmath57 . at face value the above",
    "integral seems too computationally intensive for every pair @xmath90 .",
    "moreover , to apply newton type algorithms for maximizing the posterior ( [ formpost ] ) one needs to compute the derivatives of @xmath64 with respect to elements of @xmath84 . in appendix [ newt ]",
    "we show that some of these computational challenges can be overcome by utilizing a single fft to quickly compute the above integral for sufficient resolution in the argument @xmath90 to recover @xmath91 for all pairs @xmath92 .      the quadratic function @xmath18 is defined as the best least square fit of @xmath13 over the neighborhood @xmath50 .",
    "the residual @xmath93 , defined over @xmath35 , is nonstationary and will therefore not have a spectral density that diagonalizes the covariance structure .",
    "however , stationarity is a good approximation for order of magnitude calculations on the truncation error in ( [ number2 ] ) .",
    "we approximate the spectral density of @xmath23 as an attenuated version of @xmath94 by arguing that the quadratic fit effectively removes the spectral power at wavelengths greater than @xmath95 .",
    "reasoning similarly we expect the quadratic fit to have negligible impact on the spectral power at wavelengths smaller than @xmath14 . by assuming the spectral power grows linearly in the intermediary spectral range , from zero at @xmath96 to @xmath97 at @xmath98",
    ", we obtain an approximate model for the spectral density of @xmath23 @xmath99^+\\bigr\\}^2 { c_\\ell^\\phi}\\ ] ] where @xmath100 denotes the positive part of the real number @xmath101 .",
    "notice that the attenuation happens on the realizations of @xmath13 , hence requiring the square on the low pass filter in the spectral density .",
    "this implies that the second term in the taylor expansion ( [ number2 ] ) has approximate spectral density @xmath102    , for each local neighborhood midpoint @xmath15 , plotted against the simulation truth at different stages of the algorithm .",
    "the blue points correspond to the raw estimates at each local neighborhood ; the green points to the estimates after fitting a gravitational potential ; the red points after a shrinkage correction .",
    "the @xmath103 coordinates of the blue points are shifted up by 0.2 and the red points are shifted down by 0.2 to fit on the same diagram .",
    "see sections [ truc ] and [ rec ] for discussion.[fig2],width=340 ]    in our simulation we use a neighborhood diameter of @xmath104 radians ( 20.6 acrmin ) .",
    "this diameter was chosen using the information criterion developed in section [ infor ] .",
    "the corresponding approximate rms of @xmath105 is @xmath106 with an order of magnitude reduction for the polarization field .",
    "brute force simulation of @xmath107 yields a value closer to @xmath108 , suggesting a reasonable stationary approximation to @xmath23 .",
    "these approximations show that the polarization truncation error is smaller ( by an order of magnitude ) than the simulation noise level @xmath109-arcmin .",
    "however , the temperature truncation error is greater than the temperature noise level @xmath110 .",
    "a consequence is that the likelihood explains the additional high frequency power in the observations ( from the error term ) by adjusting the estimate of @xmath18 to artificially magnify the convergence @xmath31 estimates .",
    "indeed , this bias seems relatively constant and can be clearly seen in fig .",
    "[ fig2 ] in the top blue points .",
    "each blue point corresponds to a local neighborhood : the @xmath101-coordinate representing the true @xmath111 associated with that neighborhood ; the @xmath103-coordinate representing the estimated local value shifted up by @xmath112 , i.e. @xmath113 . the bias of nearly @xmath114 above the top dashed blue line @xmath115 , shows the effect of the additional high frequency power of the error term @xmath105 . to adjust this",
    ", we subtract the overall mean of the local estimates , reasoning that the observation window is large enough at @xmath4 so that the overall mean of the true values @xmath116 is close to zero . for smaller observation windows it may be possible to estimate an overall quadratic fit to correct for this bias but we do not investigate that here .",
    "the stationary approximation for @xmath23 also yields an approximation for the the prior distribution of the local quadratic fit @xmath18 using the identity @xmath117 .",
    "since @xmath23 is well modeled by a high pass filter of @xmath13 , the quadratic function @xmath18 can be modeled by the corresponding low pass filter @xmath118 over @xmath119 , where @xmath120^+\\bigr\\ } \\phi({\\boldsymbol}\\ell ) $ ] which has spectral density @xmath121^+\\bigr\\}^2 { c_\\ell^\\phi } $ ] .",
    "therefore a natural candidate for the prior on the coefficients of @xmath18 are the random variables @xmath122 which are mean zero and gaussian with variances obtained by the corresponding spectral moments of @xmath123 .",
    "this prior is used on each local neighborhood @xmath124 to derive the local maximum _ a posteriori _ estimate . for the simulation used in this paper ,",
    "the neighborhood width was set to @xmath104 radians ( 20.6 arcmin ) which gives prior variances @xmath125 for @xmath126 and @xmath127 , respectively ( the only nonzero cross covariance is between @xmath128 and @xmath127 and is @xmath129 ) .",
    "when observing the full sky , the estimates of @xmath31 will allow one to recover the gravitational potential @xmath13 by solving the poisson equation @xmath130 ( up to a constant ) .",
    "with partial sky observations , however , the shear is needed to break ambiguity corresponding to different boundary conditions .",
    "we do this in two stages , first using @xmath131 , @xmath132 and @xmath133 ( regarded as functions of the local neighborhood midpoint @xmath15 ) to recover the estimated displacement field @xmath134 , then using this displacement field to recover the estimated potential @xmath21 . to handle this ,",
    "we adopt the method of @xcite and define @xmath135 as minimizers of functionals @xmath136 and @xmath137 defined as @xmath138   \\\\",
    "f_2(\\phi_y)&\\equiv    \\int dxdy \\bigl[(\\phi_{xy}-\\hat q^{\\phi}_{xy } ) ^2 + ( \\phi_{yy}-\\hat q^{\\phi}_{yy } ) ^2 \\bigr].\\end{aligned}\\ ] ] in particular , @xmath139 satisfies @xmath140 and similarly for @xmath141 .",
    "see @xcite for details of the minimization algorithm .",
    "now we use the estimated displacements @xmath142 to define the estimated potential @xmath21 as the minimizer of the functional @xmath143 defined as @xmath144.\\ ] ] the minimization is needed to account for the fact that our estimates are noisy versions of the truth and therefore may not correspond to an integral vector field for which a potential exists .",
    "a consequence is that the estimate @xmath21 is shrunk towards zero when the algorithm fits a gradient to a vector field which may have non vanishing curl .",
    "this shrinking can be seen in fig .",
    "[ fig2 ] looking at the scatter plot of green points .",
    "these points show @xmath145 for each local neighborhood @xmath35 .",
    "one can clearly see the shrinkage effect by noticing the slope of the trend in the green points is less than one .",
    "we undo this shrinkage effect by multiplying @xmath146 by a factor that undoes this shrinkage .",
    "the multiplication factor , denoted @xmath147 , is determined by matching the variance of the raw estimates @xmath148 with @xmath149 .",
    "the result of this correction factor is seen in the scatter plot of the red points , in fig .",
    "[ fig2 ] , which show the local convergence estimates versus truth after the correction factor @xmath150 .    the estimated @xmath151 ( after correcting for the shrinkage ) along with the true displacement @xmath152 ( used in the simulation ) are shown in fig .",
    "the estimated @xmath146 along with the true gravitational potential @xmath13 are shown in fig .",
    "these two figures demonstrate accurate reconstruction of both the gravitational potential and the displacement field .",
    "in addition , by differentiating the estimated potential , @xmath21 , one obtains smoothed estimates of convergence and shear ( smoothed from the fitting of @xmath21 ) . in fig .",
    "[ bbb ] we plot the estimate @xmath153 ( which corresponds to minus the imaginary part of the shear @xmath43 ) , along with @xmath154 ( bottom right ) and the low pass filter @xmath155 ( bottom left ) defined in section [ pprior ] .",
    "notice that the estimate @xmath153 tracks the derivatives of the low pass filter @xmath155 , whereas the additional high frequency in @xmath154 is not accurately estimated from @xmath153 .",
    "this is presumably due to the local fitting of a quadratic potential over the neighborhoods @xmath50 .",
    "we define the following measure of information which is used as a metric for choosing the width of the neighborhood and other parameters of our estimation method : @xmath156 the above information metric is essentially a measure of signal to noise ratio ( squared ) .",
    "the variance of the prior corresponds to the squared magnitude of the signal , whereas the expected variance of the posterior is a proxy for the squared magnitude of the noise .",
    "we use simulations to estimate this information ( while using the hessian of the posterior density at @xmath20 to approximate posterior variance ) and use it for guidance when choosing the tuning parameters for our estimation algorithm . note",
    ": we avoided a lengthy and rigorous simulation study to choose global optimal tuning parameters , opting for a less rigorous simulation study which yields , potentially , sub - optimal but reasonable algorithmic parameters .",
    "the main parameter that needs tuning is the local neighborhood size @xmath14 .",
    "notice that our information measure attempts to balance two competing quantities when choosing a neighborhood size , the larger the neighborhood the smaller the signal @xmath18 ( from the low pass filter ) .",
    "on the other hand , larger neighborhoods correspond to more data when the resolution is fixed . using this metric",
    ", @xmath104 radians ( 20.6 arcmin ) emerges as a good neighborhood size when the beam fwhm is @xmath3 arcmin and the noise levels are @xmath2 and @xmath157-arcmin pixels for @xmath158 and @xmath53 , respectively .    due to computational limitations associated with larger neighborhoods we found it necessary to down - sample the local neighborhoods by discarding pixels . using the information metric we were able to isolate",
    "that randomly sampling the pixels seemed preferable to evenly downsampling to a courser grid .",
    "moreover , we found that using different randomly selected pixels for @xmath159 and @xmath47 was preferable to using the same random pixels for all the stokes fields .",
    "therefore , for each local neighborhood we selected 300 random pixels in @xmath35 for the @xmath53 observations , then randomly selected 300 pixels from those remaining for @xmath160 and finally 300 pixels from the remaining unselected pixels for @xmath47 ( allowing overlaps when the local neighborhood size had fewer than @xmath161 pixels ) .",
    "we have demonstrated the feasibility of using a local bayesian estimate to accurately map the gravitational potential and displacement fields under low noise , small beam experimental conditions .",
    "the motivation for developing this estimate stems , in part , from speculation that likelihood methods will allow superior mapping of the lensing structure ( compared to the quadratic estimator ) under low noise levels .",
    "the main difference between the global estimates of @xcite and the local estimate presented here is the nature of the likelihood approximation . in @xcite the global likelihood",
    "is defined as a functional on the unknown gravitational potential @xmath13 and approximations are made to this functional .",
    "our method , in contrast , uses a nearly exact likelihood  exact up to approximation ( [ covfun ] ) in appendix [ newt]but under a local modeling approximation that assumes a quadratic @xmath13 . one advantage is the added precision available to model instrumental and foreground characteristics . for example , the local analysis models the beam convolved cmb rather than the deconvolved cmb .",
    "deconvolution induces spatial correlation in the additive instrumental noise which is potentially nonstationary if the beam spatially varies .",
    "since this noise is not invariant under warping it complicates the global likelihood .",
    "another advantage is that the local estimates are relatively easy to implement and parallelize .",
    "in addition , the local estimate automatically uses the highest signal to noise combinations of @xmath54 and @xmath53 so there is no need to re - derive the optimal quadratic combinations for different experimental conditions .",
    "the local analysis is not free from disadvantages however .",
    "a global analysis is presumably much better suited for estimating long wavelengths in the gravitational potential and wavelengths that are shorter than the local neighborhood size . moreover , since our estimates are defined implicitly  as the maximum of the posterior density ",
    "it is difficult to derive expected error magnitudes .",
    "however , the results presented here show that under some experimental conditions the advantages overcome the disadvantages .",
    "moreover our local estimate uses an approximation that is inherently different from the taylor approximation used to derive the quadratic estimator .",
    "this leaves open the possibility that the local estimate may have different bias and error characteristics which could compliment the quadratic estimator , rather than replace it .",
    "the fiducial cosmology used for the simulations is based on a flat , power law @xmath162cdm cosmological model , with baryon density @xmath163 ; cold dark matter density @xmath164 ; cosmological constant density @xmath165 ; hubble parameter @xmath166 in units of 100@xmath167km@xmath167s@xmath168mpc@xmath169 ; primordial scalar fluctuation amplitude @xmath170mpc@xmath171 ; scalar spectral index @xmath172mpc@xmath173 ; primordial helium abundance @xmath174 ; and reionization optical depth @xmath175 .",
    "the camb code is used to generate the theoretical power spectra @xcite .",
    "we start by simulating maps of the unlensed cmb stokes parameters @xmath6 .",
    "the following riemann sum approximation is used for the random fields @xmath6 @xmath176 where @xmath177 ; @xmath178 are the frequency spacing in the two coordinate directions ; for each @xmath179 , @xmath180 and @xmath181 are mean zero complex gaussian random variables such that @xmath182 , @xmath183 , @xmath184 and @xmath185 . to enforce the proper cross correlation between @xmath186 and @xmath187 we set @xmath188=\\frac{1}{\\sqrt{2 } } \\left [ \\begin{array}{cc } -\\sqrt{1-\\rho } & \\sqrt{1+\\rho}\\\\ \\sqrt{1-\\rho } &   \\sqrt{1+\\rho }   \\end{array}\\right ]   \\left [ \\begin{array}{c }   w^1_{{\\boldsymbol}\\ell}\\\\ w^2_{{\\boldsymbol}\\ell}\\end{array}\\right]\\ ] ] where @xmath189 , and for each @xmath179 ,",
    "@xmath190 are mean zero complex gaussian random variables such that @xmath191 , @xmath192 , @xmath193 , @xmath194 and @xmath195 .    in our simulation , the above sums",
    " equations ( [ sim1]),([sim2 ] ) and ( [ sim3])are taken over frequencies @xmath196 where @xmath197 radians so that @xmath53 will be periodic on @xmath198 ^ 2 $ ] . the limit @xmath199 is chosen to match the resolution in pixel space , denoted @xmath200 , so that fft can be used to compute the sums ( [ sim1]),([sim2 ] ) and ( [ sim3 ] ) which , after simplification , becomes @xmath201 for each @xmath202 where the sums range over @xmath203 . the matrix of values @xmath204_{{\\boldsymbol}j\\in \\{-n/2,\\ldots , n/2 - 1 \\}^2}$ ] , for example , can then be simulated by a two dimensional fft of the matrix @xmath205_{{\\boldsymbol}k\\in \\{-n/2,\\ldots , n/2 - 1 \\}^2}$ ] . the identities @xmath194 and @xmath195",
    "are enforced using a two dimensional fft of two @xmath206 matrices with independent standard gaussian random entries .",
    "_ remark : _ typically the above method suffers from an aliasing error when truncating to a finite sum in ( [ sim1]),([sim2 ] ) and ( [ sim3 ] ) .",
    "we avoid any such complication by setting the power spectrum in @xmath207 and @xmath208 to zero for all frequencies beyond @xmath209 .",
    "we justify this truncation since both diffusion damping and the beam fwhm of @xmath210 combine to produce negligible amplitude in the cmb stokes parameters at frequencies @xmath211 compared to the noise level .    _",
    "remark : _ since the full sky stokes parameters @xmath6 are defined on the sphere , the theoretical power spectrum for @xmath212 , @xmath213 , @xmath214 are only defined on integers @xmath215 .",
    "our flat sky approximation is obtained by extending @xmath212 , @xmath213 and @xmath214 to @xmath216 by rounding the magnitude @xmath217 to the nearest integer .",
    "see appendix c in @xcite for a derivation of this flat sky approximation .",
    "to get a realization of the lensed cmb stokes parameters @xmath6 we use the above method to generate a high resolution simulation of @xmath6 and the gravitational potential @xmath13 on a @xmath218 patch of the flat sky with @xmath3 arcmin pixels .",
    "the lensing operation is performed by taking the numerical gradient of @xmath13 , then using linear interpolation to obtain the values @xmath219 .",
    "the beam effect is then performed in fourier space using fft of the lensed fields .",
    "finally , we down - sample the lensed fields , every @xmath220 pixel , to obtain the desired arcmin pixel resolution for the simulation output .",
    "in this section we discuss our numerical procedure for maximizing the local posterior given by ( [ formpost ] ) .",
    "we remark that calculations need to be fast since they will be performed on each local neighborhood for which a shear and convergence estimate is required .",
    "we discuss how the fft can be used to to compute the covariance matrix , denoted @xmath57 in section [ lllike ] , and the corresponding derivatives with respect to the unknown coefficients of @xmath18 .",
    "we let @xmath84 be the symmetric @xmath221 matrix defined as @xmath222 so that @xmath83 .",
    "the matrix @xmath84 is regarded as the unknown which will be estimated from the data in the local neighborhood @xmath35 .",
    "let @xmath223 denote a sheared temperature field , convolved with a gaussian beam ( with standard deviation @xmath224 ) so that @xmath225 to compute the covariance matrix of the @xmath53 observations @xmath226 in @xmath35 ( see equation ( [ obbbsss ] ) ) one needs to evaluate the following covariance function for a given test shear matrix @xmath84 at all vector lags @xmath227 @xmath228 all these calculations can be approximated using a fft by noticing @xmath229 where the sum ranges over @xmath230 , @xmath200 is the pixel spacing , @xmath231 , @xmath232 and @xmath233 . then to compute the covariance between @xmath234 and @xmath68 we simply select the entry of the matrix @xmath235_{{\\boldsymbol}j\\in \\{-n/2,\\ldots , n/2 - 1 \\}^2}$ ] such that @xmath236 ( which was obtained by a single fft ) .",
    "a similar technique can be used to compute all other covariance and cross - covariances among @xmath159 and @xmath47 to construct the covariance matrix @xmath237 .",
    "we remark that to speed up the computations we choose a smaller @xmath238 then the one used in the simulations ( @xmath239 in the simulation but @xmath240 for the approximation of @xmath241 ) .",
    "once the covariance matrix @xmath57 is constructed using the approximation ( [ covfun ] ) ( and the analogous approximations for @xmath158 and all cross correlations ) the posterior is easily computed as @xmath242 where @xmath243 denotes the log likelihood ( [ mmtt ] ) and @xmath244 is the prior distribution derived in section [ pprior ] . in principle",
    ", one can now simply use pre - existing minimization algorithms for maximizing the posterior @xmath245 with respect to @xmath18 .",
    "if one desires a more sophisticated newton type algorithm for maximizing the posterior one often needs to compute the gradient and hessian of the posterior . using the techniques of _ automatic differentiation _ ( see @xcite , for example )",
    "one can easily compute such derivatives if one can compute the rates of change of the covariance @xmath237 with respect the the elements of @xmath84 .",
    "we finish this appendix by noticing that the fft can be used to approximate the derivatives of @xmath237 with respect to the elements of the matrix @xmath84 , denoted @xmath246 for @xmath247 .",
    "for illustration we focus on the covariance structure of the temperature field @xmath53 and mention that the extension to @xmath158 is similar .",
    "first notice that by transforming variables @xmath248 one gets @xmath249\\nonumber\\end{aligned}\\ ] ] now @xmath250\\bigl/ { d m_{k , j } } $ ] can be written as a sum @xmath251 so that by re - transforming variables to @xmath252 one gets @xmath253 the point is that the above integrals can now be approximated using fft to approximate the matrix of values @xmath254_{{\\boldsymbol}j\\in \\{-n/2,\\ldots , n/2 - 1 \\}^2}$ ] . the same method applies to approximate all higher order derivatives of the covariance matrix .",
    "these derivatives can then be used in a newton type algorithm for finding the maximum _ a - posteriori _ estimates @xmath20 .",
    "dodelson , s. , _ modern cosmology _ , academic press ( 2003 ) guzik , j. , seljak , u. & zaldarriaga , m. , phys .",
    "d 62 , 043517 ( 2000 ) hanson , d. , challinor , a. , efstathiou , g. , bielewicz , p. , arxiv:1008.4403 ( 2010 )"
  ],
  "abstract_text": [
    "<S> we present a new estimation method for mapping the gravitational lensing potential from observed cmb intensity and polarization fields . </S>",
    "<S> our method uses bayesian techniques to estimate the average curvature of the potential over small local regions . </S>",
    "<S> these local curvatures are then used to construct an estimate of a low pass filter of the gravitational potential . by utilizing bayesian / likelihood methods one can easily overcome problems with missing and/or non - uniform pixels and problems with partial sky observations ( e and b mode mixing , for example ) . moreover , our methods are local in nature which allow us to easily model spatially varying beams and are highly parallelizable . </S>",
    "<S> we note that our estimates do not rely on the typical taylor approximation which is used to construct estimates of the gravitational potential by fourier coupling . </S>",
    "<S> we present our methodology with a flat sky simulation under nearly ideal experimental conditions with a noise level of @xmath0 @xmath1-arcmin for the temperature field , @xmath2 @xmath1-arcmin for the polarization fields , with an instrumental beam full width at half maximum ( fwhm ) of @xmath3 arcmin . </S>"
  ]
}