{
  "article_text": [
    "in the history of number theory and arithmetic geometry , the study of the fermat curve @xmath1 of exponent @xmath2 has played a prominent part . in this paper",
    "we consider the case of the fermat curve @xmath3 where @xmath0 is squarefree , odd and composite .    for explicit computations and bounds in the arithmetic geometry of curves over number fields ,",
    "one often needs to compute a regular model of the curve over the ring of integers .",
    "while it is sometimes possible to compute a regular model of a given curve @xmath4 using , for instance , the computer algebra system magma , the construction of regular models depending on a parameter is more involved . in the case of the fermat curve @xmath5 of prime exponent @xmath6 over the field of @xmath7-th cyclotomic numbers , the minimal regular model @xmath8 over @xmath9 $ ]",
    "was constructed by mccallum  @xcite . for other values of @xmath0 , the minimal regular model @xmath10 of @xmath3 over",
    "@xmath11 $ ] is not available in the literature .    in part",
    "i of the present paper , we construct @xmath10 when @xmath0 is squarefree , odd and composite by following the construction of @xmath8 due to mccallum . however , the non - prime case is much more complicated .",
    "it turns out that the only reducible fibers of @xmath10 lie above primes of @xmath11 $ ] dividing @xmath0 , see proposition  [ prop : goodprimes ] .",
    "for such a prime @xmath12 , the zariski closure @xmath13 of @xmath3 in @xmath14 consists of a single component of multiplicity @xmath7 , where @xmath7 is the residue characteristic and @xmath15 is the localization of @xmath11 $ ] with respect to @xmath12 . blowing up along this component , we obtain a normal model .",
    "the nonregular points of the latter can then be resolved by blow - ups , leading to a regular model of @xmath16 } r$ ] .",
    "the configuration of its special fiber is described in theorem  [ thm : f_nmin ] , which shows , in particular , that the model is minimal . the local regular models can then be glued to construct the minimal regular model @xmath8 .",
    "note that we can recover mccallum s results as a special case of our construction , see remark  [ sqfpr ] .",
    "once an explicit description of @xmath10 is available , several interesting arithmetic invariants of @xmath3 can be computed , or at least bounded .",
    "these include some of the invariants appearing in the conjecture of birch and swinnerton - dyer , and arakelov - theoretic invariants .",
    "in part  ii of the present article , we consider the latter , focusing on explicit bounds for the arithmetic self - intersection @xmath17 of the relative dualizing sheaf of @xmath18 , equipped with the arakelov metric .",
    "the computation of such bounds was proposed in  @xcite and  @xcite .",
    "if @xmath19 is an arithmetic surface defined over the ring of integers @xmath20 of a number field @xmath21 such that the generic fiber @xmath4 of @xmath19 has genus @xmath22 , then the arithmetic self - intersection @xmath23 of the relative dualizing sheaf of @xmath19 , equipped with the arakelov metric , is one of the most important invariants of @xmath19 ( or , if @xmath19 is the minimal regular model of @xmath4 , of @xmath4 ) .",
    "it is related to the faltings height of @xmath4 and several other invariants , see  @xcite for a summary .",
    "lower bounds for @xmath23 are crucial in the context of the bogomolov conjecture for curves , proved by szpiro  @xcite , zhang  @xcite and ullmo  @xcite . however , an effective version of the bogomolov conjecture , which in the function field case is known due to work of zhang  @xcite and cinkir  @xcite , is still an open problem in the number field case .    on the other hand , suitable upper bounds for",
    "@xmath23 in certain complete families would lead to a proof of the effective mordell conjecture , see  @xcite .",
    "unfortunately , such bounds seem out of reach .",
    "we summarize the known results in this direction .",
    "javanpeykar  @xcite has given polynomial upper bounds in terms of the belyi degree of @xmath4 . while no bounds in complete families are known to date , there are some results for discrete families .",
    "namely , for certain positive integers @xmath0 , there are bounds for some modular curves , e.g @xmath24 , @xmath25 or @xmath26 , see  @xcite .",
    "upper bounds for minimal regular models of fermat curves @xmath27 of prime exponent @xmath7 over @xmath28 , where @xmath29 is a primitive @xmath7-th root of unity , were first computed in  @xcite and vastly improved in  @xcite .",
    "they were complemented by lower bounds in  @xcite .",
    "building on our explicit description of @xmath10 from part  i of this work , we use a result due to khn  @xcite , which can be viewed as an arakelov - theoretic hurwitz formula on arithmetic surfaces , to compute upper bounds for @xmath30 , when @xmath0 is odd , squarefree and composite .",
    "this is similar to the strategy used in the case of prime exponents  @xcite .",
    "we deduce the following result from the more precise theorem  [ thm : fermat ] :    [ thm : intro_upper ] let @xmath31 be an odd squarefree integer with at least two prime factors , and let @xmath32 be the minimal regular model of the fermat curve @xmath3 over @xmath11 $ ]",
    ". then the arithmetic self - intersection number of its dualizing sheaf over @xmath11 $ ] , equipped with the arakelov metric , satisfies @xmath33 where @xmath34 is the genus of @xmath3 and @xmath35 is a positive constant independent of @xmath0 .",
    "in other words , theorem  [ thm : intro_upper ] yields an upper bound of order @xmath36 . to complement theorem  [ thm : intro_upper ] , we also compute a lower bound for @xmath30 using the results of  @xcite .",
    "these were already employed in  @xcite in the case of prime exponents .",
    "the following explicit lower bound follows from theorem  [ thm : lower ] :    [ thm : intro_lower ] in the notation of theorem [ thm : intro_upper ] we have the lower bound @xmath37    although the results we obtain in part  ii are arakelov - theoretic , we treat the results from  @xcite and  @xcite as black boxes .",
    "this reduces the computation of our bounds to explicit computations of finite vertical intersection multiplicities on @xmath38 .",
    "the paper is organized as follows : in part  i , we first recall some preliminary results from algebraic geometry in section  [ sec : prelims ] .",
    "these results are then used in section  [ sec : curilla ] to construct the local minimal regular model @xmath39 of @xmath3 at a prime @xmath12 of @xmath11 $ ] dividing @xmath0 .",
    "we switch to a global perspective in section  [ sec : global ] and construct the global minimal regular model @xmath40 of @xmath3 over @xmath11 $ ] .",
    "part  ii starts with a brief introduction to the arithmetic self intersection of the relative dualizing sheaf on an arithmetic surface and how to compute lower and upper bounds on it , see section  [ sec : bound_om ] . in section",
    "[ sec : local_comps ] we again work over a fixed prime @xmath12 dividing @xmath0 ; there we first study the extension of cusps of @xmath3 with respect to the belyi morphism @xmath41 given by @xmath42 .",
    "after that , we define certain vertical @xmath43-divisors on the local minimal regular model @xmath39 and study their intersection properties . finally we prove theorem  [ thm : intro_upper ] and theorem  [ thm : intro_lower ] in section  [ sec : upper ]",
    ". the proofs crucially rely on the local results of section  [ sec : int ] .",
    "the results of sections  [ sec : prelims ] ,  [ sec : curilla ] , [ sec : global ] , and of   [ sec : cusps ] and   [ sec : upper_fermat ] also appear in the first author s phd thesis  @xcite , though the presentation has been shortened and some of the proofs given there are different from those presented here .",
    "in the first two paragraphs we state a few results about regularity of noetherian schemes and about explicit blow - ups . these will be used in section  [ sec : curilla ] to construct the minimal regular model of the fermat curve of odd squarefree exponent @xmath0 over @xmath11 $ ] .",
    "although most of the results are well - known , some of the statements or proofs seem to be not easily accessible in the literature .",
    "we hope that it will be useful for the other applications to have these tools gathered in one place .",
    "the final paragraph contains relevant definitions and results on arithmetic surfaces .",
    "we first develop some tools that help to decide whether a given scheme or ring is regular .",
    "let @xmath44 be a noetherian local ring with maximal ideal @xmath45 and residue class field @xmath46 . recall that @xmath44 is _ regular _ if @xmath47 .",
    "alternatively , @xmath44 is regular if and only if @xmath45 can be generated by @xmath48 elements .",
    "more generally , let @xmath44 be a noetherian ring .",
    "if @xmath49 is a prime ideal , then we say that @xmath44 is _ regular at _",
    "@xmath12 if the localization @xmath50 is a regular local ring .",
    "we say that @xmath44 is _ regular _ if it is regular at each prime ideal .",
    "[ lemma : reg1 ] let @xmath44 be a noetherian ring and @xmath49 a prime ideal .",
    "then @xmath44 is regular at @xmath12 if and only if @xmath51 is generated by @xmath52 elements .",
    "this is obvious , since @xmath53 .",
    "[ lemma : reg3 ] let @xmath44 be a regular noetherian ring and @xmath54 a multiplicative subset of @xmath44 .",
    "then @xmath55 is regular .",
    "let @xmath56 be a prime ideal of @xmath55 .",
    "this ideal is of the form @xmath57 , where @xmath12 is a prime ideal of @xmath44 disjoint from @xmath54 , see e.g. ( * ? ? ?",
    "* theorem 4.1 ) .",
    "we have @xmath58 by ( * ? ? ?",
    "* corollary  4.4 ) , hence the regularity of @xmath55 at @xmath56 follows from the regularity of @xmath44 at @xmath12 .",
    "[ lemma : reg4 ] let @xmath44 be a noetherian ring . then @xmath44 is regular if and only if it is regular at its maximal ideals",
    ".    follows from ( * ? ? ?",
    "* corollary  4.4 ) .",
    "in section  [ sec : curilla ] we have to check the regularity of a factor ring @xmath59 , where @xmath44 is a regular ring and @xmath60 is an element of @xmath44 .",
    "[ lemma : sing ] let @xmath59 be a factor ring , where @xmath44 is a regular ring and @xmath60 is an element of @xmath44 . furthermore , let @xmath56 be a prime ideal of @xmath59 and @xmath61 , where @xmath62 is the canonical surjection .",
    "then @xmath59 is regular at @xmath56 if and only if @xmath63 .    the statement follows from ( * ? ? ?",
    "* corollary  4.2.12 ) and ( * ? ? ? * theorem  4.2 ) .",
    "let @xmath4 be a locally noetherian scheme and @xmath64 a point .",
    "we say that @xmath4 is _ regular at _",
    "@xmath65 if the stalk @xmath66 at @xmath65 of the structure sheaf @xmath67 is a regular local ring .",
    "we say that @xmath4 is _ regular _ if it is regular at all of its points . if @xmath65 is a point of @xmath4 which is not regular we call it a _ singular point of _ @xmath4 .",
    "a scheme that is not regular is said to be _",
    "when our scheme comes with a flat morphism we can use the following useful result :    [ lemma : reg2 ] let @xmath4 and @xmath68 be locally noetherian schemes and @xmath69 a flat morphism . if @xmath68 is regular at @xmath70 , and @xmath71 is regular at a point @xmath65 , then @xmath4 is regular at @xmath65 .    see",
    "* corollaire 6.5.2 ) .    in the situations we consider later the scheme @xmath68 is already regular and we only need to take care of the scheme @xmath72 .",
    "this scheme is a variety over the field @xmath73 . to analyze the points of this variety we can use the jacobian criterion  ( * ? ? ?",
    "* theorem 2.19 ) .",
    "[ rk : ffreg ] let us assume the morphism @xmath74 in lemma  [ lemma : reg2 ] is _ faithfully flat _ , i.e. flat and surjective . if @xmath68 and @xmath72 are regular for all @xmath75 then @xmath4 is regular .",
    "if @xmath4 is regular then @xmath68 is regular by ( * ? ? ?",
    "* corollaire  6.5.2 ) .",
    "if @xmath68 is regular at @xmath76 and @xmath72 is singular at some @xmath65 it may still happen that @xmath4 is regular at @xmath65 .",
    "now we are going to describe how we can use regularity to show normality .    [",
    "prop : normal ] let @xmath15 be a regular integral noetherian ring and @xmath77 . if @xmath78 is regular in codimension 1 , then @xmath78 is normal .    since @xmath15 is a regular ring , it is a cohen - macaulay ring .",
    "we want to show that @xmath78 is a cohen - macaulay ring as well .",
    "let @xmath79 and @xmath80 be the preimage of @xmath45 . since localization commutes with passing to quotients by ideals , we have @xmath81 now @xmath60 is a regular element of @xmath82 and so @xmath83 is a cohen - macaulay ring ( see ( * ? ? ?",
    "* proposition  8.2.15 ) .",
    "because our computation is valid for all maximal ideals of @xmath78 , the ring @xmath78 is cohen - macaulay , cf .",
    "* proposition 18.8 ) .",
    "the statement follows using serre s criterion , see for instance ( * ? ? ?",
    "* theorem  8.2.23 ) .      in the study of birational morphisms",
    "blow - ups play an important role .",
    "we summarize the main facts we need about them .",
    "most of the material we introduce is standard and the proofs may be found , for instance , in @xcite and @xcite .",
    "later we will prove a result which deals with the concrete situation that we will encounter in section  [ sec : curilla ] .",
    "apart from this we mostly follow liu s book  @xcite .    to start with ,",
    "let @xmath44 be a noetherian ring and @xmath84 an ideal of @xmath44 .",
    "we denote by @xmath85 the graded @xmath44-algebra @xmath86    let @xmath87 be an affine noetherian scheme , @xmath84 an ideal of @xmath44 , and @xmath88 .",
    "the scheme @xmath89 together with the canonical morphism @xmath90 is called the _ blow - up of @xmath4 along @xmath91_.    the blow - up has the following properties .",
    "[ lem : reg1 ] let @xmath44 be a noetherian ring , and let @xmath84 be an ideal of @xmath44 .    1 .",
    "the ring @xmath85 is integral if and only if @xmath44 is integral .",
    "2 .   let @xmath92 be a flat @xmath44-algebra , and let @xmath93 be the graded @xmath92-algebra associated to the ideal @xmath94 .",
    "then we have a canonical isomorphism @xmath95 .",
    "see ( * ? ? ?",
    "* lemma  8.1.2 . ) .",
    "now let @xmath96 .",
    "we denote by @xmath97 the element @xmath98 , considered as a homogeneous element of degree 1 .",
    "we have a surjective homomorphism of graded @xmath44-algebras @xmath99 \\rightarrow \\widetilde{a}\\ ] ] defined by @xmath100 .",
    "it follows that @xmath85 is isomorphic to a factor ring @xmath101/j$ ] ; here @xmath102 denotes an ideal of @xmath101 $ ] .",
    "it may be desirable for certain applications to express the blow - up in such a way .",
    "unfortunately it is not always easy to describe the ideal @xmath102 explicitly .",
    "however , if the ideal @xmath84 is generated by a regular sequence , we have a simple description of @xmath102 .",
    "[ lem : reg2 ] let @xmath103 be an ideal which is generated by a regular sequence @xmath104",
    ". then @xmath105/j$ ] where the ideal @xmath102 is generated by the elements of the form @xmath106 for @xmath107 .",
    "see  ( * ? ? ?",
    "* proposition  iv-25 , exercise  iv-26 ) .",
    "later on , we will mostly work with integral rings . here",
    "we have the following situation :    [ lem : reg4 ] let @xmath44 be a noetherian integral ring and @xmath96 an ideal of @xmath44 such that @xmath108 for all @xmath109 .",
    "the blow - up @xmath110 along @xmath91 is the union of the affine open subschemes @xmath111 , @xmath112 , where @xmath113 is the sub-@xmath44-algebra @xmath114\\ ] ] of the field @xmath115 generated by the @xmath116 , @xmath117 .",
    "see for instance ( * ? ? ?",
    "* lemma  8.1.4 ) .",
    "[ lem : reg3 ] let @xmath44 be an integral noetherian ring , @xmath118 a regular sequence , and @xmath119 .",
    "we have :    1 .",
    "the ring @xmath120 / j\\ ] ] is integral , where @xmath102 is generated by the elements @xmath121 with @xmath122 and @xmath123 .",
    "2 .   for an element @xmath124 let @xmath125 denote its image in @xmath15 .",
    "we have @xmath126    since @xmath44 is integral , @xmath85 is integral as well by lemma  [ lem : reg1 ] .",
    "we know that @xmath127/ j\\ , , \\ ] ] where @xmath102 is generated by the elements @xmath106 for @xmath128 , see lemma [ lem : reg2 ] .",
    "hence @xmath129 is an affine open subset of @xmath130 and therefore integral .",
    "this proves the first statement .",
    "for the second statement we assume @xmath131 for simplicity .",
    "let @xmath132 .",
    "then there exists a homogeneous polynomial @xmath133 $ ] of degree @xmath134 such that @xmath135 .",
    "if we set @xmath136 then we obviously have @xmath137 and therefore @xmath138 . +",
    "now let @xmath138 .",
    "furthermore , let @xmath139 be the largest integer such that @xmath140 .",
    "let us assume @xmath141 .",
    "as above , there is a homogeneous polynomial @xmath142 of degree @xmath139 with @xmath143 .",
    "it follows that not all coefficients of @xmath142 are in @xmath84 because otherwise we would have @xmath144 .",
    "now @xmath145 is a polynomial in @xmath146 whose coefficients are not all in @xmath84 .",
    "we have @xmath147 , but , since @xmath15 is integral and @xmath138 with @xmath141 , the element @xmath148 must divide @xmath149",
    ". therefore @xmath150 , where @xmath151 $ ] and @xmath152 .",
    "it follows that all coefficients of @xmath153 are in @xmath84 , a contradiction . in other words",
    ", we have @xmath154 and therefore @xmath132 .",
    "so far we have discussed the blow - up of an integral scheme along a subscheme associated to an ideal generated by a regular sequence .",
    "unfortunately , we will encounter more involved blow - ups in section  [ sec : curilla ] .",
    "however , in those situations the following theorem will come to our aid .",
    "[ thm : reg ] let @xmath44 be an integral noetherian ring , @xmath118 a regular sequence , and @xmath119 a prime ideal of @xmath44 .",
    "furthermore , let @xmath155 and @xmath139 be the largest integer such that @xmath156",
    ". then @xmath157 /j_0\\cong a / f[\\frac{\\boldsymbol{a}_1}{\\boldsymbol{a}_i},\\ldots , \\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_i}]\\ , , \\ ] ] where @xmath158 is the ideal generated by the @xmath121 ( with @xmath117 and @xmath123 ) and a polynomial @xmath153 such that @xmath159 ; here @xmath160 denotes the residue class of @xmath161 in @xmath59 and @xmath102 is the ideal from lemma [ lem : reg3 ] .    for simplicity",
    "we assume @xmath131 . the canonical surjection @xmath162 \\longrightarrow   & \\ ,    a / f[\\frac{\\boldsymbol{a}_2}{\\boldsymbol{a}_1 } , \\ldots,\\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_1 } ]   \\\\ f(x_2 , \\ldots , x_r ) \\longmapsto & \\boldsymbol{f}(\\frac{\\boldsymbol{a}_2}{\\boldsymbol{a}_1 } , \\ldots,\\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_1 } ) \\end{aligned}\\ ] ] ( here the bold @xmath163 indicates that we reduce the coefficients of the polynomial modulo @xmath60 ) induces , since @xmath164 , a surjection @xmath165/j \\longrightarrow & \\ , a / f[\\frac{\\boldsymbol{a}_2}{\\boldsymbol{a}_1 } , \\ldots,\\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_1 } ] \\\\ \\overline{f}(\\overline{x_2 } , \\ldots \\overline{x_r } ) \\longmapsto & \\ ,    \\boldsymbol{f}(\\frac{\\boldsymbol{a}_2}{\\boldsymbol{a}_1 } ,    \\ldots,\\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_1 } )   \\ , , \\end{aligned}\\ ] ] where @xmath102 is the ideal from lemma [ lem : reg3 ] .",
    "we get the following commutative diagram @xmath166/j \\ar@{->>}[r]^{\\phi } & a / f[\\frac{\\boldsymbol{a}_2}{\\boldsymbol{a}_1 } , \\ldots,\\frac{\\boldsymbol{a}_r}{\\boldsymbol{a}_1}]\\\\           a \\ar@{->}[u ] \\ar@{->}[r]^{\\pi } & a / f \\ar@{_{(}->}[u ]   } \\ ] ] next we want to investigate the kernel of the map @xmath167 .",
    "let @xmath168 , where @xmath169 is a polynomial of degree @xmath170 and @xmath171 .",
    "we have @xmath172 , where @xmath173 .",
    "since diagram is commutative and the right arrow in this diagram is injective , we have @xmath174 .",
    "it follows that @xmath175 for some @xmath176 .",
    "now let @xmath139 ( @xmath177 resp . ) be the largest integer such that @xmath178 ( @xmath179 resp . ) and @xmath180 $ ] ( @xmath181 $ ] resp . ) with @xmath182 ( @xmath183 resp . ) .",
    "we have @xmath184 in @xmath185/j$ ] .",
    "if we assume that @xmath186 , then we can cancel @xmath187 in equation by lemma  [ lem : reg3 ] and it follows that @xmath65 is in the ideal @xmath188 .",
    "so if we can show that @xmath189 is impossible , then we are done . according to we",
    "have @xmath190 by lemma  [ lem : reg3 ] .",
    "now @xmath189 would imply that the associated graded algebra @xmath191 is not integral .",
    "but @xmath104 is a regular sequence and so we have an @xmath192-algebra isomorphism @xmath193 ( see @xcite ) where @xmath194 is integral , because @xmath84 is a prime ideal .",
    "this finishes the proof by contradiction .",
    "[ rem : blow - up ] the schemes we have to consider later are of the form @xmath195 ( at least locally ) , where @xmath44 is a ring and @xmath196 is a prime element .",
    "the blow - up of @xmath59 along @xmath197 is covered by the spectra of the rings @xmath198\\ , , \\ ] ] where @xmath160 is the residue class of @xmath161 in @xmath59 and @xmath119 , cf .",
    "lemma  [ lem : reg4 ] .",
    "according to theorem  [ thm : reg ] we can express these rings explicitly as factor rings if the @xmath161 form a regular sequence and @xmath84 is a prime ideal . to do this , we only need to know the largest integer @xmath139 such that @xmath140 and polynomials @xmath199 such that @xmath200 .",
    "we can use the following strategy to find these quantities : we only need to find a homogeneous polynomial @xmath201 $ ] such that not all coefficients are in @xmath84 and such that @xmath143 .",
    "obviously @xmath140 , where @xmath139 is the degree of @xmath142 . because @xmath104 is a regular sequence , it is a quasi - regular sequence as well , see ( * ? ? ?",
    "* theorem 16.2 ) .",
    "it follows that if @xmath144 , then all coefficients of @xmath142 are in @xmath84 , a contradiction .",
    "so @xmath139 is the largest integer such that @xmath202 .",
    "we can compute the @xmath199 as in the proof of lemma  [ lem : reg3 ] .",
    "more precisely , we have @xmath203    we briefly describe how to extend the construction of blow - ups of affine scheme to arbitrary schemes . in this situation",
    "we need to use a coherent sheaf of ideals to construct the blow - up .",
    "let @xmath4 be a noetherian scheme , and @xmath204 be a coherent sheaf of ideals on @xmath4 .",
    "consider the sheaf of graded algebras @xmath205 , where @xmath206 is the @xmath134-th power of the ideal @xmath204 , and set @xmath207 .",
    "then @xmath208 is the _ blow - up of @xmath4 with respect to @xmath204_. if @xmath68 is the closed subscheme of @xmath4 corresponding to @xmath204 , then we also call @xmath89 the _ blow - up of @xmath4 along @xmath68_.    [ prop : blow1 ] let @xmath4 be a locally noetherian scheme , and let @xmath204 be a coherent sheaf of ideals on @xmath4 .",
    "let @xmath209 be the blow - up of @xmath4 along @xmath210 .",
    "then we have the following properties :    1 .",
    "the morphism @xmath211 is proper .",
    "2 .   let @xmath212 be a flat morphism with @xmath213 locally noetherian .",
    "let @xmath214 be the blow - up of @xmath213 along @xmath215 ; then @xmath216 .",
    "3 .   the morphism @xmath211 induces an isomorphism @xmath217 .",
    "if @xmath4 is integral , and if @xmath218 , then @xmath89 is integral , and @xmath211 is a birational morphism .    see for instance ( * ? ? ?",
    "* proposition  8.1.12 ) .",
    "now let us assume that @xmath4 is a locally noetherian scheme that comes with a closed immersion @xmath219 to a locally noetherian scheme @xmath213 .",
    "let @xmath220 be a quasi - coherent sheaf of ideals on @xmath213 with the property that @xmath221 is not contained in the center @xmath222 .",
    "then the blow - up @xmath89 of @xmath4 along @xmath204 , where @xmath223 , is a closed immersion of the blow - up @xmath224 of @xmath213 along @xmath220 , see for instance ( * ? ? ?",
    "* corollary 1.16 ) .",
    "the closed subscheme @xmath225 is called the _ strict transform _ of @xmath4 . in our applications",
    "the scheme @xmath4 will be a singular scheme which is a subscheme of a regular scheme @xmath213 . we will use a sequence of blow - ups of @xmath4 to compute a desingularization of this scheme .",
    "each of these blow - ups comes from a blow - up of the scheme @xmath213 .",
    "the blow - ups of @xmath213 are regular by  ( * ? ? ?",
    "* theorem  8.1.19 ) .",
    "let @xmath15 be a dedekind ring with field of fractions @xmath21 .",
    "if @xmath226 is a projective flat morphism and @xmath19 a regular integral scheme of dimension @xmath227 such that the generic fiber @xmath228 of @xmath211 is geometrically irreducible , we call @xmath19 an _ arithmetic surface_. if @xmath229 is a geometrically irreducible smooth projective curve and @xmath19 is an arithmetic surface over @xmath15 whose generic fiber @xmath230 is isomorphic to @xmath4 , then we call @xmath19 a _ ( projective ) regular model _ of @xmath4 over @xmath15",
    ". such a model always exists , see for instance  @xcite .",
    "moreover , if the genus of @xmath4 is at least  1 , then there always exists a regular model @xmath231 of @xmath4 over @xmath15 , unique up to isomorphism , such that every @xmath15-birational morphism @xmath232 to another regular model @xmath19 of @xmath4 over @xmath15 is an isomorphism .",
    "we call @xmath231 the _ minimal regular model _ of @xmath4 over @xmath15 . a regular model @xmath19 of @xmath4 over @xmath15 is minimal if and only if none of its irreducible components can be contracted by a blow - up morphism such that the resulting model remains regular ; such components are called _",
    "exceptional_. if @xmath233 is a component of a special fiber @xmath234 that is defined over an algebraically closed field , then , by castelnuovo s criterion  ( * ? ? ?",
    "* theorem  9.3.8 ) , @xmath233 is exceptional if and only if it has genus  0 and self - intersection @xmath235 , see below .",
    "let @xmath226 be an arithmetic surface .",
    "if @xmath236 is a closed point and @xmath237 are divisors on @xmath19 without common component , we denote by @xmath238 the rational - valued intersection multiplicity between @xmath239 and @xmath240 ( cf .",
    "@xcite ) ; we simply write @xmath241 if it is clear which @xmath242 we are working over .",
    "if @xmath239 is a vertical divisor on @xmath19 with support in the fiber @xmath234 , then we can use the moving lemma  ( * ? ? ?",
    "* corollary  9.1.10 ) to define the self - intersection @xmath243 ( or @xmath244 ) .",
    "we extend the intersection multiplicity @xmath245 to the group @xmath246 of _ @xmath43-divisors on @xmath19 _ by linearity .",
    "let @xmath247 denote the _ relative dualizing sheaf _ of @xmath19 over @xmath15 .",
    "we call a divisor @xmath248 of @xmath19 such that @xmath249 a _ canonical divisor_. more generally , we call a divisor @xmath250 such that @xmath251 in @xmath252 a _ canonical @xmath43-divisor_. if @xmath253 is an effective nonzero vertical divisor , we define @xmath254 where @xmath255 is the arithmetic genus of @xmath253 .",
    "[ thm : kan ] let @xmath248 be a canonical @xmath43-divisor on @xmath19 and let @xmath256 be an effective vertical divisor on @xmath19",
    ". then we have @xmath257    see  ( * ? ? ?",
    "* theorem  8.1.37 ) for the case @xmath258 .",
    "the extension to @xmath250 is immediate .",
    "we will use the adjunction formula extensively , especially in section  [ sec : int ] .",
    "let @xmath0 be an odd squarefree natural number which is not prime and let @xmath259 be a primitive @xmath0-th root of unity . recall that the fermat curve @xmath260 is defined by @xmath261 let @xmath7 be a prime number such that @xmath262 with @xmath263 and fix a prime ideal @xmath12 of @xmath11 $ ] that lies above @xmath7 .",
    "we denote by @xmath15 the localization of @xmath11 $ ] with respect to @xmath12 . in this section",
    "we construct the minimal regular model of @xmath264 } { \\operatorname{spec}}r$ ] , see theorem  [ thm : f_nmin ] .",
    "let @xmath211 be a uniformizing element of @xmath15 and let @xmath265 denote its residue field , viewed as a subfield of @xmath266 .",
    "we can and will also interpret this element as a uniformizing element of the strict henselization @xmath267 .",
    "consider the model @xmath268/(x^n+y^n - z^n ) \\ , .\\ ] ] to construct the minimal regular model of @xmath264}{\\operatorname{spec}}r$ ] we work with affine open subschemes of @xmath13 .",
    "in particular , we consider the integral affine open subscheme @xmath269/(x^n+y^n-1)\\ ] ] of @xmath13 . for a natural number @xmath139 we will also use @xmath270 to denote the polynomial @xmath271 .",
    "it will be clear from the context whether we refer to the fermat curve or to the polynomial , by abuse of notation .",
    "for the following computations it will be useful to rewrite @xmath272 as @xmath273 where @xmath274 note that there is a unit @xmath275 of @xmath15 such that @xmath276 . using  ,",
    "it can be seen easily that the special fiber of @xmath19 is of the form @xmath277/(f_m^p+p\\psi(x^m , y^m))\\otimes_r k(\\pi))={\\operatorname{spec}}(k(\\pi)[x , y]/f_m^p ) \\ , .\\ ] ] therefore the special fiber consists of a single component @xmath233 , which has multiplicity @xmath7 .",
    "this component  considered as a subset of @xmath19  is the closure of the ideal @xmath278/(x^n+y^n-1)$ ] , so @xmath279 .",
    "the ideal @xmath84 is a prime ideal , as the ring @xmath280/i    \\cong k(\\pi)[x , y]/(x^m+y^m-1)\\ ] ] is integral . because of the regularity of this ring , the closed subscheme @xmath233 is regular .",
    "however , since @xmath281 and @xmath282 , the scheme @xmath19 is singular .",
    "in fact , it is not even normal , because it is not regular in codimension 1 .      in this paragraph",
    "we are going to study the polynomial @xmath283 , see  . in order to do this",
    "we analyze the polynomial @xmath284 and then evaluate it in @xmath285 and @xmath286 later on .",
    "we have the following : @xmath287 substituting @xmath285 for @xmath288 and @xmath286 for @xmath289 we get @xmath290    for later computations it will be important to know the factorization of @xmath283 into irreducibles .",
    "we first recall a result of mccallum  @xcite .",
    "[ lem : poly ] there is a decomposition @xmath291 with a polynomial @xmath292 $ ] . in the prime factorization of @xmath293 over @xmath294",
    ", factors occur with multiplicity one if they are not rational over @xmath295 , and with multiplicity two otherwise .",
    "we elaborate on the proof of the lemma on page 59 of  @xcite .",
    "we have @xmath296 .",
    "the only roots of @xmath297 with multiplicity greater than one are of the form @xmath298 with @xmath299 .",
    "if the multiplicity of @xmath300 were greater than two , then the second derivative would vanish in @xmath300 as well . but from @xmath301 it follows that @xmath302 , so by multiplication with @xmath303 we obtain @xmath304 and this is obviously impossible .",
    "let us denote the root of multiplicity 2 by @xmath305    together with the fact that 0 and 1 are simple roots of @xmath306 and @xmath307 , we get the decomposition@xmath308 over @xmath266 , where @xmath309 . with some irreducible polynomials @xmath310 .",
    "since in this decomposition all factors are pairwise coprime and @xmath311 , the claim follows from hensel s lemma .",
    "[ coro : poly ] there is a decomposition @xmath312 in the prime factorization of @xmath313 over @xmath294 , factors @xmath314 occur with multiplicity 1 if @xmath315 is not rational over @xmath295 , and with multiplicity 2 otherwise .",
    "if we replace @xmath288 by @xmath285 in , it is obvious that we get , since @xmath316 .",
    "a decomposition as in becomes @xmath317 after this substitution ; here @xmath318 and @xmath319 .",
    "since the @xmath320 and @xmath321 from lemma [ lem : poly ] are non - zero , the polynomials @xmath322 and @xmath323 split into coprime linear factors over @xmath266 .",
    "the linear polynomials @xmath324 are the only factors of multiplicity two in @xmath313 over @xmath266 .",
    "[ def : scrw ] let us denote by @xmath325 the number of factors @xmath326 of @xmath327 over @xmath266 .",
    "as @xmath328 is a polynomial of degree @xmath329 , the polynomial @xmath330 is of degree @xmath331 .",
    "corollary [ coro : poly ] tells us that there are @xmath332 linear factors of multiplicity one in @xmath313 .",
    "for instance , let @xmath333 .",
    "then @xmath334 , where @xmath335 is an irreducible element of @xmath336 $ ] .",
    "it follows that in this case @xmath337 . on the other hand , consider the case @xmath338 .",
    "here we have @xmath339 , hence @xmath340 .",
    "we start by giving an explicit description of the blow - up .",
    "[ prop : blowup1 ] let @xmath84 denote the ideal @xmath341/f_n$ ] .",
    "then the blow - up @xmath342 of the scheme @xmath19 in along @xmath91 is given by the affine open subsets @xmath343 and @xmath344 , where @xmath345/(f_m-{{w_{1}}}\\pi,\\pi { { w_{1}}}^p+\\mu\\psi(x^m , y^m))\\ ] ] and @xmath346/({{w_{2 } } } f_m-\\pi , f_m+\\mu { { w_{2}}}^{p-1}\\psi(x^m , y^m ) ) \\ , .\\ ] ] in other words , we have @xmath347 .",
    "the generators of the ideal @xmath84 obviously form a regular sequence in @xmath348 $ ] , since @xmath348 $ ] and @xmath348/\\pi$ ] ( @xmath348/f_m$ ] resp . )",
    "are integral .",
    "therefore we can apply theorem [ thm : reg ] .",
    "the polynomial @xmath349\\right)[{{w_{1}}},{{w_{2}}}]\\ ] ] is homogeneous in @xmath350 and @xmath351 and the coefficient @xmath352 is not in the ideal @xmath84 .",
    "the statement follows now with remark [ rem : blow - up ] .",
    "[ rem : streg ] the scheme @xmath342 can be considered as a subscheme of the scheme @xmath353 , where @xmath354/(f_m-{{w_{1}}}\\pi)\\ ] ] and @xmath355/({{w_{2 } } } f_m-\\pi ) \\ , .\\ ] ] since @xmath356 is just the blow - up of the regular scheme @xmath357 $ ] along @xmath358 , it is regular as well by ( * ? ? ?",
    "* lemma  8.1.4 ) and  ( * ? ? ?",
    "* theorem  8.1.19 ) .",
    "the scheme @xmath342 is the strict transform of @xmath19 in @xmath356 .",
    "[ prop : normalf_n ] the scheme @xmath342 from proposition [ prop : blowup1 ] is normal .",
    "let @xmath359 $ ] be the respective reductions of @xmath360 and @xmath361 with respect to the canonical morphism @xmath348\\rightarrow \\overline{{\\mathbb{f}}}_p [ x , y]$ ] .",
    "the geometric special fiber @xmath362 has configuration as in figure [ fig : normal ] , where the components @xmath363 are of genus @xmath364 and are parameterized by those pairs @xmath365 which satisfy @xmath366    we work with the scheme @xmath367 whose special fiber is a variety over the algebraically closed field @xmath266 .",
    "since this base change is faithfully flat , normality of @xmath368 implies normality of @xmath342 .",
    "we start our computation with the affine open subscheme @xmath369 , where @xmath370 .",
    "the special fiber of this scheme is @xmath371/ ( f_m , \\psi(x^m , y^m))\\right ) \\notag \\\\ & = { \\operatorname{spec}}\\left ( \\overline{{\\mathbb{f}}}_p [ x , y,{{w_{1}}}]/ ( f_m , \\psi(x^m,1-x^m))\\right ) \\ , .\\label{eq:19}\\end{aligned}\\ ] ] this variety consists of lines @xmath372 , where @xmath65 is a root of @xmath373 and @xmath76 is a root of @xmath374 $ ] .",
    "these lines correspond to prime divisors @xmath375 of @xmath376 , where @xmath377 is a prime ideal of height 1 and @xmath378 ( @xmath379 resp . ) . because of remark [ rem : streg ] and proposition [ prop : normal ]",
    ", it suffices to show that @xmath380 is regular at @xmath56 ( since the generic fiber of @xmath368 ( @xmath376 resp . )",
    "is regular , @xmath380 is regular at every prime ideal which does not contain @xmath211 ) . note that @xmath211 can not be a divisor of @xmath381 and of @xmath382 , as @xmath383 .",
    "because of symmetry , we may assume @xmath384 without loss of generality .",
    "we have @xmath385 , where @xmath386 .",
    "now,@xmath387 where @xmath388 $ ] .",
    "it follows from proposition [ prop : blowup1 ] and equation that @xmath389 in @xmath380 , where @xmath390 $ ] .",
    "let us suppose that @xmath391 .",
    "then @xmath392 and ( using hensel s lemma ) we have @xmath393 , where @xmath394 is a root of @xmath395 $ ] . indeed , since @xmath396 the polynomial @xmath397 splits into coprime linear factors in @xmath266 , and this decomposition lifts to @xmath267 .",
    "but if this linear factor is in @xmath56 , then @xmath56 is a maximal ideal ; a contradiction , because @xmath56 was assumed to be of height 1 .",
    "hence we have @xmath398 and so this element becomes a unit in @xmath399 .",
    "we denote this unit by @xmath400 . + note that , since @xmath401 , we have @xmath402 , where @xmath403 .",
    "using proposition [ prop : blowup1 ] , it follows that @xmath404 in @xmath380 .",
    "now , @xmath405 because otherwise @xmath406 or @xmath407 and this is impossible , since these elements are units in @xmath267 . to see this ,",
    "recall that @xmath408 , and that @xmath409 is a divisor of @xmath170 and @xmath170 is coprime to @xmath7 .",
    "therefore @xmath410 is a unit in @xmath399 .",
    "we will denote this unit by @xmath411 . in the localization",
    "@xmath399 we have @xmath412 and @xmath413 hence we have @xmath414 and so @xmath380 is regular at @xmath56 by lemma  [ lemma : reg1 ]",
    ".    we still have to deal with the second affine open subscheme @xmath415 , where @xmath416 .",
    "it suffices to check the regularity of @xmath417 at the prime ideal @xmath418 which corresponds to the component @xmath360 in figure [ fig : normal ] .",
    "but in @xmath417 we even have @xmath419 by proposition [ prop : blowup1 ] , and so this ring is obviously regular at @xmath56 .",
    "we now find the singular closed points of the normal scheme @xmath342 and then resolve these singularities .",
    "we shall see that for the resolution it sufficed to blow up the lines that have singular points lying on them .",
    "since blowing up commutes with flat morphisms , we can work with @xmath368 instead of @xmath342 throughout , as long as we only blow up along ideal sheaves @xmath220 of @xmath368 which are of the form @xmath420 , where @xmath204 is an ideal sheaf of @xmath342 .",
    "before we come to the main result of this section we need to introduce some further terminology .",
    "we continue to use the notation of proposition [ prop : normalf_n ] .",
    "we call a component @xmath421 of @xmath422 _ a component of type @xmath44 _ , if @xmath423 or @xmath424 , and _ a component of type @xmath92 _ , if @xmath65 is a multiple root of @xmath373 different from @xmath364 .",
    "we first find and resolve the singularities on @xmath425 . in the following ,",
    "we call a curve of genus  0 over @xmath426 a _ line_.    [ thm : f_nreg ] let @xmath368 be the normal scheme given by . if we blow up @xmath427-times along the components of type @xmath44 , we get @xmath7 chains consisting of @xmath427 lines ( figure [ fig : thmbild3 ] ) . blowing up along the components of type @xmath92",
    "gives @xmath7 chains consisting of one line ( figure [ fig : thmbild2 ] ) .",
    "the resulting scheme is regular .    for the proof of the theorem",
    "we first need three preparatory lemmata .",
    "[ lem : part1 ] in the notation of proposition [ prop : normalf_n ] , the only singular points of @xmath368 lie on the components @xmath421 of type @xmath44 and of type @xmath92 ( figure",
    "[ fig : thmbild1 ] ) .",
    "we first use the jacobian criterion to locate the singular points on the affine open subset @xmath428 / ( f_m , \\psi(x^m,1-x^m))\\right ) \\,,\\ ] ] see  .",
    "the jacobian matrix is of the form @xmath429 where @xmath430 .",
    "it follows that a closed point @xmath431 is singular if and only if @xmath432 now @xmath433 implies @xmath434 , and so @xmath65 is an @xmath170-th root of unity . in case @xmath435 ,",
    "the element @xmath65 is an @xmath170-th root of an element of @xmath436 or @xmath364 by corollary  [ coro : poly ] .",
    "note that @xmath360 is the only component of the special fiber of @xmath368 which does not lie in @xmath376 . to find its singular points , we work on the affine open subset @xmath437 . a closed point which lies on @xmath360 corresponds to a maximal ideal @xmath438 where @xmath439 , cf .  .",
    "without loss of generality we may again assume @xmath440 .",
    "using arguments similar to those in the proof of proposition [ prop : normalf_n ] combined with , we see that in @xmath417 we have @xmath441 where @xmath442 .",
    "together with the fact that @xmath443 in @xmath417 , this gives us @xmath444 hence @xmath417 is regular at @xmath45 by lemma  [ lemma : reg1 ] .",
    "therefore there are no singular points lying on components which are not of type @xmath44 or of type @xmath92 .",
    "lemma [ lem : part1 ] shows us that we have to focus on the components of type @xmath44 and of type @xmath92 . let us analyze the former .",
    "a component @xmath445 of type @xmath44 corresponds to a prime ideal @xmath446 there is an affine open neighborhood @xmath447 of @xmath56 with the property that @xmath448 and @xmath449 . to be more precise",
    ", we have @xmath450 , where @xmath60 is the product of the @xmath451 with @xmath452 .",
    "then we may take @xmath44 to be @xmath453 where @xmath454/(f_m-{{w_{1 } } } \\pi)\\right)_f\\ ] ] is the localization of @xmath455 with respect to the set @xmath456 .",
    "hence @xmath447 is isomorphic to the principal open subset @xmath457 of @xmath376 .",
    "note that , as @xmath56 is a regular prime ideal of height one , it is possible to find an affine open neighborhood @xmath458 so that @xmath56 is generated by one element in this neighborhood .",
    "unfortunately @xmath458 does not contain @xmath375 .",
    "next , we study schemes which naturally appear as blow - ups of the scheme @xmath459 .",
    "[ lem : part2 ] let @xmath460 with @xmath461 and @xmath462/(\\pi - t_l x^l , g_l ( t_l ) ) \\ , , \\ ] ] where @xmath463 furthermore , let @xmath464 .",
    "then @xmath465 is normal ; the configuration of the special fiber of @xmath465 is given in figure [ fig : a_l ] .",
    "the only components of the special fiber which correspond to prime ideals that contain @xmath4 are given by @xmath466 and @xmath445 .",
    "if @xmath467 , there are no singular closed points lying on these components . if @xmath468 , the only singular closed points are the points where the components @xmath469 intersect the component @xmath445 .",
    "first of all note that @xmath465 is a closed subscheme of the regular integral scheme @xmath470/(\\pi - t_l x^l)$ ] . to see that @xmath471 is integral and regular one may observe that even the ring @xmath472/(f_m -{{w_{1}}}\\pi ,",
    "\\pi -t_l x^l)\\ ] ] has these properties : we have that @xmath473 is a regular sequence in the integral ring @xmath474/(f_m-{{w_{1 } } } \\pi)$ ] , so the ring @xmath92 is one of the rings we get if we blow up @xmath474/(f_m-{{w_{1 } } } \\pi)$ ] along the ideal @xmath475 , see lemma [ lem : reg3 ] .",
    "it follows that @xmath92 is integral by lemma [ lem : reg1 ] . to see the regularity we use the jacobian criterion and find that the only maximal ideals which can be singular are of the form @xmath476 where @xmath477 and @xmath478 .",
    "we have the chain of prime ideals @xmath479 on the other hand , @xmath480 .",
    "this gives us @xmath481 , hence the regularity of @xmath482 .",
    "it follows from lemma  [ lemma : reg4 ] that @xmath92 is regular .",
    "let us return to the scheme @xmath465 and show that it is normal . in order to do this",
    "we may first consider the affine open subscheme @xmath483 , where @xmath484 is the localization of @xmath485 with respect to the set @xmath486 the special fibers of @xmath487 and of @xmath465 have the same configuration , except that @xmath487 does not include components corresponding to prime ideals that contain @xmath4 and @xmath211 . an easy computation shows that @xmath488 ( cf .  ) , where @xmath489 is the multiplicative subset @xmath490 .",
    "it follows that @xmath487 is normal and that its special fiber has the same configuration as the special fiber of @xmath491 after removing the components @xmath421 with @xmath423 , cf .",
    "proposition [ prop : normalf_n ] .",
    "next , let us analyze the components of the special fiber of @xmath465 that do not lie in @xmath487 . for a prime ideal @xmath492",
    "such that @xmath493 we have @xmath494 hence the only prime ideals of height one with this property are @xmath495 where @xmath496 and @xmath497 is an element of @xmath267 satisfying @xmath498 .",
    "note that @xmath56 can only contain one of the elements @xmath499 , @xmath350 or @xmath500 , because otherwise @xmath501 or @xmath56 is a maximal ideal , hence it is of height 2 .",
    "since @xmath502 in @xmath485 it follows from and that @xmath503 , and therefore that @xmath465 is normal . + let @xmath504 be a maximal ideal of @xmath485 such that @xmath505 ( note that @xmath506 since @xmath502 in @xmath485 ) .",
    "it follows from and that @xmath507 and so we may assume without loss of generality that @xmath508 or @xmath509 .",
    "since the factors @xmath510 are pairwise coprime , and   show us that @xmath511 is contained in the ideal of @xmath512 which is generated by @xmath4 and @xmath513 .",
    "hence the ring @xmath485 is regular at @xmath45 .",
    "next , let @xmath514 , where @xmath511 is coprime to all of the factors in . then @xmath515 becomes a unit in the localization with respect to @xmath45 .",
    "again ,   and   yield @xmath516 and therefore the regularity of @xmath485 at @xmath45 .    finally , we consider the case @xmath517 , where @xmath508 or @xmath518 for some integer @xmath519 .",
    "we may distinguish here between two cases . in case @xmath467 , we have @xmath520 in @xmath521 ; here @xmath522 $ ] is the polynomial given by @xmath523 obviously we have @xmath524 . if the term in parentheses on the right - hand side of were contained in @xmath45 , then we would have @xmath525 a contradiction .",
    "hence this term becomes a unit in @xmath526 , and we have @xmath527 in other words , @xmath521 is regular at @xmath45 . + now consider the case @xmath528 .",
    "let @xmath529 be the prime ideal of the regular ring @xmath530/(\\pi - t_l x^l)$ ] which is given by the preimage of @xmath45 .",
    "since @xmath531 in @xmath530/(\\pi - t_l x^l)$ ] , we have @xmath532 , which yields @xmath533 hence @xmath485 is singular at @xmath45 .",
    "let us denote the components which correspond to the prime ideals @xmath534 and @xmath535 for @xmath496 by @xmath536 . the configuration of @xmath537 is given in figure [ fig : a_l ] .",
    "[ lem : part3 ] we use the notation from lemma [ lem : part2 ] .",
    "let @xmath468 .",
    "if we blow up along the ideal @xmath538 the resulting scheme is covered by the affine open subset @xmath539 ( cf .",
    "lemma [ lem : part2 ] ) and an affine open subset @xmath540 .",
    "the configuration of the special fiber is given by figure [ fig : a_l ] ( replacing @xmath541 by @xmath542 ) in @xmath539 and by figure [ fig : tildea_l+1 ] in @xmath543 . the scheme",
    "@xmath543 is regular .",
    "we blow up along the ideal @xmath538 . setting @xmath544 ,",
    "one affine open subset of the blow - up is isomorphic to @xmath545 , where @xmath546/ ( \\pi - t_l^{l+1}\\widetilde{x}^l , \\widetilde{x } t_l- x , \\widetilde{g}_l ( \\widetilde{x } ) ) \\cong a_l \\left[{x}{t_l}^{-1 } \\right ] \\ , , \\ ] ] and @xmath547 a prime ideal @xmath84 which contains @xmath211 also contains @xmath4 and @xmath548 , since @xmath549 or @xmath550 .",
    "furthermore , in case @xmath550 , we have @xmath551 .",
    "hence , the prime ideals of height 1 which contain @xmath89 are of the form @xmath552 , where @xmath553 is one of the factors in .",
    "we denote these prime ideals by @xmath554 . in case",
    "@xmath555 we have @xmath556 as well .",
    "we denote the prime ideals @xmath557 by @xmath558 .",
    "a maximal ideal @xmath45 of @xmath559 is of the form @xmath560 ( @xmath561 resp . ) .",
    "if we localize with respect to this ideal , the corresponding ideal in the localization is generated by @xmath89 and @xmath562 ( @xmath499 and @xmath563 resp . )",
    ", hence the ring is regular at @xmath45 . since these are the only maximal ideals of this ring , the ring itself is regular by lemma  [ lemma : reg4 ] .",
    "the blow - up - morphism @xmath564 is an isomorphism away from @xmath565 .",
    "the components @xmath469 of @xmath465 are the images of the components which correspond to the prime ideals @xmath566 therefore we denote these components by @xmath469 as well .",
    "the components which lie above the singular points are denoted by @xmath567 .",
    "they correspond to the prime ideals @xmath568 .",
    "then the special fiber has the configuration as in figure [ fig : tildea_l+1 ] .",
    "the component @xmath469 intersects the component @xmath567 in the point corresponding to some @xmath569 .",
    "let us now take a look at the other affine open subset of the blow - up .",
    "setting @xmath570 , we get @xmath571\\cong s[t_l , t_{l+1}]/(\\pi -t_{l+1}x^{l+1 } , t_{l+1}x - t_l , g_{l+1}(t_{l+1}))= a_{l+1 } \\ , .\\ ] ] note that the components @xmath567 of @xmath572 are the components @xmath567 of @xmath545 .",
    "theorem [ thm : f_nreg ] according to lemma [ lem : part1 ] the only singular points are closed points on the components of type @xmath44 and type @xmath92 .",
    "let @xmath445 be a component of type @xmath44 that corresponds to a prime ideal @xmath573 .",
    "we work in the affine open subset @xmath574 , where @xmath44 is the ring of .",
    "we blow up @xmath447 along @xmath575 .",
    "since @xmath449 , the blow - up is covered by two affine open subsets .",
    "setting @xmath576 , the first one is given by @xmath577 .",
    "the only new components are @xmath578 , cf .",
    "figure [ fig : a_l ] with @xmath579 . setting @xmath580 ,",
    "the second subset is @xmath581/ ( x_1 \\pi - x , g(x_1 ) ) \\ , , \\ ] ] where @xmath582 here we only have to study the prime ideals @xmath45 such that @xmath583 , since all the others that lie above @xmath211 can be found in @xmath577 .",
    "we have @xmath584 in @xmath585/(x_1 \\pi - x , g(x_1))$ ] , where @xmath586 $ ] .",
    "it follows that @xmath587 , which implies @xmath588 for some @xmath589 ; here @xmath590 satisfies @xmath498 .",
    "the prime ideal @xmath45 is of the form @xmath591 ( @xmath592 resp . ) , hence maximal .",
    "in fact , they are the `` end points '' of the components @xmath593 .",
    "since the factors in are pairwise coprime , @xmath594/ ( x_1 \\pi -x , g(x_1))\\right)_{\\mathfrak{m}}\\ ] ] is generated by two elements , hence @xmath585/ ( x_1 \\pi -x , g(x_1))$ ] is regular at @xmath45 .",
    "there are @xmath7 singular closed points lying on @xmath445 ( lemma [ lem : part2 ] ) .",
    "if we blow up this line , we get further components @xmath595 by lemma  [ lem : part3 ] .",
    "there are no singular closed points lying on the @xmath593 , see lemma  [ lem : part3 ] .",
    "lemma  [ lem : part2 ] implies that the only singular closed points that lie on the @xmath596 or the line @xmath445 are the points where the @xmath596 intersect @xmath445 .",
    "it is clear that repeating this process ( i.e. blowing up the component @xmath445 ) @xmath597 times gives the resolution of the singularities that lie on this component , and therefore yields the configuration we claimed . by symmetry",
    "we can argue analogously for components of type @xmath44 which correspond to prime ideals of the form @xmath598 .",
    "finally , a similar ( but simpler , since no inductive argument is needed ) computation shows that we have to blow up the components of type @xmath92 only once , yielding the remaining assertions of the lemma .",
    "having located and resolved the singularities of @xmath425 , we can now describe the minimal regular model of @xmath3 over @xmath15 .",
    "[ thm : f_nmin ] let @xmath0 be an odd squarefree natural number which has at least two prime factors , @xmath259 a primitive @xmath0-th root of unity and @xmath262 , where @xmath7 is prime and @xmath263 . furthermore , let @xmath15 be the localization of @xmath11 $ ] with respect to a fixed prime ideal @xmath599 $ ] that lies above @xmath7 .",
    "we denote by @xmath600 the minimal regular model of the fermat curve @xmath3 over @xmath15",
    ". then the geometric special fiber @xmath601 has the configuration as in figure [ fig : minmodel ] ; table [ tabular : quant ] contains the number , multiplicity , genus and self - intersection of the components .",
    "finally , all intersection between components of the geometric special fiber are transversal .",
    ".@xmath325 denotes the number of factors with multiplicity two of @xmath313 over @xmath266 ( cf .",
    "definition [ def : scrw]).[tabular : quant ] [ cols=\"^,^,^,^,^\",options=\"header \" , ]     let us denote by @xmath248 a canonical divisor of @xmath602 . by the adjunction formula ( cf .",
    "theorem  [ thm : kan ] ) and by properties of the intersection matrix of @xmath603 ( see for instance  ( * ? ? ? * proposition  8.1.21 , proposition  8.1.35 ) ) we have @xmath604 hence the intersections are transversal if and only if @xmath605 using the quantities of table [ tabular : quant ] and the table for the @xmath606 we get @xmath607 and @xmath608 we have @xmath609 and @xmath610 which yields   and therefore the transversality of the intersections .",
    "+ since we know the intersection numbers and the configuration of the geometric special fiber , one can use that @xmath611 to get the self - intersection number of a component @xmath612 .",
    "+ finally , since there are no exceptional divisors by castelnuovo s criterion  ( * ? ? ?",
    "* theorem  9.3.8 ) , @xmath602 is already the minimal regular model .",
    "[ sqfpr ] if we consider the case @xmath613 , so that @xmath614 is prime , then the model constructed in theorem  [ thm : f_nmin ] remains regular .",
    "however , the component @xmath615 is an exceptional divisor , so the model is not minimal .",
    "contracting @xmath616 yields the minimal regular model of @xmath27 over @xmath15 , see  @xcite .",
    "we can use theorem  [ thm : f_nmin ] to analyze the singularities of the normalization @xmath617 of the scheme @xmath618/(x^n+y^n - z^n ) \\ , .\\ ] ] recall that a normal and excellent two - dimensional scheme @xmath19 has _ rational singularities _",
    ", if for one ( and hence every ) desingularization @xmath619 , we have @xmath620 for all @xmath621 .",
    "see  @xcite .",
    "the normal scheme @xmath617 has rational singularities .",
    "it follows from the proofs of theorems  [ thm : f_nreg ] and  [ thm : f_nmin ] that there is a desingularization @xmath622 .",
    "let @xmath623 be a singular point and @xmath624 the components of @xmath625 with @xmath626 . according to  ( * ? ? ?",
    "* theorem  3 ) , @xmath627 is a rational singularity if and only if the fundamental cycle @xmath628 with respect to @xmath627 , also defined in  @xcite , satisfies @xmath629 . using theorem [ thm : f_nmin ] , we find that @xmath630 the adjunction formula together with an inductive argument yields @xmath631 finally , it is not hard to see  using the configuration described in theorem [ thm : f_nmin ]  that @xmath632 .",
    "[ rem : other ] the computation of local minimal regular models of fermat curves of squarefree even or squareful exponent is more involved . see  ( * ? ? ?",
    "* chapter  7 ) for a summary of the problems one encounters and possible strategies for dealing with them .",
    "let @xmath0 be an odd squarefree composite integer .",
    "in this section we turn to the global situation ; we construct the minimal regular model of @xmath3 over @xmath11 $ ] , where @xmath259 is a primitive @xmath0-th root of unity .",
    "the following result shows that it essentially suffices to localize at the primes @xmath12 of @xmath11 $ ] dividing @xmath0 .",
    "[ prop : goodprimes ] let @xmath19 be the fermat scheme @xmath633 [ x , y]/(x^n+y^n-1 ) \\ , .\\ ] ] if @xmath12 is a prime ideal of @xmath11 $ ] not dividing @xmath0 , then @xmath19 is regular at @xmath12 .",
    "we have a morphism @xmath634 $ ] which corresponds to the ring homomorphism @xmath635 \\rightarrow { \\mathbb{z}}[\\zeta_n ] [ x , y]/(x^n+y^n-1)\\ ] ] where @xmath636 is the composition of the inclusion @xmath11 \\rightarrow { \\mathbb{z}}[\\zeta_n][x , y]$ ] and the canonical surjection @xmath11[x , y]\\rightarrow{\\mathbb{z}}[\\zeta_n ] [ x , y]/(x^n+y^n-1)$ ] .",
    "the scheme @xmath19 is integral , @xmath637 is a dedekind scheme , and @xmath74 is non - constant , hence the morphism @xmath74 is flat , see e.g. @xcite , p.137 : corollary 3.10 . ) .",
    "we want to show that @xmath19 is regular at a prime ideal @xmath638 if @xmath639 . to see this we start with a prime ideal @xmath12 with @xmath640 .",
    "then this prime ideal is the image of an element of @xmath641/(x^n+y^n-1)$ ] with respect to the obvious morphism @xmath642 .",
    "since this morphism is flat and @xmath643 is regular it follows that @xmath19 is regular at @xmath12 ( see e.g. @xcite , p.143 : corollaire 6.5.2 . ) .",
    "next , let @xmath12 be a prime ideal with @xmath644 , where @xmath645 is a prime in @xmath11 $ ] .",
    "since @xmath637 is regular , we only have to concentrate on the fiber @xmath646/(x^n+y^n-1)$ ] , where @xmath647 is the residue field of @xmath645 ( lemma  [ lemma : reg2 ] ) .",
    "we use the jacobian criterion to analyze the scheme @xmath648 . for simplicity",
    "we may change to the _ geometric special fiber _",
    "@xmath649/(x^n+y^n-1)$ ] .",
    "since the inclusion morphism @xmath650 is faithfully flat , the projection morphism @xmath651 is faithfully flat as well .",
    "hence , if @xmath652 is regular , then @xmath648 is regular , see remark  [ rk : ffreg ] .",
    "now let us assume that @xmath653 .",
    "then the rank of the jacobian matrix @xmath654 is 1 for all points of @xmath652 and so @xmath652 is regular by the jacobian criterion and by ( * ? ? ?",
    "* corollary  4.2.17 . ) , hence @xmath19 is regular in @xmath12 ( lemma  [ lemma : reg2 ] ) . if @xmath655 then the jacobian matrix is zero and it follows that @xmath652 is singular at all points .",
    "in this situation lemma  [ lemma : reg2 ] does not tell us , if @xmath19 is regular at @xmath12 .",
    "we now use theorem  [ thm : f_nmin ] and proposition  [ prop : goodprimes ] to determine the minimal regular model of @xmath3 over @xmath11 $ ] .",
    "let @xmath656\\subset { \\operatorname{spec}}{\\mathbb{z}}[\\zeta_n]$ ] be the open subset consisting of the prime ideals @xmath12 with @xmath657 .",
    "we set @xmath658 } u$ ] , where @xmath659 [ x , y , z]/(x^n+y^n - z^n)\\ , ; \\ ] ] the scheme @xmath660 is regular by proposition [ prop : goodprimes ] . for a prime ideal @xmath12 with @xmath661 , recall the minimal regular model @xmath625 from theorem [ thm : f_nmin ] , where @xmath662 .",
    "[ coro : f_nmin ] the minimal regular model @xmath32 of the fermat curve @xmath3 over @xmath663 $ ] can be obtained by gluing the scheme @xmath660 and all the @xmath625 , where @xmath12 runs through all primes of @xmath11 $ ] dividing @xmath0 .",
    "it follows from general descent theory ( cf .",
    "* chapter  6 ) ) that we can glue @xmath660 and the @xmath625 to get a regular model of @xmath3 over @xmath664)$ ] . see  ( * ? ? ?",
    "* corollary  2.3.5 ) for a precise statement .",
    "this model is indeed the minimal regular model , since it contains no exceptional divisors by castelnuovo s criterion  ( * ? ? ?",
    "* theorem  9.3.8 ) .",
    "throughout this section we let @xmath21 be a number field , @xmath20 its ring of integers and @xmath665 an arithmetic surface whose generic fiber @xmath4 has genus @xmath666 .",
    "see soul  @xcite and  @xcite for the definitions and results on intersection multiplicities between hermitian line bundles that we need in the following .",
    "in fact , we will only encounter intersection multiplicities between certain special hermitian line bundles . on the one hand",
    ", we consider hermitian line bundles @xmath667 , where @xmath668 is a vertical divisor on @xmath19 with the sum running over all closed points @xmath669 , and the metric is trivial .",
    "for instance , we then have @xmath670 on the other hand , we consider the hermitian line bundle @xmath671 , where @xmath672 is the relative dualizing sheaf of @xmath19 over @xmath20 and @xmath673 is the _ arakelov metric _ , i.e. the unique metric on @xmath674 such that the arakelov adjunction formula holds , see  @xcite .",
    "the goal of part  ii is to bound @xmath675 in terms of @xmath0 when @xmath19 is the minimal regular model of a fermat curve of odd squarefree exponent @xmath0 over @xmath11 $ ] .",
    "[ omega_comp ] instead of @xmath672 , some authors prefer to work with the relative dualizing sheaf @xmath676 , also equipped with the arakelov metric .",
    "we have @xmath677 therefore @xmath678 so that bounds on @xmath679 are easily translated into bounds on @xmath680 and vice versa .",
    "we first recall a method for the computation of an upper bound on @xmath674 due to khn  @xcite .",
    "let @xmath681 be an arithmetic surface with generic fiber @xmath68 .",
    "fix @xmath682 such that @xmath683 is hyperbolic . in this section",
    "we assume that the arithmetic surface @xmath684 comes equipped with a dominant morphism @xmath685 of degree @xmath134 such that the induced morphism @xmath686 is unramified outside @xmath687 .",
    "we write @xmath688 and set @xmath689 .",
    "we call a prime @xmath12 _ bad _ if the fiber @xmath690 of @xmath19 above @xmath12 is reducible , in which case @xmath690 is called a _",
    "bad fiber_. khn has shown how to bound @xmath691 in terms of data which depends only on @xmath21 , on @xmath68 , on @xmath692 and on the configuration of the bad fibers of @xmath19 .",
    "let @xmath248 be a canonical @xmath43-divisor of @xmath19 .",
    "for each @xmath693 we can find a @xmath43-divisor @xmath694 such that @xmath695 for all vertical irreducible components @xmath696 of @xmath19 .",
    "similarly we can find , for each @xmath693 , a @xmath43-divisor @xmath697 such that for all vertical irreducible components @xmath696 we have @xmath698 where @xmath699 is the zariski closure of @xmath700 in @xmath637 and @xmath242 is a section of @xmath701 .",
    "we define @xmath702 where the line bundles carry the trivial metric .",
    "[ thm : keyformula ] let @xmath685 be as above .",
    "if all @xmath693 are @xmath21-rational points and all divisors of degree zero supported in the @xmath693 are torsion , then the arithmetic self - intersection number of the dualizing sheaf @xmath703 on @xmath19 satisfies the inequality @xmath704",
    "\\left (   \\kappa_1 \\log b_{\\max } + \\kappa_2 \\right ) + \\sum_{{\\mathfrak{p}}\\,\\,{\\rm bad } } a_{\\mathfrak{p}}\\log{\\operatorname{nm}}({\\mathfrak{p } } )     \\right),\\end{aligned}\\ ] ] where @xmath705 are positive real constants that depend only on @xmath68 and the points @xmath706 .",
    "this follows from ( * ? ? ?",
    "* theorem  i ) and  .",
    "the real number @xmath707 is called the _",
    "geometric contribution_. upper bounds for the geometric contribution which are easily computed from the configuration of the special fibers of @xmath19 can be found in  @xcite .",
    "the real number @xmath708   \\left (   \\kappa_1 \\log b_{\\max } + \\kappa_2    \\right)$ ] is called the _",
    "analytic contribution_.      let @xmath709 be a rational point with zariski closure @xmath710 and let @xmath711 denote a vertical @xmath43-divisor such that @xmath712 holds for all vertical irreducible components @xmath233 of @xmath19 , where @xmath713 is defined in .",
    "such a @xmath43-divisor exists by  ( * ? ? ?",
    "* proposition  2.1 ) . according to  (",
    "* corollary  2.3 ) , we can also find , for every vertical irreducible component @xmath714 of @xmath19 , a vertical @xmath43-divisor @xmath715 such that @xmath716 holds for all vertical irreducible components @xmath233 of @xmath19 , where @xmath717 is the multiplicity of @xmath714 in the special fiber of @xmath19 containing it and @xmath718 is the kronecker delta on the set of irreducible components .",
    "we set @xmath719 and @xmath720 where the vertical line bundles are equipped with the trivial metric . in  @xcite ,",
    "khn and the second author used this to find a method for computing a lower bound for @xmath721 .",
    "[ thm : km ] with notation as above , suppose that    a.   @xmath722 is a canonical divisor on @xmath4 ; b.   we have @xmath723 for all vertical irreducible components @xmath233 of @xmath19 .",
    "then we have @xmath724    see proposition  1.2 and theorem  1.3 of  @xcite .",
    "one can show that in favorable situations ( for instance , when @xmath19 has only reduced special fibers and at least one of its special fibers is reducible ) , condition ( i ) can be dropped and condition ( ii ) is always satisfied and that @xmath725 is a positive lower bound for @xmath726 .",
    "however , for our intended application to @xmath727 , we will have to check conditions ( i ) and ( ii ) and the positivity of @xmath725 .",
    "let @xmath0 be an odd squarefree natural number which has at least two prime factors , let @xmath259 be a primitive @xmath0-th root of unity and let @xmath260 denote the fermat curve  .",
    "the minimal regular model @xmath40 of @xmath3 over @xmath728 was constructed in part  i. in order to bound @xmath729 using theorems  [ thm : keyformula ] and  [ thm : km ] we need to show that these results are indeed applicable and we need to compute the quantities appearing in their statements .",
    "we recall the following notation from section  [ sec : curilla ] : let @xmath262 , where @xmath7 is prime and @xmath263 .",
    "fix a prime @xmath12 of @xmath11 $ ] above @xmath7 and let @xmath15 be the localization of @xmath11 $ ] with respect to @xmath12 .",
    "the minimal regular model @xmath600 of the fermat curve @xmath3 over @xmath15 is described explicitly in theorem  [ thm : f_nmin ] .",
    "we will mostly work on the base change @xmath730 , where @xmath267 is the strict henselization of @xmath15 .",
    "we denote the special fiber of this model by @xmath731 .",
    "consider the galois covering @xmath732 of degree @xmath733 given by @xmath734 .",
    "in fact @xmath735 is a belyi morphism , because it is a unramified outside @xmath736 , and is defined over @xmath43 with ramification orders all equal to @xmath0 ; see  @xcite for a discussion of the associated belyi uniformization . in ",
    "[ sec : upper_fermat ] , we will use @xmath735 to compute an upper bound on @xmath30 using theorem  [ thm : keyformula ] .",
    "we call the ramification points of @xmath735 the _ cusps _ of @xmath3",
    ". a divisor on @xmath4 is called _ cuspidal _ if all points in its support are cuspidal .",
    "we now investigate the zariski closures of the cusps inside the minimal regular model .",
    "[ nota : cusp ] assume that we have fixed a primitive @xmath0-th root of unity @xmath259 .",
    "then we denote by @xmath737 ( @xmath738 , @xmath739 , resp . ) the cusp @xmath740 ( @xmath741 , @xmath742 , resp . ) .",
    "if the properties of the cusp , which are relevant for our consideration , do not depend on the exponent @xmath109 we drop the subscript and just write @xmath743 ( @xmath744 , @xmath745 , resp . ) . for a normal model of the fermat curve",
    "the zariski closure of a cusp gives us a horizontal prime divisor .",
    "if there is no danger of confusion which normal model we consider we denote by @xmath746 , etc .",
    "the zariski closure of @xmath747 , etc .",
    "[ justi2 ] let @xmath54 be a cusp of @xmath3 and @xmath748 the horizontal divisor obtained by taking the zariski closure of @xmath54 in @xmath749 .",
    "then @xmath748 only intersects one component of the geometric special fiber , namely one of the @xmath750 , see figure  [ fig : minmodel ] .",
    "this intersection is transversal .",
    "we use notation [ nota : cusp ] . by symmetry , we assume without loss of generality that @xmath751 for some @xmath109 . if we take the zariski closure of @xmath54 in @xmath752/(x^n+y^n - z^n)\\ , , \\ ] ] we get a horizontal divisor @xmath753 which corresponds to the prime ideal @xmath754 .",
    "it intersects the special fiber in the point @xmath755 .",
    "now our minimal regular model @xmath749 comes with a birational morphism @xmath756 in fact , @xmath60 is just the composition of the blow - ups described in proposition [ prop : blowup1 ] , theorem [ thm : f_nreg ] and theorem [ thm : f_nmin ] .",
    "we have @xmath757 where @xmath758 , see for instance ( * ? ? ?",
    "* remark  9.1.31 ) .",
    "it follows that @xmath759 is reduced to a point @xmath627 and that @xmath627 belongs to a single irreducible component which is of multiplicity one , cf .",
    "* corollary  9.1.32 ) .",
    "furthermore , shows that @xmath748 intersects this component transversally , see ( * ? ? ?",
    "* proposition  9.1.8 ) . on the other hand",
    ", we have @xmath760 .",
    "but @xmath761 consists of one component @xmath762 and @xmath7 chains of components @xmath763 , where a component @xmath764 intersect the component @xmath762 , cf .",
    "figure  [ fig : minmodel ] . as the only components of @xmath761 of multiplicity one are the @xmath750 s , @xmath627 must lie on one of them .",
    "[ rem : urbild ] in analogy with proposition  [ justi2 ] , the horizontal divisor that corresponds to a cusp @xmath738 ( @xmath739 resp . )",
    "intersects a component @xmath750 that lies in @xmath765 ( @xmath766 resp . ) , where @xmath767 and @xmath768 , and no other component .    since there are @xmath769 components @xmath750 and @xmath769 cusps it seems plausible that each @xmath750 is intersected by exactly one horizontal divisor which comes from a cusp .",
    "we show in the next proposition that this is indeed the case .",
    "let @xmath54 and @xmath770 be cusps of @xmath3 and denote by @xmath748 and @xmath771 the associated horizontal divisors of @xmath625 .",
    "suppose that @xmath748 ( @xmath771 , resp . )",
    "intersects the component @xmath772 ( @xmath773 , resp . ) .",
    "then we have @xmath774 if and only if @xmath775 .",
    "it is clear that @xmath776 if @xmath777 .",
    "conversely , suppose that @xmath778 , but @xmath775 . according to remark [ rem : urbild ] we may assume without loss of generality that @xmath751 and @xmath779 with @xmath780 .",
    "the morphism @xmath60 in factors as @xmath781 , where @xmath782 is the blow - up of @xmath13 along @xmath783 .",
    "the scheme @xmath782 is covered by @xmath342 and @xmath784 ( see the beginning of the proof of theorem [ thm : f_nmin ] ) and its special fiber consists of the components @xmath785 and @xmath786 .",
    "according to our assumption we must have @xmath787 , where @xmath627 is a closed point which lies in the special fiber of @xmath782 ; this follows because all the components @xmath788 are blown down to points by @xmath789 .",
    "in fact @xmath627 is a singular point which lies in the affine open subscheme @xmath342 defined in proposition [ prop : blowup1 ] . by   and",
    "the proof of lemma [ lem : part1 ] , all singular points of @xmath342 lie in @xmath790 , so we can restrict our attention to this affine open subset . because @xmath791 in @xmath792 , an easy computation shows that @xmath793 and @xmath794 ( note that @xmath795 or @xmath796 since @xmath797 is a primitive @xmath7-th root of unity ) .",
    "let @xmath45 be the maximal ideal of @xmath792 such that @xmath798 .",
    "then @xmath799 and since @xmath506 , we must have @xmath800 . indeed , let us assume that @xmath7 divides @xmath801 .",
    "then the order of @xmath802 is coprime to @xmath7 and therefore @xmath45 contains a natural number coprime to @xmath7 , leading to a contradiction . on the other hand , since @xmath803 we have @xmath804 , hence @xmath805 .",
    "this gives us another contradiction and shows that @xmath774 .      in this paragraph",
    "we define and study some @xmath43-divisors on @xmath806 .",
    "these will be used to compute the geometric contribution in the upper bound given by theorem  [ thm : keyformula ] and the lower bound @xmath725 in theorem  [ thm : km ] .",
    "the results are quite technical and the proofs consist mainly of straightforward , but lengthy calculations . recall that @xmath807 denotes the set of irreducible components of the special fiber @xmath808 and that @xmath809 where the components @xmath612 and their multiplicities @xmath810 are given in figure  [ fig : minmodel ] and table  [ tabular : quant ] .",
    "[ nota : comp ] we use the notation from theorem [ thm : f_nmin ] .",
    "let us fix a cusp @xmath54 and a corresponding horizontal divisor @xmath748 .",
    "we know that @xmath748 intersects precisely one of the component of the special fiber ; in fact it must be one of the components @xmath750 ( proposition [ justi2 ] ) .",
    "in the geometric special fiber @xmath811 there are @xmath812 components @xmath762 . to distinguish between these components we will number them and denote by @xmath813 the @xmath109-th one of the @xmath762 . now for each component @xmath813 there are @xmath7 chains of components @xmath814 , where the @xmath764 intersect @xmath813 . again",
    ", we will number these chains .",
    "we denote the components of the chains by @xmath815 , where the first subscript @xmath816 indicates that it is one of the components @xmath817 , the second subscript @xmath818 means that it is a component of the @xmath818-th chain , and the superscript @xmath819 indicates that the chain is attached to @xmath813 . in the same way we proceed with the components @xmath820 and @xmath786 .",
    "we will number them and denote them by @xmath821 and @xmath822 .",
    "the components @xmath823 will be denoted by @xmath824 , where the superscript @xmath109 indicates that @xmath824 intersects @xmath825 . without loss of generality",
    "we assume that we fixed this numbering so that @xmath748 intersects the component @xmath826 .",
    "we now define the following vertical @xmath43-divisors on @xmath827 : @xmath828    recall that if @xmath233 is an irreducible component of @xmath811 , then we have @xmath829 by the adjunction formula ( theorem  [ thm : kan ] ) , where @xmath830 and @xmath248 is a canonical @xmath43-divisor of @xmath831 .",
    "[ lem : v_c ] let @xmath832 be an irreducible component of @xmath811 .",
    "then we have @xmath833 for all @xmath612 , where @xmath718 is the kronecker delta on @xmath807 .",
    "this can be verified by a straightforward computation using theorem  [ thm : f_nmin ] .",
    "next we compute the self - intersections of the @xmath43-divisors @xmath834 .",
    "let us denote @xmath835    [ lem : v_cints ] we have @xmath836    we obviously have @xmath837 . for the other components",
    "@xmath832 , we can write @xmath838 and compute @xmath839 alternatively , we can write @xmath840 and use lemma  [ lem : v_c ] , which implies @xmath841 either one of these formulas leads to a straightforward proof of the assertion .",
    "recall that we have fixed a cusp @xmath54 whose zariski closure @xmath748 in @xmath39 intersects the component @xmath842 , and no other @xmath612 .",
    "setting @xmath843 lemma  [ lem : v_c ] implies @xmath844 for all @xmath612 .",
    "note that we have @xmath845 where @xmath846 the @xmath43-divisor @xmath847 will be play a crucial part in section  [ sec : upper ] .",
    "on the one hand , it will be used to construct the divisors @xmath694 ( defined in  ) whose self - intersections appear in theorem  [ thm : keyformula ] .",
    "on the other hand , the lower bound @xmath725 from theorem  [ thm : km ] is defined using @xmath848 .",
    "we start by analyzing the intersections of @xmath848 with the @xmath43-divisors @xmath849 for @xmath612 .",
    "[ lem : v_dints ] we have @xmath850 where @xmath718 is the kronecker delta on @xmath851 .    the proof is similar to the proof of lemma  [ lem : v_cints ] .",
    "namely , if @xmath852 , then lemma  [ lem : v_c ] implies @xmath853 using this , the proof consists of elementary computations .",
    "we now use the vertical @xmath43-divisors @xmath854 to define another vertical @xmath43-divisor @xmath855    [ lem : udform ] we have @xmath856    this is a simple computation using lemma  [ lem : v_cints ] and lemma  [ lem : v_dints ] .    as a corollary",
    ", we get the following result on the intersection multiplicities between @xmath857 and the components @xmath612 .",
    "[ lem : rel_semipos ] if @xmath233 is an irreducible component of @xmath811 , then we have",
    "@xmath858    we only show the claim for @xmath859 . using lemma  [ lem : udform ] , we find @xmath860 and hence @xmath861 the other cases are similar and are left to the reader .",
    "let us define @xmath862 where @xmath248 is a canonical @xmath43-divisor of @xmath831 .",
    "summing up all @xmath863 as @xmath12 runs through the bad primes of @xmath20 , we will get a lower bound for @xmath30 in   [ sec : lower_fermat ] using theorem  [ thm : km ] .",
    "[ prop : beta_s ] we have @xmath864    applying lemma",
    "[ lem : udform ] , we see that @xmath865 a simple computation shows @xmath866 using the adjunction formula , it is easy to see that @xmath867 the result follows from   and  .",
    "[ rk : v_sindep ] suppose that @xmath54 is a cusp whose zariski closure @xmath748 intersects @xmath868 , where @xmath869 .",
    "then lemma  [ lem : rel_semipos ] and proposition  [ prop : beta_s ] remain valid ( with the obvious index modifications ) ; the proofs are entirely analogous .",
    "it remains to compute local versions of the divisors @xmath697 , defined in  . by theorem  [ thm : keyformula ] , these are needed for the upper bound for @xmath30 .",
    "as @xmath625 is constructed using a sequence of blow - ups , the morphism @xmath870 in extends to a morphism @xmath871 for our applications ( see section  [ sec : upper ] ) we need to construct a divisor of @xmath749 whose associated line bundle is isomorphic to the pullback of the twist @xmath872 by @xmath735 .",
    "we set @xmath873    [ lem : d_xf_n ] let @xmath874 where @xmath875 is the vertical @xmath43-divisor in . then @xmath876 is a @xmath43-divisor of @xmath625 which is associated to @xmath877 .    we can show that @xmath878 is associated to @xmath879 , where @xmath21 is the fraction field of @xmath15 , using arguments analogous to those employed in  ( * ? ? ?",
    "* lemma  7.3 ) . since @xmath880 it is clear that there is a @xmath43-divisor of the form @xmath881 , with a vertical @xmath43-divisor @xmath875 , such that @xmath876 is associated to @xmath877 .",
    "the @xmath43-divisor @xmath876 has to satisfy the equations @xmath882 for all components @xmath233 which are different from @xmath360 ( see e.g. ( * ? ? ?",
    "* theorem 9.2.12 ) ) , and @xmath883 see  ( * ? ? ?",
    "* remark  9.1.131 ) .",
    "one can use the quantities computed in theorem  [ thm : f_nmin ] to verify that our choice of @xmath875 in   indeed satisfies the equations   and  .",
    "[ prop : gp_int ] we have @xmath884    note that by  , we have @xmath885 .",
    "thus the result follows from lemma  [ lem : v_cints ] and lemma  [ lem : v_dints ] .",
    "[ rk : g_sindep ] suppose that @xmath54 is a cusp whose zariski closure @xmath748 intersects @xmath868 , where @xmath869 .",
    "then analogues of lemma  [ lem : d_xf_n ] and proposition  [ prop : gp_int ] for @xmath54 can be proved in an similar way .",
    "in this section we compute upper and lower bounds for the arithmetic self - intersection @xmath30 of the dualizing sheaf on the minimal regular model @xmath40 over @xmath886 of the fermat curve @xmath3 .",
    "we want to apply theorem  [ thm : keyformula ] to find an upper bound for @xmath30 .",
    "the morphism @xmath870 from   is unramified outside @xmath887 and extends to a morphism @xmath888 }   \\,,\\ ] ] since the minimal regular model @xmath889 can be constructed by a sequence of blow - ups , see section  [ sec : curilla ]",
    ". we will apply theorem  [ thm : keyformula ] with @xmath890}$ ] . to compute the geometric contribution ,",
    "we construct @xmath43-divisors @xmath694 and @xmath697 as in section  [ sec : kuehn ] , using the local results from  [ sec : int ] .",
    "recall that the cusps on @xmath3 are the points which are mapped to @xmath891 or @xmath700 by @xmath735 and that a divisor on @xmath3 is called cuspidal if its support consists entirely of cusps .",
    "[ prop : fj ] let @xmath893 be a cusp and let @xmath894 be its zariski closure",
    ". set @xmath895 where @xmath896 is the vertical @xmath43-divisor supported in the special fiber above @xmath12 defined in  , viewed as a @xmath43-divisor on @xmath40 .",
    "then      it is clear that ( ii ) follows from ( i ) . by corollary  [ coro : rohrlich ] ,",
    "the divisor @xmath898 is a canonical divisor on @xmath3 .",
    "hence , by  ( * ? ? ?",
    "* proposition  2.5 ) , a @xmath43-divisor @xmath248 on @xmath40 of the form @xmath899 where @xmath900 is a vertical @xmath43-divisor , is canonical if and only if @xmath248 satisfies the adjunction formula ( theorem  [ thm : kan ] ) . by",
    ", the @xmath43-divisor @xmath901 satisfies the adjunction formula , so ( i ) follows .",
    "[ lem : help ] let @xmath893 be a cusp above @xmath700 with zariski closure @xmath903 . then the @xmath43-divisor @xmath904 is associated with @xmath905 } } ( 1))^{\\otimes \\frac{1}{n^2}}$ ] , where we view each @xmath902 as a @xmath43-divisor on @xmath40 .",
    "we can assume that the @xmath43-divisor we are looking for is of the form @xmath906 , where @xmath907 is a vertical @xmath43-divisor with support in the bad fibers .",
    "if @xmath12 is a prime of bad reduction above @xmath7 and @xmath233 is an irreducible component of the special fiber above @xmath12 which is different from the component @xmath908 , then the @xmath43-divisor @xmath909 has to satisfy @xmath910 furthermore , @xmath909 has to satisfy @xmath911 } { \\operatorname{spec}}{\\mathbb{f}}_p\\right)= \\left(n^2{{\\mathcal{e}}}_{s_j } \\cdot pf_{n / p}\\right ) \\ , .\\ ] ] on the other hand , if we take @xmath912 , then these equations are satisfied , because a component @xmath233 which belongs to the fiber above @xmath12 only intersects @xmath902 .",
    "it follows that our choice of @xmath907 is valid .",
    "the zariski closure @xmath699 of @xmath700 in @xmath914}^1 $ ] is associated to @xmath915}^1}(1)$ ] .",
    "because @xmath693 lies above the branch point @xmath700 , lemma  [ lem : help ] implies that   is satisfied for the section @xmath916 .",
    "[ lem : f_ngf ] let @xmath693 be a cusp above @xmath700 , let @xmath917 be a prime and let @xmath12 be a prime above @xmath7 . then the self - intersections @xmath918 and @xmath919 are independent of @xmath12 .",
    "furthermore , we have @xmath920 and @xmath921      we have @xmath922 with @xmath923 by  . for each prime @xmath7",
    "let us denote by @xmath924 the number of prime ideals of @xmath11 $ ] that lie above @xmath7 . since @xmath925 is a galois extension , all the inertia degrees and ramification indices of the prime ideals over @xmath7 are the same ( we denote them by @xmath926 and @xmath927 , respectively ) , and we get the equation @xmath928=e_pf_pr_p$ ] . because @xmath929 , we have @xmath930 for a prime ideal @xmath12 above @xmath7",
    ", hence it follows that @xmath931 summing up over all prime numbers @xmath7 with @xmath917 , we obtain the formula for @xmath932 .",
    "the claimed formula for @xmath933 can be verified in a similar way .",
    "[ thm : fermat ] let @xmath31 be an odd squarefree integer with at least two prime factors , and let @xmath32 be the minimal regular model of the fermat curve @xmath3 over @xmath663 $ ] .",
    "then the arithmetic self - intersection number of its dualizing sheaf equipped with the arakelov metric satisfies @xmath934 (    \\kappa_1 \\log n + \\kappa_2)\\\\      & \\ ; + ( 2 g-2 ) \\sum_{p|n}\\frac{\\varphi",
    "( n)}{\\varphi ( p ) } \\left ( \\frac{3n^2 - 2np-10n+6p-6 - 4\\left(\\frac{n}{p}\\right)^2 + 12 \\left(\\frac{n}{p}\\right)}{n(n-3)}\\right )   \\log p \\ , , \\end{aligned}\\ ] ] where @xmath935 are positive constants independent of @xmath0 .",
    "the morphism @xmath936}^1 $ ] is a morphism of arithmetic surfaces which satisfies the requirements of theorem [ thm : keyformula ] .",
    "we have @xmath937 and @xmath938 , hence @xmath939 .",
    "it follows that in our case the formula of theorem [ thm : keyformula ] becomes @xmath940 where we used lemma [ lem : f_ngf ] for the second equality .",
    "the final equality follows from lemma  [ lem : v_cints ] and proposition  [ prop : gp_int ] .",
    "we bound @xmath943 , where @xmath944 is the @xmath139-th prime .",
    "it is well known that @xmath945 for @xmath946 , so @xmath947 follows for @xmath946 , implying @xmath948 where @xmath949 is a constant independent of @xmath65 .",
    "now the number of prime divisors of @xmath0 is of order @xmath950 by  ( * ? ? ?",
    "* chapter  22 ) , so the result follows .",
    "let @xmath54 be one of the cusps of @xmath3 .",
    "we use the notation of section  [ sec : km ] . recall that , for a prime @xmath956 of @xmath11 $ ] , we defined vertical @xmath43-divisors @xmath957 and @xmath958 , and gave a formula for @xmath959 in proposition  [ prop : beta_s ] , where @xmath960 is a canonical @xmath43-divisor on @xmath39 .",
    "[ thm : lower ] let @xmath31 be an odd squarefree integer with at least two prime factors , and let @xmath32 be the minimal regular model of the fermat curve @xmath3 over @xmath663 $ ] .",
    "then we have @xmath966 where @xmath967    corollary",
    "[ coro : rohrlich ] implies that @xmath722 is a canonical divisor on @xmath3 . by lemma  [ lem : rel_semipos ]",
    ", we see that   is satisfied for all irreducible vertical components , so that theorem  [ thm : km ] is applicable .",
    "therefore we obtain the lower bound @xmath968 from lemma  [ lem : beta_form ] . by proposition  [ prop : beta_s ] , we have @xmath969 which proves the result .",
    "let @xmath0 be odd , composite and squarefree and let @xmath7 be a prime dividing @xmath0 .",
    "from @xmath970 we get @xmath971 moreover , using @xmath972 we find @xmath973 where @xmath974 is as in theorem  [ thm : lower ] . combining these results with theorem  [ thm : lower ] and @xmath975 , the desired inequality @xmath976 follows .                                                                _ l.  szpiro : _",
    "sur les proprits numriques du dualisant relatif dune surface arithmtique . in _ the grothendieck festschrift ,",
    "88*. birkhuser boston , boston , ma , ( 1990 ) , 229246 ."
  ],
  "abstract_text": [
    "<S> we construct the minimal regular model of the fermat curve of odd squarefree composite exponent @xmath0 over the @xmath0-th cyclotomic integers . as an application </S>",
    "<S> , we compute upper and lower bounds for the arithmetic self - intersection of the dualizing sheaf of this model . </S>"
  ]
}