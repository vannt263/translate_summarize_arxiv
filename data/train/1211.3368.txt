{
  "article_text": [
    "the integrand of eq .   is analytic at @xmath20 , but as @xmath21 it exhibits irregular oscillations with a slowly decaying envelope ( @xmath22 ) , which causes problems with traditional quadrature schemes .",
    "for example , in @xmath23 the integrand decays as @xmath24 , so it becomes negligible ( i.e. , below machine precision ) only beyond @xmath25 .",
    "therefore it is useful to adopt the complex - plane technique of ref .  .",
    "split the integral at a point @xmath26 on the real axis by writing @xmath27 in eq .",
    ", apply the identity @xmath28      \\end{aligned}\\ ] ] where @xmath29 and @xmath30^*$ ] are hankel functions of the first and second kind respectively . performing a binomial expansion",
    "gives a sum of @xmath31 combinations of hankel functions , so that @xmath32 where the sum over @xmath33 runs over all @xmath31 configurations of the ising variables @xmath34 and the sum over @xmath35 runs from 1 to @xmath3 . for @xmath36",
    "the hankel functions behave as @xmath37 .",
    "thus , for a given @xmath33 , the integrand goes as @xmath38 , and jordan s lemma allows us to rotate the integration path into the upper or lower half - plane ( uhp / lhp ) depending on the sign of @xmath39 = \\omega + \\sigma_1\\omega_1 + \\dotso + \\sigma_d\\omega_d$ ] .",
    "thus @xmath40 together , eqs .  , , and give a prescription for computing @xmath41 .    to appreciate why this procedure is necessary and effective , it is instructive to write the green function in the form @xmath42 where @xmath43 \\geq 0 }              \\prod_k   h^{\\sigma_k}_{r_k } ( \\omega_k t )          , \\\\",
    "f_3(t ) & = \\frac{i^\\alpha e^{i\\omega t}}{2^d }                \\sum_{\\{\\sigma\\}}^{\\lambda[\\sigma ] < 0 }              \\prod_k   h^{\\sigma_k}_{r_k } ( \\omega_k t )          ,      \\label{f1f2f3 }      \\end{aligned}\\ ] ] and to visualize these three integrations as in fig .",
    "[ argand ] .",
    "the original integrand @xmath44 oscillates irregularly , whereas @xmath45 and @xmath46 decay quickly with only a couple of oscillations .    in order to use standard quadrature routines ,",
    "it is convenient to parametrize the path of integration by a real variable @xmath47 . returning to eq .   and substituting @xmath48 leads to @xmath49 where the @xmath50 numbers @xmath51 are @xmath52 a nave implementation of eq .   requires evaluating a sum of @xmath31 products each containing @xmath3 hankel functions . for an efficient implementation , one should precompute the two real exponentials and the @xmath50 complex hankel functions , as described in the pseudocode below : +    tabulate @xmath53    tabulate @xmath54 for @xmath55    set @xmath56    for each of the @xmath31 ising configurations @xmath57    if @xmath58    set @xmath59",
    "else    set @xmath60    end if    end for     + in order to develop a robust implementation , one should consider the following four situations :    [ [ frequency - outside - band - green - function - not - on - branch - cut ] ] frequency outside band ( green function not on branch cut ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    if @xmath61 , then the integrand of eq .",
    "is dominated by the @xmath62 term , which decays into the uhp . in this case , one can simply rotate the path of integration to lie along the positive imaginary axis and substitute @xmath63 to obtain @xmath64 this method was put forth in ref .  ; see also ref .  .",
    "[ [ generic - frequency - within - band ] ] generic frequency within band : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in general , the integrand @xmath65 decays exponentially as @xmath66 .",
    "this case is well handled by standard numerical integration routines .",
    "[ [ frequency - at - van - hove - singularity ] ] frequency at van hove singularity : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the green function @xmath41 has singularities at frequencies @xmath67 . for a generic anisotropic lattice",
    "there are @xmath31 singularities , whereas for an isotropic lattice with @xmath68 there are only @xmath69 distinct singularities at @xmath70 .",
    "whenever @xmath1 lies at one of these van hove singularities ( @xmath71 ) , @xmath65 decays only as a power law , @xmath72 .",
    "this poses no fundamental problem ; however , canned integration routines that do automatic singularity handling may attempt to evaluate the hankel functions at very large @xmath1 , causing overflow or underflow . therefore , it is advantageous to `` fold '' the integration domain manually as follows",
    ". split the integral in eq .   at a point @xmath73 and apply the transformation @xmath74 to the second term to obtain @xmath75 the jacobian cancels the asymptotic @xmath72 behavior , so the transformed integrand tends to a constant as @xmath76 , and can be integrated easily using conventional quadrature routines .",
    "[ [ frequency - near - van - hove - singularity ] ] frequency near van hove singularity : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    if @xmath77 , the integrand @xmath65 crosses over from power law decay to exponential decay at a large value of the argument , @xmath78 .",
    "any adaptive quadrature routine will be forced to sample @xmath65 in the vicinity of this crossover , causing overflow and underflow . in this situation",
    "it may be necessary to rewrite the integrand in terms of exponentially scaled hankel functions @xmath79 , which may be computed directly from appropriate recursions or from asymptotic expansions such as @xmath80    there is some flexibility in choosing the split point @xmath81 . with @xmath82 ,",
    "one recovers the original formula eq .  .",
    "taking @xmath83 corresponds to integrating @xmath84 from @xmath85 to @xmath86 and @xmath87 from @xmath85 to @xmath88 respectively .",
    "this is an attractive choice because hankel functions of imaginary argument can be computed cheaply by decomposing them into bessel @xmath89 and bessel @xmath90 functions.@xcite however , although the original integrand @xmath44 was analytic at @xmath20 , the split integrands @xmath84 and @xmath87 are singular at @xmath20 . in the case of the on - site green function ( @xmath91 ) ,",
    "@xmath84 and @xmath87 have logarithmic branch points at @xmath20 , which are weak , integrable singularities , so it is permissible to rotate the integration paths as was done in ref .  .",
    "however , for @xmath92 , @xmath84 and @xmath87 both have a pole at @xmath20 ( which may be a high - order pole ) , so that it is illegal to rotate the path about @xmath20 .",
    "then it is necessary to use a split point @xmath93 sufficiently far away from the pole at @xmath20 .",
    "the optimal value of @xmath81 depends on the implementation of bessel and hankel functions and the quadrature routines available in one s software package . in the current version of _ mathematica _ at the time of writing ( 8.0.1.0 ) , the special function routines are slow ( ` hankelh1[0,2.+3.i ] ` takes almost 0.7 milliseconds ) and inaccurate ( the error in ` besselj[0,11 . ]",
    "` is 1000 times larger than machine precision ) , so we have not attempted detailed fine - tuning .",
    "there is also some flexibility in the choice of integration paths . instead of integrating @xmath84 along the straight line @xmath94",
    ", it may be desirable to use the path @xmath95 , because the integrand is cheaper to evaluate when @xmath13 is pure imaginary .",
    "for general @xmath7 , the binomial expansion leads to @xmath31 terms . in certain cases these are not all distinct .",
    "for example , for @xmath91 on an isotropic lattice , the binomial expansion of @xmath96 only gives rise to @xmath69 distinct terms @xcite .",
    "as remarked earlier , the integrand of eq .   has irregular oscillations that make it difficult to integrate using traditional quadrature schemes .",
    "however , integrands of this form are amenable to relatively modern integration techniques such as the levin collocation method @xcite .",
    "mathematica 8.0.1.0 is able to perform an automatic symbolic analysis of the integrand to determine a suitable set of basis functions and carry out the levin method .",
    "we summarize the method below , assuming the summation convention for brevity .",
    "the levin method deals with an integral of the form @xmath97 ( summed over @xmath98 ) where @xmath99 are slowly varying envelope functions and @xmath100 are oscillatory basis functions .",
    "the @xmath101 basis functions satisfy a matrix ordinary differential equation ( ode ) , @xmath102 , where @xmath103 vary slowly .",
    "the fundamental theorem of calculus gives the integral in terms of the antiderivative of the integrand : @xmath104 where @xmath105 .",
    "simple manipulations show that the antiderivative envelope functions @xmath106 satisfy the matrix ode @xmath107 in which the `` kernel '' @xmath108 and `` forcing '' @xmath99 vary slowly .",
    "the general solution for @xmath106 contains an admixture of up to @xmath101 oscillatory `` modes '' .",
    "however , levin observed that there is _ one _ solution that is slowly varying , and that this `` particular solution '' can be well approximated by solving the ode using a collocation method as follows .",
    "choose a set of collocation points @xmath109 for @xmath110 .",
    "it is convenient to use the extrema of the chebyshev polynomial of degree @xmath111 ( suitably scaled ) : @xmath112      .",
    "$ ] choose an ansatz for @xmath106 .",
    "it is convenient to use a linear combination of chebyshev polynomials of degree less than @xmath111 , weighted by coefficients @xmath113 ( @xmath114 ) , @xmath115 the derivatives are series in chebyshev polynomials of the second kind , @xmath116 : @xmath117 let us demand that the ansatz satisfy the ode exactly at the collocation points .",
    "putting eqs .   and into eq",
    ".   leads to @xmath118 c_{jk }    & = f_i ( t_l ) .",
    "\\label{largelinearsystem }      \\end{aligned}\\ ] ] this is a system of @xmath119 linear equations , which can be solved to give the @xmath119 coefficients @xmath120 in @xmath121 time . from the numerical values of the @xmath120 one can then use eq .   in eq .   to estimate the integral @xmath90 .",
    "let us now examine the application of the levin method to the computation of the green function @xmath122 via eq .  .",
    "in general , this requires @xmath31 basis functions , @xmath100 , which are all possible products of bessels and bessel derivatives , @xmath123 for clarity of exposition we illustrate the procedure for the on - site green function on an isotropic lattice in @xmath23 , @xmath124 , which requires only @xmath125 basis functions .",
    "the basis , forcings , and differential matrix are @xmath126 @xmath127 using eqs .",
    ", , , and with @xmath128 collocation points gives the integral from @xmath129 to @xmath130 with absolute error about @xmath131 ( relative error about @xmath132 ) .",
    "the intermediate quantities are illustrated in fig .",
    "[ levin ] .",
    "it is interesting to note that in the levin method , the properties of the integrand are encapsulated in the @xmath133 , so that the integrand is _ never _ evaluated at any @xmath13 ( unlike in traditional quadrature methods ) . the special functions @xmath62 , @xmath134 , and @xmath135 are only evaluated at @xmath129 and at @xmath130 .",
    "thus , the computational time is dictated not by the number of integrand evaluations , but by the solution of the @xmath119 simultaneous equations for the chebyshev coefficients .",
    "the above - described levin method has some drawbacks in the present context :    * integrating from @xmath20 to @xmath136 requires some extensions due to the singularity in @xmath137 and the infinite upper limit .",
    "* solution of the collocation equations may be less controlled ( with respect to roundoff accumulation ) than performing quadrature on the smoothly decaying integrand in eq .  .",
    "* since the true @xmath106 is smooth , the simplest way to improve collocation accuracy is to increase the number @xmath111 of chebyshev polynomials , but this is restricted by the @xmath121 time complexity for solving the collocation equations .",
    "in contrast , clenshaw - curtis quadrature for the smoothly decaying integrand in eq .  , which essentially involves integrating the chebyshev interpolant , can be taken to arbitrarily high chebyshev degree @xmath111 , since the complexity scales only as @xmath138 ( or @xmath139 if the quadrature weights are computed on the fly ) . * when @xmath1 lies at a van hove singularity , the levin method experiences problems due to resonance between the @xmath62 and @xmath134 factors : the integrand acquires a non - oscillatory component that needs special treatment .",
    "we observe an interesting parallel .",
    "the complex - plane method for @xmath140 involves a sum of @xmath141 terms , and for @xmath142 the sum involves @xmath31 terms .",
    "the levin method for @xmath140 requires @xmath125 basis functions , and for @xmath142 it requires @xmath143 basis functions .",
    "however , the complex method involves quadrature , which takes time linear in @xmath141 ( or @xmath31 ) , whereas solution of the levin collocation equations takes time cubic in @xmath141 ( or @xmath31 ) .",
    "thus for large @xmath3 the levin method is more expensive .",
    "taking all the above considerations into account , we feel that the complex - plane method is more suitable for evaluating hypercubic lattice green functions of the form eq .  .",
    "nevertheless , one s choice may be influenced by the availability of complex hankel functions and quadrature routines in one s preferred language or software platform .",
    "we have not attempted an exhaustive study of whether other methods for oscillatory integration@xcite are able to deal with eq .  .",
    "the following values of the green function for isotropic cubic and hypercubic lattices , i.e. , with @xmath144 and @xmath145 respectively , were computed using the complex - plane method implemented in mathematica ( see auxiliary file ` hlgfpackage.nb ` ) : @xmath146 @xmath147 as expected , @xmath148 when @xmath149 ( the density of states is zero outside the band ) . by symmetry , @xmath150 .",
    "the green function obeys the discrete helmholtz equation , @xmath151 , where @xmath152 are unit vectors and @xmath153 if @xmath91 and zero otherwise . at the band bottom ( @xmath154 ) the green function obeys the discrete laplace equation , so @xmath155 and @xmath156 . the green function at the top of the band alternates in sign between adjacent sites .",
    "the accuracy of the above results ( @xmath157@xmath158 digits ) was limited partly by the large errors in the bessel - related functions supplied by mathematica 8.0.1.0 .",
    "we have presented an efficient method [ eqs .  , , ] , based on complex analysis , for calculating green functions of @xmath3-dimensional anisotropic hypercubic lattices at arbitrary lattice vectors .",
    "we also discuss the merits of an alternative approach using the levin collocation method , but we provide reasons to prefer the complex - variable method ."
  ],
  "abstract_text": [
    "<S> we present a method for accurate evaluation of the green function @xmath0 at any real frequency @xmath1 and any lattice vector @xmath2 for a @xmath3-dimensional hypercubic lattice that may have anisotropic couplings @xmath4 . in this method , </S>",
    "<S> we start with an integral representation of @xmath5 , split the oscillatory integrand into combinations of hankel functions , and deform the integration paths into the complex plane to obtain rapidly convergent integrals . </S>",
    "<S> we also discuss an alternative approach using the levin collocation method . </S>",
    "<S> we report values of the green function at selected frequencies on the branch cut and selected lattice vectors .    </S>",
    "<S> lattice green functions arise in numerous problems in combinatorics , statistical mechanics , and condensed matter physics . in the language of condensed matter physics , </S>",
    "<S> the green function @xmath6 is the propagator for a particle of energy ( or frequency ) @xmath1 to move a distance @xmath7 in a tight - binding model on a lattice with a nearest - neighbor hopping . </S>",
    "<S> accurate values for lattice green functions are useful as input for further calculations in many - body theory , such as simulations of hubbard models@xcite and non - perturbative renormalization group studies.@xcite    closed - form expressions exist for green functions on many lattices in one , two , and three dimensions , for bethe lattices , and for certain fractal lattices@xcite ; see ref .   </S>",
    "<S> and references therein . </S>",
    "<S> in particular , joyce found closed forms for the green function of the cubic lattice at the origin,@xcite at a general lattice point,@xcite and of an anisotropic cubic lattice.@xcite however , closed forms for hypercubic lattice green functions in @xmath8 dimensions are not available in terms of named special functions.@xcite    we recently developed a method@xcite for obtaining accurate numerical values for the on - site green function @xmath9 on a @xmath3-dimensional hypercubic lattice . in this work </S>",
    "<S> we generalize this method to off - diagonal green functions @xmath10 on anisotropic lattices ; the generalization is not as trivial as one might expect . </S>",
    "<S> we also discuss an alternative approach using the levin collocation method to integrate oscillatory functions , and we make an interesting observation about the computational complexity of both methods . finally , we report values of the green function as test cases against which to benchmark implementations or other methods .    consider a @xmath3-dimensional hypercubic lattice with anisotropic nearest - neighbour hopping amplitudes @xmath11 ( @xmath12 ) in each direction . the green function @xmath5 has closed forms in various representations involving time @xmath13 , frequency @xmath1 , position @xmath7 , and wavevector @xmath14 : @xmath15 the position - frequency green function @xmath10 can be written as a @xmath3-dimensional integral over the brillouin zone , @xmath16 where we have included an infinitesimal shift in the denominator as is conventional in condensed matter theory . </S>",
    "<S> this form makes it clear that @xmath10 has a branch cut along the real axis representing a continuous spectrum ( band ) of particle excitations . </S>",
    "<S> however , for numerical evaluation of @xmath10 it is better to start from the one - dimensional integral representation@xcite @xmath17 where @xmath18 and @xmath19 are integers . </S>"
  ]
}