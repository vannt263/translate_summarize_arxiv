{
  "article_text": [
    "recently , deblurring technique has made a lot of progress .",
    "early deblurring methods only focused on the blur caused by camera shake in constant depth images  @xcite .",
    "recently , however , there are some methods to handle the blurred images with depth variations  @xcite , and there are even methods to handle object motion blur  @xcite .",
    "object motion deblurring problem is very challenging since it requires the estimation of independent spatially - varying blur kernels .",
    "what makes the object motion deblurring problem more difficult is the occlusions generated by intra - frame motions . while occlusions generated by _",
    "inter_-frame motions cause a photo - inconsistency , occlusions generated by _",
    "intra_-frame motions cause a mixture of foreground pixels and background pixels at occlusion boundaries in the blurred image .",
    "these ambiguous pixels can lead to severe ringing artifacts in the deblurring results .    to address this problem , several methods explicitly modeled the occlusions using layered blur model  @xcite . especially , wulff and black  @xcite proposed a layered blur model for the case where both layers are blurred , and obtained convincing results .",
    "they modeled a blur image as a composition of individually blurred foreground and background , and this generative model could express the layer interaction caused by occlusions .",
    "however , their layered blur model does not reflect the actual blur generation process .",
    "a blurred image is the integration of intermediate images that the camera sees while the shutter is open , which differs from their layered blur model .",
    "figure  [ fig_counter ] shows a counterexample .",
    "the foreground and background are moving at similar speeds in the image , and the blurred image is observed as an integration of the intermediate images . since the tiger s left eye ( red color ) in the background is occluded by the foreground fence in the entire time window between the opening and closing of the camera shutter , it should not be exposed in the blurry image but it is visible in their generative model .",
    "this error can cause severe ringing artifacts in deblurring results .    in this paper , we propose a new layered blur model reflecting the actual blur generation process , and occlusion - aware video deblurring method accordingly .",
    "we enhanced the model by changing the order of a composition and a blurring of layers , so that it follows the actual blur generation process . by using the carefully designed likelihood from our layered blur model , clear foreground and background",
    "can be successfully recovered from blurred images with occluding objects .",
    "specifically , given a set of motion - blurred video frames , our method estimates clear foreground , clear background , clear alpha blending mask , and the motion for each layer .",
    "figure  [ fig_teaser ] shows that our result is better than that of  @xcite , especially at occlusion boundaries .",
    "also , we analyze the layered blur model theoretically and experimentally .",
    "we show that the model of  @xcite is a good approximation that is identical to our model for some specific physical situations , and also present that the blur kernels at boundaries have distinct characteristics that can not be captured by conventional blur models .",
    "early works on deblurring focused on the blur caused by camera shake in constant depth images .",
    "they are roughly categorized into spatially - invariant and spatially - varying configurations .",
    "spatially - invariant deblurring achieved some success in single - image deblurring  @xcite and video deblurring  @xcite .",
    "however , the spatially - invariant blur model can not deal with a rotational camera motion , which is a significant and common component in practical scenarios  @xcite . to overcome this limitation , some researchers parameterized the blur as a possible camera motions in a 3d space , and this approach is applied to single - image  @xcite and video deblurring  @xcite .",
    "although these methods solve spatially - varying motion blur in some extent , they are limited to camera shake in a constant depth and can not handle more general depth variation or object motion problem .    in the case of blurred images including depth variations ,",
    "the blur can not be represented by a simple homography .",
    "some methods solved this problem by casting a blur kernel estimation problem as a scene depth estimation problem  @xcite .",
    "these methods extended the applicability of deblurring methods .",
    "however , they are limited to static scenes , and do not take the mixture of pixels at occlusion boundaries into account .",
    "recently , several object motion deblurring methods have been developed .",
    "some of the methods divided the image into segments to restore each of them independently .",
    "they divided the image using hybrid cameras  @xcite , based on similar motions  @xcite , or under the guidance of the matting  @xcite .",
    "there are also some methods without segmentations .",
    "cho  @xcite used patch - based synthesis for deblurring by detecting and interpolating proper sharp patches at nearby frame .",
    "kim and lee approximated the blur kernel as the pixel - wise 2d linear motion and performed deblurring of dynamic scene in a single - image  @xcite and a video  @xcite .",
    "these object motion deblurring methods perform well , but do not consider the interaction between the object and the background at occlusion boundaries .    at occlusion boundaries , blurred pixels consist of a mixture of foreground pixels and background pixels and it plays an important role for object motion deblurring . to address this problem , some authors used layered models  @xcite .",
    "however , these methods assumed the background to be static and modeled the foreground motion only .",
    "sellent  @xcite used outlier rejections  @xcite to handle the occlusions .",
    "takeda and milanfar  @xcite proposed a method that can deal with occlusions using a spatiotemporal approach , but it requires priorly given blur kernels and depends on time interpolators .    to deal with the general case where both the foreground and the background are moving independently , wulff and black  @xcite proposed a layered blur model that consists of a composition of individually blurred foreground and background .",
    "this model included the interaction between layers and improved the performance at occlusion boundaries .",
    "however , as shown in figure  [ fig_counter ] , this generative model is different with the actual blur generation process and not always valid .",
    "in this section , we briefly review the previous layered blur model  @xcite , propose our new layered blur model , and compare them .",
    "the differences in these models will be proved to be greatly attributable to removing serious artifacts at occlusion boundaries in the later section .",
    "first of all , we set a layered model for a clear image @xmath0 ( @xmath1 is the number of pixels ) to be : @xmath2 where @xmath3 and @xmath4 are the clear foreground and background layer , respectively , @xmath5 is an alpha blending mask , @xmath6 is a vector with all components equal 1 , and @xmath7 denotes element - wise multiplication .",
    "notice that @xmath8 multiplied the background image ( @xmath9 means a background pixel ) for notational simplicity later on , inspired by  @xcite .",
    "our goal is to express blurred images using each layer of the reference image ( @xmath10 ) . before expressing blurred images",
    ", we express a warped image using @xmath10 .",
    "we assume that the appearance and shape of each layer is constant , which is a common assumption in the deblurring literature  @xcite .",
    "if we let @xmath11 denotes a motion parameter for layer @xmath12 from the reference frame to the frame @xmath13 , then the warped image @xmath14 at frame @xmath13 is as follows : @xmath15 where @xmath16 is a warping matrix according to the motion parameter @xmath11 .",
    "the alpha blending mask @xmath8 is warped by the foreground motion @xmath17 since its appearance depends on the foreground object . similarly to  @xcite , for notational simplification , we redefine the clear foreground layer as @xmath18 , and abbreviate the notation @xmath19 to @xmath20 .",
    "then , the simplified equation is : @xmath21 based on eq .",
    ", we compare the previous layered blur model  @xcite and our layered blur model in the following subsections .",
    "wulff and black  @xcite proposed a layered blur model to represent the mixture of the foreground and the background at occlusion boundaries .",
    "their generative model addressed that blurred images consist of the composition of individually blurred foreground and background layers . to express this model , let @xmath22 denotes a blur matrix for each layer @xmath23 at frame @xmath13 , which equals the average of warping matrices while the shutter is open , as : @xmath24 where @xmath25 is a exposure time , and @xmath26 is the motion parameter for intra - frame capture time @xmath27 ( the elapsed time after the shutter of the frame @xmath13 is opened ) from the reference frame ( @xmath28 ) .",
    "then , the blurred frame @xmath29 based on  @xcite is as follows : @xmath30    in this model , the blurred frame is the composition of individually blurred layers ( @xmath31 and @xmath32 ) .",
    "this equation is equivalent to the layered representation of motion - blurred video of  @xcite , although the notation is different .",
    "here we propose a new layered blur model .",
    "as shown in figure  [ fig_counter ] , the previous layered blur model does not reflect actual blur generation process in which a blurred image is generated by integrating intermediate images the camera sees during exposure . by applying this concept to the layered blur model , a blurred frame @xmath33",
    "is newly represented as follows :    @xmath34    where @xmath35 is an abbreviated notation of @xmath36 .    in this model ,",
    "the blurred frame is the integration of intermediate images , each of which is a composition of intermediate layers .",
    "this proposed model coincides with the actual blur generation process .",
    "the main difference between the conventional layered blur model ( eq .  ) and the proposed layered blur model ( eq .  ) is the order of a composition and a blurring of layers , as illustrated in figure  [ fig_modelcomparison ] . while the conventional model composites two layers after blurring each layer ( integrating each intermediate layer ) , our model composites two layers first and then integrates the composited intermediate images .",
    "note that although eq .",
    "does not model actual physical two layered blurring process correctly , it becomes identical to eq .   in some special cases .",
    "we analyze and compare the two models , and show the conditions when the two models become equivalent , both analytically and empirically .    due to the fact that @xmath37 the blurred images generated by the two models in eq .   and",
    "eq .   are different with each other as follows : @xmath38    note , however , that the left and right formulas in eq .   become identical when @xmath39 or @xmath40 is a constant with respect to @xmath27 .",
    "and this leads to the following three cases that can make the two deblurring models in eq .",
    "become equivalent .    1 .",
    "background is static ( @xmath41 is a constant @xmath27 ) 2 .",
    "foreground is static ( @xmath42 is a constant @xmath27 ) 3 .",
    "background is homogeneous ( @xmath43 is a constant @xmath27 )    although homogeneous alpha map ( @xmath44 is a constant @xmath27 )  can also make two models become identical , it is impossible at occlusion boundaries .",
    "figure  [ fig_special ] is the experimental comparison that shows the blurred images corresponding to these three situations .",
    "the two models give the same blurred images .",
    "thus , the previous layered blur model is a good approximation of ours , but it may lead to artifacts at occlusion boundaries in general .",
    "in this section , we propose an occlusion - aware deblurring method based on the proposed layered blur model .      given a set of blurred frames including an occluding layer , we restore clear foreground , background , alpha blending mask , and object motions .",
    "first we discretize the proposed model for deblurring .",
    "we divide the exposure time into @xmath45 samples uniformly ; @xmath46 denote the sampled times such that @xmath47 .",
    "then , our data term is defined as follows : @xmath48 where @xmath49 denotes a gradient operator , which is widely used in deblurring field to reduce ringing artifacts  @xcite .",
    "we use affine transformations for motion parameters and @xmath50 is obtained by linearly interpolating the motions of adjacent frames @xmath51 and @xmath52  @xcite .",
    "since the deblurring is a highly ill - posed problem , we add regularization terms to reduce the ambiguity .",
    "we enforce hyper - laplacian priors  @xcite on the gradients of the foreground and the background images as follows : @xmath53    also , since the alpha map is smoother than natural images , we use laplacian prior on the gradient of @xmath8 as : @xmath54        additionally , we enforce @xmath8 to be close to binary values by using following constraint : @xmath55 this term prevents the restored layers from being blurry transparent images .",
    "figure  [ fig_binary ] shows the contribution of the binary term eq .  .",
    "the final objective function is as follows : @xmath56 where @xmath57 , @xmath58 , and @xmath59 are parameters that adjust the weight of each term , and @xmath60 denotes a set of the motion parameters for each layer @xmath23 at each frame @xmath13 ( @xmath61 ) .",
    "we restrict the intensities of @xmath62 , @xmath63 , and @xmath8 to be in the range [ 0 , 1 ] .",
    "[ section_init ] since the problem is non - convex and easy to get stuck at a local minimum , it is important to start with good initial values .",
    "we use optical flow  @xcite to initialize the motion parameters as done in  @xcite .",
    "although the optical flow does not handle blurred images correctly , it provides good initial values for the variables .",
    "based on the initial optical flow , the two dominant affine transformations are estimated for each layer using ransac . also , we initialize each layer as an average of aligned input frames using initial motion parameters for each layer  @xcite . for the alpha blending mask , from the ransac result , we first specify the pixels that correspond to the background of each frame to the intermediate masks .",
    "then , we initialize alpha blending mask as an average of the aligned intermediate masks using the motion parameters for the background .      to optimize the non - convex objective function in eq .",
    ", we divide the original problem into three sub - problems and use alternating optimization techniques  @xcite that iteratively estimate each unknown while other unknowns are fixed . in this section ,",
    "we reorganize each sub - problem as a traditional deconvolution formula and describe how to solve it .",
    "notice that we estimate non - simplified @xmath10 ( @xmath64 ) although we used the simplified formula ( @xmath65 ) in the previous section for notational simplicity .",
    "[ [ latent - image - estimation ] ] latent image estimation + + + + + + + + + + + + + + + + + + + + + + +    in this step , we restore clear foreground and background layers while alpha blending mask and motion parameters are fixed . to make this sub - problem be in a simpler formula , we concatenate some variables .",
    "let @xmath66 denotes the row concatenation of @xmath62 and @xmath63 ( @xmath67 ) , and @xmath68 denotes the column concatenation of @xmath69 and @xmath70 ( @xmath71 ) such that @xmath72 where @xmath73 denotes a diagonal matrix formed from its vector argument . since @xmath74 can be represented as @xmath75",
    ", @xmath76 is equivalent to our layered blur model .",
    "then , for multi - frames , let @xmath77 denotes the row concatenation of @xmath78 , and @xmath79 denotes the row concatenation of @xmath80 ( @xmath81 is the number of observed frames ) .",
    "the sub - problem for latent image estimation can be expressed as follows : @xmath82 this optimization problem is same as the traditional deconvolution problem with hyper - laplacian prior  @xcite .",
    "we optimize eq .   using a conjugate gradient method and a lookup table in the same way as  @xcite .",
    "[ [ alpha - blending - mask - estimation ] ] alpha blending mask estimation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this step , we restore clear alpha blending mask while layer appearances and motion parameters are fixed . similarly to the latent image estimation step , we define @xmath83 and @xmath84 as follows : @xmath85 also , let @xmath86 denotes the row concatenation of @xmath87 , and @xmath88 denotes the row concatenation of @xmath89 .",
    "then , the sub - problem for alpha map estimation can be expressed as follows : @xmath90 this sub - problem is also same as a traditional @xmath91 deconvolution problem except the last term .",
    "we optimize eq .   using a primal - dual optimization method  @xcite as follows : @xmath92 where @xmath93 denotes the iteration number",
    ", @xmath94 denotes the dual variable , and @xmath95 and @xmath96 are the parameters for each update step .",
    "we apply the conjugate gradient method to optimize @xmath97 .",
    "[ [ motion - parameter - estimation ] ] motion parameter estimation + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this step , we estimate motion parameters while layer appearances and alpha blending mask are fixed . if we focus on the terms dependent on @xmath60 in eq .",
    ": @xmath98 we solve this equation using the nelder - mead simplex method  @xcite that can be implemented simply by a matlab built - in function  fminsearch \" .",
    "a set of blurred frames @xmath78 latent layers @xmath99 , mask @xmath8 , and motions @xmath60 .",
    "initialize @xmath99 , @xmath8 , @xmath60 using optical flow .",
    "build image pyramid . * for * iteration = 1:3 solve for @xmath99 ( eq .  ) .",
    "solve for @xmath8 ( eq .  ) .",
    "solve for @xmath60 ( eq .  ) .",
    "* end * propagate variables to the next pyramid level if exists .",
    "repeat steps 3 - 8 from coarse to fine pyramid level .",
    "[ algorithm_overview ]      to accelerate the algorithm , we optimize the objective function based on coarse - to - fine approach where the scale factor of image pyramid is 0.8 .",
    "also , the parameters used in the optimization is fixed for all experiments as @xmath100 and @xmath101 , where @xmath81 denotes the number of frames .",
    "@xmath58 was adjusted to a value between @xmath102 and @xmath103 depending on the shape of the occluding object .",
    "camera duty cycle , which is the ratio of an exposure time @xmath25 to a frame interval , is given from the camera setting ( 0.5 ) .",
    "the overview of our algorithm is summarized in algorithm  [ algorithm_overview ] .",
    "we compare our deblurring results with those of the state - of - the - art video deblurring method  @xcite and the previous layered deblurring method  @xcite . since the source code of the previous method  @xcite is not available",
    ", we focus on comparing our results with published results from the previous methods .",
    "please see our supplementary material for more results .",
    "the image sequences consist of 5 to 10 images .",
    "we processed the sequences on a desktop computer with intel i7 - 6700k cpu and 64 gb memory .",
    "it took 10 minutes per image to process 640x480 images with a non - optimized matlab implementation .",
    "figure  [ fig_teaser ] and figure  [ fig_binary ] show the deblurring results for images with severe occlusions .",
    "since the detailed structure of the bicycle is mixed with the background by the occlusion , generalized deblurring method  @xcite that does not consider the occlusion attempts to restore the background mainly . also , since both the foreground and background are blurred , the previous layered deblurring method  @xcite do not restore the details on the face and the bicycle properly .",
    "on the other hand , the proposed method restores the detailed structure of the human face and bicycle handle by using the carefully designed model .",
    "figure  [ fig_results ] shows the comparision with recent methods for deblurring results .",
    "the `` sign '' sequence and `` car '' sequence correspond to the situations where both foreground and background are moving . in the result of the previous method  @xcite",
    ", we can see the artifacts caused by segmentation errors at boundaries .",
    "our result shows better performance at occlusion boundaries .",
    "also , the `` hand '' sequence belongs to a situation where the previous model and our model are the same because the background is static .",
    "however , even in this situation , we can see that our method produces better results because it uses effective regularization and optimization .",
    "additionally , our method can also achieve the effects of layer separations  @xcite .",
    "it can remove occluding objects even when the images are blurry .",
    "figure  [ fig_result_layer ] shows not only that the fence occluding the tiger is removed , but also that the image is clearly restored .",
    "this image sequence was created by a physics - based renderer  @xcite .",
    "in this section , we analyze the blur kernel at object boundaries , which shows the distinctive characteristics of the blur kernel that can not be captured by conventional blur models .",
    "in addition , we discuss the limitations and future works of the proposed method .      visualizing the proposed blur model as a traditional blur kernel gives us the interesting result at layer boundaries .",
    "figure  [ fig_discussion ] illustrates the blur kernel of each model at boundaries where the foreground is moving to the left - side and the background is moving to the right - side .",
    "early works that handle abruptly - varying blur find the kernel either of the foreground or of the background  @xcite such as figure  [ fig_discussion](a ) , or find an ambiguous kernel between them  @xcite .    in the model of wulff and black  @xcite , the pixel at boundaries is blurred by both foreground and background kernels while each kernel is truncated or diminished in intensity compared to the kernel without occlusion .",
    "the foreground kernel is shortened in length to a factor of @xmath104 and the background kernel is reduced in intensity to a proportion of @xmath105 as shown in figure  [ fig_discussion](b ) , where @xmath105 is the blurred mask value of the corresponding pixel .    in the proposed model , the foreground kernel experiences truncation equal to that of  @xcite , but the background kernel is _ truncated _ instead of being _ weakened _ to a factor of @xmath105 as shown in figure  [ fig_discussion](c ) . in representing the occlusion of a background by a foreground object",
    ", the proposed model correctly models the occlusion event with _ the length of the blur kernel_.    thus , the blur kernel of the foreground and the background can be _ separate _ or _ overlapped _ each other according to the relative velocity of the layers .",
    "these distinctive kernel characteristics can not be captured by conventional blur models .    .",
    "]      in this study , several assumptions are made for our deblurring method .",
    "we assumed that the camera duty cycle is given for every frame , and the object motion is smooth in a frame .",
    "since we fix the camera setting , and the exposure time is short enough in videos , these assumptions can be justified to some extent . for the videos without exposure information , the estimation of duty cycle  @xcite should be combined to our method .    also , we parameterized the object motion as an affine motion , which causes a limitation in dealing with general object motions .",
    "although a projective motion can be applied to our model , a further consideration is required for additional problems such as occlusions in a layer or brightness constancy .",
    "combining our method with a non - parametrical motion deblurring method  @xcite is one of our future directions .",
    "in addition , our method assumes the scene with two layers currently .",
    "expanding this to multi - layer requires additional consideration of the occlusions involving multi - layer and the depth order of the layers . solving this problem is our another future direction .",
    "in this paper , we proposed occlusion - aware video deblurring based on a new layered blur model , allowing us an accurate restoration of object boundaries .",
    "we addressed the limitation of the conventional layered blur model theoretically and experimentally , and enhanced the model by changing the order of layer composition and blur , so that it follows the actual blur generation process . based on this model",
    ", the proposed occlusion - aware deblurring method obtains more accurate latent image , object motion , and segmentation mask .",
    "also , we analyzed that our model exactly extracts the contribution of occlusion from the original kernel , helping the capture of the property to overlap or separate the foreground and background kernels at boundaries .",
    "experimental results on synthetic and real blurred videos demonstrate the outstanding performance of the proposed method .",
    "l.  bar , b.  berkels , m.  rumpf , and g.  sapiro . a variational framework for simultaneous motion estimation and restoration of motion - blurred video . in _",
    "ieee international conference on computer vision ( iccv ) _ , 2007 ."
  ],
  "abstract_text": [
    "<S> we present a deblurring method for scenes with occluding objects using a carefully designed layered blur model . </S>",
    "<S> layered blur model is frequently used in the motion deblurring problem to handle locally varying blurs , which is caused by object motions or depth variations in a scene . however , conventional models have a limitation in representing the layer interactions occurring at occlusion boundaries . in this paper , we address this limitation in both theoretical and experimental ways , and propose a new layered blur model reflecting actual blur generation process . based on this model </S>",
    "<S> , we develop an occlusion - aware deblurring method that can estimate not only the clear foreground and background , but also the object motion more accurately . </S>",
    "<S> we also provide a novel analysis on the blur kernel at object boundaries , which shows the distinctive characteristics of the blur kernel that can not be captured by conventional blur models . </S>",
    "<S> experimental results on synthetic and real blurred videos demonstrate that the proposed method yields superior results , especially at object boundaries . </S>"
  ]
}