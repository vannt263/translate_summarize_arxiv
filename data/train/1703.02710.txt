{
  "article_text": [
    "modern state - of - the - art object detection systems  @xcite usually adopt a two - step pipeline : extract a set of class - independent object proposals at first and then classify these object proposals with a pre - trained classifier .",
    "existing object proposal algorithms usually search for possible object regions over dense locations and scales separately  @xcite .",
    "however , the critical correlation cues among different proposals ( _ e.g. _ , relative spatial layouts or semantic correlations ) are often ignored .",
    "this in fact deviates from the human perception process  as claimed in  @xcite , humans do not search for objects within each local image patch separately , but start with perceiving the whole scene and successively explore a small number of regions of interest via sequential attention patterns .",
    "inspired by this observation , extracting one object proposal should incorporate the global dependencies of proposals by considering the cues from the previous predicted proposals and future possible proposals jointly .    in this paper , in order to fully exploit global interdependency among objects , we propose a novel tree - structured reinforcement learning ( tree - rl ) approach that learns to localize multiple objects sequentially based on both the current observation and historical search paths . starting from the entire image , the tree - rl approach sequentially acts on the current search window either to refine the object location prediction or discover new objects by following a learned policy .",
    "in particular , the localization agent is trained by deep rl to learn the policy that maximizes a long - term reward for localizing all the objects , providing better global reasoning . for better training the agent ,",
    "we propose a novel reward stimulation that well balances the exploration of uncovered new objects and refinement of the current one for quantifying the localization accuracy improvements .",
    "the tree - rl adopts a tree - structured search scheme that enables the agent to more accurately find objects with large variation in scales .",
    "the tree search scheme consists of two branches of pre - defined actions for each state , one for locally translating the current window and the other one for scaling the window to a smaller one .",
    "starting from the whole image , the agent recursively selects the best action from each of the two branches according to the current observation ( see fig .",
    "[ fig : framework ] ) .",
    "the proposed tree search scheme enables the agent to learn multiple near - optimal policies in searching multiple objects . by providing a set of diverse near - optimal policies ,",
    "tree - rl can better cover objects in a wide range of scales and locations .",
    "extensive experiments on pascal voc 2007 and 2012  @xcite demonstrate that the proposed model can achieve a similar recall rate as the state - of - the - art object proposal algorithm rpn  @xcite yet using a significantly smaller number of candidate windows",
    ". moreover , the proposed approach also provides more accurate localizations than rpn .",
    "combined with the fast r - cnn detector  @xcite , the proposed approach also achieves higher detection map than rpn .",
    "our work is related to the works which utilize different object localization strategies instead of sliding window search in object detection .",
    "existing works trying to reduce the number of windows to be evaluated in the post - classification can be roughly categorized into two types , _",
    "i.e. _ , object proposal algorithms and active object search with visual attention .    early object proposal algorithms typically rely on low - level image cues , _",
    "e.g. _ , edge , gradient and saliency  @xcite .",
    "for example , selective search  @xcite hierarchically merges the most similar segments to form proposals based on several low - level cues including color and texture ; edge boxes  @xcite scores a set of densely distributed windows based on edge strengths fully inside the window and outputs the high scored ones as proposals .",
    "recently , rpn  @xcite utilizes a fully convolutional network ( fcn )  @xcite to densely generate the proposals in each local patch based on several pre - defined `` anchors '' in the patch , and achieves state - of - the - art performance in object recall rate .",
    "nevertheless , object proposal algorithms assume that the proposals are independent and usually perform window - based classification on a set of reduced windows individually , which may still be wasteful for images containing only a few objects .    another type of works attempts  @xcite to reduce the number of windows with an active object detection strategy .",
    "et al . _",
    "@xcite proposed a branch - and - bound approach to find the highest scored windows while only evaluating a few locations .",
    "et al . _",
    "@xcite proposed a context driven active object searching method , which involves a nearest - neighbor search over all the training images .",
    "gonzeles - garcia _ et al . _",
    "@xcite proposed an active search scheme to sequentially evaluate selective search object proposals based on spatial context information .",
    "visual attention models are also related to our work .",
    "these models are often leveraged to facilitate the decision by gathering information from previous steps in the sequential decision making vision tasks .",
    "et al . _",
    "@xcite proposed an attention model embedded in recurrent neural networks ( rnn ) to generate captions for images by focusing on different regions in the sequential word prediction process .",
    "et al . _",
    "@xcite and ba _ et al . _",
    "@xcite also relied on rnn to gradually refine the focus regions to better recognize characters .",
    "perhaps @xcite and @xcite are the closest works to ours .",
    "@xcite learned an optimal policy to localize a single object through deep q - learning . to handle multiple objects cases",
    ", it runs the whole process starting from the whole image multiple times and uses an inhibition - of - return mechanism to manually mark the objects already found .",
    "@xcite proposed a top - down search strategy to recursively divide a window into sub - windows .",
    "then similar to rpn , all the visited windows serve as `` anchors '' to regress the locations of object bounding boxes .",
    "compared to them , our model can localize multiple objects in a single run starting from the whole image .",
    "the agent learns to balance the exploration of uncovered new objects and the refinement of covered ones with deep q - learning .",
    "moreover , our top - down tree search does not produce `` anchors '' to regress the object locations , but provides multiple near - optimal search paths and thus requires less computation .",
    "the tree - rl is based on a markov decision process ( mdp ) which is well suitable for modeling the discrete time sequential decision making process .",
    "the localization agent sequentially transforms image windows within the whole image by performing one of pre - defined actions .",
    "the agent aims to maximize the total discounted reward which reflects the localization accuracy of all the objects during the whole running episode .",
    "the design of the reward function enables the agent to consider the trade - off between further refinement of the covered objects and searching for uncovered new objects .",
    "the actions , state and reward of our proposed mdp model are detailed as follows .",
    "[ [ actions ] ] actions : + + + + + + + +    the available actions of the agent consist of two groups , one for scaling the current window to a sub - window , and the other one for translating the current window locally .",
    "specifically , the scaling group contains five actions , each corresponding to a certain sub - window with the size 0.55 times as the current window ( see fig .  [",
    "fig : actions ] ) . the local translation group is composed of eight actions , with each one changing the current window in one of the following ways : horizontal moving to left / right , vertical moving to up / down , becoming shorter / longer horizontally and becoming shorter / longer vertically , as shown in fig .  [",
    "fig : actions ] , which are similar to @xcite .",
    "each local translation action moves the window by 0.25 times of the current window size .",
    "the next state is then deterministically obtained after taking the last action .",
    "the scaling actions are designed to facilitate the search of objects in various scales , which cooperate well with the later discussed tree search scheme in localizing objects in a wide range of scales .",
    "the translation actions aim to perform successive changes of visual focus , playing an important role in both refining the current attended object and searching for uncovered new objects .",
    "[ [ states ] ] states : + + + + + + +    at each step , the state of mdp is the concatenation of three components : the feature vector of the current window , the feature vector of the whole image and the history of taken actions .",
    "the features of both the current window and the whole image are extracted using a vgg-16  @xcite layer cnn model pre - trained on imagenet .",
    "we use the feature vector of layer `` fc6 '' in our problem . to accelerate the feature extraction ,",
    "all the feature vectors are computed on top of pre - computed feature maps of the layer `` conv5_3 '' after using roi pooling operation to obtain a fixed - length feature representation of the specific windows , which shares the spirit of fast r - cnn .",
    "it is worth mentioning that the global feature here not only provides context cues to facilitate the refinement of the currently attended object , but also allows the agent to be aware of the existence of other uncovered new objects and thus make a trade - off between further refining the attended object and exploring the uncovered ones .",
    "the history of the taken actions is a binary vector that tells which actions have been taken in the past .",
    "therefore , it implies the search paths that have already been gone through and the objects already attended by the agent .",
    "each action is represented by a 13-d binary vector where all values are zeros except for the one corresponding to the taken action .",
    "50 past actions are encoded in the state to save a full memory of the paths from the start .",
    "[ [ rewards ] ] rewards : + + + + + + + +    the reward function @xmath0 reflects the localization accuracy improvements of all the objects by taking the action @xmath1 under the state @xmath2 . we adopt the simple yet indicative localization quality measurement , intersection - over - union ( iou ) between the current window and the ground - truth object bounding boxes .",
    "given the current window @xmath3 and a ground - truth object bounding box @xmath4 , iou between @xmath3 and @xmath4 is defined as @xmath5 .",
    "assuming that the agent moves from state @xmath2 to state @xmath6 after taking the action @xmath1 , each state @xmath2 has an associated window @xmath3 , and there are @xmath7 ground - truth objects @xmath8 , then the reward @xmath0 is defined as follows : @xmath9 this reward function returns @xmath10 or @xmath11 .",
    "basically , if any ground - truth object bounding box has a higher iou with the next window than the current one , the reward of the action moving from the current window to the next one is @xmath10 , and @xmath11 otherwise .",
    "such binary rewards reflect more clearly which actions can drive the window towards the ground - truths and thus facilitate the agent s learning .",
    "this reward function encourages the agent to localize any objects freely , without any limitation or guidance on which object should be localized at that step .",
    "such a free localization strategy is especially important in a multi - object localization system for covering multiple objects by running only a single episode starting from the whole image .    another key reward stimulation @xmath12 is given to those actions which cover any ground - truth objects with an iou greater than 0.5 for the first time . for ease of explanation ,",
    "we define @xmath13 as the hit flag of the ground - truth object @xmath14 at the @xmath15 step which indicates whether the maximal iou between @xmath14 and all the previously attended windows @xmath16 is greater than 0.5 , and assign @xmath10 to @xmath13 if @xmath17 is greater than 0.5 and @xmath11 otherwise . then supposing the action @xmath1 is taken at the @xmath15 step under state @xmath2 , the reward function integrating the first - time hit reward can be written as follows : @xmath18    the high reward given to the actions which hit the objects with an @xmath19 for the first time avoids the agent being trapped in the endless refinement of a single object and promotes the search for uncovered new objects .",
    "the tree - rl relies on a tree structured search strategy to better handle objects in a wide range of scales . for each window , the actions with",
    "the highest predicted value in both the scaling action group and the local translation action group are selected respectively .",
    "the two best actions are both taken to obtain two next windows : one is a sub - window of the current one and the other is a nearby window to the current one after local translation .",
    "such bifurcation is performed recursively by each window starting from the whole image in a top - down fashion , as illustrated in fig .",
    "[ fig : tree ] . with tree search ,",
    "the agent is enforced to take both scaling action and local translation action simultaneously at each state , and thus travels along multiple near - optimal search paths instead of a single optimal path .",
    "this is crucial for improving the localization accuracy for objects in different scales . because only the scaling actions significantly change the scale of the attended window while the local translation actions almost keep the scale the same as the previous one .",
    "however there is no guarantee that the scaling actions are often taken as the agent may tend to go for large objects which are easier to be covered with an iou larger than 0.5 , compared to scaling the window to find small objects .",
    "the optimal policy of maximizing the sum of the discounted rewards of running an episode starting from the whole image is learned with reinforcement learning .",
    "however , due to the high - dimensional continuous image input data and the model - free environment , we resort to the q - learning algorithm combined with the function approximator technique to learn the optimal value for each state - action pair which generalizes well to unseen inputs .",
    "specifically , we use the deep q - network proposed by  @xcite to estimate the value for each state - action pair using a deep neural network .",
    "the detailed architecture of our q - network is illustrated in fig .",
    "[ fig : archi ]",
    ". please note that similar to @xcite , we also use the pre - trained cnn as the regional feature extractor instead of training the whole hierarchy of cnn , considering the good generalization of the cnn trained on imagenet  @xcite .    during training , the agent runs sequential episodes which are paths from the root of the tree to its leafs . more specifically , starting from the whole image , the agent takes one action from the whole action set at each step to obtain the next state .",
    "the agent s behavior during training is @xmath20-greedy .",
    "specifically , the agent selects a random action from the whole action set with probability @xmath20 , and selects a random action from the two best actions in the two action groups ( _ i.e. _ scaling group and local translation group ) with probability @xmath21 , which differs from the usual exploitation behavior that the single best action with the highest estimated value is taken .",
    "such exploitation is more consistent with the proposed tree search scheme that requires the agent to take the best actions from both action groups .",
    "we also incorporate a replay memory following @xcite to store the experiences of the past episodes , which allows one transition to be used in multiple model updates and breaks the short - time strong correlations between training samples .",
    "each time q - learning update is applied , a mini batch randomly sampled from the replay memory is used as the training samples .",
    "the update for the network weights at the @xmath22 iteration @xmath23 given transition samples @xmath24 is as follows : @xmath25    where @xmath26 represents the actions that can be taken at state @xmath6 , @xmath27 is the learning rate and @xmath28 is the discount factor .",
    "we train a deep q - network on voc 2007 + 2012 trainval set  @xcite for 25 epochs .",
    "the total number of training images is around 16,000 .",
    "each epoch is ended after performing an episode in each training image . during @xmath20-greedy training",
    ", @xmath20 is annealed linearly from 1 to 0.1 over the first 10 epochs .",
    "then @xmath20 is fixed to 0.1 in the last 15 epochs .",
    "the discount factor @xmath28 is set to 0.9 .",
    "we run each episode with maximal 50 steps during training . during testing , using the tree search , one can set the number of levels of the search tree to obtain the desired number of proposals .",
    "the replay memory size is set to 800,000 , which contains about 1 epoch of transitions .",
    "the mini batch size in training is set to 64 .",
    "the implementations are based on the publicly available torch7  @xcite platform on a single nvidia geforce titan x gpu with 12 gb memory .",
    ".recall rates ( in % ) of tree - rl with different numbers of search steps and under different iou thresholds on voc 07 testing set .",
    "31 and 63 steps are obtained by setting the number of levels in tree - rl to 5 and 6 , respectively . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     & 85.9 & 79.3 & 77.1 & 62.1 & 53.4 & 77.8 & 77.4 & 90.1 & 52.3 & 79.2 & 56.2 & 88.9 & 84.5 & 80.8 & 81.1 & 51.7 & 77.3 & 66.9 & 82.6 & 68.5 & 73.7 +    [ tab:12 ]    [ [ visualizations ] ] visualizations : + + + + + + + + + + + + + + +    we show the visualization examples of the proposals generated by tree - rl in fig .",
    "[ fig : visual ] . as can be seen",
    ", within only 15 proposals ( the sum of level 1 to level 4 ) , tree - rl is able to localize the majority of objects with large or middle sizes .",
    "this validates the effectiveness of tree - rl again in its ability to find multiple objects with a small number of windows .",
    "in this paper , we proposed a novel tree - structured reinforcement learning ( tree - rl ) approach to sequentially search for objects with the consideration of global interdependency between objects .",
    "it follows a top - down tree search scheme to allow the agent to travel along multiple near - optimal paths to discovery multiple objects .",
    "the experiments on pascal voc 2007 and 2012 validate the effectiveness of the proposed tree - rl .",
    "briefly , tree - rl is able to achieve a comparable recall to rpn with fewer proposals and has higher localization accuracy . combined with fast r - cnn detector , tree - rl achieves comparable detection map to the state - of - the - art detection system faster r - cnn ( resnet-101 ) .",
    "the work of jiashi feng was partially supported by national university of singapore startup grant r-263 - 000-c08 - 133 and ministry of education of singapore acrf tier one grant r-263 - 000-c21 - 112 ."
  ],
  "abstract_text": [
    "<S> existing object proposal algorithms usually search for possible object regions over multiple locations and scales _ separately _ , which ignore the interdependency among different objects and deviate from the human perception procedure . </S>",
    "<S> to incorporate global interdependency between objects into object localization , we propose an effective tree - structured reinforcement learning ( tree - rl ) approach to sequentially search for objects by fully exploiting both the current observation and historical search paths . </S>",
    "<S> the tree - rl approach learns multiple searching policies through maximizing the long - term reward that reflects localization accuracies over all the objects . starting with taking the entire image as a proposal , the tree - rl approach allows the agent to sequentially discover multiple objects via a tree - structured traversing scheme . allowing multiple near - optimal policies , tree - rl offers more diversity in search paths and is able to find multiple objects with a single feed - forward pass . </S>",
    "<S> therefore , tree - rl can better cover different objects with various scales which is quite appealing in the context of object proposal . </S>",
    "<S> experiments on pascal voc 2007 and 2012 validate the effectiveness of the tree - rl , which can achieve comparable recalls with current object proposal algorithms via much fewer candidate windows . </S>"
  ]
}