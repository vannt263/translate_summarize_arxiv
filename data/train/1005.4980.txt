{
  "article_text": [
    "aerodynamic coupling between gas and solid bodies plays a crucial role in the dynamics of protoplanetary disks ( ppds ) and in planetesimal formation ( e.g. , @xcite ) . in ppds ,",
    "the gaseous disk is partially supported by the radial pressure gradient , and rotates at sub - keplerian velocity . on the other hand ,",
    "the solid particles are not affected by the pressure gradient and tend to orbit at keplerian velocity , resulting in relative motion and gas drag .",
    "the drag force is characterized by the stopping time @xmath3 , where in the absence of other forces , the particle velocity relative to gas would decrease with time as @xmath4 .",
    "it is most conveniently parameterized by the dimensionless stopping time , @xmath5 , where @xmath6 is the keplerian angular frequency .",
    "@xmath7 measures the strength of coupling between gas and solids and depends strongly on particle size and location in the ppds . in the epstein regime ( for particle size smaller than the gas mean free path , @xcite ) , which is most relevant in ppds @xcite , @xmath8 , where @xmath9 is the solid density of the particles , @xmath10 is the particle radius ( assuming spherical shape ) , @xmath11 is gas density and @xmath12 is gas sound speed . for the standard minimum mass solar nebular ( mmsn ) model @xcite ,",
    "@xmath13 roughly corresponds to meter sized bodies at 1 au .    in ppds ,",
    "dust grains settle to the disk midplane layer , and the interaction between gas and solids may generate kelvin - helmholtz instability ( khi ) @xcite and/or the streaming instability @xcite .",
    "hybrid simulations with both gas and solids are necessary to uncover the non - linear dynamics in the dusty midplane layer .",
    "in addition to the hydrodynamic solver , two ingredients are essential for such hybrid simulations : first , large number of super - particles are required to mimic the size distribution of real solids in the ppds .",
    "each super - particle represents a swarm ( billions or more ) of real particles with the same physical properties .",
    "although a two - fluid approach can be used to model the dusty disks ( e.g. , @xcite ) , the particle approach is necessary to account for a distribution of solid bodies with different physical properties , and when the solids are largely collisionless .",
    "the second ingredient is the aerodynamic interaction between gas and particles .",
    "in particular , the momentum feedback from particles to gas must be included , which is essential for the development of khi and streaming instability .",
    "hybrid codes of the kind mentioned above have been developed by several groups @xcite .",
    "one of the primary goals of this paper is to present the implementation of hybrid particle - gas integration scheme into the athena code , a new grid - based code for compressible magnetohydrodynamics ( mhd ) based on higher order godunov methods .",
    "a comprehensive description of the implementation and tests of the mhd algorithms are given in @xcite .",
    "the underlying hydrodynamic solver in athena is similar to the methods used in @xcite and @xcite , but quite different from the finite difference methods , used by @xcite and @xcite ( hereafter , yj07 and jy07 respectively ) .",
    "our implementation of the hybrid particle - gas scheme is different from any of the previous methods and has several novel features .",
    "first of all , in solving the coupled equations of gas and particles in hybrid simulations , the problem becomes difficult when the particles are strongly coupled to the gas ( i.e. , @xmath14 ) , so that the coupled equations become very stiff .",
    "this is especially relevant to submillimeter dust grains .",
    "we have developed a semi - implicit and a fully - implicit particle integrators that can handle most particle - gas coupling regimes relevant for ppds .",
    "secondly , our semi - implicit particle integrator naturally generalizes from the leap - frog type integrator , and preserves geometric properties of particle orbits .",
    "thirdly , our hybrid scheme conserves linear momentum to machine accuracy .",
    "we show a suite of test problems to demonstrate the performance of our particle integrators and the hybrid scheme .",
    "in particular , we show that using the fully - implicit integrator is necessary when the particle stopping time is less than the numerical time step .",
    "further , we test and compare our code with @xcite , @xcite , @xcite , and @xcite .",
    "yj07 provides two eigen - vectors of the unstable modes of the streaming instability .",
    "measuring the linear growth rates of these unstable modes and comparing them with theoretical values constitutes a stringent test problem of the hybrid code .",
    "jy07 studied the non - linear saturation of the streaming instability with a set of model parameters .",
    "they investigated a variety of physical quantities as measured from their simulations .",
    "we show that our code reproduces these published results .",
    "finally , we present a systematic study of the numerical convergence on the simulations of the streaming instabilities . although jy07 performed some experiments to test the convergence of their numerical results , they did not carry out a systematic study on this subject .",
    "we pick two representative runs from jy07 , and repeat the simulations with different grid resolution , and different number of particles in the simulation box . the results from our study",
    "provides useful insights in understanding the uncertainties of various physical quantities as measured from such hybrid simulations .",
    "this paper is organized as follows .",
    "the formalism and the hybrid particle - gas integration scheme of our code is presented in  [ sec : hybrid ] . in  [ sec : integrator ] , we describe and discuss two implicit particle integrators that solves the stiffness problem .",
    "we provide a suite of test problems to demonstrate our code performance in  [ sec : test ] . in ",
    "[ sec : converge ] , we systematically study the numerical convergence of the streaming instability in the saturation state .",
    "we summarize and conclude our paper in ",
    "[ sec : conclusion ] .",
    "motivated by the study of the streaming instability in the context of ppds ( e.g. , @xcite ) , we formulate the equations with the local shearing sheet approximation @xcite .",
    "the source terms in this approximation can be dropped to study other problems .",
    "we choose a local reference frame located at a fiducial radius , corotating at the orbital angular velocity @xmath6 .",
    "the dynamical equations are written using the cartesian coordinate , with @xmath15 denoting unit vectors pointing to the radial , azimuthal and vertical direction . in this non - inertial frame , the coupled equations of particles and gas read @xmath16 @xmath17 @xmath18\\ .",
    "\\label{eq : gasmotion}\\ ] ] in the above equations , @xmath11 , @xmath19 denote the mass density and pressure of the gas , @xmath20 is the background shear parameter , with @xmath21 for keplerian flow , and @xmath22 , @xmath23 denote velocities of the gas and particles in this reference frame . the subscript",
    " @xmath24 \" in equation ( [ eq : dustmotion ] ) represents the @xmath24th particle .",
    "the particle stopping time due to gas drag , @xmath3 , depends on particle size and gas flow properties @xcite .",
    "our code is capable of dealing with an arbitrary number of different particle species ( each particle species has a different stopping time ) , but unless otherwise stated , we assume single particle species with constant stopping time throughout this paper for simplicity .",
    "in equation ( [ eq : gasmotion ] ) , @xmath25 stands for averaged particle velocity in the  fluid element \" ( weighted by mass ) , and @xmath26 denotes the local mass density ratio between particle and gas @xmath27 .",
    "this term represents momentum feedback from the particles to the gas , written in the form of treating particles as a fluid .",
    "the particle treatment of feedback term is described in  [ ssec : scheme ] , and conservation of total momentum is guaranteed . in this paper , we consider non - stratified disks by neglecting vertical gravity terms in the equations above ( i.e. , the @xmath28 terms )",
    ". we also neglect terms associated with the magnetic field in this paper .",
    "they are handled by the underlying mhd integrators in athena @xcite .",
    "an isothermal equation of state for the gas is used throughout this paper , with @xmath29 .",
    "our goal is to perform the local shearing box simulations @xcite , where the radial boundary condition is periodic with additional shear to account for differential rotation .",
    "therefore , it is not appropriate to include radial pressure gradient directly , which is inconsistent with the periodic boundary conditions .",
    "alternatively , one can replace the pressure gradient by a constant radial force acting on the gas @xmath30 , pointing _",
    "outward_. the quantity @xmath31 measures the amount by which the gas ( azimuthal ) velocity is reduced from the keplerian value due to the radial pressure gradient . in our code , instead , we find it more convenient not to modify the hydrodynamic integrator , but to add a constant radial force on the particles , pointing _",
    "inward_. our treatment is mathematically equivalent to the effect of a radial pressure gradient , but both particle and gas ( azimuthal ) velocities are shifted to slightly larger value , by @xmath31 .",
    "an orbital advection scheme @xcite has been implemented in athena , which takes the advantage of the fact that the above equations can be split into two systems , one of which corresponds to linear advection operator with background flow velocity @xmath32 and the other involves only velocity fluctuations @xcite .",
    "we use the orbital advection scheme in all our simulations , not only because it is it is faster , but also more accurate .",
    "the same technique can be implemented to the particles , with equation ( [ eq : dustmotion ] ) replaced by @xmath33 where @xmath34 , and @xmath35 .",
    "an particle advection step of is then carried out in parallel with the orbital advection of gas .",
    "also note that we ve included the effect of gas radial pressure gradient in the first term on the right hand side of equation ( [ eq : dustfargo ] ) .",
    "the mhd integrator in athena adopts a directionally unsplit , higher - order godunov method , which conserves mass , momentum and energy ( when applicable ) to machine accuracy .",
    "our goal is to develop a particle - gas hybrid integrator that is also conservative and at least second order accurate .",
    "two mhd integrators have been implemented in the athena code , including the cornered transport upwind ( ctu ) integrator @xcite and the van - leer ( vl ) integrator @xcite .",
    "our particle scheme is combined with the ctu integrator , which is more accurate and less diffusive @xcite . in our implementation , the momentum ( and energy ) feedback to the gas",
    "is treated as source terms ( different from @xcite ) , while the evaluation of transverse flux gradient in the hydrodynamic solver is unchanged .",
    "the gas continuity equation is automatically handled in the godunov scheme , with no modifications to the code needed .",
    "the hybrid particle - gas scheme adopt a predictor - corrector approach , which is described below .    to demonstrate the numerical algorithm , we rewrite the coupled particle - gas momentum equations . for the gas momentum equation , we simplify the left hand side of equation ( [ eq : gasmotion ] ) to a lagrangian derivative , since we do not modify the calculation of the flux gradients in the ctu integrator",
    ". we use @xmath36 and @xmath37 to denote source terms for the acceleration of particles and gas respectively , due to forces other than the drag force ( e.g. , coriolis force , tidal force and the global pressure gradient ) . the formalism in  [ ssec : formalism ] can be summarized as @xmath38 @xmath39 we do not distinguish between ( @xmath40 ) and ( @xmath41 ) here because it does not affect our description of the numerical algorithms .",
    "our predictor - corrector scheme , which integrates the coupled equations from time step @xmath42 to @xmath43 , can be illustrated as    [ eq : scheme ] @xmath44\\ , \\label{eq : scheme2}\\\\ ( \\rho_g{\\boldsymbol}{u})^{(n+1)}&=(\\rho_g{\\boldsymbol}{u})^{(n)}+h(\\rho_g{{\\boldsymbol}g})^{(n+1/2)}+ \\sum_iw({{\\boldsymbol}x}-{{\\boldsymbol}x}_i^{(n+1/2)})\\delta{{\\boldsymbol}p}_i^{\\rm corr}\\ , \\label{eq : scheme3}\\end{aligned}\\ ] ]    in the above , ( [ eq : scheme1 ] ) and ( [ eq : scheme3 ] ) are generalizations of the predictor and corrector step of the mhd integrator , and particle feedback to gas is expressed as @xmath45 and@xmath46 for the two steps respectively .",
    "their expressions are given in the following paragraphs .",
    "@xmath47 is the weight function for interpolation ( see next paragraph ) .",
    "( [ eq : scheme2 ] ) represents the particle integrator , which we will discuss in detail in ",
    "[ sec : integrator ] . note that in the bracket on the right hand side of this equation , particle quantities @xmath48 and @xmath49 can be combinations of step @xmath50 and step @xmath51 quantities , depending on the particle integrator .",
    "the calculation of the drag force experienced by particles requires interpolation of grid quantities to the particle location on the grid .",
    "the interpolation scheme is described by the weight function @xmath52 . for consistency ,",
    "the same interpolation scheme is used to distribute the feedback from individual particles to the gas grid points , as in equation ( [ eq : scheme ] ) . in order",
    "avoid spurious numerical artifacts in the hybrid scheme , the weight function @xmath47 should satisfy certain constrains",
    ". it should be continuous over the computational domain to avoid sharp transitions , and @xmath53 should be non - negative for any @xmath54 to reduce noise @xcite .",
    "the interpolation should be accurate enough to minimize errors .",
    "in particular , interpolation error should not be much worse than the error from the spacial reconstruction of the mhd integrator ( we use the third order piecewise parabolic method ) .",
    "finally , interpolation is time consuming , so the scheme should be as efficient as possible .",
    "we have compared three interpolation schemes ( cf.@xcite , yj07 ) , namely , cloud - in - a - cell ( cic ) , triangular - shaped cloud ( tsc ) and quadratic polynomial ( qp ) .",
    "the cic scheme is simple but inaccurate and noisy , the qp scheme is the most accurate but not continuous .",
    "similar to jy07 , we choose the tsc interpolation scheme throughout this paper .    in the predictor step",
    ", the momentum feedback from individual particles is calculated from direct force evaluation , multiplied by half a time step . however , when the particle stopping time is small , the drag force diverges , and the error in the velocity calculation and interpolation can be substantially amplified .",
    "we note that in the absence of other forces , the particle velocity would approach gas velocity as @xmath4 .",
    "therefore , we modify the predictor step momentum feedback ( from individual particle  @xmath24 \" ) into @xmath55 where @xmath56 is the particle mass .",
    "we do not use the exponential expression because it is derived by assuming drag force only .",
    "our treatment is the same order accurate as the exponential expression ( first order ) when @xmath57 , and when @xmath58 , it ensures exact force balance at equilibrium state ) , one starts from the nsh equilibrium .",
    "our treatment allows nsh equilibrium to be satisfied exactly .",
    "] . the individual particle feedback is then distributed to neighboring grid cells . as a source term , the momentum feedback is divided by gas density and is added to the left and right states of primitive variables ( gas velocity ) between step 1 and step 2 of the ctu algorithm as described in @xcite .    for the feedback calculation in the corrector step , note that the particles have already evolved for a full time step",
    ", we can calculate the momentum difference of individual particles between the two steps @xmath50 and @xmath51 .",
    "let @xmath59 denote forces experienced by particles other than the drag force .",
    "since @xmath59 is generally non - stiff ( e.g. , coriolis force ) , we can obtain momentum feedback from particle @xmath24 to be @xmath60 where @xmath61 is evaluated at @xmath62 , the midpoint between @xmath63 and @xmath64 , which ensures second order accuracy .",
    "this treatment is conservative and guarantees exact momentum conservation .",
    "moreover , it avoids the potential stiffness due to the direct evaluation of the drag force . to distribute the feedback to grid points ,",
    "we again take the force location at @xmath62 , as indicated in equation ( [ eq : scheme3 ] ) .",
    "the corrector step feedback is added to the end of the gas integrator .",
    "if one considers the disk thermodynamics ( not treated in this paper ) , the heat generated by friction needs to be deposited to the energy equation of the gas , with energy dissipation rate ( per unit volume ) @xmath65 the heating term is contributed from the work done by the pressure gradient and is typically only a small amount compared with the disk thermal energy budget ( see yj07 for more details ) .",
    "numerically , potential stiffness problem also exists since @xmath3 is present in the denominator . in practice",
    "we rewrite the energy deposition rate from particle @xmath24 to be @xmath66 , where @xmath67 is particle mass and @xmath68 is taken from equations ( [ eq : fbpred ] ) and ( [ eq : fbcorr ] ) for predictor and corrector steps .",
    "the overall accuracy of our hybrid scheme is second order , less than the pencil code , which is a finite - difference code with higher order accuracy in smooth flows .",
    "however , our code is fully conservative , and it does not need to be stablized by artificial hyper - viscosity .",
    "it also allows the development of implicit particle integrator ( see next section ) much easier .",
    "recently , @xcite has proposed a similar predictor - corrector hybrid scheme for particle - gas dynamics , but approximation is made in the corrector step ( see their equation ( 16 ) and the discussion that follows ) and is less accurate when dust dominates local density .",
    "@xcite has described another hybrid scheme that is fully implicit , but assumes only one particle species .",
    "our predictor - corrector scheme is simpler than these other approaches , allows an arbitrary number of particle species , while we will show in  [ sec : test ] and  [ sec : converge ] that our code performance is at least comparable to all these codes .",
    "one disadvantage of our predictor - corrector hybrid scheme is that it is intrinsically explicit , and may cause numerical instability when the coupled equations are stiff . here",
    ", the stiffness is caused by the parameter @xmath26 , the _ local _ particle to gas mass ratio .",
    "the design of the particle integrators assumes that particles move in the gas velocity field . in the regime",
    "where @xmath69 , our semi - implicit and fully - implicit schemes force particles to be strictly coupled to the gas . however , when @xmath70 , gas is expected to follow the particles .",
    "this situation may result in unphysically large growth of particle and gas velocities , making the hybrid code unstable .",
    "more specifically , we define the stiffness parameter @xmath71 in the above expression we have generalized our analysis to include a size distribution of particles , and subscript  @xmath72 \" labels different particle types .",
    "our hybrid scheme can become unstable when @xmath73 exceeds order unity .",
    "our experiments show that the threshold value of @xmath73 is about @xmath74 ( depending on the actual problem ) .",
    "one way to remedy the stiff particle mass loading problem discussed above is to make the overall hybrid scheme implicit}$ ] in the predictor step ( not in the corrector step , otherwise momentum conservation would break down ) .",
    "this approach reduces the accuracy of the code to first order , but improves the stability . ] .",
    "this is relatively easy to do if all particles have a single size , and the treatment will be similar to a two - fluid approach @xcite .",
    "however , the two - fluid treatment is not easily generalized to a size distribution of particles .",
    "this is because particles with different sizes are ( indirectly ) coupled to each other via interactions with the gas , and evolving the coupled equations implicitly requires solving an inverse matrix of rank @xmath75 at each grid cell , where @xmath76 is the number of particle size bins .",
    "the matrix is non - diagonal due to the coupling .",
    "as @xmath76 gets larger and larger , the algorithm becomes more and more complicated and computationally prohibitive .",
    "alternatively , in regions where @xmath73 exceeds certain thresholds , one can effectively increase the value of @xmath3 for all local particles to bring down the value of @xmath73 , which guarantees stability , as is adopted in the pencil code ( a. johansen , private communication , 2010 ) .",
    "physically , this means in dense particle clumps , particles can move more freely and are less affected by gas drag , while just sufficient momentum feedback is added to the gas for it to follow the motion of particles without causing any numerical instability .",
    "we have implemented this technique that enforces @xmath77 in our code , although in practice , this feature is turned off due to the reasons below .",
    "fortunately , in the context of ppds , the overall dust to gas mass ratio is about one percent .",
    "therefore , in an average sense , @xmath78 is much less than unity .",
    "@xmath78 can become larger when dust grains settle towards the disk midplane .",
    "the typical time step in the simulations is about @xmath79 . for dust grains with stopping time @xmath80",
    ", one can easily show that even very weak turbulence is able to make these solids suspended in the disks , keeping @xmath78 relatively small at disk midplane prescription @xcite , the average value of @xmath73 in disk midplane can be estimated by @xmath81}/\\alpha)^{1/2}$ ] , where @xmath82 is the ratio of dust surface density over gas surface density , typically @xmath83 .",
    "thus fairly weak turbulence @xmath84 is sufficient to keep @xmath85 well below unity . ] .",
    "concentration of particles can raise @xmath73 locally .",
    "in the case of the streaming instability , however , particle concentration is most efficient for marginally coupled solids @xmath86 .",
    "clumping of these particles only raises @xmath73 very slowly according to equation ( [ eq : stiffness ] ) . in our simulations of the si in  [ sec : converge ] ,",
    "the maximum value of @xmath73 never exceed the threshold @xmath87 ( see  [ ssec : concentration ] for more details ) .",
    "we emphasize that the value of @xmath73 only determines stability , but does not constrain the maximum particle density . in some of our stratified disk simulations with large solid abundance ( 5 - 7 times super - solar , @xcite ) , we do observe the numerical instability and have to reduce the time step in our calculations .",
    "in this section , we describe in detail the particle integrator that have been implemented in our particle - gas hybrid scheme [ i.e. , equation ( [ eq : scheme2 ] ) ] .",
    "the overall problem for the particle integrator is @xmath88\\ , \\ ] ] where @xmath89 denotes the acceleration due to all the forces , including the gas drag , and following the convention of equation ( [ eq : scheme ] ) .",
    "as suggested in equation ( [ eq : scheme2 ] ) , we use half time step gas velocities @xmath90 to avoid tracking the evolution of gas , which also ensures second order accuracy . for the sake of simplicity , in the remaining of this section , we will drop the superscript @xmath91 in the gas quantities .    as we have noted before",
    ", the gas drag term becomes stiff for strongly coupled particles .",
    "we have developed two second - order implicit particle integrators .",
    "each integrator has its own pros and cons . in our code , we allow different species of particles to be pushed by different integrators , which enable us to integrate particles with any stopping time while maintaining the geometric properties of particle orbits .",
    "our first integrator is a semi - implicit scheme based on the crank - nicholson method .",
    "the basic algorithm is the following .",
    "@xmath92\\ , \\\\ { { \\boldsymbol}x}^{(n+1)}=&{{\\boldsymbol}x}'+h{{\\boldsymbol}v}^{(n+1)}/2\\ , \\\\",
    "\\end{split}\\label{eq : semiimp}\\ ] ]    where @xmath93 is the predicted particle position at @xmath94 , and is used to evaluate the stopping time and the gas velocity .",
    "this scheme is semi - implicit in the sense that the velocity update depends on velocities in both step @xmath50 and step @xmath51 . converting to explicit form",
    ", we find @xmath95 where the jacobian @xmath96 is evaluated at @xmath97 , with @xmath98 we always use the orbital advection algorithm @xcite , therefore the @xmath99 factor in the matrix element . after calling the particle integrator ,",
    "we need to shift the particle positions by an amount @xmath100 . in practice , we replace @xmath101 by @xmath102/2 $ ] .",
    "we emphasize that using the particle advection scheme is important for improving the accuracy of the particle integrator , and especially , preserve the geometric properties of particle orbits ( see below ) .",
    "this semi - implicit integrator has close analogy to the boris integrator due to the similarity between coriolis force and lorentz force .",
    "it is essentially a leap - frog integrator , in the form of  drift - kick - drift \" ( dkd ) . in ",
    "[ sec : test ] , we will see that in the limit @xmath103 , this integrator preserves geometric orbital properties exactly .",
    "recently , @xcite has proposed a symplectic particle integrator for hill s equations , which is essentially in the form of  kick - drift - kick \" . in their work ,",
    "particle advection was not implemented , making their formula slightly more complicated than ours .",
    "this integrator , although is implicit , can still cause problems when the particle stopping time approaches zero ( i.e. , when @xmath104 ) . in this limit , the position update reduces to @xmath105 , which is indeed second order accurate .",
    "however , the velocity update reduces to @xmath106 .",
    "if the initial velocity difference between particle and gas is large , then particle velocity will oscillate around the gas velocity without damping .",
    "more seriously , the evolution of gas velocity may even amplify the velocity difference between particle and gas , causing a runaway .",
    "our experiences indicate that this integrator works safely at least for @xmath107 .",
    "one can construct other similar second order semi - implicit , crank - nicholson type schemes .",
    "nevertheless , the only other possibility one can achieve in the @xmath108 limit is @xmath109 , which is prone to the same problem .",
    "also , other schemes no longer maintain geometric properties of particle orbits .",
    "the apparent weakness of any types of the semi - implicit method leads us to develop an absolutely stable , second order integration scheme . to be absolutely stable",
    ", we demand the method to be _ fully implicit _ , that is , the velocity update to step @xmath51 depends only on velocity at step @xmath51 . for a simple ordinary differential equation @xmath110 ,",
    "a second order fully - implicit scheme can be constructed as @xmath111/2\\ .\\ ] ] other second order fully - implicit schemes are possible , but we will stick to this specific form . the implementation of this method to the particle integrator is illustrated as follows @xmath112 , { { \\boldsymbol}x}^{(n)}\\bigg)\\ , \\\\ { { \\boldsymbol}x}^{(n+1)}&={{\\boldsymbol}x}^{(n)}+\\frac{h}{2}\\bigg({{\\boldsymbol}v}^{(n)}+{{\\boldsymbol}v}^{(n+1)}\\bigg)\\ , \\\\ \\end{split}\\label{eq : fullimp}\\ ] ] where we have omitted the fluid argument @xmath90 for conciseness , and we assume that @xmath113 is evaluated at the same position ( @xmath97 or @xmath63 ) as in @xmath89 . it can be easily shown that in the limit @xmath114 , the above equations demand that @xmath115 .",
    "although this is not second order accurate , the position update is indeed second order .",
    "therefore , we achieve second order accuracy with absolute stability .    the main work is to update the velocity , and to the second order , we find @xmath116\\ , \\\\",
    "\\lambda&=1-\\frac{h}{2}\\bigg(\\frac{{\\partial}{\\boldsymbol}a}{{\\partial}{\\boldsymbol}v}\\bigg|_1+\\frac{{\\partial}{\\boldsymbol}a}{{\\partial}{\\boldsymbol}v}\\bigg|_0-h\\frac{{\\partial}{\\boldsymbol}a}{{\\partial}{\\boldsymbol}v}\\bigg|_0\\frac{{\\partial}{\\boldsymbol}a}{{\\partial}{\\boldsymbol}v}\\bigg|_1\\bigg)\\ , \\\\ \\end{split}\\ ] ] where the subscript  0 \" means to evaluate the jacobian at @xmath63 ,  1 \" means to evaluate at @xmath97 ( note that the stopping time can depend on position in the most general case ) .",
    "the inverse matrix @xmath117 can be evaluated analytically without any trouble , since it involves only the inversion of a @xmath118 matrix .",
    "alternatively , it suffices to evaluate the inverse matrix up to first order in @xmath119 , except for terms containing @xmath120 , where all orders of @xmath119 should be kept .",
    "the result is @xmath121    from equation ( [ eq : inverse ] ) , we see that as @xmath108 , @xmath122 .",
    "therefore , this integrator is stable for any @xmath123 .",
    "one disadvantage of this integrator is that it no longer preserves geometric properties of particle orbits as @xmath124 .",
    "in fact , like the explicit method , any fully - implicit method always fail to preserve such geometric properties ( see  [ ssec : epicycle ] ) .",
    "therefore , we will in most cases use the semi - implicit particle integrator , while we switch to this fully - implicit integrator for particles with @xmath69 .",
    "an alternative way of integrating the strongly coupled particles is to use the  short friction time \" approximation introduced by @xcite . in this approximation ,",
    "particles can be considered as being carried with the gas , while maintaining a small drift velocity due to some external force @xmath125 . meanwhile",
    ", the gas also feels some external force @xmath126 other than the drag .",
    "@xmath126 is in general different from @xmath125 , since particles do nt have pressure support , and generally do nt feel the magnetic field . in this approximation ,",
    "particle velocity is assumed to be always equal to the termination velocity @xmath127 one can then easily integrate particle orbit based on this expression to any order of accuracy .",
    "we note that leading truncation error of this approximation is of the order @xmath128 @xmath129 $ ] , where @xmath130 . roughly speaking , the short friction time approximation is applicable for stopping time @xmath131 .",
    "converting the above into a second order integrator further introduces truncation error of the order @xmath132 .",
    "therefore , this integrator may perform equally well as our fully - implicit integrator only when @xmath133",
    ". the original implementation of @xcite did not include the momentum feedback , thus can not be used to study the si .",
    "however , it can be extended to include feedback as described in ",
    "[ ssec : scheme ] .",
    "nonetheless , we do not implement this integrator in our code since we have the fully - implicit integrator at hand .",
    "we begin by examining the performance of the particle integrators in the weak coupling limit , i.e. , @xmath103 , so gas drag does not enter the problem . from the particle equation of motion ( [ eq : dustmotion ] ) , the particle trajectory follows an epicyclic orbit : @xmath134 where @xmath135 denote radial and azimuthal directions relative to domain center , and @xmath136 is the radial amplitude of the oscillation .",
    "epicyclic motion conserves total energy @xmath137        we integrate a test particle and follow its epicyclic orbit using different particle integrators and examine the particle trajectory and energy conservation . in particular , we consider three 2nd order integrators , namely , the semi - implicit and fully - implicit integrators introduced in  [ sec : integrator ] , and we add an explicit integrator based on the modified euler method for comparison purpose . in figure",
    "[ fig : epicycle ] , we see that the semi - implicit method conserves total energy exactly .",
    "the particle orbit is closed , and the truncation error exhibits as a phase shift relative to the analytical solution .",
    "the phase error diminishes as @xmath138 ( not shown in the figure ) , as expected .",
    "note that in order to make the errors significant , we have chosen a rather large time step @xmath139 . in typical numerical simulations ,",
    "the time step and thus phase error is much smaller . from figure [",
    "fig : epicycle ] , we also see that the test particle gains energy and drifts away from the guiding center when using the explicit method , while it loses energy and gyrates into the guiding center when using the fully - implicit method .",
    "this result is quite general .",
    "this test demonstrates that the semi - implicit method preserves the geometric properties of particle orbits , and moreover , it is efficient because it evaluates the drag force ( therefore interpolation ) only once per step .",
    "therefore , in most applications we prefer to use this integrator .       in the particle - gas deceleration test .",
    "we choose the particle to gas mass ratio to be 1 , and the initial velocities of particles and gas are both 1 , but in opposite directions .",
    "the particle stopping time is set to @xmath140 .",
    "errors are measured at @xmath141 .",
    "red squares : semi - implicit integrator ; black circles : fully - implicit integrator.,width=283,height=264 ]    in the second problem , we consider the motion of a collection of particles in a uniform gas .",
    "the spatial distribution of the particles is uniform .",
    "gas drag and feedback are included in the test .",
    "we work in the frame where the total momentum in particles and gas is zero .",
    "let @xmath142 be the particle initial velocity , then all the particles evolve as @xmath143\\ , \\ ] ] where @xmath26 is the overall particle to gas mass ratio , and @xmath144 is the distance a particle has traveled .    in our first test ,",
    "we choose @xmath145 , and gas with density @xmath146 .",
    "we evolve the system to @xmath147 with constant time step @xmath119 using the semi - implicit and the fully - implicit integrators . in figure",
    "[ fig : collision]a we plot the position error @xmath148 at @xmath147 as a function of @xmath119 .",
    "it is clear that the cumulative position error scales with @xmath138 , indicating that our particle - gas hybrid code has achieved second order accuracy .",
    "figure [ fig : collision]b shows the total momentum density at @xmath147 as a function of @xmath119 .",
    "we see that our hybrid scheme conserves linear momentum within machine accuracy ( to the level of @xmath149 ) . the total momentum at @xmath147 increases with decreasing @xmath119 , which reflects the accumulation of round - off error with increasing number of time steps . for uncorrelated round - off errors , one would expect @xmath150 scaling .",
    "the slightly steeper slope reflects a certain level of correlation in the round - off errors .    .",
    "panels ( a ) and ( b ) show the results from the semi - implicit integrator and fully - implicit integrator respectively .",
    "black circles connected by red solid lines : @xmath151 .",
    "black squares connected by blue solid lines : @xmath152 . in panel",
    "( b ) , we further show expected evolution of velocity in the two cases : red dashed line for @xmath151 and blue dash - dotted line for @xmath152 .",
    "note that in panel ( a ) we use a linear scale while in panel ( b ) we use a log scale.,width=283,height=283 ]    next we test the integrators in the stiff regime . to do so",
    ", we fix the time step @xmath153 , and choose @xmath3 to be less than @xmath119 .",
    "the other parameters are the same as in the previous test ( @xmath154 ) .",
    "we evolve the system to @xmath155 , using @xmath151 and @xmath152 . in figure",
    "[ fig : collision2 ] we show the time evolution of particle velocity from the semi - implicit and the fully - implicit integrators .",
    "we see that with the fully - implicit integrator , the particle velocity ( thus the gas velocity , due to momentum conservation ) rapidly drops to zero , and smaller @xmath3 leads to faster damping [ actually @xmath156 .",
    "because @xmath3 is not resolved , the damping rate is slower than theoretical values , but still is rapid as relative velocity @xmath157 drops several orders of magnitude in each time step . with the semi - implicit integrator",
    ", however , the particle velocity undergoes damped oscillation .",
    "the smaller @xmath3 is , the slower the particle velocity damps [ actually @xmath158 , opposite to the trend found in the fully - implicit integrator . in the limit @xmath114",
    ", the particle velocity never dies away .",
    "the behavior of the semi - implicit integrator in this regime exactly resembles a damped harmonic oscillator , which makes it difficult for particles to get rid of extra relative velocity with respect to gas .",
    "this situation is problematic because if the gas itself undergoes some other oscillation with a similar frequency , the amplitude of the oscillator may be quickly amplified rather than damped due to ( numerical ) resonant interactions .",
    "therefore , for stability considerations , we use the fully - implicit integrator when @xmath69 .",
    "the most stringent test of our code is the streaming instability linear growth rate test using eigenmodes provided by yj07 .",
    "these eigenmodes are built from the nakagawa - sekiya - hayashi ( nsh ) equilibrium [ @xcite ; also see equation ( 7 ) of yj07 ] .",
    "the nsh equilibrium refers to the equilibrium between solids and gas in unstratified keplerian disks , in which gas is partially supported by a radial pressure gradient .",
    "establishing the nsh equilibrium numerically requires exact balance among all force terms . with the help of the particle advection scheme as well as careful treatment of predictor and corrector step momentum feedback ( see  [ sec : hybrid ] and  [ sec : integrator ] for details ) , we are able to establish the _ exact _ nsh equilibrium in our code ( i.e. , net force on both the gas and particles is zero to machine precision ) .",
    "the eigenmodes of the streaming instability are characterized by dimensionless wave numbers @xmath159 and @xmath160 .",
    "taking @xmath161 and setting the box size to be one wavelength , we have @xmath162 , and similarly in the @xmath163 direction .",
    "we fix the box size to be @xmath164 , therefore , @xmath165 ( and @xmath166 ) sets the sound speed .",
    "we construct eigenvectors of density and velocity perturbations using formula ( 10 ) and table 1 in yj07 .",
    "we use one particle per cell and each particle is located at cell center initially . in order to generate particle density profile of @xmath167 ( we take @xmath168 ) , we shift particle positions in the radial ( @xmath101 ) direction , with the amount of shift proportional to @xmath169 .",
    "the test suite in yj07 aims at measuring the numerical growth rate of the streaming instability eigenmodes as a function of grid resolution .",
    "it consists of two problems , both using @xmath1 particles .",
    "the test  lina \" has particle to gas mass ratio @xmath170 and @xmath171 .",
    "the predicted growth rate is @xmath172 .",
    "the second test  linb \" has @xmath173 and @xmath174 .",
    "this test is more challenging because the mode grows very slowly , with @xmath175 .",
    ", the sound speed is smaller than the  lina \" test , thus larger time step . ]",
    "we consider grid resolutions of 16 , 32 , 64 and 128 cells per wave length .",
    "figure [ fig : streaminglin ] shows our test results using the semi - implicit integrator . in each test , we conduct two set of runs , one with fixed courant - friedrichs - lewy number cfl=0.8 , and the other with a fixed time step ( or cfl=0.1 , 0.2 , 0.4 , 0.8 for each resolution ) . for reference ,",
    "the time step with lowest resolution ( 16 cells per wavelength ) and cfl=0.8 is @xmath176 for  lina \" and @xmath177 for  linb \" .",
    "both semi - implicit and fully - implicit methods are considered , and the results are almost identical ( since the time step is much smaller than @xmath3 ) .",
    "we see that our code converges very well to the predicted growth rate in the run  lina \" .",
    "small time step helps with convergence . for the more",
    "challenging  linb \" test , we get slower convergence . in particular",
    ", the mode does not grow for 32-cell resolution using cfl=0.8 .",
    "better temporal resolution again improves the performance .",
    "these test results show that with cfl=0.8 , about 64 cells are needed to see growth ( e.g. , test linb ) , although 16 cells seem to be sufficient to capture the most unstable modes ( e.g. , test lina ) .",
    "viewed from the results , our measured linear growth rates are similar to ( and even closer to semi - analytic values than ) those of @xcite and @xcite , who employ similar mhd code but different hybrid schemes .",
    "our method is less accurate than that presented in yj07 , which is not surprising given the fact that our code is second order accurate ( both spatial and temporal ) while the pencil code used by yj07 is sixth order spatial and third order temporal accurate for smooth flows , such as in this test .",
    "the test problems  lina \" and  linb \" provided in yj07 both adopt relatively large particle stopping time @xmath1 .",
    "since we will perform si simulations on a size distribution of particles with stopping time down to @xmath178 , additional code test is needed to justify the ability of our code . in appendix",
    "[ app : lin ] , we provide two more linear growth tests for particles with @xmath179 and @xmath180 . numerical convergence to the analytical growth rate is again achieved , although slightly higher resolution is required to reach the convergence .",
    "as an application of our hybrid code , we study the streaming instability in the non - linear regime .",
    "such calculations have been performed and comprehensively analyzed by jy07 . in this paper , we focus on the numerical convergence of physical properties in the saturated state , which was not fully explored in jy07 . understanding the convergence properties of hydrodynamic simulations of the streaming instabilities is important before adding more complicated physics ( such as mhd ) , and interpreting the reliability of such simulations .",
    "we study the numerical convergence using 2d simulations in the @xmath181 ( radial - vertical ) plane in which both the grid resolution and the number of ( super- ) particles vary . by using 2d simulations",
    ", we can explore a wide range of resolutions that is not possible in fully 3d simulations .",
    "moreover , the results of 2d and 3d simulations are similar ( jy07 ) , thus one expects the numerical convergence properties of 2d simulations are similar to those in 3d as well .",
    "the two most significant effects of the streaming instability are the concentration of particles into dense clumps , and the generation of turbulence and/or waves .",
    "the former can be characterized by the probability distribution function ( pdf ) of particle densities , while the latter can be characterized by the turbulent velocity , diffusion coefficient and momentum flux .",
    "we investigate the numerical convergence of these two aspects in  [ ssec : concentration ] and  [ ssec : turbulence ] respectively .",
    "we perform simulations of the streaming instability using an isothermal equation of state and neglecting vertical gravity . in this case , the properties of the streaming instability is largely determined by two parameters , the particle stopping time @xmath7 and the overall mass ratio between particles and gas @xmath26 .",
    "the drift velocity @xmath31 does not serve as an independent variable , but it sets the length scale of the problem , that is , all length scales can be measured in units of @xmath182 .",
    "the isothermal sound speed @xmath12 is also a model parameter , but it is much less important because the gas motion is almost incompressible ( @xcite , jy07 ) .",
    "we adopt @xmath183 throughout this paper , which roughly matches the value expected at 1au in the mmsn model .",
    "as shown by jy07 , there are two basic  modes \" to the non - linear saturation of the streaming instability . for marginally coupled and larger particles ( @xmath184 )",
    ", the instability develops for a wide range of @xmath26 , around 1 . in the saturated state , particles concentrate into long stripes , which are mostly aligned with the vertical direction and are slightly tilted in the radial direction . for tightly coupled particles ( @xmath14 ) ,",
    "prominent instability develops only when @xmath185 , and the turbulent state consists of large voids with narrow particle streams .",
    "the turbulence is much weaker than the previous case ( see figure 2 and figure 5 of jy07 for each of the two  modes \" , also see our figure [ fig : streaming ] below ) .",
    "we have also performed a series of simulations with a wide range of parameters ( @xmath7 and @xmath26 ) , and have reproduced all the results in jy07 .",
    "we use the semi - implicit integrator in all the tests in this section , and results from the other two integrators are similar , since the time step is at least 10 times smaller than @xmath3 in all test runs .    to study convergence ,",
    "we choose two test problems that are representative of the two saturation  modes \" described by jy07 . gets smaller .",
    "particle clumping becomes weaker as @xmath7 decreases and reduces to modest overdensities as @xmath186 ( with @xmath187 ) .",
    "the results are in qualitative agreement with the linear analysis by @xcite . in this paper , however , we focus on the non - linear si tests in jy07 for conciseness , the main conclusions are also applicable to the case with more strongly coupled particles . ]",
    "the first problem is the same as their run ab .",
    "the run parameters include : @xmath1 , @xmath188 , @xmath189 .",
    "the second problem uses parameters from their run ba , with @xmath190 , @xmath173 , @xmath191 .",
    "we choose the  standard \" grid resolution to be @xmath192 , and @xmath193 particles per grid cell .",
    "the typical time step is given by @xmath194 where @xmath76 is the number of grid cells in one direction .",
    "for the standard grid resolution and @xmath195 , we have @xmath196 for run ab , and @xmath197 for run ba .",
    "we then conduct a series of runs for each problem .",
    "first , we change the grid resolution from @xmath198 to @xmath199 , with the number of particles per cell fixed at 9 .",
    "note that increasing spatial resolution at fixed @xmath200 number is accompanied by the increase of temporal resolution , which is also important for driving to convergence , as we discussed in ",
    "[ ssec : linsi ] .",
    "secondly , we fix the grid resolution to be @xmath192 , and change the number of particles per cell , @xmath201 and @xmath202 . in each of these runs",
    ", particles are initialized with random positions within the simulation box , with velocities taken from the nsh equilibrium .",
    "all these runs are tabulated in the first three columns of table [ tab : turbulence ] , where each variation of the ab or ba runs is assigned with a run number .",
    "our fiducial runs are ab3 and ba3 , while our runs ab9 and ba9 have exactly the same numerical parameters as that in jy07 .",
    "the ab runs are fully saturated after about @xmath203 and the ba runs do not saturate until about @xmath204 .",
    "we choose the saturation time for the two runs to be some later time @xmath205 , @xmath206 , after which we start collecting data from the simulations and perform measurements . in figure",
    "[ fig : streaming ] , we show images of the particle density with different grid resolution ( @xmath198 , @xmath192 , @xmath207 from top to bottom ) for runs ab ( left ) and ba ( right ) at saturation ( @xmath208 ) . our standard runs ( middle panels ) resemble the last panels of figure 4 and figure 5 in jy07 . for the ba run series , we see that the bulk patterns of particle density do not vary much with grid resolution , although more and more detailed features are revealed in the higher resolution simulations . for the ab run series , all three grid resolutions show cavitation and particle streams as described in jy07 , however , the scale of particle clumping becomes smaller as one uses finer resolutions .",
    "a resolution of @xmath192 appears to be necessary to capture the prominent features in the particle density pattern .",
    "the results of these runs will serve as the starting point of our more quantitative study of numerical convergence in the next two subsections , using physical quantities averaged over the period between @xmath209 and @xmath210 , where @xmath211 for ab runs and @xmath212 for ba runs .",
    "probably the most important property of the streaming instability is its ability to concentrate particles . in jy07",
    ", it was shown that the maximum particle density resulting from the streaming instability can reach as high as @xmath213 times background particle density .",
    "such high densities are sufficient to make the clumps gravitationally bound , promoting the formation of planetesimals in ppds @xcite .",
    "the concentration of particles is best demonstrated by the cumulative probability distribution function ( pdf ) of particle densities .",
    "it measures the fraction of particles whose ambient particle density exceeds a given value . in figure",
    "[ fig : pdf ] we show the particle density distribution from the series of ab and ba runs .",
    "note that in the horizontal axis , we have normalized particle density to the averaged particle density in the simulation box .",
    "the ability for our code to handle the particle clump is reflected in the stiffness parameter @xmath73 defined in equation ( [ eq : stiffness ] ) . we have tested that the maximum value of @xmath73 in our ab runs is about @xmath214 in @xmath198 resolution , and it monotonically drops to @xmath215 in @xmath199 resolution . for the ba runs , @xmath216 stays less than @xmath217 for most of the time and for all resolutions , but reaches as large as @xmath218 in a few transients in the highest resolution run .",
    "the duration of the transients is so short that their contribution to the pdf is far below @xmath219 and is not visible in our figure [ fig : pdf ] .",
    "these facts show that the particle clumps are properly handled in our code and the obtained pdfs are not affected by the possible stiffness in the dense clumps .",
    "our results agree quantitatively with figure 11 of jy07 ( our ab9 and ba9 @xmath192 runs resolution with @xmath220 ) .",
    "the pdfs calculated from our ab runs are very robust , in the sense that using longer period of averaging or using different initial random seeds do not produce any visible changes in the plot . for",
    "the ba runs , there can be some uncertainties in the calculation of the pdfs , mostly because that there are only a few dense clumps in the simulation box , the long term stochastic evolution of these big clumps makes the calculated pdfs more or less dependent on the period of time averaging .",
    "nevertheless , we have averaged the pdfs over as long as nearly 200 orbits , which is about 170 times the correlation time of the clumps ( which is about @xmath221 , see figure 13 of jy07 ) , such uncertainty is expected to be small and does not affect the main features to be discussed below .",
    "the left panels of figure [ fig : pdf ] show the effect of grid resolution on the density pdfs : higher grid resolution leads to stronger particle clumping .",
    "both the maximum particle density is higher , and the number of particles residing in dense clumps is larger at higher resolutions . for the ab runs , the pdfs from the @xmath222 resolution run",
    "is almost identical to higher resolution runs , indicating convergence . for",
    "the ba runs , the small number of dense clumps in the simulation box makes convergence more difficult by averaging over a finite time period .",
    "nevertheless , viewing from the pdf curves , it appears that convergence is finally reached at @xmath207 resolution .",
    "we have also studied the numerical convergence with number of particles in the simulation box . on the right panels of figure [ fig : pdf ]",
    ", we see that for both runs ab and ba , the pdfs depend very weakly on @xmath223 . in the ab runs",
    ", the five curves almost overlap with each other . in ba",
    "runs , however , there is larger scatter .",
    "again , such scatter is most likely due to the small number of clumps .",
    "in fact , we have compared the ba run pdfs between short ( @xmath224 ) and long ( @xmath225 , shown in the figure ) averaging period .",
    "the pdfs from longer averaging converges show better convergence ) appears to have substantial lower peak densities than the runs with other @xmath223s when we average over shorter time period . ] .",
    "we expect the scatter to become smaller if we run ba series for much longer time . in all",
    ", we conclude that one can use as small as only one particle per cell to accurately capture the density distributions of the solids .",
    "the streaming instability generates turbulence which differs significantly from the laminar state described by the nsh equilibrium .",
    "the turbulence is accompanied by particle concentration , as discussed in the previous subsection .",
    "understanding the turbulent state is important since it may strongly affect the settling process as well as the radial transport of solids in the ppds ( jy07 , @xcite ) .",
    "similar to jy07 , we have computed a number of physical quantities to characterize the turbulence properties generated from the streaming instability , including : 1 ) the turbulent mach number ( @xmath226 ) in three directions , calculated from the root mean square of gas velocity fluctuations ; 2 ) mean radial drift velocity of the particles , normalized by the nsh radial drift velocity @xmath227 ; 3 ) turbulent diffusion coefficient for particles @xmath228 , calculated using the method outlined in  5.3 of jy07 ; and 4 ) the time and spatial averaged reynolds stress @xmath229 , divided by the reynolds stress in the nsh equilibrium ( note the quantity we measure is different from @xmath230 in jy07 ) .",
    "properties ( 1 ) , ( 2 ) and ( 4 ) are calculated directly from spatial and time averaging from the entire simulation box .",
    "the @xmath231 uncertainties are estimated from the standard deviation in the time sequence .",
    "in the calculation of the diffusion coefficient , we measure the standard deviation of the distance traveled by tracer particles at different time intervals @xmath232 .",
    "we then fit the diffusion coefficient using @xmath233 .",
    "the maximum @xmath234 has been chosen to be @xmath235 for ab runs , @xmath236 for ba runs .",
    "the uncertainty of the diffusion coefficient is directly given by the linear regression estimate .",
    "the results are summarized in table [ tab : turbulence ] .    from table [",
    "tab : turbulence ] we see that the gas flow properties , namely the turbulent mach number and the reynolds stress , depend relatively weakly on the grid resolution and number of particles in the simulation box .",
    "this trend is also true for the radial drift velocity of the particles . in the ab series of runs , all these quantities agree with each other",
    "once the grid resolution reaches @xmath192 .",
    "smaller resolution runs produce somewhat different values , but with larger fluctuations .",
    "note that in figure [ fig : streaming ] , the typical size of particle stripes from the @xmath207 run ( ab5 ) is apparently smaller than that from the @xmath192 run ( ab3 ) .",
    "however , the statistical properties of gas flow from these two runs are indistinguishable . in this sense ,",
    "@xmath192 resolution is sufficient to capture the essential turbulent properties for the ab runs . for ba",
    "run series , the measurements from even the lowest resolution run @xmath198 agree very well with other higher resolution runs .",
    "such numerical convergence behavior is very different from the convergence of particle concentration properties discussed in  [ ssec : concentration ] .",
    "the measurements of the diffusion coefficient in the radial and vertical directions , however , show larger variations among different runs for both ab and ba series .",
    "such variations show up not only between different grid resolutions , but also at fixed resolution , varying the number of particles in the simulation box also makes a difference .",
    "the differences even exceed the @xmath231 uncertainties in a number of cases .",
    "moreover , there is no systematic trend on such variances , especially in the ba run series . in the ab runs",
    ", it appears that towards higher resolution , the diffusion coefficient becomes smaller .",
    "given the fact that bulk flow properties converge well at modest resolutions , the variation of diffusion coefficient measured from different runs , especially those with grid resolution no less than @xmath192 , may be taken as uncertainties from the numerical simulations .",
    "the uncertainties in the measured diffusion coefficient would be about 20% , for both ab and ba runs ."
  ],
  "abstract_text": [
    "<S> the athena mhd code has been extended to integrates the motion of particles coupled with the gas via aerodynamic drag , in order to study the dynamics of gas and solids in protoplanetary disks and the formation of planetesimals . </S>",
    "<S> our particle - gas hybrid scheme is based on a second order predictor - corrector method . </S>",
    "<S> careful treatment of the momentum feedback on the gas guarantees exact conservation . </S>",
    "<S> the hybrid scheme is stable and convergent in most regimes relevant to protoplanetary disks . </S>",
    "<S> we describe a semi - implicit integrator generalized from the leap - frog approach . in the absence of drag force </S>",
    "<S> , it preserves the geometric properties of a particle orbit . </S>",
    "<S> we also present a fully - implicit integrator that is unconditionally stable for all regimes of particle - gas coupling . using our hybrid code , </S>",
    "<S> we study the numerical convergence of the non - linear saturated state of the streaming instability . </S>",
    "<S> we find that gas flow properties are well converged with modest grid resolution ( 128 cells per pressure length @xmath0 for dimensionless stopping time @xmath1 ) , and equal number of particles and grid cells . on the other hand , </S>",
    "<S> particle clumping properties converge only at higher resolutions , and finer resolution leads to stronger clumping before convergence is reached . </S>",
    "<S> finally , we find that measurement of particle transport properties resulted from the streaming instability may be subject to error of about @xmath2 . </S>"
  ]
}