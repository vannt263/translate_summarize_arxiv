{
  "article_text": [
    "[ [ motivation . ] ] motivation .",
    "+ + + + + + + + + + +    with the advance of sensor technology , computing power and internet , massive amounts of geometric data are being generated and collected in various areas of science , engineering and business .",
    "as they are becoming widely available , there is a real need to analyze and visualize these large scale geometric data to extract useful information out of them . in many cases",
    "these data are not embedded in euclidean spaces and come as ( finite ) sets of points with pairwise distances information , i.e. ( discrete ) metric spaces .",
    "a large amount of research has been done on dimensionality reduction , manifold learning and geometric inference for data embedded in , possibly high dimensional , euclidean spaces and assumed to be concentrated around low dimensional manifolds  @xcite .",
    "however , the assumption of data lying on a manifold may fail in many applications .",
    "in addition , the strategy of representing data by points in euclidean space may introduce large metric distortions as the data may lie in highly curved spaces , instead of in flat euclidean space raising many difficulties in the analysis of metric data . in the past decade , with the development of topological methods in data analysis , new theories such as topological persistence ( see , for example , @xcite ) and new tools such as the mapper algorithm @xcite have given rise to new algorithms to extract and visualize geometric and topological information from metric data without the need of an embedding into an euclidean space . in this paper",
    "we focus on a simple but important setting where the underlying geometric structure approximating the data can be seen as a branching filamentary structure i.e. , more precisely , as a _ metric graph _ which is a topological graph endowed with a length assigned to each edge ( see section [ sec : metric - gh ] ) .",
    "such structures appear naturally in various real - world data such as collections of gps traces collected by vehicles on a road network , earthquakes distributions that concentrate around geological faults , distributions of galaxies in the universe , networks of blood vessels in anatomy or hydrographic networks in geography just to name a few of them .",
    "it is thus appealing to try to capture such filamentary structures and to approximate the data by metric graphs that will summarize the metric and allow convenient visualization .",
    "[ [ contribution ] ] contribution + + + + + + + + + + + +    in this paper we address the metric reconstruction problem for filamentary structures . the input of our method and algorithm is a metric space @xmath0 that is assumed to be close with respect to the so - called gromov - hausdorff distance @xmath1 to a much simpler , but unknown , metric graph @xmath2 .",
    "our algorithm outputs a metric graph @xmath3 that is proven to be close to @xmath4 .",
    "our approach relies on the notion of reeb graph ( and some variants of it introduced in section [ sec : reeb - graph ] ) and one of our main theoretical result can be stated as follows . * theorem [ thm : bound - dgh - final]*. _ let @xmath0 be a compact connected geodesic space , let @xmath5 be a fixed base point such that the metric reeb graph @xmath6 of the function @xmath7 is a finite graph .",
    "if for a given @xmath8 there exists a finite metric graph @xmath9 such that @xmath10 then we have @xmath11 where @xmath12 is the number of edges of @xmath13 of length at most @xmath14 and @xmath15 is the first betti number of @xmath16 , i.e. the number of edges to remove from @xmath16 to get a spanning tree .",
    "in particular if @xmath17 is at distance less than @xmath18 from a metric graph with shortest edge larger than @xmath14 then @xmath19 .",
    "_ turning this result into a practical algorithm requires to address two issues :    * first , raw data usually do not come as geodesic spaces .",
    "they are given as discrete sets of point ( and thus not connected metric spaces ) sampled from the underlying space @xmath0 .",
    "moreover in many cases only distances between nearby points are known . a geodesic space ( see section [ sec : metric - gh ] for a definition of geodesic space )",
    "can then be obtained from these raw data as a neighborhood graph where nearby points are connected by edges whose length is equal to their pairwise distance . the shortest path distance in this graph is then used as the metric . in our experiments we use this new metric as the input of our algorithm .",
    "the question of the approximation of the metric on @xmath17 by the metric induced on the neighborhood graphs is out of the scope of this paper . *",
    "second , approximating the reeb graph @xmath6 from a neighborhood graph is usually not obvious .",
    "if we compute the reeb graph of the distance function to a given point defined on the neighborhood graph we obtain the neighborhood graph itself and do not achieve our goal of representing the input data by a simple graph .",
    "it is then appealing to build a two dimensional complex having the neighborhood graph as @xmath20-dimensional skeleton and use the algorithm of @xcite to compute the reeb graph of the distance to the root point . unfortunately adding triangles to the neighborhood graph",
    "may widely change the metric between the data points on the resulting complex and significantly increase the complexity of the algorithm .",
    "we overcome this issue by introducing a variant of the reeb graph , the @xmath21-reeb graph , inspired from @xcite and related to the recently introduced notion of graph induced complex @xcite , that is easier to compute than the reeb graph but also comes with approximation guarantees ( see theorem [ thm : bound - dgh - final - alpha ] ) . as a consequence our algorithm relies on the mapper algorithm of @xcite and runs in almost linear time ( see section  [ sec : algo - pl ] ) .",
    "[ [ related - work . ] ] related work .",
    "+ + + + + + + + + + + + +    approximation of data by @xmath20-dimensional geometric structures has been considered by different communities . in statistics ,",
    "several approaches have been proposed to address the problem of detection and extraction of filamentary structures in point cloud data .",
    "for example arial - castro et al @xcite use multiscale anisotropic strips to detect linear structure while @xcite and more recently @xcite base their approach upon density gradient descents or medial axis techniques .",
    "these methods apply to data corrupted by outliers embedded in euclidean spaces and focus on the inference of individual filaments without focus on the global geometric structure of the filaments network .    in computational geometry ,",
    "the curve reconstruction problem from points sampled on a curve in an euclidean space has been extensively studied and several efficient algorithms have been proposed @xcite . unfortunately , these methods restricts to the case of simple embedded curves ( without singularities or self - intersections ) and hardly extend to the case of topological graphs . in a more intrinsic setting where data come as finite abstract metric spaces ,",
    "@xcite propose an algorithm that outputs , under some specific sampling conditions , a topologically correct ( up to a homeomorphism ) reconstruction of the approximated graph .",
    "however this algorithm requires some tedious parameters tuning and relies on quite restrictive sampling assumptions .",
    "when these conditions are not satisfied , the algorithm may fail and not even outputs a graph .",
    "compared to the algorithm of @xcite , our algorithm not only comes with metric guarantees but also whatever the input data is , it always outputs a metric graph and does not require the user to choose any parameters .",
    "our approach is also related to the so - called mapper algorithm @xcite that provides a way to visualize data sets endowed with a real valued function as a graph .",
    "indeed the implementation of our algorithm relies on the mapper algorithm where the considered function is the distance to the chosen root point .",
    "however , unlike the general mapper algorithm , our methods provides an upper bound on the gromov - hausdorff distance between the reconstructed graph and the underlying space from which the data points have been sampled .    in theoretical computer science",
    ", there is much of work on approximating metric spaces using trees @xcite or distribution of trees @xcite where the trees are often constructed as spanning trees possibly with steiner points .",
    "our approach is different as our reconstructed graph or tree is a quotient space of the original metric space where the metric only gets contracted ( see lemma  [ lemma : pi - lipschitz ] ) . finally we remark that the recovery of filament structure is also studied in various applied settings , including road networks @xcite , galaxies distributions @xcite .    the paper is organized as follows .",
    "the basic notions and definitions used throughout the paper are recalled in section [ sec : metric - gh ] .",
    "the reeb and @xmath21-reeb graphs endowed with a natural metric are introduced in section [ sec : reeb - graph ] and the approximation results are stated and proven in sections [ sec : reeb - bound ] and [ sec : m - bound ] .",
    "our algorithm is described in section [ sec : algo - pl ] and experimental results are presented and discussed in section [ sec : exp ] .",
    "recall that a metric space is a pair @xmath22 where @xmath17 is a set and @xmath23 is a non negative map such that for any @xmath24 , @xmath25 if and only if @xmath26 , @xmath27 and @xmath28 . two compact spaces @xmath22 and @xmath29 are isometric if there exits a bijection @xmath30 that preserves the distances , namely : for any @xmath31 .",
    "the set of isometry classes of compact metric spaces can be endowed with a metric , the so - called gromov - hausdorff distance that can be defined using the following notion of correspondence ( @xcite def .",
    "7.3.17 ) .",
    "let @xmath22 and @xmath29 be two compact metric spaces .",
    "given @xmath8 , an _ @xmath18-correspondence _ between @xmath22 and @xmath29 is a subset @xmath32 such that : + i ) for any @xmath33 there exists @xmath34 such that @xmath35 ; + ii ) for any @xmath34 there exists @xmath33 such that @xmath35 ; + iii ) for any @xmath36 , @xmath37 .    the _ gromov - hausdorff distance _ between two compact metric spaces @xmath22 and @xmath29 is defined by @xmath38    a metric space @xmath22 is a _ path metric space _ if the distance between any pair of points is equal to the infimum of the lengths of the continuous curves joining them .",
    "equivalently @xmath22 is a path metric space if and only if for any @xmath39 and any @xmath40 there exists @xmath41 such that @xmath42 @xcite .",
    "in the sequel of the paper we consider compact path metric spaces .",
    "it follows from the hopf - rinow theorem ( see @xcite p.9 ) that such spaces are _ geodesic _ , i.e. for any pair of point @xmath43 there exists a minimizing geodesic joining them . is any curve @xmath44 , where @xmath45 is a real interval , such that @xmath46 for any @xmath47 . ] a continuous path @xmath48 where @xmath45 is a real interval or the unit circle is said to be _ simple _ if it is not self intersecting , i.e. if @xmath49 is an injective map .",
    "recall that a _ ( finite ) topological graph _",
    "@xmath50 is the geometric realisation of a ( finite ) @xmath20-dimensional simplicial complex with vertex set @xmath51 and edge set @xmath52 .",
    "if moreover each @xmath20-simplex @xmath53 is a metric edge , i.e. @xmath54 \\subset \\mathbb{r}$ ] , then the graph @xmath16 inherits from a metric @xmath55 which is the unique one whose restriction to any @xmath54 \\in e$ ] coincides with the standard metric on the real segment @xmath56 $ ] .",
    "then @xmath57 is a _ metric graph _ ( see @xcite , section 3.2.2 for a more formal definition ) .",
    "intuitively , a metric graph can be seen as a topological graph with a length assigned to each of its edges .    the _ first betti number @xmath15 _ of a finite topological graph @xmath16 is the rank of the first homology group of @xmath16 ( with coefficient in a field , e.g. @xmath58 ) , or equivalently , the number of edges to remove from @xmath16 to get a spanning tree .",
    "let @xmath0 be a compact geodesic space and let @xmath5 be a fixed base point .",
    "let @xmath59 be the distance function to @xmath60 , i.e. , @xmath61 .",
    "[ [ the - reeb - graph . ] ] the reeb graph .",
    "+ + + + + + + + + + + + + + +    the relation @xmath63 if and only if @xmath64 and @xmath65 are in the same path connected component of @xmath66 is an equivalence relation .",
    "the quotient space @xmath67 is called the _ reeb graph _ of @xmath62 and we denote by @xmath68 the quotient map .",
    "notice that @xmath69 is continuous and as @xmath17 is path connected , @xmath16 is path connected . the function @xmath62 induces a function @xmath70 that satisfies @xmath71 .",
    "the relation defined by : for any @xmath72 , @xmath73 if and only if @xmath74 and there exist a continuous path @xmath75 in @xmath16 connecting @xmath76 to @xmath77 such that @xmath78 is non decreasing , makes @xmath16 a partially ordered set .    [ [ the - alpha - reeb - graphs . ] ] the @xmath21-reeb graphs . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    computing or approximating",
    "the reeb graph of @xmath79 from a finite set of point sampled on @xmath17 is usually a difficult task . to overcome this issue",
    "we also consider a variant of the reeb graph that shares very similar properties than the reeb graph .",
    "let @xmath80 and let @xmath81 be a covering of the range of @xmath62 by open intervals of length at most @xmath21 .",
    "the transitive closure of the relation @xmath82 if and only if @xmath64 and @xmath65 are in the same path connected component of @xmath83 for some interval @xmath84 is an equivalence relation that is also denoted by @xmath85 .",
    "the quotient space @xmath86 is called the _",
    "@xmath21-reeb graph_-reeb graph associated to the covering @xmath87 but we assume in the sequel that some covering @xmath87 has been chosen and we omit it in notations ] of @xmath62 and we denote by @xmath88 the quotient map . notice that @xmath69 is continuous and as @xmath17 is path connected , @xmath89 is path connected . the function @xmath62 induces a function @xmath90 that satisfies @xmath71 . the relation defined by : for any @xmath91 , @xmath92 if and only if @xmath74 and there exist a continuous path @xmath75 in @xmath89 connecting @xmath76 to @xmath77 such that @xmath78 is non decreasing , makes @xmath89 a partially ordered set .    the @xmath21-reeb graph is closely related to the graph constructed by the mapper algorithm introduced in @xcite making its computation much more easier than the reeb graph ( see section [ sec : algo - pl ] ) . notice that without making assumptions on @xmath17 and @xmath62 , in general @xmath16 and @xmath89 are not finite graphs .",
    "however when the number of path connected components of the level sets of @xmath62 is finite and changes only a finite number of times then the reeb graph turns out to be a finite directed acyclic graph .",
    "similarly , when the covering of @xmath17 by the connected components of @xmath93 is finite , the @xmath21-reeb graph also turns out to be a finite directed acyclic graph .",
    "this happens in most applications and for example when @xmath22 is a finite simplicial complex or a compact semialgebraic ( or more generally a compact subanalytic space ) with @xmath62 being semi - algebraic ( or subanalytic ) .",
    "all the results and proofs presented in section [ sec : approx - reeb ] are exactly the same for the reeb and the @xmath21-reeb graphs . in the following paragraph and in section",
    "[ sec : reeb - bound ] , @xmath16 denotes indifferently the reeb graph or an @xmath21-reeb graph for some @xmath94 .",
    "we also always assume that @xmath17 and @xmath62 ( and @xmath21 and @xmath87 ) are such that @xmath16 is a finite graph .",
    "[ [ a - metric - on - reeb - and - alpha - reeb - graphs . ] ] a metric on reeb and @xmath21-reeb graphs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let define the set of vertices @xmath51 of @xmath16 as the union of the set of points of degree not equal to @xmath95 with the set of local maxima of @xmath96 over @xmath16 , and the base point @xmath97 .",
    "the set of edges @xmath52 of @xmath16 is then the set of the connected components of the complement of @xmath51 .",
    "notice that @xmath97 is the only local ( and global ) minimum of @xmath96 : since @xmath17 is path connected , for any @xmath33 there exists a geodesic @xmath75 joining @xmath60 to @xmath98 along which @xmath62 is increasing ; @xmath96 is thus also increasing along the continuous curve @xmath99 , so @xmath100 can not be a local minimum of @xmath96 . as a consequence @xmath96 is monotonous along the edges of @xmath16",
    ". we can thus assign an orientation to each edge : if @xmath101 \\in g$ ] is such that @xmath102 then the positive orientation of @xmath103 is the one pointing from @xmath104 to @xmath105 .",
    "finally , we assign a metric to @xmath16 .",
    "each edge @xmath106 is homeomorphic to an interval to which we assign a length equal to the absolute difference of the function @xmath96 at two endpoints .",
    "the distance between two points @xmath107 of @xmath103 is then @xmath108 .",
    "this makes @xmath16 a metric graph @xmath3 isometric to the quotient space of the union of the intervals isometric to the edges by identifying the endpoints if they correspond to the same vertex in @xmath16 .",
    "see figure  [ fig : reebgraph ] for an example .",
    "note that @xmath96 is continuous in @xmath3 and for any @xmath109 , @xmath110 .",
    "indeed this is a consequence of the following lemma .",
    "[ lemma : geodesic - g ] if @xmath49 is a path joining two points @xmath111 such that @xmath112 is strictly increasing then @xmath49 is a shortest path between @xmath104 and @xmath113 and @xmath114 .    as @xmath112 is strictly increasing , when @xmath49 enters an edge @xmath103 by one of its end points , either it exits at the other end point or it stops at @xmath113 if @xmath115 .",
    "moreover @xmath49 can not go through a given edge more than one time .",
    "as a consequence @xmath49 can be decomposed in a finite sequence of pieces @xmath116 , e_1 = [ p_1,p_2 ] , \\cdots , e_{n-1 } = [ p_{n-1 } , p_{n } ] , e_n = [ p_n , p']$ ] where @xmath117 and @xmath118 are the segments joining @xmath104 and @xmath113 to one of the endpoint of the edges that contain them and @xmath119 are edges .",
    "so , the length of @xmath49 is equal to @xmath120 and @xmath121 .",
    "similarly any simple path joining @xmath104 to @xmath113 can be decomposed in a finite sequence of pieces @xmath122 , e'_1 = [ p'_1,p'_2 ] , \\cdots , e'_{k-1 } = [ p'_{k-1 } , p'_{k } ] , e'_k = [ p'_k , p']$ ] where @xmath123 and @xmath124 are the segments joining @xmath104 and @xmath113 to one of the endpoint of the edges that contain them , and @xmath125 are edges . now , as we do not know that @xmath96 is increasing along this path , its length is thus equal to @xmath126 .",
    "so , @xmath127 .",
    ", scaledwidth=30.0% ]      the goal of this section is to provide an upper bound of the gromov - hausdorff distance between @xmath17 and @xmath16 that only depends on the first betti number @xmath15 of @xmath16 and the maximal diameter @xmath128 of the level sets of @xmath69 .",
    "an upper bound of @xmath128 is given in the next section .",
    "[ thm : bound - dgh - betti1-m ] @xmath129 where @xmath130 is the gromov - hausdorff distance between @xmath17 and @xmath16 , @xmath15 is the first betti number of @xmath16 and @xmath131 is the supremum of the diameters of the level sets of @xmath69 .",
    "the proof of theorem [ thm : bound - dgh - betti1-m ] will be easily deduced from a sequence of technical lemmas that allow to compare the distance between pair of points @xmath132 and the distance between their images @xmath133 .",
    "a vertex @xmath134 is called a _ merging vertex _ if it is the end point of at least two edges @xmath135 and @xmath136 that are pointing to it according to the orientation defined in section [ sec : reeb - graph ] .",
    "geometrically this means that there are at least two distinct connected components of @xmath137 that accumulate to @xmath138 as @xmath139 goes to @xmath140 .",
    "the set of merging vertices is denoted by @xmath141 .",
    "the following lemma provides an upper bound on the number of vertices in @xmath141 .",
    "[ lem : mv ] the number of elements in @xmath141 is equal to @xmath15 where @xmath15 is the first homology group of @xmath16 .",
    "the result follows from classical homology persistence theory @xcite .",
    "first remark that , as @xmath97 is the only local minimum of @xmath96 , the sublevel sets of the function @xmath70 are all path connected .",
    "indeed if @xmath133 are in the same sublevel set @xmath142)$ ] , @xmath94 , then the images by @xmath69 of the shortest paths in @xmath17 connecting @xmath98 to @xmath60 and @xmath143 to @xmath60 are contained in @xmath142)$ ] and their union is a continuous path joining @xmath100 to @xmath144 . as a consequence ,",
    "the @xmath140-dimensional persistence of @xmath96 is trivial .",
    "so , for the persistence algorithm applied to @xmath96 , the vertices of @xmath141 are the positive simplices ( see @xcite for the notion of positive and negative simplices for persistence ) .",
    "it follows that each vertex of @xmath141 creates a cycle that never dies as @xmath16 is one dimensional and does not contain any @xmath95-dimensional simplex . thus @xmath145 .",
    "[ lemma : path - out - vm ] let @xmath146 and let @xmath147 \\to g$ ] be a strictly increasing path going from @xmath104 to @xmath113 that does not contain any point of @xmath141 in its interior",
    ". then for any @xmath148 where @xmath149 denotes the closure , there exists a shortest path @xmath75 connecting a point @xmath98 of @xmath150 to @xmath151 such that @xmath152 and @xmath153 .",
    "notice that from lemma [ lemma : geodesic - g ] , @xmath49 is a shortest path and the parametrization by the interval @xmath154 $ ] can be chosen to be an isometric embedding .",
    "first assume that @xmath113 is not a merging point .",
    "let @xmath155 \\to x$ ] be any shortest path between @xmath60 and @xmath151 and let @xmath75 be the restriction of @xmath156 to @xmath157 = [ d_*(p),d_*(p')]$ ] .",
    "if the infimum @xmath158 of the set @xmath159 : \\pi(\\gamma(t ' ) ) \\in \\delta,\\ \\forall t ' \\geq t \\}$ ] is larger than @xmath160 , then @xmath161 then there exists an increasing sequence @xmath162 that converges to @xmath158 such that @xmath163 . as",
    "a consequence @xmath164 is a merging point ; a contradiction .",
    "so @xmath165 and @xmath166 intersects @xmath150 at a point @xmath98 .",
    "now if @xmath113 is a merging point , as @xmath151 is chosen in the closure of @xmath167 , for any sufficiently large @xmath168 one can consider a sequence of points @xmath169 that converges to @xmath151 and apply the first case to get a sequence of shortest path @xmath170 from a point @xmath171 and @xmath172 . then applying arzel - ascoli s theorem",
    "( see @xcite 7.5 ) we can extract from @xmath170 a sequence of points converging to a shortest path @xmath75 between a point @xmath173 and @xmath151 .    to conclude the proof , notice that from lemma [ lemma : geodesic - g ] we have @xmath174 . since @xmath75 is the restriction of a shortest path from @xmath60 to @xmath98 we also have @xmath175 .",
    "lemma [ lemma : bound - dx ] and lemma [ lemma : pi - lipschitz ] allow to compare the metrics @xmath176 and @xmath55 .",
    "[ lemma : bound - dx ] for any @xmath177 we have @xmath178 where @xmath15 is the first betti number of @xmath16 and @xmath131 .",
    "let @xmath49 be a shortest path between @xmath100 and @xmath144 .",
    "remark that except at the points @xmath100 and @xmath144 the local maxima of the restriction of @xmath96 to @xmath49 are in @xmath141 .",
    "indeed as @xmath49 is a shortest path it has to be simple , so if @xmath179 is a local maximum then @xmath104 has to be a vertex and @xmath49 has to pass through two edges having @xmath104 as end point and pointing to @xmath104 according to the orientation defined in section [ sec : reeb - graph ] .",
    "so @xmath104 is a merging point .",
    "+ since @xmath49 is simple and @xmath141 is finite , @xmath49 can be decomposed in at most @xmath180 connected paths along the interior of which the restriction of @xmath96 does not have any local maxima .",
    "so along each of these connected paths the restriction of @xmath96 can have at most one local minimum . as a consequence",
    ", @xmath49 can be decomposed in a finite number of continuous paths @xmath181 with @xmath182 , such that the restriction of @xmath96 to each of these path is strictly monotonous . for any @xmath183 let @xmath184 and @xmath185 the end points of @xmath186 with @xmath187 and @xmath188 .",
    "we can apply lemma [ lemma : path - out - vm ] to each @xmath186 to get a shortest path @xmath189 in @xmath17 between a point @xmath190 and a point in @xmath191 such that @xmath192 and @xmath193 .",
    "the sum of the lengths of the paths @xmath189 is equal to the sum of the lengths of the path @xmath186 which is itself equal to @xmath194 .",
    "now for any @xmath183 , since @xmath195 we have @xmath196 and @xmath197 and @xmath198 can be connected by a path of length at most @xmath128 ( @xmath199 is connected to @xmath98 and @xmath200 is connected to @xmath143 .",
    "gluing these paths to the paths @xmath189 gives a continuous path from @xmath98 to @xmath143 whose length is at most @xmath201 . since from lemma",
    "[ lem : mv ] , @xmath202 , we finally get that @xmath203 .",
    "[ lemma : pi - lipschitz ] the map @xmath68 is @xmath20-lipschitz : for any @xmath177 we have @xmath204    let @xmath132 and let @xmath44 be a shortest path from @xmath98 to @xmath143 in @xmath17 where @xmath205 is a closed interval .",
    "the path @xmath99 connects @xmath100 and @xmath144 in @xmath16 .",
    "we first claim that there exists a continuous path @xmath206 contained in @xmath99 connecting @xmath100 and @xmath144 that intersects each vertex of @xmath16 at most one time .",
    "the path @xmath206 can be defined by iteration in the following way .",
    "let @xmath207 be the vertices of @xmath16 that are contained in @xmath208 and let @xmath209 .",
    "for @xmath210 let @xmath211 and @xmath212 and define @xmath213 as the restriction of @xmath214 to @xmath215 .",
    "the path @xmath213 is a connected continuous path ( although @xmath216 is a disjoint union of intervals ) that intersects the vertices @xmath217 at most one time .",
    "we then define @xmath218 where @xmath219 is a finite union of closed intervals .",
    "notice that @xmath206 is the image by @xmath69 of the restriction of @xmath75 to @xmath220 and that @xmath221 only if @xmath222 is one of the endpoints of the closed intervals defining @xmath220 .",
    "now , for each connected component @xmath223 $ ] of @xmath220 , @xmath224 is contained in @xmath225 where @xmath103 is the edge of @xmath16 containing @xmath226)$ ] . as a consequence , @xmath227 . recalling that @xmath228 and @xmath229 and using the triangle inequality we get that @xmath230 . to conclude the proof , since @xmath75 is a geodesic path we just need to sum up the previous inequality over all connected components of @xmath220 : @xmath231 \\in cc(j ) } d_x(\\gamma(t),\\gamma(t ' ) ) \\geq \\sum_{[t , t ' ] \\in cc(j ) } d_g(\\pi(\\gamma)(t),\\pi(\\gamma)(t ' ) ) \\geq d_g(\\pi(x ) , \\pi(y))\\ ] ] where @xmath232 is the set of connected components of @xmath220 .",
    "the proof of theorem [ thm : bound - dgh - betti1-m ] now easily follows from lemmas [ lemma : bound - dx ] and [ lemma : pi - lipschitz ] .    _",
    "( of theorem [ thm : bound - dgh - betti1-m ] ) _ consider the set @xmath233 . as @xmath69 is surjective",
    "this is a correspondence between @xmath17 and @xmath16 .",
    "it follows from lemmas [ lemma : bound - dx ] and [ lemma : pi - lipschitz ] that for any @xmath234 , @xmath235 where @xmath15 is the first betti number of @xmath16 and @xmath131 .",
    "so @xmath236 is a @xmath237-correspondence and @xmath238 .      to upperbound the diameter of the level sets of @xmath69 we first prove the two following general lemmas .",
    "[ lemma : edge - distance - root ] let @xmath3 be a connected finite metric graph and let @xmath239 .",
    "we denote by @xmath240 the distance to @xmath60 . for any edge @xmath241 ,",
    "the restriction of @xmath242 to @xmath103 is either strictly monotonous or has only one local maximum .",
    "moreover the length @xmath243 of @xmath52 is upper bounded by two times the difference between the maximum and the minimum of @xmath242 restricted to @xmath52 .",
    "let @xmath244 be the length of @xmath52 and let @xmath245 , @xmath246 $ ] , be an arc length parametrization of @xmath52 . since @xmath52 is an edge of @xmath16 , for @xmath246 $ ] any shortest geodesic @xmath247 joining @xmath60 to @xmath248 must contain either @xmath249 or @xmath250 .",
    "if it contains @xmath199 then for any @xmath251 the restriction of @xmath247 between @xmath60 and @xmath252 is a shortest geodesic containing @xmath199 and if it contains @xmath253 then for any @xmath254 the restriction of @xmath247 between @xmath60 and @xmath252 is a shortest geodesic containing @xmath253 . moreover in both cases , the function @xmath242 is strictly monotonous along @xmath75 . as a consequence , the set @xmath255:$ ]  a shortest geodesic joining @xmath60 to @xmath248 contains",
    "@xmath256 is a closed interval containing @xmath140 .",
    "similarly the set @xmath257:$ ]  a shortest geodesic joining @xmath60 to @xmath248 contains @xmath258 is a closed interval containing @xmath244 and @xmath259 = i_1 \\cup i_2 $ ] .",
    "moreover @xmath242 is strictly monotonous on @xmath260 and on @xmath261 . as a consequence @xmath262",
    "is reduced to a single point @xmath158 that has to be the unique local maximum of @xmath242 restricted to @xmath52 .",
    "the second part of the lemma follows easily from the previous proof : the minimum of @xmath242 restricted to @xmath52 is attained either at @xmath199 or @xmath253 and @xmath263 is the maximum of @xmath242 restricted to @xmath52 .",
    "we thus obtain that @xmath264 . as a consequence if @xmath265 then @xmath266 ; similarly if @xmath267 then @xmath268 .",
    "[ proposition : band - diameter ] let @xmath3 be a connected finite metric graph and let @xmath239 . for @xmath80",
    "we denote by @xmath269 the number of edges of @xmath16 of length at most @xmath21 . for",
    "any @xmath270 and any connected component @xmath271 of the set @xmath272 we have @xmath273    the example of figure [ fig : diambound ] shows that the bound of lemma [ proposition : band - diameter ] is tight .",
    ": there are 3 edges of length at most @xmath274 and the diameter of @xmath271 is equal to @xmath275 . [",
    "fig : diambound],scaledwidth=30.0% ]    let @xmath276 and let @xmath277 be a continuous path joining @xmath98 to @xmath143 in @xmath271 .",
    "let @xmath52 be an edge of @xmath16 that does not contain @xmath98 or @xmath143 and with end points @xmath278 such that @xmath75 intersects the interior of @xmath52 .",
    "then @xmath279 is a disjoint union of closed intervals of the form @xmath280 $ ] where @xmath281 and @xmath282 belong to the set @xmath283 . if @xmath284 we can remove the part of @xmath75 between @xmath222 and @xmath285 and still get a continuous path between @xmath98 and @xmath143 .",
    "so without loss of generality we can assume that if @xmath75 intersects the interior of @xmath52 , then @xmath52 is contained in @xmath75 .",
    "using the same argument as previously we can also assume that if @xmath75 goes across @xmath52 , it only does it one time , i.e. @xmath279 is reduced to only one interval . as a consequence",
    ", @xmath75 can be decomposed in a sequence @xmath286 , e_1 , e_2 , \\cdot , e_k , [ v_k , y]$ ] where @xmath286 $ ] and @xmath287 $ ] are pieces of edges containing @xmath98 and @xmath143 respectively and @xmath288 , e_2=[v_1,v_2 ] \\cdot , e_k = [ v_{k-1},v_k]$ ] are pairwise distinct edges of @xmath16 contained in @xmath271 .",
    "it follows from lemma [ lemma : edge - distance - root ] that the lengths of the edges @xmath289 and of @xmath286 $ ] and @xmath287 $ ] are upper bounded by @xmath274 . as a consequence",
    "the length of @xmath75 is upper bounded by @xmath290 which is itself upper bounded by @xmath291 since the edges @xmath289 are pairwise distinct .",
    "it follows that @xmath292 .",
    "[ diameter - connected - comp - reeb ] let @xmath3 be a connected finite metric graph and let @xmath22 be a compact geodesic metric space such that @xmath293 for some @xmath8 .",
    "let @xmath294 be a fixed point and let @xmath295 be the distance function to @xmath296 .",
    "then for @xmath297 the diameter of any connected component @xmath298 of @xmath299)$ ] satisfies @xmath300 where @xmath301 is the number of edges of @xmath16 of length at most @xmath302 . in particular if @xmath303 and @xmath14 is smaller that the length of the shortest edge of @xmath16 then the diameter of @xmath298 is upper bounded by @xmath304 .",
    "let @xmath305 be such that @xmath306 .",
    "let @xmath307 be an @xmath308-correspondence between @xmath17 and @xmath16 and @xmath309 .",
    "we denote by @xmath240 the distance function to @xmath60 in @xmath16 .",
    "let @xmath310 and let @xmath311 .",
    "there exists a continuous path @xmath312 joining @xmath313 to @xmath314 . since @xmath236 is an @xmath308-correspondence for any @xmath315 there exists a point @xmath35 such that @xmath316 .",
    "the set of points @xmath143 obtained in this way is not necessarily a continuous path from @xmath317 to @xmath318 .",
    "however one can consider a finite sequence @xmath319 of points in @xmath75 such that for any @xmath320 we have @xmath321 .",
    "if @xmath322 then we have @xmath323 . as a consequence , since @xmath324 the shortest geodesic connecting @xmath198 to @xmath325 in @xmath16 remains in the set @xmath326)$ ] and connecting these geodesics for all @xmath327 we get a continuous path from @xmath317 to @xmath318 in @xmath326)$ ] .",
    "it then follows from proposition [ proposition : band - diameter ] that @xmath328 and since @xmath236 is an @xmath308-correspondence ( and so an @xmath18-correspondence ) , @xmath329 .    as a corollary of the theorem [ diameter - connected - comp - reeb ] and theorem [ thm : bound - dgh - betti1-m ]",
    "we immediately obtain the following results for the reeb graph and the @xmath21-reeb graphs .",
    "[ thm : bound - dgh - final ] let @xmath0 be a compact connected path metric space , let @xmath5 be a fixed base point such that the metric reeb graph @xmath6 of the function @xmath7 is a finite graph .",
    "if for a given @xmath8 there exists a finite metric graph @xmath9 such that @xmath10 then we have @xmath330 where @xmath12 is the number of edges of @xmath13 of length at most @xmath14 . in particular if @xmath17 is at distance less than @xmath18 from a metric graph with shortest edge length larger than @xmath14 then @xmath331 .",
    "[ thm : bound - dgh - final - alpha ] let @xmath0 be a compact connected path metric space .",
    "let @xmath5 , @xmath94 and @xmath87 be a finite covering of the segment @xmath332 $ ] by open intervals of length at most @xmath21 such that the @xmath21-reeb graph @xmath89 associated to @xmath87 and the function @xmath7 is a finite graph . if for a given @xmath8 there exists a finite metric graph @xmath9 such that @xmath10 then we have @xmath333 where @xmath334 is the number of edges of @xmath13 of length at most @xmath302 . in particular if @xmath17 is at distance less than @xmath18 from a metric graph with shortest edge length larger than @xmath302 then @xmath335 .",
    "in this section , we describe an algorithm for computing @xmath21-reeb graph for some @xmath80 .",
    "we assume the input of the algorithm is a neighboring graph @xmath336 , a function @xmath337 specifying the edge length and a parameter @xmath21 . in the applications where the input is given as a set of points together with pairwise distances , i.e. , a finite metric space",
    ", one can generate the neighboring graph @xmath338 as a rips graph of the input points with the parameter chosen as a fraction of @xmath21 .",
    "our algorithm can be described as follows .",
    "we assume @xmath338 is connected as one can apply the algorithm to each connected component if @xmath338 is not .",
    "figure  [ fig : algorithm ] illustrates the different steps of the algorithm . in the first step ,",
    "we fix a node of @xmath338 as the root @xmath60 and then obtain the distance function @xmath339 by computing @xmath340 as the graph distance from the node @xmath341 to @xmath60 . in the second step ,",
    "we apply the mapper algorithm  @xcite to the nodes @xmath51 with filter @xmath62 to construct a graph @xmath342 .",
    "specifically , let @xmath343 so that @xmath344 covers the range of the function @xmath62 .",
    "we say an interval @xmath345 is lower than another interval @xmath346 if the midpoint of @xmath347 is smaller than that of @xmath348 .",
    "now let @xmath349 be the subgraph of @xmath338 restricted to @xmath350 .",
    "namely two nodes in @xmath349 are connected with an edge if they are in @xmath338 .",
    "notice that each subgraph @xmath349 may have several connected components , which can be listed in an arbitrary order .",
    "denote @xmath351 the @xmath244-th connected component of @xmath349 and @xmath352 its set of nodes .",
    "think of @xmath353 as a cover of @xmath51 .",
    "then the graph @xmath342 constructed by the mapper algorithm is the @xmath20-skeleton of the nerve of that cover .",
    "namely , each node in @xmath342 represents an element in @xmath353 , i.e. , a subset of nodes in @xmath51 .",
    "two nodes @xmath354 and @xmath355 are connected with an edge if @xmath356 .    in the final step ,",
    "we represent each node @xmath357 in @xmath342 using a copy of the interval @xmath358 . as mentioned in the section  [ sec : reeb - graph ]",
    ", @xmath21-reeb graph is a quotient space of the disjoint union of those copies of intervals .",
    "specifically , for an edge in @xmath342 , let @xmath354 and @xmath355 be its endpoints",
    ". then @xmath347 and @xmath348 must be partially overlapped .",
    "we identify the overlap part of these two intervals . after identifying the overlapped intervals for all edges in @xmath342 ,",
    "the resulting quotient space is the @xmath21-reeb graph .",
    "algorithmically , the identification is performed as follows .",
    "we split each copy of internal @xmath358 into two by adding a point in the middle .",
    "now think of it as a graph with two edges and label one of them upper and the other lower .",
    "notice that two overlapped intervals @xmath347 and @xmath348 can not be exactly the same .",
    "one must be lower than the other . to identify their overlapped part ,",
    "we identify the upper edge of the lower interval with the lower edge of the upper interval .",
    "the time complexity of the above algorithm is dominated by the computation of the distance function in the first step , which is @xmath359 .",
    "the computation of the connected components in the second step is @xmath360 based on union - find data structure . in the final step ,",
    "there are at most @xmath361 number of the copies of the intervals .",
    "based on union - find data structure , the identification can also be performed in @xmath360 time .    [ cols=\"^ \" , ]",
    "we have proposed a method to approximate path metric spaces using metric graphs with bounded gromov - hausdorff distortion , and illustrated the performances of our method on a few synthetic and real data sets . here",
    "we point out a few possible directions for future work .",
    "first , notice that the @xmath21-reeb graph is a quotient space where the quotient map is 1-lipschitz and thus the metric only gets contracted .",
    "in addition , the distance from a point to the chosen root is exactly preserved .",
    "therefore , one always reduces the metric distortion by taking the maximum of the graph metrics of different root points .",
    "it is interesting to study the strategy of sampling root points to obtain the smallest metric distortion with the fixed number of root points .",
    "second , our method in the current form does not recover the topology of the underlying metric space .",
    "the tools recently developed in persistence homology seem useful for recovering topology : we provide a preliminary persistence - based result in the appendix showing that the first betti number of the underlying metric graph can be inferred from the data . on another hand ,",
    "reeb graphs have recently been used for topological inference purpose in @xcite .",
    "it would be interesting to combine our method to these approaches to also obtained topologically correct reconstruction algorithms .",
    "finally , our method is sensitive to the noise .",
    "one can of course preprocess the data and remove the noise and then apply our algorithm .",
    "nevertheless , it is interesting to see if the algorithm can be improved to handle noise .",
    "the authors acknowledge daniel mllner and g. carlsson for fruitful discussions and for providing code for the mapper algorithm .",
    "they acknowledge the european project cg - learning ec contract no .",
    "255827 ; the anr project giga ( anr-09-blan-0331 - 01 ) ; the national basic research program of china ( 973 program 2012cb825501 ) ; tsinghua national laboratory for information science and technologytnlistcross - discipline foundation .",
    "although our metric graph reconstruction algorithm does not provide topological guarantees , we show below that , using persistent topology arguments , that the first betti number of a graph can be inferred from an approximation .",
    "recall that given a compact metric space @xmath22 and a real parameter @xmath362 , the vietoris - rips complex @xmath363 is the simplicial complex with vertex set @xmath17 and whose simplices are the finite subsets of @xmath17 with diameter at most @xmath21 :",
    "@xmath364 \\in \\rips(x,\\alpha ) \\leftrightarrow d_x(x_i , x_j ) \\leq \\alpha \\ \\ { \\rm for all } \\ i , j.\\ ] ]    [ lemma : betti1-graph ]",
    "let @xmath16 be a connected metric graph and let @xmath365 be the length of the shortest loop in @xmath16 that is not homologous to @xmath140 .",
    "for any metric space @xmath366 such that @xmath367 and any @xmath368 , the first betti number of @xmath16 is given by @xmath369 where the homomorphism between the homology groups is the one induced by the inclusion maps between the rips complexes .",
    "the proof follows from a result of @xcite that relates the homology of the rips complexes built on top of @xmath16 to the homology of @xmath16 and a result of @xcite that allows to relate the rips filtration built on top of @xmath16 and @xmath366 at the homology level . since @xmath16 is a geodesic path , it follows from theorem 3.5 and remark 2 ) , p.179 in @xcite that for any @xmath370 , @xmath371 and @xmath16 are homotopy equivalent .",
    "moreover , from proposition 3.3 in @xcite , for any @xmath372 , the homomorphism @xmath373 induced by the inclusion map is an isomorphism .",
    "now let @xmath374 be an @xmath375-correspondence between @xmath366 and @xmath16 where @xmath376 .",
    "according to @xcite , the persistence modules @xmath377 and @xmath378 are @xmath375-interleaved .",
    "now let @xmath21 be as in the statement of the lemma and let @xmath379 be such that @xmath380 .",
    "the @xmath18-interleaving induces the following sequence of homomorphisms @xmath381 where the composition of two consecutive homomorphisms is the homomorphism induced by the inclusion map between the corresponding rips complexes . as a consequence since @xmath382",
    "the homomorphisms @xmath383 and @xmath384 are isomorphisms of rank @xmath385 .",
    "it follows that the rank of @xmath386 is equal to @xmath385 ."
  ],
  "abstract_text": [
    "<S> in many real - world applications data come as discrete metric spaces sampled around 1-dimensional filamentary structures that can be seen as metric graphs . in this paper </S>",
    "<S> we address the metric reconstruction problem of such filamentary structures from data sampled around them . </S>",
    "<S> we prove that they can be approximated , with respect to the gromov - hausdorff distance by well - chosen reeb graphs ( and some of their variants ) and we provide an efficient and easy to implement algorithm to compute such approximations in almost linear time . </S>",
    "<S> we illustrate the performances of our algorithm on a few synthetic and real data sets . </S>"
  ]
}