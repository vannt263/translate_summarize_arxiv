{
  "article_text": [
    "arguably the most promising short term application of quantum information technology is in the field of cryptography , with quantum key distribution ( qkd ) the canonical example @xcite . in the years since its inception",
    ", researchers have worked to improve the rigour and generality of security proofs , design protocols that maximise performance and bridge the gap between theoretical proposal and experimental implementation @xcite . on the security side ,",
    "one looks to derive a security proof that is _ composably _ secure against arbitrary eavesdropping attacks whilst including all finite - size statistical effects @xcite ( see also @xcite ) . practically , one searches for schemes that maximise both the raw clock - rate ( the number of transmissions per second ) and the number of secure bits per transmission to achieve the largest overall secret key rate at a given transmission distance .",
    "most photonic qkd implementations fall into one of two regimes .",
    "traditional discrete variable ( dv ) schemes encode the secret key in a two - dimensional hilbert space such as the polarisation degrees of freedom of a single photon . extending from the original works @xcite , these protocols now enjoy universal security proofs @xcite that function with reasonably small finite - size data blocks , and converge to the ideal devetak - winter rates for collective attacks @xcite in the asymptotic limit .",
    "continuous variable ( cv ) schemes utilise an infinite - dimensional hilbert space , commonly the quadratures of the optical field @xcite . whilst the finite range and precision of real - life detectors ensures the key is never perfectly continuous , cvqkd nevertheless has the capability to achieve greater than one bit per transmission .",
    "furthermore , composable , general , finite - size cvqkd security proofs have also appeared , although the present results either require extremely large block sizes @xcite , or are very sensitive to losses @xcite and fail to converge to the devetak - winter rates .",
    "this behaviour is in large part due to the different way loss manifests itself in dv and cv systems .",
    "if a single photon is sent through an extremely lossy channel , it will only be detected with very low probability .",
    "however , in the instances where a detection does take place , the quantum state is largely preserved and the security is unaffected .",
    "therefore , one can in principle achieve high rates over lossy channels by improving the repetition rate of the photon source or multiplexing .",
    "but for coherent or squeezed states commonly used in cvqkd , the loss degrades the signal for all transmissions , rendering the information advantage so small that even modest experimental imperfections will eventually prohibit key extraction .",
    "an alternative approach is to encode the key in the continuous degrees of freedom of single photons , inheriting both the loss tolerance of dvqkd and the larger encoding space of cv protocols @xcite .",
    "these time - frequency schemes are primarily pursued via the temporal and spectral correlations of single photons emitted during spontaneous parametric down conversion ( spdc ) and the security stems from the conjugate nature of frequency and arrival time measurements .",
    "one can use fast time - resolving detectors to directly measure photon arrival times and a grating spectrometer to measure frequency .",
    "it is also possible to adopt just the former detection scheme and convert to frequency measurements via dispersive optics @xcite , or the solely the latter and convert to time via phase modulation @xcite .",
    "significant progress has been made on the theoretical @xcite and experimental front @xcite however , a general composable security proof is lacking . exploiting techniques from traditional cvqkd @xcite , security proofs",
    "have been derived against gaussian collective attacks and extended to incorporate finite - size effects @xcite and decoy - states @xcite culminating in a result including both @xcite .    in this work we present a finite - size , composably secure proof for tfqkd by combining the entropic uncertainty proofs for cvqkd @xcite with efficient , finite - size decoy - state analysis @xcite for dvqkd .",
    "the resultant proofs allow for high rates of key to be distributed over urban and inter - city distances with reasonable block sizes .",
    "a fairly generic tfqkd decoy - state protocol can be summarised as follows .    1 .",
    "quantum transmission and measurement : quantum states are distributed from alice to bob through a potentially eavesdropper controlled quantum channel . in particular , using a pulsed spdc source she prepares time - frequency entangled photons",
    ". each round of transmission is defined by a time frame of length @xmath0 which is centred about the peak of each pump pulse .",
    "alice randomly varies her pump power between three values @xmath1 , according to probabilities @xmath2 . immediately after the channel",
    ", we make the worst case assumption which is that eve completely purifies the shared state , @xmath3 , such that the overall tripartite state , @xmath4 , is pure .",
    "alice and bob then randomly switch between measuring the frequency or arrival time of the photons .",
    "they choose either the time or frequency measurement for key generation and use the other to check for an eavesdroppers presence . to analyse both possibilities , we will write the two incompatible observables as positive operator valued measurements ( povms ) @xmath5 ) for alice and @xmath6 ) for bob . here",
    "we will always denote @xmath7 as the key generating observable and @xmath8 as the check .",
    "2 .   parameter estimation : alice and bob first announce their measurement choices in each round over a public , but authenticated , classical channel and discard all instances where they differ , as well as any instances where two or more detections occur in the same frame .",
    "this results in raw , correlated variables @xmath9 which take values @xmath10,x_b = [ x_b^1,x_b^2 ... x_b^{n_p}]$ ] which are strings of length @xmath11 , distributed according to a probability distribution @xmath12 and similarly for @xmath13 and @xmath14 . throughout",
    ", we will use uppercase to denote random variables and lowercase to denote a corresponding string that is an instantiation of that variable .",
    "alice then announces which intensity was used in each transmission and the results are further partitioned into substrings e.g. @xmath15 is partitioned into @xmath16 of length @xmath17 for @xmath18 and similarly for the other strings . using the number of detections for each pump power and decoy state analysis , alice and",
    "bob lower bound the number of signals that originated from a single photon transmission .",
    "they then announce all outcomes for the @xmath8 observables and evaluate the quality of their correlations .",
    "if the quality is sufficiently high ( in a way we will make precise later ) they proceed , otherwise they abort .",
    "call the passing probability @xmath19 .",
    "conditional on passing , they are left with raw keys which are partially correlated between alice and bob as well as the eavesdropper .",
    "the overall conditional state between alice , bob and eve is a classical - quantum state of the form , @xmath20 3 .",
    "reconciliation : either alice or bob is designated the reference partner , which means that their string is designated as the ` correct ' string .",
    "the reference partner then sends information to the other party to correct any errors between the two strings .",
    "if the reference partner is alice , and the reconciliation information flows in same direction as the quantum transmission this is called direct reconciliation ( dr ) .",
    "the converse is called reverse reconciliation ( rr ) . here",
    "we will consider the dr case .",
    "if the reconciliation is successful , alice and bob will now have perfectly correlated strings @xmath21 which are still partially known to eve .",
    "in fact , eve will usually have learned some more information about the strings during the reconciliation process .",
    "the amount of ` leaked ' information is denoted @xmath22 .",
    "there is also an additional loss from a reconciliation check procedure , where alice announces a further string of size @xmath23 to ensure the strings are identical except with probability @xmath24 .",
    "privacy amplification : alice and bob now apply a function , @xmath25 , drawn randomly from a family , @xmath26 , of two - universal hashing functions to their measurement strings giving @xmath27 .",
    "the final state is now @xmath28 + this ideally result in strings of length @xmath29 which are perfectly correlated , uniformly random , and completely independent of eve .",
    "these are the final secret keys .",
    "the goal of a security analysis is to find a lower bound on the number of extractable bits , @xmath29 , for any given protocol .",
    "we now formally state the definitions of composable security and a formalism to quantitatively relax from the ideal case @xcite .",
    "a protocol that outputs a state of the form ( [ s ] ) is    * _ @xmath24-correct _ if @xmath30 \\leq \\epsilon_c$ ] and _ correct _ if the condition holds for @xmath31 . *",
    "@xmath32-secret if @xmath33 + where @xmath34 , @xmath35 is the trace norm and @xmath36 is the uniform ( i.e. maximally mixed ) state over @xmath37 .",
    "it is _ secret _ if the condition holds for @xmath38 .",
    "the protocol is _ ideal _ if is is both correct and secret and _ @xmath39-secure _ if it is @xmath39-indistinguishable from an ideal protocol .",
    "this means that there is no device or procedure that can distinguish between the actual protocol and an ideal protocol with probability higher than @xmath39 . if the protocol is @xmath32-secret and @xmath24-correct then it is @xmath39-secure for any @xmath40 .",
    "the choice of error reconciliation fixes @xmath24 so the goal is now to find a method to bound @xmath32 .",
    "first , we briefly introduce the entropic quantities appropriate for finite - size analysis . for a random variable @xmath41 coupled to a quantum system @xmath42 associated with a hilbert space @xmath43 with the joint system described by a classical - quantum state @xmath44",
    ", the conditional min - entropy of @xmath41 can be defined as the negative logarithm of the optimal probability of successfully guessing @xmath41 given @xmath42 @xcite , that is , @xmath45 where the supremum is taken over all povms and the logarithm here and throughout is taken to be base 2 .",
    "a related quantity is the conditional max - entropy @xmath46 where @xmath47 is the quantum fidelity and the supremum is over all physical states in @xmath43 , that is @xmath48 .",
    "one can also define smoothed versions of these quantities that consider @xmath49-regions in the state space .",
    "concretely we have , @xmath50 where the supremum and infimum are taken over all states @xmath51 that are @xmath49-close in the purified distance , defined as @xmath52 .",
    "we again emphasise that throughout this work we will be considering the classical - quantum states conditioned on the parameter estimation test having been passed . for the rest of this work we will suppress the state subscript in the entropies .",
    "if the guessing probability is low then the variable @xmath41 must have a high degree of randomness with respect to an observer holding @xmath42 . intuitively then",
    ", we might expect the conditional smooth min - entropy to be related to the number of secret bits extractable from variable @xmath41 with failure probability @xmath49 as described in definition 1 .",
    "this intuition is usefully formalised in the leftover hash lemma ( with quantum side information ) @xcite .",
    "[ leftover ] let @xmath53 be a state of the form ( [ meas ] ) where @xmath54 is defined over a a discrete - valued and finite alphabet , e is a finite or infinite dimensional system and @xmath55 is a register containing the classical information learnt by eve during information reconciliation .",
    "if alice applies a hashing function , drawn at random from a family of two - universal hash functions be sets of finite cardinality @xmath56 .",
    "a family of hash functions @xmath57 , is a set of functions @xmath58 such that @xmath59 , @xmath60\\leq \\frac{1}{|s|}$ ] ] that maps @xmath54 to @xmath37 and generates a string of length @xmath61 , then @xmath62 where @xmath63 is the conditional smooth min - entropy of the raw measurement data given eve s quantum system and the information reconciliation leakage .    comparing ( [ sec ] ) and ( [ hash ] )",
    "we see that with an appropriate choice of @xmath29 we can ensure the security condition is met .",
    "in particular we see that the smooth min - entropy is a lower bound on the extractable key length .",
    "suppose that we are only able to bound the smooth min - entropy with a certain probability @xmath64 ( in this work this will be due to the use of hoeffding s bound in the decoy - state analysis ) . to get a more exact expression notice that if we choose @xmath65 for some @xmath66 then the r.h.s of ( [ hash ] ) is @xmath67 .",
    "then , provided @xmath68 the convexity and boundedness of the trace distance implies we will satisfy ( [ sec ] ) for any secrecy parameter @xmath69 . recalling that by assumption eve learns at most @xmath70 bits during information reconciliation we have that ,    @xmath71 finally since @xmath72 we have the following result @xcite",
    "let @xmath73 describe the state between alice and eve conditioned on the parameter estimation test succeeding such that the leftover hash lemma is applicable . for an error correction scheme as defined above we may extract an @xmath24-correct and @xmath32-secret key of length @xmath74    so the problem has essentially condensed to bounding the conditional smooth min - entropy , @xmath75 .",
    "the central idea is to quantify the smooth min - entropy in one observable by observing the statistics of another , incompatible , observable .",
    "this is nothing more than a manifestation of heisenberg s uncertainty principle , which has long underpinned quantum cryptographic protocols .",
    "specifically , this notion is quantitatively expressed via an uncertainty relation for the smooth min- and max - entropies @xcite and its extension to the infinite dimensional setting in @xcite .",
    "these relations can be formulated as follows @xcite .",
    "let @xmath76 be an @xmath77-mode state shared between alice , bob and charlie and let alice s measurements be described by povms @xmath78 and @xmath79 with elements @xmath80 and @xmath81 respectively .",
    "let @xmath54 be the random variable describing the measurement outcome and @xmath82 be the joint state of the measurement register and system @xmath83 given that alice measured @xmath78 on each of the @xmath77 modes .",
    "further , let @xmath84 describe the measurement outcome and @xmath85 be the joint state of the measurement register and system @xmath86 given the counterfactual scenario where alice instead measured @xmath79 upon each mode .",
    "the sum of the corresponding smooth entropies satisfies the relation @xmath87 where @xmath88 quantifies the compatibility of the measurements with @xmath89 the operator norm or the largest singular value .",
    "we now turn to our specific measurement setup where we identify the conjugate measurements @xmath90 and @xmath91 with time and frequency .      following @xcite we describe the arrival time and conjugate frequency detuning measurements by the following operators ,    @xmath92    for @xmath93 .",
    "if we restrict the field operators to the hilbert space spanned by the single photon time or frequency domain states , @xmath94 and @xmath95 , then we have @xmath96 and @xmath97 so that we can write , @xmath98 these operators can be shown to be maximally complementary , self - adjoint projectors describing an arrival time measurement that satisfy @xmath99 } = i \\delta_{jk}$ ] , and hence can be considered equivalent to the canonical position and momentum operators @xcite .",
    "fortunately , the smooth - min entropy uncertainty relations have recently been extended to allow for observables and eavesdroppers living in infinite dimensional hilbert spaces @xcite .",
    "however , only in the instances where alice s source emitted exactly one photon will the povm s be restricted as per ( [ tfop ] ) and result in a useful uncertainty relation . to this end , let @xmath100 be a povm , defined as the restriction of the povm @xmath78 to the single photon subspace such that it is described as per ( [ tfop ] ) .",
    "we can now consider the decomposition of the measurement record into variables describing the single , vacuum and multi - photon components components such that we have @xmath101 . in order to apply the uncertainty relation",
    "directly we consider the case where eve assumed to know the multi - photon and vacuum measurements and is left solely with estimating the single photon components , that is we set @xmath102 in ( [ eur ] ) .",
    "the following section explains how to relate @xmath103 to @xmath75 and also how to estimate the number of single photon events in a given set of detections .",
    "even though alice never knows in a given run how many photons are emitted , the number of single - photon events in a collection of runs can be bounded via decoy - state analysis which involves using states with known _ average _ photon numbers .",
    "for now we turn to computing the overlap for measurements described by ( [ tfop ] ) .",
    "in fact , alice and bob actually measure coarse grained , finite versions of these measurements .",
    "this is a practical necessity in ordinary cvqkd ( all homodyne measurements have a finite precision and dynamic range ) and in this case , measuring precisely an arrival time operator as defined in ( [ tfop ] ) would require a detector that has been turned on in the infinite past .",
    "furthermore , a finite alphabet is necessary in order to apply the leftover hash lemma . in standard cvqkd the quadrature observables can usually be treated symmetrically . in this work",
    "we must consider the conjugate observables individually , partly because in practice they have different achievable measurement resolutions and partly because they are physically different quantities .",
    "for instance , for arrival time measurements the maximum value is equal to the time frame duration for each measurement round , which in turn puts immediate limits on the maximum overall clock rate of the protocol .",
    "alice s measurements are divided into evenly spaced bins of width @xmath104 up to a maximum value @xmath105 such that @xmath106 are assumed integer alphabet sizes for simplicity .",
    "we can write binned observables corresponding to intervals on the real line @xmath107 , i_2 = ( -\\delta_x+\\delta_x , -\\delta_x+2\\delta_x] ... i_{m_x } = ( \\delta_x-\\delta_x,\\infty]$ ]",
    ". the measurement outcome range is then denoted @xmath108 .",
    "thus the povm elements of @xmath100 are projectors in ( [ tfop ] ) integrated over the bin intervals , @xmath109 and similarly for @xmath110 .",
    "notice that this is something of a problem as the two infinite end intervals of these binned measurements actually have a large overlap .",
    "in fact @xmath111 which would mean that for these particular measurements the rhs of ( [ eur ] ) is approximately zero and the relationship becomes useless .    to avoid this problem ,",
    "instead consider a second , hypothetical set of discrete measurements @xmath112 which are defined as per ( [ quad ] ) but over a new interval set which is simply the infinite collection of intervals , @xmath113 , of width @xmath114 , enumerated such that @xmath115 .",
    "for these measurements the maximum overlap is given by @xcite ,    @xmath116 where @xmath117 is the radial prolate spheroidal wavefunction of the first kind .",
    "thus , for sufficiently small bin sizes , we can always recover a nontrivial value of @xmath118 and thus a useful uncertainty relation .",
    "the idea is that , for a state that mostly lives in the phase space spanned by the region @xmath119 $ ] , the classical - quantum states after alice applies @xmath120 and @xmath100 will be very close .",
    "we will use our knowledge of alice s state preparation to quantify this ` closeness ' .",
    "in particular , we will assume that for the all states used in the protocol alice s source produces a tensor product state , and in particular for the @xmath77 states on which @xmath78 is measured there is some @xmath121 such that @xmath122 .",
    "moreover , our knowledge of alice s state allows us to lower bound the probability of measuring a value within the range @xmath119 $ ] on any given run such that , @xmath123 this it turn means that the probability of measuring an absolute value larger than @xmath124 at any point in the whole protocol given the parameter test was passed is @xmath125 where , @xmath126 and a similar relation holds for the @xmath79 measurements .",
    "we then finally have a relation between the entropies of the two discretized measurements conditional on a system @xmath83 , namely @xcite @xmath127 where @xmath128 ( recall that the scripted variable @xmath84 is denoting the hypothetical situation where @xmath79 was measured on the @xmath77 key generating modes instead ) .",
    "putting all this together with the uncertainty relation ( [ eur ] ) finally allows us to write ,    @xmath129 where @xmath130 is the number of instances where alice and bob measured in the same basis and only a single photon was created . in reality however , the measurement record will also include contributions from vacuum and multi - photon terms so we will need a way to determine a lower bound on the min - entropy of the whole string , @xmath131 in terms of @xmath132 so that we can apply ( [ minmax ] ) .",
    "we will also require a lower bound on @xmath130 and an upper bound upon @xmath133 based upon the correlations in the @xmath134 measurements of @xmath8 observables .",
    "fortunately , all of these can be achieved via decoy - state analysis .",
    "we employ the decoy - state analysis of @xcite which we will recapitulate in our notation for completeness . recalling the decomposition of the measurements into vacuum , single and multi - photon components we have @xmath101 . applying a generalisation of the chain rule for smooth - entropies @xcite",
    "gives ,    @xmath135 for @xmath136 where @xmath137 for all @xmath138 .",
    "applying the same chain rule to the second term on the rhs gives , @xmath139 where @xmath140 is the number of @xmath41 basis measurements that resulted when the source produced a vacuum state . in the second inequality",
    "we have used that @xmath141 , which is equivalent to assuming all multi - photon events are insecure and also that @xmath142 where the inequality is true by definition and final equality comes from assuming that vacuum contributions are uncorrelated with the chosen bit values and uniformly distributed across the measurement range . note that since @xmath143 and @xmath144 now no longer feature directly , we can set them arbitrarily small and neglect them from further calculations .",
    "putting this together gives ,    @xmath145 which we can now bound according to ( [ minmax ] ) to get @xmath146    now , we also need to derive lower bounds upon the number of vacuum and single photon contributions .",
    "recall that in the protocol , alice probabilistically selects a pump power , @xmath147 , with probability @xmath148 which in turn probabilistically results in an @xmath149-photon state with conditional probability @xmath150 assuming a poissonian source .",
    "although we can not directly know how many detections are due to a particular photon number emission , we do know how many detections are due to a particular pump power .",
    "the main idea of a decoy state analysis is to use the latter information to place bounds on the former .",
    "following @xcite we first note from the eavesdropper s perspective it could just as well be a counterfactual scenario where alice instead creates n - photon states and merely probabilistically partitions them so that each subset has a mean photon number @xmath147 .",
    "indeed , bayes rule allows us to write the down the appropriate probability of pump power given @xmath149-photon emission as , @xmath151 where @xmath152 is the total probability of an @xmath149-photon emission .",
    "note that technically all of these probabilities should also be conditioned on the parameter test on the @xmath79 basis measurements passing .",
    "however , when considering the @xmath78 basis alice can be sure that this conditioning will make no difference . to see this , consider the counterfactual case where she prepares @xmath149-photon states . by simply not assigning @xmath153 values in the @xmath78 basis until after the parameter test on the @xmath79",
    "is completed she can ensure that probabilities like ( [ pkn ] ) are unchanged by conditioning . in the asymptotic limit of large statistics , ( [ pkn ] )",
    "allows us to relate the number of coincidences given a certain pump power , @xmath17 to the number given an @xmath149-photon emission , @xmath154 , via @xmath155 where @xmath156 is the asymptotic value of @xmath17 and we have substituted in from ( [ pkn ] ) and ( [ pnk ] ) .",
    "we can then use hoeffding s inequality for independent events which says that the difference between observed statistics and their asymptotic values is bounded by @xmath157 and hence @xmath158 where , @xmath159 with probability at least @xmath160 where @xmath161 . now consider the following expression : @xmath162 notice that in the above expression the summand vanishes when @xmath163 .",
    "this means we can split up the sum as , @xmath164 where the inequality holds provided @xmath165 . rearranging gives a lower bound on the vacuum conincidences , @xmath166 which holds with probability at least @xmath167 .",
    "the single photon bound is somewhat more involved .",
    "first , by similar reasoning as above , we have : @xmath168 since now the @xmath169 term vanishes .",
    "now , using the identity @xmath170 we have @xmath171 which combined with the inequality @xmath172 @xmath173 gives @xmath174 where the second last equality results in a tighter bound when we apply the condition @xmath175 to obtain the last inequality . substituting back in ( [ s11 ] ) yields : @xmath176 rewriting the sum as @xmath177 and substituting back into ( [ n1 ] ) , we can solve for @xmath130 , and using the hoeffding bounds arrive at the following lower bound for the single photon detections : @xmath178\\label{nx1 } \\end{aligned}\\ ] ] which holds with probability at least @xmath179 .",
    "now the only unbounded term in the key rate formula is the max - entropy term @xmath180 .",
    "firstly , by the data processing inequality we have @xmath181 .",
    "we again use the results of @xcite , where a statistical bound on the smooth max - entropy over a classical probability distribution is found based on the observed correlations .",
    "alice and bob quantify the correlations by computing the average distance ( essentially the hamming distance but for non - binary strings ) which for two strings @xmath182 and @xmath183 taking values in @xmath184 is defined as : @xmath185 in order to bound @xmath186 we proceed in three steps .",
    "firstly , we use decoy - state arguments to upper bound @xmath187 , the average distance on just the single photon terms .",
    "then , following @xcite , we use this upper bound and a result by serfling @xcite to upper bound the average distance that could be observed on the counterfactual variables @xmath188 .",
    "finally , we use this quantity to upper bound the smooth max - entropy .",
    "the quantity @xmath189 in ( [ dpe ] ) is just counting the number of bins between alice and bob s measurements . considering the substring corresponding to pump power @xmath190 , in the asymptotic limit",
    ", we expect @xmath191 from @xmath189 errors to be assigned to @xmath190 where @xmath192 and @xmath193 is the number of errors in the @xmath8 basis resulting from @xmath149-photon states .",
    "just as when we were bounding the number of single - photon terms , we can use hoeffding s result to bound the difference between this unknown asymptotic quantity and the observed value , @xmath194 except with probability @xmath160 where now @xmath195 to account for the non - binary nature of entries in the error strings .",
    "hence we expect in the asymptotic limit to have @xmath196 rearranging gives , @xmath197    with probability at least @xmath198 where @xmath199 is calculated in the same manner as ( [ nx1 ] ) .",
    "now , say that alice and bob abort the protocol whenever @xmath200 .",
    "now , we again consider bounding the counterfactual average distance @xmath188 . for brevity we define @xmath201 and @xmath202 and denote the total average distance that would be observed on the combination of the strings as @xmath203 .",
    "given that the observed correlations pass the parameter estimation test , we are interested in the probability that the average distance of the hypothetical measurements would be greater than @xmath204 by a fixed amount .",
    "@xmath205&\\leq & \\mathrm{pr}[d_{\\mathscr{p},1 } > d_{p,1 } + c|``\\mathrm{pass}\"]{\\nonumber}\\\\ & \\leq & \\frac{\\mathrm{pr}[d_{\\mathscr{p},1 } > d_{p,1 } + c]}{p_\\mathrm{pass}}\\label{pass } \\end{aligned}\\ ] ] where we have used bayes theorem in the last line .",
    "bounding @xmath206 $ ] is a standard problem of random sampling without replacement . defining the total number of detections coming from single photons as @xmath207 we have , @xmath208 a result by serfling shows that for any @xmath209 @xcite , @xmath210 \\leq \\exp{\\left ( \\frac{-2 n_{x,1}n_{1 } c^2}{(n_{p,1}+1 ) m_p^2}\\right ) } \\label{serf } \\end{aligned}\\ ] ] where we recall that @xmath211 is the size of the alphabet of @xmath79 outcomes . now using ( [ drel ] ) and ( [ serf ] ) we can write , @xmath212 = \\mathrm{pr}[d_{\\mathscr{p},1 } > d_{p,\\mathrm{tot } } + \\frac{n_{p,1}}{n_1}c]{\\nonumber}\\\\ { & = & } \\sum_a \\mathrm{pr}[d_{p,\\mathrm{tot}}=a]\\mathrm{pr}[d_{\\mathscr{p},1 } > a + \\frac{n_{p,1}}{n_1}c|d_{p,\\mathrm{tot } } = a]{\\nonumber}\\\\ & \\leq & \\exp{\\left ( \\frac{-2 n_{x,1 } ( n_{p,1})^2c^2}{(n_{p,1}+1)n_{1 } m_p^2}\\right ) } \\end{aligned}\\ ] ] substituting back into ( [ pass ] ) and recalling that the protocol aborts whenever @xmath200 we have , @xmath213 \\leq\\frac{\\exp{\\left ( \\frac{-2 n_{x,1}^- ( n_{p,1}^-)^2c^2}{(n_{p,1}^++1)n_{1}^+ m_p^2}\\right ) } } { p_{\\mathrm{pass } } } \\label{expbound } \\end{aligned}\\ ] ] where we have substituted in the lower bounds in the numerator and upper bounds in the denominator . in order to evaluate ( [ expbound ] ) we still require the upper bound @xmath214 , noting that this will automatically yield @xmath215 . to this end , define @xmath216 as the total number of detections in both bases at a given pump power , @xmath217 as its asymptotic value and @xmath218 as the number of detections from @xmath149-photon states .",
    "then we may write , @xmath219 provided @xmath165 which implies @xmath220 except with probability @xmath198 . finally , we use the following result @xcite ( proposition 1 ) ,    let @xmath221 be a finite alphabet , @xmath222 a probability distribution on @xmath223 for some @xmath224 , @xmath225 and @xmath226 . if @xmath227 \\leq \\nu^2 $ ] then , @xmath228 where @xmath229    this result might seem surprising given that an entropy is by definition label - independent , whereas the average distance explicitly depends upon the choice of labels .",
    "the resolution is that the lemma is derived by taking a worse case scenario in which the number of observed bin errors is assumed to be due to individual entries each of which different by only one bin , thus maximising the max - entropy .",
    "this means that the bound will hold true regardless of the labelling convention used on the data , but a poor choice of labelling ( for instance one that numbered adjacent bins by greatly differing numbers ) would result in a very pessimistic bound .",
    "we can apply this result by setting @xmath230 .",
    "this allows us to bound @xmath231 where @xmath232 for any @xmath19 which is always possible provided @xmath226 .",
    "thus , provided @xmath233 there is some @xmath83 such that we can set @xmath234 and use this result to bound the smooth max - entropy in ( [ hminbnd ] ) .",
    "the final step is to account for all the error terms due to finite - size effects to find the actual secrecy parameter and to eliminate the explicit dependence upon @xmath19 . from the decoy state analysis",
    "we can rewrite @xmath235 ( recall that we can neglect the @xmath143 and @xmath144 terms ) . from our security definitions ,",
    "provided ( [ ese1 ] ) is satisfied , we will extract an @xmath236 secret key .",
    "in particular we may satisfy ( [ ese1 ] ) by choosing @xmath237 in which case we have , @xmath238 where the second line used @xmath239 .",
    "this lower bound on @xmath240 can be used to upper bound on the logarithmic term in ( [ c1 ] ) .",
    "we must include the failure probabilities from the hoeffding bounds , which we applied to the number of counts for three pump powers in two measurement bases , each contributing an error term @xmath241 .",
    "this gives an overall error budget @xmath242 . if , for simplicity , we choose @xmath243 and set @xmath244 then straightforward substitution into ( [ nu ] ) , which is used to bound ( [ c1 ] ) and hence ( [ maxbound])and ( [ hminbnd ] ) gives us a final expression for the @xmath24-correct , @xmath245-secret key length :    @xmath246 where @xmath247 as noted earlier , in order for there to be a positive keyrate , the denominator inside the logarithmic term in @xmath83 must positive .",
    "this means that @xmath248 are not free parameters , but must be chosen to ensure that this condition is satisfied .",
    "we now turn to the the numerical evaluation of the key rate formula , taking parameters mostly from @xcite for the simulations .",
    "we will consider transmission through optical fibre at telecom wavelengths , which is well modelled as a lossy channel where the transmission is related to the distance , @xmath249 , via @xmath250 .",
    "when the number of channel uses @xmath251 ( instances where alice attempts to generate a pair of photons and transmit one to bob ) is large and each party chooses to measure the @xmath252 observable with probability @xmath253 the number of observed counts after sifting for a given pump power will be well approximated by @xmath254 where @xmath255 is the coincidence probability of at least one photon being detected by both alice and bob .",
    "it is given by @xcite , @xmath256 where @xmath257 are the dark count probabilities for alice and bob s detectors and @xmath258 and @xmath259 are their respective efficiencies .",
    "we consider an spdc source that generates a photon pair with temporal wave function @xmath260 where @xmath261 and @xmath262 and @xmath263 are the pump coherence and photon correlation times respectively .",
    "the variance and covariance of alice and bob s measurement strings will be @xmath264    one can also write this as a spectral wave function , @xmath265 with spectral variances and correlations , @xmath266    the final calculations necessary to compute the key rate are the leaked information reconciliation , @xmath267 and the observed correlations @xmath268 . the average distance in a typical run for a given sample size can be found by generating appropriately correlated gaussian distributed strings , binning them and evaluating ( [ dpe ] ) directly . for the parameters chosen here , one finds @xmath269 . for the sample sizes necessary for positive key , the amount of information leaked during reconciliation is well approximated by @xcite , @xmath270 where @xmath271 is the shannon entropy",
    ", @xmath272 is the mutual information and @xmath273 is the reconciliation efficiency .",
    "recent advances have demonstrated efficiencies as large as 0.94 @xcite .",
    "the probabilities for any given outcome can be found by evaluating the discretised observables in ( [ quad ] ) over the appropriate wavefunction .    in fig .",
    "[ rawkey ] we plot the secret key rate , @xmath274 , for various values of the channel uses @xmath251 , as a function to the transmission distance . for the parameters chosen here the protocols where time or frequency are used as the key generating measurement perform comparably .",
    "the time - encoded protocol achieves positive key over 40 km for @xmath275 and out to almost 140 km for @xmath276 .",
    "it should be noted that there are many parameters that affect the protocols performance , particularly the source design and decoy state strategy , and a systematic optimisation could further improve performance . in particular , the choice of whether to encode in frequency or time is strongly dependent upon the properties of the source and detectors . for the parameters used here , encoding in the time basis results in higher key rates , but for keeping all other parameters fixed and decreasing the coherence time to @xmath277 results in virtually identical rates for both protocols .     in red , green and blue respectively .",
    "simulation parameters are : @xmath278 , @xmath279 , @xmath280 = 0.5ns , @xmath263 = 20 ps , @xmath281 = 60 ps , @xmath282 ghz , @xmath283 , @xmath284 , @xmath285 , @xmath286 and @xmath287 . ]    a second quantity of interest is the photon information efficiency ( pie ) , the number of secret bits extracted per coincident detection .",
    "recall that one of the attractions of these tfqkd schemes was the promise of a pie of greater than one bit per photon . in fig .",
    "[ pie ] we plot the pie for the same scenarios as fig .  [ rawkey ] and observe a value greater that 1 over distances of  40 km for @xmath288 and  90 km for @xmath289 , showing that the protocol is indeed making use of the higher dimensions available .    .",
    "]    arguably the most important quantity however , is the achievable number of secret bits per second . for most protocols this",
    "is simply determined by the rate per channel use and the practically achievable clock rate of the relevant source .",
    "however , in tfqkd where the key is actually encoded in a temporal variable itself , the question is more involved .",
    "in particular , recall we earlier noted that for a positive key we had to ensure the positivity of the statistical fluctuation term @xmath83 . this implies the condition @xmath290 which in turn means that both @xmath124 and @xmath291 must be sufficiently large . for the arrival time measurement ,",
    "the maximum observable value dictates the time frame for a given round , @xmath292 and hence a hard upper limit on the possible clock rate of the protocol of @xmath293 .    using our knowledge of alice s source",
    "we can calculate these probabilities for this protocol via gaussian integration . for",
    "a gaussian distributed variable of variance @xmath294 we have , @xmath295 now for any @xmath296 if we require @xmath297 then substituting and rearranging gives , @xmath298 \\end{aligned}\\ ] ] applying this to ( [ delcon ] ) , if we choose to make the two terms on the rhs equal , for the parameters considered here this leads to a requirement on the frequency detection bandwidth of @xmath299 ghz or  5 nm at telecom wavelengths .",
    "similarly we have a requirement on the duration of each round of @xmath30011.73 ns or a maximum clock rate of 85 mhz . in fig .  [ bps ]",
    "we plot the number of bits per second assuming the system is run at its maximum clock rate and observe that the system can achieve rates of over a mb / s up to a distance of 10 - 20 km depending upon the sample size .",
    "furthermore , for @xmath289 a key rate of  100 kb / s is possible up to around 90 km .    .",
    "we have presented a composable security proof for high - dimensional tfqkd , valid against arbitrary attacks and including all finite - size effects .",
    "numerical simulations show that composably secure tfqkd protocols can indeed extract greater than 1 secret bit per detected photon resulting in key rates of over a mb / s at metropolitan distances and maximum range of well over 100 km for sufficiently large sample sizes .",
    "several avenues for further work remain .",
    "firstly , whilst the proof here has been for the case where alice and bob can directly make either spectral or temporal measurements , most concrete proposals for tfqkd involve time - to - frequency @xcite or frequency to time @xcite conversion .",
    "provided alice s devices are well characterised it should be straightforward to determine the appropriate uncertainty relation between these effectively conjugate measurements .",
    "secondly there is also a potential weakness to intercept - resend attacks which is particular to tfqkd protocols due to the combination of an in - principle unbounded measurement spectrum and coincidence post - selection as first pointed out in @xcite .",
    "essentially , the problem is that if eve makes an extremely precise non - destructive measurement of one observable , say arrival time , this will project onto a state that has limited support within the finite range of bob s frequency detectors .",
    "if alice and bob both chose to measure time then eve will learn this bit and if they both choose to measure frequency , with high probability bob s detectors will not register the photon and the round will be discarded , opening a loophole in the security . a counter - measure based upon a pre - measurement filtering",
    "was proposed in @xcite which would need to be rigorously incorporated into this proof @xcite . finally , a remaining unanswered question in all security proofs based upon an uncertainty relation is incorporating an imperfect knowledge of the measurements made by the trusted party . in practice",
    ", alice is not perfectly certain of the povms that describe her measurements .",
    "a possible solution might incorporate some amount of real time detector tomography into the security analysis .",
    "we note that the proof presented here could also be used to rigorously certify the randomness of measurement strings , extending the work of @xcite to explicitly include a failure probability .",
    "this is a particularly attractive possibility since a major strength of these proposals is the high number of bit / photon and hence large overall rates at short distances . _",
    "note added : _ during the writing up of this work the authors became aware of related results by niu et al .",
    "@xcite .",
    "nw would like to thank h.m .",
    "chrzanowski for many helpful discussions .",
    "the authors acknowledge funding support from the epsrc national quantum technology hub in networked quantum information technologies .",
    "j.n . was supported by a royal society fellowship ."
  ],
  "abstract_text": [
    "<S> we present a composable security proof , valid against arbitrary attacks and including finite - size effects , for a high dimensional time - frequency quantum key distribution ( tfqkd ) protocol based upon spectrally entangled photons . </S>",
    "<S> previous works have focused on tfqkd schemes as they combines the impressive loss tolerance of single - photon qkd with the large alphabets of continuous variable ( cv ) schemes , which enable the potential for more than one bit of secret key per transmission . </S>",
    "<S> however , the finite - size security of such schemes has only been proven under the assumption of collective gaussian attacks . here , by combining recent advances in entropic uncertainty relations for cvqkd with decoy state analysis </S>",
    "<S> , we derive a composable security proof that predicts key rates on the order of mbits / s over metropolitan distances ( 40 km or less ) and maximum transmission distances of up to 140 km . </S>"
  ]
}