{
  "article_text": [
    "until the early nineties , the formulation of a quantum - mechanical theoretical framework for the study of the physics of electric polarization in solids had remained a challenging problem .",
    "@xcite even the definition of the polarization itself as a bulk quantity , independent of surface termination , was the subject of heated debate .",
    "@xcite    this picture changed when king - smith and vanderbilt ( ks - v )  @xcite proposed a formulation ( the modern theory of polarization - mtp ) , which resolved the conceptual difficulties associated with the definition of this quantity for continuous , periodic , charge distributions . in their work",
    ", the electric polarization of an insulating crystal is related to a berry phase  @xcite computed from the valence wavefunctions .",
    "the existence of a band - structure berry phase had already been discussed by zak and coworkers ,  @xcite before its connection with the electronic polarization was established by ks - v . besides settling the important conceptual question related to the definition of polarization as a bulk quantity , the ks - v theory provided an entirely new framework for the computation of the polarization of a crystal maintained at vanishing homogeneous electric field . since its formulation , the theory has been examined in greater detail by ks - v  @xcite and by resta  @xcite , and extended to many - body systems by ortiz and martin  @xcite .",
    "the relation between polarization and the phases of the wavefunctions has also led to a reexamination of the role this quantity plays in the density functional theory ( dft )  @xcite formulation of the ground - state properties of extended systems .",
    "@xcite    of no less importance is the conceptual relationship between the spontaneous polarization and the centers of charge of the wannier functions ( wf ) of the occupied bands , which was also discussed by ks - v  @xcite and previously by zak .",
    "@xcite this connection was later generalized by nunes and vanderbilt  @xcite ( nv ) to deal with insulators placed in non - zero external homogeneous electric fields : they introduced field - dependent `` polarized '' wf s and a method for their computation .",
    "nv argued that , in the static - response regime , the state of an insulator under an external homogeneous electric field is one in which the periodicity of the charge density is retained , despite the fact that the perturbation lacks the lattice - translational symmetry of the unperturbed crystal .",
    "such state is actually a long - lived resonance of the system , as rigorously demonstrated by nenciu  @xcite .",
    "it is well known that within dft  @xcite , ground - state properties of condensed - matter systems , such as equilibrium lattice parameters , bond lengths and bond angles , among others , can be obtained with an accuracy of a few percent in comparison with experimental results . within dft  @xcite , the nv method has recently been applied to the computation of the polarized wf s and the dielectric constant of silicon and gallium arsenide  @xcite .",
    "the latter quantity is related to the change of polarization due to a change of homogeneous electric field , in the linear regime , or equivalently , to the second - derivative of the total energy with respect to the homogeneous electric field .",
    "specific treatments have been developed ( noticeably within dft ) for the study of the response of crystals to `` external '' perturbations , like phonons , stresses or homogeneous electric fields .",
    "the latter , on which we focus exclusively , can be taken as a homogeneous field or as the limit of long - wavelength perturbations .    in the so - called direct approach  @xcite ,",
    "supercell calculations are employed to study both the unperturbed and perturbed systems , with the response functions being obtained by numerical finite - difference analysis of the changes induced by a long - wavelength perturbation applied to elongated supercells .",
    "the non - linear response regime is directly accessible , although it must be disentangled from the linear response of the system .",
    "however , because of the use of supercells , the computational cost of this approach is rather high .",
    "alternatively , the specific response to a homogeneous electric field was considered within perturbation theory , already in the sixties . in the random - phase approximation",
    "@xcite ( no local - field effects  @xcite included ) , the response of the wavefunctions is obtained through a sum over states , involving matrix elements of the position operator between valence and conduction states  @xcite .",
    "this technique was generalized to the computation of second- and third - order susceptibilities  @xcite .",
    "the need to compute many unoccupied bands is the bottleneck of this method .",
    "local - field effects can be reintroduced on top of such a sum - over - states approach either in a matrix - inversion framework  @xcite , or in an iterative approach  @xcite . in their calculation of linear susceptibilities ,",
    "levine and allan included a so - called `` scissor - operator '' correction , that was understood later to compensate some deficiencies of local - density approximation computation of long - wavelength response functions  @xcite . also , levine and coworkers proposed rather involved expressions for the second - order and third - order dft susceptibilities  @xcite .    to a large extent , density functional perturbation theory ( dfpt )  @xcite overcome the limitations of the previously mentioned approaches , at the price of non - negligible additional coding .",
    "at the lowest order in the homogeneous - electric - field perturbation , this method was introduced by baroni and collaborators  @xcite .",
    "it is based on an iterative solution for the first - order change in the wavefunctions , which allows for the self - consistent inclusion of local - field effects , besides eliminating the cumbersome sum over conduction bands .",
    "it does not employ supercells , and can be applied to perturbations of arbitrary wavelengths . in the dfpt ,",
    "the computational workload involved in the computation of linear - response functions is of the same order of that involved in one ground - state calculation .",
    "dfpt is part of a class of formalisms in which perturbation theory is applied to a variational principle  @xcite .",
    "this interesting combination leads to a generic `` 2n+1 '' theorem  @xcite , as well as variational properties of even - order derivatives of the energy  @xcite .",
    "for example , one can compute the third - order derivative of the energy from the first - order derivative of wavefunctions , and the fourth - order derivative of the energy is variational with respect to the second - order derivative of wavefunctions .",
    "the expressions derived in this framework are surprisingly simple and can be formulated at all order of perturbations .",
    "however , the treatment of homogeneous electric fields in this variation - perturbation framework is plagued by difficulties similar to those encountered in the theory of polarization . shortly after the appearance of the mtp , dal corso and mauri  @xcite , building upon the nv work , proposed a very concise expression for the second - order susceptibility which was later applied successfully to compute this quantity for a variety of systems  @xcite .    in the present work ,",
    "we formulate a perturbation theory of the static response of insulating crystals to homogeneous electric fields that combines the conceptual ideas of the mtp with the variation - perturbation theory .",
    "a major achievement of our work is the presentation of formulas valid for unrestricted order of perturbation theory .",
    "we also examine the low - order expressions in some detail , and recover the expression proposed by dal corso and mauri  @xcite .",
    "the theory is worked out directly in reciprocal space , in terms of the berry phase associated with the occupied bands of the perturbed crystal , in the manner of the mtp .",
    "the conceptual issues involved in the definition of a perturbative approach for the problem are addressed .",
    "the berry phase is argued to remain a valid concept in the presence of the periodicity - breaking electric field .",
    "the periodicity of the charge density is assumed to survive the application of the field , and the berry phase is obtained from the associated polarized periodic wavefunctions . by working out the perturbative approach in terms of these polarized states , we obtain very compact expressions for the high - order dielectric - response functions of the crystal .",
    "these can be numerically obtained on the basis of iterative equations for the second- and higher - order terms in the perturbation expansion of the wavefunctions of the system , as in the dfpt approach for other types of perturbation .",
    "we will not deal explicitly with the exchange and correlation parts of the dft functional : the main difficulties that we want to address in this paper are not related to them .",
    "the formalism can be extended to include exchange and correlation terms in a self - consistent fashion , in the manner presented in refs  .",
    "any application of the mtp involves a discretization of the berry - phase expression , in terms of a series of wavevectors for the electronic wavefunctions .",
    "we have discovered that such a discretization , that appears naturally also in the present framework , can be performed at two different conceptual levels when merged with perturbation theory : either after the derivation of formal expressions at different orders of perturbation theory , starting from a continuous hamiltonian , or at the level of the field - dependent hamiltonian itself , before any perturbation expansion is performed .",
    "we will refer to the first approach as the discretization after perturbation expansion ( dape ) formulation , and to the second as the perturbation expansion after discretization ( pead ) formulation .    in order to judge the relative merits of these two approaches , and also the correctness of the global framework",
    ", we analyze the behavior of a model tight - binding hamiltonian , for which analytical responses to an electric - field perturbation have been obtained up to the fourth order .",
    "the paper is organized as follows . in the next section ,",
    "we address the conceptual issues associated with the definition of a hamiltonian and its perturbative expansion for the electric - field problem .",
    "[ sec : vpt ] summarizes the main results of the variational perturbation theory which are used in this work . in sec .",
    "[ sec : pt - cont ] , we work out the continuous formulation of the problem and its perturbation expansion , from which we obtain the dape version of our theory . in sec .",
    "[ sec : pt - p ] , we work from the start using a discretized expression for the polarization , which leads to the alternative pead formulation . the theory is applied to a model one - dimensional system in sec .",
    "[ sec:1d - model ] .",
    "in the mtp  @xcite , the change in electric polarization per unit volume induced by an adiabatic change in the crystalline potential ( the self - consistent kohn - sham potential in the context of dft ) is written @xmath2 with @xmath3 given in terms of a berry phase associated with the occupied bands of the system @xmath4 where @xmath5 is the electron charge , @xmath6 is a parameter representing the adiabatic change in the potential , and the factor of 2 in the numerator accounts for spin ( in this work we will consider only spin - unpolarized systems ) .    the gauge relation between periodic functions @xmath7 is established by requiring that the bloch eigenstates be periodic in reciprocal space , i.e. @xmath8 , where @xmath9 is a reciprocal - lattice vector .",
    "with this choice of gauge , the polarization changes given by eq .",
    "[ delta - p ] are defined to within a factor of @xmath10 , where @xmath11 is a lattice vector .",
    "@xcite eq .",
    "[ p - bphase ] was derived under the restriction that the macroscopic electric field inside the crystal vanishes .",
    "moreover , it also requires that the set of wavefunctions be differentiable with respect to * k*.  @xcite    the actual evaluation of the polarization in eq .",
    "[ p - bphase ] is carried out on a discrete mesh of points in reciprocal space . because this expression depends on the phase relationships of wavefunctions at different * k*-points ,",
    "the following discretized version was proposed by ks - v : @xmath12\\right\\}\\;;\\end{aligned}\\ ] ] where @xmath13 is the component of the polarization along the direction of a short reciprocal - lattice vector , @xmath14 , and @xmath15 is the number of * k*-points sampling the brillouin zone along that direction for each value of @xmath16 , with @xmath17 .    from a calculational point of view",
    ", this discretized expression ensures that the final result is unaffected by random numerical phases which may be introduced in the wave functions at different * k*-points , when these are independently determined by the diagonalization routine . however , resta has taken the view that the discretized expression is to be regarded as more fundamental than the continuous form .",
    "@xcite for the formulation of the electric - field response that we develop in the present work , discretization is crucial in order to define a numerically - stable minimization procedure .",
    "we will come back to this point in sec .",
    "[ cutoff ] .    the berry - phase expression can be transformed into a real - space integral involving the wannier functions of the occupied bands , leading to a physically - transparent expression for the polarization in terms of the centers - of - charge of the wannier functions :  @xcite @xmath18 where @xmath19 is the unit - cell volume .    in principle , the above expressions are valid only at vanishing electric field .",
    "however , it was soon realized  @xcite that eq .",
    "[ p - wannier ] could be extended to the non - zero field problem , by introducing the so - called polarized wannier functions .",
    "polarization effects were then related to the field - induced shifts in the wannier - function centers of charge . in the present work , eq .",
    "[ p - bphase ] is argued to apply to the non - zero - field problem , thus defining a field - dependent berry phase containing the polarization effects .",
    "this allows us to work out a perturbative approach for the finite - field problem .",
    "the study of the problem of insulators under an external electric field has traditionally met with conceptual difficulties , related to the non - analyticity of the perturbation , as discussed in detail by nenciu  @xcite . upon the application of the external field , the spectrum of electronic states changes non - analytically , with the band structure of the insulator at zero field being replaced by a continuum of eigenvalues spanning the entire energy axis ( from @xmath20 to @xmath21 ) , even for a field of infinitesimal strength . from a mathematical point of view , the unbound nature of the perturbation term , @xmath22 ( hereafter , we use @xmath23 for the magnitude of the electric field ) , hinders the straightforward application of perturbation theory , since the diagonal elements of the position operator in the basis of the unperturbed bloch states are ill - defined  @xcite . strictly speaking , an infinite crystal in the presence of an external electric field",
    "does not have a ground state  @xcite .    from the physical point of view , in the limit of weak to moderate fields , the tunneling currents ( which destroy the insulating state at sufficiently high fields ) can be neglected , and only the polarization of the electronic states by the external field is considered .",
    "one is left with a picture of the problem in which the insulating state of the unperturbed crystal is preserved , hence the band structure and the periodicity of the charge density are retained .",
    "the problem is thus physically well defined .",
    "the theory we develop below will concern this periodic polarized insulating state , resulting from the application of the electric field .",
    "avron and zak  @xcite have discussed the stability of the band structure in the present context , while , as mentioned in the introduction , nenciu  @xcite has rigorously shown such state to be a long - lived resonance of the problem , in the regime of weak fields .",
    "building on the conceptual framework set by the mtp , nv introduced a practical real - space method to handle the problem on the basis of the wf formulation of the polarization .",
    "they noted that this polarized insulating state can be represented in real space by a set of field - dependent polarized wf s . in this way ,",
    "the relationship between the wf s centers of charge and polarization can be extended to the non - zero field situation , and an energy functional is defined as follows @xmath24 = e^{(0)}\\left [ \\{w^{\\cal e}\\}\\right ] -\\omega\\,{\\bf { \\cal e } \\cdot}{\\bf p}\\left [ \\{w^{\\cal e}\\}\\right ] \\;,\\ ] ] where @xmath25 is the set of field - dependent wannier functions .    because the state underlying the above expression is not a ground - state , rather a resonance ,",
    "the energy functional is only well defined for wf s of finite range .",
    "@xcite the truncation of the wf s provides a mathematical procedure for the regularization of the problem .",
    "we will come back to this pathology in section  [ cutoff ]    as a corollary of the existence of polarized wf s , we consider now the representation of the system in terms of polarized bloch orbitals . in the following sections , we develop two alternative formulations in which the @xmath26-space mtp expressions for the electronic polarization , eqs .",
    "[ p - bphase ] and [ p - discr ] , are extended to the non - zero - field problem .",
    "we will also have to regularize the ensuing expressions , which is possible by means of discretization of the @xmath26-space integrals in such a way that polarized valence bands are stable against mixing with the conduction bands .    for simplicity , we concentrate on a one - dimensional non - interacting spin - unpolarized system .",
    "the hamiltonian for the unperturbed periodic insulator is given by @xmath27 where @xmath28 is the kinetic - energy operator , and @xmath29 is a periodic potential , i.e. , @xmath30 = 0 $ ] , where @xmath31 denotes a translation by a lattice vector .",
    "the zero - field function @xmath32 is the periodic part of the unperturbed bloch - orbital , obeying the eigenvalue equation @xmath33 , where @xmath34 is the unperturbed cell - periodic hamiltonian .    under the action of an external electric field ,",
    "the hamiltonian becomes @xmath35 as discussed above , this hamiltonian is not amenable to a conventional perturbation treatment .",
    "we can arrive at an expression that is applicable to extended periodic systems , from the following considerations .",
    "first , let us assume that we can define a set of field - dependent cell - periodic functions , representing the polarized state of the system .",
    "these are the fourier transform of the field - dependent wannier functions introduced by nv . eq .",
    "[ p - bphase ] is thus extended to the non - zero field problem , with @xmath36 defining a field - dependent polarization , including the spontaneous and induced parts of this quantity .",
    "next , combining this definition with eq .",
    "[ e - nv ] we write @xmath37\\;,\\end{aligned}\\ ] ] for the total energy in terms of field - dependent cell - periodic functions , with the unit - cell volume @xmath38 for our 1d system .",
    "consider now the expansion of the set @xmath39 in terms of the complete set of zero - field periodic functions : @xmath40 in terms of this expansion , eq .",
    "[ e - def ] is written @xmath41\\;.\\end{aligned}\\ ] ]",
    "this expression is in the form of the matrix representation , in the basis @xmath42 , of the expectation value of the following `` operator '' : @xmath43 this suggests eq .",
    "[ h - ansatz ] as an _ ansatz _ for the cell - periodic hamiltonian , now including the perturbation term @xmath44 .    in subsection  [ subsec :",
    "position ] , we show that the perturbation hamiltonian operator given in eq .",
    "[ e - def - expand ] by its matrix representation , @xmath45 is the _ periodic _ part of the @xmath46 operator .",
    "another way of arriving at this ansatz is by the following argument .",
    "consider the first - order change in the total energy which can be obtained , without postulating the existence of the field - dependent functions , by combining eqs .",
    "[ p - bphase ] and [ e - nv ] , as follows : @xmath47 this is simply the coupling of the spontaneous polarization of the system to the external field . from textbook perturbation theory ,",
    "the first order change in the energy is given by the diagonal matrix elements of the perturbation term , leading again to the form of the hamiltonian in eq .",
    "[ h - ansatz ] .",
    "some remarks are needed about the application of perturbation theory to this hamiltonian .",
    "strictly speaking , @xmath48 is not an operator ( its transformation properties under unitary transformations will be discussed in subsection  [ subsec : position ] ) .",
    "however , it can be shown  @xcite that this is reflected only in the first - order change of the single - particle eigenvalues , when we analyze single - particle quantities obtained in the perturbation expansion of eq .",
    "[ h - ansatz ] .",
    "all other single - particle quantities , such as wave - function derivatives and higher - order eigenvalue derivatives are actually gauge - invariant , and thus well defined .",
    "more importantly , in the following developments we will be interested only in quantities that are _ integrated _ over the brillouin zone ( the derivatives of the total - energy with respect to the applied field ) , which will be shown to be gauge invariant . as a final observation",
    ", it can also be shown  @xcite that under unitary transformations , the first - order eigenvalue acquires a change which , when integrated over the brillouin zone , leads to a first - order energy derivative which is defined modulo the quantity @xmath49 , where @xmath50 is a lattice vector ( @xmath51 is an integer ) .",
    "this is consistent with the fact that , in the mtp , the zero - field polarization itself is defined modulo @xmath52 .    the continuous formulation of our theory is based on the application of a variational perturbation treatment to eqs .",
    "[ e - def ] and [ h - ansatz ] .",
    "alternatively , the pead formulation is derived by applying the variational principle to the total energy written in terms of the discretized form of the polarization . in this case , we combine eqs .",
    "[ p - discr ] and [ e - nv ] to write @xmath53 = \\frac{2}{n_k } \\left\\{\\sum_{n=1}^n \\sum_{j=1}^{n_k } \\left\\langle u_{nk_j }   \\left| h^{(0)}_{k_j } \\right| u_{nk_j } \\right\\rangle   - \\frac{e{\\cal e}}{\\delta k } \\sum_{j=1}^{n_k } { \\rm i m } \\left\\ { \\ln \\det \\left [ s_{mn}(k_j , k_{j+1 } ) \\right ] \\right\\}\\right\\}\\;,\\end{aligned}\\ ] ] where @xmath54 runs over the @xmath15 @xmath26-vectors in the discretized brillouin zone , @xmath55 , and @xmath56 is the overlap matrix between states at adjacent points in the reciprocal - space mesh .",
    "in view of the above discussion , we examine now the action of the position operator in a space of periodic functions . keeping in mind",
    "that we wish to retain the periodicity of the charge density , we seek to arrive at a consistent definition for the action of @xmath57 in that space . this problem has been recently tackled by resta  @xcite , who suggested an intrinsically many - body redefinition of @xmath57 , in the context of periodic systems . in the spirit of retaining a single - particle picture , here",
    "we only offer a heuristic justification for the form of the perturbation term given in eq .",
    "[ h - ansatz ] . for this",
    ", we use the crystal momentum representation ( cmr ) , following the discussion in the paper by blount .",
    "@xcite    let @xmath58 denote a square - integrable function .",
    "the full set of zero - field bloch eigenstates of a periodic hamiltonian forms a complete basis to expand @xmath58 : @xmath59 the action of @xmath57 on @xmath58 is given in the cmr by the expression @xmath60\\;.\\ ] ] where @xmath61 is defined in eq .",
    "[ u - matrix ] .",
    "blount examined the transformation properties of the two terms appearing in eq .",
    "[ x_op ] , with respect to the choice of the phases of the bloch orbitals .",
    "consider the following cmr decomposition of @xmath57 : @xmath62 where @xmath63 is diagonal in the band index .",
    "he showed that when the bloch orbitals are multiplied by a phase factor @xmath64 , the term @xmath65 transforms as @xmath66 , while a compensatory change occurs in the diagonal term @xmath67 .",
    "so , the two terms in eq .  [ xdecomp ] do not transform separately like operators , while their sum does . in our formulation",
    ", we use the second term on the right , @xmath68 , to define a periodic hamiltonian for the electric - field problem which , from this discussion , is not by itself an operator in the strict sense .",
    "we show now that @xmath69 is translationally invariant , while @xmath65 ( like @xmath0 ) is not .",
    "consider a translation @xmath31 by a lattice vector @xmath70 .",
    "the commutation relation for @xmath57 and @xmath31 is written .",
    "@xmath71 = \\ell t_\\ell\\;.\\ ] ] to obtain the commutation relation of the perturbation term in eq .",
    "[ h - ansatz ] , we expand eq .",
    "( [ xcommut ] ) in the cmr representation .",
    "let @xmath72 . from eq .",
    "( [ fx ] ) and @xmath73 we get @xmath74 from this expression , it follows that @xmath75 further , from eq .",
    "( [ x_op ] ) we obtain @xmath76\\;;\\ ] ] while from eqs .",
    "( [ x_op ] )  and  ( [ gk ] ) we get @xmath77\\ ; \\nonumber\\\\ & = & \\frac{1}{2\\pi } \\int dk\\,e^{i k(x-\\ell ) } \\sum_n u_{nk}^{(0)}(x ) \\left [ \\ell f_n(k ) + i\\frac{\\partial f_n(k)}{\\partial k } + \\sum_{n^\\prime } { \\cal u}_{n n^\\prime}(k ) f_{n^\\prime}(k ) \\right]\\;;\\end{aligned}\\ ] ] where , in the last step , we use the result @xmath78 $ ] . combining eqs .",
    "( [ tlxf ] )  and  ( [ xtlf ] ) we arrive at the cmr expansion of the commutation relation in eq .",
    "( [ xcommut ] ) . moreover , the above development immediately shows that @xmath79 = \\ell",
    "t_\\ell \\nonumber \\\\   & \\left [ { \\cal u}_{n n^\\prime}(k),t_\\ell \\right ] = 0\\,.\\end{aligned}\\ ] ] from the above , we observe that the perturbation term in eq .",
    "[ h - ansatz ] is invariant under lattice translations .      the definition of an energy functional at finite fields requires careful analysis .",
    "because the problem does not have a ground state , a regularization procedure is required for the definition of a numerically - stable functional capturing the physics of the state of the system after the electric field is turned on .    in the nv treatment of the problem in real - space ,",
    "regularization is achieved with the introduction of truncated wannier functions , which are constrained to zero beyond a real - space cutoff @xmath80 .",
    "@xcite as discussed by nv , in the limit @xmath81 the functional becomes pathological , with the property that a state having an arbitrary value for the polarization can be constructed without changing the value of the energy , when working at fixed polarization , or conversely with the development of a growing ( infinitely many in the @xmath81 limit ) false local minima when working at fixed electric field .    in order to develop this analysis on a sound mathematical basis , one performs a legendre transformation  @xcite , from the @xmath82-dependent total energy",
    "@xmath83 $ ] to the @xmath84-dependent electric enthalpy @xmath85 $ ] : @xmath86= \\inf_{\\cal e } \\left\\ { e[{\\cal e } ] + a p { \\cal e } \\right\\}.\\ ] ] the total energy was obtained previously [ see eq.(5 ) ] thanks to the trial wannier functions , @xmath87 = \\inf_{\\{w\\ } } \\left\\ { e[\\{w\\};{\\cal e } ] \\right\\ }              = \\inf_{\\{w\\ } } \\left\\ { e^{(0)}[\\{w\\ } ] - a { \\cal e }   p[\\{w\\ } ] \\right\\},\\ ] ] while a constrained search alternatively gives its legendre transform , @xmath86 = \\inf_{\\{w\\ } { \\rm such \\ , that } p[\\{w\\}]=p } \\left\\ { e^{(0)}[\\{w\\ } ] \\right\\}.\\ ] ] the zero - electric field total energy functional of the wannier functions is @xmath88 = \\sum_i \\left\\langle w_i \\left| h^{(0 ) } \\right| w_i \\right\\rangle$ ] .",
    "we aim at understanding the pathologies of @xmath83 $ ] by examining its expression as the inverse legendre transform of @xmath85 $ ] , @xmath87= \\inf_p \\left\\ { \\tilde e[p ] - a p { \\cal e } \\right\\},\\ ] ] for which we need to characterize the minima of @xmath85 $ ] , as well as their local behavior .",
    "we consider , for simplicity , the case of a single occupied band . for a given finite value of @xmath80 ,",
    "the electric enthalpy is a periodic function of @xmath84 , and @xmath89 = e^{(0)}[\\{w_0\\ } ] = e_0 $ ] is the zero - field ground - state energy ( @xmath90 is the zero - field valence - band wannier function ) . for large values of @xmath80",
    ", it becomes possible to build a set of @xmath70-dependent functions ( to be normalized ) , @xmath91 with arbitrary value of @xmath84 , where @xmath90 is a zero - field valence - band wannier function centered at the origin , and @xmath92 is an empty conduction - band function centered at the site @xmath70 within the range of @xmath80 , whose coefficient is on the order of @xmath93 .",
    "we consider the lattice constant @xmath94 to be the unit of length .",
    "the energy for these states is @xmath95 where @xmath96 is the expectation value of the energy for the conduction band wannier function .",
    "due to the exponential decay of wannier functions for insulators , the value of the polarization is @xmath97 since @xmath98 . in the limit @xmath99 , these wavefunctions have an arbitrary value of @xmath84 , and an energy infinitesimally close to @xmath100 .",
    "the @xmath85 $ ] curve becomes flat in this limit , and only derivatives in an infinitesimal region around the ground - state solution remain well defined .",
    "the development of multiple minima at finite fields corresponds to the same situation , as a growing number of minima with energies that become degenerate in the @xmath81 are associated to states with different values of polarization .",
    "no global minimum as a function of polarization can be found . in the next subsection",
    ", we analyze the behavior of the energy functional for a model system in reciprocal space .",
    "we will show that the same pathology manifests itself in the limit @xmath101 , where @xmath102 is the discretization of the mesh of @xmath26-points in the brillouin zone .      for the present analysis , as well as for the application of the perturbation expansions to be developed in the following sections",
    ", we chose a one - dimensional ( 1d ) two - site periodic model defined by two parameters , the hoping integral @xmath103 , and the on - site term which we choose as @xmath104 and @xmath105 , for sites @xmath106 and @xmath107 , respectively .",
    "the hamiltonian can be rescaled by @xmath108 to become a one - parameter ( @xmath109 ) model , defined as @xmath110\\right\\}\\;,\\end{aligned}\\ ] ] where @xmath111 runs over unit cells .",
    "whenever we are concerned with the 1d model , we will consider all distances to be rescaled by the unit - cell period ( i.e. we set @xmath112 in the present section , in sec .",
    "[ sec:1d - model ] , and in appendix  [ app:1dmodel ] ) , such that on each cell , denoted by the integer @xmath111 , we have the basis functions @xmath113 and @xmath114 .",
    "we apply bloch s theorem to write the schrdinger equation for the cell - periodic functions : @xmath115 where @xmath116 is the zero - field cell - periodic hamiltonian . in the basis of periodic functions @xmath117 and",
    "@xmath118 we have @xmath119 2t\\cos\\frac{k}{2 } & \\frac{1}{2}%   \\end{array }   \\right ) \\;.\\end{aligned}\\ ] ] the corresponding secular equation , @xmath120 = 0 $ ] , is easily solved for the eigenvalues @xmath121^{1 \\over 2 } = { \\huge \\vphantom{a}^+_-}\\frac{1}{2}\\left [ 1 +   a^2\\cos^2{k \\over 2 } \\right]^{1 \\over 2},\\end{aligned}\\ ] ] where @xmath122 .",
    "negative and positive eigenvalues correspond to valence and conduction bands , respectively .",
    "because the hamiltonian is real , we can use the following parameterization for the corresponding eigenstates @xmath123   \\sin\\theta_k   \\end{array }   \\right ) { \\rm e}^{i\\alpha_{vk } } \\nonumber\\\\ \\left.\\left| u_{ck}^{(0 ) } \\right .",
    "\\right\\rangle & = & \\left (   \\begin{array}{c } \\displaystyle   ~\\sin\\theta_k \\\\[0.05 in ]   \\!\\!-\\cos\\theta_k   \\end{array }   \\right ) { \\rm e}^{i\\alpha_{ck}}\\;,\\end{aligned}\\ ] ] where @xmath124 and @xmath125 are real numbers , with no lack of generality . coming back to the eigenvalue equation @xmath126 , we obtain @xmath127 integrating eq .",
    "[ 1d - eigval ] over the brillouin zone gives the energy per unit cell : @xmath128^\\frac{1}{2}\\;.\\end{aligned}\\ ] ] in order to discuss the pathology of the finite electric - field functional in @xmath26-space , we consider a set of trial cell - periodic functions @xmath129",
    "\\sin\\theta_k~\\!e^{i\\beta_k } \\end{array } \\right)\\;\\end{aligned}\\ ] ] for @xmath130 $ ] , where @xmath131 , @xmath132 , and @xmath133 are real numbers . imposing the condition @xmath134 ,  @xcite we obtain @xmath135 which leads to @xmath136 and @xmath137 .",
    "the expectation value of the zero - field hamiltonian in the set of trial wave - functions gives @xmath138 = \\frac{1}{\\pi}\\int_0^{2\\pi } dk   ~\\!\\left\\langle u_k \\left| h_k^{(0 ) }   \\right| u_k \\right\\rangle   = \\frac{1}{\\pi}\\int_0^{2\\pi } dk \\left [ -\\frac{1}{2 } \\cos\\left(2\\theta_k\\right ) + 2 t \\cos\\left(\\frac{k}{2}\\right)\\sin\\left(2\\theta_k\\right ) \\cos\\gamma_k\\right]\\;,\\end{aligned}\\ ] ] where @xmath139 .",
    "the polarization for the trial state is @xmath140 =   \\frac{ie}{\\pi}\\int_0^{2\\pi } dk ~\\!\\left\\langle u_k   \\left| \\frac{\\partial}{\\partial k } \\right| u_k \\right\\rangle = -\\frac{e}{2\\pi}\\left\\ { \\left[\\vphantom{\\sum_a^b}\\alpha_k + \\beta_k\\right]_0^{2\\pi } + \\int_0^{2\\pi } dk~\\ !",
    "\\cos\\left(2\\theta_k\\right ) \\frac{\\partial\\gamma_k}{\\partial k}\\right\\}\\;.\\end{aligned}\\ ] ] minimization of @xmath141 $ ] with respect to @xmath131 and @xmath142 , by setting @xmath143 and @xmath144 , with @xmath145 , leads to @xmath146   { \\rm or } \\\\[0.02 in ] 2t\\cos\\left(\\frac{k}{2}\\right)\\sin \\left ( 2\\theta_k \\right ) = 0 \\;. \\end{array }    \\right . \\end{aligned}\\ ] ] at @xmath147 , the solution of eqs .",
    "[ min1 ] and [ min2 ] leads to @xmath148 and also implies that @xmath142 is _",
    "undefined_. at @xmath149 , a minimum solution is obtained by setting @xmath150   { \\rm and } \\\\[0.02 in ] \\tan ( 2\\theta_k ) = - 4 t \\cos\\left(\\frac{k}{2}\\right)\\;. \\end{array }    \\right . \\end{aligned}\\",
    "] ] the ground - state solution is given by @xmath151 ( i.e. , @xmath152 as in eq .",
    "[ 1d - eigstate ] ) for all values of @xmath26 , with @xmath131 defined by eq .",
    "note that a solution where @xmath142 jumps by a multiple of @xmath153 at @xmath154 is also consistent with eqs .",
    "[ min1]-[min3 ] , but not with the restriction that @xmath155 be differentiable with respect to @xmath26 .",
    "note also that , due to inversion symmetry , the zero - field ground - state polarization must vanish ( modulo @xmath5 ) .",
    "this is what is obtained from eq .",
    "[ puk ] , by setting @xmath156 , @xmath152 , and @xmath136 .",
    "we consider now a trial wavefunction where @xmath131 is the same as in the ground - state solution , while @xmath142 behaves as shown in fig .",
    "[ gamma - k ] , where it jumps by a value of @xmath153 over an interval @xmath102 centered at an arbitrary value of @xmath26 .",
    "we show now that in the @xmath101 limit this function can be tailored to give an arbitrary value of the polarization , while its energy differs from the ground - state by an infinitesimal amount , of order @xmath102 .    the change in polarization for this state , with respect to the ground - state solution , is given by @xmath157 @xmath158 in the above equation assumes values between @xmath5 and @xmath159 . by adding another kink in the definition of @xmath142 , where this function changes by @xmath160",
    ", we can build a solution having any arbitrary value of @xmath84 in the interval @xmath161 $ ] .",
    "let us consider the change in energy of the trial state .",
    "the function @xmath162 , as shown in fig .",
    "[ cos - gamma ] , differs from one over a small interval of the order of @xmath102 .",
    "the change in energy with respect to the ground state is then @xmath163 so , for the trial state @xmath164 when @xmath165 .",
    "the @xmath166 curve becomes flat in this limit .",
    "this is the same pathology as the one discussed by nv in the real - space case .",
    "discretization of the @xmath26-space mesh in the brillouin zone is thus essential for the numerical stability of the energy functional .",
    "now , we show that for the discretized version of the formulation , a change in @xmath84 implies a finite change in the energy .",
    "the discretized polarization is written @xmath167 & = & \\frac{e}{\\pi}\\sum_{k=1}^{n_k } { \\rm i m } \\left [ \\ln   \\left.\\left\\langle u_{k_j } \\right| u_{k_{j+1}}\\right\\rangle\\right ] \\nonumber\\\\ & = & \\frac{e}{\\pi}\\left\\{\\delta n_\\beta + { \\rm i m } \\sum_{k=1}^{n_k }   \\ln \\left [ \\cos\\theta_{k_j}\\cos\\theta_{k_{j+1 } }   e^{i\\left(\\gamma_{k_{j+1 } } -\\gamma_{k_j}\\right ) } + \\sin\\theta_{k_j}\\sin\\theta_{k_{j+1}}\\right]\\right\\}\\;;\\end{aligned}\\ ] ] with the energy given by @xmath168   =   \\frac{2}{n_k } \\sum_{j=1}^{n_k } \\left\\langle u_{k_j } \\left| h_{k_j}^{(0)}\\right| u_{k_{j+1}}\\right\\rangle   = \\frac{2}{n_k } \\sum_{j=1}^{n_k}\\left [ -\\frac{1}{2 } \\cos",
    "\\left(2\\theta_{k_j}\\right ) + 2t\\cos\\left(\\frac{k_j}{2}\\right)\\sin \\left(2\\theta_{k_j}\\right ) \\cos\\gamma_{k_j}\\right]\\;.\\end{aligned}\\ ] ] again we consider the ground - state solution @xmath169 , with @xmath170 given by eq .",
    "an arbitrary change in polarization can be introduced by setting @xmath171 at a given @xmath172 , while keeping the values of @xmath173 and @xmath174 at all the other @xmath26-points unchanged . in this case",
    ", it can be immediately seen that a _ finite _",
    "change @xmath175 is introduced in the discretized energy .",
    "the theoretical treatment of a periodic insulator placed in an homogeneous electric field is plagued by severe conceptual difficulties : ( 1 ) the potential associated with an electric field is non - periodic and unbounded ; ( 2 ) for that reason the spectrum of electronic states changes non - analytically upon the application of a homogeneous electric field ; ( 3 ) the quantity conjugated to the electric field , namely the polarization , can not be computed as the expectation value of the position ( or any other ) operator ; ( 4 ) local minima of the energy functional can be defined only in an infinitesimally small region as a function of the polarization , the energy functional being perfectly flat otherwise .    in order to address problems 1 and 2 ,",
    "following nenciu , we restrict ourselves to periodic - polarized - insulating states , of which the lowest in energy is a long - lived resonance of the unrestricted system . keeping this restriction in mind , we show that the position operator can be decomposed , in the crystal momentum representation , into a non - periodic part and a periodic part .",
    "the latter can be introduced in an ansatz hamiltonian acting on the periodic part of the bloch functions , from which the berry phase formulation of the polarization is recovered , solving problem 3 as well .",
    "we are aware that this line of thought does not yet justify rigorously the use of this hamiltonian : a more careful derivation , in the spirit of the mathematical work of nenciu , would be needed . however , this rather simple hamiltonian allows to recover all the previously known lowest - order expressions for the polarization and its derivatives , and to derive other low - order expressions as well as generic expressions to all orders , as we shall see in the coming sections .",
    "problem 4 is solved by introducing a regularization procedure in reciprocal space , similar in spirit to the real - space cutoff radius introduced by nv . for the regularized energy functional ,",
    "the local minima have a finite basin of attraction as a function of the polarization .",
    "in view of the application of perturbation theory to eq .  [ e - def ] , we summarize now the variational formulation of dfpt , as presented in ref .  .",
    "we consider the formalism at its non - self - consistent level , without including the hartree and exchange - correlation terms of the perturbative expressions .",
    "one considers a perturbative expansion of a variational principle applied to the electronic total - energy functional . in terms of the small parameter @xmath6 associated with the perturbation ,",
    "the perturbation series reads @xmath176 for a generic observable @xmath177 .",
    "the system hamiltonian is @xmath178 , and the total - energy functional is @xmath179 where @xmath28 and @xmath180 are the kinetic - energy and external - potential operators .",
    "the total - energy functional is to be minimized under the orthonormality constraints for the occupied wavefunctions @xmath181 using the lagrange - multiplier method , the functional @xmath182\\end{aligned}\\ ] ] is minimized with respect to the wavefunctions .",
    "the minimum condition , @xmath183 , leads to the euler - lagrange equation @xmath184 eq .",
    "[ el ] represents a set of generalized eigenvalue equations which assume the form of the usual eigenvalue equations when the so - called diagonal gauge is chosen to fix the phase arbitrariness of the wavefunctions .",
    "@xcite here , we keep the generalized form , as needed for the choice of gauge to be used in our theory .",
    "an expression for the lagrange - multiplier matrix is obtained by multiplying eq .",
    "[ el ] by an occupied wavefunction , leading to    @xmath185    we consider now the perturbation expansion of eqs .  [ ortho]-[lm ] .",
    "the orthonormalization condition becomes @xmath186 the expansion of eq .",
    "[ el ] gives the generalized sternheimer equation @xmath187 where @xmath188 is the @xmath189-order term in the expansion of the hamiltonian .",
    "the expansion of the lagrange - multiplier matrix is given by @xmath190    finally , a generic term in the perturbative expansion of the total - energy functional in eq .",
    "[ f - ener ] is written @xmath191 where @xmath192 or @xmath193 .",
    "we remark that only wavefunctions derivatives up to order @xmath194 appear in the @xmath195th - order term of the energy , as a result of the @xmath196-theorem .",
    "moreover , a minimum principle holds for @xmath197 with respect to the @xmath54th - order variations of the wave functions , i.e. , @xmath198 .    a particularly useful result derived in ref .",
    "is a set of non - variational expressions for the second - order derivative of the energy . in the present work ,",
    "the hamiltonian is of first - order in the perturbation ( @xmath199 ) , in which case the non - variational expressions are given by @xmath200 the zeroth - order wave functions are chosen to obey the unperturbed eigenvalue equation @xmath201 . from eq .",
    "[ lm - pert ] , the zeroth - order lagrange - multiplier matrix is given by @xmath202 in the present work , we use the so - called `` parallel - transport '' gauge , as discussed in ref .  .",
    "in this gauge , the following condition is imposed on the derivatives of the wave functions @xmath203 which allows us to rewrite the expansion of the orthonormalization condition as @xmath204 ~\\;~0 & { \\rm for } & i = 1\\;. \\end{array } \\right.\\end{aligned}\\ ] ]",
    "following the discussion in sec .  [",
    "sec : efp ] , we can develop a perturbation expansion for the electric - field problem . in this section",
    ", we discuss the continuous form of the theory .",
    "the cell - periodic hamiltonian , including the perturbation term , is given in eq .",
    "[ h - ansatz ] .",
    "we apply the machinery of the variational dfpt to this hamiltonian , by postulating that the expression @xmath205 = { a \\over \\pi } \\int_0^{\\frac{2\\pi}{a}}dk \\left [ \\sum_{n=1}^n \\left\\langle u_{nk }   \\left| h_k^{(0 ) } + i e { \\cal e } \\frac{\\partial}{\\partial k } \\right| u_{nk}\\right\\rangle \\right]\\;\\end{aligned}\\ ] ] is to be minimized with respect to the @xmath206 , under the constraints @xmath207 a local minimum will exist for the functional in eq .",
    "[ e0 ] provided that a discretization of the @xmath26-space integrals is performed .",
    "the continuum formulation which is considered in this section is valid only at infinitesimal fields .    applying eq .",
    "[ f - ener ] , we write @xmath208 = { a \\over \\pi } \\int_0^{\\frac{2\\pi}{a}}dk \\left [ \\sum_{n=1}^n \\left\\langle u_{nk }   \\left| h_k^{(0 ) } + i e { \\cal e } \\frac{\\partial}{\\partial k } \\right| u_{nk}\\right\\rangle - \\sum_{m , n=1}^n \\left\\ { \\left.\\left\\langle u_{nk } \\right| u_{mk}\\right\\rangle   - \\delta_{nm}\\right\\ } \\lambda_{mn}(k ) \\right]\\;.\\ ] ] the unconstrained minimization of this functional is obtained by setting @xmath209/\\delta u_{nk}$ ] = 0 , leading to the corresponding euler - lagrange equation @xmath210    next , we consider separately the perturbation expansions of eqs .",
    "[ e1 ] and [ stern0 ] . in both cases",
    ", we will demonstrate explicitly that the general expansion term transforms properly under a general unitary transformation of the occupied orbitals .      in the present case , eq .",
    "[ ortho - pert1 ] for the orthonormalization constraints reads @xmath211 \\;\\;\\;0\\ ; ,         & i = 1\\ ; ; \\end{array }   \\right.\\end{aligned}\\ ] ] giving the occupied - subspace projection of @xmath212 in terms of the lower - order solutions for the periodic functions .",
    "since @xmath213 for all @xmath214 , and @xmath215 , the expansion of the lagrange multipliers becomes @xmath216    in the following development , we will make explicit use of the expressions for @xmath217 , @xmath218 , and @xmath219 . from eq .",
    "[ lambda0 ] , @xmath220 . since @xmath221 from eq .",
    "[ u - ortho ] , and @xmath222 , @xmath218 is given by @xmath223 the second - order term reads @xmath224      the perturbation expansion for the energy is obtained from eq .",
    "[ e - pert ] .",
    "we analyze even and odd terms separately . for the even - order terms we write @xmath225 \\;,\\end{aligned}\\ ] ] while the odd terms are given by @xmath226 \\;.\\ ] ] an important aspect concerns the invariance of these expressions with respect to the choice of phases of the bloch orbitals .",
    "more generally , we must consider unitary transformations that keep the subspace of occupied states invariant .",
    "we show in appendix  [ app : gauge ] that eqs .",
    "[ e - even ] and [ e - odd ] can be rewritten in such a way as to display the required gauge - invariance property explicitly .",
    "the lower - order derivatives are usually of more practical interest , and for that reason the invariant form of the energy terms up to fourth order are written explicitly here , along with the general expansion term .",
    "the second - order energy derivative is obtained by setting @xmath227 in eq .",
    "[ e - even ] .",
    "after some manipulation , this quantity can be written in the following form : @xmath228\\ , .",
    "\\end{aligned}\\ ] ] as expected , our formula for @xmath229 is identical to the linear - response expression .  @xcite    the non - variational expression for @xmath229 ( see eq .  [ e2-nv ] )",
    "is given by @xmath230 the fourth - order energy term is written @xmath231 \\,.\\end{aligned}\\ ] ] it is worth pointing out the simplicity of the expression for @xmath232 , which mirrors that of @xmath229 almost exactly .",
    "the general even - order energy term for @xmath233 is written @xmath234 \\right\\}\\,.\\nonumber\\\\\\end{aligned}\\ ] ] in the above and the following expressions , we use the notation @xmath235 to indicate that @xmath1 acts only on the quantities embraced in parenthesis . in order to demonstrate",
    "that the energy derivatives fulfill the gauge - invariance requirement , we consider a general gauge transformation  @xcite among the occupied states at each k - point : @xmath236 where @xmath237 is an unitary transformation , i.e. , @xmath238 .",
    "it follows immediately that @xmath239 since @xmath240 acts only on gauge - invariant quantities , eqs .",
    "[ e2-invar]-[e - even - invar ] are themselves gauge - invariant .",
    "the same argument holds for the odd - order derivatives we derive below .    turning now to the odd - order derivatives of the energy , we set @xmath227 in eq .",
    "[ e - odd ] to write the third - order term as @xmath241 this expression for @xmath242 is identical to the one previously derived by dal corso and mauri .",
    "@xcite    the general odd - order term for @xmath243 is written @xmath244 \\right\\}\\,.\\end{aligned}\\ ] ] in appendix  [ app : gauge ] , we demonstrate how eqs .",
    "[ e2-invar]-[e - even - invar ] , [ e3-invar ] , and [ e - odd - invar ] are obtained from eqs .",
    "[ e - even ] and [ e - odd ] .",
    "the projection of the wave functions on the subspace of occupied unperturbed states is given by eq .",
    "[ u - ortho ] .",
    "the projection onto the subspace of unoccupied states is given by the projection of the sternheimer equation in that subspace .",
    "the perturbation series for the sternheimer equation can be obtained either by expanding eq .",
    "[ stern0 ] , or more directly from eq .  [ e - even ] above , by setting @xmath245 . the general expansion term is written @xmath246 where @xmath247 is the projector onto the subspace of unoccupied unperturbed states .",
    "this equation can be solved for @xmath212 , once the lower - order derivatives of @xmath248 and @xmath249 have been obtained .    using the invariant form for the even terms of the energy , eqs .",
    "[ e2-invar]-[e - even - invar ] , we set @xmath250 to obtain the explicitly invariant form of the sternheimer equation . for the @xmath227 and @xmath251 terms",
    "we obtain @xmath252 for the complete specification of @xmath253 and @xmath254 , the projections onto the unperturbed occupied subspace are obtained from eq .",
    "[ u - ortho ] : @xmath255 where @xmath256 is the projection operator for the occupied states .",
    "the higher - order terms for the sternheimer equation are given by @xmath257\\;\\;\\;,\\;\\;\\;i>2.\\end{aligned}\\ ] ] the valence - band component of @xmath258 is given by @xmath259 as in the case of the energy terms , in eqs .",
    "[ stern1-invar ] , [ stern2-invar ] , and [ stern - invar ] the derivative @xmath260 acts only on gauge - invariant quantities .",
    "this completes our development of the perturbation expansion , and the proof of gauge invariance of the continuous formulation .",
    "we examine now the discretized form of the lower - order terms for the energy and the sternheimer equation .",
    "in practical calculations , it is mandatory to use a discrete set of @xmath26-points to evaluate the brillouin - zone integrals .",
    "however , when the focus is on @xmath229 , the discretization of the @xmath240 operation can be avoided , as the projection on the conduction bands of the derivative of the wavefunctions versus @xmath26 can be computed from a sternheimer equation  @xcite .",
    "this has the disadvantage to add a significant coding and computational step in the whole procedure .",
    "we choose the following symmetric finite - difference expansion for the derivatives with respect to @xmath26 : @xmath261 where @xmath262 .",
    "clearly , this expression retains the gauge invariance of the continuous form .",
    "next , eq .  [ k - discr ] is used in the derivation of explicit discretized expressions for the energy derivatives up to the fourth - order , and for the sternheimer equation up to the second order .      from eqs .",
    "[ e2-invar ] and [ k - discr ] we obtain the discretized formula for @xmath229 : @xmath263\\right\\ } \\;.\\end{aligned}\\ ] ] the non - variational expression for @xmath229 is written @xmath264\\;.\\end{aligned}\\ ] ] the discretized versions of eqs .",
    "[ e3-invar ] and [ e4-invar ] are @xmath265 \\vphantom{\\sum_n^n}\\right\\ } \\;.\\end{aligned}\\ ] ]      the discretized expressions for the @xmath227 and @xmath251 terms of the sternheimer equation are given by @xmath266 the required gauge invariance of the expansion terms is preserved in the discretized expressions .",
    "note that the solutions at a given k - point are now coupled to the first - neighbor k - points in the reciprocal - space grid .",
    "let us consider now the perturbation treatment of the problem on the basis of the energy functional given in eq .",
    "[ e - def - p ] , where the polarization is written in a discretized form .",
    "this formulation can be viewed as the reciprocal - space analog of the nv  @xcite real - space functional . in this approach the gauge - invariance of the energy",
    "is guaranteed by the fact that eq .",
    "[ p - discr ] is itself gauge invariant .",
    "@xcite    we seek a minimum for eq .  [ e - def - p ] with respect to the occupied orbitals @xmath267 , under the constraints @xmath268 .",
    "lagrange multipliers are introduced to write the unconstrained functional @xmath269   & = & \\frac{2}{n_k } \\sum_{j=1}^{n_k } \\left [ \\sum_{n , m=1}^n    \\left\\langle u_{mk_j } \\left| h^{(0)}_{k_j } \\right| u_{nk_j }   \\right\\rangle~\\delta_{mn } - \\left ( \\left\\langle u_{nk_j }   \\left| u_{mk_j}\\right\\rangle\\right",
    ".   - \\delta_{mn } \\right)\\lambda_{mn}(k_j)\\right .",
    "\\nonumber \\\\ & - & \\left .",
    "\\left ( \\frac{e{\\cal e}}{\\delta k}\\right )   { \\rm i m } \\left\\ { \\ln \\det \\left [ s_{nm}(k_j , k_{j+1 } ) \\right ]   \\right\\}\\vphantom{\\sum_n^n}\\right]\\;.\\end{aligned}\\ ] ] in appendix  [ app : s - series ] , we prove the following result : @xmath270 \\right\\ } } { \\delta u_{nk_j}^\\ast } = -\\frac{i}{2 } \\sum_{m=1}^n \\left [   \\left.\\left| u_{mk_{j+1}}\\right .",
    "\\right\\rangle s^{-1}_{mn}(k_j , k_{j+1 } )   - \\left.\\left| u_{mk_{j-1}}\\right .",
    "\\right\\rangle s^{-1}_{mn}(k_j , k_{j-1 } ) \\right]\\;,\\end{aligned}\\ ] ] which can be used to derive the euler - lagrange equation from eq .",
    "[ e1-p ] , as follows : @xmath271   \\vphantom{\\sum_n^n}\\right\\ } = 0\\;.\\end{aligned}\\ ] ] below , we consider the perturbation expansions of the lagrange multipliers , the energy , and the sternheimer equation .",
    "the expansion of the orthonormalization condition was already developed in the previous section , and remains unaltered in the present case .",
    "we multiply eq .",
    "[ stern0-p ] on the left by @xmath272 to write the lagrange multipliers @xmath273 it can be readily seen that the terms involving the overlap matrix cancel out , since @xmath274   \\nonumber \\\\ & ~ & ~= \\sum_l \\left [ s_{ml}(k_j , k_{j+1 } ) s^{-1}_{l n}(k_j , k_{j+1 } ) -   s_{ml}(k_j , k_{j-1 } ) s^{-1}_{l n}(k_j , k_{j-1 } ) \\right ]    = 0\\;.\\end{aligned}\\ ] ] the perturbation expansion of eq",
    ".  [ lm - p ] takes the simple form @xmath275      in order to write the perturbation expansion of eq .",
    "[ e1-p ] , we need the expansion of the polarization on the basis of the @xmath196 theorem .",
    "the variation - perturbation framework allows us to focus on the part of @xmath276 or @xmath277 that comes from variation of the wavefunctions up to order @xmath195 only . for these quantities ,",
    "we introduce the notation @xmath278 or @xmath279 .",
    "the even terms are written @xmath280 ^{(2i ) } = \\left .",
    "-\\frac{1}{(2i ) ! } \\frac{\\partial^{2i}}{\\partial { \\cal e}^{2i } } \\left[{\\cal e } p\\left(\\sum_{j=0}^i { \\cal e}^j u_{nk_j}^{(j ) } \\right ) \\right ] \\right|_{{\\cal e}=0 } \\nonumber\\\\   & = & -\\left[p\\left(\\sum_{j=0}^i { \\cal e}^j u_{nk_j}^{(j ) } \\right ) \\right]^{(2i-1)}\\;.\\end{aligned}\\ ] ] by the same token , for the odd terms we obtain @xmath281^{(2i+1 ) } = -\\left[p\\left(\\sum_{j=0}^i { \\cal e}^j u_{nk_j}^{(j ) } \\right ) \\right]^{(2i)}\\;.\\end{aligned}\\ ] ] in these expressions , the @xmath196-theorem implies that only the contributions of order @xmath282 from the perturbed wave functions will appear , when we consider the contribution of the polarization term to the total - energy derivatives .",
    "more explicit formulas for computing these polarization derivatives will be given below .",
    "with these results , we can expand eq .",
    "[ e1-p ] . from eqs .",
    "[ e - pert ] and [ p - even - discr ] we obtain the even terms @xmath283\\;,\\end{aligned}\\ ] ] while from eqs .",
    "[ e - pert ] and [ p - odd - discr ] , the odd terms are written @xmath284      the perturbation expansion of eq .  [ stern0-p ] yields the sternheimer equation @xmath285 \\right\\ } = 0\\;.\\end{aligned}\\ ] ] the conduction - band projector @xmath247 in eqs .",
    "[ stern.i ] and [ stern.i - p ] appears due the fact that the lagrange multipliers in these two equations may be different , due to @xmath26-gauge freedom .",
    "thus , only conduction - band contributions can be identified while comparing the two formulations .    by comparing eqs .",
    "[ stern.i ] and [ stern.i - p ] , we see that in the present formulation the term @xmath286 is approximated by the finite - difference formula @xmath287\\;.\\end{aligned}\\ ] ] the theory of finite - difference approximations to derivatives could now be applied to eq .",
    "[ k - p ] , as a function of @xmath102 .",
    "note that this expression is invariant under @xmath288 , as it induces simultaneous exchange of @xmath289 and @xmath290 .",
    "thus @xmath291 one can now define @xmath292\\;,\\end{aligned}\\ ] ] giving a higher - order approximation of @xmath293 as @xmath294/3=d(0)+{\\cal o}(\\delta k)^4\\;.\\end{aligned}\\ ] ] this improved expression also derives from a total energy functional . instead of eq .",
    "[ e - def - p ] , one must start from @xmath295 & = & \\frac{2}{n_k } \\sum_{n=1}^n \\sum_{j=1}^{n_k } \\left\\langle u_{nk_j } \\left| h^{(0)}_{k_j } \\right| u_{nk_j } \\right\\rangle \\nonumber \\\\ & - & \\frac{2e{\\cal e}}{n_k\\delta k } \\sum_{j=1}^{n_k } { \\rm i m } \\left\\ { \\frac{4}{3 } \\ln \\det \\left [ s_{mn}(k_j , k_{j+1 } ) \\right ] - \\frac{1}{6 } \\ln \\det \\left [ s_{mn}(k_j , k_{j+2 } ) \\right ] \\right\\}\\;.\\end{aligned}\\ ] ] despite its interest , we will not explore this topics further in the present paper .      in appendix",
    "[ app : s - series ] , we derive the taylor expansion of eq .",
    "[ p - discr ] for the polarization , which allows us to obtain explicit expressions for eqs .",
    "[ p - even - discr ] and [ p - odd - discr ] . here",
    ", we look at the lower - order expressions for the energy and the sternheimer equation .      from appendix  [ app : s - series ]",
    ", the second - order polarization term is given by @xmath296^{(1 ) } = -\\frac{2 e}{n_k\\delta k } \\sum_{j=1}^{n_k }   { \\rm i m } \\left\\ { { \\rm tr}\\left [   s^{(1)}(k_j , k_{j+1 } ) q(k_j , k_{j+1 } )   \\right ] \\right\\}\\nonumber\\\\ & = & -\\frac{2 e}{n_k\\delta k } \\sum_{j=1}^{n_k }   { \\rm i m } \\left\\ { \\sum_{m , n=1}^n \\left [ \\left\\langle u_{nk_j}^{(1 ) }   \\left| u_{mk_{j+1}}^{(0 ) } \\right\\rangle\\right . +   \\left\\langle u_{nk_j}^{(0 ) }   \\left| u_{mk_{j+1}}^{(1 ) } \\right\\rangle \\right . \\right ] q_{mn}(k_j , k_{j+1})\\right\\ } \\;,\\end{aligned}\\ ] ] where @xmath297 , obeying @xmath298 is the inverse of the zeroth - order overlap matrix @xmath299    the second - order expression for the energy is then given by the @xmath227 term in eq .",
    "[ e - even - p ] @xmath300 the third - order derivative of the energy is given by by the @xmath227 in eq .",
    "[ e - odd - p ] .",
    "the first - order contribution to the lagrange multipliers vanishes , since from eqs .",
    "[ u - ortho ] and [ lm1-p ] we have @xmath301 , which leads to @xmath302 . from the results in appendix  [ app : s - series ] @xmath303^{(2 ) } \\nonumber\\\\ & = & -\\frac{e}{n_k\\delta k } \\sum_{j=1}^{n_k } { \\rm i m }   \\left\\ {   { \\rm tr } \\left [ 2s^{(2)}(k_j , k_{j+1})~q(k_j , k_{j+1 } ) \\right.\\right.\\nonumber\\\\   & & - \\left.\\left .",
    "s^{(1)}\\left ( k_j , k_{j+1}\\right ) q\\left ( k_j , k_{j+1}\\right ) s^{(1)}\\left ( k_j , k_{j+1}\\right ) q\\left ( k_j , k_{j+1}\\right ) \\right]\\right\\}\\nonumber\\\\   & = & -\\frac{e}{n_k\\delta k}\\sum_{j=1}^{n_k } { \\rm i m } \\left\\ {   \\sum_{m , n=1}^n   2\\left\\langle u_{nk_j}^{(1 ) } \\left| u_{mk_{j+1}}^{(1)}\\right.\\right\\rangle   q_{mn}\\left ( k_j , k_{j+1}\\right )   \\right.\\nonumber\\\\ & & - \\sum_{m ,",
    "n , l , l^\\prime=1}^n   \\left [   \\left\\langle u_{mk_j}^{(1)}\\left| u_{n k_{j+1}}^{(0)}\\right\\rangle\\right .",
    "+   \\left\\langle u_{mk_j}^{(0)}\\left| u_{n k_{j+1}}^{(1)}\\right\\rangle\\right .",
    "\\right ] q_{nl}\\left ( k_j , k_{j+1}\\right ) \\nonumber \\\\ & & \\left . \\left",
    "[   \\left\\langle u_{l k}^{(1 ) } \\left|   u_{l^\\prime k_{j+1}}^{(0)}\\right.\\right\\rangle +   \\left\\langle u_{l k}^{(0 ) } \\left|   u_{l^\\prime k_{j+1}}^{(1)}\\right.\\right\\rangle   \\right ] q_{l^\\prime m}\\left ( k_j , k_{j+1}\\right ) \\vphantom{\\sum_{m}^n}\\right\\}\\;.\\end{aligned}\\ ] ]    for the fourth- and higher - order energy derivatives , the expansion yields very involved expressions .",
    "we end this section by considering the fourth - order term for the energy in a more compact notation [ we drop the @xmath304 matrix arguments ] : @xmath305^{(3 ) } \\nonumber\\\\ & = & -\\frac{2 e}{3 n_k\\delta k } \\sum_{j=1}^{n_k } { \\rm i m }   \\left\\ {   { \\rm tr } \\left [   3~\\!s^{(3 ) } q - 3~\\ ! s^{(2)}~q~s^{(1)}~q +   s^{(1)}~q~s^{(1)}~q~s^{(1)}~q   \\right ] \\right\\}\\nonumber\\\\ & = & -\\frac{2 e}{3 n_k\\delta k } \\sum_{j=1}^{n_k } { \\rm i m } \\left\\ {   3\\sum_{m , n=1}^n   \\left",
    "[ \\left\\langle u_{nk_j}^{(1 ) } \\left| u_{mk_{j+1}}^{(2)}\\right.\\right\\rangle   + \\left\\langle u_{nk_j}^{(2 ) } \\left| u_{mk_{j+1}}^{(1)}\\right.\\right\\rangle \\right ] q_{mn } \\right . \\nonumber\\\\   & - & 3 \\sum_{m , n=1}^n   \\left [   \\left\\langle u_{nk_j}^{(0)}\\left| u_{n k_{j+1}}^{(2)}\\right.\\right\\rangle +   \\left\\langle u_{nk_j}^{(1)}\\left| u_{m k_{j+1}}^{(1)}\\right.\\right\\rangle +   \\left\\langle u_{nk_j}^{(2)}\\left| u_{m k_{j+1}}^{(0)}\\right.\\right\\rangle   \\right ] \\left ( q s^{(1 ) } q\\right)_{mn } \\nonumber\\\\ & + & \\left . s^{(1)}~q~s^{(1)}~q~s^{(1)}~q\\vphantom{\\sum_{m}^n } \\right\\}\\end{aligned}\\ ] ] in this expression , we write explicitly only the terms containing @xmath306 , which will determine the second - order term of the sternheimer equation .",
    "the corresponding fourth - order energy is given by @xmath307      from eq .",
    "[ stern.i - p ] , the first - order term for the sternheimer equation reads @xmath308\\;;\\nonumber\\\\\\end{aligned}\\ ] ] while the second - order derivative is written @xmath309 \\right .",
    "\\nonumber\\\\ & & -\\sum_{m , l , l^\\prime=1}^n   \\left [   \\left.\\left| u_{mk_{j+1}}^{(0 ) } \\right.\\right\\rangle   q_{m l}\\left ( k_j , k_{j+1}\\right )   s^{(1)}_{l , l^\\prime}\\left ( k_j , k_{j+1}\\right )   q_{l^\\prime n}\\left ( k_j , k_{j+1}\\right ) \\right.\\nonumber\\\\ & & \\left.\\left",
    ". -\\left.\\left| u_{mk_{j-1}}^{(0 ) } \\right.\\right\\rangle   q_{m l}\\left ( k_j , k_{j-1}\\right ) s^{(1)}_{l , l^\\prime}\\left ( k_j , k_{j-1}\\right )   q_{l^\\prime n}\\left ( k_j , k_{j-1}\\right ) \\right ] \\vphantom{\\sum_n^n } \\right\\}\\;.\\end{aligned}\\ ] ] these two expressions can also be consistently obtained by taking the conduction - band projection of the corresponding terms in the expansion of @xmath310 .",
    "in this section , we illustrate the present theory by applying it the two - band 1d - tb hamiltonian introduced in sec .  [",
    "sec : efp ] . for this model",
    ", exact analytical expressions can be written for the continuous formulation .",
    "our purpose in this simple application is to demonstrate consistency between the continuous and the discretized versions of the theory , and also to make a preliminary assessment of the convergence of the energy derivatives obtained in the two discretized formulations , with respect to @xmath26-point sampling in the brillouin zone .",
    "appendix  [ app:1dmodel ] contains the detailed derivations of the results presented here . as such",
    ", it presents a step - by - step example of the use of the formalism developed in the present paper .      in the continuous formulation ,",
    "the first - order change of the valence state is obtained from the corresponding term in the sternheimer equation . by setting @xmath227 in eq .",
    "[ stern.i ] , this is given by @xmath311 the solution to this equation is given in appendix  [ app:1dmodel ] .",
    "having solved eq .",
    "[ 1d - str1 ] , @xmath229 can then be obtained from the simplest non - variational expression eq .",
    "[ e2-invar - nv ] as @xmath312 where @xmath313 , and @xmath314 is obtained from eqs .",
    "[ 1d - eigval ] and [ theta ] ( see eq .",
    "[ dthetadk ] ) .",
    "the second - order change of the valence state is obtained from the @xmath251 term in eq .",
    "[ stern.i ] and from eq .",
    "[ pv - u2 ] . in our 1d model ,",
    "the sternheimer equation for the conduction - band projection reads @xmath315 \\;.\\end{aligned}\\ ] ] using the solution for @xmath316 given in appendix  [ app:1dmodel ] , we can now arrive at the expression for the fourth - order energy . applying eq .",
    "[ e4-invar ] , we write @xmath317\\;.\\end{aligned}\\ ] ] ( expressions for @xmath229 and @xmath232 in terms of elliptic integrals of the second kind are given in appendix  [ app:1dmodel ] . )    turning now to the discretized expressions , using the non - variational eq .",
    "[ e2-invar - nv ] we compute the dape expression for the second - order energy : @xmath318 ^ 2\\;.\\end{aligned}\\ ] ] the pead second - order energy expression takes a different form : @xmath319 \\right\\}^2\\;.\\end{aligned}\\ ] ]    with the results in appendix  [ app:1dmodel ] , we have all the ingredients to write analytical expressions for the discretized versions of @xmath232 , but these are quite cumbersome and will not be reproduced here .",
    "the numerical results obtained using these expressions are discussed below .      in order to test the consistency between the three formulations",
    ", we checked that by sufficiently increasing the number of @xmath26-points used in the evaluation of the discretized energy derivatives , we obtain an agreement between continuous and discretized expressions within stringent degrees of accuracy .",
    "for example , for @xmath320 , 80 @xmath26-points in the full brillouin zone are needed for the three expressions for @xmath229 ( eqs .",
    "[ 1d - e2 ] ,  [ 1d - e2-discr ] , and  [ p1d - e2 ] ) to agree within @xmath321% , while 240 @xmath26-points are needed to get the same level of agreement for the @xmath232 expressions .    by decreasing the number of @xmath26-points , thus worsening the level of accuracy of the discretized expressions ,",
    "the differences between them become more apparent . in fig .",
    "[ e2fig ] , we show the quantity @xmath322/e^{(2)}_{exact}$ ] giving the percentual error in the evaluation of @xmath229 for the two discretized formulations , using 20 @xmath26-points , with the hoping parameter varying over the [ 0,1 ] interval . in fig .",
    "[ e4fig ] the corresponding quantity for @xmath232 , @xmath323/e^{(4)}_{exact}$ ] , is shown for a sampling of 80 @xmath26-points .",
    "it is clear from figs .",
    "[ e2fig ] and [ e4fig ] that the energy derivatives obtained from the pead converge faster with respect to the number of @xmath26-points , at least for the present 1d model .",
    "however , it must be borne in mind that this formulation involves the calculation of the inverse of the zero - field overlap matrix , and in practical applications the additional cost associated with this operation could offset the gain in @xmath26-point convergence , specially when the two formulations are applied to systems with large numbers of atoms in the unit cell .",
    "this point remains to be further addressed when the theory is applied in the context of realistic tight - binding and _ ab initio _ calculations .",
    "we also computed the norm of the first- and second - order wavefunction derivatives @xmath324^{1/2}\\;$ ] as a function of @xmath26 , for the continuous solutions and the two discretized forms , with a value of @xmath320 for the hoping parameter and samplings of 20 and 80 @xmath26-points .",
    "as expected from the above results for @xmath229 and @xmath232 , we observe that the wavefunctions in the pead are better approximations to the exact ones from the continuous formulation .",
    "the goal of this work was to obtain second- and higher - order derivatives of the total energy of periodic insulators , with respect to an applied homogeneous electric field .",
    "related physical properties are the linear and non - linear dielectric susceptibilities ( connected to linear and non - linear optical constants ) .",
    "although a variation - perturbation framework had been formulated earlier for the computation of derivatives of the total energy with respect to many different perturbations , several formal and technical difficulties must be addressed when considering the specific case of a homogeneous - electric - field perturbation .    at the level of the electric - field - dependent energy functional , we proposed a basic expression , eq .",
    "[ e - def ] , that we argue to be valid in the space of states possessing a periodic density .",
    "it is directly linked to the modern theory of polarization , proposed by king - smith and vanderbilt nearly a decade ago , and allows to recover easily the berry phase polarization formula , central to this theory .    unfortunately , when the polarization is varied , this energy functional leads to local minima with a basin of attraction of _ infinitesimal _ extent . a regularization procedure , based on a @xmath26-point discretization of the reciprocal - space integrals ,",
    "must be used in order to lead to a finite size basin .",
    "this is the reciprocal - space analog of the real - space cut - off introduced by nunes and vanderbilt in their treatment of polarized wannier functions .",
    "having thus defined a suitable energy functional , that depends on the applied homogeneous electric field , we were allowed to proceed with the application of the variation - perturbation machinery .",
    "interestingly , the derivation of the canonical formulas at all orders of perturbation can be done either on the basis of the energy functional already regularized , or on the basis of the unregularized one , followed by regularization at each order .",
    "the formulas derived in the two cases differ from each other . working with the regularized energy functional",
    "gives more cumbersome expressions , however perfectly consistent with an energy functional , while the a posteriori application of the regularization at each order is not consistent with the regularized energy functional .",
    "the two procedures will tend to the same limit when the discretization is refined further and further .",
    "the expression for the third - order derivative of the total energy , previously proposed by mauri and dal corso , is recovered , as an instance of the `` a posteriori '' application of the regularization technique .",
    "we applied this formalism to a model one - dimensional two - band hamiltonian , showing explicitly the pathology of a non - regularized energy functional and its cure , as well as the differences related to the order in which the perturbation expansion and the discretization procedure are applied .",
    "the two discretized formulations are shown to agree in the continuum limit , although the `` perturbation expansion after discretization '' ( pead ) formulation seems to be closer to the exact answer than the `` discretization after perturbation expansion '' ( dape ) formulation , for an equivalent grid .",
    "some solid - state textbooks define the electric polarization of a crystalline solid as the average over the unit cell of the dipole moment per unit volume of the electronic - charge distribution , @xmath325 .",
    "this definition is only valid in the so - called clausius - mosotti limit in which the electronic charge distribution can be uniquely partioned into non - overlapping units belonging to each unit cell . in most cases ,",
    "the quantum - mechanical charge density of a solid is a continuous function of space , and this definition is actually _ invalid _ ( see refs .  ) .",
    "local - field effects are associated with the umklapp terms in the dielectric response : a macroscopic electric field induces modifications of the density at the atomic scale , that induce modifications of the potential at the atomic scale , that induce modifications of the macroscopic polarization . in a more formal approach , they arise because the macroscopic dielectric constant is the inverse of the `` head '' ( g=0,g=0 ) of the inverse dielectric matrix ( see ref .  ) , and not simply the `` head '' of the dielectric matrix .",
    "we list a few entry points to the literature dealing with the independent - particle ( without local - field ) computation of higher - order susceptibilities : m .- z .",
    "huang and w.  y.  ching , phys .",
    "b * 47 * , 9464 ( 1993 ) ; m .- z .",
    "huang and w.  y.  ching , phys .",
    "b * 47 * , 9479 ( 1993 ) ; j.  e.  sipe and ed .",
    "ghahramani , phys .",
    "b * 48 * , 11705 ( 1993 ) ; j.  l.  p. hughes and j.  e.  sipe , phys . rev .",
    "b * 53 * , 10751 ( 1996 ) .",
    "r.  resta , _",
    "berry s phase and geometric quantum distance : macroscopic polarization and electron localization _",
    ", lectures notes for the `` troisime cycle de la physique",
    "en suisse romande '' ( lausanne , 2000 ) .",
    "available online ( 376k ) at the url : http://www-dft.ts.infn.it/  resta / publ / notes2000.ps.gz .                    in this appendix",
    ", we describe the algebraic manipulations needed to transform eqs  [ e - even ] , [ e - odd ] , and [ stern.i ] into their gauge - invariant forms presented in secs .  [ pt - cont - energy ] and [ pt - cont - stern ] .",
    "we will use the following result : @xmath326 furthermore , from eq .",
    "[ ortho - pert ] we have @xmath327 with the help of eq .  [ a1 ] and",
    "@xmath328 , it is straightforward to show that @xmath329 \\left.\\left| u_{m k}^{(i ) } \\right.\\right\\rangle =   \\left (   \\frac{\\partial}{\\partial k }   \\left.\\left| u_{mk}^{(i ) } \\right.\\right\\rangle   \\left\\langle \\left .",
    "u_{mk}^{(0 ) } \\right|\\right .",
    "\\right )   \\left| \\left .",
    "u_{nk}^{(0 ) } \\right\\rangle\\right.\\;.\\end{aligned}\\ ] ] we recall that the notation `` @xmath330 '' indicates that @xmath331 acts only on the expression in parenthesis .",
    "now , for reference we repeat eqs .",
    "[ e - even ] and [ e - odd ] here : @xmath332 \\;.\\end{aligned}\\ ] ] @xmath333 \\;.\\nonumber\\\\\\end{aligned}\\ ] ] let us examine the @xmath227 and @xmath251 terms in eq .",
    "[ a4 ] , and the @xmath227 term in eq .",
    "we use eq .",
    "[ lm1 ] to write @xmath334    eq .  [ u - ortho ] and the orthonormality relation @xmath335 allow us to rewrite the last two terms in this equation in the explicit gauge - invariant form of eq",
    ".  [ e2-invar ] , as follows : @xmath336 where we use the notation @xmath337 . the second term in eq .",
    "[ a6 ] is obtained simply as the hermitian conjugate of this latter equation .    for the third and fourth - order terms",
    ", we have @xmath338 and @xmath339 we now apply eq .",
    "[ a3 ] to recombine terms in these two expressions as follows : @xmath340 where @xmath341 applies to @xmath242 and @xmath342 to @xmath232 .",
    "this leads to the gauge - invariant expressions for these quantities , eqs .",
    "[ e3-invar ] and [ e4-invar ] , respectively .    for the general energy derivative , besides the terms corresponding to those above for @xmath242 and @xmath232 , we must also consider terms of the form @xmath343 for the second term on the right , we use eqs .",
    "[ a1 ] and [ a2 ] to write @xmath344 these results demonstrate the gauge invariance of the general expansion terms for the energy .",
    "the proper gauge - transformation properties of the sternheimer equation can also be proven explicitly along the same lines , but it follows more simply from the invariance of the even - order terms for the energy .      in order to develop the pead formulation , we examine the following expression appearing in eqs .",
    "[ p - discr ] and [ e - def - p ] : @xmath345 & = & ln~det\\left[s^{(0)}_{nm}(k_j , k_{j+1 } ) + { \\cal e } s^{(1)}_{nm}(k_j , k_{j+1 } ) + ... \\right ] \\nonumber\\\\ & = & ln~det\\left[s^{(0)}_{nm}(k_j , k_{j+1})\\right ] +   \\int_0^{\\cal e}d{\\cal e}\\frac{\\partial}{\\partial{\\cal e } } ln~det\\left[s_{nm}(k_j , k_{j+1})({\\cal e})\\right]\\;,\\end{aligned}\\ ] ] where the perturbation expansion of @xmath346 is defined according to eq .",
    "[ series ] . with the help of the `` magic '' formula @xmath347\\right\\ } = tr\\left[a^{-1}\\frac{\\partial a}{\\partial\\lambda}\\right ] = \\sum_{m , n}a^{-1}_{mn}\\frac{\\partial a_{nm}}{\\partial\\lambda}\\,,\\end{aligned}\\ ] ]",
    "we can rewrite eq .  [ b1 ]",
    "( to simplify the notation , in the following equations we drop the @xmath26-point arguments ) as follows : @xmath348 = ln~det\\left[s^{(0)}_{nm}\\right ] + \\int_0^{\\cal e}d{\\cal e } \\sum_{mn}\\frac{\\partial s_{nm } ( { \\cal e})}{\\partial{\\cal e } } s^{-1}_{mn}({\\cal e})\\;.\\end{aligned}\\ ] ] to proceed further , we let @xmath349 , and the inverse overlap matrix can be written as @xmath350\\right\\}^{-1 } =   \\left\\ { i + \\sum_{i=1}^{\\infty}(-1)^i\\left[{\\vphantom \\sum}q \\delta s({\\cal e})\\right]^i\\right\\}q\\;,\\end{aligned}\\ ] ] where , following the notation introduced in sec .",
    "[ lower - p ] , we use @xmath351^{-1}$ ] for the inverse of the zeroth - order overlap matrix .    to obtain the lower - order terms in the expansion of eq .",
    "[ b1 ] , we write the terms up to third - order explicitly : @xmath352 \\nonumber \\\\ & + &   { \\cal e}^3\\left [ - q s^{(3 ) } q +    q s^{(2 ) } q s^{(1 ) } q + q s^{(1 ) } q s^{(2 ) } q \\right.\\nonumber \\\\ & -&\\left .",
    "q s^{(1 ) } q s^{(1 ) } q s^{(1 ) } q \\right ] + { \\cal o}({\\cal e}^4)\\;.\\end{aligned}\\ ] ]    combining eqs .",
    "[ b3 ] , [ b5 ] and @xmath353 , we arrive at @xmath354 & = & ln~det\\left[s^{(0)}\\right ]   + { \\cal e } tr\\left [ s^{(1)}q\\right ] +      \\frac{{\\cal e}^2}{2 } { \\rm tr } \\left [ 2 s^{(2 ) } q -   s^{(1 ) } q s^{(1 ) } q \\right ] \\nonumber \\\\ & + &   \\frac{{\\cal e}^3}{3 } tr\\left [ 3 s^{(3 ) } q -    3 s^{(2 ) } q s^{(1 ) } q + s^{(1 ) } q s^{(1 ) } q s^{(1 ) } q \\right ] \\nonumber \\\\ & + & \\frac{{\\cal e}^4}{4 } tr\\left [ 4 s^{(4 ) } q   -   4 s^{(3 ) } q s^{(1 ) } q   -2 s^{(2 ) } q s^{(2 ) } q \\right.\\nonumber \\\\   & + & \\left .",
    "4 s^{(2 ) } q s^{(1 ) } q s^{(1 ) } q    -s^{(1 ) } q s^{(1 ) } q s^{(1 ) } q s^{(1 ) } q   \\right ] + { \\cal o}({\\cal e}^5)\\;.\\end{aligned}\\ ] ] finally , we note that the magic formula may also be used to derive the euler - lagrange equation given in eq .",
    "[ stern0-p ] , as follows : @xmath355\\right\\ } } { \\delta u_{nk}^\\ast } = { \\rm tr}\\left [ s^{-1}\\frac{\\delta s}{\\delta u_{nk}^\\ast}\\right ] = \\sum_{m=1}^n \\left.\\left| u_{mk_{j+1 } } \\right.\\right\\rangle s^{-1}_{mn}(k_j , k_{j+1 } ) \\;.\\end{aligned}\\ ] ]      in this appendix , we provide all the steps for the derivation of the energy derivatives for the 1d - tb model , given in sec .  [ sec:1d - model ] .",
    "the expressions for the discretized versions of @xmath232 are not written explicitly .",
    "[ 1d - e0 ] for the unperturbed total energy is a complete elliptic integral of the second kind  @xcite , which is given in its general form by @xmath356 where @xmath357 is a positive or negative integer , and @xmath358 .",
    "several such integrals will be encountered in the course of our derivation .",
    "we begin by developing some useful preliminary results . for our 1d - tb model ,",
    "the derivatives with respect to @xmath26 of the unperturbed valence and conduction states ( eq .  [ 1d - eigstate ] ) are written analytically as @xmath359 where @xmath360 .",
    "recalling that @xmath361 , hence , the solution of eq .",
    "[ 1d - str1 ] gives the first - order change of the valence state @xmath362 where @xmath363 ^ 2 $ ] .",
    "from eqs .",
    "[ 1d - eigval ] and [ theta ] , the partial derivative appearing in this expression is simply @xmath364 } \\;.\\end{aligned}\\ ] ] using eq .",
    "[ dthetadk ] , the second - order energy term ( eq .  [ 1d - e2 ] ) is written @xmath365\\;.\\end{aligned}\\ ] ]    the second - order change of the valence state is obtained from eqs .",
    "[ stern2-invar ] and [ pv - u2 ] .",
    "the first - order lagrange multiplier in eq .",
    "[ stern2-invar ] is obtained from eqs .",
    "[ 1d - eigstate ] , [ lm1 ] , and [ dudk ] : @xmath366 simple algebraic manipulations involving eqs .",
    "[ dudk ] ,  [ 1d - v1 ] , and [ 1d - lagr1 ] , combined with eqs .",
    "[ stern2-invar ] and [ pv - u2 ] , yield the second - order wave - function derivatives @xmath367   e^{-i \\delta \\alpha_k}\\left .",
    "\\left| u_{ck}^{(0)}\\right.\\right\\rangle\\ , , \\nonumber \\\\",
    "p_{vk } \\left.\\left| u_{vk}^{(2 ) } \\right.\\right\\rangle & = & -{1 \\over 2 }    \\left.\\left| u_{vk}^{(0 ) } \\right.\\right\\rangle   \\left\\langle u_{vk}^{(1 ) } \\left| u_{vk}^{(1 ) } \\right.\\right\\rangle =   -{1 \\over 2 } \\left ( { 1 \\over \\delta\\varepsilon_k }   { \\partial \\theta_k \\over \\partial k } \\right)^2",
    "\\left.\\left| u_{vk}^{(0 ) } \\right.\\right\\rangle \\;.\\end{aligned}\\ ] ]    these results lead to eq .",
    "[ 1d - e4 ] for @xmath232 . in terms of elliptic integrals ,",
    "this quantity is written @xmath368   { \\cal i}_{-{9 \\over2 } }   + \\frac{1}{64\\pi } \\left [ 48 \\left ( 1 + a^2 \\right ) + 17 \\right ] { \\cal i}_{-{7 \\over 2 } } \\nonumber \\\\ & & - \\frac{1}{4\\pi}{\\cal i}_{-{5 \\over 2}}\\;.\\end{aligned}\\ ] ]      we now apply the dape expressions obtained in sec .",
    "[ discr ] to our 1d - tb model .",
    "the first - order valence state is given by @xmath369 p_{ck_j } \\left.\\left| u_{vk_j}^{(1 ) } \\right.\\right\\rangle =   - { i \\over 2\\delta k } p_{ck_j }   \\left [ \\vphantom{\\sum_n^n } \\left.\\left| u_{v k_{j+1}}^{(0 ) } \\right.\\right\\rangle \\left\\langle u_{v k_{j+1}}^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle - \\left.\\left| u_{v k_{j-1 } } ^{(0 ) } \\right.\\right\\rangle \\left\\langle u_{v k_{j-1 } } ^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle \\right ]   \\nonumber\\\\   & & \\ ; = - { i \\over 2\\delta k } \\left.\\left| u_{ck_j}^{(0 ) } \\right.\\right\\rangle   \\left [ \\vphantom{\\sum_n^n } \\left\\langle u_{ck_j}^{(0 ) }   \\left| u_{v k_{j+1}}^{(0 ) } \\right.\\right\\rangle \\left\\langle u_{vk_{j+1}}^{(0 ) }   \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle - \\left\\langle u_{c k_j}^{(0 ) } \\left| u_{v k_{j-1 } } ^{(0 ) } \\right.\\right\\rangle \\left\\langle u_{v k_{j-1 } } ^{(0 ) }   \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle \\right]\\;.\\end{aligned}\\ ] ] using eq .",
    "[ 1d - eigstate ] , this expression becomes @xmath370 where we use a simplified notation @xmath371 ( likewise for @xmath372 and @xmath373 ) . from eqs .",
    "[ v1-discr ] and [ e2-discr - nv ] , we obtain eq .",
    "[ 1d - e2-discr ] .",
    "the second - order wavefunction is obtained from eqs .  [ pv - u2 ] and [ stern2-discr ] .",
    "the sternheimer equation is written @xmath374 p_{ck_j }   \\left.\\left| u_{vk_j}^{(2 ) } \\right.\\right\\rangle = - { i \\over 2\\delta k}p_{ck_j }     \\left[\\vphantom{\\sum_n^n } \\left.\\left| u_{v k_{j+1}}^{(1 ) } \\right.\\right\\rangle   \\left\\langle u_{v k_{j+1}}^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle - \\left.\\left| u_{v k_{j-1 } } ^{(1 ) } \\right.\\right\\rangle   \\left\\langle u_{v k_{j-1 } } ^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle   \\right ] \\nonumber \\\\ & & \\ ; = - { i \\over 2\\delta k } \\left.\\left| u_{ck_j}^{(0 ) } \\right.\\right\\rangle \\left[\\vphantom{\\sum_n^n } \\left\\langle u_{c k_j}^{(0 ) }   \\left| u_{v k_{j+1}}^{(1 ) } \\right.\\right\\rangle   \\left\\langle u_{v k_{j+1}}^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle - \\left\\langle u_{c k_j}^{(0 ) } \\left| u_{v k_{j-1 } } ^{(1 ) } \\right.\\right\\rangle   \\left\\langle u_{v k_{j-1 } } ^{(0 ) } \\left| u_{vk_j}^{(0 ) } \\right.\\right\\rangle   \\right]\\;.\\end{aligned}\\ ] ] by combining eqs .",
    "[ 1d - eigstate ] , [ pv - u2 ] , and [ v1-discr ] , we arrive at @xmath375 \\left.\\left| u_{ck_j}^{(0 ) } \\right.\\right\\rangle \\,.\\end{aligned}\\ ] ] eqs .",
    "[ v1-discr ] and [ v2-discr ] , combined with eq .  [ e4-discr ] , lead to an analytic expression for @xmath232 .      here",
    ", we apply the pead expressions from sec .",
    "[ sec : pt - p ] to the model system .",
    "the zero - field overlap matrix , is @xmath376 note that for this model , @xmath377 is a 1@xmath3781 matrix , and hence the inverse overlap matrix is simply      from eq .",
    "[ stern1-p ] , the first - order sternheimer equation reads @xmath380   p_{ck_j } \\left.\\left| u_{vk_j}^{(1 ) } \\right.\\right\\rangle =   - p_{ck_j } { i \\over 2\\delta k }",
    "\\left [ \\vphantom{\\sum_n^n } \\left.\\left| u_{v k_{j+1}}^{(0 ) } \\right.\\right\\rangle q\\left ( k , k_{j+1 } \\right ) -   \\left.\\left| u_{v k_{j-1 } } ^{(0 ) } \\right.\\right\\rangle q\\left ( k , k_{j-1 } \\right ) \\right]\\;.\\end{aligned}\\ ] ] using eq .",
    "[ 1d - eigstate ] , we obtain @xmath381 \\;.\\end{aligned}\\ ] ] to obtain the second - order wavefunctions , we need the first - order term for the overlap matrix @xmath382 .",
    "thanks to eqs .",
    "[ 1d - eigstate ] and [ p1d - v1 ] , we have @xmath383\\,.\\end{aligned}\\ ] ] plugging the above results for @xmath384 , @xmath385 , @xmath386 , @xmath387 , and @xmath388 in eqs .",
    "[ pv - u2 ] and [ stern2-p ] we get @xmath389 ^ 2 \\nonumber \\\\ p_{ck_j } \\left.\\left| u_{vk_j}^{(2 ) } \\right.\\right\\rangle & = & \\left.\\left| u_{ck_j}^{(0 ) } \\right.\\right\\rangle \\frac{e^{-i \\delta \\alpha_j } } { 4\\delta^2\\!k \\delta\\varepsilon_j}\\left\\ { \\frac{\\left[1+\\tan^2\\left(\\theta_{j+1 } - \\theta_j \\right)\\right ] \\left[\\tan\\left(\\theta_{j+2 } - \\theta_{j+1 } \\right ) - \\tan\\left(\\theta_{j } - \\theta_{j+1 } \\right)\\right]}{\\delta\\varepsilon_{j+1 } } \\right .",
    "+ \\nonumber\\\\ & & \\frac{\\left[1+\\tan^2\\left(\\theta_{j-1 } - \\theta_j \\right)\\right ] \\left[\\tan\\left(\\theta_{j-2 } - \\theta_{j-1 } \\right ) - \\tan\\left(\\theta_{j } - \\theta_{j-1 } \\right)\\right]}{\\delta\\varepsilon_{j-1 } } + \\nonumber\\\\ & & \\left.\\frac{\\left[\\tan^2\\left(\\theta_{j+1 } - \\theta_j \\right ) -   \\tan^2\\left(\\theta_{j-1 } - \\theta_j \\right)\\right ] \\left[\\tan\\left(\\theta_{j+1 } - \\theta_{j } \\right ) - \\tan\\left(\\theta_{j-1 } - \\theta_{j-1 } \\right)\\right]}{\\delta\\varepsilon_{j } } \\right\\}\\;.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> a perturbation theory of the static response of insulating crystals to homogeneous electric fields , that combines the modern theory of polarization with the variation - perturbation framework is developed , at unrestricted order of perturbation . </S>",
    "<S> conceptual issues involved in the definition of such a perturbative approach are addressed . in particular , we argue that the position operator , @xmath0 , can be substituted by the derivative with respect to the wavevector , @xmath1 , in the definition of an electric - field - dependent energy functional for periodic systems . </S>",
    "<S> moreover , due to the unbound nature of the perturbation , a regularization of the berry - phase expression for the polarization is needed in order to define a numerically - stable variational procedure . </S>",
    "<S> regularization is achieved by means of a discretization procedure , which can be performed either before or after the perturbation expansion . </S>",
    "<S> we compare the two possibilities , show that they are both valid , and analyze their behavior when applied to a model tight - binding hamiltonian . </S>",
    "<S> lowest - order as well as generic formulas are presented for the derivatives of the total energy , the normalization condition , the eigenequation , and the lagrange parameters . </S>"
  ]
}