{
  "article_text": [
    "in this paper , we develop an arbitrary - order free energy satisfying numerical method for solving the initial boundary value problem of the poisson  nernst  planck ( pnp ) system ,    [ pnp ]",
    "@xmath0    where @xmath1 is the local concentration of @xmath2 charged molecular or ion species with charge @xmath3 ( @xmath4 ) at the spatial point @xmath5 and time @xmath6 , @xmath7 denotes a connected closed domain with smooth boundary @xmath8 , @xmath9 is the electrostatic potential governed by the poisson equation subject to the neumann boundary data @xmath10 and the charge density that consists of both fixed charge @xmath11 and mobile ions , the latter being a linear combination of all the concentrations @xmath12 . here",
    "@xmath13 is the unit outward normal vector on the domain boundary @xmath14 . in this system ,",
    "the diffusion coefficient , the thermal energy and the dielectric coefficient have been normalized in a dimensionless manner .",
    "the side conditions are necessarily compatible , i.e. , @xmath15 for the solvability of the problem .",
    "the pnp system is a mean field approximation of diffusive molecules or ions , and consists of nernst - planck ( np ) equations that describe the drift and diffusion of ion species , and the poisson equation that describes the electrostatics interaction . in the process of charge transport",
    "the fluxes of charge carriers are driven exclusively by processes of diffusion and electric drift .",
    "this description using the flux traces back to nernst @xcite and planck @xcite , and is accurate for modeling systems with point charges",
    ". applications of this system are found in electrical engineering and electronkinetics @xcite , electrochemistry @xcite , and biophysics @xcite .",
    "three main properties of the solution to ( [ pnp ] ) are the non - negativity , mass conservation and the free energy dissipation , i.e. ,    [ str ] @xmath16    where the free energy @xmath17 is defined by @xmath18 the free energy contains both entropic part and the interaction part : @xmath19 is the entropy related to the brownian motion of each ion species , and @xmath20 is the electrostatic potential of the coulomb interaction between charged ions . for the pnp system ,",
    "the density is expected to converge to the equilibrium solution in a closed system ( e.g. @xmath21 ) regardless of how initial data are distributed .",
    "these nice mathematical features are crucial for the analytical study of the pnp system . for instance , by some energy estimate with the control of the free energy dissipation , the solution is shown to converge to the thermal equilibrium state as time becomes large , if the boundary conditions are in thermal equilibrium ( see , e.g. , @xcite ) .",
    "long time behavior was studied in @xcite , and further in @xcite with refined convergence rates .",
    "results for the drift - diffusion model regarding existence and asymptotic studies in the case of different boundary conditions may be found in @xcite .",
    "due to the wide variety of devices modeled by the pnp equations , computer simulation for this system of differential equations is of great interest .",
    "in addition to being more computationally efficient , pnp models more easily incorporate certain types of boundary conditions that arise in physical systems , such as boundaries of fixed concentration or electrostatic potential .",
    "however , the pnp equations present difficulties when computing approximate solutions : it is a strongly coupled system of @xmath22 nonlinear equations , so that computational efficiency plays a critical role in applications of a numerical solver .",
    "the transport equations are often convection - dominated , numerical simulation may produce negative ion concentrations or oscillations in the computed solution , if not properly addressed .    in the literature ,",
    "there are different numerical approximations available for the steady state poisson - nernst - planck equations , see e.g. @xcite .",
    "computational algorithms for time - dependent pnp systems have also been constructed for both one - dimensional and two or three - dimensional models in various chemical / biological applications , and have been combined with the brownian dynamics simulations .",
    "the proposed algorithms range from finite difference methods @xcite to finite element methods @xcite .",
    "many of existing algorithms are introduced to handle specific settings in complex applications , in which one may encounter different numerical obstacles , such as discontinuous coefficients , singular charges , geometric singularities , and nonlinear couplings to accommodate various phenomena exhibited by biological ion channels . for a broader overview of proposed algorithms ,",
    "we refer the interested reader to a recent review article @xcite .    given the existing rich literature ,",
    "the most distinct feature of this work is the use of properties ( [ str]a)-([str]c ) as a guide to design an arbitrary high order algorithm to efficiently simulate the solution at large times .",
    "the most related works to the present one are @xcite and in spirit @xcite .",
    "the second order finite difference method introduced in @xcite satisfies all three properties in ( [ str ] ) at the discrete level . for the class of nonlinear fokker - planck ( nfp ) equations",
    "@xmath23 with the potential @xmath24 given , the high order discontinuous galerkin method introduced in @xcite is shown to satisfy the discrete entropy dissipation law .",
    "if the potential @xmath24 is governed by the poisson equation such as ( [ pnp]b ) , @xmath25 and @xmath26 , then becomes the pnp system with single species .",
    "a finite element method to the pnp system is recently introduced in @xcite using a logarithmic transformation of the charge carrier densities , while the involved energy estimate resembles the physical energy law that governs the pnp system in the continuous case .",
    "the main objective of this work is to develop a high order dg method that incorporates mathematical features ( [ str ] ) to handle the coupling of the poisson equation and the np system so that the numerical solution remains faithful for long time simulations .",
    "the discontinuous galerkin ( dg ) method we present here is a class of finite element methods , using a completely discontinuous piecewise polynomial space for the numerical solution and the test functions .",
    "one main advantage of the dg method is the flexibility afforded by local approximation spaces combined with the suitable design of numerical fluxes crossing cell interfaces .",
    "more general information about dg methods for elliptic , parabolic , and hyperbolic pdes can be found in the recent books and lecture notes see , e.g .",
    "the dg discretization we use here is motivated by the direct discontinuous galerkin ( ddg ) method proposed in @xcite .",
    "the main feature in the ddg schemes lies in numerical flux choices for the solution gradient , which involve higher order derivatives evaluated across cell interfaces .",
    "the entropy satisfying methods recently developed in @xcite are the main references for the present work .",
    "when the potential @xmath27 is a given function , the np system simply reduces to the linear fokker - planck equation @xmath28 for this model the entropy satisfying discontinuous galerkin method was developed in @xcite , which generalizes and improves upon the finite volume method introduced in @xcite .",
    "the idea in @xcite is to apply the dg discretization to the non - logrithmic landau formulation @xmath29 so that the quadratic entropy dissipation law is satisfied .",
    "again based on this non - logrithmic landau formulation , a third order maximum - principle preserving dg scheme was further developed in @xcite .",
    "the main results in this paper include the formulation of an arbitrary - order dg methods , proofs of the discrete free energy dissipation and mass conservation for both semi - discrete and fully discrete dg methods , and an accuracy - preserving limiter to ensure the positivity preserving property for @xmath12 .",
    "numerical results are in excellent agreement with the analysis .",
    "we point out that different boundary conditions are used in applications , and they are important in driving the system out of equilibrium and produce the non - vanishing ionic fluxes . the numerical method presented in this work",
    "can be easily modified to incorporate different boundary conditions , through selection of appropriate boundary fluxes ( see section 2 ) .",
    "the pnp system has many variants by simply altering the definition of the charge carrier flux .",
    "for example , the pnp system coupled with the navier - stokes equation is a basic model in the study of electronkinetics @xcite .",
    "it reduces to simpler models when some of ion species become trivial or steady .",
    "for example , in the case of @xmath30 , if @xmath31 with @xmath32 , we have    [ pnp1 ] @xmath33    it may well be the case that when some species still evolve in time , the others are already at the steady states due to different time scales . for example , in the case of @xmath34 , if @xmath31 and @xmath35 with @xmath36 , we obtain    [ pnp2 ] @xmath37    if all ion species are at the equilibrium states @xmath38 , with @xmath39 so that the total density remains as given initially , the poisson equation thus becomes a poisson - boltzmann equation(pbe ) of the form @xmath40 we should point out that the numerical method presented in this paper may be used as an iterative algorithm to numerically compute the reduced system ( [ pnp2 ] ) and the nonlocal pbe ( [ pbe ] ) , which plays essential roles in chemistry and biophysics . in general , the pbe describes the electrostatic interaction and ionic density distributions of a solvated system at the equilibrium state .",
    "we refer to @xcite for a rigorous study of a nonlocal poisson  boltzmann type equation with a small dielectric parameter as derived from the two - species pnp system .",
    "due to the effectiveness of the pbe for applications in chemistry and biophysics , many solution techniques have been produced in this area and directed to studies of diverse biological processes , see e.g. @xcite .    in a larger context",
    ", the concentration equation also links to the general class of aggregation equations with diffusion @xmath41 which has been widely studied in applications such as biological swarms @xcite and chemotaxis @xcite . for chemotaxis , a wide literature exists in relation to the keller - segel model ( see @xcite and references therein ) . the left - hand - side in ( [ u ] )",
    "represents the active transport of the density @xmath42 associated to a non - local velocity field @xmath43 .",
    "the potential @xmath44 is usually assumed to incorporate attractive interactions among individuals of the group , while repulsive ( anti - crowding ) interactions are accounted for by the diffusion in the right - hand - side .",
    "of central role in studies of model ( [ u ] ) , and also particularly relevant to the present research , is the gradient flow formulation of the equation with respect to the free energy @xmath45=\\int_{\\omega } c \\log c dx -\\frac{1}{2}\\int_{\\omega}\\int_{\\omega } g(x - y)c(x)c(y)dxdy.\\ ] ]      this paper is organized as follows : in section 2 , we present the dg method for the one dimensional case , and discuss how to deal with different types of boundary conditions ; section 3 is devoted to theoretical analysis for both semi - discrete and fully discrete schemes .",
    "we give the details of the numerical algorithm in section 4 , including how to compute the potential @xmath46 , and the positivity preserving limiter .",
    "numerical results are presented in section 5 . finally , concluding remarks are given in section 6 .",
    "further numerical implementation details are given in the appendix .",
    "in this section we present a dg scheme for ( [ pnp ] ) .",
    "we consider a domain @xmath47 $ ] and a mesh , which is not necessarily uniform i.e. , a family of @xmath48 control cells @xmath49 such that @xmath50 with cell center @xmath51 .",
    "we set @xmath52 and @xmath53 .",
    "define the discontinuous finite element space @xmath54 where @xmath55 denotes polynomials of degree at most @xmath56 .",
    "we rewrite the pnp system as follows    [ cqp ] @xmath57    subject to initial data @xmath58 , which are necessarily to meet the compatibility requirement : @xmath59    the dg scheme is to find @xmath60 such that for all @xmath61 , @xmath62 ,    [ dg ] @xmath63    where @xmath64 and @xmath65 , with the flux operator @xmath66 defined by @xmath67}{h } + \\{\\partial_xw\\}+\\beta_1h[\\partial_x^2 w ] . \\ ] ] here we have used the notation : @xmath68=q^+-q^-$ ] , and @xmath69 , where @xmath70 and @xmath71 are the values of @xmath72 from the right and left cell interfaces , respectively . the parameters @xmath73 and @xmath74 in @xmath75 are chosen to enforce the free energy satisfying property .",
    "the details of how to choose @xmath73 and @xmath74 are given and justified in section [ secdgproperty ] .",
    "for the ode system , we prepare initial data @xmath76 by the projection of @xmath77 on the discontinuous finite element space @xmath78 so that @xmath79      the boundary conditions are a critical component of the pnp model and determine important qualitative behavior of the solution .",
    "various boundary conditions may be used with the pnp equations . here",
    "we consider the simplest form of boundary conditions for the concentration and for the electric potential field .",
    "for the concentration , one usually ignores any chemical reactions at the solid boundaries and assumes a no flux condition @xcite , i.e. , @xmath80 however , it should be noted that it is possible to account for reactions through , for example , using the butler ",
    "volmer reaction kinetics @xcite .",
    "the boundary conditions for the electrostatic potential are however not unique and greatly depend on the problem under investigation .",
    "usually , one ends up either specifying the potential or the charge density on the boundary , which corresponds to dirichlet or neumann boundary conditions , respectively ; or using robin boundary conditions which model capacitors at the boundary .",
    "any combination of these boundary conditions can be applied to @xmath24 .",
    "therefore , at the domain boundary the numerical flux needs to be treated with care so that the pre - specified boundary conditions are properly enforced .    to incorporate the boundary condition ( [ pnp]d )",
    ", we set at both @xmath81 and @xmath82 , @xmath83 for other types of boundary conditions , we only need to modify the boundary fluxes accordingly . for instance , for dirichlet boundary conditions of the form @xmath84 we define @xmath85 , @xmath86 , @xmath87 and @xmath88 at the boundary in the following way , @xmath89 where @xmath73 is the penalty parameter to be chosen .      it is straightforward to extend dg formulation ( [ dg ] ) to multi - dimensional spaces",
    ". let @xmath90 be a convex , bounded polygonal domain in @xmath91 .",
    "we partition @xmath90 into computational elements denoted by @xmath92 , and @xmath93 denotes the characteristic length of all the elements of @xmath94 . as usual , we assume the mesh is conforming and the subdivision is regular .",
    "we set the dg finite element space as @xmath95 where @xmath96 is the space of polynomial functions of degree at most @xmath56 on @xmath97 .",
    "with such an approximation space , the semi - discrete dg scheme is to find @xmath60 such that for all @xmath61 , @xmath62 ,    [ dg+ ] @xmath98    where @xmath99 and @xmath100 , with the flux operator @xmath101 defined on the interface @xmath102 by @xmath103}{h_e } + \\{\\partial_n w\\}+\\beta_1h_e[\\partial_n^2 w].\\end{aligned}\\ ] ] here the normal vector @xmath104 is assumed to be oriented from @xmath105 to @xmath106 , sharing a common edge ( face ) @xmath102 , and @xmath107 is the characteristic length of @xmath102 .",
    "@xmath108 and @xmath109 denote the first and second order derivative along direction @xmath104 , respectively .",
    "the average @xmath110 and the jump @xmath111 $ ] of @xmath112 on @xmath102 are as follows : @xmath113= w|_{k_2 } - w|_{k_1 } \\quad \\forall e\\in \\partial k_1\\cap \\partial k_2.\\ ] ] for @xmath102 in the set of boundary edges , each numerical solution has a uniquely defined restriction on @xmath102 , while boundary conditions can be weakly enforced through the boundary fluxes in the same way as in the one - dimensional case ( see section 2.2 ) .",
    "most of the one - dimensional analysis presented in this work can be easily carried over to the multi - dimensional case , as long as both the bound @xmath114 as in ( [ gb ] ) , and some mesh - dependent inverse inequalities such as those in lemma 3.2 can be established . however , for this coupled nonlinear system the implementation of the multi - dimensional algorithm is much more involved , and will be left in future work .",
    "under the zero flux condition for @xmath12 in ( [ pnp]d ) and the evolution law ( [ pnp]a ) , the total mass for each @xmath115 is conserved in the sense that @xmath116 furthermore , assume the dirichlet boundary condition is given and homogeneous , then the stability of the solution to the pnp system is known @xcite to be given by the energy law of the form @xmath117 where the functional , @xmath118 is the energy and @xmath119 is the rate of dissipation . for the neumann boundary conditions , we show the corresponding energy law by a formal calculation .",
    "first , the free energy ( [ free ] ) by the poisson equation can be rewritten as @xmath120 we formally calculate the change rate of each part of the free energy @xmath121 and @xmath122 putting together we obtain @xmath123 for the case of @xmath124 we have @xmath125    in the special case that @xmath21 and @xmath126 , both @xmath127 and @xmath128 are each decreasing in time , with @xmath129 this can be verified by a direct calculation as @xmath130      for some @xmath131 , we define the weighted bilinear operator @xmath132   + \\{v_x\\}[u ] ) \\right)_{j+1/2},\\ ] ] and the associated energy norm @xmath133 ^ 2 \\right)_{j+1/2}.\\ ] ] when @xmath134 , we denote @xmath135 .",
    "we also introduce the notation , @xmath136)}\\frac{2(u(1)-2\\beta_1\\partial_\\xi u(1))^2}{\\int_{-1}^1 w_j(\\xi)u^2(\\xi)d\\xi}\\ ] ] with @xmath137 we recall the following estimates .",
    "[ lem1](cf .",
    "@xcite ) if @xmath138 at each interface @xmath139 , @xmath140 , then @xmath141 for some @xmath142 .",
    "we also have @xmath143 + \\beta_1h[\\partial_x^2])^2}{\\left(\\int_{i_j}+\\int_{i_{j+1}}\\right ) m ( \\partial_x w)^2dx}.\\ ] ]    the additional terms @xmath144 were not used in @xcite ; here we need them to control boundary contributions .    in the case of @xmath134 , the bound @xmath145",
    "is obtained in @xcite : @xmath146 which achieves its minimum @xmath147 at @xmath148 .",
    "we first examine the existence and uniqueness of @xmath46 from solving ( [ dg]c ) .",
    "note that for neumann boundary data , only @xmath149 and @xmath150 are pre - specified so that @xmath151 yet @xmath152 and @xmath153 are not given , the exact solution is unique up to an additive constant .",
    "assume that @xmath154 , then for each given @xmath155 , there exists a unique @xmath46 to ( [ dg]c ) with ( [ flux ] ) and ( [ bpsi ] ) , up to an additive constant .",
    "it suffices to prove the uniqueness since existence is equivalent to uniqueness for this finite dimensional problem .",
    "let @xmath156 for two different solutions @xmath157 , then @xmath158 on the other hand , lemma 3.1 ensures that there exists @xmath159 such that @xmath160_{j+1/2}^2 \\right).\\ ] ] hence @xmath161 must be a constant .",
    "in order to compute a unique @xmath46 , we fix @xmath162 as being given in one dimensional setting , and define    [ fluxpsi+ ] @xmath163    we add ( [ dg]c ) over all @xmath164 and use the modified boundary condition ( [ fluxpsi ] ) to obtain the following @xmath165 where @xmath166 and @xmath167_{x_{1/2 } } + \\sigma_bv_{n+1/2}^-.\\ ] ]    for @xmath168 , and given total charge density @xmath169 , there exists a unique @xmath46 to ( [ dg]c ) with ( [ flux ] ) and the boundary fluxes in ( [ fluxpsi ] ) .    for the same reason as mentioned earlier",
    ", it suffices to prove the uniqueness .",
    "let @xmath170 for two different solutions @xmath171 , then @xmath172 note that @xmath173 provided that @xmath73 is large enough so that @xmath174 ) } \\frac{2u^2(1)}{\\int_{-1}^1 u^2(\\xi)d\\xi}=\\gamma(0 , 1)=k^2.\\ ] ] hence every term on the right of ( [ co ] ) must be zero , which yields @xmath175 .",
    "uniqueness thus follows .",
    "we next prove the conservation of @xmath176 and the semi - discrete free energy dissipation law .",
    "[ thm3.3 ]    * the semi - discrete scheme is conservative in the sense that each total concentration @xmath177 remains unchanged in time , @xmath178 * suppose that @xmath124 and @xmath179 in each @xmath49 , the semi - discrete free energy @xmath180 dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma   \\psi_h ds\\ ] ] satisfies @xmath181 moreover , @xmath182 provided @xmath73 is suitably large , and @xmath183 in @xmath184 defined in ( [ flux ] ) and ( [ bpsi ] ) .",
    "the conservation follows from taking @xmath185 in ( [ dg]a ) with summation over @xmath186 .",
    "2 . set @xmath187 a direct calculation using @xmath188 and the assumption of @xmath189 gives @xmath190dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma \\partial_t \\psi_h ds\\\\      &   =   \\sum_{j=1}^n \\int_{i_j } \\sum_{i=1}^{m } ( \\ln c_{ih}+q_i\\psi_h)\\partial_t{c_{ih } } dx   + \\frac{1}{2 }   \\sum_{j=1}^n \\int_{i_j }   [ \\rho_h \\partial_t \\psi_h - \\partial_t \\rho_{h } \\psi_h ] dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma \\partial_t \\psi_h ds.\\end{aligned}\\ ] ] from ( [ dg]b ) with @xmath191 it follows that @xmath192 summing ( [ dg]a ) in @xmath193 with @xmath194 gives @xmath195 ( \\widehat{p_{ihx } } + \\{p_{ihx}\\ } ) ) _ { j+1/2},\\end{aligned}\\ ] ] since @xmath196 .",
    "next we sum ( [ dg]c ) over all cell index @xmath186 to obtain @xmath197 in one dimensional case ,",
    "@xmath198 taking derivative of ( [ pp ] ) with respect to @xmath6 we also have @xmath199 thus ( [ pp ] ) with @xmath200 subtracted by ( [ pptsd ] ) with @xmath201 gives @xmath202dx + \\int_{\\partial \\omega}\\sigma \\partial_t \\psi_h ds   & = a_1(\\psi_h , \\partial_t \\psi_h ) -",
    "a_1(\\partial_t \\psi_h , \\psi_h ) \\\\   & = \\beta_1 h \\sum_{j=1}^{n-1 } ( [ \\partial_x^2 \\psi_h ]",
    "[ \\partial_t \\psi_h ] -[\\partial_x^2\\partial_t \\psi_h][\\psi_h])_{j+1/2}\\\\   & = 0\\end{aligned}\\ ] ] since @xmath183 in the numerical flux @xmath184 defined in ( [ flux ] ) .",
    "putting all together we obtain @xmath203 ( \\widehat { p_{ihx } } + \\{p_{ihx}\\ } ) ) _ { j+1/2 } \\\\ & = - \\sum_{i=1}^m a_{c_{ih}}(p_{ih } , p_{ih } ) \\\\ & \\leq 0,\\end{aligned}\\ ] ] if at each interface @xmath204 , as shown in lemma [ lem1 ] .",
    "for @xmath205 in the numerical flux formulation ( [ flux ] ) , we use @xmath206 and @xmath183 for @xmath207 . for @xmath208",
    "we need to pick @xmath209 for numerical solutions @xmath176 . for sufficiently small @xmath93 ,",
    "variation of @xmath176 near each interface is relatively bounded by a factor @xmath210 , hence it suffices to choose @xmath211 where ( [ gb ] ) has been used .",
    "for @xmath212 , one choice is @xmath148 so that @xmath213 .",
    "therefore it suffices to take @xmath214 in ( [ flux ] ) for both @xmath207 and @xmath208 .",
    "the choices of @xmath205 in our numerical simulation all fall within the range @xmath206 .      in order to preserve the free energy dissipation law at each time step ,",
    "the time step restriction is needed when using an explicit time discretization .",
    "we now discuss this issue by taking the euler first order time discretization of with uniform time step @xmath215 : find @xmath216 such that for any @xmath61 ,    [ dgeuler ] @xmath217   \\eta dx.\\end{aligned}\\ ] ]    here and in what follows , we use the notation for any function @xmath218 as @xmath219 we recall some basic estimates :    ( cf .",
    "* lemma 3.2 ) ) the following inequalities hold for any @xmath220 :    [ in ] @xmath221 ^ 2_{j+1/2 }   \\leq \\frac{4(k+1)^2}{h } \\sum_{j=1}^n   \\int_{i_j}v^2 dx , \\\\ &",
    "\\sum_{j=1}^{n-1 } \\{v_x\\}^2_{j+1/2 } \\leq \\frac{k^3(k+1)^2(k+2)}{h^2 } \\sum_{j=1}^n   \\int_{i_j}v^2 dx.\\end{aligned}\\ ] ]    based on these estimates we show several properties of the fully discretized scheme .",
    "[ thmeuler ]    * the fully discrete scheme ( [ dgeuler ] ) is conservative in the sense that each total concentration @xmath222 remains unchanged in time , @xmath223 * assume that @xmath224 in each @xmath49 .",
    "there exists @xmath225 such that if the mesh ratio @xmath226 , then the fully discrete free energy @xmath227 dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma   \\psi_h^n ds\\ ] ] satisfies @xmath228 moreover , @xmath229 provided that @xmath73 is suitably large , and @xmath183 in @xmath184 defined in ( [ flux ] ) and ( [ bpsi ] ) .",
    "set @xmath230 and sum over @xmath186 in ( [ dgeuler ] ) to obtain    [ dgeuler+ ] @xmath231    \\1 .",
    "taking @xmath185 in ( [ dgeuler+]a ) yields .",
    "+ 2 . taking @xmath232 in ( [ dgeuler+]a ) , and @xmath233 in ( [ dgeuler+]b ) , respectively , and summing over @xmath234 , we obtain @xmath235 and @xmath236 from ( [ dgeuler+]c ) we see that @xmath237 this with @xmath238 and @xmath239 yields @xmath240 these relations lead to @xmath241 note that ( [ dgeuler+]c ) with @xmath242 subtracted by ( [ ppt ] ) with @xmath243 gives @xmath244dx + \\int_{\\partial \\omega}\\sigma (     \\psi_h^{n+1}-\\psi_h^n ) ds \\\\   &   \\quad = a_1(\\psi_h^n , \\psi_h^{n+1}-\\psi_h^n ) - a_1(\\psi_h^{n+1}-\\psi_h^n , \\psi_h^n)=0.\\end{aligned}\\ ] ] also taking @xmath245 in ( [ ppt ] ) we obtain @xmath246 adding these up leads to @xmath247 with ( [ aa ] ) and ( [ bb ] ) we proceed to evaluate @xmath248 dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma   ( \\psi_h^{n+1 } -\\psi_h^n)ds\\\\ & \\qquad +    \\frac{1}{2 } \\int_{\\omega } ( \\rho_h^{n+1 } \\psi_h^{n+1 } -\\rho_h^n \\psi_h^n ) dx\\\\   & = \\sum_{i=1}^m\\int_{\\omega } \\log c_{ih}^n ( c^{n+1}_{ih } -c^{n}_{ih})dx + \\sum_{i=1}^m\\int_{\\omega}c^{n+1}_{ih } \\log \\left(\\frac{c_{ih}^{n+1}}{c_{ih}^{n}}\\right)dx\\\\ & \\qquad   + \\frac{1}{2}a_{1}(\\psi_{h}^{n+1}-\\psi_h^n ,   \\psi_h^{n+1}+\\psi_h^n ) \\\\ & = -\\delta t \\sum_{i=1}^m a_{c_{ih}^n}(p_{ih}^n , p_{ih}^n ) + \\sum_{i=1}^m\\int_{\\omega}c^{n+1}_{ih } \\log \\left(\\frac{c_{ih}^{n+1}}{c_{ih}^{n}}\\right)dx + \\frac{1}{2}a_{1}(\\psi_{h}^{n+1}-\\psi_h^n ,   \\psi_h^{n+1}-\\psi_h^n)\\\\ & = - \\delta t \\sum_{i=1}^m a_{c_{ih}^n}(p_{ih}^n , p_{ih}^n)+ \\sum_{i=1}^m\\int_{\\omega}c^{n}_{ih } \\log \\left(\\frac{c_{ih}^{n+1}}{c_{ih}^{n}}\\right)dx+g^n \\\\ & \\leq   - \\delta t \\sum_{i=1}^m a_{c_{ih}^n}(p_{ih}^n , p_{ih}^n ) + g^n , \\ ] ] where the non - positivity of the second term is based on @xmath249 and the conservation of @xmath250 . here",
    "@xmath251 which is non - negative , yet small .",
    "it remains to figure out a sufficient restriction on the mesh ratio @xmath252 so that @xmath253 in ( [ dgeuler+]a ) , we take @xmath254 and use the young inequality @xmath255 to obtain @xmath256 + \\",
    "{ \\partial_x v_i\\}[p^n_{ih}]\\right )      \\right|_{x_{j+\\frac12}}\\\\ & \\leq \\frac{1}{4\\epsilon_1h^2 } \\sum_{j=1}^n \\int_{i_j } ( c_{ih}^n)^2   |\\partial_xp_{ih}^n|^2 \\,dx + \\epsilon_1 h^2 \\sum_{j=1}^n \\int_{i_j } |\\partial_x v_i| ^2\\,dx\\\\     & +   \\frac{1}{4\\epsilon_2h } \\sum_{j=1}^{n-1 } \\left.\\{c_{ih}^n \\}^2 |\\widehat{\\partial_xp^n_{ih}}|^2 \\right|_{x_{j+\\frac12 } } + \\epsilon_2h \\sum_{j=1}^{n-1}\\left . { [ v_i]^2}\\right|_{x_{j+\\frac12 } } \\\\     & + \\frac{1}{4\\epsilon_3h^3 } \\sum_{j=1}^{n-1 } \\left.\\{c_{ih}^n \\}^2 [ p^n_{ih}]^2\\right|_{x_{j+\\frac12 } }   + \\epsilon_3h^3 \\sum_{j=1}^{n-1 } \\left.\\{\\partial_xv_i\\}^2\\right|_{x_{j+\\frac12 } } .\\end{aligned}\\ ] ] the use of inequalities ( [ in ] ) in lemma 3.2 leads to @xmath257 ^ 2}\\right|_{x_{j+\\frac12 } }      + \\epsilon_3h^3   \\sum_{j=1}^{n-1}\\left .",
    "[ \\partial_xv_i]^2 \\right|_{x_{j+\\frac12 } } \\\\    &     \\leq(k+1)^2    ( k(k+2 ) \\epsilon_1 + 4\\epsilon_2 + k^3(k+2 ) \\epsilon_3 )      \\sum_{j=1}^n\\int_{i_j } v_i^2\\ , dx \\\\      & = \\frac{3}{4 }   \\sum_{j=1}^n\\int_{i_j } v_i^2\\ , dx ,   \\end{aligned}\\ ] ] if we choose @xmath258 as @xmath259 this gives @xmath260 ^ 2\\right|_{x_{j+\\frac12}}+\\frac{4(k+1)^2}{h}\\sum_{j=1}^{n-1 } \\left.\\{c_{ih}^n\\}^2 |\\widehat{\\partial_xp^n_{ih}}|^2 \\right|_{x_{j+\\frac12}}.\\end{aligned}\\ ] ] it is clear that the first two terms are bounded by @xmath261 .",
    "we next show that the last term is also bounded by @xmath262 , up to constant multiplication factors . note that @xmath263}{h}+\\beta_1h[\\partial_x^2p^n_{ih}]\\right|^2\\\\ & \\leq   2   \\left(\\beta_0 ^ 2\\frac{[p^n_{ih}]^2}{h^2}+\\left(\\{\\partial_xp^n_{ih}\\}+\\beta_1h[\\partial_x^2p^n_{ih } ] \\right)^2 \\right).\\end{aligned}\\ ] ] from ( [ g1 m ] )",
    "it follows that @xmath264\\right)^2\\right|_{x_{j+\\frac12 } }   \\leq \\frac { \\gamma(\\beta_1 , c_{ih}^n ) } { 2h } \\left(\\int_{i_j}+\\int_{i_{j+1}}\\right)c_{ih}^n |\\partial_xp_{ih}|^2dx.\\ ] ] hence @xmath265 upon insertion into ( [ inv ] ) we obtain @xmath266 where @xmath267 note that @xmath268 if the mesh ratio satisfies @xmath269 it remains to bound @xmath270 . from ( [ ppt ] )",
    "it follows that for @xmath271 , @xmath272 note that @xmath273 is a symmetric bilinear operator ( since @xmath183 in ( [ flux ] ) for @xmath46 ) , and also that @xmath274 if and only if @xmath275 , therefore @xmath276 is positive .",
    "a simple rescaling suggests that @xmath42 is also independent of @xmath93 .",
    "hence @xmath277 , which when inserted into ( [ ppt+ ] ) , set @xmath278 , leads to @xmath279 as long as the time step also satisfies @xmath280 collecting the above estimates on @xmath281 we obtain ( [ gn ] ) , if we take @xmath282 this ends the proof .    in theorem [ thmeuler ] ,",
    "@xmath283 is assumed to be positive in each cell @xmath49 to make @xmath284 well defined .",
    "in numerical simulations , we enforce this by imposing a limiter defined in , based on positive cell averages . as shown in @xcite ,",
    "such a limiter does not destroy the order of accuracy .",
    "moreover , positivity of cell averages for each @xmath176 is achieved for @xmath285 and @xmath286 when the coupling potential @xmath24 is zero . for the general pnp system",
    ", we numerically identify parameter pairs @xmath205 so that cell averages remain positive , as confirmed in example 1 .    in our numerical simulation with @xmath287 , we use the second order explicit runge - kutta method ( rk2 , also called heun s method ) for time discretization to solve the ode system of the form @xmath288 : @xmath289    [ corollary1 ] consider the rk2 time discretization . assume that @xmath290 and the intermediate states @xmath291 and @xmath292 are all positive in each @xmath49 .",
    "there exists @xmath225 such that if the mesh ratio @xmath226 , then the fully discrete free energy @xmath293 dx + \\frac{1}{2}\\int_{\\partial \\omega}\\sigma   \\psi_h^n ds\\ ] ] satisfies @xmath294 provided that @xmath73 is suitably large , and @xmath183 in @xmath184 defined in ( [ flux ] ) and ( [ bpsi ] ) .    from ( [ ff ] ) in theorem [ thmeuler ]",
    "it follows that @xmath295 note from ( [ dgeuler+ ] ) , @xmath296 can also be written as @xmath297 hence @xmath298dx+ \\frac{1}{2 }   a_1\\left(\\frac{1}{2}\\psi_{h}^n + \\frac{1}{2}\\psi_{h}^{*},\\frac{1}{2}\\psi_{h}^n + \\frac{1}{2}\\psi_{h}^{*}\\right),\\ ] ] where by , we have used @xmath299 using the fact that @xmath300 is a convex functional in @xmath112 in the sense that @xmath301,\\ ] ] which may be verified by the following identity @xmath302 and @xmath303 from ( [ amv ] ) .",
    "thus @xmath304 since @xmath305 is convex in @xmath42 , we also have @xmath306 equations and imply that @xmath307 this together with ( [ fs ] ) leads to @xmath308 , as claimed .",
    "corollary [ corollary1 ] suggests that the dg scheme ( [ dg ] ) with the time evolution by the strong stability preserving ( ssp ) runge - kutta method @xcite does not increase the free energy at each time step , as long as the time step is suitably small .",
    "hence high order ssp runge - kutta time discretization can be used for high order dg simulations , e.g. , @xmath309 .",
    "the time step restriction @xmath310 is obviously a drawback of the explicit time discretization .",
    "usually one would use implicit in time discretization for diffusion and explicit time discretization for the nonlinear drift term ( called imex in the literature ) so that the time step restriction could be relaxed .",
    "unfortunately , formulation ( [ cqp ] ) does not support such a separation .",
    "if we start with initial data @xmath311 , already at steady states , i.e. , @xmath312 , it follows from ( [ dgeuler]b ) that @xmath313 .",
    "furthermore , ( [ dgeuler]a ) implies that @xmath314 , which when inserted into ( [ dgeuler]c ) gives @xmath315 ( up to an constant , fixed to @xmath316 ) ; hence @xmath317 by induction we have @xmath318 this says that the dg scheme ( [ dgeuler ] ) preserves steady states .",
    "moreover , we can show that in some cases the numerical solution tends asymptotically toward a steady state , independent of initial data .",
    "more precisely , we have the following result .",
    "let the assumptions in theorem [ thmeuler ] be met , and @xmath319 be the numerical solution to the fully discrete dg scheme ( [ dgeuler ] ) , then the limits of @xmath320 as @xmath321 satisfy @xmath322 where @xmath323 are some constants .",
    "since @xmath296 is non - increasing and bounded from below , we have @xmath324 observe from ( [ fdeuler ] ) that @xmath325 when passing to the limit @xmath321 we have @xmath326 .",
    "this and the coercivity of @xmath327 imply the limit of @xmath328 , denoted by @xmath329 , must be constant in each computational cell and the whole domain .",
    "these when inserted into ( [ dgeuler]b ) gives the desired result .",
    "the proof is complete .",
    "in order to compute a unique @xmath46 , we fix @xmath162 as being given , and define    [ fluxpsi ] @xmath330    we add ( [ dg]c ) over all @xmath164 and use the modified boundary condition ( [ fluxpsi ] ) to obtain the following @xmath331 where @xmath332_{x_{1/2 } } \\ ] ] and @xmath333_{x_{1/2 } } + \\sigma_bv_{n+1/2}^-.\\ ] ]    for @xmath168 , and @xmath155 given , there exists a unique @xmath46 to ( [ dg]c ) with ( [ flux ] ) and the boundary fluxes in ( [ fluxpsi ] ) .    for the same reason as mentioned earlier",
    ", it suffices to prove the uniqueness .",
    "let @xmath170 for two different solutions @xmath171 , then @xmath172 note that @xmath173 provided that @xmath73 is large enough so that @xmath174 ) } \\frac{2u^2(1)}{\\int_{-1}^1 u^2(\\xi)d\\xi}=\\gamma(0 , 1)=k^2.\\ ] ] hence every term on the right of ( [ co ] ) must be zero , which yields @xmath175 .",
    "uniqueness thus follows .",
    "the above result provides a guide for the choices of @xmath205 in numerically solving the poisson equation .",
    "we shall take @xmath183 in solving the poisson equation so that to also ensure the entropy dissipation property ( see theorem [ thm3.3 ] ) , hence it suffices to take @xmath334 .      in the scheme formulation involving the projection of @xmath335 , concentrations",
    "@xmath176 needs to be strictly positive at each time step , and we follow @xcite to enforce positivity through some accuracy - preserving limiter based on positive cell averages .",
    "let @xmath336 be an approximation to a smooth function @xmath337 , with cell averages @xmath338 for @xmath339 being some small positive parameter or zero .",
    "we then consider another polynomial in @xmath340 so that @xmath341 this reconstruction maintains same cell averages and satisfies @xmath342    [ cf .",
    "@xcite ] if @xmath338 , then @xmath343 satisfies the estimate @xmath344 where @xmath345 is a constant depending on @xmath56 .",
    "this says that the reconstructed @xmath346 in does not destroy the accuracy when @xmath347 .",
    "we start with positive initial data @xmath348 so that the cell averages are bigger than @xmath349 for @xmath350 .",
    "let @xmath176 be an numerical approximation of @xmath12 of order @xmath351 , but non - necessarily positive in @xmath49 .",
    "assume the cell average @xmath352 , we may reconstruct another polynomial in @xmath78 so that @xmath353 this reconstruction maintains the cell average and satisfies @xmath354    [ cf .",
    "@xcite ] if @xmath355 , then the reconstruction satisfies the estimate @xmath356 where @xmath345 is a constant depending on @xmath56 .",
    "this says that the reconstructed @xmath357 in does not destroy the accuracy when @xmath347 .",
    "the algorithm can be summarized in following steps .    *",
    "( initialization ) project @xmath358 onto @xmath78 , as formulated in ( [ proj ] ) , to obtain @xmath359 . * ( reconstruction ) from @xmath290 , apply , if necessary , the reconstruction to @xmath360 to ensure that in each cell @xmath361 . *",
    "( poisson solver ) solve ( [ dg]c ) to obtain @xmath362 subject to the modified boundary fluxes ( [ fluxpsi ] ) . *",
    "( projection ) solve ( [ dg]b ) to obtain @xmath328 . * ( update ) solve ( [ dg]a ) to update @xmath363 with some runge - kutta ( rk ) ode solver . * repeat steps 2 - 5 until final time @xmath364 .",
    "the implementation details are deferred to appendix a.",
    "in this section , we present a selected set of examples in order to numerically validate our ddg scheme . in  5.1 , we construct an example with exact solution known , and examine the order of accuracy by numerical convergence tests , while we quantify @xmath365 errors defined by @xmath366 with the integral on @xmath49 evaluated by a @xmath367-point gaussian quadrature method and @xmath368 being the exact solution .",
    "long time simulation is also performed to illustrate how the positivity of cell averages propagates when using proper choices of @xmath205 .",
    " 5.2 is devoted to demonstrate the mass conservation , energy dissipation and preservation of the steady state . in  5.3 and  5.4",
    ", we apply the ddg scheme to a non - monovalent system and a reduced single species system .      in @xmath369 $ ]",
    ", we consider @xmath370 with @xmath371 this system , with @xmath32 and @xmath372 , admits exact solutions @xmath373 we also set @xmath374 to pick out a particular solution since @xmath24 is unique up to an additive constant .",
    "this extra condition is numerically enforced according to .",
    "we first test positivity of cell averages for @xmath375 polynomials with @xmath376 in ( [ flux ] ) for @xmath377 .",
    "note that the reconstruction is necessary in this example since @xmath378 at @xmath379 .",
    "our simulation with the reconstruction up to @xmath380 indicates that the cell averages remain positive .",
    "table [ tab : ex1lt ] displays both @xmath365 errors and orders of convergence when using @xmath381 elements at @xmath382 .",
    "we observe that order of convergence is roughly of @xmath383 .",
    "figure [ fig : ex1 ] shows the numerical solution at different times . in the top of figure",
    "[ fig : ex1 ] , we observe that the numerical solutions ( dots ) match the exact solutions ( solid line ) at @xmath384 very well . at @xmath385 ,",
    "our numerical approximation still captures the solution profile very well when the magnitude of the concentrations is close to zero ( @xmath386 ) . in the presence of the source terms @xmath387 and @xmath388 , one should not expect to have either mass conservation or free energy decay .",
    ".error table of example 1 at @xmath389 [ cols=\"^,<,^,^,^,^,^,^\",options=\"header \" , ]     [ fig : ex4 ]",
    "in this paper , we developed an arbitrary high order dg method to solve initial boundary value problems for the poisson - nernst - planck system , which is a mean field type model for concentrations of chemical species .",
    "the semi - discrete dg method has been shown to conserve the mass and satisfy the corresponding discrete free energy dissipation law .",
    "the fully discrete dg method with the euler forward time discretization also satisfies the free energy dissipation law under a restriction on the time step relative to the square of the spatial mesh size .",
    "moreover , the free energy does not increase at each time step for the rk2 method ( [ rk2 ] ) as well as for the strong stability preserving ( ssp ) runge - kutta method of any high order .",
    "the method also preserves the steady states .",
    "these nice properties are also confirmed by our numerical tests .",
    "for proper choices of numerical flux parameters @xmath205 in our numerical experiments , we find that each cell average remains positive if it is initially positive .",
    "this is needed to update numerical solutions at each time step so they are positive . in future work",
    "we will apply our method to multi - dimensional problems and explore more efficient ways to preserve positivity of numerical solutions .",
    "this work was supported by the national science foundation under grant dms1312636 and by nsf grant rnms ( ki - net ) 1107291 .        the @xmath56th order basis functions in a 1-d standard reference element @xmath390 $ ] are taken as the legendre polynomials @xmath391 .",
    "the numerical solutions @xmath392 , @xmath393 and @xmath394 in each cell @xmath49 , after dropping subscript @xmath93 for convenience , can be expressed as @xmath395 using the map @xmath396 , with notation @xmath397 and @xmath398 .",
    "with such an expression , the numerical fluxes at @xmath139 become @xmath399 this when substituted into ( [ dg]c ) gives @xmath400 where @xmath401 here @xmath402-point gauss quadrature rule on the interval @xmath403 is used to integrate @xmath404 .",
    "we choose @xmath405 points so that the quadrature rule has accuracy of at least @xmath406 order .",
    "boundary conditions are specified in section [ bc ] .",
    "note that the resulting @xmath407 matrix is a sparse block matrix , which can be inverted efficiently",
    ".      finally we simplify ( [ dg]a ) to get the following ode system @xmath409 where @xmath410 here @xmath411 in the evaluation of @xmath412 , we choose @xmath413 points . in implementation , since @xmath414 , we simply use @xmath415 gaussian quadrature points in integrating both @xmath11 and @xmath416 .    at two end cells , @xmath412 is still valid . the zero flux conditions ( [ pnp]d ) are used to obtain @xmath417 and @xmath418 , i.e. , at @xmath419 , we use @xmath420 , and at @xmath421 we use @xmath422 .",
    "the discrete ode system is then solved by the rk2 method ( [ rk2 ] ) .",
    "f. brezzi , l. marini , s. micheletti , p. pietra , r. sacco and s. wang .",
    "discretization of semiconductor device problems .",
    "i. handbook of numerical analysis , vol .",
    "anal . 13:317441 , 2005 .",
    "kurnikova , r.d .",
    "coalson , p. graf and a. nitzan . a lattice relaxation algorithm for three- dimensional poisson - nernst - planck theory with application to ion transport through the gramicidin a channel . 76:642656 , 1999 .",
    "b. lu , y.c .",
    "zhou , g.a .",
    "huber , s.d .",
    "bond , m.j . holst and j.a .",
    "electrodiffusion : a continuum modeling framework for biomolecular systems with realistic spatiotemporal resolution . 127:135102 , 2007 .",
    "discontinuous galerkin methods : general approach and stability . in _ numerical solutions of partial differential equations _ , adv",
    ". courses math .",
    "crm barcelona , pages 149201 .",
    "birkhuser , basel , 2009 .",
    "t.  sokalski , p.  lingenfelter and a.  lewenstam . numerical solution of the coupled nernst - planck and poisson equations for liquid junction and ion selective membrane potentials .",
    ", 107(11):24432452 , 2003 ."
  ],
  "abstract_text": [
    "<S> we design an arbitrary - order free energy satisfying discontinuous galerkin ( dg ) method for solving time - dependent poisson - nernst - planck systems . </S>",
    "<S> both the semi - discrete and fully discrete dg methods are shown to satisfy the corresponding discrete free energy dissipation law for positive numerical solutions . </S>",
    "<S> positivities of numerical solutions are enforced by an accuracy - preserving limiter in reference to positive cell averages . </S>",
    "<S> numerical examples are presented to demonstrate the high resolution of the numerical algorithm and to illustrate the proven properties of mass conservation , free energy dissipation , as well as the preservation of steady states . </S>"
  ]
}