{
  "article_text": [
    "prediction of the future state of complex systems is a fundamental challenge of science and engineering , and ultimately integral to the functioning of society .",
    "some of these systems include weather @xcite , health @xcite , the economy @xcite , marketing @xcite and transportation @xcite . for weather in particular , predictions are made using supercomputers integrating numerical weather models , projecting our current best guess of the atmospheric state into the future .",
    "the accuracy of these predictions depends on the accuracy of the models themselves , and the quality of our knowledge of the current state of the atmosphere .",
    "model accuracy has improved with better meteorological understanding of weather processes and advances in computing technology @xcite . to solve the initial value problem ,",
    "techniques developed over the past 50 years are now broadly known as _ data assimilation _ ( da ) .",
    "formally , data assimilation is the process of using all available information , including short - range model forecasts and physical observations , to estimate the current state of a system as accurately as possible @xcite .",
    "the best - guess of the current state is often referred to as the _ analysis _ state .    here , we employ a fluid dynamics experiment as a test bed for improving numerical weather prediction algorithms , focusing specifically on data assimilation methods .",
    "our approach is inspired by the historical development of current methodologies , and provides a tractable system for rigorous analysis .",
    "the experiment is a thermal convection loop , which by design simplifies our problem into the prediction of natural convection .",
    "the thermosyphon , a type of natural convection loop or non - mechanical heat pump , can be likened to a toy model of climate @xcite .",
    "the dynamics of thermal convection loops have been explored under both periodic @xcite and chaotic @xcite regimes . a full characterization of the computational behavior of a loop under flux boundary conditions by louisos et .",
    "al . describes four regimes : chaotic convection with reversals , high rayleigh number ( ra ) aperiodic stable convection , steady stable convection , and conduction / quasi - conduction @xcite . for the remainder of this work , we focus on the chaotic flow regime",
    "the reduced order system describing a thermal convection loop was originally derived by gorman @xcite and ehrhard and mller @xcite .",
    "here we present this three dimensional system in non - dimensionalized form . in appendix b",
    ", we present a more complete derivation of these equations , following the derivation of harris @xcite . for the mean fluid velocity @xmath0",
    ", temperature difference between the 3 oclock and 9 oclock positions @xmath1 ( also referred to presently as @xmath2 ) , and deviation from conductive temperature profile @xmath3 , these equations are : @xmath4 the function @xmath5 is a defined piece - wise analytic polynomial , and is provided in the full derivation as equation [ eq : h_defined ] . the parameters @xmath6 , @xmath7 , and @xmath8 , along with scaling factors for time and each model variable can be fit to data using standard parameter estimation techniques",
    ".    operated by dave hammond , uvm s scientific electronics technician , the experimental thermosyphons access the chaotic regime of state space found in the principled governing equations .",
    "we quote the detailed setup from darcy glenn s undergraduate thesis @xcite and provide fig .",
    "[ fig : thermosyphon - schematic ] for details of the experiment :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the [ thermosyphon ] is a bent semi - flexible plastic tube with a 10-foot heating rope wrapped around the bottom half of the upright circle .",
    "the tubing used is light - transmitting clear thv from mcmaster - carr , with an inner diameter of 7/8 inch , a wall thickness of 1/16 inch , and a maximum operating temperature of 200f .",
    "the outer diameter of the circular thermosyphon is 32.25 inches .",
    "together , the tubing inner diameter and outer diameter of the thermosyphon produce a ratio of approximately 1:36 .",
    "there are 1 inch windows when the heating cable is coiled in a helix pattern around the outside of the tube , so the heating is not exactly uniform .",
    "the bottom half is then insulated using aluminum foil , which allowed fluid in the bottom half to reach 176f .",
    "a forcing of 57 v , or 105 watts , is required for the heating cable so that chaotic motion is observed .",
    "temperature is measured at the 3 oclock and 9 oclock positions using unsheathed copper thermocouples from omega . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we confirm that the experiment accesses the chaotic regime of state space using a time series of the temperature difference as measured at the 3 oclock and 9 oclock positions in fig . [",
    "fig : thermosyphon - physical - timeseries ] .",
    "we first test our ability to predict this experimental thermosyphon using synthetic data .         and inner radius by @xmath9 .",
    "the top temperature is labeled @xmath10 and bottom temperature @xmath11 , gravity @xmath12 is defined downward , the angle @xmath13 is prescribed from the 6 oclock position , and temperature difference between 3 oclock and 9 oclock positions @xmath2 is labeled . , scaledwidth=45.0% ]    we perform all computational simulations of the thermal convection loop with the open - source finite volume c++ library openfoam @xcite .",
    "the open - source nature of this software enables its integration with the data assimilation framework that our present work provides .",
    "we consider the incompressible navier - stokes equations with the boussinesq approximation to model the flow of water inside a thermal convection loop . for brevity , we omit the equations themselves , and include them in the appendix .",
    "the solver in openfoam that we use , with some modification , is ` buoyantboussinesqpimplefoam ` . solving is accomplished by the pressure - implicit split operator ( piso ) algorithm @xcite .",
    "we find that modification of the code is necessary for laminar operation .",
    "we create both 2-dimensional and 3-dimensional meshes using openfoam s native meshing utility ` blockmesh ` shown in figures [ fig : cfdmesh1 ] and [ fig : cfdmesh2 ] . after creating a mesh , we refine the mesh near the walls to capture boundary layer phenomena and renumber the mesh for solving speed .",
    "we use the ` refinewallmesh ` utility to refine the mesh near walls , and the ` renumbermesh ` utility to renumber the mesh .",
    "the resulting 2d mesh contains 80,000 points ( 80 across the diameter and 1000 around ) .",
    "available boundary conditions ( bcs ) we find to be stable in openfoam s solver are constant gradient , fixed value conditions , and turbulent heat flux .",
    "constant gradient simulations are stable , but the behavior is empirically different from our physical system . while it is possible that a fixed value bc is acceptable due to the thermal diffusivity and thickness of the walls of the experimental setup , we find that this is also inadequate .",
    "simulations with a turbulent heat flux bc implemented through the ` externalwallheatfluxtemperature ` library are unstable with the laminar turbulence model we use and resulted in physically unrealistic results .",
    "we employ the third - party library ` groovybc ` to use a gradient condition that computes the flux using a fixed external temperature @xmath14 and fixed wall heat transfer coefficient @xmath15 as @xmath16 where we choose @xmath15 to be the reference value for aluminum ( the material used in the experimental setup ) .    with the mesh , bcs , and solver chosen",
    ", we now simulate the flow . from the data of @xmath17 and @xmath18 that are saved at each timestep ( temperature , cell face flux , velocity , and pressure , respectively ) , we extract the mass flow rate and average temperature at the @xmath19 and @xmath20 oclock positions on the loop .",
    "since @xmath13 is saved as a face - value flux , we compute the mass flow rate over the cells @xmath21 of top ( 12 oclock ) slice as @xmath22 where @xmath23 corresponds the face perpendicular to the loop angle at cell @xmath21 and @xmath24 is reconstructed from the boussinesq approximation @xmath25 .",
    "we perform initial tests of the data assimilation algorithms described here with the lorenz 63 system , which is analogous to the above equations with lorenz s @xmath26 , and @xmath27 .",
    "the canonical choices of @xmath28 and @xmath29 produce the well known butterfly attractor , and we use these values for all examples here . from these tests",
    ", we will find the optimal data assimilation parameters ( inflation factors ) for predicting time series with this system .",
    "having done so , we then focus our efforts on making prediction using computational fluid dynamics models .",
    "we first implement the 3d - var filter .",
    "simply put , 3d - var is the variational ( cost - function ) approach to finding the analysis .",
    "it has been shown that 3d - var solves the same statistical problem as optimal interpolation ( oi ) @xcite .",
    "the usefulness of the variational approach comes from the computational efficiency , when solved with an iterative method .",
    "specifically , the multivariate 3d - var amounts to finding the @xmath30 that minimizes the cost function @xmath31    next , we implement the `` gold - standard '' extended kalman filter ( ekf ) .",
    "the tangent linear model ( tlm ) is precisely the model ( written as a matrix ) that transforms a perturbation at time @xmath32 to a perturbation at time @xmath33 , analytically equivalent to the jacobian of the model . using the notation of kalnay @xcite",
    ", this amounts to making a forecast with the nonlinear model @xmath34 , and updating the error covariance matrix @xmath35 with the tlm @xmath36 , and adjoint model @xmath37 :    @xmath38,\\\\ { \\mathbf{p}}^f ( t_i ) & = l_{i-1 } { \\mathbf{p}}^a ( t_{i-1 } ) l^t _ { i-1 } + \\mathbf{q } ( t_{i-1 } ) \\end{aligned}\\ ] ]    where @xmath39 is the noise covariance matrix ( model error ) . in the experiments with lorenz 63 presented in this section , @xmath40 since our model is perfect . in numerical weather prediction , @xmath39 must be approximated , e.g. , using statistical moments on the analysis increments @xcite .",
    "the analysis step is then written as ( for @xmath41 the observation operator ) : @xmath42 where @xmath43\\ ] ] is the innovation .",
    "we compute the kalman gain matrix to minimize the analysis error covariance @xmath44 as @xmath45 ^{-1}\\ ] ] where @xmath46 is the observation error covariance .",
    "since we are making observations of the truth with random normal errors of standard deviation @xmath47 , the observational error covariance matrix @xmath48 is a diagonal matrix with @xmath49 along the diagonal .",
    "the most difficult ( and most computationally expensive ) part of the ekf is deriving and integrating the tlm .",
    "for this reason , the ekf is not used operationally , and later we will turn to statistical approximations of the ekf using ensembles of model forecasts . with our cfd model",
    "we have no such tlm , and we provide more detail on the tlm approaches applicable to the lorenz 63 system in appendix c.    the computational cost of the ekf is mitigated through the approximation of the error covariance matrix @xmath50 from the model itself , without the use of a tlm .",
    "one such approach is the use of a forecast ensemble , where a collection of models ( ensemble members ) are used to statistically sample model error propagation . with ensemble members spanning the model analysis error space , the forecasts of these ensemble members",
    "are then used to estimate the model forecast error covariance .",
    "the only difference between this approach and the ekf , in general , is that the forecast error covariance @xmath51 is computed from the ensemble members , without the need for a tangent linear model : @xmath52    the etkf introduced by bishop is one type of square root filter , and we present it here to provide background for the formulation of the letkf @xcite . for a square root filter in general ,",
    "we begin by writing the covariance matrices as the product of their matrix square roots .",
    "because @xmath53 and @xmath50 are symmetric positive - definite ( by definition ) , we can write @xmath54    where @xmath55 and @xmath56 are the matrix square roots of @xmath53 and @xmath50 . we are not concerned that this decomposition is not unique , and note that @xmath57 must have the same rank as @xmath35 which will prove computationally advantageous . the power of the srf is now seen as we represent the columns of the matrix @xmath56 as the difference from the ensemble members from the ensemble mean , to avoid forming the full forecast covariance matrix @xmath50 .",
    "the ensemble members are updated by applying the model @xmath34 to the states @xmath56 such that an update is performed by @xmath58 to summarize , the steps for the etkf are to ( 1 ) form @xmath59 , assuming that computing @xmath60 is easy , and ( 2 ) compute its eigenvalue decomposition , and apply it to @xmath56 .",
    "the lekf implements a strategy that becomes important for large simulations : localization .",
    "namely , the analysis is computed for each grid - point using only local observations , without the need to build matrices that represent the entire analysis space .",
    "localization removes long - distance correlations from @xmath61 and allows greater flexibility in the global analysis by allowing different linear combinations of ensemble members at different spatial locations @xcite .",
    "the general formulation of the lekf by ott goes as follows , quoting directly from @xcite :    1 .   globally",
    "advance each ensemble member to the next analysis timestep .",
    "steps 25 are performed for each grid point .",
    "2 .   create local vectors from each ensemble member .",
    "project that point s local vectors from each ensemble member into a low dimensional subspace as represented by perturbations from the mean .",
    "4 .   perform the data assimilation step to obtain a local analysis mean and covariance .",
    "generate local analysis ensemble of states .",
    "form a new global analysis ensemble from all of the local analyses . 7 .",
    "wash , rinse , and repeat .",
    "proposed by hunt _",
    "et al._(2007 ) with the stated objective of computational efficiency , the letkf is named from its most similar algorithms from which it draws @xcite . with the formulation of the lekf and the etkf given",
    ", the letkf can be described as a synthesis of the advantages of both of these approaches .",
    "the letkf is the method sufficiently efficient for implementation on the full openfoam cfd model of 240,000 model variables , and so we present it in more detail and follow the notation of hunt _ et al._(2007 ) . as in the lekf",
    ", we explicitly perform the analysis for each grid point of the model .",
    "the choice of observations to use for each grid point can be selected a priori , and tuned adaptively . starting with a collection of background forecast vectors @xmath62 , we perform steps 1 and 2 in a global variable space , then steps 38 for each grid point :    1",
    ".   apply @xmath41 to @xmath63 to form @xmath64 , average the @xmath65 for @xmath66 , and form @xmath67 .",
    "2 .   similarly form @xmath68 . now for each grid point : 3 .",
    "form the local vectors .",
    "4 .   compute @xmath69 ( perhaps by solving @xmath70 .",
    "5 .   compute @xmath71 where @xmath72 is a tun - able covariance inflation factor .",
    "compute @xmath73 .",
    "compute @xmath74 and add it to the column of @xmath75 .",
    "multiply @xmath68 by each @xmath76 and add @xmath77 to get @xmath78 to complete each grid point .",
    "combine all of the local analysis into the global analysis .",
    "we implement the letkf on our mesh using the full 80 cells across with zone sizes of center 10 , and sides 15 , resulting in 3200 local variables for 100 zones . in parallel",
    ", these 100 local computations can all be carried out simultaneously over an arbitrary number of processors .",
    "using the `` square '' sections of the loop to localize , we shift the zone to the left or right to follow the dominate flow direction at the center of that local window . in fig .",
    "[ fig : covariance - localization - schematic ] a schematic of localization using square , circular , and adaptive location shows a situation in which adaptive localization will potentially capture more relevant information for finding the analysis state of any given cell . as we note in the caption of fig .",
    "[ fig : covariance - localization - schematic ] , while we are motivated by localization around flow structures like panel c , we simply shift the covariance in panel a so that our method is most general and computationally efficient .",
    "denote the velocity vector of cells on a perpendicular slice of the loop at @xmath79 , the tangent vector to the slice @xmath79 by @xmath80 , the zone width as @xmath81 and then the localization shift @xmath82 for that slice of the loop is taken to be @xmath83      we employ the `` standard '' algorithm of tu to compute the dynamic mode decomposition @xcite .",
    "tu s `` standard '' algorithm is as follows with @xmath84 and @xmath85 taken as the first and last @xmath86 columns of the snapshot matrix @xmath87 : @xmath88    given a system state @xmath89 we project this state onto the dmd basis by taking the real part of @xmath90 and use the psuedoinverse to compute the projection as @xmath91 this projection is a vector which contains the linear coefficients on the basis of dmd modes for the given state .",
    "we confirm the performance of the da methods described above by testing each ( on the lorenz 63 system ) for increasingly long times between observations , by increasing the da window length in fig .",
    "[ fig : window_test ] . as the time between observations increases , the nonlinearity of the lorenz 63 system results in the failure of the ekf and difficultly for the enkf with small ensemble size .",
    "the etkf and ensrf perform the best of the methods tested and we chose the etkf for future use with the cfd model .    .",
    "increasing the assimilation window led to an decrease in predictive skill , as expected .",
    ", scaledwidth=50.0% ]    the results in fig .",
    "[ fig : window_test ] rely on tuned covariance inflation , both additive and multiplicative , pre - computed for each window and da technique .",
    "we choose optimal additive inflation @xmath92 and multiplicative inflation @xmath93 by selecting for the lowest error in an exhaustive search through a maximum factors of @xmath94 in each , an example is shown in fig .",
    "[ fig : etkf_cov_tuning_390s ] .",
    "we use these optimal data assimilation parameters ( inflation factors ) for the remainder of this work .     and @xmath92 .",
    "each of the 100 model runs starts with a random ic , and the analysis forecast starts randomly .",
    "the window length here is 390 seconds .",
    "the filter performance rms is computed as the rms value of the difference between forecast and truth at the assimilation window for the latter 500 windows , allowing a spin - up of 500 windows .",
    ", scaledwidth=48.0% ]      an initial test of prediction skill with limited observations in a twin model experiment showed that we needed 1000 spatial measurements of the temperature to predict flow reversals within 1 assimilation window . in an attempt to decrease the required observations to a experimentally realizable number ,",
    "we implement a simple , adaptively localized covariance for data assimilation . since we first saw a modest improvement in the prediction skill with full temperature observations",
    ", we hope that this improvement increases and is sufficient to get down to needing as few as 32 observations to predict reversals 1 assimilation window ( of length 10 seconds ) into the future .    in fig .",
    "[ fig : sliding_spag ] we see that over an assimilation of 200 seconds , the ensemble converges on the hidden , true state . to test the performance of flow reversal prediction",
    ", we take the average of the ensemble flow direction ( the average of each value of @xmath13 ) as the predicted flow direction , and count how often we predict reversals both when they do and do not occur . varying both the number of model variables and the strength of covariance shifting in fig . [",
    "fig : sliding_results ] , we find that covariance shifting improves flow reversal prediction skill even when spatial observation density is decreased . with full observations ( spacing of 1 ) , we obtain a the best predictions with a covariance shift of 2 . for 1/2 and 1/5 observations [ a spacing of 2 ( 5 ) to observe every other ( fifth ) variable ]",
    ", we again have the best predictions with a shift of 2 . and for a spacing of 10 , observing every 10th variable , we achieve greater prediction skill with a covariance shift of 10 .    .",
    "assimilation takes place every 10 model seconds .",
    ", scaledwidth=48.0% ]        computing the average flow direction inside a localized covariance zone is straightforward , and computationally easy since the velocity is immediately available , making incorporation of this scheme into any data assimilation method easy .",
    "since observations are also sparse in large weather models , we expect that using an adaptive local covariance scheme could lead to improved prediction skill with sparse observations @xcite .      to incorporate limited observations into a high - dimensional cfd simulation , we combine ideas from both cfd literature and data assimilation to make predictions .",
    "we proceed with tu s algorithm using snapshots every 10 seconds for the first 900 seconds of model time .",
    "a full picture of this time series can be found in .    in this reduced space",
    ", we extract the modes that correspond to the instability leading to flow reversals . with a known low - dimensional model of the thermosyphon dynamics , we take this opportunity to test whether dmd can discover the underlying system .",
    "the time series of the model state projection onto a specific dmd mode will represent the time dynamics of a mode that is representative of a single low dimensional variable .",
    "to look at all of the modes at once , we examine the average magnitude of the projection from all model states onto each mode in comparison to the projection of all states that 1,3,5 , and 7 time steps before a reversal . the magnitude of the mode projection of a predictive mode before a reversal should stand out against the projection average across all states , and decay back towards the average further from the reversal in time . for modes 21 and 79 ,",
    "we directly observe in fig .",
    "[ fig : dmd_modes ] that the average projection from states just 1 second before reversal is the most different from the average state projection , and the further away from the reversal the more similar the states become to the average .     average projection onto each dmd mode for different sets of model states .",
    "dmd constructed as snapshots every 10 seconds for the first 900 seconds of model time , and model states from the first 2000 seconds are all projected onto the dmd modes .",
    "all states average shown in black , and the average of the subset of states that occur 1 second , 3 seconds , 5 seconds , and 7 seconds before a reversal are shown in other colors .",
    "the symmetry of the loop generates modes that often come in pairs .",
    ", scaledwidth=45.0% ]    we are particularly interested in whether the mode projection time series is predictive of flow reversals , as is true with the hidden system .",
    "the insets of panel a and panel b in fig .",
    "[ fig : dmd_phaseplane ] show two such timeseries , with stars indicating the time of flow reversals .",
    "individually , these modes increase in amplitude when flow reversals happen . as a dominant mode ,",
    "the time series of mode 2 tracks closely to the timeseries from which the modes were generated , while the dynamics of the projection of mode 79 are less obvious .        by combining the state projection onto specific mode time series into a phase plane ,",
    "the combined signal from two modes is used for discovering states that separate reversals in direction and from other states in the phase plane . in fig .",
    "[ fig : dmd_phaseplane ] we see that the dominant dynamics from mode 2 plotted with those of mode 79 are able to strongly separate reversals into quadrants of the low - dimensional space .",
    "this result indicates that dmd could be used to improve predictability of reversals .",
    "the first output of our work is a general data assimilation framework for matlab and julia . by utilizing an object - oriented ( oo ) design ,",
    "the model and data assimilation algorithm code are separate and can be changed independently .",
    "the principal advantage of this approach is the ease of incorporation of new models and da techniques ( code available at https://github.com/andyreagan/julia-openfoam ) .",
    "we next present the results pertaining to the accuracy of forecasts for synthetic data ( twin model experiments ) .",
    "there are many possible experiments given the choice of assimilation window , data assimilation algorithm , localization scheme , model resolution , observational density , observed variables , and observation quality .",
    "we focused on considering the effect of observations and observational locations on the resulting forecast skill , and we find that there is a threshold for the required number of observations to make useful predictions . in general , and unsurprisingly , we see that increasing observational density leads to improved forecast accuracy . with too few observations , the data assimilation is unable to recover the underlying dynamics .",
    "using adaptively localized covariance holds promise for data assimilation with data - scarce models , to overcome the lack of data .",
    "the ability of dmd to recover the lower dimensional dynamics is expected but with 240,000 variables is nonetheless an accomplishment . when modeling systems for which there are unknown but useful dimension reductions , as demonstrated here , dmd can be a useful tool to find such dimension reductions .",
    "when computational model runs are exceedingly costly or time consuming , the best - guess state projection onto dmd modes provides insights into the system dynamics that could not otherwise be obtained .    the numerical coupling of cfd to experiment by da should be generally useful to improve the skill of cfd predictions of experiments .",
    "in addition , the cfd model can provide better knowledge of unobservable quantities of interest in fluid flow that use the experimental data to find the analysis state provided by da .",
    "adaptive covariance localization further enhances the benefit provided by da in this context .",
    "this work was made possible by funding from the vermont space grant consortium , nasa epscor , nsf - dms grant no .",
    "0940271 , the mathematics & climate research network and the vermont advanced computing center .",
    "sitaram asur and bernardo  a huberman .",
    "predicting the future with social media . in _ web intelligence and intelligent agent technology ( wi - iat ) , 2010 ieee / wic / acm international conference on _ , volume  1 , pages 492499 .",
    "ieee , 2010 .",
    "shu - chih yang , debra baker , hong li , katy cordes , morgan huff , geetika nagpal , ena okereke , josue villafane , eugenia kalnay , and gregory  s duane .",
    "data assimilation as synchronization of truth and model : experiments with the three - variable lorenz system*. , 63(9):23402354 , 2006 .",
    "hrvoje jasak , aleksandar jemcov , and zeljko tukovic .",
    "openfoam : a c++ library for complex physics simulations . in",
    "_ international workshop on coupled methods in numerical dynamics , iuc , dubrovnik , croatia _ ,",
    "pages 120 , 2007 .",
    "edward ott , brian  r hunt , istvan szunyogh , aleksey  v zimin , eric  j kostelich , matteo corazza , eugenia kalnay , dj  patil , and james  a yorke .",
    "a local ensemble kalman filter for atmospheric data assimilation .",
    ", 56(5):415428 , 2004 .                              in this section , we first present the governing equations for the flow in our thermal convection loop experiment .",
    "a spatial and temporal discretization of the governing equations is then necessary so that they may be solved numerically .",
    "after discretization , we must specify the boundary conditions . with the mesh and boundary conditions in place",
    ", we can then simulate the flow with a computational fluid dynamics solver .",
    "we now discuss the equations , mesh , boundary conditions , and solver in more detail . with these considerations ,",
    "we present our simulations of the thermosyphon . for a complete derivation of the equations used , see @xcite .",
    "we consider the incompressible navier - stokes equations with the boussinesq approximation to model the flow of water inside a thermal convection loop . here",
    "we present the main equations that are solved numerically , noting the assumptions that are necessary in their derivation . in standard notation , for @xmath95 the velocity in the @xmath96 direction , respectively , the continuity equation for an incompressible fluid is @xmath97    the momentum equations , in tensor notation with bars representing averaged quantities ( long timesteps are used , requiring integration ) , are @xmath98 for @xmath99 the reference density with the boussinesq approximation included , @xmath18 the pressure , @xmath92 the viscosity , and @xmath100 gravity in the @xmath21-direction .",
    "note that @xmath101 for @xmath102 since gravity is assumed to be the @xmath103 direction .",
    "since the model is incompressible , of course our energy equation includes only temperature , and is given by @xmath104 for @xmath105 the temperature and @xmath106 the flux ( where @xmath107 is the averaging notation ) .",
    "the piso ( pressure - implicit with splitting of operators ) algorithm derives from the work of @xcite , and is complementary to the simple ( semi - implicit method for pressure - linked equations ) @xcite iterative method .",
    "the main difference of the piso and simple algorithms is that in the piso , no under - relaxation is applied and the momentum corrector step is performed more than once @xcite .",
    "they sum up the algorithm in nine steps :    * set the boundary conditions . *",
    "solve the discretized momentum equation to compute an intermediate velocity field .",
    "* compute the mass fluxes at the cell faces .",
    "* solve the pressure equation .",
    "* correct the mass fluxes at the cell faces .",
    "* correct the velocity with respect to the new pressure field .",
    "* update the boundary conditions .",
    "* repeat from step # 3 for the prescribed number of times .",
    "* repeat ( with increased time step ) .",
    "we then enter the main loop .",
    "this is computed for each time step , prescribed before the solver is applied .",
    "note that the capacity is available for adaptive time steps , choosing to keep the courant number below some threshold , but i do not use this . for the distributed ensemble of model runs , it is important that each model complete in nearly the same time , so that the analysis is not waiting on one model and therefore under - utilizing the available resources .               and @xmath103 up to a mesh of 523584 cells .",
    "for meshes with more than 80,000 cells we see that the solutions are very similar .",
    "the smaller meshes generate increasing unstable flow behavior , leading to oscillations of flux and then flow reversals for the smallest meshes of size 2500 and 1600 cells .",
    ", scaledwidth=79.0% ]      following the derivation by harris @xcite , itself a representation of the derivation of gorman @xcite and namesakes ehrhard and mller @xcite , we derive the equations governing a closed loop thermosyphon .",
    "similar to the derivation of the governing equations of computational fluid dynamics , we start with a small but finite volume inside the loop . here , however , the volume is described by @xmath110 for @xmath9 the interior loop size ( such that @xmath111 is the area of a slice ) and @xmath112 the arc length ( width ) of the slice .",
    "newton s second law states that momentum is conserved , such that the sum of the forces acting upon our finite volume is equal to the change in momentum of this volume .",
    "therefore we have the basic starting point for forces @xmath113 and velocity @xmath114 as @xmath115 the sum of the forces is @xmath116 for net pressure , fluid shear , and gravity , respectively .",
    "we write these as @xmath117 where @xmath118 is the pressure gradient , @xmath119 is the wall friction force , and @xmath120 is the vertical component of gravity acting on the volume .",
    "we now introduce the boussinesq approximation which states that both variations in fluid density are linear in temperature @xmath105 and density variation is insignificant except when multiplied by gravity .",
    "the consideration manifests as @xmath121 where @xmath122 is the reference density and @xmath123 is the reference temperature , and @xmath7 is the thermal expansion coefficient .",
    "the second consideration of the boussinesq approximation allows us to replace @xmath24 with this @xmath124 in all terms except for @xmath125 .",
    "we now write momentum equation as @xmath126 canceling the common @xmath111 , dividing by @xmath127 , and pulling out @xmath128 on the lhs we have @xmath129 we integrate this equation over @xmath13 to eliminate many of the terms , specifically we have @xmath130 since @xmath114 ( and hence @xmath131 ) and @xmath119 do not depend on @xmath13 , we can pull these outside an integral over @xmath13 and therefore the momentum equation is now @xmath132 diving out @xmath133 and pull constants out of the integral we have our final form of the momentum equation @xmath134 now considering the conservation of energy within the thermosyphon , the energy change within a finite volume must be balanced by transfer within the thermosyphon and to the walls .",
    "the internal energy change is given by @xmath135 which must equal the energy transfer through the wall , which is , for @xmath136 the wall temperature : @xmath137 combining equations [ eq : emeg1 ] and [ eq : emeg2 ] ( and canceling terms ) we have the energy equation : @xmath138 the @xmath119 which we have yet to define and @xmath139 are fluid - wall coefficients and can be described by @xcite : @xmath140 we have introduced an additional function @xmath15 to describe the behavior of the dimensionless velocity @xmath141 .",
    "this function is defined piece - wise as @xmath142 where @xmath143 can be defined as @xmath144 such that @xmath18 is analytic at 0 @xcite .",
    "taking the lowest modes of a fourier expansion for @xmath105 for an approximate solution , we consider : @xmath145 by substituting this form into equations [ eq : em10 ] and [ eq : emeq ] and integrating , we obtain a system of three equations for our solution .",
    "we then follow the particular nondimensionalization choice of harris _",
    "et al._such that we obtain the following ode system , which we refer to as the ehrhard - mller equations : @xmath146 the nondimensionalization is given by the change of variables @xmath147 and @xmath148    through careful consideration of these non - dimensional variable transformations we verify that @xmath149 is representative of the mean fluid velocity , @xmath150 of the temperature difference between the 3 and 9 oclock positions on the thermosyphon , and @xmath151 the deviation from the vertical temperature profile in a conduction state @xcite .      the tlm is the model which advances an initial perturbation @xmath152 at timestep @xmath21 to a final perturbation @xmath153 at timestep @xmath154 .",
    "the dynamical system we are interested in , lorenz 63 , is given as a system of ode s : @xmath155 we integrate this system using a numerical scheme of our choice ( in the given examples we use a second - order runge - kutta method ) , to obtain a model @xmath34 discretized in time .",
    "@xmath156 .\\ ] ] introducing a small perturbation @xmath157 , we can approximate our model @xmath34 applied to @xmath158 with a taylor series around @xmath159 : @xmath160 & = m [ { \\mathbf{x}}(t_0 ) ] + \\frac{\\partial m}{\\partial { \\mathbf{x } } } { \\mathbf{y}}(t_0 ) + o [ { \\mathbf{y}}(t_0 ) ^2 ] \\\\ & \\approx { \\mathbf{x}}(t ) + \\frac{\\partial m}{\\partial { \\mathbf{x } } } { \\mathbf{y}}(t_0 ) .\\end{aligned}\\ ] ] we can then solve for the linear evolution of the small perturbation @xmath161 as @xmath162 where @xmath163 is the jacobian of @xmath164 .",
    "we can solve the above system of linear ordinary differential equations using the same numerical scheme as we did for the nonlinear model .",
    "one problem with solving the system of equations given by equation [ eq : odetlm ] is that the jacobian matrix of discretized code is not necessarily identical to the discretization of the jacobian operator for the analytic system .",
    "this is a problem because we need to have the tlm of our model @xmath34 , which is the time - space discretization of the solution to @xmath165 .",
    "we can apply our numerical method to the @xmath165 to obtain @xmath34 explicitly , and then take the jacobian of the result .",
    "this method is , however , prohibitively costly , since runge - kutta methods are implicit .",
    "it is therefore desirable to take the derivative of the numerical scheme directly , and apply this differentiated numerical scheme to the system of equations @xmath166 to obtain the tlm .",
    "a schematic of this scenario is illustrated in figure [ fig : tlmscheme ] .",
    "to that the derivative of numerical code for implementing the ekf on models larger than 3 dimensions ( i.e. global weather models written in fortan ) , automatic code differentiation is used @xcite .        to verify our implementation of the tlm , we propagate a small error in the lorenz 63 system and plot the difference between that error and the tlm predicted error , for each variable ( figure [ fig : tlmverification ] ) .",
    "is not the error predicted by the tlm , but rather the error of the tlm in predicting the error growth .",
    "we see an intially linear error growth for small time , which is overcome by the nonlinearity of the lorenz system for longer time .",
    ", scaledwidth=45.0% ]    with a finite ensemble size , the ensemble method is only an approximation and therefore in practice it often fails to capture the full spread of error . to better capture the model variance , additive and multiplicative inflation factors are used to obtain a good estimate of the error covariance matrix ( section ) .",
    "the spread of ensemble members in the @xmath149 variable of the lorenz model , as distance from the analysis , can be seen in figure [ fig : enkfhist ] .",
    "in computing the error covariance @xmath50 from the ensemble , we wish to add up the error covariance of each forecast with respect to the mean forecast . but this would underestimate the error covariance , since the forecast we re comparing against is used in the ensemble average ( to obtain the mean forecast ) . therefore , to compute the error covariance matrix for each forecast ,",
    "that forecast itself is excluded from the ensemble average forecast .",
    "we denote the forecast within an ensemble filter as the average of the individual ensemble forecasts , and an explanation for this choice is substantiated by burgers @xcite .",
    "the general enkf which we use is most similar to that of burgers .",
    "many algorithms based on the enkf have been proposed and include the ensemble transform kalman filter ( etkf ) @xcite , ensemble analysis filter ( eaf ) @xcite , ensemble square root filter ( ensrf ) @xcite , local ensemble kalman filter ( lekf ) @xcite , and the local ensemble transform kalman filter ( letkf ) @xcite . a comprehensive overview through 2003 is provided by evensen @xcite .",
    "for further details on the most advanced methods , beyond what is provided in the body of the paper , we direct the reader the above references and the derivations provided in @xcite .      the general algorithm for dmd is provided in the section , and here we supply more results of the dmd procedure .",
    "the timeseries from which we computed the decomposition is shown in figure [ fig : dmd - timeseries ] .",
    "variable of the lorenz 63 system .",
    "residence time in either flow direction is aperiodic and unstable with the flow speed oscillating within a single direction with growing amplitude until reversing .",
    ", scaledwidth=98.0% ]"
  ],
  "abstract_text": [
    "<S> a thermal convection loop is a annular chamber filled with water , heated on the bottom half and cooled on the top half . with sufficiently large forcing of heat , the direction of fluid flow in the loop oscillates chaotically , dynamics analogous to the earth s weather . as is the case for state - of - the - art weather models , </S>",
    "<S> we only observe the statistics over a small region of state space , making prediction difficult . to overcome this challenge , data assimilation ( da ) methods , and specifically ensemble methods , use the computational model itself to estimate the uncertainty of the model to optimally combine these observations into an initial condition for predicting the future state . here , we build and verify four distinct da methods , and then , we perform a twin model experiment with the computational fluid dynamics simulation of the loop using the ensemble transform kalman filter ( etkf ) to assimilate observations and predict flow reversals . we show that using adaptively shaped localized covariance outperforms static localized covariance with the etkf , and allows for the use of less observations in predicting flow reversals . </S>",
    "<S> we also show that a dynamic mode decomposition ( dmd ) of the temperature and velocity fields recovers the low dimensional system underlying reversals , finding specific modes which together are predictive of reversal direction . </S>"
  ]
}