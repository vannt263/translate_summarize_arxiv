{
  "article_text": [
    "rips theory of group actions on real trees has been extremely important not only because of its intrinsic value but also as a tool and a nexus for different disciplines , see @xcite .",
    "for instance , it was essential for understanding the compactification of hyperbolic structures @xcite , in sela s approach to acylindrical accessibility @xcite , for the isomorphism problem for hyperbolic groups @xcite , for the study of limit groups @xcite , for the construction of the jsj decomposition @xcite , for analysing automorphisms of hyperbolic groups and free groups , @xcite , etc .",
    "the goal of this paper is to generalise rips theory to higher dimensional spaces , i.e. to determine the structure of finitely generated groups acting nicely on _ real cubings _ ( see definition [ defn : rcub ] ) .    in order to be more concrete on the type of actions and spaces under consideration",
    ", we first discuss the point of view on group actions on real trees that we adopt . in @xcite , bestvina and feighn determined the structure of finitely presented groups acting stably on a real tree .",
    "guirardel , in @xcite , showed that , in fact , any stable action of a finitely presented group on a real tree can be approximated by actions on simplicial trees while keeping control on arc stabilisers . from this perspective , the theory of ( stable ) actions on real trees is the theory of ultralimits of actions on simplicial trees , @xcite .",
    "a natural high dimensional generalisation of a ( simplicial ) tree is that of a @xmath2 cube complex .",
    "following sageev , @xcite , we call a simply connected cube complex of ( combinatorially ) non - positive curvature a _ cubing _ and we define a _ real cubing _ to be an ultralimit of cubings ( see definition [ defn : rcub ] ) .",
    "as rips theory can be viewed as the theory of ultralimits of actions on simplicial trees , our approach to its generalisation is to study group actions on the ultralimits of cubings .",
    "it is obvious that in order to succeed in this approach , one needs to have a good understanding of the structure of groups acting on @xmath2 cube complexes .",
    "but already at this point , one encounters the first obstacle : burger and mozes , see @xcite , described a series of finitely presented simple groups that act _ freely _ on the direct product of two ( simplicial ) trees .",
    "these examples show that the problem of describing the structure of finitely generated groups acting on @xmath2 cube complexes is practically hopeless .",
    "intuitively , one would expect that a `` good '' action on a space should capture the structure of the space and so , in the particular case of a direct product of trees , one would expect to recover some type of direct product structure . as shown by the examples of burger and mozes ,",
    "free actions fail this intuition .",
    "the notion that does respond to this expectation is the notion of co - special action introduced by haglund and wise , see @xcite . roughly speaking",
    ", a group @xmath0 acts co - specially on a cube complex @xmath3 if the quotient @xmath4 is a cube complex without certain pathologies on its hyperplanes . in this way , a group acts freely co - specially on a direct product of trees if and only if it is a subgroup of a direct product of free groups .",
    "more generally , it follows from the work of haglund and wise , that a group acts freely co - specially on a @xmath2 cube complex if and only if it is a subgroup of a ( possibly infinitely generated ) partially commutative group ( also known as right - angled artin groups or graph groups ) . furthermore , every action of a group on a simplicial tree ( without inversions of edges ) is co - special , therefore co - special actions on @xmath2 cube complexes are a natural generalisation of actions on simplicial trees .",
    "the aim of this paper is to determine the structure of finitely generated groups that act on real cubings via an ultralimit of free co - special actions on cube complexes , i.e. to determine the structure of finitely generated groups that act essentially freely co - specially on real cubings , see definition [ defn : essfr ] .    we show that the class of groups that admit this type of action on a real cubing is , in fact , very large , containing as main example the class of finitely generated groups discriminated by an arbitrary ( finitely generated ) partially commutative group , or in other words , the class of limit groups over partially commutative groups . in particular , the class of groups we consider contains the class of finitely generated residually free groups and so the class of limit groups over free groups .",
    "furthermore , the type of actions we consider is rather wide . in the case of real trees",
    "( viewed as real cubings ) , one can show that every very small action of a free group , every faithful , non - trivial action of an abelian group and every small action of the fundamental group of an orientable surface is of our type .",
    "( note that if one could show that very small actions of the fundamental group of a non - orientable surface on real trees can be approximated by very small simplicial actions , then we could conclude that any free action of a finitely generated group on a real tree is of our type , see @xcite for further discussion ) .",
    "we now explain in what terms we determine the structure of finitely generated groups acting essentially freely and co - specially on real cubings .",
    "one family of groups that turned out to be key in the study of both the universal and the elementary theory of free groups is the class of @xmath1-residually free towers or , equivalently , the class of ntq - groups . this class of groups is constructed inductively from free abelian groups and surface groups by taking free products and amalgamations over abelian subgroups .",
    "one of the main properties of this family is that , on the one hand , any ntq - group is discriminated by non - abelian free groups ( see @xcite ) and , on the other hand , any finitely generated freely discriminated group is a subgroup of an ntq - group ( see @xcite ) . hence studying limit groups over free groups is equivalent to studying ntq - groups and their subgroups .",
    "along these lines , we prove that groups acting essentially freely co - specially on real cubings are subgroups of a nice class of groups , which we call _ graph towers_. graph towers are natural generalisations of ntq - groups ( @xmath1-residually free towers ) and , just as them , they are also defined inductively .",
    "graph towers of height @xmath5 are partially commutative groups . a graph tower @xmath6 of height @xmath7",
    "is constructed by taking an amalgamated product of a graph tower @xmath8 of height @xmath9 and an extension of either a free abelian group , or of a free group or of a surface group with boundary , by the centraliser @xmath10 of ( a certain ) subgroup @xmath11 of @xmath8 , and taking the amalgamation over this centraliser @xmath10 .",
    "more precisely ,    let partially commutative groups be graph towers of height @xmath5 .",
    "assume that graph towers @xmath8 of height @xmath9 have been constructed .",
    "then , a graph tower of height @xmath7 has one of the following presentations :    * @xmath12 + ( basic type , @xmath11 is a certain non - abelian subgroup of @xmath8 ) ; * @xmath13=1 , 1\\le i , j \\le m_l , i\\ne j \\rangle)$ ] + ( basic type , @xmath11 is a certain abelian subgroup of @xmath8 ) ; * @xmath14=1 , 1\\le i , j \\le m_l , i\\ne j \\rangle)$ ] + ( abelian type , @xmath15 is a non - trivial irreducible root element ) ; * @xmath13=1 , 1\\le i , j\\le m_l , i\\ne j \\rangle)$ ] + ( abelian type , @xmath11 is a certain non - abelian subgroup of @xmath8 ) ; * @xmath16 + ( surface type , @xmath17 is a non - exceptional quadratic equation and @xmath11 is a certain non - abelian subgroup of @xmath8 ) .    in general , one does not extend centralisers of arbitrary subgroups . roughly speaking , one only considers subgroups of @xmath8 which behave as directly indecomposable canonical parabolic subgroups , i.e. are discriminated ( in a `` minimal way '' ) into directly indecomposable canonical parabolic subgroups of the partially commutative group @xmath18 , see discussion in section [ sec:9 ] .",
    "the class of graph towers extends the class of @xmath1-residually free towers or ntq - groups . indeed ,",
    "if the subgroup @xmath11 of an @xmath1-residually free tower is non - abelian , then since centralisers in a freely discriminated group @xmath8 are commutative transitive , it follows that @xmath10 is trivial and so , in this case , the decompositions correspond to free products and amalgamated products ( over cyclic ) . if the subgroup @xmath11 is abelian , then @xmath10 is a maximal abelian subgroup of @xmath8 and the decomposition corresponds to an amalgamated product over a ( finitely generated free ) abelian group .",
    "this suggests that the splittings that occur in groups acting on real cubings can give a framework for a generalisation of the theory of ( abelian ) jsj - decompositions .",
    "just as the class of @xmath1-residually free towers and ntq groups plays a crucial role in the classification of groups elementarily equivalent to a free group , @xcite , we expect that the class of graph towers will play a similar role in the classification of groups elementarily equivalent to a given partially commutative group .",
    "we are now in the position to state one of the main results of this paper .",
    "let @xmath0 be a finitely generated group .",
    "the group @xmath0 acts essentially freely co - specially on a real cubing if and only if it is a subgroup of a graph tower .",
    "furthermore , given a finitely generated group @xmath0 , the corresponding graph tower @xmath19 and the embedding of @xmath0 into @xmath19 can be constructed effectively .",
    "in the case of free actions , the above theorem results in the following corollary , which can be likened to rips theorem on free actions on real trees .",
    "a finitely generated group @xmath0 acts freely , essentially freely and co - specially on a real cubing if and only if @xmath0 is a subgroup of the graph product of free abelian and ( non - exceptional ) surface groups .",
    "in particular , if the real cubing is a real tree , then @xmath0 is a ( subgroup of ) the free product of free abelian groups and ( non - exceptional ) surface groups .",
    "notice that although graph towers are finitely presented , finitely generated groups acting essentially freely co - specially on real cubings ( or limit groups over partially commutative groups ) are , in general , _ not _ finitely presented , since partially commutative groups ( and so graph towers ) are not coherent .",
    "the approach to group actions on real cubings we present in this paper is similar to the one originally presented by rips for the study of free actions on real trees and to the one presented by kharlampovich and miasnikov for the study of limit groups over free groups , @xcite .",
    "both approaches are based on an interpretation of the makanin - razborov process , a combinatorial algorithm that decides whether or not a system of equations over a free group is compatible as well as produces an effective description of the set of solutions . in our case ,",
    "the proof will rely on the analogue of the makanin - razborov process that we developed in @xcite , which gives an effective description of the solution set of a system of equations over a partially commutative group .",
    "we now outline the organization of the paper . in the first three sections , we review basic notions and fix notation on partially commutative groups , algebraic geometry over groups and cube complexes .",
    "in section [ sec:5 ] , we review and extend several basic results from the theory of cube complexes .",
    "an important notion for our approach is that of co - special action introduced by haglund and wise in @xcite , since it links cube complexes and groups acting on them to partially commutative groups and their subgroups - the natural setting for our work .",
    "more precisely , given a special cube complex @xmath3 , haglund and wise construct an ( @xmath20-)typing map and a natural combinatorial local isometry from @xmath3 to the standard complex of a partially commutative group @xmath21 , and prove that @xmath22 embeds into @xmath21 .",
    "the main inconvenience of this construction is that , in general , the partially commutative group @xmath21 is infinitely generated and this precludes the use of some of the techniques needed in our approach .    an elegant way to overcome this technical obstacle would be by solving the following problem for partially commutative groups .",
    "[ prob:1 ] given @xmath23 , does there exist a universal finitely generated partially commutative group @xmath24 that contains all @xmath25-generated subgroups of arbitrary partially commutative groups ?    or , in a stronger form , given @xmath23 , does there exist a finitely generated partially commutative group @xmath24 so that for any @xmath25-generated subgroup @xmath26 of any partially commutative group @xmath18 there exists a homomorphism @xmath27 from @xmath18 to @xmath24 which is injective on @xmath26 ?",
    "we note that by @xcite , every @xmath28-generated subgroup of any partially commutative group is either free or free abelian . hence , there does exist a @xmath28-universal partially commutative group .",
    "unfortunately , we do not know a solution to this problem in the full generality .",
    "however , we can solve it if we restrict the family of partially commutative groups to which the subgroups @xmath26 belong .",
    "to this end , in section [ sec:5 ] , we introduce the notion of width of a cube complex and show that the subclass of partially commutative groups of bounded width do have a universal object for the set of their @xmath25-generated subgroups .",
    "note that there are other ( even wider ) classes that one could handle in a similar way such as the class of partially commutative groups that are ( finite or infinite ) free products of finitely many different partially commutative groups of finite width .    due to the nature of the class of partially commutative groups we are considering",
    ", some constructions in section [ sec:5 ] might seem somewhat artificial .",
    "the reader interested primarily in understanding the structure of limit groups over partially commutative groups , may wish to skip sections [ sec:5 ] , [ sec:6 ] and [ sec:7 ] and proceed to section [ sec:9 ] .",
    "our choice of approach is justified by the fact that , on the one hand , it covers the case of trees , and , on the other hand , in the event that problem [ prob:1 ] is solved in positive , the proofs and results of this paper could be straightforwardly carried over to the general case ( i.e. the restriction on the width of cubings would be dropped ) .    in section [ sec:6 ]",
    ", we introduce real cubings as ultralimits of cubings of uniformly bounded width , see definition [ defn : rcub ] .    in section [ sec:7 ] , we introduce the notion of essentially free co - special action - the class of actions that we are interested in , see definition [ defn : essfr ] . roughly speaking",
    ", an action of a group @xmath0 on a real cubing ( viewed as an ultralimit ) is essentially free and co - special if it is faithful , non - trivial and is a limit of co - special actions .",
    "we show that if a group @xmath0 acts essentially freely and co - specially on a real cubing , then it acts essentially freely and co - specially on the asymptotic cone of a finitely generated partially commutative group .",
    "we then reduce the study of groups acting essentially freely and co - specially on real cubings to the study of limit groups over partially commutative groups .",
    "the main result of this section is summarised in the following    a finitely generated group acts essentially freely and co - specially on a real cubing if and only if it acts essentially freely and co - specially on an asymptotic cone of a partially commutative group if and only if it is a limit group over some partially commutative group .    just as the asymptotic cone of a non - abelian free group is the universal real tree , @xcite",
    ", the above results suggest that the asymptotic cone of the partially commutative group @xmath29 is the universal real cubing for real cubings of width @xmath30 . from this perspective , as rips theory can be viewed as the theory of groups acting on subspaces of the asymptotic cone of a free group , the theory developed in this paper can be regarded as the theory of groups acting on subspaces of asymptotic cones of partially commutative groups .    in section [ sec:9 ] ,",
    "we introduce the notion of graph tower , see definition [ defn : tower ] .",
    "as we briefly discussed , graph towers are a natural generalisation of @xmath1-residually free towers and ntq - groups .    in section [ sec:10 ]",
    ", we construct a graph tower @xmath31 associated to a limit group @xmath0 over a partially commutative group @xmath18 and in section [ sec:11 ] , we show that @xmath31 is discriminated by a family of homomorphisms induced by a discriminating family of @xmath0 and that @xmath0 embeds into @xmath31 .",
    "the main result of these two sections can be formulated as follows    given a limit group @xmath0 over a partially commutative group @xmath18 , one can effectively construct a graph tower @xmath31 and a monomorphism @xmath32 .",
    "furthermore , the graph tower @xmath31 is discriminated by @xmath18 .    given a limit group @xmath0 over a partially commutative group @xmath18 , the construction of the graph tower @xmath31 and the embedding @xmath33 essentially relies on the process we constructed in @xcite , which can be regarded as the counterpart of the makanin - razborov process for free groups . in @xcite , we show that the set of homomorphisms @xmath34 from a finitely generated group @xmath0 to a partially commutative group @xmath18 can be ( effectively ) described by a finite , oriented , rooted tree @xmath35 .",
    "vertices @xmath36 of the tree are labelled by coordinate groups @xmath37 of generalised equations",
    "@xmath38 and certain groups @xmath39 of automorphisms of @xmath37 .",
    "edges @xmath40 of the tree are labelled by proper epimorphisms @xmath41 .",
    "any homomorphism from @xmath0 to @xmath18 determines a path @xmath42 from the root to a leaf of this tree that allows to describe the homomorphism as a composition @xmath43 where @xmath44 is an automorphism from the corresponding group assigned to the vertex @xmath45 , @xmath46 is the epimorphism that labels the edge @xmath47 and @xmath48 is a certain homomorphism from the group assigned to the leaf of the tree to @xmath18 .",
    "( note that both the group associated to a leaf and the set of homomorphisms from the leaf to @xmath18 are completely determined , see ( * ? ? ?",
    "* theorem 9.2 ) ) .    in the free group case ,",
    "rips machine allows one to analyse the dynamics of the foliated band complex and classify the corresponding measured foliations by taking them to a normal form , i.e. it allows one to show that minimal pieces of the corresponding action of the group on a real tree correspond to either thin , surface or toral case .    in the case of",
    "partially commutative groups , the process we describe analyses the dynamics of a `` foliated constrained band complex '' or , in our terms , the dynamics induced by the family of solutions of a constrained generalised equation . constrained generalised equations are generalised equations ( or union of bands ) with commutation constraints associated to the items .",
    "in other words , if the coordinate group associated to the generalised equation is defined to be the free group generated by the items quotient by the radical ideal generated by the set of relations , then the coordinate group associated to a constrained generalised equation is the quotient of some partially commutative group ( generated by the items and commutation relations being induced by the constraints ) by the radical ideal of the set of relations .",
    "since the tree @xmath49 that describes the set @xmath34 is finite and since @xmath0 is discriminated by @xmath18 , it follows ( see lemma [ lem : discfam ] ) that there exists a branch of the tree , called fundamental branch , so that the family of homomorphisms that factors through it , is a discriminating family for @xmath0 .",
    "the idea is to use a fundamental branch and the family of automorphisms associated to the vertex of the branch to construct a graph tower @xmath19 as well as the embedding of @xmath0 into @xmath19 .    as in the free group case ,",
    "the family of automorphisms associated to a vertex @xmath36 are intrinsically related to the types of dynamics of a constrained generalised equation associated to @xmath36 .",
    "these dynamics were studied in @xcite and can be classified into the following three types :    * linear - like ( thin - like ) case : case 7 - 10 ; * quadratic - like ( surface - like ) case : case 12 ; * general type ( a combination of surface - like and axial - like cases ) : case 15 .    if the automorphism group associated to a vertex",
    "is of abelian type , i.e. if the generalised equation associated to the vertex contains a periodic structure , then similarly to the free group case , one can show that there exists an automorphism of the coordinate group that brings it to a presentation that exhibits the splitting ( see abelian floor in definition [ defn : tower ] ) .",
    "there is an essential difference when studying the linear and quadratic cases over free groups or over partially commutative groups . in the free group case ,",
    "given a generalised equation @xmath50 of type 12 ( quadratic type ) , the coordinate group associated to @xmath50 is isomorphic to a surface group .",
    "basically , one shows that bases of the generalised equation are generators of the corresponding group and that the group ( in this new generating set ) is a 1-relator group where the relation is a quadratic word .",
    "one concludes that there exists an automorphism of the group that brings the quadratic word into the normal form and hence the group is isomorphic to a surface group . in this case , the isomorphism only relies on the type of generalised equation .",
    "this is not true in the case of partially commutative groups .",
    "the type of the generalised equation alone does not determine the structure of the corresponding coordinate group : in general , the coordinate group of a constrained generalised equation of type 12 is _ not _ isomorphic to the quotient of a partially commutative group by a surface relation . in order to determine the structure of the group one essentially uses the fact that the corresponding generalised equation of type 12 repeats infinitely many times along an infinite branch of the tree @xmath51 constructed in @xcite . in other words , the structure of the coordinate group associated to a generalised equation @xmath38 of type 12 is intimately related with the presence of the automorphism group associated to the vertex @xmath36 .",
    "the analysis of the dynamics of an infinite branch of type 12 shows that one can gain control on the type of constraints and prove that , in this case , we can take the set of bases as generators of the group and preserve the underlying structure of a partially commutative group as well as prove the existence of an automorphism of the group that brings the quadratic word into the normal form .",
    "therefore , if a constrained generalised equation of type 12 appears infinitely many times in an infinite branch of the tree @xmath51 , then one can conclude that the group is isomorphic to the quotient of a partially commutative group by a surface relation ( see surface floor in definition [ defn : tower ] ) .",
    "a similar phenomena occurs if the generalised equation is of type 7 - 10 ( linear type ) . in the case of free groups ,",
    "the coordinate group splits as a free product where one of the factors is a free group . in the case of",
    "partially commutative groups , again the existence of automorphisms is crucial to determining the splitting . however , the dynamics of the linear case are much harder to analyse and we did not manage to follow this approach in order to find the splitting .",
    "instead , we change the strategy and study this case by forcing it to behave as the cases we know how to deal with : the quadratic case and the abelian case . in order to carry out this new analysis of the branch ,",
    "we do the contrary of what is done in the free group case : we use tietze transformations to _ introduce _ new generators and relations and transform the generalised equation to a generalised equation where every item is covered at least twice and then study the obtained generalised equation as in the quadratic and general cases .",
    "as one might expect , the dynamics of the linear case , not always can be analysed in this way and it may happen that after a finite number of steps , we fall again into a linear case . to deal with this ,",
    "we introduce an invariant ( the height of the minimal tribe ) , which is bounded above by a constant that depends only on the underlying partially commutative group @xmath18 , and show that every time we go back to the linear case , this invariant increases . furthermore ,",
    "if this invariant is maximal , we prove the existence of an automorphism that brings the group to a presentation that exhibits the splitting ( see basic floor in definition [ defn : tower ] ) .    in the last section ,",
    "we generalise the construction of the graph tower associated to a fundamental branch to an arbitrary branch .",
    "this allows us to prove the following result .",
    "let @xmath18 be a partially commutative group and let @xmath0 be a finitely generated residually @xmath18 group .",
    "then , one can effectively construct finitely many fully residually @xmath18 graph towers @xmath52 and homomorphisms @xmath53 from @xmath0 to @xmath54 , @xmath55 so that any homomorphism from @xmath0 to @xmath18 factors through a graph tower @xmath54 , for some @xmath55 , i.e. for any homomorphism @xmath56 there exists @xmath57 and a homomorphism @xmath58 so that @xmath59 .",
    "in particular , @xmath0 is a subgroup of the direct product of the graph towers @xmath54 , @xmath55 and a subdirect product of the direct product of groups @xmath60 , @xmath61 .    in the case of finitely",
    "generated residually free group , an analogous result was proven by kharlampovich and miasnikov , @xcite . in a recent work on the structure of finitely presented residually free groups , bridson , howie , miller and short , @xcite , gave an alternative construction of the embedding of a finitely presented residually free group into the direct product of finitely many limit groups and showed that their construction is canonical .",
    "the authors would like to thank mark sapir and vincent guirardel for stimulating discussions .",
    "in this section we recall some preliminary results on partially commutative groups and introduce the notation we use throughout the text .",
    "let @xmath62 be a ( undirected ) simplicial graph .",
    "then , the partially commutative group @xmath63 defined by the ( commutation ) graph @xmath64 is the group given by the following presentation : @xmath65=1 , \\hbox { whenever } ( v_1,v_2)\\in e(\\gamma)\\rangle.\\ ] ] we note that @xmath18 is not necessarily finitely generated .",
    "let @xmath66 be a full subgraph of @xmath64 .",
    "it is not hard to show , see for instance @xcite , that the partially commutative group @xmath67 is the subgroup of @xmath18 generated by @xmath68 , i.e. @xmath69 . following @xcite , we call @xmath70 a _ canonical parabolic subgroup _ of @xmath18 .",
    "we denote the length of a word @xmath71 by @xmath72 . for a word @xmath73 ,",
    "we denote by @xmath74 a _ geodesic _ of @xmath71 . naturally , @xmath75 is called the length of an element @xmath76 .",
    "an element @xmath76 is called _ cyclically reduced _ if the length of @xmath77 is twice the length of @xmath74 or , equivalently , the length of @xmath71 is minimal in the conjugacy class of @xmath71 .    for a given word @xmath71 , denote by @xmath78 the set of letters occurring in @xmath71 . for a word @xmath76 , define @xmath79 to be the subgroup of @xmath18 generated by all letters that do not occur in a geodesic @xmath80 and commute with @xmath71 .",
    "the subgroup @xmath79 is well - defined ( independent of the choice of a geodesic @xmath80 ) , see @xcite .",
    "let @xmath81 be so that @xmath82=1 $ ] and @xmath83 , or , which is equivalent , @xmath84 and @xmath85 . in this case",
    ", we say that @xmath36 and @xmath71 _ disjointly commute _ and write @xmath86 . given a set of elements @xmath87 of @xmath18 ,",
    "define @xmath88 .    for a ( not necessarily finitely generated ) partially commutative group @xmath89 , consider its non - commutation graph @xmath90 defined as follows .",
    "the vertex set @xmath91 coincides with @xmath92 .",
    "there is an edge connecting @xmath45 and @xmath93 in @xmath94 if and only if @xmath95 and there is no edge connecting @xmath45 and @xmath93 in @xmath64 .",
    "note that the graph @xmath94 is the complement graph of the graph @xmath64 .",
    "the graph @xmath94 is a union of its connected components @xmath96 , which induce a decomposition of @xmath18 as the direct product @xmath97    given @xmath73 and the set @xmath78 , just as above , consider the graph @xmath98 ( which is a full subgraph of @xmath94 )",
    ". this graph can be either connected or not . if it is connected , we call @xmath71 a _",
    "block_. if @xmath99 is not connected , then we can decompose @xmath71 into the product @xmath100 where @xmath101 is the number of connected components of @xmath99 and the word @xmath102 is a word in the letters from the @xmath103-th connected component .",
    "clearly , the words @xmath104 pairwise disjointly commute .",
    "each word @xmath102 , @xmath105 is a block and so we refer to presentation ( [ eq : bl ] ) as the block decomposition of @xmath71 .",
    "observe that the number of blocks of the block decomposition of @xmath76 is bounded above by the rank of @xmath18 .",
    "an element @xmath106 is called _ irreducible _ if it is a conjugate of a cyclically reduced block element .",
    "irreducible elements play a very important role in the theory of partially commutative groups .",
    "they are crucial in describing centralisers of elements ; they are used to prove that free extensions of centralisers are discriminated by partially commutative groups ; they are key to understand the cut - points in the asymptotic cones of partially commutative groups ; and they will be essentially used in this paper . in a sense , irreducible elements can be likened to irreducible automorphisms of free groups or surface groups .",
    "an element @xmath76 is called a _ least root _ ( or simply , root ) of @xmath107 if there exists a positive integer @xmath108 such that @xmath109 and there does not exists @xmath110 and @xmath111 such that @xmath112 . in this case , we write @xmath113 . by a result from @xcite ,",
    "partially commutative groups have least roots , that is the root element of @xmath36 is defined uniquely .",
    "let @xmath64 be a simplicial graph .",
    "for any @xmath114 , define @xmath115 to be the subset of all vertices @xmath116 so that there is an edge @xmath117 .",
    "we note that @xmath118 . given a subset @xmath119 , set @xmath120 .",
    "let @xmath71 be a cyclically reduced element of @xmath18 .",
    "it is not hard to see that @xmath121 .",
    "introduce an equivalence relation @xmath122 on the set of vertices @xmath92 . for two vertices @xmath123 , set @xmath124 if and only if @xmath125 . since for every @xmath126 , we have @xmath127 , it follows that if @xmath124 , then they are not connected by an edge in @xmath64 .",
    "define the graph @xmath128 whose vertices are @xmath122-equivalence classes and there is an edge joining @xmath129 $ ] to @xmath130 $ ] if and only if @xmath131 is an edge of @xmath64 for some ( and thus for all ) @xmath132 $ ] and @xmath133 $ ] .",
    "the graph @xmath128 is called the _ deflation _ of @xmath64 . observe that the partially commutative group @xmath70 is isomorphic to a canonical parabolic subgroup of @xmath89 .    a canonical parabolic subgroup @xmath134 of a partially commutative group is called _ closed _ if @xmath135 .",
    "the subgroup @xmath134 is called _ co - irreducible _ if @xmath134 is closed and its complement @xmath136 is a directly indecomposable canonical parabolic subgroup .",
    "we denote by @xmath137 the set of canonical generators of @xmath18 that generate @xmath134 .    in our setting",
    ", the set of edges @xmath138 of the graph @xmath64 will be decomposed into a disjoint union of two sets , @xmath139 , @xmath140 .",
    "let @xmath141 and @xmath142 be the partially commutative groups defined by the graphs @xmath143 and @xmath144 , correspondingly .",
    "then , any canonical parabolic subgroup @xmath134 of @xmath18 naturally defines canonical parabolic subgroups @xmath145 and @xmath146 of @xmath141 and @xmath142 , correspondingly .",
    "we say that a canonical parabolic subgroup @xmath134 of @xmath18 is @xmath147-co - irreducible ( @xmath147-directly ( in)decomposable ) if so is the induced subgroup @xmath145 of @xmath141 .",
    "similarly , a subgroup @xmath134 is called @xmath148-abelian if so is the induced subgroup @xmath146 of @xmath142 .",
    "the canonical parabolic subgroup @xmath149 of @xmath141 naturally defines a canonical parabolic subgroup of @xmath18 , which we shall denote by @xmath150 .",
    "let @xmath18 be a partially commutative group given by the presentation @xmath151 .",
    "let @xmath152 be the free monoid on the alphabet @xmath153 and let @xmath154 be the partially commutative monoid with involution given by the presentation : @xmath155 where @xmath156\\in r_{\\ensuremath{\\mathbb{t}}}$ ] if and only if @xmath157\\in r$ ] , @xmath158 .",
    "the involution on @xmath159 is induced by the operation of inversion in @xmath18 and does not have fixed points .",
    "we refer to it as to the _ inversion _ in @xmath159 and denote it by @xmath160 .",
    "following @xcite , we define a _ clan _ to be a maximal subset @xmath161 of @xmath153 such that @xmath162\\notin r_{\\ensuremath{\\mathbb{t}}}$ ] if and only if @xmath163\\notin r_{\\ensuremath{\\mathbb{t}}}$ ] for all @xmath164 and @xmath165 .",
    "a clan @xmath166 is called _ thin _ if there exist @xmath167 and @xmath168 such that @xmath169\\in r_{\\ensuremath{\\mathbb{t}}}$ ] and is called _ thick _ , otherwise .",
    "it follows from the definition that there is at most one thick clan and that the number of thin clans never equals 1 .",
    "every element of @xmath153 belongs to exactly one clan .",
    "if @xmath159 is a direct product of @xmath170 free monoids , then the number of thin clans is @xmath170 for @xmath171 , and it is @xmath5 for @xmath172 . in the following ,",
    "we pick a thin clan and we make it thick by removing commutation .",
    "it might be that the number of clans does not change , but the number of thin clans decreases . this is the reason why the definition of dm - normal form below is based on thin clans ( instead of considering all clans ) .",
    "it is convenient to encode an element of the partially commutative monoid as a finite labelled acyclic oriented graph @xmath173 $ ] , where @xmath174 is the set of vertices , @xmath175 is the set of edges and @xmath176 is the labelling .",
    "such a graph induces a labelled partial order @xmath177 $ ] . for an element @xmath178 , @xmath179 , @xmath180",
    ", we introduce the graph @xmath181 $ ] as follows .",
    "the set of vertices of @xmath181 $ ] is in one - to - one correspondence with the letters of @xmath71 , @xmath182 . for the vertex @xmath183 we set @xmath184 .",
    "we define an edge from @xmath185 to @xmath186 if and only if both @xmath187 and @xmath188\\notin r_{\\ensuremath{\\mathbb{t}}}$ ] .",
    "the graph @xmath181 $ ] thereby obtained is called the _ dependence graph _ of @xmath71 .",
    "up to isomorphism , the dependence graph of @xmath71 is unique , and so is its induced labelled partial order , which we further denote by @xmath189 $ ] .",
    "let @xmath190 be the linearly ordered subset of @xmath191 $ ] containing all vertices with label in the clan @xmath166 . for the vertex @xmath192 , we define the _ source point _ @xmath193 and the _ target point _ @xmath194 as follows : @xmath195 by convention , @xmath196 and @xmath197 .",
    "thus , @xmath198 , @xmath199 and @xmath200 for all @xmath192 . note that we have @xmath201 if and only if the label of @xmath36 belongs to @xmath166 .    for @xmath202",
    ", we define the median position @xmath203 as follows . for @xmath204 ,",
    "we let @xmath205 . for @xmath206 , by ( * ? ? ?",
    "* lemma 1 ) , there exist unique @xmath7 and @xmath25 such that @xmath207 , @xmath208 and @xmath209 then , we define @xmath210 and we call @xmath203 the",
    "_ median position_. define the _ global position _ of @xmath192 to be @xmath211 .",
    "we define the normal form @xmath212 of an element @xmath178 by introducing new edges into the dependence graph @xmath213 $ ] of @xmath71 .",
    "let @xmath214 be such that @xmath215 and @xmath216\\in r_{\\ensuremath{\\mathbb{t}}}$ ] .",
    "we define a new edge from @xmath15 to @xmath36 if @xmath217 , otherwise , we define a new edge from @xmath36 to @xmath15 .",
    "the new dependence graph @xmath218 $ ] defines a unique element of the trace monoid @xmath219 , where @xmath219 is obtained from @xmath159 by omitting the commutativity relations of the form @xmath220 $ ] for any @xmath221 and any @xmath222 .",
    "note that the number of thin clans of @xmath219 is strictly less than the number of thin clans of @xmath159 .",
    "we proceed by designating a thin clan in @xmath219 and introducing new edges in the dependence graph @xmath218 $ ] .",
    "it is proven in ( * ? ? ?",
    "* lemma 4 ) , that the normal form @xmath223 is a map from the trace monoid @xmath159 to the free monoid @xmath224 , which is compatible with inversion , i.e. it satisfies that @xmath225 and @xmath226 , where @xmath178 and @xmath227 is the canonical epimorphism from @xmath224 to @xmath159 .",
    "we refer to this normal form as to the _ dm - normal form _ or simply as to the _ normal form _ of an element @xmath178 .",
    "let @xmath76 be a word and let @xmath228 be a canonical parabolic subgroup , @xmath229 , @xmath230 .",
    "we say that @xmath71 has @xmath231 @xmath232-alternations if @xmath71 contains a subword @xmath233 , where @xmath234 and @xmath235 are non - trivial words , @xmath61 .",
    "[ lem : pc ] let @xmath76 be written in the dm - normal form .",
    "let @xmath228 be a canonical parabolic subgroup which decomposes as a non - trivial direct product of two canonical parabolic subgroups @xmath236 and @xmath237 , @xmath229 .",
    "then , the number of @xmath232-alternations in @xmath71 is bounded above by a constant that depends only on the number of clans of @xmath18 .",
    "we use induction on the number of thin clans of @xmath18 .",
    "if the number of thin clans equals one , then the statement is obvious .",
    "suppose that the statement is true for all partially commutative groups with less than @xmath238 thin clans and let @xmath18 have precisely @xmath238 thin clans .",
    "let @xmath76 be some word , let @xmath173 $ ] be the dependence graph of @xmath71 and let @xmath166 be a thin clan of @xmath18 , write @xmath239 where @xmath240",
    "are all the letters in @xmath71 which belong to the clan @xmath166 and the dependence relations for @xmath166 have already been established .    by definition of the dm - normal form , @xmath241",
    "therefore , if @xmath242 , then the statement follows by induction .",
    "suppose that @xmath232 and @xmath243 intersect non - trivially , then either @xmath244 or @xmath245 .",
    "let @xmath246 be an @xmath232-alternation in @xmath212 .",
    "if @xmath246 does not contain @xmath247 for all @xmath248 , then the statement follows by induction .",
    "let us assume that @xmath246 contains @xmath247 for some @xmath248 and let @xmath249 be minimal so that @xmath247 is a letter of @xmath93 .    if @xmath250 , then the bound on @xmath25 follows by induction .",
    "suppose that @xmath251 , then @xmath252 is a subword of @xmath253 and @xmath254 is a subword of @xmath255 for some @xmath256 .",
    "but , since @xmath257 and @xmath258 , it follows that for every letters @xmath259 and @xmath260 from @xmath252 and @xmath254 , the global positions @xmath261 and @xmath262 ( with respect to @xmath166 ) coincide , contradicting the definition of the dm - normal form .",
    "it follows that @xmath263 .",
    "suppose that @xmath264 .",
    "let @xmath265 be minimal so that @xmath266 and @xmath267 is contained in @xmath246 .",
    "observe that , without loss of generality , we may assume that such @xmath265 exists since , otherwise , the bound on @xmath25 follows by induction .",
    "the letter @xmath267 is a letter of some @xmath268 .",
    "if @xmath269 , then @xmath270 is a subword of @xmath271 and @xmath272 is a subword of @xmath273 for some @xmath274 .",
    "but , since @xmath275 and @xmath276 , it follows that for every letters @xmath259 and @xmath260 from @xmath270 and @xmath272 , the global positions @xmath261 and @xmath262 ( with respect to @xmath166 ) coincide , which contradict the definition of the dm - normal form .",
    "if @xmath277 , then the bound on @xmath25 follows by induction .",
    "the objective of this section is to establish the basics of algebraic geometry over groups .",
    "we refer the reader to @xcite for details .",
    "let @xmath278 be a group and @xmath279 be the free group on the alphabet @xmath3 , @xmath280 .",
    "denote by @xmath281 $ ] the free product @xmath282 .    for any element",
    "@xmath283 $ ] , the formal equality @xmath284 can be treated , in an obvious way , as an _ equation _ over @xmath0 . in general , for a subset @xmath285 $ ] , the formal equality @xmath286 can be treated as _ a system of equations _ over @xmath0 with coefficients in @xmath20 .",
    "elements from @xmath3 are called _ variables _ and elements from @xmath287 are called _ coefficients _ or _ constants_. to emphasize this we sometimes write @xmath288 .    a _ solution",
    "_ @xmath289 of the system @xmath290 over a group @xmath0 is a tuple of elements @xmath291 such that every equation from @xmath87 vanishes at @xmath292 , i.e. @xmath293 in @xmath0 , for all @xmath294 .",
    "equivalently , a solution @xmath289 of the system @xmath295 over @xmath0 is a @xmath0-homomorphism @xmath296 \\to g$ ] induced by the map @xmath297 such that @xmath298 .",
    "when no confusion arises , we abuse the notation and write @xmath299 , where @xmath300 $ ] , instead of @xmath301 .",
    "denote by @xmath302 the normal closure of @xmath87 in @xmath281 $ ] .",
    "then , every solution of @xmath290 in @xmath0 gives rise to a @xmath0-homomorphism @xmath303 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { \\operatorname{ncl}\\langle s\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle s\\rangle}$ } } } \\to g$ ] , and vice versa .",
    "the set of all solutions over @xmath0 of the system @xmath286 is denoted by @xmath304 and is called the _ algebraic set _ or _ variety _ defined by @xmath87 .    for every system of equations @xmath87",
    ", we set the _ radical of the system @xmath87 _ to be the following subgroup of @xmath281 $ ] : @xmath305 \\ \\mid \\ \\forall g_1,\\dots,\\forall g_n   \\left ( s(g_1,\\dots , g_n ) = 1 \\rightarrow t(g_1,\\dots , g_n ) = 1\\right ) \\right\\}.\\ ] ] it is easy to see that @xmath306 is a normal subgroup of @xmath281 $ ] that contains @xmath87 .",
    "there is a one - to - one correspondence between algebraic sets @xmath304 and radical subgroups @xmath306 of @xmath281 $ ] .",
    "notice that if @xmath307 , then @xmath308 $ ] .",
    "it follows from the definition that @xmath309    the quotient group @xmath310 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { r(s)}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${r(s)}$}}}\\ ] ] is called the _ coordinate group _ of the algebraic set @xmath304 ( or of the system @xmath87 ) .",
    "there exists a one - to - one correspondence between algebraic sets and coordinate groups .",
    "more formally , the categories of algebraic sets and coordinate groups are dual , see ( * ? ? ?",
    "* theorem 4 ) .",
    "if a group @xmath311 is given as the quotient @xmath303 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { r(s)}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${r(s)}$}}}$ ] , we say that @xmath0 is given by its _",
    "radical presentation_. if the corresponding system @xmath87 is finite , we say that @xmath0 is given by a _ finite radical presentation_.    given a system of equations @xmath286 , we denote by @xmath312 the group @xmath303 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { \\operatorname{ncl}\\langle s\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle s\\rangle}$}}}$ ] .    a group @xmath26 is called ( @xmath0-)_equationally noetherian _ if every system @xmath290 with coefficients from @xmath0 is equivalent over @xmath0 to a finite subsystem @xmath313 , where @xmath314 , i.e. the system @xmath87 and its subsystem @xmath315 define the same algebraic set .",
    "if @xmath0 is @xmath0-equationally noetherian , then we say that @xmath0 is equationally noetherian . if @xmath0 is equationally noetherian then the zariski topology over @xmath316 is _ noetherian _ for every @xmath238 , i.e. , every proper descending chain of closed sets in @xmath316 is finite .",
    "this implies that every algebraic set @xmath174 in @xmath316 is a finite union of irreducible subsets , called _",
    "irreducible components _ of @xmath174 , and such a decomposition of @xmath174 is unique . recall that a closed subset @xmath174 is _ irreducible _ if it is not a union of two proper closed ( in the induced topology ) subsets .",
    "we note that partially commutative groups are linear , see @xcite , thus , equationally noetherian , see @xcite .",
    "we say that a family of homomorphisms @xmath317 _ separates _ ( _ discriminates _ ) @xmath26 into @xmath318 if for every non - trivial element @xmath319 ( every finite set of non - trivial elements @xmath320 ) there exists @xmath25 so that @xmath321 ( @xmath322 for every @xmath323 ) . in this case",
    ", we also say that @xmath26 is _ residually @xmath318 _ ( that @xmath26 is _ fully residually @xmath318 _ ) and call the family @xmath324 _ separating _ ( _ discriminating _ ) .",
    "there is a natural epimorphism from @xmath303 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { \\operatorname{ncl}\\langle s\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle s\\rangle}$}}}$ ] onto @xmath325 .",
    "this epimorphism is an isomorphism if and only if @xmath303 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { \\operatorname{ncl}\\langle s\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle s\\rangle}$}}}$ ] is residually @xmath0 .    a finitely generated fully residually @xmath26 group @xmath0 ,",
    "is called a _",
    "limit group _ over @xmath26 .",
    "the term limit group was introduced by sela in @xcite in the setting of free groups .",
    "the original definition is given in terms of the action of @xmath0 on a limiting real tree .",
    "one can prove , see @xcite , that , in the case of free groups , the geometric and residual definitions are equivalent .    [ thm : limgrchar ] let @xmath26 be a group . then , for a finitely generated group @xmath0 the following conditions are equivalent :    1 .",
    "@xmath0 is fully residually @xmath26 ; 2 .",
    "@xmath0 is the coordinate group of an irreducible variety over @xmath26 .    if any of the above two conditions holds , then    1 .",
    "@xmath0 embeds into an ultrapower of @xmath26 .",
    "furthermore if @xmath26 is equationally noetherian , then all three conditions above are equivalent .",
    "[ lem : discfam ] let @xmath0 be a limit group over @xmath26 and let @xmath324 be a discriminating family for @xmath0 . if the family @xmath324 is a union of finitely many families , @xmath326 , then one of the families @xmath327 is a discriminating family for @xmath0 .    without loss of generality",
    ", we may assume that @xmath328 and @xmath329 .",
    "we show that either @xmath330 or @xmath331 is a discriminating family for @xmath0 .",
    "assume the contrary , then there exist finite sets of non - trivial elements @xmath332 and @xmath333 which can not be discriminated into @xmath26 by @xmath330 and @xmath331 , correspondingly , i.e. for all @xmath249 we have @xmath334 and @xmath335 for some @xmath336 , @xmath337 .",
    "since @xmath338 , the set @xmath339 can not be discriminated by @xmath324 into @xmath26 - a contradiction .",
    "[ rem : discfam ] let @xmath0 be a group discriminated by a finitely generated partially commutative group @xmath18 . notice that since @xmath18 has only finitely many different canonical parabolic subgroups , then , by lemma [ lem : discfam ] , for any @xmath340 , there exists a canonical parabolic subgroup @xmath232 of @xmath18 with the two following properties : there exists a discriminating family @xmath324 such that @xmath341 and there exist no proper subgroups @xmath342 of @xmath232 with the first property .",
    "in this section we review the theory of co - special actions on @xmath2 cube complexes , see @xcite .    a _ cube complex _",
    "@xmath3 is a cw - complex where each @xmath238-cell @xmath343 is a standard euclidean @xmath238-cube whose attaching map @xmath344 satisfies the following conditions :    1 .   the restriction of @xmath345 to every fact of @xmath346 is a linear homeomorphism onto a cube of one lower dimension ; 2 .",
    "@xmath347 is a homeomorphism onto its image .",
    "we give @xmath3 the standard cw - topology .",
    "we refer to 1-cells as edges or as 1-cubes and to 0-cells as vertices or 0-cubes .",
    "let @xmath3 denote a cube complex .",
    "the link @xmath348 of a cube @xmath343 is a _ simplicial _ complex whose @xmath238-skeleta are defined inductively as follows :    * the set of vertices of @xmath348 is @xmath349 ; * the set of @xmath238-simplices , @xmath350 of @xmath348 is @xmath351    the cube complex @xmath3 is _ combinatorially non - positively _ curved if each vertex link is flag ( that is each complete subgraph is the 1-skeleton of a simplex ) .",
    "we say that @xmath3 is combinatorially @xmath2 whenever @xmath3 is combinatorially non - positively curved and simply - connected .",
    "following sageev , @xcite , we call a simply connected combinatorially non - positively curved cube complex a _ cubing_.    each cube of @xmath3 can be given the metric of a standard unit euclidean cube in @xmath352 .",
    "one can then put on a cubing @xmath3 a pseudo - metric , which , in fact , turns @xmath3 into a complete @xmath2 metric space @xmath353 , @xcite .",
    "let @xmath3 be a cube complex .",
    "then , @xmath3 is combinatorially non positively curved if and only if the length metric @xmath170 on @xmath3 is locally @xmath2 . in particular ,",
    "a cube complex is metrically @xmath2 if and only if it is combinatorially @xmath2 .",
    "hence , the metric and combinatorial geometry of @xmath2 cube complexes are closely connected , see @xcite for more details .",
    "we work with non - positively curved cube complexes from a combinatorial viewpoint and consider them as higher - dimensional analogues of graphs .",
    "however , to introduce certain notions , it will be convenient to think of the cube complex as a geometric object .    a midcube in the cube @xmath354\\times \\dots \\times[0,1]$ ] is the subset obtained by restricting one of the coordinates to @xmath355 , so the midcube is parallel to two @xmath356-faces of @xmath357 .",
    "the edges of @xmath357 dual to this midcube are the edges perpendicular to it .",
    "the center of an @xmath238-cube in a cube complex is the image of @xmath358 from the corresponding @xmath238-cell .",
    "the center of an edge is its midpoint .    given a cube complex @xmath3 , we form a new cube complex @xmath359 , whose cubes are the midcubes of cubes of @xmath3 .",
    "the vertices of @xmath359 are the midpoints of edges of @xmath3 .",
    "the restriction of a @xmath360-cell of @xmath3 to a midcube of @xmath361 defines the attaching map of a @xmath25-cell in @xmath359 .",
    "each component of @xmath359 is a _",
    "hyperplane _ of @xmath3 .",
    "an edge of @xmath3 is dual to some hyperplane @xmath26 if its midpoint is a vertex of @xmath26 .",
    "each edge @xmath346 is dual to a unique hyperplane , which we will denote by @xmath362 .",
    "two hyperplanes @xmath20 , @xmath363 of a cube complex @xmath3 _ intersect _ if @xmath364 , they _ cross _ if they intersect but are not equal .",
    "set @xmath365 and let @xmath366,[f]\\in \\mathcal{h}$ ] .",
    "elements of @xmath367 are sometimes called _ ( unoriented )",
    "combinatorial hyperplanes_. combinatorial hyperplanes are in one - to - one correspondence with hyperplanes .",
    "when no confusion arises we refer to combinatorial hyperplanes as simply hyperplanes .    we will use a combinatorial metric defined on the set of vertices of @xmath3 .",
    "let @xmath368 be the set of oriented edges of @xmath3 .",
    "an edge path or simply a _ path _ in @xmath3 is a finite sequence of oriented edges such that the end of each edge is the origin of its successor .",
    "the length of a path is just the number of edges in the sequence . given two vertices @xmath369 we define the distance @xmath370 between @xmath371 and @xmath372 as the infimum of the lengths of paths between them",
    ". one can check that @xmath373 is a metric , called the _ edge - path metric_.    sometimes , we shall consider cube complexes with the rescaled edge - path metric .",
    "let @xmath374 and @xmath375 , then we define the rescaled edge - path metric @xmath376 on a cube complex @xmath3 as follows .",
    "for any @xmath377 , set @xmath378    as we have already mentioned , essentially , just as graphs , cube complexes are combinatorial objects . just as any simplicial tree ( graph )",
    "can be made into a metric tree ( graph ) by identifying every edge with @xmath379 $ ] , given a cube complex @xmath3 with a ( rescaled ) edge - path metric @xmath376 , we shall make @xmath3 into a _",
    "metric cube complex_. we identify every edge of @xmath3 with @xmath380 $ ] and endow every cube of @xmath3 with the @xmath381 metric .",
    "we thereby obtain a metric on @xmath3 that we denote by @xmath382 .",
    "observe that for any vertices @xmath377 we have @xmath383 .",
    "furthermore , any combinatorial isometry of @xmath384 induces an isometry of @xmath385 .",
    "we shall consider only combinatorial isometries of cube complexes and for the most part identify @xmath386 and @xmath387 , and abusing the notation and terminology , refer to @xmath386 as to @xmath387 , in particular , in sections [ sec:6 ] and [ sec:7 ] .",
    "let @xmath3 be a cube complex and let @xmath368 be the set of edges of @xmath3 .",
    "we define the equivalence relation @xmath388 as follows : set @xmath389 , @xmath390 if and only if there exists a finite sequence of edges @xmath391 such that for each @xmath392 , the edges @xmath393 and @xmath394 are opposite sides of some 2-cube in @xmath3 oriented in the same direction .",
    "special cube complexes were introduced by f.  haglund and d.  wise , @xcite .",
    "following haglund and wise , we define a special cube complex as a nonpositively curved cube complex which does not have certain pathologies related to its immersed hyperplanes .",
    "an immersed hyperplane @xmath11 crosses itself if it contains two different midcubes from the same cube of @xmath166 .",
    "an immersed hyperplane @xmath11 is @xmath28-sided if the map @xmath395 extends to a map @xmath396 which is a combinatorial map of cube complexes . when @xmath11 is @xmath28-sided , it is possible to consistently orient its dual @xmath397-cubes so that any two dual @xmath397-cubes lying ( opposite each other ) in the same @xmath28-cube are oriented in the same direction .",
    "an immersed @xmath28-sided hyperplane @xmath11 self - osculates if for one of the two choices of induced orientations on its dual @xmath397-cells , some @xmath5-cube @xmath36 of @xmath166 is the initial @xmath5-cube of two distinct dual @xmath397-cells of @xmath11 .",
    "a pair of distinct immersed hyperplanes @xmath398 cross if they contain distinct midcubes of the same cube of @xmath166 .",
    "we say @xmath399 osculate , if they have dual @xmath397-cubes which contain a common @xmath5-cube , but do not lie in a common @xmath28-cube . finally , a pair of distinct immersed hyperplanes @xmath398 inter - osculate if they both cross and osculate , meaning that they have dual @xmath397-cubes which share a @xmath5-cube but do not lie in a common @xmath28-cube .",
    "a cube complex is special if all the following hold , see ( * ? ? ?",
    "* figure 1 ) :    1 .",
    "no immersed hyperplane crosses itself ; 2 .",
    "each immersed hyperplane is @xmath28-sided ; 3 .   no immersed hyperplane self - osculates ; 4 .",
    "no two immersed hyperplanes inter - osculate .",
    "all cube complexes we consider are special and connected unless stated otherwise .",
    "central examples of special cube complexes are cube complexes associated to partially commutative groups .",
    "let @xmath18 be a ( perhaps infinitely generated ) partially commutative group .",
    "the 2-complex @xmath3 of the standard presentation of @xmath18 extends to a non - positively curved cube complex @xmath400 by adding an @xmath238-cube ( in the form of an @xmath238-torus ) for each set of @xmath238 pairwise commuting generators .",
    "it is well - known , see ( * ? ? ?",
    "* example 3.3 ) , that    * every graph is a special 1-dimensional cube complex ; * every @xmath2 cube complex is special ; * for any ( not necessarily finitely generated ) partially commutative group @xmath18 , the complex @xmath400 is a special cube complex .    given a partially commutative group , throughout this text we denote by @xmath400 the standard complex of @xmath18 and by @xmath401 its universal cover .",
    "the universal cover @xmath401 is a @xmath2 cube complex whose @xmath397-skeleton is the cayley graph @xmath402 of the standard presentation of @xmath18 .",
    "as the following series of results show , not only @xmath400 and @xmath401 are important examples of special cube complexes , but essentially these examples are universal .    [",
    "prop : liso ] a cube complex @xmath3 is special if and only if it admits a combinatorial local isometry to the cube complex @xmath400 of a ( not necessarily finitely generated ) partially commutative group @xmath18 .",
    "furthermore , if @xmath3 is special , then @xmath22 is a subgroup of @xmath18 .",
    "as we have already discussed , cubings are a natural generalisation of simplicial trees .",
    "while the structure of groups acting ( without inversions ) on simplicial trees is well understood , the structure of groups acting ( essentially ) even freely on cubings may be extremely complex , as shown by examples of burger and mozes , @xcite .",
    "proposition [ prop : liso ] motivates the definition of a co - special action . in the case of trees ,",
    "if a group acts on a tree freely and without inversions ( and , therefore , in this case , co - specially ) , the group is a subgroup of a free group . in the case of co - special actions on cubings ,",
    "proposition [ prop : liso ] can be reformulated as follows .",
    "[ prop : hw ] a group @xmath0 acts freely co - specially on a ( not necessarily finite dimensional ) cubing @xmath166 if and only if it is a subgroup of a ( not necessarily finitely generated ) partially commutative group .",
    "furthermore , by construction of the @xmath20-typing maps , see ( * ? ? ?",
    "* sections 3 and 4 ) , one can extract a more specific result .",
    "[ cor : hw ] let @xmath0 be a group acting freely co - specially on a ( not necessarily finite dimensional ) cubing @xmath166 .",
    "then ,    * there exists a combinatorial isometric embedding of @xmath166 into the universal cover @xmath401 of the standard complex of a ( not necessarily finitely generated ) partially commutative group @xmath18 ; * the action of @xmath0 on @xmath166 extends to a free co - special action @xmath403 of @xmath0 on @xmath401 . *",
    "the action @xmath403 is induced by the action of @xmath0 by left multiplication on the cayley graph @xmath402 .",
    "the following result is not hard to deduce from proposition [ prop : hw ] .",
    "[ prop : corhw ] let @xmath0 be a finitely generated group .",
    "then , the group @xmath0 acts freely co - specially on a finite dimensional cubing @xmath166 if and only if it is a subgroup of a finitely generated partially commutative group @xmath404 .",
    "let @xmath405 be a finitely generated subgroup of a ( perhaps , infinitely generated ) partially commutative group @xmath18 .",
    "then , @xmath0 is a subgroup of @xmath406 , which in turn is a canonical parabolic subgroup of @xmath18 .",
    "the group @xmath0 acts ( freely ) by left multiplication on the cayley graph @xmath407 of @xmath404 .",
    "the cayley graph @xmath407 is the @xmath397-skeleton of the universal cover @xmath408 of the standard complex @xmath409 of @xmath404 and the action of @xmath0 on @xmath407 gives rise to a free co - special action on @xmath408 .",
    "conversely , if @xmath0 is a finitely generated group acting freely and co - specially on a cubing , using an @xmath20-typing map , see ( * ? ? ?",
    "* sections 3 and 4 ) , one obtains an embedding of @xmath0 into a ( a priori infinitely generated ) partially commutative group @xmath18 . as above , we conclude that as @xmath0 is finitely generated , so it embeds into a finitely generated canonical parabolic subgroup @xmath404 of @xmath18 .",
    "finitely generated partially commutative groups enjoy many nice properties , which are not shared by infinitely generated ones . in our setting , it will be crucial that the group @xmath0 acting co - specially on a cubing @xmath166 be a subgroup of a finitely generated partially commutative group .",
    "we have seen above that one can restrict the consideration to finitely generated groups in order to make sure that @xmath0 indeed is a subgroup of a finitely generated partially commutative group . alternatively , as is done by haglund and wise ,",
    "see @xcite , one can impose the condition that the quotient of @xmath166 by the action of @xmath0 have finitely many immersed hyperplanes .",
    "however , both of these approaches have their limitations . on the one hand , requiring that the quotient have only finitely many immersed hyperplanes , imposes strong restrictions not only on the group @xmath0 , but also on the action of @xmath0 on @xmath166 , for instance , one automatically excludes many non co - compact actions of subgroups of partially commutative groups .    on the other hand , the assumption that the group @xmath0 is finitely generated is not sufficient in our setting .",
    "suppose we are given a sequence of free actions of finitely generated groups @xmath410 on cubings @xmath411 ( we shall see in the following sections that this is precisely the setting we are interested in ) .",
    "each of these actions defines an embedding of @xmath410 into a partially commutative group @xmath412 .",
    "it may happen that the ranks of @xmath412 tend to infinity as @xmath249 tends to infinity and therefore , we can not find a finitely generated universe for the groups @xmath410 . as we have mentioned in the introduction , a positive solution of problem [ prob:1 ] would resolve this technical issue and allow to consider arbitrary cubings .",
    "our next goal is to show that one can impose a natural geometric restriction on the cubing @xmath166 that allows to solve a restricted version of problem [ prob:1 ] , namely , a group @xmath0 acts freely co - specially on a cubing of _ finite width _ if and only if @xmath0 is a subgroup of a finitely generated partially commutative group .",
    "furthermore , it allows us to find a universal partially commutative group that contains all groups @xmath0 acting freely on cubings of bounded width .",
    "moreover , we show that the free co - special action of a group @xmath0 on a cubing of finite width extends to a free co - special action of @xmath0 on the universal cover of the standard complex of a finitely generated partially commutative group .",
    "let @xmath3 be a special cube complex . then , by proposition",
    "[ prop : hw ] , there always exists a partially commutative group @xmath18 so that there exists a combinatorial local isometry from @xmath3 to @xmath400 .",
    "however , such an isometry is by far non - unique .",
    "for example , the @xmath20-typing map for the cayley graph of the free group @xmath413 of rank @xmath28 results in a free group of countable rank , but , of course , the cayley graph @xmath414 admits a combinatorial local isometry onto @xmath415 .",
    "[ defn : width ] let @xmath366,[f]\\in \\mathcal{h}$ ] be two hyperplanes of some cube complex .",
    "set @xmath366\\approx[f]$ ] if and only if every hyperplane @xmath416\\in \\mathcal{h}$ ] crosses @xmath366 $ ] if and only if it crosses @xmath417 $ ] .",
    "one can check that @xmath418 is an equivalence relation .",
    "denote by @xmath419 the quotient @xmath420 .",
    "we say that the cube complex @xmath3 is _ @xmath238-wide _ or has _",
    "width @xmath238 _ if and only if there exists a combinatorial local isometry from @xmath3 to @xmath421 , where @xmath422 is a partially commutative group such that @xmath423 , @xmath424 and @xmath238 is minimal with this property , i.e. for any @xmath425 so that @xmath426 , the cube complex @xmath3 does not admit a combinatorial local isometry onto @xmath427 . in this case",
    ", we write @xmath428 .",
    "if @xmath429 for some @xmath424 , we say that @xmath3 is of _ finite width _ , otherwise , we call @xmath3 _ infinitely wide_.    throughout this text , given a special cube complex @xmath3 of width @xmath238 , we denote by @xmath430 a partially commutative group so that @xmath431 and there is a combinatorial local isometry from @xmath3 to @xmath432 .    let @xmath3 be a special cube complex of width @xmath238 , then there is a combinatorial isometric embedding of the universal cover @xmath433 into @xmath434 for some partially commutative group @xmath422 , where @xmath435 .",
    "conversely , if @xmath3 is a cubing which admits a combinatorial isometric embedding into @xmath401 so that @xmath436 , and @xmath437 is a covering map , then @xmath438 have finite width and @xmath439 .",
    "we now record the following observations about the width of cube complexes , which follow directly from the definition .",
    "[ lem : width ]    1 .",
    "the width of any graph is one .",
    "the width of the standard cubulation of the euclidean space @xmath440 is @xmath238 .",
    "3 .   more generally , if @xmath3 and @xmath441 are cube complexes , then @xmath442 .",
    "4 .   if the width of @xmath3 is finite , then @xmath3 is finite dimensional .",
    "the width of any compact cube complex is finite .",
    "if a cube complex contains only finitely many embedded hyperplanes , then it has finite width .",
    "let @xmath18 be a partially commutative group with the underlying graph @xmath64 , @xmath443 , then the deflation @xmath128 of @xmath64 is a finite graph with @xmath30 vertices and @xmath444 .    the main result of this section is the following free actions theorem for special cube complexes of finite width .",
    "viewing simplicial trees as @xmath397-dimensional cubings and graphs as @xmath397-dimensional special cube complexes , the next theorem is a natural generalisation of the free actions theorem for trees : a group acts freely without inversions of edges ( and hence co - specially ) on a tree if and only if it is a subgroup of a finitely generated free group .",
    "let @xmath0 be a group .",
    "then , @xmath0 acts freely co - specially on a cubing of width @xmath238 if and only if @xmath0 is a subgroup of a partially commutative group @xmath18 and @xmath436 .",
    "let @xmath401 be the universal cover of @xmath400 and @xmath445 .",
    "every subgroup @xmath0 of @xmath18 acts ( freely ) by left multiplication on the cayley graph @xmath402 of @xmath18 . since @xmath402 is the @xmath397-skeleton of @xmath401 , we get a free co - special action of @xmath0 on @xmath401 .",
    "conversely , if @xmath3 is a cubing of width @xmath238 , then there exists a combinatorial local isometry from @xmath3 to @xmath421 , where @xmath435 .",
    "therefore , by proposition [ prop : liso ] , @xmath0 embeds into @xmath422 .",
    "[ lem:2k ] let @xmath63 be a partially commutative group so that @xmath446 .",
    "then , @xmath18 is a subgroup of a @xmath447-generated partially commutative group .",
    "let @xmath128 be the deflation of @xmath64 .",
    "then , by lemma [ lem : width ] , @xmath128 has exactly @xmath238 vertices .",
    "define the graph @xmath448 as follows .",
    "the graph @xmath448 is a finite graph with exactly @xmath447 vertices constructed from @xmath128 . for every vertex @xmath449 ,",
    "we introduce two vertices @xmath450 . we set @xmath451 if and only if @xmath452 , for all @xmath453 , @xmath454 .    observe that both @xmath89 and @xmath455 can be viewed as a graph product of groups with the underlying graph @xmath128 and free vertex groups ( see @xcite for definition and basic properties of graph products ) . for every vertex @xmath449 ,",
    "let @xmath456)$ ] be the free group generated by @xmath457 $ ] associated to the corresponding vertex of the graph product @xmath89 and let @xmath458 be the free group generated @xmath459 associated to the corresponding vertex of the graph product @xmath455 .",
    "let @xmath460)\\hookrightarrow f(v_1,v_2)$ ] be an embedding of @xmath456)$ ] into @xmath458 .",
    "the embeddings @xmath461 , @xmath449 , give rise to an embedding @xmath462 .",
    "we conclude that @xmath18 is a subgroup of a @xmath447-generated partially commutative group @xmath455 .",
    "[ cor : finitewidth ] let @xmath0 be a group .",
    "then , @xmath0 acts freely co - specially on a cubing of finite width if and only if @xmath0 is a subgroup of a finitely generated partially commutative group .",
    "given a special cube complex @xmath3 of width @xmath238 , the @xmath447-generated partially commutative group constructed from @xmath430 in lemma [ lem:2k ] will be denoted by @xmath463 .",
    "as we have shown above , if a group @xmath0 acts freely co - specially on a cubing of finite width , then it is a subgroup of a finitely generated partially commutative group @xmath464 .",
    "we now show that there is a universal partially commutative group that contains all groups that act freely co - specially on cubings of a given width .    by lemma [ lem :",
    "width ] , for any @xmath465 there are only finitely many deflated graphs @xmath466 , so that @xmath467 . set @xmath468 to be the union of the graphs @xmath469 , @xmath470 and @xmath471 , where the graphs @xmath469 s are defined as in the proof of lemma [ lem:2k ] .",
    "observe that @xmath468 is a finite graph .",
    "we now arrive to the following    [ cor:1pcg ] for every @xmath472 , there exists a partially commutative group @xmath473 such that every group @xmath0 acting freely co - specially on a cubing @xmath166 of width @xmath30 is a subgroup of @xmath29 .",
    "our next goal is to show that if a group @xmath0 acts freely co - specially on a cubing @xmath166 of width @xmath238 , then one can construct an embedding from @xmath0 to @xmath474 so that it induces an equivariant quasi - isometric embedding from @xmath166 to the universal cover of @xmath475 .",
    "therefore , the study of groups acting freely co - specially on cubings of finite width reduces to the study of groups acting freely co - specially on the universal covers of standard complexes of partially commutative groups .",
    "let @xmath476 , @xmath477 be a finitely generated group acting on a cubing @xmath166 , and let @xmath478 .",
    "define _ the displacement at @xmath259 _ to be @xmath479 if the cubing @xmath166 has a designated based point @xmath480 , then the number @xmath481 is called the _ displacement of the action of @xmath0_.    [ lem : qie ] let @xmath482 , @xmath483 and @xmath484 be free groups on the indicated alphabets .",
    "let @xmath485 be @xmath486 words in @xmath484 so that @xmath487 , @xmath488 and @xmath489 does not begin or end with @xmath490 and contains the letter @xmath491 , @xmath492 .",
    "define the homomorphism @xmath493 as follows : @xmath494 where @xmath495 , @xmath492 and set @xmath496 for all @xmath497 .",
    "then , the map @xmath48 is an embedding of @xmath498 into @xmath484 , the restriction of @xmath48 onto @xmath499 is a quasi - isometric embedding and the quasi - isometry constant is @xmath500 .",
    "the proof that @xmath48 is an embedding is standard and left to the reader . abusing the notation",
    ", we denote the restriction of @xmath48 onto @xmath499 by @xmath48 .",
    "we only need to show that @xmath48 is a quasi - isometry and compute the quasi - isometry constant .    by definition @xmath501 and the equalities",
    "are attained for @xmath502 and @xmath503 , correspondingly . on the other hand , by the definition of @xmath48",
    ", it follows that for all @xmath504 the length @xmath505 satisfies the following inequality @xmath506 and the statement follows .",
    "[ lem : frgrqi ] let @xmath507 and @xmath484 be two free groups on the indicated generators .",
    "let @xmath508 be a finitely generated subgroup of @xmath498 .",
    "re - enumerating the generators of @xmath498 , let @xmath509 .",
    "we view @xmath510 , @xmath511 and @xmath512 as 1-dimensional cube complexes based at the identity .",
    "the embedding of @xmath26 into @xmath499 defines a subcomplex @xmath513 in @xmath511 .",
    "we designate the identity as the basepoint of @xmath513 .",
    "let @xmath403 be the action of @xmath26 on @xmath511 by left multiplication , let @xmath48 be the map defined in lemma [ lem : qie ] , let @xmath514 be the corresponding action of @xmath26 on @xmath484 and let @xmath515 and @xmath516 be the displacements of the corresponding actions .",
    "then ,    * the homomorphism @xmath48 induces an equivariant , quasi - isometric embedding @xmath517 of @xmath511 into @xmath512 , the constant of the quasi - isometry @xmath517 does not exceed @xmath518 ; * the following inequality holds : @xmath519 ; * the homomorphism @xmath48 induces an equivariant , quasi - isometric embedding @xmath520 of @xmath521 into @xmath522 , the quasi - isometry constant of @xmath520 does not exceed @xmath523 .",
    "by lemma [ lem : qie ] , for @xmath524 , the homomorphism @xmath48 induces the quasi - isometries @xmath517 and @xmath520 .",
    "we only need to compute the quasi - isometry constant .    by definition ,",
    "the displacement of the action is the displacement of the basepoint of the complex .",
    "therefore , in this case , the displacement @xmath515 equals @xmath525 .",
    "there are at most @xmath526 different letters in the words @xmath527 , therefore @xmath528 . by lemma [ lem : qie ]",
    ", it follows that the quasi - isometry constant of @xmath517 does not exceed @xmath518 .",
    "the displacement of @xmath516 equals @xmath529 .",
    "let @xmath530 , then @xmath531 . since @xmath532 and @xmath528 , we have @xmath533    on the other hand , since there exists @xmath7 , @xmath534 so that @xmath535 , we have that @xmath536    the last statement now follows from the first two .",
    "[ prop : uniqi ] let @xmath403 be a free co - special action of a @xmath25-generated group @xmath0 on a based cubing @xmath537 of width @xmath238 .",
    "let @xmath538 and @xmath539 be the corresponding partially commutative groups .",
    "let @xmath540 be the induced embedding and let @xmath541 be the action of @xmath0 induced by @xmath403 on @xmath434 .",
    "let @xmath542 and , re - enumerating the generators of @xmath543 , let @xmath544 , where @xmath545 are canonical generators of @xmath543 , @xmath492 .",
    "let @xmath48 be the embedding of @xmath543 into @xmath474 defined as in lemma [ lem:2k ] using the maps @xmath546 from lemma [ lem : qie ] , where @xmath524 .",
    "denote by @xmath547 the composition of @xmath548 and @xmath48 and let @xmath514 be the action of @xmath0 induced by @xmath403 on @xmath549 .",
    "endow @xmath166 , @xmath434 and @xmath549 with the edge - path metric and let the cubings @xmath434 and @xmath549 be based at lifts of the identity elements @xmath550 and @xmath551 of @xmath422 and @xmath464 , correspondingly .",
    "then ,    * the embedding @xmath547 induces an equivariant , based , quasi - isometric embedding @xmath517 of @xmath537 into @xmath552 ; * the following inequality holds @xmath553 ; * the embedding @xmath547 induces an equivariant , based , @xmath523-quasi - isometric embedding from @xmath554 to @xmath555 .",
    "by corollary [ cor : hw ] , the embedding of @xmath0 into @xmath422 induces an equivariant , combinatorial isometric embedding of @xmath166 into @xmath434 .",
    "hence , it suffices to show that the embedding @xmath48 of @xmath422 into @xmath464 and , consequently , the induced map @xmath517 from @xmath434 into @xmath549 can be chosen in such a way that the restriction @xmath556 of @xmath517 onto the image of @xmath166 in @xmath434 satisfies the statements of the proposition .",
    "the statement now follows by the definition of @xmath48 , see proof of lemmas [ lem:2k ] and [ lem : frgrqi ] .",
    "the aim of this section is to introduce and give examples of the main object of our study , _ real cubings_. we begin by recalling the notion of an ultralimit of metric spaces .",
    "we refer the reader to @xcite for more details .",
    "let @xmath557 be a non - principal ultrafilter on @xmath558 .",
    "let @xmath559 be a sequence of metric spaces with specified base - points @xmath560 .",
    "we say that a sequence @xmath561 , where @xmath562 , is _ admissible _ , if the sequence of real numbers @xmath563 is bounded .",
    "denote the set of all admissible sequences by @xmath564 .",
    "it is easy to see from the triangle inequality that , for any two admissible sequences @xmath565 and @xmath566 , the sequence @xmath567 is bounded and hence there exists a @xmath557-limit @xmath568 .    define a relation @xmath122 on the set @xmath564 as follows .",
    "set @xmath569 if and only if @xmath570 .",
    "it is easy to show that @xmath122 is an equivalence relation on @xmath564 .",
    "the _ ultralimit _ @xmath571 with respect to @xmath557 of the sequence @xmath572 is a metric space @xmath573 defined as follows . as a set",
    ", we have @xmath574 . for two @xmath122-equivalence classes @xmath575 $ ] and @xmath576}$ ] of admissible sequences @xmath577 and @xmath578 , we set @xmath579 , [ \\mathbf y])=\\hat d_\\infty(\\mathbf x,\\mathbf y)=\\lim\\limits_{\\mathfrak{u}}d_n(x_n , y_n)$ ] .",
    "it is not hard to see that @xmath580 is well - defined and that it is a metric on the set @xmath581 .    an important class of ultralimits are the so - called _ asymptotic cones _ of metric spaces .",
    "let @xmath353 be a metric space , let @xmath557 be a non - principal ultrafilter on @xmath558 , let @xmath582 be a sequence of base - points and let @xmath583 be a sequence of positive integers .",
    "then , the @xmath557-ultralimit of the sequence @xmath584 is called the asymptotic cone of @xmath3 with respect to @xmath557 , @xmath585 and @xmath586 and is denoted @xmath587 .",
    "the point @xmath588 is called the _ observation point _ and the sequence @xmath583 is called the _ scaling sequence_. an asymptotic cone of a group @xmath0 is simply an asymptotic cone of its cayley graph .",
    "note that it is customary to require that @xmath589 . in our setting , we allow for the possibility that the asymptotic cone of a cubing be a ( simplicial ) metric cubing .",
    "the following properties of ultralimits of metric spaces are well - known , see @xcite .    1 .   if @xmath590 are geodesic metric spaces , then @xmath591 is also a geodesic metric space .",
    "2 .   the ultralimit @xmath591 of metric spaces is a complete metric space .",
    "3 .   let @xmath592 and let @xmath590 be a sequence of @xmath593-metric spaces .",
    "then , the ultralimit is also a @xmath593-space .",
    "4 .   let @xmath590 be a sequence of @xmath594-metric spaces , where @xmath595 .",
    "then , @xmath591 is a real tree .",
    "we recall that every cubing @xmath3 can be turned into a metric cubing by endowing every cube of @xmath3 with the @xmath381 metric .",
    "[ defn : rcub ] let @xmath596 , @xmath597 be a sequence of cubings with fixed based points @xmath598 endowed with the metric @xmath599 , and let @xmath557 be a non - principal ultrafilter on @xmath558 .",
    "suppose that the widths of @xmath600 are uniformly bounded by a fixed @xmath465 .",
    "then , we call the ultralimit @xmath601 a _",
    "real cubing_.    let @xmath602 and suppose that @xmath603 , for all @xmath604 . then",
    ", we say that @xmath605 is a real cubing of _ width @xmath30_. note that the width of a real cubing is well - defined by the properties of the ultrafilters .",
    "the following proposition follows from well - known results , see @xcite    let @xmath605 be a real cubing , then @xmath605 is a complete contractible @xmath2 space .",
    "as the following example demonstrates , the class of real cubings is very wide .    1",
    ".   any asymptotic cone of a finitely generated partially commutative group is a real cubing since it is an ultralimit of the universal cover of the standard complex of the partially commutative group .",
    "asymptotic cones of nilpotent group are homeomorphic to @xmath606 for some @xmath25 , see @xcite , hence the asymptotic cone of any nilpotent group is homeomorphic to a real cubing .",
    "it is well known that @xmath607 is quasi - isometric to the direct product of the hyperbolic plane with the real line , hence every asymptotic cone of @xmath607 is bi - lipschitz equivalent to the direct product of a real tree and the real line , and , in fact , see @xcite , every asymptotic cone of the universal cover of @xmath607 endowed with the sasaki metric is isometric to a real cubing .",
    "4 .   let @xmath608 be a compact connected riemannian manifold of dimension @xmath609 , where @xmath610 is a riemannian metric on @xmath611 .",
    "let @xmath170 be the metric on @xmath611 corresponding to @xmath610 , so that @xmath612 is a geodesic metric space .",
    "choose a basepoint @xmath613 .",
    "then , the ultralimit ( and even the ordinary gromov - hausdorff limit ) @xmath614 is isometric to the tangent space @xmath615 of @xmath611 at @xmath371 with the distance function on @xmath615 given by the inner product @xmath616",
    ". therefore the ultralimit is isometric to the euclidean space with the standard euclidean metric and is bi - lipschitz equivalent to a real cubing .",
    "the asymptotic cone of any toral relatively hyperbolic group is bi - lipschitz equivalent to a real cubing , @xcite .    we shall need the following lemma , which is well - known and easy to prove .    [",
    "lem : limiso ] let @xmath617 and @xmath618 be a sequence of based metric spaces and let @xmath557 be an ultrafilter .",
    "suppose that @xmath619 and @xmath620 are @xmath621 quasi - isometric and @xmath622",
    ". then , @xmath623 and @xmath624 are @xmath363-bi - lipschitz equivalent .",
    "real trees were introduced independently by chiswell and tits , see @xcite and @xcite .",
    "chiswell proved the equivalence of the bass - serre theory of groups acting on simplicial trees ( without inversions of edges ) and integer - valued length functions on a group , see @xcite . following this approach , for a group @xmath0 with a real - valued length function , chiswell defined a real tree as a contractible metric space @xmath3 on which the group @xmath0 acts .    in his book @xcite",
    ", serre constructed the @xmath625-tree associated to a discrete rank one valuation .",
    "this tree is the @xmath625-case of bruhat - tits building .",
    "having groups with more general valuations , tits generalised the tits building construction in the @xmath625-case to the case of more general valuations .    one can show that the spaces defined by chiswell and tits are complete and , in fact , are real cubings .",
    "later , alperin and moss , @xcite gave a more general definition of real trees as spaces where every two points can be joined by a unique arc or , equivalently , as @xmath5-hyperbolic spaces .",
    "in analogy to the work of alperin and moss , one can ask if there is a metric characterisation of real cubings .    there is yet another way to look at real trees :",
    "as metric spaces that are isometric to subspaces of the asymptotic cone of a free group , see @xcite . in this fashion , one could define a real cubing to be a ( convex ) subspace of the asymptotic cone of a finitely generated partially commutative group .",
    "just as rips theory can be viewed as the theory of groups acting on subspaces of the asymptotic cone of a free group , the theory developed in this paper can be regarded as the theory of groups acting on subspaces of asymptotic cones of partially commutative groups .",
    "since the nature of the actions we consider is that of an ultralimit of actions , we restrict our consideration to real cubings that are ultralimits of cubings .",
    "at this point we begin our study of group actions on real cubings . as we noticed in the introduction , intuitively , a `` good '' action on a space should capture its structure , hence in the case of direct product of trees , one would expect to recover some type of direct product structure .",
    "however , by examples constructed by burger and mozes , see @xcite , studying general , even free actions on direct product of trees ( and , more generally , on @xmath2 cube complexes ) is practically hopeless . on the other hand , as we have seen in sections [ sec:3 ] and [ sec:4 ] , free co - special group actions do preserve the structure of direct product and can be analysed .",
    "it is clear that any ( metric ) cubing is a real cubing , hence , if one is to understand the structure of groups acting on real cubings , one needs to have a good understanding of group actions on cubings .",
    "we therefore consider the class of essentially free co - special actions on real cubings - a natural generalisation of co - special actions on cubings . in a sense",
    ", essentially free co - special actions can be likened to very small actions on real trees , where vertex stabilisers also have a very small action on a real tree .",
    "let @xmath0 be a group acting co - specially by isometries on a cubing @xmath166 .",
    "let @xmath626 be the kernel of the action .",
    "we shall say that the action of @xmath0 on a cubing is _ essentially free _ if @xmath627 and the induced action of the group @xmath628 on @xmath166 is free .",
    "[ defn : essfr ] let @xmath629 be a real cubing .",
    "let @xmath630 be a sequence of group actions of a group @xmath0 on the cubings @xmath631 .",
    "suppose that for all @xmath632 and all @xmath633 the sequence of elements @xmath634 is admissible and thus represents an element of @xmath605 .",
    "define an action @xmath403 of @xmath0 on @xmath605 as follows : @xmath635 we call such an action _ limiting _ and the actions of @xmath0 on the @xmath411 s are called the _",
    "components _ of the limiting action .",
    "suppose further that we have a limiting action of @xmath0 on the real cubing @xmath605 .",
    "we say that @xmath0 acts _ essentially freely and co - specially _ on @xmath605 if the action of @xmath0 on @xmath605 is faithful , non - trivial ( i.e. without a global fixed point ) and the components of the action are essentially free and co - special actions .    in @xcite , guirardel showed that , in fact , any stable action of a finitely presented group on a real tree can be approximated by actions on simplicial trees . from this perspective , the theory of ( stable ) actions on real trees is the theory of ultralimits of actions on simplicial trees , @xcite .",
    "the main example of essentially free co - special action on a real tree ( viewed as @xmath397-dimensional real cubings ) is the action of a limit group @xmath0 via the ( discriminating ) family of homomorphisms from @xmath0 to @xmath636 , see @xcite .",
    "we now give the central example of essentially free co - special actions of finitely generated groups on real cubings .",
    "let @xmath0 be a finitely generated group and let @xmath18 be a partially commutative group with trivial centre .",
    "let @xmath477 be a finite set generating @xmath0 and let @xmath373 be the edge path metric on @xmath401 .",
    "given an infinite sequence of homomorphisms @xmath637 , one can associate to it a sequence of positive integers defined by @xmath638 it is well - known that if @xmath639 are pairwise non - conjugate in @xmath18 , since @xmath18 is finitely generated , then @xmath640 . since the image @xmath641 is a subgroup of @xmath18 , the subgroup @xmath641 acts by left multiplication on the cayley graph @xmath642 and",
    "thus every homomorphism @xmath643 defines an essentially free co - special action of @xmath0 on @xmath401 .    choose an ultrafilter @xmath557 and let @xmath644 , @xmath645 be so that @xmath646 for @xmath557-almost all @xmath238 .",
    "we then obtain a limiting action of @xmath0 on the asymptotic cone ( real cubing ) @xmath647 . by definition , if this action is faithful , then , as we show in proposition [ prop : conult ] , it is essentially free and co - special .    given a finitely generated group @xmath476 acting on a space @xmath3 , it is customary to define the displacement of the action as @xmath648 . as the following lemma shows ,",
    "if we are _ given _ an essentially free co - special group action on a real cubing , our definition of displacement and the usual one are basically equivalent .",
    "furthermore , this lemma allows us to change the basepoint of the real cubing .",
    "let @xmath476 be a finitely generated group acting essentially freely and co - specially on a real cubing @xmath649 .",
    "then , for any @xmath650 one has that @xmath651 where @xmath652 , @xmath653 .    by definition of the ultralimit , @xmath654 always exists .",
    "we are to show that @xmath655 .",
    "since the action of @xmath0 on @xmath605 ( and , in particular , the basepoint @xmath656 ) is well - defined , it follows that @xmath657 . on the other hand ,",
    "since the action of @xmath0 is essentially free and co - special and therefore non - trivial , we conclude that @xmath658 .",
    "the fact that @xmath659 , @xmath660 follows from the first statement .",
    "let @xmath0 be a finitely generated group acting essentially freely and co - specially on a real cubing @xmath605 by an action @xmath661 and let the width @xmath662 of @xmath605 be @xmath30 .",
    "then , by lemma [ lem : width ] and proposition [ prop : uniqi ] , @xmath557-almost all components of the action @xmath403 define a subgroup @xmath663 of a partially commutative group @xmath664 , where @xmath665 and @xmath666 has @xmath667 generators .",
    "since there are only finitely many such partially commutative groups , there exists a partially commutative group @xmath668 so that : @xmath668 is @xmath667-generated , the width @xmath669 equals @xmath30 and @xmath663 is a subgroup of @xmath668 for @xmath557-almost all @xmath249 .",
    "moreover , by proposition [ prop : uniqi ] , there is a quasi - isometric embedding of @xmath411 into @xmath670 .",
    "given an essentially free co - special action of @xmath0 on @xmath605 , we call the group @xmath671 _ the partially commutative group of @xmath605_.    let @xmath18 be a partially commutative group and let @xmath672 be its asymptotic cone . an isometry @xmath673 of @xmath672 is called a ( left ) _ translation _ if there exists an admissible element @xmath674 , @xmath675 so that for any point @xmath676 the image @xmath677 equals @xmath678 . the element @xmath71 is called the _ vector _ of the translation @xmath673 .",
    "note that for a translation @xmath673 , the vector @xmath71 may be defined non - uniquely .",
    "[ lem : translfaith ] let @xmath679 be a translation of @xmath672 with translation vector @xmath680 , where @xmath18 is a partially commutative group with trivial centre . then , the action @xmath681 is trivial on all the points of the asymptotic cone @xmath672 if and only if the element @xmath486 is the trivial element of @xmath682 .    by definition ,",
    "the @xmath249-th component of @xmath679 is simply the action on @xmath401 defined by the left multiplication by @xmath683 .",
    "assume by contradiction that the set @xmath684 belongs to the ultrafilter .",
    "for every non - trivial @xmath685 , we take a canonical generator @xmath686 of @xmath18 such that @xmath686 does not commute with @xmath683 and @xmath686 does not left - divide @xmath683 ( see @xcite for definition ) .",
    "notice that such a generator @xmath686 exists , since @xmath18 has trivial centre .",
    "let @xmath687 , where @xmath688 is the sequence of the scaling constants , be an element of @xmath672 .",
    "consider the distance @xmath689 .",
    "since the canonical generator @xmath686 neither divides nor commutes with @xmath683 , it follows from ( * ? ? ?",
    "* corrollary 4.8 ) that @xmath690 left - divides @xmath691 , hence @xmath692 and so the action @xmath679 is non - trivial on @xmath672 .",
    "we now show that the sequence of quasi - isometric embeddings of @xmath411 into @xmath670 induces an equivariant bi - lipschitz embedding of @xmath605 into the asymptotic cone of @xmath668 .",
    "[ prop : uem ] let @xmath403 be an essentially free co - special group action of a @xmath25-generated group @xmath0 on a real cubing @xmath693 and let @xmath694 be the components of this action .",
    "let @xmath668 be the partially commutative group of the real cubing @xmath605 , let @xmath695 be the action of @xmath0 on @xmath670 induced by @xmath696 and let @xmath697 be the embedding of @xmath698 into @xmath668 constructed in proposition [ prop : uniqi ] .",
    "then , there exists a @xmath0-equivariant bi - lipschitz embedding @xmath48 of @xmath605 into @xmath699 .",
    "let @xmath700 be the equivariant quasi - isometric embedding of @xmath701 into @xmath702 constructed in proposition [ prop : uniqi ] . identifying the @xmath397-skeleton of @xmath670 with the cayley graph of @xmath668 , the embedding @xmath700 maps the base - point @xmath598 to the identity - the base - point of @xmath670 .    by lemma [ lem : limiso ] ,",
    "the sequence of maps @xmath703 gives rise to a bi - lipschitz embedding @xmath48 of @xmath605 into @xmath699 defined by @xmath704 furthermore , since the actions @xmath695 are translations , the sequence of actions @xmath705 defines an action @xmath514 of @xmath0 on @xmath699 : @xmath706 it now follows by lemma [ lem : translfaith ] , that the action @xmath514 is essentially free and co - special .",
    "since the maps @xmath700 are equivariant , it follows that @xmath48 is a @xmath0-equivariant embedding .",
    "the corollary below follows by definition of a translation and by construction of the action of @xmath0 on @xmath707 given in proposition [ prop : uem ]    let @xmath0 be a finitely generated group acting essentially freely and co - specially on a real cubing @xmath605 .",
    "then , @xmath0 acts essentially freely and co - specially by translations on an asymptotic cone of a finitely generated partially commutative group .",
    "observe that the action of @xmath0 on @xmath708 defined in the proof of proposition [ prop : uem ] is by left translations , hence the statement .",
    "we have shown that essentially free co - special actions on real cubings induce essentially free co - special actions by left translations on asymptotic cones of partially commutative groups . as we have mentioned above",
    ", limit groups over partially commutative groups act essentially freely and co - specially by translations on the corresponding asymptotic cones .",
    "we now show that , basically , these are the only examples .    [ prop : conult ] let @xmath18 be a partially commutative group with trivial centre .",
    "let @xmath0 be a finitely generated group acting faithfully by translations on @xmath672 .",
    "then , @xmath0 embeds into the ultrapower @xmath709 of @xmath18 and so @xmath0 is fully residually @xmath18 .",
    "conversely , let @xmath0 be a finitely generated fully residually @xmath18 group . then , @xmath0 acts essentially freely and co - specially by translations on the asymptotic cone @xmath710 of @xmath18 .",
    "note that if @xmath0 acts essentially freely and co - specially by translations , then @xmath0 acts faithfully and so @xmath0 satisfies the assumptions of the above proposition .",
    "let @xmath711 be an admissible sequence representing an element of the asymptotic cone @xmath672 .",
    "then , the element @xmath486 defines an isometry @xmath679 of @xmath672 .",
    "the @xmath249-th component of @xmath679 is simply the action on @xmath401 defined by left multiplication by @xmath683 .",
    "define the map @xmath712 by sending every generator of @xmath0 to its translation vector .",
    "the map @xmath48 extends to a homomorphism from @xmath713 .",
    "indeed , since @xmath0 acts on @xmath672 , it follows that for any relation @xmath486 of @xmath0 and any point @xmath714 we have that the action of @xmath486 on @xmath260 is trivial , i.e. @xmath715 . by lemma [ lem : translfaith ] , it then follows that the translation vector @xmath486 is , in fact , the trivial element of @xmath709 and hence @xmath48 is a homomorphism .",
    "the homomorphism @xmath48 gives rise to an action of @xmath0 on @xmath709 .",
    "since @xmath0 acts faithfully on @xmath672 , the induced action of @xmath0 on @xmath709 is faithful .",
    "therefore , the homomorphism @xmath48 is injective .",
    "we conclude that @xmath0 is fully residually @xmath18 since so is every subgroup of @xmath709 , see theorem [ thm : limgrchar ] .",
    "on the other hand , any fully residually @xmath18 group @xmath0 can be viewed as a subgroup of @xmath709 .",
    "therefore , @xmath0 acts faithfully on @xmath709 by left translations .",
    "furthermore , since the group @xmath0 is finitely generated one can choose scaling constants so that every translation vector corresponding to an element of @xmath0 is admissible in the asymptotic cone and hence the group @xmath0 acts on @xmath672 . since the action of @xmath0 on @xmath709 is faithful , the translation vector @xmath716 corresponding to a non - trivial element @xmath610 of @xmath0 is non - trivial . by lemma [ lem : translfaith ] ,",
    "the action of @xmath716 on the asymptotic cone is non - trivial .",
    "it follows that the action of @xmath0 on @xmath672 is faithful .",
    "let @xmath18 be the free abelian group of finite rank @xmath238 and let @xmath672 be its asymptotic cone .",
    "then , @xmath672 is isometric to @xmath717 with the @xmath381 metric .",
    "it is not hard to see that if a finitely generated group @xmath0 acts faithfully by translations on @xmath717 , then @xmath0 is free abelian .",
    "let @xmath18 be an arbitrary partially commutative group and @xmath718 be its centre , i.e. @xmath719 and @xmath720 .",
    "let @xmath0 be a finitely generated group acting essentially freely by translations on @xmath721 , then @xmath0 is a subgroup of a group of the form @xmath722 , where @xmath723 is a finitely generated group acting faithfully by translations on @xmath724 .",
    "hence , @xmath725 , where @xmath726 is a finitely generated group acting faithfully by translations on @xmath724 .",
    "moreover , @xmath0 is fully residually @xmath18 .",
    "let @xmath727 be a set of generators of @xmath0 and let @xmath728 be the translation vector of @xmath729 , @xmath61 .",
    "write @xmath730 , where @xmath731 and @xmath732 for all @xmath249 and @xmath238 .",
    "consider the subgroup @xmath26 of isometries of @xmath672 generated by the @xmath733 translations @xmath734 .",
    "it is clear that @xmath735 and that @xmath0 is a subgroup of @xmath26 .",
    "furthermore , since if @xmath736 for almost all @xmath238 , by lemma [ lem : translfaith ] , there exists an element of the asymptotic cone @xmath724 which is not fixed by the action by @xmath737 . therefore @xmath738 acts essentially freely co - specially by translations on @xmath724",
    ". finally , the group @xmath739 acts by translations on @xmath717 and thus is free abelian .",
    "we summarize the results of this section in the following theorem .",
    "[ thm : gen ] let @xmath0 be a finitely generated group",
    ". then    1 .",
    "the group @xmath0 acts essentially freely and co - specially on a real cubing if and only if @xmath0 acts essentially freely and co - specially on an asymptotic cone of a partially commutative group @xmath18 if and only if @xmath0 is fully residually @xmath18 for some finitely generated partially commutative group ; 2 .",
    "the group @xmath0 acts essentially freely and co - specially on a real cubing of width @xmath238 if and only if @xmath0 acts essentially freely and co - specially on an asymptotic cone of an @xmath238-wide and @xmath447-generated partially commutative group @xmath18 if and only if @xmath0 is fully residually @xmath18 .    in the case of free groups ,",
    "sela introduced _ geometric _ limit groups as quotients of finitely generated free groups by the kernel of an action induced by a family of homomorphisms on a real tree and proved that the class of geometric limit groups is precisely the class of finitely generated fully residually free groups , see @xcite .",
    "the above theorem gives a characterisation of the class of geometric limit groups over partially commutative groups as the class of finitely generated fully residually partially commutative groups .",
    "limit groups have been studied in various branches of group theory and logic from different viewpoints : algebraic , model - theoretic , geometric , in universal algebra and in algebraic geometry over groups .",
    "they can be described as finitely generated fully residually free groups , groups that satisfy the same set of existential formulas as free groups , as coordinate groups of irreducible algebraic sets , as subgroups of the ultrapower of the free group , as groups that realise atomic types over a free group etc . , see @xcite .",
    "limit groups form a subclass of groups acting freely on @xmath740-trees ( and @xmath741-trees ) , @xcite , they are toral relatively hyperbolic , @xcite and @xmath2 , @xcite .",
    "the first structural characterisation of limit groups is due to kharlampovich and miasnikov . in @xcite",
    ", the authors showed that limit groups are subgroups of the , so - called , ntq groups ( in sela s terminology , see @xcite , these groups are called @xmath1-residually free towers ) . among other things , kharlampovich and miasnikov showed that limit groups are subgroups of an iterated sequence of extensions of centralisers .",
    "one of the main corollaries of this characterisation is the fact that limit groups are finitely presented and , more generally , coherent .",
    "similar results were proven independently by sela in @xcite .",
    "sela introduced and studied limit groups via their action on real trees and obtained a description of the hierarchical structure of these groups as well as their finite presentability .",
    "following sela s approach , champetier and guirardel , see @xcite , gave another proof of the fact that limit groups are subgroups of @xmath1-residually free towers and also characetrised the class of limit groups ( without requiring to pass to a subgroup ) as the smallest class containing finitely generated free groups , and stable under free products and under taking generalized double over a group in the class . in @xcite , bestvina and feighn",
    "characterised them as constructible limit groups - a hierarchical description in terms of their generalised abelian decomposition and existence of a nice retraction onto a lower level , where free groups , are the groups on the lowest level of the hierarchy .",
    "partially commutative groups are known to have a highly complex family of subgroups : they contain surface groups ( with only 3 exceptions ) as well as graph braid groups as subgroups , see @xcite ; furthermore , some of their subgroups are main examples of groups with remarkable finiteness properties ( see @xcite ) .",
    "in particular , partially commutative groups are not coherent .",
    "it is clear , that the structure of limit groups over partially commutative groups is at least as complex as the structure of subgroups of partially commutative groups , hence , one can not expect to completely describe the structure of limit groups over partially commutative groups ( without passing to a subgroup ) .",
    "our goal is to characterise limit groups over partially commutative groups as subgroups of graph towers - a class of groups that generalises the class of @xmath1-residually free towers and ntq groups .",
    "recall that a finitely generated group is an @xmath1-residually free tower if it belongs to the smallest class of groups containing all finitely generated free groups and ( non - exceptional ) surface groups , which is stable under taking free products , free extensions of centralisers , and attaching retracting surfaces along maximal cyclic subgroups .    the class of @xmath1-residually free towers and ntq groups , not only characterises the class of limit groups , but also plays a crucial role in the classification of groups elementarily equivalent to a free group , @xcite . we expect that the class of graph towers will play a similar role in the classification of groups elementarily equivalent to a given partially commutative group .",
    "we now turn our attention to defining graph towers .",
    "free extensions of centralisers are , in some sense , the basic operations for constructing limit groups , since , as we have already mentioned , limit groups are subgroups of iterated sequences of free extensions of centralisers . in order to gain intuition in the case of",
    "partially commutative groups , let us review the behaviour of extensions of centralisers of elements of a given partially commutative group @xmath18 .",
    "on the one hand , we showed in @xcite that any free extension of a centraliser of an irreducible element @xmath742 is discriminated by @xmath18 . on the other hand , as the following example shows , in general , free extensions of centralisers of non - irreducible elements are not discriminated by @xmath18 .",
    "[ expl : bld ] let @xmath743 , and let @xmath744 .",
    "consider the extension of centraliser of @xmath71 , @xmath745=1\\rangle$ ] .",
    "take the element @xmath746 $ ] in @xmath26 .",
    "for any homomorphism @xmath547 from @xmath26 to @xmath18 which fixes @xmath18 , we have that @xmath747 .",
    "it follows that @xmath748 .",
    "hence , @xmath26 is not discriminated ( even separated ) by @xmath18 .",
    "in fact , one can give a precise characterisation of the set of elements of a partially commutative group @xmath18 whose extension of centraliser is discriminated by @xmath18 in terms of their block decompositions .",
    "the above discussion already demonstrates that , on the one hand , one can not expect that decompositions over abelian groups ( or small groups , or slender groups ) determine the structure of limit groups over partially commutative groups , since in the free extension of a centraliser @xmath749\\rangle$ ] the amalgamation is taken over a centraliser of an irreducible element , which in general , is a partially commutative group . on the other hand",
    ", it shows that there are some constraints on the type of elements whose centralisers need to be extended .",
    "the requirements for attaching a ( non - exceptional ) surface with boundary to @xmath18 are similar : the boundary components of the surface are glued along maximal cyclic subgroups generated by irreducible elements @xmath750 . in the case of free groups , the surface retracts onto the free group and the discriminating family is obtained from the retraction by pre - composing it with modular automorphisms . if one would like to follow this pattern in the case of partially commutative groups , firstly , one needs to ensure the existence of `` modular '' automorphisms . for this",
    ", a sufficient condition is that @xmath751 , @xmath752 .",
    "secondly , in order for the surface group to be discriminated into the subgroup generated by the irreducible elements @xmath753 ,",
    "@xmath61 , it is necessary to impose the condition that the surface group commute with @xmath754 .",
    "it is not hard to see that these conditions are sufficient for the corresponding group to be discriminated by @xmath18 .",
    "in fact , we shall show that , basically , these conditions are necessary .",
    "roughly speaking , graph towers are built hierarchically from the partially commutative group @xmath18 by gluing retracting abelian groups and surface groups with the conditions that    * the abelian and surface groups are amalgamated along cyclic subgroups generated by `` irreducible '' elements and * these abelian and surface groups commute with the centraliser of the subgroup onto which they retract .    as we discussed in the introduction",
    ", graph towers can be defined as an iterated sequence built inductively using , basically , amalgamated products over certain centralisers , see lemma [ lem : prtower ] .",
    "although the idea is clear , the main technical problem is that , a priori , we do not have control on the structure of centralisers of elements of graph towers . in particular , it is not clear what an `` irreducible '' element is .",
    "informally , given a limit group over a partially commutative group , one could define an irreducible element to be an element for which there exists a discriminating family that maps it into irreducible elements .",
    "but we can not define it this way either , since when constructing graph towers , we do not yet know that they are discriminated by @xmath18 and in fact , it is only a posteriori that we are able to conclude that the homomorphisms induced by solutions that factor through the fundamental branch of the makanin - razborov diagram discriminate the graph tower into @xmath18 and so to deduce that our `` irreducible '' elements have this property .    to deal with this difficulty , graph towers",
    "are defined as a triple : the group @xmath19 ( the graph tower ) , a partially commutative group @xmath232 and an epimorphism from @xmath232 to @xmath19 .",
    "we will show in the following section that in fact , both @xmath19 and @xmath232 are fully residually @xmath18 groups .    the partially commutative group @xmath232 is defined via its commutation graph @xmath64 .",
    "we subdivide the set of edges of the graph @xmath64 into two disjoint sets : @xmath148 and @xmath147 .",
    "these two sets capture the different nature of commutation for the images of the elements of @xmath232 in @xmath18 , namely two vertices @xmath259 and @xmath260 are joined by an edge from @xmath148 if and only if for a discriminating family , @xmath259 and @xmath260 are sent to the same cyclic subgroup in @xmath18 ; and two vertices @xmath259 and @xmath260 are joined by an edge from @xmath147 if and only if for a discriminating family , the images of @xmath259 and @xmath260 disjointly commute .",
    "( we also prove the existence of a discriminating family with this property . )",
    "now we can define irreducible elements in @xmath19 as the images of irreducible elements in @xmath232 .",
    "more generally , we define co - irreducible subgroups @xmath134 as closed subgroups of @xmath232 ( i.e. @xmath755 ) so that @xmath756 is @xmath147-directly indecomposable . the motivation behind this definition is as follows .",
    "notice that since in a given finitely generated partially commutative group @xmath18 there are finitely many different canonical parabolic subgroups , so for a canonical parabolic subgroup @xmath134 of @xmath232 ( where @xmath232 is discriminated by @xmath18 ) there exists a subgroup @xmath757 of @xmath18 so that for a discriminating family @xmath324 we have that @xmath758 and for no proper subgroup @xmath759 of @xmath757 there exists such a discriminating family .",
    "we show that given a co - irreducible subgroup @xmath134 of @xmath232 , there exists a discriminating family so that @xmath757 is co - irreducible in @xmath18 .",
    "in particular , @xmath760 is a directly indecomposable subgroup of @xmath18 and if @xmath760 is not cyclic , then @xmath761 . for intuition , it is helpful to think that the image of the subgroup @xmath756 in @xmath19 is the subgroup onto which the corresponding abelian ( or surface ) group retracts and so @xmath760 is the directly indecomposable canonical parabolic subgroup where the abelian ( or surface ) subgroup is mapped by the discriminating family .    [ defn : tower ] to any graph tower @xmath19 , we associate a partially commutative group @xmath232 and an epimorphism @xmath762 .",
    "the partially commutative group @xmath232 is defined via its commutation graph @xmath64 .",
    "the set of edges @xmath138 of the graph @xmath64 is subdivided into two disjoints sets , the set of @xmath170-edges and the set of @xmath491-edges , i.e. @xmath139 , @xmath140 .",
    "furthermore , the set of edges @xmath148 has the following property : @xmath763 for every subgroup @xmath134 of @xmath232 , abusing the notation , we denote the image @xmath764 of @xmath134 in @xmath19 by @xmath134 .",
    "we define a @xmath18-graph tower as an iterated sequence .",
    "we denote graph towers by @xmath19 and write @xmath6 , to indicate that the graph tower @xmath6 is of height @xmath7 .",
    "a @xmath18-graph tower @xmath765 of height @xmath5 is our fixed partially commutative group @xmath18 . in this case ,",
    "the partially commutative group associated to @xmath765 is also @xmath766 , all edges of @xmath767 are @xmath170-edges and the epimorphism @xmath768 is the identity .",
    "assume that @xmath8 is a @xmath18-graph tower of height @xmath9 , @xmath769 is its associated partially commutative group and @xmath770 .",
    "a @xmath18-graph tower @xmath6 of height @xmath7 , the associated partially commutative group @xmath771 and the epimorphism @xmath772 are constructed using one of the following alternatives .",
    "the graph @xmath773 is defined as follows    * @xmath774 ; * @xmath775 , where @xmath134 is an @xmath776-co - irreducible subgroup of @xmath769 ; * @xmath777 if the subgroup @xmath756 is directly indecomposable ( as a subgroup of @xmath769 ) and * @xmath778 if the subgroup @xmath756 is directly decomposable ( we will show in lemma [ lem : typeskperp ] , that , in this case , @xmath756 is @xmath779-abelian ) .",
    "we set @xmath780 to be the associated partially commutative group .",
    "it follows from the definition that @xmath769 is a retraction of @xmath780 and so is @xmath781 of @xmath782 .",
    "the group @xmath6 is a quotient of @xmath782 by @xmath783 , i.e. @xmath784 , where the set of relations @xmath87 is :    * the set of _ basic relations _",
    "@xmath785 = 1 $ ] , @xmath786 .",
    "the graph @xmath773 is defined as follows :    * @xmath774 ; * @xmath787 , where @xmath134 is an @xmath776-co - irreducible subgroup of @xmath769 ; * @xmath788 if the subgroup @xmath756 is directly indecomposable ( as a subgroup of @xmath769 ) and * @xmath789 if the subgroup @xmath756 is directly decomposable ( we will show in lemma [ lem : typeskperp ] , that , in this case , @xmath756 is @xmath779-abelian ) .",
    "we set @xmath780 to be the associated partially commutative group .",
    "it follows from the definition that @xmath769 is a retraction of @xmath780 and so is @xmath8 of @xmath782 .",
    "the group @xmath6 is a quotient of @xmath782 by @xmath783 , i.e. @xmath784 , where the set of relations @xmath87 is one of the following types :    * the relations @xmath790 = 1 $ ] , where @xmath791 is a non - trivial cyclically reduced root block element ; * the set of basic relations .",
    "the graph @xmath773 is defined as follows :    * @xmath774 ; * @xmath775 , where @xmath134 is a @xmath776-co - irreducible subgroup of @xmath769 ; * @xmath777 if the subgroup @xmath756 is directly indecomposable ( as a subgroup of @xmath769 ) and * @xmath778 if the subgroup @xmath756 is directly decomposable ( we will see in lemma [ lem : typeskperp ] , that , in this case , @xmath756 is @xmath779-abelian ) .",
    "we set @xmath780 to be the associated partially commutative group .",
    "it follows from the definition that @xmath769 is a retraction of @xmath780 and so is @xmath8 of @xmath782 .",
    "the group @xmath6 is a quotient of @xmath782 by @xmath792 ,",
    "i.e. @xmath784 , where the set of relations @xmath87 consists of the set of basic relations @xmath793 = 1\\mid 1\\le i\\le m_l\\}$ ] and a relation @xmath17 of one of the two following forms : ( orientable ) @xmath794\\cdots[x_{2g-1},x_{2g}]{u_{2g+1}}^{x_{2g+1}}\\cdots { u_m}^{x_{m}}=\\\\ \\phantom{a}[v_1,v_2]\\cdots[v_{2g-1},v_{2g}]{u_{2g+1}}^{w_{2g+1}}\\cdots { u_m}^{w_{m } } \\end{array}\\ ] ] or ( non - orientable ) @xmath795 where @xmath796 and    * either the euler characteristic of @xmath17 is at most -2 , or @xmath17 corresponds to a punctured torus and the subgroup @xmath797 of @xmath8 is non - abelian , i.e. the retraction of the ( punctured ) surface onto @xmath8 is non - abelian ; * or @xmath798 and * * the subgroup @xmath799 , \\dots , [ v_{2g-1},v_{2 g } ] , { u_{2g+1}}^{w_{2g+1}},\\dots , { u_m}^{w_{m } } \\rangle$ ] is non - abelian , where @xmath17 is orientable or , * * the subgroup @xmath800 is non - abelian , where @xmath17 is non - orientable , + i.e. the solution is not atom - commutative ( see ( * ? ? ?",
    "* definition 11 ) ) .",
    "[ lem : prtower ] the graph tower @xmath6 admits one of the following decomposition as amalgamated product :    * @xmath801 + ( if @xmath87 is empty and @xmath756 is non - abelian ) ; * @xmath802=1 , 1\\le i , j \\le m_l , i\\ne j \\rangle\\right)$ ] + ( if @xmath87 is empty and @xmath756 is abelian ) ; * @xmath803=1 , 1\\le i , j \\le m_l , i\\ne j \\rangle\\right)$ ] + ( if @xmath87 is abelian and @xmath15 is non - trivial ) ; * @xmath802=1 , 1\\le i , j\\le m_l , i\\ne j \\rangle\\right)$ ] + ( if @xmath87 is abelian and @xmath756 is non - abelian ) ; * @xmath804 + ( if @xmath17 satisfies one of the properties @xmath805 and @xmath806 from definition [ defn : tower ] ) ;    the only decomposition that does not follow immediately from the definition of a graph tower is c ) . from the definition , we have that @xmath807=1\\rangle\\right),\\ ] ] where @xmath808 .",
    "we shall prove in section [ sec:11 ] , that the subgroup @xmath809 is the direct product of @xmath810 and @xmath811 and hence decomposition c ) .",
    "* since graph towers can be described as iterated sequences of amalgamated products , each graph tower @xmath812 naturally embeds into the graph tower @xmath813 .",
    "in fact , for each floor , there is a natural retraction of @xmath813 onto @xmath814 . *",
    "if the the graph tower is constructed using only basic floors , then @xmath19 and @xmath232 coincide , i.e. the graph tower is itself a partially commutative group .",
    "* notice that graph towers are a natural generalization of the notions of @xmath1-residually free towers and ntq - groups .",
    "indeed , let @xmath18 be a free group and assume by induction that @xmath8 is an ntq - group . + by assumption , in cases a1 ) , b2 ) and c ) the group @xmath756 is non - abelian .",
    "in particular , since limit groups have the csa property , it follows that the centraliser @xmath810 is trivial .",
    "therefore , case a1 ) corresponds to the free product of the group @xmath8 and a free group ; case b2 ) corresponds to the free product of @xmath8 and a free abelian group ; and case c ) corresponds to an amalgamated product of @xmath8 with a surface group ( so that the natural retraction of the surface to @xmath8 is non - abelian ) . + in cases a2 ) and b1 ) , the subgroup @xmath756 is abelian . hence , these cases correspond to extension of centralisers of maximal abelian subgroups , or equivalently , to an amalgamated product of @xmath8 and a free abelian group ( amalgamated by a maximal ( in @xmath8 ) abelian subgroup ) .",
    "+ we therefore obtain an ntq - group .",
    "notice that the difference with an @xmath1-residually free tower is that our construction is not canonical in the following sense",
    ". in the construction of an @xmath1-residually free tower , at a given floor one attaches all the pieces corresponding to the abelian jsj - decomposition . in our case ,",
    "pieces are attached one by one , hence the same graph tower can be constructed in several different ways ( for example , at the same level one can first attach an abelian group and then a surface group or vice versa ) . *",
    "notice that , in general , the centraliser of a set of elements in a partially commutative group is neither commutative transitive , nor malnormal , nor small ( see @xcite ) .",
    "hence , the splittings we find do not correspond to the ( abelian ) jsj decomposition , or , in terms of @xcite , the splitting we obtain is not a gad .",
    "nevertheless , the decomposition we find plays the role analogous to the one the jsj plays for limit groups : one can define modular automorphisms and show that under some restrictions on the decomposition ( similar to the ones for constructible limit groups ) , the groups we consider are discriminated using the retraction and appropriate modular automorphisms . * as mentioned above , edge groups that appear in the decomposition fail the necessary conditions for the existing jsj theories : they are not abelian , slender or small etc . on the other hand , the most general theory developed by guirardel and levitt , see @xcite , requires the group to be finitely presented , while our groups do not need to be finitely presented .",
    "+ nevertheless , it is conceivable that under appropriate definitions , the decomposition we obtain could correspond to a jsj - decomposition where ( in the terminology of @xcite ) flexible vertex stabilisers are extensions of 2-orbifold groups with boundary ( by centralisers ) , attached to the rest of the group in a particular way .",
    "+ as we mentioned above , the construction of the graph tower is not canonical . in the case of free groups ,",
    "kharlampovich and miasnikov , @xcite , described an elimination process based on the makanin - razborov process that gives an effective construction of the ( cyclic ) jsj decomposition of a fully residually free group .",
    "if an appropriate jsj theory is developed for the class of groups we deal in this paper , then one could modify the process developed in @xcite to obtain a canonical construction of the graph tower .",
    "the goal of this and the next sections is to show that , for a given limit group @xmath0 over a partially commutative group @xmath18 , one can effectively construct an embedding of @xmath0 into a graph tower . in this section ,",
    "we construct a graph tower @xmath19 associated to @xmath0 . in the next section , following the approach from @xcite , we show that the graph tower @xmath19 is discriminated by @xmath18 and use this fact to prove that @xmath0 embeds into @xmath19 .",
    "as we have already mentioned , the construction of the graph tower strongly relies on the process described in @xcite , which given a finitely generated group @xmath0 and a partially commutative group @xmath18 , produces a diagram that describes the set of all homomorphisms from @xmath0 to @xmath18 .",
    "we now informally recall some of the notions and results from @xcite .    given a finitely generated group @xmath0 and a partially commutative group @xmath18",
    ", one can effectively construct finitely many constrained generalised equations @xmath815 ( see definition below ) and homomorphisms @xmath816 from @xmath0 to the coordinate group of the generalised equation @xmath817 so that any homomorphism from @xmath0 to @xmath18 factors through the coordinate group of a generalised equation @xmath817 for some @xmath818 , i.e. for any homomorphism @xmath56 , there exist @xmath249 and a homomorphism @xmath819 so that @xmath820 .    informally , a generalised equation @xmath821 is a combinatorial object which encodes a system of equations over a free monoid .        items @xmath822 correspond to variables and each pair of dual bases @xmath823 defines the equation @xmath824 .",
    "a tuple @xmath825 is a solution of the generalised equation @xmath821 if @xmath826 and @xmath827 are freely reduced words so that @xmath828 is graphically equal to @xmath829 , for every pair of dual bases @xmath823 , see ( * ? ? ?",
    "* chapter 3 ) for details .",
    "a constrained generalised equation @xmath830 is a generalised equation @xmath821 together with a set of commutation constraints @xmath831 associated to the variables @xmath832 of @xmath821 .",
    "a tuple @xmath833 is a solution of the generalised equation @xmath50 if @xmath826 and @xmath827 are geodesic words in @xmath18 so that @xmath828 is graphically equal to @xmath829 , for every pair of dual bases @xmath823 , and @xmath26 satisfies the commutation constraints , i.e. @xmath834 for all commutation constraints @xmath835 .",
    "the coordinate group @xmath836 of @xmath821 is the group @xmath837 $ } \\!\\mathord{\\left/ { \\vphantom { { \\ensuremath{\\mathbb{g}}}[h ] { r(\\upsilon)}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${r(\\upsilon)}$}}}$ ] , where , abusing the notation , we denote by @xmath821 the system of equations associated to the generalised equation @xmath821 .",
    "the coordinate group @xmath838 of @xmath50 is the group @xmath837 $ } \\!\\mathord{\\left/ { \\vphantom { { \\ensuremath{\\mathbb{g}}}[h ] { r(\\omega)}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${r(\\omega)}$}}}$ ] , where , abusing the notation , we denote by @xmath50 the system of equations associated to the generalised equation @xmath821 and the set of commutation relations @xmath839 $ ] for all @xmath822 , @xmath840 so that @xmath835 .",
    "we denote by @xmath841 ( by @xmath842 ) the group @xmath837 $ } \\!\\mathord{\\left/ { \\vphantom { { \\ensuremath{\\mathbb{g}}}[h ] { \\operatorname{ncl}\\langle\\upsilon\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\upsilon\\rangle}$}}}$ ] ( the group @xmath837 $ } \\!\\mathord{\\left/ { \\vphantom { { \\ensuremath{\\mathbb{g}}}[h ] { \\operatorname{ncl}\\langle\\omega\\rangle}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\omega\\rangle}$}}}$ ] ) .    in this section we primarily work with the groups @xmath843 . however , the notions of canonical homomorphisms , fundamental branch etc .",
    "are defined using coordinate groups of generalised equations .",
    "all these notions carry over from coordinate groups to the groups @xmath843 and we use them in this context .",
    "for instance , by construction , the canonical homomorphism @xmath844 is induced by a homomorphism from @xmath845 to @xmath846 which , abusing the notation , we also denote by @xmath847 .",
    "similarly , any solution @xmath26 of @xmath50 is induced by a homomorphism from @xmath842 to @xmath18 , which we also denote by @xmath26 .",
    "the description of the set of homomorphisms @xmath848 reduces to the study of the sets of solutions of the constrained generalised equations @xmath817 , @xmath818 .",
    "given a generalised equation @xmath50 , we described a process ( analogous to the one described by makanin , @xcite and razborov , @xcite , in the case of free groups ) that produces a ( possibly ) infinite , locally finite , rooted tree @xmath51 which encodes the solution set of @xmath50 .",
    "infinite branches of this tree are of three specific types : linear , quadratic or general type .",
    "the dynamics of these infinite branches determine specific families of automorphisms of the coordinate group associated to @xmath50 .",
    "one then shows that , using these families of automorphisms , one can produce a finite tree @xmath849 that encodes the set of solutions of @xmath50 , see ( * ? ? ?",
    "* theorem 9.2 ) .",
    "if the group @xmath0 is a limit group over @xmath18 , since the corresponding solution tree @xmath35 is finite , it follows by lemma [ lem : discfam ] , that there exists a branch of the solution tree @xmath35 so that the subfamily of homomorphisms that factors through this branch is a discriminating family of @xmath0 into @xmath18 .",
    "we call this branch _ a fundamental branch of @xmath0_. any discriminating family of homomorphisms that factors through the fundamental branch is called a",
    "_ fundamental sequence_.    the goal of this section is , given a fundamental branch @xmath850 associated to the group @xmath0 , to construct the graph tower @xmath851 as well as a homomorphism @xmath852 from @xmath845 to @xmath851 so that for every homomorphism @xmath853 from @xmath0 to @xmath18 of a discriminating family there exists a homomorphism @xmath854 from @xmath851 to @xmath18 such that the following diagram is commutative : @xmath855_{\\pi_0}\\\\ g_{r(\\omega_0 ) }   \\ar[dr]_{h } & \\ar[l ] g_{\\omega_0}\\ar[d]_h \\ar[r]^{\\tau_0 } & { \\mathfrak{t}}_0\\ar[dl]^{h ' } \\\\ & { \\ensuremath{\\mathbb{g}}}}\\ ] ]    the graph tower is constructed from a fundamental branch of @xmath0 using induction on the height of the branch .",
    "one begins with the group associated to the leaf of the fundamental branch , which is a partially commutative group discriminated by @xmath18 and keeps building the graph tower according to the type of epimorphism associated to the edges ( or more precisely , the type of automorphism group associated to the vertices ) of the fundamental branch .",
    "the types of automorphisms are intrinsically related to the different dynamics that appear in the construction of the tree @xmath51 : linear type ( exotic , levitt , or type 7 - 10 ) , quadratic type ( surface , or type 12 ) and general type ( axial + surface , or type 15 ) .",
    "[ pagen ] the induction hypothesis at step @xmath372 are as follows :    * given a generalised equation @xmath856 , there exists a graph tower @xmath857 , where @xmath858 , and a homomorphism @xmath859 from @xmath860 to @xmath861 such that for every solution @xmath862 of the fundamental sequence , there exists a homomorphism @xmath863 that makes the diagram @xmath864_{h^{(q ) } } \\ar[rr]^{\\tau_q } & & { \\mathfrak{t}}_q\\ar[dl]^{{h^{(q ) } } ' } \\\\ & { \\ensuremath{\\mathbb{g } } } &   } \\ ] ] commutative ; notice that if @xmath865 , then @xmath866 is a homomorphism from @xmath867 to @xmath18 that , abusing the notation , we also denote by @xmath868 .",
    "* for all generators @xmath869 , we have that @xmath870 if and only if @xmath871 for all homomorphisms @xmath872 induced by a solution @xmath873 from the fundamental sequence ; furthermore , we have that if @xmath874 then @xmath875 , @xmath876 belong to a cyclic subgroup for all homomorphisms @xmath872 induced by a solution @xmath873 from the fundamental sequence ; * for any item @xmath877 , if @xmath878 , then @xmath879 and @xmath880 for all solutions @xmath862 of the fundamental sequence and homomorphisms @xmath872 induced by @xmath862 .",
    "the induction hypothesis ih is a natural assumption which is needed to prove that @xmath0 embeds into @xmath851 .",
    "the induction hypothesis ih1 and ih2 are essential to keep control on the `` type '' of subgroups whose centralisers we extend .",
    "furthermore , they will be crucial in the next section in order to show that graph towers are discriminated by homomorphisms induced by solutions of the fundamental sequence .",
    "[ rem : recall ] we would like to mention the following facts from @xcite that will be used in the course of the proof .    1 .   in the construction of the process in @xcite , we define several different trees .",
    "of special interest to us are the tree @xmath51 ( with infinite branches ) and the finite tree @xmath849 .",
    "groups corresponding to the leaves of @xmath849 are explicitly described ( see ( * ? ? ?",
    "* proposition 9.1 ) ) .",
    "3 .   without loss of generality",
    ", one can assume that the word @xmath881 , where @xmath343 is a closed section of @xmath50 and @xmath26 is a solution of the constrained generalised equation @xmath50 is a subword of a word in the dm - normal form ( see ( * ? ? ?",
    "* section 3.3.1 ) ) .",
    "automorphisms associated to the vertices of the tree @xmath849 are completely induced ( see ( * ? ? ?",
    "* section 7.1 ) ) .",
    "roughly speaking , this means that solutions ( in the partially commutative group @xmath882 ) of a constrained generalised equation are induced by a solution ( in the free group @xmath883 ) of the corresponding generalised equation ( over the free group ) .    before turning our attention to the construction of the graph tower , we further discuss two key notions for the construction .",
    "we first clarify the structure of orthogonal complements @xmath756 of co - irreducible subgroups and justify the somewhat non - intuitive definition .",
    "the structure of @xmath756 allows us , a posteriori , to establish that a discriminating family of the graph tower maps a co - irreducible subgroup @xmath134 into a closed subgroup of @xmath18 and the subgroup @xmath756 into a directly indecomposable subgroup ( which we treat differently depending on if it is cyclic or non - abelian ) .",
    "secondly , we introduce the notion of a tribe .",
    "this notion plays a crucial role in the study of the dynamics of infinite branches .",
    "it is intrinsically related to the fact that one can define some `` finite hierarchy '' ( finite partial order ) on the type of constraints associated to the variables .",
    "we will see that one can interpret this partial order as a measure of complexity on the constraints . for this notion to be well - defined , it is essential that the partially commutative group @xmath18 be finitely generated .",
    "the definition of co - irreducible subgroup might seem somewhat artificial since we ask that the subgroup @xmath756 be @xmath147-directly indecomposable . in the following lemma",
    "we clarify the structure of the subgroup @xmath756 in the group @xmath232 .",
    "[ lem : typeskperp ] let @xmath884 be a graph tower that satisfies the induction hypothesis ih and ih1 . then",
    ", if @xmath756 is an @xmath147-directly indecomposable canonical parabolic subgroup of @xmath232 , then @xmath756 is either a directly indecomposable subgroup of @xmath232 or @xmath148-abelian .",
    "let @xmath885 .",
    "if follows from the induction hypothesis ih1 that if @xmath886 , then @xmath887 if and only if @xmath888 .",
    "assume that @xmath756 is directly decomposable , but @xmath147-directly indecomposable in @xmath232 . without loss of generality ,",
    "assume that @xmath889 .",
    "we use induction on the rank of @xmath890 to prove that then @xmath756 is @xmath148-abelian .",
    "suppose that @xmath890 has rank 1 , i.e. @xmath891 .",
    "let @xmath892 where @xmath893 and @xmath894 . since @xmath756 is @xmath147-directly indecomposable , we have that @xmath895 . if @xmath896 , then since the set @xmath148 satisfies condition ( [ eq : ecprop ] ) , it follows that @xmath756 is @xmath148-abelian",
    "otherwise , we have that @xmath897 , for all @xmath898 and @xmath899 for all @xmath900 .",
    "it follows from the above observations that @xmath901 for all @xmath898 and for all @xmath900 and hence @xmath902 is @xmath147-directly decomposable - a contradiction .",
    "assume that @xmath890 has rank @xmath486 .",
    "let @xmath903 and let @xmath904 , where @xmath905 and @xmath906 .",
    "notice that since by assumption @xmath756 is @xmath147-directly indecomposable , we have that the set @xmath907 is non - empty . as",
    "above , it follows that @xmath908 and the rank of @xmath909 is strictly less than the rank of @xmath890 . by induction",
    "we conclude that @xmath756 is @xmath148-abelian .",
    "let @xmath910 be the finite set of distinct canonical parabolic subgroups of @xmath882 , where @xmath911 , @xmath912 .",
    "let @xmath830 be a generalised equation .",
    "since there are only finitely many canonical parabolic subgroups of @xmath18 , by lemma [ lem : discfam ] , there exists a fundamental sequence so that for every item @xmath822 ( base @xmath913 , section @xmath343 ) of @xmath50 , there exists a canonical parabolic subgroup @xmath914 ( @xmath915 and @xmath916 , correspondingly ) such that @xmath917 ( @xmath918 and @xmath919 , correspondingly ) for every solution @xmath26 of the discriminating family .",
    "a _ tribe _ of @xmath50 is a set of items , bases and sections of @xmath50 .",
    "given a fundamental sequence , we say that an item @xmath840 ( or a base , or a section ) of @xmath50 _ belongs to the tribe _",
    "@xmath920 if and only if for the fundamental sequence one has that @xmath921 ( or @xmath922 , or @xmath923 , correspondingly ) , for some @xmath924 .",
    "notice that , in general , two items @xmath840 , @xmath925 might belong to the same tribe although @xmath926 .",
    "furthermore , if @xmath927 , then @xmath840 and @xmath925 belong to different tribes since for every solution @xmath26 of the fundamental sequence one has that @xmath928 . abusing the notation , for a tribe @xmath920 we denote by @xmath929 the canonical parabolic subgroup @xmath930 , i.e. the set of letters @xmath931 so that for every @xmath932 we have @xmath933 . for an item @xmath822 ( base @xmath913 , section @xmath343 ) of @xmath50 we set @xmath934 ( @xmath935 and @xmath936 ) to be the tribe to which @xmath822 ( @xmath913 or @xmath343 ) belongs .",
    "we say that a tribe @xmath937 _ dominates _ the tribe @xmath920 and write @xmath938 if and only if @xmath939 .",
    "the relation @xmath940 is a partial order on the set of all tribes .",
    "a tribe is _",
    "minimal with respect to _",
    "@xmath940 if and only if it does not strictly dominate any other tribe .    let @xmath941 be a generalised equation and assume that @xmath942 .",
    "then , for any solution @xmath26 of @xmath50 , we have that @xmath943 .",
    "if @xmath840 belongs to a tribe that dominates the tribe of @xmath822 , it follows that @xmath928 for all solutions @xmath26 of @xmath50 .",
    "hence , every solution of @xmath50 is a solution of @xmath944 .",
    "we say that the set @xmath945 is _ completed _ if for all @xmath840 that belong to a tribe that dominates the tribe of @xmath822 , if @xmath942 then @xmath927 .",
    "in particular , if two items @xmath822 and @xmath840 belong to the same tribe , then @xmath942 if and only if @xmath927 . moreover , if @xmath840 belongs to a tribe that dominates the tribe of @xmath822 , then @xmath946 .",
    "[ rem : completed ] without loss of generality , we further assume that for all generalised equations @xmath830 the sets @xmath945 are completed .",
    "[ lem : tribes ] let @xmath947 be obtained from @xmath830 by an elementary transformation @xmath948 or a derived transformation @xmath949 and let @xmath227 be the corresponding epimorphism , @xmath950 .",
    "let @xmath951 , @xmath952 , @xmath953 , @xmath954 , be the image of @xmath822 under @xmath227 .",
    "then , for every @xmath183 the tribe @xmath955 dominates the tribe @xmath934",
    ". furthermore , every minimal tribe of @xmath956 dominates a minimal tribe of @xmath50 .",
    "the statement is clear for all the transformations but @xmath957 and @xmath958 . from the description of @xmath958",
    ", it follows that if @xmath959 , then @xmath960 for all @xmath249 . by definition of a solution of generalised equation , for every solution @xmath26 of @xmath50",
    ", we have @xmath961 and hence the statement .",
    "suppose now that @xmath962 .",
    "then , @xmath960 for all @xmath963 and @xmath964 ( here we use the notation from the description of @xmath958 , see @xcite ) .",
    "since for every solution @xmath26 of @xmath50 we have that @xmath965 , the first statement follows .",
    "furthermore , if for some @xmath183 the tribe @xmath966 ( or @xmath967 or @xmath968 ) is minimal in @xmath956 , then it dominates the tribe @xmath934 ( or @xmath969 ) , which is also minimal .",
    "the proof for @xmath957 is analogous and left to the reader .    by construction , every boundary of the generalised equation in @xmath970 either corresponds to a boundary of @xmath817 or it has been introduced between @xmath971 and @xmath972 in @xmath817 .",
    "it follows that if the boundaries @xmath183 and @xmath973 of @xmath970 correspond to boundaries between @xmath25 and @xmath974 in @xmath975 , then the tribe of an item @xmath840 in the generalised equation @xmath970 dominates the tribe of @xmath925 in @xmath817 . applying this argument recursively ,",
    "we conclude that if @xmath976 , @xmath977 has been obtained from @xmath817 by a sequence of entire transformations and the boundaries @xmath183 and @xmath973 of @xmath978 correspond to boundaries between @xmath25 and @xmath974 in @xmath975 , then the tribe of an item @xmath840 in the generalised equation @xmath978 dominates the tribe of @xmath925 in @xmath817 .",
    "let @xmath935 be the tribe of a base @xmath913 in @xmath50 .",
    "then , the tribe of every item covered by @xmath913 dominates @xmath935 .",
    "we note that the tribe of @xmath913 in @xmath817 is dominated by the tribe of @xmath913 in @xmath970 ( unless @xmath913 is completely removed when passing from @xmath817 to @xmath970 ) .      if the height @xmath372 of the fundamental branch equals @xmath5 , then the group @xmath845 is the group associated to the leaf of the tree @xmath49 . by the description of the leaves of the tree",
    "@xmath35 ( see ( * ? ? ?",
    "* proposition 9.1 ) and its proof ) , it follows that @xmath845 is a partially commutative group , which is fully residually @xmath18 and it is built from @xmath18 by a sequence of extensions of centralisers of directly indecomposable canonical parabolic subgroups .",
    "hence , in our terms , this partially commutative group is a graph tower over @xmath18 , where each floor is basic , and at each floor @xmath979 ( and @xmath980 is the identity ) .",
    "if the variables @xmath981 extend a centraliser of a cyclic canonical parabolic subgroup @xmath982 in @xmath983 , then the subgroup @xmath984 in @xmath985 is free abelian and , by definition , the edges @xmath986 belong to @xmath987 .",
    "all the other ( new ) edges belong to @xmath988 .    from the construction of the leaves of the tree @xmath49 ,",
    "see ( * ? ? ?",
    "* proposition 9.1 ) , we obtain that the graph tower satisfies the induction hypothesis :    * the graph tower @xmath989 trivially makes diagram ( [ diag : period ] ) commutative ; * by definition of a solution of a generalised equation and since @xmath990 , for all @xmath869 , we have that @xmath991 if and only if @xmath992 for every homomorphism @xmath854 induced by a solution @xmath26 from the fundamental sequence ; furthermore , if @xmath874 , then @xmath993 , @xmath994 belong to the same cyclic subgroup for every homomorphism @xmath854 induced by a solution @xmath26 from the fundamental sequence ; * since @xmath995 is the identity , it obviously satisfies the hypothesis ih2 : if @xmath996 , then @xmath997 and @xmath998 for all solutions @xmath26 of the fundamental sequence and homomorphisms @xmath854 induced by @xmath26 .",
    "suppose that the graph tower @xmath999 exists and the induction hypothesis ih , ih1 and ih2 are satisfied for all groups @xmath846 so that the fundamental sequence for @xmath1000 has length less than or equal to @xmath1001 .",
    "we show how to construct the graph tower @xmath851 for groups @xmath845 whose fundamental sequence has length @xmath372 and prove that the graph tower satisfies all the induction hypothesis .",
    "we construct the group @xmath851 starting from the graph tower @xmath999 .",
    "the construction of @xmath851 depends on the type of the branch through which the fundamental sequence factors through .",
    "it follows by construction of the tree @xmath51 , see @xcite , that solutions of the fundamental sequence    * either factor through a finite branch of the tree @xmath1002 ; in this case , every solution of the fundamental sequence factors through the group @xmath37 associated to the leaf @xmath36 of @xmath1002 ( and so the automorphism group needed for the description of solutions of the fundamental sequence is trivial ) , where the length of the fundamental branch for @xmath38 equals @xmath1001 . * or they factor through an infinite branch of the tree @xmath1002 . by (",
    "* ? ? ? * lemma 4.19 ) , there are three different types of infinite branches : 1",
    ".   infinite branch of type 7 - 10 ; in this case , every solution of the fundamental sequence is the composition of an automorphism from the automorphism group associated to the vertex of type @xmath1003 ( i.e. automorphisms invariant with respect to the kernel ) , the epimorphism @xmath1004 and a homomorphism from @xmath1000 to @xmath18 .",
    "infinite branch of type 12 ; in this case , every solution of the fundamental sequence is the composition of an automorphism from the automorphism group associated to the vertex of type @xmath1005 ( i.e. automorphisms invariant with respect to the non - quadratic part ) , the epimorphism @xmath1004 and a homomorphism from @xmath1000 to @xmath18 .",
    "infinite branch of type 15 ; in this case , we have again two alternatives : * * either the fundamental sequence goes through a vertex of type @xmath28 , i.e. the fundamental sequence factors through a generalised equation singular ( or strongly singular ) with respect to a periodic structure and so every solution is a composition of an automorphism associated to a vertex of type @xmath28 , the epimorphism @xmath1004 and a homomorphism from @xmath1000 to @xmath18 ; * * or else , every solution of the fundamental sequence is the composition of an automorphism from the group of automorphisms generated by automorphisms invariant with respect to the non - quadratic part and automorphisms associated to regular periodic structures , the epimorphism @xmath1004 and a homomorphism from @xmath1000 to @xmath18 .",
    "the rest of this section essentially relies on the analogue of the makanin - razborov process described in @xcite .",
    "although our intention is to make the exposition as self - contained as possible , the reader is referred to @xcite for notions and notation not explicitly defined here .",
    "if the group of automorphisms associated to a vertex of the tree @xmath35 is trivial , we set @xmath1006 , @xmath1007 and @xmath852 to be @xmath1008 , where @xmath1009 is the homomorphism from @xmath846 to @xmath999 that makes diagram ( [ diag : period ] ) commutative . if the group of automorphisms is trivial , any homomorphism of the fundamental sequence factors through @xmath1000 and so @xmath852 and @xmath851 make diagram ( [ diag : period ] ) commutative .      in this section",
    "we study the quadratic part of a generalised equation in three steps .",
    "firstly , we use the dynamics of an infinite branch of type 12 ( surface type ) in order to understand the set of constraints @xmath1010 of a generalised equation @xmath830 that repeats infinitely many times in the infinite branch .",
    "more precisely , we show that all items of the quadratic section that are not fixed by the group of automorphisms assigned to the vertex belong to the same minimal tribe and so , in particular , all of them commute with the same set of items .",
    "furthermore , items of the quadratic section that are fixed by the automorphisms belong to tribes that dominate the minimal tribe ( the one defined by any of the items which is not fixed by the automorphisms ) .",
    "once we have established these relations between the tribes of items of the quadratic part , we use them to prove that there exists an automorphism of the group @xmath842 that fixes the non - quadratic part and presents the quadratic part as a quotient of a partially commutative group by a surface relation .    finally , we construct the graph tower and show that it satisfies the corresponding induction hypothesis .",
    "let us begin with the analysis of an infinite branch of type @xmath1005 .",
    "let @xmath1011 be a quadratic constrained generalised equation of type @xmath1005 . throughout this section",
    "we will be mostly concerned with the active bases , boundaries , items etc .",
    ", i.e. bases , items and boundaries of the ( active ) quadratic part .",
    "when no confusion arises , we will omit saying that the bases ( items , boundaries etc . )",
    "are active .",
    "let us consider an infinite branch of type @xmath1005 in the tree @xmath51 , @xmath1012    then , by ( * ? ? ?",
    "* lemma 7.12 ) , there exists a generalised equation @xmath1013 that repeats infinitely many times in the infinite branch : @xmath1014 without loss of generality , we assume that @xmath1015 . furthermore , the canonical epimorphism @xmath1016 from @xmath1017 to @xmath1018 is an automorphism of @xmath1017 . in fact , since there are finitely many different generalised equations appearing in the infinite branch , without loss of generality , we may assume that every generalised equation of the infinite branch appears in it infinitely many times .",
    "recall that , since the branch is infinite and @xmath1019 repeats infinitely many times , we have that the complexity , the number of active bases and the number of items is constant throughout the branch , i.e. @xmath1020 , @xmath1021 and @xmath1022 for all @xmath249 . furthermore , if @xmath1023 is the carrier of @xmath817 , then every @xmath1023-tying introduces a new boundary .",
    "there is a natural one - to - one correspondence between the bases of @xmath817 and @xmath970 .",
    "namely , the base @xmath1023 in @xmath970 is the only leading base which is not the carrier and all the other bases are naturally preserved .",
    "hence , we may assume that the sets of bases of @xmath817 and @xmath970 coincide .",
    "[ lem:1clsec ] let @xmath50 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch .",
    "then , the active part of the generalised equation @xmath50 has only one closed section .",
    "suppose , on the contrary , that @xmath50 contains more than one ( active ) closed section : @xmath1024 $ ] and @xmath1025 $ ] .    for every @xmath238 we partition the set of bases @xmath1026 of @xmath1027 into two .",
    "let @xmath1028 be the set of bases @xmath1029 of @xmath1027 so that @xmath1030 and @xmath1031 lie to the left of the boundary @xmath249 of @xmath50 .",
    "set @xmath1032 to be the set of bases @xmath1029 of @xmath1027 so that @xmath1030 and @xmath1031 lie to the right of the boundary @xmath249 of @xmath50 . since the boundary @xmath249 is closed in @xmath50",
    ", it follows that @xmath1033 .",
    "notice that if @xmath1034 , then @xmath1035 .",
    "we first observe that the carrier base of @xmath1027 belongs to @xmath1028 for all @xmath238 . indeed",
    ", if @xmath1036 is the generalised equation so that its carrier @xmath1037 belongs to @xmath1038 and for all @xmath1039 the carrier @xmath1040 of @xmath1027 belongs to @xmath1028 , then it follows that @xmath1041 - a contradiction .",
    "we now show that if @xmath1042 and @xmath1043 , then @xmath1044 is never carrier .",
    "assume the contrary , i.e. @xmath1045 is the carrier of @xmath976 for some @xmath7 .",
    "let @xmath1029 be a transfer base . in the infinite branch ,",
    "the base @xmath1029 is transferred infinitely many times .",
    "let @xmath1046 be the next time @xmath1029 is transferred .",
    "it is clear that the carrier @xmath1047 belongs to @xmath1048 , deriving a contradiction with the above observation .",
    "since , the generalised equation @xmath50 repeats , it follows that no boundaries are introduced between @xmath1049 and @xmath1050 . this derives a contradiction with the assumption that the section @xmath1025 $ ] of @xmath50 is active .",
    "let @xmath1029 be a base of @xmath50 .",
    "we call the number @xmath1051 the _ length _ of @xmath1029 ( in @xmath50 ) .",
    "we call the base _ short _ if @xmath1052 and _ long _ otherwise .",
    "let @xmath1053 and @xmath1054 be two long bases of @xmath50 .",
    "notice that since there are no free boundaries in @xmath50 and since , by lemma [ lem:1clsec ] , the generalised equation @xmath50 has only one active closed section , then every boundary touches precisely two bases .",
    "therefore , the bases @xmath1053 and @xmath1054 either do not overlap or if they do , then @xmath1055 or @xmath1056 .    for every generalised equation @xmath1057 from the infinite branch and any @xmath1058 ,",
    "the set of words @xmath1059 is either finite or infinite , i.e. the orbit of an item under the automorphisms associated to @xmath1057 is either a finite or an infinite set .",
    "define the set @xmath1060 to be the set of items of @xmath1057 for which this set is finite and let @xmath1061 be its complement .",
    "notice that by the description of automorphisms associated to a generalised equation of type @xmath1005 , see ( * ? ? ?",
    "* lemma 7.7 ) , any item that belongs to a quadratic - coefficient base of @xmath1057 or does not belong to the quadratic part is fixed by the automorphisms , and so belongs to the set @xmath1060 .",
    "let @xmath1062 and let @xmath1063 be the orbit of @xmath1064 by the family of automorphisms @xmath1065 associated to the vertex @xmath1066 .",
    "observe that the set of solutions @xmath1067 that factors through the fundamental branch is a discriminating family , where @xmath1068 is an automorphism associated to the vertex corresponding to @xmath1019 , @xmath1069 belongs to @xmath1070 , the epimorphism @xmath1071 is proper , and @xmath1072 is a solution of @xmath1073 . by lemma [ lem : discfam ]",
    ", it follows that one of the finitely many subfamilies @xmath1074 where @xmath1075 , @xmath1076 , is discriminating .",
    "hence , without loss of generality , we may assume that if @xmath1062 , then @xmath1077 .",
    "we therefore arrive at the following    [ rem : discrfam ] if @xmath1062 , then @xmath1078 , where @xmath1079 is a word in items from @xmath1069 , such that for a discriminating family of solutions @xmath1080 of the fundamental sequence , we have that @xmath1081 .",
    "we will show that , in fact , one can think of these items as quadratic - coefficient .",
    "let @xmath1082 be so that for all @xmath1083 we have that @xmath1084 . for all @xmath1085 such that @xmath1086",
    ", we have that @xmath1087 from the definition of @xmath1088 , we conclude that @xmath1089 and so @xmath1090 and @xmath1091 , for all @xmath1092 , @xmath1093 .",
    "[ rem : k ] without loss of generality , we may assume that for a fundamental sequence , we have that @xmath1062 if and only if @xmath1094 for all @xmath1095 so that @xmath1082 .",
    "therefore , for the discriminating family , one has that @xmath1096 , where @xmath1097 is the proper quotient in the tree @xmath1070 and @xmath1072 is a solution of @xmath1073",
    ".    furthermore , we have that if @xmath1062 then @xmath1098 for all @xmath1099 .",
    "hence @xmath1100 then , since the number @xmath1101 is bounded above by @xmath1102 , without loss of generality , we may assume that the number @xmath1101 is constant throughout the branch , i.e. @xmath1103 for all @xmath673 .",
    "given a generalised equation @xmath50 , we define @xmath1104 to be the set of minimal tribes of the generalised equation : @xmath1105 and @xmath1106 to be the set of items that belong to a given minimal tribe @xmath1107 of @xmath50 : @xmath1108 we draw the reader s attention to the fact that the minimal tribes are defined using the items from @xmath1109 , which , by definition , are active .",
    "[ lem : mintribe ] in an infinite branch of type @xmath1005 , there exists @xmath1110 so that @xmath1111 for all @xmath1112 . furthermore , the cardinality of the set @xmath1113 is constant , i.e. @xmath1114 for every minimal tribe @xmath1115 .",
    "since the generalised equation repeats infinitely many times , @xmath1014 and since there are finitely many different tribes , for sufficiently large @xmath249 and passing to a subsequence @xmath1116 , we may assume that the tribe of every item @xmath1117 is the same , i.e. @xmath1118 for all @xmath1119 .",
    "hence @xmath1120 and @xmath1121 for all @xmath1122 . to simplify the notation , set @xmath1123 .",
    "it follows from the above equalities that in order to prove that @xmath1111 and that @xmath1124 for all @xmath1125 and @xmath1126 , it suffices to show that @xmath1127 and that @xmath1128 .",
    "let @xmath913 be the carrier of @xmath817 , let @xmath1129 be the boundaries that touch a transfer base ( that is @xmath1130 ) and let @xmath1131 be the corresponding boundary connection introduced in the entire transformation .",
    "suppose that @xmath1132 is introduced between @xmath1133 and @xmath1134 .",
    "by lemma [ lem : tribes ] , it follows that @xmath1135 dominates @xmath1136 and @xmath1137 dominates @xmath1138 .",
    "therefore , we have that @xmath1127 and @xmath1128 for all minimal tribes @xmath1139",
    ".    we call the items of @xmath817 that belong to a minimal tribe _ minimal_.    recall that the carrier base @xmath1023 of @xmath817 is a long base",
    ". since there are no free boundaries , there are exactly @xmath971 transfer bases and all of them are short .",
    "moreover , @xmath1023 is a short transfer base of @xmath970 , see figure [ pic : ge ] .",
    "[ defn:88 ] let @xmath913 be the carrier base of @xmath50 .",
    "we take the ( uniquely defined ) transfer base @xmath1029 so that @xmath1140 and we @xmath913-tie the boundary @xmath1141 .",
    "we then transfer @xmath1029 from @xmath913 onto @xmath1142 .",
    "now , we cut @xmath913 in the boundary @xmath28 and delete the section @xmath1143 $ ] .",
    "it follows from the definition that the ( usual ) entire transformation @xmath1144 is a composition of the transformations just introduced ( namely of @xmath1145 such transformations ) . from now on ,",
    "we abuse the terminology and refer to the introduced transformation as to the _ entire transformation _ and refer to the usual entire transformation as to @xmath1144 or _ complete entire transformation_.    [ lem : ab ] in an infinite branch @xmath1146 of type @xmath1005 , there exists a generalised equation @xmath1147 such that    case a : :    either the item @xmath1148 belongs to a minimal tribe of    @xmath1149 , case b : :    or the entire transformation introduces a new boundary in an item that    belongs to a minimal tribe of @xmath1149 .",
    "let @xmath1150 be a minimal item of @xmath1013 .",
    "since @xmath1151 , by definition of the set @xmath1152 , the orbit of @xmath1150 under the automorphisms associated to @xmath1013 is infinite .",
    "therefore , there exists @xmath1153 so that @xmath1154 hence ,    * either a base covering the item @xmath1155 is transferred ( case a of the lemma ) and so , by remark [ rem : k ] , one can assume that @xmath1156 , * or , in the entire transformation of the generalised equation @xmath1147 , a new boundary is introduced between the boundaries @xmath1157 and @xmath1158 ( case b of the lemma ) .",
    "furthermore , since @xmath1159 for all @xmath1160 , it follows that the tribe of @xmath1161 is the same for all @xmath1162 , i.e. @xmath1163 .",
    "hence if @xmath1150 belongs to a minimal tribe @xmath1139 in @xmath1019 , then @xmath1161 also belongs to the tribe @xmath1139 and , by lemma [ lem : mintribe ] , @xmath1139 is a minimal tribe in @xmath1147 .    in an infinite branch of type @xmath1005 , @xmath1164 where @xmath817 is obtained from @xmath970 by an entire transformation",
    ", there exists a generalised equation @xmath1165 of the infinite branch such that the item @xmath1166 is minimal ( case a of lemma [ lem : ab ] holds ) .    by lemma [ lem : ab ] , it suffices to show that if in the infinite branch there exists a generalised equation that satisfies case b of lemma [ lem : ab ] , then there exists a generalised equation that satisfies case a.    without loss of generality , we may assume that the generalised equation @xmath1167 satisfies case b of lemma [ lem : ab ] , i.e. the entire transformation introduces a boundary connection @xmath1168 and the boundary @xmath1169 is between the boundaries @xmath1170 and @xmath1171 , where @xmath913 is the carrier base of @xmath1019 and @xmath1172 is a minimal item that belongs to some minimal tribe @xmath1173 .",
    "since , by lemma [ lem : mintribe ] , the number of minimal items of a fixed minimal tribe @xmath1173 in the infinite branch is constant , it follows that either @xmath1174 or @xmath1175 is minimal and belongs to @xmath1173 .",
    "if @xmath1176 , then , by lemma [ lem : tribes ] , @xmath1177 and hence @xmath1019 satisfies case a of lemma [ lem : ab ] .",
    "assume now that @xmath1174 is minimal and belongs to @xmath1173 .",
    "let @xmath25 be so that for all the boundary connections @xmath1178 , @xmath1179 , one has @xmath1180 and @xmath1181 .",
    "suppose that @xmath817 , @xmath1182 , does not satisfy case a of lemma [ lem : ab ] .",
    "then , since the number of minimal items of the minimal tribe @xmath1173 is constant in the infinite branch , it follows that @xmath1183 is minimal and belongs to @xmath1184 ( note that here @xmath1185 is the boundary of @xmath1019 ) . by definition of @xmath25 and lemma [",
    "lem : tribes ] , we have that the tribe of @xmath1183 dominates the tribe of @xmath1186 and hence , @xmath1186 is minimal and belongs to @xmath1184 .",
    "we conclude that the generalised equation @xmath1165 falls under case a of lemma [ lem : ab ] .",
    "[ lem : mincar ] let @xmath1019 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch .",
    "let @xmath913 be the carrier of @xmath1019 and let @xmath1187 be an item from a minimal tribe @xmath1173 .",
    "then , the item @xmath1188 is also minimal and belongs to @xmath1184 . in particular",
    ", the item @xmath1189 of @xmath1069 , where @xmath1069 is obtained from @xmath1019 by a complete entire transformation is minimal and belongs to @xmath1184 .",
    "the tribe of every item covered by @xmath913 dominates the minimal tribe @xmath1173 of @xmath1187 .",
    "furthermore , if an item @xmath1064 covered by @xmath913 strictly dominates the minimal tribe , then @xmath1190 and , in particular , @xmath1191 .",
    "recall that every @xmath913-tying introduces a new boundary .",
    "we only consider the case when @xmath1192 .",
    "the remaining cases are analogous .",
    "we @xmath913-tie all the boundaries @xmath1193 thus introducing boundaries @xmath1194 between the boundaries @xmath1195 and @xmath1196 ,  , @xmath1197 and @xmath1198 .",
    "we will denote the corresponding items of @xmath1069 by @xmath1199 , @xmath1200 and @xmath1201 .",
    "since the number of minimal items of a fixed minimal tribe in the infinite branch is constant , it follows that at least one of the items @xmath1202 and @xmath1203 belongs to @xmath1184 .",
    "hence , the item @xmath1204 of @xmath1019 is minimal and belongs to @xmath1184 .",
    "therefore , since the number @xmath1205 is constant both @xmath1202 and @xmath1203 are minimal and belong to @xmath1184 .",
    "if @xmath1206 , we conclude that the item @xmath1207 of @xmath1019 is minimal and belongs to @xmath1184 .",
    "either @xmath1208 or , otherwise , we can repeat the above argument for @xmath1209 .",
    "let @xmath609 be maximal so that @xmath1210 .",
    "then , the items @xmath1211 of @xmath1069 belong to the same tribe as the item @xmath1064 of @xmath1019 , @xmath1212 , and since the number @xmath1205 in the infinite branch is constant , then @xmath1213 is minimal and belongs to @xmath1184 .",
    "it follows that the item @xmath1214 is minimal and belongs to @xmath1184 , hence we can repeat the argument for @xmath1214 .",
    "we conclude that the item @xmath1188 of @xmath1019 is minimal and belongs to @xmath1184 as so does the item @xmath1215 of @xmath1069 .",
    "notice that we have shown that for any item @xmath1064 covered by @xmath913 , if @xmath1216 , then the tribe of @xmath1064 is minimal and belongs to @xmath1184 .",
    "furthermore , all the boundaries are introduced in items whose tribe is @xmath1173 . hence for any @xmath1064 covered by @xmath913 such that @xmath1217 , we have that its tribe dominates the minimal tribe @xmath1173 of @xmath1187 .",
    "[ rem : manymin ] from the proof of lemma [ lem : mincar ] , it follows that , under the assumptions of the lemma , the image of the minimal item @xmath1204 of @xmath1019 under @xmath847 is @xmath1218 and both of the items @xmath1202 , @xmath1203 are minimal .",
    "[ lem : alltransfer ] let @xmath1019 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch .",
    "then , in the infinite branch , all bases of @xmath1019 , but , perhaps , bases @xmath1219 contained in the long base @xmath1029 so that @xmath1220 , are transferred infinitely many times .",
    "notice that , without loss of generality , we can assume that if a base is transferred , then it is transferred infinitely many times in an infinite branch .",
    "consider the long base @xmath1029 of @xmath1019 so that @xmath1220 .",
    "let @xmath1221 be the set of bases contained in @xmath1029 .",
    "if either @xmath1029 or any of the bases in @xmath1221 is the carrier base or is transferred in some generalised equation of the infinite branch , say @xmath1222 , then @xmath1166 is an item with boundaries inside one of the items @xmath1223 .",
    "hence , the section @xmath1224 $ ] of @xmath1019 ( and so all the bases in this section ) has been transferred and the statement follows .",
    "notice that since the base @xmath1029 is long , for a base contained in @xmath1029 to be a carrier base of a generalised equation @xmath1222 , it is necessary that @xmath1225 or @xmath1029 be the carrier base of a generalised equation @xmath976 , where @xmath1226 .",
    "assume further that @xmath1029 and the bases from @xmath1221 are neither carrier bases nor transfer bases .    without loss of generality",
    ", we may assume that there exists a base @xmath1227 so that @xmath1228 is the carrier of some @xmath1222 . indeed , suppose that @xmath1228 is neither carrier nor transfer base for all @xmath1227 .",
    "in this case , the section @xmath1229 $ ] can be declared non - active and we can set @xmath1230 to be @xmath1030 .",
    "similarly , if some base @xmath1228 is transferred but for all generalised equations we have @xmath1231 , then the section @xmath1229 $ ] can be declared non - active and we can set @xmath1230 to be @xmath1030 . finally , assume that a base @xmath1228 is transferred and for some generalised equation we have that @xmath1232 .",
    "since @xmath1228 is transferred infinitely many times and transfer bases are always short , it follows that before being transferred , the base @xmath1228 must be a carrier base ( since this is the only way a long base can become short ) .",
    "therefore , there exists a base @xmath1227 so that @xmath1228 is the carrier of some @xmath1222 .    note",
    "that since the branch is infinite , every @xmath913-tying introduces a new boundary . since there exists a base @xmath1233 so that @xmath1228 is the carrier of some generalised equation , say @xmath1222 , at this step the new boundaries are introduced in the section @xmath1229 $ ] .",
    "hence , for the generalised equation @xmath1019 to repeat , there must exist @xmath7 so that @xmath1225 is the carrier of @xmath976 .",
    "notice that , in particular , we have shown that in the assumptions of the lemma , either @xmath1029 or its dual @xmath1225 is a carrier base .",
    "suppose that @xmath1234 .",
    "then , in the generalised equation @xmath1235 we have @xmath1236 .",
    "hence , for the generalised equation @xmath1019 to repeat , the base @xmath1029 has to be transferred . in this case , we conclude that all the bases of @xmath1019 , but , perhaps , bases @xmath1219 contained in a base @xmath1029 so that @xmath1220 , are transferred infinitely many times .",
    "suppose now that @xmath1237 .",
    "let @xmath1219 be the ( uniquely defined ) transfer base of @xmath976 so that @xmath1238 .",
    "since the base @xmath1219 is a transfer base of @xmath976 , it is transferred infinitely many times in an infinite branch and hence for some generalised equation , say @xmath1222 , the item @xmath1166 is an item with boundaries inside one of the items @xmath1223 .",
    "hence , the section @xmath1224 $ ] of @xmath1019 ( and so all the bases in this section ) has been transferred and the statement follows .",
    "[ lem:1stlast ] let @xmath50 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch and let @xmath1239 be minimal .",
    "then , for every long base @xmath1029 , the items @xmath1240 and @xmath1241 are minimal .    in other words , all items that are not covered by a short base are minimal and belong to the same minimal tribe @xmath1173 and all the other items belong to tribes that dominate @xmath1173 .    by lemma [ lem : mincar ] , if @xmath1069 is obtained from @xmath50 by a ( complete ) entire transformation @xmath1144 , then the item @xmath1189 of @xmath1069 is also minimal .",
    "hence , in the infinite branch , the items @xmath1242 and @xmath1243 are always minimal and the items @xmath840 , @xmath1244 belong to tribes that dominate the tribe of @xmath1242 , where @xmath1023 is the carrier of @xmath817 .",
    "let @xmath1029 be the ( uniquely defined ) long base so that @xmath1220 .",
    "we now consider an arbitrary long base @xmath1245 of the generalised equation @xmath50 distinct from @xmath1029 . to prove the lemma",
    ", it suffices to show that @xmath1246 is minimal .    for every generalised equation @xmath817 we have that    case",
    "i : :    either the boundary @xmath397 of @xmath817    corresponds to a boundary @xmath103 of @xmath50 ,    @xmath1247 in @xmath50 , case ii : :    or there exists a base @xmath1248 of @xmath817    so that @xmath1249 corresponds to the boundary    @xmath1250 of @xmath50 .    furthermore , since @xmath1251 , by lemma [ lem : alltransfer ] , there exists @xmath30 so that for all @xmath1252 the generalised equation @xmath1027 satisfies case i , and for all @xmath1253 the generalised equation @xmath1046 satisfies case ii .",
    "notice that the boundary @xmath1254 of @xmath1255 corresponds to a boundary @xmath1256 of @xmath50 , so that @xmath1257 .",
    "suppose that @xmath1258 ( i.e. the boundary @xmath1259 corresponds to the boundary @xmath1250 of @xmath50 ) .",
    "then , the boundary @xmath1260 of @xmath1255 corresponds to a boundary between @xmath1261 and @xmath1250 in @xmath50 . since @xmath1262 is minimal ,",
    "so is @xmath1246 .    if @xmath1263 in @xmath50 ( i.e. @xmath1264 is a transfer base of @xmath1255 ) , then , it is not hard to see that the boundary @xmath1265 of @xmath1255 corresponds to a boundary between @xmath1261 and @xmath1250 in @xmath50 . we conclude that @xmath1246 is minimal .",
    "[ cor : prelasttransfer ] let @xmath50 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch and let the item @xmath1239 of @xmath50 be a minimal item that belongs to the minimal tribe @xmath1266 of @xmath50 .",
    "then , the tribe @xmath934 of any item @xmath822 of @xmath50 dominates the tribe @xmath1267 , @xmath1268 .    by lemma [ lem : alltransfer ] , all bases of @xmath50 but ,",
    "perhaps , bases @xmath1219 contained in a base @xmath1029 so that @xmath1220 , are transferred infinitely many times .",
    "hence , by lemma [ lem:1stlast ] , it now follows that the tribes of all the items @xmath822 , @xmath1269 of @xmath50 dominate the tribe @xmath1267 , where @xmath1029 is the ( uniquely defined ) long base so that @xmath1220 .",
    "since the base @xmath1225 is not contained in @xmath1029 , so the tribe of every item that belongs to @xmath1225 dominates the tribe @xmath1267 .",
    "it follows that the base @xmath1225 , and so @xmath1029 , belong to a tribe that dominates @xmath1267 .",
    "therefore , the tribe of every item that belongs to @xmath1029 dominates @xmath1267 .",
    "it follows from corollary [ cor : prelasttransfer ] that if @xmath50 is a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch , then there is only one minimal tribe in @xmath50 , i.e. @xmath1270 .",
    "we further denote this minimal tribe by @xmath1173 .",
    "let @xmath830 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch and assume that the tribe of @xmath1239 is minimal .",
    "denote by @xmath1271 the set of all active bases of the generalised equation @xmath50 .",
    "our next goal is to show that the set @xmath1272 is a generating set of the subgroup of @xmath842 generated by the active items of @xmath50 ( i.e. the subgroup generated by the items from the quadratic section of @xmath50 ) . in this new generating set , we prove that this subgroup is tietze - equivalent to a one - relator quotient of a partially commutative group , where the relation is a quadratic word .    to simplify the notation , below we sometimes write @xmath1273 instead of @xmath1274 .",
    "firstly , we use induction to define the map @xmath48 from the subgroup generated by the items of the quadratic part of @xmath821 to the subgroup @xmath1275 of @xmath841 as follows .    recall that if @xmath1276 is the long leading base , then every item @xmath822 , @xmath1277 is covered by a short base @xmath1248 .",
    "then , for every item @xmath822 , @xmath1277 , we set @xmath1278 .",
    "notice that @xmath1279 we set @xmath1280 note that the image of the item @xmath1281 is a word @xmath1282 in the bases @xmath1248 so that @xmath1283 and every such base occurs in @xmath1282 precisely once .",
    "suppose that the map @xmath48 is defined for all the items @xmath822 , @xmath1284 , and that if an item @xmath822 is covered only by long bases , then the image @xmath1285 is a word @xmath1286 in the bases @xmath1219 so that @xmath1287 and every such base occurs in @xmath1286 precisely once .",
    "we define @xmath1288 recursively .",
    "if @xmath925 is covered by a short base @xmath1289 , then we set @xmath1290 .",
    "otherwise , @xmath925 is only covered by ( two ) long bases @xmath1291 and @xmath1292 , where @xmath1293 .",
    "then , we define @xmath1294 since @xmath1295 and the item @xmath1296 is covered by two long bases , it follows by induction assumption that @xmath1297 is a word in the bases @xmath1219 so that @xmath1298 , and every such base occurs in this word precisely once .",
    "it follows that @xmath1288 is a word in the bases @xmath1219 so that @xmath1299 , and every such base occurs in this word precisely once .",
    "let @xmath50 be the generalised equation given on figure [ pic : ge ] . then",
    ", @xmath1300    we now determine the presentation of the subgroup generated by active items of the quadratic part of @xmath821 in the generators @xmath1271 .",
    "note that , by lemma [ lem:1clsec ] , every boundary of @xmath50 touches precisely two bases , i.e. for every boundary @xmath249 , @xmath1301 , there exist a base @xmath1248 such that @xmath1302 and a base @xmath1303 such that @xmath1304",
    ". therefore we can define the words : @xmath1305 where @xmath1306 and @xmath1307 where @xmath1308 .",
    "we set @xmath1309    for each item @xmath822 , @xmath1310 , i.e. for items that does not belong to the active quadratic section , we set @xmath1311 .",
    "let @xmath50 be the generalised equation given on figure [ pic : ge ] .",
    "then , @xmath1312    [ lem:9.19 ] in the above notation , the map @xmath48 induces an isomorphism from @xmath841 to the group @xmath1313 where @xmath1273 runs over the set of quadratic bases , @xmath1219 runs over the set of quadratic - coefficient bases and @xmath1314 is the set of relations of the non - active part , i.e. @xmath1314 is the set of relations @xmath1315 , for all pairs of non - active bases @xmath913 , @xmath1316 .",
    "straightforward computation shows that for every base @xmath1273 that belongs to the quadratic part such that either @xmath1273 is short or @xmath1317 , we have @xmath1318 .",
    "indeed , if @xmath1273 is short , then the statement is obvious .",
    "let @xmath1273 be a long base .",
    "then , the item @xmath1319 is covered by two long bases , @xmath1273 and @xmath1245 .",
    "we have @xmath1320 we conclude that @xmath48 maps @xmath1321 to the identity in @xmath1322 for all pairs of dual bases except for the pair @xmath1323 , where @xmath1029 is the ( uniquely defined ) long base so that @xmath1220 . for the pair @xmath1323",
    ", we have @xmath1324 thus , @xmath1325 is the product of all bases @xmath1219 of @xmath50 so that @xmath1326 .",
    "it follows that @xmath1327 is trivial in @xmath1322 since @xmath1328 and @xmath1329 are relations of @xmath1322 .",
    "we conclude that @xmath48 is a ( surjective ) homomorphism .",
    "we define the map @xmath1330 by @xmath1331 .",
    "the map @xmath1332 extends to a homomorphism .",
    "straightforward verification shows that every relation of @xmath1322 maps to the identity in @xmath843 and that @xmath1333 and @xmath1334 and we conclude that @xmath48 is an isomorphism .",
    "let us now show how to extend the isomorphism @xmath48 to an isomorphism of @xmath842 .",
    "let @xmath1335 be the set of relations defined as follows .",
    "* for every pair of items @xmath1336 of @xmath50 so that @xmath835 and @xmath822 , @xmath840 are covered by short bases @xmath1248 , @xmath1337 , correspondingly , we set @xmath1338=1\\in \\xi$ ] .",
    "* for every pair of items @xmath1336 of @xmath50 so that @xmath835 and @xmath822 is covered by a short base @xmath1248 and @xmath840 is a non - active item , we set @xmath1339=1\\in \\xi$ ] .",
    "* for every pair of items @xmath1336 of @xmath50 so that @xmath835 and @xmath822 is covered only by long bases and @xmath840 is a non - active item , we set @xmath1340=1\\in \\xi$ ] , for all bases @xmath1273 in the quadratic section .",
    "* for every pair of items @xmath1336 of @xmath50 so that @xmath835 and @xmath822 and @xmath840 belong to the non - active part , we set @xmath839=1 \\in \\xi$ ] .",
    "[ lem : isoquad ] let @xmath830 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch and let @xmath1239 be minimal . then , in the above notation , the map @xmath48 induces an isomorphism from @xmath842 to the group @xmath1341 where @xmath1273 runs over the set of quadratic bases , @xmath1219 runs over the set of quadratic - coefficient bases and @xmath1314 is the set of relations of the non - active part , i.e. @xmath1314 is the set of relations @xmath1315 , for all pairs of non - active bases @xmath913 , @xmath1316",
    ".    by lemma [ lem:9.19 ] , the map @xmath48 induces an isomorphism from @xmath841 to @xmath1322 .",
    "observe that if an item @xmath822 belongs to two long bases , then , by lemma [ lem : mintribe ] , it belongs to the minimal tribe .",
    "since any other item @xmath840 from the quadratic part belongs to a tribe that dominates the tribe of @xmath822 , it follows that @xmath1342 , i.e. if @xmath942 , then @xmath925 is non - active .",
    "now a straightforward verification shows that @xmath48 is an epimorphism .",
    "furthermore , since , by remark [ rem : completed ] , the set @xmath945 is completed , it follows that @xmath48 is an isomorphism . indeed , if an item @xmath822 belongs to two long bases , then by lemma [ lem:1stlast ] , it belongs to the minimal tribe .",
    "since items of the quadratic part belong to tribes that dominate the minimal tribe and , by assumption , @xmath945 is completed , it follows that if @xmath835 , then @xmath942 for all items @xmath925 from the quadratic part .    our next goal is to show that under the above conditions , one can take the quadratic equation @xmath17 to the standard form . in order to do so",
    ", we replace the generalised equation @xmath50 by another generalised equation , in which if an item belongs to a tribe which strictly dominates the minimal tribe , then this item is covered by a short quadratic - coefficient base .    by lemma [ lem : mincar ] , items that belong to tribes which strictly dominate the minimal tribe",
    "belong to @xmath1343 . by remark [ rem : discrfam ]",
    ", there exists a fundamental sequence so that for any item @xmath1064 that belongs to a tribe that strictly dominates @xmath1344 , there exists a word @xmath1345 so that for all solutions @xmath1080 of the discriminating family , we have that @xmath1346 and @xmath1347 .",
    "we replace @xmath1348 by a new generalised equation @xmath1349 constructed as follows .",
    "replace the non - active part of @xmath1167 by the non - active part of @xmath1350 . for any item @xmath1064 in the active part that does not belong to the minimal tribe @xmath1344 let @xmath1351 , @xmath1352 .",
    "introduce new boundaries in the item @xmath1064 so that @xmath1353 , @xmath1352 , @xmath1354 . erase the short base @xmath1029 of @xmath1167 that covers @xmath1064 .",
    "we now introduce new bases @xmath1355 along with the corresponding duals in such a way that @xmath1356 covers the item @xmath1357 , @xmath953 and the dual @xmath1358 covers the item @xmath1359 and @xmath1360 , @xmath1361 .",
    "note that , by lemma [ lem:1stlast ] , it follows that if a short base covers an item that belongs to a tribe which strictly dominates @xmath1344 , then either it is a quadratic - coefficient base or it is quadratic and its dual is also a short base .",
    "hence , the base @xmath1225 is a short base that covers an item that dominates @xmath1344 .",
    "the set @xmath1362 of @xmath1363 is defined naturally : @xmath1364 if and only if @xmath1365 or @xmath1366 ; @xmath1367 if and only if @xmath1368 ; @xmath1369 if and only if @xmath1370 ; the other relations in @xmath1362 are naturally induced by @xmath1371 and @xmath1372 .",
    "we assume that @xmath1362 is completed ( see remark [ rem : completed ] ) .",
    "we conclude that :    * @xmath1373 is a generalised equation of type @xmath1005 ; * if @xmath1374 is a natural homomorphism , then any solution @xmath26 of the generalised equation @xmath1019 that belongs to a fundamental sequence induces a solution @xmath854 of the generalised equation @xmath1363 . in other words",
    ", for any homomorphism from the fundamental sequence there exists a homomorphism from @xmath1375 so that the following diagram is commutative @xmath1376^{\\varsigma } \\ar[dr]_{h } &   &     g_{\\omega_{0 } ' } \\ar[dl]^{h ' }     \\\\                  & g_{\\omega_1}\\ar[d]_{h^{(1)}}\\\\   & { \\ensuremath{\\mathbb{g}}}}\\ ] ] * @xmath846 is a retraction of @xmath1377 .    note that if @xmath1219 is an active base of @xmath1373 , then either the tribe of every item @xmath1378 , @xmath1379 , covered by @xmath1219 dominates @xmath1344 and at least one of the items belongs to the tribe @xmath1344 or else every item covered by @xmath1219 belongs to a tribe that strictly dominates @xmath1344 and then the base @xmath1219 is a short quadratic - coefficient base . in other words , in @xmath1380 the tribe of every quadratic base is the same minimal tribe and the tribes of the quadratic - coefficient bases dominate this minimal tribe .",
    "let @xmath1381 for all quadratic bases @xmath913 and all quadratic coefficient bases @xmath1219 .",
    "it is clear that @xmath1382 is a free group .",
    "let @xmath1383 be quotient of @xmath1382 by the set of commutators @xmath1384 defined analogously to @xmath1335 , see equation ( [ eq : cak ] ) . by definition , @xmath1383 is a free partially commutative group .",
    "the word @xmath17 defined in equation ( [ eq : w ] ) is a quadratic word in the free group @xmath1382 .",
    "it can be taken to the surface relation form ( [ eq : orient ] ) or ( [ eq : nonorient ] ) by an automorphism of the free group @xmath1382 , see @xcite .",
    "[ lem : qnorm ] let @xmath547 be the automorphism of the free group @xmath1382 that takes the quadratic equation @xmath1328 to the normal form . then , @xmath547 induces an automorphism @xmath1385 of the partially commutative group @xmath1383 that takes the quadratic equation @xmath1328 to the normal form and fixes all the quadratic - coefficient bases and items @xmath822 , @xmath1310 .",
    "denote by @xmath1386 the set of variables of @xmath1328 that occur in @xmath17 exactly twice . by definition of @xmath1382 and @xmath1383 and by construction of @xmath1363",
    ", we get that if @xmath1387 , then @xmath259 is a quadratic base of @xmath1363 and the tribe of @xmath259 is the minimal tribe @xmath1344 .",
    "suppose that @xmath1388 .",
    "let @xmath1389 be the automorphism of @xmath1382 induced by the map @xmath1390 .",
    "the automorphism @xmath1389 transforms the word @xmath17 into @xmath1391 every letter in @xmath20 and @xmath363 is either a variable of @xmath1328 ( then it corresponds to a quadratic base which belongs to @xmath1344 ) or it is a coefficient of @xmath1328 ( then it corresponds to a quadratic - coefficient base which belongs to a tribe that strictly dominates @xmath1344 ) . hence , by @xcite",
    ", it follows that @xmath1389 induces an automorphism of @xmath1383 .",
    "observe that @xmath1392 is a quadratic word in fewer variables than @xmath17 .",
    "the statement now follows by induction .",
    "suppose now that every variable @xmath259 of @xmath17 occurs in it as @xmath259 and as @xmath1393 .",
    "let @xmath1394 , where the number of variables @xmath1395 in @xmath363 is minimal among all such decompositions of @xmath17 .",
    "in particular , it follows that @xmath363 is linear .    if @xmath1396 , then we consider the automorphism @xmath1389 of @xmath1382 defined by the map @xmath1397",
    ". then , @xmath1398 . as above",
    ", the automorphism @xmath1389 induces an automorphism of @xmath1383 .",
    "note that the number of variables in @xmath1399 is strictly lower than that of @xmath17 and the statement , in this case , follows by induction .",
    "let @xmath1400 .",
    "then , @xmath1401 , where @xmath1402 , and neither @xmath1403 nor @xmath1404 contains @xmath1405 . applying the automorphism @xmath1406 , if necessary",
    ", we may assume that @xmath1407 .",
    "consider the automorphism @xmath1408 of @xmath1382 defined by @xmath1409 .",
    "then , @xmath1410 .",
    "the variable @xmath1411 occurs either in @xmath20 or in @xmath166 .",
    "we assume that @xmath1411 occurs in @xmath166 ( the other case is similar ) , i.e. @xmath1412 .",
    "then , @xmath1413    applying the automorphism @xmath1389 defined by the map @xmath1414 , we get that @xmath1415 let @xmath1416 be the automorphism that conjugates @xmath259 and @xmath260 by @xmath1417 .",
    "then @xmath1418 as above , the automorphisms @xmath1416 , @xmath1389 and @xmath1408 induce automorphisms of @xmath1383 .",
    "we now observe that @xmath1419 is a quadratic word in fewer variables than @xmath17 and the statement now follows by induction .    [ cor : quadnf ] in the notation of lemma [ lem : qnorm ] , the automorphism @xmath1385 induces an automorphism of the group @xmath1420 that takes the quadratic relation to the normal form .",
    "therefore , if @xmath830 is a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch , @xmath1239 is minimal and @xmath945 is completed , then , @xmath842 is isomorphic to the group @xmath1421 where @xmath1273 runs over the set of quadratic bases , @xmath1219 runs over the set of quadratic - coefficient bases and @xmath17 is a quadratic word in the normal form @xmath1422\\cdots[\\eta_{2g-1},\\eta_{2g}]{\\lambda_{2g+1}}^{\\eta_{2g+1}}\\cdots { \\lambda_m}^{\\eta_{m}}=\\\\ \\phantom{a}\\pi(v_0,v_1)([\\eta_1,\\eta_2]\\cdots[\\eta_{2g-1},\\eta_{2g}]{\\lambda_{2g+1}}^{\\eta_{2g+1}}\\cdots { \\lambda_m}^{\\eta_{m } } ) \\end{array}\\ ] ] or @xmath1423 and where @xmath1314 is the set of relations of the non - active part , i.e. @xmath1314 is the set of relations @xmath1424 , where @xmath913 , @xmath1316 runs over the set of pairs of non - active bases .",
    "we finally address the construction of the graph tower .",
    "our goal is to construct a graph tower @xmath1425 and a homomorphism @xmath852 from @xmath845 to @xmath851 such that for every homomorphism @xmath26 from @xmath1426 to @xmath18 from the fundamental sequence there exists a homomorphism @xmath854 such that diagram ( [ diag : period ] ) commutes .",
    "recall that we use induction on the length of the fundamental sequence @xmath1427 and our induction hypothesis are ih , ih1 and ih2 defined on page .",
    "we further assume that @xmath1019 satisfies the properties of @xmath1363 , i.e. the short bases that belong to a tribe that strictly dominate the minimal tribe are quadratic - coefficient bases .",
    "we aim to prove that there exists the following commutative diagram @xmath1428_{\\pi(v_0,v_1 ) } \\ar[rr]^{\\tau_0 } &   & { \\mathfrak{t}}_0 \\ar@{->>}@<-1ex>[d ] & & \\ar@{->>}[ll ] { \\ensuremath{\\mathbb{h}}}_0 \\ar@{->>}@<-1ex>[d]\\\\ g_{\\omega_1 }   \\ar[rr]_{\\tau_1 }   \\ar[dr]_h                 &   & \\ar[dl]^{h ' } { \\mathfrak{t}}_1\\ar@{_{(}->}@<-1ex>[u ]   & & \\ar@{->>}[ll ] { \\ensuremath{\\mathbb{h}}}_1\\ar@{_{(}->}@<-1ex>[u]\\\\   & { \\ensuremath{\\mathbb{g } } } & } \\ ] ] and that the graph tower @xmath1425 satisfies all the induction hypothesis .",
    "we fix the following notation for the generators of the groups we consider : @xmath1429 , @xmath1430 , @xmath1431 , and @xmath1432 .",
    "denote by @xmath1433 the composition of @xmath1004 and @xmath1009 .",
    "let @xmath1434 be the subset of the set of quadratic bases of @xmath1019 so that , for each pair of dual bases @xmath823 , the set @xmath1434 contains exactly one of them .",
    "let @xmath238 be the cardinality of the set @xmath1434 .",
    "notice that , by definition , the set @xmath1434 contains long bases and short bases that belong to the minimal tribe .    for every @xmath1435 , set @xmath1436 .",
    "we define the canonical parabolic subgroup @xmath134 of @xmath236 to be @xmath1437 .    the subgroup @xmath134 of @xmath236 is @xmath1438-co - irreducible .",
    "let us begin with an observation .",
    "by remark [ rem : discfam ] , there exists a canonical parabolic subgroup @xmath1439 such that for a fundamental sequence of solutions , we have that @xmath1440 . by definition of @xmath134 and by the induction hypothesis ih1 , we have that @xmath1441 for a fundamental sequence of @xmath846 . furthermore ,",
    "if @xmath1442 , where @xmath1443 , @xmath1444 , again by the induction hypothesis ih1 , we have that @xmath1445 and so @xmath1446 , hence we have that @xmath1447    since every solution @xmath1448 from the fundamental sequence is obtained from a solution @xmath1072 of @xmath1069 from the fundamental sequence by precomposing it with a canonical automorphism ( and @xmath1004 ) , it follows that @xmath1449 for all solutions @xmath1448 of the fundamental sequence if and only if @xmath1450 for all @xmath1072 from the fundamental sequence , where @xmath1451 .",
    "therefore , @xmath1452 and since all the bases @xmath1273 belong to the same minimal tribe , it follows that @xmath1453 , for all @xmath1454 . furthermore , since any minimal item @xmath1064 belongs to the same minimal tribe , we have that @xmath1455 . hence ,",
    "if @xmath1456 is so that the tribe of @xmath1456 dominates the minimal tribe , then we have that @xmath1457 .",
    "let us now address the statement of the lemma",
    ". by definition , the group @xmath134 is closed , i.e. @xmath1458 .",
    "we only need to show that @xmath756 is @xmath1438-directly indecomposable .",
    "assume the contrary , then @xmath1459 , where @xmath1460 ( and this decomposition is with respect to the edges from @xmath1438 ) .",
    "without loss of generality , we shall assume that @xmath1461 . by remark [ rem : discfam ]",
    ", there exist canonical parabolic subgroups @xmath1462 , @xmath1463 such that for all solutions @xmath1448 from the fundamental sequence we have @xmath1464 , @xmath1463 .",
    "furthermore , by the induction hypothesis ih1 , @xmath1465 . as we have shown , if @xmath1064 is an item whose tribe dominates the minimal tribe , then @xmath1466 .",
    "it follows by lemma [ lem:1stlast ] , that @xmath1467)\\in { \\ensuremath{\\mathbb{g}}}_{{\\ensuremath{\\mathbb{k}}}_1}\\times { \\ensuremath{\\mathbb{g}}}_{{\\ensuremath{\\mathbb{k}}}_2}$ ] .    by lemma [ lem:1clsec ] ,",
    "the section @xmath1468 $ ] is a closed section of @xmath50 and , by remark [ rem : recall ] , the word @xmath1469 $ ] is a subword of a word in the dm - normal form .",
    "it follows by lemma [ lem : pc ] , that the word @xmath1469 $ ] contains only a bounded number of @xmath1470-alternations .",
    "when applying an entire transformation from @xmath1019 to @xmath1069 , the only items that could be mapped to a word of length greater than one by the epimorphism @xmath1004 are @xmath1187 and @xmath1204 , where the boundary connection @xmath1471 is introduced and @xmath1472 is introduced between the boundaries @xmath1473 and @xmath1474 of @xmath1019 .",
    "the image of @xmath1187 is a word that contains at least one minimal item , namely the item @xmath1202 . by remark [ rem : manymin ] , the image of @xmath1204 is the word @xmath1218 and both of the items @xmath1202 , @xmath1203 are minimal . hence , the image of @xmath1475)$ ] is a word in variables @xmath1476 that contains at least @xmath1477 minimal items .    repeating this argument , we conclude that @xmath1478))$ ] is a word in @xmath1479 that contains at least @xmath1480 minimal items . by (",
    "* lemma 7.12 ) , in an infinite branch of type 12 , there exists an infinite sequence of generalised equations @xmath1481 , so that every solution @xmath1482 of @xmath1483 induces a solution @xmath1484 of @xmath1019 .",
    "therefore , on the one hand , @xmath1469 \\in { \\ensuremath{\\mathbb{g}}}_{{\\ensuremath{\\mathbb{k}}}_1}\\times { \\ensuremath{\\mathbb{g}}}_{{\\ensuremath{\\mathbb{k}}}_2}$ ] . on the other hand ,",
    "@xmath1469 $ ] is graphically equal to a word @xmath1485 that contains @xmath1486 minimal items .",
    "every minimal item defines at least one @xmath1470-alternation .",
    "hence , the word @xmath1469 $ ] contains at least @xmath1486 many @xmath1470-alternations , deriving a contradiction .",
    "therefore , we have that @xmath1487 , @xmath1488 is a block and @xmath756 is directly indecomposable .",
    "[ rem : blocks ] it follows from the above proof that for all solutions @xmath26 from the fundamental sequence , @xmath1489 is a block element for all minimal items @xmath822 from @xmath50 and @xmath1490 .",
    "[ lem : eired ] let @xmath50 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch and let @xmath1239 be minimal .",
    "then , there exists an element @xmath1491 so that @xmath1492 is irreducible for all @xmath26 from the fundamental sequence .",
    "since the word @xmath1493 is a block ( see remark [ rem : blocks ] ) , since the tribe of @xmath822 dominates the minimal tribe ( see lemma [ cor : prelasttransfer ] ) , and since the word @xmath1494 $ ] is reduced as written , it follows that the word @xmath1494 $ ] is a block element for all @xmath1495 . furthermore ,",
    "if the word @xmath1494 $ ] is not irreducible , then it is not cyclically reduced .    if the word @xmath1496 = w v w^{-1}$ ] is not cyclically reduced , then by ( * ? ? ?",
    "* proposition 3.18 ) , the word @xmath1497 , where @xmath1498 is a left divisor of @xmath1493 , @xmath1499 , @xmath1500 is a left divisor of @xmath1501 $ ] , @xmath1501=d_2u_2 $ ] , and @xmath1502 . furthermore ,",
    "since @xmath1493 is a block element and @xmath1503 , it follows that @xmath1504 , hence @xmath1505 .",
    "let @xmath913 be the carrier base of @xmath50 .",
    "suppose that @xmath1506 . in this case",
    ", we show that @xmath1507 $ ] is irreducible .",
    "assume the contrary .",
    "then , from the above discussion , it follows that @xmath1508=d_1 u d_1^{-1}$ ] , where @xmath1509 is a left divisor of @xmath1493 . on the other hand , by lemma [ lem:1clsec ] ,",
    "the word @xmath1510= h[1,\\alpha(\\delta(\\mu))-1]h(\\delta(\\mu))$ ] is reduced - a contradiction since @xmath1511 right - divides @xmath1507 $ ] and @xmath1498 left - divides @xmath1512 .",
    "suppose now that @xmath1513 .",
    "let @xmath1219 be the ( uniquely defined ) long base , so that @xmath1514 . note",
    "that , since @xmath50 is formally consistent , see ( * ? ? ?",
    "* definition 3.9 ) , we have that @xmath1515 .",
    "let @xmath956 be obtained from @xmath50 by a complete entire transformation .",
    "if @xmath1516 in @xmath956 , then , by lemma [ lem : mincar ] , the argument above applies to the generalised equation @xmath956 and the carrier base @xmath1219 .",
    "suppose that @xmath1517 in @xmath956 .",
    "let @xmath1518 be obtained from @xmath956 by a complete entire transformation .",
    "then , we have that @xmath1506 in @xmath1518 .",
    "notice that since the generalised equation @xmath50 repeats infinitely many times in the infinite branch , the tribe @xmath935 of @xmath913 is minimal in @xmath1518 . without loss of generality ,",
    "let @xmath1519 . from the above argument",
    ", it follows that the word @xmath1520 $ ] is irreducible .",
    "therefore , since @xmath1521 , the statement follows .",
    "recall that quadratic words of the type @xmath1522 , x^2 , z^{-1}cz$ ] , where @xmath491 is a constant are called _ atomic quadratic words _ or simply _",
    "atoms_. let @xmath1523 be a quadratic equation over @xmath0 written in the form @xmath1524 , where @xmath683 are atoms and @xmath1525 .",
    "the number @xmath25 is called the _ rank _ of the quadratic equation .",
    "suppose that the rank @xmath25 of @xmath1328 is greater than or equal to @xmath28 .",
    "a solution @xmath26 of @xmath17 is atom - commutative if @xmath1526=1 $ ] for all @xmath1527 .",
    "suppose that the quadratic equation satisfies one of the following two alternatives :    * the euler characteristic of @xmath17 is at most @xmath1528 , or @xmath17 corresponds to a punctured torus and the subgroup @xmath1529 of @xmath999 is non - abelian , i.e. the retraction of the ( punctured ) surface onto @xmath999 is non - abelian ; * the rank @xmath25 of @xmath17 is greater than or equal to @xmath28 and the minimal solution @xmath1433 is not atom - commutative .",
    "note that , in the case of free groups , the above conditions are sufficient to ensure that the radical of the quadratic equation @xmath1328 coincides with the normal closure , @xcite .",
    "we will see in the next section that the same result holds for arbitrary partially commutative groups ( under the condition that the set of solutions of the quadratic equation factors through an infinite branch ) .",
    "notice that , by lemma [ lem : typeskperp ] , we have that @xmath756 is either @xmath147-directly indecomposable or @xmath148-free abelian .",
    "if the equation @xmath17 satisfies one of the above alternatives , then @xmath756 can not be free abelian and hence it is directly indecomposable .",
    "define the graph @xmath767 as follows :    * @xmath1530 ; * @xmath1531 and * @xmath1532 ,    where @xmath1533 .",
    "then , the group @xmath1534 is given by the presentation @xmath1535=1 ,   \\hbox { for all } x_j^{(1 ) } \\in { \\ensuremath{\\mathbb{k } } } , i=1,\\dots , n \\rangle.\\ ] ]    define the map @xmath1536 as follows @xmath1537    if @xmath1538 , then we set @xmath851 to be the quotient of @xmath1539 by the set of relations @xmath1540 and the set of relations @xmath87 consisting of the set of basic relations @xmath1541 = 1 $ ] , @xmath1542 and the relation @xmath1543 , where @xmath17 is a quadratic word in the normal form from corollary [ cor : quadnf ] .",
    "notice that @xmath1543 is a quadratic word in the normal form in variables @xmath1544 , @xmath1545 .",
    "[ lem : qhom ] the map @xmath1536 extends via the isomorphism @xmath48 ( see lemma [ lem : isoquad ] ) to a homomorphism @xmath852 from @xmath845 to @xmath851 .    by corollary [ cor : quadnf ] ,",
    "the group @xmath845 is isomorphic to the group @xmath1420 .",
    "we show that @xmath1536 induces a homomorphism from @xmath1420 to @xmath851 .",
    "it is immediate to check that if @xmath486 is either the relation @xmath1328 or a relation of the type @xmath1546 or a relation from @xmath1314 , then @xmath1547 .",
    "therefore , we are left to show that @xmath1536 is trivial on the set of commutators @xmath1335 .",
    "assume that @xmath1548=1)\\in \\xi$ ] where @xmath1549 are short bases .",
    "since bases from the quadratic part belong to tribes that dominate the minimal tribe , it follows that @xmath1248 and @xmath1337 belong to a tribe that strictly dominates the minimal tribe and hence , since we assume that @xmath1550 , the bases @xmath1248 and @xmath1337 are quadratic - coefficient bases .",
    "since @xmath1551)=\\varphi_0([\\nu_i , \\nu_j])$ ] and @xmath1433 is a homomorphism , we have that @xmath1551)=1 $ ] .    similarly , if @xmath1552=1)\\in \\xi$ ] , where @xmath1248 is a quadratic - coefficient base and @xmath1456 is a non - active item , then @xmath1553)=\\varphi_0([\\nu_i , h_j^{(0)}])=1 $ ] .    if @xmath1554=1 ) \\in \\xi$ ] , where @xmath1064 and @xmath1456 belong to the non - active part , then @xmath1555)=\\varphi_0([h_i^{(0 ) } , h_j^{(0)}])=1 $ ] .",
    "assume that @xmath1552=1)\\in \\xi$ ] , where @xmath1248 is a quadratic base and @xmath1456 is an item from the non - active part . by the definition of @xmath1335 and the fact that @xmath1371 is completed , one has that @xmath1556 for all @xmath1064 from the quadratic part of @xmath1019 .",
    "hence , from the description of the process , we conclude that @xmath1557 for all @xmath1558 from the word @xmath1559 and all @xmath1560 from the word @xmath1561 . by definition of a solution of a generalised equation",
    ", it follows that for any solution @xmath1072 of @xmath1069 , we have that @xmath1562 . by the induction hypothesis ih2 on @xmath1009 , for all @xmath686 from the word @xmath1563 and all @xmath1564 from the word @xmath1565",
    ", we have that @xmath1566 . by the induction hypothesis ih1 on @xmath236",
    ", it follows that @xmath1567 .",
    "therefore , for any @xmath1568 from the word @xmath1569 and any @xmath729 from the word @xmath1570 , where @xmath1064 belongs to the quadratic part , we have that @xmath1567 and so @xmath1571 for every base @xmath1273 from the quadratic part .",
    "thus , @xmath1572 . we conclude that @xmath1573)=1 $ ] .",
    "this shows that @xmath852 is a homomorphism .",
    "[ lem : qdiagcom ] the homomorphism @xmath1574 makes diagram ( [ diag : period ] ) commutative .",
    "notice that any solution of the fundamental sequence is the composition of an automorphism associated to the vertex @xmath1066 , the epimorphism @xmath1004 and a solution of @xmath1069 .",
    "since by ( * ? ? ?",
    "* lemma 7.12 ) , all the automorphisms fix the subgroup @xmath1575 of @xmath845 generated by the items covered by quadratic - coefficient bases and the non - active items , it follows that the restriction of any solution @xmath1448 of the fundamental sequence to this subgroup coincides with a solution @xmath1072 on the subgroup @xmath1576 of @xmath846 , i.e. for all items @xmath1577 we have that @xmath1578 . by induction hypothesis",
    ", there exists a homomorphism @xmath1579 from @xmath999 that makes diagram ( [ diag : period ] ) commutative .",
    "we define @xmath1580 on the subgroup @xmath999 of @xmath851 to be @xmath1579 and set @xmath1581 , where @xmath1582 .",
    "it suffices to show that @xmath1580 is a homomorphism . in this case",
    ", the commutativity of the diagram follows by construction .",
    "let us show that @xmath1583)=1 $ ] . from the definition of @xmath134 and the induction hypothesis on the tower @xmath1584 , we have that @xmath1585",
    "since every solution @xmath1448 from the fundamental sequence is obtained from a solution @xmath1072 from the fundamental sequence by precomposing it with a canonical automorphism ( and @xmath1004 ) , we conclude that @xmath1449 for all solutions @xmath1448 of the fundamental sequence if and only if @xmath1450 for all @xmath1072 from the fundamental sequence , where @xmath1451 .",
    "it follows that @xmath1586 by induction hypothesis , @xmath1587 and hence @xmath1588=1 $ ] .",
    "finally , direct computation shows that @xmath1589 .",
    "this proves that @xmath1580 is a homomorphism .",
    "[ lem : qh0ind ] the group @xmath1539 satisfies the induction hypothesis ih1 : for every @xmath1590 , we have that @xmath1591 if and only if @xmath1592 for all homomorphisms @xmath1580 induced by a solution @xmath1448 from the fundamental sequence .",
    "furthermore , we have that if @xmath1593 , then @xmath1594 belong to a cyclic subgroup for all homomorphisms @xmath1580 induced by a solution @xmath1448 from the fundamental sequence .    if @xmath1595 , then the statement follows by the induction hypothesis ih1 for @xmath236 .    by definition @xmath1596 , for all @xmath1597 .",
    "let us show that @xmath1598 .",
    "notice that by definition , @xmath1599 , where @xmath1582 .",
    "since all the bases from @xmath1434 belong to the same tribe , it follows that @xmath1600 .    by definition @xmath1601 , for all @xmath1602 , @xmath1545 . from the definition of @xmath134 and the induction hypothesis ih1 for the graph tower @xmath1584",
    ", we have that @xmath1603 .",
    "as we have already seen in lemma [ lem : qdiagcom ] , we have that @xmath1449 for all solutions @xmath1448 of the fundamental sequence if and only if @xmath1450 for all solutions @xmath1072 from the fundamental sequence , where @xmath1451 .",
    "assume that for @xmath1604 we have that @xmath1605 for some @xmath1545 .",
    "since by definition @xmath1581 and all the quadratic bases belong to the same minimal tribe , it follows that @xmath1605 for all @xmath1545 .",
    "since the sets @xmath1606 and @xmath1607 define the same minimal tribe , we conclude that @xmath1608 for all @xmath1545 . by the induction hypothesis ih1 on @xmath236",
    ", it follows that @xmath1609",
    ". therefore , @xmath1610 .",
    "finally , since all the edges @xmath1611 from @xmath1612 belong to @xmath1613 , by induction on @xmath236 and definition of @xmath1580 , we conclude that for every solution @xmath1448 from the fundamental sequence , @xmath1614 and @xmath1615 belong to the same cyclic subgroup .",
    "[ lem : qtau0ind ] the homomorphism @xmath852 satisfies the induction hypothesis ih2 : for all @xmath1064 , if @xmath1616 , then for a fundamental sequence of solutions we have that @xmath1617 and @xmath1618 .",
    "if the item @xmath1064 is covered by a quadratic - coefficient base or it is non - active , then @xmath1619 . by construction ,",
    "the epimorphism @xmath1004 satisfies the statement of the lemma , and by induction hypothesis so does @xmath1009 .",
    "it follows that the statement of the lemma holds for @xmath1620 .",
    "we are left to consider the case when @xmath1064 belongs to a quadratic base and is not covered by a quadratic - coefficient base . in this case , @xmath1064 is covered by two long bases and , hence belongs to a minimal tribe .",
    "then , by definition , @xmath1621 . if @xmath1622 where @xmath166 is the set of items covered by quadratic - coefficient bases , then @xmath1623 .",
    "since @xmath1624 and all the bases and items of the quadratic part belong to tribes that dominate the minimal tribe , it follows that @xmath1617 .",
    "furthermore , since the item @xmath1064 belongs to a quadratic base , it follows that @xmath1625 for some @xmath1626 and some @xmath1545 . since @xmath1544 belongs to the minimal tribe , we have that @xmath1618 .",
    "let us now deal with the exceptional cases .",
    "assume that @xmath17 corresponds to a torus , i.e. @xmath1627=1 $ ] .",
    "define the graph @xmath767 as follows . if @xmath756 is non - abelian , set :    * @xmath1628 , * @xmath1629 and * @xmath1630 .    if @xmath756 is abelian , then set :    * @xmath1628 , * @xmath1631 , and * @xmath1630 .",
    "if @xmath1538 , then we set @xmath851 to be the quotient of @xmath1539 by the set of relations @xmath1540 and the set of basic relations @xmath87 : @xmath1632 = 1 , \\ i=1,2.\\ ] ]    the map @xmath1633 , @xmath1463 extends via the isomorphism @xmath48 ( see lemma [ lem : isoquad ] ) to a homomorphism @xmath852 from @xmath845 to @xmath851 that makes diagram ( [ diag : period ] ) commutative . furthermore , @xmath851 , @xmath1539 and @xmath852 satisfy the induction hypothesis ih , ih1 and ih2 .",
    "proof is analogous to the proofs of lemmas [ lem : qhom ] , [ lem : qdiagcom ] , [ lem : qh0ind ] , [ lem : qtau0ind ] .",
    "notice that other quadratic equations of rank one do not define an infinite family of homomorphisms .",
    "indeed , by remark [ rem : recall ] , any solution of a generalised equation is induced by a solution of the corresponding generalised equation over the free group .",
    "now the claim follows from the description of the radical ideal for quadratic equations in the free group , see @xcite .",
    "finally , let us consider the remaining cases .",
    "notice that if the image of the surface under the retraction is commutative , then the minimal solution is atom - commutative .",
    "hence , without loss of generality , we assume that the minimal solution is atom - commutative .    define the graph @xmath767 as follows . if @xmath756 is non - abelian , set :    * @xmath1634 ; * @xmath1635 and * @xmath1532 .",
    "if @xmath756 is abelian , then set    * @xmath1530 ; * @xmath1636 ; * @xmath1532 .",
    "if @xmath1538 , then we set @xmath851 to be the quotient of @xmath1539 by the set of relations @xmath1540 and the set of relations @xmath87 defined as follows :    * if one of the elements @xmath1637 , @xmath1638 is non - trivial , then the set of relations @xmath87 is defined as follows : @xmath1639= 1 , i=1,\\dots , n\\},\\ ] ] where @xmath1640 * otherwise , @xmath1641 .    in these cases , define the map @xmath1536 as follows : @xmath1642    the map @xmath1536 extends via the isomorphism @xmath48 ( see lemma [ lem : isoquad ] ) to a homomorphism @xmath852 from @xmath845 to @xmath851 that makes diagram ( [ diag : period ] ) commutative .",
    "furthermore , @xmath851 , @xmath1539 and @xmath852 satisfy the induction hypothesis ih , ih1 and ih2 .    by corollary [ cor : quadnf ] ,",
    "the group @xmath845 is isomorphic to the group @xmath1420 .",
    "we show that @xmath1536 induces a homomorphism from @xmath1420 to @xmath851 .",
    "it is immediate to check that @xmath1547 if @xmath486 is either the relation @xmath17 , a relation of the type @xmath1546 or a relation from @xmath1314 .",
    "therefore , we are left to show that @xmath1536 is trivial on the set of commutators @xmath1335 , see equation ( [ eq : cak ] ) .",
    "the proof is analogous to the proof of lemma [ lem : qhom ] .",
    "let us now show that diagram ( [ diag : period ] ) is commutative .",
    "any solution of the fundamental sequence is the composition of an automorphism associated to the vertex , the epimorphism @xmath1004 and a solution of @xmath1069 from the fundamental sequence . since by ( * ? ? ?",
    "* lemma 7.12 ) all the automorphisms fix the subgroup @xmath1575 of @xmath1426 generated by the items covered by quadratic - coefficient bases and the non - active items , it follows that the restriction of any solution @xmath1448 of the fundamental sequence onto this subgroup coincides with a solution @xmath1072 on the subgroup @xmath1576 of @xmath846 , i.e. for all items @xmath1577 we have that @xmath1643 . by induction hypothesis",
    ", there exists a homomorphism @xmath1579 from @xmath999 that makes diagram ( [ diag : period ] ) commutative .",
    "we define @xmath1580 on the subgroup @xmath999 of @xmath851 to be @xmath1579 and we define @xmath1644 , if @xmath1645 and @xmath1646 , and @xmath1647 , if @xmath1645 and @xmath1648 .",
    "it suffices to show that @xmath1580 is a homomorphism . in this case , the commutation of diagram ( [ diag : period ] ) follows by construction . since",
    ", by assumption , the minimal solution @xmath1649 is atom - commutative and since any solution of the fundamental sequence is obtained from the minimal solution by precomposing it with an automorphism , it follows that any solution of the fundamental sequence is also atom - commutative .",
    "furthermore , notice that by remark [ rem : blocks ] , the image of any item under the homomorphism @xmath1448 is a block element such that @xmath1650 , for all @xmath1545 . by lemma [ lem : eired ] , there exists an element @xmath289 so that @xmath1651 is irreducible . hence",
    ", the images of all the atoms under @xmath1448 belong to the same cyclic subgroup : @xmath1652 we conclude that @xmath1653)=1 $ ] .",
    "therefore , diagram ( [ diag : period ] ) is commutative .    the proofs that the induction hypothesis ih1 and ih2 hold , are analogous to the proofs of lemmas [ lem : qh0ind ] and [ lem : qtau0ind ] , correspondingly .",
    "notice that since @xmath1654 is cyclically reduced , the argument given above shows that if the equation is non - orientable ( there is an atom @xmath1655 ) , then @xmath1656 is cyclically reduced .",
    "hence , we conclude that in this case , the retraction of the surface is in fact abelian .",
    "we summarize the results of this section in the proposition below .",
    "[ prop : quad ] let @xmath830 be a generalised equation of type @xmath1005 that repeats infinitely many times in the infinite branch , let @xmath1239 be minimal and @xmath945 be completed .",
    "then , there exists a graph tower @xmath1657 and a homomorphism @xmath1658 from @xmath843 to @xmath19 such that for all solutions of the fundamental sequence , there exists a homomorphism from @xmath19 to @xmath18 that makes diagram ( [ diag : period ] ) commutative .      in this and the following sections we use the notation and results from ( * ? ? ?",
    "* chapter 6 ) , of which we now give a very brief and informal summary .",
    "informally , a periodic structure @xmath1659 is a set of items , bases and sections of a generalised equation @xmath50 that imposes restrictions on the set of solutions of @xmath50 , namely that solutions are @xmath1660-periodic and the image of items , bases and section from the periodic structure are `` long '' ( they are subwords of @xmath1661 of length greater than @xmath1662 ) .    given a periodic structure on @xmath50 , we study the corresponding coordinate group by introducing a new set of generators and exhibiting the corresponding presentation . in order to define the new set of generators , one constructs a graph @xmath1663 , whose edges are labelled by items that belong to a section of the periodic structure . without loss of generality , one can assume that @xmath64 is connected .",
    "one then chooses a maximal subforest of @xmath64 so that the edges are labelled by items that belong to a section from @xmath1664 , but the items themselves do not belong to @xmath1664 .",
    "we then complete the forest to a maximal subtree @xmath1665 of @xmath64 .",
    "the free group generated by the items that label edges of @xmath64 is generated by the items that label edges of @xmath1665 and cycles @xmath1666 , where @xmath1667 .    under the assumption",
    "that @xmath50 is periodised with respect to @xmath1664 ( i.e. words defined by cycles of @xmath64 based at a given point commute ) , one can choose a basis @xmath1668 of the subgroup generated by the cycles @xmath1666 .",
    "for each edge @xmath1669 labelled by an item that belongs to @xmath1664 , we consider two families of cycles @xmath1670 , @xmath1671 defined by edges @xmath1672 labelled by items that do not belong to @xmath1664 .",
    "the cycles @xmath1670 , @xmath1671 are based at the origin and the terminus of @xmath393 , correspondingly .",
    "we prove that the set    * @xmath1673 of items that do not belong to sections from @xmath1664 ; * @xmath1674 ; * @xmath1675 ; * @xmath1676 ; * @xmath1677 ;    is a generating set of the group @xmath843 and in this generating set , the system of equations @xmath821 is equivalent to the union of the following two systems of equations : @xmath1678=1,&\\hbox{where } e_j\\in t , \\,e_j\\in \\operatorname{sh } , \\",
    ", j=1,2 ; 1\\leq i\\leq m \\\\",
    "\\left[h({\\mathfrak{c}}_1),h({\\mathfrak{c}}_2)\\right]=1 , & \\hbox{where } { \\mathfrak{c}}_1,{\\mathfrak{c}}_2\\in c^{(1)}\\cup c^{(2 ) }                  \\end{array }                  \\right.\\ ] ] and a system : @xmath1679 such that neither @xmath1680 , @xmath1681 , nor @xmath1682 occurs in @xmath1683 .",
    "[ defn : singreg ] let @xmath50 be a generalised equation and let @xmath1684 be a connected periodic structure on @xmath50 .",
    "we say that the generalised equation @xmath50 is _ strongly singular with respect to the periodic structure @xmath1684 _ if one of the following conditions holds .    *",
    "the generalised equation @xmath50 is not periodised with respect to the periodic structure @xmath1684 . *",
    "the generalised equation @xmath50 is periodised with respect to the periodic structure @xmath1684 and there exists an automorphism @xmath1685 of the coordinate group @xmath836 of the form described in parts ( * ? ? ?",
    "* lemma 6.14(2 ) and ( 3 ) ) , such that @xmath1685 does not induce an automorphism of @xmath838 .",
    "we say that the generalised equation @xmath50 is _ singular with respect to the periodic structure @xmath1684 _ if @xmath50 is not strongly singular with respect to the periodic structure @xmath1684 and one of the following conditions holds    * the set @xmath1686 has more than one element .",
    "* the set @xmath1686 has exactly one element , and ( in the above notation ) there exists a cycle @xmath1687 , @xmath1688 such that @xmath1689 in @xmath838 .",
    "otherwise , we say that @xmath50 is _ regular with respect to the periodic structure @xmath1684_. in particular , if @xmath50 is singular or regular with respect to the periodic structure @xmath1684 , then @xmath50 is periodised .",
    "when no confusion arises , instead of saying that @xmath50 is ( strongly ) singular ( or regular ) with respect to the periodic structure @xmath1684 , we say that the periodic structure @xmath1684 is ( _ strongly_)_singular _ ( or _ regular _ ) .",
    "suppose that the fundamental sequence goes through a vertex @xmath1066 of type @xmath28 , i.e. solutions of the discriminating family are @xmath1660-periodic and @xmath1690 is either singular or strongly singular with respect to the corresponding periodic structure @xmath1691 .    to simplify the notation , set @xmath1692 .",
    "recall that @xmath1693 , @xmath1463 , @xmath1694 , and @xmath1695 .",
    "if the periodic structure @xmath1691 is strongly singular , then we set @xmath1006 and @xmath852 to be @xmath1008 , where @xmath1009 is the homomorphism from @xmath846 to @xmath999 that makes diagram ( [ diag : period ] ) commutative . by (",
    "* lemma 6.17 ) , any homomorphism of the fundamental sequence factors through @xmath1000 and so @xmath852 , @xmath851 and @xmath1539 make diagram ( [ diag : period ] ) commutative and satisfy the induction hypothesis .",
    "let us now assume that the periodic structure @xmath1691 is singular .",
    "the set of elements @xmath1696 forms a basis of the free group @xmath1697 generated by @xmath1698    suppose first that the periodic structure is singular of type ( a ) , i.e. the set @xmath1686 has more than one element .",
    "denote by @xmath1433 the composition of @xmath1004 and @xmath1009 .    since the periodic structure is singular of type ( a )",
    ", the cardinality @xmath238 of the set @xmath1686 is greater than or equal to @xmath28 and there exists an element @xmath1699 so that the image @xmath1700 in @xmath1000 is non - trivial . let @xmath1701 be the image of @xmath1702 in @xmath999 , and consider the word @xmath1703 in @xmath236 .",
    "set @xmath134 to be @xmath1704 .",
    "let @xmath1705 , where @xmath1706 .",
    "define the graph @xmath767 as follows .",
    "if the canonical parabolic subgroup @xmath756 is non - abelian , set :    * @xmath1707 ; * @xmath1708 and * @xmath1532 .",
    "if the canonical parabolic subgroup @xmath756 is abelian , set :    * @xmath1707 ; * @xmath1709 and * @xmath1532 .",
    "then , the group @xmath1539 is defined to be @xmath1710 .",
    "let @xmath1711 be the following set of relations : @xmath1712=1 , \\hbox { for all } 1\\le i\\le n\\ ] ] and set @xmath851 to be the quotient @xmath1713 , where @xmath1714 .",
    "recall that , by definition of the generating set @xmath1715 associated to the periodic structure and since the generalised equation is periodised ( the periodic structure being singular ) , the set @xmath1716 is a basis of the free group @xmath1717 .",
    "furthermore , any @xmath1718 such that @xmath1719 , @xmath1672 , @xmath1720 , is expressed in the generating set @xmath1716 as @xmath1721 where @xmath1722    [ lem : singatauhom ] the map @xmath852 , @xmath1723 extends to a homomorphism from @xmath845 to @xmath851 .    by (",
    "* lemma 6.14 ) , the set @xmath1724 is a generating set of @xmath845 .",
    "notice that , by definition , the map @xmath852 on the set @xmath1725 coincides with the homomorphism @xmath1433 .",
    "it follows that @xmath852 extends to a homomorphism on the subgroup @xmath1726 of @xmath845 .    by (",
    "* lemma 6.14 ) , since the generalised equation is periodised , i.e. @xmath1727=1 $ ] for all cycles @xmath1728 , it follows that all the relations @xmath1729 belong to the subgroup generated by @xmath87 and thus @xmath1730 .",
    "therefore , in order to show that the map @xmath852 induces a homomorphism from @xmath1731 to @xmath851 we need to show that @xmath1732)=1 $ ] in @xmath851 for all @xmath1733 .",
    "if @xmath1734 , then @xmath1735)=\\varphi_0([h^{(0)}({\\mathfrak{c}}_1),h^{(0)}({\\mathfrak{c}}_2)])=1.\\ ] ] if @xmath1736 , then , by definition of @xmath767 , @xmath1735)=[x_i^{(0)},x_j^{(0)}]=1.\\ ] ] finally , assume that @xmath1737 and @xmath1738 .",
    "since @xmath1739=1 $ ] in @xmath845 , for all @xmath1737 , and the non - trivial cycle @xmath1699 that defines the subgroup @xmath134 , we have that @xmath1740=1 $ ] in @xmath999 and so @xmath1741 . we conclude from the definition of @xmath315 that @xmath1732)=1 $ ] in @xmath851 .    to prove that @xmath852 extends to a homomorphism from @xmath845 to @xmath851 it is left to show that @xmath1742)=1 $ ] , for all @xmath1743 such that @xmath1744 .",
    "in fact , since the map extends to a homomorphism on the subgroup generated by @xmath87 , we only need to check that @xmath1742)=1 $ ] , for all @xmath1745 so that @xmath1744 . for every @xmath1660-periodic solution @xmath1448",
    ", we have that @xmath1746 , for all @xmath1747 , @xmath1748 . recall that if @xmath1744 , then for all solutions @xmath1448 of @xmath1019 we have that @xmath1749 . therefore ,",
    "if @xmath1744 and @xmath1748 , then @xmath1750 .    furthermore , since the periodic structure is not strongly singular and the set @xmath1371 is completed , it follows that for all @xmath1748 and for every @xmath1064 such that @xmath1744 , one has that @xmath1751 , for all @xmath1752 .    by properties of the elementary transformations , we have that @xmath1753 , for all @xmath1754 from @xmath1559 and all @xmath1755 , @xmath1718 . by the induction hypothesis ih2 on @xmath1009 , for any @xmath1756 in @xmath1570 , @xmath1757 in @xmath1758 and any solution @xmath1072 of @xmath1069 from the fundamental sequence , we have that @xmath1759 and @xmath1760 , hence @xmath1761 . by the induction hypothesis ih1 on @xmath236",
    ", we have that @xmath1762 and so @xmath1763 in @xmath236 , for all @xmath1764 and , hence , in particular , @xmath1570 belongs to the subgroup @xmath134 of @xmath236 .",
    "therefore , if @xmath1744 and @xmath1745 , then @xmath1742)=1 $ ] .",
    "[ lem : singadiagcom ] the homomorphism @xmath1574 makes diagram ( [ diag : period ] ) commutative .    by (",
    "* lemma 6.18 ) , for any solution @xmath1448 of the fundamental sequence , there exist a solution @xmath1072 of @xmath1069 and an automorphism @xmath547 from the group @xmath1765 ( see ( * ? ? ?",
    "* definition 6.16 ) ) such that @xmath1766 .",
    "furthermore , if @xmath1725 then , we have that @xmath1643 , where @xmath1767 . by the induction hypothesis , there exists a homomorphism @xmath1579 from @xmath999 to @xmath18 that makes diagram ( [ diag : period ] ) commutative .",
    "we define @xmath1580 on the subgroup @xmath999 of @xmath851 to be @xmath1579 and we define @xmath1768 , where @xmath1769 is so that @xmath1770 .    if we show that @xmath1580 is a homomorphism , then the commutativity of diagram follows by construction . since solutions of the fundamental sequence",
    "are @xmath1660-periodic , it follows that @xmath1771 and @xmath1772 , @xmath1773 . therefore , @xmath1580 is a homomorphism and makes diagram ( [ diag : period ] ) commutative .",
    "[ lem : singakcool ] the subgroup @xmath1774 of @xmath236 is @xmath1438-co - irreducible .",
    "by remark [ rem : discfam ] , there exists a canonical parabolic subgroup @xmath1439 such that for a fundamental sequence of solutions we have that @xmath1775 . by definition of @xmath134 and by the induction hypothesis ih1",
    ", we have that @xmath1776 . furthermore , if @xmath1777 , where @xmath1778 , @xmath1444 , again , by the induction hypothesis ih1 , we have that @xmath1445 and so @xmath1446 , hence we have that @xmath1779 .",
    "let us now address the statement of the lemma . by definition",
    "the group @xmath134 is closed , i.e. @xmath1458 .",
    "we only need to show that @xmath756 is @xmath1438-directly indecomposable .",
    "assume the contrary , then @xmath1459 , where @xmath1460 ( with respect to the edges from @xmath1438 ) .",
    "without loss of generality , we may assume that @xmath1461 . by remark [ rem : discfam ]",
    ", there exist canonical parabolic subgroups @xmath1462 , @xmath1463 such that for solutions @xmath1448 from the fundamental sequence we have @xmath1464 , @xmath1463 .",
    "furthermore , by the induction hypothesis ih1 , one has that @xmath1465 .    since @xmath1779",
    ", it follows that @xmath1780 .",
    "furthermore , it follows that @xmath1781 contains at least one @xmath1782-alternation .",
    "since every solution of the fundamental sequence is @xmath1660-periodic , it follows that @xmath1783 and @xmath1660 contains at least one @xmath1470-alternation . by the description of solutions of generalised equations periodised with respect to a periodic structure ,",
    "see ( * ? ? ?",
    "* chapter 6 ) , for every @xmath1784 , there exists a solution @xmath1448 of @xmath1019 so that @xmath1785 , where @xmath1786 , @xmath1738 . hence , @xmath1787 contains at least @xmath1788 many @xmath1470-alternations .",
    "this derives a contradiction , since , by remark [ rem : recall ] , @xmath1787 is a subword of a word in the normal form and , by lemma [ lem : pc ] , it contains only a bounded number of alternations .",
    "hence , we conclude that @xmath1660 is a cyclically reduced irreducible root element and so @xmath1789 and @xmath756 is @xmath1438-directly indecomposable .",
    "[ rem : blockperiod ] solutions of generalised equations define graphical equalities , so , if solutions of the fundamental sequence are @xmath1660-periodic , then the period @xmath1660 is cyclically reduced .",
    "furthermore , as we have shown above , the period @xmath1660 is an irreducible root element from @xmath1790 .",
    "[ lem : qh0ind1 ] the group @xmath1539 satisfies the induction hypothesis ih1 : for every @xmath1590 , we have that @xmath1591 if and only if @xmath992 for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence ; furthermore , we have that if @xmath1593 , then @xmath993 and @xmath994 belong to the same cyclic subgroup for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence .",
    "if @xmath1595 , then the statement follows by the induction hypothesis on @xmath236 .    by definition ,",
    "@xmath1791 for all @xmath1792 .",
    "let us show that @xmath1793 and @xmath1794 belong to the same cyclic subgroup .",
    "indeed , since solutions of the fundamental sequence are @xmath1660-periodic , it follows that @xmath1795 for all @xmath1545 .    furthermore , if @xmath756 is abelian , then @xmath1796 for all @xmath1797 . by the induction hypothesis ih1 , for all solutions the subgroup @xmath1798 is a cyclic subgroup of @xmath18 .",
    "since , by remark [ rem : blockperiod ] , the period @xmath1660 is an irreducible element from @xmath1799 , it follows that @xmath1795 and @xmath1800 belong to the same cyclic subgroup .    by definition @xmath1601 , for all @xmath1602 , @xmath1545 . from the definition of @xmath134 and the induction hypothesis on the tower @xmath1584",
    ", we have that @xmath1801 .",
    "since solutions are @xmath1660-periodic , it follows that @xmath1802 where @xmath1803 , @xmath1804 .",
    "assume that for @xmath1604 we have that @xmath1605 for some @xmath1545 .",
    "since @xmath1805 , it follows that @xmath1806 by the induction hypothesis ih1 on @xmath236 , it follows that @xmath1807",
    ". therefore , @xmath1610 .",
    "[ lem : singatau0ind ] the homomorphism @xmath852 satisfies the induction hypothesis ih2 : for all @xmath1064 , if @xmath1808 , then for a fundamental sequence of solutions we have that @xmath1809 and @xmath1810 .    recall that if @xmath1725 then , for @xmath1767 and for all solutions of the fundamental sequence @xmath1448 we have that @xmath1643 .",
    "if @xmath1767 , then @xmath1619 . if @xmath1811 , then since solutions of the generalised equations define graphical equalities it follows that for every solution @xmath1072 of the fundamental sequence , we have that @xmath1812 and so @xmath1813 since , by induction assumption , the statement of the lemma holds for @xmath1009 , we conclude that the statement holds for @xmath1619 , for all @xmath1767 .",
    "if @xmath1814 , then @xmath1815 and @xmath1816 for some @xmath1817 in this case , @xmath1818 since every solution @xmath1448 of the fundamental sequence is @xmath1660-periodic , it follows that @xmath1819 , for all @xmath1820 .",
    "hence , for all @xmath729 in the words @xmath1821 and @xmath1822 , by the induction hypothesis ih2 on @xmath1009 , we can conclude that @xmath1823 .",
    "furthermore , @xmath1824 and so @xmath1825 and , in particular , @xmath1826    assume now that the periodic structure is singular of type ( b ) , i.e. the set @xmath1686 has exactly one element and there exists a cycle @xmath1827 , @xmath1828 such that @xmath1829 in @xmath845 .",
    "since @xmath1830 , for all solutions @xmath1080 of @xmath1019 we have that @xmath1831 .",
    "since @xmath1426 is separated by @xmath18 , there exists @xmath1448 so that @xmath1832 , hence @xmath1833 in @xmath1000 .",
    "let @xmath1834 be the image of @xmath1835 in @xmath999 , and consider the word @xmath1703 in @xmath236 .",
    "set @xmath134 to be @xmath1704 .",
    "define the graph @xmath767 as follows .",
    "if the canonical parabolic subgroup @xmath756 is non - abelian , set :    * @xmath1836 ; * @xmath1531 and * @xmath1837 .",
    "if the canonical parabolic subgroup @xmath756 is abelian , set :    * @xmath1836 ; * @xmath1838 and * @xmath1837 .    now , the group @xmath1539 is defined to be @xmath1710 .",
    "let @xmath1711 be the following set of relations : @xmath1839=1,\\ ] ] and set @xmath851 to be the quotient @xmath1840 , where @xmath1841 .",
    "recall that , by definition of the generating set @xmath1715 and since the generalised equation is periodised ( the periodic structure being singular ) , the set @xmath1716 is a basis of the free group on the alphabet @xmath1842 .",
    "furthermore , any @xmath1718 so that @xmath1719 , @xmath1672 , @xmath1720 , is expressed in the generating set @xmath1716 as @xmath1721 for some @xmath1843 and some @xmath1844 .",
    "[ lem : singbtauhom ] the map @xmath852 , @xmath1723 extends to a homomorphism from @xmath845 to @xmath851 .",
    "proof is analogous to the proof of lemma [ lem : singatauhom ]    [ lem : singbdiagcom ] the homomorphism @xmath1574 makes diagram ( [ diag : period ] ) commutative .",
    "proof is analogous to the proof of lemma [ lem : singadiagcom ]    [ lem : singbkcool ] the subgroup @xmath1774 of @xmath1539 is @xmath1845-co - irreducible .",
    "proof is analogous to the proof of lemma [ lem : singakcool ]    [ lem : singbh0ind ] the group @xmath1539 satisfies the induction hypothesis ih1 : for all @xmath1590 , we have that @xmath1591 if and only if @xmath992 for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence .",
    "furthermore , we have that if @xmath1593 , then @xmath993 and @xmath994 belong to a cyclic subgroup for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence .",
    "proof is analogous to the proof of lemma [ lem : qh0ind1 ]    [ lem : singbtau0ind ] the homomorphism @xmath852 satisfies the induction hypothesis ih2 : for all @xmath1064 , if @xmath1808 , then for a fundamental sequence of solutions we have that @xmath1846 and @xmath1847 .",
    "proof is analogous to the proof of lemma [ lem : singatau0ind ]    we summarise the results of this section in the following    [ prop : sing ] let @xmath1848 be a generalised equation singular or strongly singular with respect to a periodic structure and let @xmath945 be completed .",
    "then , there exists a graph tower @xmath1657 and a homomorphism @xmath1658 from @xmath843 to @xmath19 such that for all solutions of the fundamental sequence , there exists a homomorphism from @xmath19 to @xmath18 that makes diagram ( [ diag : period ] ) commutative .      by (",
    "* lemma 6.19 ) , given a generalised equation @xmath830 with no boundary connections , periodised with respect to a connected regular periodic structure @xmath1849 and any periodic solution @xmath26 of @xmath50 such that @xmath1850 and so that @xmath26 is minimal with respect to the trivial group of automorphisms , either for all @xmath25 , @xmath1851 we have @xmath1852 , or there exists a cycle @xmath1853 so that @xmath1854 , where @xmath1855 .",
    "suppose first that the fundamental sequence falls under the conditions of the first assumption , i.e. all the items from the periodic structure are of bounded length .",
    "then , in a bounded number of steps @xmath491 , all the items , bases and sections from the periodic structure will be transferred onto the sections that do not belong to the periodic structure .",
    "let @xmath1856 be the corresponding generalised equation .",
    "then , every solution of the fundamental sequence is a solution of @xmath1856 . in this case",
    ", the graph tower for @xmath50 , is the graph tower associated to @xmath1856 .",
    "suppose now that the fundamental sequence falls under the conditions of the second assumption .",
    "then , there exists a cycle @xmath1853 so that @xmath1854 , where @xmath1855 .",
    "let @xmath1857 be the image of @xmath1858 in @xmath999 , @xmath1859 and consider the word @xmath1703 in @xmath236 .",
    "set @xmath134 to be @xmath1704 .",
    "let @xmath1860 .",
    "define the graph @xmath767 as follows .",
    "if the canonical parabolic subgroup @xmath756 is non - abelian , set :    * @xmath1861 ; * @xmath1862 and * @xmath1863 .",
    "if the canonical parabolic subgroup @xmath756 is abelian , set :    * @xmath1861 ; * @xmath1864 and * @xmath1863 .",
    "then , the group @xmath1539 is defined to be @xmath1710 .",
    "let @xmath1711 be the set of relations defined as follows .",
    "for every equation @xmath1865 ( we use notation from ( * ? ? ? * chapter 6 ) ) , we write @xmath1866=1,\\ i=1 , \\dots , { \\mathfrak{m}}\\ ] ] and set @xmath851 to be the quotient @xmath1713 , where @xmath1841 .    recall that , by definition of the generating set @xmath1715 associated to the periodic structure and since the generalised equation is periodised , any @xmath1718 such that @xmath1719 , @xmath1672 , @xmath1720 is expressed in the generating set @xmath1716 as @xmath1867 for some @xmath1843 and some @xmath1844 .",
    "furthermore , the paths @xmath1868 and @xmath1869 can be represented as @xmath1870 and @xmath1871 , correspondingly , where @xmath1872 are paths in @xmath1873 , @xmath1874 , @xmath1875 and @xmath1876 , @xmath1877 , @xmath1878 .",
    "the map @xmath1536 @xmath1879 induces a map @xmath852 from the set @xmath1880 which extends to a homomorphism from @xmath845 to @xmath851 .    by (",
    "* lemma 6.14 ) , the set @xmath1881 is a generating set of @xmath845 .",
    "notice that the map @xmath852 on the set @xmath1882 coincides with the composition of the epimorphism @xmath1004 and the homomorphism @xmath1009 , and so it extends to a homomorphism on the subgroup @xmath1883 of @xmath845 .",
    "in particular , the map @xmath852 coincides with @xmath1433 on the subgroup generated by all the items @xmath1884 .    by (",
    "* lemma 6.14 ) , since @xmath1019 is periodised , i.e. @xmath1727=1 $ ] for all cycles @xmath1728 , it follows that all the words @xmath1729 belong to the subgroup generated by @xmath87 and so @xmath1885 we note that the words @xmath1727 $ ] are trivial elements in the subgroup generated by @xmath87 for all cycles @xmath1728 .",
    "therefore , in order to show that the map @xmath852 extends to a homomorphism from @xmath1731 to @xmath851 it suffices to show that @xmath1886 in @xmath851 , @xmath1887 .",
    "indeed , @xmath1888 since from the definition of @xmath315 , @xmath1889=1 $ ] , it follows that @xmath1890    to prove that @xmath852 extends to a homomorphism from @xmath845 to @xmath851 , it is left to show that @xmath1742)=1 $ ] , for all @xmath1743 such that @xmath1744 .",
    "in fact , since the map extends to a homomorphism on the subgroup generated by @xmath87 we only need to check that @xmath1742)=1 $ ] , for all @xmath1745 so that @xmath1744 . for every @xmath1660-periodic solution @xmath1448",
    ", we have that @xmath1746 , for all @xmath1747 , @xmath1748 . recall that if @xmath1744 , then we have that @xmath1749 for all solutions @xmath1448 of @xmath1019 . therefore , if @xmath1744 and @xmath1748 , then @xmath1750 .",
    "furthermore , since the periodic structure is not strongly singular and the set @xmath1371 is completed , it follows that for all @xmath1748 and for every @xmath1064 such that @xmath1744 , one has that @xmath1751 , for all @xmath1891 .    by properties of the elementary transformations , we have that @xmath1753 , for all the items @xmath1754 which appear in the word @xmath1559 and all items @xmath1892 from the word @xmath1893 , @xmath1718 . by the induction hypothesis ih2 on @xmath1009 , for any @xmath1756 which appears in the word @xmath1570 , any @xmath1757 from the word @xmath1758 and any solution @xmath1072 of @xmath1069 from the fundamental sequence , we have that @xmath1759 and @xmath1760 , hence @xmath1761 . by the induction hypothesis ih1 on @xmath236",
    ", we have that @xmath1762 and so @xmath1763 in @xmath236 , for all @xmath1764 and , hence , in particular , @xmath1570 belongs to the subgroup @xmath134 of @xmath236 .",
    "therefore , if @xmath1744 and @xmath1745 , then @xmath1742)=1 $ ] .",
    "[ lem : regdiagcom ] the homomorphism @xmath1574 makes diagram ( [ diag : period ] ) commutative .",
    "proof is analogous to the one of lemma [ lem : singadiagcom ] .",
    "[ lem : regkcool ] the subgroup @xmath1774 of @xmath236 is @xmath1845-co - irreducible .",
    "proof is analogous to the one of lemma [ lem : singakcool ]    [ lem : regh0ind ] the group @xmath1539 satisfies the induction hypothesis ih1 : for every @xmath1590 , we have that @xmath1591 if and only if @xmath992 for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence . furthermore ,",
    "if @xmath1593 , then @xmath1894 belong to a cyclic subgroup for all homomorphisms @xmath854 induced by solutions @xmath26 from the fundamental sequence .",
    "proof is analogous to the one of lemma [ lem : qh0ind1 ]    [ lem : regtau0ind ] the homomorphism @xmath852 satisfies the induction hypothesis ih2 : for all @xmath1064 , if @xmath1808 , then for a fundamental sequence of solutions we have that @xmath1846 and @xmath1847 .",
    "proof is analogous to the one of lemma [ lem : singatau0ind ]    we summarize the results of this section in the following    [ prop : reg ] let @xmath1848 be a generalised equation regular with respect to a periodic structure and let @xmath945 be completed .",
    "then , there exists a graph tower @xmath1657 and a homomorphism @xmath1658 from @xmath843 to @xmath19 such that for all solutions of the fundamental sequence , there exists a homomorphism from @xmath19 to @xmath18 that makes diagram ( [ diag : period ] ) commutative .",
    "suppose that the infinite branch is of type 15 .",
    "let @xmath1895 be the branch of the tree @xmath1896 such that all the epimorphisms @xmath1897 are isomorphisms , @xmath1898 and @xmath1899 is a proper epimorphism .",
    "it follows by construction of the tree @xmath1002 , see @xcite , that one can subdivide the branch @xmath1895 as follows .",
    "choose @xmath1900 so that    * the quadratic part of @xmath1901 is non - trivial for all @xmath1902 and @xmath1903 has trivial quadratic part , i.e. in the process the quadratic part of @xmath1019 is transferred to the non - quadratic part of @xmath1903 and the generalised equation @xmath1903 is the first one in the branch with trivial quadratic part ; * every solution @xmath26 of the fundamental sequence is @xmath1904-periodic in the section @xmath1905 $ ] of the generalised equation @xmath1906 and @xmath1906 is periodised with respect to a regular periodic structure @xmath1907 .",
    "furthermore , the section @xmath1905 $ ] is transferred in the process from @xmath1906 to @xmath1908 , @xmath1909 .",
    "we now use induction on @xmath1910 to show that there exists a graph tower @xmath851 and homomorphisms making diagram ( [ diag : period ] ) commutative for all solutions of a fundamental sequence .",
    "suppose first that @xmath1911 .",
    "then , the existence of the graph tower @xmath851 for @xmath845 and the required homomorphisms follows by proposition [ prop : quad ] .",
    "assume now that @xmath1912 . by construction",
    ", declaring the section @xmath1913 $ ] to be the active section of @xmath1914 , the generalised equation @xmath1914 is periodised with respect to a regular periodic structure @xmath1915 . hence , by proposition [ prop : reg ] , there exists a graph tower @xmath1916 for @xmath1914 that satisfies the required properties .",
    "this proves the base of induction .",
    "assume by induction that there exists a graph tower @xmath1917 for @xmath1918 .",
    "then , again using proposition [ prop : reg ] , we conclude that there exists a graph tower @xmath999 and the required homomorphisms for @xmath1919 .",
    "finally , since there exists a tower @xmath999 for @xmath1919 , by proposition [ prop : quad ] , there exists a graph tower @xmath851 satisfying the required properties for the group @xmath1920 .",
    "we arrive at the following    [ prop : case15 ] let @xmath1848 be a generalised equation of the infinite branch of type @xmath1921 and let @xmath945 be completed .",
    "then , there exist a graph tower @xmath1657 and a homomorphism @xmath1658 from @xmath843 to @xmath19 such that for all solutions of the fundamental sequence , there exists a homomorphism from @xmath19 to @xmath18 that makes diagram ( [ diag : period ] ) commutative .",
    "suppose that the infinite branch is of the type 7 - 10 .",
    "then , by ( * ? ? ?",
    "* lemma 7.10 ) , there exists a generalised equation that repeats in the branch infinitely many times . without loss of generality",
    ", we may assume that @xmath50 is the generalised equation that repeats infinitely many times .    in the case of free groups ,",
    "if an item is covered only once , one can delete the item together with the base that covers it and its dual . on the level of groups",
    ", this corresponds to a tietze transformation : deletion of a generator and a relation in which this generator occurs only once .",
    "repeating this operation , one eliminates all the `` eliminable '' bases and obtains the , so called , kernel @xmath1922 of the corresponding generalised equation @xmath50 , see @xcite .",
    "one can then show that @xmath1923 , see @xcite .    in our case",
    ", if an item is covered only once and one deletes the item along with the base that covers it and its dual , then one looses the `` partially commutative structure '' in the following sense .",
    "the item @xmath822 which has been deleted together with a relation @xmath1924 , has commutation constraints associated to it , hence @xmath822 appears in the commutation relations .",
    "therefore , the presentation we obtain after deleting the generator @xmath822 and the relation @xmath1925 , contains relations of the form @xmath1926 $ ] ( note that , originally , all the commutation relations are commutation of the generators , hence , the term `` partially commutative structure '' ) , see ( * ? ? ?",
    "* section 4.3 ) for further discussion .",
    "it follows that , one can not use these tietze transformations to exhibit the splitting .    by analogy with the quadratic case",
    ", one could try to study the dynamics of the infinite branch and try to gain control on the constraints and ( at best ) conclude that the relations @xmath1927 $ ] are consequences of the other relations , i.e. that for each @xmath925 that appears in @xmath489 , there is a relation @xmath1928 $ ] .",
    "unfortunately , the dynamics of the linear branch is much harder than that of the quadratic case and we did not manage to advance in this direction ( in fact , as we will see from the approach we are about to present , this might not be a sensible option ) .",
    "our approach is to study this case by `` forcing '' it to behave as the cases we know how to deal with : the quadratic case and the general case . in order to carry out this new analysis of the branch ,",
    "we do the contrary of what is done in the free group case : we use tietze transformations to _ introduce _ new ( non - active ) generators and relations .",
    "our goal is to transform the generalised equation to a new one , where every item is covered at least twice and then study the obtained generalised equation as in the quadratic and general cases .    as one might expect , such a naive attempt does not ( directly ) work , as , in general , after some transformations , the generalised equation can fall again into one of the types 7 - 10 .    at this point , tribes again play a crucial role .",
    "we show that one can ensure that every time the generalised equation falls into one of the types 7 - 10 , the minimal tribe of the generalised equation _ strictly _ increases .",
    "since @xmath18 is finitely generated , there exists a constant @xmath1929 that bounds any sequence of strictly dominating tribes .",
    "furthermore , if at some point , the minimal tribe of a generalised equation turns out to be the maximal tribe , then all the items of the generalised equation , in fact , belong to this maximal tribe . in this case , we can proceed as in the free group case and eliminate the item and the corresponding relation , since the commutation relations @xmath1930 $ ] are indeed a consequence of the relations @xmath1931 $ ] for all @xmath840 which occur in @xmath489 .    hence , after introducing fictitious bases to make the generalised equation of type 7 - 10 into a generalised equation where every item is covered at least twice and running the process for the obtained generalised equation , one of the following alternatives occurs :    1 .",
    "the process terminates in finitely many steps ; 2 .",
    "the obtained generalised equation defines an infinite branch of type 12 or 15 , thus we can analyse it ; 3 .",
    "after finitely many steps , the generalised equation is again transformed into a generalised equation of the type 7 - 10 , but the minimal tribe of the latter generalised equation strictly dominates the minimal tribe of the original generalised equation .",
    "we can have case c at most @xmath1929 times .",
    "hence , after finitely many instances of case c , one has one of the cases a , b or the generalised equation is again of type 7 - 10 , but we can perform the tietze transformation , eliminate the item @xmath822 together with the relation @xmath1925 and preserve the `` partially commutative structure '' .",
    "all these alternatives can be analysed and hence the linear case can be tackled .",
    "we now turn our attention to the formal analysis of the linear case .",
    "we define a new generalised equation @xmath1932 constructed from @xmath1848 as follows . for every item @xmath822 which is covered exactly once",
    ", we introduce    * a base @xmath1933 , so that @xmath1934 , @xmath1935 , @xmath1936 , * an item @xmath1937 ( along with the boundary and re - enumerate all the boundaries as appropriate ) in the non - active part of @xmath50 and , * the dual base @xmath1938 of @xmath1303 so that @xmath1939 , @xmath1940 and @xmath1941 .",
    "we set @xmath1942 .",
    "we call the bases @xmath1933 _ auxiliary_. denote the obtained generalised equation by @xmath1943 .    it is obvious that the group @xmath1944 is isomorphic to @xmath843 .",
    "furthermore , @xmath1945 . we apply the process to the generalised equation @xmath1943 and follow the branch of the fundamental sequence ( recall that , by lemma [ lem : discfam ] , there is only one such branch ) .",
    "assume first that one of the auxiliary bases @xmath1303 is a carrier base of the generalised equation @xmath1946 .",
    "in this case , we @xmath913-tie the boundary @xmath1947 in all the bases @xmath913 , @xmath1948 that contains @xmath1947 and close the section @xmath1949 $ ] .    we now apply @xmath1144 to the obtained generalised equation and , using @xmath1303 as the carrier , we transfer all the bases from @xmath1950 to the non - active part . notice that , since the base @xmath1303 is the carrier and the section @xmath1950 is closed , the pair of dual bases @xmath1951 is removed and the number of auxiliary bases in the active part of the obtained generalised equation has decreased .",
    "the non - active section @xmath1952 of @xmath1946 defines a ( non - active ) closed section in @xmath1901 , for all @xmath1953 , that we still denote by @xmath1952 .",
    "it follows from the process that the branch of the tree @xmath1954 is either finite and the leaf is of type 1 ( it is a proper quotient ) or of type 2 ( there are no active sections ) , or the branch is infinite of type 12 or of type 15 .",
    "if the branch of @xmath1954 is finite and the leaf is of type 1 , then any solution of fundamental sequence is a solution of the leaf . by induction hypothesis on the height of proper quotients , we can conclude that there exists a graph tower with the required properties .",
    "assume now that the branch is finite and the leaf @xmath1955 is of type 2 .",
    "let @xmath1956 be the generalised equation obtained from @xmath1955 by declaring one of the sections @xmath1952 active and all the other sections non - active .",
    "suppose first that every active item in @xmath1956 is covered at least twice . in this case , we argue by induction on the number of auxiliary bases and prove the existence of a graph tower for @xmath1956 .",
    "if there are no auxiliary ( active ) bases in @xmath1956 , then , by propositions [ prop : sing ] , [ prop : quad ] and [ prop : case15 ] , there exists a graph tower for @xmath1957 . since the number of auxiliary bases of @xmath1956 is strictly less than the number of auxiliary bases of @xmath1222 ( as the base @xmath1303 is eliminated in @xmath1956 ) , then we conclude by induction that there exists a tower for @xmath1956 .",
    "suppose next that there is an item @xmath840 in @xmath1952 which is covered exactly once , say by the base @xmath1219 .",
    "note that the tribes of all the items in @xmath1952 dominate the tribe @xmath1958 . to simplify the notation we write @xmath1959 .",
    "if @xmath840 belongs to the tribe @xmath1958 , then since the tribes of all the items in @xmath1952 dominate the tribe @xmath1958 , it follows that @xmath1219 ( and so @xmath1044 ) belong to the tribe @xmath1958 .",
    "the base @xmath1219 is eliminable and we eliminate it together with the item @xmath840 as follows .",
    "we have that the variable @xmath840 occurs only once in @xmath821 : in the equation @xmath1960 corresponding to the base @xmath1219 , denote this equation by @xmath1961 .",
    "therefore , in the group @xmath843 the relation @xmath1961 can be written as @xmath1962 , @xmath1963 consider the generalised equation @xmath1964 obtained from @xmath821 by deleting the equation @xmath1961 and the item @xmath840 .",
    "the presentation of @xmath1965 is obtained from the presentation of @xmath841 using a tietze transformation .",
    "thus , these groups are isomorphic .",
    "we define the relation @xmath1966 as the restriction of @xmath945 to the set @xmath1967 , and @xmath1968 .",
    "it follows that @xmath1969 $ } \\!\\mathord{\\left/ { \\vphantom { g[h_1,\\dots , h_{j-1},h_{j+1},\\dots , h_\\rho ] { \\omega'\\cup\\{[h_k , w_\\nu]\\mid \\re_\\upsilon(h_j , h_k)\\})}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${\\omega'\\cup\\{[h_k , w_\\nu]\\mid \\re_\\upsilon(h_j , h_k)\\})}$}}}.\\ ] ] note that if @xmath1970 , then , since all the items covered by @xmath1219 or @xmath1044 belong to tribes that dominate @xmath1958 , it follows that @xmath942 for all @xmath1971 .",
    "we conclude that the groups @xmath843 and @xmath1972 are isomorphic and we denote this isomorphism by @xmath1973 .",
    "notice that the number of eliminable bases of @xmath956 is strictly lower than the number of eliminable bases of @xmath50 .",
    "furthermore , if the number of eliminable bases of @xmath956 is @xmath5 , then @xmath1974 . since for",
    "the kernel @xmath1922 the linear case can not further occur , it follows that the fundamental sequence factors either through a finite branch or through an infinite branch of type 12 or type 15 .",
    "then , by propositions [ prop : sing ] , [ prop : quad ] and [ prop : case15 ] , there exists a graph tower for @xmath956 .",
    "we conclude by induction on the number of eliminable bases that there exists a graph tower @xmath1975 ( the group @xmath342 and the homomorphism @xmath1976 ) for the group @xmath1972 .",
    "we now show that the triple @xmath1975 , @xmath342 and @xmath1977 is a graph tower associated to @xmath843 .",
    "since @xmath249 is an isomorphism , it implies that diagram ( [ diag : period ] ) is commutative .",
    "we are left to show that @xmath1978 satisfies the induction hypothesis ih1 and ih2 .",
    "since @xmath342 satisfies the property ih1 for the homomorphisms induced by solutions of @xmath956 and every solution of @xmath50 induces a solution of @xmath956 , it follows that @xmath342 satisfies the assumption ih1 for the family of solutions of @xmath50 .",
    "let @xmath840 be the item of @xmath50 which has been eliminated .",
    "it suffices to prove that for all @xmath729 in @xmath1979 and any solution from the fundamental sequence we have that @xmath1980 .",
    "the latter follows since @xmath1962 , @xmath840 belongs to the tribe @xmath1958 , any @xmath925 in @xmath1981 dominates the tribe @xmath1958 ( i.e. for any solution from the fundamental sequence @xmath1982 ) and @xmath1009 satisfies the induction hypothesis ih2 for the items @xmath925 in @xmath956 .",
    "suppose finally that all the active items that are covered once in @xmath1956 belong to tribes that strictly dominate @xmath1958 . in this case , instead of @xmath1956 , we consider the generalised equation @xmath1983 : for every active item that is covered only once we introduce a new pair of auxiliary bases , and apply the argument given above for @xmath1943 to @xmath1983 .",
    "note that all the new auxiliary bases in @xmath1983 belong to tribes that strictly dominate @xmath1958 and that the length of a sequence of strictly dominating tribes is bounded above .",
    "furthermore , if the tribe @xmath1958 is maximal , then all the items belong to this tribe .",
    "in particular , if the tribe is maximal and there are items covered just once , they are eliminable and as we have shown in case ii.2 , in this case , there exists the corresponding graph tower .",
    "therefore , by ( increasing ) induction on the length of the sequence of strictly dominating tribes for @xmath1958 , we prove the existence of the corresponding graph tower .",
    "suppose that the fundamental branch in @xmath1954 is infinite , we show that in this case , the branch is of type 12 or 15 . by construction ,",
    "every auxiliary base of @xmath1943 can be the carrier at most once .",
    "it follows that if the fundamental branch in @xmath1943 is infinite , then there exists @xmath30 so that for all @xmath1984 the carrier of @xmath1027 is not an auxiliary base .",
    "furthermore , if the carrier of @xmath1027 has its dual in the non - active part , then the complexity of the generalised equation @xmath1985 is strictly lower than the complexity of @xmath1027 .",
    "we conclude that in the infinite branch there exists a generalised equation @xmath1165 so that    * for all @xmath1986 , the carrier base of @xmath1027 is neither auxiliary nor does its dual belong to the non - active part of @xmath1027 ; * if @xmath1987 , then @xmath1222 repeats in the infinite branch infinitely many times and @xmath1166 belongs to a minimal tribe .    using the description of the cases 12 and 15 ,",
    "we conclude that there exists a generalised equation @xmath1955 so that @xmath1988 is a proper quotient of @xmath1989 and such that every solution of the fundamental sequence is a composition of an automorphism of type 12 and 15 , correspondingly , the epimorphism from @xmath1989 to @xmath1988 and a solution of @xmath1955 . by induction hypothesis",
    "there exists a graph tower for @xmath1990 and by propositions [ prop : sing ] , [ prop : quad ] and [ prop : case15 ] one can construct a tower for @xmath1991 .    finally , we summarize the results of this whole section in the theorem below .",
    "let @xmath0 be a limit group over @xmath18 and let @xmath1992 be the fundamental branch for @xmath0 .",
    "then , there exists a homomorphism from @xmath845 to a graph tower @xmath851 which makes diagram ( [ diag : period ] ) commutative .",
    "furthermore , if the group @xmath0 is given by its finite radical presentation , then the graph tower @xmath851 and the corresponding homomorphism can be constructed effectively .",
    "in section [ sec:10 ] , we proved that given a limit group @xmath0 over @xmath18 and a fundamental branch @xmath1993 , one can effectively construct a graph tower @xmath851 and a homomorphism @xmath1994 that makes diagram ( [ diag : period ] ) commutative . in this section , we show that the graph tower @xmath851 is discriminated by @xmath18 by the family of homomorphisms induced by the fundamental sequence .",
    "we use this fact to conclude that every limit group over @xmath18 is a subgroup of a graph tower . furthermore ,",
    "if @xmath0 is given by its finite radical presentation , then the graph tower @xmath851 and the embedding can be constructed effectively .",
    "[ thm : towerdisc ] let @xmath0 be a limit group over @xmath18 and let @xmath884 be the graph tower associated to the fundamental branch of @xmath0 .",
    "then , the graph tower @xmath19 is discriminated by @xmath18 by the family of homomorphisms induced by solutions that factor through the fundamental branch .",
    "we prove the statement by induction on the height of the graph tower .",
    "suppose that the height of the graph tower is @xmath5 .",
    "then , @xmath19 is the partially commutative group associated to a leaf of the tree @xmath849 for some generalised equation @xmath50 and so , by ( * ? ? ?",
    "* proposition 9.1 ) , the graph tower @xmath19 is discriminated by @xmath18 by the family of solutions of the generalised equation .",
    "suppose that if @xmath19 is a graph tower of height less than or equal to @xmath9 , then @xmath19 is discriminated by @xmath18 by the family of homomorphisms induced by solutions of the fundamental sequence .",
    "let @xmath851 be a graph tower of height @xmath7 .",
    "by lemma [ lem : prtower ] , the graph tower @xmath851 has a decomposition as an amalgamated product .",
    "we now analyse each of the possible decompositions .",
    "notice that if @xmath851 is of type a1 ) , then it only appears in the construction of the leaves of @xmath35 , i.e. the graph tower @xmath999 coincides with the associated partially commutative group @xmath1995 . in this case , since @xmath756 is directly indecomposable , it follows from ( * ? ? ?",
    "* corollary 2.11 ) that the family of solutions @xmath26 of the fundamental sequence which maps the variables @xmath1996 into irreducible elements of the subgroup @xmath756 is a discriminating family .",
    "assume now that the graph tower @xmath851 is of type a2 ) .",
    "this case appears either in the construction of a leaf , or in the presence of a periodic structure or in the particular case when the quadratic equation in the normal form does not satisfy the properties @xmath805 and @xmath806 , see definition [ defn : tower ] ( and @xmath756 is @xmath148-abelian ) .",
    "if it appears in the construction of a leaf , the result follows analogously to the case a1 ) .",
    "let us now consider the remaining cases .",
    "we begin with an observation .",
    "let @xmath757 be the canonical parabolic subgroup such that for the fundamental sequence of solutions @xmath26 we have that @xmath1997 .",
    "since @xmath1998 , by the induction hypothesis ih1 , it follows that @xmath1999 .",
    "since @xmath756 is @xmath1613-abelian , so is @xmath2000 . since for the discriminating family of solutions",
    "the subgroup defined by @xmath2001 is cyclic and @xmath2002 , it follows that @xmath2000 is a cyclic canonical parabolic subgroup generated by the generator @xmath2003 .",
    "let @xmath2004 .",
    "since @xmath2005 , we have that @xmath2006 . on the other hand , since @xmath2007 , by the induction hypothesis ih1 , it follows that @xmath2008 and so @xmath2009 .",
    "hence @xmath2010 and @xmath2011 .",
    "furthermore , since @xmath2012 for all homomorphisms @xmath854 induced by the discriminating family , we conclude that @xmath2013 .",
    "since @xmath851 is an amalgamated product , it follows that every non - trivial element @xmath346 of @xmath851 can be written in the reduced form as @xmath2014 , where @xmath2015 and @xmath2016 are words in the generators @xmath2017 .",
    "hence , there exist @xmath2018 such that @xmath2019\\ne 1 $ ] , @xmath2020 .    since , by induction hypothesis , @xmath999 is discriminated by @xmath18 by the family of homomorphisms induced by the set of solutions , there exists a homomorphism @xmath1579 which is injective on the finite set @xmath2021 \\mid i=2,\\dots , k+1\\}$ ] .",
    "therefore , @xmath2022)=[{h^{(1)}}'(a_i),a^{l_i}]\\ne 1 $ ] . hence @xmath2023 and , in particular , using the above observation , @xmath2024 .",
    "the homomorphism @xmath1579 induces a homomorphism @xmath2025 from @xmath851 to the group @xmath2026 , 1\\le i < j\\le n \\rangle\\right),\\ ] ] i.e. @xmath2025 is a homomorphism from @xmath851 to the extension of the centraliser of the element @xmath2003 : @xmath2027=1 , [ x_i^l , x_j^l]=1 \\rangle.\\ ] ] moreover , the image @xmath2028 of @xmath346 in @xmath18 , is a reduced element of the amalgamated product @xmath20 since @xmath2029 , @xmath2030 .",
    "furthermore , in all the cases under consideration ( for periodic structures and for exceptional subcases of the quadratic case ) , we have that any solution @xmath2031 of the fundamental sequence is the composition of a canonical automorphism @xmath547 of @xmath1426 , the epimorphism @xmath1004 and a solution @xmath2032 .",
    "moreover , notice that any such automorphism @xmath547 induces an automorphism of @xmath20 that fixes @xmath18 .",
    "hence the family of solutions @xmath2031 of the fundamental sequence defines a family of homomorphisms from @xmath20 to @xmath18 that are obtained from a ( non - trivial ) solution ( induced by @xmath2033 ) by pre - composing with canonical automorphisms .    by (",
    "* lemma 4.17 ) and ( * ? ? ?",
    "* corollary 2.11 ) , the group @xmath20 ( an extension of a centraliser of the canonical generator @xmath2003 ) is discriminated by @xmath18 by this family of homomorphisms . therefore , we conclude that @xmath851 is discriminated by @xmath18 by the family of homomorphisms induced by the solutions of the fundamental sequence .",
    "assume that @xmath851 is of type b1 ) or b2 ) .",
    "these cases occur in the presence of a periodic structure or in the particular case when the quadratic equation in the normal form does not satisfy the properties @xmath805 and @xmath806 from definition [ defn : tower ] . by remarks [ rem : blockperiod ] and [ rem : blocks ] , the homomorphisms @xmath854 induced by solutions of the fundamental sequence ( only in the case b1 ) )",
    "satisfy that @xmath2034 and @xmath2035 are irreducible elements of @xmath760 .",
    "now the proof is analogous to the case a2 ) .",
    "suppose that @xmath851 is of type c ) .",
    "this case only occurs when the quadratic equation satisfies properties @xmath805 and @xmath806 from definition [ defn : tower ] .",
    "the subgroup of @xmath999 generated by @xmath2036 and @xmath2037 , where @xmath1303 is a quadratic - coefficient base , @xmath1638 is the direct product @xmath2038    let us prove the claim .",
    "in fact , we show that the subgroup @xmath166 generated by @xmath756 and @xmath2036 is a direct product",
    ". then , since @xmath2039 , the claim will follow . by remark [ rem : blocks ] , for the family of homomorphisms",
    "@xmath854 induced by the set of solutions of the fundamental sequence , we have that for all minimal items @xmath822 , the image @xmath2040 is a block element of @xmath760 and @xmath2041 . in particular , it follows that @xmath760 is a ( non - abelian ) directly indecomposable canonical parabolic subgroup . by the description of centralisers in",
    "partially commutative groups , it follows that @xmath2042 and so @xmath2043 . by induction hypothesis , we have that the subgroup @xmath166 is discriminated by the subgroup @xmath2044 and so @xmath166 is the direct product of @xmath756 and @xmath2036 . indeed since @xmath2045 and",
    "@xmath2046=1 $ ] , we are left to show that @xmath2047 .",
    "suppose that there exist @xmath2048 and @xmath2049 so that @xmath2050 in @xmath166 .",
    "then , @xmath2051 , @xmath2052 and @xmath2053 .",
    "since @xmath2054 , so @xmath2055 for all homomorphisms @xmath854 .",
    "it follows that @xmath2056 .",
    "the strategy to prove that @xmath851 is discriminated by @xmath18 is as follows .",
    "as above , to prove that @xmath851 is discriminated , it suffices to prove that so is @xmath2057 where @xmath2058 . to prove the latter ,",
    "we follow the standard argument for limit groups over free groups , see for instance ( * ? ? ?",
    "* proposition 4.22 ) .",
    "there are two adjustments required for the argument in @xcite to go through .",
    "firstly , free groups satisfy the bp property , see ( * ? ? ?",
    "* lemma 4.13 ) and secondly , limit groups over free groups are csa . in general ,",
    "partially commutative groups do not have the bp property ( see @xcite ) . in our case , since , by induction , we assume that @xmath999 is discriminated by the family of homomorphisms induced by a fundamental sequence , it follows that the images of @xmath2059 under the discriminating family are block elements ( see remark [ rem : blocks ] ) .",
    "furthermore , by lemma [ lem : eired ] , there exists a non - trivial curve @xmath289 which is mapped to irreducible elements for all solutions of a fundamental sequence .",
    "we prove in ( * ? ? ?",
    "* lemma 4.17 ) that we do have the bp property with respect to irreducible elements in partially commutative groups .",
    "therefore , the argument given in ( * ? ? ?",
    "* proposition 4.22 ) goes through , using ( * ? ? ?",
    "* lemma 4.17 ) instead of ( * ? ? ?",
    "* lemma 4.13 ) .",
    "the argument of @xcite uses the csa property in ( * ? ? ?",
    "* example 4.21 ) . in general partially commutative group",
    "do not have the csa property , but we do can apply the argument from ( * ? ? ?",
    "* example 4.21 ) in our context .",
    "let @xmath2060 , @xmath2061 , @xmath87 , @xmath2062 and @xmath673 be as in ( * ? ? ?",
    "* example 4.21 ) . by assumption , we have that @xmath2063 is non - abelian and we want to show that @xmath2064 is also non - abelian .    by contradiction ,",
    "assume that @xmath2064 is abelian .",
    "by induction hypothesis , the discriminating family of homomorphisms @xmath854 induced by the solutions has the property that if @xmath822 is a minimal item , then @xmath2040 is a block element and there exists an irreducible element @xmath2065 .",
    "it follows that if the image @xmath2064 is abelian , then it is cyclic . in partially commutative groups ,",
    "cyclic subgroups satisfy the property that if @xmath2066 is non - trivial , then @xmath2067 commutes with @xmath2064 and hence @xmath2063 is abelian , deriving a contradiction .",
    "now the argument is identical to the one given in ( * ? ? ?",
    "* proposition 4.22 ) .",
    "[ cor : limit ] let @xmath0 be a limit group over @xmath18 .",
    "then , @xmath0 is a subgroup of a graph tower @xmath884 .",
    "furthermore if @xmath0 is given by its finite radical presentation , then the graph tower @xmath1657 and the embedding can be effectively constructed .",
    "since @xmath19 is discriminated by @xmath18 by the family of homomorphisms induced by a fundamental sequence of solutions associated to @xmath0 and since diagram ( [ diag : period ] ) is commutative , it follows that @xmath2068 .",
    "hence , by the universal property of the quotient , @xmath1658 induces a homomorphism @xmath1976 from @xmath838 to @xmath19 .",
    "since the fundamental sequence that discriminates @xmath0 into @xmath18 factors through @xmath19 , it follows that the composition of @xmath2069 and @xmath1658 is an embedding of @xmath0 into @xmath19 .",
    "[ thm : main ] let @xmath0 be a finitely generated group .",
    "the group @xmath0 acts essentially freely co - specially on a real cubing if and only if it is a subgroup of a graph tower",
    ".    follows from theorem [ thm : gen ] and corollary [ cor : limit ] .    in the case of free actions , the above theorem results in the following corollary , which can be likened to rips theorem on free actions on real trees .",
    "[ cor : main ] a finitely generated group @xmath0 acts freely , essentially freely and co - specially on a real cubing if and only if @xmath0 is a subgroup of the graph product of free abelian and ( non - exceptional ) surface groups .    in particular , if the real cubing is a real tree , then @xmath0 is a ( subgroup of ) the free product of free abelian groups and ( non - exceptional ) surface groups .",
    "we now record some properties of limit groups over partially commutative groups .    1 .",
    "every limit group over @xmath18 is torsion free . 2 .",
    "every 2-generated limit group is either free or free abelian .",
    "every solvable subgroup of a limit group is abelian .",
    "4 .   let @xmath2070 be an algebraic group over @xmath2071 in which @xmath18 embeds .",
    "then , for any limit group @xmath0 over @xmath18 there exists an embedding @xmath2072 .",
    "in particular , @xmath0 embeds into @xmath2073 .",
    "the natural map @xmath2074 is also an embedding .",
    "let @xmath18 be a partially commutative group and let @xmath884 be a graph tower associated to a limit group @xmath0 over @xmath18 . then",
    ", abelian subgroups of @xmath19 ( and thus of @xmath0 ) are free , and there is a uniform bound on their rank .",
    "all but the last statement follow from definition using general arguments , see , for example , @xcite . to prove the last one we use the fact that every limit group over @xmath18 is a subgroup of a graph tower .    first notice that since , by theorem [ thm : towerdisc ] , the group @xmath19 is discriminated by @xmath18 , then any abelian subgroup of @xmath19 is torsion - free .",
    "let @xmath20 be an abelian subgroup of @xmath19 .",
    "let us prove that the rank of @xmath20 is uniformly bounded by induction on the height of @xmath19 . if the height is @xmath5 , then the graph tower coincides with the partially commutative group @xmath18 and hence the rank of an abelian subgroup is bounded by the number of vertices in a maximal clique of the graph @xmath64 or , more coarsely , it is bounded by the number of generators of @xmath18 .",
    "let @xmath2075 be of height @xmath7 .",
    "by lemma [ lem : prtower ] , the group @xmath19 admits a decomposition as an amalgamated product .",
    "let @xmath1665 be the bass - serre tree associated to the decomposition of @xmath19 .",
    "notice that the rank of an abelian subgroup of @xmath8 is uniformly bounded by @xmath2076 by induction hypothesis .",
    "furthermore , the other vertex group is a direct product of a subgroup of @xmath8 and either a free , or a free abelian or a surface group .",
    "hence in all the cases , we conclude that the rank of an abelian subgroup of this vertex group is uniformly bounded by @xmath2077 .",
    "if the subgroup @xmath20 fixes a vertex of @xmath1665 then @xmath20 is a subgroup of a ( conjugate ) of a vertex group and so its rank is uniformly bounded by @xmath2077 .",
    "otherwise , @xmath20 fixes a line @xmath2078 in @xmath1665 , on which it acts by translations .",
    "the quotient @xmath2079 is topologically a circle ; after some collapses @xmath94 is an hnn - extension ; so the rank of @xmath20 is uniformly bounded by @xmath2080 .",
    "if a group @xmath0 is equationally noetherian , then every algebraic set @xmath174 in @xmath316 is a finite union of its irreducible components . using the duality between the categories of algebraic sets and coordinate groups",
    ", one can conclude that if @xmath0 is equationally noetherian , then any coordinate group is the subdirect product of the direct product of the coordinate groups of the irreducible components , @xcite .",
    "since partially commutative groups are equationally noetherian , any finitely generated residually @xmath18 group is a subdirect product of the direct product of finitely many limit groups over @xmath18 .    in the case of free groups , kharlampovich and miasnikov , @xcite , used the makanin - razborov process to describe an embedding of a residually free group into the direct product of limit groups . in a recent work on the structure of finitely presented residually free groups ,",
    "bridson , howie , miller and short , @xcite , gave a different ( canonical ) construction of such an embedding .",
    "the aim of this section is to generalise the forementioned results and show that given a finitely generated residually @xmath18 group @xmath0 , one can effectively construct an embedding of @xmath0 into the direct product of limit groups over @xmath18 .",
    "namely , we prove the following    [ thm : sollast ] let @xmath18 be a partially commutative group and let @xmath0 be a finitely generated residually @xmath18 group .",
    "then , one can effectively construct finitely many fully residually @xmath18 graph towers @xmath52 and homomorphisms @xmath53 from @xmath0 to @xmath54 , @xmath55 , so that any homomorphism from @xmath0 to @xmath18 factors through a graph tower @xmath54 , for some @xmath55 , i.e. for any homomorphism @xmath56 there exist @xmath57 and a homomorphism @xmath58 so that @xmath59 . in particular , @xmath0 is a subgroup of the direct product of the graph towers @xmath54 , @xmath55 and a subdirect product of the direct product of groups @xmath60 , @xmath61 .",
    "notice that @xmath60 , @xmath61 , are finitely generated subgroups of the graph towers @xmath54 . since the graph towers @xmath54 are discriminated by @xmath18 , it follows that @xmath2081 , @xmath61 are limit groups over @xmath18 .",
    "let @xmath0 be a finitely generated residually @xmath18 group given by its finite radical presentation .",
    "then , one can effectively construct an embedding of @xmath0 into the direct product of finitely many limit groups over @xmath18 .",
    "it is worthwhile mentioning that , in general , the decomposition we construct is not minimal , i.e. @xmath0 might be presented as the subdirect product of a direct product of ( strictly ) less than @xmath25 limit groups .    for a limit group over @xmath18 ,",
    "we have effectively constructed a graph tower associated to the fundamental branch , see corollary [ cor : limit ] . in the proof , the fact that the fundamental sequence is a discriminating family is used only in and when referring to lemma [ lem : discfam ] , i.e. when given a decomposition of a discriminating family of homomorphism @xmath324 into a finite union of families of homomorphisms @xmath2082 ( with a specific property ) , we conclude that then one of the subfamilies is a discriminating family .",
    "let @xmath0 be a finitely generated residually @xmath18 group and let @xmath49 be the makanin - razborov diagram constructed in @xcite .",
    "we construct a tree @xmath2083 from the tree @xmath49 as follows .",
    "we follow the proof given in section [ sec:10 ] , but for each branch @xmath363 of the tree @xmath49 , if a family of homomorphisms @xmath324 of the branch @xmath363 is decomposed into a finite union @xmath2082 of subfamilies ( with certain properties ) , we replace the branch @xmath363 by @xmath7 identical branches @xmath2084 and require that the homomorphisms that factor through the branch @xmath2085 are homomorphisms that factor through @xmath363 and satisfy the properties satisfied by the family @xmath2086 .",
    "we denote the new tree by @xmath2083 .",
    "let @xmath2090 be the homomorphism from @xmath0 to @xmath2091 constructed in ( * ? ? ?",
    "* section 3.3 ) and set @xmath2092 to be @xmath2093 .",
    "since the tree @xmath2083 describes all the homomorphisms from @xmath0 to @xmath18 ( see @xcite ) , by the commutativity of diagram ( [ diag : period ] ) , we conclude that every homomorphism from @xmath0 to @xmath18 factors through some graph tower @xmath2088 .",
    "furthermore , since the group @xmath0 is residually @xmath18 , it follows that the homomorphisms @xmath2092 induce an embedding of @xmath0 into the direct product of graph towers @xmath2088 , where @xmath363 runs over all the branches of the tree @xmath2083 .      for any finite system of equations @xmath2094 over a partially commutative group @xmath18 , one can find effectively a finite family of graph towers @xmath52 , @xmath2095 $ } \\!\\mathord{\\left/ { \\vphantom { { \\ensuremath{\\mathbb{g}}}[y_i ] { s_i}}}\\right.\\kern-\\nulldelimiterspace}\\!\\lower0.7ex\\hbox{${s_i}$}}}$ ] and word mappings @xmath2096 such that for every @xmath2097 there exist @xmath249 and @xmath2098 for which @xmath2099 , i.e. @xmath2100 and all sets @xmath2101 are irreducible ; moreover , every irreducible component of @xmath2102 can be obtained as a closure of some @xmath2103 in the zariski topology .",
    "m.  bestvina , m.  feighn , _ notes on sela s work : limit groups and makanin - razborov diagrams _ , in : geometric and cohomological methods in group theory , london math .",
    "lecture note ser .",
    ", 358 , cambridge univ . press , cambridge , 2009 .",
    "e. daniyarova , a. miasnikov , v. remeslennikov , _ unification theorems in algebraic geometry _ , in : `` aspects of infinite groups : a festschrift in honor of anthony gaglione '' , algebra and discrete mathematics v. 1 , pp .",
    "80 - 111 , world scientific , 2007 .",
    "e.  s.  esyp , i.  v.  kazachkov and v.  n.  remeslennikov , _ divisibility theory and complexity of algorithms for free partially commutative groups _ , in : groups , languages , algorithms .",
    "( 2005 ) , pp .  319 - 348 .",
    "o.  kharlampovich , a.  myasnikov , _ irreducible affine varieties over a free group ii : systems in triangular quasi - quadratic form and description of residually free groups _ , j. of algebra , * 200 * ( 1998 ) , pp .",
    "517 - 570 .",
    "f. paulin , _ outer automorphisms of hyperbolic groups and small actions on @xmath2071-trees _ , arboreal group theory ( ed .",
    "r. c. alperin ) math .",
    "19 , springer , berlin , 1991 , pp .",
    "331 - 343 .",
    "h. wilton , _ solutions to bestvina and feighn s exercises on limit groups_. in : geometric and cohomological methods in group theory , pp .",
    "30 - 62 , london math .",
    "lecture note ser .",
    ", 358 , cambridge univ .",
    "press , cambridge , 2009 ."
  ],
  "abstract_text": [
    "<S> we introduce a class of spaces , called real cubings , and study the stucture of groups acting nicely on these spaces . </S>",
    "<S> just as cubings are a natural generalisation of simplicial trees , real cubings can be regarded as a natural generalisation of real trees . </S>",
    "<S> our main result states that a finitely generated group @xmath0 acts nicely ( essentially freely and co - specially ) on a real cubing if and only if it is a subgroup of a graph tower ( a higher dimensional generalisation of @xmath1-residually free towers and ntq - groups ) . </S>",
    "<S> it follows that @xmath0 acts freely , essentially freely and co - specially on a real cubing if and only if @xmath0 is a subgroup of the graph product of cyclic and ( non - exceptional ) surface groups . in the particular case </S>",
    "<S> when the real cubing is a tree , it follows that @xmath0 acts freely , essentially freely and co - specially on the real cubing if and only if it is a subgroup of the free product of abelian and surface groups . </S>",
    "<S> hence , our main result can be regarded as a generalisation of the rips theorem on free actions on real trees .    </S>",
    "<S> we apply our results to obtain a characterisation of limit groups over partially commutative groups as subgroups of graph towers . </S>",
    "<S> this result generalises the work of kharlampovich - miasnikov , @xcite , sela , @xcite and champetier - guirardel , @xcite on limit groups over free groups . </S>"
  ]
}