{
  "article_text": [
    "quantum monte carlo methods for bosonic systems continue to provide very useful insight into the nature of such systems and can be carried out on very large size systems which allows extrapolation to the thermodynamic limit .",
    "interacting fermion systems and frustrated spin systems in more than one dimension , however , are plagued with the infamous so - called minus - sign problem , which leads to exponential growth of the statistical error with the system size .",
    "since most real systems are `` deep down '' fermionic , including the electronic structure of solids , and the nuclear , neutron and quark matter , computational physics faces a bottleneck of paramount importance .",
    "the diagrammatic monte carlo ( diag - mc ) method@xcite , which has been successfully applied to a wide variety of problems in a range of fields , including ultra - cold atoms trapped in optical lattices@xcite , superconductivity@xcite , the fermi - polaron problem@xcite , systems of correlated fermions@xcite , in systems of excitons@xcite , and frustrated quantum spin systems@xcite , is based on the interpretation of the entire sum of all feynman diagrams as an ensemble averaging process over their corresponding configuration space .",
    "thus , a markov sequence @xmath0 , @xmath1 , ... ,",
    "@xmath2 , ... , can be defined by means of transitions @xmath3 based on the weights of the particular series of feynman diagrams , which samples these diagrammatic terms with the exact relative weights as in the diagrammatic expansion .",
    "one of the great advantages of the method is that it sums only the linked diagrams and , thus , in the case of fermion systems , the infamous minus - sign problem could become a minus - sign `` blessing''@xcite .",
    "in addition to the large cancellation due to the interference terms due to the fermion statistics , which severely limits the `` signal - to - noise '' ratio in mc simulation of fermionic systems , we also face the problem of extracting the low - energy physics in most many - body problems . in calculating the green s function in imaginary time @xmath4",
    ", this problem shows up in our attempt to estimate the long - time behavior of these functions as a function of @xmath4 . in this limit",
    "the green s function decays rapidly ( because of the other high energy excitations ) and , it quickly becomes very small and the information about the low - lying excitations gets lost in the noise of numerical data .",
    "the so - called `` flat histogram methods''@xcite have been used to improve the monte - carlo simulation of classical systems , for example for systems undergoing first order phase transitions , systems with rough energy landscapes , etc .",
    "in addition , the wang - landau algorithm@xcite has been applied to the simulation of _ equilibrium _ statistical mechanical properties of _ quantum _ systems@xcite .",
    "more precisely , troyer wessel and alet ( twa)@xcite have used the fact that quantum monte carlo simulation uses the mapping of a quantum many - body system to a classical system which allows them to generalize the use of the flat histogram method to this case . using this generalization ,",
    "they show that the algorithm becomes efficient by greatly reducing the tunneling problem in first order phase transitions and , in addition , the algorithm allows them to calculate directly the free - energy and entropy .",
    "following this idea , gull _",
    "et al._@xcite have applied the idea to the continuous - time quantum monte carlo approach to the quantum impurity solver needed for all dynamical mean - field theory applications . while this implementation can include the use of diagrammatic monte carlo@xcite , these calculations proceed by calculating observables in an equilibrium - like formulation , i.e. , using the `` standard '' density of states which appears in the partition function as the distribution which is made flat by the application of the wl algorithm .    in this paper",
    ", we introduce a new version of the diag - mc which is superior to standard diag - mc because it allows us to extract the long imaginary - time ( low energy ) behavior of the green s function @xmath5 accurately without using any _ a priori _ knowledge about the behavior of @xmath5 .",
    "the idea of this new method is based on combining the principle of flat histograms@xcite and the diag - mc method .",
    "this `` flat histogram diagrammatic monte carlo '' ( fhdmc ) method allows us to calculate accurately and directly , without introducing any `` tricks''@xcite and with no _ a priori _ knowledge , the imaginary - time dependence of the green s function @xmath5 which varies over many orders of magnitude .",
    "the idea is different from that of twa and gull et al.@xcite because , as it will become clear in the following , twa make flat the `` density of states '' entering in the partition function , while in our approach the role of the density of states is selected in such a way to make @xmath5 flat . in this paper",
    ", we first introduce the general method of the fhdmc and , then , the efficiency of the method is demonstrated in the example of the frhlich polaron problem@xcite where the standard diag - mc method has been extensively shown to be accurate@xcite .",
    "first , let us consider a simple case of the diagrammatic monte carlo method in order to illustrate the new idea .",
    "the diag - mc method is a markov process which samples an infinite series of the form : @xmath6 where as the order @xmath7 of the expansion increases , the number of integration variables increases in a similar manner .",
    "the diag - mc method is a markov process @xmath8 which generates the distribution @xmath9 , @xmath10 , ... ,",
    "@xmath11 , .... the entire sum @xmath5 can be calculated stochastically if we know the exact value of one of the terms , say , @xmath9 .",
    "then , @xmath12 where @xmath13 is the number of times the @xmath14 term appears in the markov sequence . as a result the fluctuations ( and the error ) in estimating @xmath11 depends crucially on the fluctuations of @xmath15 . as a result",
    "if the value of @xmath9 relative to other terms of the series is small , then , the population @xmath15 could be a small fraction of the total population @xmath16 , which is the total number of mc steps , and , thus , the error in the estimate of @xmath11 by using the above expression will be large . to be more concrete , as the value of @xmath4 increases the value of @xmath17 where @xmath18 attains its maximum increases , and",
    ", @xmath19 increases exponentially with @xmath4 .",
    "therefore , for large enough values of @xmath4 the ratio @xmath20 becomes many orders of magnitude larger than unity .",
    "this corresponds to the problem of critical slowing down in classical mc simulation , a problem which can be addressed by the flat histogram methods@xcite .",
    "the flat histogram method renormalizes these populations by known factors ( which can be easily estimated ) and , then , samples a more - or - less flat histogram of such populations .",
    "we will apply flat histogram methods@xcite on two different versions of applying the diag - mc .",
    "\\i ) _ sampling of @xmath5 for a fixed value of @xmath4 : _ this is very similar to the application of flat histogram techniques applied to classical statistical mechanics . in order to apply any flat histogram technique to our problem we map the particular value of @xmath7 to the `` energy '' level in standard flat histogram methods for classical statistical mechanics and the integrals @xmath11 to the density of states which corresponds to the corresponding configurations .",
    "\\ii ) _ sampling of the histogram of @xmath5 : _ we divide the range of @xmath4 , i.e. , @xmath21 $ ] into @xmath22 equal intervals @xmath23 , where @xmath24 . in this case",
    "the variable @xmath4 is also sampled by the same markov process .",
    "the histogram @xmath25 of @xmath5 defined as @xmath26 requires the histograms @xmath27 of @xmath28 defined by @xmath29 such that @xmath30 the fhdmc can be applied in a similar way to the one discussed in the case for fixed @xmath4 . here",
    ", we apply the flat histogram methods to find the histogram @xmath25 by mapping the value of the interval @xmath31 to the `` energy '' level and @xmath25 to the `` density - of - states '' in the classical case .",
    "we have chosen to apply for the first case above both multicanonical@xcite and the wang - landau ( w - l ) algorithm@xcite , and for the second case only the wl algorithm .",
    "the multicanonical algorithm is applied as follows : first , for a given fixed value of @xmath4 we carry out an initial exploratory run , where we find that the distribution @xmath18 of the values of @xmath7 peaks at some value of @xmath17 , which depends on the chosen value of @xmath4 .",
    "this distribution falls off rapidly for @xmath32 , and , thus , we can determine the maximum value @xmath33 of @xmath7 visited by the markov process .",
    "we choose a value of @xmath34 safely greater than @xmath35 , such that the value of @xmath36 is practically zero .",
    "then , we assign to each one of the @xmath14 term an initial weight @xmath37 for all @xmath38 . after a certain , relatively small number @xmath15 of diag - mc steps",
    ", we redefine the weights to @xmath39 for all @xmath38 , where @xmath40 is the height of the distribution of configurations of the @xmath14 order . in the next step ,",
    "we carry out @xmath15 diag - mc steps after which we change the weights to @xmath41 for all @xmath7 less or equal to @xmath34 , where @xmath42 is the height of the new distribution of configurations of the @xmath14 order .",
    "this procedure is repeated several times , thus , defining a sequence of histograms @xmath43 and of weights @xmath44 ; at the end of each one of these steps k , we determine whether or not the histogram @xmath43 of @xmath7 is `` flat '' , within a some acceptable tolerance level .",
    "when , the histogram @xmath43 becomes `` flat '' at the @xmath45 step we stop this process , and we begin a markov process for a relatively large number @xmath46 of mc steps , by re - weighting the acceptance rates using the weights @xmath47 determined during the last @xmath45 process , and this way we determine @xmath5 .",
    "the w - l algorithm is applied as follows :    using the standard dmc algorithm ( to be discussed for the case of our version of the polaron problem in sec .",
    "[ dmca ] ) we sample the modified density of states @xmath48 , where @xmath49 and @xmath50 is @xmath18 when we sample @xmath18 ( case i ) above ) , and @xmath51 , @xmath52 , when we sample the histogram of @xmath5 ( case ii ) above ) .",
    "initially , we take @xmath53 for all values of @xmath7 . every time a state @xmath54 appears in the markov process the value of @xmath55 is modified immediately in the next step to @xmath56",
    "where the factor @xmath57 .",
    "after a certain number of iteration @xmath15 we check whether or not the histogram of the states is flat within a tolerance of our specification .",
    "if the histogram is not flat , we repeat the previous step for another @xmath15 iterations . if the histogram is found to be flat , then , we set the values of the histogram to zero and we repeat the whole previous process by using @xmath58 . we stop the process when @xmath59 , where @xmath60 is our pre - specified value .",
    "the final values of @xmath61 after normalization are the density of states , which are proportional to the values of @xmath50 .",
    "the standard diag - mc has been extensively applied to the frhlich polaron hamiltonian which describes a single electron in a phonon field : @xmath62 where the summation extends over the first brillouin zone and @xmath63 is the volume of the system .",
    "this hamiltonian takes into account a single optical phonon with fixed frequency @xmath64 and @xmath65 and @xmath66 are electron and phonon creation operators . here",
    ", we will work in imaginary time at @xmath67 .",
    "the free electron and phonon propagators are respectively given by @xmath68    while the diag - mc algorithm and our computer program are quite general and can solve exactly ( within statistical errors ) the single polaron problem , we choose to restrict ourselves to sampling only the diagrams of the infinite series shown in fig .",
    "[ fig:0 ] .",
    "the reason is that we can sum up this infinite series of selected diagrams exactly and this allows us to compare the results of the standard diag - mc and the fhdmc with the exact solution .",
    "this series is summed by solving dyson s equation which for the case of @xmath69 is given as : @xmath70 where we have taken @xmath71 .",
    "this equation can be transformed in laplace s space , using the properties of convolution integrals , as follows : @xmath72 which yields @xmath73 the inverse laplace transform is given by @xmath74 using the corresponding bromwich contour we obtain : @xmath75 where @xmath76 are the three roots of the equation @xmath77 , @xmath78 is the real root and @xmath79 and @xmath80 are complex conjugate to each other . for @xmath81 we find that @xmath82 and @xmath83 .",
    "asymptotically for @xmath84 we have @xmath85 therefore , the polaron ground state energy in the approximation given by the series in fig .",
    "[ fig:0 ] is @xmath86 . for a finite chemical potential @xmath87 ,",
    "@xmath5 should be modified to @xmath88 .    0.5 in    0.5 in",
    "_ fixed @xmath4 diag - mc _ :",
    "as discussed earlier we have applied the diag - mc for fixed @xmath4 . the fixed-@xmath4",
    "diag - mc is very similar to the approach outlined by prokofev _",
    "et al._@xcite .",
    "it includes only transitions from order @xmath7 to @xmath89 where we select the beginning @xmath90 , the end @xmath91 and the momentum @xmath92 of the phonon propagator .",
    "in addition , it includes transitions from @xmath7 to @xmath93 ( except when @xmath94 ; this exception modifies the acceptance rate from @xmath95 compared to all other transitions originating from @xmath96 ) where the phonon propagator is removed .",
    "we modify this part of the general simulation algorithm in order to simulate only the series in fig .",
    "[ fig:0 ] as follows : when we attempt the mc move @xmath97 , i.e. , we attempt to add a new phonon propagator at time instants @xmath98 and @xmath99 , the free fermion line where the instant @xmath98 is to be inserted is selected to be one of those existing free - fermion lines which do not have the same ends with one and the same phonon propagator , and @xmath99 is selected to be between @xmath98 and the end of the selected free - fermion line .",
    "_ sampling of the histogram of @xmath5 : _    as discussed earlier in this case we consider the histogram in the intervals @xmath100 .",
    "using the behavior of @xmath5 for large @xmath4 we calculate the ground state energy . the updating procedure between different orders @xmath7 is the same as in the case of fixed @xmath4 discussed in the previous paragraph .",
    "in addition , here , we allow transitions to a different time @xmath101 which may belong to a different interval .",
    "the value of @xmath101 is selected as in ref .",
    ", with the only difference that @xmath101 is selected in the interval @xmath102 $ ] , instead of the interval @xmath103 $ ] ( where @xmath104 is the end of the last phonon propagator in the particular diagram ) .",
    "0.5 in + 0.5 in    0.5 in    fig .",
    "[ fig:1 ] presents the results of our calculation of @xmath5 for fixed values of @xmath4 .",
    "the results of fhdmc were obtained with the application of multicanonical@xcite ( top of fig .",
    "[ fig:1 ] ) and wang - landau@xcite ( w - l ) algorithm ( bottom of fig .",
    "[ fig:1 ] ) for the reduced polaron problem .",
    "we calculated @xmath5 for @xmath105 and for approximately the the same amount of cpu time for comparison .",
    "in our multicanonical simulation for a given value of @xmath4 , our tolerance for the value of histogram of @xmath11 for any @xmath7 was lower than twice and higher than half the value of the histogram for @xmath9 .",
    "renormalization of the `` density of states '' was performed every @xmath106 iterations .",
    "after the histogram became flat within our tolerance , we carried out @xmath107 iterations for each instant of time considered .",
    "the total number of iterations required was @xmath108 .",
    "in our simulation using the w - l algorithm , we gave the modification factor @xmath109 the initial value @xmath110 and we reduce it according to @xmath111 every time the histogram became `` flat '' within our tolerance .",
    "our tolerance for `` flatness '' was such that the absolute value of the difference of the histogram @xmath112 for each value of @xmath7 from the average value of the histogram @xmath113 to be less than @xmath114 .",
    "the `` flatness '' of the histogram was assessed every @xmath106 iterations .",
    "choosing the final value for @xmath109 to be 1.000007629 , the total number of iterations required was @xmath108 .",
    "notice that both flat histogram algorithms yield @xmath5 for any @xmath4 including very long-@xmath4 where @xmath5 varies over many orders of magnitude . by fitting the long imaginary - time part of the green s function to a single exponential @xmath115",
    ", we find that in the case of multicanonical the ground state energy is @xmath116 and @xmath117 , while in the case of the w - l algorithm @xmath118 and @xmath119 .",
    "the exact values are @xmath120 and @xmath121 .    0.5 in + 0.5 in    0.5 in    0.5 in    0.5 in    fig .",
    "[ fig:2](a ) compares the results of our fhdmc for @xmath25 obtained with the w - l algorithm with the results of the standard implementation of the diag - mc without using the so - called guidance exponential function ( i.e. , parameter @xmath122 ) .",
    "the simulation using the w - l algorithm was done as described earlier when discussing the results of fig .",
    "[ fig:1 ] for the calculation of @xmath5 for constant @xmath4 . for comparison",
    "the diag - mc method was also applied for approximately the same cpu time .",
    "notice that while the wl simulation gives results with negligible error bar ( its size in this figure is about the size of the symbols ) , the diag - mc calculation has significant errors .",
    "however , if we look closely we notice that the average values , from each time window to the next , do not fluctuate in a way which is consistent with the size of the error bar . in order to clarify this",
    ", we provide fig  [ fig:2](b ) , where the results of four different runs are presented ( shown with different types of lines ) where each curve is obtained using the same number of iterations starting from a different random initial configuration . notice that , from one run to the other , the results for the histogram of @xmath5 move in a correlated way ( i.e. , together ) up or down and the four curves are parallel to each other for large values of @xmath4",
    "the reason for that is the following .",
    "the exponential growth of @xmath5 with @xmath4 makes @xmath123 for large @xmath7 . as a consequence of that the number of monte carlo steps",
    "`` falling '' in the first interval is relatively small .",
    "this means that the statistical fluctuations of the histogram height of the first interval are much larger than the statistical fluctuations of the histogram height of the other intervals . within the diag - mc method the value of @xmath124",
    "is obtained by simply multiplying the ratio of the corresponding histogram heights @xmath125 with the value of @xmath126 , which is analytically known .",
    "thus , due to these fluctuations , the value of @xmath127 is significantly different between two different mc runs and this affects the entire histogram by a multiplicative factor .",
    "the problem discussed in the previous paragraph has been addressed by the standard diag - mc method when applied to the polaron problem by using an exponential guidance function@xcite .",
    "the diag - dmc , as has been applied in the polaron problem@xcite , uses the chemical potential as a `` tunable parameter '' to reduce the above mentioned statistical variance . in this particular problem",
    ", the exact asymptotic solution for @xmath5 is a single exponential , @xmath128 , where @xmath129 is the ground state energy .",
    "therefore , using the chemical potential @xmath87 , which corresponds to multiplying @xmath5 by an exponential factor @xmath130 with @xmath87 as a tunable parameter , is effectively a simple way to make the histogram flat at long-@xmath4 .",
    "the histogram becomes flat for the polaron problem simply when we choose @xmath131 .",
    "if we use a value of @xmath87 close to @xmath129 this will improve the statistics of the diag - mc significantly .",
    "the closer the value of @xmath87 is tuned to the exact value of @xmath129 , the better the diag - mc works .",
    "therefore , in view of the present work , this works because such a guidance function makes the histogram of @xmath5 approximately flat .",
    "however , this method of using such a guidance function is inferior to the present method because of the following reasons .",
    "we do not _ a priori _ know the guidance function for more complex problems .",
    "an exponential decay of @xmath5 with a single characteristic exponent is not the general rule in interacting many - body systems . in such systems ,",
    "the general rule is that the green s function in imaginary time can be expressed as @xmath132 where @xmath133 is related to the analytic continuation of the spectral function in imaginary time .",
    "therefore , in general , we expect to need a continuum of such exponential energy scales . in most interesting systems",
    "it is not simple to extract @xmath133 by the approach of tuning different exponential factors used in ref .",
    "the method presented here , however , constructs the exact `` density of states '' , with no _ a priori _ knowledge about it .    in order to further demonstrate the power of the present method , in fig .",
    "[ fig:3 ] we present the calculated histogram of @xmath5 in a detailed mesh of 2,000 intervals ranging from 0 to 100 .",
    "this calculation took approximately 3 days of cpu time on a single 3 ghz processor .",
    "notice that the agreement with the exact solution is excellent over approximately 60 orders of magnitude !",
    "in conclusion , we have presented the fhdmc method to improve the standard diag - mc based on the idea of flat histogram methods .",
    "this idea was demonstrated on an exactly soluble problem , however , our method is very general and can be implemented for any problem where the diagrammatic mc method can be applied .",
    "we have shown with this method that the statistical fluctuations can be controlled even for very large values of the imaginary time without the need for any _ a priori _ knowledge about the behavior of @xmath5 .",
    "n. v. prokofev and b. v. svistunov , phys .",
    "lett . * 81 * , 2514 ( 1998 ) .",
    "a. s. mishchenko , n. v. prokofev , a. sakamoto , b. v. svistunov , phys .",
    "b , * 62 * , 6317 ( 2000 ) .",
    "e. burovski , n. prokofev , b. svistunov , m. troyer , phys .",
    "lett . * 96 * , 160402 ( 2006 ) .",
    "yang , e. kozik , x. wang , and m. troyer , phys .",
    "b * 83 * 214516 ( 2011 ) . n. prokofev and b. svistunov , phys . rev .",
    "b * 77 * , 020408 ( r ) ( 2008 ) . k. van houche , _ et al . _ , nature physics , * 8 * , 366 ( 2012 ) .",
    "l. pollet , n. v. prokofev , and b. v. svistunov , phys .",
    "b * 83 * , 161103 ( 2011 ) .",
    "et al . _ ,",
    "lett . * 90 * , 10004 ( 2010 ) .",
    "e. a. burovski , a. s. mishchenko , n. v. prokofev and b. v. svistunov , phys .",
    "lett . * 87 * , 186402 ( 2001 ) .",
    "s. a. kulagin , n. prokofev , o. a. starykh , b. svistunov , c. n. varney , phys .",
    "* 110 * , 070601 ( 2013 ) .",
    "s. a. kulagin , n. prokofev , o. a. starykh , b. svistunov , c. n. varney , phys .",
    "b * 87 * , 024407 ( 2013 ) .",
    "n. v. prokofev , b. svistunov , phys .",
    "* 99 * , 250201 ( 2007 ) .",
    "b. a. berg , and t. neuhaus , phys .",
    "b , * 267 * , 249 ( 1991 )",
    ". p. m. c. de oliviera _ et al .",
    "_ , j phys .",
    "* 26 * , 677 ( 1996 ) .",
    "f. wang and d. p. landau , phys .",
    "* 86 * , 2050 ( 2001 ) .",
    "m. troyer , s. wessel , and f. alet , phys .",
    "lett . * 90 * , 120201 ( 2003 ) .",
    "e. gull , a. j. millis , a. i. lichtenstein , a. n. rubstov , m. troyer , p. werner , rev .",
    "phys . * 83 * , 349 ( 2011 ) , g. li , w. werner , and a. n. rubstov , s. base , m. potthoff , phys .",
    "b * 80 * , 195118 ( 2009 ) .",
    "e. gull , ph.d .",
    "h. frhlich , h. pelzer , and s. zienau , phil . mag . * 41 * , 221 ( 1950 ) .",
    "r. p. feynman , phys .",
    "* 97 * , 660 ( 1954 ) ."
  ],
  "abstract_text": [
    "<S> the diagrammatic monte carlo ( diag - mc ) method is a numerical technique which samples the entire diagrammatic series of the green s function in quantum many - body systems . in this work , </S>",
    "<S> we incorporate the flat histogram principle in the diagrammatic monte method and we term the improved version `` flat histogram diagrammatic monte carlo '' method . </S>",
    "<S> we demonstrate the superiority of the method over the standard diag - mc in extracting the long - imaginary - time behavior of the green s function , without incorporating any _ a priori _ knowledge about this function , by applying the technique to the polaron problem . </S>"
  ]
}