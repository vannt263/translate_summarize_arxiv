{
  "article_text": [
    "the visible surface of the sun , the photosphere , has the radius @xmath1 km .",
    "the photosphere is surrounded by the solar atmosphere , which consists of two major layers .",
    "the lower layer , the chromosphere , is relatively thin .",
    "it extends up to several thousand kilometers above the photosphere . the upper layer , the corona , is a gaseous envelope with the density rapidly decreasing with the radius . depending upon the nature of the study ,",
    "a working number for size of the corona can be determined based on the coronal height where the coronal plasma becomes too tenuous to be discernible for intended purposes .",
    "the size of the corona might thus be considered to range from tens up to hundreds of the solar radii .",
    "electromagnetic rays at low frequencies in the heliosphere propagate in the regions with the plasma density lower than the critical density @xmath2 , defined as @xmath3 where @xmath4 is the electron charge , @xmath5 is the electron mass , @xmath6 is the proton mass , and @xmath7 is the radio wave frequency in rad s@xmath8 . at the critical plasma density the dielectric permittivity @xmath9 of the plasma and , hence , its index of refraction for a given frequency @xmath7 become zero .",
    "this implies that for most coronal models , radiation at frequencies @xmath10@xmath11 mhz does not penetrate to the chromosphere and travels only in the corona . at higher frequencies ,",
    "the rays with sharp angles of incidence can penetrate into the much denser and cooler chromosphere .",
    "modeling of propagation of radio frequency radiation through the solar atmosphere hence requires knowledge of both chromospheric and coronal electron density ( @xmath0 ) distributions .",
    "our method of choice for ray tracing @xcite , a fast , second order algorithm , requires smoothness in both @xmath0 and its gradient ( @xmath12 ) everywhere in the medium .",
    "the fact that chromospheric and coronal density distributions come from independent models which are not consistent at the boundary between them leads to a discontinuity in @xmath0 and @xmath12 at this boundary . though the transition between the chromosphere and the corona is intrinsically very rapid and involves rather large density gradients , the discontinuity in @xmath0 and @xmath12 is unphysical and leads to numerical instability in the ray tracing algorithm .",
    "it is therefore essential to make these distributions consistent at their interface and get them to smoothly morph from one to another while maintaining a smooth gradient .",
    "an attendant problem is the different dimensionality of the chromospheric and coronal density distributions : the former is one - dimensional , depending only on the solar radius , while the latter can be two - dimensional , depending both on the radius and ( co)latitude .    in this work",
    "we offer our solution to this problem .",
    "we use the concept of a thin _ patch _ region which encloses the chromosphere / corona interface , and which is consistent with the chromospheric and coronal models in either region .",
    "the _ patch _ is a function constructed to allow the two regions to smoothly morph into each other and accommodates the differences in their dimensionalities . in section 2",
    "we present the plasma density models and a mathematical formulation of the problem . in section 3",
    "we start with the simplest case of stitching two univariate functions .",
    "the method is developed further for the case of merging of a univariate and a multivariate functions in section 4 .",
    "the method appears to be universal enough to extend it to the problem of merging two multivariate functions along one dimension .",
    "the appropriate theory is developed in section 5 .",
    "numerical implementation details are discussed in section 6 , in particular it is shown that the suggested merging method is not computationally intensive .",
    "we came across this problem while building the formalism to implement ray tracing through the solar atmosphere at low radio frequencies .",
    "our work is motivated by the expected near term availability of high fidelity solar images from the new generation radio arrays like the murchison widefield array ( mwa ) @xcite .",
    "the early results from the 32 element mwa engineering prototype are very promising and currently represent the state of the art in high fidelity solar imaging at these frequencies @xcite .",
    "this work is of direct relevance for pursuing solar science with other new generation arrays like the low frequency array ( lofar ) @xcite and long wavelength array ( lwa ) @xcite .",
    "we hope this formulation is general enough to be applicable to similar problems in other independent contexts .",
    "there are a number of models describing the electron number density @xmath13 in the chromosphere and the corona . for the chromosphere we use the model by cillie and menzel @xcite : @xmath14 where @xmath15 is the distance from the center of sun measured in the solar radii , @xmath16 .",
    "this model is applicable for a chromosphere with a thickness of about 10,000 km , or @xmath17 .",
    "the simplest available coronal models are one dimensional in nature , depending only on the solar distance , e.g. the newkirk model @xcite : @xmath18 and the baumbach and allen model @xcite : @xmath19 where @xmath15 is the solar distance in units of @xmath16 .",
    "however , observations show that the plasma density in the corona falls faster the solar distance in the polar regions than it does in equatorial region , especially close to solar minima .",
    "this gave rise to development of more complex models .",
    "a popular one is by kuniji saito @xcite .",
    "this coronal density model depends on two variables , the spherical coordinate @xmath15 and @xmath20 , representing the radial distance from the center of the sun and the colatitude , respectively : @xmath21    ( 80,60 ) ( 10,10)(1,0)60 ( 10,10)(0,1)40 ( 30,8)(0,1)40 ( 45,8)(0,1)40 ( 65,5)@xmath15 ( 15,30)@xmath22 ( 32,30)@xmath23 ( 50,30)@xmath24 ( 30,5)@xmath25 ( 45,5)@xmath26    consider a problem of stitching together the chromospheric and coronal models described in eqs . [ newkirk ] and [ saito ] , respectively .",
    "consider a relatively thin transition layer extending from @xmath25 to @xmath26 .",
    "where @xmath25 is at the top of the chromosphere , and @xmath26 is at the bottom of the corona . for this specific problem",
    "the limits can be chosen as @xmath27 km and @xmath28 km above the photosphere .",
    "this transition layer encloses the chromosphere - corona boundary .",
    "denote the @xmath0 distribution functions in the chromosphere and the corona by @xmath22 and @xmath24 , respectively , as shown in fig .",
    "the _ patch _",
    "function , @xmath23 , defined in the transition layer between @xmath25 and @xmath26 , must match @xmath22 and @xmath24 at both its ends in both its value and derivatives .",
    "finding an appropriate @xmath23 requires ( 1 ) choosing a family of functions for @xmath23 and ( 2 ) finding its parameters to satisfy the boundary conditions for smoothness .",
    "note that @xmath22 and @xmath24 have different number of independent variables .",
    "our approach can adequately accommodate this complication , though we start by considering a simpler case of stitching two one - dimensional distributions .",
    "consider the case where both chromospheric and coronal electron number density distributions are only dependent on one variable , the radial distance @xmath15 . as",
    "shown schematically in fig .",
    "[ fig1 ] , @xmath29 , @xmath22 on the left is the cillie and menzel distribution , and @xmath30 on the right is either newkirk or baumbach distribution .",
    "we want the values of @xmath31 at @xmath25 and @xmath26 to be equal to those of the distributions on the left and right ends , respectively .",
    "also , we want the derivative of @xmath31 , denoted as @xmath32 , to take boundary values equal those of the derivatives of the distributions , @xmath33 and @xmath34 on the left and on the right , respectively . putting the boundary conditions together in one system : @xmath35    we have four equations , therefore @xmath31 must have exactly four unknown parameters to be fully determined through solving system .",
    "we also would like to have the simplest system to solve , i.e. a linear system .",
    "these considerations lead to the choice of a third order polynomial as @xmath31 , @xmath36 substitution of the polynomial into the system yields the linear system @xmath37 its solution , the vector @xmath38 , comprises the coefficients of polynomial .",
    "once these coefficients have been determined , the patch polynomial , by construction , has value and derivatives equal to those of the chromospheric distribution @xmath22 at its left end and the coronal distribution @xmath30 at its right .",
    "the system can be also written compactly in the matrix - vector form , @xmath39 where @xmath40 is the right - hand - side vector , and @xmath41 is the system matrix , @xmath42    an example of smooth stitching of the chromospheric and coronal @xmath0 distributions , given by equations and , is given in fig .",
    "we now generalize the solution to the case with a function of one variable at @xmath25 and a function of two or more variables at @xmath26 .",
    "a real - world example here is the problem of merging the model of cillie and menzel @xcite , eq .   in the chromosphere with the model of @xcite ,",
    "eq .   in the corona .",
    "the patch @xmath23 is now a function of two variables .",
    "it must smoothly match both values and derivatives of @xmath22 at its left boundary and of @xmath43 at the right boundary .",
    "note that @xmath22 has only one derivative , while @xmath43 has two partial derivatives . in order to guess the kind of a patch function we count the number of constraints ( or degrees of freedom ) imposed on the patch : two on the end point values and four on the partial derivatives at the end points , or six on total . for a completely asymmetric coronal distribution @xmath44 ,",
    "when it is a function of all the three variables , the radial distance @xmath15 , the colatitude @xmath20 , and the longitude @xmath45 , the number of conditions imposed on the patch @xmath46 becomes @xmath47 .",
    "these calculations suggest that the complexity of the patch function apparently grows with the dimensionality of the stitched functions .",
    "however , this is not the case . as we shall show here and in the next section",
    ", the patch function can be build such that it always depends only on eight parameters independent of the dimensionality of the stitched functions .",
    "the method can be used for stitching functions of arbitrary ( and different ) numbers of dimensions , along one of them .",
    "note that the patch function must gradually turn from multi - variable @xmath44 at @xmath26 into single - variable @xmath22 at @xmath25 .",
    "consider a function @xmath48 .",
    "it has its variable @xmath15 `` frozen '' at @xmath26 , so that @xmath48 is now dependent only on the two remaining variables , @xmath20 and @xmath45 .",
    "form the product of the @xmath48 and some polynomial @xmath49 , which has value of 0 at @xmath25 and 1 at @xmath26 .",
    "the function @xmath50 is not only equal to 0 at @xmath25 , its partial derivatives with respect to @xmath20 and @xmath45 also evaluate to 0 at @xmath25 , i.e. at @xmath25 it effectively depends on @xmath15 only .",
    "however , it can not be linked to @xmath22 directly because generally @xmath51 . to make such linkage possible",
    ", we add one more polynomial , @xmath52 , so the patch function takes the form",
    "@xmath53    the polynomial @xmath52 must be equal @xmath22 at @xmath25 , and must be equal zero at @xmath26 , where @xmath54 equals @xmath44 .",
    "thus , the conditions imposed on the polynpmials are @xmath55 for the multi - variable functions",
    "the boundary conditions include their partial derivatives .",
    "listing the boundary conditions as a system of equations yields : @xmath56 here we denote a partial derivative with respect to a variable by putting this variable at the subscript position after the function name , e.g. @xmath57 is the derivative of @xmath44 with respect to @xmath15 .",
    "now we simplify the system using conditions on the polynomials @xmath52 and @xmath49 : @xmath58 we can see that the first , the third , the fourth , the fifth , the seventh , and the eighth equations in are nothing but tautologies and can be removed from the system , which now takes the form @xmath59 if we for simplicity fix the @xmath52 derivatives at zero , this set of equations provides boundary conditions for the derivatives of @xmath49 , : @xmath60 we remember that there are four constraints imposed on each of the polynomials : two on their end - point values and two on their partial derivatives with respect to the stitching - dimension variable @xmath15 . therefore , both polynomials are of the @xmath61 order , have four unknown coefficients each , and require eight equations to be solved for .",
    "we have four equations in ; the other four are in . combining the both provides two linear systems that can be used to determine coefficients of the polynomials @xmath52 and @xmath49 :    @xmath62    and @xmath63",
    "one can notice that both linear systems have a nice common property , they use the same system matrix @xmath64 as used in the previous section ( see eq .   through ) .",
    "the systems and can be rewritten in the vector - matrix form as follows : @xmath65 @xmath66 where @xmath67 and @xmath68 are vectors of coefficients for the polynomials @xmath69 @xmath70    the right - hand - side vectors @xmath71 and @xmath72 are determined according to and : @xmath73 @xmath74    substitution of @xmath52 and @xmath49 in gives a smooth patch function to link together the @xmath75 and @xmath76 functions .    in order to test the method we stitch two distributions dependent on different number of variables , those by cillie and menzel s @xcite , eq .   and by @xcite , eq .  .",
    "the former depends only on @xmath15 , while the latter depends on @xmath15 and @xmath20 .",
    "the stitching occurs along the @xmath15 coordinate .",
    "[ fig3 ] shows three stitching cases for different colatitudes @xmath20 .",
    "this example illustrates the application of the general method described here .",
    "it is possible to generalize the one - and - multi - variable merging method to stitch together two multi - variable functions along the axis of one of the variables they have in common .",
    "for example , we may need to smoothly merge two functions , @xmath77 and @xmath44 along the @xmath15 dimension using the patch function @xmath46 over the interval @xmath78 $ ] .",
    "the patch function must have the properties of @xmath77 ( value and derivatives ) at the @xmath25 end , but on the way from @xmath25 to @xmath26 these properties must smoothly morph into being indistinguishable from @xmath44 . to build such a function ,",
    "consider two functions formed from @xmath79 and @xmath80 by `` freezing '' the @xmath15 variable : @xmath81 and @xmath48 . following the method developed in the previous section ,",
    "we introduce two polynomials , @xmath52 and @xmath49 . in the interval",
    "@xmath78 $ ] , @xmath52 should drop off from one to zero , while @xmath49 should increase from zero to one .",
    "then the function : @xmath82 will behave as desired to serve as a valid patch function .",
    "the boundary conditions imposed on the values of the polynomials @xmath52 and @xmath49 are : @xmath83 as before , we build a system of equations comprising all the boundary conditions on @xmath46 at the end points @xmath25 and @xmath26 similar to system : the values and derivatives of @xmath46 are equated to those of @xmath77 on the left and those of @xmath44 on the right . after removing the tautologies only two equations remain : @xmath84 this system of two equations has four unknowns , the derivatives of polynomials @xmath52 and @xmath49 at both ends of the interval @xmath78 $ ] . for simplicity ,",
    "we assign values of zero to @xmath85 and @xmath86 to form the system @xmath87 combining conditions on the polynomials @xmath52 and @xmath49 from and we build two linear systems :    @xmath88    and @xmath89 there are four constraints imposed on each of the polynomials , two on the end - point values and two on the partial derivatives with respect to @xmath15",
    ". both polynomials are cubic , like and .",
    "we already have eight equations to solve for the eight coefficients of @xmath52 and @xmath49 .",
    "both system have the same system matrix @xmath64 , given in , and can be compactly written in the matrix - vector form as shown in and . the right - hand - side vectors for systems and are @xmath90 @xmath91    thus @xmath52 and @xmath49 are successfully found . the patch function with these polynomials as coefficients smoothly stitches together the two functions , @xmath77 and @xmath44 , along the @xmath15 dimension on the interval @xmath78 $ ] .",
    "note that the method for stitching of two multivariable functions is not more complex than the method for stitching a single - variable function with a multivariable function from the previous section .",
    "so far we considered merging of the functions defined over real , three - dimensional space with the same set of independent variables .",
    "however , using patch function in the form given in and the procedure described in this section it is easy to show that the merged functions can have arbitrary numbers of variables , and even different numbers of variables . having at least one variable in common is the only requirement .    consider a more general example .",
    "suppose two functions defined in eight - dimensional space , @xmath92 and @xmath93 need to be smoothly merged along the @xmath94 dimension over the interval @xmath95 $ ] .",
    "the two functions have different sets of independent variables with non - empty intersection having @xmath94 as its element .",
    "the patch function must be dependent on the union of the both sets of variables .",
    "it is defined in the form @xmath96",
    "following the reasoning from the previous sections we can show that the cubic polynomials @xmath97 and @xmath98 can be determined through solving the linear systems and with the right hand side vectors @xmath99 @xmath100",
    "the method of stitching two functions along one dimension described here was developed in context of numerical simulations , which need to be optimized for computational efficiency and speed .",
    "if both chromospheric and coronal electron number density distributions depend only on the distance from the sun center @xmath15 , the four coefficients of patch polynomial can be calculated at the initialisation step . during the simulation",
    "there is no need to solve system ; only the polynomial values need to be calculated . for example , in the ray tracing application this only happens when the ray enters the transition layer between the chromosphere and the corona .",
    "therefore , the computational overhead of the stitching is relatively small .    in more complex cases of",
    "spherically non - symmetric coronal distributions like that by saito , the linear system must be solved at every step when the ray happens to travel inside the transition layer .",
    "this is required because the @xmath101 vector now depends on the @xmath20 ( and probably @xmath45 ) variables , whose values may change from one step to the next . here",
    "are a few tips to accelerate the computations .",
    "the fact that both linear systems have the same system matrix @xmath64 , is one of the benefits of the method . @xmath64",
    "only depends on the values of @xmath25 and @xmath26 ( i.e. boundaries of the transition layer ) , which are usually held constant during the course of computations .",
    "this makes it possible to calculate @xmath64 once and for all before the actual raytracing starts . to save even more time one can replace the linear system solving with matrix - vector multiplying . to do so , @xmath102",
    ", must be calculated during the initialization phase .",
    "the vector @xmath103 of polynomial coefficients must also be pre - calculated as the product of the matrix @xmath102 and the vector @xmath104 : @xmath105 then , in the process of ray tracing , only the coefficients of the polynomial @xmath49 ( see ) must be calculated as @xmath106 and followed by computing the patch function itself .",
    "adopting this scheme makes computations significantly faster .",
    "note , however , that in case of stitching two three - variable functions both operations , and , must be repeated at every ray tracing step .    in the previous section",
    "it is shown that this approach to stitching multi - variate functions is not limited to the three - dimensional cases .",
    "it is general enough to be applied to abstract functions of any number of independent variables , while retaining its simplicity . for any number of dimensions only eight parameters ,",
    "the coefficients of the @xmath61 order polynomials @xmath52 and @xmath49 need to be determined .",
    "the method developed here is intended for smooth merging of the electron number density model distributions at the boundary between the solar corona and chromosphere . used extensively in our coronal radio propagation studies , the method has shown excellent results .",
    "we have also shown that the method can easily be generalized to the problems where two abstract functions of arbitrary variable numbers need to be smoothly stitched along one common dimension .",
    "this work was partially supported under grants from the national science foundation , division of astronomical sciences and atomspheric and geospace sciences to the mit haystack observatory .",
    "oberoi , d. et al .",
    ", 2011 , first spectroscopic imaging observations of the sun at low radio frequencies with the murchison widefield array prototype , _ apj _ , * 728 * , l27 benkevitch , l. , sokolov , i. , oberoi , d. , & zurbuchen , t. 2010 , algorithm for tracing radio rays in solar corona and chromosphere , arxiv:1006.5635v3 lonsdale , c.  j. et al . , 2009 ,",
    "the murchison widefield array : design overview , _ proc .",
    "ieee _ ,  * 97 * , 1497 ellingson , s. w. et al . , 2009 , the long wavelength array , _ proc ieee _ , *",
    "97 * , 1421 de vos , m. , gunst , a. w. , nijboer , r. , 2009 , the lofar telescope : system architecture and signal processing , _ proc .",
    "ieee _ , * 97 * , 1431 k. saito , 1970 , a non - spherical axisymmetric model of the solar k corona of the minimum type , _ ann .",
    "tokyo astron .",
    "_ , second ser",
    "* 12 * , 53 - 120 g. newkirk , jr . , 1961 , the solar corona in active regions and the thermal origin of the slowly varying component of solar radio radiation , _ apj _ , * 133 * , 983 c. w. allen , 1947 , interpretation of electron densities from corona brightness , _ mon . not .",
    "_ , vol . * 107 * , 426 cillie , g. g. , and menzel , d. h. , 1935 , the physical state of the solar chromosphere , _ harv .",
    "_ , * 410 * , 1 - 40"
  ],
  "abstract_text": [
    "<S> the electron number density ( @xmath0 ) distributions in solar chromosphere and corona are usually described with models of different nature : exponential for the former and inverse power law for the latter . </S>",
    "<S> moreover , the model functions often have different dimensionality , e.g. the chromospheric distribution may depend solely on solar altitude , while the coronal number density may be a function of both altitude and latitude . for applications which need to consider both chromospheric and coronal models , the chromosphere - corona boundary , where these functions have different values as well as gradients , can lead to numerical problems . </S>",
    "<S> we encountered this problem in context of ray tracing through the corona at low radio frequencies , as a part of effort to prepare for the analysis of solar images from new generation radio arrays like the murchison widefield array ( mwa ) , low frequency array ( lofar ) and long wavelength array ( lwa ) . </S>",
    "<S> we have developed a solution to this problem by using a _ patch _ </S>",
    "<S> function , a thin layer between the chromosphere and the corona which matches the values and gradients of the two regions at their respective interfaces . </S>",
    "<S> we describe the method we have developed for defining this patch function to seamlessly `` stitch '' chromospheric and coronal electron density distributions , and generalize the approach to work for any arbitrary distributions of different dimensionality . </S>",
    "<S> we show that the complexity of the patch function is independent of the stitched functions dimensionalities . </S>",
    "<S> it always has eight parameters ( even four for univariate functions ) and they may be found without linear system solution for every point </S>",
    "<S> . the developed method can potentially be useful for other applications . </S>"
  ]
}