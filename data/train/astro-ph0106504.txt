{
  "article_text": [
    "we have previously described a numerical model for the galaxy encompassing primary and secondary cosmic rays , and synchrotron radiation in a common framework ( strong et al .",
    "2000 and references therein ) .",
    "up to recently our galprop code handled 2 spatial dimensions , @xmath0 , together with particle momentum @xmath1 .",
    "this was used as the basis for studies of cr reacceleration , the size of the halo , positrons , antiprotons , dark matter and the interpretation of diffuse continuum @xmath2-rays .",
    "some aspects of the problem can not be addressed in such a cylindrically symmetric model : for example the stochastic nature of the cosmic - ray sources in space and time , which is important for high - energy electrons with short cooling times , and local inhomogeneities in the gas density which can affect radioactive secondary / primary ratios .    in common with most other models",
    "it has been previously assumed that the cr source function can be taken as smooth and time - independent , an approximation justified by the long residence time ( @xmath3 years ) of cosmic - rays in the galaxy .",
    "however the inhomogeneities have observable consequences , and their inclusion is a step towards of the goal of a `` realistic '' propagation model based on galactic structure and plausible source properties .",
    "the original motivation for this extension was to study the high - energy electrons , since the observation of the @xmath4 gev excess in the egret spectrum of the galactic emission has been proposed to originate in inverse - compton emission from a hard electron spectrum ; this hypothesis can only be reconciled with the local directly - observed steep electron spectrum if there are large spatial variations which make the spectrum in our local region unrepresentative of the large - scale average .",
    "here we briefly describe an extension of the model to 3d , which can address these issues , and illustrate the results for protons . the new network and cross - sections",
    "is illustrated for b / c in the 2d case .",
    "the effect on electrons and is presented in an accompanying paper ( strong and moskalenko , ` a 3d time - dependent model for cosmic rays and @xmath2-rays ' , these proceedings : hereinafter paper ii ) .",
    "the galprop code , which solves the cr propagation equations on a grid , has been entirely rewritten in c++ using the experience gained from the original version and including both 2d and 3d spatial grid options .",
    "the 2d mode essentially duplicates the original version , with improved cross - section routines . in 3d",
    "@xmath5 the propagation is solved as before using a crank - nicolson scheme .",
    "the additional dimension considerably increases the computer resources required , but a 200 pc grid cell or finer is still practicable . as in the original version , the effects of diffusion , convection , diffusive reacceleration , and energy losses are included , each with adjustable parameters defined for a galprop run .",
    "cosmic - ray nuclear reaction networks are included with a comprehensive new cross - section database ; this allows the models to be tuned on stable and radioactive cr secondary / primary ratios , in particular b / c and @xmath6be/@xmath7be .",
    "the nuclear reaction network is built using the nuclear data sheets .",
    "the isotopic cross section database consists of more than 2000 points collected from sources published in 19691999 .",
    "this includes a critical re - evaluation of some data and cross checks .",
    "the isotopic cross sections for b / c were calculated using the authors fits to major beryllium and boron production cross sections c , n , o @xmath8 be , b .",
    "other cross sections are calculated using the semi - phenomenological approximations by @xcite ( code wnewtr.for of 1993 ) and/or silberberg and tsao ( code of 2000 ) renormalized to the data where it exists .",
    "the reaction network is solved starting at the heaviest nuclei ( i.e.  @xmath9ni ) .",
    "the propagation equation is solved , computing all the resulting secondary source functions , and then proceeds to the nuclei with @xmath10 .",
    "the procedure is repeated down to @xmath11 . in this way",
    "all secondary , tertiary etc .",
    "reactions are automatically accounted for . to be completely accurate for all isotopes , e.g.  for some rare cases of @xmath12-decay",
    ", the whole loop is repeated twice .",
    "our preliminary results for all cosmic ray species @xmath13 are given in @xcite .",
    "another major enhancement is the inclusion of stochastic snr events as sources of cosmic rays .",
    "the snr are characterized by the mean time @xmath14 between events in a 1 kpc@xmath15 unit volume , and the time @xmath16 during which an snr actively produces cr .",
    "the propagation is first carried out for a smooth distribution of sources to obtain the long timescale solution , using the fast technique described in @xcite ; then the stochastic sources are started and propagation followed for the last 10@xmath17 years or so with timesteps sufficiently fine ( e.g. , 10@xmath15 years ) to resolve the snr events and all propagation effects ( see below for more details of the method ) . for high - energy ( tev ) electrons which lose energy on timescales of 10@xmath18 years the effect is a very inhomogeneous distribution with consequences for diffuse @xmath2-rays , as shown in the accompanying paper ii .",
    "however also the protons ( and other nuclei ) show fluctuations which are strongly energy - dependent .",
    "the amplitude of the fluctuations of both electrons and nuclei depends on the parameters @xmath14 and @xmath16 .",
    "the time @xmath14 is adjusted to be consistent with estimates of the snr rate ( e.g. , dragicevich et al .",
    "1999 ) ; models for shock acceleration in snr indicate @xmath19 yr , the sources switching off when they move from the adiabatic to the radiative phase @xcite .",
    "an additional advantage of the 3 spatial dimensions is that the gas distribution ( for energy losses , secondary production and @xmath2-rays ) can be modelled in as much detail as required , based on current hi , co , fir , etc . surveys .",
    "spiral structure and local inhomogeneities can be included if required .",
    "global parameters such as the cr luminosity of the galaxy , and hence the average snr energy injection into cr , are also computed since they provide essential constraints ( see paper ii ) .",
    "since the solution in @xmath5 on a fine grid involves large arrays and many time - steps , the code has been made vectorizable so that it can benefit from the use of vector machines with a speed gain typically 100 .",
    "this is only required for the final `` stochastic snr '' part of the solution , since the `` smooth '' solution is fast enough on non - vector machines .",
    "in addition we have the option to make use of symmetry in the spatial dimension where it does not affect the application of the results ( e.g. , about @xmath20 ) .",
    "this leads to an addition large gain in speed .",
    "typical parameters are : grid size @xmath21 pc , galaxy dimension 60 kpc @xmath22 60 kpc @xmath22 4 kpc , and energy range 1 mev  1 tev on a logarithmic scale with factor 1.2.aws/aws.html ]",
    "for illustration we show results for a model with reacceleration based on @xcite , and @xmath14 = 10@xmath23 yr corresponding to a galactic rate of 3 sn / century .",
    "1 shows the distribution of protons in the galactic plane ( @xmath20 ) for a representative quadrant , at various energies .",
    "the stochastic snr source produce fluctuations , which are a minimum around 1  gev and increase at low energies due to energy losses and at high energies where the storage of particles in the galaxy is much reduced so that the effect of sources manifests itself on the distribution . note that the nature of the fluctuations is different at low and high energies .",
    "2 shows a sample of proton spectra at different @xmath24 positions ; the fluctuations are evident but much smaller than for electrons ( paper ii ) .",
    "-18 mm      -18 mm          the fluctuations in the gev nuclei will have some effect on the @xmath25-decay diffuse emission above 100 mev , but the variations will be small compared to the inverse compton component since the gev nuclei variations are much smaller than for the tev electrons responsible for gev via ic ( see paper ii ) . above 100 gev energies however the effect on the @xmath25-decay component will be larger , and should be detectable for example by the glast mission .",
    "we illustrate the new cross - sections and network with the b / c ratio ( fig .",
    "3 ) for the case of the same model ( with reacceleration ) as for electrons .",
    "more details of the application to nuclei can be found in @xcite and moskalenko et al.`new calculation of radioactive secondaries in cosmic rays ' ( these proceedings ) and to antiprotons in moskalenko et al .  `",
    "secondary antiprotons in cosmic rays ' ( these proceedings ) .",
    "this paper is intended only as an illustration of the possibilities opened up with such a 3d code . future work will concentrate on the effect of inhomogeneities in the gas distribution ( e.g. , the local bubble ) on radioactive cr nuclei , as well as implications for electrons and @xmath2-rays ."
  ],
  "abstract_text": [
    "<S> the galprop cosmic - ray ( cr ) propagation model has been extended to three dimensions including the effects of stochastic snr sources , a comprehensive cross - section database , and nuclear reaction networks . a brief description of the new code is given and some illustrative results for the distribution of cr protons presented . results for electrons and are given in an accompanying paper . </S>"
  ]
}