{
  "article_text": [
    "the watt balance , an experiment proposed by dr b. p. kibble in 1976 @xcite , is widely employed at national metrology institutes ( nmis ) for precisely measuring the planck constant @xmath1 towards the redefinition of one of the si base units , the kilogram @xcite .",
    "the new definition of the kilogram will be realized by fixing the numerical value of the planck constant @xcite , which is expected to be determined with a relative uncertainty of two parts in @xmath2 .",
    "the role of a watt balance experiment is to transfer the mass standard from the only mass in bureau international des poids et mesures ( bipm ) , i.e. , the international prototype of kilogram ( ipk ) , to a value that makes the planck constant exactly equal to @xmath3 j@xmath4s .",
    "the detailed origin , principle and recent progress of the watt balance is presented in several review papers , e.g. , @xcite . here a brief summary of the measurement is given .",
    "the watt balance is operated in two separated measurement modes , conventionally named as the weighing mode and the velocity mode . in the weighing mode ,",
    "the magnetic force produced by a coil with dc current in the magnetic field is balanced by the gravity of a test mass , and a force balance equation can be written as @xmath5 where @xmath6 denotes the magnetic flux density , @xmath7 the current in the coil , @xmath8 the wire length of the coil , @xmath9 the test mass and @xmath10 the local gravitational acceleration . in the velocity mode ,",
    "the coil moves along the vertical direction in the same magnetic field , and generates an induced voltage , i.e. @xmath11 where @xmath12 is the coil velocity and @xmath13 the induced voltage . by combining equations ( [ 1 ] ) and ( [ 2 ] )",
    ", the geometrical factor @xmath14 can be eliminated and a virtual watt balance equation is obtained as @xmath15 in equation ( [ 3 ] ) , the induced voltage @xmath13 is measured by a josephson voltage standard ( jvs ) linked to the josephson effect , i.e. @xmath16 where @xmath17 denotes a known frequency , @xmath18 the electron charge .",
    "the current @xmath7 is measured by the josephson effect in conjunction with the quantum hall effect as @xmath19 where @xmath20 is the voltage drop on a resistor @xmath21 in series with the coil , @xmath22 the known frequency , and @xmath23 an integer number .",
    "a combination of equations ( [ 3])-([5 ] ) yields the expression of the planck constant @xmath1 in the si unit as @xmath24 it has been known that all the quantities on the right side of ( [ 6 ] ) can be measured with a relative uncertainty lower than one part in @xmath25 , and therefore , on the current stage , the planck constant @xmath1 is expected to be determined by watt balances with a relative uncertainty less than @xmath26 for achieving the purpose of redefining the kilogram .    the watt balance is considered as one of the most successful experiments to precisely determine the planck constant @xmath1 and is employed in many nmis , e.g. @xcite . in order to generate a kilogram level magnetic force to balance the gravity of a mass while keep the power assumption of the coil as low as possible in the weighing mode , a strong magnetic field , e.g. 0.5 t , is required at the coil position for the watt balance .",
    "accordingly , permanent magnets with high permeability yokes are introduced to achieve the strong magnetic field .",
    "one of such magnetic systems ( shown in figure [ fig2 ] ) , developed by the bipm watt balance group @xcite , is the most preferred . in the shown magnet construction ,",
    "two permanent magnet rings with opposite magnetization poles are installed inside the inner yoke .",
    "the magnetic flux of the permanent magnet rings is guided by high permeability yokes through the air gap .",
    "as the work area of the coil , the air gap , is designed to be long and narrow , a strong magnetic field with good uniformity can be generated along the radial direction @xmath27 . as the total flux through the air gap",
    "is roughly a constant , the magnetic flux density along the radial direction , @xmath28 , decays along @xmath27 direction following an approximative @xmath29 relation . in a @xmath29 magnetic field",
    ", it can be proved that the @xmath14 of the coil is a constant , independent to any coil deformation or horizontal displacements @xcite .",
    "as the magnetic flux is closed with yokes , the shown watt balance magnet has a good feature of self shielding , lowing additional flux exchange between inside and outside of the magnet .",
    "based on these advantages , the shown magnet has been widely adopted by other nmis , such as the federal institute of metrology ( metas ) , switzerland @xcite , the national institute of standards and technology ( nist ) , usa @xcite , the measurement standards laboratory ( msl ) , new zealand @xcite and the korea research institute of standards and science ( kriss ) , south korea @xcite .        in reality , since the air gap length is finite and hence the @xmath29 decay of the magnetic field @xmath28 is not true over the whole vertical range , i.e. , the fringe effect will introduce a vertical magnetic component @xmath30 at any coil positions where @xmath31 .",
    "this fact indicates that the unknown magnetic field component can cause alignment problems @xcite , e.g. , the vertical magnetic field component can exert undesired radial force or torque in the weighing mode and could produce additional voltage in the velocity mode . considering a strict requirement of measurement accuracy in watt balances ,",
    "any aspect may bring a systematic error should be carefully analyzed .",
    "an accurate 3d mapping of the magnetic field in the air gap is a useful tool to provide important information on systematic error elimination .",
    "at least three benefits will be created by a full air gap 3d magnetic field mapping .",
    "the first is the misalignment error relaxation : the value of geometrical factor @xmath14 in equations ( [ 1 ] ) and ( [ 2 ] ) can be actually affected by parasitic coil motions when the fringe field is considered .",
    "this misalignment error can be corrected if the 3d magnetic field profile is obtained , which in theory can relax the alignment requirement of a watt balance .",
    "the second benefit is that with knowing a full field profile , a best coil diameter can be chosen in order to employ the maximum flat @xmath0 profile in the air gap , and a flat @xmath0 profile can reduce uncertainties in both velocity and voltage measurements .",
    "thirdly , the damping of the coil is usually applied in the breath between weighing and velocity sweeps . during the breath ,",
    "the damping device is either at the top or the bottom of the air gap , where a coupling between the damping current and both magnetic components ( the radial magnetic field @xmath32 and vertical magnetic field @xmath30 ) should be considered . in this case",
    ", the 3d magnetic field can supply better feedback to the current parameters for simultaneously damping all dimensional motions of the coil .",
    "as is mentioned in @xcite , the narrow air gap makes it difficult to directly measure the global magnetic field profiles .",
    "only profiles of the radial magnetic flux density along the vertical direction , @xmath0 , can be precisely measured by either a high resolution magnetic probe or the gradient coil ( gc ) method @xcite .",
    "a polynomial estimation algorithm based on at least two measurements of @xmath0 profiles has been developed in @xcite to calculate the global magnetic field in the air gap .",
    "the algorithm essentially approximates the magnetic field lines by a polynomial fitting and the approximation precision depends on the fitting order , i.e. the quantities of the measured @xmath0 .",
    "a higher accuracy requires more @xmath0 profile measurements , which in reality is difficult to be done at different radii of the narrow air gap . besides",
    ", the algorithm presented in @xcite would be much more complicated when the estimator order @xmath33 increases , e.g. , @xmath34 .",
    "we later noticed the information in measured @xmath0 is not fully utilized in the polynomial estimation algorithm , and hence in theory it is possible to develop an analytical algorithm based on only one @xmath0 measurement . this motivation leads to an improved analytical algorithm to map the 3d magnetic field in the air gap region , which has been presented in this article .",
    "the new algorithm is based on fundamental electromagnetic natures of the magnet and has advantages in both convenience and accuracy .",
    "the rest of this paper is organized as following . in section [ sec2 ] ,",
    "the new analytical algorithm is presented . in section [ sec3 ] ,",
    "numerical simulations are employed to verify the accuracy of the analytical algorithm .",
    "some discussions on the watt balance magnet design are shown in section [ sec4 ] and a conclusion is drawn in section [ sec5 ] .",
    "a detailed dimension of the air gap in the watt balance magnet is shown in figure [ fig3 ] .",
    "the area @xmath35 , @xmath36 is our model region where @xmath37 and @xmath38 is the inner and outer radii of the air gap and @xmath39 is a half of the air gap height .",
    "the radial magnetic flux density along the vertical direction @xmath40 , or the radial magnetic field along the vertical direction @xmath41 , can be measured by a gc or a magnetic probe at the radial coordinate @xmath42 .",
    "is measured at the horizontal coordinate @xmath42 ( the green line).,scaledwidth=40.0% ]    in the analysis , the magnetic scalar potential @xmath43 is chosen as a quantity to be solved .",
    "the magnetic field @xmath44 can be expressed as the negative gradient of the magnetic scalar potential , i.e. , @xmath45 .",
    "@xmath44 is the sum of two components in an axisymmetrical coordinate system as @xmath46 where @xmath47 and @xmath48 denote the unit vectors in the @xmath27 and @xmath49 directions ; @xmath50 and @xmath51 are two components of the magnetic field in @xmath27 and @xmath49 directions . as @xmath45 , equation ( [ eq1 ] ) can also be written as @xmath52 the magnetic scalar potential @xmath43 in the air gap area , i.e. @xmath53 ( @xmath37 , @xmath38 ) , @xmath54 ( @xmath55 , @xmath39 ) , can be described by the laplace s equation as @xmath56 the separation of variables is applied to solve equation ( [ eq2 ] ) . in this case , the magnetic scalar potential @xmath43 is supposed to be expressed as the product of two independent functions @xmath57 and @xmath58 , where @xmath57 and @xmath58 are functions of a single variable , i.e. @xmath27 and @xmath49 . substituting @xmath59 into equation ( [ eq2 ] ) yields @xmath60    since",
    "the two terms on the left side of equation ( [ sep_vars ] ) are independent in dimension , equation ( [ sep_vars ] ) can be written as @xmath61 where @xmath62 is a constant .",
    "note that the solution form of equation ( [ sep_vars ] ) will be determined by the sign of @xmath62 .",
    "when @xmath63 , the solution can be written as @xmath64 where @xmath65 , @xmath6 , @xmath66 and @xmath67 are constants .",
    "when @xmath68 ( e.g. @xmath69 ) , the solution can be obtained as @xmath70 \\left[{{c_1}{j_0}(\\lambda r ) + { d_1}{y_0}(\\lambda r ) } \\right ] , \\end{array}\\ ] ] where @xmath71 and @xmath72 denote hyperbolic cosine function and hyperbolic sine function ; @xmath73 and @xmath74 are the zeroth order bessel functions of the first and second kinds , @xmath75 , @xmath76 , @xmath77 , @xmath78 and @xmath79 are all constants . when @xmath80 ( e.g. @xmath81 ) , the solution can be written as @xmath82 \\left [ { { c_2}{i_0}(\\rho r ) + { d_2}{k_0}(\\rho r ) } \\right ] , \\end{array}\\ ] ] where @xmath83 and @xmath84 denote the zeroth order modified bessel functions of the first and second kinds , @xmath85 , @xmath86 , @xmath87 , @xmath88 and @xmath89 are all constants .    the general solution of equation ( [ sep_vars ] ) is the linear combination of @xmath90 , @xmath91 and @xmath92 , i.e. @xmath93 \\left[c_{1n}j_0(\\lambda_n r)+d_{1n}y_0(\\lambda_n r)\\right]\\\\ + \\sum\\limits_{n=1}^{\\infty}\\left[a_{2n}\\cos ( \\rho_n z)+b_{2n}\\sin ( \\rho_n z)\\right ] \\left[c_{2n}i_0(\\rho_n r)+d_{2n}k_0(\\rho_n r)\\right ] .",
    "\\label{eq.general } \\end{array}\\end{aligned}\\ ] ] based on equations ( [ eq1.1 ] ) and ( [ eq.general ] ) , the vertical magnetic field component @xmath51 can be expressed as @xmath94 \\left[c_{1n}j_0(\\lambda_n r)+d_{1n}y_0(\\lambda_n r)\\right]\\\\ + \\sum\\limits_{n=1}^{\\infty}\\rho_n\\left[a_{2n}\\sin ( \\rho_n z)-b_{2n}\\cos ( \\rho_n z)\\right ] \\left[c_{2n}i_0(\\rho_n r)+d_{2n}k_0(\\rho_n r)\\right ] .",
    "\\label{eq4 } \\end{array}\\end{aligned}\\ ] ]    since the yoke permeability in the presented watt balance magnet is very high , two yoke - air boundaries , i.e. @xmath95 and @xmath96 , can be considered as equipotential surfaces . as a result",
    ", the vertical magnetic field along the vertical direction should be zero at both @xmath95 and @xmath96 , i.e. , @xmath97 . using this boundary condition ,",
    "the following equations are established , i.e. @xmath98    @xmath99    and @xmath100    in equation ( [ eq.condition11 ] ) , since @xmath101 is a function of monotonicity where @xmath102 , we have @xmath103 when @xmath104 , and hence @xmath105 . in equation ( [ eq.condition12 ] )",
    ", we can set @xmath106 and @xmath107 to ensure the condition , i.e. , @xmath108 , to be always satisfied . in this case , @xmath109 should be set to values to establish another condition , i.e. @xmath110 . in equation ( [ eq.condition13 ] ) , because @xmath111 is a monotone increasing function while @xmath112 is a monotone decreasing function , we have @xmath113 and @xmath114 .",
    "therefore , @xmath115 and @xmath116 is obtained .",
    "the distribution of @xmath43 is symmetrical about the line @xmath121 and thus the odd symmetrical function @xmath122 should be removed from the expression of @xmath43",
    ". then equation ( [ eq.after_condition3 ] ) is reduced to @xmath123 .",
    "\\label{eq.after_condition2 } \\end{array}\\ ] ]    using the measured profile @xmath124 , the remaining unknown constants in equation ( [ eq.after_condition2 ] ) can be solved .",
    "based on equations ( [ eq1 ] ) and ( [ eq.after_condition2 ] ) , @xmath124 can be written as @xmath125\\\\ \\displaystyle = c'+\\sum\\limits_{n=1}^{\\infty}a'_n \\cosh(\\lambda_n z ) , \\label{eq.compare1 } \\end{array}\\end{aligned}\\ ] ] where @xmath126 and @xmath127 denote the first order bessel functions of the first and second kinds ; @xmath128 ; @xmath129 $ ] ( @xmath130 ) .",
    "for convenience of expression , we can set @xmath131 and @xmath132 , and then @xmath133 . as a result , equation ( [ eq.compare1 ] ) can be expressed as @xmath134    the values of @xmath135 can be obtained by expanding @xmath41 in forms of @xmath136 .",
    "however , the implementation process is complicated because of the non - orthogonality of the base functions @xmath136 , i.e. @xmath137 where @xmath138 is defined as the inner product of two functions @xmath139 and @xmath140 . to reduce the complexity due to the non - orthogonality , in this paper",
    ", the process of obtaining @xmath135 is as follows : first , the base functions @xmath136 are transformed into orthogonal normalized base functions @xmath141 , then @xmath41 is expanded in forms of @xmath141 in a convenient way , and finally base functions @xmath141 are replaced with @xmath136 . in this way , @xmath41 can be easily expanded in forms of @xmath136 and hence @xmath135 is obtained .    to practise the above idea , here",
    "the gram - schmidt orthogonalization procedure is employed to transform @xmath136 into orthogonal normalized base functions @xmath141 .",
    "the definition of the norm of function @xmath139 is expressed as @xmath142 then base functions @xmath136 are orthogonalized and normalized through a recursion formula , expressed as @xmath143 in recursion formula ( [ eq.orthogonal_2 ] ) the inner product @xmath144 when @xmath145 and @xmath146 when @xmath147 .",
    "after the orthogonalization and normalization procedure , @xmath41 can be expanded in forms of @xmath141 , i.e. @xmath148 where the coefficient @xmath149 can be calculated by solving the inner product of @xmath41 and @xmath141 , because @xmath150    the last step of obtaining @xmath135 is replacing @xmath141 in equation ( [ eq.orthogonal_3 ] ) with @xmath151 , and thus @xmath141 should be solved by expressing it with combinations of @xmath136 .",
    "the relation between @xmath136 and @xmath141 has been shown in recursion formula ( [ eq.orthogonal_2 ] ) .",
    "it is found difficult to directly express @xmath141 as a linear combination of @xmath136 , but instead it is easy to write @xmath136 as a linear combination of @xmath141 , i.e. @xmath152 where @xmath153 , @xmath154 and @xmath155 are constants that have been solved in equation ( [ eq.orthogonal_2 ] ) . setting @xmath156 and @xmath157 as column vectors as @xmath158 equation ( [ eq.orthogonal_6 ] ) can be written as the product of a matrix and the column vector @xmath159 , i.e. @xmath160 where @xmath161 denotes a lower triangular matrix , i.e. @xmath162 based on equation ( [ matrix1 ] ) , @xmath141 can be solved as the linear combination of @xmath136 , i.e. @xmath163 where @xmath164 denotes the element on line numbered @xmath165 column numbered @xmath166 of @xmath167 , the inverse of the matrix @xmath168 . knowing the @xmath141 expression with a linear combination of @xmath136 , the unknown constants @xmath135 in equation ( [ eq.compare11 ] ) can be solved .",
    "replacing @xmath141 in equation ( [ eq.orthogonal_3 ] ) with equation ( [ ex ] ) , @xmath41 is written as the combination of @xmath136 , i.e. @xmath169\\\\ = \\sum\\limits_{i=0}^{\\infty}\\big[\\sum\\limits_{n=0}^{\\infty}f_n\\mathbf{m}^{-1}(n , i)\\big]\\cosh(\\lambda_i z)\\\\ = \\sum\\limits_{n=0}^{\\infty}\\big[\\sum\\limits_{i=0}^{\\infty}f_i\\mathbf{m}^{-1}(i , n)\\big]\\cosh(\\lambda_n z ) , \\label{eq.compare2 } \\end{array}\\end{aligned}\\ ] ] comparing equations ( [ eq.compare11 ] ) and ( [ eq.compare2 ] ) , @xmath135 is solved as @xmath170 accordingly , the constant @xmath66 in equation ( [ eq.compare1 ] ) is calculated as @xmath171 , \\label{eq.c } \\end{array}\\end{aligned}\\ ] ] and @xmath172 in equation ( [ eq.compare1 ] ) is solved as @xmath173}\\\\ \\displaystyle=\\frac{\\sum\\limits_{i=0}^{\\infty}f_i\\mathbf{m}^{-1}(i , n)}{\\lambda_n\\left[j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0)\\right]}. \\label{eq.a1n } \\end{array}\\end{aligned}\\ ] ] by a combination of equations ( [ eq.after_condition2 ] ) , ( [ eq.c ] ) and ( [ eq.a1n ] ) , the magnetic scalar potential @xmath43 is obtained as @xmath174(\\ln r-\\ln b)\\\\ + \\sum\\limits_{n=1}^{\\infty}\\left[\\sum\\limits_{i=0}^{\\infty}f_i\\mathbf{m}^{-1}(i , n)\\right ] \\displaystyle\\frac{\\cosh ( \\lambda_n z)[j_0(\\lambda_n r)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_0(\\lambda_n r)]}{\\lambda_n\\left[j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0)\\right]}. \\label{eq.solution } \\end{array}\\end{aligned}\\ ] ] based on equation ( [ eq1 ] ) , the two magnetic field components @xmath51 and @xmath50 can be calculated respectively as @xmath175 \\displaystyle\\frac{\\sinh ( \\lambda_n z)\\left[j_0(\\lambda_n r)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_0(\\lambda_n r)\\right]}{j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0 ) } , \\label{eq.hz1 } \\end{array}\\ ] ] and @xmath176 \\displaystyle\\frac{\\cosh ( \\lambda_n z)\\left[j_1(\\lambda_n r)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r)\\right]}{j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0)}. \\label{eq.hr1 } \\end{array}\\end{aligned}\\ ] ]    it can be proved that the magnetic field solutions obtained in equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) are unique . the proof of the uniqueness theorem is attached in the appendix .",
    "over @xmath79 ( the blue curve ) and the horizontal axis ( the red curve).,scaledwidth=55.0% ]    in order to evaluate the analytical algorithm accuracy , numerical simulations based on the finite element method ( fem ) are performed . in these fem simulations ,",
    "the parameters are set close to a 1:1 real watt balance magnet : @xmath37 , @xmath38 , @xmath39 and @xmath42 are set as @xmath177 mm , @xmath178 mm , @xmath179 mm and @xmath180 mm respectively ; the relative permeability of the yoke is set as @xmath181 and the magnetic strength of the permanent magnet is set as 800kam@xmath182 in the vertical direction .    in the simulation , the magnetic flux density profile @xmath32(210 mm , @xmath49 ) is calculated by fem simulation as a known condition of the presented analytical algorithm to simulate the actual measurements of either a gc coil or a magnetic probe .",
    "note that in reality it is impossible to calculate infinite number of terms @xmath165 in equation ( [ eq.solution ] ) , and hence the first nine @xmath109 are adopted .",
    "the solution of the magnetic scalar potential @xmath43 , accordingly , can be written as @xmath183(\\ln r-\\ln b)\\\\ + \\sum\\limits_{n=1}^{9}\\left[\\sum\\limits_{i=0}^{9}f_i\\mathbf{m}^{-1}(i , n)\\right ] \\displaystyle\\frac{\\cosh ( \\lambda_n z)[j_0(\\lambda_n r)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_0(\\lambda_n r)]}{\\lambda_n\\left[j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0)\\right]}. \\label{solution_4 } \\end{array}\\end{aligned}\\ ] ]    in equation ( [ solution_4 ] ) , @xmath184 , as demonstrated in solving equation ( [ eq.condition12 ] ) , should satisfy @xmath110 , and their values are calculated by a numerical method . as shown in figure [ figure2 ] , the solutions @xmath109 are the intersections of function @xmath185 and the horizontal axis .",
    "the first nine intersections are solved as @xmath186mm@xmath182 ( @xmath187 ) .",
    "as presented in equation ( [ eq.orthogonal_2 ] ) , the base functions @xmath136 are transformed into orthogonal normalized functions @xmath188 , where @xmath189 is set to @xmath190 , as it is defined in section [ sec2 ] .",
    "using equation ( [ eq.orthogonal_31 ] ) , constants @xmath191 are solved as @xmath192 the @xmath161 in this example is a @xmath193 matrix , whose elements have been calculated based on equation ( [ eq.matrix ] ) , i.e. @xmath194 the matrix @xmath195 is obtained by inversing @xmath161 , and two magnetic field components , i.e. , @xmath51 and @xmath50 , then can be solved based on equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) .    figure [ figure25 ] shows the comparison of @xmath196 results calculated by the fem simulation and the analytical equation in ( [ eq.hr1 ] ) , where @xmath197 and @xmath198 denotes the vacuum ( air ) permeability .",
    "it can be seen that the two curves agree well with each other , which indicates that the order of @xmath165 is high enough to estimate @xmath40 . in order to further check the agreement with different numbers of @xmath165 , a relative fit error @xmath199 is defined , i.e. @xmath200 where @xmath201 is the measurement magnetic flux density , @xmath202",
    "the fit value of the magnetic flux density , and @xmath203 the average of @xmath202 , is analyzed on its decay rate over @xmath165 .",
    "the calculation result is shown in figure [ figure26 ] .",
    "it can be seen that the fit accuracy is mainly limited by the magnetic field profile measurement . when @xmath204 , the fit residual is already comparable to the sensitivity of the magnetic field measurement instruments , i.e. the accuracy of fem simulation in this case .",
    "obtained by fem simulation ( the blue curve ) and the analytical method ( the red curve).,scaledwidth=55.0% ]     over different orders @xmath165.,scaledwidth=55.0% ]    figure [ figure4 ] shows the calculation result of the 3d magnetic flux density @xmath205 and @xmath206 based on the analytical equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) . the air gap region @xmath53(200 mm , 230 mm ) , @xmath54(-50 mm , 50 mm ) , where the watt balance is conventionally operated , has been focused .",
    "the calculation result clearly shows the fringe effect : the absolute value of the vertical magnetic flux density @xmath207 increases at both vertical ends of the air gap ; the horizontal magnetic flux density component @xmath208 is also bent from the @xmath29 decay surface .    to evaluate the accuracy of the presented analytical algorithm ,",
    "some typical @xmath209 and @xmath196 curves given by fem simulation and the analytical equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) are compared in figure [ figure3 ] .",
    "it can be seen that the calculation obtained by the analytical algorithm agrees very well with that simulated by fem . for a full view of the field difference of fem and the analytical algorithm ,",
    "the differential maps of @xmath207 and @xmath208 are calculated in the air gap region @xmath53(200 mm , 230 mm ) , @xmath54(-50 mm , 50 mm ) and the calculation results are shown in figure [ figure5 ] .    .",
    "( b ) magnetic flux density distribution of @xmath208 .",
    ", scaledwidth=90.0% ]     and @xmath196 curves obtained by the analytical method and fem .",
    "the blue curves are obtained by fem simulation and the red curves are calculated by the analytical method .",
    "( a ) the @xmath209 curves , which from top to bottom are presented with different values of @xmath210 , i.e. 50 mm , 45 mm , 40 mm , 30 mm , 0 mm , -30 mm , -40 mm , -45 mm and -50 mm .",
    "( b ) the @xmath196 curves , which from top to bottom have different values of @xmath42 , i.e. 201 mm , 205 mm , 210 mm , 215 mm , 220 mm , 225 mm and 229mm.,scaledwidth=90.0% ]    for comparison of the two analytical algorithms , the field difference between the fem simulation and the polynomial estimation algorithm in @xcite has been also calculated with the same permeability . to quantize the comparison ,",
    "the average difference between the analytical method and the fem is defined as @xmath211 where @xmath212 is the radical index number and @xmath213 is the vertical index number ; @xmath214 is the magnetic flux density difference between the proposed analytical method and fem simulation .",
    "the polynomial estimation algorithm is adopted in its highest precision case , i.e. three different @xmath0 profiles are measured in radii @xmath215 mm , @xmath216 mm and @xmath180 mm .",
    "the average differences of the polynomial estimation algorithm are 0.0595mt for @xmath207 and 0.0894mt for @xmath208 while the average difference of the new analytical algorithm is 0.0060mt for @xmath207 and 0.0048mt for @xmath208 .",
    "the accuracy of the new analytical algorithm in this case is respectively 10 and 20 times better for @xmath207 and @xmath208 than that of the polynomial estimation algorithm .    ;",
    "( b ) the magnetic flux density error of @xmath206 .",
    "the bottom subgraphs are the calculation error between the polynomial estimation algorithm and fem simulation : ( c ) magnetic flux density error of @xmath205 ; ( d ) the magnetic flux density error of @xmath206.,scaledwidth=95.0% ]",
    "the numerical simulation in section [ sec3 ] exhibits advantages in field representation accuracy and convenience in measurement for the new analytical algorithm .",
    "it should be emphasized that the shown analytical algorithm , as well as the polynomial estimation algorithm proposed in @xcite , is based on the assumption that the normal component of the magnetic field on the air - yoke boundary strictly equals zero .",
    "however , in reality a weak normal component exists on the air - yoke boundaries duo to the finite permeability of the yoke , which creates the main part of the calculation error . for a further check , we calculated the magnetic field difference with different values of the yoke permeability .",
    "figure [ fig9 ] shows the calculation errors between the proposed analytical algorithm and fem simulation when @xmath217 and @xmath218 .",
    "it can be seen that the difference error is getting smaller when the permeability is higher .",
    "this indicates that the analytical algorithm will have better performance when applied in the watt balance magnet with high permeability , e.g. the bipm watt balance magnet .    ;",
    "( b ) the calculation error of @xmath206 .",
    "the bottom subgraphs are the calculation error map when the relative permeability is set as @xmath219 : ( c ) the calculation error of @xmath205 ; ( d ) the calculation error of @xmath206.,scaledwidth=95.0% ]    .",
    "( b ) the simulation results of @xmath220mm@xmath221 and @xmath222mm@xmath221 .",
    "@xmath223 is defined as @xmath224 where @xmath225 is the average value of @xmath0.,scaledwidth=95.0% ]    as mentioned in section [ sec1 ] , one of the main purpose for presenting the 3d magnetic field in the air gap is to find a best coil diameter for obtaining a widest @xmath0 profile . here",
    "we give a suggestion by taking the calculation in section [ sec3 ] as an example .",
    "knowing the 3d magnetic field , the coordinate @xmath226 where @xmath227 has a peak value , i.e. @xmath228\\\\ \\displaystyle\\times\\frac{\\lambda_n\\sinh ( \\lambda_n z_0)\\left[j_1(\\lambda_n r_{\\rm p})y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_{\\rm p})\\right]}{j_1(\\lambda_n r_0)y_0(\\lambda_n b)-j_0(\\lambda_n b)y_1(\\lambda_n r_0)}=0 , \\label{new } \\end{array}\\ ] ] can be solved .",
    "the calculation result of @xmath226 has been shown in figure [ figure10](a ) .",
    "it shows that for the typical watt balance magnet , a best coil radius should be smaller than the air gap center radius .",
    "if the velocity sweep range is set @xmath229 in the velocity mode , the best coil radius is calculated by means of the @xmath230 as @xmath231 for the example shown in figure [ figure10](a ) , @xmath232 mm , @xmath233 mm , and @xmath234 is calculated as 214.54 mm . by the calculation , the @xmath220mm@xmath221 should have a wider flat profile than @xmath222mm@xmath221 . to check it",
    ", we have plotted these two @xmath0 profiled in figure [ figure10](b ) by fem and the result verifies the conclusion .",
    "an analytical algorithm , employing only one measured @xmath0 , is presented for calculating the 3d magnetic field profile in watt balance magnets . compared to the polynomial estimation algorithm @xcite",
    ", the new algorithm is based on fundamental electromagnetic natures of the magnet and has significant advantages in both convenience and accuracy .",
    "it is shown that the new analytical algorithm can improve the field mapping accuracy by more than one magnitude than that of a simple polynomial estimation , which has a good potential in application of high permeability cases , e.g. , the bipm magnet .",
    "the presented work can supply necessary information for misalignment analysis and parameter determinations in watt balances .",
    "base on the study , a best coil radius , which should be designed slightly smaller than the air gap center , is suggested .",
    "the discussion shows that the accuracy of the proposed analytical algorithm is mainly limited by a finite permeability of the yoke material .",
    "therefore , a correction model of yoke permeability should be focused in a following investigation .",
    "also , in this paper the @xmath27 symmetry of the watt balance magnet is assumed , which in reality may be not true .",
    "further studies with considerations of the @xmath27 asymmetry of the magnet system may be addressed in the future .",
    "the authors would like to thank mr .",
    "xuanyu dong for advice about using the gram - schmidt orthogonalization procedure and dr qing wang at durham university , uk for language proofing .",
    "this work is supported by the national natural science foundation of china ( grant no .",
    "51507088 ) .",
    "in this appendix , the uniqueness of magnetic field solutions , i.e. , @xmath50 and @xmath51 in equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) , is proved by a reductio ad absurdum .",
    "we assume that the solution of equation ( [ eq.solution ] ) is not unique in the magnet air gap region @xmath235 , @xmath236 . without losing generality , two different solutions @xmath237 and @xmath238",
    "are supposed to satisfy the condition @xmath239 , @xmath240 and @xmath41 .",
    "based on the symmetry of the air gap , the magnetic scalar potential at @xmath241 for @xmath237 and @xmath238 , i.e. @xmath242 , @xmath243 , @xmath244 and @xmath245 , should meet @xmath246 according to the uniqueness theorem for static magnetic fields , @xmath239 , @xmath240 , @xmath242 and @xmath243 form the boundary conditions of region @xmath235 , @xmath236 and determines a unique solution of @xmath237 , which is expressed similarly as equation ( [ eq.after_condition2 ] ) , i.e. @xmath247 .",
    "\\end{array } \\label{eq.app1}\\end{aligned}\\ ] ] the unknown constants in equation ( [ eq.app1 ] ) , i.e. @xmath66 and @xmath172 , can be solved by expanding @xmath242 in forms of fundamental functions @xmath248 and @xmath249 .",
    "the solved constants are symbolized as @xmath250 and @xmath251 , and then the solution @xmath237 can be written as @xmath252 .",
    "\\label{eq.phim1 } \\end{array}\\end{aligned}\\ ] ]    similarly , @xmath238 is the unique solution with boundary conditions @xmath239 , @xmath240 , @xmath244 and @xmath245 , which can be expressed as @xmath253 .",
    "\\label{eq.phim2 } \\end{array}\\end{aligned}\\ ] ] based on equations ( [ eq1 ] ) , ( [ eq1.1 ] ) and ( [ eq.phim1 ] ) , the radial component of the magnetic field at @xmath42 , i.e. @xmath254 , can be expressed as @xmath255\\cosh ( \\lambda_n z),~~~~ \\end{array}\\end{aligned}\\ ] ] and based on equations ( [ eq1 ] ) , ( [ eq1.1 ] ) and ( [ eq.phim2 ] ) , the expression of @xmath256 is obtained as @xmath257\\cosh ( \\lambda_n z).~~~~ \\end{array}\\end{aligned}\\ ] ]    it has been supposed that both @xmath237 and @xmath238 can both satisfy the condition @xmath41 , therefore @xmath258 . as is known , a function of @xmath259 can not be expressed by linear combinations of @xmath136 where @xmath260 , thus @xmath261 and @xmath262 are established .",
    "further , based on equations ( [ eq.phim1 ] ) and ( [ eq.phim2 ] ) , we have @xmath263 obviously , equation ( [ eq.appxz ] ) and the stated assumption @xmath264 are contradictory , and hence the supposition is false and the theorem , i.e. the solution of equation ( [ eq.solution ] ) is unique , is valid .",
    "therefore @xmath50 and @xmath51 in equations ( [ eq.hz1 ] ) and ( [ eq.hr1 ] ) are the unique solutions .",
    "et al _ 2015 field representation of a watt balance magnet by partial profile measurements _ metrologia _ 445 - 453 kibble b p 1976 a measurement of the gyromagnetic ratio of the proton by the strong field method _ atomic masses and fundamental constants 5 _ pp 545 - 551"
  ],
  "abstract_text": [
    "<S> a yoke - based permanent magnet , which has been employed in many watt balances at national metrology institutes , is supposed to generate strong and uniform magnetic field in an air gap in the radial direction . </S>",
    "<S> however , in reality the fringe effect due to the finite height of the air gap will introduce an undesired vertical magnetic component to the air gap , which should either be measured or modeled towards some optimizations of the watt balance . a recent publication , i.e. , _ metrologia _ 52(4 ) 445 @xcite , presented a full field mapping method , which in theory will supply useful information for profile characterization and misalignment analysis . </S>",
    "<S> this article is an additional material of @xcite , which develops a different analytical algorithm to represent the 3d magnetic field of a watt balance magnet based on only one measurement for the radial magnetic flux density along the vertical direction , @xmath0 . </S>",
    "<S> the new algorithm is based on the electromagnetic nature of the magnet , which has a much better accuracy . </S>"
  ]
}