{
  "article_text": [
    "detection of spatial patterning is important in many domains , including molecular biology @xcite , ecology @xcite and epidemiology @xcite .",
    "spatial patterning can be identified by testing whether observed data departs from a model of spatial randomness : for instance , the homogeneous poisson process may serve as a model of spatial randomness for point process data , and deviations from poisson statistics may be used to detect spatial structure such as clustering .",
    "the ripley @xmath1 function is widely employed , along with associated @xmath2 and @xmath3 functions , to analyse deviations from homogeneous poisson statistics @xcite , since it permits tests for clustering and dispersion at multiple scales .",
    "a number of related statistics have been introduced based on the @xmath1 function to summarize such deviations ( employing either simulations or analytic approaches to evaluate the critical quantiles under poisson statistics ) , including the clustering index and degree of clustering @xcite , and a variance normalized alternative to the @xmath2 function @xcite .",
    "the above spatial statistics have been defined and applied in the context of point process , where the data to be analysed consists of a collection of points in ( typically ) euclidean 2- or 3-space : for instance , the degree of clustering has been applied to the study of the spatial distribution of individual mrna transcripts from a single gene , treated as point particles at positions inferred from fluorescent in situ hybridization ( fish ) microscopy data , whose clustered organization was shown to be dependent on the spatial aggregation of an associated rna binding protein , and necessary for asynchronous cell - cycle timing in multinucleate fungal cells @xcite .",
    "point processes can be defined as a special class of random measures , the _ counting measures _ , which assign non - negative integer values to all measurable subsets of a space .",
    "spatial statistics such as the ripley @xmath1 function can be generalized to the framework of random measures ; the @xmath1 function generalizes directly to the _ reduced second moment measure _ @xcite , which can be defined for stationary random measures taking either discrete values ( counting measures ) or continuous values .",
    "further , the concept of spatial randomness can be generalized , leading to the class of _ completely spatially random _ ( csr ) _ measures _ , which includes the homogenous poisson processes as a subclass ( those which are simultaneously counting measures and csr ) .",
    "however , while such generalizations appear to enable the treatment of more general kinds of data , for instance continuous measurements which can be modeled as samples from a random measure , spatial statistics such as those above are rarely applied outside the point process context .",
    "problems which arise in straightforwardly applying similar techniques to other kinds of data include choosing a general estimator for the @xmath1 function , and determining a method to evaluate the necessary critical quantiles either by simulations or analytically for a general class of csr null hypotheses .",
    "unlike the homogeneous poisson processes , which can be parameterized by a single intensity parameter , the class of all csr random measures has a more complex structure , as characterized in @xcite .",
    "in addition to the homogeneous poisson processes , further subclasses of csr random measures include gamma processes , and sum measures associated with marked poisson processes ( referred to as mark sum poisson processes below ) .",
    "we propose here a general approach to @xmath1 function - based statistical tests in the context of arbitrary random measures .",
    "we provide a consistent convolution estimator for the @xmath1 function based on the approach of @xcite , and investigate a number of ways in which the critical quantiles of the clustering index and degree of clustering estimators can be estimated for various classes of null model .",
    "first , we consider null hypotheses in the classes of gamma processes and mark sum poisson processes , and show how to fit these models to data and draw samples to simulate csr in each case , providing an expectation - maximization ( em ) algorithm to fit the marked poisson process .",
    "further , we derive an exact permutation - based estimator for the clustering index , which provides a general test against the null hypothesis class of all csr measures .",
    "we show that our permutation test using the convolution - based estimator reduces to the clustering index estimator used by lee et .",
    "for the point process case @xcite , and hence provides a further rationale for the _ conditionality principle _ discussed in @xcite , which circumvents model fitting in the homogeneous poisson case by fixing the number of points across simulations .",
    "an advantage of adopting a general random measure based approach to identification of spatial patterning is that it provides a unifying framework in which statistics and indicators can be compared when analysing diverse data types .",
    "it also has the potential to provide a unifying framework for the modeling and inference of spatially distributed regulatory networks ( at both inter- and intra - cellular levels ) as diverse kinds of spatial omics data become available @xcite .",
    "random measures have emerged in a variety of areas of machine learning as a robust general framework for modeling diverse kinds of data , while avoiding the need to make arbitrary assumptions about the parametrization of distributions , particularly in context of bayesian non - parametric approaches ( see @xcite for a general summary , and @xcite for applications in text and image processing ) .",
    "we discuss in further detail below the potential relevance of our approach and the random measure framework within the broader context of modeling spatial omics data .",
    "we begin by introducing formally the concepts of complete spatial randomness and random measures , and outline existing statistical tests for ripley s _ k _ , _ l _ and _ h _ functions , the clustering index , and degree of clustering in the point process context ( sec . [",
    "sec : prelim ] ) .",
    "we then outline our generalization of these tests to the context of arbitrary random measures , including a convolution - based estimator for the @xmath1 function , and tests against various null hypothesis classes as described above ( sec .",
    "[ sec : results1 ] ) .",
    "we assess the ability of these tests to identify spatial randomness and patterning ( clustering ) first in synthetic data ( sec .",
    "[ sec : results2 ] ) , and then apply the method to probe for patterns of clustering over time in fluorescence microscopy data from pairs of corresponding mrnas and proteins in a polarizing mouse fibroblast system ( sec .",
    "[ sec : results3 ] ) .",
    "the strong relationship between mrna and protein clustering profiles suggests that mrna localization and local translation provides a mechanism for protein localization in a number of cases , providing a small - scale demonstration of a spatial omics application .",
    "we conclude with a discussion ( sec .",
    "[ sec : discuss ] ) .",
    "a _ random measure _ can be defined on any measurable space @xmath4 , that is , a set equipped with a @xmath5-algebra . for convenience",
    ", we will assume below that @xmath4 is a euclidean space of dimension @xmath6 , ( @xmath7 ) , and that the @xmath5-algebra is @xmath8 , the collection of borel sets .",
    "borel set _ is any set that can be formed by the operations of countable union , countable intersection and relative complement from the open sets in the standard topology .",
    "a _ measure _ on @xmath9 is a mapping @xmath10 from @xmath8 to the non - negative reals with infinity , such that @xmath11 , and @xmath12 for all countable collections of disjoint sets in @xmath8 , @xmath13 .",
    "a measure is called _ locally finite _ if @xmath14 is finite whenever @xmath15 is a bounded set , and we denote the collection of all locally finite measures as @xmath16 .",
    "a _ random measure _ is then defined to be a random variable taking values in @xmath16 , and we will write @xmath17 for the random variable itself , and @xmath10 for a specific value ( measure ) taken by @xmath17 . a random measure is necessarily defined with respect to a @xmath5-algebra over @xmath16 , and all examples below will assume the @xmath5-algebra @xmath18 , which is the smallest @xmath5-algebra of subsets of @xmath16 such that all functions @xmath19 are measurable for arbitrary borel set @xmath15 .",
    "further , we will use the notation @xmath20 to denote the probability that a random measure assigns a value in @xmath21 to set @xmath15 , where @xmath21 is an open interval in @xmath22 .",
    "a random measure is _ completely random _",
    "if @xmath23 is independent of @xmath24 whenever @xmath25 .",
    "_ complete spatial randomness _ ( csr ) is a stronger property of a random measure which implies both ( a ) complete randomness , and ( b ) _ stationarity _ , @xmath26 for any displacement @xmath27 .",
    "a number of properties follow from complete spatial randomness .",
    "first , a csr measure is necessarily isotropic , and there exists a fixed _ intensity parameter _",
    "@xmath28 such that @xmath29 = \\lambda\\nu(b)$ ] , where @xmath30 is the _ lebesgue _ measure on @xmath9 , which returns the volume of @xmath15 @xcite , and @xmath31 $ ] denotes expectation .",
    "further , any csr measure over @xmath9 can be represented as a poisson process @xmath32 over @xmath33 , whose intensity measure has the form @xmath34 , where @xmath35 is a measure over @xmath22 ( with @xmath36 finite ) , @xmath37 is a non - negative real constant , and @xmath38 ( see below for notational conventions for point processes ) .",
    "this follows from the general characterization of csr measures given in @xcite ( see also @xcite ) .",
    "a consequence of this representation is that @xmath39 whenever @xmath40 and @xmath41 have equal volume , @xmath42 , so that the distribution of @xmath14 is determined only by the volume of @xmath15 .",
    "a _ point process _ can be defined as a special type of random measure for which @xmath43 with probability 1 , along with the technical condition that @xmath44 for all @xmath45 , which ensures that no two points coincide ( also called _ simplicity _ , @xcite ) .",
    "since point processes take only non - negative integer values on bounded subsets , they are also called _ counting measures_. further , since a sample @xmath10 from a point process is ( with probability 1 ) a countable subset of @xmath9 @xcite , we can use set notation and replace integrals by infinite sums in defining quantities for point processes , writing for example @xmath46 .",
    "the class of csr point processes is equivalent to the class of homogeneous poisson processes .",
    "the homogeneous poisson processes are parameterized by a single intensity parameter , @xmath28 , such that @xmath47 , where @xmath48 is the poisson probability mass function . the more general class of poisson processes ( as used in the general characterization of csr above )",
    "are completely random measures ( without stationarity ) , parameterized by an _ intensity measure _ @xmath28 such that @xmath49 @xcite .      for a stationary point process",
    ", the ripley @xmath1 function can be defined in terms of the _ reduced second moment measure _",
    "@xcite : @xmath51,\\end{aligned}\\ ] ] where @xmath52 is the origin , @xmath53 is an open ball at the origin of radius @xmath54 , and @xmath55 $ ] is the expectation under the _ palm distribution _ at the origin , which for a stationary point process can be thought of as the original process conditioned on observing a point at @xmath52 .",
    "hence , @xmath56 includes a point at @xmath52 with probability 1 , and this point is removed by taking the set difference @xmath57 when evaluating the reduced second moment measure .",
    "@xmath58 is therefore the expected number of further points observed within a radius @xmath54 of an arbitrary point ( due to stationarity ) in @xmath10 .",
    "ripley s @xmath2 and @xmath3 functions can be defined in terms of @xmath1 as : @xmath59{k(r)/\\nu(b(o , r ) ) } \\nonumber \\\\",
    "h(r ) & = & l(r ) - r.\\end{aligned}\\ ] ] which have the effect of normalizing @xmath1 so that for a homogeneous poisson processes they take the form @xmath60 and @xmath61 .    in @xcite , an estimator for @xmath1",
    "is proposed : @xmath62,\\end{aligned}\\ ] ] where @xmath63 $ ] is the iverson bracket , which is 1 when @xmath64 is true and 0 otherwise , @xmath65 is the euclidean distance , @xmath66 is the window region in which the sample @xmath10 is observed , and @xmath67 is an _ edge correction _ : @xmath68,\\end{aligned}\\ ] ] where @xmath69 is a random vector sampled from a uniform distribution over the sphere centered at the origin of radius @xmath54 .",
    "[ eq : kestimator ] is shown to be unbiased for all @xmath54 less than the diameter of @xmath70 for any convex @xmath70 @xcite .",
    "a simpler ( but biased ) estimator for @xmath1 is also commonly use @xcite , which replaces the edge correction function with the volume / area of the observed region : @xmath71.\\end{aligned}\\ ] ] the associated statistical tests introduced below are unaffected by the choice between @xmath72 and @xmath73 , and estimators for @xmath2 and @xmath3 can be straightforwardly derived from @xmath72 and @xmath73 by substituting these estimators for true values in eq .",
    "[ eq : riplh ] .    in @xcite , the _ clustering index _",
    "statistic is introduced , which is denoted @xmath0 .",
    "we provide a general expression for @xmath0 below , which provides a test for clustering or dispersion at significance level @xmath74 : @xmath75 where @xmath76 denotes the @xmath77th quantile ( @xmath78th percentile ) of @xmath79 under an appropriate simulation of csr ( unlike @xcite , we use a median instead of a mean simulation - based estimator to center @xmath80 , so that @xmath81 when @xmath82 , to avoid complications arising if the mean estimator is greater than @xmath83 or less than @xmath76 ) .",
    "@xmath0 is thus a further normalization of @xmath84 such that , for a given value of @xmath54 , @xmath85 iff @xmath86 ( and hence @xmath58 ) is significantly above the range expected under csr on a 1-sided test at level @xmath77 , providing evidence of clustering ( respectively , @xmath87 for dispersion ) at length - scale @xmath54 . by inspecting eq .",
    "[ eq : hstar ] , we see that the edge correction terms from eq .",
    "[ eq : kestimator ] will cancel in calculating @xmath0 from @xmath72 , and hence it is sufficient to use the simpler estimator @xmath73 .    to calculate @xmath83 and @xmath76",
    "it is necessary to fix a distribution for simulations appropriate for the csr null hypothesis .",
    "one possibility is to estimate the intensity parameter @xmath28 directly from @xmath10 ( @xmath88 ) , and simulate a homogeneous poisson process with this @xmath28 parameter by drawing first a poisson distributed value @xmath89 for the number of points in @xmath70 from @xmath90 for each simulation , and then distributing @xmath89 points across @xmath70 ( independently and uniformly ) .",
    "this method is termed _ parametric bootstrapping _ , as discussed in @xcite , and provides an asymptotically consistent statistical test ( as @xmath91 ) .",
    "alternatively , we may condition all simulations on the number of points observed in @xmath10 .",
    "hence , we can take advantage of the _ conditionality principle _ discussed in @xcite , whereby the distribution of points in region @xmath70 for any homogeneous poisson process is independent of @xmath28 when conditioned on @xmath89 .",
    "the points must be independently and uniformly distributed in @xmath70 regardless of @xmath28 , forming a _ binomial process _ over @xmath70 ( see @xcite ) . by conditioning on @xmath89 , we therefore derive a consistent statistical test independent of the size of @xmath70 against all csr point processes ( homogeneous poisson processes ) , which is the approach taken in @xcite .",
    "we note however that the simulations for the conditional test are no longer strictly csr , since they are simulations of a binomial process .",
    "this distinction will be important in generalizing @xmath0 .",
    "in particular , if an observation @xmath10 is quantized across @xmath70 into voxels which are small enough that the probability of two points occupying the same voxel is negligible , it is possible to view simulations of a binomial process as permutations of the voxels in @xmath70 , and derive the binomial process test as a monte - carlo approximation to an exact permutation test , as will be proposed for the general case .",
    "the options discussed above for calculating @xmath0 are summarized in algorithm [ alg1 ] , which also serves as a template for generalization below ( where @xmath92 denotes a spatially quantized observation of @xmath10 ; here , a binary indicator vector across voxels lying in an observation window @xmath70 which is 1 iff a voxel contains a point in @xmath10 ) . in @xcite , @xmath0 is further used to define the _ degree of clustering _",
    "@xmath93 , which is the area of the curve @xmath94 above @xmath95 from @xmath96 to @xmath54 , and hence serves as an indicator for the degree of departure from csr in this range .",
    "@xmath92 ( vectorized sample from point process / random measure ) , @xmath97 ( number of simulation / permutation trials ) , @xmath77 ( significance level ) calculate estimators for @xmath98 , @xmath99 and @xmath100 using @xmath92 ( eqs .",
    "[ eq : riplh ] and [ eq : kbiased ] ) .",
    "draw vectorized samples @xmath101 using one of the following methods : ( a ) ( parametric bootstrapping ) find the best fitting csr model @xmath102 for @xmath92 in chosen null hypothesis class and run @xmath97 simulations of @xmath102 , ( b ) ( conditioning ) simulate the null model @xmath97 times conditioned on the measure or point count of the whole observed region in @xmath92 , ( c ) ( permutation ) draw @xmath97 permutations of @xmath92 .",
    "calculate @xmath103 , @xmath104 and @xmath105 estimators on @xmath106 for @xmath107 ( eqs . [ eq : riplh ] and [ eq : kbiased ] ) .",
    "calculate @xmath77th , 0.5th and @xmath108th quantiles of @xmath109 for each value of @xmath54 , and use to normalize @xmath100 to calculate the clustering index , @xmath0 ( eq . [ eq : hstar ] ) . @xmath0",
    "we now consider the generalization of the statistical tests and indices above from the point process case to the general random measure case . for a stationary random measure , the _ reduced second moment measure _ @xmath50 and ripley s @xmath1 function",
    "are defined exactly as in eq .",
    "[ eq : ripk1 ] ( see @xcite , eq . 2.19 ) . the relevant _ palm distribution _ , @xmath56 , in the random measure case takes the form @xmath110 , with @xmath111 an arbitrary non - negative measurable function integrating to @xmath95 and @xmath112 ( see @xcite ) .",
    "this definition can be seen to reduce to the distribution of further points conditioned on a point at the origin for the point process case , since @xmath113 will be non - zero only for @xmath114 , regardless of @xmath115 .",
    "ripley s @xmath2 and @xmath3 functions follow directly , as in eq .",
    "[ eq : riplh ] .    to provide a general estimator for the ripley @xmath1 function",
    ", we must first specify how samples from the random measure @xmath10 are observed .",
    "we assume that we have an observation window @xmath70 , which can be partitioned into a collection of @xmath89 regular cubical voxels with sides of length @xmath116 , denoted @xmath117 , whose centres lie at @xmath118 .",
    "our observation of @xmath10 is limited to the value it takes on each voxel , hence we observe the quantities @xmath119 .",
    "we can thus alternatively represent a sample as a measure @xmath120 with atoms at @xmath121 having weights @xmath119 respectively .",
    "we now consider the estimator : @xmath122 \\phi(v_{n_1})\\phi(v_{n_2 } ) - \\bar{c } \\nonumber \\\\ & = & \\frac{1}{\\lambda^2\\nu(w)}\\int\\int [ |x - y|\\leq r ] \\bar{\\phi}(\\text{d}x)\\bar{\\phi}(\\text{d}y ) - \\bar{c } \\nonumber \\\\ \\bar{c } & = & \\frac{\\sum_{n=1 ... n } ( \\bar{\\phi}(v_n))^2}{\\lambda^2\\nu(w)}.\\end{aligned}\\ ] ] @xmath123 can be efficiently calculated using a discrete convolution , since we have : @xmath124",
    "\\bar{\\phi}(\\text{d}x)\\bar{\\phi}(\\text{d}y ) = \\int [ |x|\\leq r ] ( \\bar{\\phi } * \\bar{\\phi}^{\\prime})(x ) \\text{d}x,\\end{aligned}\\ ] ] where @xmath125 , and @xmath126 is the convolution of @xmath120 and @xmath127 when treated as functions from @xmath9 to @xmath22 , hence @xmath128 .",
    "@xmath123 is an estimator for @xmath129 in the following sense :    * proposition 1 . *",
    "_ for all values of @xmath54 , @xmath130 , where _",
    "@xmath131 \\phi(\\text{d}x)\\phi(\\text{d}y ) - c \\nonumber \\\\ c & = & \\frac{\\int_w \\phi(\\{x\\ } ) \\phi(\\text{d}x)}{\\lambda^2\\nu(w)}.\\end{aligned}\\ ] ]    * proof .",
    "* we begin by defining a function @xmath132 such that we have @xmath133 implies @xmath134 ( hence @xmath135 sends @xmath136 to the centre of the voxel to which it belongs ) .",
    "then , we can rearrange eq .",
    "[ eq : kestimatorrm2 ] as follows : @xmath137 \\bar{\\phi}(\\text{d}x)\\bar{\\phi}(\\text{d}y ) - \\bar{c } \\nonumber \\\\ & = & \\frac{1}{\\lambda^2\\nu(w)}\\int\\int \\mathbf{1}_w(x)\\mathbf{1}_w(y ) [ |v(x)-v(y)|\\leq r ] \\phi(\\text{d}x)\\phi(\\text{d}y ) - \\bar{c}.\\end{aligned}\\ ] ] by inspection , the form of eq .",
    "[ eq : kestimatorrm3 ] is identical to eq .",
    "[ eq : kestimatorrm ] with the term @xmath138 $ ] substituted for @xmath139 $ ] , and @xmath140 substituted for @xmath141 . since each voxel is a @xmath6 dimensional cube with sides of length @xmath116 , we have @xmath142 . hence , by the triangle inequality : @xmath143 for the subset of @xmath144 for which @xmath139=1 $ ] ( and similarly for @xmath145 and @xmath146 ) , this implies : @xmath147 the three subsets in eq .",
    "[ eq : sset ] correspond directly to the regions of integration for which the iverson bracket conditions in eqs .",
    "[ eq : kestimatorrm3 ] and [ eq : kestimatorrm ] are true ( @xmath148=1 $ ] ) when the three quantities in the proposition are substituted ( noting that @xmath149 ) .",
    "the proposition follows from the nested relationship between these regions of integration , the fact that @xmath10 is non - negative , and the fact that @xmath150 ( since for any voxel @xmath151 , @xmath152 ) .",
    "@xmath153    @xmath154 is related to a further estimator @xmath72 , which substitutes @xmath155 for @xmath156 in eq .",
    "[ eq : kestimatorrm ] , where @xmath157 is an edge - correction term",
    ". we can derive @xmath72 as an unbiased estimator of @xmath1 from fully observed ( not spatially quantized ) samples @xmath10 using a result in @xcite ( using their eq .",
    "10 , following theorem 1 , see appendix a for the derivation ) . for values of @xmath54 which are small compared to the diameter of @xmath70 , @xmath158 whenever @xmath139=1 $ ] , and hence @xmath159 ; hence @xmath160 provides an approximation to @xmath161 for small @xmath54 up to the bounds in prop . 1 .",
    "we note also that @xmath160 reduces ( up to spatial quantization ) to the previous estimator eq .",
    "[ eq : kbiased ] in the point process case :    * proposition 2 . *",
    "_ for a point process sample @xmath10 , for @xmath162 as in eq .",
    "[ eq : kestimatorrm2 ] we have : _ @xmath163,\\end{aligned}\\ ] ] _ where @xmath164 iff @xmath165 for a voxel @xmath151 for which there exists @xmath114 such that @xmath133 , and @xmath88 ( where @xmath166 is the number of observed points ) .",
    "additionally , we assume that the voxel width is chosen so that for no voxel @xmath167 .",
    "_    * proof .",
    "* for the point process sample @xmath10 as in the theorem ( such that the voxel width is chosen so that for no voxel @xmath167 ) , we have : @xmath168 \\bar{\\phi}(\\text{d}x)\\bar{\\phi}(\\text{d}y ) - \\frac{\\phi(w)}{\\lambda^2\\nu(w ) } \\nonumber \\\\ & = & \\frac{1}{\\lambda^2\\nu(w)}\\sum_{\\substack{\\mathbf{x},\\mathbf{y}\\in\\bar{\\phi}\\cap w } } [ d(\\mathbf{x},\\mathbf{y})\\leq r ] - \\frac{1}{\\lambda},\\end{aligned}\\ ] ] using the fact that @xmath169 implies @xmath170 , and @xmath171 .",
    "further , @xmath172 & = & \\frac{\\phi(w)}{\\lambda^2\\nu(w)}\\nonumber\\\\ & = & \\frac{1}{\\lambda},\\end{aligned}\\ ] ] and the proposition follows .",
    "@xmath153    the estimator @xmath162 can be used in algorithm [ alg1 ] as above to calculate the @xmath0 clustering index statistic for a general random measure , where @xmath92 here is identical to @xmath120 .",
    "all three options ( parametric bootstrapping , conditioning and permutation ) can be used in step 2 of the algorithm , and we consider below these options in connection with various null hypothesis classes .",
    "we begin by considering two restricted classes of csr random measures as null hypotheses , stationary _ gamma _ and _ mark sum poisson _ processes , before considering options for the class of all csr random meaures .",
    "* gamma process . *",
    "a stationary _ gamma _ process is defined as a random measure whose marginals are gamma distributed as follows : @xmath173 which is a csr measure @xcite . on the null hypothesis that @xmath10 is a sample from a gamma process , @xmath119 will be distributed according to @xmath174 , assuming for simplicity @xmath175 ( the voxel sides are unit length ) and hence @xmath176 for all voxels .",
    "the parameters @xmath177 and @xmath178 can thus be set directly by fitting a gamma distribution to @xmath119 by maximum likelihood @xcite , and the resulting gamma process simulated by drawing independent identically distributed values from @xmath174 at each voxel .",
    "we note that it is also possible to simulate a gamma process using a _ stick - breaking _ algorithm , as in @xcite , which may be more efficient if the number of voxels is large , with many taking values close to zero . further ,",
    "if it is assumed that @xmath179 , it is possible to choose the conditional version of step 2 in algorithm [ alg1 ] , by first drawing @xmath89 values from @xmath180 , and normalizing to sum to @xmath166 , the observed sample total .",
    "this is equivalent to simulating a _ dirichlet process _ with intensity parameter @xmath177 , and scaling by @xmath166 , for which it is possible also to use a stick - breaking algorithm @xcite .",
    "* mark sum possion process .",
    "* a _ mark sum poisson _ process can be defined as a random measure whose marginals are distributed as : @xmath181\\cdot \\prod_m\\operatorname{poisson}(n_m|\\alpha_m\\nu(b)),\\end{aligned}\\ ] ] where @xmath182 are the _ marks _ of the process , each associated with a weight @xmath183 and intensity @xmath184 , and @xmath63 $ ] is the iverson bracket , which is 1 when @xmath64 is true and 0 otherwise .",
    "the process is so - called , since it is equivalent to attaching marks to the points in a homogeneous poisson process with intensity @xmath185 , where mark @xmath186 appears with a probability proportional to @xmath187 ( forming a _ marked poisson process _ ) , and the value @xmath14 is calculated by summing across the weights @xmath188 of the points in @xmath15 ( forming its associated _ sum measure _ ) @xcite . in this equivalent representation , each mark independently follows a homogeneous poisson processes with intensity @xmath187 , and hence it follows that eq .",
    "[ eq : mspproc ] is csr @xcite . on the null hypothesis that @xmath10 is a sample from a mark sum poisson process , @xmath119 will be distributed according to eq .",
    "[ eq : mspproc ] , assuming @xmath175 , which we call a _ weighted sum of poisson distributions_. by fixing the weights @xmath189 , it is possible to derive an expectation - maximization ( em ) algorithm to fit @xmath190 by maximum - likelihood ( see appendix b ) . having fitted the model , csr samples can be drawn by generating values @xmath191 , distributed as @xmath192 respectively , and calculating @xmath193 at each voxel .    aside from forming a broad csr measure class , mark sum poisson processes are interesting in that , in the limit of infinite marks , they form a universal representation for csr measures .",
    "this is because , as noted earlier , any csr measure @xmath10 over @xmath194 can be represented as a ( non - homogeneous ) poisson process @xmath32 over @xmath195 with intensity measure @xmath34 such that @xmath38 @xcite .",
    "as the number of marks increases , the @xmath187 s are better able to approximate the measure @xmath196 , and hence any random measure .",
    "although we considered above only the case of fitting a distribution with finite marks and fixed weights , by using a large number marks with densely and evenly sampled weights , it is therefore possible to approximate any csr measure .    *",
    "general case .",
    "* we know that , since all voxels have identical volume @xmath197 , @xmath119 are independent samples from the same distribution ( @xmath39 whenever @xmath42 ) .",
    "hence , we can use the empirical distribution of voxel values as an estimate for @xmath198 , @xmath199 , which is completely general in that the only assumption we have made is that @xmath10 is csr .",
    "we can thus approximate a simulation of csr from the ` best fitting ' csr measure ( whose marginals approach @xmath10 asymptotically ) , by generating values for new voxels in the simulation using sampling with replacement of the values @xmath119 already seen ( equivalently , sampling from the empirical distribution ) .",
    "we note that this only approximates csr , since , with probability 1 , @xmath200 takes a value in the empirical distribution , and hence the values taken by @xmath10 on any disjoint set of sub - voxels which cover a given voxel must be dependent .    if instead of sampling with replacement from the empirical distribution to generate new samples , we permute the voxel values @xmath119 ( sampling without replacement ) , @xmath166 must remain unchanged , and we can regard this as approximate sampling from the best fitting csr measure conditioned on @xmath166 .",
    "however , rather than viewing permutation as an approximate simulation of csr , it is also possible to view it in terms of an exact test against the general csr null hypothesis , based on the exchangeability of the voxels under csr .",
    "we summarize this as :    * proposition 3 .",
    "* _ algorithm [ alg1 ] with exhaustive permutation at step 2 , is an exact test for csr of an arbitrary random measure at significance level @xmath77 , in the sense that @xmath201 for an arbitrary distribution over the class of all csr measures . _",
    "* proof . * given random measure @xmath10 over @xmath9 , observation window @xmath70 and @xmath89 cubical voxels with sides of length @xmath116 partitioning @xmath70 , @xmath202 , we can construct a related random measure @xmath203 over @xmath204 such that : @xmath205\\in b'),\\end{aligned}\\ ] ] where @xmath206 $ ] denotes a vector in @xmath204 .",
    "hence , @xmath207 is the probability that @xmath10 gives a combination of values to voxels @xmath208 lying in @xmath209 , where @xmath209 is a borel set over @xmath204 .",
    "further , we introduce the _ rejection function _",
    ", @xmath210 , which takes the value @xmath95 when @xmath85 ( for a fixed @xmath54 ) using an exhaustive permutation test at step 2 of algorithm [ alg1 ] and significance level @xmath77 at step 4 , and @xmath96 otherwise .",
    "then , for any random measure : @xmath211    considering now a csr measure , by exchangeability of voxel regions , for any @xmath209 we have @xmath212 for all @xmath213 ; where @xmath214 is the set of all permutations on @xmath89 elements , and we let @xmath215)=[x_{\\pi(1)},x_{\\pi(2)}, ... ,x_{\\pi(n)}]$ ] and @xmath216 .",
    "hence , now considering the region @xmath217 , under the assumption that @xmath10 is csr , we can rewrite eq .",
    "[ eq : appd2 ] as : @xmath218 f^*(\\mathbf{x})\\phi'(\\text{d}\\mathbf{x } ) \\nonumber \\\\ & = & \\int [ \\mathbf{x}\\in r ] \\frac{f^*(\\mathbf{x})}{g(\\mathbf{x})}\\phi''(\\text{d}\\mathbf{x}),\\end{aligned}\\ ] ] where , @xmath219 and we write @xmath220 for the set @xmath221 . by definition of @xmath222 we have that for all @xmath223 : @xmath224 hence ( using @xmath225 , by definition of @xmath226 ) : @xmath227 \\frac{f^*(\\mathbf{x})}{g(\\mathbf{x})}\\phi''(\\text{d}\\mathbf{x } ) \\nonumber \\\\ & < & \\int [ \\mathbf{x}\\in r ] ( \\omega ) \\phi''(\\text{d}\\mathbf{x } ) \\nonumber\\\\ & = & \\omega.\\end{aligned}\\ ] ]    @xmath153    as mentioned , prop .",
    "3 sheds further light on the practice of fixing the number of points @xmath89 during point process simulations as in @xcite .",
    "further , we note that in practice , monte carlo sampling is typically required in place of exhaustive permutation in evaluating @xmath0 using algorithm [ alg1 ] . the main advantage of prop .",
    "3 is that it sidesteps the issues of choosing a particular csr measure or null hypothesis class , and provides a justification for methods which do not simulate csr exactly in the general case .",
    "we first test our approach on synthetically generated data , where we are interested in determining if the various forms of algorithm [ alg1 ] can distinguish between data which is known to be completely spatially random , and data which is known to contain spatial structure in the form of clustering . for synthetic csr data , we consider the gamma process and mark sum poisson process as discussed above , where the techniques used to draw samples from these processes discussed in the context of algorithm [ alg1 ] can be likewise be used to generate data for a synthetic test set",
    ". we sample @xmath177 and @xmath178 uniformly in the intervals @xmath228 $ ] and @xmath229 $ ] respectively for the gamma process ( see eq .",
    "[ eq : gammproc ] ) , and use five marks with the fixed weights @xmath230 for the mark sum poisson process ( which for convenience we also fix during testing ) while sampling @xmath187 s uniformly in the interval @xmath231 $ ] ( see eq .",
    "[ eq : mspproc ] ) .",
    "we also generate csr data from a poisson process with @xmath232 ( equivalently , a mark sum poisson process with @xmath233 , @xmath234 , @xmath235 ) .    for a simple synthetic model with spatial structure ,",
    "we use a model we describe as a _ poisson process with gaussian kernels_. this model has two parameters : @xmath28 , the intensity of an underlying poisson process @xmath236 , and @xmath5 , the standard deviation of a gaussian kernel attached to each point in @xmath236 . as a random measure",
    ", the model can be defined as follows : @xmath237 where @xmath238 is the gaussian probability density function with mean @xmath239 and diagonal covariance @xmath240 ( @xmath241 being the @xmath6 dimensional identity matrix ) .",
    "samples are drawn from this process by first drawing a sample from a poisson process with intensity @xmath28 in a large region surrounding the simulation region , and for the @xmath242th voxel in the observed area summing across the values @xmath243 , where @xmath244 is the centre of voxel @xmath242 , and @xmath223 ranges across the points from the poisson process in the enclosing region .",
    "we fix @xmath232 , and let @xmath5 take the values @xmath245 to simulate clustering at various length - scales .",
    "all processes are simulated on a 2d window of @xmath246 pixels , with five examples generated under each setting .",
    "examples from each process are shown in fig .",
    "algorithm [ alg1 ] is run in three variations on all synthetic samples , the first two using the restricted gamma and mark sum poisson process classes respectively to fit and test against in step 2 ( option ( a ) ) , and the third using the general permutation test ( option ( c ) ) .",
    "ripley @xmath1 and clustering index functions are calculated for @xmath247 pixels , hence restricting @xmath54 to relatively small values under which edge correction effects are expected to be minimized , as discussed above . in fitting the mark sum poisson process ,",
    "5 iterations of the em algorithm outlined in the methods section are used , and 20 simulations / permutations are used to estimate the 5 - 95th percentile range of @xmath86 under csr for each test sample and all algorithm variations ( @xmath248 ) .",
    "results on synthetic data as described are shown in fig .",
    "[ fig1]b . in general , all three versions of the algorithm are able to discriminate correctly between csr and clustered data . for",
    "the gamma and mark sum poisson process restricted null models , as expected , when the same class of models is used for testing and as null hypothesis , the clustering index stays well within the csr region ( fig .",
    "[ fig1]b , left and central graphs ) .",
    "however , the results also show these models to be robust as csr null hypotheses , and in each case test data from the other model and the simple poisson process also generally stay within the csr region .",
    "samples from the gamma process are marginally more dispersed when tested against the mark sum poisson null model ( fig .",
    "[ fig1]b , central graph ) , which may be due to limitations in fitting the mark sum poisson model with only five marks and the em algorithm which only achieves a local optimum . the permutation test version of the algorithm appears to be the most robust , with all csr test samples generating clustering index functions tightly located around zero ( fig .",
    "[ fig1]b , right graph ) .    with respect to the clustered data generated from the poisson process with gaussian kernels , all three algorithmic variations are generally able to detect that the data is not csr , with the clustering index breaching the + 1 line ( the median clustering index is shown for the five replications of each process , fig .",
    "[ fig1]b all graphs ) .",
    "the only exception is the mark sum poisson null model , where the clustering index for the @xmath249 process remains within the csr region , possibly indicating again difficulty in fitting the marginal distributions sufficiently to distinguish the clustering over large distances from csr ( notably the @xmath250 line is also close to csr for the mark sum poisson null model , fig .",
    "[ fig1]b central graph ) .",
    "both gamma process and permutation based variations detect clustering at all @xmath5 values . however , we note that the permutation test variation achieves a better separation of length - scales associated with the different @xmath5 values : generally the clustering index peaks earlier and returns to the csr region earlier for the lower the @xmath5 value is , while all functions have similar profiles in the gamma process case , except for @xmath250 and @xmath251 ( fig .",
    "[ fig1]b left and right graphs ; similarly , the separation pattern is not strongly observed for the mark sum poisson variation , central graph ) .",
    "this could be due to difficulties in fitting close enough gamma distributions to the marginals of these processes to distinguish fine differences in spatial patterning .",
    "in general then , the permutation test variation of algorithm [ alg1 ] is shown to be robust in its ability to distinguish csr from spatial patterning over various length - scales , and the variations using restricted classes of csr null hypotheses are not shown to offer substantial advantages even in the case that the test data is from the matching csr class for the data considered ( while the substantially similar performance of all algorithmic variations is perhaps surprising given the restrictions on the null model imposed by the gamma and mark sum poisson process variations ) .",
    "we further tested our approach by using it to probe for spatial patterning in the subcellular distributions of mrnas and proteins in a polarizing mouse fibroblast system .",
    "we used high resolution confocal microscopy to generate 3d data specifying individual mrna positions using fluorescence in situ hybridization ( fish ) followed by spot detection , and protein abundance across at a grid of voxel positions using immunofluorescence ( if ) .",
    "such data thus allows us to test the ability of our algorithm to detect spatial patterning in both point data ( mrnas ) and continuous valued data ( protein intensities ) , which can be modeled similarly as random measures .",
    "cells were grown on cross - bow shaped micropatterns in order to standardize cell morphology and internal organelle arrangement ( see @xcite ) .",
    "the cells were serum - starved for 16 hours prior to micropatterning .",
    "micropatterns were plated with fibronectin , which causes the cells to begin to polarize following adhesion .",
    "cells were then fixed in formaldehyde at various times post adhesion , and fish or if probes introduced to generate data for the distributions of four mrnas , _ arhgdia _ , _ pard3 _ , _ @xmath252-actin _ and _ gapdh _ and corresponding protein products .",
    "_ arhgdia _ and _ pard3 _ were chosen , since they have been shown previously to exhibit significant spatial patterning in fibroblasts at the mrna and protein @xcite and protein only levels @xcite respectively ; _",
    "@xmath252-actin _ is known to exhibit spatial patterning at mrna and protein levels in a variety of cell types @xcite ; and the house - keeping gene _",
    "gapdh _ is not expected to exhibit strong spatial patterning .",
    "we were particularly interested in the case of _",
    "pard3 _ to investigate whether spatial patterning could be detected at the mrna level , as had been shown the protein level previously .",
    "fish data for mrnas was collected 2 , 3 , 4 and 5 hours after micropatterning , and if protein data at 2 , 3 , 5 and 7 hours , with @xmath25340 cells imaged per mrna / protein at each of these time - points .",
    "individual micropatterned cells were imaged as separate @xmath254-stacks ( 512@xmath255512 pixels , 15 - 25 @xmath254-levels , with approximately 0.1@xmath239 m pixel width and @xmath256 m separation between @xmath254-levels ) .",
    "in addition , if tubulin staining was applied to all cells to identify the microtuble cytoskeleton , which enabled a simple cell - volume model to be constructed by identifying a 2d cell boundary and height map , and dapi staining was applied to identify the nuclear region .",
    "examples of data from each mrna and protein are shown in fig .",
    "[ fig2]a , which have been 2d projected and warped to an average micropattern shape for visualization .",
    "further details on the experimental protocol are provided in appendix c.    we applied algorithm [ alg1 ] to the 3d mrna point data , and the protein if to calculated clustering index functions and the degree of clustering ( the area of the clustering index graph above + 1 , indicating significant clustering ) from each cell individually .",
    "we applied two forms of the algorithm : in the first , we used the 3d ripley @xmath1 estimator , and applied the permutation method at step 2 to generate simulation samples , where permutations are applied to the voxels falling within the cell - volume model ; in the second , we projected the points / summed intensities into 2d and applied the ripley @xmath1 estimator in 2d , while using the empirical distribution of _ gapdh _ mrnas and proteins to simulate csr in step 2 ( independently sampling , at each pixel , a binary value or intensity for mrnas and proteins respectively from the same pixel in a _",
    "gapdh _ distribution , and normalizing the resulting sample to sum to the same total as the input sample ; this is an empirical variation on option ( b ) of step 2 ) .",
    "100 simulations / permutations are used to estimate the 5 - 95th percentile range of @xmath86 under csr for each test sample and both algorithm variations ( @xmath248 ) .",
    "the profiles for the degree of clustering across time are shown for mrnas and proteins using both versions of the algorithm in fig .",
    "cubic splines are fitted to the profiles for ease of visualization .",
    "similarity in the profiles from the two algorithmic variations are readily apparent . also visually apparent is a similarity between several of the mrna profiles and the profiles of the their protein products , particularly _",
    "arhgdia _ , _ gapdh _ and _ pard3_. to further investigate the relationship between mrna and protein profiles , we calculated the pearson correlation coefficient between pairs of mrna - protein degree of clustering profiles for each algorithm version ( matching mrna time - points 2 , 3 , 4 and 5 to protein time - points 2 , 3 , 5 and 7 respectively ) , and tested for whether the correlations between mrnas and their corresponding proteins were significantly higher than between randomly matched pairs .",
    "we found this was the case for both algorithm variations , although the difference was more pronounced for the second variant ( @xmath257 versus @xmath258 , see fig .",
    "[ fig2]c ) .",
    "the above suggests that our approach is able to identify significant aspects of spatial patterning in this system .",
    "particularly , since the proteins are observed over a longer time period than the mrnas , the similarities in profile reflect a stretching of this profile in the proteins with respect to the mrnas . plausibly , the spatial patterning at the mrna level acts as a determinant of the patterning at the protein level through processes such as local translation , although this can not be established directly from our approach .",
    "we note also that the more significant relationships observed for the second algorithmic variation may reflect the difficulties in estimating an accurate 3d cell volume model in the first version , which is required to select the voxels to be permuted in the simulations .    to probe the spatial patterning of the mrna - protein pairs further , we compared the clustering profiles of each corresponding pair individually .",
    "we were interested also in gaining information about where in the cell clustering was occurring for each pair . to this end , in addition to the correlations between clustering profiles across the whole cytoplasm as above , we calculated also the correlations between clustering profiles using the mrna and protein data restricted to a small peripheral region of the cytoplasm ( see fig .",
    "[ fig2]d ) , formed from a strip around the boundary of the cell which was 10% of the radial distance to the nucleus centroid in width ( projected across all z - slices ) , hence reflecting peripheral clustering only .",
    "we chose this region , since _",
    "arhgdia _ , _ pard3 _ , and _",
    "@xmath252-actin _ proteins are known to localize peripherally ( as is visually apparent in fig .",
    "[ fig2]a ) , while localized translation at the periphery is known to occur in the cases of _ arhgdia _ and _ @xmath252-actin _ @xcite .",
    "in both cases , we use the permutation test version of the algorithm .",
    "[ fig2]e compares the individual profile correlations in the cytoplasmic and peripheral populations for each corresponding mrna - protein pair , by z - scoring the correlation of each corresponding pair against the correlations of non - corresponding mrna - protein pairings ( see figure legend ) .",
    "we observe that the _ gapdh _ correlations are only strong when calculated across the whole cytoplasm , but disappear at the periphery .",
    "although we did not expect strong spatial patterning in either case , the correlations observed in the cytoplasm may be due to the _ gapdh _ mrnas and proteins forming diffuse large - scale regions of higher concentration in certain directions in response to polarization , which is suggested visually in the protein case ( fig .",
    "[ fig2]a ; hence using _ gapdh _ as a model of spatial randomness as above can be expected to mask clustering at such scales ) .",
    "in contrast , for both _ arhgdia _ and _ pard3 _ we observe correlated mrna - protein clustering dynamics in both the cytoplasmic and peripheral populations .",
    "this is expected in the case of _ arhgdia _ ; however , in the case of _",
    "pard3 _ , clustering at the periphery has previously been demonstrated only at the protein level in a fibroblast system @xcite .",
    "our results suggest that peripheral _ pard3 _ mrna localization is also important in this system , although as above we can not directly conclude from our data that local translation establishes the protein localization ( since the peripheral mrna and protein clusters could form independently ) .",
    "unexpectedly , _",
    "@xmath252-actin _ does not show significant correlation in the cytoplasmic or peripheral populations .",
    "we suggest that , while peripheral local translation may be occurring leading to peripheral protein clustering ( as can be seen in fig .",
    "[ fig2]a ) , since the _ @xmath252-actin _ mrna is highly dispersed we do not observe direct correlations between mrna and protein clustering ( the z - score in fig .",
    "[ fig2]e is high only if clustering occurs in both mrnas and proteins and is correlated over time , and does not indicate the strength of independent clustering in mrnas or proteins ) .",
    "we have described and analysed a general algorithm for calculating the ripley-@xmath1 derived clustering index and degree of clustering statistics in the context of arbitrary random measures .",
    "our approach generalizes the point - process - based approach in @xcite , while shedding further light on this approach and the conditionality principle noted in @xcite by analysing these statistics as permutation tests in the random measure context , using the exchangeability of elements with identical volume in the context of completely spatially random measures . through studies on synthetic data ,",
    "we compared variations of the algorithm which explicitly simulate csr using gamma process and mark sum poisson processes against the permutation approach , and found all variations were able to discriminate csr from spatial patterning ( clustering ) at various length - scales in the data used , with the permutation - based algorithm offering a marginally more robust approach .",
    "tests on fluorescence microscopy data from polarizing fibroblasts showed that the random - measure - based approach was able to identify spatial patterns in subcellular mrna and protein distributions which were significantly correlated for corresponding mrnas and protein products , hence suggesting that the patterns uncovered are biologically significant in the system and possibly reflective of mrna / protein localization mechanisms tied to local translation .",
    "we note that the random measure framework provides a useful theoretical context in which to frame problems in the spatial domain which require integration of diverse data - types , as is necessary for instance in spatially resolved omics problems @xcite . although we specifically analysed statistics based on the ripley-@xmath1 function ( providing a convolution - based estimator appropriate for the random measure context , eq .",
    "[ eq : kestimatorrm2 ] ) , similar permutation - based tests can be applied to arbitrary statistical estimators to detect other kinds of patterning in a random measure context , using the exchangeability properties of csr measures @xcite .",
    "a possible use of such tests is in identifying functionally related genes from their spatial patterning in a given system , as for instance in the studies of @xcite and @xcite .",
    "the application of our approach to a polarizing fibroblast system above provides an example of how random measures may be used in such a context .",
    "we have concentrated here on deriving statistics from individual distributions which may be correlated to identify functional relationships ; however the problem of identifying dependencies between spatial patterning across multiple distributions may be framed more generally in a random measure context , using for instance cross - correlation measures @xcite .",
    "a further possible application of random measures and related models is in the inference of spatially distributed regulatory networks .",
    "gaussian process ( gp ) models have already been applied in the context of modeling transcription factor networks , using a theoretical framework which allows models based on deterministic differential equations to be embedded in the gp covariance function for probabilistic inference @xcite , and are possibly also a suitable model for spatially distributed networks ( we note though that gps are not strictly random measures , since a function drawn from a gp may take negative values with non - zero probability , and hence can not be treated directly as a density function ) .",
    "alternatively , dynamic dirichlet and gamma process models @xcite potentially offer other attractive ways of formulating the general spatial network inference problem . within this context , random measure based statistics such as those investigated in this study may serve as evidence for or against causal relationships when combined with perturbations ( as in @xcite ) or single - cell level multiplexed data ( as in @xcite ) .",
    "the above problems may therefore benefit directly from the techniques and analysis outlined the present study , as well as offering a broad set of challenges for future work drawing on similar theoretical approaches .",
    "stoyan and ohser @xcite consider the case of a stationary _ weighted random measure_. a special case of this is a random measure over the space @xmath259 for which @xmath260 for any @xmath261 and @xmath262 ( with @xmath263 any @xmath5-algebra over @xmath22 ) . in their eq .",
    "4 , they introduce the _ reduced correlation measure _ , @xmath264 , which can be used to express the second moment measure of @xmath10 : @xmath265 where @xmath266 is the intensity of the stationary random measure @xmath267 .",
    "stoyan and ohser provide the following estimator for @xmath264 in their eq .",
    "10 , which , following their theorem 1 , is shown to be unbiased : @xmath268 any random measure over @xmath9 can be considered a weighted random measure where @xmath263 is taken to be the trivial @xmath5-algebra , @xmath269 . hence , considering the case that @xmath270 and writing @xmath14 for @xmath271 , @xmath28 for @xmath272 , and @xmath273 for what we shall call the _ reduced autocorrelation measure _",
    "( i.e. the special case of @xmath264 where @xmath274 ) , eq .",
    "[ eq : appb2 ] reduces to : @xmath275    following @xcite , we can express @xmath273 in terms of the palm distribution @xmath56 : @xmath276,\\end{aligned}\\ ] ] where @xmath110 , with @xmath111 an arbitrary non - negative measurable function integrating to @xmath95 and @xmath112 .",
    "similarly , following @xcite ( eq .",
    "2.19 ) we can express the reduced second moment measure @xmath50 as : @xmath277 \\nonumber \\\\ & = & ( 1/\\lambda)\\mathbb{e}_{p_o}[\\phi(b ) ] - ( 1/\\lambda)\\mathbb{e}_{p_o}[\\{o\\ } ] \\nonumber \\\\ & = & \\mathcal{k}_{11}(b ) - \\mathcal{k}_{11}(\\{o\\}).\\end{aligned}\\ ] ] the ripley @xmath1 function is defined in terms of the reduced second moment measure , giving : @xmath278 hence , by applying eq .",
    "[ eq : appb3 ] to each term in eq .",
    "[ eq : appb6 ] , we can form an unbiased estimator for @xmath1 as discussed in the text : @xmath279 \\phi(\\text{d}x)\\phi(\\text{d}y ) - c,\\end{aligned}\\ ] ] where @xmath280 .",
    "following eq . [ eq : mspproc ] , we can define a weighted sum of poisson distributions with components @xmath182 having weights @xmath281 and means @xmath190 by the distribution : @xmath282\\cdot \\prod_m\\operatorname{poisson}(n_m|\\alpha_m),\\end{aligned}\\ ] ] where @xmath63 $ ] is the iverson bracket , which is 1 when @xmath64 is true and 0 otherwise .",
    "we can reexpress this distribution in a form involving latent variables @xmath283 : @xmath284 or equivalently : @xmath285 \\nonumber \\\\ p(\\mathbf{z } ) & = & \\prod_m \\operatorname{poisson}(z_m;\\alpha_m)\\end{aligned}\\ ] ] where @xmath286 $ ] .",
    "the em algorithm can be applied to fit distributions involving latent variables , and maximizes the log - likelihood ( to a local optimum ) by introducing an auxiliary distribution @xmath287 over the latent variables , and alternately minimizing the kl - divergence between @xmath288 and the true marginal distribution over latent variables @xmath289 ( e - step ) , and maximizing the following lower - bound on the log - likelihood ( m - step ) ( see @xcite ) : @xmath290 where @xmath291 are the distribution parameters , and @xmath92 , @xmath292 are the observed data and a fixed setting of the latent variables respectively .",
    "we will write @xmath293 for the @xmath294th data point , and @xmath295 for the @xmath186th latent variable associated with the @xmath294th data point , for data points @xmath296 .",
    "for the weighted sum of poisson distributions , we assume that the weights @xmath189 are fixed in advance , and hence we optimize @xmath297 .",
    "further , since the distribution only places positive probability on values which can be expressed in the form @xmath298 for @xmath299 , we assume that the values @xmath300 have been rounded to the nearest such value",
    ".    * e - step . * the kl - divergence between @xmath288 and @xmath289 can be minimized by calculating the posterior distribution of @xmath301 for each data point given the current parameter settings .",
    "writing @xmath302 for the posterior @xmath303 , where @xmath304 is the current value of @xmath187 , these can be calculated as : @xmath305\\prod_m \\operatorname{poisson}(n_m;\\alpha_m)}{z},\\end{aligned}\\ ] ] where @xmath306 is a normalizing constant . since for each data point",
    "there are only finitely many latent - variable settings for which @xmath307 is non - zero ( since any for which @xmath308 will be zero ) , the values @xmath307 can be found for all @xmath309 by explicit calculation . for initialization , we set @xmath310 for an arbitrary @xmath309 such that @xmath311 $ ]",
    ". @xmath287 is found by setting @xmath312",
    ".    * m - step . * substituting eqs.[eq : latvar2 ] and [ eq : estep ] into eq .",
    "[ eq : em ] yeilds : @xmath313 where @xmath1 is the entropy of @xmath287 .",
    "[ eq : mstep1 ] can be seen to break into separate collections of terms involving each of the @xmath304 s . differentiating with respect to @xmath304 and setting to zero yields the update : @xmath314",
    "nih/3t3 mouse fibroblast cells were serum - starved for 16 hours prior to seeding on fibronectin crossbow micropatterned surfaces ( individual micropatterns approximately 25@xmath239 m in height and width ) .",
    "the cells were allowed to grow for various lengths of time ( 2 , 3 , 4 , 5 and 7 hours ) before fixing in formaldehyde , permeabilization , and hybridization of probes .",
    "rna fish probes were designed and applied using the method of @xcite , which targets multiple 20-mer oligonucleotide probes to each mrna .",
    "rabbit polyclonal anti - arghdia , anti - gapdh , anti-@xmath252-actin and anti - par3 antibodies were used for the if staining ( santa cruz and abcam ) . rat monoclonal anti - tubulin antibody ( abcam )",
    "was used for tublin staining in all cells , along with dapi for nuclear staining .",
    "images were captured on a spinning disk confocal revolution xd system ( andor ) .",
    "each cell was imaged as an individual @xmath254-stack , with each image comprising 512@xmath255512 pixels , 15 - 25 @xmath254-levels , and approximately 0.1@xmath239 m pixel width and @xmath256 m separation between @xmath254-levels .",
    "background subtraction was applied to all images using imagej ( if and fish ) , and spot detection was performed to determine mrna positions from the fish @xmath254-stacks using @xcite .",
    "2d segmentation of the nucleus region was performed by max - projecting the dapi @xmath254-stacks , thresholding the resulting images , and applying image dilation to the binary masks .",
    "2d segmentation of cellular regions was performed similarly by max - projection , thresholding and dilating the tubulin if @xmath254-stacks . to estimate a height map across the cellular region ( to construct a 3d cellular model ) , we first estimated the base @xmath254-level of the cell to be the level with the maximum total tubulin intensity ( cells adhere to micropatterned regions on a 2d surface , and thus achieve greatest spread at their base ) .",
    "we then search at each 2d location for the @xmath254-level with the max - tubulin intensity above the base level , which we observed empirically to provide a reliable indicator of the cell boundary .",
    "the final height - map was formed by smoothing the resulting surface with a 3@xmath2553 box filter .      c. lee , h. zhang , a. e. baker , p. occhipinti , m. e. borsuk , and a. s. gladfelter .",
    "protein aggregation behavior regulates cyclin transcript localization and cell - cycle control .",
    "_ developmental cell _ , 25:572 - 584 , 2013 .",
    "gatrell ac , bailey tc , diggle pj and rowlingson bs .",
    "spatial point pattern analysis and its application in geographical epidemiology .",
    "_ transactions of the institute of british geographers _ 21 : 256274 , 1996 .",
    "m. i. jordan .",
    "hierarchical models , nested models and completely random measures . in",
    "_ frontiers of statistical decision making and bayesian analysis : in honor of james o. berger _",
    ", new york : springer , 2010 .",
    "thery , m. , racine , v. , piel , m. , pepin , a. , dimitrov , a. , chen , y. , jean - baptiste , s. and bornens , m. anisotropy of cell adhesive microenvironment governs cell internal organization and orientation of polarity .",
    "_ proceedings of the national academy of sciences _ , 2006 .",
    "j. schmoranzer , j. p. fawcett , m. segura , s. tan , r. b. vallee , t. pawson , and g. g. gundersen .",
    "par3 and dynein associate to regulate local microtubule dynamics and centrosome orientation during migration .",
    "_ current biology _ , 19 ( 13 ) , 1065 - 1074 ( 2009 ) .",
    "e. lcuyer , h. yoshida , n. parthasarathy , c. alm , t. babak , t. cerovina , t. r. hughes , p. tomancak , and h. m. krause . global analysis of mrna localization reveals a prominent role in organizing cellular architecture and function . _ cell _ 131:174187 , 2007 .",
    "junker , j. p. , nol , e. s. , guryev , v. , peterson , k. a. , shah , g. , huisken , j. , mcmahon ap , berezikov e , bakkers j , and van oudenaarden , a. genome - wide rna tomography in the zebrafish embryo .",
    "_ cell _ , 159:3 , 662 - 675 , 2014 .",
    "snijder , b. , sacher , r. , rm , p. , damm , e. m. , liberali , p. and pelkmans , l. population context determines cell - to - cell variability in endocytosis and virus infection . _",
    ", 461(7263 ) , 520 - 523 , 2009"
  ],
  "abstract_text": [
    "<S> we derive generalized estimators for a number of spatial statistics that have been used in the analysis of spatially resolved omics data , such as ripley s _ k _ , _ h _ and _ l _ functions , clustering index , and degree of clustering , which allow these statistics to be calculated on data modelled by arbitrary random measures . </S>",
    "<S> our estimators generalize those typically used to calculate these statistics on point process data , allowing them to be calculated on random measures which assign continuous values to spatial regions , for instance to model protein intensity . </S>",
    "<S> the clustering index ( @xmath0 ) compares ripley s _ h _ function calculated empirically to its distribution under complete spatial randomness ( csr ) , leading us to consider csr null hypotheses for random measures which are not point - processes when generalizing this statistic . for this purpose , </S>",
    "<S> we consider restricted classes of completely random measures which can be simulated directly ( gamma processes and marked poisson processes ) , as well as the general class of all csr random measures , for which we derive an exact permutation - test based @xmath0 estimator . </S>",
    "<S> we establish several properties of the estimators we propose , including bounds on the accuracy of our general ripley _ k _ estimator , its relationship to a previous estimator for the cross - correlation measure , and the relationship of our generalized @xmath0 estimator to a number of previous statistics . </S>",
    "<S> we test the ability of our approach to identify spatial patterning on synthetic and biological data . with respect to the latter , </S>",
    "<S> we demonstrate our approach on mixed omics data , by using fluorescent in situ hybridization ( fish ) and immunofluorescence ( if ) data to probe for mrna and protein subcellular localization patterns respectively in polarizing mouse fibroblasts on micropattened cells . using the generalized clustering index and degree of clustering statistics we propose , we observe correlated patterns of clustering over time for corresponding mrnas and proteins , suggesting a deterministic effect of mrna localization on protein localization for several pairs tested , including one case in which spatial patterning at the mrna level has not been previously demonstrated .    </S>",
    "<S> = 1 </S>"
  ]
}