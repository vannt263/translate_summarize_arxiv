{
  "article_text": [
    "the cavity method , relying on the bethe approximation @xcite , was originally introduced as an alternative to the replica method to study equilibrium properties of disordered and effectively mean - field classical systems @xcite . later on it",
    "was also considered as a powerful message - passing algorithm to solve for the solutions in single instances of some computationally difficult problems @xcite .",
    "recently , we applied the method to a class of more challenging optimization problems , where the objective function itself is a computationally complex function , e.g. , the average of a minimum energy function in a stochastic optimization problem @xcite . in this study",
    "we are using these advancements to develop a message - passing algorithm for variational quantum - mechanics problems .",
    "cavity - like approaches to quantum systems differ in nature and scope : the quantum belief propagation algorithms @xcite are the quantum generalization of the classical belief propagation algorithm @xcite working with local cavity density matrices instead of the cavity marginals .",
    "the smaller the temperature is , of course , the larger the density matrices needed are as quantum correlations prevail in the system . on the other hand",
    ", the quantum cavity method @xcite maps the quantum problem to a classical one using the suzuki - trotter transformation , and then exploits the cavity method to estimate the relevant average quantities .",
    "this can be regarded as a dynamical mean - field theory extended to take the spatial correlations into account .    in this work",
    "we take another approach that merges the techniques we used in the stochastic optimization problems @xcite with the variational principles of quantum mechanics , i.e. , the fact that any trial wave function ( density matrix ) provides an upper bound for the ground - state energy ( free energy ) .",
    "alternatively , a lower bound for the free energy can be obtained by approximating the entropy with an overestimated entropy function @xcite . in both cases",
    ", the problem of finding the optimal state can be recast as an optimization problem with an objective function that evaluates the ( free ) energy of a physical state . in the rest of this paper",
    "we shall focus on the simpler problem of finding an optimal wave function , i.e. , at zero temperature .",
    "the strategy of finding the optimal wave function in a quantum system is analogous to that of finding the optimal configuration in a classical optimization problem .",
    "both the problems are , in general , computationally hard , making efficient and accurate heuristic algorithms central to the study of these problems .",
    "the quantum problem is intractable already in one dimension @xcite or for fermionic systems due to the sign problem @xcite .",
    "in addition , it is important for the efficiency of the variational method , to have a succinct representation of the trial wave functions that accurately describes the ground state of a quantum system @xcite",
    ".    in the following we shall map the quantum wave function to the gibbs state of a classical system , considering the set of couplings as the variational parameters .",
    "the first step of the algorithm is to choose an appropriate classical system that best captures the quantum nature of the original system .",
    "the minimal set of couplings is that of a classical system of isolated elements , and in the maximal set one would have the whole set of many - body interactions .",
    "the former is equivalent to the mean - field approximation and the latter to an exact treatment of the problem .",
    "however , as we will see , already the two - body interactions give a reasonable estimate of the physical quantities in a disordered quantum ising model .",
    "one may compare this with the jastrow trial wave function , which is the product of pair functions @xcite .",
    "the second step of the algorithm is to write the objective function , which is the quantum average of the hamiltonian , in terms of classical and local average quantities estimated within the replica - symmetric approximation @xcite .",
    "the quality of this approximation depends on the structure of the classical interaction graph ; it is expected to work well on random and sparse graphs , that is in effectively mean - field systems . in general , however , this approximation spoils the upper bound property of the hamiltonian expectation we started from .",
    "the third and last step of the algorithm is to find the optimal couplings and we do this by a heuristic message - passing algorithm based on the bethe approximation .    this paper is organized as follows .",
    "we start in section [ s1 ] with the variational quantum problem in its general form and write it as a classical optimization problem amenable to the cavity method . in section [ s2 ]",
    "we write the cavity equations for a quantum spin model and compare the different levels of approximations with the exact results .",
    "section [ s3 ] gives the concluding remarks .",
    "given a hamiltonian @xmath0 and a trial wave function @xmath1 , we have @xmath2 where @xmath3 is the ground - state energy of @xmath0 and @xmath4 denotes a set of parameters characterizing the trial wave function . to find the optimal parameters we define the following optimization problem : @xmath5 where eventually one is interested in the limit @xmath6 .",
    "note that @xmath7 is just the inverse of a fictitious temperature and has nothing to do with the physical temperature .",
    "assume @xmath8 , where @xmath9 is diagonal in the orthonormal basis @xmath10 ; @xmath9 and @xmath11 are hermitian operators with real eigenvalues and orthonormal eigenvectors . the trial wave function is represented in this representation as @xmath12 .",
    "the coefficients @xmath13 are complex numbers , and @xmath14 is a normalized probability distribution over @xmath15 .",
    "the average energy can be written as @xmath16,\\end{aligned}\\ ] ] where @xmath17    we are going to consider @xmath18 as a probability measure over variables @xmath15 in a classical system and compute the average energies within the bethe approximation , where the classical measure is treated as if the classical interaction graph @xmath19 is a tree .",
    "for example , in the ising model the measure is approximated by @xmath20\\right)$ ] , given the local marginals @xmath21 and @xmath22 . the free energy in the bethe approximation can be written in terms of the local free - energy shifts @xmath23 and @xmath24 , corresponding to the changes in the free energy by adding spin @xmath25 and interaction between spins @xmath25 and @xmath26 , respectively . to compute these free energies",
    "we need the cavity marginals @xmath27 , i.e. , the probability of having spin @xmath25 in state @xmath28 in absence of the interaction with spin @xmath26 . the equations governing these local cavity marginals",
    "are called the belief propagation ( bp ) equations @xcite . having the cavity marginals one",
    "can obtain the bethe estimation of the local marginals for any subset of the variables . notice that in writing the bp equations one assumes the classical system is in a replica - symmetric ( rs ) phase . even in a replica - symmetry - broken ( rsb )",
    "phase , the approximation is still valid in a single pure state thanks to the exponential decay of the correlations @xcite .    the average of any local quantity like @xmath29 and @xmath30 can be written as a function of the bp cavity marginals ( or messages ) .",
    "therefore , the optimization problem reads @xmath31 where the indicator function @xmath32 ensures that the messages @xmath33 satisfy the bp equations . in the case of multiple bp fixed points",
    "the above partition function would be concentrated on the one of minimum average energy for @xmath6 .",
    "more accurate average energies are obtained , of course , by considering replica symmetry breaking and working with a probability distribution of the bp fixed points .",
    "as an example in the following we consider the quantum ising model with hamiltonian @xmath8 where @xmath34 and @xmath35 . the interaction graph is defined by set @xmath36 , and @xmath37 is the size of the system .",
    "the @xmath38 are the standard pauli matrices . here",
    "states @xmath10 are the @xmath39 configurations of the @xmath40 spins . in this case @xmath41 and @xmath42 . for the trial wave functions we take the ising ansatz : @xmath43 with complex parameters @xmath44 .",
    "by @xmath45 and @xmath46 we mean the real part of the parameters .",
    "this results in the gibbs measure @xmath47 of a classical spin - glass model with external fields @xmath48 and couplings @xmath49 .",
    "notice that the classical interaction graph @xmath19 could be different from the quantum one @xmath36 . for simplicity , in the following",
    "we will assume that the two coincide as happens in zero transverse fields ; better representations could be obtained by adding the higher order neighbors to @xmath19 .",
    "given the classical measure , we write the bp equations for the cavity marginal @xmath27 of spin @xmath25 in the absence of spin @xmath26 : @xmath50 where @xmath51 refers to the set of spins interacting with spin @xmath25 in @xmath19 . these equations can easily be obtained by assuming a tree structure for the classical interaction graph @xcite .",
    "figure [ f1 ] displays the set of variables and interactions in the classical interaction graph . having the cavity marginals , the average of local energies @xmath52 and @xmath53 read @xmath54 with the local bp marginals @xmath55 and @xmath56 $ ] .",
    "we see that the only dependence of the total average energy on the imaginary part of the parameters comes explicitly from the @xmath57 .",
    "consequently , for @xmath58 and @xmath59 we can minimize the total average energy by setting @xmath60 and @xmath61 , respectively . without loss of generality , in the following",
    "we assume the @xmath62 and the imaginary parameters are zero .",
    "the above average energies define the boltzmann weight @xmath63 for a given configuration of the variational parameters and the bp messages ; see figure [ f1 ] .",
    "the cavity marginals of the parameters ( including the bp messages ) can be written in a higher - level bethe approximation , resembling the one - step rsb equations @xcite : @xmath64 where for brevity we defined @xmath65 and @xmath66 .",
    "the bethe free energy is given by @xmath67 with @xmath68 where @xmath23 and @xmath24 are the free - energy shifts by adding node @xmath25 and link @xmath69 , respectively .",
    "notice that in the last equation we have the positive sign in the exponential to count correctly the energy contribution @xmath70 .",
    "the @xmath6 limit of the above equations , taking the scaling @xmath71 , read @xmath72 which in short we call the maxsum - bp equations @xcite .",
    "the equations can be solved by iteration starting from random initial messages . in each iteration",
    "we have to shift @xmath73 by a constant to keep @xmath74 .",
    "finally , the minimum energy is given by @xmath75 with the local energy shifts @xmath76 before solving the above equations we shall consider some simpler cases .",
    "in the zeroth order of the approximation we take @xmath77 for any @xmath69 .",
    "this is a mean - field approximation with a factorized measure @xmath78 , where @xmath79 $ ] . then using equations [ eij ] and [ ei ] we obtain the average local energies : @xmath80 and @xmath81",
    "; therefore @xmath82 here we write directly the maxsum equations that can be used to estimate the optimal parameters and the minimum average energy : @xmath83 then we find the optimal paramters by maximizing the local maxsum weights : @xmath84      as long as the fields @xmath85 are zero we have always a symmetric solution @xmath86 to the bp equations in the classical system .",
    "this gives the average local energies : @xmath87 and @xmath88 $ ] , and @xmath89 the resulting maxsum equations are @xmath90 and the optimal couplings are estimated by @xmath91    notice that here we have @xmath92 , which is not the case in the ordered phase .",
    "in addition , the symmetric solution does not give an accurate average energy when replica symmetry is broken , which may happen for large couplings in the classical system ; the bethe approximation works well when distant spins are nearly independent , whereas the symmetric solution does not respect this property in an rsb phase . to get around this problem one can work with the nontrivial bp fixed points , e.g. , by demanding a total magnetization of magnitude greater than @xmath93 . at the same time",
    "one may need to limit the range of couplings to @xmath94 in order to avoid dominance by very large couplings .      in general to solve the maxsum - bp equations we have to work with discrete fields",
    "@xmath95 , couplings @xmath96 , and bp cavity fields @xmath97 .",
    "the bp cavity fields @xmath98 are defined by @xmath99 .",
    "an exhaustive solution of the maxsum - bp equations would take a time of order @xmath100^{d}$ ] where @xmath101 is the maximum degree in @xmath19 .",
    "notice that given the couplings @xmath102 and the input bp messages @xmath103 around spin @xmath25 , one obtains @xmath98 for any value of @xmath45 from the bp equations .",
    "the above equations can be solved more efficiently ( for large degrees ) by using a convolution function of four variables ( needed to compute @xmath104 in the maxsum - bp equations ) resulting in a time complexity of order @xmath105 ; see the appendix . in the following instead we use a computationally easier but approximate way of solving the equations by restricting the domain of variables : we start by assigning a small number of randomly selected states @xmath106 to each variable @xmath107",
    ". then we run the maxsum - bp equations with these restricted search spaces to converge the equations and sort the states in @xmath108 according to their maxsum - bp weights : @xmath109 next we update the search spaces by replacing the states having smaller weights with some other ones generated randomly but close to the best state observed during the algorithm .",
    "the above two steps are repeated to find better search spaces and therefore parameters .",
    "the algorithm performance would depend on the size of the search spaces , approaching the correct one for @xmath110 .",
    "the search spaces at the beginning are chosen randomly therefore we introduce a tolerance @xmath111 to accept those bp messages that satisfy the bp equations within @xmath112 .",
    "one may start from a large tolerance and decrease it slowly after each update of the search spaces .",
    "the mean - field solution mentioned before can provide a good initial point for the search spaces .",
    "first , we consider a spin chain in uniform and positive transverse field but with random couplings . in figure [ f2 ]",
    "we compare the results obtained by the above approximations with the exact ones obtained by the modified lanczos method @xcite .",
    "as expected , the mean - field ansatz is better than the symmetric solution in the ordered phase where the local magnetizations are nonzero .",
    "the reverse happens in the disordered phase and even in the ordered phase close to the transition point where the local magnetizations are still small .",
    "the two limiting behaviors are therefore displayed in the general solution .     on a chain of size @xmath113 .",
    "for comparison we also display the gs results for @xmath114 . here",
    "@xmath3 and @xmath115 are the ground - state energy and magnetization in the @xmath116 direction , respectively .",
    "the inset shows the edwards - anderson order parameter @xmath117 .",
    "the couplings @xmath118 are gaussian random numbers of mean zero and variance one .",
    "@xmath119 , @xmath120 , and @xmath111 are the sizes of bins in the discrete representation of the parameters , and @xmath121 is the number of states in the restricted domains .",
    "the data for gs are obtained by restricting the search algorithm to total magnetizations of magnitude greater than @xmath122.,width=377 ]    as another example we study the same model on a single instance of random regular graphs where each spin interacts with a fixed number of other randomly selected spins .",
    "the results displayed in figure [ f3 ] show similar behaviors observed above , except that in the ordered phase the symmetric solution gives a lower ground state energy than the exact one .",
    "as explained before , this is due to the poor estimation of the average energy by the symmetric solution when there are multiple bp fixed points .",
    "moreover , due to the loops and small size of the system we find larger deviations from the exact data compared to the chain model .     on a random regular graph ( rrg ) of degree @xmath123 and size @xmath113 . for comparison",
    "we also display the gs results for @xmath114 .",
    "the couplings @xmath118 are gaussian random numbers of mean zero and variance one .",
    "the data for gs are obtained by restricting the search algorithm to total magnetizations of magnitude greater than @xmath122 and couplings of magnitude less than @xmath124.,width=377 ]    similar qualitative behaviors are observed in ferromagnetic ( @xmath125 ) and @xmath126 spin - glass ( @xmath127 with equal probability ) models on a random regular graph of degree @xmath123 . in the ferromagnetic case , a reasonable trial wave function is obtained by taking @xmath128 and @xmath129 .",
    "this simplification allows us to find easily the optimal parameters , and so the critical field @xmath130 in the thermodynamic limit .",
    "figure [ f4 ] displays the phase diagram of the ferromagnetic model obtained in this way . for the @xmath126 spin - glass model ,",
    "the general solution on single instances of size @xmath114 gives @xmath131 .",
    "the corresponding values in the thermodynamic limit given in refs . @xcite and @xcite are : @xmath132 and @xmath133 .    ) in transverse field @xmath134 on rrg of degree @xmath123 .",
    "the results of homogeneous mean field @xmath128 and ising ( @xmath135 ) trial wave functions are compared with the results of the quantum cavity method @xcite for a small temperature in the thermodynamic limit.,width=377 ]",
    "we suggested a heuristic message - passing algorithm to find an approximated ground state of a quantum system for a given instance of ( possibly disordered ) couplings .",
    "this was done by exploiting an efficient representation of the wave function and relating the quantum state of the system to the gibbs state in a classical system .",
    "the local and distributive nature of the algorithm could help us to study the ground - state properties of large - scale quantum problems in a parallel computation .",
    "we used the following main approximations to make the study simple and clear : ( i ) working at most with the two - body interactions in the classical system , ( ii ) assuming the same classical and quantum interaction graphs , and ( iii ) estimating the classical average energies within the replica - symmetric approximation .",
    "our approach , however , allows for a systematic way of improving the algorithm by considering better trial wave functions , using more accurate cluster variational or generalized bp approximations @xcite , and taking the effects of replica symmetry breaking into account .",
    "finally , the method can be applied to other interesting quantum systems ; in a forthcoming paper we will show how this works in the hubbard model in the presence of the sign problem .",
    "i would like to thank s. lal , g. semerjian , and r. zecchina for reading the manuscript and their constructive comments and a. montorsi , and m. roncaglia for helpful discussions .",
    "i thank g. semerjian also for providing us with the quantum cavity data .",
    "support from erc grant no .",
    "optinf 267915 is acknowledged .",
    "let us write the bp equations in terms of the cavity fields : @xmath136.\\end{aligned}\\ ] ] using eqs .",
    "[ eij ] and [ ei ] we rewrite the local average energies @xmath137 where @xmath138 so the maxsum - bp equations read @xmath139 to split the maximum over the set @xmath140 we introduce a convolution function @xmath141 to keep track of the quantities needed to compute the average local energies and satisfy the bp equations . at each step",
    "@xmath142 we take the maximum over the subset @xmath143 for @xmath144 , where @xmath145 is the degree of node @xmath25 in @xmath19 , and the variables are @xmath146 , \\\\",
    "x_{-}^t & = \\frac{1}{2}\\sum_{t ' > t }   \\ln [ \\frac{\\cosh(\\nu_{k_{t ' } \\to i}+2k_{ik_{t'}})}{\\cosh(\\nu_{k_{t ' } \\to i}-2k_{ik_{t ' } } ) } ] , \\\\",
    "y_{+}^t & = \\prod_{t'\\le t } \\frac{\\cosh(\\nu_{k_{t ' } \\to i}+2k_{ik_{t'}})}{\\cosh(\\nu_{k_{t ' } \\to i } ) } , \\\\",
    "y_{-}^t & = \\prod_{t'\\le t } \\frac{\\cosh(\\nu_{k_{t ' } \\to i}-2k_{ik_{t'}})}{\\cosh(\\nu_{k_{t ' } \\to i})}.\\end{aligned}\\ ] ] the convolution function is updated sequentially as @xmath147 with the set of constraints @xmath148 : @xmath149 , \\\\",
    "x_-^{t+1 } & = x_-^t- \\frac{1}{2}\\ln[\\frac{\\cosh(\\nu_{k_{t+1 } \\to i}+2k_{ik_{t+1}})}{\\cosh(\\nu_{k_{t+1 } \\to i}-2k_{ik_{t+1 } } ) } ] = \\nu_{i \\to k_{t+1}}-2b_i - x_+^{t } , \\\\",
    "y_+^{t+1 } & = y_+^t   \\frac{\\cosh(\\nu_{k_{t+1 } \\to i}+2k_{ik_{t+1}})}{\\cosh(\\nu_{k_{t+1 } \\to i } ) } , \\\\",
    "y_-^{t+1 } & = y_-^t   \\frac{\\cosh(\\nu_{k_{t+1 } \\to i}-2k_{ik_{t+1}})}{\\cosh(\\nu_{k_{t+1 } \\to i } ) } , \\end{aligned}\\ ] ] and the following boundary condition : @xmath150 ; otherwise , it is @xmath151 .",
    "finally , the maxsum - bp message is computed after @xmath152 steps by @xmath153"
  ],
  "abstract_text": [
    "<S> a local and distributive algorithm is proposed to find an optimal trial wave function minimizing the hamiltonian expectation in a quantum system . to this end </S>",
    "<S> , the quantum state of the system is connected to the gibbs state of a classical system with the set of couplings playing the role of variational parameters . </S>",
    "<S> the average energy is written within the replica - symmetric approximation , and the optimal parameters are obtained by a heuristic message - passing algorithm based on the bethe approximation . </S>",
    "<S> the performance of this approximate algorithm depends on the structure and quality of the trial wave functions , starting from a classical system of isolated elements , i.e. , mean - field approximation , and improving on that by considering the higher - order many - body interactions . </S>",
    "<S> the method is applied to some disordered quantum ising models in transverse fields , and the results are compared with the exact ones for small systems . </S>"
  ]
}