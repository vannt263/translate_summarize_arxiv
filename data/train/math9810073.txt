{
  "article_text": [
    "recently l. kauffman introduced a notion of a virtual knot , extending the knot theory in an unexpected direction .",
    "we show here that this extension motivates a new approach to finite type invariants .",
    "this approach leads to new results both for virtual and classical knots .      knots ( smooth simple closed curves in @xmath2 ) are usually presented by knot diagrams which are generic immersions of the circle into the plane enhanced by information on overpasses and underpasses at double points .",
    "a generic immersion of a circle into the plane is characterized by its _",
    "gauss diagram , _ which consists of the circle together with the preimages of each double point of the immersion connected by a chord . to incorporate the information on overpasses and underpasses",
    ", the chords are oriented from the upper branch to the lower one .",
    "furthermore , each chord is equipped with the sign of the corresponding double point ( local writhe number ) .",
    "see figure [ f2 ] .",
    "the result is called a _ gauss diagram _ of the knot .",
    "a gauss diagram is usually considered up to orientation preserving homeomorphism of the underlying circle .",
    "the gauss diagram defines ( up to isotopy of @xmath3 ) a knot diagram on the sphere , i.e. , a knot diagram embedded into @xmath3 via the embedding @xmath4 . given a knot diagram on the sphere , a knot diagram on the plane",
    "can be recovered modulo a finite ambiguity ( this involves the choice of which connected component of the diagram contains the point at infinity ) , but the underlying knot itself is recovered uniquely up to isotopy .",
    "thus gauss diagrams can be considered as an alternative way to present knots . of course",
    ", they can not compete with knot diagrams in creating a visual impression of knots , but gauss diagrams are simpler from the combinatorial point of view and provide numerous advantages when we want to calculate knot invariants .",
    "unfortunately , not every picture which looks like a gauss diagram is indeed a gauss diagram of some knot .",
    "moreover , this is not easy to recognize .",
    "there is an obvious algorithm @xcite for checking this , which is just the result of attempting to draw the corresponding knot diagram .",
    "however this requires a considerable amount of effort .      the starting point for the present work",
    "is the idea that for some purposes it is easier just to ignore the problem of whether a gauss diagram represents a knot , rather than trying to solve it .",
    "this gives rise to a generalization of classical knot theory by replacing true knots with objects which generalize gauss diagrams of knots , but which are not necessarily associated to a knot .",
    "of course , these objects are to be considered up to an appropriate equivalence , which imitates knot isotopy .",
    "although we had been led to this generalization by the internal logic of our previous research on combinatorial formulae for vassiliev knot invariants , as soon as we formulated it , we recognized that we had rediscovered the theory of _ virtual knots , _ which was announced last year by louis kauffman in several talks @xcite .",
    "our main contribution to this newborn theory is to turn it into a useful tool for studying classical knots .",
    "a _ virtual knot diagram _ is a generic immersion of the circle into the plane , with double points divided into real crossing points and virtual crossing points , with the real crossing points enhanced by information on overpasses and underpasses ( as for classical knot diagrams ) . at a virtual crossing",
    "the branches are not divided into an overpass and an underpass .",
    "the _ gauss diagram _ of a virtual knot is constructed in the same way as for a classical knot , but all virtual crossings are disregarded , see figure [ virtf2 ] .",
    "virtuality of virtual knots is manifest through the fact that while the diagram of a real knot is a picture describing a curve in @xmath2 , a virtual knot diagram apparently does not pertain to any familiar 3-dimensional geometric object .",
    "however we would like to keep speaking about virtual knots in the same way we that speak about real knots :",
    "a virtual knot is that thing presented by a virtual knot diagram . to resolve this ambiguity ,",
    "we introduce moves on virtual knot diagrams similar to the moves of real knot diagrams which happen during an isotopy of a knot , and we will use the term virtual knot to denote an equivalence class of virtual knot diagrams under these moves .",
    "two knot diagrams represent the same virtual knot , if one can be obtained from the other by a sequence of these moves .",
    "this agrees with the tradition of classical knot theory , where the term knot is often taken to refer to the isotopy class of a knot .      as is well - known , when a knot changes by a generic isotopy , its diagram undergoes a sequence of _ reidemeister moves _ of one of the three types shown in figure [ moves1 ] .",
    "a diagram of a virtual knot can undergo the same reidemeister moves , as well as the moves shown in figure [ moves2 ] .",
    "these additional moves are called _ virtual moves . _",
    "the first three of them are versions of the reidemeister moves , but with virtual crossings in place of crossings .",
    "the last one looks like the third reidemeister move , but involves two virtual crossings and one usual crossing .",
    "similar moves , but with two real crossings and one virtual crossing ( shown in figure [ forbmove ] ) are forbidden . if one allows these moves , this makes the theory trivial : any virtual knot diagram can be unknotted by a sequence of moves shown in figures [ moves1 ] , [ moves2 ] and [ forbmove ] , see section [ sn - evk.3 ] .    as mentioned above , a virtual knot is a class of virtual knot diagrams consisting of diagrams which can be transformed into each other by sequences of reidemeister and virtual moves . a sequence of this kind",
    "is called a _ virtual isotopy .",
    "_    virtual moves do not affect gauss diagrams .",
    "on the other hand , virtual moves allow one to move the interior of any arc which does not pass through a real crossing quite arbitrarily .",
    "therefore we obtain the    a gauss diagram defines a virtual knot diagram up to virtual moves .",
    "this means that a virtual knot ( modulo reidemeister and virtual moves ) is equivalent to the corresponding gauss diagram considered up to moves which are the counter - parts of reidemeister moves for gauss diagrams , see figure [ movescd ] .",
    "since in a gauss diagram all the orientations and the cyclic ordering of the endpoints of arrows are essential , each type of reidemeister moves splits . in figure",
    "[ movescd ] , all moves corresponding to the first and second reidemeister moves are shown in the top and middle rows , respectively .",
    "there are eight moves corresponding to the third reidemeister move , but we only show two of them in the bottom row . as stlund @xcite showed ,",
    "the remaining six moves are unnecessary .",
    "that is , any sequence of moves of a gauss diagram can be replaced by a sequence of moves appearing in figure [ movescd ] .",
    "although in @xcite this is proved for gauss diagrams of knots , the same proof works for virtual knots .",
    "kauffman @xcite , @xcite has proved that many knot invariants extend to invariants of virtual knots . in particular , the notions of knot group , quandle and rack , and the bracket polynomial , all extend in a straightforward manner . he also announced that with the use of a `` virtual framing '' there are extensions of all quantum link invariants and the large collection of their corresponding vassiliev invariants .",
    "the extensions are done in a formal way , disregarding the original topological nature of these invariants .",
    "for example , the knot group , which is defined for classical knots as the fundamental group of the knot complement , is extended via a formal construction of a wirtinger presentation .",
    "this construction can be written down in terms of a gauss diagram as follows .",
    "let @xmath5 be a gauss diagram .",
    "if we cut the circle at each arrowhead ( forgetting arrowtails ) , the circle of @xmath5 is divided into a set of arcs . to each of these arcs there",
    "corresponds a generator of the group .",
    "each arrow gives rise to a relation .",
    "suppose the sign of an arrow is @xmath6 , its tail lies on an arc labelled @xmath7 , its head is the final point of an arc labelled @xmath8 and the initial point of an arc labelled @xmath9 .",
    "then we assign to this arrow the relation @xmath10 .",
    "the resulting group is called the _ group of the gauss diagram .",
    "_ one can easily check that it is invariant under the reidemeister moves shown in figure [ movescd ] .",
    "moreover , the group system also extends . for the meridian , take the generator corresponding to any of the arcs . to write down the longitude , we go along the circle starting from this arc and write @xmath11 , when passing the head of an arrow whose sign is @xmath6 and whose tail lies on the arc labelled @xmath7 .",
    "the notion of quandle @xcite is extended in the same way as the knot group : the generators remain the same , but each group relation @xmath10 is replaced with the corresponding quandle relation @xmath12 .",
    "any diagram of a classical knot can be considered to be a virtual knot diagram .",
    "a virtual isotopy can turn it into a diagram with virtual crossings , and then back again to a real knot diagram .",
    "thus virtual isotopy is a new relation among classical knots , which apriori could differ from classical isotopy .",
    "however this is not the case .",
    "[ viii ] ( see also kauffman @xcite . ) virtually isotopic classical knots are isotopic .",
    "the group system extends to virtual knots .",
    "hence it is preserved under virtual isotopy , and virtually isotopic knots have isomorphic group systems .",
    "now recall that the group system is a complete knot invariant : knots with isomorphic group systems are isotopic .",
    "any invariant of virtual knots is obviously an invariant of classical knots . on the other hand , by theorem [ viii ]",
    ", any invariant of classical knots can be extended to an invariant of virtual knots .",
    "nevertheless , for some invariants it is not easy to choose a natural extension .",
    "even for the linking number , the extension to virtual 2-component links is not unique ( see section [ sl ] below ) .",
    "a similar situation occurs for the degree 2 vassiliev knot invariant considered in section [ sgdf2 ] .",
    "these examples are based on the same phenomenon . unlike a classical knot",
    ", a virtual knot can not be turned upside down .",
    "a rotation of a classical knot by the angle @xmath13 around a horizontal line reverses all arrows of its gauss diagram , while their signs do not change .",
    "an application of this operation to a gauss diagram of a virtual knot gives rise to a virtual knot which may be non isotopic to the original one .",
    "the composition of this operation with an invariant of virtual knots may be another invariant .",
    "a striking manifestation of this phenomenon comes from the knot group . instead of the upper wirtinger presentation of a knot group ,",
    "which was generalized to virtual knots by kauffman ( see the preceding section ) , let us use the lower wirtinger presentation , i.e. compose kauffman s construction with arrows reversal .",
    "we will call these groups the _ upper _ and the _ lower _ virtual knot groups , respectively . a virtual knot with different upper and lower groups is shown in figure [ uplowgr ] .",
    "the upper group of this knot is isomorphic to the group of the trefoil knot , while its lower group is @xmath14 .",
    "these examples may create an impression that virtual knot theory is more cumbersome than the classical knot theory . however , this is not the case . due to its larger class of objects ,",
    "the theory of virtual knots provides more flexibility .",
    "this leads to significant simplification , especially in the theory of finite type invariants .      by a ( classical ) _ long knot _ we mean a smooth embedding @xmath15 which coincides with the standard embedding outside a compact set .",
    "an isotopy of long knots is a smooth isotopy in the class of embeddings above . in the classical knot theory ,",
    "long knots are introduced for purely technical reasons , since adding the point at infinity turns a long knot into a knot in the sphere @xmath16 and this construction establishes a one - to - one correspondence between the isotopy classes of long knots and the isotopy classes of knots .",
    "given a diagram of a long knot , the corresponding gauss diagram is the line parameterizing the knot , together with arcs connecting the preimages of each crossing . as in the case of _ closed _ classical knots considered above , the arcs are oriented from the upper branch to the lower one and equipped with signs which are equal to the local writhe numbers of the corresponding crossing points .",
    "each oriented signed arc is called an _ arrow .",
    "_    a _ virtual long knot diagram _ is a generic immersions @xmath17 with double points divided into real and virtual crossing points , where real crossing points are enhanced by information on overpasses and underpasses , as in a classical knot diagram . at a virtual crossing",
    "the branches are not divided into an overpass and an underpass .",
    "the _ gauss diagram _ of a virtual long knot is constructed in the same way as for a classical long knot , but all the virtual crossings are disregarded .",
    "a _ virtual long knot _ is a class of diagrams which can be transformed into each other by sequences of reidemeister and virtual moves ( shown in figures [ moves1 ] and [ moves2 ] ) .",
    "surprisingly , virtual long knots differ from virtual knots .",
    "that is , there is no one - to - one correspondence between the virtual isotopy classes of virtual long knots and virtual knots .",
    "addition of a point at infinity of the plane of the diagram turns a diagram of a virtual long knot into a virtual knot diagram on @xmath3 .",
    "removal of a point from the complement of the diagram yields a virtual knot diagram on @xmath18 .",
    "one can easily prove that its virtual isotopy class does not depend on the choice of this point .",
    "thus we have a natural map from the set of virtual long knots to virtual knots .",
    "this map is surjective but not injective .",
    "the simplest pair of virtual long knots which are not virtually isotopic , but give rise to isotopic virtual closed knots is shown in figure [ fnilks ] .",
    "these virtual long knots are distinguished by the invariant @xmath19 defined in section [ sgdf2 ] below .",
    "[ htb ]    the upper diagram can be transformed into the lower diagram by moving the underpassing arc of the leftmost crossing through the point at infinity .",
    "if these were classical knots , these transformation could be replaced by moving the same arc under the rest of the diagram by a sequence of reidemeister moves . in our case",
    "this is impossible , since we can not apply the move of figure [ forbmove ] .    as a result ,",
    "the theories for long and closed virtual knots are quite different , although their restrictions to usual knots coincide .      for links ,",
    "the basic notions of the virtual theory are introduced in a straightforward way .",
    "the only change is that the underlying circle of a gauss diagram is replaced with several circles .",
    "simple examples show that in many respects it is richer than the classical one and sometimes looks surprising .",
    "for instance , for 2-component links there are two independent versions of the linking number .",
    "the invariant @xmath20 may be computed as a sum of signs of real crossings where the first component passes over the second one .",
    "similarly , one can define @xmath21 by exchanging the components in the definition of @xmath20 above .",
    "string links are related to links like long knots are to knots .",
    "a classical @xmath0-component _ string link _ is a smooth embedding of a disjoint union of @xmath0 copies of @xmath22 into @xmath2 which coincides with the standard embedding outside a compact set . here , by the standard embedding , we mean the one given by the formula @xmath23 , with @xmath24 and @xmath25 .",
    "all the basic notions of the virtual theory extend naturally to string links .",
    "a gauss diagram in this case consists of @xmath0 parallel lines and signed arrows with end points on these lines .",
    "in the realm of virtual knots there is an elementary operation which does not exist for classical knots .",
    "a real crossing can be turned into a virtual one . in terms of gauss",
    "diagrams it looks even simpler : we erase an arrow .",
    "this operation simplifies the knot in the sense that after applying it a sufficient number of times we eventually get to the unknot .    in the classical knot theory",
    "an operation with this property is widely used .",
    "this is the crossing change .",
    "however , it is more complicated in several ways .",
    "first , in order to turn a knot into the unknot , one must apply this move according to a certain pattern , say making the diagram descending or ascending , whereas virtualizing crossings leads to the unknot automatically .",
    "second , the unknotting by crossing changes involves a choice : even if we have chosen to proceed towards a descending diagram , we still have to choose a point at which the descent begins . the result considered as a diagram depends on this choice",
    ". unknotting by virtualization eliminates these technically unpleasant problems .",
    "third , crossing changes do not diminish the number of crossings , while each virtualization diminishes the number of real crossings . finally , virtualization is more elementary than crossing changing , since a crossing change can be presented as the composition of one crossing virtualization and the inverse of another .",
    "a more general operation defined on gauss diagrams of virtual knots is passage to subdiagrams . here",
    "@xmath26 is a subdiagram of @xmath27 if all the arrows of @xmath26 belong to @xmath27 . in this case",
    "we write @xmath28 .",
    "the standard theory of finite type invariants is based on crossing change as the basic modification .",
    "recall that a function @xmath29 defined on the set of knot isotopy types and taking values in an abelian group @xmath5 is said to be a finite type invariant of degree @xmath1 , if for any knot diagram @xmath27 and @xmath30 crossing points @xmath31 , @xmath32 ,  , @xmath33 of @xmath27 @xmath34 here @xmath35 runs over @xmath36-tuples of zeros and ones , @xmath37 is the number of ones in @xmath38 , and @xmath39 is the diagram obtained from @xmath27 by switching all crossings @xmath40 with @xmath41 .",
    "this description can be simplified by extending a knot invariant to knots with double points ( called also _ singular knots _ ) .",
    "a double point appears when at a crossing point one moves the upper branch downwards through the lower branch .",
    "the knot with a double point is identified with the formal difference between the two knots obtained by resolving the double point in two ways .",
    "this can be formulated as the following formal relation : @xmath42 double points are depicted with thick points , so as to distinguish them from virtual crossings .",
    "any knot invariant extends to formal linear combinations of knot diagrams by linearity . under the identification in , the alternating sum in the left hand side of equality",
    "becomes the value of @xmath29 on a knot with @xmath30 double points .",
    "thus a knot invariant has degree at most @xmath0 if its extension vanishes on every singular knot having at least @xmath30 double points .",
    "the counter - part in the virtual theory of the notion of finite type invariant can be described as follows .",
    "we introduce a new kind of crossing , which is called _ semi - virtual .",
    "_ at a semi - virtual crossing there are still over- and under - passes . in a diagram",
    "a semi - virtual crossing is shown as a real one , but surrounded by a small circle .",
    "semi - virtual crossings are related to the other types of crossings by the following formal relation : @xmath43    in a gauss diagram a semi - virtual crossing is presented by a dashed arrow .",
    "the relation becomes @xmath44 let @xmath27 be a virtual knot diagram and @xmath45 be an @xmath0-tuple of its real crossings points . for an @xmath0-tuple @xmath46 of zeros and ones , define @xmath39 to be the diagram , obtained from @xmath27 , by switching all the crossings @xmath40 , with @xmath41 , to virtual crossings .",
    "denote by @xmath37 the number of ones in @xmath38 .",
    "the formal alternating sum @xmath47 is called a diagram with @xmath0 semi - virtual crossings .",
    "we depict the corresponding alternating sum of gauss diagrams by the gauss diagram of @xmath27 with all the arrows associated to @xmath45 being dashed .",
    "this agrees with the convention on semi - virtual crossings .",
    "denote by @xmath48 the set of virtual knots .",
    "let @xmath49 be an invariant of virtual knots with values in an abelian group @xmath5 .",
    "extend it to @xmath50 $ ] by linearity .",
    "we say that @xmath29 is an _ invariant of finite type _ , if for some @xmath51 it vanishes for any virtual knot @xmath52 with more than @xmath0 semi - virtual crossings .",
    "the minimal such @xmath0 is called the _ degree _ of @xmath29 .",
    "note that and imply @xmath53 it follows that for any finite type invariant of the virtual theory , its restriction to classical knots is a finite type invariant ( of at most the same degree ) in the classical sense .",
    "the definition of finite type invariants extends to virtual links in a natural way .",
    "a particularly simple example is given by the invariants @xmath20 and @xmath21 considered in section [ sl ] .",
    "these invariants of 2-component virtual links have degree one .",
    "an _ arrow diagram _ ( on a circle ) is an abstract diagram , which consists of an oriented circle with pairs of distinct points connected by dashed arrows .",
    "each arrow is equipped with a sign .",
    "the _ algebra of arrow diagrams _",
    "@xmath54 is the free abelian group generated by all arrow diagrams .",
    "we call @xmath54 an algebra , because there is indeed a natural multiplication in @xmath54 making it into an associative algebra . , @xmath55 is the sum ( with appropriate multiplicities , cf .",
    "@xcite ) of all diagrams each of which is the union of subdiagrams isomorphic to @xmath56 and @xmath55 . ]",
    "the algebra @xmath57 is isomorphic to the one introduced in @xcite .",
    "however in this paper we will not make use of the multiplicative structure in @xmath54 .",
    "denote the set of all gauss diagrams by @xmath58 .",
    "starting from any gauss diagram we get an arrow diagram just by making all its arrows dashed .",
    "the extension of this map to @xmath59 $ ] defines a natural isomorphism @xmath60\\to{\\mathcal a}$ ] .",
    "there is another important map @xmath61 , assigning to a gauss diagram @xmath27 the sum of all its subdiagrams and then making each of them dashed : @xmath62 thus the map @xmath63 can described by the following symbolic formula :    @xmath64    the reason for using the same dashed arrows both for semi - virtual crossings in @xmath59 $ ] and for arrows in @xmath54 becomes clear if one compares formulas and .",
    "extend @xmath63 to @xmath59 $ ] by linearity .",
    "[ lem.iso ] @xmath65\\to{\\mathcal a}$ ] is an isomorphism .",
    "the inverse map @xmath66 $ ] is defined on the generators of @xmath54 by @xmath67 where @xmath68 is the number of arrows of @xmath69 which do not belong to @xmath70 .",
    "a gauss diagram is called _ semi - virtual _ if each of its arrows is dashed .",
    "[ basis]semi - virtual diagrams form a basis of @xmath59 $ ] .",
    "[ rem ] we can now explain an additional reason for the dual use of dashed arrows : @xmath63 maps each semi - virtual gauss diagram to the arrow diagram with the same arrows .",
    "this observation extends to diagrams containing both solid and dashed arrows .",
    "consider such a diagram @xmath27 as an element of @xmath59 $ ] .",
    "then each diagram appearing in @xmath71 contains all the dashed arrows of @xmath27 .",
    "thus we see that @xmath63 can be interpreted as a presentation of a gauss diagram by a linear combination of semi - virtual diagrams .",
    "the _ polyak algebra _ is the quotient of @xmath54 by the following relations : @xmath72 @xmath73 @xmath74    here we follow the common convention that the unshown parts of all diagrams involved in each of the relations coincide .",
    "the embeddings of the shown parts into the whole diagrams should preserve the orientations in .",
    "the same relations define analogous algebras for long knots , links and string links .",
    "the quotient of @xmath54 by the relations - is an algebra , since the relations generate an ideal of @xmath54 , but we shall not go into further detail on this point . denote this algebra by @xmath75 .",
    "this algebra is closely related to the algebra @xmath54 introduced in @xcite .",
    "the isomorphism @xmath63 induces an isomorphism @xmath76\\to{\\mathcal p}$ ] of quotient algebras .",
    "indeed , the equivalence relation induced in @xmath58 by the reidemeister moves shown in figure [ moves1 ] , can be rewritten in terms of diagrams with semi - virtual crossings as follows @xmath77 @xmath78 @xmath79 note that the map @xmath63 turns  into  .",
    "thus for any gauss diagram @xmath27 of a virtual knot @xmath52 , @xmath80 defines a @xmath75-valued invariant of @xmath52 .",
    "moreover , since the gauss diagram determines @xmath52 , the invariant @xmath80 distinguishes virtual knots .",
    "thus we obtain the following theorem .",
    "[ thm.inv ] let @xmath27 be any diagram of a virtual knot @xmath52 .",
    "the formula @xmath81 defines a complete invariant of virtual knots .",
    "define the _ truncated algebra",
    "_ @xmath82 by putting @xmath83 for any diagram @xmath84 with more than @xmath0 arrows .",
    "denote by @xmath85 the composition of @xmath86 with the projection @xmath87 .",
    "let @xmath88 be an abelian group and @xmath89 be a @xmath88-valued invariant of virtual knots .",
    "we call @xmath90 a _ universal invariant of degree @xmath0 _ , if for every abelian group @xmath5 and every invariant @xmath49 of degree at most @xmath0 factors through @xmath90 , i.e.  there exists a map @xmath91 , such that @xmath92 .",
    "[ thm.invn ] the map @xmath85 defines a universal invariant of degree @xmath0 .",
    "since , by remark [ rem ] , @xmath63 preserves all dashed arrows , @xmath93 maps a knot with more than @xmath0 semi - virtual crossings to zero .",
    "therefore @xmath93 is an invariant of degree at most @xmath0 .",
    "let @xmath49 be an invariant of degree at most @xmath0 .",
    "we have to prove that @xmath94 factors through @xmath82 .",
    "observe that , by remark [ rem ] , for any arrow diagram @xmath69 its image @xmath95 $ ] can be identified with the same diagram @xmath69 , but considered as a semi - virtual gauss diagram . since the degree of @xmath29 is at most @xmath0 , @xmath29 vanishes on each diagram with more than @xmath0 semi - virtual crossings .",
    "therefore @xmath96 vanishes on each arrow diagram with more than @xmath0 arrows and @xmath96 factors through @xmath82 .",
    "the space of @xmath97-valued invariants of degree at most @xmath0 is finite - dimensional , of dimension equal to @xmath98 .",
    "it can be identified with the dual space @xmath99 of @xmath97-valued linear functions on @xmath82 .",
    "since the algebra @xmath54 has a distinguished basis , consisting of arrow diagrams , there is a natural orthonormal scalar product @xmath100 on @xmath54 .",
    "namely , on the generators of @xmath54 we put @xmath101 to be @xmath102 , if @xmath103 , and @xmath104 otherwise and then extend @xmath100 bilinearly .",
    "this allows us to define the pairing @xmath105 in the following way .",
    "for any @xmath106 and @xmath107 put @xmath108 informally speaking , we count subdiagrams of @xmath27 with weights , where the weight of a diagram @xmath26 is the coefficient of @xmath109 in @xmath69 .    in the case of gauss diagrams corresponding to usual knots , this pairing ( in a slightly different form ) was introduced in @xcite as a tool for writing down gauss diagram formulas for knot invariants .",
    "we will use it below for the same purpose in the framework of virtual knots .    using equation and theorem [ thm.inv ]",
    "it is easy to see that any @xmath14-valued invariant of finite type of virtual knots can be obtained by a gauss diagram formula @xmath110 for some @xmath107 .",
    "the maximal number of arrows of the diagrams in the linear combination giving @xmath69 is an upper bound for the degree .",
    "however , in general the expression @xmath111 depends on the choice of the gauss diagram @xmath27 of a virtual knot . in our earlier work",
    "@xcite we did not present any systematic method for producing arrow polynomials @xmath69 which give invariants , and we posed the following question : `` which arrow polynomials define knot invariants ... ? ''",
    "we can now answer this question in the framework of the virtual theory : @xmath69 defines an invariant of degree at most @xmath0 if and only if all diagrams in @xmath69 have at most @xmath0 arrows and @xmath69 satisfies the equations @xmath112 , where @xmath113 runs over the left hand sides of the relations @xmath114 defining @xmath82 in @xmath54 , see section [ sfoi3 ] .",
    "the general method for producing all invariants of degree @xmath0 requires a computation of the algebra @xmath82 .",
    "some simple observations allow one to reduce this computation .",
    "first , by a repeated use of , one can eliminate arrows with the negative sign .",
    "second , since all the diagrams with more than @xmath0 arrows vanish , for diagrams with @xmath0 arrows equations and become simpler and contain only 2 and 6 terms respectively , all of them with exactly @xmath0 arrows . the simplified version of implies the following rule for elimination of negative arrows in diagrams with exactly @xmath0 arrows :",
    "if two such diagrams differ only by the signs of @xmath115 arrows , they differ in @xmath82 by multiplication by @xmath116 .",
    "this allows one to drop the signs of arrows in diagrams with @xmath0 arrows , using the convention that a diagram with @xmath115 negative signs of arrows is counted with coefficient @xmath116 .",
    "the simplified version of involves only diagrams with exactly @xmath0 arrows and looks as follows : @xmath117 this @xmath118-equation ( introduced earlier in @xcite ) is an oriented version of the well - known @xmath119-relation for chord diagrams .",
    "the @xmath119-relation can be recovered from by repeated use of the following formula which follows from : @xmath120      computation of @xmath82 for small @xmath0 can be done by hand and leads to some interesting results .",
    "similarly to the case of classical knots , there are no invariants of degree one .",
    "more surprisingly , the algebra @xmath121 is also trivial , so there are no invariants of degree two ! however , for long knots the corresponding algebra is 2-dimensional , so there are two independent invariants @xmath122 and @xmath19 of degree 2 .",
    "these invariants are given by @xmath123 this illustrates a curious feature of the theory of virtual knots which was discussed in section [ slk ] . for classical knots ,",
    "there is one - to - one correspondence between the isotopy classes of knots and long knots , hence any invariant of long knots is an invariant of closed knots .",
    "we now see that for virtual knots this is no longer true",
    ".    another interesting feature of this theory is that many invariants , which coincide for usual knots ( due to the existence of certain symmetries ) , are different on the larger class of virtual knots .",
    "the invariants @xmath122 and @xmath19 provide a good illustration .    in degree three",
    "there is only one invariant , given by @xmath124 it vanishes on real knots .",
    "similarly to degree two , for long virtual knots there are several invariants of degree three , which give the same degree three invariant of real knots .",
    "here is an example of such an invariant : @xmath125      our work in this direction started with a search for combinatorial formulas for finite type invariants of classical knots .",
    "the first results were summarized in the paper @xcite of the second and third authors .",
    "there a class of combinatorial formulas similar to was introduced , and numerous special formulas of this sort were found . in @xcite",
    "we posed the following question : `` can any vassiliev invariant be calculated as a function of arrow polynomials evaluated on the knot diagram ? '' in the terminology used above , an arrow polynomial evaluated on the knot diagram is an expression of the type given in .",
    "this question has been answered in the affirmative by the first author .",
    "the result is formulated as follows .",
    "[ gt ] let @xmath5 be an abelian group and let @xmath29 be a @xmath5-valued invariant of degree @xmath0 of long ( real ) knots",
    ". then there exists a function @xmath126 such that @xmath127 and such that @xmath13 vanishes on any arrow diagram with more than @xmath0 arrows .",
    "[ cgt ] any integer - valued finite type invariant of degree @xmath0 of long knots can be presented as @xmath128 , where @xmath69 is a linear combination of arrow diagrams on a line with at most @xmath0 arrows .",
    "the next section is devoted to the proof of this theorem .    to a large extent",
    ", the present paper was motivated by an analysis of the proof of [ gt ] , which originally was rather cumbersome .",
    "the main difficulties in this proof were caused by the necessity of requiring all the numerous gauss diagrams involved to be realizable .",
    "the desire to get rid of this restriction motivated our interest in virtual knots .",
    "indeed , for virtual knots the problem stated in @xcite is solved by theorem [ thm.invn ] above .",
    "the universal invariant of theorem [ thm.invn ] is essentially @xmath129 , so any @xmath5-valued invariant can be presented by a gauss diagram formula .",
    "unfortunately , for classical knots the new technique does not give a universal invariant .",
    "however it gives powerful and simple machinery to generate gauss diagram formulas for any invariant which can be extended to a finite - type invariant of virtual knots .",
    "hoping for the best , we conjecture    [ conj ] every finite - type invariant of classical knots can be extended to a finite - type invariant of long virtual knots .",
    "this may require the consideration of virtual framing .",
    "the extension given by kauffman @xcite @xcite of numerous invariants to virtual knots strongly supports this conjecture .",
    "the main open problem concerning finite type invariants of classical knots is whether such invariants distinguish non - isotopic knots .",
    "the positive solution of this problem would follow from the positive solution of the corresponding problem for virtual knots . by theorems [ thm.inv ] and [ thm.invn ] ,",
    "the latter can be reformulated in purely algebraic terms as the question whether the natural map @xmath130 is injective .",
    "the standard method for calculation of a vassiliev invariant @xmath29 goes as follows ( see @xcite ) .",
    "one picks a set of singular knots which span ( using relation ) the free abelian group generated by all nonsingular knots .",
    "the invariant @xmath29 is determined by its actuality table , i.e.  its values on this set .",
    "given a knot diagram , one unknots it , making it descending by a sequence of crossing changes . under each crossing change",
    "the invariant jumps .",
    "the jump is equal to the value of @xmath29 on the knot with a double point by .",
    "then each of these singular knots is deformed to a knot with a single double point from the actuality table by an isotopy and a sequence of crossing changes .",
    "the jumps of @xmath29 correspond to knots with two double points .",
    "they are again deformed to the knots from the actuality table .",
    "the process eventually stops when the number of double points exceeds the degree of @xmath29 ( by definition of the degree ) .    in the proof of [ gt ] ,",
    "both the actuality table and the procedure of expansion described above are made canonical .",
    "this is done by generalizing the notion of a descending diagram to singular knots .",
    "more importantly , this is done in terms of gauss diagrams , so that the notion of descending diagram and the procedure of expansion extend to virtual knots . for a real descending knot the isotopy class and hence the value of @xmath29",
    "is determined by the part of the gauss diagram encoding the double points . for a virtual descending diagram the isotopy type",
    "is not determined by this part of the gauss diagram .",
    "nevertheless we extend @xmath29 to virtual descending diagrams literally in the same way .",
    "we do not know whether the result is an invariant of virtual knots .. ] however , for our purposes , this formal extension turns out to be sufficient .",
    "next we use the isomorphism @xmath66 $ ] ( see proposition [ lem.iso ] ) to define @xmath126 as @xmath131 .",
    "some special properties of the extended map @xmath132\\to g$ ] are then used to prove that @xmath13 vanishes on diagrams with more than @xmath0 chords .      on a diagram of a long virtual singular knot each double point",
    "is naturally equipped with a sign .",
    "indeed , the branches at a double point are ordered and the sign is the intersection number of the branches ( taken in this order ) . on a gauss diagram of a long singular knot , each double point is shown by a dashed chord equipped with the above sign .",
    "a diagram @xmath26 is called a _ subdiagram _ of a diagram @xmath27 if @xmath26 consists of all the chords and some arrows of @xmath27 .",
    "recall that a diagram of a real long knot is descending if going along the knot in the positive direction we pass each crossing first going over and then under . in terms of gauss diagrams it means that all the arrows are directed to the right .",
    "we now extend this notion to virtual long knots with double points .",
    "we still require that all the arrows are directed to the right .",
    "there is also an additional condition : there is no chord whose left endpoint has an endpoint of an arrow as immediate left neighbor . in other words , the situations shown in figure [ forbsit ] are forbidden",
    ".    a real long knot with a gauss diagram of this type can be presented by a diagram such that    * all the double points are in the left half - plane , * all the crossings are in the right half - plane , * the intersection of the diagram with the left half - plane is an embedded tree , * the intersection with the right half - plane is an ordered collection of arcs ; each of them is descending and lies below all the previous ones .",
    "see figure [ fdesc ] .",
    "[ lem.c ] let @xmath133 and @xmath134 be gauss diagrams of real descending long knots and let @xmath29 be an invariant of long knots . if the chord parts of @xmath133 and @xmath134 coincide then @xmath135 .",
    "one can see that the isotopy class of a real descending long knot is determined by the chord part of its gauss diagram .",
    "indeed , the chord part determines the tree in the left half - plane ( recall that the chords have signs , which define the embedding locally ) .",
    "the rule for connecting the endpoints of the tree by arcs in the right half - plane is determined by the mutual position of the chords in the gauss diagram .",
    "since the diagram is descending , the connection by the arcs is unique up to isotopy .",
    "there is an algorithm for expressing the gauss diagram of a long knot with double points as a linear combination of descending diagrams .",
    "this algorithm consists of steps of two types . at each step , one inspects the gauss diagram from the left to the right looking for the first fragment where the diagram fails to be descending .",
    "such a fragment may either be a bad arrow or a bad chord .",
    "an arrow is bad if it is directed to the left .",
    "a chord is bad if an immediate left neighbor of its left endpoint is an endpoint of an arrow , as in figure [ forbsit ] .    in the case of a bad arrow",
    "the step of the algorithm is the replacement of the diagram with the sum of two diagrams according to the formula @xmath136 in terms of gauss diagrams this replacement is as follows : @xmath137    in the case of a bad chord the step of the algorithm is the pulling of the crossing over or under the appropriate branch by isotopy : @xmath138 @xmath139 in terms of gauss diagrams , this corresponds to one of the transformations shown in figure [ pullback ] .",
    "the different cases in figure [ pullback ] correspond to different orientations and possible orderings of the three arcs .    since we deal with an invariant of degree @xmath0 , the diagrams with more than @xmath0 chords are disregarded .",
    "thus , when one applies a step of the algorithm to a bad arrow in a diagram with @xmath0 chords , the summand with @xmath30 chords disappears .",
    "denote by @xmath140 the free abelian group generated by gauss diagrams of virtual long singular knots with at most @xmath0 chords ( note that @xmath59={\\mathcal d}_0\\subset{\\mathcal d}_n$ ] ) .",
    "we will think of a step of our algorithm as of an operator acting on @xmath140 .",
    "denote this operator by @xmath88 . by the definition of @xmath88 , for any descending gauss diagram @xmath27 we have @xmath141 .",
    "[ lem.b1 ] for any diagram @xmath142 there exists @xmath143 such that @xmath144 is a sum of descending diagrams .",
    "let @xmath145 be the number of chords of @xmath27 which have one of the endpoints to the left of the first bad fragment .",
    "as is easy to see , @xmath146 for each diagram in the expansion of @xmath147 .",
    "however the number of such chords in a non - descending diagram is at most @xmath0 .",
    "therefore it suffices to prove that the diagram can not change infinitely many times in subsequent iterations of @xmath88 without changing @xmath148 .",
    "consider the number of arrowheads on the ray to the left of the left endpoint of the @xmath149-th chord .",
    "for any diagram involved in the expansion of @xmath147 this number is not greater than that for @xmath27 .",
    "if it is the same for one of these diagrams , then it has less arrowtails on the same ray .",
    "this can happen only finitely many times .",
    "denote by @xmath150 the subgroup of @xmath140 generated by gauss diagrams of _ real _ long singular knots .",
    "any finite type invariant of classical knots of degree at most @xmath0 extends to @xmath150 by linearity .",
    "[ lem.a ] the operator @xmath151 preserves @xmath150 .",
    "the restriction of @xmath88 to @xmath150 preserves any invariant of degree at most @xmath0 .",
    "we now extend an invariant @xmath29 of degree at most @xmath0 to virtual descending diagrams . for any such diagram @xmath27",
    "there exists a descending diagram @xmath152 of a real knot with the same double points , i.e. , the same chord part of the gauss diagram .",
    "@xmath152 can be obtained by turning all the virtual crossings of @xmath27 into appropriate real ones .",
    "put @xmath153 . by lemma [ lem.c ] ,",
    "@xmath154 does not depend on the choice of @xmath152 .",
    "next we extend @xmath29 to all virtual diagrams . by lemma [ lem.b1 ] ,",
    "for any diagram @xmath142 there exists @xmath143 such that @xmath144 is a sum of descending diagrams and hence @xmath155 is already defined .",
    "put @xmath156 .",
    "lemma [ lem.a ] implies that on @xmath152 this agrees with the initial definition of @xmath29 . since @xmath157 we get :    [ p preserves nu ] the operator @xmath151 preserves @xmath29 , i.e.  @xmath158 .",
    "we are now in a position to construct the map @xmath126 of theorem [ gt ] . define @xmath126 as the composition @xmath159\\subset { \\mathcal d}_n@>\\nu>>g , \\end{cd}\\ ] ] where @xmath160 is the isomorphism of proposition [ lem.iso ] and @xmath29 is the extension of the original finite type invariant to @xmath140 .",
    "then for any diagram @xmath27 of a long knot @xmath161    in order to prove theorem [ gt ] , we must show that @xmath162 for any arrow diagram @xmath69 with more than @xmath0 arrows .",
    "the rest of this section is devoted to the proof of this fact .",
    "the algebra @xmath54 of arrow diagrams on the line is generated by diagrams consisting of the line and dashed arrows ( oriented signed arcs ) .",
    "consider now diagrams which in addition to arrows also contain dashed chords , i.e.  unoriented signed arcs .",
    "denote by @xmath163 the free abelian group generated by such diagrams with at most @xmath0 chords .",
    "the maps @xmath164\\to{\\mathcal a}$ ] defined in section [ sfoi2 ] on gauss diagrams without chords extend to isomorphisms @xmath165 .",
    "the chord parts of the diagrams remain intact under both @xmath166 and @xmath63 , while the arrows are dealt with as in section [ sfoi2 ] .",
    "we now define an operator @xmath167 , which is an analogue of @xmath88 .",
    "a diagram @xmath168 is called descending , if @xmath169 is descending .",
    "put @xmath170 if @xmath69 is descending . otherwise , find the leftmost bad fragment of @xmath69 ( the notion of a bad fragment is borrowed from @xmath140 via @xmath166 ) .",
    "if it is a bad arrow , we define @xmath171 . if it is a bad chord , put @xmath172 where the sum runs over all the subdiagrams of @xmath173 , each of which contains all the arrows not shown in figure [ pullback ] , all the chords and at least one more arrow .",
    "in other words , we sum up all seven subdiagrams of @xmath173 which contain all the arrows and chords also belonging to @xmath69 plus at least one more arrow .",
    "[ remq]observe that in both cases , we sum up all subdiagrams of diagrams in @xmath173 which are not subdiagrams of @xmath69 , but contain all arrows of @xmath69 except for the arrow involved into the bad fragment",
    ". the arrows of @xmath69 which are not in the leftmost bad fragment play a passive role in the construction of @xmath174 : if @xmath70 is a subdiagram of @xmath69 obtined by removing arrows which are not in the leftmost bad fragment , then @xmath175 is obtained from @xmath176 by removing the same arrows from each of the summands .",
    "[ q increases arr+ch ] for any diagram @xmath168 , the total number of arrows and chords in each diagram appearing in @xmath176 is at least the total number of arrows and chords in @xmath69 .",
    "[ lem.b2 ] for any diagram @xmath168 , there exists @xmath143 such that @xmath177 is a sum of descending diagrams .",
    "the proof of this lemma is completely analogous to the proof of lemma [ lem.b1 ] .",
    "[ lem.e ] for any non - descending diagram @xmath142 , there is a splitting @xmath178 with @xmath179 such that @xmath180 and such that @xmath181 , where @xmath182 is a sum of diagrams each of which has fewer arrows than @xmath27 .",
    "let @xmath183 be the sum of all the subdiagrams of @xmath184 which include the first bad fragment of @xmath184 .",
    "these subdiagrams contain the same bad fragment as the whole diagram @xmath184 .",
    "as follows from remark [ remq ] , @xmath185 is the sum of all subdiagrams of diagrams in @xmath186 which are not subdiagrams of @xmath184 .",
    "then @xmath187 is the sum of the subdiagrams of @xmath184 which do not contain the arrow from the bad fragment ( in the case of a bad chord , this is the arrow shown on the left hand side of figure [ pullback ] ) and these subdiagrams of @xmath184 remain unchanged , when one applies @xmath88 to @xmath27 .",
    "thus @xmath188 .",
    "[ q preserves pi ] the operator @xmath167 preserves @xmath13 , i.e.  @xmath189 .",
    "let @xmath168 be a diagram and @xmath190 .",
    "let us prove that @xmath191 by induction on the number of arrows in @xmath69 .",
    "if this number equals @xmath104 , then @xmath69 is descending and @xmath170 by definition of @xmath174 .",
    "suppose inductively that the statement is correct for any diagram whose number of arrows is less then the number of arrows in @xmath69 and let us prove the statement for @xmath69 .",
    "apply @xmath13 to : @xmath192 by lemma [ p preserves nu ] and the definition of @xmath13 @xmath193 thus @xmath194 . by the induction assumption , @xmath195 , where @xmath196 ( as in lemma [ lem.e ] ) , and we obtain the desired equality @xmath191 .",
    "this completes the induction step .",
    "[ lem.-1 ] let @xmath168 be a descending diagram such that the total number of arrows and chords in @xmath69 is greater than @xmath0 .",
    "then @xmath162 .",
    "let @xmath190 . by the definition of @xmath13 and proposition [ lem.iso ] , @xmath197 since any subdiagram @xmath26 of @xmath27 is descending and has the same chord part , @xmath198 by the construction of @xmath29 .",
    "therefore @xmath199 as one can easily check by induction on the number of arrows in @xmath69 , the sum in parentheses is equal to 1 if @xmath69 has no arrows and is 0 otherwise .",
    "since all the diagrams in @xmath163 have at most @xmath0 chords and the total number of arrows and chords in @xmath69 is greater than @xmath0 , it has at least one arrow",
    ". hence @xmath162 .",
    "[ lem.-0 ] let @xmath168 be a diagram such that the total number of arrows and chords in @xmath69 is greater than @xmath0 .",
    "then @xmath162 .",
    "let @xmath143 be the number which exists for @xmath69 by lemma [ lem.b2 ] .",
    "by lemma [ q preserves pi ] , @xmath200 . by lemma",
    "[ q increases arr+ch ] , the expansion of @xmath177 contains only descending diagrams with the total number of chords and arrows greater than @xmath0 .",
    "then by lemma [ lem.-1 ] , @xmath162 .",
    "this concludes the proof of theorem [ gt ] .",
    "let @xmath27 be a gauss diagram and let its arrows be colored with @xmath0 colors .",
    "consider all subdiagrams which can be obtained from @xmath27 be removing all arrows colored with one or several colors .",
    "if all arrows of each of these diagrams can be removed by the second reidemeister moves , then the coloring is said to be destroying .",
    "the property of @xmath0-triviality does not change if one reverses the orientation of some of the segments .",
    "it also does not change if one simultaneously reverses the orientations or the signs of all arrows connecting two segments .      on a gauss diagram @xmath27 , choose several segments which do not contain an endpoint of any arrow .",
    "adjoin to @xmath27 arrows of an @xmath201-trivial gauss diagram based on the chosen segments .",
    "this transformation of @xmath27 is called an _ @xmath0-variation . _      in figure [ 2-var ] we show the simplest 2-variations . to get the corresponding destroying coloring , one colors all arrows connecting the first two strings with one color and the other arrows with the other color .",
    "it is easy to see that these 2-variations do not change @xmath203 .",
    "two gauss diagrams are said to be _",
    "@xmath0-equivalent _ if they can be transformed to each other by a sequence of isotopies and @xmath36-variations .",
    "for example , the gauss diagrams shown in figure [ 2-var ] are 1-equivalent .",
    "moreover , one can prove that any two 1-equivalent gauss diagrams can be transformed to each other by a sequence of isotopies and the 2-variations of figure [ 2-var ] . a 1-equivalence class of string links is completely determined by the invariants @xmath203 .",
    "therefore any two closed virtual knots are 1-equivalent and can be transformed to each other by a sequence of the reidemeister moves and the forbidden moves of figure [ forbmove ] .",
    "the transition from the use of gauss diagrams to that of @xmath0-equivalence classes yields better results when the set of gauss diagrams is equipped with a natural multiplication .",
    "for example , in the case of virtual string links ( and , in particular , long knots ) @xmath0-equivalence classes form a group .    in the cases of virtual knots and ( closed )",
    "links the set of @xmath0-equivalence classes has a more complicated algebraic structure . as in the case of classical links , the following trick works .",
    "consider a virtual string link with @xmath206 strings .",
    "it can be turned into a closed one by adding @xmath0 arcs from above and below ( this generalizes the plat presentation of a link with braids replaced by string links ) .",
    "this gives rise to a map from the group of @xmath0-equivalence classes of virtual string links to the set of @xmath0-equivalence classes of closed virtual links .",
    "this map is a double coset factorization . from the left we quotient out by string links which become @xmath0-equivalent to the trivial one by adding only arcs from below , and from the right , similarly with arcs from above .",
    "both sets of string links give rise to subgroups which are not normal in general .",
    "the value of a finite type invariant of degree @xmath1 depends only on the @xmath0-equivalence class . usually , in a non - group situation",
    ", invariants of degree @xmath1 do not separate all the @xmath0-equivalence classes . for instance",
    ", virtual closed knots do not admit an invariant of degree 2 .",
    "d.bar-natan , _ polynomial invariants are polynomial _ , harvard university preprint , december 1994 .",
    "g.cairns and d.m.elton , _ the planarity problem for signed gauss words , _",
    "j. knot theory and its ramifications * 2 * ( 1993 ) 359367 .",
    "d.joyce , _ a classifying invariant of knots , the knot quandle , _ j. pure appl .",
    "algebra , * 23 * ( 1982 ) , 37 - 65 . l.kauffman , _ virtual knots , _ talks at msri meeting in january 1997 and ams meeting at university of maryland , college park in march 1997 .",
    "l.kauffman , private communication , 4.08.1998 .",
    "p.stlund , preprint uppsala university , 1997 .",
    "m.polyak and o.viro , _ gauss diagram formulas for vassiliev invariants , _ international math .",
    "research notices , ( 1994 ) , no .",
    "11 , 445453 m.polyak , _ arrow diagrams and link homotopy invariants , _ preprint k.reidemeister , _ zur dreidimensionalen topologie _ , abh .",
    "hamburg , 9 ( 1933 ) , 189194 .",
    "j.singer , _ three - dimensional manifolds and their heegaard diagrams _ , trans .",
    "* 35 * ( 1933 ) , 88111 .",
    "v.a.vassiliev , _ cohomology of knot spaces _ ,",
    "theory of singularities and its applications ( providence ) ( v.i.arnold , ed . )",
    "soc . , providence , 1990 ."
  ],
  "abstract_text": [
    "<S> we observe that any knot invariant extends to virtual knots . </S>",
    "<S> the isotopy classification problem for virtual knots is reduced to an algebraic problem formulated in terms of an algebra of arrow diagrams . </S>",
    "<S> we introduce a new notion of finite type invariant and show that the restriction of any such invariant of degree @xmath0 to classical knots is an invariant of degree @xmath1 in the classical sense . </S>",
    "<S> a universal invariant of degree @xmath1 is defined via a gauss diagram formula . </S>",
    "<S> this machinery is used to obtain explicit formulas for invariants of low degrees . </S>",
    "<S> the same technique is also used to prove that any finite type invariant of classical knots is given by a gauss diagram formula . </S>",
    "<S> we introduce the notion of @xmath0-equivalence of gauss diagrams and announce virtual counter - parts of results concerning classical @xmath0-equivalence . </S>"
  ]
}