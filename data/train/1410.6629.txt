{
  "article_text": [
    "companies and organizations are constantly under attack by cybercriminals trying to infiltrate corporate networks with the ultimate goal of stealing sensitive information from the company . such an attack",
    "is often started by sending a _ spearphishing _ email .",
    "attackers can breach into a company s network in many ways , for example by leveraging advanced malware schemes  @xcite .",
    "after entering the network , attackers will perform additional activities aimed at gaining access to more computers in the network , until they are able to reach the sensitive information that they are looking for .",
    "this process is called _",
    "lateral movement_. attackers typically infiltrate a corporate network , gain access to internal machines within a company and acquire sensitive information by sending _ spearphishing _ emails . in a spearphishing attack an email",
    "is crafted and sent to a specific person within a company , with the goal of infecting her machine with an unknown piece of malware , luring her to hand out access credentials , or to provide sensitive information .",
    "recent research showed that spearphishing is a real threat , and that companies are constantly targeted by this type of attack  @xcite .",
    "* spearphishing is not spam . * while they may share a few common characteristics , it is important to note that spearphishing is still very different from traditional email spam . in most cases ,",
    "spearphishing emails appear to be coming from accounts within the same company or from a trusted party , to avoid raising suspicion by the victim  @xcite .",
    "this can be done in a trivial way , by forging the ` from : ` field in the attack email . however , in more sophisticated attacks , the malicious emails are actually sent from a _ legitimate _",
    "employee s email account whose machine has been compromised , or whose credentials have been previously stolen by the attacker  @xcite . from the attacker s perspective , this modus operandi presents two key advantages .",
    "first , it leverages a user s social connections : previous research showed that users are more likely to fall for scams if the malicious message is sent by somebody they trust  @xcite .",
    "secondly , it circumvents existing detection systems , which are typically based on anti - spam techniques .",
    "this happens for two reasons : first , the content of spearphishing emails looks in many cases completely legitimate and it does not contain any words that are indicative of spam , since the goal is to make it resemble typical business emails .",
    "second , if an email impersonating one of the company s employees comes from that person s computer , which has been compromised , then origin - based detection techniques , such as ip reputation , become useless .",
    "secondly , it circumvents all ip and origin - based blacklisting systems , as well as email sender or domain verification systems such as _ sender policy framework _",
    "( spf ) and _ domainkeys identified mail _ ( dkim )",
    "@xcite , since the email is sent from a genuine email account .    * a new paradigm for fighting targeted attack emails . * given how different spearphishing emails are compared to traditional spam and phishing emails , we propose a _ paradigm shift _ in detection approaches to fight this threat , and present identitymailer , a system to detect and block spearphishing emails sent from compromised accounts . instead of looking for signs of maliciousness in emails ( such as words that are indicative of illicit content , phishy - looking content , or suspicious origin )",
    ", identitymailer determines whether an email was actually written by the author that it claims to come from . in other words",
    ", we try to automatically validate the genuineness of the email authorship .",
    "our approach is based on a simple , yet effective observation : most users develop habits when sending emails .",
    "these habits include frequent interactions with specific people , sending emails at specific hours of the day , and using certain greetings , closing statements , and modal words in their emails .",
    "the core of identitymailer consists in building a user profile reflecting her email - sending behavior . when a user s account gets compromised , the attack emails that are sent from this account are likely to show differences from the behavioral profile of the genuine user .",
    "behavioral anomalies can be very evident or more subtle .",
    "an example of a `` noisy '' attack is a worm that sends an email to the entire address book of a user  @xcite , which is a behavior that typical users do not show . in more realistic scenarios ,",
    "attackers might try to mimic the typical behavior of the person they are impersonating in their emails .",
    "what they could do is sending emails only at hours in which the user is typically sending them , and only to people she frequently interacts with , or even imitate the user s writing style .    to make it more difficult for attackers to successfully evade our system",
    ", identitymailer builds the email - sending behavioral profile for a particular user by leveraging both the emails previously sent by that specific user and a set of emails that other users in the organization authored . in a nutshell , identitymailer compares the emails written by the user to the ones written by everybody else and extracts those characteristics that are the most representative of the user s behavior .",
    "if common characteristics are shared by multiple users , however , these will be de - emphasized because they are not specific to a particular user .",
    "for example , certain functional words only used by a given user ( and rarely by others ) would model her behavior well .    when an attacker tries to learn a victim s sending behavior to mimic it in his attack emails , he only has access to that user s emails ( since he compromised her account or personal machine ) .",
    "it is unlikely , however , that he has access to the ones authored by all other users within the company  besides the few emails exchanged by the victim and the coworkers he / she is interacting with .",
    "therefore , all the attacker can do is learning the most common habits of the user ( such as the email address that is more frequently contacted , and at what time the user generally sends emails ) , but he has no guarantee that those traits are actually representative of the victim s behavior .    *",
    "working on the sending end .",
    "* traditional anti - spam systems work on the receiving end of the email process .",
    "this means that they analyze incoming emails , and establish whether they are legitimate or malicious .",
    "this approach is very effective in general , but it has many drawbacks in our specific case .",
    "first of all , the analysis that can be performed on incoming emails has to be lightweight , due to the large amount of emails , mostly malicious , that mail servers receive  @xcite . as a second drawback , learning the typical behavior of a user on the receiving end has the problem that a mail server only has visibility of the emails that are exchanged between that user and people whose mailboxes are hosted on the server .",
    "therefore , a behavioral profile built from these emails might not be representative enough to correctly model the sending habits of users .",
    "because of the aforementioned problems , we propose to perform the analysis when emails are sent , before they are forwarded to the outgoing smtp server .",
    "our approach builds a behavioral profile based on the emails that a user sent in the past ( and a set of emails authored by the other people in the organization ) .",
    "then , every time an email is sent by that account , our approach checks if this email matches the profile learned for the real account s owner .",
    "if the email does not match the learned profile , we consider it anomalous",
    ". the account might have been compromised , and the email might actually be an attack attempt .",
    "however , the anomaly might also be a false positive .",
    "perhaps the user is working on a deadline , and is sending emails late at night , or is sending a personal email , and using a colloquial language , while the account is primarily used to send work - related emails .",
    "false positives are a big problem in traditional anti - spam systems , because they annoy users in the best case , and they prevent them from receiving important emails in the worst case .",
    "luckily , the fact that our approach operates on the sending side of the email process comes to our aid .",
    "any time an email is flagged as anomalous , we can start a process to verify the identity of a user . in our design",
    ", this process would include sending a confirmation code to a device owned by the user , as part of a two - factor authentication scheme  @xcite .",
    "if the user correctly inputs the confirmation code when asked we consider the anomaly as a false positive , and the email is forwarded .",
    "in addition , we update the user s behavioral profile to include this particular email , so that we will we avoid similar false positives in the future .",
    "if the user fails at solving the challenge , however , we consider the email as a possible attack , and we discard it . we acknowledge that having to go through an identity - verification process can be annoying for users . however , we think that having users confirm their identity once in a while is a fair price to pay to protect a company against advanced email attacks , as long as the verifications are rare enough ( for example , one in every 30 emails on average ) .",
    "we tested identitymailer on a large set of publicly - available emails , and on real world data sets made of malicious targeted emails sent to the customers of a large security company .    in summary",
    ", this paper makes the following contributions :    * we propose a new approach to detect spearphishing emails sent from compromised accounts : instead of looking for signs of maliciousness , we introduce a set of features that are representative of the email - sending behavior of a user , and propose a method to check emails against the learned sending behavior ( _ i.e. _ , email authorship validation ) .",
    "* we implemented the approach in a system called identitymailer , which was tested against a large dataset of publicly - available emails , as well as other real - world datasets of targeted attack emails .",
    "our experimental results show that our approach can effectively block spearphishing emails that state - of - the - art systems failed to detect with a detection rate above 90% for users with a _ sent _ history of only 1,000 emails .",
    "in contrast , existing systems that look for signs of maliciousness are failing to detect most of these advanced email attacks .",
    "* we show that having access to the emails sent by the victim is not sufficient to evade identitymailer , and that imitating the most common characteristics present in those emails can even augment the chances of being detected by the system .",
    "spearphishing can be broadly defined as targeted phishing . in traditional phishing emails , attackers pretend to be operators from online services such as online social networks or online banking portals , and lure their victim into inserting their credentials on a fake web page that reproduces the home page of that online service .",
    "an example of phishing email is shown in figure  [ fig : phishing ] .",
    "a spearphishing email is a type of phishing email for which the attacker collected some information about the victim , and included it in the attack email to make it more believable  @xcite .",
    "a spearphishing attack can be more or less sophisticated .",
    "an example of an attack with a low sophistication is a password reset request for a corporate service sent to all the employees of a company . in this case , the only difference with a traditional phishing email is that , unlike phishing attempts against common online services , all people receiving the malicious email supposedly have an account on the corporate service .",
    "a more sophisticated spearphishing attack is one that targets a specific person within a company , and leverages personal information about that person in order to make the email look even more convincing .",
    "attacks of such sophistication can usually be detected by variations of traditional anti - spam and anti - phishing techniques .",
    "for instance , the attack email might be coming from an ip address that does not belong to the online service that it is allegedly coming from ; similarly , the url of the link in the phishing email might not hosted on the domain of the online service .",
    "systems that look at the source ip address of an email  @xcite or at the actual phishing web page  @xcite are able , in general , to detect such attacks .",
    ".... received : from [ foreign ip ] from : < support@site.com > to : < victim@company.com >    dear user , your account has been hacked .",
    "please reset your password   < a href=\"http://fakesite.org \" > here < /a",
    "> ....    .... received : from [ company ip ] from : < manager@company.com > to : < victim@company.com >    dear < victim > , as discussed during our meeting ,   please send me the latest report .",
    "the template to use is attached .",
    "thanks , < manager > ....    although existing anti - spam and anti - phishing techniques can be adapted to detect certain types of spearphishing attacks , as the attacker gets even more sophisticated , these techniques become inadequate in fighting this threat .",
    "consider , for example , the spearphishing email in figure  [ fig : spearphishing ] . in this case , the attacker managed to compromise the email account of one of the company s managers , and is using it to send an email to a member of his team .",
    "in the attack email , the attacker asks the victim to send his boss a copy of the latest report .",
    "the victim is very likely to fall for this attack because there is nothing indicative of a malicious email : the email is coming from the email account of the manager , and therefore the ip address is the correct one ; similarly , the language of the email is not suspicious at all , because the language used is typical of regular business emails .",
    "in addition , since the attacker has access to the manager s email account , he can retrieve the report directly from there , once the victim sends it , and does not need to include the link to an external web server in the spearphishing email . from the perspective of traditional anti - spam and anti - phishing techniques",
    ", the email in figure  [ fig : spearphishing ] looks perfectly authentic , and has no indicators for being flagged as anomalous .    in this paper",
    ", we propose a technique that can detect sophisticated spearphishing emails that do not present any signs of maliciousness .",
    "as we said , our approach works as follows : first , we learn the typical behavior of a user based on his sent email history ; then , we compare each new email sent from that user account to determine if it does match the learned behavior . in the following sections , we describe our approach in more detail .",
    "in the very first stage , identitymailer must accurately learn and model the email - sending behavior of a user , as it will enable us to perform better detection of anomalous emails in a later stage .",
    "however , defining user - specific traits that best distinguish a user s sending behavior is not trivial . to determine these traits ,",
    "identitymailer requires two datasets : a set @xmath0 of emails written by a user @xmath1 and a set @xmath2 of legitimate emails written by other people . by comparing the emails in @xmath0 to the ones in @xmath2",
    ", we can extract the distinguishing characteristics of the email - sending behavior of @xmath1 .",
    "@xmath2 should be composed of both emails sent by people working in the same organization as @xmath1 , as well as of emails written by people who are completely unrelated to @xmath1 .",
    "as we will explain later , the privacy concerns of our approach are minimal , because we do not save the full email , but only a feature vector associated to it . on one side , having @xmath2 built from the emails sent by the users working in the same organization as @xmath1 helps in giving less importance to common characteristics shared by coworkers .",
    "for example , if no user in the organization ever sends emails on sundays , it is less peculiar if the user follows this trend . on the other hand",
    ", having emails sent by users who are completely unrelated to @xmath1 in @xmath2 helps giving to the model examples of behavioral characteristics that are uncommon in the organization , but common outside of it .",
    "we provide a more detailed description on how we build @xmath2 in section  [ sec : building ] . by using only legitimate emails to build our behavioral profiles , identitymailer does not need to have ever observed any attack email to perform detection , similarly to what happens with traditional anomaly - detection systems .",
    "this is important , because it makes our approach independent from specific attack schemes .    to build the email - sending behavioral profile for a user , we proceed in two steps",
    "first , we extract a number of features for each email in @xmath0 and @xmath2 . as a second step , we leverage these feature vectors to build a classification model , which represents the actual behavioral profile .",
    "we use this profile to analyze any email written by the user , and determine whether it was really written by that user .",
    "we define three classes of email features , which pertain to : _ writing habits _ , _ composition habits _ , and _",
    "interaction habits_. previous research showed that authorship identification is possible by looking at stylometry features ( which are a subset of what we call writing habits )  @xcite .",
    "however , these approaches rely on texts of a certain length ( 250 words or more )  @xcite . unfortunately , as we show in section  [ sec : evaluation ] , many emails are short .",
    "if our approach relied only on the writing habits of a user ( i.e. , stylometry features ) , it would fail at detecting short attack emails .",
    "therefore , we need additional information to deal with such emails , as described here after . in the following ,",
    "we describe the features that our approach uses to characterize an email",
    ".    * writing habits .",
    "* people normally develop their own writing style .",
    "for example , some people use certain functional words ( such as `` although '' ) more often than others , or write dates in a certain way . analyzing",
    "a user s style has been used in the past to determine authorship of texts and emails  @xcite .",
    "similarly , we consider a user s writing style as a strong indicator of email authorship .",
    "an attacker could , in principle , learn the characteristics of his victim s style , and replicate them in the attack emails that he sends .",
    "however , previous research showed that imitation of another person s writing style is detectable most of the time  @xcite .",
    "in addition , as we will show in section  [ sec : adapting ] , it is difficult for an attacker to figure out which features are the most representative of a user s writing style . in the following ,",
    "we define a number of features that help defining a user s writing style . the complete list of writing - habit features used by identitymailer can be found in table  [ sec : featureswriting ] .",
    "_ 1 ) character occurrence ( 62 features ) .",
    "_ these features represent how often a character , or a set of characters , appear in the email text . given a set of characters @xmath3 and an email text @xmath4",
    ", we define the character occurrence of @xmath3 in @xmath4 @xmath5 as the number of times that any of the characters in @xmath3 occur in @xmath4 , divided by the length of @xmath4 .",
    "examples of character occurrence features include the frequency of alphabetical letters ( such as `` a '' ) , the frequency of certain punctuation signs ( such as `` ; '' ) , and the frequency of sets of characters ( such as capital letters or cardinal numbers ) .",
    "_ 2 ) functional word occurrence ( 344 features ) .",
    "_ these features represent how often the person uses specific functional words .",
    "we define as functional words those words that do not serve to express content , but instead are used to express grammatical relationships with other words within a sentence .",
    "these include adverbs ( such as `` when '' ) , auxiliary verbs ( such as `` is '' ) , and prepositions ( such as `` for '' ) . some of these features are useful to determine whether a user uses certain functional words in their extended or shortened form , and to what extent ( for example , whether she usually uses `` do nt '' instead of `` do not '' ) . given a word @xmath6 and a set of words",
    "@xmath7 in an email , we calculate the word occurrence @xmath8 in @xmath7 as the number of times @xmath6 occurs in the email , divided by the size of @xmath7 .",
    "_ 3 ) special word occurrence ( 11 features ) .",
    "these features represent how often a user uses certain `` special '' words in her emails .",
    "special words include full names , dates , and acronyms . given a regular expression @xmath9 representing the special word , an email @xmath4 , and a set @xmath7 containing the words in @xmath4 , we calculate the special word occurrence @xmath10 of @xmath9 as the number of matches in @xmath4 for @xmath9 , divided by the size of @xmath7 .",
    "_ 4 ) generic style characteristics ( 38 features ) . _",
    "these features represent generic characteristics of the style of a user .",
    "examples include the type of bullets that the user uses in lists ( `` 1- '' , `` 1 . '' , or others ) , whether she uses a comma as a separator for large digits or not , and whether she uses a space after punctuation .",
    "given a set of regular expressions @xmath11 representing a style characteristic , an email @xmath4 , and a set @xmath7 containing the words in @xmath4 , we define the style characteristic @xmath12 as the number of matches of the regular expressions in @xmath11 in the email @xmath4 , divided by the size of @xmath7 .",
    "_ 5 ) style metrics ( 33 features ) . _",
    "these features capture information about the style of entire emails .",
    "some features are rather simple , such as the number of paragraphs in the email .",
    "others are more advanced , and depict the expressiveness of the language used in the email .",
    "examples are the _",
    "sichel measure _ or the _ yule metric _ , which describe how complex the vocabulary used by an author is .",
    "these metrics have been already used in previous work on authorship identification  @xcite",
    ".    _ 6 ) context - specific words ( variable number of features ) . _",
    "these features look for occurrences of words that are common in a certain industry .",
    "people working in that industry will use them more or less frequently , depending on their role in the company and their specific job .",
    "examples of context - specific words for a financial institution include the words `` stock '' , `` asset '' , and `` contract . ''",
    "given a word @xmath13 and a set of words @xmath7 in an email , we calculate the context - specific word occurrence @xmath14 as the number of occurrences of @xmath13 in @xmath7 , divided by the size of @xmath7 .",
    "context - specific words vary with the type of business that the company is doing , and have been used in other authorship - recognition research  @xcite .",
    "we discuss the choice of context - specific words that we used in our experiments in section  [ sec : classifieranalysis ] .",
    "[ cols= \" < , < , < \" , ]     as we said previously , the techniques used in identitymailer for building the email - sending behavioral profiles enable us to extract those characteristics that identify a certain user s sending behavior best , hence performing accurate classification and obtaining better detection .",
    "of course , an attacker could imitate a user s sending behavior , as an attempt to evade detection by our system . an attacker who compromised a user s machine or email account typically has access to the emails sent by that user in the past ( for example , through the _ sent _ folder of the user s mailer program ) .",
    "he can thus leverage these emails to learn what are the most common characteristics in a users email - sending behavior , and replicate them in his malicious emails .",
    "however , since the attacker does not have access to all emails sent by all other users in the organization , it is difficult for him to know whether those characteristics , although common in the user s behavior , distinguish the user well from the others .",
    "in fact , the most common characteristics of a user s behavior might be shared with many other users , thus by replicating them an attacker would not obtain any effect on the success of his attack .",
    "even worse , he might focus on characteristics that have a marginal importance or very low relevance in the behavioral profile built by identitymailer , and make other characteristics stand out , in fact making detection easier .    to investigate what would be the effects of an attacker actively trying to evade our system",
    ", we developed a number of evasion techniques , and tested them on the spearphishing dataset @xmath15 .",
    "in particular , for each user @xmath1 , and every email @xmath4 in @xmath15 , we extracted the feature vector @xmath16 , and modified a number of parameters , to make the email look more similar to the ones typically sent by @xmath1 .",
    "we then applied the same detection approach described in section  [ sec : detecting ] to this modified dataset . in the following ,",
    "we describe the different evasion schemes that we developed",
    ".    * coworkers .",
    "* this is the simplest evasion scheme . instead of sending attack emails to email addresses outside the user s organization",
    ", the attacker sends an email to another user within the same company , with whom the victim exchanged at least one email in the past .",
    "the destination address is picked at random .",
    "* high activity time period .",
    "* in this evasion scheme , the attacker sends emails on the day and hour during which the user has sent the highest number of emails in the past .    * top contact . *",
    "this technique is similar to the _ coworkers _ one , except that the destination address is chosen as the one to which the user sent the highest number of emails .    *",
    "mimic . * in this technique , the attacker tries to replicate the writing style of the victim .",
    "in particular , he learns the @xmath17 most common functional and context - specific words used by the user , and he uses them in the attack emails with the same ratio as typically used by the victim in her legitimate emails .",
    "we experimented two different evasion techniques of this kind , replicating the 10 and 20 most common words used by a user , respectively .",
    "we tested these evasion techniques described here above individually , as well as in conjunction with each other .",
    "table  [ tab : evasion ] provides a summary of the results for every ( combination of ) evasion techniques , compared with the results obtained with the unmodified dataset . in each evasion scenario , the _ failure _ , _ success _ , and _ no effect _ columns indicate the number of victim users for which the evasion attack has failed , was successful , or did not change , respectively . the _ average change _ field indicates the average percentage of emails that successfully evaded identitymailer for that strategy , compared to the detection on the unmodified dataset .",
    "a negative value indicates that , on average , identitymailer performed better on the modified dataset than on the original one .",
    "as it can be seen , none of the evasion techniques guarantees that the attack emails will be more successful in evading identitymailer .",
    "all evasion techniques ( except for the _ coworkers _ and _ top contact _ ones ) provide , on average , an increase in the number of emails that are not detected as malicious by our approach .",
    "however , even in the most successful case , in which we use the _ time _ , _ top contact _ , and _ mimic 20 _ techniques in conjunction , the evasion fails for 43% of the users , allowing identitymailer to detect more emails as malicious than for the unmodified dataset .",
    "if we look at the entire user population , this advanced evasion scheme would have enabled an additional 8.4% of emails to evade detection ; this means that , for a user who sent 1,000 emails in the past , identitymailer would have still been able to block 82% spearphishing emails on average . given these results",
    ", we can conclude that it is not straightforward for an attacker to evade detection by identitymailer , and that our system is quite resilient against this type of evasion technique even when the attacker tries to mimic the victim s email sending habits .",
    "an attacker might try a replay attack , by taking an email that was written by a user in the past , and sending it again .",
    "this strategy has the limitation that the attack is limited to the content that the user has already written in the past .",
    "we acknowledge that in some cases this strategy might be viable",
    ". however , this more extreme case of mimicry attack would be straightforward to mitigate , as we can easily trigger an identity verification process any time an email results in a feature vector that is identical to another one observed in the past .",
    "another technique that an attacker could try is imitating the email - sending behavior learning phase of our system . to this end",
    ", he might leverage the emails that other users sent to the victim in the past as @xmath2 .",
    "the attacker can find these emails , for example , in the _ inbox _ of the victim s mailer program . in principle , this technique could help in making the attack more successful , and evade identitymailer .",
    "however , the information that an attacker can learn from the emails received by a user in the past is limited .",
    "for example , it does not give any information on what the social networks of the other users in the company look like , and it only shows the behavior that third party showed when interacting with that specific user",
    ". an attacker might get additional knowledge of the company s emails by compromising additional email accounts .",
    "if he obtained access to a significant number of accounts , he might be able to replicate the learning process of identitymailer and evade our system .",
    "however , an attack of such breadth is hard to set up , and once an attacker gets such a pervasive presence is the company s network , there is not much that our approach ( or possibly any other ) can do .",
    "our results show that identitymailer is successful in detecting and blocking attack emails that appear to have been written by a legitimate user , but have actually been authored by an attacker abusing someone else s account . like most detection systems , however , identitymailer has some limitations.the main limitation is that , to be effective , identitymailer requires an email history of at least 1,000 emails .",
    "this makes it difficult to protect , for example , the new hires of a company .",
    "we argue that email is such a pervasive communication medium that it should not take long to obtain a sufficient number of emails even for a new employee .",
    "in addition , a new hire is probably not going to be a good target for an attacker , either due to a lack of visibility or because an attacker would prefer to target more influential people in the company .",
    "these individuals , however , will have a long email - sending history , and identitymailer will thus protect them effectively . another possible limitation in a corporate setting",
    "is that high - ranked executives might delegate their assistants to write some emails on their behalf .",
    "this practice might generate false positives , because identitymailer would detect that those emails were not written by the owner of the account .",
    "a possible mitigation here is to learn multiple email - sending behaviors corresponding to a limited set of individuals who are using the same account , and thus avoid generating an alert if the email appears to be authored by any of those users .",
    "another limitation of identitymailer is that writing - habit features are specific to the english language .",
    "if our approach had to protect the employees of a company whose main language is different than english , we would have to develop another set of language - specific features .",
    "previous research showed that this is feasible even for asian languages , which have very different characteristics than english  @xcite .    in section  [ sec :",
    "adapting ] we showed that it is difficult for attackers to successfully evade our system .",
    "however , attackers could exploit weak points in identitymailer s deployment at specific companies .",
    "for example , if an organization used a publicly - available set of emails as @xmath18 , an attacker might get access to that dataset , use it in a similar way to learn the models and thus evade our system",
    ". however , the attacker would still not have access to the emails used by all the other employees of the company , and the knowledge of the attacker would still be incomplete .",
    "similarly , an attacker might try to build emails that resemble the victim s style , for example by using a context free grammar ( cfg ) .",
    "i the model used by the attacker is not complete , however , he will still not be guaranteed to succeed .",
    "another problem that we have to consider is the privacy of users .",
    "the email sending behavior is built not only by leveraging a user s personal emails , but also by leveraging the ones sent by her coworkers .",
    "however , feature vectors built from the email are kept among the client and the server , and are never seen by the users . also , the server has to only keep the feature vector relative to an email , instead of the email itself .",
    "therefore , we argue that the privacy implications caused by identitymailer are still acceptable .",
    "another concern is that some domains , such as large webmail providers , have a very diverse set of users , and thus it might be challenging to accurately model their behavior .",
    "we argue that the focus of identitymailer is on corporate users , and we assume that their behavior is more consistent than the one of general - purpose email providers .",
    "in addition , large webmails have access to additional signals that are not included in our threat model ( such as login patterns and ip addresses ) , which can also be leveraged to build a behavioral profile .",
    "our approach protects the identity of users against attackers sending emails on their behalf . to this end , we borrow some ideas from anti - spam techniques , as well as from the field of forged text detection and authorship identification . in the following ,",
    "we discuss how our approach is related to previous work , and elaborate on the novelty of our method .",
    "* spam filtering : * existing work on spam filtering can be distinguished in two main categories : _ origin - analysis _ and _ content - analysis _ techniques .",
    "origin - analysis techniques try to determine whether emails are good or bad by looking at their origin .",
    "examples of characteristics that are indicative of a malicious emails can be the ip address or autonomous system that the email is sent from , or the geographical distance between the sender and the recipient  @xcite .",
    "other origin - based techniques include _ sender policy framework _ ( spf )  @xcite and _ domainkeys identified mail _ ( dkim )  @xcite .",
    "these techniques try to determine whether an email is actually coming from the address it claims to come from , by looking at the sender ip , or at a signature in the email headers .",
    "origin - based techniques are widely deployed , because they allow servers to discard spam emails as soon as the malicious end connects to the mail server , saving resources and time .",
    "in addition , they reach good coverage , because most spam is sent by hosts that are part of a botnet , and therefore have a low reputation  @xcite .",
    "however , in the scenario in which identitymailer works , origin - based techniques are useless , because the only thing they can do is confirming that an email has been sent by a certain account , regardless if it is a compromised one or not .",
    "content - analysis techniques look at the words in the message itself to determine if it is spam or not .",
    "proposed methods include nave bayes , support vector machines , or other machine learning algorithms  @xcite .",
    "other systems detect spam by looking at malicious urls in the email  @xcite .",
    "content - analysis techniques work well in detecting spam , however are too computationally intensive to be applied to every email that a busy mail server receives  @xcite . in identitymailer , we solve this problem by analyzing emails as they get sent .",
    "we claim that this analysis is feasible , because the amount of emails that a mail server sends is lower than the amount of emails that it receives .",
    "another problem of traditional content - analysis techniques is that they look for words that are indicative of spam . in the presence of a targeted attack",
    ", there might be no such words , since an attack email will use a language that is similar to the one used in everyday business emails .",
    "this is why in identitymailer we learn the typical sending behavior of a user and match it against the emails she sends .",
    "a number of systems have been proposed to counter specific types of spam , such as phishing .",
    "such systems either look at features in the attack emails that are indicative of phishing content  @xcite , or at characteristics of the web page that the links in the email point to  @xcite .",
    "identitymailer is more general , since it can detect any type of attack emails that is sent by compromised accounts .",
    "in addition , existing phishing techniques fail in detecting those emails that rely on advanced social engineering tactics , instead of redirecting the user to a phony login page .",
    "another category of spam detection techniques looks at the way in which spammers use the tcp or smtp protocol  @xcite .",
    "these techniques work well in practice against most spam , but are focused on detecting hosts that belong to a botnet , and are therefore useless in detecting the type of attacks that identitymailer is designed to prevent .",
    "* email forgery detection : * a large corpus of research has been performed on determining the authorship of written text .",
    "these techniques typically leverage stylometry and machine learning and return the most probable author among a set of candidates  @xcite . from our point of view , these approaches suffer from two major problems : the first one is that they typically need a set of possible authors , which in our case we do not have .",
    "the second problem is that email bodies are often times too short to reliably determine the author by just looking at stylometry  @xcite .",
    "lin et al . proposed a system that looks at the writing style of an email , and is able to tell whether that email was written by an author or not  @xcite .",
    "this approach may solve the first problem , but does not solve the second one , in which we have emails that are too short to make a meaningful decision . to mitigate this problem , in identitymailer",
    "we leverage many other features other than stylometry , such as the times at which a user sends emails , or her social network .",
    "khonji et al .",
    "presented ascai  @xcite , a system that detects if an email author has likely been forged .",
    "ascai looks at the most common n - grams in a user s emails , and flag as anomalous emails that contain words that the user rarely uses . unlike identitymailer ,",
    "ascai looks for any word , instead of focusing on writeprint features ( such as functional words ) . for this reason ,",
    "this system would fail in detecting spearphishing emails whose content is about the same topics that the user typically discusses , but that have been authored by a different person .",
    "identitymailer , on the other hand , has been designed to detect this type of stealthy spearphishing emails , and is therefore effective in blocking them .",
    "stolfo et al . presented the email mining toolkit ( emt )  @xcite .",
    "this tool mines email logs to find communities of users who frequently interact with each other .",
    "after learning the communities , the system flags as anomalous emails that are addressed to people outside them .",
    "although emt leverages an idea similar to identitymailer s interaction features , it is tailored at detecting large - scale threats , such as worms spreading through email . the fact that identitymailer leverages other types of features allow our system to detect more subtle , one - of - a - kind attack emails",
    "egele et al . proposed a system that learns the behavior of users on online social networks ( osn ) and flags anomalous messages as possible compromises  @xcite . because of the high number of false positives , their system can only detect large - scale campaigns , by aggregating similar anomalous messages . as we have shown , identitymailer is able to detect attacks that are composed of a single email , and which have not been seen before",
    "we presented identitymailer , a system that protects the mailbox of corporate users by checking whether an email has been written by the legitimate owner of an email account .",
    "this work is the first step towards the protection of individuals and companies against advanced email attacks , such as spearphishing .",
    "identitymailer is able to learn the typical sending behavior of the account s owner and can subsequently check all emails sent from the account against this profile in order to block advanced spearphishing attacks sent from a compromised email account . by performing experiments on real world",
    "datasets , we also showed that identitymailer can effectively block attacks that state - of - the - art protection systems are unable to detect , and that an attacker has no clear strategy to make his emails look legitimate in order to evade our detection system .",
    "this work was supported by the symantec research labs graduate fellowship for the year 2012 .",
    "the authors would like to thank the people at symantec , in particular marc dacier , david t. lin , dermot harnett , joe krug , david cawley , and nick johnston for their support and comments .",
    "we would also like to thank adam doup and ali zand for reviewing an early version of this paper .",
    "your comments were highly appreciated ."
  ],
  "abstract_text": [
    "<S> one of the ways in which attackers try to steal sensitive information from corporations is by sending _ spearphishing _ emails . </S>",
    "<S> this type of emails typically appear to be sent by one of the victim s coworkers , but have instead been crafted by an attacker . </S>",
    "<S> a particularly insidious type of spearphishing emails are the ones that do not only claim to come from a trusted party , but were actually sent from that party s legitimate email account that was compromised in the first place . in this paper </S>",
    "<S> , we propose a radical change of focus in the techniques used for detecting such malicious emails : instead of looking for particular features that are indicative of attack emails , we look for possible indicators of _ impersonation _ of the legitimate owners . </S>",
    "<S> we present identitymailer , a system that validates the authorship of emails by learning the typical email - sending behavior of users over time , and comparing any subsequent email sent from their accounts against this model . </S>",
    "<S> our experiments on real world e - mail datasets demonstrate that our system can effectively block advanced email attacks sent from _ genuine _ email accounts , which traditional protection systems are unable to detect . </S>",
    "<S> moreover , we show that it is resilient to an attacker willing to evade the system . to the best of our knowledge </S>",
    "<S> , identitymailer is the first system able to identify spearphishing emails that are sent _ from within an organization _ </S>",
    "<S> , by a skilled attacker having access to a compromised email account . </S>"
  ]
}