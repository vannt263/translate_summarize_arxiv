{
  "article_text": [
    "suppose we have a light source with a given directional characteristic and we would like to generate a prescribed illumination pattern on a target , e.g. , project a logo onto a wall .",
    "the classical approach using an aperture has the disadvantage that a part of the light hits the aperture and is lost for target illumination .",
    "this efficiency reduction also exists for slide projectors , where some light is absorbed by the film .    in order to use the entire luminous flux emitted by the light source to illuminate the target an optical system comprised of one or more free - form reflectors or free - form lenses",
    "can be used instead of an aperture .",
    "then the loss of light can be neglected and the desired illumination pattern is encoded in the shape of the optical surfaces , that in general is unknown . in the following we will mainly focus on this kind of problem with only one mirror , i.e. , we shall determine one desired reflecting free - form surface . this nonlinear inverse problem",
    "is called the _ inverse reflector problem _ , which is a well - known problem in nonimaging optics  @xcite .    already 2000 years ago reflectors projecting images , called chinese magic mirrors ,",
    "have been hand - crafted of bronze in china and japan , but the recipe has been lost and reconstructed several times over the ages ; see  @xcite and  @xcite .",
    "today such free - form optics are important in illumination applications .",
    "for example they are used in automotive industry for the construction of headlights that use the full light emitted by the lamp to illuminate the road but at the same time do not glare oncoming traffic ; see , e.g. , @xcite .",
    "some other applications include homogeneous illumination for machine - vision purposes or the realization of prescribed patterns in architecture illumination .    however , the solution of the inverse reflector problem is anything but trivial .",
    "there are many different schemes to determine a desired reflector like the method of supporting ellipsoids  @xcite and trial and error approaches  @xcite .",
    "the biggest problem of these methods is the computational effort needed to accurately compute reflectors for complex desired illumination patterns on the target . in the beginning of the 21st century",
    "it turned out that solving a corresponding partial differential equation ( pde ) is a high potential approach for this problem as already indicated in  @xcite in 2002 .",
    "this equation is of _ monge - ampre type _ , which is a family of strongly nonlinear second order pdes ; see  @xcite for details on the theory of monge - ampre equations .",
    "a first equation of this family was presented by gaspard monge at the beginning of the 19th century in his work `` mmoire sur la thorie des dblais et des remblais ''  @xcite and studied later again by andr - marie ampre in 1820  @xcite .",
    "equations of this type often arise in the context of _ optimal transport problems _ , where the task is to find the optimal way to transport excavated material ( french : _ dblai _ ) , e.g. , sand , to piles ( french : _ remblai _ ) without losing any of the total mass .",
    "these problems often have an economic background : if one minimizes the cost of transport , which is measured by a quadratic cost functional , under the constraint of _ total mass conservation _ , one obtains a monge - ampre equation .",
    "@xcite in this spirit , the inverse reflector problem deals with the transportation of light under the constraint that the total light flux emitted by the source is redistributed to the target surface .",
    "the rest of this paper is arranged as follows : in section  [ sec : state_of_the_art ] we review approaches to solve the inverse reflector problem .",
    "section  [ sec : math_formulation ] focuses on the modeling of the inverse reflector problem via an equation of monge - ampre type .",
    "our new approach for numerically solving equations of monge - ampre type is detailed in section  [ sec : collocation_method ] .",
    "in particular , we explain how to handle the boundary conditions arising in the inverse reflector problem .",
    "numerical results for benchmark problems for the monge - ampre equations and for the inverse reflector problem are presented in section  [ sec : results ] .",
    "the paper closes with the conclusion and an outlook in section  [ sec : conclusionoutlook ] .",
    "there are plenty of existing approaches for solving the inverse reflector problem ; for a detailed overview we refer the reader to  @xcite .",
    "most of those methods can be grouped into three classes , namely _ brute - force approaches _ , _ methods of supporting ellipsoids _ , and _",
    "monge - ampre approaches_. we give an overview of these methods in sections  [ subsec : brute_force ] ,  [ subsec : ellipsoid_method ] , and  [ subsec : ma_methods ] , respectively .",
    "other techniques which do not fit into these three classes are discussed in section  [ subsec : other_methods ] .      at the beginning of the 21st century",
    "many trial and error methods have been developed .",
    "the idea of these iterative schemes is as follows : for an initial reflector in optical setup the resulting illumination pattern on the target area is computed using a ray tracing software .",
    "then the illumination pattern is compared with the desired one , where a typical measure of the error is the deviation at previously selected test points in the euclidean norm .",
    "afterwards the reflector surface is slightly perturbed using ideas from optimization ( e.g. , simulated annealing ) and the setup with the new reflector is simulated again . if the error has decreased , the new reflector is used as initial guess for the next iteration and the procedure is repeated ; see , e.g. , @xcite .",
    "the advantage of these methods is , that there are only very few restrictions for the optical setting .",
    "for example even extended light sources and mirrors with different reflectivities can be considered . however , the main drawback is the computing time required , because repeated simulations of the setup using costly ray tracing techniques are needed .",
    "another approach is presented by weyrich , peers , matusik and rusinkiewicz  @xcite , where the mirror is assumed to be comprised of many small facets .",
    "each facet is directed to a prescribed position on the target area .",
    "this composite reflector in general has a discontinuous surface , which causes artifacts and is not favorable for production .",
    "therefore , in order to smoothen the solution in a post - processing step , the facets are sorted according to their slopes and adjusted with respect to their heights .",
    "nevertheless , the results have relatively low quality and still show many artifacts .",
    "an ellipse in the plane in general has two foci with the property that light emitted at one focus and reflected at the interior of the ellipse is focused at the second focus .",
    "ellipsoids of revolution in three dimensions have the same property . kochengin and oliker  @xcite ( see also  @xcite ) therefore proposed the following method : for each point on the target which needs to be illuminated one defines an ellipsoid of revolution whose one focus is located at the light source and the other one at the target point .",
    "however , for each target point there are infinitely many ellipsoids of revolution with this property only differing in their diameters . therefore in an iterative process the diameters of the ellipsoids are determined starting from some initial guess for each ellipsoid . in each iteration the reflector is defined as the convex hull of the intersection of the interiors of all ellipsoids .",
    "the result is a reflector whose surface consists of glued surface segments of ellipsoids of revolution . since the initial reflector in general does not produce the desired illumination on the target in every iteration the diameters of each ellipsoid besides the first one are shrunken until convergence .",
    "this method requires in each step a numerical integration over the emission solid angles of the source and a large number of optimization steps .",
    "therefore the complexity of this scheme quickly grows with the number @xmath0 of ellipsoids of revolution .",
    "suppose we would like to determine a reflector whose reflection on the target is exact for each target point up to an accuracy @xmath1 , then the number of iterations scales like @xmath2 ; see  @xcite .",
    "therefore it is difficult to use this method for practical illumination patterns of higher resolution .",
    "for the special case where the target is assumed to be infinitely far away from the light source caffarelli , kochengin , and oliker  @xcite developed a variant , which uses paraboloids of revolution instead of ellipsoids .",
    "the simultaneous multiple surfaces ( sms ) method developed by miano et al .",
    "@xcite constructs rotational symmetric optical systems which couple a prescribed set of incoming wave fronts with prescribed conjugate wave fronts .",
    "this method was also extended to design optics in non - rotational symmetric cases ; see , e.g. , @xcite .",
    "optical systems which are computed using the sms method can be found in  @xcite .",
    "this method always computes a pair of surfaces .",
    "hence it can not be applied to solve the inverse reflector problem with just one reflective surface .    wang  @xcite shows that the inverse reflector problem is in fact an optimal transportation problem . by taking into account also the dual reflector",
    "the problem can be reformulated as a linear optimization problem .",
    "unfortunately , since the number of linear inequality constraints quickly grows with the number of pixels , the complexity for the linear programming is very high and thus this method is not feasible for images of medium or higher resolution .",
    "another scheme has been developed by feler et al .",
    "@xcite , which computes single refractive or reflective surfaces to produce a prescribed density distribution on a prescribed target . to the best of the authors knowledge",
    "the method is not completely published .",
    "the inverse reflector problem statement for a point light source can be considered as an optimal transportation problem leading to strongly nonlinear second order pdes of monge - ampre type ; see , e.g. , @xcite .",
    "brickell , marder end westcott  @xcite already in 1977 started to develop methods to solve the inverse reflector problem based on monge - ampre type equations .",
    "later engl and neubauer  @xcite investigated a conjugate gradient method with certain constraints to solve this problem via a monge - ampre type equation .",
    "ries and muschaweck  @xcite also developed a method based on this type of equations .",
    "however , this numerical method has only been published very fragmentarily to the best of the authors knowledge .",
    "a compromise between a trial and error method and the solution of a pde is proposed by fournier , cassarly , and rolland ; see  @xcite . while the case of extended light sources is considered , which poses many additional problems , the discussion is restricted to the special case of rotationally symmetric reflectors . in an iteration at first the reflector for a point light source",
    "is computed by solving an ordinary differential equation .",
    "then the resulting surface is tested using a ray tracing software in a setup with an extended light source .",
    "if the result is not good enough , the differential equation for a point light source is solved again for an adjusted target illumination pattern , where the modification comes from the difference between the simulated and the desired target illumination .",
    "this procedure is repeated until a stopping criterion holds true .    in a recent preprint prins et al .",
    "@xcite derive an equation of monge - ampre type for the inverse reflector problem and provide a numerical method for its solution only for a light source that produces parallel light beams , i.e. , they aim for the special case of the far field where the light source is assumed to be infinitely far away from the reflector .",
    "in this particular case the monge - ampre type equation reduces to a simpler monge - ampre equation , which is called a monge - ampre equation of standard type and is easier to solve ; see section  [ sec : collocation_method ] for a detailed discussion .",
    "in section  [ sec : state_of_the_art ] we saw that there are many different approaches to solve the inverse reflector problem . as proposed in the approaches discussed in section  [ subsec : ma_methods ] we follow the strategy of first modeling the inverse reflector problem using a pde of monge - ampre type and solving this equation in a second step .",
    "we now therefore turn to a formulation of the problem in mathematical terms .",
    "there exist different approaches to deduce an equation of monge - ampre type for this kind of problem  @xcite .",
    "we choose the formulation from karakhanyan and wang  ( * ? ? ?",
    "* proposition 2.2 ) , which is based on an energy conservation equation .",
    "the advantage of this approach is that for the special case in which the light source is located in - plane with the target , we obtain a relatively simple monge - ampre equation of standard type . in the following we use the notation and results given by karakhanyan and wang  @xcite .    in subsection  [ subsec : problem_statement ]",
    "we first define the problem statement .",
    "then a corresponding equation of monge - ampre type is set up in subsection  [ subsec : ma_equation ] and a result and some remarks on the existence and uniqueness of the solution of this problem are discussed in subsection  [ subsec : reflector_existence_uniqueness ] .",
    "let us now fix the mathematical description of the problem .",
    "ir[problem : ir ] ( see , e.g. , the introduction in  @xcite ) + let a point light source be given , which emits light in all directions given by the set @xmath3 . the luminous intensity of the source is modeled by the density function @xmath4 .",
    "furthermore we have a target area @xmath5 given in implicit form as @xmath6 for an appropriate function @xmath7 .",
    "let @xmath8 be a prescribed density function on the target area @xmath5 .",
    "find a reflector @xmath9 which redistributes the entire light emitted from the light source , such that the given target illumination defined by @xmath10 is generated ; see figure  [ fig : reflector_parametrization ] .    , and target @xmath5 .",
    "]      we now aim for deriving the monge - ampre type equation corresponding to problem  [ problem : ir ] .",
    "therefore we first parameterize the desired reflector by @xmath11 , where @xmath12 is an appropriate distance function .",
    "as already indicated in figure  [ fig : reflector_parametrization ] we assume that @xmath13 is located in the northern hemisphere of @xmath14 , such that each @xmath15 can be expressed by @xmath16 where @xmath17 and @xmath18 . therefore we can use the domain @xmath19 in @xmath20 to parameterize the set @xmath21 .    under these assumptions karakhanyan and wang  ( * ? ? ?",
    "* proposition 2.2 ) give a pde for problem  [ problem : ir ] for the desired function @xmath22 .",
    "however , substituting @xmath22 by @xmath23 results in an equation with slightly simpler expressions ( see  ( * ? ? ?",
    "* remark 2.1 ) ) , which leads to the following result .",
    "[ theorem : ma_reflector ] ( see  ( * ? ? ?",
    "* remark 2.1 and proposition 2.2 ) ) + let the density functions @xmath24 and @xmath10 be given , satisfying the _ energy conservation _",
    "@xmath25 moreover , let the shape of @xmath5 be defined by the function @xmath7 as in problem  [ problem : ir ] . define @xmath26 and @xmath27 where @xmath28 and @xmath29 .",
    "we assume that @xmath30 , i.e. , @xmath31 , and @xmath32 .",
    "then the inverse reflector problem states :    find a function @xmath33 , such that @xmath34    let us note some comments on the above theorem .    1 .",
    "the assumption @xmath31 means , that the third component of the vector that corresponds to the position where a light ray hits the reflector is larger than the third component of the point where this light ray hits the target @xmath5 after reflection . in other words , the light ray must be directed downwards after the reflection .",
    "the second condition @xmath32 is needed for a technical reason and just fixes the direction of the normal on @xmath5 .",
    "if this constraint is not fulfilled one can simply replace @xmath35 by @xmath36 for all @xmath37 .",
    "if one sets @xmath38 , the equation simplifies to @xmath39 which is a _ monge - ampre equation of standard type _",
    ", i.e. , the left hand side is only the determinant of the hessian of @xmath40 ; see  ( * ? ? ?",
    "* remark 2.1 ) .",
    "the existence of solutions of problem  [ problem : ir ] is ensured by the following result .",
    "( see  ( * ? ? ? *",
    "theorem a ) ) + suppose we have two functions @xmath24 and @xmath10 which fulfill the energy conservation condition as in theorem  [ theorem : ma_reflector ] .",
    "let moreover @xmath41 be an element of the light cone @xmath42 of the light source , i.e. , @xmath43 and one of the conditions    1 .",
    "@xmath44 or 2 .",
    "@xmath45 for a region @xmath46 with @xmath47    is satisfied",
    ". then there exists a reflecting surface , which is the solution of the inverse reflector problem  [ problem : ir ] and contains the point @xmath41 .",
    "we first notice that the solution is not unique .",
    "if we have a solution for one @xmath48 , we know that there exist other solutions for @xmath49 for each @xmath50",
    ".    even if we fix @xmath48 , there are at least two solutions that contain @xmath41 .",
    "a solution is called @xmath51-convex if it fulfills an _ ellipticity constraint _ ,",
    "i.e. , the matrix @xmath52 in is required to be positive definite . moreover ,",
    "a solution is defined to be @xmath51-concave , if this matrix is negative definite . in  (",
    "* section 7 ) one can find a sketch of a proof that for a fixed @xmath48 there are exactly one @xmath51-convex and one @xmath51-concave solution .",
    "therefore we need at least to fix the size of the reflector by a point @xmath41 and search for either a @xmath51-convex or a @xmath51-concave solutions to obtain uniqueness .",
    "this is a necessary condition to ensure well - posedness of the problem .",
    "we now discuss methods to numerically solve equations of monge - ampre type , which is particularly difficult due to the strong nonlinearity of this type of equations .",
    "after an overview of numerical solvers for monge - ampre type equations in subsection  [ subsec : pde_solver_state_of_the_art ] we discuss our approach in subsection  [ subsec : spline_collocation ] . in order to improve the convergence properties and to speed up the solution process",
    ", a multilevel technique will be introduced in subsection  [ subsec : splines_nested ] . since the existence and uniqueness of a solution is guaranteed , if the monge - ampre type equation fulfills an ellipticity condition ( see , e.g. , ( * ? ? ? * theorem 1.1 and remarks ( i ) ) ) , we ensure that this condition holds true by adding a convexity constraint to the equation as detailed in subsection  [ subsec : convexity_constraint ] .",
    "since the boundary condition can not be considered directly , the section closes with the presentation of a technique to realize this type of boundary conditions in subsection  [ subsec : reflector_boundary ] .",
    "there are several other numerical methods for the solution of monge - ampre type equations known , but most of them have clear limitations . usually the algorithms are only designed to handle boundary value problems for the _ monge - ampre equation of standard type _",
    "@xmath53 for any @xmath54 with dirichlet boundary conditions @xmath55 for @xmath56 . in particular , in this case the left - hand side determinant may only depend on the hessian of the solution , but no perturbations in the determinant like @xmath57 for a matrix @xmath58 are permitted . numerical methods for this monge - ampre equation of standard type can for example be found in  @xcite .    in order to solve the inverse reflector problem we search for a solution of the monge - ampre equation given in theorem  [ theorem : ma_reflector ] .",
    "since equation is strongly nonlinear with rather cumbersome terms it is very difficult to analyze this equation particularly with regard to weak formulations .",
    "to the best knowledge of the authors , there is no closed theory on weak formulations in the classical sense for equations of monge - ampre type available .",
    "hence , feng and neilan  @xcite introduce a new type of weak solution called the moment solution and investigate the following ansatz .",
    "they embed strongly nonlinear pdes into linear pdes of higher order and study the limit of the vanishing highest order term .",
    "for example , the monge - ampre equation is embedded into an quasilinear elliptic pde of fourth - order with highest order term @xmath59 with @xmath60 , where the limit @xmath61 is studied .",
    "such a scheme is called vanishing moment method ; for details we refer to  @xcite .",
    "another interesting approach has recently been published by brenner et al .",
    "@xcite and by brenner and neilan  @xcite .",
    "they propose a finite element method that leads to a sophisticated consistent discretization and show that the corresponding discrete linearized problem is stable .",
    "the main idea is to employ standard continuous lagrange finite elements instead of finite elements with higher smoothness and to use penalty terms , like those applied in discontinuous galerkin methods , to demand for regularity of the solution across interfaces .    in view of practical applications like the inverse reflector problem ,",
    "it is necessary that a numerical solver efficiently treats monge - ampre equations of standard type as well as perturbed equations with neumann boundary conditions .",
    "at least one of the two methods given by benamou , froese , and oberman  @xcite supports neumann boundary conditions but is only suited to solve monge - ampre equations of standard type . in a subsequent work froese",
    "@xcite presents a method for monge - ampre type equations arising in optimal transportation problems .",
    "she uses a neumann boundary condition and the right - hand side of the monge - ampre equation of standard type is allowed to also depend on the gradient of @xmath40 .",
    "the method by brenner et al .",
    "@xcite also permits this dependency on the right - hand side .",
    "a detailed overview of numerical methods for fully nonlinear second order pdes including methods for monge - ampre type equations can be found in the review article  @xcite by feng , glowinski , and neilan .",
    "we now explore a different simple but very flexible approach for the solution of the monge - ampre type equations : the _ collocation method _ can directly be applied to the strong formulation such as .",
    "the solution is approximated in a finite - dimensional trial space , in our case we choose the space of spline functions because of its good approximation properties .",
    "the spline space is spanned by b - spline functions which form an advantageous basis due to its flexible manageability .",
    "moreover this basis is well - known to be numerically very stable and the functions are of minimal support , which favors sparsity in the collocation matrices .    the rest of this subsection is arranged as follows : first we formulate the collocation method in subsection  [ subsec : collocation ] . the trial space and a modified b - spline basis that is suited for our particular choice of the collocation points are set up in one spatial dimension in subsections  [ subsec : b - splines ] and  [ subsec : modified_b - splines ] .",
    "finally , the trial space is extended to the two - dimensional case in subsection  [ subsec : tensor_product ] via a tensor construction .",
    "let us now formulate the collocation method for a general second order pde and therefore introduce some notation . let @xmath62 be a rectangular domain and let the boundary value problem be given as @xmath63 we approximate the exact solution in a finite - dimensional trial subspace , say of dimension @xmath64 , spanned by some basis functions @xmath65 .",
    "then the approximate solution is written as @xmath66 , where @xmath67 and @xmath68 are the desired coefficients .",
    "of course we can not expect such a discrete solution to fulfill the pde exactly in the whole domain @xmath69 .",
    "the idea of the collocation method is that the pde should be fulfilled pointwise at certain _",
    "collocation points_. therefore we choose @xmath70 appropriate pairwise different collocation points , i.e. , we select two finite and nonempty subsets @xmath71 and @xmath72 with cardinality @xmath73 . our problem , is then required to be fulfilled exactly at these points , i.e. , we end up with a discrete problem which is the nonlinear system of equations @xmath74    now we can use some _ newton - type method _ to solve . for reasons of better stability we favor the application of the _ double - dogleg method _ ( see , e.g. , @xcite ) , which is a trust region algorithm of _ quasi - newton type_. we use the variant proposed by dennis and mei  @xcite , where we invoke an algorithm by nielsen  @xcite for the choice of the trust region radius after each iteration step .",
    "adequate stopping criteria for the iteration process can be found in  @xcite .",
    "next we will discuss the choice of appropriate basis function and collocation points .",
    "let us briefly recall the definition of _ b - splines _ on the real line , which are the fundament of our basis functions , using the notation of  @xcite .",
    "let @xmath75\\subset{\\ensuremath{\\mathbb{r}}}$ ] be a given interval that serves as the domain of the basis functions . for b - splines of order @xmath64 we define for a fixed @xmath76 a strictly increasing _ knot sequence _ @xmath77 with @xmath78 for @xmath79 the @xmath80-th b - spline @xmath81 of order @xmath70 is then defined by the _ cox - de boor recursion formula _",
    "@xmath82    the condition of a strictly increasing knot sequence can be relaxed using de lhpital s rule and _ multiple knots _ can be permitted ; see , e.g. , ( * ? ? ?",
    "* chapter ix ) or  ( * ? ? ?",
    "* section 2.2 ) .    in the following",
    "we fix the outer knots in at the boundary , i.e. , we set @xmath83 and @xmath84 .",
    "multiple knots for the interior knots @xmath85 result in less smooth b - splines .",
    "since we want to solve a pde of second order , we need basis functions which are at least twice differentiable . to have minimal computational efforts while fulfilling this constraint we choose the lowest possible order , which is @xmath86 , i.e. , _ cubic splines _ , and avoid multiple knots inside @xmath87 .",
    "[ rem : bsplinesvanishingderivatives ] since the left outer knots all coincide with the left boundary @xmath88 , @xmath89 is the only b - spline with a non - zero function value at the left boundary point @xmath88 .",
    "moreover , the first derivative of @xmath90 vanishes at @xmath88 for all @xmath91 and the second derivative of @xmath90 vanishes at @xmath88 for all @xmath92 . by symmetry ,",
    "the same holds for the b - splines at the right boundary point @xmath93 .      in order to uniquely define a spline from our spline space it suffices to set @xmath94 linear independent conditions , e.g. , to prescribe the function values at @xmath94 appropriate different nodes",
    "the knots themselves are possibly a good choice for these nodes .",
    "however , we only have @xmath95 knots in @xmath75 $ ] , that is there are two open degrees of freedom left .",
    "there are different ways to handle open degrees of freedom , e.g. , by setting a not - a - knot condition  ( * ? ? ?",
    "* chapter iv ) .",
    "another possibility is to modify the trial space by lowering the dimension of the spline space , which we will discuss next .",
    "for our purpose it is crucial to keep the approximation properties of the trial space .",
    "therefore it is necessary that each ( taylor-)polynomial of degree @xmath96 can still be reproduced and consequently at least @xmath70 basis functions must be supported in each subinterval .",
    "with regard to the boundary conditions and the clearness of the construction of the modified basis , we build new basis functions at the boundary of the interval @xmath75 $ ] . without loss of generality",
    "we can restrict ourselves to the left boundary case , the right boundary case is handled analogously by symmetry .    in order to modify as few basis functions as possible we choose four new basis functions from the span of the first five b - splines , i.e. , we write @xmath97 for some coefficients @xmath98 , which still have to be determined .",
    "note that this approach of gluing b - splines at the boundary is similar to the procedure used in the construction of web - splines  @xcite where some b - splines are glued to improve the numerical stability of the basis , i.e. , to lower its condition number .    from _",
    "marsden s identity _ we can derive @xmath99 for @xmath100 ; see , e.g. , ( * ? ? ? * ( 2.3.3 ) ) .",
    "furthermore the coefficient matrix @xmath101_{i=1 , \\dots , 4,\\ , j=1 , \\dots , 5}$ ] has to be chosen in such a way , that for each @xmath102 there exist coefficients @xmath103 so that @xmath104 holds . setting @xmath105_{1\\leq i\\leq 4,\\ , 0\\leq m\\leq 3}$ ] and equating the coefficients of @xmath106 for @xmath107 in and yields the system of linear equations @xmath108 where @xmath109_{1\\leq j\\leq 5,\\ , 0\\leq m\\leq 3}$ ] with @xmath110 .",
    "now we have to choose the matrix @xmath58 , such that has a solution matrix @xmath111 .",
    "the trivial solution is @xmath112 and @xmath113 , where @xmath114 is the identity matrix . in other words",
    "the new basis elements then are exactly the monomials @xmath115 , @xmath116 , @xmath117 , and @xmath118 at the first subinterval .",
    "the disadvantage of this solution is , that the new basis functions are not shift invariant , i.e. , they depend on the location of the knots in the knot sequence @xmath119 .",
    "therefore we will search for a more favorable solution of shift invariant functions .",
    "for this purpose let us choose the ansatz @xmath120 for an invertible matrix @xmath121 and set @xmath122 and @xmath123 .",
    "thus the idea is to define the matrix @xmath124 using appropriate column operations acting on @xmath125 , such that @xmath124 has a preferably simple form .",
    "of course the choice of @xmath126 is not unique , such that we can prescribe additional conditions , e.g. , in the spirit of the properties of the b - spline functions observed in remark  [ rem : bsplinesvanishingderivatives ] . for dirichlet boundary conditions it is advantageous , if only one basis function is nonzero at the boundary .",
    "the same holds true for neumann boundary conditions when the first derivative of the basis functions is considered .",
    "moreover , for natural spline interpolation ( see , e.g. , ( * ? ? ?",
    "* chapter iv ) ) it is convenient if only one basis function has a non - vanishing second derivative at the boundary .",
    "the following choice provides us with a basis which has all these handy properties .",
    "suppose that we have an equidistant knot sequence with multiple knots at the boundary , i.e. , @xmath127 \\subset { \\ensuremath{\\mathbb{r}}}$ ] with @xmath128 after some elementary computations for this particular case , we can determine an invertible matrix @xmath126 such that @xmath129      1           & \\frac{1}{4 }    & 0            & 0            \\\\[0.3em ]      1           & \\frac{3}{4 }    & \\frac{1}{2 } & 0            \\\\[0.3em ]      \\frac{3}{4 } & \\frac{15}{16 } & \\frac{3}{4 } & \\frac{1}{4 } \\\\[0.3em ]      0           & 0              & 0            & 1    \\end{matrix}\\right]^t.\\end{aligned}\\ ] ] note that the matrix @xmath58 is independent of the knots , such that our new basis functions inherit the shift invariance from the b - splines . a plot of the resulting four new basis functions is given in figure  [ fig : modified_bsplines ] .     in . ]",
    "due to the conditions imposed and the properties pointed out in remark  [ rem : bsplinesvanishingderivatives ] , the matrix @xmath124 in has a lower triangular structure .",
    "since we aim for solving equations of monge - ampre type on a two - dimensional rectangle @xmath130\\times [ c , d]\\subset{\\ensuremath{\\mathbb{r}}}^2 $ ] , we next define the spline space on @xmath51 using the usual tensor product construction .",
    "let @xmath131 be the knot sequence as in for the interval @xmath75 $ ] and @xmath132 the analog knot sequence for @xmath133 $ ] .",
    "as in section  [ subsec : b - splines ] for both @xmath131 and @xmath132 we define b - splines of order @xmath134 and @xmath135 , respectively .",
    "we then define _ tensor - product b - splines _ by @xmath136 for @xmath137 , @xmath138 and @xmath139\\times [ c , d]$ ] .",
    "using the same arguments as in subsection  [ subsec : b - splines ] we set @xmath140 and restrict ourselves to knot sequences that are equidistant in the inner of the intervals .",
    "as ansatz functions in our collocation method in subsection  [ subsec : collocation ] we use the modified tensor - product basis functions @xmath141 for @xmath142 and @xmath143 and , as in  ( * ? ?",
    "* chapter xiii ) , the collocation points @xmath144 which are the knots of the b - splines .",
    "splines are particularly suitable for multilevel strategies , because of the following property : suppose we have a knot sequence @xmath145 for the interval @xmath75\\subset{\\ensuremath{\\mathbb{r}}}$ ] as in and a second knot sequence @xmath146 for @xmath75 \\subset { \\ensuremath{\\mathbb{r}}}$ ] that is obtained from @xmath147 by inserting new knots",
    ". then the corresponding spline spaces @xmath148 and @xmath149 of order @xmath64 are nested , i.e. , @xmath148 is a subspace of @xmath149 .",
    "since we use a newton - type method for solving the discrete nonlinear problem , we need an initial guess that is preferably close to the solution .",
    "otherwise solving the problem could be very time consuming or even infeasible , because the newton - type method might not converge .",
    "we therefore follow an approach based on _ nested iteration _ : our computation starts on a very coarse grid . after calculating the solution for this coarse problem",
    ", we refine the mesh by knot insertion , e.g. , we halve the mesh size in each coordinate direction . since the spline spaces of the coarse and refined knot sequences are nested , the coarse solution is also contained in the spline space corresponding to the finer mesh and can be used as an initial guess .",
    "we continue with this process until we reach the desired grid resolution .",
    "to be more precise , assume we have @xmath150 , i.e. , the number of knots is the same in each coordinate direction .",
    "let us now solve the discrete nonlinear problem on a grid with @xmath151 knots in each direction .",
    "we start with the coarsest reasonable grid possible in our situation such that the boundary basis functions do not overlap , which is of size @xmath152 , and after each iteration we halve the mesh size",
    ". then after nested iteration @xmath153 there are @xmath154 knots in the grid in each coordinate direction . if @xmath155 we interpolate the solution obtained from the @xmath156-th iteration to the fine grid with @xmath157 knots using spline interpolation and solve the final nonlinear problem .      in order to show the existence and the uniqueness of solutions of monge - ampre type equations",
    ", it is often required that the equation is elliptic with respect to the solution ; see , e.g. , ( * ? ? ?",
    "* theorem 1.1 and remarks ( i ) ) or  @xcite .",
    "a nonlinear pde @xmath158=f(\\cdot , u,{\\ensuremath{\\textnormal{d}}}u,{\\ensuremath{\\textnormal{d}}}^2u)=0 $ ] is said to be _",
    ", if the matrix @xmath159_{i , j}:=\\left[\\begin{array}{ccc }    \\frac{\\partial f}{\\partial r_{11}}(\\gamma ) & ... & \\frac{\\partial f}{\\partial r_{1n}}(\\gamma)\\\\    \\vdots&&\\vdots\\\\    \\frac{\\partial f}{\\partial r_{n1}}(\\gamma ) & ... & \\frac{\\partial f}{\\partial r_{nn}}(\\gamma ) \\end{array}\\right]\\end{aligned}\\ ] ] is positive definite for all @xmath160 , where @xmath161 denotes the space of symmetric @xmath162 matrices ; see , e.g. , ( * ? ? ?",
    "* chapter 17 ) .    in case of a general monge - ampre equation",
    "@xmath163 with appropriate boundary conditions we have the following result .",
    "let @xmath164 be a domain , @xmath165 , and let @xmath58 be a symmetric @xmath162 matrix .",
    "it is necessary and sufficient to ensure ellipticity for that @xmath166 consequently the right - hand side @xmath24 has to be positive to allow elliptic solutions .    for @xmath167",
    "this result has been proven , e.g. , in  ( * ? ? ?",
    "* lemma 1 ) . otherwise , the result is also well - known ( see , e.g. , @xcite ) , but the authors could not find a proof in the literature .",
    "we therefore extend the proof given by froese and oberman  ( * ? ? ?",
    "* lemma 1 ) to this more general result .",
    "let @xmath168 be the cofactor matrix of the symmetric matrix @xmath169 ; see , e.g. , ( * ? ? ?",
    "* section 4.3 ) for a definition . as a consequence of cramer",
    "s rule we have @xmath170 .",
    "it follows that @xmath168 is positive definite if and only if @xmath171 is positive definite .",
    "therefore we only have to prove that @xmath172_{i , j }        = \\tilde{\\mathcal{w } }    \\end{aligned}\\ ] ] is true , which is an alternative expression of for the monge - ampre equation .    expanding the determinant along the @xmath80-th row using laplace s formula yields @xmath173 by definition",
    "the cofactor @xmath174 is independent of @xmath175 and therefore of @xmath176 as well .",
    "in addition , the matrix @xmath58 is independent of @xmath177 , such that we have @xmath178 we therefore proved that for the monge - ampre equation is positive definite if and only if @xmath179 is positive definite .    in case that @xmath167 , the hessian matrix @xmath180 must be positive definite to ensure ellipticity for , which means that @xmath40 has to be strictly convex . therefore condition can be viewed as some kind of convexity condition .",
    "as proposed in  @xcite we take into account as an additional constraint . note that the positive definiteness of a symmetric matrix from @xmath181 is equivalent to a positive determinant and positive diagonal entries .",
    "the positivity of the determinant is guaranteed if @xmath182 . to forbid solutions with non - positive diagonal entries in the matrix",
    "we define the modified determinant @xmath183 which is non - positive if at least one diagonal entry is non - positive and otherwise equals @xmath184 .",
    "this idea is similar to the modified determinant in  @xcite and also in  ( * ? ? ?",
    "* section 4.3 ) .    to avoid problems , such as non - uniqueness of a solution in case of a singularity , where @xmath179 has an eigenvalue equal to zero ,",
    "we introduce a parameter @xmath185 and subtract a penalty term @xmath186\\end{aligned}\\ ] ] to ensure that the modified determinant has a negative value instead of just a non - positive value .",
    "this was done similarly by froese  ( * ? ? ?",
    "* section 4.3 ) .",
    "now we replace the determinant in , consider the equation @xmath187 instead , and obtain the following result .",
    "let @xmath188 be a domain , @xmath165 , and @xmath182 .",
    "if @xmath40 is a classical solution of the modified monge - ampre equation , then @xmath40 also solves the original equation and simultaneously fulfills the ellipticity constraint and vice versa .",
    "let @xmath165 be a classical solution of and @xmath189 .",
    "since @xmath190 , the diagonal entries of @xmath171 are positive because otherwise we would have @xmath191 .",
    "therefore @xmath192 holds true .",
    "it immediately follows , that @xmath40 also solves and simultaneously .",
    "conversely , if @xmath40 solves and , the diagonal entries of @xmath171 are positive and we have @xmath193 .",
    "let us now come back to the solution of the inverse reflector problem .",
    "the equation of monge - ampre type in theorem  [ theorem : ma_reflector ] already is of the desired form to be treated by the collocation method . but this is not true for the boundary condition , because it is a constraint for the desired mapping @xmath119 on the whole domain @xmath13 and not only for @xmath119 restricted to the boundary of @xmath13 , i.e. , for @xmath194 .",
    "thus condition is not of the general form , which makes it difficult to handle . to overcome this problem",
    "we first assume that the boundary of @xmath13 is supposed to be mapped by @xmath119 onto the boundary of @xmath5 and the interior of @xmath13 to the interior of @xmath5 . to the best of the authors knowledge",
    "this assumption has not yet been proven to hold for the inverse reflector problem .",
    "but it is worthwhile noting that when the mirror surface is interpreted as an extended light source this assumption corresponds to the _ edge ray principle _ from nonimaging optics  ( * ? ? ?",
    "* chapter 3 ) . in brief , it states that when the rays emitted at the boundary of the light source , the edge rays , are mapped to the boundary of the target it is ensured that all other rays emitted by the light source are also mapped to the target , i.e. energy conservation holds .",
    "however , froese  @xcite discusses a simpler but related problem where a similar assumption to holds true and she proposes to replace this assumption by a simpler boundary condition .",
    "therefore we follow her strategy proposed in  ( * ? ? ?",
    "* section 3.3 ) to render our boundary condition manageable .",
    "the idea is to first replace the constraint , i.e. , @xmath195 , by @xmath196 .",
    "since we work on @xmath69 , which is isomorphic to @xmath13 , we write @xmath197 . we then only need to prescribe the normal component of the mapping @xmath198 , such that we obtain the boundary condition @xmath199 where @xmath200 is the outer normal vector of @xmath201 and the normal component @xmath202 of @xmath119 is an a priori unknown function .",
    "unfortunately , we now have a circular dependency problem .",
    "if we knew @xmath202 , we would have the boundary condition in the desired form .",
    "of course if the solution @xmath203 of the problem and therefore the correct mapping @xmath204 is known , then @xmath205 .",
    "but the function @xmath202 is unknown unless the solution of problem  [ problem : ir ] is solved , where the boundary condition is needed to identify the solution .    in order to disrupt this circular dependency problem , a _ picard - type iteration _",
    "is proposed in  @xcite for a similar but different problem : we iterate and start with an initial guess @xmath206 . for @xmath207",
    "we determine @xmath208 by first solving the monge - ampre equation with boundary condition using @xmath209 instead of @xmath202 .",
    "the solution @xmath210 defines a reflector mapping @xmath211 , which not necessarily maps @xmath201 onto @xmath212 but onto @xmath213 for the image @xmath214 of the mapping @xmath215 , which in general differs from @xmath5 . in order to correct this",
    "we apply the orthogonal projection of @xmath213 onto @xmath212 using the standard scalar product and define @xmath216\\nu({\\ensuremath{\\mathbf{x } } } )      \\qquad\\text{for } { \\ensuremath{\\mathbf{x}}}\\in\\partial\\omega.\\end{aligned}\\ ] ] the boundary condition then reads @xmath217^t\\nu(\\cdot ) = 0      \\qquad\\text{for } { \\ensuremath{\\mathbf{x}}}\\in\\partial\\omega,\\end{aligned}\\ ] ] where @xmath210 is known and @xmath218 is the desired interim solution in step @xmath156 .    [ [ existence ] ] existence + + + + + + + + +    for the solution of the inverse reflector problem we need to ensure the conservation of energy . in order to obtain the correct @xmath202 ,",
    "we solve the reflector problem for @xmath208 and therefore for a different target @xmath219 for @xmath207 in the picard - type iteration .",
    "the energy conservation then holds for @xmath219 .",
    "note that the prescribed density function @xmath10 on the target @xmath5 of problem  [ problem : ir ] can be continued with zero outside of @xmath5 .",
    "however , we need to compensate for the difference in energy and ensure the energy conservation condition to hold on @xmath5 by scaling the density function @xmath24 with an appropriate constant @xmath220 defined by @xmath221 see  ( * ? ? ? * section 3.4 ) .",
    "since we do not know @xmath219 , also @xmath222 is unknown .",
    "thus , we introduce @xmath222 as a new degree of freedom in our subproblems for the different right - hand sides @xmath208 of the boundary condition for @xmath207 and replace @xmath24 in the monge - ampre equation by @xmath223 which guarantees the existence of a solution .",
    "[ [ uniqueness ] ] uniqueness + + + + + + + + + +    however , we can not expect that there is only one @xmath51-convex solution , i.e. , a solution of the monge - ampre equation in the elliptic case , for each inverse reflector problem .",
    "in fact there are infinitely many solutions ; see subsection  [ subsec : reflector_existence_uniqueness ] .",
    "one possible choice of a condition to ensure uniqueness is to fix the size of the reflector .",
    "the reflector is parameterized by the distance function @xmath40 , which controls the size of its shape . hence ,",
    "similar to  ( * ? ? ?",
    "* section 3.4 ) , we fix a parameter @xmath224 and add the constraint @xmath225    [ [ resulting - problem ] ] resulting problem + + + + + + + + + + + + + + + + +    collecting all the conditions , we obtain the subproblems @xmath226 for @xmath227 , where @xmath218 and @xmath222 are the unknowns , @xmath224 and @xmath185 are fixed parameters , @xmath93 equals the right - hand side of the monge - ampre equation , and @xmath209 is the orthogonal projection as defined in .",
    "there is not plenty of existence and uniqueness theory available for equations of monge - ampre type , in particular not for the general case where the determinant does not only depend on the hessian of @xmath40 .",
    "the most adequate theorems for our situation found by the authors are formulated in  ( * ? ? ?",
    "* theorem 1.1 ) and  ( * ? ? ? * theorem 1.1 ) with neumann boundary conditions .",
    "but unfortunately this can not be applied because of the missing regularity of the boundary @xmath201 and the fact that our boundary conditions are nonlinear .",
    "however , it is worth noting that both theorems state that under some conditions there exists a unique solution of the elliptic monge - ampre type equation , so the ellipticity constraint is important .",
    "in this section we present some test cases which we use to verify our numerical solver for the inverse reflector problem . first we consider in subsection  [ subsec : test_cases_standard_ma ] five benchmark test cases for the monge - ampre equation of standard type .",
    "since these have also been discussed by froese and oberman  @xcite , we can compare the convergence behavior of their and our methods .",
    "afterwards we discuss results for problem  [ problem : ir ] in subsection  [ subsec : test_cases_inverse_reflector ] .",
    "[ [ general - implementation - remarks ] ] general implementation remarks + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    all the computations have been carried out on a standard personal computer equipped with an amd phenom ii x4 955 processor running at @xmath228 . in order to verify the numerical solutions of the inverse reflector problem we perform a forward simulation of the reflector using the ray tracing software pov - ray  @xcite .",
    "note that in each step of the nonlinear solver , i.e. , in each newton iteration , in our collocation method we solve a sparse system of linear equations . for this purpose",
    "we use the unsymmetric multifrontal sparse lu factorization package ( umfpack )  @xcite .",
    "we first define in subsection  [ subsubsec : test_cases_five ] five test cases . the results are given in subsection  [ subsubsec : experiments_standard ] .",
    "let us define @xmath229 , @xmath230 , and @xmath231 .",
    "we consider five examples for the monge - ampre equation of standard type with dirichlet boundary conditions , i.e. , @xmath232 in the following examples the exact convex solution is known and the boundary function @xmath10 is given as the restriction of the exact solution to the boundary @xmath201 .    in the _ first example _",
    "@xcite the solution is in @xmath233 and radially symmetric .",
    "the exact solution and the right - hand side of the monge - ampre equation are given by @xmath234    the _ second example _ , also taken from  @xcite , has a solution @xmath40 in @xmath235 and is defined by @xmath236    a solution which is in @xmath233 but whose gradient has a singularity near @xmath237 has also been discussed in  @xcite . this _",
    "third example _ is given by the exact solution @xmath238 the solution @xmath40 is also in @xmath239 for any @xmath240 ; see also  @xcite .    in the _ fourth example _ , also taken from  @xcite , the solution is only lipschitz continuous , i.e. , the solution @xmath40 is in @xmath241 , and is defined by @xmath242 where @xmath24 is defined by the dirac delta distribution .",
    "note that @xmath40 is an aleksandrov solution ; see  @xcite for the details . in  @xcite the distribution",
    "is approximated by a piecewise constant function . on a ball of radius @xmath243 , where @xmath244 is the spatial resolution of the grid , the approximation @xmath245 takes a value such that integral over the ball is conserved .",
    "this leads to @xmath246    for the _ fifth and last example _ the exact solution is unknown such that we can not compare the results with the exact solution .",
    "nevertheless , dean and glowinski  @xcite and also feng and neilan  @xcite discussed this test case with right - hand side @xmath247 and dirichlet homogeneous boundary condition .",
    "feng and neilan  @xcite remark that there exist a unique convex viscosity solution but no classical one .",
    "[ remark : typo ] froese and oberman  @xcite claim the solution of to be @xmath248 which is neither a convex function nor a solution to this right - hand side , but it seems that they used the correct version of in their numerical experiments .",
    "this is probably a mistake in writing .",
    "[ remark : existence_uniqueness ] the existence of a solution is guaranteed for the first four test cases due to their definitions . for the uniqueness",
    "we refer to the general result  ( * ? ? ?",
    "* corollary 17.2 ) for classical solutions , which states for our case in as follows :    let @xmath188 be a domain .",
    "suppose @xmath249 are strictly convex and we have @xmath250 in @xmath69 and @xmath251 on @xmath201 .",
    "we then have @xmath252 in @xmath69 as well .",
    "we now apply our solver to the five test cases introduced in subsection  [ subsubsec : test_cases_five ] , that all impose dirichlet boundary conditions . we still have to fix @xmath185 for the penalty term of our modified determinant @xmath253 in , which we use to ensure the ellipticity of the monge - ampre equation . since this additional term vanishes for the exact solution we should use a large value .",
    "preliminary tests reveal that @xmath254 is a good choice for all subsequent numerical experiments .",
    "our collocation grid is defined as an equidistant grid of @xmath255 points for different values of @xmath76 .",
    "note that the grid points coincide with the knots of the b - splines .",
    "for the first four test cases benamou , froese , and oberman  @xcite suggest to use as an initial guess the solution of the poisson boundary value problem @xmath256 with the same dirichlet boundary conditions and for the same right - hand side function @xmath24 as for the corresponding monge - ampre equation . in  @xcite this poisson equation",
    "is solved in a preprocessing step and after that the result is convexified by the method of oberman  @xcite to ensure a convex initial guess .",
    "here we also use same initial guess for all five test cases , but , however , it turned out that our method works well even without convexifying the solution of .",
    "we therefore omit this step .",
    "the spline collocation method has been used to solve . in order to validate the numerical result",
    ", we compare the maximum absolute error of the numerical solution @xmath40 at the @xmath257 collocation points with the exact solution @xmath203 .",
    "the absolute errors are given in table  [ tab : error ] , while the corresponding computing times are denoted in table  [ tab : time ] .",
    "note that the computing time measurements indicate the overall time for the computation including the computation of the initial guess and the nested iteration scheme . in figure",
    "[ fig : max_error_and_time ] the dependency of the maximum error and the computing time on the number of unknowns are shown in a plot with logarithmic scale on both axes .",
    "we observe that the complexity of the solution method is proportional to @xmath258 .",
    ".maximum error @xmath259 for the first four test cases of subsection  [ subsubsec : test_cases_five ] .",
    "[ cols=\"^,^,^,^,^ \" , ]        & & & & & + 31 & 0.1 & 0.3 & 0.1 & 4.8 & 0.1 + 45 & 0.1 & 0.6 & 0.2 & 13.3 & 0.2 + 63 & 0.2 & 1.2 & 0.4 & 18.9 & 0.3 + 89 & 0.6 & 3.2 & 0.9 & 58.6 & 0.9 + 127 & 0.9 & 4.1 & 1.7 & 97.6 & 1.7 + 181 & 2.7 & 12.8 & 4.9 & 345.2 & 5.1 + 255 & 5.1 & 24.9 & 9.7 & 639.5 & 9.9 + 361 & 18.4 & 79.8 & 31.6 & 2193.7 & 32.9 +     ( see also table  [ tab : error ] and table  [ tab : time ] ) . ]    for a better comparison the grid sizes given by @xmath94 were chosen to match the choices of froese and oberman  @xcite .",
    "in that paper three of their methods  @xcite are compared for the first four test cases , where it turned out that the standard finite difference method  @xcite performed best for the first example . using regression analysis for our method we observe that the curve in the double - logarithmic plot has a slope of @xmath260 which corresponds to a quadratic convergence rate .",
    "this rate agrees with that achieved by the finite difference scheme .",
    "moreover , the differences in the maximum errors is less than a factor of @xmath261 .    for the little less smooth solution in the second example the standard finite difference method proposed in  @xcite still leads to smaller errors than the two methods in  @xcite .",
    "comparing the absolute errors our method improves the results of the standard finite difference method by a factor of @xmath262 to @xmath263 and we observe a slightly superlinear convergence rate .",
    "the third example is a big challenge for the methods because of the blow up of the gradient of the solution at the point @xmath237 . here",
    "the monotone scheme  @xcite and the hybrid scheme  @xcite perform best .",
    "our method shows a convergence that is approximately proportional to the square root of the mesh size .",
    "it works more precise than the standard finite difference method by a factor of about @xmath264 but is not as accurate as the other two schemes whose maximal errors are between @xmath265 and @xmath266 .",
    "due to the fact that the schemes  @xcite are constructed to converge also to viscosity solutions these methods are suited for less smooth solutions .",
    "the solution of the fourth example does not have a continuous first derivative in @xmath69 such that it is very difficult to handle even for standard spline interpolation . here",
    "all three methods given in  @xcite and also our method do not converge , the error does not drop below @xmath267 .",
    "interestingly , we observe that all three methods , the two methods of  @xcite , and our method , stagnate for @xmath94 larger than @xmath268 .",
    "in fact , we do not even expect that our collocation method converges , because it requires the solution to be twice differentiable .    in figure",
    "[ fig : example5 ] we visualize the result for the fifth test case .",
    "in fact , the solution is convex .",
    "figures  [ fig : example5_b ] and  [ fig : example5_c ] show cross section of the solution along the @xmath116-axis and along the diagonal , respectively .",
    "these can be compared with those of dean and glowinski  @xcite and feng and neilan  @xcite .",
    "we observe that both the curvature as well as the minimal values of the functions agree with those in the literature .      first , in subsection",
    "[ subsubsec : reflector_procedure ] we give some additional details that are crucial for numerically solving the inverse reflector problem .",
    "then in subsection  [ subsubsec : reflector_setting ] we define the geometric setting of our test case for the inverse reflector problem .",
    "afterwards we describe in subsection  [ subsubsec : reflector_initial_guess ] how we obtain a good initial guess and in subsection  [ subsubsec : reflector_results ] we present the results for some examples .",
    "we now briefly discuss the procedure of numerically solving the inverse reflector problem .",
    "to this end we focus on three issues that particularly need to be handled to successfully solve problem  [ problem : ir ] .",
    "[ [ boundary - condition ] ] boundary condition + + + + + + + + + + + + + + + + + +    in subsection  [ subsec : ma_equation ] we saw the mathematical formulation of the reflector problem for the near field and in subsection  [ subsec : reflector_boundary ] a relaxation to a sequence of subproblems . for each subproblem",
    "we have to solve an equation of monge - ampre type with an adjusted boundary function @xmath202 .",
    "moreover , we use an iterative nonlinear solver for the solution of each subproblem . to avoid solving the monge - ampre equation many times , we intertwine the iterations and update the boundary function @xmath202 immediately after each correction step in the iterative nonlinear solver instead of not updating @xmath202 until the nonlinear solver terminates .",
    "since we work on a rectangular target set @xmath5 we face the problem that the outer normal vector of @xmath212 is not defined in a corner . here",
    "we use the normalized sum vector of the two outer normal vectors of both adjacent edges , i.e. , the outer normal vectors at the corners of a rectangle @xmath269 are given by the vectors @xmath270 .",
    "[ [ dark - areas - on - the - target ] ] dark areas on the target + + + + + + + + + + + + + + + + + + + + + + + +    let the density function @xmath10 for our target illumination on @xmath5 be given by @xmath271 bit digital grayscale images , i.e. the gray values of the image are integer values in the range @xmath272 .",
    "since @xmath10 is in the denominator on the right - hand side of the monge - ampre equation , we require that @xmath10 is bounded away from zero .",
    "this lower bound should be as small as possible . to ensure this constraint we adjust brightness and contrast of the input image @xmath10 and consider the image @xmath273 instead , where the value of @xmath274 leads to good results .",
    "afterwards this density function needs to be normalized such that the energy conservation holds true .",
    "however , if we try to realize black values in the target image by letting some pixel values go to zero , the right - hand side of the monge - ampre equation tends to infinity .",
    "the left - hand side is more or less the determinant of the hessian of @xmath40 ; see , e.g. , the special case in equation , which also needs to go to infinity at some points because of the surjectivity constraint .",
    "it follows that the curvature of the reflector must be infinitely large at these points which leads to a kink on its surface .",
    "[ [ nested - iteration ] ] nested iteration + + + + + + + + + + + + + + + +    on the one hand our nonlinear solver profits from a good choice of the initial guess .",
    "but on the other hand , if we want to produce a very complex image on the target , we need to define our ansatz functions on a very fine grid .",
    "thus we have many degrees of freedom which makes it difficult to obtain a good initial guess .    an efficient way to address this problem is to apply the multilevel technique of subsection  [ subsec : splines_nested ] .",
    "we therefore start the computation on a very coarse grid of dimension @xmath275 and solve the inverse reflector problem . our target density function @xmath10",
    "will be given by an image of size @xmath276 pixels .",
    "thus we can not expect to be able to solve the reflector problem accurately on such a coarse grid .",
    "we therefore also coarsen the image . for this reason we define the _ standard mollifier function _",
    "@xmath277 if @xmath278 and zero otherwise .",
    "a discrete approximation of the mollifier function with a support of size @xmath162 pixels is given by @xmath279 for @xmath280 .",
    "we now convolve the image with @xmath281 for different @xmath64 and solve the problem for these modified images on grids of size @xmath255 for appropriate @xmath76 , i.e. , we solve the problem many times for different pairs @xmath282 to improve the solution ; see figure  [ fig : nested_iteration ] .",
    "we use the following pairs in the given order : @xmath283 , @xmath284 , @xmath285 , @xmath286 , @xmath287 , @xmath288 , @xmath289 , @xmath290 .    , where @xmath255 is the resolution of the grid and @xmath70 the parameter for the mollifier @xmath281 in .",
    "]      for the illumination of the mirror we choose an isotropic light source , i.e. , @xmath291 .",
    "our geometrical setting is given by the target surface , defined by @xmath292 and by the position of the reflector , which is given in the dimensioned drawing in figure  [ fig : reflector_situation_a ] .",
    "in the mathematical model , the size of the reflector is controlled by an appropriate constant @xmath293 in which in the following examples is @xmath294 .",
    "for the modified determinant we again choose the penalty constant @xmath295 , which leads to good results for all of our examples .",
    "the choice of the initial guess is crucial for the convergence of the newton - type scheme in the collocation method .",
    "therefore we need an initial guess that is close enough to the solution . since there are already other methods available to solve the inverse reflector problem , we can resort to one of them for the initialization . due to",
    "the nested iteration approach we only need to calculate an initial guess for a strongly blurred input density distribution on a very coarse initial grid .",
    "for that reason we choose the method of supporting ellipsoids  @xcite for this task , which is a viable choice , because of the low resolution the complexity of the method is not too high ; see also section  [ subsec : ellipsoid_method ] .    in principle",
    ", we need to generate a new initial guess when the desired density function @xmath10 changes .",
    "however , numerical evidence shows that this is not necessary and that we can prepare an universal initial guess that depends on the optical and geometric setup but no longer on @xmath10 .",
    "this is probably possible , because the collocation method starts on a very coarse grid using a strongly blurred and thus an `` almost '' constant version of @xmath10 .",
    "we therefore invoke the method of supporting ellipsoids and compute a reflector surface that produces a constant density function @xmath10 on the target .",
    "the solution specifies a surface that consists of segments of ellipsoids of revolution .",
    "next we approximate the solution in our b - spline ansatz space corresponding to the coarse initial grid using spline interpolation and we solve the inverse reflector problem again on the same grid with our spline collocation method .",
    "the output of the forward simulation of the resulting reflector is shown in figure  [ fig : reflector_situation_b ] .",
    "as desired the reflector produces a homogeneous illumination pattern on the target . in the following we use this reflector as the initial guess for all calculations in the same geometrical and optical setting but for different target illuminations @xmath10 .",
    "we now calculate the reflector surfaces for three test cases , where the desired target illuminations @xmath10 are given by three common grayscale test images from the usc - sipi image database  @xcite . in a post - processing step",
    "we run the forward simulation by ray tracing to compute the actual illumination pattern produced on the target by the designed reflector surface .",
    "figure  [ fig : reflector_results1 ] shows the simulation results .",
    "each of the three output images is very close to the corresponding original image and , although the images are slightly blurred , even complex details can easily be identified .",
    "note that the differences in the illumination between dark areas in the original pictures and the simulations are resulting from the fact that we have to lift dark gray values up ; see .",
    "therefore it is impossible to produce real black areas on the target .",
    "the three test images pose different challenges for our reflector design algorithm . in the first test image _ boat",
    "_ , see figure  [ fig : reflector_results1_a ] , the problem is to meet the straight lines of the mast , the person standing next to the boat and the lettering on the stern of the vessel .",
    "the simulation result looks very good , straight lines are depicted almost perfectly in all directions and the name of the vessel is still readable but only barely . in our selection",
    "the second image _ goldhill _ , see figure  [ fig : reflector_results1_b ] , represents a different type of pictures .",
    "it is rich of different patterns , e.g. the patterns of the roofing tiles and the windows in the foreground as well as the patterns of the trees and bushes in the background , such that we can test how well different patterns are reproduced .",
    "apart from the slight blurring effect the different patterns are well depicted and can be distinguished easily .",
    "the challenge of the image _ mandrill _ is to depict the hair of the beard of the monkey .",
    "we can see in figure  [ fig : reflector_results1_c ] that our algorithm also passes this test .",
    "as our final numerical example we compute the surface of a mirror that projects our institute s logo on the screen . note that this type of cartoon - like images with high contrast and sharp edges is most challenging for our algorithm",
    "nevertheless , our algorithm achieves a very good reproduction of the logo ; see figure  [ fig : reflector_results4_a ] for the desired intensity pattern and figure  [ fig : reflector_results4_b ] for the forward simulation result by ray tracing . in figure",
    "[ fig : reflector_diff_a ] we show the position and the coarse shape of the mirror surface , while the fine structure that contains the information of the image is visualized in figure  [ fig : reflector_diff_b ] after a high - pass filtering process .",
    "note that lighter areas on the screen correspond to large areas on the mirror surface .",
    "we have presented a new b - spline collocation method for the numerical solution of monge - ampre type equations , which are strongly nonlinear partial differential equations . some extensions and manipulations of the equations and boundary conditions",
    "have been explained in detail that render it possible to apply the collocation method to the solution of the inverse reflector problem formulated as a monge - ampre type equation .    in comparison with existing schemes developed in  @xcite",
    "our b - spline collocation method produces results that are similar to the finite difference scheme in  @xcite , which is the most accurate method for smooth solutions proposed in these publications .",
    "the largest obstructions encountered for the numerical solution of the inverse reflector problem are how to handle the boundary conditions , how to ensure the uniqueness of the solution , and how to achieve convergence in the numerical scheme .",
    "in fact , we explain how these issues can be resolved and that the b - spline collocation method is well - suited even for this strongly nonlinear problem .    in future work the authors plan to extend the numerical method to support other optical devices , in particular lenses .",
    "the problem is then , for example , to determine the two surfaces of a lens such that all light passing through this lens is redirected onto the target and produces a prescribed illumination pattern .",
    "this is a strongly related problem and can also be modeled by a monge - ampre type equation ; see , e.g. , @xcite .    in modern lighting applications sources",
    "can often no longer be assumed to be point sources , e.g. , in compact optical systems using light emitting diodes ( leds ) .",
    "therefore the challenging question arises how to handle extended light sources in the inverse reflector problem .",
    "the authors are deeply indebted to professor dr .",
    "wolfgang dahmen for many fruitful and inspiring discussions on the topic of solving equations of monge - ampre type .",
    ", _ mmoire concernant lapplication de la thorie expose dans le xviie cahier du journal de lcole polytechnique ,  lintgration des quations aux diffrentielles partielles du premier et du second ordre .",
    "_ , j. cole .",
    "r. polytech .",
    ", 11 ( 1820 ) , pp .",
    "http://gallica.bnf.fr/ark:/12148/bpt6k4336744/f2 .    ,",
    "_ nurbs - based inverse reflector design _ , in proceedings of congreso espaol de informtica grfica ( ceig ) 2008 , barcelona , spain , 2008 , pp .",
    "doi : http://dx.doi.org/10.2312/localchapterevents/ceig/ceig08/065-074[10.2312/localchapterevents/ceig/ceig08/065-074 ] .",
    ", _ sms design method in 3d geometry : examples and applications _ , in proceedings of spie , vol .  5185 of nonimaging optics : maximum efficiency light transfer vii , 2004 , pp .",
    "doi : http://dx.doi.org/10.1117/12.506857[10.1117/12.506857 ] .          , _",
    "@xmath296 penalty methods for the fully nonlinear monge - ampre equation _ , math . comp .",
    ", 80 ( 2011 ) , pp .",
    "doi : http://dx.doi.org/10.1090/s0025-5718-2011-02487-7[10.1090/s0025-5718-2011-02487-7 ] .",
    ", _ finite element approximations of the three dimensional monge - ampre equation _ , esaim math .",
    ", 46 ( 2012 ) , pp .  9791001 .",
    "doi : http://dx.doi.org/10.1051/m2an/2011067[10.1051/m2an/2011067 ] .",
    ", _ on the numerical solution of the problem of reflector design with given far - filed scattering data _ , in monge ampre equation : applications to geometry and optimization .",
    "proceedings of the nsf - cbms conference , deerfield beach , fl , usa , july 913 , 1997 , l.  a. caffarelli and m.  milman , eds .",
    "226 of contemporary mathematics , american mathematical society , providence , ri , 1999 , pp .",
    "doi : http://dx.doi.org/10.1090/conm/226[10.1090/conm/226 ] .",
    ", _ iterative reflector design using a cumulative flux compensation approach _ , in international optical design conference , osa technical digest , optical society of america , design of illumination systems : optimization and tolerancing approaches ( itha ) , 2010 .",
    "doi : http://dx.doi.org/10.1364/iodc.2010.itha2[10.1364/iodc.2010.itha2 ] .",
    ", _ an unsymmetric - pattern multifrontal method for sparse lu factorization _ , siam j. math .",
    "appl . , 18 ( 1997 ) , pp .",
    "doi : http://dx.doi.org/10.1137/s0895479894246905[10.1137/s0895479894246905 ] .",
    ", _ numerical solution of the two - dimensional elliptic monge - ampre equation with dirichlet boundary conditions : an augmented lagrangian approach _ , c. r. math . acad .",
    "paris , 336 ( 2003 ) , pp .",
    "doi : http://dx.doi.org/10.1016/s1631-073x(03)00149-3[10.1016/s1631-073x(03)00149-3 ] .",
    ", _ numerical solution of the two - dimensional elliptic monge - ampre equation with dirichlet boundary conditions : a least - squares approach _ , c. r. math .",
    "paris , 339 ( 2004 ) , pp .",
    "doi : http://dx.doi.org/10.1016/j.crma.2004.09.018[10.1016/j.crma.2004.09.018 ] .",
    ", _ an augmented lagrangian approach to the numerical solution of the dirichlet problem for the elliptic monge - ampre equation in two dimensions _",
    ", electron .",
    ", 22 ( 2006 ) , pp .",
    "eudml : http://eudml.org/doc/127457[eudml.org/doc/127457 ] .    , _ numerical methods for fully nonlinear elliptic equations of the monge - ampre type _ , comput .",
    "methods appl .",
    "engrg . , 195 ( 2006 ) , pp .",
    "doi : http://dx.doi.org/10.1016/j.cma.2005.05.023[10.1016/j.cma.2005.05.023 ] .",
    ", _ on the numerical solution of the elliptic monge - ampre equation in dimension two : a least - squares approach _ , in partial differential equations , r.  glowinski and p.  neittaanmki , eds . , vol .  16 of computational methods in applied sciences , springer , heidelberg , 2008 , pp",
    "4363 .      , _ numerical methods for unconstrained optimization and nonlinear equations _ , prentice - hall series in computational mathematics , prentice - hall , englewood cliffs , nj , 1983 .",
    "doi : http://dx.doi.org/10.1137/1.9781611971200[10.1137/1.9781611971200 ] .",
    ", _ reflector design as an inverse problem _ , in proceedings of the fifth european conference on mathematics in industry , m.  heili , ed . ,",
    "vol .  7 of european consortium for mathematics in industry , b. g. teubner , stuttgart , 1991 , pp",
    ".  1324 .    ,",
    "_ recent developments in numerical methods for fully nonlinear second order partial differential equations _ , siam rev",
    ". , 55 ( 2013 ) , pp .",
    "doi : http://dx.doi.org/10.1137/110825960[10.1137/110825960 ] .",
    ", _ mixed finite element methods for the fully nonlinear monge - ampre equation based on the vanishing moment method _ , siam j. numer .",
    ", 47 ( 2009 ) , pp .",
    "doi : http://dx.doi.org/10.1137/070710378[10.1137/070710378 ] .",
    ", _ vanishing moment method and moment solutions for fully nonlinear second order partial differential equations _ , j. sci .",
    "38 ( 2009 ) , pp .",
    "doi : http://dx.doi.org/10.1007/s10915-008-9221-9[10.1007/s10915-008-9221-9 ] .",
    ", _ geometry construction from caustic images _ , in computer vision ",
    "eccv 2010 , k.  daniilidis , p.  maragos , and n.  paragios , eds .",
    "6315 of lecture notes in computer science , springer , heidelberg , 2010 , pp .  464477 .",
    "doi : http://dx.doi.org/10.1007/978-3-642-15555-0_34[10.1007/978-3-642-15555-0_34 ] .",
    ", _ a numerical method for the elliptic monge - ampre equation with transport boundary conditions _ , siam j. sci .",
    "comput . , 34 ( 2012 ) , pp .",
    "doi : http://dx.doi.org/10.1137/110822372[10.1137/110822372 ] .    , _ convergent finite difference solvers for viscosity solutions of the elliptic monge - ampre equation in dimensions two and higher _ , siam j. numer .",
    ", 49 ( 2011 ) , pp .",
    "doi : http://dx.doi.org/10.1137/100803092[10.1137/100803092 ] .",
    ", _ fast finite difference solvers for singular solutions of the elliptic monge - ampre equation _ , j. comput . phys . , 230 ( 2011 ) ,",
    "doi : http://dx.doi.org/10.1016/j.jcp.2010.10.020[10.1016/j.jcp.2010.10.020 ] .",
    ", _ determination of reflector surfaces from near - field scattering data .",
    "ii : numerical solution _ , numer .",
    ", 79 ( 1998 ) , pp .",
    "doi : http://dx.doi.org/10.1007/s002110050351[10.1007/s002110050351 ] .          , _",
    "methods for non - linear least squares problems _ , technical report , department of mathematical modelling , danmarks tekniske universitet , copenhagen , 2004 .",
    "http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/3215/pdf/imm3215.pdf .                , _ design of 3d - reflectors for near field and far field problems _ , in large scale optimization with applications .",
    "part i : optimization in inverse problems and design , l.  t. biegler , t.  f. coleman , a.  r. conn , and f.  n. santosa , eds .",
    "92 of the i m a volumes in mathematics and its applications , springer , heidelberg , 1997 , pp .  101118 .",
    "doi : http://dx.doi.org/10.1007/978-1-4612-1962-0_6[10.1007/978-1-4612-1962-0_6 ] .",
    ", _ damping parameter in marquardt s method _ , technical report imm - rep-1999 - 05 , department of mathematical modelling , danmarks tekniske universitet , copenhagen , 1999 . http://www2.imm.dtu.dk/pubdb/p.php?648 .    , _ computing the convex envelope using a nonlinear partial differential equation _ , math .",
    "models methods appl .",
    ", 18 ( 2008 ) , pp .  759780 .",
    "doi : http://dx.doi.org/10.1142/s0218202508002851[10.1142/s0218202508002851 ] .",
    ", _ wide stencil finite difference schemes for the elliptic monge - ampre equation and functions of the eigenvalues of the hessian _ , discrete contin .",
    "b , 10 ( 2008 ) , pp .",
    "doi : http://dx.doi.org/10.3934/dcdsb.2008.10.221[10.3934/dcdsb.2008.10.221 ] .",
    ", _ a survey of inverse surface design from light transport behavior specification . _ , computer graphics forum , 24 ( 2005 ) , pp .  773789 .",
    "doi : http://dx.doi.org/10.1111/j.1467-8659.2005.00901.x[10.1111/j.1467-8659.2005.00901.x ] .      ,",
    "_ a numerical method for the design of free - form reflectors for lighting applications _ , technical report casa - report 13 - 22 , department of mathematics and computer science , eindhoven university of technology , the netherlands , 2013 .",
    "http://www.win.tue.nl/analysis/reports/rana13-22.pdf .            ,",
    "_ on the second boundary value problem for monge - ampre type equations and optimal transportation _ , ann .",
    "sc . norm .",
    "( 5 ) , 8 ( 2009 ) , pp .",
    "doi : http://dx.doi.org/10.2422/2036-2145.2009.1.07[10.2422/2036-2145.2009.1.07 ] .",
    ", _ oblique boundary value problems for equations of monge - ampre type _ , calc .",
    "partial differential equations , 7 ( 1998 ) , pp .",
    "doi : http://dx.doi.org/10.1007/s005260050097[10.1007/s005260050097 ] ."
  ],
  "abstract_text": [
    "<S> the inverse reflector problem arises in geometrical nonimaging optics : given a light source and a target , the question is how to design a reflecting free - form surface such that a desired light density distribution is generated on the target , e.g. , a projected image on a screen . </S>",
    "<S> this optical problem can mathematically be understood as a problem of optimal transport and equivalently be expressed by a secondary boundary value problem of the monge - ampre equation , which consists of a highly nonlinear partial differential equation of second order and constraints . in our approach </S>",
    "<S> the monge - ampre equation is numerically solved using a collocation method based on tensor - product b - splines , in which nested iteration techniques are applied to ensure the convergence of the nonlinear solver and to speed up the calculation . in the numerical method </S>",
    "<S> special care has to be taken for the constraint : it enters the discrete problem formulation via a picard - type iteration . </S>",
    "<S> numerical results are presented as well for benchmark problems for the standard monge - ampre equation as for the inverse reflector problem for various images . </S>",
    "<S> the designed reflector surfaces are validated by a forward simulation using ray tracing .    </S>",
    "<S> inverse reflector problem , elliptic monge - ampre equation , b - spline collocation method , picard - type iteration    35j66 , 35j96 , 35q60 , 65n21 , 65n35 , </S>"
  ]
}