{
  "article_text": [
    "density functional theory ( dft ) in general and the kohn - sham scheme in particular are among the most important tools for electronic structure calculations .",
    "this success is based on a rigorous foundation in terms of the hohenberg - kohn theorem on the one hand @xcite , and increasingly sophisticated approximations to the exchange - correlation functional @xmath1 on the other . the local density approximation ( lda ) @xcite proved to be of far greater applicability than originally expected .",
    "its great advantages are simplicity and reliability in the sense that its shortcomings are qualitatively predictable , but the price to be paid is limited accuracy .",
    "generalized gradient approximations ( gga s ) @xcite improved accuracy to a level that made dft useful for many chemical applications . but despite their many successes , gga s can not be regarded as the final stage of functional development @xcite .",
    "further improvements in accuracy are expected from functionals that include partial or full exact exchange .",
    "global @xcite and local @xcite hybrids and hyper - gga s @xcite fall into this class .    using the exact exchange energy in dft calculations",
    "is promising from many points of view .",
    "full exact exchange cancels the spurious hartree self - interaction energy , curing in a systematic way one of the most notorious dft problems .",
    "it leads to the correct high - density limit @xcite , which is exchange dominated .",
    "great improvements in the kohn - sham eigenvalue spectrum @xcite , semiconductor bandstructure and excitations @xcite and nonlinear optical properties @xcite have been reported using the exact exchange energy .",
    "the exact exchange functional also leads to the correct asymptotic @xmath2 behavior of the kohn - sham potential , which turns out to show surprising features not present in any of the common approximations , as discussed in refs .   and below .",
    "finally , the idea of incorporating one more known exact ingredient into the energy functional is appealing in its own right .",
    "but the goal of using the exact exchange energy or , more generally , any orbital functional self - consistently in kohn - sham calculations raises the question of how to construct the corresponding exchange - correlation potential .",
    "@xmath1 is still implicitly a functional of the density , but explicitly only its dependence on the set of occupied kohn - sham orbitals is known .",
    "thus , calculating the corresponding exchange - correlation potential @xmath3/\\delta n({{\\bf r }   } ) $ ] can not be done straightforwardly by explicitly taking the functional derivative with respect to the density @xmath4 . instead , the potential must be calculated from the optimized effective potential ( oep ) integral equation @xcite .",
    "this approach is size - consistent if the orbital functional is invariant under unitary transformations of the occupied orbitals and is not too radically nonlocal @xcite .",
    "size consistency is achieved for exact exchange , hybrid functionals @xcite , meta - gga s @xcite and hyper - gga s @xcite .    due to its complexity , direct solutions of the oep integral equation",
    "so far have been restricted to effectively one - dimensional systems with spherical symmetry @xcite , and the calculations for finite systems have been based on the program developed in ref .  .",
    "hopes are low to generalize this approach to higher dimensions .",
    "the oep for three - dimensional systems has been constructed by directly evaluating the response function using basis sets @xcite .",
    "this approach has proven successful , but requires considerable technical expertise : summing over not only occupied but also unoccupied kohn - sham orbitals is required , and the necessary inversion of the response function can be cumbersome . and while the oep total energy can be accurately obtained , the potentials and kohn - sham eigenvalues for finite systems may suffer from basis - set limitations . a detailed discussion of the method and its limitations can be found in refs .. alternatively , the short - range part of the potential itself has been expanded in a basis set and the expansion coefficients chosen to minimize the total energy @xcite .",
    "this approach is appealing because of its directness .",
    "but the @xmath5-decay that the oep is thereby forced to take everywhere in the asymptotic region of a finite system has to be reconsidered in the light of new conclusions about the asymptotic behavior of @xmath0 presented in refs . and discussed below .",
    "also , the method is hard to implement within fully numerical schemes for electronic structure calculations , and those continue to grow in importance @xcite .    in this manuscript we discuss how the oep can easily be constructed from the first - order orbital shifts that have been introduced into oep theory to justify the kli approximation @xcite .",
    "we first present in section [ secdensityshift ] a new proof for the oep equation that explains why this complicated equation can be cast in a simple form . in section [ sechf ]",
    "we compare and contrast hartree - fock theory and exact - exchange oep .",
    "different methods to construct the oep from the orbital shifts are analyzed in section [ secconstruction ] , together with indicators for the accuracy of an oep solution .",
    "the exact - exchange oep for spherical atoms and three - dimensional sodium clusters is calculated .",
    "its long - range asymptotic behavior is investigated in section [ secasymptotics ] .",
    "we show that the behavior @xmath6 , with @xmath7 on nodal surfaces of the highest occupied kohn - sham orbital , is a common situation for metal clusters .",
    "finally , in section [ secpol ] we calculate the static electric polarizability for the neutral , even - electron clusters @xmath8  @xmath9 in the exchange - only approximation , and compare lda , kli and exact oep results .",
    "as shown by krieger , li and iafrate @xcite and further clarified by grabo , kreibich , kurth and gross @xcite , the oep integral equation for the spin - dependent exact kohn - sham exchange - correlation potential @xmath10 can be written in a form that takes a very simple interpretation . at the end of a long argument involving repeated application of the chain rule for functional derivatives and linear response theory ,",
    "the oep equation is written in the form @xmath11 eq .  ( [ oep ] )",
    "says that the optimum ( i.e. , yielding the lowest kohn - sham energy ) potential @xmath10 to replace the orbital - dependent potential @xmath12 }        { \\delta \\varphi_{i \\sigma}({{\\bf r }   } ) } \\ ] ] is the one that makes the change in the density vanish to first order in the perturbation @xmath13 when this perturbation is applied to the kohn - sham system .",
    "the @xmath14 in eq .",
    "( [ oep ] ) are the kohn - sham orbitals , i.e. , the solutions of @xmath15 where @xmath16 is the kohn - sham hamiltonian .",
    "the self - consistent kohn - sham potential @xmath17 is the sum of the external potential @xmath18 , the hartree potential @xmath19 , and the spin - dependent exchange - correlation potential @xmath20/\\delta n_\\sigma({{\\bf r }   } ) $ ] .",
    "( @xmath18 can also depend upon @xmath21 , but usually does not . )",
    "@xmath22 is the negative of the first - order perturbation - theory shift that results if @xmath23 is subjected to the perturbation of eq .",
    "( [ pertv ] ) , i.e , @xmath24    \\varphi_{j \\sigma}({{\\bf r ' }   } ) \\ , \\mathrm{d}^3 r ' } { \\varepsilon_{i \\sigma}-\\varepsilon_{j \\sigma } } \\varphi_{j \\sigma}^*({{\\bf r }   } ) .",
    "\\nonumber \\end{aligned}\\ ] ] for the sake of simplicity , we here assume non - degenerate orbitals . the extension to the degenerate case is unproblematic : as shown in appendix b of ref .",
    ", the restriction @xmath25 in the sum is to be replaced by @xmath26 .",
    "note that , if the exact exchange energy @xmath27= -\\frac{e^2}{2 }   \\sum_{\\stackrel{\\scriptstyle i , j=1}{\\sigma=\\uparrow,\\downarrow}}^{n_\\sigma } \\int \\int   \\frac {   \\varphi_{i \\sigma}^*({{\\bf r }   } ) \\varphi_{j \\sigma}^*({{\\bf r ' }   } )   \\varphi_{j \\sigma}({{\\bf r }   } ) \\varphi_{i \\sigma}({{\\bf r ' }   } )    } {   \\left| { { \\bf r }   } -{{\\bf r ' }   } \\right|   } \\mathrm{d}^3r ' \\ , \\mathrm{d}^3r,\\ ] ] is substituted for @xmath1 , then eq .  ( [ defu ] )",
    "just yields the orbital - dependent hartree - fock potential@xcite @xmath28    eq .",
    "( [ oep ] ) is intuitively appealing for the following reasons : ( 1 ) it is a statement about the electron spin density , the central quantity of density functional theory .",
    "going over from the optimized effective potential to the orbital - dependent potentials should not change the density much .",
    "in important limits ( one- and two - electron ground states , and the uniform electron gas ) , the density should not change at all .",
    "( 2 ) once the oep orbitals and orbital energies are fixed , eq .",
    "( [ oep ] ) is homogeneous of degree one in the perturbation of eq .",
    "( [ pertv ] ) , making @xmath29 a kind of average of the @xmath30 .",
    "a simple average was proposed in eq.(75 ) of ref .  , and averaged potentials are popular in time - dependent dft @xcite .",
    "a sophisticated but still approximate average was proposed in ref .  .",
    "( 3 ) eq.([oep ] ) contains just enough information to define @xmath29 uniquely to within an additive constant , given the oep orbitals and orbital energy differences : imagine discretizing the @xmath31 space into a collection of @xmath32 points @xmath33 , and solving eq .",
    "( [ oep ] ) as a set of @xmath34 linear equations for the @xmath34 unknowns @xmath35 .",
    "because the number of electrons can not change , only @xmath34 equations are linearly independent , leaving @xmath36 as a free parameter .",
    "this parameter is normally chosen so that @xmath37 .",
    "the oep equation has previously been investigated from different perspectives @xcite .",
    "but an equation as charmingly simple as eq .",
    "( [ oep ] ) also deserves a simple proof .",
    "we provide one in the following . for notational simplicity",
    ", we drop the spin index @xmath21 in the rest of this section .",
    "we start from a given expression for the total energy in terms of some set of orbitals @xmath38 , @xmath39=   \\frac{\\hbar^2}{2m}\\sum_{i=1}^n\\int   |\\nabla \\phi_i({{\\bf r }   } ) |^2 \\ , \\mathrm{d}^3r +   \\int v({{\\bf r }   } ) n({{\\bf r }   } ) \\",
    ", \\mathrm{d}^3r } \\nonumber \\\\ & & +   \\frac{e^2}{2 } \\int \\int \\frac{n({{\\bf r }   } ) n({{\\bf r ' }   } ) } { |{{\\bf r }   } -{{\\bf r ' }   } | }    \\mathrm{d}^3r ' \\mathrm{d}^3r + \\alpha e_\\mathrm{xc}[\\{\\phi\\ } ] , \\label{ephi}\\end{aligned}\\ ] ] where @xmath40 the real parameter @xmath41 is introduced for the sake of later arguments and can be set to 1 at the end .",
    "based on eq .",
    "( [ ephi ] ) , two different density functionals can be defined .",
    "the kohn - sham ( i.e , oep ) functional is defined by choosing the @xmath38 to be the kohn - sham orbitals @xmath42 .",
    "this means that for a given density @xmath4 , we find a local potential @xmath43 such that the solutions of the independent - particle schrdinger equation @xmath44 yield the given density via eq .",
    "( [ defn ] ) .",
    "the orbitals are clearly functionals of @xmath43 which is itself a functional of @xmath4 .",
    "the kohn - sham energy functional is then @xmath45=e_v^\\alpha[\\{\\varphi[n]\\}].\\ ] ] eq .",
    "( [ eks ] ) is minimized by the density @xmath46 , and this density is obtained by choosing for @xmath43 the potential of eq .",
    "( [ kspot ] ) ( with @xmath47 multiplied by @xmath41 , see below ) .",
    "we define a second , `` orbital '' density functional @xmath48= e_v^\\alpha[\\{\\varphi^{\\mathrm{orb},\\alpha}[n]\\}]\\ ] ] as the energy obtained by evaluating eq .",
    "( [ ephi ] ) with a different set of orbitals @xmath49 .",
    "the @xmath50 are defined as those normalized linearly - independent orbitals that yield a given density via eq.([defn ] ) and deliver the lowest extremum of @xmath51 $ ] .",
    "( this definition is discussed in appendix [ appendixa ] ) .",
    "the density @xmath52 that minimizes @xmath53 $ ] results from the orbitals that are solutions of @xmath54 the requirement of a local , orbital - independent potential in the definition of @xmath55 $ ] can be understood as an additional constraint not present in @xmath53 $ ] .",
    "therefore , if we define a functional @xmath56 $ ] by @xmath57 = e_v^{\\mathrm{oep},\\alpha}[n ] + a^\\alpha[n],\\ ] ] we know that @xmath56\\leq 0 $ ] . from the minimum principle for",
    "@xmath53 $ ] , and from the preceding statement , it is clear that @xmath58 < e_v^{\\mathrm{orb},\\alpha}[n^{\\mathrm{oep},\\alpha } ] < e_v^{\\mathrm{oep},\\alpha}[n^{\\mathrm{oep},\\alpha}].\\ ] ] for a given orbital functional , one achieves a lower energy with the orbital - dependent potentials than with the oep .",
    "( [ oep ] ) can now be deduced directly from the @xmath41-dependence of the two energy functionals .",
    "we first observe that @xmath59;{{\\bf r }   } ) = \\alpha \\frac{\\delta e_\\mathrm{xc}^\\mathrm{oep}[n]}{\\delta n({{\\bf r }   } ) } , \\ ] ] and @xmath60 }        { \\delta \\phi_i({{\\bf r }   } ) } , \\ ] ] i.e. , both the orbital - independent and the orbital - dependent potential depend linearly on @xmath41 . we further observe that , in contrast to the @xmath61 , the kohn - sham orbitals for a given density do not depend on @xmath41 : the hohenberg - kohn theorem tells us that , for a given density , @xmath43 and thus the orbitals @xmath62 are uniquely fixed .",
    "finally , we observe that for @xmath63 , the functionals eq .",
    "( [ eks ] ) and eq .",
    "( [ eorb ] ) are trivially identical .",
    "( thus , in eq .",
    "( [ eorbpower ] ) below , @xmath64=e_v^{\\mathrm{oep},0}[n]$ ] . )    from the second observation and eq .",
    "( [ ephi ] ) one deduces that , for fixed external potential @xmath18 and fixed density @xmath4 , the @xmath41-dependence of the oep - functional is @xmath65=e_v^{\\mathrm{oep},0}[n]+ \\alpha e_\\mathrm{xc}[\\{\\varphi[n]\\}].\\ ] ] in contrast , @xmath53 $ ] in general will not have such a simple dependence on @xmath41 since the @xmath50 for a given density will change with @xmath41 .",
    "thus , the power series @xmath66=e_v^{\\mathrm{orb},0}[n ] +   \\alpha e_{v,1}^{\\mathrm{orb}}[n ] + \\alpha^2 e_{v,2}^{\\mathrm{orb}}[n ] + ... , \\ ] ] where formally @xmath67= ( \\partial e_v^{\\mathrm{orb},\\alpha}[n]/\\partial \\alpha)|_{\\alpha=0}$ ] , etc . , will have non - vanishing terms beyond the one linear in @xmath41 .",
    "however , the crucial fact to note is that the term linear in @xmath41 is the same in @xmath55 $ ] and @xmath53 $ ] : at @xmath63 ( hartree approximation ) , the orbitals are the same , i.e. , @xmath68 , and we know that there can be no first - order change in @xmath53 $ ] due to a change in the orbitals , because we defined the @xmath61 as extremizing orbitals",
    ". therefore , @xmath67=e_\\mathrm{xc}[\\{\\varphi[n]\\}]$ ] .",
    "this means that the functional @xmath56 $ ] of eq .",
    "( [ defa ] ) vanishes to linear order in @xmath41 .",
    "it is then intuitively clear that the densities that minimize @xmath53 $ ] and @xmath55 $ ] must also be the same to linear order in @xmath41 .",
    "in other words , the difference to first order in @xmath41 between @xmath52 and @xmath46 must vanish , and , because of eqs .",
    "( [ vxca ] ) and ( [ ua ] ) , this difference is just given by the left - hand side of eq .",
    "( [ oep ] ) .",
    "a detailed version of these arguments is presented in appendix [ appendixb ] .",
    "note that the determinant of orbitals satisfying eqs .",
    "( [ spseq ] ) or ( [ orbeq ] ) and achieving the lowest total energy need not necessarily satisfy the aufbau principle , but might have unoccupied orbitals with orbital energies lying below occupied ones .",
    "note further that , in the absence of a magnetic field , all the orbitals can be chosen to be real .",
    "as an important example of the ideas of section [ secdensityshift ] , let @xmath69 $ ] in eq .",
    "( [ ephi ] ) be the fock exchange integral of the occupied orbitals of eq .",
    "( [ exx ] ) .",
    "then the lowest extremum over linearly - independent orbitals in the definition of @xmath53 $ ] becomes the minimum over orthonormal orbitals . for given external potential @xmath18 and electron number @xmath70 ,",
    "the @xmath71 are the canonical hartree - fock orbitals .",
    "$ ] is the density functional for the hartree - fock energy defined by the levy constrained search @xcite ( but not known as an explicitly calculable functional of the kohn - sham orbitals or of the density ) .",
    "its minimizing density @xmath73 is the hartree - fock density , and @xmath74 $ ] is the hartree - fock energy .",
    "the minimizing problem for this functional can be formulated within kohn - sham theory , but the resulting kohn - sham orbitals @xmath75;{{\\bf r }   } ) $ ] are _ not _ the hartree - fock orbitals , although both sets of orbitals yield the same density .",
    "the relation between hartree - fock theory and dft has also been studied in ref .  .",
    "on the other hand , @xmath55 $ ] is by definition @xcite the exact exchange - only density functional of kohn - sham theory ( an explicitly calculable functional of the kohn - sham orbitals , and one which defines the lower limit of the integrand in the coupling constant or adiabatic connection formula for @xmath76 $ ] @xcite ) . the inequality following eq .",
    "( [ defa ] ) shows that the hartree - fock exchange energy for a given density includes a negative contribution which from the exchange - only oep perspective is a small part of the correlation energy @xcite .",
    "( the local density approximation to this part of the correlation energy vanishes , while its second - order gradient coefficient diverges @xcite , making it very hard to approximate . ) since @xmath77 plays the same multiplicative role as @xmath41 , the exact exchange energy of kohn - sham theory @xcite for a given density is purely of order @xmath77 , while the hartree - fock exchange energy for the same density agrees with it to order @xmath77 , differing in order@xcite @xmath78 .",
    "( [ ineq ] ) also shows that the hartree - fock total energy must be less than the total energy of the exact exchange - only oep theory .",
    "these exact - exchange conclusions are not new @xcite , yet these subtle distinctions continue to cause some confusion .",
    "the hartree - fock and exchange - only oep minimizing densities for a given @xmath18 also agree to order @xmath77 , differing from one another and from the correlated ground - state density in order @xmath78 .",
    "since the highest - occupied orbital energy controls the asymptotic decay of the density , the highest occupied orbital energies must also agree to order @xmath77 with one another , and with minus the correlated first ionization energy @xcite .",
    "this helps to explain the observed @xcite but previously unexplained ( except by eq .",
    "( [ vnequn ] ) below ) closeness of these quantities .    given @xmath18 ,",
    "the hartree - fock and exchange - only oep orbitals and other orbital energies differ in order @xmath77 .",
    "a good approximation to the occupied hartree - fock orbitals can be achieved by a unitary transformation of the occupied canonical oep orbitals @xcite . in particular , after mixing in the highest occupied oep orbital , all the canonical hartree - fock orbitals so approximated will decay asymptotically with the same exponent .",
    "however , exact agreement is not expected even to order @xmath77 , since eq .",
    "( [ psipert ] ) shows that to order @xmath77 each _ exact _ canonical hartree - fock orbital is a superposition of all the exact - exchange occupied _ and unoccupied _ oep orbitals .",
    "thus , for a given @xmath18 , the hartree - fock and exchange - only oep slater determinants ( which are invariant under unitary transformations of their occupied orbitals ) also differ to order @xmath77 , and only the hartree - fock determinant agrees to order @xmath77 with the singles - only configuration interaction expansion of the correlated many - electron wavefunction ( brillouin s theorem @xcite ) .",
    "the fact that the oep can be expressed solely in terms of the occupied kohn - sham orbitals and their first - order shifts leads to a simple scheme for its construction . as a straightforward result from first - order perturbation theory , the partial differential equations @xmath79\\varphi_{i\\sigma}^*({{\\bf r }   } ) \\end{aligned}\\ ] ] for the orbital shifts",
    "@xmath22 are obtained , where @xmath80 and @xmath81 ( note that the same equations can be obtained by other arguments @xcite ) . by solving eq .",
    "( [ psipde ] ) for @xmath82 , inserting the result into eq.([oep ] ) multiplied by @xmath83 , and solving for @xmath84 , the exact exchange - correlation potential can be expressed explicitly in terms of only the occupied kohn - sham orbitals and their shifts @xcite : @xmath85 \\right .",
    "\\nonumber \\\\ & & \\left .",
    "+ \\varphi_{i\\sigma}({{\\bf r }   } ) \\left[\\left ( \\frac{\\hbar^2}{2m}\\nabla^2+\\varepsilon_{i\\sigma } \\right)\\psi_{i \\sigma}^*({{\\bf r }   } ) \\right ]   \\right\\ } + c.c.\\end{aligned}\\ ] ] invoking eq .",
    "( [ oep ] ) once more , the last term can be rewritten to obtain the expression from which the kli approximation  neglecting the terms involving the @xmath86  has been justified as a mean - field approximation @xcite : @xmath87 \\right .",
    "\\nonumber \\\\ & & \\left .",
    "-\\frac{\\hbar^2}{m}\\nabla \\cdot \\left[\\psi_{i \\sigma}^*({{\\bf r }   } ) \\nabla           \\varphi_{i\\sigma}({{\\bf r }   } ) \\right ] \\right\\ } + c.c.\\end{aligned}\\ ] ] since the potential @xmath29 of eq .",
    "( [ oepexpl2 ] ) is fixed only up to an additive constant , one is at liberty to choose one of the constants @xmath88 freely .",
    "the usual choice is @xcite @xmath89 to make the potential vanish at infinity .",
    "we will discuss this point in greater detail in section [ secasymptotics ] .",
    "together with the orthogonality condition @xmath90 that follows from eq .",
    "( [ psipert ] ) , eq .",
    "( [ psipde ] ) uniquely determines the orbital shifts . in case of degeneracies",
    ", the orthogonality condition reads @xmath91 for all pairs @xmath92 with @xmath93 . in ref .",
    "it was demonstrated that the @xmath94 can easily be calculated from eq .",
    "( [ psipde ] ) and used to construct the oep .",
    "the basic idea is to combine the kohn - sham equations ( [ kseq ] ) with the orbital shift equations ( [ psipde ] ) in a self - consistent iteration .",
    "this can be done in different ways .",
    "the first and obvious one consists of the following steps : solve the kohn - sham equations with an approximation to the oep , e.g. , do a kli calculation . use the resulting @xmath95 and @xmath84 to construct the right - hand side of eq.([psipde ] ) .",
    "solve , e.g. , by conjugate gradient iteration @xcite , for the orbital shifts .",
    "insert the @xmath96 into eq .",
    "( [ oepexpl2 ] ) to obtain an improved approximation for @xmath84 .",
    "then self - consistently solve the kohn - sham equations again for _ fixed _",
    "@xmath84 to obtain a new total energy and new eigenvalues .",
    "repeat these steps until convergence is achieved .",
    "this simple procedure only involves the occupied orbitals and their shifts . instead of an integral equation",
    ", it only requires solving partial differential equations , which can easily be done .",
    "we thus gain all the advantages of avoiding the explicit evaluation of the response function that are known from other areas of linear response theory @xcite .    in practice",
    ", a small modification of this algorithm is useful .",
    "after @xmath84 has been updated , one need not directly go back to the kohn - sham equations .",
    "instead , one can solve eq.([psipde ] ) again , keeping the left - hand side and the @xmath95 fixed but evaluating the right - hand side with the new @xmath84 . using this additional",
    "( @xmath97)-cycle speeds up the convergence , and eq .",
    "( [ psipde ] ) is easier to solve than eq.([kseq ] ) since it is just a differential and not an eigenvalue equation .",
    "we discuss numerical aspects of the iteration and its convergence in detail in appendix [ appendixc ] . here",
    "we just point out that the iteration converges very quickly : starting , e.g. for the be atom , from the kli approximation and using 5 cycles per iteration , the total energy is correct after the first iteration and all eigenvalues after 5 iterations .",
    "the iterative approach is also accurate .",
    "one criterion that indicates an accurate oep can be inferred directly from eq.([oep ] ) .",
    "the function @xmath98 must vanish for the exact oep .",
    "therefore , the smaller the maximum value @xmath99 that @xmath100 takes in a given region of space , the more accurate is the potential . for the kli potential of the be atom",
    ", we find @xmath101 .",
    "after 5 iterations with 5 cycles , @xmath99 has fallen below @xmath102 .",
    "a second accuracy criterion is the exchange virial relation @xcite .",
    "it is slightly violated by the kli approximation with a relative error of about 1% . by the time our iteration has refined all eigenvalues to 0.0001 hartree ( 0.1 mhar ) accuracy ,",
    "the error in the virial relation has been reduced to @xmath103% , and further iteration reduces it to @xmath104% .",
    "the method is thus at least as accurate as the direct solution of the integral equation @xcite .    however , applied to finite systems , eq .",
    "( [ oepexpl2 ] ) has an unpleasant feature : the second term under the sum on the right - hand side must be divided by the density .",
    "while this is not a problem theoretically , it complicates the numerical evaluation of eq .",
    "( [ oepexpl2 ] ) for finite systems . far away from the system the density decays exponentially , and numerically dividing by a rapidly vanishing function introduces inaccuracies .",
    "these inaccuracies in the asymptotic region can magnify during the iteration and , if not taken care off , can spoil the whole scheme . in appendix [ appendixc ]",
    "we discuss this problem in greater detail , together with strategies to overcome it . here",
    "we want to focus on how it can be completely avoided .    for many numerical problems ,",
    "iterative solution strategies can be designed in different ways @xcite .",
    "therefore , there is no reason to believe that eq .",
    "( [ oepexpl2 ] ) is the only way that the information contained in the orbital shifts can be used .",
    "in fact , eq .  ( [ defs ] ) suggests a very simple , pragmatic alternative : since @xmath105 is an indicator for the error inherent in a given approximation to the oep , we improve the given approximation by adding the corresponding @xmath105 to it : @xmath106 the real parameter @xmath107 with dimension energy times volume is introduced because @xmath105 is not an exact representation of the error but just an estimate . since it is not guaranteed that the @xmath108 from eq .",
    "( [ siter ] ) will obey eq .",
    "( [ vnequn ] ) , we enforce it explicitly by adding the constant @xmath109 to @xmath110 each time it has been updated via eq .",
    "( [ siter ] ) .",
    "( see ref . for an intuitive explanation of the same idea . )",
    "( [ siter ] ) , together with adding the constant , can replace the update of @xmath84 via eq .",
    "( [ oepexpl2 ] ) , and all the other steps described in the three paragraphs following eq.([vnequn ] ) stay the same . as shown below , introducing @xmath111 can be understood as replacing by a constant a term that requires dividing by the density .",
    "doing so , we drop some information from the error feedback , and therefore the iteration converges somewhat slower than the direct iteration of eq.([oepexpl2 ] ) .",
    "but with 10 ( @xmath97)-cycles per iteration , the total energies of the atoms be , ne , na , mg , and ar converge within 0.1 mhar in 2 , 2 , 2 , 5 , and 7 iterations , respectively ( and a larger number of cycles further reduces the number of necessary iterations ) .",
    "the computational effort is therefore only moderate .",
    "the oep energies from our solution are identical to the ones found from the considerably more involved direct solution of the integral equation @xcite , and the iteration is as accurate ( see appendix [ appendixc ] for tests ) .",
    "this approach can be motivated further by rewriting eq .  ( [ psipde ] )",
    "such that the left - hand side becomes @xmath112 and inserting the result into the right - hand side of eq.([oepexpl1 ] ) to obtain @xmath113 this is a trivial identity if @xmath95 and @xmath96 are the orbitals and shifts corresponding to the true oep .",
    "however , if @xmath95 and @xmath96 have been calculated from an approximation to the oep , then the second term on the right - hand side does not vanish and represents an error term .",
    "its most important part is the function @xmath105 which by definition contains the information about where the oep equation is violated . by subtracting the error term from the approximation",
    ", we get a better approximation .",
    "but we only want to subtract the part that is proportional to @xmath84 , @xmath114 because for stability reasons we do not want to change @xmath84 too drastically in each iteration .",
    "( subtracting the full term using @xmath115 would , e.g. , introduce a very different length scale and the nuclear singularity into the iteration .",
    "besides , in the neutral systems of interest here , @xmath47 dominates the asymptotics of @xmath115 . ) we have tested eq .",
    "( [ nearlythere ] ) for spherical atoms , and it converges nearly as quickly as the direct iteration of eq .",
    "( [ oepexpl2 ] ) .",
    "but since eq .",
    "( [ nearlythere ] ) also requires dividing by the density , the simpler iteration based on eq .",
    "( [ siter ] ) is more practical , in particular for the cluster calculations .",
    "( [ nearlythere ] ) provides an interpretation for the constant @xmath111 : it takes the role of an average value for @xmath116 . since @xmath84 is negative and we chose @xmath111 to be positive , the signs in eqs .",
    "( [ siter ] ) and ( [ nearlythere ] ) are opposite .",
    "in practice , the numerical value of @xmath111 can be determined unproblematically by trial and error .",
    "for the systems we studied , we found @xmath111 close to the values inferred from eq .",
    "( [ nearlythere ] ) ; see appendix [ appendixc ] .",
    "( [ siter ] ) can very easily be employed in three - dimensional calculations and allows us to study the influence that the exact exchange functional has on non - spherical systems .",
    "the electrons in atoms are rather strongly localized .",
    "metal clusters , and in particular sodium clusters , have a very different electronic structure with strongly delocalized valence electrons .",
    "they can thus be regarded as an `` opposite '' test case for the influence of exact exchange .",
    "of particular interest is their static electric polarizability , which we will address in section [ secpol ] below .",
    "[ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]     however , eq .  ( [ oepexpl2 ] ) requires dividing by the density , and this is a disadvantage if it is to be used for finite systems .",
    "the first term under the sum is unproblematic .",
    "it is asymptotically dominated by the highest occupied orbital which also dominates the density .",
    "thus , even if the density in the denominator has decayed to the extent that its numerical representation becomes highly inaccurate , the same inaccuracies show up in the numerator , and the correct result is still obtained .",
    "this cancellation does not occur in the second or gradient term , and the resulting inaccuracies can make the scheme unstable . for spherical systems ,",
    "the problem can easily be solved . in the asymptotic region ,",
    "the kli potential is already correct , therefore the second term need not be evaluated numerically there . and the asymptotic region for a spherical system can easily be identified by going out from the system s center and monitoring when the density starts to be dominated by the highest occupied orbital . in this way",
    ", calculations for spherical atoms can be done simply .",
    "but the accuracy of the method depends rather sensitively on the cut - off point : with a cut - off too close to the system s center , too much of the second term is lost ; with a cut - off that is too far away , the iteration becomes unstable . in the spherical , effectively one - dimensional calculations ,",
    "the numerical parameters can be chosen such that finding an appropriate cut - off radius is possible .",
    "our real interest , however , is in non - spherical systems of possibly complex shape .",
    "we found that for three - dimensional ( 3d ) systems , the technical difficulties are more severe .",
    "the coarser grids that computational necessity forces on us lead to larger inaccuracies in the evaluation of the derivatives that appear in the second term and allow for less fine tuning of the cut - off point .",
    "furthermore , the asymptotic region will start at different distances in different directions and must be mapped out more carefully .    as a first test case for a 3d implementation of our algorithm",
    ", we chose the jellium cluster @xmath117 .",
    "it is a good test case because it is spherical , i.e. , the oep can be obtained from the established direct solution of the integral equation for comparison @xcite .",
    "but unlike the diverging atomic nuclear potential , jellium @xmath117 can also be represented on the 3d cartesian grid which we use for a realistic , pseudopotential - based description of metal clusters .",
    "the seitz radius ( @xmath118^{1/3}$ ] ) of the jellium background density was @xmath119 , corresponding to a sphere of radius @xmath120 .",
    "we first calculated the kli approximation and compared a spherical , one - dimensional calculation on a logarithmic grid to a 3d calculation ( cartesian grid , 65 points in each direction , spacing @xmath121 , damped gradient iteration with finite - difference multigrid relaxation @xcite ) that does not exploit the spherical symmetry . both yield identical energies and eigenvalues to within 0.1 mhar .",
    "this confirms the accuracy of our 3d code .",
    "we then constructed the oep iteratively on the same grid for different cut - off radii between @xmath122 and @xmath123 . only with cut - offs close to @xmath124 was the iteration unproblematic and converged to the correct total energy e=-0.3735 har .",
    "however , the lowest eigenvalue was still 0.4 mhar above its correct value 0.2081 har , i.e. , halfway between the oep and kli values . obtaining the oep via eq .",
    "( [ oepexpl2 ] ) for the real , non - spherical clusters turned out to be even more complicated .",
    "the situation can be improved with finer grids , but using eq .",
    "( [ oepexpl2 ] ) in 3d calculations is rather tedious .",
    "the iteration based on eq .",
    "( [ siter ] ) does not suffer from these problems .",
    "the convergence is slower than for the first method , but the computational effort is still very moderate : for the test system jellium @xmath117 , the total energy and all eigenvalues converge within 5 iterations if 10 cycles are used . with eq .",
    "( [ siter ] ) , the 3d calculation now also yields exactly the same energy and eigenvalues as the spherical , direct solution of the oep integral equation @xcite . during the iterations ,",
    "the relative error in the exchange virial relation falls by two orders of magnitude compared to the kli approximation , and @xmath99 decreases to @xmath125 .",
    "further iterations reduce both quantities further .",
    "thus , the simple iteration very accurately yields the exact oep also for 3d systems .",
    "the parameter @xmath111 used in the iteration was chosen by trial and error .",
    "if @xmath111 is chosen too large , the iteration diverges , and with @xmath111 too small , it does not converge as quickly as possible . in all cases we studied , finding appropriate values for @xmath111 was unproblematic and there was a range of suitable values .",
    "we used @xmath111 s between 3 har@xmath126 and 0.75 har@xmath127 for the atoms , and @xmath111=30 har@xmath127 for all the cluster calculations .",
    "thus , @xmath111 was similar for similar systems , i.e. , @xmath111 s of about 1 were appropriate for the atoms with their singular nuclear potential , and larger @xmath111 s could be used for the non - singular pseudopotential calculations .",
    "these values can be understood on the basis of eq.([nearlythere ] ) . for @xmath128 ,",
    "e.g. , @xmath129 takes values between 30 har@xmath127 and 40 har@xmath127 in the interior region of the cluster . a yet simpler and charming argument",
    "can be made based on the bulk limit . for a homogenous system , @xmath130 har@xmath131 . for bulk sodium , @xmath119 ,",
    "so @xmath132 30 har@xmath127 , and for atoms , the average density is about @xmath133 , so @xmath134 is about 2 har@xmath127 .",
    "these estimates agree nicely with the values we found by trial - and - error . finally , we want to remark that the iteration could also be used with some suitably chosen @xmath135 , but for our present purposes a constant was satisfactory .",
    "looking at fig .  [ fig1 ] , one might ask the following question : the kli and oep orbitals are rather similar . therefore , in eq.([psipde ] ) the operator on the left - hand side and all quantities on the right - hand side should be similar , too .",
    "but then , also the orbital shifts that are calculated from eq .",
    "( [ psipde ] ) should be similar .",
    "so how can it be that we observe the pronounced difference between the kli and oep orbital shift @xmath136 shown in the lowest part of fig .",
    "[ fig1 ] ?",
    "the answer to this equestion is that although the kohn - sham orbitals obtained from the kli potential and the oep are similar , the respective right - hand sides in eq .",
    "( [ psipde ] ) nevertheless show a qualitative difference .",
    "the higher kohn - sham orbital @xmath137 has a nodal surface in the x - y plane , i.e. , its orbital density vanishes there .",
    "therefore , in this plane the kli potential is just given by @xmath138 . if this is inserted for @xmath0 in the right - hand side of eq .",
    "( [ psipde ] ) , the right - hand side vanishes .",
    "but for the oep , there is an additional contribution to @xmath0 from the term of eq .",
    "( [ oepexpl2 ] ) that involves the derivatives of the kohn - sham orbitals and their orbital shifts , and this term makes a non - vanishing contribution in the x - y plane .",
    "the qualitative difference between oep and kli orbital shift is thus a direct consequence of a qualitative difference of the respective right - hand sides in eq .",
    "( [ psipde ] ) .                                                                                                      with this choice for @xmath30 , eq.([oep ] ) is the first of a series of equations which assert that the density does not change to _ any _ order of many - body perturbation theory along the adiabatic connection , see a.  grling and m.  levy , int .",
    "j.  quantum chem .",
    "s * 29 * , 93 ( 1995 ) ."
  ],
  "abstract_text": [
    "<S> the optimized effective potential ( oep ) is the exact kohn - sham potential for explicitly orbital - dependent energy functionals , e.g. , the exact exchange energy . </S>",
    "<S> we give a proof for the oep equation which does not depend on the chain rule for functional derivatives and directly yields the equation in its simplest form : a certain first - order density shift must vanish . this condition explains why the highest - occupied orbital energies of hartree - fock and exact - exchange oep are so close . more importantly , we show that the exact oep can be constructed iteratively from the first - order shifts of the kohn - sham orbitals , and that these can be calculated easily . </S>",
    "<S> the exact exchange potential @xmath0 for spherical atoms and three - dimensional sodium clusters is calculated . </S>",
    "<S> its long - range asymptotic behavior is investigated , including the approach of @xmath0 to a non - vanishing constant in particular spatial directions . </S>",
    "<S> we calculate total and orbital energies and static electric dipole polarizabilities for the sodium clusters employing the exact exchange functional . </S>",
    "<S> exact oep results are compared to the krieger - li - iafrate ( kli ) and local density approximations . </S>"
  ]
}