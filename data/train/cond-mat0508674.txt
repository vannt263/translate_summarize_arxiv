{
  "article_text": [
    "the shift in critical temperature of the homogeneous bose gas has been the subject of numerous investigations over the past fifty years .",
    "as the density of this idealized system is constant , the shift due to the mean - field is zero , and the first order shift is due to long - wavelength critical fluctuations .",
    "the first estimates were due to lee and yang @xcite , who gave two different results for the dependence on the s - wave scattering length @xmath0 . in 1999",
    "_ et al.__@xcite determined that the result should be @xmath1 where @xmath2 is the particle number density , and @xmath3 is a constant of order unity .",
    "several authors have attempted to calculate this constant , and a wide range of results have been obtained , as summarised in fig .  1 of @xcite .",
    "however recent monte carlo calculations have apparently settled this matter , giving a combined result of @xmath4 @xcite . a useful summary and discussion of this topic is provided by andersen @xcite and holzmann",
    "_ et al_.  @xcite .",
    "previously we have performed numerical simulations of an equation known as the projected gross - pitaevskii equation ( pgpe ) , which can be used to represent the highly occupied modes of bose condensed gases at finite temperature @xcite .",
    "this equation is observed to evolve randomised initial conditions to equilibrium for which it is possible to measure a temperature @xcite .",
    "the pgpe is non - perturbative , and hence includes the effect of critical fluctuations .",
    "the only approximation made is that the modes of the gas are sufficiently highly occupied as to be well described by a classical rather than a quantum field .",
    "the occupation condition is that mode @xmath5 must satisfy @xmath6 ; however for practical simulations we may choose , for example , @xmath7 @xcite .",
    "this method is suitable for investigating many problems of current interest in ultra - cold bose gases , such as the shift in critical temperature due to non - perturbative effects @xcite .",
    "the pgpe describes a microcanonical system , with the classical field restricted to a finite number of modes for which the occupation number condition is met . in order to study the problem of the shift in @xmath8 it is necessary to accurately determine thermodynamic quantities defined as derivatives of the entropy such as the temperature and chemical potential . in 1997",
    "rugh developed a new approach to statistical mechanics where he derived an expression from the hamiltonian of a system for which the ensemble average gives the temperature within the microcanonical ensemble @xcite .",
    "however , if the system is known to be ergodic then the equilibrium temperature can be determined from the system dynamics over a sufficiently long period of time .",
    "we have applied an extension of rugh s method to the pgpe hamiltonian , and the appropriate expression to determine the temperature is given as eq .",
    "( 22 ) of @xcite .",
    "this method was found to agree with the less rigorous methods described in @xcite . in @xcite",
    "we made use of this method to calculate the shift in the critical temperature of the homogeneous bose gas . despite the calculation being performed with limited statistics and suffering from finite size effects",
    ", it gave a result of @xmath9 in agreement with the monte carlo results @xcite .",
    "in @xcite we applied this method to the experiment of gerbier _ et al .",
    "_ @xcite who measured the shift in critical temperature of a trapped bose gas , and found good agreement with experiment . in this paper",
    "we give the details of our implementation of rugh s method for a general mode basis for the pgpe .",
    "we consider a classical system with @xmath10 independent modes .",
    "the hamiltonian can be written as @xmath11 , where @xmath12 is a vector of length @xmath13 consisting of the canonical position and momentum co - ordinates .",
    "we define the gradient operator @xmath14 in terms of its components @xmath15 . in the notation of rugh @xcite",
    ", the hamiltonian @xmath16 may have a number of independent first integrals , labelled by @xmath17 that are invariant under the dynamics of @xmath16 .",
    "a particular macro - state of such a system can be specified by the values of the conserved quantities , labelled as @xmath18 .",
    "the usual expression for the temperature of a system in the microcanonical ensemble is given by @xmath19 where all other constants of motion are held fixed , and where the entropy can be written @xmath20 \\ ; \\prod_i \\delta[{i_i -   f_i(\\mathbf{\\gamma})}].\\ ] ] using rugh s methods , the temperature of the system can be written as @xmath21 where the angle brackets correspond to an ensemble average , and the components of the vector operator @xmath22 are @xmath23 where @xmath24 can be chosen to be any scalar value , including zero .",
    "the vector field @xmath25 can also be chosen freely within the constraints @xmath26 geometrically this means that the vector field @xmath25 has a non - zero component transverse to the @xmath27 energy surface , and is parallel to the surfaces @xmath28 .",
    "the expectation value in eq .",
    "( [ eqn : temp_eqn ] ) is over all possible states in the microcanonical ensemble ; however if the ergodic theorem is applicable then it can equally well be interpreted as a time - average . for further details on the origin of this expression",
    "we refer the reader to rugh s original papers @xcite , as well as derivations found in giardin and levi @xcite , jepps _",
    "et al._@xcite and rickayzen and powles @xcite .",
    "the classical hamiltonian for the dilute bose gas in dimensionless form is @xmath29 where @xmath30 , @xmath31 is the number of particles in the system , @xmath32 , @xmath33 is the unit of length , @xmath34 is the unit of energy , and @xmath35 is the mass of the particles .",
    "the dimensionless classical bose field operator @xmath36 is here normalized to one , @xmath37 , and @xmath38 is the nonlinear constant defined as @xmath39 where @xmath40 .",
    "@xmath41 is the single particle hamiltonian with eigenbasis @xmath42 , and @xmath43 is the dimensionless version of any potential _",
    "additional _ to that included in the single - particle hamiltonian .",
    "we restrict our field @xmath36 to be formed from the modes of the classical region @xmath44 defined by a high energy cutoff in the single - particle basis , such that we can write @xmath45 the equation of motion for this restricted system is the projected gross - pitaevskii equation @xmath46 the projection operator @xmath47 projects function @xmath48 onto the classical modes of the single particle hamiltonian @xmath41 via @xmath49 it eliminates collisional processes which would cause the scattering of particles into higher energy single particle modes not represented by the classical field .    in the single - particle basis of @xmath41",
    "the hamiltonian ( [ eqn : qh ] ) can be written @xmath50 where we have defined the matrix elements @xmath51 we make use of the real , canonically - conjugate coordinates @xmath52 and @xmath53 defined by @xmath54 with the inverse transformation @xmath55      in order to satisfy the conditions ( [ eqn : x_conditions ] ) we can choose a vector field of the form @xmath57 where the @xmath58 coefficients @xmath59 are determined by the @xmath58 simultaneous equations in eq .",
    "( [ eqn : x_conditions ] ) . due to the freedom in the choice of the vector operator",
    "@xmath22 we can set any number of components of the length @xmath13 vector @xmath25 to zero .",
    "this turns out to be useful as the components corresponding to the momentum and position variables can be different orders of magnitude .",
    "two particular choices we make use of later are @xmath60 with @xmath61 and @xmath62 with @xmath63 these lead to two different calculations for the temperature that only agree in general if the system is in thermal equilibrium .",
    "this provides a useful check that the numerical simulations have indeed reached thermal equilibrium , as well as giving two independent values for the temperature .    for the classical bose gas hamiltonian ( [ eqn : qh ] ) there can be several constants of motion that must be taken into account .",
    "these depend on the details of the single - particle hamiltonian @xmath41  examples include components of the angular and/or linear momentum .",
    "the effect of including these additional first integrals in the definition of the vector field @xmath25 is to account for the energy that is associated with a conserved quantity and hence is unavailable for thermalization .",
    "this ensures that only the appropriate free energy is used to calculate the temperature .",
    "we conjecture that the same result can be achieved by first transforming to a co - ordinate system where the total angular and linear momenta , etc , are all zero and therefore do not contribute to the energy of the system .",
    "rugh demonstrated this explicitly in @xcite for a system of particles with a conserved centre - of - mass motion , and our numerical results support this conjecture .    an exception to this , however , is the conservation of normalization @xmath64 .",
    "this must be considered explicitly because there is no co - ordinate system in which it can be made to vanish .",
    "the constraint on @xmath65 means that the ground state of the system will , in general , have a finite energy that is not accessible for thermalization .",
    "we note that the effect of this constraint is in general more complicated than a simple subtraction of the ground state energy ( which could be achieved by hand ) and depends on the definition of the operator @xmath22 used to calculate the temperature , as shown below .",
    "we need to choose a vector field @xmath25 which satisfies eqs .",
    "( [ eqn : x_conditions ] ) with @xmath66 .",
    "the result is @xmath67 where the parameter @xmath68 looks similar to a chemical potential . substituting eq .",
    "( [ eqn : xvec ] ) into eq .",
    "( [ eqn : temp_eqn ] ) we find that our full expression for the dimensionless temperature @xmath69 is    @xmath70 } { [ { |{\\mathbf{\\mathcal{d}}}h|^2 - \\lambda_n ( { \\mathbf{\\mathcal{d}}}h \\cdot { \\mathbf{\\mathcal{d}}}n)}]^2 } \\right\\rangle , \\label{eqn : t}\\end{aligned}\\ ] ]    where @xmath71    the chemical potential of the system can be determined in a similar manner using a different choice of vector field .",
    "in particular we wish to calculate @xmath72 where the conditions on the vector field are @xmath73 this results in expressions identical to the rhs of eqs .",
    "( [ eqn : xvec],[eqn : x_with_n],[eqn : t ] ) but with @xmath16 and @xmath65 interchanged , and so we will not write them out in full .",
    "the technique outlined above has been described previously by one of us in ref .",
    "@xcite , and in particular the result of eq .",
    "( [ eqn : t ] ) was given in that work .",
    "the numerical method has also been applied by the current authors in refs .",
    "the purpose of this paper is to outline in detail the procedure for calculating the terms in eqs .",
    "( [ eqn : t ] ) and ( [ eqn : dl ] ) .",
    "this is not a trivial exercise , and the proliferation of terms can make it difficult to avoid errors in both the analytical and numerical implementation . by discussing our approach to evaluating eqs .",
    "( [ eqn : t ] ) and ( [ eqn : dl ] ) we hope to facilitate other researchers wanting to make use of the method .",
    "the basic numerical requirement is an efficient and accurate numerical transform from real space to basis space and vice versa .",
    "this may be provided , for example , by fast fourier transforms using a basis of plane waves appropriate for a homogeneous system @xcite , or an efficient quadrature for trapped systems @xcite .",
    "in this section we give explicit analytic expressions for all quantities required in the evaluation of eq .",
    "( [ eqn : t ] ) and ( [ eqn : dl ] ) . as we are using the canonical co -",
    "ordinates defined in eq .  ( [ def : xp ] ) it is easiest to evaluate the derivatives of the hamiltonian using the mode expansion of the hamiltonian ( [ eqn : hbasis ] ) .",
    "however , this leaves us with expressions involving inner products of vector quantities with summations that would be computationally expensive to evaluate directly for any sizeable basis .",
    "we show how to define auxiliary field functions that can be used to simplify these terms for implementation with an efficient numerical transform .",
    "we begin by writing out the necessary derivatives of the hamiltonian using the two choices of vector operator defined earlier , @xmath74 and @xmath75 . in component form",
    "the first derivatives of the hamiltonian are @xmath76 + { c_{\\rm nl}}\\sqrt{\\frac { \\epsilon_i}{2 } } \\sum_{pqm } \\left [ c^*_p c^*_q c_m \\langle pq|mi\\rangle + c^*_m c_p c_q \\langle mi|pq\\rangle\\right ] , \\label{dqh1 } \\\\ ( { \\mathbf{\\mathcal{d}}}_p h)_i & = & p_i   + \\frac{i}{\\sqrt{2 \\epsilon_i}}\\sum_n \\left[v_{ni } c_n^ * - v_{in } c_n\\right ] + i \\frac { { c_{\\rm nl}}}{\\sqrt{2 \\epsilon_i } } \\sum_{pqm } \\left [ c^*_p c^*_q c_m \\langle pq|mi\\rangle - c^*_m c_p c_q \\langle mi|pq\\rangle\\right ] , \\label{dph1}\\end{aligned}\\ ] ] and",
    "the second derivatives are @xmath77 + \\frac{{c_{\\rm nl}}}{2 } \\sqrt{\\epsilon_i \\epsilon_j } \\sum_{pq } \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^ * \\langle pq|ij\\rangle \\right ] , \\label{dqh2 } \\\\ ( { \\mathbf{\\mathcal{d}}}_p^2 h)_{ij } & = & \\delta_{ij } +   \\frac{1}{2\\sqrt{\\epsilon_i \\epsilon_j}}[v_{ij } + v_{ji } ] + \\frac{{c_{\\rm nl}}}{2\\sqrt{\\epsilon_i \\epsilon_j } } \\sum_{pq } \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] .",
    "\\label{dph2}\\end{aligned}\\ ] ] we also need the derivatives of the other first integral of the hamiltonian  the the normalisation given by @xmath78 .",
    "these are @xmath79    from eq .",
    "( [ eqn : t ] ) we can see that we need the terms @xmath80 @xmath81 .",
    "\\label{eqn : list2}\\ ] ] some of these expressions are simple to calculate e.g. @xmath82 @xmath83 @xmath84 @xmath85 however , the remainder are more complicated . to calculate them efficiently we make the following vector definitions @xmath86 with the corresponding auxiliary field functions @xmath87 making use of these definitions we find @xmath88 + \\frac{{c_{\\rm nl}}}{2 } \\sqrt{\\epsilon_i \\epsilon_j } \\sum_{pq } \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^",
    "* \\langle pq|ij\\rangle \\right]\\right ) , \\nonumber\\\\ & = & 2 a_i \\epsilon_i^{3/2 } +   \\sqrt{\\epsilon_i}\\sum_j a_j[v_{ij } + v_{ji } ] + { c_{\\rm nl}}\\sqrt{\\epsilon_i } \\sum_{pqj}a_j \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^ * \\langle pq|ij\\rangle \\right ] , \\label{dqdqh2}\\end{aligned}\\ ] ] @xmath89 + \\frac{{c_{\\rm nl}}}{2\\sqrt{\\epsilon_i \\epsilon_j } } \\sum_{pq } \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] \\right),\\nonumber\\\\ & = & 2\\sqrt{\\epsilon_i}b_i + \\frac{1}{\\sqrt{\\epsilon_i } } \\sum_j b_j[v_{ij } + v_{ji } ] + \\frac{{c_{\\rm nl}}}{\\sqrt{\\epsilon_i } } \\sum_{pqj}b_j \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] , \\label{dpdph2}\\end{aligned}\\ ] ] and @xmath90 + \\frac{{c_{\\rm nl}}}{2 } \\sqrt{\\epsilon_i \\epsilon_j } \\sum_{pq } \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^ * \\langle pq|ij\\rangle \\right ] \\right),\\nonumber\\\\ & = &   f_i \\epsilon_i^{3/2 } +   \\frac{\\sqrt{\\epsilon_i}}{2}\\sum_j f_j[v_{ij } + v_{ji } ] + \\frac{{c_{\\rm nl}}}{2 } \\sqrt{\\epsilon_i } \\sum_{pqj}f_j \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^ * \\langle pq|ij\\rangle \\right ] , \\label{dqnd2qh}\\end{aligned}\\ ] ]    @xmath91 + \\frac{{c_{\\rm nl}}}{2\\sqrt{\\epsilon_i \\epsilon_j } } \\sum_{pq } \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] \\right),\\nonumber\\\\ & = & \\sqrt{\\epsilon_i}g_i + \\frac{1 } { 2 \\sqrt{\\epsilon_i } } \\sum_j g_j[v_{ij } + v_{ji } ] + \\frac{{c_{\\rm nl}}}{2\\sqrt{\\epsilon_i } } \\sum_{pqj}g_j \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] .",
    "\\label{dpnd2ph}\\end{aligned}\\ ] ]      the above expressions are written in a form that they can be easily calculated using efficient quadratures in real space .",
    "we outline in detail how to calculate all of these terms , and write them in the most efficient form we have found .",
    "we make the definitions @xmath92 where we have assumed that the potential @xmath43 is real .",
    "we can therefore write the appropriate parts of eqs .",
    "( [ dqh1 ] ) and ( [ dph1 ] ) as @xmath93 & = & 2 \\mbox{re}(w_i),\\\\ \\sum_n \\left[v_{ni } c_n^ * - v_{in } c_n\\right ] & = & -2 i \\mbox{im}(w_i).\\end{aligned}\\ ] ] the next set of terms are @xmath94 hence , parts of eqs .",
    "( [ dqh1 ] ) and ( [ dph1 ] ) can be written @xmath95 & = & 2 \\mbox{re}(k_i),\\\\ \\sum_{pqm } \\left [ c^*_p c^*_q c_m \\langle pq|mi\\rangle - c^*_m c_p c_q \\langle mi|pq\\rangle\\right ] & = & -2i \\mbox{im}(k_i).\\end{aligned}\\ ] ] for the terms involving the auxiliary fields we have expressions like @xmath96 where we have made use of the fact that @xmath97 .",
    "we have similar expression for all the other auxiliary vector fields @xmath98 , and @xmath99 and will refrain from writing these all out .",
    "we can write parts of eqs .",
    "( [ dqdqh2 ] ) , ( [ dpdph2 ] ) , ( [ dqnd2qh ] ) and ( [ dpnd2ph ] ) as @xmath100 & = & 4(a_1)_i + 2\\mbox{re}(a_2)_i,\\\\ \\sum_{pqj}b_j \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q \\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] & = & 4(b_1)_i - 2 \\mbox{re}(b_2)_i,\\\\ \\sum_{pqj}f_j \\left [ 4 c^*_p c_q \\langle pi|qj\\rangle + c_p c_q \\langle ij|pq\\rangle    + c_p^ * c_q^ * \\langle pq|ij\\rangle \\right ] & = & 4(f_1)_i + 2 \\mbox{re}(f_2)_i,\\\\ \\sum_{pqj}g_j \\left [ 4c^*_p c_q   \\langle pi|qj\\rangle - c_p c_q",
    "\\langle ij |pq\\rangle - c_p^ * c_q^ * \\langle pq|ij\\rangle\\right ] & = & 4(g_1)_i - 2 \\mbox{re}(g_2)_i,\\end{aligned}\\ ] ] @xmath101 & = & 2\\mbox{re}(a_3)_i,\\qquad \\sum_j b_j[v_{ij } + v_{ji } ] \\ , = \\ , 2   \\mbox{re}(b_3)_i,\\\\ \\sum_j f_j[v_{ij } + v_{ji } ] & = & 2\\mbox{re}(f_3)_i,\\qquad \\sum_j g_j[v_{ij } + v_{ji } ] \\ , = \\ , 2   \\mbox{re}(g_3)_i.\\end{aligned}\\ ] ] the remaining terms are diagonal second derivatives of the form @xmath102 , in which we have matrix elements @xmath103 and thus the appropriate parts of eqs .",
    "( [ dqh2 ] ) and ( [ dph2 ] ) are @xmath104 & = & 4(m_1)_i + 2\\mbox{re}(m_2)_i,\\\\ \\sum_{pq } \\left [ 4 c^*_p c_q \\langle pi|qi\\rangle - c_p c_q \\langle ii|pq\\rangle    - c_p^ * c_q^ * \\langle pq|ii\\rangle \\right ] & = & 4(m_1)_i - 2   \\mbox{re}(m_2)_i.\\end{aligned}\\ ] ] we have now explicitly outlined the calculation of all terms necessary to calculate the temperature and chemical potential of the equilibrium dynamical evolution of a microcanonical pgpe system",
    ".      here we summarise all the components of the vector quantities required for the evaluation of the temperature according to eq .",
    "( [ eqn : t ] ) making use of the definitions made in the previous section for both choices of vector operator @xmath74 and @xmath75 .",
    "the inner products between these vectors found in eq .",
    "( [ eqn : t ] ) can be easily evaluated numerically .",
    "in addition , these are all the terms required for calculating the chemical potential as well .",
    "@xmath105 @xmath106,\\\\ ( { \\mathbf{\\mathcal{d}}}_p^2 h)_{ii } & = & 1 +   \\frac{v_{ii}}{\\epsilon_i } + \\frac{{c_{\\rm nl}}}{\\epsilon_i } [ 2(m_1)_i -   \\mbox{re}(m_2)_i].\\end{aligned}\\ ] ]    @xmath107    @xmath108,\\\\ { \\mathbf{\\mathcal{d}}}_p ( |{\\mathbf{\\mathcal{d}}}_p h|^2)_i & = &   2\\sqrt{\\epsilon_i}b_i + \\frac{2}{\\sqrt{\\epsilon_i } }   \\mbox{re}(b_3)_i + \\frac{{c_{\\rm nl}}}{\\sqrt{\\epsilon_i } } [ 4(b_1)_i - 2 \\mbox{re}(b_2)_i],\\end{aligned}\\ ] ]    @xmath109 ,",
    "\\\\ \\sum_j ( { \\mathbf{\\mathcal{d}}}_p n)_j ( { \\mathbf{\\mathcal{d}}}_p^2 h)_{ij } & = & \\sqrt{\\epsilon_i}g_i + \\frac{1 } { \\sqrt{\\epsilon_i } } \\mbox{re}(g_3)_i + \\frac{{c_{\\rm nl}}}{\\sqrt{\\epsilon_i } } [ 2(g_1)_i -   \\mbox{re}(g_2)_i ] . \\label{eqn : last }   \\end{aligned}\\ ] ]",
    "in this section we outline the algorithm for applying the formulae of the previous section to simulation results , and give examples of the results obtained for the pgpe for trapped bose gas systems .",
    "we have previously demonstrated in @xcite that the pgpe will evolve any randomised initial field function to an equilibrium that can be characterised by a temperature , and have made use of this in the beyond mean - field calculation of the critical temperature of a trapped bose gas in @xcite .    the basic requirement to determine the temperature in such calculations is to evaluate eq .",
    "( [ eqn : t ] ) over a sufficiently long period of simulation time for the ergodic averaging to be effective .",
    "our procedure is as follows .",
    "beginning with an initial random field configuration with a predetermined energy , we run our simulation for sufficiently long such that we can be reasonably sure that equilibrium has been reached ( this can be checked as described below ) .",
    "this is typically for one hundred or more trap periods for simulations of bose gases in a harmonic potential .",
    "we usually save one thousand or more field configurations at equally spaced times throughout the evolution , which are sufficiently separated in time that there is little correlation between samples .",
    "the temperature analysis is performed after the simulation is completed .",
    "the field configurations are stored as vectors of basis coefficients , and we make use of efficient computational routines that avoid numerical aliasing to transform to and from a real space representation . for each saved field configuration",
    "we calculate the vector components @xmath110 and @xmath111 , the derivatives in eqs .",
    "( [ eqn : list1][eqn : list2 ] ) , the auxillary fields given by eqs .",
    "( [ eqn : aux1],[eqn : aux2 ] ) , and then their overlaps with the various functions of the field @xmath36 as in eqs .",
    "( [ eqn : a1][eqn : a5 ] ) .",
    "this allows us to calculate the vector quantities defined in eqs.([eqn : first][eqn : last ] ) that appear in eq .",
    "( [ eqn : t ] ) .",
    "we then form the appropriate dot products of these quantities to give a single sample of @xmath112 and @xmath113 .",
    "these values are calculated for every saved field configuration .",
    "these can then be plotted versus time , and any initial transients before the field has settled into equilibrium can be identified ( typically this a very small fraction of the total simulation time . ) the quantities @xmath112 and @xmath114 are numerically distinct from one another before equilibrium is reached , however they can be quite noisy and so sometimes it is difficult to tell when they are in agreement .",
    "we exclude the transients from the final averaging to determine the temperature  typically we discard at least the first quarter of the time evolution to ensure accuracy .",
    "we now illustrate with a set of typical numerical results from applying the method described in this paper to the pgpe for trapped bose gas systems .",
    "we solve the pgpe ( [ eq : gpe1 ] ) for a harmonic trapping potential @xmath115 and no additional potential @xmath43 .",
    "the unit of length is @xmath116 and energy @xmath117 .",
    "we have a dimensionless energy cutoff of @xmath118 such that there are 1739 classical modes , and the data shown is for @xmath119 .",
    "we begin individual simulations with a randomised initial condition with fixed energy , and evolve in dimensionless time for until @xmath120 , which is slightly more than 190 radial trap periods .",
    "we find that these simulations equilibrate very quickly , and use 1000 field samples over the last two - thirds of the evolution for the ergodic averaging .",
    "the results are shown in fig .",
    "[ fig1 ] , some of which have previously been reported in ref .",
    "@xcite .     on the rhs of eq .",
    "( [ eqn : temp_eqn ] ) for the simulations with @xmath121 and @xmath122 .",
    "the bars are for the operator @xmath74 , and the dots connected by solid lines for @xmath75 .",
    "( c ) temperature versus energy .",
    "plusses : @xmath123 , crosses : @xmath124 .",
    "( d ) chemical potential versus energy .",
    "plusses : @xmath125 , crosses : @xmath126 .",
    "all quantities are in dimensionless units as defined in the text .",
    ", width=453 ]    figure  [ fig1](a ) shows the condensate fraction versus energy for the pgpe system ( we remind the reader that energy given by eq .",
    "( [ eqn : hbasis ] ) is a conserved quantity in these calculations ) .",
    "the condensate fraction is determined by the penrose - onsager criterion : it is the largest eigenvalue found by diagonalizing the single - particle density matrix formed by ergodic averaging as described in @xcite .",
    "it looks somewhat different to the result for the full three - dimensional system due to the basis cutoff that is present in these simulations .",
    "figure  [ fig1](b ) shows the distribution of the function @xmath127 for two different simulations , using the formulae for both @xmath74 and @xmath75 .",
    "the temperature is found by the inverse of the mean value of these distributions , and is shown for all simulations in fig .  [ fig1](c ) .",
    "we can see that the results of both calculations agree very well , and so we can be confident that firstly the simulations have reached equilibrium , and secondly that the numerical implementation of these calculations are free from errors .",
    "figure  [ fig1](d ) shows the similar calculation for the chemical potential .",
    "one interesting point is that the width of the distributions in fig .",
    "[ fig1](b ) calculated using the operator @xmath75 are slightly narrower than those for @xmath74 . while this is of no consequence conceptually , in practice the narrower the distribution the fewer samples are required for an estimate of the mean to a required accuracy . given the large amount of freedom in the choice of the operator @xmath22 , it seems quite possible that for particular problems that some choices will be better than others .",
    "we have found situations where one of these distributions is signficantly narrower than the other .",
    "this has also been pointed out by rugh @xcite . however , with no a priori way to estimate the width of the distributions , finding the most accurate method of determing the temperature is a matter of trial and error .",
    "to investigate the effect of critical fluctuations in bose gases using the pgpe in the microcanonical ensemble it is necessary to have accurate methods of determining the thermodynamic temperature and chemical potential . in this paper",
    "we have explicitly outlined a method of how to do so using the assumption of ergodicity and the dynamical evolution of the pgpe .",
    "the method could potentially be applied to other nonlinear classical field hamiltonians ."
  ],
  "abstract_text": [
    "<S> the ergodic hypothesis asserts that a classical mechanical system will in time visit every available configuration in phase space . </S>",
    "<S> thus , for an ergodic system , an ensemble average of a thermodynamic quantity can equally well be calculated by a time average over a sufficiently long period of dynamical evolution . in this paper </S>",
    "<S> we describe in detail how to calculate the temperature and chemical potential from the dynamics of a microcanonical classical field , using the particular example of the classical modes of a bose - condensed gas . </S>",
    "<S> the accurate determination of these thermodynamics quantities is essential in measuring the shift of the critical temperature of a bose gas due to non - perturbative many - body effects . </S>"
  ]
}