{
  "article_text": [
    "this paper considers joint estimation of multiple directed acyclic graph ( dag ) models using integer linear programming ( ilp ) .",
    "graphical models are multivariate models in which vertices in a graph @xmath0 represent random variables with edges between the vertices describing conditional independence statements concerning the variables . in many settings",
    "the edge structure of the graph is itself uncertain and then an important challenge is to estimate this structure from data .",
    "there has been considerable research into structural inference for graphical models over the last decade , including bayesian networks ( bns ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , gaussian graphical models ( ggms ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and discrete graphical models @xcite . many graphical models are based on dags and these are the focus of this paper .    in many applications ,",
    "data @xmath1 are collected on multiple units @xmath2 that may differ with respect to conditional independence structure , such that corresponding dags @xmath3 may be non - identical . at the same time , when the units of study are related , the graphs @xmath3 , while potentially non - identical , are expected to have similarities .",
    "it is then natural to ask whether such similarity can be exploited by borrowing strength across the estimation problems indexed by @xmath4 and that is the aim of the present paper .",
    "specifically we seek to construct a _ joint _",
    "estimator @xmath5 that estimates a collection of dags together .",
    "we contrast such an estimator with the _ independent _ estimator @xmath6 that estimates each dag from the associated data only .",
    "the best known class of dag models are bns , but more exotic dag models exist ( e.g. * ? ? ?",
    "bns admit an extensive theory of inferred causation that has contributed to their popularity @xcite .",
    "structure learning for individual bns is a well - studied problem , with contributions including @xcite .",
    "structure learning is np - hard , but an approach that has attracted much recent attention is to cast _ maximum a posteriori _ ( map ) dag estimation as a problem in integer linear programming ( ilp ) , as developed simultaneously by @xcite and subsequently extended in @xcite . in brief , this approach solves a sequence of linear relaxations of the map estimation problem via the introduction of cutting planes and combines this with a branch - and - bound search to produce an optimal solution .",
    "if the algorithm terminates , the result is guaranteed to be a global maximum of the posterior distribution and hence inherits theoretical guarantees associated with the map estimator ( see e.g. * ? ? ?",
    "( in this paper , algorithms with this property are termed `` exact '' . )",
    "coupled with powerful techniques from discrete optimisation @xcite , ilps represent an efficient and attractive methodology for structural inference , as demonstrated also by recent empirical results ( e.g. * ? ? ?",
    "recent advances in this area are discussed in @xcite .",
    "the joint estimation of graphical models has recently received attention , for example @xcite put forward a penalised likelihood formulation that couples together estimation for multiple ( undirected ) ggms .",
    "however , joint estimation of multiple dags has so far received relatively little attention .",
    "the first discussion of this problem that we are aware of is @xcite ; here a greedy search was used to locate a local maximum of a joint bayesian posterior .",
    "@xcite described a markov chain monte carlo ( mcmc ) method for sampling from a joint posterior over graphical structures .",
    "however , the generic difficulties associated with stochastic search / sampling in large discrete spaces are well known ; these are exacerbated in the joint case by the size of the joint model space and stochastic search / sampling remains challenging in this setting .",
    "the focus of this paper is instead on exact , deterministic algorithms .",
    "@xcite proposed an exact algorithm based on bayesian model averaging and belief propagation , under the strong assumption that an ordering of the variables @xmath7 applies simultaneously to all units . at the same time @xcite proposed essentially the same algorithm , applied to the specific class of feed - forward dynamic bns , where an ordering of the variables is implicitly provided by the time index .",
    "the algorithmic contributions of the present paper are two - fold .",
    "first , we show how to cast exact inference over multiple dags as an ilp problem .",
    "we consider map - bayesian estimation for multiple dags and require no restriction on the ordering of the variables .",
    "this is done by extending methodology presented in @xcite to the case of multiple dags via a hierarchical bayesian formulation .",
    "second , we exploit structural constraints that are imposed by the dags in order to improve computational efficiency . as a illustrative example",
    ", our methods currently allow estimation of 10 related dags , each with 10 nodes , in time typically less than one minute on a standard laptop .",
    "in addition , we extend previous work by allowing for dependencies between the dags themselves and consider also estimation of this dependency structure . previous work on multiple dags has focused on the special case where the units are exchangeable and all pairs of units undergo an equal amount of regularisation ( including * ? ? ? * ; * ? ? ? * ) .",
    "however , in practice , relationships between units ( and their underlying graphical models ) may be complex , e.g. hierarchical , with group and sub - group structure , and such structure may itself be subject to uncertainty .",
    "@xcite performed exact inference for non - exchangeable feed - forward dynamic bns for the case where the relationships between units are known _",
    "a priori_. @xcite addressed non - exchangeability in the context of general dag models but did not provide an exact algorithm and , again , assumed that the relationships between units are known at the outset .",
    "our approach provides a framework that allows for simultaneous learning of both unit - specific dags and the dependency structure that relates them . however , our empirical results suggest that such simultaneous learning may be extremely challenging in practice .",
    "the remainder of the paper is organised as follows : section [ def the model ] introduces a statistical framework for multiple dags and discusses regularisation based on graphical structure .",
    "section [ sec estimate ] gives exact , ilp - based estimators for multiple dags .",
    "section [ applications ] presents a simulation study and results on fmri data from a multi - subject study .",
    "finally we close with a discussion of directions for further research . a companion paper that explores",
    "the fmri application in more detail is available as @xcite .",
    "we begin by introducing the statistical model , deferring discussion of computation to the next section . throughout the shorthand @xmath8",
    "will be used to denote the list of integers @xmath9 .",
    "a ( directed ) graph @xmath0 on vertices @xmath8 is characterised by a collection of sets @xmath10 , such that @xmath11 contains precisely the parents of vertex @xmath12 according to @xmath0 .",
    "we say @xmath0 is acyclic if @xmath0 contains no sequence of directed edges that begins and ends at the same vertex .",
    "write @xmath13 for the space of all directed acyclic graphs ( dags ) with @xmath14 vertices . in this",
    "paper vertices @xmath12 in a dag @xmath0 will be associated with random variables @xmath15 .",
    "we will use @xmath16 to denote the @xmath17th observation of variable @xmath15 for unit @xmath4 and @xmath18 to denote the collection @xmath19 of these variables .",
    "we present our approach from a map - bayesian perspective , but it could also be described as a penalised likelihood approach .",
    "we consider dag models for which the conditional distribution of the variables @xmath20 , given the dag @xmath3 and associated parameters @xmath21 , factorises as @xmath22 here @xmath23 denotes the parents of the @xmath12th variable in the dag @xmath3 and @xmath24 are the observed values of these parent variables in sample @xmath17 . additionally , @xmath25 are parameters associated with the conditional distribution for the @xmath12th variable that may depend on sample index @xmath17 , unit @xmath4 and model @xmath23 , though this latter dependence is suppressed in the notation .",
    "the joint likelihood that we consider below follows from eqn .",
    "[ factor ex ] and the assumption that the observations @xmath26 for each unit @xmath4 are conditionally independent given the dags @xmath3 and associated parameters @xmath27 . specifically , we have that the full likelihood factorises over units , variables and samples : @xmath28 for expositional simplicity , we take the number @xmath29 of samples to be the same for each unit , though this is not strictly required for our methodology . within a bayesian framework we place a prior distribution @xmath30 over parameters @xmath31 , such that parameter sets corresponding to units @xmath4 and @xmath32 are independent conditional upon the two dags @xmath3 and @xmath33 . integrating out the unknown parameters provides the evidence in favour of the joint model @xmath34 : @xmath35    below we introduce our prior distribution over all dags @xmath34 that encodes the notion of dependency that we wish to exploit during estimation .",
    "write @xmath36 for the space of undirected networks on vertices @xmath37 .",
    "the hierarchical prior that we propose factorises along edges of a network @xmath38 whose @xmath39 vertices correspond to the individual units : @xmath40 here the first product ranges over all edges @xmath41 in the network @xmath42 .",
    "the ( positive , symmetric ) function @xmath43 is interpreted as a measure of regularity ( i.e. similarity ) between the dags @xmath3 and @xmath33 ; specific choices for this function are discussed in section [ choose q ] below , motivated by computational convenience in the sequel .",
    "the graph @xmath42 indicates which pairs of units have similar graphical structure ( fig .",
    "[ model ] ) .",
    "for example , @xmath42 may describe a time - ordering of the units , such that consecutive units are expected to have more similar graphical structures , or may indicate group membership within a mixture model . in most existing literature",
    "an exchangeability assumption is placed on @xmath44 that corresponds ( implicitly ) to specifying @xmath42 as the complete network ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* etc . ) , though @xcite considered general ( known ) forms for @xmath42 . in this paper we allow for general and potentially unknown @xmath38 .",
    "the remaining terms @xmath45 are necessary for multiplicity correction and are discussed in section [ multi correct ] below , again motivated by computational convenience in the sequel .",
    "consider the map estimator under the multiple dag prior : @xmath46 when @xmath42 is the complete network all pairs of graphs are regularised equally and we refer to this case as `` exchangeable learning '' .",
    "more generally , we consider the setting where @xmath42 itself is unknown . then , we impose a prior distribution over @xmath38 ( described below in section [ a prior ] ) and estimate both the @xmath3 s and @xmath42 ; we refer to this as `` non - exchangeable learning '' and use the map estimator @xmath47 one of the main contributions of this paper , in section [ sec estimate ] , is to prove that for certain choices of the regularity function @xmath43 discussed below , both @xmath48 and @xmath49 are characterised as the solutions to ilps and hence are amenable to exact computation using advanced techniques such as constraint propagation and cutting plane algorithms .",
    "below we discuss choices for the regularity function @xmath43 that forms the basis for the multiple dag prior and captures similarity between dags @xmath3 and @xmath33 .",
    "write @xmath50 for equality up to an unspecified additive constant .",
    "the default choice that we consider for @xmath51 is @xmath52 .",
    "\\label{hm}\\end{aligned}\\ ] ] here @xmath53 is the logical xor operator , @xmath54 \\in \\{0,1\\}$ ] is an indicator associated with its ( logical ) argument and the @xmath55 are ( constant ) penalty terms associated with the inclusion of the edge @xmath56 in exactly one of the dags @xmath3 and @xmath33 .",
    "combined with the default multiplicity correction discussed below , the prior defined by eqn .",
    "[ hm ] is hyper - markov with respect to any dag @xmath3 when @xmath33 is held fixed @xcite ; we will see in section [ sec estimate ] that such priors permit a particularly simple construction of an ilp for the multiple dag model . for many scientific applications where graph structure represents a physical mechanism , eqn .",
    "[ hm ] can often be motivated from physical considerations .",
    "for example in neuroscience , an edge in a graphical model may have the interpretation of physical or functional connectivity and transfer of information between regions of the brain ( so - called  reification  ; e.g. * ? ? ?",
    "a special case , that treats both units and edges as exchangeable , is the structural hamming distance ( shd ) obtained by setting @xmath57 @xmath58 in eqn . [ hm ] .",
    "shd has previously been used to regularise between graphical models by @xcite and to integrate prior knowledge into bns by @xcite .",
    "an extension of shd with two degrees of freedom was also considered in this context by @xcite .",
    "the empirical results presented in this paper focus on shd due to its interpretability and simplicity , but the methodology is compatible with the general form eqn .",
    "[ hm ] and the @xmath55 s could be used to encode prior information on the similarity between units or the propensity for the presence of a particular edge to be conserved between units .      the function @xmath59 in the multiple dag prior ( eqn .",
    "[ joint prior ] ) is required to adjust for the fact that the size of the space @xmath13 grows super - exponentially with the number @xmath14 of vertices @xcite .",
    "we follow @xcite and control multiplicity using the default binomial correction @xmath60.\\end{aligned}\\ ] ] here @xmath61 is an upper bound on the ( maximum ) in - degree of @xmath0 ( such upper bounds are widely used to control the computational intensity of structural inference ) .",
    "this specification has the desirable property that the collective prior probability of all models with @xmath62 predictors is @xmath63 , which is independent of both @xmath62 and @xmath14 .",
    "we note that the methods presented in this paper are compatible with the inclusion of additional terms in eqn .",
    "[ joint prior ] that encode specific informative priors on the dags @xmath3 but we do not use such priors here .      we use the following prior for the undirected graph @xmath42 that encodes pairwise relationships between the units @xmath64 : @xmath65.\\end{aligned}\\ ] ] ( we adopt the convention that the adjacency matrix for @xmath42 is upper triangular , hence @xmath66 above . ) here the @xmath67 s encourage inclusion of the corresponding edges @xmath41 in @xmath42 and could in principle be used to encode specific knowledge regarding similarity between the units , although we do not pursue this direction here . in all empirical results below",
    "we consider the simplest case of @xmath68 .",
    "then , @xmath69 can be viewed as an inverse temperature hyper - parameter , with larger values of @xmath69 encouraging denser networks , which in turn correspond to a greater amount of between - unit regularisation .",
    "all joint estimators for graphical models that we are aware of require tuning parameters ( e.g. the  fused  and  group  flavours of the joint graphical lasso each have two tuning parameters ; * ? ? ?",
    "recalling that the dags @xmath44 give a probability model for the observations @xmath70 , hyper - parameters in the priors above may be set using standard procedures such as cross - validation or information criteria .",
    "let @xmath71 denote all hyper - parameters to be set .",
    "we recommend the use of information criteria for their computational convenience .",
    "in particular , using the akaike information criteria ( aic ) we have @xmath72 where @xmath73 are the number of parameters required to specify the conditional distribution of @xmath74 given @xmath75 .",
    "thus the aic requires only that we can obtain the map estimate @xmath76 over a range of values of the hyper - parameters @xmath71 , selecting the value that maximises eqn .",
    "in contrast , cross - validation requires the marginal predictive likelihood function @xmath77 for held - out data @xmath78 , which for many models may require nontrivial additional computation .",
    "we note that a grid search is necessary in the case of multiple tuning parameters ; sequential optimisation is not possible due to the non - orthogonality induced by the joint prior @xmath79 . for more complex joint priors / penalties this represents a challenge that we do not address here .",
    "we now consider the computational aspects of map estimation for the models introduced above .",
    "we begin with the simpler case where the network @xmath42 is known _ a priori _ and subsequently consider the more general unknown @xmath42 case .",
    "the methodology we present below extends the ilp formulation of @xcite to multiple units via the inclusion of additional state variables that capture the similarities and differences between the units .",
    "we begin by computing and caching the terms @xmath80 that summarise evidence in the data for the local model @xmath23 for the @xmath12th variable in unit @xmath4 .",
    "these are available in closed form for many models of interest , including but not limited to discrete bns with dirichlet priors @xcite , linear gaussian structural equation models with conjugate priors @xcite and multiregression dynamical models @xcite .",
    "since our approach is based upon these pre - computed quantities , they could even be obtained numerically ( for more complex models ) using mcmc and related techniques ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "these cached quantities are transformed to obtain `` local scores '' , defined as @xmath81 these are the ( log- ) evidence from eqn .",
    "[ evidence ] with an additional penalty term that provides multiplicity correction over varying @xmath82 .",
    "we define binary indicator variables @xmath83 $ ] that form the basis of our ilp . here",
    "@xmath84 is used to denote a possible parent set for the @xmath12th variable in the dag @xmath3 , so the information in the variables @xmath83 $ ] completely characterises @xmath3 .",
    "it will be necessary to impose constraints that ensure these variables correspond to a well - defined dag : @xmath85 = 1   \\ ; \\ ; \\ ; \\ ; \\ ;   \\forall i , k\\tag{c1 ; convexity}\\ ] ] constraint ( c1 ) requires that for each unit @xmath4 , every vertex @xmath12 has exactly one parent set ( i.e. there is a well - defined graph @xmath3 ) . to ensure @xmath3 is acyclic we require further constraints : @xmath86 \\geq 1 \\ ; \\ ; \\ ; \\ ; \\ ;   \\forall k , \\emptyset \\neq c \\subseteq",
    "\\{1 : p\\}. \\tag{c2 ; acyclicity}\\ ] ] ( c2 ) states that for every non - empty set @xmath87 there must be at least one vertex in @xmath87 that does not have a parent in @xmath87 .",
    "it is not challenging to prove ( by contradiction ) that ( c1 - 2 ) exactly characterise the space @xmath13 of dags .",
    "next we define an indicator @xmath88 $ ] of the presence of each specific edge @xmath56 in @xmath3 .",
    "this can be related to the parent set indicators as @xmath89 = \\sum_{\\substack{\\pi \\subseteq \\{1:p\\}\\setminus\\{i\\ } \\\\ j \\in \\pi } } [ g_i^{(k ) } = \\pi ] \\ ; \\ ; \\ ; \\ ; \\ ;   \\forall i , j , k \\tag{c3 } .\\ ] ] to decide whether units @xmath90 agree on the presence or absence of a specific edge @xmath56 , we introduce additional variables @xmath91 $ ] where @xmath53 is the logical xor operator .",
    "to encode this definition we use the set of linear inequalities @xmath92 & & -[j \\in g_i^{(k ) } ] & & \\leq & & 0 \\label{xor1 } \\tag{c4.1 } \\\\ - \\delta^{(k , l)}(j , i ) & & + [ j \\in g_i^{(k ) } ] & & -[j \\in g_i^{(k ) } ] & & \\leq & & 0 \\tag{c4.2 } \\\\ - \\delta^{(k , l)}(j , i ) & & -[j \\in g_i^{(k ) } ] & & + [ j \\in g_i^{(k ) } ] & & \\leq & & 0 \\tag{c4.3 } \\\\",
    "+ \\delta^{(k , l)}(j , i ) & & + [ j \\in g_i^{(k ) } ] & & + [ j \\in g_i^{(k ) } ] & & \\leq & & 2 \\tag{c4.4}\\end{aligned}\\ ] ] these inequalities are optimal in the sense that they define ( in the most concise way ) the convex hull ( in @xmath93 ) of feasible solutions to the corresponding 3-variable xor constraint @xcite .",
    "write @xmath94 for a vector containing the binary variables @xmath95 $ ] , @xmath88 $ ] and @xmath96 , so that @xmath97 where @xmath98 .",
    "we can now state our first result :    [ fixed n ] the map estimate @xmath48 is characterised as the solution of the ilp @xmath99 -   \\sum_{(k , l ) \\in a } \\sum_{i = 1}^p \\sum_{j=1}^p \\lambda_{j , i}^{(k , l ) } \\delta^{(k , l)}(j , i )   \\label{ip}\\end{aligned}\\ ] ] subject to constraints ( c1 - 4 ) .    note that under an in - degree restriction @xmath100 the dimensionality of the state space @xmath101 can be reduced from exponential in @xmath14 to polynomial in @xmath14 , specifically @xmath102 .",
    "it is seen that the dimensionality of @xmath101 increases by a factor @xmath103 when learning @xmath39 dags jointly , as opposed to individually ( assuming that the first term dominates ) .    to illustrate the use of result [ fixed n ] , consider a fixed network @xmath42 that is equal to the complete network ( exchangeable learning ) and regularisation based on shd with hyper - parameter @xmath104 .",
    "[ example ] displays the map @xmath48 computed ( exactly ) as a function of the regularity hyper - parameter @xmath104 for a small fmri dataset of 3 subjects containing measurements of activity in 4 neural regions .",
    "the first row , with @xmath105 , is the result of performing independent estimation on the 3 subjects to obtain map estimators for subject - specific dags .",
    "notice that the dags are quite dissimilar ; the neuroscience context from which these data arise suggests that this is most likely an artefact ( i.e. due to variance in estimation ) . as the regularity parameter @xmath104",
    "is increased , the subject - specific dags become more similar until they are eventually identical at @xmath106 and above . in simulation studies below we demonstrate that this kind of exchangeable learning can lead to improved estimation of unit - specific graphical structure .      the previous section addressed the case where the interdependency structure @xmath42 among the units was known .",
    "below we formulate an ilp for the more general case where @xmath42 is unknown and must be estimated jointly with the unit - specific dags .",
    "we introduce additional binary indicator variables @xmath107 $ ] that directly encode those edges that are present in the network @xmath42 .",
    "taking together the variables @xmath96 and @xmath107 $ ] allows us to determine whether or not an edge @xmath56 differs between an unit @xmath4 and its neighbour @xmath32 in @xmath42 .",
    "specifically , we represent this information by defining a new binary variable @xmath108 $ ] where @xmath109 is the logical and operator . to encode this definition in an ilp we use the following set of linear inequalities @xmath110 & &   & & \\leq & & 0 \\tag{c5.1 } \\\\",
    "+ \\delta^{(k , l)}(j , i ) & &   & & -\\delta^{(k , l)}(j , i ) & & \\leq & & 0 \\tag{c5.2 } \\\\ - \\delta^{(k , l)}(j , i ) & & + [ ( k , l ) \\in a ] & & + \\delta^{(k , l)}(j , i ) & & \\leq & & 1\\tag{c5.3}.\\end{aligned}\\ ] ] the linear inequalities are again optimal , in the sense that they define ( in the most concise way ) the convex hull ( in @xmath93 ) of feasible solutions @xcite . in this case",
    "we write @xmath94 for a binary vector that additionally contains the variables @xmath111 $ ] and @xmath112 , so that @xmath97 with @xmath113 larger than in the exchangeable setting , but with the same asymptotic scaling .",
    "we can now state our second result :    [ nonex theo ] the map estimate @xmath49 is characterised as the solution of the ilp @xmath114 \\label{ip2 }   \\\\ & & - \\sum_{i=1}^p \\sum_{j=1}^p \\sum_{k=1}^k \\sum_{l = k+1}^k   \\lambda_{j , i}^{(k , l ) } \\delta^{(k , l)}(j , i ) + \\sum_{k = 1}^k \\sum_{l = k+1}^k \\eta^{(k , l ) } [ ( k , l ) \\in a ] \\nonumber\\end{aligned}\\ ] ] subject to constraints ( c1 - 5 ) .",
    "the dimensionality of @xmath101 can again be reduced from exponential in @xmath14 to polynomial in @xmath14 through the adoption of an in - degree restriction .",
    "our computational implementation is built on the c package gobnilp that performs inference for individual dags @xcite , available at http://www.cs.york.ac.uk / aig / sw / gobnilp/. gobnilp , originally described in @xcite , computes the map estimate on a per - unit basis ; we therefore created an interface that interacts with gobnilp and enforces additional constraints ( c3 - 5 ) that couple together multiple dags as described above .",
    "below we elaborate on how such an interface was constructed and summarise additional optimisation routines that underpin associated computational efficiency in the joint setting .",
    "since there are exponentially many acyclicity constraints ( c2 ) , gobnilp does _ not _ construct an integer program ( ip ) containing all of them .",
    "instead , initially , only the convexity constraints ( c1 ) are included in an ip .",
    "gobnilp then ( exactly ) solves the linear program ( lp ) relaxation of the ip where integer variables are ( temporarily ) allowed to take any real value within their bounds .",
    "this produces an lp solution @xmath115 .",
    "crucially , the lp solution can be found very quickly .",
    "gobnilp then searches for ( c2 ) acyclicity constraints that @xmath115 violates and adds them to the ip .",
    "linear constraints added in this way are known as `` cutting planes '' since they ` cut off ' the infeasible solution @xmath115 .",
    "gobnilp then solves the linear relaxation of this new ip and looks for cutting planes for the new lp solution",
    ". this process of solving linear relaxations and adding cutting planes is then repeated .",
    "note that the sequence of lp solutions produced in this way provide increasingly tight upper bounds on the objective value of the map estimator .",
    "it can happen that an lp solution represents well - defined dags ( i.e.  all variables have integer values and the graphs they represent are each acyclic ) . in this case , the problem is solved exactly , since any lp solution provides an upper bound on the objective function . more typically ( at least on larger problems ) a fractional lp solution is generated that satisfies all the constraints . in such a situation gobnilp selects a fractional variable , e.g. @xmath95 $ ] , to branch on , creating two subproblems , one where @xmath95=0 $ ] ( ruling out parent set @xmath116 for vertex @xmath12 for unit @xmath4 ) and one where @xmath95=1 $ ] ( setting the parent set of vertex @xmath12 for unit @xmath4 to be @xmath116 ) .",
    "the gobnilp algorithm is then applied recursively on both branches . when an ip variable @xmath95 $ ] is set to 1",
    ", gobnilp performs constraint propagation by setting to 0 those ip variables that indicate other parent sets for vertex @xmath12 or parent set choices for other vertices in the dag that are no longer possible under the acyclicity constraints .",
    "this approach to ip solving is known as `` branch - and - cut '' since both branching on variables and adding cutting planes are used .",
    "gobnilp is implemented using the scip framework due to @xcite .",
    "the basic gobnilp algorithm described above has been optimised in a number of ways : e.g.  extra linear constraints are added to the initial ip and additional cutting plane algorithms ( some built into scip , some gobnilp - specific ) are used .",
    "in addition , a heuristic algorithm ( based on ` rounding ' the current lp solution ) is used to generate ` good ' but probably sub - optimal dags .",
    "this can help prune the search tree produced by branching on variables ( but does not affect exactness of the algorithm ) .",
    "see @xcite for further details .    for joint estimation we constructed an interface for gobnilp that interlaces with scip to include additional constraints that couple together estimation problems for multiple dags .",
    "in practice ( c4 ) are implemented using scip s xor constraint handler .",
    "this handles any constraint of the form @xmath117 where @xmath118 and the constraint is satisfied if either @xmath119 and an odd number of the @xmath120 are 1 , or @xmath121 and an even number of the @xmath120 are 0 .",
    "we set @xmath122 \\oplus [ j \\in g_i^{(l)}]$ ] .",
    "scip generates these inequalities internally and also provides a propagator for xor constraints ; in the simplest case , as soon as any two of @xmath96 , @xmath88 $ ] and @xmath123 $ ] have their values fixed then scip will immediately fixed the value of the third appropriately .",
    "similarly ( c5 ) are implemented using scip s and constraint handler .",
    "this handles any constraint of the form @xmath124 , where @xmath118 .",
    "we set @xmath125 \\ & \\delta^{(k , l)}(j , i)$ ] .",
    "scip provides a propagator for and constraints that works analagously as for xor constraints .",
    "a naive implementation of our methodology can be quite effective , but with some additional consideration we can reduce computational effort by about an order of magnitude .",
    "specifically , we introduce additional ( redundant ) constraints @xmath89 + \\sum_{\\substack{\\pi \\subseteq \\{1:p\\}\\setminus\\{i\\ } \\\\ j \\notin \\pi } } [ g_i^{(k ) } = \\pi ] = 1 \\ ; \\ ; \\ ; \\ ; \\ ;   \\forall i , j , k",
    ". \\tag{c6 ; efficiency}\\ ] ] these do not change the definition of the ilp , since intuitively ( c6 ) states that if the edge @xmath126 is present in @xmath3 then the parent set @xmath23 for vertex @xmath12 must contain the vertex @xmath127 , which is trivially true .",
    "nevertheless the inclusion of ( c6 ) can greatly reduce search time in practice since it allows for more effective propagation .",
    "this is because when ( c6 ) are included then the edge - indicators @xmath88 $ ] become particularly good variables to branch on , producing a more balanced and consequently smaller search tree .    in this work we restricted attention to the map estimator , but the gobnilp software and our interface allow efficient computation of the top @xmath17 solutions to the ilp , that is the @xmath17 best joint estimates of the dags , along with their associated values for the objective function ( and hence bayes factors ) .",
    "the interfacing software is written for matlab r2014b and is provided in the supplementary materials .",
    "in this section we investigate the performance of the proposed joint estimators , using simulated data and data from a neuroscience study . in all examples , we restrict attention to a single regularity hyper - parameter @xmath104 and a single density hyper - parameter @xmath69 .      the performance of structure learning algorithms for graphical models can be quantified in many ways ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "structural estimation can be viewed as a binary classification task on individual edges and performance can be measured by the matthews correlation coefficient ( mcc ) which is popular in scenarios where the number of negative samples ( i.e. non - edges ) can out - weigh the number of positive samples ( i.e. edges ) .",
    "all experiments below were repeated 10 times based on independently generated datasets . in order to generate",
    "multiple related dags we employed a mcmc sampling scheme that targets the multiple dag prior @xmath128 .",
    "metropolis - hastings proposals that switch the status ( i.e. present or absent ) of an edge ( selected uniformly at random ) within a unit ( selected uniformly at random ) , subject to dag constraints , achieved an average acceptance probability of 83%",
    ". then , conditional on a dag @xmath3 , we simulated data @xmath26 .",
    "this could be achieved using essentially any likelihood model and in principle this choice will affect the properties of our estimators .",
    "we therefore took the simplest approach of directly simulating the evidence terms ( eqn .",
    "[ evidence ] ) from log - normal distributions .",
    "full pseudocode and convergence diagnostics are provided in the supplementary materials .",
    "we emphasise that the multiple rounds of estimation performed in the simulation study below preclude comparison with more computationally intensive approaches such as @xcite . on the other hand , methods that require a shared ordering of the variables such as @xcite",
    "do not apply in this general setting . in all experiments below",
    "we select hyper - parameters using a brute - force grid search over the ( coarse ) grid @xmath129 , @xmath130 .",
    "that is , we solve up to 25 ilps for each evaluation of the aic - based estimator .",
    "these candidate values for hyper - parameters were deliberately chosen to match the scale of the simulated data , as explained in the supplementary material . in practice",
    "the combinations of hyper - parameters that yield poor estimates ( i.e. low aic ) tend to correspond to ilps that are quickly solved , so that this grid search does not substantially affect computational complexity . to establish an ( approximate ) upper bound on the computational time required to evaluate our proposed estimators , we generated scores @xmath131 independently from @xmath132 , leading to very many dag models attaining similar posterior probabilities .",
    "this is a `` worst case scenario '' for the ilp solver , in the sense that maximum effort is required to distinguish between the models .",
    "an indication of these upper bounds on the computational times for a single ilp solve is provided in fig . [ times ] .",
    "it is seen that the operating range of our procedure is restricted to approximately @xmath133 , though in practice the worst - case scenario is unlikely to be realised and it may be possible to solve larger problems ( this is highly dependent on the values taken by the local scores ) .",
    "we make two further observations : firstly , in the exchangeable case with @xmath134 , @xmath135 the program was terminated due to insufficient ram .",
    "however the current best solution up to that point achieved an objective value of 71.49 and the upper bound provided by the ilp was 93.31 .",
    "this ability to provide a sure upper bound enables a heuristic map search for more challenging problems ( though in the sequel we considered only exact solutions ) . secondly , although the non - exchangeable case with @xmath136 , @xmath137 required 193,047 seconds to terminate ( about 54 hours ) , the map estimate was actually found after 31,020 seconds ( 16% of the total time ) , with the remaining time used to confirm that this was indeed the map .",
    "this suggests that computational time could be reduced if we are willing to sacrifice the guarantee of exactness .",
    "* exchangeable learning : * firstly we considered the case where the network @xmath42 ( that describes relationships between the units @xmath4 ) is fixed equal to the complete network ( exchangeable learning ) .",
    "we focussed on two distinct data - generating regimes : ( i ) the data - generating process has @xmath42 complete with related but non - identical dags , and ( ii )",
    "the data - generating process has @xmath42 as two disconnected complete components of equal size and therefore dags more similar within each component than between components . regime ( i ) employs exchangeable learning in a favourable setting where information is shared between all dags , whilst regime ( ii ) employs exchangeable learning in an unfavourable setting , where the assumption of exchangeability is violated .",
    "results for regime ( i ) in fig .",
    "[ sims1 ] ( a - d ) demonstrate that substantially improved performance is achieved by the proposed joint estimators compared with independent estimation .",
    "we also compared against the pooled estimator that requires all dags to have identical structure - a crude form of information sharing .",
    "results showed that this `` same dag '' estimator performed worse in general than inference based on hyper - parameters selected using aic , as expected .",
    "the same datasets were employed for each estimator , indicated by dashed lines , to ensure a fair comparison .",
    "results from regime ( ii ) in fig .",
    "[ sims1 ] ( e - f ) show that , despite the exchangeability assumption being violated , exchangeable learning remains competitive with independent estimation , but  same dag \" performs poorly , as expected .",
    "* non - exchangeable learning : * secondly we considered the case where the network @xmath42 is unknown and must be learned along with the unit - specific dags @xmath44 . in general",
    "the data - generating @xmath42 could have any topology ; we again focussed on the two distinct regimes described above . regime ( i ) aims to examine the loss of statistical efficiency that results from employing non - exchangeable learning when exchangeable learning would be more suitable , whilst regime ( ii ) explores the challenging case where the unknown @xmath42 is highly informative , so that the loss of information that comes from not knowing @xmath42 is greatest .",
    "results for regime ( i ) in fig .",
    "[ sims3](a - b ) demonstrate that , despite being extremely general , non - exchangeable learning still achieves improved estimation compared to both independent inference and the same dag estimator . for regime ( ii ) , shown in fig .",
    "[ sims3](c - d ) , we see that estimation is more challenging .",
    "indeed the gains in performance compared with independent estimation were small , perhaps reflecting the increased difficulty of jointly learning both @xmath44 and @xmath42 .",
    "( as before , the same dag procedure performed poorly in regime ( ii ) . )    for regime ( ii ) it is interesting to ask whether the network @xmath42 is itself accurately estimated ; results indicated that @xmath42 is not well estimated , with the map network @xmath138 typically being equal to the complete network .",
    "results in fig .",
    "[ sim5 ] compare the ability to estimate @xmath44 with the ability to estimate @xmath42 , showing that @xmath42 was typically more difficult to estimate compared with the unit - specific dags @xmath44 .",
    "this may explain why we do not see substantive gains over independent estimation in the non - exchangeable case , with performance similar to exchangeable learning .",
    "the difficulty in estimating @xmath42 is perhaps unsurprising : @xmath42 is latent for the dags @xmath44 that are themselves latent , so that the `` doubly latent '' @xmath42 may be only weakly identifiable .",
    "thus , while dag estimation results in the unknown @xmath42 formulation seem at worst competitive with the simpler exchangeable set - up , we would recommend caution in interpreting the estimate @xmath138 itself .",
    "we illustrate the methodology by analysing data from a functional magnetic resonance imaging ( fmri ) experiment .",
    "graphical models are widely used to represent neural connectivity in such studies and it is typical for fmri experiments to involve multiple subjects .",
    "a statistical analysis should therefore take into account not only the interaction between areas of one brain but also the similarities and differences among subjects @xcite . for instance , using fmri data derived from a writing experiment @xcite showed that the communication pattern among brain regions may be subject - specific , while @xcite argue that the causal relations between brain regions can vary in disease states according to the severity of the disease .",
    "we analysed a small fmri dataset consisting of six unrelated subjects from the human connectome project @xcite .",
    "data were acquired on each subject while they were in a state of quiet repose and preprocessed to obtain 10-dimensional time series representing the activity levels at 10 regions in each subject . the specific application is discussed in greater detail in the companion paper @xcite .    the interactions ( or connections ) among different cerebral areas",
    "are usually studied through causal dag models @xcite .",
    "here we use the multiregression dynamical model ( mdm ) for fmri data developed by @xcite , in which edges denote direct contemporaneous relationships that might exist between nodes and the connections are represented by parameters that vary over time . thus mdms",
    "are a generalisation of classical `` static '' bns but , unlike bns , are fully identifiable ( i.e. the equivalence classes are singletons ) .",
    "the mdm is defined on a multivariate time series that aims to identify the causal structure among the variables over time @xcite . in the mdm that we consider , a multivariate model for observable series @xmath139 ,",
    "for subject @xmath4 at time @xmath17 is characterised by a contemporaneous dag , with information shared across time only through evolution of the model parameters @xmath25 .",
    "formally , this model is described by the following observation equations and system equations : @xmath140 where @xmath141 is the concatenated parameter vector and @xmath142 , @xmath143 , @xmath144 must be specified .",
    "the equations of the mdm can be viewed as a collection of nested univariate linear models , allowing the parameters to be estimated using well - known kalman filter recurrences over time .",
    "we refer the reader to @xcite for further details regarding prior specification and computation of the local scores in this setting .    * independent learning : * first , we applied independent estimation to each of the 6 subjects , with results shown in fig .",
    "[ neuro1 ] ( top ) .",
    "these results are unsatisfactory on neurological grounds since it is anticipated that connectivity does not change grossly between subjects .",
    "* exchangeable learning : * next , we inferred dags @xmath44 under an exchangeability assumption , for various values of the regularity hyper - parameter @xmath104 ( fig .",
    "[ neuro1 ] ) , subjectively set to @xmath145 .",
    "( alternative approaches to set @xmath104 include aic , as described above , or exploiting technical replicate data and examination of bayes factors , as discussed at length in @xcite ) .",
    "* non - exchangeable learning : * based on @xmath146 we performed non - exchangeable learning in order to estimate similarities and differences between the 6 subjects in terms of their neural connectivity .",
    "specifically , we estimate a network @xmath42 on these 6 subjects , based on various values of the density hyper - parameter @xmath69 .",
    "results , shown in fig .",
    "[ n neuro ] , indicate that at @xmath147 , subjects 1 and 4 , 2 and 3 , and 5 and 6 exhibit the most similar graphical structures .",
    "non - edges @xmath148 in the network @xmath42 imply differences in the subjects graphical structure ; such information may therefore be used to identify subjects with particularly aberrant connectivity for further scientific investigation .",
    "going further , we see that subjects 5 and 6 are perhaps the most unusual , being totally disconnected from subjects 1 to 4 in the network @xmath42 when @xmath149 .",
    "however , we recommend caution in interpreting @xmath138 , due to the difficulty in estimation that we observed in simulations .",
    "we note also that @xmath69 can also be elicited based on bayes factors , as discussed in @xcite .    further analysis and interpretation of these results",
    "can be found in the companion paper @xcite .",
    "we emphasise that this analysis is exploratory and not confirmatory , but could be used to generate hypotheses for further experimental investigation .",
    "this paper introduced a general statistical framework for joint estimation of multiple dags .",
    "we considered regularisation based on graphical structure and showed how map estimators in this setting could be characterised as the solutions to ilps that admit efficient exact algorithms based on branching - and - cutting as well as constraint propagation .",
    "we believe these are the first exact algorithms for the general case of multiple general dag models ( i.e. with no restriction on ordering of the variables ) . in our general framework for joint learning , we allowed also for dependence between the units themselves , that generalises previous exchangeable formulations .",
    "results obtained both from simulations and from an application in neuroscience demonstrate that joint estimation of dags can offer increased statistical efficiency relative to independent estimation .",
    "however we observed that the relationships between the units themselves were difficult to estimate from data .    in the neuroscience application we illustrated how sophisticated likelihood models such as mdms",
    "can be used within our framework .",
    "importantly , our methodology requires only that local scores are pre - computed and cached ; it is therefore possible to apply exact algorithms retrospectively , following independent analyses of individual datasets , without the need to recompute local scores . in practice",
    "we anticipate that the rationale and appropriateness of joint modelling will need be assessed by domain experts on a case - by - case basis .",
    "our computations were performed using the gobnilp package @xcite , that includes sophisticated routines for estimation of individual dags ( see supplementary materials ) .",
    "nevertheless our simulation results for large numbers @xmath14 of variables and @xmath39 of units required considerable computational time ( in a worst - case scenario ) .",
    "it is becoming commonplace in many applications for the number of units to become very large .",
    "it remains to be seen whether our approach can scale up to larger problems .",
    "recent work where gobnilp was able to find map dags with 1614 nodes in between 3 and 42 minutes are encouraging @xcite . in practice , as discussed in @xcite , it is very hard to estimate the time required to solve an ilp in advance ; rather this depends in a highly non - trivial way on the details of the problem and is related to the `` phase - transition '' in sat solving .",
    "we note that the results of this paper are based on the ilp framework of @xcite for individual dags .",
    "an alternative ilp formulation , known as `` characteristic imsets '' , was proposed by @xcite specifically for bns .",
    "characteristic imsets are closely related to the essential graph of a bn @xcite and have the property that markov - equivalent bns are score equivalent .",
    "in contrast , the approaches we pursued involved a non - unique representation of the essential graph . this flexibility is important when dealing with general dag models including mdms , that are uniquely identifiable from data , but are less natural in the context of bns . at present , the computational performance of characteristic imsets on individual bns is inferior to the approach of @xcite pursued here @xcite .",
    "in addition it is currently unclear how prior structural information might be incorporated into that framework . on a related note , it would be interesting to design a joint version of the well - known pc algorithm @xcite that complements score - based estimation .",
    "interesting extensions include :    1 .   * information sharing for parameters . * in many applications it is reasonable to assume similarity of parameter values @xmath27 between units . at present",
    "this appears to be challenging to include within our framework and represents an area for further research .",
    "* computation . *",
    "the applications discussed in this paper were performed on a single cpu and limited in computational intensity to approximately @xmath133 . since many emerging datasets ,",
    "not least in biomedical applications , contain many more variables @xmath14 and many more units @xmath39 than we considered here , it would be interesting to investigate strategies for parallel and/or approximate computation that scale better to such regimes . in the other direction",
    ", our methodology applies to complex local scores that may be estimated numerically ; it would be interesting to gain a theoretical understanding of how any uncertainty in the estimates for the local scores would impact on the map estimators described here .",
    "* new statistical models . * by fixing the network @xmath42 in our general framework we can obtain a number of interesting statistical models : ( i ) taking @xmath42 to be a chain allows us to associate units with a temporal ordering and thereby model time - evolving dag structures .",
    "( ii ) introducing auxiliary dags @xmath150 and enforcing @xmath42 to be bipartite on the partition of auxiliary / non - auxiliary dags produces a mixture model for dags , such that each latent dag is a graphical summary of the various dag structures within its cluster .",
    "( iii ) extending this idea , with @xmath151 we recover a mixture model for dags similar to @xcite .",
    "these possibilities are currently being explored , with preliminary results for mixture models presented in @xcite .",
    "preliminary indications suggest that imposing additional restrictions on @xmath42 in this way may serve to improve the identification of higher - order structure . more generally , it is straightforward to extend our methods to the case of decomposable undirected models by imposing additional constraints that rule out immoralities .",
    "* supplementary materials : * the supplementary materials include additional a discussion of the simulated data and the actual code used to produce the results herein .",
    "* acknowledgements : * cjo was supported by the centre for research in statistical methodology ( crism ) epsrc ep / d002060/1 .",
    "jc was supported by the medical research council ( project grant g1002312 ) .",
    "sm was supported by the uk medical research council and is a recipient of a royal society wolfson research merit award .",
    "the authors are grateful to lilia carneiro da costa and tom nichols who collaborated in the analysis of fmri data and to mark bartlett who provided technical support with gobnilp .",
    "the authors also thank diane oyen and several other colleagues who provided feedback on an earlier draft .",
    "99    acid , s. , de campos , l.m . : searching for bayesian network structures in the space of restricted acyclic partially directed graphs .",
    "_ j. artif .",
    "res . _ * 18 * , 445 - 490 ( 2003 ) .",
    "achterberg , t. : _ constraint integer programming_. phd thesis , berlin institute of technology ( 2007 ) .",
    "achterberg , t. : scip : solving constraint integer programs .",
    "_ mathematical programming computation _ * 1*(1 ) , 1 - 41 ( 2009 ) .",
    "bartlett , m. , cussens , j. : advances in bayesian network learning using integer programming .",
    "_ proceedings of the 29th conference on uncertainty in artificial intelligence _ , 182 - 191 ( 2013 ) .",
    "chickering , d.m .",
    ": optimal structure identification with greedy search . _ j. mach .",
    "res . _ * 3 * , 507 - 554 ( 2003 ) .",
    "consonni , g. , la rocca , l. : moment priors for bayesian model choice with applications to directed acyclic graphs . _ bayesian statistics _ * 9*(9 ) , 119 - 144 ( 2010 ) .",
    "costa , l. , smith , j.q .",
    ", nicholls , t. : on the selection of multiregression dynamic models of fmri networked time series . _ crism working paper , university of warwick _ * 13 * , 6 ( 2013 ) .",
    "cowell , r.g .",
    ": efficient maximum likelihood pedigree reconstruction .",
    "biol . _ * 76 * , 285 - 291 ( 2009 ) .",
    "cussens , j. : maximum likelihood pedigree reconstruction using integer programming .",
    "_ proceedings of the workshop on constraint based methods for bioinformatics ( wcb-10 ) , edinburgh _ ( 2010 ) .",
    "cussens , j. : bayesian network learning with cutting planes . _",
    "proceedings of the 27th conference on uncertainty in artificial intelligence _ , 153 - 160 ( 2011 ) .",
    "danaher , p. , wang , p. , witten , d.m . : the joint graphical lasso for inverse covariance estimation across multiple classes .",
    "_ j. r. statist .",
    "b _ * 76*(2 ) , 373 - 397 ( 2014 ) .",
    "dawid , a.p . ,",
    "lauritzen , s.l . :",
    "hyper markov laws in the statistical analysis of decomposable graphical models .",
    "stat . _ * 21*(3 ) , 1272 - 1317 ( 1993 ) .",
    "dawid , a.p . :",
    "beware of the dag ! _ j. mach .",
    "w & cp _ * 6 * , 59 - 86 ( 2010 ) .",
    "ellis , b. , wong , w.h .",
    ": learning causal bayesian network structures from experimental data .",
    "assoc . _ * 103*(482 ) , 778 - 789 ( 2008 ) .",
    "friedman , n. , koller , d. : being bayesian about network structure : a bayesian approach to structure discovery in bayesian networks .",
    "_ * 50*(1 - 2 ) , 95 - 126 ( 2003 ) .",
    "friedman , j. , hastie , t. , tibshirani , r. sparse inverse covariance estimation with the graphical lasso .",
    "_ biostatistics _ * 9*(3 ) , 432 - 441 ( 2008 ) .",
    "friston , k.j . :",
    "functional and effective connectivity : a review . _",
    "brain connectivity _ * 1*(1 ) , 13 - 36 ( 2011 ) .",
    "he , y. , jia , j. , yu , b. : reversible mcmc on markov equivalence classes of sparse directed acyclic graphs . _ ann .",
    "_ * 41*(4 ) , 1742 - 1779 ( 2013 ) .",
    "heckerman , d. , geiger , d. , chickering , d.m .",
    ": learning bayesian networks : the combination of knowledge and statistical data . _",
    "_ * 20*(3 ) , 197 - 243 ( 1995 ) .    hill , s. , lu , y. , molina , j. , heiser , l.m . ,",
    "spellman , p.t .",
    ", speed , t.p . ,",
    "gray , j.w . , mills , g.b . , mukherjee , s. : bayesian inference of signaling network topology in a cancer cell line .",
    "_ bioinformatics _ * 28*(21 ) , 2804 - 2810 ( 2012 ) .",
    "jaakkola , t. , sontag , d. , globerson , a. , meila , m. : learning bayesian network structure using lp relaxations .",
    "_ proceedings of the 13th international conference on artificial intelligence and statistics _ , 358 - 365 ( 2010 ) .",
    "li , j. , wang , z.j . , palmer , s.j . , mckeown , m.j . : dynamic bayesian network modeling of fmri : a comparison of group - analysis methods .",
    "_ neuroimage _ * 41*(2 ) , 398 - 407 ( 2008 ) .",
    "l . , wainwright , m.j . :",
    "structure estimation for discrete graphical models : generalized covariance matrices and their inverses",
    "stat . _ * 41*(6 ) , 3022 - 3049 ( 2013 ) .",
    "mahajan , a. : presolving mixed - integer linear programs . _ wiley encyclopedia of operations research and management science _ ( 2010 ) .",
    "mechellia , a. , penny , w.d .",
    ", pricea , c.j . ,",
    "gitelman , d.r .",
    ", friston , k.j .",
    ": effective connectivity and intersubject variability : using a multisubject network to test differences and commonalities .",
    "_ neuroimage _ * 17*(3 ) , 1459 - 1469 ( 2002 ) .",
    "meinshausen , n. , bhlmann , p. : high - dimensional graphs and variable selection with the lasso .",
    "stat . _ * 34*(3 ) , 1436 - 1462 ( 2006 ) .",
    "nemhauser , g.l . ,",
    "wolsey , l.a . : _ integer and combinatorial optimization . _ wiley , new york ( 1988 ) .",
    "niculescu - mizil , a. , caruana , r. : inductive transfer for bayesian network structure learning .",
    "_ j. mach .",
    "workshop and conference proceedings _ * 27 * , 339 - 346 ( 2007 ) .",
    "oates , c.j . , mukherjee , s. : joint structure learning of multiple non - exchangeable networks .",
    "_ proceedings of the 17th international conference on artificial intelligence and statistics _ * 33 * , 687 - 695 ( 2014 ) .",
    "oates , c.j .",
    ", korkola , j. , gray , j.w . , mukherjee , s. : joint estimation of multiple networks from time course data .",
    "_ * 8*(3 ) , 1892 - 1919 ( 2014a ) .",
    "oates , c.j .",
    ", carneiro da costa , l. , nichols , t. : towards a multi - subject analysis of neural connectivity . _ neural compt .",
    "_ * 27 * , 1 - 20 ( 2014b ) .",
    "oates , c.j .",
    ", papamarkou , t. , girolami , m. : the controlled thermodynamic integral for bayesian model comparison .",
    "_ crism working paper series , university of warwick _ ,",
    "* 14 * , 9 ( 2014c ) .",
    "oates , c.j .",
    ", girolami , m. , chopin , n. : control funtionals for monte carlo integration .",
    "_ crism working paper series , university of warwick _ , * 14 * , 22 ( 2014d ) .",
    "oates , c.j . , amos , r. , spencer , s.e.f .",
    ": quantifying the multi - scale performance of network inference algorithms .",
    "mo . b. _ * 13*(5 ) , 611 - 631 ( 2014e ) .",
    "oyen , d. , lane , t. : leveraging domain knowledge in multitask bayesian network structure learning .",
    "_ proceedings of the 26th aaai conference on artificial intelligence _ ( 2012 ) .",
    "oyen , d. , lane , t. : bayesian discovery of multiple bayesian networks via transfer learning .",
    "_ ieee 13th international conference on data mining ( icdm ) _ , 577 - 586 ( 2013 ) .",
    "pearl , j. : _ causality : models , reasoning and inference ( 2nd ed.)_. cambridge university press ( 2009 ) .",
    "penfold , c.a .",
    ", buchanan - wollaston , v. , denby , k.j . ,",
    "wild , d.l .",
    ": nonparametric bayesian inference for perturbed and orthologous gene regulatory networks",
    ". _ bioinformatics _ * 28*(12 ) , i233-i241 ( 2012 ) .",
    "perrier , e. , imoto , s. , miyano , s. : finding optimal bayesian network given a super - structure .",
    "_ j. mach .",
    "* 9*(10 ) , 2251 - 2286 ( 2008 ) .",
    "peters , j. bhlmann , p. : structural intervention distance ( sid ) for evaluating causal graphs .",
    "_ neural compt .",
    "_ , to appear .",
    "poldrack , r.a . ,",
    "mumford , j.a . ,",
    "nichols , t.e . : _ handbook of fmri data analysis _ , cambridge university press ( 2011 ) .",
    "queen , c.m . , albers , c.j . : intervention and causality : forecasting traffic flows using a dynamic bayesian network . _ j. am .",
    "_ * 104*(486 ) , 669 - 681 ( 2009 ) .    queen , c.m . ,",
    "smith , j.q .",
    ": multiregression dynamic models . _ j. r. statist .",
    "b _ * 55*(4 ) , 849 - 870 ( 1993 ) .",
    "scott , j.g . ,",
    "berger , j.o . : bayes and empirical - bayes multiplicity adjustment in the variable - selection problem .",
    "stat . _ * 38*(5 ) , 2587 - 2619 ( 2010 ) .",
    "sheehan , n.a . , bartlett , m. , cussens , j. : maximum likelihood reconstruction of very large pedigrees .",
    "_ theoretical population biology _ , in press .",
    "silander , t. , myllymkki , p. : a simple approach to finding the globally optimal bayesian network structure . _ proceedings of the 22nd conference on artificial intelligence _",
    ", 445 - 452 ( 2006 ) .",
    "spirtes , p. , glymour , c. , scheines , r. : causation , prediction , and search . the mit press , 2nd edition ( 2000 ) .",
    "studen , m. , vomlel , j. , hemmecke , r. : a geometric view on learning bayesian network structures .",
    "j. approx .",
    "reason . _ * 51*(5 ) , 578 - 586 ( 2010 ) .",
    "studen , m. , haws , d. : on polyhedral approximations of polytopes for learning bayesian networks .",
    "_ j. algebraic stats . _ * 4*(1 ) , 59 - 92 ( 2013 ) .",
    "sugihara , g. , kaminaga , t. , sugishita , m. : interindividual uniformity and variety of the  writing center \" : a functional mri study .",
    "_ neuroimage _ * 32*(4 ) , 1837 - 1849 ( 2006 ) .",
    "thiesson , b. , meek , c. , chickering , d. m. , heckerman , d. : learning mixtures of bayesian networks . _ proceedings of the 14th conference on uncertainty in artificial intelligence _ , 504 - 513 ( 1998 ) .",
    "tsamardinos , i. , brown , l.e . ,",
    "aliferis , c.f . : the max - min hill - climbing bayesian network structure learning algorithm .",
    "_ * 65*(1 ) , 31 - 78 ( 2006 ) .",
    "van essen , d.c . ,",
    "smith , s.m . ,",
    "barch , d.m . ,",
    "behrens , t.e .",
    ", yacoub , e. , ugurbil , k. : the wu - minn human connectome project : an overview .",
    "_ neuroimage _ * 80 * , 62 - 79 ( 2013 ) .",
    "werhli , a.v . ,",
    "husmeier , d. : gene regulatory network reconstruction by bayesian integration of prior knowledge and/or different experimental conditions",
    ". _ journal of bioinformatics and computational biology _",
    "* 6*(3 ) , 543 - 572 ( 2008 ) .",
    "wolsey , l.a . : _",
    "integer programming_. wiley , new york ( 1998 ) .",
    "yuan , c. , malone , b. : learning optimal bayesian networks : a shortest path perspective .",
    "_ j. artif .",
    "res . _ * 48 * , 23 - 65 ( 2013 ) .",
    "* supplement to `` exact estimation of multiple directed acyclic graphs '' * chris .",
    "j. oates ( e - mail : _",
    "c.oates@warwick.ac.uk_ ) and jim q. smith ( e - mail : _",
    "j.q.smith@warwick.ac.uk_ ) , department of statistics , university of warwick , coventry , cv4 7al , uk .",
    "sach mukherjee ( e - mail : _",
    "sach@mrc-bsu.cam.ac.uk_ ) , mrc biostatistics unit and school of clinical medicine , university of cambridge , cb2 0sr , uk . james cussens ( e - mail : _",
    "james.cussens@cs.york.ac.uk_ ) , department of computer science and york centre for complex systems analysis , university of york , yo10 5ge , uk .",
    "in simulations we sampled the network @xmath42 directly from the prior @xmath152 and then sampled dags @xmath44 from the prior conditional @xmath128 using discrete - state - space mcmc .",
    "lines 2 - 12 in algorithm [ mcmc ] provide pseudo - code for the metropolis - hastings scheme that was employed . fig . [",
    "diagnose ] contains supporting convergence diagnostics .",
    "as explained in the main text , the local likelihood @xmath153 is arbitrary and its choice may influence the properties of the joint estimators that we wish to study .",
    "we therefore took the most default approach of directly simulating the evidence terms @xmath154 in eqn .",
    "[ evidence ] from log - normal distributions . in this way",
    "we hope to obtain results that apply quite generally , without the potential for likelihood - specific anomalies . for the aic we assumed that @xmath155 so that each edge is associated with one free parameter as in , for example , a linear structural equation model .",
    "specifically , we appealed to the intuition that in many applications only a subset of models will be supported by data .",
    "we therefore generated the log - evidence terms independently according to the mixture model @xmath156 , whilst the log - evidence of the true data - generating model was always simulated from @xmath132 .",
    "this ensures that the score @xmath131 of the data - generating model belongs on average to the top @xmath157 of all scores , whilst allowing us to discard @xmath158 of all models and thereby reduce the computational burden in this simulation study .",
    "all simulations were based on a value @xmath159 . to further mediate computational complexity",
    "we imposed an in - degree restriction @xmath160 for all simulation experiments ; this could be relaxed at additional computational effort .",
    "( note that in the `` worst case '' simulations in the main text , all models were assigned log - scores from @xmath132 . )    in principle , suitable values for the hyper - parameters will scale with both @xmath14 and @xmath39 . to mitigate this effect and to allow us to employ the same candidate values @xmath129",
    ", @xmath130 in each experiment , we rescaled the local scores @xmath131 by a factor of @xmath161 .",
    "full pseudo - code for the simulation of the local scores @xmath131 is provided in lines 13 - 24 of algorithm [ mcmc ] ."
  ],
  "abstract_text": [
    "<S> * abstract . * </S>",
    "<S> this paper considers the problem of estimating the structure of multiple related directed acyclic graph ( dag ) models . </S>",
    "<S> building on recent developments in exact estimation of dags using integer linear programming ( ilp ) , we present an ilp approach for joint estimation over multiple dags , that does not require that the vertices in each dag share a common ordering . furthermore , we allow also for ( potentially unknown ) dependency structure between the dags </S>",
    "<S> . results are presented on both simulated data and fmri data obtained from multiple subjects .    </S>",
    "<S> * keywords . </S>",
    "<S> * hierarchical models , directed acyclic graphs , non - exchangeability , integer linear programming , joint estimation    * author footnote . * chris . </S>",
    "<S> j. oates ( e - mail : _ </S>",
    "<S> c.oates@warwick.ac.uk_ ) and jim q. smith ( e - mail : _ </S>",
    "<S> j.q.smith@warwick.ac.uk_ ) , department of statistics , university of warwick , coventry , cv4 7al , uk . </S>",
    "<S> sach mukherjee ( e - mail : _ </S>",
    "<S> sach@mrc-bsu.cam.ac.uk_ ) , mrc biostatistics unit and school of clinical medicine , university of cambridge , cambridge , cb2 0sr , uk . </S>",
    "<S> james cussens ( e - mail : _ </S>",
    "<S> james.cussens@cs.york.ac.uk_ ) , department of computer science and york centre for complex systems analysis , university of york , york , yo10 5ge , uk . </S>"
  ]
}