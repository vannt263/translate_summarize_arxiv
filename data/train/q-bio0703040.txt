{
  "article_text": [
    "most models for range expansions can be classified as describing _ pulled _ or _ pushed _",
    "population fronts  @xcite .",
    "the distinction between the two cases corresponds to a difference in behavior .",
    "suppose individuals need to be in proximity to other individuals in order to grow in number ( allee effect  @xcite ) .",
    "the presence of conspecifics can be beneficial due to numerous factors , such as predator dilution , antipredator vigilance , reduction of inbreeding and many others  @xcite .",
    "then , the individuals in the very tip of the front do not count so much , because the rate of reproduction decreases when the number density becomes too small .",
    "consequently , the front is _ pushed _ in the sense , that its time  evolution is determined by the behavior of an ensemble of individuals in the boundary region . on the other hand , a population in which an individual reproduces , even if it is completely isolated from the rest , will be `` spearheaded '' by these front individuals .",
    "these _ pulled _ fronts are responsive to small changes in the frontier and , therefore , are prone to large fluctuations  @xcite",
    ". one might suspect that the genetic pattern left behind a population wave should reflect whether the colonization process is controlled by a small or large number of individuals .",
    "hence , we have set up a computer model that allows us to investigate the surfing dynamics for both classes of waves .",
    "the population is distributed on a one dimensional lattice , whose sites ( demes ) can carry at most @xmath1 individuals .",
    "the algorithm effectively treats individuals ( @xmath2 ) and vacancies ( @xmath3 ) as two types of particles , whose numbers must sum to @xmath1 at each site .",
    "a computational time step consists of two parts : ( i ) a migration event , in which a randomly chosen particle exchanges place with a particle from a neighboring site .",
    "this step is independent of the involved particle types .",
    "( ii ) a duplication _ attempt _ : two particles are randomly chosen ( with replacement ) from the same lattice site .",
    "a duplicate of the first one replaces the second one ( @xmath4 ) with probabilities based on their identities : proposed replacements @xmath5 , @xmath6 and @xmath7 ( growth ) are realized with probability @xmath8 , whereas @xmath9 ( death ) is carried out only with probability @xmath10 , depending on a growth parameter @xmath11 .",
    "this asymmetry controls the effective local growth advantage of @xmath2 over @xmath3 .    in terms of individuals and vacancies instead of particles",
    ", we see that our model describes migration and local logistic growth of a population distributed over demes with carrying capacity @xmath1 .",
    "starting with a step - function initial condition , the simulation generates an expanding _ pulled _ population wave .",
    "the above algorithm represents a discretized version  @xcite of the stochastic fisher - kolmogorov equation  @xcite with a moran - type of breeding scheme  @xcite . to generate _ pushed _ waves as well , we extend our model by the following rule : in demes in which the number of individuals falls to @xmath12 or below , we set their effective linear growth rate @xmath13 to zero .",
    "this represents , for @xmath14 , a simple version of the above mentioned allee effect of a reduced growth rate when the population density is too small .",
    "tracer experiments within this computer model allow us to extract the genealogies of front individuals .",
    "after the population had enough time to relax into its propagating equilibrium state , all individuals are labeled according to their current position @xmath15 within the simulation box of length @xmath16 , see fig .",
    "[ fig : labeled - wave]a .",
    "these labels are henceforth inherited by the descendents , which thereby carry information about the spatial position of their ancestors .",
    "the randomness in the reproduction and migration processes ( genetic drift ) during the succeeding dynamics inevitably leads to a reduction in the diversity of labels present in the simulation box , see fig .",
    "[ fig : labeled - wave]b .",
    "labels are lost due to either extinction or because they can not keep up with the simulation box , which _ follows _ the propagating wave front of individuals .",
    "we usually set @xmath17 individuals , where @xmath1 is the deme size .",
    "the size @xmath16 of the simulation box had to be chosen so that it contained the entire front up to the foremost individual .",
    "one hundred lattice sites usually were sufficient . ] .    in our simulation ,",
    "the gradual loss of diversity of labels at the wave front is measured by the quantity @xmath18 \\;,\\ ] ] which depends on the frequency @xmath19 of label @xmath20 at time @xmath21 after the wave has been labeled .",
    "@xmath22 represents the time - dependent probability that two individuals , randomly chosen from the bounded simulation box , carry different labels .",
    "provided that mutations are negligible on the time - scale of the range expansion , we may think of our inheritable labels as being neutral genes at one particular locus ( alleles ) .",
    "we may thus identify @xmath22 with the probability that two alleles randomly chosen from the front region are different conditional on the well - mixed labeling state at @xmath23 imposed by our simulation .",
    "hence , we refer to @xmath22 as the time - dependent _ expected heterozygosity _",
    "@xcite at the wave front  , then the heterozygosity at position @xmath24 ( in the non - moving frame ) as the wave front passes through is given by @xmath25 . ] .",
    "the perpetual loss of labels in our model without mutations eventually leads to the fixation of one label in the simulation box , see fig .",
    "[ fig : labeled - wave]c .",
    "the value of this label indicates the origin _ within the co - moving frame _ of this successful `` surfer '' .",
    "it contributes one data point to the spatial distribution @xmath26 of individuals whose descendents came to fixation . after fixation",
    ", the algorithm proceeds with the next labeling event .",
    "the parameters of our computer models are the deme size @xmath1 , i.e. the maximal number of individuals per lattice site , the linear growth rate @xmath13 per generation , and the critical occupation number @xmath12 , below which the growth rate drops to zero ( allee effect ) . in our simulations",
    ", we set @xmath27 throughout , and determine , for varying @xmath1 and @xmath12 , the averages of the ancestral distribution function @xmath28 , the scaled occupation number @xmath29 , both being functions of the lattice site @xmath20 in the co - moving frame , and the time - dependent probability of non - identity , @xmath30 . here",
    ", angle brackets indicate that the enclosed quantities have been averaged in time , i.e. over many fixation events , _ and _ over multiple realizations of the same computer experiment , we carried out @xmath31 realizations each measuring @xmath32 fixation processes .",
    "we have less statistics for larger deme sizes because of the larger number of degrees of freedom and fixation times . for @xmath33",
    ", we ran @xmath34 simulations and measured @xmath35 fixation processes . ] .",
    "figure [ fig : exple ] illustrates the relation between the front profiles @xmath29 and the ancestral distribution @xmath28 in the co - moving frame . whereas the wave profiles have the familiar sigmoidal shapes of reaction - diffusion waves  @xcite , the ancestral distribution functions are bell - curves with most of its support beyond the inflection point of the wave front .",
    "the fact that @xmath28 has a maximum inside the wave front reflects a tradeoff , mentioned earlier , between a larger fixation probability in the tip of the wave versus a larger number of surfing _ attempts _ originating from the bulk .",
    "notice from fig .",
    "[ fig : exple]a that , for increasing deme size , the distribution becomes wider and shifts further into the tip of the wave , which is in contrast to the almost @xmath36independent scaled wave profiles .",
    "[ fig : exple]b shows that the opposite effect is caused by increasing the cutoff value @xmath12 , which changes the type of the wave from _ pulled _ to _",
    "pushed_.        next , we measured the temporal decay of the heterozygosity @xmath37 , defined in eq .",
    "( [ eq : phi ] ) . in fig .",
    "[ fig : log - lin - heterozygosity ] , time - traces of @xmath22 are depicted for various parameters and show an exponential decay after an initial transient .",
    "this allows us to characterize the strength of genetic drift at the wave front by a single number , the ( asymptotic ) exponential decay rate , @xmath38 , which can be extracted from logarithmic plots of @xmath39 . by analogy with well - mixed ( panmictic ) populations ,",
    "in which the heterozygosity decays exponentially with rate @xmath40 ( moran model@xcite ) , it is convenient to express the decay rate by @xmath41 , in terms of an _ effective population size _ @xmath0 . the theoretical part below will further clarify to what extent the genetic diversity at the wave front mimics that of a population `` bottleneck '' of constant size @xmath0 .",
    "figure  [ fig : log - log - effpopsizes ] depicts @xmath0 as a function of the deme size @xmath1 on a double logarithmic scale for @xmath42 and @xmath43 .",
    "naively , one might expect @xmath0 to be , roughly , the characteristic number of individuals in the width of the wave front , since these individuals contribute ( by growing ) to the advance of the wave .",
    "thus , a linear relationship between deme and effective population size would not be surprising .",
    "in contrast , we find that @xmath0 increases much slower than linearly with increasing deme size .",
    "furthermore , the effective population size turns out to be very sensitive to the presence of an allee effect ( @xmath14 ) , which has the ability strongly increase the effective population size .",
    "this point is illustrated , in particular , by the inset of fig .",
    "[ fig : log - log - effpopsizes ] which depicts the effective population size @xmath0 in a simulation of fixed deme size ( @xmath44 ) and varying strength of the allee effect ( @xmath45 ) .",
    "qualitatively this phenomenon may be explained with the _ pushed _ nature of these waves .",
    "an allee effect shifts the distribution @xmath46 of successful surfers away from the tip towards the wake of the wave ( see fig .",
    "[ fig : exple]b ) and hence increases the gene pool from which the next generation of pioneers is sampled .",
    "this argument indicates a close relation between the @xmath0 and @xmath46 , which also emerges explicitely in the theoretical analysis below .     as a function of deme size @xmath1 on a log - log scale for _ pulled _ waves ( @xmath42 , asterisks ) and _ pushed _ waves ( @xmath43 , crosses ) .",
    "the dashed and dotted lines have slope @xmath47 and @xmath48 , respectively , i.e. , significantly smaller than @xmath8 .",
    "triangles represent the effective population sizes as inferred from the strong - migration approximation , eq .",
    "( [ eq : effective - popsize ] ) , using the _ measured _ @xmath49distribution and population profiles .",
    "the inset shows the behavior of @xmath0 for varying cutoff - value @xmath12 and fixed deme size @xmath44 , again , on a log - log scale . ]",
    "the following employs a continuous reaction diffusion approach to establish a theoretical basis for the relation between the neutral genetic diversity and the population dynamics in non - equilibrium situations like range expansions .",
    "it will help us to reconcile the somewhat surprising response of our simulations to parameter changes ( deme size and allee effect ) .",
    "note from fig .",
    "[ fig : exple ] that the changes in the ancestral distribution are dramatic , while the changes in the population profile itself are quite modest .",
    "results obtained from our approximation scheme are tested by direct comparison of simulations and theory .      in our simulations , as well as in many other models of range expansions , a propagating population wave results from the combination of random short - range migration and logistic local growth . in the continuum limit",
    ", a general coarse - grained continuum description of such a reaction - diffusion system of a single species is given by @xmath50 formulated in the frame co - moving with velocity @xmath51 , where @xmath52 represents the density of individuals at location @xmath24 at time @xmath21 and @xmath53 is a diffusivity .",
    "the first two terms on the right hand side represent the _ conservative _ part of the population dynamics , for which we make the usual diffusion assumptions  @xcite .",
    "the reaction term @xmath54 accounts for both deterministic and stochastic fluctuations in the number of individuals due to birth and death processes , and typically involves non  linearities such as a logistic interaction between individuals as well as noise caused by number fluctuations .",
    "for instance , our computer model with @xmath42 maps , in the continuum limit  @xcite , to the stochastic fisher equation , for which @xmath55 , where @xmath56 is a gaussian white noise process in space and time , @xmath57 is the carrying capacity and @xmath58 sets the strength of the noise .",
    "we would like to stress , however , that the following analysis does not rely on a particular form of @xmath59 .",
    "therefore , we leave the reaction term unspecified .    as in our tracer experiments , let us assume that inheritable labels , representative of neutral genes , are attached to individuals within the population and ask : given eq .",
    "( [ eq : comoving - rdiff ] ) is a proper description of the population dynamics , to what extent is the dynamics of these labels determined ? to answer this question , it is convenient to adopt a retrospective view on the tracer dynamics .",
    "imagine following the ancestral line of a single label located at @xmath24 _ backwards _ in time to explore which spatial route its ancestors took .",
    "this backward  dynamics of a single line of descent will show drift and diffusion _ only _ ; any reaction is absent because among all the individuals living at some earlier time there must be exactly one ancestor from which the chosen label has descended from .",
    "we may thus describe the ancestral process of a single lineage by the probability density @xmath60 that a label presently , at time @xmath21 and located at @xmath24 , has descended from an ancestor that lived at @xmath61 at the earlier time @xmath62 . in this context , it is natural to choose the time as increasing towards the past , @xmath63 , and to consider @xmath64 and @xmath65 as _ final _ and _ initial _ state of the ancestral trajectory , respectively .",
    "with this convention , the distribution @xmath66 satisfies the initial condition @xmath67 , where @xmath68 is the dirac delta function , and is normalized with respect to @xmath61 , @xmath69 .",
    "since @xmath60 as function of @xmath61 and @xmath62 is a probability distribution function generated by a diffusion process that is continuous in space and time , we expect its dynamics to be described by a generalized diffusion equation ( fokker  planck equation  @xcite ) .",
    "indeed , in the appendix [ app : a ] we show that , @xmath70 obeys @xmath71 \\right\\ } g \\nonumber   \\;,\\end{aligned}\\ ] ] where all derivatives are taken with respect to the ancestral coordinates @xmath64 . the drift term in eq .",
    "( [ eq : fpe ] ) has two antagonistic parts .",
    "the first term , @xmath51 , tends to push the lineage into the tip of the wave , and is simply a consequence of the moving frame of reference .",
    "the second term proportional to _ twice _ the gradient of the logarithm of the density is somewhat unusual .",
    "it accounts for the purely `` entropical '' fact that , since there is a forward  time flux of individuals diffusing from regions of high density to regions of low density , an ancestral line tends to drift _ into _ the wake of the wave where the density is higher . )",
    "has recently been obtained by vlad et al .",
    "@xcite . ]",
    "our computer experiments measure the spatial distribution @xmath72 of the individuals whose descendents came to fixation .",
    "this information is encoded in the long - time behavior of @xmath66 @xmath73 because it represents the probability that , in the far future ( @xmath74 , in our notation ) when the population is fixed , an individual of the extant lineage has descended from an individual who lived at location @xmath61 of the co - moving frame at time @xmath62 .",
    "equation ( [ eq : surfing - theory ] ) has to be independent of @xmath24 if fixation occurs : for @xmath74 , all individuals irrespective of their position @xmath24 must have descended from the same ancestor and , thus , from the same location at the earlier time @xmath62 .    in principle , it is thus possible to relate the ancestral distribution to the population dynamics by solving eq .",
    "( [ eq : fpe ] ) in the long - time limit .",
    "unfortunately , this task is usually difficult to achieve analytically because the number fluctuations in the density @xmath75 of the total population add noise to the drift term in eq .",
    "( [ eq : fpe ] ) . as is customary in many spatially explicit models of population genetics ,",
    "let us suppose , however , that rules of `` strict density regulation ''  @xcite are imposed in order to guarantee a stationary demography , so that in the co - moving frame , @xmath76 even though real systems and our discrete particle simulations exhibit density fluctuations even in equilibrium , we take eq .  (",
    "[ eq : stationarity ] ) as a first approximation in cases where the total number of particles is large enough , such that the relative magnitude of the density fluctuations is small ( law of large numbers ) .",
    "we will call assumption eq .",
    "( [ eq : stationarity ] ) the `` deterministic approximation '' as it neglects stochastic fluctuations in the total population density .    with eq .",
    "( [ eq : stationarity ] ) , all parameters in the fokker - planck equation , eq .",
    "( [ eq : fpe ] ) , of the ancestral distribution @xmath70 are time - independent and its analysis considerably simplifies : if a unique stationary solution @xmath77 exists , it can be written explicitely in terms of the stationary density profile @xmath78 , @xmath79 where a pre - factor is required to satisfy the normalization condition of @xmath80 , @xmath81 . ) , is not necessary for eq .",
    "( [ eq : fixprob ] ) to hold , rather the drift coefficient in the fokker ",
    "planck equation ( [ eq : comoving - rdiff ] ) has to be time - independent .",
    "this condition is satisfied whenever the density profile is separable , i.e. , @xmath82 , for two functions @xmath83 and @xmath84 . ]    as shown below , the analytical expression eq .",
    "( [ eq : fixprob ] ) describes at least qualitatively the bell - like shapes found for the ancestral distribution function @xmath85 in our stochastic simulations .",
    "the exponential factor biases the fixation probability   of a mutation occurring in a _",
    "single _ individual at @xmath61 is obtained from @xmath80 after dividing by the population density , @xmath86 .",
    "this quantity measures the probability of ultimate evolutionary success of a neutral genetic marker in a single individual at location @xmath61 in the wave front . ] towards the tip of the wave ( @xmath87 ) and competes with the pre - factor controlled by the decaying density of individuals in the tip of the wave .",
    "it is noteworthy that eq .",
    "( [ eq : fixprob ] ) not only applies to range expansions , but can be evaluated for any deterministic population dynamics , such as deterministic models of evolution  @xcite ( where however rare events might be crucial as found in ref .",
    "@xcite ) and to source - sink populations  @xcite , a simple example of which is given in the appendix [ app : b ] . if the spatial domain is unbounded , eq .  ( [ eq : fixprob ] )",
    "yields finite results as long as @xmath78 decays faster than @xmath88 $ ] as @xmath89 .",
    "this condition formally distinguishes the two classes of waves earlier denoted by _",
    "pulled _ and _ pushed_. within the mean - field description of such waves , the right hand site of eq .",
    "( [ eq : fixprob ] ) is normalizable only in the case of _ pushed _ waves  @xcite .",
    "the density of _ pulled _ waves , however , decays as @xmath88 $ ] in the foot of the wave ( @xmath89 ) as follows from a linearized mean field treatment  @xcite .",
    "the prime example of _ pulled _ waves , the mean - field fisher wave , does not therefore allow for successful surfing , @xmath90 , as is explicitely shown in appendix [ app : c ] .",
    "this is in marked contrast to our simulations of _ stochastic _ fisher waves ( fig .",
    "[ fig : exple]a ) . there , we found finite bell - like ancestral distributions up to deme sizes on the order of @xmath32 .",
    "this striking discrepancy indicates that the classical fisher equation is a poor approximation for the case of finite deme sizes ( even if they are large ) .",
    "an improved deterministic equation with a modified reaction term has been proposed  @xcite , which is able to reproduce the leading reduction in wave velocity due to the discreteness . a remarkable property of eq .",
    "( [ eq : fixprob ] ) is that it should be valid , _ irrespective _ of the actual form of the reaction term , if the demography is deterministic . by comparing eq .",
    "( [ eq : fixprob ] ) to simulations , it is possible to test the deterministic character of a population wave , i.e. , whether or not a deterministic reaction - diffusion description might be appropriate .    for our simulations , such a test is given in fig .",
    "[ fig : theory ] , where we superimpose measured ancestral distribution functions @xmath85 with those predicted by eq .",
    "( [ eq : fixprob ] ) based on the measured wave velocity @xmath51 and the occupation numbers @xmath91 ( the discrete analog of the population density @xmath78 ) .",
    "it is seen that systematic deviations occur in the _ pulled _ case ( @xmath42 ) , where the predicted distribution seems to be somewhat displaced towards the tip of the wave .",
    "the agreement of theory and simulation is much better for @xmath43 and further improves when @xmath12 is increased .",
    "altogether , our deterministic approximation eq .",
    "( [ eq : fixprob ] ) seems to apply best to _ pushed _ waves with a strong allee effect ( @xmath92 ) , whereas significant deviations to eq .",
    "( [ eq : fixprob ] ) occur for _ pulled _ waves .",
    "an alternative test of theory and simulation , presented in fig .",
    "[ fig : log - lin ] , supports this conclusion and furthermore shows that the deterministic approximation applied to _ pulled _ waves improves slowly with increasing deme size . for reasonable system sizes , however , fluctuation effects in _ pulled _ waves are non - negligible  @xcite .",
    "b ( thin lines ) superimposed with the prediction eq .",
    "( [ eq : fixprob ] ) ( thick lines ) for the ancestral distribution function @xmath85 based on the measured wave profile @xmath91 and velocity @xmath51 .",
    "as explained in the text , the apparent systematic deviations in the _ pulled _ case ( @xmath42 ) are caused by fluctuations in the tip of the wave . ]          to measure how fast genetic diversity decreases at the wave front due to gene surfing , we also studied in our simulations @xmath22 , defined in eq .",
    "( [ eq : phi ] ) as the probability that two randomly sampled individuals carry different labels at a time @xmath21 after a labeling event .",
    "to what extent are the decrease of @xmath22 and the shape of @xmath93 related ? as before , a retrospective view on the problem simplifies the theoretical analysis .",
    "imagine following the lineages of two randomly sampled individuals backward in time .",
    "they will drift and diffuse separately for a certain time @xmath94 until they _ coalesce _ in the most recent common ancestor .",
    "if the last labeling event occurred at an earlier time @xmath95 ( reversed time - direction ) then both individuals must carry identical labels . if , on the other hand , @xmath96 then these individuals will have different labels unless their different ancestors happen to be in the same deme at the labeling time .",
    "up to a small error of the order of the inverse size of the simulation box , we may thus identify the probability @xmath22 of two individuals carrying different labels with the probability that their coalescence time @xmath94 is larger than @xmath21 .    in principle",
    ", the coalescence time distribution of two lineages can be explored by studying the simultaneous backward  diffusion process of two lineages conditional on having not coalesced before  @xcite .",
    "this process is described by a generalization of eq .",
    "( [ eq : comoving - rdiff ] ) augmented by a well - known sink term  @xcite that accounts for the probability of coalescence when lineages meet .    here",
    ", we describe a ( more tractable ) approximation that estimates the behavior of @xmath22 from the distribution @xmath93 , analyzed in the previous section .",
    "it is based on the assumption that the coalescence rate of two lineages is so small that each lineage has enough time to equilibrate its spatial distribution before coalescence occurs . under this quasi - static approximation ,",
    "the behavior of @xmath22 is described by  @xcite @xmath97 when time is measured in units of generation times .",
    "the justification of eq .",
    "( [ eq : ctime ] ) is as follows : the coalescence rate , @xmath98 , at time @xmath62 in the past is given by the probability that the two lineages have not coalesced earlier , @xmath99 , times the rate at which two separate lineages coalesce at time @xmath62 .",
    "the latter is locally proportional to the product of the probabilities that the two lineages meet at the same place , @xmath100 , and that they meet in the same individual , @xmath101 , given they are at the same place .",
    "less obvious , unfortunately , is the numerical pre - factor `` @xmath102 '' on the right - hand side , which is specific to the employed breeding scheme ( moran model@xcite ) .",
    "( [ eq : ctime ] ) yields the correct coalescence time distribution in the so - called _ strong migration limit _",
    "@xcite of large population densities , @xmath103 , while the diffusivity @xmath53 and the spatial extension of the habitat are held fixed . in our case , it serves as a simple approximation that tends to overestimate coalescence rates , because it neglects spatial anti - correlations between non - coalescing lineages : lineages that have avoided coalescence will usually be found further apart than described by the product of ( one - point ) distribution functions in eq .",
    "( [ eq : ctime ] ) .",
    "thus , their rate of coalescence will , typically , be smaller than in eq .",
    "( [ eq : ctime ] ) .",
    "equation  ( [ eq : ctime ] ) predicts exponential decay , @xmath104 $ ] , in the deterministic approximation , eq .  ( [ eq : stationarity ] ) , with a rate depending on a constant @xmath105 given by  @xcite@xmath106 in fact , a generalization of this argument to the coalescence process of a sample of @xmath16 lineages shows that the _ standard coalescent _  @xcite is obtained in the strong - migration limit with the parameter @xmath105 interpreted as the _ effective population size",
    "_  @xcite . in other words , the coalescence process in the strong - migration limit is identical , in every respect , to the coalescence of a well - mixed population of fixed size @xmath0 .",
    "the strong - migration approximation may be tested by comparing the effective population sizes measured in our simulations with the ones predicted by eq .",
    "( [ eq : effective - popsize ] ) based on the measured ancestral distribution @xmath28 and the number density profile @xmath107 .",
    "these inferred values are plotted in fig .",
    "[ fig : log - log - effpopsizes ] as ( red ) triangles . for both _ pushed _ and _ pulled _ waves , the agreement between inferred and measured effective population sizes becomes excellent for large deme sizes , @xmath108 . for lower values of @xmath1",
    "the strong migration assumption overestimates genetic drift , presumably due to the neglect of correlations as mentioned above .",
    "we have studied the impact of a range expansion on the genetic diversity of a population by means of simulations and analytical techniques .",
    "the one dimensional case treated in this article applies to populations following a ( possibly curved ) line , like a migration route , coast line , river or railway track .",
    "we have further simplified our analysis by neglecting habitat boundaries , which is appropriate for describing the colonization period , as long as the wave front is sufficiently far away from the boundaries .",
    "our findings suggest the following general scenario .",
    "suppose , an initially well - mixed population increases its range from a smaller to a larger habitat , and that mutations may be neglected on the time scale of the range expansion .",
    "our simulations show that the heterozygosity at the moving colonization front decays , due to genetic drift , exponentially in time with a rate @xmath41 , depending on an _ effective _ population size @xmath0 . upon combining this rate with the velocity @xmath51 ( per generation ) of the colonization front",
    ", we obtain a length @xmath109 that characterizes the pattern of genetic diversity generated by the colonization process : as the wave front moves along it leaves behind saturated demes with heterozygosities given by the value of the front heterozygosity as the wave front passes through .",
    "the transient colonization process therefore engraves a spatially decreasing profile of heterozygosity into the newly founded habitat .",
    "this profile decays exponentially in space on the characteristic length @xmath110 and serves as an initial condition for the succeeding period of demographic equilibration , which may be described by traditional models of population genetics  @xcite .    of critical importance for the interpretations of gene frequency clines in natural populations",
    "is the question as to which parameters chiefly control @xmath110 .",
    "our computer simulations have revealed , that the effective population size , and thus @xmath110 , only grows _ sub - linearly _ with increasing deme size , in contrast to the naive expectation that the effective population size should roughly be given by the characteristic number of individuals contained in the wave front ( deme size times the width of the wave ) . on the other hand",
    ", we found that the population `` bottleneck '' at the wave front was significantly widened when we implemented an allee effect  @xcite into our model , by which growth rates for small population densities are decreased .",
    "as a consequence , the region of major growth shifted away from the frontier into the bulk of the wave and , thus , the effective size of the gene pool for the further colonization was increased .",
    "finally , we have developed a theoretical framework to study the backward - dynamics of neutral genetic markers for a given non - equilibrium population dynamics , which is summarized by the fokker - planck equation ( [ eq : fpe ] ) and its generalization in appendix [ app : a ] . in stationary populations",
    ", it leads to a simple expression , eq .",
    "( [ eq : fixprob ] ) , for the long - time probability distribution of the common ancestors , which can be used , in the strong - migration limit to determine the effective population size , via eq .",
    "( [ eq : effective - popsize ] ) .",
    "comparison with our stochastic simulations reveals that the simple deterministic results are good approximations to stochastic simulations in the case of _ pushed _ waves ( strong allee effect ) , but that significant deviations occur for _ pulled _ waves due to the fluctuations in the frontier of the population wave . for sufficiently large deme sizes ,",
    "the effective population size could , in both cases , be inferred with remarkable accuracy from eq .",
    "( [ eq : effective - popsize ] ) .",
    "this research was supported by the german research foundation through grant no .",
    "ha 5163/1 ( oh ) .",
    "it is a pleasure to acknowledge conversations with michael brenner , michael desai and john wakeley .",
    "in this appendix , we describe the derivation of the fokker  planck equation , eq .",
    "( [ eq : fpe ] ) , and its generalization to heterogeneous migration and higher dimensions .",
    "central to our analysis is the assumption that the total population consists of statistically identical entities , such that two different individuals at a given time and location behave in the same way . in particular , we assume that migration as well as reproduction of an individual are _ exchangeable _  @xcite random processes , i.e. , independent of any label that might be assigned to it .",
    "let us indeed imagine a subpopulation labeled by a neutral marker , and ask : what is the dynamics of the labeled individuals for a _ given _ dynamics of the total population , as described by eq .",
    "( [ eq : comoving - rdiff ] ) ?",
    "it is clear that the density @xmath111 of labels obeys a reaction - diffusion equation with coefficients @xmath112 , @xmath113 and @xmath114 that are closely related to the one for total population by means of the exchangeability assumption .",
    "firstly , labeled and unlabeled individuals should migrate statistically in the same way , which is measured by diffusion and drift coefficients , i.e. , we have @xmath115 and @xmath116 . secondly , the labeled subpopulation must carry the number fluctuations of the total population , encoded in @xmath59 , in proportion to its reduced size : @xmath117 . however , these statements are true only _ on average _ : the discreteness of the particle numbers lead to fluctuations , for instance , in the quantity @xmath118 .",
    "to illustrate this point , imagine that at a given time , the term @xmath59 dictates that an individual dies in some small spatio - temporal region , then this individual has to be sampled from the labeled subpopulation with probability @xmath119 .",
    "the fluctuations of @xmath120 due to this sampling procedure represents random genetic drift and must have zero mean according to the exchangeability assumption .",
    "similar fluctuations affect the migration currents of the labeled subpopulation .",
    "thus , only upon averaging over this source of stochasticity , we may formulate a reaction - diffusion equation of the form @xmath121 for the average density @xmath122 of labeled individuals . in eq .",
    "( [ eq : eom - star - simple ] ) , only the effect of the genetic drift of labeled individuals within the total population has been averaged out , the number fluctuations affecting the total population density are retained through the fluctuating reaction term @xmath59 . in other words , eq .",
    "( [ eq : eom - star - simple ] ) describes the behavior of labeled individuals , if we average over many realizations conditional on a given fixed evolution of the total population , described by eq .",
    "( [ eq : comoving - rdiff ] ) .",
    "note that , this averaging `` works '' because eq .",
    "( [ eq : eom - star - simple ] ) is linear in @xmath120 , such that a noise term with zero mean added to the right  hand  side to account for the genetic drift can be averaged out without generating higher moments .",
    "next , we use @xmath123 from eq .",
    "( [ eq : comoving - rdiff ] ) to substitute the reaction term @xmath59 in eq .",
    "( [ eq : eom - star - simple ] ) . after rewriting the average density @xmath124 of labeled individuals in terms of their average frequency ( or ratio ) @xmath125",
    ", we obtain @xmath126 \\right\\}\\partial_x \\overline{p } \\;.\\ ] ] notice that , @xmath127const .",
    "is a ( steady state ) solution of eq .",
    "( [ eq : eom - p - simple ] ) .",
    "relations formally equivalent to eq .",
    "( [ eq : eom - p - simple ] ) have been formulated in refs .",
    "@xcite in different contexts , in which , unlike the present case , random genetic drift could not be averaged out due to non - linearities , but had to be disregarded , instead .",
    "as a transport equation for _ deterministic _ gene frequencies , an equation similar to eq .",
    "( [ eq : eom - p - simple ] ) was also recently obtained in ref .",
    "@xcite .    for a given realization of the time - evolution of the total population",
    ", the quantity @xmath128 can be interpreted as the probability that an individual sampled from @xmath129 is labeled , i.e. , that it has descended from the initially labeled population .",
    "if the above tracer experiment for a _ given _ dynamics of @xmath130 is repeated multiple times , @xmath131 represents the histogram of the number of times a individual sampled from @xmath129 is labeled .    by choosing proper initial conditions , this allows us to study `` where individuals come from '' : suppose that , at time @xmath62 , the labeled population contains all individuals within a small interval around the position @xmath61 . the solution of eq .",
    "( [ eq : eom - p - simple ] ) for later times will then tell us the probability that a individual at @xmath129 has descended from an ancestor sampled from that narrow region around @xmath61 at time @xmath62 .    hence , the probability density @xmath132 , introduced above eq .",
    "( [ eq : fpe ] ) , that an individual at @xmath65 has an ancestor who lived at @xmath64 , is just the solution of eq .",
    "( [ eq : eom - p - simple ] ) for the initial condition @xmath133 where @xmath134 is the dirac delta function .",
    "it is straightforward  @xcite to show that this green s function of eq .",
    "( [ eq : eom - p - simple ] ) also obeys the fokker ",
    "planck equation ( [ eq : fpe ] ) , in which time is measured in the backward direction ; eq .",
    "( [ eq : eom - p - simple ] ) is usually called the ( kolmogorov ) backward equation  @xcite associated with the fokker - planck equation ( [ eq : fpe ] ) .",
    "the content of the fokker - planck equation ( [ eq : fpe ] ) may be further illustrated by a physical analog .",
    "the dynamics of a single ancestral line backward in time conditional on a particular demographic history , as described by eq .",
    "( [ eq : comoving - rdiff ] ) , is equivalent to the brownian motion of a particle ( with @xmath135 ) in a potential @xmath136 , whose negative gradient is given by the drift coefficient @xmath137 in eq .",
    "( [ eq : fpe ] ) .",
    "the form of this time - dependent potential , @xmath138 \\;,\\ ] ] suggests an interpretation in terms of a fluctuating free energy in which the first and second term are the energetic and entropic contribution , respectively .",
    "if the spatial domain is unbounded , the long - time distribution function of the fluctuating particle will be non - trivial only if the potential eq .",
    "( [ eq : potential ] ) has the form of a well , which is able to `` trap '' the fluctuating particle on long times .",
    "otherwise , for instance if the potential is half - open as in the case of a fisher wave , the ancestral probability distribution will decay to zero on long times .",
    "so far , our analysis was restricted to a one - dimensional reaction diffusion model , in which drift and diffusion are space - independent .",
    "the generalization of eq .",
    "( [ eq : comoving - rdiff ] ) to heterogeneous migration and higher dimensions reads @xmath139 the conservative dynamics is now described by a matrix @xmath140 of diffusivities and a velocity vector @xmath141 , which may both depend on space and time .",
    "again , the reaction term @xmath142 accounts for deterministic and stochastic fluctuations in the number of individuals due to birth and death processes .    repeating",
    "the above arguments for the dynamics of neutral labels under the more general population dynamics eq .",
    "( [ eq : eom ] ) yields a multi - dimensional fokker ",
    "planck equation for the probability density @xmath143 that an individual at @xmath144 has descended from an ancestor who lived at @xmath145 , which is given by @xmath146 g \\nonumber   \\;.\\end{aligned}\\ ] ] here , summation over identical indices is implied and time again increases in the backward direction . the natural requirement",
    "that there is no probability flux @xmath147 out of the region @xmath148 of non  vanishing population density leads to reflecting boundary condition , @xmath149 , on the boundary @xmath150 of @xmath148 .",
    "note that our stochastic description of the backward dynamics of a single lineage , eq .",
    "( [ eq : fpe - app ] ) , is fully determined by the demographic history @xmath52 .",
    "a knowledge of the actual form of the reaction term @xmath54 in the reaction - diffusion equation ( [ eq : eom ] ) is not necessary .",
    "for purely conservative populations  @xcite of neutral individuals , subject only to diffusion and drift , it is well - known that the fixation probability is the same for all individuals , @xmath151const.@xmath152 , and that the effective population size equals the total population , @xmath153 .",
    "however , when reaction terms are important , individuals become privileged or handicapped depending on where they linger . as a telling example , let us consider the case of an `` oasis ''  @xcite ( or source  @xcite ) with a carrying capacity @xmath154 in equilibrium with a `` desert '' ( a sink ) of smaller carrying capacity @xmath155 . sufficiently far away   that depends on a diffusion constant and the effective growth rate @xmath13 . ] from the contact zone , the population densities will be saturated at their respective carrying capacities . according to eq .",
    "( [ eq : fixprob ] ) , the ancestral distribution function of a stationary non - moving population will be locally proportional to the square of the density , @xmath156 .",
    "as noted in footnote 5 of the main text , the fixation probability of a mutation occurring in a single individual is given by the ratio of ancestral distribution function and population density , @xmath157 .",
    "thus , the probability that a neutral mutation fixes will be larger if it arises deep in the oasis , @xmath158 , than if it arises in the desert , @xmath159 .",
    "the ratio of both fixation probabilities is given by the ratio of the respective densities , @xmath160 apart from its simplicity , the relation eq .",
    "( [ eq : ratio - of - fprobs ] ) is remarkable because it is independent of the diffusion constants and the details of the particular logistic interaction between individuals .    if the combined system of oasis and desert is closed , the effective population size , eq .",
    "( [ eq : effective - popsize ] ) , evaluates to @xmath161 to leading order in the linear sizes @xmath162 and @xmath163 of oasis and desert .",
    "as mentioned earlier , our reasoning regarding coalescence times only applies to the strong  migration limit , in which the fixation time @xmath164 , where @xmath165 is the generation time , is much smaller than the longest relaxation time of the fokker  planck equation . for the present case",
    ", the latter may be estimated by the time needed for lineage to cross the habitat , @xmath166 .",
    "here , we apply our theory of gene surfing to the fisher equation  @xcite , @xmath167c(x , t ) \\;,\\ ] ] which is the prime example of a _ pulled _ front .",
    "this equation was originally proposed as a mean  field model for the spread of a dominant gene with selective fitness advantage @xmath13 through a population with constant density @xmath168 ( carrying capacity ) .",
    "equation ( [ eq : fk - wave - eq ] ) has also been useful as a description of an expanding population , for which @xmath13 is the difference between the linear birth and death rates , and the term @xmath169 represents some self - limiting process , roughly proportional to the number of pairs of individuals at position @xmath24 .",
    "there are two spatially homogeneous fixed points : an unstable fixed point at @xmath170 , in which there is no population at all , and a stable fixed point at @xmath171 , where the population saturates to the carrying capacity @xmath168 of the environment .",
    "non - negative initial configurations evolve smoothly toward the stable fixed point ; analysis of the time development of spatial fluctuations in this model reveals that equilibrium can be reached via traveling soliton - like solutions @xmath172 , referred to as fisher waves  @xcite , which represent steady state solutions of eq .",
    "( [ eq : fk - wave - eq ] ) . in the wave front , where the population density is much smaller than the carrying capacity , the non - linear logistic term @xmath173 in eq .",
    "( [ eq : fk - wave - eq ] ) may be neglected .",
    "the steady state solution of the remaining linear equation is exponentially decaying , @xmath174 for @xmath175 , where decay length @xmath110 and velocity @xmath51 are related by @xmath176 the population density to be nonnegative requires real solutions @xmath177 of eq .",
    "( [ eq : velocity - dispersion ] ) , which do not exist unless @xmath178 it can be shown that the solution corresponding to the lowest velocity @xmath179 and decay length @xmath180 is approached for any initial conditions with compact support , and , thus , is the solution most relevant for biological applications  @xcite .",
    "now , when we evaluate the surfing probability , eq .",
    "( [ eq : fixprob ] ) for this standard model of a spreading wave , we find zero - a somewhat surprising result in light of the finite bell - like curves obtained from our simulations of stochastic fisher waves ( fig .",
    "the exponential decrease of the population density at the wave front , eqs .",
    "( [ eq : wprofile - tip ] , [ eq : velocity - disp2 ] ) , is simply not fast enough to render the function @xmath181 normalizable - not even for the lowest velocity for which it approaches a positive constant as @xmath89 .",
    "hence , a non  zero stationary distribution function of the common ancestor does not exist , even though the total population is in a steady state .    a closer look to the _ dynamics _ of a lineage , as described by the fokker ",
    "planck equation ( [ eq : fpe ] ) , reveals how the distribution of the common ancestor decays to zero with time .",
    "as we evolve the probability distribution @xmath182 that a lineage diffuses from a location @xmath24 to @xmath61 back through time , it spreads out , due to diffusion , and is subject to a drift of strength @xmath183 . if a lineage starts out deep in the wake of the wave , @xmath184 , where @xmath185 , it experiences a drift pushing it towards the wave front . after a time of the order of @xmath186 , the probability cloud of the single lineage reaches the front and ,",
    "when the inflection point is passed , the drift has decreased appreciable because @xmath187 . in the tip of the wave , the density profile is exponential , eq .",
    "( [ eq : wprofile - tip ] ) , such that the drift , @xmath188 , saturates at a _ non - negative _ value @xmath189 , which tends to move the lineage even further away from the bulk into the tip of the wave . for large times",
    ", the distribution @xmath66 assumes the form of a bell  like curve of width @xmath190 moving with a velocity @xmath191 . for any fixed @xmath61 in the foot of the wave and @xmath192 ,",
    "the distribution function @xmath66 decays exponentially to zero for times , when the probability `` cloud '' has passed @xmath61 . only for @xmath193 , which corresponds to the lowest allowed velocity @xmath194 ,",
    "drift is absent in the tip of the wave , such that the decay is much slower , @xmath195 . in any case",
    ", however , @xmath66 decays to zero for any location @xmath61 , which means that , no matter which individual we choose , the fixation probability is zero .",
    "thus , `` successful surfing '' is not possible in the case of the deterministic fisher wave , as was mentioned already in the main text .",
    "we expect that , in a _ stochastic _ simulation of a finite number of particles , the time ",
    "dependent features discussed above for the mean - field fisher equation are merely _ transient _ and only visible for times smaller than the longest relaxation time of the fokker ",
    "planck equation , eq .",
    "( [ eq : fpe ] ) .",
    "this conjecture can be supported by employing an approximation scheme due to brunet - derrida  @xcite to take into account leading order effects of discreteness ."
  ],
  "abstract_text": [
    "<S> spatially resolved genetic data is increasingly used to reconstruct the migrational history of species . to assist such inference , we study , by means of simulations and analytical methods , the dynamics of neutral gene frequencies in a population undergoing a continual range expansion in one dimension . during such a colonization period </S>",
    "<S> , lineages can fix at the wave front by means of a `` surfing '' mechanism [ edmonds c.a . </S>",
    "<S> , lillie a.s . & </S>",
    "<S> cavalli - sforza l.l . </S>",
    "<S> ( 2004 ) proc natl acad sci usa 101 : 975 - 979 ] . </S>",
    "<S> we quantify this phenomenon in terms of ( i ) the spatial distribution of lineages that reach fixation and , closely related , ( ii ) the continual loss of genetic diversity ( heterozygosity ) at the wave front , characterizing the approach to fixation . </S>",
    "<S> our simulations show that an _ effective population size _ can be assigned to the wave that controls the ( observable ) gradient in heterozygosity left behind the colonization process . </S>",
    "<S> this effective population size is markedly higher in _ pushed _ waves than in _ pulled _ waves , and increases only sub - linearly with deme size . to explain these and other findings </S>",
    "<S> , we develop a versatile analytical approach , based on the physics of reaction - diffusion systems , that yields simple predictions for any deterministic population dynamics .    </S>",
    "<S> population expansions in space are common events in the evolutionary history of many species  @xcite and have a profound effect on their genealogy . </S>",
    "<S> it is widely appreciated that any range expansion leads to a reduction of genetic diversity ( `` founder effect '' ) because the gene pool for the new habitat is provided only by a small number of individuals , which happen to arrive in the unexplored territory first . in many species , the genetic footprints of these _ pioneers _ are still recognizable today and provide information about the migrational history of the species . </S>",
    "<S> for instance , a frequently observed south - north gradient in genetic diversity ( `` southern richness to northern purity ''  @xcite ) on the northern hemisphere is thought to reflect the range expansions induced by the glacial cycles . in the case of humans , </S>",
    "<S> the genetic diversity decreases essentially linearly with increasing geographic distance from africa  @xcite , which is indicative of the human migration out of africa . </S>",
    "<S> it is hoped  @xcite , that the observed patterns of neutral genetic diversity can be used to infer details of the corresponding colonization pathways .    </S>",
    "<S> such an inference requires an understanding of how a colonization process generates a gradient in genetic diversity , and which parameters chiefly control the magnitude of this gradient . </S>",
    "<S> traditional models of population genetics  @xcite , which mainly focus on populations of constant size and distribution , apply to periods before and after a range expansion has occurred , when the population is at demographic equilibrium </S>",
    "<S> . however , the spatio - temporal dynamics in the transition period , on which we focus in this article , is less amenable to the standard analytical tools of population genetics , and has been so far studied mostly by means of simulations  @xcite . </S>",
    "<S> an analytical understanding is available only for a linear stepping stone model in which demes ( lattice sites ) are colonized one after the other , following deterministic logistic growth  @xcite or instantaneously  @xcite , in terms of recurrence relations .    </S>",
    "<S> recent computer studies suggest that the neutral genetic patterns created by a propagating population wave might be understood in terms of the mechanism of `` gene surfing ''  @xcite : as compared to individuals in the wake , the pioneers at the colonization front are much more successful in passing their genes on to future generations , not only because their reproduction is unhampered by limited resources but also because their progeny start out from a good position to keep up with the wave front ( by means of mere diffusion ) . </S>",
    "<S> the offspring of pioneers thus have a tendency to become pioneers of the next generation , such that they , too , enjoy abundant resources , just like their ancestors . </S>",
    "<S> therefore , pioneer genes have a good chance to be carried along with the wave front and attain high frequencies , as if they `` surf '' on the wave . </S>",
    "<S> thus , the descendents of an individual sampled from the tip of the wave have a finite probability to take over the wave front . in this case of `` successful surfing '' , further colonization will produce only descendents of the relevant pioneer because the wave front has been `` fixed '' . </S>",
    "<S> the process of fixation at the front of a one - dimensional population wave is illustrated in fig  [ fig : labeled - wave ] .        </S>",
    "<S> the present study hinges on the question as to _ where _ </S>",
    "<S> lineages that reach fixation originate within the wave front . </S>",
    "<S> clearly , the probability of successful surfing must increase with the proximity to the edge of the wave  @xcite . on the other hand , more surfing _ attempts _ originate from the bulk of the wave where the population density is larger . </S>",
    "<S> we show that , due to this tradeoff , the origins of successful lineages have a bell - like distribution inside the wave front . </S>",
    "<S> furthermore , this ancestral probability distribution , together with the population - density profile of the population wave itself , is found to control the observable gradients in genetic diversity . </S>",
    "<S> the genetic pattern directly behind the moving colonization front turns out to mimic that of a small well - mixed ( _ panmictic _ ) population . </S>",
    "<S> the _ effective _ size @xmath0 of this population `` bottleneck '' is shown to be _ smaller _ than the typical number of individuals in the colonization front and very sensitive to the growth conditions in the very tip of the front . </S>",
    "<S> colonization fronts in which individuals need to be accompanied by others in order to grow ( _ allee _ effect  @xcite ) have a much larger effective population size than those in which individuals grow even if they are isolated from the rest .    </S>",
    "<S> the outline of the paper is as follows . </S>",
    "<S> we first introduce a stochastic computer model that we use to generate both _ pulled _ and _ pushed _ one - dimensional colonization waves . </S>",
    "<S> tracer experiments within this model are then used to reveal the probability distribution of successful surfers and the decrease of genetic differentiation at the colonization front . </S>",
    "<S> our succeeding theoretical treatment reveals to what extent both measures are related , and how they can be predicted for continuous models with quasi - stationary demography . after a comparison between theory and simulations , </S>",
    "<S> we discuss the significance of our results in the light of inferring past range expansions from spatially resolved genetic data . </S>"
  ]
}