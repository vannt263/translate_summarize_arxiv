{
  "article_text": [
    "suppose that a sorting algorithm , knowingly or unknowingly , uses element comparisons that can err .",
    "considering sorting algorithms based solely on binary comparisons of the elements to be sorted ( algorithms such as insertion sort , selection sort , quicksort , and so on ) , what problems do we face when those comparisons are unreliable ?",
    "for example , @xcite gives a clever @xmath0 algorithm to assure , with probability @xmath1 , that a putatively sorted sequence of length @xmath2 is truly sorted .",
    "but knowing the structure of the ill - sorted output would likely make error checking easier .",
    "also , in situations in which a reliable comparison is the fruit of a long process , one could chose to interupt the comparison process , thus trading reliability of comparisons ( and quality of the output ) for time . as a first step in order to understand the consequences of errors , we propose to analyze the number of inversions in the output of a sorting algorithm ( we choose quicksort @xcite ) subject to errors .",
    "we assume throughout this paper that the elements of the sequence @xmath3 to be sorted are distinct .",
    "we assume further that the only comparisons subject to error are those made between elements being sorted ; that is , comparisons among indices and so on are always correct .",
    "errors in element comparisons are random events , spontaneous and independent of each other , of position , and of value , with a common probability @xmath4 , @xmath2 being the length of the list to be sorted .",
    "the number of inversions in the output sequence @xmath5 is denoted @xmath6 we assume that the input list is presented in random order , each of the @xmath7 random orders being equiprobable .",
    "finally we denote by @xmath8 the random number of inversions in the output sequence of quicksort subject to errors .",
    "our result is , roughly speaking , @xmath9 when @xmath10 , meaning that @xmath11 converges to some nondegenerate probability distribution .",
    "the  surprise \" , not so unexpected after the fact , is that there are phase changes in the limit law , depending on the asymptotic behaviour of @xmath12 .",
    "the organization of this paper is as follows : the results are stated in section [ s : results ] . in section [ functequns ]",
    ", we establish a general distributional identity for @xmath8 . in the remaining sections , we prove convergence results for @xmath8 when :    * @xmath13 , @xmath14 , * @xmath4 vanishes more slowly than @xmath15 , * @xmath16 where @xmath17 is a positive constant .",
    "the case @xmath18 is different and not treated in detail ; see remark [ r : toosmall ] . in section [ fixedpts ]",
    ", we establish a general result of convergence using contraction methods ( cf .",
    "@xcite ) , and we use it in section [ proofth1 ] , for the first two cases .",
    "these methods do not apply for case @xmath19 , which requires poissonization ( see section [ proofth3 ] , where we use an embedding of quicksort in a poisson point process ) .",
    "set @xmath20 we will always let @xmath21 denote a random variable that is uniformly distributed on @xmath22 $ ] . also , @xmath23 shall denote the set of positive integers , and @xmath24 the set of nonnegative integers .",
    "[ p = c ] if @xmath27 , @xmath28 $ ] , then @xmath29 converges in distribution to a random variable @xmath30 whose distribution is characterized as the unique solution with finite mean of the equation @xmath31",
    "^ 2x_c+[(2c-1)u+1-c]^2\\widetilde{x}_c+t(c , u),\\end{aligned}\\ ] ] in which @xmath32 denotes a copy of @xmath30 , @xmath33 are independent , and @xmath34 furthermore , @xmath35}= \\frac{2-c}{2(1 + 2c-2c^2)},\\ ] ] and",
    "@xmath36    as usual with laws related to quicksort , see e.g.@xcite , @xmath37 is approximately the position of the pivot of the first step of the algorithm . as in standard quicksort recurrences , the coefficients of @xmath30 and of its independent copy @xmath38 are related to the sizes of the two sublists on the left and right of the pivot , sizes respectively asymptotic to @xmath39 and @xmath40 .",
    "the toll function @xmath41 is approximately @xmath42 times the number of inversions created in the first step : @xmath43 is approximately the number of inversions of the @xmath44 elements , smaller than the pivot but misplaced on the right of it , with the @xmath45 elements smaller than the pivot , that are placed , as they should be , on the left ; @xmath46 is the number of inversions between misplaced elements from the two sides of the pivot .",
    "the toll function @xmath41 depends on only one of the two sources of randomness ( the randomly ordered input list , and the places of the errors ) , viz . ,  the first one , through @xmath21 .",
    "the second source of randomness is killed by the law of large numbers : in the average , each of the @xmath47 misplaced numbers from the right of the pivot produces inversions with one half of the @xmath48 elements smaller than the pivot , that are placed , as they should be , on the left . as opposed to the other values of @xmath49 , the choices @xmath50 and @xmath51 lead to deterministic @xmath52 , without any surprise : for @xmath53 the output sequence is a random uniform permutation , with a number of inversions concentrated around @xmath54 ( * ? ? ?",
    "5.1.1 ) ; for @xmath55 the output sequence is decreasing , and has @xmath56 inversions .",
    "[ npinfini ] if @xmath59 and @xmath60 , @xmath29 converges in distribution to a random variable @xmath61 whose distribution is characterized as the unique solution with finite mean of the equation @xmath62 in , @xmath63 denotes a copy of @xmath61 and @xmath64 are independent .",
    "furthermore , @xmath65}=1\\qquad\\text{and}\\qquad { \\textnormal{var}\\left(x\\right)}=\\frac{1}{12}.\\end{aligned}\\ ] ]    note that equation ( [ p = ode1 ] ) is just ( [ p = ode1 ] ) specialized to @xmath66 , but , as opposed to @xmath67 , an additional condition , @xmath68 , is needed to ensure that the law of large numbers still holds .",
    "also , as another difference between ( [ p = ode1 ] ) and ( [ p = ode1 ] ) , for @xmath69 the errors do not change the sizes of the sublists in a significant way .",
    "the solution @xmath61 equals half the sum of the squares of the widths of the random intervals @xmath70 $ ] defined by ( [ recurrence_sur_u ] ) below .",
    "this is equivalent to the following statement :    [ propfindprocess ] the solution @xmath61 equals half the area @xmath71 under the find limit process @xmath72 .",
    "for both these claims , see remark [ r:1 ] .",
    "the find process was introduced in @xcite and is pictured at figure [ findprocess ] .",
    "assume that    * @xmath74 is a poisson point process with intensity @xmath17 on @xmath75 $ ] , meaning that , for each @xmath2 , @xmath76\\right)}\\vert$ ] is a poisson random variable with mean @xmath17 , and the second coordinates of points of @xmath74 are uniform on @xmath22 $ ] and independent ( see @xcite for a general definition of poisson point processes ) ; * @xmath77 is an array of independent uniform random variables on @xmath22 $ ] , independent of @xmath74 ; * the random variables @xmath78 are defined recursively by @xmath79 * for @xmath80 $ ] , @xmath81 if @xmath82 ,    and define , for @xmath83 , ( the sum is a.s .",
    "finite by lemma [ l : mean ] ) @xmath84    the variables @xmath85 describe a fragmentation process ( see @xcite for historical references ) : we start with @xmath86 and recursively break each interval into two at a random point ( uniformly chosen ) . in the @xmath87-th generation",
    "we thus have a partition of @xmath86 into @xmath88 intervals @xmath89 , @xmath90 , with @xmath91 .",
    "the interval of generation @xmath92 that contains @xmath93 is cut at step @xmath87 at the point @xmath94 .",
    "hence @xmath95 in is the distance from @xmath93 to this cut point .",
    "[ p=1/n ] if @xmath59 and @xmath96 , then @xmath29 converges in distribution to @xmath97 .",
    "the family @xmath98 of random variables satisfies the distributional identity : @xmath99 in which , conditionally given that @xmath100 , @xmath101 , @xmath102 and @xmath103 are independent , @xmath101 and @xmath102 are distributed as @xmath104 and @xmath105 , respectively , and @xmath106 in which @xmath107 is a poisson random variable with mean @xmath17 , the random variables @xmath108 are uniformly distributed on @xmath109 $ ] , and @xmath107 , and the @xmath108 s are independent . furthermore , @xmath110}=1 , \\qquad { \\textnormal{var}\\left(x({\\lambda})\\right)}=\\frac1{12}+\\frac1{3{\\lambda}}.\\end{aligned}\\ ] ]    [ remmesure ] the distributional identities , and really are equations for distributions , but it is more convenient to state them for random variables as done here . for to make sense ,",
    "i.e. in order to insure , for instance , that @xmath101 is a random variable , it is implicitly assumed that the random variables @xmath97 depend measurably on @xmath17 .",
    "thus a solution of is a family of probability measures @xmath111 on @xmath112 , such that there exists a family @xmath113 of random variables defined on the same probability space @xmath114 and satisfying the following properties :    1 .   for @xmath83 , @xmath115 is the distribution of @xmath116 , 2 .",
    "@xmath117 is a measurable process ( * ? ?",
    "1 ) , meaning that the mapping @xmath118 is measurable ,    and such that holds for @xmath117 .",
    "a measurable version of the stochastic process @xmath119 is defined at below ( measurability follows from ( * ? ? ?",
    "* rem . 1.14 ) ) .    for uniqueness , we need extra assumptions :",
    "let @xmath120 denote the class of families of distributions @xmath111 satisfying ( i ) and ( ii ) above , plus the condition :    1 .   for some @xmath121 , the function @xmath122}\\ ] ]",
    "is bounded on any bounded interval of @xmath123 .",
    "let @xmath124 denote the distribution of @xmath97 .",
    "we have    [ thm : unique ] the family @xmath125 is the unique solution of in @xmath120 .    we do not know whether the extra assumption ( iii ) is necessary . let us comment further on equation .",
    "writing @xmath126 and @xmath127 , we can thus rewrite as @xmath128 where @xmath129 is either the left or right endpoint of @xmath89 ( depending on whether @xmath130 is even or odd ) .",
    "note that , conditioned on the partitions @xmath131",
    ", i.e.=1000 on @xmath132 , each @xmath133 is a poisson process on @xmath89 with intensity @xmath17 , with the processes @xmath133 independent .",
    "since only the distribution of @xmath97 matters , we can by this conditioning and an obvious symmetry of the poisson processes @xmath133 just as well let @xmath129 in be the left endpoint of @xmath89 for every @xmath87 and @xmath130 .",
    "let @xmath134 be a poisson process on @xmath135\\times(0,\\infty)$ ] with intensity @xmath25 , and let @xmath136 , @xmath137 .",
    "( this is a pure jump lvy process with lvy measure @xmath138 } dt$ ] . )",
    "let @xmath139 be independent copies of this process , independent of @xmath140 .",
    "a scaling argument shows that can be written @xmath141    [ r:1 ] let @xmath142 .",
    "then @xmath143 satisfies , so that @xmath143 is the limit variable @xmath61 in theorem [ npinfini ] .",
    "( @xmath61 is a.s .",
    "finite and has finite mean by lemma [ l : erika ] . )",
    "moreover , the find limit process @xmath72 in @xcite is defined by @xmath144 ; hence @xmath145 .",
    "this justifies proposition [ propfindprocess ] .    moreover , by the law of large numbers , @xmath146 as @xmath147 .",
    "it follows ( by dominated convergence using lemma [ l : erika ] ) that for the special version of @xmath97 defined at @xmath148 and hence @xmath97 converges to @xmath61 in distribution as @xmath147 .    in this third case",
    ", we have a system of equations involving an infinite family of laws , and we could not adapt the contraction method : we rather use a poissonization . the phase transition from ( [ p = ode1 ] ) to ( [ functional1 ] )",
    "is explained easily : instead of a number of errors @xmath149 , we have now @xmath150 errors at each step , and the law of large numbers does not hold anymore for the number of inversions produced by step 1 .",
    "actually the number @xmath107 of errors at the first step is asymptotically poisson distributed , and the @xmath107 errors are at positions @xmath151 , approximately uniformly distributed on @xmath22 $ ] .",
    "thus , the number of inversions caused by this first step is approximately @xmath152    actually we prove a stronger theorem in each of the three cases , as we prove convergence of laws for the wasserstein @xmath153 metric @xcite .",
    "it entails convergence of the first moment .",
    "the convergence of higher moments is an open problem .",
    "as we shall see in section [ proofth3 ] , the distribution tail @xmath154 decreases exponentially fast ( theorem [ tail ] ) .",
    "[ r : toosmall ] when @xmath18 very slowly , that is @xmath155 , we conjecture that @xmath156 converges in distribution to @xmath157 , with the consequence that @xmath158 , for any positive @xmath159 . actually , the main contribution to @xmath8 comes from the `` first '' error , in some sense .",
    "when @xmath160 , the probability that no error occurs has a positive limit : we conjecture that , conditionally given the occurence of at least one error , the situation is similar to the previous case , that is , @xmath161 converges in distribution to a random variable with values in @xmath162 . when @xmath163 , @xmath164 .",
    "[ r : filter ] finally , we would like to stress that in the proof of convergence for one the three regimes considered in this section , we have to deal simultaneously with any sequence @xmath165 converging to @xmath166 according to this regime .",
    "this can be observed on the key equation , for instance , in which we would like to argue , roughly speaking , that if @xmath12 is close to @xmath166 according to a given regime , then @xmath167 and @xmath168 are also close to @xmath166 according to the same regime , with a large probability : here the same probability @xmath4 is associated to three different integers , @xmath2 , @xmath169 and @xmath170 , that denote the sizes of the input list , and of the two sublists formed at the first step of quicksort , respectively .",
    "thus @xmath4 can not be seen as a sequence indexed by @xmath2 . in order to allow such a loose relation between @xmath2 and @xmath4 , filters turn out to be more handy than sequences ( see ( * ? ? ?",
    "convergences in the three regimes are thus understood as convergences along the three corresponding filters ( see theorem [ th de convergence ] ) .",
    "at the first step quicksort compares all elements of the input list with the first element of the list ( usually called _ pivot _ ) .",
    "all items less ( resp .",
    "larger ) than the pivot are stored in a sublist on the left ( resp .",
    "right ) of the pivot .",
    "comparisons are not reliable , therefore @xmath171 items that should belong to the left sublist are wrongly stored in the right sublist , and @xmath172 items larger than the pivot are misplaced in the left sublist .",
    "since its items are chosen randomly , the input list is a random permutation and the true rank of the pivot can be written @xmath173 , where @xmath21 is uniformly distributed on @xmath22 $ ] and @xmath174 is the ceiling of @xmath93 . also , conditionally given @xmath21 , @xmath171 ( resp .",
    "@xmath172 ) is a binomial random variable with parameters ( @xmath175 , @xmath4 ) ( resp .",
    "( @xmath176 , @xmath4 ) ) .",
    "quicksort with error is then independently applied on the left sublist @xmath177 and on the right sublist @xmath178 and new errors occur , ultimately producing two new sublists @xmath179 and @xmath180 . set @xmath181 so that @xmath169 ( resp .",
    "@xmath170 ) is the size of @xmath177 and @xmath182 ( resp .",
    "@xmath178 and @xmath180 ) .",
    "in order to enumerate the inversions of the output list , we introduce a _ purely fictitious _",
    "error - correcting algorithm that parallels the implementation of quicksort : this fictitious error - correcting algorithm has two recursive steps ,    * first , the error - correcting algorithm corrects the sublists @xmath183 ( resp .",
    "@xmath180 ) at costs @xmath184 ( resp .",
    "@xmath185 ) ) , producing two increasing sublists @xmath186 and @xmath187 . note that @xmath188 and @xmath189 are conditionally independent , given @xmath190 .",
    "furthermore , the two sublists @xmath177 and @xmath178 obtained at the end of step @xmath25 are in uniform random order before the second step of quicksort , so that , conditionally given @xmath190 , cost @xmath188 ( resp .",
    "@xmath189 ) is distributed as @xmath191 ( resp .",
    "@xmath192 ) .",
    "* then the error - correcting algorithm corrects the errors of step @xmath25 , at a cost @xmath193 . here",
    "@xmath194 stands for the list obtained when one puts @xmath195 , the pivot and @xmath196 side by side .",
    "the number of inversions @xmath197 in the list @xmath194 is analyzed in detail at the end of this section .",
    "[ 2sublists0 ]     +    these two steps lead to the following equation for @xmath8 : @xmath198 where @xmath199 .",
    "we shall obtain the asymptotic distribution of @xmath197 , and as a consequence ( [ eq en i ] ) will translate , after renormalisation , into a distributional identity satisfied by the limit law of @xmath200 .",
    "the limit law appears on both sides of the distributional identity , as expected , due to the recursive structure of quicksort , and is thus characterized as the fixed point of some transformation .      at the end of the first step of the error - correcting algorithm",
    ", we obtain two subarrays @xmath201 and @xmath196 , left and right of the pivot ( cf .",
    "figure [ 2sublists ] ) . they are sorted in increasing order but there are @xmath172 ( red ) elements larger than the pivot just to its left and @xmath171 ( green ) elements smaller than the pivot element just to its right .",
    "thus , the only misplaced elements that the proofreader must correct in step 2 are clustered around the pivot .    [ 2sublists ]     and @xmath196.,width=453 ]    in order to sort the list , the red and green sublists must be exchanged .",
    "this requires @xmath202 inversions .",
    "we get therefore two unsorted lists @xmath203 and @xmath204 each composed of two sorted sublists . all items of @xmath205 ( resp .  of @xmath204 )",
    "are now smaller ( resp .",
    "larger ) than the pivot , so that the length of @xmath203 ( resp .  of @xmath204 ) is @xmath175 ( resp .",
    "@xmath176 ) . it remains to sort @xmath203 and @xmath204 , at respective costs @xmath206 and @xmath207 that are conditionally independent given @xmath21 , leading to : @xmath208      let @xmath210 be the number of inversions in a list of @xmath211 elements sorted as follows : each element is painted black ( white ) with probability @xmath4 ( resp .",
    ". then the black and white sublists are separately sorted in increasing order and the two sorted sublists are placed side by side , producing a new list @xmath213 with @xmath211 elements .",
    "we have    [ invb&w ] let @xmath214 be @xmath211 independent bernoulli random variables with the same parameter @xmath4 , and let @xmath215 .",
    "then @xmath216    let us abbreviate @xmath217 to @xmath218 . among the @xmath219 s ,",
    "let @xmath220 denote the @xmath218 random variables equal to @xmath25 , @xmath221 those equal to @xmath222 , with @xmath223 and @xmath224 .",
    "now @xmath210 can be seen as the number of inversions of the list @xmath225 . in order to move the numbers @xmath226 ( @xmath227 ) to the correct position , the proofreader corrects inversions with each of the @xmath228 elements of @xmath229 that are smaller than @xmath226 and do not belong to @xmath230 .",
    "thus @xmath231 leading to the result .    with the help of proposition [ invb&w ] , we can give a useful description of the distribution of @xmath232 and @xmath233 :    [ description ] conditionally given that the length of @xmath205 is @xmath234 , @xmath232 and @xmath233 are independent and distributed as @xmath235 and @xmath236 , respectively .    to sum up the results of this section , renormalizing ( [ eq en i ] ) , one obtains a distributional identity satisfied by @xmath237 : @xmath238 in which @xmath239 and    * @xmath21 is a uniform random variable on @xmath22 $ ] , and @xmath173 is the position of the pivot , * conditionally given @xmath240 , @xmath232 and @xmath233 are distributed as in proposition [ description ] , * @xmath241 , @xmath242 are two independent sequences with the same ( unknown ) distribution , independent of @xmath243 , and therefore of @xmath244 .",
    "the errors having a balancing effect : @xmath199 has the same mean , @xmath245 , and a smaller variance than @xmath246 .",
    "we prove this in the following form .",
    "[ l:2 ] @xmath247 } & \\le { \\mathbb{e}\\left[({\\lceilnu\\rceil}-1)^2+(n-{\\lceilnu\\rceil})^2\\right ] } = \\frac{(n-1)(2n-1)}{3 } \\\\ & \\le \\frac23 n^2.\\end{aligned}\\ ] ]    the left hand side is the expected number of ordered pairs @xmath248 that end up on a common side of the pivot .",
    "this happens if @xmath249 and @xmath130 originally are on the same side of the pivot and we either compare both correctly or make errors for both of them , or if they are on opposite sides of the pivot and we make an error for exactly one of them . hence @xmath247 } = { \\bigl(p^2+(1-p)^2\\bigr ) } { \\mathbb{e}\\left[({\\lceilnu\\rceil}-1)^2+(n-{\\lceilnu\\rceil})^2\\right]}\\quad&\\\\    { } + 2p(1-p)2 { \\mathbb{e}\\left[({\\lceilnu\\rceil}-1)(n-{\\lceilnu\\rceil})\\right ] } & \\\\ = { \\mathbb{e}\\left[({\\lceilnu\\rceil}-1)^2+(n-{\\lceilnu\\rceil})^2\\right ] } -2p(1-p ) { \\mathbb{e}\\left[({\\lceilnu\\rceil}-1-(n-{\\lceilnu\\rceil}))^2\\right]}\\qquad & \\end{aligned}\\ ] ] which proves the first inequality . the rest is a simple calculation .",
    "let us say that an element @xmath250 of the list , or the comparison in which @xmath250 plays the rle of pivot , has depth @xmath87 if @xmath250 experiences @xmath92 comparisons before playing the rle of pivot .",
    "we assume in this section that any comparison with depth @xmath251 is performed after the last comparison with depth @xmath87 .",
    "we call step @xmath87 the set of comparisons with depth @xmath87 , and we let @xmath252 denote the number of inversions created at step @xmath87 , that is , the total number of inversions , in the output , between elements that are still in the same sublist before step @xmath87 , but are not in the same sublist after step @xmath87",
    ". we shall need the following bound :    [ l : boundk ] for every @xmath253 , @xmath254}\\le \\frac12 { \\left(\\frac23\\right)}^k n^2p.\\ ] ]    for @xmath255 , @xmath256 , and a simple calculation yields @xmath257}&= p\\frac{(n-1)(n+1)}{3}-p^2\\frac{(n-1)(n-2)}{6 } \\le    \\frac13 n^2p.\\end{aligned}\\ ] ]    for @xmath258 we find by induction , conditioning on the partition in the first step , @xmath254 } \\le { \\mathbb{e}\\left [ \\frac12 { \\left(\\frac23\\right)}^{k-1 } ( z_{n , p}-1)^2p + \\frac12 { \\left(\\frac23\\right)}^{k-1 }   ( n - z_{n , p})^2p \\right]}\\ ] ] and the result follows by lemma [ l:2 ] .    [ bound ] set @xmath259}$ ]",
    ". then @xmath260    by lemma [ l : boundk ] , @xmath261 .",
    "the proofs of the first two cases are examples of the contraction method @xcite : on one hand we have more or less explicitly defined random variables @xmath262 , @xmath263 , and @xmath264 , and we know how to prove directly that they converge to @xmath265 , @xmath266",
    ". on the other hand , we have a family @xmath29 of random variables defined by induction : @xmath267 and a random variable @xmath61 implicitly defined by the distributional identity @xmath268 in which , in some sense , @xmath269 .",
    "then , under additional technical conditions , the convergence of the `` coefficients '' @xmath262 , @xmath264 , entails the convergence of the `` solution '' @xmath29 .",
    "one has to prove existence and unicity of the solutions , usually as fixed points of contracting transformations in a subspace of the space of probability measures , with a suitable metric .",
    "in the case we are interested in , ( [ masterequ1 ] ) holds and :    * @xmath270 is a fixed positive integer ; * @xmath271 is a given random vector for each @xmath272 ; * @xmath273 $ ] ; * the families @xmath274 , @xmath275 , are i.i.d .  and independent of @xmath276 , and and @xmath277 .    given such @xmath276 we thus define , for any distributions @xmath278 , @xmath279 when , as above , the families @xmath280 , @xmath275 , are i.i.d .  and independent of @xmath276 , and further @xmath281 has the distribution @xmath282",
    ". thus ( [ masterequ1 ] ) can be written @xmath283    for ( [ masterequ2 ] ) we similarly assume    * @xmath284 is a given random vector ; * the variables @xmath285 , @xmath275 are i.i.d .  and independent of @xmath286 , and @xmath287 .",
    "given such @xmath286 we define @xmath288 when the variables @xmath285 , @xmath275 are i.i.d .  with distribution @xmath289 and independent of @xmath286 .",
    "then ( [ masterequ2 ] ) can be written @xmath290    let @xmath291 be the space of probability measures @xmath292 on @xmath293 such that @xmath294 .",
    "the space @xmath291 is endowed with the wasserstein metric @xmath295 in which @xmath289 and @xmath296 denote the distribution functions of @xmath292 and @xmath297 , @xmath298 ( resp .",
    "@xmath299 ) denote the generalized inverses of @xmath289 and @xmath296 and , as in previous sections , @xmath21 is a uniform random variable @xcite . since @xmath300 ( resp .",
    "@xmath301 ) has distribution @xmath292 ( resp .",
    "@xmath297 ) , the infimum is attained in relation ( [ metric ] ) .",
    "the metric @xmath153 makes @xmath291 a complete metric space .",
    "convergence of @xmath302 to @xmath303 in @xmath291 is equivalent to convergence of @xmath304 to @xmath61 in distribution _ and _ @xmath305}={\\mathbb{e}\\left[|x|\\right]}.\\ ] ] therefore convergence in @xmath291 entails @xmath306}={\\mathbb{e}\\left[x\\right]}.\\ ] ] we refer to @xcite for an extensive treatment of wasserstein metrics . in what follows , we shall improperly refer to the convergence of @xmath304 to @xmath61 in @xmath291 , meaning the convergence of their distributions .",
    "let us take care first of relation ( [ masterequ2 ] ) :    [ pointfixe ] if @xmath307}<1 $ ] and @xmath308}<\\infty$ ] , then @xmath309 is a strict contraction and ( [ masterequ2 ] ) has a unique solution in @xmath291 .",
    "let @xmath310 be a coupling of random variables , with laws @xmath292 and @xmath297 , respectively , such that @xmath311}= d_1(\\mu,\\nu).\\ ] ] let @xmath312 be @xmath270 independent copies of @xmath310 .",
    "furthermore , assume that @xmath286 and @xmath312 are independent",
    ". then the probability distribution of @xmath313 is @xmath314 ( resp .",
    "@xmath315 ) and @xmath316}\\\\ & \\le&d_1(\\mu,\\nu)\\ \\sum_{i=1}^i{\\mathbb{e}\\left[\\big|a^{(i)}\\big|\\right]}.\\end{aligned}\\ ] ] thus @xmath309 is a contraction with contraction constant smaller than 1 .",
    "since @xmath291 is a complete metric space , this implies that @xmath309 has a unique fixed point in @xmath291 , by banach s fixed point theorem .",
    "we prove now a theorem which is a variant of those used by the previously cited authors : the difference is not deep , but here we deal with family of laws , not sequences , as we have two parameters , @xmath2 and @xmath4 . as a consequence , to cover theorems [ p = c ] and [ npinfini ] , it will be convenient in their proofs to consider convergence with respect to a _",
    "_ @xmath317 on @xmath318 $ ] , see ( * ? ? ?",
    "* chap . 1 ) .",
    "the collection of sets @xmath319}\\cap\\left[0,1\\right ] ) , \\hspace{1 cm } n\\ge 0,\\ \\varepsilon>0,\\ ] ] is a basis for the filter @xmath320 corresponding to theorem [ p = c ] , while @xmath321 is a basis for the filter @xmath322 corresponding to theorem [ npinfini ] .    [ th de convergence ] suppose that holds for @xmath323 and @xmath324 ; i.e.@xmath325 for @xmath323 and @xmath326 , where @xmath327 . if    * @xmath328}\\right)}_{n , p}$ ] is bounded , * @xmath307}<1,$ ] * @xmath329@xmath330 * @xmath331 } = 0,\\qquad\\forall v\\in\\mathcal f,$ ]    then @xmath29 converges in distribution to @xmath289 , the unique solution of the equation @xmath332 in @xmath291 .",
    "more precisely , @xmath333 along @xmath317 .",
    "we need a lemma before proving theorem [ th de convergence ] .",
    "[ lemme rosler ] assume that three families of nonnegative numbers @xmath334 , @xmath335 , and @xmath336 satisfy the inequalities : @xmath337 let @xmath317 be a filter . under the following assumptions :    * @xmath338 is nonnegative and bounded , * for some @xmath339 and some @xmath340 , @xmath341 , * @xmath342 , * @xmath343    we have @xmath344    the proof is a variant of the proof of ( * ? ? ?",
    "* proposition 3.3 ) .",
    "let @xmath345 be a bound for @xmath338 , and let @xmath346 for any @xmath347 , let @xmath348 be such that for @xmath349 , @xmath350 then for @xmath351 we have @xmath352 taking lim sups , we obtain that for any @xmath347 , @xmath353 thus @xmath354 , and so @xmath355 .",
    "we can choose @xmath285 and the family @xmath356 in such a way that @xmath357}=d_1(g_{k , p},f),\\ ] ] and we can also choose the families @xmath358 to be i.i.d . then @xmath359}\\\\ & \\leq\\sum_{k=0}^{n-1 } { \\mathbb{e}\\left[\\sum_{i=1}^{i}\\big|a_{n , p}^{(i)}\\bbone_{z_{n , p}^{(i)}=k}\\big|\\right ] } { \\mathbb{e}\\left[\\big|x_{k , p}^{(i)}-x^{(i)}\\big|\\right ] } + b_{n , p}\\\\ & \\leq\\sum_{k=0}^{n-1}\\gamma_{k , n , p}\\,d_1(g_{k , p},f)+b_{n , p}\\end{aligned}\\ ] ] with @xmath360}+{\\mathbb{e}\\left[{\\left|t_{n , p}-t\\right|}\\right]},\\\\ \\gamma_{k , n , p}&=&\\sum_{i=1}^{i}{\\mathbb{e}\\left[\\big|a_{n , p}^{(i)}\\big| \\bbone_{z_{n , p}^{(i)}=k}\\right]}.\\end{aligned}\\ ] ] let @xmath345 be a bound for @xmath328}\\right)}_{n , p}$ ] , and set @xmath361 let us check the assumptions of lemma [ lemme rosler ] : @xmath362}+{\\mathbb{e}\\left[x\\right]}\\le m + { \\mathbb{e}\\left[x\\right]}\\ ; \\ ] ] for the second assumption of lemma [ lemme rosler ] , @xmath363 } = \\sum_{i=1}^{i}{\\mathbb{e}\\left[\\big|a^{(i)}\\big|\\right]}<1\\ ; \\ ] ] @xmath364 by assumption iii ) , as @xmath365}&=&{\\mathbb{e}\\left[x\\right]}\\sum_{i=1}^{i}{\\mathbb{e}\\left[\\big|a^{(i)}_{n , p}-a^{(i)}\\big|\\right]}\\ ; \\end{aligned}\\ ] ] finally @xmath366}.\\ ] ] therefore @xmath367 vanishes along @xmath317 and the proof of the theorem is now complete .",
    "the following theorem is folklore .",
    "it gives the means and variances in theorems [ p = c ] and [ npinfini ] , after some computations .",
    "[ usefulthmaboutvariance ] suppose that holds , where @xmath368}<1 $ ] and @xmath369}<\\infty$ ] ; in other words , @xmath370 , where @xmath289 is the unique solution in @xmath291 to @xmath332 . then @xmath371 } = \\frac{{\\mathbb{e}\\left[t\\right]}}{1-\\sum_i { \\mathbb{e}\\left[a^{(i)}\\right]}}.\\ ] ]    moreover , if further @xmath372}<1 $ ] and @xmath373}<\\infty$ ] , then @xmath374}<\\infty$ ] and @xmath375}+ 2\\,{\\mathbb{e}\\left[x\\right ] } { \\mathbb{e}\\left[t\\sum_i a^{(i)}\\right ] } + { \\mathbb{e}\\left[{\\left(\\sum_i a^{(i)}\\right)}^2 - 1\\right]}({\\mathbb{e}\\left[x\\right]})^2 } { 1-\\sum_i { \\mathbb{e}\\left[a^{(i)\\,2}\\right]}}.\\ ] ]    taking expectations in ( [ masterequ2 ] ) we obtain @xmath376}= \\sum_i { \\mathbb{e}\\left[a^{(i)}\\right ] } { \\mathbb{e}\\left[x\\right ] } + { \\mathbb{e}\\left[t\\right]}$ ] , which yields ( [ noel ] ) .",
    "for the second part , let @xmath377},\\ , \\int x^2\\,d\\mu(x)<\\infty\\}$ ] .",
    "it is easy to see that now @xmath309 is a strict contraction in @xmath378 with the @xmath379 metric ; hence @xmath309 has a unique fixed point in @xmath378 . since @xmath380 , this fixed point",
    "must be @xmath289 , which shows that @xmath374 } < \\infty$ ] .",
    "if we square and take the expectation , we obtain @xmath381 } & = { \\mathbb{e}\\left[\\sum_{i=1}^i a^{(i)\\,2}\\right ] } { \\mathbb{e}\\left[x^2\\right ] } + \\sum_{1\\le i\\neq j\\le i } { \\mathbb{e}\\left[a^{(i)}a^{(j)}\\right ] } ( { \\mathbb{e}\\left[x\\right]})^2\\\\ & \\hspace{3.5cm}+ 2 \\sum_{i=1}^i { \\mathbb{e}\\left[a^{(i)}t\\right ] } { \\mathbb{e}\\left[x\\right ] } + { \\mathbb{e}\\left [ t^2\\right]},\\end{aligned}\\ ] ] which yields .",
    "we apply theorem [ th de convergence ] to the distributional identity ( [ eq en x ] ) , with @xmath382 , @xmath383 and @xmath384 here the distribution of @xmath385 does not depend on @xmath249 .",
    "we verify the assumptions ii)iv ) of theorem [ th de convergence ] for theorems [ p = c ] and [ npinfini ] together ; for the second theorem take @xmath66 .",
    "the first assumption holds true by proposition [ bound ] .",
    "we have @xmath386 ^ 2,\\\\ a^{(2)}&=b=[(2c-1)u+1-c]^2,\\end{aligned}\\ ] ] and @xmath387 $ ] .",
    "easy computations give @xmath388 ^ 2\\right]}+{\\mathbb{e}\\left[[(2c-1)u+1-c]^2\\right]}=\\frac23(1-c+c^2)\\le \\frac 23.\\ ] ]      we must prove the convergence of @xmath389 , @xmath390 and @xmath264 to @xmath391 , @xmath392 and @xmath41 , in @xmath393 . recall .    from proposition [ description ] we know that , conditioned on @xmath21 , @xmath394 and thus @xmath395 hence , taking the expectation , @xmath396 and thus @xmath397 consequently , @xmath398 and , similarly but more sharply , @xmath399 similarly , @xmath400 and @xmath401    from , and follows @xmath402 it follows easily from cauchy ",
    "schwarz s inequality that multiplication is a continuous bilinear map @xmath403 .",
    "hence yields @xmath404 verifying the first assertion .",
    "similarly implies @xmath405 too .    for @xmath264",
    "we first observe that , similarly , from and , @xmath406 moreover , since @xmath407 , and imply @xmath408 and @xmath409 .    for the terms @xmath206 and",
    "@xmath410 we use proposition [ invb&w ] .",
    "we have @xmath411 and thus , uniformly for @xmath412 , @xmath413 which , using cauchy ",
    "schwarz again , yields @xmath414 moreover , let @xmath415 . then @xmath416 and @xmath417 and thus @xmath418    proposition [ invb&w ] now yields , by and , uniformly for @xmath419 , @xmath420 consequently , using proposition [ description ] , @xmath421 collecting the various terms above , we find @xmath422 .",
    "as already noticed at the beginning of the section , the distribution of @xmath423 does not depend on @xmath424 , so in order to prove the two theorems , we only have to check that the fourth assumption holds for @xmath425 , for an arbitrary set in each of the two filters : @xmath426 } = 0 , \\qquad \\forall v\\in\\mathcal f_i , \\forall i\\in\\{1,2\\ } ; \\ ] ] also , the expectation on the left hand side of ( [ equation_filter ] ) is decreasing in @xmath427 , so we need only to check ( [ equation_filter ] ) for typical elements of the filters basis . but for @xmath428 ( resp .   for @xmath429 ) , @xmath430 } & \\le { \\left(\\frac{n-1}n\\right)}^2,\\\\ { \\mathbb{e}\\left[\\big|a_{n , p}\\big|\\textrm { ; } ( z_{n , p},p)\\notin    \\widetilde v_{n,\\varepsilon}\\right ] } & \\le { \\left(\\frac{n}{np}\\right)}^2.\\end{aligned}\\ ] ]      the proof of these theorems is done in four steps :    1 .",
    "we prove that @xmath97 defined at ( [ def de i ] ) is almost surely finite , and has exponentially decreasing distribution tail .",
    "thus it has moments of all orders .",
    "2 .   with the help of a poisson point process representation of quicksort",
    ", we prove the convergence of certain copies of @xmath29 to a copy of @xmath97 for the norm @xmath431 .",
    "this entails the weak convergence .",
    "we prove that @xmath97 satisfies the functional equation ( [ functional1 ] ) , and that ( [ functional1 ] ) has a unique solution under the extra assumptions in theorem [ thm : unique ] .",
    "4 .   we compute the first and second moments of @xmath97 , as required for the proof of theorem [ p=1/n ] , and we also give an induction formula for moments of larger order .      in this section ,",
    "we prove some properties of the family of random variables @xmath432 defined by .",
    "recall that the increasing sequence @xmath433 , defined by the recurrence relation ( [ recurrence_sur_u ] ) , splits @xmath22 $ ] in @xmath88 intervals , obtained recursively by breaking each of the @xmath434 intervals of the previous step into two random pieces . for",
    "@xmath435 and @xmath436 , let @xmath437 we begin with a simple estimate ( see also @xcite ) :    [ l : erika ] @xmath438}= 3^{-k}$ ] .",
    "the length @xmath439 is the product of @xmath87 independent random variables , each uniform on @xmath22 $ ]",
    ". hence @xmath438}={\\left({\\mathbb{e}\\left[u^2\\right]}\\right)}^k=3^{-k}$ ] .",
    "[ bigg ] for @xmath440 , @xmath441 is a @xmath442-martingale , and @xmath443}=1 $ ] .",
    "clearly @xmath444}=1 $ ] . also :",
    "@xmath445 } & = { \\left(\\frac{1+\\alpha}2\\right)}^{k+1}\\sum_{i=1}^{2^k}{\\mathbb{e}\\left[w^{\\alpha}_{k+1,2i-1 } + w^{\\alpha}_{k+1,2i}|\\mathcal{f}_k\\right]}\\\\ & = { \\left(\\frac{1+\\alpha}2\\right)}^{k+1}\\sum_{i=1}^{2^k}w^{\\alpha}_{k , i } { \\mathbb{e}\\left[{u}_{k , i}^{\\alpha}+(1-{u}_{k , i})^{\\alpha}\\right]}\\\\ & = { \\left(\\frac{1+\\alpha}2\\right)}^{k}\\sum_{i=1}^{2^k}w^{\\alpha}_{k , i}.\\end{aligned}\\ ] ]    let @xmath446 denote the larger real solution of the equation @xmath447 .",
    "lemma [ bigg ] entails that    [ l : moment ] @xmath448}\\le \\rho^{k}$ ] .    clearly , @xmath449 thus , for @xmath450 , @xmath451}\\le\\left({\\mathbb{e}\\left[m_k^{\\alpha}\\right]}\\right)^{1/\\alpha}\\leq { \\left(\\frac2{1+\\alpha}\\right)}^{k/\\alpha}\\left({\\mathbb{e}\\left[f_{k,\\alpha}\\right]}\\right)^{1/\\alpha } = { \\left(\\frac2{1+\\alpha}\\right)}^{k/\\alpha}.\\ ] ] the rate @xmath452 reaches its minimum for @xmath453 , a constant that is an old friend of quicksort and binary search trees @xcite .",
    "this leads to the desired value for @xmath454 .    a weaker form of this inequality ( for @xmath455 ) , actually sufficient for our purposes ,",
    "is given in @xcite .",
    "the sequence @xmath441 is a specialization of martingales that are of a great use for the study of general branching random walks , see for instance @xcite , of which binary search trees are a special case @xcite .",
    "[ l : mean ] @xmath456}=1 $ ] .    set @xmath457 . inspecting",
    ", we see that @xmath458}=\\frac1 2\\   \\sum_{k\\ge 1}{\\left(\\frac23\\right)}^{k}f_{k,2},\\ ] ] because , conditionally given @xmath459 , the expected number of points of @xmath133 is @xmath460 and each of them has an expected contribution @xmath461 to @xmath97 .    as a consequence of lemma [ l :",
    "moment ] , we have    [ tail ] for each fixed @xmath462 , the distribution tail @xmath154 decreases exponentially fast .",
    "equivalently , we prove this result for @xmath463 . since @xmath464 we have @xmath465 where @xmath466 is a poisson random variable with mean @xmath17 .",
    "we split the tail of this bound on @xmath467 as follows : @xmath468 in which @xmath469 we have , by the standard chernoff bound for the poisson distribution , @xmath470 the last inequality holding only for @xmath471 .",
    "also @xmath472 using a markov first moment inequality to bound both terms . for any @xmath473 in @xmath162 , the choice @xmath474 leads to an exponential decrease of the tail .",
    "we assume that the input list for quicksort contains the integers @xmath475 in random order .",
    "we model our error - prone quicksort as follows using the variables @xmath476 and @xmath74 in section [ s : results ] , but with the intensity @xmath17 of @xmath74 replaced by @xmath477 :    in the first step , we use the pivot @xmath478 and let for each @xmath249 ( except the pivot ) there be an error in the comparison of @xmath249 and the pivot if @xmath479 \\neq\\emptyset$ ] .",
    "( recall that @xmath126 . )",
    "note that our choice of @xmath480 yields the right error probability @xmath4 .",
    "let @xmath481 be the position of the pivot after the first step .",
    "( this position was earlier denoted @xmath190 ; it may differ from @xmath482 because of errors . )",
    "the items of the left sublist will thus be placed in positions @xmath483 and those in the right sublist in positions @xmath484 .",
    "let @xmath485 and @xmath486 .",
    "when the @xmath87-th step begins , we have a set of @xmath434 sublists @xmath487 , the elements of @xmath488 being in positions @xmath489 , @xmath490 ( with the convention that the sublist is empty when @xmath491 ) . in each nonempty such sublist we choose as pivot the item with rank @xmath492 in this sublist , so that its position in the final output will be exactly @xmath493 in case no errors occurs while processing the sublist .",
    "we assume an error is made when comparing the element at position @xmath249 with the pivot @xmath494 if @xmath495 \\neq\\emptyset$ ]",
    ". let @xmath496 .",
    "let @xmath497 be the position of the pivot @xmath494 after the comparisons ( as in the first step , @xmath497 may differ from @xmath494 because of errors ) ; let @xmath498 if the sublist was empty .",
    "set @xmath499 we expect @xmath500 and @xmath501 to converge to @xmath85 as @xmath502 .",
    "this procedure ( stopped when there are no more nonempty sublists ) is an exact simulation of the erratic quicksort , so we may assume that @xmath8 is the number of inversions created by it .",
    "as in section [ functequns ] , let @xmath252 be the number of inversions created at step @xmath87 , so @xmath503    we will prove that , using the notation of , @xmath504 for each @xmath87 . since also , by lemmas [ l : boundk ] and [ l : erika ] , @xmath505 } + \\frac1{{\\lambda}(n , p ) } { \\mathbb{e}\\left[\\sum_{j=1}^{2^k } \\sum_{x\\in\\pi_{k , j}}|x - x_{k , j}|\\right]}\\\\ & = \\frac 1{n^2p } { \\mathbb{e}\\left[i^{(k)}(n , p ) \\right ] } + { \\mathbb{e}\\left [ \\frac12   \\sum_{j=1}^{2^k}w_{k , j}^2\\right ] } \\le { \\left(\\frac23\\right)}^k,\\end{aligned}\\ ] ] it follows by dominated convergence that , using , @xmath506 moreover , @xmath507 , and it follows easily from that @xmath508 .",
    "hence we have @xmath509 , which proves the convergence .",
    "it remains to verify .",
    "set @xmath510 relation is equivalent to @xmath511 for simplicity , we write in the sequel @xmath17 instead of @xmath480 .",
    "we begin with a lemma .",
    "[ ll ] for each @xmath87 and @xmath130 , @xmath512    recall that @xmath513 , so translates to @xmath514 we use induction on @xmath87 . comparing the definitions of @xmath85 and @xmath501",
    ", we see that it suffices to consider an odd @xmath515 , and in that case there are three sources of a difference :    1 .   the differences between @xmath516 and @xmath517 and between @xmath518 and @xmath519 .",
    "by the induction hypothesis , this contributes at most @xmath520 .",
    "2 .   the @xmath521 inside ( and the rounding by ) the ceiling function .",
    "this contributes at most @xmath15 .",
    "3 .   the shift of the pivot , from @xmath494 to @xmath497 , caused by the erroneous comparisons .",
    "the shift is bounded by the total number of errors at step @xmath87 , so its mean is less than @xmath17 , and the contribution is less than @xmath522 .",
    "we return to proving . for @xmath255",
    ", @xmath523 is just @xmath197 studied in section [ functequns ] , and yields @xmath524 let @xmath525 be the set of items @xmath249 such that an error was made in the comparison with @xmath482 .",
    "relation entails that @xmath526 we shall denote this last sum @xmath527 .",
    "thus , we have @xmath528 furthermore @xmath529}&=(m-1)p(1-p)+((m-1)p)^2\\le np+n^2p^2 . \\label{boundagain}\\end{aligned}\\ ] ] hence , @xmath530 moreover , @xmath531 differs from @xmath532 in in four ways only ( recall that @xmath533 ) :    1 .",
    "@xmath534 differs from @xmath93 by at most @xmath15 .",
    "since the expected number of terms is not larger than @xmath17 , this gives a contribution @xmath535 .",
    "2 .   @xmath536 , which by lemma [ ll ] has expectation @xmath535 .",
    "thus this too gives a contribution @xmath535 .",
    "if there are two or more points in @xmath479 $ ] for some @xmath249 , @xmath537 contains more terms than @xmath538 .",
    "it is easily seen that the expected number of such extra points in each interval @xmath539 $ ] is less than @xmath540 , and each point contributes at most 1 to @xmath537 .",
    "each point in @xmath541 $ ] contributes for an extra term in @xmath537 again .",
    "the expected number of such extra points is @xmath522 and each of these terms contributes at most 1 to @xmath537 .",
    "this verifies for @xmath255 .    for @xmath542",
    "we argue similarly .",
    "we can approximate @xmath252 by the sum of the distances between the errors and the respective pivots , @xmath543 as follows : let @xmath544 be the set of items @xmath545 subject to error when compared with @xmath546 , and let @xmath547 be the @xmath548-algebra generated by @xmath549 and @xmath550 .",
    "as for @xmath255 , using relation , we obtain the following bound : @xmath551 } & \\le \\sum_{j\\le 2^{k-1}}{\\left(p^2{\\left(\\#\\ell_{k-1,j}\\right)}^2+p\\#\\ell_{k-1,j}\\right)}\\\\ & \\le 2^{k-1}(n^2p^2+np ) = { \\mathcal o{\\left(1\\right)}},\\end{aligned}\\ ] ] and as a consequence , @xmath552    now , @xmath553 differs from @xmath554 in in the same four ways as for @xmath255 , plus an extra fifth way :    1 .",
    "see the case @xmath255 .",
    "2 .   @xmath555 , which by lemma [ ll ] has expectation @xmath535 .",
    "thus this too gives a contribution @xmath535 .",
    "3 .   two or more points in @xmath495 $ ] for some @xmath249 , see the case @xmath255 .",
    "each point in @xmath556 $ ] contributes for an extra term in @xmath557 .",
    "the expected number of such extra points is @xmath558 and each of these terms contributes at most 1 to @xmath557 .",
    "there is a new source of error in this approximation , because some points @xmath93 in @xmath559 and the corresponding positions @xmath560 belong to subintervals that do not correspond to each other , because the endpoints @xmath561 differ somewhat from @xmath562 . by lemma [ ll ] ,",
    "the expected number of such cases is @xmath535 , so again we get a contribution of order @xmath535 only .",
    "this verifies and thus the convergence of @xmath29 to @xmath97 .",
    "we check that @xmath97 satisfies the distributional identity and some side conditions needed for the computations of moments .",
    "[ ilexiste1 ] @xmath432 is a solution of .",
    "moreover , @xmath563}<\\infty$ ] and @xmath564}\\to0 $ ] as @xmath565 , for @xmath323 .",
    "all moments are finite by theorem [ tail ] .",
    "moreover , @xmath566}\\to0 $ ] as @xmath565 by and dominated convergence .    for @xmath567 ,",
    "let @xmath568 be a poisson point process of intensity @xmath17 on @xmath569 $ ] , and let @xmath570 be independent uniform random variables as in section [ s : results ] , and further independent of @xmath568 .",
    "define @xmath571 and @xmath572 as in section [ s : results ] , with the slight modification @xmath573 and set @xmath574 note that @xmath575 . shifting and rescaling @xmath568 , we obtain @xmath576",
    "let us split @xmath97 : we have @xmath577 we see , using general properties of poisson point processes and the recursive construction of @xmath571 , that @xmath578 in the sense that , conditionally given that @xmath579 , @xmath580 , @xmath581 and @xmath582 are independent and distributed as @xmath583 , @xmath584 , @xmath585 , respectively .",
    "also @xmath586 is uniformly distributed on @xmath22 $ ] .",
    "let @xmath111 and @xmath587 be two solutions of in @xmath120 .",
    "let @xmath113 and @xmath588 denote two measurable processes representing respectively @xmath292 and @xmath589 , in the sense of remark [ remmesure ] ( i ) . without loss of generality , we can assume that @xmath117 and @xmath72 share the same underlying probabilistic space , and the same exponent @xmath473 .",
    "then , by definition of @xmath120 , for @xmath590 , @xmath591}\\ ] ] is finite .",
    "let @xmath592 denote the infimum of @xmath593 over all couples of representations @xmath594 of @xmath292 and @xmath589 , lying on the same probabilistic space , and assume that @xmath595 .",
    "let @xmath596 be such a couple of representations , satisfying furthermore @xmath597 consider a probabilistic space on which are defined three _",
    "independent _ random variables @xmath598 , @xmath599 and @xmath21 , @xmath598 and @xmath599 being two copies of @xmath596 , @xmath21 being uniform on @xmath162 . finally , for every @xmath462 , set @xmath600 then @xmath601 and @xmath602 are representations of @xmath292 ( resp .",
    "@xmath589 ) and satisfy remark [ remmesure ] ( ii ) .",
    "moreover , we have , for @xmath603 , @xmath604 } & = \\mathbb{e}\\left[\\lambda^\\alpha\\left|u^2 y_1({\\lambda}u ) + ( 1-u)^2 y_2({\\lambda}(1-u))\\right.\\right.\\\\ & \\hspace{2 cm } \\left.\\left.- u^2 z_1({\\lambda}u ) - ( 1-u)^2 z_2({\\lambda}(1-u))\\right|\\right ] \\\\ & \\leq 2{\\mathbb{e}\\left[\\lambda^\\alpha u^2\\left|y_1({\\lambda}u)-z_1({\\lambda}u)\\right|\\right ] } \\\\ & \\leq 2\\int_0 ^ 1 u^{2-\\alpha}\\   { \\mathbb{e}\\left[(\\lambda u)^\\alpha \\left|y_1({\\lambda}u)-z_1({\\lambda}u)\\right|\\right ] }   du \\\\ &",
    "< \\delta,\\end{aligned}\\ ] ] leading to a contradiction .",
    "the aim of this section is the computation of moments of @xmath97 , completing the proof of theorem [ p=1/n ] .",
    "if one uses directly , the computations of moments by induction are hardly tractable because all three terms on the right of depend on @xmath21 . to circumvent this problem , we consider a new distributional identity @xmath605 in which    * @xmath606 is as in section [ s : results ] ; equivalently , @xmath607 * @xmath606 and @xmath608 are independent ; * conditionally , given @xmath100 , @xmath609 and @xmath610 are independent and distributed as @xmath611 and @xmath612 , respectively .",
    "the next propositions establish relations between @xmath97 and solutions of , eventually providing an algorithm for the computation of moments of @xmath97 ( see and ) .",
    "[ 5to34 ] the family @xmath613 , in which @xmath606 and @xmath97 are assumed independent , is a solution of .",
    "[ unique2 ] the @xmath2-th moment of @xmath116 is a polynomial of degree @xmath2 in the variable @xmath17 .    before proving propositions [ 5to34 ] and [ unique2 ]",
    ", we need a lemma .",
    "[ factsaboutw ] the @xmath2-th moment @xmath614}$ ] is a polynomial of degree @xmath2 with nonnegative coefficients and for @xmath615 , @xmath616 .",
    "owing to campbell s theorem @xcite , we have @xmath617 } = \\exp { \\left ( { \\lambda}{\\left (   { \\mathbb{e}\\left[e^{su}\\right ] } -1\\right ) }     \\right ) } = \\exp { \\left ( { \\lambda}{\\left ( \\frac s{2!}+\\frac { s^2}{3!}+\\dots\\right ) }     \\right)}.\\ ] ] expanding the last expression gives the lemma .    to show , it is enough to show @xmath618 where , as usual , conditioned on @xmath100 , the terms on the right hand side are independent with the right distributions .",
    "this follows immediately from , since @xmath619    consider the sequence of integral equations @xmath620 in which @xmath621 where @xmath622 is the @xmath178-th moment of @xmath623 .",
    "proposition [ unique2 ] is a consequence of the next lemma .    the induction formula and the initial condition @xmath624 defines a unique sequence of polynomials , @xmath625 .",
    "furthermore , @xmath626 has degree @xmath2 , and vanishes at @xmath222 . for @xmath627 , the @xmath2-th moment @xmath628}$ ]",
    "is equal to @xmath629 .",
    "consider @xmath627 and assume that the properties in the lemma hold for @xmath630 .",
    "then , for @xmath87 and @xmath177 smaller than @xmath2 , and @xmath631 , the expression @xmath632 is a polynomial with degree @xmath2 and , due to lemma [ factsaboutw ] , vanishes at 0 .",
    "thus , in this case , @xmath633 is a polynomial with degree @xmath2 , vanishing at 0 .",
    "it is now easy to check that a polynomial @xmath629 satisfies if and only if , for @xmath634 , @xmath635}p_n=\\frac{n+k+1}{n+k-1}\\ { \\left[{\\lambda}^k\\right]}\\psi_n.\\ ] ] also , by the induction assumptions , @xmath636 } & = { \\mathbb{e}\\left[\\big(\\xi({\\lambda})+uy(u{\\lambda})+(1-u)\\widetilde{y}((1-u){\\lambda})\\big)^n\\right]}\\\\ & = \\sum_{r+k+\\ell = n } \\binom{n}{r , k,\\ell}g_r({\\lambda } ) { \\mathbb{e}\\left[u^k(1-u)^{\\ell}y(u{\\lambda})^k\\widetilde{y}((1-u){\\lambda})^{\\ell}\\right]}\\\\ & = 2{\\mathbb{e}\\left[u^ny({\\lambda}u)^n\\right]}+\\psi_n({\\lambda}).\\end{aligned}\\ ] ] note that @xmath637 for @xmath638 . by remark",
    "[ remmesure ] , @xmath639}$ ] is nonnegative and measurable .",
    "thus , for @xmath83 , we can rewrite the previous equation : @xmath640 since @xmath641 is assumed to be finite and @xmath637 , the integral on the right hand side is convergent , and thus it is a continuous function of @xmath17 . as a consequence @xmath642 belongs to @xmath643 , and is a solution on @xmath123 of the following differential equation : @xmath644 by proposition [ ilexiste1 ] and lemma [ factsaboutw ] , @xmath645 as @xmath565 , but the general solution of the differential equation is @xmath646 .",
    "thus @xmath647 on @xmath123 .    as a consequence of these results",
    ", we deduce that :    [ polynomialprop ] the function @xmath648}$ ] is a polynomial of degree @xmath2 that vanishes at @xmath222 .    since @xmath649 , with independent summands ,",
    "we obtain @xmath650 } = \\sum_{0\\le k\\le m}{m\\choose k}{\\mathbb{e}\\left[\\xi({\\lambda})^{m - k}\\right]}{\\lambda}^k{\\mathbb{e}\\left [ x({\\lambda})^k\\right]}.\\ ] ] the result follows by induction .      the moments of @xmath116 , and thus of @xmath97 , can be computed up to arbitrary order with the help of and . for the first two moments , the calculations run as follows . expanding @xmath651 in the proof of lemma [ factsaboutw ]",
    "we obtain    [ l : xi ] @xmath652}=\\frac12{\\lambda}\\qquad\\text{and}\\qquad g_2({\\lambda})={\\mathbb{e}\\left[\\xi({\\lambda})^2\\right]}=\\frac13{\\lambda}+\\frac14{\\lambda}^2.\\ ] ]    @xmath653}={\\mathbb{e}\\left[\\xi({\\lambda})\\right]}={\\lambda}\\qquad\\text{and}\\qquad { \\lambda}^2{\\textnormal{var}\\left(x({\\lambda})\\right)}={\\textnormal{var}\\left(\\xi({\\lambda})\\right)}=\\frac13{\\lambda}+\\frac{1}{12}{\\lambda}^2.\\ ] ]    taking @xmath654 in and , we find , using lemma [ l : xi ] , @xmath655 taking @xmath656 , we similarly find @xmath657 since @xmath649 , with independent summands , @xmath658}={\\mathbb{e}\\left[\\xi({\\lambda})\\right]}+{\\lambda}{\\mathbb{e}\\left [ x({\\lambda})\\right]},\\ ] ] which by lemma [ l : xi ] yields @xmath659}={\\lambda}$ ] . similarly , @xmath660 } = p_2({\\lambda})-{\\mathbb{e}\\left[\\xi({\\lambda})^2\\right]}-2{\\mathbb{e}\\left[\\xi({\\lambda})\\right]}{\\mathbb{e}\\left[{\\lambda}x({\\lambda})\\right ] } = \\tfrac13{\\lambda}+\\tfrac{13}{12}{\\lambda}^2,\\end{aligned}\\ ] ] which yields the variance formula .    the formulas for mean and variance of @xmath97 can also be obtained directly from and lemma [ l : xi ] ; we leave this as an exercise .",
    "we have presented a probabilistic analysis of quicksort when some comparisons can err .",
    "analysing other sorting algorithms such as merge sort , insertion sort or selection is even more intricate .",
    "they do not fit into the model presented in this paper and further more involved probabilistic models / arguments are required .",
    "we conjecture that the same normalization holds for the number of inversions in the _ output of merge sort _ for @xmath661 , @xmath662 , and that the limit law @xmath663 satisfies @xmath664}=\\sum_{k\\ge 0}\\ \\frac{2^k}{(2^k+2)(2^k+3)}= 0.454674373\\dots<{\\mathbb{e}\\left[x({\\lambda})\\right]}.\\ ] ]",
    "a more rigorous formulation and a shorter proof of theorem [ thm : unique ] are born from discussions with uwe rsler .",
    "also , we thank two anonymous referees , whose careful reading led to substantial improvements ."
  ],
  "abstract_text": [
    "<S> we provide a probabilistic analysis of the output of quicksort when comparisons can err . </S>"
  ]
}