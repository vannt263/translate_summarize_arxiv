{
  "article_text": [
    "we first consider a canonical ensemble of _ simple _ networks , each consisting of @xmath1 nodes and characterized by an adjacency matrix @xmath11 . a link between two nodes @xmath12 and",
    "@xmath13 may be present ( @xmath14 ) or absent ( @xmath15 ) .",
    "the network is simple in that self - interactions are not permitted and that the adjacency matrix is symmetric .",
    "each network is described by its probability distribution @xmath16 .",
    "the link between nodes @xmath12 and @xmath13 is present with probability @xmath17 and is otherwise absent with probability @xmath18 .",
    "the ensemble is subject to @xmath19 structural constraints , of the type @xmath20 where @xmath21 is a constraint function on the probability matrix @xmath22 , which consists of matrix elements @xmath23 , and @xmath24 is the constraining value .    in accordance with the principle of maximal entropy @xcite ,",
    "the link probabilities for this canonical ensemble are provided by the maximization of the shannon entropy of network ensembles @xcite , @xmath25 & = & -\\sum_{i < j}\\sum_{\\alpha=\\{0,1\\}}\\pi_{ij}(\\alpha)\\ln(\\pi_{ij}(\\alpha))\\\\ \\label{eq : con_ent } & = & -\\sum_{i < j } [ p_{ij}\\ln p_{ij}+(1-p_{ij})\\ln(1-p_{ij})]\\,,\\end{aligned}\\ ] ] subjected to the constraints of eq .",
    "( [ due ] ) .",
    "this optimization exercise gives rise to the maximal entropy canonical network ensemble , which is a generalization of the @xmath3 random network ensemble @xcite .",
    "the marginal probabilities @xmath23 are given as the solution to the system of equations @xmath26+\\sum_{\\kappa=1}^{m } \\lambda_{\\kappa } f_{\\kappa}({\\bf p})\\right\\}=0\\,,\\ ] ] where the @xmath27 are lagrange multipliers enforcing the constraints .",
    "let us consider the simple case of constraints on the expected degree of each node , i.e. , we select @xmath28 , such that our @xmath29 constraints given by @xmath30 take the form @xmath31 the marginal probabilities @xmath23 that satisfy eq .",
    "@xmath32 are given as @xmath33 with the lagrange multipliers @xmath34 fixed by eq .",
    "@xmath32 and the variables @xmath35 , which are commonly referred to ashidden variables \" @xcite . in table",
    "[ table ] we generalize this procedure to network ensemble satisfying a number of different structural constraints .    [ cols=\"^,^,^\",options=\"header \" , ]",
    "the constraints for canonical ensembles are satisfied only on average , it is therefore relevant to investigate the probability of large fluctuations in these ensembles .",
    "the entropy for large deviations @xmath36 $ ] of canonical ensembles is defined as @xmath37 & = & -\\lim_{n\\rightarrow \\infty}\\frac{1}{n } \\ln\\bigg[\\sum_{\\{a_{ij}\\}}p_{ij}^{a_{ij}}(1-p_{ij})^{1-a_{ij}}\\\\ \\label{omega_ent } & \\times & \\prod_{\\kappa=1}^m\\delta\\bigg(g_\\kappa - g_{\\kappa}({\\bf a})\\bigg)\\bigg]\\,,\\end{aligned}\\ ] ] where the delta function @xmath38 enforce the @xmath39 hard constraint @xmath40 with @xmath41 being the constraining function specified on the adjacency matrix and @xmath42 as the constrained value .",
    "the quantity @xmath36\\geq0 $ ] measures the probability that networks in a canonical ensembles satisfy eqs .",
    "if @xmath36 $ ] is large , then this implies that the probability that the networks in the canonical ensemble satisfy the topological constraints is large .",
    "small values of @xmath36 $ ] , on the other hand , correspond to the large deviations of the canonical ensemble , i.e. , there the networks satisfying the hard constraints are rare .    the exact calculation of @xmath36 $ ] has been performed using path integral methods @xcite with linear hard constraints that fix the degree sequence .    using the cavity method , we now demonstrate how to compute eq .",
    "( [ omega_ent ] ) for more general cases of canonical ensemble and hard constraints fixing , for example , ( i ) the degree sequence , ( ii ) community structure , and ( iii ) number of links at a given distance .    in order to apply the cavity method to the calculation of @xmath36 $ ]",
    "it is first necessary to describe the factor graph we will consider , which is depicted in fig .",
    "@xmath44 . following recent efforts to evaluate the number of loops in networks",
    "@xcite we take the variables of the factor graph to be the matrix elements @xmath45 of the adjacency matrix , where index @xmath46 identifies each possible link of the undirected network .",
    "the factor nodes , which are identified by greek letters,@xmath47 denote the @xmath48 topological constraints imposed on the network .",
    "in particular , each factor node @xmath49 is linked to a list of variables , which are identified by the set @xmath50 .",
    "likewise , variable @xmath51 is connected to a a set of constraints , which is indicated as @xmath52 . in our ensemble",
    "we assume that the number of constraints connected to a variable @xmath51 it is equal for each variable of the factor graph and given by @xmath53 .    the cavity method , remains valid even for @xmath54 but the scaling @xmath55 is necessary ( as will become clear in the following derivation ) to ensure that the entropy @xmath36 $ ] remains finite .",
    "are indicated with circles and have a fixed connectivity @xmath56 in the figure .",
    "the factor nodes , instead are indicated by squares .",
    "their role is to impose the hard constraints defined in eqs.@xmath43 .",
    ", width=226,height=226 ]      the constraint given by eq .",
    "@xmath43 now fixes the degrees of the factor nodes , i.e. , @xmath57 with @xmath58 and factor node degree @xmath59 .",
    "correspondingly , we can write eq .",
    "( [ omega_ent ] ) as @xmath60&=&-\\lim_{n\\rightarrow \\infty}\\frac{1}{n } \\ln\\bigg[\\sum_{\\{a_{\\ell}\\}}p_{\\ell}^{a_{\\ell } } ( 1-p_{\\ell})^{1-a_{\\ell}}\\\\&\\times & \\prod_{\\alpha=1}^m\\delta\\left(k_{\\alpha } - \\sum_{\\ell'\\in\\partial \\alpha}a_{\\ell ' } \\right)\\bigg ] , \\label{ld2}\\end{aligned}\\ ] ] within the summation term on the first line of eq .",
    "( [ ld2 ] ) and for each value @xmath61 , we introduce the unity identity @xmath62 , which is parametrized by @xmath63 .",
    "we can then define @xmath64 $ ] as @xmath65&=&-\\frac{1}{n } \\ln\\bigg[\\sum_{\\{a_{\\ell}\\}}\\left({p_{\\ell}x}\\right)^{a_{\\ell}}({1-p_{\\ell}})^{1-a_{\\ell}}\\\\ & \\times & \\prod_{\\alpha=1}^m\\delta\\left(k_{\\alpha } - \\sum_{\\ell'\\in\\partial \\alpha}a_{\\ell ' } \\right)\\bigg]+\\nonumber \\\\ & + & \\frac{l}{n}\\ln(x ) \\label{ox}\\end{aligned}\\ ] ] where @xmath2 is the total number of distinguishable links constraint by the constraint in eq . @xmath66 .",
    "the introduction of the parameter @xmath67 at this stage is completely irrelevant and in fact the relation @xmath68=\\lim_{n\\to \\infty}\\omega_n[\\{k_{\\alpha}\\},x ] \\label{limit}\\ ] ] holds for all values of @xmath67",
    ". however , in what follows , we will focus on the particular limiting case where @xmath67 tends to @xmath69 .",
    "thus , we write that @xmath68=\\lim_{x\\to 0}\\lim_{n\\to \\infty}\\omega_n[\\{k_{\\alpha}\\},x]\\,.\\ ] ]    the calculation of @xmath70 $ ] may be formulated in terms of the cavity method or the belief propagation ( bp ) algorithm @xcite , aimed at determining @xmath71 with @xmath72 defined as in the following @xmath73 where the entropy @xmath64 $ ] given by @xmath74=-\\ln { \\cal z}+l\\ln(x)\\,.\\ ] ] the  messages \" of this bp algorithm are sent between variable and factor nodes . in particular",
    ", we may define @xmath75 as the message sent from variable node @xmath51 to factor node @xmath49 indicating the probability that matrix element @xmath51 takes value @xmath45 , in absence of constraint @xmath49 .",
    "we correspondingly define @xmath76 as the message that the factor node @xmath49 sends to variable @xmath51 for the distribution of all variables connected to @xmath49 , except variable @xmath51 .",
    "the bp update rules @xcite take the form    @xmath77    where @xmath78 are a normalization constants .",
    "to proceed , we make the ansatz that the cavity distribution satisfies a binomial form @xmath79 which is parametrized by fields @xmath80 . using integral representations of delta functions ,",
    "we calculate the cavity messages given by @xmath81 as @xmath82}\\prod_{\\ell'\\in \\partial \\alpha \\setminus \\ell}\\bigg[1-h_{\\ell',\\alpha}(1-e^{{\\rm i}z})\\bigg]\\,.\\ ] ] assuming self - consistently that the @xmath83 are small , we approximate the product in the above equation as @xmath84 \\\\ & -&\\sum_{\\ell'\\in \\partial \\alpha \\setminus \\ell}h_{\\ell',\\alpha}(1-e^{{\\rm i}z})\\bigg)\\,,\\end{aligned}\\ ] ] which on suitable transformation of variables takes the form of hankel s contour integral , giving @xmath85 finally , inserting the above result into eq .",
    "( [ eq : cav_dist ] ) , we get that @xmath86 satisfied the recursion equation @xmath87    provided that every link exists with probability @xmath88 , we can choose the value of @xmath67 to be sufficiently small so as to approximate @xmath89 by @xmath90 since we have assumed that every variable @xmath51 is linked to exactly @xmath91 factor nodes , the equation @xmath92 is solved for every value of @xmath93 by the cavity field @xmath94 where the cavity field @xmath95 satisfy the equation @xmath96 equations @xmath97 and @xmath98 define the cavity distributions @xmath89 which are indeed small for sufficiently small value of @xmath67 , as previously assumed .",
    "finally , using the bp algorithm @xcite we can derive the marginal distributions for the factor graph which are given by    @xmath99\\ , , \\label{eq : marginal_dist}\\end{aligned}\\ ] ]    where @xmath100 and @xmath101 are normalization constants that satisfy    @xmath102\\,,\\\\ c_{\\alpha}&=&\\pi_{(\\sum_{\\ell \\in \\partial \\alpha}h_{\\ell,\\alpha})}(k_{\\alpha } ) \\prod_{\\ell^{\\prime}\\in \\partial \\alpha } ( 1-p_{\\ell^{\\prime}})\\prod_{\\beta\\in \\partial \\ell^{\\prime } \\setminus \\alpha}\\hat{\\nu}_{\\beta\\rightarrow \\ell^{\\prime}}(0)\\,.\\nonumber \\label{cae}\\end{aligned}\\ ] ]    the term @xmath103 gives the probability for poisson distributed random variable @xmath104 with average @xmath67 .",
    "following @xcite , in terms of our marginal distributions , the quantity @xmath105 , with @xmath72 defined in eq .",
    "@xmath106 , may be expressed as the minimum of the bethe free energy    @xmath107=\\sum_{\\alpha=1}^m\\sum_{\\{a_{\\ell}\\}_{\\ell\\in \\partial \\alpha}}p_\\alpha(\\{a_{\\ell}\\})\\ln\\left(\\frac{p_\\alpha(\\{a_{\\ell}\\})}{\\psi_\\alpha(\\{a_{\\ell}\\})}\\right ) -\\sum_{\\ell=1}^{n(n-1)/2}(|\\partial \\ell|-1)\\sum_{a_{\\ell}=\\{0,1\\}}{p}_{\\ell}(a_{\\ell})\\ln \\left(\\frac{{p}_\\ell(a_{\\ell})}{\\phi_\\ell(a_{\\ell})}\\right)\\ , ,   \\label{g}\\end{aligned}\\ ] ]    where @xmath53 indicates the number of factor nodes connected to variable @xmath51 and @xmath108 and @xmath109 inserting the expression for the marginal distributions , eq .",
    "@xmath110 , into eq .",
    "@xmath111 we obtain the result @xcite that @xmath112 using the definition of entropy of large deviations eq . @xmath113 and the expressions in eq .",
    "@xmath114 for @xmath115 and @xmath116 , together with the eqs .",
    "@xmath117 for the cavity fields , we get , for @xmath118 , that    @xmath119&=&-\\sum_{\\alpha=1}^{m}\\ln c_{\\alpha}+(|\\partial \\ell|-1)\\sum_{\\ell=1}^{n(n-1)/2 } \\ln c_{\\ell}+l\\ln(x)\\,\\nonumber \\\\ & = & -\\sum_{\\alpha=1}^{m}\\ln \\left [ \\frac{1}{k_{\\alpha}!}\\left(x^{1/|\\partial \\ell| } \\sum_{\\ell \\in \\partial \\alpha}\\hat{h}_{\\ell,\\alpha}\\right)^{k_{\\alpha}}\\exp\\left(-x^{1/|\\partial \\ell| } \\sum_{\\ell\\in \\partial \\alpha}\\hat{h}_{\\ell,\\alpha}\\right)\\prod_{\\ell \\in\\partial \\alpha}(1-p_{\\ell})\\right]+\\nonumber\\\\ & + & ( |\\partial \\ell|-1)\\sum_{\\ell=1}^{n(n-1)/2 } \\ln \\left[p_{\\ell}\\prod_{\\beta\\in \\partial \\ell}\\frac{k_{\\beta}}{\\sum_{\\ell'\\in\\partial \\beta\\setminus \\alpha}\\hat{h}_{\\ell',\\beta}}+1-p_{\\ell}\\right]+l\\ln(x)\\,.\\end{aligned}\\ ] ]    finally , going in the limit @xmath120 and @xmath121 we get , according to eq .",
    "@xmath122    @xmath123&=&\\lim_{n\\to \\infty}\\frac{1}{n}\\left\\{-\\sum_{\\alpha=1}^{m}\\ln \\left [ \\frac{1}{k_{\\alpha}!}\\left(\\sum_{\\ell \\in \\partial \\alpha}\\hat{h}_{\\ell,\\alpha}\\right)^{k_{\\alpha}}\\right]\\right.+\\nonumber\\\\ & + & \\left.(|\\partial \\ell|-1)\\sum_{\\ell=1}^{n(n-1)/2 } \\ln \\left[p_{\\ell}\\prod_{\\beta\\in \\partial \\ell}\\frac{k_{\\beta}}{\\sum_{\\ell'\\in\\partial \\beta\\setminus \\alpha}\\hat{h}_{\\ell',\\beta}}+1-p_{\\ell}\\right]-|\\partial \\ell|\\sum_{\\ell}\\ln(1-p_{\\ell})\\right\\},\\end{aligned}\\ ] ]    where the cavity field @xmath95 are the solution of the bp eq .",
    "@xmath98 .",
    "we now consider a few specific cases for the hard constraints , which allow us to simply our expression eq .",
    "@xmath124 further .      also known as the configuration model @xcite , we consider constraints that fix the degree sequence , @xmath125 for the network , where @xmath126 with @xmath127 . in terms of the factor graph ,",
    "each factor node @xmath49 fixes the degree for a specific node @xmath12 in the undirected network . recalling that variable @xmath51 represents the tuple @xmath128 in the adjacency matrix , the variable",
    "is linked to @xmath129 constraints that fix the degrees for nodes @xmath12 and @xmath13 .",
    "finally the cavity fields @xmath89 can be written as @xmath130 , as we have identified factor node @xmath49 with node index @xmath12 and , similarly , variable @xmath51 with nodes @xmath12 and @xmath13 .    to simplify the expression eq .",
    "@xmath124 for @xmath131 $ ] we introduce @xmath132 using eq .",
    "@xmath98 it is easy to show that the variables @xmath133 satisfy the following equation @xmath134 where @xmath135 is given by the solution to eq .",
    "finally , in the limit @xmath120 , we get the exact result for the entropy of the large deviation of canonical network ensembles to be @xmath136&=&\\lim_{n\\to \\infty}\\frac{1}{n}\\left\\{-\\sum_{i=1}^n \\ln\\left[\\frac{1}{k_i ! } \\gamma_i^{k_i}\\right]+\\right.\\\\ & + & \\left.\\sum_{\\langle i , j \\rangle } \\ln \\left[\\frac{p_{ij}}{1-p_{ij}}\\frac{k_ik_j}{\\gamma_i\\gamma_j}+ 1\\right]-\\sum_{\\ell}\\ln(1-p_{\\ell})\\right\\}\\,,\\nonumber\\end{aligned}\\ ] ] where @xmath137 indicates the sum over all links in the adjacency matrix .",
    "if @xmath138 eq . @xmath139 simplifies to @xmath140 which then gives in the diluted limit @xmath141 the result @xcite that @xmath142 & = & \\lim_{n\\to \\infty}-\\frac{1}{n}\\left\\ { \\sum_{i=1}^n \\ln\\left[\\frac{1}{k_i!}\\gamma_i^{k_i}e^{-k_i}\\right]\\right\\}\\,,\\end{aligned}\\ ] ] for the configuration model .",
    "suppose we assign to node @xmath12 a pott s index @xmath143 that indicates the community to which the node @xmath12 belongs .",
    "in addition to the degree constraint given by eq .",
    "( [ conf_model ] ) , we also impose on the level of the adjacency matrix that @xmath144 where @xmath145 .",
    "the total number of constraints is @xmath146 .",
    "each variable node @xmath51 in our factor graph is now linked to three factor nodes - two for constraining the degrees of nodes @xmath12 and @xmath13 , separately , in the undirected network and a third one to enforce the community structure @xmath147 .",
    "similarly to the previous case we introduce @xmath148 where @xmath149 indicated the type of constraint . given the cavity eqs .",
    "@xmath98 , it can be shown that the variables @xmath133 satisfy the following equation @xmath150 where @xmath151 , depending on the value of @xmath49 and the cavity fields @xmath95 satisfy the cavity eqs .",
    "the entropy of large deviations @xmath152 $ ] given by @xmath124 can be expressed as @xmath153&=&\\lim_{n\\to \\infty}\\frac{1}{n } \\left\\{-\\sum_{\\alpha=1}^m \\ln[\\pi_{\\gamma_{\\alpha}}(k_{\\alpha})]\\right.\\nonumber \\\\ & + & \\left.\\sum_{i , j=1}^n \\frac{p_{ij}}{1-p_{ij}}\\left[\\frac{k_i\\,k_j\\ , a(q_i , q_j)}{\\gamma_i\\gamma_j\\gamma_{(q_i , q_j)}}+1\\right]\\right.\\nonumber \\\\ & -&\\left.\\sum_{\\alpha } \\gamma_{\\alpha}-2\\sum_{\\ell}\\ln(1-p_{\\ell})\\right\\}.\\end{aligned}\\ ] ] in the case in which @xmath154 and the network is diluted @xmath141 we get @xmath153&= & \\lim_{n\\to \\infty}\\frac{1}{n}\\left\\{-\\sum_{\\alpha=1}^m \\ln\\left[\\frac{1}{k_{\\alpha}!}{\\gamma_{\\alpha}^{k_{\\alpha}}}e^{-k_{\\alpha}}\\right]\\right\\}.\\end{aligned}\\ ] ] the value of @xmath155 $ ] converges to a finite value in the limit of @xmath156 only if the number of constraints @xmath48 is of the same order of magnitude as @xmath1 , i.e. , @xmath55 , in other words if the number of communities @xmath157 . for @xmath158 , with @xmath159 , we have that @xmath155\\sim n^{\\xi-1}$ ] .",
    "let us embed the @xmath1 nodes in a metric space , such that two nodes @xmath12 and @xmath13 are a distance @xmath160 apart .",
    "we divide the interval @xmath161 $ ] into @xmath162 intervals @xmath163 with @xmath164 and @xmath165 .",
    "the constraint for the number of links at a given distance is given by specifying a sequence of integers @xmath166 that satisfy @xmath167 where @xmath168 if @xmath169 and @xmath170 otherwise .",
    "the total number of constraints is in this case @xmath171 .",
    "once again each variable @xmath51 is linked to @xmath56 factor node constraints  two for fixing the degrees of node @xmath12 and @xmath13 and a third for the number of links @xmath172 in the interval @xmath173 .",
    "we introduce the variables @xmath174 accoring to the definition @xmath148 with @xmath175 .",
    "these parameter satisfy the following equation @xmath176 where the cavity field solve the cavity equation @xmath98 .",
    "the entropy of large deviations @xmath152 $ ] given by @xmath124 can be expressed as @xmath177&=&\\lim_{n\\to \\infty}\\frac{1}{n}\\left\\{-\\sum_{\\alpha=1}^m \\ln[\\pi_{\\gamma_{\\alpha}}(k_{\\alpha})]\\right.\\\\ & + & \\left.\\sum_{i , j=1}^n\\frac{p_{ij}}{1-p_{ij}}\\left(\\frac{k_i\\,k_j\\ , b_{s_{i , j}}}{\\gamma_i\\,\\gamma_j\\,\\gamma_{s_{i , j}}}-p_{ij}\\right)\\,\\right.\\nonumber \\\\ & -&\\left.\\sum_{\\alpha } \\gamma_{\\alpha}-2\\sum_{\\ell}\\log(1-p_{\\ell})\\right\\}\\end{aligned}\\ ] ] where the subscript @xmath178 denotes the interval @xmath179 such that @xmath180 .",
    "using @xmath181 in the limit of spase networks with @xmath182 the entropy of large deviations simplifies and takes the form @xmath153&=&\\lim_{n\\to",
    "\\infty}\\frac{1}{n}\\left\\{-\\sum_{\\alpha=1}^m \\ln\\left[\\frac{1}{k_{\\alpha}!}{\\gamma_{\\alpha}}^{k_{\\alpha}}e^{-k_{\\alpha}}\\right]\\right\\ } \\label{d2}\\end{aligned}\\ ] ]    the value of @xmath155 $ ] converges to a finite limit for @xmath156 only is the number of constraints @xmath48 is of the same order of magnitude as @xmath1 , i.e. @xmath55 , i.e. only if @xmath162 if @xmath183 with @xmath184 then @xmath155\\sim n^{\\xi-1}$ ]",
    ".      further simplifications for the expressions obtained in the previous section are possible when the constraining degrees @xmath185 of sparse networks are the expected degrees over the canonical ensembles , i.e. , @xmath186 .",
    "the bp equations simplify to give @xmath187 thus , eq . ( [ fi2 ] ) reduces to @xmath188=-\\lim_{n\\to \\infty}\\frac{1}{n}\\sum_{\\alpha=1}^m\\ln \\pi_{k_{\\alpha}}(k_{\\alpha})\\ , .",
    "\\label{old}\\ ] ] since this is the minimum value of @xmath189 , we obtain that , for @xmath55 , the limit @xmath190 and therefore the canonical ensemble is not self - averaging in the thermodynamic limit .",
    "in the situation wherein only the degree sequence of the network is constrained , we have @xmath191 , for all @xmath8 .",
    "the entropy @xmath192 $ ] of the expected degrees in the configuration model @xmath192 $ ] takes the form @xmath193=-\\sum_{k>0}p_k\\ln[\\pi_k(k)]\\,,\\ ] ] where @xmath194 is the probability for a node to have degree @xmath195 .      as in sec",
    "[ commstr ] , each node @xmath12 is assigned a pott s index @xmath143 that indicates the community to which the node belongs , with @xmath157 .",
    "the expected degree constraints take the form @xmath196 for @xmath127 and @xmath145 the total number of constraints is in this case @xmath197 .",
    "the entropy @xmath198 $ ] takes the value @xmath199&=&-\\sum_{k>0}p_k\\ln[\\pi_k(k)]\\\\ & \\hspace{-5mm}- & \\hspace{-3mm}\\lim_{n\\to \\infty}\\frac{1}{n}\\sum_{q < q'}^{q } \\ln[\\pi_{a(q , q')}(a(q , q'))]\\,.\\nonumber\\end{aligned}\\ ] ]      following the setup of sec .",
    "[ links_dist ] , the constraints in terms of expected degrees are given by eq .",
    "( [ eq : expdeg ] ) and @xmath200 where @xmath201 and @xmath202 and where @xmath168 if @xmath169 and @xmath170 otherwise",
    ". we now express @xmath203 $ ] as @xmath204= -\\sum_{k>0}p_k\\ln[\\pi_k(k)]-\\lim_{n\\to \\infty}\\frac{1}{n}\\sum_{s=1}^{l } \\ln[\\pi_{b_s}(b_s)]\\,.\\ ] ]",
    "so far we have investigated the entropy of simple canonical network ensembles and large deviations therein . in this section",
    "we derive an expression for the entropy @xmath205 of a micro - canonical ensemble with linear constraints .",
    "moreover , using the result of eq .",
    "@xmath124 we relate @xmath205 to the entropy @xmath189 of the most likely configuration of a canonical ensemble when linear constraints are imposed .    specifying @xmath206 hard constraints on the adjacency matrix , as in eq .",
    "@xmath43 , the micro - canonical ensembles entropy @xmath205 is given by @xmath207 where the partition function @xmath208 is given by @xmath209 in what follows we shall prove the following relationship , that @xmath210-\\omega^{\\star}(\\{g_{\\kappa}\\})\\ , , \\label{spo}\\ ] ] where @xmath211 $ ] , given by eq .",
    "( [ eq : con_ent ] ) , is the shannon entropy of the conjugated canonical ensemble .",
    "the term @xmath212 $ ] is the logarithm of the probability that a network in the conjugated canonical ensemble satisfies the hard constraints .",
    "physically , eq . @xmath213 implies that a network satisfying the hard constraints of eq .",
    "@xmath43 belongs , with probability one , to the conjugated canonical ensemble .",
    "however , such networks make up only a fraction @xmath214}$ ] of the total canonical ensemble measure .",
    "we now prove the relationship of eq .",
    "@xmath213 , for the case of hard constraints specifying the degree sequence . in order to evaluate @xmath215 in this case",
    "we use the integral representation of the dirac - delta functions , and we get @xmath216\\right)\\,,\\ ] ] where with the change a variables @xmath217 @xmath218 with @xmath219\\nonumber \\\\ \\label{eq : f_z_ws}&+&\\sum_{i < j}\\ln\\bigg[1+p_{ij}\\big(e^{{\\rm i}z_i + { \\rm i}z_j}-1\\big)\\bigg]\\,,\\end{aligned}\\ ] ] and the @xmath220 variables chosen so as to satisfy the marginal probabilities for the canonical ensemble , i.e. , @xmath221 we observe that eq .",
    "( [ eq : f_z_ws ] ) can be expressed @xmath222-\\sum_i { \\rm i}z_i\\,k_i\\\\   & + & \\sum_{i < j}\\ln(1+p_{ij}(e^{{\\rm",
    "i}z_i+{\\rm i}z_j}-1))\\ , .   \\end{aligned}\\ ] ] therefore , with simple manipulations it can be shown that the partition function can be written as @xmath223}\\sum_{\\{a_{ij}\\}}p_{ij}^{a_{ij}}(1-p_{ij})^{1-a_{ij}}\\prod_{i=1}^n\\delta_{k_i,\\sum_j a_{ij}}\\nonumber \\\\ & = & \\exp\\bigg(n[s^{\\star}[{\\cal p}]+\\omega_n[\\{k_{i}\\},1]\\big\\}\\bigg)\\ , .",
    "\\end{aligned}\\ ] ] given the definition @xmath224 , this proves the relationship eq .",
    "@xmath213 between entropies of micro - canonical and conjugate canonical ensembles .      following the simplification of sec .",
    "[ sec : special ] we assume that the constraining degrees @xmath225 are expectation values of the canonical ensemble . using eq .",
    "@xmath213 we get @xmath210-\\omega^{\\star}[\\{k_{\\alpha}\\}]\\ , .",
    "\\label{gg}\\ ] ] where @xmath226 $ ] is given by @xmath124 where @xmath227 are the expected degree of the canonical ensembles . for sparse networks ,",
    "we can use eq . @xmath228 and",
    "@xmath205 take the simple form @xmath210+(|\\partial \\ell|-1)\\sum_{k>0}{n}_{k}\\ln\\pi_k(k)\\ , .",
    "\\label{gg2}\\ ] ] where @xmath229 is the probability that a random constraint enforce the degree @xmath195 .",
    "we note that when using a gaussian approximation @xcite for network models with linear constraints , the value for the entropy @xmath230 obtained for the micro - canonical ensembles is reasonably good , with an estimated error equal to @xmath231^{k_{\\alpha}}\\sqrt{2 \\pi k_{\\alpha}}}{k_{\\alpha}!}\\right|\\\\ & \\leq & \\frac{m}{n } |\\ln{e^{-1}\\sqrt{2\\pi}}|=\\frac{m}{n}0.08\\ , .",
    "\\end{aligned}\\ ] ] we conclude this section with the expressions for @xmath205 for a few specific constraints .      from eq .",
    "@xmath232 we get in the case of the sparse configuration model @xmath233+\\sum_{k>0}p_k\\ln[\\pi_k(k)]\\,,\\ ] ] where @xmath194 is the probability of observing a node with degree @xmath195 .      in the ensemble with given degree sequence and a constraint on the number of links within and between communities @xmath234 , for the total number of communities @xmath157 .",
    "here we obtain for sparse networks @xmath235+\\sum_{k>0 } p_k \\log [ \\pi_k(k)]\\\\ & + & \\lim_{n\\to \\infty}\\frac{1}{n}\\sum_{q,\\leq q'=1}^q\\log [ \\pi_{a_{q , q'}}(a_{q , q'})]\\,,\\end{aligned}\\ ] ] where @xmath236 is given by eq .",
    "( [ community_constraint ] ) .      when the constraints are on the number of links at a specific distance and the degree sequence , the expression for the entropy of the micro - canonical ensemble takes the form @xmath237+\\sum_{k>0 } p_k \\log [ \\pi_k(k)]+\\lim_{n\\to \\infty}\\frac{1}{n}\\sum_{s=1}^l \\log [ \\pi_{b_s}(b_s)]\\,.\\ ] ] where @xmath238 is given by eq .",
    "@xmath239 valid for sparse networks .",
    "in conclusion we have derived exact results for the large deviation properties of canonical network ensembles and for the entropy of micro - canonical network ensembles in the case of simple networks with linear constraints .",
    "our results apply to simple networks with given degree sequence , community structure and for networks embedded in a metric space .",
    "our approach makes use of the transparent cavity method , which can also be extended to other types of constraints or directed networks .",
    "our calculations are valid even when the number of constraints scales like @xmath54 . nevertheless , only in the case of a linear number of constraints ,",
    "i.e. , @xmath55 , can we ensure that the entropy @xmath155 $ ] remains finite in the limit @xmath240 .",
    "further inquiry will be directed toward the exact evaluation of the entropy of weighted networks and networks wherein the number of loops passing through each node is constrained . moreover ,",
    "the relation between the information entropy of networks ensembles studied here and the von neumann entropy , as introduced in @xcite , presents further scope for investigation .",
    "s. boccaletti , v. latora , y. moreno , m. chavez and d. u. hwang , phys . rep . *",
    "424 * , 175 ( 2006 ) .",
    "s. n. dorogovtsev , _ lectures on complex networks _",
    "( oxford university press , oxford , 2010 ) .",
    "m. e. j newman , _ networks _ ( oxford university press , oxford , 2010 ) ."
  ],
  "abstract_text": [
    "<S> the gibbs entropy of a microcanonical network ensemble is the logarithm of the number of network configurations compatible with a set of hard constraints . </S>",
    "<S> this quantity characterizes the level of order and randomness encoded in features of a given real network . </S>",
    "<S> here we show how to relate this entropy to large deviations of conjugated canonical ensembles . </S>",
    "<S> we derive exact expression for this correspondence using the cavity methods for the configuration model , for the ensembles with contraint degree sequence and community structure and for the ensemble with constraint degree sequence and number of lins at a given distance .    </S>",
    "<S> the evolution of complex networks are usually described by non - equilibrium stochastic dynamics @xcite . </S>",
    "<S> however a networks specific topological structure may reveal relevant organizational principles , such as an universality for the large - scale structure or hierarchical communities @xcite that is sure to impact dynamical processes taking place on the network @xcite .    extracting relevant statistical information encoded in the networks structure </S>",
    "<S> is a fundamental concern of community detection algorithms @xcite and other inference problems . to study these problems , </S>",
    "<S> several authors have suggested entropy based methods @xcite , which are grounded in the information theory of networks @xcite . </S>",
    "<S> these methods have proved to be very useful . </S>",
    "<S> in fact , in a series of recent papers @xcite it has been shown that one may extend ideas and concepts of statistical mechanics and information theory to complex network ensembles .    in this paradigm , </S>",
    "<S> one generalizes the typical random graph ensembles studied in the mathematical literature @xcite to ensembles characterized by an extensive number of constraints that fix , for example , the degree sequence @xcite , number of links between different communities , the number of links at a given distance @xcite , degree correlations between linked nodes @xcite , acyclic networks @xcite , or even network with given number of triangles @xcite and generalized motifs @xcite .    </S>",
    "<S> it is well known that in statistical mechanics we distinguish between microcanonical ensembles describing all the set of microscopic configurations compatible with a given value of the total energy , and canonical ensembles that corresponds to microscopical configurations in which the total energy fluctuates around a given mean . </S>",
    "<S> a pivotal results of statistical mechanics is the equivalence of these ensembles in the thermodynamic limit , i.e. , in the limit where the number of particle in the system is very large . </S>",
    "<S> similarly , in the theory of random graphs we distinguish between the @xmath0 ensemble , which consists of all networks with @xmath1 nodes and a total of exactly @xmath2 links , and the @xmath3 ensemble , which is formed by all networks of @xmath1 nodes and the total number of links being a poisson distributed random variable with average @xmath4 . exploiting the parallelism between statistical mechanics and theory of random graphs we can call the random graph ensemble @xmath0 a _ microcanonical network ensembles _ and the @xmath3 graph ensemble a _ </S>",
    "<S> canonical network ensemble_. similarly to statistical mechanics , the random graph ensembles @xmath0 and @xmath3 are , in the thermodynamic limit asymptotically equivalent as long as @xmath2 of the @xmath0 ensemble and @xmath5 of the @xmath3 ensemble are related by the equality @xmath6 .    </S>",
    "<S> it was shown in @xcite that the parallel construction between network ensembles can be extended to much more complex networks . </S>",
    "<S> in fact it is possible to define _ microcanonical network ensembles _ by imposing a set of hard constraints that must be satisfied by each network in the ensemble and _ canonical network ensembles _ , which satisfy soft constraints , i.e. , the constraints are satisfied on average . </S>",
    "<S> the set of constraints might fix for example the degree sequence , the community structure or the spatial structure of networks embedded in space .    </S>",
    "<S> a widely studied example of the _ microcanonical network ensemble _ is the configuration model @xcite that fixes the degree sequence , i.e. , degrees for all nodes in the networks . on the other hand , _ canonical network ensembles _ that impose soft contraints on the degree sequence </S>",
    "<S> have been studied under different names (  hidden variable model \" and  fitness model \" ) by the physics @xcite and statistics @xcite communities .    in a recent work @xcite </S>",
    "<S> it has been shown that if the number of constraints is extensive the microcanonical ensemble and its conjugate canonical ensemble are no longer equivalent . </S>",
    "<S> in particular , using a network entropy measure , it was shown that a microcanonical ensemble has lower entropy than the conjugate canonical ensemble , even though the marginal probabilities take the same expression . </S>",
    "<S> an example of this difference was given by comparing the microcanonical ensemble of regular networks with fixed degree @xmath7 for all nodes @xmath8 and the canonical poisson network ensemble with average degree @xmath9 , for every @xmath10 , where the bar refers to the ensemble average . </S>",
    "<S> it is easy to check that in this paradigmatic case , the entropy of the regular networks is smaller than the entropy of the poisson networks with the same average degree . </S>",
    "<S> the importance of such topological difference is also revealed by the observation that dynamical models defined on microcanonical network ensembles or corresponding canonical ones , display different critical behavior .    </S>",
    "<S> the calculation for the entropy of arbitrary microcanonical ensembles was performed in @xcite using a gaussian approximation and in @xcite by exact path integral approaches restricted to sparse networks and constraint degree sequence . </S>",
    "<S> here we show an extension of the exact results found in @xcite using the more transparent cavity method @xcite and derive the correspondence between the entropies of micro - canonical and conjugate canonical ensembles . </S>"
  ]
}