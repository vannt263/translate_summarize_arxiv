{
  "article_text": [
    "the composition of ultra - high energy cosmic rays ( uhecr ) has been unknown since the last half century .",
    "recent results are uncertain about whether the flux of cosmic rays at highest energies is dominated by protons , heavier nuclei or whether it is composed by a mixture of nuclei of different masses ( see e.g. ref .",
    "serious candidates for primary cosmic rays are also photons and neutrinos which are expected at small rates @xcite .",
    "this paper is focused on uhe photons as cosmic rays .",
    "small fractions of photons in the flux of uhecr are predicted by the gzk mechanism @xcite describing interactions of charged cosmic ray nuclei with cosmic microwave background radiation . as a result of these interactions",
    "the energy of primary nuclei is reduced and high energy photons and neutrinos appear as products .",
    "if the gzk predictions are true , these photons and neutrinos should be seen at low rates in the cosmic ray flux . with the capabilities of present cosmic ray detectors ,",
    "e.g. the auger observatory @xcite , these `` guaranteed '' photon rates are likely to be verified within the next few years .",
    "an identification of photons in cosmic rays would be a great scientific achievement and it would open a new observation window to the universe . on the other hand , the lack of the gzk photons in the cosmic ray flux would challenge our present understanding of cosmic - ray physics , and it would be even a more interesting observation . thus the capability to identify photons among uhe cosmic rays is very important . a full readiness for observation of gzk photons",
    "requires a reliable monte carlo simulation code that treats not only photon - induced extensive air showers ( eas ) but simulates also the propagation of photons before they enter the atmosphere .",
    "the simulation of photons above the atmosphere is important because of the `` preshower effect '' @xcite that may occur when a photon traverses a region where the geomagnetic field component transverse to the photon trajectory is particularly strong . as described e.g. in refs .",
    "@xcite , high energy photons in the presence of magnetic field may convert into e@xmath1 pair and the newly created electrons emit bremsstrahlung photons , which again may convert into e@xmath1 if their energy is high enough . as a result of these interactions , instead of a high energy photon",
    ", a bunch of particles of lower energies , so - called a preshower , reaches the atmosphere .",
    "obviously , the occurrence of the preshower effect has an important impact on air shower development and changes many shower observables .",
    "this paper is a contribution towards the development and maintenance of a reliable codes for simulation of ultra - high energy photons before they enter the earth s atmosphere .",
    "we compare the results produced by the two most commonly used monte carlo programs for the preshower effect simulation : preshower @xcite , which can be used as a stand - alone program or as a part of corsika air shower simulation package @xcite , and magics  v.  1.4.0 , used as a part of aires package @xcite .",
    "preshower and magics are the only programs of their class with open source codes and they come along with the most frequently used software for monte carlo cosmic - ray shower simulations . as the level of convergence of the results that can be obtained with the two programs has been found to be unsatisfactory , we have to make it clear to the community involved in simulations of ultra - high energy photon simulations .",
    "descriptions of both programs as well as the formulation of the physical processes behind the preshower effect can be found elsewhere . in case of preshower ,",
    "the reader is referred to ref .",
    "@xcite , the magics code is described at aires website ( @xcite ) , and the preshower effect is described and discussed e.g. in refs .",
    "it has to be mentioned that the preshower results were checked ( see ref .",
    "@xcite ) , to be in a good general agreement with previous studies : @xcite .",
    "however , the results presented in all the mentioned publications were obtained with the codes unavailable publicly , which made a detailed comparison with the preshower results unfeasible .",
    "there are three important aspects of preshower simulations and in all of them the discrepancies between preshower and magics have been found .",
    "the first aspect , discussed in section [ sec3 ] , is the geomagnetic field model and the calculation of the field component transverse to the primary particle motion .",
    "the differences in the second aspect , concerning the magnetic pair production by primary photons , are analyzed in section [ sec4 ] , and the discrepancies of the third kind , related to the bremsstrahlung of preshower electrons , are presented in section [ sec5 ] . as using both preshower and magics to plot figures of sections [ sec3 ] ,",
    "[ sec4 ] and [ sec5 ] is not straightforward , a short explanation of technical details was added in the appendix .",
    "the paper is concluded in section [ sec6 ] .",
    "in both preshower and magics , the igrf magnetic field model is used : in preshower  igrf-8 and in magics ",
    "igrf-10 is the model more recent than igrf-8 .",
    "the differences between the models concern mainly the limit for future interpolations .",
    "the geomagnetic field components obtained with these two versions should agree very well for a date within the usability range of both models .",
    "simple tests performed using the models implemented in preshower and magics and the online geomagnetic field calculator with implemented igrf-11 @xcite show a very good agreement of the geomagnetic field components .",
    "there is , however , a clear discrepancy in the geomagnetic field component transverse to the particle motion ( @xmath2 ) computed by preshower and magics .",
    "figure [ b - pre - mag ] shows an example of how @xmath2 changes with the altitude above the sea level for a primary cosmic ray coming to the pierre auger observatory in argentina from geographical north at a zenithal angle @xmath3 .     for the igrf models used in preshower ( igrf-8 , solid red line ) , magics ( igrf-10 , dotted blue line ) and magics with applied corrections ( dashed black line ) .",
    "the presented plots were obtained for the location of the pierre auger observatory in argentina and an arbitrarily selected trajectory with zenithal angle @xmath4=60@xmath5 coming from geographical north.,scaledwidth=100.0% ]    the plots were obtained with preshower ( solid red line ) , magics ( dotted blue line ) and magics with a correction described below ( dashed black line ) .",
    "the differences reach a factor 2 for lower altitudes .",
    "since the geomagnetic field components in the two programs are in a good agreement it is clear that the difference between @xmath2(preshower ) and @xmath2(magics ) must come from the procedures computing @xmath2 . after a short investigation a bug",
    "was found in one of the routines performing rotations in magics .",
    "the existence of this bug has been verified in a simple test with an inclined trajectory coming from the geographic north . in a separate routine magics",
    "calculates the geographic latitude and longitude of a point along the primary photon trajectory .",
    "these coordinates are the input for the procedure computing the geomagnetic field components .",
    "if the calculation of the geographical coordinates performed in magics is correct , then the longitude of each of the points along the mentioned trajectory should remain unchanged .",
    "surprisingly , the magics longitude varies along the tested trajectory . a simple correction of a sign in one of the rotations performed by magics fixed the problem . the transverse geomagnetic field profile produced by magics with the above correction",
    "is shown in fig .",
    "[ b - pre - mag ] and its agreement with the preshower curve is very good .",
    "the fixed procedure is used not only in the calculation of the geographic coordinates but also to obtain pair production and bremsstrahlung probabilities in magics .",
    "is is therefore a reasonable approach to continue the comparison of the other results using the magics version including the correction described above . throughout this paper",
    "we will refer to this corrected version as to `` magics - corrected '' .",
    "another important parameter calculated by the preshower programs is the probability of pair production by ultra - high energy photons in the presence of the geomagnetic field .",
    "this parameter will be hereafter referred to as gamma conversion probability or @xmath6 .",
    "@xmath6 is a crucial parameter in photon shower simulation as it determines the occurrence of preshowers above the atmosphere .",
    "if an ultra - high energy cosmic ray photon initiates a preshower , the resultant air shower reaches its maximum much earlier than a shower developing without a preshower .",
    "it is therefore desirable that the available simulations give similar approximations of this crucial parameter .",
    "unfortunately this is not the case .",
    "neither magics nor magics - corrected give @xmath6 in agreement with preshower .",
    "the differences in @xmath6 reach 20% and depend on the arrival direction . in fig .",
    "[ maps - pre - mag ] we show an example of @xmath6 dependence on the arrival direction for preshower , magics and magics - corrected .",
    "conversion for primary energy of 7@xmath710@xmath0  ev and different arrival directions as computed by preshower ( solid red line ) magics ( dotted blue line ) and magics - corrected ( dashed black line ) .",
    "computations have been performed for magnetic conditions at pierre auger observatory in argentina .",
    "the azimuth increases counterclockwise and its value of @xmath8 means the shower arriving from geographic north.,scaledwidth=100.0% ]    the plots were obtained for a primary photon of energy 7@xmath710@xmath0  ev arriving at the pierre auger obsrevatory at a fixed zenithal angle of 60@xmath5 and varying azimuth . in the frame of reference used to prepare fig .",
    "[ maps - pre - mag ] , the azimuth increases counterclockwise and its value of @xmath8 means the shower arriving from geographic north .",
    "it is clear that the results from magics and preshower seriously disagree , even after a correction described earlier .",
    "the source of this disagreement remains unknown and requires a deeper analysis .",
    "the third important difference between magics and preshower is in the probability of magnetic bremsstrahlung emission by preshower electrons , hereafter @xmath9 .",
    "large @xmath9 , or in other words more efficient bremsstrahlung emission , results in splitting the primary energy into more particles of lower energies than in case of smaller @xmath9 . fig .",
    "[ fig6-pre - mag ] shows some preshower statistics for an example of primary photon of energy @xmath10  ev arriving from geographical south at the pierre auger observatory at a zenithal angle of @xmath11 . along this direction",
    "the transverse component of the geomagnetic field is particularly strong .",
    "ev primary photons arriving at the pierre auger observatory from geographical south at a zenithal angle of @xmath3 .",
    "the spectra weighted by energy are plotted in the bottom panel .",
    "the black solid histograms were obtained with preshower and the dashed red ones with magics - corrected .",
    "the histograms obtained with original magics are not shown to keep the plots clear .",
    "it was checked that the difference between the magics and magics - corrected histograms is very small and would be hardly visible in the scale suitable for comparison to preshower histograms .",
    "the histograms shown include all the particles and no normalization was applied . the height of the bin at log10(e / ev)=20 of the magics - corrected histogram ( dashed red ) in the lower left plot , 43@xmath12  ev , might be hardly readable in a black - and - white version of the paper.,scaledwidth=100.0% ]    we will call this direction a `` strong field direction '' .",
    "the histograms shown include all the particles and no normalization was applied .",
    "a comparison is made between the simulations obtained with preshower ( solid black histograms ) and magics - corrected ( dashed red histograms ) to keep the plots clear . ] .",
    "1000 simulation runs have been performed with each of the programs for a photon primary of energy @xmath10  ev arriving at the pierre auger observatory from geographical south at a zenithal angle of @xmath3 .",
    "for such an arrival direction and primary energy the conversion probability @xmath6 turns out to be higher in magics ( 0.96 ) than in preshower ( 0.92 ) . as a result , more photons simulated with magics happened to undergo the pair production process and initiated a preshower than it was in the case of preshower simulations . despite the larger total number of preshowers resulting from magics - corrected simulations , the energy spectrum of photons in the top left plot of fig .",
    "[ fig6-pre - mag ] shows that the total number of secondary photons in preshowers generated by magics - corrected is significantly smaller than in the case of preshower simulations .",
    "the significantly smaller total number of photons in magics - corrected simulations shows then a serious inconsistence between the analyzed programs .",
    "the smaller number of photons in magics - corrected is consistent with higher energies of electrons simulated by this program , which can be seen in the plots in the bottom row of fig .",
    "[ fig6-pre - mag ] .",
    "the total number of preshower particles and total energy carried by electrons in preshower and magics - corrected are compared directly in figs .",
    "[ npart - pre - mag ] and  [ ee - pre - mag ] .",
    "conversion simulated with preshower ( red circles ) and magics - corrected ( blue crosses ) .",
    "all the simulated preshowers were initiated by photons of energies @xmath10 ev arriving from the `` strong field direction '' .",
    "the results obtained with original magics were checked to be very close to those obtained with magics - corrected and they are not shown here to keep the plots clear.,scaledwidth=100.0% ]     conversion for a primary photon energy of @xmath10  ev arriving from the `` strong field direction '' .",
    "the simulations were performed with preshower ( red circles ) and magics - corrected ( blue crosses ) .",
    "the points in excess of the general trend are the cases where one of the bremsstrahlung photons converted into an electron pair which increased the total energy carried by electrons .",
    "the results obtained with original magics were checked to be very close to those obtained with magics - corrected and they are not shown here to keep the plots clear . ,",
    "scaledwidth=100.0% ]    the results obtained with original magics were checked to be very close to those obtained with magics - corrected and they are not shown here to keep the plots clear .",
    "the discrepancy between the results of preshower and magics - corrected is significant .",
    "preshower electrons in magics emit significantly fewer bremsstrahlung photons than in preshower simulations .",
    "this must have implications on air shower development : an air shower simulated with increased @xmath9 develops earlier in the atmosphere .",
    "the source of this discrepancy , as well as the reason for the disagreement in @xmath6 , remains unknown and requires a further study .",
    "we have compared the simulation results of the two most popular open source codes for preshower simulations , preshower and magics .",
    "a significant disagreement was found between the main physical quantities derived by the two programs : the component of the geomagnetic field transverse to the primary trajectory ( @xmath2 ) , the probability of primary gamma conversion into an electron - positron pair ( @xmath6 ) , and the probability of bremsstrahlung emission of preshower electrons ( @xmath9 ) .",
    "the source of the disagreement was found only in the case of @xmath2 computation .",
    "after fixing the coding mistake found in magics a good agreement between the @xmath2 values obtained with the two programs has been achieved .",
    "the sources of the other two discrepancies remain unknown and require a further study .",
    "the discrepancies between the results of preshower and magics are meaningful for simulations of air shower development .",
    "taking into account that an air shower is simulated as a simple superposition of air showers induced by each of the preshower particles , one can assume that the depth of shower maximum , @xmath13 , is determined mostly by the highest energy particle in a preshower that reaches the top layers of the atmosphere .",
    "this highest energy particle could be a photon or an electron , depending on the preshower development and the geomagnetic conditions . if it is a photon , then based on the results presented in fig .",
    "[ fig6-pre - mag ] one would expect only a minor difference in @xmath13 , as photons of high energies are similarly numerous in both preshower and magics .",
    "but if an air shower development is determined mostly by a preshower electron , then the resulting @xmath13 could be even a few tens of g/@xmath14 deeper if we use a preshower computed by magics than in case of using preshower .",
    "this is because of the difference in electron energy calculated by the two programs ( see fig .",
    "[ ee - pre - mag ] ) and a known direct relation between the energy of primary particles and @xmath13 : a higher primary energy results in a deeper @xmath13 of an air shower .",
    "a quantification of the influence of the discrepancies between preshower and magics on air shower simulations would require a separate analysis .",
    "nevertheless , it is clear already now that reaching an agreement between results derived with preshower and magics would be an important step towards a better reliability of ultra - high energy photon shower simulations .",
    "we thank henryk wilczyski for valuable discussions . +",
    "this work was partially supported by the polish ministry of science and higher education under grant no .",
    "n  n202  2072  38 .",
    "a thorough comparison of the results produced by preshower and magics requires a few manual interventions within the codes of the programs .",
    "these interventions are needed to read all the variables of interest and not all of these variables are delivered at the outputs .",
    "additional difficulty is that magics is not a stand - alone program and can be used only within its mother program aires .",
    "although we are not aware of any fundamental reasons for which magics could not be detached from aires ( with some coding effort ) , we gave up this idea to minimize the risk of errors .",
    "with this approach the computing has increased but it was still acceptable .      * @xmath15[g ] ( fig .",
    "[ b - pre - mag ] ) : ` b_tr ` ( p ) ; ` bperp`@xmath710@xmath16 ( m ) * altitude a.s.l.[km ] ( fig .",
    "[ b - pre - mag ] ) : ` r_curr`@xmath17 - 6371 ( p ) ; + ` this_particle->altitude`@xmath710@xmath18 ( m ) * conversion probability ( fig . [ maps - pre - mag ] ) : ` p_conv ` ( p ) ; + function ` conversion_probability ( ) ` ( m ) * azimuth [ deg ] ( fig .",
    "[ maps - pre - mag ] ) : ` the_deg ` ( p ) ; + ` atan2(shower_axis[1],shower_axis[0])`@xmath7180/@xmath19 ( m ) * particle type ( figs .",
    "[ fig6-pre - mag ] , [ npart - pre - mag ] and [ ee - pre - mag ] ) : output file ` part_out.dat ` ( p ) ; + ` this_particle->particleid ` ( m ) * particle energy ( figs .",
    "[ fig6-pre - mag ] , [ npart - pre - mag ] and [ ee - pre - mag ] ) : output file ` part_out.dat ` ( p ) ; + ` this_particle->energy ` ( m ) * primary gamma conversion altitude [ km ] ( figs .",
    "[ npart - pre - mag ] and [ ee - pre - mag ] ) : output file ` multirun.dat ` ( p ) ; ` first_particle->altitude`@xmath710@xmath18 ( m )        the pierre auger collaboration , proc .",
    "32nd icrc , beijing , china ( 2011 ) , vol . 2 , 105 the pierre auger collaboration , astroparticle physics 31 ( 2009 ) 399 - 406 , doi:10.1016/j.astropartphys.2009.04.003 the pierre auger collaboration , phys",
    "d 79 , 102001 ( 2009 ) , doi : 10.1103/physrevd.79.102001 the pierre auger collaboration , proc .",
    "32nd icrc , beijing , china ( 2011 ) , vol . 2 , 55 k. greisen , phys . rev",
    "* 16 * , ( 1966 ) 748 ; g.t .",
    "zatsepin and v.a .",
    "kuzmin , zh .",
    ". fiz . * 4 * , ( 1966 ) 114 the pierre auger collaboration , nucl .",
    "instr . and meth . a 523 ( 2004 ) , 50 b.  mcbreen and c.j .",
    "lambert , phys .",
    "d * 24 * , ( 1981 ) 2536 p. homola et al . ,",
    "commun . 173",
    "( 2005 ) 71 m. risse and p. homola , mod .",
    "phys . lett . a 22 ( 2007 ) , 749 d. heck , j.  knapp , j.n .",
    "capdevielle , g.  schatz , and t.  thouw , report fzka 6019 , forschungszentrum karlsruhe , 1998 ( available at www-ik.fzk.de/~heck/corsika/ ) s.j .",
    "sciutto , [ arxiv : astro - ph/9911331 ] ; www.fisica.unlp.edu.ar/auger/aires"
  ],
  "abstract_text": [
    "<S> the discrepancies in the results produced by the two most commonly used monte carlo programs for simulation of propagation of ultra - high energy cosmic ray photons in the presence of the geomagnetic field are presented . </S>",
    "<S> although photons have not yet been discovered in the cosmic ray flux at highest energies , the capabilities of the present cosmic ray detectors make their discovery possible , according to the predictions of conventional models , within the next few years . </S>",
    "<S> it is therefore necessary to have a reliable and well maintained software for relevant simulations . </S>",
    "<S> the results of this paper are important for simulations of propagation of photons at energies above 10@xmath0  ev . </S>",
    "<S> photons of such high energies might interact with the geomagnetic field giving rise to a cascade of particles even above the atmosphere . </S>",
    "<S> this effect is called a `` preshower effect '' . </S>",
    "<S> the preshower effect is important for air shower evolution and has to be accounted for in full monte carlo simulations of propagation of highest energy cosmic - ray photons . in this paper </S>",
    "<S> we compare the two most frequently used monte carlo codes for preshower simulations : preshower , used as a stand - alone program or as a part of corsika , and magics , used as a part of aires .    </S>",
    "<S> ultra - high energy cosmic rays , extensive air showers , geomagnetic cascading , gamma conversion , preshower , aires , magics </S>"
  ]
}