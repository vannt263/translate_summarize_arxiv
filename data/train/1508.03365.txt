{
  "article_text": [
    "this paper investigates how well one may estimate an unknown structural function @xmath0 of endogenous regressors in sup - norm loss , where @xmath0 is identified by a nonparametric instrumental variables ( npiv ) model : @xmath5=0 $ ] , where @xmath6 is a vector of endogenous regressors and @xmath7 is a vector of instrumental variables .",
    "we show that a computationally simple sieve npiv estimator , which is also called a sieve minimum distance or series 2sls estimator @xcite , can attain the best possible sup - norm convergence rates when spline or wavelet sieves are used to approximate the unknown @xmath0 .",
    "we introduce a novel data - driven procedure to choose the key regularization parameter , namely the sieve dimension ( for approximating @xmath0 ) , of the sieve npiv estimator .",
    "the procedure is shown to be sup - norm rate adaptive to the unknown smoothness of @xmath0 and the unknown degree of ill - posedness of the npiv model .",
    "in fact , we show that the same data - driven choice of the sieve dimension simultaneously leads to the optimal sup - norm rates for estimating @xmath0 and its derivatives .",
    "sup - norm ( uniform ) convergence rates for nonparametric estimators of @xmath0 and its derivatives provide sharper measures on how well the unknown function @xmath0 and its derivatives could be estimated given a sample of size @xmath8 .",
    "equally or perhaps more importantly , they are very useful to control the nonlinearity bias when conducting inference on nonlinear functionals of @xmath0 , such as the exact consumer surplus and deadweight loss welfare functionals in nonparametric demand estimation @xcite .",
    "npiv estimation has been the subject of much recent research , both because of its importance to applied economics and its prominent role in the literature on ill - posed inverse problems with unknown operators .",
    "in addition to the sieve npiv estimator @xcite , other estimators have also been considered in the literature ; see @xcite and references therein . to the best of our knowledge ,",
    "all the published works on convergence rates for various npiv estimators have only studied @xmath1-norm ( or closely related hilbert - norm ) convergence rates . in particular , @xcite are the first to establish the minimax lower bound in @xmath1-norm loss for estimating @xmath0 for mildly ill - posed npiv models , and show that their estimators attain the lower bound . @xcite",
    "derive the minimax lower bound in @xmath1-norm loss for estimating @xmath0 for npiv models that could be mildly or severely ill - posed , and show that the sieve npiv estimator achieves the lower bound .- norm rates . ] recently , for @xcite s modified orthogonal series npiv estimator , @xcite proposed a data - driven procedure for choosing the orthogonal series dimension that is near @xmath1-norm rate - adaptive in that his procedure attains the optimal @xmath1-norm rate up to a @xmath9^{1/2}$ ] factor for both mildly or severely ill - posed models .",
    "as yet there are no published results on sup - norm convergence rates for _ any _ npiv estimator , nor are there results on what are the minimax lower bounds in sup - norm loss for any class of npiv models .",
    "further , there is no prior work on any data - driven procedure that is sup - norm rate adaptive to the unknown smoothness of the function @xmath0 and the unknown degree of ill - posedness of the npiv model .    in this paper",
    "we study the sup - norm convergence properties of the sieve npiv estimator of the unknown @xmath0 and its derivatives .",
    "we focus on this estimator because , in addition to its known @xmath1-norm rate optimality for estimating @xmath0 , it has been used extensively in empirical work and can be implemented as a simple two stage least squares ( 2sls ) estimator even when @xmath6 contains both endogenous and exogenous regressors .",
    "we first establish a general upper bound on the sup - norm convergence rate of any sieve npiv estimator .",
    "when @xmath0 belongs to a hlder ball of functions with smoothness @xmath10 , we obtain the sup - norm convergence rates of the spline and wavelet sieve npiv estimators for estimating @xmath0 and its derivatives jointly .",
    "we then derive the minimax lower bounds in sup - norm loss for @xmath0 and its derivatives uniformly over a hlder ball of functions .",
    "the lower bounds are shown to equal our sup - norm convergence rates for the spline and wavelet sieve npiv estimators of @xmath0 and its derivatives .",
    "surprisingly , these optimal sup - norm convergence rates for estimating @xmath0 and its derivatives coincide with the optimal @xmath1-norm rates for severely ill - posed problems , and are a factor of @xmath2^{\\epsilon}$ ] ( with @xmath11 ) slower than the optimal @xmath1-norm rates for mildly ill - posed problems .",
    "for the expression of @xmath12 and the complementary results on @xmath1-norm rate optimality of sieve npiv estimators for estimating the derivatives of @xmath0 .",
    "]    in practice , to attain the optimal sup - norm convergence rates of the sieve npiv estimator one must choose the sieve dimension to balance the sup - norm bias term and the sup - norm sampling error term ( loosely called the `` standard deviation '' term ) .",
    "the sup - norm bias term depends on the smoothness of the unknown function @xmath0 and the sup - norm standard deviation term depends on the degree of ill - posedness of the unknown npiv operator .",
    "therefore , it is important to have a method for choosing the optimal sieve dimension without knowing these unknowns . we introduce a new data - driven procedure for choosing the sieve dimension for approximating @xmath0 .",
    "we show that our data - driven choice of sieve dimension is optimal in that the resulting sieve npiv estimators of @xmath0 and its derivatives attain their optimal sup - norm rates .",
    "interestingly , our data - driven procedure automatically leads to optimal @xmath1-norm rate adaptivity for severely ill - posed models , and optimal @xmath1-norm rate adaptivity up to a factor of @xmath2^{\\epsilon}$ ] ( with @xmath11 ) for mildly ill - posed models .",
    "our data - driven procedure is different from the model selection procedure proposed by @xcite for his modified orthogonal series npiv estimator , which might explain why our procedure leads to a @xmath1-norm rate that is faster than his procedure .",
    "a monte carlo study indicates that our sup - norm rate - adaptive procedure performs well in finite samples .",
    "we illustrate the usefulness of the sup - norm convergence rate results with two non - trivial applications , each of which makes new contribution to inference on _ nonlinear _ welfare functionals in npiv estimation .",
    "inference on nonlinear functionals of @xmath0 in a npiv model is very difficult because of the combined effects of nonlinearity bias and slow rates of convergence of any npiv estimators in @xmath13 norms for @xmath14 . in the first application , we extend the important work by @xcite on nonparametric estimation of exact consumer surplus and deadweight loss functionals to allow for prices , and possibly incomes , to be endogenous .",
    "specifically , we use our sup - norm convergence rates for estimating the demand function @xmath0 and its derivatives to linearize plug - in estimators of exact consumer surplus and deadweight loss functionals .",
    "this linearization immediately leads to asymptotic normality of sieve @xmath4 statistics for exact consumer surplus and deadweight loss using our pointwise limit theory in appendix [ s - pw ] .",
    "derives the pointwise asymptotic normality of sieve @xmath4 statistics of nonlinear functionals of npiv under lower - level conditions with faster growth of sieve dimension than those in @xcite for functionals of general semi / nonparametric conditional moment restrictions . ]",
    "our second important application is to sieve score bootstrap uniform confidence bands for collections of nonlinear functionals of @xmath0 ; see appendix [ s - ucb ] for details .",
    "the rest of the paper is organized as follows .",
    "section [ npiv sec ] establishes the optimal rates of convergence for estimating @xmath0 and its derivatives in a npiv model .",
    "section [ s - adaptive ] introduces a data - driven sup - norm rate - adaptive procedure for sieve npiv estimators .",
    "section [ s - inference ] provides an application to inference on exact consumer surplus and deadweight loss functionals in nonparametric demand estimation with endogeneity .",
    "appendices [ s - pw ] and [ s - ucb ] present low - level conditions for pointwise and bootstrap uniform limit theories for sieve @xmath4 statistics of general nonlinear functionals of @xmath0 in a npiv model respectively .",
    "the online appendix contains background materials on b - spline and wavelet sieve spaces ( appendix [ ax - basis ] ) , technical lemmas and all the proofs ( appendix [ ax - proofs ] ) , and supplementary useful lemmas on random matrices ( appendix [ ax - supp ] ) .",
    "* notation : * throughout we work on a complete probability space @xmath15 .",
    "@xmath16 denotes the complement of a measurable event @xmath17 .",
    "we abbreviate `` with probability approaching one '' to `` wpa1 '' , and say that a sequence of events @xmath18 holds wpa1 if @xmath19 . for a random variable @xmath20",
    "we define the space @xmath21 as the equivalence class of all measurable functions of @xmath20 with finite @xmath22th moment if @xmath23 ; when @xmath24 with some abuse of notation we take @xmath25 to mean the set of all bounded measurable @xmath26 endowed with the sup norm @xmath27 .",
    "we let @xmath28 denote the inner product on @xmath29 . for matrix and vector norms",
    ", @xmath30 denotes the vector @xmath31 norm when applied to vectors and the operator norm induced by the vector @xmath31 norm when applied to matrices .",
    "if @xmath32 and @xmath33 are scalars we let @xmath34 and @xmath35 .",
    "this section consists of several subsections .",
    "subsection [ s - mep ] outlines the npiv model and the estimator .",
    "subsections [ s - upper ] and [ s - lower ] first establish a general upper bound on the sup - norm convergence rates for any sieve npiv estimator and then the minimax lower bound in sup - norm loss , allowing for both mildly and severely ill - posed problems .",
    "these results together lead to the optimal sup - norm convergence rates for spline and wavelet sieve npiv estimators for estimating @xmath0 and its derivatives .",
    "subsection [ s - l2 ] shows that the sieve npiv estimator attains the optimal @xmath1-norm convergence rates for estimating @xmath0 and its derivatives under much weaker conditions .",
    "finally subsection [ s - exog ] considers an extended npiv model with endogenous and exogenous regressors .      throughout the paper",
    "the data @xmath36 is assumed to be a random sample from the nonparametric instrumental variables ( npiv ) model @xmath37 & = & 0 , \\end{array } \\label{npreg}\\]]where @xmath38 is a scalar response variable , @xmath39 is a @xmath40-dimensional endogenous regressor , and @xmath41 is a @xmath42 vector of ( conditional ) instrumental variables .",
    "the sieve npiv ( or series 2sls ) estimator @xmath43 of @xmath0 may be written in matrix form as @xmath44 ^ - \\psi'b ( b'b)^- b'{y}\\ ] ] where @xmath45 and @xmath46 ( see @xcite ) .",
    "the crucial _ regularization _ parameter to be chosen is the dimension @xmath47 of the sieve space used to approximate the structural function @xmath0 .",
    "the _ smoothing _",
    "parameter @xmath48 is the dimension of the instrument space , and is assumed to grow at the order of @xmath49 . from the analogy with 2sls ,",
    "it is clear that we need @xmath50 .",
    "( the `` over identified '' case ) than with @xmath51 ( the `` just identified '' case ) , and that the regularization parameter @xmath47 is important for finite sample performance while the parameter @xmath48 is not important as long as it is larger than @xmath47 .",
    "] when @xmath52 , @xmath53 and @xmath54 , the sieve 2sls estimator becomes @xcite s modified orthogonal series npiv estimator .",
    "the coefficient estimator @xmath55 is the 2sls estimator of the parameter vector @xmath56 satisfying @xmath57=0\\,.\\ ] ] define @xmath58 \\\\",
    "g_b & = & g_{b , k } & = & e[b^k(w_i)b^k(w_i ) ' ] \\\\   s & = & s_{jk } & = & e[b^k(w_i)\\psi^j(x_i ) ' ] \\ , .",
    "\\end{array}\\ ] ] we assume that @xmath59 has full column rank @xmath47 and that @xmath60 and @xmath61 are positive definite for each @xmath47 and @xmath48 , i.e. , @xmath62 for each @xmath47 and @xmath63 for each @xmath48 . then @xmath64 can be expressed as @xmath65^{-1 } s ' g_b^{-1 } e[b^k(w_i)y_i]= [ s ' g_b^{-1 } s]^{-1 } s ' g_b^{-1 } e[b^k(w_i)h_0 ( x_i)]\\,.\\ ] ] we refer to @xmath66 as the sieve 2sls approximation to @xmath0 .    to introduce a measure of ill - posedness ,",
    "let @xmath67 denote the conditional expectation operator given by @xmath68\\,.\\ ] ] the operator @xmath69 is compact when @xmath20 is endogenous under mild conditions on the conditional density of @xmath20 given @xmath70 ( see , e.g. , @xcite ) .",
    "let @xmath71 and @xmath72 denote the sieve spaces for the endogenous and instrumental variables , respectively .",
    "for a discussion .",
    "] let @xmath73",
    ". the _ sieve @xmath1 measure of ill - posedness _",
    "is @xmath74 following @xcite , we call a npiv model : + ( i ) _ mildly ill - posed _ if @xmath75 for some @xmath76 ; and + ( ii ) _ severely ill - posed _ if @xmath77 for some @xmath78 .      to derive the sup - norm ( uniform ) convergence rate we split @xmath79 into so - called bias and variance terms and derive sup - norm convergence rates for the two terms",
    ". specifically , let @xmath80 ^ - \\psi'b ( b'b)^- b'h_0\\ ] ] where @xmath81 .",
    "we say that @xmath82 is the `` bias '' term and @xmath83 is the `` standard deviation '' ( or sometimes loosely called `` variance '' ) term .",
    "both are random quantities .",
    "we first introduce some basic conditions on the supports of the data , identification , true residuals and the sieve spaces .",
    "[ a - data ] ( i ) @xmath6 has compact rectangular support @xmath84 with nonempty interior and the density of @xmath6 is uniformly bounded away from @xmath85 and @xmath86 on @xmath87 ; ( ii ) @xmath7 has compact rectangular support @xmath88 and the density of @xmath7 is uniformly bounded away from @xmath85 and @xmath86 on @xmath89 ; ( iii ) @xmath67 is injective ; and ( iv ) @xmath90 and @xmath91 for @xmath92 with @xmath93 dense in @xmath94 .",
    "[ a - residuals ] ( i ) @xmath95 \\leq \\overline \\sigma^2 < \\infty$ ] ; and ( ii ) @xmath96 < \\infty$ ] for some @xmath97 .",
    "we say that the sieve basis for @xmath98 is hlder continuous if there exist finite constants @xmath99 such that @xmath100 for all @xmath101 .",
    "let @xmath102 for each @xmath47 and @xmath48 and define @xmath103 .",
    "note that @xmath104 has some useful properties : @xmath105 for all @xmath106 , and @xmath107)^{1/2 } \\leq \\zeta_{\\psi , j } \\leq \\xi_{\\psi , j } / \\sqrt{e_j}$ ] ; clearly @xmath108 has similar properties .",
    "[ a - sieve ] ( i ) the basis spanning @xmath98 is hlder continuous ; ( ii ) @xmath109 ; and ( iii ) @xmath110 .    let @xmath111 denote the @xmath112 orthogonal projection onto @xmath113 ( the sieve instrumental variables space ) .",
    "[ a - approx ] ( i ) @xmath114 .",
    "assumption [ a - data ] is standard . parts ( i ) and ( ii ) just place some mild regularity conditions on the support of the data . part ( iii ) is typically satisfied in models with endogeneity ( e.g. @xcite ) .",
    "the parameter space @xmath115 for @xmath0 in part ( iv ) is typically taken to be a hlder or sobolev class .",
    "assumption [ a - residuals](i)(ii ) are also imposed for sup - norm convergence rates for series ls regression without endogeneity ( e.g. , @xcite ) .",
    "assumption [ a - sieve](i ) is satisfied by most commonly used sieve bases . assumption [ a - sieve](ii)(iii ) restrict the maximum rate at which @xmath47 can grow with the sample size .",
    "upper bounds for @xmath104 and @xmath108 are known for commonly used bases under standard regularity conditions .",
    "for instance , under assumption [ a - data](i)(ii ) , @xmath116 and @xmath117 for ( tensor - product ) polynomial spline , wavelet and cosine bases , and @xmath118 and @xmath119 for ( tensor - product ) orthogonal polynomial bases ( see , e.g. , @xcite and online appendix [ ax - basis ] ) .",
    "assumption [ a - approx](i ) is a very mild condition on the approximation properties of the basis used for the instrument space and is similar to the first part of assumption 5(iv ) of @xcite .",
    "it is trivially satisfied with @xmath120 for all @xmath106 when the basis functions for @xmath113 and @xmath98 form either a riesz basis or eigenfunction basis for the conditional expectation operator .",
    "[ lem - chat ] let assumptions [ a - data](i)(iii ) , [ a - residuals](i)(ii ) , [ a - sieve](ii)(iii ) , and [ a - approx](i ) hold .",
    "then : + ( 1 ) @xmath121 . + ( 2 ) if assumption [ a - sieve](i ) also holds , then : @xmath122    recall that @xmath123 . result ( 2 ) of lemma [ lem - chat ] provides a slightly tighter upper bound on the variance term than result ( 1 ) does , while result ( 1 ) allows for slightly more general basis to be used to approximate @xmath0 . for splines and wavelets ,",
    "we show in appendix [ ax - basis ] that @xmath124 , so results ( 1 ) and ( 2 ) produce the same tight upper bound @xmath125 on @xmath83 .      before we provide a bound on the sup - norm `` bias '' term @xmath82 , we introduce various non - random projections of @xmath0 onto the sieve approximating space @xmath98 , which imply different sieve approximation errors for @xmath0 that have close relations among themselves .",
    "let @xmath126 denote the @xmath29 orthogonal projection onto @xmath98 and then @xmath127 . let @xmath128 denote the sieve 2sls projection of @xmath0 onto @xmath98 , which is @xmath129 .",
    "let @xmath130 denote the iv projection of @xmath0 onto @xmath98 .",
    "\\(ii ) @xmath131 ; and + ( iii ) @xmath132 .",
    "assumption [ a - approx](ii ) is the usual @xmath1 `` stability condition '' imposed in the npiv literature ( see assumption 6 in @xcite and assumption 5.2(ii ) in @xcite and their sufficient conditions ) .",
    "assumption [ a - approx](iii ) is a new @xmath133 `` stability condition '' to control for the sup - norm bias . instead of assumption",
    "[ a - approx](iii ) , we could impose the following assumption [ a - approx](iii ) .",
    "* assumption [ a - approx ] * _ ( iii ) _ @xmath134 .",
    "[ lem - approx - new ] let assumptions [ a - data](iii ) and [ a - approx](ii ) hold . then : + ( 1 ) @xmath135 ; + ( 2 ) if assumption [ a - approx](i ) also holds , then : @xmath136 .",
    "+ ( 3 ) further , if assumption [ a - approx](iii ) and @xmath137 hold then assumption [ a - approx](iii ) is satisfied .    in light of lemma [ lem - approx - new ] results ( 1 ) and ( 2 ) , both assumption [ a - approx](iii ) and condition ( [ e - piapprox ] )",
    "seem mild .",
    "in fact , condition ( [ e - piapprox ] ) is trivially satisfied when the basis for @xmath98 is a riesz basis because then @xmath138 ( see section 6 in @xcite ) .",
    "see lemma [ lem - approx ] in the online appendix [ ax - proofs ] for more detailed relations among @xmath139 , @xmath140 and @xmath141 .",
    "let @xmath142 solve @xmath143 . then : @xmath144 where @xmath145 is the lebesgue constant for the sieve @xmath98 ( see lebesgue s lemma in @xcite , page 30 ) .",
    "recently it has been established that @xmath146 when @xmath98 is spanned by a tensor product b - spline basis ( @xcite ) or a tensor product cdv wavelet basis ( @xcite ) .",
    "see @xcite and @xcite for examples of other bases with bounded lebesgue constant or with lebesgue constant diverging slowly with the sieve dimension .",
    "the next lemma provides a bound on the sup - norm `` bias '' term .",
    "[ lem - bias ] let assumptions [ a - data](iii ) , [ a - sieve](ii ) and [ a - approx ] hold . then : + ( 1 ) @xmath147 . + ( 2 ) @xmath148 .",
    "lemmas [ lem - chat](1 ) and [ lem - bias ] immediately yield the following general sup - norm rate result .",
    "[ t - rate ] ( 1 ) let assumptions [ a - data](i)(iii)(iv ) , [ a - residuals](i)(ii ) , [ a - sieve](ii)(iii ) , and [ a - approx ] hold . then : @xmath149 ( 2 ) further , if the linear sieve @xmath98 satisfies @xmath146 and @xmath124 , then @xmath150    the following corollary provides concrete sup - norm convergence rates of @xmath43 and its derivatives . to introduce the result ,",
    "let @xmath151 denote the hlder space of smoothness @xmath152 and @xmath153 denote its norm ( see @xcite ) .",
    "let @xmath154 denote a hlder ball of smoothness @xmath152 and radius @xmath155 .",
    "let @xmath156 be non - negative integers , let @xmath157 , and define @xmath158 of course , if @xmath159 then @xmath160 .",
    "then we assume @xmath161 and its derivatives can be continuously extended to an open set containing @xmath87 so that @xmath162 is well defined for all @xmath163 . ]    [ c - deriv ] let assumptions [ a - data](i)(ii)(iii ) and [ a - approx ] hold .",
    "let @xmath164 , @xmath98 be spanned by a b - spline basis of order @xmath165 or a cdv wavelet basis of regularity @xmath165 , @xmath113 be spanned by a cosine , spline or wavelet basis .",
    "+ ( 1 ) if assumption [ a - sieve](ii ) holds , then @xmath166 ( 2 ) further if assumptions [ a - residuals](i)(ii ) and [ a - sieve](iii ) hold , then @xmath167 ( 2.a ) mildly ill - posed case : with @xmath168 and @xmath169 , choosing @xmath170 implies that assumption [ a - sieve](ii)(iii ) holds and @xmath171 ( 2.b ) severely ill - posed case : choosing @xmath172 with @xmath173 implies that assumption [ a - sieve](ii)(iii ) holds and @xmath174    corollary [ c - deriv ] is very useful for linearizing plug - in estimators of nonlinear functionals of @xmath0 to establish pointwise and uniform limit theory ; see appendices [ s - pw ] and [ s - ucb ] .",
    "corollary [ c - deriv ] is also useful for estimating functions with certain shape properties .",
    "for instance , if @xmath175 \\to \\mathbb r$ ] is strictly monotone and/or strictly concave / convex then knowing that @xmath176 and/or @xmath177 converge uniformly to @xmath178 and/or @xmath179 implies that @xmath43 will also be strictly monotone and/or strictly concave / convex with probability approaching one .",
    "we now establish ( minimax ) optimality of the sup - norm rates obtained in corollary [ c - deriv ] . previously , @xcite and @xcite derived optimal @xmath1 norm rates for estimating @xmath0 .",
    "we complement their analysis by deriving optimal sup - norm rates for estimating @xmath0 and its derivatives .    to establish a lower bound we require a link condition which measures how much the conditional expectation operator @xmath69 smoothes out the structural function @xmath0 .",
    "consider the ball @xmath180 where @xmath181 is a tensor product cdv wavelet basis for @xmath182^d$ ] of regularity @xmath183 ( see appendix [ ax - basis ] for more details ) and @xmath184 .",
    "the ball @xmath185 is equivalent to the sobolev ball @xmath186 ( see section [ s - l2 ] ) since for any @xmath185 there exists @xmath187 such that @xmath188 .",
    "[ [ condition - lb ] ] condition lb + + + + + + + + + + + +    _ ( i ) assumption [ a - data](i)(iii ) holds ; ( ii ) @xmath189 \\geq \\underline \\sigma^2 > 0 $ ] uniformly for @xmath190 ; and ( iii ) @xmath191 .",
    "_    condition lb(i)(ii ) is standard ( see @xcite and @xcite ) . condition lb(iii ) is a so - called link condition @xcite . in an earlier version of the paper we derived a lower bound for @xmath0 in the",
    "mildly ill - posed case under the condition @xmath192 for some @xmath78 , which corresponds to choosing @xmath193 in the above condition .",
    "here we also allow for the severely ill - posed case , which corresponds to choosing @xmath194 .",
    "let @xmath195 denote the probability measure of the data when the structural function is @xmath161 .",
    "[ npiv lower bound ] let condition lb hold for the npiv model with a random sample @xmath196 . then for any @xmath197 : @xmath198 in the mildly ill - posed case , and @xmath199 in the severely ill - posed case , where @xmath200 denotes the infimum over all estimators of @xmath201 based on the sample of size @xmath8 , and the finite positive constants @xmath202 do not depend on @xmath8 .",
    "here we show that the sieve npiv estimator and its derivatives can attain the optimal @xmath1-norm convergence rates for estimating @xmath0 and its derivatives under much weaker conditions the optimal @xmath1-norm rates for sieve npiv derivative estimation presented in this section are new , and should be very useful for inference on some nonlinear functionals involving derivatives such as @xmath203 .",
    "[ t - l2 ] let assumptions [ a - data](iii ) and [ a - approx](i)(ii ) hold and let @xmath204 . then : + ( 1 ) @xmath205 . + ( 2 )",
    "further , if assumption [ a - residuals](i ) holds then @xmath206    the following corollary provides concrete @xmath1 norm convergence rates of @xmath43 and its derivatives . to introduce the result ,",
    "let @xmath207 denote the sobolev norm of smoothness @xmath208 ( see @xcite ) , @xmath209 denote the sobolev space of smoothness @xmath152 , and @xmath210 denote a sobolev ball of smoothness @xmath152 and radius @xmath211 .",
    "[ c - rate2 ] let assumptions [ a - data](i)(ii)(iii ) and [ a - approx](i)(ii ) hold .",
    "let @xmath212 , @xmath98 be spanned by a cosine basis , b - spline basis of order @xmath165 , or cdv wavelet basis of regularity @xmath165 , @xmath113 be spanned by a cosine , spline , or wavelet basis .",
    "+ ( 1 ) if @xmath213 holds , then @xmath214 ( 2 ) further if assumption [ a - residuals](i ) holds , then @xmath215 ( 2.a ) mildly ill - posed case : choosing @xmath216 yields @xmath213 and @xmath217 ( 2.b ) severely ill - posed case : choosing @xmath172 for any @xmath173 yields @xmath213 and @xmath218    the conclusions of corollary [ c - rate2 ] hold if an arbitrary basis is used for @xmath113 under the condition @xmath219 .",
    "our next theorem shows that the rates obtained in corollary [ c - rate2 ] are in fact optimal .",
    "it extends the earlier work by @xcite on the minimax lower bound in @xmath1 loss for estimating @xmath0 to that for estimating the derivatives , allowing for both mildly and severely ill - posed npiv problems .",
    "[ t - lb - l2 ] let condition lb hold for the npiv model with a random sample @xmath196 . then for any @xmath197 : @xmath220 in the mildly ill - posed case , and @xmath221 in the severely ill - posed case , where @xmath200 denotes the infimum over all estimators of @xmath201 based on the sample of size @xmath8 , and the finite positive constants @xmath202 do not depend on @xmath8 .",
    "according to theorems [ npiv lower bound ] and [ t - lb - l2 ] , the minimax lower bounds in sup - norm loss for estimating @xmath0 and its derivatives coincide with those in @xmath1 loss for severely ill - posed npiv problems , and are only a factor of @xmath2^{\\epsilon}$ ] ( with @xmath222 ) worse than those in @xmath1 loss for mildly ill - posed problems .",
    "we finish by discussing briefly models of the form @xmath223 where @xmath224 is a vector of endogenous regressors and @xmath225 is a vector of exogenous regressors . let @xmath226 . here",
    "the vector of instrumental variables @xmath7 is of the form @xmath227 where @xmath228 are instruments for @xmath224 .",
    "we refer to this as the `` partially endogenous case '' .",
    "the sieve npiv estimator is implemented in exactly the same way as the `` fully endogenous '' setting in which @xmath6 consists only of endogenous variables , just as with 2sls estimation with endogenous and exogenous variables @xcite .",
    "other npiv estimators based on first estimating the conditional densities of the regressors variables and instrumental variables must be implemented separately at each value of @xmath229 in the partially endogenous case @xcite .",
    "our convergence rates presented in sections [ s - upper ] and [ s - l2 ] apply equally to the partially endogenous model ( [ e - p - exog ] ) under the stated regularity conditions : all that differs between the two cases is the interpretation of the sieve measure of ill - posedness .",
    "consider first the fully endogenous case where @xmath67 is compact .",
    "then @xmath69 admits a singular value decomposition ( svd ) @xmath230 where @xmath231 , @xmath232 for each @xmath233 and @xmath234 and @xmath235 are orthonormal bases for @xmath29 and @xmath112 , respectively .",
    "suppose that @xmath98 spans @xmath236 .",
    "then the sieve measure of ill - posedness is @xmath237 ( see @xcite ) .",
    "now consider the partially endogenous case .",
    "similar to @xcite , we suppose that for each value of @xmath229 the conditional expectation operator @xmath238 given by @xmath239 $ ] is compact .",
    "then each @xmath240 admits a svd @xmath241 where @xmath242 , @xmath243 , @xmath244 , @xmath245 for each @xmath233 and @xmath229 , and @xmath246 and @xmath247 are orthonormal bases for @xmath248 and @xmath249 , respectively , for each @xmath229 .",
    "the following result adapts lemma 1 of @xcite to the partially endogenous setting .",
    "[ lem - bck ] let @xmath240 be compact with svd @xmath241 for each @xmath229 .",
    "let @xmath250 $ ] and @xmath251 for each @xmath229 and @xmath233 . then : ( 1 ) @xmath252 . + ( 2 ) if , in addition , @xmath253 , then : @xmath254 .",
    "the following stylized example illustrates the behavior in the partially endogenous case relative to that in the fully endogenous case .",
    "let @xmath224 , @xmath228 and @xmath225 be scalar random variables and let @xmath255 be distributed as @xmath256 and @xmath257 are such that the covariance matrix is positive definite .",
    "then @xmath258 where @xmath259 is the partial correlation between @xmath224 and @xmath228 given @xmath225 .    for each @xmath260 let @xmath261 denote the @xmath233th hermite polynomial subject to the normalizations @xmath262 and @xmath263 for @xmath264 where @xmath265 denotes the kronecker delta and @xmath266 is the standard normal distribution .",
    "since @xmath238 is compact for each @xmath229 , it follows from mehler s formula that each @xmath240 has a svd @xmath241 given by @xmath267 since @xmath268 for each @xmath229 , we have @xmath269 . if @xmath224 and @xmath228 are uncorrelated with @xmath225 then @xmath270 where @xmath271 .",
    "now compare the partially endogenous case just described with the following fully - endogenous model in which @xmath6 and @xmath7 are bivariate with @xmath272 where @xmath273 and @xmath274 are such that the covariance matrix is invertible .",
    "it is straightforward to verify that @xmath69 has singular value decomposition with @xmath275 in particular , when @xmath276 we have @xmath277 .    in both of the preceding examples ,",
    "@xmath0 is a function of two random variables ( @xmath278 ) .",
    "the degree of ill - posedness in the partially endogenous case is @xmath279 where @xmath280 is the correlation between the endogenous regressor and its instrument .",
    "the degree of ill - posedness increases to @xmath281 in the fully endogenous case when each endogenous regressor has correlation @xmath280 with its instrument .",
    "we now propose a simple , data - driven method for choosing the sieve dimension , which is a novel extension of the balancing principle of @xcite to nonparametric models with endogeneity .",
    "our selection criterion is optimal in that the resulting sieve npiv estimator of @xmath0 and its derivatives attain the optimal sup - norm rates .    to describe our data - driven method for choosing @xmath47 ,",
    "let @xmath282 and let @xmath283 and @xmath284 be increasing sequences of integers which index the sieve dimension @xmath98 where @xmath285",
    ". ensures @xmath286 grows slower than the optimal choice of @xmath47 in the mildly and severely ill - posed cases . for npiv models in which @xmath287 grows faster than the severely ill - posed case , we can take @xmath286 to be an even more slowly growing function of @xmath8 than @xmath288 .",
    "] let @xmath289 denote the sequence of integers which index the dimension of the sieve spaces @xmath98 and let @xmath290 and @xmath291 .",
    "finally , let @xmath292 be a possibly random integer such that @xmath293 wpa1 ( we introduce such a data - driven choice below ) and let @xmath294 .",
    "the oracle and data - driven index sets are defined as @xmath295 respectively , where @xmath296 is a finite positive constant and @xmath297 where @xmath298 with @xmath299 , and @xmath300 is an estimator of the degree of ill - posedness @xmath301 : @xmath302 ^ 2 } } \\ ] ] where @xmath303 = b^k(w ) ( b'b / n)^- \\left ( \\frac{1}{n } \\sum_{i=1}^n b^k(w_i ) h(x_i ) \\right)\\,.\\ ] ] is a series regression estimator of @xmath304 $ ] .",
    "the variational characterization of singular values gives an alternative , computationally simple expression for @xmath300 , namely : @xmath305 where @xmath306 denotes the smallest singular value of the matrix @xmath307 and @xmath308 denotes the inverse of the positive definite square root .",
    "we specify the smoothing parameter @xmath48 as a known function of the regularization parameter @xmath47 according to a rule @xmath309 for which @xmath310 for all @xmath311 and for some @xmath312 , such as @xmath313 or @xmath314 . in what follows",
    "we let @xmath315 denote the sieve npiv estimator with regularization parameter @xmath47 and smoothing parameter @xmath316 .",
    "the set @xmath317 is the unobservable _ oracle set _ : it depends on the unknown smoothness of @xmath0 and the unknown degree of ill - posedness .",
    "we refer to @xmath318 as the _ oracle _ choice of @xmath47 as it balances the bias and variance terms asymptotically . as a consequence",
    ", we will refer to @xmath319 as the _ oracle estimator_.    the set @xmath320 is straightforward to construct from the data as it depends entirely on observables and @xmath321 , about which the researcher may have a priori information . in the definition of @xmath322",
    "is replaced by a consistent estimator .",
    "further , we show in the monte carlo exercise below that the procedure is reasonably robust to choosing too small a value of @xmath321 . ]",
    "our _ data - driven _ choice of @xmath47 is @xmath323 and @xmath324 is our data - driven sieve npiv estimator . below we will establish an oracle inequality which shows that , with high probability , the sup - norm loss of the data - driven estimator @xmath324 is bounded by a multiple of the sup - norm loss of the oracle estimator @xmath319 .",
    "our adaptive procedure relies on balancing the bias and variance terms asymptotically , so we need to bound the variance term up to known or estimable constants , which explains why we use the variance bound in lemma [ lem - chat](1 ) , i.e. , @xmath325 .",
    "this variance bound ensures that @xmath326 holds uniformly over a range of @xmath233 wpa1 , and does not affect the attainability of the optimal sup - norm rates using spline or wavelet bases for @xmath98 ( see corollary [ c - deriv ] ) .      in this section",
    "we establish oracle properties of our data - driven estimator @xmath324 .",
    "let @xmath327 denote the condition number of @xmath61 and let @xmath328 denote the condition number of @xmath329 . to simplify the notation in the following presentation , we assume for simplicity that @xmath330 , @xmath331 , @xmath301 , @xmath332 , @xmath333 , @xmath328 are all ( weakly ) increasing on @xmath334 .",
    "our proofs and conditions can easily be adapted to dispense with this assumption at the cost of more complicated notation .",
    "let @xmath335 and @xmath336 .",
    "\\(iv ) @xmath337 and @xmath338 for some @xmath339 ;",
    "( v ) @xmath340 ; ( vi ) @xmath341 and @xmath342 .",
    "assumption [ a - sieve](iv)(v ) are uniform ( for @xmath343 ) versions of assumption [ a - sieve](ii)(iii ) .",
    "the second part of assumption [ a - sieve](iv ) may be replaced be an `` enough ill - posedness '' condition requiring @xmath287 to grow faster than @xmath344 for some @xmath345 ( cf .",
    "assumption 6(iii ) of @xcite ) .",
    "assumption [ a - sieve](vi ) is a further condition on @xmath346 which allows for consistent estimation of @xmath301 and @xmath347 for all @xmath348 .",
    "we show in appendix [ ax - basis ] that @xmath349 and @xmath350 when @xmath113 and @xmath98 are spanned by ( tensor - product ) spline or wavelet bases , in which case assumption [ a - sieve](vi ) holds trivially .",
    "[ t - oracle1 ] let assumptions [ a - data ] , [ a - residuals](i)(ii ) , [ a - sieve](iv)(vi ) , and [ a - approx ] hold and let @xmath351 hold wpa1 . then : @xmath352 holds wpa1 , and so @xmath353    [ c - adapt ] let the assumptions of theorem [ t - oracle1 ] hold with @xmath164 and let @xmath98 be spanned by a ( tensor product ) b - spline or cdv wavelet basis . then : @xmath354 ( 1 ) mildly ill - posed case : if @xmath355 and @xmath356 then for all @xmath197 , @xmath357 ( 2 ) severely ill - posed case : for all @xmath197 , @xmath358    previously , @xcite introduced a model selection procedure to choose @xmath47 for his modified orthogonal series npiv estimator ( i.e. , a series 2sls estimator with @xmath359 , @xmath360 being orthonormal basis in @xmath361)$ ] ) , and showed that his data - driven choice leads to near @xmath1-norm rate adaptivity in that his estimator is a factor of @xmath362 slower than the optimal @xmath1 norm convergence rate for estimating @xmath0 ( see theorem 3.2 of @xcite).-norm rate adaptivity of estimators similar to @xcite s when the eigenfunctions of the conditional expectation operator are known . ]",
    "it follows from corollary [ c - adapt ] with @xmath159 that our data - driven estimator @xmath324 converges in sup norm ( and therefore in @xmath1 norm ) faster than that of @xcite ) s in @xmath1 norm .",
    "recently , @xcite also applied lepski s method to study near @xmath1-norm adaptive estimation of linear functionals of npiv models .",
    "@xcite proposed a data - driven method for choosing the regularization parameter in a random coefficient binary choice model that is sup - norm rate adaptive for a mildly ill - posed deconvolution type problem .",
    "see @xcite and references therein for other @xmath1-norm rate - adaptive schemes for ill - posed inverse problems in which the operator is known up to a random perturbation but is not estimated from the data . in work that is concurrent with ours , @xcite",
    "show that the model selection approach of @xcite may be used to choose the sieve dimension to minimize empirical mse in npiv models with known homoskedastic errors .. ] our procedure appears to be the first to attain both sup - norm and @xmath1-norm rate - adaptive estimation of @xmath0 and its derivatives for severely ill - posed npiv models , and sup - norm rate - adaptive and near @xmath1-norm rate adaptive for mildly ill - posed npiv models .      theorem [ t - oracle1 ] is valid for an arbitrary estimator @xmath292 of the upper level of the index set @xmath322 .",
    "we now propose such an estimator and show that it verifies the conditions of theorem [ t - oracle1 ] .",
    "we propose choosing the maximum @xmath292 of @xmath320 using the estimator @xmath363 ^ 2 \\sqrt { l(j )    ( \\log n)/n } \\geq 1\\big\\}\\ ] ] where @xmath364 for some positive constant @xmath32 and we take @xmath365 ^ 2 = j$ ] if @xmath113 and @xmath98 are spanned by a spline , wavelet , or cosine basis , and @xmath365 ^ 2 = j^2 $ ] if @xmath113 and @xmath98 are spanned by orthogonal polynomial basis .",
    "the following result shows that @xmath292 defined in ( [ e - jmaxhatdef ] ) satisfies the conditions of theorem [ t - oracle1 ] .",
    "[ t - oracle2 ] let assumptions [ a - data](iii ) , [ a - sieve](vi ) and [ a - approx](i ) hold",
    ". then there exists deterministic sequences of integers @xmath366 such that @xmath337 and @xmath293 holds wpa1 .      in this section",
    "we evaluate the performance of our adaptive procedure .",
    "we use the experimental design of @xcite , in which iid draws are generated from @xmath367 from which we then set @xmath368 . to ensure compact support of the regressor and instrument , we rescale @xmath369 and @xmath370 by defining @xmath371 and @xmath372 where @xmath266 is the gaussian cdf .",
    "we use @xmath373 for our _ linear _ design and @xmath374 for our _ nonlinear _ design ( our nonlinear @xmath0 is a re - scaled version of the @xmath0 used in @xcite ) .",
    "note that the nonlinear @xmath0 belongs to a hlder ball of smoothness @xmath208 with @xmath375 .",
    "for both designs , we generate 1000 samples of length @xmath376 and @xmath377 and implement our procedure using cubic and quartic b - spline bases with interior knots placed evenly .",
    "we use @xmath378 interior knots so that the sieve spaces @xmath113 and @xmath98 are nested as @xmath48 , @xmath47 increase .",
    "we then repeat the experiments using legendre polynomial bases ( orthonormalized with respect to the @xmath361)$ ] inner product ) .",
    "note that the results using a legendre polynomial basis for the space @xmath98 are incompatible with our earlier theory on attainability of optimal sup - norm rates .",
    "we set @xmath379 in @xmath320 for all simulation designs and then repeat the experiments with @xmath380 to investigate the sensitivity of our estimator to the user - specified value @xmath321 ( @xmath379 is the correct conditional variance of @xmath381 ) .",
    "we choose @xmath292 as described in section [ s - jmax ] with @xmath382 ( the results were insensitive to the choice of @xmath32 ) .",
    "for each sample we calculate the sup - norm and @xmath1-norm loss of our estimator @xmath324 and the sup - norm relative error ratio @xmath383 and the @xmath1-norm relative error ratio @xmath384 where @xmath385 and @xmath386 are the ( infeasible ) choices of @xmath47 which minimize the sup and @xmath1-norm errors of @xmath387 in the sample .",
    "finally , we take the average of each of @xmath388 , @xmath389 , and equations ( [ e - reri ] ) and ( [ e - rer2 ] ) across the 1000 samples",
    ".    the results of the mc exercise with @xmath376 are presented in tables [ tab - lep-1 ] and [ tab - lep-2 ] and may be summarized as follows : + ( 1 ) when implemented with a b - spline basis for @xmath98 , the sup - norm loss of our data - driven estimator @xmath324 is at most 11% larger than that of the infeasible estimator which minimizes the sup - norm loss in each sample .",
    "further , the @xmath1-norm loss of @xmath324 is at most @xmath390 larger than that of the infeasible estimator which minimizes the @xmath1-norm loss in each sample .",
    "+ ( 2 ) reducing @xmath321 from @xmath391 ( correct ) to @xmath392 ( incorrect ) has little , if any , effect on the performance of @xmath324 when a b - spline basis is used for @xmath98 .",
    "+ ( 3 ) the data - driven estimator @xmath324 again performs well with legendre polynomial bases and @xmath379 , with sup - norm loss at most 1% larger than that of the infeasible choice of @xmath47 for the linear design , and at most 15% larger than that of the infeasible choice in the nonlinear design .",
    "similar results are obtained for @xmath1 loss .",
    "+ ( 4 ) with a legendre basis , the estimator appears to perform considerably worse with the ( incorrect ) @xmath380 , especially in the linear design .",
    "this merits an explanation . in the linear case",
    ", the true model is obtained with @xmath393 .",
    "as such , the @xmath1 and sup - norm error of the infeasible estimators are very small .",
    "when @xmath380 the lepski procedure is less conservative and the data - driven estimator @xmath324 is slightly more noisy .",
    "this noise is amplified in the relative error ratios because the loss for the infeasible estimators in this design is very small .",
    "+ ( 5 ) the relative error of the estimators with @xmath394 is similar to than that obtained with @xmath51 .",
    "the absolute error ( see table [ tab - lep-2 ] ) of the estimators with @xmath394 was slightly better than that with @xmath51 .",
    "this emphasizes that the critical smoothing parameter is @xmath47 ; the choice of @xmath48 is of higher - order importance .",
    "tables [ tab - lep-3 ] and [ tab - lep-4 ] display the results for the mc simulations repeated with @xmath395 .",
    "similar conclusions are obtained , except the absolute errors are smaller with this larger sample size .",
    "we now turn to inference on policy - relevant welfare functionals in nonparametric demand estimation . following a large literature on nonparametric demand estimation ( see , e.g. , @xcite and references therein )",
    ", we assume that the demand of consumer @xmath396 for some good is given by : @xmath397 where @xmath398 is the quantity of some good demanded , @xmath399 is the price paid , and @xmath400 is the income of consumer @xmath396 , and @xmath401 is an error term . as the dependent variable , but the following analysis can easily be extended to take some transformation of @xmath402 as the dependent variable , as in @xcite . ]",
    "@xcite provided limit theory for consumer surplus and deadweight loss functionals of the nonparametric demand function @xmath0 assuming prices and incomes are _ exogenous_. in certain settings it is reasonable to allow prices , and possibly incomes , to be endogenous .",
    "one example is estimation",
    "the of gasoline demand from household - level data @xcite .",
    "even with household - level data there is evidence of endogeneity in prices @xcite .",
    "gasoline prices in a small local area and distance to the gulf coast have been suggested as instruments for gasoline price ( see @xcite and @xcite , respectively ) . in this case ,",
    "model ( [ e - demand ] ) falls into the class of models discussed in section [ s - exog ] .",
    "another example is the estimation of static models of labor supply , in which @xmath398 represents hours worked , @xmath399 is the wage , and @xmath400 is other income . in this setting",
    "it is reasonable to allow for endogeneity of both @xmath399 and @xmath400 ( see @xcite , @xcite , and references therein ) .",
    "therefore , we extend the analysis of @xcite to allow for potential endogeneity in prices and incomes .    previously , @xcite established convergence rates for plug - in estimators of consumer surplus allowing for endogeneity of prices .",
    "more recently , @xcite nonparametrically estimated exact deadweight loss from a first - stage kernel - based estimate of the demand function @xmath0 ( subject to the slutsky inequality restriction ) allowing for endogeneity of prices .",
    "neither of these papers established asymptotic distribution of their estimators .",
    "the first functional of interest is exact consumer surplus ( cs ) , namely the equivalent variation of a price change from @xmath403 to @xmath404 at income level @xmath405 ( fixed over the price change ) , which we denote by @xmath406 .",
    "let @xmath407 \\to \\mathbb r$ ] denote a twice continuously differentiable path with @xmath408 and @xmath409 .",
    "@xcite shows that @xmath406 is the solution to @xmath410   \\mathsf s_{\\mathsf y}(\\mathsf p(1 ) ) & = & 0\\ , .",
    "\\end{array}\\ ] ] the second functional of interest is the deadweight loss ( dwl ) of the price change from @xmath403 to @xmath404 at income level @xmath405 : @xmath411 in what follows we use the notation @xmath412 in this notation we have @xmath413 and @xmath414 .",
    "we estimate cs and dwl using the plug - in estimators @xmath415 and @xmath416 .",
    "where @xmath417 is an estimated expenditure function which is obtained as the solution to a differential equation which , up to a change of sign , is the same as ( [ e - cs ] ) . ]    as is evident from @xcite , sup - norm convergence rates of @xmath43 and its derivatives are required to control the nonlinearity bias when estimating cs and dwl using the plug - in estimators @xmath415 and @xmath416 .",
    ", in which case @xmath418 and @xmath419 are linear functionals of @xmath0 . ]",
    "both cs and dwl will typically be irregular ( i.e. slower than @xmath420-estimable ) functionals of @xmath0 when prices and incomes are allowed to be endogenous .",
    "inference on @xmath421 and @xmath422 may be performed using studentized sieve @xmath4-statistics . to estimate the sieve variance of @xmath415 and @xmath416 ,",
    "define @xmath423 & = & \\int_{0}^{1 } \\left ( \\psi^j ( \\mathsf p(t),\\mathsf y-\\widehat{\\mathsf s}_{\\mathsf y}(t ) ) e^{-\\int_{0}^t \\partial_2 \\widehat h ( \\mathsf p(v),\\mathsf y-\\widehat{\\mathsf s}_{\\mathsf y}(v ) ) \\mathsf p'(v)\\,\\mathrm dv } \\mathsf p'(t)\\right)\\mathrm dt \\\\",
    "\\frac{\\partial f_{dwl}(\\widehat h)}{\\partial h}[\\psi^j ] & = & \\frac{\\partial f_{cs}(\\widehat h)}{\\partial h}[\\psi^j ] + ( \\mathsf p^1 - \\mathsf p^0 ) \\psi^j(\\mathsf p^1,\\mathsf y)\\end{aligned}\\ ] ] where @xmath424 and @xmath425 denotes the partial derivative of @xmath161 with respect to its second argument and @xmath426 denotes the solution to ( [ e - cs ] ) with @xmath43 in place of @xmath0 .",
    "the sieve variances of @xmath427 and @xmath428 are @xmath429'[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1 } \\widehat \\omega \\widehat g_b^{-1 } \\widehat s[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\frac{\\partial f_{cs}(\\widehat h)}{\\partial h}[\\psi^j ] \\\\",
    "\\widehat v_{dwl , n } & = & \\frac{\\partial f_{dwl}(\\widehat h)}{\\partial h}[\\psi^j]'[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1 } \\widehat \\omega \\widehat g_b^{-1 } \\widehat s[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\frac{\\partial f_{dwl}(\\widehat h)}{\\partial h}[\\psi^j]\\end{aligned}\\ ] ] where @xmath430 , @xmath431 , and @xmath432 with @xmath433 and @xmath434 .",
    "we take @xmath435 to be a @xmath436 vector of instruments when @xmath399 and @xmath400 are endogenous , and we take @xmath437 when @xmath400 is exogenous where @xmath438 an instrument for @xmath399",
    ".    we now present regularity conditions under which sieve @xmath4-statistics for @xmath415 and @xmath416 are asymptotically @xmath439 . in the case",
    "in which both @xmath399 and @xmath400 are endogenous , let @xmath440 be compact with singular value decomposition @xmath230 where @xmath441 and @xmath234 and @xmath234 are orthonormal bases for @xmath442 and @xmath443 , respectively . in the case in which @xmath399 is endogenous but @xmath400 is exogenous , we let @xmath444 be compact with singular value decomposition @xmath445 for each @xmath405 where @xmath446 and @xmath447 and @xmath447 are orthonormal bases for @xmath448 and @xmath449 , respectively . in this case , we define @xmath450 , @xmath451 , and @xmath452 $ ] ( see section [ s - exog ] for further details ) . in both cases , for fixed @xmath453",
    "we define @xmath454 for each @xmath260 .",
    "we also follow @xcite and assume that @xmath98 and @xmath113 are riesz bases in that they span @xmath455 and @xmath456 , respectively .    [",
    "[ assumption - cs ] ] assumption cs + + + + + + + + + + + + +    _ ( i ) @xmath457 and @xmath435 both have compact rectangular support and densities bounded away from @xmath85 and @xmath86 ; ( ii ) @xmath458 with @xmath459 and @xmath211 ; ( iii ) @xmath460 $ ] is uniformly bounded away from @xmath85 and @xmath86 , @xmath461 $ ] is finite , and @xmath462 = o(1)$ ] for any positive sequence with @xmath463 ; ( iv ) @xmath98 is spanned by a ( tensor - product ) b - spline basis of order @xmath165 or continuously differentiable wavelet basis of regularity @xmath165 and @xmath113 is spanned by a ( tensor - product ) b - spline , wavelet or cosine basis ; and ( v ) @xmath464 @xmath465 . _    assumption cs(i)(iv )",
    "is very similar to assumptions 1 , 2 , 7 , and 8 in @xcite with the exception that @xcite use a power series basis and work with log prices , log incomes , and log demand .",
    "our first result is asymptotic normality of sieve t - statistics for cs functionals .",
    "[ t - cs ] let assumption cs hold . then : @xmath466    we now present a corresponding result for dwl functionals . to introduce the result , define @xmath467 .",
    "[ t - dwl ] let assumption cs hold with @xmath468 in place of @xmath469 .",
    "then : @xmath470    @xcite suggest that @xmath471 as @xmath472 because @xmath469 is a smooth integral functional whereas @xmath468 depends on the functions evaluated at a particular point .",
    "therefore we should expect that the convergence rate of @xmath416 to be slower than that of @xmath415 .",
    "for this reason we do not derive the joint asymptotic distribution of @xmath415 and @xmath416 .",
    "we now provide more concrete conditions under which the sieve t - statistics for exact consumer surplus are asymptotically normal , allowing for endogeneity .",
    "analogous results hold for deadweight loss if we replace @xmath469 by @xmath468 in what follows .",
    "[ c - cs ] let assumption cs(i)(iv ) hold and let @xmath473 . then :    \\(1 ) mildly ill - posed case : let @xmath474 with @xmath475 and @xmath476 and let @xmath477 and @xmath478 . then : the population counterpart @xmath479 of @xmath480 behaves like @xmath481 assumption cs(v ) holds , and the sieve @xmath4-statistic for @xmath482 is asymptotically @xmath439 .",
    "\\(2 ) severely ill - posed case : let @xmath483 and @xmath484 and take @xmath485 where @xmath486 is chosen such that @xmath487 . then : the population counterpart @xmath479 of @xmath480 behaves like @xmath488 assumption cs(v ) holds , and the sieve @xmath4-statistic for @xmath482 is asymptotically @xmath439 .",
    "note that we may choose @xmath47 satisfying the stated conditions for the mildly ill - posed case provided @xmath489 , which is trivially true if @xmath459 whenever @xmath490 .",
    "we may also choose such a @xmath491 for the severely ill - posed case whenever @xmath492 - 2a + 2 $ ] .",
    "we finish this section by stating conditions for asymptotic normality of @xmath415 in the exogenous case in which @xmath493 and the sieve npiv estimator reduces to the usual series ls estimator .",
    "let the basis functions span an orthonormal basis @xmath494 for each @xmath47 and let @xmath469 be as defined in ( [ e - aj ] ) with @xmath495 in place of @xmath496 .",
    "assumption cs(v ) then applies with @xmath497 for each @xmath233 .",
    "the following result describes the regularity conditions for asymptotic normality of @xmath415 .",
    "analogous results for @xmath416 hold if we replace @xmath469 by @xmath498 in what follows .",
    "[ c - cs - exog ] let assumption cs(i)(iv ) hold , let @xmath473 with @xmath499 , and let @xmath500 and @xmath501 and @xmath502 . then : the population counterpart @xmath479 of @xmath480 behaves like @xmath503 , assumption cs(v ) holds , and the sieve @xmath4-statistic for @xmath482 is asymptotically @xmath439 .",
    "@xcite establish asymptotic normality of t - statistics for exact cs and dwl plug - in estimators based on a kernel estimator of demand .",
    "they also establish asymptotic normality of t - statistics for _ averaged _ exact cs and dwl plug - in estimators ( i.e. exact cs / dwl averaged over a range of incomes ) based on a series ls estimator of demand with power series basis , assuming @xmath0 to is infinitely times differentiable and @xmath504 .",
    "@xcite establishes asymptotic normality of t - statistics for _ approximate _ cs functionals based on series ls estimators of demand under weaker conditions ( i.e. @xmath505 and either @xmath506 for power series or @xmath507 for splines ) , but also without endogeneity . , @xmath508 , and @xmath509 .",
    "] corollary [ c - cs - exog ] complements their analysis by providing conditions for asymptotic normality of exact cs and dwl functionals based on series ls estimators of demand .",
    "in this section we establish asymptotic normality of sieve @xmath4-statistics for @xmath510 where @xmath511 is any nonlinear functional of npiv . under some high - level conditions , @xcite established the pointwise asymptotic normality of the sieve @xmath4 statistics for ( possibly ) nonlinear functionals of @xmath0 satisfying general semi / nonparametric conditional moment restrictions including npiv and nonparametric quantile iv as special cases .",
    "as the sieve npiv estimator @xmath43 has a closed - form expression ( unlike , say , nonparametric quantile iv ) we derive the limit theory directly rather than appealing to the general theory in @xcite .",
    "our regularity conditions are tailored to the case in which @xmath510 is _ irregular _",
    "( i.e. slower than root-@xmath8 estimable ) .",
    "denote the derivative of @xmath512 at @xmath513 in the direction @xmath514 by @xmath515   = \\lim_{\\delta \\rightarrow 0^{+}}\\frac{f(h_{0}+\\delta g)}{\\delta } \\,.\\]]if @xmath512 is a linear functional then @xmath516 = f(g)$ ] .",
    "the sieve 2sls riesz representer of @xmath517 is @xmath518^{-1 } \\frac{\\partial f(h_{0})}{\\partial h}[\\psi^j]\\ ] ] where @xmath519 $ ] denotes the vector formed by applying @xmath520 $ ] to each element of @xmath521 .",
    "define the weak norm @xmath522 on @xmath98 as @xmath523 .",
    "then @xmath524'[s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f(h_{0})}{\\partial h}[\\psi^j]\\,.\\ ] ] we say that the functional @xmath512 is an irregular ( i.e. slower than @xmath420-estimable ) functional of @xmath0 if @xmath525 and a regular ( i.e. @xmath420-estimable ) functional of @xmath0 if @xmath526 .    the sieve 2sls variance @xmath527 is defined as @xmath528'[s ' g_b^{-1 } s]^{-1 } s ' g_b^{-1 } \\omega g_b^{-1 } s[s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f(h_{0})}{\\partial h}[\\psi^j]\\ ] ] where @xmath529 $ ] .",
    "our estimator of @xmath527 is @xmath530'[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1 } \\widehat \\omega \\widehat g_b^{-1 } \\widehat s[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\frac{\\partial f(\\widehat h)}{\\partial h}[\\psi^j]\\ ] ] where @xmath531 with @xmath532 , which is analogous to the usual linear 2sls variance estimator .",
    "the scaled sieve riesz representer @xmath533 has the property that @xmath534 irrespective of whether @xmath510 is regular or irregular .",
    "finally , denote @xmath535^{-1 } \\frac{\\partial f(\\widehat h)}{\\partial h}[\\psi^j]\\ ] ] where clearly @xmath536 whenever @xmath537 is linear .",
    "[ a - residuals ] ( iii ) @xmath189 \\geq \\underline \\sigma^2 > 0 $ ] uniformly for @xmath190 ; and ( iv ) @xmath538 = o(1)$ ] for any positive sequence with @xmath463 .",
    "[ a - functional ] either ( a ) or ( b ) of the following hold :    * @xmath512 is a linear functional and @xmath539 ; or * \\(i ) @xmath540 $ ] is a linear functional ; ( ii ) @xmath541}{\\|v_n^*\\| } + o_p(1)\\,;\\ ] ] and ( iii ) @xmath542 .",
    "assumption [ a - residuals](iv ) is a mild condition which is trivially satisfied if @xmath543 $ ] is uniformly bounded for some @xmath339 .",
    "assumption [ a - functional](a ) and ( b)(i)(ii ) is similar to assumption 3.5 of @xcite .",
    "assumption [ a - functional](b)(iii ) controls any additional error arising in the estimation of @xmath544 due to nonlinearity of @xmath537 and is not required when @xmath537 is a linear functional .",
    "previously , @xcite verified their assumption 3.5 using a plug - in sieve minimum distance estimator of a weighted quadratic functional example . however , without a sup - norm convergence rate , it could be difficult to verify the high - level conditions for nonlinear functionals that are more complicated than a quadratic functional of npiv .",
    "let @xmath545 be a neighborhood of @xmath0 such that @xmath546 wpa1 .",
    "sufficient conditions for assumptions [ a - functional](a ) and ( b)(i)(ii ) are :    * \\(i ) @xmath512 is a linear functional and there exists @xmath547 with @xmath548 s.t .",
    "@xmath549 for all @xmath550 ; and ( ii ) @xmath551 ; or * \\(i ) @xmath540 $ ] is a linear functional and there exists @xmath547 with @xmath548 s.t .",
    "@xmath552| \\lesssim \\|\\partial^\\alpha h - \\partial^\\alpha h_0\\|_\\infty$ ] for all @xmath550 ; ( ii ) there exists @xmath553 , @xmath554 with @xmath555 s.t .",
    "@xmath556 \\right| \\lesssim \\|\\partial^{\\alpha_1 } \\widehat h - \\partial^{\\alpha_1 } h_0\\|_\\infty \\|\\partial ^{\\alpha_2 } \\widehat h - \\partial^{\\alpha_2 } h_0\\|_\\infty\\,;\\ ] ] and ( iii ) @xmath557 .    condition ( a)(i ) is trivially satisfied for any evaluation functional of the form @xmath558 for fixed @xmath559 with @xmath560 . condition ( b)(i)(ii ) are satisfied by typical nonlinear welfare functionals such as exact consumer surplus and deadweight loss functionals ( see @xcite ) .",
    "conditions ( a)(i ) and ( b)(iii ) can be verified given the sup - norm rate results in section [ npiv sec ] .",
    "[ t - dist ] ( 1 ) let assumptions [ a - data](iii ) , [ a - residuals](i)(iii)(iv ) , [ a - approx](i ) , and either [ a - functional](a ) or [ a - functional](b)(i)(ii ) hold , and let @xmath561 . then : @xmath562(2 ) if @xmath563 and assumptions [ a - residuals](ii ) and [ a - sieve](iii ) hold ( and [ a - functional](b)(iii ) also holds if @xmath512 is nonlinear ) , then : @xmath564    @xcite establish asymptotic normality of plug - in estimators of possibly nonlinear functionals in general semi / nonparametric conditional moment restriction models with endogeneity . by exploiting the close form expression of the sieve npiv estimator and by applying exponential inequalities for random matrices , theorem [ t - dist ]",
    "derives the limit theory allowing for faster growth rate of @xmath47 than remark 6.1 in @xcite .",
    "we now show how our sup - norm rate results and tight bounds on random matrices can be used to derive bootstrap uniform confidence bands for a class of general nonlinear functionals @xmath565 of @xmath0 in a npiv model where @xmath566 is a ( possibly infinite dimensional ) index set .",
    "in particular , we establish validity of a sieve score bootstrap for estimating the distribution of supremum of the sieve @xmath4-statistic process ( i.e. the process formed by calculating the sieve @xmath4-statistic for each @xmath567 ) , which leads to asymptotically exact uniform confidence bands for @xmath568 .",
    "let @xmath566 be a closed subset of a separable metric space and let @xmath569 for each @xmath570 .",
    "for each @xmath570 we define @xmath571 & = \\lim_{\\delta \\rightarrow 0^{+}}\\frac{f_t(h_{0}+\\delta g)}{\\delta } \\\\",
    "v_{n , t}^*(x ) & = \\psi^j(x ) ' [ s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f_t(h_{0})}{\\partial h}[\\psi^j ] \\\\",
    "\\widehat v_{n , t}^*(x ) & = \\psi^j(x ) ' [ s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f_t(\\widehat h)}{\\partial h}[\\psi^j ] \\\\",
    "\\|v_{n , t}^*\\|^2 & = \\frac{\\partial f_t(h_{0})}{\\partial h}[\\psi^j]'[s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f_t(h_{0})}{\\partial h}[\\psi^j ]",
    "\\\\ \\|v_{n , t}^*\\|^2_{sd } &   = \\frac{\\partial f_t(h_{0})}{\\partial h}[\\psi^j]'[s ' g_b^{-1 } s]^{-1 } s ' g_b^{-1 } \\omega g_b^{-1 } s[s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f_t(h_{0})}{\\partial h}[\\psi^j ]",
    "\\\\ \\widehat{\\|v_{n , t}^*\\|}^2_{sd } & = \\frac{\\partial f_t(\\widehat h)}{\\partial h}[\\psi^j]'[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1 } \\widehat \\omega \\widehat g_b^{-1 } \\widehat s[\\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\frac{\\partial f_t(\\widehat h)}{\\partial h}[\\psi^j ] \\\\",
    "u_{n , t}^*(x ) & = v_{n , t}^*(x)/\\|v_{n , t}^*\\|_{sd}\\end{aligned}\\ ] ] with @xmath522 , @xmath572 , and @xmath573 as defined in appendix [ s - pw ] .    to construct uniform confidence bands for @xmath574 we propose the following sieve score bootstrap procedure .",
    "let @xmath575 be a bootstrap sample of iid random variables drawn independently of the data , with @xmath576 = 0 $ ] , @xmath577=1 $ ] , @xmath578 < \\infty$ ] for some @xmath579 .",
    "common examples of distributions for @xmath580 include @xmath439 , recentered exponential , rademacher , or the two - point distribution of @xcite .",
    "be a draw from the exponential distribution with mean @xmath391 and let @xmath581 .",
    "the rademacher weights put probability @xmath582 on both @xmath391 and @xmath583 .",
    "mammen s two - point distribution puts probability @xmath584 on @xmath585 and probability @xmath586 on @xmath587 . ]",
    "the sieve score bootstrap process @xmath588 is given by @xmath589 ' [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } \\left(\\frac{1}{\\sqrt n } \\sum_{i=1}^n",
    "b^k(w_i ) \\widehat u_i \\varpi_i \\right)\\ ] ] for each @xmath570 , where @xmath590 .",
    "( iv ) @xmath591",
    "< \\infty$ ] .",
    "[ [ assumption-5 ] ] assumption 5 + + + + + + + + + + + + +    -5pt _ let @xmath592 and @xmath593 be sequences of positive constants such that @xmath594 and @xmath595 .",
    "either ( a ) or ( b ) of the following holds : _    * _ @xmath596 is a linear functional for each @xmath570 and @xmath597 ; or _ * _ ( i ) @xmath598 $ ] is a linear functional with @xmath599 for each @xmath570 ; ( ii ) _",
    "@xmath600}{\\|v_{n , t}^*\\| } \\right| = o_p(\\eta_n)\\,;\\ ] ] _ and ( iii ) @xmath601 .",
    "_    let @xmath602 denote the intrinsic semi - metric on @xmath566 given by @xmath603 $ ] and let @xmath604 denote the @xmath12-entropy of @xmath566 with respect to @xmath602",
    ". let @xmath605 be a sequence of positive constants such that @xmath606 and define @xmath607 .",
    "[ a - lipschitz ] ( i ) @xmath608 is separable for each @xmath8 ; ( ii ) there exists a sequence of finite positive constants @xmath609 such that @xmath610 and ( iii ) there exists a sequence of positive constants @xmath611 with @xmath612 such that @xmath613 and @xmath614 where @xmath615 and @xmath616 if the @xmath617 are linear .",
    "assumptions [ a - residuals](iv ) is a mild condition used to derive the uniform limit theory .",
    "assumption [ a - functional] is a uniform ( in @xmath4 ) version of assumption [ a - functional ] .",
    "assumption [ a - functional](iii ) is only required for consistent variance estimation .",
    "assumption [ a - lipschitz ] is a mild regularity condition requiring the class @xmath618 not be too complex .",
    "this condition is used to place tight bounds on the supremum of the bootstrap @xmath4-statistic processes .",
    "[ rmk - a5suff ] let @xmath545 be a neighborhood of @xmath0 such that @xmath546 wpa1 and let @xmath619 be such that @xmath620 for each @xmath8 .",
    "sufficient conditions for assumptions [ a - functional](a ) and ( b)(i)(ii ) are :    * \\(i ) @xmath617 is a linear functional for each @xmath570 and there exists @xmath547 with @xmath548 s.t .",
    "@xmath621 for all @xmath550 ; and ( ii ) @xmath622 ; or * \\(i ) @xmath598 $ ] is a linear functional for each @xmath623 and there exists @xmath547 with @xmath548 s.t .",
    "@xmath624| \\lesssim \\|\\partial^\\alpha h - \\partial^\\alpha h_0\\|_\\infty$ ] for all @xmath550 ; ( ii ) there exists @xmath553 , @xmath554 with @xmath555 s.t .",
    "@xmath625 \\right| \\lesssim \\|\\partial^{\\alpha_1 } \\widehat h - \\partial^{\\alpha_1 } h_0\\|_\\infty \\|\\partial ^{\\alpha_2 } \\widehat h - \\partial^{\\alpha_2 } h_0\\|_\\infty\\,;\\ ] ] and ( iii ) @xmath626 .    condition ( a)(i ) is satisfied for any evaluation functional of the form @xmath627 with @xmath628 and @xmath560 .",
    "[ rmk - a6suff ] let @xmath629 be compact and let there exist sequence of positive constants @xmath630 such that @xmath631 if the @xmath617 are linear functionals , or @xmath632 -   \\frac{\\partial f_{t_2}(h_0)}{\\partial h}[h ] \\right ) \\right| \\leq \\gamma_n \\|t_1 - t_2 \\|_{\\ell^2}^{\\gamma_n}\\ ] ] if the @xmath617 are nonlinear , and let assumption [ a - data](iii ) and [ a - approx](i ) hold .",
    "then : assumption [ a - lipschitz](i)(ii ) holds with @xmath633 .",
    "let @xmath634 denote the probability measure of the bootstrap innovations @xmath575 conditional on the data @xmath635 .",
    "[ t - dist - u ] let assumptions [ a - data](iii ) , [ a - residuals](i)(iii)(iv ) , [ a - sieve](iii ) , [ a - approx](i ) , [ a - functional] , and [ a - lipschitz ] hold and @xmath561 . then : @xmath636    theorem [ t - dist - u ] establishes consistency of our sieve score bootstrap procedure for estimating the critical values of the uniform sieve @xmath4-statistic process for a npiv model .",
    "[ rmk - ucb ] theorem [ t - dist - u ] applies to uniform confidence bands for @xmath637 as a special case in which @xmath638 and @xmath628 provided assumptions [ a - data ] , [ a - residuals](i)(iii)(iv ) , [ a - sieve](iii ) , and [ a - approx ] hold , @xmath98 is formed from a b - spline basis of regularity @xmath639 , @xmath113 is spanned by a b - spline , wavelet , or cosine basis , @xmath640 for some @xmath484 uniformly in @xmath4 , and @xmath641 , @xmath642 , @xmath643 , and @xmath644 .",
    "theorem [ t - dist - u ] contributes to the recent literature on inference for irregular ( possibly ) nonlinear functionals of nonparametric ill - posed inverse problems . for ( pointwise )",
    "inference on irregular ( possibly ) nonlinear functionals of general semi / nonparametric conditional moment restrictions _ with endogeneity _ , @xcite establish the validity of generalized residual bootstrap sieve t and sieve qlr statistics , and also present a sieve score bootstrap in their supplemental appendix d. @xcite were the first to derive uniform confidence bands for @xmath0 in a npiv model based on the modified orthogonal series npiv estimator of @xcite . at finitely many grid points with grid size going to zero slowly and",
    "prove bootstrap consistency in the case in which the number of interpolation points is finite and fixed .",
    "] our theorem [ t - dist - u ] and remark [ rmk - ucb ] include uniform confidence bands for @xmath0 as a special case in which @xmath638 and @xmath628 . and",
    "growth conditions on @xmath47 in remark [ rmk - ucb ] are very similar to those in @xcite . ] in an important paper on series least squares ( ls ) regression _ without endogeneity _",
    ", @xcite extend the gaussian simulation ( conditional monte carlo ) of @xcite to construct uniform confidence bands for sieve @xmath4-statistics for linear functionals ( see their theorem 5.6 ) . in work that is concurrent with ours , @xcite ( theorem 3.5 )",
    "extends @xcite s results to uniform confidence bands for possibly nonlinear functionals of semi / nonparametric conditional moment restrictions under high - level conditions that are slightly stronger but are similar to those in @xcite .",
    "our theorem [ t - dist - u ] appears to be the first in the literature which establishes consistency of a sieve score bootstrap for uniform inference on general nonlinear functionals of npiv under low - level conditions .",
    "we now evaluate the performance of our limit theory for uniform confidence bands for @xmath0 . using the mc design described in section [ s - mclep ] ,",
    "we generate 1000 samples of length 1000 and implement our procedure using b - spline and legendre polynomial bases as described in section [ s - mclep ] .",
    "we use a data - driven approach to choose the sieve dimension , taking @xmath292 as described in section [ s - jmax ] . for each simulation , we calculate the 90% , 95% , and 99% uniform confidence bands for @xmath0 over the full support @xmath645 $ ] with 1000 bootstrap replications for each simulation . we draw the innovations for the sieve score bootstrap from the two - point distribution of @xcite .",
    "we then calculate the mc coverage probabilities of our uniform confidence bands .",
    "figure [ f - ucb ] displays the estimate @xmath43 , the structural function @xmath0 , and 90% , 95% and 99% uniform confidence bands for @xmath0 for a representative sample .",
    "figure [ f - ucb - data ] displays the estimated structural function and confidence bands together with a scatterplot of the sample @xmath646 data .",
    "the results of this mc experiment are presented in table [ tab - ucb-1 ] . comparing the mc coverage probabilities with their nominal values ,",
    "it is clear that the uniform confidence bands for the linear design are slightly too conservative .",
    "however , the uniform confidence bands for the nonlinear design have mc and nominal converge probabilities much closer , with the exception of the quartic b - spline basis .",
    "coverage probabilities of the bands formed using legendre polynomial bases are particularly good in the nonlinear case .",
    "12 pt    40 pt    online appendix to    this appendix contains material to support our paper `` optimal sup - norm rates , adaptivity and inference in nonparametric instrumental variables estimation '' .",
    "appendix [ ax - basis ] contains background material on b - spline and wavelet bases and the equivalence between besov and wavelet sequence norms .",
    "appendix [ ax - proofs ] contains all proofs of results in the main text .",
    "appendix [ ax - supp ] contains supplementary material on useful matrix inequalities , convergence results for random matrices , and additional results for the proof of theorem [ t - oracle1 ] .",
    "in this section we bound the terms @xmath647 , @xmath648 and @xmath649 for b - spline and cdv wavelet bases .",
    "although we state the results for the space @xmath98 , they may equally be applied to @xmath113 when @xmath113 is constructed using b - spline or cdv wavelet bases .",
    "we construct a univariate b - spline basis of order @xmath650 ( or degree @xmath651 ) with @xmath652 interior knots and support @xmath182 $ ] in the following way .",
    "let @xmath653 denote the extended knot sequence and let @xmath654 $ ] .",
    "a basis of order @xmath391 is constructed by setting @xmath655for @xmath656 .",
    "bases of order @xmath657 are generated recursively according to @xmath658for @xmath659 where we adopt the convention @xmath660 ( see section 5 of @xcite ) .",
    "this results in a total of @xmath661 splines of order @xmath662 , namely @xmath663 .",
    "each spline is a polynomial of degree @xmath664 on each interior interval @xmath665 and is @xmath666-times continuously differentiable on @xmath182 $ ] whenever @xmath667 .",
    "the mesh ratio is defined as @xmath668clearly @xmath669 whenever the knots are placed evenly ( i.e. @xmath670 for @xmath671 and @xmath672 ) and we say that the mesh ratio is _ uniformly bounded _ if @xmath673 as @xmath674 .",
    "each of has continuous derivatives of orders @xmath675 on @xmath676 .",
    "we let the space @xmath677)$ ] be the closed linear span of the @xmath661 splines @xmath663 .",
    "we construct b - spline bases for @xmath182^d$ ] by taking tensor products of univariate bases .",
    "first generate @xmath40 univariate bases @xmath678 for each of the @xmath40 components @xmath679 of @xmath680 as described above .",
    "then form the vector of basis functions @xmath521 by taking the tensor product of the vectors of univariate basis functions , namely : @xmath681 the resulting vector @xmath521 has dimension @xmath682 .",
    "let @xmath683 denote its @xmath47 elements .",
    "[ [ stability - properties ] ] stability properties : + + + + + + + + + + + + + + + + + + + + +    the following two lemmas bound @xmath647 , and the minimum eigenvalue and condition number of @xmath684 $ ] when @xmath683 is constructed using univariate and tensor - products of b - spline bases with uniformly bounded mesh ratio .",
    "[ lem - spline1 ] let @xmath20 have support @xmath182 $ ] and let @xmath685 be a univariate b - spline basis of order @xmath650 with @xmath686 interior knots and uniformly bounded mesh ratio . then : ( a ) @xmath687 for all @xmath688 ; ( b ) if the density of @xmath20 is uniformly bounded away from @xmath85 and @xmath86 on @xmath182 $ ] , then there exists finite positive constants @xmath689 and @xmath690 such that @xmath691 for all @xmath688 ; ( c ) @xmath692 for all @xmath688",
    ".    [ lem - spline2 ] let @xmath20 have support @xmath182^d$ ] and let @xmath683 be a b - spline basis formed as the tensor product of @xmath40 univariate bases of order @xmath650 with @xmath693 interior knots and uniformly bounded mesh ratio . then : ( a ) @xmath687 for all @xmath694 ; ( b ) if the density of @xmath20 is uniformly bounded away from @xmath85 and @xmath86 on @xmath182^d$ ] , then there exists finite positive constants @xmath689 and @xmath690 such that @xmath691 for all @xmath694 ; ( c ) @xmath692 for all @xmath694 .",
    "we construct a univariate wavelet basis with support @xmath182 $ ] following @xcite ( cdv hereafter ) .",
    "let @xmath695 be a daubechies pair such that @xmath696 has support @xmath697 $ ] .",
    "given @xmath233 such that @xmath698 , the orthonormal ( with respect to the @xmath361)$ ] inner product ) basis for the space @xmath699 includes @xmath700 interior scaling functions of the form @xmath701 , each of which has support @xmath702 $ ] for @xmath703 .",
    "these are augmented with @xmath704 left scaling functions of the form @xmath705 for @xmath706 ( where @xmath707 are fixed independent of @xmath233 ) , each of which has support @xmath708 $ ] , and @xmath704 right scaling functions of the form @xmath709 for @xmath710 ( where @xmath711 are fixed independent of @xmath233 ) , each of which has support @xmath712 $ ] .",
    "the resulting @xmath713 functions @xmath714 form an orthonormal basis ( with respect to the @xmath361)$ ] inner product ) for their closed linear span @xmath699 .    an orthonormal wavelet basis for the space @xmath715 , defined as the orthogonal complement of @xmath699 in @xmath716 ,",
    "is similarly constructed form the mother wavelet .",
    "this results in an orthonormal basis of @xmath713 functions @xmath717 ( we use this conventional notation without confusion with the @xmath718 basis functions spanning @xmath98 ) where the `` interior '' wavelets @xmath719 are of the form @xmath720 . to simplify notation",
    "we ignore the @xmath85 and @xmath391 superscripts on the left and right wavelets and scaling functions henceforth .",
    "let @xmath721 and @xmath722 be integers such that @xmath723 .",
    "a wavelet space at resolution level @xmath722 is the @xmath724-dimensional set of functions given by @xmath725 ) = \\left\\ { \\sum_{k=0}^{2^{l_0}-1 } a_{l_0,k } \\varphi_{l_0,k } + \\sum_{j = l_0}^l \\sum_{k=0}^{2^j-1 } b_{j , k } \\psi_{j , k } : a_{l_0,k } , b_{j , k } \\in \\mathbb{r } \\right\\ } \\,.\\ ] ] we say that @xmath726)$ ] has _ regularity _",
    "@xmath727 if @xmath728 ( which can be achieved by choosing @xmath704 sufficiently large ) and write @xmath726,\\gamma ) $ ] for a wavelet space of regularity @xmath729 with continuously differentiable basis functions",
    ".    we construct wavelet bases for @xmath182^d$ ] by taking tensor products of univariate bases .",
    "we again take @xmath721 and @xmath722 to be integers such that @xmath723 .",
    "let @xmath730 denote an orthonormal tensor - product wavelet for @xmath361^d)$ ] at resolution level @xmath233 where @xmath731 and where @xmath732 denotes which elements of the tensor product are @xmath733 ( indices corresponding to @xmath734 ) and which are @xmath735 ( indices corresponding to @xmath736 ) .",
    "for example , @xmath737 . note that each @xmath738 with @xmath739 has an element that is @xmath734 ( see @xcite for details ) .",
    "we have @xmath740 , @xmath741 for @xmath742 .",
    "let @xmath743^d,\\gamma)$ ] denote the space @xmath744^d,\\gamma ) = \\left\\ { \\sum_{j = l_0}^l \\sum_{g \\in g_{j , l_0 } } \\sum_{k \\in \\{0,\\ldots,2^{j}-1\\}^d } a_{j , k , g } \\widetilde \\psi_{j , k , g } : a_{j , k , g } \\in \\mathbb r \\right\\}\\ ] ] where each univariate basis has regularity @xmath729 .",
    "this definition clearly reduces to the above definition for @xmath743,\\gamma)$ ] in the univariate case .    [ [ stability - properties-1 ] ] stability properties : + + + + + + + + + + + + + + + + + + + + +    the following two lemmas bound @xmath647 , as well as the minimum eigenvalue and condition number of @xmath684 $ ] when @xmath683 is constructed using univariate and tensor - products of cdv wavelet bases .",
    "[ lem - wavelet1 ] let @xmath20 have support @xmath182 $ ] and let be a univariate cdv wavelet basis of resolution level @xmath745 . then : ( a ) @xmath746 for each sieve dimension @xmath747 ; ( b ) if the density of @xmath20 is uniformly bounded away from @xmath85 and @xmath86 on @xmath182 $ ] , then there exists finite positive constants @xmath689 and @xmath690 such that @xmath748 for each @xmath47 ; ( c ) @xmath692 for each @xmath47 .",
    "[ lem - wavelet2 ] let @xmath20 have support @xmath182^d$ ] and let @xmath749 be a wavelet basis formed as the tensor product of @xmath40 univariate bases of resolution level @xmath722 . then : ( a ) @xmath746 each @xmath47 ; ( b ) if the density of @xmath20 is uniformly bounded away from @xmath85 and @xmath86 on @xmath182^d$ ] , then there exists finite positive constants @xmath689 and @xmath690 such that @xmath748 for each @xmath47 ; ( c ) @xmath692 for each @xmath47 .    [",
    "[ wavelet - characterization - of - besov - norms ] ] wavelet characterization of besov norms : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    when the wavelet basis just described is of regularity @xmath750 , the norms @xmath153 for @xmath751 can be restated in terms of the wavelet coefficients .",
    "we briefly explain the multivariate case as it nests the univariate case .",
    "any @xmath752^d)$ ] may be represented as @xmath753 with the sum is understood to be taken over the same indices as in display ( [ e - wav - multi ] ) .",
    "if @xmath754^d)$ ] then @xmath755 and if @xmath756)$ ] then @xmath757 see @xcite and @xcite for a more thorough discussion .",
    "* notation : * for a @xmath758 matrix @xmath307 with @xmath759 and full row rank @xmath662 we let @xmath760 denote its left pseudoinverse , namely @xmath761 where @xmath762 denotes transpose and @xmath763 denotes generalized inverse .",
    "we let @xmath306 denote the minimum singular value of a rectangular matrix @xmath307 . for a positive - definite symmetric matrix @xmath307 we let @xmath764 , @xmath765 and @xmath766 denote its minimum and maximum eigenvalue and positive definite square root , respectively .",
    "we also define @xmath767 , which satisfies @xmath768 for all @xmath769 .",
    "the following result is used throughout the paper .",
    "[ lem - ip ] let assumptions [ a - data](iii ) and [ a - approx](i ) hold . then : @xmath770 as @xmath771 .",
    "first note that @xmath772 for all @xmath47 by compactness and injectivity of @xmath69 .",
    "then : @xmath773 holds uniformly in @xmath47 because @xmath774 is a contraction , whence @xmath775 . to derive a lower bound on @xmath287 , the triangle inequality and assumption [ a - approx](i ) yield : @xmath776 therefore , @xmath777 .    throughout the proofs in the appendix we use the identity @xmath778 which implies that @xmath779 by definition of @xmath104 and the fact that @xmath780 ( see lemma [ lem - mpnorm ] ) .",
    "it is clear that lemma [ lem - approx - new ] is implied by the following lemma .",
    "[ lem - approx ] let assumptions [ a - data](iii ) and [ a - approx](ii ) hold . then : + ( 1 ) ( a ) @xmath135 ; and + ( b ) @xmath781 . + ( 2 ) if assumption [ a - approx](i ) also holds , then : ( a ) @xmath136 ; and + ( b ) @xmath782 .",
    "+ ( 3 ) if assumption [ a - approx](iii ) also holds , then : @xmath783 .",
    "+ ( 4 ) further , if condition ( [ e - piapprox ] ) also holds , then assumption [ a - approx](iii ) is satisfied .    in what follows",
    ", `` @xmath784 '' denotes a generic positive constant that may be different from line to line .",
    "assumption [ a - data](iii ) guarantees @xmath287 and @xmath140 are well defined . for part ( 1.a ) , we have : @xmath785 where the third line is by definition of @xmath287 , the fourth is because @xmath786 for all @xmath106 , the final line is by assumption [ a - approx](ii ) , and the fifth is because @xmath787 is a weak contraction under the norm @xmath788 . more precisely by the definition of @xmath140 we have : @xmath789 for all @xmath106 , where @xmath790 denotes the @xmath112 inner product . with @xmath791",
    "this implies @xmath792 @xmath793 thus @xmath794 .",
    "+ for part ( 1.b ) : @xmath795 where the first and final inequalities are by definition of @xmath140 and @xmath139 and the second inequality is by assumption [ a - approx](ii ) .    for part ( 2.a ) , lemma [ lem - ip ] guarantees that @xmath141 is well defined and that @xmath796 for all @xmath47 sufficiently large . by definition of @xmath141",
    "we have : @xmath797 for all @xmath106 , where we use the fact that @xmath798 holds for any @xmath799 since @xmath774 is a projection ) . substituting @xmath800 into the two equations ( [ foc - pi ] ) and ( [ foc - q ] ) yields : @xmath801 by subtracting ( [ e - ipt2n ] ) from ( [ e - ipt1n ] ) we obtain @xmath802 we have therefore proved @xmath803 it follows from ( [ e - ipt3n ] ) , the cauchy - schwarz inequality , and assumption [ a - approx](i ) that :",
    "@xmath804 it follows by ( [ e - ipt4n ] ) and the relation @xmath796 for all @xmath47 large that : @xmath805 where the final line is by part ( 1.b ) . for part ( 2.b ) , by definition of @xmath806 , @xmath807 and results in part ( 1.a ) and part ( 2.a ) , we have : @xmath808 this proves part ( 2.b ) .",
    "for part ( 3 ) , it follows from ( [ e - ipt6n ] ) and assumption [ a - approx](iii ) that @xmath809 and hence @xmath810 by part ( 1.b ) and the fact that @xmath796 for all @xmath47 large .",
    "therefore , @xmath811 where the last inequality is due to ( [ e - ipt8n ] ) .    for part ( 4 ) , by the triangle inequality ,",
    "the results in part ( 1.a ) and ( 3 ) and condition ( [ e - piapprox ] ) we have : @xmath812 which completes the proof .",
    "note that we may write @xmath813 for some @xmath814 in @xmath815 .",
    "we use this notation hereafter .",
    "we first prove * result ( 1)*. we begin by writing @xmath816 ) \\}\\\\   & & + \\psi^j(x)'\\{(\\widehat g_b^{-1/2 } \\widehat s)^-_l\\widehat g_b^{-1/2}g_b^{1/2 } - ( g_b^{-1/2 } s)^-_l   \\}g_b^{-1/2 } b'(h_0 - \\psi c_j)/n \\\\   & = : & t_1 + t_2 + t_3\\end{aligned}\\ ] ] where @xmath817 is the sieve 2sls projection operator given by @xmath818^{-1 } s ' g_b^{-1 } e[b^k(w_i)h(x_i)]\\,.\\ ] ] note that @xmath819 for all @xmath106 .",
    "control of @xmath820 : @xmath821 by assumption [ a - approx](iii ) .",
    "control of @xmath822 : using equation ( [ e - xident ] ) , the cauchy - schwarz inequality , and lemma [ lem - bhj ] , we obtain : @xmath823 ) \\|_{\\ell^2 }   \\\\   & \\leq & \\zeta_{\\psi , j } s_{jk}^{-1}\\| g_b^{-1/2 } ( b'(h_0 - \\psi c_j)/n - e[b^k(w_i)(h_0(x_i ) - \\pi_j h_0(x_i ) ) ] ) \\|_{\\ell^2 }   \\\\   & = & \\zeta_{\\psi , j } s_{jk}^{-1 } \\times o_p ( \\sqrt{k / n } ) \\times \\|h_0 - \\pi_j h_0 \\|_{\\infty }   \\,.\\end{aligned}\\ ] ] it then follows by the relations @xmath824 ( lemma [ lem - ip ] ) and @xmath825 and assumption [ a - sieve](ii ) that : @xmath826    control of @xmath827 : similar to @xmath828 in the proof of lemma [ lem - chat ] , we may use lemmas [ lem - sgl2](b ) and [ lem - ip ] to obtain : @xmath829 then by lemma [ lem - bhj ] and the triangle inequality , we have : @xmath830 substituting ( [ e - bt32 ] ) into ( [ e - bt31 ] ) and using assumptions [ a - sieve](ii ) and [ a - approx](ii ) : @xmath831 where the final line is by the relation between the @xmath29 and sup norms .",
    "* result ( 2 ) * then follows because @xmath832 where the second inequality is by result ( 1 ) and the final line is by lebesgue s lemma",
    ".    let @xmath833 .",
    "let @xmath834 be a sequence of positive constants diverging to @xmath835 , and decompose @xmath836 where @xmath837 \\\\",
    "u_{2,i } & = & u_i\\{|u_i| > m_n \\ } - e[u_i \\{|u_i| > m_n\\}|w_i ] \\\\",
    "u_1 & = & ( u_{1,1},\\ldots , u_{1,n } ) ' \\\\",
    "u_2 & = & ( u_{2,1},\\ldots , u_{2,n } ) ' \\,.\\end{aligned}\\ ] ]    for * result ( 1 ) * , recall that @xmath838 . by hlder",
    "s inequality we have @xmath839 thus to derive the sup - norm convergence rate of the standard deviation term @xmath840 it suffices to bound the @xmath841 norm of the @xmath842 random vector @xmath843 .",
    "although this appears like a crude bound , @xmath647 grows slowly in @xmath47 for certain sieves whose basis functions have local support . for such bases the above bound , in conjunction with the following result",
    "@xmath844 leads tight bounds on the convergence rate of @xmath83 .    to prove ( [ result1 ] ) we begin by writing @xmath845",
    "we will show that @xmath846 and @xmath847 .",
    "control of @xmath848 .",
    "note that @xmath849 .",
    "let @xmath850 denote the @xmath233th element of a vector @xmath32 . by the definition of @xmath851 and",
    "the union bound , @xmath852 where @xmath853 . the summands may be bounded by noting that @xmath854^{-1 } g_\\psi^{-1/2 } s ' g_b^{-1/2}\\|_{\\ell^2 } \\| g_b^{-1/2 } b^k(w_i)\\|_{\\ell^2 } \\notag \\\\   & \\leq & \\|g_\\psi^{-1/2}\\|_{\\ell^2 } \\| [ g_\\psi^{-1/2 } s'g_b^{-1 } s g_\\psi^{-1/2}]^{-1 } g_\\psi^{-1/2 } s'g_b^{-1/2}\\|_{\\ell^2 } \\| g_b^{-1/2 } b^k(w_i)\\|_{\\ell^2 } \\notag \\\\   & \\leq & \\frac{\\zeta_{b , k}}{s_{jk } \\sqrt{e_j } } \\label{e - max1}\\end{aligned}\\ ] ] uniformly in @xmath396 and @xmath233 .",
    "therefore , @xmath855 uniformly in @xmath396 and @xmath233 .",
    "let @xmath856 denote the @xmath233th row of the matrix @xmath307 and let @xmath857 denote its @xmath233th diagonal element .",
    "the second moments of the summands may be bounded by observing that @xmath858 & = & e [ ( ( g_b^{-1/2}s)^-_l)_{j| } g_b^{-1/2 } b^k(w_i))^2 ] \\notag \\\\   & = & e [ ( ( g_b^{-1/2}s)^-_l)_{j| } g_b^{-1/2 } b^k(w_i)b^k(w_i ) ' g_b^{-1/2 } ( ( g_b^{-1/2}s)^-_l)_{j| } ' ] \\notag \\\\   & = & ( ( g_b^{-1/2}s)^-_l ( ( g_b^{-1/2}s)^-_l)')_{jj } \\notag \\\\   & = & ( ( s'g_b^{-1}s)^{-1})_{jj } \\notag \\\\   & \\leq & \\| ( s ' g_b^{-1 } s)^{-1 } \\|_{\\ell^2 } \\notag \\\\   & = & \\| g_\\psi^{-1/2 } [ g_\\psi^{-1/2 } s'g_b^{-1 } s g_\\psi^{-1/2}]^{-1 } g_\\psi^{-1/2 } \\|_{\\ell^2 } \\notag \\\\   & \\leq & \\frac{1 } { s_{jk}^2 e_j } \\label{e - var0}\\end{aligned}\\ ] ] and so @xmath859 \\leq   \\frac{\\overline \\sigma^2}{n^2 s_{jk}^2 e_j}\\ ] ] by assumption [ a - residuals](i ) and the law of iterated expectations .",
    "bernstein s inequality and expressions ( [ e - prob ] ) , ( [ e - max ] ) and ( [ e - var ] ) yield @xmath860 } \\right\\ } \\label{e - prob - lem1}\\end{aligned}\\ ] ] for finite positive constants @xmath861 and @xmath862 .",
    "then ( [ e - prob - lem1 ] ) is @xmath863 for all large @xmath864 provided @xmath865 .    by the triangle and markov inequalities and ( [ e - max1 ] ) , we have @xmath866 \\\\   & \\leq &   \\frac{2\\zeta_{b , k}}{ts_{jk } \\sqrt{e_j}m_n^{1+\\delta } }    e[|u_i|^{2+\\delta}\\{|u_i| > m_n\\}]\\end{aligned}\\ ] ] which , by assumption [ a - residuals](ii ) , is @xmath863 when @xmath867 provided @xmath868 .    choosing @xmath869 satisfies the condition @xmath870 trivially , and satisfies the condition @xmath865 provided @xmath871 , which holds by assumption [ a - sieve](iii ) .",
    "control of @xmath872 : using the fact that @xmath873 on @xmath815 and lemmas [ lem - sgl2](a ) and [ lem - bul2 ] , we have : @xmath874 where the last equality follows from assumption [ a - sieve](ii ) and the facts that @xmath875 and @xmath876 .    for * result ( 2 ) * , we begin by writing @xmath877 we will show that @xmath878 and @xmath879 .    control of @xmath880 . note that @xmath881 .",
    "let @xmath882 be a grid of finitely many points such that for each @xmath163 there exits a @xmath883 such that @xmath884 , where @xmath885 are as in assumption [ a - sieve](i ) . by compactness and convexity of the support @xmath87 of @xmath6",
    ", we may choose @xmath886 to have cardinality @xmath887 for some @xmath888 .",
    "therefore , @xmath889 for some finite positive constant @xmath890 , where the first inequality is by the triangle inequality , the second is by lipschitz continuity of the basis for @xmath98 and similar reasoning to that used in equation ( [ e - xident ] ) , the first equality is by lemma [ lem - bul2 ] and the fact that @xmath891 , and the final equality is because @xmath892 . for each @xmath893 we may write @xmath894 it follows from equation ( [ e - xident ] ) and the cauchy - schwarz inequality that the bounds @xmath895 & = & \\psi^j(x_n ) ' ( g_b^{-1/2 }   s)^-_l ( ( g_b^{-1/2 }   s)^-_l ) ' \\psi^j(x_n ) \\\\   & \\leq & s_{jk}^{-2 } \\zeta_{\\psi , j}^2\\end{aligned}\\ ] ] hold uniformly for @xmath893 . therefore , by assumption [ a - residuals](i ) and",
    "iterated expectations , the bounds @xmath896 & \\leq & \\overline \\sigma^2 \\psi^j(x_n ) ' ( g_b^{-1/2 }   s)^-_l ( ( g_b^{-1/2 }   s)^-_l ) ' \\psi^j(x_n ) \\\\   & \\leq & \\overline \\sigma^2 s_{jk}^{-2 } \\zeta_{\\psi , j}^2\\end{aligned}\\ ] ] hold uniformly for @xmath893 .",
    "it follows by the union bound and bernstein s inequality that @xmath897 } \\right\\ }   \\label{e - prob - lem2n}\\end{aligned}\\ ] ] for finite positive constants @xmath861 and @xmath862 .",
    "then ( [ e - prob - lem2n ] ) is @xmath863 for all large @xmath864 provided @xmath898 .    by the triangle and markov inequalities and equation ( [ e - xident ] ) ,",
    "we have @xmath899 \\\\   & \\leq &   \\frac{2\\zeta_{\\psi , j } \\zeta_{b , k}}{ts_{jk } m_n^{1+\\delta } }    e[|u_i|^{2+\\delta}\\{|u_i| > m_n\\}]\\end{aligned}\\ ] ] which , by assumption [ a - residuals](ii ) , is @xmath863 when @xmath900 provided @xmath901 .",
    "choosing @xmath902 satisfies the condition @xmath903 trivially , and satisfies the condition @xmath898 provided @xmath904 , which holds by assumption [ a - sieve](iii ) .",
    "we have therefore proved that @xmath905 .",
    "it follows by the relation @xmath906 ( lemma [ lem - ip ] ) that @xmath907 .",
    "control of @xmath908 : using the fact that @xmath909 on @xmath98 and lemmas [ lem - sgl2](b ) and [ lem - bul2 ] and the relation @xmath906 , we have : @xmath910 where the last equality follows from assumption [ a - sieve](ii ) and the fact that @xmath911 .",
    "we decompose @xmath79 into three parts : @xmath912 where @xmath913 by lemma [ lem - chat](1 ) and @xmath914 by lemma [ lem - bias ] .    for * result ( 1 ) * , note that assumption [ a - sieve](ii ) is satisfied with @xmath915 for @xmath98 and @xmath113 being spline , or wavelet or cosine sieves . next , by the lemmas in appendix [ ax - basis ] , @xmath916 for @xmath98 being spline or wavelet sieves .",
    "also , @xmath146 for @xmath98 being a spline sieve ( @xcite ) or a tensor product cdv wavelet sieve ( @xcite ) . for @xmath164 and @xmath98",
    "being spline or wavelet sieves , lemma [ lem - bias ] implies that @xmath917 note that bernstein inequalities ( or inverse estimates ) from approximation theory imply that @xmath918 for all @xmath106 ( see @xcite for splines and @xcite for wavelets on domains ) .",
    "therefore , @xmath919 let @xmath387 be any element of @xmath98 .",
    "since @xmath920 , we have : @xmath921 the above inequality holds uniformly in @xmath922 . choosing @xmath387 such that @xmath923 and @xmath924 yields the desired result .    for * result ( 2 ) * , theorem [ t - rate ] implies that @xmath925 by similar arguments to the above , we have : @xmath926 and the result follows by result ( 1 )",
    ".    for * results ( 2.a ) and ( 2.b ) * , assumption [ a - sieve](ii)(iii ) is satisfied if @xmath927 and @xmath928 .",
    "this is satisfied given the stated conditions with the optimal choice of @xmath47 for mildly ill - posed case and severely ill - posed case respectively .",
    "consider the gaussian reduced - form npir model with known operator @xmath69 : @xmath929 for @xmath930 , where @xmath7 is continuously distributed over @xmath89 with density uniformly bounded away from @xmath85 and @xmath86 .",
    "as in @xcite , theorem [ npiv lower bound ] is proved by ( i ) noting that the risk ( in sup - norm loss ) for the npiv model is at least as large as the risk ( in sup - norm loss ) for the npir model , and ( ii ) calculating a lower bound ( in sup - norm loss ) for the npir model .",
    "theorem [ npiv lower bound ] therefore follows from a sup - norm analogue of lemma 1 of @xcite and theorem [ npir lower bound ] , which establishes a lower bound on minimax risk over hlder classes under sup - norm loss for the npir model .",
    "[ npir lower bound ] let condition lb hold for the npir model ( [ npir ] ) with a random sample @xmath931 . then for any @xmath197 : @xmath198 in the mildly ill - posed case , and @xmath199 in the severely ill - posed case , where @xmath200 denotes the infimum over all estimators of @xmath201 based on the sample of size @xmath8 , and the finite positive constants @xmath202 depend only on @xmath932 and @xmath933 .",
    "we establish the lower bound by applying theorem 2.5 of @xcite ( see theorem [ t - tsybakov ] below ) .",
    "we first explain the scalar @xmath934 case in detail .",
    "let @xmath935 be a wavelet basis of regularity @xmath165 for @xmath361)$ ] as described in appendix [ ax - basis ] .",
    "we will define a family of submodels in which we perturb @xmath0 by elements of the wavelet space @xmath715 , where we choose @xmath233 deterministically with @xmath8 . for given @xmath233 , recall that the wavelet space @xmath715 consists of @xmath713 functions @xmath936 , such that @xmath937 are interior wavelets for which @xmath938 .    by construction , the support of each interior wavelet is an interval of length @xmath939 .",
    "thus for all @xmath233 sufficiently large ( hence the @xmath940 in our statement of the lemma ) we may choose a set @xmath941 of interior wavelets with @xmath942 such that @xmath943 for all @xmath944 with @xmath945 .",
    "note also that by construction we have @xmath946 ( since there are @xmath947 interior wavelets ) .",
    "recall the norms @xmath948 defined in appendix [ ax - basis ] .",
    "let @xmath164 be such that @xmath949 , and for each @xmath950 let @xmath951 where @xmath952 is a positive constant to be defined subsequently .",
    "noting that @xmath953 it follows by the triangle inequality that @xmath954 uniformly in @xmath955 for all sufficiently small @xmath952 . by condition",
    "lb , let @xmath7 be distributed such that @xmath6 has uniform marginal distribution on @xmath182 $ ] . for @xmath956 let @xmath957 be the joint distribution of @xmath931 with @xmath958 for the gaussian npir model ( [ npir ] ) .",
    "for any @xmath950 @xmath959 where @xmath960 denotes the @xmath961th derivative of @xmath962 . moreover , for any @xmath944 with @xmath945 @xmath963 by virtue of the disjoint support of @xmath964 .    by condition lb(iii ) , @xmath965 ( because @xmath966 for sufficiently small @xmath952 ) where @xmath967 in the mildly ill - posed case and @xmath968 in the severely ill - posed case .",
    "the kl distance @xmath969 is @xmath970 \\\\   & \\leq & \\frac{1}{2}\\sum_{i=1}^n ( c_0 2^{-j(p+1/2)})^2 \\frac{e\\left[(t \\psi_{j , m}(w_i))^2\\right ] } { \\underline \\sigma^2 }   \\\\   & \\lesssim &   n(c_0 2^{-j(p+1/2)})^2 \\nu(2^j)^2 \\,.\\end{aligned}\\ ] ] in the mildly ill - posed case ( @xmath971 ) we choose @xmath972 .",
    "this yields : @xmath973 since @xmath974 .    in the severely ill - posed case ( @xmath975 ) we choose @xmath976 with @xmath977 .",
    "this yields : @xmath978 in both the mildly and severely ill - posed cases , we may choose @xmath952 sufficiently small that both @xmath954 and @xmath979 hold uniformly in @xmath955 for all @xmath8 sufficiently large .",
    "all conditions of theorem 2.5 of @xcite are satisfied and hence we obtain the lower bound result .    in the multivariate case ( @xmath980 ) we let @xmath730 denote an orthonormal tensor - product wavelet for @xmath361^d)$ ] at resolution level @xmath233 ( see appendix [ ax - basis ] ) .",
    "we construct a family of submodels analogously to the univariate case , setting @xmath981 where @xmath982 is now the tensor product of @xmath40 interior univariate wavelets at resolution level @xmath233 with @xmath983 and where @xmath984 . by condition lb we obtain @xmath985 for each @xmath986 with @xmath945 , and @xmath987 for each @xmath950 , where @xmath967 in the mildly ill - posed case and @xmath968 in the severely ill - posed case .",
    "we choose @xmath988 in the mildly ill - posed case and @xmath976 in the severely ill - posed case .",
    "the result follows as in the univariate case .",
    "the following theorem is a special case of theorem 2.5 on p. 99 of @xcite which we use to prove the minimax lower bounds in sup- and @xmath1-norm loss for @xmath0 and its derivatives .",
    "we state the result here for convenience .",
    "[ t - tsybakov ] assume that @xmath989 and suppose that @xmath990 contains elements @xmath991 such that : + ( i ) @xmath992 for each @xmath993 with @xmath945 ; + ( ii ) @xmath994 for each @xmath950 and @xmath995 with @xmath996 and where @xmath957 denotes the distribution of the data when @xmath997 for each @xmath956 .",
    "then : @xmath998      as with the proof of theorem [ t - rate ] , we first decompose the error into three parts : @xmath999 to prove * result ( 1 ) * it is enough to show that @xmath1000 . to do this , bound @xmath1001 for @xmath1002 , @xmath1003 where the second line is by lemma [ lem - bhj ] and the relations @xmath891 and @xmath906 , and",
    "the final line is by assumption [ a - approx](ii ) and the condition @xmath1004 .",
    "similarly , @xmath1005 where the second line is by lemmas [ lem - bhj ] and [ lem - sgl2](b ) and the relations @xmath891 and @xmath906 , and the final line is by the condition @xmath1004 and assumption [ a - approx](ii ) .",
    "this proves result ( 1 ) .    to prove * result ( 2 ) *",
    "it remains to control @xmath1006 .",
    "to do this , bound @xmath1007 for @xmath1008 , by definition of @xmath1009 and lemma [ lem - bul2 ] we have : @xmath1010 where the final line is because @xmath891 and @xmath906 ( lemma [ lem - ip ] ) .",
    "similarly , @xmath1011 where the second line is by lemmas [ lem - bul2 ] and [ lem - sgl2](b ) and the relations @xmath891 and @xmath906 , and the final line is by the condition @xmath1004 .",
    "analogous to the proof of corollary [ c - deriv ] .    as in the proof of theorem [ npiv lower bound ]",
    ", it suffices to prove a lower bound for the gaussian reduced - form npir model ( [ npir ] ) .",
    "theorem [ t - lb - l2-npir ] below does just this .",
    "[ t - lb - l2-npir ] let condition lb hold for the npir model ( [ npir ] ) with a random sample @xmath931 . then for any @xmath197 : @xmath220 in the mildly ill - posed case , and @xmath221 in the severely ill - posed case , where @xmath200 denotes the infimum over all estimators of @xmath201 based on the sample of size @xmath8 , and the finite positive constants @xmath202 depend only on @xmath932 and @xmath933 .",
    "we use similar arguments to the proof of theorem [ npir lower bound ] , using theorem 2.5 of @xcite ( see theorem [ t - tsybakov ] ) .",
    "again , we first explain the scalar @xmath934 case in detail .",
    "let @xmath935 be a wavelet basis of regularity @xmath165 for @xmath361)$ ] as described in appendix [ ax - basis ] .    by construction",
    ", the support of each interior wavelet is an interval of length @xmath939 .",
    "thus for all @xmath233 sufficiently large ( hence the @xmath940 in our statement of the lemma ) we may choose a set @xmath941 of interior wavelets with cardinality @xmath974 such that @xmath943 for all @xmath944 with @xmath945 .",
    "take @xmath1012 and for each @xmath950 define @xmath1013 where each @xmath1014 and define @xmath1015 for each @xmath1016 , where @xmath952 is a positive constant to be defined subsequently .",
    "note that this gives @xmath1017 such choices of @xmath1018 . by the equivalence @xmath1019 , for each @xmath1016 we have : @xmath1020 therefore , we can choose @xmath952 sufficiently small that @xmath1021 for each @xmath1016 .    since @xmath1022 with @xmath1023 is compactly",
    "supported and @xmath6 has density bounded away from @xmath85 and @xmath86 , we have @xmath1024 ( uniformly in @xmath955 ) . by this and the disjoint support of the @xmath1025 ,",
    "for each @xmath1026 we have : @xmath1027 where @xmath1028 is the hamming distance between @xmath1016 and @xmath1029 .",
    "take @xmath233 large enough that @xmath1030 . by the varshamov - gilbert bound ( * ? ? ?",
    "* lemma 2.9 ) we may choose a subset @xmath1031 such that @xmath1032 , @xmath1033 for all @xmath1034 and @xmath1035 ( recall that there were @xmath1017 distinct vectors @xmath1016 and @xmath974 ) .",
    "for each @xmath1036 let @xmath1037 .",
    "then we have @xmath1038 for each @xmath1039 .    for each @xmath1040 ,",
    "let @xmath957 denote the joint distribution of @xmath931 with @xmath958 for the gaussian npir model ( [ npir ] ) .",
    "it follows from condition lb(ii)(iii ) that for each @xmath1041 the kl distance @xmath969 is @xmath1042 \\\\   & \\leq & \\frac{n}{2\\underline \\sigma^2}(c_0 2^{-jp})^2 \\nu(2^j)^2 \\sum_{k \\in m } ( \\theta^{(m)}_k)^2   \\|\\psi_{j , k}\\|_{l^2(x)}^2 \\\\   & \\lesssim & n c_0 ^ 2 2^{-j(2p+1 ) } \\nu(2^j)^2\\end{aligned}\\ ] ] where the final line is because @xmath6 has density bounded away from @xmath85 and @xmath86 and @xmath1043 for each @xmath1041 .    in the mildly ill - posed case ( @xmath971 ) we choose @xmath1044",
    "this yields : @xmath1045 since @xmath1046 .    in the severely ill - posed case ( @xmath975 ) we choose @xmath976 with @xmath977 .",
    "this yields : @xmath1047 in both the mildly and severely ill - posed cases , the result follows by choosing @xmath952 sufficiently small that both @xmath954 and @xmath1048 hold uniformly in @xmath955 for all @xmath8 sufficiently large .",
    "all conditions of theorem 2.5 of @xcite are satisfied and hence we obtain the lower bound result .    in the multivariate case ( @xmath980 )",
    "we let @xmath730 denote an orthonormal tensor - product wavelet for @xmath361^d)$ ] at resolution level @xmath233 .",
    "we construct a family of submodels analogously to the univariate case , setting @xmath1049 where @xmath1025 is now the product of @xmath40 interior univariate wavelets at resolution level @xmath233 with @xmath983 ( see appendix [ ax - basis ] ) and where @xmath984 .",
    "we then use the varshamov - gilbert bound to reduce this to a family of models @xmath1050 with @xmath1040 and @xmath1051 .",
    "we then have : @xmath985 for each @xmath1039 , and @xmath1052 for each @xmath1041 , where @xmath967 in the mildly ill - posed case and @xmath968 in the severely ill - posed case .",
    "we choose @xmath1053 in the mildly ill - posed case and @xmath976 in the severely ill - posed case .",
    "the result follows as in the univariate case .",
    "we first prove * result ( 1)*. let @xmath1054 and let @xmath1055 denote its orthogonal complement in @xmath248 .",
    "observe that by definition of the singular values , for each @xmath229 we have : @xmath1056 then let @xmath1057 for each @xmath1058 .",
    "note that @xmath1059 for each @xmath1060 . then",
    ": @xmath1061 let @xmath1062 denote the distribution of @xmath1063 .",
    "for any @xmath1064 let @xmath1065 and observe that @xmath1066 . by iterated expectations and ( [ e - singular ] ) , for any @xmath1067 with @xmath1068 for each @xmath229",
    ", we have : @xmath1069 \\|_{l^2(w_1|z = z)}^2 \\,\\mathrm df_z(z ) \\notag \\\\   & = \\int \\| t_z h_z \\|_{l^2(w_1|z = z)}^2 \\,\\mathrm df_z(z ) \\notag \\\\   & \\leq \\int \\mu_{j , z}^2 \\|h_z\\|_{l^2(x_1|z = z)}^2 \\,\\mathrm df_z(z ) \\notag \\\\   & = \\int \\mu_{j , z}^2 \\,\\mathrm df_z(z ) = e[\\mu_{j , z_i}^2 ] \\ , .",
    "\\label{e - bck2}\\end{aligned}\\ ] ] it follows by substituting ( [ e - bck2 ] ) into ( [ e - bck1 ] ) that @xmath1070^{-1/2}$ ] .",
    "to prove * result ( 2 ) * , note that any @xmath106 with @xmath1071 can be written as @xmath1072 for constants @xmath1073 where @xmath1074 \\right ] = \\sum_{j=1}^j a_j^2\\ ] ] since @xmath1075 = \\delta_{jk}$ ] where @xmath265 denotes the kronecker delta .",
    "moreover : @xmath1076 \\right)^2 \\right]\\\\   & = e \\left [ \\left ( e \\left [ \\left .",
    "\\sum_{j=1}^j a_j \\phi_{0j , z_i}(x_i ) \\right| w_{1i},z_i \\right ] \\right)^2 \\right ] \\\\   & = e \\left [ \\left ( \\sum_{j=1}^j a_j \\mu_{j , z_i } \\phi_{1j , z_i}(w_{1i})\\right)^2 \\right ] \\\\   & = e \\left [ e \\left [ \\left .",
    "\\left ( \\sum_{j=1}^j a_j \\mu_{j , z_i } \\phi_{1j , z_i}(w_{1i})\\right)^2 \\right| z_i \\right ] \\right ]   = \\sum_{j=1}^j a_j^2   e \\left [ \\mu_{j , z_i}^2 \\right ] \\geq \\|h\\|^2_{l^2(x ) } e[\\mu_{j , z_i}^2]\\end{aligned}\\ ] ] since @xmath1077 = \\delta_{jk}$ ] . therefore , @xmath1078^{1/2}}\\ ] ] as required .",
    "lemma [ lem - j0 ] shows that there exists some set @xmath1079 with @xmath1080 upon which @xmath1081 and ( [ e - ffs1 ] ) and ( [ e - ffs2 ] ) hold .",
    "it follows that @xmath1082 on @xmath1079 ( by definition of @xmath1083 ) and hence @xmath1084 on @xmath1079 by the triangle inequality and definition of @xmath322 . for any @xmath1085 , lemmas [ lem - constsv ] and [ lem - consteval ] imply that there exists a sequences of sets @xmath1086 with @xmath1087 upon which the inequalities @xmath1088 hold for both @xmath1089 .",
    "therefore , on @xmath1090 we have : @xmath1091 by ( [ e - ffs3 ] ) , ( [ e - ffs4 ] ) , and ( [ e - ffs5 ] ) . moreover , lemma [ lem - ip ] ( using the fact that @xmath1092 ) implies @xmath1093 holds for @xmath1089 eventually on @xmath1090 , in which case : @xmath1094 the result follows by taking @xmath1095 such that @xmath1096 .",
    "the convergence rate of @xmath388 then follows from theorem [ t - rate ] ( or lemmas [ lem - chat ] and [ lem - bias ] ) .",
    "[ lem - j0 ] let assumptions [ a - data](iii ) , [ a - residuals](i)(ii ) , [ a - sieve](iv)(vi ) , and [ a - approx ] hold and let @xmath1097 hold wpa1 . then : @xmath1081 wpa1 .",
    "let @xmath1098 denote the event upon which @xmath293 and observe that @xmath1099 by hypothesis and that the inclusion @xmath1100 holds on @xmath1098 .",
    "on @xmath1098 we know that either @xmath1101 or @xmath1102 .",
    "since @xmath1103 by construction , if @xmath1102 then we are done .",
    "now consider the case @xmath1104 . by lemma [ lem - ip ] there",
    "exists a @xmath386 such that @xmath1105 for all @xmath1106 . since @xmath1107",
    "we may also assume @xmath1108 .",
    "choose any @xmath1109 with @xmath1110 .",
    "then by the triangle inequality , we have : @xmath1111 lemmas [ lem - unifvar ] and [ lem - unifbias ] imply that there exists a small @xmath1112 and a constant @xmath1113 such that the inequalities @xmath1114 hold uniformly for all @xmath1115 on some set @xmath1116 where @xmath1117 . substituting ( [ e - hhatbd2 ] ) and",
    "( [ e - hhatbd3 ] ) into ( [ e - hhatbd1 ] ) we see that the inequalities @xmath1118 hold uniformly for @xmath1119 on @xmath1120 . since @xmath1121",
    ", we have : @xmath1122 for @xmath1123 , and so @xmath1124 holds uniformly for @xmath1119 on @xmath1120 .",
    "further , lemmas [ lem - constsv ] and [ lem - consteval ] imply that there exists a sequences of sets @xmath1125 with @xmath1126 upon which the inequalities @xmath1127 hold uniformly for @xmath1128 .",
    "therefore , on @xmath1129 the inequalities @xmath1130 hold uniformly for @xmath1119 .",
    "since @xmath1131 for all @xmath1132 $ ] , we may choose @xmath296 such that @xmath1133 and so @xmath1134 holds for all @xmath1119 on @xmath1135 .",
    "therefore , @xmath1081 on @xmath1135 and @xmath1136 .",
    "first define @xmath1137 ^ 2   \\sqrt{l(j )    ( \\log n)/n } \\geq 1\\right\\}\\ ] ] where the minimum is again taken over all integers ( the following arguments go through with only slight modifications if we restrict @xmath47 to the maximal subset of integers that yields nested sieve spaces ) . clearly @xmath1138 and , by definition of @xmath1139 , we have @xmath1140 ^ 2 \\sqrt {   ( \\log n)/n } < \\frac{3}{2 } { l(\\bar   j_{\\max}^2)^{-1/2 } } = o(1)\\ ] ] because @xmath1141 as @xmath674 .",
    "it follows by ( [ e - tildejprop ] ) and the equivalence @xmath824 ( lemma [ lem - ip ] ) that @xmath1142 ^ 2 \\sqrt {   ( \\log n)/n }   = o(1)\\ ] ] also holds .",
    "we first prove @xmath1143 holds wpa1 . in what follows",
    "we assume that @xmath1144 since this holds wpa1 by lemma [ lem - constsv ] and the fact that @xmath1145 ( lemma [ lem - ip ] ) . by definition of @xmath1139 ,",
    "we have : @xmath1146 ^ 2 \\sqrt{l(j ) ( \\log n)/n } < 1\\right\\ } \\\\   & \\subseteq & \\left\\ { \\widehat \\tau_{\\bar   j_{\\max } } [ \\zeta(\\bar   j_{\\max})]^2 \\textstyle \\sqrt { l(\\bar   j_{\\max } ) ( \\log n)/n } < 1\\right\\ } \\\\   & = & \\left\\ { \\frac{2}{3 } \\tau_{\\bar   j_{\\max } } [ \\zeta(\\bar   j_{\\max})]^2 { \\textstyle \\sqrt { l(\\bar   j_{\\max } ) ( \\log n)/n } } < \\frac{2}{3 } \\frac{\\tau_{\\bar j_{\\max}}}{\\widehat \\tau_{\\bar j_{\\max } } } \\right\\ } \\\\   & \\subseteq & \\left\\{1 \\leq \\frac{2}{3 } \\frac{\\tau_{\\bar j_{\\max}}}{\\widehat \\tau_{\\bar j_{\\max } } } \\right\\ } \\\\   & \\subseteq &   \\left\\ { \\frac{3}{2}s_{\\bar   j_{\\max}k(\\bar   j_{\\max } ) } \\leq   \\widehat \\tau_{\\bar   j_{\\max } } ^{-1 } \\right\\}\\end{aligned}\\ ] ] where the final line is because @xmath775 .",
    "lemma [ lem - constsv ] ( using ( [ e - tildejprop1 ] ) ) implies that @xmath1147 which proves that @xmath1143 holds wpa1 .",
    "similarly , define @xmath1148 ^ 2   \\sqrt { l(j )   ( \\log n)/n } \\geq 1\\right\\}\\ ] ] and observe that @xmath1149 .",
    "we now prove @xmath1150 holds wpa1 . by lemma [ lem - ip ]",
    "there exists a cutoff @xmath386 such that @xmath796 for all @xmath1106 .",
    "moreover , @xmath1151 holds eventually . then by definition of @xmath283",
    ", we have : @xmath1152 ^ 2 \\sqrt { l(j ) ( \\log n)/n }",
    "< 1 \\right\\ } \\\\   & = & \\bigcap_{j = j_{2}}^{\\underline j_{\\max } }   \\left\\ { 4 \\tau_j [ \\zeta(j)]^2 \\sqrt { l(j ) ( \\log n)/n }   < 4 \\frac{\\tau_j}{\\widehat \\tau_j } \\right\\ } \\\\    & \\supseteq & \\bigcap_{j = j_{2}}^{\\underline j_{\\max } }   \\left\\ {   1 \\leq 4 \\frac{\\tau_j}{\\widehat \\tau_j}\\right\\ } \\\\   & = & \\bigcap_{j = j_{2}}^{\\underline j_{\\max } }   \\left\\ { \\widehat \\tau_j \\leq 4 \\tau_j \\right\\ } \\\\   & \\supseteq & \\bigcap_{j = j_{2}}^{\\underline j_{\\max } }   \\left\\ { \\widehat \\tau_j \\leq 2 s_{jk(j)}^{-1 } \\right\\}\\,.\\end{aligned}\\ ] ] lemma [ lem - constsv ] ( using ( [ e - tildejprop1 ] ) ) implies that @xmath1153 which completes the proof .",
    "the result will follow from theorem [ t - dist ] .",
    "assumption [ a - residuals ] is satisfied under assumption cs(iii ) .",
    "assumption [ a - sieve](i)(ii)(iii ) is satisfied by assumption cs ( iv ) and the second part of assumption cs(v ) , noting that @xmath117 and @xmath1154 .",
    "since the basis spanning @xmath98 is a riesz basis for @xmath69 assumption [ a - approx ] is satisfied with @xmath237 .",
    "it remains to verify assumption [ a - functional ] . by the riesz basis property we have @xmath1155 ( see section 6 of @xcite ) .",
    "observe that @xmath1156 for @xmath1157 where @xmath1158 denotes differentiation with respect to @xmath1159 and @xmath1160 denotes differentiation with respect to @xmath1161 .",
    "for @xmath427 we have @xmath1162 = \\int_{0}^{1 } \\left ( \\{h(\\mathsf p(t),\\mathsf y - s_{\\mathsf y}(t ) ) - h_0(t,\\mathsf y - s_{\\mathsf y}(t))\\}e^{-\\int_{0}^t \\partial_2 h_0(\\mathsf p(v),\\mathsf y - s_{\\mathsf y}(v))\\mathsf p'(v)\\,\\mathrm dv } \\mathsf p'(t ) \\right)\\mathrm dt\\ ] ] @xcite which is clearly a linear functional ( assumption [ a - functional](i ) ) . since @xmath459 we have @xmath1163 and @xmath1164 by corollary [ c - deriv ]",
    ". therefore , @xmath43 and @xmath1165 are within an @xmath12 neighborhood ( in hlder norm of smoothness 2 ) of @xmath0 wpa1 . then by equations ( [ e - cs - hrate0 ] ) and ( [ e - cs - hrate1 ] ) and lemma a.1 of @xcite we have @xmath1166 \\right| & = o_p\\left ( \\left ( j^{-p/2 } + \\mu_j^{-1 } \\sqrt{(j \\log n)/n } \\right)^2(1+j^{1/2 } ) \\right ) \\label{e - hn1}\\ , .   \\end{aligned}\\ ] ] moreover , by lemma a.1 of @xcite we have @xmath1167 \\right| & \\lesssim \\|\\widetilde h - h_0\\|_\\infty \\label{e - hn3}\\end{aligned}\\ ] ] which is @xmath1168 by corollary [ c - deriv ] .",
    "therefore , assumption cs(v ) guarantees that assumption [ a - functional](ii ) holds and that @xmath1169 } = o_p(n^{-1/2})$ ] . finally , for assumption [ a - functional](iii ) , it is easy to see that @xmath1170 - \\frac{\\partial f(h_0)}{\\partial h } [ ( g_\\psi^{-1/2 } \\psi^j)_j]\\right)^2 } { \\|v_n^*\\|^2 } \\\\   & = \\frac{\\tau_j^2}{\\|v_n^*\\|^2 }   \\left ( \\sum_{j=1}^j \\left(\\frac{\\partial f(\\widehat h)}{\\partial h}[(g_\\psi^{-1/2 } \\psi^j)_j ] - \\frac{\\partial f(h_0)}{\\partial h}[(g_\\psi^{-1/2 } \\psi^j)_j ] \\right)^2 \\right)\\end{aligned}\\ ] ] where @xmath1171 .",
    "moreover , @xmath1172 - \\frac{\\partial f(h_0)}{\\partial h } [ ( g_\\psi^{-1/2 } \\psi^j)_j]\\right)^2 \\lesssim \\|(g_\\psi^{-1/2 } \\psi^j)_j\\|_\\infty^2   \\times \\left ( o_p\\left ( j^{-(p-1)/2 } + \\mu_j^{-1 } j\\sqrt{(\\log n)/n } \\right ) \\right)^2\\end{aligned}\\ ] ] by lemma a.1 of @xcite and equations ( [ e - cs - hrate0 ] ) and ( [ e - cs - hrate1 ] ) .",
    "it follows that @xmath1173 which is @xmath863 by assumption cs(v ) .",
    "this follows by identical arguments to the proof of theorem [ t - cs ] , noting that @xmath1174 and so @xmath1175   & = \\frac{\\partial f_{cs}(h_0)}{\\partial h}[h - h_0 ]    + ( \\mathsf p^1 - \\mathsf p^0 ) \\left ( \\widehat h(\\mathsf p^1,\\mathsf y ) - h_0(\\mathsf p^1,\\mathsf y )   \\right ) \\\\   \\frac{\\partial f_{dwl}(\\widehat h)}{\\partial h}[v ] - \\frac{\\partial f_{dwl}(h_0)}{\\partial h}[v ] & = \\frac{\\partial f_{cs}(\\widehat h)}{\\partial h}[v ] - \\frac{\\partial f_{cs}(h_0)}{\\partial h}[v]\\end{aligned}\\ ] ] where clearly @xmath1176 .    for * result ( 1 )",
    "* , since @xmath1177 , the first part of assumption cs(v ) is satisfied provided @xmath1178 for which a sufficient condition is @xmath1179 ( since @xmath459 ) and @xmath1180 .",
    "the condition @xmath1181 becomes @xmath1182 for which a sufficient condition is @xmath1183 .",
    "the conditions @xmath1183 and @xmath1179 together imply that @xmath1180 holds .",
    "the condition @xmath1183 also implies that @xmath1184 holds whenever @xmath1185 .    for * result ( 2 ) * , we have @xmath1186 . take @xmath1187 .",
    "then @xmath1188 \\right ) \\\\   & = \\exp\\left ( \\log [ n/(\\log n)^\\varrho \\times ( \\log ( n/(\\log n)^\\varrho))^{2a/\\varsigma } ] \\right ) \\\\   & =   n/(\\log n)^\\varrho \\times ( \\log ( n/(\\log n)^\\varrho))^{2a/\\varsigma}\\end{aligned}\\ ] ] and",
    "so @xmath1189 the first part of assumption cs(v ) is then satisfied provided @xmath1190 which holds provided @xmath1191 and @xmath1192 .",
    "the condition @xmath1184 holds for any @xmath97 .",
    "the remaining condition @xmath1181 is implied by @xmath1193 for which a sufficient condition is @xmath1194 .",
    "now , we may always choose @xmath1195 so that @xmath487 .",
    "the remaining condition then holds provided @xmath1196",
    ".    follows by identical arguments to corollary [ c - cs](1 ) with @xmath1197 .",
    "we first prove * result ( 1)*. observe that @xmath1198 by assumption [ a - residuals](i)(iii ) .",
    "then by assumption [ a - functional](a ) or ( b)(i)(ii ) we have : @xmath1199}{\\|v_n^*\\|_{sd } } + o_p(1)\\,.\\ ] ] define @xmath1200 ' [ s ' g_b^{-1 } s]^{-1 } s ' g_b^{-1 } b^k(w_i)}{\\|v_n^*\\|_{sd } }   = \\pi_k t u_n^*(w_i)\\ ] ] and note that @xmath1201 = 1 $ ] .",
    "then @xmath1202}{\\|v_n^*\\|_{sd } }   & = &   \\frac{1}{\\sqrt n } \\sum_{i=1}^n z_n(w_i)u_i \\label{e - dist } \\\\   & & + \\frac{\\frac{\\partial f(h_0)}{\\partial",
    "h}[\\psi^j]'([(\\widehat s'\\widehat g_b^{-}\\widehat s)^- \\widehat s ' \\widehat g_b^{- } - ( s'g_b^{-1 } s)^{-1 } s ' g_b^{-1 } ) ( b'u/\\sqrt n)}{\\|v_n^*\\|_{sd } } \\\\   & = : & t_1 + t_2 \\,.\\notag\\end{aligned}\\ ] ] we first show @xmath1203 by the lindeberg - feller theorem . to verify the lindeberg condition ,",
    "note that @xmath1204'(s'g_b^{-1}s)^{-1}s ' g_b^{-1/2 } \\right\\| \\left\\|   g_b^{-1/2 } b^k(w_i)\\right\\| } { ( \\inf_w e[u_i^2|w_i = w])\\left\\| \\frac{\\partial f(h_0)}{\\partial h}[\\psi^j]'(s'g_b^{-1}s)^{-1}s ' g_b^{-1/2 } \\right\\| } \\\\   & \\leq & \\underline \\sigma^{-2 } \\zeta_b(k)\\end{aligned}\\ ] ] by the cauchy - schwarz inequality and assumption [ a - residuals](iii ) .",
    "therefore , @xmath1205 & \\leq & \\sup_w e[u_i^2 \\ { |u_i | \\gtrsim \\eta ( \\sqrt n/\\zeta_b(k))\\}|w_i = w ] \\\\ & = & o(1)\\end{aligned}\\ ] ] by assumption [ a - residuals](iv ) and the condition on @xmath47 . therefore , @xmath1203 .    for @xmath828 ,",
    "observe that @xmath1206'((\\widehat g_b^{-1/2}\\widehat s)^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( g_b^{-1/2}s)^-_l ) ( g_b^{-1/2 } b'u/\\sqrt n)}{\\|v_n^*\\|_{sd } } \\right| \\\\   & = & \\left| \\frac{[\\frac{\\partial f(h_0)}{\\partial h}[\\psi^j ] ' ( g_b^{-1/2}s)^-_l ] g_b^{-1/2 } s\\{(\\widehat",
    "g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\}(g_b^{-1/2 } b'u/\\sqrt n)}{\\|v_n^*\\|_{sd } } \\right| \\\\   & \\leq & \\frac{\\left\\| \\frac{\\partial f(h_0)}{\\partial h}[\\psi^j]'(g_b^{-1/2}s)^{-}_l \\right\\| \\left\\| g_b^{-1/2 } s\\{(\\widehat g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\ } \\right\\|   \\left\\|   g_b^{-1/2 } b'u/\\sqrt n \\right\\| } { ( \\inf_w e[u_i^2|w_i = w])^{1/2}\\left\\| \\frac{\\partial f(h_0)}{\\partial h}[\\psi^j]'(g_b^{-1/2}s)^{-}_l   \\right\\| } \\\\   & \\leq & \\underline \\sigma^{-1 } \\left\\| g_b^{-1/2 } s\\{(\\widehat g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\ } \\right\\| \\left\\|   g_b^{-1/2 } b'u/\\sqrt n \\right\\| \\\\   & = & o_p ( s_{jk}^{-1 } \\zeta \\sqrt{(j\\log j)/n } ) \\end{aligned}\\ ] ] where the first inequality is by the cauchy - schwarz inequality , the second is by assumption [ a - residuals](iii ) , and the final line is by lemmas [ lem - sgl2](c ) and [ lem - bul2 ] .",
    "the result follows by the equivalence @xmath906 ( see lemma [ lem - ip ] ) and the condition @xmath561 .",
    "* result ( 2 ) * follows directly from result ( 1 ) and lemma [ lem - varest ] .",
    "[ lem - varest ] let assumption [ a - residuals](i)(iii ) , [ a - sieve](iii ) and [ a - approx](i ) hold , let @xmath1207 , let @xmath563 , and let assumption [ a - functional](b)(iii ) hold if @xmath512 is nonlinear .",
    "then : @xmath1208    first write @xmath1209 where @xmath1210^{-1 } \\frac{\\partial f ( \\widehat h)}{\\partial h}[\\psi^j ] \\\\",
    "\\omega^o & = g_b^{-1/2 } \\omega g_b^{-1/2 } & \\gamma_n & = \\textstyle g_b^{-1/2 }   s [ s '   g_b^{-1 }   s]^{-1 } \\frac{\\partial f ( h_0)}{\\partial h}[\\psi^j]\\end{aligned}\\ ] ] and observe that @xmath1211 and @xmath1212 .",
    "control of @xmath1006 : we first show that @xmath1213 to simplify notation , let @xmath1214}{\\|v_n^*\\| }   \\quad \\mbox{and } \\quad \\widehat{\\partial } = \\frac{\\frac{\\partial f(\\widehat h)}{\\partial h}[\\psi^j]}{\\|v_n^*\\|}\\ ] ] and note that @xmath1215 under assumptions [ a - residuals](i)(iii ) and that @xmath1216 if @xmath537 is linear .",
    "then we have : @xmath1217 where the third line is lemma [ lem - sgl2](c ) and the final line is by assumption [ a - functional](b)(iii ) .",
    "therefore , ( [ e - gambd1 ] ) holds by the equivalence @xmath824 ( lemma [ lem - ip ] ) and the condition @xmath1218 .",
    "finally , since all eigenvalues of @xmath1219 are bounded between @xmath1220 and @xmath1221 under assumption [ a - residuals](i)(iii ) , it follows from ( [ e - gambd1 ] ) and cauchy - schwarz that @xmath1222 .",
    "control of @xmath828 : equation ( [ e - gambd1 ] ) implies that @xmath1223 .",
    "therefore , @xmath1224 by lemma [ lem - omega ] .",
    "[ lem - omega ] let assumptions [ a - residuals](i)(ii ) hold , let @xmath1225 , and let @xmath1226 with @xmath606 .",
    "then : @xmath1227    by the triangle inequality : @xmath1228 where the first term may easily be deduced from the proof of lemma 3.1 of @xcite , the second then follows because @xmath1229 , and the third follows similarly because @xmath1230 by lemma [ lem - matl2 ] .",
    "we break the proof into a number of parts .    *",
    "part 1 : * we first show that the sieve @xmath4-stat process can be uniformly well approximated by the process @xmath1231 ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1}}{{\\|v_{n , t}^*\\|}_{sd } } \\left(\\frac{1}{\\sqrt n } \\sum_{i=1}^n",
    "b^k(w_i ) u_i \\right)\\,.\\ ] ] by assumption [ a - functional](a ) or ( b)(i)(ii ) , we have @xmath1232}{{\\|v_{n , t}^*\\|}_{sd } } - \\widehat{\\mathbb z}_n(t)\\right| + o_p(\\eta_n )   \\times \\sup_{t",
    "\\in \\mathcal t } \\left| \\frac{\\widehat{\\|v_{n , t}^*\\|}_{sd}}{{\\|v_{n , t}^*\\|}_{sd } }   \\right| \\\\   & & +   \\sup_{t \\in \\mathcal t } \\left| \\frac{{\\|v_{n , t}^*\\|}_{sd}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } -1 \\right| \\times \\sup_{t",
    "\\in \\mathcal t } \\left| \\sqrt n \\frac { \\frac{f_t(h_0)}{\\partial h}[\\widehat h - \\widetilde h]}{{\\|v_{n , t}^*\\|}_{sd } } \\right| \\\\   & = : &   t_1 + t_2 + t_3\\,.\\end{aligned}\\ ] ] control of @xmath1006 : as in the proof of theorem [ t - dist ] , @xmath1233'((\\widehat g_b^{-1/2}\\widehat s)^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( g_b^{-1/2}s)^-_l ) ( g_b^{-1/2 } b'u/\\sqrt n)}{\\|v_{n , t}^*\\|_{sd } } \\right| \\\\   & = & \\sup_{t \\in \\mathcal t } \\left| \\frac{[\\frac{\\partial f_t(h_0)}{\\partial h}[\\psi^j ] ' ( g_b^{-1/2}s)^-_l ] g_b^{-1/2 } s\\{(\\widehat g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\}(g_b^{-1/2 } b'u/\\sqrt n)}{\\|v_{n , t}^*\\|_{sd } } \\right| \\\\   & \\leq & \\sup_{t \\in \\mathcal t } \\frac{\\left\\| \\frac{\\partial f_t(h_0)}{\\partial h}[\\psi^j]'(g_b^{-1/2}s)^{-}_l \\right\\| \\left\\| g_b^{-1/2 } s\\{(\\widehat g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\ } \\right\\|   \\left\\|   g_b^{-1/2 } b'u/\\sqrt n \\right\\| } { ( \\inf_w e[u_i^2|w_i = w])^{1/2}\\left\\| \\frac{\\partial f_t(h_0)}{\\partial h}[\\psi^j]'(g_b^{-1/2}s)^{-}_l   \\right\\| } \\\\   & \\leq & \\underline \\sigma^{-1 } \\left\\| g_b^{-1/2 } s\\{(\\widehat g_b^{-1/2}\\widehat s')^-_l \\widehat g_b^{-1/2 } g_b^{1/2 } - ( s'g_b^{-1/2})^-_l \\ } \\right\\| \\left\\|   g_b^{-1/2 } b'u/\\sqrt n \\right\\| \\\\   & = & o_p ( \\tau_j \\zeta \\sqrt{(j\\log j)/n } ) \\end{aligned}\\ ] ] where the first inequality is by the cauchy - schwarz inequality , the second is by assumption [ a - residuals](iii ) , and the final line is by lemmas [ lem - sgl2](c ) and [ lem - bul2 ] and the equivalence @xmath906 ( see lemma [ lem - ip ] ) .    control of @xmath828 : lemma [ lem - varest - u ] shows @xmath1234 from which it follows that @xmath1235 .    control of @xmath1236 : by lemma [ lem - varest - u ] and the bound for @xmath1006 , we have : @xmath1237}{{\\|v_{n , t}^*\\|}_{sd } } \\right| \\\\   & = o_p ( \\delta_{v , n } + \\delta_{h , n } + \\eta_n ' ) \\times \\sup_{t \\in \\mathcal t } | \\widehat{\\mathbb z}_n(t ) |    \\\\   & = o_p ( \\delta_{v , n } + \\delta_{h , n } + \\eta_n ' ) \\times ( o_p(r_n ) + \\sup_{t \\in \\mathcal t } | \\mathbb z_n(t)| ) \\\\   & = o_p ( \\delta_{v , n } + \\delta_{h , n } + \\eta_n ' ) \\times ( o_p(r_n ) + o_p(c_n))\\end{aligned}\\ ] ] where the second - last line is by part 2 and the final line is by lemma [ lem - esup ] .",
    "therefore we have proved : @xmath1238 with the final line by assumption [ a - lipschitz](iii ) .    * part 2 : * recall that @xmath1239 .",
    "we use yurinskii s coupling ( * ? ? ?",
    "* theorem 10 , p. 244 ) to show that there exists a sequence of @xmath1240 random vectors @xmath1241 such that @xmath1242 by assumption [ a - residuals](iv ) we have @xmath1243 \\lesssim n^{-1/2 } \\zeta_{b , k } e[\\|g_b^{-1/2 } b^k(w_i)\\|^2_{\\ell^2 } ] = \\frac{\\zeta_{b , k } k}{\\sqrt",
    "n } = o \\left ( \\frac{\\zeta_{b , k } j}{\\sqrt n } \\right ) \\,.\\end{aligned}\\ ] ] existence of @xmath1241 follows under the condition @xmath1244 then the process @xmath1245 given by @xmath1246 ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}}{{\\|v_{n , t}^*\\|}_{sd } }   \\mathcal z_n\\ ] ] is a centered gaussian process with the covariance function @xmath1247 = \\frac{\\frac{\\partial f_{t_1}(h_0)}{\\partial h}[\\psi^j]'[s ' g_b^{-1 } s]^{-1 } s ' g_b^{-1 } \\omega g_b^{-1 } s[s ' g_b^{-1 } s]^{-1 } \\frac{\\partial f_{t_2}(h_0)}{\\partial h}[\\psi^j]}{\\|v_{n , t_1}^*\\|\\|v_{n , t_2}^*\\| } \\,.\\ ] ]    now observe that @xmath1248 ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}}{{\\|v_{n , t}^*\\|}_{sd } } \\right\\|_{\\ell^2 } = \\sup_{t \\in \\mathcal t } \\frac{{\\|v_{n , t}^*\\|}}{{\\|v_{n , t}^*\\|}_{sd } } \\asymp 1\\ ] ] by assumption [ a - residuals](i)(iii ) .",
    "therefore , @xmath1249 by equations ( [ e - yurinskii ] ) and ( [ e - unif - equiv ] ) and cauchy - schwarz .    *",
    "part 3 : * each of the terms @xmath1250 is centered under @xmath634 because @xmath576 = 0 $ ] for @xmath1251 .",
    "moreover , @xmath1252 = \\widehat \\omega^o\\ ] ] where @xmath1253 , and @xmath1254 \\lesssim n^{-3/2 } \\sum_{i=1}^n \\| g_b^{-1/2 } b^k(w_i)\\|_{\\ell^2}^2 | \\widehat u_i |^3\\ ] ] because @xmath1255 < \\infty$ ] uniformly in @xmath396 , and where @xmath1256 holds wpa1 ( by markov s inequality using @xmath1257 and assumption [ a - residuals](iv ) ) . a second application of yurinskii s coupling conditional on the data @xmath1258 then yields existence of a sequence of @xmath1259 random vectors @xmath1260 such that @xmath1261 wpa1 .",
    "therefore : @xmath1262 ' [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}}{\\widehat{\\|v_{n , t}^*\\|}_{sd}}\\mathcal z_n^ * \\right| = o_{p^*}(r_n)\\ ] ] wpa1 . now observe that we can define a centered gaussian process @xmath1263 under @xmath634 by @xmath1264 ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}}{{\\|v_{n , t}^*\\|}_{sd } } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2 } \\mathcal z_n^*\\ ] ] which has the same covariance function as @xmath1265 ( see equation ( [ e - cov - fn ] ) ) whenever @xmath1266 is invertible ( which it is wpa1 ) .",
    "therefore , by lemma [ lem - varest - boot ] we have : @xmath1267 ' [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } \\mathcal z_n^ * - \\widetilde{\\mathbb z}_n(t)\\right| = o_p^*(c_n^{-1})\\ ] ] wpa1 .",
    "it follows from equations ( [ e - zpt2 ] ) and ( [ e - zpt3 ] ) and assumption [ a - lipschitz](iii ) that @xmath1268 wpa1 .    * part 4 : * we now establish validity of the uniform confidence band . by equations ( [ e - unifzhat ] ) and ( [ e - zpt1 ] ) , we have : @xmath1269 we may choose a sequence of positive constants @xmath1270 with @xmath1271 such that @xmath1272 wpa1 . by an anti - concentration inequality ( * ? ? ?",
    "* theorem 2.1 ) and lemma [ lem - esup ] , we have : @xmath1273 \\lesssim \\epsilon_n = o(1)\\end{aligned}\\ ] ] which , together with ( [ e - tstat - u - exp ] ) , yields : @xmath1274    moreover , by ( [ e - zpt5 ] ) we may choose a sequence of positive constants @xmath1275 with @xmath1276 such that @xmath1277 holds wpa1 .",
    "similar arguments then yield : @xmath1278 wpa1 .",
    "this , together with equation ( [ e - zpt5 ] ) , yields : @xmath1279 the result is immediate from equations ( [ e - diffprob ] ) and ( [ e - diffprob1 ] ) and the fact that @xmath1280 holds uniformly in @xmath1281 wpa1 .",
    "[ lem - varest - u ] let assumptions [ a - data](i ) , [ a - residuals](i)(iii ) , [ a - sieve](iii ) and [ a - approx](i ) hold , let @xmath1207 , let @xmath1226 with @xmath606 , and let assumption [ a - functional](b)(iii ) hold if @xmath512 is nonlinear . then : @xmath1282    the proof follows by identical arguments to the proof of lemma [ lem - varest ] .    [ lem - esup ] let assumptions [ a - data](i ) , [ a - residuals](i ) , [ a - approx](i ) , and [ a - lipschitz](i)(ii ) hold . then : @xmath1283 & \\lesssim c_n \\\\",
    "\\sup_{t \\in \\mathcal t } |\\mathbb z_n(t)| & = o_p ( c_n ) \\,.\\end{aligned}\\ ] ]    observe that @xmath1284^{1/2}$ ] . by corollary 2.2.8 of @xcite and assumptions [ a - lipschitz](i)(ii )",
    ", there exists a universal constant @xmath864 such that @xmath1285 \\leq e[|\\mathbb z_n(\\bar t)| ] + c \\int_0^\\infty \\sqrt{\\log n(\\mathcal t , d_n,\\epsilon ) } \\,\\mathrm d \\epsilon\\ ] ] for any @xmath1286 .",
    "observe that @xmath1287   = \\sqrt{2/\\pi}$ ] because @xmath1288 .",
    "therefore , @xmath1289",
    "\\lesssim c_n$ ] .",
    "the second result follows by markov s inequality .",
    "[ lem - varest - boot ] let assumptions [ a - data](iii ) , [ a - residuals](i)(iii)(iv ) , [ a - sieve](iii ) , [ a - approx](i ) , and [ a - lipschitz ] hold , let @xmath1207 , let @xmath1226 with @xmath606 , and let assumption [ a - functional](b)(iii ) hold if @xmath512 is nonlinear .",
    "let @xmath1260 and @xmath1290 be as in the proof of theorem [ t - dist - u ] .",
    "then : @xmath1291 ' [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } \\mathcal z_n^ * - \\widetilde{\\mathbb z}_n(t)\\right| = o_p^*(c_n^{-1})\\ ] ] with probability approaching one .",
    "first note that because @xmath1292 and the minimum and maximum eigenvalues of @xmath1266 are uniformly bounded away from @xmath85 and @xmath86 wpa1 ( by lemma [ lem - omega ] and assumptions [ a - residuals](i)(iii ) ) , we have @xmath1293 wpa1 by chebyshev s inequality .",
    "now , writing out term by term we have : @xmath1294 ' [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } - \\frac{\\frac{\\partial f_t ( h_0)}{\\partial h}[\\psi^j ] ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}(\\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2}}{{\\|v_{n , t}^*\\|}_{sd } } \\right ) \\mathcal z_n^ * \\right| \\\\   & \\leq \\sup_{t \\in \\mathcal t } \\left|   \\frac { \\left ( \\frac{\\partial f_t(\\widehat h)}{\\partial h}[\\psi^j ] ' - \\frac{\\partial f_t(h_0)}{\\partial h}[\\psi^j ] ' \\right ) ( g_b^{-1/2}s)^-_l g_b^{-1/2}s [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } \\mathcal z_n^ * \\right| \\\\   & + \\sup_{t \\in \\mathcal t } \\left|   \\frac{\\frac{\\partial f_t(h_0)}{\\partial h}[\\psi^j ] '   \\left ( [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2}\\right ) } { { \\|v_{n , t}^*\\|}_{sd } } \\mathcal z_n^ * \\right| \\times \\sup_{t \\in",
    "\\mathcal t } \\frac{{\\|v_{n , t}^*\\|}_{sd}}{\\widehat{\\|v_{n , t}^*\\|}_{sd } } \\\\   & + \\sup_{t \\in \\mathcal t }   \\left| \\frac{{\\|v_{n , t}^*\\|}_{sd}}{\\widehat{\\|v_{n , t}^*\\|}_{sd}}-1 \\right| \\times \\sup_{t \\in \\mathcal t }    \\left| \\frac{\\frac{\\partial f_t ( h_0)}{\\partial h}[\\psi^j ] ' [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}(\\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2}}{{\\|v_{n , t}^*\\|}_{sd } }   \\mathcal z_n^ * \\right| \\quad = : t_1 + t_2 + t_3\\,.\\end{aligned}\\ ] ] control of @xmath1006 : by cauchy - schwarz , we have : @xmath1295^{-1 } \\widehat s ' \\widehat g_b^{-1/2 } \\right\\|_{\\ell^2 } \\times \\|(\\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2}\\|_{\\ell^2 }   \\times \\left\\| \\mathcal z_n^ *   \\right\\|_{\\ell^2 } \\\\   & = o_p(\\eta_n ' ) \\times o_p(1 ) \\times o_p(1 ) \\times o_p(1 ) \\times o_{p^*}(\\sqrt k)\\end{aligned}\\ ] ] where the first term is by assumption [ a - functional](b)(iii ) ( or zero if the @xmath617 are linear functionals ) , the second term is by lemma [ lem - varest - u ] , the third is by lemma [ lem - sgl2](c ) ( using the fact that @xmath1296 , see lemma [ lem - ip ] ) and the fact that @xmath1297^{-1 }   s ' g_b^{-1/2 } \\|_{\\ell^2 } = 1 $ ] , and the fourth term is by lemma [ lem - omega ] . therefore , @xmath1298 wpa1 ( since @xmath1299 ) , and is therefore @xmath1300 wpa1 under assumption [ a - lipschitz](iii ) .    control of @xmath828 : let @xmath1301 denote the gaussian process ( under @xmath634 ) defined by @xmath1302 '   \\left ( [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2}\\right ) } { \\widehat{\\|v_{n , t}^*\\|}_{sd } } \\mathcal z_n^*\\ ] ] for each @xmath570 .",
    "the intrinsic semi - metric @xmath1303 of @xmath1301 is @xmath1304 $ ] for each @xmath1305 , where @xmath1306 denotes expectation under the measure @xmath634 .",
    "observe that : @xmath1307 ' } { { \\|v_{n , t_1}^*\\|}_{sd } } - \\frac{\\frac{\\partial f_{t_2 } ( h_0)}{\\partial h}[\\psi^j ] ' } { { \\|v_{n , t_2}^*\\|}_{sd } } \\bigg )   [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2}(\\omega^o)^{1/2}\\\\   & \\times ( \\omega^o)^{-1/2 } g_b^{-1/2 } s \\left\\ { [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2 } \\right\\ }   ( \\widehat \\omega^o)^{1/2 } \\bigg\\|_{\\ell^2 } \\\\",
    "\\lesssim & d_n(t_1,t_2 ) \\times    \\left\\| g_b^{-1/2 } s'\\left\\ { [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2 } \\right\\ } \\right\\|_{\\ell^2}\\end{aligned}\\ ] ] wpa1 , where the first line uses the fact that @xmath1266 is invertible wpa1 and the second line uses the fact that @xmath1219 and @xmath1266 have eigenvalue uniformly bounded away from @xmath85 and @xmath86 wpa1 .",
    "it follows by lemma [ lem - sgl2](c ) and lemmas [ lem - omega ] and [ lem - sqrtm ] that @xmath1308^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2 } \\right\\ } \\right\\|_{\\ell^2 } \\\\   & \\leq \\left\\| g_b^{-1/2 } s'\\left\\ { [ \\widehat s ' \\widehat g_b^{-1 } \\widehat s]^{-1 } \\widehat s ' \\widehat g_b^{-1/2}- [ s '   g_b^{-1 }   s]^{-1 }   s '   g_b^{-1/2 } \\right\\}\\right\\|_{\\ell^2 } + \\left\\| i -   ( \\omega^o)^{1/2 } ( \\widehat \\omega^o)^{-1/2 } \\right\\|_{\\ell^2 } \\\\   & = o_p ( \\tau_j \\zeta\\sqrt{(\\log n)/n } ) +   o_p\\big ( \\big ( \\zeta_{b , k}^{(2+\\delta)/\\delta } \\sqrt{(\\log k)/n } \\big)^{\\delta/(1+\\delta ) } + \\delta_{h , n}\\big ) \\\\   & = o_p ( \\delta_{v , n } + \\delta_{h , n } ) \\,.\\end{aligned}\\ ] ] therefore , @xmath1309 wpa1 .",
    "moreover , by similar arguments we have @xmath1310^{1/2 } \\lesssim   o_p ( \\delta_{v , n } + \\delta_{h , n})\\ ] ] wpa1 .",
    "therefore , we can scale @xmath1301 by dividing through by a sequence of positive constants of order @xmath1311 to obtain @xmath1312 \\lesssim o_p ( ( \\delta_{v , n } + \\delta_{h , n } ) ) \\times c_n\\ ] ] wpa1 by identical arguments to the proof of lemma [ lem - esup ]",
    ". therefore , @xmath1313 wpa1 by lemma [ lem - varest - u ] and so @xmath1314 under assumption [ a - lipschitz](iii ) .",
    "control of @xmath1236 : the second term in @xmath1236 is the supremum of a gaussian process with the same distribution ( under @xmath634 ) as @xmath1245 ( under @xmath1315 ) .",
    "therefore , by lemmas [ lem - varest - u ] and [ lem - esup ] we have : @xmath1316 and so @xmath1317 wpa1 under assumption [ a - lipschitz](iii ) .    for each @xmath1305",
    "we have : @xmath1318^{-1 } \\left ( \\frac{\\partial f_{t_1}(h_0)}{\\partial h}[\\psi^j ] -   \\frac{\\partial f_{t_2}(h_0)}{\\partial h}[\\psi^j ] \\right ) \\right\\|_{\\ell^2 } \\notag \\\\   & \\leq & \\frac{2 \\overline \\sigma s_{jk}^{-1}}{\\underline v_n } \\left\\| g_\\psi^{-1/2 }   \\left ( \\frac{\\partial f_{t_1}(h_0)}{\\partial h}[\\psi^j ] -   \\frac{\\partial f_{t_2}(h_0)}{\\partial h}[\\psi^j ] \\right ) \\right\\|_{\\ell^2 } \\notag \\\\   & \\lesssim & \\frac { \\tau_j   \\gamma_n } { \\underline v_n } \\| t_1 - t_2 \\|_{\\ell^2}^{\\gamma_n } \\label{e - vlipbd}\\end{aligned}\\ ] ] where the first inequality is because @xmath1319 whenever @xmath1320 and the third is by the equivalence @xmath824 ( see lemma [ lem - ip ] ) . by ( [ e - vlipbd ] ) and compactness of @xmath566 , we have @xmath1321 for some finite constant @xmath864 .    by assumption we may take @xmath1322 .",
    "assumption [ a - functional] is therefore satisfied with @xmath1323 by remark [ rmk - a5suff](a ) and lemma [ lem - bias ] .",
    "the continuity condition in remark [ rmk - a6suff ] holds with @xmath1324 for some @xmath1325 and @xmath1326 since @xmath98 is spanned by a b - spline basis of order @xmath1327 ( * ? ? ?",
    "* section 5.3 ) .",
    "assumption [ a - lipschitz](i)(ii ) therefore holds with @xmath1328 by remark [ rmk - a6suff ] because @xmath1329 .",
    "we can therefore take @xmath1330 in assumption [ a - lipschitz](iii ) .",
    "the first condition in assumption [ a - lipschitz](iii ) then holds provided @xmath1331 and the second holds provided @xmath1332 holds ( using theorem [ t - rate ] for @xmath605 ) , for which a sufficient condition is @xmath642 and @xmath1333 ( since we already require @xmath1334 ) .",
    "part ( a ) is equation ( 3.4 ) on p. 141 of @xcite . for part ( b ) , let @xmath1335 , let @xmath1336 denote the density of @xmath6 and let @xmath1337 and @xmath1338 .",
    "then , @xmath1339v   & \\geq & \\underline f_x   \\int_0 ^ 1 ( \\psi^j(x)'v)^2\\,\\mathrm dx   \\\\   & \\geq & \\underline f_x   c_1 ^ 2 \\frac{\\min_{-r+1 \\leq j \\leq m } ( t_{j+r}-t_r)}{r } \\|v\\|_{\\ell^2}^2 \\\\   & \\geq & \\underline f_x c_1 ^ 2 \\frac{c_2 j^{-1}}{r } \\|v\\|^2_{\\ell^2}\\end{aligned}\\ ] ] for some finite positive constant @xmath861 , where the first inequality is by assumption [ a - data](i ) , the second is by theorem 4.2 ( p. 145 ) of @xcite with @xmath1340 , and the third is by uniform boundedness of the mesh ratio . by the variational characterization of eigenvalues of selfadjoint matrices , we have : @xmath1341v}{\\|v\\|_{\\ell^2}^2 }   \\geq \\underline f_x c_1 ^ 2 \\frac{c_2 j^{-1}}{r}\\end{aligned}\\ ] ] this establishes the upper bound on @xmath1342 .",
    "the proof of the lower bound for @xmath1343 follows analogously by theorem 4.2 ( p. 145 ) of @xcite with @xmath1340 .",
    "part ( c ) then follows directly from part ( b ) .",
    "the @xmath1344 norm of the tensor product of vectors equals the product of the @xmath1344 norms of the factors , whence part ( a ) follows from lemma [ lem - spline1 ] . as @xmath1345 is formed as the tensor - product of univariate b - splines , each element of @xmath1345 is of the form @xmath1346 where @xmath1347 denotes the @xmath1348th element of the vector of univariate b - splines . let @xmath1335 .",
    "we may index the elements of @xmath1349 by the multi - indices @xmath1350 . by boundedness of @xmath1351 away from zero and fubini s theorem , we have : @xmath1339v   & \\geq & \\underline f_x   \\int_0 ^ 1\\cdots \\int_0 ^ 1 \\big ( \\sum_{i_1,\\ldots , i_l } v_{i_1\\cdots i_d } \\prod_{l=1}^d",
    "\\psi_{j i_l}(x_l ) \\big)^2\\,\\mathrm dx_1 \\cdots",
    "\\mathrm dx_d   \\\\   & = & \\underline f_x   \\int_0 ^ 1\\cdots \\int_0 ^ 1 \\sum_{i_2,\\ldots , i_l } \\sum_{j_2,\\ldots , j_l } \\left ( \\prod_{l=2}^d \\psi_{j i_l}(x_l ) \\right ) \\left ( \\prod_{l=2}^{d } \\psi_{j j_l}(x_l ) \\right ) \\\\   & & \\quad \\left\\ { \\int_0 ^ 1 \\sum_{i_1 } \\sum_{j_1 } v_{i_1\\cdots i_{d } } v_{j_1 \\cdots j_{d } } \\psi_{j i_1}(x_1 ) \\psi_{j j_1}(x_1 ) \\mathrm dx_1 \\right\\ } \\,\\mathrm dx_2 \\cdots",
    "\\mathrm dx_d \\,.\\end{aligned}\\ ] ] applying theorem 4.2 ( p. 145 ) of @xcite to the term in braces , and repeating for @xmath1352 , we have : @xmath1339v & \\geq & \\underline f_x \\left(c_1 ^ 2 \\frac{\\min_{-r+1 \\leq j \\leq m } ( t_{j+r}-t_r)}{r } \\right)^d \\|v\\|_{\\ell^2}^2   \\\\   & \\geq & \\underline f_x c_1^{2d } \\frac{c_2^d j^{-1}}{r^d } \\|v\\|^2_{\\ell^2}\\end{aligned}\\ ] ] where the second inequality is by uniform boundedness of the mesh ratio .",
    "the rest of the proof follows by identical arguments to lemma [ lem - spline1 ] .",
    "each of the interior @xmath1353 and @xmath1354 have support @xmath702 $ ] , therefore @xmath1355 ( respectively @xmath1356 ) for less than or equal to @xmath1357 interior @xmath1353 ( resp .",
    "@xmath1354 ) and for any @xmath1358 $ ] .",
    "further , there are only @xmath704 left and right @xmath1353 and @xmath1354 .",
    "therefore , @xmath1355 ( respectively @xmath1356 ) for less than or equal to @xmath1359 of the @xmath1353 ( resp .",
    "@xmath1354 ) at resolution level @xmath233 for each @xmath1358 $ ] . by construction of the basis , each of @xmath696 , @xmath1360 , @xmath1361 for @xmath706 and @xmath1362 , @xmath1363 for @xmath1364 are continuous and therefore attain a finite maximum on @xmath182 $ ] .",
    "therefore , each of the @xmath1353 and @xmath1354 are uniformly bounded by some multiple of @xmath1365 and so : @xmath1366 the result then follows because @xmath747 . for part ( b ) , because @xmath1351 is uniformly bounded away from @xmath85 and @xmath86 and the wavelet basis is orthonormal for @xmath1367 $ ] , we have @xmath1368 v \\asymp   v '   \\left (   \\int_0 ^ 1\\psi^j(x)\\psi^j(x)'\\,\\mathrm dx \\right ) v = \\|v\\|^2_{\\ell^2}\\ ] ] and so all eigenvalues of @xmath1369 are uniformly ( in @xmath47 ) bounded away from @xmath85 and @xmath86 .",
    "part ( c ) follows directly .",
    "lemma [ lem - wavelet1 ] implies that each of the factor vectors in the tensor product at level @xmath233 has @xmath1344 norm of order @xmath1370 uniformly for @xmath1371^d$ ] and in @xmath233 .",
    "there are at most @xmath1372 such tensor products at each resolution level .",
    "therefore , @xmath1373 since @xmath1374 .",
    "parts ( b ) and ( c ) follow by the same arguments of the proof of lemma [ lem - wavelet1 ] since the tensor - product basis is orthonormal for @xmath361^d)$ ] .",
    "[ lem - weyl ] let @xmath1375 and let @xmath1376 , @xmath1377 denote the @xmath396th ( ordered ) singular value of @xmath307 and @xmath1378 respectively , for @xmath1379 . then : @xmath1380 for all @xmath1379 .",
    "in particular , @xmath1381 .",
    "we prove the results for @xmath1404 ; convergence of @xmath1405 and @xmath1406 is proved in lemma 2.1 of @xcite .",
    "note that @xmath1407\\}g_\\psi^{-1/2 } = : \\sum_{i=1}^n \\xi_i^o\\ ] ] where @xmath1408 .",
    "also , @xmath1409 \\right\\|_{\\ell^2 } & \\leq & n^{-1 } \\|e[g_b^{-1/2}b^k(w_i)\\psi^j(x_i)'g_\\psi^{-1 } \\psi^j(x_i)b^k(w_i)'g_b^{-1/2}]\\|_{\\ell^2 } \\\\   & \\leq & n^{-1 } \\zeta_{\\psi , j}^2 \\|e[g_b^{-1/2}b^k(w_i)b^k(w_i)'g_b^{-1/2}]\\|_{\\ell^2 }   \\\\   & = & n^{-1 } \\zeta_{\\psi , j}^2 \\|i\\|_{\\ell^2 } \\\\   & = & n^{-1 } \\zeta_{\\psi , j}^2\\end{aligned}\\ ] ] by the fact that @xmath1410",
    ". an identical argument yields the bound @xmath1411 \\|_{\\ell^2 } \\leq n^{-1 } \\zeta_{b , k}^2 $ ] . applying a bernstein inequality for random matrices ( * ? ? ?",
    "* theorem 1.6 ) yields @xmath1412 the convergence rate @xmath1413 from this inequality under appropriate choice of @xmath4 .",
    "[ lem - bhj ] let @xmath1415 for any deterministic @xmath1416 and @xmath1417 . then",
    ": @xmath1418)\\|_{\\ell^2 } \\\\   & & \\quad = \\quad o_p \\left ( \\big ( \\sqrt{k / n } \\times \\|h_0 - h_j\\|_{\\infty } \\big ) \\wedge \\big ( \\zeta_{b , k}/\\sqrt{n } \\times \\|h_0 - h_j\\|_{l^2(x ) }   \\big ) \\right ) \\,.\\end{aligned}\\ ] ]    let @xmath1419 and denote @xmath1420 . as the summands have expectation zero , we have @xmath1421\\}\\|_{\\ell^2}^2 \\right ]",
    "\\\\   & \\leq & \\frac{1}{n } e \\left [ \\sum_{k=1}^k ( \\widetilde b_{kk}(w_i))^2 ( h_0(x_i ) - h_j(x_i))^2 \\right ] \\\\   & \\leq & \\frac{k}{n } \\|h_0 - h_j\\|^2_\\infty \\wedge \\frac{\\zeta_{b , k}^2}{n } \\|h_0 - h_j\\|_{l^2(x)}^2\\,.\\end{aligned}\\ ] ] the result follows by chebyshev s inequality .",
    "we begin by rewriting the target in terms of the orthonormalized matrices @xmath1425 we first bound the term in braces . by the triangle inequality",
    ", @xmath1426 lemma [ lem - matl2 ] provides that @xmath1427 let @xmath1428 denote the event upon which @xmath1429 and note that @xmath19 because @xmath1430 .",
    "then by lemmas [ lem - inv ] and [ lem - sqrtm ] we have @xmath1431 on @xmath1428 .",
    "it follows by expression ( [ e - gcgce ] ) and the fact that @xmath19 that @xmath1432 which in turn implies that @xmath1433 .    to bound @xmath1434",
    ", it follows by equations ( [ e - scgce ] ) and ( [ e - gbinvrate ] ) and the fact that @xmath1435 that : @xmath1436 let @xmath1437 denote the event on which @xmath1438 and note that @xmath1439 by virtue of the condition @xmath1440 .",
    "lemma [ lem - linv ] provides that @xmath1441 on @xmath1442 , and so @xmath1443 by ( [ e  lbound ] ) and ( [ e - stewart ] ) .",
    "it follows from equations ( [ e - asa ] ) and ( [ e - maintarget ] ) that : @xmath1444 which , together with the condition @xmath1423 , proves part ( a ) .",
    "part ( b ) follows similarly .    for part ( c ) , we pre and post multiply terms in the product by @xmath1445 and @xmath1446 to obtain : @xmath1447^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{- } - s^o[s^{o\\prime } s^o]^{-1 } s^{o\\prime}\\|_{\\ell^2 } \\notag \\\\   & & \\quad \\leq \\quad\\|   s^o   [ \\widehat s^{o \\prime } ( \\widehat g_b^o)^{- } \\widehat s^o]^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{-1/2 } ( ( \\widehat g_b^o)^{-1/2 } - i_k ) \\|_{\\ell^2 } \\notag \\\\   & & \\quad \\quad \\quad + \\| ( s^o - ( \\widehat g_b^o)^{-1/2}\\widehat s^o )   [ \\widehat s^{o \\prime } ( \\widehat g_b^o)^{- } \\widehat s^o]^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{-1/2}\\|_{\\ell^2 } \\notag \\\\   & & \\quad \\quad \\quad + \\| ( \\widehat g_b^o)^{-1/2}\\widehat s^o   [ \\widehat s^{o \\prime } ( \\widehat g_b^o)^{- } \\widehat s^o]^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{-1/2 } - s^o[s^{o\\prime } s^o]^{-1 } s^{o\\prime}\\|_{\\ell^2 } \\label{e - ssa1}\\,.\\end{aligned}\\ ] ] note that @xmath1448 on @xmath1442 by lemma [ lem - mpnorm ] , so @xmath1449 it follows by substituting ( [ e - gbinvrate ] ) , ( [ e  lbound ] ) , and ( [ e - ssa ] ) into ( [ e - ssa1 ] ) that @xmath1450^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{-1/2 } - s^o[s^{o\\prime } s^o]^{-1 } s^{o\\prime}\\|_{\\ell^2}\\ , .",
    "\\label{e - partc1}\\end{aligned}\\ ] ] the remaining term on the right - hand side of ( [ e - partc1 ] ) is the @xmath1451 norm of the difference between the orthogonal projection matrices associated with @xmath1399 and @xmath1452 .",
    "applying lemma [ lem - projm ] , we obtain : @xmath1453^{- } \\widehat s^{o \\prime } ( \\widehat g_b^o)^{-1/2 } - s^o[s^{o\\prime } s^o]^{-1 } s^{o\\prime}\\|_{\\ell^2 } \\leq 2 s_{jk}^{-1 } \\|(\\widehat g_b^o)^{-1/2}\\widehat s^o - s^o\\|_{\\ell^2}\\ ] ] on @xmath1442 .",
    "result ( c ) then follows by ( [ e  lbound ] ) and ( [ e - partc1 ] ) .      throughout this subsection ,",
    "let @xmath386 be the smallest integer such that @xmath1105 for all @xmath1106 .",
    "note that @xmath386 is well defined by lemma [ lem - ip ] and assumption [ a - data](iii ) ( which guarantees @xmath1454 for all @xmath233 ) .",
    "let @xmath1458 and @xmath1459 be as defined in the proof of lemma [ lem - chat ] .",
    "then , @xmath1460 where with some abuse of notation we let @xmath1461 .",
    "straightforward algebra yields the inequality @xmath1462    control of @xmath1463 : first we rewrite @xmath1464 where @xmath1465 and @xmath1466 denotes the @xmath955th element of a vector @xmath1349 .",
    "the summands may be bounded using lemma [ lem - mpnorm ] and the cauchy - schwarz inequality to obtain : @xmath1467 uniformly in @xmath396 and @xmath233 .",
    "let @xmath1468 denote the @xmath1469th diagonal element of a matrix @xmath307 .",
    "the second moments of the summands may be bounded by observing that @xmath1470   & = & ( ( g_{b , k(j)}^{-1/2}s_{jk(j)})^-_l ( ( g_{b , k(j)}^{-1/2}s_{jk(j)})^-_l)')_{mm } \\notag \\\\   & = & ( ( s_{jk(j)}'g_{b , k(j)}^{-1}s_{jk(j)})^{-1})_{mm } \\notag \\\\   & \\leq & \\| ( s_{jk(j)}'g_{b , k(j)}^{-1}s_{jk(j)})^{-1 } \\|_{\\ell^2 } \\notag \\\\   & \\leq & \\frac{1 } { s_{jk(j)}^2 e_j } \\label{e - var0}\\end{aligned}\\ ] ] and so @xmath1471 \\leq   \\frac{\\overline \\sigma^2}{n^2 s_{jk(j)}^2 e_j}\\ ] ] by assumption [ a - residuals](i ) .",
    "it follows from ( [ e - max1 ] ) , ( [ e - var0 ] ) and ( [ e - var ] ) , that @xmath1472 & \\leq & \\frac{\\overline \\sigma^2}{n \\log n}\\end{aligned}\\ ] ] uniformly for @xmath1473 and @xmath1128 .",
    "using the union bound and bernstein s inequality , we can deduce the bound @xmath1474 for any @xmath1475 .",
    "we show below that @xmath1476 , in which case for any @xmath339 there exists @xmath1477 sufficiently large that @xmath1478 holds uniformly for @xmath343 for all @xmath1479 , whence : @xmath1480 and so , substituting @xmath1481 and recalling the definition of @xmath339 in assumption [ a - sieve](iv ) , we have : @xmath1482 so there exists @xmath1455 such that @xmath1483 for all @xmath1484 , and hence @xmath1485 for all @xmath1484 .",
    "control of @xmath1486 : it follows from ( [ e - max1 ] ) that @xmath1487 therefore , by assumption [ a - residuals](ii ) and markov s inequality , for any @xmath1488 we obtain @xmath1489\\ ] ] which is @xmath863 provided @xmath1490 .",
    "choosing @xmath1491 trivially satisfies this condition on @xmath834 ; @xmath1492 also holds because @xmath340 by assumption [ a - sieve](v ) .",
    "control of @xmath1493 : first note that @xmath1494 where the second line is by lemmas [ lem - bul2unif ] and [ lem - gsconvunif ] , the third line is because @xmath1105 for all @xmath1106 , and the final line is by assumption [ a - sieve](iv ) .",
    "therefore , @xmath1495 for any @xmath1488 .",
    "control of @xmath1463 : for each @xmath343 we have @xmath1498   \\|e[g_{b , k(j)}^{-1/2}b^{k(j)}(w_i)b^{k(j)}(w_i)'g_{b , k(j)}^{-1/2}u_{1,i}^2/n^2]\\|_{\\ell^2 } & \\leq & \\bar \\sigma^2/n^2 \\\\[6pt ]   e[b^{k(j)}(w_i)'g_{b , k(j)}^{-1}b^{k(j)}(w_i)u_{1,i}^2/n^2 ] & \\leq & \\bar \\sigma^2 \\overline k / n^2\\,.\\end{aligned}\\ ] ] applying a bernstein inequality for random matrices ( * ? ? ?",
    "* theorem 1.6 ) and the union bound yields @xmath1499 then @xmath1463 vanishes with @xmath1500 where @xmath864 is a sufficiently large finite positive constant ( because @xmath1501 ) , provided @xmath1502 .",
    "therefore , both @xmath1463 and @xmath1486 are @xmath863 when @xmath1504 ( for large enough @xmath864 ) provided both @xmath1505 the first holds by choosing @xmath1506 ; the second then holds by assumption [ a - sieve](v ) .",
    "we first prove part ( a ) .",
    "let @xmath1508 denote the event upon which @xmath1509 and @xmath1510 holds for all @xmath1128 .",
    "then on @xmath1508 we have : @xmath1511 for all @xmath1128 by lemmas [ lem - inv ] and [ lem - sqrtm ] , and therefore @xmath1512 where the first inequality by the triangle inequality , the second inequality uses @xmath1513 ( lemma [ lem - mpnorm ] ) and the fact that @xmath1514 on @xmath1508 ( because @xmath1515 for all @xmath1128 ) , the third inequality is by lemma [ lem - sqrtm ] and lemma [ lem - linv ] , and the final inequality again uses lemma [ lem - sqrtm ] and the fact that @xmath1516 .      by the union bound and lemma [ lem - matl2 ]",
    ", we have : @xmath1522 } \\right\\}\\end{aligned}\\ ] ] for finite positive constants @xmath861 and @xmath862 .",
    "therefore @xmath1485 for sufficiently large @xmath864 by assumption [ a - sieve](iv ) .",
    "a similar argument shows that @xmath1523 .",
    "we argue as in the proof of lemma [ lem - bias ] .",
    "recall that @xmath1527 for some @xmath1528 . since the estimators are invariant to a rotation of the sieve space by @xmath1446 and @xmath1445",
    ", we have : @xmath1529 ) \\}\\|_{\\ell^2}}{\\|h_0 - \\pi_j h_0\\|_\\infty } \\\\   & & \\quad \\phantom{\\leq } \\quad + \\max_{j_2 \\leq j \\leq \\bar j_{\\max } } \\frac{\\zeta_{b , k(j)}\\|\\{(\\widehat g_{b , k(j)}^{o-1/2 } \\widehat s_{jk(j)}^o)^-_l ( \\widehat g_{b , k(j)}^o)^{-1/2 } - ( s_{jk(j)}^o)^-_l   \\}g_{b , k(j)}^{-1/2 } b'_{k(j)}(h_0 - \\psi_j c_j)/n\\|_{\\ell^2}}{\\|h_0 - \\pi_j h_0\\|_\\infty } \\\\   & & \\quad = : \\quad t_1 + t_2 + t_3\\end{aligned}\\ ] ] where , abusing notation , we denote @xmath1530 and @xmath1531 .",
    "it is enough to show that there exists a finite positive constant @xmath1113 such that @xmath1532 wpa1 and that @xmath828 and @xmath1236 are both @xmath1533 .",
    "control of @xmath828 : equation ( [ e - xident ] ) implies @xmath1534 ) \\|_{\\ell^2}}{\\|h_0 - \\pi_j h_0\\|_\\infty}\\,.\\ ] ] further , by lemma [ lem - bhjunif ] we may choose a finite positive constant @xmath864 such that @xmath1535 ) \\| \\leq c \\sqrt{(k(j ) \\log n)/n } \\times \\|h_0 - \\pi_j h_0\\|_\\infty\\ ] ] holds uniformly for all @xmath1128 wpa1 . substituting ( [ e - fffs2 ] ) into ( [ e - fffs1 ] ) and using the relations @xmath1536 and @xmath1537",
    ", we have that : @xmath1538 and so @xmath1539 by assumption [ a - sieve](iv ) .",
    "control of @xmath1236 : by lemmas [ lem - gsconvunif ] and [ lem - bhjunif ] and the fact that @xmath796 for all @xmath1128 , we have : @xmath1540 where the @xmath1541 and @xmath1533 terms hold uniformly for @xmath1128 .",
    "it follows by assumptions [ a - sieve](iv ) and [ a - approx](ii ) that @xmath1542 .",
    "first observe that for each @xmath343 , we have : @xmath1547 ) = \\sum_{i=1}^n \\xi_{i , j}\\end{aligned}\\ ] ] where @xmath1548\\ } $ ] .",
    "the @xmath1549 are @xmath1550 iid random vectors which satisfy @xmath1551 = 0 $ ] and @xmath1552 \\right\\|_{\\ell^2 } & \\leq & n^{-1 } \\|h_0 - \\pi_j h_0\\|^2_\\infty \\\\   \\left\\| \\sum_{i=1}^n e[\\xi_{i , j}'\\xi^{\\phantom \\prime}_{i , j } ] \\right\\|_{\\ell^2 } & \\leq & \\frac{k(j)}{n } \\|h_0 - \\pi_j h_0\\|^2_\\infty\\end{aligned}\\ ] ] under assumption [ a - sieve](i ) . the follows from a bernstein inequality for random matrices ( * ? ? ?",
    "* theorem 1.6 ) and the union bound .",
    "control of @xmath1463 : recall that @xmath1557 for all @xmath1558 .",
    "the union bound and lemma [ lem - matl2 ] yield @xmath1559 } \\right\\}\\ ] ] for finite positive constants @xmath861 and @xmath862 , and so @xmath1485 by assumption [ a - sieve](iv ) .",
    "control of @xmath1486 : let @xmath1560 denote the event upon which @xmath1561 holds for all @xmath1128 and observe @xmath1562 by lemma [ lem - consteval ] .",
    "on @xmath1560 we have that @xmath1563 holds for each @xmath1128 .",
    "therefore , @xmath1564 holds for all @xmath1128 on @xmath1560 by lemma [ lem - sqrtm ] .",
    "let @xmath1565 denote the event upon which @xmath1566 holds for all @xmath1128 and observe that @xmath1567 .",
    "it follows that @xmath1568 holds for all @xmath1128 on @xmath1569 because @xmath1570 , @xmath1571 , and @xmath1085 .",
    "substituting ( [ e - ghatinvineq ] ) and ( [ e - ccc1 ] ) into the expression for @xmath1486 and using the fact that @xmath1572 , we have : @xmath1573 it follows by the union bound and lemma [ lem - matl2 ] that : @xmath1574 } \\right\\ }   + \\mathbb p(\\mathcal c_n^c ) + \\mathbb p(\\mathcal c_{n,1}^c)\\ ] ] for finite positive constants @xmath861 and @xmath862",
    ". it follows by assumption [ a - sieve](iv)(vi ) and the fact that @xmath1562 and @xmath1575 that @xmath1523 .",
    "we only prove the result for @xmath1369 ; the results for @xmath1578 follow by identical arguments . by weyl s inequality ( lemma [ lem - weyl ] ) and straightforward algebra , we have : @xmath1579 it follows by de morgan s , the union bound , and the inequality ( [ e - bbb ] ) that @xmath1580 the result follows by lemma [ lem - matl2 ] and assumption [ a - sieve](iv)(vi ) ."
  ],
  "abstract_text": [
    "<S> this paper makes several contributions to the literature on the important yet difficult problem of estimating functions nonparametrically using instrumental variables . </S>",
    "<S> first , we derive the minimax optimal sup - norm convergence rates for nonparametric instrumental variables ( npiv ) estimation of the structural function @xmath0 and its derivatives . </S>",
    "<S> second , we show that a computationally simple sieve npiv estimator can attain the optimal sup - norm rates for @xmath0 and its derivatives when @xmath0 is approximated via a spline or wavelet sieve </S>",
    "<S> . our optimal sup - norm rates surprisingly coincide with the optimal @xmath1-norm rates for severely ill - posed problems , and are only up to a @xmath2^{\\epsilon}$ ] ( with @xmath3 ) factor slower than the optimal @xmath1-norm rates for mildly ill - posed problems . </S>",
    "<S> third , we introduce a novel data - driven procedure for choosing the sieve dimension optimally . </S>",
    "<S> our data - driven procedure is sup - norm rate - adaptive : the resulting estimator of @xmath0 and its derivatives converge at their optimal sup - norm rates even though the smoothness of @xmath0 and the degree of ill - posedness of the npiv model are unknown . </S>",
    "<S> finally , we present two non - trivial applications of the sup - norm rates to inference on nonlinear functionals of @xmath0 under low - level conditions . </S>",
    "<S> the first is to derive the asymptotic normality of sieve @xmath4-statistics for exact consumer surplus and deadweight loss functionals in nonparametric demand estimation when prices , and possibly incomes , are endogenous . </S>",
    "<S> the second is to establish the validity of a sieve score bootstrap for constructing asymptotically exact uniform confidence bands for collections of nonlinear functionals of @xmath0 . </S>",
    "<S> both applications provide new and useful tools for empirical research on nonparametric models with endogeneity </S>",
    "<S> .    4 pt _ keywords _ : ill - posed inverse problems ; series 2sls ; optimal sup - norm convergence rates ; adaptive estimation ; random matrices ; bootstrap uniform confidence bands ; nonlinear welfare functionals ; nonparametric demand analysis with endogeneity . </S>"
  ]
}