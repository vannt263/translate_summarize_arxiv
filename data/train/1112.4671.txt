{
  "article_text": [
    "the _ hadamard maximal determinant _ ( maxdet ) problem is to find the maximum determinant @xmath10 of a square @xmath0-matrix of given order  @xmath1 .",
    "such a matrix @xmath11 with maximal @xmath12 is called a _ saturated d - optimal design _ of order  @xmath1 .",
    "we are only concerned with the absolute value of the determinant , as the sign may be changed by a row or column interchange .",
    "hadamard  @xcite showed that @xmath13 , and this bound is attainable for @xmath14 only if @xmath15 .",
    "the _ `` hadamard conjecture '' _ ( due to paley  @xcite ) is that hadamard s bound is attainable for all @xmath15 . in this paper",
    "we are concerned with `` non - hadamard '' cases @xmath14 , @xmath3 . for such orders",
    "the hadamard bound is not attainable , but other upper bounds due to barba  @xcite , ehlich  @xcite and wojtas  @xcite may be attainable . for lower bounds on @xmath10 , see brent and osborn  @xcite , and the references given there .",
    "we say that two @xmath0 matrices @xmath11 and @xmath16 are _ hadamard - equivalent _ ( abbreviated h - equivalent ) if @xmath16 can be obtained from @xmath11 by a signed permutation of rows and/or columns . if @xmath11 is h - equivalent to @xmath16 or to @xmath17 then we say that @xmath11 and @xmath16 are _ extended hadamard - equivalent _ ( abbreviated ht - equivalent ) .",
    "note that , if @xmath11 is ht - equivalent to @xmath16 , then @xmath18 .",
    "if @xmath11 is h - equivalent to @xmath19 then we say that @xmath11 is _ self - dual_. we say that a hadamard equivalence class is self - dual if the class contains a self - dual matrix ( equivalently , if the duals of all matrices in the class are also in the class ) .",
    "if we know ( or conjecture ) @xmath10 , it is of interest to find all ( or most ) hadamard equivalence classes of @xmath0 matrices with determinant @xmath20 .",
    "in this paper we consider the orders @xmath7 , @xmath8 and @xmath9 ; similar methods can be used for certain other orders .    in  [",
    "sec : decomp ] we consider the randomised decomposition of ( candidate ) gram matrices .",
    "then , in  [ sec : switching ] , we show how one solution can often be used to generate other , generally not hadamard equivalent , solutions via switching .",
    "the graph of hadamard equivalence classes induced by switching is defined in  [ sec : switching ] .",
    "we conclude with some new results for the orders @xmath7 , @xmath8 and @xmath9 in   [ sec : order26][sec : order33 ] .",
    "a bound which holds for all odd orders , and which is known to be sharp for an infinite sequence of orders @xmath21 , is @xmath22 due independently to barba  @xcite and ehlich  @xcite .",
    "we call it the _ barba _ bound .",
    "brouwer  @xcite showed that the barba bound ( [ eq : barbabound ] ) is sharp if @xmath23 for @xmath24 an odd prime power .",
    "the bound is also sharp in some other cases , e.g.  @xmath25 and @xmath26 .",
    "it is not achievable unless @xmath1 is the sum of two consecutive squares .",
    "an upper bound due to ehlich  @xcite applies only in the case @xmath27 .",
    "we refer to  @xcite for details of this bound , which is rather complicated .",
    "the ehlich bound is not known to be sharp for any order @xmath28 .",
    "another bound , @xmath29 due to ehlich  @xcite and wojtas  @xcite , applies in the case @xmath30 .",
    "it is known to be sharp in the following cases : ( a ) @xmath31 , where @xmath24 is an odd prime power ( see whiteman  @xcite ) ; and ( b ) @xmath32 , where @xmath24 is any ( even or odd ) prime power  @xcite .",
    "if @xmath4 is a given square matrix then the symmetric matrix @xmath5 is called the _ gram matrix _ of @xmath4 .",
    "we may also consider the _ dual gram matrix _ @xmath33 . since @xmath34 , the bounds mentioned above on @xmath35 are equivalent to bounds on @xmath36 . indeed",
    ", this observation explains the form of the bounds . for example , the barba bound corresponds to a matrix @xmath37 given by @xmath38 if @xmath39 and @xmath40 if @xmath41 .",
    "it is easy to show via a well - known rank-1 update formula that @xmath42 .    given a symmetric matrix @xmath6 with suitable determinant , we say @xmath6 is a _ candidate gram matrix_. it is the gram matrix of a @xmath0 matrix if and only if it decomposes into a product of the form @xmath5 , where @xmath4 is a square @xmath0 matrix .",
    "suppose that a ( candidate ) gram matrix @xmath6 of order @xmath1 is known .",
    "we want to find one or more @xmath0 matrices @xmath4 such that @xmath5 .",
    "let the rows of @xmath4 be @xmath43 . then @xmath44    if we already know the first @xmath45 rows , then we get @xmath45 _ single - gram _ constraints involving row @xmath46 : @xmath47 these are linear constraints in the unknowns @xmath48",
    ". we may be able to find one or more solutions for row @xmath46 satisfying the single - gram constraints , or there may be no solutions , in which case we have to backtrack .    our algorithm is described in  @xcite , so we omit the details here .",
    "we merely note that it is possible to take advantage of various symmetries to reduce the size of the search space , and that it is possible to prune the search using _ gram - pair _ constraints of the form @xmath49 ( @xmath50 ) if we know the dual gram matrix @xmath51 . in the cases considered below ,",
    "there is ( up to signed permutations ) only one candidate gram matrix with the required determinant , so there is no loss of generality in assuming that @xmath52 .    the search can be regarded as searching a ( large ) tree with ( at most ) @xmath1 levels , where each level corresponds to a row of @xmath4 .",
    "a deterministic search typically searches the tree in depth - first fashion   at each node , recursively search the subtrees defined by the children of that node .",
    "the aim is to find one or more leaves at the @xmath1-th level of the tree , since these leaves correspond to complete solutions  @xmath4 .",
    "deterministic , depth - first search may take a long time searching fruitlessly for solutions in subtrees where no solutions exist .",
    "when @xmath6 is decomposable , but difficult to decompose using a deterministic search , we may be able to do better with a randomised search .    in the randomised search , at each node we randomly choose a small number of children and recursively search the subtrees defined by these children .",
    "a good choice of the average number of children chosen per node , say @xmath53 , can be determined experimentally .",
    "too small a value makes it unlikely that a solution will be found ; too large a value makes the search take too long .",
    "we found empirically that @xmath54 works well in the cases considered below .",
    "thus , at each node traversed in the search we choose one child ( if there are any ) and , with probability about @xmath55 , also choose a second child ( if there is one ) , then recursively search the subtrees defined by the selected children .    for example",
    ", in the case @xmath56 , there is a known gram matrix @xmath6 , due to tamura  @xcite , which decomposes into @xmath57 , giving a @xmath0 matrix @xmath4 of determinant @xmath58 .",
    "this determinant is conjectured to be maximal .",
    "a deterministic search fails to decompose tamura s @xmath6 in @xmath59 hours ( exploring over @xmath60 nodes but reaching only depth @xmath61 in the search tree ) .",
    "the tree size is probably greater than @xmath62 .    on the other hand",
    ", our randomised search routinely finds a decomposition of @xmath6 in about @xmath63 seconds . in this way we have found many different h - classes of solutions .",
    "further details are given in ",
    "[ sec : order27 ] .",
    "unfortunately , the randomised search strategy described above does not guarantee that the set of h - classes of solutions ( or the set of all @xmath0 matrices of the given order and determinant ) is sampled uniformly .",
    "there are two reasons for lack of uniformity .",
    "first , the tree - generation algorithm introduces non - uniformity by taking advantage of symmetries to reduce the size of the tree .",
    "second , the number of matrices in a class is inversely proportional to the order of the automorphism group of the class , so even if all the @xmath0 matrices were sampled uniformly , the h - classes would not necessarily be sampled uniformly .",
    "_ switching _ is an operation on square @xmath0 matrices which preserves the absolute value of the determinant but does not generally preserve hadamard equivalence or extended hadamard equivalence .",
    "thus , switching can be used to generate many inequivalent maxdet solutions from one solution .",
    "this idea was introduced by denniston  @xcite and used to good effect by orrick  @xcite .",
    "similar ideas have been used by wanless  @xcite and others in the context of latin squares .",
    "we only consider switching a closed quadruple of rows / columns .",
    "there are other possibilities , e.g.  switching hall sets  @xcite .",
    "suppose that a @xmath0 matrix @xmath4 is h - equivalent to a matrix having a _ closed quadruple _ of rows , i.e.  four rows of the form '' for @xmath64 and `` @xmath65 '' for @xmath66 .",
    "] : @xmath67\\ ] ] then _ row switching _ flips the sign of the leftmost block , giving @xmath68\\ ] ]    this is h - equivalent to flipping the signs of all but the leftmost block , which has a nicer interpretation in terms of switching edges in the corresponding bipartite graph  @xcite .",
    "it is easy to see that row switching preserves the inner products of each pair of columns of r , so preserves the dual gram matrix @xmath69 , and hence preserves @xmath70 .",
    "however , it does not generally preserve h - equivalence or ht - equivalence .",
    "_ column switching _ is dual to row switching   instead of a closed quadruple of four rows , it requires a closed quadruple of four columns .",
    "let @xmath71 and @xmath72 be two h - equivalence classes of matrices .",
    "we say that @xmath71 and @xmath72 are _ switching - equivalent _ ( abbreviated `` s - equivalent '' ) if there exists @xmath73 and @xmath74 such that @xmath11 can be transformed to @xmath16 by a sequence of row and/or column switching operations . ] .",
    "the size of an s - equivalence class @xmath75 , denoted by @xmath76 , is the number of h - equivalence classes that it contains .",
    "if the h - equivalence classes corresponding to matrices @xmath11 and @xmath16 are in the same s - equivalence class , then we write @xmath77 .",
    "thus , this notation means that there is a sequence of row / column switches that transforms @xmath11 to a matrix h - equivalent to @xmath16 .",
    "we say that @xmath11 is _ s - equivalent _ to @xmath16 .",
    "if @xmath71 and @xmath72 are two ht - equivalence classes of matrices , then we say that @xmath71 and @xmath72 are _ st - equivalent _ if there exists @xmath73 and @xmath74 such that @xmath11 can be transformed to @xmath16 by a sequence of row and/or column switching operations and @xmath78 , we have _ either _ @xmath79 or @xmath80 . ] .",
    "the size of an st - equivalence class @xmath75 , denoted by @xmath81 , is the number of ht - equivalence classes that it contains .",
    "we say that two _ matrices _ @xmath11 and @xmath16 are st - equivalent if the corresponding ht - classes @xmath82 and @xmath83 are st - equivalent .",
    "thus , two matrices @xmath11 and @xmath16 are st - equivalent if a matrix h - equivalent to @xmath16 can be obtained from @xmath11 by a sequence of row switches , column switches and/or transpositions .",
    "the _ weight _ @xmath84 of a matrix @xmath85 ( or of the hadamard class @xmath86 ) is defined by @xmath87 where @xmath88 is the automorphism group of @xmath85 .",
    "the _ weight _",
    "@xmath89 of an s - class @xmath75 is defined by @xmath90 the probability of finding a class by uniform random sampling of @xmath0 matrices is proportional to the weight of the class , so the classes with smallest weight are in some sense the hardest to find .",
    "( however , as observed at the end of  [ sec : decomp ] , we do not sample uniformly . )    associated with an s - equivalence class @xmath91 of size @xmath92 there is a graph @xmath93 whose vertices are the h - classes @xmath94 contained in @xmath95 , and where an edge connects two distinct vertices @xmath96 if a matrix in @xmath97 can be transformed to a matrix in @xmath98 by a single row / column switching operation .",
    "similarly , for an st - equivalence class @xmath99 of size  @xmath92 there is a graph @xmath100 whose vertices are the ht - classes @xmath94 contained in @xmath101 , and where an edge connects two distinct vertices @xmath96 if a matrix in @xmath97 can be transformed to a matrix in @xmath98 by a single row / column switching operation , possibly combined with transposition .",
    "for example , it is known  @xcite that there are @xmath102 h - classes of hadamard matrices of order @xmath59 .",
    "these form two s - classes , of size @xmath103 and @xmath104 . similarly , there are @xmath105 ht - classes , giving two st - classes , of size @xmath103 and @xmath106 . in each case the class of size @xmath103 contains the paley matrix , which has no closed quadruples .",
    "for order @xmath7 the maximal determinant is @xmath107 meeting the ehlich - wojtas bound  ( [ eq : ewbound ] ) , and the corresponding gram matrix @xmath6 is unique up to symmetric signed permutations . without loss of generality",
    "we can assume that @xmath6 has a diagonal block form with blocks of size @xmath108 ( see  @xcite ) .",
    "there are exactly three h - inequivalent maxdet matrices composed of circulant blocks  @xcite . however , there are many solutions that are not composed of circulant blocks .",
    "orrick  ( * ? ? ?",
    "7 ) found @xmath109 ht - classes ( @xmath110 h - classes ) of solutions by a combination of hill - climbing ( local optimisation ) and switching .    using randomised decomposition of the gram matrix @xmath6 followed by switching , we have found @xmath111 further h - classes ( @xmath112 ht - classes ) .",
    "thus , there are at least @xmath113 h - classes ( @xmath114 ht - classes ) of saturated d - optimal designs of order @xmath7 .",
    "since the randomised decomposition program has repeatedly found the same set of @xmath113 h - classes without finding any more , it is reasonable to conjecture that this is all .",
    "an exhaustive search to prove this may be feasible , but has not yet been attempted .",
    "it is known  @xcite that there are two _ types _ of maxdet matrices of order @xmath115 , related to the two ways that the row sums @xmath116 of the gram matrix can be written as a sum of squares : @xmath117 they are called `` type @xmath118 '' and `` type @xmath119 '' respectively .",
    "the type is preserved by switching .",
    "if a maxdet matrix @xmath4 of order @xmath7 is normalised so that @xmath120 , then @xmath121 determines the type of @xmath4 : maxdet matrices of type @xmath118 have @xmath122 , and those of type @xmath119 have @xmath123 .",
    "there are @xmath114 ht - classes ( @xmath113 h - classes ) which lie in @xmath124 st - classes ( @xmath125 s - classes ) .",
    "there is one `` giant '' st - class @xmath126 with size @xmath127 , consisting of type @xmath119 matrices .",
    "in addition to the giant class @xmath126 of size about @xmath130 , we found @xmath131 st - classes of size @xmath132 , as listed in table  5 , with the largest having size @xmath133 .",
    "classes of the same size marked `` ( a ) '' and `` ( b ) '' are different , so there are ( at least ) two disjoint classes of size @xmath134 .    * 3 . *",
    "table 5 gives the number of times @xmath135 that we found the same class of size  @xmath136 .",
    "this statistic is mentioned because it indicates how well we have sampled the search space . excluding the giant class @xmath137 , the @xmath131 largest known classes , of total size @xmath138 , were found @xmath139 times .",
    "consider the union @xmath140 of these classes as a sample from the space , and _ assume _ that the space is sampled uniformly . excluding the @xmath131 `` hits '' used to select @xmath140",
    ", there are @xmath141 additional `` hits '' on @xmath140 .",
    "thus , the fraction @xmath142 of the space sampled is @xmath143 . under our assumption ,",
    "the probability @xmath144 of missing a given class of size @xmath145 is bounded by @xmath146 on the other hand , random sampling hit the giant class @xmath147 times , and the estimated size of this class is @xmath130 , implying that @xmath148 , so the estimate  ( [ eq : pest ] ) on @xmath144 should be viewed with caution .",
    "the discrepancy between the two estimates of @xmath142 may be caused by nonuniformity of sampling and/or by an inaccurate estimate of the size of the giant class .",
    "* it would be interesting to know more about the graphs associated with `` small '' st classes .",
    "we have observed one graph of size  3 ( `` @xmath149 '' ) , two of size  4 ( `` @xmath150 '' and `` @xmath151 '' ) , and only one of size  5 ( `` kite '' ) . figure  3 shows an example of each size in the range @xmath152 .",
    "the reader may have noticed that the graphs displayed in figures 13 are bipartite ( @xmath153-colourable ) , although _ neato _ did not draw them in a way that makes this obvious .",
    "computational experiments have shown that most , but not all , of the st classes considered above have bipartite graphs .",
    "in particular , the graph of the giant component for order @xmath9 is not bipartite .",
    "the author thanks judy - anne osborn for introducing him to the topic and for many stimulating discussions ; will orrick and paul zimmermann for their ongoing collaboration ; brendan mckay for his graph isomorphism program _ nauty _",
    "@xcite , which was used to check hadamard equivalence ; at&t for the _ graphviz _ graph visualization software , in particular _ neato _ , which was used to draw the figures ; and the mathematical sciences institute ( anu ) for computer time on the cluster `` orac '' .",
    "r. p. brent , w. p. orrick , j. h. osborn and p. zimmermann , maximal determinants and saturated d - optimal designs of orders @xmath154 and @xmath155 , submitted .",
    "available from http://arxiv.org/abs/1112.4160 ."
  ],
  "abstract_text": [
    "<S> a square @xmath0-matrix of order @xmath1 with maximal determinant is called a _ saturated d - optimal design_. we consider some cases of saturated d - optimal designs where @xmath2 , @xmath3 , so the hadamard bound is not attainable , but bounds due to barba or ehlich and wojtas may be attainable . if @xmath4 is a matrix with maximal ( or conjectured maximal ) determinant , then @xmath5 is the corresponding _ </S>",
    "<S> gram matrix_. for the cases that we consider , maximal or conjectured maximal gram matrices are known . </S>",
    "<S> we show how to generate many hadamard equivalence classes of solutions from a given gram matrix @xmath6 , using a randomised decomposition algorithm and row / column switching . in particular , we consider orders @xmath7 , @xmath8 and  @xmath9 , and obtain new saturated d - optimal designs ( for order @xmath7 ) and new conjectured saturated d - optimal designs ( for orders @xmath8 and  @xmath9 ) . </S>"
  ]
}