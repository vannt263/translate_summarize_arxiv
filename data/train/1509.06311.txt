{
  "article_text": [
    "nonparametric constraints , often called shape restrictions , have played a central role in economics as both testable implications of classical theory and sufficient conditions for obtaining informative counterfactual predictions @xcite .",
    "a long tradition in applied and theoretical econometrics has as a result studied shape restrictions , their ability to aid in identification , estimation , and inference , and the possibility of testing for their validity @xcite .",
    "the canonical example of this interplay between theory and practice is undoubtedly consumer demand analysis , where theoretical predictions such as slutsky symmetry have been extensively tested for and exploited in estimation @xcite .",
    "the empirical analysis of shape restrictions , however , goes well beyond this important application with recent examples including studies into the monotonicity of the state price density @xcite , the presence of ramp - up and start - up costs @xcite , and the existence of complementarities in demand @xcite and organizational design @xcite .    despite the importance of nonparametric constraints ,",
    "their theoretical study has focused on a limited set of models and restrictions  a limitation that has resulted in practitioners often facing parametric modeling as their sole option . in this paper",
    ", we address this gap in the literature by developing a framework for testing general shape restrictions and exploiting them for inference in a widespread class of conditional moment restriction models . specifically , we study nonparametric constraints in settings where the parameter of interest @xmath0 satisfies @xmath1 conditional moment restrictions @xmath2 = 0 \\text { for } 1\\leq \\jmath \\leq\\mathcal j\\ ] ] with @xmath3 possibly non - smooth functions , @xmath4 , @xmath5 , and @xmath6 denoting the distribution of @xmath7 .",
    "as shown by @xcite , under appropriate choices of the parameter space and moment restrictions , this model encompasses parametric @xcite , semiparametric @xcite , and nonparametric @xcite specifications , as well as panel data applications @xcite and the study of plug - in functionals . by incorporating nuisance parameters into the definition of the parameter space , it is in fact also possible to view conditional moment ( in)equality models as a special case of the specification we study .",
    "for example , the restriction @xmath8 \\leq 0 $ ] may be rewritten as @xmath9 = 0 $ ] for some unknown positive function @xmath10 , which fits with @xmath11 and @xmath10 subject to the constraint @xmath12 ; see example [ ex : condineq ] below .",
    "while in multiple applications identification of @xmath0 is straightforward to establish , there also exist specifications of the model we examine for which identification can be uncertain @xcite . in order for our framework to be robust to a possible lack of identification , we therefore define the identified set @xmath13 = 0 \\text { for } 1\\leq \\jmath \\leq \\mathcal j \\}\\ ] ] and employ it as the basis of our statistical analysis . formally , for a set @xmath14 of parameters satisfying a conjectured restriction , we develop a test for the hypothesis @xmath15 i.e. we device a test of whether at least one element of the identified set satisfies the posited constraints . in an identified model ,",
    "a test of is thus equivalent to a test of whether @xmath16 satisfies the hypothesized constraint .",
    "the set @xmath14 , for example , may constitute the set of functions satisfying a conjectured shape restriction , in which case a test of corresponds to a test of the validity of such shape restriction .",
    "alternatively , the set @xmath14 may consist of the functions that satisfy an assumed shape restriction and for which a functional of interest takes a prescribed value  in which case test of inversion of yields a confidence region for the value of the desired functional that imposes the assumed shape restriction on the underlying parameter .",
    "the wide class of hypotheses with which we are concerned necessitates the sets @xmath14 to be sufficiently general , yet be endowed with enough structure to ensure a fruitful asymptotic analysis .",
    "an important insight of this paper is that this simultaneous flexibility and structure is possessed by sets defined by",
    " equality \" restrictions on banach space valued maps , and  inequality \" restrictions on abstract m ( am ) space valued maps ( an am space is a banach lattice whose norm obeys a particular condition ) .",
    "we illustrate the generality granted by these sets by showing they enable us to employ tests of to : ( i ) conduct inference on the level of a demand function while imposing a slutsky constraint ; ( ii ) construct a confidence interval in a regression discontinuity design where the conditional mean is known to be monotone in a neighborhood of , but not necessarily at , the discontinuity point ; ( iii ) test for the presence of complementarities in demand ; and ( iv ) conduct inference in semiparametric conditional moment ( in)equality models .",
    "additionally , while we do not pursue further examples in detail for conciseness , we note such sets @xmath14 also allow for tests of homogeneity , supermodularity , and economies of scale or scope , as well as for inference on functionals of the identified set .    as our test statistic",
    ", we employ the minimum of a suitable criterion function over parameters satisfying the hypothesized restriction ",
    "an approach sometimes referred to as a sieve generalized method of moments @xmath17-test .",
    "under appropriate conditions , we show that the distribution of the proposed statistic can be approximated by the law of the projection of a gaussian process onto the image of the local parameter space under a linear map . in settings where the local parameter space is asymptotically linear and the model",
    "is identified , the derived approximation can reduce to a standard chi - squared distribution as in @xcite .",
    "however , in the presence of  binding \" shape restrictions the local parameter space is often not asymptotically linear resulting in non - pivotal and potentially unreliable pointwise ( in @xmath6 ) asymptotic approximations @xcite .",
    "we address these challenges by projecting a bootstrapped version of the relevant gaussian process into the image of an appropriate sample analogue of the local parameter space under an estimated linear map .",
    "specifically , we establish that the resulting critical values provide asymptotic size control uniformly over a class of underlying distributions @xmath6 .",
    "in addition , we characterize a set of alternatives for which the proposed test possesses nontrivial local power .",
    "while aspects of our analysis are specific to the conditional moment restriction model , the role of the local parameter space is solely dictated by the set @xmath14 . as such , we expect the insights of our arguments to be applicable to the study of shape restrictions in alternative models as well .",
    "the literature on nonparametric shape restrictions in econometrics has classically focused on testing whether conditional mean regressions satisfy the restrictions implied by consumer demand theory ; see @xcite , @xcite , and references therein .",
    "the related problem of studying monotone conditional mean regressions has also garnered widespread attention  recent advances on this problem includes @xcite and @xcite . @xcite",
    "propose generic methods , based on rearrangement and/or projection operators , that convert function estimators and confidence bands into monotone estimators and confidence bands , provably delivering finite - sample improvements ; see @xcite for an application in the context of structural heterogeneity models .",
    "additional work concerning monotonicity constraints includes @xcite who test the monotonicity of the pricing kernel , @xcite who study estimation of a nonparametric instrumental variable regression under monotonicity constraints , and @xcite who develops minimax rate optimal one sided tests in a gaussian regression discontinuity design .",
    "in related work , @xcite examine the role of monotonicity and concavity or convexity constraints in a nonparametric instrumental variable regression with discrete instruments and endogenous variables .",
    "our paper also contributes to a literature studying semiparametric and nonparametric models under partial identification @xcite .",
    "examples of such work include @xcite , @xcite , @xcite , @xcite , and @xcite for conditional moment restriction models , and @xcite for the maximum likelihood setting .",
    "the remainder of the paper is organized as follows . in section [ sec : thehyp ] we formally define the sets of restrictions we study and discuss examples that fall within their scope . in turn , in section [ sec : basicset ] we introduce our test statistic and basic notation that we employ throughout the paper .",
    "section [ sec : consrates ] obtains a rate of convergence for set estimators in conditional moment restriction models that we require for our subsequent analysis .",
    "our main results are contained in sections [ sec : strongapprox ] and [ sec : boot ] , which respectively characterize and estimate the asymptotic distribution of our test statistic .",
    "finally , section [ sec : sim ] presents a brief simulation study , while section [ sec : conc ] concludes .",
    "all mathematical derivations are included in a series of appendices ; see in particular appendix for an overview of am spaces and an outline of how appendices through are organized .",
    "in this section , we formally introduce the set of null hypotheses we examine as well as motivating examples that fall within their scope .",
    "the defining elements determining the generality of the hypotheses allowed for in are the choice of parameter space @xmath18 and the set of restrictions embodied by @xmath14 . in imposing restrictions on both @xmath18 and @xmath14",
    "we aim to allow for as general a framework as possible while simultaneously ensuring enough structure for a fruitful asymptotic analysis . to this end",
    ", we require the parameter space @xmath18 to be a subset of a banach space @xmath19 , and consider sets @xmath14 that are defined through  equality \" and  inequality \" restrictions . specifically , for known maps @xmath20 and",
    "@xmath21 , we impose that the set @xmath14 be of the form @xmath22    in order to allow for hypotheses that potentially concern global properties of @xmath23 , such as shape restrictions , the maps @xmath24 and @xmath25 are also assumed to take values on general banach spaces @xmath26 and @xmath27 respectively . while no further structure on @xmath26 is needed for testing",
    " equality \" restrictions , the analysis of  inequality \" restrictions necessitates that @xmath27 be equipped with a partial ordering ",
    "i.e. that  @xmath28 \" be well defined in .",
    "we thus impose the following requirements on @xmath18 , and the maps @xmath20 and @xmath21 :    [ ass : param ] ( i ) @xmath29 , where @xmath19 is a banach space with metric @xmath30 .",
    "[ ass : r ] ( i ) @xmath24 and @xmath25 , where @xmath26 is a banach space with metric @xmath31 , and @xmath27 is an am space with order unit @xmath32 and metric @xmath33 ; ( ii ) the maps @xmath24 and @xmath25 are continuous under @xmath30 .",
    "assumption [ ass : param ] formalizes the requirement that the parameter space @xmath18 be a subset of a banach space @xmath19 . in turn , assumption [ ass : r](i ) similarly imposes that @xmath20 take values in a banach space @xmath26 , while the map @xmath21 is required to take values in an am space @xmath27  since am spaces are not often used in econometrics , we provide an overview in .",
    "heuristically , the essential implications of assumption [ ass : r](i ) for @xmath27 are that : ( i ) @xmath27 is a vector space equipped with a partial order relationship  @xmath28 \" ; ( ii ) the partial order  @xmath28 \" and the vector space operations interact in the same manner they do on @xmath34 ; , then @xmath35 for any @xmath36 . ] and ( iii ) the order unit @xmath37 is an element such that for any @xmath38 there exists a scalar @xmath39 satisfying @xmath40 ; see remark [ rm : cintro ] for an example .",
    "finally , we note that in assumption [ ass : r](ii ) the maps @xmath20 and @xmath21 are required to be continuous , which ensures that the set @xmath14 is closed in @xmath19 . since the choice of maps @xmath20 and @xmath21 is dictated by the hypothesis of interest , verifying assumption [ ass : r](ii ) is often accomplished by restricting @xmath19 to have a sufficiently  strong \" norm that ensures continuity .",
    "[ rm : cintro ] in applications we will often work with the space of continuous functions with bounded derivatives . formally , for a set @xmath41 , a function @xmath42 , a vector of positive integers @xmath43 , and @xmath44 we denote @xmath45 for a nonnegative integer @xmath46 , we may then define the space @xmath47 to be given by @xmath48 which we endow with the metric @xmath49 .",
    "the space @xmath50 with norm @xmath51  which we denote @xmath52 and @xmath53 for simplicity  is then an am space . in particular , equipping @xmath52 with the ordering @xmath54 if and only if @xmath55 for all @xmath56 implies the constant function @xmath57 for all @xmath56 is an order unit .      in order to illustrate the relevance of the introduced framework",
    ", we next discuss a number of applications based on well known models .",
    "for conciseness , we keep the discussion brief and revisit these examples in more detail in .",
    "we draw our first example from a long - standing literature aiming to replace parametric assumptions with shape restrictions implied by economic theory @xcite .",
    "[ ex : slutzky ] * ( shape restricted demand ) .",
    "* @xcite examine a semiparametric model for gasoline demand , in which quantity demanded @xmath58 given price @xmath59 , income @xmath60 , and demographic characteristics @xmath61 is assumed to satisfy @xmath62 the authors propose a kernel estimator for the function @xmath63 under the assumption @xmath64 = 0 $ ] and the hypothesis that @xmath65 obeys the slutsky restriction @xmath66 while in their application @xcite find imposing to be empirically important , their asymptotic framework assumes holds strictly and thus implies the constrained an unconstrained estimators are asymptotically equivalent .",
    "in contrast , our results will enable us to test , for example , for @xmath67 and @xmath68 the hypothesis @xmath69 employing an asymptotic analysis that is able to capture the finite sample importance of imposing the slutsky restriction . to map this problem into our framework",
    ", we set @xmath70 , @xmath71 , @xmath72 , @xmath73 and @xmath74 for any @xmath75 .",
    "letting @xmath76 and defining @xmath77 by @xmath78 for any @xmath79 enables us to test , while the slutsky restriction can be imposed by setting @xmath80 and defining @xmath81 to be given by @xmath82 for any @xmath83 .",
    "alternatively , we may also conduct inference on deadweight loss as considered in @xcite building on @xcite , or allow for endogeneity and quantile restrictions on @xmath84 as pursued by @xcite .",
    "our next example builds on example [ ex : slutzky ] by illustrating how to exploit shape restrictions in a regression discontinuity ( rd ) setting ; see also @xcite .",
    "[ ex : rd ] * ( monotonic rd ) .",
    "* we consider a sharp design in which treatment is assigned whenever a forcing variable @xmath85 is above a threshold which we normalize to zero .",
    "for an outcome variable @xmath60 and a treatment indicator @xmath86 , @xcite showed the average treatment effect @xmath87 at zero is identified by @xmath88 - \\lim_{r\\uparrow 0 } e[y_i | r_i = r ] ~.\\ ] ] in a number of applications it is additionally reasonable to assume @xmath89 $ ] is monotonic in a neighborhood of , but not necessarily at , zero .",
    "such restriction is natural , for instance , in @xcite where @xmath90 is the democratic vote share and @xmath60 is a measure of how liberal the elected official s voting record is , or in @xcite where @xmath90 and @xmath60 are respectively measures of predicted and actual collected unemployment benefits . in order to illustrate the applicability of our framework to this setting ,",
    "we suppose we wish to impose monotonicity of @xmath91 $ ] on @xmath92 and @xmath93 $ ] while testing @xmath94 to this end , we let @xmath95 ) \\times c^1([0,1])$ ] , @xmath96 , @xmath97 , and for @xmath98 set @xmath99 which yields the restriction @xmath100 = 0\\ ] ] for any @xmath101 . the functions @xmath102 and @xmath103 are then respectively identified by @xmath89 $ ] for @xmath104 and @xmath93 $ ] , and hence we may test by setting @xmath76 and @xmath105 for any @xmath106.)$ ] with the function @xmath89 $ ] on @xmath107 by letting @xmath108 $ ] which exists by assumption . ] in turn , monotonicity can be imposed by setting @xmath109)\\times c([0,1])$ ] and letting @xmath110 for any @xmath101 . a similar construction can also be applied in fuzzy rd designs or the regression kink design studied in @xcite and @xcite .    while examples [ ex : slutzky ] and [ ex : rd ] concern imposing shape restriction to conduct inference on functionals , in certain applications interest instead lies on the shape restriction itself .",
    "the following example is based on a model originally employed by @xcite in examining whether print and online newspapers are substitutes or complements .",
    "[ ex : comp ] * ( complementarities ) .",
    "* suppose an agent can buy at most one each of two goods @xmath111 , and let @xmath112 denote the possible bundles to be purchased .",
    "we consider a random utility model @xmath113 where @xmath114 are observed covariates , @xmath115 can be a subvector of @xmath61 , @xmath116 is an unknown function , and @xmath117 follows a parametric distribution @xmath118 with @xmath119 ; see @xcite for identification results . in , @xmath116 determines whether the goods are complements or substitutes and we may consider , for example , a test of the hypothesis that they are always substitutes @xmath120 in this instance , @xmath121 , and for any @xmath122 we map into our framework by letting @xmath123 , @xmath124 , and imposing no equality restrictions . for observed choices @xmath125 the conditional moment restrictions",
    "are then @xmath126 and , exploiting @xmath127 under the null hypothesis , the two additional conditions @xmath128 so that in this model @xmath129 . an analogous approach may also be employed to conduct inference on interaction effects in discrete games as in @xcite .    the introduced framework can also be employed to study semiparametric specifications in conditional moment ( in)equality models  thus complementing a literature that , with the notable exception of @xcite , has been largely parametric @xcite .",
    "our final example illustrates such an application in the context of a study of hospital referrals by @xcite .",
    "[ ex : condineq ] * ( testing parameter components in moment ( in)equalities ) .",
    "* we consider the problem of estimating how an insurer assigns patients to hospital within its network @xmath130 .",
    "suppose each observation @xmath131 consists of two individuals @xmath111 of similar characteristics for whom we know the hospital @xmath132 to which they were referred , as well as the cost of treatment @xmath133 and the distance @xmath134 to any hospital @xmath135 .",
    "under certain assumptions , @xcite then derive the moment restriction @xmath136 \\leq 0\\ ] ] where @xmath137 denotes the insurer s sensitivity to price , @xmath138 is an unknown monotonically increasing function reflecting a preference for referring patients to nearby hospitals , @xmath139 is an appropriate instrument , and @xmath140 . when @xmath141 , and @xmath142 when @xmath143 . ]",
    "employing our proposed framework we may , for example , test for some @xmath144 the null hypothesis @xmath145 without imposing parametric restrictions on @xmath65 but instead requiring it to be monotone . to this end , let @xmath146 , and define the function @xmath147 for any @xmath148 .",
    "the moment restriction in can then be rewritten as @xmath149 = 0\\ ] ] for some unknown function @xmath150 satisfying @xmath151 .",
    "thus , may be viewed as a conditional moment restriction model with parameter space @xmath152 in which @xmath153 for any @xmath154 .",
    "the monotonicity restriction on @xmath155 and positivity requirement on @xmath10 can in turn be imposed by setting @xmath156 and @xmath157 , while the null hypothesis in may be tested by letting @xmath76 and defining @xmath158 for any @xmath154 .",
    "an analogous construction can similarly be applied to extend conditional moment inequality models with parametric specifications to semiparametric or nonparametric ones ; see @xcite , @xcite and references therein .",
    "having formally stated the hypotheses we consider , we next develop a test statistic and introduce basic notation and assumptions that will be employed throughout the paper .",
    "we test the null hypothesis in by employing a sieve - gmm statistic that may be viewed as a generalization of the overidentification test of @xcite and @xcite .",
    "specifically , for the instrument @xmath159 of the @xmath160 moment restriction , we consider a set of transformations @xmath161 and let @xmath162 . setting @xmath163 to equal the vector of all instruments , @xmath164 the total number of transformations , @xmath165 the vector of all transformations , and @xmath166 the vector of all generalized residuals , we then construct for each @xmath167 the @xmath168 vector of scaled sample moments @xmath169 where for partitioned vectors @xmath170 and @xmath171 , @xmath172 denotes their khatri - rao product and @xmath173 , @xmath174 . ]  i.e. the vector in consists of the scaled sample averages of the product of each generalized residual @xmath175 with the transformations of its respective instrument @xmath159 . clearly ,",
    "if is evaluated at a parameter @xmath23 in the identified set @xmath176 , then its mean will be zero .",
    "as noted by @xcite , however , for any fixed dimension @xmath177 the expectation of may still be zero even if @xmath178 .",
    "for this reason , we conduct an asymptotic analysis in which @xmath177 diverges to infinity , and note the choice of transformations @xmath161 is allowed to depend on @xmath179 to accommodate the use of splines or wavelets .    intuitively , we test by examining whether there is a parameter @xmath167 satisfying the hypothesized restrictions and such that has mean zero . to this end , for any @xmath180 , vector @xmath181 , and @xmath182 positive definite matrix @xmath183 we define @xmath184 with the usual modification @xmath185 . for any possibly random @xmath186 positive definite matrix @xmath187",
    ", we then construct a function @xmath188 by @xmath189 heuristically , the criterion @xmath190 should diverge to infinity when evaluated at any @xmath178 and remain  stable \" when evaluated at a @xmath191 .",
    "we therefore employ the minimum of @xmath190 over @xmath14 to examine whether there exists a @xmath23 that simultaneously makes @xmath190  stable \" ( @xmath191 ) and satisfies the conjectured restriction ( @xmath192 ) .",
    "formally , we employ @xmath193 where @xmath194 is a sieve for @xmath195  i.e. @xmath196 is a finite dimensional subset of @xmath197 that grows dense in @xmath195 . since the choice of @xmath194 depends on @xmath197 ,",
    "we leave it unspecified though note common choices include flexible finite dimensional specifications , such as splines , polynomials , wavelets , and neural networks ; see @xcite .        before stating our next set of assumptions , we introduce basic notation that we employ throughout the paper . for conciseness , we let @xmath198 and succinctly refer to the set of @xmath199 satisfying the null hypothesis in by employing the notation @xmath200 we also view any @xmath182 matrix @xmath183 as a map from @xmath201 to @xmath201 , and note that when @xmath201 is equipped with the norm @xmath202 it induces on @xmath183 the operator norm @xmath203 given by @xmath204 for instance",
    ", @xmath205 corresponds to the largest maximum absolute value column sum of @xmath183 , and @xmath206 corresponds to the square root of the largest eigenvalue of @xmath207 .",
    "our analysis relies heavily on empirical process theory , and we therefore borrow extensively from the literature s notation @xcite .",
    "in particular , for any function @xmath208 of @xmath209 we for brevity sometimes write its expectation as @xmath210 ~.\\ ] ] in turn , we denote the empirical process evaluated at a function @xmath208 by @xmath211 ",
    "i.e. set @xmath212 we will often need to evaluate the empirical process at functions generated by the maps @xmath213 and the sieve @xmath194 , and for convenience we therefore define the set @xmath214 the  size \" of @xmath215 plays a crucial role , and we control it through the bracketing integral @xmath216}(\\delta,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\equiv \\int_0^\\delta \\sqrt{1 + \\log n_{[\\hspace{0.02 in}]}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon ~,\\ ] ] where @xmath217}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] is the smallest number of brackets of size @xmath218 ( under @xmath219 ) required to cover @xmath215 .",
    "bracket under @xmath219 is a set of the form @xmath220 with @xmath221 . here , as usual ,",
    "the @xmath222 spaces are defined by @xmath223 where @xmath224 $ ] .",
    "] finally , we let @xmath225 denote the isonormal process on @xmath226 ",
    "i.e. @xmath225 is a gaussian process satisfying for all @xmath227 , @xmath228 = e[\\mathbb w_{n , p}g ] = 0 $ ] and @xmath229 = e_p[(f(v_i ) - e_p[f(v_i)])(g(v_i ) - e_p[g(v_i ) ] ) ] ~.\\ ] ]    it will prove useful to denote the vector subspace generated by the sieve @xmath194 by @xmath230 where @xmath231 denotes the closure under @xmath30 of the linear span of any set @xmath232 .",
    "since @xmath233 will further be assumed to be finite dimensional , all well defined norms on it will be equivalent in the sense that they generate the same topology . hence ,",
    "if @xmath233 is a subspace of two different banach spaces @xmath234 and @xmath235 , then the modulus of continuity of @xmath236 with respect to @xmath237 , which we denote by @xmath238 will be finite for any @xmath179 though possibly diverging to infinity with the dimension of @xmath233 .",
    "for example , if @xmath239 , then @xmath240 , while @xmath241 is the smallest constant such that @xmath242 for all @xmath243 .",
    "the following assumptions introduce a basic structure we employ throughout the paper .",
    "[ ass : iid ] ( i ) @xmath244 is an i.i.d . sequence with @xmath245 .",
    "[ ass : instreg ] ( i ) for all @xmath246 , @xmath247 with @xmath248 ; ( ii ) the largest eigenvalue of @xmath249 $ ] is bounded uniformly in @xmath246 , @xmath179 , and @xmath250 ; ( iii ) the dimension of @xmath233 is finite for any @xmath179 .",
    "[ ass : processreg ] the classes @xmath215 : ( i ) are closed under @xmath219 ; ( ii ) have envelope @xmath251 with @xmath252 < \\infty$ ] ; ( iii ) satisfy @xmath253}(\\|f_n\\|_{l^2_p},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\leq j_n$ ] .",
    "[ ass : weights ] ( i ) for each @xmath254 there is a @xmath255 with @xmath256 uniformly in @xmath254 ; ( ii ) the matrices @xmath257 are invertible for all @xmath179 and @xmath254 ; ( iii ) @xmath258 and @xmath259 are uniformly bounded in @xmath179 and @xmath254 .",
    "assumption [ ass : iid ] imposes that the sample @xmath260 be i.i.d . with @xmath6 belonging to a set of distributions @xmath261 over which our results will hold uniformly . in assumption [ ass : instreg](i ) we require the functions @xmath161 to be bounded by a constant @xmath262 possibly diverging to infinity with the sample size .",
    "hence , assumption [ ass : instreg](i ) accommodates both transformations that are uniformly bounded in @xmath179 , such as trigonometric series , and those with diverging bound , such as b - splines , wavelets , and orthogonal polynomials ( after orthonormalization ) .",
    "the bound on eigenvalues imposed in assumption [ ass : instreg](ii ) guarantees that @xmath263 are bessel sequences uniformly in @xmath179 , while assumption [ ass : instreg](iii ) formalizes that the sieve @xmath194 be finite dimensional . in turn , assumption [ ass : processreg ] controls the  size \" of the class @xmath215 , which is crucial in studying the induced empirical process .",
    "we note that the entropy integral is allowed to diverge with the sample size and thus accommodates non - compact parameter spaces @xmath18 as in @xcite . alternatively ,",
    "if the class @xmath264 is restricted to be donsker , then assumptions [ ass : processreg](ii)-(iii ) can hold with uniformly bounded @xmath265 and @xmath266 .",
    "finally , assumption [ ass : weights ] imposes requirements on the weighting matrix @xmath187  namely , that it converge to an invertible matrix @xmath257 possibly depending on @xmath6 .",
    "assumption [ ass : weights ] can of course be automatically satisfied under nonstochastic weights .",
    "as a preliminary step towards approximating the finite sample distribution of @xmath267 , we first aim to characterize the asymptotic behavior of the minimizers of @xmath190 on @xmath196 .",
    "specifically , for any sequence @xmath268 we study the probability limit of the set @xmath269 which constitutes the set of exact @xmath270 or near ( @xmath271 ) minimizers of @xmath190 .",
    "we study the general case with @xmath268 because results for both exact and near minimizers are needed in our analysis . in particular , the set of exact and near minimizers will be employed to respectively characterize and estimate the distribution of @xmath267 .",
    "while it is natural to view @xmath272 as the candidate probability limit for @xmath273 , it is in fact more fruitful to instead consider @xmath274 as consistent for the sets(i ) and [ ass : processreg](iii ) respectively imply @xmath215 is closed and totally bounded under @xmath219 and hence compact .",
    "it follows that the minimum in is attained and @xmath275 is well defined . ]",
    "@xmath276\\|_{r } ~.\\ ] ] heuristically , @xmath275 is the set of minimizers of a population version of @xmath190 where the number of moments @xmath177 has been fixed and the parameter space has been set to @xmath194 ( instead of @xmath195 ) . as we will show , a suitable rate of convergence towards @xmath275 suffices for establishing size control , and can in fact be obtained under weaker requirements than those needed for convergence towards @xmath272 .    following the literature on set estimation in finite dimensional settings @xcite , we study set consistency under the hausdorff metric . in particular , for any sets @xmath183 and @xmath277 we define @xmath278 which respectively constitute the directed hausdorff distance and the hausdorff distance under the metric @xmath279 .",
    "in contrast to finite dimensional problems , however , in the present setting we emphasize the metric under which the hausdorff distance is computed due to its importance in determining a rate of convergence ; see also @xcite .",
    "we establish the consistency of @xmath274 under the following additional assumption :    [ ass : keycons ] ( i ) @xmath280\\|_r \\leq \\zeta_n$ ] for some @xmath281 ; ( ii ) let @xmath282 and set @xmath283\\|_r ~\\ ] ] for any @xmath284 .",
    "then @xmath285 for any @xmath284 .",
    "assumption [ ass : keycons](i ) requires that the sieve @xmath196 be such that the infimum @xmath286 converges to zero uniformly over @xmath287 .",
    "heuristically , since for any @xmath287 the infimum in over the entire parameter space equals zero @xmath288 , assumption [ ass : keycons](i ) can be interpreted as demanding that the sieve @xmath194 provide a suitable approximation to @xmath195 . in turn , the parameter @xmath289 introduced in assumption [ ass : keycons](ii ) measures how ",
    "well separated \" the infimum in is ( see ) , while the quantity @xmath290 represents the rate at which the scaled criterion @xmath291 converges to its population analogue ; see lemma [ aux : suppq ] .",
    "thus , assumption [ ass : keycons](ii ) imposes that the rate at which ",
    "well separatedness \" is lost @xmath292 be slower than the rate at which @xmath291 converges to its population counterpart  a condition originally imposed in estimation problems with non compact parameter spaces by @xcite who also discuss sufficient conditions for it ; see remark [ rm : gnexp ] .    given the introduced assumption , lemma [ lm : setcons ] establishes the consistency of @xmath274 .",
    "[ lm : setcons ] let assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg ] , [ ass : weights ] , and [ ass : keycons ] hold .",
    "( i ) if the sequence @xmath293 satisfies @xmath294 for all @xmath284 , then it follows that uniformly in @xmath287 @xmath295 ( ii ) moreover , if in addition @xmath293 is such that @xmath296 , then @xmath297    the first claim of lemma [ lm : setcons ] shows that , provided @xmath268 sufficiently fast , @xmath274 is contained in arbitrary neighborhoods of @xmath275 with probability approaching one .",
    "this conclusion will be of use when characterizing the distribution of @xmath267 . in turn , the second claim of lemma [ lm : setcons ] establishes that , provided @xmath298 slowly enough , @xmath275 is contained in @xmath274 with probability approaching one .",
    "this second conclusion will be of use when employing @xmath274 to construct an estimator of the distribution of @xmath267 .",
    "[ rm : gnexp ] under assumption [ ass : instreg](ii ) , it is possible to show there is a @xmath299 with @xmath300\\|_r \\\\",
    "\\leq c \\times \\inf_{\\theta \\in ( \\theta_n \\cap r)\\setminus(\\theta_{0}(p)\\cap r)^\\epsilon } \\{\\sum_{\\jmath = 1}^{\\mathcal j}\\{e_p[(e_p[\\rho_{\\jmath}(x_i,\\theta)|z_{i,\\jmath}])^2]\\}^{\\frac{1}{2}}\\ } ~;\\end{gathered}\\ ] ] see lemma [ aux : bessel ] . therefore ,",
    "if the problem is ill - posed and the sieve @xmath194 grows dense in @xmath195 , result implies that @xmath301 for all @xmath302 as in @xcite .",
    "in contrast , @xcite address the ill - posed inverse problem by imposing compactness of the parameter space .",
    "analogously , in our setting it is possible to show that if @xmath195 is compact and @xmath161 are suitable dense , then @xmath303 for any @xmath287 .",
    "hence , under compactness of @xmath195 , it is possible for @xmath304 , in which case assumption [ ass : keycons](ii ) follows from [ ass : keycons](i ) and @xmath305 .",
    "the consistency result in lemma [ lm : setcons ] enables us to derive a rate of convergence by exploiting the local behavior of the population criterion function in a neighborhood of @xmath275 .",
    "we do not study a rate convergence under the original norm @xmath30 , however , but instead introduce a potentially weaker norm we denote by @xmath306 .",
    "heuristically , the need to introduce @xmath306 arises from the  strength \" of @xmath30 being determined by the requirement that the maps @xmath24 and @xmath25 be continuous under @xmath30 ; recall assumption [ ass : r](ii ) .",
    "on the other hand , in approximating the distribution of @xmath267 we must also rely on a metric under which the empirical process is stochastically equicontinuous  a purpose for which @xmath30 is often  too strong \" with its use leading to overly stringent assumptions .",
    "thus , while @xmath30 ensures continuity of the maps @xmath20 and @xmath21 , we employ a weaker norm @xmath306 to guarantee the stochastic equicontinuity of the empirical process  here",
    " @xmath307 \" stands for equicontinuity .",
    "the following assumption formally introduces @xmath306 and enables us to obtain a rate of convergence under the induced hausdorff distance .",
    "[ ass : keyrate ] ( i ) for a banach space @xmath307 with norm @xmath306 satisfying @xmath308 for all @xmath179 , there is an @xmath284 and sequence @xmath309 with @xmath310 such that @xmath311\\|_r + o(\\zeta_{n})\\}\\ ] ] for all @xmath287 and @xmath312 .",
    "intuitively , assumption [ ass : keyrate ] may be interpreted as a generalization of a classical local identification condition . in particular , the parameter @xmath313 measures the strength of identification , with large / small values of @xmath313 indicating how quickly / slowly the criterion grows as @xmath23 moves away from the set of minimizers @xmath275 .",
    "the strength of identification , however , may decrease with @xmath179 for at least two reasons .",
    "first , in ill - posed problems @xmath313 decreases with the dimension of the sieve , reflecting that local identification is attained in finite dimensional subspaces but not on the entire parameter space .",
    "second , the strength of identification is affected by the choice of norm @xmath202 employed in the construction of @xmath190 .",
    "while the norms @xmath202 are equivalent on any fixed finite dimensional space , their modulus of continuity can decrease with the number of moments which in turn affects @xmath313 ; see remark [ rm : localid ] .",
    "the following theorem exploits assumption [ ass : keyrate ] to obtain a rate of convergence .",
    "[ th : setrates ] let assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , and [ ass : keyrate ] hold , and let @xmath314 ( i ) if @xmath293 satisfies @xmath294 for any @xmath302 , then it follows that uniformly in @xmath287 @xmath315 ( ii ) moreover , if in addition @xmath296 , then uniformly in @xmath287 @xmath316    together , lemma [ lm : setcons ] and theorem [ th : setrates ] establish the consistency ( in @xmath317 and rate of convergence ( in @xmath306 ) of the set estimator @xmath274 . while we exploit these results in our forthcoming analysis , it is important to emphasize that in specific applications alternative assumptions that are better suited for the particular structure of the model may be preferable . in this regard , we note that assumptions [ ass : keycons ] and [ ass : keyrate ] are not needed in our analysis beyond their role in delivering consistency and a rate of convergence result through lemma [ lm : setcons ] and theorem [ th : setrates ] respectively .",
    "in particular , if an alternative rate of convergence @xmath318 is derived under different assumptions , then such a result can still be combined with our forthcoming analysis to establish the validity of the proposed inferential methods ",
    "i.e. our inference results remain valid if assumptions [ ass : keycons ] and [ ass : keyrate ] are instead replaced with a high level condition that @xmath274 be consistent ( in @xmath317 with an appropriate rate of convergence @xmath318 ( in @xmath306 ) .",
    "[ rm : localid ] in models in which @xmath275 is a singleton , assumption [ ass : keyrate ] is analogous to a standard local identification condition @xcite . in particular , suppose @xmath319 is a basis for @xmath233 and for each @xmath320 and @xmath321 define @xmath322 \\big|_{\\tau = 0}\\ ] ] and set @xmath323 $ ] .",
    "further let @xmath324 be such that @xmath325 for any @xmath243 and @xmath326 .",
    "if the smallest singular value of @xmath327 is bounded from below by some @xmath328 uniformly in @xmath321 and @xmath287 , then it is straightforward to show assumption [ ass : keyrate ] holds with @xmath329 and the norm @xmath330  a norm that is closely related to @xmath219 when @xmath331 .",
    "in this section , we exploit the rate of convergence derived in theorem [ th : setrates ] to obtain a strong approximation to the proposed test statistic @xmath267 .",
    "we proceed in two steps .",
    "first , we construct a preliminary local approximation involving the norm of a gaussian process with an unknown  drift \" .",
    "second , we refine the initial approximation by linearizing the  drift \" while accommodating possibly severely ill - posed problems .",
    "the first strong approximation to our test statistic relies on the following assumptions :    [ ass : coupling ] ( i ) @xmath332 uniformly in @xmath254 , where @xmath333 is some known bounded sequence .    [ ass : rhocontrol ] ( i ) there exist @xmath334 and @xmath335 such that for all @xmath179 , @xmath254 , and all @xmath336 we have that @xmath337 \\leq k_\\rho^2\\|\\theta_1 - \\theta_2\\|_{\\mathbf e}^{2\\kappa_\\rho}$ ] .",
    "[ ass : locrates ] ( i ) @xmath338}({\\mathcal r}_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] ; ( ii ) @xmath339 ; ( iii ) @xmath340 uniformly in @xmath254 .",
    "assumption [ ass : coupling](i ) requires that the empirical process @xmath341 be approximated by an isonormal gaussian process @xmath225 uniformly in @xmath254 .",
    "intuitively , assumption [ ass : coupling](i ) replaces the traditional requirement of convergence in distribution by a strong approximation , which is required to handle the asymptotically non - donsker setting that arises naturally in our case and other related problems ; see @xcite for further discussion .",
    "the sequence @xmath333 in assumption [ ass : coupling](i ) denotes a bound on the rate of convergence of the coupling to the empirical process , which will in turn characterize the rate of convergence of our strong approximation to @xmath267 .",
    "we provide sufficient conditions for verifying assumption [ ass : coupling](i ) based on @xcite s coupling in corollary [ cor : polycoup ] in .",
    "these results could be of independent interest .",
    "alternatively , assumption [ ass : coupling](i ) can be verified by employing methods based on @xcite s coupling or @xcite s couplings ; see e.g. , @xcite .",
    "assumption [ ass : rhocontrol](i ) is a hlder continuity condition on the map @xmath342 with respect to the norm @xmath306 , and thus ensures that @xmath343 is equicontinuous with respect to the index @xmath23 under @xmath306 for fixed @xmath179 .",
    "however , this process gradually looses its equicontinuity property as @xmath179 diverges infinity due to the addition of moments and increasing complexity of the class @xmath215 .",
    "hence , assumption [ ass : locrates](i ) demands that the @xmath306-rate of convergence ( @xmath318 ) be sufficiently fast to overcome the loss of equicontinuity at a rate no slower than @xmath344 ( as in assumption [ ass : coupling](i ) ) . finally ,",
    "assumption [ ass : locrates](ii ) ensures the test statistic is asymptotically properly centered under the null hypothesis , while assumption [ ass : locrates](iii ) controls the rate of convergence of the weighting matrix .",
    "together , the results of section [ sec : consrates ] and assumptions [ ass : coupling ] , [ ass : rhocontrol ] , and [ ass : locrates ] enable us to obtain a strong approximation to the test statistic @xmath267 . to this end",
    ", we define @xmath345 which for any @xmath346 constitutes the collection of local deviations from @xmath23 that remain in the constrained sieve @xmath196 .",
    "thus the local parameter space @xmath347 is indexed by @xmath23 which runs over @xmath194 and parameterized by deviations @xmath348 from @xmath23 ; this follows previous uses in @xcite and @xcite .",
    "the normalization by @xmath349 plays no particular role here , since @xmath350 can grow and merely visually emphasizes localization . by theorem [ th : setrates ]",
    ", it then follows that in studying @xmath267 we need not consider the infimum over the entire sieve ( see ) but may instead examine the infimum over local deviations to @xmath351  i.e. the infimum over parameters @xmath352 with the neighborhood @xmath353 shrinking at an appropriate rate @xmath354 . in turn ,",
    "assumptions [ ass : coupling ] , [ ass : rhocontrol ] , and [ ass : locrates ] control the relevant stochastic processes over the localized space and allow us to characterize the distribution of @xmath267 .",
    "the following lemma formalizes the preceding discussion .",
    "[ lm : localprelim ] let assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : keyrate ] , [ ass : coupling ] , [ ass : rhocontrol ] , and [ ass : locrates ] hold .",
    "it then follows that for any sequence @xmath355 satisfying @xmath356 and @xmath357}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] , we have uniformly in @xmath287 that @xmath358    lemma [ lm : localprelim ] establishes our first strong approximation and further characterizes the rate of convergence to be no slower than @xmath344 ( as in assumption [ ass : coupling ] ) .",
    "thus , for a consistent coupling we only require that assumptions [ ass : coupling ] and [ ass : locrates ] hold with @xmath333 a bounded sequence . in certain applications ,",
    "however , successful estimation of critical values will additionally require us to impose that @xmath344 be logarithmic or double logarithmic ; see section [ sec : critvalues ] .",
    "we further note that for the conclusion of lemma [ lm : localprelim ] to hold , the neighborhoods @xmath359 must shrink at a rate @xmath360 satisfying two conditions .",
    "first , @xmath360 must decrease to zero slowly enough to ensure the infimum over the entire sieve is indeed equivalent to the infimum over the localized space @xmath354 .",
    "second , @xmath360 must decrease to zero sufficiently fast to overcome the gradual loss of equicontinuity of the isonormal process @xmath225 ",
    "notice @xmath225 is evaluated at @xmath361 in place of @xmath362 .",
    "the existence of a sequence @xmath360 satisfying these requirements is guaranteed by assumption [ ass : locrates](i ) . however , as we next discuss , the approximation in lemma [ lm : localprelim ] must be further refined before it can be exploited for inference .",
    "a challenge arising from lemma [ lm : localprelim ] , is the need for a tractable expression for the term @xmath363 ~,\\ ] ] which we refer to as the local  drift \" of the isonormal process . typically , the drift is approximated by a linear function of the local parameter @xmath364 by requiring an appropriate form of differentiability of the moment functions . in this section ,",
    "we build on this approach by requiring differentiability of the maps @xmath365 defined by @xmath366 ~.\\ ] ]    in the same manner that a norm @xmath306 was needed to ensure stochastic equicontinuity of the empirical process , we now introduce a final norm @xmath367 to deliver differentiability of the maps @xmath368  here  @xmath369 \" stands for linearization .",
    "thus , @xmath30 is employed to ensure smoothness of the maps @xmath20 and @xmath21 , @xmath306 guarantees the stochastic equicontinuity of @xmath341 , and @xmath367 delivers the smoothness of the maps @xmath368 .",
    "formally , we impose :    [ ass : driftlin ] for a banach space @xmath369 with norm @xmath367 and @xmath370 for all @xmath179 , there are @xmath371 , @xmath372 , @xmath284 such that for all @xmath373 , @xmath374 , @xmath287 , and @xmath375 , there is a linear @xmath376 satisfying for all @xmath377 : ( i ) @xmath378\\|_{l^2_p } \\leq k_m\\|h\\|_{\\mathbf l}\\|h\\|_{\\mathbf e}$ ] ; ( ii ) @xmath379 - \\nabla m_{p,\\jmath}(\\theta_0)[h]\\|_{l^2_p } \\leq k_m\\|\\theta_1 - \\theta_0\\|_{\\mathbf l}\\|h\\|_{\\mathbf e}$ ] ; and ( iii ) @xmath380\\|_{l^2_p } \\leq m_m \\|h\\|_{\\mathbf e}$ ] .",
    "heuristically , assumption [ ass : driftlin](i ) simply demands that the functions @xmath365 be locally well approximated under @xmath219 by linear maps @xmath381 .",
    "moreover , the approximation error is required to be controlled by the product of the @xmath306 and @xmath367 norms ; see remark [ rm : onle ] for a leading example .",
    "we emphasize , however , that assumption [ ass : driftlin](i ) does not require the generalized residuals @xmath382 themselves to be differentiable , and thus accommodates models such as the nonparametric quantile iv regression of @xcite .",
    "in addition , we note that whenever @xmath175 is linear in @xmath23 , such as in the nonparametric iv regression of @xcite , assumption [ ass : driftlin](i ) is automatically satisfied with @xmath383 . finally , assumptions [ ass : driftlin](ii ) and [ ass : driftlin](iii ) respectively require the derivatives @xmath384 to be lipschitz continuous in @xmath23 with respect to @xmath367 and norm bounded uniformly on @xmath385 and @xmath287 .",
    "the latter two assumptions are not required for the purposes of refining the strong approximation of lemma [ lm : localprelim ] , but will be needed for the study of our inferential procedure in section [ sec : boot ] .    given assumption [ ass : driftlin ] , we next aim to approximate the local drift in lemma [ lm : localprelim ] ( see ) by a linear map @xmath386 pointwise defined by @xmath387 \\equiv e_p[\\nabla m_p(\\theta_0)[h](z_i)*q^{k_n}_n(z_i ) ] ~.\\ ] ] where @xmath388(z_i ) \\equiv ( \\nabla m_{p,1}(\\theta_0)[h](z_{i,1}),\\ldots , \\nabla m_{p,\\mathcal j}(\\theta_0)[h](z_{i,\\mathcal j}))^\\prime$ ] .",
    "regrettably , it is well understood that , particularly in severely ill - posed problems , the rate of convergence may be too slow for @xmath389 to approximate the drift uniformly over the local parameter space in nonlinear models @xcite . however , while such a complication can present important challenges when employing the asymptotic distribution of estimators for inference , severely ill - posed problems can still be accommodated in our setting .",
    "specifically , instead of considering the entire local parameter space , as in lemma [ lm : localprelim ] , we may restrict attention to an infimum over the subset of the local parameter space for which an approximation of the drift by @xmath389 is indeed warranted .",
    "the resulting bound for @xmath267 is potentially conservative in nonlinear models when the rate of convergence @xmath318 is not sufficiently fast , but remains asymptotically equivalent to @xmath267 in the remaining settings .",
    "[ fig1 ]    ( -3.5,-2)(-3.5,2)(3.5,2)(3.5,-2)(-3.5,-2 ) ; ( 0,0)(2.5,0 ) ; ( -2.5,0)(0,0 ) ; at ( 2.65,-0.02 ) @xmath390 ; ( 0,0)(0,1.75 ) ; ( 0,-1.75)(0,0 ) ; ( 1.455,-1)(1.455,1 ) ; ( -1.455,-1)(-1.455,1 ) ; at ( -1.65,-0.15 ) @xmath391 ; at ( 1.65,-0.15 ) @xmath392 ; ( -1.75,-0.4375)(1.75,0.4375 ) ; ( 1.75,0.4375 ) .. controls ( 2,0.5 ) and ( 2.5,0.625 ) .. ( 2.5,1.5 ) ; ( -1.75,-0.4375 ) .. controls ( -2,-0.5 ) and ( -2.5,-0.625 ) .. ( -2.5,-1.5 ) ; at ( -2.5 , -1.65 ) @xmath393 ; ( -0.5,-1 ) circle ( 0.6pt ) ; ( -0.706,-0.176)(-0.5,-1 ) ; at ( -0.3,-1 ) @xmath394 ; ( 2,1.3 ) circle ( 0.6pt ) ; at ( 1.8,1.4 ) @xmath395 ; ( 2,1.3)(1.455,0.3638 ) ; ( 2,1.3)(2.5,1.3 ) ;    our next theorem characterizes the properties of the described strong approximation .",
    "it is helpful to note here that the notation @xmath396 is defined in section [ sec : not ] as the modulus of continuity ( on @xmath233 ) between the norms on two spaces @xmath397 and @xmath398 ( see ) .",
    "[ th : localdrift ] let assumptions [ ass : iid ] , [ ass : instreg ] , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : keyrate ] , [ ass : coupling ] , [ ass : rhocontrol ] , [ ass : locrates ] , and [ ass : driftlin](i ) hold .",
    "( i ) then , for any sequence @xmath355 satisfying @xmath399 and @xmath357}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] it follows that @xmath400\\|_{\\sigma_n(p),r } + o_p(a_n ) ~,\\ ] ] uniformly in @xmath287 .",
    "( ii ) moreover , if in addition @xmath401 , then the sequence @xmath355 may be chosen so that uniformly in @xmath287 @xmath402\\|_{\\sigma_n(p),r } +   o_p(a_n ) ~.\\ ] ]    the conclusion of theorem [ th : localdrift ] can be readily understood through figure [ fig1 ] , which illustrates the special case in which @xmath71 , @xmath403 , @xmath404 , and @xmath405 . in this context , the gaussian process @xmath406 is simply a bivariate normal random variable in @xmath407 that we denote by @xmath408 for conciseness . in turn",
    ", the drift is a surface on @xmath407 that is approximately linear ( equal to @xmath409 $ ] ) in a neighborhood of zero . according to lemma [ lm : localprelim ]",
    ", @xmath267 is then asymptotically equivalent to the distance between @xmath408 and the surface representing the drift .",
    "intuitively , theorem [ th : localdrift](i ) then bounds @xmath267 by the distance between @xmath408 and the restriction of the drift surface to the region where it is linear  a bound that may be equal to or strictly larger than @xmath267 as illustrated by the realizations @xmath410 and @xmath411 respectively . however , if the rate of convergence @xmath318 is sufficiently fast or @xmath412 is linear in @xmath23 ( @xmath383 ) , then theorem [ th : localdrift](ii ) establishes @xmath267 is in fact asymptotically equivalent to the derived bound ",
    "i.e. the realizations of @xmath408 behave in the manner of @xmath410 and not that of @xmath411 .",
    "[ rm : onle ] in an important class of models studied by @xcite , @xmath331 and the generalized residual function @xmath412 has the structure @xmath413 for a known map @xmath414 .",
    "suppose @xmath415 is differentiable for all @xmath416 with derivative denoted @xmath417 and satisfying for some @xmath418 @xmath419(i)-(ii ) hold with @xmath420 , @xmath421 , and @xmath422 , while assumption [ ass : driftlin](iii ) is satisfied provided @xmath423 is bounded uniformly in @xmath424 , @xmath425 , and @xmath287 .",
    "the results of section [ sec : strongapprox ] establish a strong approximation to our test statistic and thus provide us with a candidate distribution whose quantiles may be employed to conduct valid inference . in this section ,",
    "we develop an estimator for the approximating distribution derived in section [ sec : strongapprox ] and study its corresponding critical values .",
    "theorem [ th : localdrift ] indicates a valid inferential procedure can be constructed by comparing the test statistic @xmath267 to the quantiles of the distribution of the random variable @xmath426\\|_{\\sigma_n(p),r }   ~.\\ ] ] in particular , as a result of theorem [ th : localdrift](i ) , we may expect that employing the quantiles of @xmath427 as critical values for @xmath267 can control asymptotic size even in severely ill - posed nonlinear problems .",
    "moreover , as a result of theorem [ th : localdrift](ii ) , we may further expect the asymptotic size of the resulting test to equal its significance level at least in linear problems ( @xmath383 ) or when the rate of convergence ( @xmath318 ) is sufficiently fast .    in what follows",
    ", we construct an estimator of the distribution of @xmath427 by replacing the population parameters in with suitable sample analogues . to this end",
    ", we note that by theorem [ th : setrates ] and assumption [ ass : weights](i ) , the set @xmath275 and weighting matrix @xmath257 may be estimated by @xmath274 and @xmath187 respectively .",
    "thus , in mimicking , we only additionally require sample analogues @xmath428 for the isonormal process @xmath225 , @xmath429 for the derivative @xmath430 , and @xmath431 for the local parameter space @xmath432 . given such analogues we may then approximate the distribution of @xmath427 by that of @xmath433\\|_{\\hat \\sigma_n , r } ~.\\ ] ] in the next two sections , we first propose standard estimators for the isonormal process @xmath225 and derivative @xmath430 , and subsequently address the more challenging task of constructing an appropriate sample analogue for the local parameter space @xmath432 .",
    "we approximate the law of the isonormal process @xmath225 by relying on the multiplier bootstrap @xcite .",
    "specifically , for an i.i.d .",
    "sample @xmath434 with @xmath435 following a standard normal distribution and independent of @xmath260 we set @xmath436 for any function @xmath437 . since @xmath434",
    "are standard normal random variables drawn independently of @xmath260 , it follows that conditionally on @xmath260 the law of @xmath438 is also gaussian , has mean zero , and in addition satisfies for any @xmath208 and @xmath155 ( compare to ) @xmath439 = \\frac{1}{n}\\sum_{i=1}^n ( f(v_i ) - \\frac{1}{n}\\sum_{j=1}^n f(v_j))(g(v_i ) - \\frac{1}{n}\\sum_{j=1}^n g(v_j ) ) ~.\\ ] ] hence , @xmath428 can be simply viewed as a gaussian process whose covariance kernel equals the sample analogue of the unknown covariance kernel of @xmath225 .    in order to estimate the derivative @xmath430 we for concreteness adopt a construction that is applicable to nondifferentiable generalized residuals @xmath440 .",
    "specifically , we employ a local difference of the empirical process by setting @xmath441 \\equiv \\frac{1}{\\sqrt n }",
    "\\sum_{i=1}^n ( \\rho(x_i,\\theta + \\frac{h}{\\sqrt n } ) - \\rho(x_i,\\theta))*q_n^{k_n}(z_i)\\ ] ] for any @xmath346 and @xmath377 ; see also @xcite for a related study on numerical derivatives .",
    "we note , however , that while we adopt the estimator in due to its general applicability , alternative approaches may be preferable in models where the generalized residual @xmath412 is actually differentiable in @xmath23 ; see remark [ rm : onder ] .",
    "[ rm : onder ] in settings in which the generalized residual @xmath412 is pathwise partially differentiable in @xmath23 @xmath6-almost surely , we may instead define @xmath442 $ ] to be @xmath443 \\equiv \\frac{1}{n}\\sum_{i=1}^n   \\nabla_\\theta \\rho(x_i , \\theta)[h ] * q_n^{k_n}(z_i ) ~,\\ ] ] where @xmath444 \\equiv \\frac{\\partial}{\\partial \\tau } \\rho(x,\\theta + \\tau h)|_{\\tau = 0}$ ] .",
    "it is worth noting that , when applicable , employing in place of is preferable because the former is linear in @xmath364 , and thus the resulting bootstrap statistic @xmath445 ( as in ) is simpler to compute .",
    "the remaining component we require to obtain a bootstrap approximation is a suitable sample analogue for the local parameter space .",
    "we next develop such a sample analogue , which may be of independent interest as it is more broadly applicable to hypothesis testing problems concerning general equality and inequality restrictions in settings beyond the conditional moment restriction model ; see for the relevant results .",
    "[ [ related - assumptions ] ] related assumptions + + + + + + + + + + + + + + + + + + +    the construction of an approximation to the local parameter space first requires us to impose additional conditions on the sieve @xmath196 and the restriction maps @xmath20 and @xmath21 .",
    "[ ass : extra ] ( i ) for some @xmath446 , @xmath447 for all @xmath179 , @xmath377 ; ( ii ) for some @xmath284 , @xmath448 for all @xmath179 .",
    "[ ass : locineq ] there exist @xmath449 , @xmath450 , and @xmath284 such that for all @xmath179 , @xmath287 , @xmath425 , and @xmath451 : ( i ) there is a linear map @xmath452 satisfying @xmath453\\|_{\\mathbf",
    "g } \\leq k_g \\|\\theta_1 - \\theta_2\\|_{\\mathbf b}^2 $ ] ; ( ii ) @xmath454 ; ( iii ) @xmath455 .",
    "assumption [ ass : extra](i ) imposes that the norm @xmath30 be weakly stronger than the norm @xmath306 uniformly on the sieve @xmath194 .",
    "is finite dimensional , there always exists a constant @xmath456 such that @xmath457 for all @xmath377 .",
    "thus , the main content of assumption of [ ass : extra](i ) is that @xmath458 does not depend on @xmath179 . ]",
    "we note that even though the local parameter space @xmath459 is determined by the @xmath306 norm ( see ) , assumption [ ass : extra](i ) implies restricting the norm @xmath30 instead can deliver a subset of @xmath459 . in turn , assumption [ ass : extra](ii ) demands that @xmath275 be contained in the interior of @xmath460 uniformly in @xmath254 .",
    "we emphasize , however , that such a requirement does not rule out binding parameter space restrictions . instead ,",
    "assumption [ ass : extra](ii ) simply requires that all such restrictions be explicitly stated through the set @xmath14 ; see remarks [ rm : param ] and [ rm : interiority ] . finally , assumption [ ass : locineq ] imposes that @xmath81 be frchet differentiable in a neighborhood of @xmath275 with locally lipschitz continuous and norm bounded derivative @xmath461 .    in order to introduce analogous requirements for the map @xmath462 we first define @xmath463 where recall for any set @xmath464 , @xmath231 denotes the closure of the linear span of @xmath464 ",
    "i.e. @xmath465 denotes the closed linear span of the range of @xmath466 .",
    "in addition , for any linear map @xmath467 we denote its null space by @xmath468 . given these definitions",
    ", we next impose the following requirements on @xmath20 and its relation to @xmath21 :    [ ass : loceq ] there exist @xmath469 , @xmath470 , and @xmath284 such that for all @xmath179 , @xmath287 , @xmath425 , and @xmath451 : ( i ) there is a linear map @xmath471 satisfying @xmath472\\|_{\\mathbf f } \\leq k_f \\|\\theta_1 - \\theta_2\\|_{\\mathbf b}^2 $ ] ; ( ii ) @xmath473 ; ( iii ) @xmath474 ; ( iv ) @xmath475 admits a right inverse @xmath476 with @xmath477 .",
    "[ ass : ineqlindep ] either ( i ) @xmath77 is linear , or ( ii ) there are constants @xmath284 , @xmath478 such that for every @xmath287 , @xmath179 , and @xmath425 there exists a @xmath479 satisfying @xmath480 \\leq -\\epsilon \\mathbf { 1_g}$ ] and @xmath481 .",
    "assumptions [ ass : loceq ] and [ ass : ineqlindep ] mark an important difference between hypotheses in which @xmath20 is linear and those in which @xmath20 is nonlinear  in fact , in the former case assumptions [ ass : loceq ] and [ ass : ineqlindep ] are always satisfied .",
    "this distinction reflects that when @xmath20 is linear its impact on the local parameter space is known and hence need not be estimated .",
    "in contrast , when @xmath20 is nonlinear its role in determining the local parameter space depends on the point of evaluation @xmath482 and is as a result unknown . , the requirement @xmath483 is equivalent to @xmath484 for any @xmath192 .",
    "in contrast , if @xmath20 is nonlinear , then the set of @xmath377 for which @xmath483 can depend on @xmath192 . ] in particular , we note that while assumptions [ ass : loceq](i)-(iii ) impose smoothness conditions analogous to those required of @xmath21 , assumption [ ass : loceq](iv ) additionally demands that the derivative @xmath485 posses a norm bounded right inverse for all @xmath23 in a neighborhood of @xmath275 .",
    "existence of a right inverse is equivalent to the surjectivity of the derivative @xmath486 and hence amounts to the classical rank condition @xcite . in turn , the requirement that the right inverse s operator norm be uniformly bounded is imposed for simplicity .",
    ", its right inverse is a map @xmath487 such that @xmath488 for any @xmath489 .",
    "the right inverse @xmath490 need not be unique if @xmath491 is not bijective , in which case assumption [ ass : loceq](iv ) is satisfied as long as it holds for some right inverse of @xmath485 .",
    "] finally , assumption [ ass : ineqlindep](ii ) specifies the relation between @xmath20 and @xmath21 when the former is nonlinear .",
    "heuristically , assumption [ ass : ineqlindep](ii ) requires the existence of a local perturbation to @xmath482 that relaxes the  active \" inequality constraints without a first order effect on the equality restriction .",
    "[ rm : param ] certain parameter space restrictions can be incorporated through the map @xmath25 .",
    "@xcite , for example , address estimation in ill - posed inverse problems by requiring the parameter space @xmath18 to be compact . in our present context , and assuming @xmath492 for notational simplicity , their smoothness requirements correspond to setting @xmath19 to be the hilbert space with inner product @xmath493 for some integer @xmath494 and @xmath495 , and letting @xmath496 .",
    "it is then straightforward to incorporate this restriction through the map @xmath497 by letting @xmath498 and defining @xmath499 .",
    "moreover , given these definitions , assumption [ ass : locineq ] is satisfied with @xmath500 = 2\\langle \\theta , h\\rangle_{\\mathbf b}$ ] , @xmath501 , and @xmath502 .",
    "[ rm : interiority ] the consistency result of lemma [ lm : setcons ] and assumption [ ass : extra](ii ) together imply that the minimum of @xmath503 over @xmath194 is attained on the interior of @xmath194 relative to @xmath504 . therefore ,",
    "if the restriction set @xmath14 is convex and @xmath503 is convex in @xmath23 and well defined on @xmath504 ( rather than @xmath194 ) , then it follows that @xmath505 uniformly in @xmath287  i.e. the constraint @xmath506 can be omitted in computing @xmath267 .    [",
    "[ construction - and - intuition ] ] construction and intuition + + + + + + + + + + + + + + + + + + + + + + + + + +    given the introduced assumptions , we next construct a sample analogue for the local parameter space @xmath507 of an element @xmath425 .",
    "to this end , we note that by assumption [ ass : extra](ii ) @xmath507 is asymptotically determined solely by the equality and inequality constraints .",
    "thus , the construction of a suitable sample analogue for @xmath353 intuitively only requires estimating the impact on the local parameter space that is induced by the maps @xmath20 and @xmath21  a goal we accomplish by examining the impact such constraints have on the local parameter space of a corresponding @xmath508 .",
    "( 2.1,-1)(-2.1,-1)(-2.1,3)(2.1,3)(2.1,-1 ) ; ( -1.8,1)(0,1 ) ; ( 0,1)(1.8,1 ) ; ( 0,1)(0,2.8 ) ; ( 0,1)(0,-0.8 ) ; plot ( , 1 - 0.5 * ) ; plot ( , 1 + 0.5 * ) ",
    "( 1.7,-0.7 ) ",
    "( -1.7 , -0.7 )  cycle ; at ( 1.5 , -0.5 ) @xmath16 ; at ( -0.9 , 2.3 ) ;        ( 2.1,-1)(-2.1,-1)(-2.1,3)(2.1,3)(2.1,-1 ) ; ( -1.8,1)(0,1 ) ; ( 0,1)(1.8,1 ) ; ( 0,1)(0,2.8 ) ; ( 0,1)(0,-0.8 ) ; plot ( , 0.8 - 0.25 * ) ; plot ( , 0.84 + 0.25 * )  ( -0.8,1 )  ( -1.7 , 1 )  cycle ; plot ( , 0.84 + 0.25 * )  ( 1.7,1 )  ( 0.8 , 1 )  cycle ; ( -1.7,1 ) rectangle ( 1.7,-0.7 ) ; at ( 1.5 , -0.1 ) @xmath509 ; at ( -1 , 1.5 ) ;    in order to account for the role inequality constraints play in determining the local parameter space , we conservatively estimate  binding \" sets in analogy to what is done in the partially identified literature .",
    "specifically , for a sequence @xmath510 we define @xmath511 where recall @xmath32 is the order unit in the am space @xmath27 , @xmath512 represents the ( lattice ) supremum of any two elements @xmath513 , and @xmath514 is as in assumption [ ass : locineq ] . figure [ fig2 ]",
    "illustrates the construction in the case in which @xmath492 , @xmath19 is the set of continuous functions of @xmath416 , and we aim to test whether @xmath515 for all @xmath516 . in this setting , assuming no equality constraints for simplicity , the local parameter space for @xmath16 corresponds to the set of perturbations @xmath517 such that @xmath518 remains negative ",
    "i.e. any function @xmath519 in the shaded region of the left panel of figure [ fig2 ] . , @xmath21 is the identity map , @xmath520 since @xmath21 is linear , the order unit @xmath32 is the function with constant value 1 , and @xmath521 is the pointwise ( in @xmath522 ) maximum of the functions @xmath523 . ] for an estimator @xmath509 of @xmath16 , the set @xmath524 in turn consists of perturbations @xmath517 to @xmath509 such that @xmath525 is not  too close \" to the zero function to accommodate the estimation uncertainty in @xmath509 ",
    "i.e. any function @xmath519 in the shaded region of the right panel of figure [ fig2 ] .",
    "intuitively , as @xmath509 converges to @xmath16 the set @xmath524 is thus asymptotically contained in , i.e. smaller than , the local parameter space of @xmath16 which delivers size control .",
    "unlike figure [ fig2 ] , however , in settings for which @xmath21 is nonlinear we must further account for the curvature of @xmath21 which motivates the presence of the term @xmath526 in .",
    "while employing @xmath527 allows us to address the role inequality constraints play on the local parameter space of a @xmath425 , we account for equality constraints by examining their impact on the local parameter space of a corresponding @xmath508 .",
    "specifically , for a researcher chosen @xmath528 we define @xmath529 ( as utilized in ) by @xmath530 thus , in contrast to @xmath432 ( as in ) , the set @xmath431 : ( i ) replaces the requirement @xmath531 by @xmath532 , ( ii ) retains the constraint @xmath483 , and ( iii ) substitutes the @xmath306 norm constraint by @xmath533 .",
    "figure [ fig3 ] illustrates how ( ii ) and",
    "( iii ) allow us to account for the impact of equality constraints in the special case of no inequality constraints , @xmath534 , and @xmath76 .",
    "in this instance , the constraint @xmath535 corresponds to a curve on @xmath407 ( left panel ) , and similarly so does the local parameter space @xmath536 for any @xmath537 ( right panel ) .",
    "since all curves @xmath536 pass through zero , we note that all local parameter spaces are  similar \" in a neighborhood of the origin . however ,",
    "for nonlinear @xmath20 the size of the neighborhood of the origin in which @xmath538 is  close \" to @xmath539 crucially depends on both the distance of @xmath509 to @xmath16 and the curvature of @xmath20 ( compare @xmath540 and @xmath541 in figure [ fig3 ] ) .",
    "heuristically , the set @xmath542 thus estimates the role equality constraints play on the local parameter space of @xmath16 by restricting attention to the expanding neighborhood of the origin in which the local parameter space of @xmath509 resembles that of @xmath16 . in this regard ,",
    "it is crucial that the neighborhood be defined with respect to the norm under which @xmath20 is smooth ( @xmath317 rather than the potentially weaker norms @xmath306 or @xmath367 .",
    "( 2.1,-1)(-2.1,-1)(-2.1,3)(2.1,3)(2.1,-1 ) ; ( -1.8,0.5)(0,0.5 ) ; ( 0,0.5)(1.8,0.5 ) ; ( -1.1,1)(-1.1,2.8 ) ; ( -1.1,1)(-1.1,-0.8 ) ; plot ( , 1.5 - 0.2 * - 0.5 * ) ; at ( 1.2 , -0.1 ) @xmath543 ; ( 0,1.5 ) circle ( 0.8pt ) ; at ( 0.1 , 1.7 ) @xmath16 ; ( 0.5,1.2 ) circle ( 0.8pt ) ; at ( 0.6,1.4 ) @xmath544 ; ( 1,0.8 ) circle ( 0.8pt ) ; at ( 1.1,1 ) @xmath545 ;        ( 2.1,-1)(-2.1,-1)(-2.1,3)(2.1,3)(2.1,-1 ) ; ( -1.8,1)(0,1 ) ; ( 0,1)(1.8,1 ) ; ( 0,1)(0,2.8 ) ; ( 0,1)(0,-0.8 ) ; plot ( , 1.5 - 0.2 * - 0.5 * -0.5 ) ; at ( 1.3,0.7 ) @xmath539 ; plot ( , 1.2 - 0.2 * - 0.7 * -0.2 ) ; at ( 1.1 , -0.8 ) @xmath541 ; plot ( , 0.8 - 0.2 * - 0.9*+ 0.2 ) ; at ( -1.4 , 2.2 ) @xmath540 ;    [ rm : econtrol ] in instances where the constraints @xmath546 and @xmath81 are both linear , controlling the norm @xmath30 is no longer necessary as the  curvature \" of @xmath20 and @xmath21 is known . as a result",
    ", it is possible to instead set @xmath431 to equal @xmath547 i.e. to weaken the constraint @xmath533 in to @xmath548 . controlling the norm @xmath306 , however , may still be necessary in order to ensure that @xmath549 $ ] is a consistent estimator for @xmath550 $ ] uniformly in @xmath551 .",
    "having introduced the substitutes for the isonormal process @xmath225 , the derivative @xmath430 , and the local parameter space @xmath432 , we next study the bootstrap statistic @xmath445 ( as in ) . to this end , we impose the following additional assumptions :    [ ass : bootcoupling ] ( i ) @xmath552 uniformly in @xmath254 for @xmath553 an isonormal gaussian process that is independent of @xmath260 .",
    "[ ass : bootrates ] ( i ) for any @xmath284 , @xmath294 ; ( ii ) the sequences @xmath554 satisfy @xmath555}(\\ell_n^{\\kappa_\\rho}\\vee(\\nu_n\\tau_n)^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] , @xmath556 , and @xmath557 ; ( iii ) the sequence @xmath558 satisfies @xmath559 and @xmath560 ; ( iv ) either @xmath561 or @xmath562 .",
    "assumption [ ass : bootcoupling ] demands that the multiplier bootstrap process @xmath428 be coupled with an isonormal process @xmath553 that is independent of the data @xmath260 .",
    "intuitively , this condition requires that the multiplier bootstrap , which is automatically consistent for donsker classes , still be valid in the present non - donsker setting .",
    "moreover , in accord with our requirements on the empirical process , assumption [ ass : bootcoupling ] demands a coupling rate faster than @xmath344 ( see assumption [ ass : coupling ] ) .",
    "we provide sufficient conditions for assumption [ ass : bootcoupling ] in that may be of independent interest ; see theorem [ th : mainbootcoup ] . in turn ,",
    "assumption [ ass : bootrates ] collects the necessary bandwidth rate requirements , which we discuss in more detail in section [ sec : banddisc ] .",
    "assumption [ ass : bootrates](i ) in particular demands that @xmath268 sufficiently fast to guarantee the one sided hausdorff convergence of @xmath274 .",
    "we note this condition is satisfied by setting @xmath563 , which we recommend unless partial identification is of particular concern .",
    "similarly , assumption [ ass : bootrates](ii ) requires @xmath564 sufficiently fast to ensure that @xmath442 $ ] is uniformly consistent over @xmath565 and @xmath566 , and that both the intuitions behind figures [ fig1 ] and [ fig3 ] are indeed valid .",
    "the latter two requirements on @xmath360 are respectively automatically satisfied by linear models @xmath567 or linear restrictions @xmath568 .",
    "assumption [ ass : bootrates](iii ) specifies the requirements on @xmath558 , which amount to @xmath558 not decreasing to zero faster than the @xmath30-rate of convergence . finally , assumption [ ass : bootrates](iv ) guarantees the directed hausdorff consistency of @xmath274 under @xmath30 in nonlinear problems , thus allowing @xmath542 to properly account for the impact of the curvatures of @xmath20 and @xmath21 on the local parameter space ; recall figure [ fig3 ] .    given the stated assumptions ,",
    "the following theorem establishes an unconditional coupling of @xmath445 that provides the basis for our subsequent inference results .",
    "[ th : coupsmooth ] let assumptions [ ass : param](i ) , [ ass : r](i ) , [ ass : iid ] , [ ass : instreg ] , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : coupling ] , [ ass : rhocontrol ] , [ ass : locrates](i ) , [ ass : locrates](iii ) , [ ass : driftlin ] , [ ass : extra ] , [ ass : locineq ] , [ ass : loceq ] , [ ass : ineqlindep ] , [ ass : bootcoupling ] , and [ ass : bootrates ] hold . then , uniformly in @xmath287 @xmath569\\|_{\\sigma_n(p),r } +   o_p(a_n ) ~.\\ ] ]    theorem [ th : coupsmooth ] shows that with unconditional probability tending to one uniformly on @xmath287 our bootstrap statistic is bounded from below by a random variable that is independent of the data .",
    "the significance of this result lies in that the lower bound is equal in distribution to the upper bound for @xmath267 derived in theorem [ th : localdrift](i ) , and moreover that the rate of both couplings are controlled by @xmath344 .",
    "thus , theorems [ th : localdrift](i ) and [ th : coupsmooth ] provide the basis for establishing that comparing @xmath267 to the quantiles of @xmath445 conditional on the data provides asymptotic size control  a claim we formalize in section [ sec : critvalues ] . before establishing such a result",
    ", however , we first examine whether the conclusion of theorem [ th : coupsmooth ] can be strengthened to hold with equality rather than inequality  i.e. whether an analogue to theorem [ th :",
    "localdrift](ii ) is available .",
    "unfortunately , as is well understood from the moment inequalities literature , such a uniform coupling is not possible when inequality constraints are present .",
    "as we next show , however , theorem [ th : coupsmooth ] can be strengthened to hold with equality under conditions similar to those of theorem [ th : localdrift](ii ) in the important case of hypotheses concerning only equality restrictions .      in this section",
    "we focus on the special yet important case in which the hypothesis of interest concerns solely equality restrictions . such a setting encompasses , for example , the construction of confidence regions for functionals of the parameter @xmath16 without imposing shape restrictions ; see e.g. @xcite , @xcite , and @xcite among others .",
    "formally , we temporarily assume @xmath14 equals @xmath570    under this extra structure the formulation of the test and bootstrap statistics remain largely unchanged , with the exception that the set @xmath431 simplifies to @xmath571 ( compare to ) .",
    "since these specifications are a special case of our general framework , theorem [ th : coupsmooth ] continues to apply .",
    ", @xmath572 for all @xmath79 , and then note @xmath573 and @xmath574 for all @xmath23 and @xmath558 .",
    "] in fact , as the following theorem shows , the conclusion of theorem [ th : coupsmooth ] can be strengthened under the additional structure afforded by and conditions analogous to those imposed in theorem [ th : localdrift](ii ) .",
    "[ th : noineq ] let assumptions [ ass : param](i ) , [ ass : r](i ) , [ ass : iid ] , [ ass : instreg ] , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : coupling ] , [ ass : rhocontrol ] , [ ass : locrates ] , [ ass : driftlin ] , [ ass : extra ] , [ ass : loceq ] , [ ass : bootcoupling ] , [ ass : bootrates](i)-(ii ) hold , the set @xmath14 satisfy , and @xmath575 .",
    "( i ) if @xmath576 satisfies @xmath577 , then uniformly in @xmath287 @xmath578\\|_{\\sigma_n(p),r } +   o_p(a_n )   ~.\\ ] ] ( ii ) if @xmath579 and @xmath580 for every @xmath287 and in addition @xmath581 , then for @xmath582 we have @xmath583 uniformly in @xmath287 , where @xmath584 is a @xmath585-degrees of freedom chi - squared random variable .",
    "besides assuming a lack of inequality constraints , theorem [ th : noineq ] demands that the rate of convergence @xmath318 satisfy @xmath586 . in view of assumption [",
    "ass : bootrates](ii ) the latter requirement can be understood as imposing that either @xmath20 and @xmath587 are linear in @xmath23 ( @xmath588 ) , or the rate of convergence @xmath318 is sufficiently fast  conditions that may rule out severely ill - posed nonlinear problems as also demanded in theorem [ th : localdrift](ii ) .",
    "given these requirements , and provided @xmath589 slowly enough to ensure the hausdorff convergence of @xmath274 , theorem [ th : noineq](i ) strengthens the conclusion of theorem [ th : coupsmooth ] to hold with equality rather than inequality .",
    "moreover , the random variable to which @xmath445 is coupled by theorem [ th : noineq](i ) shares the same distribution as the random variable to which @xmath267 is coupled by theorem [ th : localdrift](ii ) .",
    "thus , theorems [ th : localdrift](ii ) and [ th : noineq](i ) together provide us with the basis for establishing that the asymptotic size of the proposed test can equal its significance level . in turn , theorem [ th : noineq](ii ) shows that whenever @xmath275 is a singleton , @xmath590 and @xmath257 may be chosen so that the coupled random variable has a pivotal distribution  a result that enables the use of analytical critical values .",
    "[ rm : geneq ] under suitable conditions theorem [ th : noineq](ii ) can be generalized to show @xmath591 uniformly in @xmath287 for @xmath592 a vector subspace of @xmath593 possibly depending on @xmath6 and @xmath385 .",
    "theorem [ th : noineq](ii ) can then be seen to follow from by setting @xmath579 and @xmath594 .",
    "however , in general the characterization in is not pivotal and thus does not offer an advantage over theorem [ th : noineq](i ) . in this regard",
    ", we note that setting @xmath581 is important to ensure pivotality as projections onto linear subspaces may not admit linear selectors otherwise @xcite .      in constructing our bootstrap approximation",
    "we have introduced three bandwidth parameters : @xmath576 , @xmath558 , and @xmath360 . while these bandwidths are necessary for a successful bootstrap approximation in the most general setting , there are fortunately a number of applications in which not all three bandwidths are required . with the aim of providing guidance on their selection ,",
    "we therefore next revisit the role of @xmath576 , @xmath558 , and @xmath360 and discuss instances in which these bandwidths may be ignored in computation .",
    "the bandwidth @xmath576 was first introduced in section [ sec : consrates ] in the construction of the set estimator @xmath274 .",
    "its principal requirement is that it converge to zero sufficiently fast in order to guarantee the directed hausdorff consistency of @xmath274 .",
    "since directed hausdorff consistency is equivalent to hausdorff consistency when @xmath275 is a singleton , @xmath576 should therefore always be set to zero in models that are known to be identified ; e.g. in examples [ ex : slutzky ] , [ ex : rd ] , and [ ex : comp ] . in settings where @xmath275 is not a singleton , however , @xmath576 must also decrease to zero sufficiently slowly if we additionally desire @xmath274 to be hausdorff consistent for @xmath351 .",
    "the latter stronger form of consistency can lead to a more powerful test when @xmath275 is not a singleton , as illustrated by a comparison of theorems [ th : coupsmooth ] and [ th : noineq](i ) .",
    "nonetheless , even in partially identified settings it may be preferable to set @xmath576 to zero to simplify implementation  this is the approach implicitly pursued by @xcite , for example , in a related problem .",
    "allowing for inequality restrictions lead us to introduce the bandwidth @xmath558 in the construction of the sample analogue to the local parameter space .",
    "specifically , the role of @xmath558 is to account for the impact of inequality constraints on the local parameter space and is thus unnecessary in settings where only equality restrictions are present ",
    "e.g. in section [ sec : noineq ] . in this regard",
    ", the bandwidth @xmath558 may be viewed as analogous to the inequality selection approach pursued in the moment inequalities literature . in particular ,",
    "its principal requirement is that it decrease to zero sufficiently slowly with overly  aggressive \" choices of @xmath558 potentially causing size distortions . as in the moment",
    "inequalities literature , however , we may always set @xmath595 which corresponds to the  least favorable \" local parameter space of an element @xmath346 satisfying @xmath596  i.e. all inequalities bind .    the final bandwidth",
    "@xmath360 , which to the best of our knowledge does not have a precedent in the literature , plays three distinct roles .",
    "first , it ensures that the estimated derivative @xmath442 $ ] is consistent for @xmath550 $ ] uniformly in @xmath597 .",
    "second , @xmath360 restricts the local parameter space to the regions where a linear approximation to the drift of the gaussian process is indeed warranted  recall theorem [ th : localdrift ] and figure [ fig1 ] .",
    "third , it accounts for the potential nonlinearity of @xmath20 and @xmath21 by limiting the estimated local parameter space to areas where it asymptotically resembles the true local parameter space  recall figures [ fig2 ] and [ fig3 ] . as a result ,",
    "the requirements on @xmath360 weaken in applications where the challenges it is meant to address are not present  for instance , when the generalized residual @xmath587 and/or the constraints @xmath20 and @xmath21 are linear , as can be seen by evaluating assumption [ ass : bootrates](ii)-(iii ) when @xmath598 , @xmath599 , or @xmath514 are zero .    in certain applications ,",
    "it is moreover possible to show the bandwidth @xmath360 is unnecessary by arguing that the constraint @xmath533 ( as in ) is asymptotically slack .",
    "the following lemma , for example , provides sufficient conditions for this occurrence .",
    "[ lm : lnotbind ] suppose for some @xmath284 it follows that @xmath600\\|_r$ ] for all @xmath321 , @xmath287 , and @xmath601 .",
    "if in addition @xmath602 - \\mathbb d_{n , p}(\\theta)[h]\\|_r}{\\|h\\|_{\\mathbf e } } = o_p(\\nu_n^{-1})\\ ] ] uniformly in @xmath287 , assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : bootcoupling ] , [ ass : bootrates](i ) hold , and @xmath603 , then it follows that uniformly in @xmath287 @xmath604\\|_{\\hat \\sigma_n , r } + o_p(a_n ) ~.\\ ] ]    heuristically , lemma [ lm : lnotbind ] establishes the constraint @xmath533 is asymptotically not binding provided @xmath528 sufficiently slowly ( @xmath605 ) .",
    ", if the constraints @xmath20 and @xmath21 are linear , then it suffices that @xmath356 . ] in order for @xmath360 to simultaneous satisfy such a requirement and assumption [ ass : bootrates](ii)-(iii ) , however , it must be that either the rate of convergence @xmath318 is adequately fast , or that both the generalized residual and the equality constraint are linear . thus , while it may be possible to set @xmath360 to be infinite in applications such as examples [ ex : slutzky]-[ex : condineq ] , the bandwidth @xmath360 can remain necessary in severely ill - posed nonlinear problems ; see .",
    "the conclusions of theorem [ th : localdrift ] and theorems [ th : coupsmooth ] and [ th : noineq ] respectively provide us with an approximation and an estimator for the distribution of our test statistic . in this section ,",
    "we conclude our main results by formally establishing the properties of a test that rejects the null hypothesis whenever @xmath267 is larger than the appropriate quantile of our bootstrap approximation . to this end",
    ", we therefore define @xmath606 i.e. @xmath607 denotes the @xmath608 quantile of @xmath267 , while @xmath609 denotes the corresponding quantile of the bootstrap statistic conditional on the sample .",
    "we additionally impose the following two final assumptions :    [ ass : equic ] there exists a @xmath610 such that for all @xmath284 and all @xmath611 $ ] it follows that @xmath612 , where the concentration parameter @xmath613 is smaller than the coupling rate parameter , namely @xmath614 .",
    "[ ass:4pow ] ( i ) there exists a @xmath615 and maps @xmath616 such that @xmath617 - q^{k_{n,\\jmath}}_{n,\\jmath}(z_{i,\\jmath})^\\prime \\pi_{n , p,\\jmath}(\\theta))^2]\\}^{\\frac{1}{2 } } = o(k_n^{-\\gamma_z})$ ] for all @xmath246 ; ( ii ) the eigenvalues of @xmath618 $ ] are bounded away from zero uniformly in @xmath246 , @xmath619 , and @xmath254 .",
    "it is well known that uniform consistent estimation of an approximating distribution is not sufficient for establishing asymptotic size control ; see , e.g. @xcite .",
    "intuitively , in order to get good size control , when critical values are estimated with noise , the approximate distribution must be suitably continuous at the quantile of interest uniformly in @xmath287 .",
    "assumption [ ass : equic ] imposes precisely this requirement , allowing the modulus of continuity , captured here by the concentration parameter @xmath613 , to deteriorate with the sample size provided that @xmath614  that is the loss of continuity must occurs at a rate slower than the coupling rate @xmath620 of theorems [ th : localdrift ] , [ th : coupsmooth ] , and [ th : noineq ] .",
    "we refer the reader to @xcite for further discussion and motivation of conditions of this type , called _ anti - concentration _ conditions there .",
    "can be dispensed by adding a fixed constant @xmath621 to the critical value , i.e. using @xmath622 as the critical value ; this approach is not satisfactory , since @xmath623 is arbitrary and there is no adequate theory for setting this . ] note that in some typical cases , the rate of concentration is @xmath624 with @xmath625 and @xmath626 with @xmath627 , which means that the condition on the coupling rate @xmath620 arising from imposing assumption [ ass : equic ] are mild in these cases and are expected to be mild in others . in turn , assumption [ ass:4pow ] imposes sufficient conditions for studying the power of the proposed test . in particular , assumption [ ass:4pow](i ) demands that the transformations @xmath161 be able to approximate conditional moments given @xmath159 and thus be capable of detecting violations of the null hypothesis .",
    "finally , assumption [ ass:4pow](ii ) enables us to characterize the set of local distributions against which the test is consistent .",
    "theorem [ th : critval ] exploits our previous results and the introduced assumptions to characterize the asymptotic size and power properties of our test .",
    "[ th : critval ] let the conditions imposed in theorem [ th : localdrift](i ) and theorem [ th : coupsmooth ] hold .",
    "( i ) if in addition assumption [ ass : equic ] is satisfied , then we can conclude that @xmath628 ( ii ) if assumption [ ass : equic ] and the conditions of theorem [ th : noineq](i ) hold and @xmath356 , then @xmath629 ( iii ) let @xmath630\\|_{l^2_p}\\ } \\geq m\\gamma_n\\}$ ] for @xmath631 . if in addition assumption [ ass:4pow ] holds , then @xmath632    the first claim of theorem [ th : critval ] exploits theorems [ th : localdrift](i ) and [ th : coupsmooth ] to show that the proposed test delivers asymptotic size control . in turn , theorem [ th : critval](ii ) leverages theorems [ th : localdrift](ii ) and [ th : noineq](ii ) to conclude that the asymptotic size of the proposed test can equal its significance level when no inequality constraints are present and either the model is linear or the rate of convergence @xmath318 is sufficiently fast . under the latter structure",
    "it is also possible to obtain the same conclusion employing analytical critical by exploiting theorem [ th : noineq](ii ) ; see remark [ rm : piv ] .",
    "finally , theorem [ th : critval](iii ) characterizes local sequences @xmath633 for which our test has nontrivial local power .",
    "[ rm : piv ] when @xmath275 is a singleton @xmath634 for all @xmath287 , theorem [ th : noineq](ii ) provides conditions under which the bootstrap statistic is in fact coupled to the square root of a chi - squared random variable .",
    "for @xmath635 the @xmath608 quantile of a chi - squared random variable with @xmath585 degrees of freedom it is then possible to show that @xmath636 where recall @xmath582 . as in theorem",
    "[ th : critval](ii ) , however , we emphasize such a conclusion does not apply to nonlinear problems in which the rate of convergence is not sufficiently fast , or to hypotheses involving inequality restrictions .",
    "[ rm : noprobint ] in the conditional moment inequalities literature , certain test statistics have been shown to converge in probability to zero when all inequalities are  slack \" @xcite .",
    "it is worth noting that an analogous problem , which could potentially conflict with assumption [ ass : equic ] , is not automatically present in our setting .",
    "in particular , we observe that since @xmath637 , lemma [ lm : localprelim ] implies @xmath638 and that under regularity conditions the right hand side of is non - degenerate when @xmath639 ; see also our simulations of a test of monotonicity in section [ sec : sim ] .",
    "we examine the finite sample performance of the proposed test through a simulation study based on the nonparametric instrumental variable model @xmath640 where @xmath16 is an unknown function and @xmath641 = 0 $ ] for an observable instrument @xmath642 . in order to illustrate the different applications of our framework , we study both a test of a shape restriction and a test on a functional of @xmath16 that imposes a shape restriction to sharpen inference .",
    "specifically , we examine the performance of a test of whether @xmath16 is monotone , and of a test that imposes monotonicity to conduct inference on the value of @xmath16 at a point .",
    "these applications are closely related to examples [ ex : slutzky ] and [ ex : rd ] and we refer the reader to their discussion in for implementation details .",
    "we consider a design in which random variables @xmath643 follow the distribution @xmath644\\right ) ~,\\ ] ] and @xmath645 are generated according to @xmath646 and @xmath647 for @xmath648 the c.d.f . of a standard normal random variable .",
    "the dependent variable @xmath60 is in turn created according to with the structural function @xmath16 following the specification @xmath649 for different choices of @xmath650 . for all positive values of @xmath650",
    ", the function @xmath16 is monotonically decreasing and satisfies @xmath651 .",
    "moreover , we also note @xmath652 for values of @xmath650 close to zero and @xmath653 for values of @xmath650 close to one and @xmath654 the derivative of @xmath648 .",
    "converges to the 0 and @xmath655 as @xmath650 approaches 0 and @xmath656 respectively .",
    "we find numerically , however , that @xmath657 is very close to @xmath655 for all @xmath658 $ ] for @xmath650 as small as one .",
    "] thus , by varying @xmath650 in we can examine the performance of our tests under different  strengths \" of monotonicity .",
    "all the reported results are based on five thousand replications of samples @xmath659 consisting of five hundred observations each .    as a sieve",
    "we employ b - splines @xmath660 of order three with continuous derivatives and either one or no knots , which results in a dimension @xmath661 equal to four or three respectively . since b - splines of order three have piecewise linear derivatives , monotonicity constraints are simple to implement as we only require to check the value of the derivative at @xmath662 points .",
    "the instrument transformations @xmath663 are also chosen to be b - splines of order three with continuous derivatives and either three , five , or ten knots placed at the population quantiles .",
    "these parameter choices correspond to a total number of moments @xmath177 equal to six , eight , or thirteen . the test statistic @xmath267 is then implemented with @xmath594 , and @xmath187 equal to the optimal gmm weighting matrix computed with a two stage least squares estimator constrained to satisfy the null hypothesis as a first stage . under these specifications , calculating @xmath267 simply requires solving two quadratic programming problems with linear constraints .    obtaining critical values",
    "further requires us to compute the quantiles of @xmath445 conditional on the data , which we simulate employing two hundred bootstrap samples in each replication . for the bandwidth choices , we set @xmath576 to zero which",
    ", despite being potentially conservative under partial identification , is both sufficient for size control and computationally simpler to implement . in turn",
    ", we explore data driven choices for the parameters @xmath558 and @xmath360 . specifically , setting @xmath664 and letting @xmath665 with @xmath666 , we select @xmath558 by solving @xmath667 for different choices of @xmath668 .",
    "heuristically , @xmath558 is thus the @xmath669 quantile of an estimate of the asymptotic distribution of the @xmath670 norm of the unconstrained minimizer of @xmath190 under fixed values for @xmath661 and @xmath177 .",
    "we therefore interpret @xmath671 as an  aggressive \" choice for @xmath558 and @xmath672 as a  conservative \" one . finally , for @xmath673 a @xmath674 random matrix drawn from an estimate of the asymptotic distribution of @xmath675 under fixed @xmath661 and @xmath177 asymptotics",
    ", we select @xmath360 by solving solving is simply the reciprocal of the @xmath676 quantile of @xmath677 , which we approximate using a sample of two hundred draws of @xmath678 . ]",
    "@xmath679 for different values of @xmath680 ; see remark [ rm : onellchoice ] for the rationale behinds this choice . in concordance to the choice of @xmath558 , here @xmath681 also corresponds to the  aggressive \" choice of @xmath360 and @xmath682 to the  conservative \" one .",
    "[ rm : onellchoice ] in the hypothesis testing problems of this section , the norm constraint @xmath683 in the definition of @xmath529 can be replaced by @xmath684 ; see remark [ rm : econtrol ] and the discussion of example [ ex : rd ] in .",
    "the latter constraint , however , is in turn implied by @xmath685 , which is computationally simpler to implement as it is equivalent to @xmath686 linear constraints on @xmath687 .",
    "moreover , when @xmath20 and @xmath21 are linear , the sole role of @xmath360 is to ensure @xmath442 $ ] is uniformly consistent for @xmath550 $ ]  recall section [ sec : banddisc ] . in the present context , such convergence is implied by @xmath688\\|_{\\hat \\sigma_n,2 } = o_p(a_n ) ~,\\ ] ] which motivates using to study the sensitivity of our tests to the choice of @xmath360 .",
    "ccc ccc c ccc c ccc & & & + & & & & & & & + @xmath661 & @xmath689 & @xmath690 & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 + @xmath694 & @xmath692 & @xmath692 & 0.084 & 0.044 & 0.010 & & 0.087 & 0.042 & 0.009 & & 0.095 & 0.046 & 0.009 + @xmath694 & @xmath692 & @xmath695 & 0.060 & 0.030 & 0.006 & & 0.068 & 0.033 & 0.007 & & 0.079 & 0.037 & 0.008 + @xmath694 & @xmath695 & @xmath692 & 0.083 & 0.043 & 0.010 & & 0.086 & 0.042 & 0.009 & & 0.095 & 0.046 & 0.009 + @xmath694 & @xmath695 & @xmath695 & 0.060 & 0.030 & 0.006 & & 0.068 & 0.033 & 0.007 & & 0.079 & 0.037 & 0.008 + @xmath696 & @xmath692 & @xmath692 & 0.048 & 0.023 & 0.004 & & 0.055 & 0.028 & 0.005 & & 0.070 & 0.032 & 0.006 + @xmath696 & @xmath692 & @xmath695 & 0.047 & 0.023 & 0.004 & & 0.055 & 0.027 & 0.005 & & 0.069 & 0.031 & 0.006 + @xmath696 & @xmath695 & @xmath692 & 0.047 & 0.023 & 0.004 & & 0.055 & 0.027 & 0.005 & & 0.070 & 0.032 & 0.006 + @xmath696 & @xmath695 & @xmath695 & 0.047 & 0.023 & 0.004 & & 0.055 & 0.027 & 0.005 & & 0.069 & 0.031 &",
    "0.006 +   + & & & + & & & & & & & + @xmath661 & @xmath689 & @xmath690 & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 + @xmath694 & @xmath692 & @xmath692 & 0.081 & 0.041 & 0.010 & & 0.087 & 0.041 & 0.009 & & 0.095 & 0.043 & 0.010 + @xmath694 & @xmath692 & @xmath695 & 0.075 & 0.036 & 0.008 & & 0.081 & 0.038 & 0.009 & & 0.090 & 0.042 & 0.010 + @xmath694 & @xmath695 & @xmath692 & 0.081 & 0.041 & 0.010 & & 0.087 & 0.041 & 0.009 & & 0.095 & 0.043 & 0.010 + @xmath694 & @xmath695 & @xmath695 & 0.075 & 0.036 & 0.008 & & 0.081 & 0.038 & 0.009 & & 0.090 & 0.042 & 0.010 + @xmath696 & @xmath692 & @xmath692 & 0.068 & 0.034 & 0.007 & & 0.076 & 0.037 & 0.009 & & 0.086 & 0.040 & 0.009 + @xmath696 & @xmath692 & @xmath695 & 0.068 & 0.034 & 0.007 & & 0.076 & 0.037 & 0.009 & & 0.086 & 0.039 & 0.009 + @xmath696 & @xmath695 & @xmath692 & 0.067 & 0.033 & 0.007 & & 0.076 & 0.037 & 0.009 & & 0.086 & 0.040 & 0.009 + @xmath696 & @xmath695 & @xmath695 & 0.067 & 0.033 & 0.007 & & 0.075 & 0.037 & 0.009 & & 0.086 & 0.039 &",
    "0.009 +   + & & & + & & & & & & & + @xmath661 & @xmath689 & @xmath690 & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 & & @xmath691 & @xmath692 & @xmath693 + @xmath694 & @xmath692 & @xmath692 & 0.102 & 0.050 & 0.012 & & 0.102 & 0.052 & 0.012 & & 0.109 & 0.053 & 0.011 + @xmath694 & @xmath692 & @xmath695 & 0.100 & 0.049 & 0.012 & & 0.100 & 0.050 & 0.012 & & 0.107 & 0.052 & 0.011 + @xmath694 & @xmath695 & @xmath692 & 0.102 & 0.050 & 0.012 & & 0.102 & 0.052 & 0.012 & & 0.109 & 0.053 & 0.011 + @xmath694 & @xmath695 & @xmath695 & 0.100 & 0.049 & 0.012 & & 0.100 & 0.050 & 0.012 & & 0.107 & 0.052 & 0.011 + @xmath696 & @xmath692 & @xmath692 & 0.099 & 0.049 & 0.011 & & 0.100 & 0.049 & 0.013 & & 0.103 & 0.052 & 0.011 + @xmath696 & @xmath692 & @xmath695 & 0.099 & 0.049 & 0.011 & & 0.100 & 0.049 & 0.013 & & 0.103 & 0.052 & 0.011 + @xmath696 & @xmath695 & @xmath692 & 0.099 & 0.048 & 0.011 & & 0.100 & 0.049 & 0.013 & & 0.103 & 0.052 & 0.011 + @xmath696 & @xmath695 & @xmath695 & 0.098 & 0.048 & 0.011 & & 0.100 & 0.049 & 0.013 & & 0.103 & 0.052 & 0.011 +      we begin by first examining the performance of our inferential framework when applied to test whether the structural function @xmath16 is monotonically decreasing .",
    "table [ tab : monsize ] reports the empirical size control of the resulting test under the different parameter choices .",
    "the test delivers good size control across specifications , though as expected can be undersized when the @xmath16 is  strongly \" monotonic @xmath697 .",
    "the empirical rejection rates are insensitive to the value of @xmath689 , which suggests the asymptotics of lemma [ lm : lnotbind ] are applicable and the bandwidth @xmath360 is not needed to ensure size control .",
    "in contrast , the empirical rejection rates are more responsive to the value of @xmath690 , though the  aggressive \" choice of @xmath671 is still able to deliver adequate size control even in the least favorable configuration @xmath698 .",
    "finally , we note increasing the dimension of the sieve @xmath699 can lead the test to be undersized , while increasing the number of moments @xmath700 brings the empirical size of the test closer to its nominal level .    in order to study the power of the test that @xmath16 is monotonically decreasing",
    ", we consider deviations from the constant zero function @xmath701 .",
    "specifically , we examine the rejection probabilities of the test when the data is generated according to @xmath702 for different positive values of @xmath703 .",
    "figure [ fig : monpower ] depicts the power function of a @xmath692 nominal level test implemented with @xmath704 , @xmath705 , and different number of moments @xmath177 . for the violation of decreasing monotonicity considered in",
    ", the test with fewer moments appears to be more powerful indicating the first few moments are the ones detecting the deviation from monotonicity .",
    "more generally , however , we expect the power ranking for the choices of @xmath177 to depend on the alternative under consideration .           since am spaces are not often employed in econometrics , we next provide a brief introduction that highlights the properties we need for our analysis .",
    "the definitions and results presented here can be found in chapters 8 and 9 of @xcite , and we refer the reader to said reference for a more detailed exposition . before proceeding , we first recall the definitions of a partially ordered set and a lattice :    [ def : ordered ] a _ partially ordered set _ @xmath706 is a set @xmath27 with a partial order relationship @xmath707 defined on it ",
    "i.e. @xmath707 is a transitive @xmath708 , reflexive @xmath709 , and antisymmetric @xmath710 relation .      whenever @xmath27 is both a vector space and a lattice , it is possible to define objects that depend on both the vector space and lattice operations .",
    "in particular , for @xmath714 the positive part @xmath715 , the negative part @xmath716 , and the absolute value @xmath717 are defined by @xmath718 in addition , it is natural to demand that the order relation @xmath707 interact with the algebraic operations of the vector space in a manner analogous to that of @xmath34  i.e. to expect @xmath719 a complete normed vector space that shares these familiar properties of @xmath34 under a given order relation @xmath707 is referred to as a _ banach lattice_. formally , we define :      an am space , is then simply a banach lattice in which the norm @xmath33 is such that the maximum of the norms of two positive elements is equal to the norm of the maximums of the two elements ",
    "e.g. @xmath722 under pointwise ordering .",
    "the norm having such property is called the m - norm .      in certain banach lattices there",
    "may exist an element @xmath725 called an _ order unit _ such that for any @xmath726 there exists a @xmath727 for which @xmath728  for example , in @xmath201 the vector @xmath729 is an order unit .",
    "the order unit @xmath32 can be used to define @xmath730 which is easy to see constitutes a norm on the original banach lattice @xmath27 . in principle , the norm @xmath53 need not be related to the original norm @xmath33 with which @xmath27 was endowed .",
    "fortunately , however , if @xmath27 is an am space , then the original norm @xmath33 and the norm @xmath53 are equivalent in the sense that they generate the same topology @xcite .",
    "hence , without loss of generality we refer to @xmath27 as an _ am space with unit _",
    "if these conditions are satisfied : ( i ) @xmath27 is an am space , ( ii ) @xmath32 is an order unit in @xmath27 , and ( iii ) the norm of @xmath27 equals @xmath53 ( as in ) .      :",
    "contains the proofs of the results in section [ sec : consrates ] concerning consistency of the set estimator ( lemma [ lm : setcons ] ) and its rates of convergence ( theorem [ th : setrates ] ) . :",
    "develops the proofs for the results in section [ sec : strongapprox ] , including the preliminary local approximation ( lemma [ lm : localprelim ] ) and the final drift linearization ( theorem [ th : localdrift ] ) .    :",
    "contains the proofs for all results in section [ sec : boot ] , including the lower bound for the bootstrap statistic ( theorem [ th : coupsmooth ] ) , conditions under which the lower bound coupling is  sharp \" ( theorem [ th : noineq ] ) , and the analysis of the test that compares the proposed test statistic to the quantiles of the bootstrap distribution ( theorem [ th : critval ] ) .",
    ": develops the auxiliary results concerning the approximation of the local parameter space .",
    "these results depend on the characterization of @xmath14 only , and thus may be of independent interest as they are broadly applicable to hypotheses testing problems similarly concerned with examining equality and inequality restrictions .",
    ": provides primitive conditions for the validity of the gaussian multiplier bootstrap as imposed in assumption [ ass : bootcoupling ] .",
    "these results more generally provide sufficient conditions for the gaussian multiplier bootstrap to be consistent for the law of the empirical process over expanding classes @xmath215 , and may be of independent interest . the arguments in this appendix",
    "can also be employed to obtain alternative sufficient conditions for assumption [ ass : coupling ] that complement those in .",
    "proof of lemma [ lm : setcons ] : first fix @xmath284 and notice that by definition of @xmath273 we have @xmath731 for all @xmath179 and all @xmath287 .",
    "moreover , setting @xmath732\\| _ { \\hat \\sigma_n , r}$ ] , it then follows from lemmas [ aux : suppq ] and [ aux : weights ] , and markov s inequality that @xmath733 uniformly in @xmath287 .",
    "in addition , by similar arguments we obtain uniformly in @xmath287 @xmath734 where the second inequality results from assumption [ ass : keycons](i ) and the equality follows from lemma [ aux : weights ] . for conciseness set @xmath735",
    ". then note that combining results , , and we can conclude that @xmath736 next note that for any @xmath737 we have @xmath738 ( provided @xmath739 exists ) .",
    "thus , by assumption [ ass : keycons](ii ) and lemma [ aux : weights ] we obtain for any @xmath740 @xmath741 which together with establishes the first claim of the lemma .    in order to establish",
    ", we employ the definition of @xmath273 to obtain for all @xmath287 @xmath742 therefore , setting @xmath743 , exploiting lemmas [ aux : suppq ] and [ aux : weights ] , and the definition of @xmath275 we then obtain uniformly in @xmath287 that @xmath744\\|_r + o_p(\\delta_n ) = o_p(\\zeta_{n } + \\delta_n ) ~.\\end{gathered}\\ ] ] hence , follows from results , and @xmath745 .",
    "proof of theorem [ th : setrates ] : to begin , we first define the event @xmath746 where @xmath747 where recall @xmath748 . moreover ,",
    "note that for any @xmath284 and @xmath277 sufficiently large , lemmas [ lm : setcons ] and [ aux : weights ] imply @xmath749 hence , for @xmath750 we obtain for any @xmath751 that @xmath752 by result .",
    "next , for each @xmath287 , partition @xmath753 into @xmath754 since @xmath755 with probability tending to one uniformly in @xmath287 by , it follows from the definition of @xmath274 and result that @xmath756 in addition , letting @xmath757 , we obtain from , lemma [ aux : suppq ] , and the definition of @xmath758 in assumption [ ass : keycons](i ) that under the event @xmath759 @xmath760 therefore , exploiting result and that holds under @xmath759 we can conclude @xmath761 further note that for any @xmath762 , @xmath763 under the event @xmath759 . therefore , lemma [ aux : suppq ] implies that under the event @xmath759 @xmath764\\|_r - b \\times \\mathcal z_{n , p } ~.\\end{gathered}\\ ] ] moreover , since @xmath765 , definition implies that for @xmath766 sufficiently large @xmath767 thus , @xmath768 , assumption [ ass : keyrate ] , and imply for @xmath766 large that @xmath769\\|_r \\geq \\frac{2^{(j-2)}}{\\eta_n\\nu_n } ~.\\ ] ] hence , we can conclude from results , , and that we must have @xmath770 where in the final inequality we exploited that the definition of @xmath771 implies @xmath772 and @xmath773 .",
    "therefore , @xmath774 , lemma [ aux : suppq ] , and markov s inequality yield @xmath775 where in the final result we used @xmath776 , and that @xmath777 .",
    "hence , the first claim of the theorem follows from and .    to establish the second claim ,",
    "define the event @xmath778 .",
    "since @xmath779 whenever @xmath780 occurs , we obtain from lemma [ lm : setcons ] @xmath781 due to result .",
    "therefore , the second claim of the theorem follows from .",
    "[ aux : simpbracket ] let assumption [ ass : instreg](i ) hold , and define the class of functions @xmath782 then , it follows that @xmath217}(\\epsilon , \\mathcal g_n,\\|\\cdot\\|_{l^2_p } ) \\leq k_n \\times n_{[\\hspace{0.02 in}]}(\\epsilon / b_n , \\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] for all @xmath254 .",
    "proof : note that by assumption [ ass : instreg](i ) we have @xmath783 for all @xmath246 and @xmath784 , and define @xmath785 and @xmath786 . if @xmath787\\}_i$ ] is a collection of brackets for @xmath215 with @xmath788 for all @xmath131 , then it follows that the following collection of brackets covers the class @xmath789 @xmath790\\}_{i , k,\\jmath } ~.\\ ] ] moreover , since @xmath791 by construction , we also obtain from that @xmath792 since there are @xmath793}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] brackets in , we can conclude from @xmath794}(\\epsilon,\\mathcal g_n,\\|\\cdot\\|_{l^2_p } ) \\leq k_n \\times",
    "n_{[\\hspace{0.02 in}]}(\\frac{\\epsilon}{b_n},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) ~,\\ ] ] for all @xmath254 , which establishes the claim of the lemma .",
    "[ aux : suppq ] let @xmath732\\|_{\\hat \\sigma_n , r}$ ] , and assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg](ii)-(iii ) hold . then , for each @xmath254 there are random @xmath795 with @xmath796 for all @xmath346 and in addition @xmath797 = o(k_n^{1/r}\\sqrt{\\log(k_n)}j_nb_n/\\sqrt n)$ ] .",
    "proof : let @xmath798 .",
    "note that by assumption [ ass : instreg](i ) , @xmath799 for all @xmath246 and @xmath784 .",
    "hence , letting @xmath251 be the envelope for @xmath215 , as in assumption [ ass : processreg](ii ) , it follows that @xmath800 is an envelope for @xmath789 satisfying @xmath801 < \\infty$ ] .",
    "thus , @xmath802 \\lesssim \\sup_{p\\in \\mathbf",
    "p}j_{[\\hspace{0.02 in}]}(\\|g_n\\|_{l^2_p},\\mathcal g_n,\\|\\cdot\\|_{l^2_p } ) ~.\\ ] ] by theorem 2.14.2 in @xcite .",
    "moreover , also notice that lemma [ aux : simpbracket ] , the change of variables @xmath803 and @xmath248 imply @xmath804}(\\|g_n\\|_{l^2_p},\\mathcal g_n,\\|\\cdot\\|_{l^2_p } ) \\leq \\sup_{p\\in \\mathbf p } \\int_0^{\\|g_n\\|_{l^2_p } } \\sqrt{1 + \\log ( k_n n_{[\\hspace{0.02 in}]}(\\epsilon / b_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p}))}d\\epsilon \\\\ \\leq ( 1+\\sqrt{\\log ( k_n)})b_n \\times \\sup_{p\\in \\mathbf p } j_{[\\hspace{0.02 in}]}(\\|f_n\\|_{l^2_p},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(\\sqrt{\\log(k_n)}b_nj_n ) ~,\\end{gathered}\\ ] ] where the final equality follows from assumption [ ass : processreg](iii ) .",
    "next define @xmath795 by @xmath805 and note and imply @xmath797 = o(k_n^{1/r}\\sqrt { \\log(k_n)}b_nj_n/\\sqrt n)$ ] as desired .",
    "since we also have that @xmath806 for all @xmath346 by definition of @xmath789 , we can in turn conclude by direct calculation @xmath807 which establishes the claim of the lemma .",
    "proof : first note that by assumption [ ass : weights](iii ) there exists a @xmath808 such that @xmath810 next , let @xmath811 denote the @xmath812 identity matrix and for each @xmath254 rewrite @xmath187 as @xmath813 by theorem 2.9 in @xcite , the matrix @xmath814 is invertible and the operator norm of its inverse is bounded by two when @xmath815 . since by assumption",
    "[ ass : weights](ii ) and the equality in it follows that @xmath187 is invertible if and only if @xmath814 is invertible , we obtain that @xmath816 where we exploited @xmath817 and .",
    "hence , since @xmath818 for all @xmath254 and @xmath179 , and yield @xmath819 finally , since @xmath820 by , result implies that @xmath821 where the equality , and hence the lemma , follows from assumption [ ass : weights](i ) .",
    "proof : the case @xmath825 trivially follows from @xmath826 for all @xmath822 . for the case @xmath827 , let @xmath828 and note that by hlder s inequality we can obtain that @xmath829 thus , the claim of the lemma for @xmath827 follows from taking the @xmath830 power in .",
    "proof of lemma [ lm : localprelim ] : first note that the existence of the required sequence @xmath355 is guaranteed by assumption [ ass : locrates](i ) .",
    "next , for @xmath831 let @xmath832 satisfy @xmath833 applying theorem [ th : setrates ] with @xmath834 and noting @xmath835 , then yields that @xmath836 uniformly in @xmath287 .",
    "hence , defining for each @xmath287 the shrinking neighborhood @xmath837 , we obtain @xmath838 uniformly in @xmath287 due to @xmath356 , @xmath831 , and results and .",
    "defining @xmath839 we also obtain from assumption [ ass : coupling ] and lemmas [ aux : weights ] and [ lm : geninf ] that uniformly in @xmath287 @xmath840 and [ lm : geninf ] together with lemma [ lm : locprocess ] and @xmath360 satisfying @xmath357}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] by hypothesis yields @xmath841 uniformly in @xmath287 .",
    "thus , the lemma follows from results , , and together with lemma [ lm : locsigma ] .",
    "proof of theorem [ th : localdrift ] : first we note that assumption [ ass : keycons](i ) implies @xmath842 therefore , lemma [ lm : obviousineq ] , result , and the law of iterated expectations yield that for all @xmath287 , @xmath482 , and @xmath843 we must have @xmath844\\|_r \\\\",
    "\\leq \\|\\sqrt n",
    "\\{p\\rho(\\cdot,\\theta_0 + \\frac{h}{\\sqrt n } ) * q_n^{k_n } - p\\rho(\\cdot,\\theta_0 ) * q_n^{k_n}\\ } - \\mathbb d_{n ,",
    "p}(\\theta_0)[h]\\|_2 + \\sqrt n \\zeta_n ~.\\end{gathered}\\ ] ] moreover , lemma [ aux : bessel ] and the maps @xmath845 satisfying assumption [ ass : driftlin](i ) imply @xmath846 , q_{k , n,\\jmath}\\rangle_{l^2_p}^2   \\nonumber \\\\ & \\leq   \\sum_{\\jmath = 1}^{\\mathcal j } c_0\\|\\sqrt n\\{m_{p,\\jmath}(\\theta_0 + \\frac{h}{\\sqrt n } ) - m_{p,\\jmath } ( \\theta_0)- \\nabla m_{p,\\jmath}(\\theta_0)[\\frac{h}{\\sqrt n}]\\}\\|_{l^2_p}^2 \\nonumber\\\\ & \\leq   \\sum_{\\jmath = 1}^{\\mathcal j } c_0k_m^2\\times n \\times \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf l}^2 \\times \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf e}^2\\end{aligned}\\ ] ] for some constant @xmath847 and all @xmath287 , @xmath425 , and @xmath848 .",
    "therefore , by results and , and the definition of @xmath849 in we get @xmath850\\|_r \\\\",
    "\\leq \\sqrt { \\mathcal j c_0}k_m\\times \\sqrt n   \\times \\ell_n^2\\times \\mathcal s_n(\\mathbf l,\\mathbf e ) +   \\sqrt n \\zeta_n =   o(a_n)\\end{gathered}\\ ] ] due to @xmath851 by hypothesis and @xmath852 by assumption [ ass : locrates](ii ) .",
    "next , note that since @xmath853}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] , assumption [ ass : locrates](i ) implies there is a sequence @xmath854 satisfying the conditions of lemma [ lm : localprelim ] and @xmath855 .",
    "therefore , applying lemma [ lm : localprelim ] we obtain that @xmath856 moreover , since @xmath855 implies @xmath857 for all @xmath346 , we have @xmath858\\|_{\\sigma_n(p),r } +   o_p(a_n)\\end{aligned}\\ ] ] uniformly in @xmath287 , with the final equality following from , assumption [ ass : weights](iii ) and lemma [ lm : geninf ] .",
    "thus , the first claim of the theorem follows from and , while the second follows by noting that if @xmath859 , then we may set @xmath360 to simultaneously satisfy the conditions of lemma [ lm : localprelim ] and @xmath860 , which obviates the need to introduce @xmath854 in and .",
    "proof : fix @xmath867 , and let @xmath868 satisfy @xmath869 .",
    "then , @xmath870 where the second result follows from the triangle inequality , and the final result from @xmath871 for any @xmath872 . in turn , by identical manipulations we also have @xmath873 thus , since @xmath623 was arbitrary , the lemma follows from results and .",
    "[ lm : locprocess ] let assumptions [ ass : instreg](i ) , [ ass : weights ] , and [ ass : rhocontrol](i ) hold . if @xmath874 is such that @xmath875}(\\delta_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] , then uniformly in @xmath254 : @xmath876    proof : since @xmath877 for all @xmath246 and @xmath784 by assumption [ ass : instreg](i ) , assumption [ ass : rhocontrol](i ) yields for any @xmath254 , @xmath346 , and @xmath878 that @xmath879 \\leq k_\\rho^2b_n^2 \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf e}^{2\\kappa_\\rho } \\leq k_\\rho^2 b_n^2 \\delta_n^{2\\kappa_\\rho } ~.\\ ] ] next , define the class of functions @xmath880 , and note that implies that for all @xmath246 and @xmath254 @xmath881 hence , since @xmath882 for any @xmath762 , yields @xmath883 moreover , corollary 2.2.8 in @xcite implies that @xmath884 \\\\",
    "\\leq \\sup_{p\\in \\mathbf p } c_0 \\int_0^{k_\\rho b_n\\delta_n^{\\kappa_\\rho } } \\sqrt{\\log n_{[\\hspace{0.02 in}]}(\\epsilon/2,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon\\end{gathered}\\ ] ] for some @xmath847 . in turn , lemma [ aux : simpbracket ] and the change of variables @xmath885 yields @xmath886}(\\epsilon/2,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon \\nonumber \\\\ & \\leq \\sup_{p\\in \\mathbf p}\\sqrt{\\log(k_n ) } \\int_0^{k_\\rho b_n \\delta_n^{\\kappa_\\rho } } \\sqrt{1 + \\log n_{[\\hspace{0.02 in}]}(\\epsilon/2b_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon \\nonumber \\\\ & \\leq \\sup_{p\\in \\mathbf p}2\\sqrt{\\log(k_n)}b_n \\int_0^{k_\\rho \\delta_n^{\\kappa_\\rho}/2 } \\sqrt{1 + \\log n_{[\\hspace{0.02 in}]}(u,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})}du ~.\\end{aligned}\\ ] ] however , since @xmath217}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] is a decreasing function of @xmath218 , we can also conclude @xmath887}(u,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})}du \\\\",
    "\\leq \\max\\{\\frac{k_\\rho}{2},1\\ } \\times \\sup_{p\\in \\mathbf p } j_{[\\hspace{0.02 in}]}(\\delta_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p})\\end{gathered}\\ ] ] by definition of @xmath888}(\\delta,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] .",
    "therefore , the lemma follows from , @xmath889 by lemma [ aux : weights ] , and markov s inequality combined with results , , , and @xmath357}(\\delta_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n)$ ] by hypothesis .",
    "[ lm : locsigma ] let assumptions [ ass : instreg](i ) , [ ass : processreg](ii ) , [ ass : weights ] , [ ass : keycons](i ) , and [ ass : locrates](ii)-(iii ) hold . for any sequence @xmath874",
    "it then follows that uniformly in @xmath287 we have @xmath890    proof : first note that by assumptions [ ass : weights](ii ) there exists a constant @xmath847 such that @xmath891 for all @xmath179 and @xmath254 .",
    "thus , we obtain @xmath892 by the triangle inequality .",
    "moreover , since @xmath893 for all @xmath16 , we also have that @xmath894 hence , lemma [ aux : tailbound ] , markov s inequality , and assumptions [ ass : keycons](i ) and [ ass : locrates](ii ) establish @xmath895 uniformly in @xmath287 .",
    "therefore , , , , and assumption [ ass : locrates](iii ) imply @xmath896 uniformly in @xmath287 . the reverse inequality to follows by identical arguments but relying on lemma [ aux : weights ] implying @xmath889 and @xmath897 uniformly in @xmath254 rather than on @xmath891 .",
    "proof : define the class @xmath900 , and note @xmath901 for any @xmath822 implies that for any @xmath254 we have @xmath902 \\leq k_n^{1/r } e_p[\\sup_{g\\in \\mathcal g_n } |\\mathbb w_{n , p}g| ] \\\\",
    "\\leq k_n^{1/r}\\{e_p[|\\mathbb w_{n , p}g_0| ] + c_1 \\int_0^\\infty \\sqrt { \\log n_{[\\hspace{0.03 in } ] } ( \\epsilon/2,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon\\ } ~,\\end{gathered}\\ ] ] where the final inequality holds for any @xmath903 and some @xmath904 by corollary 2.2.8 in @xcite .",
    "next , let @xmath905 for @xmath251 as in assumption [ ass : processreg](ii ) and note assumption [ ass : instreg](i ) implies @xmath906 is an envelope for @xmath789 .",
    "thus @xmath907 $ ] is a bracket of size @xmath908 covering @xmath789 , and hence the change of variables @xmath909 yields @xmath910}(\\epsilon/2,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon \\\\ = 2\\int_0^{2\\|g_n\\|_{l^2_p } } \\sqrt { 1+\\log n_{[\\hspace{0.03 in}]}(u,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}du \\leq c_2 \\sqrt{\\log(k_n)}b_nj_n ~,\\end{gathered}\\ ] ] where the final inequality holds for some @xmath911 by result and @xmath912}(u,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})$ ] being decreasing in @xmath913 . furthermore , since @xmath914 \\leq \\|g_0\\|_{l^2_p } \\leq \\|g_n\\|_{l^2_p}$ ] we have @xmath915 \\leq \\|g_n\\|_{l^2_p } \\\\",
    "\\leq \\int_0^{\\|g_n\\|_{l^2_p } } \\sqrt { 1+\\log n_{[\\hspace{0.03 in}]}(u,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})}du ~.\\ ] ] thus , the claim of the lemma follows from , , and .",
    "[ aux : bessel ] let assumption [ ass : instreg](ii ) hold .",
    "it then follows that there exists a constant @xmath299 such that for all @xmath254 , @xmath916 , @xmath917 , and functions @xmath437 we have @xmath918)^2 ] ~.\\ ] ]    proof : let @xmath919 denote the subspace of @xmath226 consisting of functions depending on @xmath159 only , and set @xmath920 , where @xmath921 . for any sequence @xmath922 , then define the map @xmath923 by @xmath924 clearly , the maps @xmath925 are linear , and moreover we note that by assumption [ ass : instreg](ii ) there exists a constant @xmath299 such that the largest eigenvalue of @xmath249 $ ] is bounded by @xmath464 for all @xmath916 and @xmath254 .",
    "therefore , we obtain @xmath926 \\leq   \\sup_{\\{c_k\\ } : \\sum_k c_k^2 = 1 } c\\sum_{k=1}^\\infty c_k^2 = c\\end{gathered}\\ ] ] which implies @xmath927 is continuous .",
    "next , define @xmath928 to be given by @xmath929 and note @xmath930 is the adjoint of @xmath927 .",
    "therefore , since @xmath931 by theorem 6.5.1 in @xcite , we obtain for any @xmath254 , @xmath932 , and @xmath933 @xmath934 therefore , since @xmath935 = e_p[e_p [ f(v_i)|z_{i,\\jmath } ] q_{k , n,\\jmath}(z_{i,\\jmath})]$ ] for any @xmath936 , setting @xmath937 $ ] in and exploiting yields the lemma .",
    "proof of theorem [ th : coupsmooth ] : first note that lemma [ lm : simcoup ] implies that uniformly in @xmath287 @xmath938\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\ ] ] thus , we may select @xmath508 and @xmath939 so that uniformly in @xmath287 @xmath940\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\ ] ] to proceed , note that by assumptions [ ass : locrates](i ) and [ ass : bootrates](ii)-(iv ) we may select a @xmath941 so that @xmath942 , @xmath943 , @xmath944 , and @xmath945}(\\delta_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) =   o(a_n ) ~ . \\label{th : coupsmooth3p3}\\end{aligned}\\ ] ]    next , notice that theorem [ th : setrates ] implies that there exist @xmath946 such that @xmath947 uniformly in @xmath948 .",
    "further note that since @xmath949 for all @xmath784 by assumption [ ass : instreg](i ) , we obtain from assumption [ ass : rhocontrol](i ) , result and @xmath950 that with probability tending to one uniformly in @xmath287 we have @xmath951 \\leq b_n^2k_\\rho^2\\delta_n^{2\\kappa_\\rho } ~.\\ ] ] hence , letting @xmath952 , we obtain from @xmath258 being uniformly bounded by assumption [ ass : weights](iii ) , results - , markov s inequality , and @xmath941 satisfying that uniformly in @xmath254 @xmath953 similarly , since @xmath954 with probability tending to one uniformly in @xmath287 by lemma [ lm : setcons ] , we can exploit lemma [ aux : dererror ] to obtain for some @xmath299 that @xmath955 - \\mathbb d_{n , p}(\\hat \\theta_n)[\\hat h_n ] \\|_{\\sigma_n(p),r } \\leq \\|\\sigma_n(p)\\|_{o , r } \\times c k_m\\|\\hat \\theta_n - \\theta_{0n}\\|_{\\mathbf l } \\|\\hat h\\|_{\\mathbf e } +   o_p(a_n ) \\\\",
    "\\leq \\|\\sigma_n(p)\\|_{o , r } \\times c k_mk_b \\mathcal s_n(\\mathbf l , \\mathbf e ) \\delta_n   \\ell_n\\sqrt n + o_p(a_n ) = o_p(a_n)\\end{gathered}\\ ] ] where the second inequality follows from @xmath956 due to @xmath939 , @xmath957 by assumption [ ass : extra](i ) , and @xmath958 . in turn",
    ", the final result in is implied by and @xmath258 being uniformly bounded due to assumption [ ass : weights](iii ) .",
    "next , we note that and @xmath944 imply @xmath959 uniformly in @xmath287 .",
    "thus , since @xmath960 , @xmath961 , and @xmath962 by assumption [ ass : bootrates](iii ) , we obtain @xmath963 for @xmath179 sufficiently large .",
    "hence , applying theorem [ th : localsmooth ] and exploiting assumption [ ass : extra](ii ) , and @xmath964 for all @xmath489 and @xmath254 by assumption [ ass : extra](i ) , we obtain that there is an @xmath965 for which with probability tending to one uniformly in @xmath287 @xmath966 in particular , it follows from assumption [ ass : bootrates](ii ) and that we may find a @xmath967 such that @xmath968 uniformly in @xmath287 , and hence assumption [ ass : weights](iii ) , lemma [ aux : dererror ] , and @xmath447 by assumption [ ass : extra](i ) yield @xmath969 - \\mathbb d_{n , p}(\\theta_{0n})[h_{0n}]\\|_{\\sigma_n(p),r } \\leq \\|\\sigma_n(p)\\|_{o , r}\\times cm_m\\|\\hat h - h_{0n}\\|_{\\mathbf e } = o_p(a_n)\\ ] ] uniformly in @xmath287 .",
    "therefore , combining results , , , and together with @xmath970 and @xmath971 imply @xmath972\\|_{\\sigma_n(p),r } + o_p(a_n ) \\\\",
    "\\geq \\inf_{\\theta \\in \\theta_{0n}(p)\\cap r } \\inf_{\\frac{h}{\\sqrt n } \\in v_{n}(\\theta,2k_b \\ell_n ) } \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta)*q^{k_n}_n + \\mathbb d_{n , p}(\\theta)[h]\\|_{\\sigma_n(p),r } + o_p(a_n)\\end{gathered}\\ ] ] uniformly in @xmath287 , thus establishing the claim of the theorem .",
    "proof of theorem [ th : noineq ] : first set @xmath973 , @xmath572 for all @xmath79 , and note that @xmath974 moreover , also note assumption [ ass : locineq ] is automatically satisfied with @xmath975 and @xmath500 = 0 $ ] for all @xmath976 , while assumption [ ass : ineqlindep ] holds with @xmath977 and @xmath978 .",
    "similarly , since @xmath520 , definition implies @xmath574 for all @xmath79 , and hence @xmath979 furthermore , since holds for any @xmath558 , we may set @xmath558 so assumption [ ass : bootrates](iii ) holds .",
    "thus , it follows that we may apply theorem [ th : coupsmooth ] to obtain uniformly in @xmath287 @xmath980\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\ ] ]    next , note that since @xmath577 by hypothesis , we have @xmath981 by lemma [ lm : setcons](ii ) . for notational simplicity",
    "define @xmath982 , and then note that @xmath983 for any @xmath377 satisfying @xmath984 . thus , we obtain by definitions of @xmath347 and @xmath985 that for any @xmath254 and @xmath346 we have @xmath986 therefore , lemma [ lm : simcoup ] and results and imply that uniformly in @xmath287 @xmath987\\|_{\\sigma_n(p),r } +   o_p(a_n ) ~.\\ ] ] furthermore , we also note that the definition of @xmath988 and assumption [ ass : extra](i ) yield @xmath989 for any @xmath377 , which implies @xmath990 , and thus @xmath991 . hence , since @xmath586",
    ", we have @xmath992 .",
    "similarly , assumption [ ass : bootrates](ii ) implies @xmath993}(\\ell_n^{\\kappa_\\rho}\\vee ( \\ell_n \\eta_n)^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] and @xmath994 .",
    "thus , applying lemma [ lm : samerates ] with @xmath995 and @xmath996 yields @xmath997\\|_{\\sigma_n(p),r } \\\\",
    "= \\inf_{\\theta \\in \\theta_{0n}(p ) \\cap r}\\inf_{\\frac{h}{\\sqrt",
    "n } \\in v_{n}(\\theta,2k_b\\ell_n ) } \\|\\mathbb w^\\star_{n , p}\\rho(\\cdot,\\theta ) * q_{n}^{k_n } + \\mathbb d_{n , p}(\\theta)[h]\\|_{\\sigma_n(p),r } +   o_p(a_n)\\end{gathered}\\ ] ] uniformly in @xmath287 .",
    "hence , results , , and allow us to conclude @xmath998\\|_{\\sigma_n(p),r } + o_p(a_n)\\ ] ] uniformly in @xmath287 , which establishes the first claim of the theorem .    in order to establish the second claim of the theorem",
    ", we first define the set @xmath999= 0 \\text { and } \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b } \\leq \\ell \\ } ~.\\ ] ] next , note that since @xmath579 , theorem [ th : setrates ] yields uniformly in @xmath287 @xmath1000 furthermore , since @xmath1001 , assumptions [ ass : locrates](i ) and [ ass : bootrates](ii ) imply there is a @xmath874 satisfying - , @xmath958 , and @xmath1002 moreover , identical arguments to those employed in , , and yield @xmath1003 - \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } & =   o_p(a_n ) \\label{th : noineq13p2 }",
    "\\\\ \\sup_{\\theta \\in \\hat \\theta_n \\cap r } \\|\\theta -\\theta_{0n}(p)\\|_{\\mathbf b } \\times \\ { \\mathcal s_n(\\mathbf b , \\mathbf e)\\}^{-1 } & = o_p(\\delta_n ) \\label{th : noineq13p3}\\end{aligned}\\ ] ] uniformly in @xmath287 .",
    "therefore , we can conclude from lemma [ lm : simcoup ] and results and that we may select a @xmath508 so that uniformly in @xmath948 @xmath1004\\|_{\\sigma_n(p),r } + o_p(a_n ) \\\\",
    "= \\inf_{\\frac{h}{\\sqrt n } \\in \\hat v_n(\\hat \\theta_n,\\ell_n ) } \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta_{0n}(p ) ) * q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\end{gathered}\\ ] ]    we next proceed by establishing upper and lower bounds for the right hand side of . to this end , note that by , we may select a @xmath1005 so that @xmath1006\\|_{\\sigma_n(p),r } + o_p(a_n)\\ ] ] uniformly in @xmath287 . also observe that the final equality in , result , and lemma [ lm : auxnullspace ] ( see ) imply that there exist @xmath740 and @xmath1007 in @xmath1008 such that with probability tending to one uniformly in @xmath287 we have @xmath1009 thus , we obtain from , @xmath1010 , @xmath258 being uniformly bounded by assumption [ ass : weights](iii ) , and lemma [ aux : dererror ] that uniformly in @xmath287 @xmath1011 - \\mathbb d_{n , p}(\\theta_{0n}(p))[\\tilde h_{ln}]\\|_{\\sigma_n(p),r } \\leq \\|\\sigma_n(p)\\|_{o , r } \\times c m_m\\|\\hat h_{ln } - \\tilde h_{ln}\\|_{\\mathbf e } \\\\",
    "\\lesssim \\ell_n ( \\ell_n + \\delta_n \\times \\mathcal s_n(\\mathbf b , \\mathbf e))\\sqrt n1\\{k_f > 0\\ } + o_p(a_n ) = o_p(a_n ) ~,\\end{gathered}\\ ] ] where the final equality follows by and @xmath1012 by assumption [ ass : bootrates](ii ) .",
    "hence , , , and @xmath1013 yield uniformly in @xmath287 @xmath1014\\|_{\\sigma_n(p),r } + o_p(a_n ) \\\\",
    "\\geq \\inf_{\\frac{h}{\\sqrt n }",
    "\\in n_n(\\theta_{0n}(p),2\\ell_n ) } \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta_{0n}(p ) ) * q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\end{gathered}\\ ] ]    to establish an upper bound for , let @xmath1015 satisfy @xmath1016\\|_{\\sigma_n(p),r }   \\\\ = \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[\\hat h_{un}]\\|_{\\sigma_n(p),r } + o_p(a_n)\\end{gathered}\\ ] ] uniformly in @xmath287 .",
    "next note that by lemma [ lm : auxnullspace ] ( see ) , the final equality in , and we may pick a @xmath1017 such that for some @xmath1018 @xmath1019 with probability tending to one uniformly in @xmath287 . therefore , exploiting lemma [ aux : dererror ] , @xmath258 being uniformly bounded by assumption [ ass : weights](iii ) , result , and @xmath1020 implies that uniformly in @xmath287 @xmath1021 - \\mathbb d_{n , p}(\\theta_{0n}(p))[\\tilde h_{un}]\\|_{\\sigma_n(p),r } \\leq \\|\\sigma_n(p)\\|_{o , r}\\times cm_m\\|\\hat h_{un } - \\tilde h_{un}\\|_{\\mathbf e } \\\\",
    "\\lesssim \\ell_n(\\ell_n + \\delta_n \\times \\mathcal s_n(\\mathbf b,\\mathbf e))\\sqrt n",
    "1\\{k_f > 0\\ } + o_p(a_n ) =   o_p(a_n ) ~,\\end{gathered}\\ ] ] where in the final equality we exploited @xmath1022 by assumption [ ass : bootrates](ii ) and @xmath941 satisfying .",
    "hence , we conclude uniformly in @xmath287 that @xmath1023\\|_{\\sigma_n(p),r } + o_p(a_n ) \\\\",
    "= \\inf_{\\frac{h}{\\sqrt n } \\in n_n(\\theta_{0n}(p),\\frac{\\ell_n}{2 } ) } \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~,\\end{gathered}\\ ] ] where the inequality follows from and @xmath1024 , while the equality is implied by results and .",
    "finally , we obtain from results and together with lemma [ lm : notbinding](i ) that @xmath1025\\|_{\\sigma_n(p),r } + o_p(a_n)\\ ] ] uniformly in @xmath287 . setting @xmath1026 \\text { for some } h\\in \\mathbf b_n \\cap \\mathcal n(\\nabla \\upsilon_f(\\theta_{0n}(p)))\\}$ ] ,",
    "then note that @xmath1027 is a vector subspace of @xmath593 by linearity of @xmath1028 and its dimension for @xmath179 sufficiently large is equal to @xmath582 by lemma [ lm : notbinding](ii ) and @xmath257 being full rank by assumption [ ass : weights](iii ) . letting @xmath1029 denote a standard normal random variable",
    ", we then obtain from @xmath594 , @xmath580 , and that uniformly in @xmath287 @xmath1030 where the final equality follows by observing that the projection of @xmath1031 onto @xmath1027 can be written as @xmath1032 for some @xmath186 idempotent matrix @xmath1033 of rank @xmath1034 .",
    "proof of lemma [ lm : lnotbind ] : first , let @xmath508 and @xmath1035 be such that @xmath1036\\|_{\\hat \\sigma_n , r } \\\\",
    "= \\|\\hat { \\mathbb",
    "w}_n \\rho(\\cdot,\\hat \\theta_n)*q_n^{k_n } + \\hat { \\mathbb d}_n(\\hat \\theta_n)[\\hat h_n]\\|_{\\hat \\sigma_n , r } + o(a_n ) ~.\\end{gathered}\\ ] ] then note that in order to establish the claim of the lemma it suffices to show that @xmath1037 to this end , observe that since @xmath1038 for all @xmath346 , we obtain from the triangle inequality , @xmath889 by lemma [ aux : weights ] and assumption [ ass : bootcoupling ] that @xmath1039 \\|_{\\hat \\sigma_n , r } \\leq \\|\\hat { \\mathbb w}_n \\rho(\\cdot,\\hat \\theta_n ) * q_n^{k_n } + \\hat { \\mathbb d}_n(\\hat \\theta_n)[\\hat h_n ] \\|_{\\hat \\sigma_n , r } + \\|\\hat { \\mathbb w}_n \\rho(\\cdot,\\hat \\theta_n ) * q_n^{k_n}\\|_{\\hat \\sigma_n , r } \\\\ \\leq 2 \\|\\hat \\sigma_n\\|_{o , r } \\|\\hat { \\mathbb w}_n",
    "\\rho(\\cdot,\\hat \\theta_n)*q_n^{k_n}\\|_r + o(a_n ) \\leq   2 \\|\\hat \\sigma_n\\|_{o , r } \\|\\mathbb w_{n ,",
    "p}^\\star \\rho(\\cdot,\\hat \\theta_n ) * q_n^{k_n } \\|_r + o_p(a_n)\\end{gathered}\\ ] ] uniformly in @xmath254 . hence , since @xmath1040 almost surely , we obtain from result , @xmath889 , and lemma [ aux : tailbound ] together with markov s inequality @xmath1041 \\|_{\\hat \\sigma_n , r } \\\\ \\leq 2 \\|\\hat \\sigma_n\\|_{o , r } \\times \\sup_{\\theta \\in \\theta_n \\cap r } \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta ) * q_n^{k_n } \\|_r + o_p(a_n ) = o_p(k_n^{1/r } \\sqrt{\\log(k_n ) } b_nj_n)\\end{gathered}\\ ] ] uniformly in @xmath254 .",
    "moreover , note that since @xmath755 with probability tending to one uniformly in @xmath1042 by lemma [ lm : setcons ] , and @xmath1043 implies @xmath1044 we obtain from the first hypothesis of the lemma that @xmath1045\\|_{r } ) \\nonumber \\\\ & \\leq \\limsup_{n \\rightarrow \\infty } \\sup_{p\\in \\mathbf p_0 } p(\\ell_n \\leq \\|\\frac{\\hat h_n}{\\sqrt n}\\|_{\\mathbf b } \\text { and } \\|\\hat h_n\\|_{\\mathbf e } \\leq 2\\nu_n \\|\\hat{\\mathbb d}_{n}(\\hat",
    "\\theta_n)[\\hat h_n]\\|_{r } ) ~,\\end{aligned}\\ ] ] where the inequality follows from . hence , results and , the definitions of @xmath988 and @xmath318 , and @xmath1046 by hypothesis yield @xmath1047\\|_{r } ) = 0 ~,\\end{gathered}\\ ] ] which establishes and hence the claim of the lemma .",
    "proof of theorem [ th : critval ] : we establish the first claim by appealing to the first claim of lemma [ lm : auxcrit ] . to this end , we note condition holds by assumption [ ass : equic ] and define @xmath1048\\|_{\\sigma_n(p),r } ~,\\ ] ] which is independent of @xmath260 by assumption [ ass : bootcoupling ] .",
    "moreover , theorem [ th : coupsmooth ] yields @xmath1049 uniformly in @xmath287 , while assumption [ ass : bootrates](ii ) implies @xmath1050 and @xmath1051}((2k_b\\ell_n)^{\\kappa_\\rho } , \\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] , and hence @xmath1052\\|_{\\sigma_n(p),r } + o_p(a_n)\\ ] ] uniformly in @xmath287 by theorem [ th : localdrift](i ) . since the right hand side of shares the same distribution as @xmath1053 , the first claim of the theorem holds by lemma [ lm : auxcrit](i ) .    for the second claim of the theorem we first note that theorem [ th : noineq](i ) yields that @xmath1054 uniformly in @xmath287 .",
    "furthermore , as already argued @xmath1055 satisfies the conditions of theorem [ th : localdrift](i ) by assumption [ ass : bootrates](ii ) while @xmath356 in addition implies that @xmath1056\\|_{\\sigma_n(p),r } + o_p(a_n)\\ ] ] uniformly in @xmath287 ( see and subsequent discussion ) .",
    "hence , since the right hand side of shares the same distribution as @xmath1057 and condition of lemma [ lm : auxcrit ] holds by assumption [ ass : equic ] , the second claim of the theorem follows from results and , and lemma [ lm : auxcrit](ii ) .    in order to establish the final claim of the theorem",
    ", we next note that since @xmath1040 and @xmath1058 for all @xmath346 it follows from assumption [ ass : bootcoupling ] and @xmath889 uniformly in @xmath254 by lemma [ aux : weights ] that we must have @xmath1059 therefore , , markov s inequality , and lemmas [ aux : weights ] and [ aux : tailbound ] allow us to conclude @xmath1060 we thus obtain from the definition of @xmath609 , result , and markov s inequality @xmath1061 next observe that @xmath1062 for any @xmath762 , and hence by lemma [ aux : suppq ] we obtain for some @xmath774 satisfying @xmath797 = o(k_n^{1/r}\\sqrt{\\log(k_n)}j_nb_n/\\sqrt n)$ ] @xmath1063\\|_r - \\sqrt n \\|\\hat \\sigma_n\\|_{o , r } \\mathcal z_{n , p } ~.\\ ] ] moreover , assuming without loss of generality that @xmath1064 is the @xmath219 projection of @xmath1065 $ ] onto the span of @xmath1066 , we obtain by lemma [ lm : obviousineq ] that @xmath1067\\|_r \\\\",
    "\\geq \\mathcal j^{-\\frac{1}{2}}k_n^{\\frac{1}{r } - \\frac{1}{2 } } \\inf_{\\theta \\in \\theta_n \\cap r } \\{\\sum_{\\jmath = 1}^{\\mathcal j}\\|e_p[q_{n,\\jmath}^{k_{n,\\jmath}}(z_{i,\\jmath})q_{n,\\jmath}^{k_{n,\\jmath}}(z_{i,\\jmath})^\\prime ] \\pi_{n , p,\\jmath}(\\theta ) \\|_2\\ } ~.\\end{gathered}\\ ] ] thus , since the eigenvalues of @xmath618 $ ] are uniformly bounded away from zero by assumption [ ass:4pow](ii ) , we can conclude from result that @xmath1068\\|_r \\gtrsim k_n^{\\frac{1}{r } - \\frac{1}{2 } } \\inf_{\\theta \\in \\theta_n \\cap r } \\{\\sum_{\\jmath = 1}^{\\mathcal j } \\|q_{n,\\jmath}^{k_{n,\\jmath}\\prime } \\pi_{n , p,\\jmath}(\\theta)\\|_{l^2_p}\\ } \\\\   \\geq k_n^{\\frac{1}{r}- \\frac{1}{2 } } \\inf_{\\theta \\in \\theta\\cap r } \\ { \\sum_{\\jmath = 1}^{\\mathcal j}\\|e_p[\\rho_\\jmath(x_i,\\theta)|z_{i,\\jmath}]\\|_{l^2_p } \\ } - k_n^{\\frac{1}{r } - \\frac{1}{2 } } k_0 k_n^{-\\gamma_z}\\end{gathered}\\ ] ] where the second inequality must hold for some @xmath1069 by assumption [ ass:4pow](i ) and @xmath1070 .",
    "hence , results and imply that for @xmath1071 and some @xmath1072 it follows that for any @xmath1073 we must have @xmath1074 thus , since holds for all @xmath1073 with @xmath1071 , @xmath1075 implies that @xmath1076 in particular , since : ( i ) @xmath1077 uniformly in @xmath254 by lemma [ aux : weights ] , ( ii ) @xmath1078 uniformly in @xmath254 by markov s inequality and @xmath797 = o(k_n^{1/r}\\sqrt{\\log(k_n)}b_nj_n/\\sqrt n)$ ] by lemma [ aux : suppq ] , and ( iii ) @xmath1079 uniformly in @xmath254 by result , it follows from that @xmath1080 which establishes the final claim of the theorem .",
    "[ lm : simcoup ] let assumptions [ ass : iid ] , [ ass : instreg](i)-(ii ) , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : coupling ] , [ ass : rhocontrol](i ) , [ ass : locrates](iii ) , [ ass : driftlin](i ) , [ ass : extra ] , [ ass : bootcoupling ] , and [ ass : bootrates](i)-(ii ) hold .",
    "it then follows that uniformly in @xmath287 we have @xmath1081\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\ ] ]    proof : for an arbitrary @xmath284 , observe that lemma [ lm : setcons ] and assumption [ ass : bootrates](i ) imply @xmath1082 furthermore , for any @xmath1083 and @xmath1084 note that @xmath531 and @xmath483 by definition of @xmath529 .",
    "thus , @xmath1085 for any @xmath565 and @xmath551 , and hence result and assumption [ ass : extra](ii ) yield @xmath1086 due to @xmath1087 for any @xmath566 .",
    "therefore , results and together with assumption [ ass : bootrates](ii ) and lemma [ aux : derest ] yield that uniformly in @xmath287 @xmath1088 - \\mathbb d_{n , p}(\\theta)[h]\\|_r = o_p(a_n ) ~.\\ ] ] moreover , since @xmath1040 almost surely , we also have from assumption [ ass : bootcoupling ] that @xmath1089 uniformly in @xmath254 . therefore , since @xmath889 uniformly in @xmath254 by lemma [ aux : weights ] , we obtain from results and and lemma [ lm : geninf ] that uniformly in @xmath287 @xmath1090\\|_{\\hat \\sigma_n , r } + o_p(a_n ) ~.\\ ] ] next , note that by assumption [ ass : weights](iii ) there exists a constant @xmath847 such that @xmath1091 for all @xmath179 and @xmath254 .",
    "thus , we obtain that @xmath1092\\|_{\\hat \\sigma_n , r } \\\\ \\leq \\{c_0\\|\\hat \\sigma_n - \\sigma_n(p)\\|_{o , r } + 1\\}\\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta)*q_n^{k_n } + \\mathbb d_{n , p}(\\theta)[h]\\|_{\\sigma_n(p),r}\\end{gathered}\\ ] ] for any @xmath346 , @xmath377 , and @xmath254 . in particular , since @xmath1093 for any @xmath346 , assumptions [ ass : weights](iii ) , [ ass : locrates](iii ) , markov s inequality , and lemma [ aux : tailbound ] yield @xmath1094\\|_{\\hat \\sigma_n , r } \\\\",
    "\\leq \\|\\hat \\sigma_n - \\sigma_n(p)\\|_{o , r}\\times \\sup_{\\theta \\in \\theta_n \\cap r } \\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta)*q_n^{k_n}\\|_{\\sigma_n(p),r } = o_p(a_n)\\end{gathered}\\ ] ] uniformly in @xmath254 .",
    "it then follows from and that uniformly in @xmath254 @xmath1095\\|_{\\hat \\sigma_n , r } \\\\",
    "\\leq \\inf_{\\theta \\in \\hat \\theta_n \\cap r } \\inf_{\\frac{h}{\\sqrt",
    "n } \\in \\hat v_n(\\theta,\\ell_n ) } \\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta)*q_n^{k_n } + \\mathbb d_{n , p}(\\theta)[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\end{gathered}\\ ] ] the reverse inequality to can be obtained by identical arguments and exploiting @xmath1077 uniformly in @xmath254 by lemma [ aux : weights ] .",
    "the claim of the lemma then follows from and ( and its reverse inequality ) .",
    "[ aux : derest ] let assumptions [ ass : instreg](i)-(ii ) , [ ass : coupling ] , [ ass : rhocontrol](i ) , [ ass : driftlin](i ) , [ ass : extra](i ) hold , and define @xmath1096 if @xmath564 satisfies @xmath1097}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] and @xmath1098 , then there is an @xmath284 such that uniformly in @xmath254 @xmath1099 - \\mathbb d_{n , p}(\\theta)[h]\\|_{r } = o_p(a_n ) ~.\\ ] ]    proof : by definition of the set @xmath1100 , we have @xmath1101 for any @xmath346 , @xmath1102 . therefore , since @xmath533 for all @xmath1102 we obtain that @xmath1103 - \\sqrt n\\{p\\rho(\\cdot,\\theta + \\frac{h}{\\sqrt n})*q^{k_n}_n - p\\rho(\\cdot,\\theta)*q^{k_n}_n\\}\\|_{r}\\\\ \\leq \\sup_{\\theta_1,\\theta_2\\in\\theta_n\\cap r : \\|\\theta_1-\\theta_2\\|_{\\mathbf b } \\leq \\ell_n }   \\|\\mathbb g_{n , p}\\rho(\\cdot,\\theta_1)*q^{k_n}_n - \\mathbb g_{n , p}\\rho(\\cdot,\\theta_2)*q^{k_n}_n \\|_{r } ~.\\end{gathered}\\ ] ] further note that assumptions [ ass : instreg](i ) , [ ass : rhocontrol](i ) , and [ ass : extra](i ) additionally imply that @xmath1104 \\leq b_n^2k_\\rho^2 k_b^{2\\kappa_\\rho}\\ell_n^{2\\kappa_\\rho } ~.\\ ] ] next , let @xmath1105 , and then observe that assumption [ ass : coupling ] , result and @xmath1106 for any @xmath1107 yield @xmath1108 uniformly in @xmath254 .",
    "therefore , from results - , markov s inequality , and @xmath1051}(\\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] by hypothesis , we conclude @xmath1109 - \\sqrt n\\{p\\rho(\\cdot,\\theta + \\frac{h}{\\sqrt n})*q^{k_n}_n - p\\rho(\\cdot,\\theta)*q^{k_n}_n\\}\\|_{r } = o_p(a_n)\\ ] ] uniformly in @xmath254 .",
    "moreover , setting @xmath284 sufficiently small for assumption [ ass : driftlin](i ) to hold , we then conclude from lemmas [ lm : obviousineq ] and [ aux : bessel ] , and assumption [ ass : driftlin](i ) that @xmath1110\\|_{r } \\\\",
    "\\leq   \\sup_{\\theta \\in ( \\theta_{0n}(p ) \\cap r)^\\epsilon } \\sup_{\\frac{h}{\\sqrt n } \\in d_n(\\theta ) } \\{\\sqrt{c \\mathcal j}k_m   \\times \\sqrt n \\times \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf e } \\times \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf l}\\}\\end{gathered}\\ ] ] for some @xmath299 . therefore , since @xmath964 for all @xmath489 and @xmath254 by assumption [ ass : extra](i ) , we conclude from @xmath1111 that @xmath1112\\|_{r } = o(a_n)\\ ] ] uniformly in @xmath254 .",
    "hence , the lemma follows from results and .",
    "[ aux : dererror ] let assumptions [ ass : instreg](ii ) and [ ass : driftlin ] hold .",
    "then there is an @xmath284 and @xmath1113 such that for all @xmath179 , @xmath254 , @xmath425 , @xmath1114 , and @xmath1115 @xmath1116 - \\mathbb d_{n , p}(\\theta_1)[h_1]\\|_r \\leq c\\{m_m\\|h_0 - h_1\\|_{\\mathbf e } + k_m\\|\\theta_0 - \\theta_1\\|_{\\mathbf l}\\|h_1\\|_{\\mathbf e}\\ } ~.\\ ] ]    proof : we first note that by lemmas [ lm : obviousineq ] and [ aux : bessel ] there is a constant @xmath847 with @xmath1117 - \\mathbb d_{n , p}(\\theta_1)[h_1]\\|_{r } \\leq \\{\\sum_{\\jmath = 1}^{\\mathcal j } c_0 \\|\\nabla m_{p,\\jmath}(\\theta_0)[h_0 ] - \\nabla m_{p,\\jmath}(\\theta_1)[h_1]\\|_{l^2_p}^2 \\}^{\\frac{1}{2 } } ~.\\ ] ] moreover , since @xmath1118 , we can also conclude from assumption [ ass : driftlin](iii ) that @xmath1119\\|_{l^2_p } \\leq m_m \\times \\|h_0 - h_1\\|_{\\mathbf e } ~.\\ ] ] similarly , letting @xmath284 be such that assumption [ ass : driftlin](ii ) holds , we further obtain @xmath1120 - \\nabla m_{p,\\jmath}(\\theta_1)[h_1]\\|_{l^2_p } \\leq k_m\\|\\theta_1 - \\theta_0\\|_{\\mathbf l } \\|h_1\\|_{\\mathbf e}\\ ] ] due @xmath1114 .",
    "thus , the lemma follows from - .",
    "[ lm : samerates ] let assumptions [ ass : iid ] , [ ass : instreg ] , [ ass : processreg ] , [ ass : weights ] , [ ass : keycons ] , [ ass : keyrate ] , [ ass : coupling ] , [ ass : rhocontrol ] , [ ass : locrates ] , [ ass : driftlin](i ) , [ ass : bootcoupling ] hold .",
    "if @xmath360 , @xmath854 satisfy @xmath1121}(\\ell_n^{\\kappa_\\rho } \\vee \\tilde \\ell_n^{\\kappa_\\rho},\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] , @xmath1122 , and @xmath1123 , then uniformly in @xmath287 @xmath1124\\|_{\\sigma_n(p),r } \\\\ = \\inf_{\\theta \\in \\theta_{0n}(p ) \\cap r}\\inf_{\\frac{h}{\\sqrt",
    "n } \\in v_{n}(\\theta,\\tilde \\ell_n ) } \\|\\mathbb w^\\star_{n , p}\\rho(\\cdot,\\theta)*q_{n}^{k_n } + \\mathbb d_{n , p}(\\theta)[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\end{gathered}\\ ] ]    proof : for notational simplicity , for any @xmath1125 , and @xmath1126 define @xmath1127\\|_{\\sigma_n(p),r } ~.\\ ] ] next , note that since @xmath225 and @xmath553 have the same law for every @xmath6 , it follows that @xmath1128 for any @xmath284 .",
    "however , by lemma [ lm : localprelim ] we also have uniformly in @xmath287 that @xmath1129\\|_{\\sigma_n(p),r } + o_p(a_n ) ~,\\end{gathered}\\ ] ] where the second equality follows from , @xmath1130 by hypothesis , and lemma [ lm : geninf ] . hence , since the same arguments in apply if we employ @xmath854 in place of @xmath360 , it follows from and that uniformly in @xmath287 @xmath1131 thus , the claim of the lemma follows from and .",
    "[ lm : notbinding ] let assumptions [ ass : param ] , [ ass : r](i ) , [ ass : instreg ] , [ ass : processreg](ii)-(iii ) , [ ass : weights](ii)-(iii ) , [ ass : keyrate ] , [ ass : driftlin](i)-(ii ) , [ ass : extra ] , and [ ass : loceq ] hold , @xmath579 , @xmath14 satisfy , and define the set @xmath1132 = 0 \\text { and } \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b } \\leq \\ell\\ } ~.\\ ] ] further assume that @xmath528 satisfies @xmath1133 , @xmath1134 , and @xmath1135 .",
    "( i ) it then follows that uniformly in @xmath287 we have @xmath1136\\|_{\\sigma_n(p),r }   \\\\ = \\inf_{h \\in \\mathbf b_n\\cap \\mathcal n(\\nabla \\upsilon_f(\\theta_{0n}(p ) ) ) } \\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } + o_p(a_n ) ~.\\end{gathered}\\ ] ] ( ii ) for @xmath179 large , @xmath1137 is injective for all @xmath287 .",
    "proof : to begin , select @xmath1138 so that uniformly in @xmath287 @xmath1139\\|_{\\sigma_n(p),r } \\\\ = \\|\\mathbb w_{n , p}^\\star \\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[\\hat h_{n , p}]\\|_{\\sigma_n(p),r } + o_p(1 ) ~.\\end{gathered}\\ ] ] further note that for @xmath1140 as defined in , lemma [ lm : auxnullspace ] ( see ) implies that there exists a @xmath1141 for which for @xmath179 sufficiently large @xmath1142 for some @xmath1018 .",
    "moreover , since @xmath1143 and @xmath14 satisfies , it follows that @xmath1144 .",
    "thus , we obtain from assumption [ ass : extra ] and @xmath1145 that for @xmath179 sufficiently large we have for all @xmath287 that @xmath1146 in particular , we obtain @xmath1147 for @xmath179 sufficiently large , and thus from assumption [ ass : keyrate ] and @xmath579 we can conclude that @xmath1148\\|_r + o(\\zeta_n)\\ } \\\\",
    "\\lesssim \\nu_n\\{\\|\\mathbb d_{n , p}(\\theta_{0n}(p))[\\frac{\\tilde h_{n , p}}{\\sqrt n}]\\|_{r } + k_m \\frac{\\ell_n^2}{\\sqrt n } \\times \\mathcal s_n(\\mathbf l , \\mathbf e ) + o(\\zeta_n ) \\ } ~,\\end{gathered}\\ ] ] where the second equality in holds by result .",
    "moreover , also note that @xmath1149 - \\mathbb d_{n , p}(\\theta_{0n}(p))[\\frac{\\hat h_{n , p}}{\\sqrt n}]\\|_r \\lesssim \\ell_n^21\\{k_f > 0\\}\\ ] ] by lemma [ aux : dererror ] , assumption [ ass : extra](i ) , and result .",
    "thus , combining results , , and together with @xmath1150 by assumption [ ass : keyrate ] we obtain that @xmath1151\\|_r + \\ell_n^2 ( \\frac{k_m}{\\sqrt n}\\mathcal s_n(\\mathbf l , \\mathbf e ) + 1\\{k_f > 0\\ } ) + \\zeta_n\\}\\ ] ] for all @xmath287 for @xmath179 sufficiently large .",
    "also note that @xmath1152 satisfying and @xmath1153 imply together with @xmath258 being bounded uniformly in @xmath6 by assumption [ ass : weights](ii ) , lemma [ aux : tailbound ] , and markov s inequality that uniformly in @xmath287 @xmath1154\\|_{\\sigma_n(p),r } \\\\",
    "\\leq 2\\|\\mathbb w_{n , p}\\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n}\\|_{\\sigma_n(p),r }   + o_p(1 ) = o_p(k_n^{1/r}\\sqrt{\\log(k_n)}b_nj_n ) ~.\\end{gathered}\\ ] ] hence , employing the definition of @xmath318 ( see ) and that @xmath1155 , we can conclude from assumption [ ass : weights](iii ) and results and that uniformly in @xmath287 @xmath1156 where the second equality follows from @xmath1157 and @xmath1134 by hypothesis .",
    "therefore , since @xmath1158 we obtain @xmath1159 and hence with probability tending to one uniformly in @xmath287 @xmath1160\\|_{\\sigma_n(p),r } \\\\",
    "= \\inf_{\\frac{h}{\\sqrt n } \\in n_n(\\theta_{0n}(p),\\ell_n/2 ) } \\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } ~.\\end{gathered}\\ ] ] however , since @xmath1161 is linear , the function being minimized in is convex . as a result",
    ", it follows that whenever holds , we must also have @xmath1162\\|_{\\sigma_n(p),r } \\\\ = \\inf_{\\frac{h}{\\sqrt n } \\in n_n(\\theta_{0n}(p),+\\infty ) } \\|\\mathbb w_{n , p}^\\star\\rho(\\cdot,\\theta_{0n}(p))*q_n^{k_n } + \\mathbb d_{n , p}(\\theta_{0n}(p))[h]\\|_{\\sigma_n(p),r } ~,\\end{gathered}\\ ] ] and hence the first claim of the lemma follows from the definition of @xmath1163 .",
    "we establish the second claim of the lemma by contradiction .",
    "suppose there exists a subsequence @xmath1164 of @xmath1165 and sequence @xmath1166 such that @xmath1167 is not injective , and then note the linearity of the map @xmath1168 implies there exists a @xmath1169 such that @xmath1170 and @xmath1171 = 0 $ ] .",
    "then observe that @xmath1172 , and that as a result also holds with @xmath1173 in place of @xmath1174 .",
    "therefore , since @xmath1175 = 0 $ ] we can conclude that @xmath1176 where the final equality follows by exploiting the definition of @xmath318 and the fact that @xmath1133 and @xmath1134 .",
    "however , result and @xmath1177 by assumption [ ass : extra](i ) imply @xmath1178 , which contradicts @xmath586 due to @xmath1179 by , and hence the second claim of the lemma follows .",
    "[ lm : auxcrit ] suppose there exists a @xmath610 such that for all @xmath284 and @xmath1180 $ ] @xmath1181 ( i ) if @xmath1182 and @xmath1183 uniformly in @xmath287 for some @xmath1053 independent to @xmath260 and equal in distribution to @xmath427 , then @xmath1184 ( ii ) if @xmath1185 and @xmath1186 uniformly in @xmath287 for some @xmath1053 independent to @xmath260 and equal in distribution to @xmath427 , then @xmath1187    proof : for the first claim , note that by hypothesis there exists a positive sequence @xmath1188 such that @xmath1189 and in addition we have uniformly in @xmath287 that @xmath1190 next , observe that by markov s inequality and result we can conclude that @xmath1191 thus , it follows from that there exists some sequence @xmath1192 such that the event @xmath1193 satisfies @xmath1194 uniformly in @xmath287 .",
    "hence , for any @xmath1195 we obtain that @xmath1196 where the final inequality exploited that @xmath1053 is independent of @xmath260 .",
    "next , define @xmath1197 and note that by evaluating at @xmath1198 we obtain that @xmath1199 implies @xmath1200 .",
    "therefore , @xmath1194 uniformly in @xmath287 yields @xmath1201 furthermore , arguing as in it follows that for some sequence @xmath1202 we have @xmath1203 thus , exploiting , , condition , and @xmath1189 , we conclude that @xmath1204    the proof of the second claim follows arguments similar to those already employed and hence we keep the exposition more concise .",
    "moreover , we further note that since the first part of the lemma implies holds , it suffices to show that @xmath1205 first , note that we may now set the sequence @xmath1188 so that @xmath1189 and in addition @xmath1206 uniformly in @xmath287 . moreover , arguing as in implies that @xmath1207 uniformly in @xmath287 for some @xmath1192 , and therefore @xmath1208 by lemma 11 in @xcite .",
    "furthermore , by analogous arguments and again relying on lemma 11 in @xcite we can also conclude that @xmath1209 for some @xmath1210 .",
    "therefore , combining results and we obtain @xmath1211 where the final equality follows from condition .      in this appendix",
    ", we develop analytical results analyzing the approximation rate of the local parameter spaces .",
    "the main result of this appendix is theorem [ th : localsmooth ] , which plays an instrumental role in the proof of the results of section [ sec : boot ] .",
    "[ th : localsmooth ] let assumptions [ ass : param](i ) , [ ass : r](i ) , [ ass : locineq ] , [ ass : loceq ] , and [ ass : ineqlindep ] hold , @xmath1212 satisfy @xmath528 , @xmath1213 , @xmath1214 , and define @xmath1215 then it follows that there exists a @xmath1018 , @xmath284 , and @xmath1216 such that for all @xmath1217 , @xmath254 , @xmath425 , and @xmath1218 satisfying @xmath1219 we have @xmath1220    proof : throughout , let @xmath1221 be such that assumptions [ ass : locineq ] and [ ass : loceq ] hold , set @xmath1222 , and for any @xmath610 let @xmath1223 . for ease of exposition , we next break up the proof intro four distinct steps .",
    "( decompose @xmath517 ) . for any @xmath254 ,",
    "@xmath425 , and @xmath377 set @xmath1224 \\hspace{0.8 in } h^{\\mathcal n_{\\theta_0 } } \\equiv h - h^{\\perp_{\\theta_0 } } ~,\\ ] ] where recall @xmath1225 denotes the right inverse of @xmath1226 .",
    "further note that @xmath1227 since @xmath1228 implies that @xmath1229 = \\nabla \\upsilon_f(\\theta_0)[h ] - \\nabla\\upsilon_f(\\theta_0)\\nabla \\upsilon_f(\\theta_0)^{- } \\nabla \\upsilon_f(\\theta_0)[h ] = 0~,\\ ] ] by definition of @xmath1230 in .",
    "next , observe that if @xmath375 and @xmath519 satisfies @xmath1231 and @xmath1232 , then @xmath1233 for @xmath179 sufficiently large , and hence by assumption [ ass : loceq](i ) and @xmath1234 due to @xmath1235 @xmath1236\\|_{\\mathbf f } = \\|\\upsilon_f(\\theta_1 + \\frac{h}{\\sqrt n } ) - \\upsilon_f(\\theta_1 ) - \\nabla \\upsilon_f(\\theta_1)[\\frac{h}{\\sqrt n}]\\|_{\\mathbf f } \\leq k_f\\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b}^2 ~.\\ ] ] therefore , assumption [ ass : loceq](ii ) , result , @xmath1237 , and @xmath1231 imply @xmath1238\\|_{\\mathbf f } \\\\",
    "\\leq \\|\\nabla \\upsilon_f(\\theta_0 ) - \\nabla \\upsilon_f(\\theta_1)\\|_o \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b } + k_f\\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b}^2 \\leq k_f \\ell_n(\\delta_{n } + \\ell_n ) ~.\\end{gathered}\\ ] ] moreover , since @xmath1239 satisfies assumption [ ass : loceq](iv ) , we also have that @xmath1240\\|_{\\mathbf b } \\\\",
    "\\leq k_f\\|\\nabla \\upsilon_f(\\theta_0)^{-}\\|_o \\|\\nabla \\upsilon_f(\\theta_0)[h]\\|_{\\mathbf f } \\leq m_f\\|\\nabla \\upsilon_f(\\theta_0)[h]\\|_{\\mathbf f } ~.\\end{gathered}\\ ] ] further note that if @xmath1241 , then and imply that @xmath1242 . thus , combining results and to handle the case @xmath1243",
    "we conclude that for any @xmath254 , @xmath482 , @xmath1218 satisfying @xmath1244 and any @xmath1245 such that @xmath1232 and @xmath533 we have the norm bound @xmath1246    ( inequality constraints ) . in what follows , it is convenient to define the set @xmath1247 then note @xmath1248 and lemma [ lm : localineq ] imply that @xmath1249 for @xmath179 sufficiently large , all @xmath254 , @xmath425 , and @xmath375 satisfying @xmath1250",
    ". the proof will proceed by verifying holds with @xmath1251 in place of @xmath1252 .",
    "in particular , if @xmath24 is linear , then @xmath1253 and implies @xmath1254 , which establishes for the case @xmath1241 .    for the rest of the proof we therefore assume @xmath1243 .",
    "we further note that lemma [ lm : intpert ] implies that for any @xmath1192 , there is a sufficiently large @xmath179 and constant @xmath1255 ( independent of @xmath771 ) such that for all @xmath254 and @xmath425 there exists a @xmath1256 such that for any @xmath1257 for which there exists a @xmath1258 satisfying @xmath1259 the following inequalities hold @xmath1260    ( equality constraints ) .",
    "the results in this step allow us to address the challenge that @xmath1258 satisfies @xmath1232 but not necessarily @xmath1261 .",
    "to this end , let @xmath1262 denote the range of the operator @xmath1263 and define the vector subspaces @xmath1264 which note are closed due to @xmath233 being finite dimensional by assumption [ ass : instreg](iii ) .",
    "moreover , since @xmath1265 by , the definitions in and imply that @xmath1266 . furthermore ,",
    "since @xmath1267 , we also have @xmath1268 = h\\ ] ] for any @xmath1269 , and thus that @xmath1270 . since @xmath1266",
    ", it then follows that @xmath1271 ",
    "i.e. the decomposition in is unique .",
    "moreover , we observe that @xmath1270 further implies the restricted map @xmath1272 is in fact bijective , and by its inverse is @xmath1273 .",
    "we next note assumption [ ass : loceq](i ) implies that for all @xmath179 and @xmath250 , @xmath20 is frchet differentiable at all @xmath1274 such that @xmath1275 for some @xmath425 .",
    "therefore , applying lemma [ lm : auximplicit ] with @xmath1276 , @xmath1277 and @xmath1278 yields that for any @xmath199 , @xmath425 and @xmath1279 satisfying @xmath1280 , there exists a @xmath1281 such that @xmath1282 in addition , note that for any @xmath199 , @xmath425 , @xmath1114 and any @xmath1245 such that @xmath1232 and @xmath1231 , result , the decomposition in , and @xmath874 ( since @xmath1243 ) , @xmath528 imply that for @xmath179 large @xmath1283 thus , for @xmath1284 as in , @xmath1285 , and results and imply that for @xmath179 sufficiently large we must have for all @xmath254 , @xmath425 , @xmath1286 with @xmath1244 and @xmath519 satisfying @xmath1232 that @xmath1287    ( build approximation ) . in order to exploit steps 2 and 3 ,",
    "we now set @xmath771 to @xmath1288 in addition , for any @xmath254 , @xmath425 , @xmath1289 satisfying @xmath1237 , and any @xmath1290 , we let @xmath1291 be as in and define @xmath1292 from steps 2 and 3 it then follows that for @xmath179 sufficiently large ( independent of @xmath254 , @xmath425 , @xmath1235 with @xmath1293 or @xmath1290 ) we have @xmath1294 moreover , from results and we also obtain that for @xmath179 sufficiently large @xmath1295 thus , @xmath1296 , , , and imply @xmath1297 for @xmath179 sufficiently large , and exploiting with @xmath1298 yields @xmath1299 furthermore , since @xmath1300 by , results , , and @xmath533 for any @xmath1290 imply by and @xmath528 , @xmath1301 that @xmath1302 for @xmath179 sufficiently large . therefore , we conclude from , , and that @xmath1303 . similarly , , , , and yield for some @xmath1018 @xmath1304 which establishes the for the case @xmath1243 .",
    "[ lm : auxnullspace ] let assumptions [ ass : param](i ) , [ ass : r](i ) , [ ass : loceq ] hold , @xmath1305 be given and define @xmath1306 = 0 \\text { and } \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b } \\leq \\ell \\ } \\label{lm : auxnullspacedisp2 } ~.\\end{aligned}\\ ] ] if @xmath564 , @xmath1213 , then there are @xmath1018 , @xmath1216 , and @xmath284 such that for all @xmath1217 , @xmath254 , @xmath425 and @xmath375 with @xmath1307 , we have @xmath1308    proof : the proof exploits manipulations similar to those employed in theorem [ th : localsmooth ] .",
    "first , let @xmath1221 be such that assumption [ ass : loceq ] holds , set @xmath1222 and note that for any @xmath1114 and @xmath533 we have @xmath1309 for @xmath179 sufficiently large .",
    "in particular , if @xmath1241 , then assumptions [ ass : loceq](i)-(ii ) yield @xmath1310 = \\nabla \\upsilon_f(\\theta_0)[\\frac{h}{\\sqrt n } ] = \\upsilon_f(\\theta_0   + \\frac{h}{\\sqrt n } ) ~.\\ ] ] thus , @xmath1311 and hence both and automatically hold . in what follows ,",
    "we therefore assume @xmath1243 .",
    "next , for each @xmath377 , @xmath199 , and @xmath321 we decompose @xmath364 according to @xmath1312 \\hspace{0.8 in } h^{\\mathcal n_{\\theta } } \\equiv h - h^{\\perp_{\\theta } } ~,\\ ] ] where recall @xmath1313 denotes the right inverse of @xmath486 .",
    "next , note that result implies that for @xmath179 sufficiently large , we have for any @xmath254 , @xmath425 , @xmath375 satisfying @xmath1237 and @xmath1314 @xmath1315 furthermore , note that for any @xmath1314 and @xmath179 sufficiently large @xmath1316 satisfies @xmath1317 = 0 $ ] by and @xmath1318 by , and thus @xmath1319 . in particular , it follows that for any @xmath254 , @xmath425 , and @xmath375 with @xmath1237 we must have that @xmath1320 where the first inequality follows from @xmath1321 , the equality from , and the second inequality is implied by .",
    "thus , follows .    in order to establish when @xmath1243 note that for any @xmath1322 , @xmath1323 = 0 $ ] , @xmath1237 and assumption [ ass : loceq](ii ) imply that @xmath1324\\|_{\\mathbf f } = \\|\\nabla \\upsilon_f(\\theta_1)[\\frac{h}{\\sqrt n } ] - \\nabla \\upsilon_f(\\theta_0)[\\frac{h}{\\sqrt n}]\\|_{\\mathbf f } \\leq k_f \\delta_n \\ell_n ~.\\ ] ] therefore , from definition , assumption [ ass : loceq](iv ) and",
    "result we can conclude @xmath1325\\|_{\\mathbf b } \\leq m_f\\delta_n\\ell_n ~.\\ ] ] moreover , identical arguments to those employed in establishing ( with @xmath1326 in place of @xmath16 ) imply that for sufficiently large @xmath179 it follows that for all @xmath254 , @xmath425 , and @xmath1322 there is a @xmath1327 such that for some @xmath1069 @xmath1328 since @xmath1329 , it follows that @xmath1330 for @xmath179 sufficiently large .",
    "therefore , @xmath1331 , and imply that for @xmath179 sufficiently large , we have for all @xmath254 , @xmath425 and @xmath1322 that @xmath1332 hence , for @xmath179 sufficiently large we can conclude from result that for all @xmath254 , @xmath425 , and @xmath1235 with @xmath1333 we have that @xmath1334 where the final inequality holds by , and @xmath1335 .",
    "thus , follows from , which establishes the claim of the lemma .",
    "[ lm : localineq ] let assumptions [ ass : param](i ) , [ ass : r](i ) , and [ ass : locineq ] hold , and @xmath528 be given .",
    "then , there exist @xmath1216 and @xmath284 such that for all @xmath1217 , @xmath254 , @xmath425 , and @xmath1336 satisfying @xmath1337 it follows that @xmath1338 for any @xmath1339 .",
    "proof : let @xmath1340 be such that assumption [ ass : locineq ] holds , set @xmath1341 , and for notational simplicity let @xmath1342 for any @xmath610 .",
    "then note that for any @xmath1343 and @xmath533 we have @xmath1233 for @xmath179 sufficiently large .",
    "therefore , by assumption [ ass : locineq](ii ) we obtain that @xmath1344\\|_{\\mathbf g } \\leq k_g\\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b}^2 ~.\\ ] ] similarly , assumption [ ass : locineq](ii ) implies that if @xmath425 and @xmath1343 , then @xmath1345 - \\nabla \\upsilon_g(\\theta_1)[\\frac{h}{\\sqrt n}]\\|_{\\mathbf g } \\\\ \\leq \\|\\nabla \\upsilon_g(\\theta_0 ) - \\nabla \\upsilon_g(\\theta_1)\\|_o \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b } \\leq k_g\\|\\theta_0 - \\theta_1\\|_{\\mathbf b } \\|\\frac{h}{\\sqrt n}\\|_{\\mathbf b}\\end{gathered}\\ ] ] for any @xmath519 . hence , since @xmath1346 due to @xmath1347 we can conclude that @xmath1348 by , , and lemma [ lm : obviousam ] .",
    "also note for any @xmath425 , @xmath1343 and @xmath519 with @xmath533 we have @xmath1349 and @xmath1233 for @xmath179 sufficiently large .",
    "therefore , assumptions [ ass : locineq](i ) , [ ass : locineq](iii ) , and lemma [ lm : obviousam ] yield @xmath1350 + k_g\\|\\theta_0 - \\theta_1\\|^2_{\\mathbf b } \\mathbf { 1_g } \\nonumber \\\\ & \\leq \\{m_g\\|\\theta_0 - \\theta_1\\|_{\\mathbf b } + k_g\\|\\theta_0 - \\theta_1\\|_{\\mathbf b}^2\\}\\mathbf { 1_g } ~.\\end{aligned}\\ ] ] hence , and yield for @xmath1351 , @xmath482 , @xmath1352 , @xmath533 , and @xmath179 large @xmath1353 where the equality follows from @xmath1354 by theorem 8.6 in @xcite .",
    "thus , since @xmath1355 and @xmath1356 implies @xmath1357 in @xmath27 by corollary 8.7 in @xcite , implies that for @xmath179 sufficiently large and any @xmath482 , @xmath1343 and @xmath519 satisfying @xmath533 and @xmath1358 we must have @xmath1359 , which verifies indeed holds .",
    "[ lm : intpert ] if assumptions [ ass : param](i ) , [ ass : r](i ) , [ ass : locineq ] , [ ass : ineqlindep](ii ) hold , and @xmath1192 , @xmath528 , then there is a @xmath1360 ( depending on @xmath1361 ) and a @xmath299 ( independent of @xmath1361 ) such that for all @xmath1217 , @xmath254 , and @xmath1362 there is @xmath1363 with @xmath1364 for all @xmath1257 for which there is a @xmath519 satisfying @xmath1365 , @xmath533 and the inequality @xmath1366 .",
    "proof : by assumption [ ass : ineqlindep](ii ) there are @xmath284 and @xmath478 such that for every @xmath254 , @xmath179 , and @xmath1362 there exists a @xmath1367 satisfying @xmath1368 \\leq -\\epsilon \\mathbf { 1_g}\\ ] ] and @xmath1369 .",
    "moreover , for any @xmath519 such that @xmath533 , assumption [ ass : locineq](i ) , lemma [ lm : obviousam ] and @xmath1370 for @xmath179 sufficiently large yield @xmath1371 + k_g\\|\\frac{h}{\\sqrt n}\\|_{\\mathbf",
    "b}^2 \\mathbf { 1_g } \\\\ \\leq \\upsilon_g(\\theta_0 ) + \\{\\|\\nabla \\upsilon_g(\\theta_0)\\|_o\\ell_n + k_g\\ell_n^2\\ } \\mathbf { 1_g } \\leq \\upsilon_g(\\theta_0 ) + 2m_g\\ell_n\\mathbf { 1_g }   ~.\\end{gathered}\\ ] ] hence , and imply for any @xmath519 with @xmath1231 we must have @xmath1372 \\leq \\{2m_g\\ell_n -\\epsilon\\ } \\mathbf { 1_g } ~.\\ ] ]    next , we let @xmath1373 and aim to show holds with @xmath1374 by setting @xmath1375 to this end , we first note that if @xmath425 , @xmath519 satisfies @xmath533 and @xmath1359 , and @xmath1257 is such that @xmath1376 , then definition implies that @xmath1377 .",
    "therefore , assumption [ ass : locineq](i ) , lemma [ lm : obviousam ] , and @xmath1378 together allow us to conclude @xmath1379 + 2k_g(\\|\\frac{h_{\\theta_0,n}}{\\sqrt n}\\|_{\\mathbf b}^2 + \\eta_n^2)\\mathbf { 1_g } \\nonumber \\\\ & \\leq \\upsilon_g(\\theta_0 + \\frac{h}{\\sqrt",
    "n } ) + \\nabla \\upsilon_g(\\theta_0 + \\frac{h}{\\sqrt n})[\\frac{h_{\\theta_0,n}}{\\sqrt n } ] + \\{2k_g\\|\\frac{h_{\\theta_0,n}}{\\sqrt n}\\|_{\\mathbf b}^2 + 2m_g\\eta_n\\}\\mathbf { 1_g } ~,\\end{aligned}\\ ] ] where the final result follows from assumption [ ass : locineq](iii ) and @xmath1380 for @xmath179 sufficiently large .",
    "similarly , assumption [ ass : locineq](ii ) and lemma [ lm : obviousam ] yield @xmath1381 & \\leq \\nabla \\upsilon_g(\\theta_0)[\\frac{h_{\\theta_0,n}}{\\sqrt n } ] + \\|\\nabla \\upsilon_g(\\theta_0 + \\frac{h}{\\sqrt n } ) - \\nabla \\upsilon_g(\\theta_0)\\|_o \\|\\frac{h_{\\theta_0,n}}{\\sqrt n}\\|_{\\mathbf b } \\mathbf { 1_g } \\nonumber \\\\ & \\leq \\nabla \\upsilon_g(\\theta_0)[\\frac{h_{\\theta_0,n}}{\\sqrt n } ] + k_g\\ell_n\\|\\frac{h_{\\theta_0,n}}{\\sqrt n}\\|_{\\mathbf b } \\mathbf { 1_g } ~.\\end{aligned}\\ ] ] hence , combining results and , @xmath1382 due to @xmath1369 , and @xmath1192 , @xmath528 , we obtain that for @xmath179 sufficiently large we have @xmath1383 + 4m_g\\eta_n\\mathbf { 1_g } ~.\\ ] ] in addition , since @xmath1384 , we have @xmath1385 eventually , and hence @xmath1366 , @xmath1386 for @xmath179 sufficiently large due to @xmath528 and result imply that @xmath1387 \\\\",
    "\\leq c_0\\eta_n\\{\\upsilon_g(\\theta_0 + \\frac{h}{\\sqrt n } )   + \\nabla \\upsilon_g(\\theta_0)[\\bar h_{\\theta_0,n}]\\ } \\leq c_0\\eta_n\\{2m_g\\ell_n - \\epsilon\\ } \\mathbf { 1_g } \\leq -\\frac{c_0\\eta_n\\epsilon}{2 } \\mathbf { 1_g } ~.\\end{gathered}\\ ] ] thus , we can conclude from results , and , and @xmath1373 that @xmath1388 for @xmath179 sufficiently large , which establishes the claim of the lemma .",
    "[ lm : auximplicit ] let @xmath1389 and @xmath1399 be banach spaces with norms @xmath1390 and @xmath1400 , @xmath1401 and @xmath1402 .",
    "suppose @xmath1403 and that there are @xmath1072 and @xmath1069 such that :                proof : we closely follow the arguments in the proof of theorems 4.b in @xcite . first , we define @xmath1421 pointwise for any @xmath1413 and @xmath1422 by @xmath1423 - f(a_0 + h_1 + h_2 ) ~.\\ ] ] since @xmath1424 is bijective by hypothesis , @xmath1425 if and only if @xmath1426 ~.\\ ] ] letting @xmath1427 be given by @xmath1428 $ ] , we see from that the desired @xmath1417 must be a fixed point of @xmath1429 . next ,",
    "define the set @xmath1430 for @xmath1431 , and consider an arbitrary @xmath1413 with @xmath1432 .",
    "notice that then @xmath1433 for any @xmath1434 and hence @xmath155 is differentiable with respect to @xmath1435 with derivative @xmath1436 .",
    "thus , if @xmath1437 , then proposition 7.3.2 in @xcite implies that @xmath1438 where the final inequality follows by condition ( iii ) and @xmath1439 .",
    "moreover , @xmath1440 - \\nabla f(a_0 + h_1)[h_2]\\|_{\\mathbf c } \\\\",
    "\\leq \\|\\nabla f(a_0 ) -",
    "\\nabla f(a_0+h_1)\\|_o\\|h_2\\|_{\\mathbf a } \\leq k_0\\|h_1\\|_{\\mathbf a } \\|h_2\\|_{\\mathbf a } \\leq \\frac{\\|h_2\\|_{\\mathbf a}}{4k_0}\\end{gathered}\\ ] ] by condition ( iv ) and @xmath1441 .",
    "similarly , for any @xmath1434 we have @xmath1442\\|_{\\mathbf c } \\leq k_0\\|h_2\\|_{\\mathbf a}^2 \\leq",
    "\\frac{\\|h_2\\|_{\\mathbf a}}{4k_0}\\ ] ] due to @xmath1443 and condition ( ii ) . in turn , since @xmath1403 by hypothesis , condition ( iii ) , @xmath1444 and @xmath1445 yield that @xmath1446 hence , by and - we obtain for any @xmath1434 and @xmath1447 with @xmath1432 @xmath1448 thus , since @xmath1412 by condition ( v ) , result implies @xmath1449 , and yields @xmath1450 for any @xmath1437 . by theorem 1.1.1.a in @xcite",
    "we then conclude @xmath1429 has a unique fixed point @xmath1451 , and the first claim of the lemma follows from and .",
    "next , we note that since @xmath1417 is a fixed point of @xmath1429 , we can conclude that @xmath1452 thus , since and @xmath1412 imply that @xmath1453 , it follows from result and @xmath1454 that @xmath1455 where in the second inequality we exploited @xmath1412 , in the third inequality we used and in the final inequality we exploited @xmath1456 . while the estimate in applies for generic @xmath397 , we note that if in addition @xmath1420 , then @xmath1457 due to @xmath1403 and @xmath1458 = 0 $ ] , and thus the final claim of the lemma follows .      in this appendix , we revisit examples [ ex : rd ] , [ ex : slutzky ] , [ ex : comp ] , and [ ex : condineq ] in order to illustrate our results .",
    "we focus in particular in deriving explicit expressions for the test and bootstrap statistics @xmath267 and @xmath445 , clarifying the role of the norms @xmath306 , @xmath367 , and @xmath30 , as well as computing the rate requirements imposed by our assumptions .      since in this example we require @xmath65 to be continuously differentiable to evaluate the slutsky restriction , it is natural to set the banach space @xmath19 to equal @xmath70 .",
    "further recall that in this instance @xmath72 , @xmath73 , and @xmath1459 for any @xmath1460 . for simplicity",
    ", we assume the support of @xmath1461 under @xmath6 is bounded uniformly in @xmath254 and for some @xmath847 set the parameter space @xmath18 to be @xmath1462 which is compact under the norm @xmath1463  for calculations with noncompact @xmath18 see examples [ ex : comp ] and [ ex : condineq ] below . in order to approximate the function",
    "@xmath65 we utilize linear sieves @xmath660 and let @xmath1464 . for @xmath1465 a bounded transformation we then set @xmath1466 as our instruments so that @xmath1467 .",
    "therefore , @xmath267 is here equivalent to @xmath1468 where constraint ( i ) imposes that @xmath1469 , restriction ( ii ) corresponds to @xmath535 , and ( iii ) enforces the slutsky constraint @xmath1470 .",
    "whenever @xmath660 are chosen to be a tensor product of b - splines or local polynomials it follows that @xmath1471 and hence assumption [ ass : instreg](i ) holds with @xmath1472 since @xmath1473 was assumed bounded @xcite .",
    "moreover , we note assumption [ ass : processreg](ii ) holds if @xmath1474 < \\infty$ ] , while assumption [ ass : processreg](iii ) is satisfied with @xmath1475 by theorem 2.7.1 in @xcite . by remark [ rm : localid ]",
    ", it also follows that if the eigenvalues of the matrix @xmath1476\\ ] ] are bounded from above and away from zero uniformly in @xmath254 , then assumption [ ass : keyrate](ii ) is satisfied with @xmath1477 and @xmath1478 .",
    "since we expect @xmath1479 to be identified , we set @xmath563 and thus under the no - bias condition of assumption [ ass : locrates](ii ) theorem [ th : setrates ] yields a rate of convergence under @xmath306 equal to @xmath1480 we refer to corollary [ cor : polycoup ] for verifying assumption [ ass : coupling ] and also note that assumption [ ass : rhocontrol ] is satisfied with @xmath1481 and @xmath1482)$ ] by and definition of @xmath306 . in turn",
    ", we note that since @xmath215 is an euclidean class , we also have @xmath1483}(\\mathcal r_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\lesssim \\sqrt{j_n } \\mathcal r_n \\log(n)\\ ] ] and thus @xmath1484 and result imply that assumption [ ass : locrates](i ) holds provided that @xmath1485 . since equation implies that in this model @xmath1486 - g(p_i , y_i ) - w_i^\\prime \\gamma ~,\\ ] ]",
    "we also observe that assumption [ ass : driftlin ] holds with @xmath1487(z_i ) = -g(p_i , y_i ) - w_i^\\prime \\gamma$ ] for any @xmath1488 , @xmath1489 , and @xmath1490 $ ] .    with regards to the bootstrap statistic , we let @xmath1491 be a minimizer of and @xmath1492 where recall @xmath434 is an i.i.d .",
    "sample of standard normal random variables that are independent of the data @xmath1493 . since in this model",
    "the moment conditions are linear in @xmath23 , in this case the numerical derivative in simply reduces to @xmath1494 = - \\frac{1}{n}\\sum_{i=1}^n ( p_n^{j_n}(y_i , p_i)^\\prime \\beta + w_i^\\prime \\gamma)q_n^{k_n}(z_i)\\ ] ] for any @xmath1495 .",
    "we also note that result similarly implies that @xmath1496 = - e_p[(p_n^{j_n}(y_i , p_i)^\\prime \\beta + w_i^\\prime \\gamma)q_n^{k_n}(z_i)]\\ ] ] for @xmath1495 .",
    "moreover , since the requirement that the eigenvalues of be bounded away from zero and infinity implies that similarly the eigenvalues of @xmath1497\\ ] ] are bounded away from zero and infinity uniformly in @xmath254 , it follows that @xmath1498 for any @xmath1499 .",
    "we therefore obtain from and that @xmath1500 - \\mathbb d_{n , p}(\\theta_0)[h]\\|_r   \\\\",
    "\\lesssim \\|\\frac{1}{n}\\sum_{i=1}^n q_n^{k_n}(z_i)(w_i^\\prime , p_n^{j_n}(p_i , y_i)^\\prime ) - e_p[q_n^{k_n}(z_i)(w_i^\\prime , p_n^{j_n}(p_i , y_i)^\\prime)]\\|_{o,2 } ~.\\end{gathered}\\ ] ] thus , since @xmath1501 we conclude by standard arguments and theorem 6.1 in @xcite ( bernstein s inequality for matrices ) that uniformly in @xmath254 @xmath1502 - \\mathbb d_{n , p}(\\theta_0)[h]\\|_r   = o_p(\\frac{j_n\\sqrt{\\log(j_n)}}{\\sqrt n } ) ~.\\ ] ]    we next note that given the definitions of @xmath306 and @xmath30 , assumption [ ass : extra](i ) is trivially satisfied with @xmath1503 . furthermore , since in this example @xmath80 , we obtain by defining for any @xmath1504 the map @xmath1505 according to @xmath1506(p , y ) = \\frac{\\partial}{\\partial p } g(p , y ) + g_1(p , y ) \\frac{\\partial}{\\partial y } g(p , y ) + g(p , y ) \\frac{\\partial}{\\partial y } g_1(p , y)\\ ] ] for any @xmath1507 , that assumptions [ ass : locineq](i)-(ii ) hold with @xmath501 .",
    "similarly , exploiting and the definition of @xmath18 in it also follows that assumption [ ass : locineq](iii ) is satisfied with @xmath1508 . in turn",
    ", we observe that since @xmath77 is linear ( with @xmath76 ) , assumption [ ass : ineqlindep ] is automatically satisfied , while assumption [ ass : loceq ] holds with @xmath1241 and @xmath1509 .",
    "sufficient conditions for assumption [ ass : bootcoupling ] are given by theorem [ th : mainbootcoup ] , and we note the preceding discussion implies assumption [ ass : bootrates](ii ) imposes @xmath1510 while assumptions [ ass : bootrates](iii)-(iv ) respectively demand @xmath1511 and @xmath1512 because @xmath1513 @xcite .",
    "these rate requirements are compatible with setting @xmath360 to satisfy @xmath586 , and hence result , @xmath1514 , and the eigenvalues of being bounded away from zero imply that the conditions of lemma [ lm : lnotbind ] are satisfied .",
    "therefore , the bandwidth @xmath360 is unnecessary ",
    "i.e. we may set @xmath1515  and hence @xmath445 becomes @xmath1516\\|_{\\hat \\sigma_n , r } \\text { s.t . }",
    "\\text { ( i ) } p_n^{j_n}(p_0,y_0)^\\prime \\beta = 0 , \\\\ \\text { ( ii ) } \\upsilon_g(\\hat \\theta + \\frac{p_n^{j_n\\prime}\\beta}{\\sqrt n } ) \\leq ( \\upsilon_g(\\hat \\theta ) - 2 r_n\\|\\frac{p_n^{j_n\\prime}\\beta}{\\sqrt n}\\|_{1,\\infty } ) \\vee ( -r_n\\mathbf { 1_g } ) ~,\\end{gathered}\\ ] ] where constraints ( i ) and ( ii ) correspond to @xmath1517 and @xmath1518 in definition .",
    "it is worth noting that if constraints ( i ) and ( ii ) in are replaced by more demanding restrictions , then the test would continue to control size . for computational simplicity",
    ", it may hence be preferable to replace constraint ( ii ) with @xmath1519 where we have exploited that @xmath1520 by @xmath1521 and @xmath1513 .",
    "finally , we observe that in a model with endogeneity the arguments would remain similar , except the rate of convergence @xmath318 would be slower leading to different requirements on @xmath558 ; see @xcite for the optimal @xmath318 .",
    "in the monotonic regression discontinuity example the banach space @xmath19 was set to equal @xmath95)\\times c^1([0,1])$ ] while @xmath1522 satisfied the restriction @xmath1523 = 0 ~.\\ ] ] for the parameter space @xmath18 we may for instance set @xmath18 to be a @xmath1524-ball in @xmath19 , so that @xmath1525 for @xmath1524 sufficiently large to ensure @xmath1526 . in turn",
    ", we employ linear sieves @xmath1527 and @xmath1528 for @xmath1529)$ ] and @xmath1530)$ ] respectively and set the vector of instruments @xmath1531 where @xmath1532 , @xmath1533 , and @xmath1534 .",
    "thus , @xmath267 becomes @xmath1535 where constraint ( i ) corresponds to @xmath1536 , constraints ( ii ) and ( iii ) impose @xmath1470 , and the restriction @xmath1537 can be ignored by remark [ rm : interiority ] .    for concreteness ,",
    "suppose @xmath1527 and @xmath1528 are orthonormalized b - splines , in which case the constant @xmath262 of assumption [ ass : instreg](i ) satisfies @xmath1538 .",
    "moreover , we note that theorem 2.7.1 in @xcite implies the sequence @xmath265 of assumption [ ass : processreg](iii ) satisfies @xmath1475 . in turn , provided that the eigenvalues of @xmath1539\\ ] ] are bounded from above and away from zero uniformly in @xmath254 , remark [ rm : localid ] implies assumption [ ass : keyrate ] holds with @xmath1477 when using for any @xmath1540 the norm @xmath1541 .",
    "we further note that since @xmath1542 is identified we may set @xmath563 and hence , under the no bias condition of assumption [ ass : locrates](ii ) , we obtain from theorem [ th : setrates ] a rate of convergence under @xmath306 equal to @xmath1543 we conjecture the above rate is suboptimal in that it does not exploit the linearity of the moment condition in @xmath23 , and employing the arguments in @xcite it should be possible to derive the refined rate @xmath1544 at least for the case @xmath594 .",
    "sufficient conditions for assumption [ ass : coupling ] are provided by corollary [ cor : polycoup ] , while we observe assumption [ ass : rhocontrol ] holds with @xmath1481 by linearity of the moment condition and definition of @xmath306 .",
    "furthermore , since @xmath215 is an euclidean class , we further obtain @xmath1545}(\\mathcal r_n , \\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\lesssim \\sqrt{j_n}\\mathcal r_n \\log(n ) ~,\\ ] ] and hence under the bound @xmath1538 and @xmath1546 by , assumption [ ass : locrates](i ) reduces to @xmath1485 . in turn , we note that @xmath1547\\ ] ] is linear for any @xmath1548 , and hence assumptions [ ass : driftlin](i)-(ii ) hold with @xmath383 , while assumption [ ass : driftlin](iii ) is satisfied with @xmath1549 . similarly , if we metrize the product topology on @xmath95)\\times c^1([0,1])$ ] by @xmath1550 for any @xmath1540 , then assumption [ ass : extra](i ) holds with @xmath1551 , assumptions [ ass : locineq ] and [ ass : loceq ] are satisfied with @xmath1552 and @xmath1553 and @xmath1554 , and assumption [ ass : ineqlindep ] holds by linearity of @xmath20 . therefore , for any @xmath1540 the set @xmath527 becomes @xmath1555 \\\\",
    "\\nabla g_2(a ) +   \\frac{\\nabla p_{+,n}^{j_n}(a)^\\prime\\beta_2}{\\sqrt n } & \\geq \\nabla g_2(a ) \\wedge r_n ~\\forall a\\in [ 0,1]\\end{array}\\big\\}\\ ] ] where we exploited @xmath1556 ) } , \\mathbf{1}_{c([0,1])})$ ] for @xmath1557)}$ ] and @xmath1558)}$ ] respectively the constant functions equal to one on @xmath1559 $ ] and @xmath1560 $ ] .    with regards to other elements needed to construct the bootstrap statistic ,",
    "we next let @xmath1561 be a minimizer of and for @xmath1562 note that @xmath1563 since the moment condition is linear in @xmath23 , there is no need to employ a numerical derivative to estimate @xmath389 and hence following remark [ rm : onder ] we just set @xmath1564 = - \\frac{1}{n } \\sum_{i=1}^n \\{(1 - d_i ) p^{j_n}_{-,n}(r_i)^\\prime \\beta_1   + d_i p^{j_n}_{+,n}(r_i)^\\prime   \\beta_2\\ } q^{k_n}_n(r_i , d_i)\\ ] ] for any @xmath1565 .",
    "analogously , in this instance @xmath386 equals @xmath1566 = - e_p[\\{(1 - d_i ) p^{j_n}_{-,n}(r_i)^\\prime \\beta_1   + d_i p^{j_n}_{+,n}(r_i)^\\prime   \\beta_2 \\}q^{k_n}_n(r_i , d_i)]\\ ] ] for any @xmath1565 . provided the eigenvalues of are bounded from above and away from zero , and recalling @xmath1477 , it is then straightforward to show @xmath1567\\|_r$ ] for any @xmath489 .",
    "moreover , by direct calculation @xmath1568 - \\mathbb d_{n , p}(\\theta_0)[h]\\|_r \\\\",
    "\\lesssim \\|\\frac{1}{n}\\sum_{i=1}^n q_n^{k_n}(r_i , d_i)q_n^{k_n}(r_i , d_i)^\\prime - e_p[q_n^{k_n}(r_i , d_i)q_n^{k_n}(r_i , d_i)^\\prime]\\|_{o,2}\\end{gathered}\\ ] ] and hence from theorem 6.1 in @xcite we can conclude that uniformly in @xmath287 @xmath1569 - \\mathbb d_{n , p}(\\theta_0)[h]\\|_r = o_p(\\frac{j_n\\sqrt{\\log(j_n)}}{\\sqrt n } ) ~.\\ ] ] in particular , holds provided @xmath1570 , and by lemma [ lm : lnotbind ] and remark [ rm : econtrol ] it follows that the bandwidth @xmath360 can be ignored if it is possible to set @xmath528 such that @xmath1571 .",
    "the additional requirements on @xmath360 are dictated by assumption [ ass : bootrates ] , which here become @xmath1572}(\\ell_n,\\mathcal f_n , \\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] .",
    "since we have shown @xmath1572}(\\mathcal r_n,\\mathcal f_n , \\|\\cdot\\|_{l^2_p } ) = o(a_n)$ ] , we conclude @xmath356 is feasible , and hence in this example we may employ @xmath1573 thus , combining , , , and , the bootstrap statistic becomes @xmath1574 \\|_{\\hat \\sigma_n , r } \\\\",
    "\\text { s.t . }",
    "\\text { ( i ) } ( \\frac{p_{-,n}^{j_n\\prime } \\beta_1}{\\sqrt n } , \\frac{p_{+,n}^{j_n\\prime } \\beta_2}{\\sqrt n } ) \\in g_n(\\hat \\theta ) , \\text { ( ii ) }   p_{-,n}^{j_n}(0)^\\prime \\beta_1 - p_{-,n}^{j_n}(0)^\\prime \\beta_2   = 0 ~.\\end{gathered}\\ ] ] finally , we note that theorem [ th : mainbootcoup ] provides sufficient conditions for assumption [ ass : bootcoupling ] , while using the bound @xmath1513 from @xcite and implies assumption [ ass : bootrates](iii ) is satisfied provided @xmath1575 .",
    "recall that in this application the parameter @xmath23 consists of a finite dimensional component @xmath1576 and a nonparametric function @xmath1577 . for notational simplicity ,",
    "we let @xmath1578 with @xmath1579 , and define the function @xmath1580 which constitutes the part of that depends on @xmath23 .",
    "similarly , we further define @xmath1581 which correspond to the moment conditions in and . for",
    "@xmath125 the observed bundle purchased by agent @xmath131 let @xmath1582 , and then note that the generalized residuals are @xmath1583 so that @xmath1584 for a total of @xmath129 restrictions .    in this instance , @xmath1585 and for illustrative purposes",
    "we select a noncompact parameter space by setting @xmath1586 . for @xmath660 a sequence of linear sieves in @xmath1587 and @xmath1588",
    "we then let @xmath460 be given by @xmath1589 for some constant @xmath847 and sequence @xmath1590 satisfying @xmath1591 .",
    "in turn , for @xmath246 we let @xmath1592 denote a sequence of transformations of @xmath114 , and recall @xmath1593 where @xmath1594 and @xmath1595 .",
    "we note , however , that since the conditioning variable is the same for all three moment conditions , in this instance we may in fact let @xmath1596 ",
    "i.e. employ the same transformation of @xmath642 for all three moment conditions .",
    "thus , given the above specifications , the test statistic @xmath267 is equivalent to @xmath1597 where constraint ( i ) corresponds to @xmath1470 , while constraints ( ii ) and ( iii ) impose that @xmath1598 .",
    "the latter two restrictions are standard sieve compactness conditions imposed in ( even parametric ) nonconvex estimation problems .    next , let @xmath1599 which we will assume to be differentiable , with @xmath1600 denoting the derivative with respect to @xmath1601 , and @xmath1602 for @xmath1603 equal to @xmath1604 and @xmath1605 the constant function that equals one everywhere . for @xmath1606 the frobenius norm of a matrix ,",
    "we further define @xmath1607 and then observe that by the mean value theorem and the cauchy - schwarz inequality @xmath1608 for any @xmath246 .",
    "defining @xmath1609 and assuming that @xmath1610 < \\infty$ ] , @xmath1611 is bounded uniformly in @xmath1612 , and that the matrix @xmath1613\\ ] ] has eigenvalues bounded away from zero and infinity uniformly in @xmath179 and @xmath254 , it then follows that @xmath1614 .",
    "therefore , by result and theorem 2.7.11 in @xcite we can conclude that @xmath1615}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\lesssim \\big(\\frac{c_n\\sqrt { j_n}}{\\epsilon}\\big)^{j_n } ~.\\ ] ] hence , since @xmath1616 and @xmath1617 , result yields @xmath1618}(\\eta,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\lesssim \\int_0^\\eta \\{1 + j_n \\log(\\frac{c_n \\sqrt { j_n}}{\\epsilon})\\}^{1/2 } d\\epsilon \\\\",
    "\\lesssim \\sqrt{j_n}\\int_0^{\\eta } \\log(\\frac{c_n\\sqrt{j_n}}{\\epsilon})d\\epsilon = \\sqrt{j_n}\\times \\{\\eta \\log(\\frac{c_n\\sqrt{j_n}}{\\eta } ) + \\eta\\ } ~.\\end{gathered}\\ ] ] in particular , since @xmath1619 is an envelope for @xmath215 , we obtain by setting @xmath1620 in that assumption [ ass : processreg](iii ) holds with @xmath1621 .",
    "we next study the rate of convergence under the assumption that the model is identified and hence set @xmath563  sufficient conditions for identification are provided by @xcite . for any @xmath1622 , we then define the norm @xmath1623 and note that since the eigenvalues of @xmath1624 $ ] were assumed to be bounded away from zero and infinity , remark [ rm : localid ] implies that assumption [ ass : keyrate ] holds with @xmath1625 provided that the smallest singular value of the matrix @xmath1626\\ ] ] is bounded away from zero uniformly in @xmath321 , @xmath179 , and @xmath287 . therefore ,",
    "assuming @xmath1627 is uniformly bounded in @xmath1628 , @xmath179 , @xmath1629 , and @xmath199 for simplicity , we obtain that under assumption [ ass : locrates](ii ) the rate @xmath318 delivered by theorem [ th : setrates ] becomes @xmath1630 where we exploited @xmath1631 and that as previously argued @xmath1632 .",
    "corollary [ cor : polycoup ] provides sufficient conditions for verifying assumption [ ass : coupling ] , while the definition of @xmath1633 , equation , the mean value theorem , and the cauchy schwarz inequality imply for any @xmath1634 and @xmath1635 that @xmath1636 = e_p[\\|m(z_i,\\theta_1 ) - m(z_i,\\theta_2)\\|_2 ^ 2 ] \\\\",
    "\\leq 6e_p[f_\\pi(z_i)^2\\|\\pi_1 - \\pi_2\\|_2 ^ 2 + f_\\delta(z_i)^2(p_n^{j_n}(y_i)^\\prime(\\beta_1 -\\beta_2))^2 ] \\lesssim \\|\\theta_1 - \\theta_2\\|^2_{\\mathbf e } ~,\\end{gathered}\\ ] ] where in the final inequality we exploited that @xmath1610 < \\infty$ ] and @xmath1611 is uniformly bounded by hypothesis .",
    "hence , we conclude from that assumption [ ass : rhocontrol ] holds with @xmath1481 , and combining and we obtain that @xmath1637 implies assumption [ ass : locrates](i ) holds . unlike in examples",
    "[ ex : slutzky ] and [ ex : rd ] , however , @xmath412 is nonlinear in @xmath23 and hence assumption [ ass : driftlin ] is harder to verify . to this end ,",
    "recall @xmath1638 $ ] , and for any @xmath1639 define @xmath1640 = \\nabla_\\pi m_\\jmath(z_i,\\theta)\\pi + \\nabla_\\delta m_\\jmath ( z_i,\\theta ) \\delta(y_i ) ~,\\ ] ] which we note satisfies assumption [ ass : driftlin](iii ) with @xmath1641 . next",
    ", we suppose that for any @xmath1642 with @xmath1643 and @xmath1644 @xmath1645 for some functions @xmath1646 satisfying @xmath1647 < \\infty$ ] and a constant @xmath1648  a sufficient conditions is that @xmath1633 be twice continuously differentiable with respect to @xmath23 and that such derivatives be uniformly bounded .",
    "exploiting results and , we then obtain by the mean value theorem that for any @xmath1649 @xmath1650\\|_{l^2_p } \\\\\\leq \\{\\|\\pi\\|_2 + \\sup_{p\\in \\mathbf p } \\|\\delta\\|_{l^2_p}\\}\\times \\{(g_\\delta + \\sup_{p\\in",
    "\\mathbf p } \\|g_\\pi\\|_{l^2_p } ) \\|\\pi\\|_2 + g_\\delta \\times \\|\\delta\\|_{\\infty}\\ } ~.\\end{gathered}\\ ] ] therefore , setting @xmath1651 we conclude that assumption [ ass : driftlin](i ) holds with the norm @xmath1652 for any @xmath1622 .",
    "identical arguments as in further verify assumption [ ass : driftlin](ii ) for the same choice of @xmath598 and @xmath367 . because @xmath367 in fact metrizes the product topology in @xmath19 , in this example we actually have @xmath1653 and @xmath1654 .",
    "moreover , since the smallest eigenvalue of @xmath1624 $ ] was assumed to be bounded away from zero uniformly in @xmath254 , we also obtain that @xmath1655 where the final inequality applies when @xmath660 are fourier , spline , or wavelet series since then @xmath1656 @xcite .",
    "if @xmath660 are polynomial series instead , then holds with @xmath661 in place of @xmath1657 .    now turning to the construction of the bootstrap statistic",
    ", we let @xmath1658 be a minimizer of , and setting @xmath1659 we then define @xmath1660 for @xmath412 as defined in .",
    "since @xmath412 is differentiable in @xmath23 we do not employ a numerical derivative , but instead follow remark [ rm : onder ] and set for any @xmath1661 @xmath1662 \\equiv \\frac{1}{n}\\sum_{i=1}^n \\ { \\nabla_\\pi m(z_i,\\hat \\theta ) \\pi + \\nabla_\\delta m(z_i,\\hat \\theta ) \\delta(y_i ) \\ } * q_n^{k_n}(z_i ) ~.\\ ] ] next , we note that assumption [ ass : extra](i ) holds with @xmath1663 , while linearity of @xmath21 implies assumptions [ ass : locineq](i)-(ii ) hold with @xmath520 , while assumption [ ass : locineq](iii ) is satisfied with @xmath1553 by direct calculation . in turn , since no equality restrictions are present in this problem , assumptions [ ass : loceq ] and [ ass : ineqlindep ] are not needed  formally they are automatically satisfied by setting @xmath76 and letting @xmath535 for all @xmath79 .",
    "thus , here we have @xmath1664 hence , since @xmath1552 , according to remark [ rm : econtrol ] we may set @xmath1665 to equal @xmath1666 finally , we observe that theorem [ th : mainbootcoup ] provides sufficient conditions for assumption [ ass : bootcoupling ] , while assumption [ ass : bootrates](i ) is automatically satisfied since @xmath563 .",
    "moreover , exploiting results , , and , it follows that assumption [ ass : bootrates](ii ) reduces to @xmath1667 and assumption [ ass : bootrates](iii)-(iv ) are satisfied whenever @xmath1668 . furthermore , since the eigenvalues of have been assumed to be bounded away from zero and infinity , it follows that @xmath1669 uniformly in @xmath1670 and @xmath179 .",
    "therefore , from results and , the bootstrap statistic equals @xmath1671\\|_{\\hat \\sigma_n , r } \\\\ \\text { s.t .",
    "( i ) } \\frac{p_n^{j_n}(y)^\\prime \\beta}{\\sqrt",
    "n } \\leq \\max\\{0 , -p_n^{j_n}(y)^\\prime\\hat \\beta - r_n\\ } ~\\forall y , \\text { ( ii ) } \\|\\pi\\|_2 \\vee \\|\\beta\\|_2 \\leq \\sqrt n \\ell_n ~.\\end{gathered}\\ ] ]    alternatively , under slightly stronger requirements , it is possible to appeal to lemma [ lm : lnotbind ] to conclude that the bandwidth @xmath360 is unnecessary ",
    "i.e. the second constraint in can be ignored . to this end",
    ", we note that for any @xmath1672 , we have @xmath1673 = e_p[\\{\\nabla_\\pi m(z_i,\\theta ) \\pi + \\nabla_\\delta m(z_i,\\theta)p_n^{j_n}(y_i)^\\prime \\beta\\}*q_n^{k_n}(z_i ) ] ~.\\ ] ] since @xmath1674 , @xmath1675 for any @xmath762 , and we assumed the smallest singular value of and the largest eigenvalue of are respectively bounded away from zero and infinity uniformly in @xmath321 , @xmath179 , and @xmath287 , we obtain @xmath1676\\|_r\\ ] ] for any @xmath321 , @xmath287 , and @xmath377 . in order to verify , we define the class @xmath1677 . since @xmath1678 ,",
    "as exploited in , and @xmath1627 was assumed to be uniformly bounded , it follows from that @xmath1679 is an envelope for @xmath1680 for @xmath1681 sufficiently large .",
    "therefore , it follows that @xmath1682 \\lesssim   j_{[\\hspace{0.03 in } ] } ( \\|\\sqrt{j_n}f_\\delta k_0\\|_{l^2_p},\\mathcal g_{n,\\delta},\\|\\cdot\\|_{l^2_p})\\ ] ] by theorem 2.14.2 in @xcite .",
    "furthermore , exploiting once again that @xmath1683 and condition we can conclude @xmath1684 for any @xmath1685 and @xmath1686 . thus , result , theorem 2.7.11 in @xcite , and arguing as in and implies @xmath1687}(\\|\\sqrt { j_n}f_\\delta\\|_{l^2_p},\\mathcal g_{\\delta , n},\\|\\cdot\\|_{l^2_p } ) = o(j_n \\log(c_nj_n))$ ] .",
    "similarly , if we define @xmath1688 , then by analogous arguments we can conclude @xmath1689 = o(j_n\\log(c_nj_n ) ) ~.\\ ] ] thus , employing the above results together with markov s inequality finally implies that @xmath1690 - \\mathbb d_{n , p}(\\theta)[h]\\|_r \\\\",
    "\\lesssim \\frac{\\sqrt{k_n}}{\\sqrt n } \\times \\{\\sup_{g\\in \\mathcal g_{\\pi , n } } |\\mathbb g_n g| + \\sup_{g\\in \\mathcal g_{\\delta , n } } |\\mathbb g_n g|\\ } = o_p(\\frac{\\sqrt{k_n } j_n \\log(c_nj_n)}{\\sqrt n } ) ~.\\end{gathered}\\ ] ] exploiting and , it then follows that the conditions of lemma [ lm : lnotbind ] are satisfied and constraint ( ii ) in can be ignored if @xmath360 can be chosen to simultaneously satisfy assumption [ ass : bootrates ] and @xmath1691 .",
    "these requirements are met provided that @xmath1692 which represents a strengthening of  note strengthening to potentially makes assumption [ ass : locrates](ii ) less tenable .",
    "hence , under we may set @xmath1693\\|_{\\hat \\sigma_n , r } \\\\ \\text { s.t . }",
    "\\frac{p_n^{j_n}(y)^\\prime \\beta}{\\sqrt n } \\leq \\max\\{0 , -p_n^{j_n}(y)^\\prime\\hat \\beta - r_n\\ } \\text { for all } y ~,\\end{gathered}\\ ] ] i.e. the second constraint in may be ignored when computing the bootstrap critical values .",
    "an observation @xmath131 in this example was assumed to consist of an instrument @xmath1694 and a pair of individuals @xmath1695 for whom we observe the hospital @xmath1696 in the network @xmath130 that they were referred to , as well as for all hospitals @xmath135 the cost of treatment @xmath133 and distance to hospital @xmath134 .",
    "@xcite then derive @xmath1697 \\leq 0\\ ] ] where @xmath137 , @xmath138 is an unknown monotonic function , and @xmath140 . for notational simplicity ,",
    "we let @xmath1698 and define @xmath1699 in addition , we assume that the supports of @xmath1700 and @xmath1701 are contained in a bounded set uniformly in @xmath254 and @xmath111 , which we normalize to @xmath1560 $ ] . finally , recall that in this example @xmath1702 is the parameter of interest , and that we aim to test @xmath1703 employing the moment restriction while imposing monotonicity of @xmath1704 .    in order to map this problem into our framework ,",
    "we follow the discussion of example [ ex : condineq ] in the main text  see equations -  and rewrite restriction as @xmath1705 + \\lambda_0(z_i ) = 0 ~,\\ ] ] for a function @xmath150 satisfying @xmath1706 .",
    "we further define the hilbert space @xmath1707 by @xmath1708 \\rightarrow \\mathbf r : \\|f\\|_{l^2_u }",
    "< \\infty \\text { for } \\|f\\|_{l^2_u}^2 \\equiv \\int_0 ^ 1 f^2(u)du\\}\\ ] ] and note @xmath1530)\\subset l^2_u$ ] .",
    "the parameter in this example is thus @xmath1709 which we view as an element of @xmath1710)\\times \\ell^\\infty(\\mathbf r^{d_z})$ ] , and set as the residual @xmath1711 for any @xmath1712 . the hypothesis in",
    "can then be tested by letting @xmath76 and @xmath158 for any @xmath79 , and imposing the monotonicity constraint on @xmath155 and positivity restriction on @xmath10 by setting @xmath1713)\\times \\ell^\\infty(\\mathbf r^{d_z})$ ] and @xmath1714 for any @xmath79 . finally , as in example [ ex : comp ] we utilize a noncompact parameter space and let @xmath1586 , which together with the preceding discussion verifies the general structure of our framework imposed in assumptions [ ass : param ] and [ ass : r ] .    to build the test statistic @xmath267 , we let @xmath1715 denote a triangular array of partitions of @xmath1716 , and set @xmath1717 . for ease of computation ,",
    "it is convenient to also employ @xmath1718 as a sieve for @xmath1719 and thus for a sequence @xmath1591 we approximate @xmath1719 by the set @xmath1720 in turn , for @xmath660 a triangular array of orthonormal functions in @xmath1707 such as b - splines or wavelets , and @xmath1721 we let the sieve for @xmath19 be given by @xmath1722 given the stated parameter choices , the test statistic @xmath267 is then equivalent to @xmath1723 where restriction ( i ) imposes that @xmath506 and the requirement @xmath1724 can be ignored as argued in remark [ rm : interiority ] , and restrictions ( ii ) and ( iii)-(iv ) respectively enforce the equality @xmath1725 and inequality @xmath1726 constraints . while we introduce due to its link to our general formulation in , it is actually more convenient to work with a profiled version of @xmath267 . specifically , the choice of sieve @xmath1727 enables us to easily profile the optimal @xmath1728 in for any given choice of @xmath1729 leading to @xmath1730    the ability to profile out the nuisance parameter @xmath10 grants this problem an additional structure that enables us to weaken some of our assumptions . in particular , the rate of convergence of the minimizers of @xmath267 in is better studied through direct arguments rather than a reliance on theorem [ th : setrates ] . to this end ,",
    "let @xmath1731 denote the profiled set @xmath275 and profiled sieve @xmath194 .",
    "for each @xmath1732 we then denote the corresponding population and sample profiled @xmath10 by @xmath1733 \\wedge 0\\ } \\label{eq : condineqdet12}\\\\ \\hat \\lambda_{n}^{(\\gamma , g)}(z ) & \\equiv -\\sum_{k=1}^{k_{n } } 1\\{z \\in a_{k , n}\\ } \\{\\frac{\\sum_{i=1}^n 1\\{z_i \\in a_{k , n}\\}\\psi(x_i,\\gamma , g)}{\\sum_{i=1}^n 1\\{z_i \\in a_{k , n}\\ } } \\wedge 0\\ } \\label{eq : condineqdet13 } ~,\\end{aligned}\\ ] ] and observe that @xmath1734 .",
    "therefore , defining @xmath1735 we can then construct a set estimator for the profiled identified set @xmath1736 by setting @xmath1737 for some @xmath268 .",
    "next , we note that the collection of transformations @xmath663 is orthogonal in @xmath226 , yet not orthonormal . in order to normalize them",
    ", we suppose that @xmath1738 which implies @xmath1739 uniformly in @xmath254 , @xmath1740 , and @xmath179 . following the discussion of examples [ ex : slutzky ] ,",
    "[ ex : rd ] , and [ ex : comp ] we further impose the condition @xmath1741\\vee 0\\|_r + o(\\zeta_n)\\ } ~.\\end{gathered}\\ ] ] defining @xmath1742 , next suppose that @xmath1743 \\asymp e_p[g^2(d_{ij}(h_{ij^\\prime}))]\\ ] ] uniformly in @xmath1744 , @xmath111 , and @xmath254 .",
    "if in addition @xmath1745 $ ] is bounded uniformly in @xmath254 and @xmath1695 , then @xmath789 has an envelope @xmath906 satisfying @xmath1746 . arguing as in it is then possible to show @xmath1747}(c_n,\\mathcal g_n,\\|\\cdot\\|_{l^2_p } )",
    "\\lesssim c_n\\sqrt { j_n\\log(k_n ) } ~,\\ ] ] and hence letting @xmath1748 \\vee 0\\|_{\\hat \\sigma_n , r}$ ] for any @xmath1749 we obtain by theorem 2.14.2 in @xcite that @xmath1750 uniformly in @xmath254 since @xmath1751 uniformly in @xmath254 by lemma [ aux : weights ] . under and the proof of theorem [ th : setrates ] applies without changes , and therefore under the no - bias condition of assumption [ ass :",
    "locrates](ii ) we obtain uniformly in @xmath254 @xmath1752 moreover , it also follows from that for any @xmath1753 we have @xmath1754 in addition , by standard arguments ",
    "see e.g. lemmas 2.2.9 and 2.2.10 in @xcite  it also follows from that uniformly in @xmath254 we have @xmath1755 while under theorem 2.14.2 in @xcite implies that @xmath1756| =   o_p(\\frac{c_n\\sqrt{j_n\\log(k_n)}}{\\sqrt n } ) ~.\\ ] ] thus , combining , , with the definitions in and yields @xmath1757 hence , setting @xmath1758 for any @xmath1759 , and @xmath1760 we finally obtain from @xmath1734 , results , , and that uniformly in @xmath254 we have that @xmath1761 for the rest of the following discussion , we thus let @xmath1762 and set @xmath318 to equal @xmath1763 compare to result in the main text .    with regards to section [ sec : strongapprox ]",
    ", we refer to corollary [ cor : polycoup ] for sufficient conditions for assumption [ ass : coupling ] , while assumption [ ass : rhocontrol ] is satisfied with @xmath1481 and some @xmath1764 since @xmath1765 for any @xmath1766 and we assumed holds .",
    "moreover , from and arguing as in we calculate @xmath1767}(\\eta , \\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\lesssim \\sqrt{j_n\\vee k_n } ( \\eta\\log(\\frac{c_n}{\\eta } ) + \\eta ) ~,\\ ] ] which together with implies that a sufficient conditions for assumption [ ass : locrates](i ) is @xmath1768 in turn , we note the definitions of @xmath1769 and @xmath412 in and imply @xmath1770 = e_p[\\psi(x_i,\\gamma , g)|z_i ] + \\lambda ( z_i ) ~,\\ ] ] and hence assumption [ ass : driftlin](i)-(ii ) holds with @xmath383 , while assumption [ ass : driftlin](iii ) is satisfied for some @xmath1771 since we assumed that @xmath1745 $ ] is bounded uniformly in @xmath254 and imposed condition .    turning to the construction of the bootstrap statistic , we first recall that any @xmath565 is of the form @xmath1772 for some @xmath1773  see .",
    "therefore , @xmath1774 for any @xmath1775 .",
    "next , also note that for any @xmath79 and @xmath1776 , definitions and imply that the estimator @xmath442 $ ] ( as in ) is equal to @xmath1777 = \\frac{1}{n}\\sum_{i=1}^n \\{\\psi(x_i,\\gamma , g ) + \\lambda(z_i)\\}*q_{n}^{k_{n}}(z_i ) ~.\\ ] ] we further observe that if we metrize the topology on @xmath1778)\\times \\ell^\\infty(\\mathbf r^{d_z})$ ] by @xmath1779 for any @xmath154 , then assumption [ ass : extra](i ) holds with @xmath1780 . in turn",
    ", we also note that since @xmath1781)\\times \\ell^\\infty(\\mathbf r^{d_z})$ ] is linear and continuous , assumptions [ ass : locineq](i)-(iii ) are satisfied with @xmath520 , some finite @xmath1782 , and @xmath500 = -(g^\\prime,\\lambda)$ ] for any @xmath79 and @xmath1776 .",
    "similarly , since @xmath1783 is affine and @xmath1784 = \\gamma$ ] for any @xmath79 and @xmath1776 , assumption [ ass : ineqlindep ] is automatically satisfied , while assumption [ ass : loceq ] holds with @xmath1241 and @xmath1509 .",
    "writing each @xmath1785 in the form @xmath1786 , we then finally obtain that @xmath1787\\|_{\\hat \\sigma_n , r } \\nonumber \\\\ \\text { s.t .",
    "} & \\text{(i ) } \\gamma = 0 , \\hspace{1.52 in } \\text { ( ii ) } \\frac{\\pi}{\\sqrt n } \\geq 0 \\wedge ( r_n - \\hat \\pi ) \\nonumber \\\\ & \\text{(iii ) }   \\frac{\\nabla p_n^{j_n\\prime}\\beta}{\\sqrt n } \\geq 0 \\wedge ( r_n - \\hat g^\\prime ) , \\hspace{0.3 in } \\text { ( iv ) } \\|\\frac{p_n^{j_n\\prime}\\beta}{\\sqrt n}\\|_{1,\\infty}\\vee \\|\\frac{\\pi}{\\sqrt n}\\|_\\infty \\leq \\ell_n\\end{aligned}\\ ] ] where constraint ( i ) corresponds to @xmath1517 , the restrictions in ( ii ) and ( iii ) impose @xmath1518 , and the constraint in ( iv ) demand @xmath533  compare to the definition of @xmath529 in . as in section",
    "[ sec : sim ] , constraint ( iii ) reduces to a finite number of linear constraints when employing orthonormalized b - splines of order 3 as the basis @xmath660 . moreover , under such a choice of sieve we further have @xmath1788 ( see @xcite ) and thus exploiting @xmath1789 it may be preferable for easy of computation to replace the constraint @xmath1790 in by the more conservative but linear constraints @xmath1791 .",
    "we refer to theorem [ th : mainbootcoup ] for sufficient conditions for assumption [ ass : bootcoupling ] to hold , and focus on the rate requirements imposed by assumption [ ass : bootrates ] . to this end , we first observe @xmath1792 where in the second inequality we exploited implies that @xmath1793 , and the final inequality follows from @xmath1794 due to @xmath1715 being a partition of @xmath1716 .",
    "hence , results and together imply that @xmath1795 we think it advisable to set @xmath563 which automatically satisfies assumption [ ass : bootrates ] and is simpler to implement , though we note that in contrast to examples [ ex : slutzky ] , [ ex : rd ] , and [ ex : comp ] such a choice may lead to a loss of power .",
    "we further note that the rate of convergence derived in and the bound in imply assumption [ ass : bootrates](iii ) is satisfied provided @xmath1796 finally , we note implies the conditions imposed on @xmath360 by assumption [ ass : bootrates ] become @xmath1797 in parallel to examples [ ex : slutzky ] , [ ex : rd ] , and [ ex : comp ] it may be possible to establish under additional conditions that the bandwidth @xmath360 is not necessary  i.e. that constraint ( iv ) may be dropped in .",
    "unfortunately , such a conclusion can not be reached by applying lemma [ lm : lnotbind ] due to a failure of the condition @xmath1798\\|_r$ ] for all @xmath1799 and @xmath1800 , which is required by lemma [ lm : lnotbind ] .      in this appendix",
    "we develop uniform coupling results for empirical processes that help verify assumption [ ass : coupling ] in specific applications .",
    "the results are based on the hungarian construction of @xcite and @xcite , and are stated in a notation that abstracts from the rest of the paper due to the potential independent interest of the results .",
    "thus , in this appendix we consider @xmath1801 as a generic random variable distributed according to @xmath199 and denote its support under @xmath6 by @xmath1802 .",
    "the rates obtained through a hungarian construction crucially depend on the ability of the functions inducing the empirical process to be approximated by a suitable haar basis . here , we follow @xcite and control the relevant approximation errors through primitive conditions stated in terms of the integral modulus of continuity .",
    "specifically , for @xmath10 the lebesgue measure and a function @xmath1803 , the integral modulus of continuity of @xmath208 is the function @xmath1804 given by @xmath1805 intuitively , the integral modulus of continuity quantifies the  smoothness \" of a function @xmath208 by examining the difference between @xmath208 and its own translation . for lipschitz function @xmath208 , it is straightforward to show for instance that @xmath1806 .",
    "in contrast indicator functions such as @xmath1807 typically satisfy @xmath1808 .        [",
    "ass : supportreg ] ( i ) for each @xmath254 there is a continuously differentiable bijection @xmath1814^{d_v } \\rightarrow \\omega(p)$ ] ; ( ii ) the jacobian @xmath1815^{d_v}\\rightarrow \\mathbf r$ ] and derivative @xmath1816^{d_v}\\rightarrow \\omega(p)$ ] satisfy @xmath1817^{d_v } } |jt_p(v)| > 0 $ ] and @xmath1818^{d_v } } \\|jt_p(v)\\|_{o,2 } < \\infty$ ] .",
    "[ ass : coupprocessreg ] the classes of functions @xmath215 satisfy : ( i ) @xmath1819 for some @xmath1820 satisfying @xmath1821 for all @xmath179 , @xmath1822 , and some @xmath1823 ; and ( ii ) @xmath1824 for some @xmath1825 .",
    "in assumption [ ass : coupreg ] we impose that @xmath1826 be continuously distributed for all @xmath254 , with uniformly ( in @xmath6 ) bounded supports and densities bounded from above and away from zero .",
    "assumption [ ass : supportreg ] requires that the support of @xmath1827 under each @xmath6 be  smooth \" in the sense that it may be seen as a differentiable transformation of the unit square .",
    "together , assumptions [ ass : coupreg ] and [ ass : supportreg ] enable us to construct partitions of @xmath1810 such that the diameter of each set in the partition is controlled uniformly in @xmath6 ; see lemma [ aux : coup ] .",
    "as a result , the approximation error by the haar bases implied by each partition can be controlled uniformly by the integral modulus of continuity ; see lemma [ aux : haar ] . together with assumption [ ass : coupprocessreg ] , which imposes conditions on the integral modulus of continuity of @xmath215 uniformly in @xmath6 , we can obtain a uniform coupling result through @xcite .",
    "we note that the homogeneity condition on @xmath1828 in assumption [ ass : coupprocessreg](i ) is not necessary , but imposed to simplify the expression for the bound .",
    "[ th : coup ] let assumptions [ ass : coupreg]-[ass : coupprocessreg ] hold , @xmath244 be i.i.d . with @xmath245 and for any @xmath874 let @xmath1829}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] , @xmath1830}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] , and @xmath1831 if @xmath1832 , then there exist processes @xmath1833 such that uniformly in @xmath254 we have @xmath1834    theorem [ th : coup ] is a mild modification of the results in @xcite .",
    "intuitively , the proof of theorem [ th : coup ] relies on a coupling of the empirical process on a sequence of grids of cardinality @xmath1835 , and relying on equicontinuity of both the empirical and isonormal processes to obtain a coupling on @xmath215 .",
    "the conclusion of theorem [ th : coup ] applies to any choice of grid accuracy @xmath941 . in order to obtain the best rate that theorem [ th : coup ] can deliver ,",
    "however , the sequence @xmath941 must be chosen to balance the terms in and thus depends on the metric entropy of the class @xmath215 .",
    "the following corollary illustrates the use of theorem [ th : coup ] by establishing a coupling result for euclidean classes .",
    "we emphasize , however , that different metric entropy assumptions on @xmath215 lead to alternative optimal choices of @xmath941 in theorem [ th : coup ] and thus also to differing coupling rates .",
    "[ cor : polycoup ] let assumption [ ass : iid ] , [ ass : instreg](i ) , [ ass : coupreg ] , [ ass : supportreg ] hold , and @xmath1836 be bounded uniformly in @xmath179 and @xmath254 .",
    "if @xmath1837 for some @xmath1838 $ ] , @xmath1839}(\\epsilon , \\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\leq ( d/\\epsilon)^{j_n}$ ] for some @xmath1840 and @xmath1841 , and @xmath1842 , then it follows that uniformly in @xmath254 we have @xmath1843      proof of theorem [ th : coup ] : let @xmath1844 be a sequence of partitions of @xmath1810 as in lemma [ aux : coup ] , and @xmath1845 the @xmath650-algebra generated by @xmath1846 . by lemma [ aux : haar ] and assumption [ ass : coupprocessreg ] , @xmath1847)^2])^{\\frac{1}{2 } } \\\\",
    "\\leq c_1 ( \\sum_{i=0}^ { \\lceil\\log_2 n\\rceil } 2^{i}\\varphi_n^2(2^{-\\frac{i}{d_v } } ) ) ^{\\frac{1}{2 } } \\equiv c_1s_n\\end{gathered}\\ ] ] for some constant @xmath1848 , and for @xmath1849 as defined in .",
    "next , let @xmath1850 denote a finite @xmath941-net of @xmath215 with respect to @xmath219 .",
    "since @xmath1851}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] , it follows from the definition of @xmath1835 that we may choose @xmath1852 so that @xmath1853}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\equiv n_n~.\\ ] ] by theorem 3.5 in @xcite , and , it follows that for each @xmath932 there exists an isonormal process @xmath225 , such that for all @xmath1854 , @xmath1855 @xmath1856 for some @xmath1857 . since @xmath1832 , implies for any @xmath1858 there are @xmath1859 , @xmath1860 sufficiently large , such that setting @xmath1861 and @xmath1862 yields @xmath1863 next , note that by definition of @xmath1852 , there exists a @xmath1864 such that @xmath1865 .",
    "let @xmath1866 denote the @xmath218-packing number for @xmath215 under @xmath219 , and note @xmath1867}(\\epsilon,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})$ ] .",
    "therefore , by corollary 2.2.8 in @xcite we can conclude that @xmath1868 \\\\",
    "\\lesssim \\sup_{p\\in \\mathbf p}\\int_0^{\\delta_n } \\sqrt{\\log d(\\epsilon,\\mathcal f_n , \\|\\cdot\\|_{l^2_p})}d\\epsilon \\leq \\sup_{p\\in \\mathbf p}j_{[\\hspace{0.02 in}]}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\equiv j_n ~.\\end{gathered}\\ ] ] similarly , employing lemma 3.4.2 in @xcite yields that @xmath1869 \\\\ \\lesssim \\sup_{p\\in \\mathbf p}j_{[\\hspace{0.02 in}]}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})(1 + \\sup_{p\\in \\mathbf p } \\frac{j_{[\\hspace{0.02 in}]}(\\delta_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p})k_n}{\\delta_n^2\\sqrt{n } } ) \\equiv j_n(1 + \\frac{j_nk_n}{\\delta_n^2\\sqrt{n}})\\end{gathered}\\ ] ] therefore , combining results , , and together with the decomposition @xmath1870 establishes the claim of the theorem by markov s inequality .",
    "proof of corollary [ cor : polycoup ] : define the class @xmath1871 , and note that lemma [ aux : simpbracket ] implies that for any @xmath874 @xmath1872}(\\delta_n,\\mathcal g_n,\\|\\cdot\\|_{l^2_p})\\leq k_n \\times \\sup_{p\\in \\mathbf p}n_{[\\hspace{0.03 in}]}(\\delta_n /b_n,\\mathcal f_n,\\|\\cdot\\|_{l^2_p } ) \\leq k_n \\times ( \\frac{d b_n}{\\delta_n})^{j_n } ~.\\ ] ] similarly , exploiting , @xmath874 and @xmath1616 we conclude @xmath1873}(\\delta_n,\\mathcal g_n,\\|\\cdot\\|_{l^2_p } ) \\leq \\int_0^{\\delta_n } \\{\\log(k_n ) + j_n \\log ( \\frac{db_n}{\\epsilon})\\}^{1/2}d\\epsilon \\\\ \\lesssim ( \\sqrt{\\log(k_n ) } + \\sqrt { j_n } ) \\int_0^{\\delta_n } \\log(\\frac{db_n}{\\epsilon})d\\epsilon \\lesssim ( \\sqrt { \\log ( k_n ) } + \\sqrt { j_n})\\times \\delta_n \\log(\\frac{b_n}{\\delta_n } ) ~.\\end{gathered}\\ ] ] in turn , note that for @xmath1849 as defined in , we obtain from @xmath1874 that @xmath1875 finally , we also note that @xmath1876 due to assumption [ ass : instreg](i ) and @xmath1877 being uniformly bounded by hypothesis .",
    "therefore , setting @xmath1878 in and , and exploiting @xmath901 for any @xmath822 we obtain that @xmath1879 uniformly in @xmath254 by theorem [ th : coup ] .",
    "[ aux : coup ] let @xmath1880 denote the completion of the borel @xmath1881algebra on @xmath1810 with respect to @xmath6 . if assumptions [ ass : coupreg](i)-(ii ) and [ ass : supportreg](i)-(ii ) hold , then for each @xmath254 there exists a sequence @xmath1844 of partitions of the probability space @xmath1882 such that :              proof : let @xmath1893 denote the borel @xmath650-algebra on @xmath1560^{d_v}$ ] , and for any @xmath1894 define @xmath1895 where @xmath1896 due to @xmath1897 being measurable .",
    "moreover , @xmath1898^{d_v } ) = 1 $ ] due to @xmath1899 being surjective , and @xmath1900 is @xmath650-additive due to @xmath1899 being injective .",
    "hence , we conclude @xmath1900 defined by is a probability measure on @xmath1901^{d_v } , \\mathcal a$ ] ) .",
    "in addition , for @xmath10 the lebesgue measure , we obtain from theorem 3.7.1 in @xcite that @xmath1902 where @xmath1903 denotes the jacobian of @xmath1899 at any point @xmath1904^{d_v}$ ] .",
    "hence , @xmath1900 has density with respect to lebesgue measure given by @xmath1905 for any @xmath1906^{d_v}$ ] .",
    "next , let @xmath1907^{d_v}$ ] and define for any @xmath1908 $ ] @xmath1909 for any set @xmath1910 and @xmath1911 . further let @xmath1912  i.e. @xmath1913 equals @xmath131 modulo @xmath1914  and setting @xmath1915^{d_v}$ ] inductively define the partitions ( of @xmath1560^{d_v}$ ] ) @xmath1916 for @xmath1917 . for @xmath1918 the closure of @xmath1919",
    ", we then note that by construction each @xmath1919 is a hyper - rectangle in @xmath1560^{d_v}$ ]  i.e. it is of the general form @xmath1920 ~.\\ ] ] moreover , since @xmath1921 is positive everywhere on @xmath1560^{d_v}$ ] by assumptions [ ass : coupreg](ii ) and [ ass : supportreg](ii ) , it follows that for any @xmath1922 , @xmath1923 and @xmath1924 , we have @xmath1925 similarly , since @xmath1926 , it additionally follows that @xmath1927 since @xmath1928 by @xmath1929 , and yield @xmath1930 therefore , since @xmath1931 , it follows that @xmath1932 for @xmath1933 as well .",
    "in particular , @xmath1934 implies that @xmath1935 for any integers @xmath1936 and @xmath1937 .",
    "moreover , we note that result and assumptions [ ass : coupreg](ii ) and [ ass : supportreg](ii ) together imply that the densities @xmath1921 of @xmath1900 satisfy @xmath1938^{d_v } } g_p(a ) < \\sup_{p\\in \\mathbf p}\\sup_{a\\in [ 0,1]^{d_v } } g_p(a ) < \\infty ~,\\ ] ] and therefore @xmath1939 uniformly in @xmath1894 and @xmath254",
    ". hence , since by @xmath1940 and @xmath1941 for all @xmath1942 , we obtain @xmath1943 uniformly in @xmath199 , @xmath1944 , and @xmath1937 by results and .",
    "moreover , by identical arguments but using instead of we conclude @xmath1945 also uniformly in @xmath254 , @xmath1889 and @xmath1917 .",
    "thus , since @xmath1946 for all @xmath1947 , and @xmath1948 for all @xmath1924 we obtain from @xmath1949 , results and , and proceeding inductively that @xmath1950 uniformly in @xmath254 , @xmath1889 , @xmath1917 , and @xmath1924 .",
    "thus , result yields @xmath1951    we next obtain the desired sequence of partitions @xmath1844 of @xmath1952 by constructing them from the partition @xmath1953 of @xmath1560^{d_v}$ ] . to this end ,",
    "set @xmath1954 for all @xmath1889 and @xmath1937 .",
    "note that @xmath1844 satisfies conditions ( i ) and ( ii ) due to @xmath1897 being a measurable map , @xmath1899 being bijective , and result .",
    "in addition , @xmath1844 satisfies condition ( iii ) since by definition and result : @xmath1955 for all @xmath1937 .",
    "moreover , by assumption [ ass : supportreg](ii ) , @xmath1956^{d_v } } \\|t^\\prime_p(a)\\|_{o,2 } < \\infty$ ] , and hence by the mean value theorem we can conclude that @xmath1957 by result , which verifies that @xmath1844 satisfies condition ( iv ) .",
    "also note that to verify @xmath1844 satisfies condition ( v ) it suffices to show that @xmath1892 generates the borel @xmath650-algebra on @xmath1810 . to this end",
    ", we first aim to show that @xmath1958 where for a collection of sets @xmath1959 , @xmath1960 denotes the @xmath650-algebra generated by @xmath1959 . for any closed set @xmath1910 , then define @xmath1961 to be given by @xmath1962 notice that since @xmath1963 is a partition of @xmath1560^{d_v}$ ] , @xmath1964 for all @xmath1922 and hence @xmath1965 .",
    "moreover , if @xmath1966 , then @xmath1967 being open and imply @xmath1968 for @xmath131 sufficiently large .",
    "hence , @xmath1969 and therefore @xmath1970 .",
    "it follows that if @xmath183 is closed , then @xmath1971 , which implies @xmath1972 . on the other hand , since @xmath1919 is borel for all @xmath1889 and @xmath1933 , we also have @xmath1973 , and hence follows . to conclude , we then note that @xmath1974 by corollary 1.2.9 in @xcite .",
    "however , @xmath1899 and @xmath1897 being continuous implies @xmath1975 equals the borel @xmath650-algebra in @xmath1810 , and therefore implies @xmath1844 satisfies condition ( v ) establishing the lemma .",
    "[ aux : haar ] let @xmath1844 be as in lemma [ aux : coup ] , and @xmath1845 denote the @xmath650-algebra generated by @xmath1846 .",
    "if assumptions [ ass : coupreg](i)-(ii ) and [ ass : supportreg](i)-(ii ) hold , then there are constants @xmath898 , @xmath1976 such that for all @xmath254 and any @xmath208 satisfying @xmath437 for all @xmath254 : @xmath1977)^2 ] \\leq k_0\\times \\varpi^2(f , k_1\\times 2^{-\\frac{i}{d_v}},p ) ~.\\ ] ]    proof : since @xmath1846 is a partition of @xmath1810 and @xmath1978 for all @xmath1889 and @xmath1979 , we may express @xmath1980 $ ] as an element of @xmath226 by @xmath1981 = 2^i \\sum_{k=0}^{2^i-1 } 1\\{v\\in \\delta_{i , k}(p)\\ } \\int_{\\delta_{i , k}(p ) } f(v)dp(v ) ~.\\ ] ] hence , result , @xmath1978 for all @xmath1889 and @xmath1979 together with @xmath1846 being a partition of @xmath1810 , and applying holder s inequality to the term @xmath1982 we obtain that @xmath1983)^2 ] \\nonumber \\\\ & = \\sum_{k=0}^{2^i-1 } \\int_{\\delta_{i , k}(p ) } ( f(v ) - 2^i \\int_{\\delta_{i , k}(p ) } f(\\tilde v)dp(\\tilde v))^2 dp(v ) \\nonumber \\\\ & = \\sum_{k=0}^{2^i-1}2^{2i } \\int_{\\delta_{i , k}(p ) } ( \\int_{\\delta_{i , k}(p)}(f(v ) - f(\\tilde v))1\\ { v\\in \\omega(p)\\ } dp(\\tilde v))^2dp(v ) \\nonumber \\\\ & \\leq \\sum_{k=0}^{2^i-1}2^{2i}p(\\delta_{i , k}(p ) ) \\int_{\\delta_{i , k}(p ) }   \\int_{\\delta_{i , k}(p)}(f(v ) - f(\\tilde v))^21\\ { v\\in \\omega(p)\\ } dp(\\tilde v)dp(v ) \\nonumber \\\\ & = \\sum_{k=0}^{2^i-1}2^{i}\\int_{\\delta_{i , k}(p ) }   \\int_{\\delta_{i , k}(p)}(f(v ) - f(\\tilde v))^21\\ { v\\in \\omega(p)\\ } dp(\\tilde v)dp(v ) ~.\\end{aligned}\\ ] ] let @xmath1984 , where @xmath1985 is the diameter of @xmath1986 .",
    "further note that by lemma [ aux : coup](iv ) , @xmath1987 and hence we have @xmath1988 for some @xmath1989 and @xmath10 the lebesgue measure .",
    "noting that @xmath1812 by assumption [ ass : coupreg](ii ) , and doing the change of variables @xmath1990 we then obtain that for some constant @xmath1991 @xmath1992)^2 ] \\nonumber \\\\ & \\leq m_0 \\sum_{k=0}^{2^i-1}2^{i}\\int_{\\delta_{i , k}(p ) }   \\int_{\\delta_{i , k}(p)}(f(v ) - f(\\tilde v))^21\\ { v\\in \\omega(p)\\ } d\\lambda(\\tilde v)d\\lambda(v ) \\nonumber \\\\   & \\leq m_0m_1\\sup_{\\|s\\| \\leq d_i}\\sum_{k=0}^{2^i-1 } \\int_{\\delta_{i ,",
    "k}(p)}(f(\\tilde v+ s ) - f(\\tilde v))^21\\ { \\tilde v+s\\in \\omega(p)\\ } d\\lambda(\\tilde v ) ~.\\end{aligned}\\ ] ] next observe that @xmath1993 is decreasing in @xmath364 .",
    "hence , since @xmath1994 is a partition of @xmath1810 , and @xmath1995 for some @xmath1976 by lemma [ aux : coup](iv ) , we obtain @xmath1996)^2 ] \\leq m_0m_1 \\times \\varpi^2(f , k_1\\times 2^{-\\frac{i}{d_v}},p)\\ ] ] by . setting @xmath1997 in",
    "establishes the claim of the lemma .      in this appendix",
    ", we develop results that enable us to provide sufficient conditions for verifying that assumption [ ass : bootcoupling ] is satisfied .",
    "the results in this appendix may be of independent interest , as they extend the validity of the multiplier bootstrap to suitable non - donsker classes .",
    "in particular , applying theorem [ th : mainbootcoup ] below to the case @xmath1998 and @xmath1999 for all @xmath179 yields the consistency of the multiplier bootstrap for the law of the standard empirical process indexed by a expanding classes @xmath215 of functions .",
    "[ ass:4boot ] for each @xmath254 and @xmath179 there exists a @xmath2000 such that : ( i ) @xmath2001 is orthonormal in @xmath226 and @xmath2002 is uniformly bounded in @xmath2003 and @xmath199 ; ( ii ) for any @xmath1840 and , @xmath2004 the eigenvalues of @xmath2005 $ ] are bounded uniformly in @xmath179 and @xmath254 ; ( iii ) for some @xmath2006 and @xmath2007 we have for all @xmath254 the inclusion @xmath2008    assumption [ ass:4boot](i ) demands the existence of orthonormal and bounded functions @xmath2001 in @xmath226 that provide suitable approximations to the class @xmath215 in the sense imposed in assumption [ ass:4bootdisp](iii ) .",
    "crucially , we emphasize that the array @xmath2001 need not be known as it is merely employed in the theoretical construction of the bootstrap coupling , and not in the computation of the multiplier bootstrap process @xmath2009 . in certain applications ,",
    "however , such as when @xmath2010 is linear in @xmath23 and linear sieves are employed as @xmath460 , the functions @xmath2001 may be set to equal a rotation of the sieve . and @xmath2011 with @xmath2012 and @xmath2013 , then a candidate choice for @xmath2014 are the orthonormalized functions @xmath2015 . ]",
    "it is also worth pointing out that , as in , the concept of  smoothness \" employed does not necessitate that @xmath2010 be differentiable in its arguments .",
    "finally , assumption [ ass:4boot](ii ) constrains the eigenvalues of @xmath2005 $ ] to be bounded from above .",
    "this requirement may be dispensed with , allowing the largest eigenvalues to diverge with @xmath179 , at the cost of slowing the rate of convergence of the gaussian multiplier bootstrap @xmath428 to the corresponding isonormal process @xmath553 .",
    "as we next show , assumption [ ass:4boot ] provides a sufficient condition for verifying assumption [ ass : bootcoupling ] . in the following , recall",
    "@xmath251 is the envelope of @xmath215 ( as in assumption [ ass : processreg](ii ) ) .",
    "[ th : mainbootcoup ] let assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass : processreg](ii ) , [ ass:4boot ] hold , and @xmath434 be i.i.d . with @xmath2016 independent of @xmath260 .",
    "then , for any @xmath1840 with @xmath2017 there is an isonormal @xmath553 independent of @xmath260 satisfying uniformly in @xmath254 @xmath2018    the rate of convergence derived in theorem [ th : mainbootcoup ] depends on the selected sequence @xmath2019 , which should be chosen optimally to deliver the best possible implied rate .",
    "heuristically , the proof of theorem [ th : mainbootcoup ] proceeds in two steps .",
    "first , we construct a multivariate normal random variable @xmath2020 that is coupled with @xmath2021 , and then exploit the linearity of @xmath428 to obtain a suitable coupling on the subspace @xmath2022 .",
    "second , we employ assumption [ ass:4boot](iii ) to show that a successful coupling on @xmath2023 leads to the desired construction since @xmath215 is well approximated by @xmath2001 .",
    "we note that the rate obtained in theorem [ th : mainbootcoup ] may be improved upon whenever the smallest eigenvalues of the matrices @xmath2024\\ ] ] are bounded away from zero uniformly in @xmath179 and @xmath250 ; see remark [ rm : oldrate ] .",
    "additionally , while we do not pursue it here for conciseness , it is also worth noting that the outlined heuristics can also be employed to verify assumption [ ass : coupling ] by coupling @xmath2025 to @xmath2026 through standard results @xcite .",
    "[ rm : oldrate ] under the additional requirement that the eigenvalues of be bounded away from zero uniformly in @xmath179 and @xmath254 , theorem [ th : mainbootcoup ] can be modified to establish @xmath2027 given the assumed orthonormality of the array @xmath2001 , the rate obtained in is thus more appropriate when considering the multiplier bootstrap for the standard empirical process ",
    "i.e. @xmath1998 and @xmath2028 for all @xmath179  since the smallest eigenvalue of the matrices in then equals one .",
    "proof of theorem [ th : mainbootcoup ] : we proceed by exploiting lemma [ lm : finbootcoup ] to couple @xmath428 on a finite dimensional subspace , and showing that such a result suffices for controlling both @xmath428 and @xmath553 on @xmath215 . to this end , let @xmath2029 and note that lemma [ lm : finbootcoup ] and @xmath2019 satisfying @xmath2017 by hypothesis imply that there exists a linear isonormal process @xmath2030 on @xmath2023 such that uniformly in @xmath254 we have @xmath2031    for any closed linear subspace @xmath2032 of @xmath226 , let @xmath2033 denote the @xmath219 projection of @xmath208 onto @xmath2032 and set @xmath2034 ",
    "i.e. @xmath2035 denotes the orthocomplement of @xmath2032 in @xmath226 . assuming the underlying probability space is suitably enlarged to carry a linear isonormal process @xmath2036 on @xmath2037 independent of @xmath2030 and @xmath260 , we then define the isonormal process @xmath553 on @xmath226 pointwise by @xmath2038 next , set @xmath2039 and note that",
    "since @xmath2040 for some @xmath2041 , the orthonormality of @xmath2042 imposed in assumption [ ass:4boot](i ) implies @xmath2043 by assumption [ ass : processreg](ii ) . since @xmath2044 for any @xmath1877 , @xmath917 and @xmath784 , and",
    "imply uniformly in @xmath254 @xmath2045    next , define the set of sequences @xmath2046 , and note that @xmath2047 by assumption [ ass:4boot](iii ) .",
    "moreover , also note that for any @xmath2048 , we have that @xmath2049\\}^{1/2 } \\lesssim b_n \\sum_{j = j_n}^\\infty |\\beta_j - \\tilde \\beta_j|\\ ] ] by assumptions [ ass : instreg](i ) and [ ass:4boot](i ) .",
    "hence , since @xmath553 is sub - gaussian with respect to @xmath219 , defining @xmath2050 we obtain from corollary 2.2.8 in @xcite @xmath2051 \\lesssim   \\int_0^{\\infty } \\sqrt{\\log n(\\epsilon , \\mathcal g_n,\\|\\cdot\\|_{l^2_p})}d\\epsilon \\\\",
    "\\lesssim \\int_0^{b_nm_n j_n^{-(\\gamma_\\rho -1 ) } } \\sqrt { \\log ( k_nn(\\epsilon / b_n , \\mathcal b_n , \\|\\cdot\\|_{\\ell_1}))}d\\epsilon ~,\\end{gathered}\\ ] ] where the final inequality holds for @xmath2052 by and noting that since @xmath2053 are uniformly bounded by assumption [ ass:4boot](i ) , @xmath789 has envelope @xmath906 satisfying @xmath2054 . furthermore , note that lemma [ aux : lmcover ] , the change of variables @xmath2055 , and @xmath2007 additionally yield @xmath2056 therefore , we conclude by results , , , and markov s inequality that @xmath2057    in order to obtain an analogous result to for @xmath428 , we similarly note that @xmath2058 moreover , since @xmath434 is independent of @xmath260 , we also obtain from assumption [ ass : instreg](i ) and @xmath2059 being uniformly bounded in @xmath2060 and @xmath254 by assumption [ ass:4boot](i ) that @xmath2061 \\\\ \\leq",
    "\\frac{1}{n}\\sum_{i=1}^n \\{q_{k , n,\\jmath}(z_i,\\jmath)\\sum_{j \\geq j_n } ( \\beta_j -\\tilde \\beta_j ) p_{j , n , p}(v_i)\\}^2   \\lesssim b_n^2 \\{\\sum_{j\\geq j_n } |\\beta_j - \\tilde \\beta_j|\\}^2 ~.\\end{gathered}\\ ] ] hence , since @xmath2009 is gaussian conditional on @xmath260 , applying corollary 2.2.8 in @xcite and arguing as in and implies @xmath2062 \\lesssim \\frac{b_n m_n\\sqrt{\\log(k_n)}}{j_n^{\\gamma_\\rho - 3/2 } } ~.\\ ] ] thus , results and together with markov s inequality allow us to conclude @xmath2063 uniformly in @xmath254 . hence , the claim of the theorem follows from noting that the linearity of @xmath428 and @xmath553 and @xmath2064 together imply that @xmath2065 which in conjunction with results , , and conclude the proof .",
    "[ lm : finbootcoup ] let assumptions [ ass : iid ] , [ ass : instreg](i ) , [ ass:4boot](i)-(ii ) hold , and @xmath434 be i.i.d . with @xmath2016 independent of @xmath260 .",
    "if @xmath2017 , then uniformly in @xmath261 @xmath2066 for @xmath553 a linear isonormal process on @xmath2067 independent of @xmath260 .",
    "proof : for notational simplicity , let @xmath2068 , set @xmath2069 , and @xmath2070 ~.\\ ] ] letting @xmath2071 denote the @xmath2072 coordinate of @xmath2073 further note that @xmath2074 since @xmath2075 is uniformly bounded by assumption [ ass:4boot](ii ) and @xmath949 by assumption [ ass : instreg](i ) .",
    "therefore , if for every @xmath2076 and @xmath254 we define the event @xmath2077 for @xmath2078 , then assumption [ ass:4boot](ii ) and lemma [ lm : oprate ] yield @xmath2079    next , let @xmath2080 follow a standard normal distribution and be independent of @xmath2081 ( defined on the same suitably enlarged probability space ) .",
    "further let @xmath2082 denote eigenvectors of @xmath2083 , @xmath2084 represent the corresponding ( possibly zero ) eigenvalues and define the random variable @xmath2085 to be given by @xmath2086 then note that since @xmath2087 conditional on @xmath260 , and @xmath2088 is independent of @xmath2081 , @xmath2089 is gaussian conditional on @xmath260 .",
    "furthermore , @xmath2090 = \\sum_{d = 1}^{d_n } \\hat \\nu_d \\hat \\nu_d^\\prime = i_{d_n}\\ ] ] by direct calculation for @xmath2091 the @xmath2092 identity matrix , and hence @xmath2093 conditional on @xmath260 almost surely in @xmath260 and is thus independent of @xmath260 .",
    "moreover , we also note that by theorem 3.6.1 in @xcite and @xmath2094 conditional on @xmath260 , it follows that @xmath2095 belongs to the range of @xmath2096 almost surely in @xmath2081 . therefore ,",
    "since @xmath2097 spans the range of @xmath2083 , we conclude from that for any @xmath2098 we must have @xmath2099 analogously , we also define for any @xmath2098 the isonormal process @xmath553 on @xmath2023 by @xmath2100 which is trivially independent of @xmath260 due to the independence of @xmath2089 .",
    "hence , letting @xmath2101 denote the vector whose @xmath2102 coordinate equals @xmath2103 , and @xmath2104 be an indicator for whether the event @xmath2105 occurs , we obtain that @xmath2106    defining @xmath2107 , next set for any @xmath2108 @xmath2109 and observe that conditional on @xmath260 , @xmath2110 is sub - gaussian under @xmath2111 for any @xmath2112 and @xmath2113 .",
    "moreover , by standard arguments and definition , we obtain that under @xmath2114 @xmath2115 therefore , noting that @xmath2116 under the event @xmath2114 , we obtain from corollary 2.2.8 in @xcite and that @xmath2117 \\lesssim \\int_0^\\infty \\sqrt { \\log(n(\\epsilon , t_n , d_n ) ) } d\\epsilon \\\\",
    "\\lesssim \\int_0^{2md_nr_n}\\{\\log(k_n ) + j_n\\log(\\frac{md_nr_n}{\\epsilon})\\}^{\\frac{1}{2}}d\\epsilon ~.\\end{gathered}\\ ] ] hence , exploiting and the change of variables @xmath2118 we can conclude @xmath2119 \\\\",
    "\\lesssim md_nr_n \\int_0 ^ 2 \\{\\log(k_n ) + j_n \\log(\\frac{1}{u})\\}^{\\frac{1}{2 } } du \\lesssim md_nr_n \\times \\sqrt{\\log(k_n ) + j_n } ~.\\end{gathered}\\ ] ] next , for notational simplicity let @xmath2120 , and then note that results , , and together with markov s inequality yield @xmath2121 ] \\lesssim \\frac{1}{m } ~.\\end{gathered}\\ ] ] therefore , combining results and , we can finally conclude that @xmath2122 which establishes the claim of the lemma given the definitions of @xmath941 and @xmath2123 .",
    "proof : for any @xmath2129 and integer @xmath2130 we first obtain the standard estimate @xmath2131 for any @xmath2132 , let @xmath2133 denote the smallest integer larger than @xmath170 , and further define @xmath2134 then note that implies that for any @xmath2135 we have @xmath2136 .",
    "hence , letting @xmath2137 , we obtain @xmath2138 , |\\cdot| ) \\leq ( \\lceil \\frac{4m_n}{j_n^{\\gamma_\\rho } \\epsilon } \\rceil)^{(j_n^\\star(\\epsilon ) - j_n)\\vee 0 } ~,\\end{gathered}\\ ] ] where the product should be understood to equal one if @xmath2139 .",
    "thus , the claim of the lemma follows from the bound @xmath2140 and results and .",
    "[ lm : oprate ] let assumption [ ass : iid ] hold , @xmath2141 be a triangular array of functions @xmath2142 , and define @xmath2143 as well as @xmath2144 \\hspace{0.5 in } \\hat \\sigma_{n}(p ) \\equiv \\frac{1}{n } \\sum_{i=1}^n f_{n , p}^{d_n}(v_i)f_{n , p}^{d_n}(v_i)^\\prime ~.\\ ] ] if @xmath2145 for all @xmath254 , the eigenvalues of @xmath257 are bounded uniformly in @xmath179 and @xmath254 , and @xmath2146 , then it follows that @xmath2147    proof : set @xmath1681 so that @xmath2148 for all @xmath179 and @xmath254 , and then note that @xmath2149 almost surely for all @xmath254 since each entry of the matrix @xmath2150 is bounded by @xmath2151 .",
    "similarly , exploiting @xmath2152 almost surely we obtain @xmath2153\\|_{o,2 } \\\\",
    "\\leq \\frac{1}{n}\\|e_p[\\{f_{n , p}^{d_n}(v_i)f_{n , p}^{d_n}(v_i)^\\prime\\}^2]\\|_{o,2 } + \\frac{1}{n } \\|\\sigma_n^2(p)\\|_{o,2 } \\leq \\frac{d_n c_n^2 k_0}{n } + \\frac{k_0 ^ 2}{n } ~.\\end{gathered}\\ ] ] thus , employing results and , together with @xmath2146 , we obtain from theorem 6.1 in @xcite ( bernstein s inequality for matrices ) that @xmath2154 since @xmath2155 and @xmath2156 , theorem x.1.1 in @xcite in turn implies that @xmath2157 almost surely , and hence the claim of the lemma follows from and .",
    "black , d.  a. , galdo , j. and smith , j.  a. ( 2007 ) . evaluating the worker profiling and reemployment services system ysing a regression discontinuity approach . _ the american economic review _ , * 97 * 104107 .",
    "blundell , r. , horowitz , j.  l. and parey , m. ( 2012 ) . measuring the price responsiveness of gasoline demand : economic shapre restrictions and nonparametric demand estimation .",
    "_ quantitative economics _ ,",
    "* 3 * 2951 .",
    "card , d. , lee , d. , pei , z. and weber , a. ( 2012 ) .",
    "nonlinear policy rules and the identification and estimation of causal effects in a generalized regression kink design . working paper 18564 , national bureau of economic research .",
    "newey , w.  k. and mcfadden , d.  l. ( 1994 ) . large sample estimation and hypothesis testing . in _",
    "handbook of econometrics _",
    "( r.  f. engle and d.  l. mcfadden , eds . ) , vol .",
    "elsevier science b.v .",
    ", 21132245 .",
    "romano , j.  p. and shaikh , a.  m. ( 2008 ) .",
    "inference for identifiable parameters in partially identified econometric models . _",
    "journal of statistical planning and inference  special issue in honor of ted anderson_."
  ],
  "abstract_text": [
    "<S> this paper examines a general class of inferential problems in semiparametric and nonparametric models defined by conditional moment restrictions . </S>",
    "<S> we construct tests for the hypothesis that at least one element of the identified set satisfies a conjectured ( banach space )  equality \" and/or ( a banach lattice )  inequality \" constraint . </S>",
    "<S> our procedure is applicable to identified and partially identified models , and is shown to control the level , and under some conditions the size , asymptotically uniformly in an appropriate class of distributions . </S>",
    "<S> the critical values are obtained by building a strong approximation to the statistic and then bootstrapping a ( conservatively ) relaxed form of the statistic . </S>",
    "<S> sufficient conditions are provided , including strong approximations using koltchinskii s coupling .    </S>",
    "<S> leading important special cases encompassed by the framework we study include : ( i ) tests of shape restrictions for infinite dimensional parameters ; ( ii ) confidence regions for functionals that impose shape restrictions on the underlying parameter ; ( iii ) inference for functionals in semiparametric and nonparametric models defined by conditional moment ( in)equalities ; and ( iv ) uniform inference in possibly nonlinear and severely ill - posed problems .    </S>",
    "<S> keywords : shape restrictions , inference on functionals , conditional moment ( in)equality restrictions , instrumental variables , nonparametric and semiparametric models , banach space , banach lattice , koltchinskii coupling . </S>"
  ]
}