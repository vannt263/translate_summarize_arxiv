{
  "article_text": [
    "the dynamics of a charged particle in a strong magnetic field shows up a separation of time - scales , with the existence of a fast larmor rotation , slower drifts , and an adiabatic invariant .",
    "this can be used to isolate completely the slow part of the dynamics from the single fast coordinate , the gyro - angle , and to build a true constant of motion , the magnetic moment @xcite .",
    "thus the guiding - center reduction brings a slow reduced motion and decreases by two the effective dimension of the dynamics .",
    "it is the starting point of gyrokinetics , which is a kinetic description of plasma dynamics in a strong magnetic field , and a key model in the study of plasma micro - turbulence @xcite .",
    "the most efficient results for the guiding - center reduction are obtained by lie transforming the lagrangian @xmath0-form in an expansion in a small parameter related with the magnetic inhomogeneity at the scale of the larmor radius @xcite .    in this paper , we clarify some aspects of guiding - center theory , especially some difficulties about the definition of the gyro - angle , by showing that the reduction can be done at arbitrary order in the larmor radius using gyro - gauge - independent coordinates .",
    "+ indeed , the introduction of a scalar coordinate for the angle measuring the larmor rotation , namely the _ gyro - angle _ , imposes to choose at each point in the configuration space a direction , an axis , in the plane perpendicular to the magnetic field , defined as the zero from which the angle is measured .",
    "this corresponds to fixing a gauge in the theory , the so - called gyro - gauge , and the presence of this gauge in the theory raised some non - trivial questions @xcite , even the bare existence of a global choice of gauge can fail .",
    "so , it is interesting to consider the reduction from a more intrinsic point of view .    in a previous work @xcite , we proposed a guiding - center reduction which avoided to introduce a gyro - gauge .",
    "the idea was to lie transform directly the equations of motion instead of lie transforming the lagrangian , as is usually done @xcite .",
    "this brought a much simplified reduction .",
    "especially , it provided the minimal guiding - center reduction which concerned only four coordinates ( instead of six ) : the transformation generator had no gyro - angle component .",
    "so , for the gyro - angle , the initial gauge - independent coordinate could be used , and no gauge fixing was needed .",
    "this physical coordinate is the unit vector @xmath2 of the component of the velocity orthogonal to the magnetic field , which defines the direction of the perpendicular velocity .",
    "a limitation of that approach was that it was not suited to non - minimal guiding - center reductions , for which the method relying on lie transforming the lagrangian appeared as necessary , or at least much more efficient .",
    "for instance , it is interesting to have the slow reduced motion hamiltonian , but the hamiltonian structure of the reduced model is hard to deal with when working on the equations of motion .",
    "in addition , the magnetic moment is usually taken as one of the reduced coordinates ; this can be done by working on the equations of motion , but it is not so straightforward @xcite . in a deeper way , the freedom involved in the gyro - averaged part of the coordinate change can be employed for the reduced motion to be as strongly reduced as possible , to make the guiding - center dynamics as simplified as possible .",
    "obtaining such a maximal guiding - center reduction by lie transforming the equations of motion is far from simple , especially because it implies to solve non - trivial secular differential equations . on the contrary ,",
    "lie transforming the lagrangian @xmath0-form basically relies on algebraic equations , and the requirements for a maximal reduction are not much more difficult to get than the minimal ones .",
    "this method also guarantees that the 4-dimensional slow reduced motion is hamiltonian , by working on a quarter - canonical structure in the poisson bracket .",
    "so , the goal is to use the physical gauge - independent coordinate also when lie transforming the lagrangian , in order to consider a gauge - independent maximal guiding - center reduction .",
    "+ the introduction of a vectorial quantity @xmath2 for the gyro - angle coordinate raises some questions , because the coordinate system becomes constrained : the variable @xmath2 has to remain normalized and perpendicular to the magnetic field .",
    "changing the spatial position @xmath3 implies to change the coordinate @xmath2 at the same time .",
    "this induces a connection for a covariant derivative on a space - dependent circle , which is related to the circle - bundle picture underlying in the gyro - angle coordinate @xcite .",
    "it was already present in @xcite when lie transforming the equations of motion , but it is more involved to deal with for the full guiding - center reduction , because the coordinate @xmath2 will be changed as well , and not only derivatives or vector fields are involved , but also differential forms .",
    "the resulting reduction will naturally provide gauge - independent results , whereas in the usual approach , they were obtained only for a part of the reduced quantities .",
    "this fact can shed interesting light on previous guiding - center results , especially those related to gauge invariance .",
    "for instance , in the usual approach , the gradient is not gauge - independent , and the reduced poisson bracket involves a gauge - independent corrected gradient .",
    "a comparison with the results of the gauge - independent formulation is a way to get an intrinsic interpretation for this corrected gradient .    the results of the gauge - independent formulation",
    "can also be used to explore other questions about the gauge - dependent approach , for instance related to gauge arbitrariness and anholonomy @xcite . to avoid confusion , they will be the topic of another paper @xcite . here",
    ", we show how a maximal guiding - center reduction can be derived in a gauge - independent formulation to arbitrary order in the larmor radius .",
    "the proof relies on explicit induction relations to all orders , because the induction can be written as a matrix product , with some coefficients being differential operators . through inversion of this matrix ,",
    "a maximal reduction can be studied , towards a more complete reduction and a more general viewpoint on special reductions considered in previous works , such as the so - called hamiltonian and symplectic representations identified in @xcite .    in the derivation",
    ", the cotangent of the pitch - angle is used as the coordinate corresponding to the parallel velocity ( component of the velocity parallel to the magnetic field ) , since this coordinate simplified computations for the minimal guiding - center reduction in @xcite and made all formulae polynomials .",
    "this will clarify why this polynomiality can be observed in the results of the full guiding - center reduction as well .",
    "+ taking care of the reduction at higher order is interesting , if not needed , for two reasons . on the first hand , it is necessary to validate the gauge - independent approach .",
    "indeed , the gauge issues became more sensitive when addressing the second - order reduction @xcite .",
    "an acceptable solution to these issues , which is the goal of the present paper , needs to be appropriate for higher orders .    on the other hand ,",
    "it is motivated because standard works proceeded only up to part of the second - order reduction , but recent results emphasize the importance of higher - order terms , for instance because they are involved in the conservation of angular momentum @xcite and are crucial for a proper description of intrinsic rotation of tokamak plasmas , a key phenomenon to stabilize turbulence and increase the energy confinement time , which is the main goal of magnetic fusion .",
    "+ the paper is organized as follows . in sect .",
    "2 , a few facts are reminded about the initial dynamics , the choice of coordinates for the gyro - angle , the method of lie transforming the lagrangian @xmath0-form , and the hierarchy of requirements involved in the guiding - center reduction .    for the sake of completeness and clarity , the mechanism of lie transforming the lagrangian through an expansion in a small parameter",
    "is described in an appendix , with emphasis on the three steps it involves : an initialization for the lowest orders , whose choices are the key to make the reduction work and possibly be optimal ; an algorithm which applies for higher orders , is purely mechanical and can be applied to study the reduction to arbitrary order ; and an intermediate step in between .    in sect .",
    "3 , the method is applied to the guiding - center reduction in case the gyro - angle coordinate is chosen as the physical variable @xmath2 .",
    "the derivation is written in matrix form , which emphasizes both the lowest - order choices that allow the reduction to work and to be maximal for the lagrangian , and the algorithmic character of the procedure at higher orders .",
    "the full derivation is explained because we are interested in the reduction at arbitrary order in the larmor radius , which implies to use all the ingredients of the detailed mechanism at work . for orders lower than @xmath4",
    ", the procedure follows the same lines as when working with the gauge - dependent coordinate , but formulae have to be used in their intrinsic version , for instance because the basis of @xmath0-forms involves non - closed @xmath0-forms .",
    "finally , for orders higher than 2 , explicit formulae are given for the induction relations , allowing to go to arbitrary order , and to give a unified framework where recent results may seem to discord somehow with each other @xcite .    in sect .",
    "4 , the results are compared with previous works , either lie transforming the equations of motion , or using a gauge - dependent gyro - angle .    for the sake of simplicity , we consider the special case where there is no electric field , but the generalization for a non - zero electric field is straightforward , as will be shown in subsect .",
    "[ sectelecfield ] .",
    "the dynamical system is simply a charged particle with position @xmath3 , momentum @xmath5 , mass @xmath6 and charge @xmath7 , under the influence of a static inhomogeneous magnetic field @xmath8 .",
    "the motion is given by the lorentz force @xmath9    when the magnetic field is strong , the motion implies a separation of time - scales .",
    "this is best seen by choosing convenient coordinates for the momentum space , for instance @xmath10 where @xmath11 is the unit vector of the magnetic field , and @xmath12 is the so - called _ perpendicular momentum _ , i.e. the orthogonal projection of the momentum onto the plane @xmath13 perpendicular to the magnetic field .",
    "the coordinate @xmath14 is the norm of the momentum ; the coordinate @xmath15 is the so - called _ pitch - angle _ ,",
    "i.e. the angle between the velocity and the magnetic field",
    ". the last coordinate @xmath2 is the unit vector of the perpendicular velocity .",
    "then , the equations of motion write @xmath16 where @xmath5 is now a shorthand for @xmath17 , the norm of the magnetic field @xmath18 is denoted by @xmath19 , and following littlejohn s notations @xcite , the vector @xmath20 is the unit vector of the larmor radius , so that @xmath21 is a right - handed orthonormal frame ( rotating with the momentum ) .    in the case of a strong magnetic field ,",
    "the only fast term is the larmor frequency @xmath22 .",
    "writing the dynamics as @xmath23 , all other terms as @xmath24 appear to be of order @xmath25 , which means that the small parameter of the theory is of order @xmath26 . a more detailed study ( e.g. @xcite )",
    "shows that it is rather @xmath27 it is an operator , but the gradient @xmath28 has only a meaning for orderings ; it acts on the magnetic field and can be given a more precise meaning by relations such as @xmath29 .",
    "the ordering parameter @xmath30 is related to the magnetic inhomogeneity at the scale of the larmor radius @xmath31 . by abuse of language ,",
    "it is often considered as just the larmor radius , or as the inverse charge @xmath32 @xcite .",
    "the larmor frequency @xmath22 concerns only one coordinate , @xmath2 , the direction of the vector @xmath33 in the @xmath34-dimensional plane perpendicular to the magnetic field .",
    "this corresponds to an angle , the so - called _ gyro - angle _ , and measures the larmor gyration of the particle momentum around the magnetic field .    to get a true scalar angle instead of the vector @xmath2 ,",
    "one chooses at each point @xmath3 in space a direction which will be considered as the reference axis @xmath35 .",
    "this corresponds to fixing a gauge in the theory , the so - called _ gyro - gauge_. then , the gyro - angle @xmath36 is defined from the oriented angle between the chosen reference axis @xmath37 and the vector @xmath2 through the following relation : = - _ 1 - _ 2 .",
    "[ defthetaperp ] the equation of motion for @xmath36 is @xmath38 with @xmath39 the unit vector such that @xmath40 is a ( fixed ) right - handed orthonormal frame @xcite .",
    "+ the coordinate @xmath36 is not intrinsic , it depends on the chosen gauge @xmath37 , which raised some questions about the gauge - invariance of the theory , about the failure of global existence for @xmath41 , as well as about the presence of an anholonomic phase in the coordinate system @xcite .",
    "all these difficulties originate because @xmath36 is not given by the physics , it is not a purely intrinsic coordinate . for physical results ,",
    "what is needed is not @xmath36 but only @xmath2 .",
    "this is clearly illustrated by all the results of guiding - center theory , e.g. @xcite , where @xmath36 intervenes only through the quantity @xmath2 everywhere ( except in its own definition and in subsequent relations ) .",
    "so , we will avoid this coordinate and keep the corresponding initial variable , @xmath2 , as in @xcite .",
    "the quantity @xmath36 will be used only with a symbolic meaning for the fast angle , or when making comparison with the gauge - dependent approach .",
    "+ the use of a unit vector avoids having to fix a gauge for the zero of the angle , and it allows to work with a physical quantity : the unit vector of the perpendicular velocity : = = , [ defperp ] which indeed corresponds to the direction of the perpendicular velocity , and is a coordinate measuring the larmor gyration .",
    "it is an angle , since it is a unit vector in a plane , namely the plane @xmath13 , orthogonal to the local magnetic field .",
    "but this unit vector is immersed into @xmath42 , which means it is in @xmath43 .",
    "this spatial dependence implies that the coordinate space is constrained : the gyro - angle @xmath2 is not independent of the spatial position .",
    "when the coordinate @xmath3 is changed , the coordinate @xmath2 can not be kept unchanged , otherwise it may get out of @xmath13 .",
    "differentiating relation ( [ defperp ] ) with respect to @xmath3 gives = - ( + ) .",
    "[ connectnatur ] this formula can be obtained more easily by noticing that in the change of coordinates @xmath44 , the following relations hold @xmath45 in which @xmath28 means differentiation with respect to @xmath3 while keeping @xmath5 constant , and we used that @xmath46 and that @xmath47 is a unit vector , which implies @xmath48 .",
    "formula ( [ connectnatur ] ) is not well defined where @xmath49 , i.e. where @xmath5 is parallel to @xmath8 . but",
    "this is no trouble , since it fits in with a usual limitation of guiding - center theories .",
    "for instance , guiding - center transformations are not defined where @xmath50 is zero , since they involve many @xmath51 as denominators @xcite . at the points where @xmath49 , the vector @xmath2 itself is not defined , neither is the coordinate @xmath36 .",
    "it is an implicit assumption in all gyro - kinetics and guiding - center works that those points are excluded from the theory .",
    "+ if the coordinate @xmath36 was used , formula ( [ connectnatur ] ) would be replaced by = - + _",
    "1_2   , [ connectgauge ] where @xmath52 is the so - called _ gauge - vector _ , which is usually denoted by @xmath53 , depends only of the position @xmath3 , and is related to the choice of gauge .    to fit in with both coordinates ,",
    "we define a more general function @xmath54 : @xmath55 then , in any coordinates , the previous formulae ( [ connectnatur ] ) and ( [ connectgauge ] ) write = - + _ g .",
    "[ connectboth ] the value @xmath56 corresponds to the physical definition of @xmath2 , and the corresponding formula ( [ connectnatur ] ) .",
    "the value @xmath57 will be linked with the usual case relying on the gauge - dependent coordinate @xmath36 , according to formula ( [ connectgauge ] ) .    the spatial dependence of the vector @xmath2 through formula ( [ connectboth ] )",
    "must be taken into account each time a gradient acts on a function that depends on the fast angle @xmath2 , e.g. in total derivatives , in lie transforms , and when computing the action of a spatial component of the change of variables .",
    "a more detailed study of the coordinate system @xcite shows that @xmath58 is the connection associated to the gyro - angle circle bundle , which indeed can be any function of the phase space , and that @xmath28 is the ( spatial part of the ) corresponding covariant derivative .",
    "the goal is to isolate the slow part of the dynamics from the fast angle @xmath36 ( or @xmath2 ) , by performing a near - identity change of coordinates such that the dynamics of the remaining coordinates does not depend on @xmath36 ; this averaging procedure is the primary requirement for the guiding - center reduction .",
    "we showed in @xcite how it can be derived by lie transforming the equations of motion when keeping the physical coordinate @xmath2 .",
    "it appeared to be very straightforward for the minimal guiding - center reduction , but the additional requirements ( e.g. the use of the magnetic moment as a coordinate or a further simplification of the reduced dynamics ) were not so easy to obtain .",
    "they are more efficiently obtained by lie transforming the lagrangian @xmath0-form , which relies on the hamiltonian structure of this dynamical system .",
    "+ the corresponding hamiltonian function is just the particle kinetic energy @xmath59    the poisson bracket is non - canonical , it contains the gyro - magnetic coupling term \\{f , g}= _ f _ g -_f_g - _ fe_g .",
    "[ crochet ]    together , the poisson bracket and the hamiltonian induce the equations of motion through hamilton s equations = \\{,h } , where all the coordinates were grouped in a single phase - space vector @xmath60 . + instead of working with the poisson bracket and the hamiltonian , it is easier to work on the _ poincar - cartan @xmath0-form _ @xmath61 @xcite .",
    "this last is usually called just a lagrangian @xmath0-form , or simply a _",
    "lagrangian_. it concentrates all the information on the hamiltonian structure into one single quantity , which in addition is much less constrained than a poisson bracket .",
    "it is a @xmath0-form , defined over a @xmath62-dimensional space @xmath63 by @xcite : = ( e+)d - h dt , [ lagrini ] which yields a variational formulation of the dynamics with the action @xcite : @xmath64    the symplectic part of @xmath61 is @xmath65 @xcite .",
    "it is a @xmath0-form @xmath66 in the usual @xmath67-dimensional phase - space , which gives the lagrange @xmath34-form through exterior derivative _",
    "s:=d_s=(_i_s^j-_j_s^i )  dz^i dz^j , [ extderiv ] where @xmath68 means tensorial product , and einstein s convention is used : there is an implicit summation over repeated indices . in turn , @xmath69 is invertible , and its inverse gives the poisson bracket @xmath70 with @xmath71 the bivector defined by the relation @xmath72 .",
    "+ in the presence of a strong magnetic field , the small parameter @xmath30 allows for a perturbation expansion of all quantities . the lagrangian @xmath61 from formula ( [ lagrini ] )",
    "can be written @xmath73 where the index refers to the order in the magnetic field , ( or in @xmath32 , following northrop s work @xcite ) _",
    "-1&:=&ed , _ 0&:=&d-",
    "dt , [ lagrordering ] whose ratio is indeed of order @xmath30 .",
    "the lowest order being @xmath74 reminds that the guiding - center is a singular perturbation theory .",
    "+ the lagrangian is transformed by the exponential of a lie transform @xmath75 where @xmath76 is the lie derivative along the vector field @xmath77 , whose inverse is the generator of the near - identity coordinate transformation : @xmath78    the generator can be expanded @xmath79 , where @xmath80 is the term of @xmath77 that is of order @xmath81 in @xmath30 .",
    "in fact , it is equivalent but simpler to replace the single transformation @xmath82 with a complicated generator by a series of transformations with a simple generator for each of them @xmath83 where @xmath84 is the vector field generating the @xmath81-th transformation , and is purely of order @xmath85 .",
    "the lagrangian then transforms as @xmath86 where @xmath87 is the lie derivative along the vector field @xmath88 .",
    "notice that @xmath89 because @xmath90 .",
    "+ as the lagrangian is time - independent , it is interesting to use time - independent perturbation theory , by imposing a transformation that does not depend on time and does not affect the time coordinate : @xmath91 is constant in time and @xmath92 .",
    "this implies that the hamiltonian will transform as a scalar function .",
    "indeed , for any time - independent vector field @xmath91 and any @xmath0-form , @xmath93_t+ [ d ( i_\\bfmg\\ga)]_t      \\ncr      & =       \\left [      \\bfmg^i\\p_{\\bfy^i}(\\ga_j ) d\\bfy^j      -       \\bfmg^i\\p_{\\bfy^j}(\\ga_i )      d\\bfy^j       \\right]_t       + \\p_t(\\bfmg\\cdott\\ga )      \\ncr      &       = \\bfmg\\cdott\\p_\\bfy\\ga_t      + \\p_t(\\bfmg)\\cdott\\ga      = \\bfmg\\cdott\\p_\\bfy\\ga_t      \\ , ,      \\notag\\end{aligned}\\ ] ] where formula ( [ liederiv ] ) was used for lie derivatives , and formula ( [ extderiv ] ) for exterior derivatives ( here in the @xmath62-dimensional space ) .",
    "another consequence is that at each order @xmath81 in @xmath30 , there will be seven requirements ( see next subsection ) , one for each component of the reduced lagrangian @xmath94 , and only six freedoms , one for each component of the time - independent transformation generator @xmath88 .",
    "one freedom is missing in @xmath88 and must be looked for elsewhere .",
    "now , the lagrangian is defined only to within a total derivative , since only its exterior derivative has a physical meaning , and @xmath95 for any function @xmath96 , which is called a _ gauge function _ @xcite .",
    "be careful , this gauge has nothing to see with the gyro - gauge nor the gyro - angle , it is just an arbitrariness in the definition of the lagrangian .",
    "rather , it corresponds to the electromagnetic gauge , since it can be absorbed in a redefinition of the potential @xmath97 ( together with @xmath98 when there is a non - zero electric field , see page ): the lagrangian is expressed in terms of the potential , and does depend on the electromagnetic gauge , but the dynamics , as well as all physical quantities , are electromagnetic - gauge invariant , they depend only on the electromagnetic field .    the freedom embodied in @xmath96 is needed to obtain the maximal reduction , since it gives the expected seventh freedom .",
    "then the reduced lagrangian is : @xmath99 it will be determined order by order in @xmath85 : @xmath100\\ga_{-1 } \\ncr      & \\hspace{15ex }       + \\big[\\sfml_3+\\sfml_2\\sfml_1+\\tfrac{\\sfml_1 ^ 3}{6}\\big]\\ga_0       + ds_3 \\ncr      ... &       \\notag\\end{aligned}\\ ] ]    in principle , these are differential equations for @xmath91 , because the action of a lie derivative @xmath101 over a @xmath0-form @xmath102 writes _ = (",
    "i_d + d  i _ ) , [ liederiv ] where the operator @xmath103 is the interior product , e.g. i_= =( ) .",
    "[ interiorproduct ] so , the first term in ( [ liederiv ] ) is algebraic in @xmath91 , but the second one is differential in @xmath91 .",
    "however , the differential operators can be avoided by the following argument .",
    "the last term in ( [ liederiv ] ) involves an exterior derivative , and can be removed by redefining the gauge function @xmath96 .",
    "in addition , formula ( [ liederiv ] ) together with the property @xmath104 imply that the exterior derivative and the lie derivative commute : @xmath105 this means that for any vector fields @xmath77 and @xmath91 @xmath106 in computations for @xmath107 , the last term can again be removed by redefining the gauge function @xmath96 . by induction , it is now easy to see that in formula ( [ reduclagr ] ) , exponentials of lie derivatives can be considered as just exponentials of interior products provided the gauge function @xmath108 is defined in a convenient way at each order @xmath85 to absorb all the exterior derivatives involved in equation ( [ reduclagr ] ) : @xmath109 for the following , we will redefine @xmath96 according to this rule , but for simplicity , we drop the prime and write @xmath96 for @xmath110 .    using this rule and the fact that in the equation for @xmath94 , the @xmath111 are already known , equations ( [ reduclagr ] ) can be written @xmath112      + ds_2 \\ncr      \\overline \\ga_{3 }      & =      \\bfmg_4\\cdott\\om_{-1 }      + \\bfmg_3\\cdott\\overline\\om_0      + \\bfmg_2\\cdott\\overline\\om_1      - \\tfrac{(\\bfmg_2\\cdott d)^2}{2}\\om_{-1 } \\ncr      & \\hspace{20ex } + \\tfrac{(\\bfmg_1\\cdott d)^2}{24 }      \\bfmg_1\\cdott(3\\om_0+\\overline\\om_0 )      + ds_3 \\ncr      ... &       \\notag\\end{aligned}\\ ] ] where the notation @xmath113 is used for the interior product , as in formula ( [ interiorproduct ] ) .",
    "in addition , the @xmath81-@xmath114-order lagrange @xmath34-form was defined in the natural way : @xmath115    in the next subsection , we study the properties that are wished for @xmath107 . in the next section ,",
    "the unknowns @xmath88 and @xmath108 will be determined such that @xmath94 has those desired properties .",
    "\\a ) the primary requirement for the guiding - center reduction is to isolate the slow dynamics of the coordinates @xmath116 from the fast gyro - angle @xmath117 .",
    "from the point of view of the lagrangian @xmath107 , it may be obtained by making @xmath107 independent of @xmath117 .",
    "this is actually stronger than the strict minimal requirement , since it implies to average the dynamics of @xmath117 as well .",
    "however , in the lagrangian approach , contrary to when working on the equations of motion , the minimal requirement would be difficult to get , if not impossible , and it is quite easier to average all the reduced dynamics .",
    "so , the goal is that the reduced lagrangian does not depend on the reduced gyro - angle , which means that all its non - zero fourier components ( i.e. purely oscillatory terms ) are zero : ( _ n ) = 0 , [ requirprior1 ] where following littlejohn s notations , @xmath118 is the projector onto gyro - fluctuations , with @xmath119 the complementary projector onto gyro - averages : @xmath120 for any function @xmath121 .",
    "this average can be computed without introducing any gauge : either using the intrinsic calculus introduced in @xcite , either using the matrix calculus introduced in @xcite .",
    "also , the coordinate @xmath36 can be used as an intermediate quantity for this computation , which is made at constant @xmath3 , so that the presence of a gauge ( only for the intermediate computation ) is of no consequence .",
    "+ b ) averaging the motion or the lagrangian does not determine the average components of the coordinate change , as is clear in @xcite , for instance .",
    "this lets some freedom in the procedure and suggests to impose stronger requirements for the reduction .",
    "the basic idea is to use the available freedoms to make the reduced dynamics as simplified as possible .",
    "a natural prospect is to make trivial the reduced dynamics @xmath122 for some components @xmath123 , by including constants of motion in the reduced coordinates . for the remaining coordinates",
    ", one can consider putting their reduced dynamics to zero just for orders higher than @xmath34 or @xmath4 for instance : @xmath124 for all higher orders , where the index @xmath81 refers to the order in @xmath85 and the exponent @xmath123 indicates the component of the vector @xmath125 .",
    "when this is achieved , the reduced dynamics is given just by lowest - order terms ; it is exactly known after the lowest orders have been derived , without computing the reduction at higher orders , which are useful only to determine the transformation .    in the procedure",
    "working on the lagrangian @xmath0-form , the `` components '' are not the ones of the reduced equations of motion , but the ones of the reduced lagrangian _",
    "n^j=0 , [ requirprior3 ] for higher @xmath81 . for differential forms",
    ", we use the same convention as for vectors : the index @xmath81 indicates the order in @xmath85 and the exponent @xmath123 refers to the component .",
    "it departs from the usual notation @xmath126 , but it avoids excessive use of parentheses .    equation ( [ requirprior3 ] ) gives additional ( i.e. non minimal ) requirements for the reduced lagrangian @xmath107 and it is used to determine the averaged transformation generators .",
    "when it can not be obtained completely , the goal is to obtain it for as many components @xmath123 as possible , to get what can be considered as the maximal reduction .",
    "+ c ) when studying the lie transform of the lagrangian @xmath0-form , one variable , namely the _ magnetic moment _",
    "@xmath127 , plays a key role , as the variable conjugated to the gyro - angle .    basically , including @xmath127 among the reduced coordinates is a way to obtain a more efficient reduction process by making one of the components of the reduced lagrangian trivial @xmath128 .",
    "indeed , when the derivation is performed with the variable @xmath14 , then the @xmath129-component of the lagrangian is given by a whole series , which is the magnetic moment .",
    "changing the variable @xmath14 in such a way that the new variable absorbs this series is a way to have the reduced @xmath129-component trivial , just given by a coordinate .",
    "this also simplifies the reduction algorithm , by providing a simpler expression for @xmath130 , which will play a key role in the derivation .",
    "+ second , the resulting variables @xmath131 and @xmath127 are conjugated , which implies that the magnetic moment is a constant of motion besides the norm of the momentum @xmath14 . and this conserved quantity is preferable to the variable @xmath14 because , unlike @xmath14 , it remains an adiabatic invariant in the presence of a wide class of electric fields .",
    "the variable @xmath127 is a whole series in the larmor radius , and its lowest - order term is the well - known adiabatic invariant @xmath132 often confounded with @xmath127 : = .",
    "[ magmomordmin ]    so , an interesting additional requirement is to include the magnetic moment in the reduced coordinates . for the equation to be solved ,",
    "this requirement is expressed by ^:= .",
    "[ requirprior2 ] indeed , then the reduced poisson bracket verifies ^= 1 , ^i = 0 , [ qcancondition ] for @xmath133 , which means that the dynamics of @xmath127 is zero @xmath134 since the hamiltonian @xmath135 does not depend on @xmath117 , as a consequence of ( [ requirprior1 ] ) .",
    "+ there is a third reason for including the magnetic moment among the reduced coordinates and requiring @xmath136 .",
    "it is concerned with the hamiltonian structure of guiding - center dynamics .",
    "the @xmath67-dimensional reduced motion @xmath137 is hamiltonian , since it is just the transform of the hamiltonian motion @xmath138 .",
    "but the true reduced guiding - center motion is the @xmath139-dimensional slow motion @xmath140 .",
    "it is the truncation of the full dynamics @xmath125 , but truncations of a hamiltonian dynamics are in general not hamiltonian .",
    "however , in some cases , truncations are automatically hamiltonian , and a special case is the quarter canonical structure of the poisson bracket , defined by conditions ( [ qcancondition ] ) .",
    "this can be seen by imposing dirac s constraints @xmath141 to the reduced dynamics , or by verifying that the truncated bracket is actually just given by starting from the initial lie algebra of all functions of the phase - space @xmath142 , and taking the sub - algebra of functions that do not depend on the gyro - angle @xmath143 .",
    "thus , including @xmath127 in the reduced coordinates is a way to guarantee the reduced slow motion to be hamiltonian .",
    "+ the requirement on the magnetic moment fixes one of the freedoms involved in the average components of the coordinate change .",
    "the other freedoms are used to make the reduced dynamics as simple as possible , by putting to zero as many average components of @xmath94 as possible for higher @xmath81 , as indicated by formula ( [ requirprior3 ] ) .",
    "+ d ) to sum it up , the guiding - center reduction involves a hierarchy of requirements : the primary requirement ( minimal reduction , with an averaged reduced dynamics ) is to remove the fast time - scale by averaging the lagrangian over the gyro - angle ; the corresponding equation is ( [ requirprior1 ] ) .",
    "the secondary requirement ( intermediate reduction , with a constant of motion and a hamiltonian slow reduced motion ) is to include the magnetic moment among the reduced coordinates by the quarter - canonical structure ; the corresponding equation is ( [ requirprior2 ] ) . the third optional requirement ( maximal reduction , with a simplified reduced dynamics ) is to use the remaining freedoms to make the reduced lagrangian as simplified as possible ; the corresponding equation is ( [ requirprior3 ] ) .",
    "this makes seven requirements at each order in @xmath30 , one for each component of the reduced lagrangian @xmath94 in formulae ( [ reduclagr ] ) , and seven freedoms are needed . for a time - independent transformation , those are @xmath144 and @xmath108 , as announced in the previous subsection .",
    "let us now turn to the guiding - center reduction .",
    "the details of the procedure as well as the practical computations may seem intricate and they hide somehow that the basic ideas of the reduction are very elementary .",
    "it is why the principles and general lines of the procedure are presented in the appendix , to give a clear view of the reduction process .    in this section",
    ", the three stages of the method presented in the appendix are shown to work with the coordinate @xmath2 in a similar way as with the standard approach relying on a gyro - gauge .",
    "the transformation at lowest orders is computed for comparison with previous works , and it is shown how the reduction can be performed to arbitrary order in the larmor radius by obtaining explicit induction relations .",
    "each order of the derivation can be given several numbers .",
    "for instance , what is usually called the first order is the order just after the lowest order . for the lagrangian , it corresponds to @xmath145 ( since the lowest order corresponds to @xmath146 ) , which is rather considered here as the order @xmath147 .",
    "in addition , the order in the various quantities will be mixed up : for instance , in the derivation , the order involving @xmath148 will be the equation for @xmath149 , as well as for @xmath150 and also for @xmath151 . for the sake of clarity , we will always consider the order @xmath81 as the one corresponding to @xmath152 ( or rather @xmath94 ) , and we will often use the expression `` at order @xmath152 '' , instead of `` at the order corresponding to @xmath152 '' .      the goal is to solve equation ( [ reduclagralg ] ) for the guiding - center reduction , with the lagrangian ( [ lagrordering ] ) , and with the requirements ( [ requirprior1])-([requirprior2 ] ) for the averaging reduction , for the magnetic moment reduction , and for the maximal reduction .",
    "+ first of all , the change of coordinates from the norm of the momentum @xmath14 to the magnetic moment @xmath127 is not near identity , as is clear in equation ( [ magmomordmin ] ) . before beginning the reduction ,",
    "a preliminary change of coordinates must be done , so that all the remaining transformation will be near identity .",
    "a suitable preliminary change of coordinates is @xmath153 where @xmath132 is the zeroth - order magnetic moment @xmath154 which is a well - known adiabatic invariant , and often confounded with @xmath127 . in the new variables ,",
    "the lagrangian becomes @xmath155      \\cdott d\\bfq       -       \\mu b ( 1+\\cot^2\\varphi ) dt      \\,.\\ ] ]    interestingly , the pitch - angle @xmath50 intervenes only through its cotangent , which was mentioned in @xcite as making all quantities polynomials . here , this feature is obvious in the lagrangian , and it is preserved by derivatives , so that it will be preserved throughout all of the derivation . actually , the magnetic moment makes the polynomiality still more accurate than in @xcite , where the variables @xmath50 and @xmath14 were used , and the larmor - radius prefactor @xmath156 was not polynomial in @xmath157 . here , the magnetic moment @xmath132 absorbs the @xmath158 and all formulae will be purely polynomials in @xmath157 and monomials in @xmath159 , which is useful to simplify computations .",
    "so , we actually choose to change coordinates according to @xmath160 with @xmath161 the variable that makes all formulae polynomials .",
    "also , the structure of the lagrangian shows that one can make the coefficients @xmath7 and @xmath6 disappear by noticing that the magnetic field @xmath19 appears only through @xmath162 , provided @xmath132 is considered as appearing only through @xmath163 , and @xmath164 appears only through @xmath165 .    the particle charge @xmath7 is usually kept in guiding - center works because the order in @xmath32 indicates the order in @xmath30 @xcite .",
    "here , it is useless since the order in @xmath30 is already indicated by the order in other quantities : @xmath152 and @xmath94 are of order @xmath166 .",
    "the reason is that all quantities will be series in @xmath167 , as a result of the structure of the lagrangian , and as will be confirmed by the derivation , e.g. formulae ( [ larmorradiusosc ] ) , ( [ resultsorderga11])-([resultsorderga12 ] ) , ( [ avgg1mu])-([hamiltredord2 ] ) , ( [ resultsdeparametrized1])-([resultsdeparametrized2 ] ) , etc .",
    "hence the order can be readily obtained by the overall order in @xmath168 or @xmath28 .",
    "these last two quantities have the drawback of being an operator , or a space - dependent function ; in addition , their order is only dimensional , e.g. @xmath169 is of order @xmath170 . for a readily control of the order , it is useful to have a scalar parameter , which was considered as @xmath32 in previous works . here , this role can be played by @xmath159 , since all quantities will be monomial in it .",
    "thus , keeping @xmath7 to indicate the order of expansion is indeed not necessary .",
    "thus , we make the scaling @xmath171 which avoids unnecessary coefficients in the derivation .",
    "it agrees with the physics , where the effect of the magnetic field on particle dynamics always includes the coupling constant @xmath7 . for simplicity",
    ", we will drop the underline , e.g. we will write @xmath19 for @xmath172 . the lagrangian becomes @xmath173\\cdott d\\bfq - \\mu b ( 1+\\phi^2 ) dt      \\,.\\ ] ]    the derivation starts from the lagrangian with the expansion ( [ lagrordering ] ) @xmath174 with @xmath175 it can be divided into its average and fluctuating part @xmath176    the previous section showed that the process involves the lagrange @xmath34-form @xmath177 .",
    "it can be split in three basic terms @xmath178 with @xmath179 where the symbol @xmath180 denotes the antisymmetry operator @xmath181 for any matrix @xmath182 and any vectors @xmath183 and @xmath182 .",
    "the first term in ( [ om3terms ] ) is the lowest - order lagrange @xmath34-form , related to larmor gyrations .",
    "the second ( resp .",
    "third ) term in ( [ om3terms ] ) is the exterior derivative of the oscillating ( resp .",
    "average ) zeroth - order lagrangian .",
    "be careful , this is not the oscillating ( resp .",
    "average ) zeroth - order lagrange @xmath34-form ; for instance @xmath184 because the exterior derivative does not preserve gyro - fluctuations .",
    "+ the contributions ( [ om3terms ] ) to the lagrange @xmath34-form are explicitly given by @xmath185      \\phi\\sfb      \\right\\rbrace      \\cdott \\wedge d\\bfq \\ncr      & \\hspace{10.5ex }      - \\big\\lbrace      ( 1+\\phi^2)(b d\\mu + \\mu db ) + 2\\mu b   d\\phi       \\big\\rbrace      \\wedge \\tfrac{dt}{m } \\ncr      \\widetilde\\om_0      :      &      = d \\osc(\\ga_0 )      = d ( \\sqrt{2\\mu b}\\sfc ) \\cdott\\wedge d\\bfq   \\ncr      & =       \\sqrt{2\\mu b }      \\left\\lbrace      d\\sfc      +      \\left [      \\tfrac{d\\bfq\\cdott\\na b}{2b }      +      \\tfrac{d\\mu}{2\\mu }      \\right ]      \\sfc      \\right\\rbrace      \\cdott \\wedge d\\bfq      \\ , .",
    "\\notag\\end{aligned}\\ ] ]    now , @xmath186 involves two contributions : one corresponding purely to the gyro - angle , in which the variable @xmath2 is changed at constant @xmath3 , and a second one coming from a change in the coordinate @xmath3 , which comes because the gyro - angle is a constrained coordinate , as mentioned about formulae ( [ connectnatur ] ) and ( [ connectboth ] ) . the second part is given by @xmath187 the first one is then @xmath188 , but it is written more precisely as @xmath189 since when @xmath3 is constant , the variation of @xmath2 can only be in the direction of @xmath190 , i.e. along the circle @xmath191 . on the whole @xmath192 this shows that , in the gauge - independent approach , the natural form corresponding to @xmath1 is @xmath193 where the minus sign comes to agree with the usual convention ( [ defthetaperp ] ) on the orientation of the gyro - angle . unlike @xmath1 , this form is not closed in general ; it is why it is written @xmath194 . in the gauge - dependent case ,",
    "it is closed and indeed corresponds to @xmath1 , as a consequence of ( [ connectgauge ] ) .",
    "+ as the reduction process mainly relies on inversions of @xmath195 ( or rather @xmath196 ) , which can be viewed as a matrix inversion , a matrix notation is well suited and makes the discussion clearer .",
    "this implies to choose a basis of @xmath0-forms ; the derivation of @xmath197 above shows that a natural basis is ( d , d , d  |   d , d ,  |   -dt ) , [ basis1forms ] where a vertical dash @xmath198 is put to separate the space- , the momentum- and the time - components .",
    "the choice of @xmath199 makes the corresponding coordinate @xmath200 instead of @xmath201 .",
    "those @xmath0-forms are not closed , unlike the standard @xmath202 , but it is not needed , provided one is careful of using intrinsic definitions for the operations involved in the procedure ( see formulae ( [ basisvectfield ] ) and ( [ extderivgene ] ) for instance ) .    in this basis , formulae ( [ formomegai ] ) become @xmath203[0ex]{\\large 0 } &              & \\p_\\mu h_0          \\\\              0&0 & 0              & & &              & 0      \\\\",
    "\\hline              -\\sfc\\cdott\\na h_0               & -\\sfa\\cdott\\na h_0                & -\\sfb\\cdott\\na h_0           &              -\\p_\\phi h_0              & -\\p_\\mu h_0&0              & 0",
    "\\end{array }     \\right ) } \\ncr      \\widetilde\\om_0      & = ~~{\\scriptsize      \\left (      \\begin{array }                  { @{\\hspace{1ex } }                  c@{\\hspace{3ex } }                  c@{\\hspace{4ex } }                  c@{\\hspace{3ex } }                    | @{\\hspace{5ex } }                  c@{\\hspace{2ex } }                  cc@{\\hspace{1ex } }                    | @{\\hspace{3ex}}c@{\\hspace{2ex } } }              0&-\\tilde j&\\tilde i              & 0&-\\tfrac{\\sqrt{2\\mu b}}{2\\mu}&0              &          \\\\",
    "\\tilde j&0&-\\tilde k              & 0&0&\\sqrt{2\\mu b }              & \\raisebox{-1ex}[0ex][0ex]{\\large 0 }          \\\\",
    "-\\tilde i&\\tilde k&0              & 0&0&0              &      \\\\ \\hline              0&0&0              & & &              &          \\\\               \\tfrac{\\sqrt{2\\mu b}}{2\\mu}&0&0              & & \\raisebox{-1ex}[0ex][0ex]{\\large 0 } &              & \\raisebox{-1ex}[0ex][0ex]{\\large 0 }          \\\\",
    "0&-\\sqrt{2\\mu b } & 0              & & &              &      \\\\ \\hline              & \\raisebox{-1.2ex}[0ex][0ex]{\\large 0 } &              & & \\raisebox{-1.2ex}[0ex][0ex]{\\large 0 } &              & \\raisebox{-1.2ex}{\\large 0 }     \\end{array }     \\right ) } \\ , , \\notag\\end{aligned}\\ ] ] where for visual purpose , vertical and horizontal lines are used to separate the position- , momentum- and time - components . the spatial part of the matrix @xmath204 ( resp .",
    "@xmath205 ) is just a vector product @xmath206 , with the vector @xmath207 ( resp .",
    "@xmath208 ) , where the coefficients are @xmath209      at lowest order @xmath210 , the reduced lagrangian ( [ reduclagralg ] ) writes @xmath211    the change of variable has no effect at this order , since it is near - identity .",
    "but the averaging condition is trivially verified ; it is actually a condition for the near - identity lie transform to remove the fast time - scale , which is possible only when at lowest order , the lagrangian is already gyro - averaged .",
    "now , the only freedom involved @xmath212 can not be useful and is set to zero @xmath213    at the following order @xmath214 , the reduced lagrangian is @xmath215 to write vectors in matrix form , a basis has to be chosen for vector fields also .",
    "it is most convenient to choose the dual of the basis ( [ basis1forms ] ) for @xmath0-forms , so that the coupling @xmath216 is computed as a standard matrix product .",
    "the desired basis is easily identified as ( using the natural isomorphism between vector fields and differential operators ) ( , ,  |   _ , _ , - _",
    "|   -_t ) , [ basisvectfield ] because @xmath28 can be written @xmath217 .",
    "the operator @xmath218 is the generator of larmor gyrations , as shown in @xcite .",
    "it just an intrinsic definition of the usual @xmath219 .",
    "the set ( [ basisvectfield ] ) is actually the natural basis for vector fields , which confirms the relevance of the basis ( [ basis1forms ] ) for @xmath0-forms .",
    "be careful that the chosen bases are not averages and they must be taken into account when computing averages or fluctuations of a quantity .",
    "for instance , it could seem that a vector ( resp .",
    "a @xmath0-form ) with components @xmath220 is averaged , whereas it is not , since it is equal to @xmath221 ( resp .",
    "@xmath222 ) .",
    "+ then , equation ( [ lagrredordzeroeqz ] ) is easily computed in matrix form @xmath223 where , as usual , @xmath0-forms are written as @xmath224 matrices : each column is an equation to be solved for the freedoms @xmath225 and @xmath226 in such a way that @xmath227 satisfies the desired requirements .",
    "the lowest - order lagrange @xmath34-form @xmath228 is linked to larmor gyration , as appears in ( [ formomegai ] ) .",
    "it is not invertible .",
    "only two components of @xmath225 are involved in the equation : @xmath229 and @xmath230 ; and only two components of @xmath107 can be controlled by these freedoms : @xmath231 and @xmath232 . as announced in the appendix ,",
    "the inversion is possible only under some conditions on the term @xmath233 , and the solution , if it exists , is not unique . + more precisely , for the averaging requirement ( [ requirprior1 ] ) , the condition of the right - hand side of equation ( [ equag1matrix ] ) being in the range of @xmath228 is satisfied , since the only fluctuating terms are in @xmath234 , which can precisely be controlled by the freedoms @xmath235 .",
    "the solution imposes the fluctuating part of @xmath235 , which is given by @xmath236 notice that the oscillating and averaged parts of the components @xmath229 and @xmath230 must be dealt with together through the combination @xmath237 .",
    "this is easily illustrated with an example vector @xmath238 : it is not a pure fluctuation , whereas its @xmath2-component @xmath239 is a pure fluctuation , and its fluctuating part is @xmath240 , which mixes up the components @xmath241 and @xmath242 .    at this point ,",
    "the average part of @xmath234 remains free and must be identified by the secondary and tertiary requirements ( [ requirprior3 ] ) and ( [ requirprior2 ] ) . the magnetic moment requirement ( [ requirprior2 ] )",
    "is not concerned here , since @xmath243 is automatically zero .",
    "last , for the requirement for the maximal reduction ( [ requirprior3 ] ) , only the components @xmath234 can be controlled , and setting them to zero imposes the average part of @xmath235 @xmath244    formulae ( [ larmorradiusosc])-([larmorradiusavg ] ) give the traditional ( lowest - order ) larmor radius , which is usually confused with the exact larmor radius @xmath245 : @xmath246 where the index denotes the order , and formulae ( [ transfcoord ] ) and ( [ resultsorderga11 ] ) were implicitly used .    in a similar way , what is usually called guiding center in the literature actually corresponds to the first - order guiding center : @xmath247 where we recover the traditional formula for the ( first - order ) guiding center , since we remind that here @xmath8 stands for @xmath248 ( see formula ( [ scaling ] ) ) . + all other components of the first - order transformation generator @xmath249 still remain undetermined .",
    "they embody the non - uniqueness of the matrix inverse @xmath250 and the corresponding freedom will be useful for the solvability conditions at the next order . as a consequence , there will be some order mixing : the components @xmath251 of @xmath225 will be determined at higher order , at the same time as the components @xmath252 of @xmath253 .",
    "last , the gauge function @xmath226 can not be useful and is set to zero @xmath254    the final zeroth - order reduced lagrangian ( [ lagrredordzeroeq ] ) writes @xmath255 it is just the average of the zeroth - order initial lagrangian @xmath145 : @xmath256 .",
    "the zeroth - order reduced @xmath34-form @xmath204 is then d_0=_0 , which justifies the notation @xmath204 introduced in ( [ om3terms ] ) .",
    "it is easy to see that the matrix @xmath257 is not invertible , for instance all its gyro - angle components are zero .",
    "so , the pivotal matrix for high orders @xmath258 mentioned in the appendix ( see page ) is not identified yet .      at the following order @xmath259",
    ", the reduced lagrangian is given by ( [ reduclagralg ] ) , which is rather written with the unknown @xmath260 on the left - hand side @xmath261    as announced in the appendix , the pivotal matrix is the set of @xmath228 and @xmath262 , acting on the set of unknown components of @xmath263 .",
    "again , it is not invertible ; this corresponds to the case where the inversion is possible only under some integrability conditions on the right - hand side @xmath264 , to which one must add the set of @xmath265 and @xmath266 acting on the set of components of @xmath263 that are already known , i.e. on @xmath235 . and",
    "the solution , if it exists , is not unique .",
    "the requirements concern the seven components of the reduced lagrangian @xmath283 , which are ideally put to zero .",
    "the freedoms are embodied in six components of @xmath281 and in the gauge function @xmath108 .",
    "more precisely , the primary requirement ( averaging reduction ) means that the fluctuating part of the reduced lagrangian must be zero : @xmath284 ; actually , the chosen basis for @xmath0-forms is not averaged , so that each component can not be averaged separately , e.g. neither @xmath285 nor @xmath286 are averages , but the sum of them @xmath287 is an average . the secondary requirement ( magnetic moment reduction )",
    "means that the gyro - angle component of the lagrangian must be the magnetic moment : @xmath288 , and @xmath289 for @xmath290 .",
    "the tertiary requirement ( maximal reduction ) means that the average part of the reduced lagrangian should be zero as well : @xmath291 ( except @xmath292 ) .",
    "when integrability conditions can not be solved for so strong requirements , the tertiary requirement is released , but as little as possible , and one sets to zero as many components @xmath283 as possible .",
    "+ let us solve equation ( [ lagrredord1 ] ) .",
    "the pivotal matrix is not invertible .",
    "it has six columns and seven rows ; the columns @xmath293 and @xmath132 are not linearly independent ; in addition , its column for @xmath129 is zero , which means that @xmath292 can not be controlled by the freedoms @xmath263 .",
    "so , the existence of solution is submitted to integrability conditions ( by which the freedoms @xmath294 and @xmath295 can be constrained ) , and then the existing solutions are not unique .",
    "+ the integrability conditions are automatically satisfied . the overall equation for the column @xmath293 will be automatically zero , because the procedure will imply @xmath296 , and @xmath297 .    as for the column @xmath129",
    ", it writes : @xmath298 the averaging requirement means that @xmath299 , which implies @xmath300 the average part of the equation then writes _ 1^= _",
    "1^ = , [ magmomsucceeded ] which makes the automatically verified for this component . in fact , if @xmath132 had not been chosen as a preliminary coordinate , it is here that it could be identified .    as a side comment",
    ", it might seem that the right - hand side of equation ( [ magmomsucceeded ] ) should be @xmath127 instead of @xmath132 , because of formula ( [ requirprior2 ] ) .",
    "however , in the derivation , all expressions for @xmath107 are functions of @xmath132 . in the reduced system",
    ", the corresponding expressions will be the same functions evaluated on the reduced coordinate @xmath127 , as is well emphasized in @xcite .",
    "so , formula ( [ magmomsucceeded ] ) means that the first - order reduced lagrangian @xmath301 will actually have its @xmath131 component equal to @xmath127 .",
    "it is why this result verifies the requirement ( [ requirprior2 ] ) on the magnetic moment .",
    "we will not insist more on this point .    with the result ( [ magmomsucceeded ] ) ,",
    "the reduced lagrangian will contain the term @xmath302 , implying the presence of the vector @xmath58 , which is not determined .",
    "this feature already appeared in the computation of @xmath303 , but the vector @xmath58 involved in @xmath304 came from a term @xmath305 , so that the overall contribution of the vector @xmath58 actually cancelled .",
    "just the same way now , the term @xmath306 is required to come from a total contribution @xmath307 this imposes a non - zero contribution for @xmath308 : @xmath309 for a maximal reduction , minimizing @xmath308 then means minimizing @xmath310 ( and ideally setting it to zero ) .",
    "+ for the remaining @xmath311 columns , the pivotal @xmath312 matrix is invertible for the five unknowns @xmath313 , as is clear through the following argument :    - the freedom @xmath277 controls the column for @xmath314 , since the coefficient @xmath315 is invertible and no other unknown component of @xmath263 appears in this column .",
    "this does not determines fully @xmath277 , since the freedom @xmath316 appears in the column , and @xmath316 is to be identified by the column @xmath317 , in which @xmath277 appears again .",
    "thus , the set of @xmath318 can be considered as a coupled set of equations for @xmath319 .",
    "but it is solvable ; it implies that ( s_1 ) = k ( , ) , [ s1gene ] is an arbitrary function of @xmath320 and @xmath3 , and that _ 1^ = _ ( s_1 ) .",
    "[ g2bgene ]    - in a similar way , the set of @xmath321 is a coupled set of equations for @xmath322 , which is solvable .    - indeed , the freedom @xmath323 controls the column for @xmath324 , since the coefficient @xmath325 is invertible .",
    "the solution for @xmath323 is then parametrized by @xmath326 , which is still unknown , but appears in this column .    -",
    "then the freedom @xmath326 controls the column for @xmath327 , because when inserting the solution for @xmath323 , the coefficient of @xmath326 becomes just @xmath19 , which is invertible .    -",
    "the freedom @xmath328 controls the column for @xmath329 , since the coefficient @xmath330 is invertible and no other unknown component of @xmath263 appears in this column ( because now @xmath277 and @xmath326 are not unknowns any more ) .    - the freedom @xmath331 controls the column for @xmath332 , since the coefficient @xmath19 is invertible .",
    "the solution for @xmath331 is then parametrized by @xmath333 , which is still unknown , but appears in this column .    -",
    "then , all the components of @xmath334 remain free . they can be used to explore the various guiding - center representations @xcite . here , we are interested in a maximal reduction , which means to set them to zero , so that the optimal requirements are fulfilled . the freedom @xmath335 in @xmath316 ( which is a parameter in the formulae obtained for @xmath277 , @xmath323 , @xmath326 , @xmath328 , and @xmath331 ) can not be useful to improve anything and is set to zero : ( s_1)=0 .",
    "[ avgs1settozero ]    - the freedom @xmath333 is still undetermined , it embodies the non - uniqueness of the solution implied by the pivotal matrix being not invertible",
    ". this freedom will be useful for the requirements at the following order . as a consequence",
    ", the order mixing will not include only two orders , but three of them , and the pivotal matrix will act on components of @xmath336 .",
    "in addition , the orders will not be solved independently , since the unknown @xmath333 will be identified at order @xmath337 , whereas it already appeared in the equations at order @xmath301 , so that it is a parameter in the expression computed for @xmath331 . +",
    "this procedure shows that the average and fluctuating parts of the equations are dealt with the same way , because the equations for @xmath88 is algebraic .",
    "this is very different from the minimal guiding - center reduction by lie transforming the equation of motion , whose equation relies on the operator @xmath219 , and which easily controls the fluctuating part of the equation , but involves secular differential equations for the average part of the equation @xcite .",
    "+ at that point , it seems that the order @xmath301 has been completed : it is indeed completely satisfactory in itself , since all of the requirements are perfectly fulfilled , with the resulting reduced lagrangian @xmath338 .",
    "however , the procedure will have to be slightly changed , because at the following order the secondary requirement for @xmath339 can be controlled by no higher - order freedom ; it can be controlled only by @xmath340 , which was already determined above by the tertiary requirement for @xmath341 .",
    "these two requirements can not be simultaneously fulfilled and one of them has to be dropped .",
    "it is here that the requirements are not dealt with in the same way : as one of them must be dropped , the choice is imposed by the hierarchy and the secondary requirement must be preferred to the tertiary one .    as a consequence , @xmath340",
    "must be let free at first order .",
    "it remains a parameter in @xmath328 and in @xmath342 .",
    "another consequence is that the tertiary requirement for @xmath341 has been lost , and @xmath342 has a non - zero value .",
    "actually , the equation for @xmath342 was coupled with the one for @xmath324 , and the non - zero term can be put in either of these components of @xmath107 .",
    "one can consider recovering a zero value for this term by using the freedom @xmath335 available in @xmath316 , which had been arbitrarily fixed to zero in the process above in equation ( [ avgs1settozero ] ) .",
    "but the corresponding equation for @xmath335 has no solution .",
    "indeed , requiring @xmath343 is an equation for @xmath335 , which is the only available freedom k = ( _ 1^ ) .",
    "[ seculardiffequation ] with the expression ( [ avgg1mu ] ) for @xmath340 , it can be studied by expansion in series @xmath344 .",
    "expanding the right- and left - hand side of the equation and equating the coefficient of the same orders in @xmath293 and @xmath132 gives a non - solvable equation .",
    "for instance , the coefficient of order @xmath345 implies the following equation  k_2 = - , [ obstruction ] which has no solution for a general magnetic geometry .",
    "so , the only available freedom can not be used to obtain the full reduction @xmath346 and @xmath347 .",
    "one of those components has to be non - zero .",
    "+ computing explicitly the expressions for the solution at order @xmath301 according to the procedure identified above gives the following results",
    "@xmath348 \\ncr      \\osc(\\bfmg_1^\\mu )         & =      \\mu\\tfrac{\\sqrt{2\\mu b}}{b }      \\big [        -\\tfrac{b\\apos \\sfa}{b }      -\\phi\\tfrac{\\cba+\\abc}{2 }      -2\\phi^2\\abb      \\big ] \\label{oscg1mu } \\\\",
    "\\avg(\\bfmg_1^\\phi )      & =      \\tfrac{1}{\\sqrt{2\\mu b } }       \\big [        \\overline\\ga_1'^\\sfb      + \\mu \\tfrac{\\cba-\\abc}{2 }      \\big ]      -\\tfrac{\\phi}{2\\mu}\\avg(\\bfmg_1^\\mu ) \\ncr      \\overline h_1         & =      \\sqrt{2\\mu b}\\phi      \\big [      \\overline\\ga_1'^\\sfb      + \\mu\\tfrac{\\cba-\\abc}{2 }      \\big ]      +      b\\avg(\\bfmg_1^\\mu ) \\ncr      \\bfmg_2^\\sfa       & =      \\tfrac{\\mu}{b }      \\big [      \\phi\\tfrac{7\\cba -9\\abc}{4 }      -\\phi^2\\abb      \\big ]      + \\tfrac{1}{2\\sqrt{2\\mu b}}\\avg(\\bfmg_1^\\mu ) \\ncr      \\bfmg_2^\\sfc          & =      -\\tfrac{\\sqrt{2\\mu b}}{b}\\tfrac{\\bfmg_1^\\th}{2 }      -\\tfrac{\\mu}{b}\\aca      \\ , , \\label{resultsorderga12}\\end{aligned}\\ ] ] where following littlejohn , a condensate notation is used for gradients : the curved prime is used to indicate gradients of the magnetic field , and the short overbar over a vector @xmath2 or @xmath190 indicates the matrix transpose ( for the euclidean scalar product ) , so that @xmath349 and @xmath350 .",
    "this notation comes from @xcite , slightly adapted to make it more explicit , in order to fit in with higher - order expressions @xcite .",
    "be careful , the straight prime and the long overline are different and do not indicate gradients or matrix transpose , e.g. in @xmath351 .    finally , the first - order reduced lagrangian writes",
    "_ 1 = -d + _ 1^d - h_1 dt .",
    "[ lagrredord1sol ]    in the results above , the term @xmath324 was kept free in order to include both of the choices considered above . as @xmath324 is free , the natural choice for a maximal reduction is @xmath346",
    "; then the reduced hamiltonian is non - zero : @xmath352 alternatively , @xmath342 can be set to zero , by choosing _",
    "1^ = - ( _ 1^ ) - .",
    "[ choiceh1=0 ] this last choice is possible only if the inversion of @xmath293 does not cause a singularity , i.e. if @xmath340 has no overall contribution of order zero in @xmath293 , which will have to be verified when @xmath340 is identified ( see equation ( [ avgg1mu ] ) ) .",
    "the first - order lagrangian ( [ lagrredord1sol ] ) induces the following first - order reduced lagrange matrix , which will be part of the pivotal matrix at higher orders : @xmath353[l]{\\raisebox{0ex}[0pt][0pt]{\\text{\\large { $ \\overline\\om_1^{\\bfq;\\bfq}$ } } } } &              & 0&\\bfmr_g\\cdott\\sfa&0              & \\p_a \\overline h_1          \\\\              & &              & -   \\p_\\phi\\overline\\ga_1'^\\sfb               & -   \\p_\\mu\\overline\\ga_1'^\\sfb+\\bfmr_g\\cdott\\sfb & 0              & \\p_b \\overline h_1      \\\\",
    "\\hline              0&0 & \\p_\\phi\\overline\\ga_1'^\\sfb               & 0&0&0              & \\p_\\phi \\overline h_1          \\\\               -\\bfmr_g\\cdott\\sfc&-\\bfmr_g\\cdott\\sfa & -\\bfmr_g\\cdott\\sfb+\\p_\\mu\\overline\\ga_1'^\\sfb               & 0&0&1              & \\p_\\mu \\overline h_1          \\\\              0&0&0              & 0&-1&0              & 0      \\\\ \\hline              -\\p_c \\overline h_1 &              -\\p_a \\overline h_1 &              -\\p_b \\overline h_1      &               -\\p_\\phi \\overline h_1 &               -\\p_\\mu \\overline h_1 &              0      &      0     \\end{array }     \\right ) }      \\ , , \\label{baromega1}\\end{aligned}\\ ] ] where the matrix @xmath354 is defined by @xmath355      d\\bfq                 \\ , .",
    "\\notag\\end{aligned}\\ ] ]    at the end of the first - order analysis , three freedoms remain : @xmath333 , which is a parameter in @xmath331 ; @xmath326 , which is a parameter in @xmath323 , in @xmath328 and in @xmath342 ; and either @xmath324 or @xmath342 , which is a parameter in the other one .",
    "+ the results ( [ resultsorderga11])-([resultsorderga12 ] ) have physical implications . for instance , @xmath356 determines ( together with @xmath225 ) the perpendicular component of the second - order larmor radius @xmath357 .",
    "its averaged contribution will imply that the larmor radius is not a pure fluctuation , and later on , a non - zero @xmath358 will be obtained , which will imply that the larmor radius is not purely transverse to the magnetic field .",
    "those features are well known in guiding - center works , and we do not insist on them . here , we focus on the mechanism of the reduction , to show how it can be performed to arbitrary order in the larmor radius using gauge - independent coordinates for the gyro - angle , and why it can be considered as a maximal reduction .",
    "+ this point is the turning point of all the reduction : the matrix @xmath359 is invertible .",
    "thus , in the induction for high orders , the pivotal matrix @xmath258 will be the set of @xmath360 acting on the set of unknown components of @xmath361 .",
    "it means that with respect to the reduction procedure announced in [ sect : appendi ] , the first stage of the reduction is achieved , and the order at which @xmath362 becomes invertible is @xmath363 .",
    "so , the critical order at which the pivotal matrix becomes the same at each order is @xmath364 ( see the appendix for a more detailed analysis of the reduction procedure , with especially the role of the orders @xmath365 and @xmath366 , introduced in pages and ) .",
    "accordingly , the algorithm for the derivation at high orders ( third stage mentioned in the appendix ) can be identified by now , but it will be efficient only for orders @xmath367 . the intermediate orders ( named `` second stage '' in the appendix ) must be studied separately .    in order to introduce the derivation order by order",
    ", we first go through the second stage and postpone the third stage , but it is important to notice that this last is independent of the second stage and could be studied before .",
    "especially , all the high - orders algorithm relies on the matrix @xmath258 , together with the differential operators involved in @xmath368 .",
    "they are already known by now , and are determined by the choices that have been made previously , and mainly by the choices at order @xmath0 .      at the following order @xmath369",
    ", the reduced lagrangian is given by ( [ reduclagralg ] ) _ 2 = _",
    "3_-1 + _ 2_0 + d + ds_2 .",
    "[ lagrredord2z ] at the previous orders , it appeared that for the algebraic part of the equations , the requirements on the average lagrangian were dealt with exactly the same way as the requirements on the fluctuating lagrangian .",
    "so , they will not be studied separately .",
    "only the integrability condition will restore a difference between them for some of the unknowns .    at this point ,",
    "the scheme for the unknown @xmath370 is not purely algebraical : @xmath225 is still not completely known , and it is involved in a first - order differential non - linear equation because of the term @xmath371 , with @xmath372    in equation ( [ lagrredord2z ] ) , the exterior derivative must be computed for the @xmath0-form @xmath373 that is not explicitly known yet . unlike in previous subsections , an explicit computation is not possible , and an abstract formula must be used ; care must be taken that the usual formula ( [ extderiv ] ) for exterior derivative can not be used , because it is valid only when the basis is composed of closed @xmath0-forms .",
    "otherwise , it is replaced by the more general formula : @xmath374 for any @xmath0-form @xmath102 , with components @xmath375 in the basis @xmath376 .    in formula ( [ extderivgene ] ) ,",
    "two operations are to be identified : the action of the exterior derivative on scalar functions @xmath377 expressed in the chosen basis for @xmath0-forms , and the exterior derivative of the basis @xmath378 .    for the exterior derivative on scalar functions @xmath377 , it writes as usual",
    "@xmath379 provided the differential operators @xmath380 are given by the dual basis ( [ basisvectfield ] ) to the chosen basis ( [ basis1forms ] ) of @xmath0 forms @xmath381 .    as for the exterior derivatives of the basis @xmath382 , they are easily computed as : @xmath383 in @xmath384 , the derivative @xmath385 appears .",
    "such terms should be avoided , since they are not determined , as shown by ( [ connectboth ] ) .",
    "but there is no trouble here , since in all the @xmath0-forms in this derivation , the term @xmath386 comes from @xmath387 .",
    "the exterior derivative of the second term will generates @xmath388 , which will automatically cancel the term @xmath58 coming from @xmath389 .    as a result",
    ", there is no need to compute those terms .",
    "computing the exterior derivative of a @xmath0-form @xmath102 can be made according to the following procedure : write @xmath390 , where now the spatial components @xmath391 do not involve @xmath392 . then apply formula ( [ extderivgene ] ) to @xmath393 and to @xmath394 .",
    "the cancellation of the terms containing @xmath395 gives the resulting formula : d = _",
    "i(_i^j-_j^i)_j + ^i d_i - _ i_i^_gd , [ extderivpractical ] in which @xmath396 , where @xmath397 is the kronecker delta , which means that @xmath398 is exactly @xmath382 but without the problematic term in @xmath399 .",
    "+ with formula ( [ extderivpractical ] ) , the quadratic term in @xmath225 is found to have its momentum components linear in the unknowns @xmath400 , and differential only for @xmath333 : @xmath401      \\label{quadraticg1momentum } \\\\      6 \\big ( i_{\\bfmg_1}d\\lambda \\big)^\\mu      & =      -\\bfmg_1^\\sfa \\p_\\mu       \\big [          2\\bfmg_1^\\sfa\\bfmr_g\\cdott\\sfa          -          2\\bfmg_1^\\th      \\big ]      + 4\\bfmg_1^\\sfa\\bfmr_g\\cdott\\sfa      -      4      \\bfmg_1^\\th \\ncr      6 \\big ( i_{\\bfmg_1}d\\lambda \\big)^\\th      & =      -\\bfmg_1^\\sfa",
    "\\p_\\th       \\big [          2\\bfmg_1^\\sfa\\bfmr_g\\cdott\\sfa          -          2\\bfmg_1^\\th      \\big ]      +      6\\bfmg_1^\\mu      + \\bfmg_1^\\sfa      .6 j_{322 }      \\ , ,      \\notag\\end{aligned}\\ ] ] where the coefficient @xmath402 is defined by @xmath403      \\,.\\ ] ] notice that it does not depend on @xmath58 , precisely because the term @xmath404 coming from formula ( [ extderivgene ] ) cancels the corresponding term in @xmath405 . + the differential equation for @xmath333 does not make things much more complicated , since it can be easily solved , e.g. by expansion in @xmath159 and @xmath293 . alternatively , a trick can be used to make the scheme purely algebraical @xcite ; it is not essential for the derivation , but we will use it because it simplifies much the explanations .",
    "the idea is to notice that in this case , the only differential operators involved come from the second term of the exterior derivative @xmath406 , i.e. they are involved in expressions that write @xmath407 . in addition , in the sum over the index @xmath408 , only one of the terms involves a differential operator @xmath409 acting on the unknown @xmath333 , namely the term with @xmath410 . an integration by parts over this term can transfer the differential operator over the pre - factor @xmath230 , which is already known . this is a way to make the equation algebraic .",
    "this integration by parts is justified by the gauge function . the equation for @xmath337",
    "can be added a total derivative , which can be chosen @xmath411 and extracted from @xmath412 by @xmath413 : @xmath414 and this formula is not differential any more , but algebraic for @xmath415 , which is contained in @xmath416 .",
    "+ then , equation ( [ lagrredord2z ] ) becomes _ 2 = _",
    "3_-1 + _ 2_0 + + ds_2 , [ lagrredord2zz ] with @xmath417[0ex]{\\large 0}&~~              & 0&0&1              & \\raisebox{-1ex}[0ex][0ex]{\\large 0 }          \\\\              & &              & 0&-1&0              &     \\end{array }     \\right ) }      \\notag      \\,,\\end{aligned}\\ ] ] where the momentum components are written in matrix form because they will determine the unknowns @xmath418 .",
    "now , the induction relation just relies on a pivotal matrix @xmath419 , which appears in the set of @xmath420 in which a linear algebraic operator ( a matrix ) acts on the unknown components of @xmath421 .",
    "it is invertible in the sense that it determines six unknown components of @xmath421 , which is the maximum that can be done at each order .",
    "remember the matrix can not be fully invertible , since the transformation is time - independent , so that @xmath88 is @xmath67-dimensional , whereas the matrix has value in the @xmath62-dimensional space @xmath422 ; and by the way , the @xmath62-dimensional matrix is anti - symmetric , hence not invertible .",
    "the seventh requirement is to be provided by the gauge function @xmath423 , which is the only integrability condition involved at this order .      to solve the equation , an analysis similar to the one at the previous order leads to the procedure summarized in the following tabular , where each row corresponds to one of the equations .",
    "the component @xmath426 of the reduced lagrangian involved in the corresponding equation is indicated in the first column ; the unknown which controls the equation and permits @xmath427 is indicated in the second column ; the coefficient to be inverted is indicated in the third column .",
    "@xmath428    a few comments are in place .",
    "as had been announced in the derivation of formula ( [ oscg1mu ] ) , the new feature is that the equation for @xmath429 can be controlled only by the average first - order magnetic moment @xmath340 .",
    "it is why it was not available at the previous order .",
    "the coefficient @xmath219 is an operator , but it is invertible over gyro - fluctuations .",
    "the set of @xmath430 is a coupled set of equations for @xmath431 , but each of the unknowns can be assigned to one of the equation because the system can be solved in the following way . the freedom @xmath432 controls the column for @xmath433 , since the coefficient @xmath325 is invertible .",
    "the solution for @xmath432 is parametrized by @xmath434 , which is still unknown , but appears in this equation .",
    "then , the freedom @xmath434 controls the column for @xmath435 , because when inserting the solution for @xmath432 , the coefficient of @xmath434 becomes @xmath19 , which is invertible .    at the end ,",
    "the reduced lagrangian @xmath337 is free and can be set to zero , as required for the maximal reduction .",
    "the freedom @xmath436 ( which is a parameter in the formulae obtained for @xmath333 , @xmath358 , @xmath432 , @xmath434 , @xmath437 , and @xmath438 ) can not be useful and is set to zero .",
    "+ in a similar way as at the previous order , at that point , the order @xmath337 is completely satisfactory in itself , since the reduced lagrangian has been fully reduced @xmath439 .",
    "however , the procedure will have to be changed , because at the following order the secondary requirement for @xmath440 can be controlled only by @xmath441 , which is therefore not available to get the tertiary requirement for @xmath442 .",
    "so , this last requirement has to be dropped .",
    "accordingly , @xmath441 remains free at this order , and it is a parameter in @xmath437 and in @xmath442 .",
    "this last has a non - zero value , but its equation was coupled with the one for @xmath433 , and the non - zero term can be put in either of these components of @xmath337 .",
    "+ one can consider recovering a zero value for this term by using the freedom @xmath436 , whose value had been arbitrarily fixed to zero in the process above .    indeed ,",
    "if @xmath443 is let as a free parameter in @xmath358 , @xmath333 and @xmath432 , then when replacing these variables by their expression , the requirement @xmath444 becomes an equation for @xmath436 .",
    "unfortunately , this equation is not easily studied .    as a first attempt",
    ", @xmath423 can be chosen such that it is absent from @xmath333 , as it was done in equations ( [ s1gene])-([g2bgene ] ) .",
    "then it is easy to see that the equation for @xmath436 will have the same structure as equation ( [ seculardiffequation ] ) .",
    "this equation may not be integrable , as it was the case for equation ( [ seculardiffequation ] ) . in this case",
    ", one should relax the condition for @xmath436 to be absent from @xmath333 , and the differential equation for @xmath436 could be more difficult to study , because @xmath333 is involved in the @xmath0-form @xmath445 in equation ( [ lagrredord2 ] ) in a rather intricate way .",
    "+ applying the procedure identified above gives @xmath446 where @xmath447    with the results ( [ avgg1mu])-([hamiltredord2 ] ) , the parameters involved in formulae ( [ resultsorderga11])-([resultsorderga12 ] ) can be made explicit : @xmath448 \\label{resultsdeparametrized1 } \\\\",
    "\\overline h_1         & =      \\sqrt{2\\mu b}\\phi      \\big [      \\overline\\ga_1^\\sfb      -\\mu\\tfrac{\\cba-\\abc}{2 }      \\big ] \\ncr      \\bfmg_2^\\sfa       & =      \\tfrac{\\mu}{b }      \\big [      \\phi\\tfrac{5\\cba -7\\abc}{4 }      -\\phi^2\\abb      \\big ] \\ncr      \\bfmg_2^\\sfc          & =      \\tfrac{\\mu}{b }      \\big [      -\\tfrac{b\\apos \\sfc}{b }      +      \\phi\\tfrac{\\aba-\\cbc}{4 }      -      \\phi^2\\cbb      \\big ]      +      \\tfrac{\\sqrt{2\\mu b } } { b }      \\tfrac{\\p_\\mu \\avg(s_2')}{2 }      \\ , .",
    "\\label{resultsdeparametrized2}\\end{aligned}\\ ] ] the reduced first - order hamiltonian for the choice @xmath449 is @xmath450 the reverse choice @xmath347 is possible , since its existence condition in equation ( [ choiceh1=0 ] ) is satisfied , as is clear in ( [ avgg1mu ] ) .",
    "it corresponds to a component @xmath451 of the reduced lagrangian given by _ 1^= , [ lagrredord1alain ] which is regular in @xmath452 , as expected .",
    "in formulae ( [ avgg1mu])-([resultsdeparametrized2 ] ) , the components @xmath225 and @xmath453 have been completely computed and simplified for comparison with previous results , because it is the point where usual derivations stop .    for the other components",
    "@xmath432 , @xmath438 , @xmath437 , and @xmath454 , formulae ( [ avgg1mu])-([resultsdeparametrized2 ] ) are explicit solutions .",
    "their right - hand side involves only known quantities ( or quantities that are free parameters for these relations ) , but it has not been not expanded and simplified .",
    "this can can be done in a straightforward way just by computing explicitly the terms involved , but we will not pursue in that direction , since the calculation for the @xmath455 is lengthy , and useless for our purpose , which is just to show how the procedure can be performed to arbitrary order .",
    "in addition , they are the topic of a work by the authors of @xcite , and were already partly introduced in @xcite .",
    "+ in the results , the term @xmath433 was kept free to include both of the choices considered above : setting the non - zero term in @xmath456 just means choosing @xmath449 .",
    "the other choice @xmath457 corresponds to @xmath458 this last choice is possible only if the term inside the curled parentheses has no overall contribution of order zero in @xmath293 .",
    "also @xmath436 was kept free , because one can consider using it to obtain the full reduction with both @xmath449 and @xmath457 : it will imply a differential equation for @xmath436 , which might not be integrable , just as happened at the previous order in equation ( [ seculardiffequation ] ) , but it might be integrable , or partly integrable , and then provide the full reduction , or at least a stronger reduction .",
    "otherwise , it can be set to zero .    at the end of the analysis at order @xmath369 ,",
    "it remains one unknown , one freedom , and a binary choice .",
    "the unknown is @xmath441 ; it is a parameter in @xmath432 and in @xmath456 ( or @xmath433 ) ; it will be determined at the following order .",
    "the freedom is @xmath436 , which remains free , but could not be used to improve the reduction .",
    "the binary choice is that either @xmath433 or @xmath456 is set to zero , the other is computed accordingly .",
    "this is very similar to what had occurred at the previous order , but now , the unknown @xmath459 does not appear as a parameter , since it is not at all involved at this order , as is clear in equation ( [ lagrredord2 ] ) .",
    "+      let us turn now to the following order @xmath460 .",
    "the equation writes ( [ reduclagralg ] ) @xmath461 the unknowns are components of @xmath462 .",
    "the pivotal matrix is not @xmath258 , i.e. not just given by @xmath463 , because of the correcting term @xmath464 .",
    "this term might make the derivation more difficult , since it is not algebraic , but non - linear and differential for @xmath253 @xmath465      \\,.\\ ] ] it can be written in matrix form @xmath466 where the matrices @xmath467 have obvious definitions , and are independent of @xmath468 .",
    "this is enough to show that this additional term can be transferred into the right - hand side , i.e. it involves only terms that are already known at each step of the computation .    when computing @xmath469 for the unknowns @xmath459 , @xmath441 , @xmath470 and @xmath471 , the only components of @xmath253 involved in the correcting term are in @xmath453 , which is already known at that point .",
    "then , when computing @xmath472 for the unknowns @xmath473 , @xmath474 , @xmath475 , and @xmath476 all the components of @xmath253 are involved in the correcting term , but they are all known at that point .    as a consequence , the correcting term can be put in the right - hand side of the equation , and the pivotal matrix is actually @xmath258 , i.e. the set of @xmath477 acting on the unknown components of @xmath462 .",
    "this means that the critical order at which the pivotal matrix becomes the same at each order is @xmath478 , and the order @xmath460 can be included in the third stage , with all higher orders , which is studied in the following section .",
    "now , the second stage of the method mentioned in appendix is ended and the third stage is beginning , which means that the matrix to be inverted is always the same at any order @xmath479 , and it is indeed invertible .",
    "so , the reduction can be performed to arbitrary order .",
    "the only possible complication comes from the integrability condition for the gauge - function @xmath108 ( and possibly @xmath94 ) , but after settling it , the reduction process becomes fully algorithmic and unique .",
    "this is proven by induction .",
    "let us suppose that at some order @xmath479 , the set of unknowns are @xmath480 which means that before that order , all lower - order quantities @xmath481 are already determined , and that after that order , all higher - order quantities @xmath482 will remain free parameters .",
    "this assumption is verified at order @xmath483 , which initializes the induction .",
    "as announced in the appendix , we have included the reduced lagrangian @xmath94 in the vector @xmath484 , because some components of @xmath94 can not be set to zero and have to be computed in the process .",
    "the reduced lagrangian is given by equation ( [ matrpivot ] ) @xmath485 where @xmath486 indicates all terms of @xmath487 that are of order @xmath81 but do not involve @xmath488 , @xmath489 or @xmath490 : @xmath491_n       -    [ \\bfmg_{n+1}\\cdott\\om_{-1 }      + \\bfmg_n\\cdott\\overline\\om_0      + \\bfmg_{n-1}\\cdott\\overline\\om_1 ]      \\,,\\ ] ] in which the index @xmath81 indicates the term of order @xmath81 .",
    "+ then , the pivotal matrix @xmath258 is the set of @xmath492 acting on the unknown components of @xmath361 .",
    "it is invertible in the sense that it determines six unknown components of @xmath361 , which is the maximum that can be done at each order .",
    "the last requirement is provided by the integrability condition for the gauge function @xmath108 .",
    "more precisely , grouping as usual in the left - hand side only the terms with unknown components of @xmath361 , and removing all the coefficients that do not contribute , the induction relation for @xmath94 writes @xmath493 where the terms involving known components of @xmath361 have been grouped with @xmath486 : @xmath494[l]{\\raisebox{0ex}[0pt][0pt]{\\text{\\large { $ \\overline\\om_1^{\\bfq;\\bfq}$ } } } } &              & 0&0&0              & \\p_a \\overline h_1          \\\\              & &              & -   \\p_\\phi\\overline\\ga_1'^\\sfb               & -   \\p_\\mu\\overline\\ga_1'^\\sfb & 0              & \\p_b \\overline h_1      \\\\",
    "\\hline              0&0 & \\p_\\phi\\overline\\ga_1'^\\sfb               & 0&0&0              & \\p_\\phi \\overline h_1          \\\\               0&0 & \\p_\\mu\\overline\\ga_1'^\\sfb               & 0&0&1              & \\p_\\mu \\overline h_1          \\\\              0&0&0              & 0&-1&0              & 0      \\\\",
    "\\hline              -\\p_c \\overline h_1 &              -\\p_a \\overline h_1 &              -\\p_b \\overline h_1      &               -\\p_\\phi \\overline h_1 &               -\\p_\\mu \\overline h_1 &              0      &      0     \\end{array }     \\right ) }     \\ , .      \\notag\\end{aligned}\\ ] ] again , the same comments as the ones after equation ( [ lagrredord1 ] ) are in place .",
    "also , when computing @xmath486 , formula ( [ extderivpractical ] ) is to be used to account for the derivative of the chosen basis of @xmath0-forms and for the cancellation of the derivatives of @xmath58 .",
    "+ when solving the induction relation , the mechanism is the same as at order @xmath227 for @xmath495 , and the same as at order @xmath301 for @xmath496 and @xmath497 .",
    "in addition , the new feature is the presence of @xmath498 for @xmath499 and @xmath500 , but the mechanism is similar to what happens at order @xmath337 , in the sense that the pivotal coefficients are the same .",
    "mainly , the procedure relies on three conjugation - like relations : @xmath501 are conjugated for @xmath228 ; @xmath502 are half - conjugated for @xmath503 , in the sense that the structure is quarter - canonical ; and @xmath504 are half - conjugated for the symplectic part of @xmath505 .",
    "the same procedure can be applied , which is reminded in the following tabular .",
    "@xmath506    then , all the components of @xmath152 remain free .",
    "this can be used to explore the various guiding - center representations at higher orders @xcite . here",
    ", we are interested in a maximal reduction , which means to set them to zero , so that the optimal requirements are fulfilled . the freedom @xmath443 , which is a parameter in the formulae obtained for @xmath507 , @xmath508 , @xmath509 , @xmath510 , @xmath511 , and @xmath512 , can not be useful and can be set to zero .",
    "+ in the same way as at orders @xmath0 and @xmath34 , @xmath513 must remain free at that order , because it will be needed to solve @xmath514 at the following order , just as @xmath515 is needed here to solve @xmath516 .",
    "so , one can not have the reduced lagrangian fully simplified @xmath517 .",
    "one of its component remains uncontrolled , either @xmath518 or @xmath519 .",
    "one can consider recovering a zero value for this component by using the freedom @xmath443 , whose value had been arbitrarily fixed to zero in the process above .",
    "then , when computing @xmath507 , @xmath508 and @xmath509 , the average gauge function @xmath443 remains a free parameter .",
    "when replacing these variables by their expressions , the equation @xmath520 becomes a differential equation for @xmath443 , whose structure is ( s_n ) = o.t .",
    ", [ seculareqordn ] where @xmath521 means other terms that can be explicitly computed .",
    "this resembles equation ( [ seculardiffequation ] ) , but here , the condition ( [ s1gene ] ) has not been required in the process , contrary to what happened in previous orders .",
    "the reason is that now @xmath522 is controlled by @xmath507 , which has no effect on @xmath523 .",
    "the integrability of equation ( [ seculareqordn ] ) will depend on the right - hand side and must be studied at each order ; a priori , it is not guaranteed , since obstructions such as ( [ obstruction ] ) are possible .",
    "so , a systematic procedure can not use the freedom @xmath443 to get the additional requirement @xmath524 , which must be dropped .",
    "then the freedom @xmath443 is useless and can be set to zero .",
    "+ at the end of the @xmath81-th - order analysis , exactly all of the unknowns @xmath484 have been determined .",
    "all the components of @xmath361 that remain unknown are in @xmath482 . yet",
    ", this does not allow us to conclude that the induction is proven , because the unknown @xmath525 already appeared as a parameter in @xmath511 and in @xmath342 ; hence it is not completely free , whereas the induction assumes it is free ( independent of the quantities @xmath526 ) , since it is in @xmath527 ; it will be determined at the next order , and this could imply coupled equations , whose solvability is to be verified .",
    "however , @xmath525 will be computed in equation for @xmath528 , which corresponds to the column @xmath529 in equation ( [ lagrredordn ] ) at the next order , and does not involve any of the parameter - dependent quantities . thus , there is no coupled equations , and the solutions are indeed explicit .",
    "this terminates the proof of the induction : the reduction can be performed to arbitrary order in @xmath30 .    notice that here",
    ", the induction relation is considered from the point of view of @xmath94 ; this caused an interlocking between the orders , where in the solution at each order , a parameter is involved , which will be identified at the next order , when computing @xmath530 . to avoid this interlocking phenomenon , it is possible to consider the induction relation from the point of view of @xmath531 . the drawback would be that when solving the equations for @xmath530 , one would begin the heavy computations for @xmath532 , which are involved in @xmath533 , hence at the next order . in computations by hands",
    ", this can be a trouble , but when using computer - assisted computations , this is no trouble and it would probably be a more relevant choice .",
    "the argument above emphasizes the distinction to be made between four kinds of quantities .",
    "first , some of the quantities are already known before the computation at order @xmath81 , namely @xmath534 .",
    "second , for @xmath535 the components @xmath283 have not been computed yet , but they can be excluded both from the unknowns and from the parameters , since the algorithm shows that before any computation , they are already known to be zero for all @xmath536 , to fulfil the requirements ( [ requirprior1])-([requirprior2 ] ) for @xmath107 .",
    "third , some quantities are not known yet , and will be determined after the matrix inversion , namely @xmath537 in which a vertical dash @xmath198 was written at the places where a vertical line will be written in the matrix @xmath258 below .",
    "last , other quantities are not known and will remain free after the matrix inversion , namely @xmath519 , @xmath443 and @xmath538 ; the variables @xmath538 will be determined at higher order , but one of its component , @xmath525 , is already involved in the equations at order @xmath81 and behaves as a parameter in this matrix inversion .",
    "so , the parameters are @xmath539 notice that @xmath540 is included in the parameters @xmath541 even if it is not an element of @xmath484 but of @xmath527 .",
    "+ with the procedure above , the left - hand side of equation ( [ lagrredordn ] ) can be written as just a matrix product , provided the pivotal matrix is extended , to act on all the quantities @xmath542 to be computed at this order , even the reduced hamiltonian @xmath523 and the gauge function @xmath108 . to include the gauge function @xmath108 in the vector which is acted upon by the matrix ,",
    "some coefficients in the matrix must be operators , and the equation will be transposed , so that the operators act on their right . for clarity , the order of the columns is chosen to fit with the steps of the algorithm @xmath543 so that the equations are solved one after the other in order .",
    "a vertical dash @xmath198 was written at the places where a horizontal line will be written in the matrix @xmath258 below .    with this order for the rows and for the columns ,",
    "the equation becomes _ ( _ n)_^t + _ ( _ n)_^t + ^t=0 .",
    "[ inductionordn ] here , the rows are the equations to be solved , corresponding to the ( re - ordered ) columns of equation ( [ lagrredordn ] ) .",
    "the first term involves exactly the unknown quantities to be identified at this order .",
    "the second term involves exactly the parameters involved at this order but which will remain free at the end of this order .",
    "the third term involves only quantities that are already known at the beginning of this order .",
    "the matrices are given by _ : = (     c@  c | cccc | cccc 1 & & & & & & & & & + & _ & & & & & & & & + & _ & - & & & & & & & + & _ & - & -1 & & & & & & + & _ c & -i & & -b & & & & & + & _ a & k & & & b & & & & + _ _ 1^ & _ b & & & & & & & & + _ ( _ 1^ ) & _ b & & & & & & & & + _ ( h_1 ) & & -h_0 & & & & & 2b & & + _ ( h_1 ) & & -h_0 & & & & 2b & & & -1    ) , [ matrixextpivotordn ] and @xmath544 in which the zeros were written only in the empty rows , for clarity , and we used that @xmath545 implies @xmath546 . + in the matrix @xmath258 , grouping together the eighth and ninth rows and columns produces a @xmath547 lower triangular matrix , whose coefficients on the diagonal are invertible , since the operator @xmath218 is invertible on gyro - fluctuations .",
    "the eighth and ninth rows and columns have been grouped together because they constitute an invertible @xmath276 matrix on the diagonal . a convenient way to invert",
    "the resulting @xmath547 matrix is to separate its diagonal terms : @xmath548 where @xmath549 has null diagonal and @xmath550 is purely diagonal .",
    "then the equation can be written @xmath551 the solution of equation ( [ inductionordn ] ) is then ( _ n)_^t = ( -d ) , [ inductionordnsol ] where @xmath552 is a diagonal matrix with coefficients @xmath553 in which @xmath554 is the inverse matrix for the coupled system ( the eighth diagonal term of the 9 * 9 matrix mentioned above ) @xmath555    the operator @xmath556 is the gyro - integral operator . it can be computed without introducing any gyro - gauge , with the intrinsic calculus introduced in @xcite , or with the matrix calculus introduced in @xcite .",
    "also , the coordinate @xmath36 can be used as an intermediate quantity for this computation , which is made at constant @xmath3 , so that the presence of a gauge ( only for the intermediate computation ) is of no consequence ; then @xmath556 is the primitive with respect to @xmath129 such that its gyro - average is zero . over the fourier modes @xmath557 ( i.e. over gyro - fluctuations )",
    ", it is the operator @xmath558 .",
    "+ even if @xmath559 appears in its right - hand side , formula ( [ inductionordnsol ] ) is an explicit solution for the induction relation : in the matrix @xmath560 , all the coefficients on the diagonal or above it are zero , so that when computing the unknowns one after the other starting from the left , each of them is computed as a function of previously computed quantities , i.e. the right - hand side contains only known quantities or parameters , but none of the remaining unknowns .",
    "alternatively , the induction can be solved using a standard matrix inverse ( _ n)_^t = - _ , [ inductionordnsol2 ] with @xmath561 easily computed from ( [ matrixextpivotordn ] ) , but the coefficients are more complicated , and practical computations usually follow the procedure of formula ( [ inductionordnsol ] ) .    for the solution @xmath484 , formula ( [ inductionordnsol ] ) or ( [ inductionordnsol2 ] ) must be completed by the following relations for the trivial components of @xmath94 : @xmath562 and by the determination of the parameters @xmath541 . + the first parameter @xmath540 will be determined at the following order , in an equation that does not involve @xmath509 and @xmath523 , so that there are not coupled equations between the orders .",
    "the second parameter @xmath519 is either put to zero or adjusted so as to make the reduced hamiltonian @xmath523 zero by the relation @xmath563      \\ , .",
    "\\notag\\end{aligned}\\ ] ] this last choice is possible only if the term inside the parentheses has no overall contribution of order zero in @xmath293 .",
    "the last parameter @xmath443 is determined by equation ( [ seculareqordn ] ) , in order to make both @xmath519 and @xmath523 zero , when the equation is integrable .",
    "otherwise , it is determined to cancel as many terms of @xmath519 and @xmath523 as possible , or it can be set to zero for simplicity .    accordingly , at the end of each order @xmath479 , the situation is the same as at the end of order @xmath34 , with the presence of one parameter @xmath540 , of one binary choice between @xmath519 and @xmath523 , and of one free variable @xmath443 . when the integrability condition can be satisfied , the reduction of the lagrangian @xmath94 is complete and the solution is defined to within an element in the kernel of the operator ( [ seculareqordn ] )",
    ". otherwise , @xmath540 is generally set to zero , and after the binary choice the transformation is unique , but on the whole there are two maximal reductions .",
    "as announced in the appendix , the unicity of the transformation is determined by the integrability condition for @xmath108 , and possibly by an additional criterion for simplicity .",
    "computations of the previous section for the guiding - center transformation and reduced hamiltonian can be summarized by formulae ( [ larmorradiusosc ] ) , ( [ resultsorderga11])-([resultsorderga12 ] ) and ( [ avgg1mu])-([resultsdeparametrized2 ] ) . as for the reduced symplectic lagrangian , it is exactly known , and is given by formulae ( [ lagrredordzerosol ] ) and ( [ lagrredord1sol ] ) , together with the prescription that all other terms @xmath564 are zero , except @xmath565 ( as well as @xmath324 ) , which can be freely chosen , for instance it can be chosen zero , or such that it makes the reduced hamiltonian @xmath523 zero by formula ( [ choicehn=0 ] ) .",
    "these results agree with the standard results of the literature , provided the connection vector is defined as @xmath566 , which corresponds to the traditional gauge - dependent framework .",
    "for instance , in the paper @xcite littlejohn made the choice @xmath567 , and accounting for this choice , our formulae agree with his ones . in the paper @xcite ,",
    "the choice is @xmath568 , and again , accounting for this choice through formula ( [ lagrredord1alain ] ) for @xmath324 , our results agree with the ones of @xcite .",
    "thus , the procedure of the previous section succeeds in obtaining the standard guiding - center reduction without introducing any gyro - gauge and using purely intrinsic coordinates .",
    "+ the explicit induction relation ( [ inductionordnsol ] ) shows that the reduction is possible to arbitrary orders , but it also gives an explicit formula to practically compute the transformation generator order by order . at any order in the larmor radius , all that remains to do is to develop the lie derivatives involved in the term @xmath569 .",
    "only the number of terms generated by the leibniz rule makes the process difficult to compute by hand at higher order , but the explicit induction involves few basic operations ( just exterior derivatives and matrix products ) and can easily be implemented to higher orders on a computer .",
    "actually , as the series is a polynomial , the derivation does not rely on formal calculus but just on symbolic calculus , which is still easier to implement .",
    "+ once the generators @xmath88 are obtained , the guiding - center coordinate transformation is given by @xmath570    the reduced lagrangian @xmath0-form is @xmath571      \\sfb\\cdott d\\bfq      -      \\sum_n\\overline h_n dt \\label{lagrredtotalsolution } \\\\      & =      ( \\bfma+\\overline\\ga^\\sfb \\sfb)\\cdott d\\bfq      - \\mu\\sfa\\cdott d\\sfc      - \\overline h dt      \\",
    ", , \\notag   \\end{aligned}\\ ] ] where the hamiltonian terms @xmath523 are provided by ( [ inductionordnsol ] ) , whereas the parallel lagrangian terms @xmath324 and @xmath519 are chosen freely at each order @xmath81 , and can be chosen zero .",
    "the reduced dynamics is obtained the usual way , by computing the lagrange matrix @xmath572 , then inverting it to get the poisson matrix @xmath573 , and last computing hamilton s equations @xmath574 .",
    "alternatively , the reduced equations of motion can be obtained by lie transforming directly the velocity vector field @xmath575    here , performing these computations is useless , since the reduced lagrangian ( [ lagrredtotalsolution ] ) completely agrees with previous results in the literature in the gauge - dependent case , and so will the reduced motion .",
    "+ we only indicate the guiding - center poisson bracket , in which the effects of the gauge independence and of the higher - order corrections are interesting .",
    "it is computed from the lagrange @xmath34-form , easily obtained from eq .",
    "( [ lagrredtotalsolution ] ) in a matrix form : @xmath576 with @xmath577 where we used the fact that the order in @xmath168 indicates the expansion order , as mentioned about eq .",
    "( [ scaling ] ) .",
    "then the poisson bracket in matrix form writes : @xmath578 with @xmath579 where the reduced magnetic field @xmath580 is defined as usual by formula ( [ bstar ] ) .",
    "the coefficients @xmath581 and @xmath582 are invertible since eq .",
    "( [ coefflagrmatrred ] ) shows that they are small corrections from @xmath330 and @xmath325 , which are invertible .    as a result , between two arbitrary functions of the reduced phase space @xmath583 and @xmath584 ,",
    "the poisson bracket is @xmath585 where the symbol @xmath586 is a shorthand for the operator @xmath587 this operator does not depend of the free function @xmath58 , since for any choice of @xmath58 the definition ( [ nablastar ] ) gives the same result , which is equal to the covariant derivative @xmath28 when the gauge vector is chosen zero , i.e. @xmath588 .",
    "the poisson bracket ( [ poissbrackred ] ) agrees with the literature , e.g. @xcite . especially , the traditional ordering is patent : the last two terms are of order @xmath589 , and correspond to the fast gyro - angle dynamics ; the second term is of order @xmath590 , and corresponds to the intermediate motion along the magnetic field lines ; as for the first term , it is of order @xmath591 , and corresponds to the slow drifts across the magnetic field lines .",
    "remind @xmath592 , as defined in ( [ definitepsilon ] ) , is the usual small parameter of guiding - center theory .",
    "in previous works , the reduced poisson bracket often had only three coefficients ( the ones for @xmath580 , namely @xmath593 , @xmath581 , and @xmath594 ) , either because of incidental lowest - order simplifications , or because of the choice they had performed for @xmath595 . for a general result about maximal reductions at arbitrary order ,",
    "the poisson bracket is given by eq .",
    "( [ poissbrackred ] ) , where the higher - order correction @xmath596 to the lagrangian impacts five coefficients @xmath593 , @xmath581 , @xmath594 , @xmath582 , and @xmath597 ( and hence @xmath580 ) , through the definitions ( [ coefflagrmatrred ] ) , i.e. as an effect of the five derivative operators @xmath598 , @xmath599 , @xmath600 , @xmath601 , @xmath602 , acting on the seminal term @xmath596 .",
    "+ the only difference compared to previous results , besides the coordinate system and the term @xmath603 being let free , is that the gauge vector @xmath604 is replaced by the general connection @xmath605 .",
    "this difference could impact the reduced magnetic field @xmath580 , given by _ * : = -a- b- c = ( + ^ ) + v , [ bstar ] where the vector @xmath606 is generated by the term @xmath607 in the lagrangian @xmath107 , which implies for the lagrange @xmath34-form the presence of the term @xmath608 the first equality comes by inserting the identity @xmath609 beside the wedge symbol .",
    "the second and third equalities come because @xmath21 is orthonormal .",
    "the fact that the vector @xmath47 depends only on @xmath3 implies the fourth equality , which can be rewritten to get the final answer .",
    "( [ curlgaugevectintrin ] ) shows why the vector @xmath606 ( and hence also the reduced poisson bracket ) is indeed independent of the free function @xmath58 . in the reduced lagrange @xmath34-form ,",
    "the concerned term ( [ curlgaugevectintrin ] ) is the counterpart in the gauge - independent approach of the term @xmath610 involving the gauge vector in the traditional approach .",
    "actually , the curl of the gauge vector @xmath611 is also gauge - independent , and the corresponding term is explicitly given by @xmath612 where again , the second equality comes by inserting the identity @xmath613 beside the wedge symbol and by using the fact that @xmath40 is orthonormal .",
    "so , in the reduced magnetic field @xmath580 , the term with @xmath58 exactly fits with the corresponding term with @xmath53 of previous results .",
    "this is a good illustration of how the approach using the coordinate @xmath2 completely agrees with the gauge - independent part of the usual results , whereas it proceeds in a different way and never introduces the gauge @xmath41 .",
    "indeed , in the usual approach , @xmath52 is assumed to depend only on the position , which implies the formula above . on the contrary , in the gauge - independent approach ,",
    "the velocity is present in the first lines of ( [ curlgaugevectintrin ] ) , but it comes out from the computation that the result is naturally just a purely spatial term in the lagrange matrix .    by the way , the argument above shows that @xmath606 is indeed the curl of @xmath614 , but it is not surprising since the spatial part of a term @xmath615 is given by the cross product with the curl of @xmath616 : @xmath617    thus , formula ( [ bstar ] ) can be rewritten @xmath618   \\,,\\ ] ] which is manifestly divergenceless . + here , for clarity and following previous works , we considered no electric field , in order to focus on the reduction mechanism .",
    "the extension for a non - zero electric field is straightforward , because the lagrangian is changed only by the addition of [ lagrelecfield]@xmath619 , with @xmath620 the electric potential @xcite .",
    "it affects the spatial part of @xmath621 , which plays no pivotal role in the derivation : it always appears in the right - hand side of the equations , i.e. in terms that are already known .",
    "as a consequence , the presence of this term does not change the procedure at all . in the results ,",
    "each term of order @xmath81 becomes a polynomial in @xmath98 ( or rather @xmath622 ) , which introduces a second parameter @xmath623 in the theory , which corresponds to @xmath624 or to @xmath625 .",
    "a more detailed study shows that the momentum in denominators is only the perpendicular momentum @xmath626 , and that at the lowest orders the perpendicular electric field can be one order higher than the parallel electric field @xcite .",
    "the series remains perturbative provided the associated parameter is small @xmath627 , as usual in guiding - center reductions .      in the results above",
    ", the usual expansions are recovered , but the choice of the coordinates @xmath2 and @xmath293 makes all quantities polynomial in the used coordinates and monomial in @xmath628 and @xmath168 .",
    "this is useful to simplify the derivation , which can be considered as a symbolic - calculus algorithm based on just two operations acting on words ( polynomials ) composed from a very restricted alphabet .",
    "such structures can also be useful when going beyond the formal expansions and considering them as asymptotic series .",
    "for instance , the polynomiality in the cotangent of the pitch - angle is important to control the loss of accuracy of the expansion in the domains where the direction of the particle momentum is close to the direction of the magnetic field .",
    "previous results were obviously polynomial in the variable @xmath2 , but they did not use it as a coordinate , since they replaced it by the variable @xmath129 .",
    "in addition , the expansion in the usual small parameter @xmath629 was also present , but it did not correspond to an expansion in @xmath132 nor in @xmath19 , but only in @xmath28 , which is not a scalar quantity ; it is why keeping the quantity @xmath32 was useful to indicate the expansion order . here , the order is directly indicated by the power in @xmath159 or @xmath168 , since each order is a monomial in those quantities .",
    "the monomiality in @xmath628 is especially interesting , because the orders in the operator @xmath28 and in the function @xmath19 have only a dimensional meaning : the term of order @xmath85 will involve terms like @xmath630 , but also terms like @xmath631 , or @xmath632 . in a similar way",
    ", the order in @xmath19 is given by the order of the prefactor @xmath633 , but the variable @xmath19 appears in other places when it is acted upon by gradients ; then , it is compensated by a @xmath19 in the denominator , which means that gradients act only on the variable @xmath634 .",
    "+ the use of the variable @xmath293 instead of the usual @xmath635 is crucial for the results at each order to be both polynomial in the coordinates and monomial in @xmath159 and @xmath168 .",
    "it is a generalization of @xcite , which considered only the minimal guiding - center reduction .",
    "it seems it had not been noticed in previous works on the full guiding - center reduction @xcite .    when using the standard variable @xmath635 instead of @xmath293 , the monomiality in @xmath159 and @xmath168 is not verified : for instance , in @xmath333 , the term of order @xmath636 writes @xmath637 , which is not a polynomial in @xmath628 and which is not of the same order in @xmath159 nor in @xmath168 as the term of order @xmath638 , since this last writes @xmath639 , as is confirmed in @xcite , for instance .    on the contrary , when using the variable @xmath293 , the polynomiality is verified , because of the structure of the lagrangian , of the action of derivatives , especially ( [ connectboth ] ) , and of the coefficients to be inverted for the matrix inversions involved in the derivation .",
    "notice that the induction procedure also guarantees that all formulae will be polynomial in the variable @xmath47 .",
    "as for the monomiality , it is easily understood from a dimensional analysis : only three independent dimensional quantities are involved in the results , e.g. @xmath28 , @xmath640 and @xmath641 .",
    "when using the momentum coordinates @xmath642 or @xmath643 , two of them are dimensionless , and only one of them can generate the dimension of @xmath14 , namely @xmath14 or @xmath159 . for an expansion in @xmath644 , the variable @xmath132 can be involved only in the pre - factor of each order , otherwise , it could not be compensated to generate a dimensionless quantity .    on the other hand ,",
    "when using the momentum coordinates @xmath645 or @xmath646 , there is a redundancy in dimension between @xmath635 and @xmath14 ( or @xmath647 ) , which means that ratios of them are expected in order to get dimensionless quantities . in an expansion in @xmath30 , if the term of order @xmath648 is a polynomial in @xmath635 , it has to be actually a polynomial in @xmath649 or @xmath650 . as a consequence",
    ", formulae will be sums of terms @xmath651 , which is not a monomial in @xmath14 ( or equivalently in @xmath159 and @xmath168 ) ; by the way , it is not a polynomial either , because of the terms where @xmath652 .",
    "last , the polynomiality in @xmath293 means that each term writes @xmath653 , which agrees with the idea that the entities @xmath654 and @xmath655 come from expansions of the momentum @xmath5 , or rather the corresponding dimensionless vector @xmath656 .",
    "in addition to the averaging reduction and the inclusion of the magnetic moment among the reduced coordinates , the goal was to obtain a reduced dynamics as strongly reduced as possible .",
    "so , a complete achievement is obtained when all the components of @xmath657 are zero , at least for higher orders . for the procedure , it means using the seven unknowns to solve the seven corresponding equations , or rather twice these numbers , if one considers the average and the fluctuating parts as different variables .",
    "it did work for all the requirements but one , which could not be satisfied and had to be dropped .",
    "the obstruction for a complete reduction @xmath658 comes from the requirement ( [ requirprior2 ] ) : it imposes to obtain @xmath529 by fixing the freedom @xmath659 , which was the only freedom available for the equation @xmath660 and is no more available for it .",
    "it is why one of the requirements has to be dropped .",
    "then , it remains more unknowns than requirements .",
    "so , the transformation is not unique .",
    "especially , while it naturally appeared in @xmath135 , the non - zero component of @xmath107 can be transferred to @xmath661 .",
    "thus two maximal reductions can be considered .",
    "+ the first alternative ( called the _",
    "hamiltonian _ representation in @xcite ) sets @xmath662 .",
    "then , the reduced poisson bracket is completely known before computing the transformation to higher orders ; it is given by the lowest three orders of the symplectic lagrangian @xmath663 .",
    "the reduced hamiltonian is not exactly known ; it is given by a whole series in @xmath30 and must be computed order by order .",
    "the reduced dynamics is a hamiltonian perturbation of the guiding - center equations of motion at order @xmath34 .    the second alternative ( called the _",
    "symplectic _ representation in @xcite ) is to set @xmath664 .",
    "then , the hamiltonian is completely known , and the structure of the poisson bracket is also known . the only unknown information on the reduced dynamics is concentrated in the component of the reduced lagrangian parallel to the magnetic field @xmath519 , which is given by a whole series in @xmath30 .",
    "the poisson bracket includes a kind of reduced magnetic field @xmath580 , induced by the higher - order terms of the lagrangian .",
    "the choice of symplectic or hamiltonian representation can be made at each order in the derivation , but it seems more convenient to be consistent and to make the same choice for all orders , as suggested in @xcite .",
    "+ these two maximal reductions give a unified view of various choices that can be found in the literature , and they anticipate what will happen at higher orders .",
    "indeed , even in the standard non - canonical hamiltonian approach of the guiding - center reduction introduced by littlejohn , several transformations can be found , often related by differences of choice related to this two - fold maximal reduction .",
    "for instance , littlejohn s initial guiding - center reduction @xcite corresponded to the second possibility above at order @xmath259 , but at higher order , it is unclear whether the procedure provided a maximal reduction , or if some terms could remain both in the hamiltonian and in the poisson bracket .",
    "the seminal reduction by lie transforming the lagrangian @xcite corresponded to a maximal reduction with the first choice ( `` hamiltonian representation '' ) .",
    "later papers by lie transforming the lagrangian turned to the other choice , e.g. @xcite used a maximal reduction ( at order @xmath259 ) but with the second possibility . recently , while improvements in the second order were addressed @xcite , interest was renewed in the first possibility .",
    "the paper @xcite actually corresponds to a mixed choice , where the second possibility is used at order @xmath259 and the first one is used at order @xmath369 .",
    "the work @xcite introduced the designation of _ hamiltonian _ and _ symplectic _ representation to differentiate between the two choices , and studied an `` equivalence relation '' between the two choices ( when the same choice is made for all orders ) , which is a way to go from one representation to the other by a redefinition of the reduced parallel momentum @xmath665 ( or equivalently of @xmath666 ) . + the algorithm at higher order , with the condition ( [ choicehn=0 ] ) for the symplectic representation , had not been studied in detail . in the previous section ,",
    "the hamiltonian representation appeared as indeed guaranteed at arbitrary order , and as naturally provided by the procedure as a maximal guiding - center reduction , whereas the symplectic representation appeared as submitted to a condition at each order in @xmath30 : in formula ( [ choicehn=0 ] ) , the term inside the bracket must have no overall contribution of order @xmath147 in @xmath293 .",
    "this could explain why first papers addressing both the first and the second order in @xmath30 systematically used the hamiltonian representation ; the symplectic representation was used only later , when the condition was observed as verified .",
    "the equivalent relation introduced in @xcite relies on a relationship between these representations , which allows to go from one to the other .",
    "hence it might seem that it guarantees the existence of the symplectic representation , but it is not the case .    the underlying idea ( see equation ( 17 ) in @xcite ) is the following .",
    "start from the reduced lagrangian written in symplectic representation ( we use here the variable @xmath667 instead of @xmath293 , in order to agree with the notation used in @xcite ) : @xmath668 then , redefine the reduced parallel momentum so as to absorb all the series @xmath595 in it : p_ : = p _ + _ n=1 ( _ ) _ n .",
    "[ transformsymplecttohamil ] with this coordinate , the symplectic part of the lagrangian is fully reduced : @xmath669 to obtain the reduced hamiltonian with this coordinate , one just inverts the series ( [ transformsymplecttohamil ] ) : p _ : = p_ - _ n1 ( _ ) _ n = p_ + _ n1 ( _ )_n , [ seriesinverseregular ] with @xmath670 some coefficients easily obtained by inserting iteratively the first equality in the occurrences of @xmath665 in @xmath671 , as is standard to invert a near - identity series .",
    "then the reduced hamiltonian in the new coordinate writes @xmath672 ^ 2      \\,.\\ ] ] it is a full series in @xmath30 , which corresponds to the hamiltonian representation .",
    "this is a constructive procedure showing that when the symplectic representation exists , then the hamiltonian representation exists and is easily obtained .",
    "+ now , what is actually needed is to go in the reverse direction , since the derivation of the guiding - center reduction shows that the hamiltonian representation is natural and guaranteed to exist , whereas the symplectic is suspected of having existence conditions .",
    "it turns out that the procedure in the reverse direction can break down .",
    "start from the reduced lagrangian written in hamiltonian representation : @xmath673 then , redefine the reduced parallel momentum so as to absorb all the higher - order terms @xmath674 in the term with @xmath665 : p_^2 : = p_^2 + 2 _",
    "[ transformhamilttosymplect ] with this coordinate , the hamiltonian part of the lagrangian is fully reduced : @xmath675 to obtain the reduced symplectic lagrangian with this coordinate , one just inverts the near - identity transformation ( [ transformhamilttosymplect ] ) by writing it as : p_ : = = p _ [ seriesinversesingular ] , and then by expanding the term @xmath676 .",
    "this assumes that the ratio @xmath677 is small .",
    "the point is that this condition is not guaranteed a priori , even if the series is near - identity .    indeed , the derivations here are formal .",
    "`` near - identity '' has only a dimensional meaning .",
    "it means that the ratio between the first and zeroth - order term is of order @xmath678 , but only in dimension , its value might not to be small if it is multiplied by a large dimensionless factor such as @xmath679 , as in ( [ seriesinversesingular ] ) .",
    "thus , a division by @xmath665 can cause a singularity .",
    "when going from the symplectic to the hamiltonian representation , no such a division was needed , since the series inversion ( [ seriesinverseregular ] ) just consisted in composing series . on the contrary ,",
    "when starting from the hamiltonian representation , the series inversion ( [ seriesinversesingular ] ) involves a division by @xmath680 .",
    "this causes a singularity if @xmath523 contains a term of order @xmath147 or @xmath0 in @xmath665 .",
    "it is interesting to see that difficulties arise here at @xmath681 ( or equally at @xmath452 ) , which is precisely where they appeared in the guiding - center reduction in the previous section .",
    "this suggests that singularities in @xmath452 are indeed a difficulty for the symplectic representation .",
    "accordingly , at each order , it can be used only when the absence of singularity in ( [ choicehn=0 ] ) is verified .",
    "the intrinsic formulation of the guiding - center reduction was motivated by questions about the traditional gyro - angle variable @xmath129 .",
    "the derivation with the coordinate @xmath2 shows that it does succeed in shedding light on those questions .",
    "first , the traditional coordinate was a detour . in all guiding - center works",
    ", the variable @xmath129 never appears in itself ( except in its own definition and subsequent relations ) ; for instance , it does not appear explicitly in one of the components of @xmath91 or @xmath107 , which all depend on @xmath129 only through the corresponding physical quantity @xmath2 ( or @xmath20 ) ; even the gyro - angle component of the generator @xmath682 verifies this statement .",
    "the detour is not given by the physics , since it imposes to fix arbitrarily a gauge @xmath37 , which is not related to the physics of the problem .",
    "the role of the intrinsic approach was to avoid this detour , and it achieves its goal since it obtains the full guiding - center results without introducing any gauge and by working purely with @xmath2 .    from a mathematical point of view also ,",
    "the use of the variable @xmath129 was not completely satisfactory , because the gyro - angle corresponds to a circle bundle @xcite .",
    "the traditional coordinate @xmath129 makes this structure somehow disappear , because the manifold trivially becomes @xmath683 .",
    "it is why the variable @xmath129 does not have a global existence in a general magnetic geometry @xcite . on the contrary , when using the physical variable @xmath2 , the circle bundle naturally arises : as @xmath2 is defined on a space - dependent circle , spatial displacements imply a variation of @xmath2 , so that a covariant derivative is involved , which encodes the circle - bundle geometry for the gyro - angle @xcite and does not imply some restricted class of circle bundle .",
    "a more detailed study of the coordinate system is outside the scope of the present paper , and will be reported in @xcite . + in some way , the relevance of this coordinate is obvious , since it just results from keeping the initial coordinate , in which all the circle - bundle picture was included . from this point of view , performing the derivation with this variable is a way to see how it globally agrees with the physics and the mathematics of the problem , and to make intrinsic definitions arise naturally for all the quantities involved in the process .",
    "indeed , the previous section shows that the reduction follows the same procedure with the vectorial constrained coordinate @xmath2 as with the scalar coordinate @xmath129 , but that there are slight changes in the quantities used .",
    "the gauge vector @xmath53 came as naturally replaced by the connection @xmath58 for the covariant derivative .",
    "the generator of larmor gyrations @xmath219 came with an intrinsic definition @xmath218 .",
    "the basic @xmath0-form for the gyro - angle @xmath1 appeared as replaced by a non - closed @xmath0-form @xmath194 , which agrees with the fact that @xmath129 considers the circle bundle trivial , whereas it should not .",
    "this implied to use more intrinsic definitions for the operations used , such as ( [ extderivgene ] ) and ( [ extderivpractical ] ) for exterior derivatives . also , this implied to be careful on how the basis of @xmath0-forms and of vector fields are chosen , but the natural ones were found to agree with each other .",
    "thus , the formalism with @xmath2 is slightly more involved , but it perfectly fits both with the physics and the mathematics of the problem , which correspond to a non - trivial circle bundle . + from a formal point of view , the results with the physical variable @xmath2 mainly correspond to replacing the gauge vector @xmath53 by the connection term @xmath58 .",
    "thus , they include the standard gauge - dependent results as a special case , but they are more general : in the usual approach @xmath684 depends only on the position and can not be chosen freely ( e.g. @xmath685 is not possible @xcite ) ; here , @xmath54 can be any function of the position and momentum .",
    "especially , the physical definition of @xmath2 corresponds to the function @xmath686 , which depends also on the momentum and preserves the polynomiality in @xmath293 .",
    "+ other gauge - dependent quantities are interesting to consider . in previous works ,",
    "the coordinate transformation @xmath687 was gauge dependent ( see for instance equation ( 30c ) in @xcite , or in @xcite the solution for the generator @xmath688 below equation ( 5.45 ) ) , as well as the definition of the coordinate @xmath129 , and also the gradient @xmath689 .",
    "it is why the gauge vector @xmath53 was involved in some of the resulting formulae , e.g. the poisson bracket , in such a way as to make all the physical or geometrical ( intrinsic ) quantities gauge - independent .",
    "for instance , in the poisson bracket , gradients appear only in the combination @xmath690 @xcite .",
    "it would be interesting to interpret it as the gradient corresponding to a special gauge , because it would remove the appearance of the gauge vector in all the derivation , and would simplify computations .",
    "the issue is that it is not possible because it would correspond to fix the gauge in such a way that @xmath691 , which is not possible even locally @xcite .    in the gauge - independent approach ,",
    "all the coordinates , including the gyro - angle @xmath2 , are gauge - independent , as well as the transformation @xmath692 : at first order , it is not transformed by @xmath693 , because the covariant derivative must be taken into account , which means that it is given by @xmath694 .",
    "this last quantity is indeed independent of the connection vector @xmath695 , as can be verified in ( [ solg1th ] ) . in the same way , at higher order ,",
    "all the transformed coordinates @xmath696 will be independent of @xmath58 , where @xmath697 are physical coordinates .",
    "gradients are also involved in combinations involving @xmath58 ( see eq .",
    "( [ poissbrackred ] ) , for instance ) .",
    "this is no surprise , since the connection on the fibre bundle involves some arbitrariness , but the combinations can always be written @xmath698 , which is connection - independent .",
    "in addition , it can be interpreted as the covariant derivative associated with the trivial connection @xmath699 .",
    "thus , when working with the coordinate @xmath2 , this choice can be used to simplify computations and to make them connection - independent .",
    "the derivation procedure confirms the respective interests of lie transforming the velocity vector field and the lagrangian @xmath0-form .    as with concerns the minimal requirements for the guiding - center transformation , working on the equation of motion is much more efficient , since it systematically obtains the fluctuating part of the reduced motion just by inverting the operator @xmath219 .",
    "the procedure with the lagrangian is much more involved , as can be seen in previous sections , especially because the order mixing makes the scheme more elaborated and because the algorithmic stage begins only at higher order : the induction matrix mixes up the orders , changes at each order for @xmath700 , and involves differential operators in some coefficients .",
    "it is why in this paper , as in previous works , only a part of @xmath253 is explicitly computed , whereas the work @xcite directly obtained the full second - order generator @xmath253 .",
    "in addition , the minimal guiding - center reduction can hardly be obtained by working on the lagrangian , because going from the lagrangian to the motion mixes the components up . to guarantee an averaged slow reduced motion for the four coordinates @xmath701 ,",
    "one would need to average all of the seven components of the lagrangian , which is not a minimal transformation . + as with concerns the additional requirements for the slow dynamics , working on the equation of motion is not efficient , because the equations to be solved are secular differential equations that are not simple to deal with @xcite .",
    "working on the lagrangian is more efficient , because it essentially consists in algebraic equations , which deals the same way with gyro - averages as with gyro - fluctuations .",
    "this makes it easy to identify good choices for the averaged transformation generator @xmath702 in order to obtain a reduced lagrangian as strongly reduced as possible .",
    "thus , it provides a maximal guiding - center reduction almost as simply as the minimal one .",
    "also , working on the lagrangian @xmath0-form makes it easy to impose requirements on the reduced hamiltonian structure , for instance to obtain a quarter - canonical structure for the coordinates @xmath141 , which both provides a constant of motion @xmath127 and a hamiltonian sub - dynamics for the @xmath139-dimensional reduced motion @xmath703 .",
    "the full guiding - center reduction can be performed to arbitrary order in the larmor - radius expansion by lie transforming the lagrangian @xmath0-form while keeping physical gyro - gauge - independent variables as coordinates , following the same procedure as when working with the standard gauge - dependent gyro - angle .    for higher orders ,",
    "the procedure was shown to be completely algorithmic .",
    "the pivotal role is played by the inverse of the lowest - order lagrange matrix @xmath359 , together with a differential equation for the function @xmath108 . an extended matrix was defined and used to explicitly solve the induction equation to arbitrary order in the larmor radius .",
    "+ the results exactly agree with previous works , but they were obtained without introducing any gyro - gauge , and working purely with the physical coordinate @xmath2 as the gyro - angle coordinate .",
    "in addition , the choice of the cotangent of the pitch - angle as a coordinate for the parallel velocity made the results purely polynomial in the coordinates and monomial in @xmath628 and @xmath168 .",
    "+ compared to the method by lie transforming the equations of motion , the process is much more elaborated , especially because of the order mixing , but it easily obtains a much stronger result .",
    "it does not rely on differential equations for the reduced motion , but on algebraic equations for the reduced lagrangian .",
    "a quarter - canonical reduced hamiltonian structure provides a constant of motion @xmath127 and a hamiltonian sub - dynamics for the @xmath139-dimensional slow reduced motion @xmath704 . in addition , the procedure makes the reduced dynamics trivial not only in the gyro - fluctuating components of the lagrangian , but also in six of the averaged components out of seven .    as a result ,",
    "all but one of the components of the reduced lagrangian @xmath0-form are put to zero for all orders higher than two .",
    "only one of them can not be made exact , and is given by a whole series .",
    "the two canonical choices are recovered : either to enclose the series into the hamiltonian ( hamiltonian representation ) , then the reduced poisson bracket is exact , or to enclose the series into the spatial component of the lagrangian parallel to the magnetic field ( symplectic representation ) , then the hamiltonian is exact and the uncertainty of the reduced motion is traduced by five coefficients , and especially a kind of reduced magnetic field @xmath580 .",
    "the hamiltonian representation appeared as naturally induced by the reduction process , whereas the symplectic representation is subjected to a condition at each order , to avoid a singularity in @xmath452 , i.e. at the bounce points of particle trajectories .",
    "these representations make the reduction maximal because for a general magnetic field , the procedure can not get a stronger reduction for which even the last component of the lagrangian would be zero .",
    "the obstruction originates from the special role of the magnetic moment ; in the hamiltonian representation , this can be viewed because the magnetic - moment component of the transformation generator can remove only the fluctuating part of the reduced hamiltonian function , since the averaged part is imposed by the requirement of adiabatic invariance .",
    "+ the use of gauge - independent coordinates had little effect on the reduction procedure .",
    "all the ingredients of the standard reduction with gauge - dependent coordinates were found to be present , but they naturally arose with an intrinsic definition or they were replaced by a different intrinsic object playing a similar role .",
    "it was observed to fit in with both the physics and the mathematics of the system , by restoring the general circle - bundle framework , which practically disappeared with the coordinate @xmath129 , and by making the coordinates directly induced by the physical state of the system .",
    "for instance , the gauge removal introduced a vectorial quantity @xmath2 for the gyro - angle coordinate .",
    "this caused the coordinate system to be constrained and implied a connection for the covariant derivative on a space - dependent circle , which is directly linked to the circle - bundle structure underlying in the gyro - angle coordinate and which replaced the gauge vector of the gauge - dependent approach .",
    "the closed @xmath0-form @xmath1 was replaced by a non - closed @xmath0-form @xmath194 , which is related to the non - triviality of the circle bundle for a general magnetic geometry .    in previous works relying on the coordinate @xmath129 , the gauge - independence of the physical results implied that gradients were systematically involved in special expressions , which were not related to derivative operators because no gauge fixing were suited to them .",
    "these expressions were found to be related to covariant derivatives corresponding to suitable connections .",
    "+ unlike the gauge fixing for the coordinate @xmath129 , the connection fixing for the coordinate @xmath2 depends not only on the position , but on the momentum as well .",
    "this is all the more convenient as the physical definition of @xmath2 and its associated connection depend on both the position and the momentum . in addition",
    ", this removes one of the assumptions causing the presence of anholonomy in the gyro - angle motion .",
    "so , the intrinsic gyro - angle coordinate @xmath2 is a way to tackle some of the questions involved in the guiding - center anholonomy and gauge- ( or connection- ) arbitrariness .",
    "these questions are outside the scope of this paper and will be reported elsewhere @xcite .",
    "+ in this paper , we focused on the formal derivation of perturbation series , as is usual in guiding - center works , and as is the standard first step in perturbation theory @xcite",
    ". a next step will be to relate these formal expansions with asymptotic series , in a similar way as what was done in @xcite for kruskal s work , and what is beginning being done about littlejohn s works @xcite .",
    "also , as usual in perturbation theory , convergence of the guiding - center series is an interesting question to investigate , probably with methods of accelerated convergence @xcite . in these attempts ,",
    "the structures of the expansion series , such as the polynomiality induced by the cotangent of the pitch - angle , are expected to play a role .",
    "we acknowledge financial support from the agence nationale de la recherche ( anr gypsi ) .",
    "this work was also supported by the european community under the contract of association between euratom , cea , and the french research federation for fusion study .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission .",
    "the authors also acknowledge fruitful discussions with alain brizard , phil morrison , mathieu lutz and with the quipe de dynamique nonlinaire of the centre de physique thorique of marseille .",
    "in this appendix , we introduce the mechanism at work when lie transforming the lagrangian @xmath0-form . indeed , the basic ideas of the derivation are very elementary , but they are hidden by the details of the procedure , which are rather involved because of some order mixing and other subtleties between algebraic and differential integrability conditions .",
    "in addition , practical computations in the case of the guiding - center are somehow intricate .",
    "all the same , the method is very efficient and has quite a wider domain of application than just the guiding - center reduction .",
    "so , it seems useful to give a general overview of the method for people not familiar with it .",
    "\\a ) the goal is to solve equations ( [ reduclagr ] ) for the unknowns @xmath88 and @xmath108 , with the requirements ( [ requirprior1 ] ) , ( [ requirprior3 ] ) and ( [ requirprior2 ] ) identified above .",
    "ideally , the maximal reduction sets @xmath517 for all higher orders @xmath81 , as a result of ( [ requirprior3 ] ) .",
    "the solution is built order by order in the larmor radius .",
    "each order implies to solve the equation @xmath705 where @xmath486 is a shorthand for all other terms , that do not contain the highest - order generator @xmath488 .",
    "the very basic idea of the reduction is that @xmath488 is involved only through a matrix product .",
    "so , at any order , the solution is just given by a matrix inversion _",
    "n+1 = ( _ -1)^-1 , [ basicidea ] provided @xmath228 is invertible ; then @xmath94 can be chosen zero , and @xmath108 is not useful and can also be set to zero .",
    "this idea of matrix inverse is the key ingredient of the underlying mechanism , even if the corresponding basic picture is not true at the lowest orders , and at higher orders , it is slightly complicated by some order mixing and integrability conditions , especially for @xmath108 .",
    "+ b ) as a matter of fact , the matrix @xmath228 is usually not invertible , since it corresponds to the fast part of the dynamics , here the larmor gyration , which does not concern all the phase - space coordinates .",
    "+ at zeroth order , under the requirement @xmath517 , equation ( [ reduclagr ] ) writes @xmath706 it has a solution only if the right - hand side @xmath707 is in the range of the matrix @xmath228 ( solvability condition ) ; this is a necessary condition for the corresponding reduction to exist .",
    "usually , it is not verified for so strong a requirement as @xmath708 , and the reduced lagrangian @xmath227 has to be used as a softening parameter",
    ". then equation ( [ reduclagr ] ) writes _",
    "1_-1 = _ 0-_0 - ds_0 .",
    "[ equag1matrix ]    one has to check that , with the freedoms @xmath226 and @xmath227 , the solvability condition can be satisfied at least for the minimal requirement ( [ requirprior1 ] ) and if possible for the intermediate requirement ( [ requirprior2 ] ) ; then , the reduction is possible , and the maximal requirement ( [ requirprior3 ] ) can be considered by trying to remain as close as possible to the condition @xmath708 .    at that point ,",
    "the solution exists , but it is not unique ; it is defined to within an element of the kernel of @xmath228 .",
    "the choice of this element may be free at this stage of the reduction , but care must be taken that it may be constrained by the solvability conditions at the following order .",
    "+ at the next order @xmath259 , equation ( [ reduclagr ] ) writes _ 2_-1 + ( _ 0+_0 ) = _",
    "1- ds_1 . [ eqforx2 ]",
    "now , the pivotal matrix @xmath709 to be inverted is the set of @xmath228 and @xmath710 , acting on the set of unknown components of @xmath263 .",
    "its rank is greater than ( or equal to ) the rank of @xmath228 .",
    "care must be taken that some of the coordinates of @xmath225 are already determined .",
    "this introduces some order mixing , where some components of @xmath88 are determined at order @xmath711 , others are computed at order @xmath712 at the same time as some of the components of @xmath488 .",
    "notice that @xmath709 can not be invertible on the unknown components of @xmath253 , because of the non - trivial kernel of @xmath228 . in the same way",
    "as at zeroth order , this kernel has to be excluded when studying the invertibility of @xmath709 , because it will be involved only at the following order .    then , if the pivotal matrix @xmath709 is invertible for the ideal requirement @xmath713 , then the solution exists and is unique",
    "otherwise , there is again both a solvability condition and a non - uniqueness of the solution .",
    "more precisely , the solvability condition means that there is a solution only if the right - hand side is in the range of the matrix to be inverted , and that in order to fulfil this condition , the reduced lagrangian @xmath714 may have be chosen non - zero , but having as many null components as possible .",
    "the non - uniqueness means that the solution is determined only to within an element of the kernel of the pivotal matrix @xmath709 .",
    "the choice of this element may be free , but care must be taken that it may be constrained by the solvability condition at the following order .",
    "+ at the next orders , the same process goes on .",
    "the pivotal matrix @xmath715 evolves at each order and its rank increases to determine more and more of the unknowns . at high orders",
    ", it becomes of constant rank , and actually it becomes the same at each order .",
    "the critical value of @xmath81 at which this occurs will be denoted by [ definitnc]@xmath366 , and the corresponding pivotal matrix will be denoted by [ definitminfty]@xmath258 .",
    "so , for @xmath716 , the pivotal matrix verifies @xmath717 , whereas for @xmath718 , it verifies @xmath719 .",
    "this can be explained as follows : equation ( [ reduclagralg ] ) generically ( i.e. at high orders ) writes @xmath720       \\ga_{-1 } \\ncr      +      & \\left [       ( \\bfmg_n\\cdott d ) + ( \\bfmg_{n-1}\\cdott d ) ( \\bfmg_1\\cdott d )      + ... + \\tfrac{(\\bfmg_1\\cdott d)^n}{n ! }      \\right ]       \\ga_{0 }      + ds_n      \\ , .      \\label{redlagrequageneric}\\end{aligned}\\ ] ] in this analysis , low orders are excluded because there would be some additional coefficients coming from the exponential series : for instance for @xmath259 , the term @xmath721 has a factor @xmath722 and is confounded with the last term @xmath723 .    denoting @xmath724 by @xmath725 , and grouping together the highest - order lie derivatives , which contain the unknowns ( which are some of the components of @xmath726 )",
    ", the previous equation becomes @xmath727      \\label{orderforinvertible }      \\\\      & + ... \\ncr      & + \\sfmg_1       \\left [      \\tfrac{(\\sfmg_1)^{n}}{n+1 ! } \\ga_{-1 }      + \\tfrac{(\\sfmg_1)^{n-1}}{n ! } \\ga_{0 }      \\right ]      + ds_n      \\ , .",
    "\\notag\\end{aligned}\\ ] ] using ( [ reduclagr ] ) for the lowest - orders reduced lagrangian @xmath728 , that are already known , the previous formula can be rewritten @xmath729      + ds_n \\ncr      & =       \\bfmg_{n+1}\\cdott\\overline\\om_{-1 }      + \\bfmg_{n}\\cdott\\overline\\om_{0 }      + ...      + d s_n      + \\sfmr_n      \\ , , \\label{matrpivot}\\end{aligned}\\ ] ] where @xmath486 indicates all other terms , that are already known , since they do not involve @xmath726 .",
    "equation ( [ matrpivot ] ) shows that the pivotal matrix @xmath715 is given by the set of matrices @xmath730 , @xmath204 , etc .",
    ", acting on the set of unknown components of @xmath726 .",
    "the matrix @xmath715 is the same at any ( high ) order .",
    "it is exactly given by the reduced lagrange matrix at lowest orders .",
    "as a consequence , the pivotal matrix @xmath258 for all high orders is identified as soon as the set of @xmath731 is observed to be invertible on the set of unknown components of @xmath726 , i.e. as soon as @xmath732 becomes invertible .",
    "we will call [ definitnb]@xmath365 the order such that @xmath362 is invertible , whereas @xmath733 is not .    at that point",
    ", the basic picture of a ) has become a simple picture b ) , which includes two stages . at low orders it consists in dealing with non invertible pivotal matrices changing at each order , and in choosing @xmath94 such that it both fulfils",
    "the requirement and leads to an interesting invertible matrix @xmath362 . then at high orders , the induction becomes just a matrix inversion @xmath561 , as in the initial basic picture a ) .",
    "+ c ) the simple picture b ) has to be refined . between these two stages",
    ", an intermediate stage takes place , since usually @xmath734 . for @xmath735 ,",
    "the higher - orders pivotal matrix is already known but not yet efficient .",
    "the reason is that formulae ( [ redlagrequageneric])-([matrpivot ] ) hold only for orders that are high enough , because of the coefficients generated by expanding the exponentials .",
    "if the factors involving @xmath736 have some coefficients non unity , then formula ( [ matrpivot ] ) does not hold , which spoils the conclusion .",
    "but this concerns only low orders .",
    "formula ( [ orderforinvertible ] ) shows that the coefficients will be unity as soon as @xmath737 , which means that @xmath738 . + as an example , consider @xmath739 for @xmath214 . when computing the next order @xmath740 , then @xmath227 is already known , but it is not yet efficient : in formula ( [ matrpivot ] ) @xmath741 the operator to be inverted is not just the set of @xmath742 because of the factor @xmath722 in the first line , which comes because the generator @xmath225 outside the parenthesis has the same order as the generator @xmath225 inside the parenthesis .",
    "for all higher orders , this will not happen , as is illustrated by the next order @xmath743 where @xmath521 is used for `` other terms '' , in order to avoid writing uninteresting terms .",
    "+ d ) the order mixing can also slightly complicate the picture of c ) , by spoiling the linear algebraic framework , mainly at order @xmath259 .",
    "indeed , the first equation to be solved for @xmath253 is ( [ eqforx2 ] ) .",
    "however , if some of the components of @xmath225 are still not determined at that point ( this is fairly general as @xmath228 is usually not invertible ) , then they can be involved in a differential equation .",
    "indeed , @xmath227 can be undetermined at that point , and equation ( [ eqforx2 ] ) must be let under its initial form ( [ reduclagr ] ) @xmath744 which is now a differential equation for @xmath225 , and may even be non - linear in the unknown components of @xmath225 .",
    "this can make the scheme much more complicated : even solvability conditions may be difficult to identify .",
    "+ e ) finally , one last point has to be taken into account as well and still makes the scheme more elaborated than the picture d ) above .",
    "the pivotal matrix @xmath715 determines the unknown components of the generator @xmath745 , but this can generate non - zero time - component @xmath746 for the generator .    for a time - independent transformation , the requirement @xmath747 , reduces the dimension of the effective generator @xmath88 .",
    "then the pivotal matrix can be inverted only if some integrability conditions are fulfilled .",
    "another way of saying it is that @xmath94 has seven components ( seven requirements ) whereas @xmath88 has only six freedoms .",
    "the additional freedom comes from the gauge function @xmath108 .    actually , the presence of this integrability condition for the pivotal matrix @xmath258 is completely general and comes because @xmath258 is antisymmetric .",
    "it is not invertible on the @xmath62-dimensional space @xmath422 , and can be invertible only on a sub - space , e.g. on the @xmath67-dimensional phase - space @xmath748 . for a symplectic hamiltonian system ,",
    "the high - orders pivotal matrix @xmath258 is indeed invertible when restricted to the phase - space , since the lagrange @xmath34-form @xmath69 is invertible , and so is @xmath749 .",
    "so , the gauge function @xmath108 is not determined by the algebraic matrix inversion , but by the solvability condition for the matrix inversion .",
    "furthermore , it appears in a differential equation .",
    "existence of solution for this differential equation can involve other integrability conditions .",
    "for instance , in an equation such as @xmath750 inverting @xmath751 implies the function @xmath752 to have no gyro - average .    as a result , both the algebraic and the differential integrability conditions must be played with so as to make @xmath517 .",
    "if it is not possible , one has to choose a non - zero reduced lagrangian @xmath753 .",
    "this means playing with the requirements also , and releasing them slightly , so as to make the integrability conditions fulfilled and at the same time to keep @xmath107 as strongly reduced as possible .",
    "+ all these features do not spoil the algorithmic character of the reduction for high orders , because the differential scheme is very simple ( the operators are just @xmath754 ) and in addition , at all @xmath716 , the algebraic scheme for @xmath281 is fixed , which makes it possible to conclude about the differential scheme for @xmath108 so as to make the resulting reduction maximal .    at the end",
    ", the induction relations can be written in matrix form provided some coefficients of the matrix are differential operators .",
    "by such a redefinition of the matrix @xmath258 , the induction relation for high orders @xmath716 just relies on a matrix inverse @xmath755 .",
    "then , the basic picture of formula ( [ basicidea ] ) becomes efficient : equations ( [ reduclagr ] ) are solved at arbitrary order through a formula completely analogous to ( [ basicidea ] ) , even if the framework is much more elaborated .",
    "we want to stress this fact because the order mixing and the presence of integral operators may hide the triviality of the induction mechanism .",
    "the previous subsection shows that the reduction is performed in three stages .",
    "the first stage corresponds to the first few orders @xmath756 .",
    "the work consists in verifying that the freedoms can be used both to make the solvability conditions satisfied and to get an interesting invertible matrix @xmath258 . at the end @xmath757 ,",
    "the invertible high - order pivotal matrix @xmath258 becomes identified , and the first stage is ended .",
    "the second stage corresponds to a transition stage .",
    "the pivotal matrix for high order is identified , but it is still not efficient at that order .",
    "the goal is only to check that the solvability conditions can be satisfied at these intermediate orders .",
    "the third stage begins at order @xmath758 , i.e. as soon as the matrix to be inverted becomes @xmath258 . from that order on ,",
    "it is sure that the reduction can be performed to any order in the larmor radius .",
    "as the matrix is now invertible , the solution exists and is unique to each order , and the process becomes fully algorithmic . + in order to get a formula analogous to ( [ basicidea ] ) , the pivotal matrix must be extended to include the gauge function @xmath108 , and some coefficients of the inverted matrix @xmath561 are then integral operators .",
    "in addition , in order to deal with the order mixing , some intermediate quantities must be introduced to isolate the components of @xmath759 that are already known from the ones that are not identified yet .",
    "+ for example , if the pivotal matrix @xmath258 involves only @xmath730 and @xmath505 .",
    "then , the equation ( [ reduclagr ] ) or ( [ matrpivot ] ) writes _",
    "n= _ n+1_-1 + _ n_0 + d s_n + _ n , [ equhighord ] where @xmath486 indicates all terms of ( [ reduclagr ] ) , that do not depend on the unknowns , which are the gauge function @xmath108 and some components of @xmath760 .",
    "these last quantities can be grouped into one single vector _",
    "n:= ( _ n+1,_n , s_n ) .",
    "[ defvectbfgapp ] the pivotal matrix @xmath715 is then extended to act on all @xmath484 ( including the gauge function ) in ( [ equhighord ] ) and is defined by @xmath761 as announced , some of its coefficients ( the ones acting on the component @xmath108 ) are differential operators . with these conventions , equation ( [ equhighord ] )",
    "n= _ n_n + _ n .    now , some of the components of @xmath760 are already identified at that order .",
    "let us denote them by the index @xmath183 , and the remaining components of @xmath762 , which are not identified are denoted by the index @xmath763 : @xmath764 with @xmath765 fully identified and all terms of @xmath766 fully unknown .",
    "the lagrangian writes _",
    "n= ( _ n)_a(_n)_a + ( _ n)_(_n ) _",
    "+ _ n , [ decomposbfgappen ] with obvious definitions for the linear operators @xmath767 and @xmath768 . by assumption ,",
    "the quantities @xmath486 and @xmath769 are known ; in addition , @xmath770 is known and invertible . as a consequence ,",
    "the induction relation writes ( _ n ) _",
    "[ solutexpl ] it is explicit and makes the basic picture ( [ basicidea ] ) apply to all orders @xmath716 .",
    "some coefficients of @xmath561 are integral operators , since in the inverse matrix @xmath258 some coefficients are differential operators .",
    "a few comments are in place .",
    "first , some components of @xmath488 remain non - identified after the order @xmath81 ; they must be excluded from @xmath766 to get an invertible matrix , because they are elements of the kernel of @xmath228 and will be determined at the next order ; this is well illustrated by ( [ defvectbfgtext ] ) and ( [ defvectbfginftytext])-([defvectbfgalpha ] ) .",
    "second , the components @xmath765 can be extracted from @xmath484 and its term @xmath769 can be grouped with @xmath486 ( see formula ( [ defsfmrprime ] ) ) , which plays the same role .",
    "last , the reduced lagrangian @xmath94 is in principle taken to be zero , but it was kept free because integrability conditions for @xmath108 can make it necessary to choose some of its components non - zero ; then , it can be included in the vector @xmath484 , as is done in ( [ defvectbfgtext ] ) and ( [ defvectbfginftytext])-([defvectbfgalpha ] ) .",
    "+ the final algorithm to be iterated for the @xmath81-th - order term is trivial : in formula ( [ solutexpl ] ) , replace the lowest orders terms by their expression , already known , then compute the lie derivatives involved in the term @xmath486 , and last apply the matrix product with @xmath755 .",
    "the mechanism involves just two kinds of operations , derivatives and a matrix product , which can be easily implemented to arbitrary order using computer - assisted formal calculus .",
    "+ the basic idea shown in ( [ basicidea ] ) and ( [ solutexpl ] ) explains why lie transforming the lagrangian @xmath0-form has the advantage of algebraic equations , which makes it easy to reduce also the averaged part of the reduced motion , and thus to get non - minimal guiding - center reductions .",
    "indeed , computations for the non - minimal requirements are treated the same way as for the minimal ones , the only difference concerns the priority : if all requirements can not be satisfied , then the order of priority may impose the requirements to be preferred and the ones to be released .",
    "this is an essential advantage of lie transforming the lagrangian .",
    "but the overall process is much more involved than the method relying on a lie transform of the equations of motion .",
    "this last has the essential advantage of relying on just a gyro - integral , which makes it much more efficient to work on the fluctuating part of the reduced dynamics and to perform the minimal guiding - center reduction , as is clear in @xcite .    in both cases",
    ", the reduction relies on explicit induction relations , but when working with the lagrangian , the algorithmic stage ( third stage introduced above ) is efficient only for higher orders . for lowest orders , the reduction is not systematic at all , the choices are crucial to make the reduction work or not , but they must be guessed rather than derived .",
    "in addition , many solvability conditions appear in the process , and there is no a - priori guarantee that they can be satisfied . + in the case of the guiding - center reduction , good choices appear rather naturally , solvability conditions come as easily satisfied , and the reduction can be considered as rather straightforward , but two specificities must be taken into account .    indeed , as expected , at each order , the fluctuating part of @xmath88 is imposed by the minimal requirement ( [ requirprior1 ] ) , which means to put to zero the gyro - fluctuating part of the lagrangian ; and the averaged part is imposed by the other requirements ( [ requirprior3 ] ) and ( [ requirprior2 ] ) , which mean to put to zero the averaged part of the lagrangian as well ( except that @xmath288 ) .",
    "however , one of the components of @xmath281 that remains not identified is already present in equation ( [ equhighord ] ) : @xmath771 remains as a parameter in the right - hand side of ( [ solutexpl ] ) .",
    "furthermore , the integrability conditions on @xmath108 can not be fully satisfied , one of the optional requirements ( [ requirprior3 ] ) must be dropped ; so , the average component @xmath595 ( or alternatively @xmath772 ) is not zero but used to make the integrability condition satisfied .",
    "accordingly , one of the freedoms ( the average gauge function @xmath773 ) remains undetermined for the maximal reduction . to determine it , a prescription must be added . for the simplest maximal reduction",
    ", it is put to zero .",
    "all these features will suggest to define and decompose the vector @xmath484 in a different way as in ( [ defvectbfgapp ] ) and ( [ decomposbfgappen ] ) , by including in this vector only the unknowns that are involved at that order ( see formula ( [ defvectbfgtext ] ) ) , and by distinguishing between the unknowns that will be identified and the ones that will remain parameters ( see formulae ( [ defvectbfginftytext])-([defvectbfgalpha ] ) ) ."
  ],
  "abstract_text": [
    "<S> 3ex * abstract : * the guiding - center reduction is studied using gyro - gauge - independent coordinates . </S>",
    "<S> the lagrangian @xmath0-form of charged particle dynamics is lie transformed without introducing a gyro - gauge , but using directly the unit vector of the component of the velocity perpendicular to the magnetic field as the coordinate corresponding to larmor gyration . </S>",
    "<S> the reduction is shown to provide a maximal reduction for the lagrangian and to work to all orders in the larmor radius , following exactly the same procedure as when working with the standard gauge - dependent coordinate .    </S>",
    "<S> the gauge - dependence is removed from the coordinate system by using a constrained variable for the gyro - angle . </S>",
    "<S> the closed @xmath0-form @xmath1 is replaced by a more general non - closed @xmath0-form , which is equal to @xmath1 in the gauge - dependent case . </S>",
    "<S> the gauge vector is replaced by a more general connection in the definition of the gradient , which behaves as a covariant derivative , in perfect agreement with the circle - bundle picture . </S>",
    "<S> this explains some results of previous works , whose gauge - independent expressions did not correspond to a gauge fixing but indeed correspond to a connection fixing .    </S>",
    "<S> in addition , some general results are obtained for the guiding - center reduction . </S>",
    "<S> the expansion is polynomial in the cotangent of the pitch - angle as an effect of the structure of the lagrangian , preserved by lie derivatives . </S>",
    "<S> the induction for the reduction is shown to rely on the inversion of a matrix which is the same for all orders higher than three . </S>",
    "<S> it is inverted and explicit induction relations are obtained to go to arbitrary order in the perturbation expansion . </S>",
    "<S> the hamiltonian and symplectic representations of the guiding - center reduction are recovered , but conditions for the symplectic representation at each order are emphasized .    </S>",
    "<S> _ keywords _ : guiding center , lie transform , lagrangian @xmath0-form , maximal reduction , explicit induction , gauge - independent coordinates , gyro - gauge , connection , covariant derivative , principal circle bundle . </S>"
  ]
}