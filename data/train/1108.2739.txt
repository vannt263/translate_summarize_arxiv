{
  "article_text": [
    "many - body simulation methods , such as diffusion monte carlo ( dmc ) @xcite and auxiliary field quantum monte carlo ( afqmc ) , @xcite are capable of yielding highly accurate results for electronic systems . in extended systems , however , because of the use of periodic boundary conditions ( pbc ) , finite - size ( fs ) errors arise in many - body ( mb ) calculations , which are often larger than the statistical and other systematic errors .",
    "the fs error reflects the spurious interactions of the system , modeled by a finite - size simulation cell ( supercell ) , with its own periodic images .",
    "the long - range nature of the coulomb interaction in electronic systems exacerbates the problem , and makes the fs error more pronounced . to reduce this error",
    ", calculations have to be performed using larger and larger simulation cells , in order to extrapolate the results to the infinite limit of the supercell size .",
    "the computational cost of mb calculations is typically high .",
    "for example , qmc methods scale with system size as @xmath0-@xmath1 , with large prefactors .",
    "other mb methods typically have significantly worse scaling .",
    "thus convergence of mb calculations with supercell size is difficult to achieve , and accurate extrapolation is often too costly .",
    "@xcite fs correction schemes that can accelerate this convergence are therefore highly desirable .",
    "the behavior of the fs error in a mb calculation is different from that in a standard density - functional theory ( dft ) calculation @xcite ( or other independent - electron calculations ) , as we further discuss in sec .",
    "[ sec : prel ] .",
    "the mb fs error consists of a part that is essentially parallel with the corresponding fs error in a dft calculation of the same supercell .",
    "this part , which will be termed the one - body ( 1b ) fs error , is easier to correct . the residual error , which will be termed the two - body ( 2b ) fs error , is due to the approximate treatment of electron interactions in the extended system by the electrons in the simulation cell plus their images .",
    "the 1b and 2b errors are largely separable ( see sec .  [",
    "sec : prel ] ) .",
    "the correction of the 2b errors is the focus of fs correction methods .",
    "it has been shown @xcite that using a modified periodic coulomb potential instead of the standard ewald form of the electron - electron repulsion can significantly reduce fs errors in the calculated ground - state energy and accelerate convergence .",
    "more recently , chiesa _ et al . _",
    "@xcite introduced a 2b fs correction based on the random phase approximation analysis of the momentum distribution and 2b structure factor , which achieves similar results .",
    "both of these approaches are internal correction methods .",
    "the former requires modification of the form of the electron - electron coulomb interaction , and the latter requires calculation of the structure factor in the mb calculation .",
    "the method of kwee , zhang , and krakauer ( kzk ) is an external fs correction approach .",
    "@xcite the idea is to have independent - electron calculations which mimic the fs behavior of mb calculations .",
    "kzk developed a fs exchange - correlation ( xc ) functional which describes the effect of electron - electron interaction in the spirit of a local - density approximation ( lda ) in dft and which takes into account the finite size of the simulation cell .",
    "a functional was parametrized for spin - unpolarized systems .",
    "the functional has been included in the software package quantum espresso @xcite and the method is applicable to any mb total energy results @xcite as a simple , post - processing correction .",
    "the fs functional of kzk does not include spin - dependence , however . in this paper",
    "we generalize the method to arbitrarily spin - polarized systems , and parametrize a fs xc functional based on the local spin - density approximation ( lsda ) .",
    "the new functional includes kzk , but will allow fs corrections in systems with spin - polarization or magnetic order , for example in many transition - metal oxide solids . in such systems",
    "the effect of electron correlation is generally stronger , and the need for mb calculations is greater .",
    "the complexity of the systems also means our ability to systematically simulate larger and larger supercells will be more limited .",
    "accurate and simple fs corrections will therefore be very valuable . in the applications we illustrate how the new",
    "fs lsda functional can help accelerate convergence of the mb results in various systems .",
    "the remainder of the paper is organized as follows . in sec .",
    "[ sec : prel ] , we describe the overall formalism of our fs correction and define some notations . in sec .",
    "[ sec : xc ] , we present the fs xc functionals , with the exchange and correlation parts each in a separate subsection , and a summary of the parameter values of the result of our parametrization in the last subsection . in sec .  [",
    "sec : apps ] , several applications are presented to illustrate the fs correction method .",
    "we further discuss several aspects of the method in sec .",
    "[ sec : discuss ] before summarizing in sec .",
    "[ sec : summary ] .",
    "we will consider zero - temperature total energy calculations in a cubic supercell of side length @xmath2 , with @xmath3 atoms in it .",
    "twist boundary conditions @xcite will usually be applied , the many - body generalization of @xmath4-points in independent - electron calculations . the fs error for a given twist @xmath4",
    "is defined as @xmath5 where each @xmath6 denotes _ per atom _ energy , and @xmath7 is the corresponding result at the infinite supercell limit .",
    "the fs error can be separated into 1b and 2b parts , which are also referred to as independent - particle and coulomb fs errors .",
    "@xcite the 1b fs error arises from incomplete @xmath4-point integration , i.e. , a discrete momentum space mesh : @xmath8 where in the first term on the right the sum is over a sufficiently large set of @xmath4-points ( with appropriate weight if necessary ) to reach convergence . below we will also use the notation @xmath9 to denote this term . in a standard dft calculation , because of bloch s theorem , the 1b fs error is the only form of fs error : @xmath10 _ i.e. _ , @xmath11 in dft . in eq .",
    "( [ eq : dft_fserror ] ) , different choices of the simulation cell lead to different requirements on the set @xmath12 over which to sum , but for each choice of @xmath2 , the infinite limit can be achieved with enough @xmath4-points .",
    "the usual approach is to simply integrate over a dense @xmath4-point grid using the primitive cell .",
    "-points : @xmath13 ( blue circle ) , @xmath2 ( red triangle ) , and the baldereschi @xcite mean - value @xmath4-point ( green square ) .",
    "the inset shows the calculated ground - state energy .",
    "the dashed lines are dft - lda results , while the solid lines are corresponding afqmc results .",
    "the supercell sizes are indicated on the horizontal axes.,scaledwidth=43.0% ]    the 2b fs error is the residual beyond the 1b fs error : @xmath14 thus @xmath15 is independent of the @xmath4 twist , _",
    "i.e. _ , it is the fs error aside from @xmath4-point sampling errors .",
    "this is illustrated in fig .",
    "[ fig : si - qmc - dft ] , which shows the total energy difference of bulk silicon between qmc and standard dft lda calculations .",
    "three special @xmath4-points are used : @xmath13 , @xmath2 , and the baldereschi @xcite mean - value @xmath4-point . the 1b fs errors are seen to be rather parallel between the independent - electron and mb calculations .",
    "the energy difference between qmc and dft results , the 2b fs error in qmc , is essentially independent of @xmath4-points , consistent with eq .",
    "( [ eq : def_2b ] ) .",
    "the 1b fs error in the mb calculation can thus be removed by applying a correction @xmath16 from standard dft .",
    "this is frequently done in practice .",
    "( note that sometimes the 1b fs error has a different size dependence compared with that of the total @xmath17 , as for the l - point in fig .",
    "[ fig : si - qmc - dft ] . applying this 1b fs correction would make the fs error _",
    "larger_. @xcite ) a residual 2b fs error remains , however , which decays slowly with supercell size .    to consider the 2b fs error in the framework of dft , specifically lsda , we review how standard lsda implicitly removes the 2b fs effect , leaving only 1b fs error , which can be eliminated using sufficiently dense @xmath4-point grids .",
    "the many - electron hamiltonian in a simulation cell is ( in rydberg atomic units ) : @xmath18 where @xmath19 labels an electron , @xmath20 is the electron position , the ionic potential on @xmath19 can be local or non - local , and the sum runs over all electrons .",
    "we have suppressed the electron spin index , but spin is assumed to be present .",
    "the coulomb interaction @xmath21 between electrons depends on the supercell size @xmath2 ( and its shape ) , due to modification by the pbc , for example , via the ewald method .",
    "@xcite the corresponding lsda , as usually formulated , introduces a fictitious mean - field system of electrons with the same external potential and the same spin configuration , with the single - electron hamiltonian : @xcite @xmath22 where the xc potential depends on the electronic densities for the two spin species , and the hartree term depends on the total density .",
    "the densities @xmath23 are determined self - consistently , with fermi statistics imposed on the occupied orbitals ( eigenfunctions of @xmath24 ) .",
    "the lsda xc functional in eq .",
    "( [ eq : ks ] ) has an @xmath25 in the superscript : @xmath26 is supposed to be the xc functional of the _ infinite _ system .",
    "the key is that using @xmath26 removes any 2b fs effect .",
    "typically @xmath26 is obtained from qmc results on the homogeneous electron gas ( heg ) , extrapolated to infinite size .",
    "@xcite because lsda yields an independent - electron problem , in which the hamiltonian is only dependent on the electronic densities , bloch s theorem can be applied .",
    "the only requirement for size convergence is the convergence of the densities , which are fully defined by the periodicity of the system once the primitive cell is specified .",
    "the extrapolation of fs heg data to the infinite size was important in that it eliminated the size dependence in the xc functional , making the theory consistent at the thermodynamic limit .    to have an lsda theory for the fs supercell",
    ", we must recover the fs dependence of the interaction term , and make it parallel to the mb hamiltonian : @xmath27 where the fs @xmath28 represents the xc effects in the _ finite _ simulation cell in which the mb calculation is carried out .",
    "within dft , the xc energy functional @xmath29 is constructed based on the calculations of the heg , and then applied to realistic system by the lsda approximation .",
    "@xcite below , we examine the electron gas in finite cubic supercells ( of linear size @xmath2 ) to obtain an ansatz for the fs xc energy @xmath30 , from which we can derive the fs xc potential @xmath28 .",
    "a functional will be parametrized as a function of @xmath2 .",
    "with such a functional , lsda calculations can be carried out in the same supercell as the mb calculation .",
    "the difference between the fs lsda and the infinite lsda results ( e.g. , from usual dense @xmath4-point calculations ) , @xmath31 , will provide an estimate of the mb fs error .",
    "the fs corrections used in the remainder of the paper can be summarized as : @xmath32",
    "in this section we discuss the fs xc functional in the heg . we will use @xmath33 to denote the total number of electrons in the supercell of volume @xmath34 , and @xmath35 and @xmath36 for spin-@xmath37 and spin-@xmath38 , respectively . for convenience",
    ", we will refer to the majority spin as @xmath37-spin below , i.e. , assuming @xmath39 .",
    "the density is as usual specified by @xmath40 , the radius of a sphere containing one electron on average , which is related to the charge density by @xmath41 .",
    "the fractional spin polarization parameter @xmath42 is defined as the ratio of spin density and charge density : @xmath43 where @xmath44 ( @xmath45 ) is the electronic density of spin component up ( down ) .",
    "the total charge density is @xmath46=@xmath44+@xmath45 .",
    "the spin unpolarized state corresponds to @xmath47 , while the fully spin polarized state to @xmath48 .",
    "the desired fs xc functional @xmath30 is thus equivalently written as @xmath49 in the heg .",
    "the total xc energy is @xmath50 .",
    "we discuss the exchange and correlation energies separately in sec.s [ subsec : exchange ] and [ subsec : correlation ] and summarize our parametrized functional with numerical parameter values in sec .",
    "[ subsec : xc - parameters ] .",
    "the exact total energy of the heg can be separated into the hf energy , which is the sum of kinetic energy and the exchange energy , and the remainder , which is termed correlation energy .",
    "the kinetic energy is simply given by a sum of the energies of independent electrons filled from the lowest single - particle energy state up to the fermi surface .",
    "the exchange energy from the filled fermi sphere can be calculated analytically , and is of the form @xmath51 .",
    "the asymptotic expression of the correlation energy in the high density region was derived by gell - mann and brueckner , @xcite which is used in combination with dmc results at various densities @xcite to obtain a parametrized fit @xcite of the lsda xc energy",
    ". as mentioned , all of these are at the infinite size limit .    in finite - sized supercells , the hf exchange energy of the heg scales as @xmath52 .",
    "the fs error in the exchange energy per electron , @xmath53 , scales @xcite as @xmath54 , with a coefficient @xmath55 which is only dependent on @xmath33 ( i.e. , the ratio of @xmath56 ) , not on @xmath40 .",
    "the fs exchange energy approaches the infinite size limit from below .",
    "@xmath55 decays smoothly like @xmath57 when averaged over many @xmath4-points .",
    "@xcite thus the first order correction of exchange energy will be of order @xmath58 .",
    "we will include a next - order term in the parametrization , @xmath59 , which follows the same scaling relation .    in a system with two spin components , each component contributes independently to the total exchange energy .",
    "there is no exchange interaction between opposite spins .",
    "thus , for a system of polarization @xmath42 , the exchange energy is given by @xmath60 where @xmath61 is the exchange energy of the unpolarized system with total density given by @xmath40 , and the density for the spin up ( down ) component is given by @xmath62 ( @xmath63 ) .",
    "with this relation , we can obtain the fs exchange energy for an arbitrary spin polarization .",
    "however , the fs exchange energy for spin unpolarized system is discontinuous as given by kzk .",
    "@xcite at low densities , the exchange energy is forced to go to zero rapidly , because in the _ finite _ supercell there will only be less than one electron in each spin component when @xmath40 is larger than some threshold @xmath64 . in this regime , the functional form from scaling , i.e. , @xmath65 , would diverge .",
    "a different functional form is used instead , and the two are joined at @xmath66 by requiring the exchange potential to be continuous , which resulted in a discontinuity in the exchange energy . with this form of the exchange energy , the use of eq .",
    "( [ eq : ex ] ) would lead to multiple discontinuities in a partially polarized system , and an exchange that tends to be too high in the intermediate densities which connect the two density regimes .    instead of the formula in eq .",
    "( [ eq : ex ] ) , we will make an interpolation between spin unpolarized and fully polarized systems .",
    "the interpolation formula @xcite is @xmath67 , \\label{eq : ex - interpolation}\\ ] ] with the function @xmath68 defined as @xmath69 the formula in eq .",
    "( [ eq : ex - interpolation ] ) gives the exchange energy for any polarization by interpolation bwteeen the exchange energies for unpolarized and fully polarized systems .",
    "when @xmath2 is infinite , this formula reduces to the exact relation in eq .",
    "( [ eq : ex ] ) .",
    "the use of this formula also makes the treatment of the exchange consistent with that of the correlation ( see sec .",
    "[ subsec : correlation ] ) , for which there is no analogy of eq .",
    "( [ eq : ex ] ) .",
    "we will parametrize the exchange energies for the two end point systems in the following form : @xmath70 here @xmath71 has two discreet values : @xmath72 for spin unpolarized while @xmath73 for fully polarized .",
    "the formula is the same as that in ref .   for the high density region , but we have introduced two additional terms in the low density part .",
    "the values of @xmath74 are determined by the infinite size heg exchange energies .",
    "the other coefficients are obtained from a fit and by continuity conditions at @xmath64 . as described in sec .",
    "[ subsec : xc - parameters ] , we choose the same @xmath64 for @xmath72 and @xmath73 , hence for all polarizations @xmath42 . at @xmath66 , we require the exchange potential and its first derivative to be continuous for all polarizations . the conditions are straightforward to impose at @xmath72 and @xmath73 . for an arbitrary spin polarization , the spin interpolation function @xmath68 in eq .",
    "( [ eq : ex - interpolation ] ) depends on the spin density .",
    "the exchange potential is given by @xmath75 \\nonumber \\\\",
    "& + n\\frac{\\partial f(\\zeta)}{\\partial n_{\\uparrow(\\downarrow ) } } [ \\varepsilon_{x}(r_s , l,1)-\\varepsilon_{x}(r_s , l,0 ) ] .",
    "\\label{eq : vx}\\end{aligned}\\ ] ] we see that , if the energy difference between the polarized and unpolarized systems , @xmath76-@xmath77 , is made continuous at @xmath66 , the exchange potential will be continuous for any @xmath42 .",
    "it is easy to show that continuity of the first derivative of the exchange potential is also satisfied with these conditions .",
    "we calculate the exchange energies for different supercell sizes by averaging over @xmath4-points .",
    "the quality of the fits is consistent with that in ref .  .",
    "numerical values of the parameters are given in sec .",
    "[ subsec : xc - parameters ] .      unlike the exchange energy ,",
    "the correlation energy consists of both intra- and inter - spin contributions .",
    "there is no exact mapping of the correlation energy at an arbitrary polarization from spin unpolarized results . within standard dft",
    ", the correlation energy for partial spin polarization is obtained from an interpolation between spin unpolarized and fully spin polarized systems , as we have done with the exchange energy .",
    "we will follow the same procedure .",
    "below , we first construct the energy functions for the two end - point systems of @xmath72 and @xmath73 .    in ref .",
    ", the correlation energy of unpolarized system of the heg is expressed separately for high , intermediate , and low density regions . in the high density region",
    ", the formula is parameterized by fitting to ceperley and alder s extrapolation fit @xcite    _ c(r_s , l ) & = _ c^(r_s)-_x(r_s , l ) + & + [ b_1(r_s)-1]_k(r_s , l ) + b_2(r_s)/n ,    [ eq : extrapolation ]    where the parameters @xmath78 and @xmath79 were written as low order polynomials in @xmath80 and @xmath81 , respectively , and fitted to tabulated data for unpolarized systems .",
    "@xcite ( note that here @xmath82 and @xmath83 are given by @xmath84-@xmath85 and @xmath86-@xmath87 , respectively . ) to avoid the divergence at sufficiently large @xmath40 or small @xmath33 , the correlation energy is set to zero . in the intermediate density region ,",
    "a polynomial function is used whose parameters were completely determined from continuity conditions . for fully polarized systems , the available finite - size data from qmc were not as detailed .",
    "we instead modify the procedure above , by generating fs heg data in the intermediate density regime and fitting them to obtain a unified function extending to higher densities .    ) , while the dashed lines are from kzk .",
    "b ) the parametrized correlation energy for fully spin polarized heg systems is compared with afqmc data .",
    "solid lines represent the fits while symbols are from afqmc at finite sizes .",
    "statistical error bars in the afqmc results are smaller than the symbol size .",
    "the infinite size lsda result is also shown for @xmath73 .",
    ", scaledwidth=48.0% ]    we parameterize the spin unpolarized and fully spin polarized correlation energies by a new unified function with only two density regions : @xmath88 the functional form is chosen to approach the correct asymptotic value at high density , where we have used the perdew - zunger ( pz ) parametrization @xcite for the function @xmath89 .",
    "the leading fs term @xmath90 exactly cancels its counterpart in the exchange energy to ensure that the total xc energy scales as @xmath91 as expected . for the @xmath92 term , we choose the functional form    g(r_s , l , p)&g_1(l , p)r_s ( r_s ) + g_2(l , p)r_s + g_3(p)r_s^1/2 + & + g_4(p)r_s^3/2 ( r_s ) + g_5(p)r_s^3/2 + g_6(p)r_s^2 .",
    "[ eq : gr_ec ]    the last four parameters are determined by the fits , while the other two are determined by continuity conditions .",
    "we require the correlation energy and its first derivative to be continuous at @xmath93 .",
    "our choice of @xmath93 and the final parameter values are given in sec .",
    "[ subsec : xc - parameters ] .",
    "we perform phaseless afqmc @xcite calculations of the correlation energies of the heg , for @xmath73 and @xmath72 , in finite supercells at typical densities . with each choice of @xmath33 and @xmath2",
    ", we average the total energy over multiple @xmath4-points .",
    "the results are shown in fig .",
    "[ fig : fit ] .",
    "it is seen that the new parametrized functions fit all the afqmc data well .",
    "figure  [ fig : fit]a also shows a comparison between the new functional and that of kzk for unpolarized systems .",
    "the two fits are almost indistinguishable , except in the intermediate region , where the new function shows a slightly better fit to afqmc results , especially for small lattice sizes . as mentioned , in the approach of kzk , the functional form at high density is fully determined by existing dmc data .",
    "afqmc data were only used to guide the choice of the boundaries which separated the high density regime from the intermediate and low density regimes .",
    "in contrast , the current approach only had afqmc data at intermediate densities to determine the functional form for @xmath94 .",
    "the good agreement between the two parametrizations across the density range is thus very reassuring .",
    "contrary to the exchange energy , the correlation energy approaches the thermodynamic limit from above , as illustrated in fig .  [",
    "fig : fit]b .",
    "we have now obtained the fs correlation energy formulas for spin unpolarized ( @xmath72 ) and fully spin polarized ( @xmath73 ) systems , with which we can interpolate to arbitrary spin polarization @xmath42 .",
    "as mentioned , the interpolation of the correlation energy is not exact . in standard dft",
    ", two forms have been widely adopted : @xcite that of pz as we have used for the exchange in eq .",
    "( [ eq : ex - interpolation ] ) , and that of perdew and wang ( pw ) : @xmath95 \\nonumber \\\\ + [ \\varepsilon_{c}(r_s , l,1)-\\varepsilon_{c}(r_s , l,0 ) ] f(\\zeta ) \\zeta^4 , \\label{eq : pw - interpolation}\\end{aligned}\\ ] ] where @xmath96 is the spin stiffness function which includes additional fitting parameters .",
    "the interpolations for several different supercell sizes are shown in fig .",
    "[ fig : ec - inter ] . in the pw results ,",
    "we have fixed the @xmath96 at the infinite - size values without further parametrization .",
    "it is seen that the two schemes give similar results .",
    "compared to the actual fs data from afqmc calculations in polarized systems , both schemes provide reasonable estimates .",
    "discrepancies are visible , especially at smaller supercell sizes . in the applications below",
    ", we have used the pz interpolation scheme for the correlation energy , due to its simplicity , _ i.e. _ , using the same interpolation as in the exchange energy in eq .",
    "( [ eq : ex - interpolation ] ) .",
    "the pz form is equivalent to the special choice in eq .",
    "[ eq : pw - interpolation ] .",
    "this is further discussed in sec .",
    "[ sec : discuss ] .",
    "[ 1]d .. #1     & & & & + 0 & -0.9163 & & -1.1545 & + 1 & -2.2037 & & -1.7491 & + 2 & 0.4710 & & 0.2967 & + 3 & 0.2339 & 0.2109 & 0.1812 & 0.7528 + 4 & -0.4880 & 8.4987 & -0.4515 & 3.3314 + 5 & 0.1847 & -13.6840 & 0.1786 & -5.1050 + 6 & & -4.6977 & & -2.3048 +    the functional forms of our parametrized fs lsda xc functional are given in eqs .",
    "( [ eq : exnew ] ) , ( [ eq : ec ] ) , and ( [ eq : gr_ec ] ) . by performing afqmc calculations and fitting to the results with the procedures described above",
    ", we obtain the values of the coefficients , which are given in table  [ tab : xc - table ] .",
    "the only remaining parameters are the densities at which the different pieces in the functional are joined . for the exchange energy , we used @xmath97 for both spin unpolarized and fully polarized states . for the correlation energy",
    ", we chose @xmath98 for the fully polarized system and @xmath99 for the unpolarized system .",
    "these choices are guided by the basic idea that beyond @xmath100 , we have a supercell of the heg in which there is only a fraction of an electron .",
    "the exchange ( correlation ) energy needs to vanish rapidly in this regime .",
    "clearly the location of @xmath100 can not be uniquely defined .",
    "the results from the xc functional should not be sensitive to the precise value of @xmath100 .",
    "we have verified that this is indeed the case in typical supercell sizes . in principle , @xmath64 should depend on the spin polarization @xmath42 . for the fully polarized system , @xmath101 signals the transition point , while for the unpolarized system , @xmath102 . we have taken them to be the same value , which simplifies the interpolation and makes the functional easier to implement , because all values of @xmath42 share the same @xmath64 . the form of the correlation energy is continuous and it is easier to have different @xmath100 values for different @xmath71 . we have thus chosen @xmath103 for @xmath72 to be the same as in kzk for consistency .    in the correlation energy , there are six parameters in the formula of eq .",
    "( [ eq : gr_ec ] ) .",
    "we only need to fit the last four , since the other two , @xmath104 and @xmath105 , are fully determined by the continuity conditions .",
    "this is why they have a dependence on lattice size @xmath2 . in the applications below ,",
    "we have used the pz interpolation scheme in the correlation energy , i.e. , using the same interpolation as in the exchange energy .",
    "the @xmath106 term is then exactly canceled at any polarization , leaving only @xmath107 and higher order terms in the fs errors .",
    "we consider four examples here to illustrate the application of the new fs lsda functional . the four problems are chosen to cover different aspects of the application .",
    "all of them have spin polarizations or magnetic ground states which require the new spin - dependent fs functional .",
    "calculations in single atoms and molecules provide systematic mb results for arbitrary supercell sizes which allow a detailed study of the fs convergence .",
    "the ionization energy of mn is calculated to study the effect of the fs lsda in supercells when there is a physical charge imbalance . in the last example",
    ", transition metal oxide systems mno and feo are considered to study the application of the fs correction in extended systems with magnetic order . in the first three examples",
    ", we use the phaseless afqmc method @xcite in a plane - wave basis , with a norm - conserving pseudopotential to carry out the mb calculations , before applying the fs corrections .",
    "more systematic afqmc calculations of atomic and molecular systems using plane - wave basis exist .",
    "@xcite our goal here is simply to use it as an accurate mb approach for model extended systems to study fs corrections . in the last example , we use existing dmc results @xcite and use the new fs functional as a post - processing correction .     molecular dissociation energy vs. supercell size . calculated afqmc total energies of the p atom and p@xmath108 molecule are shown in panels ( a ) and ( b ) , respectively .",
    "the corresponding @xmath109  of p@xmath108 is shown in ( c ) .",
    "the infinite - size limits of dft and afqmc are shown by the dashed and dot - dashed lines , respectively .",
    "afqmc statistical error bars are shown but many are smaller than the symbol size . the orange arrow in ( c ) points to the experimental value .",
    ", scaledwidth=48.0% ]    our first application is to calculate the dissociation energy ( @xmath109 ) of the p@xmath108 molecule , using a plane - wave basis and pbc with single @xmath4-point sampling , . in both afqmc and dft calculations ,",
    "a norm - conserving kleinman - bylander @xcite separable nonlocal lda pseudopotential @xcite is used .",
    "the p atomic ground state is magnetic , with an electronic configuration , a ",
    "close - shell \" system for each spin .",
    "the p@xmath108 molecular ground state is non - magnetic , with 5 @xmath37-spin and 5 @xmath38-spin electrons .",
    "the total energy calculations are performed in cubic supercells of size @xmath110bohr .",
    "figure  [ fig : p ] shows the mb results from afqmc calculations , as well as dft results from both the standard , infinite - size lsda xc functional ( denoted by dft@xmath111 ) and the new fs functional ( denoted by dft@xmath112 ) .",
    "the conventional dft@xmath111 energies converge to the infinite limit very rapidly , as expected .",
    "the dft@xmath112 calculations exhibit a significantly slower convergence , reflecting the 2b fs effect which it is designed to capture . for the p atom ,",
    "the overall fs effect is not very large , but a persistent fs error can be seen in the raw afqmc results . up to @xmath113bohr ,",
    "the energy is still about @xmath114ev away from the infinite - size value .",
    "the 1b correction with standard dft [ @xmath115 ; see eq .",
    "( [ deltadftfs ] ) ] is in the wrong direction and leads to a larger fs error and slower rate of convergence .",
    "by contrast , the dft@xmath112 total energies , which include both 1b and 2b corrections [ eq .  ( [ deltadftfs ] ) ] , show size dependence similar to the afqmc results .",
    "after @xmath116 correction , the afqmc total energy converges to the asymptotic value rapidly , as seen from the essentially flat curve beyond @xmath117bohr .",
    "a similar trend is seen in the p@xmath108 molecule as shown in fig .",
    "[ fig : p]b . in this case",
    "the 1b correction does reduce the fs error , but only up to intermediate size @xmath2 , beyond which the standard dft has reached convergence .",
    "the mb results remain unchanged for large @xmath2 , where the 2b fs effect dominates .",
    "the dft@xmath112 calculation again tracks the fs dependence of the mb afqmc , and the total energy of the latter converges very rapidly to the infinite size limit after applying the full fs correction .",
    "the p@xmath108 system is unpolarized , so the kzk parametrized fs functional can also be applied .",
    "compared to the results there , @xcite the new functional seems to slightly overestimate the fs error .",
    "this small difference is from the choice of exchange energy discontinuity point @xmath64 , as mentioned in sec .",
    "[ subsec : xc - parameters ] . with the fs corrections ,",
    "the calculated @xmath109  shows good convergence by about @xmath118bohr , as seen in fig .  [",
    "fig : p]c .     molecular dissociation energy vs. supercell size .",
    "same conventions as in fig .",
    "[ fig : p ] .",
    ", scaledwidth=48.0% ]    our second application is for the si atom and molecule . these are  open - shell \" systems , and both systems are spin polarized in the ground state ( @xmath119 and @xmath120 , respectively ) .",
    "the calculations are done in a similar way to the first application , with planewave basis and a norm - conserving non - local pseudopotential in a periodic supercell .",
    "the dependence of total energies and the dissociation energy with lattice size @xmath2 is presented in fig .",
    "[ fig : si ] . similar to the p atom ,",
    "the usual dft 1b correction for the si atom has an opposite sign from the total fs error . with dft@xmath112 corrections ,",
    "the convergence of the total energy of the atom is greatly improved across the entire range of lattice size studied .",
    "similarly , for the si@xmath108 molecule , the total energy becomes essentially flat when the full correction is included , leading to rapid convergence to the infinite - size limit .",
    "although the atoms and molecules are relatively simple systems for mb calculations , they provide excellent tests for the fs correction method .",
    "they are model systems of a molecular solid in which the supercell size can be arbitrarily and systematically varied . because of the nature of the interactions and the highly inhomogeneous density distributions in the supercell , lsda calculations are not particularly accurate , as can be seen by the final dft @xmath109 s ( panel ( c ) in figs .",
    "[ fig : p ] and [ fig : si ] ) . yet",
    "the fs correction method based on lsda works extremely well .",
    "this underscores an important point , namely that for the fs correction method to be effective , the system does not _ necessarily _ have to be weakly or moderately correlated .",
    "the fs correction method requires lsda to provide a good approximation in capturing the _ difference _ between the system with interaction @xmath21 and that with the full interaction @xmath121 ( no pbc image interactions ) .",
    "@xcite this is not the same as requiring lsda to work well in either system . as the supercell size increases , the correction decreases and approaches zero .",
    "one would expect the correction to be ineffective if the supercell is less than the size of the xc hole , which would cause a distortion that is not captured in any lsda approximation .    ) .",
    "panel ( a ) shows the calculated afqmc total energies for mn , mn@xmath122 , and mn@xmath123 ; the corresponding first ( ip ) and second ( iip ) ionization energies are shown in panels ( b ) and ( c ) .",
    "curves labeled qmc are from raw afqmc results [ for the charged ions , the leading order @xmath124 correction is included ( see text ) ] .",
    "the @xmath125 and @xmath126 corrections are as in figs .",
    "[ fig : p ] and [ fig : si ] [ for the charged ions , these corrections also add the @xmath127 correction ( see text ) . ] statistical error bars are shown and are about the size of the symbols .",
    "the heavy black dash lines indicate the infinite size limits of the calculated results in panel ( a ) and the experimental ionization energies in panels ( b ) and ( c ) .",
    ", scaledwidth=48.0% ]    the third application is to the mn transition metal atom and its first and second ionization potentials .",
    "the @xmath4-point used here is ( 0.25,0.25,0.25 ) . for charged systems such as mn@xmath128 or mn@xmath123",
    ", there is an additional complication in a supercell calculation , since charged systems are incompatible with pbc .",
    "a uniform neutralizing background is introduced to maintain charge neutrality , @xcite but this results in a slow @xmath129 size convergence to leading order.@xcite in independent - electron calculations such as dft , makov and payne ( mp ) @xcite argued that the dependence has the form : @xmath130 where @xmath131 is the neutralizing charge , @xmath132 is the madelung constant , and @xmath133 is the quadrupole moment of the supercell .",
    "thus , adding the counter - terms @xmath134mp@xmath135 and @xmath134mp@xmath136 to @xmath137 accelerates the size - convergence of dft calculations for charged systems .",
    "the @xmath134mp@xmath138 correction applies equally well to a many - body calculation with pbc , since it depends only on the neutralizing charge , and all afqmc results reported below for charged systems include this important correction .",
    "the @xmath134mp@xmath139 correction depends on @xmath133 , which will generally differ , in a many - body calculation , from the dft value . in this work",
    "we have not calculated @xmath133 in afqmc , but have used the dft value .",
    "figure [ fig : mn ] shows the size convergence of total energies of mn , mn@xmath122 , and mn@xmath123 and the corresponding first and second ionization energies . for mn and mn@xmath122 total energies",
    ", @xmath126 removes nearly all of the fs error , while it somewhat overcorrects for mn@xmath123 .",
    "the @xmath125 corrections are smaller in all cases .",
    "for the ionization energies , both @xmath125 and @xmath126 are seen to overcorrect the fs error . for ip ,",
    "the residual error after @xmath126 correction is slightly smaller than the raw afqmc result , while @xmath125 increases the fs error .",
    "for iip , both fs corrections increase the fs error .",
    "extrapolation of these results to the infinite size limit , leads to ip and iip values of 7.27(08 ) and 23.15(08 ) ev , respectively .",
    "these are in reasonably good agreement with the experimental values of 7.43 ev and 23.07 ev , respectively .",
    "@xcite because of strong fs error cancellations , the raw qmc ip and especially iip energies show little fs effect .",
    "this magnifies the residual errors in the fs correction for charged systems .",
    "the most likely source of the residual error would appear to be the discrepancy in applying the @xmath134mp@xmath139 directly from dft .",
    "the mb and dft estimates of the quadrupole moment @xmath133 are likely to differ .",
    "we will leave further investigation of this effect to a future study .",
    "the total energies , after fs correction , show much smaller fs error , especially in the neutral system of mn . given the strong magnetic nature of this transition metal system",
    ", this is an encouraging result for our fs correction scheme .",
    "in the supercell ) for a ) mno in the b1 phase , and b ) feo in the ib8 phase at volumes of 21.7 @xmath140/mno and 20.4 @xmath140/feo , respectively .",
    "results from the dmc calculations are indicated by green circles ; corrected values using the structure factor method ( taken from ref . )",
    "are shown by the blue squares .",
    "dmc results corrected by @xmath126 are indicated by red triangles .",
    ", scaledwidth=47.0% ]    the last application is for crystalline mno and feo .",
    "these materials are challenging to simulate due to the complex interplay of strong correlation effects , p - d hybridization , and magnetism .",
    "we apply the dft fs correction directly to previous results from dmc calculations . @xcite",
    "although the pseudopotentials used in our modified dft calculations are different from those used in dmc , this has only a weak effect on the fs corrections . as seen in fig .",
    "[ fig : mno - feo ] , the @xmath126 correction greatly reduces the dmc fs error . in both materials , it somewhat over - corrects and approaches the infinite limit from above .",
    "the structure factor correction of chiesa @xcite , also shown in the figure , somewhat under - corrects .",
    "for mno the residual error is somewhat larger than for @xmath126 , while it is smaller for feo .",
    "a possible difficulty for @xmath126 is the irregular supercells used for these materials .",
    "the @xmath126 correction method is based on cubic supercells , parametrized by a single length scale @xmath2 .",
    "this is a good approximation for other high symmetry systems such as fcc supercells . @xcite",
    "if the supercell shape is far from cubic and has strong anisotropy , however , the fs total energy will increase , resulting in a smaller fs correction compared to that of a cubic system .",
    "this is discussed further in the next section .",
    "these applications demonstrate that the new fs error correction scheme can consistently remove most of the fs error and accelerate the size convergence of mb results to infinite size limit .",
    "in this section we discuss several aspects of the new fs correction method , the parametrized lsda functional , and possible further improvements .",
    "in , the fs lsda xc functional was separated into exchange @xmath141 [ eqs .",
    "( [ eq : ex - interpolation])-([eq : exnew ] ) ] and correlation @xmath142 [ eqs .",
    "( [ eq : ec ] ) and ( [ eq : gr_ec ] ) ] contributions .",
    "this facilitates the modification of existing dft computer codes to generate the fs corrections . while useful , this separation somewhat complicates the fs treatments , which are based on xc functionals derived from the heg .",
    "for example , while the total fs heg xc energy scales as @xmath92 , @xmath141 scales as @xmath143 , since the hartree - fock spectrum is gapless in this case .",
    "the separation thus induces a canceling @xmath143 term in @xmath142 .",
    "partly for this reason , we adopted the pz spin interpolation formula given by eq .",
    "( [ eq : ex - interpolation ] ) for @xmath141 , rather than the exact relation in eq .",
    "( [ eq : ex ] ) , since it makes the treatment of exchange consistent with that of the correlation , for which there is no analogy of eq .",
    "( [ eq : ex ] ) , and ensures cancellation of the @xmath143 dependence . [ as mentioned , in the limit @xmath144 , eq .",
    "( [ eq : ex - interpolation ] ) reduces to the exact relation in eq .",
    "( [ eq : ex ] ) . ]",
    "since the fs exchange energy for spin unpolarized system is discontinuous , @xcite another reason for using eq .",
    "( [ eq : ex - interpolation ] ) is that it avoids multiple discontinuities in a partially polarized system , as discussed in sec .",
    "[ subsec : exchange ] .",
    "the continuity density @xmath64 in eq .",
    "( [ eq : exnew ] ) was chosen for simplicity .",
    "it could be made polarization - dependent , but the expressions would be more complex and not as easy to implement into dft codes . as discussed in sec .",
    "[ subsec : xc - parameters ] , fs corrections are not sensitive to the precise value of @xmath64 , especially for extended systems .",
    "similar considerations pertain to the treatment of correlation . since @xmath142 is continuous , it was easy to use different values for @xmath145 and @xmath146 in eq .",
    "( [ eq : ec ] ) , as described in sec .",
    "[ subsec : xc - parameters ] , when the pz interpolation form is used . if the pw interpolation of eq .",
    "( [ eq : pw - interpolation ] ) were to be used , cancellation of the @xmath143 term would require more complicated expressions .",
    "interpolation formulas , such as that of pz , allow us to map spin unpolarized and fully - polarized results onto the correlation energy at an arbitrary polarization .",
    "for the fully polarized heg , the available finite - size data from qmc were not as detailed as for the unpolarized case .",
    "our fits of the fully - polarized @xmath147 correlation functional are based on afqmc calculations of finite systems , mostly for @xmath40 greater than about 1.5 - 2 . while our correlation energy fits are acceptable ( see figs .  [",
    "fig : fit ] and [ fig : ec - inter ] ) , more qmc calculations for small @xmath40 might lead to improvements .",
    "extensions of our fs error correction scheme are possible , for example based on orbital - dependent density functionals , @xcite such as hybrid dft functional calculations .",
    "hybrid functionals @xcite augment the dft exchange - correlation energy with an exact exchange term calculated from hf theory .",
    "hybrid functionals have become one of the most promising approaches for overcoming some of the shortcomings of local or semilocal dft approximations .",
    "@xcite some complications would need to be addressed .",
    "popular hybrid functionals such as pbe0 @xcite use a fraction @xmath148% of exact exchange and dft exchange for the remainder . in applications to semiconducting and insulating materials , the hf exchange converges as @xmath92 with pbc , since the single - particle spectrum has a gap .",
    "[ the leading behavior is @xmath92 after a @xmath52 madelung - like dependence is removed , @xcite as is done in qmc calculations .",
    "@xcite ] since dft fs exchange scales as @xmath143 for the heg , the fraction of the @xmath143 term in the fs correlation functional would have to be adjusted in order to obtain a net @xmath92 behavior .",
    "the resulting @xmath142 would lead to a non - continuous behavior with increasing @xmath40 , which might require further modifications of the fits .",
    "finally , our fs xc functional is based on heg calculations using cubic supercells of edge @xmath2 . for non - cubic applications , @xmath2 is determined by the volume of the supercell . in the heg , spatially isotropic supercells are favored .",
    "for example , a small cubic to tetragonal distortion will cause the total energy to become more positive , scaling as @xmath149 ) , where @xmath150 is a constant and @xmath151 describes the aspect ratio @xmath152 of the tetragonal supercell .",
    "therefore our fs xc functional tends to provide an upper limit to the magnitude of the fs correction for non - cubic supercells .",
    "this may have contributed to the over - correction seen in fig .",
    "[ fig : mno - feo ] , where anisotropic mno and feo supercells were used .",
    "many - body calculational methods such as quantum monte carlo can potentially provide accurate results for extended systems where electron interaction effects are important .",
    "these calculations are computationally more costly than independent - electron calculations , and are always accompanied by more significant fs errors . in this work ,",
    "we have provided a framework within dft to understand and estimate the fs errors in mb calculations of spin - polarized systems .",
    "a fs lsda functional is parametrized which leads to a simple , post - processing correction method .",
    "the method is designed to approximately include 2b fs corrections in fs dft calculations of systems with arbitrary spin polarization .",
    "the corrections to total energy , dissociation energy , and ionization energy calculations of several typical systems show a significant improvement on the convergence .",
    "the formalism of the method and the parametrization of the fs functional are presented in detail .",
    "the strengths and weaknesses of the approach are discussed .",
    "there are several directions in which the method can be further developed .",
    "the method can be easily incorporated in any standard dft computer program for periodic systems , and can be used to correct any mb results .",
    "it is expected that the method will find applications in the study of a variety of realistic systems with magnetic ordering .",
    "this work is supported by doe ( grant no .",
    "de - fg02 - 09er16046 ) , nsf ( grant no .",
    "dmr-1006217 ) , and onr ( grant no .",
    "n00014 - 08 - 1 - 1235 ) .",
    "calculations were performed at the center for piezoelectric by design .",
    "we thank s.  sorella for helpful discussions , w. purwanto for help with computing issues , and j. koloren and l. mitas for sending us the computational details of refs .  .",
    "d. m. ceperley and b. j. alder , phys .",
    "* 45 * , 566 ( 1980 ) .",
    "p. j. reynolds , d. m. ceperley , b. j. alder , and w. a. lester , j. chem .",
    "phys . * 77 * , 5593 ( 1982 ) .",
    "w. m. foulkes , l. mitas , r. j. needs , and g. rajagopal , rev .",
    "phys . * 73 * , 33 ( 2001 ) .",
    "s. zhang and h. krakauer , phys .",
    "lett . * 90 * , 136401 ( 2003 ) .",
    "a. j. williamson , r. q. hood , and j. c. grossman , phys .",
    "lett . * 87 * , 246406 ( 2001 ) .",
    "p. hohenberg , and w. kohn , phys . rev .",
    "* 136 * , b864 ( 1964 ) . w. kohn , and l. j. sham , phys . rev . *",
    "140 * , a1133 ( 1965 ) .",
    "p. r. c. kent , randolph q. hood , a. j. williamson , r. j. needs , w. m. c. foulkes , and g. rajagopal , phys .",
    "b * 59 * , 1917 ( 1999 ) . l. m. fraser , w. m. c. foulkes , g. rajagopal , r. j. needs , s. d. kenny , and a. j. williamson , phys .",
    "b * 53 * , 1814 ( 1996 ) .",
    "a. j. williamson , g. rajagopal , r. j. needs , l. m. fraser , w. m. c. foulkes , y. wang and m .- y .",
    "chou , phys .",
    "b * 55 * , 4851(r ) ( 1997 ) . n. d. drummond , r. j. needs , a. sorouri , and w. m. c. foulkes , phys .",
    "b * 78 * , 125106 ( 2008 ) . s. chiesa , d. m. ceperley , r. m. martin , and m. holzmann , phys .",
    "lett . * 97 * , 076404 ( 2006 ) .",
    "h. kwee , s. zhang , and h. krakauer , phys .",
    "lett . , * 100 * , 126404 ( 2008 ) .",
    "p. giannozzi et al . , j. phys.:condens .",
    "matter * 21 * , 395502 ( 2009 ) ; url  http://www.quantum-espresso.org \" .",
    "w. purwanto , h. krakauer , and s. zhang , phys .",
    "b * 80 * , 214116 ( 2009 ) .",
    "e. sola and d. alf , phys .",
    "lett . * 103 * , 078501 ( 2009 ) .",
    "r. maezono , n. d. drummond , a. ma , and r. j. needs , phys .",
    "b * 82 * , 184108 ( 2010 )",
    ". s. j. binnie , s. j. nolan , n. d. drummond , d. alf , n. l. allan , f. r. manby , and m. j. gillan , phys .",
    "b * 82 * , 165431 ( 2010 ) .",
    "r. g. hennig , a. wadehra , k. p. driver , w. d. parker , c. j. umrigar , and j. w. wilkins , phys .",
    "b * 82 * , 014101 ( 2010 ) .",
    "s. sorella , m. casula , l. spanu , and a. d. corso , phys .",
    "b * 83 * , 075119 ( 2011 ) . c. lin , f. h. zong , and d. m. ceperley , phys . rev .",
    "e * 64 * , 016702 ( 2001 ) .",
    "a. baldereschi , phys .",
    "b * 7 * , 5212 ( 1973 ) .",
    "d. m. ceperley , phys .",
    "b * 18 * , 3126 ( 1978 ) .",
    "j. p. perdew and a. zunger , phys .",
    "b , * 23 * , 5048 ( 1981 ) .",
    "u. von barth and l. hedin , j. phys .",
    "c * 5 * , 1629 ( 1972 ) .",
    "j. p. perdew and y. wang , phys .",
    "b , * 45 * , 13244 ( 1992 ) . m. gell - mann and k. a. brueckner , phys . rev . * 106 * , 304 ( 1957 ) .",
    "d. m. ceperley and b. j. alder , phys .",
    "b * 36 * , 2092 ( 1987 ) .",
    "b. tanatar and d. m .ceperley , phys .",
    "b * 39 * , 5005 ( 1989 ) .",
    "y. kwon , d. m. ceperley and r. m. martin , phys .",
    "b * 58 * , 6800 ( 1998 ) . h. kwee , ph.d .",
    "thesis , college of william and mary , ( 2008 ) .",
    "g. ortiz and p. ballone , phys .",
    "b * 50 * , 1391 ( 1994 ) .",
    "m. suewattana , w. purwanto , s. zhang , h. krakauer , and e. j. walter , phys .",
    "b * 75 * , 245123 ( 2007 ) .",
    "j. koloren , s. hu , and l. mitas , phys . rev .",
    "b * 82 * , 115108 ( 2010 ) .",
    "j. koloren , and l. mitas , phys .",
    "* 101 * , 185502 ( 2008 ) .",
    "l. kleinman and d. m. bylander , phys .",
    "* 48 * , 1425 ( 1982 ) . generated with opium : http://opium.sourceforge.net .",
    "g. makov and m. c. payne , phys .",
    "b * 51 * , 4014 ( 1995 ) . p. p. ewald , ann .",
    "( leipzig ) * 64 * , 253 ( 1921 ) .",
    "j. ziman , _ principles of the theory of solids _ ( cambridge university press , cambridge , 1964 ) .",
    "j. sugar and c. corliss , j. phys .",
    "chem . ref .",
    "data * 14 * , suppl . 2 ( 1985 ) .",
    "becke , j. chem . phys . * 98 * , 1372 ( 1993 ) s. kmmel and l. kronik , rev .",
    "phys , * 80 * , 3 ( 2008 ) .",
    "j. p. perdew , m. ernzerhof , and k. burke , j. chem . phys . * 105 * , 9982 ( 1996 ) f. gygi and a. baldereschi , phys . rev .",
    "b * 34 * , 4405 ( 1986 ) .",
    "nguyen and s. de gironcoli , phys .",
    "b * 79 * , 205114 ( 2009 ) ."
  ],
  "abstract_text": [
    "<S> we extend the post - processing finite - size ( fs ) correction method , developed by kwee , zhang , and krakauer [ _ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . _ * 100 * , 126404 ( 2008 ) ] , to spin polarized systems . </S>",
    "<S> the method estimates the fs effects in many - body electronic structure calculations of extended systems by a modified density functional theory ( dft ) calculation , without having to repeat expensive many - body simulations . </S>",
    "<S> we construct a unified fs dft exchange - correlation functional for spin unpolarized and fully spin polarized systems , under the local density approximation . </S>",
    "<S> the results are then interpolated to arbitrary spin polarizations . </S>",
    "<S> generalization to other functional forms in dft are discussed . </S>",
    "<S> the application of this fs correction method to several typical magnetic systems with varying supercell sizes demonstrates that it consistently removes most of the fs errors , leading to rapid convergence of the many - body results to the infinite size limit . </S>"
  ]
}