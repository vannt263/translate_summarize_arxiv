{
  "article_text": [
    "biomolecular systems , and more broadly soft matters , are inherently hierarchic : atomic details are crucial for functioning , which is often regulated by slower and larger - scale motion . not surprisingly , both all - atom ( aa ) detailed and coarse - grained ( cg ) molecular dynamics ( md ) simulation , and sometimes monte - carlo simulation , methods have been developed and they play more and more crucial roles in biophysics@xcite , as complement of experiments . unfortunately , due to the large number of degrees of freedom involved and inherently rugged energy surface , the time scale currently reachable by the aa simulation , @xmath0microsecond , is far below typical biologically relevant time scale of milliseconds or longer .",
    "conversely , the cg simulation can sample molecular conformations much more efficiently , but it is unavoidably less accurate in energy estimation .",
    "thus , the aa ( cg ) simulations are more ( less ) accurate in energy , but less ( more ) efficient in sampling . to surmount these problems ,",
    "a number of strategies have been proposed to integrate the aa and cg simulations , which is often called multiscale simulations@xcite .    in one widely used multiscale strategy , first , the conformational space is broadly sampled by a certain cg simulation .",
    "the sampled cg ensemble is then converted to aa detailed ensemble followed by some refinement .",
    "this cg@xmath1aa strategy has been successfully used in protein folding and structure prediction@xcite .",
    "recently , a more parallel method with the two - way coupling , called the resolution replica exchange ( resex ) , was proposed in the framework of hamiltonian replica exchange md@xcite , in which the aa md is coupled to a certain cg md via trials of conformation exchangely06a , ly06b , li07,ch06,lw05 .",
    "both of these multiscale methods , however , rely heavily on the accuracy of the cg model . if the cg potential has its major basins different from those of aa potential , neither the cg@xmath2aa strategy nor the resex works well . in practice , however , as noted above , the cg model is unavoidably less accurate",
    ". therefore , the inaccuracy of the cg potential represents the major bottleneck of the multiscale simulationsch06a .",
    "multiscale simulation methods which do not depend on the aforehand knowledge of the accurate cg potential , is desired and one such method is developed in this work .    often the cg potential can be derived by yet another multiscale approach of aa@xmath2cg type . performing the aa simulation , we can use energy / force of the aa model to estimate the effective energy / force acting on cg particles@xcite .",
    "however , as the aa simulation can sample very limited conformational space , the extracted cg potential well - approximates the aa potential in narrow conformational space . in particular , as in many practical applications such as protein structure prediction or protein - protein docking , we do not know relevant part of the conformational space a priori , and so the aa simulation can not reach the relevant part of the phase space and thus the extracted cg potential is useless in such cases .",
    "in this work , we report a new multiscale simulation method , self - learning multiscale molecular dynamics ( slms - md ) , in which the cg potential is continuously improved according to the previously sampled cg conformations and their corresponding aa energies by an iterative way .",
    "the cg simulation ensures the efficient and broad sampling , and simultaneously the aa energies shape up the accuracy of the cg potential .",
    "the most promising feature of this method is that its performance does not rely on the accuracy of the initial cg potential because the cg potential is progressively improved by self - learning .",
    "two kinds of test studies demonstrate that by using the slms - md , we can optimally combine the advantages of the aa and cg simulations , and achieve high accuracy and high sampling - efficiency simultaneously . to our knowledge , this is the first work that tightly couples the cg sampling and aa energy to improve the cg potential , and realize efficient and accurate multiscale simulations .",
    "1 shows the detailed flow chart of the slms - md . in this method ,",
    "we start with an arbitrarily chosen cg potential and the aa potential that is assumed to be accurate . given two potentials , we perform resex md simulations@xcite . namely , two independent simulations with cg and aa resolutions are conducted simultaneously in parallel at temperatures of @xmath3 and @xmath4 , respectively .",
    "after certain md steps , exchange of conformations of these two replicas is attempted .",
    "here we assume that we have a method of structure mapping between aa and cg representations , detail of which depends on cases and will be described later .",
    "the acceptance ratio of the exchange between the cg replica with coordinate @xmath5 and the aa replica with coordinate @xmath6 is determined by metropolis - like criterion : @xmath7 where @xmath8 with @xmath9 and @xmath10 . @xmath11 and @xmath12 are the corresponding cg energy and aa energy , respectively . after this resex md simulation ,",
    "we collect structures sampled by the cg replica , map them to the aa representations , and compute their aa energies . with these , the pairwise distribution function ( pdf ) @xmath13 of each pair of interacting cg particles at temperature @xmath4 can be calculated by re - weighting@xcite : @xmath14 where @xmath15 is the distance for certain pair of cg particles of the @xmath16-th structure .",
    "we note that this pdf reflects , via re - weighting , energetic information from the aa potential .",
    "the corresponding potential of mean force ( pmf ) @xmath17 can be derived by the standard boltzmann inversion @xmath18 where the @xmath19 is the pdf of the reference state and determined according to the dfire method@xcite .",
    "this pmf is further iteratively adjusted to reproduce the original @xmath13 by cg simulation , which results in the effective interaction @xmath20 for each pair of interacting cg particles@xcite .",
    "note that due to the iteration , the final @xmath21 does not depend on the choice of the @xmath19 .",
    "this @xmath20 is then used as the cg potential of the next - generation resex simulation .",
    "since the @xmath20 is extracted by combining the energy information of the aa simulation and the conformational information of the cg simulation , namely , the advantages of both methods , it is expected to be improved compared with the initial cg potential . in this way , we can derive an accurate cg potential , and therefore overcome the bottleneck of the multiscale simulations .",
    "such a high precision cg potential not only ensures meaningful energetics and sampling in the cg simulation , but also makes the conformation exchange between the cg and aa replicas more probable , which can speed up the aa md sampling significantly based on the resex method .",
    "therefore , the slms - md can accomplish high efficiency and high accuracy simultaneously in both the cg and aa levels .",
    "it is worth noting that although the above described multiscale protocol uses the re - weighting and boltzmann inversion method in the self - learning stage , however , the essential idea of this slms - md does not depend on the specific learning method .",
    "other learning methods , e.g. , the force match protocol@xcite , should also be applicable .",
    "we first test the slms - md in an one - dimensional toy model system .",
    "the high resolution(hr ) system is represented by a potential function @xmath22 where the ruggedness modelled by the cosine mimics that of the aa energy surface ( black line in fig .",
    "2(a ) ) . as a control , performing a langevin md at the temperature @xmath23 , we found that it hardly moves from the initial valley leading to very poor sampling . to test slms - md",
    ", we introduce a cg potential , a simple harmonic potential @xmath24 .",
    "apparently , @xmath25 and @xmath26 , are the best parameters to approximate the @xmath27 . assuming that we do",
    "not a priori know the right parameters of the cg potential , we started with @xmath28 and @xmath29 ( red line in fig .",
    "2(a ) ) , far from the best values . we will show that by using the slms - md , we can derive the best cg potential parameters , with which we can then improve the sampling of the hr system by resex method .    from the above initial condition",
    ", we conducted the slms - md simulations at @xmath23 for both replicas by langevin dynamics with a friction coefficient @xmath30 .",
    "the time steps used were 0.0002 and 0.002 , respectively , for the hr and cg replicas .",
    "every 100 md steps , exchange of conformations was attempted .",
    "after @xmath31 exchange attempts , the position probability distribution of the cg simulation was calculated and mapped to the hr case by re - weightingfe89 . in the first generation ( iteration 0 ) , discrepancy between two energies led to nearly no exchange between replicas as shown in fig .",
    "the resulting position probability distributions of the hr replica ( red line of fig .",
    "3(a ) ) and the re - weighted cg replica ( red line of fig .",
    "3(b ) ) were , as expected , very poor , and deviate far from the theoretical position probability distribution which is calculated by numerical integration ( black dashed lines in fig .",
    "3(a ) and ( b ) ) . using sampled data , we then calculated the @xmath32 and fitted it with a harmonic function .",
    "for this one - dimensional case , the pmf is equivalent to the effective interaction .",
    "the fitted parameters @xmath33 and @xmath34 were used directly for the next resex md simulation .",
    "the above procedure was repeated until the parameters of the new @xmath35 get converged .",
    "2(b ) shows the fitted parameters @xmath33 and @xmath34 as a function of learning iteration step .",
    "the resulted cg potential curves after one , two and three steps of iterations are also plotted in fig .",
    "one can see that the cg potential is improved within very limited steps of learning iterations based on the slms - md .",
    "after two steps , the obtained cg potential fits the overall behavior of the hr potential very well ( fig .",
    "2(a ) ) . due to the best matching between the hr and cg potentials , the maximal acceptance ratio of resex",
    "was achieved ( fig .",
    "2(c ) ) and the sampling quality of the hr replica was enhanced significantly ( fig .",
    "2(d ) ) . consequently ,",
    "after two steps of iterations , the position probability distribution calculated both by the hr replica and by the cg replica with re - weighting were almost identical to the theoretical one ( fig .",
    "3(a ) and ( b ) ) .     as a function of iteration step .",
    "( c ) acceptance ratio of the resolution replica exchange as a function of iteration step .",
    "( d ) trajectories of the hr replica before iteration and after two steps of iterations.,scaledwidth=45.0% ]          the above one - dimensional toy model clearly demonstrated that the slms - md is highly useful in deriving the accurate cg potential and accelerating the sampling of the hr system . in this toy model system",
    ", the hr potential can capture the high dimensional characteristics of the aa system through the highly rugged energy function .",
    "however , for real biomolecular systems , the high dimensional characteristics are not only represented by the highly frustrated energy surface , but also by the entropy contribution , which can not be captured by the above one - dimensional toy model system .",
    "therefore , it is important to test the slms - md with a real biomolecule . here , we test our method with conformational sampling of a small biomolecule , i.e. , a tri - alanine peptide at @xmath36 .",
    "first , a standard temperature replica exchange md ( t - remd)@xcite of 60ns with eight replicas from 225.0k to 520.0k gave the well - converged ensemble , with which we can compare our results unambiguously . in slms - md , the aa replica used an all - atom representation with amber force field ff99sb and gb / sa implicit solvation at @xmath36 with time step of 0.002ps@xcite .",
    "the cg replica is represented by @xmath37 position .",
    "since the distance between the successive @xmath37 does not change significantly , we restrained it to the equilibrium distance(3.87 ) .",
    "the remaining internal degree of freedom is the distance between the first and third@xmath37 ( 1 - 3 @xmath37 pair ) . the initial cg potential between these two residues is arbitrarily chosen to be @xmath38 where @xmath39 is the distance between them .",
    "after each iteration , the @xmath20 is updated by the extracted effective interaction which is represented by data table and interpolated with cubic spline .",
    "the cg replica is simulated at temperature of 1.0 using langevin dynamics with @xmath40 and time step of 0.001 .",
    "both replicas started from extended structures .",
    "every 100 md steps for the aa replica and @xmath41 md steps for the cg replica , the conformational exchange was attempted . in mapping the structures from cg replica to aa replica , software bbq@xcite and scwrl3@xcite were used .",
    "note that there may be many different possible aa coordinates for the same cg coordinates .",
    "the bbq and scwrl just give one solution .",
    "the constructed side chain is the most stable one according to the energy function of scwrl .",
    "since the energy function of the scwrl may deviate from the aa force field we used , it is highly possible that the reconstructed aa structure may not be accessible by aa simulation at target temperature , therefore the simulation may be irreversible . to overcome this problem , we correct the produced aa structure by performing equilibrium aa md simulation at 250k , i.e. , the target temperature , for 1000md steps . before this equilibrium",
    "md simulation , the reconstructed aa structure is heated to 500k to remove possible bad interactions .",
    "the equilibrium md simulation produces a number of possible aa structures .",
    "one of them ( the last structure of the equilibrium md simulation ) is used as the starting structure for aa replica if the exchange is accepted . during the equilibrium md ,",
    "the distance between each @xmath37 pair is restrained by a harmonic potential with force constant changing from 10.0kcal / mol/@xmath42 to zero gradually .",
    "the resex md was performed for 1000 exchange attempts , i.e. , 200ps in aa replica .",
    "after resex md , for the learning stage , all of the sampled cg structures were converted to aa structures .",
    "2000 steps of equilibrium md were conducted with @xmath37 distances being restrained by harmonic potential with force constant of 50kcal / mol/@xmath42 after the initial high temperature simulation .",
    "all the sampled structures deposited during this equilibrium simulation were used to calculate the aa energies for re - weighting , and then the effective interaction @xmath20 was updated .",
    "we repeated the learning iteration 12 steps .",
    "4(a ) shows the extracted effective interaction @xmath20 after 3 , 6 , 9 , and 12 steps of iterations , as well as @xmath20 extracted from the long time t - remd of 60ns . for comparison , the initial @xmath20",
    "is also presented in fig",
    ". 4(a)(red line ) .",
    "clearly , the cg potential was improved rapidly during the slms - md simulation despite the poor initial potential . after three steps of iterations ,",
    "the cg potential already fit the effective interaction derived from t - remd very well .",
    "the corresponding pdf for the re - weighted cg replica and the aa replica at different iteration stages were also calculated and compared with that obtained by t - remd .",
    "4 ( b ) and ( c ) shows the pdf of the 1 - 3 @xmath43 pair calculated by re - weighted cg replica ( b ) and aa replica ( c ) , respectively , at different iteration steps .",
    "the target pdf calculated by standard t - remd is also plotted in fig .",
    "4 ( b ) and ( c ) . without iteration ,",
    "the all - atom simulation can not give correct pdf .",
    "instead , the distribution was biased to the position around 5.5  because of the biased initial cg potential used , which suggests that if the cg potential is not chosen appropriately , the exchange between the aa replica and cg replica not only undermines the sampling efficiency , but may also bias the sampling of the aa simulation and result in wrong distribution . after three steps of iterations , both the cg replica and aa replica gave almost identical distribution to that of the t - remd , although the resex protocol we used may not satisfy the detailed balance condition strictly@xcite .",
    "we emphasize that each step contains only 200ps md  in aa replica .",
    "a more stringent test of convergence and accuracy is to compare the free energy landscape on dihedral angles @xmath44 and @xmath45 of the central alanine , as illustrated in fig .",
    "the result of t - remd ( 60ns ) shows that it has the major basin in the extend @xmath46 and poly - proline ii conformations , the second major basin in right - handed ( regular ) helical conformation , and a minor basin in the left - handed helices .",
    "between different basins , some basin - hopping is necessary .",
    "after three steps of iterations , the slms - md(200ps ) could reproduce the dihedral angle distribution of the much longer time t - remd ( 60ns ) very well . in comparison",
    ", the conventional aa md ( cmd ) of 200ps without replica exchange only samples the major basin . the t - remd simulation with similar time scale , i.e. , 200ps , and the cmd with",
    "much longer simulation time ( 480ns ) sampled both major and second major basins , but not the minor basin at the left - handed helices . as expected , without improving",
    "the cg potential of the slms - md , both the right - handed helical and left - handed helical conformations were over populated due to the poor initial cg potential used .    for a more quantitative test , we compared the ratio of population in the major basin to that in the second major basin sampled by slms - md and t - remd .",
    "6(a ) shows the averaged relative populations between the two major basins calculated by nine",
    "independent slms - md ( red line ) and t - remd ( black line ) simulations .",
    "the error bars are represented by standard deviation .",
    "although , for both methods , the averaged relative populations come close to the target value ( blue arrow ) within @xmath47 , the standard deviation ( error bar ) for the slms - md is about an order smaller than that of the t - remd around @xmath48 , suggesting better sampling convergence in slms - md . fig .",
    "6(b ) also shows the representative t - remd ( black line ) and cmd ( red line ) trajectories with long time scale ( 60 ns ) .",
    "one can see that it needs @xmath49 for the t - remd to get well converged . for the cmd simulation , as expected , the convergence needs much longer time .",
    "the above result shows that the slms - md has higher sampling efficiency compared with the t - remd even for this tri - alanine peptide .",
    "however , such comparison is based on the aa md time . for the slms - md , the self - learning stage ,",
    "including structure mapping , short equilibrium md simulation , iterative boltzmann inversion , etc .",
    ", also takes cpu time .",
    "taking these processes into account , the practical cpu time used by the slms - md for this tri - alanine peptide is even longer than that used by the t - remd .",
    "this is because the tri - alanine used here is so short that the characteristic time scale for the converged sampling is shorter than the overhead time needed to implement the self - learning processes . in the case of larger systems ,",
    "e.g. , proteins with more than 100 amino acids which are the main interesting targets for most multiscale simulations , the characteristic time scale for the converged sampling will be overwhelmingly longer than the time needed for implementing the self - learning processes . in such case ,",
    "the time for aa md dominates the entire slms - md process .",
    "thus comparison by the required time scale of aa md would be reasonable .          in slms - md , as well as most other multiscale protocols , structure mapping from cg to aa structures",
    "can be a major bottleneck , which is not trivial especially for the structures far from the native state as encountered in protein folding .",
    "fortunately , a recent study reports significant advances in this direction@xcite , which ensures the performance of the slms - md . still , structure mapping may have problems in reproducing free energy profiles because of large side - chain entropy contributions .",
    "in unfolded structures , the same backbone conformation can accommodate many different side - chain rotamers , which thus contributes to the side - chain entropy .",
    "in such a case , quantitative estimate of free energy would require sampling of multiple side - chain conformations for a single backbone conformation .",
    "it is also worth noting that in the self - learning stage , the re - weighting formula ( eq .",
    "3 ) ensures that the final cg potential will be converged to the overall behavior of the aa potential , which is crucial for achieving effective resex simulations .",
    "however , as in other force / energy based learning methods , the contribution of the side chain entropy will be lost to some extent , and therefore the finally derived effective cg potential may not be identical to the real pmf .    in summary , this work presented a new idea for deriving the cg potential , and realized accurate and efficient simulations in both the cg and aa levels .",
    "the essential idea of this slms - md is quite generic and does not depend on the specific implementation strategies of the learning and resex processes .",
    "other different resex strategies and learning methods , e.g. , the force match protocol , should also be applicable . undoubtedly , the present slms - md will be benefit from any further progresses of the learning methods and the resex strategy , as well as the structure mapping algorithm .",
    "this work was partly supported by grant - in - aid for scientific research , and partly by research and development of the next - generation integrated simulation of living matter , a part of the development and use of the next - generation supercomputer project of the ministry of education , culture , sports , science and technology ."
  ],
  "abstract_text": [
    "<S> we propose a new multi - scale molecular dynamics simulation method which can achieve high accuracy and high sampling efficiency simultaneously without aforehand knowledge of the coarse grained ( cg ) potential and test it for a biomolecular system . </S>",
    "<S> based on the resolution exchange simulations between atomistic and cg replicas , a self - learning strategy is introduced to progressively improve the cg potential by an iterative way . </S>",
    "<S> two tests show that , the new method can rapidly improve the cg potential and achieve efficient sampling even starting from an unrealistic cg potential . </S>",
    "<S> the resulting free energy agreed well with exact result and the convergence by the method was much faster than that by the replica exchange method . </S>",
    "<S> the method is generic and can be applied to many biological as well as non - biological problems . </S>"
  ]
}