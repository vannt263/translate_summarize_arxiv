{
  "article_text": [
    "the calculation of free energies is central to many applications of computer simulations ranging from the calculation of ligand affinities to the study of phase equilibria in condensed materials .",
    "since the free energy is a quantity related to the phase space volume available to a system , its calculation is non - trivial in most interesting cases and in the past decades considerable effort has been devoted to developing efficient free energy computation techniques @xcite .",
    "recently , jarzynski has shown how free energies can be determined from non - equilibrium simulations @xcite . in this",
    "so called _ fast switching _ or _",
    "fast growth _ method a control parameter coupled to the hamiltonian of the system is switched from an initial to a final value at a finite rate . by changing the external parameter , the work @xmath0 is performed on the system . as a consequence of the second law of thermodynamics the average of this work is larger than the free energy difference @xmath1 between the equilibrium states corresponding to the final and initial value of the control parameter : @xmath2 here , the angular brackets denote an average over pathways starting from the equilibrium state corresponding to the initial value of the control parameter . the equal sign in this inequality , known as _ clausius inequality _ or _ maximum work theorem _",
    ", holds only if the external parameter is switched reversibly .    in 1997",
    "jarzynski demonstrated that the clausius inequality can be turned into an equality by averaging the work exponential rather than the work itself @xcite : @xmath3 where @xmath4 reciprocal temperature .",
    "the jarzynski equation ( [ equ : jarzynski ] ) has been proven for several types of dynamics ranging from newtonian and thermostatted dynamics to langevin and monte carlo dynamics @xcite .",
    "essentially , the theorem is valid if the dynamics preserves the canonical distribution for fixed control parameter @xcite .",
    "remarkably , the validity of the jarzynski equality does not depend on how the control parameter is switched from its initial to its final value .",
    "( in particular , it is not even necessary to maintain a fixed protocol throughout the simulation or the experiment as long as the initial and final value of the control parameter are fixed . )",
    "thus , the switching process can be carried out at arbitrary speed . for infinitely slow switching",
    ", jarzynski s method reduces to kirkwood s coupling parameter method , or thermodynamic integration @xcite , while for infinitely fast switching one obtains zwanzig s thermodynamic perturbation method @xcite .",
    "thus , these two well known free energy calculation methods can be viewed as limiting cases of the fast switching procedure .    whether the freedom derived from the arbitrariness of the switching protocol can be used to develop more efficient free energy calculation methods",
    "is an interesting and practical question .",
    "a recent analysis indicates that the statistical errors encountered in evaluating exponential averages such as that of eq .",
    "( [ equ : jarzynski ] ) prevent fast switching methods from exceeding the efficiency of conventional methods such as umbrella sampling or thermodynamic integration @xcite .",
    "this conclusion seems to remain true even if path sampling techniques are used to focus on those non - equilibrium pathways that yield the largest contribution to jarzynski s exponential average @xcite .",
    "note that these path sampling approaches can also be combined with the large time step method for fast switching simulations @xcite .",
    "in this paper we analyze the efficiency of several fast switching methods including the path sampling approaches mentioned above for two analytically solvable models : a particle dragged through a viscous fluid in a harmonic trap @xcite and an ideal gas in an expanding piston @xcite .",
    "for these two models the work distributions can be calculated analytically for arbitrary switching speeds . using these work distributions , we determine the statistical errors and , from them , the computational efficiency that one would obtain in fast switching simulations of these systems .",
    "the results presented in this paper confirm our previous conclusions based on actual simulations @xcite .",
    "namely , fast switching simulations do not outperform umbrella sampling and thermodynamic integration in most interesting cases .",
    "the remainder of the paper is organized as follows .",
    "simulation methods are described in sec .",
    "[ sec : methods ] .",
    "expressions for error and efficiency estimates are presented in secs .",
    "[ sec : error ] and [ sec : efficiency ] . in sec .",
    "[ sec : results ] these expressions are then applied to the two model systems .",
    "conclusionss are provided in sec .",
    "[ sec : conclusion ] .",
    "in this section we review the fast switching methods whose efficiency we will analyze in later sections . to set the notation , consider a system with a hamiltonian @xmath5 that is a function of the state of the system @xmath6 and the external control parameter @xmath7 . depending on the system , @xmath6 may include positions and momenta of all particles or the positions only .",
    "the free energy of the system at temperature @xmath8 and fixed control parameter @xmath7 is given by @xmath9 where the normalizing factor @xmath10 is the partition function of the system ( up to a constant factor ) .",
    "the free energy difference between two states @xmath11 and @xmath12 corresponding to two different values of the control parameter , @xmath13 and @xmath14 , respectively , is given by @xmath15 state @xmath11 is described by the hamiltonian @xmath16 and state @xmath12 by @xmath17 .",
    "we now imagine that the control parameter @xmath7 is continuously switched from the initial value @xmath13 to the final value @xmath14 according to some protocol @xmath18 within a total time @xmath19 . as the control parameter changes , the system evolves in time tracing out a trajectory @xmath20 . here",
    ", @xmath20 denotes a complete trajectory describing the system from time @xmath21 to time @xmath22 .",
    "the change in energy that is due to the changing control parameter is the work @xmath0 carried out on the system along the particular trajectory @xmath20 : @xmath23=\\int^\\tau_0 dt\\ ; \\dot \\lambda(t ) \\left .",
    "\\frac{\\partial { \\cal h}}{\\partial \\lambda}\\right|_{x = x(t)},\\ ] ] where @xmath24 .",
    "this notation emphasizes that the work @xmath0 depends both on the specific trajectory followed by the system as well as on the particular protocol used to switch the control parameter . in path",
    "integral notation , the jarzynski equality can be written as : @xmath25 e^{-\\beta w[x(t ) , \\lambda(t)]}.\\ ] ] here , @xmath26 denotes a summation over all trajectories and @xmath27 $ ] is the probability density of trajectory @xmath20 , along which the work @xmath28 $ ] is performed during the switching process .",
    "the probability density @xmath27 $ ] includes the canonical distribution @xmath29/q_{\\lambda_a}$ ] of the initial conditions @xmath30 .",
    "for deterministic dynamics , the trajectory @xmath20 and the work @xmath28 $ ] are fully described by the initial point in phase space @xmath30 . in this case , the integral over all trajectories can be written as an integral over phase space rather than an integral over trajectory space . in the following",
    ", we will often omit the explicit dependence of @xmath31 $ ] and @xmath32 $ ] on @xmath33 to simplify the notation .",
    "the jarzynski equation ( [ equ : jarzynski_derivation ] ) justifies the following algorithm to estimate the free energy difference between the two equilibrium states @xmath11 and @xmath12 corresponding to @xmath13 and @xmath14 , respectively .",
    "first , one generates @xmath34 initial conditions canonically distributed with respect to @xmath35 .",
    "this can be done with monte carlo sampling or constant temperature molecular dynamics . from each of the @xmath34 initial condition @xmath36",
    "one then generates a trajectory of length @xmath19 by integrating the appropriate equations of motion and calculates the work @xmath37 performed on the system along that trajectory . from this sample of @xmath34 trajectories",
    "an estimate @xmath38 of the free energy is then determined : @xmath39 as the trajectory sample is finite , this free energy estimate contains errors @xcite that are discussed in detail in sec .",
    "[ sec : error ] . due to the highly non - linear behavior of the exponential function",
    "these errors may be severe , often precluding an accurate free energy calculation particularly in the case of large switching rates @xcite .",
    "the reason for these large deviations is best perceived by considering the work distribution @xmath40 : @xmath41 \\delta ( \\tilde w - w[x(t)]).\\ ] ] in terms of @xmath40 , the jarzynski equation can be rewritten as an integral over the work : @xmath42 in a fast switching simulation as described above , most trajectories have work values near the values for which @xmath40 is a maximum . for large switching rates ,",
    "@xmath40 may be centered at large work values , such that for typical work values @xmath43 is a very small number yielding a vanishing contribution to the integral in eq .",
    "( [ equ : integral ] ) . the work values leading to the important contributions to the integral ,",
    "on the other hand , may occur very rarely @xcite .",
    "this situation , familiar from the calculation of chemical potentials with widom s particle insertion method @xcite or from zwanzig s perturbation approach @xcite , may lead to extremely large statistical inaccuracies .",
    "these statistical difficulties can easily offset the advantage of using short , computationally inexpensive non - equilibrium trajectories .      to avoid large statistical errors occurring in the straightforward application of the jarzynski relation ,",
    "sun proposed a method based on a thermodynamic integration in trajectory space @xcite .",
    "the basic idea of this method is to introduce a bias that favors the sampling of the rare but important trajectories that mostly contribute to the exponential work average .",
    "this is done by introducing a free energy @xmath44 that depends on the parameter @xmath45 : @xmath46e^{-\\beta \\alpha w[x(t)]}. \\label{equ : falpha}\\ ] ] for @xmath47 , the parameter dependent free energy vanishes because @xmath32 $ ] is normalized , @xmath48 . for @xmath49 , on the other hand",
    ", the parameter dependent free energy is identical to the original free energy , @xmath50 .",
    "one can therefore calculate @xmath1 by taking the derivative of @xmath44 and integrating it from @xmath51 to @xmath52 : @xmath53 to carry out this procedure , which is the path space version of the thermodynamic integration method @xcite , one needs the derivative of @xmath44 with respect to @xmath45 : @xmath54 e^{-\\beta \\alpha w[x(t)]}w[x(t)]}{\\int\\!\\mathcal{d}x(t){\\cal p}[x(t)]e^{-\\beta \\alpha w[x(t)]}}.\\ ] ] the right hand side of this equation can be viewed as the average @xmath55 of @xmath31 $ ] over the work biased path ensemble @xmath56={\\cal p}[x(t)]e^{-\\beta \\alpha w[x(t ) ] } / z_\\alpha , \\label{equ : pwork}\\ ] ] where @xmath57 e^{-\\beta \\alpha w[x(t)]}.\\ ] ] in terms of the work average @xmath55 , eq.([equ : intalpha ] ) can be rewritten as : @xmath58 to calculate the free energy difference @xmath1 using this equation it is first necessary to determine @xmath55 for different values of the parameter @xmath45 between 0 and 1 .",
    "then , the integral on the right hand side is determined numerically from these values .",
    "as shown by sun @xcite , path sampling techniques , originally developed to study rare but important events @xcite , can be used to sample the work biased ensemble and calculate the averages @xmath55 .    to understand why the work biased thermodynamic integration yields accurate free energy estimates , it is instructive to consider the work distributions @xmath59 in the work biased ensembles : @xmath60 \\delta ( \\tilde w - w[x(t ) ] ) \\nonumber \\\\   & = & \\frac{p(\\tilde w)\\exp(-\\beta \\alpha \\tilde w)}{\\int dw p(w)\\exp(-\\beta\\alpha w ) } \\label{equ : pw_work_biased}\\end{aligned}\\ ] ] for @xmath47 the parameter dependent work distribution equals the original work distribution : @xmath61 in the other limit , at @xmath49 , the parameter dependent work distribution is proportional to the integrand in eq .",
    "( [ equ : integral ] ) : @xmath62 for values of the parameter @xmath45 between 0 and 1 the work distribution in the work biased ensemble is intermediate between these two limiting cases . thus ,",
    "both the typical and the dominant work values are generated with comparable likelihood as @xmath45 is changed from 0 to 1 yielding a good statistical accuracy .      an alternative way to enhance the sampling of rare but important work values",
    "was recently proposed by ytreberg and zuckerman @xcite and athnes @xcite .",
    "the basic idea of this approach , called single - ensemble nonequilibrium path - sampling by ytreberg and zuckerman , is to introduce an explicit _ biasing function _ ( or _ umbrella function _ ) @xmath63 $ ] depending on the path @xmath20 . with this umbrella function the jarzynski equality ( [ equ : jarzynski ] )",
    "can be rewritten as : @xmath64\\pi[x(t)]\\left[\\frac{e^{-\\beta w[x(t ) ] } } { \\pi[x(t)]}\\right]}{\\int { \\cal d}x(t)\\ ; { \\cal p}[x(t)]\\pi[x(t ) ] \\left[\\frac{1}{\\pi[x(t)]}\\right ] } \\nonumber \\\\ & = & \\frac{\\langle e^{-\\beta w[x(t)]}/\\pi[x(t ) ] \\rangle_\\pi}{\\langle 1/\\pi[x(t)]\\rangle_\\pi}. \\end{aligned}\\ ] ] here , @xmath65 denotes an average over the biased path ensemble @xmath66=\\frac{{\\cal p}[x(t)]\\pi[x(t)]}{\\int { \\cal d}x(t)\\ ; { \\cal p}[x(t)]\\pi[x(t)]}.\\ ] ] for a path observable @xmath67 $ ] depending on the pathway @xmath20 the average in the biased path ensemble is given by : @xmath68 \\rangle_\\pi\\equiv \\frac { \\int { \\cal d}x(t)\\ ; { \\cal p}[x(t)]\\pi[x(t)]a[x(t ) ] } { \\int { \\cal d}x(t)\\ ; { \\cal p}[x(t)]\\pi[x(t)]}.\\ ] ] such averages can be calculated using path sampling techniques @xcite .",
    "since the umbrella function is introduced to guide the sampling to the relevant work values , it suffices to let @xmath63 $ ] depend on the work only , @xmath63=\\pi[w(x(t))]$ ] . in this case , the biased average of a function @xmath69 $ ] that also depends on the work only can be written as @xmath70 this expression will be useful in the next section , in which we discuss the statistical errors occurring in fast switching simulations .    in a work biased umbrella sampling simulation",
    "the choice of the umbrella function @xmath63 $ ] is crucial . to obtain a good accuracy in the free energy estimate ,",
    "it is necessary that the bias function has a good overlap with the unbiased work distribution @xmath40 as well as with the integrand of eq .",
    "( [ equ : integral ] ) , @xmath71 .",
    "ytreberg and zuckerman found that the umbrella function @xmath72 leads to considerable efficiency increases compared to the results of straightforward fast switching simulations .",
    "another possibility would be to carry out umbrella sampling simulations with partially overlapping windows @xcite .",
    "note that other non - boltzmann sampling techniques such as flat histogram sampling @xcite , multicanonical sampling @xcite , or parallel tempering @xcite may also be used to improve the convergence of the exponential average of the jarzynski equation .",
    "these techniques , however , are not considered in the present article .",
    "in this section we review the expressions required to estimate the statistical errors arising in fast switching simulations .",
    "while straightforward fast switching and work biased umbrella sampling can be treated in the same way , separate expressions are required for the work biased thermodynamic integration scheme .      to set the notation we reproduce here the expressions derived in ref .",
    "all expressions are valid both for work biased umbrella sampling as well as for straightforward fast switching .",
    "the latter case follows by setting the umbrella function equal to unity , @xmath63 = 1 $ ] .    for convenience",
    "we define @xmath73\\equiv \\frac{e^{-\\beta w[x(t)]}}{\\pi[x(t ) ] } \\quad \\mbox{and } \\quad y[x(t)]\\equiv \\frac{1}{\\pi[x(t)]}.\\ ] ] the free energy estimated according to eq .",
    "( [ equ : biasave ] ) from @xmath34 pathways is @xmath74 where @xmath75 and @xmath76 are averages over the @xmath34 trajectories of the simulation , @xmath77 here , @xmath78 and @xmath79 are the values of @xmath80 and @xmath81 associated with the @xmath82-th path sampled from the biased ensemble , @xmath83 $ ] .    due to the non - linearity of the logarithm ,",
    "this estimator for the free energy is biased , i.e. , the average over many realizations @xmath84 of the free energy estimator , @xmath85 differs from the true free energy difference .",
    "this deviation , @xmath86 is called the bias .",
    "in addition to this systematic deviation , the estimator @xmath38 is also affected by statistical errors which are quantified by the variance , @xmath87 ^ 2\\rangle= \\langle ( \\delta \\overline{f}_n)^2\\rangle - \\langle \\delta \\overline{f}_n\\rangle^2.\\ ] ] the total mean squared deviation of the estimator @xmath38 from the true free energy difference @xmath1 has contributions from the bias and the statistical error : @xmath88 ^ 2\\rangle = b_n^2+\\sigma_n^2\\ ] ] we now consider the limit of a large sample size @xmath34 and first calculate the bias @xmath89 . for large @xmath34 , the deviations @xmath90 and @xmath91 from their averages @xmath75 and @xmath76 , @xmath92 are small compared to @xmath93 and @xmath94 , respectively .",
    "expansion of the logarithm in eq .",
    "( [ equ : df_finite ] ) into a taylor series around @xmath95 and truncation after the quadratic term ( the linear terms vanish after averaging ) yields the bias @xmath96 , \\label{equ : bias_approx}\\ ] ] where the fluctuations @xmath97 and @xmath98 are given by @xmath99 interestingly , eq .",
    "( [ equ : bias_approx ] ) implies that the bias can be made to vanish by choosing an appropriate umbrella function .    for the variance @xmath100 and the mean squared error @xmath101 the taylor series of the logarithm in eq .",
    "( [ equ : df_finite ] ) can be truncated after the linear term . in this approximation",
    "the bias vanishes and the variance and the mean squared error are identical : @xmath102 .",
    "\\label{equ : epsilon}\\end{aligned}\\ ] ] in the absence of an umbrella function @xmath103 ( or , in other words , for @xmath104 ) these expressions describe the errors encountered in straightforward fast switching simulations and are identical to the ones derived in refs . @xcite and @xcite .",
    "all terms occurring in the above expressions for the bias @xmath89 , the variance @xmath100 , and the mean squared error @xmath101 can be calculated as integrals involving the work distribution @xmath40 : @xmath105,\\\\ \\langle y^2 \\rangle_\\pi & = & \\frac{1}{i}\\int dw\\ ; p(w)\\left[\\frac{1}{\\pi(w)}\\right],\\\\ \\langle xy \\rangle_\\pi & = & \\frac{1}{i}\\int dw\\ ; p(w ) \\left[\\frac{\\exp(-\\beta w)}{\\pi(w)}\\right ] .",
    "\\label{equ : integral_l}\\end{aligned}\\ ] ] in section [ sec : results ] we will use these equations to calculate the expected errors for two systems with analytically known work distributions .    in the following we will also consider the errors in the free energy if the process is carried out in reverse direction , i.e. , if the system starts from equilibrium initial conditions corresponding to the final value of the control parameter and the system evolves under a time - inverted switching protocol . in general , these errors differ from those of the forward process",
    ". however , in the case of umbrella sampling with bias @xmath106 the errors of the forward and reverse process are identical . to show this we consider the work distribution @xmath107 of the reverse process , which is related to the work distribution of the forward process by the crooks identity @xcite @xmath108 insertion of eq .",
    "( [ equ : crooks ] ) into eqs .",
    "( [ equ : integral_f ] ) to ( [ equ : integral_l ] ) yields @xmath109 here , @xmath110 and @xmath111 denote averages with umbrella function @xmath112 for the forward and the reverse process , respectively .",
    "thus , the fluctuations of @xmath80 in the forward process are identical to the fluctuations of @xmath81 in the reverse process and vice versa .",
    "the correlation term is the same for both directions . inserting these results into eq .",
    "( [ equ : epsilon ] ) one finally obtains @xmath113 i.e. , the mean squared errors for the forward and reverse process are identical . in the same way",
    "one can show that also for the @xmath114-bias the errors are the same in forward and reverse direction .    for straightforward fast switching eq .",
    "( [ equ : epsilon ] ) is very similar to an expression obtained recently by jarzynski that relates the number of trajectories required to obtain acceptable accuracy to the dissipative work of the reverse process @xcite .",
    "to establish this similarity we use eq .",
    "( [ equ : epsilon ] ) to determine the number @xmath115 of trajectories required to obtain a statistical error of thermal magnitude @xmath116 : @xmath117 using the crooks identity , eq .",
    "( [ equ : number ] ) can be written as @xmath118 where we have neglected the term -1 on the right hand side of eq .",
    "( [ equ : number ] ) ( in any interesting case @xmath34 is much larger than 1 ) . changing",
    "the integration variable from @xmath0 to @xmath119 one obtains : @xmath120 \\nonumber \\\\ & = & \\langle \\exp(\\beta w_r^d ) \\rangle_r , \\label{equ : diss}\\end{aligned}\\ ] ] where @xmath121 is the dissipative work for the reverse transformation and @xmath122 indicates an average over realizations of the reverse process .",
    "this equation implies that the number of fast switching trajectories required for an accurate free energy estimation depends on the work dissipated during the reverse process , as noted earlier by jarzynski @xcite .",
    "remarkably , for highest accuracy of the free energy estimate the process should be carried out in the direction that yields the larger exponential average of the dissipative work @xcite .",
    "of course , the same conclusion can be drawn from @xmath123 which also simply follows from eq .",
    "( [ equ : number ] ) and where @xmath124 is the dissipative work for the forward process .    to simplify eq .",
    "( [ equ : diss ] ) , one is tempted to replace the average of the exponential with the exponential of the average @xcite , @xmath125 where @xmath126 is the average dissipative work for the reverse process .",
    "this approximation , however , is not valid in general . as shown for an illustrative example in sec .",
    "[ sec : pulled ] , it is likely to underestimate the required number of trajectories that may be off by orders of magnitude from the true value .      according to eq .",
    "( [ equ : ti ] ) , sun s work biased thermodynamic integration method requires the calculation of an integral over the parameter @xmath45 . to determine this integral ,",
    "the average @xmath55 is first calculated for @xmath127 discrete values @xmath128 of the parameter @xmath45 between 0 and 1 in @xmath127 separate simulations .",
    "then , the integration is carried out numerically using for instance the trapezoidal or simpson s rule .",
    "imagine now that the average work @xmath55 is approximated by averaging over @xmath129 trajectories at each value of the parameter @xmath45 : @xmath130 here , the argument @xmath45 in @xmath131 indicates that the trajectories over which the average is carried out are sampled from the trajectory ensemble corresponding to the parameter @xmath45 . using the trapezoidal integration rule the estimate for the free energy is then given by @xmath132 where @xmath133 is the total number of trajectories generated in the simulation . neglecting errors in the numerical integration over @xmath45",
    "this free energy estimate is bias free : @xmath134 where we have used that @xmath135 . in the above equation the angular brackets @xmath136 denote an average over many independent realizations of the thermodynamic integration procedure .    to determine the variance @xmath137 of the free energy estimate , which in this case is equal to the mean squared error @xmath138",
    ", we note that the variance of a sum of random variables equals the sum of the variances of the individual variables .",
    "accordingly , the variance of @xmath38 is given by @xmath139 where @xmath140 ^ 2\\rangle\\ ] ] is the variance of the average @xmath141 at parameter value @xmath128 .",
    "for statistically independent work values this variance is given by @xmath142\\ ] ] rewriting the sum over @xmath143 in eq .",
    "( [ equ : variance_df ] ) as an integral over @xmath45 we finally obtain : @xmath144 d\\alpha.\\ ] ] note that here we have assumed that at each value of the parameter @xmath45 , the same number @xmath129 of trajectories are generated . to minimize the variance @xmath137 , however , it is advantageous to sample more trajectories at values of @xmath45 where the work variance is large and less where it is small .",
    "for simplicity we do not consider this case here .",
    "for a given work distribution @xmath40 the work variance in the work biased ensemble can be calculated from @xmath145 and @xmath146 by numerical integration of eq .",
    "( [ equ : var_dfn ] ) one can then calculate the variance @xmath137 of the free energy estimate @xmath38 .",
    "interestingly , also the error of the thermodynamic integration method for the reverse process is identical to that for the forward process .",
    "the average of an arbitrary function @xmath147 for a particular @xmath45 of the reverse process is @xmath148 inserting the crooks identity , eq .",
    "( [ equ : crooks ] ) , into eq .",
    "( [ equ : reverseaverage ] ) we obtain @xmath149 thus , the work variance for the forward process at @xmath45 is equal to the work variance for the reverse process at @xmath150 : @xmath151 integration over @xmath45 according to eq .",
    "( [ equ : var_dfn ] ) with a change of variables from @xmath45 to @xmath152 in the reverse case then demonstrates that the statistical errors for the forward and reverse process are indeed equal : @xmath153",
    "while the error obtained from a simulation with @xmath34 trajectories is an interesting quantity , the criterion most relevant for the practitioner is the computational cost required to achieve a given accuracy in the free energy . for the estimation of this cost one needs to take into account that long trajectories are computationally more expensive than short ones . in order to do that we note that for all algorithms studied here the error in the free energy can be written as : @xmath154 where @xmath155 is a constant that does not depend on the number of trajectories used in the calculation .",
    "hence the number @xmath115 of trajectories required to obtained an accuracy of @xmath116 in the free energy is given by @xmath156 here , we have set the target error to a value of @xmath116 because variations of the free energy much smaller than @xmath116 are irrelevant in most cases .",
    "since the computational cost of a trajectory is proportional to its length @xmath19 a meaningful definition of the computational cost is given by @xmath157 @xmath158 is the computational cost of a free energy calculation with accuracy @xmath116 measured in units of the computational cost to generate a trajectory of length @xmath159 .",
    "while for straightforward fast switching and umbrella sampling the computational cost is @xmath160,\\ ] ] for the work biased thermodynamic integration scheme is given by : @xmath161",
    "if the work distribution @xmath40 is known for a specific switching process , the equations of the previous sections can be used to determine the expected accuracy of the free energy calculated with the methods of sec .",
    "[ sec : methods ] .",
    "here we do that for two models , for which the work distributions are known analytically . in particular , we study the computational efficiency of these methods in terms of the computing time required to obtain a given accuracy in the calculated free energy .        the first model we consider is a particle in one dimension pulled through a viscous liquid at temperature @xmath8 by a harmonic trap with force constant @xmath162 moving at constant speed @xmath163 for a certain distance @xmath127 .",
    "the translation of the trap by the distance @xmath127 takes a time @xmath164 .",
    "the motion of the particle is modelled by a langevin equation in the overdamped limit with friction constant @xmath165 : @xmath166 where @xmath6 is the position of the particle and @xmath167 is a gaussian random variable uncorrelated in time , @xmath168 . for this model , mazonka and jarzynski",
    "have computed the work distribution analytically finding a gaussian distribution @xcite : @xmath169\\ ] ] with mean @xmath170\\ ] ] and variance @xmath171=\\frac{2}{\\beta}\\overline{w}. \\label{equ : wave}\\ ] ] since the free energy of the system does not depend on the position of the harmonic trap , @xmath172 for this transformation .",
    "the average work , however , is larger than zero due to the energy dissipated into the bath and only in the limit of infinitely slow switching does the average work vanish . for slow switching ,",
    "i.e. , for @xmath173 or @xmath174 , the average work is proportional to the pulling velocity , @xmath175 , as predicted by linear response theory . in the limit of infinitely fast switching",
    ", i.e. for @xmath176 or @xmath177 , the average work converges to a constant value , @xmath178 .",
    "accordingly , the variance @xmath179 for slow switching . in the fast switching regime",
    "the variance reaches a constant value , @xmath180 ( see fig . [",
    "fig : sig2 ] ) .",
    "all results shown in this section were obtained for @xmath181 , @xmath182 , @xmath183 and @xmath184 .     for a particle pulled through a viscous fluid by a harmonic trap moving at constant speed @xmath163 .",
    "the average work is given by @xmath185.,width=264 ]      for this model we have calculated the expected errors for straightforward fast switching ( i.e. , @xmath186 ) as well as for the two bias functions @xmath187 , and @xmath188 . the bias function @xmath187 was suggested by ytreberg and zuckerman and is designed to improve the sampling of low work values @xcite .",
    "some attention is needed when considering the umbrella function @xmath189 .",
    "since this function biases the simulation in a way to make the work distribution flat , @xmath189 can have the form @xmath190 only in a range with finite size .",
    "we therefore define @xmath191 the limits for this range , @xmath192 and @xmath193 , need to be selected such that all important work values are included in the sampling . of course , in the general case the work distribution @xmath40 required to implement the umbrella function @xmath188 is not known in advance .",
    "however , methods such as flat histogram sampling @xcite can be used to determine this bias iteratively . here , we study this case in order to evaluate the efficiency of the work biased umbrella sampling approach if a good umbrella function is available .    for the gaussian work distribution of the pulled harmonic oscillator and the bias functions considered here all integrals in eqs .",
    "( [ equ : integral_f ] ) to ( [ equ : integral_l ] ) can be computed analytically .",
    "these analytical expressions can then be used to calculate the expected errors for straightforward fast switching , @xmath194 work biased umbrella sampling with the exponential umbrella function @xmath195 , @xmath196 and with the umbrella function @xmath188 , @xmath197 here , the interval size @xmath198 depends on the selection of the limits @xmath193 and @xmath192 . as a measure for the interval @xmath199 in which the work distribution is required to be flat we use the distance between the maximum of the work distribution @xmath40 and the maximum of the jarzynski integrand @xmath71 . for the gaussian work distributions considered here this distance is @xmath200 and we set @xmath201 accordingly . with this choice ,",
    "the statistical error of the @xmath114 bias becomes : @xmath202 the expected errors are shown in fig .",
    "[ fig : gauss_err ] as a function of the switching rate @xmath163 . since in all expressions for the error the number @xmath34 of trajectories factors out in a simple way , we have represented @xmath203 as a function of @xmath163 in this figure .",
    "the number @xmath115 of trajectories required to obtaine an error of @xmath116 is related to @xmath204 simply by @xmath205 .    we also calculated the expected errors for sun s work biased thermodynamic integration scheme .",
    "direct evaluation of the work distribution @xmath59 [ see eq .",
    "( [ equ : pw_work_biased ] ) ] in the work biased ensemble shows that for a gaussian distribution @xmath40 the variance of the work biased distribution @xmath206 is the same for all values of @xmath45 . in this case",
    "( [ equ : var_dfn ] ) yields @xmath207 while the variance in the work biased ensemble does not change as a function of @xmath45 , the average work @xmath55 does : @xmath208 the expected errors for the work biased thermodynamic integration method are also shown in fig .",
    "[ fig : gauss_err ] as a function of the switching rate @xmath163 . while for straightforward fast switching and for umbrella sampling with exponential bias the mean squared error grows exponentially with the dissipative work , it increases with @xmath209 for the @xmath114 bias and linearly for thermodynamic integration .",
    "for the particle pulled through a viscous fluid as a function of switching rate @xmath163 obtained for straightforward fast switching ( fs ) , work biased thermodynamic integration ( ti ) , and work biased umbrella sampling with the umbrella functions @xmath210 and @xmath211 . here , @xmath181 , @xmath182 , @xmath183 and @xmath184 .",
    ", width=264 ]    as can be seen in fig .",
    "[ fig : gauss_err ] , in the slow switching regime the errors decrease with decreasing @xmath163 in all four cases . to linear approximation in @xmath163 , the error for straightforward fast switching , work biased umbrella sampling with the exponential bias @xmath195 , and work biased thermodynamic integration",
    "is identical and given by @xmath212 for work biased umbrella sampling with bias @xmath213 the error is smaller and the dependence on @xmath163 stronger : @xmath214 as one proceeds to larger switching rates , the error grows most rapidly for straightforward fast switching . for work biased umbrella sampling with the exponential umbrella function",
    "the growth is less pronounced and occurs at higher switching rates .",
    "for the two remaining cases ( work biased umbrella sampling with @xmath211 and work biased thermodynamic integration ) the growth of the error slows down rather then speeding up with increasing switching rate .",
    "since the work variance becomes constant for large @xmath163 , the error reaches a constant value in the fast switching regime in all four cases . in this limit",
    "we obtain @xmath215 for straightforward fast switching , @xmath216 for work biased thermodynamic integration , @xmath217 for work biased umbrella sampling with the exponential umbrella function @xmath195 and @xmath218 in the case where the umbrella function @xmath213 .",
    "note , in fig .",
    "[ fig : gauss_err ] , that these constant values may differ by orders of magnitude .",
    "for the particle pulled through a viscous fluid as a function of switching rate @xmath163 obtained for straightforward fast switching ( fs ) , work biased thermodynamic integration ( ti ) , and work biased umbrella sampling with the umbrella functions @xmath210 and @xmath211 .",
    "here , @xmath181 , @xmath182 , @xmath183 and @xmath184.,width=264 ]    the computational cost @xmath158 determined for the four algorithms studied here is shown as a function of the switching rate in fig .",
    "[ fig : gauss_err_nu ] . in the slow switching regime",
    "the computational cost becomes constant for straightforward fast switching , work biased umbrella sampling with exponential bias and work biased thermodynamic integration .",
    "this behavior indicates that in these cases running few long trajectories or many shorter trajectories yields the same efficiency .",
    "the situation is different for work biased umbrella sampling with the @xmath190 umbrella function . in this case , @xmath219 keeps decreasing for decreasing @xmath163 even in the slow switching regime . for larger switching rates straightforward fast switching and work biased umbrella sampling with exponential bias",
    "become very inefficient . in the other two cases , increasing the switching rate enhances the efficiency . with the appropriate bias",
    "the optimum efficiency is obtained in the instantaneous switching limit , in which case the path based sampling methods reduce to ordinary umbrella sampling and thermodynamic integration . thus , conventional free energy calculation methods are superior to fast switching methods for the model studied in this section .",
    "similar results have been obtained earlier for more complex models @xcite .",
    "in addition to the expected error also the bias @xmath89 is an important quantity determining the accuracy of a free energy calculation . according to eq .",
    "( [ equ : bias_approx ] ) the bias can be calculated using the expressions in eqs .",
    "( [ equ : integral_f ] ) to ( [ equ : integral_l ] ) . for the pulled particle with gaussian work distribution one obtains @xmath220 in the case of straightforward fast switching . as can be seen by direct evaluation of eq .",
    "( [ equ : bias_approx ] ) , all other algorithms are bias free , i.e. , @xmath221 , if the work distribution is gaussian .",
    "it is interesting that in the case of work biased sampling with exponential umbrella function , the property of vanishing bias is only given for the particular form @xmath195 . to be more specific",
    ", one can consider umbrella functions @xmath222 , where @xmath7 is a real number between 0 and 1 . in this case ,",
    "error and bias are given by @xmath223\\end{aligned}\\ ] ] and @xmath224,\\ ] ] respectively .",
    "the error @xmath101 from the above equation is a minimum for @xmath225 . for this value of the parameter",
    "@xmath7 the bias vanishes . in this sense",
    ", the umbrella function @xmath195 is the optimum umbrella function among all exponential functions of the form @xmath226 .",
    "note , however , that this property holds strictly only for processes with gaussian work distribution .",
    "we now briefly return to the question of whether in expression ( [ equ : diss ] ) for the number of trajectories required to obtain an error of about @xmath116 the average of the exponential can be safely replaced by the exponential of the average ( see eq .",
    "[ equ : wdiss ] ) . for the process considered in this section , the dissipative work as well as",
    "the work distributions are the same in the forward and reverse direction .",
    "furthermore , @xmath227 because @xmath228 .",
    "hence , eq . ( [ equ : diss ] ) reduces to : @xmath229 where we have used eq .",
    "( [ equ : wave ] ) which is valid only for gaussian work distributions .",
    "thus , in this case , the estimate @xmath230 may be off by orders of magnitude . if , for instance , the correct estimate is @xmath231 , replacing the average of the exponential with the exponential of the average yields an estimate too low by a factor of @xmath232 .        in this section , we will determine the efficiency of fast switching methods for the expansion of an ideal gas in a cylinder with moving piston .",
    "the work distribution for this process has been determined analytically by lua and grosberg @xcite , who demonstrated that the jarzynski identity holds exactly for arbitrary piston speed . in the limit of very rapid expansion",
    "this seems surprising as almost no gas particles collide with the piston performing work on it .",
    "nevertheless , as shown by lua and grosberg , the tails of the maxwell - boltzmann distribution provide a sufficient number of fast moving particles that perform exactly the amount of work required for the jarzynski identity to be valid .",
    "the reason why we study the ideal gas expansion here is that its work distribution is non - gaussian .",
    "as the system is not coupled to a heat bath during the transition , the work distribution remains non - gaussian even in the limit of a piston that moves infinitely slowly . in this case , the distribution is a rapidly fluctuating function with an exponential envelope . in the fast switching limit ,",
    "the work distribution acquires a growing delta - peak at zero work and small contributions at large work values .",
    "these large but rare work values are the dominant contributions to the exponential work average .    in their work ,",
    "lua and grosberg @xcite considered a single ideal gas particle in a cylinder with cross section area @xmath11 sealed by a piston on one side .",
    "the volume available to the gas particle is @xmath233 , where @xmath234 is the initial length of the cylinder . starting from initial conditions distributed canonically with temperature @xmath235 , the volume of the cylinder",
    "is then increased by moving the piston from position @xmath234 to a new position @xmath127 in a time @xmath19 with constant velocity @xmath236 .",
    "the ideal gas particle is assumed to collide elastically with the walls of the cylinder and the moving piston . at each elastic collision of the particle with the piston ,",
    "a certain amount of kinetic energy is transferred from the particle to the piston .",
    "this adiabatic case is in contrast to that considered in ref .",
    "@xcite , where the system is coupled to a thermal bath and the velocities are taken from an equilibrium distribution at each collision with the piston .",
    "the sum of these energy transfers during one expansion is the work @xmath0 carried out by the gas .",
    "note that here , as in lua and grosberg s work , @xmath0 denotes the work done _ by _ the system and not _ on _ the system .",
    "accordingly , we let @xmath237 denote the free energy difference between the initial and the final state .",
    "the maximum work theorem then implies that the average work performed by the system is bounded from above by the free energy difference , @xmath238 . with this sign convention ,",
    "the jarzynski equality is given by @xmath239 .",
    "lua and grosberg have analyzed the statistics of the particle - piston collisions in detail for the special case of inverse temperature @xmath240 , mass of the particle @xmath241 and switching time @xmath242 . in this paper",
    "we keep the explicit dependence on all variables and obtain the following work distribution : @xmath243 where @xmath244 is the probability that the particle does not collide with the moving piston during the expansion process .",
    "this probability increases with increasing piston velocity @xmath245 leading to a growing delta - peak at @xmath246 in the work distribution .",
    "as shown by lua and grosberg , the number @xmath247 of collisions between the moving ideal gas particle and the piston is completely determined by the work @xmath0 done by the gas during the entire expansion and is given by : @xmath248 where @xmath249 indicates the floor function that gives the largest integer less or equal to the argument .",
    "the function @xmath250 appearing in eq .",
    "( [ equ : pw_gas ] ) , called the overlap factor by lua and grosberg , is given by the piecewise linear function    @xmath251    a variation of the piston velocity @xmath245 is equivalent to a variation of the temperature in the sense of the following scaling relation : @xmath252 this equation , which can be easily derived directly from eq .",
    "( [ equ : pw_gas ] ) , holds , because due to the elastic hard collisions the same sequence of events occurs if both @xmath163 and @xmath245 are scaled by the same factor .",
    "( solid red line ) performed _ by _ the ideal gas during the expansion as a function of the piston velocity @xmath245 for @xmath253 , @xmath254 and @xmath255 .",
    "also shown is the work done _ on _ the ideal gas during the compression ( solid green line ) .",
    "the free energy difference @xmath256=\\log(2)$ ] is shown as a dashed line . for @xmath257",
    ", the average work converges towards @xmath258=0.375$].,width=264 ]    the average work @xmath259 performed during the expansion of the cylinder from @xmath234 to @xmath260 calculated from the work distribution eq .",
    "( [ equ : pw_gas ] ) by numerical integration is shown in fig .",
    "[ fig : figmeanworkjarzynski ] .",
    "it is clear from the picture that the average work @xmath261 is lower than the free energy difference @xmath262 $ ] even in the limit of infinitely slow switching . in this limit",
    ", the process studied by lua and grosberg can be viewed as the quasistatic adiabatic expansion of an ideal gas where the average work follows from basic thermodynamic equations for the ideal gas : @xmath263 , \\end{aligned}\\ ] ] where @xmath264 and @xmath265 is the number of degrees of freedom . in our one - dimensional case , @xmath266 and @xmath267 such that @xmath268 for fast switching , on the other hand , the average work converges to zero because less and less collisions of the moving particle with the piston occur as the piston velocity is increased .",
    "nevertheless , the jarzynski equality holds over the whole range of piston velocities as can be directly verified from eq .",
    "( [ equ : pw_gas ] ) .    in the slow switching limit , i.e. , for @xmath269 , the work distribution",
    "can also be obtained by considering adiabatic invariants @xcite . for a one - dimensional mechanical system the principle of adiabatic invariance states that the action variable @xmath270 is conserved under slow variation of an external parameter in the hamiltonian . in the above equation",
    "the contour integral extends over one period of the motion for constant energy @xmath271 . for the lua - grosberg model",
    "this relation implies that the quantity @xmath272 is conserved during a slow , i.e. , adiabatic , transformation of the hamiltonian . as a consequence , the energy @xmath273 of the system at the end of an expansion from @xmath234 to @xmath127 is a unique function of the initial energy @xmath274 : @xmath275 thus , the work carried out by the gas starting from any initial condition with energy @xmath274 is given by @xmath276 $ ] .",
    "the work distribution in the slow switching limit can then be obtained as average over the canonically distributed initial conditions : @xmath277.\\end{aligned}\\ ] ] integration yields @xmath278 which is the one - particle one - dimensional special case of the work distribution derived by crooks and jarzynski for an ideal gas of @xmath34 particles @xcite .",
    "it is easy to verify directly that for this work distribution that the jarzynski equality holds and the average work @xmath279 performed by the gas is given by eq .",
    "( [ equ : work_adiabatic ] ) .",
    "note that even tough the expansion occurs infinitely slowly in this case , the work distribution is not gaussian and the width @xmath280 and the average @xmath261 of the work distribution are related by @xmath281 rather than by eq .",
    "( [ equ : wave ] ) .    in the fast switching limit ,",
    "i.e. , for @xmath282 , only trajectories with 0 or 1 collision yield important contributions to the work distribution . in this case , one obtains @xcite : @xmath283 where @xmath284 is given by @xmath285 in the following paragraphs we will also consider the statistical errors for the reverse process , namely the compression of the ideal gas from the cylinder length @xmath286 to @xmath234 .",
    "the work distribution @xmath107 for the reverse process is simply given by the crooks relation eq .",
    "( [ equ : crooks ] ) , which , with the sign conventions for @xmath0 and @xmath1 used in this section reads : @xmath287      we next determine the efficiency of fast switching methods for the ideal gas expansion from @xmath234 to @xmath286 as well as for the compression from @xmath286 to @xmath234 . in this case",
    ", we investigate the straight forward approach , biased sampling with @xmath288 umbrella function , and thermodynamic integration .",
    "we do not , however , consider the @xmath114 bias here , because the work distribution for the ideal gas expansion includes a @xmath289-peak that creates problems in this case .",
    "when estimating statistical errors of fast switching simulations another difficulty arises in some situations . as detailed in sec .",
    "[ sec : error ] , the mean square error @xmath290 as well as the bias @xmath89 can be calculated from integrals over the work distribution . in the case of the ideal gas expansion , however , some of the integrals from eqs .",
    "( [ equ : integral_f])-([equ : integral_l ] ) diverge for certain expansion ratios . to see this ,",
    "consider the mean square error estimated for a straightforward fast switching simulation using the sign convention of this section : @xmath291 the average @xmath292 exists only if the work distribution @xmath40 decays sufficiently rapidly with increasing w to compensate for the fast growth of @xmath293 .",
    "for large work values @xmath0 , the work distribution for the ideal gas expansion behaves as @xmath294,\\ ] ] where we have neglected all factors that are immaterial for the convergence of the integral .",
    "thus , @xmath295 is finite only if @xmath296 or , equivalently , if the ideal gas is expanded by no more than a factor of @xmath297 , @xmath298 .",
    "if this condition , which is independent of the switching rate , is not met , @xmath299 has infinite variance and the expressions from sec .",
    "[ sec : error ] can not be applied to estimate the statistical error of the free energy estimate . in this case",
    ", a generalization of the law of large numbers @xcite still guarantees that the free energy converges to the correct value , but the fat - tailed work distribution prevents gaussian statistics from arising even for large sample sizes .    for umbrella sampling with the exponential bias @xmath288 a similar analysis of the average",
    "@xmath300 reveals that the corresponding integral converges only provided that @xmath301 . for larger expansion ratios , the integral diverges for any switching rate .",
    "in contrast , the integrals associated with the thermodynamic integration scheme always converge regardless of the expansion ratio @xmath302 and the switching rate .",
    "the situation is slightly different for the ideal gas compression . in this case ,",
    "straightforward fast switching yields error estimates that are finite for any expansion ratio . since for umbrella sampling with exponential bias @xmath288 and thermodynamic integration",
    "the errors in forward and backward direction are identical , the same limitations as for the ideal gas expansion apply in these cases .    in the following",
    "we will study the efficiency for expansion ratios of @xmath303 and @xmath304 . for @xmath303",
    "the error estimates for all fast switching methods are finite both for the expansion and the compression .",
    "for @xmath305 we consider only the thermodynamic integration method and straightforward fast switching for the ideal gas compression .",
    "all other methods yield diverging error estimates for this expansion ratio .     as a function of the piston velocity @xmath245 for different fast switching methods and an expansion ratio of @xmath303 .",
    "the black lines denote the straight forward fast switching errors for expansion ( solid line ) and compression ( dashed line).,width=264 ]    figure [ fig : figerrorgrosberg ] shows the errors as a function of the piston velocity @xmath245 obtained by numerical integration of eqs .",
    "( [ equ : integral_f])-([equ : integral_l ] ) for an expansion from @xmath306 to @xmath307 . here and in the subsequent calculations the inverse temperature of the initial state was @xmath240 . for infinitely slow and infinitely fast switching the errors can be calculated analytically and were found to agree perfectly with the results obtain by numerical integration . as can be seen in fig .",
    "[ fig : figerrorgrosberg ] , the errors become independent of the switching rate @xmath245 for all three methods in the slow switching limit . in the fast switching limit , the error grows rapidly with @xmath245 particularly for straightforward fast switching and the exponential bias .",
    "the thermodynamic integration scheme , for which the growth is slower , yields smaller errors for all switching rates .",
    "for all three cases the errors diverge for @xmath308 .",
    "the overall smallest errors , however , are obtained if the reverse process , i.e. , the compression , is simulated with straightforward fast switching ( dashed line in fig .",
    "[ fig : figerrorgrosberg ] ) . in the fast switching limit",
    "this error becomes @xmath309 .",
    "since the initial position of the particle is uniformly distributed in the interval @xmath310 $ ] , this value is simply the probability that the fast moving piston hits the particle at least once . note that for thermodynamic integration and umbrella sampling with the exponential bias the errors are identical for expansion and compression .    from the errors depicted in fig .",
    "[ fig : figerrorgrosberg ] one can determine the computational cost required to obtain an accuracy of @xmath116 in the free energy estimate [ see eq .",
    "( [ equ : ccpu ] ) ] .",
    "this computational cost is shown in fig .",
    "[ fig : figccpugrosberg ] for different fast switching methods and an expansion ratio of @xmath303 as a function of the switching rate . for straightforward fast switching in the expansion direction , thermodynamic integration and umbrella sampling with the exponential bias an optimum switching rate of about @xmath311 exists . in the case of straightforward fast switching in the compression direction ,",
    "however , no such minimum exists and the computational cost keeps decreasing for increasing switching rate .     as a function of the switching rate @xmath245 for different fast switching methods and and expansion ratio of @xmath303 .",
    "the black lines denote the straight forward fast switching errors for expansion ( solid line ) and compression ( dashed line ) .",
    ", width=264 ]    as explained above , for an expansion ratio of @xmath305 our expressions yield finite statistical errors only for the thermodynamic integration method and for straightforward fast switching in the compression direction . the errors for these cases are shown in fig .",
    "[ fig : figerrorgrosbergl2 ] . straightforward fast switching of the ideal gas compression yields errors that are smaller than the thermodynamic integration errors for all piston velocities .",
    "both in the slow and fast switching limit the straightforward fast switching errors become constant . accordingly , the computational cost of the straightforward compression is decreasing as @xmath312 in the fast switching limit while the thermodynamic integration error goes through a minimum at about @xmath313 and then rapidly grows for increasing piston velocity @xmath245 ( see fig .",
    "[ fig : figccpugrosbergl2 ] ) .",
    "thus both for @xmath303 and @xmath304 the straightforward fast switching simulation of the ideal gas compression is the most efficient among the methods studied here .",
    "however , optimum efficiency is obtained for infinitely fast compression , in which case straightforward fast switching reduces to zwanzig s perturbative approach applied to configurations rather than trajectories @xcite .     as a function of the piston velocity @xmath245 for the ideal gas expansion / compression with an expansion ration of @xmath304 .",
    "the dashed black line denotes the straightforward fast switching errors ( fs ) and the solid red line the thermodynamic integration errors ( ti).,width=264 ]     as a function of the switching rate @xmath245 for the ideal gas expansion / compression with an expansion ratio of @xmath305 .",
    "the dashed black line denotes the straight forward fast switching results ( fs ) for the compression and the solid red line the thermodynamic integration results ( ti ) .",
    ", width=264 ]      the model discussed in the previous section consisted of a single particle in one dimension . in this section",
    ", we study the expansion of an ideal gas of @xmath129 particles and analyze how the error depends on the number of particles .",
    "the system of strictly non - interacting particles considered here is similar , but not identical to the dilute gas of weakly interacting particles studied by jarzynski and crooks in ref .",
    "for the @xmath129-particle ideal gas , the work performed on the piston during the expansion is the sum of the contributions of each particle . @xmath314 here @xmath315 is the work performed on the system by particle @xmath82 .",
    "according to eq .",
    "( [ equ : epsilon ] ) , the statistical error in the free energy calculated with straightforward fast switching from @xmath34 repetitions of the process is given by @xmath316.\\ ] ] for the @xmath129-particle system , the averages @xmath317 and @xmath318 are @xmath319 and @xmath320 where @xmath321 and @xmath322 are the corresponding averages of the one - particle system .",
    "here , we have used the fact that work contributions of the single particles are identical and statistically independent .",
    "the error @xmath323 for the @xmath129-particle system becomes @xmath324.\\ ] ] the fraction @xmath325 is always larger than 1 and therefore the error @xmath326 diverges exponentially with the particle number in the case of straightforward fast switching .",
    "a similar analysis can be carried out for the error of work biased umbrella sampling simulations .",
    "for an umbrella function @xmath327 that factorizes into a product of single particle umbrella functions @xmath328 ( this is for instance the case for the exponential bias @xmath329 ) , @xmath330 the error is given by : @xmath331.\\end{aligned}\\ ] ] here , as in the previous paragraph , the averages are single - particle averages . for large @xmath129 , this expression will be dominated by either @xmath332 or @xmath333 depending on whether @xmath334 or @xmath335 is larger .",
    "( it is easy to see that the larger one of @xmath334 and @xmath335 is also larger than @xmath336 , which is always positive . ) thus , also in this case , the error in the free energy grows exponentially with the system size @xmath129 .    for the work biased thermodynamic integration the error results from an integral over the work variance at different values of an auxiliary parameter @xmath45 ( see eq .",
    "( [ equ : var_dfn ] ) ) . since in the @xmath129-particle ideal gas",
    "the work @xmath0 is a sum of @xmath129 independent contributions , the work variance of the entire system is @xmath129 times the single particle work variance for each value of @xmath45 .",
    "hence , the @xmath129-particle error @xmath337 scales with the square root of the number of particles , @xmath338 where @xmath339 is the error for the one - particle gas .",
    "due to this kind of scaling , the thermodynamic integration method is superior to all other fast switching methods studied here for a strictly non - interacting ideal gas .",
    "for irreversible transformations , the exponential average of eq .",
    "( [ equ : jarzynski ] ) is dominated by rare , but important work values causing possibly large statistical inaccuracies in fast switching free energy computations .",
    "several path sampling methods have proposed that aim at reducing these inaccuracies by enhanced sampling of those trajectories that contribute most to the average . in this paper",
    ", we investigate how these methods perform in the case of two simple models for which the work distribution is known analytically .    for gaussian work distributions ,",
    "the computational effort required to achieve a given accuracy in the free energy can be determined analytically . in the case of a particle pulled through a viscous fluid , flat histogram sampling as well as sun s work biased thermodynamic integration",
    "perform best . for both methods optimum efficiency",
    "is obtained in the limit of infinitely fast switching in which case these path sampling methods reduce to conventional flat histogram sampling and thermodynamic integration in configuration space rather than in trajectory space .",
    "the errors obtained in the case of the ideal gas expansion / compression , for which the work distribution was determined analytically by lua and grosberg @xcite , show a qualitatively different behavior .",
    "in contrast to the particle pulled through a fluid , the work distribution for the expansion / compression process does not approach a constant shape in the fast switching limit . rather , the work distribution keeps changing even for very large piston velocities . as a consequence",
    ", the computational cost of all methods goes through a minimum for intermediate piston velocities and grows for rapid expansion .",
    "the only exception here is the straightforward fast switching simulation of the gas compression , which is superior to the path sampling methods for all piston speeds . in this case , the computational cost keeps decreasing even for very large piston speeds where the fast switching simulation reduces to zwanzig s perturbative approach .",
    "it is interesting that for certain expansion ratios only thermodynamic integration and straightforward fast switching of the compression process yield finite error estimates , while all other method yield diverging errors .",
    "this behavior is due to the fat tails of the work distribution that occur for larger expansion ratios .",
    "the superiority of straightforward fast switching for the ideal gas compression is most likely peculiar to the one - particle case . in the many - particle gas , the errors scale exponentially with particle number for all methods except for thermodynamic integration , in which case they scale with the square root of the particle number .",
    "thus , for an ideal gas consisting of many particles sun s work biased thermodynamic integration method seems to offer the most efficient free energy calculations . since for this method",
    "the efficiency is maximum at intermediate piston velocities , this is an example where a fast switching method for the calculation of free energies is more efficient than conventional configuration space methods .",
    "in general , the efficiency of a fast switching simulation depends on whether the process is carried out in forward or reverse direction .",
    "in particular , a straightforward fast switching simulation is more efficient in the direction in which more work is dissipated @xcite as confirmed here for the lua - grosberg ideal gas expansion and compression .",
    "for all the path sampling methods studied here , however , it can be shown using the crooks identity that the work distribution is effectively symmetrized in a way that makes the corresponding efficiency identical in both directions .    in summary ,",
    "path sampling methods such as work biased thermodynamic integration or work biased umbrella sampling may help to reduce the statistical errors encountered in the calculation of equilibrium free energies from non - equilibrium simulations .",
    "the examples studied in this paper indicate that often conventional free energy estimation methods are likely to be superior to fast switching simulation",
    ". nevertheless , advanced fast switching methods such as sun s work biased thermodynamic integration may be competitive particularly if a large number of degrees of freedom significantly contribute to the free energy change that one wants to compute .",
    "this work was initiated during a junior fellowship of w.l . at the international erwin schrdinger institute for mathematical physics ( esi ) and completed with support from the austrian science fund ( fwf ) under grant no .",
    "the authors acknowledge useful discussions with phillip geissler and elisabeth schll - paschinger ."
  ],
  "abstract_text": [
    "<S> according to the jarzynski theorem , equilibrium free energy differences can be calculated from the statistics of work carried out during non - equilibrium transformations . </S>",
    "<S> although exact , this approach can be plagued by large statistical errors , particularly for systems driven strongly away from equilibrium . </S>",
    "<S> recently , several approaches have been suggested to reduce these errors . in this paper </S>",
    "<S> we study the efficiency of these methods using two models for which analytical solutions exist . </S>"
  ]
}