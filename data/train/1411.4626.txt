{
  "article_text": [
    "shape - constrained estimation has received much attention recently .",
    "the attraction is the prospect of obtaining automatic nonparametric estimators with no smoothing parameters to choose .",
    "convexity is among the popular shape constraints that are of both mathematical and practical interest .",
    "@xcite show that under the convexity constraint , the least squares estimator ( lse ) can be used to estimate both a density and a regression function . for density estimation",
    ", they showed that the lse @xmath1 of the true convex density @xmath2 converges pointwise at a @xmath3 rate under certain assumptions .",
    "the corresponding asymptotic distribution can be characterized via a so - called `` invelope '' function investigated by @xcite . in the regression setting ,",
    "similar results hold for the lse @xmath4 of the true regression function @xmath5 .    however , in the development of their pointwise asymptotic theory , it is required that @xmath2 ( or @xmath5 ) has positive second derivative in a neighborhood of the point to be estimated .",
    "this assumption excludes certain convex functions that may be of practical value .",
    "two further scenarios of interest are given below :    * at the point @xmath6 , the @xmath7-th derivative @xmath8 ( or @xmath9 ) for @xmath10 and @xmath11 ( or @xmath12 ) , where @xmath13 is an integer greater than one ; * there exists some region @xmath14 $ ] on which @xmath2 ( or @xmath5 ) is linear .",
    "scenario  1 can be handled using techniques developed in @xcite .",
    "the aim of this manuscript is to provide theory in the setting of scenario  2 .",
    "we prove that for estimation of a convex density when scenario  2 holds , at any fixed point @xmath15 , the lse @xmath16 converges pointwise to @xmath17 at a @xmath0 rate .",
    "its ( left or right ) derivative @xmath18 converges to @xmath19 at the same rate .",
    "the corresponding asymptotic distributions are characterized using a modified invelope process .",
    "more generally , we show that the processes @xmath20\\big\\}$ ] and @xmath21\\big\\}$ ] both converge weakly for any @xmath22 .",
    "we remark that unlike the case of @xcite , these processes are not local , because intuitively speaking , the linear behavior of the true function is non - local , which requires linearity on an interval with positive length .",
    "in addition , there does not exist a `` universal '' distribution of @xmath1 on @xmath23 , i.e. the pointwise limit distributions at different points are in general different .",
    "in addition , we show that the derived asymptotic processes can be used in a more practical setting where one would like to perform tests on the linearity against a convex alternative",
    ". moreover , we study the adaptation of the lse @xmath1 at the boundary points of the linear region ( e.g. @xmath24 and @xmath25 ) .",
    "note that the difficulty level of estimating @xmath26 and @xmath27 depends on the behavior of @xmath2 outside @xmath14 $ ] .",
    "nevertheless , we show that @xmath28 ( or @xmath29 ) converges to @xmath26 ( or @xmath27 ) at the minimax optimal rate up to a negligible factor of @xmath30 .",
    "last but not least , we establish the analogous rate and asymptotic distribution results for the lse @xmath4 in the regression setting .",
    "our study yields a better understanding of the adaptation of the lse in terms of pointwise convergence under the convexity constraint .",
    "it is also one of the first attempts to quantify the behavior of the convex lse at non - smooth points .",
    "when the truth is linear , the minimax optimal @xmath0 pointwise rate is indeed achieved by the lse on @xmath23 . the optimal rate at the boundary points @xmath24 and @xmath25 is also achievable by the lse up to a log - log factor .",
    "these results can also be applied to the case where the true function consists of multiple linear components .",
    "furthermore , our results can be viewed as an intermediate stage for the development of theory under misspecification .",
    "note that linearity is regarded as the boundary case of convexity : if a function is non - convex , then its projection to the class of convex functions will have linear components .",
    "we conjecture that the lse in these misspecified regions converges at an @xmath0 rate , with the asymptotic distribution characterized by a more restricted version of the invelope process .",
    "more broadly , we expect that this type of behavior will be seen in situations of other shape restrictions , such as log - concavity for @xmath31 @xcite and @xmath7-monotonicity @xcite .",
    "the lse of a convex density function was first studied by @xcite , where its consistency and some asymptotic distribution theory were provided . on the other hand , the idea of using the lse for convex regression function estimation dates back to @xcite .",
    "its consistency was proved by @xcite , with some rate results given in @xcite . in this manuscript , for the sake of mathematical convenience , we shall focus on the non - discrete version discussed by @xcite .",
    "see @xcite for the computational aspects of all the above - mentioned lses .",
    "there are studies similar to ours regarding other shape restrictions .",
    "see remark  2.2 of @xcite and @xcite in the context of decreasing density function estimation ( a.k.a .",
    "grenander estimator ) when the truth is flat and @xcite with regard to discrete log - concave distribution estimation when the true distribution is geometric .",
    "in addition , @xcite studied the grenander estimator s global behavior in the @xmath32 norm under the uniform distribution and gave a connection to statistical problems involving combination of @xmath33-values and two - sample rank statistics , while @xcite studied the adaptivity of the lse in monotone regression ( or density ) function estimation . for estimation under misspecification of various shape constraints , we point readers to @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "more recent developments on global rates of the shape - constrained methods can be found in @xcite , @xcite , and @xcite .",
    "see also @xcite and @xcite where an additive structure is imposed in shape - constrained estimation in the multidimensional setting .",
    "the rest of the paper is organized as follows : in section  [ sec : density ] , we study the behavior of the lse for density estimation . in particular , for notational convenience , we first focus on a special case where the true density function @xmath2 is taken to be triangular . the convergence rate and asymptotic distribution are given in section  [ sec : densityrate ] and section  [ sec : densityasym ] .",
    "section  [ sec : test ] demonstrates the practical use of our asymptotic results , where a new consistent testing procedure on the linearity against a convex alternative is proposed .",
    "more general cases are handled later in section  [ sec : densityext ] based on the ideas illustrated in section  [ sec : densityspecial ] .",
    "section  [ sec : densityadapt ] discusses the adaptation of the lse at the boundary points .",
    "analogous results with regard to regression function estimation are presented in section  [ sec : regress ] .",
    "some proofs , mainly on the existence and uniqueness of a limit process and the adaptation of the lse , are deferred to the appendices .",
    "given @xmath34 independent and identically distributed ( iid ) observations from a density function @xmath35 .",
    "let @xmath36 be the corresponding distribution function ( df ) . in this section ,",
    "we denote the convex cone of all non - negative continuous convex and integrable functions on @xmath37 by @xmath38 .",
    "the lse of @xmath2 is given by @xmath39 where @xmath40 is the empirical distribution function of the observations .",
    "furthermore , we denote the df of @xmath1 by @xmath41 .    throughout the manuscript , without specifying otherwise , the derivative of a convex function can be interpreted as either its left derivative or its right derivative .      to motivate the discussion , as well as for notational convenience , we take @xmath42}(t)$ ] in section  [ sec : densityrate ] and section  [ sec : densityasym ] .",
    "extensions to other convex density functions are presented in section  [ sec : densityext ] .",
    "consistency of @xmath1 over @xmath43 in this setting can be found in @xcite .",
    "@xcite has shown how @xmath1 can be used to provide consistent estimators of @xmath44 and @xmath45 .    here",
    "we concentrate on the lse s rate of convergence and asymptotic distribution .",
    "the following proposition shows that the convergence rate at any interior point where @xmath2 is linear is @xmath0 , thus achieving the optimal rate given in example  1 of @xcite .",
    "[ thm : ls_triangular_rate ] suppose @xmath42}(t)$ ] . then for any fixed @xmath46 , @xmath47    of theorem  [ thm : ls_triangular_rate ] a key ingredient of this proof is the version of marshall s lemma in this setting ( * ? ? ?",
    "* theorem 1 ) , which states that @xmath48 where @xmath49 is the uniform norm .",
    "let @xmath50 .",
    "two cases are considered here : ( a ) @xmath51 and ( b ) @xmath52 .    in the first case , because @xmath1 is convex , one can find a supporting hyperplane of @xmath1 passing through @xmath53 such that @xmath54 where @xmath7 is a negative slope . if @xmath55 , then @xmath56 .",
    "otherwise , @xmath57 .",
    "figure  [ fig : greater ] explains the above inequalities graphically .",
    "consequently , @xmath58 .",
    "@xmath59{plot1.pdf } &    \\includegraphics[scale=0.37]{plot2.pdf } \\\\",
    "\\mathrm{(a ) } & \\mathrm{(b ) }     \\end{array}$ ]    @xmath59{plot3.pdf } &    \\includegraphics[scale=0.37]{plot4.pdf } \\\\",
    "\\mathrm{(a ) } & \\mathrm{(b ) }     \\end{array}$ ]    in the second case , if we can find @xmath60 such that @xmath1 and @xmath2 intersect at the point @xmath61 , then @xmath62 otherwise , by taking @xmath63 , we can still verify that the above two inequalities hold true .",
    "figure  [ fig : smaller ] illustrates these findings graphically .",
    "therefore , @xmath64 where the last inequality uses the fact that for any @xmath65 , @xmath66 is an increasing function of @xmath67 while @xmath68 is a decreasing function of @xmath67 .    by",
    "( [ eq : marshall ] ) , we have that @xmath69    it then follows that @xmath70 , as desired .",
    "@xmath71    [ cor : ls_triangular_uniform_rate ] for any @xmath72 , @xmath73 } |\\hat{f}_n(x ) - f_0(x)| = o_p(n^{-1/2}).\\ ] ]    of corollary  [ cor : ls_triangular_uniform_rate ] a closer look at the proof of theorem  [ thm : ls_triangular_rate ] reveals that we have @xmath74 simultaneously for every @xmath75 $ ]",
    ". therefore , @xmath76}\\min\\left ( 2x,2 - 2x,\\frac{x}{4}\\right ) \\sup_{x \\in [ \\delta , 1-\\delta]}|\\hat{f}_n(x ) - f_0(x)|.\\ ] ] consequently , @xmath77}|\\hat{f}_n(x ) - f_0(x)|$ ] is @xmath78",
    ". @xmath71    let @xmath79 and @xmath80 denote respectively the left and right derivatives of @xmath1 .",
    "the same convergence rate also applies to these derivative estimators .",
    "[ cor : ls_triangular_uniform_rate_derivative ] for any @xmath72 , @xmath73 } \\max \\left(|\\hat{f}^-_n(x ) - f_0'(x)| , |\\hat{f}^+_n(x ) - f_0'(x)| \\right ) = o_p(n^{-1/2}).\\ ] ]    of corollary  [ cor : ls_triangular_uniform_rate_derivative ] by the convexity of @xmath1 , @xmath81 } \\max \\left(|\\hat{f}^-_n(x ) - f_0'(x)| , |\\hat{f}^+_n(x ) - f_0'(x)|\\right ) \\\\      & \\le \\max \\left(|\\hat{f}^-_n(\\delta)- f_0'(\\delta)| , |\\hat{f}^+(1-\\delta ) - f_0'(1-\\delta)|\\right ) \\\\      &",
    "\\le \\frac{2}{\\delta } \\max \\big(\\big|\\hat{f}_n(\\delta ) - \\hat{f}_n(\\delta/2 ) -   f_0(\\delta ) + f_0(\\delta/2)\\big| , \\\\      & \\qquad \\qquad \\qquad\\big|\\hat{f}_n(1- \\delta/2 ) -",
    "\\hat{f}_n(1-\\delta ) -   f_0(1- \\delta/2 ) + f_0(1-\\delta)\\big| \\big ) \\\\      & = o_p(n^{-1/2}),\\end{aligned}\\ ] ] where the final equation follows from corollary  [ cor : ls_triangular_uniform_rate ] .",
    "@xmath71      to study the asymptotic distribution of @xmath1 , we start by characterizing the limit distribution .",
    "[ thm : triangular_limit ] let @xmath82 and @xmath83 for any @xmath84 , where @xmath85 is a standard brownian bridge process on @xmath86 $ ] .",
    "then almost surely ( a.s . ) , there exists a uniquely defined random continuously differentiable function @xmath87 on @xmath86 $ ] satisfying the following conditions :    1 .",
    "@xmath88 for every @xmath89 $ ] ; 2 .",
    "@xmath87 has convex second derivative on @xmath90 ; 3 .",
    "@xmath91 and @xmath92 ; 4 .   @xmath93 and @xmath94 ; 5 .",
    "@xmath95 .",
    "the above claim also holds if we instead consider a standard brownian motion @xmath96 on @xmath86 $ ] and replace @xmath97 by @xmath98 , where @xmath99 , and where @xmath100 is different from @xmath87 .",
    "figure  [ fig : xyh ] shows a typical realization of @xmath101 , @xmath102 , @xmath103 and @xmath104 .",
    "a detailed construction of the above limit invelope process can be found in appendix i. note that our process is defined on a compact interval , so is technically different from the process presented in @xcite ( which is defined on the whole real line ) . as a result ,",
    "extra conditions regarding the behavior of @xmath87 ( and @xmath105 ) at the boundary points are imposed here to ensure its uniqueness .    , @xmath102 , @xmath103 and @xmath104 in theorem  [ thm : triangular_limit ] with @xmath82 and @xmath36 the distribution function with triangular density @xmath106}(t)$ ] : in ( a ) , @xmath101 and @xmath103",
    "are plotted in solid and dash - dotted curves respectively ; in ( b ) , the corresponding @xmath102 is plotted in solid curve , while the invelope process @xmath104 is illustrated in dash - dotted curve . ,",
    "width=529,height=302 ]    other characterization of the limit process is also possible .",
    "a slight variant is given below , which proof can also be found in appendix i.    [ cor : triangular_limit ] conditions ( 3 ) and ( 4 ) in the statement of theorem  [ thm : triangular_limit ] can be replaced respectively by    1 .",
    "@xmath107 , and 2 .",
    "@xmath108 .",
    "now we are in the position to state our main result of this section .",
    "[ thm : ls_triangular_asymptotic ] suppose @xmath106}(t)$ ] . then for any @xmath22 , the process @xmath109",
    "\\times \\mathcal{d}[\\delta , 1-\\delta],\\end{aligned}\\ ] ] where @xmath110 is the space of continuous functions equipped with the uniform norm , @xmath111 is the skorokhod space , and @xmath87 is the invelope process defined in theorem  [ thm : triangular_limit ] .    in particular , for any @xmath46 , @xmath112    of theorem  [ thm : ls_triangular_asymptotic ] before proceeding to the proof , we first define the following processes on @xmath113 : @xmath114 furthermore , define the set of `` knots '' of a convex function @xmath115 on @xmath90 as @xmath116 we remark that the above definition of knots can be easily extended to convex functions with a different domain .    by lemma  2.2 of @xcite , @xmath117 for @xmath89 $ ] , with equality if @xmath118 .",
    "in addition , @xmath119 .    now define the space @xmath120 of vector - valued functions ( @xmath121 ) as @xmath122 \\times \\mathcal{c}[0,1 ] \\times \\mathcal{c}[1/m , 1 - 1/m ] \\times \\mathcal{d}[1/m , 1 - 1/m ] \\times \\mathcal{c}[0,1 ] \\times \\mathcal{d}[0,1].\\end{aligned}\\ ] ] and endow @xmath120 with the product topology induced by the uniform norm on @xmath110 ( i.e. the space of continuous functions ) and skorokhod metric on @xmath111 ( i.e. the skorokhod space ) .",
    "let @xmath120 be supported by the stochastic process @xmath123    corollary  [ cor : ls_triangular_uniform_rate_derivative ] entails the tightness of @xmath124 in @xmath125 $ ] , while corollary  [ cor : ls_triangular_uniform_rate ] entails the tightness of @xmath126 in @xmath127 $ ] .",
    "in addition , both @xmath128 and @xmath129 are tight in @xmath130 $ ] ( via an easy application of marshall s lemma ) .",
    "since @xmath131 converges to a brownian bridge , it is tight in @xmath132 $ ] as well . finally , the same is also true for @xmath133 .",
    "note that @xmath120 is separable . for any subsequence of @xmath134 , by prohorov s theorem",
    ", we can construct a further subsequence @xmath135 such that @xmath136 converges weakly in @xmath120 to some @xmath137 in addition , it follows from a diagonalization argument that a further extraction can make @xmath136 converge weakly to @xmath138 in every @xmath120 .",
    "using skorokhod s representation theorem , we can assume without loss of generality that for almost every @xmath139 in the sample space , @xmath140 .",
    "moreover , since @xmath141 has a continuous path a.s . , the convergence of @xmath142 can be strengthened to @xmath143 , where @xmath144 is the uniform norm . in the rest of the proof",
    ", @xmath139 is suppressed for notational convenience , so depending on the context , @xmath135 ( or @xmath138 ) can either mean a random variable or a particular realization .    in the following , we shall verify that @xmath145 satisfies all the conditions listed in the statement of theorem  [ thm : triangular_limit ] .    1 .",
    "the fulfillment of this condition follows from the fact that @xmath146}\\big(\\hat{h}_n(t ) - y_n(t)\\big ) \\ge 0 $ ] for all @xmath147 .",
    "2 .   since @xmath2 is linear on @xmath86 $ ] , @xmath126 is convex on @xmath86 $ ] for every @xmath147 .",
    "the pointwise limit of convex functions is still convex , so @xmath148 is convex on @xmath149 $ ] .",
    "the condition is then satisfied by letting @xmath150 .",
    "this condition always holds in view of our construction of @xmath128 in ( [ eq : def_h_n ] ) .",
    "4 .   we consider two cases : ( a ) if @xmath151 as @xmath150 , then the conditions are satisfied in view of corollary  [ cor : triangular_limit ] ; ( b ) otherwise , it must be the case that @xmath152 is bounded from above .",
    "note that @xmath152 is also bounded from below a.s .",
    ", which can be proved by using corollary  [ cor : ls_triangular_uniform_rate_derivative ] and the fact that @xmath126 is convex .",
    "denote by @xmath153 the knot of @xmath154 closest to 1 . then by lemma  2.2 of @xcite , @xmath155 and @xmath156 . since @xmath157 is a knot of @xmath2 , consistency of @xmath154 allows us to see that @xmath158 . because @xmath159 is finite and both @xmath102 and @xmath101 are sample continuous processes , taking @xmath160 yields @xmath161 and @xmath162 .",
    "note that this argument remains valid even if @xmath163 , because in this scenario , @xmath164 is linear and bounded on @xmath165 $ ] .",
    "it follows from @xmath166 that @xmath167 since this holds for any @xmath168 , one necessarily has that @xmath169 .",
    "consequently , in view of theorem  [ thm : triangular_limit ] , the limit @xmath138 is the same for any subsequences of @xmath134 in @xmath120 .",
    "fix any @xmath170 .",
    "it follows that the full sequence @xmath171 converges weakly in @xmath120 and has the limit @xmath172 .",
    "this , together with the fact that @xmath173 is continuous at any fixed @xmath46 with probability one ( which can be proved using conditions  ( 1 ) and ( 5 ) of @xmath87 ) , yields ( [ eq : ls_pointwise_converg ] ) .",
    "@xmath71    it can be inferred from corollary  [ cor : triangular_limit ] and theorem  [ thm : ls_triangular_asymptotic ] that both @xmath174 and @xmath175 do not converge to the truth at a @xmath0 rate .",
    "in fact , @xcite proved that @xmath174 is an inconsistent estimator of @xmath44 .",
    "nevertheless , the following proposition shows that @xmath174 is at most @xmath176 . for the case of the maximum likelihood estimator of a @xmath7 monotone density",
    ", we refer readers to @xcite for a similar result .",
    "[ prop : ls_zero ] @xmath177 .    of proposition",
    "[ prop : ls_zero ] let @xmath178 be the left - most point in @xmath179 .",
    "since @xmath174 is finite for every @xmath34 , the linearity of @xmath1 on @xmath180 $ ] means that @xmath181 for every @xmath84 . by corollary  2.1 of @xcite , @xmath182 it follows from theorem  9.1.2 of @xcite that @xmath183 @xmath71      the asymptotic results established in section  [ sec : densityasym ] can be used to test the linearity of a density function against a general convex alternative .",
    "to illustrate the main idea , in this section , we focus on the problem of testing @xmath184}(t)$ ] against @xmath185}(t ) \\mbox { for some } t \\in ( 0,\\infty).\\ ] ] the test we propose is free of tuning parameters .",
    "since the triangular distribution is frequently used in practice , and is closely related to the uniform distribution ( e.g. the minimum of two independent @xmath186 $ ] is triangular ) , our test could be a valuable addition to practitioners toolkit .",
    "for other tests on the linearity in the regression setting , we point readers to @xcite and @xcite .",
    "our test is based on the statistic @xmath187}(t ) - \\hat{f}_n(t ) \\big\\}.\\ ] ] the behavior of @xmath188 under @xmath189 is established below .",
    "[ prop : test_h_0 ] write @xmath190 } h^{(2)}(t)$ ] , where @xmath87 is the invelope process defined in theorem  [ thm : triangular_limit ]",
    ". then @xmath191 .",
    "moreover , @xmath192 .    of proposition",
    "[ prop : test_h_0 ] the first part follows directly from theorem  [ thm : ls_triangular_asymptotic ] and corollary  [ cor : triangular_limit ] . for the second part , note that if @xmath193 , then @xmath146 } h^{(2)}(t ) > 0 $ ] , which would imply @xmath194 . but this would violate the characterization of @xmath87 ( i.e. @xmath195 , since @xmath141 is a brownian bridge ) .",
    "consequently , @xmath192.@xmath71    the quantiles and the density function of @xmath196 can be approximated numerically using monte carlo methods .",
    "they are given in table  [ tab : test_quantile ] and figure  [ fig : test ] . here",
    "we denote the upper @xmath197 quantile of @xmath196 by @xmath198 .",
    "our numerical evidence also suggests that the density function of @xmath196 appears to be log - concave . for related work on log - concavity of chernoff s distribution ( i.e.",
    "a different random variable also associated with a brownian motion ) , see @xcite .",
    ".estimated upper - quantiles of @xmath196 based on @xmath199 simulations .",
    "[ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     for a test of size @xmath200 , we propose to reject @xmath201 if @xmath202 .",
    "according to proposition  [ prop : test_h_0 ] , this test is asymptotically of size @xmath197 . in the following ,",
    "we prove that our test is also consistent , i.e. , its power goes to one as @xmath203 .",
    "[ thm : test_h_1 ] under @xmath204 , for any @xmath205 , @xmath206 as @xmath203 .    of theorem  [ thm :",
    "test_h_1 ] suppose that @xmath207}(t)$ ] for some @xmath208 .",
    "first , we show that there exists some @xmath209 such that @xmath210 .",
    "suppose the conclusion fails , then @xmath211}(t)$ ] for all @xmath212 .",
    "hence @xmath213}(t ) dt = 1 $ ] with strict inequality if @xmath214}(t)$ ] for some @xmath212 .",
    "but then @xmath2 is not a density and we conclude that @xmath106}(t)$ ] for every @xmath208 .",
    "this contradiction yields the conclusion .",
    "next , it follows from theorem  3.1 of @xcite that the lse @xmath1 is consistent at @xmath215 , i.e. , @xmath216 .",
    "therefore , almost surely , @xmath217 it follows that @xmath206 .",
    "@xmath71      the aim of this subsection is to extend the conclusions presented in section  [ sec : densityspecial ] to more general convex densities .",
    "we assume that @xmath2 is positive and linear on @xmath23 for some @xmath218 , where the open interval @xmath23 is picked as the `` largest '' interval on which @xmath2 remains linear .",
    "more precisely , it means that there does not exist a bigger open interval @xmath219 ( i.e. @xmath220 ) on which @xmath2 is linear .    for the sake of notational convenience ,",
    "we suppress the dependence of @xmath221 on @xmath24 , @xmath25 and @xmath36 in the following two theorems .",
    "their proofs are similar to those given in section  [ sec : densityspecial ] , so are omitted for brevity .",
    "[ thm : triangular_limit_extension ] let @xmath82 and @xmath83 for any @xmath212 .",
    ", there exists a uniquely defined random continuously differentiable function @xmath221 on @xmath14 $ ] satisfying the following conditions :    1 .",
    "@xmath222 for every @xmath223 $ ] ; 2 .",
    "@xmath221 has convex second derivative on @xmath23 ; 3 .",
    "@xmath224 and @xmath225 ; 4 .",
    "@xmath226 and @xmath227 ; 5 .   @xmath228 .",
    "[ thm : triangular_dist_extension ] for any @xmath229 , @xmath230 } \\big(|\\hat{f}_n(x ) - f_0(x)| , \\ ; |\\hat{f}_n'(x ) - f_0'(x)| \\big ) = o_p(n^{-1/2}).\\ ] ] moreover , @xmath231 \\times \\mathcal{d}[a+\\delta , b-\\delta],\\end{aligned}\\ ] ] where @xmath221 is the invelope process defined in theorem  [ thm : triangular_limit_extension ] .      in this subsection",
    ", we study the pointwise convergence rate of the convex lse @xmath1 at the boundary points of the region where @xmath2 is linear .",
    "examples of such points include @xmath24 and @xmath25 given in section  [ sec : densityext ] .    to begin our discussion , we assume that @xmath232 is such a boundary point in the interior of the support ( i.e. @xmath233 ) . here",
    "again @xmath2 is a convex ( and decreasing ) density function on @xmath37 .",
    "three cases are under investigation as below .",
    "these cases are illustrated in figure  [ fig:23abc ] .",
    "a.   @xmath234 for every @xmath67 in a fixed ( small ) neighborhood of @xmath6 , with @xmath235 and @xmath236 ; b.   @xmath237 for every @xmath67 in a fixed ( small ) neighborhood of @xmath6 , with @xmath238 , @xmath236 and @xmath239 ; c.   @xmath240 for every @xmath67 in a fixed ( small ) neighborhood of @xmath6 , with @xmath238 , @xmath236 and @xmath239 .     in different cases",
    "are illustrated , where we set @xmath241 in ( b ) and ( c ) . ]",
    "note that in all cases above , only the behavior of @xmath2 in a small neighborhood of @xmath6 is relevant .",
    "as pointed out in example  2 of @xcite , the minimax optimal convergence rate at @xmath6 is @xmath242 in ( a ) .",
    "furthermore , in ( b ) and ( c ) , example  4 of @xcite suggests that the optimal rate at @xmath6 is @xmath243 . in the following ,",
    "we prove that the convex lse automatically adapts to optimal rates , up to a factor of @xmath244 .",
    "though almost negligible , the factor of @xmath244 here indicates that there might be room for improvement .",
    "these results should be viewed as a first step for the investigation of the adaptation of the convex lse .",
    "one could also compare our results with @xcite , where the adaptation of the lse in the context of decreasing density function estimation was tackled .",
    "[ thm : ls_adapt_1 ] in the case of ( a ) , @xmath245 moreover , @xmath246    of theorem  [ thm : ls_adapt_1 ] suppose that for some fixed @xmath22 , ( a ) holds for every @xmath247 $ ] .",
    "our first aim is to show that @xmath248 } \\min\\big(\\hat{f}_n(t ) - f_0(t),0\\big ) = o_p(n^{-1/2}).\\end{aligned}\\ ] ]    suppose that @xmath249 .",
    "if we can find @xmath250 such that @xmath1 and @xmath2 intersect at the point @xmath251 , then @xmath252 otherwise , by taking @xmath253 , we can still verify the above two inequalities .",
    "therefore , @xmath254 where the first equation follows from marshall s lemma ( see ( [ eq : marshall ] ) ) .",
    "consequently , ( [ eq : ls_adapt_1_proof_1 ] ) holds true . as a remark ,",
    "the above arguments are essentially the same as those illustrated in the proof of theorem  [ thm : ls_triangular_rate ] , where one only relies on the fact that @xmath2 is linear on @xmath255 $ ] ( i.e. `` one - sided linearity '' ) .    in the rest of the proof",
    ", it suffices to only consider the situation of @xmath256 .",
    "recall that to handle this scenario , the proof of theorem  [ thm : ls_triangular_rate ] makes use of the fact that the triangular density is linear on the whole @xmath86 $ ] ( i.e. `` two - sided linearity '' ) .",
    "this is no longer true here since @xmath2 is not linear on @xmath257 $ ] . in the following ,",
    "we deploy a different strategy to establish the rate .",
    "let @xmath258 and @xmath259 , where @xmath260 is defined in ( [ eq : defknots ] ) .",
    "we consider three different cases separately .",
    "a.   @xmath261",
    ". then @xmath2 and @xmath1 are linear on either @xmath255 $ ] or @xmath262 $ ] .",
    "it follows from the line of reasoning as in the proof of theorem  [ thm : ls_triangular_rate ] that @xmath263 .",
    "b.   @xmath264 and @xmath265 .",
    "note that being in the set @xmath179 implies that @xmath266 and @xmath267 for @xmath268 and @xmath269 . since @xmath1 is linear on @xmath270 $ ] , @xmath271 by the law of the iterated logarithm for local empirical processes ( cf .",
    "lemma 4.3.5 of @xcite ) , ( [ eq : ls_adapt_1_proof_2 ] ) is at most @xmath272 . in view of ( [ eq : ls_adapt_1_proof_1 ] )",
    ", rearranging the terms in the above inequality yields @xmath273 c.   @xmath274 .",
    "now we define @xmath275 and @xmath276 . here",
    "the existence of @xmath277 is guaranteed by the condition that @xmath274 .",
    "furthermore , we note that in our definitions @xmath278 and @xmath277 might not be distinct . within this setting , three further scenarios are to be dealt with",
    "since both @xmath2 and @xmath1 are linear on @xmath280 $ ] , one can apply a strategy similar to that used in the proof of theorem  [ thm : ls_triangular_rate ] to show that @xmath281 .",
    "consequently , @xmath282 where we have used the facts that @xmath283 and @xmath284}|\\hat{f}_n'(t ) - f_0'(t)| = o_p(1)$ ] . here",
    "the second fact can be derived by invoking @xmath285}\\hat{f}_n'(t ) \\le",
    "\\sup_{t \\in [ x_0 - \\delta , x_0 + \\delta]}\\hat{f}_n'(t ) \\le k_1 + k_2 + o_p(1),\\ ] ] which follows easily from consistency of @xmath286 in estimating @xmath287 at the points @xmath288 .",
    "2 .   @xmath289 .",
    "then @xmath290 .",
    "using essentially the same argument as in ( b ) , we see that @xmath291 and hence , @xmath292 we then apply the argument presented in ( c1 ) to derive @xmath245 3 .",
    ". then @xmath294 . by proceeding as in the proof of lemma  4.3 of @xcite , we are able to verify that @xmath295 } |\\hat{f}_n(t ) - f_0(t)| = o_p(n^{-1/3}).\\ ] ] here we invoked lemma  a.1 of @xcite with @xmath296 and @xmath297 to verify the above claim .",
    "see also @xcite .",
    "finally , we can argue as in ( c1 ) to show that @xmath298 .",
    "the proof is complete by taking into account all the above cases .",
    "we remark that in our proof the worst case scenarios that drive the convergence rate are ( b ) and ( c2 ) .",
    "@xmath71    [ thm : ls_adapt_2 ] in the case of ( b ) or ( c ) , @xmath299 moreover , @xmath246    the proof of theorem  [ thm : ls_adapt_2 ] is of more technical nature and is deferred to appendix ii .",
    "changing notation slightly from the previous section , we now assume that we are given pairs @xmath300 for @xmath301 with @xmath302 where @xmath303 \\rightarrow { { \\mathbb r}}$ ] is a convex function , and where @xmath304 is a triangular array of iid random variables satisfying    a.   @xmath305 and @xmath306 .    to simplify our analysis ,",
    "the following fixed design is considered :    a.   @xmath307 for @xmath308 .",
    "the lse of @xmath5 proposed by @xcite is @xmath309 where , in this section , @xmath38 denotes the set of all continuous convex functions on @xmath86 $ ] .",
    "we note that the above estimator is slightly different from the more `` classical '' lse that minimizes @xmath310 over @xmath38 .",
    "since its criterion function has a completely discrete nature , different techniques are needed to prove analogous results .",
    "we will not pursue this direction in the manuscript .      in this subsection , we list some basic properties of @xmath4 given as ( [ eq : re_estimator ] ) . for any @xmath89",
    "$ ] , define @xmath311    [ prop : re_exist ] the lse @xmath4 exists and is unique .",
    "[ prop : re_prop ] let @xmath312 denote the set of knots of @xmath4 .",
    "the following properties hold :    a.   @xmath313;}\\end{array}\\right.$ ] b.   @xmath314 for any @xmath315 ; c.   @xmath316 .",
    "[ prop : re_marshall ] @xmath317    of propositions  [ prop : re_exist ] , [ prop : re_prop ] and [ prop : re_marshall ] note that we can rewrite @xmath4 as @xmath318 from this perspective , it is easy to check that proposition  [ prop : re_exist ] , proposition  [ prop : re_prop ] and proposition  [ prop : re_marshall ] follow from , respectively , slight modifications of lemma  2.1 , lemma  2.2 of @xcite and theorem  1 of @xcite .",
    "@xmath71    we remark that this version of marshall s lemma in the regression setting serves as an important tool to establish consistency and the rate . in particular , in the following , we show that ( [ eq : re_marshall ] ) easily yields consistency of @xmath319 , and consistency of @xmath4 follow from this together with convexity of @xmath4 .",
    "[ prop : re_consistency ] under assumptions ( i )  ( ii ) , for any @xmath72 , @xmath73 } |\\hat{r}_n(x ) - r_0(x ) |",
    "\\stackrel{\\mbox{a.s.}}{\\rightarrow } 0 , \\quad\\mbox { as } n \\rightarrow \\infty.\\ ] ]    of proposition  [ prop : re_consistency ] the proof replies on the following intermediate result : suppose there are differentiable functions @xmath320 , all are @xmath86\\rightarrow { { \\mathbb r}}$ ] and have convex first derivative , then for any fixed @xmath72 , @xmath321 implies @xmath322 } |g_k'(t ) - g_0'(t)| \\rightarrow 0 $ ] .    to see this , we first show that @xmath323 } \\",
    "{ g_k'(t ) - g_0'(t ) \\ } \\le 0 .",
    "\\end{aligned}\\ ] ] note that for any @xmath324 $ ] and any @xmath325 , @xmath326 it then follows that @xmath327 } \\ { g_k'(t )",
    "- g_0'(t ) \\ } \\le \\sup_{t \\in [ \\delta , 1-\\delta ] } \\bigg ( \\frac{g_0(t+\\epsilon ) - g_0(t)}{\\epsilon } - g_0'(t ) , \\frac{g_0(t ) - g_0(t-\\epsilon)}{\\epsilon } - g_0'(t ) \\bigg).\\ ] ] our claim ( [ eq : re_marshall1 ] ) can be verified by letting @xmath328 .",
    "secondly , we show that @xmath329 } \\ { g_k'(t ) - g_0'(t ) \\ } \\ge 0 .",
    "\\end{aligned}\\ ] ] we prove this by contradiction .",
    "suppose that @xmath330 } \\",
    "{ g_k'(t ) - g_0'(t ) \\ } = -m$ ] for some @xmath331 . by extracting subsequences if necessary",
    ", we can assume that @xmath332 } \\",
    "{ g_k'(t ) - g_0'(t ) \\ } \\rightarrow -m$ ] as @xmath333 . in view of ( [ eq : re_marshall1 ] )",
    ", it follows from the convexity of @xmath334 and @xmath335 that one can find an interval @xmath336 of positive length @xmath337 ( which can depend on @xmath338 ) such that @xmath339 for every @xmath340 , where @xmath341 is a sufficiently large integer .",
    "this implies that @xmath342 for every @xmath340 , which contradicts the fact that @xmath321 as @xmath333 .",
    "combining these two parts together completes the proof of the intermediate result .    since @xmath343 by empirical process theory , proposition  [ prop : re_marshall ] entails that @xmath344 .",
    "consistency of @xmath4 then follows straightforwardly from the above intermediate result .",
    "@xmath71      in the following , we assume that @xmath5 that is linear on @xmath345 . moreover , @xmath23 is `` largest '' in the sense that one can not find a bigger open interval @xmath219 on which @xmath5 remains linear .",
    "[ thm : re_rate_dist ] under assumptions ( i )  ( ii ) , for any @xmath229 , @xmath230 } \\big(|\\hat{r}_n(x ) - r_0(x)| , \\ ; |\\hat{r}_n'(x ) - r_0'(x)| \\big ) = o_p(n^{-1/2}).\\ ] ] moreover , @xmath346 \\times \\mathcal{d}[a+\\delta , b-\\delta],\\end{aligned}\\ ] ] where @xmath100 is the invelope process defined in the second part of theorem  [ thm : triangular_limit ] .",
    "the proof of theorem  [ thm : re_rate_dist ] is very similar to what has already been shown in section  [ sec : densityspecial ] , so is omitted for the sake of brevity .    in presence of the linearity of @xmath5 on @xmath23 , the limit distribution of the process @xmath347 on @xmath23 does not depend on @xmath348 or @xmath349 .",
    "in addition , the above theorem continues to hold if we weaken assumption ( ii ) to :    1 .",
    "@xmath350}\\big|\\frac{1}{n}\\sum_{i=1}^n \\mathbf{1}_{[x_{n , i},\\ , \\infty)}(t ) - t \\big| = o\\big(n^{-1/2}\\big)$ ] .",
    "theoretical results in the random design are also possible , where for instance , we can assume that @xmath351 are iid uniform random variables on @xmath86 $ ] .",
    "in this case , theorem  [ thm : re_rate_dist ] is still valid , while a process different from @xmath100 is required to characterize the limit distribution .",
    "this follows from the fact that in the random design @xmath352 can converge to a gaussian process that is not a brownian motion .",
    "recall that @xmath353}(t)$ ] , @xmath354 , and @xmath355 for @xmath84 . in this section ,",
    "we show the existence and uniqueness of the invelope process @xmath87 .",
    "the case of @xmath100 can be handled using essentially the same arguments , so is omitted here .",
    "lemmas  [ lem : limsolution ]  [ lem : limequicontinuous ] are needed to prove theorem  [ thm : triangular_limit ] .",
    "[ lem : limsolution ] let the functional @xmath356 be defined as @xmath357 for functions in the set @xmath358\\rightarrow { { \\mathbb r } } , g \\mbox { is convex } , g(0 ) = g(1 ) = k \\}$ ] .",
    "then with probability one , the problem of minimizing @xmath356 over @xmath359 has a unique solution .    of lemma  [ lem :",
    "limsolution ] we consider this optimization problem in the metric space @xmath32 .",
    "first , we show that if it exists , the minimizer must be in the subset @xmath360\\rightarrow { { \\mathbb r } } , g \\mbox { is convex } , g(0 ) = g(1 ) = k , \\inf_{[0,1 ] } g(t ) \\ge - m \\}\\end{aligned}\\ ] ] for some @xmath361 . to verify this ,",
    "we need the following result @xmath362 let @xmath363 be a standard brownian motion .",
    "we note that @xmath364 has the same distribution as @xmath365 using the entropy bound of @xmath366 in @xmath32 ( theorem 2.7.1 of @xcite ) and dudley s theorem ( cf .",
    "theorem  2.6.1 of @xcite ) , we can establish that @xmath367\\rightarrow { { \\mathbb r}}\\ ; | \\ ; h(t ) = g\\big(1-\\sqrt{1-t}\\big ) , g \\in \\mathcal{g}_{1,1 } \\big\\}\\ ] ] is a gc - set . as @xmath368 is an isonormal gaussian process indexed by @xmath369",
    ", we have that a.s .",
    "@xmath370 . furthermore , it is easy to check that @xmath371 a.s . and",
    "so our claim of ( [ eq : gcfinite ] ) holds .",
    "now for sufficiently large @xmath338 ( with @xmath373 ) , @xmath374 thus , for any @xmath375 with @xmath376 } g = -m$ ] , @xmath377 is at most @xmath378 .",
    "furthermore , @xmath379 is of @xmath380 . since @xmath381 at the minimizer",
    "could at most be as large as @xmath382 , we conclude that it suffices to only consider functions in @xmath383 for some sufficiently large @xmath338 .",
    "note that the functional @xmath381 is continuous ( cf .",
    "dudley s theorem ) and strictly convex .",
    "moreover , for @xmath384 , if @xmath385 , then @xmath386 on @xmath86 $ ] .",
    "since @xmath383 is compact in @xmath32 , the existence and uniqueness follow from a standard convex analysis argument in a hilbert space .",
    "@xmath71    as a remark , it can be seen from the proof of lemma  [ lem : limsolution ] that for a given @xmath387 from the sample space ( which determines the value of @xmath101 ) , if the function @xmath381 has a unique minimizer over @xmath388 ( which happens a.s . )",
    ", it also admits a unique minimizer over @xmath359 for any @xmath389 .",
    "[ lem : parabolictangent ] almost surely , @xmath102 does not have parabolic tangents at either @xmath390 or @xmath391 .    of lemma  [ lem :",
    "parabolictangent ] first , consider the case of @xmath63 .",
    "theorem  1 of @xcite says that @xmath392 where @xmath393 is a standard brownian motion . from this , it follows that @xmath394 thanks to the scaling properties of brownian motion ( @xmath395 ) .",
    "this implies that @xmath102 does not have a parabolic tangent at @xmath63 .",
    "second , consider the case of @xmath157 . note that @xmath396 and @xmath397 where @xmath398 .",
    "therefore , to prove that @xmath102 does not have a parabolic tangent at @xmath157 , it suffices to show that @xmath399 denote by @xmath400 . for any @xmath401 ,",
    "we argue that the random variable @xmath402 follows a distribution of @xmath403 .",
    "this is because @xmath404 where we invoked the stochastic fubini s theorem in the last line , and thus , @xmath405    now setting @xmath406 and @xmath407 for every @xmath408 .",
    "it is easy to check that the collection of random variables @xmath409 is mutually independent , so @xmath410 where we made use of the fact that @xmath411    assume that there exists some @xmath412 such that @xmath413 for all sufficiently small @xmath414 .",
    "but it follows from ( [ eq : para_tangent ] ) that a.s .",
    "one can find a subsequence of @xmath415 ( denoted by @xmath416 ) satisfying @xmath417 consequently , @xmath418 as @xmath419 .",
    "the last step is due to the facts of @xmath420 and @xmath421 a.s .",
    "( which is a direct application of the law of the iterated logarithm ) . the proof is completed by contradiction .",
    "@xmath71    now denote by @xmath422 the unique function which minimizes @xmath356 over @xmath359 .",
    "let @xmath423 be the second order integral satisfying @xmath424 , @xmath425 and @xmath426 .",
    "[ lem : limprop ] almost surely , for every @xmath427 , @xmath422 and @xmath423 has the following properties :    a.   @xmath428 for every @xmath89 $ ] ; b.   @xmath429 , where the derivative can be interpreted as either the left or the right derivative ; c.   @xmath430 and @xmath431 for any @xmath432 , where @xmath433 is the set of knots ; d.   @xmath434 and @xmath435 for any @xmath432 ; e.   @xmath422 is a continuous function on @xmath86 $ ] .    of lemma  [ lem :",
    "limprop ] to show ( i ) , ( ii ) , ( iii ) and ( iv ) , one may refer to lemma  2.2 and corollary  2.1 of @xcite and use a similar functional derivative argument .    for ( v ) , we note that since @xmath422 is convex , discontinuity can only happen at @xmath63 or @xmath157 . in the following ,",
    "we show that it is impossible at @xmath63 .",
    "suppose that @xmath422 is discontinuous at zero .",
    "consider the class of functions @xmath436 .",
    "then @xmath437 for every @xmath438 $ ] .",
    "by considering the functional derivative of @xmath356 and using integration by parts , we obtain that for any @xmath439 , @xmath440 which implies that @xmath441 for every @xmath439 . but",
    "this contradicts lemma  [ lem : parabolictangent ] , which says that a.s .",
    "@xmath442 does not have a parabolic tangent at @xmath63 .",
    "consequently , @xmath422 is continuous at @xmath63 .",
    "the same argument can also be applied to show the continuity of @xmath422 at @xmath157 .",
    "@xmath71    [ lem : limknot ] fix any @xmath443 .",
    "denote by @xmath444 the right - most knot of @xmath422 on ( 0,t ] .",
    "if such knot does not exist , then set @xmath445 .",
    "similarly , denote by @xmath446 the left - most knot of @xmath422 on [ t,1 ) , and set @xmath447 if such knot does not exist .",
    "then , for almost every @xmath387 , there exists @xmath448 such that for every @xmath449 , @xmath450 and @xmath451 .",
    "here we suppressed the dependence of @xmath341 and @xmath422 ( as well as @xmath444 and @xmath446 ) on @xmath139 ( via @xmath141 ) in the notation .    of lemma  [ lem : limknot ]",
    "recall that @xmath101 is said to be sample - bounded on @xmath86 $ ] if @xmath452}|x(t)|$ ] is finite for almost all @xmath387 . since both @xmath101 and @xmath102 are sample bounded . without loss of generality , in the following ,",
    "wee can fix @xmath387 and assume that @xmath452}|x(t)| < \\infty$ ] and @xmath452}|y(t)| < \\infty$ ] .",
    "first , we show the existence of at least one knot on @xmath90 .",
    "note that the cubic polynomial @xmath453 with @xmath454 , @xmath455 , @xmath456 can be expressed as @xmath457 therefore , take for instance @xmath458 and consider the event @xmath459 .",
    "this event can be reexpressed as @xmath460 which will eventually become false as @xmath333 .",
    "this is due to the fact that @xmath102 is sample bounded . in view of ( i ) and ( v ) of lemma  [ lem : limprop ] , we conclude that @xmath422 has at least one knot in the open interval @xmath90 for sufficiently large @xmath7 .    next , take @xmath7 large enough so that @xmath422 has one knot in @xmath90 , which we denote by @xmath461 . by ( iii ) of lemma  [ lem : limprop ] , @xmath462 and @xmath463 . without loss of generality , we may assume that @xmath464 . now the cubic polynomial @xmath453 with @xmath454 , @xmath465 , @xmath466 and @xmath467 can be expressed as @xmath468 where @xmath469 by taking , say for example , @xmath470 , it can then be verified that the event @xmath471 , which is equivalent to @xmath472 will eventually stop happening as @xmath333 . this is due to the sample boundedness of both @xmath101 and @xmath102 .",
    "consequently , @xmath450 for sufficiently large @xmath7 .",
    "furthermore , using essentially the same argument , one can also show that @xmath451 for large @xmath7 , which completes the proof of this lemma .",
    "[ lem : limlowerbound ] for almost every @xmath387 ( which determines @xmath101 and @xmath422 ) , we can find an @xmath331 such that @xmath473 } f_k >",
    "-m.\\ ] ]    of lemma  [ lem : limlowerbound ] fix any @xmath474 $ ] . in view of lemma  [ lem : limknot ] , we may assume that there exist knots @xmath444 and @xmath446 on @xmath475 $ ] and @xmath476 respectively for sufficiently large @xmath7 .",
    "if @xmath376}f_k \\ge 0 $ ] for every @xmath340 , then we are done .",
    "otherwise , we focus on those @xmath376}f_k < 0 $ ] and find @xmath477 with @xmath478 .",
    "note that the existence of @xmath479 and @xmath480 are guaranteed by lemma  [ lem : limprop ] ( v ) .",
    "in the following , we take @xmath481 and consider two scenarios .    a.   @xmath482 .",
    "let @xmath483 and @xmath484 , where @xmath485 is the subgradient operator .",
    "then lemma  [ lem : limprop](v ) implies that @xmath486 and @xmath487 .",
    "since both @xmath488 and @xmath489 can be regarded as supporting hyperplanes of @xmath422 due to its convexity , it follows that @xmath490 .",
    "set @xmath491 ( i.e. @xmath492 is the value of the above hyperplanes at their intersection , which is negative ) , so @xmath376}f_k \\ge -c_k$ ] .",
    "now @xmath493}{|x(t)| } & \\ge x(\\tau_k^+ ) - x(\\tau_k^- ) = h_k'(\\tau_k^+ ) - h_k'(\\tau_k^- ) = \\int_{\\tau_k^-}^{\\tau_k^+ } f_k(s ) \\ , ds \\\\      & \\ge \\int_{\\tau_k^-}^{\\tau_k^+ } \\max \\big ( a_{k,1}(s - t_{k,1}),a_{k,2}(s - t_{k,2 } ) \\big ) \\ , ds \\\\      & \\ge \\int_{\\delta}^{1-\\delta } \\max \\big ( a_{k,1}(s - t_{k,1}),a_{k,2}(s - t_{k,2 } ) \\big ) \\ , ds - 2\\delta c_k \\\\      & \\ge \\int_{\\delta}^{1-\\delta } \\max \\big ( a_{k,1}(s - t_{k,1}),a_{k,2}(s - t_{k,2 } ) , 0\\big ) \\ , ds \\\\      &",
    "\\qquad \\qquad - \\int_{\\delta}^{1-\\delta } \\max \\big ( - a_{k,1}(s - t_{k,1}),- a_{k,2}(s - t_{k,2 } ) , 0\\big )",
    "ds - 2\\delta c_k \\\\      & \\ge \\inf_{u \\in [ 0,1 - 4\\delta ] } \\big\\{|a_{k,1}| u^2 + |a_{k,2}|(1 - 4\\delta - u)^2\\big\\}/2 - c_k ( t_{k,2 } - t_{k-1})/2   - 2 \\delta c_k \\\\      & \\ge \\frac{(1 - 4\\delta)^2}{4\\delta}c_k -\\delta c_k - 2 \\delta c_k =   \\left(\\frac{1}{4\\delta } + \\delta - 2\\right ) c_k \\ge c_k.\\end{aligned}\\ ] ] consequently , a.s . , @xmath494 . b.   @xmath495 .",
    "now consider @xmath496 .",
    "it follows that @xmath497 let @xmath498 } f_k$ ] . by the convexity of @xmath422",
    ", we see that the first term is no smaller than @xmath499 . for the second term",
    ", we can again use dudley s theorem and the fact that the following class @xmath500\\rightarrow & [ -1,0 ] \\big|   \\exists \\ , 0 \\le x_1 < x_2 \\le 1 \\\\      & \\mbox{s.t . }",
    "g(s ) \\mbox { is convex on } [ x_1,x_2 ] ; g(s ) = 0 , \\forall s \\in [ 0,x_1]\\cup[x_2,1 ] \\big\\}\\end{aligned}\\ ] ] has entropy of order @xmath501 in @xmath32 to argue that @xmath502 } g d x(t ) \\right| < \\infty , \\quad \\mbox{a.s.}\\end{aligned}\\ ] ] therefore , the second term is at most @xmath503 .",
    "then we can use the argument in the proof of lemma  [ lem : limsolution ] to establish that a.s . @xmath504 .",
    "@xmath71    [ lem : limtight ] for any fixed @xmath443 and almost every @xmath387 , @xmath505 , @xmath506 and @xmath507 are bounded .    of lemma  [ lem :",
    "limtight ] let @xmath508 . in view of lemma  [ lem : limknot ] , for sufficiently large @xmath7",
    ", we can assume that @xmath422 has at least one knot in @xmath509 $ ] , and one knot in @xmath510 .",
    "denote these two points by @xmath444 and @xmath446 respectively . by the convexity of @xmath422 ,",
    "there exists some @xmath511 such that @xmath512 for every @xmath513 $ ] .",
    "it follows that @xmath514}{|x(t)| } & \\ge x(\\tau_k^+ ) - x(\\tau_k^- ) =   \\int_{\\tau_k^-}^{\\tau_k^+ } f_k(s ) \\ , ds \\\\      & \\ge \\int_{[\\tau_k^-,t-\\delta ] \\cup [ t+\\delta,\\tau_k^+ ] } \\big(\\inf_{[0,1]}f_k \\big ) \\ , ds + \\int_{(t-\\delta , t+\\delta ) } \\big\\{c(s - t ) + f_k(t ) \\big\\ } ds \\ge -m_k + 2 \\delta f_k(t),\\end{aligned}\\ ] ] where @xmath515 } f_k$ ] . by lemma  [ lem : limlowerbound ]",
    ", we see that for almost every @xmath387 , @xmath516 is bounded . combining this with the lower",
    "bound we established previously entails the boundedness of @xmath517 .",
    "next , note that both @xmath518 and @xmath519 are bounded .",
    "the boundedness of @xmath520 and @xmath521 immediately follows from the convexity of @xmath422 by utilizing @xmath522.\\end{aligned}\\ ] ] @xmath71    [ lem : limintegral ] for almost every @xmath387 , both @xmath523 } | h_k(t)|\\right\\}_k$ ] and @xmath523 } | h_k'(t)|\\right\\}_k$ ] are bounded .    of lemma",
    "[ lem : limintegral ] by lemma  [ lem : limprop](iv ) , for any @xmath89 $ ] , @xmath524 } f_k\\big ) & \\le t \\inf_{[0,1 ] } f_k",
    "\\le \\int_0^t f_k(s ) ds =   \\int_0 ^ 1 f_k(s ) ds - \\int_t^1 f_k(s ) ds\\\\      & \\le x(1 ) - x(0 ) - ( 1-t ) \\inf_{[0,1 ] } f_k \\le x(1 ) - x(0 ) - \\min\\big(0 , \\inf_{k \\in { { \\mathbb n } } } \\inf_{[0,1 ] } f_k\\big).\\end{aligned}\\ ] ] consequently , it follows from lemma  [ lem : limlowerbound ] that @xmath523}|\\int_0^t f_k(s ) ds|\\right\\}_k$ ] is bounded .",
    "furthermore , lemma  [ lem : limknot ] says that one can always find a knot @xmath525 with @xmath526 for all sufficiently large @xmath7 .",
    "thus , the boundedness of @xmath523 } | h_k'(t)|\\right\\}_k$ ] follows from the fact that @xmath527 } | h_k'(t)| \\le \\sup_{t \\in [ 0,1 ] } \\left|x(\\tau_k^- ) - \\int_0^{\\tau_k^- } f_k(s)ds + \\int_0^t f_k(s ) ds\\right| \\le \\sup_{t \\in [ 0,1]}|x(t)| + 2\\sup_{t \\in [ 0,1]}\\left|\\int_0^t f_k(s ) ds\\right|.\\end{aligned}\\ ] ] finally , one can derive the sample boundedness of @xmath523 } | h_k(t)|\\right\\}_k$ ] by using the equality @xmath528 .",
    "@xmath71    [ lem : limequicontinuous ] for almost every @xmath387 , both @xmath529 and @xmath530 are uniformly equicontinuous on @xmath86 $ ] .",
    "in fact , they are uniformly hlder continuous with exponent less than @xmath531 .    of lemma",
    "[ lem : limequicontinuous ] here we only show that the family @xmath530 is uniformly equicontinuous .",
    "fix any @xmath532 . for any @xmath533 with @xmath534 , by the convexity of @xmath422 , @xmath535    in the following , we shall focus on @xmath536 .",
    "the term @xmath537 can be handled in exactly the same fashion . by lemma  [ lem : limknot ] , @xmath538 is non - empty for every @xmath340 , where @xmath341 is a sufficiently large positive integer .",
    "furthermore , in view of lemma  [ lem : limlowerbound ] , we can assume that @xmath539 } f_k \\ge -m$ ] for some @xmath331 .",
    "three scenarios are discussed in the following . here",
    "we fix @xmath540 .",
    "a.   there exists at least one knot @xmath541 with @xmath542 $ ] .",
    "then @xmath543 for some @xmath544 ( which is the @xmath197-hlder constant of this particular realization of @xmath101 ) .",
    "the last line follows from lemma  [ lem : limprop](iv ) and the fact that @xmath101 is @xmath197-hlder - continuous , so @xmath545 b.   @xmath546 = \\emptyset$ ] .",
    "let @xmath541 be the left - most knot in @xmath547 .",
    "then @xmath422 is linear on @xmath548 $ ] and @xmath549 .",
    "note that @xmath550 so @xmath551 .",
    "it now follows that @xmath552 we remark that since @xmath553 , the above conclusion also implies that @xmath546 \\neq \\emptyset$ ] for all sufficiently large @xmath7 . c.   @xmath554 , but @xmath555",
    "\\neq \\emptyset$ ] .",
    "let @xmath444 be the right - most knot in @xmath475 $ ] and @xmath446 be the left - most knot in @xmath547 . as a convention",
    ", we set @xmath556 if such a knot does not exist .",
    "note that @xmath422 is linear on @xmath557 $ ] , so we can use essentially the same argument as above to see that @xmath558 .",
    "finally , @xmath559    to finish the proof , we shall apply lemma  [ lem : limlowerbound ] to verify that @xmath560 .",
    "in addition , combining results from all the scenarios listed above , we see that @xmath530 is uniformly hlder continuous with exponent @xmath561 ( @xmath562 ) .",
    "@xmath71    of theorem  [ thm : triangular_limit ] for every @xmath563 with @xmath121 , define the following norms @xmath564 } |h(t)| + \\sup_{t \\in [ 0 , 1 ] } |h'(t)| + \\sup_{t \\in [ 1/m , 1 - 1/m]}|h^{(2)}(t)|.\\end{aligned}\\ ] ]    first , we show the existence of such a function for almost all @xmath387 by construction .",
    "fix @xmath139 ( thus we focus on a particular realization of @xmath101 but suppress its dependence on @xmath139 in the notation ) .",
    "let @xmath423 be the function satisfying @xmath426 , @xmath565 and @xmath425 .",
    "we claim that the sequence @xmath423 admits a convergent subsequence in the topology induced by the norm @xmath566 .    by lemma  [ lem : limtight ]",
    ", we may assume that for @xmath567 and @xmath568 , @xmath517 , @xmath520 and @xmath521 are bounded . by the convexity ,",
    "@xmath569 have uniformly bounded derivatives on @xmath149 $ ] so are uniformly bounded and equicontinuous .",
    "therefore , the arzel ",
    "ascoli theorem guarantees that the sequence @xmath422 has a convergent subsequence @xmath570 in the supremum metric on @xmath571 $ ] . extracting further subsequences if necessary",
    ", one can get @xmath570 converging in the topology induced by the @xmath572 norm on @xmath149 $ ] for @xmath573 .    now by lemma  [ lem : limintegral ] and lemma  [ lem : limequicontinuous ]",
    ", we can assume that @xmath529 and @xmath530 are bounded and equicontinuous on @xmath86 $ ] . by the arzel ",
    "ascoli theorem again , we are able to extract further subsequences if necessary to make @xmath574 converge in the topology induced by the norms @xmath566 for @xmath573 .",
    "we denote the function that @xmath574 converges to by @xmath87 .    in the following ,",
    "we show that @xmath87 has the properties listed in the statement of the theorem .    1 .",
    "because @xmath575 for every @xmath576 and every @xmath89 $ ] , @xmath88 for @xmath89 $ ] .",
    "2 .   @xmath577 is convex on @xmath90 since every @xmath422 is convex .",
    "3 .   since @xmath424 and @xmath425 for all @xmath576",
    ", we have @xmath91 and @xmath93 . now let @xmath578 and @xmath579 .",
    "in light of lemma  [ lem : limknot ] , one can assume that @xmath580 and @xmath581 .",
    "the sample continuity of @xmath101 , together with the property of knots ( see ( iii ) of lemma  [ lem : limprop ] ) , entails that @xmath582 and @xmath583 as @xmath333 .",
    "finally , we use the uniform convergence and the continuity of @xmath105 to establish @xmath92 and @xmath94 .",
    "4 .   it follows from lemma  [ lem : limprop](ii ) that @xmath584 } \\big(h(t)-y(t)\\big)\\ , dh^{(3)}(t ) = 0 $ ] .",
    "now let @xmath150 to see the required property .",
    "this completes the proof of existence .",
    "it remains to show the uniqueness of @xmath87 .",
    "suppose that there are @xmath585 and @xmath586 satisfying conditions ( 1 )  ( 5 ) listed in the statement of theorem  [ thm : triangular_limit ] . for notational convenience , we write @xmath587 and @xmath588 . then , @xmath589 where we used conditions ( 1 )  ( 5 ) of @xmath586 to derive the last inequality . by swapping @xmath585 and @xmath586 ,",
    "we further obtain the following inequality @xmath590 adding together the above two inequalities yields @xmath591 , which implies the uniqueness of @xmath577 on @xmath90 .",
    "the uniqueness of @xmath87 then follows from its third condition .",
    "the proof for the second part ( i.e. the existence and uniqueness of @xmath100 ) is similar and is therefore omitted .",
    "@xmath71    of corollary  [ cor : triangular_limit ] we can easily verify the existence of such a function by using the same construction in the proof of theorem  [ thm : triangular_limit ] . in particular , if @xmath102 does not have parabolic tangents at both @xmath390 and @xmath391 ( which happens a.s . according to lemma  [",
    "lem : parabolictangent ] ) , then @xmath592 and @xmath593 as @xmath333 .    on the other hand ,",
    "if @xmath594 , there must be a sequence of knots @xmath595 of @xmath577 with @xmath596 . in views of conditions  ( 1 ) , ( 2 ) and ( 5 ) ,",
    "one necessarily has @xmath597 and @xmath598 for every @xmath599 .",
    "the fact that @xmath87 , @xmath105 , @xmath442 and @xmath141 are all continuous entails that @xmath91 and @xmath92 .",
    "consequently , condition  ( 3 ) implies condition  ( 3 ) .",
    "we now apply the same argument to @xmath600 to conclude that condition  ( 4 ) implies condition  ( 4 ) .",
    "hence , in view of theorem  [ thm : triangular_limit ] , @xmath87 is unique .",
    "@xmath71      the following three lemmas are required to prove theorem  [ thm : ls_adapt_2 ] .    [",
    "lem : ls_adapt_precalculation ] for any @xmath601 , @xmath602 } \\big\\ { 4k^{\\alpha+2}+(1+k)^{\\alpha+1}(\\alpha-2k)\\big\\ } > 0 $ ] .    of lemma  [ lem : ls_adapt_precalculation ]",
    "it suffices to show that for any @xmath603 $ ] , @xmath604    first , it is easy to check that the above inequality holds true when @xmath605 . in the case of @xmath606 , we can restate the inequality to be proved as @xmath607    next , we define @xmath608 $ ] , so that ( [ eq : ls_adapt_precalculation1 ] ) can be rewritten as @xmath609 note that @xmath610 } \\big ( 4 m^{\\alpha+1 } + \\frac{\\alpha}{m } \\big ) \\ge \\frac{\\alpha(\\alpha+2)}{(\\alpha+1 ) } \\big(\\frac{4(\\alpha+1)}{\\alpha}\\big)^{1/(\\alpha+2 ) } =   ( \\alpha+2 ) \\bigg\\{4\\big(1 - \\frac{1}{\\alpha+1}\\big)^{\\alpha+1}\\bigg\\}^{1/(\\alpha+2)}.\\ ] ] the inequality ( [ eq : ls_adapt_precalculation2 ] ) now follows easily from that fact that @xmath611 for any @xmath601 .",
    "@xmath71    [ lem : ls_adapt_calculation ] let @xmath612 for every @xmath613 $ ] for some @xmath614 small , with @xmath238 , @xmath236 and @xmath239 .",
    "then for any @xmath615 , @xmath616 where @xmath617 , and where @xmath618 is a constant that only depends on @xmath2 .    of lemma  [ lem",
    ": ls_adapt_calculation ] first , it is easy to check that @xmath619    if @xmath620 , then ( [ eq : ls_adapt_calculation1 ] ) can be expressed as @xmath621    on the other hand , if @xmath622 , then after some elementary calculations , we can show that ( [ eq : ls_adapt_calculation1 ] ) is equal to @xmath623}{2(\\alpha+1)(\\alpha+2)}.\\end{aligned}\\ ] ] denote by @xmath624 , so that ( [ eq : ls_adapt_calculation2 ] ) can be rewritten as @xmath625 where @xmath626 is a constant that only depends on @xmath2 , and where we applied lemma  [ lem : ls_adapt_precalculation ] with the fact that @xmath603 $ ] to derive the above displayed equation . consequently , by setting @xmath627 , it is straightforward to check that ( [ eq : ls_adapt_calculation2 ] ) is greater than or equal to @xmath628 .",
    "@xmath71    [ lem : ls_adapt_vc ] let @xmath629 be a collection of functions defined on @xmath630 $ ] , with @xmath22 small .",
    "suppose that for a fixed @xmath631 $ ] and every @xmath632 such that @xmath633 \\subseteq [ x_0 - \\delta , x_0 + \\delta]$ ] , the collection @xmath634 } , \\ \\ \\ f \\in \\mathcal{f } , \\ \\ x \\le y \\le x+r \\right \\}\\end{aligned}\\ ] ] admits an envelope @xmath635 such that @xmath636 for some @xmath637 fixed and @xmath448 depending only on @xmath6 and @xmath337 , where @xmath638 .",
    "moreover , suppose that @xmath639 then , for every @xmath640 and @xmath641 , there exist a random variable @xmath642 of @xmath643 such that @xmath644    of lemma  [ lem : ls_adapt_vc ] this lemma slightly generalizes lemma  a.1 of @xcite .",
    "its proof proceeds as in @xcite with minor modifications , so is omitted for brevity .",
    "we remark that here only the collection of functions defined on @xmath645 $ ] are considered . for functions on @xmath646 $ ]",
    ", an analogous version of this lemma also holds true by symmetry .",
    "@xmath71    of theorem  [ thm : ls_adapt_2 ] here we only consider case ( b ) . case ( c ) can be handled similarly by symmetry .",
    "suppose that ( b ) holds true for every @xmath247 $ ] for some fixed @xmath22 .",
    "let @xmath258 and @xmath259 .",
    "note that consistency of @xmath1 implies that @xmath647 .",
    "moreover , since @xmath2 is linear on @xmath255 $ ] , we can proceed as in the proofs of theorem  [ thm : ls_triangular_rate ] and corollary  [ cor : ls_triangular_uniform_rate_derivative ] to show that @xmath648 } \\min\\big(\\hat{f}_n(t ) - f_0(t),0\\big )   = o_p(n^{-1/2})\\end{aligned}\\ ] ] and @xmath649 } |\\hat{f}_n^-(t ) - f_0'(t)|   = o_p(n^{-1/2}),\\ ] ] where @xmath650 is the left derivative of @xmath1 .",
    "therefore , it suffices to only consider the behavior of @xmath651 .",
    "the proof can be divided into four parts .",
    "a.   suppose that @xmath652 .",
    "denote by @xmath653 .",
    "then because both @xmath1 and @xmath2 are linear on @xmath654 $ ] , @xmath655 marshall s lemma entails that the left - hand side of the above equality is @xmath78 . furthermore , it has been shown that @xmath656 rearranging the above equation yields @xmath657 b.   suppose that @xmath658 .",
    "first , we modify lemma  4.2 of @xcite to the following : 1 .",
    "let @xmath659 be an arbitrary sequence of numbers converging to @xmath6 .",
    "define @xmath660 and @xmath661 .",
    "then , @xmath662 .",
    "+ here one can apply lemma  a.1 of @xcite with @xmath663 and @xmath297 to verify the above extension . by proceeding as in the proof of lemma  4.3 of @xcite",
    ", one can verify that there exists some @xmath664 such that @xmath665 and @xmath295 } |\\hat{f}_n(t ) - f_0(t)| = o_p(n^{-\\alpha/(2\\alpha+1)}).\\ ] ] since @xmath666 , it follows that @xmath667 } |\\hat{f}_n(t ) - f_0(t)| - \\hat{f}_n^-(x_0 ) ( \\tau_n^{+++}-x_0 ) - f_0(\\tau_n^{+++ } ) + f_0(x_0 ) \\\\ & \\le o_p(n^{-\\alpha/(2\\alpha+1 ) } ) - ( \\hat{f}_n^-(x_0)-f_0'(x_0 ) ) ( \\tau_n^{+++}-x_0 ) + k_2(\\tau_n^{+++}-x_0)^\\alpha = o_p(n^{-\\alpha/(2\\alpha+1)}).\\end{aligned}\\ ] ] in fact , it is easy to see that the above conclusion still holds if we change our assumption from @xmath658 to @xmath668 . c.   suppose that @xmath669 . in view of the discussion in ( ii ) , it suffices to show that @xmath668 .",
    "consider the behavior of @xmath670 ( as a function of @xmath67 ) at the middle point @xmath671 .",
    "let @xmath672 it was shown in lemma  4.2 of @xcite that @xmath673 in view of lemma  a.1 of @xcite with @xmath663 and @xmath297 , @xmath674 for any @xmath640 . on the other hand , by lemma  [ lem : ls_adapt_calculation ] , we have @xmath675 for some constant @xmath618 that only depends on the density function @xmath2 . combining ( [ eq : ls_adapt_2_proof_1 ] ) , ( [ eq : ls_adapt_2_proof_2 ] ) and ( [ eq : ls_adapt_2_proof_3 ] ) together yields @xmath668 .",
    "d.   finally , suppose that @xmath676 , @xmath677 and @xmath678 .",
    "our first aim here is to show that @xmath679 let @xmath680 since @xmath681 and @xmath676 , @xmath682 for large @xmath34 .",
    "this implies that @xmath683 for sufficiently large @xmath34 .",
    "it now follows from lemma  [ lem : ls_adapt_vc ] ( with @xmath297 and @xmath684 ) that @xmath685 for any small @xmath640 . on the other hand , in view of lemma  [ lem : ls_adapt_calculation ] and identity ( [ eq : ls_adapt_2_proof_5 ] ) , some elementary calculations yield @xmath686 plugging the above two equations into ( [ eq : ls_adapt_2_proof_1 ] ) entails that @xmath687 . as a result ,",
    "@xmath688 the rest of the proof is similar to ( b ) in the proof of theorem  [ thm : ls_adapt_1 ] . by the law of the iterated logarithm for local empirical processes , @xmath689 where the last equality follows from the linearity of @xmath690 and @xmath691 on @xmath270 $ ] .",
    "since our assumption in ( iv ) guarantees that @xmath692 , rearranging the terms in the above displayed equation leads to @xmath693 finally , as @xmath694 , we can plug ( [ eq : ls_adapt_2_proof_0 ] ) and ( [ eq : ls_adapt_2_proof_4 ] ) into ( [ eq : ls_adapt_2_proof_6 ] ) to verify @xmath695    @xmath71",
    "the first author is grateful to richard samworth for helpful conversations .",
    "the second author owes thanks to tony cai and mark low for questions concerning the problems addressed in section 2.3 .",
    "he also owes thanks to fadoua balabdaoui and hanna jankowski for conversations and initial work on the problems addressed in sections 2.1 and 2.2 .",
    "part of this work was completed while the first author visited the statistics department at the university of washington .",
    "the first author was supported by epsrc grant ep / j017213/1 .",
    "the second author was supported in part by nsf grant dms-1104832 and by ni - aid grant 2r01 ai291968 - 04 .",
    "dmbgen , l. , rufibach , k. and wellner , j. a. ( 2007 ) marshall s lemma for convex density estimation . in _ asymptotics : particles , processes and inverse problems : festschrift for piet groeneboom _ ( e. cator , g. jongbloed , c. kraaikamp , r. lopuha and j.a .",
    "wellner , eds . ) , 101107 .",
    "institute of mathematical statistics , ohio .",
    "groeneboom , p. , jongbloed , g. and wellner , j. a. ( 2001a ) a canonical process for estimation of convex functions : the `` invelope '' of integrated brownian motion @xmath696 .",
    "_ , * 29 * , 16201652 ."
  ],
  "abstract_text": [
    "<S> we prove that the convex least squares estimator ( lse ) attains a @xmath0 pointwise rate of convergence in any region where the truth is linear . </S>",
    "<S> in addition , the asymptotic distribution can be characterized by a modified invelope process . </S>",
    "<S> analogous results hold when one uses the derivative of the convex lse to perform derivative estimation . </S>",
    "<S> these asymptotic results facilitate a new consistent testing procedure on the linearity against a convex alternative . </S>",
    "<S> moreover , we show that the convex lse adapts to the optimal rate at the boundary points of the region where the truth is linear , up to a log - log factor . these conclusions are valid in the context of both density estimation and regression function estimation . </S>"
  ]
}