{
  "article_text": [
    "dwarf galaxies are believed to be the most dark matter dominated objects in the universe with dark to baryonic mass ratios even of the order of hundreds ( @xcite , @xcite ) so they seem to be the best laboratory for studying this unexplored component of the universe . for decades astronomers have been running simulations of the behaviour of dark matter ( @xcite , @xcite , @xcite ) in order to describe the structure formation , profiles of dark matter distribution , sizes and shapes of dark haloes and compare the resulting observables with the astronomical data to find the best model describing dark matter .    however , we do not have at our disposal reliable tools even to precisely measure the most basic parameter of a dwarf galaxy , its mass .",
    "the most commonly used jeans modelling @xcite based on fitting of the velocity dispersion is subject to the mass - anisotropy degeneracy @xcite , the degeneracy between the underlying mass profile and the anisotropy of orbits of the tracer particles .",
    "the degeneracy can be partially lifted by including kurtosis into the fit ( @xcite , @xcite , @xcite ) .",
    "the method however relies on the predefined anisotropy profile and is therefore dependent on the researcher s experience and/or imagination .",
    "the standard assumption is then for the anisotropy to be constant with radius , hardly true for real objects .",
    "one method which does not require the prior knowledge of the orbit anisotropy is the orbit superposition modelling , first introduced by @xcite for constructing distribution functions for triaxial galaxies .",
    "it was first applied to modeling kinematical data in spherical galaxies by @xcite and has been developed since then in the studies of massive early type galaxies and bulges of spiral galaxies , in order to derive their mass distribution and mass - to - light ratios and/or to infer the existence of the black holes in the centres of ellipticals and measure their masses ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) .",
    "the first proposed models described simplest , spherical objects ( @xcite , @xcite ) but complexity of studies increased with time ( as better data and higher computational power were emerging ) going through 3-integral axisymmetric models @xcite up to triaxial @xcite .",
    "the application of the method to dwarf galaxies has been attempted only recently .",
    "first of all , the methodology needs to be adapted because , contrary to ellipticals , dwarfs seem to be dominated by dark matter at all scales , its spatial distribution not necessarily matching the distribution of the visible tracer ( stars ) .",
    "the subject of the dark matter density profile has been a matter of extensive studies over the last decades .",
    "it is still under debate whether these profiles should be modelled as cuspy navarro - frenk - white ( nfw , @xcite ) or einasto @xcite profiles emerging from cosmological , dark matter only simulations or rather by a variety of cored profiles resulting from simulations including baryonic physics @xcite .",
    "moreover , jeans modelling of dwarf spheroidal ( dsph ) galaxies tends to suggest that they do not share any universal dark matter profile @xcite .",
    "therefore the determination of not only the total mass but also its distribution in dwarf galaxies became one of the hottest topics in galactic dynamics .",
    "the schwarzschild modelling has been applied to dsphs of the local group ( lg ) in order to obtain density profiles of their dark matter haloes in the case of fornax and draco by @xcite and @xcite and independently by @xcite for fornax , sculptor , carina and sextans .",
    "unfortunately , the results are not conclusive .",
    "whereas @xcite find cuspy profiles to be favoured over cores for all galaxies in their sample ( except for sextans but in this case the fit has been done for only two data bins ) , for fornax @xcite reject the nfw profile at a high confidence level .",
    "on the other hand , according to @xcite draco is embedded in an nfw - like halo .",
    "the differences between modelling ellipticals / bulges and dwarfs of the lg also concern the types of data available . in the case of ellipticals",
    "/ bulges we deal with the integrated light distribution and line - of - sight velocity profiles which need to be extracted from the integrated stellar spectra . in dwarfs we are able to resolve individual stars and measure their positions and line - of - sight velocities , which then require different treatment @xcite .",
    "two main approaches have been applied in the literature : one relies on using velocity moments ( @xcite , @xcite ) and the other on fitting the full line - of - sight velocity distribution ( @xcite , @xcite ) .",
    "both have some disadvantages : the former necessarily leads to the loss of some information while the latter has to struggle with large errors .    with so many conflicting results and discrepancies , the reliability of the schwarzschild orbit superposition method needs to be tested on mock data .",
    "such an experiment has been performed by @xcite but only for one mock numerical realization of a sculptor - like galaxy with an adopted anisotropy . in this work",
    "we therefore intend to investigate the reliability of the method trying to recover the mass profile of mock dark matter haloes ( as a first approximation of a dwarf galaxy ) for a larger variety of anisotropy profiles .",
    "moreover , we examine the ability of our orbit superposition code to adequately recover the anisotropy profile as a result rather than an assumption of the modelling method .",
    "this will enable us to verify if the schwarzschild modelling is truly independent of the intrinsic anisotropy and also to determine whether it is capable of recovering the velocity anisotropy profile , thereby breaking the mass - anisotropy degeneracy .",
    "the paper is organized as follows . in section [ data ]",
    "we describe the numerical models used , in section [ technicals ] we introduce the schwarzschild modelling scheme , in section [ large_sample ] we carry out the recovery of the anisotropy and mass profiles for large data sets and in section [ small_sample ] we apply the method to a data sample typical for a dwarf galaxy .",
    "we summarize our results in section [ summary ] and discuss them in the light of the available literature and current state of knowledge in section [ discussion ] .",
    "in our study we use numerical realizations of dark matter haloes containing @xmath0 particles and generated using the distribution function of @xcite .",
    "the spherically symmetric density profile of the haloes is given by the formula : @xmath1 corresponding to the cuspy , cosmologically motivated nfw profile ( with @xmath2 at the centre and @xmath3 at infinity ) within the virial radius @xmath4 and the steeper cut - off @xmath5 beyond .",
    "the cut - off is necessary to ensure the finite mass of the halo .",
    "we use models with the virial mass @xmath6m@xmath7 and concentration @xmath8 , which translate to the following values used in eq .",
    "( [ eq : mass_profile ] ) : @xmath9m@xmath7kpc@xmath10 , @xmath11kpc , @xmath12kpc , @xmath13m@xmath7kpc@xmath10 and @xmath14kpc ( see @xcite for the discussion on the dependence of the nfw profile on the cosmological model in use ) .    the models differ in the underlying orbit anisotropy profile , defined as : @xmath15 where @xmath16 are the components of the velocity dispersion in the spherical coordinate system with the origin at the centre of the halo .",
    "we use four models in total , two with anisotropy constant with radius , @xmath17 and @xmath18 , and two with varying anisotropy : growing and decreasing from 0 ( 0.5 ) at the centre of the halo to 0.5 ( 0 ) at infinity , reaching an intermediate value @xmath19 at @xmath20 .      in the observed",
    "dwarf galaxies stars are most probably distributed differently than dark matter .",
    "dark matter haloes are believed to be more extended and in our models we describe them by the nfw profile , whereas the observed ( projected ) stellar profiles are best fitted with more concentrated profiles like plummer @xcite , srsic @xcite or king @xcite .    in order to test our method on more realistic data , we decided to select subsamples of particles following the srsic profile : @xmath21,\\ ] ] where @xmath22 is the normalization , @xmath23 is the characteristic radius and @xmath24 is the srsic index .",
    "@xcite suggested a method of selecting such subsamples in dynamical equilibrium .",
    "however , the method is relatively simple only for an isotropic halo .",
    "therefore we applied another approach instead . in each halo we selected 273078 particles reaching as far as @xmath25kpc given with the deprojected srsic profile @xcite : @xmath26\\ ] ] where : @xmath27 with @xmath28kpc and @xmath29 .",
    "the normalization @xmath30 was chosen so that the maximum number of particles could be used .",
    "then , we evolved the haloes in isolation using the @xmath31-body code gadget-2 @xcite following the selected particles , until equilibrium was reached . in the following",
    "we will assume that the mass of the tracer is negligible and the selected stars move in the gravitational potential of the dark matter halo .    in fig.[fig",
    ": profile ] we compare the number density profiles of the selected tracer particles in red and all particles marked as dark matter in green . in the central part of a halo profiles are similar but the srsic profile of stars becomes steeper at @xmath32kpc and drops quickly with radius .        as shown in @xcite ( where the models we use are labelled c1 , c3 , i2 and d ) who evolved the haloes in isolation for 10gyr , the models with @xmath17 and growing anisotropy are stable and remain spherical till the end of the simulations .",
    "when considering our subsamples only , the particles achieved equilibrium , i.e. the moment when the profiles of density , radial velocity dispersion and anisotropy stopped changing , after approximately 6gyr but we let them evolve for another 2gyr and took for further analysis the outputs at 8gyr .",
    "however , the models with @xmath18 and decreasing anisotropy are subject to radial orbit instability and become significantly non - spherical in less than 1gyr . in those cases we took the outputs at 0.6gyr , keeping in mind that they are not in exact equilibrium . in all chosen outputs",
    "the total density profiles remained unchanged .",
    "after the evolution in isolation the properties of the selected particles differ slightly from the initial values , however the general behaviour remains the same in each case .",
    "we compare the number density profiles in fig.[fig : profiles_init_fin ] and the anisotropy profiles in fig.[fig : beta_init_fin ] , where the values from the initial conditions are presented in red and final values in blue for each model separately .",
    "the thin dashed vertical lines indicate the upper limit of the radius for the mock data projected along the line of sight which we adopted to be @xmath33kpc .",
    "additionally in fig.[fig : profiles_init_fin ] the dashed - dotted lines indicate the outermost radius of our orbit library ( see section [ orbits ] ) and in fig.[fig : beta_init_fin ] the green lines mark the asymptotes of the initial profiles .",
    "the changes in the profiles of anisotropy at the outer data radii are adventitious as the parameters of the initial srsic profile were chosen after deciding on the data range ( based on the anisotropy profiles ) . in all of the following figures we will refer to the initially constant models as @xmath17 and @xmath18 regardless of the variations whereas the models with the varying anisotropy will be labelled as @xmath34 and @xmath35 for the growing and decreasing profiles , respectively",
    ".         profiles are marked in green . ]",
    "in this section we present the steps of the schwarzschild method and the parameters used for the modelling which need to be adjusted to the data , mainly their size constraining a number of spatial bins which can be used and the spatial distribution constraining the energy range of the orbit library .",
    "our approach is based on the original fortran code by @xcite developed as a complete tool to model elliptical , axisymmetric galaxies .",
    "the code generates initial conditions for the orbit library by deriving the multipole expansion of the potential from a given mass profile , integrates the orbits and stores their observables , reads the observational data and fits the constraints .",
    "however , the methodology for dwarfs differs so much that we were unable to apply the code in a straightforward way .",
    "therefore , we have used only the first part of the original code which generates the initial conditions and we modified ( simplified ) it for use in the spherical case . the software necessary for the later stages of the modelling has been written especially for the purpose of this work in c`++ ` .      for the purpose of the application of the method we generated a library of 1200 orbits sampling the energy and angular momentum spaces .",
    "we used 100 values of energy in units of the radius of the circular orbit sampled logarithmically and 12 values of the relative angular momentum @xmath36 , where @xmath37 is the angular momentum of the circular orbit , sampled linearly within the open interval @xmath38 to avoid numerical errors .",
    "the initial conditions for the orbits were calculated under the assumption that each particle was placed at the apocentre of its orbit .",
    "the apocentres in the library fall between @xmath39kpc which is smaller than the upper limit of the innermost bin of the constraints ( see the next section ) and @xmath40kpc , which is @xmath41 times larger than the outer boundary of the mock observations and contains over @xmath42 of the tracer particles @xmath43 .",
    "the orbits have been integrated simultaneously in two groups using the @xmath31-body code gadget-2 , modified to accommodate a constant potential ( by adding for each particle in each timestep accelerations calculated from the gauss theorem for a given mass profile ) , for @xmath44gyr ( the inner 600 orbits ) or @xmath45gyr ( the remaining ones ) in order to cover at least a few full orbital periods even for the most extended orbits . in each case",
    "we saved 2001 outputs in equal timesteps .",
    "we assigned a very small mass to the particles to guarantee that they did not interact during the integration . storing the actual orbits and not only observables demands more disk space but allowed us to reuse the orbits and recalculate the library with different spatial binning , saving computational time .      in order to generate mock data sets",
    ", we observed each galaxy , i.e. the particles marked as stars , along an arbitrarily chosen axis , saving projected positions of the particles in terms of their distances from the centre and the line - of - sight velocities , setting the outer maximum projected radius of the data to @xmath33kpc to imitate the distribution of stars in a real dwarf galaxy .",
    "we binned the data in 30 radial bins spaced linearly . in each radial bin we derived the proper moments of velocity : the second ( @xmath46 ) , third ( @xmath47 ) and fourth ( @xmath48 ) , calculated with estimators based on the sample of @xmath31 line - of - sight velocity measurements @xmath49 @xcite : @xmath50 where @xmath51 and @xmath52 labels the radial bins .",
    "we present the resulting moments in the three panels of fig.[fig : mom_all ] with colours denoting different anisotropy models : red for the isotropic case @xmath17 , green for @xmath18 , blue for the growing anisotropy and magenta for the decreasing one .",
    "the noise , clearly visible for @xmath47 , is the consequence of the dense spatial binning .",
    "( red ) , @xmath18 ( green ) , increasing @xmath53 ( blue ) and decreasing @xmath53 ( magenta ) measured using all tracer particles . ]",
    "the kinematics of a galaxy can be also expressed in the terms of the gauss - hermite moments @xmath54 ( @xcite , @xcite ) .",
    "we have tested their application on the original data i.e. unevolved dark matter haloes , and presented the results in @xcite .",
    "they proved to be useful in recovering the anisotropy profiles but at the same time demanded large amounts of data to derive the moments correctly .",
    "as the studies of dwarf galaxies struggle with rather limited data samples , we have abandoned this approach .    in the next step",
    "we need to obtain observables for the orbits from the library .",
    "as the orbits in the spherical potential are coplanar we randomly rotated each orbit 100000 times around two axes of the simulation box and combined them to mimic the symmetry .",
    "we have noticed that the value of the resulting @xmath55 ( see next section ) depends on this random choice , i.e. on a particular set of rotation angles , therefore revealing a numerical defect of the method , as a finite set of rotation angles is not sufficient to achieve the needed level of symmetry . in a set of tests",
    "we have established that the optimal number of rotations is 100000 for which the @xmath55 varies by less than 0.1 between the selections and the computational time necessary for rotations is reasonably short .",
    "the orbits have been observed along an arbitrarily chosen axis and their observables have been stored on the same grid as the mock data .",
    "the velocity moments have been calculated following eq.([eq : mom ] ) and ( [ eq : mean ] ) .",
    "for the purpose of recovering the anisotropy we have also stored the three components of the velocity dispersion in spherical coordinates as a function of the deprojected radius in 30 linearly spaced bins in the range @xmath56$]kpc for the mock data and for the orbits .",
    "the schwarzschild method is based on the assumption that the observed kinematics of a galaxy ( or in our case of marked particles of a dark matter halo ) can be reproduced as a linear combination of the same parameters for the orbits from the library by assigning non - negative weights @xmath57 to the orbits .",
    "the fitting is performed by minimizing the deviation between the data and the linear combination of orbits in @xmath55 sense via the orbital weights . the general function to minimize",
    "is : @xmath58 under the constraints that for each @xmath59 and each @xmath52 : @xmath60 where @xmath61 , @xmath62 are the fractions of the projected mass of the tracer contained within @xmath52th bin for @xmath59th orbit or from the observations and @xmath63 , @xmath64 are @xmath65th proper moments . @xmath66 denotes the measurement uncertainty associated with a given parameter .",
    "the velocity moments are weighted with the projected masses and to derive the errors we treat both quantities as independent .",
    "we assume that tracer particles are massless and orbit in the potential of their dark matter halo . however , if the mass - to - light ratio of stars is constant with radius , then @xmath67 , where @xmath68 is a fraction of tracer particles contained within the @xmath52th bin . therefore in this study by ` projected mass ' we mean @xmath68 .    as it has been already pointed out by @xcite ,",
    "the 4th velocity moment is not independent of the 2nd moment .",
    "however , as the kurtosis ( @xmath69 ) , which is not correlated with the 2nd moment would not be linear in the orbital weights , it can not be used as a constraint for the schwarzschild modelling . we therefore proceed neglecting the possible correlations .",
    "we used an additional constraint on the sum of the weights .",
    "as the weights have the physical meaning of the amount of mass assigned to the corresponding orbits , they should sum up to unity as long as an orbit library covers the whole ( or typically in numerical studies @xmath70 , which holds for our library ) deprojected mass of the tracer : @xmath71    the minimization of the objective function under the equality and inequality constraints has been executed using quadratic programming as implemented in the cgal library ( the computational geometry algorithms library , @xcite ) .",
    "we calculate the resulting anisotropy @xmath53 in the @xmath52th bin by assuming that : @xmath72 where @xmath73 are the components of the velocity dispersion in the spherical coordinate system for the @xmath59th orbit calculated in the @xmath52th spatial bin .",
    "first , we check how reliably we can recover the anisotropy profile alone .",
    "for this purpose we assumed that the correct mass profile ( see section [ data ] ) was known and performed the fitting of the mock data to the orbit library calculated in the potential generated by this distribution . in each of the 30 radial bins we applied 6 constraints : the rigid lower and upper boundaries for the mass projected along the line of sight and the @xmath55 fit for the velocity moments 1 - 4 given with eq.([eq : mom ] ) and ( [ eq : mean ] ) .",
    "we assumed poissonian errors for the projected masses and the theoretical sampling errors of standard deviation , skewness and kurtosis @xcite propagated to the velocity moments . by definition , @xmath74 up to numerical precision ( typically @xmath75 ) so we applied a fixed value of @xmath76 everywhere .",
    "the results are presented with magenta curves in fig.[fig : beta_all ] together with the true values ( in red ) calculated from the full 6d information about the particles .",
    "the four panels refer to the models with different anisotropy .",
    "the accuracy of the recovered profiles is remarkable , with only some noise .",
    "confidence level . ]",
    "we also need to comment on the missing results for the innermost bins in fig.[fig : beta_all ] and the following figures presenting recovered anisotropies . in our opinion",
    "the innermost bin is underconstrained , having only one neighbour and many orbits contained entirely within one or two bins ( which is not the case for the outermost bin ) so one can not rely on the results in this bin .",
    "this effect manifests itself notably for the small data samples leading to enormous ( when compared to other bins ) and highly non - gaussian errors .",
    "a problem of the innermost bin has been already reported by @xcite , however with a different justification .",
    "we also examined the possibility of recovering the underlying mass profile for the four models .",
    "we constructed a grid of profiles given with eq.([eq : mass_profile ] ) with the values of the virial mass and concentration spaced linearly in the ranges : @xmath77\\times 10 ^ 9\\mathrm{m}_{\\sun}$ ] and @xmath78 $ ] .",
    "the parameters of cut - off in the mass profile , i.e. @xmath31 and @xmath79 , were in each case adopted so that the profile and its first derivative at the distance of the virial radius were continuous . for each profile",
    "we integrated the library of orbits as explained in section [ orbits ] .",
    "similarly to the procedure described in the previous section , for each model we used the projected mass and the velocity moments 1 - 4 in 30 spatial bins as constraints to fit the orbit library .",
    "the absolute values of the @xmath55 function , eq.([eq : fit ] ) , have been saved and we compare them in fig.[fig : chi_all ] , where each panel corresponds to a different anisotropy model .",
    "the logarithmic colour scale represents the differences of the values of @xmath55 relative to the minimum ( @xmath80 ) of the fitted two dimensional surfaces of the 4th order ( @xmath81 ) .",
    "the minima are marked with yellow dots .",
    "the white lines indicate the contours of equal @xmath82 corresponding to @xmath83 confidence levels for two degrees of freedom @xcite also based on the fitted surfaces .",
    "the concentration is constrained much more poorly than the virial mass as it is a very sensitive parameter .",
    "we have found the fitting of a surface necessary in order to derive a global minimum and contours of equal @xmath84 as the schwarzschild method is severely influenced by numerical effects and therefore one should consider trends rather than particular values . the discretization appears on many levels and can not be avoided : a smooth distribution function of a galaxy is represented by a finite set of deltas ( orbits ) , continuous orbits are represented by a finite set of timesteps and the spherical symmetry is represented by a finite set of rotations of the orbits .",
    "the true values of the mass profiles are marked with red dots and in each case lie within the @xmath85 regions .",
    "the models on the adopted grid closest to the minima of the fitted surfaces along the contours of equal @xmath84 are identified as the best - fitting models and marked with green dots . for the galaxy with the decreasing anisotropy profile the best - fitting and true density models overlap .",
    "the resulting anisotropy profiles for the best - fitting models are plotted in fig.[fig : beta_all ] in blue .    using the @xmath85 regions of the recovered mass profiles we estimated errors on the values of the recovered anisotropy by taking in each bin the extreme values among the mass profiles within @xmath86 .",
    "the results are shown in fig.[fig : beta_all ] as the shaded regions , following well the values and shapes of the true anisotropies .    despite the mass - anisotropy degeneracy , with our method",
    "we have recovered the proper values of both the anisotropy and the mass profile : @xmath87 and @xmath88 for each model with high accuracy , independently of the underlying anisotropy .",
    "values relative to the minima of fitted surfaces for four anisotropy models on the grids of different mass profiles .",
    "the global minima are marked with yellow dots and the true values with red ( in the case of the decreasing anisotropy they overlap ) .",
    "green points indicate the best - fitting mass profiles , i.e. the profiles on the grid closest to the global minima along the contours of equal @xmath84 plotted with white curves . ]",
    "the anisotropy can be equally well recovered using only the 2nd and 4th velocity moments . however , the addition of the 1st and 3rd moments to the fit , which is not typical , influenced the recovery of the mass profile , providing an estimate with a higher confidence .",
    "as it will prove to be of great importance in the next section , we decided to use all the moments .",
    "section [ large_sample ] shows the strength of the schwarzschild modelling in breaking the mass - anisotropy degeneracy .",
    "the weak point of this argument is the amount of data we used , which is impossible to achieve in the case of dwarf galaxies of the lg . in order to test our method on realistic samples , for each of the galaxy models we randomly chose 100000 stellar particles with positions ( in observations those are stars with",
    "only photometry measured ) and 2500 particles with positions and line - of - sight velocity ( corresponding to spectroscopic data ) contained within the projected radius of 6kpc and binned them in 10 radial bins spaced linearly .",
    "it is typical for the treatment of small data samples to adjust binning to the data by fixing the number of stars in the bin .",
    "however , as it may cause some errors in radius ( as the number of stars is known only with certain accuracy ) impossible to correct for in our method , we decided to keep the predefined , fixed binning .      for observational data the sampling errors dominate over the measurement errors of line - of - sight velocities for single stars and are therefore the main source of uncertainties imposed on the velocity moments .",
    "in order to estimate them properly we ran monte carlo ( mc ) simulations deriving the sampling errors for various parameters ( @xmath53 , @xmath46 , @xmath47 , @xmath48 ) for the adopted spatial binning and for each halo model as a function of a number of particles in each bin in the range of sample sizes from @xmath89 to @xmath90 particles with the step of @xmath91 . between the nodes of such a dense grid",
    "the errors can be interpolated linearly .",
    "this allowed us to apply our method regardless of the size of the current data sample .",
    "we took advantage of it when running the next set of tests . for each halo we randomly selected our data samples , assigned the errors and fitted the orbit library , repeating the procedure 10000 times .",
    "the resulting distributions of the anisotropy profiles were fitted with gaussians in order to derive the mean values and the @xmath85 deviations , in each spatial bin separately .",
    "the results for all models are shown in fig.[fig : beta_errors ] in cyan , dark blue and magenta , depending on the number of orbits used for the fit .",
    "we used : 5000 ( a library larger than the one used in the study ; 200 values of energy @xmath92 25 values of angular momentum ) , 1200 ( the default library ; 100 @xmath92 12 ) and 600 ( a smaller one ; 75 @xmath92 8) , respectively .",
    "in red we present the true values for the anisotropy derived from full 6d information about the particles .",
    "we note the rather high accuracy of the obtained mean values and the relatively small errors which allow to clearly differentiate between different models of anisotropy .",
    "the uncertainties in the resulting anisotropy , derived with our method from the projected positions and line - of - sight velocities are only @xmath93 larger than the sampling errors for the anisotropy calculated from full deprojected positions and three - dimensional velocity vectors , i.e. variations in the anisotropies originating from taking random small samples of particles ( compare with fig.[fig : beta_ss ] ) .",
    "the growth of the errors with radius is a consequence of the decreasing number of particles in subsequent bins .",
    "the offset between the true values and the mean ones is a consequence of the changes of anisotropy outside the modelled area .",
    "also the mean values seem to follow a weak trend in which the anisotropy is recovered less precisely for fewer degrees of freedom ( less orbits in a library ) , whereas in all cases the deviations remain roughly the same .",
    "we may trace it back to the fitting procedure and the applied rigid constraints which diminish the impact of the kinematical constraints .",
    "error bars resulting from the mc simulations . in red",
    "we present the values based on direct measurements from the full data and in cyan , blue and magenta results for the fits done with libraries of 5000 , 1200 and 600 orbits , respectively . ]      in this section we present the results of modelling four sets of mock data for 100000 ( positions ) and 2500 ( velocities ) randomly selected particles , one for each model . fig . [",
    "fig : mom_ss ] shows the kinematics of the samples as points with @xmath85 errors derived in section [ simulations ] and for comparison the same parameters for all stellar particles from the simulations with the same binning as thin dashed lines .",
    "colours denote different anisotropy models : red for the isotropic case @xmath17 , green for @xmath18 , blue for the growing anisotropy and magenta for the decreasing one .",
    "( red ) , @xmath18 ( green ) , increasing @xmath53 ( blue ) and decreasing @xmath53 ( magenta ) .",
    "the points with the @xmath85 error bars represent the values for the random samples of @xmath94 stars , while the thin dashed lines show the results based on all stellar particles from the simulations with the same binning . ]",
    "the profiles of the anisotropy are shown in fig .",
    "[ fig : beta_ss ] where the red points correspond to true values from the data sample and blue ones to the recovered anisotropy , both with the errors calculated in section [ simulations ] .",
    "the smooth cyan curves present the values for all stellar particles from the simulations for comparison .     errors . ]      as for the large data samples , we also studied the reliability of recovering the mass profile for our small data samples , fitting libraries of 1200 orbits integrated in the potentials generated by the mass profiles described in section [ profiles_30 ] .",
    "we present the resulting colour maps of @xmath95 as a function of virial mass and concentration in fig.[fig : chi_ss ] . as it has been done in section [ profiles_30 ]",
    ", we derived the minima and @xmath83 confidence levels by fitting two - dimensional surfaces to the @xmath55 maps .",
    "for the stable models ( @xmath17 and @xmath96 , see section [ tracer ] ) the virial masses are overestimated whereas the concentrations are underestimated , covering the true profiles within @xmath97 .",
    "this suggests that the particles ` feel ' a slightly different potential .    for @xmath17",
    "we have confirmed that this is not an outlier , i.e. an unfortunate random sample , in a test in which we studied 10000 different random samples ( as for the sampling errors of recovered anisotropy , section [ simulations ] ) , fitting all the orbit libraries and calculating the mean @xmath55 values for each library .",
    "this behaviour might be a consequence of our choice of the outer radius of the data sets as the anisotropy grows rapidly outside it ( see fig.[fig : beta_init_fin ] ) .",
    "the particles which are in large physical distance from the centre still enter our calculations since their projected distances are smaller so that the small samples are contaminated by the particles on radial orbits .",
    "higher values of line - of - sight velocities cause the line - of - sight velocity dispersion to grow , which ( under the assumption of the dynamical equilibrium ) leads to overestimation of the total mass .",
    "unfortunately , those particles also affect the values of sampling errors , enlarging them .",
    "it was not the case for the large samples as ` contaminants ' were outnumbered by ` well - behaved ' particles and the errors were calculated analytically . for the unstable models the situations is even worse .",
    "larger sampling errors result in poorly constrained density profile , spanning large area of our grid .",
    "values relative to the minima of the fitted planes for four models on the grid of different mass profiles for the small data samples of 100000/2500 particles .",
    "thin white lines indicate the contours of equal @xmath98 corresponding to @xmath99 confidence levels .",
    "the true values of the density profiles are marked with red dots . ]",
    "as the @xmath85 regions are large and may not be very accurate , we decided not to identify the minima as the best - fitting models .",
    "instead , in fig.[fig : beta_shade ] we present only the ranges ( shaded regions ) of the values of anisotropy spanned by the results for the density profiles within @xmath85 .",
    "the true values of anisotropy are presented with cyan and red lines for all particles and small samples , respectively .",
    "the blue lines correspond to the results for the true mass profiles for comparison .     confidence level .",
    "in cyan we present the values based on direct measurements from the full data from the simulations , in red the values based on the used samples and in blue the values for the true mass profile . ]    despite the wide ranges of the similarly plausible density profiles , the derived anisotropy intervals are not much larger than the sampling errors for the known mass distribution . on average the deviations",
    "are larger by @xmath100 for the stable models ( with @xmath17 and with the growing profile ) , @xmath101 for @xmath18 and @xmath102 for the model with decreasing anisotropy .",
    "nevertheless the intervals include the correct values and follow the general behaviour of the anisotropy profiles .",
    "our approach is simplistic and does not provide a full picture as the recovered anisotropy for each mass profile is additionally subject to the sampling errors as presented in section[simulations ] .",
    "we have presented a study aimed at determining the efficiency of recovering the anisotropy and density profiles by the application of the schwarzschild modelling method to a set of four dwarf galaxies obtained from the numerical realizations of nfw dark matter haloes by marking particles described with a srsic profile and following their evolution in isolated haloes in order to achieve equilibrium .",
    "the models shared the same spherically symmetric density profile but differed in the orbit anisotropy , covering a wide class of possible profiles and therefore allowing for a thorough test of the scheme .",
    "we have tested in total four models of anisotropy , two constant with radius @xmath17 ( isotropic model ) and @xmath18 , and two with anisotropy varying with radius , one growing and one decreasing .",
    "we performed our tests applying two different approaches , and in addition using two types of samples , which we called _ large _ and _ small_. the large sample contained over 270000 particles within the projected radius of @xmath103kpc used as the outer boundary of the mock data .",
    "as the small samples we used subsamples of the large ones by randomly choosing 100000 particles with positions and 2500 particles with positions and line - of - sight velocities imitating the best data samples currently available for dwarf galaxies of the lg .",
    "first , we assumed we knew the density profile exactly and performed the fitting of the observables in order to retrieve only the anisotropy profile .",
    "our results for the large samples show that the anisotropy can be recovered with very high accuracy independently of its profile .",
    "we have demonstrated that also for the small samples our method provides interesting results .",
    "we carried out a set of mc simulations in order to determine the sampling errors imposed on the recovered values of the anisotropy , deriving the mean value over the profiles and the radial bins of @xmath104 , only @xmath93 larger than the mean sampling error for the anisotropy .",
    "such small errors enable us to clearly distinguish between the different models of anisotropy we used , proving the strength of the schwarzschild method in this respect .    in the second approach we tested how precisely we can recover both the mass and anisotropy profiles .",
    "we assumed that the profile was given by the nfw formula with a cut - off at the distance of the virial radius and we constructed a grid of orbit libraries by varying the virial mass and the concentration .",
    "for the large data samples we have recovered the true mass profile for each halo model within the confidence level of @xmath85 whereas for the small samples the parameters of the density profiles were strongly degenerated , resulting in extended regions of possible values . however , the correct values were included within at least @xmath97 confidence regions .",
    "finally we have calculated the uncertainties associated with the anisotropy and coming from the uncertainty of the recovered mass profile .",
    "they are not much larger ( by only @xmath100 for the two reliable models ) than the sampling errors derived from our mc simulations demonstrating that the unknown mass distribution affects anisotropy similarly to the limited amount of data .",
    "the attempts to recover the anisotropy for dwarf galaxies with schwarzschild modelling were already made for fornax dsph @xcite and draco dsph @xcite but without a clear demonstration that the undertaken procedures actually work . here , we have filled this gap by showing that the anisotropy , regardless of its profile , can indeed be recovered by this method .    for the purpose of simplicity",
    "we have tested the method on numerical realizations of dark matter haloes only , therefore neglecting the stellar component . however , as dwarf galaxies are believed to be highly dark matter dominated , at first approximation we may assume that the influence of stars on the dynamics of the system is in fact negligible and stars move in the potential generated by the distribution of dark matter .",
    "however , we need to bear in mind that as a result we obtain the _ total _ mass profile in which the orbit library has been integrated and the anisotropy profile of the _ tracer_. we plan to implement the stellar mass to the fit in future extensions of our models by quantifying total mass in terms of the mass - to - light ratio varying with radius @xmath105",
    ".    yet another complication may arise from the stellar mass - to - light ratio @xmath106 varying with radius .",
    "however , as there is no strong evidence for its gradients in dwarfs ( even for the ones with multiple stellar populations ) it is typical to assume that the parameter is constant . it has been derived for many galaxies of the lg @xcite .",
    "@xcite did similar work to the one presented here , testing the schwarzschild modelling on the mock sculptor dsph with anisotropy assumed to be constant with radius , @xmath107 .",
    "these authors obtained good estimates of the mass profile , which we were not able to reach for our haloes , so we conclude that the parametrization of the mass profile may play a role in recovering precise values as the stars , concentrated at the centre of the dark matter halo , do not feel the mass distribution at the virial radius .",
    "after reparametrization of the density profiles , we found that the mass contained within 6kpc ( @xmath108 ) was constrained much better ( overestimated by no more than 50% ) but the characteristic radius of the nfw profile ( @xmath20 ) could be overestimated as much as 4 times for the unstable models and small data samples . also the underlying anisotropy profile ( tangential vs. our radial )",
    "may affect the quality of the mass profile recovery .",
    "as the final remark we would like to comment on two tools often applied to the orbit superposition method in order to enforce smoother , more physical distribution function .",
    "the first tool is the regularization ( @xcite , @xcite ) , which imposes a penalty term restraining the values of the weights of the consecutive orbits ( in the energy , angular momentum or both ) so that they do not differ _",
    "too much_. the expression ` too much ' is not precise and the strength of the regularization is a moot point .",
    "the regularization worsens the quality of the fit and for example @xcite imposed a constraint on the resulting @xmath55 value such that it was not to be changed by the regularization by more than @xmath109 when compared with the non - regularized case .",
    "@xcite used an arbitrary value of the regularization strength which according to them worked well . in our opinion such approaches do not affect the distribution function of the system sufficiently to classify it as smooth while much higher values of regularization strength result in diminishing the role of the observational constraints and cause the regularization to dominate .",
    "therefore , following the example of @xcite , we have decided not to apply the regularization at all .",
    "the other tool is the _ dithering _",
    "( @xcite , @xcite ) in which one orbit in a library is constructed as a compound of a few ( typically 5 - 8 ) orbits with close values of energy and angular momentum . despite of being in fact equivalent to very strong regularization on the subgrid level , dithering is much more quantitative and we do not discard the possibility of including it in our modelling in the future .",
    "this research was supported in part by the polish ministry of science and higher education under grant 0149/dia/2013/42 within the diamond grant programme for years 2013 - 2017 and by the polish national science centre under grant 2013/10/a / st9/00023 .",
    "we thank r. wojtak for sharing @xmath31-body realizations of dark matter haloes with different anisotropy profiles .",
    "mv acknowledges support from hst - ar-13890.001 , nsf awards ast-0908346 , ast-1515001 , nasa - atp award nnx15ak79 g ."
  ],
  "abstract_text": [
    "<S> we present a new study concerning the application of the schwarzschild orbit superposition method to model spherical galaxies . </S>",
    "<S> the method aims to recover the mass and the orbit anisotropy parameter profiles of the objects using measurements of positions and line - of - sight velocities usually available for resolved stellar populations of dwarf galaxies in the local group . to test the reliability of the method </S>",
    "<S> , we used different sets of mock data extracted from four numerical realizations of dark matter haloes . </S>",
    "<S> the models shared the same density profile but differed in anisotropy profiles , covering a wide range of possibilities , from constant to increasing and decreasing with radius . </S>",
    "<S> the tests were done in two steps , first assuming that the mass profile of the dwarf is known and employing the method to retrieve the anisotropy only , and then varying also the mass distribution . </S>",
    "<S> we used two kinds of data samples : unrealistically large ones based on over 270000 particles from the numerical realizations and small ones matching the amount of data available for the fornax dwarf . </S>",
    "<S> for the large data samples we recover both the mass and the anisotropy profiles with very high accuracy . </S>",
    "<S> for the realistically small ones we also find a reasonably good agreement between the fitted and the input anisotropies , however the total density profiles can be significantly biased as a result of their oversensitivity to the available data . </S>",
    "<S> our results therefore provide convincing evidence in favour of the applicability of the schwarzschild method to break the mass - anisotropy degeneracy in dwarf galaxies .    </S>",
    "<S> [ firstpage ]    galaxies : dwarf  galaxies : fundamental parameters  galaxies : kinematics and dynamics  local group  dark matter </S>"
  ]
}