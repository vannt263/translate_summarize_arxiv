{
  "article_text": [
    "the stationary nonequilibrium density matrix @xmath0 of current carrying steady states is one of the most fundamental objects of nonequilibrium quantum statistical mechanics and quantum transport theory.@xcite this is because it yields the expectation values of any single - particle observable , while its diagonal elements give directly the particle density.@xcite for example , @xmath1,\\ ] ] makes it possible to compute charge current , spin current , and spin density in systems out of equilibrium when the corresponding operators ( i.e. , their matrix representation ) are inserted as @xmath2 .    in the case of steady - state transport of non - interacting quasiparticles",
    "described using popular tight - binding hamiltonians,@xcite one can obtain charge or spin currents in the linear - response regime using the nonequilibrium green function ( negf)-based expressions@xcite that do not invoke @xmath0 explicitly .",
    "however , the inclusion of atomistic details of the device through self - consistent hamiltonians , typically obtained@xcite from or fitted@xcite to density functional theory ( dft ) , requires the knowledge of equilibrium density matrix @xmath3 to describe the charge transfer between different atomic species@xcite or @xmath0 to describe the charge redistribution due to the current flow at finite bias voltage.@xcite otherwise , without computing the charge redistribution and the corresponding self - consistent electric potential profile across the device the current - voltage characteristics violates@xcite gauge invariance , i.e. , invariance with respect to the global shift of electric potential by a constant , @xmath4",
    ".    the explicit construction of @xmath0 can play an important role in solving the complicated problem of steady - state transport in interacting quantum many - particle systems far from equilibrium .",
    "for example , the recent efforts@xcite have constructed an effective equilibrium - like ( i.e. , written in the usual boltzmann form ) density matrix , , using device hamiltonian @xmath5 and an additional operator @xmath6 which encodes information about the finite bias voltage applied between the two attached electrodes",
    ".    one of the key issues in applying eq .   to specific problems is to remove possible equilibrium contribution to a physical quantity of interest , if such quantity has a non - zero expectation value in the absence of bias voltage that is compatible with the time - reversal invariance .",
    "for example , spintronic systems are abundant in such situations : ( _ i _ ) since spin current operator is time - reversal invariant , it can have non - zero expectation values in the thermodynamic equilibrium , as highlighted@xcite by the case of equilibrium local currents in two - dimensional electron gases ( 2degs ) with the rashba spin - orbit coupling ( soc ) ; ( _ ii _ ) the spin operator is not time - reversal invariant , so spin density can be non - zero in thermodynamic equilibrium on the proviso that time - reversal invariance is broken by internal or external magnetic fields ; ( _ iii _ ) the so - called field - like or perpendicular component@xcite of the vector of spin - transfer torque ( stt ) in magnetic tunnel junctions ( mtjs ) has non - zero value in equilibrium.@xcite    another example of equilibrium quantities that appear in the formalism , but are not measured in standard transport experiments , are circulating or diamagnetic currents which appear in a system breaking the time - reversal invariance either by applying an external magnetic field or due to the spontaneous magnetization .",
    "they contribute to the local charge current density , @xmath7 , which is signified by dependence of the kubo nonlocal conductivity tensor @xmath8 on _ all _ states below the fermi energy.@xcite thus , theoretical description of charge transport in multiterminal hall bridges must remove diamagnetic currents in order to produce experimentally measurable quantities , such as conductance coefficients connecting voltages and total charge currents in different terminals , which depend only on the states in some shell ( defined by the temperature ) around the fermi surface.@xcite    similarly , nave applications of the kubo formula to the thermal hall coefficient always yields unphysical result due to the presence of the equilibrium circulating energy flow.@xcite that is , when time - reversal invariance is broken by magnetic field , the temperature gradient appears to be driving both the transport and the circulating heat currents .",
    "although both contributions are present in the microscopic current density calculated by the standard linear - response theory , a proper subtraction of circulating component is necessary since such quantity is _ not observable _ in the transport experiments .    on the other hand , in the literature on quantum transport of spin and",
    "charge one often finds expressions@xcite for @xmath0 which yield ambiguous results for the nonequilibrium expectation value of quantities like spin density , stt and local spin or charge currents .",
    "that is , being gauge non - invariant such expressions improperly subtract expectation value in equilibrium ( computed at zero bias voltage ) , where ambiguity arises due to dependence on the chosen way of splitting the bias voltage between the source and the drain electrodes of the device .",
    "[ fig : fig1 ]    the stt is a phenomenon in which a spin current of sufficiently large density injected into a ferromagnetic ( f ) layer either switches its magnetization from one static configuration to another or generates a dynamical situation with steady - state precessing magnetization.@xcite the origin of stt is the absorption of the itinerant flow of angular momentum components normal to the magnetization direction .",
    "it represents one of the central phenomena of the second - generation spintronics , focused on manipulation of coherent spin states , since the reduction of current densities ( currently of the order 10@xmath9 - 10@xmath10 a/@xmath11 ) required for stt - based magnetization switching is expected to bring about commercially viable magnetic random access memories.@xcite the rich nonequilibrium physics@xcite arising in the interplay of spin currents carried by fast conduction electrons and slow collective magnetization dynamics is also of great fundamental interest .    for conventional",
    "f@xmath12/i / f magnetic tunnel junctions ( mtjs ) illustrated in fig .",
    "1(a ) , where the reference f@xmath12 layer with fixed magnetization @xmath13 plays the role of an external spin - polarizer and i stands for a thin insulating barrier , it is customary to analyze the in - plane ( also called `` damping - like''@xcite ) and perpendicular ( also called `` field - like''@xcite ) components of the stt vector @xmath14 the in - plane torque @xmath15 is purely nonequilibrium and competes with the damping .",
    "the perpendicular torque @xmath16 arises from spin reorientation at the interfaces and possesses both the equilibrium ( i.e. , interlayer exchange coupling ) and the nonequilibrium contributions which act like an effective magnetic field on the magnetization @xmath17 of the free f layer .",
    "the often presumed@xcite bias voltage dependence of stt components in mtjs , and , is violated in asymmetrically designed mtjs ( where the bias dependence of @xmath18 acquires a linear @xmath19 contribution@xcite ) or at large @xmath20 where recent experiments@xcite have uncovered deviations from these simple formulas .",
    "the most accurate stt experiments ( such as those based on spin - transfer - driven ferromagnetic resonance@xcite ) have access only to the derivatives of @xmath21 and @xmath22 with respect to @xmath20 .",
    "thus , only the nonequilibrium contributions driven by the nonzero bias voltage between the left and the right electrode are accessed experimentally . accordingly , the equilibrium contribution@xcite to @xmath22 ( such as @xmath23 above ) should be removed when comparing theoretical predictions with experimental results .    at finite bias voltage",
    ", one can simply compute to extract numerically the purely nonequilibrium perpendicular torque.@xcite however , this fails at small @xmath20 due to substantial numerical errors accumulated when subtracting two nearly equal numbers .",
    "also , in the spirit of the linear - response theory , one should be able to express near - equilibrium transport quantities solely in terms of wavefunctions or gfs computed at zero bias voltage.@xcite in symmetric mtjs with identical f and f@xmath12 layers , one can eliminate equilibrium value of @xmath22 by using the special gauge ( i.e. , the reference level for the electric potential ) where voltage @xmath24 is applied to the left and @xmath25 to the right electrode , or vice versa.@xcite this trick , however , is not applicable to setups with f and f@xmath12 layers of different thickness or when they are made of different materials.@xcite    moreover , it can not be applied to recently predicted@xcite unconventional stt driven by soc in asymmetric n / i / f or n / ti / f _ vertical _ heterostructures , where ti is a thin slab of three - dimensional topological insulator@xcite and strong rashba soc exists at i / f or ti / f interface , as illustrated in fig .",
    "1(b ) . in the case of such `` semi - mtjs '' containing only one f layer ,",
    "current flowing perpendicularly through the i / f or ti / f interface will induce both @xmath22 and @xmath21 on the free f layer even in the linear - response regime .",
    "this happens in the absence of any additional spin - polarizing f@xmath12 layer through a mechanism closely related to the tunneling anisotropic magnetoresistance@xcite ( tamr ) in the case of n / i / f junctions,@xcite or a combination of tamr - based effect and spin - polarizing action of the ti slab ( where current becomes polarized in the direction of transport ) in the case of n / ti / f junctions.@xcite    another type of unconventional torque driven by soc has attracted considerable attention recently.@xcite the so - called so torques occur in laterally patterned n / f / i ( or n / f ) heterostructures composed of a single ultrathin ( typically thinner than @xmath26 nm ) f layer in contact with n layer made of a heavy metal with large atomic soc . the structural inversion asymmetry of these heterostructures can generate strong interfacial rashba soc , as illustrated in fig .",
    "1(c ) where we assume ( as suggested by the recent first - principles analysis@xcite ) that soc is located at the n / f interface .",
    "it has been known for a long time,@xcite and confirmed by the recent experiments on semiconductor heterostructures,@xcite that in - plane longitudinal dc charge current flowing through a rashba spin - split 2deg will induce nonequilibrium spin density pointing in the transverse direction .",
    "this mechanism  the so - called edelstein effect ",
    "provides one of the two possible explanations@xcite for the very recent experimental observations@xcite of magnetization switching of co ( or cofeb or py ) layer within pt / co / alo@xmath27 ( or ta / cofeb / mgo or pt / py ) heterostructures with structural inversion asymmetry where current flows parallel to the n / f plane . the key quantity that has to be calculated in the theoretical analysis@xcite of so",
    "torques is the nonequilibrium spin density within the rashba 2deg with an additional zeeman term generated by the proximity to the f layer .",
    "thus , the usage of gauge - noninvariant @xmath0 expressions@xcite here would give an incorrect result due to the fact that this system has non - zero spin density in equilibrium , which is allowed by the time - reversal symmetry breaking due to the zeeman term .",
    "we provide a detailed explanation in sec .",
    "[ sec : rho ] on how to construct the proper gauge - invariant expression for the nonequilibrium density matrix @xmath0 while using widely employed negfs@xcite for devices attached to two macroscopic reservoirs at different electrochemical potentials .",
    "our key results  eq .   and its zero - temperature version eq .",
    "ensures that no equilibrium contribution is included in the current - induced nonequilibrium expectation values of physical quantities .",
    "section  [ sec : applications ] shows applications of this formalism to the computation of the components of conventional ( in f / i / f mtjs ) and unconventional ( i.e. , driven by the interfacial soc in vertical n / i / f or laterally patterned n / f / i heterostructures ) spin torque for junctions illustrated in fig .  1 . for each of the three cases",
    ", we also show the size of the error generated by the usage of popular but improper gauge - noninvariant expressions@xcite for @xmath0 .",
    "we conclude in sec .",
    "[ sec : conclusions ] .",
    "let us consider a finite - size open quantum system described on a tight - binding lattice@xcite where the operator @xmath28 ( @xmath29 ) creates ( annihilates ) electron with spin @xmath30 on site @xmath31 ( specific examples of such hamiltonians are given in sec .",
    "[ sec : applications ] ) .",
    "the negf formalism@xcite operates with two fundamental objects  the retarded and the lesser gf that describe the density of available quantum states and how electrons occupy those states , respectively . here",
    "@xmath32 denotes the nonequilibrium statistical average.@xcite in stationary problems , @xmath33 and @xmath34 depend only on the time difference @xmath35 , or energy @xmath36 after the fourier transform.@xcite    we assume that the system is opened by being attached to two macroscopic reservoirs",
    " left ( l ) and right ( r)which drive charge current when they have different electrochemical potentials and , thereby , different fermi functions . the reservoirs and dissipation they are responsible for",
    "do not have to be modeled explicitly .",
    "instead , one introduces the left and the right semi - infinite ideal leads through their retarded self - energies@xcite @xmath37 , so that hamiltonian of a finite - size but open quantum system acquires a continuous spectrum .",
    "the continuous spectrum is sufficient to bring the system into a true nonequilibrium steady - state with a finite value of dc current at long enough times as demonstrated by , e.g. , real - time diagrammatic monte carlo simulations of nonequilibrium quantum transport@xcite .    in stationary situations , either due to thermodynamic equilibrium or steady - state current flow ,",
    "the density matrix @xmath38 can be expressed@xcite in terms of the lesser gf @xmath39 in the case of elastic transport regime ( i.e. , when electron - electron , electron - phonon , and electron - spin dephasing processes can be neglected ) , the lesser gf @xmath40 \\hat{g}^a(e),\\ ] ] is given solely in terms of the retarded gf , @xmath41 . here",
    "@xmath42^\\dagger$ ] is the advanced gf , and @xmath43 $ ] are the level broadening operators which quantify escape rates of electrons into the semi - infinite leads .",
    "the usual assumption about the leads is that the applied bias voltage @xmath20 induces a rigid shift in their electronic structure,@xcite so that @xmath44    to simplify computation , integration in eq .   for the elastic transport regime version of @xmath45 in eq .",
    "is typically separated into apparent `` equilibrium '' and `` nonequilibrium '' terms as follows.@xcite we first add and subtract the term @xmath46 to eq .  , to get after some rearrangements @xmath47.\\end{aligned}\\ ] ] by substituting the following identity @xmath48,\\end{aligned}\\ ] ] into eq .  , we finally obtain @xmath49.\\ ] ]",
    "this allows us to rewrite eq .   as the sum of two contributions @xmath50 f(e - ev_r ) +   \\frac{1}{2 \\pi } \\int\\limits_{-\\infty}^{+\\infty}de \\ ,   \\hat{g}^r(e ) \\cdot \\hat{\\gamma}_l(e - ev_l ) \\cdot",
    "\\hat{g}^a(e ) \\left [ f(e - ev_l ) - f(e - ev_r ) \\right].\\ ] ] the first `` equilibrium '' term contains integrand which is analytic in the upper complex plane , so that it can be computed via the semicircular path combined with the path in the upper complex plane parallel to the real axis.@xcite because the functions @xmath41 and @xmath51 are nonanalytic below and above the real axis , respectively , the integrand in the second `` nonequilibrium '' term is nonanalytic function in the entire complex energy plane , so that integration@xcite has to be done directly along the real axis between the boundaries around @xmath52 and @xmath53 determined by the difference of the fermi functions ( @xmath54 is the fermi energy for the whole device in equilibrium ) .    while the second `` nonequilibrium '' term in eq .",
    "contains information about the bias voltage [ through the difference ] , as well as about the lead assumed to be injecting electrons into the device ( through @xmath55 ) , it can not be used as the proper nonequilibrium density matrix which is defined by @xmath56 f(e),\\ ] ] where @xmath57^{-1},\\ ] ] is the retarded gf at zero bias voltage .",
    "this is due to the fact that second term in eq .",
    ", as the negf expression for the equilibrium density matrix @xmath3 , does not cancel the gauge - noninvariant first term in eq .   which depends explicitly [ through @xmath58 on the arbitrarily set @xmath59 and implicitly on the voltages applied to both reservoirs [ through @xmath41 ] .",
    "nevertheless , the second term in eq .  , @xmath61,\\end{aligned}\\ ] ] written in the linear - response and typically zero - temperature limit ( where it becomes the fermi surface property ) @xmath62 is often used in the quantum transport literature@xcite as the putative but improper ( due to being gauge - noninvariant ) expression for @xmath0 .",
    "thus , its usage leads to ambiguous ( i.e. , dependent on the chosen @xmath59 ) nonequilibrium expectation values .    to derive the proper gauge - invariant @xmath0 in the linear - response limit ,",
    "we first expand the retarded gf @xmath63^{-1},\\end{aligned}\\ ] ] to linear order in the bias voltage @xmath20 . here",
    "@xmath64 is the potential profile across the active region of the device when the current is flowing which interpolates between @xmath65 and @xmath59 .",
    "this is achieved in two steps , where we first rewrite eq .   using the exact dyson equation@xcite @xmath66 \\hat{g}^r(e).\\end{aligned}\\ ] ] in the second step",
    ", we expand the self - energies @xmath67 to linear order in voltage . combining eqs .   and",
    "gives @xmath68 \\hat{g}^r_0(e).\\end{aligned}\\ ] ]    by plugging eq .   into eq .",
    ", together with the expansion of the fermi functions @xmath69 and the analogous expansion of the level broadening operator @xmath70 and by keeping only the terms linear in the applied voltage , we finally obtain the gauge - invariant nonequilibrium density matrix for the steady - state transport in the linear - response and elastic regime @xmath71 \\left(-\\frac{\\partial f}{\\partial e}\\right ) - \\frac{1}{\\pi } \\int\\limits_{-\\infty}^{+\\infty } \\!\\ ! de \\",
    ", \\mathrm{im } \\left [ \\hat{g}^r_0 \\left(eu - ev_l \\frac{\\partial \\hat{\\sigma}_l}{\\partial e } - ev_r \\frac{\\partial \\hat{\\sigma}_r}{\\partial e } \\right ) \\hat{g}^r_0 \\right]f(e ) \\nonumber \\\\    & & \\mbox { } + \\frac{ev_b}{2\\pi } \\int\\limits_{-\\infty}^{+\\infty } \\!\\ ! de \\ , \\hat{g}^r_0 \\hat{\\gamma}_l \\hat{g}^a_0 \\left(-\\frac{\\partial f}{\\partial e}\\right).\\end{aligned}\\ ] ] in the zero - temperature limit , this expression simplifies to @xmath72 - \\frac{1}{\\pi } \\int\\limits_{-\\infty}^{e_f}de \\ , \\mathrm{im } \\left [ \\hat{g}^r_0 \\left(eu - ev_l \\frac{\\partial \\hat{\\sigma}_l}{\\partial e } - ev_r \\frac{\\partial \\hat{\\sigma}_r}{\\partial e } \\right ) \\hat{g}^r_0 \\right ] f(e ) \\nonumber \\\\   & & \\mbox { } + \\frac{ev_b}{2\\pi } \\hat{g}^r_0 ( e_f ) \\cdot \\hat{\\gamma}_l(e_f ) \\cdot \\hat{g}^a_0(e_f).\\end{aligned}\\ ] ] we note that expansions discussed above could be performed further@xcite to obtain @xmath0 order - by - order in the applied bias voltage .    the third term in eq .",
    ", when traced with the total current operator@xcite @xmath73 in the right lead , gives the usual landauer - type conductance formula@xcite @xmath74 = \\frac{2e^2}{h } \\int\\limits_{-\\infty}^{+\\infty } \\!\\ ! de \\",
    ", \\mathrm{tr}\\left[\\hat{\\gamma}_r \\hat{g}^r_0 \\hat{\\gamma}_l \\hat{g}^a_0 \\right ] \\left(-\\frac{\\partial f}{\\partial e}\\right).\\end{aligned}\\ ] ] the same trace with the first two terms in eq .",
    "is identically equal to zero because no total charge current can flow into the leads in thermodynamic equilibrium , even if time - reversal invariance is broken by magnetic field.@xcite    the first and second term in eq .",
    "make this expression for @xmath75 quite different from eq .  .",
    "their role is to properly subtract any non - zero expectation value that exists in thermodynamic equilibrium .",
    "for example , the first term in eq .",
    "is easily interpreted using @xmath76 in eq .",
    "when traced with an operator this term will give equilibrium expectation value governed by the states at the fermi energy which must be removed [ note that the sign in front of the first term is different from the sign in front of the third term in eq .  ] . the second term in eq .",
    "ensures the gauge invariance of the nonequilibrium expectation values , while making the whole expression non - fermi - surface property .",
    "it also renders the usage of eq .",
    "computationally demanding due to the requirement to perform integration from the bottom of the band up to the fermi energy , as discussed in more detail in sec .",
    "[ sec : applications ] .",
    "[ sec : applications ]    the negf formalism offers three different algorithms@xcite to compute stt at finite bias voltage in f@xmath12/i / f mtjs , which are delineated below together with their limits of applicability .",
    "there is also an additional algorithm@xcite for stt in the linear - response regime ( therefore suitable for f@xmath12/n / f spin valves ) based on the gf expressions for spin - dependent interface conductances which enter generalized set of kirchhoff laws describing transport properties and magnetization dynamics in a circuit containing noncollinear magnetic elements.@xcite    all of these methodologies treat elastic transport of electrons , which can become insufficient when the bias voltage applied to mtjs exceeds few hundreds mv .",
    "inelastic effects like electron - magnon and electron - phonon scattering on stt can also be handled by negf formalism , but the evaluation@xcite of the corresponding lesser and retarded self - energies using nonequilibrium many - body perturbation theory@xcite makes such algorithms computationally far more demanding and has been mostly avoided thus far .    the often employed@xcite model in calculations of elastic contribution to stt in mtjs in fig .",
    "1(a ) is defined on a simple cubic lattice , with lattice constant @xmath77 and unit area @xmath78 , where monolayers of different materials ( f , n , i ) are infinite in the transverse direction ( i.e. , @xmath79-planes ) . in the simplest case , the f , n , and i layers are described by a tight - binding hamiltonian with a single @xmath80-orbital per site @xmath81_{\\sigma \\sigma ' } \\right ) \\hat{c}_{n\\sigma',{\\bf k}_{\\parallel } }   - \\gamma \\sum_{n,\\sigma,{\\bf k}_{\\parallel } }   ( \\hat{c}_{n\\sigma,{\\bf k}_{\\parallel}}^{\\dagger}\\hat{c}_{n+1 , \\sigma,{\\bf k}_{\\parallel } } + \\mathrm{h.c.}).\\end{aligned}\\ ] ] the operator @xmath82 ( @xmath83 ) creates ( annihilates ) electron with spin @xmath30 on monolayer @xmath31 with transverse momentum @xmath84 within the monolayer , and the nearest neighbor hopping is .",
    "the in - monolayer kinetic energy is equivalent to an increase in the on - site energy . here",
    "@xmath85 is the vector of the pauli matrices and @xmath86_{\\sigma\\sigma'}$ ] denotes the pauli matrix elements .",
    "the coupling of itinerant electrons to collective magnetization is described through the material - dependent mean - field exchange splitting , where @xmath87 within semi - infinite ideal n leads or within the tunnel barrier region i ( the corresponding hamiltonians are labeled by @xmath88 , @xmath89 , and @xmath90 ) .",
    "the dynamics of spin density for itinerant electrons is governed by the spin continuity equation@xcite @xmath91 where @xmath92 is the spin current tensor and is the nonequilibrium spin density ( responsible for stt ) . here",
    "the spin relaxation time @xmath93 is introduced phenomenologically to model the spin - flip processes by impurities and magnons . in the steady - state @xmath94 , and @xmath95 when soc and other spin relaxation mechanisms can be neglected ( diffusive spin - dependent transport and spatial variation of spin density are taken into account in spin valves f / n / f , but typically neglected in f / i / f mtjs because their resistance and magnetoresistance are dominated by the electronic states near the i barrier ) .",
    "this makes it possible to express stt simply as the divergence of spin current @xmath96 whose discretized form @xmath97 gives the monolayer - resolved stt . the total torque on the free magnetization of the f layer is then obtained from @xmath98 here the subscripts -1 and 0 refer to the last monolayer of the i barrier and the first monolayer of the free f layer , respectively , and it is assumed that @xmath99 because the components of @xmath100 transverse to @xmath101 decay to zero at infinity.@xcite    thus , this `` net spin - current flux '' approach offers the simplest negf - based route@xcite to get stt by computing the vector of spin current between the two neighboring monolayers @xmath102 and @xmath103 @xmath104.\\ ] ] the integration over @xmath105 is required because of the assumed translational invariance in the transverse direction . for f layer of finite thickness",
    ", one needs to compute the difference of such spin currents at the entrance and exit of the layer .",
    "however , since spin current approach relies on spin conservation that gives rise to eqs .   and  , it can not be applied to semi - mtjs in fig .",
    "1(b ) because @xmath106 is _ insufficient _ to get stt if strong soc is present directly at the i / f interface .",
    "also , spin current will not decay , @xmath107 , if soc is present in the bulk of the free f layer.@xcite    a more general approach , which makes it possible to compute the stt vector in the presence of soc or other spin - nonconserving interactions , is to use the torque operator@xcite @xmath108\\ ] ] and find its expectation value @xmath109 $ ] .",
    "here @xmath110 is the electron spin operator . using @xmath88 in eq .",
    "gives @xmath111 .",
    "the torque operator approach is applicable to finite thickness free f layers , where it gives the monolayer - resolved@xcite stt whose sum over all monolayers comprising the free f layer gives the total stt .",
    "it also offers a microscopic picture of stt where nonequilibrium spin density of current carrying quasiparticles is misaligned with respect to spins of electrons composing the magnetic condensate.@xcite this causes local torque on individual atoms which can be summed to find the net effect on the order parameter of either ferromagnetic or antiferromagnetic layers.@xcite    the torque operator approach can also be combined with noncollinear dft to take into account atomistic structure of the junction from first - principles.@xcite unlike collinear spin - unrestricted dft,@xcite where the exchange - correlation ( xc ) functional @xmath112 $ ] depends solely on the total particle density and the @xmath113-component of the spin density vector , noncollinear dft functional @xmath114 $ ] is required when the direction of the local spin density is not constrained to a particular axis .",
    "the xc magnetic field , , introduces the term @xmath115 into the single - particle self - consistent kohn - sham hamiltonian , which replaces the tight - binding hamiltonian in eq .   within the negf - dft framework.@xcite the torque",
    "can then be computed in the coordinate representation as @xmath116 where integration is performed over the volume of the free f layer and the nonequilibrium spin density is obtained from @xmath117 $ ] .    however , most of presently implemented versions of noncollinear xc functionals have vanishing local torque @xmath118 in equilibrium,@xcite so that third term in eq .",
    "is sufficient to obtain current - driven torque in such approximations.@xcite nevertheless , combining the very recently proposed@xcite noncollinear dft having proper invariance and local torque properties with negf will require to properly remove the non - zero torque in equilibrium by using all three terms in eq .  .",
    "the third@xcite negf - based approach to the computation of stt vector is also applicable to f layers of finite thickness with bulk or interfacial soc while offering additional insights .",
    "if the device hamiltonian depends on a variable @xmath119 , which corresponds to slow collective classical degrees of freedom , the expectation value of the corresponding canonical force can be obtained from @xmath120 =   -\\left \\langle\\frac{\\partial \\hat{h}}{\\partial q}\\hat{g}^ { < } \\right \\rangle.\\end{aligned}\\ ] ] here we used the density matrix eq",
    ".   expressed in terms of @xmath121 as adiabatic lesser gf computed for a frozen - in - time variable @xmath119 . by exchanging the derivative between the hamiltonian and @xmath121 , @xmath122 and by using eqs .   and for the retarded and lesser gfs , respectively",
    ", we obtain @xmath123 in the elastic transport regime , the lesser self - energy is given by@xcite for leads @xmath124 .",
    "we note that eq .",
    "is akin to the mean value of time - averaged force in nonequilibrium born - oppenheimer approaches@xcite to current - induced forces exerted by conduction electrons on ions in nanojunctions or mechanical degrees of freedom in nanoelectromechanical systems whose collective modes are slow compared to electronic time scales .",
    "furthermore , the same derivation that leads to eq .   can be extended to obtain@xcite the noise and damping terms , expressed solely in terms of electronic negfs , which enter into the nonequilibrium langevin equation ( taking the form of a generalized landau - lifshitz - gilbert equation ) for the free magnetization of the f layer .",
    "the application of eq .",
    "( [ eq : central ] ) to get @xmath125 ( @xmath126 ) component of the stt vector acting on the magnetization of the free f layer within , e.g. , f@xmath12/i / f mtj proceeds by first computing @xmath33 for the device described by the hamiltonian @xmath127 . in the second step ,",
    "the hamiltonian of the f layer is modified @xmath128_{\\sigma\\sigma ' } \\hat{c}_{n\\sigma',{\\bf k}_{\\parallel}},\\ ] ] and @xmath129 $ ] is computed for the new hamiltonian @xmath130 .",
    "this yields @xmath131-\\hat{g}^r[\\hat{h}]}{q},\\ ] ] where we typically employ @xmath132 as the infinitesimal .",
    "the derivative @xmath133 plugged into eq .",
    "yields @xmath134 .",
    "equation  ( [ eq : central ] ) includes both the equilibrium@xcite and experimentally measured@xcite nonequilibrium contribution to @xmath135 .",
    "the linear - response contribution at zero temperature can be extracted by using @xmath0 in eq .",
    "@xmath136 -\\sum_{p } v_p { \\rm i m } \\left\\ { \\int\\limits_{-\\infty}^{e_f } \\!\\ !",
    "de\\ , { \\rm tr } \\ , \\left[\\frac{\\partial \\hat{g}^{r}_0}{\\partial q } \\frac{\\partial \\hat{h}}{\\partial v_{p}}-\\frac{\\partial \\hat{g}^{r}_0}{\\partial q}\\frac{\\partial \\hat{\\sigma}^r_p}{\\partial e } \\right ] \\right\\}.\\end{aligned}\\ ] ] since @xmath137 is zero in equilibrium , the second sum in eq .   has to be computed only for @xmath135 .",
    "note that in computation of @xmath137 , eq .   is more efficient than the torque operator approach discussed above since the former requires to know only the submatrix of the retarded gf which couples the first and last monolayer of the active device region , while the later requires to obtain the retarded gf on each monolayer of the free f layer .",
    "when computing @xmath135 , both methods have similar computational complexity since they require knowledge of the full retarded gf matrix .    when evaluating eq .",
    ", we use the fact that the integrand in the second term [ which stems from the second term in eq .  ]",
    "is analytic function in the upper complex plane .",
    "then the integration can proceed along the contour composed of an infinite semi - circle , along which the trace is zero due to @xmath138 , and the vertical line at @xmath139 .",
    "we note that adaptive integration is required very close to @xmath54 . for junctions with transverse translational symmetry , such as the ones in fig .",
    "1(a),(b ) , one has to perform additional integration over @xmath140 .",
    "this requires adaptive scheme ( or very dense @xmath141-point sampling in brute force schemes@xcite ) to converge the integrand because of the fact that stt can change fast in the specific regions of the 2d brillouin zone .    aside from our arguments based on the usage of proper gauge - invariant nonequilibrium density matrix in eq .",
    ", recent analysis@xcite of interlayer exchange coupling in junctions brought out of equilibrium by the applied bias voltage has also found it necessary to perform integration over the whole fermi sea in order to obtain the correct value of @xmath135 torque component .",
    "the mtj in fig .",
    "1(a ) is modeled by the hamiltonian in eq .  , where the i layer has thickness @xmath142 monolayers",
    ", @xmath143 is the thickness of the free f layer and the fixed f@xmath12 layer is semi - infinite .",
    "the @xmath144 of this mtj is 100% , where @xmath145 is resistance for parallel configuration of the magnetizations @xmath101 and @xmath146 and @xmath147 is resistance for their antiparallel orientation .",
    "the i layer has @xmath148 ev to model the potential barrier .",
    "the fermi energy of this device in equilibrium is set at ev .",
    "the f layers have the same mean - field exchange splitting @xmath149 ev , but since they are not of the same thickness mtj is asymmetric and its linear - response @xmath150 is non - zero.@xcite this is confirmed in fig .",
    "2(a ) using the proper gauge - invariant nonequilibrium density matrix in eq .  .",
    "on the other hand , using the improper gauge - noninvariant expression eq .",
    "for @xmath0 gives @xmath151 in fig .",
    "2(b ) which is about two orders of magnitude smaller .",
    "since @xmath137 does not have non - zero expectation value in equilibrium , both the proper and improper expressions for @xmath0 give the same result .",
    "note that fig .",
    "2 reproduces the well - known @xmath152 angular dependence for both torque components .",
    "[ fig : fig2 ]      to account for the rashba soc at the i / f interface in n",
    "/ i / f semi - mtj in fig .",
    "1(b ) , we add the following term @xmath153 to the on - site energy [ see hamiltonian in eq .",
    "] of the first monolayer 0 of the f layer which is coupled to the i layer .",
    "the i layer has thickness @xmath142 monolayers and @xmath143 is the thickness of the free f layer .",
    "the parameter quantifies the strength of the rashba soc , which we set at .",
    "the on - site energy within the i layer is @xmath148 ev . the fermi energy of this device in equilibrium is set at ev .    the standard experiments to detect the presence of rashba soc at the i / f interfaces of n / i / f junctions involve measurements@xcite of the so - called out - of - plane tamr coefficient,@xcite @xmath154/r(0)$ ] .",
    "here @xmath155 is the resistance of semi - mtj in fig .",
    "1(b ) when the magnetization of its single f layer is parallel to the [ i.e. , direction of transport in fig .",
    "1(b ) ] , and @xmath156 is the junction resistance when magnetization is rotated by an angle @xmath157 with respect to the within the @xmath158-plane .",
    "since the interfacial soc is linear in momentum , tamr vanishes at the first order in @xmath159 after averaging over the fermi sphere .",
    "however the f layer contains local exchange field and a net transfer of angular momentum occurs at the second order , so that tamr @xmath160 .",
    "this is also the origin of recently predicted@xcite unconventional tamr - related stt in n / i / f semi - mtjs in fig .",
    "the semi - mtjs lack the spin - polarizing f@xmath12 layer of conventional mtjs in fig .",
    "1(a ) , whose magnetization @xmath146 together with the free magnetization @xmath101 define the plane with respect to which stt vector is decomposed .",
    "nevertheless , the usual torque components can be defined@xcite using @xmath161 here the direction of transport ( @xmath162 in fig .",
    "1 ) replaces @xmath146 .    since semi - mtjs in fig",
    "1(b ) are always structurally asymmetric , @xmath151 torque component is necessarily non - zero . to get its correct value requires to remove the equilibrium contribution @xmath163 , which is accomplished by using the proper gauge - invariant @xmath75 in eq .   with the result shown in fig .",
    "comparing this with @xmath135 in fig .",
    "3(b ) , computed using gauge - noninvariant @xmath75 in eq .  , reveals an order of magnitude discrepancy .",
    "[ fig : fig3 ]    unlike the symmetric angular dependence of conventional stt in mtjs discussed in sec .",
    "[ sec : mtj ] , both @xmath135 and @xmath137 exhibit @xmath164 angular dependence due to the existence of four stable magnetic states  two perpendicular to the i / f interface ( @xmath165 ) and two parallel to that interface ( @xmath166 ) .",
    "the existence of both in - plane and perpendicular torque components in eq .",
    "is analogous to conventional stt in mtjs , where @xmath167 in eq .   competes with the demagnetizing field and the perpendicular anisotropy while @xmath168 in eq .   competes with the damping .",
    "thus , the unconventional tamr - related stt can induce magnetization switching from out of plane to in plane and vice versa , as well as the current - driven magnetization precession.@xcite      the early experimental confirmation@xcite of the spin hall effect ( she ) in semiconductor devices with extrinsic ( due to impurities ) or intrinsic ( due to band structure ) soc  where longitudinal unpolarized charge current generates transverse pure spin current or spin accumulation at the lateral edges  has ignited theoretical studies of spin accumulation around the device edges in the diffusive@xcite and ballistic@xcite transport regimes .",
    "since the prediction of the edelstein effect,@xcite there has been also a lot of interest to understand how _",
    "nonequilibrium spin density _ emerges in the interior of diffusive 2d systems with soc within semiconductor heterostructures with structural inversion asymmetry.@xcite most of such calculations have been focused on 2degs or 2d hole gases ( 2dhgs ) with the rashba soc ( linear in momentum@xcite in the case of 2degs , or cubic@xcite in momentum in the case of 2dhgs ) in different measurement geometries where 2d system is attached to two or more electrodes . for analytical calculations ,",
    "it is advantageous to make one@xcite or both@xcite dimensions of a 2d system infinite .",
    "these studies have been typically conducted using either the kubo formula@xcite or the negf formalism.@xcite    the analogous problem arises in the analysis of so torques in laterally patterned",
    "n / f / i heterostructures in fig .",
    "1(c ) , except that the effective mass hamiltonian of a 2d system at the n / f interface @xmath169 has both the rashba ( second ) and the zeeman ( third ) term .",
    "here @xmath170 is the momentum operator and @xmath171 is the mean - field exchange splitting due to the magnetization of the f layer pointing along the unit @xmath101 vector .",
    "we recall that the same ferromagnetic rashba hamiltonian in eq .  , with an additional term for static impurity potential , is also often used to study fundamental aspects of the anomalous hall effect in itinerant metallic ferromagnets.@xcite    while @xmath172 in 2degs within typical semiconductor heterostructures is in the range 0.0010.1 ev ,",
    "it can reach@xcite @xmath173 ev at the pt / co interface.@xcite the very recent transport experiments@xcite have suggested that rashba soc could be responsible for the observed magnetization switching in a single f layer embedded between two asymmetric interfaces .",
    "for example , such effect was observed in pt / co / alo@xmath27 multilayers , but not in the inversion symmetric ones pt / co / pt . the experiments reported in refs .",
    "have also utilized heavy atoms and surface oxidation to create strong out - of - plane potential gradient in pt / co / alo@xmath27 junctions and enhance the interfacial rashba soc .    when unpolarized current is injected into such 2deg along the @xmath174-axis in fig .",
    "1(c ) , the ensuing nonequilibrium spin density can be obtained from @xmath175.\\ ] ] if the trace here is taken over the spin hilbert space @xmath176 , one obtains the local spin density @xmath177 , while taking the trace over the full hilbert space @xmath178 ( where @xmath179 is the orbital space ) gives total spin @xmath180 [ or @xmath181 in some discrete representation ] .",
    "the knowledge of @xmath182 makes it possible to compute@xcite the so torque per unit volume acting on the magnetization of the f layer , @xmath183 .",
    "the so torque component along the @xmath184 direction , where @xmath185 is the in - plane current density , is field - like torque ( i.e. , analogous to @xmath186 in mtjs discussed in sec .  [ sec : mtj ] ) because it has the same form as precessional torque around an effective field in the @xmath187 direction . the other component along @xmath188 $ ] direction has the same form as the damping - like torque toward a field in that same direction .",
    "below we use as in the experiments.@xcite although realistic n / f interfaces are disordered,@xcite to illustrate yet another application of @xmath75 in eq .",
    "we choose to analyze ballistic 2deg for simplicity .",
    "our 2deg is infinite in the transverse ( the @xmath189-axis in fig .",
    "1 ) direction while being @xmath190 sites long in the @xmath174-direction of transport . due to the periodicity in the @xmath189-direction",
    ", we perform an additional integration over @xmath191 to obtain @xmath192.\\ ] ]    the discretization@xcite of eq",
    ".   leads to a tight - binding like hamiltonian defined on the square lattice of sites @xmath193 @xmath194_{\\sigma \\sigma ' } \\right ) \\hat{c}_{{\\bf n}\\sigma^\\prime } + \\sum_{{\\bf nn'}\\sigma\\sigma ' } \\hat{c}_{{\\bf n}\\sigma}^\\dagger t_{\\bf nn'}^{\\sigma\\sigma'}\\hat{c}_{{\\bf n'}\\sigma'}.\\end{aligned}\\ ] ] whose nearest - neighbor hopping parameters are non - trivial @xmath195 hermitian matrices in the spin space : @xmath196 here @xmath197 ev is the orbital hopping , @xmath198 is so hopping which we set at @xmath199 ev , and we chose @xmath200 ev for the exchange splitting .",
    "the fermi energy in this model is chosen close to the bottom of the band @xmath201 ev in order to maintain the parabolic energy - momentum dispersion of the original effective mass hamiltonian eq .  .",
    "while the on - site potential @xmath202 can be used to introduce disorder , we set @xmath203 in our ballistic 2deg example .    in some prior studies of current - driven nonequilibrium spin density in 2degs with the rashba soc , as described by eq .",
    "with @xmath204 , one can find nave attempts to derive a linear - response formula for @xmath177 based on negfs .",
    "for example , ref",
    ".   starts from a general expression @xmath205 $ ] , obtained by combining eqs .   and  , and then expands @xmath45 to linear order in the small bias voltage @xmath206 + \\mathcal{o}(v_b^2),\\end{aligned}\\ ] ] to arrive at the following formula @xmath207.\\ ] ] this derivation assumes that the bias voltage is split using @xmath208 and @xmath209 . however , such expression is _ not _ gauge - invariant since using @xmath210 and @xmath211 ( or , equivalently , shifting the potential everywhere by a constant @xmath24 ) would give different expansion @xmath212 + \\mathcal{o}(v_b^2),\\end{aligned}\\ ] ] and different corresponding formula for @xmath177 .",
    "[ fig : fig4 ]    the usage of gauge - noninvariant expressions [ note that eq .",
    "is equivalent to employing eq .  ]",
    "does not affect previous results@xcite obtained for the rashba spin - split 2deg in the absence of magnetization or external magnetic field , where equilibrium spin density is absent due to the fact that soc alone does not break time - reversal invariance .",
    "however , it will lead to ambiguous results if applied to a 2d system described by the hamiltonian in eq .",
    ", as demonstrated by fig .  4 .",
    "the difference between the results computed using improper eq .   and proper eq .",
    "expressions for @xmath75 is less dramatic than in the case of @xmath186 discussed in secs .",
    "[ sec : mtj ] and  [ sec : semimtj ] .",
    "[ fig : fig5 ]    for comparison , we also plot @xmath213 in fig .  5 for the case @xmath204 .",
    "this system exhibits large transverse nonequilibrium spin density @xmath214 [ while @xmath215 , akin to the edelstein effect studied in infinite homogeneous diffusive 2degs.@xcite introduction of non - zero magnetization into the rashba hamiltonian eq .",
    "leads to smaller @xmath216 , while also generating non - zero @xmath217 and @xmath218 with oscillatory spatial dependence in fig .",
    "4(a ) which is made possible by the ballistic nature of transport between the contacts . thus , @xmath219 in laterally patterned n / f / i heterostructure with clean n / f interface will be dominated by the field - like torque term along @xmath220 direction since spatial integration of @xmath217 , which gives rise to damping - like torque component , averages to zero .",
    "we note that recent experiments detecting current - driven magnetization switching in laterally patterned n / f / i heterostructures can be interpreted using two different mechanisms : ( _ i _ ) current - induced @xmath177 at the n / f interface due to strong rashba soc located at such interface;@xcite or ( _ ii _ ) sh current generated within the bulk of a heavy metal n layer , which then flows perpendicularly through the n / f interface to generate stt on the f layer magnetization.@xcite the latter case of sh torque is equivalent to a conventional torque in mtjs studied in sec .  [",
    "sec : mtj ] arising from a polarizing layer that would be located below the f layer with its magnetization pointing along the @xmath189-axis and the current injection along the @xmath113-axis in fig .",
    "its magnitude is largely determined by the bulk sh angle@xcite of the n layer , as well as by spin - dependent conductances of the n / f interface .",
    "since edelstein effect produces transverse nonequilibrium spin density , so torque would act predominantly as field - like torque,@xcite while the she mechanism would generate dominant damping - like torque.@xcite    if both sh and so torque mechanisms operate concurrently , the resulting torque is expected to be approximately the sum of the torques found in the systems with one effect or the other.@xcite however , various experiments have reported conflicting results for the size and direction of the torque . furthermore , experimentally observed large sensitivity of torque on the thickness ( even when changed by a single atomic layer ) of the f layer is presently difficult to reconcile with predictions@xcite based on either of these mechanisms computed for simplistic model hamiltonians .",
    "thus , first - principles studies investigating how structural , electronic and magnetic properties of n / f bilayers depend on the thickness of the layers are called for .",
    "for example , the very recent first - principles calculations have found strong rashba soc at the pt / co interfaces , but with higher order @xmath141-dependence and change in magnitude and sign from band to band.@xcite the more sophisticated tight - binding hamiltonians , fitted to first - principles computed electronic structure of bilayers , can then be combined with the proper gauge - invariant nonequilibrium density matrix in eq .   to study 2d interfacial transport ( to capture so torques ) or three - dimensional transport ( to capture so and sh torques on the same footing ) in arbitrary device geometry .",
    "experimentally , the key issue is to confirm the presence of strong interfacial soc , which could be done using tamr measurements@xcite or the fact that sh torque itself would be modified when spin hall current from the bulk of the n layer is traversing perpendicularly n / f interface supporting strong soc  the angular dependence of sh torque would then exhibit additive combination@xcite of conventional @xmath152 dependence shown in fig .  2 and unconventional @xmath164 one shown in fig .",
    "[ sec : conclusions ]    in conclusion , within the framework of nonequilibrium green functions , we showed how to construct the proper _ gauge - invariant _",
    "( i.e. , independent of the reference level for electric potential ) density matrix in steady - state nonequilibrium for an active region attached to two macroscopic reservoirs whose small electrochemical potential difference drives linear - response dc current ( in the absence of inelastic processes in the active region ) .",
    "our central expression  eq .   or eq .   at",
    "non - zero or zero temperature , respectively  contains three terms .",
    "one of those terms is familiar from the usual two - terminal landauer - type conductance formula as the expectation value of the total charge current in the electrodes , which is always a purely nonequilibrium quantity .",
    "the two additional terms ensure that any non - zero equilibrium expectation value of a physical quantity is properly removed from the formalism in gauge invariant fashion .",
    "we illustrate the usage of the proper nonequilibrium density matrix by computing the field - like , which is non - zero even in equilibrium , and damping - like components of the conventional torque in f@xmath12/i / f mtjs or unconventional torque in n / i / f semi - mtjs with strong rashba soc at the i / f interface .",
    "the third application evaluates current - driven nonequilibrium spin density in the ferromagnetic rashba model , which yields the so torque as one of the possible mechanisms behind magnetization switching of a single f layer recently observed@xcite in laterally patterned",
    "n / f / i heterostructures with charge current injected parallel to the n / f plane .",
    "we compare these results with those obtained using the gauge - noninvariant expressions for the nonequilibrium density matrix employed in quantum transport literature to show how they lead to ambiguous values of current - driven field - like torque or nonequilibrium spin density due to improper removal of the corresponding equilibrium expectation values .",
    "we thank p. m. haney , c. h. lewenkopf , n. nagaosa and i. rungger for immensely valuable discussions and comments on several drafts .",
    "this material is based upon work supported by the us national science foundation under grant no .",
    "eccs 1202069 ."
  ],
  "abstract_text": [
    "<S> experiments observing spin density and spin currents ( responsible for , e.g. , spin - transfer torque ) in spintronic devices measure only the nonequilibrium contributions to these quantities , typically driven by injecting unpolarized charge current or by applying external time - dependent fields . on the other hand , theoretical approaches to calculate them operate with both the nonequilibrium ( carried by electrons around the fermi surface ) and the equilibrium ( carried by the fermi sea electrons ) contributions . </S>",
    "<S> thus , an unambiguous procedure should remove the equilibrium contributions , thereby rendering the nonequilibrium ones which are measurable and satisfy the _ gauge - invariant _ condition according to which expectation values of physical quantities should not change when electric potential everywhere is shifted by a constant amount . using the framework of nonequilibrium green functions , we delineate such procedure which yields the proper gauge - invariant nonequilibrium density matrix in the linear - response and elastic transport regime for current - carrying steady state of an open quantum system connected to two macroscopic reservoirs . </S>",
    "<S> its usage is illustrated by computing : ( _ i _ ) conventional spin - transfer torque ( stt ) in asymmetric f / i / f magnetic tunnel junctions ( mtjs ) ; ( _ ii _ ) unconventional stt in asymmetric n / i / f semi - mtjs with the strong rashba spin - orbit coupling ( soc ) at the i / f interface and injected current perpendicular to that plane ; and ( _ iii _ ) current - driven spin density within a clean ferromagnetic rashba spin - split two - dimensional electron gas ( 2deg ) which generates so torque in laterally patterned n / f / i heterostructures when such 2deg is located at the n / f interface and injected charge current flows parallel to the plane . </S>",
    "<S> we also compare our results for these three examples with those that would be obtained using improper expressions for the density matrix , which are often found in the literature but which arbitrarily mix nonequilibrium and equilibrium expectation values due to a violation of the gauge invariance . </S>"
  ]
}