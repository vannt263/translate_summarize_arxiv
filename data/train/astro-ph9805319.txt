{
  "article_text": [
    "the hypothesis that , in comoving coordinates , initially denser regions contract more rapidly than less dense regions , and that sufficiently underdense regions expand , is simple , reasonable , and powerful . as a consequence of this expansion and contraction , the density distribution in the initial lagrangian space will be different from that in the evolved , eulerian space .",
    "suppose that , as the universe evolves , the number of expanding and contracting regions is conserved  only their comoving size changes  and the mass within each such region is also conserved .",
    "if we have a model for the way in which the evolution of the size of a region depends on its initial size and density , and we also have a model for the initial number of regions as a function of initial size and density , then we can compute the distribution of sizes and densities at some later time .",
    "for example , suppose that the initial lagrangian density distribution is a gaussian random field , and that the evolution of regions is given by the spherical collapse model",
    ". then it should be possible to construct a model for @xmath0 , where @xmath0 is the fraction of regions of size @xmath1 that , at @xmath2 , contain mass @xmath3 .",
    "the quantity @xmath0 is often called the eulerian probability distribution function .    in the press - schechter ( 1974 ) approach , at any given time , all matter is in the form of collapsed objects , usually called haloes , and the distribution of halo masses evolves with time . at any time",
    ", the matter within a randomly placed cell @xmath1 is divided among many collapsed haloes .",
    "thus , @xmath0 depends both on the halo mass function , and on the spatial distribution of the haloes .",
    "bond et al .",
    "( 1991 ) showed how to estimate the evolution of the halo mass function if the initial lagrangian distribution is gaussian ( also see lacey & cole 1993 ) .",
    "they did not show how to estimate the spatial distribution of these haloes , but mo & white ( 1996 ) showed how this might be accomplished .",
    "this paper develops a model that combines , self - consistently , the bond et al .",
    "( 1991 ) excursion set approach with the mo & white ( 1996 ) model for the eulerian space halo distribution .",
    "the model developed here allows one to simultaneously describe both the distribution of the dark matter , i.e. @xmath0 , and that of the haloes . see , e.g. , mo & white ( 1996 ) for why such a model is useful .",
    "section  [ model ] describes the model .",
    "it shows why the distribution of first crossings of a barrier whose height is not constant , by brownian motion random walks , is useful .",
    "the shape of the barrier associated with the spherical collapse model is given in section  [ smodel ] .",
    "the relation between the first crossing distribution and the eulerian distribution @xmath0 is discussed in section  [ prelim ] .",
    "section  [ halod ] shows that , in the context of the model developed here , the halo mass function is related to the small cell size limit ( i.e. @xmath4 ) of @xmath0 .",
    "it discusses the bond et al .",
    "( 1991 ) excursion set results in this context , and then shows how the model can be used to describe the spatial distribution of the haloes as well .",
    "the results of mo & white ( 1996 ) are discussed in section  [ mowhite ] .",
    "section  [ twobare ] shows that the associated two barrier problem can be used to provide information about the evolved density profile , and also about the way in which matter flows in and out of eulerian cells .",
    "the first crossing distribution associated with the spherical collapse barrier must be obtained numerically .",
    "therefore , to illustrate the usefulness of our approach , section  [ linear ] shows the results of assuming that the initial distribution is white - noise gaussian , and that the barrier shape is simpler than that associated with the spherical collapse model . in section  [ linear ] , the barrier is assumed to be linear for a number of reasons .",
    "firstly , this linear barrier can be understood as arising from a simple variant of the spherical collapse model ( section  [ scoll ] ) .",
    "secondly , the barrier crossing distribution can be computed analytically ( e.g. schrdinger 1915 ) .",
    "the details of the derivation are presented in appendix  [ deriv ] .",
    "thirdly , the eulerian probability distribution associated with the first crossings of this linear barrier is inverse gaussian ( section  [ pdfe ] ) , and the inverse gaussian provides a good fit to the eulerian distribution measured in numerical simulations of clustering from white noise initial conditions ( section  [ sims ] ) .",
    "finally , studies of clustering from poisson initial conditions also suggest that this barrier shape is a useful approximation ( sheth 1998 ) .",
    "the bond et al .",
    "( 1991 ) results are derived , within the context of this linear barrier model , in section  [ const ] .",
    "analytic expressions for the eulerian distribution function as well as the halo  mass and halo  halo correlations are derived for all scales , and for all times , in sections  [ pdfe ] and  [ halobar ] .",
    "section  [ twobar ] provides various formulae associated with the two - linear - barrier problem .",
    "a final section summarizes the results .",
    "it also discusses how the model can be extended to describe clustering from more general initial conditions .",
    "the first subsection defines various eulerian space quantities of interest in this paper .",
    "since these definitions are standard ( e.g. peebles 1980 ) , no further references are given .",
    "subsequent subsections develop a model which allows one to estimate the evolution of these quantities .",
    "imagine partitioning the eulerian space @xmath5 into a large number of cells , each of size @xmath6 , at time @xmath2 .",
    "since the volume of each cell is @xmath7 , the total number of such cells is @xmath8 .",
    "let @xmath9 denote the fraction of these cells that contain mass between @xmath3 and @xmath10 .",
    "then , at a given @xmath2 , @xmath11 where we have not bothered to write @xmath2 explicitly on the right hand side .",
    "define @xmath12 , where @xmath13 is the average comoving density in the eulerian space .",
    "that is , @xmath14 then @xmath15 and @xmath16 is the probability distribution function of the density in eulerian space at @xmath2 . since @xmath17 , @xmath18 for all @xmath2 .",
    "let @xmath19 , where @xmath20 and @xmath21 is some constant that will be determined later , denote the average number density of @xmath22 haloes identified at @xmath23 . on average ,",
    "the number of such haloes within an eulerian cell @xmath7 is @xmath24 .",
    "let @xmath25 denote the number of such @xmath22 haloes within the @xmath26th eulerian cell .",
    "suppose we classify all eulerian cells by the mass @xmath3 within them at some @xmath27 .",
    "let @xmath28 denote @xmath29 , where the average is over only those eulerian cells that contain mass @xmath3 at @xmath2 .",
    "clearly , @xmath30 since equation  ( [ pdr ] ) shows that @xmath31 .",
    "define @xmath32 this is the number , relative to the average number of @xmath33 haloes in eulerian cells @xmath7 , of such haloes that are within eulerian cells which contain mass @xmath3 at @xmath2 , minus one . the cross correlation @xmath34 between haloes and mass in eulerian space , averaged over eulerian cells of comoving size @xmath7 , at the epoch @xmath2 ,",
    "is @xmath35 where we have used equation  ( [ norm ] ) to set @xmath36 , and so @xmath37 .",
    "let @xmath38 denote the ( volume average of the ) correlation function of @xmath22 and @xmath39 haloes identified at the epoch @xmath23 , averaged over all comoving eulerian cells @xmath7 , at the epoch @xmath40 .",
    "this average can be computed in two steps .",
    "let @xmath25 and @xmath41 denote the number of @xmath22 and @xmath39 haloes within an eulerian cell @xmath7 .",
    "classify all eulerian cells by the mass @xmath3 within them at @xmath2 .",
    "let @xmath42 denote the average over all @xmath3 cells of @xmath43 : @xmath44 .",
    "then @xmath45 higher order moments of the halo distribution can be defined similarly .",
    "the remainder of this section develops a barrier - crossing , excursion set model which allows one to estimate all these eulerian quantities .",
    "we will assume that the total mass and comoving volume of the evolved eulerian space is the same as that initially ( i.e. , in the lagrangian space ) .",
    "then the average density in the two spaces is the same : @xmath46 , where here and below quantities with subscript zero are in the lagrangian space .",
    "we will also assume that the initial overdensity fluctuations in the lagrangian space are small : @xmath47 initially .",
    "if @xmath13 is the average background density , then @xmath48 , where @xmath49 .",
    "that is , the initial mass @xmath3 , volume @xmath50 and size @xmath51 are all equivalent variables . consider a region that initially contains mass @xmath3 and has initial overdensity @xmath52 . at some later time , it has size @xmath53 , so that the overdensity within it is @xmath54 , where @xmath55 notice that @xmath56 is the same eulerian quantity of the previous subsection , and that it is simply the ratio of the lagrangian volume to the eulerian volume of the region .",
    "the spherical collapse model ( e.g. peebles 1980 ) allows one to describe the evolution of such a region .",
    "in particular , it provides relations between the initial size @xmath51 , the initial overdensity @xmath52 , the time @xmath2 , and the evolved eulerian size at that time @xmath53 .",
    "if @xmath51 , @xmath52 , and @xmath2 are given , then @xmath57 is determined by the model .",
    "on the other hand , if only @xmath1 and @xmath2 are given , then the model describes a curve in the @xmath58 plane : @xmath59 . to a good approximation",
    ", this relation is @xmath60 ( mo & white 1996 ) .",
    "a simpler approximation to this relation is @xmath61 ( bernardeau 1994 ) .",
    "whereas bernardeau used @xmath62 , the value @xmath63 is also acceptable .",
    "notice that when @xmath4 , then @xmath64 , so formulae  ( [ mow ] ) and  ( [ bnrdo ] ) both become @xmath65 with @xmath66 . in this limit",
    "@xmath67 is independent of @xmath51 .",
    "when @xmath68 , then @xmath59 decreases monotonically as @xmath51 decreases .",
    "essentially , equation  ( [ mow ] ) shows that a given pair @xmath1 and @xmath2 could initially have come from a range of @xmath51 and @xmath52 .",
    "this is sensible ; in the spherical model , initially denser regions collapse more rapidly than less dense regions .",
    "therefore , a region of size @xmath1 at @xmath2 may initially have been a small region containing a small overdensity , or it may have been larger initially , but with a correspondingly larger overdensity .    our model for estimating the eulerian probability distribution function @xmath0 works as follows .",
    "at any given @xmath2 , imagine partitioning space into a large number of cells each of size @xmath7 .",
    "assume that each cell evolved according to the spherical model independently of the others .",
    "this means that the mass within each cell remains the same  only its comoving size changes  and the total number of cells is conserved .",
    "these are strong simplifying assumptions that do not have a rigorous physical justification .",
    "however , they allow one to estimate a number of useful quantities . as with the bond et al .",
    "( 1991 ) excursion set approach , the extent to which the model here is able to reproduce the results of numerical simulations is the only real justification for these assumptions .",
    "since each cell evolved according to the spherical model , and the number of such cells is conserved , to compute @xmath0 we simply need to specify the relative numbers of regions initially with @xmath58 that have now evolved into regions @xmath69 . clearly , this distribution depends on the initial distribution of fluctuations and on the evolution described by the spherical model .",
    "the next subsection shows how to do this .",
    "consider a density field @xmath70 . recall that the subscript zero denotes the fact that @xmath52 is a quantity measured in the lagrangian space .",
    "smoothing this field with a window @xmath71 of scale @xmath51 produces a smoothed field @xmath72 : @xmath73 where @xmath74 is the fourier transform of the window @xmath71 . by definition of the average density , @xmath75 as @xmath76 , for all positions @xmath77 .",
    "thus , for each position in the lagrangian space there is a curve , @xmath78 , which describes the overdensity @xmath52 in a window of lagrangian size @xmath51 centred on that position .",
    "call such a curve a trajectory .",
    "the volume associated with a window of size @xmath51 is @xmath79 , where @xmath80 is some constant that may depend on the shape of the window , but does not depend on @xmath51 .",
    "for example , @xmath81 for a top hat window .",
    "the mass within this volume is @xmath82 , where @xmath83 is a constant that denotes the average mass density in the lagrangian space .",
    "provided @xmath52 is small , @xmath84 to lowest order . in this approximation",
    ", there is a deterministic relation between the volume @xmath50 and the mass within it : @xmath85 in the lagrangian space .",
    "there is also a deterministic relation between the scale @xmath51 , and the variance @xmath86 associated with that scale : @xmath87 where @xmath88 is the power spectrum of the unsmoothed lagrangian field .",
    "thus , for a given @xmath88 , the quantities @xmath86 , @xmath51 , @xmath50 and @xmath3 are equivalent . for most power spectra of interest",
    ", @xmath86 increases as @xmath51 decreases . for what follows ,",
    "assume that @xmath89 as @xmath90 .",
    "the deterministic relation between @xmath51 and @xmath86 means that to each trajectory @xmath78 associated with a position in the lagrangian space , there is a corresponding trajectory @xmath91 . since @xmath92 as @xmath76 , all these trajectories start from the origin @xmath93 . since @xmath89 as @xmath90 , and since @xmath86 is a measure of the mean square distance of a trajectory at @xmath86 from the @xmath86 axis , any trajectory may be an arbitrary distance above or below the @xmath86 axis as @xmath90 .",
    "the deterministic relation between @xmath51 and @xmath86 also means that equation  ( [ mow ] ) represents a curve in the @xmath94 space .",
    "given @xmath1 and @xmath2 , draw this curve , and call it the barrier @xmath95 .",
    "the thick solid curve in fig .",
    "[ bmotion ] shows this barrier for a representative value of @xmath1 and @xmath2 .",
    "it decreases monotonically as @xmath86 increases . for a given @xmath2 , equation  ( [ mow ] )",
    "shows that curves for different @xmath1 all have the same value @xmath96 at @xmath97 .",
    "equation  ( [ mow ] ) also shows that @xmath98 when @xmath99 , so curves for larger values of @xmath1 cross the @xmath86 axis at smaller values of @xmath86 .",
    "in fact , for a given @xmath2 , the curves for different @xmath1 form a nested family ( see fig .  [ barrier ] ) . this will be important below .    since @xmath95 decreases monotonically with increasing @xmath86 , each lagrangian trajectory will intersect the barrier at least once ( see fig .  [ bmotion ] ) .",
    "define the first crossing as the smallest value of @xmath86 at which the lagrangian trajectory @xmath91 intersects @xmath95 .",
    "that is , it is the smallest @xmath86 at which @xmath100 .",
    "bond et al .",
    "( 1991 ) discuss why the first crossing distribution is so important ( it solves the so - called cloud - in - cloud problem ) . although they only considered the special case in which @xmath95 was independent of @xmath86 , their argument holds for the more general barrier considered here also .",
    "the argument is as follows .",
    "since @xmath86 and @xmath3 are equivalent variables , the first crossing value of @xmath86 represents the largest value of @xmath3 at which the trajectory had @xmath101 .",
    "since @xmath3 and @xmath50 are equivalent variables , the trajectory can be thought of as representing a volume element of a lagrangian volume @xmath50 that has eulerian size @xmath1 at @xmath2 .",
    "suppose we agree that the barrier crossings are significant , and the mass we associate with a trajectory could be that associated with any of the crossings . if these possible assignments correspond to @xmath102 , then the trajectory represents concentric lagrangian regions @xmath103 . in effect , bond et al .",
    "( 1991 ) assume that successive shells never cross ; whereas the actual sizes of @xmath103 may change , the order of the shells is preserved .",
    "this means that if the largest region @xmath50 has eulerian size @xmath7 , then the subregions originally within it will remain within it .",
    "so the largest lagrangian region associated with the trajectory , i.e. , the one associated with the first crossing , is the one that is relevant .",
    "counting the largest region @xmath50 at once includes all the smaller ones within it , and is the natural way to avoid double - counting the smaller regions .    although bond et al .",
    "( 1991 ) only considered the case in which lagrangian regions had collapsed to eulerian size @xmath104 , their argument can also be applied in the @xmath68 case studied here .",
    "recall that , for a given @xmath2 , curves for different @xmath1 are nested .",
    "consider a trajectory @xmath91 that crosses the barrier @xmath105 for the first time at @xmath50 .",
    "the lagrangian scale @xmath106 , corresponding to the @xmath107th crossing of @xmath105 by this same trajectory may be smaller than the lagrangian scale @xmath108 corresponding to the first crossing , by this trajectory , of the barrier @xmath109 for some eulerian @xmath110 . in our model ,",
    "such a trajectory represents a volume element of a lagrangian region @xmath50 that at @xmath2 , has eulerian size @xmath1 , at which time it contains a subregion that originally had size @xmath111 and now has size @xmath110 .",
    "the assumption is that if @xmath108 has eulerian size @xmath112 , and if @xmath113 originally , then all the mass @xmath114 contained within @xmath106 must still be contained within the eulerian region @xmath112 now occupied by @xmath108 .",
    "thus , the model developed here explicitly preserves the ordering that was assumed by bond et al .",
    "( 1991 ) , and so the first crossing of the barrier @xmath95 remains the one that is significant .",
    "let @xmath115 denote the fraction of trajectories that have their first crossing of the barrier between @xmath116 and @xmath117 .",
    "then , for a given barrier @xmath95 , @xmath115 can be equated with the fraction of lagrangian space that is associated with regions containing mass @xmath3 that each occupy an eulerian region @xmath1 at @xmath2 .",
    "if @xmath118 denotes the number of such regions , then each such region occupied a lagrangian volume @xmath119 , so @xmath120 where @xmath121 .",
    "thus , the distribution of first crossings gives an estimate of the number density of lagrangian regions which contained mass @xmath3 and had initial overdensity @xmath52 , so that at @xmath2 , while they still contain mass @xmath3 , they occupy the eulerian volume @xmath7 .",
    "if we further suppose that the number of such regions is the same in both the eulerian and lagrangian spaces , then comparison with equation  ( [ pmr ] ) shows that @xmath122 since @xmath123 , this means that @xmath124 provided that @xmath52 is the function of @xmath86 , @xmath1 and @xmath2 that is given by equation  ( [ mow ] ) .",
    "this shows how the barrier crossing distribution is related to @xmath16 .",
    "notice that the left hand side of equation  ( [ fspd ] ) is determined by lagrangian space quantities ( the trajectories which cross the barrier are lagrangian ) , whereas the right hand side is associated with eulerian space .",
    "a similar sort of relation between lagrangian and eulerian space quantities was used by bernardeau ( 1994 ) ( see the discussion at the start of his section 3.2.2 ) .",
    "the difference between his work and ours is that he used a lagrangian distribution that was derived from perturbation theory , rather than from a barrier crossing model , for the left hand side of equation  ( [ fspd ] ) .    in summary :",
    "the eulerian probability distribution function @xmath0 is the fraction of regions of size @xmath1 that , at @xmath2 , contain mass @xmath3 . to estimate it ,",
    "first assume that the initial fluctuation @xmath52 is small , so @xmath125 .",
    "next , choose a random position in the initial field . compute @xmath52 in spheres @xmath51 centred on this position .",
    "call the curve @xmath78 centred on this position a trajectory . given @xmath1 and @xmath2 ,",
    "draw the barrier @xmath126 associated with the spherical collapse model ( equation  [ mow ] ) .",
    "the trajectory @xmath78 may intersect the barrier @xmath126 many times . find the largest value of @xmath51 at which the trajectory intersects @xmath126 .",
    "call this the first crossing of @xmath126 .",
    "associate mass @xmath3 with this trajectory .",
    "since mass @xmath3 and initial volume @xmath50 are equivalent , this trajectory represents a volume element of a region containing mass @xmath3 .",
    "initially , @xmath3 had size @xmath127 and overdensity @xmath59 . at @xmath2",
    ", it has size @xmath1 .",
    "repeat for an ensemble of such trajectories .",
    "so compute the distribution of first crossings of @xmath126 .",
    "the fraction of trajectories which first cross the barrier @xmath126 at @xmath51 represents the fraction of mass that is in regions of mass @xmath3 that , at @xmath2 , have size @xmath1 . from this",
    ", the average number density @xmath128 of such regions can be computed easily .",
    "assume that the number of such regions is conserved .",
    "then @xmath129 equals @xmath0 .",
    "the previous subsection showed how to compute the eulerian space distribution function using an excursion set model .",
    "however , the excursion set model can also be used to provide information about the halo distribution .",
    "this subsection shows why .",
    "following bond et al .",
    "( 1991 ) , define a halo as a lagrangian region that has collapsed to a vanishingly small eulerian size : @xmath104 .",
    "suppose @xmath2 is given , and consider the eulerian scale @xmath104 .",
    "in the spherical collapse model , @xmath130 is independent of @xmath51 but depends on @xmath2 ( equation  [ mow ] ) .",
    "define @xmath131 .",
    "as before , equate the fraction of trajectories @xmath132 which first cross @xmath133 at @xmath51 with the fraction of mass in regions @xmath3 that , at @xmath2 , have size @xmath104 .",
    "following  ( [ fsnm ] ) , the average number density of such regions is @xmath134 , and @xmath135 is said to be the mass function of collapsed haloes .",
    "this is exactly the excursion set model for the unconditional halo mass function developed by bond et al . ( 1991 ) . in the present context ,",
    "the unconditional mass function is just the eulerian distribution function in the limit @xmath104 .    since the @xmath104 limit has this special interpretation , in what follows , it is convenient to make a distinction between the barrier crossing distribution in this limit , and that when @xmath68 . below the subscript",
    "` c ' ( for constant height ) , as in @xmath136 , denotes the barrier crossing distribution when @xmath104 , and the subscript ` r ' denotes the case @xmath68 .",
    "suppose we consider two barriers @xmath137 and @xmath138 , with @xmath139 .",
    "( it may help to look at fig .",
    "[ barrier ] . ) for now , assume that @xmath140 .",
    "let @xmath141 denote the fraction of trajectories which first cross @xmath142 at @xmath143 given that they first crossed @xmath144 at @xmath86 .",
    "again , consider the limit @xmath145 for both barriers",
    ". then @xmath146 , and @xmath147 for all @xmath86 , so both barriers have a constant height , and @xmath148 .",
    "bond et al .",
    "( 1991 ) interpret @xmath149 as representing the fraction of mass in an @xmath3-halo that was earlier in @xmath22-haloes .",
    "they define a conditional mass function as the average number of @xmath22-haloes that are within an @xmath3-halo : @xmath150 if @xmath151 , and @xmath152 otherwise . in the context of this paper",
    ", @xmath153 represents the fraction of the lagrangian region @xmath50 that has eulerian size @xmath104 at @xmath154 , which was previously in lagrangian regions @xmath155 that , at @xmath23 , also occupied vanishingly small eulerian volumes .",
    "the reason for wording things in this way is that it shows how to compute other properties of the halo distribution in eulerian space .",
    "for example , the average number of @xmath22 haloes that collapsed at @xmath23 and are in eulerian regions @xmath68 at @xmath27 can be computed as follows .",
    "recall that @xmath156-haloes are associated with trajectories which cross the constant barrier @xmath157 at @xmath143 .",
    "since @xmath158 , and since @xmath144 decreases monotonically as @xmath86 increases , each of these trajectories must have crossed @xmath159 at some @xmath160 , so as to reach @xmath161 at @xmath143 . therefore @xmath162 where @xmath163 . since @xmath164 , @xmath165 , @xmath166 , and @xmath167 ,",
    "equation  ( [ fseul ] ) implies that @xmath168 if we set @xmath169 where @xmath28 was defined in section  [ model ] , just prior to equation  ( [ nme ] ) , and @xmath52 in @xmath170 is given by equation  ( [ mow ] ) , and we recall that @xmath31 ( equation  [ pdr ] ) , then this expression is the same as equation  ( [ nme ] ) .",
    "equation  ( [ enns ] ) shows that the average number of @xmath22-haloes in eulerian cells @xmath7 which contain mass @xmath3 at @xmath2 is equal to that in those lagrangian regions @xmath50 which had initial density @xmath52 given by equation  ( [ mow ] ) .",
    "the main reason for writing this out explicitly is that it shows how statistics in the lagrangian space can be used to compute statistics in eulerian cells @xmath7 .",
    "namely , the assumed conservation of number of regions in the two spaces ( equation  [ nmav ] equals equation  [ nme ] ) means that an average over eulerian regions of size @xmath7 is equivalent to averaging over those lagrangian regions that have evolved into eulerian regions of size @xmath7 ( equations  [ nmav ] and  [ enns ] ) . in practice",
    ", this means that eulerian space quantities like @xmath171 and @xmath172 can be computed simply by using the appropriate value for @xmath52 ( that given by equation  [ mow ] ) in the associated lagrangian space quantities , and then summing over @xmath3 , weighting the contribution from each @xmath3 appropriately .",
    "this weighting is given by the barrier crossing algorithm , because the barrier crossing distribution @xmath173 , with @xmath52 given by equation  ( [ mow ] ) , represents the fraction of lagrangian space that is associated with regions of mass @xmath3 that , because they had initial overdensity @xmath52 , are eulerian regions of size @xmath7 at @xmath2 .",
    "section  [ linear ] illustrates how this works .",
    "it presents a model in which all these quantities can be computed analytically .      before moving on , it is interesting to compare this model with previous work .",
    "our equation  ( [ enns ] ) is exactly the same as that assumed by mo & white ( 1996 ) .",
    "they assumed that the eulerian space quantity @xmath28 could be computed by simply substituting the spherical collapse value of @xmath59 into the lagrangian formula @xmath170 .",
    "they showed that the resulting formula for @xmath28 provided good fits to the corresponding eulerian space quantity measured in their numerical simulations of clustering .",
    "since , in this regard , our model leads to the same formula as that of mo & white , the agreement with simulations provides some justification for the strong simplifying assumptions which lead to our model .",
    "our model extends their results in the following way .",
    "our equation  ( [ nmav ] ) shows that , to compute averages in eulerian space , knowledge of the eulerian space distribution function @xmath16 is necessary to then take the correct average over lagrangian regions @xmath50 that have become eulerian regions @xmath7 .",
    "mo & white also knew this , but they did not know how to compute @xmath16 .",
    "therefore , they assumed that it could be taken directly from their numerical simulations .",
    "however , as our approach shows , @xmath16 is related to the shape of the boundary ( cf .",
    "our equation  [ fspd ] ) .",
    "this relation must not be ignored . to see why , suppose ( as mo & white did ) that a lognormal can be substituted for @xmath16 .",
    "if one uses the spherical model for @xmath59 in @xmath170 and then does the integral on the right hand side of  ( [ nmav ] ) , one finds that it does not equal the correct value for the left hand side .",
    "this is because , as our approach shows , self - consistency requires that @xmath16 depend on the boundary shape ; once the boundary is specified , one is no longer free to choose any arbitrary distribution for @xmath16 .",
    "this may partially explain why the mo & white results using a lognormal are somewhat worse than when they use the distribution measured directly in their simulations .",
    "since our approach shows how to derive @xmath16 from the boundary shape , our approach can be thought of as deriving , self - consistently , the mo & white ( 1996 ) spherical evolution formulae by a simple extension of the bond et al .",
    "( 1991 ) excursion set approach .",
    "the previous subsection showed that problems involving the crossing of two barriers , in which one barrier was assumed to be constant , and the other not ( i.e. the eulerian scale was @xmath104 for one barrier , but @xmath68 for the other ) , could be used to provide information about the distribution of haloes within eulerian cells @xmath7 .",
    "the case in which @xmath68 for both barriers is also interesting .",
    "consider two barriers @xmath174 and @xmath175 .",
    "if @xmath176 and @xmath177 , then the two barrier problem is associated with the joint distribution of the mass within two concentric eulerian cells .",
    "therefore , it may be useful for estimating the evolved eulerian space density profile . of course , in the model , haloes collapse to zero radius , and this is unrealistic . in practice , haloes virialize at some fraction of their turnaround radius .",
    "therefore , the solution of this two barrier problem is probably only useful on scales larger than the virial radius .",
    "if , instead , @xmath178 , but @xmath179 , then the two barrier problem describes the matter within the same comoving cell at two different epochs .",
    "that is , it can be used to quantify the way in which matter flows in and out of ( comoving ) eulerian cells .",
    "this section shows how the model described in section  [ model ] can be used .",
    "it assumes that the initial lagrangian space distribution is white - noise gaussian and studies the first crossing distribution of a barrier whose height decreases linearly as @xmath180 decreases : @xmath181 where @xmath182 , and @xmath183 .",
    "this barrier shape was chosen for a number of reasons .",
    "first , this shape is a simple approximation to the spherical collapse barrier ( compare equation  [ mow ] , and see fig .  [ barrier ] ) , and the associated dynamical evolution is similar .",
    "section  [ scoll ] shows how the evolution of a spherical perturbation in this model differs from that in the usual spherical collapse model .",
    "second , the first crossing distribution of a linear barrier is known , so the associated eulerian distribution can be written analytically ; it is inverse gaussian .",
    "the inverse gaussian is a good approximation to the distribution measured in numerical simulations of clustering from white noise initial conditions ( section  [ sims ] ) , so the model may also be realistic . finally ,",
    "for this barrier , the halo  mass and halo  halo correlations can all be computed analytically .      the linear barrier studied in this section",
    "is associated with the following model for the collapse of objects .",
    "let @xmath53 denote the comoving size of an object at the epoch @xmath2 .",
    "then @xmath184 initially .",
    "if the object is in an underdense region , then its comoving size will increase , else it will decrease . trajectories with extrapolated linear overdensity @xmath52 greater than @xmath21 are associated with collapsed objects . collapsed objects have @xmath185 .",
    "equation  ( [ linbar ] ) implies that , before collapse , @xmath186 the radius of an object in proper , physical coordinates is @xmath187 .",
    "objects which collapse have a turnaround radius  the maximum value that @xmath188 attains .",
    "this occurs at @xmath189 at which time @xmath190    in comparison , collapsing objects in the spherical model reach turnaround at @xmath191 at which time @xmath192 ( e.g. peebles 1980 ) .",
    "[ rphys ] shows that , for overdense perturbations , turnaround in this model ( dashed lines ) occurs later , and at a larger radius , than in the spherical model ( solid lines ) . to compensate ,",
    "underdense regions expand less rapidly in this model than in the spherical model .      in the limit",
    "@xmath4 , equation  ( [ linbar ] ) for the barrier shape becomes independent of @xmath86 , as it does for the spherical collapse model . in this limit ,",
    "the first crossing distribution is known ( e.g. bond et al . 1991 ) , although we give a different derivation of it below .",
    "therefore , to set notation , this section summarizes various known results about the crossing of a constant barrier by the lagrangian trajectories described earlier , under the assumption that @xmath70 is a gaussian random field .",
    "let @xmath193 denote the fraction of trajectories that have value between @xmath52 and @xmath194 at @xmath86 .",
    "also , let @xmath195 denote the fraction of those trajectories which first crossed the barrier @xmath95 between @xmath196 and @xmath197 , which have value between @xmath52 and @xmath194 at @xmath198 .",
    "then @xmath199 provided that at @xmath86 , @xmath200 . if both @xmath201 and @xmath202 are known , then this is a volterra equation of the first kind , so it can be solved numerically , by forward substitution , to yield @xmath203 .",
    "suppose that the probability distribution of the density in the lagrangian space is gaussian .",
    "then @xmath204 if the window @xmath71 is sharp in @xmath205-space , then @xmath206 and @xmath207 \\label{pjoint}\\ ] ] ( e.g. bond et al . 1991 ) .",
    "thus , if the lagrangian space distribution is gaussian , and the window function is sharp in @xmath205-space , then the distribution of first crossing times is easy to compute , whatever the boundary shape .",
    "equations  ( [ kspace ] ) and  ( [ pjoint ] ) are also correct for a top hat filter in real space , if the gaussian field is white noise .",
    "so , the distribution of first crossing times is easy to compute for white noise also . in either of these cases , a trajectory @xmath91 resembles the motion of a particle undergoing standard brownian motion with zero drift .",
    "bond et al .",
    "( 1991 ) and lacey & cole ( 1993 ) used this fact to compute @xmath208 .",
    "notice , however , that when the boundary is a constant , @xmath209 , then the form of @xmath208 can be obtained directly from equation  ( [ volt ] ) .",
    "first , take the derivative with respect to @xmath52 on both sides of equation  ( [ volt ] ) , and evaluate it at @xmath210 .",
    "next , set @xmath211 .",
    "then the integrand on the right hand side is zero , except when @xmath212 .",
    "thus , equation  ( [ volt ] ) implies that @xmath213 ) & = &   { \\delta_{\\rm c}(z)\\over s_0}\\,p(s_0,\\delta_{\\rm c}[z ] )   \\nonumber \\\\ & = & { \\delta_{\\rm c}(z)\\over \\sqrt{2\\pi s_0 } } \\,\\exp\\left(-{\\delta_{\\rm",
    "c}^2(z)\\over 2s_0}\\right ) { { \\rm ds_0}\\over s_0 } ,    \\label{fps}\\end{aligned}\\ ] ] where the subscript ` c ' denotes the fact that this is the distribution of first crossings of a constant boundary .",
    "if the trajectory is known to start from @xmath214 , rather than from the origin , then the distribution of first crossings of the constant barrier @xmath215 can be solved similarly .",
    "provided @xmath216 and @xmath217 , @xmath218 these expressions for the first crossing distribution are the same as those derived by bond et al .",
    "( 1991 ) and lacey & cole ( 1993 ) .",
    "following bond et al .",
    "( 1991 ) , treat the parameter @xmath133 as a pseudo - time variable ; it decreases as the universe evolves .",
    "then associate the first crossing distribution of the barrier @xmath133 with a number density of regions containing mass @xmath3 in the lagrangian space , and call every such region a dark matter halo .",
    "then the number density of @xmath22 haloes at the epoch labelled by @xmath219 is @xmath220 this is consistent with equation  ( [ fsnm ] ) , and @xmath19 is sometimes called the unconstrained halo mass function at the epoch @xmath23 .    similarly , the average number of @xmath33-haloes that are within an @xmath221-halo is @xmath222 ( e.g. lacey & cole 1993 ) .",
    "this is the constrained mass function .",
    "the joint distribution of the number @xmath25 of @xmath33-haloes and the number @xmath41 of @xmath223-haloes , that are both within the same @xmath221-halo , averaged over all @xmath221-haloes is @xmath224 where @xmath170 is given by equation  ( [ n10 ] ) , and @xmath225 ( sheth 1996b ) . here",
    "@xmath226 and @xmath227 is the overdensity in the remaining volume @xmath228 that is not occupied by the @xmath22-halo .",
    "that is , @xmath229 however , @xmath230 and @xmath231 , so that , to lowest order , @xmath232    most of the formulae in this section are not new , but they will all be useful below . they have been included to set notation , and because , as the previous section showed , if these expressions are known , then simple transformations allow one to compute the associated eulerian space quantities .",
    "the previous subsection described the first crossing distribution associated with a constant barrier by trajectories associated with a lagrangian field that is gaussian white noise . recall that the constant barrier is got from the linear barrier of equation  ( [ linbar ] ) by setting @xmath104 .",
    "when @xmath68 , then direct substitution shows that @xmath233 where @xmath234 is given by equation  ( [ linbar ] ) , satisfies equation  ( [ volt ] ) .",
    "the identity @xmath235 which follows from the definition of the modified bessel function of the third kind , is useful in proving this result .",
    "a full derivation of this distribution is given in appendix  [ deriv ] .",
    "equation  ( [ invg ] ) is known as the inverse gaussian distribution .",
    "it was first discovered in the context of brownian motion by schrdinger ( 1915 ) .",
    "folks & chhikara ( 1978 ) give a review of its role in other fields . here , the distribution represents the fraction of lagrangian space which is associated with regions of mass @xmath236 provided the initial distribution is white - noise gaussian , and the dynamics are a simple modification of the usual spherical collapse model ( as described in the previous subsection . )    for white noise , @xmath237 , so , for white noise , equation  ( [ invg ] ) in  ( [ fspd ] ) implies that the eulerian distribution function that is associated with the linear barrier is @xmath238\\   { { \\rm d}\\delta\\over\\delta } , \\label{pdinvg}\\end{aligned}\\ ] ] where @xmath239 and we have not bothered to write the @xmath2 dependence of @xmath16 explicitly .",
    "notice that @xmath240 is also an inverse gaussian distribution .",
    "the mean of this distribution is @xmath241 , and the variance is @xmath242 .",
    "the higher order moments of this distribution are simple .",
    "if @xmath243 is the @xmath107th cumulant of this distribution , then @xmath244 and it is independent of cell size @xmath7 .",
    "this is simply a consequence of the fact that , in the model , haloes have vanishingly small eulerian sizes : @xmath104 .",
    "as @xmath245 , this inverse gaussian tends to the gaussian distribution . for fixed @xmath7 , this happens if @xmath246 .",
    "since @xmath2 is a pseudo - time variable , this means that , at sufficiently early times , the eulerian distribution is gaussian for almost all scales @xmath7 .",
    "this is sensible , since at early times , the eulerian and lagrangian distributions should be similar , and , by hypothesis , the lagrangian distribution is gaussian . for a given @xmath2 , @xmath245 as @xmath247 .",
    "this means that , even at later times , the eulerian distribution function , measured in sufficiently large cells @xmath7 , appears gaussian .",
    "when @xmath248 , then the term in the exponent of equation  ( [ pdinvg ] ) tends to @xmath249 , so @xmath250 times equation  ( [ enm1d1 ] ) , which is the same as @xmath251 times equation  ( [ fps ] ) .",
    "this is consistent with the fact that , in this limit , equation  ( [ linbar ] ) shows that the barrier shape tends to the constant @xmath252 , and the first crossing distribution of a constant barrier is given by equation  ( [ fps ] ) .",
    "this shows explicitly that the unconstrained mass function of  ( [ enm1d1 ] ) is essentially the same as the eulerian distribution function , in the limit of vanishing cell size @xmath7 .",
    "all these asymptotic relations are sensible .",
    "a little algebra shows that when the barrier shape is linear , then equation  ( [ fseul ] ) is satisfied for all @xmath1 .",
    "recall that that expression simply expresses the fact that the fraction of trajectories which first cross the constant barrier @xmath253 at @xmath143 is equal to the fraction of trajectories which first cross the linear barrier ( associated with the eulerian scale @xmath1 ) at @xmath254 , and then cross the constant barrier @xmath255 at @xmath143 , summed over all @xmath160 .",
    "of course , this implies that equation  ( [ nmav ] ) is also satisfied : @xmath24 is equal to @xmath7 times equation  ( [ enm1d1 ] ) , as it should .",
    "this shows explicitly that , for the linear barrier , the number density of haloes in the eulerian space is equal to that in the lagrangian space , and this number density is just what is required by the bond et al .",
    "( 1991 ) excursion set approach .",
    "the cross correlation between haloes and mass can be worked out similarly .",
    "start with equation  ( [ xihme ] ) .",
    "use equation  ( [ fspd ] ) to write @xmath256 in terms of the lagrangian barrier crossing distribution @xmath173 .",
    "then use  ( [ invg ] ) for @xmath173 , and recall that @xmath257 where equation  ( [ linbar ] ) gives @xmath234 .",
    "this means that @xmath258 , where @xmath259 .",
    "then use equation  ( [ enns ] ) to set @xmath260 , and use  ( [ n10 ] ) for @xmath170 with @xmath257 . with these substitutions ,",
    "the integral in equation  ( [ xihme ] ) can be solved analytically : @xmath261 where @xmath262 @xmath263 notice that when @xmath264 , then @xmath265 .",
    "that is , the only correlation that arises is that which is due to the fact that there is a halo of mass @xmath22 inside @xmath7 , so there is certainly mass @xmath22 inside @xmath7 . since @xmath266 equations  ( [ params ] ) and  ( [ dcz ] ) imply that @xmath267 this ratio is independent of the eulerian cell size @xmath7 .",
    "again , this a consequence of the fact that the model assumes that haloes have zero volume , so if a halo is within a cell , then all its associated mass is also .",
    "this expression has an interesting relation to previous work .",
    "mo & white ( 1996 ) argue that , when @xmath268 , then , in the limit of large @xmath7 , @xmath269}\\right)\\ ,   \\bigl\\langle\\delta^2\\bigr\\rangle , \\ ] ] where @xmath270 .",
    "now , @xmath271 , and @xmath272 for large @xmath7 , so this expression is the same as what is required by equations  ( [ dcz ] ) and  ( [ xihmxim ] ) if @xmath273 .",
    "the extra factor of @xmath21 arises from the fact that , for large @xmath7 the density fluctuation @xmath54 in most eulerian cells is small , so @xmath274 for most @xmath7 . in this limit ,",
    "equation  ( [ mow ] ) shows that @xmath275 in the collapse spherical model , whereas equation  ( [ linbar ] ) shows that it is @xmath276 for the linear barrier ,    let @xmath277 denote the correlation function of @xmath22 and @xmath39 haloes identified at the epoch @xmath23 , averaged over all comoving eulerian cells @xmath7 , at the epoch @xmath259 .",
    "recall that this average can be computed in two steps .",
    "all eulerian cells can be classified by the mass @xmath3 within them .",
    "further classify all eulerian cells which contain mass @xmath3 by their lagrangian overdensity @xmath52 .",
    "since the number of such regions is conserved , the joint distribution of the number of @xmath22 and @xmath39 haloes , @xmath278 , averaged over all such @xmath279-regions , is the same in both spaces , provided we set @xmath163 .",
    "this average gives @xmath42 of equation  ( [ c120 ] ) , where @xmath163 and @xmath234 is given by  ( [ linbar ] ) .",
    "all that remains is to further average @xmath42 over the number of such conserved regions .",
    "this is done by weighting it by @xmath240 , integrating over @xmath56 , and then dividing out the factors expected on average .",
    "we have gone to the trouble of stating things this way to show that our definition of @xmath280 includes the effects of the scatter of halo counts in eulerian regions which had the same overdensity as well as the same radius initially .",
    "therefore , @xmath172 here denotes the same quantity as @xmath281 of equation  ( 25 ) in mo & white ( 1996 ) .",
    "now , @xmath282 is given by equation  ( [ xihhe ] ) , where @xmath42 is given by equation  ( [ c120 ] ) . with equations  ( [ fspd ] ) and",
    "( [ invg ] ) for @xmath240 , and setting @xmath163 as before , this integral can be solved analytically .",
    "the result is that @xmath283 where @xmath284 , and @xmath285 is defined as before . like the halo  mass correlation function ,",
    "this ratio is independent of @xmath7 because , in the model , haloes are point sized .",
    "thus , in the model , haloes are linearly - biased tracers of the mass on all scales .",
    "mo & white ( 1996 ) argue that @xmath286 should equal @xmath287 on large scales .",
    "although our equation  ( [ xihmxim ] ) for @xmath288 is similar to theirs , the right hand side of our equation  ( [ xihhxim ] ) is not the same as the square of the right hand side of equation  ( [ xihmxim ] ) ; they differ by a factor of @xmath289 ^ 2 $ ] .    when @xmath264 , @xmath290 , which implies that haloes , when they first virialize , are uncorrelated with each other .",
    "further , the correlation of haloes depends on the sum of the halo masses , but not on the masses themselves .",
    "this suggests that halo ",
    "halo correlations arise because of volume exclusion effects only .",
    "that is , halo  halo correlations arise from the fact that an @xmath22-halo occupies a region @xmath155 initially , so no other halo can occupy this region .",
    "the correlation function is affected by the fact that a region is included , but not by the exact way in which the excluded region is populated .",
    "if the halo masses @xmath22 and @xmath39 and their formation epoch @xmath23 are fixed , then the halo  halo correlation function at a given comoving @xmath1 increases as @xmath291 decreases .",
    "this increase reflects the fact that haloes which formed at @xmath23 , at which time they were uncorrelated with each other , must have merged with each other to construct the more massive haloes present at the later epoch @xmath259 .",
    "suppose , instead , that the halo masses , the comoving scale , and the epoch at which the halo distribution is measured ( i.e. , @xmath291 ) , are given , and we wish to consider the effect of changing the halo formation epoch @xmath284 .",
    "equation  ( [ xihhxim ] ) shows that as @xmath23 decreases to @xmath291 , @xmath172 decreases .",
    "that is , at fixed mass , the halo ",
    "halo correlation function in comoving coordinates exhibits negative evolution .",
    "the previous subsections showed how the first crossing of a linear barrier by brownian walks could be used to compute various interesting quantities associated with gravitational clustering .",
    "this section shows that the associated two barrier problem may also be useful .",
    "in general , the linear barrier has two free parameters which may be thought of as the @xmath292-intercept @xmath21 and the slope @xmath293 , respectively : @xmath294 below , we consider the statistics of trajectories which first cross a barrier with one choice of parameters , and then cross another .",
    "first , consider two barriers @xmath295 and @xmath296 which have the same @xmath292-intercept @xmath21 , but different slopes , @xmath297 and @xmath298 .",
    "assume that @xmath299 .",
    "this means that trajectories must cross the barrier @xmath296 before they can cross @xmath295 .",
    "we seek an expression for the probability that a trajectory has its first crossing of @xmath295 at @xmath143 , given that it has its first crossing of the barrier @xmath296 at @xmath300 .",
    "recall the derivation of the barrier crossing distribution given in the appendix . to a particle that started from the origin and",
    "has just crossed the barrier @xmath301 , the barrier @xmath302 has shape @xmath303 since this barrier is also linear , the solution is the same as before , except that @xmath304 and @xmath305 .",
    "therefore , the first crossing distribution is @xmath306 @xmath307 since @xmath21 is a pseudo - time variable , and it is the same for the two barriers , equation  ( [ lindb ] ) shows that the expression above will be useful for computing statistics in concentric cells @xmath155 and @xmath308 , at the same epoch .",
    "therefore , it may be useful for computing eulerian density profiles within the context of the model . since , in the model , haloes collapse to zero radius , this way of computing density profiles is probably only useful on scales larger than the virial radius .",
    "the virial radius can be derived from combining the spherical collapse model with the fact that the mass within the virial radius is given by the scale at which the trajectory first crosses @xmath21 .",
    "the corresponding expression for two barriers which have the same slope @xmath293 , but have different values for the @xmath292-intercept , say , @xmath253 and @xmath309 is @xmath310 @xmath311 ^ 2\\over 2(s_1-s_2)}\\right){{\\rm d}s_1\\over ( s_1-s_2 ) } .\\ ] ] equation  ( [ lindb ] ) shows that this provides information about the matter in concentric cells @xmath155 and @xmath308 , at two different epochs . since the value of @xmath293 is the same , the two cell sizes are related : @xmath312 .",
    "more interesting , perhaps , is the case in which the cell sizes @xmath7 are the same , but @xmath313 .",
    "this case is also more complicated , since now it is possible to cross barrier 1 before crossing barrier 2 .",
    "provided @xmath314 , @xmath315 @xmath316 ^ 2\\over 2(s_1-s_2)}\\right){{\\rm d}s_1\\over ( s_1-s_2 ) } , \\ ] ] where @xmath317 , and @xmath297 and @xmath298 are given by using  ( [ linbar ] ) in  ( [ lindb ] ) , with @xmath253 and @xmath318 , respectively .",
    "when the first crossing of @xmath296 occurs at @xmath319 , then the trajectory will have crossed @xmath295 first . in this case , @xmath320 is given by the expression above , provided the labels 1 and 2 are interchanged .",
    "bayes rule then gives the associated @xmath321 , since @xmath322 these expressions contain information about the mass in the same comoving eulerian cell at different epochs .",
    "they show that it is possible that the mass in @xmath7 first decreases and later increases .",
    "this shows explicitly that , in the model , matter can flow in and out of eulerian cells .",
    "this subsection shows that the inverse gaussian distribution provides a good description of the evolved distribution for clustering from white noise initial conditions . before doing so",
    ", we first argue that such a test has , in fact , already been performed by others .",
    "the inverse gaussian is a limiting form of the generalized poisson distribution ( gpd ) @xmath323^{n-1 } \\ , { \\rm e}^{-\\bar n_{\\rm c } - nb } , \\label{gpd}\\ ] ] where @xmath324 is the number of identical particles in a randomly placed cell of size @xmath1 which contains @xmath325 particles on average , @xmath326 , and @xmath327 . in the astrophysical context , the gpd was first derived by saslaw & hamilton ( 1984 ) .",
    "it can be related to the inverse gaussian as follows ( fry 1985 ; sheth 1996a ) .",
    "the mean of this discrete distribution is @xmath325 , and the variance is @xmath328 .",
    "notice that as @xmath329 and @xmath330 , @xmath331 , which is the relation required by equation  ( [ params ] ) . in this limit",
    ", @xmath332 tends to the inverse gaussian distribution @xmath240 , since @xmath333 .",
    "sheth ( 1998 ) shows that the gpd can be derived using a boundary crossing , excursion set model associated with the poisson distribution in the initial lagrangian space .",
    "the linear barrier shape considered in this paper is a limiting form of that associated with the poisson case .",
    "this correspondence is important , since the gpd is in good agreement with numerical simulations of clustering from poisson initial conditions ( itoh , inagaki & saslaw 1993 and references therein ) , provided the variance is allowed to be a free function of scale .",
    "bouchet & hernquist ( 1992 ) showed that the gpd also describes clustering from white - noise initial conditions well .",
    "this just reflects the ( intuitively obvious ) fact that clustering from poisson and white - noise initial conditions should evolve similarly . since the inverse gaussian is just a limiting form of the gpd ( just as the white - noise gaussian is a limiting form of the poisson distribution )",
    ", the inverse gaussian should provide a good approximation to the eulerian distribution measured in simulations of clustering from white noise initial conditions , in the regime where discreteness effects are unimportant .",
    "[ pdf0 ] shows this explicitly .",
    "the simulations of clustering from white noise initial conditions used here are the same as those studied by mo & white ( 1996 ) , where they are described in more detail .",
    "the simulations contain @xmath334 particles in a cube with periodic boundary conditions .",
    "the figure shows the evolved eulerian distribution function for a few representative choices of the comoving scale .",
    "each panel shows results for counts in spherical cells with comoving radii @xmath335 , @xmath336 , @xmath337 , and @xmath338 times the box size .",
    "for each cell size , the thin curves show the distribution of counts averaged over @xmath339 cells .",
    "the two panels show results at two different expansion factors @xmath340 , where @xmath341 initially .",
    "comparison with the linear barrier model developed here is a little tricky . in principle",
    ", the model requires that the free parameter @xmath242 of the inverse gaussian distribution ( equation  [ pdinvg ] ) should scale as @xmath342 .",
    "in fact , although @xmath242 in the simulations is @xmath343 initially , it scales differently at later times ( e.g. hamilton et al . 1991 ; jain , mo & white 1995 ) .",
    "therefore , when comparing equation  ( [ pdinvg ] ) with the simulations , on any scale @xmath7 , we assume that @xmath344 is given by the value measured in the simulations . since @xmath242 is related to the variance , the thick curves in fig .",
    "[ pdf0 ] show inverse gaussian distributions that have the same variance as the distributions shown by the thin curves .",
    "when this is done , the inverse gaussian ( equation  [ pdinvg ] ) describes the simulation results reasonably well on all scales at all times .",
    "in fact , the inverse gaussian fits @xmath345 at least as well as the press ",
    "schechter mass function ( equation  [ enm1d1 ] ) fits the distribution of cluster masses ( see , e.g. , lacey & cole 1994 ) .",
    "since the evolution of the variance is reasonably well understood ( hamilton et al .",
    "1991 ; jain , mo & white 1995 ) the results for the linear barrier presented here may be of more than just academic interest .",
    "for example , in the linear barrier model , when haloes first virialize , they are uncorrelated with each other ( section  [ halobar ] )",
    ". what correlations do exist arise primarily from volume exclusion effects .",
    "that is , in the initial lagrangian space , haloes occupy a volume that is proportional to their mass . since no other",
    "halo can occupy the region taken up by a given halo , this exclusion effect gives rise to ( anti)-correlations , at least on small scales .",
    "this is probably a generic consequence of the white - noise initial conditions , and not specific to the linear barrier model .",
    "this paper develops a model that allows one to provide an approximate description of the spatial distribution of dark matter , as well as dark matter haloes , in a self - consistent way .",
    "it can also be used to estimate the density profiles of haloes , and to quantify how matter flows in and out of eulerian cells .",
    "the model is described in section  [ model ] .",
    "the model assumes that , at the epoch @xmath2 , the comoving eulerian size @xmath1 of an initial lagrangian region @xmath51 , is related to its initial overdensity @xmath52 .",
    "this assumption is motivated by the spherical collapse model . the additional assumption that the number of such regions is conserved , only their comoving size changes , allows one to compute statistics in the eulerian space by taking appropriate averages over the relevant lagrangian space quantities .",
    "since the initial lagrangian distribution can be computed ( e.g. mo & white 1996 ; sheth & lemson 1998 ) , so can the eulerian distribution .",
    "the algorithm for taking these appropriate averages is related to the solution of an excursion set , barrier crossing problem , in which the barrier shape is given by the spherical collapse model .",
    "a constant barrier is a special case of the barrier studied here .",
    "the first crossing distribution associated with a constant barrier can be used to estimate the distribution of virialized halo masses ( bond et al .",
    "1991 ) . in the context of this paper",
    ", this special case corresponds to the limit of vanishing eulerian cell size ; the halo mass function is simply the eulerian probability distribution function in the limit of vanishing eulerian cell size .",
    "thus , the model here shows how the bond et al .",
    "( 1991 ) construction that yields the halo mass function can be extended to yield the eulerian probability distribution function .",
    "the results of mo & white ( 1996 ) are also easily understood within the context of this model .    in section  [ linear ] , the linear barrier was used to show explicitly how the model works .",
    "this was done for a number of reasons .",
    "firstly , the spherical collapse barrier problem must be solved numerically , whereas , for the linear barrier , most interesting quantities can be computed analytically .",
    "secondly , within the context of this model , the linear barrier can be understood as arising from a simple variant of the spherical collapse model ( section  [ scoll ] ) . for this barrier shape ,",
    "the associated eulerian distribution is inverse gaussian ( section  [ pdfe ] ) , and this is good agreement with numerical simulations of clustering from white noise initial conditions ( fig .",
    "[ pdf0 ] ) .",
    "this provides yet another reason for considering the linear barrier .    in the model ,",
    "correlations between haloes and mass arise from the simple fact that a cell which is known to contain a halo certainly contains that halo s mass .",
    "correlations between haloes arise primarily from volume exclusion effects .",
    "that is , in the initial lagrangian space , haloes occupy a volume that is proportional to their mass .",
    "since no other halo can occupy the region taken up by a given halo , this exclusion effect gives rise to ( anti)-correlations , at least on small scales .",
    "this is probably a generic consequence of the white - noise initial conditions , and not specific to the linear barrier .    for the linear barrier model , the evolution of halo ",
    "halo correlations can be written analytically ( section  [ halobar ] ) .",
    "section  [ twobar ] showed that the two - linear - barrier problem can also be solved analytically ; in the model , this can be used to provide information about the density run around random positions in eulerian space .",
    "although the necessary formulae were all derived there , we did not pursue this further .",
    "the inverse gaussian distribution was derived here by considering the distribution of crossings of a linear barrier by brownian motion .",
    "the relation between this barrier shape ( equation  [ linear ] ) and that required by the spherical collapse model ( equation  [ mow ] ) was discussed in section  [ scoll ] .",
    "the thick solid lines in fig .  [ barrier ] show this spherical collapse barrier ( equation  [ mow ] ) for representative values of @xmath346 .",
    "curves for larger @xmath1 look just like those for smaller @xmath1 except that are shifted to the left ( since the @xmath347-axis of the plot shows the negative of the logarithm of @xmath50 ) .",
    "curves for the same comoving @xmath1 but at higher redshift are simply multiplied by @xmath348 , so the zero crossing remains the same .",
    "dashed curves show the corresponding quantities for the linear barrier used in section  [ linear ] .",
    "this figure shows that changing the comoving size @xmath1 at fixed @xmath2 is equivalent to rescaling the @xmath86 axis , and changing @xmath2 at fixed comoving radius @xmath1 is equivalent to rescaling the @xmath52 axis .",
    "this provides a strong constraint on the form of the distribution of first crossings .",
    "namely , it implies that @xmath349 should have a self - similar form , in that it should be a function of two parameters , one which is related to the scaling of the @xmath86 axis , and another which relates the scaling of the @xmath86 axis to that of the @xmath52 axis .",
    "since the first crossing distribution is a function of only two parameters , the associated eulerian distribution is also .",
    "it is convenient , then , to think of these parameters as being the mean and variance of the eulerian distribution .",
    "this is an attractive feature of the model , since colombi et al .",
    "( 1997 ) find that , to a good approximation , the eulerian distributions measured in @xmath324-body simulations of clustering from white noise initial conditions are functions of the mean and the variance only .",
    "initial gaussian random fields with scale - free power spectra , @xmath350 and @xmath351 , are a simple generalization of white - noise ( for which @xmath352 ) .",
    "equation  ( [ slin ] ) shows that , for these spectra , @xmath353 which means that @xmath354 , where @xmath355 .",
    "this means that , when plotted as a function of @xmath356 , the shape of the spherical collapse barrier depends on the initial power spectrum .",
    "although the barrier shape when @xmath357 is different than for white noise , it still has the same scaling as the white noise barrier , since changing the eulerian scale @xmath1 is still equivalent to a simple shift of the barrier along the @xmath358 axis .",
    "so , the barrier crossing and the associated eulerian distributions will still be functions of two parameters .",
    "this is in qualitative agreement with the results of colombi et al .",
    "( 1997 ) .    for initial conditions that are not scale - free , changing the eulerian scale @xmath1 is no longer equivalent to a simple shift of the barrier along the @xmath358 axis .",
    "thus , the barrier crossing distribution is no longer self  similar , and the associated eulerian distribution is no longer a function of just two parameters . of course",
    ", two parameter fits may remain a good approximation ; at issue is the rate of change of the slope of the power spectrum over the scales at which most of the trajectories cross the barrier .",
    "while these are encouraging features of the model , extending it to describe clustering from initial conditions that are different from white noise is not straightforward .",
    "the problem is one of ensuring correct normalization . for scale  free initial conditions , equations  ( [ s0n ] ) and  ( [ fspd ] ) , and the requirement that the associated eulerian distribution have unit mean ( equation  [ norm ] ) , means that the first crossing distributions must satisfy @xmath359 the previous section showed that , for a white - noise gaussian field , the distribution of first crossings of the linear barrier has an associated eulerian distribution which has unit mean , as required .",
    "however , in general , not all barrier shapes are compatible with this requirement .",
    "for example , recall that equation  ( [ bnrdo ] ) with @xmath62 is a good approximation to the spherical collapse model .",
    "when @xmath360 , @xmath361 , so the associated barrier , when written as a function of @xmath86 , is the same ( linear ) as it was in section  [ linear ] .",
    "now , for a linear barrier , the first passage distribution is inverse gaussian .",
    "however , when @xmath362 and @xmath349 is inverse gaussian , then the second equality of equation  ( [ fsalpha ] ) is not satisfied .",
    "thus , it appears likely that , for arbitrary power spectra , the excursion set approach developed here will not work if at least some parametrizations of the spherical collapse barrier are used .",
    "this means that it may be more fruitful to consider the inverse problem to that considered in this paper .      in this paper ,",
    "the barrier shape was specified , then the first crossing distribution was obtained , and finally , the associated eulerian distribution was derived .",
    "it may be more useful to first specify an eulerian distribution .",
    "then , transform it to a first crossing distribution , from which the shape of the barrier can be inferred .",
    "this ensures that all normalization requirements have been satisfied .",
    "once the barrier shape is known , the halo  mass and halo  halo correlations can be worked out just as they were in this paper .",
    "finally , this barrier shape can be compared with that required by the spherical collapse model .    in this context , it is worth mentioning that there is a class of distributions which provides convenient generalizations of the inverse gaussian , and may provide useful approximations to the eulerian distributions measured in simulations of gravitational clustering from scale  free initial conditions .    the generalized inverse gaussian ( gig ) distribution with index @xmath363 , scale parameter @xmath364 , and concentration parameter @xmath365 is @xmath366 where @xmath367 is a modified bessel function of the third kind with index @xmath363 . for a given @xmath363 ,",
    "these are functions of just two parameters , @xmath364 and @xmath365 , so they have the self  similar property discussed above . for these modified bessel functions , @xmath368 therefore , when @xmath369 , then the gig distributions , with @xmath370 , @xmath371 and @xmath372 satisfy equation  ( [ fsalpha ] ) , so the associated eulerian distributions are correctly normalized and have unit mean . when @xmath352 , then @xmath373 , so @xmath374 , and this distribution is the same as the inverse gaussian distribution considered in section  [ linear ] .    the symbols in fig .",
    "[ skew ] show the values of @xmath375 and @xmath376 ( defined similarly to equation  [ esen ] ) plotted versus variance for these gig distributions when @xmath352 ( filled circles ) , @xmath377 ( open circles ) , and @xmath378 ( stars ) .",
    "the curves were computed using the extended perturbation theory fitting functions of colombi et al .",
    "the solid curves show their fits to the values of @xmath375 and @xmath376 measured in numerical simulations of clustering from the corresponding scale - free initial conditions , and dashed curves give an estimate of the allowed range of values .",
    "while the gig values do not fit the numerical results , they do show similar trends .",
    "the problem , then , is to determine the shape of the barrier for which the gig distribution is the first crossing distribution , and to then compute the associated halo distribution .",
    "the solution of this inverse problem is the subject of ongoing work , where the barriers associated with the distributions given by the extended perturbation theory of colombi et al .",
    "( 1997 ) are also used as the eulerian distributions .",
    "i thank houjon mo and simon white for providing the data from their simulations , and both of them , and gerard lemson , for interesting discussions .",
    "bernardeau f. , 1994 , a&a , 291 , 697    bond j. r. , cole s. , efstathiou g. , kaiser n. , 1991 , apj , 379 , 440    bouchet f. r. , hernquist l. , 1992 , apj , 400 , 25    colombi s. , bernardeau f. , bouchet f. r. , hernquist l. , 1997 , mnras , 287 , 241    cox d. r. , miller h. d. , 1967 , the theory of stochastic processes .",
    "j. wiley & sons , new york    folks j. l. , chhikara r. s. , 1978 , j. r. statist .",
    "b , 40 , 263    fry j. , 1985 , apj , 289 , 10    hamilton a. j. s. , kumar p. , lu e. , matthews a. , 1991 , apj , 374 , l1    itoh m. , inagaki s. , saslaw w. c. , 1993 , apj , 403 , 459    jain b. , mo h. j. , white s. d. m. , 1995 , mnras , 276 , l25    kao e. p. c. , 1996 , an introduction to stochastic processes .",
    "wadsworth publishing company , belmont    lacey c. , cole s. , 1993 , mnras , 262 , 627    mo h. j. , white s. d. m. , 1996 , mnras , 282 , 347    peebles p. j. e. , 1980 , the large scale structure of the universe .",
    "princeton univ . press , princeton    press w. , schechter p. , 1974",
    ", apj , 187 , 425    saslaw w. c. , hamilton a. j. s. , 1984 , apj , 276 , 13    schrdinger e. , 1915 , physikalische zeitschrift , 16 , 289    sheth r. k. , 1996a , mnras , 281 , 1124    sheth r. k. , 1996b , mnras , 281 , 1277    sheth r. k. , 1998 , mnras , accepted    sheth r. k. , lemson g. , 1998 , mnras , in preparation",
    "this appendix presents a derivation of the first time @xmath379 that a particle undergoing brownian motion with zero drift reaches the linear barrier @xmath380 having started from the origin @xmath381 .",
    "let @xmath382 denote the first passage time distribution associated with this barrier .",
    "the subscript @xmath383 indicates the height of the barrier at @xmath384 .",
    "the assumption of zero drift means that , in the absence of the absorbing barrier , the mean distance of a particle from the @xmath379 axis , averaged over the ensemble of brownian walks of the type shown in fig .",
    "[ bmotion ] , is zero . to be more precise ,",
    "recall that equation  ( [ pgaus ] ) gives the probability @xmath385 that a trajectory has value between @xmath52 and @xmath386 , at @xmath379 .",
    "so , for those trajectories , @xmath387 and @xmath388 since @xmath389 for all @xmath379 , these are said to be brownian walks with zero drift .",
    "consider another linear barrier which is a simple shift of @xmath390 along the @xmath54 axis of the barrier above : @xmath391 let @xmath392 denote the first passage time distribution associated with this barrier .",
    "the subscript @xmath365 indicates the height of the barrier when @xmath384 .",
    "then @xmath393 where @xmath394 denotes the first passage time distribution to @xmath395 , given that the particle started at @xmath396 $ ] instead of the origin .",
    "since the particle is undergoing brownian motion , @xmath394 is the same as for a particle that starts at the origin , but sees a barrier @xmath397 so , we can write @xmath398 where the subscript @xmath390 indicates that the height of the barrier above the starting position at @xmath196 is @xmath390",
    ".    this means that equation  ( [ f1s ] ) is a convolution equation : @xmath399 when @xmath400 , then the barrier is constant , and the first passage distribution is known to be @xmath401 it is straightforward to verify that this expression satisfies the convolution equation above .",
    "therefore , the solution to the convolution equation when @xmath402 must be @xmath403 a more formal derivation can be found in , e.g. , schrdinger ( 1915 ) or cox & miller ( 1967 ) .",
    "the following derivation follows that in kao ( 1996 ) closely .",
    "first , multiply both sides of equation  ( [ f1s ] ) by @xmath404 , and integrate over all @xmath379 .",
    "this gives the laplace transform @xmath405 of @xmath392 .",
    "equation  ( [ f1s ] ) implies that @xmath406 which is the same as @xmath407 this is a functional equation with solution @xmath408 , where @xmath409 is some constant , and we have not bothered to write the dummy variable @xmath410 . the problem , then , is to find @xmath411 .",
    "to do so , notice that the crossing of a barrier which decreases as @xmath379 increases , by brownian walks with zero drift , is equivalent to the crossing of a constant barrier by trajectories that , in the mean , drift upwards as @xmath379 increases , provided that the drift is chosen correctly .",
    "this correct choice of drift corresponds to choosing @xmath412 of course , the variance remains the same , so that @xmath413 so the problem of the crossing of the linear barrier @xmath414 by walks with zero drift is transformed to the problem of the crossing of a constant barrier of height @xmath383 by walks with upward drift @xmath293 . in particular",
    ", the relation  ( [ laplas ] ) remains the same .",
    "so , to find @xmath411 , assume that the probability of first crossing the barrier @xmath383 in the first small increment @xmath415 along the @xmath379 axis is negligible .",
    "suppose that at @xmath416 , the random trajectory has value @xmath417 . then @xmath418 so that @xmath419 in what follows , we will sometimes omit the dummy variable @xmath410 : @xmath420 .",
    "as @xmath415 and @xmath52 are small , @xmath421 and @xmath422 these expressions imply that @xmath423 the second line follows from  ( [ drift1 ] ) and  ( [ drift2 ] ) , and the third is correct to lowest order in @xmath415 .",
    "dividing by @xmath415 , and taking the limit @xmath424 , reduces this to @xmath425 however , @xmath426 these expressions in  ( [ diffeq ] ) imply that @xmath427 so that , if @xmath409 , then @xmath428 since @xmath293 and @xmath410 are both positive .",
    "thus , @xmath429 inverting this laplace transform gives the inverse gaussian distribution .",
    "this problem can also be formulated in the context of the diffusion equation . in the notation of lacey & cole ( 1993 ) ,",
    "the associated diffusion equation is @xmath430 where @xmath293 is the drift term , and @xmath431 represents the solution to this equation in the presence of an absorbing boundary at @xmath432 .",
    "bond et al .",
    "( 1991 ) and lacey & cole ( 1993 ) considered the case @xmath433 ."
  ],
  "abstract_text": [
    "<S> a model of the gravitationally evolved dark matter distribution , in the eulerian space , is developed . </S>",
    "<S> it is a simple extension of the excursion set model that is commonly used to estimate the mass function of collapsed dark matter haloes . </S>",
    "<S> in addition to describing the evolution of the dark matter itself , the model allows one to describe the evolution of the eulerian space distribution of the haloes . </S>",
    "<S> it can also be used to describe density profiles , on scales larger than the virial radius , of these haloes , and to quantify the way in which matter flows in and out of eulerian cells . </S>",
    "<S> when the initial lagrangian space distribution is white noise gaussian , the model suggests that the inverse gaussian distribution should provide a reasonably good approximation to the evolved eulerian density field , in agreement with numerical simulations . </S>",
    "<S> application of this model to clustering from more general gaussian initial conditions is discussed at the end .    </S>",
    "<S> psfig    = 0    methods : analytical  galaxies : clusters : general  galaxies : formation  cosmology : theory  dark matter . </S>"
  ]
}