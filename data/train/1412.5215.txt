{
  "article_text": [
    "let @xmath0 be a set system defined over an @xmath1-point set @xmath2 .",
    "we follow the notation in  @xcite , and view @xmath0 as a set of indicator vectors in @xmath21 , that is , @xmath22 . given a subsequence of indices ( coordinates ) @xmath23 , @xmath24 , @xmath25 , the _ projection @xmath26 _ of @xmath0 onto @xmath27 ( also referred to as the _ restriction _ of @xmath0 to @xmath27 ) is defined as @xmath28 with a slight abuse of notation we write @xmath29 $ ] to state the fact that @xmath27 is a subsequence of indices as above .",
    "we now recall the definition of the primal shatter function of @xmath0 :    the _ primal shatter function _ of @xmath22 is a function , denoted by @xmath30 , whose value at @xmath31 is defined by @xmath32 , |i| = m } |\\v_{|_i}|$ ] . in other words",
    ", @xmath33 is the maximum possible number of distinct vectors of @xmath0 when projected onto a subsequence of @xmath31 indices .    from now on",
    "we say that @xmath34 has _",
    "primal shatter dimension @xmath8 _ if @xmath35 , for all @xmath10 , where @xmath36 and @xmath37 are constants .",
    "a notion closely related to the primal shatter dimension is that of the _ vc - dimension _ :    an index sequence @xmath38 is _ shattered _ by @xmath0 if @xmath39 .",
    "the _ vc - dimension _ of @xmath0 , denoted by @xmath40 is the size of the longest sequence @xmath27 shattered by @xmath0 .",
    "that is , @xmath41 .",
    "the notions of primal shatter dimension and vc - dimension are interrelated . by the sauer - shelah lemma ( see  @xcite and the discussion below ) the vc - dimension of a set system @xmath0 always bounds its primal shatter dimension , that is , @xmath42 .",
    "on the other hand , when the primal shatter dimension is bounded by @xmath8 , the vc - dimension @xmath40 does not exceed @xmath43 ( which is straightforward by definition , see , e.g. ,  @xcite ) .",
    "a typical family of set systems that arise in geometry with bounded primal shatter ( resp . , vc- ) dimension consists of set systems defined over points in some low - dimensional space @xmath44 , where @xmath0 represents a collection of certain simply - shaped regions , e.g. , halfspaces , balls , or simplices in @xmath44 . in such cases ,",
    "the primal shatter ( and vc- ) dimension is a function of @xmath8 ; see , e.g. ,  @xcite for more details . when we flip the roles of points and regions , we obtain the so - called _ dual set systems _",
    "( where we refer to the former as _ primal set systems _ ) . in this case , the ground set is a collection @xmath45 of algebraic surfaces in @xmath46 , and @xmath0 corresponds to faces of all dimensions in the _ arrangement _ @xmath47 of @xmath45 , that is , this is the decomposition of @xmath46 into connected open",
    "_ cells _ of dimensions @xmath48 induced by @xmath45 .",
    "each cell is a maximal connected region that is contained in the intersection of a fixed number of the surfaces and avoids all other surfaces ; in particular , the @xmath49-dimensional cells of @xmath50 are called `` vertices '' , and @xmath8-dimensional cells are simply referred to as `` cells '' ; see  @xcite for more details .",
    "the distinction between primal and dual set systems in geometry is essential , and set systems of both kinds appear in numerous geometric applications , see , once again  @xcite and the references therein .    [ [ delta - packing . ] ] @xmath3-packing .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the _ length _ @xmath51 of a vector @xmath52 under the @xmath53 norm is defined as @xmath54 , where @xmath55 is the @xmath56th coordinate of @xmath57 , @xmath58 .",
    "the _ distance _ @xmath59 between a pair of vectors @xmath60 is defined as the @xmath53 norm of the difference @xmath61 , that is , @xmath62 . in other words , it is the _ symmetric difference distance _ between the corresponding sets represented by @xmath63 , @xmath57 .",
    "let @xmath6 be an integer parameter .",
    "we say that a subset of vectors @xmath64 is _ @xmath3-separated _ if for each pair @xmath5 , @xmath65 .",
    "the _ @xmath3-packing number _ for @xmath0 , denote it by @xmath66 , is then defined as the cardinality of the largest @xmath3-separated subset @xmath67 .",
    "a key property , originally shown by haussler  @xcite ( see also  @xcite ) , is that set systems of bounded primal shatter dimension admit small @xmath3-packing numbers .",
    "that is :    [ thm : packing ] let @xmath22 be a set of indicator vectors of primal shatter dimension @xmath8 , and let @xmath68 be an integer parameter .",
    "then @xmath69 , where the constant of proportionality depends on @xmath8 .",
    "we note that in the original formulation in  @xcite the assumption is that the set system has a finite vc - dimension . however , its formulation in  @xcite , which is based on a simplification of the analysis of haussler by chazelle  @xcite , relies on the assumption that the primal shatter dimension is @xmath8 , which is the actual bound that we state in theorem  [ thm : packing ] .",
    "we also comment that a closer inspection of the analysis in  @xcite shows that this assumption can be replaced with that of having bounded primal shatter dimension ( independent of the analysis in  @xcite ) .",
    "we describe these considerations in section  [ sec : prelim ] .",
    "[ [ previous - work . ] ] previous work .    in his seminal work",
    ", dudley  @xcite presented the first application of _ chaining _ , a proof technique due to kolmogorov , to empirical process theory , where he showed the bound @xmath70 on @xmath66 , with a constant of proportionality depending on the vc - dimension @xmath40 ( see also previous work by haussler  @xcite and pollard  @xcite for an alternative proof and a specification of the constant of proportionality ) .",
    "this bound was later improved by haussler  @xcite , who showed @xmath71 ( see also theorem  [ thm : packing ] ) , and presented a matching lower bound , which leaves only a constant factor gap , which depends exponentially in @xmath40 .",
    "in fact , the aforementioned bounds are more general , and can also be applied to classes of real - valued functions of finite `` pseudo - dimension '' ( the special case of set systems corresponds to boolean functions ) , see , e.g. ,  @xcite , however , we do not discuss this generalization in this paper and focus merely on set systems @xmath0 of finite primal shatter ( resp . , vc- ) dimension .",
    "the bound of haussler  @xcite ( theorem  [ thm : packing ] ) is in fact a generalization of the so - called sauer - shelah lemma  @xcite , asserting that @xmath72 , where @xmath73 is the base of the natural logarithm , and thus this bound is @xmath74 . indeed ,",
    "when @xmath75 , the corresponding @xmath3-separated set should include all vectors in @xmath0 , and then the bound of haussler  @xcite becomes @xmath74 , matching the sauer - shelah bound up to a constant factor that depends on @xmath40 .",
    "there have been several studies extending haussler s bound or improving it in some special scenarios .",
    "we name only a few of them .",
    "gottlieb  @xcite presented a sharpening of this bound when @xmath3 is relatively large , i.e. , @xmath3 is close to @xmath76 , in which case the vectors are `` nearly orthogonal '' .",
    "they also presented a tighter lower bound , which considerably simplifies the analysis of bshouty  @xcite , who achieved the same tightening .",
    "a major application of packing is in obtaining improved bounds on the _ sample complexity _ in machine learning .",
    "this was studied by li  @xcite ( see also  @xcite ) , who presented an asymptotically tight bound on the sample complexity , in order to guarantee a small `` relative error . ''",
    "this problem has been revisited by har - peled and sharir  @xcite in the context of geometric set systems , where they referred to a sample of the above kind as a `` relative approximation '' ( discussed in appendix  [ app : compact_rep ] ) , and showed how to integrate it into an _ approximate range counting _ machinery , which is a central application in computational geometry .",
    "the packing number has also been used by welzl  @xcite in order to construct spanning trees of low crossing number ( see also  @xcite ) and by matouek  @xcite in order to obtain asymptotically tight bounds in geometric discrepancy .",
    "we discuss these applications in the context of the problem studied in this paper in section  [ sec : applications ] .",
    "[ [ our - result . ] ] our result .",
    "+ + + + + + + + + + +    in the sequel , we refine the bound in the packing lemma ( theorem  [ thm : packing ] ) so that it becomes sensitive to the length of the vectors @xmath52 , based on an appropriate refinement of the underlying primal shatter function .",
    "this refinement has several geometric realizations .",
    "our ultimate goal is to show that when the set system is `` shallow '' ( that is , the underlying vectors are short ) , the packing number becomes much smaller than the bound in theorem  [ thm : packing ] .",
    "nevertheless , we can not always enforce such an improvement , as in some settings the worst - case asymptotic bound on the packing number is @xmath77 even when the set system is shallow .",
    "we demonstrate such a scenario by considering dual set systems of axis - parallel rectangles and points in the plane , where one can have a large subcollection @xmath78 that is both @xmath3-separated and @xmath3-shallow . in this case",
    "@xmath79 , which is not any better than the `` standard '' bound ( stated in theorem  [ thm : packing ] ) obtained without the shallowness assumption .",
    "see figure  [ fig : rectangles ] and appendix  [ app : rectangles ] , where we give a more detailed description of this construction to the non - expert reader .",
    "therefore , in order to obtain an improvement on the packing number of shallow set systems , we may need further assumptions on the primal shatter function .",
    "such assumptions stem from the random sampling technique of clarkson and shor  @xcite , which we define as follows .",
    "let @xmath0 be our set system .",
    "we assume that for any sequence @xmath27 of @xmath10 indices , and for any parameter @xmath11 , the number of vectors in @xmath80 of length at most @xmath12 is only @xmath14 , where @xmath8 is the primal shatter dimension and @xmath16 is a real parameter .",
    ", as it does not seem to appear in natural set systems  see below . ]",
    "when @xmath81 we obtain @xmath82 vectors in total , in accordance with the assumption that the primal shatter dimension is @xmath8 , but the above bound is also sensitive to the length of the vectors as long as @xmath83 . from now on",
    ", we say that a primal shatter function of this kind has the _",
    "@xmath84 clarkson - shor property_.    let us now denote by @xmath85 the @xmath3-packing number of @xmath0 , where the vector length of each element in @xmath0 is at most @xmath12 , for some integer parameter @xmath86 . by these assumptions , we can assume , without loss of generality , that @xmath87 , as otherwise the distance between any two elements in @xmath0 must be strictly less than @xmath3 , in which case the packing is empty .",
    "we also assume that @xmath88 ( where @xmath40 is the vc - dim ) , as otherwise the bound on the packing number is a constant that depends on @xmath8 and @xmath40 by the packing lemma ( theorem  [ thm : packing ] ) .",
    "the choice of this threshold is justified in section  [ sec : analysis ] where we present the analysis and show our main result , which we state below :    [ thm : shallow_packing ] let @xmath22 be a set of indicator vectors , whose primal shatter function has a @xmath89 clarkson - shor property , and whose vc - dim is @xmath40 .",
    "let @xmath3 be an integer parameter between @xmath90 and @xmath91 , @xmath12 an integer parameter between @xmath90 and @xmath1 , and suppose that @xmath87 . then : @xmath92 where the constant of proportionality depends on @xmath8 .",
    "this problem has initially been addressed by the author in  @xcite as a major tool to obtain size - sensitive discrepancy bounds in set systems of this kind , where it has been shown @xmath93 .",
    "the analysis in  @xcite is a refinement over the technique of dudley  @xcite combined with the existence of small - size _ relative approximations _ ( see  @xcite and appendix  [ app : compact_rep ] for more details ) . in the current analysis",
    "we completely remove the extra @xmath94 factor appearing in the previous bound . in particular , when @xmath17 ( where we just have the original assumption on the primal shatter function ) or @xmath20 ( in which case each vector in @xmath0 has an arbitrary length ) , our bound matches the tight bound of haussler , and thus appears as a generalization of the packing lemma ( when replacing vc - dimension by primal shatter dimension ) .",
    "theorem  [ thm : shallow_packing ] implies smaller packing numbers for several natural geometric set systems under the shallowness assumption .",
    "these set systems are described in detail in section  [ sec : geom_settings ] .",
    "next , in section  [ sec : spanning_trees ] we present an application of theorem  [ thm : shallow_packing ] to `` spanning trees with low total conflict number '' , which is based on the machinery of welzl  @xcite to construct spanning trees of low crossing number ( see also  @xcite ) . here",
    "the tree spans @xmath0 ( representing , say , a set of regions defined over @xmath1 points in @xmath8-space ) , and the `` conflict number '' of an edge @xmath95 is the symmetric difference distance between @xmath96 and @xmath97 . based on this structure we introduce a general framework to efficiently compute various measures arising in geometric optimization ( e.g. , diameter , width , radius of the smallest enclosing ball , volume of the minimum bounding box , etc . ) in each region represented by @xmath0 , where the key idea is to keep the overall number of updates small ( given a spanning tree of the above kind ) .",
    "in section  [ sec : geom_disc ] we show an application in geometric discrepancy , where the goal is to obtain discrepancy bounds that are sensitive to the length of the vectors in @xmath0 . due to the bound in theorem  [ thm : shallow_packing ]",
    "we obtain an improvement over the one presented in  @xcite . in section  [ sec : conclusions ]",
    "we discuss the geometric interpretation of theorem  [ thm : shallow_packing ] to dual set systems .",
    "in particular , we draw the connection between shallow packings and _ shallow cuttings _  @xcite . beyond the geometric applications ,",
    "this paper is primarily an extension of haussler s technique  @xcite to shallow set systems .",
    "we note that whereas the analysis of dudley  @xcite is fairly simple and intuitive , the analysis of haussler  @xcite is much more intricate , and thus the initial effort in this study was to understand haussler s analysis , whose conclusions are summarized in appendix  [ app : haussler_proof ] .",
    "we are also aware of the simplification to haussler s proof by chazelle  @xcite , nevertheless , we had to use the observations made in  @xcite in order to proceed with our analysis .",
    "our main conclusion about the analysis in  @xcite is given in inequality  ( [ eq : packing_bound ] ) , which implies that the cardinality of a @xmath3-separated set @xmath0 is bounded ( up to a factor of @xmath98 ) by the expected number of vectors in the projection of @xmath0 onto a random sample of @xmath99 indices , where @xmath40 is the vc - dimension .",
    "although this simple observation is not explicitly stated in  @xcite , this relation is a key property used in our analysis .",
    "[ [ overview - of - hausslers - approach . ] ] overview of haussler s approach .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the sake of completeness , we repeat some of the details in the analysis of haussler  @xcite and use similar notation for ease of presentation .",
    "let @xmath22 be a collection of indicator vectors of bounded primal shatter dimension @xmath8 , and denote its vc - dimension by @xmath40 . by the discussion above , @xmath100 . from now on",
    "we assume that @xmath0 is @xmath3-separated , and thus a bound on @xmath101 is also a bound on the packing number of @xmath0 .",
    "the analysis in  @xcite exploits the method of `` conditional variance '' in order to conclude @xmath102 = o\\left(d \\log{d } \\operatorname{\\mathbf{exp}}_{i}\\left [ |\\v_{|_{i}}| \\right ] \\right ) , \\ ] ] where @xmath103 $ ] is the expected size of @xmath0 when projected onto a subset @xmath104 of @xmath105 indices chosen uniformly at random without replacements from @xmath106 $ ] , and @xmath107 we justify this choice in appendix  [ app : haussler_proof ] , as well as the facts that @xmath10 and @xmath27 consists of precisely @xmath105 indices .    for the sake of completeness",
    ", we review haussler approach in appendix  [ app : haussler_proof ] , and also emphasize some of the properties there , which are fundamental in our view .",
    "moreover , we refine haussler s analysis to include two natural extensions : _ ( i ) obtain a refined bound on @xmath108 $ ] : _ this extension is a direct consequence of inequality  ( [ eq : packing_bound ] ) . in the analysis of haussler",
    "@xmath108 $ ] is replaced by its upper bound @xmath109 , resulting from the fact that the primal shatter dimension of @xmath0 ( and thus of @xmath26 ) is @xmath8 , from which we obtain that _ for any _ choice of @xmath27 , @xmath110 , with a constant of proportionality that depends on @xmath8 , and thus the packing number is @xmath111 , as asserted in theorem  [ thm : packing].$ ] is just @xmath112 due to the sauer - shelah lemma .",
    "] however , in our analysis we would like to have a more subtle bound on the actual expected value of @xmath113 .",
    "in fact , the scenario imposed by our assumptions on the set system eventually yields a much smaller bound on the expectation of @xmath113 , and thus on @xmath101 .",
    "we review this in more detail below . _",
    "( ii ) relaxing the bound on @xmath31 .",
    "_ we show that inequality  ( [ eq : packing_bound ] ) is still applicable when the sample @xmath27 is slightly larger than the bound in  ( [ eq : bound_m ] ) , as a stand alone relation , this may result in a suboptimal bound on @xmath101 , however , this property will assist us to obtain local improvements over the bound on @xmath101 , eventually yielding the bound in theorem  [ thm : shallow_packing ] . specifically , in our analysis , described in section  [ sec : analysis ] , we proceed in iterations , where at the first iteration we obtain a preliminary bound on @xmath101 ( corollary  [ cor : v_1 ] ) , and then , at each subsequent iteration @xmath114 , we draw a sample @xmath115 of @xmath116 indices where @xmath117 @xmath31 is our choice in  ( [ eq : bound_m ] ) , and @xmath118 is the @xmath119th iterated logarithm function .",
    "then , by a straightforward generalization of haussler s analysis ( described in appendix  [ app : haussler_proof ] ) , we obtain , for each @xmath120 : @xmath121 .\\ ] ]    we note that since the bounds  ( [ eq : packing_bound])([eq : iter_bound_v ] ) involve a dependency on the vc - dimension @xmath40 , we will sometimes need to explicitly refer to this parameter in addition to the primal shatter dimension @xmath8 . nevertheless , throughout the analysis we exploit the relation @xmath122 , mentioned in section  [ sec : intro ] .",
    "[ [ overview - of - the - approach . ] ] overview of the approach .",
    "we next present the proof of theorem  [ thm : shallow_packing ] . in",
    "what follows , we assume that @xmath0 is @xmath3-separated .",
    "we first recall the assumption that the primal shatter function of @xmath0 has a @xmath89 clarkson - shor property , and that the length of each vector @xmath52 under the @xmath53 norm is most @xmath12 .",
    "this implies that @xmath0 consists of at most @xmath123 vectors .",
    "since the clarkson - shor property is hereditary , then this also applies to any projection of @xmath0 onto a subset of indices , implying that the bound on @xmath113 is at most @xmath14 , where @xmath27 is a subset of @xmath105 indices as above .",
    "however , due to our sampling scheme we expect that the length of each vector in @xmath80 should be much smaller than @xmath12 , ( e.g. , in expectation this value should not exceed @xmath124 ) , from which we may conclude that the actual bound on @xmath113 is smaller than the trivial bound @xmath14",
    ". ideally , we would like to show that this bound is @xmath125 , which matches our asymptotic bound in theorem  [ thm : shallow_packing ] ( recall that @xmath126 ) .",
    "however , this is likely to happen only in case where the length of each vector in @xmath80 does not exceed its expected value , or that there are only a few vectors whose length deviates from its expected value by far , whereas , in the worst case there might be many leftover `` long '' vectors in @xmath80 .",
    "nevertheless , our goal is to show that , with some carefulness one can proceed in iterations , where initially @xmath27 is a slightly larger sample , and then at each iteration we reduce its size , until eventually it becomes @xmath127 and we remain with only a few long vectors . at each such iteration @xmath80",
    "is a random structure that depends on the choice of @xmath27 and may thus contain long vectors , however , in expectation they will be scarce !",
    "specifically , we proceed over at most @xmath128 iterations , where we perform local improvements over the bound on @xmath101 , as follows .",
    "let @xmath129 be the bound on @xmath101 after the @xmath119th iteration is completed , @xmath130 .",
    "we first show in corollary  [ cor : v_1 ] that for the first iteration , @xmath131 , with a constant of proportionality that depends on @xmath8 .",
    "then , at each further iteration @xmath132 , we select a set @xmath115 of @xmath133 indices uniformly at random without replacements from @xmath106 $ ] ( see  ( [ eq : m_j ] ) for the bound on @xmath134 ) .",
    "our goal is to bound @xmath135 $ ] using the bound @xmath136 , obtained at the previous iteration , which , we assume by induction to be @xmath137 ( where the base case @xmath138 is shown in corollary  [ cor : v_1 ] ) .    a key property in the analysis is then to show that the probability that the length of a vector @xmath139 ( after the projection of @xmath0 onto @xmath115 ) deviates from its expectation decays exponentially ( lemma  [ lem : exp_decay ] ) .",
    "note that in our case this expectation is at most @xmath140 .",
    "this , in particular , enables us to claim that _ in expectation _ the overall majority of the vectors in @xmath141 have length at most @xmath142 , whereas the remaining longer vectors are scarce .",
    "specifically , since the clarkson - shor property is hereditary , we apply it to @xmath141 and conclude that the number of its vectors of length at most @xmath142 is only @xmath143 , with a constant of proportionality that depends on @xmath8 . on the other hand , due to lemma  [ lem : exp_decay ] and our inductive hypothesis , the number of longer vectors does not exceed @xmath144 , which is dominated by the first bound .",
    "we thus conclude @xmath135 = o\\left(\\frac{n^{d_1 } k^{d - d_1 } ( \\log^{(j)}{(n/\\delta)})^{d}}{\\delta^d } \\right)$ ] .",
    "then we apply inequality  ( [ eq : iter_bound_v ] ) in order to complete the inductive step , whence we obtain the bound on @xmath129 , and thus on @xmath101 .",
    "these properties are described more rigorously in lemma  [ lem : bound_projected ] , where derive a recursive inequality for @xmath129 using the bound on @xmath135 $ ] .",
    "we emphasize the fact that the sample @xmath115 is always chosen from the _ original _ ground set @xmath106 $ ] , and thus , at each iteration we construct a new sample _ from scratch _ , and then exploit our observation in  ( [ eq : iter_bound_v ] ) .      in order to show our bound on @xmath145",
    ", we form a subset @xmath146 of @xmath147 indices and our remark after corollary  [ cor : v_1 ] . therefore ,",
    "@xmath148 , rather than @xmath149 .",
    "furthermore , the constant of proportionality in the bound on @xmath150 depends just on the primal shatter dimension @xmath8 instead of the vc - dimension @xmath40 as in  ( [ eq : m_j ] ) . ] with the following two properties : ( i ) each vector in @xmath0 is mapped to a distinct vector in @xmath151 , and ( ii ) the length of each vector in @xmath151 does not exceed @xmath152 .    [",
    "lem : compact_rep ] a sample @xmath153 as above satisfies properties ( i)(ii ) , with probability at least @xmath154 .    a set @xmath153 as above exists by the considerations in  @xcite . nevertheless , in appendix  [ app : compact_rep ] we present the proof of lemma  [ lem : compact_rep ] for the sake of completeness and clarity .",
    "we next apply lemma  [ lem : compact_rep ] in order to bound @xmath155 .",
    "we first recall that the @xmath89 clarkson - shor property of the primal shatter function of @xmath0 is hereditary . incorporating the bound on @xmath150 and property ( ii ) ,",
    "we conclude that @xmath156 with a constant of proportionality that depends on @xmath8 .",
    "now , due to property ( i ) , @xmath157 , we thus conclude :    [ cor : v_1 ] after the first iteration we have : @xmath131 , with a constant of proportionality that depends on @xmath8 .",
    "* remark : * we note that the preliminary bound given in corollary  [ cor : v_1 ] is crucial for the analysis , as it constitutes the base for the iterative process described in section  [ sec : iter_process ] . in fact , this step of the analysis alone bypasses our refinement to haussler s approach , and instead exploits the approach of dudley  @xcite .",
    "let us now fix an iteration @xmath132 .",
    "as noted above , we assume by induction on @xmath119 that the bound @xmath136 on @xmath101 after the @xmath158th iteration is @xmath137 .",
    "let @xmath115 be a subset of @xmath116 indices , chosen uniformly at random without replacements from @xmath106 $ ] , with @xmath134 given by  ( [ eq : m_j ] ) .",
    "let @xmath52 , and denote by @xmath159 its projection onto @xmath115 .",
    "the expected length @xmath160 $ ] of @xmath159 is at most @xmath161 .",
    "we next show ( see appendix  [ app : exp_decay ] for the proof ) :    [ lem : exp_decay ] @xmath162 <   2^{-t k(m_j - 1)/n},\\ ] ] where @xmath163 is a real parameter and @xmath73 is the base of the natural logarithm .",
    "we now proceed as follows .",
    "recall that we assume @xmath164 , and by  ( [ eq : m_j ] ) we have @xmath165 .",
    "thus it follows from lemma  [ lem : exp_decay ] that @xmath166   <   \\frac{1 } { ( \\log^{(j-1)}{(n/\\delta ) } ) ^{d } } , \\ ] ] where @xmath167 is a sufficiently large constant , and @xmath168 is another constant whose choice depends on @xmath169 and @xmath40 , and can be made arbitrarily large . since @xmath170 we obviously have @xmath171 .",
    "we next show :    [ lem : bound_projected ] under the assumption that @xmath87 , we have , at any iteration @xmath132 : @xmath172 where @xmath173 is the bound on @xmath101 after the @xmath174th iteration , and @xmath175 is a constant that depends on @xmath8 ( and @xmath40 ) and the constant of proportionality determined by the clarkson - shor property of @xmath0 .",
    "we in fact show : @xmath176 \\le   a \\cdot \\frac{n^{d_1 } k^{d - d_1 } ( \\log^{(j)}{(n/\\delta)})^{d}}{\\delta^d } +     \\frac{|\\v|^{(j-1)}}{(\\log^{(j-1)}{(n/\\delta)})^{d } } , \\ ] ] and then exploit the relation @xmath177 $ ] ( inequality  ( [ eq : iter_bound_v ] ) ) , in order to prove  ( [ eq : recursion ] ) .    in order to obtain the first term in the bound on @xmath135 $ ]",
    ", we consider all vectors of length at most @xmath178 ( where @xmath167 is a sufficiently large constant as above ) in the projection of @xmath0 onto a subset @xmath115 of @xmath179 indices ( in this part of the analysis @xmath115 can be arbitrary ) . since the primal shatter function of @xmath0 has a @xmath89 clarkson - shor property , which is hereditary , we obtain at most @xmath180 vectors in @xmath141 of length smaller than @xmath181 .",
    "it is easy to verify that the constant of proportionality @xmath182 in the bound just obtained depends on @xmath8 , @xmath40 , and the constant of proportionality determined by the clarkson - shor property of @xmath0 .",
    "next , in order to obtain the second term , we consider the vectors @xmath52 that are mapped to vectors @xmath183 with @xmath184 . by inequality  ( [ eq : small_prob ] ) : @xmath185 <    \\frac{| \\v|}{(\\log^{(j-1)}{(n/\\delta)})^{d } } , \\ ] ] and recall that @xmath136 is the bound on @xmath101 after the previous iteration @xmath186 .",
    "this completes the proof of the lemma .",
    "* remark : * we note that the bound on @xmath135 $ ] consists of the _ worst - case _ bound on the number of short vectors of length at most @xmath187 , obtained by the clarkson - shor property , plus the _ expected _ number of long vectors .    [",
    "[ wrapping - up . ] ] wrapping up .",
    "we now complete the analysis and solve inequality  ( [ eq : recursion ] ) .",
    "our initial assumption that @xmath88 , and the fact that @xmath171 is sufficiently large , imply that the coefficient of the recursive term is smaller than @xmath90 , for any @xmath188 .",
    ", due to our assumption that @xmath88 , and the fact that @xmath189 .",
    "] then , using induction on @xmath119 , one can verify that the solution is @xmath190 for any @xmath188 .",
    "we thus conclude @xmath191 . in particular , at the termination of the last iteration @xmath192",
    ", we obtain : @xmath193 with a constant of proportionality that depends on @xmath8 ( and @xmath40 ) .",
    "this at last completes the proof of theorem  [ thm : shallow_packing ] .",
    "we now incorporate the random sampling technique of clarkson and shor  @xcite with theorem  [ thm : shallow_packing ] in order to conclude that small shallow packings exist in several useful scenarios .",
    "this includes the case where @xmath0 represents : ( i ) a collection of halfspaces defined over an @xmath1-point set in @xmath8-space . in this case , for any integer parameter @xmath194 , the number of halfspaces that contain at most @xmath12 points is @xmath195 , and thus the primal shatter function has a @xmath196 clarkson - shor property .",
    "( ii ) a collection of balls defined over an @xmath1-point set in @xmath8-space . here",
    ", the number of balls that contain at most @xmath12 points is @xmath197 , and therefore the primal shatter function has a @xmath198 clarkson - shor property .",
    "( iii ) a collection of _ parallel slabs _ ( that is , each of these regions is enclosed between two parallel hyperplanes and has an arbitrary width ) , defined over an @xmath1-point set in @xmath8-space .",
    "the number of slabs , which contains at most @xmath12 points is @xmath199 .",
    "( iv ) a dual set system of points in @xmath8-space and a collection @xmath200 of @xmath1 @xmath201-variate ( not necessarily continuous or totally defined ) functions of _ constant description complexity_. specifically , the graph of each function is a semi - algebraic set in @xmath44 defined by a constant number of polynomial equalities and inequalities of constant maximum degree ( see  ( * ? ? ?",
    "* chapter 7 ) for a detailed description of these properties , which we omit here ) . has a constant description complexity . ] in this case , @xmath0 is represented by the cells ( of all dimensions ) in the _ arrangement _ of the graphs of the functions in @xmath200 ( see section  [ sec : intro ] for the definition ) that lie below at most @xmath12 function graphs .",
    "this portion of the arrangement is also referred to as the _ at most @xmath12-level _ , and its combinatorial complexity is @xmath202 , for any @xmath203 , where the constant of proportionality depends on @xmath8 and @xmath204 . thus the primal shatter function has a @xmath205 clarkson - shor property .",
    "all bounds presented in ( i)(iv ) are well known in the field of computational geometry ; we refer the reader to  @xcite for further details .",
    "we thus conclude :    [ cor : halfspaces ] let @xmath22 be a set of indicator vectors representing a set system of halfspaces defined over an @xmath1-point set in @xmath8-space , and let @xmath206 be two integer parameters as in theorem  [ thm : shallow_packing ] .",
    "then : @xmath207 where the constant of proportionality depends on @xmath8 .",
    "[ cor : balls ] let @xmath22 be a set of indicator vectors representing a set system of balls defined over an @xmath1-point set in @xmath8-space , and let @xmath206 be two integer parameters as in theorem  [ thm : shallow_packing ] . then : @xmath208 where the constant of proportionality depends on @xmath8 .",
    "[ cor : slabs ] let @xmath22 be a set of indicator vectors representing a set system of parallel slabs defined over an @xmath1-point set in @xmath8-space , and let @xmath206 be two integer parameters as in theorem  [ thm : shallow_packing ] . then : @xmath209 where the constant of proportionality depends on @xmath8 .",
    "[ cor : dual ] let @xmath22 be a set of indicator vectors representing a dual set system of @xmath1 @xmath201-variate ( not necessarily continuous or totally defined ) functions of constant description complexity and points in @xmath8-space .",
    "let @xmath206 be two integer parameters as in theorem  [ thm : shallow_packing ] . then : @xmath210 where the constant of proportionality depends on @xmath8 and on @xmath204 .",
    "suppose we are given a set @xmath2 of @xmath1 points in @xmath8-space and a set @xmath211 of @xmath31 regions defined over @xmath2 . with a slight abuse of notation",
    ", we also refer to @xmath211 as the corresponding set system defined over @xmath2 .",
    "has the role @xmath0 in our original notation .",
    "] we now assume that the set system @xmath212 is shallow and has a @xmath84 clarkson - shor property .",
    "the question at hand is to construct a spanning tree over @xmath211 , whose overall _ conflict number _ is small .",
    "this notion is related to _ spanning trees with low crossing number _ , defined by welzl  @xcite ( see also  @xcite ) , where the tree spans @xmath2 ( rather than @xmath211 ) , in which case it has a geometric realization , where the edges of the tree are the line segments connecting points of @xmath2 .",
    "our structure is dual to that of welzl  @xcite and defined as follows .",
    "let @xmath213 be a graph with vertex set @xmath211 .",
    "we say that a point @xmath214 _ conflicts _ with an edge @xmath215 if @xmath216 .",
    "we then define the _ conflict number _ of an edge @xmath73 of @xmath217 as the number of points @xmath214 with which it is in conflict , and then the total conflict number of @xmath217 is the sum of the conflict numbers , over all its edges . using similar arguments as in  ( * ? ? ?",
    "* lemma 5.18 ) and  @xcite , one can show ( we omit the easy proof ) :    [ lem : tree ] let @xmath211 be a set system of @xmath31 sets , defined over an @xmath1-point set @xmath2 .",
    "assume @xmath211 has a @xmath84 clarkson - shor property , and that @xmath218 , for each @xmath219 , where @xmath86 is an integer parameter .",
    "then there exists a spanning tree @xmath220 over @xmath211 , whose total conflict number is @xmath221 .    [",
    "[ constructing - an - approximation - of - the - tree . ] ] constructing an approximation of the tree .    in order to construct @xmath220 efficiently , we relax this problem to only _ approximating _ the spanning tree , and then use the machinery of har - peled and indyk  @xcite in order to conclude that when @xmath211 is a set system as in corollaries  [ cor : halfspaces][cor : slabs ] , a @xmath222-factor approximation for @xmath220 ( that is , a spanning tree whose total conflict number is at most @xmath222 of the smallest such number ) can be computed in subquadratic time , for any @xmath223 .",
    "we present a sketch of this construction in appendix  [ app : approx_mst ] , and conclude :    [ cor : approx_mst ] let @xmath2 be a set of @xmath1 points in @xmath8-space and let @xmath211 be a set of @xmath31 regions defined over @xmath2 .",
    "then , for any @xmath223 , one can compute in time    ( i )  @xmath224 a spanning tree of @xmath211 , where @xmath211 is a set of halfspaces in @xmath8-space , with overall @xmath225 conflicts .",
    "( ii )  @xmath226 , a spanning tree as above , where @xmath211 is a set of balls in @xmath8-space , with overall @xmath227 conflicts .",
    "( iii )  @xmath228 , a spanning tree as above , where @xmath211 is a set of parallel slabs in @xmath8-space , with overall @xmath229 conflicts . in the above bounds @xmath230 hides a poly - logarithmic factor .    based on the above machinery",
    ", we next propose a general framework for updating the optimal solution ( or an approximate solution ) of a prescribed geometric optimization problem , over all regions in @xmath211 .",
    "[ [ a - general - framework . ] ] a general framework .",
    "let @xmath2 , @xmath211 be as in lemma  [ lem : tree ] , and let @xmath231 be a function that assigns real values on the sets @xmath219 ( each being a subset of @xmath2 ) .",
    "for example , @xmath232 may correspond to diameter , width , radius of the smallest enclosing ball , volume of the minimum bounding box , etc .",
    ", see , e.g. ,  @xcite , where these measures are referred to as `` faithful measures '' .",
    "our goal is to efficiently compute @xmath233 for each @xmath219 .",
    "specifically , we assume to have a data - structure @xmath234 that maintains a subset @xmath235 with the following properties : ( i ) the time to preprocess @xmath234 is @xmath236 .",
    "( ii ) the time to update @xmath234 ( that is , inserting or deleting an element from @xmath234 ) is @xmath237 . (",
    "iii ) at any given time , querying @xmath234 for the value of @xmath232 , w.r.t .",
    "the set @xmath238 of the currently stored points , costs @xmath239 time . having this machinery at hand , in a brute - force approach",
    ", @xmath234 is initially empty .",
    "then , for each @xmath219 , we insert its elements into @xmath234 , obtain @xmath233 by querying @xmath234 , and then remove all these elements from @xmath234 .",
    "we proceed in this manner until all sets @xmath219 are exhausted . under the assumption that @xmath211 is @xmath12-shallow , the resulting running time is @xmath240 . on the other hand , with the existence of a @xmath222-factor approximation for the spanning tree @xmath220 ( with properties as in lemma  [ lem : tree ] )",
    ", we can proceed as follows . with a slight abuse of notation",
    ", we also denote the approximate tree by @xmath220 .",
    "initially , @xmath234 is empty as above , and we choose an arbitrary set @xmath219 , for which we compute @xmath233 as above .",
    "then we traverse @xmath220 from @xmath241 in a bfs manner , update @xmath234 accordingly , and make a query at each vertex tracked during the search . clearly , the number of these updates is proportional to the overall number of conflicts in @xmath220 , and thus the overall running time is @xmath242 , where @xmath243 is the time to construct ( a @xmath222-factor approximation for ) @xmath220 .",
    "we are interested in the scenario where this solution outperforms the brute - force algorithm ( at least for some values of @xmath12 ) .",
    "below we describe a concrete scenario , related to the approximation of the faithful measures listed above , which demonstrates the usefulness of our framework .",
    "[ [ dynamic - coresets . ] ] dynamic coresets .    based on the seminal work of agarwal  .",
    "@xcite on _ coresets _ , chan  @xcite presented a data structure , which maintains a constant - size coreset , with respect to `` extent '' , in @xmath244 update time , for all constant dimensions , with linear space and preprocessing time , where the constant of proportionality depends on the error parameter @xmath203 . using this machinery , it is straightforward to obtain dynamic @xmath245-factor approximation algorithms with logarithmic update time for computing the faithful measures stated above .",
    "the time @xmath246 to compute an approximation for these measures depends on @xmath204 and the dimension @xmath8 . for simplicity of presentation",
    ", we omit the dependency on @xmath204 in the bounds of @xmath237 , @xmath246 , and compare the performance of our approach w.r.t .",
    "the brute force computation , when we consider only the parameters @xmath1 , @xmath31 , and @xmath12 .    with this machinery ,",
    "the brute - force algorithm runs in @xmath247 time , whereas our algorithm runs in @xmath248 time .",
    "we now consider the bounds stated in corollary  [ cor : approx_mst ] and set @xmath249 , in which case the term @xmath250 becomes nearly - linear and we pay only an extra logarithmic factor in the total number of conflicts .",
    "we then conclude :    [ cor : compute_measure ] let @xmath2 be a set of @xmath1 points in @xmath8-space and a let @xmath211 be a set of @xmath31 regions defined over @xmath2 , where , for each @xmath219 , @xmath218 , where @xmath86 is an integer parameter",
    ". then one can compute a @xmath245-factor approximation for the aforementioned faithful measures in time that is the minimum of @xmath247 and    ( i )  @xmath251 , if @xmath211 is a collection of halfspaces , in @xmath8-space .",
    "( ii )  @xmath252 , if @xmath211 is a collection of balls in @xmath8-space .",
    "( iii )  @xmath253 , if @xmath211 is a collection of parallel slabs in @xmath8-space .",
    "the constant of proportionality in each of these bounds depends on @xmath204 and @xmath8 .",
    "given a set system @xmath254 as above , we now wish to color the points of @xmath2 by two colors , such that in each set of @xmath211 the deviation from an even split is as small as possible .",
    "formally , a _ two - coloring _ of @xmath2 is a mapping @xmath255 . for a set @xmath219 we define @xmath256 .",
    "the _ discrepancy _ of @xmath211 is then defined as @xmath257 . in a previous work",
    "@xcite , the author presented size - sensitive discrepancy bounds for set systems of halfspaces defined over @xmath1 points in @xmath8-space .",
    "these bounds were achieved by combining the _ entropy method _",
    "@xcite with @xmath3-packings , and , as observed in  @xcite , they are optimal up to a poly - logarithmic factor . incorporating our bound in theorem  [ thm : shallow_packing ] into the analysis in  @xcite , the bounds on @xmath258 improve by a @xmath259 factor .",
    "specifically , we obtain ( we omit the technical details in this version ) :    [ cor : disc_halfspaces ] let @xmath211 be a set system of halfspaces defined over @xmath1-points in @xmath8-space ( @xmath260 ) .",
    "then , there is a two - coloring @xmath261 , such that for each @xmath219 , @xmath262 , for @xmath263 even , and @xmath264 , for @xmath265 odd , where the constant of proportionality depends on @xmath8 .",
    "when @xmath266 the bound on @xmath258 is @xmath267 . in corollary  [ cor : disc_halfspaces ] has been resolved by har - peled and sharir  @xcite . ]",
    "we note that corollary  [ cor : dual ] implies that one can pack the `` shallow level '' in an arrangement of @xmath201-variate function graphs @xmath200 ( as defined in section  [ sec : geom_settings ] ) with a relatively small number of hamming balls .",
    "in fact , if those functions are just hyperplanes , then by a standard point - hyperplane duality , corollary  [ cor : halfspaces ] implies that the number of hamming balls that pack the at most @xmath12-level in the underlying arrangement is @xmath268 . roughly speaking",
    ", this particular bound can be obtained by either ( i ) _ shallow cuttings _",
    "@xcite and a standard reduction between packing and covering . roughly speaking ,",
    "this is a coverage of the shallow level of the arrangement by a collection @xmath269 of ( possibly unbounded ) pairwise - disjoint `` primitive '' cells , such that the interior of each cell is crossed by a small fraction of the function graphs in @xmath200 .",
    "when @xmath200 is a collection of hyperplanes the packing number and the bound on @xmath270 are asymptotically the same ( where each cell of @xmath269 corresponds to a `` center '' of a hamming ball ) . or",
    "( ii ) the bound @xmath271 on the `` volume '' of a hamming ball of radius @xmath3 ( as observed in  @xcite ) and the fact that the complexity of the at most @xmath12-level in an arrangement of @xmath1 hyperplanes is @xmath195  @xcite .",
    "nevertheless , these approaches may not be applicable when the input functions are more general ( e.g. , satisfy the properties stated in section  [ sec : geom_settings ] for , say , @xmath263 ) , in this case one may use _ linearization _ but that may result in an overestimated bound .",
    "we hope our bound on the packing number will be useful in geometric computing , and , in particular in the context of spanning trees of low ( total ) crossing number . the analogy between shallow packings for dual set systems and shallow cuttings may cause one to interpret shallow packings as the `` primal version '' of shallow cuttings . in this paper",
    "we named two useful applications for shallow packings .",
    "we hope to find additional applications in geometry and beyond .",
    "[ [ acknowledgments . ] ] acknowledgments .",
    "the authors wishes to thank boris aronov , sariel har - peled , aryeh kontorovich , and wolfgang mulzer for useful discussions and suggestions .",
    "in particular , the author is grateful to sariel har - peled for suggesting the application described in section  [ sec : spanning_trees ] .",
    "last but not least , the author deeply thanks ramon van handel , for various discussions and for spotting an error in an earlier version of this paper . in particular , work on this paper began due to a discussion with ramon after a talk the author gave in princeton university .",
    "50    p.  k.  agarwal , a.  efrat , and m.  sharir . vertical decomposition of shallow levels in 3-dimensional arrangements and its applications .",
    "_ siam j. comput .",
    "_ , 29(2000):912953 .",
    "p.  k. agarwal and j.  erickson .",
    "geometric range searching and its relatives .",
    "( 1997 ) .",
    "k. agarwal , s.  har - peled , and k.  r. varadarajan . approximating extent measures of ppoints .",
    "_ j. acm _ , 51(4):606635 ( 2004 ) .",
    "n.  alon and j.  h. spencer . .",
    "@xmath272 edition , wiley - interscience , new york , usa , 2000 .",
    "a.  auger and b.  doerr .",
    "_ theory of randomized search heuristics : foundations and recent developments _ , world scientific publishing , 2011 .",
    "n.  h.  bshouty , y.  li , and p.  m.  long . using the doubling dimension to analyze the generalization of learning algorithms .",
    "_ j. comput .",
    "system sci .",
    "_ , 75(6):323335 ( 2009 ) .    t.  m.  chan",
    ". dynamic coresets .",
    "_ discrete comput .",
    "_ , 42 : 469488 ( 2009 ) .",
    "b.  chazelle . a note on haussler s packing lemma .",
    "unpublished manuscript , princeton ( 1992 ) .",
    "b.  chazelle and e.  welzl .",
    "quasi - optimal range searching in spaces of finite vc - dimension .",
    "_ discrete comput .",
    "geom . _ , 4:467489 ( 1989 )",
    ".    k.  l. clarkson and p.  w. shor .",
    "applications of random sampling in computational geometry , ii .",
    "_ discrete comput .",
    "_ , 4:387421 ( 1989 ) .",
    "r.  m.  dudley .",
    "central limit theorems for empirical measures .",
    "_ , 6(6):8991049 ( 1978 ) .",
    "d.  eppstein .",
    "dynamic euclidean minimum spanning trees and extrema of binary functions .",
    "_ discrete comput . geom .",
    "_ , 13:111122 ( 1995 ) .",
    "e.  ezra .",
    "a size - sensitive discrepancy bound for set systems of bounded primal shatter dimension . in _ proc .",
    "twenty - fifth annu .",
    "acm - siam sympos .",
    "discrete algorithms _ , pages 13781388 ( 2014 ) .",
    "l.  gottlieb , a.  kontorovich , and e.  mossel .",
    "vc bounds on the cardinality of nearly orthogonal function classes . , 312(10):17661775 ( 2012 ) .",
    "s.  har - peled .",
    "_ geometric approximation algorithms _",
    ", mathematical surveys and monographs , vol . 173",
    "( 2011 ) .",
    "s.  har - peled and p.  indyk .",
    "when crossings count - approximating the minimum spanning tree . in _ proc .",
    "16th annu .",
    "acm sympos .",
    "geom _ , pp .",
    "166175 ( 2002 ) .",
    "s.  har - peled and m.  sharir , relative @xmath273-approximations in geometry , _ discrete comput .",
    "_ , 45(3):462496 ( 2011 ) .",
    "d.  haussler .",
    "decision theoretic generalizations of the pac model for neural net and other learning applications . in _",
    "information and computation _ , 100(1):78150 ( 1992 ) .",
    "d.  haussler .",
    "sphere packing numbers for subsets of the boolean @xmath1-cube with bounded vapnik - chervonenkis dimension .",
    "_ j. combinatorial theory ser .",
    "a _ , 69:217232 ( 1995 ) .",
    "d.  haussler , n.  littlestone , m.  k.  warmuth .",
    "predicting @xmath274-functions on randomly drawn points . _ information and computation _ , 115(2 ) , 248292 ( 1994 ) .",
    "d.  haussler and e.  welzl .",
    "@xmath275-nets and simplex range queries .",
    "_ discrete comput .",
    "_ , 2:127151 ( 1987 ) .",
    "p.  indyk and r.  motwani .",
    "approximate nearest neighbors : towards removing the curse of dimensionality . in _ proc .",
    "30th annu .",
    "acm sympos .",
    "theory comput .",
    "_ , pp . 604613 ( 1998 ) .",
    "y.  li , p.  m. long , and a.  srinivasan .",
    "improved bounds on the sample complexity of learning . , 62(3):516527 ( 2001 ) .",
    "s.  lovett and r.  meka",
    ". constructive discrepancy minimization by walking on the edges . in _ proc .",
    "53th annu .",
    "ieee symp . found .",
    "_ , 6167 , ( 2012 ) .",
    "e.  kushilevitz , r.  ostrovsky , and y.  rabani .",
    "efficient search for approximate nearest neighbor in high dimensional spaces .",
    "_ siam j. comput .",
    "_ , 2(30):457474 ( 2000 ) .",
    "j.  matouek , , springer - verlag new york ( 2002 ) .",
    "j.  matouek .",
    "reporting points in halfspaces .",
    "theory appl .",
    "_ , 2:169186 ( 1992 ) .",
    "j.  matouek .",
    "tight upper bounds for the discrepancy of halfspaces . _ discrete comput .",
    "_ , 13:593601 ( 1995 ) .",
    "j.  matouek .",
    "_ geometric discrepancy _ , algorithms and combinatorics , vol .",
    "18 , springer verlag , heidelberg ( 1999 ) .",
    "w.  mulzer .",
    "chernoff bounds , _ personal note_. `` .",
    "a.  panconesi and a.  srinivasan .",
    "randomized distributed edge coloring via an extension of the chernoff - hoeffding bounds .",
    "_ siam j. comput . _ , 26:350368 ( 1997 ) .",
    "d.  pollard .",
    "_ convergence of stochastic processes _ , springer - verlag ( 1984 ) .    n.  sauer . on the density of families of sets .",
    "_ j. combin .",
    "theory , ser a _ , 13(1 ) : 145147 ( 1972 ) .",
    "m. sharir and p. k. agarwal .",
    "_ davenport - schinzel sequences and their geometric applications_. cambridge university press , new york ( 1995 ) .",
    "s.  shelah . a combinatorial problem , stability and order for models and theories in infinitary languages . _ pacific j. math .",
    "_ , 41:247261 ( 1972 ) .",
    "v.  vapnik and a.  chervonenkis . on the uniform convergence of relative frequencies of events to their probabilities .",
    "_ theory prob",
    "_ , 16(2):264280 ( 1971 ) .",
    "e.  welzl . on spanning trees with low crossing numbers .",
    "in _ data structures and efficient algorithms , final report on the dfg special joint initiative _ , volume 594 of _ lect .",
    "notes in comp .",
    "springer - verlag , heidelberg , pp .",
    "233249 ( 1992 ) .",
    "continuing our construction from section  [ sec : intro ] , the ground set is a collection of axis - parallel rectangles , and the vectors @xmath0 represent subsets of rectangles that cover a point in the plane . for simplicity of exposition",
    ", we define these vectors to represent all two - dimensional cells in the arrangement of the given rectangles .",
    "it is well known that the primal shatter function of @xmath0 is quadratic ( see , e.g. ,  @xcite ) , and therefore , by theorem  [ thm : packing ] , the packing number is @xmath276 .",
    "nevertheless , we claim that even when the arrangement is shallow , the asymptotic bound on the packing number is not any better than @xmath277 .",
    "indeed , fix a positive even parameter @xmath6 , and suppose , without loss of generality , that @xmath278 is an integer number .",
    "consider now an @xmath279 grid of long and skinny rectangles , where each rectangle in the grid is duplicated @xmath280 times ( with a possibly infinitesimal perturbation ) , as illustrated in figure  [ fig : rectangles ] . clearly ,",
    "each ( two - dimensional ) cell in the arrangement is covered by at most @xmath3 rectangles , and thus the set system is @xmath3-shallow .",
    "consider now only the cells at `` depth '' @xmath3 ( that is , they are covered by precisely @xmath3 rectangles ) , and let @xmath281 be the set of their representative vectors .",
    "it is easy to verify that , for each pair @xmath282 , the distance @xmath283 is at least @xmath3 ( see once again figure  [ fig : rectangles ] ) , and thus @xmath78 is both @xmath3-separated and @xmath3-shallow .",
    "however , by construction , we have @xmath79 , and thus the @xmath3-shallowness assumption does not yield an improvement over the general case .",
    "let @xmath22 be a collection of indicator vectors of primal shatter dimension @xmath8 .",
    "we denote its vc - dimension by @xmath40 ; as discussed in section  [ sec : intro ] @xmath100 .",
    "we first form a probability distribution @xmath284 over @xmath0 , implying that @xmath0 can be viewed is an arbitrary distribution , but later on ( lemma  [ lem : expected_var1 ] ) it is taken to be the uniform distribution in the obvious way , where each vector in @xmath0 is equally likely to be chosen .",
    "this distribution , however , may not remain uniform after the projection of @xmath0 onto a proper subsequence @xmath285 of @xmath286 indices , as several vectors in @xmath0 may be projected onto the same vector in @xmath287 . ] as an @xmath1-dimensional random variable taking values in @xmath288 .",
    "thus its components @xmath289 , @xmath58 , represent @xmath1 correlated indicator random variables ( bernulli random variables ) , and each of their values is determined by randomly selecting a vector @xmath52 , and letting @xmath289 be the @xmath56th component of @xmath57 .",
    "the variance of a bernulli random variable @xmath290 is known to be @xmath291 \\operatorname{\\mathbf{prob}}[b=0]$ ] , and then , for a sequence @xmath292 of bernulli random variables , the _ conditional variance _ of @xmath293 given @xmath294 is defined as @xmath295 where @xmath296 , and @xmath297 .    a key property in the analysis of haussler  @xcite lies in the density of a _ unit distance graph _ @xmath298 , defined over @xmath0 , whose edges correspond to all pairs @xmath60 , whose symmetric difference distance is ( precisely ) @xmath90 . in other words , @xmath63 , @xmath57 appear as neighbors on the unit cube @xmath288 .",
    "it has been shown by haussler  @xcite that the density of @xmath217 is bounded by the vc - dimension of @xmath0 , that is , @xmath299 ; see also  @xcite for an alternative proof using the technique of `` shifting . ''",
    "is replaced by the primal shatter dimension @xmath8 , and therefore we proceed with the analysis using this ratio . ]",
    "then , this low density property is exploited in order to show that once we have chosen @xmath300 coordinates of the random variable @xmath0 , the variance in the choice of the remaining coordinate is relatively small .",
    "that is :    [ lem : sum_variance ] for any distribution @xmath284 on @xmath0 , @xmath301    as observed in @xcite , lemma  [ lem : sum_variance ] continues to hold on any restriction of @xmath0 to a sequence @xmath302 of @xmath10 indices . indeed , when projecting @xmath0 onto @xmath303 the vc - dimension in the resulting set system remains @xmath40 .",
    "furthermore , the conditional variance is now defined w.r.t . the induced probability distribution on @xmath287 in the obvious way , where the probability to obtain a sequence of @xmath31 values corresponds to an appropriate marginal distribution , that is , @xmath304 .",
    "with this observation , we can rewrite the inequality stated in lemma  [ lem : sum_variance ] as @xmath305 if @xmath303 is a sequence chosen uniformly at random ( over all such @xmath31-tuples ) , then when averaging over all choices of @xmath303 we clearly obtain : @xmath306 \\le d_0 , \\ ] ] or @xmath307 \\le d_0 , \\ ] ] by linearity of expectation .",
    "in fact , by symmetry of the random variables @xmath308 ( recall that @xmath303 is a random @xmath31-tuple ) each of the summands in the above inequality has an equal contribution , and thus , in particular ( recall once again that the expectation is taken over all choices of @xmath309 ) : @xmath310 \\le \\frac{d_0}{m } , \\ ] ] where we write @xmath311 $ ] to emphasize the fact that the expectation is taken over all choices of @xmath303 .",
    "the above bound is now integrated with the next key property :    [ lem : expected_var1 ] let @xmath0 be @xmath3-separated subset of @xmath288 , for some @xmath68 integer , and form a uniform distribution @xmath284 on @xmath0 .",
    "let @xmath312 be a sequence of @xmath105 distinct indices between @xmath90 and @xmath1 , where @xmath31 is any integer between @xmath90 and @xmath1 .",
    "suppose now that another index @xmath313 is drawn uniformly at random from the remaining @xmath314 indices .",
    "then @xmath315 \\ge    \\frac{\\delta}{2(n - m+1 ) } \\left(1 - \\frac { |\\v_{|_{i}}| } { |\\v| } \\right ) , \\ ] ] where the conditional variance is taken w.r.t .",
    "the distribution @xmath284 , and the expectation is taken w.r.t .",
    "the random choice of @xmath313 .",
    "we now observe that when the entire sequence @xmath285 is chosen uniformly at random , then the bound in lemma  [ lem : expected_var1 ] continues to hold when averaging on the entire sequence @xmath303 ( rather than just on @xmath313 ) , that is , we have : @xmath316 \\ge    \\operatorname{\\mathbf{exp}}_{i ' } \\left[\\frac{\\delta}{2(n - m+1 ) } \\left(1 - \\frac { |\\v_{|_{i}}| } { |\\v| } \\right)\\right]\\ ] ] @xmath317 } { |\\v| } \\right ) .\\ ] ] note that under this formulation , @xmath113 ( the number of sets in the projection of @xmath0 onto @xmath27 ) is a random variable that depends on the choice of @xmath312 , in particular , since it does not depend on the choice of @xmath313 , we have @xmath318 = \\operatorname{\\mathbf{exp}}_{i } [ |\\v_{|_{i}}| ] $ ] .    the analysis of haussler  @xcite then proceeds as follows .",
    "we assume that @xmath0 is @xmath3-separated as in lemma  [ lem : expected_var1 ] ( then a bound on @xmath101 is the actual bound on the packing number ) , and then choose @xmath319 indices @xmath320 uniformly at random without replacements from @xmath106 $ ] ( without loss of generality , we can assume that @xmath321 as , otherwise , we set the bound on the packing to be @xmath123 , as asserted by the @xmath89 clarkson - shor property of @xmath0 .",
    "moreover , we can assume , without loss of generality , @xmath322 , and thus we have @xmath10 ) .",
    "put @xmath323 , @xmath324 .",
    "then the analysis in  @xcite combines the two bounds in inequalities  ( [ eq : cond_var ] ) and  ( [ eq : expected_var2 ] ) in order to derive an upper bound on @xmath101 , from which the bound in the packing lemma ( theorem  [ thm : packing ] ) is obtained .",
    "specifically , using simple algebraic manipulations , we obtain : @xmath325}{1 - \\frac{2d_0(n - m+1)}{m\\delta } } \\ ] ] it has been shown in  @xcite that due to our choice of @xmath31 , we have : @xmath326 from which we obtain inequality  ( [ eq : packing_bound ] ) , as asserted .",
    "this completes the description of our first extension of haussler s analysis , as described in section  [ sec : prelim ] .    in order to apply our second extension , we observe that one only needs to assume @xmath10 when obtaining inequalities  ( [ eq : cond_var ] ) and  ( [ eq : expected_var2 ] ) .",
    "in addition , the choice of @xmath31 in inequality  ( [ eq : bound_v_by_expectation ] ) can be made slightly larger , since the term @xmath327 in inequality  ( [ eq : ratio ] ) is a decreasing function of @xmath31 , as can easily be verified .",
    "recall that in our analysis we replace @xmath31 by @xmath328 , where @xmath329 , in which case we still obtain @xmath177 $ ] , where @xmath115 is a set of @xmath179 indices chosen uniformly at random without replacements from @xmath106 $ ] .",
    "our proof relies on the notions of `` relative approximations '' and `` @xmath204-nets '' , define below :    [ [ relative - approximations - and - eps - nets . ] ] relative approximations and @xmath204-nets .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we mentioned in the introduction the notion of _ relative @xmath330-approximations_. we now define them formally : following the definition from  @xcite , given a set system @xmath22 and two parameters , @xmath331 and @xmath332 , we say that a subsequence @xmath27 of indices is a _ relative @xmath330-approximation _ if it satisfies , for each vector @xmath52 , @xmath333 @xmath334 where @xmath335 is the projection of @xmath52 onto @xmath27 .",
    "as observed by har - peled and sharir  @xcite , the analysis of li  @xcite implies that if @xmath0 has primal shatter dimension @xmath8 , then a random sample of @xmath336 indices ( each of which is drawn independently ) is a relative @xmath337-approximation for @xmath0 with constant probability , where @xmath338 is an absolute constant .",
    "more specifically , success with probability at least @xmath339 is guaranteed if one samples @xmath340 indices .",
    "is the vc - dimension , this assumption can be replaced by having just a primal shatter dimension @xmath8 ; see , e.g. ,  @xcite for the details of the analysis . ]",
    "it was also observed in  @xcite that _",
    "@xmath204-nets _ arise as a special case of relative @xmath337-approximations .",
    "specifically , an @xmath204-net is a subsequence of indices @xmath27 with the property that any vector @xmath52 with @xmath341 satisfies @xmath342 . in other words",
    ", @xmath343 is a hitting set for all the `` long '' vectors . in this case , if we set @xmath344 to be some constant fraction , say , @xmath345 , then a relative @xmath346-approximation becomes an @xmath204-net .",
    "moreover , a random sample of @xmath347 indices ( with an appropriate choice of the constant of proportionality ) is an @xmath204-net for @xmath0 , with probability at least @xmath339 ; see  @xcite for further details .",
    "[ [ proof - of - lemmalemcompact_rep . ] ] proof of lemma  [ lem : compact_rep ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in order to show ( i ) , we first form the set system corresponding to all symmetric difference pairs induced by @xmath0 .",
    "that is , we form the vector set @xmath234 , where @xmath348 . since we assume that @xmath0 is @xmath3-separated , we have @xmath349 , for each @xmath350 .",
    "we now construct an _",
    "@xmath204-net _ for @xmath234 , with @xmath351 . by our discussion above a sample @xmath153 of @xmath352 indices has this property with probability greater than , say , @xmath353 ( for a sufficiently large constant of proportionality ) .",
    "thus , by definition , any vector @xmath350 ( recall that its length is at least @xmath3 ) must satisfy @xmath354 , where @xmath355 denotes the projection of @xmath356 onto @xmath153 .",
    "but this implies that we must have @xmath357 , for each pair @xmath60 , and thus @xmath63 , @xmath57 must be mapped to distinct vectors in the projection of @xmath0 onto @xmath153 , from which property ( i ) follows . in order to have property ( ii )",
    "we observe that the same sample @xmath153 is also a _ relative @xmath358-approximation _ for @xmath0 with probability at least @xmath353 ( for an appropriate choice of the constant of proportionality ) .",
    "given this property of @xmath153 , this implies that any vector @xmath52 satisfies @xmath359 if @xmath360 , and @xmath361 otherwise .",
    "since @xmath362 , and @xmath87 by assumption , it is easy to verify that we always have @xmath363 . in other words , @xmath364 , as asserted .    combining the two roles of @xmath153 ( each with probability @xmath353 ) , it follows that it is both a @xmath365-net for @xmath234 and a relative @xmath358-approximation for @xmath0 , with probability at least @xmath154 , and thus it satisfies properties ( i)(ii ) with this probability .",
    "this completes the proof of the lemma . @xmath366",
    "we first observe that the length of @xmath159 is a random variable with a hypergeometric distribution . indeed , this is precisely the question of uniformly choosing @xmath116 elements at random ( into our set @xmath115 ) from a given set of @xmath1 elements without replacements , and then , for a given @xmath367-element subset of the full set ( recall that the length of @xmath57 corresponds to the cardinality of an appropriate subset in the set system ) , we consider how many of its elements have been chosen into @xmath115 . specifically , we have : @xmath368 = \\frac{{\\| \\vv\\| \\choose s } { { n -\\| \\vv\\| } \\choose { m_j - 1 - s } } } { { n \\choose { m_j - 1 } } } , \\ ] ] for each non - negative integer @xmath369 .    our goal is to show a chernoff - type bound over the probability that @xmath370 deviates from its expectation .",
    "however , we face the difficulty that the corresponding indicator variables are not independent , and thus we can not apply a chernoff bound directly ( see , e.g.  @xcite ) . nevertheless , in our scenario a chernoff bound is still applicable , this can be viewed by various approaches , see , e.g. ,  @xcite . for the sake of completeness",
    "we describe the proof in detail , and rely on the analysis of panconesi and srinivasan  @xcite , which implies that when the underlying indicator variables are `` negatively correlated '' , one can still apply a chernoff bound ( see also  @xcite ) .",
    "we enumerate all non - zero coordinates of @xmath57 in an arbitrary order , let @xmath371 be this set of indices ( in this notation we ignore all the zero - coordinates ) , and attach an indicator variable @xmath372 to each index @xmath373 , which is defined to be one if and only if @xmath374 ( in other words , the corresponding element in the underlying set induced by @xmath57 has been chosen to be included into the sample of the @xmath116 elements ) . according to this notation , @xmath370 is represented by the sum @xmath375 .",
    "it is now easy to verify that @xmath376 = ( m_j - 1)/n$ ] , and by linearity of expectation @xmath377 = \\| \\vv \\| \\cdot ( m_j - 1)/n$ ] .",
    "however , the variables @xmath378 are not independent due to our probabilistic model ( that is , @xmath115 is chosen without replacements ) , albeit , they are _ negatively correlated_. this implies that for each subset @xmath379 @xmath380 \\le \\prod_{i \\in k } \\operatorname{\\mathbf{prob}}[x_i = 0 ] , \\ ] ] and",
    "@xmath381 \\le \\prod_{i \\in k } \\operatorname{\\mathbf{prob}}[x_i = 1 ] .\\ ] ] indeed , following the considerations in  @xcite , let us show first the latter inequality .",
    "put @xmath382 . then @xmath383 = \\operatorname{\\mathbf{prob}}[l_{k } \\subseteq i_j]$ ] , and since @xmath115 is uniformly chosen , in order to bound the latter we need to take the proportion between the number of subsets of size @xmath116 that contain @xmath384 and the entire number of subsets of size @xmath116 that can be chosen from an @xmath1-element set . hence @xmath385",
    "= \\frac{{{n - |k| } \\choose { m_j - 1 - |k| } } } { { n \\choose { m_j-1 } } } =     \\frac{(m_j - 1)(m_j - 2 ) \\cdots ( m_j - |k| ) } { n(n-1 ) \\cdots ( n-|k|+1 ) } , \\ ] ] and the latter is smaller than @xmath386 , as is easily verified . using similar arguments for the first correlation inequality , we obtain @xmath380 =   \\frac{{{n - |k| } \\choose { m_j - 1 } } } { { n \\choose { m_j - 1 } } } < \\left(1 - \\frac{m_j - 1}{n } \\right)^{|k| } .\\ ] ]    we are now ready to apply  ( * ? ? ?",
    "* theorem 3.4 ) stating that if the indicator variables @xmath372 are negatively correlated then ( recall that @xmath375 ) , @xmath387 with @xmath388 , such that @xmath389 \\le \\operatorname{\\mathbf{exp}}[\\hat{x}]$ ] . in the scenario of our problem @xmath390 is taken to be a bernulli indicator random variable , which takes value one with probability @xmath391 , in which case @xmath389 = \\operatorname{\\mathbf{exp}}[\\hat{x } ] = \\| \\vv \\| \\cdot ( m_j - 1)/n$ ] . ] : @xmath392 ] < \\left(\\frac{e^{\\rho-1 } } { \\rho^{\\rho}}\\right)^{\\operatorname{\\mathbf{exp}}[x ] } , \\ ] ] for any @xmath393 .",
    "in particular , when @xmath394 ( where @xmath73 is the base of the natural logarithm ) , the latter term is bounded by @xmath395 } $ ] . recall that we assumed @xmath396 , and thus @xmath389 = \\operatorname{\\mathbf{exp}}[\\| \\vv_{|_{i_j } } \\| ] \\le   k \\cdot ( m_j - 1)/n$ ] .",
    "thus , for any @xmath163 , we obtain : @xmath397   =     \\operatorname{\\mathbf{prob}}\\left[\\| \\vv_{|_{i_j } } \\| > \\frac{t k(m_j - 1)/n}{\\operatorname{\\mathbf{exp}}[\\| \\vv_{|_{i_j } } \\| ] } \\cdot \\operatorname{\\mathbf{exp}}[\\| \\vv_{|_{i_j } } \\| ] \\right ] , \\ ] ] observe that in this case @xmath398 } \\ge 2e$ ] , due to our assumption on @xmath399 and the fact that @xmath400 } \\ge 1 $ ] , and thus the latter term is bounded by : @xmath401 }   \\operatorname{\\mathbf{exp}}[\\| \\vv_{|_{i_j } } \\| ] } =   2^{-t k(m_j - 1)/n } , \\ ] ] as asserted .",
    "given a set system @xmath254 as in section  [ sec : spanning_trees ] , our goal is to approximate the spanning tree with minimum conflicts , using the metric embedding approach of har - peled and indyk  @xcite .",
    "the original settings studied in  @xcite are dual set systems of halfspaces and points ( as in  @xcite ) , however , most of the steps in their analysis can be applied in our case as well , and therefore we mainly emphasize the modifications required by our analysis .    specifically , we proceed as follows . for any subset @xmath402",
    ", we form a mapping @xmath403 , which maps a region ( i.e. , a set ) in @xmath211 to a unique integer i d in the projection @xmath404 ( see  @xcite for the existence of such a mapping ) .",
    "next , we embed the symmetric difference distance between each pair of sets @xmath405 to the hamming space @xmath406 , where @xmath407 , using a collection @xmath408 of @xmath409 random subsets @xmath410 of @xmath2 . here , the hamming space consists of all i d vectors @xmath411 , for each @xmath219 .",
    "then , a main property of the analysis in  @xcite is to have a low distortion between the symmetric difference distance of pairs of sets @xmath241 , @xmath412 and the hamming distance between their two corresponding vectors @xmath413 , @xmath414 ( which is the number of coordinates where they disagree ) .",
    "once the mapping @xmath415 is computed , for all sets @xmath219 , one can use existing machinery to support dynamic approximate nearest - neighbor in order to compute @xmath222-approximation for the spanning tree in time @xmath416 ( this is described in  @xcite is detail , see also  @xcite ) .",
    "thus a main task is to compute @xmath415 efficiently .",
    "whereas the computation of @xmath417 in  @xcite is based on the construction of many faces in an arrangement of lines ( for planar settings ) and an `` intersection - searching '' machinery ( for settings in higher dimensions ) , we need to resort to a _ range - counting _ machinery ( see , e.g. ,  @xcite ) . in this case one can obtain a _",
    "canonical representation _ for the subset of points stored in each @xmath219 , and then produce the ids based on the canonical sets ( rather than the explicit sets ) .",
    "skipping the technical ( and straightforward ) details , we conclude that the running time for computing @xmath415 is dominated , up to a polylogarithmic factor , by the task of computing , for each @xmath219 , the number of points that it contains from @xmath410 . by existing range searching machinery ( see , e.g. ,  @xcite )",
    ", it follows that this time is ( i ) @xmath418 , if @xmath211 is a set of halfspaces or parallel slabs in @xmath8-space , and ( ii ) @xmath419 , if @xmath211 is a set of balls in @xmath8-space .",
    "thus from the above considerations we obtain the bounds stated in corollary  [ cor : approx_mst ] ."
  ],
  "abstract_text": [
    "<S> we refine the bound on the packing number , originally shown by haussler , for shallow geometric set systems . </S>",
    "<S> specifically , let @xmath0 be a finite set system defined over an @xmath1-point set @xmath2 ; we view @xmath0 as a set of indicator vectors over the @xmath1-dimensional unit cube . </S>",
    "<S> a @xmath3-separated set of @xmath0 is a subcollection @xmath4 , s.t . </S>",
    "<S> the hamming distance between each pair @xmath5 is greater than @xmath3 , where @xmath6 is an integer parameter . the @xmath3-packing number is then defined as the cardinality of the largest @xmath3-separated subcollection of @xmath0 . </S>",
    "<S> haussler showed an asymptotically tight bound of @xmath7 on the @xmath3-packing number if @xmath0 has vc - dimension ( or _ primal shatter dimension _ ) @xmath8 . </S>",
    "<S> we refine this bound for the scenario where , for any subset , @xmath9 of size @xmath10 and for any parameter @xmath11 , the number of vectors of length at most @xmath12 in the restriction of @xmath0 to @xmath13 is only @xmath14 , for a fixed integer @xmath15 and a real parameter @xmath16 ( this generalizes the standard notion of _ bounded primal shatter dimension _ when @xmath17 ) . in this case </S>",
    "<S> when @xmath0 is `` @xmath12-shallow '' ( all vector lengths are at most @xmath12 ) , we show that its @xmath3-packing number is @xmath18 , matching haussler s bound for the special cases where @xmath19 or @xmath20 . as an immediate consequence </S>",
    "<S> we conclude that set systems of halfspaces , balls , and parallel slabs defined over @xmath1 points in @xmath8-space admit better packing numbers when @xmath12 is smaller than @xmath1 . </S>",
    "<S> last but not least , we describe applications to ( i ) spanning trees of low total crossing number , and ( ii ) geometric discrepancy , based on previous work by the author . </S>"
  ]
}