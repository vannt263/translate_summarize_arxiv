{
  "article_text": [
    "since the seminal work of black and scholes @xcite , who drew an analogy between the random motion of microscopic particles and the unpredictable evolution of stock prices , methods from theoretical physics have proved very useful for pricing various financial derivative products @xcite .",
    "the pricing of derivative products is based on a model for the evolution of the probability function of the underlying asset . in order for a model to describe the economic reality accurately ,",
    "a sufficiently general evolution for the probability distribution has to be allowed for . nevertheless , the simple diffusion model of black and scholes ( bs ) is still widely used .",
    "much of its success is due to the availability of closed - form analytical pricing formulas for many types of derivatives @xcite .",
    "it is known for a long time that the bs model is only a crude approximation to the economic reality and that its assumptions are violated in actual markets .",
    "perhaps the most illustrative violation is that the volatility implied from traded vanilla options , the implied volatility is not constant across strikes and maturities .",
    "examples of models that tackle such violations are local volatility processes @xcite , jump processes @xcite , lvy processes @xcite and stochastic volatility models @xcite . a stochastic volatility model that has been particularly successful at explaining the implied volatility smile in equity and foreign exchange markets is the heston model @xcite .",
    "in his seminal paper , heston @xcite derived a closed form solution for the price of a vanilla option , which enables a quick and reliable calibration to market prices , especially for liquidly traded vanilla options with maturities between 2 months and 2 years @xcite .",
    "contrary to the black - scholes model , to date in the heston model no closed - form analytic formulas have been found for exotic options ( for recent results see @xcite ) . since no such formulas are available in the literature for any but the simplest payoffs , often costly numerical techniques have to be used ( see @xcite and references therein ) .",
    "the original mathematical solution of the option pricing problem was formulated within the framework of partial differential equations , but an equivalent description with path integral methods was developed in the pioneering work by linetsky @xcite and dash @xcite .",
    "they showed that path dependent exotic options can be straightforwardly priced with the path integral method .",
    "this should be intuitively clear : in the path integral formalism , a probability is assigned to every evolution path of the asset . in the formulation with partial differential equations , such quantities are typically difficult to access .",
    "path integral methods have also been used in the pricing of options within stochastic volatility models @xcite and in the related problem of non - gaussian diffusion @xcite ( at the end of sec .",
    "[ pir ] we come back to this connection ) , but to the best of our knowledge no explicit option pricing formula as cheap to evaluate as stein and stein s @xcite or heston s formulas @xcite have yet been derived using path integrals .",
    "we will show in the present paper how to carry out this task for the heston model .",
    "the result we thereby obtain corresponds to the existing result @xcite for which the calibration and correspondence to market data has already been investigated see for example @xcite . for a thorough discussion on",
    "when which approach should be used we refer to @xcite and references herein .",
    "it is also known that there are still important features of asset price distributions which are absent in the heston model for example : empirical studies of time series provide evidence of the long time memory of volatility @xcite . since models containing a memory effect through retarded interaction , for example in the context of polarons , @xcite , have been solved within a path integral framework , we think our method can prove to be useful in more realistic models for the market also .",
    "the full power of the path integral method becomes clear , when we exploit its flexibility by calculating the price of an option in a setting where not only the volatility but also the interest rate is stochastic and follows the widely used cir model @xcite . to the best of our knowledge , no exact closed - form formula for this problem is available .",
    "therefore , we have checked our formulas against a monte carlo simulation .",
    "the plan of the paper is as follows . in sec .",
    "[ pir ] , we outline our model , which is the one introduced by heston . extensions of our method to different models are however straightforward . further in this section",
    "we derive a closed - form solution for the time evolution of the asset price . in sec . [",
    "sec : pivan ] we present a closed - form pricing formula for plain vanilla options which only involves one numerical integration of a compilation of elementary functions . in sec .",
    "iii we will extend the heston model to include stochastic interest rate , in sec .",
    "iii a we present a closed - form solution for the vanilla option price which still contains only on numerical integration of a compilation of elementary functions . in sec .",
    "[ trosir ]  we test this result with a monte carlo method and discuss the relevance of including stochastic interest rate .",
    "conclusions are drawn in sec .",
    "we will concentrate on assets following a diffusion process described by the following two equations introduced by heston @xcite @xmath0 here @xmath1 is the asset price , @xmath2 is a constant drift factor , @xmath3 is the variance of the asset , @xmath4 is the spring constant of the force that attracts the variance to its mean reversion level @xmath5(also called the mean reversion speed ) , @xmath6  is the volatility of the variance , and @xmath7 and @xmath8 are independent wiener processes with unit variance and zero mean .",
    "the asset price follows a black - scholes process @xcite , whereas the volatility obeys a cox - ingersoll - ross process @xcite .",
    "there are two general approaches to determine the price of an option in a path integral context .",
    "one could , based upon equations ( [ hest1a ] ) , ( [ hest1 ] ) determine the probability distribution for the asset price at the strike time @xmath9 conditional on the values of the asset and the variance at the present time @xmath10 .",
    "the expectation value of the option price at time @xmath9 can be calculated by integrating the gain you make with a certain outcome of @xmath11 multiplied by the probability of obtaining that outcome @xmath12  over all possible values of @xmath11 . to obtain the present value of the price one then discounts this expectation value with the risk free interest rate @xmath13 . for a european call option",
    "this can be written as:@xmath14   p_{s}\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   .",
    "\\label{jecpf1}\\ ] ] we will refer to this approach as the `` _ _ asset propagation approach _ _ '' since @xmath15 is the propagator for a distribution of asset prices ( and volatilities ) .    the other approach focuses on the option price rather than the asset evolution , as will be referred to as the `` _ _ option propagation approach _ _ '' . in his paper [ 6 ] , heston discusses the subtle differences between the asset point of view and the option price point of view , and this discussion is also relevant to the present path - integral framework .",
    "heston motivates that the time evolution of the option price @xmath16 is governed by the following partial differential equation ( pde):@xmath17   -\\lambda v\\right\\ }   \\frac{\\partial u}{\\partial v}-\\frac{1}{2}vs^{2}\\frac{\\partial^{2}u}{\\partial s^{2}}-\\rho\\sigma vs\\frac{\\partial^{2}u}{\\partial s\\partial v}-\\frac{1}{2}\\sigma ^{2}v\\frac{\\partial^{2}u}{\\partial v^{2 } } , \\label{hestssde}\\ ] ] where @xmath18 is a parameter introduced @xcite on the basis of no - arbritage arguments and setting up a risk - free portfolio .",
    "if one makes the substitution @xmath19  one obtains the following pde for @xmath20 as a function of the asset price and the volatility:@xmath21   -\\lambda v\\right\\ }   \\frac{\\partial v}{\\partial v}-\\frac{1}{2}vs^{2}\\frac{\\partial^{2}v}{\\partial s^{2}}-\\rho\\sigma vs\\frac{\\partial^{2}v}{\\partial s\\partial v}-\\frac{1}{2}\\sigma ^{2}v\\frac{\\partial^{2}v}{\\partial v^{2}}. \\label{hestssde2}\\ ] ] based on this pde , one can find a kernel @xmath22  that propagates a given final distribution @xmath23 backwards to the present value @xmath24 of the option .",
    "since the value of the option at the final time @xmath9 is known , @xmath25   $ ] , the value of the option now is obtained through @xmath14   p_{v}\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   , \\label{ecpf2}\\ ] ] furthermore the pde ( [ hestssde2 ] ) is equal to the kolmogorov backward equation corresponding to the following system of stochastic differential equations",
    "@xmath26   -\\lambda v\\right\\ } dt+\\sigma\\sqrt{v}\\left (   \\rho dw_{1}+\\sqrt{1-\\rho^{2}}dw_{2}\\right )   .\\end{aligned}\\ ] ]    this means that both approaches can be dealt with simultaneously by considering a generalized stochastic process:@xmath27 and calculating its transition probability @xmath28 .",
    "the `` asset propagation '' approach ( [ jecpf1 ] ) can then be retained by simply replacing @xmath29 and @xmath30  by @xmath31 and @xmath5 and the `` option propagation '' approach ( [ hestssde2 ] ) , ( [ ecpf2 ] ) by replacing @xmath29 and @xmath30  by @xmath32 and @xmath33 .",
    "the pricing formula for the european call is the same as ( [ jecpf1 ] )  where this time the transition probability @xmath34 is the one corresponding to ( [ gensde1 ] ) , ( [ gensde2]):@xmath35{l}p_{s}\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   = \\left .",
    "p\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   \\right\\vert _ { \\mu=\\mu_{0},\\kappa=\\kappa _ { 0},\\theta=\\theta_{0}}\\\\ p_{v}\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   = \\left .",
    "p\\left (   s_{t},v_{t}\\mid s_{0},v_{0}\\right )   \\right\\vert _ { \\mu = r,\\kappa=\\kappa_{0}+\\lambda,\\theta=\\kappa_{0}\\theta_{0}/(\\kappa_{0}+\\lambda)}\\end{array } \\right .   \\label{vbern}\\ ] ] we will calculate the transition density @xmath36 for the general stochastic process ( [ gensde1 ] ) , ( [ gensde2 ] )",
    ".    for later convenience we make the following substitutions:@xmath37 @xmath38 is called the logreturn and @xmath39 is the volatility of the asset price . after these substitutions , eq .",
    "( [ hest1 ] )  becomes:@xmath40   dt+\\frac{\\sigma}{2}\\left (   \\rho dw_{1}+\\sqrt { 1-\\rho^{2}}dw_{2}\\right )   .",
    "\\label{hest3}\\ ] ] the substitution @xmath41 leads to two uncorrelated equations:@xmath42   dt+\\frac{\\sigma}{2}dw_{2}. \\label{hest4}\\ ] ] we will assume that the initial volatility @xmath43 is known @xcite .",
    "the probability that @xmath44  has the value @xmath45 and @xmath39 the value @xmath46  at a later time @xmath9 will be denoted as @xmath47 .",
    "the advantage of transforming to these variables is that @xmath48 and @xmath49 are uncorrelated , so that the following expression holds for @xmath50:@xmath51   + \\mathcal{l}_{cir}[z(t)]\\right\\ }   dt\\right )   .",
    "\\label{pimooi}\\ ] ] where the quadratic lagrangian @xmath52  equals @xmath53   ^{2 } , \\label{elkuu}\\ ] ] and the lagrangian corresponding to the cir process , @xmath54 $ ] ,  is given by @xcite:@xmath55=\\frac{2}{\\sigma^{2}}\\left\\ {   \\dot{z}-\\frac{1}{2}\\left [ \\frac{1}{z}\\left (   \\kappa\\theta-\\frac{\\sigma^{2}}{4}\\right )   -\\kappa z\\right ] \\right\\ }   ^{2}-\\frac{1}{4z^{2}}\\left (   \\kappa\\theta-\\frac{\\sigma^{2}}{4}\\right )   -\\frac{\\kappa}{4 } , \\label{cird}\\ ] ]    the first step in the evaluation of eq .",
    "( [ pimooi ] ) is the integration over all @xmath44-paths .",
    "because the action is quadratic in @xmath44 this integration can be done analytically and yields @xmath56\\right\\ }   .",
    "\\label{eq : pi1b}\\ ] ] note that the probability to arrive in @xmath57 only depends on the average value of the volatility along the path @xmath58 : @xmath59 , in agreement with ref .",
    "@xcite . however , this average value appears in the denominator of the third term , and to perform the functional integral one needs to bring this into the numerator .",
    "this is achieved by rewriting part of the expression ( [ eq : pi1b ] ) as follows:@xmath60   = \\int_{-\\infty}^{+\\infty}\\frac{dk}{2\\pi}\\exp\\left [ i\\left (   y_{t}-y_{0}\\right )   k-\\frac{\\int z^{2}dt\\left (   1-\\rho^{2}\\right ) } { 2}k^{2}\\right ]   .",
    "\\label{eq : gidb}\\ ] ] combining eqns .",
    "( [ eq : pi1b ] ) and ( [ eq : gidb ] ) and making the substitution @xmath61 the transition probability becomes @xmath62 \\int\\mathcal{d}z(t)\\label{eq : pi2b}\\\\ \\times &   \\exp\\left (   -\\int_{0}^{t}dt\\left\\ {   \\mathcal{l}_{cir}[z(t)]+\\frac { 1}{2}z^{2}\\left [   \\left (   1-\\rho^{2}\\right )   l^{2}+2li\\left (   \\frac{\\rho } { \\sigma}\\kappa-\\frac{1}{2}\\right )   \\right ]   \\right\\ }   \\right )   .\\nonumber\\end{aligned}\\ ] ] the path integral over the cir action is formally equivalent to the exactly solvable radial harmonic oscillator @xcite and , fortunately , adding terms proportional to @xmath63 to the action does not spoil this equivalence .",
    "the full path integral over @xmath58 can be carried out without approximations with the following result:@xmath64 \\nonumber\\\\ \\times &   \\int\\limits_{-\\infty}^{+\\infty}\\exp\\left [   i\\left (   y_{t}-y_{0}\\right )   l\\right ]   \\sqrt{z_{0}z_{t}}\\frac{4\\omega}{\\sigma^{2}\\sinh\\left (   \\omega t\\right )   } \\nonumber\\\\ \\times &   \\exp\\left [   -\\frac{2\\omega}{\\sigma^{2}}\\left (   z_{0}^{2}+z_{t}^{2}\\right )   \\coth\\left (   \\omega t\\right )   \\right ]   i_{\\frac{2}{\\sigma^{2}}\\kappa\\theta-1}\\left [   \\frac{4\\omega z_{0}z_{t}}{\\sigma^{2}\\sinh\\left ( \\omega t\\right )   } \\right ]   dl .",
    "\\label{napad2}\\ ] ] where @xmath65 is the @xmath66-dependent frequency of the radial harmonic oscillator that corresponds to the cir lagrangian ( [ cird ] ) . after transforming back to the @xmath38 variable",
    "we see that also the integral over the final value @xmath46 can be done analytically ( see e.g. @xcite ) , yielding the marginal probability distribution @xmath67 ( written in the original variable @xmath3 ) as a simple fourier integral:@xmath68 \\nonumber\\\\ &   \\times\\int\\limits_{-\\infty}^{+\\infty}n^{\\frac{2}{\\sigma^{2}}\\kappa\\theta } \\exp\\left\\ {   i\\left [   x_{t}+\\frac{\\rho}{\\sigma}\\left (   v_{0}+\\kappa\\theta t\\right )   \\right ]   l\\right .",
    "\\nonumber\\\\ &   \\left .",
    "-\\frac{2\\omega}{\\sigma^{2}\\sinh\\left (   \\omega t\\right )   } \\left [ \\cosh\\left (   \\omega t\\right )   -n\\right ]   v_{0}\\right\\ }   dl , \\label{eq : pfinc}\\ ] ] where n is : @xmath69 note the similarity of the expression ( [ eq : pfinc ] ) with the result obtained in ref .",
    "@xcite , derived for a general stochastic process with non - gaussian noise .      from now on",
    "we follow the option propagation approach and set @xmath70 equal to @xmath13 . the price of a call option @xmath71 with expiration date @xmath9 and strike @xmath72 when the transition probability is known is given by eq .",
    "( [ jecpf1 ] ) . writing this formula in the @xmath38 variable and thereby inserting the result ( [ eq : pfinc ] ) for the transition probability results in:@xmath73   \\mathcal{p}\\left (   x_{t}\\mid 0,v_{0}\\right )   , \\label{eq : pricep}\\ ] ] where the risk free interest rate was restored and denoted by @xmath13 .",
    "now there are still two numerical integrations that have to be done . following the derivation outlined in ref .",
    "@xcite  we can rewrite expression ( [ eq : pricep ] ) so that only one numerical integration remains:@xmath74   \\right . \\label{resvop}\\\\ &   \\left .",
    "\\times\\left [   s_{0}\\exp\\left (   \\theta-\\frac{\\rho}{\\sigma}a\\right ) -e^{-rt}k\\exp\\left (   \\upsilon\\right )   \\right ]   -s_{0}+e^{-rt}k\\right\\ } \\frac{dl}{2\\pi},\\nonumber\\end{aligned}\\ ] ] with    @xmath75   ^{-1},\\\\ \\theta &   = \\frac{2\\nu v_{0}}{\\sigma^{2}\\sinh\\left (   \\nu t\\right )   } \\left [ m-\\cosh\\left (   \\nu t\\right )   \\right ]   + \\frac{2}{\\sigma^{2}}\\kappa\\theta\\log m,\\\\ \\upsilon &   = \\frac{2\\omega v_{0}}{\\sigma^{2}\\sinh\\left (   \\omega t\\right ) } \\left [   n-\\cosh\\left (   \\omega t\\right )   \\right ]   + \\frac{2}{\\sigma^{2}}\\kappa\\theta\\log n. \\label{laatst}\\ ] ]    and @xmath76 defined as before ( [ denomega ] ) .",
    "we  have tested this result against the formula stated in ref .",
    "this confirmed the correctness of formula ( [ resvop ] ) .",
    "now we are confident to explore new grounds with our method in the following section .",
    "in the previous section we assumed the interest rate to be constant . here we allow the interest rate to change in time , @xmath77 . applying black and scholes no - arbitrage argument on heston s risk - free portfolio motivation for the evolution of the option price ,",
    "we again obtain the partial differential equation ( [ hestssde2 ] ) with @xmath77 rather than a constant @xmath78    @xmath79   -\\lambda v\\right\\ }   \\frac{\\partial v}{\\partial v}-\\frac{1}{2}vs^{2}\\frac{\\partial^{2}v}{\\partial s^{2}}-\\rho\\sigma vs\\frac{\\partial^{2}v}{\\partial s\\partial v}-\\frac{1}{2}\\sigma ^{2}v\\frac{\\partial^{2}v}{\\partial v^{2}}\\ ] ]    for a given function @xmath77 this leads to a kernel @xmath80   $ ] so that the option price becomes@xmath81=\\int\\limits_{-\\infty}^{+\\infty}ds_{t}dv_{t}\\max\\left [ s_{t}-k,0\\right ]   \\text { } e^{-\\int r(t)dt}p_{v}\\left [   s_{t},v_{t}\\mid s_{0},v_{0}\\mid r(t)\\right ]   .\\ ] ] note that the option price is now a functional of the given time evolution of the interest rate @xmath77 .",
    "as in the previous section , it is convenient to introduce new integration variables @xmath82   , \\\\",
    "z(t )   &   = \\sqrt{v(t)}.\\end{aligned}\\ ] ] in the path - integral treatment , the kernel can be written as a sum over all possible realizations of @xmath83 and @xmath58 , weighed by the action functional of the system : @xmath84   &   = \\int\\limits_{-\\infty}^{+\\infty}dx_{t}dv_{t}\\max\\left [ e^{x_{t}}-k,0\\right ]   \\text { } e^{-{\\textstyle\\int\\nolimits_{0}^{t } } r(t)dt}\\nonumber\\\\ &   \\times\\int\\mathcal{d}y\\mathcal{d}z\\text { } \\exp\\left (   -\\int\\limits_{0}^{t}\\left\\ {   \\mathcal{l}_{q}\\left [   y(t),z(t),r(t)\\right ]   + \\mathcal{l}_{cir}[z(t)]\\right\\ }   dt\\right )   , \\end{aligned}\\ ] ] where @xmath85 is the quadratic lagrangian ( [ elkuu ] ) @xmath86   ^{2},\\ ] ] and @xmath87 is the cir  lagrangian . of course",
    ", we can not know what particular realization of the interest rate @xmath77 will appear in the future .",
    "we assume the interest rate to follow a cir process which is uncorrelated from the other two stochastic processes,@xmath88 the value for the option price then needs to be averaged over the realization of @xmath77 in this cir  process . where the calculation of the expectation value of such a functional might become cumbersome with conventional probabilistic techniques , it can be evaluated very elegantly with the feynman - kac formula : @xmath89\\right\\rangle = \\int\\mathcal{d}r\\text { } \\mathcal{c}[r(t)]\\exp\\left (   -\\int\\limits_{0}^{t}\\mathcal{l}_{cir}[r(t)]dt\\right )   , \\ ] ] where @xmath87 is the lagrangian for the cir process .",
    "the final result can be expressed with a modified propagator @xmath90 as@xmath91   p(s_{t},v_{t},r_{t}\\mid s_{0},v_{0},r_{0 } ) , \\label{blab}\\ ] ] with@xmath92   + \\mathcal{l}_{cir}[z(t)]+\\mathcal{l}_{cir}[r(t)]\\right\\ }   dt\\right )   .\\end{aligned}\\ ] ] the stochastic interest rate makes the vanilla price dependent on the specific path followed by the interest rate .",
    "this part of the payoff has been taken into the calculation of the propagator , where it is analytically tractable , and no longer appears explicitly in the expression ( [ blab ] ) for the option price .",
    "herein lies the strength of the path - integral approach , to price path - dependent options . with a stochastic interest rate",
    "the european vanilla option becomes dependent on the entire path of the interest rate and is still solved in a very straightforward way .",
    "this is promising for more general option types , such as the barrier and asian options that we are currently investigating .",
    "a useful substitution to perform the functional integrations is@xmath93 as was the case for the lagrangian corresponding to the volatility , the lagrangian corresponding to the interest rate process will also be formally equivalent to the lagrangian corresponding to a radial harmonic oscillator ; furthermore the addition of another term quadratic in @xmath94 stemming from the discount factor does nt spoil the correspondence .",
    "the result reads as follows:@xmath95 \\nonumber\\\\ &   + i\\int\\limits_{-\\infty}^{\\infty}\\frac{1}{l}\\left\\ {   k\\exp\\left [ \\upsilon_{r}\\left (   0\\right )   + \\frac{\\kappa_{r}}{\\sigma_{r}^{2}}a_{r}\\right ] \\right .   -s_{0}+\\exp\\left",
    "[   i\\left (   \\frac{\\rho}{\\sigma}a+x_{e}\\right ) l+\\frac{\\kappa}{\\sigma^{2}}a+\\frac{\\kappa_{r}}{\\sigma_{r}^{2}}a_{r}\\right ] \\nonumber\\\\ &   \\left .",
    "\\times\\left [   s_{0}\\exp\\left (   -\\frac{\\rho}{\\sigma}a+\\theta + \\theta_{r}\\right )   -k\\exp\\left (   \\upsilon+\\upsilon_{r}\\right )   \\right ] \\right\\ }   \\frac{dl}{2\\pi}. \\label{prmr2}\\ ] ] to make it surveyable , we introduced the following notations@xmath96   ^{-1},\\\\ \\theta_{r }   &   = \\frac{2\\nu_{r}r_{0}}{\\sigma_{r}^{2}\\sinh\\left (   \\nu _ { r}t\\right )   } \\left [   m_{r}-\\cosh\\left (   \\nu_{r}t\\right )   \\right ] + 2\\frac{\\kappa_{r}\\theta_{r}}{\\sigma_{r}^{2}}\\log m_{r},\\\\ \\upsilon_{r}\\left (   l\\right )    &   = \\frac{2\\omega_{r}\\left (   l\\right )   r_{0}}{\\sigma_{r}^{2}\\sinh\\left [   \\omega_{r}\\left (   l\\right )   t\\right ]   } \\left\\ { n_{r}\\left (   l\\right )   -\\cosh\\left [   \\omega_{r}\\left (   l\\right )   t\\right ] \\right\\ }   + 2\\frac{\\kappa_{r}\\theta_{r}}{\\sigma_{r}^{2}}\\log n_{r}\\left ( l\\right )   .\\end{aligned}\\ ] ] these notations reflect the extension to the case of stochastic interest rate ( symbols with subscript @xmath13 ) of the corresponding quantities in the heston model ( equations ( [ eerst])-([laatst ] ) ) .",
    "notice the resemblance with formula ( [ resvop ] ) .",
    "formula ( [ prmr2 ] ) still contains  just one numerical integration with an integrand composed out of elementary functions . to the best of our knowledge ,",
    "only approximate analytical formulae are available when both the volatility and interest rate are stochastic @xcite . because of the lack of alternative exact analytical expressions , we have checked the validity of our formula ( [ prmr2 ] ) against numerical monte carlo simulations .",
    "our monte carlo method is outlined below .    first notice that substitutions ( [ subsngv ] ) transform the @xmath38-variable into a variable @xmath97 , independent of the interest rate by subtracting the time averaged interest rate @xmath98 : @xmath99 .",
    "this results in the same equation as in the constant interest rate situation , eq .",
    "( [ hest3a ] ) .",
    "also the discount factor only contains @xmath98 .",
    "this means that the knowledge of the probability distribution @xmath98 is sufficient to calculate the price by means of the formula ( [ resvop ] ) derived in the constant interest rate setting .",
    "so the monte carlo scheme used is the following : first values for @xmath98 are simulated and used to calculate the option price for these values , next the price is averaged over all the simulations .",
    "a value for @xmath98 is simulated as follows : time is discretized in little time steps @xmath100 , we sample a path for @xmath13 and integrate along this path . to calculate the probability distribution for @xmath98",
    ", we used the result that the stochastic time increment of a cir variable over a small time step @xmath101 follows a non - central @xmath102 distribution @xcite .",
    "the probability distribution of the average interest rate @xmath98 is then simulated by generating many @xmath13-paths in discretized time . as shown in fig .",
    "[ prentsti5 ] , the agreement between the analytical ( thick full line ) and numerical option prices is excellent .    in this section",
    "the option propagation approach was followed from the beginning . in this setting it",
    "is necessary to make a choice between the two approaches from the start because in the asset propagation approach one would actually have to introduce a stochastic process for the drift @xmath2  instead of for the interest rate . that these two should follow the same stochastic process is not clear .",
    "since the option propagation approach is the most common one anyway we followed this approach .",
    "if one does want to introduce a stochastic process for the drift @xmath2  this poses no problem and the derivation of an option price in this setting would be completely similar .      in the current treatment , we have two layers of generalization as compared to the black - scholes result .",
    "first , the volatility appearing in the black - scholes process is stochastic  this leads to the heston model .",
    "second , the interest rate of the black - scholes model is also stochastic ",
    "leading to our present results . in this paragraph",
    ", we argue that both improvements can have an equally important effect on the option price .",
    "[ t ]    figure1.eps    this is illustrated in fig .",
    "[ prentsti5 ] , where the different approaches are compared .",
    "let s start with the most complete model , where both interest rate and volatility are stochastic .",
    "the resulting option price , eq .",
    "( [ prmr2 ] ) , for this model is shown as a thick red curve .",
    "the result from the closed - form expression agrees well with the monte carlo simulation , shown as crosses .",
    "now we strip off one layer of complexity , and fix the interest rate @xmath13  it is no longer a stochastic variable .",
    "then we obtain the heston model as an  ` approximation ' to a stochastic interest rate world .",
    "the question poses itself of which fixed interest rate to use , if we want to make the comparison .",
    "two choices are shown in fig .",
    "[ prentsti5 ] : @xmath103 and @xmath104 .",
    "the former choice ( dotted blue curves ) sets the heston interest rate equal to the interest rate at time @xmath105 , whereas the latter choice ( dash - dotted curves ) sets the heston interest rate equal to the mean reversion level @xmath106 . for the parameter values used in fig .",
    "[ prentsti5 ] , the most complete result lies between the two heston ` approximations ' , but this is not necessarily so .",
    "[ figje2 ] shows that for some choices of other ( realistic ) parameters , the full result can lie outside both heston approximations . nevertheless ,",
    "as @xmath107 becomes very large , the stochastic interest rate will be drawn very tightly to the mean reversion rate @xmath106 , and one expects the full result to be near the heston approximation with @xmath104 .",
    "when @xmath107 is very small , the stochastic interest rate will not be drawn quickly towards @xmath106 so that when also @xmath108 is small , the full results will be near the heston approximation with @xmath103 .",
    "next , we strip off the second layer of approximation , and also fix the volatility .",
    "this results in the familiar black - scholes model as the crudest approximation to our system .",
    "now a second choice has to be made : which value of the volatility to use . here",
    ", we take the stochastic volatility at time zero to be equal to the mean reversion level of the volatility cir  process , so that the ambiguity of choice is avoided .",
    "the choice for what interest rate to use , however , remains . in fig .",
    "[ prentsti5 ] , we show the black - scholes results with @xmath103 ( dashed line ) and @xmath104 ( full line ) .",
    "we have plotted all the results relative to the black - scholes result with @xmath104 to emphasize the differences rather than the absolute magnitude of the prices ( for this reason , the @xmath104 black - scholes result is the baseline of the plots ) .",
    "the difference between the three panels of fig .",
    "[ prentsti5 ] is the value of the correlation between asset price and volatility .",
    "[ ptb ]    figure2.eps    from figs .",
    "[ prentsti5 ] and [ figje2 ] , it is clear that both levels of approximation ( keeping the volatility constant and keeping the interest rate constant ) have an equally large effect on the option price . even within the heston framework ,",
    "the choice of what value to use for the interest rate is seen to influence the price considerably .",
    "choosing a different interest rate , or keeping the interest rate as a stochastic variable , leads to a price correction that is as large as the price correction obtained by going from the black - scholes to the heston model .",
    "this result emphasizes the importance of a correct treatment of the interest rate in pricing models ( this also depends strongly on the length of the lifetime of the option ) .",
    "finally we must remark that the price differences when working within the standard heston model or within the extended one can be influenced by the calibration method . for figures .",
    "[ prentsti5 ] and [ figje2 ] we used the same parameters for the volatility process both in the standard model and in the extended one , parameter values for the interest rate process are calibrated separately .",
    "literature shows that the parameter values for the volatility process ( see for example @xcite and @xcite ) and the interest rate process ( see for example @xcite and @xcite ) can attain values in a broad range containing the values we chose to produce fig .",
    "[ prentsti5 ] and fig .",
    "[ figje2 ] .",
    "however if the parameter values obtained for the interest rate process are used in formula ( [ prmr2 ] ) to calibrate the remaining parameter values for the volatility process one might get different results .",
    "we can not exclude that this calibration approach would lead to smaller price differences between the two approaches .",
    "however such a calibration is a research area on its own and is outside the scope of this article .",
    "we have developed a path - integral method to derive closed - form analytical formulas for the asset price distribution in the heston stochastic volatility model .",
    "closed - form formulas are obtained for the logreturn of the derivative and the vanilla option price .",
    "the presented results correspond to the known semi - analytic results obtained from solving the partial differential equation @xcite by standard techniques .",
    "the flexibility of our approach is demonstrated by extending the results to the case where the interest rate is a stochastic variable as well , and follows a cir process .",
    "for this case , to the best of our knowledge , no exact analytical solutions have been derived before .",
    "we have checked our semi - analytical results for the model with both stochastic volatility and stochastic interest rate against a monte - carlo simulation .",
    "the quantitative analysis shows that the effect of stochastic interest rate on the heston model can be as large as the effect of the stochastic volatility on the black - scholes model .",
    "however we did not perform a full calibration , which might influence the results . finally , the analogy between stochastic interest rate models and path dependent options makes our method promising for the pricing of exotic derivative products .",
    "acknowledgments  discussions with l. lemmens , i. de saedeleer , k. int hout and e. boksenbojm are gratefully acknowledged .",
    "this work is supported financially by the fund for scientific research - flanders , fwo project g.0125.08 .",
    "j. t. and d. l. gratefully acknowledge support of the special research fund of the university of antwerp , bof noi ua 2007 ."
  ],
  "abstract_text": [
    "<S> we present a path integral method to derive closed - form solutions for option prices in a stochastic volatility model . the method is explained in detail for the pricing of a plain vanilla option . </S>",
    "<S> the flexibility of our approach is demonstrated by extending the realm of closed - form option price formulas to the case where both the volatility and interest rates are stochastic . </S>",
    "<S> this flexibility is promising for the treatment of exotic options . </S>",
    "<S> our new analytical formulas are tested with numerical monte carlo simulations . </S>"
  ]
}