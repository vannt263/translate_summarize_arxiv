{
  "article_text": [
    "observational verification of hawking radiation @xcite is within reach thanks to experimentally accessible analogues of gravity that mimic the behaviour of wave propagation in a black hole spacetime @xcite .",
    "unruh s original proposal of acoustic waves in a flowing fluid that crosses the speed of sound @xcite has since been expanded upon and generalised , resulting in a cornucopia of analogue gravity systems that includes water waves @xcite , light in nonlinear media @xcite , and phononic excitations in atomic bec @xcite and in quantum fluids of light @xcite .",
    "as for the gravitational black hole , these analogue systems induce scattering between waves of _ opposite norm _ ( see , _",
    "e.g. _ , @xcite , and also part i ) .",
    "since the sign of the norm of a field mode indicates whether its amplitude becomes an annihilation or a creation operator upon quantization of the field @xcite , scattering between waves of opposite norm leads to a mixing of annihilation and creation operators in the basis transformation between ingoing and outgoing waves , and hence to the inequality of the ingoing and outgoing vacuum states .",
    "this is the essence of hawking radiation : in the absence of ingoing particles , outgoing particles must be present , so _",
    "particles are emitted spontaneously . _",
    "the spectrum of the spontaneous radiation is directly related to the scattering amplitudes between waves of opposite norm ( see part i ) , so the hawking spectrum is determined by the scattering properties of the analogue spacetime .    unlike classical gravity , analogue gravity systems are typically dominated by dispersion @xcite , complicating the wave behaviour and making it less amenable to analytical techniques .",
    "existing techniques include fdtd wave propagation @xcite , which is computationally intensive , especially if a spectrum over a wide range of frequencies is required ; numerical solution of an ode at fixed frequency @xcite , which can be performed if the dispersion relation is a polynomial of low degree and any exponentially growing waves do not significantly affect the accuracy of the solution ; analytical solution of the ode for a step discontinuous background by matching the solutions at the discontinuity @xcite ; and analytical techniques which are valid when the background varies slowly over length scales at which dispersive effects become important @xcite .",
    "however , practical setups will often lie outside these domains of applicability : dispersion relations can be too complicated to be modelled by a low - degree polynomial , and the background may have to vary rapidly in order to boost the spectrum to an observable level . our aim is to have a method for calculating the scattering amplitudes which relaxes the restrictions currently in place .    in",
    "the preceding paper  referred to here as part i  a numerical method is described which treats the wave equation as an integral equation in fourier space .",
    "this has the advantage that the dispersion relation appears as a multiplicative function ( rather than a differential operator ) , and can be quite arbitrary . through discretisation of the integral , the wave equation is transformed into a linear equation with the integral kernel as a matrix , and this can be solved using standard and efficient numerical algorithms . the one restriction imposed in part",
    "i is that the background be asymptotically symmetric  that is , the effective `` spacetime '' , which is assumed to approach a limiting value so that ingoing and outgoing waves are well - defined , is the same in the left- and right - hand asymptotic regions .",
    "while this is not an uncommon situation ( it applies to nonlinear optical analogues @xcite , for example ) , it is far from the most general case .",
    "the purpose of the present paper is to remove this restriction : to generalise the integral method to backgrounds that asymptote to _ different _ values in the left- and right - hand asymptotic regions .",
    "this paper is organised as follows . in section [ sec : asymmetric_integral_equation ] , we briefly review some aspects already covered in part i , particularly how the wave equation manifests itself as an integral equation in fourier space and how decomposition into left- and right - fourier transforms allows us to exploit certain analyticity properties of the components of the solution .",
    "we shall also note the essential differences induced by asymmetry , and how these complicate the method . in section [ sec : step - discontinuous_background ]",
    ", we present the solution of the integral equation for the simplest asymmetric background : that which is homogeneous except for a step discontinuity .",
    "this introduces the new mathematical machinery required to deal with asymmetry , stripped of the additional details due to the precise nature of the variation of the background ; these additional details are then replaced in section [ sec : general_background ] .",
    "section [ sec : application ] looks at the application of the method to a simple concrete model , and the paper concludes with section [ sec : conclusion ] .",
    "here we shall briefly review the form of the wave equation as an integral equation in fourier space , the analytic manipulations required to make it soluble , and the differences that arise due to asymmetry of the asymptotic regions .      while it is to be emphasised that the integral method is applicable to a wide variety of wave equations , we shall for definiteness focus our attention on unruh s acoustic model with dispersion @xcite . with @xmath1 the wavevector - dependent speed of sound , @xmath2 the position - dependent flow velocity and @xmath3 a stationary wave solution",
    ", the wave equation is @xmath4 \\phi_{\\omega}(x ) = 0 \\ , .",
    "\\label{eq : wave_eqn}\\ ] ] instead of the solution in position space , @xmath5 , we shall consider the fourier - transformed solution @xmath6 fourier transforming eq .",
    "( [ eq : wave_eqn ] ) , we find an equivalent equation for @xmath7 : @xmath8 where @xmath9 encodes the position - independent part of eq .",
    "( [ eq : wave_eqn ] ) that contains only constants and derivatives , while @xmath10 encodes the position - dependent terms which appear as convolutions of fourier transforms .",
    "explicitly , using @xmath11(k)$ ] to denote the fourier transform of an arbitrary function @xmath12 , we have @xmath13(k - k^{\\prime } ) + i\\omega \\ , \\mathcal{f}[\\partial_{x}u](k - k^{\\prime } ) \\right",
    ". \\nonumber \\\\ & & \\qquad \\qquad \\left .",
    "- k^{2 } \\ , \\mathcal{f}[u^{2}](k - k^{\\prime } ) - ik \\ , \\mathcal{f}[\\partial_{x}u^{2}](k - k^{\\prime } ) \\right ] \\nonumber \\\\ & = & \\frac{1}{2\\pi } \\left [ \\omega \\ , ( k+k^{\\prime } ) \\ , \\mathcal{f}[u](k - k^{\\prime } ) - k \\ , k^{\\prime } \\ , \\mathcal{f}[u^{2}](k - k^{\\prime } ) \\right ] \\ , , \\label{eq : unruh_kernel}\\end{aligned}\\ ] ] where the second line of eq .",
    "( [ eq : unruh_kernel ] ) follows from the relation @xmath14(k ) = ik\\,\\mathcal{f}[u](k)$ ] . to avoid cumbersome expressions",
    ", we shall suppress from now on the explicit dependence of the various quantities on the frequency @xmath15 .      by considering _",
    "transforms of the field , we can decompose it into two parts , as follows : @xmath16 so that @xmath17 since the field @xmath18 is assumed to be asymptotically bounded , @xmath19 is analytic and goes to zero at least as fast as @xmath20 in the upper half complex @xmath21-plane , while the same is true of @xmath22 in the lower half complex @xmath21-plane .",
    "the integral kernel @xmath10 can be similarly decomposed into functions with special analyticity properties in the integration variable @xmath23 : @xmath24 here , @xmath25 and @xmath26 are analytic and vanish asymptotically in the _ lower _ and _ upper _ half complex @xmath23-planes , respectively , and as in part i this difference is indicated by the appearance of @xmath27 and @xmath28 as subscripts rather than superscripts . with",
    "the @xmath23-dependence contained entirely in the arguments of fourier transforms , as in the first line of eq .",
    "( [ eq : unruh_kernel ] ) , @xmath25 and @xmath26 are formed simply by replacing the full fourier transform with left and right - fourier transforms , respectively .",
    "@xmath29 is independent of @xmath23 ; its inclusion allows us to deal with step discontinuities at @xmath30 ( as mentioned in appendix a of part i ) .",
    "if two functions are analytic on the same half - plane , then the integral of their product is the same for any deformation of the integration contour onto this half - plane ; furthermore , if each of these functions behaves asymptotically like @xmath20 , then the integral of their product vanishes . substituting @xmath31 and @xmath10 in eq .",
    "( [ eq : wave_eqn_integral ] ) for their decompositions in eqs .",
    "( [ eq : field_decomposition ] ) and ( [ eq : kernel_decomposition ] ) , this means that the integrals of @xmath32 and @xmath33 must vanish , and the integral equation becomes @xmath34      in order that ingoing and outgoing waves are well - defined , we assume that the background @xmath2 asymptotes to a constant value in both the left- and right - hand regions : @xmath35 these constant values contribute singular terms to the half - fourier transforms of @xmath36 : introducing the label @xmath37 and the sign @xmath38 and @xmath39 , we have @xmath40(k ) = u_{\\sigma } \\left [ \\pi\\,\\delta(k ) + \\frac{s_{\\sigma}}{i\\,k } \\right ] + \\mathcal{f}_{\\sigma}[u - u_{\\sigma}](k ) \\",
    ", , \\label{eq : ftu_singular}\\ ] ] where the asymptotic vanishing of @xmath41 in the integrated region causes the second term to be regular in @xmath21 .",
    "a similar expression holds for @xmath42 $ ] , while derivatives of the background , such as appear in eq .",
    "( [ eq : unruh_kernel ] ) , can have no singular component since they must vanish asymptotically .",
    "these singular terms are thus contained in the kernels , since the singularities occur on the real line , which is excluded from both half - planes .",
    "analyticity on a half - plane comes from asymptotic _ boundedness _ of the waveform @xmath18 , while singularities on the real line can occur because @xmath18 need not be asymptotically _",
    "vanishing_. ] @xmath43 , and can be immediately integrated in eq .",
    "( [ eq : int_eqn_field_kernel_decomp ] ) , returning a factor times @xmath44 and leaving residual kernels which are smooth functions of @xmath21 and @xmath23 .",
    "when @xmath45  the case studied in our previous paper  this leaves the integral in the same form as eq .",
    "( [ eq : wave_eqn_integral ] ) or eq .",
    "( [ eq : int_eqn_field_kernel_decomp ] ) , with @xmath46 and @xmath10 appropriately redefined .",
    "however , when @xmath47 , the factors multiplying @xmath19 and @xmath22 are different .",
    "this results in two different coefficient functions @xmath48 and @xmath49 , so that eq .",
    "( [ eq : int_eqn_field_kernel_decomp ] ) now takes the form @xmath50 where @xmath51 the roots of eq .",
    "( [ eq : left - right_dispersion ] ) are the solutions of the dispersion relation in the asymptotic regions : it is only where @xmath52 that @xmath44 can be singular",
    ".      equation ( [ eq : int_eqn_diff_asymptotics ] ) is the analogue , for a profile with asymmetric asymptotic regions , of eq .",
    "( 18 ) of part i. apart from the inclusion of @xmath29  which could have been included in part i , but was set to zero as we considered only backgrounds continuous at @xmath30  the only difference between these equations is the inequality of @xmath48 and @xmath49 in the asymmetric case .",
    "this apparently straightforward generalization requires a considerable amount of additional machinery to extract the scattering matrix in a similar manner to part i. there , we noted that , while the vanishing of @xmath46 at certain points on the real axis made the integral operator singular , it could be transformed into an invertible operator by an appropriate regularisation procedure @xcite , in which the regular part of the solution was isolated and found to obey a regularity condition for each zero of @xmath46 ; these could then be subtracted from the integral equation in such a way as to allow division by @xmath46 , leaving behind a non - singular equation .",
    "however , in eq .",
    "( [ eq : int_eqn_diff_asymptotics ] ) , the coefficient functions @xmath48 and @xmath49 have different roots ; there is thus a `` doubling '' of the number of singularities and @xmath49 may have different numbers of real roots . ] in @xmath31 , split between @xmath19 and @xmath22 , which are now singular at different points . while we can still isolate the regular parts of the solution and define a regularity condition at each of the zeros of @xmath48 and @xmath49 , the fact that these zeros are different means that regularising eq .",
    "( 12 ) such that one of the two coefficient functions can be divided out still leaves the other intact , leaving coupled integral equations that can not be solved directly .    to deal with this",
    ", we first split the integral equation into two parts , each containing only one of the coefficient functions @xmath53 and each of which can be regularised according to the procedure of part i. this splitting of the integral equation constitutes the additional machinery required in the asymmetric case , and it is effected by exploiting the analyticity properties of the @xmath44 described above .",
    "it is inspired by a similar method used to solve the _ riemann - hilbert problem _",
    "@xcite , to which the integral equation reduces in the case of a piecewise homogeneous background with a step discontinuity . in section [ sec : step - discontinuous_background ] , attention is focused on this case in order to acquaint ourselves with the new machinery ; the generalisation to arbitrary velocity profiles is described in section [ sec : general_background ] , unifying the riemann - hilbert elements introduced in section [ sec : step - discontinuous_background ] with the non - trivial integral kernels considered in part i.    there is one final caveat to be mentioned here : we shall restrict ourselves to coefficient functions @xmath53  and equivalently to dispersion relations @xmath54  which are _ polynomials _ , and whose roots we know or can calculate efficiently . this is because , in the new machinery inherited from the riemann - hilbert problem , we shall require some analytic manipulations of the @xmath53 , similar to the splitting of the solution and the kernel into half - plane analytic parts . for general @xmath53 ,",
    "this is non - trivial and computationally intensive ; for polynomials , by contrast , many of these manipulations can be done `` by hand '' .",
    "we shall not need to make any restrictions on the degree of these polynomials  in particular , we are _ not _ reintroducing the restriction to low - degree polynomial dispersion relations required for stable numerical solution of odes .",
    "indeed , given an arbitrary dispersion relation , we can find a polynomial approximation to it over any finite range of @xmath21 ; so long as the wavevectors of interest are contained within this range , and no additional real roots are generated outside this range , we expect this polynomial approximation to return a very good approximation to the scattering amplitudes .",
    "the simplest situation with asymmetric asymptotic regions in that in which the velocity profile is uniform everywhere except for a step discontinuity",
    ". it will be instructive to first consider this case , for its solution deals with the essential complications arising from asymptotic asymmetry .",
    "generalisation to arbitrary profiles involves unifying this method with the inversion of non - trivial integral kernels described in part i , and will be treated in section [ sec : general_background ] .      adopting a step - discontinuous profile amounts , at the level of the integral equation ( [ eq : int_eqn_diff_asymptotics ] ) , to setting @xmath55 and @xmath56 to zero , while @xmath29 , which is that part of the kernel ( [ eq : unruh_kernel ] ) coming from the ( singular ) derivatives of @xmath36 and @xmath57 , is non - zero : @xmath58 where @xmath59 and where we have defined @xmath60 noting that @xmath61 is just a number , eq .",
    "( [ eq : step_rh ] ) is a _ non - normal inhomogeneous riemann - hilbert problem _",
    "@xcite : a functional equation between the boundary values of two functions analytic in neighbouring regions of the complex plane , which in this case are the upper and lower half - planes , the boundary being the real axis .",
    "it is _ inhomogeneous _ because it contains a term not proportional to @xmath44 .",
    "more importantly , it is _ non - normal _ because the coefficient functions @xmath53 vanish at discrete points on the real axis , allowing the solutions @xmath44 to be singular at these points . as for integral equations ,",
    "this renders the equation non - invertible and the solutions non - unique , and due to linearity ) is linear in the sense that @xmath61 , as defined in eq .",
    "( [ eq : phi0_defn ] ) , scales linearly with @xmath62 . if instead @xmath61 is considered as fixed , the equation is no longer linear and the solutions are restricted to a hypersurface rather than spanning a whole vector space .",
    "] of the equation , there is a vector space of solutions .",
    "as mentioned in part i , the dimension @xmath63 of this vector space is the number of ingoing or outgoing asymptotic wavevector solutions , equal to half of the total number of ( real ) asymptotic wavevector solutions .",
    "it was expressed in ",
    "[ sub : complications_due_to_asymmetry ] that the functions @xmath53 shall be restricted to polynomials whose roots are known . for a dispersive medium",
    ", @xmath54 is then a polynomial of even degree larger than @xmath64 , and it thus follows that the coefficient of the highest power of @xmath21  call it @xmath65  is the same for both @xmath48 and @xmath49 .",
    "moreover , we shall assume that the medium is non - dissipative in the asymptotic regions , so that incoming waves can be incident from infinity ; this implies that the @xmath53 are _ real _ polynomials , and that complex roots must occur in complex conjugate pairs .",
    "therefore , we can write @xmath66 here , there are @xmath67 real roots @xmath68 of @xmath53 , and @xmath69 pairs of complex roots @xmath70 .",
    "the degree of @xmath53 is @xmath71 , and is independent of @xmath72 .",
    "the roots of @xmath53 are the solutions of the dispersion in asymptotic region @xmath72 , so that the general solution there is a sum of plane waves of the form @xmath73 . but physical solutions must be asymptotically bounded , so that certain of these plane waves are physically forbidden .",
    "all real wavevectors are allowed ( though they can be separated into ingoing and outgoing waves according to the signs of their group velocities  see  ii of part i ) , while only those complex wavevectors that generate asymptotically vanishing evanescent waves are allowed ; these have @xmath74 < 0 $ ] on the left - hand side , and @xmath75 > 0",
    "$ ] on the right - hand side . for definiteness",
    ", we define @xmath76 to be the allowed wavevectors in asymptotic region @xmath72 , while @xmath77 will be the exponentially divergent forbidden wavevectors .",
    "we shall soon see that the analyticity of the first and second terms of eq .",
    "( [ eq : step_rh ] ) on the upper and lower half planes , respectively , allows the sought - for splitting of the equation , while the asymptotic divergence of the equation determines the number of degrees of freedom in the solution .",
    "it is possible to tame the asymptotic divergence  zooming in on the actual degrees of freedom  while leaving the analyticity of the first two terms in tact .",
    "this is done by dividing out all of the factors @xmath78 , where the @xmath79 are the forbidden wavevectors ; it leaves us with the equivalent equation @xmath80 where we have defined @xmath81 and where by @xmath82 we mean the opposite asymptotic region from that denoted by @xmath72 .",
    "equation ( [ eq : step_rh_kappa_unsplit ] ) is thus split into half - plane analytic parts if @xmath83 is itself split in this way . indeed ,",
    "since @xmath29 is a first - degree polynomial , @xmath83 is exactly a sum of poles , one at each of the forbidden wavevectors .",
    "collecting those on the lower half plane together gives that part of @xmath83 which is analytic on the upper half plane , and vice versa .",
    "therefore , we can write @xmath84 where    @xmath85    [ eq : kappa_split ]    the superscript on @xmath86 indicates that it is analytic on the same half plane as @xmath44",
    ".    finally , we can rewrite eq .",
    "( [ eq : step_rh_kappa_unsplit ] ) in the form @xmath87 the left - hand side of eq .",
    "( [ eq : step_rh_analytic ] ) is manifestly analytic on the upper half plane , and the right - hand side on the lower half plane .",
    "both sides are thus equal to an _ entire _ function ( _ i.e. _ one that is analytic everywhere ) .",
    "this entire function is restricted by the asymptotic behaviour of eq .",
    "( [ eq : step_rh_analytic ] ) as @xmath88 .",
    "we have noted that @xmath44 behaves asymptotically like @xmath89 , and it is clear from ( [ eq : kappa_split ] ) that @xmath86 behaves similarly . from eq .",
    "( [ eq : g_tilde_defn ] ) we see that @xmath90 where @xmath91 , which is the number of ingoing or outgoing waves . as a whole , then , eq . ( [ eq : step_rh_analytic ] ) behaves asymptotically like @xmath92 , and the entire function to which it is equal behaves in the same way .",
    "the only entire function with the correct asymptotic behaviour is a polynomial of degree @xmath93 , which has @xmath63 degrees of freedom  exactly the number of degrees of freedom in the space of ( asymptotically bounded ) solutions .",
    "then , in place of eq",
    ". ( [ eq : step_rh_analytic ] ) , we can write two equations :    @xmath94    [ eq : step_rh_split ]    where the @xmath95 are an arbitrarily chosen set of @xmath63 linearly independent polynomials of degree at most @xmath93 .    in eqs .",
    "( [ eq : step_rh_split ] ) , we have managed to split the original equation , which combined two singular components with singularities at different points , into two equations , each containing only one of the sets of singularities . each of eqs .",
    "( [ eq : step_rh_split ] ) can now be subjected to the regularisation procedure described in part i.      following   iv c - d of part i , we first split the solutions @xmath44 into parts which are singular and regular on the real axis ; the singular parts are generated by the propagating waves which are non - vanishing at infinity , while the regular parts are related to the evanescent waves which are only prominent near @xmath30 .",
    "we write : @xmath96 \\ , .",
    "\\label{eq : psi_singular_decomposition}\\ ] ] the terms in square brackets are the half - fourier transforms of plane waves , so that the coefficients @xmath97 are precisely the amplitudes of these plane waves with unit amplitude .",
    "they are not normalised ; they become normalised upon multiplication by @xmath98 .",
    "normalisation is taken into account , as in part i , by a simple transformation of the scattering matrix ( see eq .",
    "( [ eq : scattering_matrix_normalized ] ) ) .",
    "] in the waveform @xmath18 .",
    "the additional contributions @xmath99 are regular for all real @xmath21 . substituting eqs .",
    "( [ eq : psi_singular_decomposition ] ) into eqs .",
    "( [ eq : step_rh_split ] ) and integrating over the @xmath100 functions and poles , we find a pair of equations for the @xmath101 : @xmath102 + \\frac{1}{2 } \\sum_{j=1}^{n_{-\\sigma}^{r } } \\mathcal{a}_{j}^{-\\sigma } \\kappa^{\\sigma}(k ) + s_{\\sigma } \\ , \\sum_{j=1}^{n } p_{j } \\ , p_{j}(k ) \\ , = \\ , 0 \\ , , \\label{eq : step_alpha_int}\\end{gathered}\\ ] ] where we have defined @xmath103 , and where we have replaced @xmath61 with its explicit form as an integral ( see eq .",
    "( [ eq : phi0_defn ] ) ) .    while eqs .",
    "( [ eq : step_alpha_int ] ) have the same general form as eqs . ( [ eq : step_rh_split ] ) and remain non - invertible , we have defined @xmath99 to be regular for all real @xmath21 .",
    "thus , when @xmath21 approaches a zero of @xmath104 , the first term of one of eqs .",
    "( [ eq : step_alpha_int ] ) vanishes .",
    "this yields two sets of regularity conditions , one for the real roots of @xmath105 , and another for the real roots of @xmath106 : @xmath107 \\\\",
    "+ \\frac{1}{2 } \\sum_{j=1}^{n_{-\\sigma}^{r } } \\mathcal{a}_{j}^{-\\sigma } \\kappa^{\\sigma}\\left(k_{\\sigma , i}^{r}\\right ) + s_{\\sigma } \\sum_{j=1}^{n } p_{j } \\ , p_{j}\\left(k_{\\sigma , i}^{r}\\right ) \\ , = \\ , 0 \\ , .",
    "\\label{eq : step_reg_conds}\\end{gathered}\\ ] ] as in  iv d of part i ( using a procedure inspired by bart and warnock @xcite ) , we note that eqs .",
    "( [ eq : step_alpha_int ] ) can be transformed into invertible equations by subtraction of regularity conditions ( [ eq : step_reg_conds ] ) times functions @xmath108 such that @xmath109 , followed by division by @xmath104 .",
    "a convenient such set of functions can be constructed from the coefficient functions @xmath104 themselves : @xmath110 applying this procedure leads to the equations @xmath111 overbars  in conjunction with @xmath72 superscripts  have been used to indicate that functions have been transformed according to the procedure outlined above : for an arbitrary function @xmath112 , we have @xmath113 finally , we may add the two of eqs .",
    "( [ eq : step_regular_alpha ] ) ( with @xmath114 and @xmath115 ) together to get a single invertible equation for the single unknown function @xmath116 : @xmath117 where we have defined @xmath118 we note the minus sign that appears in the definition of @xmath119 .",
    "this can be understood by considering the degenerate case @xmath45 : since in that case @xmath18 is simply a sum of plane waves , @xmath116 must be zero ; and similarly , the vanishing of @xmath29 in eq .",
    "( [ eq : k_step ] ) means that @xmath120 is zero .",
    "this minus sign thus ensures that the last term on the left - hand side of eq .",
    "( [ eq : int_alpha_invertible ] ) also vanishes , maintaining equality with the right - hand side .",
    "equation ( [ eq : int_alpha_invertible ] ) can be written in the form @xmath121 \\alpha(k^{\\prime } ) = -\\sum_{j=1}^{n } p_{j}\\,\\bar{p}_{j}(k ) - \\frac{1}{2 } \\bar{\\kappa}(k ) \\",
    ", \\left ( \\sum_{j=1}^{n_{l}^{r } } \\mathcal{a}_{j}^{l } + \\sum_{j=1}^{n_{r}^{r } } \\mathcal{a}_{j}^{r } \\right ) \\ , , \\label{eq : step_alpha_eqn}\\ ] ] which is the continuous limit of a matrix equation relating the vector @xmath122 to @xmath123 and @xmath124 .",
    "the kernel of the integral operator , @xmath125 , is likewise the continuous limit of a matrix , and is of a simple enough form that its inverse can be written explicitly : defining , for an arbitrary integrable function @xmath126 , its integral @xmath127 we have    @xmath128 = \\delta(k - k^{\\prime})\\ ] ]    where @xmath129    applying this inverse to eq .",
    "( [ eq : step_alpha_eqn ] ) , we find @xmath130 \\ , .",
    "\\label{eq : step_alpha_soln}\\ ] ] since @xmath120 and @xmath119 are simply sums over poles in the complex plane , the integrals @xmath131 and @xmath132 can also be evaluated explicitly :    @xmath133 \\ , , \\\\",
    "i_{\\bar{p}_{j } } & = & i\\pi \\left [ \\sum_{q=1}^{n_{r}^{c } } \\frac{p_{j}\\left(k_{r , q}^{c}\\right)}{\\tilde{g}_{r}^{\\prime}\\left(k_{r , q}^{c}\\right ) } + \\sum_{q=1}^{n_{l}^{c } } \\frac{p_{j}\\left(k_{l , q}^{c}\\right)}{\\tilde{g}_{l}^{\\prime}\\left(k_{l , q}^{c}\\right ) } \\right ] \\,.\\end{aligned}\\ ] ]    to transform eq .",
    "( [ eq : step_alpha_soln ] )  a solution for @xmath116 in terms of the coefficients of the propagating waves and of the basis polynomials  into a linear relation between the coefficients of the propagating waves , we must enforce the regularity conditions ( [ eq : step_reg_conds ] ) , which now act as consistency relations .",
    "there are @xmath134 of these  exactly the number required to reduce the @xmath135 degrees of freedom present in eq .",
    "( [ eq : step_alpha_soln ] ) to the @xmath63 degrees of freedom of the space of solutions of the wave equation .",
    "integrating eq .",
    "( [ eq : step_alpha_soln ] ) , utilising the definitions ( [ eq : integral_defn ] ) , then substituting in eqs .",
    "( [ eq : step_reg_conds ] ) yields a set of @xmath136 linear equations ( @xmath137 for @xmath114 plus @xmath138 for @xmath115 ) in @xmath135 unknowns : @xmath139 + \\frac{1}{2 } \\sum_{j=1}^{n_{-\\sigma}^{r } } \\mathcal{a}_{j}^{-\\sigma } \\frac{\\kappa^{\\sigma}\\left(k_{\\sigma , i}^{r}\\right)}{1+i_{\\bar{\\kappa } } } \\\\ + \\sum_{j=1}^{n } p_{j } \\left [ s_{\\sigma } \\ , p_{j}\\left(k_{\\sigma , i}^{r}\\right ) - \\frac{i_{\\bar{p}_{j } } \\ , \\kappa^{\\sigma}\\left(k_{\\sigma , i}^{r}\\right)}{1+i_{\\bar{\\kappa } } } \\right ] \\ , = \\ , 0 \\ , .",
    "\\label{eq : step_linear_3n_unknowns}\\end{gathered}\\ ] ] for each value of @xmath72 , this is a linear equation relating the @xmath140-dimensional vector @xmath141 , the @xmath142-dimensional vector @xmath143 and the @xmath63-dimensional vector @xmath144 : @xmath145 where , making use of the abbreviations @xmath146 the matrix elements are given by    @xmath147_{ij } & = & \\frac{1}{2 } \\left [ \\frac{s_{\\sigma}}{i \\ , \\pi } \\ , \\tilde{g}^{\\prime}_{\\sigma , i } \\ , \\delta_{ij } + \\frac{\\kappa_{i}^{\\sigma}}{1+i_{\\bar{\\kappa } } } \\right ] \\ , , \\\\",
    "\\left [ \\mathcal{m}^{\\sigma}_{\\,\\,-\\sigma } \\right]_{ij } & = & \\frac{1}{2 } \\ , \\frac{\\kappa_{i}^{\\sigma}}{1+i_{\\bar{\\kappa } } } \\ , , \\\\ \\left [ \\mathcal{p}^{\\sigma } \\right]_{ij } & = & s_{\\sigma } \\ , p_{ij}^{\\sigma } - \\frac{\\kappa_{i}^{\\sigma } \\ , i_{\\bar{p}_{j}}}{1+i_{\\bar{\\kappa } } } \\,.\\end{aligned}\\ ] ]    [ eq : step_matrix_elements ]",
    "although we have managed to reduce the problem to a linear equation of the form ( [ eq : step_matrix_eqn ] ) , it is not yet in soluble form because in general the unknown vectors have different dimensions and the matrices are not square .",
    "it is for this reason that the in- and out - bases are so useful , since they necessarily have the same dimension .",
    "therefore , we seek a way of rearranging the linear system ( [ eq : step_matrix_eqn ] ) in terms of @xmath148 and @xmath149 , making the matrices square and allowing inversion of them so that @xmath144 can be eliminated . to this end",
    ", we introduce the label @xmath150 which takes the values ` in ' and ` out ' to indicate whether a given wave is ingoing or outgoing , and relabel the waves and their amplitudes using @xmath150 rather than @xmath72 .",
    "this relabelling can be described by a set of four ( generally non - square ) projection operators @xmath151 : the @xmath152 $ ] element of @xmath151 is equal to @xmath153 if the wavevector @xmath154 is the same as the wavevector @xmath155 , and @xmath156 otherwise .",
    "the vectors @xmath157 are then related to the vectors @xmath158 via @xmath159 the inverse of this equation is effected by means of projection operators @xmath160 , which are just the transposes of the projection operators in ( [ eq : sigma_to_rho ] ) : @xmath161^{t } \\ , .",
    "\\label{eq : rho_to_sigma}\\end{aligned}\\ ] ]    the @xmath72 component of eq .",
    "( [ eq : step_matrix_eqn ] ) has dimension @xmath162 , and is compatible with left multiplication by @xmath151 for both values of @xmath150 .",
    "since each row and column of @xmath151 has at most one non - zero element , this corresponds to selecting some of the rows of eq .",
    "( [ eq : step_matrix_eqn ] ) and setting the others to zero .",
    "however , since each wavevector lies in one of the asymptotic regions , each zero row of @xmath151 must be non - zero in @xmath163 , and each non - zero row of @xmath151 must be zero in @xmath163 . therefore , left multiplication of the @xmath72 component of ( [ eq : step_matrix_eqn ] ) by @xmath151 rearranges the equations into @xmath63 rows , some of which are zero ; and left multiplication of the @xmath82 component of ( [ eq : step_matrix_eqn ] ) by @xmath163 does the same thing , with the zero rows and non - zero rows switched . adding the results together gives a rearranged set of @xmath63 rows of equations , none of which vanishes . performing the same manipulation with @xmath150 replaced by @xmath164",
    ", we recover a linear system similar to ( [ eq : step_matrix_eqn ] ) , but with all vectors of dimension @xmath63 and all matrices @xmath165 : @xmath166 where the matrices are related to those with @xmath72 labels via @xmath167 the matrices @xmath168 are invertible , and we can solve both of eqs .",
    "( [ eq : step_matrix_in - out ] ) for @xmath144 . setting these equal",
    ", straightforward manipulation yields the sought - for equation @xmath169 with the scattering matrix @xmath170^{-1 } \\ , \\left [ \\mathcal{p}^{\\mathrm{in}\\,-1}\\mathcal{m}^{\\mathrm{in}}_{\\,\\,\\mathrm{in } } - \\mathcal{p}^{\\mathrm{out}\\,-1}\\mathcal{m}^{\\mathrm{out}}_{\\,\\,\\mathrm{in } } \\right ] \\ , .",
    "\\label{eq : step_scattering_matrix}\\ ] ]    finally , if required , we can transform @xmath171 into a scattering matrix @xmath172 between normalized waves . the normalization factor for the plane wave with wavevector @xmath173",
    "is @xmath174 . arranging these into two diagonal matrices @xmath175 and @xmath176 , we have @xmath177      although numerics are required to evaluate the roots of the dispersion relation and to perform the matrix operations required to reach the final scattering matrix , the solution calculated here is in principal exact , limited only by numerical precision . in particular ,",
    "the integrals can be performed analytically ; there is no need for discretisation to perform numerical integration or numerical inversion of an integral kernel , both of which have an accuracy limited by the spacing of the discretised grid .",
    "it should be noted that the availability of an exact solution for the step discontinuous background is not new . from an ode in position space",
    ", one can derive matching conditions for @xmath5 at the discontinuity , resulting in a system of linear equations relating the amplitudes of the plane waves on either side @xcite .",
    "the method we have outlined here is equivalent , differing simply in that it views the problem from fourier space rather than position space .",
    "it turns out that this allows a neater way of dealing with the complex wavevectors , for while these must be explicitly included in the position space solution , resulting in a linear system of potentially very large dimension , the fourier space approach wraps up their entire contribution in the @xmath178 integrals @xmath131 and @xmath132 which appear in the matrix elements of eqs .",
    "( [ eq : step_matrix_elements ] ) .",
    "it can not be said , however , that this significantly improves the efficiency of the numerical procedure .",
    "rather , the fourier space approach to the step discontinuous background should be viewed as a precursor to the fourier space approach to an arbitrary background , to which we now turn .",
    "having solved for the scattering matrix of a step discontinuous background , and having introduced the additional machinery necessary to separate the singular operators associated with the left- and right - hand asymptotic regions , we now set about generalising the procedure to an arbitrary background which is asymptotically asymmetric . since",
    "much of the development here is directly analogous to that of section [ sec : step - discontinuous_background ] , such points are treated here only briefly , while attention is paid to the notable differences .",
    "we shall assume that the background is continuous at @xmath30 , so that @xmath29 of eq . (",
    "[ eq : kernel_decomposition ] ) vanishes .",
    "our starting point is therefore the first line of eq .",
    "( [ eq : int_eqn_diff_asymptotics ] ) .",
    "the kernel @xmath10 can be split into two parts which are analytic and @xmath179 on opposite halves of the complex @xmath23-plane .",
    "division by the `` forbidden '' roots of the dispersion relations proceeds as before , but instead of a single function of a single variable in eq .",
    "( [ eq : kappa_defn ] ) , we now have two functions of two variables : @xmath180 where , as before , @xmath72 takes the values @xmath27 and @xmath28 , and as a subscript indicates the analyticity in the primed argument @xmath23 . following the procedure outlined in ",
    "[ sub : splitting_into_half - plane_analytic_parts ] , we find that we have to split @xmath181 into half - plane analytic parts of the _ un_primed variable @xmath21 .",
    "although they do not behave like @xmath20 asymptotically , the @xmath43 are analytic on a half - plane , so what remains is to rearrange the poles at the `` forbidden '' wavevectors .",
    "we can write @xmath182 where the coefficients @xmath183 are given in eqs .",
    "( [ eq : kappa_split ] ) . of the terms of the right - hand side of eq .",
    "( [ eq : poles_separated ] ) , the first is analytic on the lower half plane , and the second on the upper half plane . on multiplication by @xmath43 , one of the two products is automatically analytic on a half plane , while the other is non - analytic only due to a discrete set of poles , which can be subtracted and moved over to the other term .",
    "explicitly , we have : @xmath184 where    @xmath185    [ eq : general_kappa_defns ]    note that we have assumed that we know not only the boundary value of @xmath43 when @xmath21 is real , but also its values for complex @xmath21 on the half plane where it is analytic .    to be clear about notation",
    ", we emphasise here that the @xmath72 _ sub_script refers to which half - fourier transform of the waveform the particular kernel acts on , and thus to its analyticity in the primed coordinate @xmath23 ( _ i.e. _ that which is integrated over ) . as a _ super_script",
    ", however , @xmath72 refers to the analyticity in the _ un_primed coordinate , and points to the corresponding half - fourier transform of the waveform which has the same analyticity .    splitting the kernels according to eqs .",
    "( [ eq : general_kappa_split])-([eq : general_kappa_defns ] ) , we are once again led to an equality between two functions of @xmath21 which are manifestly analytic on opposite half planes , and are thus equal to an entire function . by considering the asymptotic behaviour of this function ,",
    "we are led to the conclusion that it must be a polynomial of degree at most @xmath93 , where @xmath63 is the number of ingoing or outgoing waves .",
    "we can thus write the generalised versions of eqs .",
    "( [ eq : step_rh_split ] ) :    @xmath186    @xmath187    [ eq : general_split_int_eqns ]      upon splitting the solutions @xmath44 into their singular and regular parts as in eq .",
    "( [ eq : psi_singular_decomposition ] ) and substituting into eqs .",
    "( [ eq : general_split_int_eqns ] ) , we are led to the analogue of eqs .",
    "( [ eq : step_alpha_int ] ) : @xmath188 + \\sum_{j=1}^{n_{-\\sigma}^{r } } \\mathcal{a}_{j}^{-\\sigma } \\ , \\kappa_{\\,\\,-\\sigma}^{\\sigma}\\left(k , k_{-\\sigma , j}^{r}\\right ) \\ , = \\ , 0 \\ , .",
    "\\label{eq : general_alpha_int}\\end{gathered}\\ ] ] here , we have defined @xmath189 and noted that , due to their analyticity properties , the @xmath190 and @xmath191 components of the integrand can be added separately because the cross terms vanish upon integration . by definition ,",
    "the @xmath99 are regular on the real axis , so sending @xmath192 yields two sets of regularity conditions , @xmath137 for @xmath114 and @xmath138 for @xmath115 : @xmath193 + \\sum_{j=1}^{n_{-\\sigma}^{r } } \\mathcal{a}_{j}^{-\\sigma } \\ , \\kappa_{\\,\\,-\\sigma}^{\\sigma}\\left(k_{\\sigma , i}^{r},k_{-\\sigma , j}^{r}\\right ) = 0 \\ , .",
    "\\label{eq : general_reg_conds}\\end{gathered}\\ ] ] by the same procedure used in ",
    "[ sub : regularisation_of_the_equation ]  whereby each of the regularity conditions ( [ eq : general_reg_conds ] ) is multiplied by the corresponding function ( [ eq : unit_functions ] ) and subtracted from eq .",
    "( [ eq : general_alpha_int ] ) , after which @xmath104 can be divided out  we are led to the analogue of eqs .",
    "( [ eq : step_regular_alpha ] ) : @xmath194 where the definition of the overbar is the same as in eq .",
    "( [ eq : overbar_defn ] ) .",
    "as in  [ sub : regularisation_of_the_equation ] , we can add the @xmath114 and @xmath115 components of eq .",
    "( [ eq : general_regular_alpha ] ) together , yielding a single equation for @xmath103 : @xmath195 where we have defined @xmath196 and where @xmath119 is defined as in eqs . ( [ eq : overbarred_kappa_p_defns ] ) .",
    "equation ( [ eq : general_int_alpha_invertible ] ) is invertible , _",
    "i.e. _ for any set of coefficients , @xmath116 can be solved for uniquely .",
    "however , given the general nature of the integral kernel @xmath197 , we can not invert the equation explicitly , and must instead resort to a numerical solution . in this sense , eq .",
    "( [ eq : general_int_alpha_invertible ] ) is more to be compared with eq .",
    "( 24 ) of part i. as there , we note that there exists an exact inverse kernel @xmath198 such that @xmath199 \\ , .",
    "\\label{eq : general_alpha_soln_exact}\\ ] ] upon discretisation for the purposes of numerics , eq .",
    "( [ eq : general_alpha_soln_exact ] ) becomes a matrix equation , the discretised kernels becoming matrices , and the discretised inverse kernel being @xmath200^{-1 } \\ , .",
    "\\label{eq : discrete_inverse_kernel}\\ ] ] this can be calculated efficiently using standard numerical algorithms .",
    "the only difference from ",
    "iv e of part i is that we have allowed the distance between points @xmath201 on the integration grid to depend on @xmath202 .",
    "this is in anticipation of a change of variables to improve convergence of the integral ( see appendix [ app : change_of_variables_for_numerical_integration ] ) .    the regularity conditions ( [ eq : general_reg_conds ] ) , which at this point act as consistency relations , must now be enforced by substituting into them the solution ( [ eq : general_alpha_soln_exact ] ) .",
    "this yields a set of @xmath136 linear equations in the @xmath135 unknowns @xmath203 , @xmath204 and @xmath205 . to avoid cumbersome expressions",
    ", we adopt the abbreviations @xmath206 and @xmath207 from eqs .",
    "( [ eq : abbreviations ] ) , as well as the following : @xmath208 the linear system of equations can now be written very succinctly as @xmath209 where the matrix elements are given by    @xmath147_{ij } & = & \\frac{s_{\\sigma}}{2\\pi i } \\",
    ", \\tilde{g}^{\\prime}_{\\sigma , i } \\ , \\delta_{ij } + \\kappa^{\\sigma}_{\\,\\,\\sigma , ij } - \\int_{-\\infty}^{+\\infty } \\int_{-\\infty}^{+\\infty } \\mathrm{d}k \\ , \\mathrm{d}k^{\\prime } \\ , \\kappa^{\\sigma}_{i}(k ) \\ , v(k , k^{\\prime } ) \\ , \\bar{\\kappa}_{\\sigma , j}(k^{\\prime } ) \\ , , \\qquad \\\\ \\left [ \\mathcal{m}^{\\sigma}_{\\,\\,-\\sigma } \\right]_{ij } & = & \\kappa^{\\sigma}_{\\,\\,-\\sigma , ij } - \\int_{-\\infty}^{+\\infty } \\int_{-\\infty}^{+\\infty } \\mathrm{d}k \\ , \\mathrm{d}k^{\\prime } \\ , \\kappa^{\\sigma}_{i}(k ) \\ , v(k , k^{\\prime } ) \\ , \\bar{\\kappa}_{-\\sigma , j}(k^{\\prime } ) \\ , , \\\\ \\left",
    "[ \\mathcal{p}^{\\sigma } \\right]_{ij } & = & s_{\\sigma } \\ , p^{\\sigma}_{ij } - \\int_{-\\infty}^{+\\infty } \\int_{-\\infty}^{+\\infty } \\mathrm{d}k \\ , \\mathrm{d}k^{\\prime } \\ , \\kappa^{\\sigma}_{i}(k ) \\ , v(k , k^{\\prime } ) \\ , \\bar{p}_{j}(k^{\\prime } ) \\,.\\end{aligned}\\ ] ]    [ eq : matrix_elements_exact ]    in discretised form , the integrals in eqs . ( [ eq : matrix_elements_exact ] ) become discrete sums , or equivalently products of matrices :    @xmath147_{ij } & = & \\frac{s_{\\sigma}}{2\\pi i } \\ , \\tilde{g}^{\\prime}_{\\sigma , i } \\ , \\delta_{ij } + \\kappa^{\\sigma}_{\\,\\,\\sigma , ij } - \\sum_{n , m } \\ , \\delta k_{n } \\cdot \\kappa^{\\sigma}_{i}\\left(k_{n}\\right ) \\ , v_{nm } \\,\\ , \\bar{\\kappa}_{\\sigma , j}\\left(k_{m}\\right ) \\ , , \\\\ \\left [ \\mathcal{m}^{\\sigma}_{\\,\\,-\\sigma } \\right]_{ij } & = & \\kappa^{\\sigma}_{\\,\\,-\\sigma , ij } - \\sum_{n , m } \\ , \\delta k_{n } \\cdot \\kappa^{\\sigma}_{i}\\left(k_{n}\\right ) \\ , v_{nm } \\,\\ , \\bar{\\kappa}_{-\\sigma , j}\\left(k_{m}\\right ) \\ , , \\\\ \\left [ \\mathcal{p}^{\\sigma } \\right]_{ij } & = & s_{\\sigma } \\ , p^{\\sigma}_{ij } - \\sum_{n , m } \\ , \\delta k_{n } \\cdot \\kappa^{\\sigma}_{i}\\left(k_{n}\\right ) \\ , v_{nm } \\,\\ , \\bar{p}_{j}\\left(k_{m}\\right ) \\,,\\end{aligned}\\ ] ]    [ eq : matrix_elements_discretised ]    where , as in part i",
    ", we have used the labels @xmath202 and @xmath210 to refer to points on the discretised integration grid , while @xmath211 and @xmath212 have been used to label the solutions of the dispersion relation .",
    "rearrangement of eq .",
    "( [ eq : lr_matrix_equation ] ) in terms of the in- and out - bases proceeds exactly as in  [ sub : rearrangement_into_the_scattering_matrix ] , leading again to the sought - for equations ( [ eq : scattering_matrix_eqn])-([eq : scattering_matrix_normalized ] ) .      in the general case considered here , the integrals that appear in eqs .",
    "( [ eq : matrix_elements_exact ] ) converge slowly , because the various factors in the integrands typically behave asymptotically like @xmath20 or @xmath213 . using a discretised integration with uniform spacing @xmath214 that is constant throughout the grid",
    ", this slow convergence would force us to take a large integration interval , and hence many points , greatly slowing down the numerical calculations .",
    "using such a large number of points to represent a simple @xmath20 behaviour would be very wasteful , and we seek a more economical approach .",
    "one way would be , as in part i , to cut off the discretised integration grid at a finite value of @xmath21 beyond which the integrands are approximately proportional to @xmath215 , and to perform the remainder of the integral analytically .",
    "this approach , however , complicates the numerical calculation of the inverse kernel @xmath198 .    instead , a change of variables is implemented ( see appendix [ app : change_of_variables_for_numerical_integration ] for details ) which maps the infinite integration range of @xmath21 to a finite interval of a new variable @xmath216 .",
    "careful placing of the jacobian of the variable transformation cancels out the @xmath20 convergence , so that the integrals to be evaluated can be considered as integrals of bounded functions over a finite interval .",
    "these transformed integrals can then be evaluated numerically .",
    "the spacing @xmath217 is chosen to be uniform , inducing a non - uniform spacing @xmath218 in the @xmath21-representation .",
    "since the new integration range is finite , we do not need to choose the limits ( as we did in part i ) , but instead there is a parameter @xmath219 in the change of variables which determines the scale of the @xmath216-representation near @xmath220 .",
    "the scaling parameter @xmath219 should be chosen such that ( roughly speaking ) the non - trivial part of the integral lies inside @xmath221 , for the integrand outside this region is packed into a narrow region of @xmath216-space , and should be as near as possible to the asymptotic @xmath20 behaviour in order to avoid sharp features whose resolution would require a very small @xmath222 .",
    "here we shall illustrate the applicability of the methods described in   [ sec : step - discontinuous_background ] and [ sec : general_background ] by considering simple concrete examples .",
    "these shall be based on the examples used in ",
    "v of part i , so that the results may be compared with those presented there .      as in part",
    "i , we shall consider two dispersion relations : one is a low - degree polynomial which can be treated using standard ode solution methods ; the other is a more complicated function not amenable to such techniques , which we shall approximate within the relevant region of @xmath21-space as a polynomial of relatively high degree .",
    "after suitable normalisation ( see  5.1 of part i ) , these dispersion relations are @xmath223 the first describes surface waves in water when surface tension is negligible and the height of the water can be treated as constant @xcite ; the second is chosen to be the second - order taylor expansion of the first around @xmath220 .",
    "on plotting the doppler shifted dispersion relations as viewed in the stationary frame , the first of eqs .",
    "( [ eq : model_dispersion_relations ] ) is found to predict a hawking spectrum which is entirely contained within the interval @xmath224 . a polynomial approximation to this dispersion curve",
    "is found by discretising this interval into @xmath225 points and performing a least - squares fit of a polynomial of @xmath226 degree .",
    "the dispersion relations ( [ eq : model_dispersion_relations ] ) and the polynomial approximation to the first are all plotted in figure [ fig : dispersion_relations ] .",
    "the following form of the velocity profile is used , as it smoothly interpolates between two different asymptotic values : @xmath227 at @xmath220 , the ( normalised ) wave speed is @xmath153 , so where @xmath228 crosses @xmath153 is the analogue of the event horizon .",
    "we take @xmath229 and @xmath230 .",
    "the medium is thus flowing to the left , and its speed increases in the direction of flow , so where @xmath231 ( at @xmath30 ) is a black hole horizon .",
    "( there is no white hole horizon as in part i : allowing for different asymptotic velocities allows us to study a single horizon in isolation . ) with @xmath232 and @xmath233 fixed , the remaining parameter @xmath234 controls the steepness of the profile  or , by analogy with gravitational black holes , the `` surface gravity '' . as in part",
    "i , we shall consider two values of @xmath234 , one of which gives a slow variation of @xmath36 and the other a rapid variation .",
    "for the sake of comparison , we shall choose these values such that the radiation temperatures given by the analogue of hawking s original prediction @xcite , @xmath235 where @xmath236 is the position of the horizon , are the same here as for the corresponding cases in part i. these predicted temperatures are @xmath237 and @xmath238 for the slowly - varying and rapidly - varying profiles , respectively , and correspond here to @xmath239 and @xmath240 .",
    "the velocity profiles are plotted in figure [ fig : velocity_profiles ] .",
    "as remarked in part i , waves of equal conserved frequency @xmath15 can be scattered into each other by an inhomogeneous flow , where @xmath15 is related to the frequency @xmath241 in the rest frame of the fluid by the doppler formula @xmath242 the curves for each asymptotic region are shown in figure [ fig : dispersion_in_stationary_frame ] . restricting our attention to the counter - propagating branch of the dispersion curve ( those waves which are right - moving with respect to the medium ) , hawking radiation occurs when wavevectors of opposite sign couple to each other .",
    "but when the asymptotic velocities are different as here , we must also pay attention to the signs of the group velocities of the various wavevectors , _",
    "i.e. _ to their ingoing or outgoing character . in part",
    "i , there were two possible radiation channels ; in the case considered here , one of the waves which could be emitted before can no longer be emitted because it only exists as an incoming wave , and hence we are left with only one radiation channel . as we are considering a black hole horizon , this radiation is the analogue of the standard hawking radiation : each member of the pair is long - wavelength , and they are emitted in opposite directions .",
    "as in part i , we plot the hawking spectra using the frequency - dependent effective temperature @xmath243 the spectra for both the slowly - varying ( @xmath239 ) and rapidly - varying ( @xmath240 ) cases are shown in figure [ fig : hawking_spectra ] .",
    "spectra for both of dispersion relations ( [ eq : model_dispersion_relations ] ) are given , the first having been approximated by a high - degree polynomial as described in ",
    "[ sub : dispersion_relation ] .",
    "as we might have expected , the spectra are seen to agree with hawking s original prediction in the slowly - varying case , but not in the rapidly - varying case ; in the latter , the spectra are still well - described by a constant temperature at low frequencies , but this temperature is less than hawking s prediction and depends on the details of the dispersion . also shown",
    "are the results of solving the position - space ode for the low - degree polynomial dispersion ; these are seen to agree very well with the results of the integral method presented here , demonstrating its validity .    in figures [ fig : convergence_lp ] and [ fig : convergence_hp ] is shown how the calculated spectra converge for the slowly - varying velocity profile as the number of points @xmath244 in the discretised integration grid increases , with @xmath244 taking the values @xmath245 , @xmath225 and @xmath246 .",
    "( the scaling parameter @xmath219 is fixed at @xmath64 ; see appendix a for its definition . )",
    "figure [ fig : convergence_lp]@xmath247 shows the spectra for the low - degree polynomial dispersion ( the second of dispersion relations ( [ eq : model_dispersion_relations ] ) ) , while in figure [ fig : convergence_lp]@xmath248 is shown the overall discrepancy @xmath249 in the norm between ingoing and outgoing solutions : @xmath250 where @xmath251 and @xmath252 are the scattering amplitudes into modes of the same and opposite norm , respectively .",
    "( see  ii of part i for a description of norm and its conservation . ) for an exact solution , this must be zero , and we see that it decreases in magnitude as @xmath244 is increased .",
    "figure [ fig : convergence_hp ] shows the same information for the high - degree polynomial approximation of the first of dispersion relations ( [ eq : model_dispersion_relations ] ) .",
    "interestingly , the solution for the high - degree polynomial converges faster than that for the low - degree polynomial , whose discrepancy is visible in the spectrum and explains the slight mismatch seen with the results of the ode solution in fig .",
    "[ fig : hawking_spectra]@xmath247 .",
    "this trend occurs also for the rapidly - varying velocity profile , though both values of @xmath249 are an order of magnitude smaller than their counterparts in figs .",
    "[ fig : convergence_lp]@xmath248 and [ fig : convergence_hp]@xmath248 , while the differences in the spectra for different @xmath244 are too small to discern , much like in fig .",
    "[ fig : convergence_hp]@xmath247 .",
    "in a previous paper ( part i ) , it was shown that the scattering of dispersive waves in one spatial dimension can be solved using an integral method in fourier space , which is more generally applicable than the standard methods of directly solving an ode in position space . there , however , the method was restricted to situations in which the background was the same in both the left- and right - hand asymptotic regions .",
    "the current paper generalises this integral method to cases in which the asymptotic backgrounds are not symmetric .",
    "as before , the method utilises the analyticity properties of the half - fourier transforms of the solution . in order to reduce the calculational complexity of the method ,",
    "the dispersion relation has been restricted to a polynomial , but no restriction has been placed on the degree of this polynomial , allowing an arbitrary dispersion relation to be approximated by a polynomial within a given region of interest . increasing the degree of this polynomial will slow the calculation as it will increase the number of complex wavevector solutions , but this is typically much less than the number of points on the discretised integration grid , and it is the latter that is dominant in determining the required amount of computation . when the degree of the polynomial dispersion relation is small , solution of the position - space ode is possible , and the integral method has been shown to agree with the ode solution in such a case .    it is also to be noted that , taking the difference in norm between incoming and outgoing waves as a measure of the accuracy of the numerical method , the results for the asymmetric velocity profile considered in section [ sec : application ] are much less accurate than the results for the symmetric velocity profile of part i , with comparable model and discretisation parameters . as we have seen , asymmetry of the asymptotic regions substantially complicates the details of the integral method , and it is quite likely that the numerical scheme adopted here ( as described in the appendices ) is not the optimal one .",
    "how numerical optimisation might proceed , however , is unclear at the present time .",
    "i wish to thank ulf leonhardt for helpful discussions and guidance on the work whose results are presented here .",
    "i also thank south china normal university and the weizmann institute of science for their hospitality and financial support during the period in which this work was done .",
    "the change of variables implemented for the purpose of numerical integration is given by the equivalent formulae ( for @xmath253 ) @xmath254 around @xmath220 or @xmath255 , the relation is linear , so that the change of variables corresponds simply to a rescaling of @xmath21 with scaling parameter @xmath219 . as @xmath256 ,",
    "the corresponding value of @xmath21 diverges , and the infinite integration range @xmath257 is thus mapped onto the finite interval @xmath258 . in the transformation of integrals , we must also multiply by the jacobian @xmath259 , where @xmath260 as @xmath261 or @xmath256 , we have @xmath262 , so multiplication of this factor by a product of two function each of which behaves asymptotically like @xmath20 results in a finite limiting value as @xmath256 .",
    "it is convenient to distribute the factor @xmath259 equally between the two factors ; that is , each function appearing in the integrand , when the change of variable from @xmath21 to @xmath216 is effected , is multiplied by @xmath263 .",
    "those functions with a @xmath20 asymptotic behaviour thus approach a finite limiting value as @xmath256 , so that each term of the integrand is well - behaved at the boundaries of the integral over @xmath216 .",
    "it is important to check that the inverse kernel @xmath198 is also well - behaved after the change of variables ( [ eq : change_of_variables ] ) , and that it still corresponds to a straightforward matrix inverse in its discretised form . indeed , using the following equation for the change of variables of the @xmath100 function : @xmath264^{-1/2 } \\ , \\delta(\\zeta-\\zeta^{\\prime } ) \\,,\\ ] ] it is straightforward to show that the defining equation for the transformed inverse kernel becomes @xmath265 = \\delta(\\zeta-\\zeta^{\\prime } ) \\label{eq : inverse_kernel_zeta}\\ ] ] where    @xmath266    so the transformed @xmath267 , including left- and right - multiplication by @xmath263 , is itself an inverse kernel and can be calculated by discretising the interval @xmath258 of @xmath216 with uniform spacing @xmath222 .",
    "the change of variables described in this appendix copes well with the @xmath20 behaviour of the functions to be integrated , so long as we are careful to choose @xmath219 such that no non - trivial structures in the integrand are pushed towards the boundaries at @xmath268 , since this would squeeze them into a narrow region of @xmath216-space and require a very small spacing @xmath217 to be integrated accurately .",
    "here we shall say a few words regarding the numerical implementation of eqs .",
    "( [ eq : matrix_elements_exact ] ) , or more precisely of their discretised versions ( [ eq : matrix_elements_discretised ] ) .",
    "although these equations are substantially more complicated than their counterparts in part i , the considerations of appendix b of part i still apply . in particular ,",
    "when calculating a spectrum over which @xmath15 varies , we calculate the large @xmath15-independent matrices of order @xmath269 ( where @xmath244 is the number of points in the discretised integration grid ) at the outset , before calculation of the spectrum itself .",
    "these @xmath269-sized matrices are the left and right components of @xmath10 , decomposed into coefficients of powers of @xmath15 . in the unruh model with the kernel of eq .",
    "( [ eq : unruh_kernel ] ) , @xmath10 can be considered as a first - degree polynomial in @xmath15 , so we can write @xmath270 , and upon splitting into left and right components ( see appendix a of part i ) we have @xmath271 there are thus four @xmath15-independent @xmath272 matrices to be stored before calculation of the @xmath15-dependent @xmath171-matrix .",
    "the @xmath15-dependent matrices of order @xmath272 are constructed from these using standard matrix manipulations , while those of order @xmath244 or less are small enough to be calculated directly for each value of @xmath15 .",
    "the complications that arise due to asymmetric asymptotics are not in the required manipulations themselves , but simply in the number of matrices that we require to define .",
    "this is mainly due to there being two different sets of solutions of the dispersion relation , but it leads to more than a straightforward doubling of the number of matrices . as we have seen in eqs .",
    "( [ eq : general_split_int_eqns ] ) , it necessitates the introduction of a complete set of polynomials , and hence introduces the @xmath168 matrices into the final expression ( [ eq : step_scattering_matrix ] ) for the scattering matrix .",
    "it also induces two types of `` overbar '' transformation ( described in eq .",
    "( [ eq : overbar_defn ] ) ) corresponding to the two different @xmath104 functions , with the functions @xmath273 appearing in the integrals of eqs .",
    "( [ eq : matrix_elements_exact ] ) being sums of different types .",
    "a final cause of the increase in the number of matrices is the appearance of the complex roots of the dispersion relations in eqs .",
    "( [ eq : kappalr_defn])-([eq : general_kappa_defns ] ) , requiring a further set of matrices in which these complex roots appear as arguments .",
    "this large number of matrices can be handled on adopting an economical system of notation .",
    "as in part i , we use a hat to denote a matrix to be stored or calculated numerically , and we use labels to indicate which wavevectors appear as arguments in a given function .",
    "there are three distinct groups of such wavevectors :    * the elements of the discretised integration grid , indicated by the label @xmath100 ; * the real roots of the dispersion relations , indicated by the label @xmath274 ; and * the complex roots of the dispersion relations , indicated by the label @xmath275 .",
    "the latter two groups also require labelling by @xmath72 , to distinguish the left and right solution sets .",
    "however , @xmath72 labels also appear on the functions and matrices themselves , and in the majority of cases these correspond exactly to the @xmath72 labels on the arguments . in those cases where the labels on the functions and arguments do not coincide , we indicate the difference with a minus sign in front of the label @xmath274 or @xmath275 .",
    "this notation allows us to represent most of the matrices required in the numerical algorithm .",
    "we need to form matrices of the @xmath276 functions from those of the original kernel @xmath10 . from eq .",
    "( [ eq : general_kappa_different_sigma ] ) we see that , for different @xmath72 labels , @xmath277 can be formed from matrix multiplication which sums over the complex roots ; and , from eqs .",
    "( [ eq : kappalr_defn ] ) and ( [ eq : general_kappa_split ] ) , the corresponding function with equal @xmath72 labels , @xmath278 , is most easily formed by sutracting @xmath277 from @xmath279 , where @xmath112 is the polynomial whose roots are the forbidden wavevectors . in matrix form , we define    @xmath280_{qm } & = & k_{\\sigma}\\left(k_{\\sigma , q}^{c\\star},k_{m}\\right ) \\ , ,",
    "\\\\ \\left [ \\hat{\\delta}^{\\delta}_{\\,\\,\\sigma c } \\right]_{nq } & = & \\frac{1}{\\left(k_{n}-k_{\\sigma , q}^{c\\star}\\right ) \\ , c_{\\sigma , q } } \\ , , \\label{eq : delta_c}\\\\ \\left [ \\hat{f } \\right]_{nm } & = & \\prod_{q=1}^{n_{l}^{c } } \\left ( k_{n}-k_{l , q}^{c\\star } \\right ) \\ , \\prod_{q=1}^{n_{r}^{c } } \\left(k_{n}-k_{r , q}^{c\\star } \\right ) \\ , \\delta_{nm } \\,,\\end{aligned}\\ ] ]        matrix equations entirely analogous to these allow us to calculate all the @xmath281 matrices , with the labels @xmath100 exchanged for @xmath274 and @xmath275 . ( note that , when the upper label is of @xmath274-type rather than @xmath100-type , the subtracted matrix in eq . ( [ eq : kappa_matrix ] ) will have an upper label of @xmath283-type because the first arguments are @xmath68 rather than @xmath284 . )",
    "one of these is exactly the first of the matrices appearing in the sums of eqs .",
    "( [ eq : matrix_elements_discretised ] ) : this is the discretised version of the function @xmath285 , and in the notation adopted here is the @xmath286 matrix sum @xmath287 .",
    "we next need an efficient way of performing the transformation denoted by the overbar .",
    "this has already been described in appendix b of part i : in the case of the matrices with only @xmath100 labels , we need    @xmath288_{nj } & = & \\frac{1}{\\left ( k_{n } - k_{\\sigma , j}^{r } \\right ) \\ , \\tilde{g}_{\\sigma}^{\\prime}\\left ( k_{\\sigma , j}^{r } \\right ) } \\ , , \\\\ \\left",
    "[ \\hat{\\tilde{g}}_{\\sigma \\delta } \\right]_{nm } & = & \\tilde{g}_{\\sigma}\\left(k_{n}\\right ) \\ , \\delta_{nm } \\,.\\end{aligned}\\ ] ]    then , having already defined the @xmath289 matrices , we have @xmath290 again , the various @xmath291 matrices are defined analogously , simply by changing the @xmath100 labels for @xmath274 and @xmath275 labels .",
    "the final factor appearing in the sums of the first two of eqs .",
    "( [ eq : matrix_elements_discretised ] ) are within this group : they are the discretised versions of @xmath292 , denoted here by the @xmath293 matrix sum @xmath294 .    to perform integrals over @xmath216",
    ", we require a diagonal matrix whose elements are the values of @xmath263 : @xmath295_{nm } = \\sqrt{\\frac{\\mathrm{d}k}{\\mathrm{d}\\zeta}\\left(\\zeta_{n}\\right ) } \\,\\ , \\delta_{nm } \\,.\\ ] ] this allows us to find @xmath296 , the discretised form of the transformed inverse kernel defined by eq .",
    "( [ eq : inverse_kernel_zeta ] ) : it is given by @xmath297^{-1 } \\,.\\ ] ] the matrices @xmath298 of eq .",
    "( [ eq : lr_matrix_equation ] ) may now be written in terms of matrices defined above :      the @xmath300 matrices are somewhat simpler .",
    "the elements of @xmath301 are straightforward evaluations of the @xmath95 at the roots of the dispersion relation in asymptotic region @xmath72 : @xmath302_{ij } = p_{j}\\left ( k_{\\sigma , i}^{r } \\right ) \\,.\\ ] ] also , since @xmath95 is a polynomial of degree @xmath93 and @xmath104 is a rational function that behaves asymptotically like @xmath303 , @xmath304 behaves asymptotically like @xmath20 and is exactly a sum over the poles at the zeros of @xmath104 . when constructing @xmath305 , the poles on the real axis",
    "are subtracted , so @xmath305 is exactly the sum over the poles at the _ complex _ roots of @xmath104 , and @xmath119 is the difference between these sums for @xmath115 and @xmath114 : @xmath306 discretisation is achieved by defining the matrices    @xmath307_{qj } & = & p_{j}\\left(k_{\\sigma , q}^{c}\\right ) \\,,\\\\ \\left [ \\hat{\\delta}^{\\delta}_{\\,\\,\\sigma cg } \\right]_{nq } & = & \\frac{1}{\\left(k_{n } - k_{\\sigma , q}^{c}\\right ) \\tilde{g}^{\\prime}_{\\sigma}\\left(k_{\\sigma , q}^{c}\\right ) } \\ , , \\label{eq : delta_cg}\\end{aligned}\\ ] ]                                                                      ) , the first as a solid line and the second as a dotted line ; note that these agree for small values of @xmath21 .",
    "the dashed line shows a polynomial approximation to the solid curve within the interval @xmath224 , which entirely contains the region of the spectrum where hawking radiation is predicted to occur ( compare with fig .",
    "[ fig : dispersion_in_stationary_frame ] ) .",
    "the approximation was found by discretising this interval into @xmath225 points , then performing a least - squares fit to a polynomial of degree @xmath311 with only even powers of @xmath21 . in the inset",
    "is plotted the difference between the polynomial approximation and the model dispersion relation we started with ; in the region of interest , the approximation is found to agree with the model to about one part in @xmath312 . [",
    "fig : dispersion_relations ] ]    ) , with @xmath313 , @xmath314 , and @xmath239 for the solid line and @xmath240 for the dashed line .",
    "the dotted line plots @xmath231 , marking the transition between subsonic and supersonic flow ; the point at which @xmath2 crosses this is the event horizon .",
    "it is a black hole horizon because the flow is accelerating in the direction of flow , and with it is associated spontaneous emission of hawking pairs , the members of each pair being long - wavelength and emitted in opposite directions , as indicated here .",
    "( see fig .",
    "[ fig : dispersion_in_stationary_frame ] for the positions of @xmath315 and @xmath316 in the dispersion relation . )",
    "[ fig : velocity_profiles ] ]"
  ],
  "abstract_text": [
    "<S> analogue gravity experiments make feasible the realisation of black hole spacetimes in a laboratory setting and the observational verification of hawking radiation . since such analogue systems are typically dominated by dispersion , efficient techniques for calculating the predicted hawking spectrum in the presence of strong dispersion are required . in the preceding paper , an integral method in fourier space </S>",
    "<S> is proposed for stationary @xmath0-dimensional backgrounds which are asymptotically symmetric . here , </S>",
    "<S> this method is generalised to backgrounds which are different in the asymptotic regions to the left and right of the scattering region . </S>"
  ]
}