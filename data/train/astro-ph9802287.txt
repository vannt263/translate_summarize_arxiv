{
  "article_text": [
    "this paper is the second part of a study on the influence of non  linear dynamics on the mass function of cosmic structures . in a companion paper ( @xcite , thereafter p1 ) we studied analytically the influence of the shear and of the tide on the mass function in a generalized press & schechter ( 1974 , thereafter ps ) formalism for a critical universe .",
    "we first showed that the mass function can be directly related to a given dynamical model through a selection function which gives the probability that a lagrangian fluid element with a given initial density contrast will be in a collapsed structure at the present epoch .",
    "we also emphasized two invariance properties of the mass function in such a formalism , the well - known self - similarity in time , and the possibility of factorizing the mass function as the product of a function which depends only on the dynamical model and another function which depends only on the power spectrum of initial density fluctuations ( p1 ) .",
    "these time and spectral scaling properties are strong predictions of the generalized ps formalism , they will therefore be used to test the validity of such an approach .    in the present paper , we extend our analytical work by a comparative analysis with numerical simulations .",
    "these ones have been used by many authors to test the ps approach .",
    "the first successful attempt was made by efstathiou et al .",
    "( 1988 ) using however a small number of particles .",
    "they used a rather simple and easily tractable algorithm to define collapsed objects in the numerical density fields , namely the friend  of  friend algorithm ( thereafter fof ) .",
    "they conclude that the standard ps mass function reproduces well the numerical data , although the number of objects with mass @xmath0 seems to be overestimated ( @xmath1 precedes the cut - off at large mass ) .",
    "gelb & bertschinger ( 1994 ) have presented a new algorithm ( denmax ) which brings together particles around maxima of the density field .",
    "they showed that the resulting mass function differs from the fof mass function .",
    "lacey & cole ( 1994 ) compared also the mass functions obtained with different algorithms .",
    "they used mainly fof and another algorithm that detects spherically symmetric density maxima in the field ( spherical overdensity , thereafter so ) .",
    "these works emphasize that the resulting mass function depend strongly on the chosen algorithm to define structures in the density field .",
    "a similar conclusion was outlined by eke et al .",
    "( 1996 ) in the case of the correlation function of clusters in a cdm cosmogony .",
    "in this paper we work then towards two goals .",
    "first , we study as in the previous works , the dependence on different definitions of structures , of the mass functions in the numerical simulations .",
    "in particular , we examine if the resulting mass functions satisfy the time and spectral scaling properties , inherent to a ps description of structure formation .",
    "secondly , we investigate the connection between the actual fully non  linear dynamics of structures in n ",
    "body simulations and the dynamical model used to compute the mass function in analytical approaches . as a matter of fact , even if the number of objects in the field can be relatively well described by , for example , the standard ps mass function , as was argued in previous studies ( @xcite , @xcite ) , this however does not mean that the actual dynamics of each object is correctly described by the spherical model .",
    "finally , we build a complete description of the mass function which allows both a correct statistical description of the number of objects generated in the numerical simulations , but also a right description of their initial statistical properties and of their dynamics .    in the next section we present our numerical simulations of scale free power spectra and the different algorithms we used to define objects in the density field .",
    "the resulting mass functions and the analysis of their scaling properties are discussed in sect .",
    "a complete description , which accounts for both the statistical properties and dynamical origin of the mass function is exhibited in the sect .",
    "finally we discuss our results and conclude in sect .",
    "we consider three power - law initial power spectrum ( @xmath2 with @xmath3 ) in a critical universe with a hubble parameter @xmath4 .",
    "the simulations were done using a particle  mesh code with @xmath5 particles and @xmath6 grid points to compute the gravitational force .",
    "the interpolation between the particules and the grid points was done with a cloud - in - cell interpolation scheme .",
    "the initial power spectrum were all normalized with the condition @xmath7 , where @xmath8 is the r.m.s density fluctuation filtered by a top - hat window function of radius @xmath9 , and linearly extrapolated to present time . for scale",
    "free initial power spectra , @xmath8 and the mass @xmath10 are related by    @xmath11    where @xmath12 defines a characteristic mass which marks the transition between linear and non  linear scales ( @xmath13 ) .",
    "any numerical simulations which intend to test the ps approach of structure formation should be able to describe correctly scales where @xmath14 down to scales where @xmath15 .",
    "consequently , the choice of the simulation box size is of crucial importance .",
    "this choice is then a compromise between two requirements : the resolution to describe correctly the dynamics of a single cluster and the power on large scales .",
    "this has lead us to choose a box - length of @xmath16 for @xmath17 and @xmath18 and of @xmath19 for @xmath20 which has more power on large scales .",
    "this gives , with the above normalization , @xmath21 particles for @xmath17 and @xmath18 and @xmath22 particles for @xmath20 .    in order to consider only the structures for which the dynamics is properly described by the pm code",
    ", we have kept only structures whose virial radius ( defined as the radius of the sphere for which the mean overdensity is @xmath23 ) are greater than @xmath24 cells which is the radius at which the numerical force equals only half of the true force .",
    "this conditions gives a minimum mass of @xmath25 particles .",
    "this limit is very conservative but it ensures that there are negligible resolution effects . for each spectrum",
    "we have done several simulations ( @xmath26 for @xmath17 , @xmath27 for @xmath18 and @xmath28 for @xmath20 ) to increase the statistical significance of our results .",
    "we obtain , for each spectrum , a few thousand well described ( @xmath29 ) objects at an expansion factor @xmath30 ( present time ) .",
    "all the results we give in this paper are statistical averages over all the simulations performed for each power spectrum .",
    "the time variable was chosen in order to obtain a constant r.m.s displacement of particles , independently of the initial power spectrum .",
    "this can be achieve with the time variable @xmath31 where @xmath32 ( efstathiou et al .",
    "each simulation was run with the same number of time steps ( @xmath33 ) ( using a leap - frog time integrator ) , which ensures an excellent energy conservation ( see table [ 1 ] ) .    [ cols=\"^,^,^,^,^ \" , ]     in order to study the time evolution of the mass function we stored the results of the simulations at @xmath34 different epochs .",
    "each output corresponds to @xmath35 equal to twice the last output value .",
    "table [ 1 ] gives the different simulations parameters we used for this study .",
    "to count the number of structures generated in a cosmological numerical simulation , one needs to specify what we mean by `` structure '' .",
    "we have then analyzed the three main type of algorithms that define differently collapsed objects in a given density field , respectively friend  of  friend ( thereafter fof ) , denmax ( @xcite ) , a modified version of denmax that we call denevap , and spherical overdensity . the quality and drawbacks that one generally imputes to these algorithms can not be justified by rigorous physical arguments . in our work",
    "we favor an algorithm , because it defines structures , in such a way that the resulting mass function satisfies the time and spectral scaling invariances , inherent to the ps formalism .",
    "this algorithm is one of the most used methods to define objects .",
    "it is based on a percolation scheme that links particles recursively when the spatial separation between two particles is less than a given threshold , called the percolation length @xmath36 .",
    "this length is expressed in units of the initial mean interparticular separation .",
    "this method is equivalent to selecting regions of space which are enclosed by a density isocontour of @xmath37 . for a spherically symmetric object with an isothermal density profile @xmath38 ,",
    "this leads to a mean interior density @xmath39 .",
    "the choice @xmath40 gives a mean density contrast of @xmath41 , which is the value generally assumed for the final relaxed object in the framework of spherical collapse .",
    "we do nt however restrict ourselves to this value , as we will see in the following .",
    "the advantages of this algorithm are its easy implementation and the fact that there is only one free parameter which can be related directly to a density isocontour . moreover",
    ", this scheme does nt make any assumption about the actual shape of objects .",
    "the main drawback is an overlapping problem ( @xcite , @xcite ) .",
    "indeed , small filaments can connect two objects which are actually different .",
    "these bridges of matter lead to a single massive object which has not collapsed , which could affect the mass function .",
    "the last remark has led bertschinger & gelb to develop a new algorithm ( denmax ) to define structures in the density field .",
    "denmax is based on a density maximum detection , linking together particles belonging to the same density peak .",
    "particles are moved towards the peak position following geodesics of the density field .",
    "the surrounding surface of the corresponding object is therefore not a density isosurface , but the col surface delineating the `` influence region '' of a peak .",
    "this scheme does not suffer from an overlapping problem .",
    "it has however a very important drawback .",
    "the density maxima and the corresponding regions greatly depend on the scale at which the density field is computed .",
    "this means that denmax has a free parameter , which is the spatial resolution of the grid used to compute the density field .",
    "this leads to resolution dependent results .",
    "one has to be careful when choosing the grid resolution .",
    "a second drawback of the method is that it defines objects without an intrinsic density criterion .",
    "indeed , very low density peak are identified as objects , although these small density ripples are not collapsed objects .",
    "gelb & bertschinger ( 1994 ) used a additional criterion to remove particles that are not gravitationally bound to the peak which they are associated with . here",
    ", we rather use an overdensity criterion .",
    "this second algorithm , which is a modification to the original denmax , evaporates objects which do not satisfy the following requirements : for each density maximum , we apply the fof algorithm with a given percolation length @xmath36 , and we extract the most massive sub  halo .",
    "we then compute its center of mass , and its three principal axes .",
    "we then define the mean interior density @xmath42 of the object as the total mass divided by the volume of the mean quadratic ellipsoid .",
    "we vary the percolation length until the overdensity reaches @xmath23 . with this new method , low density peak",
    "are totally evaporated , and low density wings surrounding halos do not contribute to the final halo mass .",
    "for a three dimensional object with a complex shape , defining the mean interior density is a difficult task .",
    "this criterion appears to be a good compromise , since we checked that in the case of a spherical isothermal halo , we recover the value of @xmath23 corresponding to the spherical model .",
    "we refer to this modified version of denmax as denevap .",
    "note however that this new method still depends on the resolution used to compute the density field , and that the first step of denevap is still the denmax algorithm .",
    "this last method is a tentative algorithm described in lacey & cole ( 1994 ) that avoids the drawbacks of the two previous schemes .",
    "it consists of finding spherical regions in the simulation having a certain mean overdensity ( for example @xmath43 ) .",
    "we first calculate a local density for each particle using a nearest grid point affectation scheme .",
    "we then sort the particles by density in decreasing order .",
    "the center of mass of a halo is first identified with the first particle of the list .",
    "we grow a sphere centered on this point until the mean overdensity reaches the chosen value .",
    "we then calculate the new center of mass of the particles contained in this sphere , and we iterate until the distance between two consecutive center of mass is less than 10% of the mean interparticular distance .",
    "we finally remove all particles of the new halo from the list . note that the halos do not depend on the method we use to compute the density , and to find the density maxima , as long as we use a high resolution grid ( we use a @xmath44 grid in this paper ) .",
    "this algorithm is thus resolution independent .",
    "there is no overlapping problem , and there is only one free parameter , namely the chosen overdensity threshold .",
    "however , this scheme has the drawback of imposing a spherical shape on the halos .",
    "in this section we present the mass function obtained at different times , for the different power spectra and for the algorithms presented above . when looking at these mass functions we have two goals .",
    "first we want to look at their dependence on the different methods to define structures .",
    "then , we want to see if they satisfy the time self  similarity and the spectrum invariance that are very generic features of the mass function obtained through a ps  like approach ( p1 , see appendix ) .    following efstathiou et al .",
    "( 1988 ) , we use the multiplicity function defined as the fraction of mass embedded in halos with a number of particles between @xmath45 and @xmath46 , where @xmath47 is the multiplicity . in these terms",
    ", the multiplicity of the characteristic non  linear mass @xmath1 between two consecutive outputs increases by one . in figs .",
    "[ fmlog1 ] and [ fmlog2 ] we present the multiplicity functions obtained for each spectrum and for each algorithm .",
    "the multiplicity functions obtained at each time are rescaled to @xmath30 , in order to test the time self  similarity of the mass function .",
    "note also that the mass ( in number of particles ) of halos obtained in the @xmath20 simulations were multiplied by a factor @xmath48 to account for the different box size .",
    "the error bars in both figures are computed using a poisson noise estimation in each bin .",
    "we now discuss the multiplicity functions obtained with each algorithm .",
    "as we have seen this algorithm has one free parameter , the percolation length @xmath36 .",
    "we have first tried the value @xmath40 , adopted by several authors .",
    "our results ( fig .",
    "2 ) are in good agreement with efstathiou et al .",
    "the time self similarity is very well recovered and the high mass cut off is well reproduced by the standard ps multiplicity function ( @xmath49 , see appendix ) .",
    "however , as mentioned by efstathiou et al . , there is a mass deficit of about 50% around the peak of the multiplicity function .",
    "this deficit suggests that the density criteria is too stringent .",
    "therefore we have tried fof with @xmath50 .",
    "this roughly corresponds to halos with an overdensity of @xmath51 . in this case",
    "the cut - off corresponds to a ps multiplicity function with @xmath52 and the discrepancy around the peak is considerably reduced ( fig .",
    "1 ) . since for both",
    "the percolation lengths used the time self - similarity is very well recovered it is possible to average the multiplicity function obtained at different times ( rescaled to @xmath30 ) to get a unique multiplicity function for each spectra .",
    "one can then check that all the multiplicity functions obtained for the different spectra have the same universal multiplicity function ( see appendix or p1 for definition ) .",
    "we have plotted on fig .",
    "4-a ( resp.4-d ) the universal multiplicity function for @xmath50 ( resp .",
    "@xmath40 ) .",
    "the `` spectral scaling '' predicted in the framework of a ps approach is extremely well recovered .    for the fof algorithm , and for both percolation lengths , the generic features ( time and spectral scaling )",
    "predicted by the ps formalism are well reproduced . for a percolation length of @xmath53 the cut - off of the multiplicity function",
    "is well reproduced by the spherical ps multiplicity function but in that case there is a large excess of `` analytical '' structures around @xmath1 . for a larger percolation length ( @xmath50 ) the entire multiplicity function",
    "is quite well reproduced by a ps function with @xmath52 ( even though there is still a small excess of `` analytical''structures around @xmath1 ) .",
    "we have shown in p1 that a ps - like function with @xmath52 results from the ps formalism with a non - spherical dynamics .",
    "we will see in the next section if this agreement can really be explained by this dynamical reason .      for this algorithm",
    "the free parameter is the resolution of the grid on which the density field is computed .",
    "since we use a pm code we have chosen the same grid as the one used during the simulation .",
    "using a finer grid would not make much sense since density maxima within a cell of the pm do not have any meaning . on fig .",
    "2 we present the multiplicity function obtained with denmax and rescaled to @xmath30 as before . for @xmath17 the time scaling property",
    "is well recovered even though one starts to see a little shift in the small mass region and the agreement with a ps function with @xmath52 is striking .",
    "however for @xmath18 and @xmath20 there is a clear shift between the multiplicity function at different times .",
    "the time scaling property is not satisfied at all by the structures recognize by denmax .",
    "as can be seen on fig .",
    "4-b where we have plotted the universal multiplicity function of denmax for the three different power spectrum the spectral invariance is not satisfied either ( we have done an average of the multiplicity function at different times in order to have a single curve even though it is not legitimate in this case ) .",
    "this fact can also be seen on fig . 2 by looking at the relative position of the multiplicity function compared to the ps multiplicity function .",
    "the large modification of the denmax multiplicity function when one changes the spectrum of initial fluctuation can be understood by looking more closely at the structures found . in fig .",
    "[ denmax_densite ] we have plotted the average density versus the mass of all the structures found for the different spectra .",
    "it is now quite clear that the structures found by denmax greatly depend on the spectra .",
    "for @xmath17 the density wells are quite steep and therefore the denmax structures are dense . on the contrary for @xmath20 the density wells are rather flat which leads to less dense structures .",
    "more generally , denmax detects as structures regions which are not necessarily dense . in order to correct this drawback",
    "we have developed the algorithm denevap presented above . in fig .",
    "[ fmlog1 ] the multiplicity function obtained with denevap is presented . by taking away the low density region",
    "we have improved the time scaling at high mass , but it is still very bad ( worse ) for intermediate and low mass .",
    "it is of course possible to truncate the denmax structures in many other ways but the results should not be very different . beyond the problem of the structures densities ,",
    "the denmax algorithm is not very well suited to the detection of cosmic structures because , with the grid used to compute the density field , it introduces a characteristic scale , @xmath54 .",
    "this length , fixed once and for all , correspond to a density fluctuation , @xmath8 , which is different depending on the time and on the spectrum considered .",
    "for this reason , the two scaling behaviors are broken . to recover them ,",
    "the length @xmath54 could be determined as a function of the time and the power spectrum in order to correspond to a constant @xmath8 .",
    "but this artificial introduction of the scaling laws in the algorithm used to detect structures does not seem satisfactory to us .      the only free parameter of this algorithm is the density threshold . to compare with fof",
    "we have tested two thresholds : 180 ( so180 ) and 60 ( so60 ) which roughly correspond to fof with a percolation length of @xmath53 and @xmath55 respectively .",
    "the resulting multiplicity functions are presented on figs .",
    "[ fmlog1 ] and [ fmlog2 ] .",
    "the time self similarity is roughly reproduced for so60 but very badly for so180 .",
    "we have therefore also looked at the spectral invariance for so60 .",
    "the results are much better than those of denmax but there is a slight shift .",
    "fof reproduces this invariance much better . for @xmath20 structures",
    "are rather isolated from one another and therefore imposing a spherical shape is not a strong constraint .",
    "however for @xmath18 and @xmath17 structures are more strongly correlated and imposing a spherical shape on an heavy cluster damages close - by structures .",
    "so180 works poorly because imposing a spherical shape to structures with such a high density criteria results in the truncation of some dense parts of elongated structures . for so60",
    "this truncation occurs less and concerns region of inferior density contrast .",
    "in the previous sections we have analyzed the agreement between the multiplicity function of numerical structures recognized with a given algorithm and the ones obtained in a ps formalism using a given dynamics .",
    "this analysis was only statistical and its sole concern was the number of structures . however , this point of view is not enough to have a coherent description of structure formation .",
    "if a numerical and an analytical multiplicity function are identical it is then also necessary that the numerical structures follow the dynamics used in the analytical picture . otherwise the agreement of the multiplicity functions is a fit rather than a dynamical description of structure formation . in the ps formalism",
    "the dynamics intervene only through the collapse time .",
    "we have therefore decided to compare the collapse time of the structure predicted by dynamical models and the one obtained in the simulation . in order to give a satisfactory description of structure formation",
    ", the ps formalism should agree with the numerical simulations both in the initial and final conditions and also in the dynamical link between these two states .",
    "we will test the agreement in the initial conditions by comparing the initial distribution of shear and density contrast of the selected halos , for the final conditions we will use the multiplicity function and the dynamical coherence will be tested by comparing the collapse time .    we have done this global analysis with the halos detected by the friend - of - friend because they satisfy better the two scaling criteria .",
    "the first step of this analysis is to determine the initial properties of the halos detected in the final state of the numerical simulation .",
    "once a group of particles has been identified as a halo of the final density field , we determine its initial lagrangian volume ( i.e. the volume occupied by theses particles in the initial conditions ) .",
    "we then compute the density field in the initial condition with a cloud in cell scheme using all the particles of the simulation .",
    "the shear which is the traceless symmetric part of the tensor @xmath56 , is then deduced from the density field using the relations @xmath57 valid in the linear regime . the initial density and shear of a halo",
    "are then defined as the average of the previous fields over its lagrangian volume .",
    "the resulting shear tensor is then diagonalized to obtain the initial shear eigenvalues .    with the previous procedure ,",
    "the density contrast that we obtain corresponds to the value of the initial density field smoothed with a top - hat filter having the shape of the initial lagrangian volume .",
    "however , the variable used in the ps formalism is the initial density field smoothed by a * spherical * top - hat filter .",
    "it is therefore necessary to check that these two density fields have identical statistical properties .",
    "this has been done by comparing directly the probability distribution function ( pdf ) of both fields ( for several halos shapes ) .",
    "the maximum discrepancy between the two pdf s was found to be in all cases less than @xmath58 . if these two smoothing methods are statistically equivalent , they however differ drastically on a halo - by - halo basis .",
    "the initial conditions attributed to a given structure will be very different depending on whether they are computed in a sphere or in the initial lagrangian volume . from an analytical point of view , the choice of the filter has no influence on the shape of the mass function for scale - free initial conditions ( @xcite ) .",
    "now that we have both the initial properties of the structures detected by fof-0.2 and fof-0.3 and their multiplicity functions , we are in a position to test the dynamical meaning of the ps formalism as a tool to study structure formation .    analytically , structures can be identified , as we have stressed in p1 , with regions which have collapsed either along their first , second or third principal axis .",
    "before looking for a precise dynamical model , it is therefore necessary to determine which of these three type of collapses corresponds to the structures found in numerical simulations . as we have shown in p1 , the derivative of the selection function makes a direct link between the multiplicity function and the underlying dynamical model . for this reason",
    ", it has very specific behaviors corresponding to each of these three type of dynamics .",
    "therefore , we will find if the structures found in the numerical simulations result from a first , second or third axis collapse by looking at the derivative of their selection function .    from formula [ phi_uni ]",
    "( in the appendix ) , it is possible to deduce that the function @xmath59 gives the probability that a halo of mass @xmath8 has an initial density contrast @xmath60 . choosing a mass range between @xmath8 and @xmath61 , it is possible to compute this initial probability distribution function using the results of our numerical simulations and then to infer the derivative of the selection function .",
    "we plot on fig [ fonc_sel_num ] the derivative of the selection function for three different values of @xmath8 .",
    "the observed behavior ( the position and the width of the peak are increasing functions of @xmath8 ) is characteristic of a third axis collapse ( p1 ) .",
    "the collapse along the third axis is slowed down by the effect of the shear .",
    "therefore , on small scales ( high @xmath8 ) where the shear is statistically greater , structures need on average a higher density contrast to collapse .",
    "we therefore deduce qualitatively that the underlying dynamical model , in the framework of the ps formalism , is better described by the collapse of the third axis .",
    "since the collapse of the first axis is a singularity , it is not possible follow the dynamics of the structure until the collapse of the third axis .",
    "however , extrapolating results obtained for the collapse time of the first axis , we have proposed in p1 the following dynamical prescription which allows to compute the collapse epoch of the third axis , as a function of the initial density contrast @xmath60 and the largest ( and therefore positive ) shear eigenvalue @xmath62    @xmath63    where @xmath64 is a density threshold , @xmath65 is the maximum allowed initial shear - to - density ratio beyond which shear effects prevent any halo from collapsing .",
    "the last parameter , @xmath66 , determines the global shape of the collapse epoch . from asymptotic arguments",
    ", we stressed in p1 that @xmath66 has to be less than unity .    in order to recover a coherent description of structure formation within the ps approach",
    ", we have verified that a single set of parameters is able to reproduce simultaneously the multiplicity function ( final state ) , the mean and the variance of the function @xmath67 ( initial state ) , and finally the collapse time of halos .    for fof-0.3 ( resp .",
    "fof-0.2 ) we find that a good agreement is obtained with @xmath68 , @xmath69 and @xmath70 ( resp .",
    "@xmath52 , @xmath71 and @xmath72 ) .",
    "the corresponding collapse epoch are plotted in fig .",
    "[ model_tc ] .",
    "the two collapse times corresponding to each algorithm are quite different .",
    "but they however result from the same underlying non - linear gravitational dynamics .",
    "the difference comes from the fact that the two algorithms define different regions in the final density field and that the initial physical conditions necessary to the formation of such region are thus different .",
    "the collapse time corresponding to fof-0.2 is always larger .",
    "this is natural since it takes more time for a given halo to reach a higher density contrast .",
    "the critical shear value is greater for fof-0.3 than for fof-0.2 .",
    "this was also to be expected since , in the context of our dynamical model , the shear always slows down the collapse .",
    "the largest peaks of the final density field therefore come from region with a low shear to density ratio .",
    "this result is consistent with those obtained by other authors ( @xcite , @xcite ) , but we analyze it from a very different point of view .",
    "the fact that the dense regions in the final density field have less initial shear does not mean that the dynamics is quasi - spherical , but , on the contrary , that the dynamical influence of the shear is such that dense structure can form only in region where it is sufficiently low .",
    "the dynamics of the densest structures is * a posteriori * spherical ( because the spherical collapse is the fastest ) but one can not suppose * a priori * that the dynamics is spherical everywhere .",
    "we plot in fig .",
    "[ global_fit ] the best agreement obtained for fof-0.2 and fof-0.3 with the collapse time given by equation ( [ 3param ] ) and the above parameters .",
    "we reproduce in both cases very accurately the multiplicity function , with a slight underestimation at the very low mass end .",
    "note that the error bars are only poisson noise estimators which do not take into account the systematic errors coming from the finite resolution of the pm code such as , for example , the loss of dynamical accuracy in the halos of lower mass .",
    "moreover , we also reproduce the mass dependency of the mean ( @xmath73 ) and of the variance ( @xmath74 ) of the initial density contrast distribution of the halos ( fig .",
    "[ global_fit ] ) .",
    "we have also plotted in fig .",
    "[ fonc_sel_num ] the entire derivative of the selection function .",
    "finally , the mean collapse epoch is recovered ( @xmath75 ) , although the dispersion remains large for small mass objects .",
    "note that for small mass halos , in addition to lower dynamical accuracy , there is also a systematic error in the computation of the initial parameters .",
    "in fact , due to the discreteness of the computational grid , the error done when averaging over the lagrangian volume then increases because boundary effects become important .",
    "these results show altogether that our formalism is able to reproduce the mass function both from a statistical and from a dynamical point of view",
    ". however , each halo does not individually follow exactly our simple dynamical prescription but in each mass range the collapse time of the halos is on average given by our model . for the sake of comparison , we plot in fig .",
    "[ pscomp ] the same results obtained with the standard ps approach , using @xmath64 as the only free parameter .",
    "we plot in each panel the results obtained using two different values for @xmath64 , showing that it is impossible to reproduce simultaneously the final and initial states . in other words",
    ", the standard ps approach gives a rough statistical indicator of the number of halos , but does not allow for a coherent description of structure formation .",
    "in p1 we have extended the ps formalism in order to include the effect of the shear and the tide .",
    "we have shown than within the ps formalism it was possible to obtain very different behaviors for the mass function which are directly related to the underlying dynamical model . even though the mass functions are quantitatively very different , they all satisfy , within the ps formalism , two scaling properties ( i.e. the time self similarity and the power spectrum scaling ( formula ( [ spec - scaling ] ) ) .",
    "the aim of this paper was to determine if the ps formalism could explain coherently structure formation both from a statistical and a dynamical point of view .",
    "in the first part of this paper we have shown , using numerical simulation , that it was possible to define numerical structures whose mass function obeys both the ps scaling laws .",
    "we have tried different algorithms which all lead to different mass functions .",
    "the only one which reproduces all the scaling laws is friend  of  friend .",
    "however , the resulting universal mass function is still strongly dependent on the percolation length .",
    "this dependence of the mass function on the chosen algorithm shows that the choice of the dynamics used in the ps formalism can not be unique and has to be related to the actual definition of the structures in the density field . in order to have a coherent description of structure formation",
    ", the chosen dynamical model should not only reproduce the mass function , but should also give a correct description of the regions selected in the initial density field and of their collapse times .",
    "we have shown , using a dynamical prescription proposed in p1 , that it is possible to built such a coherent picture . within this picture",
    ", the structures result from a collapse along their third principal axis .",
    "the collapse epoch is then a function of the density contrast and of the largest shear eigen - value given by formula ( [ 3param ] ) which has three free dynamical parameters .",
    "it is then possible to find a set of parameters which reproduces simultaneously the mass function , the initial selection function and gives on average the correct collapse epoch .",
    "such a coherent description is totally impossible with the classical ps formalism even when adjusting the density threshold .",
    "this inadequacy comes from the fact that the shear plays an important role in the dynamics of forming halos .",
    "this dynamical effect explains the @xmath76 discrepancy of structures found by fof-0.2 compared to the classical ps formalism .",
    "audit e. , teyssier r. , alimi j - m . , 1997 ,",
    "a&a , * 325 * , 439 - 449    bertschinger e. , gelb j. , 1991 , comp . in phys . ,",
    "* 5 * , 164    bernardeau f. , 1994 , apj , * 427 * , 51    efstathiou g. , davis m. , white s.d.m . , frenk c.s . , 1985 , apjs , * 57 * , 241    efstathiou g. , frenk c.s . , white s.d.m . , davis m. , 1988 , mnras , * 235 * , 715    eke v. , cole s. , frenk c. , navarro j. , 1996 , mnras , * 281 * , 703    gelb j. , bertschinger e. , 1994 , apj , * 436 * , 467    lacey c. , cole s. , 1993 , mnras , * 262 * , 627    lacey c. , cole s. , 1994 , mnras , * 271 * , 676    press w.h . , schechter p. , 1974 ,",
    "apj , * 188 * , 425    van de weygaert r. , babul a. , 1994 , apj , * 425 * , l59",
    "the * mass function * , @xmath77 which gives the number density of object of mass @xmath10 , and the * multiplicity function * @xmath78 , which gives the fraction of mass embedded in objects of masses between @xmath10 and @xmath79 are simply related by : @xmath80 where @xmath81 is the mean density of the universe . in the framework of a ps",
    "approach the multiplicity function can be expressed as :      where @xmath8 is the r.m.s density contrast filtered by a top  hat window function of radius @xmath9 ( this corresponds to objects of mass @xmath83 ) .",
    "the first term depends only on the power spectrum of the initial density fluctuation , while the second term which we call the * universal multiplicity function * depends only on the dynamical prescription describing the formation of structure . assuming spherical dynamics @xmath84 takes the form : @xmath85 with @xmath49 .",
    "more generally , the universal multiplicity function can be expressed as ( p1 )      where @xmath87 is a normalization constant .",
    "the derivative of the selection function , @xmath88 , depends only on the dynamical model chosen to compute the collapse time of structures .",
    "all the dynamical information needed in the ps formalism is contained in this function ."
  ],
  "abstract_text": [
    "<S> we compare the mass functions obtained analytically , in the framework of an extended press & schechter ( ps ) formalism , in a previous paper to the numerical mass functions obtained in n  body simulations , using different algorithms to define objects in the density field . after discussing the properties of the algorithms , </S>",
    "<S> we show that the mass function obtained using the friend  of  friend algorithm reproduces best the scaling behaviors predicted in the extended ps formalism . following this statistical analysis </S>",
    "<S> , we show that it is possible in the framework of our extended ps formalism to reproduce the mass function but also , and for the first time , the initial statistical properties of structures and their collapse time . </S>",
    "<S> this allow to present a `` coherent '' picture of structure formation which can account for the initial , final and dynamical properties of structures .    </S>",
    "<S> cosmology : theory  large - scale structure of universe  gravitation  methods : numerical </S>"
  ]
}