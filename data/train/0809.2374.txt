{
  "article_text": [
    "kazhdan - lusztig polynomials are polynomials @xmath3 in one variable associated to each pair of elements @xmath4 and @xmath0 in the symmetric group @xmath5 ( or more generally in any coxeter group ) .",
    "they have an elementary definition in terms of the hecke algebra  @xcite and numerous applications in representation theory , most notably in  @xcite , and the geometry of homogeneous spaces  @xcite .",
    "while their definition makes it fairly easy to compute any particular kazhdan - lusztig polynomial , on the whole they are poorly understood .",
    "general closed formulas are known  @xcite , but they are fairly complicated ; furthermore , although they are known to be positive ( for @xmath5 and other weyl groups ) , these formulas have negative signs . for @xmath5 ,",
    "positive formulas are known only for @xmath6 avoiding permutations  @xcite , @xmath7-hexagon avoiding permutations  @xcite , and some isolated cases related to the generic singularities of schubert varieties  @xcite .",
    "one important interpretation of kazhdan - lusztig polynomials is as local intersection homology poincar polynomials for schubert varieties .",
    "this interpretation , originally established by kazhdan and lusztig  @xcite , shows , in an entirely non - constructive manner , that kazhdan - lusztig polynomials have nonnegative integer coefficients and constant term 1 .",
    "furthermore , as shown by deodhar  @xcite , @xmath8 ( for @xmath5 ) if and only if the schubert variety @xmath9 is smooth , and , more generally , @xmath10 if and only if @xmath9 is smooth over the schubert cell @xmath11 .",
    "the purpose of this paper is to prove the following theorem .",
    "[ thm : main ] suppose the singular locus of @xmath9 has exactly one irreducible component , and @xmath0 avoids the patterns @xmath12 , @xmath13 , @xmath14 , @xmath15 , @xmath16 , and @xmath17",
    ". then @xmath18 .    more precisely , when the hypotheses are satisfied , @xmath1 where @xmath2 is the minimum height of a @xmath6 embedding , with @xmath19 if no such embedding exists .    here ,",
    "a @xmath6 embedding is a sequence of indices @xmath20 such that @xmath21 , and its height is @xmath22 .",
    "given the first part of the theorem , the second part can be immediately deduced from the unimodality of kazhdan - lusztig polynomials  @xcite and the calculation of the kazhdan - lusztig polynomial at the unique generic singularity  @xcite .",
    "indeed , unimodality and this calculation imply the following corollary .",
    "[ cor : main ] suppose @xmath0 satisfies the hypotheses of theorem  [ thm : main ] .",
    "let @xmath23 be the singular locus of @xmath9",
    ". then @xmath24 ( with @xmath2 as in theorem  [ thm : main ] ) if @xmath25 in bruhat order , and @xmath10 otherwise .    the permutation @xmath26 and the singular locus in general",
    "has a combinatorial description given in theorem  [ thm : singlocus ] , which was originally proved independently in  @xcite .",
    "theorem  [ thm : main ] was conjectured by billey and braden @xcite .",
    "they claim the converse in their paper .",
    "an outline of the proof is as follows . if @xmath27 then @xmath9 is nonsingular  @xcite .",
    "the methods for calculating kazhdan - lusztig polynomials due to braden and macpherson  @xcite show that @xmath28 implies that the singular locus of @xmath9 has at most one component . that @xmath28 implies the pattern avoidance conditions follows from ( * ? ? ?",
    "* thm . 1 ) and the computation of kazhdan - lusztig polynomials for the six pattern permutations .",
    "while this paper was being written , billey and weed found an alternative formulation of theorem  [ thm : main ] purely in terms of pattern avoidance , replacing the condition that the singular locus of @xmath9 have only one component with sixty patterns .",
    "they have graciously agreed to allow their result , theorem  [ thm : pats ] , to be included in an appendix to this paper .",
    "theorem  [ thm : pats ] also provides an alternate method for proving the converse to theorem  [ thm : main ] using only ( * ? ? ?",
    "* thm . 1 ) and bypassing the methods of @xcite .    to prove theorem  [ thm : main ]",
    ", we study resolutions of singularities for schubert varieties that were introduced by cortez  @xcite and use an interpretation of the decomposition theorem @xcite given by polo @xcite which allows computation of kazhdan - lusztig polynomials @xmath29 ( and more generally local intersection homology poincar polynomials for appropriate varieties ) from information about the fibers of a resolution of singularities . in the @xmath6-avoiding case , we use a resolution of singularities from  @xcite and a second resolution of singularities which is closely related .",
    "an alternative approach which we do not take here would be to analyze the algorithm of lascoux  @xcite for calculating these kazhdan - lusztig polynomials . for permutations containing @xmath6",
    ", we use one of the partial resolutions introduced in  @xcite for the purpose of determining the singular locus of @xmath9 . under the conditions described above",
    ", this partial resolution is actually a resolution of singularities , and we use polo s methods on it .",
    "though we have used purely geometric arguments , it is possible to combinatorialize the calculation of kazhdan - lusztig polynomials from resolutions of singularities using a bialynicki - birula decomposition  @xcite of the resolution .",
    "see remark  [ rem : comb - calc ] for details .",
    "corollary  [ cor : main ] suggests the problem of describing all pairs @xmath4 and @xmath0 for which @xmath30 .",
    "it seems possible to extend the methods of this paper to characterize such pairs ; presumably @xmath31 would need to lie in no more than one component of the singular locus of @xmath9 , and @xmath32 $ ] would need to avoid certain intervals ( see section  [ sect : patavoid ] ) . any further extension to characterize @xmath0 for which @xmath33 is likely to be extremely combinatorially intricate .",
    "an extension to other weyl groups would also be interesting , not only for its intrinsic value , but because methods for proving such a result may suggest methods for proving any ( currently nonexistent ) conjecture combinatorially describing the singular loci of schubert varieties for these other weyl groups .",
    "i wish to thank eric babson for encouraging conversations and sara billey for helpful comments and suggestions on earlier drafts .",
    "i used greg warrington s software  @xcite for computing kazhdan - lusztig polynomials in explorations leading to this work .",
    "we begin by setting notation and basic definitions . we let @xmath5 denote the symmetric group on @xmath34 letters .",
    "we let @xmath35 denote the adjacent transposition which switches @xmath36 and",
    "@xmath37 ; the elements @xmath38 for @xmath39 generate @xmath5 . given an element @xmath40 , its * length * , denoted @xmath41 , is the minimal number of generators such that @xmath0 can be written as @xmath42 .",
    "an * inversion * in @xmath0 is a pair of indices @xmath43 such that @xmath44 .",
    "the length of a permutation @xmath0 is equal to the number of inversions it has .",
    "unless otherwise stated , permutations are written in one - line notation , so that @xmath45 is the permutation such that @xmath46 , @xmath47 , @xmath48 , and @xmath49 .",
    "given a permutation @xmath50 , the * graph * of @xmath0 is the set of points @xmath51 for @xmath52 .",
    "we will draw graphs according to the cartesian convention , so that @xmath53 is at the bottom left and @xmath54 the bottom right .",
    "the * rank function * @xmath55 is defined by @xmath56 for any @xmath57 .",
    "we can visualize @xmath58 as the number of points of the graph of @xmath0 in the rectangle defined by @xmath59 and @xmath60 .",
    "there is a partial order on @xmath5 , known as * bruhat order * , which can be defined as the reverse of the natural partial order on the rank function ; explicitly , @xmath61 if @xmath62 for all @xmath63",
    ". the bruhat order and the length function are closely related . if @xmath64 , then @xmath65 ; moreover , if @xmath64 and @xmath66 , then there exist ( not necessarily adjacent ) transpositions @xmath67 such that @xmath68 and @xmath69 for all @xmath36 , @xmath70 .",
    "now we briefly define schubert varieties .",
    "a * ( complete ) flag * @xmath71 in @xmath72 is a sequence of subspaces @xmath73 , with @xmath74 . as a set , the * flag variety * @xmath75 has one point for every flag in @xmath72 .",
    "the flag variety @xmath75 has a geometric structure as @xmath76 , where @xmath77 is the group of invertible upper triangular matrices , as follows .",
    "given a matrix @xmath78 , we can associate to it the flag @xmath71 with @xmath79 being the span of the first @xmath36 columns of @xmath80 .",
    "two matrices @xmath80 and @xmath81 represent the same flag if and only if @xmath82 for some @xmath83 , so complete flags are in one - to - one correspondence with left @xmath77-cosets of @xmath84 .",
    "fix an ordered basis @xmath85 for @xmath72 , and let @xmath86 be the flag where @xmath87 is the span of the first @xmath36 basis vectors . given a permutation @xmath50 , the * schubert cell * associated to @xmath0 , denoted @xmath88 ,",
    "is the subset of @xmath75 corresponding to the set of flags @xmath89 the conditions in [ eqn : schubvardef ] are called * rank conditions * the * schubert variety * @xmath9 is the closure of the schubert cell @xmath88 ; its points correspond to the flags @xmath90 bruhat order has an alternative definition in terms of schubert varieties ; the schubert variety @xmath9 is a union of schubert cells , and @xmath61 if and only if @xmath91 .",
    "in each schubert cell @xmath88 there is a * schubert point * @xmath92 , which is the point associated to the permutation matrix @xmath0 ; in terms of flags , the flag @xmath93 corresponding to @xmath92 is defined by @xmath94 .",
    "the schubert cell @xmath88 is the orbit of @xmath92 under the left action of the group @xmath77 .",
    "many of the rank conditions in  ( [ eqn : schubvardef ] ) are actually redundant .",
    "fulton @xcite showed that for any @xmath0 there is a minimal set , called the * coessential set * , of rank conditions which suffice to define @xmath9 .",
    "to be precise , the coessential set is given by @xmath95 and a flag @xmath71 corresponds to a point in @xmath9 if and only if @xmath96 for all @xmath97 .",
    "while we have distinguished between points in flag and schubert varieties and the flags they correspond to here , we will be freely ignore this distinction in the rest of the paper .",
    "let @xmath98 and @xmath50 , with @xmath99 .",
    "a * ( pattern ) embedding * of @xmath26 into @xmath0 is a set of indices @xmath100 such that the entries of @xmath0 in those indices are in the same relative order as the entries of @xmath26 .",
    "stated precisely , this means that , for all @xmath101 , @xmath102 if and only if @xmath103 .",
    "a permutation @xmath0 is said to * avoid * @xmath26 if there are no embeddings of @xmath26 into @xmath0 .",
    "now let @xmath104\\subseteq s_m$ ] and @xmath32\\subseteq s_n$ ] be two intervals in bruhat order .",
    "an * ( interval ) ( pattern ) embedding * of @xmath104 $ ] into @xmath32 $ ] is a simultaneous pattern embedding of @xmath105 into @xmath4 and @xmath26 into @xmath0 using the same set of indices @xmath100 , with the additional property that @xmath104 $ ] and @xmath32 $ ] are isomorphic as posets . for the last condition , it suffices to check that @xmath106  ( * ? ? ?",
    "* lemma 2.1 ) .    note that given the embedding indices @xmath100 , any three of the four permutations @xmath105 , @xmath26 , @xmath4 , and @xmath0 determine the fourth .",
    "therefore , for convenience , we sometimes drop @xmath4 from the terminology and discuss embeddings of @xmath104 $ ] in @xmath0 , with @xmath4 implied .",
    "we also say that @xmath0 * ( interval ) ( pattern ) avoids * @xmath104 $ ] if there are no interval pattern embeddings of @xmath104 $ ] into @xmath32 $ ] for any @xmath61 .",
    "now we describe combinatorially the singular loci of schubert varieties .",
    "the results of this section are due independently to billey and warrington @xcite , cortez @xcite , kassel , lascoux , and reutenauer @xcite , and manivel @xcite",
    ".    stated in terms of interval pattern embeddings as in  ( * ? ? ?",
    "6.1 ) , the theorem is as follows .",
    "we use the convention that the segment `` @xmath107 '' means @xmath108 .",
    "in particular , if @xmath109 then the segment is empty .",
    "[ thm : singlocus ] the schubert variety @xmath9 is singular at @xmath110 if and only if there exists @xmath4 with @xmath111 such that one of the following ( infinitely many ) intervals embeds in @xmath32 $ ] :    1 .   @xmath112 $ ] for some integers @xmath113 .",
    "2 .   @xmath114 $ ] for some integers @xmath115 .",
    "3 .   @xmath116 $ ] for some integer @xmath117 .",
    "equivalently , the irreducible components of the singular locus of @xmath9 are the subvarieties @xmath31 for which one of these intervals embeds in @xmath32 $ ] .",
    "we call irreducible components of the singular locus of @xmath9 type i or type ii ( or iia or iib ) depending on the interval which embeds in @xmath32 $ ] , as labelled above .",
    "we also wish to restate this theorem in terms of the graph of @xmath0 , which is closer in spirit to the original statements  @xcite .",
    "a type i component of the singular locus of @xmath9 is associated to an embedding of @xmath118 into @xmath0 .",
    "if we label the embedding by @xmath119 , the requirement that these positions give the appropriate interval embedding is equivalent to the requirement that the regions @xmath120 , @xmath121 , and @xmath122 contain no point @xmath123 in the graph of @xmath0 for all @xmath124 , @xmath125 , and for all @xmath126 , @xmath127 .",
    "this is illustrated in figure  [ fig : typeisingconfig ] .",
    "we will usually say that the type i component given by this embedding is defined by @xmath36 , the set @xmath128 , the set @xmath129 , and @xmath130 .",
    "every type ii component of the singular locus @xmath9 is defined by four indices @xmath131 which gives an embedding of @xmath6 into @xmath0 . the interval pattern embedding requirement forces the regions @xmath132 , @xmath133 , @xmath134 , and @xmath135 to have no points in the graph of @xmath0 .",
    "we call these regions the * critical regions * of the @xmath6 embedding , and if they are empty , we call @xmath131 a * critical @xmath6 embedding * whether or not they are part of a type ii component .    given a critical @xmath6 embedding @xmath131 , let @xmath136 , @xmath137 , @xmath138 , and @xmath139 .",
    "we call these regions the @xmath140 , @xmath141 , @xmath142 , and @xmath77 regions associated to our critical @xmath6 embedding .",
    "this is illustrated in figure  [ fig : typeiisingconfig ] .",
    "if @xmath143 for all @xmath144 , we say our critical @xmath6 embedding is * reduced*. if a critical embedding is not reduced , there will necessarily be at least one critical @xmath6 embedding involving @xmath36 , @xmath145 , and two indices in @xmath77 , and one involving two indices in @xmath77 , @xmath146 , and @xmath130 ; by induction each will include at least one reduced critical @xmath6 embedding .",
    "we associate one or two irreducible components of the singular locus of @xmath9 to every reduced critical @xmath6 embedding .",
    "if @xmath77 is empty , then the embedding is part of a component of type iia .",
    "if @xmath140 is empty , then the embedding is part of a component of type iib .",
    "note that any type ii component of the singular locus is associated to exactly one reduced critical @xmath6 embedding .",
    "however , if both @xmath140 and @xmath77 are nonempty , then we do not have a type ii component . in this case",
    ", we can associate a type i component of the singular locus to our reduced critical @xmath6 embedding @xmath131 .",
    "when both @xmath141 and @xmath77 are nonempty , then @xmath36 , a nonempty subset of @xmath141 , @xmath77 , and @xmath146 define a type i component ; in this case @xmath0 has an embedding of @xmath15 .",
    "when both @xmath142 and @xmath77 are nonempty , then @xmath145 , @xmath77 , a nonempty subset of @xmath142 , and @xmath130 define a type i component ; in this case @xmath0 has an embedding of @xmath14 .",
    "when @xmath141 , @xmath142 , and @xmath77 are all nonempty , we have two distinct type i components associated to our @xmath6 embedding .",
    "note that it is possible for a type i component to be associated to more than one reduced critical @xmath6 embedding , as in the permutation @xmath147 .",
    "we begin with the case where @xmath0 avoids @xmath6 ; such a permutation is commonly called * covexillary*. we show here that , if @xmath0 is covexillary , the singular locus of @xmath9 has only one component , and @xmath0 avoids @xmath12 and @xmath13 , then @xmath148 . throughout this section @xmath0",
    "is assumed to be covexillary unless otherwise noted .      for a covexillary permutation",
    ", the coessential set has the special property that , for any @xmath149 with @xmath150 , we also have @xmath151 .",
    "therefore have a natural total order on the coessential set , and we label its elements @xmath152 in order .",
    "we let @xmath153 ; note that , by the definition of @xmath55 and the minimality of the coessential set , @xmath154 when @xmath43 . when @xmath155 , we call @xmath156 an * inclusion element * of the coessential set , since the condition it implies for @xmath9 will either be @xmath157 ( if @xmath158 ) or @xmath159 ( if @xmath160 ) .",
    "zelevinsky  @xcite described some resolutions of singularities of @xmath9 in the case where @xmath0 has at most one ascent ( meaning that @xmath161 for at most one index @xmath36 ) , explaining a formula of lascoux and schtzenberger  @xcite for kazhdan - lusztig polynomials @xmath162 in that case . following a generalization by lascoux  @xcite of this formula to covexillary permutations , cortez  @xcite generalized the zelevinsky resolution to this case .",
    "let @xmath163 denote the partial flag manifold whose points correspond to flags whose component subspaces have dimensions @xmath164 .",
    "define the configuration variety @xmath165 by @xmath166 cortez shows that the projection @xmath167 is a resolution of singularities .",
    "she furthermore shows that the exceptional locus of @xmath168 is precisely the singular locus of @xmath9 , and describes a one - to - one correspondence between components of the singular locus of @xmath9 and elements of the coessential set which are not inclusion elements .",
    "( this last fact about the singular locus was implicit in lascoux s formula @xcite for covexillary kazhdan - lusztig polynomials . )",
    "we now have the following lemma , whose proof is deferred to section  [ sect : lemmas ] .    [ lem : covexonecomp ] suppose the singular locus of @xmath9 has only one component .",
    "if @xmath0 contains both @xmath169 and @xmath170 , then @xmath0 contains @xmath13 .",
    "this lemma allows us to treat separately the two cases where @xmath0 avoids @xmath169 and where @xmath0 avoids @xmath170 .",
    "we treat first the case where @xmath0 avoids @xmath169 , for which we use the resolution of singularities just described .",
    "the case where @xmath0 avoids @xmath170 requires the use of a resolution of singularities which is dual ( in the sense of dual vector spaces ) to the one just described ; we will describe this resolution at the end of this section .      in this subsection",
    "we show that @xmath148 when the singular locus of @xmath9 has exactly one component and @xmath0 avoids @xmath12 and @xmath169 . to maintain the flow of the argument , proofs of lemmas",
    "are deferred to section  [ sect : lemmas ] .    when @xmath171 is an inclusion element , then @xmath172 for any flag @xmath71 in @xmath9 and not merely generic flags in @xmath9 .",
    "therefore , given any @xmath71 we will have only one choice for @xmath173 , namely @xmath174 , in the fiber @xmath175 . in particular , for the flag @xmath86 , any @xmath176 in the fiber @xmath177 will have @xmath178 .",
    "now let @xmath36 be the unique index such that @xmath156 is not an inclusion element ; there is only one such index since the singular locus of @xmath9 has only one irreducible component . for convenience ,",
    "we let @xmath179 , @xmath180 , and @xmath181 .",
    "now we have the following lemmas .",
    "( in the case where @xmath182 , we define @xmath183 . )",
    "[ lem : covexfibub ] suppose @xmath0 avoids @xmath12 ( and @xmath6 )",
    ". then @xmath184 .",
    "[ lem : covexfiblb ] suppose @xmath0 avoids @xmath169 ( and @xmath6 )",
    ". then @xmath185 .    by definition ,",
    "therefore , the fiber @xmath187 is precisely @xmath188 this fiber is clearly isomorphic to @xmath189 .    by polo s interpretation @xcite of the decomposition theorem @xcite , @xmath190 where @xmath191 and the @xmath192 are some laurent polynomials in @xmath193 , depending only on @xmath26 and @xmath168 and not on @xmath194 , which have with positive integer coefficients and satisfy the identity @xmath195 .",
    "since the fiber of @xmath168 at @xmath196 is @xmath189 , it follows that @xmath197 . as @xmath198 ( since by assumption @xmath9 is singular ) , and all coefficients of all polynomials involved must be nonnegative integers , @xmath199 for all @xmath26 and @xmath200      when @xmath0 avoids @xmath170 instead , we use the resolution @xmath201 where @xmath202 .",
    "arguments similar to the above show that , if we let @xmath36 be the index so that @xmath156 does not give an inclusion element , the fiber @xmath203 is @xmath204    hence the fiber over @xmath196 is isomorphic to @xmath189 and @xmath148 by the same argument as above .",
    "in this section we treat the case where @xmath0 contains a @xmath6 pattern .",
    "our strategy in this case is to use another resolution of singularities given by cortez  @xcite .",
    "we will again apply the decomposition theorem @xcite to this resolution , but in this case the calculation is more complicated as the fiber at @xmath196 will no longer always be isomorphic to @xmath189 . when the fiber at @xmath196 is not @xmath189 , we will need to identify the image of the exceptional locus , which turns out to be irreducible , and calculate the generic fiber over the image of the exceptional locus as well as the fiber over @xmath196 .",
    "we then follow polo s strategy in @xcite to calculate that @xmath1 , where @xmath2 is the minimum height of a @xmath6 embedding as defined below .",
    "we begin with some definitions necessary for defining a variety @xmath205 and a map @xmath206 which we will show is our resolution of singularities .",
    "our notation and terminology generally follows that of cortez  @xcite .",
    "given an embedding @xmath20 of @xmath6 into @xmath0 , we call @xmath22 its * height ( _ hauteur _ ) * , and @xmath207 its * amplitude*. among all embeddings of @xmath6 in @xmath0 , we take the ones with minimum height , and among embeddings of minimum height , we choose one with minimum amplitude .",
    "as we will be continually referring this particular embedding , we denote the indices of this embedding by @xmath208 and entries of @xmath0 at these indices by @xmath209 , @xmath210 , @xmath211 , and @xmath212 .",
    "we let @xmath213 be the height of this embedding .",
    "let @xmath214 be the largest number such that @xmath215 and @xmath216 the smallest number such that @xmath217 .",
    "also let @xmath218 and @xmath219 .",
    "now let @xmath220 , let @xmath221 denote the set of simple transpositions @xmath222 , and let @xmath223 be @xmath224 .",
    "furthermore , let @xmath225 , where @xmath226 and @xmath227 denote the longest permutations in the parabolic subgroups of @xmath5 generated by @xmath223 and @xmath221 respectively .",
    "as an example , let @xmath228 ; its graph is in figure  [ fig : perm817396254 ]",
    ". then @xmath229 , @xmath230 , @xmath231 , and @xmath232 , while @xmath233 , @xmath234 , @xmath235 , and @xmath236 .",
    "we also have @xmath237 , @xmath238 and @xmath239 .",
    "hence @xmath240 and @xmath241 .",
    "now consider the variety @xmath242 . by definition",
    ", @xmath205 is a quotient of @xmath243 under the free action of @xmath244 where @xmath245 for any @xmath246 , @xmath247 , and @xmath248 . in the spirit of magyar",
    "s realization @xcite of full bott - samelson varieties as configuration varieties , we can also consider @xmath205 as the configuration variety    @xmath249    by the definition of @xmath26 , @xmath250 for @xmath251 , @xmath252 when @xmath253 , and @xmath254 when @xmath255 .",
    "the last condition is automatically satisfied since , as @xmath256 , we always have @xmath257 .",
    "cortez @xcite introduced the variety @xmath205 along with several other varieties ( constructed by defining @xmath258 for @xmath259 ) to help in describing the singular locus of schubert varieties embedding in @xcite is slightly different from ours . for technical reasons",
    "she chooses one of minimum amplitude among those satisfying a condition she calls `` well - filled '' ( _ bien remplie _ ) .",
    "as she notes , @xmath6 embeddings of minimum height are automatically `` well - filled '' . ] .",
    "a virtually identical proof would follow from analyzing the resolution given by @xmath260 instead of @xmath182 as we are doing , but the other choices of @xmath36 give maps which are harder to analyze as they have more complicated fibers .",
    "the variety @xmath205 has maps @xmath261 sending the orbit of @xmath262 to the class of @xmath263 under the right action of @xmath244 and @xmath206 sending the orbit of @xmath262 to @xmath264 . under the configuration space description",
    ", @xmath265 sends @xmath266 to the point in @xmath267 corresponding to the plane @xmath268 , and @xmath168 sends @xmath266 to @xmath71 .",
    "the map @xmath265 is a fiber bundle with fiber @xmath23 , and , by  ( * ? ? ?",
    "4.4 ) , the map @xmath168 is surjective and birational .",
    "( in our case where the singular locus of @xmath9 has only one component , the latter statement is also a consequence our proof of lemma  [ lem : excgeom ] . )    in general @xmath205 is not smooth ; hence @xmath168 is only a partial resolution of singularities .",
    "however , we show in section  [ sect : lemmas ] the following .    [",
    "lem : ressm ] suppose @xmath0 avoids @xmath14 and the singular locus of @xmath9 has only one irreducible component .",
    "then @xmath205 is smooth .",
    "we now describe of the fibers of @xmath168 . to highlight the main flow of the argument , proofs of individual lemmas",
    "will be deferred to section  [ sect : lemmas ] .",
    "define @xmath269 and @xmath270 .",
    "[ lem : fibgeom ] the fiber of @xmath168 over a flag @xmath71 is @xmath271    now we focus on the fiber at the identity , and show that it is isomorphic to @xmath272 .",
    "since the flag corresponding to the identity is @xmath86 , it suffices by the previous lemma to show that @xmath273 and @xmath274 .",
    "[ lem : fiblb ] suppose that the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath16",
    ". then @xmath273 .",
    "[ lem : fibub ] suppose that the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath17",
    ". then @xmath275 .    in the case",
    "where @xmath19 , these are all the geometric facts we need .",
    "when @xmath276 , we identify the image of the exceptional locus as @xmath31 for a particular permutation @xmath4 of length @xmath277 .",
    "we then show that the fiber over a generic point of @xmath31 is isomorphic to @xmath278 .",
    "first we describe the image of the exceptional locus geometrically .",
    "[ lem : excgeom ] suppose the singular locus of @xmath9 has only one component , and @xmath276 .",
    "then the image of the exceptional locus of @xmath168 is @xmath279 .",
    "now let @xmath280 be the cycle @xmath281 , and let @xmath282 .",
    "we show the following .",
    "[ lem : exccomb ] assume that the singular locus of @xmath9 has only one component , that @xmath276 , and that @xmath0 avoids @xmath15 .",
    "then the image of the exceptional locus of @xmath168 is @xmath31 , @xmath283 , and the generic fiber over @xmath31 is isomorphic to @xmath278 .",
    "we now have all the geometric information we need to calculate @xmath284 , following the methods of polo @xcite .",
    "the decomposition theorem @xcite shows that @xmath190 where @xmath191 and @xmath192 are some laurent polynomials in @xmath193 , depending on @xmath26 and @xmath168 but not @xmath194 , which have positive integer coefficients and satisfy the identity @xmath195 . has a stratification , compatible with @xmath168 , into schubert cells , all of which are simply connected . ]",
    "when @xmath19 , the fiber of @xmath168 at @xmath196 is isomorphic to @xmath189 , and so by same argument as in section  [ sect:53241-avoid ] , @xmath148 .    for @xmath276 ,",
    "let @xmath4 be the permutation specified above .",
    "for any @xmath105 with @xmath285 and @xmath286 , @xmath287 is a point , so @xmath9 is smooth at @xmath288 , and @xmath289 . therefore , by induction downwards from @xmath0 , @xmath290 for any @xmath105 with @xmath285 and @xmath286 .",
    "now we calculate @xmath291 . from the above",
    "it follows that @xmath292 . since @xmath293 has nonnegative coefficients and @xmath294 , @xmath295 for some @xmath126 , @xmath296 . then @xmath297 , so @xmath298 .",
    "since @xmath299 , @xmath300 , so @xmath301    to calculate @xmath284 , note that @xmath302 , so @xmath303 evaluating at @xmath304 , we see that @xmath305 since @xmath306 , @xmath307 is a positive integer for all @xmath105 , and @xmath308 is a nonnegative integer for all @xmath105 , we must have that @xmath309 and @xmath310 for all @xmath311 .",
    "therefore , @xmath312 and @xmath290 for all @xmath311 , and @xmath313    readers may note that the last computation is essentially identical to the one given by polo in the proof of ( * ? ? ?",
    "2.4(b ) ) . in fact",
    ", in this case the resolution we use , due to cortez @xcite , is very similar to the one described by polo .",
    "[ rem : comb - calc ] we could have used a simultaneous bialynicki - birula cell decomposition  @xcite of the @xmath205 and @xmath9 , compatible with the map @xmath168 , to combinatorialize the above computation , turning many geometrically stated lemmas into purely combinatorial ones . to be specific , for any @xmath4 , the number @xmath314 is the number of factorizations @xmath315 such that @xmath316 , @xmath317 , and @xmath318 is maximal in its right @xmath319 coset .",
    "( the last condition can be replaced by any condition that forces us to pick at most one @xmath318 from any @xmath319 coset . )",
    "this observation does not simplify the argument ; the combinatorics required to determine which factorizations of the identity satisfy these conditions are exactly the same as the combinatorics used above to calculate the fiber of @xmath168 at the identity .",
    "it should also be possible to combinatorially calculate @xmath320 by attaching the appropriate statistic to such a factorization .",
    "if @xmath205 were the full bott - samelson resolution , the result would be deodhar s approach @xcite to calculating kazhdan - lusztig polynomials , and the aforementioned statistic would be his defect statistic .",
    "however , when @xmath205 is some other resolution , even one `` of bott - samelson type , '' no reasonable combinatorial description of the statistic appears to be known .",
    "in this section we give proofs for the lemmas of sections  [ sect : covex ] and [ sect : not - covex ] .",
    "we begin with lemma  [ lem : covexonecomp ] .",
    "suppose the singular locus of @xmath9 has only one component .",
    "if @xmath0 contains both @xmath169 and @xmath170 , then @xmath0 contains @xmath13 .",
    "let @xmath321 be an embedding of @xmath169 , and @xmath322 an embedding of @xmath170 .",
    "since @xmath323 and @xmath324 , there must be an element @xmath60 of the coessential set such that @xmath325 and @xmath326 .",
    "this can not be an inclusion element since @xmath327 but @xmath328 , and @xmath329 but @xmath330 .",
    "we also have @xmath331 and @xmath332 , also inducing an element of the coessential set which is not an inclusion element .",
    "since the singular locus of @xmath9 has only one component , this element must also be @xmath60 .",
    "the pairs @xmath333 and @xmath334 also each induce an element of the coessential set which is not an inclusion element ; hence these must also be the same as @xmath60",
    ". therefore , @xmath335 , and @xmath336 .",
    "if @xmath337 and @xmath338 , then there must be an element @xmath339 of the coessential set with @xmath340 and @xmath341 .",
    "we now have @xmath342 but @xmath343 , contradicting @xmath0 being covexillary . therefore ,",
    "@xmath344 or @xmath345 .",
    "similarly , @xmath346 or @xmath347 .",
    "let @xmath348 be @xmath349 if @xmath345 and @xmath350",
    "if @xmath344 , and @xmath351 be @xmath352 if @xmath346 and @xmath353 if @xmath347 .",
    "now @xmath354 is an embedding of @xmath13 in @xmath0 .",
    "recall that @xmath355 is the unique element of the coessential set which is not an inclusion element , and @xmath356 .",
    "furthermore , @xmath357 is the immediately preceeding element of the coessential set , and @xmath358 .",
    "suppose @xmath0 avoids @xmath12 ( and @xmath6 )",
    ". then @xmath184 .",
    "suppose that @xmath359 ; we show that in that case we have an embedding of @xmath6 or @xmath12 .",
    "since @xmath360 , there exist @xmath361 with @xmath362 .",
    "note that @xmath363 , as , otherwise , @xmath364 would be an embedding of @xmath6 .",
    "similarly , since @xmath365 , there exist @xmath366 with @xmath367 , and we have @xmath368 since @xmath369 is an embedding of @xmath6 otherwise . furthermore , if @xmath370 , then @xmath371 , as otherwise @xmath372 would be an embedding of @xmath6 , and if @xmath373 , then @xmath374 to avoid @xmath375 being a similar embedding .",
    "now we have up to four potential cases depending on whether @xmath376 or @xmath370 , and whether @xmath377 or @xmath373 . in each case",
    "we produce an embedding of @xmath12 . if @xmath376 and @xmath377 , then @xmath378 is such an embedding .",
    "if @xmath376 and @xmath373 , then we use @xmath379 .",
    "if @xmath370 and @xmath377 , then we use @xmath380 . finally , if @xmath370 and @xmath373 , @xmath381 produces the desired embedding",
    "suppose @xmath0 avoids @xmath169 ( and @xmath6 )",
    ". then @xmath185 .",
    "we treat the two cases where @xmath382 and @xmath383 separately .",
    "first suppose @xmath382 .",
    "suppose for contradiction that @xmath384 .",
    "then there must exist an index @xmath385 which contributes to @xmath386 but not to @xmath387 .",
    "this happens when @xmath388 and @xmath389 , but @xmath390 or @xmath391 .",
    "since @xmath392 and @xmath393 , there must be an element @xmath171 of the coessential set such that @xmath394 and @xmath395 .",
    "but then we have that @xmath396 or @xmath397 , contradicting the definition of @xmath357 as the next element smaller than @xmath156 in our total ordering of the coessential set .",
    "therefore , we must have @xmath398 .",
    "now suppose @xmath383 .",
    "since @xmath399 and @xmath400 , there exists @xmath392 with @xmath401 and @xmath402 with @xmath403 .",
    "note that we can not have both @xmath373 and @xmath404 , as , otherwise , @xmath375 would be an embedding of @xmath6 .",
    "it then follows that we can not have both @xmath376 and @xmath371 ; when @xmath377 , @xmath376 and @xmath371 imply that @xmath405 is an embedding of @xmath169 , and when @xmath374 , @xmath376 and @xmath371 imply that @xmath406 is an embedding of @xmath169",
    ". therefore , @xmath370 or @xmath407 , and we now treat these two cases separately .",
    "suppose @xmath370 .",
    "we must have @xmath371 in this case , because otherwise @xmath372 would be an embedding of @xmath6 .",
    "let @xmath408 .",
    "we show that , for all @xmath409 with @xmath410 , @xmath411 .",
    "first , we can not have both @xmath412 and @xmath404 , as @xmath413 would be an embedding of @xmath6 otherwise . now ,",
    "if @xmath414 , then @xmath415 is an embedding of @xmath6 , and if @xmath416 , then either @xmath417 or @xmath418 would be an embedding of @xmath169 , depending on whether @xmath419 or @xmath374 .",
    "we have now established that there is an element of the coessential set at @xmath420 .",
    "since this shares its second coordinate with @xmath60 , and @xmath401 for all @xmath421 , @xmath422 , there are no elements of the coessential set in between , and @xmath423 , so that @xmath424 .",
    "now , @xmath425 .",
    "the latter list has just one element , namely @xmath426 , so @xmath398 .",
    "now suppose @xmath407 instead",
    ". then we let @xmath427 . by arguments symmetric with the above , for all @xmath428 with @xmath429 , @xmath430 .",
    "therefore , there is an element of the coessential set at @xmath431 , and this is the element immediately before @xmath60 in the total ordering .",
    "furthermore , @xmath432 , and the latter list has one element , namely @xmath433 , so @xmath398 .    before moving on to prove the lemmas of section  [ sect : not - covex ] , we prove the following two lemmas which will be repeatedly used further . as in section  [ sect : not - covex ] , @xmath208 is an embedding of @xmath6 of minimal amplitude among such embeddings of minimal height , and @xmath434 , @xmath435 , @xmath436 , and @xmath437 respectively denote @xmath438 , @xmath439 , @xmath440 , and @xmath441 .    for lemmas  [ lem : ressm ] , [ lem : onecompempty ] , and [ lem : mnempty ]",
    ", we use the description of the singular locus given in section  [ sect : singlocusdesc ] .",
    "it is worth noting that , since we only need to detect when the singular locus has more than one irreducible component , it is also possible to prove these lemmas using lemma  [ lem : num - sing - comps ] ( which was originally ( * ? ? ?",
    "* sect . 13 ) ) .",
    "another alternate approach is first to directly prove theorem [ thm : pats ] by using the condition of avoiding all its patterns instead of the condition of having one component in the singular locus in the lemmas and then to prove theorem [ thm : main ] as a corollary .",
    "neither approach appears to substantially reduce the need for detailed case - by - case analysis in the proof of these lemmas .",
    "[ lem : onecompempty ] suppose the singular locus of @xmath9 has only one component .",
    "then the following sets are empty .    1 .",
    "@xmath442 2 .",
    "@xmath443 3 .",
    "@xmath444 4 .",
    "@xmath445 5 .",
    "@xmath446 6 .",
    "@xmath447 7 .",
    "@xmath448 8 .",
    "@xmath449 9 .",
    "@xmath450 10 .",
    "@xmath451 11 .",
    "@xmath452 12 .",
    "@xmath453    most of this lemma and its proof is implicitly stated by cortez , scattered as parts of the proofs of various lemmas in  ( * ? ? ?",
    "the empty regions are illustrated in figure  [ fig : lemonecompemptyregions ] .",
    "if @xmath263 is in the set ( vi ) , then @xmath454 is a @xmath6 embedding with height less than that of @xmath208 . if @xmath263 is in ( iii ) or ( iv ) , then @xmath455 is a @xmath6 embedding of the same height but smaller amplitude than @xmath208 .",
    "similar arguments apply to ( ix ) , ( x ) , and ( xii ) .",
    "now we show that , if one of the other sets is nonempty , the singular locus of @xmath9 must have at least two components .",
    "note that by the emptiness of ( iv ) , ( vi ) , ( x ) , and ( xii ) @xmath208 is a critical @xmath6 embedding , and by the minimality of its height it must be reduced .",
    "suppose the set ( v ) is nonempty ; let @xmath263 be the largest element of ( v ) .",
    "let @xmath456 ; if @xmath457 is nonempty , then @xmath458 is a @xmath6 embedding of smaller height than @xmath208 for any @xmath459",
    ". now suppose @xmath457 is empty .",
    "if the @xmath142 region associated to @xmath208 is also empty , then @xmath460 is a reduced critical @xmath6 embedding .",
    "the top critical region is empty by our choice of @xmath263 , the left critical region is empty by ( iv ) and the emptiness of @xmath457 , the bottom critical region is empty by ( x ) , and the right critical region is empty by ( xii ) and the emptiness of @xmath142 ; furthermore it is reduced since @xmath208 is reduced . since @xmath461 and @xmath385 , the components of the singular locus associated to these critical @xmath6 embeddings must be different , even if they are of type i. if @xmath141 or @xmath77 is empty , then @xmath455 is a reduced critical @xmath6 embedding .",
    "the critical regions are empty by the choice of @xmath263 , the emptiness of @xmath457 , and the emptiness of ( iv ) , ( vi ) , ( x ) , and ( xii ) . since @xmath385 , the only way the two critical @xmath6 embeddings gave rise to the same component is for the component to be a type i component using elements of both @xmath141 and @xmath77 , but one of these sets is empty in this case . if @xmath141 , @xmath142 , and @xmath77 are all nonempty , then the singular locus of @xmath9 must already have more than one component .",
    "suppose ( ii ) is nonempty ; let @xmath352 be the element of ( ii ) with the smallest value of @xmath462 . by the definition of @xmath214 and the emptiness of ( iii ) and",
    "( iv ) , either @xmath463 , or @xmath464 and @xmath465 .",
    "first we treat the case where @xmath463 .",
    "let @xmath466 .",
    "if @xmath276 , then @xmath467 is a @xmath6 embedding of height 1 and amplitude smaller than that of @xmath208 .",
    "if @xmath468 , then the same holds for @xmath469 .",
    "if @xmath19 and @xmath470 , then we have a type i component defined by @xmath352 , @xmath471 , which contains @xmath349 , a subset of @xmath472 that contains @xmath473 , and @xmath474 .",
    "this type i component can not be the component of the singular locus of @xmath9 associated to @xmath208 , since @xmath475 .",
    "now we treat the case where @xmath464 and @xmath465 .",
    "let @xmath36 be the largest element of @xmath476 .",
    "let @xmath145 be the smallest element of @xmath477 , a set which contains @xmath478 .",
    "let @xmath146 be the smallest element of @xmath479 , a set which contains @xmath474",
    ". then @xmath480 is a reduced critical @xmath6 embedding .",
    "the only portion of the critical region not directly guaranteed empty by the definitions of @xmath36 , @xmath352 , @xmath145 , and @xmath146 is @xmath481 ; if @xmath130 is an element of this set then @xmath482 is a @xmath6 embedding of height smaller than @xmath208 .",
    "since @xmath483 and @xmath484 , this must produce a second component of the singular locus of @xmath9 .",
    "this shows ( ii ) must be empty .",
    "suppose ( i ) is nonempty ; let @xmath352 be the largest element of ( i ) .",
    "then the singular locus of @xmath9 has a type i component defined by @xmath352 , a set of which @xmath349 is the largest element , a set of which @xmath421 is the largest element , and @xmath485 .    the proofs that ( xi ) , ( viii ) , and ( vii ) are empty are entirely analogous to those for ( v ) , ( ii ) , and ( i ) respectively .    for the following lemma , recall the definitions @xmath269 and @xmath270 , given in section  [ sect : not - covex ] .",
    "[ lem : mnempty ] suppose the singular component of @xmath9 has only one component",
    ". then    1 .",
    "@xmath487 is empty .",
    "3 .   @xmath488 .",
    "@xmath489 is empty .",
    "this lemma is illustrated in figure  [ fig : lemmnemptyregions ]    we know that @xmath490 by definition , and @xmath491 by lemma [ lem : onecompempty ] ( x ) and ( xi ) .",
    "similarly , @xmath492 by definition , and @xmath493 by lemma [ lem : onecompempty ] ( vii ) and ( viii )",
    ".    now , assume for contradiction that @xmath494 is nonempty .",
    "let @xmath495 . by the definition of @xmath145 and lemma [ lem : onecompempty ] ( vi ) , @xmath496 .",
    "then @xmath497 is a reduced critical @xmath6 embedding defining a component of the singular locus in addition to the one defined by @xmath208 .",
    "similarly , suppose @xmath489 is nonempty .",
    "let @xmath498 . by the definition of @xmath145 and lemma [ lem : onecompempty ] ( xi ) , @xmath496 .",
    "then @xmath499 is a reduced critical @xmath6 embedding defining a component of the singular locus .",
    "we now proceed with the proof of the lemmas of section  [ sect : not - covex ] , beginning with lemma  [ lem : ressm ] .",
    "suppose the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath14 .",
    "let @xmath205 be constructed as above ; then @xmath205 is smooth .    since @xmath205 is a fibre bundle by the map @xmath265 over a smooth variety ( the grassmannian ) with fibre @xmath23 , it is smooth if and only if @xmath23 is .",
    "we show the contrapositive of our stated lemma by showing that , if @xmath23 is not smooth and @xmath0 avoids @xmath14 , then the singular locus of @xmath9 must have a component in addition to the one defined by the reduced critical @xmath6 embedding @xmath208 .",
    "assume @xmath23 is singular .",
    "we choose a component of its singular locus .",
    "this component has a combinatorial description as in section  [ sect : singlocusdesc ] .    for convenience ,",
    "we let @xmath500 , @xmath501 , and so on with @xmath502 .",
    "similarly , we let @xmath503 , @xmath504 , and so on with @xmath505 and @xmath506 .",
    "we also let @xmath507 , @xmath508 , @xmath509 , and @xmath510 .",
    "first we handle the case where our chosen component of the singular locus of @xmath23 is of type i. if no index of the embedding into @xmath26 defining the component is in @xmath511 or @xmath512 , then the indices define an embedding of the same permutation into @xmath0 , and the sets required to be empty by the interval condition remain in exactly the same positions .",
    "the horizontal boundaries of these regions are all above @xmath214 or below @xmath216 , so these regions remain empty in @xmath0 .",
    "therefore , the same embedding indices will define a type i component of the singular locus of @xmath9 .",
    "this can not be the same as the component associated to the critical @xmath6 embedding @xmath208 ; even if the component associated to @xmath208 is of type i , it still must involve at least either @xmath349 or @xmath474 , whereas the component we just defined coming from the singular locus of @xmath23 involves neither .",
    "therefore , the singular locus of @xmath9 has at least two components .",
    "now suppose our chosen type i component includes some index in @xmath511 or @xmath512 .",
    "let its defining embedding into @xmath26 be given by @xmath513 .",
    "define the sets @xmath514 and @xmath515 by @xmath516 and @xmath517 .",
    "we first show that one of @xmath511 and @xmath512 contains no part of the embedding . if @xmath518 and @xmath519 are both in the embedding , then since @xmath520 and @xmath521 , @xmath522 and @xmath523 .",
    "now we must have that @xmath524 , and that @xmath525 , since , by definition , @xmath526 and hence @xmath527 whenever @xmath528 .",
    "but then @xmath529 and @xmath530 , which is forbidden by lemma [ lem : onecompempty ] ( i ) and ( ii ) .    therefore , we have two cases , one where @xmath511 has some part of our type i embedding but @xmath512 does not , and one where @xmath512 has a part of our embedding but @xmath511 does not .",
    "we first tackle the case where @xmath511 contains a part of the embedding . in this case ,",
    "@xmath531 , since otherwise @xmath529 and @xmath532 , violating lemma  [ lem : onecompempty ] ( i ) or ( ii ) .",
    "having @xmath533 then implies that @xmath534 and @xmath535 as follows .",
    "first , we can not have @xmath536 because , otherwise , any @xmath124 and @xmath126 satisfying @xmath537 would satisfy @xmath538 , which contradicts @xmath36 and @xmath130 being the first and last indices of a type i embedding .",
    "second , @xmath539 must be empty because , if @xmath518 , @xmath540 implies @xmath541 for any @xmath146 , contradicting @xmath522 for any type i embedding starting with @xmath36 .",
    "we now have two subcases for the case where @xmath511 has a part of our type i embedding , depending on whether @xmath542 contains an index less than @xmath421 .",
    "if it does , then either @xmath543 or @xmath544 and @xmath545 for some @xmath126 . either way , the forbidden region for the type i embedding does not intersect @xmath546 .",
    "therefore @xmath547 defines a type i component of the singular locus of @xmath9 as well as @xmath23 .",
    "the forbidden region may be a little larger in @xmath0 , but it does not acquire any points in the graph of @xmath0",
    ". this can not be the same as any type i component of the singular locus of @xmath9 associated to @xmath208 since both @xmath514 and @xmath515 contain indices outside of the region @xmath77 associated to @xmath208 .",
    "in the other case , since @xmath548 , we must have @xmath549 by lemma [ lem : onecompempty ] ( x ) , ( xi ) , ( vii ) , and ( viii ) .",
    "one possibility is that @xmath550 . in this case , taking the type i embedding in @xmath26 and adding @xmath551 to @xmath515 gives a type i component of the singular locus of @xmath9 .",
    "both @xmath514 and @xmath515 contain indices outside of @xmath77 , so this will also be a second component of the singular locus of @xmath9 .    if , on the other hand , @xmath552 , then @xmath553 by the following argument .",
    "an example of this case is in figure  [ fig : typeihardcase ] . by lemma [ lem : onecompempty ] ( ix ) , @xmath554 .",
    "furthermore , @xmath555 and @xmath556 for all @xmath557 as follows .",
    "if @xmath558 and @xmath559 ( allowing for @xmath560 in which case we define @xmath561 ) , the forbidden region @xmath562 for our type i embedding contains @xmath563 as @xmath564 by lemma [ lem : onecompempty ] ( ix ) .",
    "if @xmath565 for some @xmath566 , then @xmath567 , and hence @xmath568 by lemma [ lem : onecompempty ] ( ix ) ; now the forbidden region @xmath569 contains @xmath563 .",
    "recall that @xmath570 has no index less than @xmath421 in the case under consideration .",
    "therefore , by lemma [ lem : onecompempty ] ( xi ) , no index @xmath571 satisfies @xmath572 , @xmath573 . as @xmath574 , @xmath575 , and @xmath555 and @xmath556 for all @xmath557 , we must have @xmath576 as otherwise @xmath563 would be in a forbidden region . therefore",
    ", taking the type i embedding in @xmath26 and adding @xmath551 to @xmath515 also gives a type i component of the singular locus of @xmath9 distinct from any associated to @xmath208 .    now suppose @xmath512 contains some part of the embedding but @xmath511 does not . if @xmath577 , then @xmath530 , so by lemma [ lem : onecompempty ] ( i ) and ( ii ) , @xmath578 . if @xmath579 , we also have @xmath578 .",
    "( actually , we can not have @xmath580 but do not need this fact . )",
    "therefore , @xmath513 also defines a type i component of the singular locus of @xmath9 , since , as the forbidden region does not intersect @xmath581 , no points of the graph of @xmath0 move into the forbidden region .",
    "this type i component can be the same as one associated to the critical @xmath6 embedding @xmath208 , but only if @xmath0 has an embedding of @xmath14 .",
    "we have completed the case where our chosen component of the singular locus of @xmath23 is of type i ; now we move on to the case where it is of type ii .",
    "let @xmath131 be the reduced critical @xmath6 embedding associated to this component of the singular locus of @xmath23 . if none of @xmath36 , @xmath145 , @xmath146 , and @xmath130 are in @xmath511 or @xmath512 , then the critical regions are in the same place in both @xmath26 and @xmath0 , and they remain empty",
    ". therefore , they produce a component of the singular locus of @xmath9 which must not be the same as the one associated to @xmath208 as their reduced critical @xmath6 embeddings are different .",
    "now we first consider the case where @xmath512 has a part of the critical embedding but @xmath511 does not .",
    "if @xmath579 , then @xmath578 , so the critical region as well as the regions @xmath140 and @xmath77 associated to @xmath131 do not intersect @xmath582 , and @xmath131 is also a reduced critical @xmath6-embedding producing a type ii component of the singular locus of @xmath9 . if @xmath583 , then @xmath584 , and , since @xmath585 by assumption , @xmath586 . since @xmath587",
    ", we therefore also have that @xmath588 fails to intersect the critical regions or the regions @xmath140 and @xmath77 , and @xmath131 is a critical @xmath6 embedding producing a type ii component of the singular locus of @xmath9 . otherwise , @xmath589 and @xmath525 , so by lemma [ lem : onecompempty ] ( i ) and",
    "( ii ) , @xmath578 , implying that @xmath131 produces a type ii component of the singular locus of @xmath9 .",
    "since @xmath131 is not @xmath208 , we must have produced a second component of the singular locus of @xmath9 in all of these cases .",
    "now suppose @xmath511 has part of the critical embedding .",
    "we can not have @xmath590 or @xmath591 , since otherwise we would have @xmath592 with @xmath593 , which forces @xmath594",
    ". then @xmath595 and @xmath596 , violating lemma [ lem : onecompempty ] ( i ) or ( ii ) .",
    "therefore , @xmath597 or @xmath533 .    if @xmath598 , then since @xmath43 and @xmath599 , @xmath586 , and so @xmath600 .",
    "now if @xmath601 , @xmath131 is a reduced critical @xmath6 embedding in @xmath0 .",
    "it may have an element in its @xmath142 region in @xmath0 that when there is none in its @xmath142 region in @xmath26 , but in that case either the @xmath77 region is empty or @xmath0 fails to avoid @xmath14 .",
    "when @xmath0 avoids @xmath14 , @xmath131 produces a second type ii component of the singular locus of @xmath9 .",
    "if @xmath598 and @xmath602 , then by lemma [ lem : onecompempty ] ( x ) and ( xi ) , @xmath603 .",
    "moreover , we can not have @xmath604 as , in that case , @xmath605 and @xmath606 , violating lemma [ lem : onecompempty ] ( viii ) or ( ix ) . therefore , @xmath607 , and , as @xmath608 , @xmath609 by lemma [ lem : onecompempty ] ( vii ) and ( viii ) . since @xmath610",
    ", we now must have that @xmath611 in order for @xmath131 to be a critical @xmath6 embedding in @xmath26 .",
    "if @xmath19 and hence @xmath551 is empty , then @xmath131 is a critical @xmath6 embedding in @xmath0 with @xmath140 or @xmath77 empty as they are in @xmath26 . if @xmath276 , let @xmath612 ; this set is nonempty because @xmath36 is an element",
    ". then @xmath613 is a reduced critical embedding of @xmath6 in @xmath0 , and the component of the singular locus of @xmath9 it produces , whether it is type i or type ii , must be different from the one associated to @xmath208 .",
    "this last case is illustrated in figure  [ fig : typeiihardcase ] .",
    "finally we tackle the case where @xmath533 . if @xmath543 , then @xmath131 is a reduced critical @xmath6 embedding in @xmath0 .",
    "otherwise , @xmath614 by lemma [ lem : onecompempty ] ( x ) and ( xi ) , and hence @xmath615 .",
    "if @xmath572 , then @xmath616 , so @xmath617 by definition .",
    "we then have @xmath618 with @xmath619 , which is forbidden by lemma [ lem : onecompempty ] ( i ) , ( ii ) , and ( iii ) and lemma [ lem : mnempty ] ( ii ) .",
    "we can not have @xmath604 since in that case @xmath620 and @xmath621 , violating lemma [ lem : onecompempty ] ( viii ) or ( ix ) . if @xmath622 then we have @xmath623 . in this case",
    "@xmath624 is a critical @xmath6 embedding in @xmath0 .",
    "in particular , @xmath625 is empty by lemma [ lem : onecompempty ] ( iv ) and lemma [ lem : mnempty ] ( iv ) . since @xmath626 and @xmath627 ,",
    "the associated component of the singular locus of @xmath9 must be different from the component associated to @xmath208 .",
    "we have now shown that , unless @xmath14 embeds in @xmath0 , no matter what singularity @xmath23 may have , it must produce a second component of the singular locus of @xmath9 , either directly or through the use of lemma [ lem : onecompempty ] or lemma [ lem : mnempty ] . therefore",
    ", if the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath14 , @xmath23 , and hence @xmath205 , is nonsingular .",
    "now we continue on to proving the lemmas of section  [ sect : nonvexfibers ] .",
    "the fiber of @xmath168 over a flag @xmath71 is @xmath271    by definition of @xmath205 , @xmath628 .",
    "we need to show that @xmath629 , that @xmath630 , and that any such subspace @xmath631 is in @xmath175 .    to show that @xmath629",
    ", we show that @xmath632 .",
    "this is equivalent to showing that @xmath633 is empty , which is in turn equivalent to showing that @xmath634 and @xmath635 are both empty .",
    "the first follows from lemma [ lem : onecompempty ] ( vi ) since @xmath491 by lemma [ lem : mnempty ] ( i ) .",
    "the second follows from lemma [ lem : onecompempty ] ( i ) and ( ii ) and lemma [ lem : mnempty ] ( ii ) .",
    "now we show @xmath630 .",
    "this means showing that @xmath636 , or that @xmath637 is empty .",
    "this is equivalent to showing that @xmath638 and @xmath639 are both empty .",
    "the first is empty by the definition of @xmath640 , and the second is empty by the definition of @xmath214 .    to show that any @xmath631 satisfying @xmath641 is in @xmath175 , we need to show that @xmath642 for any @xmath145 with @xmath643 .",
    "it suffices to show that @xmath644 when @xmath645 , and that @xmath646 when @xmath647 .",
    "equivalently , this means that @xmath648 when @xmath645 and @xmath649 when @xmath650 .    since @xmath651 if and only if @xmath652 or @xmath653 , the first condition is clear from the definition of @xmath654 .",
    "we also have that @xmath493 by lemma [ lem : mnempty ] ( iii ) , so we need that @xmath489 is empty , which follows from lemma [ lem : mnempty ] ( iv ) .",
    "therefore , @xmath646 when @xmath647 , and any @xmath631 satisfying @xmath655 is in @xmath175 .",
    "suppose that the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath16",
    ". then @xmath273 .    since @xmath632 , @xmath656 , and @xmath657 , @xmath658 , so @xmath659 . if @xmath660 , then @xmath661 , so @xmath662 . otherwise , we need to show that @xmath663 . since @xmath664",
    ", so that @xmath665 is empty , this is equivalent to showing that @xmath666 has only one element , namely @xmath478 .    by the definition of @xmath654",
    ", @xmath667 is empty .",
    "furthermore , by lemma [ lem : onecompempty ] ( vii ) , ( viii ) , and ( ix ) , @xmath448 , @xmath668 , and @xmath669 are empty .",
    "this leaves @xmath670 , which is empty since @xmath671 and @xmath0 avoids @xmath16 .",
    "suppose that the singular locus of @xmath9 has only one component and @xmath0 avoids @xmath17",
    ". then @xmath275 .",
    "first , note that @xmath672 , since @xmath673 , and the first summand is @xmath636 , while the second summand is at least @xmath2 since the @xmath2 elements @xmath674 are in the set . if @xmath675 , then @xmath676 . otherwise , we need to show that @xmath677 .",
    "this means showing that @xmath678 has exactly @xmath2 elements , or , equivalently , that @xmath679 contains only @xmath421 .",
    "we know that @xmath489 is empty by lemma [ lem : mnempty ] ( iv ) , and , by lemma [ lem : onecompempty ] ( i ) , ( ii ) , and ( iii ) , @xmath442 , @xmath443 , and @xmath680 are empty .",
    "this leaves @xmath681 , which is empty since @xmath682 and @xmath0 avoids @xmath17 .",
    "suppose the singular locus of @xmath9 has only one component , and @xmath276 .",
    "then the image of the exceptional locus of @xmath168 is @xmath683    first we show that @xmath684 . by the definition of @xmath640 , @xmath636 , so the two sets @xmath685 and @xmath686 have @xmath687 elements combined . since @xmath688 by definition and @xmath493 by lemma [",
    "lem : onecompempty ] ( vii ) and ( viii ) , @xmath689 has precisely the @xmath690 elements @xmath691 .",
    "therefore , @xmath692 generically .",
    "now we calculate @xmath693 .",
    "note that @xmath694 generically , @xmath695 and @xmath696 therefore , generically , @xmath697    recall that , by lemma  [ lem : fibgeom ] , the fiber over a flag @xmath71 is @xmath698 therefore , since @xmath699 , the fiber over @xmath71 consists of the single point corresponding to the subspace @xmath700 generically ; here , the generic situation occurs whenever @xmath701 . when @xmath19 , we also have that @xmath702 in the generic situation , and we also need @xmath703 in order for the fiber over @xmath71 to consist of more than a point .",
    "however , when @xmath276 , @xmath704 has more than one point whenever @xmath705 , so the image of the exceptional locus is @xmath706 as desired .",
    "recall that @xmath4 is defined by @xmath282 , where @xmath280 is the cycle @xmath707 .",
    "assume that @xmath276 and @xmath0 avoids @xmath15 .",
    "then the image of the exceptional locus of @xmath168 is @xmath31 , @xmath283 , and the generic fiber over @xmath31 is isomorphic to @xmath278 .",
    "suppose @xmath71 is in the image of the exceptional locus , and let @xmath708 be the schubert cell containing @xmath71 .",
    "our strategy is to show using rank matrices that @xmath709 . as part of this proof , we show that a certain region of the graph of @xmath0 is empty , which will imply that @xmath283 .",
    "first we compare the rank matrices @xmath710 and @xmath55 .",
    "let @xmath711 denote the region @xmath712 and @xmath713 when @xmath714 . since @xmath715 where @xmath716 and @xmath717 when @xmath714 , we get that @xmath718 if @xmath60 is in @xmath719 for some @xmath36 , and @xmath720 otherwise .",
    "let @xmath721 denote the union @xmath722 .",
    "the region @xmath721 is drawn in figure  [ fig : exccombregion ] .",
    "now we show that , when @xmath723 , then @xmath58 is as small as possible given that @xmath724 and given that , as for any permutation and any @xmath263 and @xmath725 , @xmath726 and @xmath727 .",
    "to be precise , this means that , assuming @xmath60 and @xmath728 are both in @xmath721 , @xmath729 if @xmath730 and @xmath731 otherwise , and , assuming @xmath60 and @xmath732 are both in @xmath721 , @xmath733 if @xmath734 with @xmath735 otherwise .    to prove the above claim",
    ", we need to show that @xmath721 contains no point in the graph of @xmath0 , that @xmath736 when @xmath737 , and that @xmath738 when @xmath739 . since @xmath276 and @xmath0 avoids @xmath15 , @xmath740 .",
    "also , @xmath741 and @xmath742 are empty by lemma [ lem : onecompempty ] ( vi ) and ( x ) .",
    "the remaining portion of @xmath721 contains no point in the graph of @xmath0 since , as @xmath208 is a @xmath6 embedding of minimal height , @xmath743 by @xmath208 .",
    "furthermore , using that @xmath721 contains no point of the graph of @xmath0 , @xmath736 when @xmath744 by lemma [ lem : mnempty ] ( ii ) , and @xmath738 when @xmath739 by lemma [ lem : onecompempty ] ( viii ) and ( ix ) .",
    "suppose @xmath708 is in the image of the exceptional locus , so that @xmath285 and @xmath745 .",
    "we show that @xmath746 for all @xmath263 and @xmath725 .",
    "if @xmath60 is not in @xmath721 , this follows since @xmath285 . for @xmath723",
    ", @xmath58 is the minimum possible given that @xmath724 .",
    "since @xmath747 , it follows that @xmath748 for @xmath723 .",
    "therefore , @xmath749 when @xmath60 is in @xmath721 , and @xmath709 .",
    "since the regions @xmath719 are empty , multiplication by each transposition @xmath750 ,  , @xmath751 decreases the length of @xmath0 by @xmath752 , and @xmath277 .    since @xmath753 if and only if @xmath754 , @xmath755 .",
    "therefore , @xmath756 for @xmath757 .",
    "moreover , for @xmath758 , @xmath759 therefore , the generic fiber over @xmath31 is isomorphic to @xmath278 .",
    "let @xmath760 be the union of @xmath761 for all @xmath762 .",
    "there exists a partial order on @xmath760 determined by pattern embeddings ; we say @xmath763 if there is a pattern embedding of @xmath26 into @xmath0 . if the embedding of @xmath26 into @xmath0 is given by the set of indices @xmath764 , then we write @xmath765 , i.e. , that the `` flattened '' version of @xmath0 consisting only of the indices in @xmath205 is the permutation @xmath26 .",
    "consider the set @xmath766 for any positive integer @xmath130 . by",
    "1 ) , we know @xmath767 is the complement of a lower order ideal in the poset of pattern embeddings .",
    "therefore , @xmath767 can be characterized by pattern avoidance for every @xmath768 .",
    "for example , @xmath769 is the set of permutations avoiding @xmath770 and @xmath6 .",
    "the following theorem gives a minimal set of patterns characerizing @xmath771 .",
    "4 & 4 5 1 2 3 & & 3 4 5 1 2 & & 5 3 4 1 2 & & 5 2 3 4 1 + & 4 5 2 3 1 & & 3 5 1 6 2 4 & & 5 2 3 6 1 4 & & 5 2 6 3 1 4 + & 6 2 4 1 5 3 & & 5 2 4 6 1 3 & & 4 6 2 5 1 3 & & 5 2 6 4 1 3 + & 5 4 6 2 1 3 & & 3 6 1 4 5 2 & & 4 6 1 3 5 2 & & 3 6 4 1 5 2 + & 4 6 3 1 5 2 & & 5 3 6 1 4 2 & & 4 6 5 1 3 2 & & 4 2 6 3 5 1 + & 6 3 2 5 4 1 & & 6 3 5 2 4 1 & & 6 4 2 5 3 1 & & 6 5 3 4 2 1 + & 3 6 1 2 7 4 5 & & 6 2 3 1 7 4 5 & & 6 2 4 1 7 3 5 & & 3 4 1 6 7 2 5 + & 4 2 3 6 7 1 5 & & 4 2 6 3 7 1 5 & & 4 2 6 7 3 1 5 & & 3 7 1 2 5 6 4 + & 7 2 3 1 5 6 4 & & 3 7 1 5 2 6 4 & & 3 7 5 1 2 6 4 & & 7 5 2 3 1 6 4 [ eqn:66pats ] + & 6 2 5 1 7 3 4 & & 7 2 6 1 4 5 3 & & 3 4 1 7 5 6 2 & & 3 5 1 7 4 6 2 + & 4 5 1 7 3 6 2 & & 4 2 3 7 5 6 1 & & 5 3 4 7 2 6 1 & & 4 2 7 5 6 3 1 + & 3 4 1 2 7 8 5 6 & & 4 2 3 1 7 8 5 6 & & 3 4 1 7 2 8 5 6 & & 4 2 3 7 1 8 5 6 + & 4 2 7 3 1 8 5 6 & & 3 5 1 2 7 8 4 6 & & 5 2 3 1 7 8 4 6 & & 5 2 4 1 7 8 3 6 + & 3 4 1 2 8 6 7 5 & & 4 2 3 1 8 6 7 5 & & 3 4 1 8 2 6 7 5 & & 4 2 3 8 1 6 7 5 + & 4 2 8 3 1 6 7 5 & & 3 4 1 8 6 2 7 5 & & 4 2 3 8 6 1 7 5 & & 4 2 8 6 3 1 7 5 + & 3 5 1 2 8 6 7 4 & & 5 2 3 1 8 6 7 4 & & 3 6 1 2 8 5 7 4 & & 6 2 3 1 8 5 7 4 + & 5 2 4 1 8 6 7 3 & & 6 2 5 1 8 4 7 3 .      given @xmath772 , the irreducible components of the singular locus of the schubert variety @xmath9",
    "are themselves schubert varieties .",
    "the set of permutations indexing these irreducible components is called the _ maximal singular locus _ , and is denoted by @xmath773 .",
    "the proof of theorem  [ t : kl2 ] follows from the next two lemmas relating the maximal singular locus of a schubert variety with patterns .",
    "13 ) [ lem : num - sing - comps ] consider a set @xmath205 such that @xmath774 or @xmath6 .",
    "then @xmath205 corresponds to a unique element of @xmath773 if and only if the pattern does not occur as the dotted part of one of the following patterns :      in contrast to theorem  [ thm : pats ] , it is interesting to note that the set @xmath776 is not characterized by pattern avoidance .",
    "for instance , the permutation @xmath777 has a maximal singular locus of size 2 , so @xmath778 .",
    "however @xmath779 , but @xmath0 has maximal singular locus of size 1 .      for each element @xmath783 of @xmath773 , let @xmath784 be the indices of @xmath0 such that @xmath785 is the @xmath770 or @xmath6 pattern corresponding to @xmath783 , and",
    "let @xmath205 be the union of @xmath786 .",
    "then @xmath787 , since each element of @xmath773 adds at most 4 indices to @xmath205 , so @xmath788 has at most @xmath781 entries .",
    "let @xmath789 .",
    "given @xmath790 , @xmath791 is a @xmath770 or @xmath6 pattern which is not a subpattern of one of the dotted patterns in ( [ eqn : useless ] ) . since @xmath792 , @xmath793 , so @xmath784 is a @xmath770 or @xmath6 pattern in @xmath26 as well .",
    "furthermore , it can not be a subpattern of one of the patterns in ( [ eqn : useless ] ) , since then it would be a subpattern of that pattern in @xmath0 as well .",
    "hence @xmath784 corresponds to a unique element of @xmath794 .",
    "so @xmath795 , as desired .",
    "by theorem  [ thm : main ] , @xmath771 is the set of permutations which have at most 1 elements in the maximal singular locus and avoid @xmath796 if @xmath797 , then either it contains a pattern in or it has at least two elements in its maximal singular locus .",
    "the patterns of are in .",
    "we claim that any @xmath798 with @xmath799 contains a pattern in .",
    "therefore , @xmath797 contains a pattern from .    to prove the claim , note by lemma  [ thm : me ] that there exists @xmath800 such that @xmath763 and @xmath801 .",
    "a computer check establishes that contains all the minimal patterns in @xmath802 not in @xmath771 , hence @xmath0 contains one such pattern .",
    "conversely , if @xmath803 contains a pattern @xmath26 in , then a computer verification shows that @xmath804 so by @xcite , @xmath805 .",
    "hence , @xmath0 is not in @xmath771 .",
    "therefore , the patterns of characterize @xmath771 , as desired .      1 .",
    "can @xmath806 always be characterized by a finite number of patterns ? 2 .",
    "if so , can the minimal elements of the complement of @xmath806 be determined efficiently ?",
    "3 .   we know",
    "the maximal singular locus is efficient to calculate .",
    "can we use information about @xmath773 to give bounds for @xmath809 ?",
    "j.  carrell , _ torus actions and cohomology _ , in _ algebraic quotients .",
    "torus actions and cohomology . the adjoint representation and the adjoint action _ , encyclopaedia math .",
    "sci . * 131 * , springer - verlag , berlin ( 2002 ) , 83158 .",
    "d.  kazhdan and g.  lusztig , _",
    "schubert varieties and poincar duality _ , in _ geometry of the lapalce operator ( proc .",
    "pure math .",
    "hawaii , honolulu , hawaii , 1979 ) _ , proc .",
    "pure math .",
    ", * 36 * , amer .",
    "soc . , providence , ri ( 1980 ) , 185203 ."
  ],
  "abstract_text": [
    "<S> using resolutions of singularities introduced by cortez and a method for calculating kazhdan - lusztig polynomials due to polo , we prove the conjecture of billey and braden characterizing permutations @xmath0 with kazhdan - lusztig polynomial @xmath1 for some @xmath2 . </S>"
  ]
}