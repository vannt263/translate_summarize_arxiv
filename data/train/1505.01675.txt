{
  "article_text": [
    "a sudden quench of the hamiltonian parameters is perhaps the simplest form of out - of - equilibrium dynamics that a closed quantum system can experience .",
    "experiments with `` virtually isolated '' cold atomic species in optical lattices  @xcite have transformed this seemingly theoretical dream into a rich and lively stage . several fundamental issues of theoretical quantum statistical physics , like the onset of thermalization which is generally expected to occur for a closed quantum system after a sudden quench @xcite , or the `` breakdown of thermalization '' @xcite expected when the system is integrable or nearly integrable , are now of experimental relevance @xcite .",
    "we refer the reader to a recent review @xcite for an extensive introduction to such non - equilibrium quantum dynamics issues .",
    "the issue we want to tackle in this paper is the following .",
    "suppose you perform a quantum quench of the hamiltonian parameters , abruptly changing , at @xmath0 , from @xmath1 .",
    "if @xmath2 denotes the initial quantum state at @xmath0 , and @xmath3 the eigenstates of @xmath4 with energy @xmath5 , the ensuing quantum dynamics would lead to averages for any given operator @xmath6 given by : @xmath7 where @xmath8 and @xmath9 . the first ( time - independent ) term in the previous expression",
    "dominates the long - time average of @xmath10 , and is usually known as _ diagonal average _",
    "@xcite @xmath11 to calculate it , in principle , we should take the sum over all the ( many - body ) eigenstates @xmath12 of @xmath4  an exponentially large number of states  , calculating for each of them the overlap @xmath13 and the associated diagonal matrix element @xmath14 .",
    "luckily , @xmath15 can be calculated for many problems , notably those that can be reduced to quadratic fermionic problems , by circumventing in one way or another exponentially large sums : for instance , through a detour to time - dependent single - particle green s function and the use of wick s theorem , see e.g.  @xcite . but suppose that you want to know more than just the diagonal average @xmath15 , and pretend to have information on the whole distribution of the values of @xmath16 accessed after the quench  @xcite , i.e. , @xmath17 of which @xmath15 is just the average : @xmath18 .",
    "here there is , evidently , a problem : knowing the distribution of @xmath19 requires exploring the full many - body hilbert space , summing over the eigenstates @xmath12 , and this exhaustive enumeration would restrict our calculations to exceedingly small sample sizes , although all information on @xmath13 and @xmath14 might in principle be easy to calculate , or in any case accessible , for instance by just solving a one - body problem ( hence , for much larger sizes ) .",
    "a similar problem occurs in considering , for instance , the corresponding   generalized gibbs ensemble ( gge ) average  @xcite @xmath20 where @xmath21 are lagrange multipliers which constrain the mean value of each of the constants of motion @xmath22 to their @xmath0 value , @xmath23 $ ] , @xmath24 , @xmath25 is the gge partition function , and @xmath26 . once again , for `` quadratic problems '' this average is rather simply calculated in terms of single - particle quantities , but the corresponding distribution @xmath27 requires a difficult sum over the hilbert space .. these tricks however would not work , for instance , for the microcanonical distribution . ]    concerning the issue of thermalization after a quantum quench , we might indeed expect that , if the system is well described by a gge ensemble , not only the mean values of @xmath28 and @xmath29 are equal , i.e. , @xmath30 , but also the two distributions should be closely related ; at least this is what a good statistical ensemble should do .    quite generally , we might formulate the problem as follows : how can we obtain information on weighted distributions ( or density of states ) @xmath31 with positive weights @xmath32 , when both @xmath32 and @xmath33 are `` easily calculated '' , but the sum over @xmath34 runs over an exponentially large `` configuration space '' ? as discussed before , examples of this are the diagonal distribution , where @xmath35 , the gge distribution , where @xmath36 , but also the microcanonical distribution , where @xmath32 is a window characteristic function for the microcanonical shells , etc . a monte carlo algorithm to perform such exponentially",
    "large sums in configuration space seems unavoidable .",
    "we stress that this is so even if one is considering quenches in free - fermion models , where the relevant many - particle states @xmath3 and matrix elements are easy to write down and calculate .",
    "the alternative of using exact diagonalization methods would put a strong limit on the size of the problem which can be studied .    in this paper",
    "we introduce a monte carlo method  obtained by a rather natural extension of the wang - landau algorithm ( wla )  @xcite  which will allow us to compute weighted distributions of the form of eq .  .",
    "the wang - landau algorithm , proposed in 2001 by f. wang and d.p .",
    "landau , is a monte carlo method designed to compute the density of states of a classical statistical mechanics problem .",
    "the algorithm performs a non - markovian random walk to build the density of states by overcoming the prohibitively long time scales typically encountered near phase transitions or at low temperatures . besides the classical ising and potts models studied in the original papers  @xcite ,",
    "the method has been applied to the solution of numerical integrals  @xcite , folding of proteins  @xcite and many other problems .    here",
    "is the plan of the paper . in sec .",
    "[ sec : wwla ] we show how the wla can be extended to compute weighted density of states . in sec .",
    "[ sec : wl - quantumquenches ] we show how the weighted - wla can be used to compute distributions related to quantum quenches with quadratic fermionic models",
    ". finally , sec .",
    "[ sec : conclusions ] contains a summary and future perspectives .",
    "let us consider a system with a discrete configuration space , where configurations can be labeled with an index @xmath34 . given a physical observable @xmath37 , we define its weighted ( coarse - grained ) density of states : @xmath38 with @xmath39 a _ positive _ weight . here",
    "@xmath40 is a kronecker delta , or , if the possible values of @xmath33 are too dense to keep them all , a suitable histogram - window - function coarse - graining of the dirac s delta .",
    "when @xmath41 , we recover the usual density of states @xmath42 , and the wla can be used to estimate it  @xcite .",
    "we will now show that , by properly modifying the wla , we can compute @xmath43 for generic @xmath39s .    to understand the gist of the approach , consider a generic positive function @xmath44  which is our best guess for the desired @xmath43  , and set up a markov chain random walk in which , given a state @xmath34 , a new state @xmath45 is generated with a trial probability @xmath46 , which we will take to be symmetric , @xmath47 , and accepted with probability : @xmath48 \\;.\\ ] ] with this standard metropolis monte carlo prescription , we know that , after an initial transient , we will visit the configurations @xmath34 with an equilibrium distribution @xmath49 fulfilling the detailed balance condition and given by : @xmath50 where @xmath51 is a normalization constant . as in the wla @xcite , while the random walk goes on , we collect a histogram @xmath52 , updating @xmath53 at each visited state @xmath34 . at equilibrium , after @xmath54 steps , the `` mean '' histogram will then be given by : @xmath55 exactly as for the wla @xcite , if our guess for @xmath44 is a good approximation to @xmath56 , the histogram @xmath52 will be `` almost flat '' ( see below ) .",
    "obviously , during the random walk , together with the histogram @xmath52 we also update our guessed @xmath44 .",
    "therefore , closely inspired by the wla @xcite , we propose the following algorithm :    1 .",
    "fix a modification factor @xmath57 , and set @xmath58 and @xmath59 for all values of @xmath19 ; 2 .",
    "start the monte carlo procedure using eq .   and",
    "update at each step the histogram and the weighted density of states with the rules @xmath60 and @xmath61 ; 3 .   stop the random walk when @xmath52 is `` almost flat '' ( for instance @xcite , when @xmath62 for all values of @xmath19 , where @xmath63 is the mean histogram value ) . for the previous observations , at the end of this step @xmath64 is a good approximation to @xmath65 with a discrepancy of order @xmath66 ; 4 .",
    "reduce the value of @xmath67 , reset @xmath68 and restart the procedure from step ( 1 ) using the @xmath69 just obtained .",
    "stop this loop when @xmath66 is smaller than the desired discrepancy @xmath70 .",
    "a similar extension of the wla has been already been introduced for the particular case in which @xmath39 is the boltzmann distribution , with the aim of computing the free energy profile as a function of a reaction coordinate  @xcite . in the present paper , we will use this algorithm to compute distributions where the weights are not boltzmann - like , but rather associated to quantum quenches .",
    "let us return for a moment to the original wla .",
    "a first trivial observation is that , as it should be , the weighted - wla with @xmath71 coincides with the wla . in many situations , when the size of the configuration space is too big and the density of states ranges over too many orders of magnitude , it is convenient , in computing @xmath42 , to run many wla over small domains @xmath72 $ ] .",
    "but then the update rule of the standard wla has to be changed to avoid that , during the random walk , @xmath73 leaves the domain @xmath74 .",
    "this trick was already used in the first papers by wang and landau , when dealing with the largest sizes  @xcite . to avoid leaks from @xmath74 , the empirical solution was to reject any proposal to states @xmath45 with @xmath75 , without any update of @xmath76 and @xmath52 . with this prescription , however , there are `` boundary effects '' , actually a systematic underestimation of the density of states at the borders of the intervals  @xcite .",
    "schulz  _ et al . _",
    "@xcite showed phenomenologically that such boundary effects are eliminated by using the rather obvious update rule : given a proposal @xmath45 , if @xmath77 is outside the interval we remain in @xmath34 and we update @xmath52 and @xmath78 using the state @xmath34 , otherwise we accept @xmath45 with the usual rule .",
    "this update rule is just what is obtained , rigorously , by using our weighted - wla .",
    "indeed , the density of states in a restricted range @xmath74 is proportional to a weighted density of states in which @xmath79 when @xmath80 , and zero otherwise . with these weights ,",
    "the update rule of our weighted - wla is exactly the one obtained phenomenologically by schulz  _ et al .",
    "_  @xcite .",
    "in this section we come back to the initial problem of computing the distributions @xmath28 and @xmath29 related to quantum quenches . we will show that with the weighted - wla we can compute these distributions for sizes inaccessible with an exhaustive enumeration .",
    "we concentrate on quantum quenches in two models possessing a free fermionic description .",
    "the first model we considered is the fermionic anderson model with disorder in the local potential : @xmath81 where @xmath82 ( @xmath83 ) creates ( destroys ) a fermion at site @xmath84 , @xmath85 is the nearest - neighbor hopping integral and @xmath86 is an uncorrelated on - site random potential uniformly distributed in the range @xmath87 $ ] .",
    "we assume periodic boundary conditions .",
    "it has been mathematically proven  @xcite that , for hamiltonians like @xmath88 and in presence of any @xmath89 , all the single - particle eigenstates of @xmath90 are exponentially localized .",
    "the second model we considered still describes spinless fermions hopping on a chain , but now the hopping is long - ranged  @xcite : @xmath91 where @xmath92 is a ( real ) hopping integral between sites @xmath93 and @xmath94 .",
    "we will take the @xmath95 s to be random and long - ranged , with a gaussian distribution of zero mean , @xmath96 , and variance given by : @xmath97 here @xmath98 is a real positive parameter setting how fast the hoppings variance decays with distance .",
    "notice that , for @xmath99 , we have @xmath100 for any @xmath98 , hence the model has also on - site gaussian disorder ; by increasing the distance between the two sites @xmath101 , the variance of the hopping integral decreases with a power law .",
    "the peculiarity of this long - range - hopping model is that , although being one - dimensional and regardless of the value of @xmath102 ( which hereafter is fixed to @xmath103 ) , it has an anderson transition from ( metallic ) extended eigenstates , for @xmath104 , to ( insulating ) power - law localized eigenstates for @xmath105 @xcite .",
    "physically , this is due to the fact that , for small @xmath98 , long - range hoppings are capable of overcoming the localization due to disorder . having access , in the same model , to physical situations in which the final eigenstates are extended ( @xmath104 ) or localized ( @xmath105 ) will clearly show the role that spatial localization plays in disrupting the ability of the gge to describe the after - quench dynamics .",
    "physically , spatial localization prevents the different `` modes '' of the system from having an infinite reservoir .",
    "for the considered quenches , we use as initial hamiltonian @xmath106 the clean chain with @xmath107 and the same boundary conditions of the final hamiltonian , i.e. , periodic boundary conditions when quenching to @xmath108 and open boundary conditions when quenching to @xmath109 .",
    "the corresponding initial state @xmath2 will be the filled fermi sea , i.e. , the ground state of @xmath106 with @xmath110 , where @xmath111 is the number of fermions .",
    "the reason behind this simple choice for @xmath106 is that the `` stationary state '' reached does not depend , qualitatively , on the initial hamiltonian being ordered or not , see ref .",
    "the final hamiltonian will be the anderson model @xmath108 with @xmath112 , or the long - range hopping chain @xmath109 with @xmath113 or @xmath114 .",
    "in all cases the particle number is a constant of motion , therefore @xmath110 for any time @xmath115 . to get a smoother size dependence of the computed quantities ,",
    "the smaller size realizations are obtained by cutting an equal amount of sites at the two edges of the largest realization .",
    "the two hamiltonians , being quadratic in the fermion operators , can be diagonalized for any chain of size @xmath116 in terms of new fermionic operators @xmath117 where @xmath118 are the wave functions of the eigenmodes of energy @xmath119 : @xmath120 .",
    "the energies @xmath119 and the associated wave functions @xmath118 are obtained , for any given disorder realization of a chain of size @xmath116 by numerically diagonalizing the @xmath121 one - body hopping matrix .    given an observable @xmath37 , consider the two distributions introduced before : @xmath122 where @xmath123 is the dirac s delta , @xmath124 are the many - body eigenstates of @xmath4 , @xmath125 , @xmath126 , and @xmath127 is the occupation of the single - particle eigenstate @xmath128 in the many - body eigenstate @xmath12 .",
    "these functions give the weighted distributions of @xmath14 in the diagonal and gge ensembles .",
    "let us discuss a few technical details on the implementation we made , before discussing the physics emerging from our calculations .",
    "notice that the sum over @xmath34 is effectively restricted to the canonical hilbert space @xmath129 with a fixed number of particles @xmath130 in the diagonal ensemble , since @xmath131 if @xmath132 .",
    "no such restriction is in principle present in the gge case , where the sum over @xmath34 runs over the grand - canonical hilbert space . by definition ,",
    "the distributions are such that @xmath133 and @xmath134 , where the integration is over the domain of @xmath14 . as customary in any numerical finite - size study ,",
    "one really needs to consider a coarse - grained version of these distributions , obtained by splitting the domain of @xmath19 into small intervals @xmath135 of amplitude @xmath136 .",
    "such a coarse - grained distribution has exactly the form of a weighted density of states , see eq .",
    ", with @xmath137 in the diagonal case , and @xmath138 in the gge case . the configuration space @xmath139 ( i.e. , the canonical hilbert space @xmath129 for the diagonal distribution and the full hilbert space for the gge ) over which the two weighted distributions are defined is discrete and grows exponentially with the system size .",
    "the weighted - wla is therefore the appropriate tool for the numerical computation of @xmath28 and @xmath29 .",
    "the eigenstates @xmath12 which appear in the definition of @xmath28 have a fixed number of fermions @xmath111 ( the same of the initial state ) , while in @xmath29 the number of particles can change . in the weighted - wla , for the diagonal ensemble , we use therefore a `` particle conserving '' proposal scheme : given a state @xmath12 , the state @xmath140 is given by moving at random a fermion in one of the unoccupied single - particle eigenstates .",
    "in this case , the ratio @xmath141 which appears in eq .  ,",
    "is equal to : @xmath142 where the coefficient @xmath143 is the square of the determinant of a @xmath144 matrix ( see ( * ? ? ?",
    "d ) for the explicit expression of @xmath143 ) . for the gge case , instead",
    ", we do not have restrictions on the number of fermions and , given a state @xmath12 , we generate a state @xmath140 by changing the occupation of a randomly selected single - particle eigenstate @xmath128 . in this case :",
    "@xmath145 where the @xmath146 ( @xmath147 ) sign appears when the mode @xmath128 is initially occupied ( empty ) .",
    "let us recall that the lagrange s multipliers @xmath21 are obtained by requiring @xmath148 .",
    "this condition , written explicitly , reads : @xmath149_{\\nu \\mu } \\right|^2 } - 1 \\;,\\ ] ] where @xmath150 and @xmath151 are @xmath121 matrices whose elements @xmath152 and @xmath118 are the single - particle wavefunctions of the initial hamiltonian @xmath153 and the final one @xmath4 , and @xmath154 is the occupation of the @xmath155th eigenstate of @xmath153 in the initial state .",
    "the difference in the computational effort on computing the ratio @xmath141 in the two ensembles is evident : in the diagonal case at each step we have to compute the determinant of a @xmath144 matrix , while in the gge we have just to recover the value of @xmath156 ( they can be computed and stored before the monte carlo calculation because their number is @xmath116 ) . here",
    "we will show results for sizes up to @xmath157 , where both @xmath28 and @xmath29 can be computed and compared .",
    "( for the gge ensemble , we could reach @xmath158 without problem . ) in the numerical computations we used a minimum value of the wl parameter @xmath159 , and we split the domain of @xmath19 in @xmath116 bins .",
    "notice that the domain of @xmath19 in @xmath29 is always larger than the domain of @xmath28 because , in the gge , the many - body eigenstates do not have a restriction on the number @xmath160 of fermions .    in the next two subsections",
    "we show the results obtained with the weighted - wla for the calculation of @xmath28 and @xmath29 for two observables , the total energy and the local density .",
    "the physical picture emerging from the calculation of the full distribution function of the after - quench energy and local - density confirms and extends the results discussed in ref .",
    "in particular , we find clear differences between the diagonal and gge distributions , even at the level of the variances , whenever a disorder - induced spatial localization is at play in the after - quench hamiltonian .",
    "the first observable we consider is the total energy : here @xmath161 , where @xmath162 are the single - particle occupations of the eigenstate @xmath12 . in fig .",
    "[ fig : rho - gge - d ] we show the distributions @xmath163/l$ ] and @xmath164/l$ ] , computed for @xmath165 and @xmath157 , for the three cases we have studied , i.e. , quenches from an initially ordered half - filled chain @xmath106 towards : 1 ) a long - range hopping hamiltonian @xmath109 with extended eigenstates ( @xmath166 , top ) , 2 ) @xmath109 with localized eigenstates ( @xmath167 , center ) , and 3 ) an anderson hamiltonian @xmath108 with a disorder width @xmath112 ( bottom ) .",
    "/l$ ] and @xmath168/l$ ] computed with the weighted - wla .",
    "the gray curves are obtained with @xmath165 , while the black ones with @xmath157 .",
    "the solid vertical lines are the average energy after the quench , i.e. @xmath169 , for @xmath157 .",
    "the three panels are obtained starting from the ground states of clean chains and quenching to different disordered hamiltonians : panel ( a ) long - range hopping with @xmath166 ( extended eigenstates ) , panel ( b ) long - range hopping with @xmath167 ( localized eigenstates ) and panel ( c ) anderson model with @xmath112 . for the computations we used a single disorder realization and , to get a smoother size dependence ,",
    "the smaller size realization is obtained by cutting an equal amount of sites at the two edges of the larger realization .",
    "these distributions are obtained for a single realization of the couplings , but we verified that , for large sizes , the results are self - averaging",
    ". , scaledwidth=85.0% ]    observe , first , that the distributions @xmath170 and @xmath171 shown in fig .",
    "[ fig : rho - gge - d ] have identical average ( denoted by a solid vertical line ) @xmath172 this result comes directly from the fact that the energy does not fluctuate in time ( i.e. , the diagonal energy coincides with the average energy @xmath173 ) and gge fixes the occupation of the fermionic eigenstates in such a way as to exactly reproduce @xmath173 .",
    "the form of the two distributions , however , differs considerably , most notably at the extremes of the spectrum , and for the anderson model case .",
    "let us now consider the fluctuations of the energies in both distributions . in the diagonal ensemble",
    "the variance is : @xmath174 where the expression on the right - hand side holds only for the hamiltonian ( it would not apply to arbitrary operators , because @xmath175 ) .",
    "an entirely similar expression applies to the gge case .",
    "since the energy is an extensive operator , it is reasonable to ask what happens to the fluctuations in the energy - per - site @xmath176 , which are simply given by @xmath177 , and @xmath178 .",
    "on pretty general grounds , for quenches of local non - integrable hamiltonians , it is known  @xcite that @xmath179 in the thermodynamic limit , @xmath180 . indeed , as shown in fig .",
    "[ fig : sigmae - gge - d ] both @xmath181 and @xmath182 decrease to @xmath183 for @xmath180 for the three considered cases . for our quadratic problems ,",
    "however , we can say a bit more .",
    "first of all , from the explicit expression in eq .",
    "after very simple algebra ( mainly using wick s theorem ) , we arrive at : @xmath184 where @xmath185 is the @xmath0 one - body green s function .",
    "the off - diagonal elements of @xmath186 play here an important role , and the second term in @xmath181 originates from the fact that , by definition , gge does not include correlations between different eigen - modes , i.e. , @xmath187 , when @xmath188 .",
    "( empty circles ) and @xmath189 ( solid triangles ) as a function of the size @xmath116 .",
    "the data are obtained using the same set of quenches used in fig .",
    "[ fig : rho - gge - d ] and the values are computed using eqs .  .",
    "error bars are calculated by averaging over 20 different realizations of the disorder .",
    "the dashed lines are power law fits @xmath190 , where @xmath191 for the anderson case , while , for the quench to @xmath109 , @xmath192 when @xmath193 , and @xmath194 when @xmath195 .",
    "notice the observable difference between @xmath196 and @xmath197 when the final eigenstates are localized.,scaledwidth=85.0% ]    let us first consider the anderson model case .",
    "assuming , as done so far , a bounded distribution of disorder , we are guaranteed that a finite bound @xmath198 exists such that @xmath199 for any @xmath116 . with this assumption ,",
    "it is easy show that @xmath182 has to go to zero at least as @xmath200 for @xmath180 .",
    "indeed , the occupation factors appearing in @xmath182 are such that @xmath201 . hence : @xmath202 the same statement can be made for @xmath181 , because the difference between the two variances has a similar upper bound : @xmath203 where we used that @xmath204 .",
    "nevertheless , although both @xmath181 and @xmath182 go to @xmath183 as @xmath200 for the anderson model , they do so with a different pre - factor , see fig .",
    "[ fig : sigmae - gge - d ] and comments below .    for the quenches to @xmath109 ,",
    "a bound @xmath198 for the single - particle spectrum is in principle not defined : one can think of rare realizations in which the hopping is large at arbitrarily large distances , which would give an unbounded distribution of eigenvalues @xmath205 .",
    "indeed , the behavior of both @xmath181 and @xmath182 suggest , see fig .",
    "[ fig : sigmae - gge - d ] , that the power - law approach to @xmath183 might be slower than @xmath200 , i.e. , as @xmath206 with @xmath207 ( we find @xmath208 for the case @xmath166 and @xmath194 for @xmath167 ) . while this might be a finite - size artifact , we find it intriguing that such deviations are quite clearly seen for quenches to @xmath109 : they might be due to the power - law nature of the hopping integral variance .",
    "concerning the similarity between @xmath181 and @xmath182 , we observe that the two essentially coincide for the case of a quench to @xmath109 with extended eigenstates , while there is a small discrepancy for the quench to @xmath109 with localized eigenstates , and a quite clear different pre - factor in the anderson model case , @xmath209 and @xmath210 with @xmath211 .",
    "this different pre - factor can be understood by analyzing the term @xmath212 which appears in eq .  .",
    "in fig .  [",
    "fig : occandmatrices ] , panel ( b ) , we show the structure of the matrix @xmath213 for the three quench cases .",
    "we divide this matrix into four sectors , one for each sign of the single - particle energies @xmath214 and @xmath215 : in two of these quadrants the product @xmath216 is positive ( top - right and bottom - left ) , and in the others is negative .",
    "for quenches to @xmath109 this matrix is almost equally distributed in all the four sectors : the sum @xmath212 has cancellations , leading to @xmath217 for large sizes . for quenches to @xmath108 , on the contrary",
    ", the matrix @xmath213 is mainly concentrated in the sectors in which @xmath218 , leading to @xmath219 .     as a function of the single - particle energy @xmath119 .",
    "panel ( b ) : representation of the matrix @xmath220 . for the diagonal and off - diagonal elements we add a black pixel when the value exceeds their mean value . for the diagonal elements the mean value is @xmath221 , while for the off - diagonal elements the mean value is @xmath222 , where @xmath160 is the number of fermions in the initial state , and we used the relation @xmath223 ( see ( * ? ? ? * app .",
    "the vertical and horizontal lines indicate the indexes at which the single - particle energies @xmath214 and @xmath215 change sign , and the signs shown in the four quadrants are those of the product @xmath224 .",
    "for the two panels we used @xmath157 and the same quenches used in fig .",
    "[ fig : rho - gge - d ] and fig .",
    "[ fig : sigmae - gge - d].,title=\"fig:\",scaledwidth=85.0% ] + panel ( a ) +    as a function of the single - particle energy @xmath119 .",
    "panel ( b ) : representation of the matrix @xmath220 . for the diagonal and off - diagonal elements we add a black pixel when the value exceeds their mean value . for the diagonal elements the mean value is @xmath221 ,",
    "while for the off - diagonal elements the mean value is @xmath222 , where @xmath160 is the number of fermions in the initial state , and we used the relation @xmath223 ( see ( * ? ? ?",
    "the vertical and horizontal lines indicate the indexes at which the single - particle energies @xmath214 and @xmath215 change sign , and the signs shown in the four quadrants are those of the product @xmath224 . for the two panels we used @xmath157 and the same quenches used in fig .",
    "[ fig : rho - gge - d ] and fig .",
    "[ fig : sigmae - gge - d].,title=\"fig:\",scaledwidth=85.0% ] + panel ( b ) +    finally , let us comment on one aspect of the distributions shown in fig .",
    "[ fig : rho - gge - d ] which can be easily understood from the single - particle occupations shown in fig .",
    "[ fig : occandmatrices ] .",
    "we see that , when the after - quench hamiltonian is the anderson model , @xmath225 has both mode ( i.e. , maximum value ) and average very close to the ground state energy : the quench excites mostly the low - energy part of the many - body spectrum .",
    "on the contrary , for both the quenches towards @xmath109 , mode and average are almost in the middle of the many - body spectrum ; there , indeed , the quench is more dramatic : we are going from the ground state of a chain with nearest - neighbor hopping to a disordered chain with long - range hopping .",
    "this is evident by looking at the occupations @xmath226 as a function of the single - particle energy @xmath119 , shown in fig .",
    "[ fig : occandmatrices ] , panel ( a ) . by definition ,",
    "only the eigenstates of @xmath153 with @xmath227 are occupied in @xmath228 .",
    "the quench to @xmath108 only slightly modifies the initial occupations : @xmath229 , apart for fluctuations due to disorder , goes smoothly from @xmath103 , in the lower part of the single - particle spectrum , to @xmath183 , in the highest part of the spectrum . on the contrary , for the quenches towards @xmath109 , the single - particle spectrum is entirely excited , both the positive and the negative energy part .",
    "this explains why , for these quenches , the after - quench energy @xmath230 is near the center of the many - body spectrum .",
    "let us now consider the local density @xmath231 , perhaps the simplest one - body observable . for definiteness , we concentrate on @xmath232 , the center of the chain .",
    "it is important to stress that we are going to consider the fluctuations of @xmath233 _ before _ any possible average over the sites @xmath84 : averaging over the sites @xmath84 an intensive local operator would effectively send to zero the fluctuations in the thermodynamic limit @xcite , while we will show that , for a fixed @xmath84 , finite fluctuations survive in the thermodynamic limit when the eigenstates are localized , due to disorder .",
    "the diagonal and gge distributions @xmath234 and @xmath235 are now constructed using the matrix elements @xmath236 , where @xmath237 are , as before , the single - particle occupations of the eigenstate @xmath12 . in fig .  [ fig : rho - n - gge - d ] we plot @xmath238 $ ] and @xmath239 $ ] , computed for the three quenches discussed before .",
    "the case of a quench to @xmath109 with @xmath240 ( localized eigenstates ) is quite peculiar .",
    "the values that @xmath241 can assume is actually split in two separated domains , one just above @xmath242 and one just below @xmath243 , and the mean value is exactly in the middle , where no values of @xmath244 happen to fall .",
    "this is due to the strong spatial localization of the eigenstates . as we show in fig .",
    "[ fig : wl - local - occ ] , at fixed @xmath84 , the value of @xmath245 is strongly localized in a single eigenstate @xmath246 . this implies that the value @xmath247 has a strong jump when we move from a state @xmath12 in which @xmath248 , to the state @xmath12 in which @xmath249 . for the quench to @xmath108 , with @xmath112 ,",
    "the localization is not strong enough to produce such a gap : we however expect this to happen for larger values of the disorder amplitude @xmath250 .     at the center of the chain , @xmath232 , for the diagonal ensemble and the gge , and for @xmath157 ( black curves ) or @xmath165 ( gray curves ) . in panel",
    "( a ) , we plot @xmath238/l$ ] and @xmath239/l$ ] , while in panels ( b ) and ( c ) @xmath238 $ ] and @xmath239 $ ] .",
    "the vertical lines are the diagonal and gge average of @xmath251 , which coincide for the local density .",
    "the three panels are obtained using the same quenches of fig .",
    "[ fig : rho - gge - d].,scaledwidth=85.0% ]     as a function of the eigenstates index @xmath128 , at fixed site @xmath232 .",
    "we have taken @xmath157 and the three panels are obtained using the same quenches of fig .",
    "[ fig : rho - gge - d].,scaledwidth=85.0% ]    since @xmath233 is a one - body operator , the diagonal and gge averages coincide @xcite , and therefore , the mean value of the two distributions is the same : @xmath252 we also note that , for this observable , @xmath253 for any positive integer @xmath254 , and therefore @xmath255 .",
    "however , this does not allow us to conclude that the two distributions @xmath234 and @xmath235 coincide , since , unlike the case of the total energy , we have that , for instance : @xmath256 the variance of the two distributions can be computed by exploiting again wick s theorem .",
    "we find that : @xmath257 in fig .",
    "[ fig : sigmalocaldensity - gge - d - new ] we plot @xmath258 and @xmath259 as a function of size .",
    "we see that , in both ensembles , the variances vanish as @xmath200 when quenching to @xmath109 with @xmath193 ( extended eigenstates ) while they are _ finite _ when quenching to @xmath108 and to @xmath109 with @xmath195 , i.e. , when the final hamiltonian has localized eigenstates .",
    "these results agree with the findings of ref .",
    "@xcite , who show that , for large @xmath116 , the variance of few - body intensive ( but not site - averaged ) observables remains finite both in the microcanonical ensemble and in the diagonal ensemble for the aubry - andr model .    from the equation for @xmath258 , we see that it is related to an inverse participation ratio ( ipr ) : the sum is over the eigenstates @xmath128 , each @xmath128 weighted with the corresponding occupation factor @xmath260 depending on the initial state .",
    "it is therefore easy to realize that : @xmath261 where the last equality defines the ipr at fixed site @xmath84 .",
    "this shows that , whenever the ipr goes to zero , i.e. , when the final hamiltonian has delocalized eigenstates , @xmath258 goes to zero as well . for a final hamiltonian with localized eigenstates",
    "we have instead the opposite : there is at least one eigenstate @xmath246 localized around @xmath84 , and therefore there is a single - particle wavefunction @xmath262 which does not vanish in the thermodynamic limit ; if the initial occupation @xmath263 of this eigenstate is such that @xmath264 , then @xmath258 remain finite in the thermodynamic limit .    concerning @xmath259 , eq .",
    "can be rewritten as : @xmath265 where @xmath266 denotes the mean squared time - fluctuations of the single - particle green s function @xmath267  @xcite : @xmath268 @xmath269 being the time fluctuation with respect to the long - time average @xmath270 .",
    "physically , @xmath271 is the averaged long - time fluctuation of the local density @xmath272 . in refs .",
    "@xcite we have shown that if the final hamiltonian has extended eigenstates , then @xmath273 for large sizes , while @xmath266 remains finite when the final hamiltonian has localized eigenstates .",
    "this explains all the features shown in fig .",
    "[ fig : sigmalocaldensity - gge - d - new ] , in particular the clear difference between @xmath259 and @xmath258 in all cases .",
    "( circles ) and @xmath258 ( triangles ) as a function of size .",
    "the data are obtained using the same set of quenches used in fig .",
    "[ fig : sigmae - gge - d ] and the values are computed using eq .  .",
    "error bars are calculated by averaging over 20 different realizations of the disorder .",
    "the dashed lines are power - law fits @xmath274 , where @xmath191 in both cases.,scaledwidth=85.0% ]",
    "in this paper we have introduced a monte carlo method  obtained by a rather natural extension of the wang - landau algorithm  @xcite  which allows to compute quite general weighted distribution functions of the form relevant to quantum quenches , see eq .  .",
    "we have used this approach to analyze quantum quenches for free - fermion hamiltonians in presence of disorder . for these systems , thanks to wick s theorem , after - quench expectation values and time averages require a modest computational effort , proportional to a power - law of the size @xmath116 @xcite",
    ". however , the calculation of full probability distributions  like the diagonal ensemble distribution @xmath275 , eq .  , or the gge one @xmath276 , eq .",
    " would still require a sum over an exponential number of terms , hence unfeasible beyond very small sizes .    although quadratic , hence with an extensive number of conserved quantities , these free - fermion problems are not described by the gge ensemble whenever the disorder is such that the after - quench eigenstates are localized .",
    "more precisely , while the gge ensemble is known to correctly capture the long - time average of any one - body operator , almost `` by construction '' @xcite , it does not capture correlations induced by the spatial localization of the eigenstates .",
    "our study further explored this issue by explicitly calculating and comparing the full probability distributions of both the energy and the local density in the two relevant ensembles .    concerning the energy ,",
    "we have explicitly verified that the form of the two distributions for the diagonal and gge ensembles differs considerably , most notably at the extremes of the spectrum , and for the anderson model case .",
    "more in detail , we have verified that , regardless of the final hamiltonian , the averaged fluctuations of the energy - per - site , @xmath277_{\\mathrm{av}}$ ] and @xmath278_{\\mathrm{av}}$ ] , go to zero in the thermodynamic limit , see fig .",
    "[ fig : sigmae - gge - d ] , in agreement with the general analysis of refs .",
    "nevertheless , we find that there is a clearly detectable difference in the two variances when the final hamiltonian has localized eigenstates .",
    "in addition to the energy , we studied the local density distributions . for this",
    "observable , it was already known that , even in presence of disorder and localization , the gge expectation value coincides with the diagonal average  @xcite , a property true , more generally , for any one - body operator  @xcite .",
    "our numerical results confirm that even if the averages of @xmath279 and @xmath280 coincide , the two distributions are different when localization is present , with clearly detectable differences already at the level of the variance , see fig .  [",
    "fig : sigmalocaldensity - gge - d - new ] : @xmath258 and @xmath259 differ by a quantity which represents the averaged long - time fluctuations of the local density @xcite , which remain finite whenever the final hamiltonian has localized eigenstates .    other many - body operators , like density - density correlations , might be analyzed in a similar way . here ,",
    "even the average values are not in general well described by the gge distribution whenever localization is at play @xcite : we expect , once again , clearly visible discrepancies between the diagonal and gge distributions in such cases .    in conclusion ,",
    "as explained above , the weighted - wla we have presented circumvents the difficulty associated to the exponentially large hilbert space to be visited , even when the relevant ingredients entering the distribution  matrix elements and overlap between states  can be calculated quite effectively . in principle",
    ", the applicability of the method is not limited to `` quadratic fermion problems '' of the type we have considered in the paper : if , by bethe ansatz , or any other exact technique or even by a suitable quantum monte carlo approach , one would be able to calculate matrix elements and overlaps , the method we have illustrated would provide an effective monte carlo sampling of the relevant distribution functions .",
    "we acknowledge discussions with a. laio , a. russomanno and a. silva .",
    "research was supported by miur , through prin-2010llkjbx-001 , by snsf , through sinergia project crsii2 136287  1 , by the eu - japan project lemsuper , and by the eu fp7 under grant agreement n. 280555 .",
    "10                                marcos rigol , vanja dunjko , vladimir yurovsky , and maxim olshanii . relaxation in a completely integrable many - body quantum system : an _ ab  initio _ study of the dynamics of the highly excited states of 1d lattice hard - core bosons . , 98:050405 , 2007 .",
    "pedro ojeda , martin  e. garcia , aurora londoo , and n.  y. chen .",
    "monte carlo simulations of proteins in cages : influence of confinement on the stability of intermediate states . , 96(3):1076  1082 , 2009 .",
    "evelina  b. kim , roland faller , qiliang yan , nicholas  l. abbott , and juan  j. de  pablo .",
    "potential of mean force between a spherical particle suspended in a nematic liquid crystal and a substrate .",
    ", 117(16):77817787 , 2002 .",
    "m.  mller and j.j .",
    "de  pablo .",
    "simulation techniques for calculating free energies . in _ computer simulations in condensed matter systems : from materials to chemical biology volume 1 _ , volume 703 of _ lecture notes in physics _ , pages 67126 .",
    "springer berlin heidelberg , 2006 .",
    "alexander  d. mirlin , yan  v. fyodorov , frank - michael dittes , javier quezada , and thomas  h. seligman . transition from localized to extended eigenstates in the ensemble of power - law random banded matrices .",
    ", 54:32213230 , oct 1996 ."
  ],
  "abstract_text": [
    "<S> we present here an extension of the wang - landau monte carlo method which allows us to get very accurate estimates of the full probability distributions of several observables after a quantum quench for large systems , whenever the relevant matrix elements are calculable , but the full exponential complexity of the hilbert space would make an exhaustive enumeration impossible beyond very limited sizes . we apply this method to quenches of free - fermion models with disorder , further corroborating the fact that a generalized gibbs ensemble fails to capture the long - time average of many - body operators when disorder is present . </S>"
  ]
}