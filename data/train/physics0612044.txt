{
  "article_text": [
    "in monte carlo ( mc ) simulation of electron transport , the simulation of all the interactions suffered by the electrons when they go through a material , the so - called detailed simulation ( ds ) , is , in general , unpractical because of the long computing times required to reduce the electron energies below the absorption threshold .",
    "therefore , ds is done in practice only if the energy of the electrons is low and/or the targets are thin .    to solve the situation , `` condensed history '' schemes are employed in much of the usual mc radiation transport codes of general purpose . in this approach ,",
    "a certain number of interactions are grouped and described by means of a multiple scattering theory @xcite . in condensed simulation ( cs ) , electrons move in finite steps whose length is calculated at the beginning of each step , using , for example , the continuum slowing down approximation and a fixed average fractional energy loss in the step .",
    "an alternative approach is provided by the so - called mixed simulation schemes , in which ds is used to simulate the `` hard '' interactions in which the angular deflections and/or the energy losses are larger than certain cut - off values , while the interactions which do not fulfill these conditions , named `` soft '' , are described within cs approach .",
    "the statistical models used to determine the energy loss in cs provide good enough results if the tracking steps are not too big . on the contrary , the statistical treatment of the angular distribution linked to the multiple scattering is a much more involved task . since the 40 s a considerable effort has been done to solve the problem and various models ( e.g. goudsmit and saunderson , molire , lewis ) have been developed @xcite .",
    "though multiple scattering theories can describe the angular deflections produced by both elastic and inelastic collisions , it has been a common practice to take care of the effects due to inelastic collisions by correcting the distributions calculated considering only elastic collisions @xcite .",
    "only recently , negreanu _ et al .",
    "_ @xcite have treated both elastic and inelastic collisions on the same footing , using accurate partial - wave differential cross sections .",
    "the importance of the elastic scattering in the interaction of the electrons with the materials and , in particular , in the dosimetry of these particles , has been pointed out by different authors .",
    "@xcite studied in detail the limitations of the implementations of the molire theory to be used in cs .",
    "li and rogers @xcite compared the egs4 results with those obtained by integrating analytically the molire distribution , with those quoted in icru report 35 @xcite and with the experimental data of hanson _ et al .",
    "urbn @xcite carried out a comparison of the angular distributions obtained with geant4 with the same data .    in the experimental side ,",
    "the data available are very scarce . to the best of our information , only kulchitsky and latyshev @xcite and hanson _ et al .",
    "_ @xcite have performed measurements of the multiple scattering of electrons in materials .",
    "kulchitsky and latyshev @xcite studied the scattering of 2.25 mev electrons by foils of different materials from aluminum to lead .",
    "their data were in good agreement with the goudsmit and saunderson theory for the elements al , fe , cu , mo , ag and sn , while for ta , au and pb they found non - negligible differences between theory and experiment . on the other hand , hanson _ et al . _",
    "@xcite measured the angular distributions of 15.7 mev incident electrons scattered by thin be and au foils .",
    "for au they found discrepancies with the predictions of the goudsmit and saunderson theory and agreement with the calculations done according to molire theory . for",
    "be the experimental data disagreed with the results obtained within the molire approach .    in this work",
    "we analyze how different codes describe the scattering of electrons by thin foils of different elements .",
    "results for geant3 , geant4 , penelope , egsnrc and mcnpx are compared between them and with the few experimental data available . in section 2",
    "we give details concerning the simulations we have performed and the mc codes which we have used and which are relevant for the calculations performed . also the way how the data have been analyzed",
    "is discussed . in section 3",
    "we describe briefly the experiments of kulchitsky and latyshev @xcite and hanson _ et al .",
    "section 4 is devoted to discuss the results we have obtained : the calculations with different versions of some of the codes are discussed and the mc results are compared with the experimental data of hanson _ et al .",
    "_ @xcite and kulchitsky and latyshev @xcite and between themselves . in the last section",
    "we draw our conclusions .",
    "the simulations have been carried out using an elementary geometry with a monoenergetic pencil beam impinging normally on a foil made of a given material and with a given thickness .",
    "both source and foil are in vacuum .",
    "the incident beam defines the @xmath0 direction .",
    "the directions of the ( primary or secondary ) electrons emerging from the foils define the scattering angles which have been scored in a histogram for angles between 0 and 45 degrees with 180 bins of 0.25 degrees .",
    "the values are normalized to the solid angle unit given in stereoradian .",
    "the statistical uncertainty in each bin is calculated as @xmath1 with @xmath2 the value per history in the bin and @xmath3 the number of histories followed . through the paper , these uncertainties are given as a number between parentheses ; e.g. , 9.34(1 ) means 9.34@xmath40.01 .      as said before",
    ", we have performed calculations with various mc codes .",
    "all these codes do ds for photons .",
    "apart from the possible differences in the photon cross sections , the main differences between the codes are in the electron / positron transport . in what follows we quote some details of the codes which are relevant for the mc simulations done here .",
    "_ 1 . geant3 _",
    "geant3 @xcite is a system of detector description and simulation tools designed for high - energy physics at cern .",
    "it permits the mc simulation of the transport of elementary particles and different ions in elemental or compound materials for energies ranging between 10 kev and 10 tev .    the default model for the multiple scattering",
    "is based on the molire theory , but it is possible to select also the pure gaussian scattering according to the rossi formulation @xcite . if the number of coulomb scatters is below 20 , the molire theory can not be applied and the simulation is performed within the plural scattering regime in which the number of scatters is distributed according to a poisson distribution .",
    "the tracking is controlled by means of a series of parameters .",
    "deemax is the maximum fraction of kinetic energy which a particle can lose in a step .",
    "this parameter as well as the multiple scattering introduce upper limits to the step length .",
    "stemax provides an absolute upper limit to the step length , in cm , for each tracking medium .",
    "stmin imposes a lower limit to this step length , also in cm , which permits to accelerate the stopping of those particles with very small energies .",
    "epsil determines the boundary crossing precision in cm . in geant3",
    "one can use an automatic mode for the calculation of these parameter .",
    "this is done by selecting auto=1 . also , it is possible to fix energy cuts for the different particles . in the calculations we have done ,",
    "these cuts have been fixed to 10 kev for both photons and electrons .    in this work",
    "we have used the version 3.2114 of geant3 .",
    "the simulations have been done using the automatic mode . to check the feasibility of the corresponding results",
    ", we have performed simulations for the au foil of 18.66 mg  @xmath5 with eight different sets of the parameters stemax , deemax and stmin , varying from 0.001 to 0.1 , the first two , and from 0.0001 to 0.01 , the last one .",
    "despite the fact that this is the most exigent case , because correspond to the smaller number of interactions , the results obtained are compatible ( within the statistical uncertainty ) with those provide by the auto=1 option .",
    "geant4 _",
    "geant4 code @xcite is an object - oriented c++ toolkit which permits the mc simulation of the radiation transport in material media for a great variety of particles , materials and energies . for the electromagnetic interactions of photons and electrons , geant4 permits to use three different physics models : _ standard _ , _ low - energy _ and _ penelope_. in this work the package _ low - energy _ has been used .",
    "the multiple scattering approach used in geant4 has been developed by urbn @xcite based on the lewis theory @xcite .",
    "the energy loss is calculated from the actual path length which is computed in every step after performing a path length correction .",
    "in addition , a lateral displacement and a scattering angle are sampled from given distributions .    in geant4 , particles are produced if their energies are above given thresholds which are specified in terms of distances , for each volume in the geometry , and internally converted to energy . for the _ low - energy model _ , the minimum value for these thresholds is 250 ev . in our calculations",
    "we have fixed 10 kev for electrons and 1 kev for photons .",
    "particles are followed until their kinetic energy is zero , but tracking cuts can be fixed .",
    "other parameters ( some of them not described in the geant4 manuals @xcite ) provide additional control of electron step . by means of the _ g4userlimits _ class it is possible to fix a maximum step size and a maximum track length , as well as the tracking cuts above mentioned .",
    "the variable droverrange determines the maximum fraction of the stopping range that can be travelled by an electron in a step .",
    "the parameter finalrange fix the minimum step size below which the electron is absorbed locally . finally , the fr variable permits to control the step size when the electron is transported away from a boundary into a new volume .",
    "defaults are droverrange=0.2 , finalrange=0.2  mm , fr=0.02 and no maximum step size .",
    "these are the values we have used in our simulations .",
    "we have performed test simulations using droverrange=0.05 , finalrange=1  nm , fr=0.02 and no maximum step size .",
    "no significant differences have been found with respect to the simulations corresponding to the default values .",
    "we have used the versions 8.0 ( patch01 ) of geant4 and g4emlow3.0 of the _ low - energy _ package .",
    "some additional simulations with the versions 4.1 and 6.0 have also been performed for comparison .",
    "penelope _",
    "penelope @xcite is a general purpose mc code which performs simulations of coupled electron - photon transport .",
    "it can be applied for energies ranging from a few hundred ev up to 1  gev and for arbitrary materials .",
    "besides , penelope permits a good description of the particle transport at the interfaces and presents a more accurate description of the electron transport at low energies in comparison to other general purpose mc codes .",
    "details about the physical processes considered can be found in @xcite .    in penelope electrons and positrons",
    "are simulated by means of a mixed scheme where , as said above , collisions are classified as `` hard '' and `` soft '' .",
    "the electron tracking is controlled by means of four parameters . @xmath6 and @xmath7 refer to elastic collisions .",
    "@xmath6 gives the average angular deflection due to a elastic hard collision and to the soft collisions previous to it .",
    "@xmath7 represents the maximum value permitted for the average fractional energy loss in a step . on the other hand , @xmath8 and @xmath9",
    "are energy cutoffs to distinguish hard and soft events .",
    "thus , the inelastic electron collisions with energy loss @xmath10 and the emission of bremsstrahlung photons with energy @xmath11 are considered in the simulation as soft interactions .",
    "the maximum step size can be controlled using the parameter @xmath12 .",
    "we have used two version of this code : 2003 and 2005 . in what refers to the multiple scattering",
    "the main difference between both versions is that elastic electron collisions are simulated by means of a model based on the wentzel angular distribution @xcite in the version 2003 , while in the 2005 these collisions are simulated by using relativistic ( dirac ) partial - wave differential cross sections generated by using the computer code elsepa @xcite .",
    "some of the simulations performed with penelope have been done with a set of parameters which have been used in different simulations in which thin slabs are present ( see e.g. @xcite ) .",
    "we label these simulations as `` safe '' and the values of the parameters used are : @xmath13  kev , @xmath14  kev , @xmath15 .",
    "photons were simulated down to 10  kev .",
    "electrons and positrons were absorbed when they slow down to kinetic energies of 100  kev .",
    "the mixed scheme of the simulation in penelope permits to perform fully `` detailed '' simulations .",
    "we have done calculations also in this approach by selecting @xmath16 , @xmath17  kev , @xmath18 . in this case",
    "the absorption energies were fixed to 100 ev for all particles . in all the simulations done with penelope @xmath12",
    "was taken to be 1/20 of the width of the foil , as it is recommended in @xcite .",
    "_ 2 . egsnrc _",
    "egsnrc @xcite is a general purpose package designed for the monte carlo simulation of the coupled transport of electrons and photons in arbitrary geometries .",
    "particle energies above a few kev up to several hundreds of gev can be considered .    multiple scattering of charged particles is described by means of an approach developed by kawrakow and bielajew @xcite in which most of the shortcomings of the molire multiple scattering theory were fixed . within this approach",
    ", track steps are simulated using a single scattering model for short steps and a multiple scattering model for large steps .",
    "in addition one can select between rutherford scattering or scattering including both relativistic and spin effects .",
    "the electron transport algorithm is due to kawrakow and bielajew @xcite and it is usually known as presta - ii .    in egsnrc",
    "the simulation is controlled by the following parameters : smaxir , which defines upper limits on the step size in each region in the geometry ; estepr , which fixes the maximum fractional energy loss per electron step in each region ; estepe , which is a global energy loss constraint , and ximax , which gives the maximum first goudsmit and saunderson moment per step . in our simulations , we have used presta - ii ( which is the default transport algorithm ) and , as indicated in the manual @xcite , the default values smaxir=10@xmath19  cm , estepr=1 , estepe=0.25 and ximax=0.5 must not be changed .",
    "the version v4-r2 - 2 - 3 has been used for calculations .",
    "photons and electrons were followed down to 10 kev .",
    "mcnpx @xcite is a general purpose mc code which permits the description of the transport of different particles in arbitrary materials .",
    "photons , electrons and neutrons , as well as other 29 particles between leptons , baryons , mesons and even light ions can be considered .",
    "the upper energy limits for electrons and photons are 1 and 100 gev , respectively .",
    "a lower limit of 1 kev is fixed for these particles .",
    "the angular deflections in the multiple scattering of electrons are calculated according to the goudsmit and saunderson theory .",
    "when electron energies are below 0.256 mev , the corresponding cross sections are obtained from numerical tabulations developed by riley _",
    "_ @xcite . for higher energy electrons ,",
    "the cross sections are approximated as a combination of the mott and rutherford cross sections , including a correction factor which takes care of the screening .",
    "the particle tracking is governed by emcpf , which is the upper energy limit for detailed photon physics treatment , emax , which fixes the upper limit for electron energy , and the low energy cutoffs .",
    "we have used the default value ( 100 mev ) for emcpf and emax=20 mev , while the low energy cutoffs were fixed to 1 kev . in our simulations",
    "we have used the version 2.4.0 .    in the calculations done with mcnpx , the angular distributions obtained by using the binning indicated in sect . [",
    "sec : mcs ] showed a stepwise shape in which various neighbour bins had the same value .",
    "this is due to the fact that the goudsmit and saunderson angular distribution is sampled by using the inverse transform method applied to a histogram of 34 bins with widths equal or larger than 1 degree . in the cases analyzed here ,",
    "where few interactions occur , this lack of precision in the sampling produces wrong results . to solve this problem ,",
    "the bins in the simulations performed with mcnpx have been enlarged to 1 degree .",
    "in the two experiments mentioned above , the angular distribution of electrons scattered by foils of different materials and widths were measured .",
    "kulchitsky and latyshev @xcite studied the scattering of 2.25 mev electrons by foils of al , fe , cu , mo , ag , sn , ta , au and pb . the thicknesses ( see first row in table [ tab : exper - k ] ) were chosen in order to maintain the half - width of the distribution @xmath2010 degrees in all cases , thus ensuring the validity of the multiple scattering theory .",
    "measurements for angles between 0 and 35 - 40 degrees were done .",
    "electrons with energies in the range 2250@xmath423 kev formed their beam .",
    ".comparison of the values of the parameter @xmath21 obtained after reanalyzing the experimental data of kulchitsky and latyshev @xcite with those quoted by these authors .",
    "the thicknesses of the different foils are also given .",
    "[ tab : exper - k ] [ cols=\"^,^,^,^,^,^,^,^,^ \" , ]     while egsnrc , geant3 and penelope ( v.2005 ) underestimate in all cases the values of @xmath22 , penelope ( v.2003 ) overestimates it for all foils and mcnpx and geant4 show , in this respect , a @xmath23 dependent behaviour .",
    "the differences between the values @xmath24 obtained for the different codes and those we have found in our reanalysis of the experimental data , which show the maximum and minimum absolute values , are shown in table [ tab : ku - results ] .",
    "as we can see , egsnrc and penelope ( v.2005 ) maintain these differences within a range of 3% , geant3 , geant4 and penelope ( v.2003 ) , within 8% , while mcnpx shows a range bigger than 14% .",
    "in order to quantify globally these differences we have calculated , for each mc code , the sum @xmath25 where @xmath26 runs over the eight different foils considered .",
    "the better codes correspond to those with the smaller values of @xmath27 .",
    "the results obtained are shown in the last row of table [ tab : ku - results ] . on the base of this index , the `` best '' results are those obtained with geant4 while the large discrepancies are obtained with geant3 , egsnrc and penelope ( v.2003 ) .",
    "a slightly different situation is found when we compare the results of our simulations to the experimental data of hanson _ et al .",
    "_ @xcite . in fig .",
    "[ fig : comp - au ] we show the ratio of the values @xmath24 ( upper panels ) and @xmath28 ( lower panels ) obtained with the various mc codes to the values @xmath21 and @xmath29 , respectively , for the two au foils in the experiment of hanson _ et al .",
    "the dashed lines represent the ratios between the values @xmath30 and @xmath31 quoted by hanson _",
    "( see table [ tab : exper - h ] ) and @xmath22 or @xmath32 .",
    "as we can see , egsnrc , geant3 , geant4 and penelope ( v.2005 ) provide a very good description of the experiment , mcnpx slightly overestimates ( underestimates ) @xmath22 ( @xmath29 ) and penelope ( v.2003 ) gives the `` worst '' results .",
    "the excellent agreement found for geant4 is not surprising because the multiple scattering theory developed by urbn and which is used in this code has been tuned to reproduce these au experimental data @xcite .",
    "[ fig : comp - be ] shows the comparison with the experimental results of hanson _ et al . _",
    "@xcite for the two be foils .",
    "as said before , data are not available for these foils and we could not perform the corresponding reanalysis . in this case",
    "we have used directly the values @xmath30 and @xmath31 quoted by hanson _",
    "( see table [ tab : exper - h ] ) as reference values . here",
    "the `` best '' description of the experiment is provided by egsnrc , mcnpx and penelope ( v.2005 ) .",
    "geant3 and geant4 show very similar results and the major differences occur for penelope ( v.2003 ) , reaching values around 20% or even larger , both for @xmath24 and @xmath28 . on the other hand , and as in the case of the au slabs ,",
    "relative results are rather similar for both foils .",
    "to finish the discussion we compare now the angular distributions obtained with the different simulation codes .    in fig .",
    "[ fig : comp - codes - ha ] we show these distributions for the four foils of the experiment of hanson _ et al . _ @xcite .",
    "as we can see , the behaviour observed is different in the case of the be foils ( left panels ) than in the au ones ( right panels ) . for",
    "be , the calculations performed with egsnrc ( dashed - dotted curves ) show the maximum values @xmath28 , and are in rather good agreement with the results obtained with penelope ( v.2005 ) ( solid curves ) and mcnpx ( solid triangles ) .",
    "the geant3(dashed curves ) and geant4 ( open squares ) results overlap for all values of @xmath33 and , finally , the penelope ( v.2003 ) ( dotted curves ) are clearly below the other calculations at small angles .",
    "the relative differences between the maximum and minimum values of @xmath28 are 33% and 26.3% for the thin and the ticker foils , respectively .    in the case of the au foils ( see right panels ) , the situation of the penelope ( v.2003 ) results is the same , but the other calculations are all of them grouped .",
    "this is particularly clear in the case of the thicker foil ( lower right panel ) .",
    "the results obtained for the different foils considered by kulchitsky and latyshev @xcite show up a different behaviour . in fig .",
    "[ fig : comp - codes - ku ] we have plotted the angular distributions corresponding to the al , fe , ag and au foils .",
    "similar results are found for the other four foils studied in this experiment .",
    "penelope ( v.2003 ) provides the smaller @xmath28 values in all cases except for mo , in which mcnpx is the code showing the minimum .",
    "egsnrc shows the larger values for al , fe and cu and geant3 for the remaining foils .",
    "as we can see , the results appear to be spread for forward angles and the spreading increases with the atomic number of the material .",
    "the relative differences between the maximum and minimum values of @xmath28 range between 17.3% for cu to 45.9% for pb , being @xmath34 for al and fe . in all cases analyzed , penelope ( v.2005 ) and egsnrc are in good agreement .    to finish , it is worth to point out the situation observed for the au foils . as we can see ( lower right panel in fig .",
    "[ fig : comp - codes - ku ] ) the various codes produce rather different angular distributions for @xmath35 degrees .",
    "this contrasts with the overlapping shown by the results corresponding to the au foils in fig .",
    "[ fig : comp - codes - ha ] ( see right panels . )",
    "in this work the experimental data available for multiple scattering by thin material foils have compared to the simulation results obtained with the mc codes egsnrc , mcnpx , geant3 , geant4 , penelope ( v.2003 ) and penelope ( v.2005 ) .",
    "simulations performed with various older versions of geant4 show up non - negligible differences in the angular distributions with respect to the version 8.0 , differences which are bigger the lower the @xmath23 of the material is .",
    "different simulations done with penelope have indicated large differences in the angular distributions between the versions 2003 and 2005 , though the mean values @xmath36 and @xmath37 obtained with both versions are very similar , as expected .",
    "in addition , we have found discrepancies between the `` safe '' and `` detailed '' simulations which are related to the number of interactions suffered by the electrons in the foil and which can be largely reduced by an adequate selection of the tracking parameters .",
    "we have compared the results of our simulations with the experimental data of kulchitsky and latyshev @xcite by means of the characteristic angle @xmath24 .",
    "we have found that both egsnrc and penelope ( v.2005 ) show differences with respect to @xmath22 which are within a range of 3% for all foils . however , the better description of the experimental data is provided , globally , by geant4 .    the comparison with the results of hanson _ et al .",
    "@xcite shows that egsnrc , geant3 , geant4 and penelope ( v.2005 ) give a good description of the data in the case of the au foils .",
    "for the be foils , the better agreement with the experiment occurs for egsnrc , mcnpx and penelope ( v.2005 ) .",
    "all codes ( except penelope ( v.2003 ) ) show a good agreement for the two au foils in the experiment of hanson _ et al .",
    "_ for the be foils , the maximum relative differences between the codes at @xmath38 are larger than 25% . in the case of the foils in the experiment of kulchitsky and latyshev ,",
    "these maximum relative differences grow with @xmath23 , reaching @xmath39 in the case of the pb foil",
    ". in general , egsnrc and penelope ( v.2005 ) are in rather good agreement for all cases studied .",
    "the effects observed in these thin material foils appear to be non - negligible .",
    "differences between the various mc codes are relevant and the propagation of them to other situations should be investigated in detail .",
    "one of these situations concerns the simulation of electron linear accelerators , where different thin foils are present .",
    "the combined effect of all of them could modify the conclusions found in previous works in which various codes have been intercompared ( e.g. in ref .",
    "@xcite . )    on the other hand it should be interesting to perform new experiments with different materials in order to permit a complete test of the multiple scattering theories used in the mc simulation codes of the radiation transport .",
    "we want to acknowledge useful discussions with f. salvat , j.m .",
    "fernndez - varea , m.a .",
    "coca and d. guirado .",
    "this work has been supported in part by the junta de andaluca ( fqm0220 ) and by the ministerio de educacin y ciencia of spain ( fis2005 - 03577 ) .",
    "i. kawrakow , d.w.o .",
    "rogers , the egsnrc code system : monte carlo simulation of electron and photon transport , nrcc report pirs-701 , nrc , otawa , 2003 , available at + http://www.irs.inms.nrc.ca/inms/irs/egsnrc/egsnrc.html"
  ],
  "abstract_text": [
    "<S> the monte carlo simulation of the electron transport through thin slabs is studied with five general purpose codes : penelope , geant3 , geant4 , egsnrc and mcnpx . </S>",
    "<S> the different material foils analyzed in the old experiments of kulchitsky and latyshev [ phys . </S>",
    "<S> rev . </S>",
    "<S> 61 ( 1942 ) 254 - 266 ] and hanson _ et al . _ </S>",
    "<S> [ phys . </S>",
    "<S> rev . </S>",
    "<S> 84 ( 1951 ) 634 - 637 ] are used to perform the comparison between the monte carlo codes . </S>",
    "<S> non - negligible differences are observed in the angular distributions of the transmitted electrons obtained with the some of the codes . </S>",
    "<S> the experimental data are reasonably well described by egsnrc , penelope ( v.2005 ) and geant4 . </S>",
    "<S> a general good agreement is found for egsnrc and geant4 in all the cases analyzed . </S>"
  ]
}