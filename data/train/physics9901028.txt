{
  "article_text": [
    "many models of statistical mechanics deal with systems composed of classical rigid molecules .",
    "the method of molecular dynamics ( md ) is widely applied for studying such systems .",
    "all known md techniques appropriate to simulate molecular liquids can be split into three main approaches . in the first two approaches , time evolution of the system",
    "is considered in view of translational and rotational motions .",
    "these approaches differ between themselves by parameters which are used to represent the rotational degrees of freedom . in the classical scheme [ 1 , 2 ]",
    ", an orientation of the molecule is defined in terms of three eulerian angles . as is well known [ 3 ] , the equations of motion are singular in this case . to avoid",
    "the singularities , barojas _ et al _ [ 4 , 5 ] have used two different sets of the eulerian angles , each of which is applied in dependence on the orientation of the molecule .",
    "however , this procedure involves additional complex transformations with transcendental functions .    in the second approach the rotation motion of a molecule",
    "is described without involving eulerian angles .",
    "cheung [ 6 ] has shown how to remove the singularities using special properties of diatomic molecules .",
    "for these molecules , singer [ 7 ] has derived rotational equations of motion in terms of radius - vectors passed from one atom to another within the same molecule .",
    "an extension of this scheme to triatomic molecules was considered also [ 8 , 9 ] .",
    "an alternative scheme has been proposed by evans _",
    "et al _ [ 1012 ] , where using so - called quaternions [ 3 , 13 , 14 ] leads to a singularity free algorithm for rigid polyatomics .    in the third approach ,",
    "proposed originally by ryckaert _",
    "et al _ [ 15 ] , the cartesian equations of motion are applied with respect to individual atoms .",
    "the total force on a particle appears as the sum of the force deriving from the potential energy and the force arising due to holonomic constraints .",
    "these atomic constraints must be in part rigid bonds in part linear relations to provide the rigidness of arbitrary polyatomics [ 16 ] .",
    "apart from removing singularities a benefit derived from the last two approaches lies in the avoidance of time - consuming trigonometric functions .",
    "however , on integrating the equations of motion numerically , one additional difficulty appears here , namely , the problem of exact conservation of molecular rigidity . in the usual integration algorithms the rigidity can not be conserved with the precision better than that of evaluating the atom trajectories . for overcoming this drawback ,",
    "it is necessary either to perform the rescaling of quaternions [ 11 ] or , within the atomic - constraint technique , to find solutions for a complete system of nonlinear equations [ 15 , 16 ] at each step of the integration .    from the aforesaid",
    ", a natural question appears about the existence of a scheme which is free of all these drawbacks and yet has all advantages inherent in the mentioned above approaches . in the present paper",
    "we develop the idea of using quaternions to treat rotational motion .",
    "section  2 is devoted to a general formulation of the quaternion dynamics with constraints .",
    "applications of this approach to particular algorithms are considered in sec .",
    "the problem of how to adapt the verlet algorithm to integrate the quaternion equations of motion is also solved there . in sec .",
    "4 various approaches are compared and discussed .",
    "some concluding remarks are given in sec .",
    "we consider a system of @xmath0 identical rigid molecules with mass @xmath1 , composed of @xmath2 point atoms . in the molecular approach , evolution of the system in time",
    "is separated into translational and rotational motions .",
    "the translational motion is applied to the molecule as a whole and can be described by the @xmath3 ( @xmath4 ) newton equations @xmath5 , where @xmath6 and @xmath7 are the positions of the center of mass and atom @xmath8 of molecule @xmath9 in the laboratory fixed coordinate system l , respectively , and @xmath10 are the atom - atom forces between two different molecules .    in order to analyze rotational motions , we introduce the sets @xmath11 and @xmath12 of orthogonal unit vectors characterizing the l - system and the moving coordinate system s@xmath13 attached to molecule @xmath9 , respectively , where @xmath14 is a rotational matrix .",
    "the angular velocity @xmath15 of the @xmath9-th molecule is defined as @xmath16 .",
    "the principal components , @xmath17 , of angular velocities ( @xmath4 ) obey the @xmath3 euler equations [ 1 ] : @xmath18 where @xmath19 ; @xmath20 and @xmath21 .",
    "here @xmath22 , @xmath23 and @xmath24 are the moments of inertia along principal axes of the molecule , @xmath25 is the torque exerted on molecule @xmath9 with respect to its center of mass due to the interactions with the other molecules , @xmath26 and @xmath27 .",
    "let @xmath28 be a vector - column of positions for atom @xmath8 within the molecule in the s@xmath13-system , i.e. , @xmath29 .",
    "then the positions of atoms in the l - system at time @xmath30 are @xmath31 , where @xmath32 denotes the matrix transposed to @xmath33 .",
    "it is a common practice to define an orientation of the s@xmath13-system with respect to the laboratory frame in terms of three eulerian angles .",
    "a numerical integration of the corresponding equations of motion has been performed in early investigations [ 1 , 2 ] .",
    "as was soon realized , however , this procedure is very inefficient because of the singularities whenever the azimuthal angle of a molecule takes the value @xmath34 or @xmath35 [ 11 ] .",
    "it has been shown in later investigations [ 10 , 11 ] that at least four orientational parameters per molecule ( quaternion ) must be used to avoid the singularities .",
    "the orientational matrix @xmath36 in terms of the quaternion @xmath37 is given by [ 10 , 11 ] : @xmath38 and the time derivative of the quaternion is expressed via principal components of angular velocity as follows @xmath39 where the matrix @xmath40 is the function of @xmath41 .",
    "it is worth to underline that the matrix @xmath33 is a rotational one if the quaternion satisfies the equality @xmath42 . differentiating the relation ( 3 ) over time yields @xmath43 where @xmath44 .",
    "it is trivial to find that the inverse matrix @xmath45 since the @xmath46 matrix @xmath40 is orthogonal when @xmath47 .",
    "we have augmented the angular velocity vector to involve square matrices using the result @xmath48 which follows from the equality @xmath47 .",
    "then , using the newton and euler equations ( 1 ) , we obtain the coupled set of @xmath49 second - order differential equations of motion @xmath50 in terms of the @xmath49 generalized coordinates @xmath51 .",
    "if an initial state @xmath52 is specified , the evolution @xmath53 of the system can be unambiguously determined .",
    "let us look for an analytical solution of the quaternion equations of motion by writing @xmath54 where @xmath55 denotes the @xmath56-fold time derivative of @xmath41 at time @xmath57 .",
    "it is easy to check from the structure of equation ( 3 ) that arbitrary - order time derivatives of the quaternion constraint @xmath58 are equal to zero , i.e. , @xmath59 , @xmath60 and so on .",
    "therefore , if all terms @xmath61 of the taylor s expansion ( 5 ) are taken into account and initially all the constraints are satisfied , @xmath62 , they will be fulfilled at later times as well . in practice , however , the equations of motion are not solved exactly , so that these constraints will only be satisfied approximately .",
    "let the integration algorithm used involves an error in the coordinates of order @xmath63 , where @xmath64 is the time step . in the simplest case of taylor s expansion ( 5 )",
    ", this is the order of the first omitted term .",
    "then the same order of uncertainties will be accumulated at each time step in conservation of the molecular rigidity , i.e. , @xmath65 .",
    "in such a case , molecules are collapsed or even destroyed in time . in the usual version",
    "[ 11 ] of the quaternion method , to achieve the required rigidity at all times , it was proposed to multiply each quaternion component , associated with the same molecule , on the common factor @xmath66 at every time step of the numerical integration ( the so - called rescaling scheme ) .",
    "we consider now the question how to replace the crude quaternion renormalization by a more natural procedure in the framework of a systematic approach .",
    "the fact that quaternion components are not independent , requires , in general , the necessity of introducing additional forces , namely , @xmath67 , which appear as a result of the constraints .",
    "these virtual quaternion - constraint forces should be added to the equations of motion ( 4 ) and , as a consequence , they modify the solution ( 5 ) as follows @xmath68\\ ] ] where @xmath69 denote the @xmath70-fold time derivatives of constraint forces , @xmath71 is a value of the lagrange multiplier @xmath72 , and @xmath73 are its @xmath74-fold time derivatives ( @xmath75 ) at time @xmath57 . differentiating ( 6 ) ,",
    "we obtain @xmath76-fold time derivatives ( @xmath77 ) of @xmath41 at time @xmath30 : @xmath78 in order to computer @xmath79 unknowns @xmath73 , we have merely to exploit the information contained in the constraint @xmath80 . as this holds at any time , at least the first @xmath81 time derivatives of @xmath82 must vanish .",
    "then one obtains @xmath83 : @xmath84\\ ] ]    in view of explicit expressions ( 7 ) , the conditions ( 8) together with the basic constraints @xmath85 constitute a system of @xmath79 nonlinear equations per molecule with respect to the same number of unknowns @xmath73 .",
    "the equations can be linearized and solved in a quite efficient way by iteration .",
    "this is justified for @xmath86 because then the terms nonlinear in @xmath73 are small .",
    "thus the iteration procedure can be initiated by substituting in all nonlinear terms , and iterations always converge rapidly to the physical solutions @xmath87 .",
    "the contributions of quaternion - constraint forces into the quaternion dynamics ( 6 ) are of order @xmath63 , i.e. , the same order as uncertainties of the integration algorithm ( 5 ) , but the rigidity is now fulfilled perfectly for arbitrary times in future .",
    "it is worth emphasizing that these forces are imaginary and depend on details of the numerical integration in a characteristic way , contrary to the real bond forces in the atomic - constraint dynamics [ 15 , 16 ] .",
    "they vanish if the equations of rotational motion are solved exactly .",
    "usually , the gear predictor - corrector algorithm [ 17 , 18 ] is applied to integrate the equations of rotational motion [ 1 , 11 , 12 ] .",
    "in particular , it has been used [ 11 , 12 ] for the integration of the quaternion equations . within the gear method the quaternions and their time derivatives",
    "are predicted using the pascal triangle @xmath88 , where @xmath89 and @xmath90 is the order of the algorithm .",
    "further , they are corrected one or more times , using new values of torques as well as rotational velocities and their time derivatives which are predicted and corrected simultaneously with quaternion variables .",
    "the gear method can be modified within the quaternion - constraint dynamics as follows . to simplify notations ,",
    "we choose the fourth order scheme ( @xmath91 ) ( the extension to arbitrary orders is trivial ) .",
    "let @xmath92 ( as well as @xmath93 ) be already defined quantities after the last step of the corrector procedure . then , according to the constraint formalism , the variables @xmath94 , @xmath95 and @xmath96 @xmath97 transform into @xmath98 where @xmath99 , @xmath100 , @xmath101 and @xmath102 , @xmath103 , @xmath104 are values of the lagrange multiplier and its first and second time derivatives at time @xmath30 . the expressions ( 9 ) present , in fact , ( in somewhat other notations ) a particular case ( @xmath91 ) of generalized equations ( 7 ) .",
    "therefore , the three unknowns @xmath102 , @xmath103 and @xmath104 are found solving by iteration the system of three nonlinear equations @xmath105 as in the general case ( 8) , the iteration procedure is initiated by putting @xmath106 in nonlinear terms , and unknown quantities quickly tend to the physical solutions @xmath107 , @xmath108 and @xmath109 .",
    "there are the well - known group of integrators comprising verlet [ 19 ] , leapfrog [ 20 ] , velocity verlet [ 21 ] and beeman [ 22 ] methods . due to their simplicity and exceptional numerical stability",
    "they play an important role in the classical methodology of molecular dynamics .",
    "all or some of these methods are always described and compared in any modern textbook [ 13 , 14 , 20 , 23 , 24 ] . however ,",
    "the mentioned above approaches , being constructed initially for the integration of newton s equations for translational motion , are not necessarily applicable directly to rotational dynamics . to our knowledge ,",
    "only the leapfrog method has its versions for rotational motion [ 13 ] .",
    "the reason of such a situation is that contrary to translational dynamics , the second time derivatives of variables , associated with rotational degrees of freedom , may depend on their first time derivatives . in our case",
    "the pattern is complicated additionally by the necessity of including constraints in the equations of motion .",
    "we shall show now how to solve these problems within the verlet algorithm in velocity form .",
    "let @xmath110 be a spatially - velocity configuration of the system at time @xmath30 and @xmath111 .",
    "the translational part @xmath112 of variables is considered within the verlet algorithm in the usual way [ 21 , 24 ] , whereas the rotational variables @xmath113 can be evaluated as follows . using the principal torques",
    "@xmath114 , we define angular accelerations @xmath115 and , therefore , second time derivatives @xmath116 ( 4 ) on the basis of equations ( 1 ) for rotational motion . then , taking into account the constraint forces @xmath117 yields @xmath118 the lagrange parameters @xmath102 are defined from the constraint relations @xmath119 which constitute a single quadratic equation per molecule with the following solutions @xmath120 \\ , \\ ] ] where the time derivatives of quaternions are taken at time @xmath30 . as can be verified easily , only the first solution is in self - consistency with the integration scheme . in the limit of small time steps",
    ", this solution behaves as @xmath121 , i.e. , @xmath122 .",
    "therefore , the constraint forces contribute into the quaternion dynamics ( 11 ) terms of order @xmath123 , i.e. , the same order as numerical errors of the used algorithm , but the rigidity of molecules is now fulfilled exactly , i.e. , @xmath124 .",
    "and now we consider how to perform the second step @xmath125 of the velocity verlet method , where @xmath126 denotes a spatial coordinate .",
    "there are no problems to pass this step in the case of translational motion , when @xmath127 and @xmath128 is the translational velocity .",
    "however , the difficulties immediately arise for rotational motion , because then the second time derivative @xmath129 can depend explicitly not only on the spatial coordinate @xmath126 , but on the generalized velocity @xmath130 as well .",
    "for example , choosing @xmath131 , we obtain on the basis of equations of motion ( 1 ) and ( 4 ) that @xmath132 . in view of ( 13 ) this leads to a very complicated system of four nonlinear equations per molecule with respect to four unknown components of the quaternion velocity @xmath95 .",
    "it is necessary to note that analogous problems appear at attempts to apply the leapfrog , usual verlet and beeman methods for rotational motion ( even much more difficult in the last two cases ) .",
    "an alternative has been found in a rotational motion version [ 13 ] of the leapfrog algorithm .",
    "it has been suggested to associate the quantity @xmath130 with the angular momentum @xmath133 of the molecule in the laboratory system of coordinates , i.e. , @xmath134 , where @xmath135 and @xmath136 is the diagonal matrix of principal moments of inertia .",
    "then the equation ( 13 ) is simplified , @xmath137 and , therefore , @xmath138 are easily evaluated using the torques @xmath139 in the new spatial configuration @xmath140 . at the same time , new values for principal angular and quaternion velocities are obtained ( when they are needed ) using the relations @xmath141 and @xmath142 .",
    "finally , we consider the third version of the velocity verlet method for rotational motion .",
    "the idea consists in using angular velocities as independent parameters for describing the sate of the system in phase space . then choosing @xmath143 and taking into account euler equations ( 1 ) , we obtain from ( 13 ) the following result @xmath144",
    "\\\\ \\hspace{1.8 cm } + \\big(j_\\beta - j_\\gamma\\big ) \\big({\\mit \\omega}_\\beta^i(t ) { \\mit \\omega}_\\gamma^i(t ) + { { \\mit \\omega}_\\beta^i}^{(n-1)}(t+{\\mit\\delta}t ) { { \\mit \\omega}_\\gamma^i}^{(n-1)}(t+{\\mit\\delta}t ) \\big ) \\bigg ] \\ . \\nonumber\\end{aligned}\\ ] ] unless @xmath145 , the equations ( 15 ) are , in fact , the system of three quadratic equations per molecule with respect to the three unknowns @xmath146 .",
    "the system ( 15 ) is relatively simple and can be solved by iteration @xmath147 with @xmath148 as an approximation of zero order .",
    "a few iterations is sufficient for actual time steps to find the desired solutions with a great precision .    from a mathematical point of view , all the three representations @xmath149 or @xmath15 are completely equivalent , because the knowledge of an arbitrary quantity from the set @xmath150 allows us to determine uniquely the rest of two ones . in the case of numerical integration",
    "the pattern is qualitatively different , because the investigated quantities are evaluated approximately .",
    "the choice @xmath151 can not be recommended for calculations due to its complexity . moreover",
    ", it has yet a major disadvantage that the equality @xmath152 is broken at time @xmath153 , whereas this equality remains in law by construction in other two cases .",
    "the case @xmath154 is the most attractive in view of the avoidance of nonlinear equations .",
    "computations show ( see sec .",
    "4 ) , however , that the best numerical stability with respect to the total energy conservation exhibits the third version , when @xmath155 .",
    "the reason of this can be found , taking into account that a kinetic part , @xmath156 , of the total energy is calculated directly from principal angular velocities . at the same time , to evaluate angular velocities within the previous approach the additional transformations @xmath157 with approximately computed matrices @xmath158 and angular momenta @xmath159 are necessary .",
    "they contribute an additional portion into accumulated errors at the calculations of the total energy .",
    "we now test our integration approach on the basis of md simulations for a tip4p model [ 25 ] of water .",
    "the simulations were performed in the microcanonical ensemble at a density of 1 g/@xmath160 and at a temperature of 298 k. we considered a system of @xmath161 molecules in the reaction field geometry [ 26 ] .",
    "all runs were started from an identical well equilibrated configuration .",
    "numerical stability was identified in terms of the relative fluctuations @xmath162 of the total energy of the system during time @xmath30 .",
    "samples of the function @xmath163 for the fourth - order gear algorithm are presented in fig .",
    "it can be seen easily from the figure that within the modified version , where quaternion - constraint transformations ( 9 ) are applied , the conservation of the total energy is improved considerably in comparison with that obtained within the original version of the algorithm , when no additional corrections are used .",
    "the system of nonlinear equations ( 10 ) were solved with the relative iteration precision of @xmath164 and the number of iterations never exceeded 5 . at the same time , applying the rescaling scheme leads even to worse results than those given by the original version . despite the fact that the gear algorithm integrates the equations of motion very well at @xmath165 fs",
    ", it has a very small region of stability with respect to time steps [ 16 ] and can not be used for @xmath166 fs ( see fig .",
    "moreover , the scheme predictor - corrector - corrector , which was chosen by us at @xmath167 fs to provide an optimal performance , takes computational time per step twice larger than the verlet integrator ( in the case @xmath168 fs , three corrector steps were used ) .    as the atomic - constraint technique [ 15 , 16 ]",
    "is intensively exploited and its advantages with respect to numerical stability are generally recognized , we have made comparative test carrying out explicit md runs using this method as well as the angular - velocity verlet algorithm ( 15 ) within the quaternion - constraint dynamics ( 11 ) .",
    "the usual value of the time step in simulating such a system is @xmath169 fs [ 27 ] .",
    "these two approaches required almost the same computer time per step ( 96% being spent to evaluate pair interactions ) .",
    "the corresponding functions @xmath163 are shown in fig .  2 at four fixed values @xmath170 1 , 2 , 3 and 4 fs .",
    "for the purpose of comparison the results obtained within the angular - momentum version ( 14 ) are also included in this figure ( insets ( a ) , ( b ) ) .",
    "the rescaling scheme ( instead of the quaternion - constraint dynamics ) within the angular - velocity verlet version was considered as well .    at the smallest time step ( fig .",
    "2a ) , all the approaches exhibit similar equivalence in the energy conservation .",
    "the time step @xmath171 fs is too small , however , and impractical in simulations because it requires too much computation time to cover the sufficient phase space . for larger time steps ( fig .",
    "2b - d ) , the total energy fluctuations increase drastically with increasing the length of the runs within the usual quaternion rescaling scheme , whereas the atomic- and quaternion - constraint methods conserve the energy approximately with the same accuracy .",
    "as far as the rescaling of quaternions has been chosen , it must be applied after each time step to achieve an optimal performance within the verlet integrator .",
    "for example , if no corrections are performed , the rigidity of molecules is broken catastrophically ( see the dotted curve in fig .",
    "as we can see , the modified quaternion approach always leads to improved results .",
    "finally , we show in fig .",
    "2a , b that the angular - momentum version of the verlet algorithm is much more unstable and can be used at small ( @xmath167 fs ) time steps only .",
    "for these reasons , taking into account also comments on the gear algorithm , the crude renormalization procedure is generally not recommended and preference must be given to the modified quaternion approach within the angular - velocity verlet integrator .",
    "quite a few iterations ( the mean number of iterations per molecule varied from 2 to 4 at @xmath172 1  4 fs ) was sufficient to obtain solutions to the system of nonlinear equations ( 15 ) with the relative iteration precision of @xmath164 .",
    "this required a negligible small computation time additionally to the total time .",
    "the calculations have shown that the same level @xmath173 of energy conservation can be provided by the time steps of 2.1 , 3.7 and 4.0 fs within the quaternion rescaling , atomic- and quaternion - constraint schemes .",
    "therefore , the last two approaches allow a time step approximately twice larger than the quaternion rescaling method .",
    "a reason of this gain in time can be explained by the fact that the rescaling of quaternions is an artificial procedure .",
    "it involves an unpredictable discrepancy in the calculation of trajectories of atoms at each step of the integration process and leads to significant deviations of the total energy . at the same time , the atomic- and quaternion(molecular)-constraint techniques provide the rigidity of molecules in a more natural way .",
    "an alternative scheme to overcome the difficulties in simulations of rigid polyatomics has been proposed .",
    "the scheme uses the constraint formalism for treating quaternion dynamics . as a result ,",
    "the rigidity problem has been rigorously resolved , using quaternion - constraint forces .",
    "although this introduces some extra transformations , but presents no numerical difficulties . in a particular case of the velocity verlet algorithm , the constraint version of the quaternion approach allows one to perfectly fulfil the rigidity of molecules at each step of the trajectory without any additional efforts and loss of precision .",
    "avoidance of the necessity to solve complex nonlinear equations for maintaining molecular rigidity should be a benefit of the presented approach with respect to the atomic - constraint dynamics .",
    "it has been corroborated by actual md simulations that the quaternion rescaling method is much less efficient than the atomic- and quaternion - constraint techniques .",
    "the last both schemes seem to be comparable in efficiency .",
    "the advantage of the modified quaternion approach is that it improves the energy conservation considerably at a little computational cost .          *",
    "fig .  1 .",
    "*  the relative total energy fluctuations as functions of the length of the simulations performed within three versions of the gear algorithm at four fixed time steps . note , that all three curves are indistinguishable in * ( a)*.    * fig .  2 . *  the relative total energy fluctuations as functions of the length of the simulations performed within the atomic - constraint technique and various versions of the velocity verlet algorithm at four fixed time steps .",
    "the dotted curve in * ( b ) * corresponds to the usual quaternion approach without any additional corrections .",
    "note , that three of four curves are indistinguishable in * ( a)*."
  ],
  "abstract_text": [
    "<S> a revised version of the quaternion approach for numerical integration of the equations of motion for rigid polyatomic molecules is proposed . </S>",
    "<S> the modified approach is based on a formulation of the quaternion dynamics with constraints . </S>",
    "<S> this allows to resolve the rigidity problem rigorously using constraint forces . </S>",
    "<S> it is shown that the procedure for preservation of molecular rigidity can be realized particularly simply within the verlet algorithm in velocity form . </S>",
    "<S> we demonstrate that the presented method leads to an improved numerical stability with respect to the usual quaternion rescaling scheme and it is roughly as good as the cumbersome atomic - constraint technique .    </S>",
    "<S> -1 cm </S>"
  ]
}