{
  "article_text": [
    "image processing in 3d becomes more and more popular and necessary due to the enormous amount of scientific data acquired with modern imaging techniques like magnetic resonance imaging , computer tomography or confocal laser microscopy to mention only a few .",
    "still , the processing of directional or tensorial information derived from primary modalities or directly measured like in diffusion weighted imaging ( dwi ) drives todays hardware to its limits .",
    "for example , imagine a typical dwi measurement with imaging matrix of @xmath3 .",
    "if we want to sufficiently represent the orientation space with e.g. @xmath4 points , we need already about 4 gb of memory for just one instance . as typical algorithms ( e.g. like conjugate gradients ) usually require for more than one instance , we are already at the limits of a common desktop pc . in this article",
    "we describe how the generators of diffusion and convection on @xmath5 and @xmath6 can be described and implemented in terms of the irreducible representations of the 3d rotation group .",
    "most of the implementations solving @xmath5-diffusion equations @xcite relied on an equiareal discretization of the two - sphere @xmath2 , while implementation for functions @xmath7 even do not exist due to the enormous memory consumption , although there might be several useful applications like feature detection for non - rotation symmetric templates . indeed , there are implementations @xcite that use spherical harmonics as an intermediate @xmath2-interpolation scheme , but they can not benefit of the well - known advantages of the spherical harmonic representation , like the compact and memory efficient storage , the analytic and efficient computations of @xmath2-convolutions , and the closeness under rotations .",
    "the aim of this paper is the formulation of common differential operators acting on functions @xmath8 in terms of spherical harmonics .",
    "more generally , we show how a large class partial differential equations on functions @xmath7 can be represented in terms of the irreducible representations of the rotations group @xmath1 and solved without any angular discretization . in this way one can benefit from all the advantages which the harmonic representations offer .",
    "a discretization of the @xmath2 or @xmath1 , respectively , is avoided , and one is able to implement diffusion on the full @xmath0 with reasonable memory consumption .",
    "we show one application in the context of high angular resolution diffusion mr - imaging , where spherical harmonic representations are common and compare to the equiareal representation .",
    "second , it is shown how the proposed framework can be used to implement the spherical hough transform in an efficient manner .      in the context of line and contour enhancement in 2d the special motion group @xmath9 plays a key role @xcite .",
    "it can be used to set up a scale space theory .",
    "more recently , extensions to 3d of these concepts appeared @xcite .",
    "while the applications in 2d are typically related to feature detection and image enhancement , the 3d extension offers a new application field : the processing of diffusion weighted magnetic resonance images ( dwi ) . in dwi",
    "already the acquired measurements are functions on @xmath10 . based on the directional dependency of water diffusivity in fibrous tissue of the human brain it is possible to reveal underlying connectivity information .",
    "one of the main challenges in dwi is the estimation in so - called fiber / diffusion orientation distributions .",
    "there are numerous methods for estimating orientation distributions : classical q - ball imaging @xcite , constrained spherical deconvolution @xcite , proper probability density estimation @xcite and spatially regularized density estimations for tensor - valued images @xcite .",
    "most of the employed algorithms rely on tensorial or spherical harmonic representation of the orientation distributions .",
    "on the other hand , most of the algorithms for orientation distribution estimation that consider the local surrounding of a voxel and use intervoxel information rely on a discretization of the two - sphere @xcite .    in two dimensions the representation of orientation and tensor fields in terms of circular harmonics ( or , the irreducible representations of @xmath11 ) is relatively simple and quite frequent in literature @xcite .",
    "complex calculus offers a well - founded background : the ordinary cartesian partial derivatives @xmath12 are replaced by the complex ones @xmath13 and @xmath14 . in @xcite three - dimensional derivative operators",
    "are introduced that behave similar to complex derivatives , that is , they are compliant with the rotation behavior of spherical harmonics in 3d . in @xcite the fourier transform of @xmath0 is used in the context of engineering applications . for the efficient computation of @xmath0-convolution functions",
    "are expressed in terms of the unitary irreducible representations ( uir ) of @xmath0 .",
    "the present work proposes a kind of intermediate representation . while the full @xmath0-uir representation decomposes also the spatial variable in terms of bessel - functions , the representation in terms of @xmath1-uir leaves the spatial part untouched .",
    "most of the mathematical notations and conventions are adopted from @xcite regarding the geometry and parametrization of @xmath0 and @xmath1 . regarding the irreducible representations the notations are similar to @xcite .",
    "in section [ sec : diffgeo ] we give a short introduction into the geometry of @xmath0 and fix the related conventions .",
    "section [ sec : irred ] introduces the necessary background of representation theory of @xmath1 .",
    "the main contribution of this work is presented in section [ sec : main ] , where the left - invariant vector - fields of @xmath0 are expressed in terms of the irreducible representations of @xmath1 .",
    "finally , in section [ sec : exp ] applications in the context of dwi and object detection are proposed .",
    "the motion group is the semidirect product of the rotation group @xmath1 and the translation group .",
    "an element @xmath15 is composed of a translation vector @xmath16 and a rotation matrix @xmath17 with multiplication law @xmath18 the lie group @xmath19 is generated by the six dimensional lie algebra @xmath20 spanned by the six left - invariant vector fields @xmath21 corresponding to the three translations and the three rotation axis .",
    "they generate the right regular motion of smooth functions @xmath22 , i.e. if we define @xmath23 , then the application of a left - invariant vector - field @xmath24 gives @xmath25 where @xmath26 is a smooth curve with @xmath27 .",
    "and hence @xmath28 note that the tangents @xmath29 do vary over the group and depend on the point @xmath30 .",
    "the vector - fields are usually expressed in euler angles .",
    "we parametrized the rotation in euler - angles @xmath31 in zyz convention as follows @xmath32 where all rotations are counter - clockwise . in this parametrization",
    "the left - invariant vector - fields of the translation take the form : @xmath33 with @xmath34 and for the rotation @xmath35 note that the fields depend explicitly on the position in the group .",
    "the conventions are the same to ones used in @xcite .",
    "it is well known that the spherical harmonics ( see appendix [ ap : sh ] for definition ) are a orthogonal basis for the square integrable functions on the unit sphere @xmath36 .",
    "they have a variety of gentle properties with respect to rotations .",
    "the wigner d - matrices play the same role for square integrable functions @xmath37 on the rotation group @xmath1 itself .",
    "they are representations of @xmath1 and are written in euler angles as @xmath38 where the real small d - matrix @xmath39 is related to the jacobi polynomials ( see appendix [ ap : wigner ] ) . as the @xmath40 are representations of @xmath1 they obey the multiplication law @xmath41 for any @xmath42 . for each order",
    "@xmath43 they work on complex @xmath44-dimensional vector spaces , i.e. @xmath45 .",
    "furthermore , they are the irreducible representations of @xmath1 , i.e. there is no linear transformation @xmath46 such that @xmath47 is block - diagonal for all @xmath48 . for @xmath49 there is the direct relation to the original rotation matrix @xmath50 by @xmath51 note that @xmath52 is unitary , i.e. @xmath53 . the irreducibility has an important consequence . by the peter - weyl theorem",
    "the irreducible representations form a complete orthogonal basis set of functions with respect to the group dot - product : @xmath54 thus , we can write any @xmath55 as @xmath56 where the expansion coefficients can be obtained by a simple projection @xmath57 onto the wigner d - matrix .      the clebsch gordan ( cg ) coefficients interrelate the irreducible representations of different order .",
    "we denote a clebsch gordan coefficient by @xmath58 where @xmath59 are different orders such that the triangle inequality @xmath60 holds , otherwise the coefficients vanish .",
    "the basic equation connecting two different representations of order @xmath61 and @xmath62 is the following @xmath63 note the additional selection rule of the cg - coefficients , they only contribute if @xmath64 .",
    "one also knows that @xmath65 if @xmath66 is odd . there is a variety of orthogonality and symmetry relations for the clebsch - gordan coefficients making them itself a similarity transformation .",
    "we mention here the most important orthogonality relations : @xmath67 for example , suppose a sequence of numbers @xmath68 with @xmath69 is given .",
    "then , for two fixed @xmath70 obeying @xmath71 we can compute @xmath72 , which contains all the information about the original @xmath68 in an unitary way .",
    "besides the orthogonality relations there are numerous other symmetry and associativity relations for the clebsch gordan coefficients , some of them are listed in appendix [ ap : cg ] .      in terms of the associated legendre polynomials",
    "the components @xmath73 of the racah - normalized spherical harmonics ( for further details see appendix [ ap : sh ] ) are written as @xmath74 instead of @xmath75 defining a point on the sphere , we write in the following @xmath76 as normalized cartesian vector .",
    "there is a close relation between the wigner d - matrix and the spherical harmonics : @xmath77 for any @xmath48 and @xmath76 .",
    "that is , the expansion coefficients of a spherical harmonic expansion rotate by the application of wigner d - matrices . with this",
    "we can identify the central column of a wigner d - matrix with a conjugate spherical harmonic by rotating a spherical harmonic along the z - axis @xmath78 and with the additional knowledge that @xmath79 we have @xmath80 next to the spherical harmonics , the so called solid harmonics @xmath81 are solutions of the homogeneous laplace equation , i.e. @xmath82 .",
    "they are homogeneous polynomials of degree @xmath83 , that is , @xmath84 for any @xmath85 .",
    "so , we can define a differential operator as follows @xmath86 which is a spherical tensor operator , i.e. it inherits all rotation properties of irreducible representations .",
    "further note that @xmath87 .",
    "the quadratic forms in the left - invariant vector fields @xcite generate the dynamics on functions @xmath22 .",
    "our goal is to find them in terms of the irreducible representations of @xmath1 .",
    "more precisely , suppose we have an evolution equation @xmath88 where @xmath30 is parametrized as proposed above and the evolution generator is a polynomial in the left - invariant vector fields @xmath89 .",
    "that is , @xmath90 acts as a differential operator in @xmath91 and @xmath92 on the function @xmath93 . by decomposing @xmath93 in terms of wigner d - matrices",
    "@xmath94 we will be able to show that the evolution equation in terms of @xmath95 is just a differential operator in the spatial coordinates and algebraic for the angular coordinates .",
    "the form of the equation will not depend on the particular choice of the chart chosen to parametrize @xmath1 .",
    "that is , we expect the equation to be @xmath96 where the @xmath97 are differential operators in the spatial coordinates . to find @xmath98 we have to express all appearing quantities in terms of the irreducible representations @xmath99 , i.e. we have to evaluate the matrix elements @xmath100 or @xmath101 , respectively , which is subject of the next section .",
    "note , that by the help of the uir of the full group @xmath0 @xcite , the above equation can be made purly algebraic as long as no external gauge field is used .",
    "however , this approach would also approximate the translation / spatial part of the function , which is in our context not neccessary and avoids any approximation artefacts coming from this side .",
    "of course , the wigner - d expansion is restricted to a finite cutoff index @xmath102 in practice , and thus , we also have approximation errors . more precisely ,",
    "if @xmath103 is the linear orthogonal projector onto the subspace of functions spanned by the wigner - d matrices up to an order of @xmath102 , then the approximated evolution generator is @xmath104 and the corresponding evolution operator is @xmath105 .",
    "that is , the obtained time evolution is not the projection @xmath106 of the original one , which is important to note .",
    "we start with switching to the complex representation which is obstructed by the irreducible representation of rank @xmath49 : @xmath107 @xmath108 where we formally discriminate between both representations by numeric or character @xmath109 subindices .",
    "the @xmath110 are well known from quantum mechanics and engineering literature @xcite as the body - fixed rigid rotor angular momentum operators .",
    "they obey the following equations : @xmath111 thus , we can directly compute the action of the operators @xmath112 onto the coefficients fields @xmath113 . therefore , we denote the collection of all coefficients by a bold latin letter @xmath114 and we access elements of @xmath114 by round brackets , i.e. @xmath115 and thus , the coefficient @xmath116 is the projection of @xmath117 onto the orthogonal wigner d - matrix basis : @xmath118 where the integration ranges over @xmath1 . with formula and partial integration",
    "we can find @xmath119 and similarly with equation we can proceed as follows : @xmath120 the translations are a bit more intricate to compute .",
    "we apply the right hand side of equation , i.e. @xmath121 onto the field @xmath93 and project onto the orthogonal wigner basis : @xmath122 by using the integral formula for triple products of wigner d - matrices we get @xmath123 which is already our first main result .",
    "it gives the action of the translational left - invariant vector - fields @xmath124 in terms of the wigner expansion coefficients @xmath125 .",
    "note that the sums are very sparse , which is from a computational viewpoint quite important .",
    "the sum for @xmath126 runs only over three terms .",
    "while the linear forms in the left - invariant vector - fields generate euclidean motion , the quadratic forms generate diffusion . the important laplace beltrami operator on so(3 )",
    "@xmath127 generates diffusion on @xmath1 .",
    "the action of @xmath128 onto the coefficients @xmath125 can be computed with the help of equation and to @xmath129 other arbitrary products @xmath130 can be computed quite easily by the use of equation and .",
    "also products of rotations @xmath131 and translations @xmath132 can be computed by the use of the first - order equations , , .",
    "you can find the detailed formulas in appendix [ ap : mixedquad ] .",
    "however , the product of two translations is again more cumbersome to evaluate .",
    "the vector field @xmath133 transforms with respect to @xmath134 and @xmath135 like a cartesian rank 2 tensor . by using equation",
    "we can write it in terms of spherical tensors as follows ( for a proof see appendix [ ap : proofshquad ] ) : @xmath136 where @xmath137 , which is related to the trace of @xmath133 , i.e. @xmath138 . the second term is related to traceless matrix @xmath139 . by using equation we can proceed like in the linear case : @xmath140 where we have again used formula for the triple products of wigner d - matrices . to simplify the formula we consider the special case @xmath141 , i.e. @xmath142 , which gives @xmath143 on the other hand @xmath144 gives @xmath145 note that there is only a small change between @xmath146 and @xmath147 .",
    "one can easily see that @xmath148 .",
    "given a function @xmath150 it is natural to extend to functions @xmath151 by @xmath152 hence , there is the symmetry @xmath153 for any rotation around the z - axis . in euler angles",
    "this means that @xmath154 . by this restriction",
    "the evolution operator @xmath90 has to be invariant with respect to a rotation around the z - axis @xmath155 ( see @xcite for details ) .",
    "note that such an invariant @xmath90 always depends on @xmath156 and @xmath157 ( at least if no other external gauge image is used ) . to understand the implications for the wigner d - expansion we have to look for wigner d - matrices that satisfy @xmath158 for any @xmath159 .",
    "from the explicit form in equation it is easy to see that this holds for all @xmath160 .",
    "so , the expansion in terms of wigner d - matrices reduces to the usual spherical harmonic expansion @xmath161 to translate the general action of the translational vector - fields in equation onto this special case , we just have to set @xmath162",
    ". the selection rules of the clebsch - gordan coefficients imply @xmath163 , meaning that only the @xmath164 gives non - vanishing contributions , which is in agreement with @xcite that only those operators survive the construction that are well defined on the cosets @xmath165 . for this special case",
    "we visualize the matrix elements graphically in figure [ fig : transmat ] , where we use the abbreviation @xmath166 for the block matrices on the upper and lower secondary block diagonal , where @xmath167 is the differential order of the operator .",
    "the rank @xmath83 is the rank of spherical tensor field which is returned after application of @xmath168 and @xmath126 is the rank of the incoming spherical tensor field .",
    "so , we can write equation for @xmath163 more compactly as @xmath169 note that the matrices @xmath170 are also very sparse , the non - zero elements are shaded in blue in figure [ fig : transmat ] .",
    "[ fig : transmat ]    in the same fashion we can write the second order operators @xmath171 and @xmath172 both operators generate horizontal and orthogonal diffusion ( @xcite ) .",
    "there are also generalizations of these diffusion generators by convolutions with rotation symmetric functions on @xmath2 .",
    "these convolutions are known to have a very simple diagonal form in terms of spherical harmonics . if we denote the convolution operator by @xmath173 , then the application is defined to be @xmath174 , where @xmath175 are the expansion coefficients of the rotation symmetric convolution kernel on @xmath2 .",
    "two operators , which can be derived from a tikhononv - regularization problem are @xmath176 and on the other hand @xmath177 .",
    "they can easily expressed in our framework : @xmath178 where the factors are @xmath179,@xmath180 and @xmath181 . on the other",
    "we have @xmath182 where @xmath183 , @xmath184 and @xmath185 .",
    "note that the same operators can also be derived for orthogonal diffusion @xmath186 .",
    "we want to show two examples where the introduced framework can be applied .",
    "first , an example in mr - imaging will show that the introduced operators can effectively used as regularization terms for the estimation of fiber orientation distributions on the basis of hardi - imaging . in this experiment",
    "the sh - based approach will be compared with its discrete counterpart . and",
    "secondly , we use the translation operator to implement a 3d circular hough transform efficiently . but before starting , some details on the discrete implementation of the derivative operators are given and some general issues are discussed .",
    "all differential operators are implemented by ordinary finite difference schemes . to keep the implementation efficient we restricted our implementation to first order approximations . for the discretization of the first - order derivative operators @xmath187 we use a simple central finite difference approximation ,",
    "that is , the convolution kernel of a partial derivative along an arbitrary axis reads @xmath188/2 $ ] .",
    "we also explicitly implemented second order derivatives @xmath189 by the common difference scheme : for example , the convolution kernels of @xmath190 and @xmath191 are @xmath192 , \\hspace{0.2cm}d_{xy } = \\frac{1}{4}\\left [ \\begin{array}{ccc } 1 & 0 & -1 \\\\ 0 & 0 & 0 \\\\ -1 & 0 & 1 \\end{array } \\right],\\ ] ] the others can be obtained by permutation and symmetry . from these rather rough approximations",
    "we can not expect too much .",
    "in particular , the forward euler - integration of first - order central differences is usually a no - go .",
    "unfortunately , usual solution for convection dominated problems by upwind / downwind schemes can not be applied due to the global nature of the harmonic representations .",
    "nevertheless , we want to rely on these crude approximations for the sake practicability .",
    "of course , there are several more sophisticated approximation schemes ( @xcite ) , but due to the inherent slow - down of the computation speed , in particular in 3d , we only consider the most simple scheme . and",
    "we will see in the experiments that it is enough to obtain reasonable good results .    in a first small experiment",
    ", we investigate the behavior of the simple forward integration of @xmath164 in detail .",
    "additionally , we look at the forward integration of @xmath193 , i.e. a small diffusion term is added to make the results more stable . in particular , we used @xmath194 as initial condition and iterated the integration @xmath195 times with a step - width of @xmath196 resulting in a translation of @xmath197 voxels . to analyze the result",
    "we have a look at the maximum of the orientation distribution along the z - axis , namely @xmath198 and the @xmath199 component @xmath200 , which is the mean along the orientation coordinate . for reference",
    ", we made a simple 1d experiment without any orientation involved .",
    "it was just integrated @xmath201 with the same first - order central difference approximation of @xmath202 . in figure",
    "[ fig : translation_test1 ] the results for different cutoffs @xmath203 and the 1d experiment are shown . the 1d reference experiment shows the typical oscillations .",
    "similar oscillations can also be observed for @xmath199 component . in particular , for low cutoffs the oscillations are pretty heavy and converge for large @xmath204 towards the 1d reference . for the maximum of the orientation distribution the behavior is different . instead of oscillations a tail",
    "is left over , while certain peaks appear where the oscillations of @xmath199 component dominate .",
    "looking at figure [ fig : translation_test2 ] where the small additional diffusion term is considered , one can observe less oscillations and a more regular behavior .",
    "in figure [ fig : translation_test3 ] we show the resulting orientation fields for @xmath205 in glyph representation with and without diffusion .",
    "once again one can see the spike for the version without diffusion and the more regular behavior for the diffusion - regularized version .",
    "was iterated @xmath195 times with a step - width of @xmath196 resulting in a translation of @xmath206 voxels .",
    "the initial condition was set to @xmath194 . on the left the maximum @xmath198 along the z - axis",
    "is plotted . on the right",
    "the mean - component @xmath199 , i.e. @xmath200 , is visualized . ,",
    "title=\"fig:\",width=302 ]    was iterated @xmath195 times with a step - width of @xmath196 resulting in a translation of @xmath206 voxels .",
    "the initial condition was set to @xmath194 .",
    "on the left the maximum @xmath198 along the z - axis is plotted . on the right",
    "the mean - component @xmath199 , i.e. @xmath200 , is visualized . , title=\"fig:\",width=302 ]     was iterated @xmath195 times with a step - width of @xmath196 resulting in a translation of @xmath206 voxels .",
    "the initial condition was set to @xmath194 .",
    "on the left the maximum @xmath198 along the z - axis is plotted . on the right",
    "the mean - component @xmath199 , i.e. @xmath200 , is visualized .",
    ", title=\"fig:\",width=302 ]   was iterated @xmath195 times with a step - width of @xmath196 resulting in a translation of @xmath206 voxels .",
    "the initial condition was set to @xmath194 . on the left the maximum @xmath198 along the z - axis",
    "is plotted . on the right",
    "the mean - component @xmath199 , i.e. @xmath200 , is visualized . , title=\"fig:\",width=302 ]     and [ fig : translation_test2 ] but the orientation distributions are visualized by glyphs . the spherical harmonic cutoff is set to @xmath205 .",
    "the underlying gray - values indicate the maximum of the orientation distribution.,width=529 ]      magnetic resonance imaging ( mri ) has the potential to visualize non - invasively the fibrous structure of the human brain white matter @xcite . based on the directional dependency of water diffusivity in fibrous tissue it is possible to reveal underlying connectivity information .",
    "the accurate and reliable processing and estimation of fiber orientation distributions is a major prerequisite for the processing of such data .",
    "there are numerous methods for estimating orientation distributions on the basis of the diffusion - weighted mr - signal .",
    "we will focus spherical deconvolution @xcite , which is one way to estimate the so called fiber orientation distributions ( fod ) on the basis of the diffusion - weighted mr - signal .",
    "the idea is based on a model - driven deconvolution scheme to turn the diffusion weighted mr - signal into a fod .",
    "the goal is to find a fod @xmath207 such that @xmath208 is minimized . here",
    "@xmath209 denotes a quantity derived from the mr - measurement , e.g. in standard q - ball imaging just the ratio @xmath210 , where @xmath211 is the diffusion weighted image and @xmath212 the measurement without diffusion weighting .",
    "the operator @xmath213 denotes the spherical convolution with the so called fiber response function : @xmath214 the fiber response function is typically chosen to be a function of the form @xmath215 , or is estimated from the measurement itself .",
    "the main problem is that @xmath213 is practically not invertible .",
    "one way to solve the problem is to introduce a non - negativity constraint @xcite , but in case of low - quality data the problem is still hard to invert .",
    "therefore , regularization techniques @xcite were introduced , which make the solution unique and stable .",
    "an additional term @xmath216 is added to the cost function as : @xmath217 the fiber continuity / contour enhancement kernel provides such an additional cost function that perfectly fits to the nature of fiber orientation distributions : @xmath218 we can expect from this kernel that it prevents ` arbitrary ' smoothing and that it will preserve and emphasize the fibrous nature of the data . as the regularizer includes the spatial neighborhood of each voxel , we have to be careful at the transition area between gray and white matter : a boundary condition is needed . instead of a hard boundary condition we decided to keep the fod small in the background area ( non white matter ) .",
    "thus , we have an additional term in the cost function that suppresses the fod in the background , @xmath219 where @xmath220 is a white matter mask .",
    "that is @xmath221 acts as a suppression strength @xmath221 for gray - matter .",
    "we found a value of @xmath222 to be a good value .",
    "the choice of regularization strength is a crucial issue .",
    "we found that too strong regularization emphasizes discretization artifacts , which is shown by a violation of the rotation invariance , that is , the results depend on the absolute directions of the bundles , with an unpredictable dependence on the sphere discretization and the underlying voxel grid . on the other hand",
    "too low values lead to less stable results .",
    "we found by a simple visual inspection of a simulated crossing a value of @xmath223 to be a good trade - off .      in order to find the optimum of @xmath224",
    ", we have to compute the variation of the objective and set it to zero for the necessary condition for the optimum : @xmath225 which leads to @xmath226 to solve this linear equation we employed an ordinary conjugate gradients scheme .",
    "the implementation of the operator on the left - hand side in terms of spherical harmonics is based on equation .",
    "the operator @xmath227 is also quite simple to implement in terms of spherical harmonics , because it is a diagonal matrix .",
    "the elements on the diagonal are just @xmath228 . if we want to implement this with a discretized sphere the operator @xmath227 has to approximated by interpolation .",
    "we just used spherical harmonics to do this interpolation , in the same way like in @xcite the spherical laplace - beltrami operator was approximated .",
    "the operator @xmath229 is discretized very similar to our spherical harmonics implementation with finite differences ( comparable to @xcite , appendix f ) . throughout this experiment",
    "the sphere was discretized with @xmath230 direction , which were determined such that the energy of the configuration of 512 electrons on the surface of a sphere is minimized , where the electrons repel each other with a force given by coulomb s law .    for both methods",
    "the conjugate gradients algorithm was iterated @xmath231 times , which was enough for convergence .",
    "gradient directions at a b - value of @xmath232 and with a diffusion coefficient of @xmath233,width=604,height=415 ]      the goal of the experiment is to compare the proposed spherical harmonic representations with the discrete angular representation of the fiber orientation distributions .",
    "therefore , we simulated the mr - signal with 64 gradient directions of a crossing region .",
    "the signal was simulated by using the standard exponential model @xmath234 , that is , no diffusion perpendicular to a fiber is assumed .",
    "we have chosen @xmath235 , which emulates a b - value of @xmath232 and a typical diffusion coefficient for the human brain .",
    "the generated signal was distorted by rician noise @xmath236 , where @xmath237 and @xmath238 are normally distributed real numbers with standard deviation @xmath239 .",
    "the signal - to - noise ratio is defined as @xmath240 , that is , the snr is calculated with respect to the @xmath241 measurement .",
    "the crossing was created on a @xmath242 voxel grid , where the tracts of the crossing are on average 5 voxels thick .",
    "to get an impression look at figure [ fig : crossing ] .    to measure the performance of the deconvolution method ,",
    "the local maxima of the estimated fods are extracted and compared to the ground truth direction . to efficiently search for a local maximum we followed the this procedure : we made a voronoi tessellation of the sphere and search for those direction whose value is above all its neighbor with respect to the tessellation . to accurately determine the underlying continuous direction ,",
    "a quadratic form is fitted to the neighborhood of the putative local maxima and the maximum of this quadratic form is used as detected direction . a ground truth direction",
    "is said to detected , when it is in a range of @xmath243 from a detected direction . to measure the performance we used precision , recall and the f - score degree to a ground truth direction , and let fn the number of ground truth direction that are not detected , then @xmath244 and @xmath245 and @xmath246 . ] . to generate the performance measures the simulations",
    "were repeated 100 times .    .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] + .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] + .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] + .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] + .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions .",
    ", title=\"fig:\",width=188 ] .",
    "the measurement was simulated at a @xmath247 with a value of @xmath248 and @xmath249 gradient directions . , title=\"fig:\",width=188 ] +    -@xmath250 plane for the crossing configuration with an crossing angle of @xmath251 .",
    "the angle @xmath93 is plotted along the x - axis , @xmath250 along the y - axis of the scatter plots .",
    "the intersections of the thick red lines indicate the expected ground truth directions .",
    "the dotted lines indicate the @xmath243 detection tolerance . on the left ,",
    "the results for the configuration with an absolute angle of @xmath252 are shown , on the right the results for @xmath253 are given.,width=642 ]      , on the bottom the discrete approach with @xmath230 directions . , width=604 ]    in figure [ fig : crossing ] we compare visually the spherical harmonic implementation for a cutoff of @xmath254 with the discrete version with @xmath230 directions on the sphere .",
    "we consider a crossing angle of @xmath255 and @xmath256 .",
    "for both situations one fiber bundle direction was chosen along the underlying cartesian coordinate axis .",
    "for the larger crossing , which is easier to resolve , we assumed a relatively low snr of @xmath257 .",
    "for this case one can see that the discrete version is more susceptible to noise than the spherical harmonic version , which is not astonishing due to the implicit regularization by the finite sh - cutoff of @xmath254 . for the smaller crossing angle of @xmath255 a higher snr of @xmath258",
    "was assumed . in this case",
    "a sh - representation of @xmath254 is nearly at its limits to discriminate between both directions , while the discrete version can still well distinguish .",
    "further , one can observe that for both methods the fods along the horizontal cartesian axis are sharper than along the skew axis .",
    "but this effect is more prominent for the discretized version than for the spherical harmonic representation .    in figure",
    "[ fig : results ] we show quantitative results .",
    "the crossing was simulated for varying crossing angles between @xmath259 and @xmath260 .",
    "additionally we varied the absolute pose @xmath159 of the crossing .",
    "for @xmath261 the horizontal bundle is aligned with underlying x - axis of the cartesian grid . with growing @xmath159 the whole configuration is rotated clockwise .",
    "the crossing was simulated at a snr of @xmath262 , which is a realistic scenario .",
    "as a baseline experiment we show results of the so called constrained spherical deconvolution ( csd ) approach @xcite , where an additional positivity constraint is used to obtain more stable results .",
    "apart from the unregularized csd approach the results obviously depend on the absolute angle of the configuration .",
    "the discrete approach is able to cope quite good with small crossing angles , but shows independent of the crossing angle less precision than the sh - based approach .",
    "in particular , for crossing angles above @xmath256 the sh - based approach solves the task nearly without any error .    in figure [",
    "fig : scatter ] the results are further investigated by scatter plots in the @xmath263-plane . with the same parameters as above a crossing of @xmath251 was simulated and reconstructed by the three methods .",
    "each detected direction is indicated by a small dot at its corresponding angle @xmath263 .",
    "the crossing was simulated twice , for an absolute angle of @xmath252 , i.e. one direction is along the x - axis , and secondly for an absolute angle of @xmath264 . for @xmath252",
    "the sh - based approach is able to resolve the direction along the x - axis ( @xmath265 ) perfectly , while the other direction ( @xmath266 ) is a bit more blurry . on the other hand ,",
    "the discrete approach has severe problems with the @xmath265 direction , which explains the lack of precision , i.e. apart from the true direction there are some additional local maxima that produce false positives .",
    "the main reason is the interplay of the @xmath249 gradient directions and the @xmath230 discrete directions of the fod .",
    "the effect is reduced by an increase of measurement directions .",
    "but also the sh - based approach has problems when the number of measurement directions is too low .",
    "they are revealed for an absolute angle of @xmath253 . besides the uncertainty caused by the measurement noise one can observe a systematic bias .",
    "for example , for the direction along @xmath267 , the center of the distribution is shifted in @xmath250 by approximately @xmath268 .",
    "also for the other direction the distribution is a bit squeezed .",
    "we also found that the main reason is the low number of measurement directions .",
    "for example , for @xmath269 gradient directions the estimated directions are unbiased . another way to reduce the effect is to decrease the expansion cutoff of the spherical harmonic representation . for @xmath270 and @xmath249 gradient directions the estimates",
    "do not show a bias . to conclude the differences : both methods have problems when the number of measurements become too low .",
    "while the discrete approach shows scattered , multimodal distributions , the sh - based approach shows a slight systematic bias but the distributions stay unimodal .    in figure",
    "[ fig : invivo_glyph ] we show a real world example of the human brain .",
    "the setting of the measurement is nearly the same like in the simulations .",
    "a b - value of @xmath232 and @xmath271 gradient directions were used with an isotropic resolution of @xmath272 .",
    "a kernel of the form @xmath234 with @xmath235 was used as a model for deconvolution .",
    "overall , both methods work very similar .",
    "figure [ fig : invivo_glyph ] shows a coronal section in glyph representation .",
    "one can observe that the sh - based approach produces a bit more negative values , which are indicated in black .",
    "the green rectangle highlights a region where the differences are largest .",
    "the red rectangle shows a regions where the discrete approach shows a direction which does not appear for the sh - based approach . whether the direction is true or not is difficult to say , but the fact that it precisely points along the x - axis makes it dubious .",
    "the memory consumption of the sh - based and discrete approach is easy to compare .",
    "we want to consider the above real world experiment as an example .",
    "the whole volume has a size of @xmath273 .",
    "as the fods are symmetric we need to store only the even expansion coefficients of the spherical harmonic representation .",
    "additionally , the fods are real , hence we have to store @xmath274 numbers per expansion field , instead of @xmath44 like for a general complex field due to the symmetry @xmath275 .",
    "thus , each voxels consumes @xmath276 complex numbers , resulting in @xmath277 bytes for @xmath254 and double precision .",
    "overall , one volume needs @xmath278 mb in sh - representation . on the other hand , in discrete representation with @xmath230 direction needs @xmath279 mb , which is @xmath280-times more compared to the sh - representation .",
    "recall , that the conjugate gradient algorithm needs four instances of the volume in memory .",
    "the running time is more difficult to compare . on the one hand",
    ", we have to compute the application of @xmath164 which basically consists of finite differences , on the other hand , the convolution operator @xmath213 has to be implemented .",
    "let us consider the computation of @xmath164 first . in case of the discrete approach one",
    "has to compute for each of the @xmath230 components six second order finite differences , which are linearly combined with weights depending on the corresponding direction .",
    "for the sh - based approach one also have to compute six finite differences , but the linear combinations of them to obtain the final values are more more expensive . in particular , we implemented separated functions for the operators @xmath281 , @xmath282 and @xmath283 , thus several values are computed repeatedly . in practice we found that one application of @xmath164 with @xmath284 discrete directions is comparable to an sh - based application of @xmath164 with @xmath285 .    the computation of the operator @xmath213 is negligible in sh - representation , while it is the bottleneck for the discrete approach . here , the running time heavily depends on the algorithm used for the matrix multiplication .",
    "in fact , the execution times can differ about a factor of @xmath280 . while the highly optimized blas matrix - multiplication shipped with matlab is quite competitive",
    ", a standard non - optimized version can slow down the running time dramatically . to give an example , to reconstruct the above volume with @xmath231 cg iteration with @xmath230 directions takes on a _ intel xeon x7560 _ @ 2.27ghz about 20 minutes with a highly optimized multiplication . on the other hand , with a standard blas implementation it needs above an hour . for comparison",
    ", our implementation for @xmath254 takes about @xmath280 minutes on the same machine .      , with a step width of @xmath286 .",
    "the orientation distribution is expanded up to @xmath287 .",
    "the gray value background shows the @xmath199 component.,width=604 ]        the detection of spherical objects is an everyday issue in biological image processing .",
    "the hough transform @xcite is often the method of choice . in this section",
    "we want to show how the contour completion kernel @xcite can be used to implement a variant of this approach .",
    "suppose , we have a volumetric image of a solid spherical object , such that the gradient field @xmath288 at the surface of the object points away from the object center @xmath289 .",
    "let @xmath290 be the gradient magnitude and @xmath291 the gradient direction .",
    "if the object has radius @xmath292 , then we know that for all @xmath293 approximately @xmath294 holds .",
    "this fact can be easily used to get a evidence or voting map for the center @xmath289 of the object .",
    "therefore , let @xmath295 an indicator function on the two - sphere , not necessarily a delta - function but a bit blurred .",
    "then , we count for each putative object center @xmath289 how often @xmath294 is approximately fulfilled for each possible direction @xmath76 : @xmath296 where each contribution is weighted by the gradient magnitude of its originating voxel",
    ". the local maxima of the map @xmath297 give evidence for the presence of a spherical object with center @xmath289 and radius @xmath292 .",
    "now , the integrand of the above equation can be expressed in terms of the horizontal translation operator : @xmath298 that is , we have a quite simple algorithm to get the hough voting map : we initialize with @xmath299 and successively euler - integrate @xmath300 where @xmath301 . to get a more stable response we added , as discussed above , a slight amount of diffusion @xmath302 .",
    "note that the proposed hough transform only works for solid objects with surface gradients pointing away from the center .",
    "however , it is easy to switch to inward pointing gradients by using @xmath303 instead .    in figure [",
    "fig : houghtoy ] we show a toy example for a shell , that is , the voxel on the surface of the sphere are set to one .",
    "hence , both gradients are present : inward pointing gradients at the outer border and outward pointing gradients at the inner border .",
    "we decided to let the outward pointing gradients to be translated towards the center , i.e. @xmath303 . the shell in figure [ fig : houghtoy ] was rendered with a radius of @xmath257 in a @xmath304-voxel cube .",
    "every second voxel on the surface was deleted randomly and gaussian random noise with standard deviation of @xmath305 was added .",
    "to get an impression figure [ fig : houghtoy ] shows an isosurface at gray value level @xmath306 , a central slice and a maximum intensity projection ( mip ) of the toy example .",
    "the orientation field @xmath90 is expanded up to @xmath287 and integrated with a @xmath286 .",
    "the initial gradient field @xmath307 was computed on a gaussian smoothed image of width @xmath308 .",
    "the lower two rows in figure [ fig : houghtoy ] show the evolution of orientation field @xmath90 for @xmath309 in glyph representation .",
    "the underlying gray value image is the final voting map @xmath297 , i.e. the @xmath310 component of the orientation field @xmath90 .",
    "one can see how the gradients at the outer border are shifted outwards and gradients of the inner border are translated towards the center .",
    "approximately for @xmath311 the voting maps looks as desired .",
    "this article worked out the formulation left - invariant convection / diffusion equations on @xmath0 in terms of the irreducible representations of @xmath1 . from a computational viewpoint the main advantage of",
    "the proposed formulation is the low memory consumption in comparison to a angular discretization of the two - sphere or rotation group , respectively . with a low number of basis functions the functions",
    "are well described without hurting the rotation covariance .",
    "the dwi example showed that even with 10 times less memory consumption the results are still comparable to the angular discrete approach . in terms of accuracy both approaches have their own problems .",
    "applications to the full group @xmath0 remain subject to future work .",
    "for example , the detection of helical structures in cryo electron micro - graphs @xcite might be a good playground .",
    "we further plan to provide the elementary operators as a open source toolbox to give the scientific community a chance to try the proposed framework with a small amount of effort .",
    "we always use racah - normalized spherical harmonics such that @xmath312 , or @xmath313 , where the @xmath314 are the legendre polynomials : @xmath315 in terms of the associated legendre polynomials the components @xmath316 of the spherical harmonics are written as @xmath317 mostly we write @xmath318 instead of @xmath319 .",
    "the racah - normalized solid harmonics can be written as @xmath320 where @xmath321 .",
    "they are related to spherical harmonics by @xmath322        the clebsch gprdan coefficients of @xmath1 fulfill several orthogonality relations : @xmath324 for particular combinations there are simple formulas : @xmath325 @xmath326 there are several symmetry relations @xmath327 and associativity relations : @xmath328 where @xmath329 and @xmath330 . and for @xmath331 we have another one : @xmath332      the irreducible representation of @xmath1 are called wigner d - matrices @xmath333 and are indiced by an integer @xmath334 .",
    "the @xmath335th order representation works on a @xmath336 dimensional vector space .",
    "we denote the components of @xmath333 by @xmath337 . in euler angles in zyz - convention",
    "we have @xmath338 where @xmath339 is the small wigner d - matrix , which is real - valued and explicitly written as @xmath340^{1/2 } \\sum_s \\frac{(-1)^{m - n+s}}{(\\ell+n - s)!s!(m - n+s)!(\\ell - m - s ) ! } \\\\",
    "\\quad \\quad \\times \\left(\\cos\\frac{\\beta}{2}\\right)^{2\\ell+n - m-2s}\\left(\\sin\\frac{\\beta}{2}\\right)^{m - n+2s}. \\end{array}\\end{aligned}\\ ] ] the representations of different order are connected via the clebsch gordan coefficients by : @xmath63 and @xmath341 another important equality is @xmath342          from equation we directly know the corresponding equality for the spherical derivatvies : @xmath347 setting @xmath348 we know that the sum over @xmath167 takes only values for @xmath349 and @xmath350 . by rotating the frame of reference @xmath351 we get @xmath352 with @xmath353 and evaulting the clebsch gordan coefficients we end up with @xmath354 which was to show .",
    "a.  barmpoutis , b.  c. vemuri , d.  howland , and j.  r. forder , `` extracting tractosemas from a displacement probability field for tractography in dw - mri , '' in _ med image comput comput assist interv .",
    "miccai 2008 _ , vol .  11 , 2008 , pp . 916 .      r.  duits and e.  franken , `` left - invariant diffusions on the space of positions and orientations and their application to crossing - preserving smoothing of hardi images , '' _ international journal of computer vision _ , vol .",
    "92 , pp . 231264 , 2011 .",
    "r.  duits and e.  m. franken , `` line enhancement and completion via left - invariant scale spaces on se(2 ) , '' in _ lecture notesof computer science , proceedings 2nd international conference on scale space and variational methods in computer vision _ , vol .",
    "5567 , 2009 , p. 795807 .",
    "r.  duits . and",
    "e.  franken , `` left invariant parabolic evolution equations on se(2 ) and contour enhancement via invertible orientation scores , part i : linear left - invariant diffusion equations on se(2 ) , part ii : nonlinear left - invariant diffusion equations on invertible orientation scores , '' _ quarterly on applied mathematics , ams _ , june .",
    "j.  tournier , f.  calamante , d.  gadian , and a.  connelly , `` robust determination of the fibre orientation distribution in diffusion mri : non - negativity constrained super - resolved spherical deconvolution , '' _ neuroimage _ , vol .",
    "35 , no .  4 , pp . 14591472 , 2007 .",
    "[ online ] .",
    "available : http://www.sciencedirect.com / science / article / b6wnp-4n3p065 - 5/2/43afd9f1% d21cafe00341f12cae7bf55b[http://www.sciencedirect.com / science / article / b6wnp-4n3p065 - 5/2/43afd9f1% d21cafe00341f12cae7bf55b ]    i.  aganj , c.  lenglet , g.  sapiro , e.  yacoub , k.  ugurbil , and n.  harel , `` reconstruction of the orientation distribution function in single- and multiple - shell q - ball imaging within constant solid angle , '' _ magnetic resonance in medicine _",
    "64 , pp . 554566 , 2010 .",
    "a.  tristan - vega , c .- f .",
    "westin , and s.  aja - fernandez , `` estimation of fiber orientation probability density functions in high angular resolution diffusion imaging , '' _ neuroimage _ , vol .",
    "47 , no .  2 ,",
    "pp . 638650 , 2009 .",
    "e.  j. canales - rodriguez , l.  melie - garcia , and y.  iturria - medina , `` mathematical description of q - space in spherical coordinates : exact q - ball imaging , '' _ magnetic resonance in medicine _",
    "61 , pp . 13501367 , 2009 .",
    "a.  goh , c.  lenglet , p.  thompson , and r.  vidal , `` estimating orientation distribution functions with probability density constraints and spatial regularity , '' in _ medical image computing and computer - assisted intervention - miccai 2009_.1em plus 0.5em minus 0.4emlecture notes in computer science , springer berlin / heidelberg , 2009 , pp .",
    "877885 .",
    "d.  tschumperle and r.  deriche , `` dt - mri images : estimation , regularization and application , '' in _ proc . of the neuroimaging workshop , eurocast 2003 , las palmas de gran canaria_.1em plus 0.5em minus 0.4em springer - verlag , 2003 , pp .",
    "4647 .",
    "a.  barmpoutis , m.  s. hwang , d.  howland , j.  r. forder , and b.  c. vemuri , `` regularized positive - definite fourth order tensor field estimation from dw - mri , '' _ neuroimage _ , vol .",
    "1 , supplement 1 , pp .",
    "s153s162 , 2009 , mathematics in brain imaging .",
    "[ online ] .",
    "available : http://www.sciencedirect.com / science / article / b6wnp-4tx7943 - 6/2/62a4b3b6% 229e8d8e92f7c89b6e9f9cdb[http://www.sciencedirect.com / science / article / b6wnp-4tx7943 - 6/2/62a4b3b6% 229e8d8e92f7c89b6e9f9cdb ]    e.  franken , m.  van almsick , p.  rongen , l.  florack , and b.  ter haar  romeny , `` an efficient method for tensor voting using steerable filters , '' in _ proceedings of the eccv 2006_.1em plus 0.5em minus 0.4em lecture notes in computer science , springer , 2006 , pp . 228240 .",
    "e.  d. claudio , g.  jacovitti , and a.  a.  laurenti , `` maximum likelihood orientation estimation of 1-d patterns in laguerre - gauss subspaces , '' _ ieee transactions on image processing _ , vol .",
    "1113  1125 , 2010 .",
    "m.  reisert and h.  burkhardt , `` spherical tensor calculus for local adaptive filtering , '' in _ tensors in image processing and computer vision _ ,",
    "advances in pattern recognition , s.  aja - fernndez , r.  de  luis  garca , d.  tao , and x.  li , eds.1em plus 0.5em minus 0.4emspringer , 2009 , pp . 153178 .",
    "[ online ] .",
    "available : http://www.springer.com / computer / computer+imaging / book/978 - 1 - 84882 - 298-% 6[http://www.springer.com / computer / computer+imaging / book/978 - 1 - 84882 - 298-% 6 ]    h.  skibbe , m.  reisert , t.  schmidt , t.  brox , o.  ronneberger , and h.  burkhardt , `` fast rotation invariant 3d feature computation utilizing efficient local neighborhood operators , '' _ ieee trans . on pami _ , 2012 .",
    "g.  s. chirikjian and a.  b. kyatkin , `` an operational calculus for the euclidean motion group with applications in robotics and polymer science , '' _ journal of fourier analysis and applications _",
    "6 , no .  6 , pp .",
    "583606 , 2000 .",
    "j.  d. tournier , f.  calamante , d.  g. gadian , and a.  connelly , `` direct estimation of the fiber orientation density function from diffusion - weighted mri data using spherical deconvolution , '' _ neuroimage _ , vol .",
    "23 , no .  3 , pp . 11761185 , 2004 .",
    "l.  ma , m.  reisert , and h.  burkhardt , `` a novel alpha - helices identification approach for intermediate resolution electron density maps , '' _ ieee / acm transactions on computational biology and bioinformatics , in press _ , 2012 ."
  ],
  "abstract_text": [
    "<S> in this work we study the formulation of convection / diffusion equations on the 3d motion group @xmath0 in terms of the irreducible representations of @xmath1 . </S>",
    "<S> therefore , the left - invariant vector - fields on @xmath0 are expressed as linear operators , that are differential forms in the translation coordinate and algebraic in the rotation . in the context of 3d image processing </S>",
    "<S> this approach avoids the explicit discretization of @xmath1 or @xmath2 , respectively . </S>",
    "<S> this is particular important for @xmath1 , where a direct discretization is infeasible due to the enormous memory consumption . </S>",
    "<S> we show two applications of the framework : one in the context of diffusion - weighted magnetic resonance imaging and one in the context of object detection .    </S>",
    "<S> * keywords : * spherical harmonics , left - invariant diffusion , partial differential equations , wigner d - matrix , clebsch - gordan coefficients , diffusion weighted mr - imaging , high angular resolution diffusion imaging ( hardi ) , diffusion tensor imaging ( dti ) , spatial regularization , spherical hough transform </S>"
  ]
}